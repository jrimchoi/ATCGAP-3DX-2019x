define("DS/ENOXWelcomePanel/js/ENOXWelcomePanel",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/Handlebars/Handlebars","DS/ResizeSensor/js/ResizeSensor","text!DS/ENOXWelcomePanel/html/WelcomePanel.html","css!DS/ENOXWelcomePanel/css/WelcomePanel","css!DS/UIKIT/UIKIT.css"],function(g,a,j,e,h,d,c,m){function k(n,o){if(n.selectedItem!==""){var p=g.extendElement(n.container).getElement("#"+n.selectedItem);if(g.is(p)&&p.classList.contains("selected")){p.classList.remove("selected")}}n.selectedItem=o.id;if(!o.classList.contains("selected")){o.classList.add("selected")}}function l(n,o){return new j({position:"right",target:n,body:o})}function b(n){window.widget.log("registering listeners");var p=n._self;var r=n.activities;if(n.footer){r=r.concat(n.footer)}if(g.is(r)){for(var o=0;o<r.length;o++){var q=g.extendElement(p.container).getElement("#"+r[o].id);var s=r[o].actions;s.forEach(function(u){var t=g.extendElement(q).getElement("#"+u.id);if(u.tooltip!==null){u.tooltipElt=l(t,u.tooltip||u.text)}t.addEvent("click",function(){if(!u.isNotHighlightable){k(p,t)}p.modelEvents.publish({event:"welcome-panel-action-selected",data:{id:u.id,param:p.companyId}})})})}}}var f=d.compile(m);var i=a.extend({name:"welcome-panel-view",collapsed:false,activities:[],selectedItem:"",className:function(){return this.getClassNames("-container")},tagName:"div",parentContainer:null,container:null,init:function(n){n._self=this;["id","className","attributes","container","template","tagName","domEvents"].forEach(function(p){delete n[p]});for(var o in n){this[o]=n[o]}this._parent(n)},setup:function(o){var p=this;p.container.setHTML(f(o));b(o);var n=p.container.getElement(".panel-content");var q=p.container.getElement(".welcome-panel-element");new e({element:n}).inject(q,q.lastChild);p.container.inject(p.parentContainer);if(o.modelEvents){o.modelEvents.subscribe({event:"welcome-panel-toggle"},function(){p.toggle()});o.modelEvents.subscribe({event:"welcome-panel-expand"},function(){p.show()});o.modelEvents.subscribe({event:"welcome-panel-collapse"},function(){p.hide()});o.modelEvents.subscribe({event:"welcome-panel-select-action"},function(r){p.selectAction(null);p.selectAction(r.id)});o.modelEvents.subscribe({event:"welcome-panel-unselect-action"},function(){p.selectAction(null)})}},render:function(n){this.applyViewMode(this.collapsed);return this},show:function(){if(this.collapsed){this.collapsed=false;this.applyViewMode(this.collapsed)}},hide:function(){if(!this.collapsed){this.collapsed=true;this.applyViewMode(this.collapsed)}},toggle:function(){if(this.collapsed){this.show()}else{this.hide()}},attachResizeSensor:function(){var n=this;new c(n.container,function(){n.resize()})},resize:function(){var o=this;var n=o.container.offsetWidth;if(n<=40&&o.container.hasClassName("expanded")){o.applyViewMode(true)}else{if(o.container.hasClassName("collapsed")){o.applyViewMode(false)}}},applyViewMode:function(o){var n=this;if(o){this.container.addClassName("collapsed");this.container.removeClassName("expanded");n.modelEvents.publish({event:"welcome-panel-collapsed"})}else{this.container.addClassName("expanded");this.container.removeClassName("collapsed");n.modelEvents.publish({event:"welcome-panel-expanded"})}},createNewActivitySection:function(o,r){var s=this;var p=g.createElement("div",{html:f({activities:[o]})});var n=g.extendElement(this.container).getElement(".all-activity-section");var q=g.extendElement(p).getElement(".all-activity-section").getChildren();if(r===undefined||r===null){n.appendChild(q[0]);n.appendChild(q[1]);s.activities.push(o)}else{var t=n.getElements(".activity-section")[r];n.insertBefore(q[0],t);n.insertBefore(q[1],t);s.activities.splice(r,0,o)}b({_self:s,activities:[o]})},createNewAction:function(o,u,p){var v=this;var r={_self:this,activities:[{id:o,actions:[u]}]};var t=g.createElement("div",{html:f(r)});var w=g.extendElement(this.container).getElement("#"+o);var s=g.extendElement(t).getElement("#"+o).getChildren()[0];var n=v._getIndexOfActivityFromId(o);if(p===undefined||p===null){w.appendChild(s);v.activities[n].actions.push(u)}else{var q=w.getElements(".activity-btn")[p];w.insertBefore(s,q);v.activities[n].actions.splice(p,0,u)}b(r)},removeActivitySection:function(s){var q=this;var n=q._getIndexOfActivityFromId(s);if(n!==undefined){for(var p=0;p<q.activities[n].actions.length;p++){if(q.activities[n].actions[p].tooltipElt!==undefined){q.activities[n].actions[p].tooltipElt.destroy()}}q.activities.splice(n,1);var o=q.container.querySelector(".activity-section#"+s);if(o!==null){var r=o.nextElementSibling;o.parentElement.removeChild(o);r.parentElement.removeChild(r)}}},removeAction:function(q){var p=this;var n=(function(){for(var s=0;s<p.activities.length;s++){for(var r=0;r<p.activities[s].actions.length;r++){if(p.activities[s].actions[r].id===q){return{activity:s,action:r}}}}})();if(n.action!==undefined){if(p.activities[n.activity].actions[n.action].tooltipElt!==undefined){p.activities[n.activity].actions[n.action].tooltipElt.destroy()}p.activities[n.activity].actions.splice(n.action,1);var o=p.container.querySelector(".activity-btn#"+q);if(o!==null){o.parentElement.removeChild(o)}}},selectAction:function(o){var n=this.container.getElement(".activity-btn.selected");if(n!==null){n.removeClassName("selected")}if(o!==null&&o!==undefined){this.container.getElement(".activity-btn#"+o).addClassName("selected");this.selectedItem=o}},_getIndexOfActivityFromId:function(n){var o=this;return(function(){for(var p=0;p<o.activities.length;p++){if(o.activities[p].id===n){return p}}})()}});return i});