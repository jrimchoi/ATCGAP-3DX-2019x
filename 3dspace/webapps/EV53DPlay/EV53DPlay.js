define("DS/EV53DPlay/enoviav5",["UWA/Core","UWA/Class",],function(b,c){var a=c.singleton({init:function(){},getWebServicesPath:function(){return"/resources/fedSearchV5"},getActionsPath:function(d){return getWebServicesPath()+"/actions"},get3DPlayProvider:function(d){return"EV5"}});return a});define("DS/EV53DPlay/OxMQLV5Loader",["DS/WAFData/WAFData","DS/EV53DPlay/enoviav5"],function(a,b){var c=function(l,g){var s=null;var n={};var u=(g!==undefined)?g:null;var t=null;var i=null;var h=null;var e=null;var q=null;var k=null;function f(){t=null;i=null;h=null;e=null;s=null;n={}}this.load=function(x,B,A,z,w,y){n=y;s={value:false};t=B;h=A;i=function(){f();if(z){z()}};e=w;k=x.physicalid;q=x.serverurl;console.log("Selected Object uuid: "+k);console.log("Selected Object Type: "+x.dtype);console.log("enoviav5 service URL: "+q);if(x.provider!==b.get3DPlayProvider()){console.error("got a data for another provider "+x.provider+" (can only treat EV5 one)")}var v=false;if(!v){console.log(" ping V5");d();v=true}o()};this.abort=function(){if(s!==null){s.value=true;f()}};function p(v,x,w){if(e){e({rsc:"EV53DPlay/EV53DPlay_errors",type:v,level:(x!==undefined)?x:"warning",abort:(w!==undefined)?w:true})}}function m(){return q+b.getWebServicesPath()+"/SOPRequest/"}function r(){return q+b.getWebServicesPath()+"/LightVault/"}function d(){var w=m()+"Ping";console.log("ping url="+w);var v=[];v.method="GET";v.type="xml";v.async=false;v.timeout=500;v.onComplete=function(x){console.log("pingV5 succeeded ",x)};v.onFailure=function(x){console.error(w+" has failed.!!  "+x)};v.onTimeout=function(x){console.error(w+" TimeOut.!!  "+x)};a.authenticatedRequest(w,v)}function o(){var w=m()+"Light3DEXPNavigation";console.log("url="+w);var x='<?xml version="1.0" encoding="UTF-8" ?><InputData Release = "419"><V53DEXPNavigation><NAVIGATION NAME="Expand3DPLAY" DEPTH="ALL"></NAVIGATION><UUIDList><UUID VALUE="'+k+'"/></UUIDList></V53DEXPNavigation></InputData>';var v=[];v.method="POST";v.data=x;v.type="xml";v.headers={Accept:"text/xml","Content-Type":"text/xml"};v.onComplete=function(y){j((new XMLSerializer()).serializeToString(y))};v.onFailure=function(y){console.error(w+" Query is failed.!!");p("SERVIVE","error","true")};a.authenticatedRequest(w,v)}function j(A){var z=new DOMParser();var y=z.parseFromString(A,"text/xml");if(y instanceof XMLDocument){var v=y.firstChild;if(v.nodeName==="OutputData"){if(v.childNodes.length===1&&v.childNodes[0].nodeName==="ListOfNodes"){var x=v.childNodes[0];var w=x.attributes.length;require(["DS/Visualization/ModelLoader","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS"],function(C,H,J){var N=new C();N.setRenderCallback(u);N.setOnLoadedCallback(i);N.setOnProgressCallback(h);N.setOnErrorCallback(e);for(var M=0;M<w;M++){if(x.attributes[M].name==="Data"){var K=x.attributes[M].value;var Q=JSON.parse(K);var P=Q.List.length;console.log("Total CGR Models: "+P);if(P!=0){var I="";var O="";var D=[];for(var G=0;G<P;G++){I=Q.List[G]["ds6w:title"];O=Q.List[G].LOC;D=Q.List[G].POS;D[9]*=1000;D[10]*=1000;D[11]*=1000;var E=new J.Matrix4(D[0],D[3],D[6],D[9],D[1],D[4],D[7],D[10],D[2],D[5],D[8],D[11],0,0,0,1);var B=new H("Document CGR");B.productType="Reference3D";B.setMatrix(E);O=O.replace("_","/");var L=r()+O;var F={provider:"FILE",filename:L,serverurl:"",format:"cgr",requestsOptions:{authentication:"passport"}};N.loadModel(F,B);if(h){h({loaded:P-G,total:P})}if(t){t(B)}}}else{console.warn("No CGR Model Available In Selected Object");p("NO_GEOMETRY","info","true");i()}}}},function(C){var B=C.requireModules&&C.requireModules[0];console.error("Module "+B+" is missing.")})}else{console.warn("No CGR Model Available In Selected Object");p("NO_GEOMETRY","info","true");i()}}else{console.warn("Invalid XML Received From Light3DEXPNavigation");i()}}else{console.warn("Light3DEXPNavigation Response Not Contains Any XML Data");i()}}};return c});