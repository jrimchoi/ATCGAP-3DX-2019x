define("DS/CfgConfigurationContextUX/CfgConfigurationContextCriteria",["DS/UIKIT/Spinner","DS/UIKIT/Alert","DS/CfgBaseUX/scripts/CfgUtility","UWA/Class/Collection","UWA/Class/Model","UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","i18n!DS/CfgConfigurationContextUX/assets/nls/CfgConfigurationContextUX","DS/Controls/Toggle","css!DS/CfgConfigurationContextUX/CfgConfigurationContextUX.css"],function(d,g,k,f,c,a,j,h,e,i){var b=a.extend({collection:null,className:"CfgConfigurationContextCriteria",enabledCriteria:{feature:"true",productState:"false",unit:"false",contextualDate:"false",milestone:"false",manufacturingPlan:"false"},setup:function(){},init:function(l){var m=this;this.alertDiv=new g({visible:false,autoHide:true,hideDelay:3000,closeOnClick:true,maximumVisibleMessages:3,className:"error"});this.options=l;var n=function(o){console.log(o);if(o.isLicenseValid!=undefined&&o.isLicenseValid==false){return}m.caid=o.change.id};h.get2(n)},render:function(m){this.collection=m;var l=this;return(l.createCriteriaView())},getActiveCriteria:function(){var m=e.ActivatedCriteria;var l=this.ROCriteriaView=new UWA.createElement("div",{"class":"ROCriteria-container",title:m,html:m});this.renderActiveCriteria(this.options.enabledCriterias);return l},renderActiveCriteria:function(l){var n="<b>"+e.ActivatedCriteria+"  :  </b>";var m="";l.productState==="true"?m+=e.Product_state+",":false;l.manufacturingPlan==="true"?m+=e.Manufacturing_Plan+",":false;l.contextualDate==="true"?m+=e.Date+",":false;l.milestone==="true"?m+=e.Milestone+",":false;l.unit==="true"?m+=e.Unit+",":false;l.feature==="true"?m+=e.Variant_Options+",":false;m=m.replace(/,\s*$/,"");this.ROCriteriaView.setContent(n+m);this.ROCriteriaView.setAttributes({title:m})},onResize:function(){if(this.criteriaContent&&this.criteriaContent.getParent().getStyle("display")!="none"){var l=(this.criteriaContent.getParent().offsetWidth<=448)?true:false;if(l){this.criteriaContent.addClassName("main-CriteriaContent-mobilemode");if(this.evolutionCritView){this.evolutionCritView.addClassName("evolutionCrit-containert-mobilemode")}if(this.variantCritView){this.variantCritView.addClassName("variantCrit-container-mobilemode")}}else{this.criteriaContent.removeClassName("main-CriteriaContent-mobilemode");if(this.evolutionCritView){this.evolutionCritView.removeClassName("evolutionCrit-containert-mobilemode")}if(this.variantCritView){this.variantCritView.removeClassName("variantCrit-container-mobilemode")}}}},createCriteriaView:function(){var o=this;var l=this.evolutionCritView=new UWA.createElement("div",{"class":"evolutionCrit-container",html:[{tag:"div","class":"evoCritContainer",html:['<h5 class="evoCritHeader">'+e.Evolution+"</h5>",{tag:"div","class":"evoCritContent",}]}]});var n=this.variantCritView=new UWA.createElement("div",{"class":"variantCrit-container",html:[{tag:"div","class":"varCritContainer",html:['<h5 class="varCritHeader">'+e.Variants+"</h5>",{tag:"div","class":"varCritContent",}]}]});var p=this.criteriaContent=new UWA.createElement("div",{"class":"main-CriteriaContent"});this.Spinner=new d({className:"Spinners"}).inject(p);l.inject(this.criteriaContent);n.inject(this.criteriaContent);var m=o.options.enabledCriterias?o.options.enabledCriterias:o.enabledCriteria;o.enabledCriteriasUX=m;k.checkDecouplingActivation().then(function(q){o.AllowedCriteria=q;o.renderCriteriaView(o.enabledCriteriasUX);o.criteriaContent.addEvent("resize",function(){o.onResize()})});return p},updateCollection:function(l,m){this.collection=l;if(UWA.is(m)){this.enabledCriteriasUX=m;this.renderActiveCriteria(this.enabledCriteriasUX)}},renderCriteriaView:function(){var m=this;var l=m.enabledCriteriasUX;var n=new Promise(function(s,r){var t=[];m.collection.forEach(function(w,v){t.push({id:"pid:"+w.id})});var p="/resources/modeler/browsing/model/getcriteria";var q={version:"1.0.0",modelIds:t};q=JSON.stringify(q);var u=function(v){s(v)};var o=function(v){console.log("fail to get last product evolution")};k.makeWSCall(p,"POST","enovia","application/json",q,u,o,true)});n.then(function(r){var q=r;var v=[];for(var s in q.criteria){var o=q.criteria[s];var t=[];var t=Object.keys(o);for(var y in t){if(o[t[y]]=="TRUE"&&(v.indexOf(t[y])==-1)){v.push(t[y])}}}var u=m.evolutionCritView.getElement(".evoCritContent");var p=m.variantCritView.getElement(".varCritContent");var w=m.evolutionCritView.getElement(".evoCritHeader");var z=m.variantCritView.getElement(".varCritHeader");p.setContent("");u.setContent("");if((v.indexOf("products")>=0)||(v.indexOf("products")==-1&&l.productState=="true")){m.productstateCheckbox=new i({type:"checkbox",value:"productState",className:"primary",checkFlag:(l.productState==="true"||l.productState==="mixedState")?true:false,label:e.Product_state,mixedState:l.productState==="mixedState"?true:false,disabled:(v.indexOf("products")==-1&&l.productState=="true")?true:false}).inject(u);m.productstateCheckbox.addEventListener("click",function(x){m.setUnsetCriteria(m.productstateCheckbox)})}if((v.indexOf("manufacturingPlans")>=0)||(v.indexOf("manufacturingPlans")==-1&&l.manufacturingPlan=="true")){m.manufacturingPlanCheckbox=new i({type:"checkbox",value:"manufacturingPlan",className:"primary",checkFlag:(l.manufacturingPlan==="true"||l.manufacturingPlan==="mixedState")?true:false,label:e.Manufacturing_Plan,mixedState:l.manufacturingPlan==="mixedState"?true:false,disabled:(v.indexOf("manufacturingPlans")==-1&&l.manufacturingPlan=="true")?true:false}).inject(u);m.manufacturingPlanCheckbox.addEventListener("click",function(x){m.setUnsetCriteria(m.manufacturingPlanCheckbox)})}if(m.AllowedCriteria.contextualDate){m.contextualDatebox=new i({type:"checkbox",value:"contextualDate",className:"primary",checkFlag:(l.contextualDate==="true"||l.contextualDate==="mixedState")?true:false,label:e.Date,mixedState:l.contextualDate==="mixedState"?true:false,}).inject(u);m.contextualDatebox.addEventListener("click",function(x){m.setUnsetCriteria(m.contextualDatebox)})}if(v.indexOf("milestones")>=0&&l.milestone=="true"){m.milestoneCheckbox=new i({type:"checkbox",value:"Milestone",className:"primary",checkFlag:(l.milestone==="true"||l.milestone==="mixedState")?true:false,label:e.Milestone,mixedState:l.milestone==="mixedState"?true:false,disabled:true}).inject(u);m.milestoneCheckbox.addEventListener("click",function(x){m.setUnsetCriteria(m.milestoneCheckbox)})}if((m.AllowedCriteria.unit&&v.indexOf("builds")>=0)||(v.indexOf("builds")==-1&&l.unit=="true")){m.unitCheckbox=new i({type:"checkbox",value:"unit",className:"primary",checkFlag:(l.unit==="true"||l.unit==="mixedState")?true:false,label:e.Unit,mixedState:l.unit==="mixedState"?true:false,disabled:(v.indexOf("builds")==-1&&l.unit=="true")?true:false}).inject(u);m.unitCheckbox.addEventListener("click",function(x){m.setUnsetCriteria(m.unitCheckbox)})}if((v.indexOf("products")>=0)||(v.indexOf("products")==-1&&l.feature=="true")){m.featureCheckbox=new i({type:"checkbox",value:"feature",className:"primary",checkFlag:(l.feature==="true"||l.feature==="mixedState")?true:false,label:e.Variant_Options,mixedState:l.feature==="mixedState"?true:false,disabled:(v.indexOf("products")==-1&&l.feature=="true")?true:false}).inject(p);m.featureCheckbox.addEventListener("click",function(x){m.setUnsetCriteria(m.featureCheckbox)})}})},setUnsetCriteria:function(n){var p=this;p.enabledCriteriasUX[n.value]=n.checkFlag.toString();this.Spinner.show();var m=null;if(p.caid!=""){m={operationheader:{key:"DS-Change-Authoring-Context",value:"pid:"+p.caid}}}var l=[];for(var o=0;o<p.options.selection.length;o++){l.push(p.options.selection[o].id)}var q=new Promise(function(v,u){var s="/resources/modeler/configuration/authoringServices/setConfiguredObjectInfo?cfgCtxt=1";var w=function(x){v(x)};var t={version:"1.2",pidList:l,content:{enabledCriteria:p.enabledCriteriasUX,}};var t=JSON.stringify(t);var r=function(x,y){p.enabledCriteriasUX[n.value]=(!(n.checkFlag)).toString();n.checkFlag=(!(n.checkFlag));u(y)};k.makeWSCall(s,"POST","enovia","application/json",t,w,r,true,m)});q.then(function(r){p.renderActiveCriteria(p.enabledCriteriasUX);p.Spinner.hide()},function(r){p.alertDiv.add({message:e.SetCriteriaFailed,style:{position:"absolute"},className:"error"});p.alertDiv.show();if(r.errorMessage.contains("No model(s) attached to the reference")==true){k.showwarning(e.EnableCriteriaFail,"error")}p.Spinner.hide()})},});return b});define("DS/CfgConfigurationContextUX/CfgContextTileView",["DS/W3DXComponents/Views/Item/TileView",],function(b){var a=b.extend({name:"CfgContextTileView",that:this,template:function(){return'                                        <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                            <div class="toggle toggle-primary">                                                <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                                <label class="control-label" for="checkbox-{{cid}}"></label>                                            </div>                                        </div>                                        <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                            <div class="'+this.getClassNames("-header")+'">                                                {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                            </div>                                            <div class="'+this.getClassNames("-body")+'">                                                {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}	                                                <div class="'+this.getClassNames("-title")+'" style="white-space: nowrap;">{{{title}}}</div>                                                <div class="'+this.getClassNames("-subtitle")+'">{{{subtitle}}}</div>                                                <div class="'+this.getClassNames("-content")+'">{{{content}}}</div>                                            <progress max="100" value="10" class="'+this.getClassNames("-progress")+'"></progress>                                            </div>                                            <div class="'+this.getClassNames("-actions")+'">                                                <div class="actions-inline-container" style="display:'+(this.model._attributes.isToPropagate!=true?"none":"flex")+'">                                                    <div class="action-container single-action hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                                    </div>                                                    <div class="action-container actions-inline-dotted hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        </div>                                    '},select:function(c){c||(c={});if(c.event.type=="click"){if(this.container.getElement("."+this.name+"-check input").checked==false){this.container.getElement("."+this.name+"-check input").checked=true;this.container.addClassName("selected");this.dispatchEvent("onSelect")}else{this.container.getElement("."+this.name+"-check input").checked=false;this.unSelect(c)}}else{if(c.event.type=="change"){if(this.container.getElement("."+this.name+"-check input").checked==false){this.unSelect(c)}else{this.container.addClassName("selected");this.dispatchEvent("onSelect")}}}},domEvents:function(){return{"click .tile-sub-container":function(c){if(!c||!c.target||!this.container.getElement(".actions-inline-container")||!this.container.getElement(".actions-inline-container").contains(c.target)){this.dispatchEvent("onClick",[c])}},"contextmenu .tile-sub-container":function(c){c.preventDefault();this.dispatchEvent("onContextMenu",[c]);return false},dragstart:this.dispatchAsEventListener("onDrag"),"dblclick .tile-sub-container":function(c){if(!c||!c.target||!this.container.getElement(".actions-inline-container")||!this.container.getElement(".actions-inline-container").contains(c.target)){this.dispatchEvent("onDblClick",[c])}},"change .tile-check input":this.dispatchAsEventListener("onClick")}}});return a});define("DS/CfgConfigurationContextUX/CfgEditMultipleConfigurationContextDialog",["DS/UIKIT/Spinner","DS/UIKIT/Alert","DS/ENOFloatingPanel/ENOFloatingPanel","DS/UIKIT/Input/Button","DS/W3DXComponents/Views/Layout/GridScrollView","DS/UIKIT/Iconbar","DS/CfgConfigurationContextUX/CfgContextTileView","DS/CfgBaseUX/scripts/CfgUtility","UWA/Class/Collection","UWA/Class/Model","DS/UIKIT/Scroller","DS/Handlebars/Handlebars","text!DS/CfgConfigurationContextUX/CfgEditConfigurationContextDialogTemplate.html","i18n!DS/CfgConfigurationContextUX/assets/nls/CfgConfigurationContextUX","DS/WebappsUtils/WebappsUtils","UWA/Class/View","DS/UIKIT/Tooltip","DS/CfgBaseUX/scripts/CfgSearchConfiguration","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgConfigurationContextUX/CfgConfigurationContextCriteria","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","DS/UIKIT/Mask","css!DS/CfgConfigurationContextUX/CfgConfigurationContextUX.css"],function(i,j,p,n,c,a,m,o,y,l,w,f,e,v,d,t,u,r,b,h,g,s,z){var k=f.compile(e);var q=null;var x=t.extend({collection:null,className:"CfgEditConfigurationContextDialog",gridListView:null,CfgFloatingPanel:null,toolBar:null,activatedView:"ModelView",caid:"",selectedModelsList:[],modelDefination:l.extend({defaults:function(){return{id:null,type:"",marketingName:"",name:"",state:"",description:"",label:"",subLabel:"",icon:"",thumbnail:"",maturity:"",isactive:false}}}),setup:function(){},init:function(B){this._parent(B);this.alertDiv=new j({visible:false,autoHide:true,hideDelay:3000,closeOnClick:true,maximumVisibleMessages:3,className:"error"});var A={};var G={};var E=B.selection;this.isCriteriaEditable=true;var D=this;B.response.referencesInfo.forEach(function(J,I){if(J.isCriteriaEditable=="NO"){D.isCriteriaEditable=false;return}});var F=B.response.enabledCriteria;for(var C=0;C<F.length;C++){if(F[C].activatedFor.length==E.length){G[F[C].criteriaName]="true"}else{if((F[C].activatedFor.length<E.length)&&(F[C].activatedFor.length>0)){G[F[C].criteriaName]="mixedState"}else{if(F[C].activatedFor.length==0){G[F[C].criteriaName]="false"}}}}A.selection=B.selection;A.enabledCriterias=G;if(JSON.parse(s).isCriteriaViewEnabled){this.criteriaView=new g(A)}var D=this;var H=function(I){console.log(I);if(I.isLicenseValid!=undefined&&I.isLicenseValid==false){return}D.caid=I.change.id};h.get2(H)},render:function(){this.selectedModelsList=[];var H="";var E={};E.NoModelAttached=v.NoModelAttached;var F=this;var B=new n({value:v.Cancel,events:{onClick:function(){F.CfgFloatingPanel.destroy()}}});z.mask(this.container);z.unmask(this.container);var G=[B];var A="";if(this.options.selection.length>1){A=v.Header+" - "+this.options.selection.length+" "+v.Header_All_Ref}else{A=v.Header+" - "+this.options.selection[0].alias}this.CfgFloatingPanel=new p({className:"CfgEditConfigurationFloatingPanel",title:A,body:this,overlay:true,closable:true,animate:true,resizable:true,footer:G,appNamePosition:0,events:{onResizeFloating:function(){}}});this.createCollection(this.options.response);var C=UWA.createElement("div",{"class":"main-Context-container"});var K=this.headercontainer=new UWA.createElement("div",{"class":"header-container",html:[{tag:"div","class":"currCriteria-container"},{tag:"div","class":"toolbar-container"}]});var J=UWA.createElement("div",{"class":"no-model-attached",});var I=UWA.createElement("div",{"class":"gridlistview-dialog-container",});var D=this.criteriaContent=new UWA.createElement("div",{"class":"CriteriaContent"});this.container.addContent(K);if(this.criteriaView){this.criteriaContent.setContent(this.criteriaView.render(this.collection))}C.addContent(this.criteriaContent);C.addContent(J);C.addContent(I);C.setStyle("height","calc(100% - 0px)");new w({element:C}).inject(this.container);this.getDefaultImage();this.createToolbar();this.createHeader();this.createView();this.CfgFloatingPanel.inject(widget.body);this.CfgFloatingPanel.show();this.CfgFloatingPanel.centerIt();this.GridView=this.container.getElement(".gridlistview-dialog-container");this.EmptyView=this.container.getElement(".no-model-attached");this.EmptyView.setContent("<span><img src="+this.defaultIcon+' style="width:25%;"></img></span><br>');this.EmptyView.addContent('<font-size="17px">'+E.NoModelAttached+"</font>");this.EmptyView.setStyle("color","silver");this.EmptyView.setStyle("text-align","center");this.EmptyView.setStyle("display","inline-flex");this.EmptyView.setStyle("flex-direction","column");this.EmptyView.setStyle("justify-content","center");this.filpflopDivs();this.alertDiv.inject(this.container,"top");widget.addEvent("onResize",function(){F.CfgFloatingPanel.centerIt()});this.collection.addEvent("onAdd",function(){F.createToolbar();F.filpflopDivs();var M=F.countExistingCriteria(F.criteriaView.enabledCriteriasUX);if(F.collection&&F.collection.length==1&&M==0){var N=[];F.collection.forEach(function(P,O){N.push({id:"pid:"+P.id})});var L;F.isModelVersionAvailable(N).then(function(S){L=S;var O=S;var R=S.criteria;var Q=[];R.forEach(function(W,U){var T=R[U];var V=[];var V=Object.keys(T);V.forEach(function(Y,X){if(T[V[X]]=="TRUE"&&(Q.indexOf(V[X])==-1)){Q.push(V[X])}})});var P={feature:"true",productState:(Q.indexOf("products")>=0)?"true":"false"};if(F.criteriaView){F.criteriaView.updateCollection(F.collection,P)}if(F.criteriaView){F.criteriaView.renderCriteriaView()}})}else{if(F.criteriaView){F.criteriaView.updateCollection(F.collection)}if(F.criteriaView){F.criteriaView.renderCriteriaView()}}});this.collection.addEvent("onRemove",function(){F.createToolbar();F.filpflopDivs();if(F.criteriaView){F.criteriaView.updateCollection(F.collection);F.criteriaView.renderCriteriaView()}});C.addEvent("resize",function(){setTimeout(function(){},50)})},onResize:function(){},closeDialog:function(){if(this.CfgFloatingPanel){this.CfgFloatingPanel.destroy()}},createToolbar:function(){if(this.toolBar){this.toolBar.destroy()}var A=this;this.toolBar=new a({renderTo:this.container.getElement(".toolbar-container"),items:A.getToolBarItems(),})},getToolBarItems:function(){var A=this;var B=[];B.push({fonticon:"plus",text:v.Attach,handler:function(D,C){A.activateSearch()}});if(this.selectedModelsList.length>0){B.push({fonticon:"trash",text:v.Detach,handler:function(G,E){z.mask(A.container);var D=null;if(A.caid!=""){D={operationheader:{key:"DS-Change-Authoring-Context",value:"pid:"+A.caid}}}var C=[];for(E=0;E<A.options.selection.length;E++){C.push(A.options.selection[E].id)}if(A.selectedModelsList.length>0){var F=new Promise(function(L,K){var I="/resources/modeler/configuration/authoringServices/setConfiguredObjectInfo?cfgCtxt=1";var M=function(N){L(N)};var J={version:"1.2",pidList:C,enabledCriteria:{feature:"True",productState:"True",unit:"True"},content:{attachCfgCtxt:[],detachCfgCtxt:A.selectedModelsList,}};var J=JSON.stringify(J);var H=function(){K()};o.makeWSCall(I,"POST","enovia","application/json",J,M,H,true,D)});F.then(function(H){if(H.result=="SUCCEED"){A.ondetach(A,H,"SUCCEED");z.unmask(A.container)}else{if(H.result=="FAILED"){A.ondetach(A,H,"FAILED");z.unmask(A.container)}else{A.alertDiv.add({message:v.DetachFailed,style:{position:"absolute"},className:"error"});A.alertDiv.show();z.unmask(A.container)}}},function(){A.alertDiv.add({message:v.DetachFailed,style:{position:"absolute"},className:"error"});A.alertDiv.show();z.unmask(A.container)})}}})}if(this.criteriaView){if(this.collection&&this.collection.length>0&&this.isCriteriaEditable){if(this.activatedView==="ModelView"){B.push({fonticon:"cog",text:v.EditCriteria,handler:function(D,C){A.editCriteria(true)}})}else{if(this.activatedView==="CriteriaView"){B.push({className:"criteriaActiveCog",fonticon:"cog",text:v.EditCriteria,handler:function(D,C){A.editCriteria(false)}})}}}}return B},createHeader:function(){var A=this.container.getElement(".currCriteria-container");if(this.criteriaView){A.setContent(this.criteriaView.getActiveCriteria())}},ondetach:function(I,M,P){var N=false;var C=0;var K=0;var L=0;var E=[];var F=[];var A=[];for(var R=0;R<M.details.length;R++){for(var G=0;G<M.details[R].contexts.content.length;G++){var D=M.details[R].contexts.content[G];if(D.status=="detached"){var B=D.attributes[0].physicalID;var H=I.selectedModelsList.indexOf(B);if(E.indexOf(B)==-1){E.push(B);C++}if(P=="SUCCEED"){if(H!==-1){I.selectedModelsList.splice(H,1)}N=true;I.collection.remove(B)}}else{if(D.status=="ERROR"){if(F.indexOf(D.attributes[0].physicalID)==-1){F.push(D.attributes[0].physicalID)}var J=D.attributes[0].basicData.length;var O="";for(var Q=0;Q<J;Q++){if(D.attributes[0].basicData[Q].name=="name"&&D.attributes[0].basicData[Q].value!=undefined){O=D.attributes[0].basicData[Q].value[0]}}if(D.errorCode=="03"){K++;A.push(O)}else{if(D.errorCode=="02"){L++}}}}}}if(E.length!=null&&E.length>=1){F.forEach(function(T,S){if(E.indexOf(F[S])!=-1){E.pop(F[S])}})}E.forEach(function(U,S){var T=I.selectedModelsList.indexOf(E[S]);if(T!==-1){I.selectedModelsList.splice(T,1)}N=true;I.collection.remove(E[S])});if(M.result=="FAILED"&&(C>=1||K>=1||L>=1)){if(K>=1&&C>=1){I.alertDiv.add({message:v.PartialDetachFailed,style:{position:"absolute"},className:"error"});I.alertDiv.show()}else{if(K>=1&&C==0){A.forEach(function(S,T){I.alertDiv.add({message:A[T]+" "+v.HasEffectivityReferences,style:{position:"absolute"},className:"error"});I.alertDiv.show()})}else{if(L>=1){I.alertDiv.add({message:v.HasProductConfigurationsReferences,style:{position:"absolute"},className:"error"});I.alertDiv.show()}else{I.alertDiv.add({message:v.DetachFailed,style:{position:"absolute"},className:"error"});I.alertDiv.show()}}}}if(N==true){for(var G=0;G<I.selectedModelsList.length;G++){I.collection.get(I.selectedModelsList[G])._attributes.isactive=false}I.selectedModelsList=[]}I.filpflopDivs()},filpflopDivs:function(){if(this.collection.length<=0){this.activatedView="ModelView";this.GridView.setStyle("display","none");this.EmptyView.setStyle("display","flex");this.criteriaContent.setStyle("display","none");var A=this.container.getElement(".currCriteria-container");A.setStyle("display","none")}else{var A=this.container.getElement(".currCriteria-container");A.setStyle("display","flex");if(this.activatedView==="ModelView"){this.GridView.setStyle("display","flex");this.EmptyView.setStyle("display","none");this.criteriaContent.setStyle("display","none")}else{if(this.activatedView==="CriteriaView"){this.GridView.setStyle("display","flex");this.EmptyView.setStyle("display","none");this.criteriaContent.setStyle("display","flex")}}}},flipflopMinusButton:function(){},searchcomponentcallback:function(F,D){var A=[];var F=this;F.iFromSearchPanel=D;for(var C=0;C<D.length;C++){A.push(D[C].get("id"))}z.mask(F.container);var H=function(K,N){if(K.length>0){var J=null;if(F.caid!=""){J={operationheader:{key:"DS-Change-Authoring-Context",value:"pid:"+F.caid}}}var I=[];var M=N;for(C=0;C<F.options.selection.length;C++){I.push(F.options.selection[C].id)}var L=new Promise(function(S,R){var P="/resources/modeler/configuration/authoringServices/setConfiguredObjectInfo?cfgCtxt=1";var T=function(U){S(U)};var Q={version:"1.2",pidList:I,content:{attachCfgCtxt:A,detachCfgCtxt:[],}};if(M!=undefined&&M!=null){Q.content.enabledCriteria={feature:"true",productState:(M.productState=="true")?"true":"false"}}var Q=JSON.stringify(Q);var O=function(U){console.log(U);R(U)};o.makeWSCall(P,"POST","enovia","application/json",Q,T,O,true,J)})}L.then(function(O){if(O.result=="SUCCEED"){F.onattach(F,O);z.unmask(F.container)}else{F.alertDiv.add({message:v.AttachFailed,style:{position:"absolute"},className:"error"});F.alertDiv.show();z.unmask(F.container)}},function(O){if(O.errorID=="103"){F.alertDiv.add({message:v.V5AttachFailed,style:{position:"absolute"},className:"error"});F.alertDiv.show()}else{F.alertDiv.add({message:v.AttachFailed,style:{position:"absolute"},className:"error"});F.alertDiv.show()}z.unmask(F.container)})};var E=F.countExistingCriteria(F.criteriaView.enabledCriteriasUX);if(F.collection&&F.collection.length==0&&E==0){var B;var G=[];A.forEach(function(I){G.push({id:"pid:"+I})});q=null;F.isModelVersionAvailable(G).then(function(M){B=M;var I=M;var L=M.criteria;var K=[];L.forEach(function(Q,O){var N=L[O];var P=[];var P=Object.keys(N);P.forEach(function(S,R){if(N[P[R]]=="TRUE"&&(K.indexOf(P[R])==-1)){K.push(P[R])}})});var J={feature:"true",productState:(K.indexOf("products")>=0)?"true":"false"};H(F.iFromSearchPanel,J)})}else{H(F.iFromSearchPanel)}},countExistingCriteria:function(A){var C=Object.keys(A);var D=A;var B=0;C.forEach(function(F,E){if(D[C[E]]=="true"){B++}});return B},isModelVersionAvailable:function(A){var B=this;if(q!=null){return q}var C=new Promise(function(H,G){var I=[];I=A;var E="/resources/modeler/browsing/model/getcriteria";var F={version:"1.0.0",modelIds:I};F=JSON.stringify(F);var J=function(L){var K=L;var N=L.criteria;var M=[];N.forEach(function(R,P){var O=N[P];var Q=[];var Q=Object.keys(O);Q.forEach(function(T,S){if(O[Q[S]]=="TRUE"&&(M.indexOf(Q[S])==-1)){M.push(Q[S])}})});console.log("resulltArray : "+M);H(L)};var D=function(K){console.log("fail to get last product evolution")};o.makeWSCall(E,"POST","enovia","application/json",F,J,D,true)});q=C;return C},onattach:function(H,F){for(var D=0;D<F.details.length;D++){for(var I=0;I<F.details[D].contexts.content.length;I++){var G=F.details[D].contexts.content[I];if(G.attributes[0].preview_url==""){G.attributes[0].preview_url=H.defaultImage}var A=" ";if(G.attributes[0].data[0].value!=undefined){A=G.attributes[0].data[0].value[0]}if(G.status=="attached"){var C="";var B="";var K="";var J=G.attributes[0].basicData.length;for(var E=0;E<J;E++){if(G.attributes[0].basicData[E].name=="name"&&G.attributes[0].basicData[E].value!=undefined){C=G.attributes[0].basicData[E].value[0]}if(G.attributes[0].basicData[E].name=="owner"&&G.attributes[0].basicData[E].value!=undefined){K=G.attributes[0].basicData[E].value[0]}if(G.attributes[0].basicData[E].name=="current"&&G.attributes[0].basicData[E].value!=undefined){B=G.attributes[0].basicData[6].value[0]}}var G=new H.modelDefination({id:G.attributes[0].physicalID,type:G.attributes[0].type,marketingName:A,name:C,state:B,description:K,label:C,subLabel:C,thumbnail:"",maturity:"",isactive:false,preview_url:G.attributes[0].preview_url,icon:H.defaultIcon,isToPropagate:false});H.collection.add(G)}else{if(G.status=="alreadyAttached"){var C="";var B="";var K="";var J=G.attributes[0].basicData.length;for(var E=0;E<J;E++){if(G.attributes[0].basicData[E].name=="name"&&G.attributes[0].basicData[E].value!=undefined){C=G.attributes[0].basicData[E].value[0]}if(G.attributes[0].basicData[E].name=="owner"&&G.attributes[0].basicData[E].value!=undefined){K=G.attributes[0].basicData[E].value[0]}if(G.attributes[0].basicData[E].name=="current"&&G.attributes[0].basicData[E].value!=undefined){B=G.attributes[0].basicData[6].value[0]}}var G=new H.modelDefination({id:G.attributes[0].physicalID,type:G.attributes[0].type,marketingName:A,name:C,state:B,description:K,label:C,subLabel:C,thumbnail:"",maturity:"",isactive:false,preview_url:G.attributes[0].preview_url,icon:H.defaultIcon,isToPropagate:false});H.collection.add(G)}}}H.filpflopDivs()}},activateSearch:function(){var G="";var F="Model";var C=enoviaServerFilterWidget.myRole;var H='( NOT current:"Inactive")';var J="";var K=new r(true);var E=this;var I=function(L){E.searchcomponentcallback(E,L)};var A=[];for(var B=0;B<this.collection.length;B++){var D=this.collection.at(B);A.push(D.id)}K.activate(G,F,C,I,H,A)},editCriteria:function(A){if(A==true){this.activatedView="CriteriaView"}else{this.activatedView="ModelView"}this.filpflopDivs();this.createToolbar()},createCollection:function(A){var B,D=[];var C=this;var E;if(A.version=="1.0"){E=A.contextInfo}if(E.length>0){E.forEach(function(I){if(I&&I.modelPID){var L="";var J="";var G="";var F="";var P="";var N="";var M="";var H=true;var O=I.content.results[0].basicData.length;for(var K=0;K<O;K++){if(I.content.results[0].basicData[K].name=="type"&&I.content.results[0].basicData[K].value!=undefined){L=I.content.results[0].basicData[K].value[0]}if(I.content.results[0].basicData[K].name=="name"&&I.content.results[0].basicData[K].value!=undefined){N=G=M=J=I.content.results[0].basicData[K].value[0]}if(I.content.results[0].basicData[K].name=="current"&&I.content.results[0].basicData[K].value!=undefined){F=I.content.results[0].basicData[K].value[0]}if(I.content.results[0].basicData[K].name=="owner"&&I.content.results[0].basicData[K].value!=undefined){P=I.content.results[0].basicData[K].value[0]}}if(I.content.results[0].data.length>0){J=I.content.results[0].data[0].value[0]}if(I.content.results[0].preview_url==null){I.content.results[0].preview_url=C.defaultImage}if(I.notContextOf.length==0&&I.notContextOf.length!=undefined&&I.notContextOf.length!=null){H=false}B={id:I.modelPID,type:L||"",marketingName:J||"",name:G||"",state:F,description:P||"",label:N,subLabel:M,thumbnail:"",maturity:"",isactive:false,preview_url:I.preview_url,icon:C.defaultIcon,isToPropagate:H};D.push(B)}})}this.collection=new y(D,{model:this.modelDefination})},getDefaultImage:function(){this.defaultImage=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png";this.defaultIcon=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png"},createView:function(){var A=this;this.gridListView=new c({collection:A.collection,withMultisel:false,selectionMode:"nullToMany",useInfiniteScroll:false,itemView:m,itemViewOptions:{className:"item-view",mapping:{title:"marketingName",image:function(){if(this.model.get("preview_url")==null){return A.defaultImage}else{return this.model.get("preview_url")}},subtitle:function(){var B=new UWA.Element("div",{id:"subtitle",html:"<span class=type>"+this.model.get("subLabel")+"</span>",styles:{"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}});new u({target:B,body:this.model.get("subLabel")});return B.innerHTML},content:function(){var D=this.model.get("state");if(D=="Preliminary"){D=v.Preliminary}else{if(D=="Marketing"){D=v.Marketing}else{if(D=="Review"){D=v.Review}else{if(D=="Active"){D=v.Active}else{if(D=="Inactive"){D=v.Inactive}}}}}var C=new UWA.Element("div",{id:"pcStatus",html:"<span class=type>"+v.Maturity+":"+D+"</span>"});var E=new UWA.Element("div",{id:"pcDesc",html:"<span class=type>"+v.Owner+":"+this.model.get("description")+"</span>",styles:{"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}});var B=new UWA.Element("div",{id:"pcCont"});B.appendChild(C);B.appendChild(E);new u({target:E,body:this.model.get("description")});return B.innerHTML},icon:"icon"},contextualActions:[{id:"PropagateModel",text:v.PropagateModelTooltip,fonticon:"propagate",icon:"PropagateModel",multisel:true,handler:function(G){var F=A.container;z.mask(F);var J=A;var B=G.container.getElementsByClassName("actions-inline-container");var K=null;if(A.caid!=""){K={operationheader:{key:"DS-Change-Authoring-Context",value:"pid:"+A.caid}}}var H=[];var I=[];var C=G.model.get("marketingName");I.push(G.model.id);for(var E=0;E<A.options.selection.length;E++){H.push(A.options.selection[E].id)}var D=new Promise(function(P,O){var M="/resources/modeler/configuration/authoringServices/setConfiguredObjectInfo?cfgCtxt=1";var Q=function(R){P(R)};var N={version:"1.2",pidList:H,content:{attachCfgCtxt:I,detachCfgCtxt:[]}};var N=JSON.stringify(N);var L=function(R){console.log(R);O(R)};o.makeWSCall(M,"POST","enovia","application/json",N,Q,L,true,K)});D.then(function(L){if(L.result=="SUCCEED"){B[0].style.display="none";z.unmask(F);o.showwarning(C.toString()+" "+v.PropagateModelSuccessful,"success")}else{z.unmask(F);o.showwarning(C.toString()+" "+v.PropagateModelFailed,"error")}},function(L){if(L.errorID=="103"){A.alertDiv.add({message:v.V5AttachFailed,style:{position:"absolute"},className:"error"});A.alertDiv.show()}else{A.alertDiv.add({message:v.PropagateModelFailed,style:{position:"absolute"},className:"error"});A.alertDiv.show()}z.unmask(F)})}}]},events:{onItemViewClick:function(C,B){A.ontileviewclick(C,B)},onItemViewCheck:function(C,B){A.ontileviewclick(C,B)}}});this.gridListView.render().inject(this.container.getElement(".gridlistview-dialog-container"))},ontileviewclick:function(C,A){if(A.model._attributes.isactive==true){A.model._attributes.isactive=false;C._selectionState.isActive=false;var B=this.selectedModelsList.indexOf(A.model.id);if(B!==-1){this.selectedModelsList.splice(B,1)}}else{A.model._attributes.isactive=true;C._selectionState.isActive=true;var B=this.selectedModelsList.indexOf(A.model.id);if(B==-1){this.selectedModelsList.push(A.model.id)}}this.createToolbar()}});return x});