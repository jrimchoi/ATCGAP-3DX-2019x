define("UWA/String",["UWA/Core","UWA/Internal/Deprecate"],function(UWA,Deprecate){var Module={};Module.isEmail=(function(){var isEmailRegExp=/^([a-zA-Z0-9_.\-+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return function(string){return isEmailRegExp.test(string)}}());Module.truncate=function(string,length,truncation){length=length||30;truncation=truncation===undefined?"...":truncation;return string.length>length?string.slice(0,length-truncation.length)+truncation:String(string)};Module.cut=function(string,length,truncation){length=length||30;truncation=truncation===undefined?"...":truncation;if(string.length<=length){return String(string)}var i,exclude=".,;!? ",index=-1,truncationLength=truncation.length;for(i=length-truncationLength;i>=0;i--){if(exclude.indexOf(string.charAt(i))!==-1){index=i;break}}if(index<0){index=length-truncationLength}return string.slice(0,index)+truncation};Module.escapeRegExp=function(string){return string.replace(/\\/g,"\\\\").replace(/([\-.*+\?\^$()\[\]{}|])/g,"\\$1")};Module.stripTags=function(string){return string.replace(/ on\w+="[^"]*"/g,"").replace(/<(?!\s*\/?\s*(div|br|dt|dd|th|td|p|pre|h1|h2|h3|h4|h5)\b)[^>]*>/gi,"").replace(/<\/?[^>]+>/gi," ").replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")};Module.stripScripts=function(string,evaluate){var scripts="",text=string.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(full,script){scripts+=script+"\n";return""});if(evaluate===true){eval(scripts)}else{if(UWA.is(evaluate,"function")){evaluate(scripts.trim(),text)}}return text};Module.stripComments=(function(){var escapeSimpleComment=/^\/\/.*/gm,escapeMultiComment=/^\/\*[\S\s]*?\*\//gm;return function(string){return string.replace(escapeSimpleComment,"").replace(escapeMultiComment,"")}}());Module.escapeHTMLEntities=(function(){var entitiesRegExp={},entities={apos:39,minus:8722,circ:710,tilde:732,Scaron:352,lsaquo:8249,OElig:338,lsquo:8216,rsquo:8217,ldquo:8220,rdquo:8221,bull:8226,ndash:8211,mdash:8212,trade:8482,scaron:353,rsaquo:8250,oelig:339,Yuml:376,yuml:255,fnof:402,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,sbquo:8218,bdquo:8222,dagger:8224,Dagger:8225,hellip:8230,permil:8240,prime:8242,Prime:8243,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830,quot:34,amp:38,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,hibar:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254};function hasEntities(string){return string.match(/&([a-z]+;)/gi)}function getEntityRegExp(entity){if(!entitiesRegExp[entity]){entitiesRegExp[entity]=new RegExp("&"+entity+";","g")}return entitiesRegExp[entity]}return function(string){var entity,entityRegExp;if(hasEntities(string)){for(entity in entities){if(entities.hasOwnProperty(entity)){entityRegExp=getEntityRegExp(entity);string=string.replace(entityRegExp,"&#"+entities[entity]+";")}}}return String(string)}}());Module.globToRegex=function(string){var regexString=Module.escapeRegExp(string).replace(/\\\*/g,".*").replace(/\\\?/g,".").replace(/\\\{/g,"(").replace(/\\\}/g,")").replace(/,/g,"|");return new RegExp("^"+regexString+"$")};Module.escapeHTML=(function(){var map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},re=/[&<>"'\/]/g,reTagsOnly=/[<>\/]/g;function replace(str){return map[str]}return function(string,tagsOnly){return String(string).replace(tagsOnly?reTagsOnly:re,replace)}}());Module.unescapeHTML=function(string){var div=document.createElement("div");div.innerHTML=Module.stripTags(string).replace(/"/g,"&quot;");return div.childNodes[0]?div.childNodes[0].nodeValue:""};Module.ucfirst=function(string){var f=string.charAt(0).toUpperCase();return f+string.substr(1)};Module.lcfirst=function(string){var f=string.charAt(0).toLowerCase();return f+string.substr(1)};Module.capitalize=function(string){var stringUpper=string.toUpperCase();var stringLower=string.toLowerCase();var inWord=false;var result="";for(var i=0;i<string.length;i++){if(stringUpper[i]===stringLower[i]){result+=string[i];inWord=false}else{if(inWord){result+=string[i]}else{result+=stringUpper[i];inWord=true}}}return result};Module.camelCase=(function(){var alphaUpperRegExp=/([A-Z]+)/g,separatorDotRegExp=/[\-_\s](.)/g,separatorRegExp=/[\-_\s]/g;return function(string){string=String(string).replace(alphaUpperRegExp,function(m,l){return l.substr(0,1).toUpperCase()+l.toLowerCase().substr(1,l.length)}).replace(separatorDotRegExp,function(m,l){return l.toUpperCase()}).replace(separatorRegExp,"").trim();return Module.lcfirst(string)}}());Module.unCamelCase=(function(){var alphaRegExp=/([a-z])([A-Z])/g,alphaUppperLowerRegExp=/\b([A-Z]+)([A-Z])([a-z])/;return function(string,separator){separator=separator||"-";return string.toString().replace(alphaRegExp,"$1"+separator+"$2").replace(alphaUppperLowerRegExp,"$1"+separator+"$2$3").toLowerCase()}}());function parseColorToArray(color){color=color.replace(/\s+/g,"");var numberWidth,number,result=false,match=color.match(/^rgb(a?)\(((?:\d{1,3},)*\d{1,3})\)/);if(match){result=match[2].split(",").map(function(i){return parseInt(i,10)});if((!match[1]&&result.length!==3)||(match[1]&&result.length!==4)){result=false}}else{match=color.match(/^#?((?:[a-f0-9]{3}){1,2})$/i);if(match){numberWidth=match[1].length===3?1:2;result=[];for(var i=0;i<match[1].length;i+=numberWidth){number=parseInt(match[1].substr(i,numberWidth),16);if(numberWidth===1){number=number*16+number}result.push(number)}}else{if(color==="transparent"){result=[0,0,0,0]}}}return result}Module.rgbToHex=function(string,array){var color=parseColorToArray(string);if(color){if(array){color=color.map(function(value){return parseInt(value.toString(16),10)})}else{if(color[3]===0){color="transparent"}else{color="#"+color.slice(0,3).map(function(value){return("0"+value.toString(16)).slice(-2)}).join("")}}}return color};Module.hexToRgb=function(string,array){var color=parseColorToArray(string);if(color&&!array){color=(color.length===3?"rgb(":"rgba(")+color.join(", ")+")"}return color};Module.format=(function(){var numRegExp=/\{(\d+)\}/g;return function(string){var args=arguments;return string.replace(numRegExp,function(m,i){return args[Number(i)+1]})}}());Module.parseRelativeTime=function(string,offset){var relativeTime,matches,time,delta,deltaToMidnight,midnight=new Date(),day=86400,i18n=UWA.i18n;midnight=new Date(midnight.getFullYear(),midnight.getMonth(),midnight.getDate()).getTime();if(typeof offset!=="number"){offset=0}matches=string.match(/^(\d\d\d\d)\-(\d\d)\-(\d\d) (\d\d):(\d\d):(\d\d)$/);if(matches){time=new Date(matches[1],matches[2]-1,matches[3],matches[4],matches[5],matches[6]).getTime()}else{if(/^\d{13}$/.test(string)){time=parseInt(string,10)}else{if(/^\d{10}$/.test(string)){time=parseInt(string,10)*1000}else{time=Date.parse(string.replace(/\//g,"-"))}}}offset*=3600;delta=(new Date()-time)/1000+offset;deltaToMidnight=(midnight-time)/1000+offset;if(isNaN(delta)){relativeTime=false}else{if(delta<60){relativeTime=i18n("less than a minute ago")}else{if(delta<120){relativeTime=i18n("about a minute ago")}else{if(delta<(45*60)){relativeTime=Module.format(i18n("{0} minutes ago"),Math.round(delta/60))}else{if(delta<(90*60)){relativeTime=i18n("about an hour ago")}else{if(deltaToMidnight<0){relativeTime=Module.format(i18n("about {0} hours ago"),Math.round(delta/3600))}else{if(deltaToMidnight<86400){relativeTime=i18n("yesterday")}else{relativeTime=Module.format(i18n("{0} days ago"),Math.ceil(deltaToMidnight/day))}}}}}}}return relativeTime};Module.makeClickable=function(string){var reLink=/((\w+:\/\/(\w+(:\w+)?@)?)|www\.)[^\s<$]+/;var reMail=/([\/:\w\+\_\-]+(\.[\w\+\_\-]+)*@[\w\.\-]+)/;return string.replace(/(^|[\s>])([^\s<>"']+?)(?=$|[\s<])/gm,function(whole,before,chunk){if(reLink.test(chunk)){var url=chunk.replace(/([\.!\?:;\)\]]$)/,""),text=chunk;if(/^www\./.test(url)){url="http://"+url}return before+'<a href="'+url+'" target="_blank">'+text+"</a>"}else{if(reMail.test(chunk)){var str=chunk;if(!/^[\w]+:\/\//.test(str)){str='<a href="mailto:'+str+'">'+str+"</a>"}return before+str}}return whole})};var originalContains=String.prototype.contains;var contains=function(string,searchString,separator){if(UWA.is(separator,"string")){string=separator+string+separator;searchString=separator+searchString+separator}return originalContains.call(string,searchString)};Module.highlight=function(string){Deprecate.warn("UWA.String.highlight");return string};Module.test=function(string,regexp,modifier){Deprecate.warn("UWA.String.test","Use regexp.test(string) instead");return((typeof regexp==="string")?new RegExp(regexp,modifier):regexp).test(string)};Deprecate.uncurryAlias(Module,String.prototype,"UWA.String","String");String.prototype.contains=function(searchString,separator){if(UWA.is(separator,"string")){Deprecate.warn('String#contains(substring, "string")','Use UWA.String.contains(string, substring, "string") instead');return contains(this,searchString,separator)}return originalContains.apply(this,arguments)};Module.contains=contains;function FakeString(){Deprecate.warn("UWA/String as a constructor","Use the native String instead.");return String.apply(null,arguments)}Object.assign(FakeString,Module);return UWA.namespace("String",FakeString,UWA)});