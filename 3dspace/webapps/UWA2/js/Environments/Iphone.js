define("UWA/Environments/Iphone",["UWA/Core","UWA/String","UWA/Utils","UWA/Utils/Client","UWA/Element","UWA/Environment","UWA/Data","UWA/Controls/Scroller","UWA/Controls/Notify","UWA/Storage/Adapter/Dom","UWA/Storage/Adapter/IE","UWA/Storage/Adapter/Cookies","UWA/Storage/Adapter/Object","UWA/Storage/Adapter/Html5"],function(g,d,h,e,b,j,i,f,c){i.useOfflineCache=true;var a,k=window.navigator.standalone;a=j.extend({name:"iphone",defaultOptions:{formOptions:{nativeInputs:true}},init:function(l){this._parent(l);if(String(location.hash).contains("debugCache")){this.enableCacheDebug()}if(String(location.hash).contains("logCache")){this.enableCacheLog()}},onInit:function(){var m=document.body,l=b.getElement.bind(m);this.html={viewport:window,wrapper:l(".module"),header:l(".moduleHeader"),content:l(".moduleWrapper"),body:l(".moduleContent"),edit:l(".moduleEdit"),footer:l(".moduleFooter"),counter:l(".counter"),title:l(".title"),icon:l(".icon"),shareAction:l(".share"),refreshAction:l(".refresh"),editAction:l(".edit")};if(!this.scroller){this.scroller=new f(this.html.content,{snap:false,bounce:true,lockDirection:true,momentum:true,threshold:0});this.onResize()}window.scrollTo(0,1)},onRegisterWidget:function(l){this._parent(l)},afterLoad:function(){var m=this.getData("__lastBookmark"),l=Date.now()-(3600*1000);if(!k&&(String(location.hash).contains("welcome")||(!m||m<l))){this.showBookmarkNotify()}},onResize:function(){var n=this.html,m=e.getSize(),l=m.height;if(l!==this.prevHeight){this.prevHeight=l;if(this.scroller){["header","footer"].forEach(function(o){l-=n[o]?n[o].offsetHeight:0});this.scroller.setOptions({height:l});this.scroller.onRefresh()}this.hideAddressBar()}},onShowEdit:function(){if(this.scroller){this.scroller.setPosition(0,0,0,true)}this._parent()},onHideEdit:function(){if(this.scroller){this.scroller.setPosition(0,0,0,true)}this._parent()},onOpenURL:function(l){if(!k){this._parent(l)}},hideAddressBar:function(){if(!window.location.hash){if(document.height<window.outerHeight){document.body.style.height=(window.outerHeight+50)+"px"}this.setDelayed("scrollTo",function(){window.scrollTo(0,1)},50)}},showBookmarkNotify:function(){var m,n,l={ios:'Install this web app on your iOS device: tap &laquo;<strong class="{0}">+</strong>&raquo; and then &laquo;<strong>Add to Home Screen</strong>&raquo;.',other:"Install this web app on your browser just <strong>Bookmark It</strong>!"};if(e.Platform.tablet){n={className:"uwa-notify-ios uwa-notify-ipad",from:"bottom",to:"top"}}else{n={className:"uwa-notify-ios uwa-notify-iphone",from:"top",to:"bottom"}}m=new c(n);m.addMessage(d.format(g.i18n(l[e.Platform.ios?"ios":"other"]),e.Engine.version>=4.2?"share":"plus"));m.inject(this.scroller.elements.scroller,"top");this.setData("__lastBookmark",Date.now())},enableCacheDebug:function(){var l=window.applicationCache;window.addEventListener("load",function(){l.addEventListener("updateready",function(){if(l.status===l.UPDATEREADY){l.swapCache();if(window.confirm("A new version of this application is available. Load it?")){window.location.reload()}}},false);l.addEventListener("error",function(){window.alert("Error: Unable to activate application offline capabilities!")},false)},false)},enableCacheLog:function(){console.log("ApplicationCache: debug start");var l=["uncached","idle","checking","downloading","updateready","obsolete"],m=window.applicationCache;function n(s){var p,o,q,r;p=(navigator.onLine)?"yes":"no";o=l[m.status];q=s.type;r="ApplicationCache: online: "+p;r+=", event: "+q;r+=", status: "+o;if(q==="error"&&navigator.onLine){r+=" (prolly a syntax error in manifest)"}console.log(r)}m.addEventListener("cached",n,false);m.addEventListener("checking",n,false);m.addEventListener("downloading",n,false);m.addEventListener("error",n,false);m.addEventListener("noupdate",n,false);m.addEventListener("obsolete",n,false);m.addEventListener("progress",n,false);m.addEventListener("updateready",n,false);m.addEventListener("updateready",function(){m.swapCache();console.log("swap cache has been called")},false);this.setPeriodical("cacheUpdate",function(){m.update()},10000)}});return a});