define("UWA/Controls/DatePicker",["UWA/Core","UWA/Date","UWA/Event","UWA/Controls/Calendar","UWA/Controls/Abstract","UWA/Controls/Picker"],function(g,d,a,e,f,c){var b;b=c.extend({name:"uwa-datepicker",options:{format:"%x",calendarOptions:{},button:{tag:"div","class":"uwa-icon uwa-icon-only calendar"},time:false,utc:false},setOptions:function(h){if(!h){h={}}if(h.date){h.value=h.date/1000}return this._parent(h)},syncInput:function(){var i=this.elements,h=this.getDate();if(i.value){i.value.setText(h?d.strftime(h,this.options.format):"")}if(i.calendar){i.calendar.setDate(h)}if(i.time&&h){i.time.getElement(".value").setText(d.strftime(h,"%x"));i.time.getElements("input").forEach(function(j){j.value=h["get"+j.getAttribute("data-action")]()||""})}},onChange:function(){this.dispatchEvent("onDateSelect",[this.getDate()])},onOpen:function(){this._parent();var h=this.elements;h.calendar.refreshLimit();if(h.time){h.time.hide();h.calendar.show()}},buildContent:function(){var i=this,h;function j(k){var l=i.getDate();if(l){l.setDate(k.getDate());l.setMonth(k.getMonth());l.setFullYear(k.getFullYear())}else{l=k}i.setDate(l);if(i.options.time){i.elements.calendar.hide();i.elements.time.show().getElement("input").select();i.elements.dropdown.updatePosition()}else{i.toggle(false);i.dispatchEvent("onChange",[i.getValue()])}}h=function(m){var k=this,l=a.whichKey(m);if(l.length===1&&isNaN(l)){a.preventDefault(m)}setTimeout(function(){var o,n,p=i.getDate()||new Date();p["set"+k.getAttribute("data-action")](k.value);i.setDate(p);if(k.value.length>=2){o=i.elements.time.getElements("input");n=(o.indexOf(k)+1)%o.length;o[n].select()}},1)};i.elements.content=g.createElement("div",{html:[i.elements.calendar=new e(g.extend({_root:false},i.options.calendarOptions)).setDate(this.getDate()).addEvent("onDateSelect",j),i.elements.time=i.options.time&&g.createElement("div",{"class":i.getClassNames("-time"),html:[{tag:"div","class":"value"},{tag:"input",type:"text","class":i.getClassNames("-text"),"data-action":"Hours",events:{keydown:h}},":",{tag:"input",type:"text","class":i.getClassNames("-text"),"data-action":"Minutes",events:{keydown:h}}]}).hide()]});return i.elements.content},buildNavigationItem:function(h){if(h.date){h.value=h.date/1000}return this._parent(h)},setDate:function(h){if(h&&this.options.utc){h=h.getTime()-h.getTimezoneOffset()*60000}return this.setValue(h/1000||"")},getDate:function(){var h=this.getValue();if(h){if(this.options.utc){h=Number(h)+new Date().getTimezoneOffset()*60}return new Date(h*1000)}},setLimit:function(h){if(this.elements.calendar){this.elements.calendar.setLimit(h)}else{this.setOptions({calendarOptions:{limit:h}})}return this}});return g.namespace("Controls/DatePicker",b,g)});