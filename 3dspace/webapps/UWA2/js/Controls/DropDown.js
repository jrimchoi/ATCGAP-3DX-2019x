define("UWA/Controls/DropDown",["UWA/Core","UWA/Event","UWA/Element","UWA/Controls/Abstract","UWA/Utils/Client","UWA/Utils/Scroll"],function(h,a,b,g,e,f){var d,c=e.Features.eventCapture;d=g.extend({name:"uwa-dropdown",defaultOptions:{position:{},positionOptions:{boundary:"auto"},global:false},init:function(i){this._parent(i);this.clickOutsideEvent=function(n){var l=n&&a.getElement(n);var j=this.elements.container;var m=l.isInjected(j);var k=g._getClosestControlsFromElement(l).some(function(o){return o.getContent().isInjected(j)});if(!m&&!k){this.dispatchEvent("onClickOutside",[n])}}.bind(this)},destroy:function(){this.hide();this._parent()},getContent:function(){var i=this.elements;if(!i.container){i.container=h.createElement("div",{"class":this.getClassNames()+(this.options.global?" global":""),events:{click:this.dispatchEvent.bind(this,"onClick"),mouseleave:this.dispatchEvent.bind(this,"onMouseLeave")}});if(this.options.global){i.bacon=h.createElement("div",{"class":this.getClassNames("-bacon")}).hide();this._scrollPrevention=function(l){var k=a.getElement(l);var j=this.getInnerElement();if(j!==k&&!k.isInjected(j)){a.preventDefault(l)}}.bind(this);f.preventParentScroll(i.container,{onlyScrollable:false})}else{i.container.hide()}g._linkElementToControl(this,i.container);if(!c){i.capture=h.createElement("div",{styles:{width:"100%",height:"100%",position:"absolute",zIndex:1000,top:0,left:0},events:{click:this.clickOutsideEvent}})}}return i.bacon||i.container},onClick:function(i){a.stopPropagation(i);this.hide()},onPostInject:function(){this.updatePosition()},onShow:function(){if(this.options.global){this.elements.container.inject(document.body);b.addEvent.call(document.body,"mousewheel",this._scrollPrevention,null,true)}this.updatePosition();if(this.hasEvent("onClickOutside")){if(c){b.addEvent.call(document,"click",this.clickOutsideEvent,null,0,true)}else{this.elements.capture.inject(document.body)}}},onHide:function(){if(this.options.global){this.elements.container.remove();b.removeEvent.call(document.body,"mousewheel",this._scrollPrevention,true)}if(c){b.removeEvent.call(document,"click",this.clickOutsideEvent,true)}else{this.elements.capture.remove()}},onRemoved:function(){var j=this.elements;var i=j.bacon||j.container;if(i){i.hide()}if(this.options.global&&j.container){j.container.remove()}if(this._scrollPrevention){b.removeEvent.call(document.body,"mousewheel",this._scrollPrevention,true)}},isOpen:function(){return !!this.elements.container&&this.getContent().getStyle("display")!=="none"},toggle:function(i){if(!h.is(i)){i=!this.isOpen()}this[i?"show":"hide"]();return this},setPosition:function(i,j){h.extend(this.options,{position:i,positionOptions:j||{}},true);return this.updatePosition()},updatePosition:(function(){function i(j){return h.is(j,"function")?j():j}return function(){if(this.isOpen()){this.dispatchEvent("onPreUpdatePosition");this.elements.container.setPosition(i(this.options.position),i(this.options.positionOptions))}return this}}()),getInnerElement:function(){this.getContent();return this.elements.container}});d.Pointy=d.extend({name:"uwa-pointydropdown",defaultOptions:{autoPosition:["below-center","right-center","left-center","above-center"],margin:12},updatePosition:function(){this.dispatchEvent("onPreUpdatePosition");var o,n,i,k=this.options,m=k.margin,j;var l=30;if(k.target){o=k.target.getDimensions()}else{o={width:0,height:0}}n=this.elements.container.getDimensions();i=k.autoPosition.map(function(r){r=r.split("-");var q=r[0],s=r[1]||"center",p={x:0,y:0};p.place=q;p.align=s;if(q==="below"){p.y=o.height+m}else{if(q==="above"){p.y=-n.outerHeight-m}else{if(s==="center"){p.y=o.height/2-n.outerHeight/2}else{if(s==="end"){p.y=Math.max(o.height,l)-n.outerHeight}}}}if(q==="left"){p.x=-n.outerWidth-m}else{if(q==="right"){p.x=o.width+m}else{if(s==="center"){p.x=o.width/2-n.outerWidth/2}else{if(s==="end"){p.x=Math.max(o.width,l)-n.outerWidth}}}}if(!k.target){p.x+=k.position.x||0;p.y+=k.position.y||0;if(s!=="center"){if(q==="right"||q==="left"){p.y-=l/2}if(q==="above"||q==="below"){p.x-=l/2}}}return p});if(this.isOpen()){j=this.elements.container;j.setPosition(i,h.merge({relative:k.target},this.options.positionOptions));i=i[0];if(this._containerClassName){j.removeClassName(this._containerClassName)}this._containerClassName=i.place+" "+i.align;j.addClassName(this._containerClassName);this.updatePointPosition(i.place)}return this},updatePointPosition:function(j){var m=this.options.target,n=this.elements.container,l=10,p=n.getSize(),o=n.getOffsets(),i=m?m.getSize():{height:0,width:0},k=m?m.getOffsets():this.options.position,q={bottom:null,left:null,right:null,top:null};k.x-=o.x;k.y-=o.y;if(j==="below"||j==="above"){q.left=k.x+i.width/2;if(q.left<l||q.left>p.width-l){q.left=p.width/2}if(j==="below"){q.top=0}else{q.bottom=0}}else{q.top=k.y+i.height/2;if(q.top<l||q.top>p.height-l){q.top=p.height/2}if(j==="right"){q.left=0}else{q.right=0}}this.elements.point.setStyles(q).setText({above:"j",below:"k",left:"m",right:"l"}[j]||" ").toggleClassName("side",j==="left"||j==="right")},getInnerElement:function(){this.getContent();return this.elements.inner},getContent:function(){var j=this.elements;var i=this._parent();if(!j.inner){j.container.setContent(j.inner=h.createElement("div",{"class":this.getClassNames("-inner")}),j.point=h.createElement("div",{"class":this.getClassNames("-point")}))}return i}});return h.namespace("Controls/DropDown",d,h)});