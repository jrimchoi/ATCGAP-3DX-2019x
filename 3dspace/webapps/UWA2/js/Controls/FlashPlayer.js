define("UWA/Controls/FlashPlayer",["UWA/Core","UWA/Utils","UWA/String","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Controls/Abstract","UWA/Controls/Flash"],function(e,g,b,c,i,a,f,d){var h=f.extend({className:"uwa-flashplayer",defaultOptions:{flashVars:"",flashUrl:"",width:"",height:"",wmode:"opaque",aspectRatio:1.3,showToolbar:true,showFullScreenLink:true},isFullScreen:false,init:function(j){this._parent(j);this.buildSkeleton()},buildSkeleton:function(){var j=this.elements;j.container=e.createElement("div",{"class":this.className,align:"center"});j.container.hide()},buildLinks:function(j,l){var k=this.options,m=this.elements;m.links=e.createElement("p",{align:"center"});if(k.showFullScreenLink){e.createElement("a",{href:"#flashPlayer-FullScreen",text:e.i18n("Full screen"),events:{click:function(n){i.stop(n);this.toogleFullScreenMode(true)}.bind(this)}}).inject(m.links);m.links.appendText(" | ")}if(j&&l){e.createElement("a",{href:j,rel:"external",html:b.stripTags(l)}).inject(m.links);m.links.appendText(" | ")}e.createElement("a",{href:"#flashPlayer-Close",html:"<strong>"+e.i18n("Close Video")+"</strong>",events:{click:function(n){i.stop(n);this.hide()}.bind(this)}}).inject(m.links);m.links.inject(m.container)},toogleFullScreenMode:function(k){k=(k?true:false);var l=c.getSize(),j=this.elements;if(k){this.isFullScreen=true;window.scrollTo(0,0);a.setStyle.apply(document.body,["overflow","hidden"]);j.fullScreenContainer=e.createElement("div",{align:"center",styles:{backgroundColor:"#000",position:"absolute",top:0,left:0,width:l.width+"px",height:l.height+"px"}}).inject(document.body);j.flashObject.inject(j.fullScreenContainer);this.buildCloseFullScreenButton()}else{this.isFullScreen=false;j.flashObject.inject(j.flashContainer,"top");j.fullScreenCloseButton.remove();j.fullScreenContainer.remove();a.setStyle.apply(document.body,["overflow",""])}this.onResize()},buildCloseFullScreenButton:function(){var j=this.elements;j.fullScreenCloseButton=e.createElement("input",{type:"button",value:e.i18n("Close FullScreen"),styles:{position:"absolute",top:"2px",right:"2px"}}).inject(j.fullScreenContainer);if(c.Engine.ie&&c.Engine.version>6){j.fullScreenCloseButton.style.width=(j.fullScreenCloseButton.value.length)+"em"}j.fullScreenCloseButton.addEvent("click",function(k){i.stop(k);this.toogleFullScreenMode(false)}.bind(this))},show:function(m,l,j){if(j){this.setOptions(j)}j=this.options;var k=this.elements;if(m||l){j.flashUrl=m;j.flashVars=l}if(/\.flv$/.test(j.flashUrl)){j.flashVars="flv="+encodeURIComponent(j.flashUrl)+"&showplayer=autohide&autoplay=1&showvolume=1&showtime=1";j.flashUrl=e.hosts.uwa+e.paths.img+"flash/player_flv.swf"}if(c.Engine.ie&&j.flashUrl.indexOf("?")!==-1){j.flashUrl+=("&"+g.random(100))}k.container.empty();k.flashControl=new d({_root:false,url:j.flashUrl,width:j.width,height:j.height,flashVars:j.flashVars,wmode:j.wmode,styles:{width:j.width,height:j.height}}).inject(k.container);k.flashContainer=k.flashControl.elements.container;k.flashObject=k.flashControl.getFlashContainer();if(j.showToolbar){this.buildLinks(j.mediaLinkUrl,j.mediaLinkText)}k.container.show();this.onResize()},hide:function(){var j=this.elements;if(j.container){j.container.empty();j.container.hide()}},onResize:function(){var m,j,l,n=this.elements,k=this.options,o=c.getSize();if(this.isFullScreen){n.fullScreenContainer.setStyles({height:o.height+"px",width:(o.width-c.getScrollbarWidth())+"px","z-index":1})}if(n.flashObject){m=n.flashObject.getParent().getDimensions();if(k.width){l=k.width}else{l=m.innerWidth}if(k.height){j=k.height}else{j=Math.min(o.height,l/k.aspectRatio)}n.flashObject.setStyles({height:j+"px",width:l+"px"});n.flashObject.setAttribute("height",j);n.flashObject.setAttribute("width",l)}}});return e.namespace("Controls/FlashPlayer",h,e)});