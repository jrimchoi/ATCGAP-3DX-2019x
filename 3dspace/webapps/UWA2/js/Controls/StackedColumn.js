define("UWA/Controls/StackedColumn",["UWA/Core","UWA/String","UWA/Element","UWA/Controls/Segmented","UWA/Controls/ToolTip"],function(f,d,b,c,a){var e=c.extend({defaultOptions:{spacer:0.5,showText:true,hoverColors:null,minHeight:10,className:"uwa-stackedColumn"},init:function(g){this.total=0;this._parent(g);if(this.options.hoverColors){this.baseEvents()}},addItem:function(i,g){var j,h=this;this._parent(i,g);this.total+=g.value;this.updatePourcents();this.elements.items[i].addEvent("click",function(){h.dispatchEvent("onClick",[i,g,this])});b.addEvent.call(this.elements.items[i],"mouseenter",function(){h.dispatchEvent("onMouseOver",[i,g,this])});b.addEvent.call(this.elements.items[i],"mouseleave",function(){h.dispatchEvent("onMouseOut",[i,g,this])});if(this.options.toolTip&&this.options.toolTip.formatter){j=new a(this.elements.items[i],this.options.toolTip.formatter(g.raw,g.raw.type),{width:this.options.toolTip.width||120,fx:false})}},updatePourcents:function(){var h,g=this.elements.items;for(h in g){if(g.hasOwnProperty(h)){this.updateItem(h,g[h])}}},updateItem:function(l,k){var g=this.options.data[l],i=g.value/this.total*100,j=i,h='<p>{0}<span class="pourcent">{1}%</span></p>';k.setStyle("background-color",g.background);if(!k.hasClassName(this.options.className+"-item-last")){k.setStyle("margin-right",this.options.spacer+"%")}j=i-this.options.spacer;k.setStyle("width",j+"%");k.empty();if(this.options.showText){k.setHTML(d.format(h,g.text,Math.round(i)))}else{k.setStyle("height",this.options.minHeight+"px")}},updateItemColor:function(h,g){if(this.options.data[h]){this.options.data[h].background=g;this.elements.items[h].setStyle("background-color",g)}},toggleItemColor:function(h,g){if(this.elements.items[h].getStyle("background-color").toLowerCase()===this.options.data[h].background.toLowerCase()){this.elements.items[h].setStyle("background-color",g)}else{this.elements.items[h].setStyle("background-color",this.options.data[h].background)}},getItemInfo:function(g){return({config:this.options.data[g],dom:this.elements.items[g]})},baseEvents:function(){this.addEvents({onMouseOver:this.toggleBgColors,onMouseOut:this.toggleBgColors})},toggleBgColors:function(i){var h=this.options.data[i],g=this.findColor(h);if(g){this.updateItemColor(i,g)}},findColor:function(i){var h,j,g=this.options.hoverColors;for(h in g){if(g.hasOwnProperty(h)){if(h===i.background){j=g[h];break}else{if(g[h]===i.background){j=h;break}}}}return j}});return f.namespace("Controls/StackedColumn",e,f)});