define("UWA/Controls/Popup",["UWA/Core","UWA/Controls/Abstract"],function(c,b){var a=b.extend({defaultOptions:{url:"about:blank",status:false,toolbar:false,location:false,menubar:false,resizable:false,scrollbars:false,fullscreen:true,width:320,height:240,left:160,top:120},init:function(d){var e=this;e._parent(d)},open:function(d){var e=this;e.close();if(!e.elements.popup){e.buildSkeleton(d)}},close:function(){var d=this;if(d.elements.popup){d.elements.popup.close();d.elements.popup=null;d.dispatchEvent("onClose")}},setPosition:function(e,d){if(this.elements.popup){this.elements.popup.moveBy(parseInt(e,10),parseInt(d,10))}},focus:function(){if(this.elements.popup){this.elements.popup.focus()}},buildSkeleton:function(f){var d,g=this,e=g.options,i=["dependent=yes"],h=["width","height","status","toolbar","location","menubar","personalbar","resizable","scrollbars","fullscreen"];h.forEach(function(k,j){if(j<2&&e[k]){i.push(k+"="+parseInt(e[k],0))}else{if(j>1){i.push(k+"="+(e[k]?"yes":"no"))}}});f=f||e.url;d=window.open(f,"_blank",i.join(","));if(!d||!d.moveBy){g.dispatchEvent("onBlocked")}else{g.elements.popup=d;g.timer=window.setInterval(g.checkClosed.bind(g),100);setTimeout(function(){g.focus();g.setPosition(e.left,e.top);g.dispatchEvent("onOpen")},100)}},checkClosed:function(){var e=this,d=e.elements.popup;if((!d)||d.closed){e.handleApproval()}},handleApproval:function(){var d=this;if(d.timer){window.clearInterval(d.timer);d.timer=null}d.close()}});return c.namespace("Controls/Popup",a,c)});