define("UWA/Controls/Slider",["UWA/Core","UWA/Utils","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Controls/Abstract"],function(g,d,e,a,b,f){var c=f.extend({name:"uwa-slider",defaultOptions:{className:"",isTouch:e.Features.touchEvents,value:0,handleButton:false,handleDragTreshold:40,slider:{html:[{tag:"div","class":"scrubber-wrapper",html:{tag:"div","class":"scrubber",html:[{tag:"div","class":"progress"},{tag:"div","class":"loaded"},{tag:"div","class":"handle handle-hide"}]}}],scrubberClass:"scrubber",progressClass:"progress",handleClass:"handle",loadedClass:"loaded"}},init:function(h){h=h||{};this._parent(h);this.eventNames={start:this.options.isTouch?"touchstart":"mousedown",move:this.options.isTouch?"touchmove":"mousemove",end:this.options.isTouch?"touchend":"mouseup"};this.body=h.body||document.body;this.bodyEvents={};if(this.options.handleButton){this.bodyEvents[this.eventNames.move]=this.onHandleDrag.bind(this);this.bodyEvents[this.eventNames.end]=this.onHandleDragEnd.bind(this)}this._buildSkeleton();this._attachEvents();this.reset()},reset:function(){var h=this;var i=h.elements;h.loadedPercent=0;i.progress.setStyle("width",0);h._updatePosition(0)},show:function(){this.container.show()},hide:function(){this.container.hide()},setValue:function(h){if(h<0||h>100){console.log("The value should be an integer between 0 and 100");return}this.setOption("value",h);this._updatePosition(h)},setLoadedValue:function(h){this.elements.loaded.setStyle("width",h+"%")},onInjected:function(){if(this.options.value>0){this._updatePosition(this.options.value)}},onHandleDragStart:function(i){var j=this.elements.handle,h=a.getPosition(i).x,k=h-j.getPosition(document).x;if(Math.abs(k)<=this.options.handleDragTreshold){a.stop(i);b.addEvents.call(this.body,this.bodyEvents)}},onHandleDrag:function(i){a.stop(i);var j=a.getPosition(i).x;var h=this.elements.scrubber.getParent().getClientRects()[0].left;h=j-h;if(h<0){h=0}else{if(h>this.elements.scrubber.offsetWidth){h=this.elements.scrubber.offsetWidth}}this._updateValue(h)},onHandleDragEnd:function(h){a.stop(h);b.removeEvents.call(this.body,this.bodyEvents);this.drag=null},onProgressBarClick:function(i){var j,h=a.getPosition(i);j=h.x-this.elements.scrubber.getPosition(document).x;this._updateValue(j)},_buildSkeleton:function(){var h,j,k=this,i=k.options,l=i.slider;if(i.container&&g.is(i.container.getElement(".controls-slider"),"element")){h=i.container.getElement(".controls-slider");h.addClassName(this.getClassNames());h.addContent(i.slider.html)}else{h=g.createElement("div",{"class":this.getClassNames(),html:i.slider.html})}j=h.getElement.bind(h);k.elements={scrubber:j("."+l.scrubberClass),progress:j("."+l.progressClass),handle:j("."+l.handleClass),loaded:j("."+l.loadedClass)};if(i.handleButton){k.elements.handle.removeClassName("handle-hide")}k.container=h;return k},_attachEvents:function(){var h=this,i=h.elements,j=h.dispatchEvent.bind(h);if(h.options.handleButton){h.container.addEvent(h.eventNames.start,h.onHandleDragStart.bind(h))}i.scrubber.addEvent("click",j.bind(h,"onProgressBarClick"));return this},_updateValue:function(h){var i=this.elements.scrubber.offsetWidth;var j=Math.round(h*100/i);this.setOption("value",j);this._updatePosition(j);this.dispatchEvent("onChange",j)},_updatePosition:function(k){if(!this.container||!this.container.isInjected()){return}var i=this.elements.progress;var l=this.elements.scrubber;var j=this.elements.handle;var h=(j.offsetWidth/2)/l.offsetWidth*100;i.setStyle("width",k+"%");j.setStyle("left",(k-h)+"%")}});return g.namespace("Controls/Slider",c,g)});