define("UWA/Promise",["UWA/Core","UWA/Utils","UWA/Class","UWA/Internal/Deprecate"],function(c,d,b,g){var f=Promise;function e(j){this._promise=j instanceof f?j:new f(j)}function i(j){return function(){return e.cast(this._promise[j].apply(this._promise,arguments))}}function a(j){return function(){return e.cast(f[j].apply(f,arguments))}}var h=e.prototype=Object.create(f.prototype);h.constructor=e;h["catch"]=i("catch");h.then=i("then");h.fail=h["catch"];h["finally"]=function(k){var l=this;function j(){return e.cast(k()).then(function(){return l})}return this.then(j,j)};h.fin=h["finally"];h.done=function(k,j){return this.then(k,j).fail(function(m){var l=e.deferred();d.setImmediate(function(){d.setImmediate(function(){l.reject(m)});throw m instanceof Error?m:new Error(m)});return l.promise})};h.spread=function(k,j){return this.then(function(l){return k[Array.isArray(l)?"apply":"call"](null,l)},j)};e.race=a("race");e.all=function(j){if(typeof j.length!=="number"){return e.reject(new TypeError("Not an iterable"))}return e.cast(f.all(d.toArray(j)))};e.reject=a("reject");e.resolve=a("resolve");e.cast=function(j){if(j instanceof e){return j}if(j instanceof f){return new e(j)}return e.resolve(j)};e.deferred=function(){var j={};var k=new e(function(m,l){j.resolve=m;j.reject=l;return j});j.promise=k;return j};e.allSettled=function(j){return e.all(d.toArray(j).map(function(k){if(!(k instanceof f)){return{state:"fullfilled",value:k}}return k.then(function(l){return{state:"fullfilled",value:l}},function(l){return{state:"rejected",reason:l}})}))};g.property(b,"Promise",{value:e,name:"UWA.Class.Promise",message:"Use UWA.Promise instead."});return c.namespace("Promise",e,c)});