define("UWA/Services/Geo",["UWA/Core","UWA/Json"],function(c,a){var b=function(f){this.adapter=null;var d,e=c.Services.Geo.Adapters;if(f){if(!e[f]){return new Error("Invalid UWA.Services.Geo AdapterName.")}this.adapter=e[f]()}else{for(d in e){if(e.hasOwnProperty(d)){this.adapter=e[d]();if(this.adapter){break}}}}};b.prototype={getCurrentPosition:function(f,e,d){if(this.adapter){this.adapter.getCurrentPosition(f,e,d)}else{if(c.is(e,"function")){e(new Error("Geolocalization support not found."))}}}};b.Adapters={html5:function(){if(navigator.geolocation!==undefined){return{getCurrentPosition:function(g,f,e){e=e||{};e.enableHighAccuracy=true;var d=function(h){if(h.latitude!==undefined){g({timestamp:h.timestamp,coords:{latitude:h.latitude,longitude:h.longitude}})}else{g(h)}};navigator.geolocation.getCurrentPosition(d,f,e)}}}},freegeoip:function(){return{getCurrentPosition:function(g,f,e){e=c.merge(e||{},{server:"http://freegeoip.net/json/"});var d=function(h){g({timestamp:Date.now(),coords:{latitude:h.latitude,longitude:h.longitude}})};a.request(e.server,{onComplete:d,onFailure:f})}}}};return c.namespace("Services/Geo",b,c)});