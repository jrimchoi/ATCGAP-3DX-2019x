define("DS/PlatfromServicesData/Geovia",["UWA/Core","UWA/Class",],function(a,b){var c=b.singleton({get3DPlayProvider:function(d){return"GEOVIA"}});return c});define("DS/PlatfromServicesData/3DSpace",["UWA/Core","UWA/Class","UWA/Promise","UWA/Class/Debug","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(h,i,f,e,c,d,g,a){var b=i.singleton(e,{init:function(){},getActionsPath:function(j){if(UWA.is(j)&&UWA.is(j.platformID)){return"/resources/SNAPI/search_delegation/actions?tenant="+j.platformID}else{throw ("INVALID inputs for getActionsPath, platformID is missing")}},getActions:function(t){if(UWA.is(t)&&UWA.is(t.models,"array")&&UWA.is(t.data,"object")){var j=function(u){for(var v=0;v<t.models.length;v++){if(t.models[v].get("id")===u){return t.models[v]}}};var s=function(v,u,o){if(UWA.is(v.cmdInfo,"object")){if(UWA.is(v.cmdInfo.type,"string")){v.cmdInfo.type=[v.cmdInfo.type]}if(UWA.is(o,"array")){v.cmdInfo.type=v.cmdInfo.type.concat(o)}else{if(UWA.is(o,"string")){v.cmdInfo.type.push(o)}}}};var q=false;var k=t.models;for(var l=0;l<k.length;l++){var p=k[l];if(UWA.is(p.isAShowOnlyObject,"function")){if(true==p.isAShowOnlyObject()){q=true;break}}}if(false==q){var m={};m.method="POST";m.headers=t.headers||{};m.headers["Content-Type"]="application/json";m.url=t.serviceURL+this.getActionsPath({platformID:t.data.platformId});t.data.applicativeInfo.addOpenWith=false;if(t.models.length===1){if(c.getOption("add_open_with")){t.data.applicativeInfo.addOpenWith=true}else{var r=t.data.applicativeInfo;if(UWA.is(r,"object")&&UWA.is(r.clientAppInfo,"object")){if(UWA.is(r.clientAppInfo.addinmode,"string")&&r.clientAppInfo.addinmode.length>0){t.data.applicativeInfo.addOpenWith=true}}}}if(t.data.objects.length===t.models.length){for(var l=0;l<t.data.objects.length;l++){t.data.objects[l]["isRecentObject"]=t.models[l].isARecentSearchResult()}}m.data=JSON.stringify(t.data);m.onComplete=function(v){var y=h.is(v,"string")?(v.length>0?JSON.parse(v):{}):v;if(true===t.data.applicativeInfo.addOpenWith){if(UWA.is(y.actions,"array")){for(var x=0;x<y.actions.length;x++){var w=y.actions[x];if(UWA.is(w,"object")){var o=w.id;var z=j(o);if(UWA.is(z)&&!z.isARecentSearchResult()){var A=z.get("ds6w:kind_value");if(UWA.is(A)){if(UWA.is(w.actions,"array")){for(var B=0;B<w.actions.length;B++){var u=w.actions[B];if(u.id==="3DCompass_#OpenWith"){s(u,z,A);break}}}}}}}}}if(UWA.is(t.onComplete,"function")){t.onComplete.call(undefined,y)}};m.onFailure=function(o){if(UWA.is(t.onFailure,"function")){t.onFailure.call(undefined,{type:"web_service_failure",error:o})}};g.authenticatedRequest(m.url,m)}else{var n={};if(UWA.is(t.onComplete,"function")){t.onComplete.call(undefined,n)}}}},is3DPlayAvailable:function(m){var k=function(p){m.onComplete.call(undefined,{availability:p})};if(UWA.is(m)&&UWA.is(m.onComplete,"function")){var l=m.model;if(UWA.is(l)){var j=false;if(UWA.is(l.isAShowOnlyObject,"function")){j=l.isAShowOnlyObject()}if(false==j){var n=l.get("ds6w:type_value");var o="DS/3DPlaySupport/AssetSupport";require([o],function(q){var p={provider:"EV6",tenant:l.getPlatformID(),type:l.get("ds6w:type_value"),requiredAuth:"passport",requestsOptions:{authentication:"passport"}};var r={usage:"preview"};q.checkSupport(p,r,function(s){if(s===true){k(true)}else{k(false)}})})}else{k(false)}}else{k(false)}}},get3DPlayOptions:function(k){if(UWA.is(k)&&UWA.is(k.onComplete,"function")&&UWA.is(k.onFailure,"function")){var j=k.model;var l=k.defaultPlayOptions;if(UWA.is(j)&&UWA.is(l)&&UWA.is(k.serviceURL,"string")){if(UWA.is(l.input)&&UWA.is(l.input.asset)){l.input.asset.provider="EV6";l.input.asset.serverurl=k.serviceURL;l.input.asset.tenant=j.getPlatformID();l.input.asset.physicalid=j.id;l.input.asset.dtype=j.get("ds6w:type_value");l.input.asset.requiredAuth="passport";l.input.asset.requestsOptions={authentication:"passport"};k.onComplete.call(undefined,l)}}}},getSubjectURLPrefix:function(j){return"pid://"},getFacets:function(m){var l=this;if(UWA.is(m)&&UWA.is(m.model)&&UWA.is(m.constants)){if(UWA.is(m.setFacets,"function")&&UWA.is(m.addFacets,"function")){if(c.getOption("search_web_in_win")){if(UWA.is(m.setContext,"function")){m.setContext.call(undefined,{getSecurityContext:function(){return{SecurityContext:d.getSecurityContext()}}})}}this._getAvailableRoles({platformID:m.model.getPlatformID(),onComplete:function(n){if(n.indexOf("PAR")>=0){if(UWA.is(m.setReadOnly,"function")){m.setReadOnly.call(undefined,false)}}var o=[m.constants.FACET_PROPERTIES];m.setFacets.call(undefined,o)}});var j=false;if(UWA.is(m.model.isAShowOnlyObject,"function")){j=m.model.isAShowOnlyObject()}if(j==false){var k="DS/ENORIPE_Relations/RelationsTabSettings";require([k],function(n){n.isAvailable(m.model).then(function(o){if(UWA.is(o,"object")&&UWA.is(o.facetInfo)){m.addFacets([o.facetInfo])}else{l.log("facets info is NOT in good format")}},function(){l.log("this facet is not available for this context = "+n)})},function(n){console.warn("Cannot load "+n.requireModules)})}}}},getRelations:function(l){if(UWA.is(l,"object")){var k=l.model;if(UWA.is(k,"object")&&UWA.is(l.onComplete,"function")){var j={parents:[],children:[],drawings:[],simulations:[],configurations:[]};var m=k.getPlatformID();a.getServiceUrl({serviceName:k.getServiceID(),platformId:m,onComplete:function(n){var o="preview-8cae85";g.authenticatedRequest(n+"/resources/enorelnav/navigate/setpreferences?tenant="+m,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify({widgetId:o,relations:["v6_structure_to","v6_structure_from","v6_drawing_from","simulation_from"],countmanagement:false}),onComplete:function(){g.authenticatedRequest(n+"/resources/enorelnav/navigate/getecosystem?tenant="+m,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify({widgetId:o,ids:[k.get("id")]}),onComplete:function(){var p={widgetId:o,id:k.get("id"),debug:false};g.authenticatedRequest(n+"/resources/enorelnav/navigate/detail?tenant="+m,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify(p),onComplete:function(r){var s=JSON.parse(r);if(UWA.is(s.newstructure)){var t=function(w,u){var v=function(x){var y=" ";for(var z=0;z<x.length;z++){y+=x[z]["ds6w:label"]+", "}return y};console.log(w+":"+u.length+v(u))};var q=function(u){var v=[];for(var w=0;w<u.length;w++){v.push(u[w].id)}return v};if(UWA.is(s.newstructure.v6_structure_from,"array")){t("Parents",s.newstructure.v6_structure_from);j.parents=q(s.newstructure.v6_structure_from)}if(UWA.is(s.newstructure.v6_structure_to,"array")){t("Children",s.newstructure.v6_structure_to);j.children=q(s.newstructure.v6_structure_to)}if(UWA.is(s.newstructure.v6_drawing_from,"array")){t("Drawings",s.newstructure.v6_drawing_from);j.drawings=q(s.newstructure.v6_drawing_from)}if(UWA.is(s.newstructure.simulation_from,"array")){t("Simulations",s.newstructure.simulation_from);j.simulations=q(s.newstructure.simulation_from)}j.model=k;l.onComplete.call(undefined,j)}},onFailure:function(q){console.log(q);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}},onTimeout:function(q){console.log(q);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}}})},onFailure:function(p){console.log(p);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}},onTimeout:function(p){console.log(p);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}}})},onFailure:function(p){console.log(p);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}},onTimeout:function(p){console.log(p);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}}})},onFailure:function(n){console.log(n);if(UWA.is(l.onFailure,"function")){l.onFailure.call(undefined,j)}}})}}},getDoubleClickAction:function(k){if(UWA.is(k,"object")&&UWA.is(k.model)&&UWA.is(k.appID)){if("X3DSEAR_AP"===k.appID){var j=k.model.get("ds6w:type_value");if("SavedSearch"===j){k.onComplete.call(undefined,{id:"run_saved_search",sourceJS:"DS/SNResultUX/savedSearch/SavedSearch_ActionHandler"})}else{k.onFailure.call(undefined,"no action available for double click on object of type "+j)}}}},_getAvailableRoles:function(j){if(UWA.is(j)&&UWA.is(j.platformID)&&UWA.is(j.onComplete,"function")){d.getGrantedRoles(function(l){var m=[];for(var k=0;k<l.length;k++){var n=l[k];if(UWA.is(n)&&UWA.is(n.platforms,"array")){if(n.platforms.length===0||n.platforms.indexOf(j.platformID)>=0){m.push(n.id)}}}j.onComplete.call(undefined,m)})}}});return b});define("DS/PlatfromServicesData/OnePart",["UWA/Core","UWA/Class"],function(b,c){var a=c.singleton({getActions:function(e){if(UWA.is(e)&&UWA.is(e.models,"array")){var d="DS/SNResultUX_karma_tst/onePartActions/CompareManager";require([d],function(i){var l=[];var g={actions:[],status:"success"};var h=i.getNbObjectsToCompare({widget_id:e.widget_id});if(e.models.length===1){var k=i.isAlreadyAdded({widget_id:e.widget_id,id:e.models[0].get("id")});g.actions.push({id:e.models[0].get("id"),actions:[{title:"View default configuration",icon:"attributes",id:"view-default-config",multisel:false,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/ConfigViewer"}]});g.actions[0].actions.push({title:"View all configurations",icon:"view-small-tile",id:"view-all-configs",multisel:false,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/ConfigViewer"});if(k){g.actions[0].actions.push({title:"Remove from Compare",icon:"compare-delete",id:"remove-from-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"})}else{g.actions[0].actions.push({title:"Add to Compare",icon:"compare-add",id:"add-to-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"})}if(h>0){var j=true;if(h===1&&k){j=false}if(j){g.actions[0].actions.push({title:"Launch Compare",icon:"compare-on",id:"start-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/Compare"})}}e.onComplete.call(undefined,g)}else{for(var f=0;f<e.models.length;f++){g.actions.push({id:e.models[f].get("id"),actions:[{title:"Add to Compare",icon:"compare-add",id:"add-to-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"}]});g.actions[f].actions.push({title:"Remove from Compare",icon:"compare-delete",id:"remove-from-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/AddRemoveCompare"});g.actions[f].actions.push({title:"Launch Compare",icon:"compare-on",id:"start-compare",multisel:true,sourcejs:"DS/SNResultUX_karma_tst/onePartActions/Compare"})}e.onComplete.call(undefined,g)}})}},is3DPlayAvailable:function(d){if(UWA.is(d)&&UWA.is(d.onComplete,"function")){d.onComplete.call(undefined,{availability:true})}},get3DPlayOptions:function(f){if(UWA.is(f)&&UWA.is(f.onComplete,"function")&&UWA.is(f.onFailure,"function")){var e=f.model;var h=f.defaultPlayOptions;if(UWA.is(e)&&UWA.is(h)){if(UWA.is(h.input)&&UWA.is(h.input.asset)){h.input.asset.provider="FILE";h.input.asset.serverurl=f.serviceURL;h.input.asset.physicalid=e.id;h.input.asset.dtype=e.get("ds6w:type_value");h.input.asset.requiredAuth="passport";h.input.asset.requestsOptions={authentication:"passport"};h.input.asset.filename="/fetch/RAW/application/part/?&source=consolidation-cs_onepart&uri="+encodeURIComponent(e.get("ds6w:source_value"));console.log("play3DOptions.input.asset.filename = "+h.input.asset.filename);var g=e.get("ds6w:label");console.log("modelLabel = "+g);if(UWA.is(g,"string")){var d=g.indexOf(".");if(d>=0){var i=g.substring(d+1,g.length);if(UWA.is(i)){h.input.asset.format=i;console.log("play3DOptions.input.asset.format = "+i)}}}}f.onComplete.call(undefined,h)}}},getFacets:function(d){if(UWA.is(d)&&UWA.is(d.constants)){if(UWA.is(d.setFacets,"function")){var e=[d.constants.FACET_PROPERTIES];d.setFacets.call(undefined,e)}}}});return a});