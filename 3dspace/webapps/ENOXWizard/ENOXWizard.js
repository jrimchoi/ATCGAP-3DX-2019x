define("DS/ENOXWizard/js/ENOXWizard",["DS/Core/ModelEvents","DS/ResizeSensor/js/ResizeSensor","i18n!DS/ENOXWizard/assets/nls/ENOXWizard","text!DS/ENOXWizard/html/ENOXWizard.html","css!DS/ENOXWizard/css/ENOXWizard.css","css!DS/UIKIT/UIKIT.css"],function(ModelEvents,ResizeSensor,nls_ENOXWizard,html_ENOXWizard,css_ENOXWizard,css_UIKIT){var ENOXWizard=function(options){this.isIE=
/*@cc_on!@*/
false||!!document.documentMode;this._init(options)};var LocalEvtManager=function(eventObj){if(eventObj){this._modelEventObj=eventObj;this._tokens=[]}};LocalEvtManager.prototype.subscribe=function(mE,eventInfo,handler){if(eventInfo&&handler&&this._modelEventObj){this._tokens.push(this._modelEventObj.subscribe(eventInfo,handler))}};LocalEvtManager.prototype.cleanup=function(cleanupFor){if(this._tokens&&this._tokens.length>0){var that=this;console.log("[ENOXWizard:LocalEvtManager] Performing event cleanup for: "+cleanupFor);this._tokens.forEach(function(token){that._modelEventObj.unsubscribe(token)})}};ENOXWizard.prototype._init=function(options){this._options=options?UWA.clone(options,false):{};this._modelEvents=options.modelEvents?options.modelEvents:new ModelEvents();this._myEventManager=new LocalEvtManager(this._modelEvents);this._items=options.items?options.items:[];this._currentSelection=options.currentSelection?options.currentSelection:this._items[0].id;this._initDivs();this._addItems(this._items);this._subscribeToEvents()};ENOXWizard.prototype._initDivs=function(){this._container=document.createElement("div");this._container.innerHTML=html_ENOXWizard;this._wizard_container=this._container.querySelector(".create-view-navigator-container");this._rope_container=this._container.querySelector(".ariadne-container");this._rope_place_holder=this._container.querySelector(".ariadne-rope-placeholder");this._rope=this._container.querySelector(".ariadne-rope");this._wizard_view_container=this._container.querySelector(".create-view-navigator")};ENOXWizard.prototype._subscribeToEvents=function(){var that=this;this._myEventManager.subscribe(this._modelEvents,{event:"enox-wizard-remove-item"},function(id){that._removeItem(id)});this._myEventManager.subscribe(this._modelEvents,{event:"enox-wizard-add-item"},function(item){that._addItem(item)});this._myEventManager.subscribe(this._modelEvents,{event:"enox-wizard-add-list-item"},function(items){that._addItems(items)});this._myEventManager.subscribe(this._modelEvents,{event:"enox-wizard-select-item"},function(id){that._removeAllSelection();that._setCurrentSelection(id)});this._myEventManager.subscribe(this._modelEvents,{event:"enox-wizard-remove-all-selection"},function(id){that._removeAllSelection()})};ENOXWizard.prototype._addItems=function(items){for(var i=0;i<items.length;i++){this._addItem(items[i])}};ENOXWizard.prototype._addItem=function(item){var that=this;var view_container=document.createElement("a");view_container.setAttribute("id",item.id);view_container.setAttribute("class","nav-item");view_container.addEventListener("click",function(){that._removeAllSelection();that._setCurrentSelection(this.id);that._modelEvents.publish({event:"enox-wizard-item-click",data:this.id});console.log("Publish enox-wizard-item-click : "+this.id)});var indicator=document.createElement("div");indicator.setAttribute("class","nav-item-active-indicator");var arrowDown=document.createElement("span");arrowDown.setAttribute("class","fonticon fonticon-expand-down");indicator.appendChild(arrowDown);var circleIcon=document.createElement("div");circleIcon.setAttribute("class","nav-item-circle");var icon=document.createElement("span");icon.setAttribute("class",item.icon);circleIcon.appendChild(icon);var name=document.createElement("div");name.setAttribute("class","nav-item-label");name.innerHTML=item.name;view_container.appendChild(indicator);view_container.appendChild(circleIcon);view_container.appendChild(name);this._wizard_view_container.appendChild(view_container)};ENOXWizard.prototype._removeItem=function(id){var childToRemove=document.getElementById(id);this._wizard_view_container.removeChild(childToRemove)};ENOXWizard.prototype._setCurrentSelection=function(id){this._currentSelection=id;if(this._currentSelection){var element=document.getElementById(this._currentSelection);if(element){if(!element.classList.contains("active")&&!element.classList.contains("filled")){if(this.isIE){element.className+=" active filled"}else{element.classList+=" active filled"}}this._manageRope(this._currentSelection);for(var i=0;i<this._wizard_view_container.childNodes.length;i++){var stepWizard=this._wizard_view_container.childNodes[i];if(stepWizard.id===this._currentSelection){break}if(stepWizard.hasChildNodes()&&stepWizard.classList.contains("nav-item")){stepWizard.className+=" filled"}}}}};ENOXWizard.prototype._removeAllSelection=function(){for(var i=0;i<this._wizard_view_container.children.length;i++){this._wizard_view_container.children[i].classList.remove("active");this._wizard_view_container.children[i].classList.remove("filled");this._rope.style.width="0px"}};ENOXWizard.prototype._manageRope=function(selection){var widthRope;if(selection){var element=document.getElementById(this._currentSelection);if(!element){widthRope=Math.ceil(100/this._items.length);this._rope.style.width=widthRope+"%"}else{var position=element.children[1].children[0].getBoundingClientRect();this._rope.style.width=position.left+"px"}}};ENOXWizard.prototype._find=function(array,id){var currentObj;array.forEach(function(item){if(item.id===id){currentObj=item;return}});if(!currentObj){currentObj=array[0]}return currentObj};ENOXWizard.prototype._resize=function(){this._manageRope(this._currentSelection)};ENOXWizard.prototype.inject=function(parentcontainer){parentcontainer.appendChild(this._container);this._setCurrentSelection(this._currentSelection)};ENOXWizard.prototype.destroy=function(){if(this._myEventManager){this._myEventManager.cleanup("ENOXWizard");this._myEventManager=null}};ENOXWizard.prototype.attachResizeSensor=function(){var that=this;this.resizeSensor=new ResizeSensor(this._container,function(){if(that._container.offsetWidth>0&&that._container.offsetWidth!==that._currentWidth){that._resize();that._currentWidth=that._container.offsetWidth}})};return ENOXWizard});