define("DS/Tweakers/TweakerUtils",["UWA/Core","UWA/Element","DS/Core/Core","DS/Controls/Popup","DS/Controls/Button","DS/Core/PointerEvents","DS/Windows/Dialog","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(f,b,j,e,h,g,l,n,a,d){var c=[];var m={init:function(){},addTypeRepFactory:function(o){c.push(o)},removeTypeRepFactory:function(p){var o=c.indexOf(p);if(o!==-1){c.splice(o,1)}},getTypePath:function(q){var s=false;var o=0;while(!s&&o<c.length){if(c&&c[o].typeReps[q]){s=true;var p=c[o].typeUITemplates[c[o].typeReps[q].stdTemplate];var r=c[o].typeReps[q].semantics;return{path:p.path,options:r}}else{if(c&&c[o].typeEnums[q]){return{path:"DS/Tweakers/TweakerEnum",options:c[o].typeEnums[q]}}}o++}},_isFromType:function(q,r){var o=this.getTypePath(q);if(!o){return r}var p=true;switch(o.path){case"DS/Tweakers/TweakerBoolean":p=(/^(true|false|\d+(.\d+)?)$/i.exec(r)!==null);break;case"DS/Tweakers/TweakerString":case"DS/Tweakers/TweakerColor":case"DS/Tweakers/TweakerDate":p=(typeof r==="string");break;case"DS/Tweakers/TweakerNumber":if(o.options&&o.options.decimals===0){p=(parseInt(r,10)===r)}else{p=(parseFloat(r)===r)}break;case"DS/Tweakers/TweakerArray":p=(r.length!=="undefined");break;default:p=true}return p},_getValueFromString:function(r,t,s){var o=this.getTypePath(r);if(!o){return t}var q;switch(o.path){case"DS/Tweakers/TweakerBoolean":q=(/(true|\d*[1-9]\d*(\.\d+)?|0\.\d*[1-9]\d*)/i.exec(t)!==null);break;case"DS/Tweakers/TweakerString":case"DS/Tweakers/TweakerColor":case"DS/Tweakers/TweakerDate":t?q=t.toString():q="";break;case"DS/Tweakers/TweakerNumber":if(t===""){q=0;break}if(o.options&&o.options.decimals===0){q=parseInt(t)}else{q=parseFloat(t)}break;case"DS/Tweakers/TweakerArray":case"DS/Tweakers/TweakerObject":try{q=JSON.parse(t)}catch(u){q=undefined}break;case"DS/Tweakers/TweakerEnum":if(t===""){q=undefined;break}if(!o.options){return}var v=o.options;if(typeof v==="function"){return t}for(var p in v){if(v[p].toString()==t){return v[p]}}if(s===true){for(var p in v){if(p.toString()==t){return v[p]}}}break;default:q=t}return q},_getStringRepresentationFromValue:function(r,s){var o=this.getTypePath(r);if(!o){return s}var q;switch(o.path){case"DS/Tweakers/TweakerEnum":if(s===""){q=undefined;break}if(!o.options){return}var t=o.options;if(typeof t==="function"){return s}for(var p in t){if(t[p]==s){return p}}break;default:q=s}return q},_buildInlineEditor:function(v,t,s,r){var q=f.createElement("div",{"class":"wux-tweakers-multirep wux-tweakers-multirep-inline-editor"});if(t){q.inlinedView=t;if(t._view){var o=t._view;o.getContent().addClassName("wux-tweakers-multirep-tweakerstring");o.inject(q)}else{t.addClassName("wux-tweakers-multirep-tweakerstring");q.appendChild(t)}}if(!r.hasNoButton){q.editBtn=new h({label:"..."});q.editBtn.getContent().addClassName("wux-tweakers-multirep-button");q.editBtn.inject(q)}q.embeddedContainer=undefined;var u=undefined;if(s){var p=function(w){w.stopPropagation();if(u&&u!==v.augmentedDisplay){q.embeddedContainer.destroy()}u=v.augmentedDisplay;if(v.augmentedDisplay==="dialog"){if(!q.embeddedContainer){q.embeddedContainer=m._buildDialog(q,v,s,r);v.onShow()}if(!q.embeddedContainer){return}if(q.embeddedContainer.visibleFlag===false){q.embeddedContainer.visibleFlag=true;v.onShow()}}else{if(v.augmentedDisplay==="popup"){if(!q.embeddedContainer){q.embeddedContainer=m._buildPopup(q,v,t,s,r)}if(!q.embeddedContainer){return}q.embeddedContainer._updateView();q.embeddedContainer.toggle()}}if(s._view&&s._view._giveFocus){s._view._giveFocus()}};if(r.hasNoButton){a.addEventOnElement(v,t,"click",p)}else{a.addEventOnElement(v,q.editBtn,"buttonclick",function(w){w.stopPropagation()});a.addEventOnElement(v,q.editBtn,"click",p);if(r.offset&&t._myInput){a.addEventOnElement(v,t._myInput,"focus",p)}}}return q},_buildPopup:function(p,r,t,w,x){if(w){var y=r.name?r.name.toLowerCase().replace("tweaker",""):"multi-rep";var s=x.hasNoButton?t:p.editBtn;var o=new e({target:s,position:"bottom",offset:{x:0,y:(x.offset?-t.offsetHeight:0)},alignment:"far",className:"wux-controls-popup wux-controls-popup-tweaker-"+y,touchMode:r.touchMode});d.ignoreForRecord(o.getContent());o.getContent().setStyle("height","176px");o.getContent().setStyle("width",((t&&t._view)?t._view.getContent().offsetWidth:t.offsetWidth)+(p.editBtn?p.editBtn.getContent().offsetWidth:0)+"px");o._updateView();var q=function(z){if(o.visibleFlag&&!o.isElementInside(z.target)&&(!p.editBtn||!p.editBtn.getContent().contains(z.target))){o.hide();document.body.removeEventListener(g.POINTERDOWN,q)}};var v=false;a.addEventOnElement(r,o,"show",function(z){z.stopPropagation();a.addEventOnElement(r,document.body,g.POINTERDOWN,q);r.onShow()});a.addEventOnElement(r,o,"hide",function(z){z.stopPropagation();r.onHide({cancelFlag:v})});a.addEventOnElement(r,o,"keydown",function(z){if(!z.altKey&&!z.shiftKey&&!z.ctrlKey){if(z.keyCode===n.ESCAPE){v=true;o.hide();v=false}else{if(z.keyCode===n.ENTER){o.hide()}}}});var u=w._view?w._view:w;o.setBody(u);return o}return undefined},_buildDialog:function(p,r,v){var t=undefined;var s=function(x){x.stopPropagation();t.visibleFlag=false;r.onHide({cancelFlag:true})};t=new l({title:r.dialogOptions.title?r.dialogOptions.title:r.name,icon:r.dialogOptions.icon,content:v,resizableFlag:true,height:r.dialogOptions.height?r.dialogOptions.height:240,width:r.dialogOptions.width?r.dialogOptions.width:200,identifier:r.dialogOptions.identifier?r.dialogOptions.identifier:"",buttons:{Ok:new h({onClick:function(y){y.stopPropagation();t.visibleFlag=false;var x=document.createEvent("Event");r.onHide()}}),Cancel:new h({onClick:s})},autoCloseFlag:false,touchMode:r.touchMode});d.ignoreForRecord(t.getContent());var w=r.name?r.name.toLowerCase().replace("tweaker",""):"multi-rep";t.getContent().addClassName("wux-tweakers-multirep-"+w);a.addEventOnElement(r,t,"close",s);var u=k.call(this,r.getContent());if(u){u.addWindow(t)}else{if(document.body){t.inject(document.body);t.getContent().setStyle("z-index",1000)}}var o=i.call(this,r.getContent());var q=o&&o.modalFlag;if(q){r.dialogOptions.modalFlag=true}t.modalFlag=r.dialogOptions.modalFlag;t.position={at:"center center",my:"center center"};return t},enableLiveChangeOnTreeListView:function(o){o.getManager()._getParent().elements.formContainer.addEvent("liveChange",o.getManager()._onCellChange.bind(o.getManager()))},onLoad:function(){},_setModelViewForDataColumnOneColumnCase:function(v,D){function s(){var E="",F=D.nodeModel.options.grid;if(v.valueType!==""&&v.valueType!==undefined){E=v.valueType+"."+(F.path?F.path:F.name);if(F.type!==undefined&&F.type!==""){E+="#"+F.type}else{if(F.defaultType!==undefined&&F.defaultType!==""){E+="#"+F.defaultType}}}else{if(F.data&&typeof(F.data)==="string"&&F.data.indexOf("[")===0){E="array"}else{E=F.type||F.typeRep}}return E}var A=D.cellView.getContent();var q=D.nodeModel.options;var t=q.grid;var w=(typeof t.data!=="undefined")?t.data:((t.defaultValue!==undefined)?t.defaultValue:undefined);var z=s();var C=undefined;if(t.readOnly!==undefined||(v.readOnly&&v.permanentReadOnly)){C=t.readOnly||(v.readOnly&&v.permanentReadOnly)}var x={typePath:z,readOnly:C,disabled:q.disabled,touchMode:t.touchMode,required:t.required,icon:(t.semantics&&t.semantics.icon)?t.semantics.icon:undefined,context:"inlinedTemplate",onViewCreated:function(E){if(E!==undefined){A.setContent(E);if(A){if(!E.readOnly){A.setAttribute("draggable",false)}}}},onFailure:function(E){t._buildFailure=true;if(typeof v.onFailure==="function"){v.onFailure(E)}}};if(v.displayMode==="oneColumn"){var r,u,y,p,B;B=f.createElement("div");(y=f.createElement("div",{"class":"label"})).inject(B);(r=f.createElement("div",{"class":"label",styles:{width:"50%",display:"inline-block","text-align":"left"}})).inject(y);(u=f.createElement("div",{"class":"label",styles:{width:"50%",display:"inline-block","text-align":"right"}})).inject(y);(p=f.createElement("div",{"class":"tweaker"})).inject(B);A.setContent(B);var o=D.nodeModel.options.grid;r.innerHTML=o.name;u.innerHTML="";if(v.typeDisplayFlag&&!v.authoringFlag){u.innerHTML=v._getTweakerTypeFromCellInfos(D)}A=p}return{generateViewOptions:x,data:w}}};function k(o){var p=o.getParent(".wux-windows-immersive-frame");if(p){return p.dsModel}return null}function i(o){var p=o.getParent(".wux-windows-window");if(p){return p.dsModel}return null}return m});define("DS/Tweakers/ModelProxy",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],function(a,g){var d={selectFilter:function(h){if(h.pattern===undefined||h.pattern===""||h.criteria===undefined){return this}return this.filter(function(i){return(i[this.criteria]!==undefined&&i[this.criteria].indexOf(this.pattern)>-1)},h)},fillFilter:function(h){return this.map(function(j,i,m){var l=j;for(var k in this){if(l[k]===undefined){l[k]=this[k]}}return l},h)},hierarchyFilter:function(h){var i=f.call(this,h.criteria);if(h.child!==undefined&&i!==undefined){c.call(i,h.child)}return i},modelToTreeDocument:function(j,o,n){function i(p,r,q){p.forEach(function(u,t,s){var v=new g({label:u[r],grid:u});if(!q){q.addRoot(v)}else{q.addChild(v)}if(u.properties){i(u.properties,r,v)}})}var h=this;switch(o){case"flat":i(j,n,h);break;case"hierarchical":for(var l in j){var k=this;if(l!=="undefined"){k=new g({label:l})}var m=j[l];if(Array.isArray(m)){i(m,n,k)}else{e.call(k,m,n)}if(k!==this){this.addChild(k)}}break}},modelToBreadCrumbModel:function(h,i){b.call(this,h,i)}};function f(i){var h={};this.forEach(function(k){var j=k[i];(h[j])?h[j].push(k):h[j]=[k]});return h}function c(h){if(h.criteria!==undefined){for(var i in this){this[i]=f.call(this[i],h.criteria);if(h.child!==undefined&&this[i]!==undefined){c.call(this[i],h.child)}}}}function e(h,l){for(var j in h){var k=h[j];var i=this;if(Array.isArray(k)){k.forEach(function(n,m,o){i.addChild(new g({label:n[l],grid:n}))})}else{if(j!=="none"){i=new g({label:j});this.addChild(i)}e.call(i,k,l)}}}function b(h,n){var m=this;for(var l in h){var i=h[l];if(l==="none"){i.forEach(function(q,p,o){m.push({label:q[n]})})}else{var j=[];var k={label:l};(Array.isArray(i))?i.forEach(function(q,p,o){j.push({label:q[n]})}):b.call(j,i,n);k.children=j;m.push(k)}}}return d});define("DS/Tweakers/TweakerBase",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(c,g,e,a,b){function i(k){this._currentValueIcon=this.icon;this._currentValueLabel=null;if((this._properties.value.value===undefined)||((this._properties.value.value==="")&&this.allowResetToUndefinedByUIFlag)){return 1}var q=this.possibleValues;if(q){if(q.length>0){var m=undefined;for(var j=0;j<q.length;j++){var n=q[j];if(typeof(n)==="object"){if(n.value!==undefined&&n.value!==null){if(typeof this._properties.value!=="undefined"&&typeof this._properties.value.value!=="undefined"){var p=(c.typeOf(this._properties.value.value)==="object")?this._properties.value.value.value:this._properties.value.value;if(this.compare(this._upgradeValue(n.value),p)===0){m=n;break}}}else{if(n.label!==undefined&&n.label!==null){if(typeof this._properties.value!=="undefined"&&typeof this._properties.value.value!=="undefined"){var p=(c.typeOf(this._properties.value.value)==="object")?this._properties.value.value.label:this._properties.value.value;if(this.compare(this._upgradeValue(n.label),p)===0){m=n;break}}}}}else{if(this.compare(this._upgradeValue(n),this._properties.value.value)===0){m=n;break}}}if(m===undefined){if(typeof(q[0])==="object"){if(q[0].value){this.value=q[0].value}else{if(q[0].label){this.value=q[0].label}else{this.value=q[0]}}}else{this.value=q[0]}return 0}if(typeof(m)==="object"){if(m.icon){this._currentValueIcon=m.icon}if(m.label){this._currentValueLabel=m.label}else{if(m.labelItem){this._currentValueLabel=m.labelItem}}}}else{if(typeof(q)==="object"){var o=this.valueType;for(var l in q){if(o==="enumValueToProperty"){if(this.compare(l,this._properties.value.value)===0){this._currentValueLabel=q[l];break}}else{if(this.compare(q[l],this._properties.value.value)===0){this._currentValueLabel=l;break}}}}}}return 1}var h=e.inherit({name:"tweakerBase",markForRecordFlag:true,publishedProperties:{value:{defaultValue:undefined,type:"object",advancedSetter:true,recordFlag:true},icon:{defaultValue:undefined,type:"object"},highlightModel:{defaultValue:undefined,type:"object"},minValue:{defaultValue:undefined,type:"object"},maxValue:{defaultValue:undefined,type:"object"},possibleValues:{defaultValue:undefined,type:"array"},valueType:{defaultValue:"",type:"string"},referenceValue:{defaultValue:undefined,type:"object"},showReferenceValueFlag:{defaultValue:false,type:"boolean"},readOnly:{defaultValue:false,type:"boolean"},displayStyle:{defaultValue:undefined,type:"string"},escapeHTML:{defaultValue:false,type:"boolean"},augmentedDisplay:{defaultValue:"popup",type:"string"},editorTitle:{defaultValue:"",type:"string"},dialogOptions:{defaultValue:{width:200,height:240,modalFlag:false,title:undefined,icon:undefined,identifier:undefined},type:"object"},allowUnsafeHTMLContent:{defaultValue:false,type:"boolean"},handleEditionCancel:{defaultValue:true,type:"boolean"},usageDescription:{defaultValue:"",type:"string"},allowResetToUndefinedByUIFlag:{defaultValue:false,type:"boolean"},context:{defaultValue:undefined,type:"object"},alignment:{defaultValue:undefined,type:"string"},numeric:{defaultValue:false,type:"boolean"},},blackBoxFlag:true,_preBuildView:function(){if(!this.elements.container){this.elements.container=new c.Element("div",{"class":"wux-tweakers"})}else{this.elements.container.addClassName("wux-tweakers")}this.elements.container.dsModel=this;this._eventsDisabledCounter=0;this._currentValueLabel=null;this._currentValueIcon=null;this.disableEvents()},_postBuildView:function(){if(this.referenceValue===undefined){this.referenceValue=c.clone(this.value,false)}this._applyDisabled();this.enableEvents()},compare:function(k,j){if(k===j){return 0}else{if(k>j){return 1}else{if(k<j){return -1}else{if((k===undefined)&&(j!==undefined)){return 2}else{return -2}}}}},getStringFromValue:function(j){if((j===null)||(typeof j==="undefined")){return""}return j.toString()},computeContentSize:function(){var j;if(this.elements._viewModule&&this.elements._viewModule.computeTweakerContentLength){j=this.elements._viewModule.computeTweakerContentLength()}else{var k=this.readOnly?this.getContent().innerText:this.value;j=a.computeStringWidth(k,this.getFontSize(),this.getFontFamily(),this.getEditedState())}var l=this.getTweakerPadding();j+=(2*l);if(this.getEditedState()){j+=l}return Math.ceil(j)},getFontSize:function(){var j=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(j)},getFontFamily:function(){return"arial"},getTweakerPadding:function(){return this._getCurrentTouchMode()?14:7},_applyValue:function(j,m){this._properties.value.value=this._upgradeValue(this._properties.value.value);if(this.possibleValues){if(i.call(this,j)===0){return}}else{var k=this.minValue;if(k&&this.compare(this.value,k)===-1){this.value=k;return}var l=this.maxValue;if(l&&this.compare(this.value,l)===1){this.value=l;return}}this._updateEditedState();if(this.elements._viewModule){this.elements._viewModule.setValue(this._properties.value.value);if(this._preEditState===2){this._liveChangeOccurred=true;if(this.getEventsAllowedState()){this.fire("liveChange")}}else{this.onChange()}}else{if(this.elements.internalView!==undefined){if(this.readOnly){this._properties.value.value=(this.value&&this.escapeHTML)?c.String.escapeHTML(this.value):this.value}this.elements.internalView.value=this.value}}},_applyDisabled:function(j){this._parent();if(this.elements._viewModule&&this.elements._viewModule._view){this.elements._viewModule._view.disabled=this.disabled}},_applyIcon:function(j){if(!this.possibleValues){this._currentValueIcon=this.icon}if(this.elements._viewModule&&this.elements._viewModule.setIcon){this.elements._viewModule.setIcon(this.icon)}},_applyMinValue:function(j){this._properties.minValue.value=this._upgradeValue(this._properties.minValue.value);if(this.maxValue&&this.compare(this.maxValue,this.minValue)===-1){this.maxValue=this.minValue}if(this.minValue&&this.compare(this.value,this.minValue)===-1){this.value=this.minValue}if(this.elements._viewModule){this.elements._viewModule.setMinValue(this.minValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.minValue=this.minValue}}},_applyMaxValue:function(j){this._properties.maxValue.value=this._upgradeValue(this._properties.maxValue.value);if(this.minValue&&this.compare(this.minValue,this.maxValue)===1){this.minValue=this.maxValue}if(this.maxValue&&this.compare(this.value,this.maxValue)===1){this.value=this.maxValue}if(this.elements._viewModule){this.elements._viewModule.setMaxValue(this.maxValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.maxValue=this.maxValue}}},_applyReferenceValue:function(j){this._properties.referenceValue.value=this._upgradeValue(this._properties.referenceValue.value);this._updateEditedState()},_applyShowReferenceValueFlag:function(j){this._updateEditedState()},_applyReadOnly:function(j){if(this.elements._viewModule&&j!==undefined){if(!this.isDirty("displayStyle")){this._applyDisplayStyle()}}else{if(this.elements.internalView!==undefined){this.elements.internalView.disabled=this.readOnly}}},_applyTouchMode:function(){this._parent();var j=this._getCurrentTouchMode();if(this.elements._viewModule){this.elements._viewModule.setTouchMode(j)}else{if(this.elements.internalView!==undefined){this.elements.internalView.touchMode=j}}},_applyAllowUnsafeHTMLContent:function(j){if(this.elements._viewModule&&this.elements._viewModule.setAllowUnsafeHTMLContent){this.elements._viewModule.setAllowUnsafeHTMLContent(this.allowUnsafeHTMLContent,j)}},_applyDisplayStyle:function(k){if(this.elements.container===undefined){return}if(this.elements._viewModule){this.onPostEdit();var l=this.elements._viewModule;this.elements._viewModule=undefined;l.destroy()}var j=this._resolveViewModuleToApply(this.displayStyle);if(!j||!j.id||!j.definition){return}this.elements._viewModule=new j.definition.classObject(this,j.definition.options);this.elements._viewModule.inject(this.elements.container);this.elements.internalView=(this.elements._viewModule._view?this.elements._viewModule._view:this.elements.container);if(this._isFocused()){if(this.elements.internalView._giveFocus){this.elements.internalView._giveFocus()}}this._properties.possibleValues.dirty=false;this._properties.value.dirty=false},_applyHighlightModel:function(j){if(this.elements._viewModule&&this.elements._viewModule.setHighlightModel){this.elements._viewModule.setHighlightModel(this.highlightModel)}},_applyUsageDescripton:function(j){if(this.elements._viewModule&&this.elements._viewModule.setUsageDescription){this.elements._viewModule.setUsageDescription(this.usageDescription)}},_applyAllowResetToUndefinedByUIFlag:function(j){if(this.elements._viewModule&&this.elements._viewModule.setAllowResetToUndefinedByUIFlag){this.elements._viewModule.setAllowResetToUndefinedByUIFlag(this.allowResetToUndefinedByUIFlag)}},_applyAlignment:function(j,k){if(!this.alignment&&this.numeric){this.alignment="far";return}if(this.alignment==="near"){this.elements.container.setAttribute("alignment","near")}else{if(this.alignment==="center"){this.elements.container.setAttribute("alignment","center")}else{if(this.alignment==="far"){this.elements.container.setAttribute("alignment","far")}else{this.elements.container.removeAttribute("alignment")}}}},_applyNumeric:function(j,k){if(!this.alignment&&this.numeric){this.alignment="far"}},getEditedState:function(){var m=false;if(this.showReferenceValueFlag&&(this.referenceValue!==undefined)){var k=this.value;var l=this.referenceValue;var n=this.isDirty("value")?this._upgradeValue(k):k;var j=this.isDirty("referenceValue")?this._upgradeValue(l):l;m=!c.equals(n,j)}return m},_updateEditedState:function(){if(this.getEditedState()){this.elements.container.classList.add("wux-tweakers-edited")}else{this.elements.container.classList.remove("wux-tweakers-edited")}if(this.elements._viewModule&&this.elements._viewModule.usesReferenceValueLabel()){this.elements._viewModule.updateReferenceValueLabel()}},destroy:function(){if(this.elements._viewModule){this.elements.internalView=undefined;delete this.elements.internalView}this._parent()},_applyEscapeHTML:function(){var j=this.elements.internalView;if(j!==undefined&&typeof j!=="undefined"){this.elements.internalView.escapeHTML=this.escapeHTML}},_applyPossibleValues:function(j){if(this.elements._viewModule){this.elements._viewModule.setPossibleValues(this.possibleValues)}if(!this.isDirty("value")){i.call(this,undefined)}},_applyProperties:function(j){this._parent(j);if(this.isDirty("highlightModel")){this._applyHighlightModel(j.highlightModel)}if(this.isDirty("allowUnsafeHTMLContent")){this._applyAllowUnsafeHTMLContent(j.allowUnsafeHTMLContent)}if(this.isDirty("readOnly")){this._applyReadOnly(j.readOnly)}if(this.isDirty("touchMode")){this._applyTouchMode(j.touchMode)}if(this.isDirty("escapeHTML")){this._applyEscapeHTML(j.escapeHTML)}if(this.isDirty("possibleValues")){this._applyPossibleValues(j.possibleValues)}if(this.isDirty("minValue")){this._applyMinValue(j.minValue)}if(this.isDirty("maxValue")){this._applyMaxValue(j.maxValue)}if(this.isDirty("value")){if(!this._preEditValue||this._preEditValue(j.value,this.value)){this._applyValue(j.value,this.value)}}if(this.isDirty("referenceValue")){this._applyReferenceValue(j.referenceValue)}if(this.isDirty("showReferenceValueFlag")){this._applyShowReferenceValueFlag(j.showReferenceValueFlag)}if(this.isDirty("icon")){this._applyIcon(this.icon)}if(this.isDirty("allowResetToUndefinedByUIFlag")){this._applyAllowResetToUndefinedByUIFlag(j.allowResetToUndefinedByUIFlag)}if(this.isDirty("usageDescription")){this._applyUsageDescripton(j.usageDescription)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(j.displayStyle)}if(this.isDirty("disabled")){this._applyDisabled(j.disabled)}if(this.isDirty("alignment")){this._applyAlignment(j.alignment)}if(this.isDirty("numeric")){this._applyNumeric(j.numeric)}},handleEvents:function(){},_upgradeValue:function(j){return j},resetToReferenceValue:function(){this.value=this.referenceValue},setValueAsReference:function(){this.referenceValue=c.clone(this.value,false)},_giveFocus:function(){this._parent();if(this.getContent()===document.activeElement||!a.isActiveElementInContainer(this.getContent())){if(this.elements.internalView&&this.elements.internalView._giveFocus){this.elements.internalView._giveFocus()}}},_resolveViewModuleToApply:function(l){var k={id:"",definition:undefined};var m=this;function j(s){var q=Object.getPrototypeOf(m);while(q&&!k.definition){var o=q.VIEW_MODULES;if(o){var p="";switch(s){case"id":p=l;break;case"id_readOnly":p=l+"_readOnly";break;case"readOnly":p="readOnly";break;default:break}var r=o[p];if(r&&r.classObject){k.id=p;k.definition=r}}q=Object.getPrototypeOf(q)}}var n=this.readOnly;if(n){j("id_readOnly");j("readOnly")}else{j("id")}return k},applyPropertiesOnView:function(j){if(this.elements._viewModule){var m=this.elements._viewModule.getModifiableOptions();this.elements._viewModule.prepareUpdate();for(var k in j){if(m.indexOf(k)!==-1){var l="set"+k.substring(0,1).toUpperCase()+k.substring(1,k.length);this.elements._viewModule[l](j[k])}}this.elements._viewModule.pushUpdate()}},disableEvents:function(){this._eventsDisabledCounter++},enableEvents:function(){this._eventsDisabledCounter--},getEventsAllowedState:function(){return(this._eventsDisabledCounter===0)},onChange:function(j){if(this._preEditState===2){this._cancelableValue=c.clone(this.value,false)}if(this.getEventsAllowedState()){this.fire("change",j)}this._liveChangeOccurred=false},onPreEdit:function(){if(this._preEditState){return}this._cancelableValue=c.clone(this.value,false);this._preEditState=1;this._liveChangeOccurred=false},onPostEdit:function(j){if(!this._preEditState){return}if(this._popupOpenedState){return}this._cancelableValue=undefined;if(this._liveChangeOccurred){this.onChange()}if(this._preEditState===2){if(this.getEventsAllowedState()){this.fire("postEdit",j)}}this._liveChangeOccurred=false;this._preEditState=0},onCancelEdit:function(j){if(!this._preEditState){return}if(this._cancelableValue===this.value){this.onPostEdit()}else{if(this.handleEditionCancel){this.setPropertyFromUIInteraction("value",this._cancelableValue)}this._preEditState=0;this._cancelableValue=undefined;if(this.getEventsAllowedState()){this.fire("cancelEdit",j)}}},onShow:function(j){this._popupOpenedState=true;this.onPreEdit();if(this.getEventsAllowedState()){this.fire("show",j)}},onHide:function(j){this._popupOpenedState=false;if(j&&j.cancelFlag){this.onCancelEdit()}else{this.onPostEdit()}if(this.getEventsAllowedState()){this.fire("hide",j)}}});var d=function(k,j){this._tweaker=k;this._options=Object.assign({},j);this._cptUpdate=0;this._view=undefined;this.buildView();this.handleEvents()};d.prototype.buildView=function(){};d.prototype.handleEvents=function(){};d.prototype.inject=function(j){if(this._view){if(Array.isArray(this._view)){for(var k=this._view.length-1;k>=0;k--){this._view[k].inject(j,"top")}}else{this._view.inject(j,"top")}}};d.prototype.destroy=function(){if(this._referenceValueLabel){this._referenceValueLabel.destroy();this._referenceValueLabel=undefined}if(this._view){if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].remove();this._view[j].destroy()}}else{this._view.remove();this._view.destroy()}}delete this._view};d.prototype.getModifiableOptions=function(){return[]};d.prototype.setTouchMode=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].touchMode=k}}else{this._view.touchMode=k}};d.prototype.setValue=function(j){};d.prototype.setTweakerValue=function(j){var k=this._tweaker;if(k){if(k._preEditState){if(k._preEditState===1&&k.getEventsAllowedState()){k.fire("preEdit");k._preEditState=2}}k.setPropertyFromUIInteraction("value",j)}};d.prototype.setPossibleValues=function(j){};d.prototype.setAllowUnsafeHTMLContent=function(j){};d.prototype.setUsageDescription=function(j){};d.prototype.setAllowResetToUndefinedByUIFlag=function(j){};d.prototype.setMinValue=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].minValue=k}}else{this._view.minValue=k}};d.prototype.setMaxValue=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].maxValue=k}}else{this._view.maxValue=k}};d.prototype.usesReferenceValueLabel=function(){return false};d.prototype.updateReferenceValueLabel=function(){var j=this._tweaker;if(!j){return}if(j.getEditedState()){if(!this._referenceValueLabel){this._referenceValueLabel=c.createElement("div",{"class":"wux-tweakers-reference-value"})}this._referenceValueLabel.textContent=j.getStringFromValue(j.referenceValue);if(!this._referenceValueLabel.parentNode){this._referenceValueLabel.inject(this._tweaker.elements.container)}}else{if(this._referenceValueLabel){this._referenceValueLabel.destroy();this._referenceValueLabel=undefined}}};d.prototype.prepareUpdate=function(j){this._cptUpdate++};d.prototype.pushUpdate=function(j){this._cptUpdate--;if(this._cptUpdate===0){this._updateView()}};d.prototype._updateView=function(){};d.prototype.computeTweakerContentLength=function(){if(this._tweaker.readOnly||!this._view){var m=this._tweaker.readOnly?this._tweaker.getContent().innerText:this._tweaker.value;return a.computeStringWidth(m,this._tweaker.getFontSize(),this._tweaker.getFontFamily(),this._tweaker.getEditedState())}else{var l=0;if(Array.isArray(this._view)){for(var k=this._view.length-1;k>=0;k--){var j=parseInt(this._view[k].getContent().offsetWidth);if(!j){j=parseInt(window.getComputedStyle(this._view[k].getContent()).minWidth)}l+=j}}else{l=parseInt(this._view.getContent().offsetWidth);if(!l){l=parseInt(window.getComputedStyle(this._view.getContent()).minWidth)}}return l}};var f=function(k,j){this._currentMode=0;d.call(this,k,j)};g.applyMixin(f,d);f.prototype.buildView=function(){this._previousFormatHTMLValueProperties={};this.formatHTMLValue(this._tweaker.value)};f.prototype._cleanContainerProperties=function(){var j=this._tweaker;if(j.elements.container){j.elements.container.textContent="";j.elements.container.removeClassName("wux-tweakers-string-label");j.elements.container.removeClassName("wux-tweakers-icon");j.elements.container.removeAttribute("wrap");a.cleanIcon(j.elements.container)}};f.prototype.destroy=function(){this._cleanContainerProperties();d.prototype.destroy.call(this)};f.prototype.setSuffix=function(j){if(!this._tweaker||!this._tweaker.elements.container){return}this.formatHTMLValue(this._tweaker.value)};f.prototype.setAllowUnsafeHTMLContent=function(l,j){if(!(this._currentMode&1)||j===l){return}var k=undefined;if(this._currentMode===1){k=this._tweaker.elements.container}else{k=this._label}if(g.getUnsafeHTMLContentValueToApply(l===true)){k.innerHTML=k.textContent}else{k.textContent=k.innerHTML}};f.prototype.setHighlightModel=function(j){if(typeof this._tweaker.value!=="undefined"&&this._tweaker.value!==null){this.formatHTMLValue(this._tweaker.value)}};f.prototype.removeHighlightModel=function(){this.setHighlightModel(undefined)};f.prototype._shouldFormatHTMLValue=function(j){if(Object.keys(this._previousFormatHTMLValueProperties).length===0){return true}var k=this._tweaker;if(this._previousFormatHTMLValueProperties.suffix!==k._suffix){return true}if(this._previousFormatHTMLValueProperties.valueIcon!==k._currentValueIcon){return true}if(this._previousFormatHTMLValueProperties.valueLabel!==k._currentValueLabel){return true}if(this._previousFormatHTMLValueProperties.stringValue!==k.getStringFromValue(j)){return true}if(JSON.stringify(this._previousFormatHTMLValueProperties.highlightModel)!==JSON.stringify(k.highlightModel)){return true}return false};f.prototype.formatHTMLValue=function(l){var t=this._tweaker;if(!t){return}if(!this._shouldFormatHTMLValue(l)){return}this._previousFormatHTMLValueProperties={highlightModel:t.highlightModel,suffix:t._suffix,valueIcon:t._currentValueIcon,valueLabel:t._currentValueLabel,stringValue:t.getStringFromValue(l)};var j=t.highlightModel;var v="wux-tweakers-tweakerbase-selectedHighlight";var u=0;if(l!==undefined&&l!==""){u++}if(t._currentValueIcon){u+=2}if(this._currentMode===1&&u!==1||this._currentMode===2&&u!==2){this._cleanContainerProperties()}if(this._label&&u!==3&&!this._options.hyperlink){this._label.destroy();this._label=undefined}if(this._icon&&u!==3){this._icon.destroy();this._icon=undefined}var o=null;if(u&1){o=this._label;if(!o){if(this._options.hyperlink){this._label=c.createElement("a");o=this._label}else{if(u===3){this._label=c.createElement("span");o=this._label}else{o=t.elements.container}}}o.classList.add("wux-tweakers-string-label");if(this._options.wrap){o.setAttributeNode(document.createAttribute("wrap"))}var x=(t._currentValueLabel===null?t.getStringFromValue(l):t._currentValueLabel);if(t._suffix){x+=" "+t._suffix}if(g.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)){if(j){for(var s=j.indexes.length-1;s>=0;s--){var r=j.indexes[s];var k=(s===j.selectedIndex)?true:false;var y=k?"<mark class='"+v+"'>":"<mark>";x=g.spliceString(x,r+j.label.length,0,"</mark>");x=g.spliceString(x,r,0,y)}}o.innerHTML=x}else{if(j){var m=x.length;x=x.toString();o.setContent();for(var s=j.indexes.length-1;s>=0;s--){var r=j.indexes[s];var k=(s===j.selectedIndex)?true:false;if(r+j.label.length<m){var n=new c.Element("span");n.textContent=x.slice(r+j.label.length,m);n.inject(o,"top");m=r+j.label.length}var w=r+j.label.length;if(r+j.label.length>m){w=m}var q=new c.Element("mark");if(k){q.addClassName(v)}q.textContent=x.slice(r,w);q.inject(o,"top");m=r}if(m!==0){var n=new c.Element("span");n.textContent=x.slice(0,m);n.inject(o,"top")}}else{if(o.getChildren().length!==0){while(o.firstChild){o.removeChild(o.firstChild)}}o.textContent=x}}if(this._options.hyperlink){o.href=l}else{if(j===undefined&&g.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)===false){o.innerHTML=a.hyperlinkifyText(o.innerHTML)}}}var p=null;if(u&2){p=this._icon;if(!p&&u===3){this._icon=c.createElement("span");p=this._icon}else{if(u===2){p=t.elements.container}}p.classList.add("wux-tweakers-icon");a.generateIcon(t._currentValueIcon,{target:p})}switch(u){case 1:if(this._options.hyperlink){this._label.inject(t.elements.container)}break;case 3:if(this._currentMode!==3){this._icon.inject(t.elements.container);this._label.inject(t.elements.container)}break;default:break}this._currentMode=u;this.updateReferenceValueLabel()};f.prototype.setValue=function(j){var k=this._tweaker;if(!k){return}this.formatHTMLValue(j)};f.prototype.setIcon=function(j){this.formatHTMLValue(this._tweaker.value)};f.prototype.usesReferenceValueLabel=function(){return true};h.prototype.baseViewModule=d;h.prototype.VIEW_MODULES={readOnly:{classObject:f}};h.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(h.prototype.VIEW_MODULES[j]!==undefined){return}h.prototype.VIEW_MODULES[j]=k};b.register(h,"DS/ControlsRec/AbstractRec");return h});define("DS/Tweakers/TweakerFunction",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Button","DS/Menu/ContextualMenu","DS/Menu/Menu","DS/Utilities/Utils","UWA/Class/Promise"],function(e,k,g,f,h,i,j){var c=k.inherit({name:"tweakerFunction",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:"",type:"string"},emphasize:{defaultValue:"secondary",type:"string"},defaultModule:{defaultValue:undefined,type:"string"},defaultFunction:{defaultValue:undefined,type:"string"},displayStyle:{defaultValue:"button",type:"string",category:"Appearance"}},_applyEmphasize:function(){if(this.elements._viewModule&&this.elements._viewModule.setEmphasize){this.elements._viewModule.setEmphasize(this.emphasize)}},_applyIcon:function(){if(this.elements._viewModule&&this.elements._viewModule.setIcon){this.elements._viewModule.setIcon(this.icon)}},_applyLabel:function(){if(this.elements._viewModule&&this.elements._viewModule.setLabel){this.elements._viewModule.setLabel(this.label)}},_applyDisabled:function(l){if(this.elements._viewModule){this.elements._viewModule.setDisabled(this.disabled)}},_applyDefaultModule:function(){if(this.elements._viewModule&&this.elements._viewModule.setDefaultModule){this.elements._viewModule.setDefaultModule(this.defaultModule)}},_applyDefaultFunction:function(){if(this.elements._viewModule&&this.elements._viewModule.setDefaultFunction){this.elements._viewModule.setDefaultFunction(this.defaultFunction)}},_applyProperties:function(l){this._parent(l);if(this.isDirty("emphasize")){this._applyEmphasize(l.emphasize)}if(this.isDirty("label")){this._applyLabel(l.label)}if(this.isDirty("icon")){this._applyIcon(l.icon)}if(this.isDirty("value")){this._applyValue(l.value)}if(this.isDirty("defaultModule")){this._applyDefaultModule(l.defaultModule)}if(this.isDirty("defaultFunction")){this._applyDefaultFunction(l.defaultFunction)}}});var a=function(m,l){k.prototype.baseViewModule.call(this,m,l)};i.applyMixin(a,k.prototype.baseViewModule);a.prototype.buildView=function(m){var l=this._options.viewOptions||{};l.touchMode=this._tweaker._getCurrentTouchMode();l.label=this._tweaker.label;l.icon=this._tweaker.icon;l.emphasize=this._tweaker.emphasize;l.disabled=this._tweaker.disabled;this._view=new g(l);this._view.getContent().addClassName("wux-tweaker-function")};a.prototype.setIcon=function(l){if(!this._view){return}this._view.icon=l};a.prototype.setLabel=function(l){if(!this._view){return}this._view.label=l};a.prototype.computeTweakerContentLength=function(){if(this._view){return parseInt(window.getComputedStyle(this._view.getContent()).width)}return this._parent()};a.prototype.setDisabled=function(l){if(!this._view){return}this._view.disabled=l};a.prototype.setEmphasize=function(l){if(!this._view){return}this._view.emphasize=l};a.prototype.setValue=function(m){var n=this._tweaker;var l=this._view;if(!l||!n){return}};a.prototype.setDefaultFunction=function(l){if(!this._view){return}if(!this._view.value){this._view.value={};if(!this._view.value.action){this._view.value.action={}}}this._view.value.action.func=l};a.prototype.setDefaultModule=function(l){if(!this._view){return}if(!this._view.value){this._view.value={};if(!this._view.value.action){this._view.value.action={}}}this._view.value.action.module=l};var d=function(m,l){a.call(this,m,l)};i.applyMixin(d,a);d.prototype.buildView=function(){a.prototype.buildView.call(this);if((this._options.hasIcon)||(this._options.hasLargeIcon)){this._view.displayStyle="icon"}if(this._options.hasLargeIcon){this._tweaker.getContent().setAttributeNode(document.createAttribute("large-icon"))}};d.prototype.handleEvents=function(){var m=this,l=this._view;l.addEventListener("buttonclick",function(r){var o=function(s,u,t){require([s],function(w){if(w){var x=w[u];if(x&&typeof x==="function"){var v=t;if(!v){v={}}v.context=m._tweaker.context;x(v)}}})};if(m._tweaker.value&&typeof m._tweaker.value==="function"){m._tweaker.value({context:m._tweaker.context})}else{if(m._tweaker.value&&(m._tweaker.value.module||m._tweaker.defaultModule)){var n=(m._tweaker.value&&m._tweaker.value.module)?m._tweaker.value.module:m._tweaker.defaultModule;var q=(m._tweaker.value&&m._tweaker.value.func)?m._tweaker.value.func:m._tweaker.defaultFunction;var p=m._tweaker.value.argument;if(!p){p={}}p.context=m._tweaker.context;o(n,q,p)}}})};var b=function(m,l){a.call(this,m,l)};i.applyMixin(b,a);b.prototype.buildView=function(){a.prototype.buildView.call(this);this._view.arrowSpan=document.createElement("span");this._view.arrowSpan.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down";if((this._options.hasIcon)||(this._options.hasLargeIcon)){this._view.displayStyle="icon";this._view.arrowSpan.classList.add("arrow-icon");this._view.getContent().addClassName("arrow-icon")}else{this._view.arrowSpan.classList.add("arrow");this._view.getContent().style.paddingRight="0px"}if(this._options.hasLargeIcon){this._tweaker.getContent().setAttributeNode(document.createAttribute("large-icon"))}this.setLabel(this._tweaker.label)};b.prototype.setLabel=function(l){if(!this._view){return}this._view.label=l;this._view.getContent().appendChild(this._view.arrowSpan)};b.prototype.handleEvents=function(){var m=this,l=this._view;l.addEventListener("buttonclick",function(s){var p=function(){};var u=[];var v=function(y,A,z){var B=new j(function(D,C){require([y],function(F){if(F){var G=F[A];if(G&&typeof G==="function"){var E=z;if(!E){E={}}E.context=m._tweaker.context;G(E);D()}else{C()}}else{C()}},C)});u.push(B)};var w=function(z,C,B,A,y){var D=new j(function(F,E){require([z],function(H){if(H){var I=H[C];if(I&&typeof I==="function"){var G=B;if(!G){G={}}G.context=m._tweaker.context;A.action={callback:I.bind(null,G),argument:B,func:C,module:z};F()}else{E()}}else{E()}},E)});u.push(D)};var t=function(B,A){if(B&&B.submenu&&Array.isArray(B.submenu)&&B.submenu.length>0){var z=m._tweaker.defaultModule;var y=m._tweaker.defaultFunction;B.submenu.forEach(function(C){if(C.action&&(C.action.module||z)){var G=C.action.module?C.action.module:z;var E=C.action.func?C.action.func:y;var D=C.action.argument;var F=C.action;C.action={callback:p};w(G,E,D,C,F);if(C&&C.submenu&&Array.isArray(C.submenu)&&C.submenu.length>0){if(C.action){if(!C.action.func){C.func=m._tweaker.defaultFunction}if(!C.action.module){C.module=m._tweaker.defaultModule}}t(C,F)}}else{if(C&&C.submenu&&Array.isArray(C.submenu)&&C.submenu.length>0){t(C,F)}}})}};if(m._tweaker.value.action&&(m._tweaker.value.action.module||m._tweaker.defaultModule)){var x=(m._tweaker.value&&m._tweaker.value.module)?m._tweaker.value.module:m._tweaker.defaultModule;var r=(m._tweaker.value&&m._tweaker.value.func)?m._tweaker.value.func:m._tweaker.defaultFunction;var o=m._tweaker.value.argument;v(x,r,o)}var q=[];var n=m._view.getContent().getBoundingClientRect();if(m._tweaker.value.menu&&m._tweaker.value.menu.length>0){m._tweaker.value.menu.forEach(function(z){var C={callback:p};if(z.action&&(z.action.module||m._tweaker.defaultModule)){C=z.action;var y=(C&&z.action.module)?z.action.module:m._tweaker.defaultModule;var B=(C&&z.action.func)?z.action.func:m._tweaker.defaultFunction;var A=z.action.argument;z.action={callback:p};w(y,B,A,z,C)}t(z,C);j.all(u).then(function(){q.push(z)})["catch"](function(D){throw new Error("Issue with menu format")})});j.all(u).then(function(){h.show(q,{position:{x:n.left,y:n.top+n.height}});m._tweaker.fire("show")})["catch"](function(){throw new Error("Issue with menu format")})}})};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={button_readOnly:{classObject:d},button:{classObject:d},buttonIcon_readOnly:{classObject:d,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},buttonIcon:{classObject:d,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},menu_readOnly:{classObject:b},menu:{classObject:b},menuIcon_readOnly:{classObject:b,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},menuIcon:{classObject:b,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},buttonLargeIcon_readOnly:{classObject:d,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},buttonLargeIcon:{classObject:d,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},menuLargeIcon_readOnly:{classObject:b,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},menuLargeIcon:{classObject:b,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},};c.prototype.registerViewModule=function(l,m){return;if(!l||!m||!m.classObject&&!m.classPath){return}if(c.prototype.VIEW_MODULES[l]!==undefined){return}c.prototype.VIEW_MODULES[l]=m};return c});define("DS/Tweakers/TweakerTreeNodeModel",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Abstract","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","UWA/Utils/Client"],function(f,o,h,g,d,a,i,m){var c=false;var e={};var b=m.Engine;function l(v,t){var s=window.getComputedStyle(t,null).getPropertyValue("font-size");var u=parseFloat(s);var r=new f.Element("span",{html:v,styles:{opacity:1,fontSize:u,padding:5}}).inject(t);var q=r.getDimensions().width;r.remove();return q}function j(q){return q.charAt(0).toUpperCase()+q.slice(1)}function p(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var q=window.getSelection();q.removeAllRanges()}}}var n=h.inherit({name:"TweakerTreeNodeModel",publishedProperties:{value:{defaultValue:null,type:"object"},height:{defaultValue:38,type:"number"},readOnly:{defaultValue:true,type:"boolean"}},_postBuildView:function(){this.elements.container.addClassName("wux-layouts-treeview-cell");this.elements.layout=new f.Element("ul",{"class":"wux-ui-stack-h",styles:{width:"inherit",height:this.height,display:"inline-block"}}).inject(this.elements.container);this.elements.linksContainer=new f.Element("li",{"class":"wux-layouts-treeview-links"}).inject(this.elements.layout);this.elements.nodeContainer=new f.Element("li",{"class":"wux-layouts-treeview-node"}).inject(this.elements.layout);this.elements.expanderContainer=new f.Element("li",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.nodeContainer);this.elements.iconsContainer=new f.Element("li",{"class":"wux-layouts-treeview-icons"}).hide().inject(this.elements.nodeContainer);this.elements.badgeTopRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"}).inject(this.elements.iconsContainer);this.elements.badgeTopLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-left"}).inject(this.elements.iconsContainer);this.elements.badgeBottomRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right"}).inject(this.elements.iconsContainer);this.elements.badgeBottomLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-left"}).inject(this.elements.iconsContainer);this.elements.labelContainer=new f.Element("li",{"class":"wux-layouts-treeview-label"}).inject(this.elements.nodeContainer);this._observeEvents();this._parent()},_applyValue:function(q){if(this.value&&this.value.options){this.setLabel(this.value.options.label);this.setIcons(this.value.options.icons);this._setExpanderState(this.value._expandState);this._setDepth(this.value._nodeDepth)}},isInEditionMode:function(){return !this.disabled&&!this.readOnly},switchToReadView:function(){this.readOnly=true},notifyModelUpdate:function(){this.value.notifyModelUpdate()},_applyReadOnly:function(q){this._parent(q);this.setLabel(this.value.options.label)},setLabel:function(s){var w=this;function q(y){y.preventDefault();y.stopPropagation();y.stopImmediatePropagation();w.elements.container.scrollLeft=0;return false}function t(y){if(w.isInEditionMode()){p();if(y.target.value!==w.value.options.label){w.value.options.label=y.target.value;w.notifyModelUpdate();w._applyProperties()}w.switchToReadView();w.fire("change")}}if(this.isInEditionMode()){var v=w.getContent().getDimensions().width;var x;var r=new f.Element("input",{type:"text",value:s,tabindex:"-1","class":"wux-tree-label-input wux-ui-state-clearable",styles:{"box-sizing":"border-box"},events:{dragstart:function(y){y.preventDefault();y.stopPropagation()},keypress:function(y){w.elements.container.scrollLeft=0},keydown:function(A){w.elements.container.scrollLeft=0;var y=(l(this.value,w.elements.labelContainer)+20);var z=v-x;if(z<0){z=0}this.style.width=Math.min(y,(v-x-0))+"px";this.style.maxWidth=z+"px"},keyup:function(z){w.elements.container.scrollLeft=0;var y=f.Event.whichKey(event);if(y==="return"){t.call(this,event);w.switchToReadView()}},change:function(y){},focusin:function(y){y.preventDefault()},focus:function(y){y.preventDefault();y.stopPropagation()},blur:function(y){t(y)},click:function(y){y.stopPropagation();if(this.offsetWidth-18<y.clientX-this.getBoundingClientRect().left){this.value=w.value.options.label;w.switchToReadView();w._lastClickTime=Date.now()}},mouseup:function(y){y.stopPropagation()},mousedown:function(y){y.stopPropagation()}}});w.elements.container.addEventListener("scroll",q,true);x=w.elements.labelContainer.getPosition().x;w.elements.container.scrollLeft=0;setTimeout(function(){if(w._cellReadWriteView){w.elements.container.scrollLeft=0;var z=w.getContent().getDimensions().width;var y=(l(r.value,w.elements.labelContainer)+20);r.style.width=y+"px";var A=r.getPosition().x;r.style.maxWidth=(z-A-0)+"px";w._cellReadWriteView.setSelectionRange(0,w._cellReadWriteView.value.length)}},1);r.setAttribute("size",r.value.length);this.elements.labelContainer.textContent="";this.elements.labelContainer.setContent(r);this._cellReadWriteView=r;r.focus()}else{w.elements.container.removeEventListener("scroll",q);if(!c){this.elements.labelContainer.setContent(s)}else{if(!this._labelReadView){console.info("new label read");this._labelReadView=f.createElement("div",{html:s,styles:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}})}this.elements.labelContainer.setContent(this._labelReadView);var v=w.getContent().getDimensions().width;var u=(l(s,w.elements.labelContainer)+20);this._labelReadView.style.width=u+"px";var x=this._labelReadView.getPosition().x;this._labelReadView.style.maxWidth=(v-x-20)+"px";w.elements.container.scrollLeft=0}}},setIcons:function(s){var t=this;var r="";var q;if(s instanceof Array){if(s&&s.length>0){q=(this._icons&&this._icons.length===s.length)&&this._icons.every(function(v,u){return v===s[u]});if(!q){this._icons=f.clone(s);if(s){s.forEach(function(v,u){r=r+t.addIcon(v)})}}}else{var q;q=(this._icons&&this._icons.length===s.length)&&this._icons.every(function(v,u){return v===s[u]});if(!q){this._icons=f.clone(s)}}}if(typeof s==="string"){r=r+t.addIcon(s,"css")}if(!q){this.elements.iconsContainer.innerHTML=r}if(r!==""){this.elements.iconsContainer.show()}},select:function(){this._lastClickTime=Date.now();this._parent()},addIcon:function(s,q){var r;switch(q){default:r='<div class="wux-layouts-treeview-icon" style="display:inline-flex;background-image:url('+s+')"></div>';break;case"css":r='<div class="wux-layouts-treeview-icon" style="display:inline-flex;" wux-icon-name="'+s+'" ></div>';break}return r},_observeEvents:function(){var r=this;this.elements.expanderContainer.addEvent(g.POINTERUP,function q(s){s.stopPropagation();if(s.which===1){var t=r.value;if(t.options.children){if(r._expandState!=="noExpandState"&&r._expandState!=="expandingState"){if(t.isExpanded()&&t._expandState!=="partiallyExpandedState"){t.collapse()}else{r._setExpanderState("expandingState");t.expand()}}}}})},handleEvents:function(){},_setExpanderState:function(q){if(q){var r={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};this.elements.expanderContainer.setAttribute("data-wux-state",r[q])}},_setDepth:function(v){var y=this.value;if(v===undefined){v=y.getParents().length}var s=20;var x=25;this.elements.container.setStyle("padding-left",s);var r="";var w,t,z,q;for(w=0;w<v;w++){q=y.getNthParent((v-1)-w);t=((q&&q.isLastChild()&&(w<=v-2)))?"transparent":"";z=((w===v-1)&&y.isLastChild())?"50%":"100%";r=r+t+z}if(e[r]===undefined){var u="";for(w=0;w<v;w++){q=y.getNthParent((v-1)-w);t=((q&&q.isLastChild()&&(w<=v-2)))?"border-color:transparent":"";z=((w===v-1)&&y.isLastChild())?"50%":"100%";u=u+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((y.getParent()&&y.getParent().isLastChild()&&w<=v-1)?"true":"false")+'" data-islastchild="'+(y.isLastChild()?"true":"false")+'" data-depth="'+(w+"/"+(v-1))+'" style="'+t+";height: "+z+";margin-right:"+((w===v-1)?0:x)+"px;margin-left:"+(w===0?x:0)+'px"></li>'}this.elements.linksContainer.innerHTML=u;e[r]=u;this.elements.linksContainer.inject(this.elements.layout,"top")}else{this.elements.linksContainer.innerHTML=e[r]}this.getContent().setAttribute("data-node-depth",v)}});var k=o.inherit({name:"TweakerTreeNodeModel",publishedProperties:{value:{defaultValue:null,type:"object"}},_postBuildView:function(){if(this.elements.container!==undefined){this.elements.internalView=new n();var q=this;this.elements.internalView.elements.labelContainer.addEventListener(g.POINTERUP,function(){var t=0;if(q.elements.internalView._lastClickTime===undefined){q.elements.internalView._lastClickTime=Date.now();var r=q.value.getTreeDocument();var s=r.getXSO().onChange(function(){delete q.elements.internalView._lastClickTime;console.log("-");r.getXSO()._modelEvents.unsubscribe(s)})}else{t=Date.now()-q.elements.internalView._lastClickTime}console.log(t,q.value.isSelected());if(t>300){q.elements.internalView.readOnly=false;q.elements.internalView._lastClickTime=undefined}});this.elements.internalView.inject(this.elements.container)}this._parent()},_applyReadOnly:function(){},handleEvents:function(){}});return k});define("DS/Tweakers/TweakerImage",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase"],function(g,d,b,f){var c=f.inherit({name:"tweakerImage",publishedProperties:{displayStyle:{defaultValue:"simple",type:"string",category:"Appearance"}}});var a=function(i,h){f.prototype.baseViewModule.call(this,i,h)};d.applyMixin(a,f.prototype.baseViewModule);var e=function(i,h){a.call(this,i,h)};d.applyMixin(e,a);e.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-image");this._view=g.createElement("img",{"class":"wux-tweakers-image-img"});this.setValue(this._tweaker.value)};e.prototype.setValue=function(h){if(!this._view){return}b.generateIcon(h,{target:this._view})};e.prototype.handleEvents=function(){};e.prototype.destroy=function(){this._tweaker.elements.container.removeClassName("wux-tweakers-image");a.prototype.destroy.call(this)};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={simple:{classObject:e},simple_readOnly:{classObject:e}};c.prototype.registerViewModule=function(h,i){return;if(!h||!i||!i.classObject&&!i.classPath){return}if(c.prototype.VIEW_MODULES[h]!==undefined){return}c.prototype.VIEW_MODULES[h]=i};return c});define("DS/Tweakers/TweakerBoolean",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Toggle","DS/Utilities/Dom","DS/Utilities/Utils"],function(b,h,f,d,e){var i=h.inherit({name:"TweakerBoolean",publishedProperties:{value:{defaultValue:false,type:"boolean",advancedSetter:true},valueType:{defaultValue:"boolean",type:"string"},displayStyle:{defaultValue:"checkbox",type:"string"}},_upgradeValue:function(j){if(j===undefined){return j}else{if(j==="1"||j===1||j==="true"||j===true){return true}else{if(j==="0"||j===0||j==="false"||j===false){return false}else{return Boolean(j)}}}}});var a=function(k,j){h.prototype.baseViewModule.call(this,k,j)};e.applyMixin(a,h.prototype.baseViewModule);var c=function(k,j){a.call(this,k,j)};e.applyMixin(c,a);c.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.type=this._options.viewOptions.displayStyle;j.touchMode=this._tweaker._getCurrentTouchMode();j.fireOnlyFromUIInteractionFlag=true;this._view=new f(j);this.setValue(this._tweaker.value)};c.prototype.computeTweakerContentLength=function(){return this._tweaker._getCurrentTouchMode()?19:14};c.prototype.handleEvents=function(){var j=this._view;var l=this._tweaker;var k=this;j.addEventListener("change",function(m){m.stopPropagation();if(l.allowResetToUndefinedByUIFlag&&!j.checkFlag&&l.value){j.mixedState=true;k.setTweakerValue(undefined)}else{k.setTweakerValue(j.checkFlag)}})};c.prototype.setValue=function(k,j){if(!this._view){return}if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){this._view.mixedState=true;this._view.checkFlag=false}else{this._view.mixedState=false;this._view.checkFlag=this._tweaker.value}};c.prototype.setTouchMode=function(k,j){if(!this._view){return}this._view.touchMode=k};var g=function(k,j){a.call(this,k,j)};e.applyMixin(g,a);g.prototype.buildView=function(){if(!this._tweaker.elements.container){return}this._view=new b.Element("span");this.setTouchMode(this._tweaker._getCurrentTouchMode());this.setValue(this._tweaker.value)};g.prototype.setValue=function(k,j){if(!this._view){return}var l;if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){l="minus"}else{if(this._tweaker.value){l="check"}else{l="close"}}this._view.className="wux-tweakers-boolean-readonly";d.generateIcon({iconName:l,fontIconFamily:WUXManagedFontIcons.FontAwesome},{target:this._view})};g.prototype.setTouchMode=function(k,j){if(!this._view){return}if(this._tweaker.readOnly&&!(this._view instanceof f)){if(k){this._view.style.paddingLeft="14px"}else{this._view.style.paddingLeft="7px"}}else{this._view.touchMode=k}};g.prototype.computeTweakerContentLength=function(){return this._tweaker._getCurrentTouchMode()?19:14};i.prototype.baseViewModule=a;i.prototype.VIEW_MODULES={"switch":{classObject:c,options:{viewOptions:{displayStyle:"switch"}}},readOnly:{classObject:g,options:{viewOptions:{displayStyle:"switch"}}},checkbox:{classObject:c,options:{viewOptions:{displayStyle:"checkbox"}}},radio:{classObject:c,options:{viewOptions:{displayStyle:"radio"}}}};i.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(i.prototype.VIEW_MODULES[j]!==undefined){return}i.prototype.VIEW_MODULES[j]=k};return i});define("DS/Tweakers/TypeRepresentationFactory",["UWA/Core","UWA/Class","UWA/Class/Promise","DS/Tweakers/TweakerUtils","DS/Core/Core","DS/Utilities/ReusableContentsManager","text!DS/Tweakers/assets/defaultTypeRepresentations.json","text!DS/Tweakers/assets/typeTemplates.json"],function(d,b,g,i,e,a,j,f){var k=b.extend({init:function(l){this.options=d.extend({preLoadTemplates:true,onReady:function(){}},l||{});this._parent(l);this._bufferTemplateLoaded={};this._isReady=false;this._reusablesManager=new a();this._registerDefaults();this._registerDefaultEnums();this._preLoadDefaultUITemplates();i.addTypeRepFactory(this);Object.defineProperty(k.prototype,"onReady",{get:function(){return this.options.onReady},set:function(m){this.options.onReady=m;if(this._isReady){m.call(this)}},enumerable:true,configurable:true})},destroy:function(){this._reusablesManager.destroy();i.removeTypeRepFactory(this);this.typeReps=null;this.typeUITemplates=null;this.typeEnums=null;this._parent()},_callOnTemplateLoaded:function(n,l){if(n.src){l.call(this,n.src);return}var p=n.path;if(!p){return}if(this._bufferTemplateLoaded[p]){this._bufferTemplateLoaded[p].templates.push(n);this._bufferTemplateLoaded[p].callbacks.push(l)}else{this._bufferTemplateLoaded[p]={templates:[n],callbacks:[l]};var o=this;require([p],function m(r){for(var q=0;q<o._bufferTemplateLoaded[p].templates.length;q++){o._bufferTemplateLoaded[p].templates[q].src=r;o._bufferTemplateLoaded[p].callbacks[q].call(o,r)}delete o._bufferTemplateLoaded[p]})}},_registerDefaults:function(){d.merge(this.typeReps,JSON.parse(j));d.merge(this.typeUITemplates,JSON.parse(f))},_registerDefaultEnums:function(){var m=this;m.registerEnum("allSupportedTypes",function l(){var n=[];[m.typeReps,m.typeEnums].forEach(function(p){for(var o in p){n.push(o)}});return n.sort(function(p,o){return p.toLowerCase().localeCompare(o.toLowerCase())})});m.registerTypeRepresentations({allSupportedTypes:{stdTemplate:"enumSearchableCombo"}})},_preLoadDefaultUITemplates:function(){var n=this;if(this.options.preLoadTemplates){var l=0;for(var m in n.typeUITemplates){if(this.typeUITemplates[m].path!==""){l++}}for(var m in n.typeUITemplates){(function(p){var o=n.typeUITemplates[p];if(o.path!==""){n._callOnTemplateLoaded(o,function(q){l--;if(l===0){n._isReady=true;n.options.onReady.call(n)}})}})(m)}}else{this._isReady=true;this.options.onReady.call(this)}},typeReps:{defaultRep:{stdTemplate:"defaultrep"}},typeUITemplates:{},typeEnums:{},registerTypeRepresentations:function(l){if(l!==undefined){if(typeof l==="string"){d.merge(this.typeReps,JSON.parse(l))}else{if(typeof l==="object"){d.merge(this.typeReps,l)}else{throw new Error("Cannot register type representations")}}}},getRegisteredTypeRepresentation:function(l){if(l!==undefined){if(this.typeReps&&this.typeReps[l]){return this.typeReps[l]}return undefined}},IsRegisterTypeRepresentations:function(l){if(l!==undefined){if(this.typeReps&&this.typeReps[l]){return true}return false}},registerTypeTemplates:function(l){if(l!==undefined){if(typeof l==="string"){d.merge(this.typeUITemplates,JSON.parse(l))}else{if(typeof l==="object"){d.merge(this.typeUITemplates,l)}else{throw new Error("Cannot register type templates")}}}},getRegisteredTypeTemplate:function(l){if(l!==undefined){if(this.typeUITemplates&&this.typeUITemplates[l]){return this.typeUITemplates[l]}return undefined}},registerEnum:function(l,n){if((Array.isArray(n)||typeof n==="object"||typeof n==="function")&&typeof l==="string"&&l!==""){var m={};m[l]=n;if(this.typeEnums[l]){this.typeEnums[l]=n}else{d.merge(this.typeEnums,m)}}else{throw new Error('Cannot register the enum "'+l+'"')}},getRegisteredEnum:function(l){if(l!==undefined){if(this.typeEnums&&this.typeEnums[l]){return this.typeEnums[l]}return undefined}},generateTweaker:function(o,v){if(v===undefined){return}if(v.typeRep===undefined){return}var u=this.getTemplateIdentifierFromTypeRep(v.typeRep,v.context);if(u!==undefined){if(typeof u!=="string"){if(v.readOnly&&u.readOnly){u=u.readOnly}else{u=u["default"]}}var s=this.typeUITemplates[u];if(s!==undefined){var q=this;var r;if(v.semantics){r=d.merge(v.semantics,v.typeRep.semantics)}else{r=v.typeRep.semantics}var m=r||{};m.readOnly=v.readOnly!==undefined?v.readOnly:h.call(this,m.readOnly);m.touchMode=v.touchMode!==undefined?v.touchMode:m.touchMode;m.icon=v.icon!==undefined?v.icon:m.icon;m.escapeHTML=v.escapeHTML!==undefined?v.escapeHTML:h.call(this,m.escapeHTML);if(!m.hasOwnProperty("valueType")&&(v.valueType===undefined)&&(v.typePath!==undefined)){var n;var p;var l=v.typePath.indexOf("<");var t=v.typePath.indexOf(">");if(l!==-1&&t!==-1&&l<t){n=v.typePath.substring(l+1,t)}else{if(v.typePath==="array"||(v.typeRep&&v.context&&v.typeRep[v.context]==="array"&&(!v.semantics||v.semantics.valueType!=="auto"))){n="auto"}else{n=(v.typePath!=="")?v.typePath:d.typeOf(o);p=this._getTypeData(v.typePath).realType?this._getTypeData(v.typePath).realType:(v.typePath!=="")?v.typePath:d.typeOf(o)}}m.valueType=n;m.realType=p}this._callOnTemplateLoaded(s,function(w){if(!v.needToCreateViewAfterRequireEnded||(v.needToCreateViewAfterRequireEnded&&v.needToCreateViewAfterRequireEnded.call(q)===true)){q.__resolveTemplate__(u,s,w,o,m,v)}else{c.call(v,"No need to create view",o)}})}else{c.call(v,"Cannot retrieve a view template for the given typePath",o)}}else{c.call(v,"Cannot generate view with the typeRep found for the given typePath",o)}},_getTypeData:function(t,l,p){function r(C,B){var A=u.__resolveEnumRepresentation__(C);var D=u.typeReps[A];B=B||{};B.possibleValues=C;return{semantics:B,finalPath:A,typeRep:D}}var u=this,y,z="",v;t=t||d.typeOf(p);if(t===false||t===true){t=d.typeOf(t)}if(t!==null&&t!==undefined){var o=t.split("#");var s;if(o.length===2){t=o[0];s=o[1]}var x=t.split(".");var w="";x.every(function(F,A,G){z+=String(F);if(A!==G.length-1){z+="."}if(y!==undefined){if(y.children){y=y.children[F];if(typeof y==="string"&&y.indexOf("#")===0){var B=y.slice(1);v=B;y=u.typeReps[B];if(y===undefined||y===""){var D=u.typeEnums[B];if(D){var C=r(D,l);l=C.semantics;y=C.typeRep;w=C.finalPath}}}if(y!==undefined){var E=w+"."+F;w+="."+F}else{w=""}}else{y=undefined;w=""}}else{y=u.typeReps[F];w=F;var D=u.typeEnums[F];if((y!==undefined&&D)||(y===undefined&&D)){if(y===undefined){w=u.__resolveEnumRepresentation__(D);y=u.typeReps[w]}l=l||{};l.possibleValues=D}}return(y!==undefined||A!==G.length-1)});if(y===undefined||y===""){var q=u.typeEnums[s];if(q){var m=r(q,l);l=m.semantics;y=m.typeRep;w=m.finalPath}}if(y&&y.children){l=l||{};var n=l.configuration||{};Object.getOwnPropertyNames(y.children).forEach(function(C){var B,A;n[C]={};if(!(t+"."+C).contains(C)){B=u._getTypeData(t+"."+C,l,p);A=B.semantics&&B.semantics.configuration?B.semantics.configuration:{};Object.getOwnPropertyNames(A).forEach(function(D){if(!n[C+"."+D]){n[C+"."+D]={}}})}});l.configuration=n}if(t===z&&y===undefined&&t.indexOf(".")!==-1){if(s!==undefined){y=u.typeReps[s]}if(y===undefined){y=u.typeReps[d.typeOf(p)]}w=""}if(y===undefined&&t.indexOf("<")!==-1&&t.indexOf(">")!==-1){y=u.typeReps[t.substring(0,t.indexOf("<"))];if(y===undefined){y=u.typeReps.array}}t=w}return{typeRep:y,typePath:t,semantics:l,realType:v}},__resolveTemplate__:function(t,s,o,n,l,u){var p=this;if(o!==undefined){p._currentValue=n;p._currentOptions=u;p._currentSemantics=l;if(!this._reusablesManager.isRegistered(t)){this._reusablesManager.register({id:t,buildContent:function(){var w={};d.merge(w,s.options);d.merge(w,p._currentOptions);w.value=p._currentValue;w=d.extend(w,p._currentSemantics);var v=new o(w);return v}})}var m=this._reusablesManager.use(t);var r=m.component;if(r!==undefined){if(r.disableEvents){r.disableEvents()}d.merge(l,s.options);d.merge(l,u);l.realPath=u.realPath;if(r.failureCapture){l.onFailure=u.onFailure}var q=r.getPublishedPropertiesDefaultValue();d.merge(l,q);l.value=n;if(l.referenceValue===undefined){l.referenceValue=d.clone(n,false)}if(l&&r.setProperties){r.setProperties(l)}if(r.enableEvents){r.enableEvents()}u.onViewCreated(r)}else{c.call(u,"",n)}}},generateView:function(o,l){if(l.onViewCreated===undefined&&l.onFailure===undefined){var n=this;return new g(function(q,p){l.onViewCreated=function(r){q(r)};l.onFailure=function(r){p(r)};n.generateView(o,l)})}l=l||{};var m=this._getTypeData(l.typePath,l.semantics,o);l.semantics=l.semantics||{};d.merge(l.semantics,m.semantics);if(m.typePath!==null&&m.typePath!==undefined){if(m.typeRep!==undefined){l.typeRep=m.typeRep;l.typePath=m.typePath;this.generateTweaker(o,l)}else{c.call(l,"Cannot generate view with the given typePath",o)}}else{c.call(l,"Cannot generate view with an undefined typePath and undefined data",o)}},getTemplateIdentifierFromTypeRep:function(o,m){var n;if(o){var l=m||"stdTemplate";if(o[l]===undefined){l="stdTemplate"}n=o[l]}return n},getTemplateIdentifierFromTypePath:function(o,l){var n;var m=this._getTypeData(o,l);if(m&&m.typeRep){n=this.getTemplateIdentifierFromTypeRep(m.typeRep)}return n},__resolveEnumRepresentation__:function(l){if(Array.isArray(l)){if(l.every(function(m){return typeof m==="string"})){return"enumString"}else{if(l.every(function(m){return typeof m==="number"})){return"enumInteger"}}}else{if(typeof l==="function"){return"enumDyn"}}return"enumCustom"}});function c(l,m){if(this.onFailure&&typeof this.onFailure==="function"){this.onFailure({message:l,data:m,typePath:this.typePath,typeRep:this.typeRep})}}function h(l){return(l=="true")}return k});define("DS/Tweakers/TweakerRange",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase"],function(e,b,d){var c=d.inherit({name:"tweakerBase",publishedProperties:{stepValue:{defaultValue:undefined,type:"object"}},_applyStepValue:function(f){if(this.elements._viewModule&&this.elements._viewModule.setStepValue){this.elements._viewModule.setStepValue(this.stepValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.stepValue=this.stepValue}}},_applyProperties:function(f){this._parent(f);if(this.isDirty("stepValue")){this._applyStepValue(f.stepValue)}}});var a=function(g,f){d.prototype.baseViewModule.call(this,g,f)};b.applyMixin(a,d.prototype.baseViewModule);a.prototype.setStepValue=function(f){if(!this._view){return}this._view.stepValue=f};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={};c.prototype.registerViewModule=function(f,g){return;if(!f||!g||!g.classObject&&!g.classPath){return}if(c.prototype.VIEW_MODULES[f]!==undefined){return}c.prototype.VIEW_MODULES[f]=g};return c});define("DS/Tweakers/TweakerDate",["UWA/Core","DS/Tweakers/TweakerRange","DS/Controls/DatePicker","DS/Controls/TimePicker","DS/Utilities/Utils"],function(b,c,f,h,e){var i=c.inherit({name:"tweakerDate",publishedProperties:{value:{defaultValue:null,type:"date",advancedSetter:true},minValue:{defaultValue:null,type:"date"},maxValue:{defaultValue:null,type:"date"},timePickerFlag:{defaultValue:false,type:"boolean"},timePickerPrecision:{defaultValue:"min",type:"string"},displayStyle:{defaultValue:"date",type:"string"}},_applyTimePickerFlag:function(j){if(this.elements._viewModule&&this.elements._viewModule.setTimePickerFlag){this.elements._viewModule.setTimePickerFlag(this.timePickerFlag)}},_applyTimePickerPrecision:function(j){if(this.elements._viewModule&&this.elements._viewModule.setTimePickerPrecision){this.elements._viewModule.setTimePickerPrecision(this.timePickerPrecision)}},_applyProperties:function(j){this._parent(j);if(this.isDirty("timePickerFlag")){this._applyTimePickerFlag(j.timePickerFlag)}if(this.isDirty("timePickerPrecision")){this._applyTimePickerPrecision(j.timePickerPrecision)}},getStringFromValue:function(k){var j={year:"numeric",month:"short",day:"numeric"};if(this.displayStyle==="date"){if(this.timePickerFlag){j.hour="numeric";j.minute="numeric";if(this.timePickerPrecision==="sec"){j.second="numeric"}}}else{if(this.displayStyle==="time"){j={hour:"numeric",minute:"numeric"};if(this.timePickerPrecision==="sec"){j.second="numeric"}}}if(k&&!k.toLocaleDateString){k=this._upgradeValue(k)}return k?k.toLocaleDateString(WUX.currentLanguage,j):""},_upgradeValue:function(j){if(e.equalsToNaN(j)){return undefined}var k=j;if(typeof j!=="undefined"&&j!==null&&!(j instanceof Date)){k=new Date(j)}return this._parent(k)}});var d=function(k,j){c.prototype.baseViewModule.call(this,k,j)};e.applyMixin(d,c.prototype.baseViewModule);d.prototype.handleEvents=function(){var j=this._view;if(j===undefined){return}var l=this._tweaker;var k=this;if(l.readOnly){return}j.addEventListener("change",function(m){m.stopPropagation();k.setTweakerValue(j.value)});j.addEventListener("liveChange",function(m){m.stopPropagation();k.setTweakerValue(j.value)});j.addEventListener("show",function(m){m.stopPropagation();l.onShow()});j.addEventListener("hide",function(m){m.stopPropagation();l.onHide()})};d.prototype.setTimePickerFlag=function(){};d.prototype.setTimePickerPrecision=function(){};var g=function(k,j){d.call(this,k,j)};e.applyMixin(g,d);g.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.precision=this._tweaker.precision;j.touchMode=this._tweaker.touchMode;j.fireOnlyFromUIInteractionFlag=true;this._view=new h(j);this.setValue(this._tweaker.value)};g.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}d.prototype.destroy.call(this)};g.prototype.setValue=function(k,j){if(!this._view){return}this._view.value=k};g.prototype.setTimePickerPrecision=function(j){if(!this._view){return}this._view.precision=j};var a=function(k,j){d.call(this,k,j)};e.applyMixin(a,d);a.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.timePickerFlag=this._tweaker.timePickerFlag;j.timePickerPrecision=this._tweaker.timePickerPrecision;j.touchMode=this._tweaker.touchMode;j.fireOnlyFromUIInteractionFlag=true;this._view=new f(j);this.setValue(this._tweaker.value)};a.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}d.prototype.destroy.call(this)};a.prototype.setValue=function(k,j){if(!this._view){return}if(typeof(k)==="string"){k=new Date(k)}this._view.value=k};a.prototype.setTimePickerPrecision=function(j){if(!this._view){return}if(this._view.timePickerPrecision){this._view.timePickerPrecision=j}};a.prototype.setTimePickerFlag=function(j){if(!this._view){return}if(this._view.timePickerFlag){this._view.timePickerFlag=j}};i.prototype.baseViewModule=d;i.prototype.VIEW_MODULES={time:{classObject:g},date:{classObject:a}};i.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(i.prototype.VIEW_MODULES[j]!==undefined){return}i.prototype.VIEW_MODULES[j]=k};return i});define("DS/Tweakers/TweakerNumber",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerRange","DS/Controls/SpinBox","DS/Controls/Slider","DS/Controls/ProgressBar","DS/Controls/ColoredSlider","DS/Utilities/KeyboardUtils","DS/Utilities/Dom"],function(f,j,g,l,i,d,k,o,b){var h=g.inherit({name:"tweakerNumber",publishedProperties:{decimals:{defaultValue:5,type:"number"},units:{defaultValue:"",type:"string"},colorFrom:{defaultValue:"#000",type:"string"},colorTo:{defaultValue:"#fff",type:"string"},displayStyle:{defaultValue:"spinBox",type:"string"},value:{defaultValue:0,type:"number",advancedSetter:true,recordFlag:true},valueType:{defaultValue:"number",type:"string"},minValue:{defaultValue:undefined,type:"number"},maxValue:{defaultValue:undefined,type:"number"},stepValue:{defaultValue:0.1,type:"number"},referenceValue:{defaultValue:undefined,type:"number"}},_applyDecimals:function(p){if(this.elements._viewModule&&this.elements._viewModule.setDecimals){this.elements._viewModule.setDecimals(this.decimals)}},_applyUnits:function(p){this._suffix=this.units;if(this.elements._viewModule&&this.elements._viewModule.setSuffix){this.elements._viewModule.setSuffix(this.units)}},_applyColorFrom:function(){if(this.elements._viewModule&&this.elements._viewModule.setColorFrom){this.elements._viewModule.setColorFrom(this.colorFrom)}},_applyColorTo:function(){if(this.elements._viewModule&&this.elements._viewModule.setColorTo){this.elements._viewModule.setColorTo(this.colorTo)}},_applyProperties:function(p){this._parent(p);if(this.isDirty("decimals")){this._applyDecimals(p.decimals)}if(this.isDirty("units")){this._applyUnits(p.units)}if(this.isDirty("colorFrom")){this._applyColorFrom(p.colorFrom)}if(this.isDirty("colorTo")){this._applyColorTo(p.colorTo)}},_upgradeValue:function(r){if(r===undefined||r===null){return r}else{if(r instanceof Array){return undefined}else{if(typeof(r)==="string"){var p=parseFloat(r);if(isNaN(p)){return undefined}else{return p}}}}var q=Number(r);if(j.equalsToNaN(q)){return undefined}return q}});var c=function(q,p){g.prototype.baseViewModule.call(this,q,p)};j.applyMixin(c,g.prototype.baseViewModule);c.prototype.setDecimals=function(p){};c.prototype.setSuffix=function(p){};c.prototype.setColorFrom=function(p){};c.prototype.setColorTo=function(p){};var m=function(q,p){c.call(this,q,p)};j.applyMixin(m,c);m.prototype.buildView=function(){var p=this._options.viewOptions||{};p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.pageStepValue=this._tweaker.stepValue*10;p.decimals=this._tweaker.decimals;p.units=this._tweaker.units;p.touchMode=this._tweaker._getCurrentTouchMode();p.selectAllOnFocus=true;p.fireOnlyFromUIInteractionFlag=true;this._view=new l(p);b.addEventOnElement(this,this._view,"preValidateValue",function(q){q.stopPropagation()});this.setValue(this._tweaker.value)};m.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r||r.readOnly){return}b.addEventOnElement(r,p,"beginEdit",function(s){s.stopPropagation();r.onPreEdit(null,"beginEdit")});b.addEventOnElement(r,p,"uncommittedChange",function(s){s.stopPropagation()});b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});b.addEventOnElement(r,p,"endEdit",function(s){s.stopPropagation();r.onPostEdit(null,"endEdit")});p.addEventListener("focus",function(s){s.stopPropagation()})};m.prototype.setValue=function(r){var s=this._tweaker;var p=this._view;if(!p||!s){return}var q=parseFloat(r);if(isNaN(q)){this._view.value=undefined}else{this._view.value=q}};m.prototype.setReadOnly=function(p){if(this._view){this._view.destroy();this._view=undefined}this.buildView();this.handleEvents();this.inject(this._tweaker.getContent());this._tweaker.elements.internalView=this._view};m.prototype.setDecimals=function(p){if(!this._view){return}this._view.decimals=p};m.prototype.setSuffix=function(p){if(!this._view||!this._tweaker){return}this._view.units=p};var n=function(q,p){c.call(this,q,p)};j.applyMixin(n,c);n.prototype.buildView=function(){var p=this._options.viewOptions||{};p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.touchMode=this._tweaker._getCurrentTouchMode();p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new i(p);this.setValue(this._tweaker.value)};n.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r||r.readOnly){return}b.addEventOnElement(r,p,"beginEdit",function(s){s.stopPropagation();r.onPreEdit(null,"beginEdit")});b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});b.addEventOnElement(r,p,"endEdit",function(s){s.stopPropagation();r.onPostEdit(null,"endEdit")});b.addEventOnElement(r,p,"keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit();r.onPreEdit(null,"cancelEdit-preEdit")}})};n.prototype.setValue=function(q){var p=this._view;if(!p){return}this._view.value=q};var e=function(q,p){n.call(this,q,p)};j.applyMixin(e,n);e.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.colorFrom=this._tweaker.colorFrom;p.colorTo=this._tweaker.colorTo;p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new k(p);this.setValue(this._tweaker.value)};e.prototype.setValue=function(r){var s=this._tweaker;var p=this._view;if(!p||!s){return}var q=parseFloat(r);if(isNaN(q)){this._view.value=undefined}else{this._view.value=q}};e.prototype.setColorFrom=function(p){if(!this._view||!this._tweaker||this._tweaker.readOnly){return}this._view.colorFrom=p};e.prototype.setColorTo=function(p){if(!this._view||!this._tweaker||this._tweaker.readOnly){return}this._view.colorTo=p};var a=function(q,p){c.call(this,q,p)};j.applyMixin(a,c);a.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.fireOnlyFromUIInteractionFlag=true;this._view=new d(p);this.setValue(this._tweaker.value)};a.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r){return}b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)})};a.prototype.setValue=function(q){var p=this._view;if(!p){return}this._view.value=q};h.prototype.baseViewModule=c;h.prototype.VIEW_MODULES={spinBox:{classObject:m},slider:{classObject:n},progress:{classObject:a},progress_readOnly:{classObject:a},colorSlider:{classObject:e}};h.prototype.registerViewModule=function(p,q){return;if(!p||!q||!q.classObject&&!q.classPath){return}if(h.prototype.VIEW_MODULES[p]!==undefined){return}h.prototype.VIEW_MODULES[p]=q};return h});define("DS/Tweakers/TweakerVector",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerRange","DS/Controls/SpinBox"],function(g,b,e,d){var f=e.inherit({name:"TweakerVector",publishedProperties:{units:{defaultValue:"",type:"string",category:"Appearance"},definition:{defaultValue:["x","y"],type:"array",category:"Model"},value:{defaultValue:undefined,type:"array",category:"Model"},displayStyle:{defaultValue:"spinBoxes",type:"string",category:"Appearance"}},_preBuildView:function(){this._parent();this.elements.container.addClassName("wux-tweakers-vector-view")},_upgradeValue:function(l){if(b.equalsToNaN(l)){return undefined}else{if(l){var k=l;if(typeof(l)==="string"){try{k=JSON.parse(l)}catch(n){return this._parent(l)}}var h=this.definition.length;if(h===k.length){return k}else{if(h<k.length){var o=g.clone(k);o.splice(h,k.length-h);return o}else{if(h>k.length){var o=g.clone(k);var m=h-k.length;for(var j=0;j<m;j++){o.push(undefined)}return o}}}}}return this._parent(l)},compare:function(m,l){if((m===undefined)&&(l!==undefined)){return 2}else{if((m!==undefined)&&(l===undefined)){return -2}else{if((m===undefined)&&(l===undefined)){return 0}}}var k=0;for(var h=0;h<m.length;h++){k+=m[h]*m[h]}var j=0;for(var h=0;h<l.length;h++){j+=l[h]*l[h]}if(k===j){return 0}else{if(k<j){return -1}else{return 1}}},_applyUnits:function(h){if(this.elements._viewModule){this.elements._viewModule.setUnits(this.units)}},_applyDefinition:function(h){this.value=this._upgradeValue(this.value);if(this.elements._viewModule){this.elements._viewModule.setDefinition(this.definition,h)}},_applyProperties:function(h){this._parent(h);var i=!(this.isDirty("displayStyle")||this.isDirty("readOnly"));if(i&&this.isDirty("definition")){this._applyDefinition(h.definition)}if(i&&this.isDirty("units")){this._applyUnits(h.units)}}});var c=function(i,h){e.prototype.baseViewModule.call(this,i,h)};b.applyMixin(c,e.prototype.baseViewModule);c.prototype.setUnits=function(h){};c.prototype.setDefinition=function(h){};var a=function(i,h){this._labelsDiv=[];this._spinBoxes=[];c.call(this,i,h)};b.applyMixin(a,c);a.prototype.buildView=function(){this.setDefinition(this._tweaker.definition)};a.prototype.handleEvents=function(){};a.prototype.destroy=function(){this._labelsDiv.forEach(function(h){h.remove()});this._labelsDiv=[];this._spinBoxes.forEach(function(h){h.remove();h.destroy()});this._spinBoxes=[]};a.prototype.setValue=function(j){var i=j||[];this._updateFromAPI=true;var h=0;for(;h<i.length&&h<this._spinBoxes.length;h++){this._spinBoxes[h].value=i[h]}for(;h<this._spinBoxes.length;h++){this._spinBoxes[h].value=undefined}};a.prototype.setTouchMode=function(h){this._spinBoxes.forEach(function(i){i.touchMode=h})};a.prototype.setUnits=function(h){this._spinBoxes.forEach(function(i){i.units=h})};a.prototype.setDefinition=function(m,h){var t=this;var q=this._tweaker;var k=q.getContent();var o=(h?h.length:0);var j=m.length-o;if(j>0){var p=this._options.viewOptions||{};p.touchMode=q._getCurrentTouchMode();p.units=q.units;p.fireOnlyFromUIInteractionFlag=true;var l=q.value||[];for(var n=0;n<j;n++){var v=g.createElement("label",{"class":"wux-tweakers-vector-label",tabindex:-1});v.inject(k);this._labelsDiv.push(v);p.value=(o+n<l.length?l[o+n]:undefined);var r=new d(p);r.getContent().addClassName("wux-tweakers-vector-spinBox");r._indexToModify=o+n;r.addEventListener("change",function(i){i.stopPropagation();if(!q.value){q._properties.value.value=Array.apply(undefined,Array(q.definition.length))}if(q.value.length>i.dsModel._indexToModify){q.value[i.dsModel._indexToModify]=i.dsModel.value}q._applyValue()});r.addEventListener("beginEdit",function(i){i.stopPropagation();q.onPreEdit(null,"beginEdit")});r.addEventListener("uncommittedChange",function(i){i.stopPropagation()});r.addEventListener("endEdit",function(i){i.stopPropagation();q.onPostEdit(null,"endEdit")});r.inject(k);this._spinBoxes.push(r)}}else{if(j<0){j*=-1;var s=this._labelsDiv.splice(m.length,j);s.forEach(function(i){i.remove()});var u=this._spinBoxes.splice(m.length,j);u.forEach(function(i){i.remove();i.destroy()})}}this._labelsDiv.forEach(function(x,i){var w=m[i];x.textContent=w?w:""})};f.prototype.baseViewModule=c;f.prototype.VIEW_MODULES={readOnly:{classObject:a,options:{viewOptions:{disabled:true}}},spinBoxes:{classObject:a}};return f});define("DS/Tweakers/CustomTreeNodeViewTweaker",["UWA/Core","DS/Tree/TreeNodeView","DS/TreeModel/TreeDocument","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/DocUtils","DS/Controls/TooltipModel","DS/Utilities/Utils","DS/Tweakers/TweakerUtils"],function(c,f,a,b,i,d,e,g){var h=function(j){var l=this;j=j||{};l.updateNodeParent=function(s,p){var q=s.getParent();var o=q.options.grid;var n=e.getObjectPropertyInfo(j.value,o.path);if(n.valid&&n.value!==o.data){o.data=n.value}if(q&&!q._isTrueRoot()){var m=p.getCell(q._getRowID(),"data");if(m){var r=m.getView();if(r){r.updateView()}}l.updateNodeParent(q,p)}};l.updateNodeChildren=function(p,n,o){var m=p.getChildren();if(m){m.forEach(function(u){if(u){var s=u.options.grid;if(s&&s.path!==undefined){var r=e.getObjectPropertyInfo(o,s.path);var q=n.getCell(u._getRowID(),"data");if(q&&r.valid&&r.value!==s.value){var t=q.getView();s.data=r.value;if(t){t.updateView()}}l.updateNodeChildren(u,n,o)}}})}};l.customTreeNodeView=f.extend({init:function(m){this._parent(m)},updateInternalParameters:function(){this._parent();var m=this.getCellInfos();if(j._portalTweaker){if(m.dataIndex==="tree"||(j.displayMode==="oneColumn"&&m.dataIndex==="data")){i.getWebUXPropertyDocumentation(m.nodeModel.options.label,j.realPath?j.realPath:j.valueType,function(p){var o=(p&&p.property)?p.property:"";var r=(p&&p.doc)?p.doc:m.nodeModel.options.label;var q={title:o,longHelp:r};m.cellView._setTooltip(m.cellView.elements.labelContainer,q)})}}if(!m.isHeader){var n=m.nodeModel;this.getContent().setAttribute("has-children",n.hasChildren());this.getContent().setAttribute("is-required",n.options.grid.required||false);if(j.labelDisplay==="left"||j.authoringFlag){this.getContent().addClassName("wux-left-labelDisplay");this.getContent().removeClassName("wux-right-labelDisplay")}else{if(j.labelDisplay==="right"){this.getContent().addClassName("wux-right-labelDisplay");this.getContent().removeClassName("wux-left-labelDisplay")}}}},_setTooltip:function(q,n){var p=this;var m=n.title?n.title:"";function o(){var t=p.getCellInfos().dataIndex;var r=p.getCellModel().options;var s=n.longHelp;if((t!=="tree"&&s===String(r.value))||(t==="tree"&&s===String(r.value.options.grid.name)&&m==="")){return false}return true}if(o()){p.getContent().tooltipInfos=new d({title:m,longHelp:n.longHelp,mouseRelativePosition:true})}}});function k(){return[{dataIndex:"tree",text:"Label",isDraggable:false,isHidden:false,width:"40%"},{dataIndex:"type",isHidden:true},{dataIndex:"tweakerType",isHidden:true},{dataIndex:"data",text:"Value",isEditable:true,width:"auto",onCellRequest:function(o){if(!o.isHeader&&o.nodeModel&&o.nodeModel.options&&!o.nodeModel.options.temporary){var m=g._setModelViewForDataColumnOneColumnCase(l,o);var n=o.nodeModel.options.grid;if(WUX.typeRepFactory!==undefined&&!n._buildFailure){WUX.typeRepFactory.generateView(m.data,m.generateViewOptions)}else{WUX.typeRepFactory=new b({onReady:function(){this.generateView(m.data,m.generateViewOptions)}})}}},setValue:function(m){m.nodeModel.options.grid.data=m.value;m.nodeModel.notifyModelUpdate()},getValue:function(m){return m.nodeModel.options.grid.data}},{dataIndex:"remove",isHidden:true}]}this.treeOptions={defaultCellHeight:38,isSortable:false,cellClass:this.customTreeNodeView,apiVersion:2,show:{rowHeaders:false,columnHeaders:false},expanderStyle:"triangle",performances:{buildLinks:false},treeDocument:j.doc,resize:{columns:true},selection:false,columns:k()}};return h});define("DS/Tweakers/GeneratedToolbar",["UWA/Core","UWA/Element","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Toolbar","DS/Tweakers/TypeRepresentationFactory","DS/Tree/TreeListView","DS/Tweakers/CustomTreeNodeViewTweaker","DS/Controls/TooltipModel","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","UWA/Class/Promise","DS/Utilities/Utils","DS/Utilities/Dom",],function(f,n,b,p,s,o,h,i,g,j,k,e,d,q){function l(){var v=0;function z(C,D,B,F){var E=0;v=0;var A=[];for(var G in B){if(!B[G]||B[G].length===0){return}B[G].forEach(function(I){var J=E>0&&I===B[G][0];var H=y(C,I,J,F);A.push(H)});E++}return A}function y(D,J,E,B){var C,H,G,I;var F={};F.id=J._ID;C=f.createElement("div",{"class":"wux-generated-toolbar-items"});C.toolbarProperties=C.toolbarProperties||{};C.toolbarProperties.order=t;t++;C._treeNodeModel=J;I=J.options.label;if(I&&J.options.displayLabel){H=f.createElement("div",{"class":"wux-generated-toolbar-items-label",html:I}).inject(C)}G=f.createElement("div",{"class":"wux-generated-toolbar-items-tweaker"}).inject(C);var A=function(O){if(!J._associatedView){J._hasBeenUpdatedSinceViewGeneration=true;return}var L=J.options.grid.semantics?J.options.grid.semantics:{};for(var P in J.options){if(Object.getPrototypeOf(J._associatedView).publishedProperties[P]){L[P]=J.options[P]}}L.value=J.options.grid.data;L.context=J._associatedView.context;if(J._associatedView.tooltipInfos){J._associatedView.tooltipInfos.shortHelp=J.options.tooltip}else{if(J.options.tooltip){L.tooltipInfos=new g({shortHelp:J.options.tooltip})}}var M=x.typeRepresentationFactory.getRegisteredTypeRepresentation(J.options.grid.typeRep);var K=x.typeRepresentationFactory.getTemplateIdentifierFromTypeRep(M,"inlinedTemplate");var N=x.typeRepresentationFactory.getRegisteredTypeTemplate(K);d.setTweakerProperties(J._associatedView,L,M,N)};J.addEventListener("nodeModelUpdate",A);x.promises.push(x.typeRepresentationFactory.generateView(J.options.grid.data,{typePath:J.options.grid.typeRep,readOnly:J.options.readOnly,touchMode:J.options.touchMode,disabled:J.options.disabled,context:"inlinedTemplate",semantics:f.clone(J.options.grid.semantics)}).then(function(K){if(K!==undefined){G.setContent(K);if(J.options.tooltip){K.tooltipInfos=new g({shortHelp:J.options.tooltip})}F.tweaker=K;K.context=B;J._associatedView=K;if(J._hasBeenUpdatedSinceViewGeneration){A()}K.addEventListener("change",function(){if(D&&J){D.prepareUpdate();J.setAttribute("data",K.value);D.pushUpdate()}})}}));x._toolbar.add("element",{element:C,position:J.options.position||"near",index:v});v++;if(E){x._toolbar.add("separator",{element:C,index:v});v++}return F}var x=this,u,w,t=0;x._toolbar.showEverything();x._toolbar.clear();if(!x.items){return}w={near:{},center:{},far:{}};x.items.getChildren().forEach(function(C){var A,B;A=C.options.position;B=C.options.category||"other";if(!A||w[A]===undefined){A="near"}if(!w[A][B]){w[A][B]=[]}w[A][B].push(C)});x.promises=[];x.array1=z(this.items,"near",w.near,this.context);x.array2=z(this.items,"center",w.center,this.context);x.array3=z(this.items,"far",w.far,this.context);e.allSettled(x.promises).then(function(A){x._toolbar.fire("onReady");x._toolbar.fire("dimensionsChanged")})}function a(){var t=this;if(t._popupTreeListView){t._popupTreeListView.hide()}t._toolbar.enablePopupDefaultBehavior()}function c(){var D=this;function F(){if(C&&!t){D._popupTreeListView.inject(C);t=true}}function E(I,K){var L=w;if(I._treeNodeModel){var J=I._treeNodeModel._getRowID();if(K){H.showRow(J)}else{H.hideRow(J)}}}function x(){if(H){var J=H.getRows();for(var I=0;J&&I<J.length;I++){H.hideRow(I)}}}function v(){var I,J;F();I=D._toolbar._getNearestHiddenElement();if(D._toolbar._isSeparator(I)){J=I;I=J.nextSibling}return{toolbarItemElement:I,toolbarSeparatorElement:J}}function G(){var I=0;F();for(var J=0;H&&J<H.getNumberOfRows();J++){if(!H.isRowHidden(J)){I++}}return I}function B(I){E(I,true);I.hide()}function y(I){E(I,false);I.show()}var H,w,u,C,A,t,z;u=D._toolbar.elements.dropdownPopup;C=u?D._toolbar.elements.dropdownPopup.elements.container:null;t=false;A=new i({doc:D.items});z={height:"inherit",defaultCellWidth:20,enableDragAndDrop:false};z=f.merge(z,A.treeOptions);if(!D._popupTreeListView){D._popupTreeListView=new h(z)}else{D._popupTreeListView.show()}H=D._popupTreeListView.getManager();w=H.getDocument();D._popupTreeListView.getContent().addClassName("wux-toolbar-popup-treeList");if(C&&!t){D._popupTreeListView.inject(C);H.loadDocument(D.items);t=true;C.addEventListener("show",function(){var L=D._computeColumnsWidthInPopup();var J=L.secondColumnWidth+10;var K=L.firstColumnWidth;if(K>0){K=K+40}H.setColumnWidth(0,K);H.setColumnWidth(1,J);C.style.width=K+J+10+"px";var I=document.createEvent("Event");I.initEvent("dimensionsChanged",true,false);C.dispatchEvent(I)})}x();D._toolbar.enablePopupBehavior({getLastInPopup:v,getNbElementsInPopup:G,addToPopup:B,addToToolbar:y})}function m(C){var v=C;if(!v.entries){return}var D=[];function x(M){if(M.dataElements){var L=null,J=null;var K={label:"title",typeRepresentation:"type"};for(L in M.dataElements){J=L;if(K.hasOwnProperty(L)){J=K[L]}Object.defineProperty(M,J,Object.getOwnPropertyDescriptor(M.dataElements,L));delete M.dataElements[L]}}}var A=v.entries,u=A.length,F=0,I=0,H=null,t=null,E=0;for(F=0;F<u;++F){H=A[F];if(!H.dataElements){throw new Error("Missing dataElements on",H)}if(!H.dataElements.typeRepresentation){throw new Error("Missing dataElements.typeRepresentation on",H)}if(H.grid){throw new Error("grid is a reserved keyword")}H.grid={};Object.defineProperty(H.grid,"typeRep",Object.getOwnPropertyDescriptor(H.dataElements,"typeRepresentation"));delete H.dataElements.typeRepresentation;H.grid.semantics={};if(undefined!==H.dataElements.icon&&null!==H.dataElements.icon){Object.defineProperty(H.grid.semantics,"icon",Object.getOwnPropertyDescriptor(H.dataElements,"icon"));delete H.dataElements.icon}if(undefined!==H.dataElements.label&&null!==H.dataElements.label){Object.defineProperty(H.grid.semantics,"label",Object.getOwnPropertyDescriptor(H.dataElements,"label"))}if(undefined!==H.dataElements.readOnly&&null!==H.dataElements.readOnly){Object.defineProperty(H.grid,"readOnly",Object.getOwnPropertyDescriptor(H.dataElements,"readOnly"))}if(undefined!==H.dataElements.disabled&&null!==H.dataElements.disabled){Object.defineProperty(H.grid,"disabled",Object.getOwnPropertyDescriptor(H.dataElements,"disabled"))}if(undefined!==H.dataElements.value&&null!==H.dataElements.value){Object.defineProperty(H.grid,"data",Object.getOwnPropertyDescriptor(H.dataElements,"value"))}if(H.dataElements.hasOwnProperty("value")){delete H.dataElements.value}if(H.grid.data===undefined){if(H.children){H.grid.data={};Object.defineProperty(H.grid.data,"menu",Object.getOwnPropertyDescriptor(H,"children"));delete H.children;E=H.grid.data.menu.length;for(I=0;I<E;++I){t=H.grid.data.menu[I];x(t);if(t.children&&t.children.length>0){Object.defineProperty(t,"submenu",Object.getOwnPropertyDescriptor(t,"children"));delete t.children;var z=t.submenu;var B=z.slice(0,z.length);var y=null;while(B.length>0){y=B.splice(0,1)[0];if(y.children&&y.children.length>0){B=B.concat(y.children);Object.defineProperty(y,"submenu",Object.getOwnPropertyDescriptor(y,"children"));delete y.children}x(y)}}}}}var w=null;for(w in H.dataElements){Object.defineProperty(H,w,Object.getOwnPropertyDescriptor(H.dataElements,w));delete H.dataElements[w]}delete H.dataElements;if(H.action){if(H.grid.data===undefined){H.grid.data={}}for(w in H.action){Object.defineProperty(H.grid.data,w,Object.getOwnPropertyDescriptor(H.action,w));delete H.action[w]}delete H.action}var G=new k(H);G._ID=H.id;D.push(G)}return{nodes:D,typeReps:v.typeRepresentations,enums:v.enums}}var r=p.inherit({name:"generatedToolbar",publishedProperties:{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},items:{defaultValue:null,type:"DS/Treeitems/TreeDocument",category:"Model"},typeRepresentationFactory:{defaultValue:null,type:"DS/Tweakers/TypeRepresentationFactory",category:"Model"},popupDisplayStyle:{defaultValue:"TreeListView",type:"string",category:"Appearance"},context:{defaultValue:undefined,type:"object"}},_toolbar:null,_popupTreeListView:null,createTreeDocument:function(v){var u=null;var t=m(v);if(t){u=new j();u.prepareUpdate();u.addRoot(t.nodes);u.pushUpdate()}return u},updateModel:function(u){if(this.items){this.items.empty()}var t=m(u);if(t){if(!this.items){this.items=new j()}this.items.prepareUpdate();this.items.addRoot(t.nodes);this.items.pushUpdate()}},buildView:function(){this._toolbar=new s();this._properties.typeRepresentationFactory.value=new o();this.elements=this._toolbar.elements},_applyProperties:function(t){this._parent(t);if(this.isDirty("direction")){this._applyDirection(t.direction)}if(this.isDirty("overflowManagement")){this._applyOverflowManagement(t.overflowManagement)}if(this.isDirty("items")){this._applyItems(t.items)}this._applyPopupDisplayStyle(t.popupDisplayStyle)},_applyOverflowManagement:function(t){this._toolbar.overflowManagement=this.overflowManagement},_applyDirection:function(t){this._toolbar.direction=this.direction},_applyItems:function(t){var u=this;if(u.items){u.items.getModelEvents().addEventListener("addChild",function(v){l.call(u)});u.items.getModelEvents().addEventListener("removeChild",function(v){l.call(u)})}l.call(u)},_applyPopupDisplayStyle:function(t){if(this.popupDisplayStyle==="TreeListView"){c.call(this)}else{if(this.popupDisplayStyle==="Basic"){a.call(this)}}},updateNodeModel:function(t,B){if(this.items){var w=undefined;var v=this.items.getChildren().length;for(var z=0;z<v;z++){w=this.items.getChildren()[z];if(w&&this.getNodeModelByID(t)){this.getNodeModelByID(t).updateOptions(B);return true}else{if(w.options.grid.data&&w.options.grid.data.menu){var u=w.options.grid.data.menu;var y=u.length;for(var A=0;A<y;A++){var x=u[A];if(x.id===t){Object.keys(B).forEach(function(C){var D=B[C];x[C]=D;return true})}else{if(x.submenu){this.updateNodeModelSubMenu(x,t,B)}}}}}}}},updateNodeModelSubMenu:function(w,y,v){if(w.submenu){var u=w.submenu;var x=u.length;for(var t=0;t<x;t++){var w=u[t];if(w.id===y){Object.keys(v).forEach(function(z){var A=v[z];w[z]=A;return true})}else{if(w.submenu){this.updateNodeModelSubMenu(w,y,v)}}}}},_computeColumnsWidthInPopup:function(){var x=function(B){var C=B;if(C.hasClassName("wux-tweakers")){return C.dsModel}else{for(var D in C.getChildren()){var A=x(C.getChildren()[D]);if(A){return A}}}return undefined};var u=this._toolbar._getNearestHiddenElement();var z=0;var y=0;while(u){if(this._toolbar._isSeparator(u)||!u._treeNodeModel){u=u.nextSibling}else{var t=u._treeNodeModel.options.label;if(t){var v=window.getComputedStyle(u,null);z=Math.max(z,q.computeStringWidth(t,parseFloat(v.getPropertyValue("font-size")),v.getPropertyValue("font-family"),false))}var w=x(u);if(w){y=Math.max(y,w.computeContentSize())}u=u.nextSibling}}return{firstColumnWidth:z,secondColumnWidth:y}},getNodeModelByID:function(w){if(this.items){var v=undefined;var t=this.items.getRoots();for(var u=0;u<t.length;u++){v=t[u];if(v._ID===w){return v}}}}});return r});define("DS/Tweakers/StringViewModules",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/ColorPicker","DS/Controls/ComboBox","DS/Controls/ButtonGroup","DS/Controls/Button","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils"],function(h,c,u,v,z,r,A,j,a,n,g,p,w){function m(C,D){switch(C){case"integer":var B=parseInt(D,10);if(isNaN(B)){this.valueType="string";B=D?D.toString():""}return B;case"number":var B=parseFloat(D);if(isNaN(B)){this.valueType="string";B=D?D.toString():""}return B;case"boolean":return(/true/i.exec(D)!==null||D==="1");case"string":return D?D.toString():"";case"object":return JSON.parse(D);default:return D}}function d(B,C){if(typeof(C)==="string"){return C}if(B==="object"){return JSON.stringify(C)}else{if((B==="integer"||B==="number")&&((Number.isNan&&Number.isNaN(C)===true)||(isNaN!==undefined&&isNaN(C)===true))){return"NaN"}else{if(B==="integer"||B==="number"){return C.toString()}else{return C}}}}function t(B){return g.getWebappsBaseUrl()+B}var i=function(C,B){v.prototype.baseViewModule.call(this,C,B)};c.applyMixin(i,v.prototype.baseViewModule);var y=function(C,B){i.call(this,C,B)};c.applyMixin(y,i);y.prototype.buildView=function(){var B=this._options.viewOptions||{};B.escapeHTML=this._tweaker.escapeHTML;B.touchMode=this._tweaker._getCurrentTouchMode();B.disabled=this._tweaker.readOnly;B.selectAllOnFocus=true;B.fireOnlyFromUIInteractionFlag=true;B.autoCommitFlag=true;this._view=new z(B);this.setValue(this._tweaker.value)};y.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;if(!B||!D){return}u.addEventOnElement(D,B,"focus",function(E){E.stopPropagation()});u.addEventOnElement(D,B,"blur",function(E){E.stopPropagation();D.onPostEdit()});u.addEventOnElement(D,B,"uncommittedChange",function(E){E.stopPropagation();D.onPreEdit()});if(B._myInput){u.addEventOnElement(D,B._myInput,"keydown",function(E){if(E.keyCode===p.ESCAPE){D.onCancelEdit()}if((E.keyCode===p.ENTER)&&!E.ctrlKey&&!E.shiftKey&&!E.altKey&&D._liveChangeOccurred){D.onChange()}})}u.addEventOnElement(D,B,"change",function(G){G.stopPropagation();var F=B.value;var E=undefined;if(F===undefined||F===null){E=F}else{E=m.call(D,D.valueType,F)}C.setTweakerValue(E)})};y.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}if(C===undefined||C===null){B.value=C}else{B.value=d(D.valueType,C)}};var k=function(C,B){y.call(this,C,B)};c.applyMixin(k,y);k.prototype.buildView=function(){var B=this._options.viewOptions||{};B.escapeHTML=this._tweaker.escapeHTML;B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker.touchMode;B.fireOnlyFromUIInteractionFlag=true;B.selectAllOnFocus=true;B.autoCommitFlag=true;B.nbRows=0;B.widthInCharNumber=0;this._view=new r(B);this._tweaker.getContent().addClassName("wux-tweakers-editor");this.setValue(this._tweaker.value)};k.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.getContent().removeClassName("wux-tweakers-editor")}y.prototype.destroy.call(this)};k.prototype.setValue=function(C){var B=this._view;if(B){B.value=C}};var l=function(C,B){this._inlinedLineEditor=undefined;this._standardEditor=undefined;i.call(this,C,B)};c.applyMixin(l,i);l.prototype.buildView=function(){this._inlinedLineEditor=new h.Element("div");this._inlinedLineEditor.addClassName("wux-controls-abstract wux-controls-lineeditor wux-tweakers-multirep-tweakerstring");this._inlinedLineEditor._myInput=new h.Element("input");this._inlinedLineEditor._myInput.inject(this._inlinedLineEditor);this._standardEditor=new k(this._tweaker);this._view=w._buildInlineEditor(this._tweaker,this._inlinedLineEditor,this._standardEditor,{offset:1});this._view.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor");this.setValue(this._tweaker.value);this.setTouchMode(this._tweaker._getCurrentTouchMode())};l.prototype.handleEvents=function(){var C=this;var B=function(){if(C._view.embeddedContainer){C._view.embeddedContainer.visibleFlag=true}else{C._view.editBtn.getContent().click()}C._standardEditor._view._giveFocus()};u.addEventOnElement(C,C._inlinedLineEditor._myInput,"focus",B)};l.prototype.setTouchMode=function(B){if(!this._view){return}if(B===true){this._inlinedLineEditor.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedLineEditor.removeAttribute("touch-mode")}this._standardEditor.setTouchMode(B);if(this._view.embeddedContainer){this._view.embeddedContainer.touchMode=B}this._view.editBtn.touchMode=B};l.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}this._inlinedLineEditor._myInput.value=C;this._standardEditor.setValue(C)};l.prototype.destroy=function(){if(this._view){this._view.remove()}if(this._inlinedLineEditor){this._inlinedLineEditor.remove()}if(this._standardEditor){this._standardEditor.destroy()}if(this._view.embeddedContainer){this._view.embeddedContainer.visibleFlag=false;this._view.embeddedContainer.destroy()}if(this._view.editBtn){this._view.editBtn.destroy()}if(this._view){this._view.destroy()}delete this._view};var x=function(C,B){this._inlinedLineEditor=undefined;this._standardEditor=undefined;i.call(this,C,B)};c.applyMixin(x,i);x.prototype.buildView=function(){this._inlinedLineEditor=new h.Element("div");this._inlinedLineEditor.addClassName("wux-tweakers wux-tweakers-string-label");this._standardEditor=new h.Element("div");this._standardEditor.addClassName("wux-tweakers-standardEditor");this._view=w._buildInlineEditor(this._tweaker,this._inlinedLineEditor,this._standardEditor,{offset:true,hasNoButton:true});this.setValue(this._tweaker.value);this.setTouchMode(this._tweaker._getCurrentTouchMode())};x.prototype.setTouchMode=function(B){if(!this._view){return}if(B===true){this._inlinedLineEditor.setAttributeNode(document.createAttribute("touch-mode"));this._standardEditor.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedLineEditor.removeAttribute("touch-mode");this._standardEditor.removeAttribute("touch-mode")}if(this._view.embeddedContainer){this._view.embeddedContainer.touchMode=B}};x.prototype.setValue=function(B){if(this._tweaker.escapeHTML&&B){B=h.String.escapeHTML(B)}this._inlinedLineEditor.setContent(B);this._standardEditor.setContent(B)};x.prototype.destroy=function(){if(this._view){this._view.remove()}if(this._inlinedLineEditor){this._inlinedLineEditor.remove()}if(this._standardEditor){this._standardEditor.remove()}if(this._view.embeddedContainer){this._view.embeddedContainer.visibleFlag=false;this._view.embeddedContainer.destroy()}if(this._view){this._view.destroy()}delete this._view};var s=function(C,B){i.call(this,C,B)};c.applyMixin(s,i);s.prototype.buildView=function(){var B=this._options.viewOptions||{};B.elementsList=this._tweaker.possibleValues.map(function(C){return(typeof C==="string")?C:{labelItem:C.value,iconItem:C.icon}});B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;B.reachablePlaceholderFlag=this._tweaker.allowResetToUndefinedByUIFlag;B.placeholder=this._tweaker.usageDescription;this._view=new j(B);this.setValue(this._tweaker.value)};s.prototype.computeTweakerContentLength=function(){return u.computeStringWidth(this._view.value,this._tweaker.getFontSize(),this._tweaker.getFontFamily(),this._tweaker.getEditedState())+30};s.prototype.handleEvents=function(){var D=this;var E=this._tweaker;var C=this._view;var B=false;if(!C||!E){return}u.addEventOnElement(E,C,"show",function(F){F.stopPropagation();E.onShow()});u.addEventOnElement(E,C,"hide",function(F){F.stopPropagation();E.onHide({cancelFlag:(F.options.cancelPopupSelection?true:false)})});u.addEventOnElement(E,C,"preselectionChange",function(G){G.stopPropagation();var F;F=C._getAllDescendants()[C.preselectedIndex].options.grid.valueItem;if(!F){F=C._getAllDescendants()[C.preselectedIndex].options.label}B=true;D.setTweakerValue(F);B=false});u.addEventOnElement(E,C,"change",function(F){F.stopPropagation();if(!B){D.setTweakerValue(C.value);E.onPostEdit()}})};s.prototype.setValue=function(C){var B=this._view;if(!B){return}if(C===undefined||C===null){B.value=undefined}else{B.value=C}};s.prototype.setPossibleValues=function(B){if(this._view){this._view.elementsList=B.map(function(C){return(typeof C==="string")?C:{labelItem:C.value,iconItem:C.icon}})}};s.prototype.setUsageDescription=function(B){if(!this._view){return}this._view.placeholder=B};s.prototype.setAllowResetToUndefinedByUIFlag=function(B){if(!this._view){return}this._view.reachablePlaceholderFlag=B};var f=function(C,B){i.call(this,C,B)};c.applyMixin(f,i);f.prototype.buildView=function(){this._view=h.createElement("div",{"class":"wux-ui-icon"});this.setValue(this._tweaker.value)};f.prototype.setValue=function(D,C){var B=this._view;if(!B){return}if((D&&!C)||(D&&C&&D.iconName&&C.iconName&&D.iconName!==C.iconName)||(D&&C&&!D.iconName&&!C.iconName&&D!==C)){this._view.className="";this._view.addClassName("wux-ui-icon");u.generateIcon(D,{target:B})}};var b=function(C,B){i.call(this,C,B)};c.applyMixin(b,i);b.prototype.buildView=function(){var B=this._options.viewOptions||{};B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;this._view=new a(B);this.setPossibleValues(this._tweaker.possibleValues);this.setValue(this._tweaker.value)};b.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;u.addEventOnElement(D,B,"change",function(E){E.stopPropagation();C.setTweakerValue(B.value[0])})};b.prototype.setPossibleValues=function(F){var H=this._tweaker;var D=this._view;if(!D||!H||!F){return}var C=D.getButtonCount();for(var B=0;B<C;B++){var E=D.getButton(0);D.removeChild(E);E.destroy()}if(F&&Array.isArray(F)){F.forEach(function(I){if(typeof I==="string"){D.addChild(new n({type:"radio",label:I,value:I}))}else{I.type="radio";D.addChild(new n(I))}})}else{if(typeof F==="object"){for(var G in F){if(typeof G==="string"){D.addChild(new n({type:"radio",label:G,value:G}))}else{G.type="radio";D.addChild(new n(G))}}}}};b.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}B.value=[C]};var q=function(C,B){i.call(this,C,B)};c.applyMixin(q,i);q.prototype.buildView=function(){var B=this._options.viewOptions||{};B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;this._view=new A(B);this.setValue(this._tweaker.value)};q.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;u.addEventOnElement(D,B,"show",function(E){E.stopPropagation();D.onShow()});u.addEventOnElement(D,B,"hide",function(E){E.stopPropagation();D.onHide()});u.addEventOnElement(D,B,"keydown",function(E){if(E.keyCode===p.ESCAPE){D.onCancelEdit()}});u.addEventOnElement(D,B,"liveChange",function(E){E.stopPropagation();D.onPreEdit();C.setTweakerValue(B.value)});u.addEventOnElement(D,B,"change",function(E){E.stopPropagation();C.setTweakerValue(B.value);D.onPostEdit()})};q.prototype.setValue=function(C){var E=this._tweaker;var B=this._view;if(!B||!E){return}var D=C;if(E.readOnly){if(E.escapeHTML&&C){D=h.String.escapeHTML(this.value);E._properties.value.value=D}}B.value=d(this.valueType,D)};var e=function(C,B){i.call(this,C,B)};c.applyMixin(e,i);e.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-color-square");this.setValue(this._tweaker.value)};e.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.style.backgroundColor="";this._tweaker.elements.container.removeClassName("wux-tweakers-color-square")}};e.prototype.setValue=function(B){var C=this._tweaker;if(!C){return}this._tweaker.elements.container.style.backgroundColor="#"+B};e.prototype.setTouchMode=function(B){};var o={Base:i,LineEditor:y,ComboBox:s,Icon:f,ButtonGroup:b,ColorPicker:q,ColorSquare:e,Editor:k,LineEditorDotsEditor:l,StringDotsEditor:x};return o});define("DS/Tweakers/TweakerURLObject",["UWA/Core","DS/Tweakers/TweakerBase","DS/Tweakers/StringViewModules","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/LineEditor","DS/Controls/Button","DS/Utilities/Dom","DS/Core/PointerEvents"],function(f,m,c,h,j,d,i,a,g){var n=m.inherit({name:"TweakerURLObject",publishedProperties:{value:{defaultValue:undefined,type:"object"},displayStyle:{defaultValue:"clickableLabel",type:"string"},hyperlinkTarget:{defaultValue:"_blank",type:"string"}},getStringFromValue:function(o){return o?o.label:""},_applyHyperlinkTarget:function(){if(this.elements._viewModule&&this.elements._viewModule.setHyperLinkTarget){this.elements._viewModule.setHyperLinkTarget(this.hyperLinkTarget)}}});var l=function(p,o){m.prototype.baseViewModule.call(this,p,o)};j.applyMixin(l,m.prototype.baseViewModule);var e=function(p,o){c.LineEditor.call(this,p,o)};j.applyMixin(e,c.LineEditor);e.prototype.setValue=function(p){var q=this._tweaker;var o=this._view;if(!o||!q){return}o.value=p?p.label:""};e.prototype.setTweakerValue=function(p){if(this._tweaker){var o=f.clone(this._tweaker.value,false);o.label=p;m.prototype.baseViewModule.prototype.setTweakerValue.call(this,o)}};var b=function(p,o){l.call(this,p,o)};j.applyMixin(b,l);b.prototype.buildView=function(){if(!this._tweaker.elements.container){return}this._view=[];this._tweaker.getContent().addClassName("wux-tweakers-urlobject");this._labelDiv=f.createElement("a",{"class":"wux-tweakers-string-label"});this._iconDiv=f.createElement("span",{"class":"wux-tweakers-string-icon"});this._view.push(this._iconDiv);this._view.push(this._labelDiv);this.setTouchMode(this._tweaker.touchMode);this.setValue(this._tweaker.value);this.setHyperLinkTarget(this._tweaker.hyperlinkTarget)};b.prototype.handleEvents=function(){var o=this._tweaker;h.addEventOnElement(this,this._labelDiv,g.POINTERHIT,function(s){if(!o.value||!o.value.func){return}if(typeof o.value.func==="function"){o.value.func({context:o.context})}else{if(o.value.module){var p=o.value.module;var r=o.value.func;var q=o.value.argument;if(!q){q={}}q.context=o.context;require([p],function(t){if(t){var u=t[r];if(u&&typeof u==="function"){u(q)}}})}}})};b.prototype.setValue=function(t){if(!this._view||!this._tweaker){return}var s=this._tweaker.value;var p=s?s.url:undefined;var r=s?s.parameters:undefined;var o=s?s.label:undefined;var q=s?s.icon:undefined;if(p){this._labelDiv.href=p+(r?r:"");if(s.target&&s.target!==this._tweaker.hyperlinkTarget){this._tweaker.hyperlinkTarget=s.target}}else{this._labelDiv.href="javascript:;";this._tweaker.hyperlinkTarget="_self"}this._labelDiv.textContent=o;if(q){h.generateIcon(q,{target:this._iconDiv});this._iconDiv.show()}else{this._iconDiv.hide()}this.updateReferenceValueLabel()};b.prototype.setTouchMode=function(p,o){if(!this._view){return}this._view.touchMode=p};b.prototype.setHyperLinkTarget=function(p,o){if(!this._view){return}if(p!==o){this._labelDiv.setAttribute("target",p)}};b.prototype.usesReferenceValueLabel=function(){return true};var k=function(p,o){l.call(this,p,o)};j.applyMixin(k,l);k.prototype.buildView=function(){var p=this;if(!this._tweaker.elements.container){return}var o=this._options.viewOptions||{};o.escapeHTML=this._tweaker.escapeHTML;o.touchMode=this._tweaker._getCurrentTouchMode();o.disabled=this._tweaker.readOnly;o.selectAllOnFocus=true;o.fireOnlyFromUIInteractionFlag=true;o.autoCommitFlag=true;o.displayClearFieldButtonFlag=true;this._view=[];this._tweaker.getContent().addClassName("wux-tweakers-urlobject");this._view._lineEditor=new d(o);this._view._lineEditor.getContent().addClassName("wux-tweakers-urlobject-editor");this._view.push(this._view._lineEditor);this._view._editBtn=new i({label:"..."});this._view._editBtn.getContent().addClassName("wux-tweakers-urlobject-button");this._view.push(this._view._editBtn);this._view._giveFocus=function(){p._view._lineEditor._giveFocus()};this.setTouchMode(this._tweaker.touchMode);this.setValue(this._tweaker.value)};k.prototype.handleEvents=function(){var o=this._view;var r=this._tweaker;var q=this;var p=q._view._lineEditor;o._editBtn.onClick=function(w){var t=function(x,z,y){require([x],function(B){if(B){var C=B[z];if(C&&typeof C==="function"){var A=y;if(!A){A={}}A.context=q._tweaker.context;C(A)}}})};if(q._tweaker.value&&typeof q._tweaker.value==="function"){q._tweaker.value({context:q._tweaker.context})}else{if(q._tweaker.value&&q._tweaker.value.module){var s=q._tweaker.value.module;var v=q._tweaker.value.func;var u=q._tweaker.value.argument;if(!u){u={}}u.context=q._tweaker.context;t(s,v,u)}}};this._view=p;c.LineEditor.prototype.handleEvents.call(this);this._view=o;this._view._giveFocus=function(){q._view._lineEditor._giveFocus()}};k.prototype.setValue=function(q,o){if(!this._view||!this._tweaker){return}var p=this._tweaker.value;this._view._lineEditor.value=p?p.label:undefined;this.updateReferenceValueLabel()};k.prototype.setTweakerValue=function(p){if(this._tweaker){var o=f.clone(this._tweaker.value,false);if(o===undefined){o={}}o.label=p;m.prototype.baseViewModule.prototype.setTweakerValue.call(this,o)}};k.prototype.setTouchMode=function(p,o){if(!this._view){return}this._view.touchMode=p};k.prototype.usesReferenceValueLabel=function(){return true};n.prototype.baseViewModule=l;n.prototype.VIEW_MODULES={clickableLabel:{classObject:e},clickableLabel_readOnly:{classObject:b,options:{viewOptions:{displayStyle:"clickableLabel"}}},searchableLink:{classObject:k},searchableLink_readOnly:{classObject:b,options:{viewOptions:{displayStyle:"searchableLink"}}}};n.prototype.registerViewModule=function(o,p){return;if(!o||!p||!p.classObject&&!p.classPath){return}if(n.prototype.VIEW_MODULES[o]!==undefined){return}n.prototype.VIEW_MODULES[o]=p};return n});define("DS/Tweakers/TweakerString",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Tweakers/StringViewModules","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils"],function(e,f,a,j,c,d,l,i){function k(m,n){switch(m){case"integer":return parseInt(n,10);case"number":return parseFloat(n);case"boolean":return(/true/i.exec(n)!==null||n==="1");case"string":return n?n.toString():"";case"object":return JSON.parse(n);default:return n}}function h(m,n){if(n===undefined||n===null||typeof(n)==="string"){return n}else{if(f.equalsToNaN(n)){return undefined}else{if(typeof(n)==="object"&&!(n instanceof Array)&&!(n instanceof Date)){if(n.iconName!==undefined&&n.fontIconFamily!==undefined){return n}else{return JSON.stringify(n)}}else{return String(n)}}}}function b(m){return d.getWebappsBaseUrl()+m}var g=j.inherit({name:"TweakerString",publishedProperties:{displayStyle:{defaultValue:"lineEditor",type:"string"},value:{defaultValue:"",type:"string",advancedSetter:true,recordFlag:true},valueType:{defaultValue:"string",type:"string"}},_upgradeValue:function(m){if(typeof(m)!=="string"){return h(this.valueType,m)}else{if(this.escapeHTML){return e.String.escapeHTML(m)}}return m}});g.prototype.baseViewModule=c.Base;g.prototype.VIEW_MODULES={lineEditor:{classObject:c.LineEditor},password:{classObject:c.LineEditor,options:{viewOptions:{displayStyle:"password"}}},password_readOnly:{classObject:c.LineEditor,options:{viewOptions:{displayStyle:"password"}}},link:{classObject:c.LineEditor},link_readOnly:{classObject:j.prototype.VIEW_MODULES.readOnly.classObject,options:{hyperlink:1}},combo:{classObject:c.ComboBox,options:{viewOptions:{enableSearchFlag:false,actionOnClickFlag:false}}},icon:{classObject:c.Icon},icon_readOnly:{classObject:c.Icon},buttonGroup:{classObject:c.ButtonGroup},buttonGroup_readOnly:{classObject:c.ButtonGroup},color:{classObject:c.ColorPicker},color_readOnly:{classObject:c.ColorSquare},editor_readOnly:{classObject:j.prototype.VIEW_MODULES.readOnly.classObject,options:{wrap:1}},editor:{classObject:c.Editor},editorInline:{classObject:c.LineEditorDotsEditor},editorInline_readOnly:{classObject:c.StringDotsEditor}};g.prototype.registerViewModule=function(m,n){return;if(!m||!n||!n.classObject&&!n.classPath){return}if(g.prototype.VIEW_MODULES[m]!==undefined){return}g.prototype.VIEW_MODULES[m]=n};return g});define("DS/Tweakers/TweakerColor",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerString","DS/Controls/ColorPicker","DS/Controls/ColorChooser","DS/Controls/ColorCanvas","DS/Utilities/KeyboardUtils","DS/Utilities/Dom"],function(g,i,k,l,b,e,o,c){var d=k.inherit({name:"TweakerColor",publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true},valueType:{defaultValue:"color",type:"string"},displayStyle:{defaultValue:"inline",type:"string"}},_upgradeValue:function(p){var q=p;if(q){q=q.toString();q=q.charAt(0)==="#"?q.substring(1,q.length):q}return this._parent(q)}});var n=function(q,p){k.prototype.baseViewModule.call(this,q,p)};n.prototype.computeTweakerContentLength=function(){return this._getCurrentTouchMode()?38:22};i.applyMixin(n,k.prototype.baseViewModule);var h=function(q,p){n.call(this,q,p)};i.applyMixin(h,n);h.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-color-square");this.setValue(this._tweaker.value)};h.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.style.backgroundColor="";this._tweaker.elements.container.removeClassName("wux-tweakers-color-square")}};h.prototype.setValue=function(p){var q=this._tweaker;if(!q){return}if(typeof p==="string"&&p.charAt(0)==="#"){p=p.substr(1)}q.elements.container.style.backgroundColor="#"+p};h.prototype.setTouchMode=function(p){};var j=function(q,p){n.call(this,q,p)};i.applyMixin(j,n);j.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new l(p)};j.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}n.prototype.destroy.call(this)};j.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;p.elements._colorChooser.addEventListener("beginEdit",function(s){s.stopPropagation()});p.elements._colorChooser.elements._slider.addEventListener("beginEdit",function(s){s.stopPropagation()});p.addEventListener("show",function(s){s.stopPropagation();r.onShow()});p.addEventListener("hide",function(s){s.stopPropagation();r.onHide(s.options)});p.addEventListener("change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});p.addEventListener("liveChange",function(s){s.stopPropagation();q.setTweakerValue(p.value)});c.addEventOnElement(this,p,"keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit()}})};j.prototype.setValue=function(q){var p=this._view;if(!p){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q};var m=function(q,p){n.call(this,q,p)};i.applyMixin(m,n);m.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new b(p);if(this._tweaker.value!==this._view.value){this._tweaker.value=this._view.value}};m.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;p.addEventListener("beginEdit",function(s){s.stopPropagation();r.onPreEdit()});p.addEventListener("endEdit",function(s){s.stopPropagation();r.onPostEdit()});p.addEventListener("change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});p.addEventListener("keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit()}})};m.prototype.setValue=function(q){var r=this._tweaker;var p=this._view;if(!p||!r){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q;if(p.value!==q){r.value=p.value}};var f=function(q,p){n.call(this,q,p)};i.applyMixin(f,n);f.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new e(p)};f.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var p=this._view;p.addEventListener("beginEdit",function q(t){t.stopPropagation();s.onPreEdit()});p.addEventListener("endEdit",function(t){t.stopPropagation();s.onPostEdit()});p.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(p.value)});p.addEventListener("keydown",function(t){if(t.keyCode===o.ESCAPE){s.onCancelEdit()}})};f.prototype.setValue=function(q){var p=this._view;if(!p){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q};var a=function(q,p){n.call(this,q,p)};i.applyMixin(a,n);a.prototype.buildView=function(){this._view=g.createElement("div",{"class":"wux-tweakers-color-colorbar"});var p=this._options.viewOptions||{};p.handleEditionCancel=false;this._colorPickerVM=new j(this._tweaker,p);this._colorPickerVM._view.inject(this._view);this._colorCanvasVM=new f(this._tweaker,p);this._colorCanvasVM._view.inject(this._view)};a.prototype.handleEvents=function(){var p=this;var q=this._tweaker;q.addEventListener("show",function(r){p._colorCanvasVM._view.elements._pickerCursor.hide()});q.addEventListener("hide",function(r){p._colorCanvasVM._view.elements._pickerCursor.show()})};a.prototype.setValue=function(q){var r=this._tweaker;var p=this._view;if(!p||!r){return}r.disableEvents();var s=false;this._colorPickerVM.setValue(q);s=s||this._colorPickerVM._updateFromView;this._colorCanvasVM.setValue(q);s=s||this._colorCanvasVM._updateFromView;r.enableEvents()};a.prototype.setTouchMode=function(p){this._colorCanvasVM.setTouchMode(p);this._colorPickerVM.setTouchMode(p)};a.prototype.destroy=function(){this._colorPickerVM.destroy();this._colorCanvasVM.destroy();n.prototype.destroy.call(this)};d.prototype.baseViewModule=n;d.prototype.VIEW_MODULES={readOnly:{classObject:h},inline:{classObject:j},std_readOnly:{classObject:h},std:{classObject:m},colorBar_readOnly:{classObject:h},colorBar:{classObject:a},canvas:{classObject:f}};d.prototype.registerViewModule=function(p,q){return;if(!p||!q||!q.classObject&&!q.classPath){return}if(d.prototype.VIEW_MODULES[p]!==undefined){return}d.prototype.VIEW_MODULES[p]=q};return d});define("DS/Tweakers/TweakerBlob",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerString","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils","DS/Controls/Button"],function(c,f,l,h,a,m,j,e){var g="No name";var i=l.inherit({name:"tweakerBlob",publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},blob:{defaultValue:undefined,type:"object",category:"Model"},displayStyle:{defaultValue:"label",type:"string",category:"Appearance"},augmentedDisplay:{defaultValue:undefined,type:"string",category:"Appearance"},},_applyPlaceholder:function(){if(this.elements._viewModule){this.elements._viewModule.setPlaceholder(this.placeholder)}},_applyBlob:function(){var o=this;if(o.blob){var n=new FileReader();n.onloadend=function(p){if(o.value!==p.target.result){o.value=p.target.result}};n.readAsDataURL(o.blob)}if(this.elements._viewModule){this.elements._viewModule.setBlob(this.blob)}},_applyValue:function(){this.blob=this._dataURLtoBlob(this.value);this.onChange()},_applyDisabled:function(n){this._parent();if(this.elements._viewModule&&this.elements._viewModule.setDisabled){this.elements._viewModule.setDisabled(this.disabled)}},_dataURLtoBlob:function(r){if(!r){return}var o=r.split(",");var t=o[0].match(/:(.*?);/);if(!t||t.length<2){return}var q=o[0].match(/:(.*?);/)[1];var p=atob(o[1]),u=p.length,s=new Uint8Array(u);while(u--){s[u]=p.charCodeAt(u)}return new Blob([s],{type:q})}});var b=function(o,n){l.prototype.baseViewModule.call(this,o,n)};f.applyMixin(b,l.prototype.baseViewModule);b.prototype.setBlob=function(){};b.prototype.setBlobName=function(){};b.prototype.setDisabled=function(){};b.prototype.setPlaceholder=function(){};var d=function(o,n){this._inlinedView=undefined;b.call(this,o,n)};f.applyMixin(d,b);d.prototype.buildView=function(){var q=this;var r=q._tweaker;var p=r._getCurrentTouchMode();r.elements.container.addClassName("wux-tweakers-blob");var o=c.createElement("div",{"class":"wux-tweakers-blob-main"});q._inlinedView=c.createElement("div",{"class":"wux-tweakers-blob-inlinedView"});if(p===true){q._inlinedView.setAttributeNode(document.createAttribute("touch-mode"))}else{q._inlinedView.removeAttribute("touch-mode")}q._inlinedView._spanText=document.createElement("span");q._inlinedView._spanText.className="wux-tweakers-blob-span-text wux-tweakers-blob-span-text-placeholder";q._inlinedView._spanText.textContent=r.placeholder;q._inlinedView.appendChild(q._inlinedView._spanText);q._inlinedView._placeholderDnD=document.createElement("div");q._inlinedView._placeholderDnD.className="wux-tweakers-blob-draggable-div";q._inlinedView._placeholderDnD.style.display="none";q._inlinedView.appendChild(q._inlinedView._placeholderDnD);var n=document.createElement("span");n.className="wux-ui-3ds wux-ui-3ds-doc-add wux-ui-3ds-lg wux-tweakers-blob-span";q._inlinedView._placeholderDnD.appendChild(n);q._inlinedView.inject(o);q._editBtn=new e({showLabelFlag:false,icon:{iconName:"upload",iconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},touchMode:p});q._editBtn.getContent().addClassName("wux-tweakers-multirep-button");q._editBtn.inject(o);q._editBtn._blobFinderInput=document.createElement("input");q._editBtn._blobFinderInput.type="file";q._editBtn._blobFinderInput.className="wux-tweakers-blobFinder-input";q._editBtn.getContent().appendChild(q._editBtn._blobFinderInput);q._editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor");q._view=o;q.setBlob(this._tweaker.blob)};d.prototype.handleEvents=function(){var p=this;var q=p._tweaker;var n=p._view;function o(t){t.stopPropagation();var s;if(t.dataTransfer){t.preventDefault();s=t.dataTransfer.files[0];q._blobName=t.dataTransfer.files[0].name;p._inlinedView.removeClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="none"}else{if(p._editBtn._blobFinderInput.files&&p._editBtn._blobFinderInput.files.length){s=p._editBtn._blobFinderInput.files[0];q._blobName=p._editBtn._blobFinderInput.files[0].name}else{}}var r=new FileReader();r.onloadend=function(u){if((q.value!==u.target.result)||(!u.target.result)){p.setTweakerValue(u.target.result);p.setBlob(q.blob)}else{p.setBlob(q.blob)}};if(s){r.readAsDataURL(s)}}p._editBtn._blobFinderInput.addEventListener("change",o);n.addEventListener("dragover",function(r){r.preventDefault();p._inlinedView.addClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="block"});n.addEventListener("drop",o);n.addEventListener("dragleave",function(r){r.preventDefault();p._inlinedView.removeClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="none"})};d.prototype.setPlaceholder=function(n){if(!this._view){return}if(this._inlinedView&&this._inlinedView._spanText&&!this.blob){this._inlinedView._spanText.textContent=n}};d.prototype.setBlob=function(n){if(!this._view){return}if(this._tweaker.value&&this._tweaker.blob&&!this._tweaker._blobName){this._tweaker._blobName=g}else{if(!this._tweaker.value&&!this._tweaker.blob){this._tweaker._blobName=this._tweaker.placeholder;this._editBtn._blobFinderInput.value=""}}if(this._inlinedView&&this._inlinedView._spanText){this._inlinedView._spanText.textContent=this._tweaker._blobName;this._inlinedView._spanText.className="wux-tweakers-blob-span-text"}};d.prototype.setTouchMode=function(n){if(!this._view){return}if(n===true){this._inlinedView.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedView.removeAttribute("touch-mode")}this._editBtn.touchMode=n};d.prototype.setDisabled=function(n){if(!this._view){return}if(n===true){this._inlinedView.setAttributeNode(document.createAttribute("disabled"));if(this._inlinedView.getAttributeNode("focused")){this._inlinedView.removeAttribute("focused")}}else{this._inlinedView.removeAttribute("disabled")}this._editBtn.disabled=n;if(n){this._view.style.pointerEvents="none"}else{this._view.style.pointerEvents="auto"}};d.prototype.destroy=function(){this._tweaker.elements.container.removeClassName("wux-tweakers-blob");if(this._inlinedView){this._inlinedView.remove();this._inlinedView.destroy()}if(this._editBtn){this._editBtn.remove();this._editBtn.destroy()}b.prototype.destroy.call(this)};var k=function(o,n){b.call(this,o,n)};f.applyMixin(k,b);k.prototype.buildView=function(){var o=this;var p=o._tweaker;var n=p.elements.container;n.addClassName("wux-tweakers-string-label");if(p.value&&!p._blobName){p._blobName=g}if(p._blobName){n.textContent=p._blobName}};k.prototype.setBlob=function(p){var o=this;var q=o._tweaker;var n=q.elements.container;if(this._tweaker.blob&&!this._tweaker._blobName){this._tweaker._blobName=g}else{if(!this._tweaker.value&&!this._tweaker.blob){this._tweaker._blobName=this._tweaker.placeholder}}n.textContent=q._blobName};k.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.textContent="";this._tweaker.elements.container.removeClassName("wux-tweakers-string-label")}b.prototype.destroy.call(this)};i.prototype.baseViewModule=b;i.prototype.VIEW_MODULES={readOnly:{classObject:k},label:{classObject:d}};i.prototype.registerViewModule=function(n,o){return;if(!n||!o||!o.classObject&&!o.classPath){return}if(i.prototype.VIEW_MODULES[n]!==undefined){return}i.prototype.VIEW_MODULES[n]=o};return i});define("DS/Tweakers/TweakerMultiRep",["UWA/Core","DS/Core/PointerEvents","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerString","DS/Controls/Button","DS/Windows/Dialog","DS/Controls/Popup"],function(c,d,j,i,e,h,a){var b=j.inherit({name:"TweakerMultiRep",editor:undefined,publishedProperties:{displayStyle:{defaultValue:"inline",type:"string"},liveChangeFlag:{defaultValue:false,type:"boolean"}},_preEditValue:function(k,l){return true},_postBuildView:function(){switch(this.displayStyle){case"inline":this._buildInlineEditor();break;case"std":this._buildStdEditor();break}if(this._preEditValue(null,this.value)){this._applyValue(this.value)}this._applyReadOnly()},_applyValue:function(k){switch(this.displayStyle){case"inline":this._applyValueInline(k);if(this.editor&&!c.equals(this.value,this.editor.value)){if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{if(typeof this.value!=="undefined"&&this.value!==null){this.editor.value=this.value}}}break;case"std":this._applyValueStd(k);break}if(this.readOnly){if(this.value&&this.value.length>0){if(this.elements.editBtn){this.elements.editBtn.visibleFlag=true}}}},_applyValueInline:function(){},_applyTouchMode:function(){if(this.elements.editBtn){this.elements.editBtn.touchMode=this.touchMode}if(this.internalTweakerString){this.internalTweakerString.touchMode=this.touchMode}},_applyDialogOptions:function(){if(this._dialog){this._dialog.title=this.dialogOptions.title;this._dialog.icon=this.dialogOptions.icon;this._dialog.width=this.dialogOptions.width;this._dialog.height=this.dialogOptions.height;var l=f.call(this,this.getContent());var k=l&&l.modalFlag;if(k){this.dialogOptions.modalFlag=true}this._dialog.modalFlag=this.dialogOptions.modalFlag}},_applyValueStd:function(k){if(this.elements.internalView){this.elements.internalView.value=this.value}},_applyReadOnly:function(){switch(this.displayStyle){case"inline":if(this.internalTweakerString){this.internalTweakerString.readOnly=this.readOnly;if(!this.readOnly&&this.elements.editBtn){this.elements.editBtn.visibleFlag=true;this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor")}else{if(this.readOnly&&this.elements.editBtn){if(this.value===undefined||this.value===null||(this.value&&this.value.length===0)){this.elements.editBtn.visibleFlag=false}this.elements.editBtn.getContent().removeClassName("wux-tweakers-multirep-button-line-editor")}}}if(this.editor){this.editor.readOnly=this.readOnly}break;case"std":this._parent();break}},_buildInlineEditor:function(){var k=this;if(this.elements.internalView){this.elements.internalView.remove()}this.elements.internalView=c.createElement("div");this.elements.internalView.addClassName("wux-tweakers-multirep wux-tweakers-multirep-inline-editor");this.internalTweakerString=new i({readOnly:this.readOnly});this.internalTweakerString.inject(this.elements.internalView);this.elements.internalView.inject(this.elements.container);this.internalTweakerString.getContent().addClassName("wux-tweakers-multirep-tweakerstring");this.internalTweakerString.getContent().addEventListener("change",function(l){l.stopPropagation();if(k._dialog&&k._dialog.visibleFlag){return}if(k.editor&&k.editor._changeOptions){k._changeOptions=k.editor._changeOptions}k._processValueFromString(k.internalTweakerString.value);if(k._preEditValue(null,k.value)){k._applyValue(k.value);if(k._popup&&k._popup.visibleFlag){if(k.internalTweakerString.value!=="[]"&&JSON.stringify(k._changeOptions)!==k.internalTweakerString.value){k.fire("liveChange",k._changeOptions)}}else{if(!k._popup||(k._popup&&!k._popup.visibleFlag)){if(k._lockUI){return}k.fire("change",k._changeOptions)}}}});this.elements.editBtn=new e({label:"..."});this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button");if(!this.readOnly){this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor")}this.elements.editBtn.inject(this.elements.internalView);this._applyAugmentedDisplay()},_processValueFromString:function(k){},_processValueFromCopy:function(k){console.log("Override the method _processValueFromCopy of the TweakerMultirep to correctly manage the update of the value");this.value=k},_copyValueForDialog:function(){console.log("Override the method _copyValueForDialog of the TweakerMultirep to correctly manage the update of the value");return this.value},_buildStdEditor:function(){},_buildEditor:function(k){},_buildDialog:function(){var o=this;o.editor=o._buildEditor({displayStyle:"std",value:o._copyValueForDialog(),readOnly:o.readOnly,valueType:o.valueType,liveChangeFlag:o.liveChangeFlag});var q=function(r){o._dialog.visibleFlag=false;if(o.editor){o._dialog.destroy();o._dialog=undefined}o.fire("cancelEdit")};var l=new h({title:o.dialogOptions.title?o.dialogOptions.title:o.editorTitle,icon:o.dialogOptions.icon,content:o.editor,resizableFlag:true,height:o.dialogOptions.height?o.dialogOptions.height:240,width:o.dialogOptions.width?o.dialogOptions.width:200,identifier:o.dialogOptions.identifier?o.dialogOptions.identifier:"",buttons:{Ok:new e({onClick:function(t){var s=o.value;if(o.editor){o._processValueFromCopy(o.editor.value);o._applyValue()}t.dsModel.dialog.visibleFlag=false;s=JSON.stringify(s,function(w,u){return u===undefined?null:u});var r=JSON.stringify(o.editor.value,function(w,u){return u===undefined?null:u});if(s!==r){o.fire("change",o.value)}}}),Cancel:new e({onClick:q})},autoCloseFlag:false});l.addEventListener("close",q);var p=g.call(this,o.getContent());if(p){p.addWindow(l)}else{if(document.body){l.inject(document.body);l.getContent().setStyle("z-index",1000)}}var n=f.call(this,o.getContent());var m=n&&n.modalFlag;if(m){o.dialogOptions.modalFlag=true}l.modalFlag=o.dialogOptions.modalFlag;if(!p){var k=o.getContent().getParent(".wux-controls-popup");if(k){l.getContent().parentElement.setStyle("z-index",parseInt(k.getStyle("zIndex"))+1)}}l.position={at:"center center",my:"center center"},o._dialog=l;if((o.value&&o.value.length===0||!o.value||o.value===null)&&o._placeholderView){o._placeholderView()}else{if(o.elements._placeholder){o.elements._placeholder.style.display="none"}}o._dialog.addEventListener("change",function(r){r.stopPropagation()});return l},_buildPopup:function(n){var m=this;m.editor=m._buildEditor({displayStyle:"std",value:m.value,readOnly:m.readOnly,valueType:m.valueType});if(m.editor){m.editor.addEventListener("change",function(q){q.stopPropagation();m.editorInitialValue=m.editor.value;q.stopPropagation();if(m._popup&&m._popup.visibleFlag){if(m.value!==m.editor.value){m.value=m.editor.value}else{m.fire("liveChange",m.editor._changeOptions)}}else{if(!m._popup||(m._popup&&!m._popup.visibleFlag)){if(m.value!==m.editor.value){m.value=m.editor.value}else{m.fire("change",m.editor._changeOptions)}}}})}var l=this.name?this.name.toLowerCase().replace("tweaker",""):undefined;var p="wux-controls-popup wux-controls-popup-tweaker-multi-rep";if(l){p=p+" wux-controls-popup-tweaker-"+l}var k=new a({target:n,position:"bottom",alignment:"far",className:p});k.getContent().setStyle("height","176px");k.getContent().setStyle("width",m.internalTweakerString.getContent().offsetWidth+m.elements.editBtn.getContent().offsetWidth-parseInt(k.getContent().getStyle("padding-right"))-parseInt(k.getContent().getStyle("padding-left"))+"px");function o(q){if(k.visibleFlag&&!k.isElementInside(q.target)&&(!m.elements.editBtn||!m.elements.editBtn.getContent().contains(q.target))){k.hide();document.body.removeEventListener(d.POINTERDOWN,o)}}k.addEventListener("show",function(q){if(!q.target||q.target.dsModel!==k){return}if(m.value){try{m.initialValue=JSON.parse(JSON.stringify(m.value))}catch(q){m.initialValue=undefined}}m._applyValue();m._applyValueStd();if(m._popup.getBody()){var r=m._popup.getBody().doc;if(r&&m.doc&&r.getChildren()!==m.doc.getChildren()){r=m.doc;if(m.value&&m.value.length===0||!m.value||m.value===null){m._placeholderView.call(m)}else{if(m.elements._placeholder){m.elements._placeholder.style.display="none"}k.setBody(m.editor)}}else{if(!r){if(m.value&&m.value.length===0||!m.value||m.value===null){m._placeholderView()}else{if(m.elements._placeholder){m.elements._placeholder.style.display="none"}k.setBody(m.editor)}}}}document.body.addEventListener(d.POINTERDOWN,o);m.internalTweakerString.getContent().addEventListener("focus",o);if(m.editor&&m.editor._applyDisplayRowIndexes){m.editor._applyDisplayRowIndexes()}});k.addEventListener("hide",function(q){m._applyValueInline();if((m.value&&m.initialValue&&JSON.stringify(m.value)!==JSON.stringify(m.initialValue))||(!m.initialValue&&m.value)){m.fire("change")}});k.setBody(m.editor);return k},_applyDisplayRowIndexes:function(){},_applyAugmentedDisplay:function(k){var l=this;if(this.elements.editBtn){this.elements.editBtn.addEventListener("click",function(m){m.stopPropagation();if(l.editor){l.lastEditor=l.editor}if(l.augmentedDisplay==="dialog"){if(!l._dialog){if(l._popup){l._popup.destroy()}l._dialog=l._buildDialog()}l._dialog.visibleFlag=true}else{if(l._dialog){l._dialog.destroy()}if(!l._popup&&l.elements.editBtn){l._popup=l._buildPopup(l.elements.editBtn);l.elements.editBtn._popup=l._popup}l._popup.getContent().setStyle("width",l.internalTweakerString.getContent().offsetWidth+l.elements.editBtn.getContent().offsetWidth+"px");l._popup._updateView();l._popup.toggle()}})}},_applyProperties:function(k){if(this.isDirty("augmentedDisplay")){this._applyAugmentedDisplay(k.augmentedDisplay)}if(this.isDirty("dialogOptions")){this._applyDialogOptions(k.dialogOptions)}if(this.isDirty("readOnly")){this._applyReadOnly(k.readOnly)}}});function g(l){var m=l.getParent(".wux-windows-immersive-frame");if(m){return m.dsModel}var k=l.getParent(".wux-controls-popup");if(k){return g(k.dsModel.target.getContent())}return null}function f(l){var m=l.getParent(".wux-windows-window");if(m){return m.dsModel}var k=l.getParent(".wux-controls-popup");if(k){return f(k.dsModel.target.getContent())}return null}return b});define("DS/Tweakers/TweakerArray",["UWA/Core","DS/Tweakers/TweakerMultiRep","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/Tree/TreeListView","DS/TreeModel/TreeNodeModel","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/TweakerUtils","DS/Utilities/Dom"],function(c,o,h,r,e,j,p,u,s){var q=5;var w=20;var d=o.inherit({name:"tweakerArray",doc:undefined,publishedProperties:{editorTitle:{defaultValue:"Array Editor",type:"string"},valueType:{defaultValue:"string",type:"string"},value:{defaultValue:[],type:"array",advancedSetter:true},displayRowIndexes:{defaultValue:true,type:"boolean"},itemEditionTrigger:{defaultValue:"double click",type:"string"}},buildView:function(){if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-array")}if(!this.dialogOptions.title){this.dialogOptions.title=this.editorTitle}},_preEditValue:function(x,y){if(typeof y==="undefined"||(c.typeOf(y)==="array"&&y.length===0)||y===null){return true}if(c.typeOf(y)!=="typedarray"&&!t.call(this,this.valueType,y)){return false}return this._parent(x,y)},_convertValueToStringRepresentation:function(){var x=[];for(var y in this.value){if(!this.value.hasOwnProperty(y)){break}x.push(u._getStringRepresentationFromValue(this.valueType,this.value[y]))}return x},_applyValueInline:function(z){var x="";var B=this._convertValueToStringRepresentation();if(this.value&&this.value.length>0){if(typeof this.value==="string"&&this.value.indexOf("[")===0){x=this.value}else{x="[";for(var y in this.value){if(!this.value.hasOwnProperty(y)){break}var A="";if(typeof this.value[y]==="object"){try{A=JSON.stringify(this.value[y])}catch(C){return""}}else{if(typeof this.value[y]==="string"){A=B[y].replace(/\\"/g,'"');A='"'+A.replace(/"/g,'\\"')+'"'}else{if(B){if(typeof B[y]==="string"){A=B[y].replace(/\\"/g,'"');A='"'+A.replace(/"/g,'\\"')+'"'}else{A=B[y]}}else{A=this.value[y]}}}x+=A+","}if(x.slice(-1)===","){x=x.substring(0,x.length-1)}x+="]"}}else{if(typeof this.value==="undefined"||this.value===null){x=""}else{if(this.value&&this.value.length===0){x="[]"}}}if(this.internalTweakerString){if(!(this.internalTweakerString.value==="[]"&&(typeof this.value==="undefined"||this.value===null)&&!z)){this.internalTweakerString.value=x}}if(this.editor&&!c.equals(this.value,this.editor.value)){this.editor._isValueBeingSet=true;if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{this.editor.value=this.value}this.editor._isValueBeingSet=false}this._updateEditorColumnsOption()},_applyValueStd:function(y){var A=this;var x=A.itemEditionTrigger==="in place";this._isValueBeingSet=true;if(!A.doc){A._buildStdEditor()}if(A.doc){A.editor.getManager().prepareUpdateView();if((A.value===undefined||A.value===null||A.value&&A.value.length===0)){A.doc.empty();var B=new j({grid:{data:undefined},inEdition:x});A.doc.addRoot(B)}if(A.value&&A.value.length!==0&&A.value!==y){A.doc.empty();if(Array.isArray(A.value)||c.typeOf(A.value)==="typedarray"){for(var z=0;z<A.value.length;z++){var B=new j({grid:{data:A.value[z]},inEdition:x});A.doc.addRoot(B)}}}else{if(A.value&&A.value.length>0){var C=A.doc._getTrueRoot().getChildren();for(var z=0;z<A.value.length;z++){if(C&&z<C.length&&A.value[z]!==C[z].options.grid.data){C[z].updateOptions({grid:{data:A.value[z]},inEdition:x})}else{if(!C||z>=C.length){var B=new j({grid:{data:A.value[z]},inEdition:x});A.doc.addChild(B)}}}if(C&&C.length>A.value.length){while(A.value.length!==C.length){A.doc.removeRoot(C[A.value.length])}}}}A.editor.getManager().pushUpdateView()}this._isValueBeingSet=false;this._updateEditorColumnsOption()},_applyReadOnly:function(x){switch(this.displayStyle){case"inline":this._parent();break;case"std":this._parent();this._updateEditorColumnsOption();break}},_applyValueType:function(x){if(this.editor){this.editor.valueType=this.valueType}this._updateEditorColumnsOption()},_applyDisplayRowIndexes:function(){if(this.editor){this.editor.getManager().setHeadersDimensions({width:this.displayRowIndexes?(this.editor.getManager().getDocument().getRoots().length-1).toString().length*q+w:undefined,height:0})}},_applyItemEditionTrigger:function(y){var z=this;if(z.doc){var x=z.doc.getAllDescendants();x.forEach(function A(B){var C=z.itemEditionTrigger==="in place";if(B.options.inEdition!==C){B.options.inEdition=C}})}},_handleEvents:function(){var x=this;this.getContent().addEventListener("change",function(y){if(x.internalTweakerString){x._applyValueInline()}})},_applyProperties:function(x){if(this.isDirty("valueType")){this._applyValueType(x.valueType)}if(this.isDirty("displayRowIndexes")){this._applyDisplayRowIndexes()}if(!this._preEditValue(null,this.value)){this.value=[]}this._parent(x)},_updateEditorColumnsOption:function(){if(this.editor&&this.displayStyle==="std"){this.editor.getManager().setColumnOptions("data",{isEditable:!this.readOnly});this.editor.getManager().setColumnOptions("column_action",{isHidden:c.typeOf(this.value)==="typedarray"||this.readOnly});this.editor.getManager().updateView(true)}},_buildInlineEditor:function(){this._parent();this.elements.internalView.addClassName("wux-tweakers-array-inline-editor")},_applyLiveChangeFlag:function(){if(this.editor&&this.liveChangeFlag){u.enableLiveChangeOnTreeListView(this.editor)}},_buildStdEditor:function(){var y=this;var x=30;var z={defaultCellHeight:x,height:"auto",isSortable:false,apiVersion:2,resize:{columns:true},selection:{toggle:false,canMultiSelect:false,unselectAllOnEmptyArea:false},show:{rowHeaders:y.displayRowIndexes,columnHeaders:false},headersDimensions:{width:q+w,height:0},columns:[{dataIndex:"tree",isHidden:true,isEditable:true},{dataIndex:"data",text:"Value",width:"auto",onCellRequest:function(H){if(!H.nodeModel||!H.nodeModel.options){return}var D=H.nodeModel.options;var F=D.grid;var E=F.data;var B=y.valueType;var C=H.cellView.getContent();if(B==="typedarray"){var A=(y.value&&y.value.constructor&&y.value.constructor.name)?y.value.constructor.name.toLocaleLowerCase():"String";B=A.replace("array","")}else{if(B==="auto"){B=c.typeOf(E)}}var G={typePath:B,touchMode:F.touchMode,context:"inlinedTemplate",readOnly:!D.inEdition,onViewCreated:function(I){if(I!==undefined){H.cellView._setReusableContent(I);s.onNodeRendered(I.getContent(),function(){if(D.giveFocus){if(D.inEdition){s._pushUserInteractionContext();I._giveFocus();s._popUserInteractionContext()}else{H.cellView.getGridEngine()._giveFocus(true)}if(H.cellView){if(D.inEdition){H.cellView.getContent().setAttribute("draggable",false)}}}})}}};if(WUX.typeRepFactory!==undefined&&!F._buildFailure){WUX.typeRepFactory.generateView(E,G)}else{WUX.typeRepFactory=new p();WUX.typeRepFactory.onReady=function(){if(!F._buildFailure){WUX.typeRepFactory.generateView(E,G)}}}},onCellChange:function(A){if(A.event&&A.event.dsModel){return A.event.dsModel.value}}},{dataIndex:"column_action",isEditable:false,width:50,text:"",isHidden:c.typeOf(this.value)==="typedarray"||y.readOnly,onCellRequest:function(D){if(!D.isHeader){var B=D.cellView.getContent();var A=new h({icon:"plus",displayStyle:"lite"});A.getContent().addClassName("wux-tweakers-array-add-element");A.getContent().setStyle("margin-right","5");A.getContent().addEvent("click",function(E){g.call(y);i.call(y,D.rowID);E.stopPropagation()});A.visibleFlag=D.nodeModel.isSelected();B.setContent(A);D.btnPlus=A;var C=new h({icon:"minus",displayStyle:"lite"});C.getContent().addClassName("wux-tweakers-array-remove-element");C.getContent().addEvent("click",function(E){v.call(y);i.call(y,D.rowID);E.stopPropagation()});C.visibleFlag=D.nodeModel.isSelected();B.addContent(C);D.btnMinus=C}}}],shouldAcceptDrag:function(B){var A=B&&B.nodeModel?B.nodeModel.options.inEdition:false;return !this.readOnly&&c.typeOf(this.value)!=="typedarray"&&!A}};z.onDragOverCell=function(B,A){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}if(A.dropPosition==="middle"){A.dropPosition="top"}A.manager.setDragOverStateForNode(A.nodeModel,A.dropPosition)};z.onDropCell=function(D,B){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}var C=this.unserializeDragAndDropEvent(D);if(C){var A=C.source.uuid;if(this._uxid!==A){return false}}if(B.dropPosition==="middle"){B.dropPosition="top"}y._cellJustDropped=true;return true};z.onDragEnterBlank=function(B,A){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}return true};z.onDropBlank=function(D,B){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}var C=this.unserializeDragAndDropEvent(D);if(C){var A=C.source.uuid;if(this._uxid!==A){return false}}y._cellJustDropped=true;return true};z.headersDimensions={width:q+w,height:0};y.editor=new e(z);y._applyLiveChangeFlag();s.addEventOnElement(y,y.editor.getManager(),"click",function(A,B){i.call(y,B?B.data.rowID:null);a.call(y,B,A,"click")});s.addEventOnElement(y,y.editor.getManager(),"dblclick",function(A,B){a.call(y,B,"double click")});s.addEventOnElement(y,y.editor.getManager(),"liveChange",function(A,B){l.call(y,B)});y.editor.getManager().addEventListener("mouseover",function(A,B){i.call(y,B?B.data.rowID:null)});y.editor.getContent().addEventListener("mouseleave",function(A){i.call(y)});y.editor.getContent().addEventListener("keyup",function(D){if(D.keyCode===r.DELETE){if(y.doc&&y.doc.getXSO()){var C=y.doc.getXSO().get();var A=C[0]._getRowID();for(var B=0;B<C.length;B++){y.doc.removeRoot(C[B])}y.doc.getAllDescendants()[A].select()}}});y.editor.getContent().addEventListener("keydown",function(D){if(r.previous(D.keyCode)){var A=y.doc.getXSO().get()[0]._getRowID();var B=y.doc.getAllDescendants()[A-1];if(B){y.doc.getXSO().empty();B.select();var F=y.editor.getManager().nodePositionInVisibleViewport(B);if(F<0){y.editor.getManager().scrollToNode(B,"top")}else{if(F>0){y.editor.getManager().scrollToNode(B,"bottom")}else{y.editor.getManager().updateView()}}}}else{if(r.next(D.keyCode)){var A=y.doc.getXSO().get()[0]._getRowID();var B=y.doc.getAllDescendants()[A+1];if(B){y.doc.getXSO().empty();B.select();var F=y.editor.getManager().nodePositionInVisibleViewport(B);if(F<0){y.editor.getManager().scrollToNode(B,"top")}else{if(F>0){y.editor.getManager().scrollToNode(B,"bottom")}else{y.editor.getManager().updateView()}}}}else{if(D.keyCode===r.F2){var C,E=y.doc.getSelectedNodes();if(E.length===0){return}C=E[0];if(y.itemEditionTrigger!=="in place"){if(!C.options.inEdition){b.call(y,C)}else{m.call(y,C,false,true)}}}}}});y.doc=y.editor.getDocument();y.doc.onNodeModelUpdate(function(A){if(!y._isValueBeingSet){f.call(y)}});y.doc.addModelEventListener("addChild",function(A){if(!y._isValueBeingSet){if(!y._cellJustDropped){b.call(y,A.data.nodeModel)}y._cellJustDropped=false;y._applyDisplayRowIndexes();f.call(y)}});y.doc.addModelEventListener("removeChild",function(A){if(!y._isValueBeingSet){y._applyDisplayRowIndexes();f.call(y)}});y.editor.getContent().addClassName("wux-tweakers-array-editor");y.elements.internalView=c.createElement("div",{"class":"wux-tweakers-array-container"});y.editor.inject(y.elements.internalView);y.elements.internalView.inject(y.elements.container)},_buildEditor:function(x){return new d(x)},_processValueFromString:function(C){var A=this;function B(K){var D,G,F,H;function I(){var O,S,T,M,V,Q,P,N,R,U,L;O="";S=1;T=G[0];M=F[T]||",";P=M!==",";N=M==='"';L=T==="{"||T==="[";V=false;while(!V&&S<=G.length){Q=G.indexOf(M,S)+(P?1:0);O=Q>0?G.slice(0,Q):G;if(L){R=(O.match(new RegExp(T==="["?"\\[":T,"g"))||[]).length;U=(O.match(new RegExp(M==="]"?"\\]":M,"g"))||[]).length}if((!L||R===U)&&(O.length===1||!N||O.slice(-2)[0]!==H)){V=true}S=Q}if(S>0){G=G.slice(S+(P?0:1),G.length)}else{G=""}if(G.startsWith(",")){G=G.slice(1)}if(T==='"'&&M==='"'){O=O.slice(1,-1)}O=O.replace(/\\"/g,'"');return O}D=[];F={'"':'"',"{":"}","[":"]"};H="\\";G=K;while(G&&G.length>0){var J=G.length;var E=I();D.push(E);if(J===G.length){throw new Error("The stringified array value cannot be splited")}}return D}this._isValueBeingSet=true;if(typeof C==="string"){if((this.value===undefined&&(C===""||C==="[]"))||(C===""||C==="[]")){if(this.value){this.value.length=0}this._isValueBeingSet=false;return}var z;if(C.indexOf("[")===0){z=B(C.substring(1,C.length-1))}else{z=B(C)}for(var x=0;x<z.length;x++){if(typeof z[x]==="string"){var y=z[x].replace(/\\"/g,'"');z[x]=k.call(this,this.valueType,y,true)}else{z[x]=k.call(this,this.valueType,z[x],true)}}if(!t.call(this,this.valueType,z)){return}if(Array.isArray(z)){this._processValueFromCopy(z)}}this._isValueBeingSet=false},_processValueFromCopy:function(x){if(c.equals(this.value,x)){return}if(x&&x.length!==0){if(!t.call(this,this.valueType,x)){return}}if(typeof this.value==="undefined"||this.value===null){if(x&&x.length>0){this.value=[]}}if(c.typeOf(x)==="typedarray"){if(c.typeOf(this.value)==="typedarray"){if(x.length===this.value.length){for(var y=0;y<x.length;y++){if(this.value[y]!==x[y]){this.value[y]=x[y]}}}}}else{if(Array.isArray(x)){if(c.typeOf(this.value)==="typedarray"){if(x.length===this.value.length){for(var y=0;y<x.length;y++){if(this.value[y]!==x[y]){this.value[y]=x[y]}}}}else{if(x!==undefined&&this.value!==undefined&&this.value!==null){if(c.typeOf(this.value)!=="typedarray"&&c.typeOf(this.value)!=="array"){this.value=[]}for(var y=0;y<x.length;y++){var z=x[y];if(z!==null){if(y<this.value.length&&this.value[y]!==z){this.value[y]=z}else{if(y>=this.value.length){this.value.push(z)}}}}if(this.value.length>x.length){this.value.splice(x.length,this.value.length-x.length)}}}}}},_copyValueForDialog:function(){if(this.value){return this.value.slice()}else{return undefined}},_placeholderView:function(){var y=this;var x=y.itemEditionTrigger==="in place";if(!y.elements._placeholder){y.elements._placeholder=c.createElement("div",{"class":"wux-tweakers-array-placeholder"});var z=c.createElement("span",{"class":"wux-tweakers-array-placeholder-span"}).inject(y.elements._placeholder);z.setContent("Click here to add items");c.createElement("span",{"class":"wux-tweakers-array-placeholder-icon wux-ui-3ds wux-ui-3ds-list-add wux-ui-3ds-3x"}).inject(y.elements._placeholder);y.elements._placeholder.addEventListener("click",function(B){if(!y.doc){y._buildStdEditor()}y.elements._placeholder.style.display="none";y._lockUI=true;y.doc.empty();y._lockUI=false;var A=new j({grid:{data:k.call(y,y.valueType,(y.valueType==="date"?new Date():""))},inEdition:x});y.doc.addRoot(A);if(y._popup){y._popup.setBody(y.editor)}else{if(y._dialog){y._dialog.content=y.editor}}})}if(y._popup){y._popup.setBody(y.elements._placeholder)}else{if(y._dialog){y._dialog.content=y.elements._placeholder}}y.elements._placeholder.style.display="block"}});function i(B){var A=this;function z(E,D){E.btnMinus.visibleFlag=D;E.btnPlus.visibleFlag=D}function x(D,E){return D&&(D===E||D.nodeModel.isSelected())}function y(G){var E,D,F;if(G===null||!isFinite(G)){return null}E=A.editor.getManager();D=E.getCell(G,"column_action");F=D?D.getView():null;return F?F.getCellInfos():null}var C=y(B);if(A._lastSelectedCellInfos&&!x(A._lastSelectedCellInfos,C)){z(A._lastSelectedCellInfos,false);A._lastSelectedCellInfos=null}if(A._lastHoveredCellInfos&&!x(A._lastHoveredCellInfos,C)){z(A._lastHoveredCellInfos,false);A._lastHoveredCellInfos=null}if(C&&C.btnMinus&&C.btnPlus){z(C,true);if(C.nodeModel.isSelected()){A._lastSelectedCellInfos=C}else{A._lastHoveredCellInfos=C}}}function a(y,x){var z;if(!y){m.call(this,this._currentlyInEdition,false,true);return}z=y.nodeModel;if(!this.readOnly&&this.itemEditionTrigger===x&&z){b.call(this,z)}else{if(this._currentlyInEdition&&this._currentlyInEdition!==z&&y.columnID!==2){m.call(this,this._currentlyInEdition,false,true)}}}function m(z,x,y){if(!z){return}z.options.inEdition=x;z.options.giveFocus=y;this._currentlyInEdition=x?z:null;z.notifyModelUpdate();this.editor.getManager().updateView()}function b(x){if(!this.doc){return}if(this._currentlyInEdition&&x===this._currentlyInEdition){return}this.doc.prepareUpdate();if(this._currentlyInEdition){if(this.itemEditionTrigger==="in place"){this._currentlyInEdition=null}else{m.call(this,this._currentlyInEdition,false,false)}}m.call(this,x,true,true);this.doc.unselectAll();x.select();this.doc.pushUpdate()}function f(){var B=this;if(B.doc!==undefined){var x=B.doc.getRoots();var C=[];for(var z=0;z<x.length;z++){var A=x[z];if(A.options.grid.type!=="addItem"){if(typeof A.options.grid.data==="string"){var y=k.call(B,(B.valueType!=="typedarray"?B.valueType:"number"),A.options.grid.data);if(n.call(B,B.valueType,y)){C.push(y)}else{B._applyValue(B.value);return}}else{if(n.call(B,B.valueType,A.options.grid.data)){C.push(A.options.grid.data)}else{C.push(undefined)}}}}if((B._dialog&&B._dialog.visibleFlag)||(B._popup&&B._popup.visibleFlag)){if(!B._lockUI&&C!==undefined&&JSON.stringify(C)!==JSON.stringify(B._changeOptions)){B.fire("liveChange",C);B._changeOptions=C;B.editor.value=C}}if(!B._dialog||B._dialog&&!B._dialog.visibleFlag){B._processValueFromCopy(C);B._applyValue(B.value)}}}function l(E){var C=this;if(E.cellView._reusableContent){if(C.doc!==undefined){var x=C.doc.getRoots();var D=[];for(var A=0;A<x.length;A++){var B=x[A];if(B.options.grid.type!=="addItem"){if(typeof B.options.grid.data==="string"){var y;if(E.nodeModel===B){y=k.call(C,(C.valueType!=="typedarray"?C.valueType:"number"),E.cellView._reusableContent.value)}else{y=k.call(C,(C.valueType!=="typedarray"?C.valueType:"number"),B.options.grid.data)}if(n.call(C,C.valueType,y)){D.push(y)}else{C._applyValue(C.value);return}}else{if((n.call(C,C.valueType,E.cellView._reusableContent.value))||(n.call(C,C.valueType,B.options.grid.data))){var y;if(E.nodeModel===B){D.push(E.cellView._reusableContent.value)}else{D.push(B.options.grid.data)}}else{D.push(undefined)}}}}if(C._dialog&&C._dialog.visibleFlag||C._popup&&C._popup.visibleFlag){var z=C.editor.value;C.editor.value=D;if(JSON.stringify(z)!==JSON.stringify(C.editor.value)){C.fire("liveChange",C.editor.value)}}}}}function g(){var A=this;var B=new j({grid:{data:k.call(A,A.valueType,(A.valueType==="date"?new Date():""))}});var C=A.doc.getSelectedNodes();if(C.length!==0){var z=C[0];var y=z._getLocalID();var x=A.doc.getNthRoot(y+1);A.doc.insertBefore(B,x)}else{var x=A.doc.getNthRoot(0);A.doc.insertBefore(B,x)}A._applyDisplayRowIndexes()}function v(){var z=this;var x=z.doc.getChildren().length;if(x>1){var A=z.doc.getSelectedNodes();var y=0;if(A.length!==0){y=A[0]._getRowID();z.doc.removeRoot(A[0])}else{y=z.doc.getNthRoot(x-1)._getRowID()+1;z.doc.removeRoot(z.doc.getNthRoot(x-1))}}else{if(x==1){var A=z.doc.getSelectedNodes();(A.length!==0)?z.doc.removeRoot(A[0]):z.doc.removeRoot(z.doc.getNthRoot(x-1));z._placeholderView()}}z._applyDisplayRowIndexes()}function t(B,A){if(A){if(A.length>0){for(var z=0;z<A.length;z++){var y=A[z];if(typeof y==="undefined"){return false}var x=n.call(this,B,y);if(!x){return false}}}else{return false}}return true}function n(x,y){if(y===undefined){return true}if(x==="auto"){x=c.typeOf(y)}return u._isFromType(x,y)}function k(y,z,x){switch(y){case"auto":if(c.typeOf(z)==="string"){try{parsedValue=JSON.parse(z);return parsedValue}catch(A){return z}}return z;default:return u._getValueFromString(y,z,x)}}return d});define("DS/Tweakers/TweakerObjectBase",["UWA/Core","DS/Tweakers/TweakerMultiRep","DS/Controls/Button","DS/Tree/TreeListView","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/TreeModel/TreeDocument","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/ModelProxy","DS/Utilities/DocUtils","DS/Utilities/Utils","DS/Controls/TooltipModel","DS/Tweakers/CustomTreeNodeViewTweaker","DS/Tweakers/TweakerUtils"],function(e,d,i,g,f,n,b,c,p,q,j,h,o,m){function l(r){if(r){var s=r.options.grid;var t=!r._isTrueRoot();r.prepareUpdate();r.addChild(new f({label:"Add property to <b>"+(t?s.name:"current object")+"</b>",temporary:true}));if(!r.isExpanded()){r.expand()}r.pushUpdate()}}function a(w){var u=this;if(w){var t=w.getChildren()?w.getLastChild():null;var r=w.options.grid;var s=t&&t.options.temporary;var v=w._isTrueRoot()?u.value:r.data;if(r.type==="object"||typeof v==="object"){if(!s){l(w,{data:v})}}else{if(s){w.prepareUpdate();t.remove();w.pushUpdate()}}}}var k=d.inherit({name:"tweakerObjectBase",doc:undefined,publishedProperties:{editorTitle:{defaultValue:"Object Editor",type:"string",category:"Appearance"},hierarchyCriteria:{defaultValue:"category",type:"string",category:"Behavior"},configuration:{defaultValue:undefined,type:"objet",category:"Behavior"},recursionDepth:{defaultValue:0,type:"integer",category:"Behavior"},permanentReadOnly:{defaultValue:true,type:"boolean",category:"Behavior"},uiOptions:{defaultValue:{height:"inherit",maxHeight:"100%"},type:"object",category:"Appearance"},labelDisplay:{defaultValue:"left",type:"string",category:"Appearance"},failureCapture:{defaultValue:true,type:"boolean",category:"Behavior"},onFailure:{defaultValue:undefined,type:"function",category:"Behavior"},displayMode:{defaultValue:"twoColumns",type:"string",category:"Appearance"},authoringFlag:{defaultValue:false,type:"boolean",category:"Behavior"},authoringFilters:{defaultValue:undefined,type:"object",category:"Behavior"},typeDisplayFlag:{defaultValue:false,type:"boolean",category:"Appearance"}},buildView:function(){if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-object")}if(!this.dialogOptions.title){this.dialogOptions.title=this.editorTitle}},buildPropertyList:function(){return[]},_applyHierarchyCriteria:function(){this._applyValue()},_applyRecursionDepth:function(){this._applyValue()},_applyConfiguration:function(r){if(!this.configuration){this.configuration={}}else{if(!(j.isObjectEmpty(this.configuration)&&!r)){this._applyValue()}}},_applyProperties:function(r){this._parent(r);if(this.isDirty("labelDisplay")){this._applyLabelDisplay()}if(this.isDirty("displayMode")){this._applyDisplayMode()}if(this.isDirty("configuration")){this._applyConfiguration()}this._applyLiveChangeFlag()},_applyValueStd:function(s){function t(v){for(var w=0;w<v.length;w++){var z=v[w];var x=z.name||z;var y=(z.referenceValue!=undefined?z.referenceValue:z.defaultValue);if(y===undefined||y===null){if(z.type){switch(z.type){case"string":y="";break;case"number":y=0;break}}}if(typeof v[w]==="string"){v[w]={name:v[w]}}v[w].data=y;if(v[w].properties){t(v[w].properties)}}}var u=this;if(u.doc&&!u._preventEditorRefresh){u.doc.prepareUpdate();u.doc.empty();var r=u.buildPropertyList();t(r);if(u.hierarchyCriteria){p.modelToTreeDocument.call(u.doc,p.hierarchyFilter.call(r,{criteria:u.hierarchyCriteria}),"hierarchical","name");if(u.hierarchyCriteria!=="flat"){u.doc.expandNLevels({numberOfLevelsToExpand:0})}if(u.authoringFlag){u._applyAuthoringFlag()}}else{p.modelToTreeDocument.call(u.doc,r,"flat","name")}u.doc.pushUpdate()}},_processValueFromString:function(t){try{if(t){var s=JSON.parse(t);if(this.authoringFlag||j.arePrototypesEqual(this.value,s)){this.value=JSON.parse(t)}}}catch(r){this.value=undefined}},_createFlattenedObject:function(u){var r={};var t=this.buildPropertyList(u);for(var s=0;s<t.length;s++){r[t[s].name]=u&&typeof u==="object"?u[t[s].name]:undefined}return r},_copyValueForDialog:function(){if(this.value){return JSON.parse(JSON.stringify(this.value))}else{return undefined}},_buildInlineEditor:function(){this._parent();this.elements.internalView.addClassName("wux-tweakers-object-inline-editor")},onPostUpdateView:function(s){if(this.editor){var r=this.editor.getManager();if(r){return r.onPostUpdateView(s)}}},onPostUpdateViewOnce:function(s){if(this.editor){var r=this.editor.getManager();if(r){return r.onPostUpdateViewOnce(s)}}},_applyValueInline:function(){if(!this.internalTweakerString){this._buildInlineEditor()}if(this.internalTweakerString){try{this.internalTweakerString.value=JSON.stringify(this.value)}catch(r){this.internalTweakerString.value=""}}if(this.editor&&!e.equals(this.value,this.editor.value)){this.editor._isValueBeingSet=true;if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{this.editor.value=this.value}}},_handleEvents:function(){var r=this;this.getContent().addEventListener("liveChange",function(s){if(r._changeOptions){s.options=r._changeOptions}});this.getContent().addEventListener("change",function(s){if(r.internalTweakerString){r._applyValueInline()}if(r._changeOptions){s.options=r._changeOptions}})},_applyLabelDisplay:function(){if(this.editor){if(this.customTreeNodeView){this.customTreeNodeView.labelDisplay=this.authoringFlag?"left":this.labelDisplay}this.editor.getManager().updateView(true)}},_applyLiveChangeFlag:function(){if(this.editor&&this.liveChangeFlag){m.enableLiveChangeOnTreeListView(this.editor)}},_applyTypeDisplayFlag:function(){var s=this;if(!s.editor){return}var r=s.editor.getManager();r.prepareUpdateView();if(s.displayStyle==="std"&&!s.authoringFlag){if(s.typeDisplayFlag){if(this.displayMode==="twoColumns"){r.showColumn("tweakerType");r.setColumnOptions("tree",{width:"30%"});r.setColumnOptions("tweakerType",{width:"10%"});r.setColumnOptions("data",{width:"60%"})}else{if(this.displayMode==="oneColumn"){r.hideColumn("tweakerType");r.setColumnOptions("data",{width:"100%"})}else{}}}else{r.hideColumn("tweakerType");if(this.displayMode==="twoColumns"){r.setColumnOptions("tree",{width:"40%"});r.setColumnOptions("data",{width:"60%"})}else{if(this.displayMode==="oneColumn"){r.setColumnOptions("data",{width:"100%"})}else{}}}}r.pushUpdateView(true)},_applyDisplayMode:function(){function s(u,t){t=t||{};u.setOption("defaultCellHeight",t.cellHeight||38);u.setColumnOptions("tree",{width:t.widthTree||"40%"});u.setColumnOptions("data",{width:t.widthTweaker||"53%"});u._needToIndexRowsPosition()}if(!this.editor){return}var r=this.editor.getManager();r.prepareUpdateView();if(this.displayStyle==="std"){if(this.customTreeNodeView){this.customTreeNodeView.displayMode=this.displayMode}if(this.displayMode==="oneColumn"){s(r,{cellHeight:60,widthTree:"0%",widthTweaker:"100%"});r.hideColumn("tree");r.hideColumn("tweakerType");r.setColumnOptions("data")}else{if(this.typeDisplayFlag&&!this.authoringFlag){s(r,{widthTree:"30%"});r.showColumn("tweakerType")}else{s(r)}r.showColumn("tree")}}r.pushUpdateView(true)},_applyAuthoringFlag:function(){var s=this;if(s.displayStyle!=="inline"){if(!s.editor){return}var r=s.editor.getManager();r.prepareUpdateView();if(s.customTreeNodeView){s.customTreeNodeView.labelDisplay=s.authoringFlag?"left":s.labelDisplay}s.doc.prepareUpdate();if(s.authoringFlag){r.showColumn("remove");r.showColumn("type");r.hideColumn("tweakerType");r.setColumnOptions("data",{width:"25%"});s.doc.getAllDescendants().forEach(function(t){a.call(s,t)});a.call(s,s.doc._getTrueRoot());s._initTypeRepForProp()}else{r.hideColumn("remove");r.hideColumn("type");if(s.typeDisplayFlag&&s.displayMode==="twoColumns"){r.setColumnOptions("tweakerType",{width:"15%"});r.showColumn("tweakerType")}else{if(s.displayMode==="oneColumn"){r.setColumnOptions("data",{width:"100%"})}else{r.setColumnOptions("data",{width:"53%"})}}s.doc.getAllDescendants().forEach(function(t){if(t.options.temporary){t.remove()}})}s.doc.pushUpdate();r.pushUpdateView()}else{if(s.editor){s.editor.authoringFlag=s.authoringFlag}}},_checkAuthoringFilters:function(){if(this.authoringFilters){for(var s in this.authoringFilters){if(this.authoringFilters[s].types){for(var r in this.authoringFilters[s].types){if(!WUX.typeRepFactory.IsRegisterTypeRepresentations(this.authoringFilters[s].types[r])){console.warn("[WEBUX][TweakerObjectBase] The required type representation ("+this.authoringFilters[s].types[r]+") is not registered in the TypeRepresentationFactory. The field will not be added.");delete this.authoringFilters[s].types[r]}}}else{console.warn("[WEBUX][TweakerObjectBase] No type defined for the authoring filter ("+s+").")}}}},_initTypeRepForProp:function(){var r=this;this._filterForProp={};if(this.doc){this.doc.getAllDescendants().forEach(function(t){var D=t.options.grid;WUX.typeRepFactory=new c();var u="filteredType"+D.path;u=u.split(".").join("_");WUX.typeRepFactory.typeEnums.customAllSupportedTypes=undefined;r._checkAuthoringFilters();if(!r.configuration[D.path]||!r.configuration[D.path].authoringFilters){if(r.authoringFilters&&r.authoringFilters.allSupportedTypes){function s(){var L=[];for(var K in r.authoringFilters){if(K==="allSupportedTypes"){for(var J in r.authoringFilters[K].types){L.push(r.authoringFilters[K].types[J])}}}return L.sort(function(N,M){return N.toLowerCase().localeCompare(M.toLowerCase())})}if(r.authoringFilters.allSupportedTypes.defaultType!==undefined){D.defaultType=r.authoringFilters.allSupportedTypes.defaultType}if(r.authoringFilters.allSupportedTypes.defaultValue!==undefined){D.defaultValue=r.authoringFilters.allSupportedTypes.defaultValue}WUX.typeRepFactory.registerEnum("customAllSupportedTypes",s);var I=WUX.typeRepFactory.registerTypeRepresentations({customAllSupportedTypes:{stdTemplate:"enumSearchableCombo"}})}if(r._filterForProp&&!r._filterForProp[u]){var w="allSupportedTypes";if(WUX.typeRepFactory.typeEnums.customAllSupportedTypes!==undefined){w="customAllSupportedTypes"}var H=WUX.typeRepFactory._getTypeData(r.valueType+"."+D.path).realType||"default";var C=D.type?D.type:(r.authoringFilters&&r.authoringFilters.allSupportedTypes&&r.authoringFilters.allSupportedTypes["defaultType"])?r.authoringFilters.allSupportedTypes["defaultType"]:H;WUX.typeRepFactory.generateView(C,{typePath:w,context:"inlinedTemplate",onViewCreated:function(J){if(J!==undefined){r._filterForProp[u]=J}}})}}else{if(r.configuration[D.path]&&r.configuration[D.path].authoringFilters){if(!Array.isArray(r.configuration[D.path].authoringFilters)){r.configuration[D.path].authoringFilters=[r.configuration[D.path].authoringFilters]}var B=0;var G;var A=r.configuration[D.path].authoringFilters[B];G=function s(){var L=[];for(var K in r.authoringFilters){for(B=0;B<r.configuration[D.path].authoringFilters.length;B++){if(K===r.configuration[D.path].authoringFilters[B]){for(var J in r.authoringFilters[K].types){L.push(r.authoringFilters[K].types[J])}}}}return L.sort(function(N,M){return N.toLowerCase().localeCompare(M.toLowerCase())})};WUX.typeRepFactory.registerEnum(u,G);var z={};z[u]={stdTemplate:"enumSearchableCombo"};var I=WUX.typeRepFactory.registerTypeRepresentations(z);if(r._filterForProp&&!r._filterForProp[u]){var E="default";var F;var y=0;if(D.authoringFilters instanceof Array){for(var x=0;x<D.authoringFilters.length;x++){var v=D.authoringFilters[x];if(r.authoringFilters[v].defaultType&&r.authoringFilters[v].defaultTypeWeight){if(r.authoringFilters[v].defaultTypeWeight>y){E=r.authoringFilters[v].defaultType;y=r.authoringFilters[v].defaultTypeWeight;if(r.authoringFilters[v].defaultValue){F=r.authoringFilters[v].defaultValue}}}else{if(r.authoringFilters[v].defaultType&&y===0){E=r.authoringFilters[v].defaultType;if(r.authoringFilters[v].defaultValue){F=r.authoringFilters[v].defaultValue}}}}}else{if(typeof D.authoringFilters==="string"){if(r.authoringFilters[D.authoringFilters].defaultType!==undefined){E=r.authoringFilters[D.authoringFilters].defaultType}if(r.authoringFilters[D.authoringFilters].defaultValue!==undefined){F=r.authoringFilters[D.authoringFilters].defaultValue}}}if(E!=="default"){D.defaultType=E}if(F!==undefined){D.defaultValue=F}WUX.typeRepFactory.generateView(D.type?D.type:E,{typePath:u,context:"inlinedTemplate",onViewCreated:function(J){if(J!==undefined){r._filterForProp[u]=J}}})}}}})}},_buildStdEditor:function(){var t=this;var u=window.location.pathname.indexOf("WUXPortalUI");t._portalTweaker=u>=0;t.doc=new b({shouldAcceptDrag:function(w){return false}});if(!t.configuration){t.configuration={}}t.customTreeNodeView=new o(t);var v=e.clone(this.uiOptions);if(v.height==="auto"){v.height="inherit"}else{if(v.height==="inherit"){v.height="auto"}}var s=e.merge(t.customTreeNodeView.treeOptions,v);s.performances.resizeDebounceTimeout=500;t.editor=new g(s);var r=t.editor.getManager();if(t.liveChangeFlag){m.enableLiveChangeOnTreeListView(t.editor)}r.onNodeClick(function(w){if(w.dataIndex==="tree"&&!t.authoringFlag){var x=w.cellView.getCellInfos().nodeModel;if(x.isExpanded()){x.collapse()}else{x.expand()}}});t.doc.onNodeModelUpdate(function(z){if(z.target){var A=z.target.options.grid.name;var w=z.target.options.grid.path;var C=(z.target.options.grid.data===undefined&&z.target.options.grid.defaultValue!==undefined)?z.target.options.grid.defaultValue:z.target.options.grid.data;if(t.onNodeUpdate){var B=!z.target.getParent();var x=j.getObjectPropertyInfo(t.value,w).value;var y=t.onNodeUpdate(A,w,C,{removed:B});if(t.authoringFlag&&((typeof C==="object"&&x!==C)||(typeof x==="object"&&typeof C!=="object")||(C===undefined))){t._applyValueStd()}else{t.customTreeNodeView.updateNodeParent(z.target,r);t.customTreeNodeView.updateNodeChildren(z.target,r,t.value)}t._changeOptions={propertyChangePath:w,propertyChangeName:A,propertyChangeValue:C}}}});t.editor.getContent().addClassName("wux-tweakers-object-editor-full");t.elements.internalView=e.createElement("div",{"class":"wux-tweakers-object-container-full"});t.editor.inject(t.elements.internalView);t.elements.internalView.inject(t.elements.container);r.setColumnOptions("remove",{dataIndex:"remove",isEditable:false,width:30,text:"Remove",isHidden:true,onCellRequest:function(z){var A=z.nodeModel;var w=A.options.grid;if(!z.isHeader&&!A.options.temporary){var y=z.cellView.getContent();var x=new i({icon:"close",displayStyle:"lite",tooltipInfos:new h({shortHelp:"Remove this property"})});x.getContent().addEvent("click",function(){if(t.value&&w.path){var B=w.path;var E=B.split(".");var F=E[E.length-1];for(var C in t.configuration){if(t.configuration.hasOwnProperty(C)&&C.startsWith(B)){delete t.configuration[C]}}A.prepareUpdate();var D=j.removeObjectProperty(t.value,B);if(D){A.remove()}A.pushUpdate();t.fire("change",{propertyChangeName:F,propertyChangePath:B})}});y.setContent(x);z.removeButton=x}}});r.setColumnOptions("tweakerType",{dataIndex:"tweakerType",isEditable:false,width:"auto",text:"TweakerType",isHidden:true,onCellRequest:function(w){var x=t._getTweakerTypeFromCellInfos(w);w.cellView.getContent().setText(x)}});r.setColumnOptions("data",{dataIndex:"data",text:"Value",isEditable:true,width:"auto",onCellRequest:function(y){if(!y.isHeader&&y.nodeModel&&y.nodeModel.options&&!y.nodeModel.options.temporary){var w=m._setModelViewForDataColumnOneColumnCase(t,y);var x=y.nodeModel.options.grid;if(WUX.typeRepFactory!==undefined&&!x._buildFailure){WUX.typeRepFactory.generateView(w.data,w.generateViewOptions)}else{WUX.typeRepFactory=new c();WUX.typeRepFactory.onReady=function(){WUX.typeRepFactory.generateView(w.data,w.generateViewOptions)}}}},});r.setColumnOptions("type",{dataIndex:"type",isEditable:false,width:"auto",text:"Type",isHidden:true,onCellRequest:function(y){if(!y.isHeader&&!y.nodeModel.options.temporary){if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}var w="filteredType"+y.nodeModel.options.grid.path;w=w.split(".").join("_");if(t._filterForProp&&t._filterForProp[w]){y.cellView.getContent().setContent(t._filterForProp[w])}else{var x="allSupportedTypes";if(WUX.typeRepFactory.typeEnums.customAllSupportedTypes!==undefined){x="customAllSupportedTypes"}WUX.typeRepFactory.generateView(y.nodeModel.options.grid.type||"default",{typePath:x,context:"inlinedTemplate",onViewCreated:function(z){if(z!==undefined){if(t._filterForProp){t._filterForProp[w]=z;y.cellView.getContent().setContent(t._filterForProp[w])}}}})}}},onCellChange:function(w){if(w.event&&w.event.dsModel){return w.event.dsModel.value}},setValue:function(z){var A=z.nodeModel;var x=A.options.grid;if(z.value==="default"||z.value==="defaultRep"||z.value==="uwaObject"){x.type=undefined;if(t.configuration[x.path]){t.configuration[x.path].type=undefined}}else{x.type=z.value;if(!t.configuration[x.path]){t.configuration[x.path]={}}t.configuration[x.path].type=z.value}var w=r.getCell(z.rowID,"data");if(w){var y=w.getView();if(y){y.updateView()}}a.call(t,A)},getValue:function(w){return w.nodeModel.options.grid.type}});r.setColumnOptions("tree",{onCellRequest:function(C){if(!C.isHeader){var B=C.cellView;var D=C.nodeModel;if(D){if(t.editor.options.shouldDisplayTooltip===undefined){B.getContent().setAttribute("title",D.getLabel())}if(t.authoringFlag){var x=B.elements.labelContainer;var z=D.options;var y=z.grid;x.style.display="inline-block";if(!z.temporary){if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}WUX.typeRepFactory.generateView(y.name,{typePath:"string",context:"inlinedTemplate",onViewCreated:function(E){if(E!==undefined){x.setContent(E)}}})}else{var A=new i({icon:"plus",label:z.label,allowUnsafeHTMLLabel:true,displayStyle:"lite",tooltipInfos:new h({shortHelp:"Add a new property"})});A.onClick=function w(){var I=D.getParent();var M=I.options.grid.data;var F=I.options.grid.path||"";var N=(t.authoringFilters&&t.authoringFilters.allSupportedTypes&&t.authoringFilters.allSupportedTypes.defaultType!==undefined)?t.authoringFilters.allSupportedTypes.defaultType:"default";var G=I.options.grid.name||"";if(typeof M!=="object"||M===undefined){if(G.length>0){M={};I.prepareUpdate();I.options.grid.data=M;I.pushUpdate();j.setObjectProperty(t.value,F,M)}else{M=t.value}}if(I&&M!==undefined){var H,E,L,K="NewProp",J=1;if(M.hasOwnProperty(K)){do{L=K+"_"+J;J++}while(M.hasOwnProperty(L));K=L}H=F+(F.length>0?".":"")+K;E=(t.authoringFilters&&t.authoringFilters.allSupportedTypes&&t.authoringFilters.allSupportedTypes.defaultValue!==undefined)?t.authoringFilters.allSupportedTypes.defaultValue:undefined;var O=t.getPropertyDefinition({propPath:H,propName:K,propValue:E});O.data=E;O.type=N;I.prepareUpdate();D.updateOptions({temporary:false,label:K,grid:O});j.addObjectProperty(t.value,H,E);a.call(t,I||t.doc._getTrueRoot());I.pushUpdate();t.fire("change",{propertyChangeName:K,propertyChangePath:H})}};x.setContent(A);C.addButton=A}}else{B.setLabel(D.getLabel())}B.setIcons(D.getIcons());B.setBadges(D.getBadges());B._setExpanderState(D._expandState);B._setDepth(D._nodeDepth);C.cellView.elements.container.setContent(C.cellView.elements.layout)}}},onCellChange:function(C){var x=C.event?C.event.dsModel:null;var y=C.nodeModel.options.grid;if(x){var D=y.path;var B=D.split(".");var z=B[B.length-1];var w=x.value;var A="";if(B.length>1){A+=D.substr(0,D.length-z.length)}A+=w;if(t.value&&w.length>0&&A&&!j.isPropertyInObject(t.value,A)){return{name:w,path:A}}else{x.value=z;return{name:z,path:D}}}return null},setValue:function(D){function z(F){if(F&&!F.options.temporary){if(F.options.grid.path.substr(0,w.length)===w){F.prepareUpdate();F.options.grid.path=A+F.options.grid.path.substr(w.length);F.pushUpdate()}F.getAllDescendants().forEach(function(G){z(G)})}}var x=D.nodeModel;var y=x.options.grid;var C=D.value.name;var A=D.value.path;var w=y.path;if(A!==w){t.doc.prepareUpdate();z(x);for(var E in t.configuration){if(t.configuration.hasOwnProperty(E)&&E.startsWith(w)){var B=A+E.substr(w.length);t.configuration[B]=t.configuration[E];delete t.configuration[E]}}x.prepareUpdate();x.options.label=y.name=C;j.removeObjectProperty(t.value,w);j.addObjectProperty(t.value,A,y.data);t.customTreeNodeView.updateNodeParent(x,r);x.pushUpdate();t.doc.pushUpdate()}}});if(t.authoringFlag){t._applyAuthoringFlag()}t._applyDisplayMode();t._applyTypeDisplayFlag()},_getTweakerTypeFromCellInfos:function(y){var x=this;var z=undefined;var s=y.nodeModel;var v=s.options.grid;var u=v.data;var r="filteredType"+v.path;r=r.split(".").join("_");var t="allSupportedTypes";if(x.authoringFilters&&x.configuration&&x.configuration[v.path]&&x.configuration[v.path].authoringFilters){if(!Array.isArray(x.configuration[v.path].authoringFilters)){x.configuration[v.path].authoringFilters=[x.configuration[v.path].authoringFilters]}if(x.configuration[v.path].authoringFilters[0]){t=x.configuration[v.path].authoringFilters[0]}}if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}var w=WUX.typeRepFactory._getTypeData(x.valueType+"."+v.path).realType;if(x._filterForProp&&x._filterForProp[r]){z=x._filterForProp[r].value}else{if(x.authoringFilters&&x.authoringFilters[t]&&x.authoringFilters[t].defaultType in x.authoringFilters[t]["types"]){z=x.authoringFilters[t].defaultType}else{if(w!==""&&w!==undefined){z=w}else{if(x.configuration&&x.configuration[v.path]){z=x.configuration[v.path].type}else{}}}}if(!z){z=e.typeOf(u)}return z}});return k});define("DS/Tweakers/TweakerWUXAbstract",["UWA/Core","DS/Tweakers/TweakerObjectBase"],function(c,b){var a=b.inherit({name:"tweakerWUXAbstract",doc:undefined,publishedProperties:{},buildView:function(){this._parent()},buildPropertyList:function(){if(this.value){var d=[];for(var f in this.value.publishedProperties){var e=this.value;do{e=Object.getPrototypeOf(e)}while(!e.hasOwnProperty(f));var g=this.value.publishedProperties[f];if(g.uiDisplay!==false){d.push({name:f,className:e.name,referenceValue:this.value[f],defaultValue:g.defaultValue,type:g.type,category:g.category,readOnly:g.readOnly,touchMode:this.value.touchMode})}}return d}else{return[]}},onNodeUpdate:function(f,d,g){if(c.typeOf(this.value[f])==="array"||c.typeOf(this.value[f])==="object"){if(JSON.stringify(this.value[f])!==JSON.stringify(g)){this.value[f]=g;this.fire("change")}else{var e="_apply"+f.substring(0,1).toUpperCase()+f.substring(1,f.length);(this.value[e])?this.value[e]():this.value._applyProperties()}}if(c.equals(this.value[f],g)===false){this.value[f]=g;this.fire("change")}else{if(c.typeOf(this.value[f])==="object"||c.typeOf(this.value[f])==="array"){var e="_apply"+f.substring(0,1).toUpperCase()+f.substring(1,f.length);(this.value[e])?this.value[e]():this.value._applyProperties()}}}});return a});define("DS/Tweakers/TweakerObject",["UWA/Core","DS/Tweakers/TweakerObjectBase","DS/Utilities/Utils","DS/Utilities/Array"],function(d,h,g,i){function c(j){j=j||{};if(this.filter.parameters.displayFunctions){return true}if(this.configuration&&this.configuration[j.propName]&&this.configuration[j.propName].type){return(this.configuration[j.propName].type!=="function")}return typeof(j.propValue)!=="function"}function f(k){k=k||{};for(var j=0;j<this.filter.parameters.exceptions.length;j++){if(this.filter.parameters.exceptions[j]===k.propName){return !k.isAllExcept}}return k.isAllExcept}function b(j){j=j||{};if(new RegExp("^__").test(j.propName)||j.propName==="constructor"){return -1}if(this.configuration&&this.configuration[j.propPath]&&this.configuration[j.propPath].uiDisplay!==undefined){return this.configuration[j.propPath].uiDisplay?1:-1}if(this.filter.parameters.matchingRegexp&&!(new RegExp(this.filter.parameters.matchingRegexp).test(j.propName))){return -1}return 0}function a(m){var j=m;if(typeof m!=="object"||m===null||m===undefined){return false}var l=Object.getPrototypeOf(m);if(!l){return false}var k=Object.getPrototypeOf(l);return !(l&&k&&(l!==k))}var e=h.inherit({name:"tweakerObject",doc:undefined,publishedProperties:{filter:{type:"object",defaultValue:{mode:"standard",parameters:{matchingRegexp:"",displayFunctions:true,displayChainOfPrototypes:false}}}},buildView:function(){this._parent()},_applyFilter:function(){this._applyValue()},buildPropertyList:function(){function m(y,z,w,u){var x=y;do{var v=Object.getOwnPropertyNames(x);v.forEach(function(C){var B=(w&&u)?u+"."+C:C;var A=o._treatProperty({propName:C,propPath:B,propValue:x[C]});if(A&&a(x[C])&&z!==o.recursionDepth){m(x[C],z+1,A,B)}if(w){w.properties=w.properties||[];w.properties=w.properties.concat(A)}else{q=q.concat(A)}if(A&&A.name){l[B]=true}});x=Object.getPrototypeOf(x)}while(j&&x)}var o,q,l,j;o=this;l={};q=[];if(this.value!==undefined&&this.value!==null){if(typeof(this.filter.mode)==="string"){j=true;if(this.filter.mode==="standard"){j=this.filter.parameters.displayChainOfPrototypes}m(this.value,0)}if(typeof(this.filter.mode)==="function"){return this.filter.mode.call(this)}}if(o.configuration&&(this.value===undefined||a(this.value))){var t=d.clone(this.value)||{};for(var s in o.configuration){if(l[s]){break}var r=s.split(".");var k=t;for(var n=0;n<r.length;n++){var p=r[n];if(n<r.length-1){if(k[p]===undefined||k[p]===null||typeof k[p]!=="object"){k[p]={}}}else{k[p]=undefined}k=k[p]}}i.clear(q);m(t,0)}return q},_buildEditor:function(j){this._parent(j);j.value=this._createFlattenedObject(j.value);j.authoringFlag=this.authoringFlag;if(j.authoringFlag){j.readOnly=false}j.recursionDepth=this.recursionDepth;j.configuration=this.configuration;j.typeDisplayFlag=this.typeDisplayFlag;if(this.value===undefined&&j.value!==undefined&&Object.keys(j.value).length!==0){this._lockUI=true;this.value=this._createFlattenedObject(j.value);this._lockUI=false}j.authoringFilters=this.authoringFilters;return new e(j)},_applyProperties:function(j){this._parent(j)},getStringFromValue:function(l){var j="{/n";for(var k in l){j=j+k+": "+l[k]+"/n"}j=j+"}";return j},_treatProperty:function(j){j=j||{};j.propPath=j.propPath||j.propName;j.filterMode=this.filter.mode;if(this.isPropertyValidWithMode(j)){return this.getPropertyDefinition(j)}return[]},isPropertyValidWithMode:function(k){k=k||{};k.propPath=k.propPath||k.propName;var j=b.call(this,k);if(j!==0){return j>0}switch(k.filterMode){case"standard":return c.call(this,k);break;case"noneExcept":k.isAllExcept=false;return f.call(this,k);break;case"allExcept":k.isAllExcept=true;return f.call(this,k);break;default:return[];break}},getPropertyDefinition:function(j){j=j||{};j.propPath=j.propPath||j.propName;var k={name:j.propName,path:j.propPath,referenceValue:j.propValue,touchMode:j.touchMode};if(this.configuration&&this.configuration[j.propPath]){k=d.merge(k,this.configuration[j.propPath])}return k},onNodeUpdate:function(l,j,m,k){if(j!==undefined&&j!==null){this._preventEditorRefresh=true;if(k&&k.removed){g.removeObjectProperty(this.value,j)}else{if(!g.setObjectProperty(this.value,j,m)){if(this.value===undefined){this.value={}}g.addObjectProperty(this.value,j,m)}}this._preventEditorRefresh=false;m=this.value;return m}}});return e});define("DS/Tweakers/TweakerUWAObject",["UWA/Core","DS/Tweakers/TweakerObject"],function(c,a){var b=a.inherit({name:"tweakerUWAObject",doc:undefined,publishedProperties:{},buildView:function(){this._parent()},buildPropertyList:function(){if(this.value!==undefined&&this.value!==null){if(this.filter.mode==="onlyOptions"){return this._treatProperty({propName:"options",propValue:this.value.options})}}return this._parent()},_treatProperty:function(d){d=d||{};if(d.propName==="options"&&typeof(d.propValue)==="object"){var e=[];var g=this;var f=Object.getOwnPropertyNames(d.propValue);f.forEach(function(h){e=e.concat(g._treatProperty({propName:h,propValue:d.propValue[h]}))});return e}else{return this._parent(d)}},isPropertyValidWithMode:function(d){if(d.propName==="defaultOptions"||d.propName==="elements"){return false}if(d.filterMode==="onlyOptions"){d.filterMode="standard";return this._parent(d)}return this._parent(d)},onNodeUpdate:function(e,d,f){if(this.value[e]!==undefined){if(c.equals(this.value[e],f)===false){this.value[e]=f;this.fire("change")}}else{if(c.equals(this.value.options[e],f)===false){this.value.options[e]=f;this.fire("change")}}}});return b});define("DS/Tweakers/TweakerEnum",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase","DS/Controls/ComboBox","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/Controls/Button","DS/Tweakers/TweakerUtils"],function(d,g,o,p,a,m,l,j){var n=o.inherit({name:"tweakerEnum",publishedProperties:{displayStyle:{defaultValue:"combo",type:"string"},valueType:{defaultValue:"enumString",type:"string"}},_buildView:function(){this._viewCreated=false},_postBuildView:function(){this._viewCreated=true;this._applyDisplayStyle();this._parent()},_applyDisplayStyle:function(q){if(this._viewCreated){this._parent(q)}},getStringFromValue:function(q){return i(this.valueType,q,this.possibleValues)}});function k(s,q,t){switch(s){case"enumInteger":return parseInt(q,10);case"number":return parseFloat(q);case"boolean":return(/true/i.exec(q)!==null||q==="1");case"enumString":return q;case"enumCustom":for(var r in t){if(t[r].toString()==q){return t[r]}}break;case"enumValueToProperty":for(var r in t){if(r.toString()==q){return r}}break;case"object":return JSON.parse(q);default:return q}}function i(r,s,t){if(s===undefined){return""}if(r==="object"){return JSON.stringify(s)}else{if((r==="enumInteger"||r==="number")&&((Number.isNan&&Number.isNaN(s)===true)||(isNaN!==undefined&&isNaN(s)===true))){return"NaN"}else{if(r==="enumInteger"||r==="number"||r==="enumString"){return s.toString()}else{if(r==="enumCustom"){for(var q in t){if(q==s){return q}if(t[q]==s){return q}}}else{if(r==="enumValueToProperty"){for(var q in t){if(q==s){return t[q]}}}else{return j._getValueFromString(r,s)}}}}}}var c=function(r,q){o.prototype.baseViewModule.call(this,r,q)};g.applyMixin(c,o.prototype.baseViewModule);var b=function(r,q){this._loadEntriesBinded=e.bind(this);c.call(this,r,q)};g.applyMixin(b,c);b.prototype.buildView=function(){var q=this._options.viewOptions||{};var r=this._tweaker;q.touchMode=r._getCurrentTouchMode();q.disabled=r.readOnly;q.fireOnlyFromUIInteractionFlag=true;q.reachablePlaceholderFlag=r.allowResetToUndefinedByUIFlag;q.placeholder=r.usageDescription;this._view=new p(q);this.setPossibleValues(this._tweaker.possibleValues);this.setValue(this._tweaker.value)};b.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var q=this._view;q.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(k(s.valueType,q.value,s.possibleValues))});q.addEventListener("show",function(t){t.stopPropagation();s.onShow()});q.addEventListener("hide",function(t){t.stopPropagation();s.onHide({cancelFlag:(t.options.cancelPopupSelection?true:false)})});q.addEventListener("preselectionChange",function(u){u.stopPropagation();if(q.preselectedIndex>=0){var t=q._getAllDescendants()[q.preselectedIndex].options.grid.valueItem;if(t===undefined){t=q._getAllDescendants()[q.preselectedIndex].options.label}r.setTweakerValue(k(s.valueType,t,s.possibleValues))}else{r.setTweakerValue(undefined)}});if(s.valueType==="enumDyn"&&typeof s.possibleValues==="function"){q.addEventListener("preDropdown",this._loadEntriesBinded)}};b.prototype.destroy=function(){this._view.removeEventListener("preDropdown",this._loadEntriesBinded);c.prototype.destroy.call(this)};b.prototype.getModifiableOptions=function(){return["enableSearchFlag","mainElementVisibleFlag","expanderIcon"]};b.prototype.setEnableSearchFlag=function(q){if(!this._view){return}this._view.enableSearchFlag=q};b.prototype.setUsageDescription=function(q){if(!this._view){return}this._view.placeholder=q};b.prototype.setAllowResetToUndefinedByUIFlag=function(q){if(!this._view){return}this._view.reachablePlaceholderFlag=q};b.prototype.setMainElementVisibleFlag=function(q){if(!this._view){return}this._view.mainElementVisibleFlag=q};b.prototype.setExpanderIcon=function(q){if(!this._view){return}this._view.expanderIcon=q};b.prototype.setValue=function(u){var v=this._tweaker;var r=this._view;if(typeof v.possibleValues==="function"){this._lockValueUpdate=true;r.elementsList=v.possibleValues.call(v).slice(0)}var q=r.elementsList;if(!q||q.length===0||u===""||u===undefined){r.selectedIndex=-1}else{if(typeof u==="undefined"||u===null){return}var s=u.toString();for(var t=0;t<q.length;t++){if(u===q[t]||u===q[t].valueItem||s===q[t]||s===q[t].valueItem){r.selectedIndex=t;break}}}};b.prototype.setPossibleValues=function(q){if(!this._view){return}this._view.removeEventListener("preDropdown",this._loadEntriesBinded);if(this._tweaker.valueType==="enumDyn"&&typeof q==="function"){this._view.addEventListener("preDropdown",this._loadEntriesBinded)}else{this._view.elementsList=f.call(this)}};function e(){if(this._view){this._view.elementsList=this._tweaker.possibleValues.call(this._tweaker).slice(0)}}function f(){var t=this._tweaker;if(t.possibleValues!==undefined){if(t.valueType==="enumString"){if(d.typeOf(t.possibleValues)==="object"){var u=[];for(var r in t.possibleValues){if(t.possibleValues.hasOwnProperty(r)){u.push({valueItem:t.possibleValues[r],labelItem:r})}}return u}else{if(d.typeOf(t.possibleValues)==="array"){return t.possibleValues.map(function(v){return(typeof v==="string")?v:{labelItem:(typeof v.label==="undefined"?v.value:v.label),valueItem:v.value,iconItem:v.icon}})}}return t.possibleValues}else{if(t.valueType==="enumDyn"&&typeof t.possibleValues==="function"){return[]}else{var s=[];if(t.possibleValues.constructor===Array){for(var q=0;q<t.possibleValues.length;q++){s.push(i(t.valueType,t.possibleValues[q],t.possibleValues))}}else{if(t.valueType==="enumValueToProperty"){for(var r in t.possibleValues){s.push({labelItem:t.possibleValues[r],valueItem:r})}}else{for(var r in t.possibleValues){s.push({labelItem:i(t.valueType,r,t.possibleValues),valueItem:t.possibleValues[r]})}}}return s}}}return[]}var h=function(r,q){c.call(this,r,q)};g.applyMixin(h,c);h.prototype.buildView=function(){var r=this._options.viewOptions;r.disabled=this._tweaker.readOnly;r.touchMode=this._tweaker._getCurrentTouchMode();r.fireOnlyFromUIInteractionFlag=true;this._view=new a(r);var q=this._tweaker.value;this.setPossibleValues(this._tweaker.possibleValues);this.setValue(q)};h.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var q=this._view;q.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(q.value)})};h.prototype.setPossibleValues=function(u){var w=this._tweaker;var s=this._view;if(!s||!w||!u){return}var r=s.getButtonCount();for(var q=0;q<r;q++){var t=s.getButton(0);s.removeChild(t);t.destroy()}if(w.valueType==="enumString"){u.forEach(function(x){if(typeof x==="object"){s.addChild(new l({type:s.type,label:x.label,value:x.value,icon:x.icon}))}else{s.addChild(new l({type:s.type,label:x,value:x}))}})}else{if(w.valueType==="enumDyn"){}else{if(w.valueType==="enumValueToProperty"){for(var v in u){s.addChild(new l({type:s.type,label:u[v],value:v}))}}else{for(var v in u){s.addChild(new l({type:s.type,label:v,value:u[v]}))}}}}};h.prototype.setValue=function(r){var s=this._tweaker;var q=this._view;if(!q||!s){return}q.value=r};n.prototype.baseViewModule=c;n.prototype.VIEW_MODULES={combo:{classObject:b,options:{viewOptions:{enableSearchFlag:false}}},comboLite:{classObject:b,options:{viewOptions:{enableSearchFlag:false,mainElementVisibleFlag:false,displayStyle:"lite"}}},searchableCombo:{classObject:b},buttonGroup:{classObject:h},buttonGroup_readOnly:{classObject:h}};n.prototype.registerViewModule=function(q,r){return;if(!q||!r||!r.classObject&&!r.classPath){return}if(n.prototype.VIEW_MODULES[q]!==undefined){return}n.prototype.VIEW_MODULES[q]=r};return n});define("DS/Tweakers/TweakerVariant",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerEnum","DS/Tweakers/TypeRepresentationFactory"],function(f,h,a,j,i,c){var e=j.inherit({name:"TweakerVariant",publishedProperties:{valueTypes:{defaultValue:undefined,type:"string"},currentType:{defaultValue:undefined,type:"string"},displayStyle:{defaultValue:"editors",type:"string"}},_postBuildView:function(){this._parent();if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-variant")}},_applyProperties:function(k){this._parent(k);if(this.isDirty("valueTypes")){this._applyValueTypes()}if(this.isDirty("currentType")){this._applyCurrentType()}},_applyCurrentType:function(){if(this.elements._viewModule&&this.elements._viewModule.setCurrentType){this.elements._viewModule.setCurrentType(this.currentType)}},_applyValueTypes:function(){if(this.elements._viewModule&&this.elements._viewModule.setValueTypes){this.elements._viewModule.setValueTypes(this.valueTypes)}}});var g=function(l,k){j.prototype.baseViewModule.call(this,l,k)};h.applyMixin(g,j.prototype.baseViewModule);g.prototype.setValueTypes=function(){};g.prototype.setCurrentType=function(){};var d=function(l,k){g.call(this,l,k)};h.applyMixin(d,g);d.prototype.buildView=function(){this._view=[];var l=f.createElement("div",{"class":"wux-tweakers-variant-typeContainer"});var k=new i({value:this._tweaker.currentType,touchMode:this._tweaker._getCurrentTouchMode(),displayStyle:"comboLite"});k.getContent().addClassName("wux-tweakers-variant-typeCustomizer");k.applyPropertiesOnView({expanderIcon:"cog"});k.elements._viewModule._view.elements.icon.style.fontSize="1.2em";this._view.push(l);this._view.push(k);this.setCurrentType(this._tweaker.currentType)};d.prototype.handleEvents=function(){var k=this;a.addEventOnElement(this._view[1],this._view[1],"change",function(l){l.stopPropagation();k._tweaker.currentType=l.dsModel.value})};d.prototype.setValue=function(k){if(!this._view||this._view.length<3){return}this._view[2].value=k};d.prototype.setValueTypes=function(k){if(!this._view||this._view.length<2||k===undefined){return}this._view[1].setProperties({possibleValues:k.trim().split("|"),value:this._tweaker.currentType})};d.prototype.setCurrentType=function(p){if(!this._view||this._view.length<2){return}this._view[1].value=p;var q=parseInt(Date.now());this._currentTimeStamp=q;if(this._view.length>2){var l=this._view.pop();l.remove();l.destroy()}var m=this;var k=function(r){if(r!==undefined){m._view.push(r);r.inject(m._view[0]);a.addEventOnElement(r,r,"preEdit",function(s){s.stopPropagation();m._tweaker.onPreEdit()});a.addEventOnElement(r,r,"postEdit",function(s){s.stopPropagation();m._tweaker.onPostEdit()});["liveChange","change"].forEach(function(s){a.addEventOnElement(r,r,s,function(t){t.stopPropagation();m.setTweakerValue(r.value)})});m.setTweakerValue(r.value);m._tweaker.fire("currentTypeChange")}};var o=function(){return m._currentTimeStamp===q};var n={touchMode:this._tweaker._getCurrentTouchMode(),typePath:p,context:"inlinedTemplate",onViewCreated:k,needToCreateViewAfterRequireEnded:o,semantics:{allowResetToUndefinedByUIFlag:this._tweaker.allowResetToUndefinedByUIFlag}};if(WUX.typeRepFactory!==undefined){WUX.typeRepFactory.generateView(this._tweaker.value,n)}else{WUX.typeRepFactory=new c({onReady:function(){this.generateView(m._tweaker.value,n)}})}};d.prototype.setTouchMode=function(l){if(!this._view||this._view.length<2){return}var k=this._tweaker._getCurrentTouchMode();this._view[1].touchMode=k;if(this._view.length>2){this._view[2].touchMode=k}};var b=function(l,k){g.call(this,l,k)};h.applyMixin(b,g);b.prototype.buildView=function(){this.setCurrentType(this._tweaker.currentType)};b.prototype.setValue=function(k){if(!this._view){return}this._view.value=k};b.prototype.setCurrentType=function(o){var p=parseInt(Date.now());this._currentTimeStamp=p;if(this._view!==undefined){this._view.remove();this._view.destroy();this._view=undefined}var l=this;var k=function(q){if(q!==undefined){l._view=q;l.inject(l._tweaker.elements.container);l.setTweakerValue(q.value);l._tweaker.fire("currentTypeChange")}};var n=function(){return l._currentTimeStamp===p};var m={touchMode:this._tweaker._getCurrentTouchMode(),readOnly:true,typePath:o,context:"inlinedTemplate",onViewCreated:k,needToCreateViewAfterRequireEnded:n,semantics:{allowResetToUndefinedByUIFlag:this._tweaker.allowResetToUndefinedByUIFlag}};if(WUX.typeRepFactory!==undefined){WUX.typeRepFactory.generateView(this._tweaker.value,m)}else{WUX.typeRepFactory=new c({onReady:function(){this.generateView(l._tweaker.value,m)}})}};b.prototype.setTouchMode=function(k){if(!this._view){return}this._view.touchMode=this._tweaker._getCurrentTouchMode()};e.prototype.baseViewModule=g;e.prototype.VIEW_MODULES={readOnly:{classObject:b},editors:{classObject:d}};e.prototype.registerViewModule=function(k,l){return;if(!k||!l||!l.classObject&&!l.classPath){return}if(e.prototype.VIEW_MODULES[k]!==undefined){return}e.prototype.VIEW_MODULES[k]=l};return e});