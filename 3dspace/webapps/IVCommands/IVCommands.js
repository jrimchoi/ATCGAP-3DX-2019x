define("DS/IVCommands/IVHMDActivateCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/SUI/HMDScenario","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/LineEditor"],function(h,b,g,e,d,a,c){var f=b.extend({init:function(j){this._parent(j,{mode:"exclusive",isAsynchronous:true});var i=this.getFrameWindow();this.viewer=i?i.getViewer():j.viewer;this._scenario=new g(this.viewer);this._standing=true;this._mirroring=true;this._height=this.viewer.internalSceneGraph.getSceneMin();this._previousTreeDisplay=null},beginExecute:function(){var u=this;var s=this.viewer;this._standing=true;this._mirroring=true;this._height=s.internalSceneGraph.getSceneMin();var m=new h.Element("div");var k=typeof InstallTrigger!=="undefined";var i=!this._scenario._mirrorAttributesOn&&k;var n=new a({type:"switch",label:"Headset Mirroring",internalLabelsFlag:true,checkFlag:this._mirroring,disabled:i}).inject(m);n.addEventListener("buttonclick",function(){u._mirroring=n.checkFlag});var l=new a({type:"switch",label:"Standing space",internalLabelsFlag:true,checkFlag:this._standing}).inject(m);l.addEventListener("buttonclick",function(){u._standing=l.checkFlag});var t=new h.Element("div",{"class":"wux-control-inline-container",style:{"vertical-align":"top"}}).inject(m);new h.Element("label",{text:"Floor height:"}).inject(t);var r=new h.Element("label",{"class":"wux-control-inline-container"}).inject(t);var q=new c({placeHolder:this._height,value:this._height,autoCommitFlag:true}).inject(r);q.addEventListener("change",function(){var v=Number.parseInt(q.value);if(!Number.isNaN(v)&&Number.isFinite(v)){u._height=v}});var p=new d({label:"Set to min"}).inject(t);p.addEventListener("buttonclick",function(){q.value=s.internalSceneGraph.getSceneMin()});var o=this.getFrameWindow();var j=o?o.elements.modalDialogContainer:s.div;this.OKButton=new d({label:"OK",onClick:function(){}});this._scenario.activate().then(function(){var v=new e({title:"Render in HMD",content:m,buttons:{Ok:u.OKButton}}).inject(j);u.OKButton.onClick=function(){u._scenario.mirroring=u._mirroring;u._scenario.setStanding(u._standing);u._scenario.setSceneMin(u._height);s.offsetPlaneBackground.z=u._height;s.offsetPlaneSmall.z=u._height;u._scenario.enterVRMode();v.close()};if(o!==null){var w=o.getActionBar();w.close();u._previousTreeDisplay=o.getTree().getContent().style.display;o.getTree().getContent().style.display="none"}u.hmdActivated=true},function(){u.hmdActivated=false})},execute:function(){},endExecute:function(){if(this.hmdActivated){var i=this.getFrameWindow();if(i!==null){var j=i.getActionBar();j.open();i.getTree().getContent().style.display=this._previousTreeDisplay}this._scenario.deactivate();this._height=this.viewer.internalSceneGraph.getSceneMin()}this._standing=true;this._mirroring=true},getScenario:function(){return this._scenario},clickButtonArtificially:function(){if(this.OKButton&&this.hmdActivated){this.OKButton.onClick()}}});return h.namespace("DS/IVCommands/IVHMDActivateCmd",f)});