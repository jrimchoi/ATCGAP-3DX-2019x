/*!  COPYRIGHT DASSAULT SYSTEMES 2014   */
define("DS/Units/Units",["UWA/Controls/Abstract","UWA/Core","DS/WebappsUtils/WebappsUtils"],function(h,j,d){var k=false;var a={usi:[{unit:"g",useSubUnits:true},{unit:"m",useSubUnits:true},{unit:"deg",useSubUnits:false},{unit:"rad",useSubUnits:false}],listOfUnits:{},usiConversion:{from:["rad","deg"],to:["deg","radian"],factor:[function l(n){return n*180/Math.PI%360},function b(n){return(n%360)*Math.PI/180}]}};var e={from:["miles","radian","degree","degree","degree"],to:["kilometer","degree","grade","quadrant","radian"],factor:[1.609344,function l(n){return n*180/Math.PI%360},1,1111,function b(n){return(n%360)*Math.PI/180}]};var c=["k","h","da","","d","c","m"];var m={k:1000,h:100,da:10,d:0.1,c:0.01,m:0.001};a.usi.forEach(function(o,n){if(o.useSubUnits){c.forEach(function(q,p){var r=q+o.unit;a.listOfUnits[r]=o.unit})}else{a.listOfUnits[o.unit]=o.unit}});var i;function g(o,p){var n=o.charAt(o.indexOf("value")+1);var q=parseFloat(o.substr(o.indexOf(n)+1));switch(n){case"*":return p*q;case"/":return p/q;default:console.log("Operateur non reconnu")}}var f=h.extend({defaultOptions:{unit:"",_unitIndex:null,value:null},init:function(n){this._parent(n);this.options.unit=this.options.unit.toLowerCase()},to:function(q){var v=this.options.unit;var o=q;var p=a.listOfUnits[v];var C=a.listOfUnits[o];var n=parseFloat(this.options.value,10);var A;var z,r,t;if(p){if(v!==p){var y=v.replace(new RegExp(p+"$"),"");if(k){console.info("Unit",v,"is a subunit of",p,"with prefix:",y)}z=m[y]*n;if(k){console.warn("[1]",n,v,"-->",z,p)}}else{z=n}if(p!==C){var s,B;for(var x=0;x<a.usiConversion.from.length&&!B;x++){if(a.usiConversion.from[x]===p&&a.usiConversion.to[x]===C){s=x;B=true}}if(B){if(k){console.warn("Will convert from",p,"to",a.usiConversion.to[s],s,"with conversion factor",a.usiConversion.factor[s])}if(s>=0){switch(typeof a.usiConversion.factor[s]){case"function":t=a.usiConversion.factor[s](parseFloat(this.options.value,10));break;default:t=parseFloat(this.options.value,10)/a.usiConversion.factor[s];break}if(k){console.warn(parseFloat(this.options.value,10),a.usiConversion.from[s],"-->",t,a.usiConversion.to[s])}}}else{throw"Conversion factor not found for : "+p+"-->"+C}}else{t=z}if(o!==C){var u=o.replace(new RegExp(C+"$"),"");if(k){console.info("Unit",o,"is a subunit of",C,"with prefix:",u)}r=t/m[u];if(k){console.warn("[3]",t,C,"-->",r,o)}}else{r=t}var w;w=new f({value:r,unit:o});return w}else{throw"unitÃ© non reconnu : "+q}},toString:function(){return this.options.value+" "+this.options.unit},_getUnitIndex:function(o){var n=a[i].units_names.indexOf(o),p=a[i].units_names_short.indexOf(o);if(n!==-1){return n}else{return p}},convert:function(o,p){var q=this.options.knowledge;for(var n in q.UNITS_KNOWLEDGE){console.log(n);if(o===n.description){g(n.description,p)}}},addUnitRule:function(p,o,n){e.from.push(p);e.to.push(o);e.factor.push(n)}});return f});define("DS/Utilities/Data",["UWA/Core"],function(b){var a={chunk:function(e,d){e=b.extend({array:[],process:function(){},context:null,callback:function(){}},e);if(d===undefined){d=0}if(e.array instanceof Array){var c=e.array.concat();setTimeout(function(){var f=Number(new Date());do{e.process.call(e.context,c.shift(),d);d++}while(c.length>0&&(Number(new Date())-f<50));if(c.length>0){setTimeout(a.chunk.bind(e,d),25)}else{e.callback(e.array)}},25)}},forEach:function(d,f,e,i){var g=0,c=d.length;function h(){var j=e;while(j--&&c>g){f(d[g],g++)}if(c>g){setTimeout(h,0)}else{if(typeof i==="function"){i()}}}h()}};return a});define("DS/Utilities/UUID",["UWA/Core","UWA/Event"],function(h,u){var e={};var l;if(!l){var b=new Array(16);l=function(){for(var v=0,w;v<16;v++){if((v&3)===0){w=Math.random()*4294967296}b[v]=w>>>((v&3)<<3)&255}return b}}var o=typeof(Buffer)==="function"?Buffer:Array;var j=[];var k={};for(var r=0;r<256;r++){j[r]=(r+256).toString(16).substr(1);k[j[r]]=r}function n(y,v,z){var w=(v&&z)||0,x=0;v=v||[];y.toLowerCase().replace(/[0-9a-f]{2}/g,function(i){if(x<16){v[w+x++]=k[i]}});while(x<16){v[w+x++]=0}return v}function m(v,x){var w=x||0,y=j;return y[v[w++]]+y[v[w++]]+y[v[w++]]+y[v[w++]]+"-"+y[v[w++]]+y[v[w++]]+"-"+y[v[w++]]+y[v[w++]]+"-"+y[v[w++]]+y[v[w++]]+"-"+y[v[w++]]+y[v[w++]]+y[v[w++]]+y[v[w++]]+y[v[w++]]+y[v[w++]]}var g=l();var s=[g[0]|1,g[1],g[2],g[3],g[4],g[5]];var t=(g[6]<<8|g[7])&16383;var d=0,p=0;function f(H,x,B){var C=x&&B||0;var D=x||[];H=H||{};var A=H.clockseq!==null?H.clockseq:t;var v=H.msecs!==null?H.msecs:new Date().getTime();var G=H.nsecs!==null?H.nsecs:p+1;var w=(v-d)+(G-p)/10000;if(w<0&&H.clockseq===null){A=A+1&16383}if((w<0||v>d)&&H.nsecs===null){G=0}if(G>=10000){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}d=v;p=G;t=A;v+=12219292800000;var F=((v&268435455)*10000+G)%4294967296;D[C++]=F>>>24&255;D[C++]=F>>>16&255;D[C++]=F>>>8&255;D[C++]=F&255;var E=(v/4294967296*10000)&268435455;D[C++]=E>>>8&255;D[C++]=E&255;D[C++]=E>>>24&15|16;D[C++]=E>>>16&255;D[C++]=A>>>8|128;D[C++]=A&255;var z=H.node||s;for(var y=0;y<6;y++){D[C+y]=z[y]}return x?x:m(D)}function c(w,v,A){var x=v&&A||0;if(typeof(w)==="string"){v=w=="binary"?new o(16):null;w=null}w=w||{};var z=w.random||(w.rng||l)();z[6]=(z[6]&15)|64;z[8]=(z[8]&63)|128;if(v){for(var y=0;y<16;y++){v[x+y]=z[y]}}return v||m(z)}var q=c;q.v1=f;q.v4=c;q.parse=n;q.unparse=m;q.BufferClass=o;if(e.define&&define.amd){define(function(){return q})}else{if(typeof(module)!=="undefined"&&module.exports){module.exports=q}else{var a=e.uuid;q.noConflict=function(){e.uuid=a;return q};return q}}});define("DS/CoreEvents/Events",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class"],function(f,b,d,c){var e={topics:{},subUid:-1,publish:function(i,h){if(!this.topics[i]){return false}var j=this.topics[i],g=j?j.length:0;while(g--){if(j[g]&&j[g].func){j[g].func(h)}}return this},subscribe:function(g,i){if(!this.topics[g]){this.topics[g]=[]}var h=(++this.subUid).toString();this.topics[g].push({token:h,func:i});return h},unsubscribe:function(l){for(var g in this.topics){if(this.topics[g]){for(var k=0,h=this.topics[g].length;k<h;k++){if(this.topics[g][k]&&this.topics[g][k].token===l){this.topics[g].splice(k,1);h--}}}}return this}};var a=c.singleton({init:function(g){this._parent(false)},_formatEvent:function(g){var h=/(\/+)/g;g=("/"+g+"/").replace(h,"/");return g},publish:function(h){var g={event:null,data:null,useFullInfos:false};f.extend(g,h);g.event=this._formatEvent(g.event);if(g.useFullInfos){e.publish(g.event,g)}else{e.publish(g.event,g.data)}},subscribe:function(i,k,j){if(j===undefined){j=false}var g={event:null};f.extend(g,i);var h=this._formatEvent(g.event);return e.subscribe(h,k)},subscribeOnce:function(i,k){var j=this;var h=this.subscribe(i,g);function g(l){j.unsubscribe(h);k.call(this,l)}},unsubscribe:function(g){e.unsubscribe(g)}});return f.namespace("WUX/Events",a)});define("DS/Notifications/NotificationsManagerViewOnConsole",["DS/WebappsUtils/WebappsUtils","UWA/Core","UWA/Class"],function(c,e,b){function d(){}var a=b.singleton({defaultOptions:{},init:function(f){this._parent(f);this._manager=undefined;this._filter="";this._tokenNotificationAdded=null;this._tokenNotificationModified=undefined},setNotificationManager:function(f){if(this._manager===f){return}if(this._tokenNotificationAdded){this._manager.unsuscribeToNotificationAdded(this._tokenNotificationAdded);this._tokenNotificationAdded=undefined}if(this._tokenNotificationModified){this._manager.unsuscribeToNotificationModified(this._tokenNotificationModified);this._tokenNotificationModified=undefined}this._manager=f;if(this._manager){this._tokenNotificationAdded=this._manager.suscribeToNotificationAdded(this._displayNotification.bind(this));this._tokenNotificationModified=this._manager.suscribeToNotificationModified(this._displayNotification.bind(this))}},_displayNotification:function(f){if(this._filter!=""&&f.category!=this._filter){return}console.log(" ");console.log("###############################");console.log("#### Notification received ####");console.log("###############################");console.log("Level : "+f.level);console.log("Title : "+f.title);console.log("Subtitle : "+f.title);console.log("Message : "+f.message)},setFilterDisplayedNotification:function(f){if(this._filter==f){return}this._filter=f;d.call(this)},getFilterDisplayedNotification:function(){return this._filter},clear:function(){console.clear()}});return a});define("DS/Core/PointerEvents",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class","UWA/Utils/Client"],function(i,c,n,w,x){var e=false;var f;var t="DS";var l=t+"pointerup";var g=t+"pointermove";var E=t+"pointerdown";var h=t+"pointerleave";var F=t+"pointerhit";var D=t+"pointerout";var u=t+"pointerenter";var m=t+"hold";var d=t+"longhold";var q=300;var k=1000;var A=5;var y={capture:false};var p={touchstart:{value:null,options:{passive:false,capture:false}},mousedown:{value:null,options:y},pointerdown:{value:null,options:y},touchend:{value:null,options:y},pointerup:{value:null,options:y},mouseup:{value:null,options:y},click:{value:null,options:y},touchmove:{value:null,options:{passive:false,capture:false}},mousemove:{value:null,options:y},pointermove:{value:null,options:y},mouseleave:{value:null,options:y},mouseout:{value:null,options:y},mouseenter:{value:null,options:y},};var z={mousedown:E,mouseup:l,click:F,mousemove:g,mouseleave:h,mouseout:D,mouseenter:u};var v={touchstart:E,touchend:l,click:F,touchmove:g};var o={pointerdown:E,pointerup:l,click:F,pointermove:g,pointerout:D,pointerenter:u,pointerleave:h};var b={mousedown:E,mouseup:l,click:F,mousemove:g,mouseleave:h,mouseout:D,mouseenter:u};var s={mousedown:E,mouseup:l,click:F,mousemove:g,mouseleave:h,mouseout:D,mouseenter:u};var a={mousedown:E,mousemove:g,click:F,mouseup:l,mouseleave:h,mouseout:D,mouseenter:u};var C=true;var B=null;var r=function(H,G){var I=document.createEvent("MouseEvents");if(G.type.substr(0,5)=="touch"&&G.changedTouches&&G.changedTouches.length){I.initMouseEvent(H,G.bubbles,G.cancelable,G.view,G.detail,G.changedTouches[0].screenX,G.changedTouches[0].screenY,G.changedTouches[0].clientX,G.changedTouches[0].clientY,G.ctrlKey,G.altKey,G.shiftKey,G.metaKey,G.button,G.relatedTarget);I.changedTouches=G.changedTouches;I.touches=G.touches}else{I.initMouseEvent(H,G.bubbles,G.cancelable,G.view,G.detail,G.screenX,G.screenY,G.clientX,G.clientY,G.ctrlKey,G.altKey,G.shiftKey,G.metaKey,G.button,G.relatedTarget)}I.originalEvent=G;I.oldPreventDefault=I.preventDefault;I.oldStopPropagation=I.stopPropagation;I.oldStopImmediatePropagation=I.stopImmediatePropagation;G.target.dispatchEvent(I)};var j=w.singleton({POINTERUP:l,POINTERMOVE:g,POINTERDOWN:E,POINTERLEAVE:h,POINTERENTER:u,POINTEROUT:D,HOLD:m,LONGHOLD:d,POINTERHIT:F,init:function(G){this._parent(false);this._lastPointers=[];this._lastX=-1;this._lastY=-1;this.timerhold,this.timerlonghold;this.hasHoldTime=false;this.hasLongHoldTime=false;this.lockTimer;this.clickTimer=null;this._multipleHitCount=0},disable:function(){C=false},isLastEventTouch:function(G){if(G!==undefined){this.isTouch=G}else{return this.isTouch}},isTouchEvent:function(I){var H=false;function G(){if(window.navigator&&window.navigator.platform){if(window.navigator.platform.indexOf("Linux armv")>-1||window.navigator.platform.indexOf("Android")>-1){return true}return false}return false}var J=I.mozInputSource;if(I.touchFlag){H=true}else{if(J!=null&&J===5){H=true}else{if(I.changedTouches){H=true}else{if(G()){H=true}else{if(I.pointerType==="touch"){H=true}else{if(I.sourceCapabilities&&I.sourceCapabilities.firesTouchEvents){H=true}else{if(window.navigator.userAgent&&window.navigator.platform.match(/iPhone|iPod|iPad/)){H=true}else{if(I.type==="touchstart"||I.type==="touchend"||I.type==="touchmove"){H=true}}}}}}}}I.touchFlag=H;return H},_initTimer:function(){if(this.timerhold&&this.timerlonghold){clearTimeout(this.timerhold);clearTimeout(this.timerlonghold);this.timerhold=0;this.timerlonghold=0;this.hasHoldTime=false;this.hasLongHoldTime=false;this.lockTimer=false}},enable:function(){var J=this;var H={timeStamp:0,target:null,type:null};var M=undefined,L=undefined,K=false;function G(O){if(C){var P=j.isTouchEvent(O);var V=x.Engine;var W;if(V.ie||window.navigator.userAgent.indexOf("Edge")>=0){if(P){W=o[O.type]}else{W=b[O.type]}}else{if(V.safari||V.safari7){if(P){W=v[O.type]}else{W=z[O.type]}}else{if(V.chrome||V.webkit){if(P){W=v[O.type]}else{W=z[O.type]}}else{if(V.firefox){if(P){W=v[O.type]}else{W=s[O.type]}}}}}if(W){var T=(typeof O.which!=="undefined")?O.which:O.button;if(T===3){return}var R=document.createEvent("MouseEvents");R.initEvent(W,true,true);if(O.type.substr(0,5)=="touch"&&O.changedTouches&&O.changedTouches.length){R.initMouseEvent(W,O.bubbles,O.cancelable,O.view,O.detail,O.changedTouches[0].screenX,O.changedTouches[0].screenY,O.changedTouches[0].clientX,O.changedTouches[0].clientY,O.ctrlKey,O.altKey,O.shiftKey,O.metaKey,O.button,O.relatedTarget);R.changedTouches=O.changedTouches;R.touches=O.touches}else{R.initMouseEvent(W,O.bubbles,O.cancelable,O.view,O.detail,O.screenX,O.screenY,O.clientX,O.clientY,O.ctrlKey,O.altKey,O.shiftKey,O.metaKey,O.button,O.relatedTarget)}if(O){var U={timeStamp:O.timeStamp,target:O.target,type:O.type};if(O.type!=="click"&&H&&U.timeStamp===H.timeStamp&&U.target===H.target||U.timeStamp==0){return}}R.originalEvent=O;R.oldPreventDefault=R.preventDefault;R.oldStopPropagation=R.stopPropagation;R.oldStopImmediatePropagation=R.stopImmediatePropagation;R.preventDefault=function(X){R.oldPreventDefault();O.preventDefault()};R.stopPropagation=function(X){R.oldStopPropagation();O.stopPropagation()};R.stopImmediatePropagation=function(X){R.oldStopImmediatePropagation();O.stopImmediatePropagation()};var N=J._lastPointers[0];var S=N&&N.changedTouches?N.changedTouches[0].screenX:N?N.screenX:-1;var Q=N&&N.changedTouches?N.changedTouches[0].screenY:N?N.screenY:-1;if(true&&N&&N.type==R.type&&S===R.screenX&&Q===R.screenY&&R.screenX===J._lastX&&R.screenY===J._lastY){if(e){console.warn("stop event",O.type)}}else{J._lastX=R.screenX;J._lastY=R.screenY;if(O.type==="touchstart"||O.type==="touchend"||O.type==="touchmove"){H={timeStamp:O.timeStamp,target:O.target,type:O.type}}if(R.type==="DSpointerdown"){M=R.screenX;L=R.screenY;K=true;J._initTimer();if(J.lockTimer){return}J.timerhold=setTimeout(function(X){r("DShold",O)},q);J.timerlonghold=setTimeout(function(X){r("DSlonghold",O)},k);J.lockTimer=true;J._downExist=true}if(R.type==="DSpointerhit"){if(!J._targetOnClick){J._targetOnClick=O.target}if(J._targetOnClick===O.target){J._multipleHitCount++}J._targetOnClick=O.target;R.multipleHitCount=J._multipleHitCount;if(J.clickTimer===null){J.clickTimer=setTimeout(function(){J.clickTimer=null;J._multipleHitCount=0;J._targetOnClick=undefined;clearTimeout(J.clickTimer)},500)}}if(R.type==="DSpointermove"){if(K&&M&&L&&M===R.screenX&&L===R.screenY){K=undefined;return}else{if(Math.sqrt(Math.pow(R.screenX-M,2)+Math.pow(R.screenY-L,2))>A){J._initTimer()}}}if(R.originalEvent.type==="mouseup"&&H.type==="touchend"&&J._downExist===undefined){B=R;return}else{j.isLastEventTouch(P);R.touchFlag=P;O.target.dispatchEvent(R)}if(R.type==="DSpointerup"){J._initTimer();J._downExist=undefined}B=R;if(e){clearTimeout(f);console.warn(O.type,"-->",R.type,R.timeStamp);f=setTimeout(function(){},5000)}J._lastPointers[0]=R}}}}for(var I in p){if(x.Engine.ie){document.addEventListener(I,G,p[I].options.capture)}else{document.addEventListener(I,G,p[I].options)}}}});return j});define("DS/Utilities/Array",["UWA/Core"],function(b){var a={clear:function(c,d){c.length=0;c=null;if(!d){c=[]}return c},optimizedForEach:function(d,f){var c=d.length;for(var e=0;e<c;e++){f.call(d,d[e],e)}},arrayMove:function(e,f,c){if(c>=e.length){var d=c-e.length;while((d--)+1){e.push(undefined)}}e.splice(c,0,e.splice(f,1)[0]);return e},array2dMove:function(e,f,c){if(c>=e.length){var d=c-e.length;while((d--)+1){e.push(undefined)}}e.splice(c,0,e.splice(f,1)[0]);return e},array2dTranspose:function(l){var d=l,c=d.length?d.length:0,k=d[0] instanceof Array?d[0].length:0;if(k===0||c===0){return[]}var g,e,f=[];for(g=0;g<k;g++){f[g]=[];for(e=0;e<c;e++){f[g][e]=d[e][g]}}return f},pushUnique:function(d,c){if(d.indexOf(c)===-1){d.push(c);return true}return false},};return a});define("DS/Utilities/Debug",["UWA/Core"],function(c){var b=false;var a={enable:function(){b=true},disable:function(){b=false},log:function(){if(b){console.log.apply(console,arguments)}},beginMeasure:function(d){if(b){console.profile(d);console.time(d);console.timeStamp(d);console.group(d)}},endMeasure:function(d){if(b){console.profileEnd(d);console.timeEnd(d);console.groupEnd(d)}}};return c.namespace("WUX/Debug",a)});define("DS/Utilities/Simulate",["UWA/Core"],function(b){keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};buttonCode={LEFT:0,MIDDLE:1,RIGHT:2};var a={createEvent:function(c){var d=document.createEvent("CustomEvent");d.initCustomEvent(c,true,true,null);d.dataTransfer={data:{},types:["text/plain"],setData:function(e,f){this.data[e]=f},getData:function(e){return this.data[e]}};return d},dispatchEvent:function(e,c,d){if(e.dispatchEvent){e.dispatchEvent(d)}else{if(e.fireEvent){e.fireEvent("on"+c,d)}}},drag:function(c){if(c.target===null){c.dataTransfer.setData("Text","0")}else{if(c.target.id!==""){c.dataTransfer.setData("Text",c.target.id)}else{c.dataTransfer.setData("Text","0")}}},drop:function(d,c){d.preventDefault();var e=d.dataTransfer.getData("Text");d.target.appendChild(document.getElementById(e))},simulateMouse:function(e,d){var c=document.createEvent("MouseEvents");c.initEvent(e,true,true);d.dispatchEvent(c)},simulateMouseMove:function(e,d){var c=new MouseEvent(e,{view:window,bubbles:true,cancelable:true,clientX:d.x,clientY:d.y});d.dispatchEvent(c)},simulateScroll:function(g,c,h,e){if(!e){g.scrollBy(c,h)}else{var f=0;var d=setInterval(function(){if(f===e.nbRepeat){clearInterval(d)}g.scrollBy(c,h);f++},e.delay)}},simulateDragDrop:function(g,c){var e="dragstart";var f=this.createEvent(e);this.dispatchEvent(g,e,f);if(!c.dragDefined){this.drag(f)}e="drop";var d=this.createEvent(e,{});d.dataTransfer=f.dataTransfer;d.layerY=27;this.dispatchEvent(c.dropTarget,e,d);if(!c.dropDefined){this.drop(d)}else{e="dragend"}var h=this.createEvent(e,{});h.dataTransfer=f.dataTransfer;this.dispatchEvent(g,e,h)},simulateChange:function(e){var c="change";var d=this.createEvent(c);this.dispatchEvent(e,c,d)},simulateKeyDown:function(h,d){h.focus();var f="keydown";var e=document.createEvent("KeyboardEvent");var c=typeof e.initKeyboardEvent!=="undefined"?"initKeyboardEvent":"initKeyEvent";for(var g in keyCode){if(g==d){e[c]("keydown",true,true,window,false,false,false,false,8,8)}}h.dispatchEvent(e)},doKeyEvent:function(g,c){g.focus();var d="keydown";var f=this.createEvent(d);for(var e in keyCode){if(e==c){f.keyCode=keyCode[e]}}this.dispatchEvent(g,d,f)}};return a});define("DS/Utilities/Polymer",[],function(){var h=false;var i=true;var a=true;var e={};var f="ds";var j=false;function g(k){return k.charAt(0).toUpperCase()+k.slice(1)}function d(k){return k.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}function c(k){return k.replace(/\W+(.)/g,function(l,m){return m.toUpperCase()})}var b=function(w,p){var k="Build Polymer Constructor: "+w.name;if(h){console.groupCollapsed(k)}var m,n;var r=f+"-"+d(w.name);n=p.inheritUtils(this,w);var s={};if(h){console.log("DS/Controls/Abstract published properties to be mapped to Polymer properties:")}var q=n.prototype.publishedProperties;for(var v in q){var l=v;if(j){l=f+g(v)}var u=q[v];var t;switch(u.type){case"boolean":t=Boolean;break;case"string":t=String;break;case"number":t=Number;break;case"date":t=Date;break;case"array":t=Array;break;default:t=null;break}s[v]={type:t,value:u.defaultValue,reflectToAttribute:true,notify:true};if(h){console.log("[+]",v,u,"attributeChanged")}}var o={properties:s,created:function(){},attached:function(){},detached:function(){},attributeChanged:function(y){if(this._reflectToAttributeFlag){var x=this._implement[c(y)];var z=this[c(y)];if(this._implement&&x!==z){if(h){console.log("[POLYMER > ABSTRACT] attributeChanged",y,x,z,this._implement[c(y)])}this._implement[c(y)]=z}}},is:r,ready:function(y){var A="Polymer ready : "+r;if(h){console.log(" ");console.groupCollapsed(A)}this._reflectToAttributeFlag=true;var x=Polymer.dom(this);if(x.node.attributes.length===0){console.warn("[POLYMER] no attributes");this._enableFactoryImpl=true}else{this._enableFactoryImpl=true;var z={};for(var C in this.properties){var B=this.properties[C];if(B.defined){z[C]=this[C];if(h){console.log("[POLYMER] [READY] set initial values",C,":",this[C])}}}if(h){console.log("[POLYMER] [READY] init options",z)}this._buildComponent(z)}if(h){console.groupEnd(A)}},factoryImpl:function(x){if(h){console.log("[POLYMER] [FACTORYIMPL] init options",x)}this._initialOptions=x;if(this._enableFactoryImpl){this._buildComponent(x)}},_buildComponent:function(F){var D=this;var E=Polymer.dom(this);if(this._implement===undefined){if(h){console.info("[POLYMER] constructor parameters",F)}this._implement=new n(F);E.appendChild(this._implement.getContent());E.node.style.display=this._implement.getContent().getStyle("display")}if(i){for(var x in this.properties){var y=F?F[x]:this[x];if(y!==undefined){D[x]=y}}}this._implement._propertyChanged=function(G,H,I){if(H!==I){if(h){console.log("[ABSTRACT > POLYMER] property changed:",G," changed",H,"-->",I)}D._reflectToAttributeFlag=false;D[G]=I;D._reflectToAttributeFlag=true}};if(a){var B={addEvent:true,inject:true};for(var z in this._implement){var A=this._implement[z];if(typeof A==="function"&&B[z]===undefined){var C=z;if(j){C=f+g(z)}if(!D.useprivate){if(z.substring(0,1)!=="_"){D[C]=this._implement[z].bind(this._implement)}}else{D[C]=this._implement[z].bind(this._implement)}}}}},getContent:function(){return Polymer.dom(this).node},inject:function(x){x.appendChild(Polymer.dom(this).node);return Polymer.dom(this).node},addEvent:function(x,z,y){return Polymer.dom(this).node.addEventListener(x,z,y)}};m=window.Polymer(o);e[r]={polymer:m,uwa:n};m.extendOptions=w;if(h){console.groupEnd(k)}return m};return{polymerize:b}});define("DS/Utilities/MouseEvents",["UWA/Core","UWA/Event"],function(e,b){var d={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/};var a={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true};var c={mouse_event_over_element:function(i,k){var g=e.extendElement(k);var m=g.getPosition();var l=g.getDimensions();var f=g.width;var j=g.height;e.Event.dispatchEvent(g,i.type,{screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY})},fireEvent:function(g){var f=document.createEvent("Events");f.initEvent("keypress",true,true);f.view=window;f.altKey=false;f.ctrlKey=false;f.shiftKey=false;f.metaKey=false;f.keyCode=0;f.charCode="a";g.dispatchEvent(f)},simulatedClick:function(i,f){var h=i.ownerDocument.createEvent("MouseEvents"),f=f||{};var g={type:f.type||"click",canBubble:f.canBubble||true,cancelable:f.cancelable||true,view:f.view||i.ownerDocument.defaultView,detail:f.detail||1,screenX:f.screenX||0,screenY:f.screenY||0,clientX:f.clientX||0,clientY:f.clientY||0,ctrlKey:f.ctrlKey||false,altKey:f.altKey||false,shiftKey:f.shiftKey||false,metaKey:f.metaKey||false,button:f.button||0,relatedTarget:f.relatedTarget||null};h.initMouseEvent(g.type,g.canBubble,g.cancelable,g.view,g.detail,g.screenX,g.screenY,g.clientX,g.clientY,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.button,g.relatedTarget);i.dispatchEvent(h)},simulate:function(l,h){var j=extend(a,arguments[2]||{});var g,k=null;for(var i in d){if(d[i].test(h)){k=i;break}}if(!k){throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported")}if(document.createEvent){g=document.createEvent(k);if(k=="HTMLEvents"){g.initEvent(h,j.bubbles,j.cancelable)}else{g.initMouseEvent(h,j.bubbles,j.cancelable,document.defaultView,j.button,j.pointerX,j.pointerY,j.pointerX,j.pointerY,j.ctrlKey,j.altKey,j.shiftKey,j.metaKey,j.button,l)}l.dispatchEvent(g)}else{j.clientX=j.pointerX;j.clientY=j.pointerY;var f=document.createEventObject();g=extend(f,j);l.fireEvent("on"+h,g)}return l},extend:function(f,h){for(var g in h){f[g]=h[g]}return f},trigger:function(j,h,f,n){var k=f.type,g=f.originalEvent,i=f.target,r=f.relatedTarget,p=f.screenX,o=f.screenY,m=f.clientX,l=f.clientY;var q={};q.target=j;q.type=h;q.originalEvent=null;if(n){q.relatedTarget=n}c.simulatedClick(j,{type:h,screenX:p,screenY:o,clientX:m,clientY:l})},forwardMouseEvents:function(i){WUX.log("---FORWARD MOUSE EVENTS --");var p={enableMousemove:true,dblClickThreshold:500,enabled:true};var j=function(v){if(p.enabled){var r=v,u=r.type,w=r.clientX,s=r.clientY,q;k.hide();q=e.extendElement(document.elementFromPoint(w,s));k.show();if(!q){c.trigger(h,"mouseout",v);h=q;return}if(p.enableMousemove||u!=="mousemove"){c.trigger(q,u,v)}if(h&&(q[0]===h[0])){if(u=="mouseup"){if(g!=w||f!=s||(v.timeStamp-m)>p.dblClickThreshold){n=0}g=w;f=s;m=v.timeStamp;c.trigger(q,"click",v);if(++n==2){c.trigger(q,"dblclick",v);n=0}}}else{n=0;if(h){c.trigger(h,"mouseout",v,q[0])}c.trigger(q,"mouseover",v,h?h[0]:k[0])}h=q}};var l=i,k=e.extendElement(i),o,h,g,f,n=0,m=0;k.addEvent("mouseout",function(q){if(h){c.trigger(h,"mouseout",q,k[0]);h=null}});k.addEvent("mousedown",function(q){j(q)});k.addEvent("mouseup",function(q){j(q)});k.addEvent("mousemove",function(q){j(q)});k.addEvent("mousewheel",function(q){j(q)})}};return e.namespace("WUX/Utilities/MouseEvents",c)});define("DS/UIBehaviors/CommandsRegistry",["UWA/Core"],function(b){function a(c){this._commands={};this._linkedCommandRegistry=c;return this}a.prototype.getLinkedCommandRegistry=function(){return this._linkedCommandRegistry};a.prototype.getCommand=function(c){if(this._commands[c]){return this._commands[c]}else{if(this._linkedCommandRegistry){return this._linkedCommandRegistry.getCommand()}}return null};a.prototype.dispatch=function(e,f){var d;var c=this.getCommand(e);if(c){d=c.call(f)}return d};a.prototype.registerCommand=function(c,d){this._commands[c]=d};a.prototype.destroy=function(){this._target=null};return a});define("DS/UIBehaviors/TooltipManager",["UWA/Core","UWA/Class"],function(d,a){var b=undefined;var c=a.singleton({_tooltipFrame:undefined,defaultOptions:{},init:function(e){this._parent(e);if(d.getGlobal().WUX!==undefined){b=WUX.PointerEvents}if(!b){require(["DS/Core/PointerEvents"],function(f){b=f})}},enable:function(){var e=this;if(b){e._handleEvents()}else{require(["DS/Core/PointerEvents"],function(f){b=f;e._handleEvents()})}},_getTooltipFrame:function(){if(this._tooltipFrame!==undefined){return this._tooltipFrame}},show:function(f){var e=this._getTooltipFrame();if(e&&f&&(f.dsModel||f.tooltipInfos)){if(f.dsModel&&e.target!==f.dsModel){e.target=f.dsModel}else{if(f.tooltipInfos&&e.target!==f){e.target=f}}e.touchMode=this.touchMode;e.show()}},hide:function(){var e=this._getTooltipFrame();if(e){e.visibleFlag=false}},_handleEvents:function(){var e=this;document.addEventListener(b.LONGHOLD,function(f){e.hide()});document.addEventListener(b.HOLD,function(i){if(b.isTouchEvent(i)){var f=e._getTooltipFrame();if(f){f.mousePosition={x:i.clientX,y:i.clientY}}var h=undefined;for(var g=i.target;g;g=g.parentNode){if(g.dsModel&&g.dsModel.tooltipInfos){h=g.dsModel;break}if(g.tooltipInfos){h=g;break}}if(h!==undefined){h.tooltipInfos.initialDelay=0;e.touchMode=true;f._lastShowPosition={x:i.clientX,y:i.clientY};e.show(h)}}});document.addEventListener(b.POINTERDOWN,function(k){var j=k.target;var f=e._getTooltipFrame();if(f&&f.visibleFlag){var i=false;if(f.target&&f.target.tooltipInfos){i=f.target.tooltipInfos._reachableState}if(!i){e.hide();return}var h=false;var l=false;for(var g in f.elements){if(f.elements.hasOwnProperty(g)&&f.elements[g]===j){h=true;l=(g==="moreHelp");break}}if(l){f.target.tooltipInfos.moreHelpCB()}else{if(!h){e.hide()}}}},true);document.addEventListener(b.POINTERMOVE,function(i){var f=e._getTooltipFrame();if(f&&f.visibleFlag){var j={x:i.clientX+window.pageXOffset,y:i.clientY+window.pageYOffset};var h=f.isPositionInRZ(j,"target");var g=f.isPositionInRZ(j,"tooltip");if(!h&&!g){f.mousePosition={x:i.clientX,y:i.clientY};if(f.target&&f.target.tooltipInfos&&f.target.tooltipInfos._reachableState){e.hide()}}}});document.addEventListener(b.POINTERUP,function(g){if(!b.isTouchEvent(g)){for(var f=g.target;f;f=f.parentNode){if((f.dsModel&&f.dsModel.tooltipInfos)||f.tooltipInfos){e.hide();break}}}},true);document.addEventListener("mouseleave",function(j){var f=e._getTooltipFrame();if(!f){return}var g=false;if(f.target&&f.target.tooltipInfos){g=f.target.tooltipInfos._reachableState}var k={x:j.clientX+window.pageXOffset,y:j.clientY+window.pageYOffset};var i=f.isPositionInRZ(k,"target");var h=f.isPositionInRZ(k,"tooltip");if(!i&&(!g||!h)){e.hide()}},true);document.addEventListener("mouseenter",function(j){if(b.isTouchEvent(j)){return}var g=e._getTooltipFrame();var h=false;if(g&&g.target&&g.target.tooltipInfos){h=g.target.tooltipInfos._reachableState}var k={x:j.clientX+window.pageXOffset,y:j.clientY+window.pageYOffset};if(h&&g.isPositionInRZ(k,"tooltip")){return}if(g){g.mousePosition={x:j.clientX,y:j.clientY}}var f=undefined;for(var i=j.target;i;i=i.parentNode){if(i.dsModel&&i.dsModel.tooltipInfos){f=i.dsModel.tooltipInfos;break}else{if(i.tooltipInfos){f=i.tooltipInfos;break}}}if(f){if(g&&(i.dsModel&&g.target!==i.dsModel||!i.dsModel&&i!==g.target)){e.hide();g._lastShowPosition={x:j.clientX,y:j.clientY};e.show(i)}}},true);document.addEventListener("keydown",function(f){e.hide()},true)}});return c});define("DS/Utilities/DocUtils",["UWA/Core"],function(b){var a={getWebUXPropertyDocumentation:function(g,e,i){var h=this._getDocSource(e);var f=this;if(!h){require(["text!"+e+".js"],function(l){f._addDocSource(e,l);var k=f._getPropertyDocFromSource(g,l);if(!k){var j=f._getFatherWebUXClassPath(e,l);if(j){return f.getWebUXPropertyDocumentation(g,j,i)}else{i({property:g,doc:undefined})}}i({property:g,doc:k})})}else{var d=this._getPropertyDocFromSource(g,h);if(!d){var c=this._getFatherWebUXClassPath(e,h);if(c){return this.getWebUXPropertyDocumentation(g,c,i)}else{i({property:g,doc:undefined})}}i({property:g,doc:d})}},getWebUXEventDocumentation:function(g,d,i){var h=this._getDocSource(d);var e=this;if(!h){require(["text!"+d+".js"],function(l){e._addDocSource(d,l);var k=e._getEventDocFromSource(g,l,d);if(!k){var j=e._getFatherWebUXClassPath(d,l);if(j){return e.getWebUXEventDocumentation(g,j,i)}else{i({event:g,doc:undefined})}}i({event:g,doc:k})})}else{var f=this._getEventDocFromSource(g,h,d);if(!f){var c=this._getFatherWebUXClassPath(d,h);if(c){return this.getWebUXEventDocumentation(g,c,i)}else{i({event:g,doc:undefined})}}i({event:g,doc:f})}},_getPropertyDocFromSource:function(e,g){var d="property.*}\\s"+e+"\\s(.*)";var c;var f="@property";return this._ComputeDocumentation(g,d,c,f,true)},_getEventDocFromSource:function(f,h,d){var e="@event "+f;var c="@event module:"+d+"#"+f;var g="@event";return this._ComputeDocumentation(h,e,c,g,false)},_ComputeDocumentation:function(k,l,j,v,c){var n="\\r\\n(.*)";var s="(.*)";var r="(.*)";if(!c){for(var q=0;q<=3;q++){s+=n;r+=n}}s+=l;r+=j;if(c){for(var q=0;q<=20;q++){s+=n;r+=n}}var u=new RegExp(s,"gm");var t=new RegExp(r,"gm");var g=u.exec(k);var e=c?null:t.exec(k);var m=g!==null?g:e;var h=/[0-9a-zA-Z]/;var w;if(c){if(m&&m.length>=3){w=m[2]}if(m&&m.length>=4){if(m[3].indexOf("*/")!==-1){return w}else{if(h.test(m[3])){var d=m[3].split("*");if(d.length>=2){if(d[1].indexOf("@limitation")!=-1){w+="</br>"+d[1].replace("@limitation","Limitation : ")}else{if(d[1].indexOf("@property")!==-1){var f=d[1].split("}");if(f.length>=2){w+="</br><b>Subproperty</b>"+f[1]}}else{if(!d[1].indexOf("@return")!==-1){w+="</br>"+d[1]}}}}}}for(var q=4;q<m.length;q++){if(m[q].indexOf("*/")!==-1){return w}else{var d=m[q].split("*");var o;if(d.length>=1){if(d[0].indexOf("/")!==-1){break}o=d[d.length-1];if(o.indexOf("@property")!==-1){var f=o.split("}");if(f.length>=2){o="<b>Subproperty</b>"+f[1]}}}if(h.test(o)&&o.indexOf("@return")===-1){w+="</br>"+o}}}}}else{if(m&&m.length>0){w="";var p=m[0].split("*");for(var q=0;q<p.length;q++){if(h.test(p[q])&&(!v||p[q].indexOf(v)===-1)){w+=p[q]}}}}return w},_getFatherWebUXClassPath:function(l,c){var k;var g="\\s(.*).inherit";var h=new RegExp(g,"gm");var m=h.exec(c);if(m&&m.length>=2){var j=m[1].split("=");if(j.length>1){var i=j[1].trim();var e="DS/([a-zA-Z]*)/"+i;var f=new RegExp(e,"gm");var d=f.exec(c);k=(d&&d.length)?d[0]:undefined}}return k},_getDocSource:function(d){var e;var c=document._DocumentSourcePages;if(c){e=c[d]}return e},_addDocSource:function(e,c){var d=document._DocumentSourcePages;if(d&&!d[e]){d[e]=c}else{if(!d){document._DocumentSourcePages={};document._DocumentSourcePages[e]=c}}}};return a});define("DS/Utilities/Object",["UWA/Core","UWA/Event"],function(c,a){var b={areEquals:function(d,f){if(d&&d.pathElement&&f&&f.pathElement){return d.pathElement.isEqual(f.pathElement)}if(d instanceof Function){if(f instanceof Function){return d.toString()===f.toString()}return false}if(d===null||d===undefined||f===null||f===undefined){return d===f}if(d===f){return true}else{if(typeof d.valueOf==="function"&&typeof f.valueOf==="function"&&d.valueOf()===f.valueOf()){return true}}if(d instanceof Date){return false}if(f instanceof Date){return false}if(!(d instanceof Object)){return false}if(!(f instanceof Object)){return false}var e=Object.keys(d);return Object.keys(f).every(function(g){return e.indexOf(g)!==-1})?e.every(function(g){return b.areEquals(d[g],f[g])}):false},deepFreeze:function(d){var e=Object.getOwnPropertyNames(d);e.forEach(function(f){var g=d[f];if(typeof g==="object"&&g!==null&&!Object.isFrozen(g)){b.deepFreeze(g)}});return Object.freeze(d)}};return c.namespace("WUX/Utilities/Object",b)});define("DS/Utilities/KeyboardUtils",["UWA/Core"],function(b){var a={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFTARROW:37,ARROWUP:38,RIGHTARROW:39,ARROWDOWN:40,INSERT:45,DELETE:46,KEY0:48,KEY1:49,KEY2:50,KEY3:51,KEY4:52,KEY5:53,KEY6:54,KEY7:55,KEY8:56,KEY9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,PLUS:107,MINUS:109,POINT:110,SLASH:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145,SEMICOLON:186,EQUAL:187,COMMA:188,DASH:189,BACKSLASH:191,validate:function(c){if(c==this.SPACE||c==this.ENTER){return true}return false},increase:function(c){if(c==this.ARROWUP||c==this.RIGHTARROW){return true}return false},decrease:function(c){if(c==this.ARROWDOWN||c==this.LEFTARROW){return true}return false},previous:function(c){if(c==this.ARROWUP||c==this.LEFTARROW){return true}return false},next:function(c){if(c==this.ARROWDOWN||c==this.RIGHTARROW){return true}return false}};return a});define("DS/CoreEvents/ModelEvents",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class"],function(f,b,d,c){function e(g,h){g.length=0;g=null;if(!h){g=[]}return g}var a=c.extend({defaultOptions:{parent:null,target:null,asyncPropagation:false,callMode:"desc",debug:{delay:0}},init:function(g){this._parent(false);this.options=f.extend(f.clone(this.defaultOptions),g);this._target=this.options.target;this._spyEvents=null;this._listOfParents=[];if(this.options.parent){this._setParent(this.options.parent)}var h=this;this._pubsub={ongoingtopics:{},topics:{},subUid:-1,publish:function(l,k,j){if(this._spyCB){console.warn("!!!");this._spyCB.call(l,k,j)}if(!this.topics[k]){return false}var n=this.topics[k],i=n?n.length:0;if(h.options.callMode==="desc"){while(i--){if(n[i]&&n[i].func){n[i].func.call(l,j,n[i].token)}}}else{if(h.options.callMode==="asc"){this.ongoingtopics[k]=[];while(n[0]){n[0].func.call(l,j,n[0].token);var m=n.shift();if(m){this.ongoingtopics[k].push(m)}}this.topics[k]=this.ongoingtopics[k];this.ongoingtopics[k]=[]}}return this},subscribe:function(i,k){if(!this.topics[i]){this.topics[i]=[]}var j=(++this.subUid).toString();this.topics[i].push({token:j,func:k});return j},unsubscribe:function(o){for(var n=0,l=this.ongoingtopics.length;n<l;n++){if(this.ongoingtopics[n]&&this.ongoingtopics[n].token===o){this.ongoingtopics.splice(n,1);l--}}for(var k in this.topics){if(this.topics[k]){for(var n=0,l=this.topics[k].length;n<l;n++){if(this.topics[k][n]&&this.topics[k][n].token===o){this.topics[k].splice(n,1);l--}}}}return this}}},_setParent:function(g){this._listOfParents=[];this._addParent(g)},_addParent:function(g){if(g instanceof Array){this._listOfParents=g}else{if(g!==null){this._listOfParents.push(g)}else{this._listOfParents=[]}}},_unsetParent:function(h){var g=this._listOfParents.indexOf(h);if(g!==-1){this._listOfParents.splice(g,1)}},_formatEvent:function(g){return("/"+g+"/").replace(/(\/+)/g,"/")},publish:function(j){var i={context:j.context,event:j.event,formattedEvent:j.formattedEvent===undefined?this._formatEvent(j.event):j.formattedEvent,data:j.data,propagate:j.propagate===undefined?true:j.propagate,target:j.target===undefined?this._target:j.target,parent:j.parent===undefined?this._target:j.parent};var k=this;if(i.target){var g={event:i.event,formattedEvent:i.formattedEvent,parent:i.parent,target:i.target,data:i.data,propagate:i.propagate,stopPropagation:function(){g.propagate=false}};if(k.options.debug&&k.options.debug.delay){setTimeout(function(){k._pubsub.publish(i.context,g.formattedEvent,g)},k.options.debug.delay)}else{this._pubsub.publish(i.context,g.formattedEvent,g)}if(g.propagate){var h=this._listOfParents;if(h.length===1){k._propagate(h[0],i)}else{h.forEach(function(l){k._propagate(l,i)})}}}else{this._pubsub.publish(i.context,i.formattedEvent,i.data)}},_propagate:function(h,g){if(this.options.asyncPropagation){setTimeout(function(){h.publish(g)},0)}else{h.publish(g)}},subscribe:function(i,j){var g={event:null};f.extend(g,i);var h=this._formatEvent(g.event);return this._pubsub.subscribe(h,j)},unsubscribeAll:function(g){var j=this;if(g){var i=this._formatEvent(g.event);if(this._pubsub.topics[i]){this._pubsub.topics[i].forEach(function(k){j._pubsub.unsubscribe(k.token)})}}else{for(var h in this._pubsub.topics){if(this._pubsub.topics[h]){this._pubsub.topics[h].forEach(function(k){j._pubsub.unsubscribe(k.token)});e(this._pubsub.topics[h])}}}},destroy:function(){var g=this;this.unsubscribeAll();delete this._pubsub.topics;delete this._pubsub;delete this._target;e(this._listOfParents);delete this.options;delete this.defaultOptions},addEventListener:function(h,g){return this.subscribe({event:h},g)},subscribeOnce:function(i,k){var j=this;var h=this.subscribe(i,g);function g(l){j.unsubscribe(h);k.call(this,l)}},unsubscribe:function(g){this._pubsub.unsubscribe(g)},_beginSpyEvents:function(g){this._pubsub._spyEvents=g},_endSpyEvents:function(){this._pubsub._spyEvents=null}});return a});define("DS/Utilities/Scroll",["UWA/Core","UWA/Event"],function(c,a){var b={getPosition:function(e){var d=-(e.scrollLeft);var f=-(e.scrollTop);return{y:f,x:d}}};return c.namespace("Utilities/Scroll",b)});define("DS/Controls/LayerSet",["UWA/Core","UWA/Event","UWA/Controls/Abstract"],function(d,b,c){var a=c.extend({defaultOptions:{styles:{}},init:function(e){this._parent(e);this._buildSkeleton()},_buildSkeleton:function(){this.elements.container=new d.Element("div",{"class":"LayerSet",styles:this.options.styles});this.elements._inner=new d.Element("div",{"class":"Content"});this.elements._inner.inject(this.elements.container)},addLayer:function(f,g){if(g===undefined){g={left:0,right:0,top:0,bottom:0}}var e=new d.Element("div",{"class":"Content"});e.setStyle("position","absolute");e.setStyles(g);f.inject(e);e.inject(this.elements._inner);return e}});return d.namespace("Controls/LayerSet",a)});define("DS/Utilities/TouchUtils",["UWA/Core"],function(c){var b=undefined;var a={isAndroidDevice:function(){if(window.navigator&&window.navigator.platform){if(window.navigator.platform.indexOf("Linux armv")>-1||window.navigator.platform.indexOf("Android")>-1){return true}return false}return false},init:function(){var e=navigator.userAgent.match(/iPad/i)!=null;var d=navigator.userAgent.match(/iPhone/i)!=null;var f=false;if(window.__karma__){f=window.__karma__.config.json?window.__karma__.config.json.isTouch:false}if(e||d||f||this.isAndroidDevice()){this.setTouchMode(true)}},setTouchMode:function(e){var i=b;b=e;var j=false;var g=document.getElementsByTagName("*");for(var h=g.length;h--;){var f=g[h].dsModel;if(f){if(f.touchMode===undefined){j=true;if(f._touchModeChange){f._touchModeChange(e)}}}}if(j&&i!==b){var d=document.createEvent("Event");d.initEvent("touchChange",true,false);document.dispatchEvent(d);j=false}},getTouchMode:function(){return b},applyTouch:function(h,g){var e=h.getElementsByTagName("*");for(var f=e.length;f--;){var d=e[f].dsModel;if(d){d.touchMode=g}}}};return a});define("DS/Utilities/ReusableContentsManager",[],function(){var d=false;function c(f){var e=this;this.component=f._buildContent();this.component.__disposable__={identifier:f._identifier,dispose:function(){if(e.__used__){f._listOfUnusedCellContent.push(e);e.__used__=false;if(d){console.log("dispose id: "+f._identifier+" nb unused: "+f._listOfUnusedCellContent.length)}}},destroy:function(){e.component.destroy()}};return this}function a(e){this._identifier=e.id;this._buildContent=e.buildContent;this._listOfUnusedCellContent=[];return this}a.prototype.use=function(){var e;if(this._listOfUnusedCellContent.length===0){e=new c(this);if(d){console.log("create new id: "+this._identifier+" nb unused: "+this._listOfUnusedCellContent.length)}}else{e=this._listOfUnusedCellContent.pop();if(d){console.log("re-use id: "+this._identifier+" nb unused: "+this._listOfUnusedCellContent.length)}}e.__used__=true;return e};a.prototype.disposeUnusedContents=function(){var e=this._listOfUnusedCellContent.pop();while(e){e.component.__disposable__.destroy();e=this._listOfUnusedCellContent.pop()}this._listOfUnusedCellContent=null};a.prototype.destroy=function(){this.disposeUnusedContents();this._buildContent=null};function b(){this._poolOfReusableContent={}}b.prototype.register=function(e){e=UWA.extend({id:null,buildContent:function(){}},e);if(this._poolOfReusableContent[e.id]){this._poolOfReusableContent[e.id].destroy()}this._poolOfReusableContent[e.id]=new a(e)};b.prototype.isRegistered=function(e){return this._poolOfReusableContent[e]!==undefined};b.prototype.use=function(e){var f=this._poolOfReusableContent[e].use();return f};b.prototype.disposeUnusedContents=function(){for(var e in this._poolOfReusableContent){this._poolOfReusableContent[e].disposeUnusedContents()}};b.prototype.destroy=function(){for(var e in this._poolOfReusableContent){this._poolOfReusableContent[e].destroy()}};return b});define("DS/Utilities/Xml",["UWA/Core","UWA/Event"],function(c,b){var a={toJson2:function(f){var l={};if(f.nodeType==1){if(f.attributes.length>0){l["@attributes"]={};for(var e=0;e<f.attributes.length;e++){var k=f.attributes.item(e);l["@attributes"][k.nodeName]=k.nodeValue}}}else{if(f.nodeType==3){l=f.nodeValue}}if(f.hasChildNodes()){for(var g=0;g<f.childNodes.length;g++){var h=f.childNodes.item(g);var m=h.nodeName;if(typeof(l[[m]])==="undefined"){l[[m]]=a.toJson(h)}else{if(typeof(l[[m]].push)==="undefined"){var d=l[[m]];l[[m]]=[];l[[m]].push(d)}l[[m]].push(a.toJson(h))}}}return l},toJson:function(l){var h={};if(l.nodeType==1){h["@tag"]=l.nodeName;if(l.attributes.length>0){h["@attributes"]={};for(var g=0;g<l.attributes.length;g++){var d=l.attributes.item(g);h["@attributes"][d.nodeName]=d.nodeValue}}}else{if(l.nodeType==3){if(l.nodeValue){h=l.nodeValue}}}if(l.hasChildNodes()){for(var k=0;k<l.childNodes.length;k++){var n=l.childNodes.item(k);var m=n.nodeName;if(typeof(h["@children"])==="undefined"){var e=a.toJson(n);if(e&&n.nodeType!==8){h["@children"]=[];h["@children"].push(e)}}else{if(typeof(h["@children"].push)==="undefined"){var f=h["@children"];h["@children"]=[];h["@children"].push(f)}var e=a.toJson(n);if(e&&n.nodeType!==8){h["@children"].push(e)}}}}if(l.nodeType!==3){return h}}};return a});define("WebUX/WebUX",[],function(){return new Object()});define("DS/Decorator/DecoratorManager",["UWA/Core","UWA/Class"],function(e,c){var a;var b;var d=c.singleton({defaultOptions:{},init:function(f){this._parent(f);this._decorator=null;this._widget=null;this._mapNamesDecorators={}},showDecorator:function(i,f){this._widget=i;if(this._decorator){this._decorator.hide(true)}if(this._mapNamesDecorators[i.name]===undefined){var h=this;var g=i.name.substring(0,1).toUpperCase()+i.name.substring(1,i.name.length);require(["DS/Decorator/"+g+"Decorator"],function(j){h._decorator=new j({decoratedWidget:f,widget:i});h._mapNamesDecorators[i.name]=h._decorator})}else{this._decorator=this._mapNamesDecorators[i.name];this._decorator.setProperties({decoratedWidget:f,widget:i});this._decorator.show()}},hideDecorator:function(f,g){if(this._widget&&(this._widget.getContent().getAttributeNode("focused")===null||g)){this._decorator.hide(f)}},getWidget:function(){return this._widget},getDecorator:function(){return this._decorator},isDecoratorDisplayed:function(){return this._decorator&&this._decorator.visibleFlag},_createDecorator:function(h,f){this._widget=h;var g="Old"+h.name.substring(0,1).toUpperCase()+h.name.substring(1,h.name.length);var i="DS/Decorator/"+g+"Decorator";if(a!==undefined){a.hide()}if(h.name==="spinBox"){require([i],function(j){b=new j({decoratedWidget:f,widget:h});if(!a||a&&!a.visibleFlag){a=b.createPopupWithDecorator()}})}},removeDecorator:function(){if(a&&a.visibleFlag&&this.getWidget()&&this.getWidget().getContent().getAttributeNode("focused")===null&&a.getContent().getAttributeNode("focused")===null){a.hide();b.removePopupWithDecorator()}},forceRemoveDecorator:function(){if(a&&a.visibleFlag&&this.getWidget()){a.hide();b.removePopupWithDecorator()}},getInstance:function(){return a}});return d});define("DS/TreeModel/DataModelSet",["DS/CoreEvents/ModelEvents"],function(d){var c=-1;function a(e){this._id=c++;this._setData(e);this._modelEvents=new d({target:this})}a.prototype._getData=function(e){return this._data};a.prototype._setData=function(e){this._data=e};a.prototype._getID=function(){return this._id};a.prototype._getDataModelSet=function(){return this._dataModelSet};a.prototype._getModelEvents=function(){return this._modelEvents};a.prototype._setDataModelSet=function(e){this._dataModelSet=e};a.prototype._getInfos=function(){return{}};a.prototype.update=function(e){if(e!==undefined){UWA.extend(this._data,e,true)}this._modelEvents.publish({event:"DataModel:update",data:e,context:this})};function b(){this._listOfDataModels={}}b.prototype.getDataModel=function(e){return this._listOfDataModels[e]};b.prototype.createDataModel=function(e){var f=new a(e);f._setDataModelSet(this);this._listOfDataModels[f._getID()]=f;return f};return b});define("DS/Utilities/TreeUtils",["UWA/Core","DS/Utilities/Array"],function(c,b){var a={processTreeChildren:function(d,f){var e=this;if(!d||!f){return}b.optimizedForEach(d,function(g){if(g&&g.children){e.processTreeChildren(g.children,f)}f(g)})},computeMaxDepth:function(d,g){if(g===undefined){g=1}var f=g;for(var e=0;e<d.length;e++){var j=d[e];if(j&&j.children){var h=this.computeMaxDepth(j.children,g+1);if(f<h){f=h}}}return f},countItem:function(d){var e=0;this.processTreeChildren(d,function(f){e++});return e},parentChildren:function(d,f){for(var e=0;e<d.length;e++){var g=d[e];if(f){g._parent=f}if(g.children){this.parentChildren(g.children,g)}}},checkTreeConsistency:function(d,g){var e=true;for(var f=0;f<d.length;f++){var h=d[f];if(g&&h._parent!==g){console.warn("_parent property is not correct for child: "+h.dataIndex);e=false}if(h.children){this.checkTreeConsistency(h.children,h)}}return e},addChild:function(e,f,d){if(e&&f){if(!e.children){e.children=[]}e.children.splice(d,0,f);f._parent=e}},cloneTree:function(d){var e=[];for(var f=0;f<d.length;f++){var h=d[f];var g=c.clone(h,false);e.push(g);if(h.children){g.children=this.cloneTree(h.children)}}this.parentChildren(e);return e},getLeafItems:function(d){var f=[];if(d){var e=d;if(!Array.isArray(e)){e=d.children}if(e){this.processTreeChildren(e,function(g){if(g&&!g.children){f.push(g)}})}else{f.push(d)}}return f},createBalancedTree:function(k,m,p){var o=this;var n=false;if(m===undefined){m=1;n=true}if(p===undefined){p=this.computeMaxDepth(k,m)}var q=[];for(var h=0;h<k.length;h++){var e=k[h];var f=e.children?(this.computeMaxDepth(e.children)+1):1;var l=e;if(e.children){l=c.clone(e,false);l._parent=null;l.children=this.createBalancedTree(e.children,m+p-f+1,p)}if(m+f-1<p){for(var g=p;g>=m+f;g--){var d={children:[l]};l=d}}q.push(l)}if(n){this.parentChildren(q)}return q},computeItemsByDepth:function(f){var e=[];function d(h,g,k){for(var j=0;j<h.length;j++){var l=h[j];if(l){if(l.children){d(l.children,g,k+1)}if(!g[k]){g[k]=[]}g[k].push(l)}}}d(f,e,0);return e},getParents:function(f){var d=[];while(f){var e=f._parent;if(e){d.unshift(e)}f=e}return d},getCommonParent:function(g,e){var j=null;if(g&&e){var f=this.getParents(g);var d=this.getParents(e);for(var h=0;h<f.length;h++){if(f[h]===d[h]){j=f[h]}else{break}}}return j},getIndexInRootParent:function(f,h){var d=-1;if(f&&h){var g=f;var e=f._parent;while(e){if(e===h){if(Array.isArray(e)){d=e.indexOf(g)}else{d=e.children.indexOf(g)}break}g=e;e=e._parent}if((d<0)&&Array.isArray(h)){d=h.indexOf(g)}}return d},extractItemHierarchy:function(j,i,e){var h=j;if(j){var f=j._parent;if(f){var d=f.children.indexOf(j);if(d>-1){if((f.children.length>1)||(f===i)){if(e){f.children.splice(d,1);h._parent=null}while(f&&(f!==i)){var g=c.clone(f,false);g._parent=null;g.children=[h];h._parent=g;h=g;f=f._parent}}else{h=this.extractItemHierarchy(f,i,e)}}}else{if(i&&Array.isArray(i)){var d=i.indexOf(j);if(d>-1){i.splice(d,1)}}}}return h},splitParentAtItemIndex:function(d,n,j){if(d){var l=d._parent;if(l){var h=l.children.indexOf(d);if(j==="after"){h++}if((h>-1)&&(l!==n)){if((h>0)&&(l.children.length>1)&&(h<l.children.length)){var m=l.children.splice(h,l.children.length-h);var k=c.clone(l,false);if(k._parent){k._parent=null}k.children=m;for(var g=0;g<m.length;g++){m[g]._parent=k}var f=l._parent;if(f){var e=f.children.indexOf(l);this.addChild(f,k,e+1)}else{if(n&&Array.isArray(n)){var e=n.indexOf(l);n.splice(e+1,0,k);return}}if(j!=="after"){l=k}}this.splitParentAtItemIndex(l,n,j)}}}}};return a});var WUXDockAreaEnum={NoneDockArea:0,TopDockArea:1<<0,BottomDockArea:1<<1,LeftDockArea:1<<2,RightDockArea:1<<3};Object.freeze(WUXDockAreaEnum);var WUXManagedFontIcons={FontAwesome:0,Font3DS:1};Object.freeze(WUXManagedFontIcons);define("DS/Core/Core",["css!DS/Core/wux.css","css!DS/Core/wux-3ds-fonticons.css","DS/WebappsUtils/WebappsUtils","UWA/Core","UWA/Event","UWA/Class","DS/Core/PointerEvents","UWA/Controls/Abstract","DS/UIBehaviors/TooltipManager","UWA/Class/Promise","DS/Utilities/TouchUtils"],function(y,l,h,i,B,v,k,u,e,g,c){var n;var x=5.5;var d=200;var m=false;var t="1.1.4";function A(D,C){if(!C){C=window.location.href}D=D.replace(/[\[\]]/g,"\\$&");var F=new RegExp("[?&]"+D+"(=([^&#]*)|&|#|$)"),E=F.exec(C);if(!E){return null}if(!E[2]){return""}return decodeURIComponent(E[2].replace(/\+/g," "))}function b(C,F){if(F===undefined){F=0}var E="";for(var G in C){var D=C[G]&&C[G].toString?C[G].toString():C[G];E=E+"\r"+G+": "+D+","}F++;E="{"+E+"\r }";return E}var f=u.singleton({defaultOptions:{},init:function(C){this._parent(C);this._buildView()},_buildView:function(){var C=this;this.elements.container=new i.Element("div",{styles:{position:"absolute",top:0,width:0,right:0,bottom:0,borderLeft:"1px solid silver",background:"white",fontFamily:"consolas",overflow:"hidden",zIndex:100000,boxShadow:"0px 1px 5px #CCC"}});this.elements.titleContainer=new i.Element("div",{html:"Console",styles:{width:"100%",background:"#358EC4",color:"white",padding:5,position:"relative"}}).inject(this.elements.container);this.elements.emptyConsole=new i.Element("div",{styles:{background:"url("+h.getWebappsBaseUrl()+"Core/assets/icons/trash.png)",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:20,height:16,position:"absolute",top:3,right:10}}).inject(this.elements.titleContainer);this.elements.emptyConsole.addEvent(k.POINTERUP,function(){C.elements.console.empty()});this.elements.console=new i.Element("div",{styles:{padding:5}}).inject(this.elements.container)},_pushMessage:function(I,E){var D="black";var M="white";var G="silver";switch(E){case"log":D="#999";M="white";G="#EBEAE9";break;case"warn":D="#F07E00";M="#FEF5D3";G=D;break;case"info":D="#1DBCDE";M="#E9FDFE";G=D;break}var H=new Date();var J=H.getHours();var F=H.getMinutes();var K=H.getSeconds();var L=new i.Element("div",{html:I,styles:{textAlign:"left",padding:"2px 5px",marginBottom:10,color:D,borderRadius:2,border:"1px solid "+G,background:M}}).inject(this.elements.console,"top");var C=new i.Element("div",{html:J+":"+F+":"+K,styles:{fontSize:9,padding:"2px 5px",marginBottom:0,color:"silver",textAlign:"right"}}).inject(L,"top")},_prettyPrint:function(D){D=Array.prototype.slice.call(D);var C="";D.forEach(function(E){if(i.typeOf(E)==="[object Object]"||i.typeOf(E)==="object"){var F=b(E);C=C+" "+F}else{C=C+" "+E}});return C},addButton:function(C){var D=new i.Element("div",{html:C.label,events:C.events,"class":"wux-controls-button"}).inject(this.elements.console,"bottom")},log:function(){this._pushMessage(this._prettyPrint(arguments),"log")},warn:function(C){this._pushMessage(this._prettyPrint(arguments),"warn")},info:function(C){this._pushMessage(this._prettyPrint(arguments),"info")}});var p=function(){var C=document.getElementsByTagName("SCRIPT");var E="";if(C&&C.length>0){for(var D in C){if(C[D].src&&C[D].src.match(/WUX\/Core\.js$/)){E=C[D].src.replace(/(.*)WUX\/Core\.js$/,"$1")}}}return E};var a=v.singleton({options:{debug:{enabled:false,fullscreen:false,logLevel:false}},init:function(){this._parent();w()},getVersion:function(){return x},isDebug:function(){return this.options.debug.enabled},enableWUXConsole:function(){m=true;f.getContent().setStyles({width:d});document.body.appendChild(f.getContent())},disableWUXConsole:function(){m=false},isWUXConsoleEnabled:function(){return m},getWUXConsole:function(){return f},setFullscreen:function(){s(h.getWebappsBaseUrl()+"Controls/nv-patch.css");console.warn("==========================================================================");console.warn("WUX.setFullscreen() is for debug purpose only! DO NOT use in production...");console.warn("==========================================================================");if(this.options){this.options.debug.fullscreen=true}var C=i.extend(document.querySelector(".module"));if(C){C.setStyles({position:"absolute",top:0,width:"auto",left:0,right:m?d:0,bottom:0})}},enableFullscreen:function(){this.setFullscreen()},disableFullscreen:function(){o(h.getWebappsBaseUrl()+"Controls/nv-patch.css");var C=i.extend(document.querySelector(".module"));if(C){C.setStyles({position:"",top:"",width:"",left:"",right:"",bottom:""})}},isFullscreen:function(){if(this.options){return this.options.debug.fullscreen}},setLogLevel:function(C){if(this.options){this.options.debug.logLevel=C}},info:function(C){},log:function(C,D){if(D===undefined){D=0}if(this.options){if(this.options.debug.logLevel&&D<=this.options.debug.logLevel){console.log("["+this.options.debug.logLevel+"] : %o",C)}}},warn:function(C,D){if(D===undefined){D=0}if(this.options){if(this.options.debug.logLevel&&D<=this.options.debug.logLevel){console.warn("["+this.options.debug.logLevel+"] : %o",C)}}},warnDev:function(C,D){console.warn("["+C+"] - "+D)},getLocalization:function(){if(window.widget){return window.widget.lang}else{if(navigator){if(navigator.language){return navigator.language}else{if(navigator.languages){return navigator.languages[0]}else{return"en"}}}else{return"en"}}},onlanguagechange:function(C){j.addEvent("onlanguagechange",C)},offlanguagechange:function(C){j.removeEvent("onlanguagechange",C)},POLYMER_ENABLED:Boolean(A("WUX_POLYMER_ENABLED"))});var j=new i.Class.Events();function s(C){n=document.createElement("link");n.type="text/css";n.rel="stylesheet";n.href=C;document.getElementsByTagName("head")[0].appendChild(n)}function r(C){n=document.createElement("link");n.rel="import";n.href=C;document.getElementsByTagName("head")[0].appendChild(n)}function z(C){n=document.createElement("script");n.type="text/JavaScript";n.src=C;document.getElementsByTagName("head")[0].appendChild(n)}function o(D){var E=i.extendElement(document);var C=document.querySelector('link [href="'+D+'"]');i.extendElement(n).destroy()}function w(){var C=a.getLocalization();Object.defineProperty(window.WUX,"currentLanguage",{get:function(){return C},set:function(D){C=D;j.dispatchEvent("onlanguagechange")}})}a.PointerEvents=k;k.enable();a.TooltipManager=e;e.enable();c.init();if(a.POLYMER_ENABLED){z("../Polymer-"+t+"/webcomponents-lite.js");r("../Polymer-"+t+"/polymer.html");window.Polymer=window.Polymer||{};window.Polymer.dom="shadow"}function q(C){return new g(function(E,D){require(C,function(F){E(F)},function(F){D(F)})})}a.startUnsafeHTMLDisplay=function(){var C=[];C.push(q(["DS/Developer/UnsafeHTMLDisplay"]));g.all(C).then(function(D){D[0].startUnsafeHTMLDisplay()})["catch"](function(D){console.error("There were an error on startUnsafeHTMLDisplay call")})};a.stopUnsafeHTMLDisplay=function(){var C=[];C.push(q(["DS/Developer/UnsafeHTMLDisplay"]));g.all(C).then(function(D){D[0].stopUnsafeHTMLDisplay()})["catch"](function(D){console.error("There were an error on stopUnsafeHTMLDisplay call")})};return i.namespace("WUX",a,window,true)});define("DS/Developer/ReleaseNotes",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/WebappsUtils/WebappsUtils"],function(f,a,e,d,c){var b=e.extend({defaultOptions:{file:"assets/ReleaseNotes.json"},init:function(g){this._parent(g);this._buildView()},_buildView:function(){var h=this;var g=c.getWebappsBaseUrl()+this.options.file;this.elements.container=f.Element("div",{"class":"wux-ReleaseNotes"});f.Ajax.request(g,{type:"json",cors:true,onComplete:function(i){i=f.Json.decode(i);i.versions.forEach(function(j){var k=new f.Element("h1",{html:"Version "+j.number});var l=new f.Element("div",{html:k,styles:{fontSize:24,marginBottom:20,margin:"0 40px"}});j.updates.forEach(function(s){var o;switch(s.type){case"add":o={html:"+",styles:{backgroundColor:"#7BE02C"}};break;case"update":o={html:"!",styles:{backgroundColor:"#FFB810"}};break;case"remove":o={html:"-",styles:{backgroundColor:"F86084"}};break}var m={styles:{borderRadius:10,width:14,height:14,lineHeight:"14px",verticalAlign:"center",padding:2,display:"inline-block",textAlign:"center",color:"black",marginRight:10,border:"1px solid white",fontWeight:"bold"}};f.extend(m,o,true);var p=new f.Element("div",m);var q=new f.Element("span",{html:"- "+s.desc});var n=new f.Element("div",{html:[p,q],styles:{fontSize:14,lineHeight:"20px",marginLeft:40,marginBottom:8}});n.inject(l);var r=new f.Element("div",{styles:{fontSize:12,minHeight:40,marginLeft:40}}).inject(l);if(s.classes){s.classes.forEach(function(t){var u=new f.Element("span",{"class":"wux-showroom-keywords-class",html:t});u.inject(r)})}});h.elements.container.addContent(l)})}})}});return b});define("DS/Controls/ModalContainer",["UWA/Core","DS/Core/Core"],function(c,b){var a={createModal:function(f,g){var e=window.getComputedStyle(f);if(e.getPropertyValue("position")==="static"){throw ("The given container is not positionned. Please position your container before creating a modalContainer on it.");return}f.classList.add("modalElement");var d=c.createElement("div",{"class":"wux-controls-modalContainer"});if(c.is(g,"element")){g=new c.extendElement(g)}g.classList.add("wux-controls-modalContent");g.inject(d);d.inject(f)},removeModal:function(g){var d,f;if(c.is(g,"element")){g=new c.extendElement(g)}var h=g.getChildren();if(h.length>0){for(var e=0;e<h.length;e++){if(h[e].classList.contains("wux-controls-modalContainer")){d=h[e];break}}}if(d){f=d.getElement(".wux-controls-modalContent");if(f){f.classList.remove("wux-controls-modalContent")}d.destroy()}g.classList.remove("modalElement")}};return a});define("DS/Utilities/Utils",["UWA/Core","UWA/Event","UWA/Class","DS/Core/Core","DS/Utilities/Polymer"],function(f,a,b,e,d){var c={extend:function(h,g){h=f.extend(h,g);return h},listToArray:function(g){var k=[];for(var h=0,j=g.length;h<j;h++){if(g[h].nodeType===1){k.push(g[h])}}return k},$_:function(g,i){if(i===undefined){i=document}if(i!==document&&!i.id){i.id=(new Date()).getTime()}var h=[];g="#"+i.id+" "+g;try{h=this.listToArray(i.querySelectorAll(g))}catch(j){alert(g.slice(j.position)+"is not a valid selector")}return h},triggerEvent:function(i,h){if("fireEvent" in i){i.fireEvent(h)}else{var g=document.createEvent("HTMLEvents");g.initEvent(h,false,true);i.dispatchEvent(g)}},getPosition:function(h){var g=0;var i=0;if(h&&h.style){g=h.style.left;i=h.style.top}if(g===""){g=0}else{g=parseInt(g,10)}if(i===""){i=0}else{i=parseInt(i,10)}return{x:g,y:i}},getPositionRelativeToOffsetParent:function(k,m){var A={x:0,y:0};if(k&&m){var r="center";var s="center";var t=document.body;var y=0;var x=0;var n="none";if(m.my){r=m.my}if(m.at){s=m.at}if(m.offsetX){y=m.offsetX}if(m.offsetY){x=m.offsetY}if(m.of){t=m.of}if(m.collision){n=m.collision}var q=null;if(k.getContent){q=k.getContent().getBoundingClientRect()}else{q=k.getBoundingClientRect()}var z=(f.is(t,"element"))?f.extendElement(t):t.getContent();var p=z.getPosition(document.body);var u=z.getBoundingClientRect();if(s.indexOf("left")>-1){A.x=p.x}else{if(s.indexOf("right")>-1){A.x=p.x+u.width}else{A.x=p.x+(u.width/2)}}if(s.indexOf("top")>-1){A.y=p.y}else{if(s.indexOf("bottom")>-1){A.y=p.y+u.height}else{A.y=p.y+(u.height/2)}}if(r.indexOf("left")>-1){}else{if(r.indexOf("right")>-1){A.x-=q.width}else{A.x-=(q.width/2)}}if(r.indexOf("top")>-1){}else{if(r.indexOf("bottom")>-1){A.y-=q.height}else{A.y-=(q.height/2)}}A.x+=y;A.y+=x;if(n==="fit"){var w=document.documentElement.clientWidth||window.innerWidth;var l=document.documentElement.clientHeight||window.innerHeight;var j=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;var v={x:0,y:0};var o={width:w,height:l};var h=m.constraint;if(h instanceof Element){v=h.getPosition(document.body),o=h.getSize()}if(A.x+q.width>v.x+o.width){A.x=v.x+o.width-q.width}if(A.x<v.x){A.x=v.x}if(A.y+q.height>v.y+o.height){A.y=v.y+o.height-q.height;if(A.y+q.height>l+j){A.y=l+j-q.height}}if(A.y<v.y){A.y=v.y}}var g=null;if(k.getContent){g=k.getContent().getOffsetParent()}else{g=k.getOffsetParent()}if(g){var i=g.getPosition(document.body);A.x-=i.x;A.y-=i.y}}return A},setPosition:function(j,i){var h=false;if(j&&i){var g=c.getPositionRelativeToOffsetParent(j,i);var l=(typeof j.getContent==="function"&&j.getContent())?j.getContent():j;var k=this.getPosition(l);if((k.x!=g.x)||(k.y!=g.y)||(!l.getStyle("left")&&!l.getStyle("top"))){l.setStyles({left:g.x,top:g.y});h=true}}return h},setConstrainedPosition:function(l,K,p){var M=function(t){if(t){return{x:t.x,y:t.y}}return{x:0,y:0}};if(!K||!l){return}var z;(f.is(K,"element"))?z=f.extendElement(K):z=K.getContent();if(!z){return}var B=p.mouseRelativePosition,H=p.mouseOffset||{x:0,y:0},L=B?M(p.mousePosition):z.getPosition(document.body),w=B?M(p.mousePosition):z.getPosition(document.body),n=B?{height:2*H.y,width:2*H.x}:z.getSize(),A=l.getContent().getSize(),C=p.position||"right",u=p.alignment||"near",D=0,r=p.offset||{x:0,y:0},G=document.documentElement.clientWidth||window.innerWidth,o=document.documentElement.clientHeight||window.innerHeight,k=B?window.pageYOffset||document.documentElement.scrollTop:0;var F=B?window.pageXOffset||document.documentElement.scrollLeft:0;var I=this.getComputedTranslateXY(document.body);if(I.length===2){L.x-=I[0];L.y-=I[1];w.x-=I[0];w.y-=I[1]}if(B){L.x-=H.x;L.y-=H.y;w.x-=H.x;w.y-=H.x}if(C.indexOf("top")>-1){L.y-=A.height}else{if(C.indexOf("bottom")>-1){L.y+=n.height}else{if(C.indexOf("left")>-1){L.x-=A.width;D=1}else{if(C.indexOf("right")>-1){L.x+=n.width;D=1}}}}if(u.indexOf("center")>-1){(D===1)?L.y+=(n.height-A.height)/2:L.x+=(n.width-A.width)/2}else{if(u.indexOf("far")>-1){(D===1)?L.y+=n.height-A.height:L.x+=n.width-A.width}}var r=l.offset;if(r){L.x+=r.x;L.y+=r.y}L.x+=parseInt(z.getStyle("marginLeft"),10);L.y+=parseInt(z.getStyle("marginTop"),10);var E={x:0,y:0},s={width:G,height:o};var h=p.constraint||"none";if(h instanceof Element){E=h.getPosition(document.body);s=h.getSize()}if(h instanceof Element||h==="screen"){var j=B?k:window.pageYOffset||document.documentElement.scrollTop;var y=B?F:window.pageXOffset||document.documentElement.scrollLeft;L.x=Math.max(L.x+F,E.x,F);if(L.x+A.width>E.x+s.width+y){L.x=E.x+s.width+y-A.width}L.y=Math.max(L.y+k,E.y,k);if(L.y+A.height>E.y+s.height+j){L.y=E.y+s.height+j-A.height;if(L.y+A.height>o+j){L.y=o+j-A.height}}}var g=p.overlap||false;if(g===false){var m=false;if(D===0){if(C.indexOf("top")>-1){if((L.y+A.height>w.y||L.y<0)&&w.y+n.height+r.y+A.height<E.y+s.height){L.y=w.y+n.height+r.y}else{if(L.y+A.height>w.y||L.y<0){m=true}}}else{if(C.indexOf("bottom")>-1){if(L.y<w.y+n.height&&w.y-A.height-r.y>E.y){L.y=w.y-A.height-r.y}else{if(L.y<w.y+n.height){m=true}}}}}else{if(C.indexOf("left")>-1){if((L.x<0)||L.x+A.width>w.x&&w.x+n.width+r.x+A.width<E.x+s.width){L.x=w.x+n.width+r.x}else{if((L.x<0)||L.x+A.width>w.x){m=true}}}else{if(C.indexOf("right")>-1){if((L.x>document.body.getDimensions().width)||L.x<w.x+n.width&&w.x-A.width-r.x>E.x){L.x=w.x-A.width-r.x}else{if((L.x>document.body.getDimensions().width)||L.x<w.x+n.width){m=true}}}}}var q=undefined;if(m){var i=0,v=0,J=0,x=0;i=w.x;v=w.x+n.width;x=w.y;J=w.y+n.height;q={left:i,right:(E.x+s.width)-v+r.x,bottom:(E.y+s.height)-J+r.y,top:x}}}l.getContent().setStyles({left:Math.round(L.x),top:Math.round(L.y)});return{position:L,targetPosition:w,availableSpaceAroundTargetIfOverlaping:q}},getOffset:function(i){var h=0;var g=0;while(i&&!isNaN(i.offsetLeft)&&!isNaN(i.offsetTop)){h+=i.offsetLeft-i.scrollLeft;g+=i.offsetTop-i.scrollTop;i=i.offsetParent}return{top:g,left:h}},getMouseCoord:function(g){if(g){var h=e.Utils.getOffset(g);return{x:event.pageX-h.left,y:event.pageY-h.top}}else{return{x:event.pageX,y:event.pageY}}},matrixToArray:function(g){return g.substr(7,g.length-8).split(", ")},rectContains:function(h,g){return Boolean((g.x>=h.left)&&(g.x<h.left+h.width)&&(g.y>=h.top)&&(g.y<h.top+h.height))},getComputedTranslateXY:function(j){var k=[];if(!window.getComputedStyle){return}var i=getComputedStyle(j),g=i.transform||i.webkitTransform||i.mozTransform||i.msTransform;var h=g.match(/^matrix3d\((.+)\)$/);if(h){return parseFloat(h[1].split(", ")[13])}h=g.match(/^matrix\((.+)\)$/);h?k.push(parseFloat(h[1].split(", ")[4])):k.push(0);h?k.push(parseFloat(h[1].split(", ")[5])):k.push(0);return k},getTranslationTest:function(h){var g=h.style.webkitTransform.match(/matrix(?:(3d)\(\d+(?:, \d+)*(?:, (\d+))(?:, (\d+))(?:, (\d+)), \d+\)|\(\d+(?:, \d+)*(?:, (\d+))(?:, (\d+))\))/);if(!g){return[0,0,0]}if(g[1]==="3d"){return g.slice(2,5)}g.push(0);return g.slice(5,8)},_translate3DToArray:function(h){if(h){var g=/([0-9-]+)+(?![3d]\()/gi;return h.toString().match(g)}else{return new e.Types.Maths.Vector3()}},_translate3DToObject:function(i){if(i){var h=/([\+\-]?[0-9]+([\.\,][0-9]+)?)+(?![3d]\()/gi,g=i.toString().match(h);if(g&&g.length){return new e.Types.Maths.Vector3([parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2])])}else{return new e.Types.Maths.Vector3()}}else{return new e.Types.Maths.Vector3()}},getTranslation:function(g){return c._translate3DToObject(g.style.webkitTransform)},_sumObjects:function(k,j){var g=0;for(var h=0;h<arr1.length;h++){result+=(arr1[h]*arr2[h])}},translate:function(h,g){return e.Utils.getTranslation(h).add(g)},_getTranslateCoordinate:function(j,l){j=j.toString();var h=0,i=/([0-9-]+)+(?![3d]\()/gi,g=j.match(i);if(g.length){var k=l==="x"?0:l==="y"?1:2;h=parseFloat(g[k])}return h},clamp:function(h,g,i){return Math.min(Math.max(h,i),g)},decimalPlaces:function(h){var g=(String(h)).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!g){return 0}return Math.max(0,(g[1]?g[1].length:0)-(g[2]?Number(g[2]):0))},round:function(i,h){h=h||1;var j=Math.round(i/h)*h;var g=this.decimalPlaces(h);return j.toFixed(g)},isNumber:function(g){return !isNaN(parseFloat(g))},getXSSDefaultBehavior:function(){if(!c._XSSDefaultBehavior){if(typeof localStorage!=="undefined"){var g=localStorage.getItem("WebUX_XSS");if(g==="safe"){c._XSSDefaultBehavior="safe"}else{if(g==="unsafe"){c._XSSDefaultBehavior="unsafe"}}}if(!c._XSSDefaultBehavior){c._XSSDefaultBehavior="default"}}return c._XSSDefaultBehavior},getUnsafeHTMLContentValueToApply:function(g){if(g===undefined){return(c.getXSSDefaultBehavior()==="safe"?false:true)}else{return g}},generateMixin:function(h){var g=h;var j=b.extend({});for(var i in g){(function(k){Object.defineProperty(j.prototype,k,{get:function(){if(this._properties&&this._properties[k]){return this._properties[k].value}},enumerable:true,configurable:true})})(i);if(g[i].readOnly!==true){(function(n){var m=n.substring(0,1).toUpperCase()+n.substring(1,n.length);var o="_apply"+m;if(g[n].advancedSetter!==true){Object.defineProperty(j.prototype,n,{set:function(q){if(this._properties&&this._properties[n]&&(Array.isArray(this._properties[n].value)?f.equals(this._properties[n].value,q):this._properties[n].value===q)){return}var p;if(this._properties[n]){p=this._properties[n].value;this._properties[n].value=q}else{this._properties[n]={value:q}}this._propertyChanged(n,p,q);if(!this.publishedProperties[n].noNeedToApplyFlag){this._properties[n].dirty=true;if(this[o]){this[o](p,q)}else{var r={};r[n]=p;this._applyProperties(r)}this._properties[n].dirty=false}}})}else{var l="_preEdit"+m;var k="_postEdit"+m;Object.defineProperty(j.prototype,n,{set:function(q){var p;if(this._properties[n]){p=this._properties[n].value}if(this[l]){if(this[l](p,q)===false){return}}if(this._properties&&this._properties[n]&&(Array.isArray(this._properties[n].value)?f.equals(this._properties[n].value,q):this._properties[n].value===q)){if(this[k]){this[k](p,q)}return}if(this._properties[n]){this._properties[n].value=q}else{this._properties[n]={value:q}}this._propertyChanged(n,p,q);if(!this.publishedProperties[n].noNeedToApplyFlag){this._properties[n].dirty=true;if(this[o]){this[o](p,q)}else{var r={};r[n]=p;this._applyProperties(r)}this._properties[n].dirty=false}if(this[k]){this[k](p,q)}}})}})(i)}}return j},baseInherit:function(h){var g=c.inheritUtils(this,h);g.prototype.getModel=function(){return this};g.inherit=c.inherit;return g},applyMixin:function(j,g){if(typeof j!=="function"||typeof g!=="function"){throw new Error("parameters must be constructors (i.e. functions)")}var h,i;h=g.prototype;i=j.prototype;Object.keys(h).forEach(function(k){Object.defineProperty(i,k,Object.getOwnPropertyDescriptor(h,k))})},inheritUtils:function(h,i){var g=h.extend(i);c.applyMixin(g,c.generateMixin(i.publishedProperties));return g},inherit:function(g){if(!e.POLYMER_ENABLED){return c.baseInherit.call(this,g)}else{if(g.name===undefined||g.name==="abstract"){return c.baseInherit.call(this,g)}else{return d.polymerize.call(this,g,c)}}},debounce:function(h,j,g){var i;return function(){var n=this,m=arguments;var l=function(){i=null;if(!g){h.apply(n,m)}};var k=g&&!i;clearTimeout(i);var o;if(typeof j==="function"){o=j()}else{o=j}i=setTimeout(l,o);if(k){h.apply(n,m)}}},throttle:function(j,g){var h;var i;return function(){var m=this;var l=Number(new Date());var k=arguments;if(h&&l<h+g){clearTimeout(i);i=setTimeout(function(){h=l;j.apply(m,k)},g)}else{h=l;j.apply(m,k)}}},browserIsIE:function(){var i=window.navigator.userAgent;var h=i.indexOf("MSIE ");if(h>0){return parseInt(i.substring(h+5,i.indexOf(".",h)),10)}var g=i.indexOf("Trident/");if(g>0){var k=i.indexOf("rv:");return parseInt(i.substring(k+3,i.indexOf(".",k)),10)}var j=i.indexOf("Edge/");if(j>0){return parseInt(i.substring(j+5,i.indexOf(".",j)),10)}return false},getJsonFromUrl:function(h){var i;if(h){var j=location.href.indexOf("?");if(j==-1){return[]}i=location.href.substr(j+1)}else{i=location.search.substr(1)}var g={};i.split("&").forEach(function(m){if(!m){return}m=m.split("+").join(" ");var k=m.indexOf("=");var n=k>-1?m.substr(0,k):m;var o=k>-1?decodeURIComponent(m.substr(k+1)):"";var q=n.indexOf("[");if(q==-1){g[decodeURIComponent(n)]=o}else{var p=n.indexOf("]");var l=decodeURIComponent(n.substring(q+1,p));n=decodeURIComponent(n.substring(0,q));if(!g[n]){g[n]=[]}if(!l){g[n].push(o)}else{g[n][l]=o}}});return g},getParameterByName:function(h,g){if(!g){g=window.location.href}h=h.replace(/[\[\]]/g,"\\$&");var j=new RegExp("[?&]"+h+"(=([^&#]*)|&|#|$)"),i=j.exec(g);if(!i){return null}if(!i[2]){return""}return decodeURIComponent(i[2].replace(/\+/g," "))},updateQueryStringParameter:function(i,g,j){var h=new RegExp("([?&])"+g+"=.*?(&|$)","i");var k=i.indexOf("?")!==-1?"&":"?";if(i.match(h)){return i.replace(h,"$1"+g+"="+j+"$2")}else{return i+k+g+"="+j}},saveDataInLocalPreferences:function(h,l,i,k){var g="";g=this._getIdForLocalPreferences(h);if(g===""){return false}if(typeof localStorage!=="undefined"){var j=localStorage.getItem(l);if(j){j=JSON.parse(j);if(j[g]){j[g][i]=k}else{j[g]={};j[g][i]=k}}else{j={};j[g]={};j[g][i]=k}}localStorage.setItem(l,JSON.stringify(j))},_getIdForLocalPreferences:function(g){if(g&&(g.identifier)){return g.identifier}else{if(g&&typeof g==="string"){return g}}},getDataFromLocalPreferences:function(h,l,i){var j=undefined;var g="";var g=this._getIdForLocalPreferences(h);if(g&&g!==""&&typeof localStorage!=="undefined"){var k=JSON.parse(localStorage.getItem(l));if(k&&k[g]&&i){j=k[g][i]}}return j},checkPresenceOfPreferences:function(h,j){var g="";g=this._getIdForLocalPreferences(h);if(g===""){return}if(typeof localStorage!=="undefined"){var i=JSON.parse(localStorage.getItem(j));if(i){return true}}return false},deleteDataFromLocalPreferences:function(h,k,i){var g="";g=this._getIdForLocalPreferences(h);if(g===""){return}if(typeof localStorage!=="undefined"){var j=JSON.parse(localStorage.getItem(k));if(j&&j[g]){if(i){delete j[g][i]}else{delete j[g]}if(Object.keys(j).length===0){localStorage.removeItem(k)}else{localStorage.setItem(k,JSON.stringify(j))}}}},isDateInBetween:function(h,g,i,j){if(j==="day"){if(h){if(g<h){return false}}if(i){if(g>i){return false}}}else{if(j==="month"){if(h){if(h.getFullYear()>g.getFullYear()||(h.getFullYear()===g.getFullYear()&&h.getMonth()>g.getMonth())){return false}}if(i){if(i.getFullYear()<g.getFullYear()||(i.getFullYear()===g.getFullYear()&&i.getMonth()<g.getMonth())){return false}}}}return true},sortNumberArray:function(g){var h=function(j,i){return j-i};g.sort(h)},isMouseOverElement:function(h,g){if(h!=undefined){var i=null;if(h.getBoundingClientRect){i=h.getBoundingClientRect()}else{if(h.getContent()!=undefined){i=h.getContent().getBoundingClientRect()}}return Boolean((g.x>=i.left)&&(g.x<i.left+i.width)&&(g.y>=i.top)&&(g.y<i.top+i.height))}},getObjectPropertyInfo:function(i,g){var h=function(j,k,m){var l=typeof m==="object"&&m&&j[k]&&m[j[k]]!==undefined;if(l){if(k===j.length-1){return{valid:true,parent:m,name:j[k],value:m[j[k]]}}return h(j,k+1,m[j[k]])}return{valid:false}};if(g!==undefined&&g!==null){if(g.length){return h(g.split("."),0,i)}else{if(g.length===0){return{valid:true,value:i}}}}return{valid:false}},getObjectPropertyParent:function(i,h){var g=this.getObjectPropertyInfo(i,h);if(g.valid){return g.parent}return null},isPropertyInObject:function(i,h){var g=this.getObjectPropertyInfo(i,h);return Boolean(g.valid&&g.value!==undefined)},removeObjectProperty:function(i,h){var g=this.getObjectPropertyInfo(i,h);if(g.valid&&g.value!==undefined){delete g.parent[g.name];return true}return false},addObjectProperty:function(l,n,m){var j=n.split(".");var h=j[j.length-1];var g="";for(var k=j.length-2;k>=0;k--){g=j[k]+g;if(k!==0){g="."+g}}var o=this.getObjectPropertyInfo(l,g);if(o.value===undefined||o.value===null){this.addObjectProperty(l,g,{});o=this.getObjectPropertyInfo(l,g)}if(o.valid&&o.value[h]===undefined){o.value[h]=m;return true}return false},setObjectProperty:function(i,h,j){var g=this.getObjectPropertyInfo(i,h);if(g.valid){g.parent[g.name]=j;return true}return false},isObjectEmpty:function(g){if(g){for(var h in g){if(g.hasOwnProperty(h)){return false}}return JSON.stringify(g)===JSON.stringify({})}return false},areObjectsEqual:function(i,h){var k,g;if(i&&h){try{k=JSON.stringify(i);g=JSON.stringify(h);return k===g}catch(j){return false}}return false},concatenateObjects:function(j,i){var h={};for(var g in j){if(j.hasOwnProperty(g)){h[g]=j[g]}}for(var g in i){if(i.hasOwnProperty(g)){h[g]=i[g]}}return h},arePrototypesEqual:function(j,i){var k,h=0,g=0;if(j&&i){for(k in j){h++}for(k in i){g++}if(h!==g){return false}for(k in j){if(j[k]===undefined&&i[k]!==undefined||i[k]===undefined&&j[k]!==undefined){return false}}return true}return false},setTweakerProperties:function(k,p,i,g){var o={};var m=k.getPublishedPropertiesDefaultValue();var n=typeof i!=="undefined"&&typeof i.semantics!=="undefined";var j=typeof g!=="undefined"&&typeof g.options!=="undefined";for(var l in m){if(l!=="displayStyle"){var h=m[l];if(p.hasOwnProperty(l)){h=p[l]}else{if(n&&i.semantics.hasOwnProperty(l)){h=i.semantics[l]}else{if(j&&g.options.hasOwnProperty(l)){h=g.options[l]}}}if(k[l]!==h){o[l]=h}}}k.setProperties(o)},spliceString:function(i,j,g,h){return i.slice(0,j)+h+i.slice(j+g,i.length)},equalsToNaN:function(g){if(Number.isNaN===undefined){return typeof(g)==="number"&&isNaN(g)}else{return Number.isNaN(g)}}};return c});define("DS/Utilities/Dom",["UWA/Core","UWA/Utils/Client","DS/Utilities/Utils","DS/Utilities/ReusableContentsManager","DS/WebRecordEnabler/Adapter"],function(g,f,d,c,b){var e=new c();e.register({id:"iframe",buildContent:function(){return new g.Element("iframe",{"class":"wux-ui-is-resized",tabIndex:-1})}});var a={addEndResizeListener:function(k,l,i){if(i===undefined){i=500}var j;var h=d.debounce(function(){l()},i);a.addResizeListener(k,h)},setAttributes:function(j,i){for(var h in i){if((h==="styles"||h==="style")&&typeof i[h]==="object"){a.setStyles(j,i[h])}else{if(h==="html"){j.innerHTML=i[h]}else{j.setAttribute(h,i[h])}}}},setStyles:function(i,k){var j="";for(var l in k){if(k[l]!==undefined){var h=l.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(typeof k[l]==="number"){j+=h+":"+k[l]+"px;"}else{j+=h+":"+k[l]+";"}}}i.style.cssText+=";"+j},empty:function(h){while(h.firstChild){h.removeChild(h.firstChild)}},setContent:function(i,h,j){if(typeof h==="string"){if(d.getUnsafeHTMLContentValueToApply(j)===false){i.textContent=h;i._allowUnsafeHTMLContent=false}else{i.innerHTML=h;i._allowUnsafeHTMLContent=true}}else{a.empty(i);i.appendChild(h)}},createElement:function(h,j){var i=document.createElement(h);a.setAttributes(i,j);return i},hasClass:function(i,h){return(" "+i.className+" ").replace(/[\n\t]/g," ").indexOf(" "+h+" ")>-1},firstParentWithClass:function(i,h){if(i){return(this.hasClass(i,h))?i:this.firstParentWithClass(i.parentNode,h)}},isActiveElementInContainer:function(i){var h=document.activeElement;if(h&&i){while(h&&h!==i){h=h.parentElement}}return h===i},isElementInside:function(j,h){var i=j;while(!(!i||i===document.body.parentElement)){if(i===h){return true}else{i=i.parentElement}}return false},onNodeResized:function(h,i){if(attachEvent){h.attachEvent("onresize",i)}else{if(!h.__resizeTriggers__){if(getComputedStyle(h).position=="static"){h.style.position="relative"}createStyles();h.__resizeLast__={};h.__resizeListeners__=[];(h.__resizeTriggers__=document.createElement("div")).className="resize-triggers";h.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>';h.appendChild(h.__resizeTriggers__);resetTriggers(h);h.addEventListener("scroll",scrollListener,true)}h.__resizeListeners__.push(i)}},onNodeRendered:function(i,j){var h=function(k){if(k.animationName=="nodeIsRendered"){if(i===k.target||(window.Polymer&&(k.target.hasChildNodes(i)))){j()}}};i.addEventListener("animationstart",h,false);i.addEventListener("MSAnimationStart",h,false);i.addEventListener("webkitAnimationStart",h,false);g.extendElement(i).addClassName("wux-ui-is-rendered")},oldGenerateIcon:function(h,j,i){if(!h){return}if(typeof(h)==="object"){return this.generateIcon(h,i)}if(typeof(h)==="string"&&h.indexOf(".")>-1){return this.generateIcon(h)}return this.generateIcon({iconName:h,fontIconSize:j,fontIconFamily:i})},cleanIcon:function(h){if(!h||!h.__generateIconInfos){return}if(h.__generateIconInfos.classes){h.removeClassName(h.__generateIconInfos.classes)}switch(h.__generateIconInfos.type){case 0:h.src="";if(h.__generateIconInfos.size){h.width="";h.height=""}break;case 1:h.style.backgroundImage="";if(h.__generateIconInfos.size){h.style.width="";h.style.height=""}break}delete h.__generateIconInfos},_generateIconFromString:function(h,i){var j=i&&i.target!==undefined;var m=j?i.target:undefined;var l=undefined;var k;if(h.indexOf(".")>-1){if(j){if(m.tagName.toLowerCase()==="img"){l=0;k="wux-ui-genereatedicon-image wux-button-icon-image";m.src=h}else{l=1;k="wux-ui-genereatedicon-backgroundimage wux-button-icon-image";m.style.backgroundImage="url("+h+")"}g.extendElement(m).addClassName(k)}else{l=0;k="wux-ui-genereatedicon-image wux-button-icon-image";m=new g.Element("img",{"class":k,src:h})}}else{k="wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-"+h+" wux-ui-3ds-lg";if(j){g.extendElement(m).addClassName(k)}else{m=new g.Element("span",{"class":k})}}m.__generateIconInfos={type:l,classes:k};return m},_generateIconFromClasses:function(h,i){var j=i&&i.target!==undefined;var l=j?i.target:undefined;var k="wux-button-icon-custom wux-ui-genereatedicon-custom "+h.iconClasses;if(j){g.extendElement(l).addClassName(k)}else{l=new g.Element("div",{"class":k})}l.__generateIconInfos={classes:k};return l},_generateIconFromPath:function(h,i){var j=i&&i.target!==undefined;var m=j?i.target:undefined;var l=undefined;var k;if(j){if(m.tagName.toLowerCase()==="img"){l=0;k="wux-ui-genereatedicon-image";m.src=h.iconPath}else{l=1;k="wux-ui-genereatedicon-backgroundimage";m.style.backgroundImage="url("+h.iconPath+")"}g.extendElement(m).addClassName(k)}else{l=0;k="wux-ui-genereatedicon-image";m=new g.Element("img",{"class":k,src:h.iconPath})}if(h.iconSize){if(l===0){m.width=h.iconSize.width;m.height=h.iconSize.height}else{m.style.width=h.iconSize.width;m.style.height=h.iconSize.height}}m.__generateIconInfos={type:l,classes:k,size:h.iconSize};return m},_generateIconFromFontIconDefinition:function(h,i){var j=i&&i.target!==undefined;var m=j?i.target:undefined;var l="";if(h.fontIconFamily===WUXManagedFontIcons.FontAwesome){l="wux-ui-fa"}else{if(h.fontIconFamily===WUXManagedFontIcons.Font3DS||!h.fontIconFamily){l="wux-ui-3ds"}else{console.warn("Incorrect input, wrong FontIcon family");return}}var k="wux-button-icon-fi wux-ui-genereatedicon-fi "+l+" "+l+"-"+h.iconName;if(!h.fontIconSize||h.fontIconSize==="1x"){k+=" "+l+"-lg"}else{k+=" "+l+"-"+h.fontIconSize}if(j){g.extendElement(m).addClassName(k)}else{m=new g.Element("span",{"class":k})}m.__generateIconInfos={classes:k,};return m},generateIcon:function(h,i){if(!h){return}if(i&&i.target){this.cleanIcon(i.target)}if(typeof(h)==="string"){return this._generateIconFromString(h,i)}if(h.iconClasses){return this._generateIconFromClasses(h,i)}if(h.iconPath){return this._generateIconFromPath(h,i)}if(h.iconName){return this._generateIconFromFontIconDefinition(h,i)}},createEllipsisText:function(l){var l=l||{maxWidth:"auto",lineHeight:18,nbLinesVisible:2,textAlign:"justify",allowUnsafeHTMLLabel:false};if(l.nbLinesVisible===1){var k={"class":"wux-button-label-ellipsis-nowrap",styles:{"max-width":l.maxWidth,"line-height":l.lineHeight+"px","max-height":l.lineHeight+"px"}};if(l.allowUnsafeHTMLLabel===false){k.text=l.label}else{k.html=l.label}return new g.Element("div",k)}var i=l.nbLinesVisible||2;var h={"class":"wux-button-label-ellipsis-wrap",styles:{"text-align":l.textAlign,"max-width":l.maxWidth,"line-height":l.lineHeight+"px","max-height":l.lineHeight*i+"px"}};if(l.allowUnsafeHTMLLabel===false){h.text=l.label}else{h.html=l.label}var j=new g.Element("div",h);a.onNodeRendered(j,function(){var q=j.innerHTML.split(/\s/);var o='<span style="white-space: pre; display: inline-block;">';j.innerHTML=o+q.join(" </span>"+o)+"</span>";var p=null;var r=0;var m=0;j.getChildren("span").every(function(t,s){var u=t.getPosition().y;if(u!==p){p=u;r++}if(r===i){m=s;return false}return true});var n;for(n=m;n<q.length&&q[n]==="";n++){}q.splice(m,n-m);if(m!==0){q[m]='<div style="overflow: hidden; text-overflow: ellipsis; white-space: pre;">'+q[m];q.push("</div>")}j.innerHTML=q.join(" ")});return j},computeStringWidth:function(o,n,h,k){var j=document.createElement("canvas").getContext("2d");j.font=(k?"bold ":"")+n+"px "+h;var l=j.measureText(o);var i=0;var m=l.width;if(m){i=parseFloat(m,10)}return i},_pushUserInteractionContext:function(){a._userInteractionContextes.push({userInteractionPath:[]})},_popUserInteractionContext:function(){a._userInteractionContextes.pop()},_isCurrentlyCalledFromUIInteraction:function(){return(a._userInteractionContextes.length===0?false:true)},_isInInteractionPath:function(i){if(a._userInteractionContextes.length===0){return 0}for(var h=0;h<a._userInteractionContextes[a._userInteractionContextes.length-1].userInteractionPath.length;h++){if(a._userInteractionContextes[a._userInteractionContextes.length-1].userInteractionPath[h].dom===i){return 1}}return 0},_increaseCurrentPositionInStack:function(k,m){if(a._userInteractionContextes.length===0){return{increment:false,uiInteraction:false}}var h=a._userInteractionContextes[a._userInteractionContextes.length-1];var l=h.userInteractionPath;if(l.length===0){var j=k;while(j){l.push({dom:j,dsModel:j.dsModel,userInteractionCount:0,foreignObjectCalled:false});if(j.dsModel&&j.dsModel.name==="popup"){if(j.dsModel.target&&j.dsModel.target.getContent){j=j.dsModel.target.getContent()}else{j=j.dsModel.target}}else{j=(j.getParent?j.getParent():null)}}h.currentPositionInStack=0}if(l[h.currentPositionInStack].foreignObjectCalled){return{increment:false,uiInteraction:false}}for(var i=h.currentPositionInStack;i<l.length;i++){if(k===l[i].dom){h.currentPositionInStack=i;if(m!==false){l[i].userInteractionCount++}return{increment:true,inCurrentUIInteractionStack:true,uiInteraction:true,firstTimeInstanceIsCalled:(l[i].userInteractionCount===1?true:false)}}}l[h.currentPositionInStack].foreignObjectCalled=true;return{increment:true,foreignObjectCalled:true,uiInteraction:true}},_decreaseCurrentPositionInStack:function(i){if(a._userInteractionContextes.length===0){return}var h=a._userInteractionContextes[a._userInteractionContextes.length-1];var j=h.userInteractionPath;if(j&&j.length){if(j[h.currentPositionInStack].userInteractionCount===0){var k=0}if(j[h.currentPositionInStack].foreignObjectCalled){j[h.currentPositionInStack].foreignObjectCalled=false;return}if(i!==false){j[h.currentPositionInStack].userInteractionCount--}if(j[h.currentPositionInStack].userInteractionCount===0){while(h.currentPositionInStack>0){h.currentPositionInStack--;if(j[h.currentPositionInStack].userInteractionCount){break}}if(h.currentPositionInStack===0&&j[h.currentPositionInStack].userInteractionCount===0){h.userInteractionPath=[]}}}},addEventOnElement:function(l,i,j,k,h){if(!l._events){l._events=[]}var m=function(){var o=false;if(arguments[0]){if(arguments[0].isTrusted||(arguments[0].originalEvent&&arguments[0].originalEvent.isTrusted)){o=true}else{if(arguments[0].isSimulated||(arguments[0].originalEvent&&arguments[0].originalEvent.isSimulated)){o=true}}}var n=undefined;if(o){a._pushUserInteractionContext()}else{n=a._increaseCurrentPositionInStack(l.getContent?l.getContent():l,false)}k.apply(i,arguments);if(o){a._popUserInteractionContext()}else{if(n.increment){a._decreaseCurrentPositionInStack(false)}}};if(f.Engine.firefox&&j==="mousewheel"){j="DOMMouseScroll"}l._events.push({target:i,eventName:j,listener:k,wrapper:m,useCapture:h});i.addEventListener(j,m,h)},removeEventOnElement:function(n,j,k,l,h){if(n._events){for(var i=0;i<n._events.length;i++){var m=n._events[i];if(m.target===j&&m.eventName===k&&m.listener===l&&(!m.useCapture||m.useCapture===h)){if(f.Engine.firefox&&k==="mousewheel"){k="DOMMouseScroll"}if(m.wrapper){j.removeEventListener(k,m.wrapper,h)}else{j.removeEventListener(k,l,h)}n._events.splice(i,1);return true}}}return false},removeAllEventsOnElement:function(l){var h=true;if(l._events){for(var j=l._events.length-1;j>=0;j--){var k=l._events[j];if(k&&k.target&&k.eventName&&k.listener){if(k.wrapper){k.target.removeEventListener(k.eventName,k.wrapper,k.useCapture?k.useCapture:false)}else{k.target.removeEventListener(k.eventName,k.listener,k.useCapture?k.useCapture:false)}}else{h=false}l._events.splice(j,1)}return h}return undefined},hasEventOnElement:function(n,j,k,l,h){if(n._events){for(var i=0;i<n._events.length;i++){var m=n._events[i];if(m.target===j&&m.eventName===k&&m.listener===l&&(!m.useCapture||m.useCapture===h)){return true}}}return false},_callMethodFromUIInteraction:function(m,i,h){if(!m.elements.container&&!m.container){return}var k=undefined;var j=a._increaseCurrentPositionInStack(m.getContent());if(j.inCurrentUIInteractionStack&&j.firstTimeInstanceIsCalled){if(m.elements.container){var l=i.length;if(h.length>l){h.length=l}b.addCustomInteraction(m.elements.container,{type:"webUX_method",methodToApply:i.name,arguments:h},undefined,true)}}k=i.apply(m,h);if(j.inCurrentUIInteractionStack){a._decreaseCurrentPositionInStack()}return k},_getUrlRegex:function(){const h=/((https?|ftp):\/\/|www\.|ftp\.|mailTo:)[^\s/$.?#].[^\s]*[^,:;\. ]/gi;return h},hyperlinkifyText:function(h){return h.replace(this._getUrlRegex(),function(i){var j=g.createElement("a");j.text=i.replace(/^mailTo:/gi,"");if(i.match(/^www\./gi)){j.href="http://"+i}else{if(i.match(/^ftp\./gi)){j.href="ftp://"+i}else{j.href=i}}if(!i.match(/^mailTo:/gi)){j.target="_blank"}return j.outerHTML})}};a._userInteractionContextes=[];(function(k){var m=document.attachEvent;var j=navigator.userAgent.match(/Trident/);var i=(function(){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(o){return window.setTimeout(o,20)};return function(o){return n(o)}})();var l=(function(){var n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(o){return n(o)}})();function h(n){var o=n;if(o.__resizeRAF__){l(o.__resizeRAF__)}o.__resizeRAF__=i(function(){var p=o.__resizeTrigger__;n.__resizeListeners__.forEach(function(q){q.call(p,n)})})}k.addResizeListener=function(o,p,n){if(!o.__resizeListeners__||!o.__resizeListeners__.length){if(!o.__resizeListeners__){o.__resizeListeners__=[]}var q=o.__resizeTrigger__=e.use("iframe").component;q.__resizeElement__=o;o.__loadListener__=function(){q.contentWindow.addEventListener("resize",o.__windowResizeListener__)};o.__windowResizeListener__=function(){if(document.activeElement&&document.activeElement.tagName&&document.activeElement.tagName.toLowerCase()!=="input"){h(o,q)}};q.addEventListener("load",o.__loadListener__);o.appendChild(q)}o.__resizeListeners__.push(p)};k.removeResizeListener=function(o,p){o.__resizeListeners__.splice(o.__resizeListeners__.indexOf(p),1);if(!o.__resizeListeners__.length){if(o&&o.__resizeTrigger__){if(m){o.detachEvent("onresize",h)}else{if(o.__resizeTrigger__.contentDocument){o.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",h)}}if(o.__resizeTrigger__.contentWindow){o.__resizeTrigger__.contentWindow.removeEventListener("resize",o.__windowResizeListener__)}o.__resizeTrigger__.removeEventListener("load",o.__loadListener__);o.__windowResizeListener__=null;o.__loadListener__=null;try{o.removeChild(o.__resizeTrigger__)}catch(n){console.warn("The inside DOM of the resize listener has been prematurely deleted. IFrame could not be removed.")}o.__resizeTrigger__.__disposable__.dispose();o.__resizeTrigger__.__resizeElement__=null;o.__resizeTrigger__=null}else{console.warn("The inside DOM of the resize listener has been prematurely deleted. Listeners could not be removed.")}}}})(a);return a});define("DS/Developer/SandBoxIframe",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom"],function(UWA,Event,Abstract,WUX,WebappsUtils,DomUtils){var SandBoxIframe=Abstract.extend({defaultOptions:{code:{js:[]},template:null,command:null},init:function(options){this.options=UWA.extend(options,this.defaultOptions);this._parent(this.options);if(!this.options.targetIframe){this._createIframe()}else{this._sandboxIframe=this.options.targetIframe;this._sandbox=this.options.targetIframe.contentWindow}},_createIframe:function(){this._sandboxIframe=new UWA.Element("iframe");this._sandbox=this._sandboxIframe.contentWindow;if(!this._sandbox.eval&&this._sandbox.execScript){this._sandbox.execScript("null")}},evaluate:function(options){var command=options.command;if(options.template){this._sandboxIframe.setAttribute("src",options.template)}var me=this;setTimeout(function(){if(options.baseUrl){me.defineBaseurl(options.baseUrl)}if(options.code&&options.code.js){me.loadJS(options.code.js)}if(options.code&&options.code.css){me.loadCSS(options.code.css)}return me._sandbox.eval?me._sandbox.eval(command):me.get("fallback")?eval(command):new Error("Can't evaluate inside the iframe - please report this bug along with your browser information!")},1000)},loadJS:function(listOfScript){var me=this;listOfScript.forEach(function(scriptsrc){me.load(scriptsrc)})},loadCSS:function(url){var link=this._sandboxIframe.contentDocument.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=url;this._sandboxIframe.contentDocument.getElementsByTagName("head")[0].appendChild(link)},load:function(src){var script=this._sandboxIframe.contentDocument.createElement("script");script.type="text/javascript";script.src=src;if(this._sandbox){return this._sandboxIframe?this._sandboxIframe.contentDocument.getElementsByTagName("head")[0].appendChild(script):new Error("sandbox: iframe has not been created yet, cannot load "+src)}else{return document.body.appendChild(script)}},defineBaseurl:function(src){var script=this._sandboxIframe.contentDocument.createElement("base");script.href=src;if(this._sandbox){return this._sandboxIframe?this._sandboxIframe.contentDocument.getElementsByTagName("head")[0].appendChild(script):new Error("sandbox: iframe has not been created yet, cannot load "+src)}else{return document.body.appendChild(script)}}});return SandBoxIframe});define("DS/SmartInputs/Base",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents"],function(h,b,g,f,e){var a="change";function d(j){var i=(String(j)).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!i){return 0}return Math.max(0,(i[1]?i[1].length:0)-(i[2]?Number(i[2]):0))}var c=g.extend({defaultOptions:{label:null,constraints:null,value:[],units:"mm",size:"small"},init:function(i){this._parent(i);this._modelEvents=new e();this._buildLeftView();if(this._buildInternalView){this._buildInternalView()}this._buildRightView();this._proxifyEvents();this.setValue(this.options.value,true)},_buildLeftView:function(){this.elements.container=new h.Element("div",{"class":"wux-ui-stack-h wux-smartinputs-base wux-ui-size-"+this.options.size+" "+this._smartInputClass,styles:{display:(this.options.label&&this.options.label!=="")?"block":"inline-block"}})},_addElement:function(i,l){var k=this;var j=new h.Element("div",{"class":"wux-smartinputs-slider-container",html:i,styles:l}).inject(this.elements.container);i.addEvent("change",function(){if(k.updateModel){var m=k.updateModel.call(k);k.setValue(m,true)}else{k.setValue(this.getValue("float"),true)}});return j},_buildRightView:function(){this.elements.unit=new h.Element("div",{"class":"wux-smartinputs-units",html:this.options.units}).inject(this.elements.container)},_proxifyEvents:function(){this.addEvent("change",function(){if(this.updateView){this.updateView()}})},_getValue:function(j){switch(j){case"string":return this._value.toString();case"integer":return parseInt(this.getValue("string"),10);case"float":var i=d(this.options.constraints.stepValue);return parseFloat(parseFloat(this.getValue("string")).toFixed(i));default:return this._value}},getValue:function(i){return this._getValue(i)},constraintValue:function(){var j=this;var i=[];this.getValue().forEach(function(l,k){i.push(j._constraintValue(l,k))})},getConstraints:function(i){var j=[];if(this.options.constraints){if(this.options.constraints instanceof Array){j=this.options.constraints}else{j.push(this.options.constraints)}}if(i!==undefined){return j[i]}else{return j}},_constraintValue:function(k,j){var m=this.getConstraints(j);if(m){if((m.maxValue!==undefined)&&(m.maxValue!==null)&&(k>m.maxValue)){k=m.maxValue}if((m.minValue!==undefined)&&(m.minValue!==null)&&(k<m.minValue)){k=m.minValue}var l=(Math.round(k/m.stepValue)*m.stepValue);var i=d(m.stepValue);this._value[j]=parseFloat(l).toFixed(i)}return this._value[j]},_subscribe:function(i,j){return this._modelEvents.subscribe({event:i},j)},addEvent:function(i,j){return this._subscribe(i,j)},addEventListener:function(i,j){return this._subscribe(i,j)},setValue:function(l,j){var k=this;if(j===undefined){j=true}if(l instanceof Array){this._value=l}else{var i=[];i.push(l);this._value=i}this.constraintValue();if(this._value.length!==undefined&&this._value.length===1){this._value=this._value[0]}if(this.updateView){this.updateView()}if(j){k._modelEvents.publish({context:k,event:a,data:k})}}});return c});define("DS/Layouts/GridEngineCellAbstract",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Dom","UWA/Utils"],function(e,d,a,b){var c=d.extend({defaultOptions:{gridEngine:null,parent:null,width:100,height:28,useTranslate3d:false},init:function(f){this._parent(f);this._uxid=b.getUUID();this._buildView();this._virtualRowID=-1;this._virtualColumnID=-1;this._dataToBeTransferred={};this._cachedCellInfos=null},_clean:function(){},_free:function(){},getGridEngine:function(){return this.options.gridEngine},getCellInfos:function(){if(!this._cachedCellInfos){var f=this.getVirtualCoordinates();this._cachedCellInfos={virtualRowID:f.virtualRowID,virtualColumnID:f.virtualColumnID,virtualCellID:f.virtualCellID,cellModel:this.getGridEngine().getCellModel(f.virtualRowID,f.virtualColumnID),cellView:this,manager:this.getGridEngine(),isHeader:f.virtualRowID===-1||f.virtualColumnID===-1}}return this._cachedCellInfos},isHeader:function(){var f=this.getVirtualCoordinates();return f.virtualRowID===-1||f.virtualColumnID===-1},_setReusableContent:function(f){this._disposeReusableContent();this._reusableContent=f;this.getContent().setContent((this._reusableContent.getContent&&this._reusableContent.getContent())||this._reusableContent)},_disposeReusableContent:function(){if(this._reusableContent){this._reusableContent.__disposable__.dispose();this._reusableContent=undefined}},reuseCellContent:function(f){return this.getGridEngine()._reuseCellContent(f,this)},getParent:function(){return this.options.parent},getPosition:function(){var g=this.getVirtualCoordinates();var f={top:g.virtualRowID*this.getGridEngine()._getCellHeight(),left:g.virtualColumnID*this.getGridEngine()._getCellWidth()};if(f.top<0){f.top=0}if(f.left<0){f.left=0}return f},destroy:function(){this._disposeReusableContent();this._cachedCellInfos=null;this._parent()},placeCell:function(f){if(f===undefined){f=this.getPosition()}this.elements.container.style.left=f.left+"px";this.elements.container.style.top=f.top+"px"},_setVirtualCoordinates:function(f){this._cachedCellInfos=null;this._virtualRowID=f.virtualRowID;this._virtualColumnID=f.virtualColumnID;if(f.rowID!==undefined){this.elements.container.setAttribute("row-id",f.rowID)}if(f.columnID!==undefined){this.elements.container.setAttribute("column-id",f.columnID)}this.elements.container.setAttribute("virtual-row-id",this._virtualRowID);this.elements.container.setAttribute("virtual-column-id",this._virtualColumnID);a.setStyles(this.getContent(),{width:this._virtualColumnID>-1?this.getGridEngine().options.defaultCellWidth:this.getGridEngine().getHeadersDimensions().width,height:this._virtualRowID>-1?this.getGridEngine().options.defaultCellHeight:this.getGridEngine().getHeadersDimensions().height})},_requestCell:function(){this.getGridEngine()._isRequestingCell=true;var f=this.getCellInfos();if(f.cellModel){if(!f.isHeader){if(this.getGridEngine()._onRequestCellCB){this.getGridEngine()._onRequestCellCB.call(this,f)}}else{if(f.virtualRowID===-1){if(this.getGridEngine()._onRequestColumnHeaderCB){this.getGridEngine()._onRequestColumnHeaderCB.call(this,f)}}else{if(this.getGridEngine()._onRequestRowHeaderCB){this.getGridEngine()._onRequestRowHeaderCB.call(this,f)}}}}this.getGridEngine()._isRequestingCell=false},updateInternalParameters:function(){if(this.getGridEngine().options.performances.debounceCellRequest){this._requestCell()}},isFiltered:function(){return this._isFiltered},getVirtualCoordinates:function(){return{virtualRowID:this._virtualRowID,virtualColumnID:this._virtualColumnID,virtualCellID:this._virtualRowID*this.getGridEngine()._numberOfColumns+this._virtualColumnID}},_buildView:function(){this.elements.container=e.createElement("div",{"class":"wux-datagrid-cell "+(this.options.isHeader?"wux-font-3dsregular":""),styles:{lineHeight:this.options.height+"px",width:this.options.width,height:this.options.height}});this.elements.container.dsView=this},getDimensions:function(){var f=this.getGridEngine().options.cellSpacing;return{width:this.options.width+f.horizontal,height:this.options.height+f.vertical}},hide:function(){if(!this._isHidden){this._isHidden=true;this.elements.container.style.display="none"}},show:function(f){if(this._isHidden||f){this._isHidden=false;this.elements.container.style.display="block"}},isHidden:function(){return this._isHidden}});return c});define("DS/Core/BaseComponent",["UWA/Controls/Abstract","DS/Utilities/Utils"],function(a,d){var c=false;var e=false;var b=a.extend({init:function(f){if(e){console.time("component creation")}this._properties=this._properties||{};this._parent();for(var g in this.publishedProperties){this._properties[g]={value:(Array.isArray(this.publishedProperties[g].defaultValue))?this.publishedProperties[g].defaultValue.slice():this.publishedProperties[g].defaultValue,dirty:true}}if(this._preBuild){this._preBuild(f)}if(this._build){this._build()}this.setProperties(f,true);if(this._postBuild){this._postBuild()}if(e){console.timeEnd("component creation")}},isDirty:function(f){if(!this._properties){return false}else{if(!this._properties[f]){return false}}return this._properties[f].dirty},setProperties:function(h){var f={};var i=(arguments.length>1)?arguments[1]:false;var g=i;for(var j in h){if(this._properties[j]){if(!this.publishedProperties[j].readOnly||i){if(this._properties[j].value!==h[j]){f[j]=this._properties[j].value;this._properties[j].value=h[j];this._properties[j].dirty=true;g=true}}else{if(c){console.log(j+" is a readOnly published property")}}}else{if(c){console.log(j+" is not a published property")}}}if(g){this._applyProperties(f);for(var j in this._properties){this._properties[j].dirty=false}}},_forceApplyProperties:function(h){var f={};for(var g=0;g<h.length;g++){if(this._properties[h[g]]){this._properties[h[g]].dirty=true;f[h[g]]=this._properties[h[g]].value}else{console.log(i+" is not a published property")}}this._applyProperties(f);for(var i in this._properties){this._properties[i].dirty=false}},_propertyChanged:function(f,g,h){if(c){console.log("property changed",f,g,"-->",h)}}});b.inherit=d.inherit;return b});define("DS/Controls/TooltipModel",["UWA/Core","DS/Core/BaseComponent","DS/WebappsUtils/WebappsUtils"],function(e,a,d){var c={SINGLELINE:0,MULTILINE:1};Object.freeze(c);var b=a.inherit({_reachableState:false,publishedProperties:{owner:{defaultValue:undefined,type:"object"},title:{defaultValue:"",type:"string"},shortHelp:{defaultValue:"",type:"string"},longHelp:{defaultValue:"",type:"string"},shortHelpImage:{defaultValue:"",type:"string"},longHelpImage:{defaultValue:"",type:"string"},shortHelpImageDimension:{defaultValue:{x:150,y:75},type:"vector2"},longHelpImageDimension:{defaultValue:{x:150,y:75},type:"vector2"},initialDelay:{defaultValue:1000,type:"integer"},shortToLongDelay:{defaultValue:2000,type:"integer"},reshowDelay:{defaultValue:1000,type:"integer"},mouseRelativePosition:{defaultValue:true,type:"boolean"},position:{defaultValue:"bottom",type:"string"},wrapPolicy:{defaultValue:c.MULTILINE,type:"integer"},wrapThreshold:{defaultValue:270,type:"integer"},allowUnsafeHTMLTitle:{defaultValue:undefined,type:"boolean"},allowUnsafeHTMLShortHelp:{defaultValue:undefined,type:"boolean"},allowUnsafeHTMLLongHelp:{defaultValue:undefined,type:"boolean"},moreHelpCB:{defaultValue:undefined,type:"function"},getAllInformationCB:{defaultValue:undefined,type:"function"}},_applyProperties:function(f){this._parent(f);if(this.isDirty("moreHelpCB")){this._applyMoreHelpCB(f.moreHelpCB,this._properties.moreHelpCB.value)}},_applyMoreHelpCB:function(f,g){if(g!==f){this._reachableState=Boolean(g instanceof Function)}},isEmpty:function(){return(this.longHelp===""&&this.shortHelp===""&&this.title==="")},loadFromHelpRscFile:function(j,l){if(j){var g=j.split("/");var i="i18n!"+g[0];var f=g.splice(0,1);i+="/assets/help/"+g.join("/");var k=this;var h=l;require([i,"DS/WebUAUtils/WebUAUtils"],function(o,m){var q=function(r,s){return d.getWebappsBaseUrl()+r+"/assets/graphic/"+s};k.title=o[h+".Title"];if(o[h+".ShortHelp"]){k.shortHelp=o[h+".ShortHelp"]}if(o[h+".LongHelp"]){k.longHelp=o[h+".LongHelp"]}if(o[h+".ShortHelpImage"]){k.shortHelpImage=q(f,o[h+".ShortHelpImage"])}if(o[h+".LongHelpImage"]){k.longHelpImage=q(f,o[h+".LongHelpImage"])}var p={};p.helpid=h;p.content=o;var n=m.getMoreHelpCallback(p);if(n!==undefined){k.moreHelpCB=n}})}},setAllPropertiesFromAllInformationCB:function(){if(this.getAllInformationCB&&this.getAllInformationCB instanceof Function){var f=this.getAllInformationCB.call();if(!f.updateModel){for(var g in this.publishedProperties){if(g==="owner"||g==="getAllInformationCB"){continue}this[g]=f.model[g]?f.model[g]:this.publishedProperties[g].defaultValue}}else{for(var g in f.model){if(g==="owner"||g==="getAllInformationCB"){continue}this[g]=f.model[g]}}}}});b.WrapPolicy=c;return b});define("DS/Utilities/Color",["UWA/Core","DS/Utilities/Utils"],function(d,b){function c(f,e){var g=String(f);while(g.length<e){g="0"+g}return g}var a={rgbToHsl:function(e,m,p){e/=255,m/=255,p/=255;var q=Math.max(e,m,p),j=Math.min(e,m,p);var k,u,f=(q+j)/2;if(q==j){k=u=0}else{var n=q-j;u=f>0.5?n/(2-q-j):n/(q+j);switch(q){case e:k=(m-p)/n+(m<p?6:0);break;case m:k=(p-e)/n+2;break;case p:k=(e-m)/n+4;break}k/=6}var t=k*360;var i=u*100;var o=f*100;return[t,i,o]},rgbToHsv:function(e,j,k){var f=Math.min(e,j,k),l=Math.max(e,j,k),n=l-f,i,o,m=l;m=l/255*100;if(l!=0){o=n/l*100}else{return[0,0,0]}if(e==l){i=(j-k)/n}else{if(j==l){i=2+(k-e)/n}else{i=4+(e-j)/n}}if(n===0){i=0}i=i*60;if(i<0){i+=360}return[i,o,m]},hsvToRgb:function(i){var k=i[0];var j=i[1];var g=i[2];var n=255*g/100;var f=n*(1-j/100);var l=(n*j/100)*(1-Math.abs((k/60)%2-1));var e={};if(k>=0&&k<60){e.r=Math.round(n);e.g=Math.round(l+f);e.b=Math.round(f)}else{if(k>=60&&k<120){e.r=Math.round(l+f);e.g=Math.round(n);e.b=Math.round(f)}else{if(k>=120&&k<180){e.r=Math.round(f);e.g=Math.round(n);e.b=Math.round(l+f)}else{if(k>=180&&k<240){e.r=Math.round(f);e.g=Math.round(l+f);e.b=Math.round(n)}else{if(k>=240&&k<300){e.r=Math.round(l+f);e.g=Math.round(f);e.b=Math.round(n)}else{if(k>=300&&k<360){e.r=Math.round(n);e.g=Math.round(f);e.b=Math.round(l+f)}}}}}}return e},hexToHsv:function(f){var e=this.hexToRgb(f);return this.rgbToHsv(e.r,e.g,e.b)},hsvToHex:function(e){return this.rgbToHex(this.hsvToRgb(e))},intToHex:function(e){var f=parseInt(e).toString(16);return(f.length<2)?"0"+f:f},hexToInt:function(e){return parseInt("0x"+e)},hexToHsl:function(f){var e=this.hexToRgb(f);return this.rgbToHsl(e.r,e.g,e.b)},hslToRgb:function(h){var g={};var j=(1-Math.abs(h[2]/50-1))*h[1]/100,f=j*(1-Math.abs((h[0]/60)%2-1)),i=Math.floor(h[0]/60),e=h[2]/100-j/2;switch(i){case 0:g.r=j;g.g=f;g.b=0;break;case 1:g.r=f;g.g=j;g.b=0;break;case 2:g.r=0;g.g=j;g.b=f;break;case 3:g.r=0;g.g=f;g.b=j;break;case 4:g.r=f;g.g=0;g.b=j;break;case 5:case 6:g.r=j;g.g=0;g.b=f;break}g.r=Math.round((g.r+e)*255);g.g=Math.round((g.g+e)*255);g.b=Math.round((g.b+e)*255);return g},hslToHex:function(e){return this.rgbToHex(this.hslToRgb(e))},rgbToHex:function(e){var f=function(h){var g=h.toString(16)||"";while(g.length<2){g="0"+g}return g};return f(e.r)+f(e.g)+f(e.b)},random:function(){var g="0123456789ABCDEF".split("");var e="#";for(var f=0;f<6;f++){e+=g[Math.round(Math.random()*15)]}return e},hexToRgb:function(e){var e=String(e);if(e.charAt(0)==="#"){e=e.substr(1)}if(e.length===3){e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}return{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16)}},colorToCssColor:function(e){return"rgb("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+")"},lerpColorRgb:function(g,f,e){var e=b.clamp(0,1,e);return{r:Math.round(g.r+e*(f.r-g.r)),g:Math.round(g.g+e*(f.g-g.g)),b:Math.round(g.b+e*(f.b-g.b))}},lerpColorHex:function(i,h,e){var f=this.hexToRgb(i);var g=this.hexToRgb(h);return this.rgbToHex(this.lerpColorRgb(f,g,e))}};return a});define("DS/Selection/XSO",["UWA/Core","UWA/Event","DS/CoreEvents/ModelEvents","UWA/Class"],function(h,p,b,a){var n="/WEBAPP/";var d="UPDATE";var c="ADD";var l="PRE_ADD";var e="REMOVE";var f="EMPTY";var g="PRE_EMPTY";var j="POST_ADD";var q="POST_REMOVE";var i=false;var m=-1;var k=function(){var r={};this.add=function(s){var v=s.hash();var w=r[v];if(w){var u=false;for(var t=0;t<w.length;++t){if(w[t].isEqual(s)){u=true}}if(!u){w.push(s)}}else{w=[];w.push(s);r[v]=w}};this.remove=function(s){var v=s.hash();var w=r[v];if(w){var u=false;for(var t=0;t<w.length;++t){if(w[t].isEqual(s)){u=true;w.splice(t,1);break}}return u}};this.contains=function(s){var v=s.hash();var w=r[v];if(w){var u=false;for(var t=0;t<w.length;++t){if(w[t].isEqual(s)){u=true}}return u}else{return false}};this.empty=function(){r={}}};var o=a.extend({init:function(r){this.options={areEquals:function s(t,v){if(t&&t.pathElement&&v&&v.pathElement){return t.pathElement.isEqual(v.pathElement)}if(t instanceof Function){if(v instanceof Function){return t.toString()===v.toString()}return false}if(t===null||t===undefined||v===null||v===undefined){return t===v}if(t===v){return true}else{if(typeof t.valueOf==="function"&&typeof v.valueOf==="function"&&t.valueOf()===v.valueOf()){return true}}if(t instanceof Date){return false}if(v instanceof Date){return false}if(!(t instanceof Object)||!(v instanceof Object)){return false}var u=Object.keys(t);return Object.keys(v).every(function(w){return u.indexOf(w)!==-1})?u.every(function(w){return s(t[w],v[w])}):false},useUniqueID:false,publishOnlyPrePostEvents:false};h.extend(this.options,r);this._modelEvents=new b();this._xsoUuid=h.Utils.getUUID();if(this.options.useUniqueID){this._items={}}else{this._items=[]}this.hashSetPathElement=new k()},_getXsoID:function(r){return r.__xso__!==undefined?r.__xso__[this._xsoUuid]:undefined},_setXsoID:function(s,r){if(s.__xso__===undefined){s.__xso__={}}s.__xso__[this._xsoUuid]=r},_subscribe:function(t){var r={event:null,arrayOutput:false,callback:null};h.extend(r,t);if(r.callback){var s=n+this.options.eventChannel+r.event;return this._modelEvents.subscribe({event:s},function(v){if(r.arrayOutput){var u=[];if(v instanceof "Array"){u.concat(v)}else{u.push(v)}r.callback.call(window,u)}else{r.callback.call(window,v)}})}},unsubscribe:function(r){return this._modelEvents.unsubscribe(r)},get:function(){if(this.options.useUniqueID){if(!this._cachedItems||this._needUpdateCachedItems){var r=this;this._cachedItems=Object.keys(this._items).map(function(s){return r._items[s]});this._needUpdateCachedItems=false}return this._cachedItems}else{return this._items}},isIn:function(u){var s=false;var t=this;if(this.options.useUniqueID){if(this.options.getElementID){var r=this.options.getElementID(u);if(r!==null&&r!==undefined){return this._items[r]!==undefined}else{throw"XSO: getElementID return something null or undefined"}}else{return this._getXsoID(u)!==undefined}}else{if(u&&u.pathElement){return this.hashSetPathElement.contains(u.pathElement)}else{this._items.forEach(function(v){if(t.options.areEquals(v,u)){s=true}})}}return s},isEmpty:function(){if(this.options.useUniqueID){for(var r in this._items){if(Object.prototype.hasOwnProperty.call(this._items,r)){return false}}return true}else{return !(this._items.length>0)}},isBeingEmptied:function(){return this._isBeingEmptied},empty:function(v){var t=[];if(!this.isEmpty()){if(v===undefined){v=true}var s=this;if(v){this._modelEvents.publish({event:n+this.options.eventChannel+g,data:this.get()})}if(this.options.useUniqueID){this._isBeingEmptied=true;for(var u in this._items){var r=this._items[u];t.push(r);if(r){this.remove(r)}}this._isBeingEmptied=false}else{while(this._items.length){var r=s._items.shift();t.push(r);this._modelEvents.publish({event:n+s.options.eventChannel+e,data:r});this._modelEvents.publish({event:n+s.options.eventChannel+d,data:r})}this.hashSetPathElement.empty()}this._modelEvents.publish({event:n+s.options.eventChannel+q,data:t});if(v){this._modelEvents.publish({event:n+this.options.eventChannel+f,data:null})}}},unique:function(r){var s=this;if(this.options.useUniqueID){if(!this.isIn(r)||this.get().length>1){this.empty(true);s.add(r)}}else{if(!this.isIn(r)||this.get().length>1){this.empty(false);s.add(r)}}},_addUnit:function(x,y){var v=true;var u=this;if(this.options.useUniqueID){v=false;if(this.options.getElementID){var r=this.options.getElementID(x);if(r!==null&&r!==undefined){if(this._items[r]===undefined){this._needUpdateCachedItems=true;this._items[r]=x;y.call(this,x);v=true}}else{throw"XSO: getElementID return something null or undefined"}}else{var w=this._getXsoID(x);if((w===undefined&&this._items[w]===undefined)){this._needUpdateCachedItems=true;m++;this._setXsoID(x,m);this._items[m]=x;y.call(this,x);v=true}}}else{if(x&&x.pathElement){v=!this.hashSetPathElement.contains(x.pathElement)}else{for(var s=0;s<this._items.length;s++){var t=this._items[s];if(u.options.areEquals(t,x)){v=false;break}}}if(v){if(x&&x.pathElement){this.hashSetPathElement.add(x.pathElement)}this._items.push(x);y.call(this,x)}}return v},add:function(u){var s=[];var t=this;var r=function(v){if(t.options.publishOnlyPrePostEvents){return}t._modelEvents.publish({event:n+t.options.eventChannel+c,data:v});t._modelEvents.publish({event:n+t.options.eventChannel+d,data:v})};this._modelEvents.publish({event:n+t.options.eventChannel+l,data:u});if(i){console.time("add in xso")}if(u instanceof Array){u.forEach(function(v){if(t._addUnit(v,r)){s.push(v)}})}else{if(t._addUnit(u,r)){s.push(u)}}if(i){console.timeEnd("add in xso")}this._modelEvents.publish({event:n+t.options.eventChannel+j,data:s})},_removeUnit:function(w,s){var t=this;var v=false;if(this.options.useUniqueID){if(this.options.getElementID){var r=this.options.getElementID(w);if(r!==null&&r!==undefined){if(this._items[r]!==undefined){this._needUpdateCachedItems=true;delete this._items[r];s.call(this,w);v=true}}else{throw"XSO: getElementID return something null or undefined"}}else{var u=this._getXsoID(w);if((u!==undefined&&this._items[u]!==undefined)){this._needUpdateCachedItems=true;delete this._items[u];this._setXsoID(w,undefined);s.call(this,w);v=true}}}else{if(w&&w.pathElement){v=this.hashSetPathElement.remove(w.pathElement)}this._items.some(function(y,x){if(t.options.areEquals(y,w)){t._items.splice(x,1);s.call(this,w);v=true;return true}})}return v},remove:function(v){var t=[];var s=this;var r=function(w){if(s.options.publishOnlyPrePostEvents){return}s._modelEvents.publish({event:n+s.options.eventChannel+e,data:w});s._modelEvents.publish({event:n+s.options.eventChannel+d,data:w})};if(v instanceof Array){v.forEach(function(w){var x=s._removeUnit(w,r);if(x&&!s._isBeingEmptied){t.push(w)}})}else{var u=s._removeUnit(v,r);if(u&&!s._isBeingEmptied){t.push(v)}}if(!this._isBeingEmptied){this._modelEvents.publish({event:n+s.options.eventChannel+q,data:t})}},onChange:function(s,r){if(r===undefined){r={arrayOutput:false}}return this._subscribe({event:d,arrayOutput:r.arrayOutput,callback:s})},onAdd:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+c},function(s){r.call(window,s)})}},onPreAdd:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+l},function(s){r.call(window,s)})}},onPostAdd:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+j},function(s){r.call(window,s)})}},onPostRemove:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+q},function(s){r.call(window,s)})}},onUpdate:function(r){if(r){this.onEmpty(r);this.onRemove(r);this.onAdd(r)}},onRemove:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+e},function(s){r.call(window,s)})}},onEmpty:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+f},function(s){r.call(window,s)})}},onPreEmpty:function(r){if(r){return this._modelEvents.subscribe({event:n+this.options.eventChannel+g},function(s){r.call(window,s)})}}});return o});define("DS/Selection/PSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(f,b,a,e){var d="PSO/";var c=e.singleton({init:function(g){g={eventChannel:d,};this._parent(g)}});return f.namespace("WUX/Selection/PSOManager",c)});define("DS/UIBehaviors/ContextualMenuManager",["UWA/Core","UWA/Controls/Abstract","DS/Core/PointerEvents","UWA/Utils"],function(e,d,a,b){var c=d.singleton({defaultOptions:{},init:function(f){this._parent(f);this._buildView();this._listeners=Object.create(null)},_populateContextualMenu:function(g){var f,h;if(g&&g!==document&&g.hasAttribute("wux-contextualmenu-id")){f=g.getAttribute("wux-contextualmenu-id");h=this._listeners[f];this._buildMenu(h);this._populateContextualMenu(g.parentNode)}},_buildView:function(){var j=this;this.elements.container=new e.Element("div",{"class":"wux-uibehaviors-contextualmenu",}).hide().inject(document.body);this.elements.container.addEventListener("contextmenu",function h(k){k.preventDefault()});window.addEventListener(document.body.onwheel!==undefined?"wheel":"mousewheel",function g(k){j._hideContextualMenuIfOutside(k.target)},true);window.addEventListener("mousedown",function f(k){j._hideContextualMenuIfOutside(k.target)},true);window.addEventListener("touchstart",function i(l){Array.prototype.forEach.call(l.changedTouches,function k(m){j._hideContextualMenuIfOutside(m.target)})},true)},_buildMenu:function(k){var f,h,j,g;var i=this;if(k){if(typeof k.nodes==="function"){f=k.nodes()}else{f=k.nodes}if(f){f.forEach(function(n){var m=(n.sensitivity&&n.sensitivity.toLowerCase()==="disabled");if(n.type&&n.type==="separator"){h=new e.Element("ul",{"class":"wux-ui-stack-h wux-uibehaviors-contextualmenu-separator",styles:{display:"block"}}).inject(i.elements.container)}else{h=new e.Element("ul",{"class":"wux-ui-stack-h wux-uibehaviors-contextualmenu-node",styles:{display:"block"}}).inject(i.elements.container);if(m){h.classList.add("wux-uibehaviors-contextualmenu-node-disabled")}j=new e.Element("li",{"class":"wux-uibehaviors-contextualmenu-node-icon",styles:{"background-image":n.icon}}).inject(h);g=new e.Element("li",{"class":"wux-uibehaviors-contextualmenu-node-label",html:n.label,}).inject(h)}if(n.callback&&!m){h.addEventListener("click",function l(o){i.elements.container.hide();n.callback.call(k.context,n.data)})}})}}},_showContextualMenu:function(){var g;var f=true;for(g=this.elements.container.firstChild;g&&f;g=g.nextSibling){if(g.firstChild.style.backgroundImage!==""){f=false}}if(f){this.elements.container.addClassName("wux-uibehaviors-contextualmenu-no-icons")}else{this.elements.container.removeClassName("wux-uibehaviors-contextualmenu-no-icons")}this.elements.container.show()},_hideContextualMenuIfOutside:function(f){for(;f&&f!==this.elements.container;f=f.parentNode){}if(!f){this.elements.container.hide()}},_onFireEvent:function(f){this.show(f.currentTarget,[f.pageX,f.pageY]);f.stopPropagation();f.preventDefault();return false},_onFireEventTouch:function(f){if(a.isTouchEvent(f)){this.show(f.currentTarget,[f.pageX,f.pageY]);f.stopPropagation();f.preventDefault();return false}},onReady:function(f){this.listen(f)},listen:function(g){if(!g.target.hasAttribute("wux-contextualmenu-id")){var f=b.getUUID();this._listeners[f]=g;g.target.setAttribute("wux-contextualmenu-id",f);g.target.addEventListener("contextmenu",this._onFireEvent.bind(this));g.target.addEventListener(a.LONGHOLD,this._onFireEventTouch.bind(this))}else{}},forget:function(g){if(g.target.hasAttribute("wux-contextualmenu-id")){var f=g.target.getAttribute("wux-contextualmenu-id");delete this._listeners[f];g.target.removeAttribute("wux-contextualmenu-id");g.target.removeEventListener("contextmenu",this._onFireEvent.bind(this));g.target.removeEventListener(a.LONGHOLD,this._onFireEventTouch.bind(this))}},show:function(m,l,i){var j=35;var n=-18;i=false;this.elements.container.hide();this.elements.container.empty();if(m.nodes){this._buildMenu(m)}else{this._populateContextualMenu(m)}if(this.elements.container.childElementCount>0){var h=l[0];var k=l[1];if(i){h+=j;k+=n}this.elements.container.setStyles({left:h,top:k});this._showContextualMenu();var o=window.innerWidth;var g=window.innerHeight;var f=this.elements.container.getBoundingClientRect();if(f.right>o||f.bottom>g){console.log("reposition");h=l[0];k=l[1];if(f.right>o){h-=f.width;j=-j}if(f.bottom>g){k-=f.height}if(i){h+=j;k+=n}if(h<0){h=0}if(k<0){k=0}this.elements.container.setStyles({left:h,top:k})}}}});return c});define("DS/Controls/Gauge",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(h,b,g,f,e,d){var a="change";var c=g.extend({defaultOptions:{snap:0,value:0,minValue:0,minDeltaValue:0,maxValue:360,stepValue:1,graduations:12,graduationsLabel:true,dynamicGraduations:false,dynamicGaugeColor:true,showCursorLabel:true,theme:{shiftCursorOnBorders:true,fontSize:10,height:22,gaugeHeight:10,cursor:{width:16,height:16,borderRadius:"50%"},width:200,graduations:{width:1,height:24}},displayFunction:function(i){return i.toString()},onChange:null},init:function(i){if(i.graduations>=0&&typeof i.graduations==="number"){i.graduations--}this._parent(i);this._modelEvents=new e();if(this.options.className){this.className=this.options.className}this._value=[];this._resolutionfactor=1;this._isRangeMode=this.options.value instanceof Array;this._realRange=this.options.maxValue-this.options.minValue;this._gaugeSize=parseInt(this.options.theme.height*0.75,10);this._buildSkeleton();this._virtualRange=this.elements.container.getDimensions().width;this._buildScaling();this._buildCursor(0);this._buildCursor(1);this._attachBehaviors();this.setValue(this.options.value)},_percentToRealValue:function(i){return i*this._realRange+this.options.minValue},_realValueToPercent:function(j){var i=(j-this.options.minValue)/this._realRange;return i},_percentToVirtualValue:function(i){return i*this._virtualRange},_virtualToRealValue:function(l,m){if(m===undefined){m=1}var k=this.elements.container;var i=k.getDimensions().width;var j=l/i;var n=this._percentToRealValue(j);return{value:n,percent:j}},_realToVirtualValue:function(k){var i=k/this._realRange;var j=this._percentToVirtualValue();return{value:j,percent:i}},_buildScaling:function(){var q=0;var n=this.options.graduations;var j=h.typeOf(n);var l;var r;if(j==="array"){l=n.length;r=l}else{l=parseInt(n,10);r=l+1}var o=-parseInt(this.options.theme.fontSize+5,10);for(var m=0;m<r;m++){var p;var y;if(this.options.dynamicGraduations){var u=(180-m*180/l);y="hsl("+u+", 100%, 50%)";p=0}else{y=this.options.inactiveGraduationsColor;p=1}if(j==="array"){q=this._realToVirtualValue(n[m].value).percent}else{q=m/l}var k=new h.Element("div",{"class":"wux-Gauge-scale",styles:{position:"absolute",opacity:p}});var t=new h.Element("div",{styles:{position:"relative"}}).inject(k);if(this.options.graduationsLabel){var w;if(j==="array"){w=n[m].label}else{w=this._percentToRealValue(parseFloat(q))}var s=this;var z=new h.Element("div",{"class":"wux-Gauge-scale-label","data-value":s._percentToRealValue(q),styles:{position:"absolute",top:o,fontSize:this.options.theme.fontSize,color:this.options.graduationsLabelColor},html:w.toString(),events:{click:function(x){var i=h.Event.getElement(x);var A=i.getAttribute("data-value");s.setValue(A)}}});z.inject(t)}var v=q*100;k.setStyles({backgroundColor:y,top:-2,left:v+"%",marginLeft:(m===(r-1))?-1:0,width:this.options.theme.graduations.width,height:this.options.theme.graduations.height}).inject(this.elements.container)}},_buildCursor:function(l){var j=-2;var m=new h.Element("div",{"class":"wux-Gauge-scale wux-Gauge-cursor",styles:{display:this.options.showCursorLabel?"block":"none",position:"absolute",width:this.options.theme.cursor.width,height:this.options.theme.cursor.height,marginLeft:-this.options.theme.cursor.width/2,top:(this.options.theme.height-this.options.theme.cursor.height)/2,borderRadius:this.options.theme.cursor.borderRadius}});if(this._isRangeMode||l!==0){m.inject(this.elements.container)}var k=new h.Element("div",{}).inject(m);var i=new h.Element("div",{"class":"wux-Gauge-scale-label",styles:{marginLeft:this.options.theme.cursor.width/2,bottom:j},html:this._value}).inject(k);if(this._isRangeMode){i.setAttribute("data-side",l?"right":"left")}this._cursors[l]=i;this._scales[l]=m},_buildSkeleton:function(){this.elements.container=h.Element("div",{"class":"wux-controls-gauge "+this.className,styles:{position:"relative",marginTop:20,height:this.options.theme.height}});this.elements.control=h.Element("div",{"class":"wux-Gauge-control wux-ui-material-"+this.options.GaugeMaterial,styles:{position:"absolute",top:(this.options.theme.height-this.options.theme.gaugeHeight)/2,height:this.options.theme.gaugeHeight}}).inject(this.elements.container);var i="";this.elements.gauge=h.Element("div",{"class":"wux-Gauge wux-ui-indicator-"+this.options.GaugeIndicator+" wux-ui-material-"+this.options.GaugeMaterial+i+" "+this.className,styles:{}}).inject(this.elements.control);this.elements.gaugeTop=h.Element("div",{"class":"wux-Gauge-top"});this.elements.gaugeBottom=h.Element("div",{"class":"wux-Gauge-bottom"});this._cursors=[];this._scales=[]},addEvent:function(i,j){return this._subscribe(i,j)},_removeEvent:function(i){return this._modelEvents.unsubscribe(i)},_removeEventListener:function(i){return this._modelEvents.unsubscribe(i)},addEventOnce:function(i,j){return this._modelEvents.subscribeOnce({event:i},j)},addEventListener:function(i,j){return this._subscribe(i,j)},_subscribe:function(i,j){return this._modelEvents.subscribe({event:i},j)},_updateGaugePercent:function(k){var i=this.elements.gauge;var j={position:"absolute",left:100*k[0]+"%",right:(100-100*k[1])+"%"};if(this.options.dynamicGaugeColor){var l=(120-k[1]*100);j.backgroundColor="hsl("+l+", 100%, 50%)"}i.setStyles(j);this._updateCursor(0,this._realValueToPercent(this._value[0]),this._value[0]);this._updateCursor(1,this._realValueToPercent(this._value[1]),this._value[1])},_updateCursor:function(i,l,o){var q=this._cursors[i];var j=this._scales[i];var m=this._labelWidth[i];var p=this._controlWidth;var k=l*p;if(this.options.theme.shiftCursorOnBorders){if(p>0){var s=k-m/2;var r=k+m/2;if(s<0){q.setStyles({marginLeft:this.options.theme.cursor.width})}else{if(r>=p){q.setStyles({marginLeft:0})}else{q.setStyles({marginLeft:this.options.theme.cursor.width/2})}}}}var n=l*100;j.setStyles({left:n+"%"});if(this._isRangeMode){q.setHTML(this.options.displayFunction(this._value[i].toString()))}else{q.setHTML(this.options.displayFunction(this.getValue().toString()))}},_constraintValue:function(k){var j=0;var i=this.options.stepValue.toString();if(i.split(".")[1]){j=i.split(".")[1].length}if(k>this.options.maxValue){k=this.options.maxValue}if(k<this.options.minValue){k=this.options.minValue}if(this._isRangeMode){var l=(this._value[1]-this._value[0]);if(l<=this.options.minDeltaValue){if(this._selectedEdge===0){k=this._value[1]-this.options.minDeltaValue}if(this._selectedEdge===1){k=this._value[0]+this.options.minDeltaValue}}}k=(Math.round(k/this.options.stepValue)*this.options.stepValue).toFixed(j);if(j){return Number(k).toFixed(j)}else{return parseFloat(k)}},_setValue:function(l,j,i){if(j===undefined){j=true}if(i===undefined){i=false}if(this._isRangeMode){if(l instanceof Array){if(this._selectedEdge===0){this._value[0]=this._constraintValue(l[0]*this._resolutionfactor)}if(this._selectedEdge===1){this._value[1]=this._constraintValue(l[1]*this._resolutionfactor)}if(this._selectedEdge===null){this._value[0]=this._constraintValue(l[0]*this._resolutionfactor);this._value[1]=this._constraintValue(l[1]*this._resolutionfactor)}}else{console.warn("You must provide an array as value when you want to use a range gauge")}}else{this._value[0]=this.options.minValue;this._value[1]=this._constraintValue(l*this._resolutionfactor)}var k=[this._realValueToPercent(this._value[0]),this._realValueToPercent(this._value[1])];this._updateGaugePercent(k);if(j){if(this.options.onChange){this.options.onChange.call(this,this.getValue())}this._modelEvents.publish({context:this,event:a,data:this})}},setValue:function(j,i){this._selectedEdge=null;this._setValue(j,i)},enable:function(){this.getContent().removeClassName("wux-ui-state-disabled").setStyle("pointer-events","")},disable:function(){this.getContent().addClassName("wux-ui-state-disabled").setStyle("pointer-events","none")},_attachBehaviors:function(){var r=this;var p=this.elements.container;var s=this.elements.gauge;var i,m,t,o,l,k;var u=r._cursors;r._labelWidth=[];r._labelWidth[0]=u[0].getDimensions().width;r._labelWidth[1]=u[1].getDimensions().width;function n(y){y.preventDefault();r._resolutionfactor=1;r.elements.container.addClassName("wux-ui-state-active");r._controlWidth=r.elements.control.getDimensions().width;var A=r._controlWidth;var x=s.getDimensions();var z=s.getOffsets();i={y:z.y+x.height/2,x:z.x};var w=(Number(r._value[1])+Number(r._value[0]))/2;m=r._realValueToPercent(r._value[0])*A;t=i.x-y.pageX-m;o=r._virtualToRealValue(-t);l=o.value<w?0:1;r._selectedEdge=l;k=r.getValue();if(r._isRangeMode){k[l]=o.value}else{k=o.value}r._setValue(k);v=true;document.addEventListener(d.POINTERMOVE,q);document.addEventListener(d.POINTERUP,j)}function q(w){if(v){t=i.x-w.pageX-m;o=r._virtualToRealValue(-t);if(r._isRangeMode){k[l]=o.value}else{k=o.value}r._setValue(k,true,true)}}function j(w){r._resolutionfactor=1;v=false;r.elements.container.removeClassName("wux-ui-state-active");document.removeEventListener(d.POINTERMOVE,q);document.removeEventListener(d.POINTERUP,j)}var v=false;p.addEvent(d.POINTERDOWN,n);h.Element.addEvent.call(p,"mousewheel",function(x){var y=h.Event.wheelDelta(x);var w=x.shiftKey;if(w){y*=5}})},getValue:function(){if(this._isRangeMode){return this._value}else{return parseFloat(this._value[1])}}});return c});define("DS/Controls/Timeline",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/Gauge","DS/CoreEvents/Events"],function(f,a,e,b,c){var d=b.extend({className:"wux-timeline",defaultOptions:{},init:function(g){if(g.beginDate){g.minValue=new Date(g.beginDate).valueOf()}if(g.endDate){g.maxValue=new Date(g.endDate).valueOf()}if(g.dateAtInit){g.value=new Date(g.dateAtInit).valueOf()}if(g.date){g.value=new Date(g.date).valueOf()}if(!g.displayFunction&&g.beginDate){g.displayFunction=function(j){if(j){var i=new Date(j);return i.strftime("%Y-%m-%d")}}}if(!g.displayFunction&&!g.beginDate){g.displayFunction=function(i){return i}}g.graduations=[];var h=this;this._isDateBased=true;this._eventsList=[];if(g.eventsList){g.eventsList.forEach(function(j){var k;if(j.date){k=new Date(j.date).valueOf()-g.minValue;h._isDateBased=true}else{k=j.value-g.minValue;h._isDateBased=false}var i={label:j.label,value:k,onEvent:j.onEvent,state:0};g.graduations.push(i)})}this._parent(g);this._isPlaying=false},_play:function(h,g){var i=this;var j=this._value[1];j=parseFloat(j,10)+parseFloat(h,10);i.setValue(j);i.elements.container.addClassName("wux-ui-state-active");if(j!==i.options.minValue&&j!==i.options.maxValue&&i._isPlaying){this.playerTO=setTimeout(function(){if(i._isPlaying){i._play.call(i,h,g)}},g)}},play:function(h,i){if(i===undefined){i=true}this._isPlaying=false;if(h===undefined){h=1}var j=this;j._isPlaying=true;var g=20;window.clearTimeout(this.playerTO);j._play(h/g,1000/g);if(i){this._modelEvents.publish({event:"PLAY",context:this})}},pause:function(g){if(g===undefined){g=true}this.elements.container.removeClassName("wux-ui-state-active");this._isPlaying=false;if(g){this._modelEvents.publish({event:"PAUSE",context:this})}},stop:function(g){if(g===undefined){g=true}this.elements.container.removeClassName("wux-ui-state-active");this.pause(false);this.setValue(this.options.minValue);if(g){this._modelEvents.publish({event:"STOP",context:this})}},onPlay:function(g){return this._modelEvents.subscribe({event:"PLAY"},g)},onPause:function(g){return this._modelEvents.subscribe({event:"PAUSE"},g)},onStop:function(g){return this._modelEvents.subscribe({event:"STOP"},g)},next:function(){},previous:function(){},setValue:function(i,g){var h=this;this._setValue(i,g);if(h._value[1]===h.options.maxValue){h.pause()}h.options.graduations.forEach(function(j){var k=(j.value+h.options.minValue);if(h._value[1]>=k&&j.state===0){j.state=1;if(j.onEvent){j.onEvent.call(h)}}if(h._value[1]<k&&j.state>0){j.state=0}})},getValue:function(){if(this._isDateBased){var g=new Date();g.setTime(this._value[1]);return g}else{return this._value[1]}}});return f.namespace("WUX/Controls/Timeline",d)});define("DS/Core/ActionsStack",["UWA/Core","UWA/Class","DS/Utilities/Data"],function(d,c,b){var a=c.extend({init:function(){this._stack=[];this._index=-1;this._isRunning=false;this._lastRecordTimeStamp=new Date()},_execute:function(g,e,f){if(!g||typeof g[e]!=="function"){return this}this._isRunning=true;if(f){g[e](f)}else{g[e]()}this._isRunning=false;return this},pushAction:function(e,f){this.registerAction(e);if(f){f()}},registerAction:function(f){d.extend({undoObj:null,undoFunc:null,undoParamsList:[],undoTitle:"Undo",actionObj:null,actionFunc:null,actionParamsList:[],actionTitle:"run",redoObj:null,redoFunc:null,redoParamsList:[],redoTitle:"Redo"},f);var e=new Date();var g=e-this._lastRecordTimeStamp;this._lastRecordTimeStamp=e;this._add({undoTitle:f.undoTitle,actionTitle:f.actionTitle,redoTitle:f.redoTitle,deltaTime:g,actionParamsList:f.actionParamsList,undo:function(){f.undoFunc.apply(f.undoObj,f.undoParamsList)},redo:function(){f.redoFunc.apply(f.redoObj,f.redoParamsList)},run:function(h){if(h){f.actionFunc.apply(f.actionObj,h)}else{f.actionFunc.apply(f.actionObj,f.actionParamsList)}}})},_add:function(e){if(this._isRunning){return this}this._stack.splice(this._index+1,this._stack.length-this._index);this._stack.push(e);this._index=this._stack.length-1;if(this.callback){this.callback()}return this},setCallback:function(e){this.callback=e},getUndoTitle:function(){return this._stack[this._index]&&this._stack[this._index].undoTitle?this._stack[this._index].undoTitle:"Undo"},getRedoTitle:function(){return this._stack[this._index+1]&&this._stack[this._index+1].redoTitle?this._stack[this._index+1].redoTitle:"Redo"},undo:function(){var e=this._stack[this._index];if(!e){return this}this._execute(e,"undo");this._index-=1;if(this.callback){this.callback()}return this},redo:function(){var e=this._stack[this._index+1];if(!e){return this}this._execute(e,"redo");this._index+=1;if(this.callback){this.callback()}return this},play:function(e){var f=this;var g=function(h){var j=f._stack[h];if(j){if(e){setTimeout(function(){f._execute(j,"run");h++;g(h)},h===0?0:j.deltaTime)}else{f._execute(j,"run");h++;g(h)}}};g(0)},process:function(e){var f=this;e=d.extend({actionParamsList:null,chunckProcess:true},e);if(e.chunckProcess){b.forEach(f._stack,function(h){f._execute(h,"run",e.actionParamsList)},10)}else{var g=function(h){var j=f._stack[h];if(j){f._execute(j,"run",e.actionParamsList);h++;g(h)}};g(0)}},clear:function(){var e=this._stack.length;this._stack=[];this._index=-1;if(this.callback&&(e>0)){this.callback()}},hasUndoAction:function(){return this._index!==-1},hasRedoAction:function(){return this._index<(this._stack.length-1)},getActions:function(){return this._stack}});return a});define("DS/Utilities/RAFDispatcher",["UWA/Class","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Array","UWA/Utils/Client"],function(a,f,c,i,h){var g=false;var b=h.Engine;var e=0;var d=a.singleton({init:function(){this._parent();this._modelEvents=new c();this._listOfRenderTaskID=[];this._listOfRenderTasks={};this._namespacesCounter={};this._listOfUnitRenderTasks={};this._ticking=false;this.render()},destroy:function(){i.clear(this._listOfRenderTaskID)},addTask:function(j,k){if(k===undefined){k=e++}if(j.namespace===undefined){j.namespace="global"}if(g){console.log("addTask id: "+k+" namespace: "+j.namespace)}if(this._listOfRenderTasks[k]===undefined){if(this._namespacesCounter[j.namespace]===undefined){this._namespacesCounter[j.namespace]=0;this._modelEvents.publish({event:"renderTasksNamespaceCreated",context:this,data:{namespace:j.namespace}})}this._namespacesCounter[j.namespace]++}this._listOfRenderTasks[k]=j;this.render()},render:function(p){if(p===undefined){p=60}var m=1000/p;var k=Math.min(m,20);var n=this;var j;var o=false;var q;var l=function(){n._listOfUnitRenderTasks={};var t;var s=window.performance?performance.now():Date.now();if(g){if(this._timestamp){var x=s-this._timestamp;console.log("RAFDispatcher elapsedBetweenTasks = "+x)}this._timestamp=s}j=s;var u=0;for(var w in n._listOfRenderTasks){t=n._listOfRenderTasks[w];if(t){if(t.ignoreFromCompleted!==true){o=true}if(t.oncePerFrame){if(n._listOfUnitRenderTasks[w]===1){break}else{n._listOfUnitRenderTasks[w]=1}}if(g){console.time("    render task : "+w)}t.callback.apply(n,t.taskArgs);delete n._listOfRenderTasks[w];if(t.ignoreFromCompleted!==true){u++}if(g){console.timeEnd("    render task : "+w)}}this._namespacesCounter[t.namespace]--;if(this._namespacesCounter[t.namespace]===0){delete this._namespacesCounter[t.namespace];this._modelEvents.publish({event:"renderTasksNamespaceCompleted",context:this,data:{namespace:t.namespace}})}var v=window.performance?performance.now():Date.now();var r=v-j;if(r>=k){if(g){console.log("elapsed: "+r+" thresholdFps: "+k+" => stop current frame")}break}}if((u===0)&&o){this._modelEvents.publish({event:"renderTasksCompleted",context:this});o=false;n._ticking=false}else{n._ticking=true;if(b.safari){q=window.webkitRequestAnimationFrame(l.bind(n))}else{q=window.requestAnimationFrame(l.bind(n))}if(g){console.log("* need another requestAnimationFrame renderLoopID = "+q)}}};if(!n._ticking){n._ticking=true;if(b.safari){q=window.webkitRequestAnimationFrame(l.bind(n))}else{q=window.requestAnimationFrame(l.bind(n))}if(g){console.log("* requestAnimationFrame renderLoopID = "+q)}}},onTasksCompleted:function(j){return this._modelEvents.subscribe({event:"renderTasksCompleted"},j)},onAllNamespacedTasksCompleted:function(j,k){return this._modelEvents.subscribe({event:"renderTasksNamespaceCompleted"},function(l){if(j===l.namespace){k.call(this,l)}})},onFirstNamespacedTasksAdded:function(j,k){return this._modelEvents.subscribe({event:"renderTasksNamespaceCreated"},function(l){if(j===l.namespace){k.call(this,l)}})}});return d});var TreeNodeModelChangeStates={Unchanged:0,AttributesChanged:1<<0,NodeAdded:1<<1,NodeToBeRemoved:1<<2};define("DS/TreeModel/TreeNodeModel",["UWA/Core","UWA/Class","DS/CoreEvents/ModelEvents","DS/Utilities/Debug","DS/Utilities/Array","DS/Utilities/Data","DS/Utilities/RAFDispatcher"],function(f,a,b,i,j,c,d){var h=-1;function e(l){var n=this;this.defaultOptions={label:"",badges:{topLeft:null,topRight:null,bottomLeft:null,bottomRight:null},icons:[],grid:{},children:null,data:{},useAsyncPreExpand:undefined,getAttributeValueForFiltering:function(o){return n.getAttributeValue(o)},getAttributeValueForGrouping:function(o){return n.getAttributeValue(o)}};this._options=f.extend(f.clone(this.defaultOptions),l);var n=this;Object.defineProperty(this,"options",{get:function k(){if(n._isUsingDataModel()){var o={getAttributeValueForFiltering:function(p){return n.getAttributeValue(p)},getAttributeValueForGrouping:function(p){return n.getAttributeValue(p)}};n._getDataModel()._data=f.extend(o,n._getDataModel()._data);return n._getDataModel()._data}else{return n._options}},set:function k(o){if(n._isUsingDataModel()){n._getDataModel()._setData(o)}else{n._options=o}}});n._listOfChildren=null;Object.defineProperty(this,"__children",{get:function k(){if(n._isUsingDataModel()){return n._listOfChildren}else{return n.options.children}},set:function k(o){if(n._isUsingDataModel()){n._listOfChildren=o}else{n.options.children=o}}});this._modelEvents=new b({target:this});this._id=h++;this._nodeIsAsync=false;this._isHighlighted=false;this._isHidden=false;this.__expandAllCounter=0;this._nodeDepth=-1;this._rowID=null;this._parentNode=null;this._expandState="noExpandState";this.__dataModelID=null;if(this.options.children){this._preventResetChildren=(this.options.children.length===0);this._expandState="expandState";var m=this.options.children;this.__children=[];this.options.children=[];this.addChild(m)}this._changeStates=TreeNodeModelChangeStates.Unchanged;if(this.options._isTrueRoot){e.prototype.addRoot=function(o,p){return this.addChild(o,p)}}var n=this;this._modelEvents.subscribe({event:"DataModel:update"},function(o){o.stopPropagation();n.withTransactionUpdate(function(){n.notifyModelUpdate(o.data.grid)})})}e.prototype._setDataModel=function(k){this.__dataModelSet=k._getDataModelSet();this.__dataModelID=k._getID();k._getModelEvents()._addParent(this.getModelEvents());this.notifyModelUpdate()};e.prototype._removeDataModel=function(k){if(this.__dataModelID!==undefined&&this.__dataModelSet){k._getModelEvents()._unsetParent(this.getModelEvents());this.__dataModelID=null;this.__dataModelSet=null}this.notifyModelUpdate()};e.prototype._getDataModel=function(){return this.__dataModelSet.getDataModel(this.__dataModelID)};e.prototype._isUsingDataModel=function(){return this.__dataModelID!==null&&this.__dataModelID!==undefined};e.prototype.getModelEvents=function(){return this._modelEvents};e.prototype.addEventListener=function(k,l){return this.getModelEvents().addEventListener(k,l)};e.prototype.removeEventListener=function(k){this.getModelEvents().unsubscribe(k)};e.prototype._getRowID=function(k){if(k){this._rowID=this._computeRowID()}return this._rowID};e.prototype._getID=function(){return this._id};e.prototype.addChild=function(m,o){var n="[TreeNodeModel] -- Add child --";i.beginMeasure(n);var l;if(m instanceof Array){l=this._loadModel(m,this)}else{if(m instanceof e){if(m.isAscendantOf(this)){console.warn("TreeNodeModel: Cannot add a parent node as a child");return}else{var k=m.getParent();if(k){k.removeChild(m,true)}}}l=this._loadModel([m],this,o)}i.endMeasure(n);return l};e.prototype.moveChild=function(k,l){k.__keepSelection=true;this.addChild(k,l);delete k.__keepSelection},e.prototype.notifyModelUpdate=function(k){var l=this._getNodeInfos();if(k){l.attributes=k}this._modelEvents.publish({event:"nodeModelUpdate",data:l,context:this})};e.prototype.setAttribute=function(m,o){if((!this._referenceValues||!this._referenceValues.hasOwnProperty(m))&&this.options.grid.hasOwnProperty(m)&&!f.equals(this.options.grid[m],o)){var l=this.getTreeDocument();if(l&&l.getUseChangeTransactionMode()){this.setReferenceValue(m,this.options.grid[m]);this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}}this.options.grid[m]=o;var n=this._getNodeInfos();n.changedAttribute=m;n.changedAttributeValue=o;this._modelEvents.publish({event:"attributeChanged",data:n,context:this});var k={};k[m]=o;this.notifyModelUpdate(k)};e.prototype.updateOptions=function(n){var l={};if(n&&n.grid){var k=this.getTreeDocument();for(var m in n.grid){if(this.options.grid[m]!==n.grid[m]){l[m]=n.grid[m];if((!this._referenceValues||!this._referenceValues.hasOwnProperty(m))&&this.options.grid.hasOwnProperty(m)&&k&&k.getUseChangeTransactionMode()){this.setReferenceValue(m,this.options.grid[m]);this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}}}}if(this._isUsingDataModel()){this._getDataModel().update(n)}else{f.extend(this.options,n,true);this.withTransactionUpdate(function(){this.notifyModelUpdate(l)})}};e.prototype.onAttributeChange=function(k){return this._modelEvents.subscribe({event:"attributeChanged"},k)};e.prototype.getReferenceValue=function(k){var l;if(this._referenceValues&&this._referenceValues.hasOwnProperty(k)){l=this._referenceValues[k]}else{l=this.options.grid[k]}return l};e.prototype.setReferenceValue=function(k,l){if(!this._referenceValues){this._referenceValues={}}this._referenceValues[k]=f.clone(l,false);if(!f.equals(this.options.grid[k],l)){this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}else{this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged}};e.prototype.resetToReferenceValues=function(){if(this._referenceValues){var k=this;var l={};Object.keys(this._referenceValues).forEach(function(m){if(k.options.grid.hasOwnProperty(m)&&!f.equals(k.options.grid[m],k._referenceValues[m])){l[m]=f.clone(k._referenceValues[m],false)}});this.updateOptions({grid:l});this._referenceValues=null}this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged};e.prototype.setValuesAsReference=function(){if(this._referenceValues){this._referenceValues=null;this.notifyModelUpdate()}this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged};e.prototype.getChangeStates=function(){return this._changeStates};e.prototype.cancelChanges=function(l){if(l){var n=this.getChildren();if(n){for(var m=n.length;m>=0;m--){var o=n[m];if(o){o.cancelChanges(true)}}}}if(this._changeStates&TreeNodeModelChangeStates.NodeAdded){var k=this.getParent();if(k){k.removeChild(this,true)}}else{if(this._changeStates&TreeNodeModelChangeStates.AttributesChanged){this.resetToReferenceValues()}if(this._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved){this._changeStates&=~TreeNodeModelChangeStates.NodeToBeRemoved;this.notifyModelUpdate()}}this._changeStates=TreeNodeModelChangeStates.Unchanged};e.prototype.acceptChanges=function(l){if(l){var n=this.getChildren();if(n){for(var m=n.length;m>=0;m--){var o=n[m];if(o){o.acceptChanges(true)}}}}if(this._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved){var k=this.getParent();if(k){k.removeChild(this,true)}}else{if(this._changeStates&TreeNodeModelChangeStates.AttributesChanged){this.setValuesAsReference()}if(this._changeStates&TreeNodeModelChangeStates.NodeAdded){this._changeStates&=~TreeNodeModelChangeStates.NodeAdded;this.notifyModelUpdate()}}this._changeStates=TreeNodeModelChangeStates.Unchanged};e.prototype.prepareUpdate=function(){this._modelEvents.publish({event:"prepareUpdate",data:this._getNodeInfos(),context:this})};e.prototype.pushUpdate=function(){this._modelEvents.publish({event:"pushUpdatePrivate",data:this._getNodeInfos(),context:this});this._modelEvents.publish({event:"pushUpdate",data:this._getNodeInfos(),context:this})};e.prototype.insertBefore=function(m,k){this.prepareUpdate();if(k){if(m.getParent()){m.remove()}var l=k._getLocalID();this.addChild(m,l)}else{this.addChild(m)}this.pushUpdate()};e.prototype._setParent=function(k){this._parentNode=k;this._nodeDepth=k.getNodeDepth()+1};e.prototype._unsetParent=function(){this._parentNode=null;this._nodeDepth=-1};e.prototype.highlight=function(){this._isHighlighted=true;this._modelEvents.publish({event:"highlight",data:this._getNodeInfos(),context:this})};e.prototype.unhighlight=function(){this._isHighlighted=false;this._modelEvents.publish({event:"unhighlight",data:this._getNodeInfos(),context:this})};e.prototype.onHighlight=function(k){return this._modelEvents.subscribe({event:"highlight"},k)};e.prototype.onUnhighlight=function(k){return this._modelEvents.subscribe({event:"unhighlight"},k)};e.prototype.isHighlighted=function(){return this._isHighlighted};e.prototype.preSelect=function(m){var l=this.getTreeDocument();if(l){if(!this.isPreSelected()){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(m){l.getPXSO().unique(this)}else{l.getPXSO().add(this)}this._isPreSelected=true;this.pushUpdate()}}else{if(l.getXSO().get().length>1){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(m){l.getPXSO().unique(this)}this._isPreSelected=true;this.pushUpdate()}}}}else{console.warn("You tried to pre-select a treeNode which is not attached to a tree document")}};e.prototype.unPreSelect=function(){if(this.isPreSelected()){var k=this.getTreeDocument();if(k){this.prepareUpdate();k.getPXSO().remove(this);this._isPreSelected=false;this.pushUpdate()}else{console.warn("You tried to pre-select a treeNode which is not attached to a tree document")}}};e.prototype.isPreSelected=function(){var k=this.getTreeDocument();if(k){return k.getPXSO().isIn(this)}else{return this._isPreSelected}};e.prototype.select=function(n){var l=this.getTreeDocument();if(l){if(!this.isSelected()){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(n){var m=l.getXSO().get();l.getXSO().unique(this);m.forEach(function(o){o.selectionChangeIsNotFromUI()})}else{l.getXSO().add(this)}this._isSelected=true;this.selectionChangeIsNotFromUI();this.pushUpdate()}}else{if(l.getXSO().get().length>1){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(n){var m=l.getXSO().get();l.getXSO().unique(this);m.forEach(function(o){o.selectionChangeIsNotFromUI()})}this._isSelected=true;this.selectionChangeIsNotFromUI();this.pushUpdate()}}}}else{console.warn("You tried to select a treeNode which is not attached to a tree document")}};e.prototype.isSelectionChangeFromUI=function(){return Boolean(this.__selectionChangeisFromUI)};e.prototype.selectionChangeIsFromUI=function(){this.__selectionChangeisFromUI=true};e.prototype.selectionChangeIsNotFromUI=function(){this.__selectionChangeisFromUI=false};e.prototype.unselect=function(){if(this.isSelected()){var k=this.getTreeDocument();if(k){this.prepareUpdate();k.getXSO().remove(this);this._isSelected=false;this.pushUpdate()}else{console.warn("You tried to select a treeNode which is not attached to a tree document")}}};e.prototype.onSelect=function(k){return this._modelEvents.subscribe({event:"select"},k)};e.prototype.onUnselect=function(k){return this._modelEvents.subscribe({event:"unselect"},k)};e.prototype.isSelected=function(){var k=this.getTreeDocument();if(k){return k.getXSO().isIn(this)}else{return this._isSelected}};e.prototype.hide=function(k){this.withTransactionUpdate(function(){this._isHidden=true;if(!k){this.unhighlight();this.unselect()}this._modelEvents.publish({event:"hide",data:this._getNodeInfos(),context:this});var l=this.getFirstVisibleParent();if(l){l._updateExpanderState()}})};e.prototype.show=function(){this.withTransactionUpdate(function(){this._isHidden=false;this._modelEvents.publish({event:"show",data:this._getNodeInfos(),context:this});var k=this.getFirstVisibleParent();if(k){k._updateExpanderState()}})};e.prototype.isHidden=function(){return this._isHidden};e.prototype.hideChildNodes=function(){this.withTransactionUpdate(function(){if(this.hasChildren()){this.getChildren().forEach(function(k){k.hide()});this._updateExpanderState()}})};e.prototype.showChildNodes=function(){this.withTransactionUpdate(function(){if(this.hasChildren()){this.getChildren().forEach(function(k){k.show()});this._updateExpanderState()}})};e.prototype._loadModel=function(p,t,m){this.prepareUpdate();var s=this;var n=[];var l,r;var q=p.length;for(var o=0;o<q;o++){var u=p[o];var k;if(u instanceof e){k=u}else{k={};k=f.extend({label:"",icons:[],grid:null,badges:null,data:null,manager:null},u);k.children=undefined;k.manager=l}if(t){r=t._addChild(k,m)}if(u instanceof e){n.push({tree:r})}else{if(u.children&&u.children.length){n.push({tree:r});n=n.concat(s._loadModel(u.children,r))}else{if(u.children){r.__children=[];r._expandState="expandState"}n.push({tree:r})}}}this.pushUpdate();return r};e.prototype.destroy=function(){if(this.hasChildren()){var k=this;this.getChildren().forEach(function(m){m.destroy()})}this._modelEvents.unsubscribeAll();this._modelEvents=null;delete this._modelEvents;this.defaultOptions=null;for(var l in this){if(this.hasOwnProperty(l)&&typeof this[l]!=="function"){this[l]=null}}},e.prototype._propagateDepth=function(){if(this.hasChildren()){var k=this;this.getChildren().forEach(function(l){l._nodeDepth=k.getNodeDepth()+1;l._propagateDepth()})}};e.prototype._addChild=function(n,m){var k=this._addChildNode(n,m);k._nodeDepth=this.getNodeDepth()+1;k._propagateDepth();var l=k._getNodeInfos();l.nodeIndex=k._getLocalID();this._modelEvents.publish({event:"addChild",data:l,context:this});return k};e.prototype.getNthChild=function(k){if(this.getChildren()){return this.getChildren()[k]}};e.prototype.getLastChild=function(){return this.getChildren()[this.getChildren().length-1]};e.prototype._dump=function(l,k){if(!k){k={}}l=f.extend({properties:[function(){return{property:"label",value:this.options.label}},function(){return{property:"grid",value:this.options.grid}},function(){return{property:"icons",value:this.options.icons}}]},l);var n=this;l.properties.forEach(function(p){if(f.typeOf(p)==="function"){var o=p.call(n);k[o.property]=o.value}});var m=this.getChildren();if(m){k.children=[];m.forEach(function(o){k.children.push(o._dump(l))});return k}return k};e.prototype.dump=function(l,k){return this._dump(l,k)};e.prototype.isAscendantOf=function(l){var k=l;while(k&&!k.options.isRoot){if(k===this){return true}k=k.getParent()}return false};e.prototype.isVisible=function(){return this._isVisible()};e.prototype._getLocalID=function(){var k=this.getParent();if(k){var l=k.getChildren();if(l){return l.indexOf(this)}}return 0};e.prototype._isTrueRoot=function(){return this.options?this.options._isTrueRoot:false};e.prototype.acceptNodeDropAt=function(m,k){if(!m){return false}var l=!m.isAscendantOf(this);if(l&&this.options.acceptNodeDropAt){l=this.options.acceptNodeDropAt.call(this,m,k)}return l};e.prototype.remove=function(l){var k=this.getParent();if(k){return k.removeChild(this,l)}else{console.warn("Cannot remove this node because its father is undefined")}};e.prototype.removeChild=function(r,p){if(r!==undefined){this.prepareUpdate();var q;var n=this.getChildren();var m;if(typeof r==="number"){m=r;r=n[m]}else{m=n.indexOf(r)}var k=this.getTreeDocument();if(k&&k.getUseChangeTransactionMode()&&!p){if(r&&!(r._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved)){r._changeStates|=TreeNodeModelChangeStates.NodeToBeRemoved;r.notifyModelUpdate()}}else{this._modelEvents.publish({event:"preRemoveChild",data:r._getNodeInfos(),context:this});r._unsetParent();r._detach(null);if(m!==-1){q=n.splice(m,1)[0]}if(n.length===0&&!this._preventResetChildren){this.__children=null}var o=true;for(var l=0;l<n.length;l++){if(n[l].isHidden()===false){o=false;break}}if(o){this._updateExpanderState()}this._modelEvents.publish({event:"removeChild",data:r._getNodeInfos(),context:this})}this.pushUpdate();return q}else{console.warn("Cannot remove an undefined child")}};e.prototype.removeChildren=function(){this.prepareUpdate();var n=[];var l=this.getChildren();var m=this;if(l){for(var k=l.length-1;k>=0;k--){n.push(m.removeChild(l[0]))}}this.pushUpdate();return n};e.prototype._addChildNode=function(o,n){var m;if(o instanceof e){m=o;var k=m.getParent();if(k){k.removeChild(m,true)}}else{m=new e(o)}var l=this.getTreeDocument();if(l){m._modelEvents._setParent(l._getTrueRoot()._modelEvents)}else{m._modelEvents._setParent(this._modelEvents)}if(!this.__children){this.__children=[]}if(n===undefined){n=this.__children.push(m)-1}else{this.__children.splice(n,0,m)}m._localID=n;m._parentNode=this;this._updateExpanderState();if(l&&l.getUseChangeTransactionMode()){m._changeStates|=TreeNodeModelChangeStates.NodeAdded}return m};e.prototype._detach=function(){this._rowID=null;if(this.hasChildren()){j.optimizedForEach(this.getChildren(),function(l,k){l._detach()})}};e.prototype.isExpanded=function(){if(this._depth===0){return true}var k=this.getState();return k==="expanded"||k==="partiallyExpanded"};e.prototype.onPreExpand=function(k){return this._modelEvents.subscribe({event:"preExpand"},k)};e.prototype.onPreExpandAll=function(k){return this._modelEvents.subscribe({event:"preExpandAll"},k)};e.prototype.onPostExpand=function(k){return this._modelEvents.subscribe({event:"postExpand"},k)};e.prototype.onPreCollapse=function(k){return this._modelEvents.subscribe({event:"preCollapse"},k)};e.prototype.onPostCollapse=function(k){return this._modelEvents.subscribe({event:"postCollapse"},k)};e.prototype.preExpandDone=function(l){l=f.extend({preventExpandAll:false,state:"expanded"},l);var k=this.getTree();if(k){k._syncRowIndexes()}this._modelEvents.publish({event:"PRE_EXPAND_DONE",context:this,data:l})};e.prototype._getNodeInfos=function(){return{nodeModel:this,virtualRowID:this._rowID,nodeLocalID:this._localID}};e.prototype.setState=function(k){k=f.extend({state:null},k);if(k.state!==null){var l={noChildren:"noExpandState",expanding:"expandingState",partiallyExpanded:"partiallyExpandedState",expanded:"collapseState",collapsed:"expandState"};if(!(this.getState()==="noChildren"&&k.state==="expanding")){this._expandState=l[k.state];this._modelEvents.publish({event:"expandStateChange",context:this,data:k})}}};e.prototype.getState=function(){var k={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};return k[this._expandState]};e.prototype.expand=function(k){return this._privateExpand(k)};e.prototype.expandNLevels=function(k){k=f.extend({expandAll:false,numberOfLevelsToExpand:1},k);return this._privateExpand(k)};e.prototype._privateExpand=function(u,n,l){var r=this;u=f.extend({expandAll:false,interactiveExpandAll:false,numberOfLevelsToExpand:1,onExpandComplete:function(v){}},u);this._modelEvents.publish({event:"preExpandPrivateAsync",data:s,context:this});if(n===undefined){n=0}n++;if(l===undefined){l=this;this.__expandAllCounter=0}l._beginOfSubExpand(u);var q=this.getTreeDocument();var m=r.options.useAsyncPreExpand!==undefined?r.options.useAsyncPreExpand:(q?q.options.useAsyncPreExpand:false);var k=r.getChildren();var t=true;if(k&&k.length===0){t=false}if(k){for(var o=0;o<k.length;o++){if(k[o].isHidden()===false){t=false;break}}}if(!t||r._expandState==="expandState"){r.setState({state:"expanding"});var s=f.extend(r._getNodeInfos(),u);var p=function(y,w){if(w===undefined){w="expanded"}var x={noChildren:"noExpandState",expanding:"expandingState",partiallyExpanded:"partiallyExpandedState",expanded:"collapseState",collapsed:"expandState"};r._expandState=x[w];r._isExpanded=true;r._modelEvents.publish({event:"expand",data:s,context:r});i.log("3) expand ",r.options.label);if((u.expandAll)||(n<u.numberOfLevelsToExpand)){var v=r.getVisibleChildren();if(v&&!y){j.optimizedForEach(v,function(A,z){A._privateExpand(u,n,l)})}else{if(u.onExpandComplete){u.onExpandComplete.call(r,u)}}}l._endOfSubExpand(u,y);r._modelEvents.publish({event:"postExpand",data:s,context:r});i.log("4) post expand on ",r.options.label);r._modelEvents.publish({event:"postExpandPrivate",data:s,context:r})};if(m){i.log("watching pre expand on ",r.options.label);r._modelEvents.subscribeOnce({event:"PRE_EXPAND_DONE"},function(v){i.log("2) async pre expand done! ",r.options.label);p.call(this,v.data.preventExpandAll,v.data.state)})}i.log("1) pre expand ",r.options.label);r._modelEvents.publish({event:"preExpandPrivate",data:s,context:r});r._modelEvents.publish({event:"preExpand",data:s,context:r});if(!m){i.log("2) sync pre expand done! ",r.options.label);p()}}else{if(u.onExpandComplete){u.onExpandComplete.call(r,u)}l._endOfSubExpand(u,false)}};e.prototype._beginOfSubExpand=function(k){this.prepareUpdate();this.__expandAllCounter++};e.prototype._endOfSubExpand=function(k,l){this.__expandAllCounter--;this.pushUpdate();if(this.__expandAllCounter===0){if((k&&k.expandAll)){this._modelEvents.publish({event:"postExpandAll",data:this._getNodeInfos(),context:this})}}if(this.__expandAllCounter<0){console.error("too many calls of _endOfSubExpand")}};e.prototype.withTransactionUpdate=function(k){if(k){this.prepareUpdate();try{k.call(this,this._getNodeInfos())}finally{this.pushUpdate()}}};e.prototype.expandAll=function(k){this._modelEvents.publish({event:"preExpandAll",data:this._getNodeInfos(),context:this});if(!this.options._isTrueRoot){this.expand({expandAll:true,onExpandComplete:k&&k.onExpandComplete})}};e.prototype.processDescendants=function(l){var k={async:false,onlyVisibleNodes:false,processNode:function(m){},treeTraversalOrder:"preOrder",onComplete:function(){}};l=f.extend(k,l);return this._getDescendantAndProcess(undefined,l)};e.prototype._getDescendantAndProcess=function(n,l){var k={async:false,onlyVisibleNodes:false,treeTraversalOrder:"preOrder"};l=f.extend(k,l);if(n===undefined){n=[]}else{n.push(this)}var m=this.getChildren();if(m){if(l.onCompleteCB===undefined){j.optimizedForEach(m,function(o){if(!o){return}if(l.onlyVisibleNodes){if(o.isVisible()){if(l.treeTraversalOrder==="postOrder"){if(o.hasChildren()&&o.isExpanded()){o._getDescendantAndProcess(n,l)}}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}n.push(o);if(l.treeTraversalOrder==="preOrder"){if(o.hasChildren()&&o.isExpanded()){o._getDescendantAndProcess(n,l)}}}}else{if(l.treeTraversalOrder==="postOrder"){o._getDescendantAndProcess(n,l)}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}if(l.treeTraversalOrder==="preOrder"){o._getDescendantAndProcess(n,l)}}})}else{c.forEach(m,function(o){if(l.treeTraversalOrder==="postOrder"){o._getDescendantAndProcess(n,l)}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}if(l.treeTraversalOrder==="preOrder"){o._getDescendantAndProcess(n,l)}},50,l.onCompleteCB)}}return n};e.prototype.getAllDescendants=function(k){return this._getDescendantAndProcess(k)};e.prototype.collapseAll=function(){this.prepareUpdate();this._modelEvents.publish({event:"preCollapseAll",data:this._getNodeInfos(),context:this});if(!this.options._isTrueRoot){this.collapse()}this.processDescendants({processNode:function(){this.collapse()}});this._modelEvents.publish({event:"postCollapseAll",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.matchSearch=function(){this._isMatchingSearch=true;this.prepareUpdate();this._modelEvents.publish({event:"matchSearch",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.unmatchSearch=function(){this._isMatchingSearch=false;this.prepareUpdate();this._modelEvents.publish({event:"unmatchSearch",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.isMatchingSearch=function(){return this._isMatchingSearch};e.prototype.collapse=function(k){if(k===undefined){k={notify:true}}if(this.getChildren()||this.getState()==="expanded"){this._expandState="expandState";this._isExpanded=false}if(k.notify){this.prepareUpdate();this._modelEvents.publish({event:"preCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this._modelEvents.publish({event:"collapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this._modelEvents.publish({event:"postCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this.pushUpdate()}};e.prototype.search=function(k,m){k=f.extend({match:function(p){},shouldStop:function(p){return false},useTransaction:true},k);var n={nodeModel:this};if(k.shouldStop(this)){return}if(k.useTransaction){this.prepareUpdate()}if(m===undefined){m=[]}else{var o=k.match(n);if(o){m.push(this)}}var l=this.getChildren();if(l){l.forEach(function(p){p.search(k,m)})}this._modelEvents.publish({event:"search",data:this._getNodeInfos(),context:this});if(k.useTransaction){this.pushUpdate()}return m};e.prototype.getNumberOfDescendants=function(l){if(l===undefined){l=0}var k=this.getChildren();if(k){l=l+k.length;k.forEach(function(m){l=m.getNumberOfDescendants(l)})}return l};e.prototype.getNumberOfVisibleDescendants=function(l){if(l===undefined){l=0}var k=this.getVisibleChildren();if(k){l=l+k.length;k.forEach(function(m){l=m.getNumberOfVisibleDescendants(l)})}return l};e.prototype.getTree=function(){if(this.options._isTrueRoot){return this.options.tree}else{var k=this.getRoot();if(k){return k._tree}}};e.prototype.getRoot=function(){var k=this;while(k&&!k.isRoot()){k=k.getParent()}return k};e.prototype.getPath=function(){var k=[];k.push(this);this._getAndProcessParents(function(l){k.push(l.nodeModel)});return k.reverse()};e.prototype.buildPath=function(l){var k={path:"",buildPath:function(o,n,m){return o+n.options.label+"/"}};l=f.extend(k,l);this.getPath().forEach(function(n,m){l.path=l.buildPath.call(n,l.path,n,m)});return l.path};e.prototype._getAndProcessParents=function(m){var k=this;var l=0;while(k&&!k.isRoot()){k=k.getParent();if(k&&m!==undefined){m.call(k,k._getNodeInfos())}l++}return k};e.prototype._getTrueRoot=function(){var k=this.getRoot();if(k){return k.getParent()}else{if(this._isTrueRoot()){return this}}};e.prototype.getTreeDocument=function(){var k=this._getTrueRoot();if(k){return k._treeDocument}};e.prototype.reverseExpand=function(){var k=this;while(k&&!k.isRoot()){k=k.getParent();if(!k.isExpanded()){k.expand()}}};e.prototype.getParents=function(m){var k=this;var l=[];while(k){k=k.getParent();if(k&&(m||!k.options._isTrueRoot)){l.push(k)}}return l};e.prototype.getFirstVisibleParent=function(l){var k=this;while(k&&!k.isVisible()){k=k.getParent()}return k};e.prototype.getBrothers=function(){var k=this.getParent();var l=this;if(k){return k.getChildren().filter(function(m){return m!==l})}};e.prototype.getNextBrother=function(){var l=this.getParent();if(l){var k=l.getChildren();if(k){var m=k.indexOf(this);if(m>-1){if(m+1<k.length){return k[m+1]}else{l.getNextBrother()}}}}};e.prototype.getPreviousBrother=function(){var l=this.getParent();if(l){var k=l.getChildren();if(k){var m=k.indexOf(this);if(m>0){return k[m-1]}}}};e.prototype._getLastVisibleNode=function(){if(this.hasChildren()===false||(this.hasChildren()===true&&this.isExpanded()===false)){return this}else{var k=this.getChildren();return k[k.length-1]._getLastVisibleNode()}};e.prototype.getPreviousNode=function(){var l;var m=this.getPreviousBrother();if(m){if(m.hasChildren()===false||(m.hasChildren()===true&&m.isExpanded()===false)){l=m}else{l=m._getLastVisibleNode()}}else{var k=this.getParent();l=k}if(l._isTrueRoot()){}else{return l}};e.prototype.getNextNode=function(l){if(this.hasChildren()&&!l){return this.getChildren()[0]}else{var m=this.getNextBrother();if(m){return m}else{var k=this.getParent();if(k){return k.getNextNode(true)}else{}}}};e.prototype.getNextVisibleNode=function(){var k=this.getNextNode((this.hasChildren()&&!this.isExpanded()));if(k&&k.isVisible()===false){return k.getNextVisibleNode()}else{return k}};e.prototype.getPreviousVisibleNode=function(){var k=this.getPreviousNode();if(k&&k.isVisible()===false){return k.getPreviousVisibleNode()}else{return k}};e.prototype._getPreviousBrothers=function(){var k=[];var o=this.getParent();if(o){var n=o.getChildren();var l=n.indexOf(this);for(var m=0;m<l;m++){k.push(n[m])}}return k};e.prototype._computeRowID=function(){if(this.isVisible()){var o=0;var k=function(p){p._getPreviousBrothers().filter(function(q){return q.isVisible()}).forEach(function(q){o=o+q.getNumberOfVisibleDescendants()+1})};k(this);var n=this.getParents(true).filter(function(p){return p.isVisible()||p._isTrueRoot()});if(n.length>1){for(var m=0;m<n.length;m++){var l=n[m];if(!l.options._isTrueRoot){o++}k(l)}}return o}else{return null}};e.prototype.hasChildren=function(){var k=this.getChildren();if(k&&k.length>0){return true}else{return false}};e.prototype.getParent=function(){return this._parentNode};e.prototype.isLastChild=function(){if(!this.getParent()){return false}var l=this.getParent().getChildren();var n=l.indexOf(this);for(var k=n+1;k<l.length;k++){var m=l[k];if(m.isHidden()===false&&m.isFiltered()===false){return false}}return true};e.prototype.getNthParent=function(m){var k=this;var l=0;while(k&&l<m){k=k.getParent();l++}return k};e.prototype.getNodeDepth=function(){if(this._nodeDepth===null&&this._nodeDepth===undefined){this._nodeDepth=this.getParents().length}return this._nodeDepth};e.prototype.isRoot=function(){var k=this.getParent();if(this.getNodeDepth()===0&&k&&k._isTrueRoot()){return true}else{return false}};e.prototype._isVisible=function(){if(this.isHidden()||this.isFiltered()){return false}if(this.isRoot()){return true}var k=this.getParent();if(k&&k.isExpanded()){return k.isVisible()}return false};e.prototype._updateExpanderState=function(){var l=this.getChildren();switch(f.typeOf(l)){case"string":this._expandState="asyncState";this._nodeIsAsync=true;break;case"array":var m=true;if(l.length===0){m=false}for(var k=0;k<l.length;k++){if(l[k].isHidden()===false){m=false;break}}if(m){this._expandState="noExpandState"}else{if(!this.isExpanded()){this._expandState="expandState"}else{this._expandState="collapseState"}}this._nodeIsAsync=false;break;default:this._expandState="noExpandState";break}};e.prototype.getChildren=function(){return this.__children};e.prototype.getNumberOfChildren=function(){var k=this.getChildren();if(k){return k.length}else{return 0}};e.prototype.getVisibleChildren=function(k){var l=this.getChildren();if(l instanceof Array&&l.length>0){if(k){return l.filter(function(m){return !m.isHidden()})}else{return l.filter(function(m){return m.isVisible()})}}};e.prototype.getNumberOfVisibleChildren=function(k){var m=0;var l=this.getChildren();if(l instanceof Array&&l.length>0){if(k){l.forEach(function(n){if(!n.isHidden()){m++}})}else{l.forEach(function(n){if(n.isVisible()){m++}})}}return m};e.prototype.getLabel=function(){return this.options.label};e.prototype.getIcons=function(){return this.options.icons};e.prototype.getIcons=function(){return this.options.icons};e.prototype.setLabel=function(k){this.updateOptions({label:k})};e.prototype.setBadges=function(k){if(k!==null){if(!this.options.badges){this.options.badges={}}var l=f.extend(this.options.badges,k);this.updateOptions({badges:l})}else{this.options.badges=null;this.updateOptions({badges:null})}};e.prototype.getBadges=function(){return this.options.badges};e.prototype.sortChildren=function(m){m=f.extend({isRecursive:false,sortFunction:function(p,l){return p.options.label<l.options.label?-1:1}},m);if(this.hasChildren()){this.prepareUpdate();var o=this.getChildren();o.sort(m.sortFunction);if(m.isRecursive){for(var n=0,k=o.length;n<k;n++){if(o[n].hasChildren()){o[n].sortChildren(m)}}}this._modelEvents.publish({event:"sortChildren",data:this._getNodeInfos(),context:this});this.pushUpdate()}};function g(k){e.call(this,k)}g.prototype=Object.create(e.prototype);g.prototype.constructor=g;g.prototype.getIdentifier=function(){return this._options.identifier};g.prototype.getFakeNodesTable=function(){return this._options.fakeNodesTable};e.prototype.getFakeNodesTable=function(){return this._fakeNodesTable};g.prototype.getProperty=function(){return this._options.property};g.prototype.getNumberOfOriginalChildren=function(){return Object.assign({},this._options.numberOfOriginalChildren)};g.prototype.setNumberOfOriginalChildren=function(k){if(k.total!==this._options.numberOfOriginalChildren.total||k.notHidden!==this._options.numberOfOriginalChildren.notHidden){this._options.numberOfOriginalChildren=Object.assign({},k);this.updateOptions({label:this.getProperty()+": "+this.getIdentifier()+" ("+k.notHidden+")"})}if(k.notHidden>0){if(this.isHidden()){this.show()}if(!this.isExpanded()){this.expand()}}else{if(!this.isHidden()){this.hide()}}if(k.total===0){this.remove()}};e.prototype._addCallbacksForGrouping=function(){var l=this._getTrueRoot();if(!l.__groupingCallbackSet){l.__groupingCallbackSet=true;var k=function(t){var s=t.data.nodeModel;var n=s.getParent();if(!s||s._haveToRecomputeLabelAutomatically()||!n||!n._haveToRecomputeLabelAutomatically()){return}l.prepareUpdate();var m=n.getNumberOfOriginalChildren().notHidden;var r=n._getAndUpdateNumberOfDirectOriginalChildren().notHidden;var p=r-m;for(var q=n.getParent();q._haveToRecomputeLabelAutomatically();q=q.getParent()){var o=q.getNumberOfOriginalChildren();o.notHidden+=p;q.setNumberOfOriginalChildren(o)}l.pushUpdate()};l.addEventListener("show",k);l.addEventListener("hide",k)}};g.prototype._getAndUpdateNumberOfDirectOriginalChildren=function(){var o=0,n=0;var m=this.getChildren();if(m){for(var k=m.length;k>0;k--){var p=m[k-1];var l=p._getAndUpdateNumberOfDirectOriginalChildren();o+=l.total;n+=l.notHidden;if(l.total===0){delete this.getFakeNodesTable()[p.getIdentifier()]}}}this.setNumberOfOriginalChildren({total:o,notHidden:n});return this.getNumberOfOriginalChildren()};e.prototype._getAndUpdateNumberOfDirectOriginalChildren=function(){return{total:1,notHidden:this.isHidden()?0:1}};g.prototype._haveToRecomputeLabelAutomatically=function(){return true};e.prototype._haveToRecomputeLabelAutomatically=function(){return false};g.prototype._updateLabelAutomatically=function(){var k=this.getParent();if(k&&k._haveToRecomputeLabelAutomatically()){k._updateLabelAutomatically();return}this._getAndUpdateNumberOfDirectOriginalChildren()};e.prototype._updateLabelAutomatically=function(){var k=this.getChildren();if(k&&k.length>0&&k[0]._haveToRecomputeLabelAutomatically()){k.forEach(function(l){l._updateLabelAutomatically()})}};g.prototype._canBeGrouped=function(){return false};e.prototype._canBeGrouped=function(){return true};e.prototype._groupChild=function(l,o){if(!o||o.length===0){if(l.getParent()!==this){this.moveChild(l)}return}var m=l.options.getAttributeValueForGrouping(o[0]);if(m===undefined||m===""){m="NA"}var k=this.getFakeNodesTable();var n=k[m];if(!n){n=new g({property:o[0],identifier:m,fakeNodesTable:{},numberOfOriginalChildren:{total:0,notHidden:0}});k[m]=n;this.addChild(n)}if(n.isHidden()){n.show()}o.shift();n._groupChild(l,o)};g.prototype._groupChildren=function(k){return};e.prototype._groupChildren=function(p){var n=this.getChildren();if(!n){return}var l=0;for(var k=0;k<n.length;){var o=n[k];if(o._canBeGrouped()){o.__initialIdxInParentChildren=l++;var m=p.slice();this._groupChild(o,m)}else{k++}}};g.prototype.groupChildren=function(k){return};e.prototype.groupChildren=function(l){this.prepareUpdate();var k=this.getTreeDocument();var m=k.getUseChangeTransactionMode();k.setUseChangeTransactionMode(false);this.ungroupChildren(l&&l.propertiesToGroup);if(l&&l.propertiesToGroup&&l.propertiesToGroup.length>0){if(!this._fakeNodesTable){this._fakeNodesTable={}}this._addCallbacksForGrouping();this._groupChildren(l.propertiesToGroup);this._updateLabelAutomatically()}this._modelEvents.publish({event:"groupChildren",data:this._getNodeInfos(),context:this});k.setUseChangeTransactionMode(m);this.pushUpdate()};g.prototype._removeGrouping=function(m,s,n,q){var l=this.getChildren();if(l&&l.length>0){var p=q||!s||s.length<=n||s[n]!==this.getProperty();for(var r=l.length;r>0;r--){var k=l[r-1];var o=k._removeGrouping(m,s,n+1,p);if(o){delete this.getFakeNodesTable()[k.getIdentifier()]}}if(p){this.remove(true)}else{this.hide()}return p}};e.prototype._removeGrouping=function(k,l,n,m){if(k!==this.getParent()){this.__keepSelection=true;k.addChild(this);delete this.__keepSelection}return false};g.prototype.ungroupChildren=function(k){return};e.prototype.ungroupChildren=function(n){var l=this.getChildren();if(!l||l.length===0||!this.getFakeNodesTable()){return}for(var k=l.length;k>0;k--){var o=l[k-1];var m=o._removeGrouping(this,n,0,false);if(m){delete this.getFakeNodesTable()[o.getIdentifier()]}}if(Object.keys(this.getFakeNodesTable()).length===0){this._fakeNodesTable=undefined;delete this._fakeNodesTable}l.sort(function(q,p){if(q.__initialIdxInParentChildren===undefined){return p.__initialIdxInParentChildren===undefined?0:1}if(p.__initialIdxInParentChildren===undefined){return q.__initialIdxInParentChildren===undefined?0:-1}return q.__initialIdxInParentChildren<p.__initialIdxInParentChildren?-1:1})};e.prototype.getAttributeValue=function(k){if(k==="label"){return this.getLabel()}return this.options.grid[k]};e.prototype.isFiltered=function(){return this.__filterCpt!==undefined&&this.__filterCpt>0};g.prototype.canBeFiltered=function(){return false};e.prototype.canBeFiltered=function(k){return true};e.prototype.hasNoRepresentation=function(){return false};e.prototype.incrementFilteredCount=function(){if(!this.__filterCpt){this.__filterCpt=0}this.__filterCpt++};e.prototype.decrementFilteredCount=function(){this.__filterCpt--};e.extendNode=function(k){var o=function(p){if(k.defaultOptions){this.defaultOptions=f.extend(f.clone(e.prototype.defaultOptions),k.defaultOptions)}if(this.defaultOptions===undefined){this.defaultOptions={}}this.options=f.extend(this.defaultOptions,p);e.call(this,p)};o.prototype=Object.create(this.prototype);o.prototype.constructor=o;o.extendNode=this.extendNode;for(var n in k){var m=k[n];if(n!=="defaultOptions"){if(typeof m==="function"){o.prototype[n]=(function l(r,q,p){return function(){if(r.prototype[q]){this._parent=r.prototype[q]}return p.apply(this,arguments)}})(e,n,m)}else{o.prototype[n]=m}}}return o};e.prototype.selectAll=function(l){var k=this.getTreeDocument();if(k){var m=this;this.withTransactionUpdate(function(){var n=[];m.processDescendants({processNode:function(o){if(k.options.shouldBeSelected.call(k,o.nodeModel)){n.push(o.nodeModel)}}});k.getXSO().add(n)})}};e.prototype.areAllChildrenSelected=function(){var m=true;if(this.hasChildren()){var l=this.getChildren();for(var k=0;k<l.length&&m;k++){if(l[k].isSelected()===false){m=false}}}return m};e.prototype.areAllChildrenUnselected=function(){var m=true;if(this.hasChildren()){var l=this.getChildren();for(var k=0;k<l.length&&m;k++){if(l[k].isSelected()===true){m=false}}}return m};e.prototype.unselectAll=function(k){this.withTransactionUpdate(function(){this.processDescendants({processNode:function(l){l.nodeModel.unselect()}})})};e.createTreeNodeDataModel=function(l,n){var m=new e();var k=l.createDataModel(n);m._setDataModel(k);return m};e.prototype.getStructurePath=function(){return this.buildPath({buildPath:function(m,l,k){return m+l._getLocalID()+"/"}})};return e});define("DS/Tree/TreeNodeModel",["DS/TreeModel/TreeNodeModel"],function(a){return a});define("DS/Core/Events",["DS/CoreEvents/Events"],function(a){console.log("Please, now use DS/CoreEvents/Events instead of DS/Core/Events");return a});define("DS/Menu/Menu",["DS/WebRecordEnabler/Adapter","DS/Core/PointerEvents","css!DS/Menu/assets/css/Menu.css"],function(h,f){var b=document.createElement("div");b.innerHTML=['<div class="wux-menu">','<div class="wux-menu-parent">','<div class="wux-menu-parent-up"></div>','<div class="wux-menu-parent-title"></div>',"</div>",'<div class="wux-menu-scroll-up wux-menu-scroll-disabled"></div>','<div class="wux-menu-scrollable">','<div class="wux-menu-container">','<div class="wux-menu-column wux-menu-column-left"></div>','<div class="wux-menu-column wux-menu-column-icon"></div>','<div class="wux-menu-column wux-menu-column-title"></div>','<div class="wux-menu-column wux-menu-column-accelerator"></div>','<div class="wux-menu-column wux-menu-column-submenu"></div>',"</div>","</div>",'<div class="wux-menu-scroll-down"></div>',"</div>",'<div class="wux-menu-cell"></div>','<div class="wux-menu-overlap"></div>','<div class="wux-menu-overlap-submenu"></div>','<div class="wux-menu-collection-item"></div>',].join("");var F=b.querySelector(".wux-menu");var o=b.querySelector(".wux-menu-cell");var V=b.querySelector(".wux-menu-overlap");var r=b.querySelector(".wux-menu-overlap-submenu");var N=b.querySelector(".wux-menu-collection-item");var T={};var U=[];var i=-1;var X=-1;var Y=-1;var d=-1;var n=50;var L=undefined;var B=undefined;var k=-1;var j=-1;var D=0;var v=0;var u=0;var c=false;const l=0;const M=1;const Z=2;var W=l;var s=[];var y=function y(ab,ac){this.content=ab;this.menu_uid=ac;this.previous_uid=-1;this.next_uid=-1;this.submenu_uid=-1;this.cells=[];this.uid=s.push(this)-1};var O=function O(ad,ab,af,ag,ae,ac){this.parent=ad;this.parentRecId=af;this.parentTitle=ag;this.content=ae;this.config=ac;this.parent_item_uid=(ab?ab.uid:-1);this.first_uid=-1;this.focus_uid=-1;this.uid=U.push(this)-1};function E(ab){if(ab.substr(0,4)==="url("){return ab}return'url("'+ab+'")'}function e(){var ab=undefined;if(h.isRecording()||h.isReplaying()){ab=document.getElementById("menu_record");if(!ab){ab=document.createElement("div");ab.setAttribute("id","menu_record");ab.setAttribute("data-rec-id","menu_record");ab.style.display="none";document.body.appendChild(ab);h.register(ab,"DS/MenuRec/MenuRec")}}return ab}O.prototype.buildView=function z(){if(this.parent&&!(this.parent instanceof O)){throw new Error("Invalid parent, parent must be a Menu instance.")}this.useTouchInput=false;if(this.config){if(this.config.input){if(this.config.input==="touch"){this.useTouchInput=true}else{if(this.config.input!=="mouse"){throw new Error("Invalid config, 'input' property must be either 'mouse' or 'touch'.")}}}}this.useTouchInput=true;if(!this.content||!this.content.length){throw new Error("Invalid content, menu must contain at least one item.")}this.showIcons=false;this.showTitles=false;this.showAccelerators=false;this.showSubMenuSeparators=false;this.showSubMenus=false;this.view=F.cloneNode(true);this.view.dataset.wuxMenuUid=this.uid;var ai=e();if(ai){this.view.dataset.recId="menu_"+this.uid;ai.markForRecord(this.view)}if(this.uid>0){if(W===Z){this.view.classList.add("wux-menu-replace");this.view.querySelector(".wux-menu-parent-title").textContent=this.parentTitle}}var ad=this.view.querySelector(".wux-menu-column-left");var ah=this.view.querySelector(".wux-menu-column-icon");var ag=this.view.querySelector(".wux-menu-column-title");var ae=this.view.querySelector(".wux-menu-column-accelerator");var ab=this.view.querySelector(".wux-menu-column-submenu");var ac=this;var aj=-1;this.content.forEach(function af(aC,au,av){if(!aC||!aC.type){throw new Error("Invalid item, 'type' property is mandatory.")}if(aC.icon&&aC.fonticon){throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.")}if(aC.icon&&typeof aC.icon!=="string"){throw new Error("Invalid item, 'icon' property must be a string.")}if(aC.fonticon&&(!(aC.fonticon instanceof Object)||!aC.fonticon.content||typeof aC.fonticon.content!=="string")){throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.")}if(aC.submenu&&(!(aC.submenu instanceof Array)||!aC.submenu.length)){throw new Error("Invalid item, 'submenu' property must be an non empty array of menu items.")}if(aC.action&&typeof aC.action.callback!=="function"){throw new Error("Invalid item, 'action.callback' property must be a function.")}var az=false;var ay=false;if(aC.state){var ar=aC.state.toLowerCase().split("|");az=(ar.indexOf("disabled")>=0);ay=(ar.indexOf("selected")>=0)}var aB=ad.appendChild(o.cloneNode(true));var aw=ah.appendChild(o.cloneNode(true));var al=ag.appendChild(o.cloneNode(true));var at=ae.appendChild(o.cloneNode(true));var am=ab.appendChild(o.cloneNode(true));var ax=aB.appendChild(V.cloneNode(true));var ao=[aB,aw,al,at,am];if(aC.type==="SeparatorItem"){ao.forEach(function(aE,aD,aF){aE.classList.add("wux-menu-separator")})}else{if(aC.type==="TitleItem"){ao.forEach(function(aE,aD,aF){aE.classList.add("wux-menu-title");if(az){aE.classList.add("wux-menu-disabled")}});if(aC.title){ax.textContent=aC.title}if(aC.tooltip){ax.setAttribute("title",aC.tooltip)}}else{if(aC.type==="PushItem"){var ap,aq;if(!az){ap=new y(aC,ac.uid);if(aC.submenu&&aC.action){if(aj!=-1){ap.previous_uid=aj;s[aj].next_uid=ap.uid}aj=ap.uid;ap.cells.push(aB,aw,al,at);aq=new y(aC,ac.uid);aq.previous_uid=aj;s[aj].next_uid=aq.uid;aj=aq.uid;aq.cells.push(am);ax.dataset.wuxMenuItemUid=ap.uid;am.dataset.wuxMenuItemUid=aq.uid}else{if(aj!=-1){ap.previous_uid=aj;s[aj].next_uid=ap.uid}aj=ap.uid;ap.cells.push(aB,aw,al,at,am);ax.dataset.wuxMenuItemUid=ap.uid}if(this.first_uid==-1){this.first_uid=ap.uid}}ao.forEach(function(aE,aD,aF){aE.classList.add("wux-menu-push");if(az){aE.classList.add("wux-menu-disabled")}});if(aC.icon){this.showIcons=true;aw.style.backgroundImage=E(aC.icon)}else{if(aC.fonticon){this.showIcons=true;if(aC.fonticon.content.substr(0,2)==="&#"){aw.innerHTML=aC.fonticon.content}else{var ak=aC.fonticon.content.split(" ");ak.forEach(function(aE,aD,aF){aw.classList.add(aE)})}if(aC.fonticon.family){aw.style.fontFamily=aC.fonticon.family}}}if(aC.title){this.showTitles=true;al.textContent=aC.title}if(aC.accelerator){this.showAccelerators=true;at.textContent=aC.accelerator}if(aC.submenu){this.showSubMenus=true;if(aC.action){this.showSubMenuSeparators=true;ax.classList.add("wux-menu-submenu-separator");am.classList.add("wux-menu-submenu-separator")}am.classList.add("wux-menu-submenu");var aA=new O(this,aq?aq:ap,aC.recId,aC.title,aC.submenu,this.config);aA.buildView();if(aq){aq.submenu_uid=aA.uid}else{if(ap){ap.submenu_uid=aA.uid}}}if(aC.tooltip){ax.setAttribute("title",aC.tooltip)}}else{if(aC.type==="CheckItem"||aC.type==="RadioItem"){var ap;if(!az){ap=new y(aC,ac.uid);if(aj!=-1){ap.previous_uid=aj;s[aj].next_uid=ap.uid}aj=ap.uid;ap.cells.push(aB,aw,al,at,am);ax.dataset.wuxMenuItemUid=ap.uid;if(this.first_uid==-1){this.first_uid=ap.uid}}ao.forEach(function(aE,aD,aF){aE.classList.add(aC.type==="CheckItem"?"wux-menu-check":"wux-menu-radio");if(az){aE.classList.add("wux-menu-disabled")}if(ay){aE.classList.add("wux-menu-selected")}});if(aC.icon){this.showIcons=true;aw.style.backgroundImage=E(aC.icon)}else{if(aC.fonticon){this.showIcons=true;if(aC.fonticon.content.substr(0,2)==="&#"){aw.innerHTML=aC.fonticon.content}else{var ak=aC.fonticon.content.split(" ");ak.forEach(function(aE,aD,aF){aw.classList.add(aE)})}if(aC.fonticon.family){aw.style.fontFamily=aC.fonticon.family}}}if(aC.title){this.showTitles=true;al.textContent=aC.title}if(aC.accelerator){this.showAccelerators=true;at.textContent=aC.accelerator}if(aC.tooltip){ax.setAttribute("title",aC.tooltip)}}else{if(aC.type==="CollectionItem"){ao.forEach(function(aE,aD,aF){aE.classList.add("wux-menu-collection");if(az){aE.classList.add("wux-menu-disabled")}});if(aC.items){aC.items.forEach(function an(aF,aE,aK){if(aF.icon&&aF.fonticon){throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.")}if(aF.icon&&typeof aF.icon!=="string"){throw new Error("Invalid item, 'icon' property must be a string.")}if(aF.fonticon&&(!(aF.fonticon instanceof Object)||!aF.fonticon.content||typeof aF.fonticon.content!=="string")){throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.")}if(aF.action&&typeof aF.action.callback!=="function"){throw new Error("Invalid item, 'action.callback' property must be a function.")}var aI=false;if(aF.state){var aJ=aF.state.toLowerCase().split("|");aI=(aJ.indexOf("disabled")>=0)}var aH=N.cloneNode(true);if(az||aI){aH.classList.add("wux-menu-disabled")}if(aF.icon){aH.style.backgroundImage=E(aF.icon)}else{if(aF.fonticon){if(aF.fonticon.content.substr(0,2)==="&#"){aH.innerHTML=aF.fonticon.content}else{var aD=aF.fonticon.content.split(" ");aD.forEach(function(aM,aL,aN){aH.classList.add(aM)})}if(aF.fonticon.family){aH.style.fontFamily=aF.fonticon.family}}}if(aF.tooltip){aH.setAttribute("title",aF.tooltip)}var aG;if(!az&&!aI){aG=new y(aF,ac.uid);if(aj!=-1){aG.previous_uid=aj;s[aj].next_uid=aG.uid}aj=aG.uid;aG.cells.push(aH);aH.dataset.wuxMenuItemUid=aG.uid;if(this.first_uid==-1){this.first_uid=aG.uid}}this.appendChild(aH)},ax)}}else{throw new Error("Invalid item, '"+aC.type+"' is an unsupported 'type' property.")}}}}}},this);if(this.first_uid!=-1){s[this.first_uid].previous_uid=aj;s[aj].next_uid=this.first_uid}if(this.useTouchInput){this.view.classList.add("wux-menu-touch")}else{this.view.classList.add("wux-menu-mouse")}if(!this.showIcons){ah.parentNode.removeChild(ah)}if(!this.showTitles){ag.parentNode.removeChild(ag)}if(!this.showAccelerators){ae.parentNode.removeChild(ae)}if(!this.showSubMenus){ab.parentNode.removeChild(ab)}if(!this.showIcons){ag.classList.add("wux-menu-column-left-margin")}if(this.showAccelerators||!this.showSubMenus||this.showSubMenuSeparators){if(this.showTitles){ag.classList.add("wux-menu-column-right-margin")}else{ah.classList.add("wux-menu-column-right-margin")}}if(this.showAccelerators&&(!this.showSubMenus||this.showSubMenuSeparators)){ae.classList.add("wux-menu-column-right-margin")}};O.prototype.updateSize=function q(){var ao=true;if(this.view){var ag=this.view.getBoundingClientRect().width;if(ag<160||ag>320){var an=this.view.querySelector(".wux-menu-column-title");if(an){var ak=an.getBoundingClientRect().width;if(ag>320){ak+=(320-ag)}else{ak+=(160-ag)}an.style.width=ak+"px";ag=this.view.getBoundingClientRect().width}}var ai=this.view.querySelectorAll(".wux-menu-overlap");for(var ae=0;ae<ai.length;ae++){if(ai[ae].classList.contains("wux-menu-submenu-separator")){var ac=this.view.querySelector(".wux-menu-column-submenu");var ah=(ac?ac.getBoundingClientRect().width:0);ai[ae].style.width=(ag-ah)+"px"}else{ai[ae].style.width=ag+"px"}}var ab=this.view.querySelectorAll(".wux-menu-column");var aj=this.view.querySelectorAll(".wux-menu-collection .wux-menu-overlap");for(var ae=0;ae<aj.length;ae++){var af=Array.prototype.indexOf.call(aj[ae].parentNode.parentNode.children,aj[ae].parentNode);var am=aj[ae].getBoundingClientRect().height;for(var ad=0;ad<ab.length;ad++){ab[ad].children[af].style.height=am+"px"}}var al=document.documentElement.clientWidth;if(this.config&&this.config.display){if(this.config.display.paddingLeft){al-=this.config.display.paddingLeft}if(this.config.display.paddingRight){al-=this.config.display.paddingRight}}if((ag+320)>al){ao=false}}return ao};O.prototype.setHoverState=function a(ab,ad){if(ab>=0&&ab<s.length){if(ad){this.focus_uid=ab;if(this.parent&&this.parent_item_uid>=0){this.parent.setHoverState(this.parent_item_uid,true)}}var ac=s[ab].cells;for(var ae=0;ae<ac.length;ae++){if(ad){ac[ae].classList.add("wux-menu-hover")}else{ac[ae].classList.remove("wux-menu-hover")}}}if(!ad&&this.focus_uid==ab){this.focus_uid=-1}};function aa(ac){var ae=s[ac].cells;var ad=((ae.length>1||ae[0].classList.contains("wux-menu-collection-item"))?ae[0]:s[s[ac].previous_uid].cells[0]);var af=ae[ae.length-1];var ai=ad.getBoundingClientRect();var ag=af.getBoundingClientRect();var ab=(ad.previousElementSibling!==null?(ai.height-ad.clientHeight):0);var ah={};ah.top=ai.top-ab;ah.right=ag.right;ah.bottom=ai.bottom;ah.left=ai.left;ah.width=ag.right-ai.left;ah.height=ai.height+ab;return ah}O.prototype.makeItemVisible=function K(ad){if(this.view&&this.view.classList.contains("wux-menu-with-scroll")){var ae=aa(ad);var af=this.view.querySelector(".wux-menu-scroll-up");var ac=this.view.querySelector(".wux-menu-scrollable");var ab=this.view.querySelector(".wux-menu-scroll-down");var ak=this.view.querySelector(".wux-menu-container");var aj=ac.getBoundingClientRect();var ai=ak.getBoundingClientRect();var ah=ai.height-aj.height;if(ae.top<aj.top){var ag=ai.top-ae.top;if(ag>=0){ag=0;af.classList.add("wux-menu-scroll-disabled")}ak.style.top=ag+"px";ab.classList.remove("wux-menu-scroll-disabled")}else{if(ae.bottom>aj.bottom){var ag=ai.top-aj.top-(ae.bottom-aj.bottom);if((aj.height-ag)>=ai.height){ag=aj.height-ai.height;ab.classList.add("wux-menu-scroll-disabled")}ak.style.top=ag+"px";af.classList.remove("wux-menu-scroll-disabled")}}}};O.prototype.onKeyDown=function g(ae){if(this.first_uid==-1){return}var ag=this.focus_uid;var af=this.focus_uid;var ad=false;if(ae==13){if(this.focus_uid!=-1){var ab=s[this.focus_uid].submenu_uid;if(ab!=-1){var ac={};ac.parentItemRect=aa(this.focus_uid);U[ab].show(ac);ad=true}else{A(s[this.focus_uid])}}}else{if(ae==27){if(this.parent){this.hide();i=this.parent.uid}else{T.hide()}}else{if(ae==37){if(i==0){ad=true}else{this.hide();i=this.parent.uid}}else{if(ae==38){if(this.focus_uid==-1){af=s[this.first_uid].previous_uid}else{af=s[this.focus_uid].previous_uid}if(af===ag){ad=true}}else{if(ae==39){if(this.focus_uid!=-1){var ab=s[this.focus_uid].submenu_uid;if(ab!=-1){var ac={};ac.parentItemRect=aa(this.focus_uid);U[ab].show(ac)}ad=true}}else{if(ae==40){if(this.focus_uid==-1){af=this.first_uid}else{af=s[this.focus_uid].next_uid}if(af===ag){ad=true}}}}}}}if(!ad){this.setHoverState(ag,false)}if(af!==ag){this.setHoverState(af,true);this.makeItemVisible(af)}};O.prototype.show=function I(au){if(this.view){var ah=0,ag=0;var ab=document.documentElement.clientWidth;var ad=document.documentElement.clientHeight;var al=false;if(this.uid>0&&W===Z){al=true;var ae=this.parent.view.getBoundingClientRect();ah=ae.left;ag=ae.top}else{if(au&&au.position){ah=au.position.x;ag=au.position.y}if(au&&au.parentItemRect&&!c){ah=au.parentItemRect.right;ag=au.parentItemRect.top}}this.view.style.left=ah+"px";this.view.style.top=ag+"px";document.body.appendChild(this.view);if(!this.updateSize()){if(W===l&&this.uid===0){W=Z;var an=this.config||{};an.submenu="replace";T.show(this.content,an)}}var ao=0;var ai=0;var ac=ab;var aj=ad;if(au&&au.display){if(au.display.paddingLeft){ao=au.display.paddingLeft}if(au.display.paddingTop){ai=au.display.paddingTop}if(au.display.paddingRight){ac-=au.display.paddingRight}if(au.display.paddingBottom){aj-=au.display.paddingBottom}}var ar=ac-ao;var ap=aj-ai;var ak=this.view.getBoundingClientRect();if(!al&&au&&au.parentItemRect&&c){ah=au.parentItemRect.left-ak.width;ag=au.parentItemRect.top;this.view.style.left=ah+"px";this.view.style.top=ag+"px"}if(!al&&au&&au.layout){var at=au.layout.toLowerCase().split("|");for(var aq=0;aq<at.length;aq++){if(at[aq]==="topleft"){this.view.style.left=ah+"px";this.view.style.top=ag+"px"}else{if(at[aq]==="topright"){this.view.style.left=(ah-ak.width)+"px";this.view.style.top=ag+"px"}else{if(at[aq]==="bottomleft"){this.view.style.left=ah+"px";this.view.style.top=(ag-ak.height)+"px"}else{if(at[aq]==="bottomright"){this.view.style.left=(ah-ak.width)+"px";this.view.style.top=(ag-ak.height)+"px"}}}}ak=this.view.getBoundingClientRect();if(ak.left>=ao&&ak.right<ac&&ak.top>=ai&&ak.bottom<aj){break}}}ak=this.view.getBoundingClientRect();if(ak.left<ao||ak.right>=ac||ak.top<ai||ak.bottom>=aj){var af=ak.left;var am=ak.top;if(ak.right>ac){if(au&&au.parentItemRect&&!c&&(au.parentItemRect.left-ak.width)>=ao){af=au.parentItemRect.left-ak.width;am=au.parentItemRect.top;c=true}else{af-=ak.width;if((af+ak.width)>ac){af=ac-ak.width}}}if(ak.bottom>aj){am-=ak.height;if((am+ak.height)>aj){am=aj-ak.height}}if(af<ao){af=ao}if(am<ai){am=ai}if(!al){this.view.style.left=af+"px";this.view.style.top=am+"px"}if(ak.height>(aj-am)){this.view.style.height=ap+"px";this.view.classList.add("wux-menu-with-scroll")}}i=this.uid;if(al){this.parent.view.style.display="none";Y=this.uid}}};O.prototype.hide=function S(){if(this.view&&this.view.parentNode){this.view.parentNode.removeChild(this.view);this.setHoverState(-1,false);if(this.parent&&this.parent.view.style.display==="none"){this.parent.view.style.display="";i=this.parent.uid;Y=this.parent.uid;if(this.parent.focus_uid>=0){var ab=aa(this.parent.focus_uid);if(k<ab.left||k>ab.right||j<ab.top||j>ab.bottom){this.parent.setHoverState(this.parent.focus_uid,false)}}}}};function p(ab){if(!ab){return -1}if(!ab.dataset||ab.dataset.wuxMenuUid===undefined){return p(ab.parentNode)}return Number(ab.dataset.wuxMenuUid)}function m(ab){if(ab>=0){return U[s[ab].menu_uid]}}function w(ac){var ab=ac.target.dataset.wuxMenuItemUid;if(ab>=0){var ad=m(ab);if(ad){ad.setHoverState(U[s[ab].menu_uid].focus_uid,false);ad.setHoverState(ab,true)}d=ab}else{d=-1}X=p(ac.target);if(X!=-1){Y=X}}function J(ac){var ab=ac.target.dataset.wuxMenuItemUid;if(ab>=0){var ad=m(ab);if(ad){ad.setHoverState(ab,false)}}}function Q(ab){if(ab.clientX!=k||ab.clientY!=j){k=ab.clientX;j=ab.clientY;var ac=p(ab.target);if(ac==-1){if(B===undefined){B=window.setTimeout(H,n)}}else{if(B!==undefined){window.clearTimeout(B);B=undefined}}if(L!==undefined){window.clearTimeout(L);L=undefined}L=window.setTimeout(t,n)}}function G(ae){if(f.isTouchEvent(ae)){w(ae);ae.target.style.cursor="pointer"}if(ae.touches&&ae.touches.length===1){var ag=new Date().getTime();var ad=ag-D;var ac=Math.abs(v-ae.touches[0].clientX);var ab=Math.abs(u-ae.touches[0].clientY);if(ac<10&&ab<10&&ad<500){ae.preventDefault()}v=ae.touches[0].clientX;u=ae.touches[0].clientY;D=ag}var af=p(ae.target);if(af==-1){T.hide()}}function x(af){if(af.button===0||f.isTouchEvent(af)){var ab=af.target.dataset.wuxMenuItemUid;if(ab>=0){var ad=s[ab];if(ad){var ag=U[ad.menu_uid];if(ad.submenu_uid!=-1){var ae=i;while(ae!=ad.menu_uid){U[ae].hide();ae=U[ae].parent.uid}var ac={};ac.parentItemRect=aa(ab);U[ad.submenu_uid].show(ac)}else{A(ad)}}}else{if(af.target.classList.contains("wux-menu-scroll-up")){P({deltaY:-20,target:af.target})}else{if(af.target.classList.contains("wux-menu-scroll-down")){P({deltaY:20,target:af.target})}else{if(af.target.classList.contains("wux-menu-parent-up")){if(i!=-1){U[i].hide()}}}}}}}function g(ab){if(i!=-1){U[i].onKeyDown(ab.keyCode||ab.location)}}function C(ab){ab.stopPropagation();ab.preventDefault()}function A(ae){var ac=e();if(h.isRecording()&&ac){var ab=ae.content.recId;if(!ab){h.TraceManager.error('Menu item "'+ae.content.title+"\" doesn't have a record identifier, this is not compatible with WebRecord")}else{var ad=U[ae.menu_uid];while(ad.uid>0){if(!ad.parentRecId){h.TraceManager.error('Menu item "'+ad.parentTitle+"\" doesn't have a record identifier, this is not compatible with WebRecord");ab=undefined;break}ab=ad.parentRecId+"/"+ab;ad=ad.parent}}if(ab){h.addCustomInteraction(ac,{recVersion:1,recType:"MenuAction",recIdPath:ab},"DS/MenuRec/MenuRec",{checkVisibility:false})}}T.hide();if(ae&&ae.content&&ae.content.action&&ae.content.action.callback){ae.content.action.callback.call(ae.content.action["this"],{context:ae.content.action.context})}}function R(ab){T.hide()}function P(ac){var ah=ac.target;while(ah&&ah.dataset&&ah.dataset.wuxMenuUid===undefined){ah=ah.parentNode}if(ah&&ah.dataset){var af=ah.dataset.wuxMenuUid;if(af>=0){var ad=U[af];if(ad&&ad.view&&ad.view.classList.contains("wux-menu-with-scroll")){var ag=ad.view.querySelector(".wux-menu-scroll-up");var ae=ad.view.querySelector(".wux-menu-scrollable");var ab=ad.view.querySelector(".wux-menu-scroll-down");var am=ad.view.querySelector(".wux-menu-container");var al=ae.getBoundingClientRect();var ak=am.getBoundingClientRect();var aj=ak.height-al.height;if(ac.deltaY>0){var ai=ak.top-al.top-20;if((al.height-ai)>=ak.height){ai=al.height-ak.height;ab.classList.add("wux-menu-scroll-disabled")}am.style.top=ai+"px";ag.classList.remove("wux-menu-scroll-disabled")}else{var ai=ak.top-al.top+20;if(ai>=0){ai=0;ag.classList.add("wux-menu-scroll-disabled")}am.style.top=ai+"px";ab.classList.remove("wux-menu-scroll-disabled")}}}}}function t(){L=undefined;if(X<0){var ae=Y>=0?Y:0;var af=i;while(af!=ae){U[af].hide();af=U[af].parent.uid}i=ae}else{if(W!==Z){var ab=-1;if(d>=0){ab=s[d].submenu_uid}var af=i;while(af!=X&&af!=ab){U[af].hide();af=U[af].parent.uid}if(ab>=0&&af!=ab){var ad=s[d];if(ad){var ac={};ac.parentItemRect=aa(d);U[ab].show(ac)}}i=ab>=0?ab:X}}}function H(){B=undefined;var ab=Y>=0?Y:0;var ac=i;while(ac!=ab){U[ac].hide();ac=U[ac].parent.uid}i=ab}T.show=function I(ae,ac){T.hide();W=l;if(ac&&ac.submenu==="replace"){W=Z}else{if(ac&&ac.submenu==="outside"){W=M}}var ad=new O(undefined,undefined,undefined,undefined,ae,ac);ad.buildView();ad.show(ac);var ab=e();if(ab&&U.length>0){ab.menus=U[0].content}document.addEventListener("mouseover",w,true);document.addEventListener(f.POINTEROUT,J);document.addEventListener(f.POINTERMOVE,Q);document.addEventListener(f.POINTERDOWN,G);document.addEventListener(f.POINTERHIT,x);document.addEventListener("keydown",g,true);document.addEventListener("resize",R,false);document.addEventListener("contextmenu",C,false);document.addEventListener("wheel",P,true);this._onShow();return ad.view.getBoundingClientRect()};T.hide=function S(){var ac=e();if(h.isRecording()&&ac){h.addCustomInteraction(ac,{recVersion:1,recType:"MenuHide"},"DS/MenuRec/MenuRec",{checkVisibility:false})}document.removeEventListener("mouseover",w,true);document.removeEventListener(f.POINTEROUT,J);document.removeEventListener(f.POINTERMOVE,Q);document.removeEventListener(f.POINTERDOWN,G);document.removeEventListener(f.POINTERHIT,x);document.removeEventListener("keydown",g,true);document.removeEventListener("resize",R,false);document.removeEventListener("contextmenu",C,false);document.removeEventListener("wheel",P,true);if(L!==undefined){window.clearTimeout(L);L=undefined}if(B!==undefined){window.clearTimeout(B);B=undefined}for(var ad=0;ad<U.length;ad++){if(U[ad].view){var ab=U[ad].view.parentNode;if(ab){ab.removeChild(U[ad].view)}}}U=[];i=-1;X=-1;Y=-1;d=-1;s=[];c=false};T._onShow=function(){};return T});define("DS/Menu/ContextualMenu",["DS/Menu/Menu","DS/WebRecordEnabler/Adapter","UWA/Class/Promise","DS/Core/PointerEvents"],function(j,c,k,i){var h=undefined;var l="mouse";var n="auto";function a(o){return !isNaN(parseFloat(o))&&isFinite(o)}function m(o){if(i.isTouchEvent(o)){d(o)}}function d(r){var z=[];var s=r.target;while(s){if(s["wux-data-contextual"]){var v=s.getBoundingClientRect?s.getBoundingClientRect():{left:0,top:0};var w=r.pageX-v.left;var u=r.pageY-v.top;var t=s["wux-data-contextual"];for(var p=0;p<t.length;p++){var o=t[p].params.callback.call(t[p].params["this"],{context:t[p].params.context,info:{position:{x:w,y:u},target:r.target},data:{listener:s,listenerPosition:{x:w,y:u},target:r.target,targetPosition:{x:r.offsetX,y:r.offsetY},windowPosition:{x:r.clientX,y:r.clientY}}});if(o&&(o instanceof Promise)){z.push(o)}else{if(o&&o.length>0){z.push(k.resolve(o))}}}}if(z.length>0||!r.target||r.target.tagName.toLowerCase()!=="input"&&r.target.tagName.toLowerCase()!=="textarea"){r.preventDefault()}if(s===window){s=undefined}else{s=s.parentNode?s.parentNode:window}}if(z&&z.length>0){var q=c.WaitManager.addWaitCondition(20*1000,"Wait context menu to be displayed");k.allSettled(z).then(function(x){var A=[];var B=0;if(x&&x.length>0){for(var y=0;y<x.length;y++){if(x[y].value&&x[y].value.length>0){if(A.length>B){A.push({type:"SeparatorItem"});B=A.length}A=A.concat(x[y].value)}}}if(A&&A.length>0){j.show(A,{display:h,input:l,position:{x:r.pageX,y:r.pageY},submenu:n})}c.WaitManager.removeWaitCondition(q)})}return false}var g={};g.setGlobalConfig=function e(o){if(!o){throw new Error("Invalid configuration.")}if(o.display){h=o.display}if(o.input){if(o.input!=="mouse"&&o.input!=="touch"){throw new Error("Invalid input configuration, expected values are 'mouse' or 'touch'.")}l=o.input}if(o.submenu){if(o.submenu!=="replace"&&o.submenu!=="outside"&&o.submenu!=="auto"){throw new Error("Invalid submenu configuration, expected values are 'replace', 'outside' or 'auto'.")}n=o.submenu}};g.addEventListener=function f(o,p){if(!o||!p){throw new Error("Invalid parameters.")}if(o!==window&&!(o instanceof HTMLElement)){throw new Error("Invalid parameters, 'target' must be the window or an HTMLElement.")}if(!p.callback||!(p.callback instanceof Function)){throw new Error("Invalid parameters, 'params.callback' must be a function.")}var q=o["wux-data-contextual"];if(!q){q=[];q.next=0;o["wux-data-contextual"]=q;o.addEventListener("contextmenu",d);o.addEventListener(i.LONGHOLD,m)}q.push({uid:q.next,params:p});return q.next++};g.removeEventListener=function b(q,p){if(!q||!a(p)){throw new Error("Invalid parameters.")}var r=q["wux-data-contextual"];if(!r){throw new Error("Invalid target.")}var o=0;while(o<r.length&&r[o].uid!=p){o++}if(o>=r.length){throw new Error("Invalid uid.")}if(r.length>1){r.splice(o,1);r.next=r[r.length-1].uid+1}else{q.removeEventListener("contextmenu",d);q.removeEventListener(i.LONGHOLD,m);delete q["wux-data-contextual"]}};return g});define("DS/Spreadsheet/CellView",["UWA/Core","UWA/Controls/Abstract","DS/Core/PointerEvents","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Utilities/Dom","DS/Utilities/Utils","DS/Menu/ContextualMenu","css!DS/Menu/assets/css/Menu.css"],function(d,f,e,c,j,a,h,g){var i=-1;function k(r){var q=r.target||r.srcElement,n=q.currentStyle||window.getComputedStyle(q,null),m=parseInt(n.borderLeftWidth,10),p=parseInt(n.borderTopWidth,10),o=q.getBoundingClientRect(),l=r.clientX-m-o.left,s=r.clientY-p-o.top;return{offsetX:l,offsetY:s}}var b=c.extend({defaultOptions:{isHeader:false},init:function(n){this._parent(n);this.getGridEngine()._enableInteractiveSort();this._dataGrid=this.options.parent;this._manager=this.options.gridEngine;this._isFlaggedForEdition=false;this._cellProps={};this._cellInfos=null;this.elements.container.setAttribute("wux-uuid",this._uxid);if(this.options.isHeader){if(this._manager.options.resize.rows||this._manager.options.resize.columns){this._manageResize()}}if(this._dataGrid.options.enableDragAndDrop===true){this._manageDragAndDrop()}var p=this;var m=this.getGridEngine()._getParent().options.onContextualEvent;if(m){var q=g.addEventListener(this.elements.container,{callback:function(r){return m.callback.call(m["this"],{context:r.context,infos:r.info,data:r.data,treeview:p.getCellInfos()})}})}else{var o=this.getGridEngine().options.onContextualMenuReady;var l=o;if(typeof o==="function"){l=function(){console.warn("[DS/Tree/TreeListView] onContextualMenuReady is now deprecated, please use the new onContextualEvent option instead");var r=p.getCellInfos();return o.call(p,r)}}j.listen({target:this.elements.container,nodes:l})}this._debouncedUpdateInternalParameters=h.debounce((function(){this.updateInternalParameters()}).bind(this),this.getGridEngine().options.performances.debounceCellInternalUpdateTimer)},destroy:function(){a.removeAllEventsOnElement(this);this._debouncedUpdateInternalParameters=null;delete this._debouncedUpdateInternalParameters;for(var l in this.elements){if(this.elements[l].dsView){this.elements[l].dsView=null;delete this.elements[l].dsView}if(this.elements[l].destroy){this.elements[l].destroy()}}j.forget({target:this.elements.container});this._cellInfos=null;this._manager=null;this._parent()},getCellInfos:function(){if(this._cellInfos===null){var o=this.getVirtualCoordinates();var l=this.getGridEngine();var n=l.getColumnOptions(o.virtualColumnID);var m=n.dataIndex;this._cellInfos={virtualRowID:o.virtualRowID,virtualColumnID:o.virtualColumnID,cellModel:l.getCell(o.virtualRowID,o.virtualColumnID),cellView:this,dataIndex:m,typeRepresentation:n.typeRepresentation,manager:l,isHeader:o.virtualRowID===-1||o.virtualColumnID===-1};return this._cellInfos}else{return this._cellInfos}},getCellModel:function(){var l=this.getVirtualCoordinates();return this.getGridEngine().getCellModel(l.virtualRowID,l.virtualColumnID)},getDragAndDropInfos:function(){return this._dataToBeTransferred},_clean:function(){this.elements.container.removeAttribute("virtual-row-id");this.elements.container.removeAttribute("virtual-column-id");if(this._cellModel){this._cellModel.setView(undefined);this._cellModel=undefined}},switchToWriteView:function(){var l=this.getCellInfos();this._isFlaggedForEdition=true;l.cellModel._isInWriteMode=true;this._updateView();this.getGridEngine()._modelEvents.publish({event:"cell:write",data:l})},isInEditionMode:function(){var m=this.getCellInfos();var l=m.cellModel;return l._isInWriteMode},_buildWriteView:function(){var r=this.getCellInfos();var m=r.cellModel;var l=document.createAttribute("is-edited");this.getContent().setAttributeNode(l);if(m._isInWriteMode===true){var q=this.getVirtualCoordinates().virtualColumnID;var p=this.getGridEngine()._getViewForCell({cellView:this,virtualColumnID:q});var n=p.switchToWriteView.view.call(this,this.getCellInfos());if(n!==undefined){this._cellReadWriteView=n;this.elements.container.empty();if(this._cellReadWriteView instanceof f){this.elements.container.appendChild(this._cellReadWriteView.getContent())}else{this.elements.container.appendChild(this._cellReadWriteView)}this._cellReadWriteView.focus()}var o=this}},_saveChanges:function(){var l=this._cellModel;var n=this.getVirtualCoordinates().virtualColumnID;var m=this.getGridEngine()._getViewForCell({cellView:this,virtualColumnID:n});l._isInWriteMode=false;var o=this.getCellInfos();m.switchToReadView.callback.call(this,o);this.notifyModelUpdate()},notifyModelUpdate:function(){return this.getCellInfos().cellModel.notifyModelUpdate()},getWriteView:function(){return this._cellReadWriteView},switchToReadView:function(){var l=this.getCellInfos();this._isFlaggedForEdition=false;if(l.cellModel){l.cellModel._isInWriteMode=false;l.manager.updateCellView(l.virtualRowID,l.virtualColumnID)}this.getGridEngine()._modelEvents.publish({event:"cell:read-only",data:l})},_onChange:function(l){var m=this.getCellInfos();m.manager.setCellContent(m.virtualRowID,m.virtualColumnID,l.target.value);m.cellModel.notifyModelUpdate()},_buildReadView:function(){this.getContent().removeAttribute("is-edited");var m=this;if(this._cellModel){var p=this.getCellInfos();var o=this.getGridEngine().getColumnOptions(p.virtualColumnID);if(this.getGridEngine()._getParent()._getEditionMode()!==2&&o&&typeof o.onCellRequest==="function"){m.getGridEngine()._isRequestingCell=true;this._cellReadWriteView=o.onCellRequest.call(p.manager,p);m.getGridEngine()._isRequestingCell=false}else{var n=m.getGridEngine()._getViewForCell({cellView:m,virtualColumnID:p.virtualColumnID});if(n){var l=n.switchToReadView.view.call(this._cellModel,this.getCellInfos());if(l!==undefined){this._cellReadWriteView=l;if(typeof this._cellReadWriteView==="string"){if(h.getUnsafeHTMLContentValueToApply(m.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(p))===false){this.elements.container.textContent=this._cellReadWriteView}else{this.elements.container.innerHTML=this._cellReadWriteView}}else{this.elements.container.setContent(this._cellReadWriteView)}this._cellModel._isInWriteMode=false}}}}},_updateView:function(){var m=this.getCellInfos();var l=m.cellModel;if(l._isInWriteMode){this._buildWriteView()}else{this._buildReadView()}},active:function(){this._cellModel.active();this.elements.container.addClassName("wux-ui-state-active")},inactive:function(){this._cellModel.inactive();this.elements.container.removeClassName("wux-ui-state-active")},beginEdition:function(){this._isFlaggedForEdition=true;this.getGridEngine().updateView()},endEdition:function(){this._isFlaggedForEdition=true;this.getGridEngine().updateView()},highlight:function(){if(this._cellModel){this._cellModel._isHighlighted=true}this._isHighlighted=true;this.elements.container.addClassName(this._cellModel._highlightClass)},unhighlight:function(){if(this._cellModel){this._cellModel._isHighlighted=false}if(this._isHighlighted){this._isHighlighted=false;this.elements.container.removeClassName(this._cellModel._highlightClass)}},select:function(){this._lastClickTime=Date.now();this._cellModel._isSelected=true;this.highlight()},unselect:function(){this._lastClickTime=0;this._cellModel._isSelected=false;this.unhighlight()},_manageResize:function(){var u=this;u.getGridEngine()._enableInteractiveSort();var o=5;var v=this.elements.container;var y=false;var B,p,A,n;a.addEventOnElement(this,v,e.POINTERMOVE,function(E){if(!x){var D=u.getCellInfos();B=D;p=D.manager;n=p.getColumnWidth(B.virtualColumnID);A=p.getRowHeight(B.virtualRowID);var C=k(E);if(B.virtualRowID===i&&p.options.resize.columns){if(C.offsetX<n+o&&C.offsetX>n-o){u._setResizeStyle("r");y=true}else{u._setResizeStyle();y=false}}if(B.virtualColumnID===i&&p.options.resize.rows){if(C.offsetY<A+o&&C.offsetY>A-o){u._setResizeStyle("b");y=true}else{u._setResizeStyle();y=false}}}});var s=false;var x=false;var t={};var q={};var r;var l;var w=d.extendElement(document);var m=0;var z=Infinity;a.addEventOnElement(this,v,e.POINTERDOWN,function(E){if(E.originalEvent.type==="touchstart"){y=true;o=32;B=u.getCellInfos();p=u.getGridEngine();n=p.getColumnWidth(B.virtualColumnID);A=p.getRowHeight(B.virtualRowID)}var C=k(E);if(y){if(((B.virtualColumnID===i)&&(C.offsetY<A+o&&C.offsetY>A-o))||((B.virtualRowID===i)&&(C.offsetX<n+o&&C.offsetX>n-o))){E.preventDefault();p.getScroller().getContent().addClassName("wux-ui-locked");p.lockUI();t={x:E.clientX,y:E.clientY};r=n;l=A;x=true;var D=u.getGridEngine()._getColumnOptionValue(B.virtualColumnID,"maxWidth");z=D!==undefined?D:Infinity;m=u.getGridEngine()._getColumnOptionValue(B.virtualColumnID,"minWidth");u.getGridEngine()._disableInteractiveSort(true)}}});a.addEventOnElement(this,document,e.POINTERMOVE,function(C){if(x&&y){if(!s){u.getGridEngine()._disableInteractiveSort()}s=true;q.x=C.clientX-t.x;q.y=C.clientY-t.y;if(B.virtualRowID===i){if((n+q.x)>=m&&(n+q.x)<=z){r=n+q.x;u._manager._updateViewOptions={detachAllViews:false,updateCells:false,updateColumnsHeaders:true};p._instance._showColumnInsertionMark(p.getScroller().getPosition().x+p.getHeadersDimensions().width+p.getColumnPosition(B.virtualColumnID)+r)}}if(B.virtualColumnID===i){l=A+q.y;if(l>=0){p._instance._showRowInsertionMark(p.getScroller().getPosition().y+p.getHeadersDimensions().height+p.getRowPosition(B.virtualRowID)+l)}}}});a.addEventOnElement(this,document,e.POINTERUP,function(C){if(x){C.preventDefault();C.stopPropagation();u._setResizeStyle();if(u.elements.container){u.elements.container.removeClassName("wux-ui-state-active")}setTimeout(function(){u.getGridEngine()._enableInteractiveSort()},300);if(B.virtualRowID!==-1){p.setRowHeight(B.virtualRowID,l)}if(B.virtualColumnID!==-1){p.prepareUpdateView();p.setColumnWidth(B.virtualColumnID,r);p._requireFullUpdate();u._manager._updateViewOptions={detachAllViews:true,updateCells:true,updateColumnsHeaders:true};p._recordInteractionFromUI({event:"column:resize",data:{dataIndex:B.dataIndex,width:r}});p.pushUpdateView(true)}p._instance._hideRowInsertionMark();p._instance._hideColumnInsertionMark();p.unlockUI();x=false;y=false}})},_setResizeStyle:function(m){var l=this.elements.container;if(m){l.addClassName("wux-datagrid-header-resize-"+m)}else{l.removeClassName("wux-datagrid-header-resize-l");l.removeClassName("wux-datagrid-header-resize-r");l.removeClassName("wux-datagrid-header-resize-t");l.removeClassName("wux-datagrid-header-resize-b")}},_manageDragAndDrop:function(){this.getContent().setAttribute("draggable",true)},getPosition:function(){var m=this.getGridEngine();var q=this.getVirtualCoordinates();var o=q.virtualRowID;var n=q.virtualColumnID;var l=m.getCellModel(q.virtualRowID,q.virtualColumnID);if(l){if(l.options.shiftRowSpan){o=o+l.options.shiftRowSpan}if(l.options.shiftColSpan){n=n+l.options.shiftColSpan}}var p=m.getCellPosition(o,n);if(p.top<0){p.top=0}if(p.left<0){p.left=0}return p},getDimensions:function(){var l=this.getGridEngine();var m=this.getVirtualCoordinates();return{width:l.getColumnWidth(m.virtualColumnID),height:l.getRowHeight(m.virtualRowID)}},_setVirtualCoordinates:function(q){this._virtualRowID=q.virtualRowID;this._virtualColumnID=q.virtualColumnID;this._dataGrid=this.options.parent;this._manager=this._dataGrid._cellsManager;this._cellInfos=null;var p=this.getVirtualCoordinates();var o=this.getCellInfos();this._cellModel=o.cellModel;var n=this.getGridEngine().getDataIndexFromColumnID(q.virtualColumnID);if(q.rowID!==undefined){this.elements.container.setAttribute("row-id",q.rowID)}if(q.columnID!==undefined){this.elements.container.setAttribute("column-id",q.columnID)}this.elements.container.setAttribute("data-index",n);this.elements.container.setAttribute("virtual-row-id",this._virtualRowID);this.elements.container.setAttribute("virtual-column-id",this._virtualColumnID);if(this.getGridEngine().options.performances.use2PassRendering){this.elements.container.addClassName("wux-ui-tombstone")}var l=this.getCellInfos();l.data={rowID:q.virtualRowID,columnID:q.virtualColumnID};l.model=this._cellModel;l.view=this.elements.container;l.parent=this._dataGrid;this._dataToBeTransferred={from:l,data:{rowID:p.virtualRowID,columnID:p.virtualColumnID}};if(this._drag){this._drag.updateDataToBeTransferred(this._dataToBeTransferred)}var m=this.getCellModel();if(m){m.options.rowID=q.virtualRowID;m.options.columnID=q.virtualColumnID;m.options.virtualRowID=q.virtualRowID;m.options.virtualColumnID=q.virtualColumnID;m._view=this}},_free:function(){if(this._reusableContent){this._reusableContent.__disposable__.dispose();this._reusableContent=undefined;this._parent()}},_resetCell:function(){var l=this.elements.container;var m=this.getCellInfos();if(!m.isHeader){m.cellModel._isInWriteMode=false}if(m.virtualRowID===-1){l.removeClassName("wux-ui-sort-desc");l.removeClassName("wux-ui-sort-asc")}},updateInternalParameters:function(){var v=this;var z=this.getCellInfos();var q=this.elements.container;var t=z.cellModel;var p=true;this._resetCell();this._dataGrid=this.options.parent;this._manager=z.manager;this._cellModel=t;if(t){if(z.virtualRowID===-1&&q.hasClassName("wux-ui-sort-desc")){q.removeClassName("wux-ui-sort-desc")}if(z.virtualRowID===-1&&q.hasClassName("wux-ui-sort-asc")){q.removeClassName("wux-ui-sort-asc")}if(z.virtualRowID%2===0){q.addClassName("wux-datagrid-cell-even")}else{q.removeClassName("wux-datagrid-cell-even")}q.dsView=this;t.setView(v);var m=t.getCssClasses();if(m.length>0){m.forEach(function(B){q.removeClassName(B)});q.addClassName(m.join(" "))}if(v._cellProps.isActive!==t.isActive()){if(t.isActive()){v.active()}else{v.inactive()}v._cellProps.isActive=t.isActive()}if(t.isHighlighted()){v.highlight()}else{v.unhighlight()}v._cellProps.isHighlighted=t.isHighlighted();if(t.getCellStyle()){q.setStyles(t.getCellStyle())}if(!t._isInWriteMode&&z.virtualRowID!==-1&&z.virtualColumnID!==-1){v._updateView()}if(t.isHidden()){p=true}else{p=false}var w=t.getRowSpan();var s=t.getColSpan();var o=0;var A=0;if(w>1){for(var r=0;r<w;r++){A=A+this._manager.getRowHeight(z.virtualRowID+r)}}else{A=this.getDimensions().height}if(s>1){for(var r=0;r<s;r++){var l=this._manager.getColumnWidth(z.virtualColumnID+r+t.options.shiftColSpan);o=o+l}}else{o=this.getDimensions().width}var x,u;var n={};if(o!==this._cellProps.width){this._cellProps.width=o;x=o;n.width=x}if(A!==this._cellProps.height){this._cellProps.height=A;u=A;n.height=u;n.lineHeight=(u-1)+"px"}a.setStyles(q,n);if((A===0||o===0||p)&&z.virtualColumnID!==i){var y=document.createAttribute("is-hidden");q.setAttributeNode(y)}else{q.removeAttribute("is-hidden")}}this._parent();if(this.getGridEngine().options.performances.use2PassRendering){q.removeClassName("wux-ui-tombstone")}},hide:function(){this.elements.container.hide()},updateView:function(){var l=this.getVirtualCoordinates();this.getGridEngine().updateCellView(l.virtualRowID,l.virtualColumnID)},_cancelChanges:function(){}});return b});define("DS/Spreadsheet2/CellView",["DS/Spreadsheet/CellView"],function(a){return a});define("DS/Tree/TreeNodeView",["UWA/Core","DS/Spreadsheet/CellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/TooltipModel"],function(f,i,g,b,a,j,h){var o=false;var e=300;var d={};var l=function(u,s,v){var r=window.getComputedStyle(s,null).getPropertyValue("font-size");var t=parseFloat(r);var q=new f.Element("span",{styles:{opacity:1,fontSize:t,padding:5}}).inject(s,"top");if(j.getUnsafeHTMLContentValueToApply(v)===true){q.innerHTML=u}else{q.innerText=u}var p=q.offsetWidth;q.remove();return p};var c=function(r,q){var p=r;if(p){var s=(" "+p.className+" ").replace(/[\n\t]/g," ").indexOf(" "+q+" ")>-1;if(s){return p}else{return c(p.parentNode,q)}}};function k(p){return p.charAt(0).toUpperCase()+p.slice(1)}function n(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var p=window.getSelection();p.removeAllRanges()}}}var m=i.extend({defaultOptions:{width:"100%"},init:function(p){this._parent(p);this._cachedIcons=[];this._hasIcons=false;this._modelEvents=new b({parent:this.getGridEngine()._modelEvents,target:this});this.elements.container.addClassName("wux-layouts-treeview-cell");this.elements.layout=new f.Element("ul",{"class":"wux-ui-stack-h",styles:{height:"100%",display:"block",position:"relative"}}).inject(this.elements.container);this.elements.linksContainer=new f.Element("li",{"class":"wux-layouts-treeview-links"}).inject(this.elements.layout);this.elements.nodeContainer=new f.Element("li",{"class":"wux-layouts-treeview-node"}).inject(this.elements.layout);this.elements.expanderContainer=new f.Element("li",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.nodeContainer);this.elements.iconsContainer=new f.Element("li",{"class":"wux-layouts-treeview-icons"}).hide().inject(this.elements.nodeContainer);this.elements.badgeTopRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"}).inject(this.elements.iconsContainer);this.elements.badgeTopLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-left"}).inject(this.elements.iconsContainer);this.elements.badgeBottomRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right"}).inject(this.elements.iconsContainer);this.elements.badgeBottomLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-left"}).inject(this.elements.iconsContainer);this.elements.labelContainer=new f.Element("li",{"class":"wux-layouts-treeview-label"}).inject(this.elements.nodeContainer);this._observeEvents()},destroy:function(){if(this._cellInfos){this._cellInfos.nodeModel=null;this._cellInfos=null}this._parent()},_resetCell:function(){a.empty(this.elements.container);this.elements.container.setStyle("padding-left","");this.unsetBadges();var p=this.getCellInfos();if(!p.isHeader&&p.dataIndex==="tree"){}this._parent()},_observeEvents:function(){var t=this;var w=0;var s;var r=false;this.elements.container.addEvent(g.POINTERDOWN,function p(x){a._increaseCurrentPositionInStack(t.elements.container);r=false;if(!g.isTouchEvent(x)){r=t._uiNodeUpForTouchOrDownForMouse(x,"down")}a._decreaseCurrentPositionInStack()});this.elements.container.addEvent("click",function q(y){a._pushUserInteractionContext();var x=t.getGridEngine();var z=t.getCellInfos();var A=z.nodeModel;if(!r&&z.isHeader===false&&z.dataIndex!=="selection"){t._uiNodeUpForTouchOrDownForMouse(y,"up")}r=false;if(s!==undefined){clearTimeout(s)}s=setTimeout(function(){w=0},e);w++;if(y.which===1){if(w===1||g.isTouchEvent(y)&&y.detail===0){var z=t.getCellInfos();t.getGridEngine()._recordInteractionFromUI({event:"node:click",data:{nodeRecordPath:z.nodeModel&&z.nodeModel.getStructurePath?z.nodeModel.getStructurePath():z.nodeModel,virtualRowID:z.virtualRowID,virtualColumnID:z.virtualColumnID}});t.getGridEngine()._modelEvents.publish({event:"nodeclick",data:z})}if(w===2){t.getGridEngine()._modelEvents.publish({event:"nodeDblClick",data:t.getCellInfos()})}}a._popUserInteractionContext()});this._eventDetailDown=0;this._eventDetailDownTO;var u=function(x){a._pushUserInteractionContext();if(x.type==="touchend"){x.preventDefault()}if(x.which===1||x.type==="touchend"){t._uiExpandCollapse()}a._popUserInteractionContext()};this.elements.expanderContainer.addEvent("mouseup",u);this.elements.expanderContainer.addEvent("touchend",u);var v=function(x){x.stopPropagation();x.preventDefault()};this.elements.expanderContainer.addEventListener("contextmenu",v);this.elements.expanderContainer.addEventListener(g.LONGHOLD,v)},_uiNodeUpForTouchOrDownForMouse:function(y,s){var A=this;var z=false;var w=A.getGridEngine().options.selection.canMultiSelect&&(y.ctrlKey||A.getGridEngine().isInMultiSelection());var p=A.getGridEngine().options.selection.canMultiSelect&&y.shiftKey&&A.getGridEngine().options.selection.enableListSelection;if(y.which===1||y.type==="touchstart"){if(!y.target.classList.contains("wux-layouts-treeview-expander")&&!c(y.target,"wux-controls-toggle")){var B=A.getCellInfos();var t=A.getGridEngine();var v=t.getDocument();if(B.isHeader===false&&t.options.selection.cells===false){var q=B.nodeModel;if(!p){t._activeNodeAtShift=q}if(t.options.selection.nodes){if(t.options.selection.toggle){if(q.isSelected()){if(s==="up"){A.__unselectNode(q);z=true}}else{A.__selectNode(q,!w);z=true}}else{if(p){var r=v.getXSO().get();var u;if(r.length===0){u=v.getChildren()[0]}else{if(t._getParent().options.enableActiveUI===true){u=t._activeNodeAtShift?t._activeNodeAtShift:t.getActiveNode()}else{u=r[0]}}var x=q;if(u._getRowID()<x._getRowID()){v.withTransactionUpdate(function(){if(!y.ctrlKey){v.getXSO().empty()}var D=[];for(var C=u._getRowID();C<=x._getRowID();C++){var E=t.getTreeNodeModelFromRowID(C);if(v.options.shouldBeSelected.call(v,E)){D.push(E)}}A.__selectNodes(D);z=true})}else{v.withTransactionUpdate(function(){if(!y.ctrlKey){v.getXSO().empty()}var D=[];for(var C=u._getRowID();C>=x._getRowID();C--){var E=t.getTreeNodeModelFromRowID(C);if(v.options.shouldBeSelected.call(v,E)){D.push(E)}}A.__selectNodes(D);z=true})}}else{if(q.isSelected()){if(w){if(g.isTouchEvent(y)&&q.getTreeDocument().getXSO().get().length>0&&q.getTreeDocument().getXSO().isIn(q)){A.__unselectNode(q);z=true}else{if(s==="up"){A.__unselectNode(q);z=true}}}else{if(q.getTreeDocument().getXSO().get().length===0){A.__selectNode(q);z=true}else{if(s==="up"&&q.getTreeDocument().getXSO().get().length>1){A.__selectNode(q,!w);z=true}}}}else{A.__selectNode(q,!w);z=true}}}}}}}return z},_uiExpandCollapse:function(){var p=this;p.getGridEngine()._giveFocus();var r=p._cellModel.getCellContent();if(r.getChildren()){if(p._expandState!=="noExpandState"&&p._expandState!=="expandingState"){if(r.isExpanded()&&r._expandState!=="partiallyExpandedState"){r.collapse()}else{p._setExpanderState("expandingState");r.expand()}}}var q=p.getCellInfos();p.getGridEngine()._recordInteractionFromUI({event:"node:expand-collapse",data:{nodeRecordPath:q.nodeModel?q.nodeModel.getStructurePath():q.nodeModel,virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})},_isSelected:function(){var p=this.getCellInfos();return p.manager.getNodesXSO().isIn(p.nodeModel)},__selectNodes:function(p){var q=this.getCellInfos();if(p&&p.length>0){p.forEach(function(r){r.selectionChangeIsFromUI()});q.manager.getNodesXSO().add(p);p.forEach(function(r){q.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:r.getStructurePath(),virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})});this.getGridEngine().setActiveNode(p[p.length-1])}},__selectNode:function(p,r){var s=this.getCellInfos();var q=s.manager._shouldBeSelected(s.nodeModel);if(p&&q){p.selectionChangeIsFromUI();if(r){p.withTransactionUpdate(function(){s.manager.getNodesXSO().unique(p)});s.manager._recordInteractionFromUI({event:"selection:unique",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:s.virtualRowID,virtualColumnID:s.virtualColumnID}})}else{p.withTransactionUpdate(function(){s.manager.getNodesXSO().add(p)});s.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:s.virtualRowID,virtualColumnID:s.virtualColumnID}})}}this.getGridEngine().setActiveNode(p)},__unselectNodes:function(p){var q=this.getCellInfos();if(p&&p.length>0){p.forEach(function(r){r.selectionChangeIsFromUI()});q.manager.getNodesXSO().remove(p);p.forEach(function(r){q.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:r.getStructurePath(),virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})});this.getGridEngine().setActiveNode(p[p.length-1])}},__unselectNode:function(p){var r=this.getCellInfos();var q=r.manager._shouldBeSelected(r.nodeModel);if(p&&q){if(r.manager.getNodesXSO().isIn(p)===true){p.selectionChangeIsFromUI();p.withTransactionUpdate(function(){r.manager.getNodesXSO().remove(p)});r.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:r.virtualRowID,virtualColumnID:r.virtualColumnID}})}}},getCellInfos:function(){if(!this._cellInfos){this._cellInfos=this._parent();if(this._cellInfos.dataIndex==="tree"&&this._cellInfos.virtualRowID>=0){this._cellInfos.nodeView=this;if(this._cellInfos.cellModel){this._cellInfos.nodeModel=this._cellInfos.cellModel.getCellContent()}}else{this._cellInfos.nodeModel=this._cellInfos.manager.getTreeNodeModelFromRowID(this._cellInfos.virtualRowID)}}return this._cellInfos},_updateToolTip:function(){var r=this.getCellInfos();var p=this.elements;var q=this._getParentView().options.shouldDisplayTooltip?this._getParentView().options.shouldDisplayTooltip(r):false;if(q===false){p.container.setAttribute("title","")}if(q){if(r.dataIndex==="tree"&&!r.isHeader){this._setTooltip(p.container,{shortHelp:""});this._setTooltip(p.labelContainer,q);this._setTooltip(p.iconsContainer,q)}else{if(r.cellModel.options.value){if(typeof r.cellModel.options.value==="string"){this._setTooltip(p.container,q)}else{if(r.cellModel.options.value.toString){this._setTooltip(p.container,q)}else{this._setTooltip(p.container,q)}}}else{this._setTooltip(p.container,q)}}}else{this._setTooltip(p.container,{shortHelp:""})}},_setTooltip:function(q,p){if(p.longHelp){p.shortHelp=p.longHelp;p.longHelp=""}q.tooltipInfos=new h(p)},updateInternalParameters:function(){var r=this.getCellInfos();var q=this.elements;this._dataGrid=this.options.parent;this._manager=r.manager;this._cellModel=r.cellModel;if(!r.isHeader){r.cellModel._isInWriteMode=false}this._updateToolTip();if(!r.isHeader&&r.nodeModel){var p=r.manager._isCellEditable(r);q.container.setAttribute("is-editable",p);if(r.nodeModel.isMatchingSearch()){q.labelContainer.addClassName("wux-ui-state-match");this._hasBeenMatchedForSearch=true}else{if(this._hasBeenMatchedForSearch){q.labelContainer.removeClassName("wux-ui-state-match");this._hasBeenMatchedForSearch=false}}}this._parent();var s=this._getParentView().options.selection.preSelection?this._getParentView().options.selection.preSelection:false;if(s){this.getContent().removeClassName("wux-datagrid-cell-prehighlighted")}this.getContent().removeClassName("wux-datagrid-cell-highlighted");if(r.virtualRowID>-1){if(s){if(r.nodeModel&&r.nodeModel.isPreSelected()){this.getContent().addClassName("wux-datagrid-cell-prehighlighted")}}if(this._isSelected()||this._isHighlighted){this.getContent().addClassName("wux-datagrid-cell-highlighted")}}},_getParentView:function(){return this.getGridEngine()._getParent()},_getNodeModel:function(){var p=this.getVirtualCoordinates();return this._manager.getCell(p.virtualRowID,"tree").getCellContent()},_getRelativeIncrementFactor:function(p){return 25},_setDepth:function(y){var B=this.getCellInfos();var A=B.nodeModel;var v=B.manager;var p=this.elements;if(y===undefined){y=A.getParents().length}var t=20;var z=25;p.container.setStyle("padding-left",t);var s=0;if(v.options.performances.buildLinks){var r="";var x,u,C,q;var w="<span>";for(x=0;x<y;x++){var z=this._getRelativeIncrementFactor(x);s=s+z;q=A.getNthParent((y-1)-x);u=((q&&q.isLastChild()&&(x<=y-2)))?"border-color:transparent":"";C=((x===y-1)&&A.isLastChild())?"50%":"100%";r=r+u+C;w=w+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((A.getParent()&&A.getParent().isLastChild()&&x<=y-1)?"true":"false")+'" data-islastchild="'+(A.isLastChild()?"true":"false")+'" data-depth="'+(x+"/"+(y-1))+'" style="'+u+";height: "+C+";margin-right:"+(((x===y-1)?0:z)-1)+"px;margin-left:"+(x===0?z:0)+'px"></li>'}w=w+"</span>";if(d[r]===undefined){p.linksContainer.innerHTML=w;d[r]=w;p.linksContainer.inject(this.elements.layout,"top")}else{p.linksContainer.innerHTML=d[r]}p.linksContainer.setStyle("width",s);p.nodeContainer.setStyle("left",s)}else{for(var x=0;x<y;x++){var z=this._getRelativeIncrementFactor(x);s=s+z}p.linksContainer.setStyle("width",s);p.nodeContainer.setStyle("left",s)}this._nodeOffsetX=s+t+2;p.container.setAttribute("data-node-depth",y)},_updateView:function(){var q=this.getCellInfos();var p=q.cellModel;var r=q.nodeModel;if(p._isInWriteMode){if(this._dataGrid.options.enableDragAndDrop===true){this.getContent().setAttribute("draggable",false)}if(q.dataIndex==="tree"&&!q.isHeader){r.options.oldLabel=r.options.label}this._buildWriteView()}else{if(this._dataGrid.options.enableDragAndDrop===true){this.getContent().setAttribute("draggable",true)}this._buildReadView()}},_setExpanderState:function(p){if(p){var q={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed",noChildren:"noChildren",expanding:"expanding",partiallyExpanded:"partiallyExpanded",expanded:"expanded",collapsed:"collapsed"};this.elements.expanderContainer.setAttribute("data-wux-state",q[p])}},notifyModelUpdate:function(){this._getNodeModel().notifyModelUpdate();this._parent()},_cancelChanges:function(){this._getNodeModel().options.label=this._getNodeModel().options.oldLabel;this.switchToReadView()},setLabel:function(r){var u=this;function p(w){w.preventDefault();w.stopPropagation();w.stopImmediatePropagation();u.elements.container.scrollLeft=0;return false}function s(w){if(u.isInEditionMode()){n();if(u._cellReadWriteView&&u._cellReadWriteView.value!==u._getNodeModel().options.label&&u._cellWriteModel===u._getNodeModel()){u._getNodeModel().options.label=u._cellReadWriteView.value;u.notifyModelUpdate()}u.switchToReadView();setTimeout(function(){u.getGridEngine()._giveFocus()},1)}document.body.removeEventListener(g.POINTERDOWN,s);u._cellWriteModel=undefined}if(this.isInEditionMode()){var q=new f.Element("input",{type:"text",value:r,tabindex:"-1","class":"wux-tree-label-input wux-ui-state-clearable",styles:{"box-sizing":"border-box"},events:{dragstart:function(w){w.preventDefault();w.stopPropagation()},keypress:function(w){u.elements.container.scrollLeft=0},keydown:function(w){t(true)},keyup:function(w){u.elements.container.scrollLeft=0},change:function(w){},focusin:function(w){w.preventDefault()},focus:function(w){w.preventDefault();w.stopPropagation()},mousemove:function(w){if(this.offsetWidth-18<w.clientX-this.getBoundingClientRect().left){this.style.cursor="default"}else{this.style.cursor="text"}},click:function(w){w.stopPropagation();if(this.offsetWidth-26<w.clientX-this.getBoundingClientRect().left){this.value=u._getNodeModel().options.label;u.switchToReadView();u._lastClickTime=Date.now()}},mouseup:function(w){w.stopPropagation()},mousedown:function(w){w.stopPropagation()},touchstart:function(w){w.stopPropagation()},touchend:function(w){w.stopPropagation()}}});var t=function(w){if(u._cellReadWriteView){u.elements.container.scrollLeft=0;var y=u.elements.nodeContainer.getDimensions().width-u.elements.expanderContainer.getDimensions().width-u.elements.iconsContainer.getDimensions().width-24;var x=(l(q.value+" ",u.elements.labelContainer,u.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(u.getCellInfos()))+20);q.style.width=x+"px";q.style.maxWidth=y+"px";if(!w){u._cellReadWriteView.setSelectionRange(0,u._cellReadWriteView.value.length)}}};q.addEventListener("compositionupdate",function(){t(true)});u.elements.container.addEventListener("scroll",p,true);u.elements.container.scrollLeft=0;setTimeout(function(){t()},0);this.elements.labelContainer.innerHTML="";this.elements.labelContainer.setContent(q);this._cellReadWriteView=q;this._cellWriteModel=this._cellInfos.nodeModel;q.focus();document.body.addEventListener(g.POINTERDOWN,s)}else{u.elements.container.removeEventListener("scroll",p);if(typeof r==="number"){r=r.toString()}this.elements.labelContainer.layoutDsModel=this._dataGrid;var v=this.getCellInfos();if(j.getUnsafeHTMLContentValueToApply(this.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(v))===false){this.elements.labelContainer.setText(r)}else{this.elements.labelContainer.setContent(r)}}},unsetBadges:function(){this.elements.badgeTopLeft.style.backgroundImage="";this.elements.badgeTopLeft.style.visibility="hidden";this.elements.badgeBottomLeft.style.backgroundImage="";this.elements.badgeBottomLeft.style.visibility="hidden";this.elements.badgeTopRight.style.backgroundImage="";this.elements.badgeTopRight.style.visibility="hidden";this.elements.badgeTopRight.className="";this.elements.badgeTopRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right");this.elements.badgeBottomRight.style.backgroundImage="";this.elements.badgeBottomRight.style.visibility="hidden";this.elements.badgeBottomRight.className="";this.elements.badgeBottomRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right")},setBadges:function(p){for(var r in p){var q=p[r];if(q){a.generateIcon(q,{target:this.elements["badge"+k(r)]});this.elements["badge"+k(r)].style.visibility="visible"}}},setIcons:function(r){var s=this;var q=0;this._removeAllIcons();if(r){if(Array.isArray(r)){this._icons=f.clone(r);if(r){var p=document.createDocumentFragment();r.forEach(function(t){var u=m._buildIcon(t);s._cachedIcons.push(u);p.appendChild(u)});this.elements.iconsContainer.appendChild(p)}q=r.length}if(typeof r==="string"){q=1;s.addIcon(r,"css")}}this.elements.iconsContainer.setAttribute("wux-has-icon",q>0);if(!this._hasIcons){this.elements.iconsContainer.style.display="inline-flex";this._hasIcons=true}},select:function(){this._lastClickTime=Date.now();this._parent()},addIcon:function(q,p){var r=m._buildIcon(q,p);this._cachedIcons.push(r);this.elements.iconsContainer.appendChild(r)},_removeAllIcons:function(){this.elements.iconsContainer.removeAttribute("wux-icon-name");this._cachedIcons.forEach(function(p){if(p.parentNode){p.parentNode.removeChild(p)}});this._cachedIcons=[]}});m._buildIcon=function(q,p){var r=a.createElement("div",{"class":"wux-layouts-treeview-icon"});switch(p){case"css":r.setAttribute("icon-type","css");r.setAttribute("wux-icon-name",q);break;default:if(typeof q==="string"){r.setAttribute("icon-type","css");r.style.backgroundImage="url("+q+")"}else{r.setAttribute("icon-type","fonticon");r.appendChild(a.generateIcon(q))}break}return r};return m});define("DS/RuntimeView/Abstract",["UWA/Core","UWA/Event","UWA/Class","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents"],function(e,m,a,d,b){var k=false;var j="assets/icons/32/";var f={en:"",fr:"French",de:"German",ja:"Japanese",zh:"Simplified_Chinese",es:"Spanish"};function n(s,r){r=r.split(".");var q=/(.+)\[(\d+)\]/;for(var p=0;p<r.length;p++){var o=q.exec(r[p]);if(o){s=s[o[1]][parseInt(o[2],10)]}else{if(s){s=s[r[p]]}}}return s}function c(){var p=window.location.href.split("?")[0];var o=p.split("/");return o[o.length-2]}function h(w){var p={},u,v,r;for(var q in w){u=p;v=q.split(".");var s=v.pop();while(v.length){r=v.shift();u=u[r]=u[r]||{}}u[s]=w[q]}return p}function l(p){p=p.replace(/<meta charset="UTF-8"\/>/g,"");p=p.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"");var o=/(\r\n|\r|\n|\u0085|\u000C|\u2028|\u2029)/g;p=p.replace(o,"");var q=/\s+(?=([^"]*"[^"]*")*[^"]*$)/g;p=p.replace(q,"");var r=/=+(?=([^"]*"[^"]*")*[^"]*$)/g;p=p.replace(r,'":').replace(/";/g,'","');p='{"'+p.substring(0,p.length-2)+"}";return h(e.Json.decode(p))}var i=a.extend({defaultOptions:{resourceKey:null},init:function(o,p){this.options=e.extend(this.defaultOptions,o);this._parent(o);this._manager=p;this._resourceKey=this.options.resourceKey},getKey:function(r){if(this._resourceKey){var q=r.key;var o=this._resourceKey.split("/")[1]+"."+r.key;var p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:q});if(!p){p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:o})}if(p){return p.value}}else{console.warn("[ResourceManager]","ERROR","fileName option has not been defined")}},getIcon:function(r){if(this._resourceKey){var q=this._resourceKey+"."+r.key+".Icon."+r.size;var o=this._resourceKey.split("/")[1]+"."+r.key+".Icon."+r.size;var p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:q});if(!p){p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:o})}if(p){return d.getWebappsBaseUrl()+p.module+"/"+j+p.value}}else{console.warn("[ResourceManager]","ERROR","fileName option has not been defined")}},getTitle:function(r){if(this._resourceKey){var q=this._resourceKey+"."+r.key+".Title";var o=this._resourceKey.split("/")[1]+"."+r.key+".Title";var p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:q});if(!p){p=this._manager._getKeyValue({resourceKey:this._resourceKey,key:o})}if(p){return p.value}}else{console.warn("[ResourceManager]","ERROR","fileName option has not been defined")}}});var g=a.extend({defaultOptions:{},AFR_DIR:"assets/afr/",NLS_DIR:"assets/catnls/",RSC_DIR:"assets/catrsc/",ICO_32_DIR:"assets/icons/32/",DEFAULT_LANGUAGE:"",init:function(o){this._parent(o);this._modelEvents=new b();this._listOfResources=[];this._timeoutAjax=[]},onResourceLoaded:function(p,s){var q=this;if(p===undefined){p={}}if(p.resourceFile){var r=p.resourceFile.split("/");if(r.length===1){p.resourceFile=c()+"/"+p.resourceFile}if(q._listOfResources[p.resourceFile]){var o=new i({resourceKey:p.resourceFile},q);s.call(o)}else{this._modelEvents.subscribe({event:"RESOURCE_LOADED"},function(v,u){if(p.resourceFile===v.resourceKey){q._modelEvents.unsubscribe(u);var t=new i({resourceKey:v.resourceKey},q);s.call(t)}})}}},_registerResource:function(x){var t=this;x.module=x.module||c();x.language=x.language||this.DEFAULT_LANGUAGE;x.resourceConverter=x.resourceConverter||l;var w=x;if(w.resourceFile){var v=w.resourceFile;var o,q;var s=w.resourceFile.split("/");if(s.length!==2){console.error("[ResourceManager]","ERROR","Invalid resourceFile: "+w.resourceFile,'Did you provide the module name in value of ResourceFile attribute in the CATCommandHeader inside your D-AFr (xml) file ? E.g. ResourceFile="MyModule/MyResourceFileNameWithoutExtension"')}else{o=s[0];q=s[1]}if(!t._listOfResources[v]){if(o){var u="";if(x.language&&x.language!==""&&f[x.language]!==""&&f[x.language]!==undefined){u=f[x.language]+"/"}var p=d.getWebappsBaseUrl()+o+"/"+w.resourceDir+u+q+w.fileExtension;var r="Ajax";if(d.getWebappsBaseUrl()!=="../"){r="Data"}if(this._timeoutAjax[v]){window.clearTimeout(this._timeoutAjax[v])}this._timeoutAjax[v]=setTimeout(function(){e[r].request(p,{async:true,onComplete:function(z){if(!t._listOfResources[v]){if(k){console.log("register resource",v+w.fileExtension,t._listOfResources)}t._listOfResources[v]=t.options.resourceConverter(z);t._listOfResources[v]["@module"]=o}var y=new i({resourceKey:v},t);t._modelEvents.publish({context:y,event:"RESOURCE_LOADED",data:{resourceKey:v}})},onFailure:function(y){console.warn("Error loading file: ",p,"\n",'Did you provide the module name in value of ResourceFile attribute in the CATCommandHeader inside your D-AFr (xml) file ? E.g. ResourceFile="MyModule/MyResourceFileNameWithoutExtension"')}})},50)}else{console.error("No module defined!",w)}}else{setTimeout(function(){t._modelEvents.publish({context:t,event:"RESOURCE_LOADED",data:{resourceKey:v}})},0)}}},getKeyValue:function(p){console.warn("DEPRECATED","Please do not use this method anymore. Look at WUXForDev.tst/RuntimeViewDemo.mweb to see the right way to consume rtv resources.");var q=p.split(".");var o=q[0];var r=n(this._listOfResources[o],p);if(k){console.log(p,"-->",r)}if(this._listOfResources[o]){return{module:this._listOfResources[o]["@module"],value:r}}},_getKeyValue:function(o){var p=n(this._listOfResources[o.resourceKey],o.key);if(k){console.log(o.key,"-->",p)}if(p&&this._listOfResources[o.resourceKey]){return{module:this._listOfResources[o.resourceKey]["@module"],value:p}}}});return g});define("DS/RuntimeView/NLSManager",["UWA/Core","UWA/Event","DS/RuntimeView/Abstract"],function(d,a,c){var b=c.singleton({defaultOptions:{fileName:null,resourceDir:"assets/catnls/",fileExtension:".CATNls"},init:function(){this._parent()},loadResource:function(e){this.options=d.extend(this.defaultOptions,e);this._registerResource(this.options)},});return d.namespace("WUX/RuntimeView/NLSManager",b)});define("DS/RuntimeView/FileManager",["UWA/Core","UWA/Event","DS/RuntimeView/Abstract"],function(d,b,c){var a=c.extend({defaultOptions:{fileName:null,},init:function(){this._parent();console.warn("Deprecated","RuntimeView/FileManager","Please use UWA.Ajax.request or UWA.Data.request")},loadFile:function(e){console.warn("Deprecated","RuntimeView/FileManager.loadFile()","Please use UWA.Ajax.request or UWA.Data.request")},});return a});define("DS/RuntimeView/RSCManager",["UWA/Core","UWA/Event","DS/RuntimeView/Abstract","DS/WebappsUtils/WebappsUtils"],function(e,a,d,b){var c=d.singleton({defaultOptions:{module:null,fileName:null,resourceDir:"assets/catrsc/",fileExtension:".CATRsc",onComplete:null},init:function(){this._parent()},loadResource:function(f){this.options=e.extend(this.defaultOptions,f);this._registerResource(this.options)},});return e.namespace("WUX/RuntimeView/RSCManager",c)});define("DS/Spreadsheet/CellModel",["UWA/Core","UWA/Event","DS/Core/Core"],function(e,a,d){var c=-1;function b(g,f){this.defaultOptions={isHeader:false,isStatic:false,isHidden:false,isEditable:undefined,isResizable:true,value:undefined,rowID:0,columnID:0,manager:null,width:100,height:28,rowSpan:1,colSpan:1};this.options=g;this._parentElement=f;this._manager=this.options.manager;this._style=null;this._cellCssClasses=null;this._highlightClass="wux-datagrid-cell-highlighted";this._isActive=false;this._isHighlighted=false;this._isSelected=false;this._isInWriteMode=undefined;this._viewIsUpdated=false;this._id=c++}b.prototype.destroy=function(){this.defaultOptions=null};b.prototype._getID=function(){return this._id};b.prototype.isMerged=function(){return this.options.rowSpan===0&&this.options.colSpan===0};b.prototype.isEdited=function(){return this._isInWriteMode};b.prototype.setMergeState=function(f){if(!f){this.options.rowSpan=1;this.options.colSpan=1}else{this.options.rowSpan=0;this.options.colSpan=0}};b.prototype.resetSpan=function(){var m={virtualRowID:this.getRowID(),virtualColumnID:this.getColumnID()};var k=this.getRowSpan();var l=this.getColSpan();for(var h=0;h<k;h++){for(var f=0;f<l;f++){var g=this._manager.getCell(m.virtualRowID+h,m.virtualColumnID+f);g.setMergeState(false);g._show()}}};b.prototype.setRowSpan=function(g,f){this.options.rowSpan=g;this.options.shiftRowSpan=f};b.prototype.getRowSpan=function(){return this.options.rowSpan};b.prototype.setColSpan=function(g,f){this.options.colSpan=g;this.options.shiftColSpan=f};b.prototype.getColSpan=function(){return this.options.colSpan};b.prototype.notifyModelUpdate=function(){this._manager._modelEvents.publish({event:"cellModelUpdate",data:{},context:this})};b.prototype.setCellContent=function(f){this.options.oldValue=this.options.value;this.options.value=f};b.prototype.getCellContent=function(){return this.options.value!==undefined?this.options.value:""};b.prototype.setCoordinates=function(g,f){this.options.rowID=g;this.options.columnID=f};b.prototype.getRowID=function(){return this.options.rowID};b.prototype.getColumnID=function(){return this.options.columnID};b.prototype.getView=function(){return this._view};b.prototype.setView=function(f){this._view=f};b.prototype.setCellStyle=function(f){this._style=f};b.prototype.removeClass=function(f){if(this._cellCssClasses){var g=this._cellCssClasses.indexOf(f);if(g!==-1){this._cellCssClasses.splice(g,1);if(this._cellCssClasses.length===0){this._cellCssClasses=null}}}};b.prototype.hasClass=function(f){if(this._cellCssClasses){var g=this._cellCssClasses.indexOf(f);return(g!==-1)}else{return false}};b.prototype.addClass=function(f){if(this._cellCssClasses===null){this._cellCssClasses=[]}if(this._cellCssClasses.indexOf(f)===-1){this._cellCssClasses.push(f)}};b.prototype.getCssClasses=function(){return this._cellCssClasses||[]};b.prototype.active=function(){this._isActive=true};b.prototype.inactive=function(){this._isActive=false};b.prototype.isActive=function(){return this._isActive};b.prototype.isHighlighted=function(){return this._isHighlighted};b.prototype.highlight=function(){this._isHighlighted=true};b.prototype.unhighlight=function(){this._isHighlighted=false};b.prototype.isSelected=function(){return this._isSelected};b.prototype.select=function(){this._isSelected=true;this.highlight()};b.prototype.unselect=function(){this._isSelected=false;this.unhighlight()};b.prototype.getCellStyle=function(){return this._style};b.prototype._show=function(){this.options.isHidden=false};b.prototype._hide=function(){this.options.isHidden=true};b.prototype.isHidden=function(){return this.options.isHidden};b.prototype._getPositionInViewPort=function(){return{x:this._x,y:this._y}};b.prototype._getDimensions=function(){var g=this._manager.getColumnsManager().getColumnWidth(this.options.columnID);var f=this._manager.getRowsManager().getRowHeight(this.options.rowID);return{width:g,height:f}};return b});define("DS/Spreadsheet2/CellModel",["DS/Spreadsheet/CellModel"],function(a){return a});define("DS/UIBehaviors/KeymapManager",["UWA/Core","DS/Utilities/Utils","DS/UIBehaviors/CommandsRegistry","DS/Utilities/Dom"],function(c,f,h,a){var b=30;var d=false;var e=null;var i=false;var j=function(r,l,z,k){if(r._domTarget){if(l!==undefined){if(d===false&&r._shouldProcessEvent({event:k})){var o=r._keymap.all;var m=r._keymap.defaultKey;var p=r._keymap[z];var x=false;var u,n,v,A,w,q;if(o){u=o[k.type];if(u){n=l.getCommand(u)}}if(p){v=p[k.type];if(v){A=l.getCommand(v)}}else{if(m){w=m[k.type];if(w){q=l.getCommand(w)}}}if(n||A||q){var t,y;a._pushUserInteractionContext();if(n){y=a._callMethodFromUIInteraction(r._jsModel,n,[k]);if(r._spyCB){r._spyCB({keymap:z,commandForKey:u})}}if(A){t=a._callMethodFromUIInteraction(r._jsModel,A,[k]);if(r._spyCB){r._spyCB({keymap:z,commandForKey:v})}}else{if(m){t=a._callMethodFromUIInteraction(r._jsModel,q,[k]);if(r._spyCB){r._spyCB({keymap:z,commandForKey:w})}}}a._popUserInteractionContext();if((t&&t.preventDefault)||(z==="space"&&(!k.target||(k.target.type&&k.target.type.indexOf("text")===-1)))){k.preventDefault()}if(k.type==="keyup"){if(r._infosOnKeyDown&&r._infosOnKeyDown[z]){for(var s in r._infosOnKeyDown[z]){if(typeof r._infosOnKeyDown[z][s]!=="undefined"){k[s]=r._infosOnKeyDown[z][s]}}r._infosOnKeyDown[z]=undefined;delete r._infosOnKeyDown[z]}}if(y&&y.infos){for(var s in y.infos){if(typeof y.infos[s]!=="undefined"){k[s]=y.infos[s]}}if(k.type==="keydown"){if(!r._infosOnKeyDown){r._infosOnKeyDown={};r._infosOnKeyDown[z]=t.infos}else{if(r._infosOnKeyDown[z]){for(var s in y.infos){r._infosOnKeyDown[z][s]=y.infos[s]}}else{r._infosOnKeyDown[z]=y.infos}}}}if(t&&t.infos){if(k.type==="keydown"){if(!r._infosOnKeyDown){r._infosOnKeyDown={};r._infosOnKeyDown[z]=t.infos}else{if(r._infosOnKeyDown[z]){for(var s in t.infos){r._infosOnKeyDown[z][s]=t.infos[s]}}else{r._infosOnKeyDown[z]=t.infos}}}for(var s in t.infos){if(typeof t.infos[s]!=="undefined"){k[s]=t.infos[s]}}}x=!(t&&t.stopPropagation===false)}else{if(k.type==="keyup"){if(r._infosOnKeyDown&&r._infosOnKeyDown[z]){for(var s in r._infosOnKeyDown[z]){if(typeof r._infosOnKeyDown[z][s]!=="undefined"){k[s]=r._infosOnKeyDown[z][s]}}r._infosOnKeyDown[z]=undefined;delete r._infosOnKeyDown[z]}}}if(x){k.stopPropagation();k.stopImmediatePropagation()}}}}};function g(m){this._keymap={};this._domTarget=m.target;this._jsModel=m.jsModel;if(!m.jsModel&&this._domTarget){this._jsModel=this._domTarget.dsModel}this._commandsRegistry=m.commandsRegistry;this._shouldProcessEvent=m.shouldProcessEvent||function(){return true};var l=0;var k;var n=this;this._processCB=function(q){var p=window.performance?performance.now():Date.now();var o=c.Event.whichKey(q);if((window.__karma__!==undefined)||(o!==k)||(e||q.type!==e.type)||(p-l>=b)){e=q;if(i){console.group("keystroke:"+o);console.time("process "+o)}j(n,n._commandsRegistry,o,q);if(i){console.groupEnd("keystroke:"+o);console.timeEnd("process "+o)}l=window.performance?performance.now():Date.now();k=o}else{if(i){console.log("Ignore keydown",p,l,p-l)}q.preventDefault();q.stopPropagation();q.stopImmediatePropagation()}};c.Element.addEvent.call(this._domTarget,"keydown",this._processCB);c.Element.addEvent.call(this._domTarget,"keyup",this._processCB);return this}g.prototype.destroy=function(){this._keymap=null;c.Element.removeEvent.call(this._domTarget,"keydown",this._processCB);c.Element.removeEvent.call(this._domTarget,"keyup",this._processCB)};g.prototype.wait=function(){d=true};g.prototype.listen=function(){d=false};g.prototype._getCurrentEvent=function(){return e};g.prototype.registerKeymap=function(l,m,k){this._keymap[l]={keydown:m,keyup:k}};g.prototype.spy=function(k){this._spyCB=k};g.prototype.unregisterKeymap=function(k){if(this._keymap[k]){delete this._keymap[k]}};g.prototype._getKeymap=function(){return this._keymap};return g});define("DS/Controls/Abstract",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/BaseComponent","DS/Controls/TooltipModel","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Utilities/TouchUtils","DS/Utilities/Utils","DS/Utilities/Dom"],function(l,f,b,e,h,c,k,m,o,i,a){var n=false;var d=false;var j=function(r,t,s){var q=document.createEvent("Event");if(s===undefined||s===null){s={}}var p=(s.bubbles!==undefined)?s.bubbles:true;q.initEvent(t,p,false);q.dsModel=r;q.options=s;return q};var g=e.inherit({name:"abstract",publishedProperties:{domId:{defaultValue:null,type:"string",category:"Behavior"},disabled:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},visibleFlag:{defaultValue:true,type:"boolean",category:"Behavior",recordFlag:true},animation:{defaultValue:null,type:"object",noNeedToApplyFlag:true,category:"Appearance"},touchMode:{defaultValue:undefined,type:"boolean",category:"Accessibility"},tooltipInfos:{defaultValue:undefined,type:"DS/Controls/TooltipModel",category:"Accessibility"},recId:{defaultValue:null,type:"string",category:"Record",uiDisplay:false},fireOnlyFromUIInteractionFlag:{defaultValue:false,type:"boolean",category:"Behavior",noNeedToApplyFlag:true}},blackBoxFlag:false,keymaps:{},commands:{},getPublishedPropertiesDefaultValue:function(){var p={};var q=Object.getPrototypeOf(this);if(q&&q.publishedProperties){for(var r in q.publishedProperties){if(q.publishedProperties.hasOwnProperty(r)){p[r]=q.publishedProperties[r].defaultValue}}}return p},addEventListener:function(q,r,p){this.getContent().addEventListener(q,r,p)},removeEventListener:function(q,r,p){if(this.elements.container||this.container){this.getContent().removeEventListener(q,r,p)}},destroy:function(){if(this._keymapManager){this._keymapManager.destroy()}a.removeAllEventsOnElement(this);this._parent()},_isCurrentlyCalledFromUIInteraction:function(){return a._isCurrentlyCalledFromUIInteraction()},fire:function(r,p){if(this.getContent()&&!this.disabled){var q=a._increaseCurrentPositionInStack(this.getContent());if(!this.fireOnlyFromUIInteractionFlag){this.getContent().dispatchEvent(j(this,r,p))}if(q.inCurrentUIInteractionStack&&q.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_event",reason:"UIInteraction",event:r,eventOptions:p},undefined,true)}}if(q.inCurrentUIInteractionStack&&this.fireOnlyFromUIInteractionFlag){this.getContent().dispatchEvent(j(this,r,p))}if(q.increment){a._decreaseCurrentPositionInStack()}}},setPropertyFromUIInteraction:function(r,q){if(!this.elements.container&&!this.container){return}if(this._properties&&this._properties[r]&&((Array.isArray(q)||(q instanceof Date))?f.equals(this._properties[r].value,q):this._properties[r].value===q)){return}var p=a._increaseCurrentPositionInStack(this.getContent());if(p.inCurrentUIInteractionStack&&p.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_property",property:r,value:q},undefined,true)}}this[r]=q;if(p.increment){a._decreaseCurrentPositionInStack()}},setReadOnlyPropertyFromUIInteraction:function(t,p){if(!this.elements.container&&!this.container){return}var s=t.substring(0,1).toUpperCase()+t.substring(1,t.length);var u="_apply"+s;var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_readOnlyProperties",property:t,value:p},undefined,true)}}for(var q in p){if(!p.hasOwnProperty(q)||!this._properties[t]){continue}this._properties[t][q]=p[q]}if(this[u]){this[u]()}if(r.increment){a._decreaseCurrentPositionInStack()}},modifyObjectFromUIInteraction:function(t,p){if(!this.elements.container&&!this.container){return}var s=t.substring(0,1).toUpperCase()+t.substring(1,t.length);var u="_apply"+s;var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_subproperties",property:t,value:p},undefined,true)}}for(var q in p){if(!p.hasOwnProperty(q)){continue}this[t][q]=p[q]}this[u]();if(r.increment){a._decreaseCurrentPositionInStack()}},modifyArrayFromUIInteraction:function(s,q){if(!this.elements.container&&!this.container){return}var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_property",property:s,value:this[s]},undefined,true)}}var p=Array.prototype.slice.call(arguments,2);q.apply(this[s],p);if(r.increment){a._decreaseCurrentPositionInStack()}},callMethodFromUIInteraction:function(q){var p=Array.prototype.slice.call(arguments,1);return a._callMethodFromUIInteraction(this,this[q],p)},_preBuild:function(r){if(this._preBuildView){this._preBuildView(r)}if(Object.keys(this.keymaps).length>0&&Object.keys(this.commands).length>0){var t=this._getCommandRegistry();var r={target:this.getContent(),jsModel:this,commandsRegistry:t};this._keymapManager=new k(r);for(var s in this.keymaps){if(typeof this.keymaps[s]==="object"){var q=(this.keymaps[s].keydown?this.name+":"+this.keymaps[s].keydown:undefined);var p=(this.keymaps[s].keyup?this.name+":"+this.keymaps[s].keyup:undefined);this._keymapManager.registerKeymap(s,q,p)}else{this._keymapManager.registerKeymap(s,this.name+":"+this.keymaps[s])}}}},_getCommandRegistry:function(){function r(u){var t=u;do{t=t.__proto__;if(t&&t._getCommandRegistry){var s=t._getCommandRegistry();if(s){return s}}}while(t&&t._getCommandRegistry);return null}var p=Object.getPrototypeOf(this);if(!p){return null}if(p.hasOwnProperty("_commandRegistry")){return p._commandRegistry}p._commandRegistry=new m(r(p));for(var q in this.commands){p._commandRegistry.registerCommand(this.name+":"+q,this.commands[q])}return p._commandRegistry},_build:function(){if(this.buildView){this.buildView()}if(this.touchMode===undefined){this._applicationTouchMode=o.getTouchMode();if(this["_applyTouchMode"]){this._applyTouchMode()}}},_postBuild:function(){if(this._postBuildView){this._postBuildView()}if(this._handleEvents){this._handleEvents()}if(this.markForRecordFlag&&this.markForRecord){this.markForRecord(this.getContent())}},_preBuildView:function(){if(!this.elements.container){this.elements.container=new b("div",{"class":"wux-controls-abstract"})}else{this.elements.container.addClassName("wux-controls-abstract")}this.elements.container.dsModel=this},_handleEvents:function(){var p=this;if(this.getContent()){a.addEventOnElement(this,this.getContent(),"focus",function(){p._giveFocus()},true);a.addEventOnElement(this,this.getContent(),"blur",function(){p._resetFocus()},true)}if(this.handleEvents){this.handleEvents()}},_applyDisabled:function(){if(this.disabled){this.getContent().setAttributeNode(document.createAttribute("disabled"));if(this.getContent().getAttributeNode("focused")){this.getContent().removeAttribute("focused")}}else{this.getContent().removeAttribute("disabled")}},_applyTouchMode:function(){var p=this._getCurrentTouchMode();if(p===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}},_getCurrentTouchMode:function(){if(this.touchMode===undefined){return o.getTouchMode()}else{return this.touchMode}},_touchModeChange:function(p){this._applicationTouchMode=p;if(this._applicationTouchMode&&!this.touchMode){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{if(!this._applicationTouchMode&&!this.touchMode){this.getContent().removeAttribute("touch-mode")}}if(this.touchMode===undefined&&this.touchMode!==this._applicationTouchMode){if(this["_applyTouchMode"]){this._applyTouchMode()}}},_applyDomId:function(q){if(this.domId){var p=document.createAttribute("id");p.value=this.domId;this.getContent().setAttributeNode(p)}else{if(q){var r=this.getContent().id;if(q===r){this.getContent().removeAttribute("id")}}}},_applyRecId:function(){if(this.recId){var p=document.createAttribute("data-rec-id");p.value=this.recId;this.getContent().setAttributeNode(p);if(!this.elements.container.getCheckpointData){this.elements.container.getCheckpointData=function(w){var u={};var q=this.dsModel;if(q&&q.publishedProperties){for(var t in q.publishedProperties){var v=q.publishedProperties[t];if(v.recordFlag){if(Array.isArray(v.recordFlag)){if(q[t]){var s={};for(var r=0;r<v.recordFlag.length;r++){s[v.recordFlag[r]]=q[t][v.recordFlag[r]]}u[t]=s}}else{if(q[t]!==undefined){u[t]=q[t]}}}}}w(u,false)}}}else{this.getContent().removeAttribute("data-rec-id");this.elements.container.getCheckpointData=undefined}},_applyVisibleFlag:function(){this.visibleFlag?b.prototype.constructor.show.call(this.getContent()):b.prototype.constructor.hide.call(this.getContent())},_applyTooltipInfos:function(){if(this.tooltipInfos!==undefined){this.tooltipInfos.owner=this}},_applyProperties:function(p){if(this.isDirty("disabled")){this._applyDisabled(p?p.disabled:undefined)}if(this.isDirty("visibleFlag")&&(!p||(p.visibleFlag!==undefined))){this._applyVisibleFlag(p?p.visibleFlag:undefined)}if(this.isDirty("touchMode")){this._applyTouchMode(p?p.touchMode:undefined)}if(this.isDirty("recId")){this._applyRecId(p?p.recId:undefined)}if(this.isDirty("domId")){this._applyDomId(p?p.domId:undefined)}},_giveFocus:function(){this.getContent().setAttributeNode(document.createAttribute("focused"))},_resetFocus:function(){this.getContent().removeAttribute("focused")},_isFocused:function(){return this.getContent().hasAttribute("focused")},show:function(r){r=r||true;var q=this.animation;function p(s){s.target.removeEventListener("animationend",p);s.target.removeClassName("wux-ui-animation-"+q.show+"-in")}this._parent();if(r===true&&q&&q.show){this.getContent().addClassName("wux-ui-animation-"+q.show+"-in");this.getContent().addEventListener("animationend",p)}this.visibleFlag=true},hide:function(s){s=s||true;var r=this.animation;var q=this;function p(t){q.applyVisibleFlag=false;t.target.removeEventListener("animationend",p);t.target.removeClassName("wux-ui-animation-"+r.hide+"-out")}if(s===true&&r&&r.hide){this.getContent().addClassName("wux-ui-animation-"+r.hide+"-out");this.getContent().addEventListener("animationend",p)}else{this.visibleFlag=false}}});return g});require(["DS/UIBehaviors/TooltipManager"],function(a){if(a){require(["DS/Controls/Tooltip"],function(b){if(a._tooltipFrame===undefined){a._tooltipFrame=new b()}})}});define("DS/Controls/Breadcrumb",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Handlebars/Handlebars","DS/Utilities/Dom","DS/Menu/ContextualMenu"],function(b,d,l,m,c,n,k){var u="{{#unless isExpandableSeparator}}                         <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-expand-right wux-ui-3ds-lg'></div>                       {{/unless}}                       {{#if isIconVisible}}                         <div class='wux-controls-breadcrumb-item-icon'>{{&icon}}</div>                       {{/if}}                       {{#if isLabelVisible}}                         <div class='wux-controls-breadcrumb-item-label'>{{label}}</div>                       {{/if}}                       {{#if isExpandableSeparator}}                         <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-chevron-right wux-ui-3ds-lg'></div>                       {{/if}}";var f={task:c.compile(u)};function g(v,x,w){if(!v||!v.elements||!v.elements.container){return}if(x){v.elements.container.setAttributeNode(document.createAttribute("is-hovered"));if(w===1||this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){if(v.elements.icon){v.elements.icon.setAttributeNode(document.createAttribute("is-hovered"))}if(v.elements.label){v.elements.label.setAttributeNode(document.createAttribute("is-hovered"))}}if(w===2||this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){if(v.elements.separator){v.elements.separator.setAttributeNode(document.createAttribute("is-hovered"))}}}else{v.elements.container.removeAttribute("is-hovered");if(v.elements.icon){v.elements.icon.removeAttribute("is-hovered")}if(v.elements.label){v.elements.label.removeAttribute("is-hovered")}if(v.elements.separator){v.elements.separator.removeAttribute("is-hovered")}}}function h(){while(this.elements.container.firstChild){this.elements.container.removeChild(this.elements.container.firstChild)}this._listItems=[];this._applyValue()}function a(v,w){if(typeof(w)==="string"){return v.label===w&&v.value===w&&v.icon===undefined}return v.label===w.label&&v.value===w.value?w.value:w.label&&v.icon===w.icon}function p(w,v){var x={label:"",index:v,selected:false,elements:{}};if(typeof(w)==="string"){x.label=w;x.value=w}else{x.label=w.label?w.label:"";x.icon=w.icon;x.value=w.value?w.value:x.label}q.call(this,x);e.call(this,x);return x}function q(z){z.elements.container=b.createElement("span",{"class":"wux-controls-breadcrumb-item"});z.elements.container.setAttribute("index",z.index);z.elements.container.setAttribute("is-selected",false);var y=z.label&&(this.displayLabels!==j.DISPLAY_ELEMENT.NONE);var A=z.icon&&(this.displayIcons!==j.DISPLAY_ELEMENT.NONE);var w;if(A){var v=b.createElement("div");var x=n.generateIcon(z.icon);v.setContent(x);w=v.innerHTML;v.destroy()}z.elements.container.setContent(f.task({label:z.label,isLabelVisible:y,icon:w,isIconVisible:A,isExpandableSeparator:this.expandableSeparatorFlag}));z.elements.label=y?z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-label")[0]:undefined;z.elements.icon=A?z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-icon")[0]:undefined;z.elements.separator=z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-separator")[0]}function e(y){var x=this;function w(B){if(x.disabled){return}if(x.mode===j.MODE.MULTIPLE_SELECTION){if(y.selected){for(var z=0;z<x.selectedValues.length;z++){if(a.call(x,y,x.selectedValues[z])){x.selectedValues.splice(z,1);break}}y.selected=false;y.elements.container.setAttribute("is-selected",false)}else{x.selectedValues.push(x.value[y.index]);y.selected=true;y.elements.container.setAttribute("is-selected",true)}x.fire("selectionChange")}else{if(x.mode===j.MODE.EXCLUSIVE_SELECTION){if(!y.selected){x.selectedValues=[x.value[y.index]]}}else{if(x.mode===j.MODE.NAVIGATION){var A=x.value.length-1-y.index;i.call(x,A)}}}}if(this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){y.elements.container.addEventListener("click",w)}else{if(y.elements.label){y.elements.label.addEventListener("click",w)}if(y.elements.icon){y.elements.icon.addEventListener("click",w)}}if(this.expandableSeparatorFlag){y.elements.separator.addEventListener("click",function v(z){z.stopPropagation();if(!x.disabled){x.fire("separatorClick",{index:y.index})}})}}function s(z){var w;if(z!==undefined){w=z}else{w=this.value.length}if(this.mode===j.MODE.MULTIPLE_SELECTION){for(var v=0;v<this.selectedValues.length;v++){var y=this.selectedValues[v];var A=false;for(var x=0;x<w;x++){A=b.equals(this.value[x],y);if(A){break}}if(!A){this._applySelectedValues();return}}}else{if(this.mode===j.MODE.EXCLUSIVE_SELECTION){if(this.selectedValues.length>1){this._applySelectedValues();return}var A=false;for(var x=0;x<w;x++){A=b.equals(this.value[x],this.selectedValues[0]);if(A){break}}if(!A){this._applySelectedValues()}}else{if(this.mode===j.MODE.NAVIGATION){if(this.value.length>0){if(b.equals(this.value[this.value.length-1],this.selectedValues[0])){this._applySelectedValues()}else{this.selectedValues=[this.value[this.value.length-1]]}}else{this.selectedValues=[]}}}}}function t(){var z=[];if(this.mode===j.MODE.MULTIPLE_SELECTION||this.mode===j.MODE.EXCLUSIVE_SELECTION){for(var v=0;v<this.selectedValues.length;v++){var x=this.selectedValues[v];var y=false;for(var w=0;w<this.value.length;w++){y=b.equals(this.value[w],x);if(y){z.push(w);break}}if(!y){console.error("UpdateSelectedItems should not be call with wrong values.")}}}else{if(this.mode===j.MODE.NAVIGATION){z.push(this.value.length-1)}}for(var v=0;v<this._listItems.length;v++){if(z.indexOf(v)!==-1){this._listItems[v].selected=true;this._listItems[v].elements.container.setAttribute("is-selected",true)}else{this._listItems[v].selected=false;this._listItems[v].elements.container.setAttribute("is-selected",false)}}}function i(w){if(w<=0){return}var x=this._listItems.length-1;for(var v=0;v<w;v++){this.elements.container.removeChild(this._listItems[x-v].elements.container);this._listItems.pop()}this.value.splice(x-w+1,w);s.call(this);this.fire("change")}function o(w){var v=-1;var x=-1;while(w&&v===-1&&!n.hasClass(w,"wux-controls-breadcrumb")){if(n.hasClass(w,"wux-controls-breadcrumb-item-separator")){v=w.parentNode.getAttribute("index");x=2}else{if(n.hasClass(w,"wux-controls-breadcrumb-item-label")||n.hasClass(w,"wux-controls-breadcrumb-item-icon")){v=w.parentNode.getAttribute("index");x=1}else{if(n.hasClass(w,"wux-controls-breadcrumb-item")){v=w.getAttribute("index");x=0}}}w=w.parentNode}return{indexFound:v,itemFound:x}}var j=m.inherit({name:"breadcrumb",publishedProperties:{value:{defaultValue:[],type:"array",category:"Behavior"},selectedValues:{defaultValue:[],type:"array",category:"Helper"},mode:{defaultValue:0,type:"enum",category:"Behavior"},expandableSeparatorFlag:{defaultValue:false,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:0,type:"enum",category:"Appearance"},displayIcons:{defaultValue:1,type:"enum",category:"Appearance"},displayLabels:{defaultValue:1,type:"enum",category:"Appearance"},onContextualEvent:{defaultValue:function r(v){return[]},type:"function",noNeedToApplyFlag:true},customContextMenuFlag:{defaultValue:false,type:"boolean",category:"Behavior",noNeedToApplyFlag:true}},_preBuild:function(){this._parent();this.elements.container.addClassName("wux-controls-breadcrumb");this._listItems=[]},handleEvents:function(){var w=this;var v=-1;this.elements.container.addEventListener("mouseover",function(A){if(w.disabled){return}var y=o.call(w,A.target);var x=y.indexFound;var B=y.itemFound;if(v>-1){if(v<w._listItems.length){var z=w._listItems[v];g.call(w,z,false)}}if(x>-1){var z=w._listItems[x];g.call(w,z,true,B)}if(v!=x){w.fire("preSelection",{oldItem:Number(v),newItem:Number(x)})}v=x});this.elements.container.addEventListener("mouseleave",function(y){if(v>-1){if(v<w._listItems.length){var x=w._listItems[v];g.call(w,x,false)}}w.fire("preSelection",{oldItem:Number(v),newItem:Number(-1)});v=-1});this._ctxMenuToken=k.addEventListener(this.elements.container,{callback:function(B){if((!w.disabled)&&(typeof w.onContextualEvent==="function")){var A=undefined;var x=-1;var z=o.call(w,B.data.target);if((z.indexFound<w._listItems.length)&&(z.indexFound>-1)){A=w._listItems[z.indexFound]}if(A&&A.selected===true){x=z.indexFound}if(x!==-1){var y=w.onContextualEvent.call(w,{context:B.context,infos:B.info,indexFound:x});if(!w.customContextMenuFlag){return y}}}}})},pop:function(){if(this._listItems.length<=0){return}var v=this.value[this.value.length-1];i.call(this,1);return v},push:function(v){this.value.push(v);var w=p.call(this,v,this.value.length-1);this._listItems.push(w);this.elements.container.appendChild(w.elements.container);s.call(this);this.fire("change")},_applyValue:function(x){var z=false;var A=(!this._listItems||this._listItems.length===0)&&this.value.length!==0;var B=undefined;var w=0;for(w;w<this.value.length;w++){if(!A){A=w>=this._listItems.length;if(!A){A=!a.call(this,this._listItems[w],this.value[w]);if(A){for(var v=this._listItems.length-1;v>=w;v--){this.elements.container.removeChild(this._listItems[v].elements.container);this._listItems.pop()}}}}if(A){if(B===undefined){B=w}var y=p.call(this,this.value[w],w);this._listItems.push(y);this.elements.container.appendChild(y.elements.container)}}var z=A;if(!A){for(var v=this._listItems.length-1;v>=w;v--){z=true;this.elements.container.removeChild(this._listItems[v].elements.container);this._listItems.pop()}}s.call(this,B);if(z){this.fire("change")}},_applySelectedValues:function(x){if(this.mode===j.MODE.MULTIPLE_SELECTION){for(var v=0;v<this.selectedValues.length;){var y=this.selectedValues[v];var A=false;for(var w=0;w<this.value.length;w++){A=b.equals(this.value[w],y);if(A){break}}if(A){v++}else{this.selectedValues.splice(v,1)}}}else{if(this.mode===j.MODE.EXCLUSIVE_SELECTION){this.selectedValues.splice(1,this.selectedValues.length-1);var A=false;for(var w=0;w<this.value.length;w++){A=b.equals(this.value[w],this.selectedValues[0]);if(A){break}}if(!A){this._properties.selectedValues.value=[]}}else{if(this.mode===j.MODE.NAVIGATION){var v;for(v=this.value.length-1;v>=0;v--){if(b.equals(this.value[v],this.selectedValues[0])){var z=this.value.length-1-v;if(z>0){i.call(this,this.value.length-1-v);return}break}}if(v<0){this.selectedValues=x;return}}}}t.call(this);this.fire("selectionChange")},_applyMode:function(v){s.call(this)},_applyExpandableSeparatorFlag:function(v){h.call(this);if(this.expandableSeparatorFlag){this.getContent().setAttributeNode(document.createAttribute("expandable-separator"))}else{this.getContent().removeAttribute("expandable-separator")}},_applyDisplayStyle:function(v){this.getContent().setAttribute("display-style",this.displayStyle);h.call(this)},_applyDisplayIcons:function(v){this.getContent().setAttribute("display-icons",this.displayIcons);if(v===j.DISPLAY_ELEMENT.NONE||this.displayIcons===j.DISPLAY_ELEMENT.NONE){h.call(this)}},_applyDisplayLabels:function(v){this.getContent().setAttribute("display-labels",this.displayLabels);if(v===j.DISPLAY_ELEMENT.NONE||this.displayLabels===j.DISPLAY_ELEMENT.NONE){h.call(this)}},_applyDisabled:function(w){this._parent();if(this.disabled){for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.setAttributeNode(document.createAttribute("disabled"));if(x.elements.label){x.elements.label.setAttributeNode(document.createAttribute("disabled"))}if(x.elements.icon){x.elements.icon.setAttributeNode(document.createAttribute("disabled"))}if(x.elements.separator){x.elements.separator.setAttributeNode(document.createAttribute("disabled"))}}}else{for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.removeAttribute("disabled");if(x.elements.label){x.elements.label.removeAttribute("disabled")}if(x.elements.icon){x.elements.icon.removeAttribute("disabled")}if(x.elements.separator){x.elements.separator.removeAttribute("disabled")}}}},_applyTouchMode:function(w){this._parent();if(this.touchMode){for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.setAttributeNode(document.createAttribute("touch-mode"));if(x.elements.label){x.elements.label.setAttributeNode(document.createAttribute("touch-mode"))}if(x.elements.icon){x.elements.icon.setAttributeNode(document.createAttribute("touch-mode"))}if(x.elements.separator){x.elements.separator.setAttributeNode(document.createAttribute("touch-mode"))}}}else{for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.removeAttribute("touch-mode");if(x.elements.label){x.elements.label.removeAttribute("touch-mode")}if(x.elements.icon){x.elements.icon.removeAttribute("touch-mode")}if(x.elements.separator){x.elements.separator.removeAttribute("touch-mode")}}}},_applyProperties:function(v){this._parent(v);if(this.isDirty("value")){this._applyValue(v.value)}else{if(this.isDirty("selectedValues")){this._applySelectedValues(v.selectedValues)}}if(this.isDirty("expandableSeparatorFlag")){this._applyExpandableSeparatorFlag(v.expandableSeparatorFlag)}if(this.isDirty("mode")){this._applyDisplayStyle(v.mode)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(v.displayStyle)}if(this.isDirty("displayLabels")){this._applyDisplayLabels(v.displayLabels)}if(this.isDirty("displayIcons")){this._applyDisplayIcons(v.displayIcons)}if(this.isDirty("touchMode")){this._applyTouchMode(v.touchMode)}},destroy:function(){if(this._ctxMenuToken){k.removeEventListener(this.elements.container,this._ctxMenuToken)}this._parent()},});j.MODE={NAVIGATION:0,MULTIPLE_SELECTION:1,EXCLUSIVE_SELECTION:2};j.DISPLAY_STYLE={LITE:0,IMMERSIVE:1};j.DISPLAY_ELEMENT={NONE:0,ALL:1,SELECTED:2,HOVERED:3,HOVERED_OR_SELECTED:4};return j});define("DS/Controls/Button",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils"],function(e,c,h,f,l,a,d,j){function k(){if(this.elements.icon){if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.empty()}delete this.elements.icon}if(this.elements.separator){this.elements.separator.remove(this.getContent())}var m=a.oldGenerateIcon(this.icon,this.iconSize,WUXManagedFontIcons.FontAwesome);if(m){this.elements.icon=m;if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.show()}this.elements.icon.style.pointerEvents="none";b.call(this);if(this.elements.iconPlaceholder){this.elements.icon.inject(this.elements.iconPlaceholder);if(this.displayStyle==="flyout"){if(!this.elements.separator){this.elements.separator=new e.Element("div",{"class":"wux-button-separator"})}this.elements.separator.inject(this.elements.iconPlaceholder,"after")}}}else{if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.hide()}}}function b(){if(this.elements&&this.elements.icon){(this.label!==undefined&&this.label!==""&&this.displayStyle!=="flyout"&&this.showLabelFlag)?this.elements.icon.style.margin="0px 11px 0px 0px":this.elements.icon.style.margin="0px";if((this.displayStyle==="lite-borders"||(this.displayStyle==="icon"&&this.touchMode))||!this.showLabelFlag){this.elements.icon.style.margin="0px 0px 0px 0px"}}}var g=h.inherit({name:"button",markForRecordFlag:true,publishedProperties:{label:{defaultValue:"",type:"string",category:"Appearance"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},iconSize:{defaultValue:"1x",type:"string",category:"Appearance",uiDisplay:false},value:{defaultValue:undefined,type:"object",category:"Behavior",recordFlag:true},type:{defaultValue:"standard",type:"string",category:"Behavior",noNeedToApplyFlag:true},checkFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},minWidth:{defaultValue:-1,type:"integer",category:"Appearance"},minHeight:{defaultValue:-1,type:"integer",category:"Appearance"},preferredWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredHeight:{defaultValue:-1,type:"integer",category:"Appearance"},onClick:{defaultValue:undefined,type:"function",category:"Behavior"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},showLabelFlag:{defaultValue:true,type:"boolean",category:"Appearance"},allowUnsafeHTMLLabel:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{"return":{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"},},commands:{validate:function(n){if(this.disabled){return{stopPropagation:false}}var o={};if((this.clickMode===1&&n.type==="keydown")||(this.clickMode===0&&n.type==="keyup")){o.actionPerformed=i.call(this);var m={ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,altKey:n.altKey};this.fire("buttonclick",m)}if(e.Event.whichKey(n)==="return"){return{stopPropagation:false,infos:o}}else{return{stopPropagation:true,preventDefault:true,infos:o}}}},_preBuildView:function(){this.elements.container=new e.Element("div",{"class":"wux-controls-button",tabindex:0});this.elements.button=this.elements.container;this._parent();this.isMultiSelection=false},_applyIcon:function(m){if(typeof(this.icon)==="object"){if(!this.icon.iconClasses){this.icon.iconClasses=""}if(!this.icon.iconName){this.icon.iconName=""}if(!this.icon.fontIconFamily){this.icon.fontIconFamily=WUXManagedFontIcons.FontAwesome}if(!this.icon.fontIconSize){this.icon.fontIconSize=this.iconSize}else{this.iconSize=this.icon.fontIconSize}}k.call(this)},_applyIconSize:function(m){if(this.elements.icon){if(typeof(this.icon)==="object"){this.icon.fontIconSize=this.iconSize}k.call(this)}},_applyEmphasize:function(m){if(m){var n=this.elements.button;var o="wux-ui-state-"+m;n.removeClassName(o)}o="wux-ui-state-"+this.emphasize;this.elements.button.addClassName(o)},_applyDisplayStyle:function(m){if(m){this.elements.button.removeClassName("wux-ui-style-"+m)}this.elements.button.addClassName("wux-ui-style-"+this.displayStyle);if(this.displayStyle==="lite-borders"&&this.elements.icon){this.elements.icon.style.margin="0px 0px 0px 0px"}else{if(this.elements.icon){k.call(this)}}},_applyPreferredWidth:function(){if(this.preferredWidth>0){this.elements.button.setStyles({"max-width":this.preferredWidth+"px"});this.elements.button.setStyles({width:"100%"})}else{this.elements.button.setStyles({"max-width ":""});this.elements.button.setStyles({"width ":""})}},_applyPreferredHeight:function(){if(this.preferredHeight>0){this.elements.button.setStyles({"max-height":this.preferredHeight+"px"});this.elements.button.setStyles({height:"100%"})}else{this.elements.button.setStyles({"max-height":""});this.elements.button.setStyles({height:""})}},_applyMinWidth:function(){if(this.minWidth!=-1){this.elements.button.setStyles({"min-width":this.minWidth+"px"})}else{this.elements.button.setStyles({"min-width":""})}},_applyMinHeight:function(){if(this.minHeight!=-1){this.elements.button.setStyles({"min-height":this.minHeight+"px"})}else{this.elements.button.setStyles({"min-height":""})}},_applyOnClick:function(m){if(m){this.removeEventListener("buttonclick",m)}if(this.onClick){this.addEventListener("buttonclick",this.onClick)}},handleEvents:function(){var m=this;a.addEventOnElement(this,this.elements.button,"click",function(o){if(m.disabled){return}if(m.clickMode===0){i.call(m);var n={ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,altKey:o.altKey};m.fire("buttonclick",n)}});a.addEventOnElement(this,this.elements.button,f.POINTERHIT,function(n){if(n.multipleHitCount===2){if(m.disabled){return}m.fire("buttonDblClick")}});a.addEventOnElement(this,this.elements.button,f.POINTERDOWN,function(o){o.dsModel=m;if(m.disabled){return}if(m.clickMode===1){i.call(m);var n={ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,altKey:o.altKey};m.fire("buttonclick",n)}if(o.originalEvent&&o.originalEvent.type==="touchstart"){m.getContent().setAttribute("hasHoverPrevented","")}});this.elements.button.addEventListener("mousedrag",function(n){n.dsModel=m});this.elements.button.addEventListener(f.POINTERUP,function(n){n.dsModel=m});this.elements.button.addEventListener(f.POINTERMOVE,function(n){if(n.originalEvent&&n.originalEvent.type==="mousemove"){m.getContent().removeAttribute("hasHoverPrevented")}})},_applyCheckFlag:function(m){if(this.checkFlag===true){this.elements.button.setAttributeNode(document.createAttribute("checked"));if(!this.multiSelFlag||!this.isMultiSelection){this._uncheckSiblings()}}else{this.elements.button.removeAttribute("checked")}if(m!==undefined&&m!==this.checkFlag&&!this.preventTriggeringChangeEvent){this.fire("change")}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.removeAttribute("tabindex")}else{this.elements.container.setAttribute("tabindex",0)}},_applyLabel:function(m){if((this.label===undefined||this.label==="")){if(this.elements.text){this.elements.text.remove();this.elements.text=undefined;delete this.elements.text}return}if(!this.elements.text){this.elements.text=e.createElement("span");this.elements.text.inject(this.getContent());this._applyShowLabelFlag()}if(j.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)){this.elements.text.setContent(this.label)}else{this.elements.text.textContent=this.label}},_applyShowLabelFlag:function(){if(this.elements.text){if(this.showLabelFlag){this.elements.text.show();this.getContent().setAttributeNode(document.createAttribute("showlabel"))}else{if(!this.showLabelFlag){this.elements.text.hide();this.getContent().removeAttribute("showlabel")}}b.call(this)}},_applyTouchMode:function(){this._parent();b.call(this)},_applyAllowUnsafeHTMLLabel:function(){this._applyLabel(this.label)},_applyProperties:function(m){this._parent(m);if(this.isDirty("emphasize")){this._applyEmphasize(m.emphasize)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(m.displayStyle)}if(this.isDirty("preferredWidth")){this._applyPreferredWidth(m.preferredWidth)}if(this.isDirty("preferredHeight")){this._applyPreferredHeight(m.preferredHeight)}if(this.isDirty("minWidth")){this._applyMinWidth(m.minWidth)}if(this.isDirty("minHeight")){this._applyMinHeight(m.minHeight)}if(!this.elements.iconPlaceholder){this.elements.iconPlaceholder=new e.Element("div",{"class":"wux-button-icon-placeholder"})}if(!this.elements.iconPlaceholder.isInjected(this.getContent())){this.elements.iconPlaceholder.inject(this.getContent())}if(this.isDirty("icon")){this._applyIcon(m.icon)}else{if(this.isDirty("iconSize")){this._applyIconSize(m.iconSize)}}if(this.isDirty("allowUnsafeHTMLLabel")||this.isDirty("label")){this._applyLabel(m.label)}if(this.isDirty("onClick")){this._applyOnClick(m.onClick)}if(this.isDirty("checkFlag")){this._applyCheckFlag()}this._applyDisplayStyle();this._applyShowLabelFlag()},_uncheckSiblings:function(){if(this.type==="radio"){var o=this.elements.container.parentNode;if(o){if(o.dsModel&&o.dsModel.__proto__.name==="buttonGroup"){o.dsModel.preventTriggeringChangeEvent=true}var n=o.childNodes;for(var m=0;m<n.length;m++){if(n[m]!==this.elements.container){if(n[m].dsModel&&n[m].dsModel instanceof g&&n[m].dsModel.type==="radio"){n[m].dsModel.checkFlag=false}}}if(o.dsModel&&o.dsModel.__proto__.name==="buttonGroup"){o.dsModel.preventTriggeringChangeEvent=false}}}}});function i(){if(this.type==="check"){this.setPropertyFromUIInteraction("checkFlag",!this.checkFlag);return true}else{if(this.type==="radio"){if(this.checkFlag){return false}else{this.setPropertyFromUIInteraction("checkFlag",true);return true}}}return true}d.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Tweakers/TweakerBase",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(c,g,e,a,b){function i(k){this._currentValueIcon=this.icon;this._currentValueLabel=null;if((this._properties.value.value===undefined)||((this._properties.value.value==="")&&this.allowResetToUndefinedByUIFlag)){return 1}var q=this.possibleValues;if(q){if(q.length>0){var m=undefined;for(var j=0;j<q.length;j++){var n=q[j];if(typeof(n)==="object"){if(n.value!==undefined&&n.value!==null){if(typeof this._properties.value!=="undefined"&&typeof this._properties.value.value!=="undefined"){var p=(c.typeOf(this._properties.value.value)==="object")?this._properties.value.value.value:this._properties.value.value;if(this.compare(this._upgradeValue(n.value),p)===0){m=n;break}}}else{if(n.label!==undefined&&n.label!==null){if(typeof this._properties.value!=="undefined"&&typeof this._properties.value.value!=="undefined"){var p=(c.typeOf(this._properties.value.value)==="object")?this._properties.value.value.label:this._properties.value.value;if(this.compare(this._upgradeValue(n.label),p)===0){m=n;break}}}}}else{if(this.compare(this._upgradeValue(n),this._properties.value.value)===0){m=n;break}}}if(m===undefined){if(typeof(q[0])==="object"){if(q[0].value){this.value=q[0].value}else{if(q[0].label){this.value=q[0].label}else{this.value=q[0]}}}else{this.value=q[0]}return 0}if(typeof(m)==="object"){if(m.icon){this._currentValueIcon=m.icon}if(m.label){this._currentValueLabel=m.label}else{if(m.labelItem){this._currentValueLabel=m.labelItem}}}}else{if(typeof(q)==="object"){var o=this.valueType;for(var l in q){if(o==="enumValueToProperty"){if(this.compare(l,this._properties.value.value)===0){this._currentValueLabel=q[l];break}}else{if(this.compare(q[l],this._properties.value.value)===0){this._currentValueLabel=l;break}}}}}}return 1}var h=e.inherit({name:"tweakerBase",markForRecordFlag:true,publishedProperties:{value:{defaultValue:undefined,type:"object",advancedSetter:true,recordFlag:true},icon:{defaultValue:undefined,type:"object"},highlightModel:{defaultValue:undefined,type:"object"},minValue:{defaultValue:undefined,type:"object"},maxValue:{defaultValue:undefined,type:"object"},possibleValues:{defaultValue:undefined,type:"array"},valueType:{defaultValue:"",type:"string"},referenceValue:{defaultValue:undefined,type:"object"},showReferenceValueFlag:{defaultValue:false,type:"boolean"},readOnly:{defaultValue:false,type:"boolean"},displayStyle:{defaultValue:undefined,type:"string"},escapeHTML:{defaultValue:false,type:"boolean"},augmentedDisplay:{defaultValue:"popup",type:"string"},editorTitle:{defaultValue:"",type:"string"},dialogOptions:{defaultValue:{width:200,height:240,modalFlag:false,title:undefined,icon:undefined,identifier:undefined},type:"object"},allowUnsafeHTMLContent:{defaultValue:false,type:"boolean"},handleEditionCancel:{defaultValue:true,type:"boolean"},usageDescription:{defaultValue:"",type:"string"},allowResetToUndefinedByUIFlag:{defaultValue:false,type:"boolean"},context:{defaultValue:undefined,type:"object"},alignment:{defaultValue:undefined,type:"string"},numeric:{defaultValue:false,type:"boolean"},},blackBoxFlag:true,_preBuildView:function(){if(!this.elements.container){this.elements.container=new c.Element("div",{"class":"wux-tweakers"})}else{this.elements.container.addClassName("wux-tweakers")}this.elements.container.dsModel=this;this._eventsDisabledCounter=0;this._currentValueLabel=null;this._currentValueIcon=null;this.disableEvents()},_postBuildView:function(){if(this.referenceValue===undefined){this.referenceValue=c.clone(this.value,false)}this._applyDisabled();this.enableEvents()},compare:function(k,j){if(k===j){return 0}else{if(k>j){return 1}else{if(k<j){return -1}else{if((k===undefined)&&(j!==undefined)){return 2}else{return -2}}}}},getStringFromValue:function(j){if((j===null)||(typeof j==="undefined")){return""}return j.toString()},computeContentSize:function(){var j;if(this.elements._viewModule&&this.elements._viewModule.computeTweakerContentLength){j=this.elements._viewModule.computeTweakerContentLength()}else{var k=this.readOnly?this.getContent().innerText:this.value;j=a.computeStringWidth(k,this.getFontSize(),this.getFontFamily(),this.getEditedState())}var l=this.getTweakerPadding();j+=(2*l);if(this.getEditedState()){j+=l}return Math.ceil(j)},getFontSize:function(){var j=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(j)},getFontFamily:function(){return"arial"},getTweakerPadding:function(){return this._getCurrentTouchMode()?14:7},_applyValue:function(j,m){this._properties.value.value=this._upgradeValue(this._properties.value.value);if(this.possibleValues){if(i.call(this,j)===0){return}}else{var k=this.minValue;if(k&&this.compare(this.value,k)===-1){this.value=k;return}var l=this.maxValue;if(l&&this.compare(this.value,l)===1){this.value=l;return}}this._updateEditedState();if(this.elements._viewModule){this.elements._viewModule.setValue(this._properties.value.value);if(this._preEditState===2){this._liveChangeOccurred=true;if(this.getEventsAllowedState()){this.fire("liveChange")}}else{this.onChange()}}else{if(this.elements.internalView!==undefined){if(this.readOnly){this._properties.value.value=(this.value&&this.escapeHTML)?c.String.escapeHTML(this.value):this.value}this.elements.internalView.value=this.value}}},_applyDisabled:function(j){this._parent();if(this.elements._viewModule&&this.elements._viewModule._view){this.elements._viewModule._view.disabled=this.disabled}},_applyIcon:function(j){if(!this.possibleValues){this._currentValueIcon=this.icon}if(this.elements._viewModule&&this.elements._viewModule.setIcon){this.elements._viewModule.setIcon(this.icon)}},_applyMinValue:function(j){this._properties.minValue.value=this._upgradeValue(this._properties.minValue.value);if(this.maxValue&&this.compare(this.maxValue,this.minValue)===-1){this.maxValue=this.minValue}if(this.minValue&&this.compare(this.value,this.minValue)===-1){this.value=this.minValue}if(this.elements._viewModule){this.elements._viewModule.setMinValue(this.minValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.minValue=this.minValue}}},_applyMaxValue:function(j){this._properties.maxValue.value=this._upgradeValue(this._properties.maxValue.value);if(this.minValue&&this.compare(this.minValue,this.maxValue)===1){this.minValue=this.maxValue}if(this.maxValue&&this.compare(this.value,this.maxValue)===1){this.value=this.maxValue}if(this.elements._viewModule){this.elements._viewModule.setMaxValue(this.maxValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.maxValue=this.maxValue}}},_applyReferenceValue:function(j){this._properties.referenceValue.value=this._upgradeValue(this._properties.referenceValue.value);this._updateEditedState()},_applyShowReferenceValueFlag:function(j){this._updateEditedState()},_applyReadOnly:function(j){if(this.elements._viewModule&&j!==undefined){if(!this.isDirty("displayStyle")){this._applyDisplayStyle()}}else{if(this.elements.internalView!==undefined){this.elements.internalView.disabled=this.readOnly}}},_applyTouchMode:function(){this._parent();var j=this._getCurrentTouchMode();if(this.elements._viewModule){this.elements._viewModule.setTouchMode(j)}else{if(this.elements.internalView!==undefined){this.elements.internalView.touchMode=j}}},_applyAllowUnsafeHTMLContent:function(j){if(this.elements._viewModule&&this.elements._viewModule.setAllowUnsafeHTMLContent){this.elements._viewModule.setAllowUnsafeHTMLContent(this.allowUnsafeHTMLContent,j)}},_applyDisplayStyle:function(k){if(this.elements.container===undefined){return}if(this.elements._viewModule){this.onPostEdit();var l=this.elements._viewModule;this.elements._viewModule=undefined;l.destroy()}var j=this._resolveViewModuleToApply(this.displayStyle);if(!j||!j.id||!j.definition){return}this.elements._viewModule=new j.definition.classObject(this,j.definition.options);this.elements._viewModule.inject(this.elements.container);this.elements.internalView=(this.elements._viewModule._view?this.elements._viewModule._view:this.elements.container);if(this._isFocused()){if(this.elements.internalView._giveFocus){this.elements.internalView._giveFocus()}}this._properties.possibleValues.dirty=false;this._properties.value.dirty=false},_applyHighlightModel:function(j){if(this.elements._viewModule&&this.elements._viewModule.setHighlightModel){this.elements._viewModule.setHighlightModel(this.highlightModel)}},_applyUsageDescripton:function(j){if(this.elements._viewModule&&this.elements._viewModule.setUsageDescription){this.elements._viewModule.setUsageDescription(this.usageDescription)}},_applyAllowResetToUndefinedByUIFlag:function(j){if(this.elements._viewModule&&this.elements._viewModule.setAllowResetToUndefinedByUIFlag){this.elements._viewModule.setAllowResetToUndefinedByUIFlag(this.allowResetToUndefinedByUIFlag)}},_applyAlignment:function(j,k){if(!this.alignment&&this.numeric){this.alignment="far";return}if(this.alignment==="near"){this.elements.container.setAttribute("alignment","near")}else{if(this.alignment==="center"){this.elements.container.setAttribute("alignment","center")}else{if(this.alignment==="far"){this.elements.container.setAttribute("alignment","far")}else{this.elements.container.removeAttribute("alignment")}}}},_applyNumeric:function(j,k){if(!this.alignment&&this.numeric){this.alignment="far"}},getEditedState:function(){var m=false;if(this.showReferenceValueFlag&&(this.referenceValue!==undefined)){var k=this.value;var l=this.referenceValue;var n=this.isDirty("value")?this._upgradeValue(k):k;var j=this.isDirty("referenceValue")?this._upgradeValue(l):l;m=!c.equals(n,j)}return m},_updateEditedState:function(){if(this.getEditedState()){this.elements.container.classList.add("wux-tweakers-edited")}else{this.elements.container.classList.remove("wux-tweakers-edited")}if(this.elements._viewModule&&this.elements._viewModule.usesReferenceValueLabel()){this.elements._viewModule.updateReferenceValueLabel()}},destroy:function(){if(this.elements._viewModule){this.elements.internalView=undefined;delete this.elements.internalView}this._parent()},_applyEscapeHTML:function(){var j=this.elements.internalView;if(j!==undefined&&typeof j!=="undefined"){this.elements.internalView.escapeHTML=this.escapeHTML}},_applyPossibleValues:function(j){if(this.elements._viewModule){this.elements._viewModule.setPossibleValues(this.possibleValues)}if(!this.isDirty("value")){i.call(this,undefined)}},_applyProperties:function(j){this._parent(j);if(this.isDirty("highlightModel")){this._applyHighlightModel(j.highlightModel)}if(this.isDirty("allowUnsafeHTMLContent")){this._applyAllowUnsafeHTMLContent(j.allowUnsafeHTMLContent)}if(this.isDirty("readOnly")){this._applyReadOnly(j.readOnly)}if(this.isDirty("touchMode")){this._applyTouchMode(j.touchMode)}if(this.isDirty("escapeHTML")){this._applyEscapeHTML(j.escapeHTML)}if(this.isDirty("possibleValues")){this._applyPossibleValues(j.possibleValues)}if(this.isDirty("minValue")){this._applyMinValue(j.minValue)}if(this.isDirty("maxValue")){this._applyMaxValue(j.maxValue)}if(this.isDirty("value")){if(!this._preEditValue||this._preEditValue(j.value,this.value)){this._applyValue(j.value,this.value)}}if(this.isDirty("referenceValue")){this._applyReferenceValue(j.referenceValue)}if(this.isDirty("showReferenceValueFlag")){this._applyShowReferenceValueFlag(j.showReferenceValueFlag)}if(this.isDirty("icon")){this._applyIcon(this.icon)}if(this.isDirty("allowResetToUndefinedByUIFlag")){this._applyAllowResetToUndefinedByUIFlag(j.allowResetToUndefinedByUIFlag)}if(this.isDirty("usageDescription")){this._applyUsageDescripton(j.usageDescription)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(j.displayStyle)}if(this.isDirty("disabled")){this._applyDisabled(j.disabled)}if(this.isDirty("alignment")){this._applyAlignment(j.alignment)}if(this.isDirty("numeric")){this._applyNumeric(j.numeric)}},handleEvents:function(){},_upgradeValue:function(j){return j},resetToReferenceValue:function(){this.value=this.referenceValue},setValueAsReference:function(){this.referenceValue=c.clone(this.value,false)},_giveFocus:function(){this._parent();if(this.getContent()===document.activeElement||!a.isActiveElementInContainer(this.getContent())){if(this.elements.internalView&&this.elements.internalView._giveFocus){this.elements.internalView._giveFocus()}}},_resolveViewModuleToApply:function(l){var k={id:"",definition:undefined};var m=this;function j(s){var q=Object.getPrototypeOf(m);while(q&&!k.definition){var o=q.VIEW_MODULES;if(o){var p="";switch(s){case"id":p=l;break;case"id_readOnly":p=l+"_readOnly";break;case"readOnly":p="readOnly";break;default:break}var r=o[p];if(r&&r.classObject){k.id=p;k.definition=r}}q=Object.getPrototypeOf(q)}}var n=this.readOnly;if(n){j("id_readOnly");j("readOnly")}else{j("id")}return k},applyPropertiesOnView:function(j){if(this.elements._viewModule){var m=this.elements._viewModule.getModifiableOptions();this.elements._viewModule.prepareUpdate();for(var k in j){if(m.indexOf(k)!==-1){var l="set"+k.substring(0,1).toUpperCase()+k.substring(1,k.length);this.elements._viewModule[l](j[k])}}this.elements._viewModule.pushUpdate()}},disableEvents:function(){this._eventsDisabledCounter++},enableEvents:function(){this._eventsDisabledCounter--},getEventsAllowedState:function(){return(this._eventsDisabledCounter===0)},onChange:function(j){if(this._preEditState===2){this._cancelableValue=c.clone(this.value,false)}if(this.getEventsAllowedState()){this.fire("change",j)}this._liveChangeOccurred=false},onPreEdit:function(){if(this._preEditState){return}this._cancelableValue=c.clone(this.value,false);this._preEditState=1;this._liveChangeOccurred=false},onPostEdit:function(j){if(!this._preEditState){return}if(this._popupOpenedState){return}this._cancelableValue=undefined;if(this._liveChangeOccurred){this.onChange()}if(this._preEditState===2){if(this.getEventsAllowedState()){this.fire("postEdit",j)}}this._liveChangeOccurred=false;this._preEditState=0},onCancelEdit:function(j){if(!this._preEditState){return}if(this._cancelableValue===this.value){this.onPostEdit()}else{if(this.handleEditionCancel){this.setPropertyFromUIInteraction("value",this._cancelableValue)}this._preEditState=0;this._cancelableValue=undefined;if(this.getEventsAllowedState()){this.fire("cancelEdit",j)}}},onShow:function(j){this._popupOpenedState=true;this.onPreEdit();if(this.getEventsAllowedState()){this.fire("show",j)}},onHide:function(j){this._popupOpenedState=false;if(j&&j.cancelFlag){this.onCancelEdit()}else{this.onPostEdit()}if(this.getEventsAllowedState()){this.fire("hide",j)}}});var d=function(k,j){this._tweaker=k;this._options=Object.assign({},j);this._cptUpdate=0;this._view=undefined;this.buildView();this.handleEvents()};d.prototype.buildView=function(){};d.prototype.handleEvents=function(){};d.prototype.inject=function(j){if(this._view){if(Array.isArray(this._view)){for(var k=this._view.length-1;k>=0;k--){this._view[k].inject(j,"top")}}else{this._view.inject(j,"top")}}};d.prototype.destroy=function(){if(this._referenceValueLabel){this._referenceValueLabel.destroy();this._referenceValueLabel=undefined}if(this._view){if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].remove();this._view[j].destroy()}}else{this._view.remove();this._view.destroy()}}delete this._view};d.prototype.getModifiableOptions=function(){return[]};d.prototype.setTouchMode=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].touchMode=k}}else{this._view.touchMode=k}};d.prototype.setValue=function(j){};d.prototype.setTweakerValue=function(j){var k=this._tweaker;if(k){if(k._preEditState){if(k._preEditState===1&&k.getEventsAllowedState()){k.fire("preEdit");k._preEditState=2}}k.setPropertyFromUIInteraction("value",j)}};d.prototype.setPossibleValues=function(j){};d.prototype.setAllowUnsafeHTMLContent=function(j){};d.prototype.setUsageDescription=function(j){};d.prototype.setAllowResetToUndefinedByUIFlag=function(j){};d.prototype.setMinValue=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].minValue=k}}else{this._view.minValue=k}};d.prototype.setMaxValue=function(k){if(!this._view){return}if(Array.isArray(this._view)){for(var j=0;j<this._view.length;j++){this._view[j].maxValue=k}}else{this._view.maxValue=k}};d.prototype.usesReferenceValueLabel=function(){return false};d.prototype.updateReferenceValueLabel=function(){var j=this._tweaker;if(!j){return}if(j.getEditedState()){if(!this._referenceValueLabel){this._referenceValueLabel=c.createElement("div",{"class":"wux-tweakers-reference-value"})}this._referenceValueLabel.textContent=j.getStringFromValue(j.referenceValue);if(!this._referenceValueLabel.parentNode){this._referenceValueLabel.inject(this._tweaker.elements.container)}}else{if(this._referenceValueLabel){this._referenceValueLabel.destroy();this._referenceValueLabel=undefined}}};d.prototype.prepareUpdate=function(j){this._cptUpdate++};d.prototype.pushUpdate=function(j){this._cptUpdate--;if(this._cptUpdate===0){this._updateView()}};d.prototype._updateView=function(){};d.prototype.computeTweakerContentLength=function(){if(this._tweaker.readOnly||!this._view){var m=this._tweaker.readOnly?this._tweaker.getContent().innerText:this._tweaker.value;return a.computeStringWidth(m,this._tweaker.getFontSize(),this._tweaker.getFontFamily(),this._tweaker.getEditedState())}else{var l=0;if(Array.isArray(this._view)){for(var k=this._view.length-1;k>=0;k--){var j=parseInt(this._view[k].getContent().offsetWidth);if(!j){j=parseInt(window.getComputedStyle(this._view[k].getContent()).minWidth)}l+=j}}else{l=parseInt(this._view.getContent().offsetWidth);if(!l){l=parseInt(window.getComputedStyle(this._view.getContent()).minWidth)}}return l}};var f=function(k,j){this._currentMode=0;d.call(this,k,j)};g.applyMixin(f,d);f.prototype.buildView=function(){this._previousFormatHTMLValueProperties={};this.formatHTMLValue(this._tweaker.value)};f.prototype._cleanContainerProperties=function(){var j=this._tweaker;if(j.elements.container){j.elements.container.textContent="";j.elements.container.removeClassName("wux-tweakers-string-label");j.elements.container.removeClassName("wux-tweakers-icon");j.elements.container.removeAttribute("wrap");a.cleanIcon(j.elements.container)}};f.prototype.destroy=function(){this._cleanContainerProperties();d.prototype.destroy.call(this)};f.prototype.setSuffix=function(j){if(!this._tweaker||!this._tweaker.elements.container){return}this.formatHTMLValue(this._tweaker.value)};f.prototype.setAllowUnsafeHTMLContent=function(l,j){if(!(this._currentMode&1)||j===l){return}var k=undefined;if(this._currentMode===1){k=this._tweaker.elements.container}else{k=this._label}if(g.getUnsafeHTMLContentValueToApply(l===true)){k.innerHTML=k.textContent}else{k.textContent=k.innerHTML}};f.prototype.setHighlightModel=function(j){if(typeof this._tweaker.value!=="undefined"&&this._tweaker.value!==null){this.formatHTMLValue(this._tweaker.value)}};f.prototype.removeHighlightModel=function(){this.setHighlightModel(undefined)};f.prototype._shouldFormatHTMLValue=function(j){if(Object.keys(this._previousFormatHTMLValueProperties).length===0){return true}var k=this._tweaker;if(this._previousFormatHTMLValueProperties.suffix!==k._suffix){return true}if(this._previousFormatHTMLValueProperties.valueIcon!==k._currentValueIcon){return true}if(this._previousFormatHTMLValueProperties.valueLabel!==k._currentValueLabel){return true}if(this._previousFormatHTMLValueProperties.stringValue!==k.getStringFromValue(j)){return true}if(JSON.stringify(this._previousFormatHTMLValueProperties.highlightModel)!==JSON.stringify(k.highlightModel)){return true}return false};f.prototype.formatHTMLValue=function(l){var t=this._tweaker;if(!t){return}if(!this._shouldFormatHTMLValue(l)){return}this._previousFormatHTMLValueProperties={highlightModel:t.highlightModel,suffix:t._suffix,valueIcon:t._currentValueIcon,valueLabel:t._currentValueLabel,stringValue:t.getStringFromValue(l)};var j=t.highlightModel;var v="wux-tweakers-tweakerbase-selectedHighlight";var u=0;if(l!==undefined&&l!==""){u++}if(t._currentValueIcon){u+=2}if(this._currentMode===1&&u!==1||this._currentMode===2&&u!==2){this._cleanContainerProperties()}if(this._label&&u!==3&&!this._options.hyperlink){this._label.destroy();this._label=undefined}if(this._icon&&u!==3){this._icon.destroy();this._icon=undefined}var o=null;if(u&1){o=this._label;if(!o){if(this._options.hyperlink){this._label=c.createElement("a");o=this._label}else{if(u===3){this._label=c.createElement("span");o=this._label}else{o=t.elements.container}}}o.classList.add("wux-tweakers-string-label");if(this._options.wrap){o.setAttributeNode(document.createAttribute("wrap"))}var x=(t._currentValueLabel===null?t.getStringFromValue(l):t._currentValueLabel);if(t._suffix){x+=" "+t._suffix}if(g.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)){if(j){for(var s=j.indexes.length-1;s>=0;s--){var r=j.indexes[s];var k=(s===j.selectedIndex)?true:false;var y=k?"<mark class='"+v+"'>":"<mark>";x=g.spliceString(x,r+j.label.length,0,"</mark>");x=g.spliceString(x,r,0,y)}}o.innerHTML=x}else{if(j){var m=x.length;x=x.toString();o.setContent();for(var s=j.indexes.length-1;s>=0;s--){var r=j.indexes[s];var k=(s===j.selectedIndex)?true:false;if(r+j.label.length<m){var n=new c.Element("span");n.textContent=x.slice(r+j.label.length,m);n.inject(o,"top");m=r+j.label.length}var w=r+j.label.length;if(r+j.label.length>m){w=m}var q=new c.Element("mark");if(k){q.addClassName(v)}q.textContent=x.slice(r,w);q.inject(o,"top");m=r}if(m!==0){var n=new c.Element("span");n.textContent=x.slice(0,m);n.inject(o,"top")}}else{if(o.getChildren().length!==0){while(o.firstChild){o.removeChild(o.firstChild)}}o.textContent=x}}if(this._options.hyperlink){o.href=l}else{if(j===undefined&&g.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)===false){o.innerHTML=a.hyperlinkifyText(o.innerHTML)}}}var p=null;if(u&2){p=this._icon;if(!p&&u===3){this._icon=c.createElement("span");p=this._icon}else{if(u===2){p=t.elements.container}}p.classList.add("wux-tweakers-icon");a.generateIcon(t._currentValueIcon,{target:p})}switch(u){case 1:if(this._options.hyperlink){this._label.inject(t.elements.container)}break;case 3:if(this._currentMode!==3){this._icon.inject(t.elements.container);this._label.inject(t.elements.container)}break;default:break}this._currentMode=u;this.updateReferenceValueLabel()};f.prototype.setValue=function(j){var k=this._tweaker;if(!k){return}this.formatHTMLValue(j)};f.prototype.setIcon=function(j){this.formatHTMLValue(this._tweaker.value)};f.prototype.usesReferenceValueLabel=function(){return true};h.prototype.baseViewModule=d;h.prototype.VIEW_MODULES={readOnly:{classObject:f}};h.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(h.prototype.VIEW_MODULES[j]!==undefined){return}h.prototype.VIEW_MODULES[j]=k};b.register(h,"DS/ControlsRec/AbstractRec");return h});define("DS/Tweakers/TweakerTreeNodeModel",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Abstract","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","UWA/Utils/Client"],function(f,o,h,g,d,a,i,m){var c=false;var e={};var b=m.Engine;function l(v,t){var s=window.getComputedStyle(t,null).getPropertyValue("font-size");var u=parseFloat(s);var r=new f.Element("span",{html:v,styles:{opacity:1,fontSize:u,padding:5}}).inject(t);var q=r.getDimensions().width;r.remove();return q}function j(q){return q.charAt(0).toUpperCase()+q.slice(1)}function p(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var q=window.getSelection();q.removeAllRanges()}}}var n=h.inherit({name:"TweakerTreeNodeModel",publishedProperties:{value:{defaultValue:null,type:"object"},height:{defaultValue:38,type:"number"},readOnly:{defaultValue:true,type:"boolean"}},_postBuildView:function(){this.elements.container.addClassName("wux-layouts-treeview-cell");this.elements.layout=new f.Element("ul",{"class":"wux-ui-stack-h",styles:{width:"inherit",height:this.height,display:"inline-block"}}).inject(this.elements.container);this.elements.linksContainer=new f.Element("li",{"class":"wux-layouts-treeview-links"}).inject(this.elements.layout);this.elements.nodeContainer=new f.Element("li",{"class":"wux-layouts-treeview-node"}).inject(this.elements.layout);this.elements.expanderContainer=new f.Element("li",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.nodeContainer);this.elements.iconsContainer=new f.Element("li",{"class":"wux-layouts-treeview-icons"}).hide().inject(this.elements.nodeContainer);this.elements.badgeTopRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"}).inject(this.elements.iconsContainer);this.elements.badgeTopLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-left"}).inject(this.elements.iconsContainer);this.elements.badgeBottomRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right"}).inject(this.elements.iconsContainer);this.elements.badgeBottomLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-left"}).inject(this.elements.iconsContainer);this.elements.labelContainer=new f.Element("li",{"class":"wux-layouts-treeview-label"}).inject(this.elements.nodeContainer);this._observeEvents();this._parent()},_applyValue:function(q){if(this.value&&this.value.options){this.setLabel(this.value.options.label);this.setIcons(this.value.options.icons);this._setExpanderState(this.value._expandState);this._setDepth(this.value._nodeDepth)}},isInEditionMode:function(){return !this.disabled&&!this.readOnly},switchToReadView:function(){this.readOnly=true},notifyModelUpdate:function(){this.value.notifyModelUpdate()},_applyReadOnly:function(q){this._parent(q);this.setLabel(this.value.options.label)},setLabel:function(s){var w=this;function q(y){y.preventDefault();y.stopPropagation();y.stopImmediatePropagation();w.elements.container.scrollLeft=0;return false}function t(y){if(w.isInEditionMode()){p();if(y.target.value!==w.value.options.label){w.value.options.label=y.target.value;w.notifyModelUpdate();w._applyProperties()}w.switchToReadView();w.fire("change")}}if(this.isInEditionMode()){var v=w.getContent().getDimensions().width;var x;var r=new f.Element("input",{type:"text",value:s,tabindex:"-1","class":"wux-tree-label-input wux-ui-state-clearable",styles:{"box-sizing":"border-box"},events:{dragstart:function(y){y.preventDefault();y.stopPropagation()},keypress:function(y){w.elements.container.scrollLeft=0},keydown:function(A){w.elements.container.scrollLeft=0;var y=(l(this.value,w.elements.labelContainer)+20);var z=v-x;if(z<0){z=0}this.style.width=Math.min(y,(v-x-0))+"px";this.style.maxWidth=z+"px"},keyup:function(z){w.elements.container.scrollLeft=0;var y=f.Event.whichKey(event);if(y==="return"){t.call(this,event);w.switchToReadView()}},change:function(y){},focusin:function(y){y.preventDefault()},focus:function(y){y.preventDefault();y.stopPropagation()},blur:function(y){t(y)},click:function(y){y.stopPropagation();if(this.offsetWidth-18<y.clientX-this.getBoundingClientRect().left){this.value=w.value.options.label;w.switchToReadView();w._lastClickTime=Date.now()}},mouseup:function(y){y.stopPropagation()},mousedown:function(y){y.stopPropagation()}}});w.elements.container.addEventListener("scroll",q,true);x=w.elements.labelContainer.getPosition().x;w.elements.container.scrollLeft=0;setTimeout(function(){if(w._cellReadWriteView){w.elements.container.scrollLeft=0;var z=w.getContent().getDimensions().width;var y=(l(r.value,w.elements.labelContainer)+20);r.style.width=y+"px";var A=r.getPosition().x;r.style.maxWidth=(z-A-0)+"px";w._cellReadWriteView.setSelectionRange(0,w._cellReadWriteView.value.length)}},1);r.setAttribute("size",r.value.length);this.elements.labelContainer.textContent="";this.elements.labelContainer.setContent(r);this._cellReadWriteView=r;r.focus()}else{w.elements.container.removeEventListener("scroll",q);if(!c){this.elements.labelContainer.setContent(s)}else{if(!this._labelReadView){console.info("new label read");this._labelReadView=f.createElement("div",{html:s,styles:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}})}this.elements.labelContainer.setContent(this._labelReadView);var v=w.getContent().getDimensions().width;var u=(l(s,w.elements.labelContainer)+20);this._labelReadView.style.width=u+"px";var x=this._labelReadView.getPosition().x;this._labelReadView.style.maxWidth=(v-x-20)+"px";w.elements.container.scrollLeft=0}}},setIcons:function(s){var t=this;var r="";var q;if(s instanceof Array){if(s&&s.length>0){q=(this._icons&&this._icons.length===s.length)&&this._icons.every(function(v,u){return v===s[u]});if(!q){this._icons=f.clone(s);if(s){s.forEach(function(v,u){r=r+t.addIcon(v)})}}}else{var q;q=(this._icons&&this._icons.length===s.length)&&this._icons.every(function(v,u){return v===s[u]});if(!q){this._icons=f.clone(s)}}}if(typeof s==="string"){r=r+t.addIcon(s,"css")}if(!q){this.elements.iconsContainer.innerHTML=r}if(r!==""){this.elements.iconsContainer.show()}},select:function(){this._lastClickTime=Date.now();this._parent()},addIcon:function(s,q){var r;switch(q){default:r='<div class="wux-layouts-treeview-icon" style="display:inline-flex;background-image:url('+s+')"></div>';break;case"css":r='<div class="wux-layouts-treeview-icon" style="display:inline-flex;" wux-icon-name="'+s+'" ></div>';break}return r},_observeEvents:function(){var r=this;this.elements.expanderContainer.addEvent(g.POINTERUP,function q(s){s.stopPropagation();if(s.which===1){var t=r.value;if(t.options.children){if(r._expandState!=="noExpandState"&&r._expandState!=="expandingState"){if(t.isExpanded()&&t._expandState!=="partiallyExpandedState"){t.collapse()}else{r._setExpanderState("expandingState");t.expand()}}}}})},handleEvents:function(){},_setExpanderState:function(q){if(q){var r={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};this.elements.expanderContainer.setAttribute("data-wux-state",r[q])}},_setDepth:function(v){var y=this.value;if(v===undefined){v=y.getParents().length}var s=20;var x=25;this.elements.container.setStyle("padding-left",s);var r="";var w,t,z,q;for(w=0;w<v;w++){q=y.getNthParent((v-1)-w);t=((q&&q.isLastChild()&&(w<=v-2)))?"transparent":"";z=((w===v-1)&&y.isLastChild())?"50%":"100%";r=r+t+z}if(e[r]===undefined){var u="";for(w=0;w<v;w++){q=y.getNthParent((v-1)-w);t=((q&&q.isLastChild()&&(w<=v-2)))?"border-color:transparent":"";z=((w===v-1)&&y.isLastChild())?"50%":"100%";u=u+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((y.getParent()&&y.getParent().isLastChild()&&w<=v-1)?"true":"false")+'" data-islastchild="'+(y.isLastChild()?"true":"false")+'" data-depth="'+(w+"/"+(v-1))+'" style="'+t+";height: "+z+";margin-right:"+((w===v-1)?0:x)+"px;margin-left:"+(w===0?x:0)+'px"></li>'}this.elements.linksContainer.innerHTML=u;e[r]=u;this.elements.linksContainer.inject(this.elements.layout,"top")}else{this.elements.linksContainer.innerHTML=e[r]}this.getContent().setAttribute("data-node-depth",v)}});var k=o.inherit({name:"TweakerTreeNodeModel",publishedProperties:{value:{defaultValue:null,type:"object"}},_postBuildView:function(){if(this.elements.container!==undefined){this.elements.internalView=new n();var q=this;this.elements.internalView.elements.labelContainer.addEventListener(g.POINTERUP,function(){var t=0;if(q.elements.internalView._lastClickTime===undefined){q.elements.internalView._lastClickTime=Date.now();var r=q.value.getTreeDocument();var s=r.getXSO().onChange(function(){delete q.elements.internalView._lastClickTime;console.log("-");r.getXSO()._modelEvents.unsubscribe(s)})}else{t=Date.now()-q.elements.internalView._lastClickTime}console.log(t,q.value.isSelected());if(t>300){q.elements.internalView.readOnly=false;q.elements.internalView._lastClickTime=undefined}});this.elements.internalView.inject(this.elements.container)}this._parent()},_applyReadOnly:function(){},handleEvents:function(){}});return k});define("DS/Tweakers/TweakerImage",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase"],function(g,d,b,f){var c=f.inherit({name:"tweakerImage",publishedProperties:{displayStyle:{defaultValue:"simple",type:"string",category:"Appearance"}}});var a=function(i,h){f.prototype.baseViewModule.call(this,i,h)};d.applyMixin(a,f.prototype.baseViewModule);var e=function(i,h){a.call(this,i,h)};d.applyMixin(e,a);e.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-image");this._view=g.createElement("img",{"class":"wux-tweakers-image-img"});this.setValue(this._tweaker.value)};e.prototype.setValue=function(h){if(!this._view){return}b.generateIcon(h,{target:this._view})};e.prototype.handleEvents=function(){};e.prototype.destroy=function(){this._tweaker.elements.container.removeClassName("wux-tweakers-image");a.prototype.destroy.call(this)};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={simple:{classObject:e},simple_readOnly:{classObject:e}};c.prototype.registerViewModule=function(h,i){return;if(!h||!i||!i.classObject&&!i.classPath){return}if(c.prototype.VIEW_MODULES[h]!==undefined){return}c.prototype.VIEW_MODULES[h]=i};return c});define("DS/Tweakers/TweakerFunction",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Button","DS/Menu/ContextualMenu","DS/Menu/Menu","DS/Utilities/Utils","UWA/Class/Promise"],function(e,k,g,f,h,i,j){var c=k.inherit({name:"tweakerFunction",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:"",type:"string"},emphasize:{defaultValue:"secondary",type:"string"},defaultModule:{defaultValue:undefined,type:"string"},defaultFunction:{defaultValue:undefined,type:"string"},displayStyle:{defaultValue:"button",type:"string",category:"Appearance"}},_applyEmphasize:function(){if(this.elements._viewModule&&this.elements._viewModule.setEmphasize){this.elements._viewModule.setEmphasize(this.emphasize)}},_applyIcon:function(){if(this.elements._viewModule&&this.elements._viewModule.setIcon){this.elements._viewModule.setIcon(this.icon)}},_applyLabel:function(){if(this.elements._viewModule&&this.elements._viewModule.setLabel){this.elements._viewModule.setLabel(this.label)}},_applyDisabled:function(l){if(this.elements._viewModule){this.elements._viewModule.setDisabled(this.disabled)}},_applyDefaultModule:function(){if(this.elements._viewModule&&this.elements._viewModule.setDefaultModule){this.elements._viewModule.setDefaultModule(this.defaultModule)}},_applyDefaultFunction:function(){if(this.elements._viewModule&&this.elements._viewModule.setDefaultFunction){this.elements._viewModule.setDefaultFunction(this.defaultFunction)}},_applyProperties:function(l){this._parent(l);if(this.isDirty("emphasize")){this._applyEmphasize(l.emphasize)}if(this.isDirty("label")){this._applyLabel(l.label)}if(this.isDirty("icon")){this._applyIcon(l.icon)}if(this.isDirty("value")){this._applyValue(l.value)}if(this.isDirty("defaultModule")){this._applyDefaultModule(l.defaultModule)}if(this.isDirty("defaultFunction")){this._applyDefaultFunction(l.defaultFunction)}}});var a=function(m,l){k.prototype.baseViewModule.call(this,m,l)};i.applyMixin(a,k.prototype.baseViewModule);a.prototype.buildView=function(m){var l=this._options.viewOptions||{};l.touchMode=this._tweaker._getCurrentTouchMode();l.label=this._tweaker.label;l.icon=this._tweaker.icon;l.emphasize=this._tweaker.emphasize;l.disabled=this._tweaker.disabled;this._view=new g(l);this._view.getContent().addClassName("wux-tweaker-function")};a.prototype.setIcon=function(l){if(!this._view){return}this._view.icon=l};a.prototype.setLabel=function(l){if(!this._view){return}this._view.label=l};a.prototype.computeTweakerContentLength=function(){if(this._view){return parseInt(window.getComputedStyle(this._view.getContent()).width)}return this._parent()};a.prototype.setDisabled=function(l){if(!this._view){return}this._view.disabled=l};a.prototype.setEmphasize=function(l){if(!this._view){return}this._view.emphasize=l};a.prototype.setValue=function(m){var n=this._tweaker;var l=this._view;if(!l||!n){return}};a.prototype.setDefaultFunction=function(l){if(!this._view){return}if(!this._view.value){this._view.value={};if(!this._view.value.action){this._view.value.action={}}}this._view.value.action.func=l};a.prototype.setDefaultModule=function(l){if(!this._view){return}if(!this._view.value){this._view.value={};if(!this._view.value.action){this._view.value.action={}}}this._view.value.action.module=l};var d=function(m,l){a.call(this,m,l)};i.applyMixin(d,a);d.prototype.buildView=function(){a.prototype.buildView.call(this);if((this._options.hasIcon)||(this._options.hasLargeIcon)){this._view.displayStyle="icon"}if(this._options.hasLargeIcon){this._tweaker.getContent().setAttributeNode(document.createAttribute("large-icon"))}};d.prototype.handleEvents=function(){var m=this,l=this._view;l.addEventListener("buttonclick",function(r){var o=function(s,u,t){require([s],function(w){if(w){var x=w[u];if(x&&typeof x==="function"){var v=t;if(!v){v={}}v.context=m._tweaker.context;x(v)}}})};if(m._tweaker.value&&typeof m._tweaker.value==="function"){m._tweaker.value({context:m._tweaker.context})}else{if(m._tweaker.value&&(m._tweaker.value.module||m._tweaker.defaultModule)){var n=(m._tweaker.value&&m._tweaker.value.module)?m._tweaker.value.module:m._tweaker.defaultModule;var q=(m._tweaker.value&&m._tweaker.value.func)?m._tweaker.value.func:m._tweaker.defaultFunction;var p=m._tweaker.value.argument;if(!p){p={}}p.context=m._tweaker.context;o(n,q,p)}}})};var b=function(m,l){a.call(this,m,l)};i.applyMixin(b,a);b.prototype.buildView=function(){a.prototype.buildView.call(this);this._view.arrowSpan=document.createElement("span");this._view.arrowSpan.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down";if((this._options.hasIcon)||(this._options.hasLargeIcon)){this._view.displayStyle="icon";this._view.arrowSpan.classList.add("arrow-icon");this._view.getContent().addClassName("arrow-icon")}else{this._view.arrowSpan.classList.add("arrow");this._view.getContent().style.paddingRight="0px"}if(this._options.hasLargeIcon){this._tweaker.getContent().setAttributeNode(document.createAttribute("large-icon"))}this.setLabel(this._tweaker.label)};b.prototype.setLabel=function(l){if(!this._view){return}this._view.label=l;this._view.getContent().appendChild(this._view.arrowSpan)};b.prototype.handleEvents=function(){var m=this,l=this._view;l.addEventListener("buttonclick",function(s){var p=function(){};var u=[];var v=function(y,A,z){var B=new j(function(D,C){require([y],function(F){if(F){var G=F[A];if(G&&typeof G==="function"){var E=z;if(!E){E={}}E.context=m._tweaker.context;G(E);D()}else{C()}}else{C()}},C)});u.push(B)};var w=function(z,C,B,A,y){var D=new j(function(F,E){require([z],function(H){if(H){var I=H[C];if(I&&typeof I==="function"){var G=B;if(!G){G={}}G.context=m._tweaker.context;A.action={callback:I.bind(null,G),argument:B,func:C,module:z};F()}else{E()}}else{E()}},E)});u.push(D)};var t=function(B,A){if(B&&B.submenu&&Array.isArray(B.submenu)&&B.submenu.length>0){var z=m._tweaker.defaultModule;var y=m._tweaker.defaultFunction;B.submenu.forEach(function(C){if(C.action&&(C.action.module||z)){var G=C.action.module?C.action.module:z;var E=C.action.func?C.action.func:y;var D=C.action.argument;var F=C.action;C.action={callback:p};w(G,E,D,C,F);if(C&&C.submenu&&Array.isArray(C.submenu)&&C.submenu.length>0){if(C.action){if(!C.action.func){C.func=m._tweaker.defaultFunction}if(!C.action.module){C.module=m._tweaker.defaultModule}}t(C,F)}}else{if(C&&C.submenu&&Array.isArray(C.submenu)&&C.submenu.length>0){t(C,F)}}})}};if(m._tweaker.value.action&&(m._tweaker.value.action.module||m._tweaker.defaultModule)){var x=(m._tweaker.value&&m._tweaker.value.module)?m._tweaker.value.module:m._tweaker.defaultModule;var r=(m._tweaker.value&&m._tweaker.value.func)?m._tweaker.value.func:m._tweaker.defaultFunction;var o=m._tweaker.value.argument;v(x,r,o)}var q=[];var n=m._view.getContent().getBoundingClientRect();if(m._tweaker.value.menu&&m._tweaker.value.menu.length>0){m._tweaker.value.menu.forEach(function(z){var C={callback:p};if(z.action&&(z.action.module||m._tweaker.defaultModule)){C=z.action;var y=(C&&z.action.module)?z.action.module:m._tweaker.defaultModule;var B=(C&&z.action.func)?z.action.func:m._tweaker.defaultFunction;var A=z.action.argument;z.action={callback:p};w(y,B,A,z,C)}t(z,C);j.all(u).then(function(){q.push(z)})["catch"](function(D){throw new Error("Issue with menu format")})});j.all(u).then(function(){h.show(q,{position:{x:n.left,y:n.top+n.height}});m._tweaker.fire("show")})["catch"](function(){throw new Error("Issue with menu format")})}})};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={button_readOnly:{classObject:d},button:{classObject:d},buttonIcon_readOnly:{classObject:d,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},buttonIcon:{classObject:d,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},menu_readOnly:{classObject:b},menu:{classObject:b},menuIcon_readOnly:{classObject:b,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},menuIcon:{classObject:b,options:{hasIcon:true,viewOptions:{showLabelFlag:false}}},buttonLargeIcon_readOnly:{classObject:d,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},buttonLargeIcon:{classObject:d,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},menuLargeIcon_readOnly:{classObject:b,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},menuLargeIcon:{classObject:b,options:{hasLargeIcon:true,viewOptions:{showLabelFlag:false}}},};c.prototype.registerViewModule=function(l,m){return;if(!l||!m||!m.classObject&&!m.classPath){return}if(c.prototype.VIEW_MODULES[l]!==undefined){return}c.prototype.VIEW_MODULES[l]=m};return c});define("DS/Controls/Toggle",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Core/PointerEvents","DS/WebRecordEnabler/Adapter"],function(g,f,d,a,b,c){var e=f.inherit({name:"toggle",markForRecordFlag:true,publishedProperties:{type:{defaultValue:"checkbox",type:"string",category:"Behavior"},checkFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},mixedState:{defaultValue:false,type:"boolean",category:"Behavior"},label:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:undefined,type:"object",noNeedToApplyFlag:true,category:"Behavior",recordFlag:true},internalLabelsFlag:{defaultValue:false,type:"boolean",category:"Appearance"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUnsafeHTMLLabel:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{"return":{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"},},commands:{validate:function(i){if(this.disabled){return{stopPropagation:false}}var j={};if((this.clickMode===1&&i.type==="keydown")||(this.clickMode===0&&i.type==="keyup")){j.actionPerformed=this.toggle();var h={ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,altKey:i.altKey};this.fire("buttonclick",h)}if(g.Event.whichKey(i)==="return"){return{stopPropagation:false,infos:j}}else{return{stopPropagation:true,infos:j}}},},buildView:function(){this.elements.container.classList.add("wux-controls-toggle");this.elements.container.setAttribute("tabindex",0);this.elements.checkSign=g.createElement("div",{"class":"wux-icon wux-ui-fa",tabindex:-1});this.elements.checkSign.inject(this.elements.container);this.isMultiSelection=false;this.preventTriggeringChangeEvent=true},_postBuildView:function(){this.preventTriggeringChangeEvent=false},handleEvents:function(){var h=this;a.addEventOnElement(this,h.elements.container,"click",function(j){if(h.clickMode===0){if(h.disabled){return}h.callMethodFromUIInteraction("toggle");var i={ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey};h.fire("buttonclick",i)}});a.addEventOnElement(this,h.elements.container,b.POINTERDOWN,function(j){if(h.clickMode===1){if(h.disabled){return}h.callMethodFromUIInteraction("toggle");var i={ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey};h.fire("buttonclick",i)}});a.addEventOnElement(this,h.elements.container,b.POINTERHIT,function(i){if(i.multipleHitCount!==2){return}i.stopPropagation();if(h.disabled){return}h.fire("buttonDblClick")});a.addEventOnElement(this,this.elements.checkSign,"focus",function(i){h.elements.container.focus()})},_applyType:function(){this.elements.checkSign.classList.remove(this._toggleIcon);this.elements.container.classList.remove("wux-controls-checkbox");this.elements.container.classList.remove("wux-controls-radio");this.elements.container.classList.remove("wux-controls-switch");this.elements.checkSign.classList.remove("wux-icon");for(var h=0;h<this.elements.checkSign.children.length;h++){this.elements.checkSign.children[h].destroy();h--}if(this.type==="switch"){this.elements.innerSwitch=g.createElement("div",{"class":"wux-controls-toggle-switch-inner"});this.elements.labelSwitch1=g.createElement("div",{"class":"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-left"});this.elements.buttonSwitch=g.createElement("div",{"class":"wux-controls-toggle-switch-button"});this.elements.labelSwitch2=g.createElement("div",{"class":"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-right"});this.elements.innerSwitch.inject(this.elements.checkSign);this.elements.labelSwitch1.inject(this.elements.innerSwitch);this.elements.buttonSwitch.inject(this.elements.innerSwitch);this.elements.labelSwitch2.inject(this.elements.innerSwitch)}if(this.type==="checkbox"){this._toggleIcon="wux-ui-fa-check";this.elements.container.classList.add("wux-controls-checkbox");this.elements.checkSign.classList.add("wux-icon")}else{if(this.type==="radio"){this._toggleIcon="wux-controls-radio-on";this.elements.container.classList.add("wux-controls-radio");this.elements.checkSign.classList.add("wux-icon")}else{if(this.type==="switch"){this._toggleIcon="wux-controls-switch-on";this.elements.container.classList.add("wux-controls-switch");this.elements.innerSwitch.classList.add("wux-controls-toggle-switch-inner")}}}this._applyCheckFlag();this._applyInternalLabelsFlag()},_applyLabel:function(){if(this.label===""&&this.elements.label){this.elements.label.destroy()}else{if(this.label!==""){if(!this.elements.label){this.elements.label=g.createElement("label",{"class":"wux-label",tabindex:-1});this.elements.label.inject(this.elements.container);var h=this;a.addEventOnElement(this,this.elements.label,"focus",function(i){h.elements.container.focus()})}if(!d.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)){this.elements.label.setText(this.label)}else{this.elements.label.setHTML(this.label)}}}},_applyAllowUnsafeHTMLLabel:function(){this._applyLabel()},_applyCheckFlag:function(){if(this.checkFlag===true){this.elements.container.setAttributeNode(document.createAttribute("checked"));if(!this.mixedState){this.elements.checkSign.classList.add(this._toggleIcon)}if(!this.multiSelFlag||!this.isMultiSelection){this._uncheckSiblings()}}else{this.elements.container.removeAttribute("checked");this.elements.checkSign.classList.remove(this._toggleIcon)}if(!this.preventTriggeringChangeEvent){this.fire("change")}},_applyDisabled:function(){this._parent();if(this.disabled===true){this.elements.container.setAttribute("tabindex",-1);this.elements.checkSign.disabled=this.disabled}else{this.elements.container.setAttribute("tabindex",0)}},_applyMixedState:function(){if(this.mixedState){this.elements.checkSign.classList.remove(this._toggleIcon);this.elements.checkSign.classList.add("wux-toggle-mixed-icon")}else{this.elements.checkSign.classList.remove("wux-toggle-mixed-icon");if(this.checkFlag){this.elements.checkSign.classList.add(this._toggleIcon)}}this.fire("change")},_applyInternalLabelsFlag:function(){if(this.internalLabelsFlag===true&&this.type==="switch"){if(this.elements.labelSwitch1&&this.elements.labelSwitch2){this.elements.labelSwitch1.setHTML("l");this.elements.labelSwitch2.setHTML("O")}}else{if(this.elements.labelSwitch1&&this.elements.labelSwitch2){this.elements.labelSwitch1.setHTML("");this.elements.labelSwitch2.setHTML("")}}},_applyProperties:function(h){this._parent(h);if(this.isDirty("type")){this._applyType()}if(this.isDirty("label")||this.isDirty("allowUnsafeHTMLLabel")){this._applyLabel()}if(this.isDirty("checkFlag")){this._applyCheckFlag()}if(this.isDirty("mixedState")){this._applyMixedState()}if(this.isDirty("internalLabelsFlag")){this._applyInternalLabelsFlag()}},_giveFocus:function(){if(this._isFocused()){return}this.elements.container.focus()},toggle:function(){if(this.type==="checkbox"||this.type==="switch"){if(this.mixedState===true){this.mixedState=false}else{this.checkFlag=!this.checkFlag}return true}else{if(this.type==="radio"){if(this.mixedState===true){this.mixedState=false;this.checkFlag=true;return true}else{if(this.checkFlag===false){this.checkFlag=true;return true}}return false}}},_uncheckSiblings:function(){if(this.type==="radio"){var k=this.elements.container.parentNode;if(k){if(k.dsModel&&k.dsModel.__proto__.name==="buttonGroup"){k.dsModel.preventTriggeringChangeEvent=true}var j=k.childNodes;for(var h=0;h<j.length;h++){if(j[h]!==this.elements.container){if(j[h].dsModel&&j[h].dsModel instanceof e&&j[h].dsModel.type==="radio"){j[h].dsModel.checkFlag=false;j[h].dsModel.mixedState=false}}}if(k.dsModel&&k.dsModel.__proto__.name==="buttonGroup"){k.dsModel.preventTriggeringChangeEvent=false}}}}});c.register(e,"DS/ControlsRec/AbstractRec");return e});define("DS/Tweakers/TweakerBoolean",["UWA/Core","DS/Tweakers/TweakerBase","DS/Controls/Toggle","DS/Utilities/Dom","DS/Utilities/Utils"],function(b,h,f,d,e){var i=h.inherit({name:"TweakerBoolean",publishedProperties:{value:{defaultValue:false,type:"boolean",advancedSetter:true},valueType:{defaultValue:"boolean",type:"string"},displayStyle:{defaultValue:"checkbox",type:"string"}},_upgradeValue:function(j){if(j===undefined){return j}else{if(j==="1"||j===1||j==="true"||j===true){return true}else{if(j==="0"||j===0||j==="false"||j===false){return false}else{return Boolean(j)}}}}});var a=function(k,j){h.prototype.baseViewModule.call(this,k,j)};e.applyMixin(a,h.prototype.baseViewModule);var c=function(k,j){a.call(this,k,j)};e.applyMixin(c,a);c.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.type=this._options.viewOptions.displayStyle;j.touchMode=this._tweaker._getCurrentTouchMode();j.fireOnlyFromUIInteractionFlag=true;this._view=new f(j);this.setValue(this._tweaker.value)};c.prototype.computeTweakerContentLength=function(){return this._tweaker._getCurrentTouchMode()?19:14};c.prototype.handleEvents=function(){var j=this._view;var l=this._tweaker;var k=this;j.addEventListener("change",function(m){m.stopPropagation();if(l.allowResetToUndefinedByUIFlag&&!j.checkFlag&&l.value){j.mixedState=true;k.setTweakerValue(undefined)}else{k.setTweakerValue(j.checkFlag)}})};c.prototype.setValue=function(k,j){if(!this._view){return}if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){this._view.mixedState=true;this._view.checkFlag=false}else{this._view.mixedState=false;this._view.checkFlag=this._tweaker.value}};c.prototype.setTouchMode=function(k,j){if(!this._view){return}this._view.touchMode=k};var g=function(k,j){a.call(this,k,j)};e.applyMixin(g,a);g.prototype.buildView=function(){if(!this._tweaker.elements.container){return}this._view=new b.Element("span");this.setTouchMode(this._tweaker._getCurrentTouchMode());this.setValue(this._tweaker.value)};g.prototype.setValue=function(k,j){if(!this._view){return}var l;if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){l="minus"}else{if(this._tweaker.value){l="check"}else{l="close"}}this._view.className="wux-tweakers-boolean-readonly";d.generateIcon({iconName:l,fontIconFamily:WUXManagedFontIcons.FontAwesome},{target:this._view})};g.prototype.setTouchMode=function(k,j){if(!this._view){return}if(this._tweaker.readOnly&&!(this._view instanceof f)){if(k){this._view.style.paddingLeft="14px"}else{this._view.style.paddingLeft="7px"}}else{this._view.touchMode=k}};g.prototype.computeTweakerContentLength=function(){return this._tweaker._getCurrentTouchMode()?19:14};i.prototype.baseViewModule=a;i.prototype.VIEW_MODULES={"switch":{classObject:c,options:{viewOptions:{displayStyle:"switch"}}},readOnly:{classObject:g,options:{viewOptions:{displayStyle:"switch"}}},checkbox:{classObject:c,options:{viewOptions:{displayStyle:"checkbox"}}},radio:{classObject:c,options:{viewOptions:{displayStyle:"radio"}}}};i.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(i.prototype.VIEW_MODULES[j]!==undefined){return}i.prototype.VIEW_MODULES[j]=k};return i});define("DS/Controls/ButtonGroup",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter"],function(d,f,a,j,g,m,b){function e(t){if(t.target===this.elements.container){return}t.stopPropagation();var n=t.dsModel;var r=this._getButtonList();r.forEach(function(u){u.preventTriggeringChangeEvent=true});if(n){if(l.call(this,n)){if(this.multiSelFlag){if(n.isMultiSelection===true&&this.type==="radio"){this.type="checkbox"}if(n.isMultiSelection===false&&this.type==="checkbox"){this.type="radio";var s=this._getButtonList();for(var q=0;q<s.length;q++){var p=s[q];if(n===p){p.checkFlag=true}else{p.checkFlag=false}}}}if(this.type==="radio"&&!n.isMultiSelection){if(n.checkFlag===true){this.preventTriggeringChangeEvent=true;this.value=[n.value];this.preventTriggeringChangeEvent=false}}else{if(this.type==="checkbox"||n.isMultiSelection){var o=(this.value)?this.value.slice(0):[];this.preventTriggeringChangeEvent=true;if(n.checkFlag===true){if(this.value.indexOf(n.value)===-1){o.push(n.value);this.value=o}}else{if(!n.isMultiSelection||this.value.indexOf(n.value)!==-1&&this.value.length>1){o.splice(this.value.indexOf(n.value),1);this.value=o}else{if(n.isMultiSelection&&this.value.indexOf(n.value)!==-1&&this.value.length===1){n.checkFlag=true}}}this.preventTriggeringChangeEvent=false}}}}r=this._getButtonList();r.forEach(function(u){u.preventTriggeringChangeEvent=false});if(!this.preventTriggeringChangeEvent){this.fire("change")}}var i=f.inherit({name:"buttonGroup",markForRecordFlag:true,publishedProperties:{value:{defaultValue:undefined,type:"array",category:"Behavior",recordFlag:true},type:{defaultValue:"radio",type:"string",category:"Behavior"},minButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},_preBuildView:function(){this.elements.container=d.Element("div",{"class":"wux-controls-buttongroup"});this._parent()},buildView:function(){this._bindedButtonChangeCB=e.bind(this)},_applyRecId:function(n){if(this.recId!==null&&this.recId!==undefined){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].redId=this.recId+p[o].value}}else{if(n!==null&&n!==undefined){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].redId=null}}}},_applyMultiSelFlag:function(n){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].multiSelFlag=this.multiSelFlag}if(this.multiSelFlag===false&&n===true){this.type="radio";for(var o=0;o<p.length;o++){var q=p[o];q.type="radio";q.checkFlag=false}}},_applyType:function(n){var p=this._getButtonList();if(this.type==="radio"){for(var o=0;o<p.length;o++){p[o].type="radio"}}else{if(this.type==="checkbox"){for(var o=0;o<p.length;o++){if(p[o] instanceof g){p[o].type="check"}else{if(p[o] instanceof j){p[o].type="checkbox"}}}}}},_updateChildPropertiesAndListeners:function(u,n){if(u.value===undefined){if(n!==undefined){u.value=n}else{var t=this.getButtonCount();u.value=t}}var r=true;while(r){r=false;var s=this._getButtonList();for(var p=0;p<s.length;p++){var o=s[p];if(o.value===u.value&&o!==u&&((u instanceof g===o instanceof g)||(u instanceof j===o instanceof j))){u.value=u.value+1;r=true;break}}}u.disabled=this.disabled;u.touchMode=this.touchMode;if(u.checkFlag){if(this.type==="radio"){this.value=[u.value];u._uncheckSiblings()}else{var q=this.value.slice();q.push(u.value);this.value=q}}a.addEventOnElement(this,u.getContent(),"change",this._bindedButtonChangeCB)},addChild:function(o,n){if(!o.recId&&this.recId!==null&&this.recId!==undefined){o.recId=this.recId+o.value}this._updateChildPropertiesAndListeners(o,n);this._addChildToUI(o,n)},_addChildToUI:function(p,n){if(n===undefined||n>=this.elements.container.childNodes.length){p.inject(this.elements.container)}else{var o=this.elements.container.getChildren()[n];p.inject(o,"before")}},moveButton:function(p,o){var n=this.getButton(p);if(n){this.preventTriggeringChangeEvent=true;this.removeChild(n);this.addChild(n,o);this.preventTriggeringChangeEvent=false}},_getButtonList:function(){var n=this.elements.container.childNodes;var p=[];for(var o=0;o<n.length;o++){var q=n[o];if(q.dsModel&&(q.dsModel instanceof g||q.dsModel instanceof j)){p.push(q.dsModel)}}return p},getButtonCount:function(){return this._getButtonList().length},getButtonIndex:function(o){var n=this._getButtonList();return n.indexOf(o)},getButton:function(n){var o=this._getButtonList();return o[n]},getButtonFromValue:function(p){for(var o=0;o<this.elements.container.childNodes.length;o++){var n=this.elements.container.childNodes[o].dsModel;if(typeof n.value!=="undefined"&&n.value!==null&&p!==null){if(n.value===p){return n}}}return undefined},removeChild:function(o){if(o){o.remove();a.removeEventOnElement(this,o.getContent(),"change",this._bindedButtonChangeCB);if(this.value&&this.value.length>0){var n=this.value.indexOf(o.value);if(n!==-1){var p=this.value.slice();p.splice(n,1);this.value=p}}}},selectIndex:function(n){var o=this.getButton(n);if(!o){return}if(this.type==="radio"){this.value=[o.value]}else{var p=this.value.slice();p.push(o.value);this.value=p}o.getContent().focus()},_isButtonValueInButtonGroup:function(q){var p=this._getButtonList();for(var o=0;o<p.length;o++){var n=p[o];if(n.value===q){return true}}return false},selectValue:function(o){if(this._isButtonValueInButtonGroup(o)){if(this.type==="radio"){this.value=[o]}else{var n=this.value.slice();n.push(o);this.value=n}}},selectNext:function(){h.call(this,false)},selectPrevious:function(){h.call(this,true)},_applyProperties:function(n){this._parent(n);if(this.isDirty("value")){this._applyValue()}if(this.value===undefined){this.value=[]}if(this.isDirty("touchMode")){this._applyTouchMode()}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag(n.multiSelFlag)}},_applyMaxWidth:function(){if(this.maxWidth!==-1){this.elements.container.setStyle("max-width",this.maxWidth+"px");this.elements.container.setStyle("overflow","hidden")}else{this.elements.container.setStyle("max-width","");this.elements.container.setStyle("overflow","")}},_applyDisabled:function(){var o=this.disabled;if(o){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}var p=this._getButtonList();for(var n=0;n<p.length;n++){p[n].disabled=o}},_applyValue:function(n){var p=this._getButtonList();p.forEach(function(r){r.preventTriggeringChangeEvent=true});var o=c.call(this,this.value);if(o.length>1&&this.multiSelFlag){this.isMultiSelection=true;p.forEach(function(r){r.isMultiSelection=true;r.checkFlag=false});o.forEach(function(r){if(r instanceof g){r.type="check"}else{if(r instanceof j){r.type="checkbox"}}r.checkFlag=true});this.isMultiSelection=false;p.forEach(function(r){r.isMultiSelection=false})}else{var q=c.call(this,n);q.forEach(function(r){r.checkFlag=false});if(o.length>0){o.forEach(function(r){r.checkFlag=true})}}p.forEach(function(r){r.preventTriggeringChangeEvent=false});if(!this.preventTriggeringChangeEvent){this.fire("change")}},_applyPreferredButtonWidth:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){if(o[n] instanceof g){o[n].preferredWidth=this.preferredButtonWidth}}},_applyMinButtonWidth:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){if(o[n] instanceof g){o[n].minWidth=this.minButtonWidth}}},_applyTouchMode:function(){var n=this._getCurrentTouchMode();if(n===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].touchMode=n}},_hasOverflow:function(){var p=this;var n=p.getContent().scrollWidth;var o=p.getContent().offsetWidth;if(n>o){return true}return false},handleEvents:function(){var n=this;a.addEventOnElement(this,this.elements.container,"keydown",function(p){if(n.disabled){return}var o=false;if(m.previous(p.keyCode)){n.callMethodFromUIInteraction("selectPrevious");o=true}if(m.next(p.keyCode)){n.callMethodFromUIInteraction("selectNext");o=true}if(m.PAGEUP==p.keyCode){n.callMethodFromUIInteraction("selectIndex",0);o=true}if(m.PAGEDOWN==p.keyCode){n.callMethodFromUIInteraction("selectIndex",n.getButtonCount()-1);o=true}if(o){p.preventDefault();p.stopPropagation()}});a.addEventOnElement(this,document,"keydown",function(q){if(q.keyCode===m.CTRL&&!n.isMultiSelection){if(n.multiSelFlag){n.isMultiSelection=true;var p=n._getButtonList();for(var o=0;o<p.length;o++){p[o].isMultiSelection=n.isMultiSelection}}}});a.addEventOnElement(this,document,"keyup",function(q){if(q.keyCode===m.CTRL&&n.isMultiSelection){if(n.multiSelFlag){n.isMultiSelection=false;var p=n._getButtonList();for(var o=0;o<p.length;o++){p[o].isMultiSelection=n.isMultiSelection}}}})},destroy:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){o[n].destroy()}o=null;this._parent()}});function k(){for(var o=0;o<this.elements.container.childNodes.length;o++){var n=this.elements.container.childNodes[o];if(n===document.activeElement){return n.dsModel}}return null}function c(n){var r=[];for(var q=0;q<this.elements.container.childNodes.length;q++){var p=this.elements.container.childNodes[q];var o=p.dsModel;if(typeof o.value!=="undefined"&&o.value!==null&&typeof n!=="undefined"&&n!==null){if(n.indexOf(o.value)!==-1){r.push(o)}}}return r}function h(o){var p=k.call(this);var q;var r=(o?"previous":"next")+"Sibling";if(p){q=p.getContent()[r];if(q){var n=q.dsModel;if(n&&n.visibleFlag&&l.call(this,n)){if(this.type==="radio"){this.value=[n.value]}}q.focus()}}}function l(n){if((n instanceof j||n instanceof g)){return true}else{return false}}return i});define("DS/Controls/AbstractEditor",["UWA/Core","DS/Controls/Abstract"],function(c,b){var a=b.inherit({name:"abstract editor",publishedProperties:{requiredFlag:{defaultValue:false,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:true},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:true,type:"boolean",readOnly:true,category:"Appearance"},selectAllOnFocus:{defaultValue:false,type:"boolean",category:"Behavior"},escapeHTML:{defaultValue:false,type:"boolean",category:"Behavior"},},blackBoxFlag:true,_postBuildView:function(){},commitCurrentEntry:function(){if(this.value!==this.valueToCommit){this.value=this.valueToCommit;return true}return undefined},_applyDisabled:function(){this._parent();if(this.disabled){this._myInput.setAttributeNode(document.createAttribute("disabled"))}else{this._myInput.removeAttribute("disabled")}},_applyRequiredFlag:function(){this._realApplyRequiredFlag();this._updateValidFlag()},_applyPlaceholder:function(){if(this.placeholder){this._myInput.setAttribute("placeholder",this.placeholder)}else{this._myInput.removeAttribute("placeholder")}},_applyValue:function(d,e){if(typeof e==="undefined"||e===null){this._myInput.value=""}else{this._myInput.value=e;this._applyEscapeHTML();this._myInput.value=this.escapeHTML?c.String.unescapeHTML(this.value):this.value}this.valueToCommit=this.value;this.fire("change");this._updateValidFlag()},_applyValueToCommit:function(d){this.fire("uncommittedChange");this._updateValidFlag()},_applyEscapeHTML:function(d){if(this._myInput.value){if(this.escapeHTML){this._properties.value.value=c.String.escapeHTML(this._myInput.value)}else{if(d===true){this._properties.value.value=c.String.unescapeHTML(this._myInput.value)}}}},_realApplyRequiredFlag:function(){if(this.requiredFlag===true){this._myInput.setAttributeNode(document.createAttribute("required"))}else{this._myInput.removeAttribute("required")}},_updateValidFlag:function(){if(this._myInput&&this._myInput.validity){var d=this._myInput.validity.valid;if(d===this._properties.validFlag.value){return}this._properties.validFlag.value=d;this.fire("validFlagChange")}},_giveFocus:function(){if(this._isFocused()){return}this._parent();if(document.activeElement!==this._myInput){this._myInput.focus()}if(!this.disabled&&this.selectAllOnFocus){this._myInput.setSelectionRange(0,0);this._myInput.select()}this.fire("focus")},destroy:function(){this._parent();this._myInput=null}});return a});define("DS/Controls/LineEditor",["UWA/Core","DS/Controls/AbstractEditor","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Controls/assets/nls/translation"],function(d,e,f,i,b,a,h,j){var c=e.inherit({name:"lineEditor",markForRecordFlag:true,publishedProperties:{pattern:{defaultValue:"",type:"string",category:"Behavior"},sizeInCharNumber:{defaultValue:-1,type:"integer",category:"Appearance"},displayStyle:{defaultValue:"text",type:"string",category:"Appearance"},autoCommitFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true,category:"Behavior"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:true,advancedSetter:true},autoCorrectFlag:{defaultValue:true,type:"boolean",category:"Behavior"},displayClearFieldButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},keymaps:{up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},"return":{keydown:"validateValue",keyup:"preventDefault"},},commands:{consume:function(){},validateValue:function(){var k=this.commitCurrentEntry();return{preventDefault:true,stopPropagation:false,infos:{actionPerformed:k}}},preventDefault:function(){return{preventDefault:true,stopPropagation:false}},preventDefaultAndConsume:function(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-lineeditor");this._myInput=new d.Element("input",{type:"text",tabindex:0,autocomplete:"off"});this._myInput.inject(this.elements.container);this._myInput.addClassName("wux-ui-state-"+this.options.type);this._validFlag=true;if(this.displayClearFieldButtonFlag){this._layoutClearFieldButton()}},handleEvents:function(){var k,m;var l=this;a.addEventOnElement(this,this._myInput,"change",function(n){n.stopPropagation()});a.addEventOnElement(this,this._myInput,"input",function(n){n.stopPropagation();if(l.autoCommitFlag){l.setPropertyFromUIInteraction("value",l._myInput.value)}else{l.setPropertyFromUIInteraction("valueToCommit",l._myInput.value)}if(l._clearFieldButton){if(l._myInput.checkValidity()){l._clearFieldButton.setAttribute("invalid","false")}else{l._clearFieldButton.setAttribute("invalid","true")}}});a.addEventOnElement(this,this._myInput,"blur",function(n){l.callMethodFromUIInteraction("commitCurrentEntry");if(l._myInput){l.fire("blur")}})},_layoutClearFieldButton:function(){var k=this;this._clearFieldButton=new d.Element("div",{"class":"wux-controls-lineeditor-clearbutton"});this._clearFieldButton.setAttribute("draggable","false");this._clearFieldButton.addClassName("wux-controls-lineeditor-clearbutton");this._clearFieldButton.tooltipInfos=new h({shortHelp:j.clearField});this._clearFieldButton.inject(this.elements.container);this._clearFieldButton.setAttribute("invalid","false");this._myInput.setAttribute("has-clearButton","false");var l="wrong";a.generateIcon(l,{target:this._clearFieldButton});this._clearFieldButton.addEventListener(f.POINTERDOWN,function(m){m.preventDefault()});a.addEventOnElement(this,this._clearFieldButton,"click",function(m){if(k.value!==""){k.value=""}else{k._applyValue()}})},_applyValueToCommit:function(k){this._parent();this._applyDisplayClearFieldButtonFlag()},_preEditValue:function(k,l){if(!this.autoCorrectFlag){return true}if(typeof l!=="undefined"&&l!==null){if(l!==k){this._myInput.value=l}}else{this._myInput.value=""}if(!this._myInput.validity.valid&&l.length>0){this._myInput.value=k;return false}else{return true}},_applyValue:function(k,l){this._applyEscapeHTML();this.valueToCommit=this.value;this.fire("change");this._updateValidFlag()},_applyPattern:function(){g.call(this);this._updateValidFlag()},_applySizeInCharNumber:function(){if(this.sizeInCharNumber>=0){this._myInput.setAttribute("size",this.sizeInCharNumber)}else{this._myInput.removeAttribute("size")}},_applyProperties:function(k){this._parent(k);this._applyPlaceholder();this._applySizeInCharNumber();this._myInput.type=(this.displayStyle==="password")?"password":"text";if(this.displayStyle==="lite"){this._myInput.addClassName("wux-controls-lineEditor-lite")}else{this._myInput.removeClassName("wux-controls-lineEditor-lite")}if(typeof this.value!=="undefined"&&this.value!==null){this._myInput.value=this.escapeHTML?d.String.unescapeHTML(this.value):this.value}else{this._myInput.value=""}this.valueToCommit=this.value;this._realApplyRequiredFlag();g.call(this);if(this.isDirty("value")){this.fire("change")}this._updateValidFlag();this._applyDisplayClearFieldButtonFlag()},_applyDisplayClearFieldButtonFlag:function(k){if(!this.displayClearFieldButtonFlag){if(this._clearFieldButton){this._clearFieldButton.style.display="none";this._myInput.setAttribute("has-clearButton","false")}}else{if(!this._clearFieldButton){this._layoutClearFieldButton()}if(this.value===""){this._clearFieldButton.style.display="none";this._myInput.setAttribute("has-clearButton","false")}else{this._clearFieldButton.style.display="";this._myInput.setAttribute("has-clearButton","true")}}}});function g(){if(this.pattern){this._myInput.setAttribute("pattern",this.pattern)}else{this._myInput.removeAttribute("pattern")}if(this._clearFieldButton){if(this._myInput.checkValidity()){this._clearFieldButton.setAttribute("invalid","false")}else{this._clearFieldButton.setAttribute("invalid","true")}}}b.register(c,"DS/ControlsRec/AbstractRec");return c});define("DS/Windows/DockingElement",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants"],function(f,h,g,i,b,k,d,l){var n=h.inherit({name:"dockingElement",markForRecordFlag:true,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:true,category:"Behavior"},dockingZoneSize:{defaultValue:100,type:"number",advancedSetter:true,recordFlag:true},minSize:{defaultValue:20,type:"number"},maxSize:{defaultValue:screen.width,type:"number"},side:{defaultValue:WUXDockAreaEnum.TopDockArea,type:"number"},interactiveDockAreaVisibleFlag:{defaultValue:false,type:"boolean"},collapsibleFlag:{defaultValue:true,type:"boolean"},collapseDockingZoneFlag:{defaultValue:false,type:"boolean",recordFlag:true},visibleDockingZoneFlag:{defaultValue:true,type:"boolean"},resizableFlag:{defaultValue:true,type:"boolean"},dockingZoneContent:{defaultValue:null,type:"object"},freeZoneContent:{defaultValue:null,type:"object"},useBordersFlag:{defaultValue:true,type:"boolean"},useBackgroundFlag:{defaultValue:false,type:"boolean"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},autoExpandFlag:{defaultValue:true,type:"boolean"}},_hideClassName:"wux-docking-element-hide-docking-zone",buildView:function(){this.elements.container.addClassName("wux-windows-docking-element");d.setElementRecordMode(this.elements.container,l.RecordModes.DEFAULT_AND_CHILD);this.elements.dockingWithCollapserContainer=new f.Element("div",{"class":"wux-windows-docking-and-collapser"});this.elements.collapser=new f.Element("div",{"class":"wux-windows-docking-element-collapser"});var o=k.Engine;if(!o.ie){this.elements.collapser.addClassName("collapser-not-IE")}this.elements.dockingZoneMask=new f.Element("div",{"class":"wux-windows-docking-element-docking-zone-mask"});this.elements.fixedArea=new f.Element("div",{"class":"wux-windows-docking-element-fixed-area"}).inject(this.elements.dockingZoneMask);this.elements.dockingZone=new f.Element("div",{"class":"wux-windows-docking-element-docking-zone"}).inject(this.elements.dockingZoneMask);this.elements.resizeHandler=new f.Element("div",{"class":"wux-windows-docking-element-resize-handler"}).inject(this.elements.dockingZoneMask);this.elements.freeZone=new f.Element("div",{"class":"wux-windows-docking-element-free-zone"});this.elements.hackResize=new f.Element("div",{"class":"wux-windows-docking-element-hack-resize"}).inject(this.elements.container);this.elements.hackResize.addClassName(this._hideClassName);this.elements.interactiveDockArea=new f.Element("div",{"class":"wux-windows-docking-element-interactive-dock-area"});this._scrollBarSize=0;this._resizerSize=14;this._collapserSize=20;this._interactiveTimeout=undefined;this._dockingSensibilityZoneSize=30;this.collapseMemory=false;this.visibleMemory=false;this._collapserTimer=null;this._expanderTimer=null;this._collapseHoverFlag=false},_postBuildView:function(){var p=this._getDockingZoneSizeFromPreferences();if(p){this.dockingZoneSize=p.size}var o=this._getCollapseDockingZoneFlagFromPreferences();if(o){this.collapseDockingZoneFlag=o.collapseDockingZoneFlag}},_applySide:function(){var o=this._getClassName();this.elements.container.addClassName(o);this.elements.collapser.addClassName(o);this.elements.dockingWithCollapserContainer.addClassName(o);this.elements.dockingZoneMask.addClassName(o);this.elements.dockingZone.addClassName(o);this.elements.resizeHandler.addClassName(o);this.elements.freeZone.addClassName(o);this.elements.interactiveDockArea.addClassName(o);if(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.TopDockArea){this.elements.dockingWithCollapserContainer.inject(this.elements.container);this.elements.collapser.inject(this.elements.dockingWithCollapserContainer);this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer);this.elements.freeZone.inject(this.elements.container)}else{this.elements.freeZone.inject(this.elements.container);this.elements.dockingWithCollapserContainer.inject(this.elements.container);this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer);this.elements.collapser.inject(this.elements.dockingWithCollapserContainer)}this.elements.interactiveDockArea.inject(this.elements.dockingZoneMask)},_preEditDockingZoneSize:function(o,p){if(typeof this.maxSize!=="undefined"&&p>this.maxSize){this.dockingZoneSize=this.maxSize;return false}else{if(typeof this.minSize!=="undefined"&&p<this.minSize){this.dockingZoneSize=this.minSize;return false}}return true},_applyDockingZoneSize:function(o){this._updateDockingZoneSize();this._scrollToBottom();if((o!==undefined)&&(this.dockingZoneSize!==o)){var q=this.getContainedWindows();for(var p=0;p<q.length;p++){q[p]._fireAndBroadcast("resize",{bubbles:false})}}},_updateContainedWindows:function(){var q=this.getContainedVisibleWindows();for(var o=0;o<q.length;o++){var p=q[o]._getTitleBarHeight();q[o]._updateContentHeight();q[o]._setTitleBarCenteredFlag(this.alignment==="center");if(q[o].isAWindowGroup()){q[o]._updateMaxTabbarWidth();q[o]._updateMinWidth()}}},_updateFromContainedWindows:function(){this._updateFitToChildState();var q=this.side;var o=24;var t=this.getContainedVisibleWindows();if(t&&t.length>0){var r=t[0]._getTitleBarHeight();for(var p=0;p<t.length;p++){var s=t[p];if(s){if((q===WUXDockAreaEnum.LeftDockArea)||(q===WUXDockAreaEnum.RightDockArea)){o=(s.minWidth>o)?s.minWidth:o}else{if((q===WUXDockAreaEnum.TopDockArea)||(q===WUXDockAreaEnum.BottomDockArea)){o=(s.minHeight+r>o)?s.minHeight+r:o}}}}}this.minSize=o;this._updateCollapserSize()},_updateFitToChildState:function(){var o=false;if(this.alignment==="center"){var q=this.getContainedVisibleWindows();if(q.length===1){o=true;var p=q[0];if(p&&(p.horizontallyStretchableFlag&&(this.side==WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea))||(p.verticallyStretchableFlag&&(this.side==WUXDockAreaEnum.LeftDockArea||this.side==WUXDockAreaEnum.RightDockArea))){o=false}}}if(o){this.elements.dockingZone.addClassName("wux-docking-element-fit-to-child")}else{this.elements.dockingZone.removeClassName("wux-docking-element-fit-to-child")}},_getClassName:function(){var o="";switch(this.side){case WUXDockAreaEnum.LeftDockArea:o="wux-docking-element-left";break;case WUXDockAreaEnum.RightDockArea:o="wux-docking-element-right";break;case WUXDockAreaEnum.TopDockArea:o="wux-docking-element-top";break;case WUXDockAreaEnum.BottomDockArea:o="wux-docking-element-bottom";break}return o},_saveDockingZoneSizeInPreferences:function(){if(this.identifier!==""){var o={size:this.dockingZoneSize};i.saveDataInLocalPreferences(this,this._getClassName(),"dockingZoneSize",o)}},_getDockingZoneSizeFromPreferences:function(){var o=undefined;if(this.identifier!==""){o=i.getDataFromLocalPreferences(this,this._getClassName(),"dockingZoneSize")}return o},_saveCollapseDockingZoneFlagInPreferences:function(){if(this.identifier!==""){var o={collapseDockingZoneFlag:this.collapseDockingZoneFlag};i.saveDataInLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag",o)}},_getCollapseDockingZoneFlagFromPreferences:function(){var o=undefined;if(this.identifier!==""){o=i.getDataFromLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag")}return o},_updateDockingZoneSize:function(){this._updateContainedWindows();var p=this.side;var r=this._hasScrollbar();if(r&&(this._scrollBarSize===0)){var t=this.getContainedVisibleWindows();if(t.length>0){var q=((p===WUXDockAreaEnum.TopDockArea)||(p===WUXDockAreaEnum.BottomDockArea))?this.elements.dockingZone.getDimensions().height:this.elements.dockingZone.getDimensions().width;var o=((p===WUXDockAreaEnum.TopDockArea)||(p===WUXDockAreaEnum.BottomDockArea))?t[0].getContent().getDimensions().height:t[0].getContent().getDimensions().width;this._scrollBarSize=parseInt(q)-o}}else{if(!r){this._scrollBarSize=0}}if((p===WUXDockAreaEnum.TopDockArea)||(p===WUXDockAreaEnum.BottomDockArea)){var s=this._getFixedAreaHeight();this.elements.dockingZone.setStyle("height",(this.dockingZoneSize+this._scrollBarSize-s)+"px");this.elements.dockingZone.setStyle("margin-top",s+"px");if(this.collapseDockingZoneFlag){this.elements.dockingZoneMask.setStyle("height","0px")}else{this.elements.dockingZoneMask.setStyle("height",this.dockingZoneSize+this._scrollBarSize+"px")}if(this.visibleDockingZoneFlag){if(this.collapseDockingZoneFlag){if(this._collapserSize!==0){this.elements.freeZone.setStyle("height","calc(100% - "+this._collapserSize+"px)")}else{this.elements.freeZone.setStyle("height","100%")}}else{this.elements.freeZone.setStyle("height","calc(100% - "+(this.dockingZoneSize+this._collapserSize+this._scrollBarSize)+"px)")}}else{this.elements.freeZone.setStyle("height","100%")}}else{if((p===WUXDockAreaEnum.LeftDockArea)||(p===WUXDockAreaEnum.RightDockArea)){this.elements.dockingZone.setStyle("width",(this.dockingZoneSize+this._scrollBarSize)+"px");if(this.collapseDockingZoneFlag){this.elements.dockingZoneMask.setStyle("width","0px");this.elements.dockingWithCollapserContainer.setStyle("width",this._collapserSize+"px")}else{this.elements.dockingZoneMask.setStyle("width",this.dockingZoneSize+this._scrollBarSize+"px");this.elements.dockingWithCollapserContainer.setStyle("width",this.dockingZoneSize+this._collapserSize+this._scrollBarSize+"px")}if(this.visibleDockingZoneFlag){if(this.collapseDockingZoneFlag){if(this._collapserSize!==0){this.elements.freeZone.setStyle("width","calc(100% - "+this._collapserSize+"px)")}else{this.elements.freeZone.setStyle("width","100%")}}else{this.elements.freeZone.setStyle("width","calc(100% - "+(this.dockingZoneSize+this._collapserSize+this._scrollBarSize)+"px)")}}else{this.elements.freeZone.setStyle("width","100%");this.elements.dockingWithCollapserContainer.setStyle("width","0px")}}}},getContainedWindows:function(){var q=this.elements.dockingZone.getChildren();var p=[];for(var o=0;o<q.length;o++){if(q[o].hasClassName("wux-windows-window")){p.push(q[o].dsModel)}}return p},getContainedVisibleWindows:function(){var q=this.elements.dockingZone.getChildren();var p=[];for(var o=0;o<q.length;o++){if(q[o].hasClassName("wux-windows-window")&&q[o].getStyle("display")!=="none"){p.push(q[o].dsModel)}}return p},_applyInteractiveDockAreaVisibleFlag:function(){if(this._interactiveTimeout){clearTimeout(this._interactiveTimeout)}if(this.interactiveDockAreaVisibleFlag){this.elements.interactiveDockArea.addClassName("wux-windows-docking-element-active-interactive")}else{this.elements.interactiveDockArea.removeClassName("wux-windows-docking-element-active-interactive")}},_applyCollapsibleFlag:function(o){this._updateCollapserSize();if(!this.collapsibleFlag){this.collapseDockingZoneFlag=false}this._updateDockingZoneSize()},_updateCollapserSize:function(){if(!this.collapsibleFlag||!this.visibleDockingZoneFlag){this._collapserSize=0;this.elements.collapser.addClassName(this._hideClassName)}else{this._collapserSize=20;this.elements.collapser.removeClassName(this._hideClassName)}},_applyCollapseDockingZoneFlag:function(o){var p=this;this.onTransitionEnd=function(){p.elements.dockingZone.removeClassName("wux-docking-anim-collapse");p.elements.dockingZoneMask.removeClassName("wux-docking-anim-collapse");p.elements.freeZone.removeClassName("wux-docking-anim-collapse");p.elements.dockingWithCollapserContainer.removeClassName("wux-docking-anim-collapse");p.elements.freeZone.removeEventListener("transitionend",p.onTransitionEnd)};if(!i.browserIsIE()){this.elements.dockingZone.addClassName("wux-docking-anim-collapse");this.elements.dockingZoneMask.addClassName("wux-docking-anim-collapse");this.elements.freeZone.addClassName("wux-docking-anim-collapse");this.elements.dockingWithCollapserContainer.addClassName("wux-docking-anim-collapse")}this.elements.freeZone.addEventListener("transitionend",p.onTransitionEnd);if(this.collapseDockingZoneFlag){this.getContent().setAttributeNode(document.createAttribute("collapsed"));this.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("collapsed"));if(this.resizableFlag){this.elements.resizeHandler.addClassName(this._hideClassName)}if(this.collapsibleFlag){this._updateDockingZoneSize();switch(this.side){case WUXDockAreaEnum.TopDockArea:if(this.elements.dockingZone.getStyle("top")===((-this.dockingZoneSize)+"px")&&this.elements.dockingZoneMask.getStyle("height")===(0+"px")){this.onTransitionEnd()}else{this.elements.dockingZone.setStyle("top",(-this.dockingZoneSize)+"px")}break;case WUXDockAreaEnum.BottomDockArea:if(this.elements.dockingZoneMask.getStyle("height")===(0+"px")){this.onTransitionEnd()}break;case WUXDockAreaEnum.LeftDockArea:if(this.elements.dockingZone.getStyle("left")===((-this.dockingZoneSize)+"px")&&this.elements.dockingZoneMask.getStyle("width")===(0+"px")){this.onTransitionEnd()}else{this.elements.dockingZone.setStyle("left",(-this.dockingZoneSize)+"px")}break;case WUXDockAreaEnum.RightDockArea:if(this.elements.dockingZoneMask.getStyle("width")===(0+"px")){this.onTransitionEnd()}break}}else{this.collapseDockingZoneFlag=false}this.fire("collapse")}else{this._updateDockingZoneSize();this.getContent().removeAttribute("collapsed");this.elements.dockingWithCollapserContainer.removeAttribute("collapsed");if(this.resizableFlag){this.elements.resizeHandler.removeClassName(this._hideClassName)}switch(this.side){case WUXDockAreaEnum.TopDockArea:if((this.elements.dockingZone.getStyle("top")===(0+"px")||this.elements.dockingZone.getStyle("top")==="")&&this.elements.dockingZoneMask.getStyle("height")!=="0px"){this.onTransitionEnd()}else{this.elements.dockingZone.setStyle("top",0+"px")}break;case WUXDockAreaEnum.BottomDockArea:if(this.elements.dockingZoneMask.getStyle("height")===this.dockingZoneSize+"px"){this.onTransitionEnd()}break;case WUXDockAreaEnum.LeftDockArea:if((this.elements.dockingZone.getStyle("left")===(0+"px")||this.elements.dockingZone.getStyle("left")==="")&&this.elements.dockingZoneMask.getStyle("width")!=="0px"){this.onTransitionEnd()}else{this.elements.dockingZone.setStyle("left",0+"px")}break;case WUXDockAreaEnum.RightDockArea:if(this.elements.dockingZoneMask.getStyle("width")===this.dockingZoneSize+"px"){this.onTransitionEnd()}break}this.fire("expand")}this._updateContentVisibleStateChange()},_updateContentVisibleStateChange:function(){var p=this.getContainedWindows();for(var o=0;o<p.length;o++){p[o]._updateContentVisibleStateChange()}},_applyVisibleDockingZoneFlag:function(){if(this.visibleDockingZoneFlag){if(this.resizableFlag===true){this.elements.resizeHandler.removeClassName(this._hideClassName)}this.elements.dockingZone.removeClassName(this._hideClassName);this.elements.dockingZoneMask.removeClassName(this._hideClassName)}else{this.elements.resizeHandler.addClassName(this._hideClassName);this.elements.dockingZone.addClassName(this._hideClassName);this.elements.dockingZoneMask.addClassName(this._hideClassName)}this._updateCollapserSize();this._updateDockingZoneSize();this._updateContentVisibleStateChange()},_applyResizableFlag:function(){var o=this;if(this.resizableFlag===false){this.elements.resizeHandler.addClassName(this._hideClassName)}else{this.elements.resizeHandler.removeClassName(this._hideClassName)}},_applyMinSize:function(){if(this.minSize!==undefined&&this.minSize!==null){if(this.minSize>this.dockingZoneSize){this.dockingZoneSize=this.minSize}if(this.maxSize!==undefined&&this.maxSize!==null&&this.minSize>this.maxSize){this.maxSize=this.minSize}}},_applyMaxSize:function(){if(this.maxSize!==undefined&&this.maxSize!==null){if(this.minSize!==undefined&&this.minSize!==null&&this.minSize>this.maxSize){this.maxSize=this.minSize;return}if(this.maxSize<this.dockingZoneSize){this.dockingZoneSize=this.maxSize}}},_applyDockingZoneContent:function(o){if(o){o.remove()}if(this.dockingZoneContent){if(f.is(this.dockingZoneContent,"element")){this.dockingZoneContent=new f.extendElement(this.dockingZoneContent)}this.dockingZoneContent.inject(this.elements.dockingZone)}},_applyFreeZoneContent:function(o){if(o){o.remove()}if(this.freeZoneContent){if(f.is(this.freeZoneContent,"element")){this.freeZoneContent=new f.extendElement(this.freeZoneContent)}this.freeZoneContent.inject(this.elements.freeZone)}},_applyUseBordersFlag:function(o){if(this.useBordersFlag){this.elements.dockingZone.addClassName("wux-docking-element-useBorders")}else{this.elements.dockingZone.removeClassName("wux-docking-element-useBorders")}},_applyUseBackgroundFlag:function(o){if(this.useBackgroundFlag){this.elements.dockingZone.addClassName("wux-docking-element-use-background")}else{this.elements.dockingZone.removeClassName("wux-docking-element-use-background")}},_applyAlignment:function(o){if(this.alignment==="center"){this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near");this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far");this.elements.dockingZoneMask.addClassName("wux-docking-element-align-center")}else{if(this.alignment==="far"){this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near");this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center");this.elements.dockingZoneMask.addClassName("wux-docking-element-align-far")}else{this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center");this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far");this.elements.dockingZoneMask.addClassName("wux-docking-element-align-near")}}this._updateContainedWindows();this._updateFitToChildState();this._updateDockingZoneSize()},_applyAutoExpandFlag:function(o){var p=this;if(!this._collapserMouseEnterFun){this._mouseMoveOnDocument=function(q){if(a(p.elements.dockingWithCollapserContainer,q.clientX,q.clientY)){if(p._collapseHoverFlag===true){clearTimeout(p._expanderTimer);p._expanderTimer=null}}else{if(!p._expanderTimer){p._expanderTimer=setTimeout(function(){b._pushUserInteractionContext();p.setPropertyFromUIInteraction("collapseDockingZoneFlag",true);p._collapseHoverFlag=false;p.collapseMemory=false;p.elements.dockingWithCollapserContainer.removeAttribute("expand-hover");b.removeEventOnElement(p,document,"mousemove",p._mouseMoveOnDocument);p._listenToMouseMove=null;b._popUserInteractionContext()},1000)}}};this._collapserMouseEnterFun=function(q){if(p.collapseDockingZoneFlag===true&&!p._collapserTimer){p._collapseHoverFlag=true;p._collapserTimer=setTimeout(function(){b._pushUserInteractionContext();p.setPropertyFromUIInteraction("collapseDockingZoneFlag",false);p.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("expand-hover"));p._collapserTimer=null;b._popUserInteractionContext()},300);if(!p._listenToMouseMove){b.addEventOnElement(p,document,"mousemove",p._mouseMoveOnDocument);p._listenToMouseMove=true}}}}if(!this._collapserMouseLeaveFun){this._collapserMouseLeaveFun=function(q){if(p._collapserTimer){clearTimeout(p._collapserTimer);p._collapserTimer=null}}}if(!this._dockingMouseEnterFun){this._dockingMouseEnterFun=function(){if(p._collapseHoverFlag===true){clearTimeout(p._expanderTimer)}}}if(this.autoExpandFlag&&!o){b.addEventOnElement(this,this.elements.collapser,"mouseenter",this._collapserMouseEnterFun);b.addEventOnElement(this,this.elements.collapser,"mouseleave",this._collapserMouseLeaveFun);b.addEventOnElement(this,this.elements.dockingWithCollapserContainer,"mouseenter",this._dockingMouseEnterFun)}else{b.removeEventOnElement(this,this.elements.collapser,"mouseenter",this._collapserMouseEnterFun);b.removeEventOnElement(this,this.elements.collapser,"mouseleave",this._collapserMouseLeaveFun);b.removeEventOnElement(this,this.elements.dockingWithCollapserContainer,"mouseenter",this._dockingMouseEnterFun)}},_applyProperties:function(o){this._parent(o);this._applySide();this._applyDockingZoneSize();this._applyInteractiveDockAreaVisibleFlag();this._applyResizableFlag();this._applyDockingZoneContent();this._applyFreeZoneContent();this._applyCollapsibleFlag();this._applyVisibleDockingZoneFlag();if(this.isDirty("useBordersFlag")){this._applyUseBordersFlag(o.useBordersFlag)}if(this.isDirty("useBackgroundFlag")){this._applyUseBackgroundFlag(o.useBackgroundFlag)}this._applyCollapseDockingZoneFlag();if(this.isDirty("alignment")){this._applyAlignment(o.alignment)}if(this.isDirty("autoExpandFlag")){this._applyAutoExpandFlag(o.autoExpandFlag)}},_getFixedArea:function(){return this.elements.fixedArea},_getFixedAreaHeight:function(){return this.elements.fixedArea?this.elements.fixedArea.offsetHeight:0},_getFixedAreaWidth:function(){return this.elements.fixedArea?this.elements.fixedArea.offsetWidth:0},handleEvents:function(){var x=this;var t=0;var r=0;var w=0;var u=0;var z={};var A=0;var o=0;var s=50;function p(D){D.preventDefault();u=D.pageY-r;var C=w;if(w+u>x.minSize){if((w+u)<j.call(x,x.maxSize,o)){C=w+u}else{C=j.call(x,x.maxSize,o)}}else{C=x.minSize}x.setPropertyFromUIInteraction("dockingZoneSize",C);if(x.immersiveFrame){x.immersiveFrame._updateAllDockingZoneSize()}x.fire("dockIsResizing")}function q(D){D.preventDefault();u=D.pageY-r;var C=w;if(w-u>x.minSize){if((w-u)<j.call(x,x.maxSize,o)){C=w-u}else{C=j.call(x,x.maxSize,o)}}else{C=x.minSize}x.setPropertyFromUIInteraction("dockingZoneSize",C);if(x.immersiveFrame){x.immersiveFrame._updateAllDockingZoneSize()}x.fire("dockIsResizing")}function y(D){D.preventDefault();u=D.pageX-t;var C=w;if(w+u>x.minSize){if((w+u)<j.call(x,x.maxSize,A)){C=w+u}else{C=j.call(x,x.maxSize,A)}}else{C=x.minSize}x.setPropertyFromUIInteraction("dockingZoneSize",C);if(x.immersiveFrame){x.immersiveFrame._updateAllDockingZoneSize()}x.fire("dockIsResizing")}function B(D){D.preventDefault();u=D.pageX-t;var C=w;if(w-u>x.minSize){if((w-u)<j.call(x,x.maxSize,A)){C=w-u}else{C=j.call(x,x.maxSize,A)}}else{C=x.minSize}x.setPropertyFromUIInteraction("dockingZoneSize",C);if(x.immersiveFrame){x.immersiveFrame._updateAllDockingZoneSize()}x.fire("dockIsResizing")}function v(E){document.body.removeAttribute("resizing");b.removeEventOnElement(x,document,g.POINTERMOVE,y);b.removeEventOnElement(x,document,g.POINTERMOVE,B);b.removeEventOnElement(x,document,g.POINTERMOVE,p);b.removeEventOnElement(x,document,g.POINTERMOVE,q);b.removeEventOnElement(x,document,g.POINTERUP,v);x.elements.hackResize.addClassName(x._hideClassName);x.elements.hackResize.setStyle("cursor","default");x.fire("dockResize");var D=x.getContainedWindows();for(var C=0;C<D.length;C++){D[C]._fireAndBroadcast("stopResize")}x._saveDockingZoneSizeInPreferences()}b.addEventOnElement(this,this.elements.resizeHandler,g.POINTERDOWN,function(G){if(x.collapseDockingZoneFlag===false&&x.resizableFlag===true){document.body.setAttributeNode(document.createAttribute("resizing"));t=G.pageX;r=G.pageY;var F="e-resize";w=x.dockingZoneSize;switch(x.side){case WUXDockAreaEnum.TopDockArea:case WUXDockAreaEnum.BottomDockArea:o=m.call(x).offsetHeight+w-s;F="s-resize";break;case WUXDockAreaEnum.LeftDockArea:case WUXDockAreaEnum.RightDockArea:A=m.call(x).offsetWidth+w-s;F="e-resize";break}x.elements.hackResize.setStyle("cursor",F);x.elements.hackResize.removeClassName(this._hideClassName);b.addEventOnElement(x,document,g.POINTERUP,v);var D="left";switch(x.side){case WUXDockAreaEnum.TopDockArea:b.addEventOnElement(x,document,g.POINTERMOVE,p);D="bottom";break;case WUXDockAreaEnum.BottomDockArea:b.addEventOnElement(x,document,g.POINTERMOVE,q);D="top";break;case WUXDockAreaEnum.LeftDockArea:b.addEventOnElement(x,document,g.POINTERMOVE,y);D="right";break;case WUXDockAreaEnum.RightDockArea:b.addEventOnElement(x,document,g.POINTERMOVE,B);D="left";break}var E=x.getContainedWindows();for(var C=0;C<E.length;C++){E[C]._fireAndBroadcast("startResize",{side:D,cursor:F});if(!x.immersiveFrame){x.immersiveFrame=E[C].immersiveFrame}}}});this._manageAutoCollapse=function(){b.removeEventOnElement(x,document,"mousemove",x._mouseMoveOnDocument);x._listenToMouseMove=null;if(x._collapseHoverFlag===false){x.setPropertyFromUIInteraction("collapseDockingZoneFlag",!x.collapseDockingZoneFlag)}x._saveCollapseDockingZoneFlagInPreferences();clearTimeout(x._collapserTimer);x._collapseHoverFlag=false;x.elements.dockingWithCollapserContainer.removeAttribute("expand-hover")};b.addEventOnElement(this,this.elements.collapser,"click",function(C){x._manageAutoCollapse()});this.elements.dockingZone.addEventListener("scroll",function(){x._resetInteractiveDockArea()});this.elements.dockingZone.addEventListener("DOMNodeRemoved",function(F){if(F.target&&F.target.hasOwnProperty("hasClassName")&&F.target.hasClassName("wux-windows-window")){var G=x.elements.dockingZone.getChildren();var E=F.target.dsModel;var C=0;for(var D=0;D<G.length;D++){if(G[D].hasClassName("wux-windows-window")&&(G[D].dsModel.getContent()!==E.getContent())&&G[D].dsModel.visibleFlag){C++}}if(C===0){x.visibleDockingZoneFlag=false}}});this.elements.dockingZone.addEventListener("DOMNodeInserted",function(D){if(D.target&&D.target.hasOwnProperty("hasClassName")&&D.target.hasClassName("wux-windows-window")){var C=D.target.dsModel;if(C&&C.visibleFlag){x.visibleDockingZoneFlag=true}}})},getSensibilityDockArea:function(){var o=this.getContent().getBoundingClientRect();switch(this.side){case WUXDockAreaEnum.TopDockArea:return{x:o.left,y:o.top-this._dockingSensibilityZoneSize,width:o.width,height:2*this._dockingSensibilityZoneSize};break;case WUXDockAreaEnum.BottomDockArea:return{x:o.left,y:o.bottom-this._dockingSensibilityZoneSize,width:o.width,height:2*this._dockingSensibilityZoneSize};break;case WUXDockAreaEnum.LeftDockArea:return{x:o.left-this._dockingSensibilityZoneSize,y:o.top,width:2*this._dockingSensibilityZoneSize,height:o.height};break;case WUXDockAreaEnum.RightDockArea:return{x:o.right-this._dockingSensibilityZoneSize,y:o.top,width:2*this._dockingSensibilityZoneSize,height:o.height};break}},_getStretchSize:function(){if(this.side===WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea){return parseInt(window.getComputedStyle(this.elements.dockingZoneMask).width)}else{return parseInt(window.getComputedStyle(this.elements.dockingZoneMask).height)}},_resetInteractiveDockArea:function(){if(this.side==WUXDockAreaEnum.LeftDockArea||this.side==WUXDockAreaEnum.RightDockArea){this.elements.interactiveDockArea.setStyle("top",0);var o=this.elements.dockingZone.scrollTop;this.elements.interactiveDockArea.setStyle("top",o)}else{if(this.side==WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea){this.elements.interactiveDockArea.setStyle("left",0);var p=this.elements.dockingZone.scrollLeft;this.elements.interactiveDockArea.setStyle("left",p)}}},_scrollToBottom:function(){if(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea){var s=this.elements.dockingZone.scrollTop;var q=0;var r=this.getContainedVisibleWindows();for(var p=0;p<r.length;p++){q=q+r[p].getContent().offsetHeight}if(this.elements.dockingZone.offsetHeight>0&&s+this.elements.dockingZone.offsetHeight>=q){var o=r[r.length-1];this.elements.dockingZone.scrollTop=q-this.elements.dockingZone.offsetHeight}}else{var u=this.elements.dockingZone.scrollLeft;var t=0;var r=this.getContainedVisibleWindows();for(var p=0;p<r.length;p++){t=t+r[p].getContent().offsetWidth}if(this.elements.dockingZone.offsetWidth>0&&u+this.elements.dockingZone.offsetWidth>=t){var o=r[r.length-1];this.elements.dockingZone.scrollLeft=t-this.elements.dockingZone.offsetWidth}}},_pointerEventsAllIfOveflowY:function(){this._pointerEventsAllIfOverflow()},_pointerEventsAllIfOverflow:function(){this.getContent().getComputedSize();if(this.elements&&this.elements.dockingZone){if(this._hasScrollbar()){this.elements.dockingZone.setStyle("pointer-events","all")}else{this.elements.dockingZone.setStyle("pointer-events","")}this._resetInteractiveDockArea()}},pointerEventsAllIfOverflow:function(){this._pointerEventsAllIfOverflow()},_hasScrollbar:function(){var s=(this.side==WUXDockAreaEnum.RightDockArea||this.side==WUXDockAreaEnum.LeftDockArea);if(!s&&typeof this.elements.dockingZone.scrollWidth==="number"){return this.elements.dockingZone.scrollWidth>this.elements.dockingZone.offsetWidth}if(s){var r=this.elements.dockingZone;var t;if(typeof r.currentStyle!=="undefined"){t=r.currentStyle.overflow}t=t||((window.getComputedStyle(r,""))?window.getComputedStyle(r,"").overflow:"");var q;if(typeof r.currentStyle!=="undefined"){q=r.currentStyle.overflowY}q=q||((window.getComputedStyle(r,""))?window.getComputedStyle(r,"").overflowY:"");var p=0;var x=this.getContainedVisibleWindows();for(var u=0;u<x.length;u++){p=p+x[u].getContent().offsetHeight}var w=(p>r.clientHeight&&r.clientHeight!==0);var o=/^(visible|auto)$/.test(t)||/^(visible|auto)$/.test(q);var v=t==="scroll"||q==="scroll";return(w&&o)||(v)}else{return false}}});var c=function(p){return(typeof HTMLElement==="object"?p instanceof HTMLElement:p&&typeof p==="object"&&p!==null&&p.nodeType===1&&typeof p.nodeName==="string")};var a=function(o,r,q){var p=o.getBoundingClientRect();if(r>=p.left&&r<=p.left+p.width&&q>=p.top&&q<=p.top+p.height){return true}return false};var m=function(){var q=this.elements.freeZone;var s=false;while(!s){var o=q.getChildren();s=true;for(var p=0;p<o.length;p++){if(o[p].hasClassName("wux-windows-docking-element")){var r=o[p].dsModel;if(r){q=r.elements.freeZone;s=false}}}}return q};var j=function(p,o){var q=(p<o)?p:o;return q};var e=function(p,o){var q=(p>o)?p:o;return q};d.register(n,"DS/ControlsRec/AbstractRec");return n});define("DS/Tweakers/TweakerRange",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase"],function(e,b,d){var c=d.inherit({name:"tweakerBase",publishedProperties:{stepValue:{defaultValue:undefined,type:"object"}},_applyStepValue:function(f){if(this.elements._viewModule&&this.elements._viewModule.setStepValue){this.elements._viewModule.setStepValue(this.stepValue)}else{if(this.elements.internalView!==undefined){this.elements.internalView.stepValue=this.stepValue}}},_applyProperties:function(f){this._parent(f);if(this.isDirty("stepValue")){this._applyStepValue(f.stepValue)}}});var a=function(g,f){d.prototype.baseViewModule.call(this,g,f)};b.applyMixin(a,d.prototype.baseViewModule);a.prototype.setStepValue=function(f){if(!this._view){return}this._view.stepValue=f};c.prototype.baseViewModule=a;c.prototype.VIEW_MODULES={};c.prototype.registerViewModule=function(f,g){return;if(!f||!g||!g.classObject&&!g.classPath){return}if(c.prototype.VIEW_MODULES[f]!==undefined){return}c.prototype.VIEW_MODULES[f]=g};return c});define("DS/Controls/SpinBox",["UWA/Core","DS/Core/Core","DS/Controls/AbstractEditor","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Units/Units","DS/Decorator/DecoratorManager","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter"],function(f,d,j,i,b,o,s,p,n,q){var g=j.inherit({name:"spinBox",markForRecordFlag:true,publishedProperties:{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:true,recordFlag:true},units:{defaultValue:"",type:"string",category:"Behavior"},minValue:{defaultValue:undefined,type:"number",category:"Behavior"},maxValue:{defaultValue:undefined,type:"number",category:"Behavior"},stepValue:{defaultValue:0.1,type:"number",category:"Behavior"},pageStepValue:{defaultValue:10,type:"number",category:"Behavior"},decimals:{defaultValue:5,type:"integer",category:"Behavior",advancedSetter:true},highExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},lowExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},useScientificNotationFlag:{defaultValue:false,type:"boolean",category:"Behavior"},useCustomValidatorFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:false,type:"boolean",category:"Behavior"},useLocaleDisplayOutsideEdition:{defaultValue:false,type:"boolean",category:"Appearance"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior"}},lastValueWhenEnter:null,valueHasBeenModified:false,editHasBegun:false,keymaps:{"return":"manageEnter",esc:{keydown:"manageEscape"},pageup:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},pagedown:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},up:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},down:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},space:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"}},commands:{consume:function(){return{stopPropagation:true}},manageEnter:function(){this.elements.inputField.focus();this.getContent().focus();var u=false;if(p.isDecoratorDisplayed()){p.hideDecorator(true,true);u=true}else{u=this._validateValue(this.elements.inputField.value)}this.lastValueWhenEnter=this.value;this._endEdit();return{stopPropagation:false,infos:{actionPerformed:u}}},manageEscape:function(){if(!this.handleEditionCancel){return{stopPropagation:false}}if(p.isDecoratorDisplayed()){p.hideDecorator(false,true)}var x;this.elements.inputField.focus();this.getContent().focus();if(this.units){var y=this.elements.inputField.value;var A=y.indexOf(" ");try{var w;if(A===-1){w=new s({unit:this.units,value:parseFloat(y)})}else{w=new s({unit:y.substr(A+1),value:parseFloat(y.substr(0,A))})}try{var z=w.to(this.units);var v=z.toString();x=parseFloat(v.substring(0,v.indexOf(" ")))}catch(B){}}catch(C){}}else{x=parseFloat(this.elements.inputField.value)}var u=false;if(x!==this.lastValueWhenEnter){this.elements.inputField.value=this.lastValueWhenEnter;this.editIsCancelled=true;this.setPropertyFromUIInteraction("value",this.lastValueWhenEnter);c.call(this);this._cancelEdit();u=true}else{if(this.lastValueWhenEnter!==this.value){this.elements.inputField.value=this.lastValueWhenEnter;this.setPropertyFromUIInteraction("value",this.lastValueWhenEnter);this._cancelEdit();u=true}}this.editIsCancelled=false;return{stopPropagation:false,infos:{actionPerformed:u}}},manageArrowsKeyDown:function(v){this.elements.inputField.focus();this.getContent().focus();if(typeof this.value==="undefined"||this.value===null){this._beginEdit();this.setPropertyFromUIInteraction("value",0)}if(parseFloat(this.elements.inputField.value)!==this.value){this._validateValue(this.elements.inputField.value)}var u;if(v.keyCode===n.ARROWUP){u=this._modifyValue(this.stepValue,true)}else{if(v.keyCode===n.ARROWDOWN){u=this._modifyValue(-this.stepValue,true)}else{if(v.keyCode===n.PAGEUP){u=this._modifyValue(this.pageStepValue,true)}else{if(v.keyCode===n.PAGEDOWN){u=this._modifyValue(-this.pageStepValue,true)}}}}return{stopPropagation:true,preventDefault:true,infos:{actionPerformed:u}}},endEdit:function(){this._endEdit()}},buildView:function(){this.elements.container.addClassName("wux-controls-spinbox");this.elements.inputField=new f.Element("input",{"class":"wux-controls-lineeditor",type:"text",tabindex:0,name:"LineEditor",autocomplete:"off"}).inject(this.elements.container);this._myInput=this.elements.inputField;if(this.displayStyle==="normal"){this._createSpinBoxButtons()}},handleEvents:function(){var u=this;o.addEventOnElement(this,this.elements.inputField,"change",function(w){w.stopPropagation();var v=this;u._validateValue(v.value);u.lastValueWhenEnter=u.value});o.addEventOnElement(this,this.elements.inputField,"mousewheel",function(w){if(!u.disabled){if(u.elements.inputField===document.activeElement||u.getContent().hasAttribute("focused")){w.preventDefault();w.stopPropagation();var x=f.Event.wheelDelta(w);var v=x>0?1:-1;u._modifyValue(v*u.stepValue,true);u._endEdit()}}});o.addEventOnElement(this,this.elements.inputField,"blur",function(v){if(!u.disabled&&(!p.isDecoratorDisplayed())){if(this.value!=u.lastValueWhenEnter){u._validateValue(this.value)}k.call(u);u._endEdit()}});o.addEventOnElement(this,this.elements.inputField,i.POINTERMOVE,function(v){if(i.isTouchEvent(v)){v.preventDefault()}});o.addEventOnElement(this,this.elements.inputField,"focus",function(v){v.preventDefault()});o.addEventOnElement(this,this.elements.inputField,i.POINTERDOWN,function(v){if(i.isTouchEvent(v)&&(p.getWidget()!==u||document.activeElement!==this)){v.preventDefault();p.showDecorator(u,this)}else{if(p.isDecoratorDisplayed()){p.hideDecorator(false,true)}}});o.addEventOnElement(this,this.elements.inputField,"input",function(v){v.stopPropagation();u._beginEdit();u.setPropertyFromUIInteraction("valueToCommit",u._myInput.value)});u._updateViewOnEventFun=function(v){u._updateView()};d.onlanguagechange(u._updateViewOnEventFun)},_beginEdit:function(){if(!this.editHasBegun){this.editHasBegun=true;this.fire("beginEdit")}},_cancelEdit:function(){if(this.editHasBegun){this.editHasBegun=false;this.fire("cancelEdit")}},_endEdit:function(){if(this.editHasBegun){this.editHasBegun=false;this.fire("endEdit")}},destroy:function(){d.offlanguagechange(this._updateViewOnEventFun);this._parent()},_modifyValue:function(y,w){var u,v;if(typeof this.value==="undefined"||this.value===null){u=0}else{u=this.value+y}var x=b.round(u,Number(Math.pow(10,-1*this.decimals).toFixed(this.decimals)));if(this._getValidatedValue(x)!==this.value){if(w){this._beginEdit()}v=this._validateValue(x)}return v},increment:function(){this._modifyValue(this.stepValue)},decrement:function(){this._modifyValue(-this.stepValue)},pageIncrement:function(){this._modifyValue(this.pageStepValue)},pageDecrement:function(){this._modifyValue(-this.pageStepValue)},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.inputField.setAttributeNode(document.createAttribute("disabled"));if(this.displayStyle==="normal"){this.elements.up.setAttributeNode(document.createAttribute("disabled"));this.elements.down.setAttributeNode(document.createAttribute("disabled"))}}else{this.elements.inputField.removeAttribute("disabled");if(this.displayStyle==="normal"){this.elements.up.removeAttribute("disabled");this.elements.down.removeAttribute("disabled")}}},_applyEscapeHTML:function(u){},_applyTouchMode:function(){this._parent();var u=this._getCurrentTouchMode();if(u===true){if(!this.elements.buttonsDivLeft){this.elements.buttonsDivLeft=new f.Element("div",{"class":"wux-controls-lineeditor-buttonsDivLeft",tabindex:-1}).inject(this.elements.buttons)}if(this.displayStyle==="normal"){this.elements.down.inject((u)?this.elements.buttonsDivLeft:this.elements.buttonsDiv);this.elements.inputField.setStyle("padding-right","52px");this.elements.inputField.setStyle("padding-left","52px")}if(this.displayStyle==="lite"){this.elements.inputField.setStyle("padding-right","13px");this.elements.inputField.setStyle("padding-left","13px")}}else{if(this.displayStyle==="normal"){this.elements.down.inject((u)?this.elements.buttonsDivLeft:this.elements.buttonsDiv);this.elements.inputField.setStyle("padding-right","22px");this.elements.inputField.setStyle("padding-left","6px")}if(this.displayStyle==="lite"){this.elements.inputField.setStyle("padding-right","6px");this.elements.inputField.setStyle("padding-left","6px")}}},_applyDisplayStyle:function(){if(this.displayStyle==="normal"){this._createSpinBoxButtons()}else{this._deleteSpinBoxButtons()}this._applyTouchMode()},_preEditDecimals:function(u,v){if(v!==null){if(v>9){this.decimals=9;return false}else{if(v<0){this.decimals=0;return false}}}return true},_applyDecimals:function(){this._updateView()},_applyUnits:function(){this._updateView()},_applyUseLocaleDisplayOutsideEdition:function(){this._updateView()},_preEditValue:function(u,w){if(typeof w!=="undefined"&&isNaN(w)){this._cancelEdit();return false}else{var v=e.call(this,w);if(v!==w){this.value=v;return false}else{if(w===u&&this.lastValueWhenEnter!==this.value){}return true}}},_applyValue:function(u){this.valueHasBeenModified=true;this._updateView();this.valueHasBeenModified=false;if(!this.editIsCancelled){this.lastValueWhenEnter=this.value;this.fire("change")}this._properties.valueToCommit.value=this.value},_applyMinValue:function(u){if(this.minValue){var v=e.call(this,this.value);if(v!==this.value){this.value=v}}},_applyMaxValue:function(u){if(this.maxValue){var v=e.call(this,this.value);if(v!==this.value){this.value=v}}},_applyHighExponentProperty:function(u){this._updateView()},_applyLowExponentProperty:function(u){this._updateView()},_applyProperties:function(u){this._parent(u);if(this.isDirty("placeholder")){this._applyPlaceholder()}if(this.isDirty("value")){this._preEditValue(u.value,this.value);this._applyValue()}if(this.isDirty("requiredFlag")){this._applyRequiredFlag(this.requiredFlag)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(this.displayStyle)}},_giveFocus:function(){if(this._isFocused()){return}this._parent();if(!i.isLastEventTouch()){this._myInput.focus()}if(!this.disabled){if(!p.isDecoratorDisplayed()){c.call(this)}if(this.selectAllOnFocus&&!p.isDecoratorDisplayed()){this.elements.inputField.setSelectionRange(0,0);this.elements.inputField.select()}}},getInputText:function(){return this.elements.inputField.value},_updateView:function(){if(this.getContent().getAttributeNode("focused")!==null){c.call(this)}else{k.call(this)}},_validateValue:function(u){this.fire("preValidateValue",{value:u});var w=false;if(!this.useCustomValidatorFlag){var v=this._getValidatedValue(u);if(v!==this.value){this.setPropertyFromUIInteraction("value",v);w=true}}this._updateView();return w},_createSpinBoxButtons:function(){if(!this.elements.buttons){this.elements.buttons=new f.Element("div",{"class":"wux-controls-lineeditor-buttons",tabindex:-1});this.elements.buttonsDiv=new f.Element("div",{"class":"wux-controls-lineeditor-buttonsDivRight",tabindex:-1}).inject(this.elements.buttons);this.elements.up=new f.Element("button",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-up",tabindex:-1,name:"Button"}).inject(this.elements.buttonsDiv);this.elements.down=new f.Element("button",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down",tabindex:-1,name:"Button"}).inject(this.elements.buttonsDiv);this.elements.buttons.inject(this.elements.container);var u,x;var w,y;var v=this;o.addEventOnElement(this,this.elements.up,i.POINTERUP,function(z){z.preventDefault();z.stopPropagation();clearTimeout(y);clearInterval(w);v._endEdit()});o.addEventOnElement(this,this.elements.up,i.POINTERDOWN,function(z){z.stopPropagation();z.preventDefault();y=setTimeout(function(){w=setInterval(function(){o._pushUserInteractionContext();v._modifyValue(v.stepValue,true);o._popUserInteractionContext()},100)},100);if(!i.isTouchEvent(z)){v.elements.inputField.focus()}else{v.getContent().setAttributeNode(document.createAttribute("focused"))}if(typeof v.value==="undefined"||v.value===null){v._beginEdit();v.setPropertyFromUIInteraction("value",0)}if(parseFloat(v.elements.inputField.value)!==v.value){v._validateValue(v.elements.inputField.value)}v._modifyValue(v.stepValue,true)});o.addEventOnElement(this,this.elements.down,i.POINTERUP,function(z){clearTimeout(x);clearInterval(u);z.preventDefault();z.stopPropagation();v._endEdit()});o.addEventOnElement(this,this.elements.down,i.POINTERDOWN,function(z){z.stopPropagation();z.preventDefault();x=setTimeout(function(){u=setInterval(function(){o._pushUserInteractionContext();v._modifyValue(-v.stepValue,true);o._popUserInteractionContext()},100)},100);if(!i.isTouchEvent(z)){v.elements.inputField.focus()}else{v.getContent().setAttributeNode(document.createAttribute("focused"))}if(typeof v.value==="undefined"||v.value===null){v._beginEdit();v.setPropertyFromUIInteraction("value",0)}if(parseFloat(v.elements.inputField.value)!=v.value){v._validateValue(v.elements.inputField.value)}v._modifyValue(-v.stepValue,true)});o.addEventOnElement(this,document,i.POINTERUP,function(A){clearTimeout(x);clearInterval(u);clearTimeout(y);clearInterval(w);var z=A.clientX;var B=A.clientY;v._endEdit();if(p.isDecoratorDisplayed()&&!b.isMouseOverElement(p.getWidget().getContent(),{x:z,y:B})&&!b.isMouseOverElement(p.getDecorator().getContent(),{x:z,y:B})){p.hideDecorator(true,true)}})}else{this.elements.buttons.show()}},_deleteSpinBoxButtons:function(){this.elements.buttons.hide()},_changeValueInExpForm:function(){var u=this.lowExponentProperty;var x=this.highExponentProperty;var v=a(this.value)-1;if(v<0){v=0}var w=Math.abs(this.value);if(this.useScientificNotationFlag){return true}if(this.value!==0&&this.decimals<u&&(w<Math.pow(10,-this.decimals))){u=Math.ceil(-(Math.log(this.value)/Math.LN10))-1}if(w>=Math.pow(10,x)||(this.value!==0&&w<Math.pow(10,-u))){return true}return false},_getValidatedValue:function(w){var C=this;if(this.allowUndefinedFlag&&w===""){return undefined}w=w.replace(/\s(?=[^a-zA-Z])/,"");var z=w;var v;if(C.units){var y=w.indexOf(" ");try{if(y===-1){v=new s({unit:C.units,value:parseFloat(w)})}else{v=new s({unit:w.substr(y+1),value:parseFloat(w.substr(0,y))})}try{var x=v.to(C.units);var u=x.toString();z=parseFloat(u.substring(0,u.indexOf(" ")))}catch(B){z=v.options.value}}catch(A){z=parseFloat(u.substring(0,u.indexOf(" ")))}}else{var E=C.elements.inputField.value.indexOf("e");if(E>=1){z=parseFloat(w.replace(",","."))}else{z=parseFloat(w)}}var D=e.call(this,z);return D}});function a(v){var u=(String(v)).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!u){return 0}return Math.max(0,(u[1]?u[1].length:0)-(u[2]?Number(u[2]):0))}function m(u){return u.toLocaleString(d.currentLanguage)}function l(v){var u;if(parseInt(v)==="NaN"){return undefined}else{v=parseFloat(v);var w=v.toExponential();u=w.split("e");u[0]=parseFloat(u[0]);u[1]="e"+u[1];return u}}function t(v){if(v!==null&&v!==undefined){if(v.match(/e/)){return v.replace(/0+e/,"e").replace(/\.e|\,e/,"e")}else{if(v.match(/\.|\,/)){var u=v;if(v.match(/\./)){u=u.replace(/0+$/,"").replace(/\.$/,"")}if(v.match(/\,/)){u=u.replace(/\,$/,"")}return u}else{return v}}}}function h(u){if(u){return Boolean(u.toString().match(/\./))}}function r(u){if(u&&h(u)){return(String(u).match(/\.[0-9]+|\,[0-9]+/)[0].length-1)-(String(u).match(/0+$|0+$/)?String(u).match(/0+$|0+$/)[0].length:0)}}function k(){var v=this;if(v.elements.inputField){if(typeof v.value==="undefined"||v.value===null){v.elements.inputField.value="";return}var y=l(v.value);var x="";if(v.decimals!==null){var u=v.decimals;if(v._changeValueInExpForm()){var w;if(v.useLocaleDisplayOutsideEdition){w=parseFloat(y[0].toFixed(u)).toLocaleString(d.currentLanguage,{maximumFractionDigits:u})}else{w=parseFloat(y[0].toFixed(u))}x=t(w+y[1])}else{if(v.useLocaleDisplayOutsideEdition){x=parseFloat(v.value).toLocaleString(d.currentLanguage,{maximumFractionDigits:u})}else{if(isNaN(v.value)){v.value=undefined}else{x=parseFloat(v.value.toFixed(u))}}}}else{if(v._changeValueInExpForm()){if(v.useLocaleDisplayOutsideEdition){if(h(v.value)){x=t(y[0].toLocaleString(d.currentLanguage,{maximumFractionDigits:(String(y[0]).match(/.[1-9]+|,[1-9]/)[0].length-1)})+y[1])}else{x=t(y[0].toLocaleString(d.currentLanguage)+y[1])}}else{x=t(y[0]+y[1])}}else{if(v.useLocaleDisplayOutsideEdition){if(h(v.value)){x=v.value.toLocaleString(d.currentLanguage,{maximumFractionDigits:r(v.value)})}else{x=v.value.toLocaleString(d.currentLanguage)}}else{x=v.value}}}if(v.units){x=x+" "+v.units}if(x!==undefined&&x.toString()!==v.elements.inputField.value){v.elements.inputField.value=x}}}function c(){if(this._preventUpdateOnNextFocus){this._preventUpdateOnNextFocus=false;return}var u=this;var w;if(u.elements.inputField){if(typeof u.value==="undefined"||u.value===null){u.elements.inputField.value="";return}if(u.useScientificNotationFlag){var x=l(u.value);var v=u.decimals===null?parseFloat(x[0]):parseFloat(x[0].toFixed(u.decimals));w=t(v+x[1])}else{if(u.decimals!==null){if(isNaN(u.value)){u.value=undefined}else{w=parseFloat(u.value.toFixed(u.decimals))}}else{w=u.value}}if(u.units){w=w+" "+u.units}if(w!==undefined&&w!==u.elements.inputField.value){u.elements.inputField.value=w}}}function e(u){if((this.maxValue!==undefined)&&(this.maxValue!==null)&&(u>this.maxValue)){u=this.maxValue}if((this.minValue!==undefined)&&(this.minValue!==null)&&(u<this.minValue)){u=this.minValue}return u}q.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Tweakers/TweakerVector",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerRange","DS/Controls/SpinBox"],function(g,b,e,d){var f=e.inherit({name:"TweakerVector",publishedProperties:{units:{defaultValue:"",type:"string",category:"Appearance"},definition:{defaultValue:["x","y"],type:"array",category:"Model"},value:{defaultValue:undefined,type:"array",category:"Model"},displayStyle:{defaultValue:"spinBoxes",type:"string",category:"Appearance"}},_preBuildView:function(){this._parent();this.elements.container.addClassName("wux-tweakers-vector-view")},_upgradeValue:function(l){if(b.equalsToNaN(l)){return undefined}else{if(l){var k=l;if(typeof(l)==="string"){try{k=JSON.parse(l)}catch(n){return this._parent(l)}}var h=this.definition.length;if(h===k.length){return k}else{if(h<k.length){var o=g.clone(k);o.splice(h,k.length-h);return o}else{if(h>k.length){var o=g.clone(k);var m=h-k.length;for(var j=0;j<m;j++){o.push(undefined)}return o}}}}}return this._parent(l)},compare:function(m,l){if((m===undefined)&&(l!==undefined)){return 2}else{if((m!==undefined)&&(l===undefined)){return -2}else{if((m===undefined)&&(l===undefined)){return 0}}}var k=0;for(var h=0;h<m.length;h++){k+=m[h]*m[h]}var j=0;for(var h=0;h<l.length;h++){j+=l[h]*l[h]}if(k===j){return 0}else{if(k<j){return -1}else{return 1}}},_applyUnits:function(h){if(this.elements._viewModule){this.elements._viewModule.setUnits(this.units)}},_applyDefinition:function(h){this.value=this._upgradeValue(this.value);if(this.elements._viewModule){this.elements._viewModule.setDefinition(this.definition,h)}},_applyProperties:function(h){this._parent(h);var i=!(this.isDirty("displayStyle")||this.isDirty("readOnly"));if(i&&this.isDirty("definition")){this._applyDefinition(h.definition)}if(i&&this.isDirty("units")){this._applyUnits(h.units)}}});var c=function(i,h){e.prototype.baseViewModule.call(this,i,h)};b.applyMixin(c,e.prototype.baseViewModule);c.prototype.setUnits=function(h){};c.prototype.setDefinition=function(h){};var a=function(i,h){this._labelsDiv=[];this._spinBoxes=[];c.call(this,i,h)};b.applyMixin(a,c);a.prototype.buildView=function(){this.setDefinition(this._tweaker.definition)};a.prototype.handleEvents=function(){};a.prototype.destroy=function(){this._labelsDiv.forEach(function(h){h.remove()});this._labelsDiv=[];this._spinBoxes.forEach(function(h){h.remove();h.destroy()});this._spinBoxes=[]};a.prototype.setValue=function(j){var i=j||[];this._updateFromAPI=true;var h=0;for(;h<i.length&&h<this._spinBoxes.length;h++){this._spinBoxes[h].value=i[h]}for(;h<this._spinBoxes.length;h++){this._spinBoxes[h].value=undefined}};a.prototype.setTouchMode=function(h){this._spinBoxes.forEach(function(i){i.touchMode=h})};a.prototype.setUnits=function(h){this._spinBoxes.forEach(function(i){i.units=h})};a.prototype.setDefinition=function(m,h){var t=this;var q=this._tweaker;var k=q.getContent();var o=(h?h.length:0);var j=m.length-o;if(j>0){var p=this._options.viewOptions||{};p.touchMode=q._getCurrentTouchMode();p.units=q.units;p.fireOnlyFromUIInteractionFlag=true;var l=q.value||[];for(var n=0;n<j;n++){var v=g.createElement("label",{"class":"wux-tweakers-vector-label",tabindex:-1});v.inject(k);this._labelsDiv.push(v);p.value=(o+n<l.length?l[o+n]:undefined);var r=new d(p);r.getContent().addClassName("wux-tweakers-vector-spinBox");r._indexToModify=o+n;r.addEventListener("change",function(i){i.stopPropagation();if(!q.value){q._properties.value.value=Array.apply(undefined,Array(q.definition.length))}if(q.value.length>i.dsModel._indexToModify){q.value[i.dsModel._indexToModify]=i.dsModel.value}q._applyValue()});r.addEventListener("beginEdit",function(i){i.stopPropagation();q.onPreEdit(null,"beginEdit")});r.addEventListener("uncommittedChange",function(i){i.stopPropagation()});r.addEventListener("endEdit",function(i){i.stopPropagation();q.onPostEdit(null,"endEdit")});r.inject(k);this._spinBoxes.push(r)}}else{if(j<0){j*=-1;var s=this._labelsDiv.splice(m.length,j);s.forEach(function(i){i.remove()});var u=this._spinBoxes.splice(m.length,j);u.forEach(function(i){i.remove();i.destroy()})}}this._labelsDiv.forEach(function(x,i){var w=m[i];x.textContent=w?w:""})};f.prototype.baseViewModule=c;f.prototype.VIEW_MODULES={readOnly:{classObject:a,options:{viewOptions:{disabled:true}}},spinBoxes:{classObject:a}};return f});define("DS/Controls/ViewBase",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(f,e,c,b,d){var a=e.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[],icon:"",color:null},init:function(g){this._parent(g);this._modelEvents=new d();this.elements.container=this.elements.thumbnail=new f.Element("div",{"class":"wux-controls-"+this.options.view+" wux-ui-size-"+this.options.size});this.elements.picture=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-picture"}).inject(this.elements.thumbnail);this.elements.cartouche=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-cartouche"}).inject(this.elements.thumbnail);this.elements.cartoucheContent=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-cartouche-content"}).inject(this.elements.cartouche);this.elements.color=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-color"}).inject(this.elements.cartoucheContent);this.elements.title=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-title wux-ui-size-"+this.options.size+" wux-font-3dsregular"}).inject(this.elements.cartoucheContent);this.elements.subtitle=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent);this.elements.menu=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-menu wux-ui-size-"+this.options.size}).inject(this.elements.thumbnail);this.elements.menu.addClassName("wux-ui-3ds");this.elements.menu.addClassName("wux-ui-3ds-open-down");this.elements.description=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-description"}).inject(this.elements.cartoucheContent)},_attachEvents:function(){var g=this;this.elements.container.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"containerUp",context:g})});this.elements.picture.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"pictureUp",context:g})});this.elements.title.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"titleUp",context:g})});this.elements.subtitle.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"subtitleUp",context:g})});this.elements.description.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"descriptionUp",context:g})});this.elements.cartouche.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"cartoucheUp",context:g})})},onClick:function(g){return this._modelEvents.subscribe({event:"containerUp"},g)},onCartoucheClick:function(g){return this._modelEvents.subscribe({event:"cartoucheUp"},g)},onTitleClick:function(g){return this._modelEvents.subscribe({event:"titleUp"},g)},onSubtitleClick:function(g){return this._modelEvents.subscribe({event:"subtitleUp"},g)},onDescriptionClick:function(g){return this._modelEvents.subscribe({event:"descriptionUp"},g)},onPictureClick:function(g){return this._modelEvents.subscribe({event:"pictureUp"},g)},setColor:function(g){if(g){this.elements.container.setAttribute("has-color","true");this.elements.color.setStyles({background:g}).show()}else{this.elements.container.setAttribute("has-color","false");this.elements.color.hide()}},setTitle:function(g){if(this.elements.menu&&this.elements.menu.cellView){this.elements.title.layoutDsModel=this.elements.menu.cellView.getGridEngine();var h=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(h))===false){this.elements.title.textContent=g;return}}this.elements.title.setHTML(g)},setSubtitle:function(g){if(this.elements.menu&&this.elements.menu.cellView){this.elements.subtitle.layoutDsModel=this.elements.menu.cellView.getGridEngine();var h=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(h))===false){this.elements.subtitle.textContent=g;return}}this.elements.subtitle.setHTML(g)},setPicture:function(g){this.elements.picture.setStyles({backgroundImage:"url("+g+")"})},setDescription:function(h){if(this.elements.menu&&this.elements.menu.cellView){this.elements.description.layoutDsModel=this.elements.menu.cellView.getGridEngine();var g=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(g))===false){this.elements.description.textContent=h;return}}this.elements.description.setHTML(h)}});return a});define("DS/Controls/Switch",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Segmented","DS/Utilities/UUID","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(c,i,f,h,d,j,b,e){var g="EVT_CHANGE";var a=f.extend({defaultOptions:{label:null,value:false,onChange:null,size:"mid"},init:function(k){console.warn("/!\\************************************   WEB UX TEAM    ***************************************/!\\");console.warn("/!\\*********************       MESSAGE TO THE SWITCH CONTROL USERS         *********************/!\\");console.warn("/!\\*********************         Switch control is deprecated              *********************/!\\");console.warn("/!\\*********************     Please migrate to the Toggle control asap     *********************/!\\");console.warn("/!\\*********************     Please see the Toggle API in the Showroom     *********************/!\\");console.warn("/!\\*********************************************************************************************/!\\");this._parent(k);this.options.size="mid";this._uuid=j.v4();this._modelEvents=new b();this._buildView();this.setValue(this.options.value,false);this._proxifyEvents()},_buildView:function(){this.elements.container=new c.Element("ul",{"class":"wux-ui-stack-h wux-controls-switch wux-ui-size-"+this.options.size,styles:{display:this.options.label?"block":"inline-block"}});if(this.options.label){this.elements.label=new c.Element("li",{"class":"wux-controls-switch-label",html:this.options.label}).inject(this.elements.container)}this.elements.switchContainer=new c.Element("li",{"class":"wux-controls-switch-container"}).inject(this.elements.container);this.elements.checkbox=new c.Element("input",{"class":"wux-controls-switch-checkbox",id:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer);this.elements.outer=new c.Element("label",{"class":"wux-controls-switch-outer","for":"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer);this.elements.inner=new c.Element("div",{"class":"wux-controls-switch-inner"}).inject(this.elements.outer);this.elements.button=new c.Element("div",{"class":"wux-controls-switch-button"}).inject(this.elements.outer)},_proxifyEvents:function(){var k=this;var k=this;this.elements.container.addEvent("click",function(l){l.stopPropagation();k.setValue(!k.elements.checkbox.checked)});this.elements.checkbox.addEventListener("change",function(l){l.stopPropagation()});this.elements.container.addEvent("mousedown",function(l){l.stopPropagation()});this.elements.container.addEvent("mouseup",function(l){l.stopPropagation()})},onChange:function(k){return this._modelEvents.subscribe({event:g},k)},getValue:function(){return this.elements.checkbox.checked},setValue:function(m,k){var l=this;if(k===undefined){k=true}this.elements.checkbox.checked=m;if(this.elements.checkbox.checked){this.elements.container.setAttribute("checked","true");this.elements.checkbox.setAttribute("checked","true")}else{this.elements.container.removeAttribute("checked");this.elements.checkbox.removeAttribute("checked")}if(k){if(l.options.onChange){l.options.onChange.call(l,l.getValue())}l._modelEvents.publish({context:l,event:g,data:l})}}});return a});define("DS/Controls/Expander",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Utilities/Utils"],function(c,d,a,b,h,f){function j(){if(this.elements.icon){this.elements.icon.remove(this.elements.iconPlaceholder);delete this.elements.icon}var l=a.generateIcon(this.icon);if(l){this.elements.icon=l;this.elements.iconPlaceholder.show();this.elements.icon.style.pointerEvents="none";this.elements.icon.style.margin="0px";this.elements.icon.inject(this.elements.iconPlaceholder)}else{this.elements.iconPlaceholder.hide()}}function i(){var l=2;if(this._getCurrentTouchMode()){l+=38;if(this.elements.icon){l+=14+5}}else{l+=26;if(this.elements.icon){l+=12+5}}return l}function k(){return this._getCurrentTouchMode()?38:26}var e;var g=d.inherit({name:"expander",markForRecordFlag:true,publishedProperties:{header:{defaultValue:"",type:"string",category:"Appearance"},body:{defaultValue:undefined,type:"object",category:"Behavior"},expandedFlag:{defaultValue:false,type:"boolean",category:"Appearance",recordFlag:true},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},height:{defaultValue:"auto",type:"string",category:"Appearance"},orientation:{defaultValue:"vertical",type:"string",category:"Behavior"},customHeader:{defaultValue:undefined,type:Object,category:"Behavior"},allowUnsafeHTMLHeader:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{space:{keydown:"consume",keyup:"toggle"}},commands:{consume:function(){},toggle:function(){if(!this.disabled){this.toggle()}}},_expanderClass:"wux-controls-expander",buildView:function(){this.elements.container.addClassName(this._expanderClass+"-placeholder");b.setElementRecordMode(this.elements.container,h.RecordModes.DEFAULT_AND_CHILD);this.elements.expanderContainer=new c.Element("div",{"class":this._expanderClass+"-container"}).inject(this.elements.container);this.elements.header=new c.Element("div",{"class":this._expanderClass+"-header",tabindex:0}).inject(this.elements.expanderContainer);this.elements.headerArrow=new c.Element("div",{"class":this._expanderClass+"-arrow wux-ui-3ds wux-ui-3ds-expand-down"}).inject(this.elements.header);this.elements.iconPlaceholder=new c.Element("div",{"class":"wux-expander-icon-placeholder"}).inject(this.elements.header);this.elements.headerContainer=new c.Element("div",{"class":this._expanderClass+"-header-container"}).inject(this.elements.header);this.elements.bodyContainer=new c.Element("div",{"class":this._expanderClass+"-body"}).inject(this.elements.expanderContainer)},handleEvents:function(){var m=this;var l,n;a.addEventOnElement(this,this.elements.header,"blur",function(o){m.getContent().removeClassName("wux-isMouseFocused")});a.addEventOnElement(this,this.elements.header,"click",function(o){o.preventDefault();if(m.disabled!==true){m.getContent().addClassName("wux-isMouseFocused");m.setPropertyFromUIInteraction("expandedFlag",!m.expandedFlag)}});a.addEventOnElement(this,this.elements.bodyContainer,"transitionend",function(o){m.fire("dimensionsChanged")})},_applyExpandedFlag:function(l){if(!l||l!=this.expandedFlag){(this.expandedFlag===true)?this._expand():this._close()}if(this.height==="100%"&&this.expandedFlag){this.elements.expanderContainer.setStyle("height","100%")}else{this.elements.expanderContainer.setStyle("height","")}},_applyHeader:function(){if(!f.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLHeader)){this.elements.headerContainer.innerHTML="";var l=new c.Element("h5",{"class":"headerTitle"});l.textContent=this.header;l.inject(this.elements.headerContainer)}else{this.elements.headerContainer.innerHTML='<h5 class="headerTitle" >'+this.header+" </h5> "}},_applyBody:function(l){if(this.body!==undefined&&this.elements.bodyContainer!==undefined){if(l){l.remove()}if(c.is(this.body,"element")){this.body=new c.extendElement(this.body)}this.body.inject(this.elements.bodyContainer)}},_applyTouchMode:function(){this._parent();var l=this._getCurrentTouchMode();if(l===true){this.elements.header.setAttributeNode(document.createAttribute("touch-mode"));this.elements.headerContainer.setAttributeNode(document.createAttribute("touch-mode"));this.elements.headerArrow.setAttributeNode(document.createAttribute("touch-mode"));this.elements.bodyContainer.setAttributeNode(document.createAttribute("touch-mode"));this.elements.iconPlaceholder.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.header.removeAttribute("touch-mode");this.elements.headerArrow.removeAttribute("touch-mode");this.elements.headerContainer.removeAttribute("touch-mode");this.elements.bodyContainer.removeAttribute("touch-mode");this.elements.iconPlaceholder.removeAttribute("touch-mode")}},_applyStyle:function(l){if(l){this.elements.expanderContainer.removeClassName(this._expanderClass+"-"+l)}this.elements.expanderContainer.addClassName(this._expanderClass+"-"+this.style);if(this.style==="mode-selector"){this.elements.iconPlaceholder.inject(this.elements.headerArrow,"before");this.elements.headerContainer.inject(this.elements.iconPlaceholder,"before")}},_applyOrientation:function(l){if(this.orientation==="horizontal"){this.elements.expanderContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.bodyContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.headerContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.header.setAttributeNode(document.createAttribute("horizontal"));if(this.expandedFlag){if(this.style!=="mode-selector"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")}}this.elements.bodyContainer.style.maxWidth="calc(100% - "+(20+i.call(this))+"px)";this.elements.bodyContainer.style.maxHeight=""}else{this.elements.expanderContainer.removeAttribute("horizontal");this.elements.bodyContainer.removeAttribute("horizontal");this.elements.headerContainer.removeAttribute("horizontal");this.elements.header.removeAttribute("horizontal");if(this.expandedFlag){if(this.style!=="mode-selector"){this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")}else{this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")}}this.elements.bodyContainer.style.maxWidth=""}this._applyHeight()},_applyHeight:function(l){if(this.height==="auto"&&this.orientation==="horizontal"){this.elements.container.setStyles({position:"absolute",height:"auto",top:0,bottom:0})}else{this.elements.container.setStyles({position:"",height:this.height})}if(this.orientation==="vertical"){if(this.height==="100%"){this.elements.bodyContainer.style.maxHeight="calc( 100% - "+(20+k.call(this))+"px)";this._applyExpandedFlag()}else{this.elements.bodyContainer.style.maxHeight="calc("+parseInt(this.height)+"px - "+(20+k.call(this))+"px)"}}},_applyIcon:function(l){if(typeof(this.icon)==="object"){if(!this.icon.iconClasses){this.icon.iconClasses=""}if(!this.icon.iconName){this.icon.iconName=""}if(!this.icon.fontIconFamily){this.icon.fontIconFamily=WUXManagedFontIcons.FontAwesome}if(!this.icon.fontIconSize){this.icon.fontIconSize="1x"}}j.call(this);if(this.orientation==="horizontal"){this.elements.bodyContainer.style.maxWidth="calc(100% - "+i.call(this)+"px)"}},_applyCustomHeader:function(l){if(this.elements.customHeader!=undefined&&this.elements.customHeader!=null){this.elements.customHeader.remove(l)}if(this.customHeader!=null&&this.customHeader!=undefined){if(this.elements.customHeader==undefined||this.elements.customHeader==null){this.elements.customHeader=new c.Element("div",{"class":this._expanderClass+"-customHeader"}).inject(this.elements.header)}this.customHeader.inject(this.elements.customHeader)}},_applyAllowUnsafeHTMLHeader:function(){this._applyHeader()},_applyProperties:function(l){this._parent(l);this._applyExpandedFlag();if(this.isDirty("header")||this.isDirty("allowUnsafeHTMLHeader")){this._applyHeader()}this._applyBody(l.body);this._applyStyle();this._applyIcon();this._applyOrientation();this._applyCustomHeader()},_expand:function(){this.elements.header.setAttributeNode(document.createAttribute("expanded"));this.elements.expanderContainer.addClassName(this._expanderClass+"-toggle");this.elements.bodyContainer.addClassName(this._expanderClass+"-body-toggle");if(this.style!=="mode-selector"){this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-right");if(this.orientation==="horizontal"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")}}else{this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")}this.elements.bodyContainer.style.overflow="";this.fire("expand")},_close:function(){this.elements.header.removeAttribute("expanded");this.elements.expanderContainer.removeClassName(this._expanderClass+"-toggle");this.elements.bodyContainer.removeClassName(this._expanderClass+"-body-toggle");if(this.style!=="mode-selector"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-right");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-up")}this.elements.bodyContainer.style.overflow="hidden";this.fire("collapse")},expand:function(){this.expandedFlag=true},close:function(){this.expandedFlag=false},toggle:function(){(this.expandedFlag===true)?this.close():this.expand()}});b.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Maths/Vector",["UWA/Core","UWA/Event","DS/Core/Core","UWA/Class"],function(e,b,d,c){var a=c.extend({init:function(f){this.items=f},toString:function(){if(this.items){return this.items.toString()}}});return e.namespace("WUX/Types/Maths/Vector",a)});define("DS/Maths/Vector3",["UWA/Core","UWA/Event","DS/Core/Core","DS/Maths/Vector"],function(e,c,d,b){var a=b.extend({init:function(f){if(f===undefined){f=[0,0,0]}this._parent(f);this._x=this.items[0];this._y=this.items[1];this._z=this.items[2]},toString:function(f){if(f===undefined){f=""}return this._x+f+","+this._y+f+","+this._z+f},add:function(g){var f=[];for(var h=0;h<this.items.length;h++){f.push((this.items[h]+g.items[h]))}return new a(f)},substract:function(g){var f=[];for(var h=0;h<this.items.length;h++){f.push(this.items[h]-g.items[h])}return new a(f)},multiply:function(g){var f=[];for(var h=0;h<this.items.length;h++){f.push(this.items[h]*g.items[h])}return new a(f)}});return e.namespace("WUX/Types/Maths/Vector3",a)});define("DS/Utilities/Css",["UWA/Core","DS/Maths/Vector3","DS/Utilities/Utils"],function(e,a,d){var c=["transform","-webkit-transform","top","position","bottom","left","right","width","height"];var b={disableSelection:function(f){f.addClassName("wux-ui-disable-selection")},recordState:function(k,f){if(f===undefined){f=c}var l=[];var h=e.extendElement(k);if(window.getComputedStyle){for(var j=0;j<f.length;j++){var g=getComputedStyle(k)[f[j]];g=h.getStyle(f[j]);l.push(g)}}return l},restoreState:function(j,k,f){if(f===undefined){f=c}var g=e.extendElement(j);if(g){for(var h=0;h<f.length;h++){if(k){g.setStyle(f[h],k[h])}else{g.setStyle(f[h],"")}}}},verticalAlign:function(h,g){var f=new e.Element("div",{styles:{display:"table",height:"100%",width:"100%",position:"relative",overflow:"hidden","class":g},html:{tag:"div",styles:{top:"50%",display:"table-cell",verticalAlign:"middle",width:"100%",position:"static"},html:{tag:"div",styles:{top:"50%",display:"inline-block",verticalAlign:"middle",width:"100%",position:"static"},html:h}}});return f}};return e.namespace("WUX/Utilities/Css",b)});define("DS/Utilities/Css3D",["UWA/Core","DS/Maths/Vector","DS/Maths/Vector3","UWA/Class","DS/Utilities/Utils"],function(f,b,a,c,e){var d=function(j,r,k){this.el=j;this.settings={duration:500,ease:"ease-out",x:null,y:null,rotate:null,rotateX:null,rotateY:null,rotateZ:null};this.settings=f.extend(this.settings,r);var i=false;var o="";var n=0,m=0,l=0;for(var h in this.settings){var q=this.settings[h];if(q){switch(h){case"rotate":o+=" rotate("+q+"deg)";break;case"x":n=q;break;case"y":m=q;break;case"z":l=q;break}}}var g=new a([n,m,l]);g=e.getTranslation(this.el).add(g);o+=" translate3d("+g._x+"px, "+g._y+"px, "+g._z+")";this.el.style.webkitTransition="-webkit-transform "+this.settings.duration+"ms "+this.settings.ease;this.el.style.MozTransition="-moz-transform "+this.settings.duration+"ms "+this.settings.ease;this.el.style.webkitTransform=o;this.el.style.MozTransform=o;this.el.addEventListener("webkitTransitionEnd",p,false);function p(){}};return f.namespace("WUX/Utilities/Css3D",d)});define("DS/SmartInputs/Number",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/Controls/Gauge","DS/Core/PointerEvents"],function(d,k,f,h,a,g,b,j,e){function c(m){var l=(String(m)).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!l){return 0}return Math.max(0,(l[1]?l[1].length:0)-(l[2]?Number(l[2]):0))}var i=g.extend({defaultOptions:{label:null,constraints:{minValue:null,maxValue:null,stepValue:1},value:0,graduations:2,units:"mm"},_smartInputClass:"wux-smartinputs-number",init:function(l){this._parent(l)},_buildInternalView:function(){var n=this;this.elements.sliderContainer=new d.Element("div",{"class":"wux-smartinputs-slider-container",styles:{display:this.options.label?"block":"inline-block"}});var p=this.getConstraints(0);this.elements.slider=new j({snap:0,value:this.options.value[0]||this.options.value,minValue:p.minValue,maxValue:p.maxValue,stepValue:p.stepValue,graduations:this.options.graduations,showCursorLabel:false,graduationsLabel:true,dynamicGraduations:false,dynamicGaugeColor:false}).inject(this.elements.sliderContainer);this.elements.slider.addEvent("change",function(){n.setValue(this.getValue())});if(this.options.label){this.elements.label=new d.Element("div",{"class":"wux-smartinputs-slider-container-label",html:this.options.label}).inject(this.elements.container)}this.elements.inputContainer=new d.Element("div",{"class":"wux-smartinputs-field-container"}).inject(this.elements.container);this.elements.spinnerContainer=new d.Element("div",{"class":"wux-smartinputs-spinner",styles:{marginLeft:-2}}).inject(this.elements.container);var m=this.options.value[0]||this.options.value;if(this.options.constraints){m=(this.options.constraints.maxValue?this.options.constraints.maxValue:m)+(this.options.constraints.stepValue?this.options.constraints.stepValue:1)}this.elements.inputField=new d.Element("input",{"class":"wux-smartinputs-field",type:"text",styles:{marginLeft:this.options.label?50:0,width:6*(m.toString().length+1)},events:{change:function(q){var r=parseFloat(this.value);n.setValue(r)},mousewheel:function(q){var r=d.Event.wheelDelta(event);if(r>0){n.increment()}else{n.decrement()}}}}).inject(this.elements.inputContainer);var l,o;this.elements.up=new d.Element("div",{html:"&#9652;","class":"wux-smartinputs-spinner-button","data-inc":"up",events:{mouseout:function(q){clearInterval(l)}}}).inject(this.elements.spinnerContainer);document.addEventListener(e.POINTERUP,function(q){q.stopPropagation();clearTimeout(o);clearInterval(l)});this.elements.up.addEvent(e.POINTERUP,function(q){q.stopPropagation();clearTimeout(o);clearInterval(l);n.increment()});this.elements.up.addEvent(e.POINTERDOWN,function(q){q.stopPropagation();o=setTimeout(function(){l=setInterval(function(){n.increment()},100)},100)});this.elements.down=new d.Element("div",{html:"&#9662;","class":"wux-smartinputs-spinner-button","data-inc":"down"}).inject(this.elements.spinnerContainer);this.elements.down.addEvent(e.POINTERUP,function(q){q.stopPropagation();clearInterval(l)});this.elements.down.addEvent(e.POINTERDOWN,function(q){q.stopPropagation();l=setInterval(function(){n.decrement()},100)})},increment:function(){var l=this.getConstraints(0);this.setValue(this.getValue("float")+l.stepValue)},decrement:function(){var l=this.getConstraints(0);this.setValue(this.getValue("float")-l.stepValue)},updateView:function(){if(this.elements.inputField){var l=c(this.options.constraints.stepValue);this.elements.inputField.value=this.getValue("float").toFixed(l)}if(this.elements.slider){this.elements.slider.setValue(this.getValue("float"),false)}}});return i});define("DS/UIBehaviors/DragAndDropManager",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","UWA/Class","UWA/Utils"],function(g,b,f,a,e,d){var c=e.singleton({defaultOptions:{},init:function(i,h){this.options=g.extend(this.defaultOptions,h);this._parent(h);this.subUid=-1;this._data=[];this._globalData=null},storeGlobalData:function(h){this._globalData=h},storeData:function(j,i){var h="WEBUX_DND_TOKEN|"+d.getUUID();this._data[h]={data:j,dom:i};return h},isTokenValid:function(h){return h.indexOf("WEBUX_DND_TOKEN|")!==-1},getGlobalData:function(){var h=this._globalData;return h},removeGlobalData:function(){delete this._globalData},getDataFromToken:function(h,i){if(i===undefined){i=true}if(h&&h!==""){if(this.isTokenValid(h)){if(this._data[h]&&this._data[h].data){return this._data[h].data}}else{console.warn("WebUX Drag and Drop Token is not valid. It seems you use setDataTransfer to store customData. Please be aware that, in this case, from, and infos parameters could be wrong in the drag and drop callback of this component.")}}},getDataFromDom:function(k,i){if(i===undefined){i=true}function h(m,l,n){return k===m.dom}function j(m,o,n){var l=null;m.some(function(q,p){return o.call(n,q,p,m)?((l=q),true):false});return l}return j(this._data,h,this)}});return g.namespace("UIBehaviors/DragAndDropManager",c)});define("DS/Controls/ResponsiveViewAdaptor",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(h,g,b,f,a,e,c){var d=b.inherit({name:"ResponsiveViewAdaptor",markForRecordFlag:true,publishedProperties:{picture:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Appearance"},title:{defaultValue:"",type:"string",category:"Appearance"},multipleTitleLineNumber:{defaultValue:false,type:"boolean",category:"Behavior"},subtitle:{defaultValue:"",type:"string",category:"Appearance"},description:{defaultValue:"",type:"string",category:"Appearance"},propertiesList:{defaultValue:[],type:"array",category:"Appearance"},contextualMenu:{defaultValue:[],type:"array",category:"Behavior"},onContextMenuBuildCallback:{defaultValue:undefined,type:"function",category:"Behavior"},emptyStatusbarVisibleFlag:{defaultValue:false,type:"boolean",category:"Appearance"},statusbarIcons:{defaultValue:[],type:"array",category:"Behavior"},statusbarIconsTooltips:{defaultValue:[],type:"array",category:"Behavior"},onStatusbarIconPointerDown:{defaultValue:undefined,type:"function",category:"Behavior"},activeFlag:{defaultValue:false,type:"boolean",category:"Appearance"},color:{defaultValue:"",type:"string",category:"Appearance"},customTooltip:{defaultValue:"",type:"object",category:"Appearance"},badges:{defaultValue:[],type:"array",category:"Behavior"},clickableTitle:{defaultValue:false,type:"boolean",category:"Behavior"}},_applyProperties:function(i){this.elements.container.style.display="none";this._parent(i);if(this.isDirty("statusbarIcons")){this._applyStatusbarIcons(i.statusbarIcons)}if(this.isDirty("badges")){this._applyBadges(i.badges)}if(this.isDirty("emptyStatusbarVisibleFlag")){this._applyEmptyStatusbarVisibleFlag(i.emptyStatusbarVisibleFlag)}if(this.isDirty("picture")){this._applyPicture(i.picture)}if(this.isDirty("icon")){this._applyIcon(i.icon)}if(this.isDirty("title")){this._applyTitle(i.title)}if(this.isDirty("clickableTitle")){this._applyClickableTitle(i.clickableTitle)}if(this.isDirty("multipleTitleLineNumber")){this._applyMultipleTitleLineNumber(i.multipleTitleLineNumber)}if(this.isDirty("subtitle")){this._applySubtitle(i.subtitle)}if(this.isDirty("description")){this._applyDescription(i.description)}if(this.isDirty("propertiesList")){this._applyPropertiesList(i.propertiesList)}if(this.isDirty("title")){this._applyTitle(i.title)}if(this.isDirty("contextualMenu")){this._applyContextualMenu(i.contextualMenu)}if(this.isDirty("onContextMenuBuildCallback")){this._applyOnContextMenuBuildCallback(i.onContextMenuBuildCallback)}if(this.isDirty("statusbarIconsTooltips")){this._applyStatusbarIconsTooltips(i.statusbarIconsTooltips)}if(this.isDirty("onStatusbarIconPointerDown")){this._applyOnStatusbarIconPointerDown(i.onStatusbarIconPointerDown)}if(this.isDirty("activeFlag")){this._applyActiveFlag(i.activeFlag)}if(this.isDirty("color")){this._applyColor(i.color)}if(this.isDirty("customTooltip")){this._applyCustomTooltip(i.customTooltip)}this.elements.container.style.display=""},_applyPicture:function(i){if(this.picture){this.elements.container.setAttribute("has-picture","true");if(this.elements.picture.innerText){this.elements.picture.innerText="";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else{this.elements.container.setAttribute("has-picture","false");this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}},_applyViewWidth:function(i){if(this._getViewWidth()!==i&&this._getViewWidth()>=this._getViewMinWidth()&&this._getViewWidth()<=this._getViewMaxWidth()){this.getContent().setStyle("width",this._getViewWidth().toString()+"px");this._onViewResize(this._getViewWidth())}},_applyIcon:function(i){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-"+this.name.toLowerCase()+"-icon");if(this.icon===""){this.elements.container.setAttribute("has-icon","false");this.elements.title.setAttribute("has-icon","false");this._applyTitle();return}if(this.icon){this.elements.container.setAttribute("has-icon","true");this.elements.title.setAttribute("has-icon","true");a.generateIcon(this.icon,{target:this.elements.icon});this.elements.icon.show();this._applyTitle()}},_applyTitle:function(i){this._setTitle(this.title,this.elements.container.titleLineNumber);this._onViewResize(this._getViewWidth())},_applyClickableTitle:function(i){if(this.clickableTitle){this.elements.title.addClassName("wux-controls-responsiveview-clickable-title")}else{this.elements.title.removeClassName("wux-controls-responsiveview-clickable-title")}},_setTitle:function(o,k){if(!o){this.elements.realtitle="";return}this.elements.realtitle=o;var m=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;if(k===1){this.elements.title.removeClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title");this.elements.title.layoutDsModel=this.layoutingCollection;if(h.is(o,"string")){a.setContent(this.elements.title,o,m)}else{this.elements.title.setHTML(o)}if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.customTooltip){if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:o})}else{this.elements.container.tooltipInfos.shortHelp=o}}}}else{var p=this._getTitleLineHeight();var l=o;if(this.elements.title.getAttribute("has-icon")==="true"){l="..W"+o}var i=null;if(/<\/?[^>]*>/.test(o)){i=this._createEllipsisHTML({allowUnsafeHTMLContent:m,label:l,maxWidth:"auto",lineHeight:p,nbLinesVisible:k})}else{i=a.createEllipsisText({allowUnsafeHTMLLabel:m,label:l,maxWidth:"auto",lineHeight:p,nbLinesVisible:k,})}i.style.wordBreak="break-all";if(this.elements.title.getAttribute("has-icon")==="true"){i.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title")}var j=this.elements.title.getAttribute("has-icon","true");var q=this.elements.title.getAttribute("has-menu","true");this.elements.titlebar.removeChild(this.elements.title);this.elements.title=i;this.elements.title.layoutDsModel=this.layoutingCollection;this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);i.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-title");this.elements.title.setAttribute("has-icon",j);this.elements.title.setAttribute("has-menu",q);if(this.clickableTitle){this.elements.title.addClassName("wux-controls-responsiveview-clickable-title")}this.elements.titlebar.appendChild(i);if(!this.layoutingCollection||this.layoutingCollection.displayTitleTooltip===true){if(!this.customTooltip){this.elements.container.tooltipInfos=new c({shortHelp:o})}}}var n=k*(this._getTitleLineHeight()+2);var r=n+"px";this.elements.titlebar.setStyle("height",r);this.elements.title.setStyle("height",r)},_applyMultipleTitleLineNumber:function(i){if(this.multipleTitleLineNumber===false||((this.multipleTitleLineNumber===true)&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false")){this.elements.container.titleLineNumber=(this.multipleTitleLineNumber===false)?1:2;this._onViewResize(this._getViewWidth())}},_applySubtitle:function(j){var i=this.subtitle;if(i){var k=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;this.elements.subtitle.layoutDsModel=this.layoutingCollection;a.setContent(this.elements.subtitle,i,k);this.elements.subtitle.setAttribute("has-subtitle","true")}else{this.elements.subtitle.setAttribute("has-subtitle","false")}this._onViewResize(this._getViewWidth())},_applyDescription:function(i){this._setDescription(this.description,this.elements.container.descriptionLineNumber);this._onViewResize(this._getViewWidth())},_onTitleClick:function(i){if(this.contentView&&this.contentView.layoutingCollection){var j=this.contentView.layoutingCollection.getCellInfosFromHtmlElement(this);this.contentView.layoutingCollection._onCellTitleClick(j)}},_setDescription:function(k,i){if(!k){this.elements.description.setAttribute("has-description","false");this.elements.realdescription="";this._applyPropertiesList();if(this.elements.subtitle.getAttribute("has-subtitle")!=="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")!=="false"){this.multipleTitleLineNumber=false}return}this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.realdescription=k;if(i===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}var j=this._getDescriptionLineHeight();var m=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var l=a.createEllipsisText({allowUnsafeHTMLLabel:m,label:k,maxWidth:"auto",lineHeight:j,nbLinesVisible:i});this.elements.maincontent.removeChild(this.elements.description);this.elements.description=l;this.elements.description.layoutDsModel=this.layoutingCollection;this.elements.description.setAttribute("has-description","true");l.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-description");this.elements.maincontent.appendChild(l)},_applyPropertiesList:function(k){if(!this._propertiesArray){this._propertiesArray=[]}if(!this._propertiesSpacersArray){this._propertiesSpacersArray=[]}this.elements.propertiesList.setAttribute("has-propertiesList","false");if(this.propertiesList){var o=this._propertiesArray.length;var p=this.propertiesList.length;if(p>o){for(var m=o;m<p;m++){var n=new h.Element("div",{"class":"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc"});n.setStyle("display","none");n.layoutDsModel=this.layoutingCollection;a.setContent(n,this.propertiesList[m]);n.tooltipInfos=new c({shortHelp:this.propertiesList[m]});this._propertiesArray.push(n)}}if(p>this._propertiesSpacersArray.length){for(var m=this._propertiesSpacersArray.length;m<p;m++){var j=new h.Element("div",{"class":"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc-spacer"});j.setStyle("display","none");this._propertiesSpacersArray.push(j)}}for(var m=o;m<p;m++){if((m+1)%2===0){this._propertiesArray[m].inject(this.elements.propertiesListSecondContainer);this._propertiesSpacersArray[m].inject(this.elements.propertiesListSecondContainer)}else{this._propertiesArray[m].inject(this.elements.propertiesListFirstContainer);this._propertiesSpacersArray[m].inject(this.elements.propertiesListFirstContainer)}}if(this._propertiesArray&&this._propertiesArray.length){for(var l=0;l<this.propertiesList.length;l++){this._propertiesArray[l].setStyle("display","none")}}for(var l=0;l<this.propertiesList.length;l++){this._propertiesArray[l].layoutDsModel=this.layoutingCollection;a.setContent(this._propertiesArray[l],this.propertiesList[l]);this._propertiesArray[l].tooltipInfos.shortHelp=this.propertiesList[l]}}if(this.elements.description.getAttribute("has-description")==="false"){if(this.propertiesList&&this.propertiesList.length>0){this.elements.description.setStyle("display","none");this.elements.propertiesList.setAttribute("has-propertiesList","true");if(this.elements.subtitle.getAttribute("has-subtitle")!=="false"){this.multipleTitleLineNumber=false}}else{this.elements.description.setStyle("display","block")}}else{this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.description.setStyle("display","block")}this._onViewResize(this._getViewWidth())},_applyContextualMenu:function(i){if(this.contextualMenu&&this.contextualMenu.length){this.elements.title.setAttribute("has-menu","true");this.elements.subtitle.setAttribute("has-menu","true");this.elements.maincontent.setAttribute("has-menu","true");this.elements.titlebar.setAttribute("has-menu","true");this.elements.menu.setAttribute("has-menu","true");this.elements.menu.list=this.contextualMenu}else{this.elements.title.setAttribute("has-menu","false");this.elements.subtitle.setAttribute("has-menu","false");this.elements.titlebar.setAttribute("has-menu","false");this.elements.maincontent.setAttribute("has-menu","false");this.elements.menu.setAttribute("has-menu","false")}},_applyOnContextMenuBuildCallback:function(i){if(i){this.elements.menu.removeEventListener(f.POINTERUP,i)}var j=this;a.addEventOnElement(this,this.elements.menu,f.POINTERDOWN,function(k){if(j.layoutingCollection&&!f.isTouchEvent(k)){var l=j.layoutingCollection.getCellInfosFromHtmlElement(j.getContent());if(l.cellModel&&j.layoutingCollection.modelProvider.isNodeSelected(l.cellModel)){k.stopPropagation()}}});a.addEventOnElement(this,this.elements.menu,"click",function(m){var k=j.layoutingCollection;if(f.isTouchEvent(m)){if(k){var o=this;var n=k.getCellInfosFromHtmlElement(j.getContent());if(n){var p=n.nodeModel;if(p&&!k.modelProvider.isNodeSelected(p)){k._cellUISelectionAction=true;k.modelProvider.selectNode(p,true);k._setActiveNode(p,true);k._cellUISelectionAction=false}}}}var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",true,false);l.pageX=m.pageX;l.pageY=m.pageY;l.dispatchContext="menuClick";this.dispatchEvent(l);m.stopPropagation()});e.addEventListener(j.elements.container,{callback:function(n){var k=j.layoutingCollection;if(k&&k.onContextualEvent){k._cellCtxMenuRequired=true;var m=k.getCellInfosFromHtmlElement(j.getContent());if(m){var o=m.cellModel;if(o&&!k.modelProvider.isNodeSelected(o)){k._cellUISelectionAction=true;k.modelProvider.selectNode(o,true);k.setActiveNode(o,true);k._cellUISelectionAction=false}}var l=k.onContextualEvent;return l.callback.call(l["this"],{context:j,infos:n.info,data:n.data,menu:j.contextualMenu,infoContext:n.context,cellInfos:k.getCellInfosFromHtmlElement(j.getContent())})}else{return j._setCtxMenuCB(n)}}})},_applyEmptyStatusbarVisibleFlag:function(i){if(this.emptyStatusbarVisibleFlag===true){this.elements.statusbar.setAttribute("is-empty-statusbar-visible","true");this.elements.container.setAttribute("is-empty-statusbar-visible","true")}else{if(this.emptyStatusbarVisibleFlag===false){this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false")}}},_applyStatusbarIcons:function(j){var i;this.elements.statusbar.style.display="none";if(j){for(i=0;i<j.length;i++){var m=2*i;var l=this.elements.statusbar.children[m];l.className="";a.empty(l)}}this.elements.container.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("has-statusbar-content","false");if(this.statusbarIcons){for(i=0;i<this.statusbarIcons.length;i++){var m=2*i;var k=this.statusbarIcons[i];var l=this.elements.statusbar.children[m];l.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon");if(k&&l){this.elements.container.setAttribute("has-statusbar-content","true");this.elements.statusbar.setAttribute("has-statusbar-content","true");a.generateIcon(k,{target:l});l.setStyle("font-size","14px");l.setStyle("line-height","14px")}else{a.empty(l)}}}this.elements.statusbar.style.display=""},_applyBadges:function(k){var j;var o=this.statusbarIcons?this.statusbarIcons.length:0;this.elements.statusbar.style.display="none";if(k){var i=o+k.length<=this.elements.statusbar.children.length/2?o+k.length:this.elements.statusbar.children.length/2;for(j=o;j<i;j++){var n=2*j;var m=this.elements.statusbar.children[n];m.className="";a.empty(m)}}if(!this.statusbarIcons||!this.statusbarIcons.length){this.elements.container.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("has-statusbar-content","false")}if(this.badges){var i=o+this.badges.length<=this.elements.statusbar.children.length/2?o+this.badges.length:this.elements.statusbar.children.length/2;for(j=o;j<i;j++){var n=2*j;var l=this.badges[j-o];var m=this.elements.statusbar.children[n];m.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon");if(l&&m){this.elements.container.setAttribute("has-statusbar-content","true");this.elements.statusbar.setAttribute("has-statusbar-content","true");a.generateIcon(l,{target:m});m.setStyle("font-size","14px");m.setStyle("line-height","14px")}else{a.empty(m)}}}this.elements.statusbar.style.display=""},_applyStatusbarIconsTooltips:function(j){var i;this.elements.statusbar.style.display="none";if(j){for(i=0;i<j.length;i++){var l=2*i;var k=this.elements.statusbar.children[l];k.tooltipInfos=null}}if(this.statusbarIconsTooltips){for(i=0;i<this.statusbarIconsTooltips.length;i++){var l=2*i;var m=this.statusbarIconsTooltips[i]!==undefined?this.statusbarIconsTooltips[i]:"";var k=this.elements.statusbar.children[l];if(this.layoutingCollection&&this.layoutingCollection.displayStatusbarTooltip===false){k.tooltipInfos=null}else{if(!k.tooltipInfos){k.tooltipInfos=new c({shortHelp:m})}else{k.tooltipInfos.shortHelp=m}}}}this.elements.statusbar.style.display=""},_applyOnStatusbarIconPointerDown:function(i){var j=this;if(i){this.removeEventListener("StatusbarIconPointerDown",i)}this.addEventListener("StatusbarIconPointerDown",function(m){var l=j.layoutingCollection;if(l&&l.onStatusbarIconPointerDown){var k=l.onStatusbarIconPointerDown;return k.call(j,{cellInfos:l.getCellInfosFromHtmlElement(j.getContent()),clickedIconIndex:m.options?m.options.iconIndex:-1})}else{if(j.onStatusbarIconPointerDown){return j.onStatusbarIconPointerDown.call(j,m)}}})},_applyActiveFlag:function(){if(this.activeFlag!==undefined){if(this.activeFlag===true){this.elements.container.setAttribute("active-mode","true")}else{if(this.activeFlag===false){this.elements.container.setAttribute("active-mode","false")}}}},_applyColor:function(){if(this.color&&this.color!="initial"){this.elements.color.setAttribute("has-color","true");this.elements.color.setStyles({background:this.color}).show()}else{this.elements.color.setAttribute("has-color","false")}},_applyCustomTooltip:function(i){if(this.customTooltip!==i){if(this.customTooltip||i){if(this.customTooltip){if(!this.elements.container.tooltipInfos){if(this.customTooltip instanceof c){this.elements.container.tooltipInfos=this.customTooltip}else{this.elements.container.tooltipInfos=new c({shortHelp:this.customTooltip})}}else{if(this.customTooltip instanceof c){this.elements.container.tooltipInfos=this.customTooltip}else{this.elements.container.tooltipInfos.shortHelp=this.customTooltip}}}else{if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:this.title})}else{this.elements.container.tooltipInfos.shortHelp=this.title}}}}else{if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:this.title})}else{this.elements.container.tooltipInfos.shortHelp=this.title}}}}},handleEvents:function(){var i=this;a.addEventOnElement(this,this.elements.container,"mouseenter",function(j){i.prehighlight()});a.addEventOnElement(this,this.elements.container,"mouseleave",function(j){i.unPrehighlight()});a.addEventOnElement(this,this.elements.checkbox,f.POINTERDOWN,function(j){if(i.layoutingCollection){i.layoutingCollection._enableInteractiveMultiSelMode()}})},prehighlight:function(){var i=this;if(!i.isPreHighlighted){i.elements.container.addClassName("wux-ui-state-prehighlighted");i.checkbox.addClassName("wux-ui-state-prehighlighted");i.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted");i.isPreHighlighted=true}},unPrehighlight:function(){var i=this;if(i.isPreHighlighted){i.elements.container.removeClassName("wux-ui-state-prehighlighted");i.checkbox.removeClassName("wux-ui-state-prehighlighted");i.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted");i.isPreHighlighted=false}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.addClassName("wux-ui-state-highlighted");this.elements.highlightBorder.addClassName("wux-ui-state-highlighted")},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.removeClassName("wux-ui-state-highlighted");this.elements.highlightBorder.removeClassName("wux-ui-state-highlighted")},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")},setPictureBackgroundSize:function(i){if(this.elements.picture){this.elements.picture.setStyle("background-size",i)}},onStatusbarIconPointerDown:function(i){this._modelEvents.publish({event:"StatusbarIconPointerDown",context:this,data:this})},_setCtxMenuCB:function(m){var l=[];if(this.elements.menu.list&&this.elements.menu.list.length){var k=this.elements.menu.list;if(this.onContextMenuBuildCallback){l=this.onContextMenuBuildCallback.call(this,k)}else{for(var j=0;j<k.length;j++){l.push({type:"PushItem",title:k[j],action:{callback:function(i){alert("No action implemented on this context menu entry! Please implement onContextMenuBuildCallback callback!")}}});if(j>=0&&j<k.length){l.push({type:"SeparatorItem"})}}}}return l},_onViewResize:function(z){if(!(this.elements.description.getAttribute("has-description")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="true")){this.elements.description.setStyle("display","block")}if(this.elements.propertiesList.getAttribute("has-propertiesList")==="true"){var u=0;var p=0;if(this.layoutingCollection&&this.layoutingCollection.layout){u=this.layoutingCollection.layout._columnWidth-(5+80+10+2+(this.elements.maincontent.getAttribute("has-menu")==="true"?40:10));p=(this.elements.container.getAttribute("has-icon")==="true")?16:0}else{var s=window.getComputedStyle(this.elements.maincontent);u=parseInt(s.width,10);var B=window.getComputedStyle(this.elements.icon);p=parseInt(B.width,10)}var o=Math.floor(u/175);var q=Math.floor(this._propertiesArray.length);var t=Math.min(o*2,q);if(t===0){if(this._propertiesArray.length>=2){t=2}else{if(this._propertiesArray.length===1){t=1}else{t=0}}}if(t!==0){var m=(u-(t/2)*20)/(t/2);var r=m.toString()+"px";for(var C=0;C<t;C++){this._propertiesArray[C].setStyle("display","block");this._propertiesArray[C].setStyle("width",r);this._propertiesSpacersArray[C].setStyle("display","block")}for(var C=t;C<this._propertiesArray.length;C++){this._propertiesArray[C].setStyle("display","none");this._propertiesSpacersArray[C].setStyle("display","none")}}else{for(var C=0;C<this._propertiesArray.length;C++){this._propertiesArray[C].setStyle("display","none");this._propertiesSpacersArray[C].setStyle("display","none")}}}var y=this.elements.container.titleLineNumber;var E=true;var D=true;var w=1;var j=4-y-w;if(this.elements.subtitle.getAttribute("has-subtitle")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false"){if(this.multipleTitleLineNumber===true){y++}else{j++}w=0;E=false}if(this.elements.description.getAttribute("has-description")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false"){if(this.multipleTitleLineNumber===true){y++}j=0;D=false}var A=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var n=h.createElement("div",{});if(g.getUnsafeHTMLContentValueToApply(A)){n.innerHTML=this.elements.realtitle}else{n.innerText=this.elements.realtitle}var l=document.createElement("canvas");var k=l.getContext("2d");k.font="13px arial";var x=k.measureText(n.innerText);var v=x.width;var u=0;var p=0;if(this.layoutingCollection&&this.layoutingCollection.layout){u=this.layoutingCollection.layout._columnWidth-(5+80+10+2+(this.elements.maincontent.getAttribute("has-menu")==="true"?40:10));p=(this.elements.container.getAttribute("has-icon")==="true")?16:0}else{var s=window.getComputedStyle(this.elements.maincontent);u=parseInt(s.width,10);var B=window.getComputedStyle(this.elements.icon);p=parseInt(B.width,10)}if(y>1&&v<(u-p)){y=1}this._setTitle(this.elements.realtitle,y);if(y>1){this.elements.title.setAttribute("on-singleLine","false")}else{this.elements.title.setAttribute("on-singleLine","true")}if(this.elements.realdescription){this.elements.container.descriptionLineNumber=4-y-w;this._setDescription(this.elements.realdescription,4-y-w)}else{if(y===3){this.elements.description.setStyle("display","none")}}},_createEllipsisHTML:function(m){var m=m||{maxWidth:"auto",lineHeight:18,nbLinesVisible:2,textAlign:"justify"};if(m.nbLinesVisible===1){var l={"class":"wux-button-label-ellipsis-nowrap",styles:{"max-width":m.maxWidth,"line-height":m.lineHeight+"px"}};if(g.getUnsafeHTMLContentValueToApply(m.allowUnsafeHTMLContent)){l.html=m.label}else{l.text=m.label}return new h.Element("div",l)}var j=m.nbLinesVisible||2;var n=m.lineHeight;var i={"class":"wux-button-label-ellipsis-wrap",styles:{"text-align":m.textAlign,"max-width":m.maxWidth,"line-height":m.lineHeight+"px","max-height":m.lineHeight*j+"px"}};if(g.getUnsafeHTMLContentValueToApply(m.allowUnsafeHTMLContent)){i.html=m.label}else{i.text=m.label}var k=new h.Element("div",i);a.onNodeRendered(k,function(){var s=k.children.length;var x=null;var B=0;var C=0;var w=null;var E=null;var D=null;var v=[];var p=0;var q=0;var y=0;k.getChildren().every(function(I,G){if(C!==0){v.push(I)}else{var H=I.getPosition().y;var F=I.getDimensions().height;if(H!==x){x=H;B++}if(B===j){C=G;E=I;D=w;p=I.getPosition().x;q=I.getPosition().y;y=w.getPosition().x;v.push(I)}}w=I;return true});var A=h.createElement("span",{styles:{overflow:"hidden","text-overflow":"ellipsis","white-space":"pre",display:"inline-block",}});if(p>0){A.setStyle("position","absolute");D.setStyle("margin-right","3px")}var o=k.getDimensions().width-p-1;A.setStyle("width",o+"px");k.insertBefore(A,E);for(var r=0;r<v.length;r++){k.removeChild(v[r]);v[r].setStyle("margin-right","3px");A.appendChild(v[r])}var z=A.getPosition().y;if(Math.abs(z-q)>=n){A.setStyle("position","relative")}else{if(Math.abs(z-q)>=n-2){A.setStyle("position","absolute");D.setStyle("margin-right","3px");var t=A.getPosition().x;var u=k.getDimensions().width-t-1;A.setStyle("width",u+"px")}}if(A.innerHTML===""){A.setStyle("display","none")}});return k},_getTitleLineHeight:function(){return 15},_getDescriptionLineHeight:function(){return 13}});return d});define("DS/Controls/ResponsiveThumbnailView",["UWA/Core","DS/Utilities/Utils","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(e,j,f,h,b,d,i,k){var c=150;var a=420;var g=f.inherit({name:"ResponsiveThumbnailView",markForRecordFlag:true,publishedProperties:{thumbnailWidth:{defaultValue:200,type:"integer",category:"Behavior"}},buildView:function(){this._modelEvents=new d();this._isHighlighted=false;var n=this;this.elements.container=new e.Element("div",{"class":"wux-controls-responsivethumbnailview"});this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new e.Element("div",{"class":"wux-controls-highlightborder",}).inject(this.elements.container);this.elements.activediv=new e.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.picture=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-picture",}).inject(this.elements.container);this.elements.color=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-color",}).inject(this.elements.picture);this.elements.color.setAttribute("has-color","false");this.elements.checkbox=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.maincontent=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.titlebar=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-titlebar"}).inject(this.elements.maincontent);this.elements.icon=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-icon"}).inject(this.elements.titlebar);this.elements.title=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;b.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.subtitle.setAttribute("has-menu","false");this.elements.mc_desc_separator=new e.Element("div",{"class":"wux-controls-mc_desc_separator"}).inject(this.elements.container);this.elements.description=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-description"}).inject(this.elements.container);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-propertiesListContainer"}).inject(this.elements.container);this.elements.propertiesList.setAttribute("has-propertiesList","false");for(var l=0;l<13;l++){var o=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-propertyDesc"}).inject(this.elements.propertiesList)}this.elements.menu=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-menu"}).inject(this.elements.maincontent);this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar_separator=new e.Element("div",{"class":"wux-controls-statusbar_separator"}).inject(this.elements.container);this.elements.statusbar=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbar",}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var l=0;l<8;l++){var m=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbaricon",});this.elements.statusbaricons.push(m);var p=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbarseparator",});this.elements.statusbar.appendChild(m);this.elements.statusbar.appendChild(p);m._index=l;b.addEventOnElement(this,m,h.POINTERDOWN,function(q){n.fire("StatusbarIconPointerDown",{iconIndex:q.target._index});q.stopPropagation()})}},_applyProperties:function(l){this._parent(l);if(this.isDirty("thumbnailWidth")){this._applyThumbnailWidth(l.thumbnailWidth)}},_applyPicture:function(l){if(this.picture){this.elements.container.setAttribute("has-picture","true");if(this.elements.picture.innerText){this.elements.picture.innerText="";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else{this.elements.container.setAttribute("has-picture","false");this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}},_applyThumbnailWidth:function(l){this._applyViewWidth(l)},_applyMultipleTitleLineNumber:function(l){if(this.multipleTitleLineNumber){this.elements.container.titleLineNumber=(this.multipleTitleLineNumber===false)?1:2;this._onViewResize()}},_applyDescription:function(l){this.elements.mc_desc_separator.style.display="none";this._parent()},_setDescription:function(s,q){if(!s){this.elements.description.setAttribute("has-description","false");this.elements.realdescription="";this._applyPropertiesList();return}this.elements.mc_desc_separator.style.display="";this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.realdescription=s;if(q===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}var z=q;if(this.layoutingCollection&&this.layoutingCollection.layout){var v=this.layoutingCollection.getViewportDimensions(true);var o=Math.floor((v.width-(this.layoutingCollection.layout._numberOfColumns+1)*this.layoutingCollection.layout.gutter)/this.layoutingCollection.layout._numberOfColumns);if(o<c){o=c}var A=this.layoutingCollection.layout._getRowHeight()-(o*3/4+70+14+((this.elements.statusbar.getAttribute("has-statusbar-content")==="true"||this.emptyStatusbarVisibleFlag===true)?28:0));z=Math.floor(A/13)}else{var y=window.getComputedStyle(this.elements.description);var p=document.createElement("canvas");var n=p.getContext("2d");n.font="11px arial";var u=n.measureText(this.elements.realdescription);var w=0;var m=u.width;if(y.width!==""){w=parseInt(y.width,10);if(w!==0){w-=28}}else{w=this.thumbnailWidth}z=0;if(w!==0){z=Math.ceil((m/w).toPrecision(3))}if(z===0){z=1}z++;if(z>13){z=13}if(z===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}}var x=this._getDescriptionLineHeight();var r=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var t=b.createEllipsisText({allowUnsafeHTMLLabel:r,label:s,maxWidth:"auto",lineHeight:x,nbLinesVisible:z});var l=this.elements.description.getAttribute("on-singleLine");this.elements.container.removeChild(this.elements.description);this.elements.description=t;this.elements.description.layoutDsModel=this.layoutingCollection;this.elements.description.setAttribute("has-description","true");this.elements.description.setAttribute("on-singleLine",l);this.elements.description.addClassName("wux-controls-responsivethumbnailview-description");this.elements.container.insertBefore(t,this.elements.statusbar_separator)},_applyPropertiesList:function(m){this.elements.mc_desc_separator.style.display="none";for(var o=0;o<this.elements.propertiesList.children.length;o++){this.elements.propertiesList.children[o].setStyle("display","none")}var n=window.getComputedStyle(this.elements.mc_desc_separator);var l=parseInt(n.width,10);var q=l.toString()+"px";var r=13;if(this.propertiesList){if(this.propertiesList.length>0){this.elements.mc_desc_separator.style.display=""}for(var o=0;o<this.propertiesList.length&&o<r;o++){var p=this.elements.propertiesList.children[o];p.layoutDsModel=this.layoutingCollection;if(o===r-1&&this.propertiesList.length>r){b.setContent(p,"...")}else{b.setContent(p,this.propertiesList[o])}if(this.layoutingCollection&&this.layoutingCollection.displayPropertiesTooltip===false){p.tooltipInfos=null}else{if(!p.tooltipInfos){p.tooltipInfos=new k({shortHelp:this.propertiesList[o]})}else{p.tooltipInfos.shortHelp=this.propertiesList[o]}}if(this.propertiesList[o]!==""){p.setStyle("display","block");p.setStyle("width",q)}else{p.setStyle("display","none")}}}if(this.elements.description.getAttribute("has-description")==="false"){this.elements.description.setStyle("display","none");if(this.propertiesList&&this.propertiesList.length>0){this.elements.propertiesList.setAttribute("has-propertiesList","true")}else{this.elements.propertiesList.setAttribute("has-propertiesList","false")}}else{this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.description.setStyle("display","block")}},_getViewMinWidth:function(){return c},_getViewMaxWidth:function(){return a},_getViewWidth:function(){return this.thumbnailWidth},_onViewResize:function(){var s=this.elements.container.titleLineNumber;var o=true;var x=true;var v=1;var p=10;if(this.elements.subtitle.getAttribute("has-subtitle")==="false"){if(this.multipleTitleLineNumber===true){s++}v=0;o=false}var r=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var w=e.createElement("div",{});if(j.getUnsafeHTMLContentValueToApply(r)){w.innerHTML=this.elements.realtitle}else{w.innerText=this.elements.realtitle}var n=document.createElement("canvas");var m=n.getContext("2d");m.font="13px arial";var t=m.measureText(w.innerText);var y=t.width;var q=window.getComputedStyle(this.elements.title);var z=parseInt(q.width,10);var l=window.getComputedStyle(this.elements.icon);var u=parseInt(l.width,10);if(s>1&&y<(z-u)){s=1}this._setTitle(this.elements.realtitle,s);if(s>1){this.elements.title.setAttribute("on-singleLine","false");this.elements.subtitle.setAttribute("title-on-singleLine","false")}else{this.elements.title.setAttribute("on-singleLine","true");this.elements.subtitle.setAttribute("title-on-singleLine","true")}if(this.elements.realdescription){this.elements.container.descriptionLineNumber=p;this._setDescription(this.elements.realdescription,p)}else{if(s===3){this.elements.description.setStyle("display","none")}}},_getViewCssClassSuffix:function(){return"responsivethumbnailview"}});return g});define("DS/Controls/ProgressBar",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Css","DS/Core/PointerEvents"],function(c,i,f,g,a,b,e){var h="EVT_CHANGE";var d;var j=f.inherit({name:"progressBar",publishedProperties:{value:{defaultValue:0,type:"number",category:"Behavior"},shape:{defaultValue:"linear",type:"string",category:"Appearance"},emphasize:{defaultValue:"info",type:"string",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},statusFlag:{defaultValue:true,type:"boolean",category:"Behavior"},infiniteFlag:{defaultValue:false,type:"boolean",category:"Behavior"},height:{defaultValue:60,type:"number",category:"Appearance"}},_progressbarClass:"wux-controls-progressbar",buildView:function(){this.elements.container.addClassName(this._progressbarClass)},_applyShape:function(){if(this.shape==="linear"){if(this.elements.circularSubcontainer){this.elements.circularSubcontainer.destroy();this.elements.circularProgressContainer.destroy();this.elements.circularProgressStatus.destroy();delete this.elements.circularSubcontainer;delete this.elements.circularProgressContainer;delete this.elements.circularProgressStatus}this.elements.linearSubcontainer=c.Element("div",{"class":this._progressbarClass+"-linear-subcontainer"}).inject(this.elements.container);this.elements.linearProgressContainer=new c.Element("div",{"class":this._progressbarClass+"-linear-subcontainer-bar"}).inject(this.elements.linearSubcontainer);this.elements.linearProgressStatus=new c.Element("span",{"class":this._progressbarClass+"-linear-subcontainer-status"}).inject(this.elements.linearSubcontainer)}if(this.shape==="circular"){if(this.elements.linearSubcontainer){this.elements.linearSubcontainer.destroy();this.elements.linearProgressContainer.destroy();this.elements.linearProgressStatus.destroy();delete this.elements.linearSubcontainer;delete this.elements.linearProgressContainer;delete this.elements.linearProgressStatus}this.elements.circularSubcontainer=c.Element("div",{"class":this._progressbarClass+"-circular-subcontainer"}).inject(this.elements.container);this.elements.circularProgressContainer=new c.Element("canvas").inject(this.elements.circularSubcontainer);this.elements.circularProgressContainer.height=this.height;this.elements.circularProgressContainer.width=this.height;this.elements.circularProgressStatus=new c.Element("span",{"class":this._progressbarClass+"-circular-subcontainer-status"}).inject(this.elements.circularSubcontainer);this._applyHeight()}this._applyStatusFlag();this._applyValue();this._applyDisplayStyle();this._applyEmphasize();this._applyInfiniteFlag()},handleEvents:function(){var k=this;this.elements.container.addEventListener("hover",function(l){l.stopPropagation()})},_applyProperties:function(k){this._parent(k);this._applyShape();this._applyStatusFlag();this._applyValue();this._applyDisplayStyle();this._applyEmphasize();this._applyInfiniteFlag()},_applyValue:function(k){if((this.value<0)||(this.value>100)){this.value=k}else{if(this.infiniteFlag===true){this._drawProgression(30)}else{this._drawProgression(Math.round(this.value))}}this._applyStatusFlag();if(this.value!==k){this.fire("change")}},_applyStatusFlag:function(){if(this.statusFlag===false||this.displayStyle==="lite"){if(this.shape==="circular"){this.elements.circularProgressStatus.hide()}else{this.elements.linearProgressStatus.hide()}}else{if(this.shape==="circular"){this.elements.circularProgressStatus.show()}else{if(this.value===null||typeof this.value==="undefined"){this.elements.linearSubcontainer.addClassName("undefined-class")}else{this.elements.linearSubcontainer.removeClassName("undefined-class")}this.elements.linearProgressStatus.show()}}},_applyDisplayStyle:function(){if(this.shape==="linear"){if(this.displayStyle==="lite"){d="-lite"}else{d=""}this.elements.linearSubcontainer.className=this._progressbarClass+"-linear-subcontainer"+d}this._applyStatusFlag()},_applyEmphasize:function(k){if(this.shape==="linear"){var m=this.elements.linearProgressContainer;var l="wux-ui-state-";if(k){m.removeClassName(l+k)}m.addClassName(l+this.emphasize)}this._applyValue()},_getColorFromEmphasize:function(){if(this.emphasize==="info"){return"#358EC4"}else{if(this.emphasize==="success"){return"#57B847"}else{return"#EA4F37"}}},_applyInfiniteFlag:function(){if(this.infiniteFlag===true){this._drawProgression(30);if(this.shape==="circular"){this.elements.circularProgressContainer.removeClassName("wux-controls-progressbar-no-animate-infinite-circular");this.elements.circularProgressContainer.addClassName("wux-controls-progressbar-animate-infinite-circular")}else{if(this.shape==="linear"){this.elements.linearProgressContainer.addClassName("wux-controls-progressbar-animate-infinite-linear")}}}else{if(this.shape==="circular"){this.elements.circularProgressContainer.removeClassName("wux-controls-progressbar-animate-infinite-circular");this.elements.circularProgressContainer.addClassName("wux-controls-progressbar-no-animate-infinite-circular");this._drawProgression(this.value)}else{if(this.shape==="linear"){this.elements.linearProgressContainer.removeClassName("wux-controls-progressbar-animate-infinite-linear");this._applyValue()}}}},_applyHeight:function(){if(typeof this.height!=="undefined"){if(this.shape==="circular"){this.elements.circularSubcontainer.setStyle("height",this.height+"px");this.elements.circularSubcontainer.setStyle("width",this.height+"px");this.elements.circularProgressStatus.setStyle("height",this.height+"px");this.elements.circularProgressStatus.setStyle("line-height",this.height+"px");this.elements.circularProgressStatus.setStyle("width",this.height+"px");this.elements.circularProgressContainer.height=this.height;this.elements.circularProgressContainer.width=this.height;this._drawCircularProgression(this.value);this._applyValue()}}},_updateLabel:function(){var k=(this.value!==null&&typeof this.value!=="undefined")?Math.round(this.value)+"%":"";if(this.shape==="circular"){this.elements.circularProgressStatus.innerText=k}else{this.elements.linearProgressStatus.innerText=k}},_drawCircularProgression:function(l){if(this.elements.circularProgressContainer.getContext){var k=this.elements.circularProgressContainer.getContext("2d");var m=Math.PI/50*l-Math.PI/2;k.clearRect(0,0,this.height,this.height);k.beginPath();if(this.height<=24){k.lineWidth=3}else{if(this.height<=40){k.lineWidth=4}else{k.lineWidth=5}}k.strokeStyle="#E2E4E3";k.beginPath();k.arc(this.height/2,this.height/2,(this.height/2)-2,0,Math.PI*2,true);k.stroke();k.closePath();k.strokeStyle=this._getColorFromEmphasize();k.beginPath();k.arc(this.height/2,this.height/2,(this.height/2)-2,-Math.PI/2,m,false);k.stroke();k.closePath()}},_drawProgression:function(k){if(this.shape==="circular"){this._drawCircularProgression(k)}else{if(k>100){k=100}if(k<0){k=0}if(this.elements.linearProgressContainer){this.elements.linearProgressContainer.style.width=k+"%";if(k===100){if(this.displayStyle==="normal"){this.elements.linearProgressStatus.setStyle("color","white")}}else{this.elements.linearProgressStatus.setStyle("color","black")}}}this._updateLabel()}});return j});define("DS/TreeModel/BaseFilter",["DS/Core/BaseComponent"],function(b){var a=b.inherit({name:"filter",publishedProperties:{filterManager:{defaultValue:null,type:"object",readOnly:true},filterId:{defaultValue:"",type:"string",readOnly:true},propertyId:{defaultValue:"",type:"string",readOnly:true},filterModel:{defaultValue:undefined,type:"object"}},isDataFiltered:function(c){return false},isEmpty:function(){return false},_build:function(){this._listOfFilteredData=[]},destroy:function(){this._listOfFilteredData.forEach(function(c){c.decrementFilteredCount()});this._parent()},_applyFilterModel:function(c){if(!this.filterManager){return}this.filterManager.model.prepareUpdate();this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()});this._listOfFilteredData=[];if(!this.filterModel){this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this});if(this.filterManager.filterModel[this.propertyId]){delete this.filterManager.filterModel[this.propertyId].filterModel}this.filterManager.model.pushUpdate();return}this.filterManager.filterModel[this.propertyId].filterModel=this.filterModel;var d=this;this.filterManager.model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(f){if(this._preventFiltering===true){delete this._preventFiltering;return}if(f.nodeModel.canBeFiltered()&&d.isDataFiltered(f.nodeModel)){this.incrementFilteredCount();d._listOfFilteredData.push(this)}else{var e=this.getParents();e.forEach(function(g){g._preventFiltering=true})}}});this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this});this.filterManager.model.pushUpdate()},_applyProperties:function(c){this._parent(c);if(this.isDirty("filterModel")){this._applyFilterModel(c.filterModel)}}});return a});define("DS/Selection/HSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(f,b,a,e){var c="HSO/";var d=e.singleton({init:function(g){g={eventChannel:c,};this._parent(g)}});return f.namespace("WUX/Selection/HSOManager",d)});define("DS/Layouts/ListViewCellAbstract",["UWA/Core","UWA/Class","DS/Layouts/GridEngineCellAbstract"],function(d,a,c){var b=c.extend({defaultOptions:{width:"100%"},init:function(e){this._parent(e);this.elements.container.addClassName("wux-layouts-listview-cell")}});return b});define("DS/Controls/Stack",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core"],function(e,a,d){var c={horizontal:"inline-block",vertical:"block"};var b=d.extend({defaultOptions:{orientation:"horizontal","class":"",styles:{margin:0,padding:0}},init:function(f){this._parent(f);this._stackCells=[];this._stackCellsContainers=[];this._totalWeight=0;this.buildSkeleton();this.addEvent("onPostInject",this._onPostInject)},buildSkeleton:function(){this.elements.container=new e.Element("ul",{"class":"Stack "+this.options["class"],styles:this.options.styles})},toggleOrientation:function(){},append:function(h,g){var f={weight:0,styles:null};g=e.extend(f,g);var j=new e.Element("li",{styles:{display:c[this.options.orientation]},html:h,events:g.events});j.addClassName(g["class"]);j.setStyles(g.styles);this._totalWeight+=parseInt(g.weight,10);j.inject(this.elements.container);var i={container:j,options:g};this._stackCellsContainers.push(j);this._stackCells.push(i);return i},getElements:function(){return this._stackCells},getElementsContainers:function(){return this._stackCellsContainers},remove:function(g){var f=this._stackCells.indexOf(g);if(f!==-1){this._stackCellsContainers[f].destroy();this._stackCells.splice(f,1);this._stackCellsContainers.splice(f,1)}},_onPostInject:function(){var h=this;var f=0;var g=0;this._stackCells.forEach(function(i){var k;k=i.options.weight/h._totalWeight*100;if(i.options.weight){if(h.options.orientation==="horizontal"){var j=g;g=g+k;i.container.setStyles({left:j+"%",width:k+"%",top:0,bottom:0})}else{i.container.setStyles("height",k+"%")}}f++})}});return e.namespace("WUX/Controls/Stack",b)});define("DS/Controls/Knob",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Scroller","DS/Utilities/Css3D","DS/Controls/Stack","DS/Controls/Gauge","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(d,l,g,i,c,j,k,a,e,b){var h="change";var f=g.extend({defaultOptions:{snap:0,value:0,stepValue:1,minValue:0,maxValue:360,graduations:12,graduationsLabel:false,dynamicGraduations:false,activeGraduationsColor:"#00FFF5",inactiveGraduationsColor:"#FF0000",graduationsLabelColor:"black",knobIndicator:"dot",knobMaterial:"pearl",turn:null,onChange:null,interactionMode:"rotate",theme:{display:"inline-block",fontSize:10,size:80}},init:function(m){this._parent(m);this._modelEvents=new b();this.startDeg=0;this.currentDeg=0;this.rotation=0;this.lastDeg=0;this._value=this.options.value;this._delta=this.options.maxValue-this.options.minValue;this._knobSize=parseInt(this.options.theme.size*0.75,10);this._graduationSize={width:parseInt((this.options.theme.size-this._knobSize)/2,10),height:parseInt((this.options.theme.size-this._knobSize)/5,10)};this._buildSkeleton();this._buildScaling();this._attachBehaviors();this._rotateKnob(this._valueToDeg(this.options.value))},_valueToDeg:function(m){return(m-this.options.minValue)/this._delta*360},_degToValue:function(m){var n=((m/360)*this._delta+this.options.minValue);return n},_buildScaling:function(){var C=180/Math.PI;var n=0;var u=this.options.graduations;var m=d.typeOf(u);var p;if(m==="array"){p=u.length}else{p=u}for(var r=0;r<p;r++){var v;var A;if(this.options.dynamicGraduations){var y=(120-r*120/p);A="hsl("+y+", 100%, 50%)";v=0}else{A=this.options.inactiveGraduationsColor;v=1}if(m==="array"){n=this._valueToDeg(u[r].value)}else{n=r*(360/p)}var x=parseInt(this._graduationSize.height/4,10);if(this.options.dynamicGraduations){x=0}var o=new d.Element("div",{"class":"wux-knob-scale",styles:{boxShadow:"inset 0 0 "+x+"px black",borderRadius:x,opacity:v}});var w=new d.Element("div",{styles:{position:"relative"}}).inject(o);if(this.options.graduationsLabel){var z;if(m==="array"){z=u[r].label}else{z=this._degToValue(parseFloat(n))}var t;if(m==="array"){switch(r){case 0:t=-parseInt(1.5*this.options.theme.fontSize,10);break;case p-1:t=0;break;default:t=-parseInt(this.options.theme.fontSize/2,10);break}}else{t=-parseInt(this.options.theme.fontSize/2,10)}var B=new d.Element("div",{"class":"wux-knob-scale-label",styles:{position:"absolute",transform:"rotate("+-n+"deg)",top:t,fontSize:this.options.theme.fontSize,whiteSpace:"nowrap",color:this.options.graduationsLabelColor},html:z.toString()});B.inject(w)}var s=-Math.sin(n/C)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size)/2-this._graduationSize.height/2+this.options.theme.fontSize;var q=Math.cos((180-n)/C)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size-this._graduationSize.width)/2+this.options.theme.fontSize;o.setStyles({backgroundColor:A,transform:"rotate("+n+"deg)",top:parseInt(s,10),left:parseInt(q,10),width:this._graduationSize.width,height:this._graduationSize.height}).inject(this.elements.container)}},turn:function(o){var p=this;var q=this.elements.container.getElements(".wux-knob-scale");var n=0,m=-1;n=Math.ceil(q.length*o);if(n===m){return false}m=n;q.forEach(function(w,v){var z={};var x=function(){w.addClassName("active");if(!p.options.dynamicGraduations){z.backgroundColor=p.options.activeGraduationsColor}else{z.opacity=1}w.setStyles(z)};var t=function(){w.removeClassName("active");if(!p.options.dynamicGraduations){z.opacity=1;z.backgroundColor=p.options.inactiveGraduationsColor}else{z.opacity=0}w.setStyles(z)};var s=o*p._delta+p.options.minValue;var y=p._degToValue(s);var u=p.options.graduations;var r=d.typeOf(u);if(r==="array"){if(u[v].value<=y){x()}else{t()}}else{if(v<n){x()}else{t()}}})},_buildSkeleton:function(){this.elements.container=d.Element("div",{styles:{position:"relative",height:(this.options.theme.size+2*this.options.theme.fontSize),width:(this.options.theme.size+2*this.options.theme.fontSize),display:this.options.theme.display}});this.elements.control=d.Element("div",{"class":"wux-knob-control wux-ui-material-"+this.options.knobMaterial,styles:{position:"absolute",top:"50%",left:"50%",marginTop:-this._knobSize/2,marginLeft:-this._knobSize/2}}).inject(this.elements.container);var m="";if(this.options.theme.size>50){m=" wux-ui-size-big"}this.elements.knob=d.Element("div",{"class":"wux-knob wux-ui-indicator-"+this.options.knobIndicator+" wux-ui-material-"+this.options.knobMaterial+m,styles:{height:this._knobSize,width:this._knobSize,borderRadius:"100%"}}).inject(this.elements.control);this.elements.knobTop=d.Element("div",{"class":"wux-knob-top"});this.elements.knobBottom=d.Element("div",{"class":"wux-knob-bottom"})},_attachBehaviors:function(){var o=this;var n=this.elements.container;var m=this.elements.knob;n.addEvent(e.POINTERDOWN,function(w){w.preventDefault();var t=m.getDimensions();var v=m.getOffsets();var q={y:v.y+t.height/2,x:v.x+t.width/2};var z,y,r,C=180/Math.PI;var A=d.extendElement(document);if(o.options.interactionMode==="vertical-slide"){var s;var p=200;var x=50;var u=1;var B=5;s=window.setInterval(function(){var D=Math.abs(z);if(D<p){u=Math.min(parseInt((D/p)*B,10),B)}else{u=B}if(z>0){o.increment(u)}if(z<0){o.decrement(u)}},x)}A.addEvent(e.POINTERMOVE,function(D){z=q.y-D.pageY;if(o.options.interactionMode==="rotate"){y=q.x-D.pageX;r=Math.atan2(z,y)*C;o._rotateKnob(r)}});A.addEvent(e.POINTERUP,function(){window.clearInterval(s);A.removeEvent(e.POINTERMOVE);A.removeEvent(e.POINTERUP);o.rotation=o.currentDeg;o.startDeg=-1})});d.Element.addEvent.call(o.elements.container,"mousewheel",function(q){var r=d.Event.wheelDelta(q);var p=q.shiftKey;if(p){r*=5}o.currentDeg+=r;o._rotateKnob(o.currentDeg)})},increment:function(n){var m=this.getValue()+n*this.options.stepValue;console.log("increment",this,this.getValue(),m,n);this.setValue(m)},decrement:function(n){var m=this.getValue()-n*this.options.stepValue;console.log("decrement",this,this.getValue(),m,n);this.setValue(m)},getValue:function(){return this._value},_rotateKnob:function(n){if(n<0){n=360+n}if(this.startDeg===-1){this.startDeg=n}var m=Math.floor((n-this.startDeg)+this.rotation);if(m<0){m=360+m}else{if(m>359){m=m%360}}if(this.options.snap&&m<this.options.snap){m=0}if(Math.abs(m-this.lastDeg)>180){return false}this.currentDeg=m;this.lastDeg=m;this.setValue(this._degToValue(this.currentDeg))},setValue:function(o,n){if(n===undefined){n=true}var m=this.elements.knob;this._value=o;this.currentDeg=this._valueToDeg(o);m.setStyle("transform","rotate("+this.currentDeg+"deg)");if(!this.options.turn){this.options.turn=this.turn}this.options.turn.call(this,this.currentDeg/360);if(n){if(this.options.onChange){this.options.onChange.call(this,this.getValue())}this._modelEvents.publish({context:this,event:h,data:this})}},addEvent:function(m,n){return this._subscribe(m,n)},_removeEvent:function(m){return this._modelEvents.unsubscribe(m)},_removeEventListener:function(m){return this._modelEvents.unsubscribe(m)},addEventOnce:function(m,n){return this._modelEvents.subscribeOnce({event:m},n)},addEventListener:function(m,n){return this._subscribe(m,n)},_subscribe:function(m,n){return this._modelEvents.subscribe({event:m},n)}});return d.namespace("WUX/Controls/Knob",f)});define("DS/SmartInputs/Angle",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/Number","DS/Controls/Knob"],function(e,j,g,i,b,h,d,c,f){var a=h.extend({defaultOptions:{label:null,constraints:{minValue:-180,maxValue:180,stepValue:1},value:0,units:"deg",view:"simple"},_smartInputClass:"wux-smartinputs-Angle",init:function(k){this._numberOfComponents=2;this._parent(k);this._internalValue=[]},_buildInternalView:function(){var m=this;this.elements.vectorComponents=[];var l=this.getConstraints(0);var k=new f({value:this.options.value,minValue:l.minValue,maxValue:l.maxValue,stepValue:l.stepValue,graduations:this.options.graduations,units:"",knobMaterial:"pearl",knobIndicator:"line",theme:{display:"block",fontSize:0,size:20},onChange:function(o){m.setValue(o,true)}});this.elements.vectorComponents.push(k);this._addElement(k,{height:15});var n=new c({value:this.options.value,constraints:l,graduations:this.options.graduations,units:""});this.elements.vectorComponents.push(n);this._addElement(n)},updateView:function(){for(var k=0;k<this._numberOfComponents;k++){if(this.elements.vectorComponents[k]){this.elements.vectorComponents[k].setValue(this.getValue("float"),false)}}}});return a});define("DS/SmartInputs/VectorN",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/Number","DS/SmartInputs/Angle"],function(d,i,e,h,a,f,c,b,g){var j=f.extend({defaultOptions:{label:null,constraints:{minValue:-1000,maxValue:1000,stepValue:1},value:0,graduations:2,units:"mm"},_smartInputClass:"wux-smartinputs-VectorN",init:function(k,m,l){this._numberOfComponents=m;this._type=l;this._parent(k);this._internalValue=[]},_buildInternalView:function(){this.elements.vectorComponents=[];for(var m=0;m<this._numberOfComponents;m++){var k=this.getConstraints(m)||this.getConstraints(0);var l;switch(this._type){case"angle":l=new g({value:this.options.value[m],constraints:k,graduations:this.options.graduations,units:""});break;default:l=new b({value:this.options.value[m],constraints:k,graduations:this.options.graduations,units:""});break}this.elements.vectorComponents.push(l);this._addElement(l)}},updateView:function(){for(var k=0;k<this._numberOfComponents;k++){this.elements.vectorComponents[k].setValue(this.getValue()[k],false)}},updateModel:function(){var k=[];for(var l=0;l<this._numberOfComponents;l++){k.push(this.elements.vectorComponents[l].getValue("float"))}return k}});return j});define("DS/SmartInputs/Vector4",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/VectorN"],function(c,i,d,f,a,e,b,g){var h=g.extend({defaultOptions:{label:null,minValue:0,maxValue:360,value:[0,0,0,0],stepValue:0.1,graduations:2,units:"mm",view:"simple"},_smartInputClass:"wux-smartinputs-Vector4",init:function(j){this._parent(j,4)}});return h});define("DS/SmartInputs/Vector2",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/VectorN"],function(d,i,e,g,a,f,c,h){var b=h.extend({defaultOptions:{label:null,minValue:0,maxValue:360,value:[0,0],stepValue:0.1,graduations:2,units:"mm",view:"simple"},_smartInputClass:"wux-smartinputs-Vector2",init:function(j){this._parent(j,2)}});return b});define("DS/SmartInputs/Vector3",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/VectorN"],function(c,i,d,g,a,e,b,h){var f=h.extend({defaultOptions:{label:null,minValue:0,maxValue:360,value:[0,0,0],stepValue:0.1,graduations:2,units:"mm",view:"simple"},_smartInputClass:"wux-smartinputs-Vector3",init:function(j){this._parent(j,3)}});return f});define("DS/SmartInputs/Position",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/Vector3"],function(c,j,e,h,a,f,b,i){var g="EVT_CHANGE";var d=i.extend({defaultOptions:{label:null,minValue:0,maxValue:360,value:[0,0,0],stepValue:0.1,graduations:2,units:"mm",view:"simple"},_smartInputClass:"wux-smartinputs-Position",init:function(k){this._parent(k)}});return d});define("DS/SmartInputs/Distance",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/Number","DS/Controls/Gauge"],function(f,j,g,i,c,h,e,d,a){var b=h.extend({defaultOptions:{label:null,constraints:{minValue:-180,maxValue:180,stepValue:1},value:0,units:"deg",view:"simple"},_smartInputClass:"wux-smartinputs-Distance",init:function(k){this._numberOfComponents=2;this._parent(k);this._internalValue=[]},_buildInternalView:function(){var m=this;this.elements.vectorComponents=[];var k=this.getConstraints(0);var n=new a({value:this.options.value,minValue:k.minValue,maxValue:k.maxValue,stepValue:k.stepValue,dynamicGaugeColor:false,graduations:this.options.graduations||3,units:"",onChange:function(p){m.setValue(p,true)}});n.getContent().setStyles({marginTop:0});this.elements.vectorComponents.push(n);var l=this._addElement(n);l.setStyles({width:100,marginRight:5});var o=new d({value:this.options.value,constraints:k,graduations:this.options.graduations,units:""});this.elements.vectorComponents.push(o);this._addElement(o)},updateView:function(){for(var k=0;k<this._numberOfComponents;k++){if(this.elements.vectorComponents[k]){this.elements.vectorComponents[k].setValue(this.getValue("float"),false)}}}});return b});define("DS/Controls/ColorCanvas",["DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Utils","DS/Utilities/Color","DS/Utilities/Dom"],function(f,e,c,i,g,j,a){var h=8;var d=8;var b=f.inherit({name:"colorCanvas",publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",}},keymaps:{esc:{keydown:"cancel"}},commands:{cancel:function(){if(!this.handleEditionCancel){return{stopPropagation:false}}if(!this.disabled){this._inEdition=false;this.setPropertyFromUIInteraction("value",this.initialValue);this.fire("cancelEdit")}}},buildView:function(){var k=this;var l="wux-controls-colorcanvas";k.elements.container.addClassName(l);k.elements._canvas=UWA.createElement("canvas",{tabIndex:-1,"class":l+"-canvas"}).inject(k.elements.container);this.buildCanvas();k.elements._pickerCursor=UWA.createElement("div",{"class":l+"-canvas-picker-cursor wux-element-contentbox"});k.elements._pickerCursor2=UWA.createElement("div",{"class":l+"-canvas-picker-cursor2 wux-element-contentbox"}).inject(k.elements._pickerCursor);k.elements._pickerCursor.hide();k.elements._pickerCursor.inject(k.elements.container);a.onNodeRendered(k.getContent(),function(){if(k.value!=="undefined"&&k.value!==null){if(k.elements._pickerCursor){k.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(k.value)))}k.elements._pickerCursor.show();k._updatePickerCursorPositionFromValue()}})},_handleEvents:function(){var n=this;var m=document;if(n.getContent()&&n.getContent().ownerDocument){m=n.getContent().ownerDocument}var k=function(r){if(this.disabled){return}if(n._inEdition){var s={x:r.clientX,y:r.clientY};var q=n.elements._canvas.getBoundingClientRect();var p=n._getPixelFromCoordinates(s,q);n.setPropertyFromUIInteraction("value",c.rgbToHex({r:parseInt(p[0]),g:parseInt(p[1]),b:parseInt(p[2])}).toLowerCase());n._updatePickerCursorPositionFromCoords(s,q)}};var l=function(p){n._inEdition=false;if(n.beginEdit){n.fire("endEdit");n.beginEdit=false}a.removeEventOnElement(n,m,e.POINTERMOVE,k);a.removeEventOnElement(n,m,e.POINTERMOVE,l)};var o=function(r){if(n.disabled){return}n._inEdition=true;n.initialValue=n.value;if(!n.beginEdit){n.fire("beginEdit");n.beginEdit=true}var s={x:r.clientX,y:r.clientY};var q=n.elements._canvas.getBoundingClientRect();var p=n._getPixelFromCoordinates(s,q);n.setPropertyFromUIInteraction("value",c.rgbToHex({r:parseInt(p[0]),g:parseInt(p[1]),b:parseInt(p[2])}).toLowerCase());n._updatePickerCursorPositionFromCoords(s,q);a.addEventOnElement(n,m,e.POINTERMOVE,k);a.addEventOnElement(n,m,e.POINTERUP,l)};a.addEventOnElement(this,n.elements.container,e.POINTERDOWN,o);a.addEventOnElement(this,n.elements.container,e.POINTERUP,l);a.addEventOnElement(this,n.elements.container,e.POINTERMOVE,k)},_applyProperties:function(k){this._parent(k);if(this.isDirty("value")){this._applyValue()}},_applyValue:function(){if(this.elements._pickerCursor){this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)))}if(!this._inEdition){this._updatePickerCursorPositionFromValue()}this.fire("change")},_applyTouchMode:function(){var k=this._getCurrentTouchMode();if(k===true){this.elements._canvas.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements._canvas.removeAttribute("touch-mode")}},_getPixelFromCoordinates:function(o,n){var l=this.elements._canvas.getContext("2d");var m=this.elements._canvas.width-1;var k=this.elements._canvas.height;var p=l.getImageData(g.clamp(0,m,(o.x-n.left)/n.width*m),g.clamp(0,k,(o.y-n.top)/n.height*k),1,1);return p.data},buildCanvas:function(){var n=this.elements._canvas.getContext("2d");var m=this.elements._canvas.width;var s=this.elements._canvas.height;var o=n.createLinearGradient(0,0,m,0);var q=37;for(var r=0;r<q;r++){var p=r/(q-1);var l=c.colorToCssColor(c.hslToRgb([p*360,100,50]));o.addColorStop(p,l)}var t=n.createLinearGradient(0,0,0,s);t.addColorStop(0,"white");t.addColorStop(0.5,"rgba(255,255,255,0)");var k=n.createLinearGradient(0,0,0,s);k.addColorStop(0.5,"rgba(0,0,0,0)");k.addColorStop(1,"black");[o,t,k].forEach(function(u){n.fillStyle=u;n.fillRect(0,0,m,s)})},_updatePickerCursorPositionFromCoords:function(p,n){var o=n.height-d;var k=n.width-h;var m=p.x-n.left-h/2;var l=p.y-n.top-d/2;if(m<0){m=-h/2}if(l<0){l=-d/2}if(m>k){m=k-1}if(l>o){l=o}this.elements._pickerCursor.setStyle("left",m+"px");this.elements._pickerCursor.setStyle("top",l+"px")},_updatePickerCursorPositionFromValue:function(){var k=this.elements._canvas.width;var z=this.elements._canvas.height;var t=this.elements._canvas.getBoundingClientRect();var q=j.hexToRgb(this.value);var l=this.elements._canvas.getContext("2d");var u=0,s=0;var m=l.getImageData(0,0,k,z);var o=new Uint8ClampedArray(m.data.buffer);var r=0;var p=o.length;var w=5;do{for(r=0;r<p;r+=4){var n=(r/4)%k;var v=Math.floor((r/4)/(k-1));if(o[r]<q.r+w&&o[r]>q.r-w&&o[r+1]<q.g+w&&o[r+1]>q.g-w&&o[r+2]<q.b+w&&o[r+2]>q.b-w){u=(n*t.width)/k;s=(v*t.height)/z;this.elements._pickerCursor.setStyle("left",u-h/2+"px");this.elements._pickerCursor.setStyle("top",s-d/2+"px");return 1}}w*=2}while(w<100);return 0},});return b});define("DS/UIBehaviors/PopupManager",["UWA/Core","UWA/Class","DS/TreeModel/TreeNodeModel","DS/Utilities/Dom"],function(e,b,d,a){var c=b.singleton({defaultOptions:{treePopup:null,lastPopup:null},init:function(f){this._parent(f)},add:function(f){if(!this.find(f)){var g=this.getContainingPopup(f.target);if(g){if(g.getChildren()){this.close(g.getChildren()[0])}this.lastPopup=g}else{this.close(this.treePopup);this.treePopup=null;this.lastPopup=null}var h=new d({grid:{data:f}});(this.lastPopup)?this.lastPopup.addChild(h):this.treePopup=h;this.lastPopup=h}},remove:function(f){this.close(this.find(f))},removeChild:function(f){var g=this.find(f);if(g&&g.getChildren()){this.close(g.getChildren()[0]);this.lastPopup=g}},getContainingPopup:function(h){var g=(e.is(h,"element"))?g=e.extendElement(h):g=h.getContent();if(g){var f=a.firstParentWithClass(g,"wux-controls-popup");if(f&&f.dsModel){return this.find(f.dsModel)}}},find:function(g){if(g==null){return}var f=this.treePopup;while(f&&f.options.grid.data!==g&&f.getChildren()!==null){f=f.getChildren()[0]}if(f&&f.options.grid.data===g){return f}},close:function(g){if(g==null){return}g.options.grid.data.visibleFlag=false;g.options.grid.data=null;g.processDescendants({processNode:function(h){h.nodeModel.options.grid.data.visibleFlag=false;h.nodeModel.options.grid.data=null;if(h.nodeModel.getParent()){h.nodeModel.remove()}}});if(g===this.treePopup){this.treePopup=null;this.lastPopup=null}else{var f=g.getParent();if(f){g.remove();this.lastPopup=f}}},_getTreePopup:function(){return this.treePopup},_getLastPopup:function(){return this.lastPopup}});return c});define("DS/Controls/Popup",["UWA/Core","UWA/Utils/Client","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/UIBehaviors/PopupManager","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents"],function(g,c,i,l,a,e,b,o,h){var n={};var m=i.inherit({name:"popup",markForRecordFlag:true,publishedProperties:{position:{defaultValue:"right",type:"string",category:"Appearance"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},visibleFlag:{defaultValue:false,type:"boolean",category:"Appearance"},target:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:false},offset:{defaultValue:{x:0,y:0},type:"vector2",category:"Appearance",noNeedToApplyFlag:true},constraint:{defaultValue:"none",type:"string",category:"Appearance"},trigger:{defaultValue:"",type:"string",category:"Behavior",uiDisplay:false},mouseRelativePosition:{defaultValue:false,type:"boolean",category:"Appearance",noNeedToApplyFlag:true},overlap:{defaultValue:true,type:"boolean",category:"Appearance"},overlapCallback:{defaultValue:undefined,type:"function",category:"Appearance"},className:{defaultValue:"wux-controls-popup",type:"string",category:"Appearance"},arrowBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoHide:{defaultValue:true,type:"boolean",category:"Appearance"}},getBody:function(){if(this.elements){return this.elements.body}},setBody:function(p){if(this.elements.container){this.elements.container.empty()}this.elements.body=p;this.elements.container.setContent(p);this.elements.container.setAttribute("tabindex",0);this._applyArrowBoxFlag()},_applyArrowBoxFlag:function(){if(this.arrowBoxFlag){if(!this.elements.arrow){this.elements.arrow=new g.Element("div",{"class":"wux-controls-popup-arrow-"+this.position});this.elements.arrow.inject(this.elements.container)}this._updateView()}else{if(this.elements.arrow){this.elements.arrow.style.display="none"}}},_applyTarget:function(p){a.removeAllEventsOnElement(this);f.call(this);this._updateView()},_applyTrigger:function(p){a.removeAllEventsOnElement(this);f.call(this)},_applyProperties:function(p){this._parent(p);if(this.className&&this.className!==""){this.elements.container.removeClassName("wux-controls-popup");this.elements.container.addClassName(this.className)}this._updateView()},show:function(){if(this.visibleFlag){if(!arguments[0]&&this.target&&this.target.disabled){return}if(this.autoHide){e.add(this)}var p=document;if(this.target){if(this.target.ownerDocument){p=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){p=this.target.getContent().ownerDocument}}}if(this.elements&&this.elements.container){this.inject(p.body);this._parent();this._updateView();this.fire("show")}if(this.mouseRelativePosition){this.elements.container.style.pointerEvents="none"}}else{this.visibleFlag=true;this._applyArrowBoxFlag()}},hide:function(){if(this.visibleFlag){this.visibleFlag=false}else{this._parent();if(this.autoHide){e.remove(this)}var p=document;if(this.target){if(this.target.ownerDocument){p=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){p=this.target.getContent().ownerDocument}}}if(this.elements&&this.elements.container){this.elements.container.remove(p.body);this.fire("hide",{trigger:this._escapeKbdAction?"escape":""})}}},_applyVisibleFlag:function(q){var t=this;var s=document;if(this.target){if(this.target.ownerDocument){s=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){s=this.target.getContent().ownerDocument}}}var r=function(u){window.onmousewheel=s.onmousewheel=this._hideThisPopupBinded;a.addEventOnElement(t,window,"DOMMouseScroll",this._hideThisPopupBinded,true)};var p=function(u){window.onmousewheel=s.onmousewheel=null;a.removeEventOnElement(t,window,"DOMMouseScroll",this._hideThisPopupBinded,true)};if(this.visibleFlag&&!this._globalListening){this._scrollAtShow.x=window.scrollX;this._scrollAtShow.y=window.scrollY;a.addEventOnElement(t,s,"scroll",this._onScrollBinded,true);a.addEventOnElement(t,window,"resize",this._hideThisPopupBinded,true);a.addEventOnElement(t,t.elements.container,"mouseenter",r);a.addEventOnElement(t,t.elements.container,"mouseleave",p);this._globalListening=true}else{if(!this.visibleFlag&&this._globalListening){a.removeEventOnElement(t,s,"scroll",this._onScrollBinded,true);if(t.elements.container){a.removeEventOnElement(t,t.elements.container,"mouseenter",r);a.removeEventOnElement(t,t.elements.container,"mouseleave",p)}a.removeEventOnElement(t,window,"resize",this._hideThisPopupBinded,true);this._globalListening=null}}this.visibleFlag?this.show():this.hide()},isElementInside:function(q){if(!q){return false}var p=e.getContainingPopup(q);if(!p){return false}if(p.options.grid.data===this){return true}return this.isElementInside(p.options.grid.data.target)},toggle:function(){var p=this.visibleFlag;this.visibleFlag=!p},buildView:function(){this.elements.container.addClassName("wux-controls-popup");this.elements.container.setStyles({left:0,top:0});this._hideThisPopupBinded=k.bind(this);this._onScrollBinded=j.bind(this);this._scrollAtShow={x:0,y:0}},handleEvents:function(){var p=this;a.addEventOnElement(this,this.elements.container,"click",function(q){e.removeChild(p)});a.addEventOnElement(this,this.elements.container,"dimensionsChanged",function(){p._updateView()});f.call(p)},_updateView:function(){if(this.visibleFlag){var q=l.setConstrainedPosition(this,this.target,{position:this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,arrowBoxFlag:this.arrowBoxFlag,mouseRelativePosition:this.mouseRelativePosition,mousePosition:n,mouseOffset:{x:-10,y:10}});var p=this.position;if(this.position==="bottom"&&q.position.y<q.targetPosition.y){p="top"}if(this.position==="top"&&q.position.y>q.targetPosition.y){p="bottom"}if(this.position==="right"&&q.position.x<q.targetPosition.x){p="left"}if(this.position==="left"&&q.position.x>q.targetPosition.x){p="right"}if(this.arrowBoxFlag){this.elements.arrow.className="wux-controls-popup-arrow arrow-"+p}if(q.availableSpaceAroundTargetIfOverlaping!==undefined&&this.overlapCallback instanceof Function){this.overlapCallback(q.availableSpaceAroundTargetIfOverlaping)}}},storeMousePosition:function(p){if(this.mouseRelativePosition){n.x=p.pageX;n.y=p.pageY}}});function j(p){if(p.target instanceof HTMLInputElement){return}this._hideThisPopupBinded(p)}function d(r,p){if(!(r instanceof Element)){return null}var q=window.getComputedStyle(r)["overflow-y"];if(r.scrollHeight>r.offsetHeight&&(q==="scroll"||q==="auto")){return r}else{if(r===p){return null}return d(r.parentNode)}}function k(p){if(p.target&&p.type!=="resize"&&p.target instanceof Element){if(this.isElementInside(p.target)){var r=0;if(p.type==="mousewheel"||p.type==="scroll"){r=p.wheelDelta}else{if(p.type==="DOMMouseScroll"){r=-p.detail}}if(r>=0){this._scrollDown=false}else{this._scrollDown=true}var q=d(p.target,this.elements.container);if(q&&(((q.offsetHeight+q.scrollTop>=q.scrollHeight)&&this._scrollDown)||(q.scrollTop===0&&!this._scrollDown))){p.preventDefault()}q=null;return}this.visibleFlag=false}else{if(p.type==="resize"){this.visibleFlag=false}}}function f(){var q=this;var p=this.trigger.split(" ");var r=this.target;if(r){p.forEach(function(D){if(D==="hover"){a.addEventOnElement(q,r,"mousemove",function u(t){q.storeMousePosition(t)});a.addEventOnElement(q,r,"mouseover",function x(t){q.storeMousePosition(t);q.visibleFlag=true});a.addEventOnElement(q,r,"mouseleave",function v(){q.visibleFlag=false})}if(D==="focus"){a.addEventOnElement(q,r,"focus",function B(){q.visibleFlag=true});a.addEventOnElement(q,r,"blur",function s(){q.visibleFlag=false})}if(D==="click"){a.addEventOnElement(q,r,"click",function z(t){if(q.target&&!q.target.disabled&&!(q.target.dsModel&&q.target.dsModel.disabled)){t.stopPropagation();q.storeMousePosition(t);q.callMethodFromUIInteraction("toggle")}});var A=function A(E){var t=q.target.elements?q.target.getContent():q.target;if(!q.isElementInside(E.target)&&!a.isElementInside(E.target,t)){q.setPropertyFromUIInteraction("visibleFlag",false)}};var C=document;if(r.ownerDocument){C=r.ownerDocument}else{if(r.getContent()!==undefined&&r.getContent().ownerDocument){C=r.getContent().ownerDocument}}a.addEventOnElement(q,q,"show",function y(){a.addEventOnElement(q,C.body,h.POINTERDOWN,A)});a.addEventOnElement(q,q,"hide",function w(){a.removeEventOnElement(q,C.body,h.POINTERDOWN,A)})}if(D==="escape"){a.addEventOnElement(q,q.getContent(),"keydown",function(t){if(o.ESCAPE===t.keyCode){q._escapeKbdAction=true;q.visibleFlag=false;q._escapeKbdAction=false}})}})}}b.register(m,"DS/ControlsRec/AbstractRec");return m});define("DS/Decorator/OldSpinBoxDecorator",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Controls/Popup","DS/Controls/Button","DS/Utilities/Dom"],function(g,f,b,d,c,a){var e=f.inherit({publishedProperties:{widget:{defaultValue:null},decoratedWidget:{defaultValue:null}},buildView:function(){this.elements.container=new g.Element("div",{"class":"wux-keyboard-container"});this.elements.firstLine=new g.Element("div",{"class":"wux-keyboard-firstline"}).inject(this.elements.container);this.elements.secondLine=new g.Element("div",{"class":"wux-keyboard-secondline"}).inject(this.elements.container);this.elements.thirdLine=new g.Element("div",{"class":"wux-keyboard-thirdline"}).inject(this.elements.container);this.elements.fourthLine=new g.Element("div",{"class":"wux-keyboard-fourthLine"}).inject(this.elements.container);new c({label:"7"}).inject(this.elements.thirdLine);new c({label:"8"}).inject(this.elements.thirdLine);new c({label:"9"}).inject(this.elements.thirdLine);new c({label:"4"}).inject(this.elements.secondLine);new c({label:"5"}).inject(this.elements.secondLine);new c({label:"6"}).inject(this.elements.secondLine);this.elements.button1=new c({label:"1"}).inject(this.elements.firstLine);new c({label:"2"}).inject(this.elements.firstLine);new c({label:"3"}).inject(this.elements.firstLine);new c({label:"."}).inject(this.elements.fourthLine);new c({label:"0"}).inject(this.elements.fourthLine);this.elements.buttonSupp=new c({icon:{iconName:"chevron-left",fontIconSize:"0.5x"},value:"esc"}).inject(this.elements.fourthLine);this.elements.buttonSupp.getContent().addClassName("wux-keyboard-buttonBack");this.elements.buttonExponent=new c({label:"e"}).inject(this.elements.firstLine);this.elements.buttonMinus=new c({label:"-"}).inject(this.elements.secondLine);this.elements.buttonUp=new c({icon:{iconName:"sort-asc",fontIconSize:"0.5x"}}).inject(this.elements.thirdLine);this.elements.buttonUp.getContent().addClassName("wux-keyboard-buttonUp");this.elements.buttonDown=new c({icon:{iconName:"sort-desc",fontIconSize:"0.5x"}}).inject(this.elements.fourthLine);this.elements.buttonDown.getContent().addClassName("wux-keyboard-buttonDown")},removePopupWithDecorator:function(){if(this.widget.value!==parseFloat(this.widget.elements.inputField.value)){this.widget.value=parseFloat(this.widget.elements.inputField.value);this.widget._applyValue(this.widget.value)}},createPopupWithDecorator:function(){this.widget.elements.inputField.focus();this.widget.elements.inputField.selectionStart=0;this.widget.elements.inputField.selectionEnd=this.widget.elements.inputField.value.length;var h={target:this.widget,position:"bottom",offset:{x:0,y:12},alignment:"center",constraint:"screen",className:"wux-spinbox-spinner-decorator-popup",overlap:false};this.elements.popup=new d(h);this.elements.popup.setBody(this.elements.container);this.elements.popup.visibleFlag=true;this.elements.popup.arrowBoxFlag=true;return this.elements.popup},handleEvents:function(){var h=this;var i=false;this.elements.container.addEventListener(b.POINTERDOWN,function(j){i=h.widget.getContent().hasAttribute("focused")});a.addEventOnElement(this,document,b.POINTERUP,function(j){if(!b.isTouchEvent(j)&&h.elements.popup!==null&&h.elements.popup.visibleFlag&&h.elements.popup.getContent().getAttributeNode("focused")===null){h.elements.popup.hide()}});this.elements.buttonDown.addEventListener("buttonclick",function(j){h.widget.value=parseFloat(h.widget.elements.inputField.value);j.stopPropagation();j.preventDefault();h.widget.decrement()});this.elements.buttonUp.addEventListener("buttonclick",function(j){h.widget.value=parseFloat(h.widget.elements.inputField.value);j.stopPropagation();j.preventDefault();h.widget.increment()});this.elements.buttonUp.addEventListener("doubleclick",function(j){j.preventDefault();j.stopPropagation()});this.elements.buttonDown.addEventListener("doubleclick",function(j){j.preventDefault();j.stopPropagation()});this.elements.buttonSupp.addEventListener("doubleclick",function(j){j.preventDefault();j.stopPropagation()});this.elements.container.addEventListener("doubleclick",function(j){j.preventDefault();j.stopPropagation()});this.elements.container.addEventListener("buttonclick",function(n){n.preventDefault();n.stopPropagation();var p=h.widget.elements.inputField;var o;var k;if(p.selectionStart!==p.selectionEnd){o=p.value.substring(0,p.selectionStart);k=p.value.substring(p.selectionEnd,p.value.length);var l=o+k;p.value=String(l)}if(n.dsModel.value==="esc"){if(!i){p.selectionStart=p.selectionEnd=p.value.length}if(p.selectionStart!==p.selectionEnd){o=p.value.substring(0,p.selectionStart);k=p.value.substring(p.selectionEnd,p.value.length)}else{o=p.value.substring(0,p.selectionStart-1);k=p.value.substring(p.selectionStart,p.value.length)}p.value=o+k}else{if(p.value==="0"){p.value=n.target.textContent}else{if(n.target.textContent==="."){if(p.value.indexOf(".")===-1){if(!i){p.selectionStart=p.selectionEnd=p.value.length}o=p.value.substring(0,p.selectionStart);k=p.value.substring(p.selectionStart,p.value.length);p.value=o+"."+k}}else{if(n.target.hasClassName("wux-controls-button")||n.target.parentNode.hasClassName("wux-controls-button")){if(!i){p.selectionStart=p.selectionEnd=p.value.length}var j=p.selectionStart;var m=n.target.hasClassName("wux-controls-button")?n.target:n.target.parentNode;o=p.value.substring(0,p.selectionStart);k=p.value.substring(p.selectionStart,p.value.length);if(k===" "+h.widget.units){k=""}p.value=o+m.textContent+k;p.selectionStart=j+1;p.selectionEnd=j+1}}}}p.removeAttribute("focused")})}});return e});define("DS/Controls/Tooltip",["UWA/Core","DS/Controls/Popup","DS/Utilities/Utils","DS/Controls/TooltipModel","i18n!DS/Controls/assets/nls/translation.json"],function(a,k,g,d,c){var b=false;function l(p,o,n,m){this.set=function(t,s,r,q){this.left=Math.floor(t);this.top=Math.floor(s);this.right=Math.ceil(r);this.bottom=Math.ceil(q)};this.reset=function(){this.set(0,0,0,0)};this.isPositionInRZ=function(s,q){if(s===undefined||(this.left===this.right&&this.top===this.bottom)){return false}var r=q||0;return((s.x>this.left-r)&&(s.x<this.right+r)&&(s.y>this.top-r)&&(s.y<this.bottom+r))};this._showReachingZone=function(t,q){var r=document.getElementById(t);if(!r){var s={id:t};r=a.createElement("div",s)}r.setStyle("position","absolute");r.setStyle("top",this.top+"px");r.setStyle("left",this.left+"px");r.setStyle("width",(this.right-this.left)+"px");r.setStyle("height",(this.bottom-this.top)+"px");r.setStyle("border","1px solid "+q);r.setStyle("z-index","2147483647");r.setStyle("pointer-events","none");r.inject(document.body)};this._hideReachingZone=function(r){var q=document.getElementById(r);if(q){q.remove(document.body)}};this.applyOffset=function(q){if(q.x>0){this.left-=q.x}else{this.right-=q.x}if(q.y>0){this.top-=q.y}else{this.bottom-=q.y}};this.set(p,o,n,m)}function e(){if(this.target===undefined){return}if(this.target.tooltipInfos===undefined||(this.target.tooltipInfos&&this.target.tooltipInfos.isEmpty())){return}j.call(this);this._parentShow(true);if(this.target&&this.target.tooltipInfos._reachableState){this.elements.container.style.pointerEvents="auto"}}function i(){clearTimeout(this.INTIAL_DELAY_TIMER);clearTimeout(this.LONG_TO_SHOW_DELAY)}function f(){if(this.elements.container){this.elements.container.empty()}this.elements.title=undefined;this.elements.shortHelp=undefined;this.elements.shortHelpImage=undefined;this.elements.longHelp=undefined;this.elements.longHelpImage=undefined;this.elements.moreHelp=undefined}function j(){var n=this.target.tooltipInfos;if(!n){return}this.elements.container.setStyle("box-sizing","content-box");var m=n.wrapPolicy===d.WrapPolicy.MULTILINE&&n.wrapThreshold>0;if(m){this.elements.container.setStyle("max-width",n.wrapThreshold)}else{this.elements.container.setStyle("max-width","none")}if(n.title!==""&&this.elements.title===undefined){var p={"class":"wux-tooltip-title"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLTitle)){p.text=n.title}else{p.html=n.title}this.elements.title=a.createElement("div",p);this.elements.title.setAttribute("title",n.title);this.elements.title.visibility="visible";this.elements.title.inject(this.elements.container)}if(n.shortHelp!==""&&this.elements.shortHelp===undefined){var p={"class":"wux-tooltip-shortHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLShortHelp)){p.text=n.shortHelp}else{p.html=n.shortHelp}this.elements.shortHelp=a.createElement("div",p);this.elements.shortHelp.setAttribute("shortHelp",n.shortHelp);this.elements.shortHelp.style.visibility="visible";this.elements.shortHelp.inject(this.elements.container)}if(n.shortHelpImage!==""&&this.elements.shortHelpImage===undefined){this.elements.shortHelpImage=a.createElement("img",{"class":"wux-tooltip-shortHelpImage",src:n.shortHelpImage,width:n.shortHelpImageDimension.x,height:n.shortHelpImageDimension.y});this.elements.shortHelpImage.inject(this.elements.container)}if(n.longHelp!==""&&this.elements.longHelp===undefined){var p={"class":"wux-tooltip-longHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLLongHelp)){p.text=n.longHelp}else{p.html=n.longHelp}this.elements.longHelp=a.createElement("div",p);this.elements.longHelp.setAttribute("longHelp",n.longHelp);this.elements.longHelp.style.display="none";this.elements.longHelp.inject(this.elements.container)}if(n.longHelpImage!==""&&this.elements.longHelpImage===undefined){this.elements.longHelpImage=a.createElement("img",{"class":"wux-tooltip-longHelpImage",src:n.longHelpImage,width:n.longHelpImageDimension.x,height:n.longHelpImageDimension.y});this.elements.longHelpImage.style.display="none";this.elements.longHelpImage.inject(this.elements.container)}if(this.elements.longHelp!==undefined||this.elements.longHelpImage!==undefined){if(this.target.tooltipInfos.shortHelp!==""){var o=this;this.LONG_TO_SHOW_DELAY=setTimeout(function(){if(o.elements.longHelp!==undefined){o.elements.longHelp.style.display="block"}if(o.elements.longHelpImage!==undefined){o.elements.longHelpImage.style.display="block"}o._updateView()},this.target.tooltipInfos.shortToLongDelay)}else{if(this.elements.longHelp!==undefined){this.elements.longHelp.style.display="block"}if(this.elements.longHelpImage!==undefined){this.elements.longHelpImage.style.display="block"}}}if(n._reachableState&&this.elements.moreHelp===undefined){this.elements.container.addClassName("wux-controls-tooltip-reachable");var p={"class":"wux-tooltip-moreHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLTitle)){p.text=c.moreHelp}else{p.html=c.moreHelp}this.elements.moreHelp=a.createElement("div",p);this.elements.moreHelp.setAttribute("moreHelp",c.moreHelp);this.elements.moreHelp.visibility="visible";this.elements.moreHelp.inject(this.elements.container)}}var h=k.inherit({publishedProperties:{},_preBuildView:function(m){this._parent();this._properties.constraint.value="screen";this._properties.autoHide.value=false;this._properties.position.value="bottom";this.elements.container.addClassName("wux-controls-tooltip");this.INTIAL_DELAY_TIMER=null;this.LONG_TO_SHOW_DELAY=null;this.RESHOW_TIMER=null;this.RESHOW_FLAG=false;this._targetRZ=new l();this._tooltipRZ=new l();this._lastShowPosition={x:0,y:0}},show:function(){var o=this.target;if(o&&this.target.tooltipInfos){if(!this.visibleFlag){o.tooltipInfos.setAllPropertiesFromAllInformationCB();if(o.tooltipInfos.shortHelp||o.tooltipInfos.longHelp||o.tooltipInfos.shortHelpImage||o.tooltipInfos.longHelpImage||o.tooltipInfos.title){this.visibleFlag=true}return}if(o.tooltipInfos.position){this.position=o.tooltipInfos.position}if(o.tooltipInfos.mouseRelativePosition){this.offset={x:8,y:8}}else{switch(o.tooltipInfos.position){case"top":this.offset={x:0,y:-1};break;case"bottom":this.offset={x:0,y:1};break;case"left":this.offset={x:-1,y:0};break;case"right":this.offset={x:1,y:0};break;default:this.offset={x:0,y:0};break}}i.call(this);this._parentShow=this._parent;this.mouseRelativePosition=o.tooltipInfos.mouseRelativePosition;var n=this;this.INTIAL_DELAY_TIMER=setTimeout(function(){var q={};q.x=n.mousePosition.x+window.pageXOffset;q.y=n.mousePosition.y+window.pageYOffset;if(n.isPositionInRZ(q,"target")||n.touchMode||n.RESHOW_FLAG){e.call(n)}n.RESHOW_FLAG=true;clearTimeout(n.RESHOW_TIMER);n.RESHOW_TIMER=null},this.RESHOW_FLAG?0:o.tooltipInfos.initialDelay);var m=null;var p=null;if(this.target.getBoundingClientRect){m=this.target.getBoundingClientRect();p=a.extendElement(this.target).getPosition(document.body)}else{if(this.target.getContent()!==undefined){m=this.target.getContent().getBoundingClientRect();p=this.target.getContent().getPosition(document.body)}}this._targetRZ.set(p.x,p.y,p.x+m.width,p.y+m.height);if(o.tooltipInfos.mouseRelativePosition){this._tooltipRZ.set(Math.max(p.x,this._lastShowPosition.x-10),Math.max(p.y,this._lastShowPosition.y-10),this._targetRZ.right,this._targetRZ.bottom)}else{this._tooltipRZ.set(0,0,0,0)}if(b){this._targetRZ._showReachingZone("visual-target-reaching-zone","red");this._tooltipRZ._showReachingZone("visual-old-tooltip-reaching-zone","blue")}}},hide:function(){if(this.visibleFlag){this.visibleFlag=false}else{i.call(this);if(this.target&&this.target.tooltipInfos!==undefined){if(this.RESHOW_FLAG){var m=this;if(this.RESHOW_TIMER!==null){clearTimeout(this.RESHOW_TIMER);this.RESHOW_TIMER=null}this.RESHOW_TIMER=setTimeout(function(){m.RESHOW_FLAG=false},this.target.tooltipInfos.reshowDelay)}this.target=undefined}f.call(this);this._parent();this._targetRZ.reset();this._tooltipRZ.reset();if(b){this._targetRZ._hideReachingZone("visual-target-reaching-zone");this._tooltipRZ._hideReachingZone("visual-old-tooltip-reaching-zone");this._tooltipRZ._hideReachingZone("visual-new-tooltip-reaching-zone")}}},isPositionInRZ:function(o,n,m){if(n==="target"){return this._targetRZ.isPositionInRZ(o,m)}else{if(n==="tooltip"){return this._tooltipRZ.isPositionInRZ(o,m)}}return false},_updateView:function(){if(this.visibleFlag){g.setConstrainedPosition(this,this.target,{position:this.mouseRelativePosition?"bottom":this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,arrowBoxFlag:this.arrowBoxFlag,mouseRelativePosition:this.mouseRelativePosition,mousePosition:this.mousePosition,mouseOffset:{x:-10,y:10}});var p=this.getContent().getBoundingClientRect();var m=undefined;var n=false;if(this.target&&this.target.tooltipInfos){n=this.target.tooltipInfos._reachableState;m=this.target.tooltipInfos.mouseRelativePosition}if(n&&(p.width>0||p.height>0)){var o=g.getOffset(this.getContent());if(m){this._tooltipRZ.set(Math.min(this._tooltipRZ.left,o.left),Math.min(this._tooltipRZ.top,o.top),Math.max(this._tooltipRZ.right,o.left+p.width),Math.max(this._tooltipRZ.bottom,o.top+p.height))}else{this._tooltipRZ.set(o.left,o.top,o.left+p.width,o.top+p.height);this._tooltipRZ.applyOffset(this.offset)}if(b){this._tooltipRZ._showReachingZone("visual-new-tooltip-reaching-zone","green")}}}}});return h});define("DS/Controls/Slider",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Controls/Popup","DS/Utilities/Dom"],function(e,g,f,h,i,b,c,a){var d=g.inherit({name:"slider",markForRecordFlag:true,publishedProperties:{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:100,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:true,recordFlag:true},displayStyle:{defaultValue:"horizontal",type:"string",category:"Appearance"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",},valuePopupFlag:{defaultValue:true,type:"boolean",category:"Appearance"}},blackBoxFlag:true,keymaps:{esc:{keydown:"cancel"}},commands:{cancel:function(){var j=false;if(!this.handleEditionCancel){return{stopPropagation:false}}if(!this.disabled){this.value=this.initialValue;if(this._inEdition){this._inEdition=false;this.fire("cancelEdit")}j=true}return{infos:{actionPerformed:j}}}},initialValue:undefined,buildView:function(){this.elements.container.addClassName("wux-controls-slider");this.elements.container.setAttribute("tabindex",0);this.elements.sliderContainer=e.Element("div",{"class":"wux-controls-abstract wux-controls-slider-container wux-element-contentbox"});this.elements.sliderContainer.inject(this.elements.container);this.elements.sliderBackground=e.Element("div",{"class":"wux-controls-slider-bg wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.sliderBackgroundFilled=e.Element("div",{"class":"wux-controls-slider-bgFilled wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.sliderCursor=e.Element("div",{"class":"wux-controls-slider-cursor wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.spanTooltip=e.Element("span");if(this.valuePopupFlag){if(this.displayStyle==="vertical"){this.elements.popup=new c({arrowBoxFlag:true,overlap:false,target:this.elements.sliderCursor,position:"right"})}else{this.elements.popup=new c({arrowBoxFlag:true,overlap:false,target:this.elements.sliderCursor,position:"top"})}this.elements.popup.getContent().addClassName("wux-slider-tooltip");this.elements.popup.setBody(this.elements.spanTooltip);var j=this;a.onNodeRendered(this.elements.sliderCursor,function(){if(j.elements.popup){j.elements.popup._updateView()}})}this._inEdition=false},_postBuildView:function(){this._applyDisplayStyle()},_applyDisplayStyle:function(){if(this.displayStyle==="vertical"){this.elements.sliderContainer.removeClassName("wux-controls-slider-container");this.elements.sliderBackground.removeClassName("wux-controls-slider-bg");this.elements.sliderBackgroundFilled.removeClassName("wux-controls-slider-bgFilled");this.elements.sliderCursor.removeClassName("wux-controls-slider-cursor");this.elements.sliderContainer.addClassName("wux-controls-slider-vertical");this.elements.sliderBackground.addClassName("wux-controls-slider-bg-vertical");this.elements.sliderBackgroundFilled.addClassName("wux-controls-slider-bgFilled-vertical");this.elements.sliderCursor.addClassName("wux-controls-slider-cursor-vertical");if(this.elements.popup){this.elements.popup.position="right"}}else{this.elements.sliderContainer.addClassName("wux-controls-slider-container");this.elements.sliderBackground.addClassName("wux-controls-slider-bg");this.elements.sliderBackgroundFilled.addClassName("wux-controls-slider-bgFilled");this.elements.sliderCursor.addClassName("wux-controls-slider-cursor");this.elements.sliderContainer.removeClassName("wux-controls-slider-vertical");this.elements.sliderBackground.removeClassName("wux-controls-slider-bg-vertical");this.elements.sliderBackgroundFilled.removeClassName("wux-controls-slider-bgFilled-vertical");this.elements.sliderCursor.removeClassName("wux-controls-slider-cursor-vertical");if(this.elements.popup){this.elements.popup.position="top"}}this._updateCursor()},_applyValuePopupFlag:function(){if(this.elements.popup){if(this.valuePopupFlag){this.elements.popup.show()}else{this.elements.popup.hide()}}},_preEditValue:function(j,l){if(typeof l!=="undefined"&&l!==null&&isNaN(l)){if(this._inEdition){this._inEdition=false;this.fire("cancelEdit")}return false}else{var k=this._getValidatedValue(l);if(k===j){return false}else{if(k!==l){this.value=k;return false}}}},_applyValue:function(j,k){this._updateCursor();if(this.elements.popup){this.elements.spanTooltip.textContent=this.getTextFromValue();this.elements.popup._updateView()}this.fire("change")},_applyMinValue:function(){this._validateValue(this.value)},_applyMaxValue:function(){this._validateValue(this.value)},_applyProperties:function(j){this._parent(j);if(this.isDirty("value")){this._applyValue(j.value,this.value)}if(this.isDirty("disabled")){this._applyDisabled()}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.removeAttribute("tabindex");this.elements.sliderCursor.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.container.setAttribute("tabindex","0");this.elements.sliderCursor.removeAttribute("disabled")}},_giveFocus:function(){this.elements.container.focus()},increment:function(){var j=h.clamp(this.minValue,this.maxValue,this.value+this.stepValue);this.value=j},decrement:function(){var j=h.clamp(this.minValue,this.maxValue,this.value-this.stepValue);this.value=j},_updateCursor:function(){var j=this.getPercentage();var k=j+"%";if(typeof this.value==="undefined"||this.value===null){this.elements.sliderCursor.addClassName("undefined-class")}else{this.elements.sliderCursor.removeClassName("undefined-class");this.elements.sliderBackground.setStyles({borderStyle:"solid"})}if(this.displayStyle==="horizontal"){this.elements.sliderCursor.setStyles({bottom:"",left:k});this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",width:k})}else{this.elements.sliderCursor.setStyles({bottom:k,left:""});this.elements.sliderBackgroundFilled.setStyles({top:100-j+"%",height:k,width:""})}},_getValidatedValue:function(k){var j=undefined;if(typeof k!=="undefined"&&k!==null){j=parseFloat(h.round(k,this.stepValue))}else{j=k}var l=j;if(typeof j!=="undefined"&&j!==null){if(h.isNumber(this.minValue)&&h.isNumber(this.maxValue)){l=h.clamp(this.minValue,this.maxValue,j)}}return l},_validateValue:function(j){var k=this._getValidatedValue(j);if(k!==undefined&&this.value!==k){this.value=k}this._updateCursor()},getTextFromValue:function(){return this.value+""},getPercentage:function(){var j=(this.value-this.minValue)/(this.maxValue-this.minValue)*100;j=j>=0?j:0;j=j<=100?j:100;return j},setPercentage:function(j){this.value=(j/100*(this.maxValue-this.minValue))+this.minValue},handleEvents:function(){var z=this,v=0,u=0,j=0,r=0,y=0,w=0,n=0,p=0,q=z.elements.container,m=z.elements.sliderCursor;function l(){var B=1;if(z.displayStyle==="horizontal"){if(z.elements.popup.position==="top"){B=-1}z.elements.popup.offset.x=-z.elements.popup.getContent().getBoundingClientRect().width/2+m.getBoundingClientRect().width/2;z.elements.popup.offset.y=B*m.getBoundingClientRect().width/2}else{if(z.elements.popup.position==="left"){B=-1}z.elements.popup.offset.y=0;z.elements.popup.offset.x=z.elements.popup.getContent().getBoundingClientRect().width/2}}a.addEventOnElement(this,this.elements.container,"mouseenter",function(B){if(B.buttons===0&&z.value!==undefined&&z.elements.popup&&!z.elements.popup.visibleFlag){z.elements.spanTooltip.textContent=z.getTextFromValue();if(z.valuePopupFlag){z.elements.popup.show();l();z.elements.popup._updateView()}}});a.addEventOnElement(this,this.elements.container,"mouseleave",function(B){if(B.buttons===0&&z.valuePopupFlag){z.elements.popup.hide()}});function x(G){if(z.valuePopupFlag&&z.elements.popup&&!z.elements.popup.visibleFlag){z.elements.popup.show();l();z.elements.popup._updateView()}G.stopPropagation();if(z.disabled){return}var E=document;if(z.getContent()&&z.getContent().ownerDocument){E=z.getContent().ownerDocument}a.addEventOnElement(z,E,f.POINTERMOVE,k);a.addEventOnElement(z,E,f.POINTERUP,t);z.initialValue=z.value;var D=z.elements.sliderContainer;if(z.displayStyle==="horizontal"){v=G.clientX;n=D.clientWidth;var C=G.offsetX;if(G.target===m){C=m.getPosition(D).x}j=h.round(C,1);j=h.clamp(0,n,j);z.fire("beginEdit",{pointerDown:true});z._inEdition=true;if(n!==0&&z.maxValue!==z.minValue){var B=parseFloat(h.round(j/n*(z.maxValue-z.minValue)+z.minValue,z.stepValue));z.setPropertyFromUIInteraction("value",B)}q.focus()}else{u=G.clientY;p=D.clientHeight;var F=u-D.getBoundingClientRect().top;r=h.round(F,1);r=h.clamp(0,p,r);z.fire("beginEdit");z._inEdition=true;if(p!==0&&z.maxValue!==z.minValue){var B=parseFloat(h.round((p-r)/p*(z.maxValue-z.minValue)+z.minValue,z.stepValue));z.setPropertyFromUIInteraction("value",B)}q.focus()}}function A(C){C.preventDefault();C.stopPropagation();var B=document;if(z.getContent()&&z.getContent().ownerDocument){B=z.getContent().ownerDocument}if(!z.disabled&&(z.elements.container===B.activeElement||z.getContent().hasAttribute("focused"))){var D=e.Event.wheelDelta(C);z.fire("beginEdit");z._inEdition=true;(D>0)?z.callMethodFromUIInteraction("increment"):z.callMethodFromUIInteraction("decrement");if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}function k(C){if(!z.disabled){C.preventDefault();if(z.displayStyle==="horizontal"){y=C.clientX-v+j;y=h.clamp(0,n,y);if(n!==0&&z.maxValue!==z.minValue){var B=y/n*(z.maxValue-z.minValue)+z.minValue;z.setPropertyFromUIInteraction("value",B)}}else{w=C.clientY-u+r;w=h.clamp(0,p,h.round(w,1));if(p!==0&&z.maxValue!==z.minValue){z.setPropertyFromUIInteraction("value",(p-w)/p*(z.maxValue-z.minValue)+z.minValue)}}l()}}function t(C){var B=document;if(z.valuePopupFlag&&z.elements.popup&&z.elements.popup.visibleFlag){z.elements.popup.hide()}if(z.getContent()&&z.getContent().ownerDocument){B=z.getContent().ownerDocument}a.removeEventOnElement(z,B,f.POINTERMOVE,k);a.removeEventOnElement(z,B,f.POINTERUP,t);if(!z.disabled){z.initialValue=z.value;C.preventDefault();C.stopPropagation();if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}function o(B){if(!z.disabled&&z.keyDown&&(i.decrease(B.keyCode)||i.increase(B.keyCode))){B.preventDefault();B.stopPropagation();z.keyDown=false;if((B.keyCode!==i.ESCAPE)||(B.keyCode===i.ESCAPE&&B.actionPerformed===true)){if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}}function s(B){if(!z.disabled&&i.decrease(B.keyCode)||i.increase(B.keyCode)){if(!z.keyDown){z.keyDown=true;z.fire("beginEdit");z._inEdition=true}if(i.decrease(B.keyCode)){z.callMethodFromUIInteraction("decrement")}else{z.callMethodFromUIInteraction("increment")}B.preventDefault();B.stopPropagation()}}a.addEventOnElement(this,q,f.POINTERDOWN,x);a.addEventOnElement(this,q,"mousewheel",A);a.addEventOnElement(this,q,"keyup",o);a.addEventOnElement(this,q,"keydown",s)}});b.register(d,"DS/ControlsRec/AbstractRec");return d});define("DS/Decorator/AbstractDecorator",["UWA/Core","DS/Core/PointerEvents","DS/Controls/Abstract","DS/Controls/Popup","DS/Controls/Button","DS/Utilities/Dom"],function(g,b,f,d,c,a){var e=f.inherit({name:"abstractdecorator",publishedProperties:{widget:{defaultValue:null},decoratedWidget:{defaultValue:null}},buildView:function(){this._shouldValidateValue=true},_postBuildView:function(){var h={target:this.decoratedWidget,position:"bottom",offset:{x:0,y:12},alignment:"center",constraint:"screen",overlap:false};this.elements.popup=new d(h);this.elements.popup.setBody(this.elements.container);this.elements.popup.arrowBoxFlag=true;this._applyVisibleFlag()},destroy:function(){this.hide();this._parent()},hide:function(h){this._shouldValidateValue=h;this.visibleFlag=false},show:function(){this.visibleFlag=true},_buildContent:function(){},_onShow:function(){},_onHide:function(h){},_applyVisibleFlag:function(){if(this.visibleFlag){this._onShow();if(this.elements.popup){this.elements.popup.show()}}else{this._onHide(this._shouldValidateValue);if(this.elements.popup){this.elements.popup.hide()}}},_applyProperties:function(h){this._parent(h);if(this.isDirty("decoratedWidget")&&this.elements.popup){this.elements.popup.target=this.decoratedWidget}}});return e});define("DS/Decorator/SpinBoxDecorator",["UWA/Core","DS/Core/PointerEvents","DS/Decorator/AbstractDecorator","DS/Controls/Popup","DS/Controls/Button","DS/Utilities/Dom"],function(d,f,i,b,h,a){var e=function(){this.elements.container.addClassName("wux-keyboard-container");var l=new d.Element("div",{"class":"wux-keyboard-firstline"}).inject(this.elements.container);var j=new d.Element("div",{"class":"wux-keyboard-secondline"}).inject(this.elements.container);var m=new d.Element("div",{"class":"wux-keyboard-thirdline"}).inject(this.elements.container);var k=new d.Element("div",{"class":"wux-keyboard-fourthLine"}).inject(this.elements.container);new h({label:"7"}).inject(m);new h({label:"8"}).inject(m);new h({label:"9"}).inject(m);new h({label:"4"}).inject(j);new h({label:"5"}).inject(j);new h({label:"6"}).inject(j);new h({label:"1"}).inject(l);new h({label:"2"}).inject(l);new h({label:"3"}).inject(l);new h({label:"."}).inject(k);new h({label:"0"}).inject(k);var p=new h({icon:{iconName:"chevron-left",fontIconSize:"0.5x"},value:"back"}).inject(k);p.getContent().addClassName("wux-keyboard-buttonBack");new h({label:"e"}).inject(l);new h({label:"-"}).inject(j);var n=new h({icon:{iconName:"sort-asc",fontIconSize:"0.5x"},value:"up"}).inject(m);n.getContent().addClassName("wux-keyboard-buttonUp");var o=new h({icon:{iconName:"sort-desc",fontIconSize:"0.5x"},value:"down"}).inject(k);o.getContent().addClassName("wux-keyboard-buttonDown")};var g=function(){var j=this;var k=false;this.elements.container.addEventListener(f.POINTERDOWN,function(l){k=j.widget.getContent().hasAttribute("focused")});this.elements.container.addEventListener("buttonclick",function(p){p.preventDefault();p.stopPropagation();var r=j.widget.elements.inputField;var o=r.selectionStart;if(!k){r.selectionStart=r.selectionEnd=r.value.length}if(p.dsModel.value==="up"){j.widget.value=parseFloat(j.widget.elements.inputField.value);j.widget.increment();return}if(p.dsModel.value==="down"){j.widget.value=parseFloat(j.widget.elements.inputField.value);j.widget.decrement();return}var q="",n="";var m=0;if(p.dsModel.value==="back"){if(r.selectionStart!==r.selectionEnd){m=r.selectionStart;q=r.value.substring(0,r.selectionStart);n=r.value.substring(r.selectionEnd,r.value.length)}else{m=r.selectionStart-1;q=r.value.substring(0,r.selectionStart-1);n=r.value.substring(r.selectionStart,r.value.length)}}else{m=r.selectionStart+1;var q=r.value.substring(0,r.selectionStart);var n=r.value.substring(r.selectionEnd,r.value.length);if(n===" "+j.widget.units){n=""}if(r.value==="0"){q="";n=""}if(p.dsModel.label==="."){if(r.value.indexOf(".")===-1){n="."+n}}else{n=p.dsModel.label+n}}r.value=q+n;j.widget._preventUpdateOnNextFocus=true;r.focus();var l=m>0?m:0;r.selectionStart=l;r.selectionEnd=l})};var c=i.inherit({name:"spinboxdecorator",publishedProperties:{},buildView:function(){this._parent();e.call(this)},handleEvents:function(){g.call(this)},_onShow:function(){if(document.activeElement){document.activeElement.blur()}var j=this.widget.elements.inputField;j.setAttributeNode(document.createAttribute("readonly"));j.focus();j.selectionStart=0;j.selectionEnd=j.value.length},_onHide:function(l){var m=this.widget.elements.inputField;m.removeAttribute("readonly");if(!l){var j=m.value;var k=this.widget.lastValueWhenEnter;m.blur();this.widget._preventUpdateOnNextFocus=true;m.focus();m.value=j;this.widget.lastValueWhenEnter=k}if(l===true){if(this.widget._validateValue){this.widget._validateValue(m.value)}}}});return c});define("DS/Controls/ThumbnailView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(b,e,a,g,f,d,i,c){var h=g.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[]},init:function(n){this._parent(n);var o=this;var l=false;var k=false;this._isHighlighted=false;this.elements.icon=new b.Element("div",{"class":"wux-controls-"+this.options.view+"-icon",styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent);this.elements.badgeTopRight=new b.Element("div",{"class":"wux-controls-thumbnail-badge-top-right"}).inject(this.elements.cartoucheContent);this.elements.badgeBottomRight=new b.Element("div",{"class":"wux-controls-thumbnail-badge-bottom-right"}).inject(this.elements.cartoucheContent);this.elements.menu.addEvent("mouseenter",function(q){l=true});this.elements.menu.addEvent("mouseleave",function(q){l=false});var j;this.elements.cartouche.addEvent("mouseenter",function(q){k=true});this.elements.cartouche.addEvent("mouseleave",function(q){k=false;o.elements.container.removeClassName("wux-ui-state-active")});this.elements.cartouche.addEvent("mousemove",function(q){clearTimeout(j);if(q.target!==o.elements.menu&&!o.elements.container.hasClassName("wux-ui-state-active")){o.elements.container.removeClassName("wux-ui-state-active")}j=setTimeout(function(){if(!l){if(k&&q.target!==o.elements.menu){o.elements.container.addClassName("wux-ui-state-active")}else{clearTimeout(j);o.elements.container.removeClassName("wux-ui-state-active")}}},20)});this.elements.checkbox=new i({checkFlag:false,disabled:false}).inject(this.elements.picture);this.elements.checkbox.getContent().addClassName("wux-controls-thumbnail-checkbox wux-ui-size-"+this.options.size);var o=this;this.elements.container.addEvent("mouseenter",function(q){if(!o.isPreHighlighted){o.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted");o.isPreHighlighted=true}});this.elements.container.addEvent("mouseleave",function(q){if(o.isPreHighlighted){o.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted");o.isPreHighlighted=false}});this.elements.checkbox.addEventListener(d.POINTERDOWN,function(q){q.stopPropagation()});this.elements.checkbox.addEventListener(d.POINTERUP,function(q){q.stopPropagation()});this._listenToChanges=true;this.elements.checkbox.addEventListener("change",function(q){if(o._listenToChanges){if(!o.isHighlighted()){o.highlight()}else{o.unhighlight()}}});if(!n||!n.gridEngine){var m=this.options.onContextualEvent;if(m){f.addEventListener(this.elements.container,{callback:function(q){return m.callback.call(m["this"],{context:q.context,infos:q.info,data:q.data,})}});var p=this.elements.menu;this.elements.menu.addEventListener(d.POINTERUP,function(r){var q=document.createEvent("HTMLEvents");q.initEvent("contextmenu",true,false);q.pageX=r.pageX;q.pageY=r.pageY;p.dispatchEvent(q)})}}this._attachEvents()},setIcon:function(j){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-"+this.options.view+"-icon");if(j){c.generateIcon(j,{target:this.elements.icon})}else{this.elements.icon.empty()}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==true){this._listenToChanges=false;this.elements.checkbox.checkFlag=true;this._listenToChanges=true}},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==false){this._listenToChanges=false;this.elements.checkbox.checkFlag=false;this._listenToChanges=true}},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}});return h});define("DS/Controls/ThumbnailCellView",["UWA/Core","DS/Controls/ThumbnailView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/Utilities/Dom"],function(c,i,a,j,e,f,g,d){function h(k){return k.charAt(0).toUpperCase()+k.slice(1)}var b=a.extend({defaultOptions:{size:"small",menu:[]},init:function(l){var n=l.menu;l.menu=[];this._CtxMenuByRightClick=true;this._parent(l);this.elements.container.setStyles({border:"none"});this.elements.container.setAttribute("draggable","true");this.elements.container.dsView=this;this._view=new i(this.options).inject(this.elements.container);this._view.elements.menu.cellView=this;var m=this;this._view.elements.checkbox.addEventListener(e.POINTERDOWN,function(o){o.stopPropagation()},true);this._view.elements.checkbox.addEventListener(e.POINTERUP,function(o){o.stopPropagation()});this._view.elements.checkbox.addEventListener("click",function(o){if(m.getGridEngine()&&m.getGridEngine()._isTouchWithatCellHover===true){m.getGridEngine()._isTouchWithatCellHover=false;o.stopPropagation();m.getGridEngine()._enableInteractiveMultiSelMode()}},true);this._view._listenToChanges=true;this._view.elements.checkbox.addEventListener("change",function(p){if(m._view._listenToChanges){var o=m.getGridEngine();var q=m.getCellInfos();if(o&&q){o._enableInteractiveMultiSelMode();if(q.cellModel.isSelected()){q.cellModel.unselect()}else{if(!o.options.selection.canMultiSelect){o.options.TreedocModel.getXSO().empty()}q.cellModel.select()}o.options.lastSelectedNode=q.cellModel}}});this.setupContextualMenu(n);var k=this.getGridEngine().options.onContextualEvent;if(k){this._view.elements.menu.addEventListener(e.POINTERUP,function(r){r.preventDefault();var t=this;var q=t.cellView;m._CtxMenuByRightClick=false;if(e.isTouchEvent(r)){if(q.getGridEngine()._preventSelectionForTouchScroll){return}}var s=q.getCellInfos();if(s){var u=s.nodeModel;if(u&&!u.isSelected()){u.select(true);q.getGridEngine().setActiveNode(u,true)}}var o=q.getGridEngine().options.onContextualEvent;if(o){var p=document.createEvent("HTMLEvents");p.initEvent("contextmenu",true,false);p.pageX=r.pageX;p.pageY=r.pageY;t.dispatchEvent(p)}m._CtxMenuByRightClick=true;r.stopPropagation()})}else{this._view.elements.menu.addEventListener(e.POINTERDOWN,function(p){var r=this;var o=r.cellView;m._CtxMenuByRightClick=false;var q=o.getCellInfos();j.show(o._view.elements.container,[p.pageX,p.pageY]);m._CtxMenuByRightClick=true;if(q.cellModel.isSelected()){p.stopPropagation()}})}},setupContextualMenu:function(p){var o=this;var l=this.getGridEngine().options.onContextualEvent;if(l){f.addEventListener(this.elements.container,{callback:function(r){if(o.getGridEngine()){o.getGridEngine()._cellCtxMenuRequired=true;if(o._CtxMenuByRightClick===true){var q=o.getCellInfos();if(q){var s=q.nodeModel;if(s&&!s.isSelected()){s.select(true);o.getGridEngine().setActiveNode(s,true)}}}}return l.callback.call(l["this"],{context:o,menuContext:r.context,infos:r.info,data:r.data,cellInfos:o.getCellInfos()})}})}else{var n=this.getGridEngine().options.onContextualMenuReady;var k=n;if(typeof n==="function"){k=function(){var q=o.getCellInfos();if(q&&o._CtxMenuByRightClick===true){var r=q.nodeModel;if(r&&!r.isSelected()){r.select(true);o.getGridEngine().setActiveNode(r,true)}}return n.call(o,q)}}var m=p?p.length:0;if(m===0){j.forget({target:this._view.elements.container,nodes:k});j.onReady({target:this._view.elements.container,nodes:k})}else{j.onReady({target:this._view.elements.container,context:this,nodes:p})}}},updateInternalParameters:function(){this.setColor();this.setTitle();this.setSubtitle();this.setDescription();this.unhighlight();this.deactivate();this.unsetBadges()},setTitle:function(k){this._view.setTitle(k);if(!this.getGridEngine()||(this.getGridEngine()&&typeof this.getGridEngine().getShouldDisplayTooltipFlag==="function"&&this.getGridEngine().getShouldDisplayTooltipFlag()===true)){this.elements.container.title=k}},setColor:function(k){this._view.setColor(k)},setIcon:function(k){this._view.setIcon(k)},setSubtitle:function(k){this._view.setSubtitle(k)},setDescription:function(k){this._view.setDescription(k)},setPicture:function(k){this._view.setPicture(k)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var k=this._parent();var l=this.getVirtualCoordinates();k.nodeModel=this.getGridEngine().getCellModel(l.virtualRowID,l.virtualColumnID);return k},setPictureBackgroundSize:function(k){if(this._view&&this._view.elements.picture){this._view.elements.picture.setStyle("background-size",k)}},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="";this._view.elements.badgeTopRight.style.visibility="hidden";this._view.elements.badgeTopRight.className="";this._view.elements.badgeTopRight.addClassName("wux-controls-thumbnail-badge-top-right");this._view.elements.badgeBottomRight.style.backgroundImage="";this._view.elements.badgeBottomRight.style.visibility="hidden";this._view.elements.badgeBottomRight.className="";this._view.elements.badgeBottomRight.addClassName("wux-controls-thumbnail-badge-bottom-right")},setBadges:function(k){for(var m in k){var l=k[m];if(l){d.generateIcon(l,{target:this._view.elements["badge"+h(m)]});this._view.elements["badge"+h(m)].style.visibility="visible"}}}});return b});define("DS/Controls/ColoredSlider",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Color","DS/Controls/Slider"],function(f,e,c,b){var a=b.inherit({name:"coloredSlider",publishedProperties:{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:255,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},colorFrom:{defaultValue:"#000",type:"string",category:"Appearance"},colorTo:{defaultValue:"#fff",type:"string",category:"Appearance"}},buildView:function(){this._parent();this.elements.sliderTransparentBackground=f.Element("div",{"class":"wux-controls-slider-transparent"}).inject(this.elements.sliderContainer,"top");this.elements.sliderCursorInternalColor=f.Element("div",{"class":"wux-controls-slider-cursor-color"}).inject(this.elements.sliderCursor);this.elements.container.addClassName("wux-controls-colorslider")},handleEvents:function(){this._parent()},_applyColorFrom:function(){this._updateBackground();this._updateCursor()},_applyColorTo:function(){this._updateBackground();this._updateCursor()},_updateBackground:function(){this.colorFrom=d(this.colorFrom);this.colorTo=d(this.colorTo);var h="linear-gradient(";var g=(this.displayStyle==="horizontal")?"to right":"to top";h+=g+", "+this.colorFrom+", "+this.colorTo+")";this.elements.sliderBackground.setStyle("background",h)},_applyDisplayStyle:function(){this._parent();this._updateBackground()},_updateCursor:function(){this._parent();var h=this.getPercentage()/100;var g;var j=this.colorFrom;var i=this.colorTo;if(j==="transparent"){j="#fff";this.elements.sliderCursorInternalColor.setStyle("opacity",h)}if(i==="transparent"){i="#fff";this.elements.sliderCursorInternalColor.setStyle("opacity",1-h)}g=c.lerpColorHex(j,i,h);this.elements.sliderCursor.setStyle("background-position-x",200*h+"px, 0px");this.elements.sliderCursorInternalColor.setStyle("background-color","#"+g)}});function d(g){if(g==="transparent"){return g}if(typeof g!=="string"){return"#000"}if(g.charAt(0)==="#"){g=g.substr(1)}if(g.length===3){g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]}return(g.length===6)?"#"+g:"#000"}return a});define("DS/Tweakers/TweakerNumber",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerRange","DS/Controls/SpinBox","DS/Controls/Slider","DS/Controls/ProgressBar","DS/Controls/ColoredSlider","DS/Utilities/KeyboardUtils","DS/Utilities/Dom"],function(f,j,g,l,i,d,k,o,b){var h=g.inherit({name:"tweakerNumber",publishedProperties:{decimals:{defaultValue:5,type:"number"},units:{defaultValue:"",type:"string"},colorFrom:{defaultValue:"#000",type:"string"},colorTo:{defaultValue:"#fff",type:"string"},displayStyle:{defaultValue:"spinBox",type:"string"},value:{defaultValue:0,type:"number",advancedSetter:true,recordFlag:true},valueType:{defaultValue:"number",type:"string"},minValue:{defaultValue:undefined,type:"number"},maxValue:{defaultValue:undefined,type:"number"},stepValue:{defaultValue:0.1,type:"number"},referenceValue:{defaultValue:undefined,type:"number"}},_applyDecimals:function(p){if(this.elements._viewModule&&this.elements._viewModule.setDecimals){this.elements._viewModule.setDecimals(this.decimals)}},_applyUnits:function(p){this._suffix=this.units;if(this.elements._viewModule&&this.elements._viewModule.setSuffix){this.elements._viewModule.setSuffix(this.units)}},_applyColorFrom:function(){if(this.elements._viewModule&&this.elements._viewModule.setColorFrom){this.elements._viewModule.setColorFrom(this.colorFrom)}},_applyColorTo:function(){if(this.elements._viewModule&&this.elements._viewModule.setColorTo){this.elements._viewModule.setColorTo(this.colorTo)}},_applyProperties:function(p){this._parent(p);if(this.isDirty("decimals")){this._applyDecimals(p.decimals)}if(this.isDirty("units")){this._applyUnits(p.units)}if(this.isDirty("colorFrom")){this._applyColorFrom(p.colorFrom)}if(this.isDirty("colorTo")){this._applyColorTo(p.colorTo)}},_upgradeValue:function(r){if(r===undefined||r===null){return r}else{if(r instanceof Array){return undefined}else{if(typeof(r)==="string"){var p=parseFloat(r);if(isNaN(p)){return undefined}else{return p}}}}var q=Number(r);if(j.equalsToNaN(q)){return undefined}return q}});var c=function(q,p){g.prototype.baseViewModule.call(this,q,p)};j.applyMixin(c,g.prototype.baseViewModule);c.prototype.setDecimals=function(p){};c.prototype.setSuffix=function(p){};c.prototype.setColorFrom=function(p){};c.prototype.setColorTo=function(p){};var m=function(q,p){c.call(this,q,p)};j.applyMixin(m,c);m.prototype.buildView=function(){var p=this._options.viewOptions||{};p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.pageStepValue=this._tweaker.stepValue*10;p.decimals=this._tweaker.decimals;p.units=this._tweaker.units;p.touchMode=this._tweaker._getCurrentTouchMode();p.selectAllOnFocus=true;p.fireOnlyFromUIInteractionFlag=true;this._view=new l(p);b.addEventOnElement(this,this._view,"preValidateValue",function(q){q.stopPropagation()});this.setValue(this._tweaker.value)};m.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r||r.readOnly){return}b.addEventOnElement(r,p,"beginEdit",function(s){s.stopPropagation();r.onPreEdit(null,"beginEdit")});b.addEventOnElement(r,p,"uncommittedChange",function(s){s.stopPropagation()});b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});b.addEventOnElement(r,p,"endEdit",function(s){s.stopPropagation();r.onPostEdit(null,"endEdit")});p.addEventListener("focus",function(s){s.stopPropagation()})};m.prototype.setValue=function(r){var s=this._tweaker;var p=this._view;if(!p||!s){return}var q=parseFloat(r);if(isNaN(q)){this._view.value=undefined}else{this._view.value=q}};m.prototype.setReadOnly=function(p){if(this._view){this._view.destroy();this._view=undefined}this.buildView();this.handleEvents();this.inject(this._tweaker.getContent());this._tweaker.elements.internalView=this._view};m.prototype.setDecimals=function(p){if(!this._view){return}this._view.decimals=p};m.prototype.setSuffix=function(p){if(!this._view||!this._tweaker){return}this._view.units=p};var n=function(q,p){c.call(this,q,p)};j.applyMixin(n,c);n.prototype.buildView=function(){var p=this._options.viewOptions||{};p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.touchMode=this._tweaker._getCurrentTouchMode();p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new i(p);this.setValue(this._tweaker.value)};n.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r||r.readOnly){return}b.addEventOnElement(r,p,"beginEdit",function(s){s.stopPropagation();r.onPreEdit(null,"beginEdit")});b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});b.addEventOnElement(r,p,"endEdit",function(s){s.stopPropagation();r.onPostEdit(null,"endEdit")});b.addEventOnElement(r,p,"keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit();r.onPreEdit(null,"cancelEdit-preEdit")}})};n.prototype.setValue=function(q){var p=this._view;if(!p){return}this._view.value=q};var e=function(q,p){n.call(this,q,p)};j.applyMixin(e,n);e.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.colorFrom=this._tweaker.colorFrom;p.colorTo=this._tweaker.colorTo;p.minValue=this._tweaker.minValue;p.maxValue=this._tweaker.maxValue;p.stepValue=this._tweaker.stepValue;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new k(p);this.setValue(this._tweaker.value)};e.prototype.setValue=function(r){var s=this._tweaker;var p=this._view;if(!p||!s){return}var q=parseFloat(r);if(isNaN(q)){this._view.value=undefined}else{this._view.value=q}};e.prototype.setColorFrom=function(p){if(!this._view||!this._tweaker||this._tweaker.readOnly){return}this._view.colorFrom=p};e.prototype.setColorTo=function(p){if(!this._view||!this._tweaker||this._tweaker.readOnly){return}this._view.colorTo=p};var a=function(q,p){c.call(this,q,p)};j.applyMixin(a,c);a.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.fireOnlyFromUIInteractionFlag=true;this._view=new d(p);this.setValue(this._tweaker.value)};a.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;if(!p||!r){return}b.addEventOnElement(r,p,"change",function(s){s.stopPropagation();q.setTweakerValue(p.value)})};a.prototype.setValue=function(q){var p=this._view;if(!p){return}this._view.value=q};h.prototype.baseViewModule=c;h.prototype.VIEW_MODULES={spinBox:{classObject:m},slider:{classObject:n},progress:{classObject:a},progress_readOnly:{classObject:a},colorSlider:{classObject:e}};h.prototype.registerViewModule=function(p,q){return;if(!p||!q||!q.classObject&&!q.classPath){return}if(h.prototype.VIEW_MODULES[p]!==undefined){return}h.prototype.VIEW_MODULES[p]=q};return h});define("DS/TreeModel/TreeNodeModelProxy",["DS/TreeModel/TreeNodeModel","DS/Utilities/Array"],function(f,d){function e(g){f.call(this,g)}e.prototype=Object.create(f.prototype);e.prototype.constructor=e;var a;e.setCurrentContext=function(g){if(g){a=g.document}};function c(j){var m=this.getTreeDocument();var l;if(m&&m.options){l=m.options.proxy}if(l!==undefined){var h=l.options;var g=l.type;var k=e[g];if(k){var i=k[j];if(i){return i.call(this)}}}return f.prototype[j].call(this)}function b(j){var m=this.getTreeDocument();var l;if(m&&m.options){l=m.options.proxy}if(l!==undefined){var h=l.options;var g=l.type;var k=e[g];if(k){var i=k[j];if(i){return i.call(this,h)}}}return f.prototype[j].call(this)}e.prototype.isRoot=function(){return c.call(this,"isRoot")};e.prototype._isTrueRoot=function(){return b.call(this,"_isTrueRoot")};e.prototype.getTreeDocument=function(){if(a){return a}if(this._treeDocument){return this._treeDocument}else{var g=this.getParent();if(g!==undefined){return g.getTreeDocument()}}};e.prototype.addChild=function(i,j){var h;if(i instanceof Array){h=this._loadModel(i,this)}else{if(i instanceof f){var g=i.getParent();if(g){g.removeChild(i)}}h=this._loadModel([i],this,j)}return h};e.prototype.getNodeDepth=function(){return c.call(this,"getNodeDepth")};e.prototype.getParents=function(i){var g=this;var h=[];while(g){g=g.getParent();if(g&&(i||!g._isTrueRoot())){h.push(g)}if(g&&g._isTrueRoot()){g=undefined}}return h};e.SUBSET={isRoot:function(){return this.getParent()._isTrueRoot()},_isTrueRoot:function(g){return(this===g.target)},getNodeDepth:function(){return this.getParents().length}};e.FLATTEN={getNodeDepth:function(){return 0},getChildren:function(){if(this._isTrueRoot()){return this.getAllDescendants()}else{return[]}}};return e});define("DS/TreeModel/StringRegExpFilter",["DS/TreeModel/BaseFilter"],function(a){var b=a.inherit({name:"stringregexpfilter",publishedProperties:{},isDataFiltered:function(g){var h=(g.options&&g.options.getAttributeValueForFiltering)?g.options.getAttributeValueForFiltering(this.propertyId):g.getAttributeValue(this.propertyId);var e=this.filterModel;if(!e||!e.condition1){return false}var c=function(j){if(!j||j.filter===""){return true}var i=undefined;switch(j.type){case"startsWith":i=new RegExp("^"+j.filter,"i");break;case"endsWith":i=new RegExp(j.filter+"$","i");break;case"contains":i=new RegExp(j.filter,"i");break}if(!i){return true}return i.test(h)};var d=c(e.condition1);if(!e.operator){return !d}else{if(e.operator==="or"&&d){return false}else{if(e.operator==="and"&&!d){return true}}}var f=c(e.condition2);return !f},isEmpty:function(){return !this.filterModel||!this.filterModel.condition1||this.filterModel.condition1.filter===""}});return b});define("DS/Controls/Accordeon",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Css","DS/Core/PointerEvents","DS/Controls/Expander","DS/Utilities/Dom"],function(d,k,f,h,b,c,e,i,a){var g="EVT_CHANGE";var j=f.inherit({name:"accordeon",publishedProperties:{items:{defaultValue:[],type:"array",category:"Behavior"},exclusive:{defaultValue:true,type:"boolean",category:"Behavior"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"}},_accordeonClass:"wux-controls-accordeon",buildView:function(){var l=this;this.elements.container.addClassName(this._accordeonClass+"-container");this._expanderItems=[]},handleEvents:function(){var n=this;var m,o;a.addEventOnElement(this,document,e.POINTERUP,function(p){clearTimeout(o);clearInterval(m)});this._applyExclusive();function l(p){if(p.dsModel===n){return}p.stopImmediatePropagation();if(p.dsModel){n._expanderItems.every(function(r,q){if(r===p.dsModel){n.fire(p.type,{expanderIndex:q,expanderTarget:r});return false}else{return true}})}}this.addEventListener("expand",l);this.addEventListener("collapse",l)},_applyProperties:function(l){this._parent(l);this._applyItems();this._applyStyle()},_applyTouchMode:function(){var l=this._getCurrentTouchMode();if(l===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}for(var m=0;m<this._expanderItems.length;m++){this._expanderItems[m].touchMode=l}},_applyDisabled:function(){for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].disabled=this.disabled}},_applyItems:function(){var m=this;for(var l=m._expanderItems.length;l>=0;l--){if(this._expanderItems[l]){this._expanderItems[l].remove()}this._expanderItems.splice(l,1)}m.items.forEach(function(n){m._addItem(n)})},_applyExclusive:function(){var m=this;for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].elements.header.addEvent(e.POINTERUP,function(o){for(var n=0;n<m._expanderItems.length;n++){if(m._expanderItems[n].elements.container.attributes&&m._expanderItems[n].elements.header!=this){if(m.exclusive&&m._expanderItems[n].expandedFlag===true){m._expanderItems[n].close()}}}})}},_applyStyle:function(){for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].style=this.style}},addItem:function(l){this.items.push(l);return this._addItem(l)},_addItem:function(l){this.elements.expander=new i({header:l.header,body:l.body?l.body:l.content,icon:l.icon,customHeader:l.customHeader,style:this.style,recId:l.recId,touchMode:this._getCurrentTouchMode()}).inject(this.elements.container);var m=this._getFirstUnusedID();this.elements.expander._expanderId=m;this.elements.expander.elements.container.attributes.identifier=m;this._expanderItems.push(this.elements.expander);if(this.exclusive){this._applyExclusive()}if(l.expandedFlag){this.expandItem(this.getIndexFromId(m))}return m},deleteItem:function(l){if(this._expanderItems[l]){this._expanderItems[l].remove()}this._expanderItems.splice(l,1);this.items.splice(l,1)},_getFirstUnusedID:function(){var n=[];for(var m=0;m<this._expanderItems.length;m++){n[this._expanderItems[m]._expanderId]=1}for(var l=0;l<n.length;l++){if(n[l]!==1){return l}}return n.length},updateItem:function(l,n){var m=this.items[l];if(m){m.header=n.header||m.header;m.body=n.body||m.body;m.icon=n.icon||m.icon;m.customHeader=n.customHeader||m.customHeader}var o=this._expanderItems[l];if(o){o.setProperties(m)}},expandItem:function(l){if(this.exclusive){for(var m=0;m<this._expanderItems.length;m++){if(l!=m){if(this._expanderItems[m].expandedFlag===true){this._expanderItems[m].close()}}}}this._expanderItems[l].expand()},closeItem:function(l){this._expanderItems[l].close()},clear:function(){while(this.items.length>0){this.deleteItem(0)}},getIndexFromId:function(m){for(var l=0;l<this._expanderItems.length;l++){if(this._expanderItems[l]._expanderId===m){return l}}return -1},getExpanderFromIndex:function(l){return this._expanderItems[l]}});return j});define("DS/Tree/AccordionMdlView",["DS/Controls/Abstract","DS/Controls/Accordeon","DS/TreeModel/TreeNodeModel",],function(g,e,f){function b(j){for(var h=0;h<this.length;h++){if(this[h].nodeModel===j){return{index:h,item:this[h]}}}}function d(j){for(var h=0;h<this.length;h++){if(this[h].id===j){return this[h]}}}function a(h){if(this._accordion){var i=this._accordion.addItem({header:h.options.label,icon:(h.options.icons&&h.options.icons.length>0)?h.options.icons[0]:undefined});this._nodesModel.push({id:i,nodeModel:h})}}var c=g.inherit({name:"AccordionMdlView",_accordion:undefined,_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"}},buildView:function(){this._parent();this._accordion=new e({exclusive:false});this._accordion.inject(this.elements.container)},_applyModel:function(){var j=this;if(!j._accordion){return}j._accordion.clear();j._nodesModel=[];if(j.model){var h=(j.model.getChildren()&&j.model.getChildren().length>0)?j.model.getChildren():j.model.options.asyncChildren;if(h&&h.length>0){h.forEach(function(k){a.call(j,k)})}var i=j.model?(j.model._treeDocument||j.model.getTreeDocument()):undefined;if(i){i.onNodeModelUpdate(function(k){if(!k||!k.target||!k.target.options||!k.target.options.grid){return}var n=b.call(j._nodesModel,k.target);if(n&&n.item&&j._accordion){var m=k.target.options;var l=j._accordion.getIndexFromId(n.item.id);if(l>-1){j._accordion.updateItem(l,{header:m.label,icon:(m.icons&&m.icons.length>0)?m.icons[0]:undefined,})}}});i.onPostExpand(function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.expandItem(l)}}});i.onPostCollapse(function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.closeItem(l)}}});i._bindEventOnDocument("addChild",function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}a.call(j,k.data.nodeModel)});i._bindEventOnDocument("removeChild",function(k){if(!k||!k.data||!k.data.nodeModel||!k.parent||k.parent._nodeDepth!==j._modelDepth-1){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.deleteItem(l)}j._nodesModel.splice(m.index,1)}})}}},_applyStyle:function(h){this._accordion.style=this.style},_applyProperties:function(h){this._parent(h);if(this.isDirty("model")){this._applyModel()}},setContent:function(k,j){var i=b.call(this._nodesModel,k);if(i&&i.item&&this._accordion){var h={body:j};this._accordion.updateItem(this._accordion.getIndexFromId(i.item.id),h)}},handleEvents:function(){var i=this;function h(j){return function(l){if(l&&l.target&&l.target.dsModel&&l.options&&l.options.expanderIndex>-1&&!i._lockUpdate){var k=d.call(i._nodesModel,l.options.expanderIndex);if(k&&k.nodeModel){k.nodeModel[j]()}}}}i.elements.container.addEventListener("expand",h("expand"));i.elements.container.addEventListener("collapse",h("collapse"))}});return c});define("DS/Tree/commands/TreeListViewCommands",["DS/Utilities/Dom"],function(a){return{"treelistview:collapse-all-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===true){this._keymapManager.wait();d._modelEvents.subscribe({event:"postCollapseAll"},function(){c._keymapManager.listen()});d.collapseAll()}},"treelistview:expand-all-node":function(b){var d=this.getActiveNode();var c=this;if(d.isExpanded()===false){this._keymapManager.wait();d.expandAll({onExpandComplete:function(){c._keymapManager.listen()}})}},"treelistview:expand-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===false){this._keymapManager.wait();d.onPostExpand(function(){c._keymapManager.listen()});d.expand()}},"treelistview:collapse-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===true){this._keymapManager.wait();d.onPostCollapse(function(){c._keymapManager.listen()});d.collapse()}},"treelistview:toggle-selection":function(b){var c=this;var d=this.getActiveNode();if(d){d.selectionChangeIsFromUI();d.withTransactionUpdate(function(){var e=c.getNodesXSO();if(e.isIn(d)){e.remove(d)}else{e.add(d)}})}},"treelistview:edit-label":function(b){var e=this.getActiveNode();var c=this;var d=c._getCellView(e._getRowID(),"tree");if(d){d.switchToWriteView()}},"treelistview:edit-cancel":function(b){var c=this;if(c._listOfEditedCells.length>0){c._listOfEditedCells[0].cellView._cancelChanges()}c._giveFocus(true)},"treelistview:go-to-next-cell-and-focus":function(){var e=this;var d=e._keymapManager._getCurrentEvent();if(d){d.preventDefault();console.log("prevent default tab")}var b=a.firstParentWithClass(document.activeElement,"wux-datagrid-cell");if(b){var f=b.dsView.getCellInfos();var c=function(n){var j=e.getNumberOfColumns();var g=n.virtualRowID*j+n.virtualColumnID+1;var l=Math.floor(g/j);var i=g%j;console.log("-");console.log("current cell in focus",n.virtualRowID,n.virtualColumnID);console.log("next cell in focus",g,":",l,i);var k=e._getCellView2(l,i);var h=e.getCellPosition(l,i);if(k){var m=k.getContent().querySelector(".wux-controls-abstract");if(m){console.log("-->",m);m.dsModel._giveFocus()}else{console.log("-->",k.elements.container);k.getContent().focus()}if(a.firstParentWithClass(document.activeElement,"wux-datagrid-cell")===b){c({virtualRowID:l,virtualColumnID:i})}}console.log("next cell in focus",document.activeElement)};c(f)}else{console.log("no cell")}},"treelistview:select-all":function(){this.selectAllVisibleNodes();return{preventDefault:true}},"treelistview:unselect-all":function(){this.unselectAll();return{preventDefault:true}},"treelistview:go-to-last-visible-node":function(){var d=this;var p=d._keymapManager._getCurrentEvent();var b=d.getNodesXSO();var m=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){m=true}if(p.shiftKey){o=true}}var e=d.getActiveNode();var f=d.getScroller();var q=d.getCellsContainerSize();var k,l;d.prepareUpdateView();k=o?d._activeNodeAtShift:e;while(k){l=k;k=k.getNextVisibleNode();if(o===true){b.add(l)}}if(o){var i=[];var n=e._getRowID();var j=l._getRowID();var c=d._activeNodeAtShift._getRowID();var h=((j-c)*(n-c)<=0)?e:undefined;var g=undefined;while(h&&h!==d._activeNodeAtShift){g=h;if(g&&g.isSelected()&&h!==l){i.push(g)}if(n>j){h=h.getPreviousVisibleNode()}else{h=h.getNextVisibleNode()}}if(i.length>0){b.remove(i)}}if(o===false&&m===false){b.empty()}if(m===false){b.add(l)}d.setActiveNode(l);if(!o){d._activeNodeAtShift=l}d.pushUpdateView();f.getContent().scrollTop=q.height},"treelistview:go-to-first-visible-node":function(){var d=this;var p=d._keymapManager._getCurrentEvent();var b=d.getNodesXSO();var m=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){m=true}if(p.shiftKey){o=true}}var e=d.getActiveNode();var f=d.getScroller();var k,l;d.prepareUpdateView();k=o?d._activeNodeAtShift:e;while(k){l=k;k=k.getPreviousVisibleNode();if(o===true){b.add(l)}}if(o){var i=[];var n=e._getRowID();var j=l._getRowID();var c=d._activeNodeAtShift._getRowID();var h=((j-c)*(n-c)<=0)?e:undefined;var g=undefined;while(h&&h!==d._activeNodeAtShift){g=h;if(g&&g.isSelected()&&h!==l){i.push(g)}if(n>j){h=h.getPreviousVisibleNode()}else{h=h.getNextVisibleNode()}}if(i.length>0){b.remove(i)}}if(o===false&&m===false){b.empty()}if(m===false){b.add(l)}d.setActiveNode(l);if(!o){d._activeNodeAtShift=l}d.pushUpdateView();f.getContent().scrollTop=0},"treelistview:go-to-next-page-node":function(){var f=this;var p=f._keymapManager._getCurrentEvent();var e=f.getNodesXSO();var n=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){n=true}if(p.shiftKey){o=true}}var g=f.getActiveNode();var i=f.getScroller();var j=f.getViewportDimensions();var d=f.getCellsContainerSize().width>j.width?20:0;var l,m,k,h,b;f.prepareUpdateView();l=g;if(o===false&&n===false){e.empty()}k=g._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);var c=j.height-(h+b-f.getScrollerPosition().y);if(c<b){c=j.height}while(c>0&&l){m=l;l=l.getNextVisibleNode();if(l){k=l._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);c=c-b;if(o===true){if(l._getRowID()>f._activeNodeAtShift._getRowID()){e.add(m)}else{e.remove(m)}}}}k=m._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);if(n===false){e.add(m)}f.setActiveNode(m);if(!o){f._activeNodeAtShift=m}f.pushUpdateView();i.getContent().scrollTop=h-j.height+b+d+4},"treelistview:go-to-previous-page-node":function(){var f=this;var p=f._keymapManager._getCurrentEvent();var e=f.getNodesXSO();var n=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){n=true}if(p.shiftKey){o=true}}var g=f.getActiveNode();var i=f.getScroller();var j=f.getViewportDimensions();var d=f.getCellsContainerSize().width>j.width?20:0;var l,m,k,h,b;f.prepareUpdateView();l=g;console.log("active node is ",l.getLabel());if(o===false&&n===false){e.empty()}k=g._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);var c=(h-f.getScrollerPosition().y);if(c<b){c=j.height}while(c>=0&&l){m=l;l=l.getPreviousVisibleNode();if(l){k=l._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);c=c-b;if(o===true){if(l._getRowID()<f._activeNodeAtShift._getRowID()){e.add(m)}else{e.remove(m)}}}}k=m._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);if(n===false){e.add(m)}f.setActiveNode(m);if(!o){f._activeNodeAtShift=m}f.pushUpdateView();i.getContent().scrollTop=h},"treelistview:go-to-next-node":function(c){var e=this.getActiveNode();var d=this;if(e){if(e.getChildren()){if(!e.isExpanded()){this._keymapManager.wait();e.onPostExpand(function(){d._keymapManager.listen()});e.expand()}else{var b=e.getNextVisibleNode();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}}else{var b=e.getNextVisibleNode();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}}},"treelistview:go-to-previous-parent-node":function(c){var e=this.getActiveNode();var d=this;if(e){if(e.isExpanded()){d._keymapManager.wait();e.onPostCollapse(function(){d._keymapManager.listen()});e.collapse();var f=d._shouldBeSelected(e);if(f){d.getNodesXSO().unique(e)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(e)}else{if(!e.isRoot()){var b=e.getParent();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}else{d._goToNode(e,-1)}}}},"treelistview:go-to-previous-visible-node":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,-1)},"treelistview:go-to-next-visible-node":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,+1)},"treelistview:go-to-previous-visible-node-no-empty-xso":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,-1,1)},"treelistview:go-to-next-visible-node-no-empty-xso":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,+1,1)}}});define("DS/Controls/ResponsiveTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(c,f,d,e,a,b,g,j){var i=190;var h=540;var k=d.inherit({name:"ResponsiveTileView",markForRecordFlag:true,publishedProperties:{tileWidth:{defaultValue:260,type:"integer",category:"Behavior"}},buildView:function(){this._modelEvents=new b();this._isHighlighted=false;var n=this;this.elements.container=new c.Element("div",{"class":"wux-controls-responsivetileview"});this.elements.container.setAttribute("has-picture","false");this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("has-statusbar-content","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new c.Element("div",{"class":"wux-controls-highlightborder"}).inject(this.elements.container);this.elements.activediv=new c.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.color=new c.Element("div",{"class":"wux-controls-responsivetileview-color"}).inject(this.elements.container);this.elements.color.setAttribute("has-color","false");this.elements.picture=new c.Element("div",{"class":"wux-controls-responsivetileview-picture",}).inject(this.elements.container);this.elements.checkbox=new c.Element("div",{"class":"wux-controls-responsivetileview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.maincontent=new c.Element("div",{"class":"wux-controls-responsivetileview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.titlebar=new c.Element("div",{"class":"wux-controls-responsivetileview-titlebar"}).inject(this.elements.maincontent);this.elements.icon=new c.Element("div",{"class":"wux-controls-responsivetileview-icon"}).inject(this.elements.titlebar);this.elements.title=new c.Element("div",{"class":"wux-controls-responsivetileview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new c.Element("div",{"class":"wux-controls-responsivetileview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.description=new c.Element("div",{"class":"wux-controls-responsivetileview-description"}).inject(this.elements.maincontent);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new c.Element("div",{"class":"wux-controls-responsivetileview-propertiesListContainer"}).inject(this.elements.maincontent);this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.propertiesListFirstContainer=new c.Element("div",{"class":"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false");this.elements.propertiesListSecondContainer=new c.Element("div",{"class":"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false");this.elements.menu=new c.Element("div",{"class":"wux-controls-responsivetileview-menu"}).inject(this.elements.container);this.elements.menu.responsiveTileView=this;this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbar"}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var l=0;l<8;l++){var m=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbaricon"});this.elements.statusbaricons.push(m);var o=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbarseparator"});this.elements.statusbar.appendChild(m);this.elements.statusbar.appendChild(o);m._index=l;a.addEventOnElement(this,m,e.POINTERDOWN,function(p){n.fire("StatusbarIconPointerDown",{iconIndex:p.target._index});p.stopPropagation()})}},_applyProperties:function(l){this._parent(l);if(this.isDirty("tileWidth")){this._applyTileWidth(l.tileWidth)}},_applyTileWidth:function(l){this._applyViewWidth(l)},_getViewMinWidth:function(){return i},_getViewMaxWidth:function(){return h},_getViewWidth:function(){return this.tileWidth},_onTileResize:function(l){this._onViewResize(this.tileWidth)},_getViewCssClassSuffix:function(){return"responsivetileview"}});return k});define("DS/Controls/ResponsiveTextualTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveTileView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(d,f,i,e,a,b,g,h){var c=i.inherit({name:"ResponsiveTextualTileView",markForRecordFlag:true,buildView:function(){this._modelEvents=new b();this._isHighlighted=false;var l=this;this.elements.container=new d.Element("div",{"class":"wux-controls-responsivetextualtileview"});this.elements.container.setAttribute("has-picture","false");this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("has-statusbar-content","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new d.Element("div",{"class":"wux-controls-highlightborder"}).inject(this.elements.container);this.elements.activediv=new d.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.color=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-color"}).inject(this.elements.container);this.elements.color.setAttribute("has-color","false");this.elements.picture=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-picture",}).inject(this.elements.container);this.elements.pictureplaceholder=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-pictureplaceholder",html:"PLACE YOUR PNG PICTURE HERE"}).inject(this.elements.picture);this.elements.checkbox=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.titlebar=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-titlebar"}).inject(this.elements.container);this.elements.maincontent=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.icon=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-icon"}).inject(this.elements.titlebar);this.elements.title=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.description=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-description"}).inject(this.elements.maincontent);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertiesListContainer"}).inject(this.elements.maincontent);this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.propertiesListFirstContainer=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false");this.elements.propertiesListSecondContainer=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false");this.elements.menu=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-menu"}).inject(this.elements.container);this.elements.menu.responsiveTileView=this;this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbar"}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var j=0;j<8;j++){var k=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbaricon"});this.elements.statusbaricons.push(k);var m=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbarseparator"});this.elements.statusbar.appendChild(k);this.elements.statusbar.appendChild(m);k._index=j;a.addEventOnElement(this,k,e.POINTERDOWN,function(n){l.fire("StatusbarIconPointerDown",{iconIndex:n.target._index});n.stopPropagation()})}},_applyMultipleTitleLineNumber:function(j){this.elements.container.titleLineNumber=1;return},_getTitleLineHeight:function(){return 22},_getDescriptionLineHeight:function(){return 19},_getViewCssClassSuffix:function(){return"responsivetextualtileview"}});return c});define("DS/Windows/WindowActivator",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,b,a,d){var c=b.singleton({defaultOptions:{},FindFocusableInChildren:function(k,l){var f=null;if(k==undefined){return null}if(l==false){if(k.getAttribute("tabindex")||k.tabIndex>=0){return k}}var j=k.childNodes;for(var h=0;h<j.length;h++){var g=j[h];if(g.nodeType!=1){continue}if(g.getAttribute("tabindex")||g.tabIndex>=0){f=g;break}else{f=this.FindFocusableInChildren(g,false);if(f){break}}}return f},getFocusedWidget:function(k){var h=null;if(k==undefined||k==null){return null}var g=document.activeElement;if(k==g){return k}if(k){var f=k.childNodes;for(var j=0;j<f.length;j++){var l=f[j];if(l.nodeType!=1){continue}if(l==g){h=l;break}else{h=this.getFocusedWidget(l);if(h){break}}}}return h}});return c});define("DS/TreeModel/SetFilter",["DS/TreeModel/BaseFilter"],function(a){var b=a.inherit({name:"setfilter",publishedProperties:{},isDataFiltered:function(c){if(!this.filterModel){return false}var d=c.getAttributeValue(this.propertyId);if(this.filterModel.length===0){return false}return this.filterModel.indexOf(d)===-1},isEmpty:function(){if(!this.filterManager||!this.filterManager.model){return true}if(!this.filterModel||this.filterModel.length===0){return true}var d=this.filterManager.model;var c=false;var e=this;d.search({shouldStop:function(){return c},match:function(f){if(e.filterModel.indexOf(f.nodeModel.getAttributeValue(e.propertyId))===-1){c=true}}});return !c}});return b});define("DS/Windows/WindowManager",["UWA/Core","UWA/Class","DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,b,a,d){var c=b.singleton({defaultOptions:{},init:function(f){this._parent(f)},setActiveWindow:function(f){if(this._activeWindow===f){return}var g=this._activeWindow;this._activeWindow=f;if(this._activeWindow){this._activeWindow.activeFlag=true}if(g){g.activeFlag=false}},getActiveWindow:function(){return this._activeWindow},bringToFront:function(h){if(h&&!h.getDockedFlag()&&!h.maximizedFlag){var m=h.getZIndex();var i=-1;var l=h.immersiveFrame;if(l){for(var k in l.windows){var g=l.windows[k];if(g&&(g!==h)){var j=g.getZIndex();if(i<j){i=j}}}}if(i>=m){var f=i+1;h.getContent().setStyle("z-index",f)}}}});return c});var WUXSnapAreaEnum={NoneArea:0,OutsideArea:1,TopArea:2,BottomArea:3,LeftArea:4,RightArea:5,InsideArea:6};Object.freeze(WUXSnapAreaEnum);var WUXWindowGroupTypeEnum={GroupAsGrid:0,GroupAsTab:1};Object.freeze(WUXWindowGroupTypeEnum);var WUXStandardButtonRoleEnum={InvalidRole:0,AcceptRole:1,RejectRole:2,DestructiveRole:3,HelpRole:4,YesRole:5,NoRole:6,ApplyRole:7,ResetRole:8};Object.freeze(WUXStandardButtonRoleEnum);var WUXStandardButtonEnum={Ok:{name:"Ok",value:1<<0,role:WUXStandardButtonRoleEnum.AcceptRole},Open:{name:"Open",value:1<<1,role:WUXStandardButtonRoleEnum.AcceptRole},Save:{name:"Save",value:1<<2,role:WUXStandardButtonRoleEnum.AcceptRole},Apply:{name:"Apply",value:1<<3,role:WUXStandardButtonRoleEnum.ApplyRole},Reset:{name:"Reset",value:1<<4,role:WUXStandardButtonRoleEnum.ResetRole},RestoreDefaults:{name:"RestoreDefaults",value:1<<5,role:WUXStandardButtonRoleEnum.ResetRole},Help:{name:"Help",value:1<<6,role:WUXStandardButtonRoleEnum.HelpRole},SaveAll:{name:"SaveAll",value:1<<7,role:WUXStandardButtonRoleEnum.AcceptRole},Yes:{name:"Yes",value:1<<8,role:WUXStandardButtonRoleEnum.YesRole},YesToAll:{name:"YesToAll",value:1<<9,role:WUXStandardButtonRoleEnum.YesRole},No:{name:"No",value:1<<10,role:WUXStandardButtonRoleEnum.NoRole},NoToAll:{name:"NoToAll",value:1<<11,role:WUXStandardButtonRoleEnum.NoRole},Abort:{name:"Abort",value:1<<12,role:WUXStandardButtonRoleEnum.RejectRole},Retry:{name:"Retry",value:1<<13,role:WUXStandardButtonRoleEnum.AcceptRole},Ignore:{name:"Ignore",value:1<<14,role:WUXStandardButtonRoleEnum.AcceptRole},Discard:{name:"Discard",value:1<<15,role:WUXStandardButtonRoleEnum.DestructiveRole},Cancel:{name:"Cancel",value:1<<16,role:WUXStandardButtonRoleEnum.RejectRole},Close:{name:"Close",value:1<<17,role:WUXStandardButtonRoleEnum.RejectRole}};Object.freeze(WUXStandardButtonEnum);var windowPrefKey="wux-windows-window";define("DS/Windows/Window",["UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Windows/WindowManager","DS/Utilities/Dom","DS/Windows/WindowActivator","DS/Controls/Button","i18n!DS/Windows/assets/nls/translation","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Controls/TooltipModel"],function(d,a,l,f,b,q,m,g,h,j,k,o,p,r){function i(){if(this.elements.icon){this.elements.icon.remove(this.elements.iconPlaceholder);delete this.elements.icon}var s=m.generateIcon(this.icon);if(s){this.elements.icon=s;this.elements.iconPlaceholder.show();this.elements.icon.style.margin="0px";this.elements.icon.inject(this.elements.iconPlaceholder)}else{this.elements.iconPlaceholder.hide()}}var e=l.inherit({name:"window",markForRecordFlag:true,contentVisibleState:false,publishedProperties:{identifier:{defaultValue:undefined,type:"string",readOnly:true,category:"Behavior"},title:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},header:{defaultValue:null,type:"object",category:"Appearance"},content:{defaultValue:null,type:"object",category:"Behavior"},immersiveFrame:{defaultValue:null,type:"object",category:"Behavior"},position:{type:"object",category:"Appearance",recordFlag:["my","at"]},activeFlag:{defaultValue:true,type:"boolean",category:"Behavior"},movableFlag:{defaultValue:true,type:"boolean",category:"Behavior"},closeButtonFlag:{defaultValue:true,type:"boolean",category:"Behavior"},expandedFlag:{defaultValue:true,type:"boolean",category:"Behavior",recordFlag:true},allowedDockAreas:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior"},currentDockArea:{defaultValue:WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior",advancedSetter:true,recordFlag:true},windowGroup:{defaultValue:null,type:"object",category:"Behavior",recordFlag:["_computedIdentifier"]},activeSnapArea:{defaultValue:WUXSnapAreaEnum.NoneArea,type:"integer",category:"Behavior"},resizableFlag:{defaultValue:false,type:"boolean",category:"Behavior"},width:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:true,recordFlag:true},height:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:true,recordFlag:true},minWidth:{defaultValue:150,defaultTouchValue:200,type:"integer",category:"Appearance"},minHeight:{defaultValue:0,type:"integer",category:"Appearance"},maximizedFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},allowMaximizeFlag:{defaultValue:true,type:"boolean",category:"Behavior"},maximizeButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},horizontallyStretchableFlag:{defaultValue:false,type:"boolean",category:"Behavior"},verticallyStretchableFlag:{defaultValue:false,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:true,type:"boolean",category:"Behavior"},titleBarVisibleFlag:{defaultValue:true,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:true,type:"boolean",category:"Appearance"},ensureHeightDefinitionOnHierarchy:{defaultValue:false,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:true,type:"boolean",category:"Behavior"},buttons:{defaultValue:{},type:"object",category:"Behavior"},touchMode:{defaultValue:undefined,type:"boolean",category:"Accessibility",advancedSetter:true}},_titleBarCenteredFlag:false,_buttonsVisibleFlag:true,_savedPreferencesKeys:[],buildView:function(){o.setElementRecordMode(this.elements.container,p.RecordModes.DEFAULT_AND_CHILD);this.defaultButton=null;this.escapeButton=null;this.elements.container.addClassName("wux-windows-window wux-element-contentbox");this.elements.container.id=d.Utils.getUUID();this.elements._titleBarDiv=new d.Element("div",{"class":"wux-windows-window-titlebar wux-element-contentbox"});this.elements._titleBarDiv.inject(this.elements.container);this.elements._titleDiv=new d.Element("div",{"class":"wux-windows-window-header-title"}).inject(this.elements._titleBarDiv);this.elements.iconPlaceholder=new d.Element("div",{"class":"wux-window-icon-placeholder"}).inject(this.elements._titleDiv);this.elements._titleP=new d.Element("p",{text:this.title,});this.elements._titleP.inject(this.elements._titleDiv);this.elements._titlebarButtonsDiv=new d.Element("div",{"class":"wux-windows-window-header-buttons-div"});this.elements._titlebarButtonsDiv.inject(this.elements._titleBarDiv);this.elements._mainCollapsibleContainer=new d.Element("div",{"class":"wux-windows-window-mask-content"});this.elements._mainCollapsibleContainer.inject(this.elements.container);this.elements._mainContentDiv=new d.Element("div",{"class":"wux-windows-window-maincontent wux-element-contentbox"});this.elements._mainContentDiv.inject(this.elements._mainCollapsibleContainer);this.elements._headerDiv=new d.Element("div",{"class":"wux-windows-window-header wux-element-contentbox"});this.elements._headerDiv.inject(this.elements._mainContentDiv);this.elements._contentDiv=new d.Element("div",{"class":"wux-windows-window-content wux-element-contentbox"});this.elements._contentDiv.inject(this.elements._mainContentDiv);this.elements._ghostFloatableElement=new d.Element("div",{"class":"wux-windows-window-ghost-floatable-element"});this.elements._topResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-top wux-windows-window-resize-handler-side"});this.elements._topResizeHandler.inject(this.elements.container);this.elements._topRightResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-right wux-windows-window-resize-handler-corner"});this.elements._topRightResizeHandler.inject(this.elements.container);this.elements._rightResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-right wux-windows-window-resize-handler-side"});this.elements._rightResizeHandler.inject(this.elements.container);this.elements._bottomRightResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-right wux-windows-window-resize-handler-corner"});this.elements._bottomRightResizeHandler.inject(this.elements.container);this.elements._bottomResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom wux-windows-window-resize-handler-side"});this.elements._bottomResizeHandler.inject(this.elements.container);this.elements._bottomLeftResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-bottom-left wux-windows-window-resize-handler-corner"});this.elements._bottomLeftResizeHandler.inject(this.elements.container);this.elements._leftResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-left wux-windows-window-resize-handler-side"});this.elements._leftResizeHandler.inject(this.elements.container);this.elements._topLeftResizeHandler=new d.Element("div",{"class":"wux-windows-window-resize-handler wux-windows-window-resize-handler-top-left wux-windows-window-resize-handler-corner"});this.elements._topLeftResizeHandler.inject(this.elements.container);this.elements._topSnapAreaDiv=new d.Element("div",{"class":"wux-windows-window-snap-area wux-windows-window-snap-area-top"});this.elements._topSnapAreaDiv.inject(this.elements.container);this.elements._bottomSnapAreaDiv=new d.Element("div",{"class":"wux-windows-window-snap-area wux-windows-window-snap-area-bottom"});this.elements._bottomSnapAreaDiv.inject(this.elements.container);this.elements._leftSnapAreaDiv=new d.Element("div",{"class":"wux-windows-window-snap-area wux-windows-window-snap-area-left"});this.elements._leftSnapAreaDiv.inject(this.elements.container);this.elements._rightSnapAreaDiv=new d.Element("div",{"class":"wux-windows-window-snap-area wux-windows-window-snap-area-right"});this.elements._rightSnapAreaDiv.inject(this.elements.container);this.elements._insideSnapAreaDiv=new d.Element("div",{"class":"wux-windows-window-snap-area wux-windows-window-snap-area-inside"});this.elements._insideSnapAreaDiv.inject(this.elements._titleBarDiv)},_postBuildView:function(){this._parent();this._updateContentVisibleStateChange();var s=this;m.onNodeRendered(this.getContent(),function(){if(s&&s.elements&&s.elements.container){if(s.activeFlag===true){s._setFocus()}s._applyHeight();s._updateTitleMaxWidth()}})},_applyTitle:function(s){this.elements._titleP.setText(this.title);if(!this.title){this.elements._titleP.setStyle("padding-left","0")}else{this.elements._titleP.setStyle("padding-left","")}if(this.windowGroup){this.windowGroup._updateTitle()}},_applyTouchMode:function(){this._parent();var s=this._getCurrentTouchMode();if(s===true){this.elements._titleBarDiv.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements._titleBarDiv.removeAttribute("touch-mode")}this._postEditTouchMode()},_postEditTouchMode:function(){this._parent();var s=this._getCurrentTouchMode();if(this.windowGroup){this.windowGroup.touchMode=s}if(s===true){if(this.minWidth===this.publishedProperties.minWidth.defaultValue){this.minWidth=this.publishedProperties.minWidth.defaultTouchValue}}else{if(this.minWidth===this.publishedProperties.minWidth.defaultTouchValue){this.minWidth=this.publishedProperties.minWidth.defaultValue}}this._applyWidth();this._applyHeight();this._applyPosition();this._updateTitleMaxWidth()},getDefaultButtonLabel:function(t){var s;switch(t){case WUXStandardButtonEnum.Ok.name:s=j.ok;break;case WUXStandardButtonEnum.Open.name:s=j.open;break;case WUXStandardButtonEnum.Save.name:s=j.save;break;case WUXStandardButtonEnum.Cancel.name:s=j.cancel;break;case WUXStandardButtonEnum.Close.name:s=j.close;break;case WUXStandardButtonEnum.Discard.name:s=j.discard;break;case WUXStandardButtonEnum.Apply.name:s=j.apply;break;case WUXStandardButtonEnum.Reset.name:s=j.reset;break;case WUXStandardButtonEnum.RestoreDefaults.name:s=j.restoreDefaults;break;case WUXStandardButtonEnum.Help.name:s=j.help;break;case WUXStandardButtonEnum.SaveAll.name:s=j.saveAll;break;case WUXStandardButtonEnum.Yes.name:s=j.yes;break;case WUXStandardButtonEnum.YesToAll.name:s=j.yesToAll;break;case WUXStandardButtonEnum.No.name:s=j.no;break;case WUXStandardButtonEnum.NoToAll.name:s=j.noToAll;break;case WUXStandardButtonEnum.Abort.name:s=j.abort;break;case WUXStandardButtonEnum.Retry.name:s=j.retry;break;case WUXStandardButtonEnum.Ignore.name:s=j.ignore;break}return s},_applyIcon:function(t){if(typeof(this.icon)==="object"){if(!this.icon.iconClasses){this.icon.iconClasses=""}if(!this.icon.iconName){this.icon.iconName=""}if(typeof this.icon.fontIconFamily==="undefined"){this.icon.fontIconFamily=WUXManagedFontIcons.Font3DS}if(!this.icon.fontIconSize){this.icon.fontIconSize="1x"}}else{if(typeof(this.icon)==="string"&&this.icon.indexOf(".")===-1&&this.icon!==""){var s={iconName:this.icon};this.icon=s}}i.call(this);if(this.icon){this.elements.iconPlaceholder.setStyle("padding-left","");this.elements.iconPlaceholder.setStyle("padding-right","")}else{this.elements.iconPlaceholder.setStyle("padding-left","0");this.elements.iconPlaceholder.setStyle("padding-right","0")}if(this.windowGroup){this.windowGroup._updateTitle()}},_applyHeader:function(s){this.elements._headerDiv.setContent(this.header);if(this.header){this.elements._headerDiv.show()}else{this.elements._headerDiv.hide()}this._applyPosition()},_applyContent:function(s){this.elements._contentDiv.setContent(this.content);this._applyPosition()},_applyPosition:function(t){if(!this.position){this.position={}}if(!this.position.my){this.position.my="top left"}if(!this.position.at){this.position.at="top left"}if(!this.position.of){if(this.immersiveFrame){this.position.of=this.immersiveFrame.getContent()}else{this.position.of=document.body}}if(!this.position.constraint&&this.immersiveFrame){this.position.constraint=this.immersiveFrame.getContent()}if(!this.position.offsetX){this.position.offsetX=0}if(!this.position.offsetY){this.position.offsetY=0}if(!this.position.collision){this.position.collision="fit"}if(!this.getEmbeddedState()&&!(this.maximizedFlag&&this.allowMaximizeFlag)){var s=b.setPosition(this,this.position);if(s){this.fire("move")}}},_applyActiveFlag:function(){if(this.windowGroup){if(this.activeFlag){this.windowGroup.activeFlag=this.activeFlag}}else{if(this.activeFlag){if(q.getActiveWindow()!=this){q.setActiveWindow(this);this.bringToFront()}}else{if(q.getActiveWindow()===this){q.setActiveWindow(null)}}}if(this.activeFlag){this.fire("activate");this._setFocus(this.elements._contentDiv)}else{this.fire("deactivate");this._unsetFocus()}},_setFocus:function(t){var u=null;if(t!=undefined){u=t}var s=this.elements._contentDiv;if(this.visibleFlag){if(u==null){u=g.getFocusedWidget(s);if(u!=null){return}}if(u==null){u=g.FindFocusableInChildren(s,true);if(u==null){if(this.defaultButton){u=this.defaultButton.getContent()}if(u==null&&this.escapeButton){u=this.escapeButton.getContent()}}}if(u){u.focus();u.style.outline="none"}}},_unsetFocus:function(){var s=this.lastFocusedWidget;if(s&&s==document.activeElement){s.blur();if(focusableWidget.dsModel!=undefined&&focusableWidget.dsModel!=null){focusableWidget.dsModel._resetFocus()}}},_applyCloseButtonFlag:function(){if(this.closeButtonFlag){var s=this;if(!this.elements._closeButton){this.elements._closeButton=new d.Element("button",{"class":"wux-windows-window-header-button wux-windows-window-header-close wux-ui-3ds wux-ui-3ds-wrong"});this.elements._closeButton.tooltipInfos=new r({owner:this.elements._closeButton,shortHelp:j.close});m.addEventOnElement(s,s.elements._closeButton,"click",function(t){t.stopPropagation();s._onCloseButtonClick()})}this.elements._closeButton.inject(this.elements._titlebarButtonsDiv,"bottom")}else{if(this.elements._closeButton){this.elements._closeButton.remove()}}if(this.windowGroup){this.windowGroup._updateCloseButtonFlag()}this._updateTitleMaxWidth()},_applyExpandedFlag:function(s){var u=this;if(this.expandedFlag){this.elements._mainContentDiv.addEventListener("transitionend",function t(x){if(x.target===u.elements._mainContentDiv){x.stopPropagation();u.elements._mainContentDiv.removeEventListener("transitionend",t);u.managePointerEvents()}});this.elements._mainContentDiv.removeClassName("wux-windows-window-maincontent-force-collapse");this.getContent().removeAttribute("collapsed");this.elements._mainContentDiv.setStyles({"margin-top":"0px"});if(this.expandedFlag&&!s){this.fire("expand")}}else{if(!this.expandedFlag){if(this.getCollapsibleState()){this.elements._mainContentDiv.addEventListener("transitionend",function w(x){if(x.target===u.elements._mainContentDiv){x.stopPropagation();u.elements._mainContentDiv.addClassName("wux-windows-window-maincontent-force-collapse");u.elements._mainContentDiv.removeEventListener("transitionend",w);u.managePointerEvents()}});var v=this.elements._mainContentDiv.getSize().height;this.elements._mainContentDiv.setStyles({"margin-top":"-"+v+"px"});this.getContent().setAttributeNode(document.createAttribute("collapsed"))}else{this.expandedFlag=true}if(!this.expandedFlag&&s){this.fire("collapse")}}}if(s!==undefined&&this.expandedFlag!==s){this._updateContentVisibleStateChange()}},_applyVisibleFlag:function(s){this._parent();if(this.activeFlag){this._setFocus()}this._updateContentVisibleStateChange();this.fire("visibleStateChange");if(this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var t=this.immersiveFrame.getDockingElement(this.currentDockArea);if(t){t._updateFromContainedWindows();t._updateContainedWindows()}this.managePointerEvents()}if(this.visibleFlag){this._readWindowPreferences()}if(this.windowGroup){this.windowGroup._setWindowVisibility(this)}if(s===false&&this.visibleFlag){this._applyPosition()}},_applyMovableFlag:function(){if(this.windowGroup){this.windowGroup._updateMovableFlag()}},_applyEnsureHeightDefinitionOnHierarchy:function(){if(this.ensureHeightDefinitionOnHierarchy){this.getContent().setAttribute("ensureheightdefinitiononhierarchy","")}else{this.getContent().removeAttribute("ensureheightdefinitiononhierarchy","")}},_applyButtons:function(t){function x(A,z){if(!WUXStandardButtonEnum[A]||!WUXStandardButtonEnum[z]){return A-z}var C=WUXStandardButtonEnum[A].value;var B=WUXStandardButtonEnum[z].value;return C-B}if(this.elements._buttonsDiv!=undefined){while(this.elements._buttonsDiv.childNodes.length>0){var v=this.elements._buttonsDiv.childNodes[0];if(v&&v.dsModel instanceof h){v.remove()}else{break}}}this.defaultButton=null;this.escapeButton=null;if(this.elements._headerPopup){if(this.elements._panelButtonsDiv===undefined){this.elements._panelButtonsDiv=new d.Element("div",{"class":"wux-windows-expander-buttons"})}this.elements._panelButtonsDiv.inject(this.elements._buttonsDiv)}if(this.buttons){var w=Object.keys(this.buttons);w.sort(x);for(var u=0;u<w.length;u++){var s=w[u];if(s&&WUXStandardButtonEnum[s]){var v=this.buttons[s];if(v&&(v instanceof h)){var y=WUXStandardButtonEnum[s].role;if((y===WUXStandardButtonRoleEnum.AcceptRole)||(y===WUXStandardButtonRoleEnum.YesRole)){if(!this.defaultButton){this.defaultButton=v}}else{if((y===WUXStandardButtonRoleEnum.RejectRole)||(y===WUXStandardButtonRoleEnum.NoRole)){if(!this.escapeButton){this.escapeButton=v}}}v.value=s;v.dialog=this;if(this.elements._buttonsDiv!=undefined){if(this.elements._headerPopup&&this.elements._panelButtonsDiv){v.inject(this.elements._panelButtonsDiv)}else{v.inject(this.elements._buttonsDiv)}}}}else{console.log('Error in Window : "'+s+'" is not a valid standard button')}}}this._applyPosition()},getEmbeddedState:function(){return Boolean(this.getDockedFlag()||this.windowGroup)},getCollapsibleState:function(){return false},getFloatableState:function(){return true},getMovableState:function(){return(this.movableFlag)},getContentVisibleState:function(){var t=this.visibleFlag&&this.expandedFlag;if(this.windowGroup){t=t&&this.windowGroup.getContentVisibleState();var s=this.windowGroup.currentWindows;if(s!=undefined&&s.length!==0){if(s.indexOf(this)===-1){t=false}}}if(this.getDockedFlag()){if(this.immersiveFrame){var u=this.immersiveFrame.getDockingElement(this.currentDockArea);if(u){t=t&&(!u.collapseDockingZoneFlag)&&u.visibleDockingZoneFlag}}}return t},_updateContentVisibleStateChange:function(){var s=this.getContentVisibleState();if(this.contentVisibleState!==s){this.contentVisibleState=s;this.fire("contentVisibleStateChange",{contentVisibleState:this.contentVisibleState})}},getResizableFlag:function(){return this.resizableFlag},_updateFromEmbeddedState:function(){if(this.getEmbeddedState()){this.getContent().setAttributeNode(document.createAttribute("embedded"))}else{this.getContent().removeAttribute("embedded")}this._updateContentHeight()},_updateFromCollapsibleState:function(){if(this.getCollapsibleState()&&(this.allowMaximizeFlag||!this.maximizedFlag)){this.getContent().setAttributeNode(document.createAttribute("collapsible"))}else{this.getContent().removeAttribute("collapsible");this.expandedFlag=true}},_preEditCurrentDockArea:function(s,t){if((t!==WUXDockAreaEnum.NoneDockArea)&&(t!==WUXDockAreaEnum.TopDockArea)&&(t!==WUXDockAreaEnum.BottomDockArea)&&(t!==WUXDockAreaEnum.LeftDockArea)&&(t!==WUXDockAreaEnum.RightDockArea)){return false}else{if(!(this.allowedDockAreas&t)&&t!==WUXDockAreaEnum.NoneDockArea){return false}else{return true}}},_applyCurrentDockArea:function(v){if(this.immersiveFrame!==null&&this.immersiveFrame!==undefined){if(this.currentDockArea!==v){this.fire("prePlaceChange",{previousPlace:{currentDockArea:v}})}if(this.currentDockArea===WUXDockAreaEnum.NoneDockArea){if(!this.getFloatableState()){this.currentDockArea=v;return}if(!this.windowGroup||(this.windowGroup.currentDockArea!==this.currentDockArea)){this.windowGroup=null;if(v){this.immersiveFrame.undockWindow(this);if(this.activeFlag){this.bringToFront()}}}this.getContent().removeAttribute("docked")}else{if(this.windowGroup&&(this.windowGroup.currentDockArea!==this.currentDockArea)){this.windowGroup=null}this.immersiveFrame.dockWindow(this,this.currentDockArea);var t=document.createAttribute("docked");switch(this.currentDockArea){case WUXDockAreaEnum.TopDockArea:t.value="top";break;case WUXDockAreaEnum.BottomDockArea:t.value="bottom";break;case WUXDockAreaEnum.LeftDockArea:t.value="left";break;case WUXDockAreaEnum.RightDockArea:t.value="right";break}this.getContent().setAttributeNode(t)}this._applyResizableFlag();this._updateFromCollapsibleState();this._updateFromEmbeddedState();this._updateMinWidth();this._applyWidth();this._applyHeight();this._applyPosition();if((v!==undefined)&&(this.currentDockArea!==v)){this.fire("placeChange");this._fireAndBroadcast("resize",{bubbles:false})}var u=this.immersiveFrame.getDockingElement(v);if(u){if(this.immersiveFrame._ActionBar_V3&&(v===WUXDockAreaEnum.BottomDockArea||v===WUXDockAreaEnum.TopDockArea)){this._moveTitleBar(false,u)}u._updateFromContainedWindows();u._updateContainedWindows()}var s=this.immersiveFrame.getDockingElement(this.currentDockArea);if(s){s._updateFromContainedWindows();s._updateContainedWindows()}else{if(v===WUXDockAreaEnum.BottomDockArea){this._setTitleBarCenteredFlag(false)}}this.immersiveFrame._manageAllPointerEventsOnDockingElements()}},managePointerEvents:function(){if(this.immersiveFrame&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){this.immersiveFrame.getDockingElement(this.currentDockArea)._pointerEventsAllIfOverflow()}},_applyImmersiveFrame:function(s){if(s!==undefined&&this.currentDockArea!==s){this.fire("prePlaceChange",{previousPlace:{immersiveFrame:s}})}if(s){s.removeWindow(this)}if(this.immersiveFrame){this.immersiveFrame.addWindow(this);this._readWindowPreferences();if(this.activeFlag){this.bringToFront()}this._properties.currentDockArea.dirty=false;this._applyCurrentDockArea();if(this.maximizedFlag){this._properties.maximizedFlag.dirty=false;this._applyMaximizedFlag()}this._updateMaxWidth();this._updateMaxHeight();this._applyHeight()}if((s!==undefined)&&(this.immersiveFrame!==s)){this.fire("placeChange")}},_applyWindowGroup:function(t){if(t!==undefined&&this.currentDockArea!==t){this.fire("prePlaceChange",{previousPlace:{windowGroup:t}})}if(t){t.detachWindow(this);t._updateAllowedDockAreas()}if(this.windowGroup){if(!this.windowGroup.containsWindow(this)){var v=null;var u=this.windowGroup.getEmbeddedWindows();if(u){v=u[u.length-1]}this.windowGroup.attachWindow(this,v,WUXSnapAreaEnum.InsideArea)}var s=document.createAttribute("attached-to-group");switch(this.windowGroup.groupType){case WUXWindowGroupTypeEnum.GroupAsGrid:s.value="grid";break;case WUXWindowGroupTypeEnum.GroupAsTab:s.value="tab";break}this.getContent().setAttributeNode(s);this.windowGroup._updateAllowedDockAreas()}else{this.getContent().removeAttribute("attached-to-group")}this._updateFromEmbeddedState();if((t!==undefined)&&(this.windowGroup!==t)){this._updateContentVisibleStateChange();this.fire("placeChange")}},_applyActiveSnapArea:function(t){if((this.activeSnapArea===WUXSnapAreaEnum.NoneArea)||(this.activeSnapArea===WUXSnapAreaEnum.OutsideArea)){this.getContent().removeAttribute("active-snap-area");this.elements._titleBarDiv.removeAttribute("active-snap-area")}else{var s=document.createAttribute("active-snap-area");switch(this.activeSnapArea){case WUXSnapAreaEnum.TopArea:s.value="top";break;case WUXSnapAreaEnum.BottomArea:s.value="bottom";break;case WUXSnapAreaEnum.LeftArea:s.value="left";break;case WUXSnapAreaEnum.RightArea:s.value="right";break;case WUXSnapAreaEnum.InsideArea:s.value="inside";var u=document.createAttribute("active-snap-area");u.value="inside";this.elements._titleBarDiv.setAttributeNode(u);break}this.getContent().setAttributeNode(s)}},_applyResizableFlag:function(s){if(this.resizableFlag===true||this.resizableFlag==="true"){this.getContent().addClassName("wux-windows-window-vertically-resizable");this.getContent().addClassName("wux-windows-window-horizontally-resizable")}else{if(this.resizableFlag==="vertical"){this.getContent().addClassName("wux-windows-window-vertically-resizable");this.getContent().removeClassName("wux-windows-window-horizontally-resizable")}else{if(this.resizableFlag==="horizontal"){this.getContent().addClassName("wux-windows-window-horizontally-resizable");this.getContent().removeClassName("wux-windows-window-vertically-resizable")}else{this.getContent().removeClassName("wux-windows-window-vertically-resizable");this.getContent().removeClassName("wux-windows-window-horizontally-resizable")}}}},_applyMinWidth:function(s){var u=this.minWidth;if(this.width&&this.width!==-1){if(this.width<u){this.width=u}}else{if(this.elements.container&&this.getContent().parentNode){var t=window.getComputedStyle(this.getContent());if(t&&(Math.round(t.width)<this.minWidth)){this.width=this.minWidth}}}if(this.windowGroup){this.windowGroup._updateMinWidth()}if(this.immersiveFrame&&(this.currentDockArea===WUXDockAreaEnum.LeftDockArea||this.currentDockArea===WUXDockAreaEnum.RightDockArea)){this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()}},_updateMinWidth:function(){if(this.windowGroup){return}if(this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&(this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea)&&!this.maximizedFlag){var x=this.elements._titleDiv;var v=window.getComputedStyle(x,null);var y=parseInt(v.borderLeft.slice(0,-2));var t=parseInt(v.borderRight.slice(0,-2));var u=parseInt(v.paddingLeft.slice(0,-2));var z=parseInt(v.paddingRight.slice(0,-2));var s=m.computeStringWidth(this.title,parseInt(v.fontSize),v.fontFamily)+u+z+y+t;var w=s+this._getDragZoneWidth()+3;if(w>this.minWidth){this._floatingMinWidth=this.minWidth;this.minWidth=w}}else{if(this._floatingMinWidth){this.minWidth=this._floatingMinWidth}}},_preEditWidth:function(s,u){var t=this.minWidth;if(u!==-1&&t!==undefined&&u<t){if(s>t){this.width=t}return false}return true},_applyWidth:function(s){this._updateMaxWidth();if(this.width===-1){this.getContent().setStyle("width","auto");this.elements._mainContentDiv.setStyle("width","auto");if(this.elements._footerDiv){this.elements._footerDiv.setStyle("width","100%")}}else{this.elements._mainContentDiv.setStyle("width",this.width+"px");if(this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea){if(this.elements._footerDiv){this.elements._footerDiv.setStyle("width",this.width+"px")}}else{if(this.elements._footerDiv){this.elements._footerDiv.setStyle("width","100%")}}}if(this.header!==null){this._updateContentHeight()}if((s!==undefined)&&(this.width!==s)){this._fireAndBroadcast("resize",{bubbles:false})}if(this.immersiveFrame){this.immersiveFrame._updateAllDockingZoneSize()}if(this.windowGroup&&this.windowGroup.width!==this.width){this.windowGroup._updateWidthAndHeight()}this._updateTitleBarWidth()},_updateTitleBarWidth:function(){if(this.currentDockArea===WUXDockAreaEnum.TopDockArea&&this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).getContainedVisibleWindows().length===1){var t=this.width!==-1?this.width:Math.round(parseFloat(window.getComputedStyle(this.elements._mainContentDiv).width));var s=Math.round(parseFloat(window.getComputedStyle(this.immersiveFrame.getDockingElement(WUXDockAreaEnum.TopDockArea).elements.dockingZone).width));if(t>s){t=s}t=Math.round(t);this.elements._titleBarDiv.setStyle("width",t+"px")}else{this.elements._titleBarDiv.setStyle("width","")}},_getDragZoneWidth:function(){if(!this._titleBarCenteredFlag){var s=this._getCurrentTouchMode()?36:22;return s+this.elements._titlebarButtonsDiv.clientWidth}return 0},_updateTitleMaxWidth:function(){var t=0;if(!this._titleBarCenteredFlag){var s=this._getCurrentTouchMode()?36:24;t=s+this.elements._titlebarButtonsDiv.clientWidth}this.elements._titleDiv.setStyle("max-width","calc(100% - "+t+"px)")},_preEditHeight:function(s,t){if(t!==null&&t!==undefined){if(t!==-1){if(t>=this.minHeight||!this.minHeight){var u=this._getFixedContentHeight();if(t<u){this.height=u;return false}}else{if(this.minHeight&&t<this.minHeight){this.height=this.minHeight;return false}}}}return true},_applyHeight:function(s){this._updateMaxHeight();if(this.height!==null&&this.height!==undefined){if(this.height===-1){this.elements._mainContentDiv.setStyle("height","")}else{this.elements._mainContentDiv.setStyle("height",this.height+"px")}this._updateContentHeight();if((s!==undefined)&&(this.height!==s)){this._fireAndBroadcast("resize",{bubbles:false})}}if(this.immersiveFrame){this.immersiveFrame._updateAllDockingZoneSize()}this._applyMinHeight();if(this.windowGroup){this.windowGroup._updateWidthAndHeight()}},getMaxWidth:function(){return this.immersiveFrame.getContent().clientWidth},getMaxHeight:function(){return this.immersiveFrame.getContent().clientHeight},_computeDropInsertionData:function(w){var v="after";var u=this.immersiveFrame._snapTargetWindow;if(!w){return{targetWindow:u,beforeOrAfter:v}}var s=this._getTitleWidth();var t=this.elements._titleDiv.getBoundingClientRect();if(w.x<t.x+s/2){v="before"}else{v="after"}return{targetWindow:u,beforeOrAfter:v}},_updateMaxWidth:function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientWidth>0){if((this.currentDockArea===WUXDockAreaEnum.NoneDockArea)&&!this.windowGroup){var s=this.getMaxWidth();this.getContent().setStyle("maxWidth",s+"px");this.elements._titleBarDiv.setStyle("maxWidth",(s-2)+"px");this.elements._mainContentDiv.setStyle("maxWidth",(s-2)+"px");if(this.elements._footerDiv){this.elements._footerDiv.setStyle("maxWidth",(s-2)+"px")}}else{if(this._titleBarCenteredFlag&&this.isAWindowGroup()){this._updateMaxTabbarWidth()}this.getContent().setStyle("maxWidth","");this.elements._titleBarDiv.setStyle("maxWidth","");this.elements._mainContentDiv.setStyle("maxWidth","");if(this.elements._footerDiv){this.elements._footerDiv.setStyle("maxWidth","")}}}},_updateMaxHeight:function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientHeight>0){if((this.currentDockArea===WUXDockAreaEnum.NoneDockArea)&&!this.windowGroup){var t=this.getMaxHeight();this.getContent().setStyle("maxHeight",t+"px");var s=this._getTitleBarHeight();var u=this._getFixedContentHeight();this.elements._contentDiv.setStyle("maxHeight",t-s-u+"px")}else{this.getContent().setStyle("maxHeight","");this.elements._contentDiv.setStyle("maxHeight","")}}},_getFixedContentHeight:function(){var t=this.elements._headerDiv?this.elements._headerDiv.offsetHeight:0;var u=this.elements._footerDiv?this.elements._footerDiv.offsetHeight:this.elements._buttonsDiv?this.elements._buttonsDiv.offsetHeight:0;var v=window.getComputedStyle(this.elements._contentDiv);var w=v?v.getPropertyValue("padding-top"):"";w=(w==="")?0:parseInt(w,10);var x=v?v.getPropertyValue("padding-bottom"):"";x=(x==="")?0:parseInt(x,10);var s=w+x;return t+u+s},_updateContentHeight:function(){var v=this._getFixedContentHeight();var u=this.currentDockArea;if((this.maximizedFlag&&!this.windowGroup&&this.allowMaximizeFlag)||(this.maximizedFlag&&this.windowGroup&&this.windowGroup.allowMaximizeFlag)||(u==WUXDockAreaEnum.TopDockArea||u==WUXDockAreaEnum.BottomDockArea)||(this.verticallyStretchableFlag&&(u==WUXDockAreaEnum.RightDockArea||u==WUXDockAreaEnum.LeftDockArea))){var t=0;var s=this.elements._titleBarDiv.getParent();if(s===this.elements.container){t=this._getTitleBarHeight()}if(t===0){this.elements._mainCollapsibleContainer.setStyle("height","100%")}else{this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+t+"px)")}this.elements._contentDiv.setStyle("height","calc(100% - "+v+"px)")}else{this.elements._mainCollapsibleContainer.setStyle("height","");if(this.height==-1){this.elements._contentDiv.setStyle("height","auto")}else{this.elements._contentDiv.setStyle("height",(this.height-v)+"px")}}},_applyMinHeight:function(s){var t=this.minHeight;if(this.height&&this.height!==-1){if(this.height<t){this.height=t}}var u=this._getFixedContentHeight();if(t!==undefined){this.elements._contentDiv.setStyle("min-height",(t-u)+"px")}else{this.elements._contentDiv.setStyle("min-height","")}if(this.windowGroup){this.windowGroup._updateMinHeight()}if(this.immersiveFrame&&(this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea)){this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()}},_applyMaximizedFlag:function(t){if(this.immersiveFrame){this._updateFromCollapsibleState();if(t!==undefined&&this.maximizedFlag!==t){this.fire("prePlaceChange",{previousPlace:{maximizedFlag:t}})}if(this.maximizedFlag&&this.allowMaximizeFlag){if(this.windowGroup){this.windowGroup.maximizedFlag=true}else{this.immersiveFrame.moveWindowToMaximizeZone(this)}var s=document.createAttribute("maximized");this.getContent().setAttributeNode(s);if(this.elements._maximizeButton){this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-full");this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small")}}else{this.getContent().removeAttribute("maximized");if(this.windowGroup&&this.windowGroup.maximizedFlag!==this.maximizedFlag){this.windowGroup=null}if(!this.getDockedFlag()&&!this.windowGroup&&this.currentDockArea===WUXDockAreaEnum.NoneDockArea){this._moveToImmersiveFrame();this.bringToFront()}else{if(!this.windowGroup&&this.currentDockArea!==WUXDockAreaEnum.NoneDockArea){this._applyCurrentDockArea(this.currentDockArea)}}if(this.elements._maximizeButton){this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-small");this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full")}}if(this.currentWindows){for(var v=0;v<this.getEmbeddedWindows().length;v++){var u=this.getEmbeddedWindows()[v];u.maximizedFlag=this.maximizedFlag}}this._updateContentHeight();if(t!==undefined&&this.maximizedFlag!==t){this._updateContentVisibleStateChange();this.fire("placeChange");this._fireAndBroadcast("resize,",{bubbles:false})}}},_applyAllowMaximizeFlag:function(s){if(!this.allowMaximizeFlag){this.maximizedFlag=false}this._applyMaximizeButtonFlag();if(this.windowGroup){this.windowGroup._updateAllowedDockAreas()}this._updateTitleMaxWidth()},_applyMaximizeButtonFlag:function(s){if(this.maximizeButtonFlag&&this.allowMaximizeFlag){if(!this.elements._maximizeButton){var t=this;this.elements._maximizeButton=new d.Element("button",{"class":"wux-windows-window-header-button wux-windows-window-header-maximize wux-ui-3ds"});if(this.maximizedFlag){this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small")}else{this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full")}m.addEventOnElement(t,t.elements._maximizeButton,"click",function(u){u.stopPropagation();t._onMaximizeButtonClick();t._saveMaximizeInPreferences()})}this.elements._maximizeButton.inject(this.elements._titlebarButtonsDiv,"top")}else{if(this.elements._maximizeButton){this.elements._maximizeButton.remove()}}if(this.windowGroup){this.windowGroup._updateMaximizeButtonFlag()}this._updateTitleMaxWidth()},_applyHorizontallyStretchableFlag:function(s){if(this.horizontallyStretchableFlag){this.getContent().addClassName("wux-windows-window-horizontally-stretchable");if(this.immersiveFrame&&this.immersiveFrame._ActionBar_V3){this.elements._titleBarDiv.addClassName("wux-windows-window-horizontally-stretchable")}}else{this.getContent().removeClassName("wux-windows-window-horizontally-stretchable");if(this.immersiveFrame&&this.immersiveFrame._ActionBar_V3){this.elements._titleBarDiv.removeClassName("wux-windows-window-horizontally-stretchable")}}this._applyResizableFlag();this.managePointerEvents();if(this.windowGroup){this.windowGroup._updateHorizontallyStretchableFlag()}if(this.immersiveFrame){var t=this.currentDockArea;if((t===WUXDockAreaEnum.TopDockArea)||(t===WUXDockAreaEnum.BottomDockArea)){var u=this.immersiveFrame.getDockingElement(t);if(u){u._updateFitToChildState()}}}this._updateTitleBarWidth()},_applyVerticallyStretchableFlag:function(s){if(this.verticallyStretchableFlag){this.getContent().addClassName("wux-windows-window-vertically-stretchable")}else{this.getContent().removeClassName("wux-windows-window-vertically-stretchable")}this._applyResizableFlag();this._updateContentHeight();this.managePointerEvents();if(this.windowGroup){this.windowGroup._updateVerticallyStretchableFlag()}},_applyTitleBarVisibleFlag:function(s){if(this.elements._titleBarDiv){if(this.titleBarVisibleFlag){this.elements._titleBarDiv.removeClassName("wux-windows-unvisible")}else{this.elements._titleBarDiv.addClassName("wux-windows-unvisible")}}},_applyUsePaddingFlag:function(){if(this.usePaddingFlag){this.getContent().removeAttribute("no-padding")}else{this.getContent().setAttributeNode(document.createAttribute("no-padding"))}},_applyAllowedDockAreas:function(t){if(this.windowGroup){this.windowGroup._updateAllowedDockAreas()}if(this.getFloatableState()&&this.currentDockArea==WUXDockAreaEnum.NoneDockArea){return}if(!(this.currentDockArea&this.allowedDockAreas)){if(this.getFloatableState()){this.currentDockArea=WUXDockAreaEnum.NoneDockArea}for(var s in WUXDockAreaEnum){if(WUXDockAreaEnum[s]!==WUXDockAreaEnum.NoneDockArea&&(WUXDockAreaEnum[s]&this.allowedDockAreas)){this.currentDockArea=WUXDockAreaEnum[s];break}}}},_applyProperties:function(s){this._parent(s);if(this.isDirty("immersiveFrame")){this._applyImmersiveFrame(s.immersiveFrame)}if(this.isDirty("title")){this._applyTitle(s.title)}if(this.isDirty("icon")){this._applyIcon(s.icon)}if(this.isDirty("header")){this._applyHeader(s.header)}if(this.isDirty("content")){this._applyContent(s.content)}if(this.isDirty("position")){this._applyPosition(s.position)}if(this.isDirty("activeFlag")){this._applyActiveFlag()}if(this.isDirty("closeButtonFlag")){this._applyCloseButtonFlag()}if(this.isDirty("currentDockArea")){this._applyCurrentDockArea(s.currentDockArea)}if(this.isDirty("windowGroup")){this._applyWindowGroup(s.windowGroup)}if(this.isDirty("activeSnapArea")){this._applyActiveSnapArea(s.activeSnapArea)}if(this.isDirty("resizableFlag")){this._applyResizableFlag(s.resizableFlag)}if(this.isDirty("width")){this._applyWidth(s.width)}if(this.isDirty("height")){this._applyHeight(s.height)}if(this.isDirty("expandedFlag")){this._applyExpandedFlag(s.expandedFlag)}if(this.isDirty("maximizedFlag")){this._applyMaximizedFlag(s.maximizedFlag)}if(this.isDirty("horizontallyStretchableFlag")){this._applyHorizontallyStretchableFlag(s.horizontallyStretchableFlag)}if(this.isDirty("verticallyStretchableFlag")){this._applyVerticallyStretchableFlag(s.verticallyStretchableFlag)}if(this.isDirty("titleBarVisibleFlag")){this._applyTitleBarVisibleFlag(s.titleBarVisibleFlag)}if(this.isDirty("usePaddingFlag")){this._applyUsePaddingFlag(s.usePaddingFlag)}if(this.isDirty("buttons")){this._applyButtons(s.buttons)}if(this.isDirty("ensureHeightDefinitionOnHierarchy")){this._applyEnsureHeightDefinitionOnHierarchy()}if(this.isDirty("touchMode")){this._postEditTouchMode()}this._applyMaximizeButtonFlag()},_setTitleBarCenteredFlag:function(s){if(this._titleBarCenteredFlag!==s){this._titleBarCenteredFlag=s;if(this.elements._titleBarDiv){if(this._titleBarCenteredFlag){this.elements._titleBarDiv.addClassName("wux-windows-window-titlebar-align-center");this.elements.container.addClassName("wux-windows-window-align-center")}else{this.elements._titleBarDiv.removeClassName("wux-windows-window-titlebar-align-center");this.elements.container.removeClassName("wux-windows-window-align-center")}}this._updateTitleMaxWidth()}this._setButtonsVisibleFlag(!s)},_moveTitleBar:function(s,u){if(this.elements._titleBarDiv){var t=this.elements._titleBarDiv.getParent();if(s&&u){var v=u._getFixedArea();if(v&&(t!==v)){this.elements._titleBarDiv.inject(v)}}else{if(t!==this.elements.container){this.elements._titleBarDiv.inject(this.elements.container,"top")}}}},_setButtonsVisibleFlag:function(s){if(this._buttonsVisibleFlag!==s){this._buttonsVisibleFlag=s;if(this.elements._titlebarButtonsDiv){if(this._buttonsVisibleFlag){this.elements._titlebarButtonsDiv.removeClassName("wux-windows-unvisible")}else{this.elements._titlebarButtonsDiv.addClassName("wux-windows-unvisible")}}}},getAbsolutePosition:function(){if(this.windowGroup&&(this.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsTab)){return this.windowGroup.getAbsolutePosition()}return this.getContent().getPosition(document.body)},setAbsolutePosition:function(s){if(s){var t=this.getOffsetParentPosition();var v=this.getOffsetParentMargins();var w={x:s.x-t.x-v.left,y:s.y-t.y-v.top};var u=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=w.x-u.x;this.position.offsetY=w.y-u.y;this._applyPosition()}},clonePosition:function(){var s={my:this.position.my,at:this.position.at,of:this.position.of,constraint:this.position.constraint,offsetX:this.position.offsetX,offsetY:this.position.offsetY,collision:this.position.collision};return s},getOffsetParentPosition:function(){var t=this.getContent().getOffsetParent();var s={x:0,y:0};if(t){s=t.getPosition(document.body)}return s},getOffsetParentMargins:function(){var u=this.getContent().getOffsetParent();var t={left:0,right:0,top:0,bottom:0};if(u){var s=window.getComputedStyle(u);if(s.marginLeft===""){t.left=0}else{t.left=parseInt(s.marginLeft,10)}if(s.marginRight===""){t.right=0}else{t.right=parseInt(s.marginRight,10)}if(s.marginTop===""){t.top=0}else{t.top=parseInt(s.marginTop,10)}if(s.marginBottom===""){t.bottom=0}else{t.bottom=parseInt(s.marginBottom,10)}}return t},getPositionRelativeToOffsetParent:function(){var s=this.getContent().getOffsetParent();return this.getContent().getPosition(s)},close:function(){this._isBeingClosed=true;this.fire("close");if(this.autoCloseFlag){this.destroy()}this._isBeingClosed=false},destroy:function(){if(this.windowGroup){this.windowGroup=null}if(q.getActiveWindow()===this){q.setActiveWindow(null)}this.immersiveFrame=null;this._parent()},getDockedFlag:function(){return(this.currentDockArea!==WUXDockAreaEnum.NoneDockArea)},getZIndex:function(){var s=parseInt(this.getContent().getStyle("z-index"));if(isNaN(s)){s=-1}return s},bringToFront:function(){if(this.windowGroup){this.windowGroup.bringToFront()}else{q.bringToFront(this)}},ensureVisible:function(){this.visibleFlag=true;this.expandedFlag=true;if(this.windowGroup){this.windowGroup.ensureVisible();var t=this.windowGroup.currentWindows;if(t!=undefined&&t.length!==0){if(t.indexOf(this)===-1){this.windowGroup.currentWindows=[this]}}}if(this.getDockedFlag()){if(this.immersiveFrame){var u=this.immersiveFrame.getDockingElement(this.currentDockArea);if(u){u.collapseDockingZoneFlag=false}}}var s=this.getContent();if(s){s.parentNode.scrollTop=s.offsetTop;s.parentNode.scrollLeft=s.offsetLeft}},getTitleBar:function(){return this.elements._titleBarDiv},_getTitleBarHeight:function(){return this.elements._titleBarDiv.offsetHeight},_getTitleWidth:function(){return this.elements._titleDiv.offsetWidth},_ensureTitleBarUnderPointer:function(x){var t=this.getOffsetParentPosition();var w=this.getOffsetParentMargins();var s=this.getContent().getSize();var v=this._getTitleBarHeight();var y=this.getPositionRelativeToOffsetParent();if((y.x+t.x+s.width<x.x)||(y.x+t.x>=x.x)){y.x=x.x-(s.width/2)-t.x-w.left}if((y.y+t.y+v<x.y)||(y.y+t.y>=x.y)){y.y=x.y-(v/2)-t.y-w.top}var u=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=y.x-u.x;this.position.offsetY=y.y-u.y;this._applyPosition();if(this._initialPointerPosition){this._initialPointerPosition.x=x.x;this._initialPointerPosition.y=x.y}if(this._initialWindowOffset){this._initialWindowOffset.x=this.position.offsetX;this._initialWindowOffset.y=this.position.offsetY}},_canBeSnapSource:function(t,s){return false},_canBeSnapTarget:function(t,s){return false},getBoundingClientRect:function(){var w=this.getContent().getBoundingClientRect();var v=this.currentDockArea;if((v===WUXDockAreaEnum.BottomDockArea)||(v===WUXDockAreaEnum.TopDockArea)){var s=this.elements._titleBarDiv.getParent();if(s!==this.elements.container){var u=this._getTitleBarHeight();var t={top:w.top,left:w.left,bottom:w.bottom,right:w.right,x:w.x,y:w.y,width:w.width,height:w.height};w=t;w.top-=u;w.height+=u}}return w},_getSnapAreaRect:function(s){var v=this.getBoundingClientRect();var t=10;switch(s){case WUXSnapAreaEnum.OutsideArea:return v;break;case WUXSnapAreaEnum.TopArea:return{left:v.left,top:v.top,width:v.width,height:t};break;case WUXSnapAreaEnum.BottomArea:return{left:v.left,top:v.top+v.height-t,width:v.width,height:t};break;case WUXSnapAreaEnum.LeftArea:return{left:v.left,top:v.top,width:t,height:v.height};break;case WUXSnapAreaEnum.RightArea:return{left:v.left+v.width-t,top:v.top,width:t,height:v.height};break;case WUXSnapAreaEnum.InsideArea:var u=this._getTitleBarHeight();return{left:v.left,top:v.top,width:v.width,height:u};break}},isAWindowGroup:function(){return Boolean(this.getContent().hasClassName("wux-windows-windowgroup"))},attachToWindow:function(t,s,u){return this._attachToWindow(t,s,u,false)},_locateAndAttachToWindow:function(t,s,x){if(this.immersiveFrame){var v=t;if(t.charAt(0)==="["){var w=t.split(";");v=w[w.length-1];v=v.substring(0,v.length-1)}var u=this.immersiveFrame._getWindowFromIdentifier(v);if(u){this._attachToWindow(u,s,x,true);return true}}return false},_attachToWindow:function(v,B,z,F){var A=-1;if(this.elements&&this.elements.container){var u=this.isAWindowGroup();if(v&&!F){var w=this._getDetachedFromPreferences();if(v.windowGroup||v.isAWindowGroup()){var D=v.isAWindowGroup()?v:v.windowGroup;var C=D.getEmbeddedWindows();for(var y=0;y<C.length;y++){var G=C[y];if(G&&w.indexOf(G.identifier)!==-1){return -1}}}else{if(w.indexOf(v.identifier)!==-1){return -1}}}if(v&&(B!==WUXSnapAreaEnum.NoneArea)&&(B!==WUXSnapAreaEnum.OutsideArea)&&this._canBeSnapSource(v,B)&&v._canBeSnapTarget(this,B)){var t=v;var E=(B===WUXSnapAreaEnum.InsideArea)?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;var x=v.isAWindowGroup()?v:null;if(!x||(x.groupType!==E)){x=v.windowGroup;if(x&&(x.groupType!==E)){if(E===WUXWindowGroupTypeEnum.GroupAsGrid){var s=this.windowGroup;if(s&&(s===x)){s.detachWindow(this);A=this._attachToWindow(v,B,z,F);this._applyHeight();this._applyWidth();v._postEditTouchMode();x._postEditTouchMode();return A}A=this._attachToWindow(x,B,z,F);this._postEditTouchMode();v._postEditTouchMode();x._postEditTouchMode();return A}x=null}}if(!x){x=v._createWindowGroup(E);if(x){x.immersiveFrame=v.immersiveFrame;x._stackWindowNextTo(v,null,WUXSnapAreaEnum.NoneArea,z,F);v._postEditTouchMode();x._postEditTouchMode()}}if(x){A=x._stackWindowNextTo(this,v,B,z,F);x._postEditTouchMode()}if(A){if(F&&(!u||this.getEmbeddedWindows().length!==0)){this._saveWindowGroupInPreferences()}}}}return A},_moveToImmersiveFrame:function(){if(this.immersiveFrame){this.immersiveFrame.moveWindowToImmersiveFrame(this)}},_getReferencePosRelativeToOffsetParent:function(){var s={my:this.position.my,at:this.position.at,of:this.position.of,offsetX:0,offsetY:0};return b.getPositionRelativeToOffsetParent(this,s)},_fireAndBroadcast:function(t,s){this.fire(t,s)},_onDragPointerDown:function(x){if(this.disabled){return}document.body.setAttributeNode(document.createAttribute("dragging"));var w=this;function u(A){A.preventDefault();w._onDragPointerMove(A)}function s(A){w._onDragPointerUp(A);m.removeEventOnElement(w,document,f.POINTERMOVE,u);m.removeEventOnElement(w,document,f.POINTERUP,s);w._savePositionInPreferences();w._saveDimensionsInPreferences();w._saveMaximizeInPreferences();document.body.removeAttribute("dragging");if(w.immersiveFrame){w.immersiveFrame._resetStackedWindowData()}}w.addEventListener("close",function(A){m.removeEventOnElement(w,document,f.POINTERMOVE,u);m.removeEventOnElement(w,document,f.POINTERUP,s)});if(this.getMovableState()){if(!this.getFloatableState()){if(this.immersiveFrame){this.elements._ghostFloatableElement.inject(this.immersiveFrame.elements.container)}this.elements._ghostFloatableElement.setStyles({width:this.elements.container.getStyle("width"),height:this.elements.container.getStyle("height")});if(!this._initialGhostWindowOffset){this._initialGhostWindowOffset={x:0,y:0}}var y=this.getPositionRelativeToOffsetParent();var t=this._getReferencePosRelativeToOffsetParent();this._initialGhostWindowOffset.x=y.x-t.x;this._initialGhostWindowOffset.y=y.y-t.y}this._initialPointerPosition.x=x.clientX;this._initialPointerPosition.y=x.clientY;var z=this.getPositionRelativeToOffsetParent();var v=this._getReferencePosRelativeToOffsetParent();this._initialWindowOffset.x=z.x-v.x;this._initialWindowOffset.y=z.y-v.y;m.addEventOnElement(this,document,f.POINTERMOVE,u);m.addEventOnElement(this,document,f.POINTERUP,s);this.fire("startWindowDrag")}},_onDragPointerMove:function(x){if(!this.disabled&&(x.button===0)){x.preventDefault();var u=x.clientX-this._initialPointerPosition.x;var t=x.clientY-this._initialPointerPosition.y;if(u!==0||t!==0){var s=Object.assign({},this.position);this.modifyObjectFromUIInteraction("position",{offsetX:this._initialWindowOffset.x+u,offsetY:this._initialWindowOffset.y+t});if(!this.getFloatableState()){if(!this.ghostPosition){this.ghostPosition=this.position}this.ghostPosition.offsetX=this._initialGhostWindowOffset.x+u;this.ghostPosition.offsetY=this._initialGhostWindowOffset.y+t;b.setPosition(this.elements._ghostFloatableElement,this.ghostPosition);this.elements._ghostFloatableElement.show()}else{if(this.maximizedFlag&&(Math.abs(u)>15||Math.abs(t)>15)){this.setPropertyFromUIInteraction("maximizedFlag",false);this._saveMaximizeInPreferences();var w={};w.x=x.clientX;w.y=x.clientY;this._ensureTitleBarUnderPointer(w)}}var v=this.immersiveFrame?this.immersiveFrame._computeFiringWindowDragEvents(this):this;v.fire("windowDrag",{x:x.clientX,y:x.clientY,deltaX:u,deltaY:t})}}},_onDragPointerUp:function(s){this.elements._ghostFloatableElement.hide();this._setFocus(this.elements._contentDiv);this.fire("stopWindowDrag",{x:s.clientX,y:s.clientY})},_onCloseButtonClick:function(s){this.callMethodFromUIInteraction("close")},_onMaximizeButtonClick:function(s){if(this.allowMaximizeFlag){this.setPropertyFromUIInteraction("maximizedFlag",!this.maximizedFlag)}},handleEvents:function(){var D=this;m.addEventOnElement(this,document,"touchChange",function(){D._applyWidth();D._applyHeight();D._applyPosition()});m.addEventOnElement(this,this.getContent(),"dimensionsChanged",function(K){if(D.height===-1||D.maximizedFlag){D._updateContentHeight()}if(D.height===-1||D.width===-1){D._applyPosition();if(D.windowGroup){D.windowGroup._updateTitleBarWidth()}else{D._updateTitleBarWidth()}}if(D.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var J=D.immersiveFrame.getDockingElement(D.currentDockArea);if(J){J._pointerEventsAllIfOverflow()}}K.stopPropagation()});m.addEventOnElement(this,this.elements.container,"keydown",function(K){var J=null;switch(K.keyCode){case k.ENTER:J=D.defaultButton;D._keydownPressed=k.ENTER;break;case k.ESCAPE:J=D.escapeButton;D._keydownPressed=k.ESCAPE;break}if(J){K.stopPropagation()}});m.addEventOnElement(this,this.elements.container,"keyup",function(L){var K=null;if(!L.altKey&&!L.shiftKey&&!L.ctrlKey){switch(L.keyCode){case k.ENTER:K=D.defaultButton;break;case k.ESCAPE:K=D.escapeButton;break}if(K&&typeof D._keydownPressed!=="undefined"&&(D.activateButtonsIfActionPerformed||!L.actionPerformed)){D._keydownPressed=undefined;var J=document.createEvent("MouseEvents");J.initEvent("click",true,true);K.elements.button.dispatchEvent(J);L.stopPropagation();L.preventDefault()}}});if(!this._initialPointerPosition){this._initialPointerPosition={x:0,y:0}}if(!this._initialWindowOffset){this._initialWindowOffset={x:0,y:0}}if(!this._initialWindowSize){this._initialWindowSize={height:0,width:0}}function E(J){if(D.disabled){return}D.setPropertyFromUIInteraction("activeFlag",true)}m.addEventOnElement(this,D.elements.container,f.POINTERDOWN,E);function s(J){if(D.disabled){return}D.setPropertyFromUIInteraction("activeFlag",true);if(((J.target===D.elements._titleBarDiv)||(J.target===D.elements.iconPlaceholder)||(J.target===D.elements._titleP))&&(J.button===0)){D._onDragPointerDown(J)}}m.addEventOnElement(this,D.elements._titleBarDiv,f.POINTERDOWN,s);m.addEventOnElement(this,D.elements._titleBarDiv,f.POINTERHIT,function(J){if(J.multipleHitCount!==2){return}J.preventDefault();if(D.getCollapsibleState()&&((J.target===D.elements._titleBarDiv)||(J.target===D.elements.iconPlaceholder)||(J.target===D.elements._titleP))){J.stopPropagation();D.setPropertyFromUIInteraction("expandedFlag",!D.expandedFlag)}});var C=function(J,L){D._deltaPositionY=J-D._initialPointerPosition.y;if(D.position.collision==="fit"&&(D._initialBoundingRect.top+D._deltaPositionY)<0){D._deltaPositionY=-(D._initialBoundingRect.top)}var K=D._initialWindowSize.height-D._deltaPositionY;if(K<L){D._deltaPositionY=D._initialWindowSize.height-L}};function v(J){J.preventDefault();var K=D._getFixedContentHeight();C(J.clientY,K);D.setPropertyFromUIInteraction("height",D._initialWindowSize.height-D._deltaPositionY);D._deltaPositionY=D._initialWindowSize.height-D.height;n.call(D,null,"top","topHandlerPointerMove")}var u=function(J,N){D._deltaPositionY=J-D._initialPointerPosition.y;var M=D.immersiveFrame?D.immersiveFrame.getContent().clientHeight-D.immersiveFrame.getContent().clientTop:(document.body.clientHeight||window.innerHeight);var L=M-D._initialBoundingRect.bottom-D._deltaPositionY;if(D.position.collision==="fit"&&L<0){D._deltaPositionY=M-D._initialBoundingRect.bottom}var K=D._initialWindowSize.height+D._deltaPositionY;if(K<N){D._deltaPositionY=N-D._initialWindowSize.height}};function x(J){J.preventDefault();var K=D._getFixedContentHeight();u(J.clientY,K);D.setPropertyFromUIInteraction("height",D._initialWindowSize.height+D._deltaPositionY);D._deltaPositionY=D.height-D._initialWindowSize.height;n.call(D,null,"bottom","bottomHandlerPointerMove")}var w=function(J){D._deltaPositionX=J-D._initialPointerPosition.x;var L=D.immersiveFrame?D.immersiveFrame.getContent().clientWidth-D.immersiveFrame.getContent().clientLeft:(document.body.clientWidth||window.innerWidth);if(D.position.collision==="fit"&&(D._deltaPositionX>L-D._initialBoundingRect.right)){D._deltaPositionX=L-D._initialBoundingRect.right}var K=D._initialWindowSize.width+D._deltaPositionX;if(K<0){D._deltaPositionX=-(D._initialWindowSize.width)}};function I(K){K.preventDefault();w(K.clientX);var J=D._deltaPositionX;if(D.currentDockArea===WUXDockAreaEnum.BottomDockArea&&D.immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea).alignment==="center"){J=2*D._deltaPositionX}D.setPropertyFromUIInteraction("width",D._initialWindowSize.width+J);D._deltaPositionX=D.width-D._initialWindowSize.width;n.call(D,"right",null,"rightHandlerPointerMove")}var z=function(J){D._deltaPositionX=J-D._initialPointerPosition.x;if(D.position.collision==="fit"&&(D._initialBoundingRect.left+D._deltaPositionX)<0){D._deltaPositionX=-(D._initialBoundingRect.left)}var K=D._initialWindowSize.width-D._deltaPositionX;if(K<0){D._deltaPositionX=D._initialWindowSize.width}};function G(J){J.preventDefault();z(J.clientX);D.setPropertyFromUIInteraction("width",D._initialWindowSize.width-D._deltaPositionX);D._deltaPositionX=D._initialWindowSize.width-D.width;n.call(D,"left",null,"leftHandlerPointerMove")}function B(J){v.call(D,J);G.call(D,J)}function A(J){v.call(D,J);I.call(D,J)}function t(J){x.call(D,J);I.call(D,J)}function H(J){x.call(D,J);G.call(D,J)}function F(K){D._fireAndBroadcast("stopResize");m.removeEventOnElement(D,document,f.POINTERMOVE,v);m.removeEventOnElement(D,document,f.POINTERMOVE,I);m.removeEventOnElement(D,document,f.POINTERMOVE,x);m.removeEventOnElement(D,document,f.POINTERMOVE,G);m.removeEventOnElement(D,document,f.POINTERMOVE,B);m.removeEventOnElement(D,document,f.POINTERMOVE,A);m.removeEventOnElement(D,document,f.POINTERMOVE,t);m.removeEventOnElement(D,document,f.POINTERMOVE,H);m.removeEventOnElement(D,document,f.POINTERUP,F);document.body.removeAttribute("resizing");if(D.immersiveFrame){var J=D.immersiveFrame.getDockingElement(D.currentDockArea);if(J){D.managePointerEvents();J._scrollToBottom()}}D._saveDimensionsInPreferences();D._savePositionInPreferences()}function y(K){if(D.disabled){return}document.body.setAttributeNode(document.createAttribute("resizing"));D.setPropertyFromUIInteraction("activeFlag",true);D._initialPointerPosition.x=K.clientX;D._initialPointerPosition.y=K.clientY;D._initialBoundingRect=D.elements.container.getBoundingClientRect();if(D.immersiveFrame&&D.currentDockArea===WUXDockAreaEnum.NoneDockArea){D._initialBoundingRect=c.call(D)}D._initialWindowSize.width=D.elements._mainContentDiv.clientWidth;D._initialWindowSize.height=D.elements._mainContentDiv.clientHeight;var L=D.getPositionRelativeToOffsetParent();var J=D._getReferencePosRelativeToOffsetParent();D._initialWindowOffset.x=L.x-J.x;D._initialWindowOffset.y=L.y-J.y}if(this.elements._resizeZone){m.addEventOnElement(this,this.elements._resizeZone,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,t);m.addEventOnElement(D,document,f.POINTERUP,F)})}m.addEventOnElement(this,this.elements._topResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"top",cursor:"s-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,v);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._bottomResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"bottom",cursor:"s-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,x);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._rightResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"right",cursor:"w-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,I);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._leftResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"left",cursor:"w-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,G);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._topLeftResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"top left",cursor:"nw-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,B);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._topRightResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"top right",cursor:"sw-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,A);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._bottomRightResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,t);m.addEventOnElement(D,document,f.POINTERUP,F)});m.addEventOnElement(this,this.elements._bottomLeftResizeHandler,f.POINTERDOWN,function(J){D._fireAndBroadcast("startResize",{side:"bottom left",cursor:"sw-resize"});y(J);m.addEventOnElement(D,document,f.POINTERMOVE,H);m.addEventOnElement(D,document,f.POINTERUP,F)})},_hasValidIdentifier:function(){if(this.identifier!==""){var s=Math.floor(Number(this.identifier));return((s<0)||(String(s)!==this.identifier))}return false},_saveDataInPreferences:function(s,t){if(this._hasValidIdentifier()){b.saveDataInLocalPreferences(this,windowPrefKey,s,t)}},_getDataFromPreferences:function(s){var t=undefined;if(this._hasValidIdentifier()){t=b.getDataFromLocalPreferences(this,windowPrefKey,s)}return t},_savePositionInPreferences:function(){if(this.identifier){var t=this;if(this.windowGroup){t=this.windowGroup}var u={my:t.position.my,at:t.position.at,collision:t.position.collision,offsetX:t.position.offsetX,offsetY:t.position.offsetY};var s="position";this._saveDataInPreferences(s,u);if(this._savedPreferencesKeys.indexOf(s)===-1){this._savedPreferencesKeys.push(s)}}},_getPositionFromPreferences:function(){return this._getDataFromPreferences("position")},_saveDimensionsInPreferences:function(){if(this.identifier){var t={height:this.height,width:this.width};var s="dimension";this._saveDataInPreferences(s,t);if(this._savedPreferencesKeys.indexOf(s)===-1){this._savedPreferencesKeys.push(s)}}},_getDimensionsFromPreferences:function(){return this._getDataFromPreferences("dimension")},_saveDockAreaInPreferences:function(){if(this.identifier){var t=this.currentDockArea;var s="dockArea";this._saveDataInPreferences(s,t);if(this._savedPreferencesKeys.indexOf(s)===-1){this._savedPreferencesKeys.push(s)}}},_getDockAreaFromPreferences:function(){return this._getDataFromPreferences("dockArea")},_saveMaximizeInPreferences:function(){if(this.identifier){var s=this.maximizedFlag;var t="maximizedFlag";this._saveDataInPreferences(t,s);if(this._savedPreferencesKeys.indexOf(t)===-1){this._savedPreferencesKeys.push(t)}}},_getMaximizedFlagFromPreferences:function(){return this._getDataFromPreferences("maximizedFlag")},_getWindowGroupAsTabFromPreferences:function(){var s=this._getDataFromPreferences("windowGroupAsTab");if(!s){s=[]}return s},_saveWindowGroupAsTabInPreferences:function(s){this._saveDataInPreferences("windowGroupAsTab",s)},_getSnappingFromPreferences:function(){var s=this._getDataFromPreferences("windowGroupAsGrid");if(!s){s=[]}return s},_saveSnappingInPreferences:function(s){this._saveDataInPreferences("windowGroupAsGrid",s)},_getDetachedFromPreferences:function(){var s=this._getDataFromPreferences("detachedFrom");if(!s){s=[]}return s},_saveDetachedInPreferences:function(s){this._saveDataInPreferences("detachedFrom",s)},_saveWindowGroupInPreferences:function(t){if(this.isAWindowGroup()){var B=this.getEmbeddedWindows();for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){if(t&&(!t.isAWindowGroup()||t.getEmbeddedWindows().length!==0)){v._saveWindowGroupInPreferences(t)}}}return}else{if(this.identifier){if(t){var C=this._getDetachedFromPreferences();if(t.isAWindowGroup()){var B=t.getEmbeddedWindows();for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){if((C.length===0||C.indexOf(v.identifier)===-1)&&v.identifier!==this.identifier){C.push(v.identifier)}else{}var u=v._getDetachedFromPreferences();if(u.length===0||u.indexOf(this.identifier)===-1){u.push(this.identifier);v._saveDetachedInPreferences(u)}else{}}}}else{if(typeof t.identifier!=="undefined"&&(C.length===0||C.indexOf(t.identifier)===-1)){C.push(t.identifier)}else{}var x=t._getDetachedFromPreferences();if((x.length===0||x.indexOf(this.identifier)===-1)&&typeof t.identifier!=="undefined"){x.push(this.identifier);t._saveDetachedInPreferences(x)}else{}}this._saveDetachedInPreferences(C);if(t.isAWindowGroup()){var B=t.getEmbeddedWindows();var A=this._getWindowGroupAsTabFromPreferences();for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,v.identifier,this._getWindowGroupAsTabFromPreferences()));v._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(v,this.identifier,v._getWindowGroupAsTabFromPreferences()))}}}else{if(typeof t.identifier!=="undefined"){this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,t.identifier,this._getWindowGroupAsTabFromPreferences()));t._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(t,this.identifier,t._getWindowGroupAsTabFromPreferences()))}}if(this.windowGroup){this._saveWindowGroupInPreferences()}}else{if(this.windowGroup){var E=this.windowGroup;var s;if(E.groupType===WUXWindowGroupTypeEnum.GroupAsTab){var w=[];if(E.windowGroup&&E.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsGrid){s=E.windowGroup}var B=E.getEmbeddedWindows();for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){w.push(v.identifier)}}for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){v._saveWindowGroupAsTabInPreferences(v._addWGAsTabPreferences(w))}}for(var z=0;z<B.length;z++){var v=B[z];if(v&&typeof v.identifier!=="undefined"){var C=v._getDetachedFromPreferences();if(v.identifier===this.identifier){for(var y=0;y<w.length;y++){var D=w[y];if(C.indexOf(D)!==-1){C.splice(C.indexOf(D),1)}}v._saveDetachedInPreferences(C)}else{if(C.indexOf(this.identifier)!==-1){C.splice(C.indexOf(this.identifier),1);v._saveDetachedInPreferences(C)}}}}}else{if(E.groupType===WUXWindowGroupTypeEnum.GroupAsGrid){s=E}}if(s){}}else{console.log("Saving the preferences of a Window that is being attached to nothing... failed")}}}}},_locateAndRemoveWindowFromWGAsTabPreferencesArray:function(v,s,w){for(var t=0;t<w.length;t++){var u=w[t];if(u.indexOf(s)!==-1){u.splice(u.indexOf(s),1);if(u.length===1){if(u[0]===v.identifier){w.splice(t,1)}else{console.log("There is a WindowGroup preferences that is composed of only one Window, but it is not the Window in question")}}break}}return w},_addWGAsTabPreferences:function(t){var v=this._getWindowGroupAsTabFromPreferences();if(v.indexOf(t)!==-1){console.log("preferences for this WindowGroup have already been saved : "+this.identifier);return}for(var s=0;s<t.length;s++){var u=t[s];if(u!==this.identifier){v=this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,u,v)}}v.push(t);return v},_readWindowPreferences:function(){if(this._hasValidIdentifier()&&this.visibleFlag&&this.immersiveFrame&&this.immersiveFrame.containsWindow(this)&&!this._arePreferencesApplied){if(this.visibleFlag){var A=this._getDimensionsFromPreferences();if(A){this.height=A.height;this.width=A.width}}var w=this._getDockAreaFromPreferences();if(w!==undefined){this.currentDockArea=w}var D=this._getMaximizedFlagFromPreferences();if(D!==undefined){this.maximizedFlag=D}var E=this._getWindowGroupAsTabFromPreferences();if(E&&E.length>0){for(var s=E.length-1;s>=0;s--){var u=E[s];var G,y;var C;for(var z=0;z<u.length;z++){var t=u[z];if(t===this.identifier){G=z}else{if(this.immersiveFrame.windows[t]){if(G!==undefined){if(C){if(G-y>z-G){C=t;y=z;break}else{break}}else{C=t;y=z;break}}else{C=t;y=z}}}}if(G!==undefined&&C&&y!==undefined){var B=G<y?"before":"after";var v=this.immersiveFrame.windows[C];if(v.currentDockArea===this.currentDockArea&&v.maximizedFlag===this.maximizedFlag){this.attachToWindow(v,WUXSnapAreaEnum.InsideArea,B);break}else{C=undefined;y=undefined;G=undefined}}}}var F=this._getPositionFromPreferences();if(F){var x={};x.at=F.at;x.collision=F.collision;x.my=F.my;x.offsetX=F.offsetX;x.offsetY=F.offsetY;if(this.windowGroup){this.windowGroup.position=x}else{this.position=x}}this._arePreferencesApplied=true}},deleteWindowPreferences:function(){for(var w=0;w<this._savedPreferencesKeys.length;w++){var B=this._savedPreferencesKeys[w];b.deleteDataFromLocalPreferences(this,windowPrefKey,B)}var C=this._getDetachedFromPreferences();for(var w=0;w<C.length;w++){var y=C[w];var A=b.getDataFromLocalPreferences(y,windowPrefKey,"detachedFrom");A.splice(A.indexOf(this.identifier),1);b.saveDataInLocalPreferences(y,windowPrefKey,"detachedFrom",A)}b.deleteDataFromLocalPreferences(this,windowPrefKey,"detachedFrom");var s=this._getWindowGroupAsTabFromPreferences();for(var w=0;w<s.length;w++){var D=s[w];for(var v=0;v<D.length;v++){var x=D[v];if(x===this.identifier){continue}var z=b.getDataFromLocalPreferences(x,windowPrefKey,"windowGroupAsTab");if(z){for(var u=0;u<z.length;u++){var t=z[u];if(t.indexOf(this.identifier)!==-1){t.splice(t.indexOf(this.identifier),1)}if(t.length<=1){z.splice(u,1)}}b.saveDataInLocalPreferences(x,windowPrefKey,"windowGroupAsTab",z)}}}b.deleteDataFromLocalPreferences(this,windowPrefKey,"windowGroupAsTab")},_locateAndModifyWindowGroup:function(t){var s=t}});var n=function(v,t){var u=false;var s=undefined,y=undefined;if(t&&this.height>=this.minHeight){var x=this._getFixedContentHeight();if(this.height>=x){if(this.position.my.indexOf(t)>-1){y=this._initialWindowOffset.y+this._deltaPositionY;u=true}if((this.position.my.indexOf("center")>-1)||this.position.my==="left"||this.position.my==="right"){y=this._initialWindowOffset.y+(this._deltaPositionY/2);u=true}}}if(v&&this.width>=this.minWidth){if(this.position.my.indexOf(v)>-1){s=this._initialWindowOffset.x+this._deltaPositionX;u=true}if((this.position.my.indexOf("center")>-1)||this.position.my==="top"||this.position.my==="bottom"){s=this._initialWindowOffset.x+(this._deltaPositionX/2);u=true}}var w={};if(s!==undefined){w.offsetX=s}if(y!==undefined){w.offsetY=y}this.modifyObjectFromUIInteraction("position",w);return u};var c=function(){if(this.immersiveFrame){var s={};s.top=this.getContent().offsetTop-this.immersiveFrame.getContent().offsetTop;s.height=this.getContent().clientHeight;s.bottom=s.top+s.height;s.left=this.getContent().offsetLeft-this.immersiveFrame.getContent().offsetLeft;s.width=this.getContent().clientWidth;s.right=s.left+s.width;return s}};o.register(e,"DS/ControlsRec/AbstractRec");return e});define("DS/Windows/Dialog",["UWA/Core","DS/Windows/Window","DS/Controls/Button","DS/Utilities/Dom"],function(f,c,d,b){var a=c.inherit({name:"dialog",_modalDiv:undefined,publishedProperties:{modalFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},buildView:function(){var g=this;this._parent();this.elements.container.addClassName("wux-windows-dialog");this.elements._footerDiv=new f.Element("div",{"class":"wux-windows-dialog-footer"});this.elements._footerDiv.inject(this.elements._mainContentDiv);this.elements._buttonsDiv=new f.Element("div",{"class":"wux-windows-dialog-buttons"});this.elements._buttonsDiv.inject(this.elements._footerDiv);this.elements._resizeZone=new f.Element("div",{"class":"wux-windows-dialog-resize-zone"});this.elements._resizeZone.inject(this.elements._footerDiv);this._applyCurrentDockArea();b.onNodeRendered(this.getContent(),function(){g._applyMinWidth()})},_applyRecId:function(h){this._parent(h);if(this.buttons){var l=Object.keys(this.buttons);for(var k=0;k<l.length;k++){var g=l[k];var j=this.buttons[g];if(j&&(j instanceof d&&!j.recId)){j.recId=this.recId+"_"+g}}}},_applyImmersiveFrame:function(g){this._parent(g);this._applyModalFlag()},_applyResizableFlag:function(g){this._parent(g);if(this.resizableFlag){this.elements._resizeZone.show();this.elements._footerDiv.addClassName("resize-padding")}else{this.elements._resizeZone.hide();this.elements._footerDiv.removeClassName("resize-padding")}},_applyPosition:function(g){if(!this.position){this.position={}}if(!this.position.my){this.position.my="center"}if(!this.position.at){this.position.at="center"}this._parent(g)},_applyButtons:function(h){this._parent(h);if(this.buttons){var l=Object.keys(this.buttons);for(var k=0;k<l.length;k++){var g=l[k];if(g&&WUXStandardButtonEnum[g]){var j=this.buttons[g];if(j&&(j instanceof d)){if(!j.label){j.label=this.getDefaultButtonLabel(g)}if(this.recId&&!j.recId){j.recId=this.recId+"_"+g}var m=WUXStandardButtonEnum[g].role;if((m===WUXStandardButtonRoleEnum.AcceptRole)||(m===WUXStandardButtonRoleEnum.YesRole)){j.emphasize="primary"}else{j.emphasize="secondary"}}}}}if(this.elements._buttonsDiv.childNodes.length===0){this.elements._footerDiv.hide()}else{this.elements._footerDiv.show()}this._applyMinWidth()},_applyMinWidth:function(){this._parent();var g=e.call(this);if(g>this.minWidth){this.minWidth=g}},_updateTitleMaxWidth:function(){var g=this.elements._titlebarButtonsDiv.clientWidth;this.elements._titleDiv.setStyle("max-width","calc(100% - "+g+"px)")},_applyModalFlag:function(){if(this.elements.container===undefined){return}var h=this.isDirty("modalFlag");if(this.modalFlag===true){this.elements.container.setAttributeNode(document.createAttribute("modal"));var g=this.elements.container.parentNode;if(g&&!this._modalDiv){this._modalDiv=new f.Element("div",{"class":"wux-windows-modalDialog"});var i=this._modalDiv;g.removeChild(this.elements.container);i.appendChild(this.elements.container);if(g.dsModel&&g.dsModel.rootContainer!==undefined){g=g.dsModel.rootContainer}g.appendChild(i);i.show()}}else{this.elements.container.removeAttribute("modal");var i=this._modalDiv;if(i&&i.hasClassName("wux-windows-modalDialog")){if(this.immersiveFrame){this._moveToImmersiveFrame()}else{var g=i.getParent();if(g!==undefined){g.removeChild(i);i.removeChild(this.elements.container);g.appendChild(this.elements.container)}}i.destroy();this._modalDiv=null}}},_moveToImmersiveFrame:function(){if(this.immersiveFrame&&!this.modalFlag){this.immersiveFrame.moveWindowToImmersiveFrame(this)}else{if(this.modalFlag){this._modalDiv.appendChild(this.elements.container)}}},_applyVisibleFlag:function(g){if(this.modalFlag===true){var h=this._modalDiv;if(h!==undefined){if(this.visibleFlag===false){h.hide()}else{h.show()}}}this._parent(g)},_applyProperties:function(g){var h=this.isDirty("modalFlag");this._parent(g);if(h){this._applyModalFlag()}if(this.isDirty("resizableFlag")){this._applyResizableFlag()}},_applyCurrentDockArea:function(h){this._parent(h);var g=this.elements._titleBarDiv.clientHeight;if(this.elements._buttonsDiv.childNodes.length>0){g=g+this.elements._footerDiv.clientHeight}if(g!==0){this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+g+"px)")}},_applyMaximizedFlag:function(h){if(this.immersiveFrame){this._updateFromCollapsibleState();if(h!==undefined&&this.maximizedFlag!==h){this.fire("prePlaceChange",{previousPlace:{maximizedFlag:h}})}if(this.maximizedFlag&&this.allowMaximizeFlag){var g=document.createAttribute("maximized");this.getContent().setAttributeNode(g);if(this.elements._maximizeButton){this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-full");this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small")}}else{this.getContent().removeAttribute("maximized");if(this.elements._maximizeButton){this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-small");this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full")}}this._updateContentHeight();if(h!==undefined&&this.maximizedFlag!==h){this._updateContentVisibleStateChange();this.fire("placeChange");this._fireAndBroadcast("resize,",{bubbles:false})}}},destroy:function(){if(this._modalDiv){var g=this._modalDiv;this._modalDiv=null;this._parent();g.destroy()}else{this._parent()}}});var e=function(){if(this.buttons){var m=0;for(var g in this.buttons){var h=(window.getComputedStyle(this.buttons[g].getContent()))?window.getComputedStyle(this.buttons[g].getContent()).getPropertyValue("min-width"):"";h=(h==="")?0:parseInt(h,10);var j=(window.getComputedStyle(this.buttons[g].getContent()))?window.getComputedStyle(this.buttons[g].getContent()).getPropertyValue("margin-left"):"";j=(j==="")?0:parseInt(j,10);var i=(window.getComputedStyle(this.buttons[g].getContent()))?window.getComputedStyle(this.buttons[g].getContent()).getPropertyValue("margin-right"):"";i=(i==="")?0:parseInt(i,10);m=m+h+j+i}var k,l=0;if(this.elements._footerDiv){k=(window.getComputedStyle(this.elements._footerDiv))?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-left"):"";l=(window.getComputedStyle(this.elements._footerDiv))?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-right"):"";k=(k==="")?0:parseInt(k,10);l=(l==="")?0:parseInt(l,10)}m=m+k+l;return m}return 0};return a});define("DS/Tweakers/TweakerUtils",["UWA/Core","UWA/Element","DS/Core/Core","DS/Controls/Popup","DS/Controls/Button","DS/Core/PointerEvents","DS/Windows/Dialog","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(f,b,j,e,h,g,l,n,a,d){var c=[];var m={init:function(){},addTypeRepFactory:function(o){c.push(o)},removeTypeRepFactory:function(p){var o=c.indexOf(p);if(o!==-1){c.splice(o,1)}},getTypePath:function(q){var s=false;var o=0;while(!s&&o<c.length){if(c&&c[o].typeReps[q]){s=true;var p=c[o].typeUITemplates[c[o].typeReps[q].stdTemplate];var r=c[o].typeReps[q].semantics;return{path:p.path,options:r}}else{if(c&&c[o].typeEnums[q]){return{path:"DS/Tweakers/TweakerEnum",options:c[o].typeEnums[q]}}}o++}},_isFromType:function(q,r){var o=this.getTypePath(q);if(!o){return r}var p=true;switch(o.path){case"DS/Tweakers/TweakerBoolean":p=(/^(true|false|\d+(.\d+)?)$/i.exec(r)!==null);break;case"DS/Tweakers/TweakerString":case"DS/Tweakers/TweakerColor":case"DS/Tweakers/TweakerDate":p=(typeof r==="string");break;case"DS/Tweakers/TweakerNumber":if(o.options&&o.options.decimals===0){p=(parseInt(r,10)===r)}else{p=(parseFloat(r)===r)}break;case"DS/Tweakers/TweakerArray":p=(r.length!=="undefined");break;default:p=true}return p},_getValueFromString:function(r,t,s){var o=this.getTypePath(r);if(!o){return t}var q;switch(o.path){case"DS/Tweakers/TweakerBoolean":q=(/(true|\d*[1-9]\d*(\.\d+)?|0\.\d*[1-9]\d*)/i.exec(t)!==null);break;case"DS/Tweakers/TweakerString":case"DS/Tweakers/TweakerColor":case"DS/Tweakers/TweakerDate":t?q=t.toString():q="";break;case"DS/Tweakers/TweakerNumber":if(t===""){q=0;break}if(o.options&&o.options.decimals===0){q=parseInt(t)}else{q=parseFloat(t)}break;case"DS/Tweakers/TweakerArray":case"DS/Tweakers/TweakerObject":try{q=JSON.parse(t)}catch(u){q=undefined}break;case"DS/Tweakers/TweakerEnum":if(t===""){q=undefined;break}if(!o.options){return}var v=o.options;if(typeof v==="function"){return t}for(var p in v){if(v[p].toString()==t){return v[p]}}if(s===true){for(var p in v){if(p.toString()==t){return v[p]}}}break;default:q=t}return q},_getStringRepresentationFromValue:function(r,s){var o=this.getTypePath(r);if(!o){return s}var q;switch(o.path){case"DS/Tweakers/TweakerEnum":if(s===""){q=undefined;break}if(!o.options){return}var t=o.options;if(typeof t==="function"){return s}for(var p in t){if(t[p]==s){return p}}break;default:q=s}return q},_buildInlineEditor:function(v,t,s,r){var q=f.createElement("div",{"class":"wux-tweakers-multirep wux-tweakers-multirep-inline-editor"});if(t){q.inlinedView=t;if(t._view){var o=t._view;o.getContent().addClassName("wux-tweakers-multirep-tweakerstring");o.inject(q)}else{t.addClassName("wux-tweakers-multirep-tweakerstring");q.appendChild(t)}}if(!r.hasNoButton){q.editBtn=new h({label:"..."});q.editBtn.getContent().addClassName("wux-tweakers-multirep-button");q.editBtn.inject(q)}q.embeddedContainer=undefined;var u=undefined;if(s){var p=function(w){w.stopPropagation();if(u&&u!==v.augmentedDisplay){q.embeddedContainer.destroy()}u=v.augmentedDisplay;if(v.augmentedDisplay==="dialog"){if(!q.embeddedContainer){q.embeddedContainer=m._buildDialog(q,v,s,r);v.onShow()}if(!q.embeddedContainer){return}if(q.embeddedContainer.visibleFlag===false){q.embeddedContainer.visibleFlag=true;v.onShow()}}else{if(v.augmentedDisplay==="popup"){if(!q.embeddedContainer){q.embeddedContainer=m._buildPopup(q,v,t,s,r)}if(!q.embeddedContainer){return}q.embeddedContainer._updateView();q.embeddedContainer.toggle()}}if(s._view&&s._view._giveFocus){s._view._giveFocus()}};if(r.hasNoButton){a.addEventOnElement(v,t,"click",p)}else{a.addEventOnElement(v,q.editBtn,"buttonclick",function(w){w.stopPropagation()});a.addEventOnElement(v,q.editBtn,"click",p);if(r.offset&&t._myInput){a.addEventOnElement(v,t._myInput,"focus",p)}}}return q},_buildPopup:function(p,r,t,w,x){if(w){var y=r.name?r.name.toLowerCase().replace("tweaker",""):"multi-rep";var s=x.hasNoButton?t:p.editBtn;var o=new e({target:s,position:"bottom",offset:{x:0,y:(x.offset?-t.offsetHeight:0)},alignment:"far",className:"wux-controls-popup wux-controls-popup-tweaker-"+y,touchMode:r.touchMode});d.ignoreForRecord(o.getContent());o.getContent().setStyle("height","176px");o.getContent().setStyle("width",((t&&t._view)?t._view.getContent().offsetWidth:t.offsetWidth)+(p.editBtn?p.editBtn.getContent().offsetWidth:0)+"px");o._updateView();var q=function(z){if(o.visibleFlag&&!o.isElementInside(z.target)&&(!p.editBtn||!p.editBtn.getContent().contains(z.target))){o.hide();document.body.removeEventListener(g.POINTERDOWN,q)}};var v=false;a.addEventOnElement(r,o,"show",function(z){z.stopPropagation();a.addEventOnElement(r,document.body,g.POINTERDOWN,q);r.onShow()});a.addEventOnElement(r,o,"hide",function(z){z.stopPropagation();r.onHide({cancelFlag:v})});a.addEventOnElement(r,o,"keydown",function(z){if(!z.altKey&&!z.shiftKey&&!z.ctrlKey){if(z.keyCode===n.ESCAPE){v=true;o.hide();v=false}else{if(z.keyCode===n.ENTER){o.hide()}}}});var u=w._view?w._view:w;o.setBody(u);return o}return undefined},_buildDialog:function(p,r,v){var t=undefined;var s=function(x){x.stopPropagation();t.visibleFlag=false;r.onHide({cancelFlag:true})};t=new l({title:r.dialogOptions.title?r.dialogOptions.title:r.name,icon:r.dialogOptions.icon,content:v,resizableFlag:true,height:r.dialogOptions.height?r.dialogOptions.height:240,width:r.dialogOptions.width?r.dialogOptions.width:200,identifier:r.dialogOptions.identifier?r.dialogOptions.identifier:"",buttons:{Ok:new h({onClick:function(y){y.stopPropagation();t.visibleFlag=false;var x=document.createEvent("Event");r.onHide()}}),Cancel:new h({onClick:s})},autoCloseFlag:false,touchMode:r.touchMode});d.ignoreForRecord(t.getContent());var w=r.name?r.name.toLowerCase().replace("tweaker",""):"multi-rep";t.getContent().addClassName("wux-tweakers-multirep-"+w);a.addEventOnElement(r,t,"close",s);var u=k.call(this,r.getContent());if(u){u.addWindow(t)}else{if(document.body){t.inject(document.body);t.getContent().setStyle("z-index",1000)}}var o=i.call(this,r.getContent());var q=o&&o.modalFlag;if(q){r.dialogOptions.modalFlag=true}t.modalFlag=r.dialogOptions.modalFlag;t.position={at:"center center",my:"center center"};return t},enableLiveChangeOnTreeListView:function(o){o.getManager()._getParent().elements.formContainer.addEvent("liveChange",o.getManager()._onCellChange.bind(o.getManager()))},onLoad:function(){},_setModelViewForDataColumnOneColumnCase:function(v,D){function s(){var E="",F=D.nodeModel.options.grid;if(v.valueType!==""&&v.valueType!==undefined){E=v.valueType+"."+(F.path?F.path:F.name);if(F.type!==undefined&&F.type!==""){E+="#"+F.type}else{if(F.defaultType!==undefined&&F.defaultType!==""){E+="#"+F.defaultType}}}else{if(F.data&&typeof(F.data)==="string"&&F.data.indexOf("[")===0){E="array"}else{E=F.type||F.typeRep}}return E}var A=D.cellView.getContent();var q=D.nodeModel.options;var t=q.grid;var w=(typeof t.data!=="undefined")?t.data:((t.defaultValue!==undefined)?t.defaultValue:undefined);var z=s();var C=undefined;if(t.readOnly!==undefined||(v.readOnly&&v.permanentReadOnly)){C=t.readOnly||(v.readOnly&&v.permanentReadOnly)}var x={typePath:z,readOnly:C,disabled:q.disabled,touchMode:t.touchMode,required:t.required,icon:(t.semantics&&t.semantics.icon)?t.semantics.icon:undefined,context:"inlinedTemplate",onViewCreated:function(E){if(E!==undefined){A.setContent(E);if(A){if(!E.readOnly){A.setAttribute("draggable",false)}}}},onFailure:function(E){t._buildFailure=true;if(typeof v.onFailure==="function"){v.onFailure(E)}}};if(v.displayMode==="oneColumn"){var r,u,y,p,B;B=f.createElement("div");(y=f.createElement("div",{"class":"label"})).inject(B);(r=f.createElement("div",{"class":"label",styles:{width:"50%",display:"inline-block","text-align":"left"}})).inject(y);(u=f.createElement("div",{"class":"label",styles:{width:"50%",display:"inline-block","text-align":"right"}})).inject(y);(p=f.createElement("div",{"class":"tweaker"})).inject(B);A.setContent(B);var o=D.nodeModel.options.grid;r.innerHTML=o.name;u.innerHTML="";if(v.typeDisplayFlag&&!v.authoringFlag){u.innerHTML=v._getTweakerTypeFromCellInfos(D)}A=p}return{generateViewOptions:x,data:w}}};function k(o){var p=o.getParent(".wux-windows-immersive-frame");if(p){return p.dsModel}return null}function i(o){var p=o.getParent(".wux-windows-window");if(p){return p.dsModel}return null}return m});define("DS/Tweakers/TypeRepresentationFactory",["UWA/Core","UWA/Class","UWA/Class/Promise","DS/Tweakers/TweakerUtils","DS/Core/Core","DS/Utilities/ReusableContentsManager","text!DS/Tweakers/assets/defaultTypeRepresentations.json","text!DS/Tweakers/assets/typeTemplates.json"],function(d,b,g,i,e,a,j,f){var k=b.extend({init:function(l){this.options=d.extend({preLoadTemplates:true,onReady:function(){}},l||{});this._parent(l);this._bufferTemplateLoaded={};this._isReady=false;this._reusablesManager=new a();this._registerDefaults();this._registerDefaultEnums();this._preLoadDefaultUITemplates();i.addTypeRepFactory(this);Object.defineProperty(k.prototype,"onReady",{get:function(){return this.options.onReady},set:function(m){this.options.onReady=m;if(this._isReady){m.call(this)}},enumerable:true,configurable:true})},destroy:function(){this._reusablesManager.destroy();i.removeTypeRepFactory(this);this.typeReps=null;this.typeUITemplates=null;this.typeEnums=null;this._parent()},_callOnTemplateLoaded:function(n,l){if(n.src){l.call(this,n.src);return}var p=n.path;if(!p){return}if(this._bufferTemplateLoaded[p]){this._bufferTemplateLoaded[p].templates.push(n);this._bufferTemplateLoaded[p].callbacks.push(l)}else{this._bufferTemplateLoaded[p]={templates:[n],callbacks:[l]};var o=this;require([p],function m(r){for(var q=0;q<o._bufferTemplateLoaded[p].templates.length;q++){o._bufferTemplateLoaded[p].templates[q].src=r;o._bufferTemplateLoaded[p].callbacks[q].call(o,r)}delete o._bufferTemplateLoaded[p]})}},_registerDefaults:function(){d.merge(this.typeReps,JSON.parse(j));d.merge(this.typeUITemplates,JSON.parse(f))},_registerDefaultEnums:function(){var m=this;m.registerEnum("allSupportedTypes",function l(){var n=[];[m.typeReps,m.typeEnums].forEach(function(p){for(var o in p){n.push(o)}});return n.sort(function(p,o){return p.toLowerCase().localeCompare(o.toLowerCase())})});m.registerTypeRepresentations({allSupportedTypes:{stdTemplate:"enumSearchableCombo"}})},_preLoadDefaultUITemplates:function(){var n=this;if(this.options.preLoadTemplates){var l=0;for(var m in n.typeUITemplates){if(this.typeUITemplates[m].path!==""){l++}}for(var m in n.typeUITemplates){(function(p){var o=n.typeUITemplates[p];if(o.path!==""){n._callOnTemplateLoaded(o,function(q){l--;if(l===0){n._isReady=true;n.options.onReady.call(n)}})}})(m)}}else{this._isReady=true;this.options.onReady.call(this)}},typeReps:{defaultRep:{stdTemplate:"defaultrep"}},typeUITemplates:{},typeEnums:{},registerTypeRepresentations:function(l){if(l!==undefined){if(typeof l==="string"){d.merge(this.typeReps,JSON.parse(l))}else{if(typeof l==="object"){d.merge(this.typeReps,l)}else{throw new Error("Cannot register type representations")}}}},getRegisteredTypeRepresentation:function(l){if(l!==undefined){if(this.typeReps&&this.typeReps[l]){return this.typeReps[l]}return undefined}},IsRegisterTypeRepresentations:function(l){if(l!==undefined){if(this.typeReps&&this.typeReps[l]){return true}return false}},registerTypeTemplates:function(l){if(l!==undefined){if(typeof l==="string"){d.merge(this.typeUITemplates,JSON.parse(l))}else{if(typeof l==="object"){d.merge(this.typeUITemplates,l)}else{throw new Error("Cannot register type templates")}}}},getRegisteredTypeTemplate:function(l){if(l!==undefined){if(this.typeUITemplates&&this.typeUITemplates[l]){return this.typeUITemplates[l]}return undefined}},registerEnum:function(l,n){if((Array.isArray(n)||typeof n==="object"||typeof n==="function")&&typeof l==="string"&&l!==""){var m={};m[l]=n;if(this.typeEnums[l]){this.typeEnums[l]=n}else{d.merge(this.typeEnums,m)}}else{throw new Error('Cannot register the enum "'+l+'"')}},getRegisteredEnum:function(l){if(l!==undefined){if(this.typeEnums&&this.typeEnums[l]){return this.typeEnums[l]}return undefined}},generateTweaker:function(o,v){if(v===undefined){return}if(v.typeRep===undefined){return}var u=this.getTemplateIdentifierFromTypeRep(v.typeRep,v.context);if(u!==undefined){if(typeof u!=="string"){if(v.readOnly&&u.readOnly){u=u.readOnly}else{u=u["default"]}}var s=this.typeUITemplates[u];if(s!==undefined){var q=this;var r;if(v.semantics){r=d.merge(v.semantics,v.typeRep.semantics)}else{r=v.typeRep.semantics}var m=r||{};m.readOnly=v.readOnly!==undefined?v.readOnly:h.call(this,m.readOnly);m.touchMode=v.touchMode!==undefined?v.touchMode:m.touchMode;m.icon=v.icon!==undefined?v.icon:m.icon;m.escapeHTML=v.escapeHTML!==undefined?v.escapeHTML:h.call(this,m.escapeHTML);if(!m.hasOwnProperty("valueType")&&(v.valueType===undefined)&&(v.typePath!==undefined)){var n;var p;var l=v.typePath.indexOf("<");var t=v.typePath.indexOf(">");if(l!==-1&&t!==-1&&l<t){n=v.typePath.substring(l+1,t)}else{if(v.typePath==="array"||(v.typeRep&&v.context&&v.typeRep[v.context]==="array"&&(!v.semantics||v.semantics.valueType!=="auto"))){n="auto"}else{n=(v.typePath!=="")?v.typePath:d.typeOf(o);p=this._getTypeData(v.typePath).realType?this._getTypeData(v.typePath).realType:(v.typePath!=="")?v.typePath:d.typeOf(o)}}m.valueType=n;m.realType=p}this._callOnTemplateLoaded(s,function(w){if(!v.needToCreateViewAfterRequireEnded||(v.needToCreateViewAfterRequireEnded&&v.needToCreateViewAfterRequireEnded.call(q)===true)){q.__resolveTemplate__(u,s,w,o,m,v)}else{c.call(v,"No need to create view",o)}})}else{c.call(v,"Cannot retrieve a view template for the given typePath",o)}}else{c.call(v,"Cannot generate view with the typeRep found for the given typePath",o)}},_getTypeData:function(t,l,p){function r(C,B){var A=u.__resolveEnumRepresentation__(C);var D=u.typeReps[A];B=B||{};B.possibleValues=C;return{semantics:B,finalPath:A,typeRep:D}}var u=this,y,z="",v;t=t||d.typeOf(p);if(t===false||t===true){t=d.typeOf(t)}if(t!==null&&t!==undefined){var o=t.split("#");var s;if(o.length===2){t=o[0];s=o[1]}var x=t.split(".");var w="";x.every(function(F,A,G){z+=String(F);if(A!==G.length-1){z+="."}if(y!==undefined){if(y.children){y=y.children[F];if(typeof y==="string"&&y.indexOf("#")===0){var B=y.slice(1);v=B;y=u.typeReps[B];if(y===undefined||y===""){var D=u.typeEnums[B];if(D){var C=r(D,l);l=C.semantics;y=C.typeRep;w=C.finalPath}}}if(y!==undefined){var E=w+"."+F;w+="."+F}else{w=""}}else{y=undefined;w=""}}else{y=u.typeReps[F];w=F;var D=u.typeEnums[F];if((y!==undefined&&D)||(y===undefined&&D)){if(y===undefined){w=u.__resolveEnumRepresentation__(D);y=u.typeReps[w]}l=l||{};l.possibleValues=D}}return(y!==undefined||A!==G.length-1)});if(y===undefined||y===""){var q=u.typeEnums[s];if(q){var m=r(q,l);l=m.semantics;y=m.typeRep;w=m.finalPath}}if(y&&y.children){l=l||{};var n=l.configuration||{};Object.getOwnPropertyNames(y.children).forEach(function(C){var B,A;n[C]={};if(!(t+"."+C).contains(C)){B=u._getTypeData(t+"."+C,l,p);A=B.semantics&&B.semantics.configuration?B.semantics.configuration:{};Object.getOwnPropertyNames(A).forEach(function(D){if(!n[C+"."+D]){n[C+"."+D]={}}})}});l.configuration=n}if(t===z&&y===undefined&&t.indexOf(".")!==-1){if(s!==undefined){y=u.typeReps[s]}if(y===undefined){y=u.typeReps[d.typeOf(p)]}w=""}if(y===undefined&&t.indexOf("<")!==-1&&t.indexOf(">")!==-1){y=u.typeReps[t.substring(0,t.indexOf("<"))];if(y===undefined){y=u.typeReps.array}}t=w}return{typeRep:y,typePath:t,semantics:l,realType:v}},__resolveTemplate__:function(t,s,o,n,l,u){var p=this;if(o!==undefined){p._currentValue=n;p._currentOptions=u;p._currentSemantics=l;if(!this._reusablesManager.isRegistered(t)){this._reusablesManager.register({id:t,buildContent:function(){var w={};d.merge(w,s.options);d.merge(w,p._currentOptions);w.value=p._currentValue;w=d.extend(w,p._currentSemantics);var v=new o(w);return v}})}var m=this._reusablesManager.use(t);var r=m.component;if(r!==undefined){if(r.disableEvents){r.disableEvents()}d.merge(l,s.options);d.merge(l,u);l.realPath=u.realPath;if(r.failureCapture){l.onFailure=u.onFailure}var q=r.getPublishedPropertiesDefaultValue();d.merge(l,q);l.value=n;if(l.referenceValue===undefined){l.referenceValue=d.clone(n,false)}if(l&&r.setProperties){r.setProperties(l)}if(r.enableEvents){r.enableEvents()}u.onViewCreated(r)}else{c.call(u,"",n)}}},generateView:function(o,l){if(l.onViewCreated===undefined&&l.onFailure===undefined){var n=this;return new g(function(q,p){l.onViewCreated=function(r){q(r)};l.onFailure=function(r){p(r)};n.generateView(o,l)})}l=l||{};var m=this._getTypeData(l.typePath,l.semantics,o);l.semantics=l.semantics||{};d.merge(l.semantics,m.semantics);if(m.typePath!==null&&m.typePath!==undefined){if(m.typeRep!==undefined){l.typeRep=m.typeRep;l.typePath=m.typePath;this.generateTweaker(o,l)}else{c.call(l,"Cannot generate view with the given typePath",o)}}else{c.call(l,"Cannot generate view with an undefined typePath and undefined data",o)}},getTemplateIdentifierFromTypeRep:function(o,m){var n;if(o){var l=m||"stdTemplate";if(o[l]===undefined){l="stdTemplate"}n=o[l]}return n},getTemplateIdentifierFromTypePath:function(o,l){var n;var m=this._getTypeData(o,l);if(m&&m.typeRep){n=this.getTemplateIdentifierFromTypeRep(m.typeRep)}return n},__resolveEnumRepresentation__:function(l){if(Array.isArray(l)){if(l.every(function(m){return typeof m==="string"})){return"enumString"}else{if(l.every(function(m){return typeof m==="number"})){return"enumInteger"}}}else{if(typeof l==="function"){return"enumDyn"}}return"enumCustom"}});function c(l,m){if(this.onFailure&&typeof this.onFailure==="function"){this.onFailure({message:l,data:m,typePath:this.typePath,typeRep:this.typeRep})}}function h(l){return(l=="true")}return k});define("DS/TreeModel/FilterManager",["DS/Core/BaseComponent","DS/CoreEvents/ModelEvents","DS/TreeModel/StringRegExpFilter","DS/TreeModel/SetFilter"],function(a,e,f,d){var c=function(k,g){var i=0;var h=this._listOfFilters[k];if(h!==undefined){if(h.filterId===g.filterId){h.filterModel=g.filterModel;return 3}h.destroy();this._listOfFilters[k]=undefined;delete this._listOfFilters[k];i=1}this.filterModel[k]=g;var j=this.FILTERS_MAP[g.filterId];if(!j){console.log("No filter has been registered for id ",g.filterId);return 0}this._listOfFilters[k]=new j({filterManager:this,propertyId:k,filterModel:g.filterModel,filterId:g.filterId});return 1+i};var b=a.inherit({name:"filtermanager",publishedProperties:{model:{defaultValue:undefined,type:"object",readOnly:true},filterModel:{defaultValue:{},type:"object"}},registerFilter:function(h,g){this.FILTERS_MAP[h]=g},setPropertyFilterModel:function(i,g){var h=c.call(this,i,g);if(h===0){this.filterModel[i]=undefined;delete this.filterModel[i];this.publish("filterModelChange")}},subscribe:function(h,g){return this._modelEvents.subscribe({event:h},g)},unsubscribe:function(g){return this._modelEvents.unsubscribe(g)},publish:function(h,g){if(this._preventPublishEvent===0){this._modelEvents.publish({event:h,data:g,context:this})}},isDataFiltered:function(h){for(var g in this._listOfFilters){if(this._listOfFilters[g].isDataFiltered(h)){return true}}return false},getFilters:function(){return this._listOfFilters},_build:function(){this.FILTERS_MAP={stringRegexp:f,set:d,numberComparator:null};this._listOfFilters={};this._modelEvents=new e();this._preventPublishEvent=0},_applyFilterModel:function(h){var i=this;var g=Object.keys(this._listOfFilters);var j=Object.keys(this.filterModel);i._preventPublishEvent++;j.forEach(function(l){var k=c.call(i,l,i.filterModel[l]);if(k===0){i.filterModel[l]=undefined;delete i.filterModel[l]}var m=g.indexOf(l);if(m!==-1){g.splice(m,1)}});g.forEach(function(k){i._listOfFilters[k].destroy();delete i._listOfFilters[k]});i._preventPublishEvent--;this.publish("filterModelChange")},_applyProperties:function(g){this._parent(g);if(this.isDirty("filterModel")){this._applyFilterModel(g.filterModel)}}});return b});define("DS/TreeModel/TreeDocument",["UWA/Core","UWA/Class","DS/Core/Core","DS/TreeModel/TreeNodeModel","DS/Selection/XSO","DS/CoreEvents/ModelEvents","DS/Utilities/Array","DS/Utilities/Data","DS/TreeModel/FilterManager"],function(d,a,h,e,j,b,k,c,g){var f=a.extend({defaultOptions:{dataModelSet:null,useAsyncPreExpand:false,shouldBeSelected:function(l){return true},shouldBeEditable:function(l){return true},shouldAcceptDrag:function(l){return true},shouldAcceptDrop:function(l){return true},insert:function i(n,m,l){this.withTransactionUpdate(function o(){m.insertBefore(n,l)},this)},nodeModelClass:e},init:function(m){this._parent(m);this._isExpandingCounter=0;this.options=d.extend(d.clone(this.defaultOptions),m);this._modelEvents=new b();var l=function(p,o){return p._getID()===o._getID()};var n=function(o){return o._getID()};this._xso=new j({getElementID:n,useUniqueID:true,areEquals:l});this._pxso=new j({getElementID:n,useUniqueID:true,areEquals:l});this._listeners=[];this._XSOEventListeners=[];this._numberOfNodesInDocument=0;this._useChangeTransactionMode=false;this._createTrueRoot();if(this.options.useAsyncPreExpand===true){this.onPreExpand(function(o){o.target.preExpandDone()})}},getModelEvents:function(){return this._trueRoot?this._trueRoot._modelEvents:null},_bindEventOnDocument:function(l,m){this._listeners.push(this._trueRoot._modelEvents.subscribe({event:l},m))},_bindEventOnXSO:function(l,m){this._XSOEventListeners.push(this.getXSO()[l](m))},_cleanBindings:function(){var m=this;this._listeners.forEach(function(n){m._trueRoot._modelEvents.unsubscribe(n)});this._listeners=[];var l=this.getXSO();this._XSOEventListeners.forEach(function(n){l.unsubscribe(n)});this._XSOEventListeners=[]},destroy:function(){this._getTrueRoot()._modelEvents.publish({event:"preDestroyDocument"});this._cleanBindings();this._getTrueRoot()._treeDocument=null;this._getTrueRoot().destroy();this._trueRoot=null;this._xso=null;this._pxso=null},isInTransaction:function(){return this._updateCnt>0},_observeEvents:function(o){var p=this;this._cleanBindings();this._updateCnt=0;this._bindEventOnDocument("active",function(r){if(p._activeNode){p._activeNode.inactive()}p._activeNode=r.target});this._bindEventOnDocument("addChild",function(r){p._requireRowsIndexing();p._numberOfNodesInDocument++});this._bindEventOnDocument("removeChild",function(r){p._requireRowsIndexing();p._numberOfNodesInDocument--});this._bindEventOnDocument("hide",function(r){p._requireRowsIndexing()});this._bindEventOnDocument("show",function(r){p._requireRowsIndexing()});this._bindEventOnDocument("preRemoveChild",function(r){var s=r.data.nodeModel;if(!s.__keepSelection){s.unselect();s.unselectAll()}});this._bindEventOnDocument("preExpandAll",function(){p._isExpandingCounter++});this._bindEventOnDocument("documentPreExpandAll",function(){p._isExpandingCounter++});this._bindEventOnDocument("preExpandPrivate",function(){p._isExpandingCounter++});function n(){p._isExpandingCounter--;if(p._isExpandingCounter===0){p._requireRowsIndexing();p._getTrueRoot()._modelEvents.publish({event:"_expandOperationComplete"})}}this._bindEventOnDocument("postExpandAll",n);this._bindEventOnDocument("documentPostExpandAll",n);this._bindEventOnDocument("postExpandPrivate",n);this._bindEventOnDocument("postExpand",function(){p._requireRowsIndexing()});this._bindEventOnDocument("postCollapse",function(){p._requireRowsIndexing()});this._bindEventOnDocument("postCollapseAll",function(){p._requireRowsIndexing()});this._bindEventOnDocument("sortChildren",function(){p._requireRowsIndexing()});this._bindEventOnDocument("filter",function(){p._requireRowsIndexing()});this._bindEventOnDocument("prepareUpdate",function(){p._updateCnt++});this._bindEventOnDocument("pushUpdatePrivate",function(){if(p._updateCnt-1===0){if(p.__requireRowsIndexing===true){p._indexRowIndexes()}}});this._bindEventOnDocument("pushUpdate",function(r){p._updateCnt--;if(p._updateCnt<0){console.warn("A call has been made on pushUpdate without a previous call to prepareUpdate")}if(p._updateCnt===0){if(p.__requireRowsIndexing===true){p._indexRowIndexes()}var s=p._getTrueRoot();s._modelEvents.publish({event:"modelUpdate",context:p})}});function q(r){r.forEach(function(s){if(s.isSelectionChangeFromUI()){s.selectionChangeIsNotFromUI()}})}var m=function(r,s){p.prepareUpdate();r.forEach(function(t){t._isSelected=s;t._modelEvents.publish({event:s?"select":"unselect",data:t._getNodeInfos(),context:t});if(t.isSelectionChangeFromUI()){t.selectionChangeIsNotFromUI()}});p.pushUpdate()};this._bindEventOnXSO("onPostAdd",function l(r){m(r,true)});this._bindEventOnXSO("onPostRemove",function l(r){m(r,false)});this._bindEventOnXSO("onPreEmpty",function(r){p.prepareUpdate();r.forEach(function(s){s._isSelected=false})});this._bindEventOnXSO("onEmpty",function(r){p.pushUpdate()})},_requireRowsIndexing:function(){this.__requireRowsIndexing=true},_indexRowIndexes:function(){var l=-1;this._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(n){var m=n.nodeModel;if(!m.hasNoRepresentation()){l++;m._rowID=l}}});this.__requireRowsIndexing=false},getXSO:function(){return this._xso},getPXSO:function(){return this._pxso},_createTrueRoot:function(m){if(m===undefined){var l=this.options.nodeModelClass||e;this._trueRoot=new l({_isTrueRoot:true,label:"",useAsyncPreExpand:this.options.useAsyncPreExpand})}else{this._trueRoot=m;this._trueRoot.options.label="trueroot";this._trueRoot.options._isTrueRoot=true;this._trueRoot.options.useAsyncPreExpand=m.options.useAsyncPreExpand;this._trueRoot._rowID=-1}this._trueRoot._treeDocument=this;this.getModelEvents()._addParent(this._modelEvents);this._observeEvents()},_shouldAcceptDrop:function(l){return this.options.shouldAcceptDrop.call(l.target,l.target._getNodeInfos())},subscribe:function(l,m){return this.getModelEvents().subscribe(l,m)},unsubscribe:function(l){return this.getModelEvents().unsubscribe(l)},addEventListener:function(l,m){return this.getModelEvents().addEventListener(l,m)},removeEventListener:function(l){this.getModelEvents().unsubscribe(l)},addModelEventListener:function(l,m){return this.getModelEvents().addEventListener(l,m)},loadModel:function(l,m,n){if(m===undefined){m=this._trueRoot}this._trueRoot._treeDocument=this;return this._trueRoot._loadModel(l,m,n)},_getTrueRoot:function(){return this._trueRoot},_getRealTrueRoot:function(){return this._trueRoot},addRoot:function(l,m){return this._getTrueRoot().addChild(l,m)},addChild:function(m,l){return this._getTrueRoot().addChild(m,l)},insertBefore:function(m,l){return this._getTrueRoot().insertBefore(m,l)},removeRoot:function(l){return this._getTrueRoot().removeChild(l)},removeRoots:function(){var m=[];var l=this;this.withTransactionUpdate(function(){var o=l.getRoots();for(var n=o.length-1;n>=0;n--){m.unshift(o[n]);o[n].remove()}});return m},expandNLevels:function(l){var m=this._getTrueRoot().getChildren();if(m){this.prepareUpdate();k.optimizedForEach(m,function(o,n){o.expandNLevels(l)});this.pushUpdate()}},expandAll:function(){var p=this._getTrueRoot();var m=p.getChildren();if(m){p._modelEvents.publish({event:"documentPreExpandAll",data:p._getNodeInfos(),context:p});var l=0;this._onExpandOperationsComplete(function(){l--;if(l===0){p._modelEvents.publish({event:"_expandAllOperationComplete"})}});var n=0;var o=p._endOfSubExpand;p._endOfSubExpand=function(){o.call(p);if(this.__expandAllCounter===0){n++;p._modelEvents.publish({event:"documentPostExpandAll",data:p._getNodeInfos(),context:p})}};k.optimizedForEach(m,function(r,q){l++;r._privateExpand({expandAll:true,onExpandComplete:function(){}},undefined,p)})}},collapseAll:function(){var m=this._getTrueRoot();var l=this._getTrueRoot().getChildren();if(l){this.prepareUpdate();m._modelEvents.publish({event:"documentPreCollapseAll",data:m._getNodeInfos(),context:m});k.optimizedForEach(l,function(o,n){o.collapseAll()});m._modelEvents.publish({event:"documentPostCollapseAll",data:m._getNodeInfos(),context:m});this.pushUpdate()}},getAllDescendants:function(){var l=this._getTrueRoot();if(l){return l.getAllDescendants()}},_dump:function(l){return this._getTrueRoot()._dump(l)},dump:function(l){return this._dump(l)},getNthRoot:function(l){if(this._getTrueRoot().getChildren()){return this._getTrueRoot().getChildren()[l]}},getRoots:function(){return this.getChildren()},buildPath:function(l){return this._getTrueRoot().buildPath(l)},getChildren:function(){return this._getTrueRoot().getChildren()||[]},prepareUpdate:function(){return this._getRealTrueRoot().prepareUpdate()},pushUpdate:function(){return this._getRealTrueRoot().pushUpdate()},withTransactionUpdate:function(l){return this._getRealTrueRoot().withTransactionUpdate(l)},getSelectedNodes:function(){return this._xso.get()},processSelectedNodes:function(m){var l={processNode:function(n){},onComplete:function(){}};m=d.extend(l,m);this.prepareUpdate();c.forEach(this.getXSO().get(),function(n){if(m.processNode!==undefined){m.processNode.call(n,n._getNodeInfos())}},50,function(){m.onComplete()})},processDescendants:function(l){this._getTrueRoot().processDescendants(l)},selectAll:function(){this._getTrueRoot().selectAll()},unselectAll:function(){this.getXSO().empty()},isEveryNodeSelected:function(){return this.getXSO().get().length&&this._numberOfNodesInDocument===this.getXSO().get().length},isExpanding:function(){return this._isExpandingCounter>0},empty:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot()._modelEvents.publish({event:"empty"});var n=l.getRoots();for(var m=n.length-1;m>=0;m--){n[m].remove()}})},setUseChangeTransactionMode:function(l){this._useChangeTransactionMode=l},getUseChangeTransactionMode:function(){return this._useChangeTransactionMode},cancelChanges:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot().cancelChanges(true)})},acceptChanges:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot().acceptChanges(true)})},resetToReferenceValues:function(){var l=this;this.withTransactionUpdate(function(){l.processDescendants({treeTraversalOrder:"postOrder",processNode:function(n){var m=n.nodeModel;m.resetToReferenceValues()}})})},setValuesAsReference:function(){var l=this;this.withTransactionUpdate(function(){l.processDescendants({treeTraversalOrder:"postOrder",processNode:function(n){var m=n.nodeModel;m.setValuesAsReference()}})})},onNodeModelUpdate:function(l){return this.getModelEvents().subscribe({event:"nodeModelUpdate"},l)},onPreExpand:function(l){this.getModelEvents().unsubscribeAll({event:"preExpand"});return this.getModelEvents().subscribe({event:"preExpand"},l)},onUpdate:function(l){return this.getModelEvents().subscribe({event:"modelUpdate"},l)},_onExpandOperationsComplete:function(l){return this.getModelEvents().subscribe({event:"_expandOperationComplete"},l)},_onExpandAllOperationsComplete:function(l){return this.getModelEvents().subscribe({event:"_expandAllOperationComplete"},l)},onPreExpandAll:function(l){return this.getModelEvents().subscribe({event:"preExpandAll"},l)},onPostExpand:function(l){return this.getModelEvents().subscribe({event:"postExpand"},l)},onPreCollapse:function(l){return this.getModelEvents().subscribe({event:"preCollapse"},l)},onPostCollapse:function(l){return this.getModelEvents().subscribe({event:"postCollapse"},l)},search:function(l){return this._getTrueRoot().search(l)},groupRoots:function(l){this._getTrueRoot().groupChildren(l)},ungroupRoots:function(){this._getTrueRoot().ungroupChildren()},_createFilterManager:function(l){if(!this._filterManager){this._filterManager=new g({model:this,filterModel:l||{}});var m=this._getTrueRoot();this._filterManager.subscribe("filterModelChange",function(n){m._modelEvents.publish({event:"filter",data:m._getNodeInfos(),context:m})});m._modelEvents.publish({event:"filter",data:m._getNodeInfos(),context:m})}},setFilterModel:function(l){this.prepareUpdate();if(!this._filterManager){this._createFilterManager(l)}else{this._filterManager.filterModel=l}this.pushUpdate()},getFilterManager:function(){if(!this._filterManager){this._createFilterManager()}return this._filterManager},flattenTreeDocument:function(n){var o=[];var m=this;var p=false;var l=0;setTimeout(function(){var r=function(t,s){if(s===undefined){s=[]}if(t.isVisible()||t._isTrueRoot()){if(!t._isTrueRoot()){s.push(t)}if(t.hasChildren()){t.getChildren().forEach(function(u){r(u,s)})}}return s};var q=function(){if(l===0){if(p){o.length=0;r(m._getTrueRoot(),o);p=false}if(n&&n.onUpdate){n.onUpdate({flattenedTreeDocument:o})}}};p=true;q();m.addEventListener("prepareUpdate",function(){l++;q()});m.addEventListener("pushUpdate",function(){if(l>0){l--;q()}});["addChild","removeChild","hide","show","expand","collapse"].forEach(function(s){m.addEventListener(s,function(){p=true;q()})})});return o},getNodeFromStructurePath:function(l){var n=this._getTrueRoot();var m=l.split("/");m.pop();m.forEach(function(p,o){n=n.getChildren()[p]});return n}});return f});define("DS/TreeModel/TreeDocumentProxy",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModelProxy"],function(a,c){var b=a.extend({defaultOptions:{proxy:undefined,nodeModelClass:c,baseDocument:undefined},init:function(d){this._parent(d);if(d&&d.baseDocument){this._createTrueRoot(d.baseDocument._trueRoot)}},_getTrueRoot:function(){if(this.options.proxy!==undefined){var g=this.options.proxy;var e=g.options;var d=g.type;var f=b[d];if(f&&f._getTrueRoot){return f._getTrueRoot.call(this,e)}}return a.prototype._getTrueRoot.call(this)}});b.SUBSET={_getTrueRoot:function(d){return d.target}};return b});define("DS/Tree/TreeDocument",["DS/TreeModel/TreeDocument"],function(a){return a});define("DS/Tweakers/CustomTreeNodeViewTweaker",["UWA/Core","DS/Tree/TreeNodeView","DS/TreeModel/TreeDocument","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/DocUtils","DS/Controls/TooltipModel","DS/Utilities/Utils","DS/Tweakers/TweakerUtils"],function(c,f,a,b,i,d,e,g){var h=function(j){var l=this;j=j||{};l.updateNodeParent=function(s,p){var q=s.getParent();var o=q.options.grid;var n=e.getObjectPropertyInfo(j.value,o.path);if(n.valid&&n.value!==o.data){o.data=n.value}if(q&&!q._isTrueRoot()){var m=p.getCell(q._getRowID(),"data");if(m){var r=m.getView();if(r){r.updateView()}}l.updateNodeParent(q,p)}};l.updateNodeChildren=function(p,n,o){var m=p.getChildren();if(m){m.forEach(function(u){if(u){var s=u.options.grid;if(s&&s.path!==undefined){var r=e.getObjectPropertyInfo(o,s.path);var q=n.getCell(u._getRowID(),"data");if(q&&r.valid&&r.value!==s.value){var t=q.getView();s.data=r.value;if(t){t.updateView()}}l.updateNodeChildren(u,n,o)}}})}};l.customTreeNodeView=f.extend({init:function(m){this._parent(m)},updateInternalParameters:function(){this._parent();var m=this.getCellInfos();if(j._portalTweaker){if(m.dataIndex==="tree"||(j.displayMode==="oneColumn"&&m.dataIndex==="data")){i.getWebUXPropertyDocumentation(m.nodeModel.options.label,j.realPath?j.realPath:j.valueType,function(p){var o=(p&&p.property)?p.property:"";var r=(p&&p.doc)?p.doc:m.nodeModel.options.label;var q={title:o,longHelp:r};m.cellView._setTooltip(m.cellView.elements.labelContainer,q)})}}if(!m.isHeader){var n=m.nodeModel;this.getContent().setAttribute("has-children",n.hasChildren());this.getContent().setAttribute("is-required",n.options.grid.required||false);if(j.labelDisplay==="left"||j.authoringFlag){this.getContent().addClassName("wux-left-labelDisplay");this.getContent().removeClassName("wux-right-labelDisplay")}else{if(j.labelDisplay==="right"){this.getContent().addClassName("wux-right-labelDisplay");this.getContent().removeClassName("wux-left-labelDisplay")}}}},_setTooltip:function(q,n){var p=this;var m=n.title?n.title:"";function o(){var t=p.getCellInfos().dataIndex;var r=p.getCellModel().options;var s=n.longHelp;if((t!=="tree"&&s===String(r.value))||(t==="tree"&&s===String(r.value.options.grid.name)&&m==="")){return false}return true}if(o()){p.getContent().tooltipInfos=new d({title:m,longHelp:n.longHelp,mouseRelativePosition:true})}}});function k(){return[{dataIndex:"tree",text:"Label",isDraggable:false,isHidden:false,width:"40%"},{dataIndex:"type",isHidden:true},{dataIndex:"tweakerType",isHidden:true},{dataIndex:"data",text:"Value",isEditable:true,width:"auto",onCellRequest:function(o){if(!o.isHeader&&o.nodeModel&&o.nodeModel.options&&!o.nodeModel.options.temporary){var m=g._setModelViewForDataColumnOneColumnCase(l,o);var n=o.nodeModel.options.grid;if(WUX.typeRepFactory!==undefined&&!n._buildFailure){WUX.typeRepFactory.generateView(m.data,m.generateViewOptions)}else{WUX.typeRepFactory=new b({onReady:function(){this.generateView(m.data,m.generateViewOptions)}})}}},setValue:function(m){m.nodeModel.options.grid.data=m.value;m.nodeModel.notifyModelUpdate()},getValue:function(m){return m.nodeModel.options.grid.data}},{dataIndex:"remove",isHidden:true}]}this.treeOptions={defaultCellHeight:38,isSortable:false,cellClass:this.customTreeNodeView,apiVersion:2,show:{rowHeaders:false,columnHeaders:false},expanderStyle:"triangle",performances:{buildLinks:false},treeDocument:j.doc,resize:{columns:true},selection:false,columns:k()}};return h});define("DS/Selection/CSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(f,b,a,e){var d="CSO/";var c=e.singleton({init:function(g){g={eventChannel:d,};this._parent(g)}});return f.namespace("WUX/Selection/CSOManager",c)});define("DS/Tweakers/ModelProxy",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],function(a,g){var d={selectFilter:function(h){if(h.pattern===undefined||h.pattern===""||h.criteria===undefined){return this}return this.filter(function(i){return(i[this.criteria]!==undefined&&i[this.criteria].indexOf(this.pattern)>-1)},h)},fillFilter:function(h){return this.map(function(j,i,m){var l=j;for(var k in this){if(l[k]===undefined){l[k]=this[k]}}return l},h)},hierarchyFilter:function(h){var i=f.call(this,h.criteria);if(h.child!==undefined&&i!==undefined){c.call(i,h.child)}return i},modelToTreeDocument:function(j,o,n){function i(p,r,q){p.forEach(function(u,t,s){var v=new g({label:u[r],grid:u});if(!q){q.addRoot(v)}else{q.addChild(v)}if(u.properties){i(u.properties,r,v)}})}var h=this;switch(o){case"flat":i(j,n,h);break;case"hierarchical":for(var l in j){var k=this;if(l!=="undefined"){k=new g({label:l})}var m=j[l];if(Array.isArray(m)){i(m,n,k)}else{e.call(k,m,n)}if(k!==this){this.addChild(k)}}break}},modelToBreadCrumbModel:function(h,i){b.call(this,h,i)}};function f(i){var h={};this.forEach(function(k){var j=k[i];(h[j])?h[j].push(k):h[j]=[k]});return h}function c(h){if(h.criteria!==undefined){for(var i in this){this[i]=f.call(this[i],h.criteria);if(h.child!==undefined&&this[i]!==undefined){c.call(this[i],h.child)}}}}function e(h,l){for(var j in h){var k=h[j];var i=this;if(Array.isArray(k)){k.forEach(function(n,m,o){i.addChild(new g({label:n[l],grid:n}))})}else{if(j!=="none"){i=new g({label:j});this.addChild(i)}e.call(i,k,l)}}}function b(h,n){var m=this;for(var l in h){var i=h[l];if(l==="none"){i.forEach(function(q,p,o){m.push({label:q[n]})})}else{var j=[];var k={label:l};(Array.isArray(i))?i.forEach(function(q,p,o){j.push({label:q[n]})}):b.call(j,i,n);k.children=j;m.push(k)}}}return d});define("DS/Notifications/NotificationsManagerAbstract",["DS/WebappsUtils/WebappsUtils","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/CoreEvents/ModelEvents","UWA/Core","UWA/Controls/Abstract"],function(d,b,h,e,g,f){function a(j){this._currentLengthHistory++;var i=new h({label:"",grid:j});this._history.addRoot(i);if(this._currentLengthHistory>this._lengthHistory){this._history.removeRoot(this._history.getNthRoot(0));this._currentLengthHistory--}}var c=f.extend({defaultOptions:{},init:function(i){this._parent(i);this._modelEvents=new e();this._counterNotifications=0;this._history=new b();this._lengthHistory=200;this._currentLengthHistory=0;this._dataModel={options:i}},addNotif:function(i){var k=g.clone(i);this._counterNotifications++;this._completeOptions(k);var j=this._buildModelFromOptions(this._counterNotifications,k);a.call(this,j);this._modelEvents.publish({event:"notification_added",data:g.clone(j)});return this._counterNotifications},modifyNotif:function(o,k){var p=g.clone(k);this._completeOptions(p);var i;var n=this._buildModelFromOptions(o,p);for(var j=0;j<this._currentLengthHistory;j++){var m=this._history.getNthRoot(j);if(m.options.grid.count===o){i=m.options.grid;var l=new h({label:"",grid:n});m.addChild(l);break}}this._modelEvents.publish({event:"notification_modified",data:{oldOptions:i,newOptions:g.clone(n)}})},setLengthHistory:function(i){if(this._lengthHistory==i||i<0){return}for(;this._currentLengthHistory>i;this._currentLengthHistory--){this._history.removeRoot(this._history.getNthRoot(0))}this._lengthHistory=i},getLengthHistory:function(){return this._lengthHistory},getNotifOptions:function(l){for(var j=0;j<this._currentLengthHistory;j++){var k=this._history.getNthRoot(j);if(k.options.grid.count===l){var i=k.getChildren();if(i){return g.clone(i[i.length-1].options.grid)}return g.clone(k.options.grid)}}},getLastNthNotificationAdded:function(i){if(i>0&&i<=this._currentLengthHistory){return g.clone(this._history.getNthRoot(this._currentLengthHistory-i).options.grid)}},getDataModel:function(){return this._dataModel},getHistory:function(){return this._history},suscribeToNotificationAdded:function(i){return this._modelEvents.subscribe({event:"notification_added"},i)},unsuscribeToNotificationAdded:function(i){this._modelEvents.unsubscribe(i)},suscribeToNotificationModified:function(i){return this._modelEvents.subscribe({event:"notification_modified"},i)},unsuscribeToNotificationModified:function(i){this._modelEvents.unsubscribe(i)},_buildModelFromOptions:function(j,i){return{count:j,options:i}},_completeOptions:function(i){}});return c});var WUXNotificationsOnScreenFadeOutPolicy={Slow:0,Medium:1,Fast:2};Object.freeze(WUXNotificationsOnScreenFadeOutPolicy);define("DS/Notifications/NotificationsManagerViewOnScreen",["DS/WebappsUtils/WebappsUtils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","i18n!DS/Notifications/assets/nls/translation","UWA/Core","UWA/Class","UWA/Controls/Abstract"],function(e,i,r,o,s,f,w,v){var k={info:"info",warning:"warning",error:"error",success:"success"};function m(){return u.call(this)||this.options.manager.getRemoveStackOnFirstTimeoutFlag()}function u(){return !this.options.isStacked||this.options.notificationsStack.getNotificationsData().length===1}var l=v.extend({defaultOptions:{},init:function(x){this._parent(x);this._notif=null;this._notifIcon=null;this._title=null;this._subtitle=null;this._message=null;this._action=null;this._data=null;this._animHasBegun=false;this._disposeInProgress=false;this._fadingTimeout=undefined;this._resizeTimeout=undefined;this._disposeTimeout=undefined;this._warningOpacityTimeout=undefined;this.buildView()},buildView:function(){this._notif=new f.Element("div",{"class":"wux-notification-container"});var A=new f.Element("div",{"class":"wux-notification-band"}).inject(this._notif);this._notifIcon=new f.Element("span",{"class":"wux-notification-icon"}).inject(A);new f.Element("button",{"class":"wux-notification-close wux-ui-3ds wux-ui-3ds-wrong"}).inject(this._notif);var z=this;if(!this.options.isStacked){this.getDiv().addEventListener("contextmenu",function(B){B.preventDefault()},false)}var x=function(){z.removeTimeout();z.getDiv().setAttribute("isHighlighted",true)};this.getDiv().addEventListener("mouseenter",x);var y=function(){z.getDiv().setAttribute("isHighlighted",false);z.addTimeoutAfter(a.call(z.options.manager)/2)};this.getDiv().addEventListener("mouseleave",y);this.getDiv().addEventListener(i.POINTERUP,function(){this.removeEventListener("mouseenter",x);this.removeEventListener("mouseleave",y);var B=u.call(z)?1000:0;z.disposeAfter(B)})},getDiv:function(){return this._notif},setTouchMode:function(x){if(x){this.getDiv().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getDiv().removeAttribute("touch-mode")}},setData:function(y){this.removeTimeout();this._data=y;this.createCorrectElements();this.addTimeoutAfter(a.call(this.options.manager));var x=this;this.getDiv().setAttribute("isHighlighted",true);setTimeout(function(z){x.getDiv().setAttribute("isHighlighted",false)},500)},createCorrectElements:function(){if(this._title){this._title.remove();delete this._title}if(this._subtitle){this._subtitle.remove();delete this._subtitle}if(this._message){this._message.remove();delete this._message}if(this._action){this._action.remove();delete this._action}if(!this._data){return}if(this._data.title!==""){this._title=new f.Element("div",{"class":"wux-notification-title",html:this._data.title}).inject(this.getDiv())}if(this._data.subtitle!==""){this._subtitle=new f.Element("div",{"class":"wux-notification-subtitle",html:this._data.subtitle}).inject(this.getDiv())}if(this._data.message!==""){this._message=new f.Element("div",{"class":"wux-notification-message",html:this._data.message}).inject(this.getDiv())}if(this._data.action.label!==""){this._action=new f.Element("button",{"class":"wux-controls-button wux-notification-action",html:this._data.action.label}).inject(this.getDiv());var x=this;this._action.addEventListener(i.POINTERUP,function(y){x._data.action.callback.call(this);y.stopPropagation()})}if(this._data.level===k.info){this._notifIcon.setAttribute("class","wux-notification-icon wux-ui-3ds wux-ui-3ds-info")}else{if(this._data.level===k.warning){this._notifIcon.setAttribute("class","wux-notification-icon wux-ui-3ds wux-ui-3ds-alert")}else{if(this._data.level===k.success){this._notifIcon.setAttribute("class","wux-notification-icon wux-ui-3ds wux-ui-3ds-check")}else{if(this._data.level===k.error){this._notifIcon.setAttribute("class","wux-notification-icon wux-ui-3ds wux-ui-3ds-attention")}}}}this.getDiv().setAttribute("notification-level",this._data.level)},addTimeoutAfter:function(y){if(!this._data){return}var x=this;if(!this._data.sticky){if(this._data.level===k.info||this._data.level===k.success){this._fadingTimeout=setTimeout(function(){if(m.call(x)){x._animHasBegun=true;if(null!==x.getDiv().parentNode){x.getDiv().setAttribute("isFadingOut",true);if(x.options.isStacked){x.options.notificationsStack.getDiv().setAttribute("isFadingOut",true)}}}x._resizeTimeout=setTimeout(function(){var z=m.call(x)?1000:0;x.disposeAfter(z)},1000);x.options.manager._modelEvents.publish({event:"notificationOnScreen_animHasBegun",data:x})},y-1000)}else{if(this._data.level===k.warning){this._warningOpacityTimeout=setTimeout(function(){x._animHasBegun=true;if(null!==x.getDiv().parentNode){x.getDiv().setAttribute("ghost",true);if(x.options.isStacked){x.options.notificationsStack.getDiv().setAttribute("ghost",true)}}x.options.manager._modelEvents.publish({event:"notificationOnScreen_animHasBegun",data:x})},y)}}}},removeTimeout:function(){this.clearTimeouts();if(this._animHasBegun||this._disposeInProgress){this.getDiv().setAttribute("isFadingOut",false);this.getDiv().setAttribute("isShrinking",false);this.getDiv().setAttribute("ghost",false);if(this.options.isStacked){this.options.notificationsStack.getDiv().setAttribute("isFadingOut",false);this.options.notificationsStack.getDiv().setAttribute("ghost",false)}this._animHasBegun=false;this._disposeInProgress=false}},refreshTimeout:function(){this.removeTimeout();this.addTimeoutAfter(a.call(this.options.manager))},clearTimeouts:function(){if(this._fadingTimeout){clearTimeout(this._fadingTimeout)}this._fadingTimeout=null;if(this._resizeTimeout){clearTimeout(this._resizeTimeout)}this._resizeTimeout=null;if(this._disposeTimeout){clearTimeout(this._disposeTimeout)}this._disposeTimeout=null;if(this._warningOpacityTimeout){clearTimeout(this._warningOpacityTimeout)}this._warningOpacityTimeout=null},disposeAfter:function(y){if(this._disposeInProgress||this.getDiv().parentNode===null){return}this._disposeInProgress=true;if(y===0){this.dispose();return}this.getDiv().setAttribute("isShrinking",true);var x=this;this._disposeTimeout=setTimeout(function(){x.dispose()},y);this.options.manager._modelEvents.publish({event:"notificationOnScreen_disposeInProgress",data:this})},dispose:function(){if(!this.getDiv().parentNode){return}this.clearTimeouts();if(this.options.isStacked){this.options.notificationsStack.removeIndex(0)}else{q.call(this.options.manager,this)}this.options.manager._modelEvents.publish({event:"notificationOnScreen_disposed",data:this});this.destroy()}});var g=v.extend({defaultOptions:{},init:function(x){this._parent(x);this._notificationsData=[];this._notifsStackDiv=null;this._notificationOnScreen=null;this._notifPlaceholderDiv=null;this._nbNotifsStacked=null},buildMainView:function(){this._mainFragment=document.createDocumentFragment();this._notifsStackDiv=new f.Element("div",{"class":"wux-notification-stack"}).inject(this._mainFragment);this._notifPlaceholderDiv=new f.Element("div",{"class":"wux-notification-placeholder"}).inject(this._notifsStackDiv);this._multipleNotifsStacked=new f.Element("div",{"class":"wux-notification-stacked-depth"}).inject(this._notifPlaceholderDiv);this._multipleNotifsStacked.setAttribute("style","display: none;");this._multipleNotifsStacked.setAttribute("notification-level",this.options.level);this._notificationOnScreen=new l({isStacked:true,notificationsStack:this,manager:this.options.manager});this._notificationOnScreen.getDiv().inject(this._notifPlaceholderDiv);this._nbNotifsStacked=new f.Element("div",{"class":"wux-notification-nb-stacked"}).inject(this._notifsStackDiv);this._nbNotifsStacked.setAttribute("style","display: none;");if(this.options.level==="error"){this.options.manager.elements.container.insertBefore(this._mainFragment,this.options.manager.elements.container.firstChild)}else{this.options.manager.elements.container.appendChild(this._mainFragment)}var y=this;o.addEventListener(this.getDiv(),{callback:function x(z){if(y.getNotificationsData().length===1){return[]}return[{type:"PushItem",title:s.closeAll,tooltip:s.closeAllTooltip,action:{callback:function(A){y.dispose()},context:"context_a"}}]}})},getDiv:function(){return this._notifsStackDiv},getNotificationsData:function(){return this._notificationsData},setTouchMode:function(x){this._notificationOnScreen.setTouchMode(x)},addNotification:function(x){this.getNotificationsData().push(x);if(this.getNotificationsData().length===1){this.buildMainView();this.refreshContent()}this.updateNbNotifsStacked();if(this.options.manager.getRemoveStackOnFirstTimeoutFlag()){this._notificationOnScreen.refreshTimeout()}},changeNotification:function(z){var A=this.getNotificationsData();for(var y=0;y<A.length;y++){var x=A[y];if(x.count===z.count){A[y]=z;if(y===0){this.refreshContent()}return 0}}return 1},refreshContent:function(){this._notificationOnScreen.setData(this.getNotificationsData()[0])},updateNbNotifsStacked:function(){var x=this.getNotificationsData().length;if(x>1){this._nbNotifsStacked.textContent=x;if(x===2){this._nbNotifsStacked.setAttribute("style","display: block;");this._multipleNotifsStacked.setAttribute("style","display: block;");this.getDiv().setAttribute("multiple-notifications",true)}}else{if(this.getNotificationsData().length===1){this._nbNotifsStacked.setAttribute("style","display: none;");this._multipleNotifsStacked.setAttribute("style","display: none;");this.getDiv().setAttribute("multiple-notifications",false)}}},removeIndex:function(x){if(x<0||x>=this.getNotificationsData().length){return}if(this.getNotificationsData().length===1||(x===0&&this._notificationOnScreen._animHasBegun&&this.options.manager.getRemoveStackOnFirstTimeoutFlag())){this.dispose();return}this.getNotificationsData().splice(x,1);this.updateNbNotifsStacked();if(x===0){this.refreshContent()}},removeNotification:function(A){var z=this.getNotificationsData();for(var y=0;y<z.length;y++){var x=z[y];if(x.count===A){this.removeIndex(y);return 0}}return 1},removeNotifications:function(z){var A=this.getNotificationsData();for(var y=0;y<A.length;){var x=A[y];if(z(x)){this.removeIndex(y)}else{y++}}},dispose:function(){var x=this.getNotificationsData();x.splice(0,x.length);this._notificationOnScreen.dispose();if(this.getDiv().parentNode){this.getDiv().parentNode.removeChild(this.getDiv())}p.call(this.options.manager,this.options.identifier);this.destroy()}});function j(){this._notifScreen=new f.Element("ul",{"class":"wux-notification-screen"});this.elements={};this.elements.container=this._notifScreen;document.body.appendChild(this.elements.container)}function a(){if(this._fadeOutPolicy==WUXNotificationsOnScreenFadeOutPolicy.Medium){return 5000}else{if(this._fadeOutPolicy==WUXNotificationsOnScreenFadeOutPolicy.Fast){return 2500}else{return 10000}}}function n(y){var x="";if(this._stackingPolicy&1){x+=y.level}if(this._stackingPolicy&2){x+=y.category}if(this._stackingPolicy&4){x+=y.title}if(this._stackingPolicy&8){x+=y.subtitle}return x}function t(x){var y=new l({isStacked:false,manager:this});this._notifications.push(y);y.setData(x);if(x.level==="error"){this.elements.container.insertBefore(y.getDiv(),this.elements.container.firstChild)}else{this.elements.container.appendChild(y.getDiv())}}function c(z){var y=n.call(this,z);if(y){var A=this._notificationsStacks[y];var x;if(!A||A.length===0){x=new g({manager:this,identifier:y,level:z.level});this._notificationsStacks[y]=[x]}else{if((this._stackingPolicy&16)&&(n.call(this,this._lastNotificationDisplayed)!==n.call(this,z))){x=new g({manager:this,identifier:y,level:z.level});this._notificationsStacks[y].push(x)}else{x=this._notificationsStacks[y][this._notificationsStacks[y].length-1]}}x.addNotification(z)}}function b(z){for(var y=0;y<this._notifications.length;y++){var x=this._notifications[y];if(x._data.count===z.oldOptions.count){x.setData(z.newOptions);if(z.newOptions.level==="error"){this.elements.newOptions.container.insertBefore(x.getDiv(),this.elements.container.firstChild)}else{this.elements.container.appendChild(x.getDiv())}break}}}function d(y){var z=n.call(this,y.oldOptions);if(z&&this._notificationsStacks[z]&&this._notificationsStacks[z].length){var x=n.call(this,y.newOptions);if(x===z){this._notificationsStacks[z].every(function(A){return A.changeNotification(y.newOptions)})}else{this._notificationsStacks[z].every(function(A){return A.removeNotification(y.oldOptions.count)});this._displayNotification(y.newOptions)}}}function q(x){x.getDiv().remove();var z=this._notifications;for(var y=0;y<z.length;y++){if(z[y]===x){z.splice(y,1);break}}}function p(y){var x=this._notificationsStacks[y];if(x&&x.length===1){this._notificationsStacks[y].pop();delete this._notificationsStacks[y]}}var h=w.singleton({defaultOptions:{},init:function(x){this._parent(x);j.call(this);this._lastNotificationDisplayed=undefined;this._notificationsStacks={};this._notifications=[];this._manager=undefined;this._fadeOutPolicy=WUXNotificationsOnScreenFadeOutPolicy.Medium;this._filter="";this._stackingPolicy=0;this._removeStackOnFirstTimeout=false;this._modelEvents=new r();this._tokenNotificationAdded=undefined;this._tokenNotificationModified=undefined},setNotificationManager:function(x){if(this._manager===x){return}if(this._tokenNotificationAdded){this._manager.unsuscribeToNotificationAdded(this._tokenNotificationAdded);this._tokenNotificationAdded=undefined}if(this._tokenNotificationModified){this._manager.unsuscribeToNotificationModified(this._tokenNotificationModified);this._tokenNotificationModified=undefined}this._manager=x;if(this._manager){this._tokenNotificationAdded=this._manager.suscribeToNotificationAdded(this._displayNotification.bind(this));this._tokenNotificationModified=this._manager.suscribeToNotificationModified(this._changeNotification.bind(this))}},slide:function(x){if(x.right){this._notifScreen.style.right=x.right+"px"}if(x.left){this._notifScreen.style.right=x.left+"px"}},restorePosition:function(){this._notifScreen.style.right="10px"},setFadeOutPolicy:function(x){if(x!==WUXNotificationsOnScreenFadeOutPolicy.Fast&&x!==WUXNotificationsOnScreenFadeOutPolicy.Medium&&x!==WUXNotificationsOnScreenFadeOutPolicy.Slow){console.error("Error in NotificationsManagerViewOnScreen::setFadeOutPolicy, policy was not recognized");return}this._fadeOutPolicy=x},getFadeOutPolicy:function(){return this._fadeOutPolicy},setFilterDisplayedNotification:function(x){if(this._filter==x){return}this._filter=x||""},getFilterDisplayedNotification:function(){return this._filter},setStackingPolicy:function(x){if(this._stackingPolicy===x){return}if(x!==0&&(x%2!==1||x>31)){console.log("NotificationsManagerOnScreen stackingPolicy wrong input value");return}this._stackingPolicy=x},getStackingPolicy:function(){return this._stackingPolicy},setRemoveStackOnFirstTimeoutFlag:function(x){this._removeStackOnFirstTimeout=x},getRemoveStackOnFirstTimeoutFlag:function(){return this._removeStackOnFirstTimeout},removeLastNotificationDisplayed:function(){if(!this._lastNotificationDisplayed){return}var x=this;if(this._stackingPolicy!==0){var y=n.call(this,this._lastNotificationDisplayed);if(y&&this._notificationsStacks[y]&&this._notificationsStacks[y].length){this._notificationsStacks[y].every(function(z){return z.removeNotification(x._lastNotificationDisplayed.count)});this._lastNotificationDisplayed=undefined}return}this._notifications.every(function(z){if(z._data.count===x._lastNotificationDisplayed.count){z.dispose();x._lastNotificationDisplayed=undefined;return 0}return 1})},removeNotification:function(z){if(this._stackingPolicy!==0){for(var A in this._notificationsStacks){var x=this._notificationsStacks[A].every(function(B){return B.removeNotification(z)});if(!x){break}}return}var y=this;this._notifications.every(function(B){if(B._data.count===z){B.dispose();if(y._lastNotificationDisplayed&&y._lastNotificationDisplayed.count===z){y._lastNotificationDisplayed=undefined}return 0}return 1})},removeNotifications:function(y,C){if(y||C){var A=function(D){return((!y||D.category===y)&&(!C||D.level===C))};if(this._stackingPolicy!==0){for(var B in this._notificationsStacks){this._notificationsStacks[B].forEach(function(D){D.removeNotifications(A)})}return}for(var x=0;x<this._notifications.length;){if(A(this._notifications[x]._data)){this._notifications[x].dispose()}else{x++}}}else{for(var B in this._notificationsStacks){this._notificationsStacks[B].forEach(function(D){D.dispose()})}var z;while(z=this._notifications[0]){z.dispose()}this._lastNotificationDisplayed=undefined}},setTouchMode:function(y){for(var z in this._notificationsStacks){this._notificationsStacks[z].forEach(function(A){A.setTouchMode(y)})}for(var x=0;x<this._notifications.length;x++){this._notifications[x].setTouchMode(y)}},_displayNotification:function(x){if(this._filter!==""&&x.category!==this._filter){return}if(this._stackingPolicy===0){t.call(this,x)}else{c.call(this,x)}this._lastNotificationDisplayed=x},_changeNotification:function(x){if(this._stackingPolicy===0){b.call(this,x)}else{d.call(this,x)}if(x.newOptions.count===this._lastNotificationDisplayed.count){this._lastNotificationDisplayed=x.newOptions}}});return h});define("DS/Notifications/NotificationsManagerUXMessages",["DS/WebappsUtils/WebappsUtils","DS/Notifications/NotificationsManagerAbstract","UWA/Core","UWA/Class"],function(d,c,e,a){var b=c.singleton({defaultOptions:{},init:function(f){this._parent(f);this._dataModel={level:"info",title:"",subtitle:"",message:"",icon:null,sticky:false,category:"",action:{label:"",callback:function(){}}}},_completeOptions:function(f){f.level=f.level||"info";f.title=f.title||"";f.subtitle=f.subtitle||"";f.message=f.message||"";f.sticky=f.sticky||false;f.category=f.category||"";if(f.action){f.action.label=f.action.label||"Action";f.action.callback=f.action.callback||function(){}}else{f.action={label:"",callback:function(){}}}},_buildModelFromOptions:function(g,f){return{count:g,level:f.level,title:f.title,subtitle:f.subtitle,message:f.message,icon:f.icon,sticky:f.sticky,category:f.category,action:f.action}}});return b});define("DS/Developer/UnsafeHTMLDisplay",["DS/Utilities/Utils","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(d,c,a){var e=500;var b={startUnsafeHTMLDisplay:function(){if(!this._unsafeHTMLDisplayInterval){var f=this;f._displayUnsafeHTMLRunning=false;this._unsafeHTMLDisplayInterval=window.setInterval(function(){if(f._displayUnsafeHTMLRunning===true){return}f._applyUnsafeHTMLDisplay(true);f._displayUnsafeHTMLRunning=false},e);var g={level:"info",title:"Start displaying Unsafe HTML",subtitle:"Surrounding dynamically all fields containing unsafe HTML.",message:"To stop this debug feature, you can type WUX.stopUnsafeHTMLDisplay() in your browser console.",sticky:false};a.setNotificationManager(c);a.setFadeOutPolicy(WUXNotificationsOnScreenFadeOutPolicy.Slow);c.addNotif(g)}},stopUnsafeHTMLDisplay:function(){this._displayUnsafeHTMLRunning=false;if(this._unsafeHTMLDisplayInterval){window.clearInterval(this._unsafeHTMLDisplayInterval);delete this._unsafeHTMLDisplayInterval;this._applyUnsafeHTMLDisplay(false);var f={level:"info",title:"Stop displaying Unsafe HTML",subtitle:"Removing unsafe HTML feedback.",message:"Warning : residual unsafe feedback can remain after cleaning. You may need to refresh your session to remove them.",sticky:false};a.setNotificationManager(c);a.setFadeOutPolicy(WUXNotificationsOnScreenFadeOutPolicy.Slow);c.addNotif(f)}},_applyUnsafeHTMLDisplayToFrame:function(f,h){this._displayUnsafeHTMLRunning=true;var m=[];var q="allowUnsafe";var l=f.getElementsByTagName("*");for(var j=0;j<l.length;j++){var n=l[j].dsModel;var t=l[j].layoutDsModel;var g=false;var s;var o=t?t:n;if(o){var r=false;var k=(o.options&&Object.keys(o.options).length>0)?o.options:o;for(var p in k){if(p.indexOf(q)!==-1){r=true;g=k[p];s=p;break}}if(!r){continue}}else{if(l[j]._allowUnsafeHTMLContent===true||[j]._allowUnsafeHTMLContent===false){g=l[j]._allowUnsafeHTMLContent}else{continue}}l[j].removeClassName("wux-controls-unsafe-default-html-debug-display");l[j].removeClassName("wux-controls-unsafe-html-debug-display");l[j].removeClassName("wux-controls-safe-text-debug-display");l[j].removeClassName("wux-controls-safe-default-text-debug-display");if(h===true){if(s&&o){var i=d.getXSSDefaultBehavior();if(g===true){l[j].addClassName("wux-controls-unsafe-html-debug-display")}else{if(g===false){l[j].addClassName("wux-controls-safe-text-debug-display")}else{if(i==="safe"){l[j].addClassName("wux-controls-safe-default-text-debug-display")}else{l[j].addClassName("wux-controls-unsafe-default-html-debug-display")}}}}else{l[j].addClassName("wux-controls-unsafe-html-debug-display")}m.push(l[j].innerHTML)}}},_applyUnsafeHTMLDisplay:function(g){this._displayUnsafeHTMLRunning=true;b._applyUnsafeHTMLDisplayToFrame(document,g);var h=document.getElementsByTagName("iframe");for(var i=0;i<h.length;i++){var f=h[i].contentDocument;if(!f){continue}b._applyUnsafeHTMLDisplayToFrame(f,g)}}};return b});define("DS/Controls/GradientSlider",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Controls/Slider","DS/WebRecordEnabler/Adapter"],function(h,g,c,e,f,d){var b=f.inherit({name:"gradientSlider",markForRecordFlag:true,publishedProperties:{},buildView:function(){var k="wux-controls-gradientslider-";var j=this;this._parent();var i=[{namediv:"colorPickerHuePicker",elemDiv:"picker",nameCanvas:"canvasHuePicker",elemCanvas:"canvasHue",width:"26",height:"300"}];i.forEach(function(l){j.elements[l.namediv]=new h.Element("div",{"class":k+l.elemDiv}).inject(j.elements.sliderContainer);j.elements[l.nameCanvas]=new h.Element("canvas",{"class":k+l.elemCanvas,width:l.width,height:l.height})});this.elements.colorPickerHuePicker.appendChild(this.elements.canvasHuePicker);this.elements.sliderContainer.height=300;this.elements.canvasHuePicker.height=this.elements.sliderContainer.height;this.elements.cursor=new h.Element("span",{"class":"wux-ui-fa wux-ui-fa-caret-left"}).inject(this.elements.sliderCursor);this.elements.sliderCursor.addClassName("wux-controls-gradientslider-cursor");this._valueHex="ff0000"},_postBuildView:function(){this.refreshView()},handleEvents:function(){this._parent();var i=this;var j=false;var k=false;this.elements.container.addEvent(c.POINTERDOWN,function(l){l.stopPropagation()});this.elements.container.addEvent(c.POINTERMOVE,function(l){l.preventDefault()});this.elements.cursor.addEvent("mouseleave",function(l){document.body.style.cursor="default"});this.elements.container.addEvent("change",function(l){i.isPressed=true;if(i.elements.sliderContainer){i._calculRGB()}})},_calculRGB:function(){var k=this.elements.canvasHuePicker.getContext("2d");var l=this.elements.sliderCursor.offsetTop;if(l<0){l=0}var m=k.getImageData(10,l,1,1);var j=m.data;var i={r:j[0],g:j[1],b:j[2]};if(!this.hexValueIsBeingSet){this.calculRGBInProccess=true;this._setValueHex(e.rgbToHex({r:parseInt(i.r),g:parseInt(i.g),b:parseInt(i.b)}));this.calculRGBInProccess=false}},_setValueHex:function(i){if(i!=this._valueHex){this.hexValueIsBeingSet=true;this._valueHex=i;if(!this.calculRGBInProccess){this._calculPositionCursor(e.hexToHsl(this._valueHex)[0])}this.hexValueIsBeingSet=false}},_getValueHex:function(){return this._valueHex},_calculPositionCursor:function(j){var k=(360-j)/360*this.elements.canvasHuePicker.height;var i=((this.elements.canvasHuePicker.height-k)/this.elements.canvasHuePicker.height)*100;this.setPercentage(i)},_getMousePos:function(j,i){var k=j.getBoundingClientRect();return{x:i.clientX-k.left,y:i.clientY-k.top}},refreshView:function(){var p=this.elements.canvasHuePicker.getContext("2d");var n=p.createLinearGradient(0,0,0,this.elements.canvasHuePicker.height);var m=37;for(var k=0;k<m;k++){var l=k/(m-1);var j=[(1-l)*360,100,50];var i=e.hslToRgb(j);var o=a(i);n.addColorStop(l,o)}p.fillStyle=n;p.fillRect(0,0,this.elements.canvasHuePicker.width,this.elements.canvasHuePicker.height);this.elements.sliderBackgroundFilled.remove();this.elements.sliderBackground.remove();this.isPressed=false}});var a=function(i){return"rgb("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+")"};d.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/ColorChooser",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Controls/LineEditor","DS/Utilities/Color","DS/Controls/GradientSlider","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Controls/SpinBox","DS/Utilities/Dom"],function(d,f,e,b,j,g,k,c,i,a){var h=f.inherit({name:"colorChooser",markForRecordFlag:true,publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true,recordFlag:true},referenceValue:{defaultValue:"ffffff",type:"string"},colorChooserDimensions:{defaultValue:{x:420,y:300},type:"vector2"},informationsVisibleFlag:{defaultValue:true,type:"boolean"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",noNeedToApplyFlag:true},},blackBoxFlag:true,buildView:function(){var o=this;this._minColorChooserDimensions={};this.elements.container.addClassName("wux-controls-colorchooser");var p="wux-controls-colorchooser-";var n=[{namediv:"_colorChooserCanvas",elemDiv:"canvas",nameCanvas:"_canvasPicker",elemCanvas:"canvas"}];n.forEach(function(q){o.elements[q.namediv]=new d.Element("div",{"class":p+q.elemDiv}).inject(o.elements.container);o.elements[q.nameCanvas]=new d.Element("canvas",{"class":p+q.elemCanvas});o.elements[q.nameCanvas].setAttribute("tabindex","1")});this.elements._pickerCursor=d.createElement("div",{"class":p+"canvas-picker-cursor wux-element-contentbox"});this.elements._pickerCursor2=d.createElement("div",{"class":p+"canvas-picker-cursor2 wux-element-contentbox"}).inject(this.elements._pickerCursor);this.elements._canvasPicker.width=this.colorChooserDimensions.x-120;this.elements._canvasPicker.height=this.colorChooserDimensions.y;this.elements._colorChooserCanvas.appendChild(this.elements._canvasPicker);this.elements._colorChooserCanvas.appendChild(this.elements._pickerCursor);var l=[{name:"_colorChooserHuePicker",elem:"picker",target:"container"},{name:"_panelInfos",elem:"informations",target:"container"},{name:"_color",elem:"picker-color",target:"_panelInfos"},{name:"_colorRef",elem:"picker-colorRef",target:"_panelInfos"},{name:"_panelColorR",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorG",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorB",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorH",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorS",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorL",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorHex",elem:"informations-color",target:"_panelInfos"}];l.forEach(function(q){o.elements[q.name]=new d.Element("div",{"class":p+q.elem}).inject(o.elements[q.target])});a.addEventOnElement(this,this.elements._colorRef,e.POINTERHIT,function(q){if(q.multipleHitCount!==2){return}if(o.referenceValue!==undefined){o.fire("beginEdit");o.setPropertyFromUIInteraction("value",o.referenceValue);o.fire("endEdit")}});this.elements._slider=new g({handleEditionCancel:false,fireOnlyFromUIInteractionFlag:true,valuePopupFlag:false}).inject(this.elements._colorChooserHuePicker);this.elements._slider.displayStyle="vertical";this.elements._slider.height=this.colorChooserDimensions.y;var m=[{nameLabel:"_labelR",elemLabel:"label",target:"_panelColorR",text:" R: ",nameLineEditor:"_valueR",placeHolder:"R value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelG",elemLabel:"label",target:"_panelColorG",text:" G: ",nameLineEditor:"_valueG",placeHolder:"G value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelB",elemLabel:"label",target:"_panelColorB",text:" B: ",nameLineEditor:"_valueB",placeHolder:"B value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelH",elemLabel:"label",target:"_panelColorH",text:" H: ",minValue:0,maxValue:360,nameLineEditor:"_valueH",placeHolder:"H value",pattern:"^(?:s*|0|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9][0-9]|[1-9]))$"},{nameLabel:"_labelS",elemLabel:"label",target:"_panelColorS",text:" S: ",minValue:0,maxValue:100,nameLineEditor:"_valueS",placeHolder:"S value",pattern:"^0*(?:[0-9][0-9]?|100)$"},{nameLabel:"_labelL",elemLabel:"label",target:"_panelColorL",text:" L: ",nameLineEditor:"_valueL",placeHolder:"L value",pattern:"^0*(?:[0-9][0-9]?|100)$",minValue:0,maxValue:100},{nameLabel:"_labelHex",elemLabel:"label-hexa",target:"_panelColorHex",text:" # ",nameLineEditor:"_valueHex",placeHolder:"Hex value",pattern:"^(#{0,1}[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"}];m.forEach(function(q){o.elements[q.nameLabel]=new d.Element("div",{"class":p+q.elemLabel,text:q.text}).inject(o.elements[q.target]);if(q.nameLabel==="_labelHex"){o.elements[q.nameLineEditor]=new b({placeholder:q.placeHolder,pattern:q.pattern,sizeInCharNumber:3,value:undefined,fireOnlyFromUIInteractionFlag:true}).inject(o.elements[q.target]);o.elements[q.nameLineEditor].getContent().addClassName(p+"lineeditor")}else{o.elements[q.nameLineEditor]=new i({placeholder:q.placeHolder,pattern:q.pattern,minValue:q.minValue,maxValue:q.maxValue,stepValue:1,value:undefined,displayStyle:"lite",fireOnlyFromUIInteractionFlag:true}).inject(o.elements[q.target]);o.elements[q.nameLineEditor].getContent().addClassName(p+"spinbox")}a.onNodeRendered(o.getContent(),function(){o._updatePickerCursorPositionFromValue()})});this._pickerCanvasBackground();this.elements._pickerCursor.hide()},_postBuildView:function(){this._applyReferenceValue();if(!this.informationsVisibleFlag){this.elements._panelInfos.hide()}},_applyInformationsVisibleFlag:function(){if(!this.informationsVisibleFlag){this.elements._panelInfos.hide()}else{this.elements._panelInfos.show()}this._updateMinColorChooserDimensions();this._applyColorChooserDimensions()},_applyProperties:function(l){this._parent(l);this._applyValue(l.value,this.value);this._applyTouchMode();this._applyInformationsVisibleFlag()},_applyDisabled:function(){this._parent();this.elements._slider.disabled=this.disabled;this.elements._valueR.disabled=this.disabled;this.elements._valueG.disabled=this.disabled;this.elements._valueB.disabled=this.disabled;this.elements._valueH.disabled=this.disabled;this.elements._valueS.disabled=this.disabled;this.elements._valueL.disabled=this.disabled;this.elements._valueHex.disabled=this.disabled;if(this.disabled){this.elements.container.removeAttribute("tabindex");this.elements._colorChooserCanvas.setAttributeNode(document.createAttribute("disabled"));this.elements._pickerCursor.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.container.setAttribute("tabindex","0");this.elements._colorChooserCanvas.removeAttribute("disabled");this.elements._pickerCursor.removeAttribute("disabled")}},_applyReferenceValue:function(l,n){if(this.referenceValue!==undefined){if(this.referenceValue.charAt(0)==="#"){var o=this.referenceValue.substr(1);var m=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(m.test(o)){this.referenceValue=o}else{this.referenceValue=l}}this.elements._colorRef.setStyle("background",j.colorToCssColor(j.hexToRgb(this.referenceValue)))}},_applyColorChooserDimensions:function(){var l=120;if(!this.informationsVisibleFlag){l=32}var m=Math.max(this._minColorChooserDimensions.y,this.colorChooserDimensions.y);this.elements._colorChooserCanvas.height=m;this.elements._slider.elements.canvasHuePicker.height=m;this.elements._panelInfos.height=m;this.elements.container.width=this.colorChooserDimensions.x;this.elements.container.height=m;this.elements._slider.height=m;this.elements._canvasPicker.width=this.colorChooserDimensions.x-l;this.elements._colorChooserCanvas.width=this.colorChooserDimensions.x-l;this.elements._canvasPicker.height=m;this._pickerCanvasBackground();this.elements._slider.refreshView();this._updatePickerCursorPositionFromValue()},_preEditValue:function(l,m){if(l==m){this._updatePickerCursorPositionFromValue()}},_applyValue:function(n,p){if(p===""){this.value=undefined;return}if(typeof p!=="undefined"&&p!==null){if(p.charAt(0)==="#"){this.value=p.substr(1);return}var o=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(!o.test(p)){this.value=n;return}p=p.toLowerCase();var m=j.hexToRgb(p);var l=j.rgbToHsl(m.r,m.g,m.b);if(!this.pointerdownCanvasP){this.elements._slider._setValueHex(j.hsvToHex([this._getPureH(),100,100]));this._pickerCanvasBackground();if(!this._updateFromHSLEditors){this.elements._valueH.value=Math.round(l[0])}}this.elements._color.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)));this.elements._color.removeClassName("undefined-class");var m=j.hexToRgb(this.value);if(!this._updateFromHSLEditors){this.elements._valueS.value=Math.round(l[1]);this.elements._valueL.value=Math.round(l[2])}if(!this._updateFromRGBEditors){this.elements._valueR.value=m.r;this.elements._valueG.value=m.g;this.elements._valueB.value=m.b}this.elements._pickerCursor.show();this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)));this._updatePickerCursorPositionFromValue();this.elements._valueHex.value=p}else{this.elements._valueR.value=undefined;this.elements._valueG.value=undefined;this.elements._valueB.value=undefined;this.elements._valueH.value=undefined;this.elements._valueS.value=undefined;this.elements._valueL.value=undefined;this.elements._valueHex.value=undefined;this.elements._color.addClassName("undefined-class");this.elements._pickerCursor.hide()}this.fire("change")},_applyTouchMode:function(){var l=this._getCurrentTouchMode();if(l===true){this.elements._panelInfos.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements._panelInfos.removeAttribute("touch-mode")}this._updateMinColorChooserDimensions()},_updateMinColorChooserDimensions:function(){if((this._getCurrentTouchMode())){if(this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==350){this._minColorChooserDimensions.y=350;this._applyColorChooserDimensions()}else{if(!this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==100){this._minColorChooserDimensions.y=100;this._applyColorChooserDimensions()}}}else{if(this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==240){this._minColorChooserDimensions.y=240;this._applyColorChooserDimensions()}else{if(!this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==100){this._minColorChooserDimensions.y=100;this._applyColorChooserDimensions()}}}},_handleEvents:function(){var r=this;this.pointerdownCanvasP=false;this.pointerdownSliderP=false;var q=document;if(r.getContent()&&r.getContent().ownerDocument){q=r.getContent().ownerDocument}var p=function(u){if(r.disabled){return}if(!r.pointerdownCanvasP){return}r.elements._pickerCursor.show();var t=r._getMousePos(r.elements._canvasPicker,u);if(t.x>r.elements._colorChooserCanvas.clientWidth-1){t.x=r.elements._colorChooserCanvas.clientWidth-1}if(t.y>r.elements._colorChooserCanvas.clientHeight){t.y=r.elements._colorChooserCanvas.clientHeight}if(t.x<0){t.x=1}if(t.y<0){t.y=1}r.setPropertyFromUIInteraction("value",r._getValueFromMousePosInCanvas(r.elements._canvasPicker,{x:t.x,y:t.y}));r._updatePickerCursorPositionFromMousePosition({x:t.x-r.elements._pickerCursor.clientWidth,y:t.y-r.elements._pickerCursor.clientHeight})};a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERDOWN,function(u){r.elements._canvasPicker.focus();if(r.disabled){return}u.preventDefault();r.initialValue=r.value;r.pointerdownCanvasP=true;r.fire("beginEdit");var t=r._getMousePos(r.elements._canvasPicker,u);if(t.x<0){t.x=0}if(t.y<0){t.y=0}r.setPropertyFromUIInteraction("value",r._getValueFromMousePosInCanvas(r.elements._canvasPicker,{x:t.x,y:t.y}));r._updatePickerCursorPositionFromMousePosition({x:t.x-r.elements._pickerCursor.clientWidth,y:t.y-r.elements._pickerCursor.clientHeight})});a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERMOVE,p);a.addEventOnElement(this,q,e.POINTERMOVE,p);function m(v){v.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var t={r:parseInt(r.elements._valueR.value),g:parseInt(r.elements._valueG.value),b:parseInt(r.elements._valueB.value)};var u=j.rgbToHex(t);r._updateFromRGBEditors=true;r.setPropertyFromUIInteraction("value",u);r._updateFromRGBEditors=false}}function n(v){v.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var t=[parseInt(r.elements._valueH.value),Math.round(r.elements._valueS.value),Math.round(r.elements._valueL.value).toFixed(1)];var u=j.hslToHex(t);r._updateFromHSLEditors=true;r.setPropertyFromUIInteraction("value",u);r._updateFromHSLEditors=false}}function o(t){t.stopPropagation();r.fire("beginEdit")}function l(t){t.stopPropagation();r.fire("endEdit")}function s(t){t.stopPropagation();r.fire("cancelEdit")}a.addEventOnElement(this,this.elements._panelInfos,"beginEdit",o);a.addEventOnElement(this,this.elements._panelInfos,"endEdit",l);a.addEventOnElement(this,this.elements._panelInfos,"cancelEdit",s);a.addEventOnElement(this,this.elements._panelInfos,"uncommittedChange",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._panelInfos,"preValidateValue",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueR,"change",m);a.addEventOnElement(this,this.elements._valueG,"change",m);a.addEventOnElement(this,this.elements._valueB,"change",m);a.addEventOnElement(this,this.elements._valueR,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueG,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueB,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueR,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueG,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueB,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueH,"change",n);a.addEventOnElement(this,this.elements._valueS,"change",n);a.addEventOnElement(this,this.elements._valueL,"change",n);a.addEventOnElement(this,this.elements._valueH,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueS,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueL,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueH,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueS,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueL,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueHex,"focus",function(t){t.stopPropagation();r.fire("beginEdit")});a.addEventOnElement(this,this.elements._valueHex,"change",function(t){t.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var u=new RegExp("^(#{0,1}[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(u.test(r.value)){r.setPropertyFromUIInteraction("value",r.elements._valueHex.value)}else{r.value=undefined}}});a.addEventOnElement(this,this.elements._valueHex,"blur",function(t){t.stopPropagation();r.fire("endEdit")});a.addEventOnElement(this,this.elements._valueHex,"uncommittedChange",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._slider,e.POINTERDOWN,function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._slider,"beginEdit",function(t){t.stopPropagation();r.pointerdownSliderP=true;r.initialValue=r.value;r.fire("beginEdit")});a.addEventOnElement(this,this.elements._slider,"endEdit",function(t){t.stopPropagation();r.pointerdownSliderP=false;r.fire("endEdit")});a.addEventOnElement(this,this.elements._slider,"cancelEdit",function(t){t.stopPropagation();r.pointerdownSliderP=false;r.fire("cancelEdit")});a.addEventOnElement(this,this.elements._slider,"change",function(t){if(t.target.dsModel&&t.target.dsModel.isPressed){}t.stopPropagation();var w=r.elements._slider._getValueHex();var x=j.hexToHsv(w);var v;if(r.value!==undefined&&r.value!==null){v=j.hexToHsv(r.value)}else{v=j.hexToHsv(w)}var u=j.hsvToHex([x[0],v[1],v[2]]);if(r.value===u){r.elements._valueH.value=Math.round(x[0])}else{r.setPropertyFromUIInteraction("value",u)}r._pickerCanvasBackground()});a.addEventOnElement(this,q.body,e.POINTERUP,function(t){if(r.disabled){return}if(r.pointerdownCanvasP){r.pointerdownCanvasP=false;r.fire("endEdit")}q.body.style.cursor=""});a.addEventOnElement(this,this.elements._colorChooserCanvas,"keydown",function(t){if(r.disabled){return}if(k.ESCAPE==t.keyCode&&r.pointerdownCanvasP){if(!r.handleEditionCancel){return}t.stopPropagation();if(r.initialValue!==undefined){r.setPropertyFromUIInteraction("value",r.initialValue);r.fire("cancelEdit")}}});a.addEventOnElement(this,this.elements._slider,"keydown",function(t){if(r.disabled){return}if(k.ESCAPE==t.keyCode&&r.pointerdownSliderP){if(!r.handleEditionCancel){return}t.stopPropagation();if(r.initialValue!==undefined){r.setPropertyFromUIInteraction("value",r.initialValue)}r.fire("cancelEdit")}});a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERUP,function(t){if(r.disabled){return}q.body.style.cursor="";if(r.pointerdownCanvasP){r.pointerdownCanvasP=false;r.fire("endEdit")}})},_getValueFromMousePosInCanvas:function(o,l){var p=o.getContext("2d");var r=p.getImageData(l.x,l.y,1,1);var n=r.data;var m={r:n[0],g:n[1],b:n[2]};var q=j.rgbToHex({r:parseInt(n[0]),g:parseInt(n[1]),b:parseInt(n[2])}).toLowerCase();return q},_updatePickerCursorPositionFromMousePosition:function(l){this.elements._pickerCursor.show();var m=document;if(this.getContent()&&this.getContent().ownerDocument){m=this.getContent().ownerDocument}m.body.style.cursor="pointer";if(l.x>=-this.elements._pickerCursor.clientWidth+1&&l.x<=this.elements._colorChooserCanvas.clientWidth-this.elements._pickerCursor.clientWidth&&l.y>=-this.elements._pickerCursor.clientHeight+1&&l.y<=this.elements._colorChooserCanvas.clientHeight-this.elements._pickerCursor.clientHeight){this.elements._pickerCursor.setStyle("left",l.x+"px");this.elements._pickerCursor.setStyle("top",l.y+"px")}},_updatePickerCursorPositionFromValue:function(){if(typeof this.value!=="undefined"&&this.value!==null){this.elements._pickerCursor.show();var n=j.hexToHsv(this.value);var m=parseFloat(n[1]);var l=parseFloat(n[2]);var p=this.elements._colorChooserCanvas.getDimensions().width*m/100;var o=this.elements._colorChooserCanvas.getDimensions().height*(100-l)/100;this.elements._pickerCursor.setStyle("left",p-this.elements._pickerCursor.getDimensions().width/2+"px");this.elements._pickerCursor.setStyle("top",o-this.elements._pickerCursor.getDimensions().height/2+"px")}},_getMousePos:function(m,l){var n=m.getBoundingClientRect();return{x:l.clientX-n.left,y:l.clientY-n.top}},_getPureH:function(){var l;var m=this.elements._slider._getValueHex();if(this.value!==undefined&&this.value!==null&&this.value!=="ffffff"){l=j.hexToHsv(this.value);if(l[0]===0){l=j.hexToHsv(m)}}else{l=j.hexToHsv(m)}return l[0]},_pickerCanvasBackground:function(){var r=this.elements._slider._getValueHex();var o=j.hsvToHex([this._getPureH(),100,100]);var n=this.elements._canvasPicker.getContext("2d");var p=this.elements._canvasPicker.width;var l=this.elements._canvasPicker.height;var m=n.createLinearGradient(0,0,p,0);var r=this.elements._slider._getValueHex();m.addColorStop(0,"white");m.addColorStop(1,j.colorToCssColor(j.hexToRgb(o)));n.fillStyle=m;n.fillRect(0,0,p,l);var q=n.createLinearGradient(0,0,0,l);q.addColorStop(0,"transparent");q.addColorStop(1,"black");n.fillStyle=q;n.fillRect(0,0,p,l);this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)))}});c.register(h,"DS/ControlsRec/AbstractRec");return h});define("DS/Controls/ColorPicker",["UWA/Core","DS/Controls/Abstract","DS/Controls/ColorChooser","DS/Controls/Popup","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(f,h,a,d,g,k,l,b,c){var i=h.inherit({name:"colorPicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:"ffffff",type:"string",category:"Behavior",advancedSetter:true,recordFlag:true},referenceValue:{defaultValue:"ffffff",type:"string",category:"Behavior"},alignment:{defaultValue:"left",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",}},blackBoxFlag:true,keymaps:{space:{keydown:"actionPopup",keyup:"preventDefault"}},commands:{actionPopup:function e(){var m=this.elements._popup;if(m){if(m.visibleFlag){m.hide()}else{m.show()}}return{preventDefault:true,stopPropagation:true}},preventDefault:function j(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-colorpicker-button");this.elements._colorChooser=new a({value:this.value,handleEditionCancel:false});if(!this.elements._popup){var m={target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click escape",overlap:false,recId:this.recId+"-popup",fireOnlyFromUIInteractionFlag:true};this.elements._popup=new d(m);c.ignoreForRecord(this.elements._popup.getContent());this.elements._popup.setBody(this.elements._colorChooser);this._applyAlignment();this.currentValue=this.value;this.initialValue=undefined}},_postBuildView:function(){if(this._preEditValue(undefined,this.value)){this._applyValue()}},_applyProperties:function(m){this._parent(m);if(this.isDirty("value")){if(!this._preEditValue||this._preEditValue(m.value,this.value)){this._applyValue(m.value)}}if(this.isDirty("referenceValue")){this._applyReferenceValue(m.referenceValue)}if(this.isDirty("alignment")){this._applyAlignment(m.alignment)}if(this.isDirty("popupVisibleFlag")){this._applyPopupVisibleFlag(m.popupVisibleFlag)}},_applyRecId:function(){this._parent();this.elements._popup.recId=this.recId+"-popup"},_applyAlignment:function(){if(this.elements._popup){if(this.alignment==="right"){this.elements._popup.offset.x=-405}else{this.elements._popup.offset.x=0}}},_applyTouchMode:function(){var m=this._getCurrentTouchMode();if(m===true){this.elements.container.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.container.removeAttribute("touch-mode")}},_preEditValue:function(m,o){if(typeof o!=="undefined"&&o!==null){var p=true;if(o.toString()!==o){o=o.toString();p=false}if(o.charAt(0)==="#"){o=o.substr(1);p=false}var n=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(n.test(o)){if(p){return true}else{this.value=o;return false}}else{return false}}return true},_applyValue:function(m){var o=this.value;if(this.elements.container&&this.elements._colorChooser!==undefined&&typeof o!=="undefined"&&o!==null){this.elements._colorChooser.value=o;this.elements.container.setStyle("background",k.colorToCssColor(k.hexToRgb(o)));var n=this.currentValue;if(typeof n!=="string"||typeof o!=="string"||o===null||n===null){if(o!==n&&(this.elements._popup.visibleFlag||this._popupClosingFlag)){this.fire("liveChange")}else{if(o!==n&&!this.elements._popup.visibleFlag){if(m&&o&&m!==o.substr(1)&&m.substr(1)!==o){this.fire("change")}}}}else{if(o.toLowerCase()!==n.toLowerCase()&&(this.elements._popup.visibleFlag||this._popupClosingFlag)){this.fire("liveChange")}else{if(o.toLowerCase()!==n.toLowerCase()&&!this.elements._popup.visibleFlag){if(typeof m!=="string"||m===null||typeof o!=="string"||o===null){if(m!==o){this.fire("change")}}else{if(m&&o&&m!==o.substr(1)&&m.substr(1)!==o){this.fire("change")}}}}}this.elements.container.removeClassName("undefined-class")}else{this.elements._colorChooser.value=o;this.elements.container.addClassName("undefined-class");this.elements.container.setStyle("background",k.colorToCssColor(k.hexToRgb("ffffff")))}},_applyReferenceValue:function(m){if(this.referenceValue!==undefined){this.elements._colorChooser.referenceValue=this.referenceValue}},_applyDisabled:function(m){this._parent();this.elements._colorChooser.disabled=this.disabled;if(this.disabled){this.elements.container.removeAttribute("tabindex")}else{this.elements.container.setAttribute("tabindex",0)}},_applyPopupVisibleFlag:function(m){var n=this;if(n.popupVisibleFlag){n.elements._popup.visibleFlag=true;n.fire("show")}else{n.elements._popup.visibleFlag=false;n.fire("hide",{cancelFlag:n._eventTrigger==="escape"?true:false})}},_giveFocus:function(){if(this._isFocused()){return}this.elements.container.focus()},handleEvents:function(){var m=this;b.addEventOnElement(this,this.elements._colorChooser,"beginEdit",function(n){n.stopPropagation();m.fire("beginEdit")});this.elements._colorChooser.addEventListener("change",function(n){n.stopPropagation();if(typeof m.value!=="undefined"&&m.value!==null){if(m.value.toLowerCase()!==m.elements._colorChooser.value.toLowerCase()){m.setPropertyFromUIInteraction("value",m.elements._colorChooser.value)}}else{m.setPropertyFromUIInteraction("value",m.elements._colorChooser.value)}});b.addEventOnElement(this,this.elements._colorChooser,"endEdit",function(n){n.stopPropagation()});b.addEventOnElement(this,this.elements._popup,"show",function(n){n.stopPropagation();m.elements._colorChooser.value=m.value;m.currentValue=m.value;m.initialValue=m.value;m.setPropertyFromUIInteraction("popupVisibleFlag",true)});b.addEventOnElement(this,this.elements._popup,"hide",function(n){n.stopPropagation();if(n.options.trigger==="escape"){if(m.handleEditionCancel){if(m.initialValue!==undefined&&m.handleEditionCancel===true){m.currentValue=m.value;m._popupClosingFlag=true;m.setPropertyFromUIInteraction("value",m.initialValue);m._popupClosingFlag=false}m.fire("cancelEdit")}}else{if(typeof this.currentValue==="undefined"||typeof this.value==="undefined"||this.value===null||this.currentValue===null){if(m.value!==m.currentValue&&(m.initialValue==undefined||m.value!==m.initialValue)){m.fire("change");m.fire("endEdit")}}else{if(m.value.toLowerCase()!==m.currentValue.toLowerCase()&&(m.initialValue===undefined||m.value.toLowerCase()!==m.initialValue.toLowerCase())){m.fire("change");m.fire("endEdit")}}}m.initialValue=undefined;m._eventTrigger=n.options.trigger;m.setPropertyFromUIInteraction("popupVisibleFlag",false);m._eventTrigger=undefined});b.addEventOnElement(this,this.elements._popup,"keydown",function(n){n.stopPropagation();if(l.ENTER===n.keyCode){if(n.actionPerformed!==true){if(m.popupVisibleFlag){m.elements._popup.hide()}}}})},show:function(){this.popupVisibleFlag=true},hide:function(){this.popupVisibleFlag=false}});c.register(i,"DS/ControlsRec/AbstractRec");return i});define("DS/Controls/Toolbar",["UWA/Core","UWA/Element","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/Popup"],function(d,h,b,l,g,r){var a=l.inherit({name:"toolbar",publishedProperties:{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},verticalAlign:{defaultValue:"center",type:"string",category:"Appearance"},adaptSizeToParent:{defaultValue:false,type:"boolean",category:"Appearance"}},positionArray:["near","center","far"],_resizeListeners:[],buildView:function(){this._resizeListeners=[];this.elements.container.addClassName("wux-controls-toolbar");this.elements.maskContainer=new d.createElement("div",{"class":"wux-controls-toolbar-mask-container"}).inject(this.elements.container);this.elements.nearContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-nearContainer"}).inject(this.elements.maskContainer);this.elements.centerContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-centerContainer"}).inject(this.elements.maskContainer);this.elements.farContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-farContainer"}).inject(this.elements.maskContainer);this.elements.container.dsModel=this;this.elements.maskContainer.dsModel=this},_applyProperties:function(s){this._parent(s);if(this.isDirty("direction")){this._applyDirection(s.direction)}if(this.isDirty("overflowManagement")){this._applyOverflowManagement(s.overflowManagement)}if(this.isDirty("verticalAlign")){this._applyVerticalAlign(s.verticalAlign)}},_applyOverflowManagement:function(t){if(this.overflowManagement==="scroll"){this.elements.maskContainer.addClassName("wux-toolbar-scroll");this.elements.maskContainer.removeClassName("wux-toolbar-dropdown");this.showEverything();if(this.elements.dropdownMenuButton){this.elements.dropdownMenuButton.remove();this.elements.dropdownMenuButton=null}}else{if(this.overflowManagement==="dropdown"){if(!this.elements.dropdownMenuButton){var u=new g({displayStyle:"lite",icon:{iconName:"menu",fontIconFamily:WUXManagedFontIcons.Font3DS}}).inject(this.elements.farContainer);u.getContent().classList.add("wux-toolbar-dropdown-button");this.elements.dropdownMenuButton=u.getContent();this._ddmButtonSize=j.call(this,this.direction,this.elements.dropdownMenuButton);this.elements.dropdownMenuButton.hide();if(!this.elements.dropdownPopup){var s=new r({target:u,position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click",overlap:false});this.elements.dropdownPopup=s;this.elements.dropdownPopup.elements.container.addClassName("wux-toolbar-popup")}else{this.elements.dropdownPopup.target=u}}if(this.getLastInPopup().toolbarItemElement){this.elements.dropdownMenuButton.show()}this.elements.maskContainer.addClassName("wux-toolbar-dropdown");this.elements.maskContainer.removeClassName("wux-toolbar-scroll");e.call(this)}}},_applyDirection:function(s){this.showEverything();if(this.direction==="vertical"){this.elements.container.addClassName("wux-toolbar-vertical");this.elements.container.removeClassName("wux-toolbar-horizontal");this.elements.maskContainer.addClassName("wux-toolbar-vertical");this.elements.maskContainer.removeClassName("wux-toolbar-horizontal")}else{this.elements.container.addClassName("wux-toolbar-horizontal");this.elements.container.removeClassName("wux-toolbar-vertical");this.elements.maskContainer.addClassName("wux-toolbar-horizontal");this.elements.maskContainer.removeClassName("wux-toolbar-vertical")}if(this.elements.dropdownMenuButton){this._ddmButtonSize=j.call(this,this.direction,this.elements.dropdownMenuButton)}e.call(this)},_applyVerticalAlign:function(s){this.elements.container.removeClassName("wux-toolbar-vertical-align-near");this.elements.container.removeClassName("wux-toolbar-vertical-align-center");this.elements.container.removeClassName("wux-toolbar-vertical-align-far");if(this.verticalAlign==="near"){this.elements.container.addClassName("wux-toolbar-vertical-align-near")}else{if(this.verticalAlign==="center"){this.elements.container.addClassName("wux-toolbar-vertical-align-center")}else{if(this.verticalAlign==="far"){this.elements.container.addClassName("wux-toolbar-vertical-align-far")}}}},_applyAdaptSizeToParent:function(s){if(this.adaptSizeToParent){this.getContent().addClassName("wux-toolbar-adaptToParent");this.elements.maskContainer.addClassName("wux-toolbar-adaptToParent")}else{this.getContent().removeClassName("wux-toolbar-adaptToParent");this.elements.maskContainer.removeClassName("wux-toolbar-adaptToParent")}},destroy:function q(){this.clear();b.removeResizeListener(this.elements.container,c);this._resizeListeners=null;this._parent()},add:function(v,s){switch(v){case"element":if(s.element&&s.position){if(!s.element.addClassName){s.element=d.extendElement(s.element)}s.element.addClassName("wux-toolbar-items");var u=this._getContainerFromPosition(s.position);var t=u.getChildren().length>=s.index?u.getChildren()[s.index]:null;if(s.position==="far"&&s.index>=u.getChildren().length-1&&this.overflowManagement==="dropdown"){t=this.elements.dropdownMenuButton}u.insertBefore(s.element,t);if(this._resizeListeners.indexOf(s.position)===-1){this._resizeListeners.push(s.position);b.addResizeListener(this._getContainerFromPosition(s.position),f)}}break;case"separator":var w=new d.createElement("div",{"class":"wux-controls-toolbar-separator"});if(s.element){var u=s.element.getParent();u.insertBefore(w,s.element)}else{if(s.position){var u=this._getContainerFromPosition(s.position);var t=u.getChildren().length>=s.index?u.getChildren()[s.index]:null;u.insertBefore(w,t)}}break}},remove:function(v,u){switch(v){case"element":var w;if(u.element){var s=this.getPositionFromElement(u.element);w=u.element.remove();var t=this._getContainerFromPosition(s.position).getChildren();if(this._resizeListeners.indexOf(s.position)!==-1&&(t.length===1||(s.position==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(s.position),1);b.removeResizeListener(this._getContainerFromPosition(s.position),f)}}else{if(u.position&&u.index){var t=this._getContainerFromPosition(u.position).getChildren();if(u.index>=t.length){u.index=t.length-1}if(t){if(!this._isSeparator(t[u.index])){w=t[u.index].remove()}}if(this._resizeListeners.indexOf(u.position)!==-1&&(t.length===1||(u.position==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(u.position),1);b.removeResizeListener(this._getContainerFromPosition(u.position),f)}}}break;case"separator":if(u.position&&typeof u.index==="number"){var t=this._getContainerFromPosition(u.position).getChildren();if(u.index>=t.length){u.index=t.length-1}if(t){if(this._isSeparator(t[u.index])){t[u.index].remove()}}}break}},clearPosition:function(s){var t=this._getContainerFromPosition(s).getChildren();for(var u=t.length-1;u>=0;u--){if(t[u].getTagName()!=="iframe"&&t[u]!==this.elements.dropdownMenuButton){t[u].remove()}}t=this._getContainerFromPosition(s).getChildren();if(this._resizeListeners.indexOf(s)!==-1&&(t.length===1||(s==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(s),1);b.removeResizeListener(this._getContainerFromPosition(s),f)}},clear:function(){for(var s=0;s<this.positionArray.length;s++){this.clearPosition(this.positionArray[s])}},getElementFromPosition:function(t){var s=this._getContainerFromPosition(t.position).getChildren();if(t.index>=s.length||t.index<0){return null}else{return s[t.index]}},getPositionFromElement:function(t){for(var s=0;s<this.positionArray.length;s++){var u=this._getContainerFromPosition(this.positionArray[s]);if(t.getParent()===u){return{position:this.positionArray[s],index:u.getChildren().indexOf(t)}}}},_getMinimumSizeFromElements:function(){var t=0;for(var u=0;u<this.positionArray.length;u++){var v=this._getContainerFromPosition(this.positionArray[u]);if(v.getTagName()!=="iframe"){t=t+j.call(this,this.direction,v)}}var s,w=0;if(this.elements.container){s=this.direction==="vertical"?window.getComputedStyle(this.elements.container).getPropertyValue("padding-top"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-left");w=this.direction==="vertical"?window.getComputedStyle(this.elements.container).getPropertyValue("padding-bottom"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-right");s=(s==="")?0:parseInt(s,10);w=(w==="")?0:parseInt(w,10)}t=t+s+w;return t},handleEvents:function(){var s=this;b.addResizeListener(this.elements.container,c)},_getFurthestVisibleElement:function(){for(var t=this.positionArray.length-1;t>=0;t--){var s=this._getContainerFromPosition(this.positionArray[t]);for(var u=s.getChildren().length-1;u>=0;u--){if(!s.getChildren()[u].isHidden()&&s.getChildren()[u]!==this.elements.dropdownMenuButton&&s.getChildren()[u].getTagName()!=="iframe"){return s.getChildren()[u]}}}},_getNearestHiddenElement:function(){for(var t=0;t<this.positionArray.length;t++){var s=this._getContainerFromPosition(this.positionArray[t]);for(var u=0;u<s.getChildren().length;u++){if(s.getChildren()[u].isHidden()&&s.getChildren()[u]!==this.elements.dropdownMenuButton&&s.getChildren()[u].getTagName()!=="iframe"){return s.getChildren()[u]}}}},_getLargestElementWidth:function(){var w=0,u;for(var t=0;t<this.positionArray.length;t++){var s=this._getContainerFromPosition(this.positionArray[t]);for(var v=0;v<s.getChildren().length;v++){u=s.getChildren()[v].getSize().width;if(s.getChildren()[v].getTagName()!=="iframe"&&u>w){w=u}}}return w},_getContainerFromPosition:function(s){switch(s){case"near":return this.elements.nearContainer;case"center":return this.elements.centerContainer;case"far":return this.elements.farContainer}},_getNextContainer:function(s){switch(s){case this.elements.nearContainer:return this.elements.centerContainer;case this.elements.centerContainer:return this.elements.farContainer;case this.elements.farContainer:return null}},_isSeparator:function(s){return Boolean(s&&s.hasClassName("wux-controls-toolbar-separator"))},showEverything:o,getLastInPopup:p,getNbElementsInPopup:m,addToPopup:k,addToToolbar:i,enablePopupDefaultBehavior:function(){this.enablePopupBehavior()},enablePopupBehavior:function(s){s=s||{};this.showEverything();this.showEverything=s.showEverything||o;this.getLastInPopup=s.getLastInPopup||p;this.getNbElementsInPopup=s.getNbElementsInPopup||m;this.addToPopup=s.addToPopup||k;this.addToToolbar=s.addToToolbar||i;e.call(this)}});function o(){while(this.getLastInPopup().toolbarItemElement){var s=this.getLastInPopup();if(s.toolbarSeparatorElement){this.addToToolbar(s.toolbarSeparatorElement)}this.addToToolbar(s.toolbarItemElement)}}function n(){var u=this;var t=u.getLastInPopup();var s=t?t.toolbarItemElement:null;var v=t?t.toolbarSeparatorElement:null;var w=0;var x=u.getNbElementsInPopup();if(s){w=j.call(u,u.direction,s);w+=v?j.call(u,u.direction,v):0}return{lastItem:s,separator:v,completeSize:w,nbElements:x}}function p(){var u,t,s;if(this.elements.dropdownPopup){u=this.elements.dropdownPopup.elements.container;t=u.getChildren()[u.getChildren().length-1];while(t&&t.className.indexOf("treelistview")!==-1){t=t.previousSibling}if(this._isSeparator(t)){s=t;t=s.previousSibling}}return{toolbarItemElement:t,toolbarSeparatorElement:s}}function m(){var u=0,s=this.getLastInPopup(),t=s?s.toolbarItemElement:null;for(;t;t=t.previousSibling){if(!this._isSeparator(t)){u++}}return u}function k(s){s.toolbarProperties=s.toolbarProperties||{};s.toolbarProperties.lastParent=s.parentElement;s.toolbarProperties.size=s.getSize();s.toolbarProperties.margin={top:window.getComputedStyle(s).getPropertyValue("margin-top"),bottom:window.getComputedStyle(s).getPropertyValue("margin-bottom"),right:window.getComputedStyle(s).getPropertyValue("margin-right"),left:window.getComputedStyle(s).getPropertyValue("margin-left")};s.parentElement.removeChild(s);s.inject(this.elements.dropdownPopup.elements.container)}function i(t){var s=t.toolbarProperties?t.toolbarProperties.lastParent:null;if(s){t.parentElement.removeChild(t);if(s.classList.contains("wux-controls-toolbar-farContainer")){t.inject(this.elements.dropdownMenuButton,"before")}else{t.inject(s)}}}function c(){if(this&&this.getParent()){var s=this.getParent().dsModel;e.call(s)}}function f(){if(this&&this.getParent()&&this.getParent().getParent()){var s=this.getParent().getParent().dsModel;e.call(s)}}function e(){var t=this.elements.dropdownMenuButton;if(this.overflowManagement==="dropdown"){var w=this.direction==="vertical"?this.elements.container.getSize().height:this.elements.container.getSize().width;var v=this._getMinimumSizeFromElements();if(v>w){while(v>w){var u=this._getFurthestVisibleElement();if(u){this.addToPopup(u);t.show();u=this._getFurthestVisibleElement();if(this._isSeparator(u)){this.addToPopup(u)}v=this._getMinimumSizeFromElements()}else{return}}}else{var s=n.call(this);if(s.lastItem&&v+s.completeSize<=w){while((s.lastItem&&(v+s.completeSize<=w))||(s.nbElements===1&&(v+s.completeSize-this._ddmButtonSize<=w))){if(s.separator){this.addToToolbar(s.separator)}this.addToToolbar(s.lastItem);s=n.call(this);if(!s.lastItem){t.hide();return}v=this._getMinimumSizeFromElements()}}else{if(s.lastItem&&s.nbElements===1&&v+s.completeSize-this._ddmButtonSize<=w){t.hide();if(s.separator){this.addToToolbar(s.separator)}this.addToToolbar(s.lastItem)}else{if(!s.lastItem&&t&&!t.isHidden()){t.hide()}}}}}}function j(y,u){function v(z){var A;if(u.toolbarProperties&&u.toolbarProperties.margin){A=u.toolbarProperties.margin[z]}else{A=window.getComputedStyle(u).getPropertyValue("margin-"+z)}return A?parseFloat(A):0}var x=false,w;if(u.isHidden()){u.show();x=true}var t=u.toolbarProperties;var s=t&&t.size?t.size:u.getSize();if(y==="vertical"){w=s.height+v("top")+v("bottom")}else{w=s.width+v("right")+v("left")}if(x){u.hide()}return w}return a});define("DS/Controls/Loader",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","i18n!DS/Controls/assets/nls/translation","DS/Controls/ProgressBar","DS/Controls/Button","DS/Utilities/Utils"],function(e,j,f,h,c,l,k,g,i){var b=f.inherit({name:"loader",publishedProperties:{fadeDuration:{defaultValue:1000,type:"number",category:"Appearance"},text:{defaultValue:"",type:"string",category:"Appearance"},showButtonFlag:{defaultValue:false,type:"boolean",category:"Appearance"},height:{defaultValue:60,type:"number",category:"Appearance"},allowUnsafeHTMLText:{defaultValue:undefined,type:"boolean",category:"Behavior"}},_loaderClass:"wux-controls-loader",buildView:function(){this._modelEvents=new c();this.elements.container.addClassName(this._loaderClass+" wux-font-3dsregular");this.elements.progressBar=new k({shape:"circular",infiniteFlag:true,statusFlag:false}).inject(this.elements.container);this.elements.label=e.Element("span",{"class":this._loaderClass+"-label"}).inject(this.elements.container);this.elements.stopButton=new g({label:l.cancel,emphasize:"primary"}).inject(this.elements.container);this.hide();this._loaderCounter=0;this._loaderMessages=[]},handleEvents:function(){var m=this;this.elements.stopButton.addEventListener("buttonclick",function(n){d.call(m);this._loaderCounter=0})},_applyRecId:function(m){this.elements.stopButton.recId=this.recId},_applyHeight:function(m){this.elements.progressBar.height=this.height;if(m!==this.height){this.fire("dimensionsChanged")}},_applyProperties:function(m){this._parent(m);if(this.isDirty("allowUnsafeHTMLText")||this.isDirty("text")){this._applyText(m.text)}this._applyShowButtonFlag()},process:function(){a.call(this)},on:function(m){this._loaderCounter++;if(m){this._loaderMessages.push(m);this.text=m}if(this._loaderCounter===1){a.call(this)}this.elements.container.show()},update:function(m){if(m){m=m.replace("%","");this.elements.progressBar.value=m;this.elements.progressBar.statusFlag=true}else{this.elements.progressBar.value=this.elements.progressBar.publishedProperties.value.defaultValue;this.elements.progressBar.statusFlag=false}},off:function(m){if(this._loaderCounter<=0){return}this._loaderCounter--;if(m){var n=this._loaderMessages.indexOf(m);if(n!==-1){this._loaderMessages.splice(n,1);if(this._loaderMessages.length>0){this.text=this._loaderMessages[this._loaderMessages.length-1]}else{this.text=""}}}if(this._loaderCounter===0){d.call(this);if(this._loaderMessages.length>0){this._loaderMessages=[]}}},_applyText:function(){if(i.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLText)){this.elements.label.setContent(this.text)}else{this.elements.label.textContent=this.text}},_applyAllowUnsafeHTMLText:function(){this._applyText(this.text)},_applyShowButtonFlag:function(){if(this.showButtonFlag){this.elements.stopButton.show()}else{this.elements.stopButton.hide()}}});var d=function(){var n=this;n.hide();var m=new e.Fx(n.elements.container,{duration:n.fadeDuration,transition:"linear",events:{onStart:function(){},onComplete:function(){if(n.showButtonFlag){n.elements.stopButton.remove()}n._modelEvents.publish({event:"END",context:n})}}});m.start({opacity:[1,0]});n._loaderCounter=0};var a=function(){var n=this;n.show();var m=new e.Fx(n.elements.container,{duration:n.fadeDuration,transition:"linear",events:{onStart:function(){if(n.showButtonFlag){n.elements.stopButton.inject(n.elements.container)}},onComplete:function(){n._modelEvents.publish({event:"START",context:n})}}});m.start({opacity:[0,1]})};return b});define("DS/UIBehaviors/Draggable",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","UWA/Class","DS/UIBehaviors/DragAndDropManager","UWA/Controls/Abstract"],function(d,i,f,c,b,a,e){var g=false;var h=e.extend({defaultOptions:{scope:"",helper:null,onDragStart:null,onDrop:null,onDrag:null,onDragStop:null,onDragOver:null,dataTransfer:{type:"Text",data:null},data:null},init:function(l,k,j){this._parent(j);this._uiTarget=k;this._objectTarget=l;if(j){this._from=j.from||l;this._data=j.data;this.updateDataToBeTransferred({from:j.from||l,data:j.data});this._dataTransfer=this.options.dataTransfer}this.enable()},_toggleBehaviors:function(j){if(this._uiTarget){if(j){j="true"}else{j="false"}this._uiTarget.setAttribute("draggable",j)}},_attachBehavior:function(j,k){if(this._uiTarget){this._uiTarget.addEventListener(j,k)}},_dettachBehavior:function(j){if(this._uiTarget){this._uiTarget.removeEventListener(j)}},updateDataToBeTransferred:function(j){this._dataToBeTransferred=j},getTransferredData:function(){return this._dataToBeTransferred},addDataTransfer:function(j,k){},enable:function(){this._toggleBehaviors(true);var j=this;if(!this.options.helper){this.options.helper=this._uiTarget}this._uiTarget.addEventListener("dragstart",function(m){if(g){console.warn("DRAG",j.getTransferredData())}if(j._dataTransfer){var l=j.getTransferredData();var k=a.storeData(l,j._uiTarget);if(g){console.warn("DRAGGED DATA",l)}a.storeGlobalData(l);m.dataTransfer.setData(j._dataTransfer.type,k)}else{alert()}if(j.options.onDragStart){j.options.onDragStart.call(m,m,j.options.helper,j._uiTarget)}},true);this._attachBehavior("drag",function(k){if(j.options.onDrag){j.options.onDrag.call(k,k,j.options.helper)}});this._attachBehavior("drop",function(k){if(j.options.onDrop){j.options.onDrop.call(k,k,j.options.helper,j._objectTarget)}});this._attachBehavior("dragend",function(k){if(j.options.onDrag){j.options.onDragStop.call(k,k,j.options.helper)}})},disable:function(){this._toggleBehaviors(false)}});return h});define("DS/UIBehaviors/Droppable",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","UWA/Class","DS/UIBehaviors/DragAndDropManager"],function(g,b,f,a,c,d){var e=c.extend({defaultOptions:{scope:"",dataTransfer:{type:"Text"},onDragLeave:null,onDragOver:null},init:function(j,i,h){this.options=g.extend(this.defaultOptions,h);this._parent(h);this._uiTarget=i;this._objectTarget=j;this.enable()},_attachBehavior:function(h,i){if(this._uiTarget){this._uiTarget.addEventListener(h,i)}},_dettachBehavior:function(h){if(this._uiTarget){this._uiTarget.removeEventListener(h)}},enable:function(){var h=this;this._attachBehavior("dragover",function(i){i.preventDefault()});this._attachBehavior("dragover",function(i){if(h.options.onDragOver){h.options.onDragOver.call(h._objectTarget,i,h._uiTarget)}});this._attachBehavior("dragenter",function(i){if(h.options.onDragEnter){h.options.onDragEnter.call(h._objectTarget,i,h._uiTarget)}});this._attachBehavior("dragleave",function(i){if(h.options.onDragLeave){h.options.onDragLeave.call(h._objectTarget,i,h._uiTarget)}});this._attachBehavior("drop",function(k){k.preventDefault();k.stopPropagation();var i=k.dataTransfer.getData(h.options.dataTransfer.type);var j=d.getDataFromToken(i);d.removeGlobalData();if(h.options.drop){h.options.drop.call(h._objectTarget,k,h._uiTarget,j)}})},disable:function(){this._toggleBehaviors(false)}});return g.namespace("UIBehaviors/Droppable",e)});define("DS/Developer/HistoryManager",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Class","DS/CoreEvents/ModelEvents"],function(g,a,f,e,b,d){var c=b.singleton({init:function(h){this._parent();this._modelEvents=new d();var j=window.parent||window;var i=this;j.onpopstate=function(k){i._modelEvents.publish({event:"STATE_CHANGE",data:k})}},newState:function(j,i){var h={pid:0,p:null};j=g.extend(h,j);var m=window.parent||window;var k="";for(var l in j){if(j[l]!==null){k=k+l+"/"+j[l]+"/"}}m.history.pushState(j,undefined,"#!/"+k);if(i){m.onpopstate.call(m,{state:j})}},onChange:function(h){this._modelEvents.subscribe({event:"STATE_CHANGE"},function(i){h(i)})},loadFromHash:function(){var o=window.parent||window;var m=o.location.hash.substring(3);var n=m.split("/");var j={};var h=(n.length%2)===0?n.length:(n.length-1);for(var k=0;k<h;k++){if(k%2!==0){j[n[k-1]]=n[k]}}c.newState(j,true)},getCurrentState:function(){var h=window.parent||window;return h.history.state}});return c});define("DS/Developer/Portal",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/Developer/HistoryManager"],function(c,g,a,f,d,b,k){var e=80;var j=40;var i="0s";window._flagFrameIsLoaded=[];var h=function(m){if(m.indexOf("http://")===0||m.indexOf("https://")===0){return m}else{return b.getWebappsBaseUrl()+m}};var l=d.extend({defaultOptions:{title:"Web<b>UX</b> for Developers",menu:[]},init:function(m){this._parent(m);this._buildLayout();var n=this;k.onChange(function(o){if(o.state){n.goToPageID(o.state.pid,false)}});this._buildMenu();setTimeout(function(){var o=k.getCurrentState();if(o){n.goToPageID(o.pid,false)}else{n.goToPageID(0,false)}n.elements.selection.show()},500)},_buildLayout:function(){this.elements.container=new c.Element("div",{"class":"wux-welcome"});this.elements.top=new c.Element("div",{"class":"wux-welcome-top",html:this.options.title,styles:{height:e,lineHeight:e+"px"}}).inject(this.elements.container);this.elements.menu=new c.Element("div",{"class":"wux-welcome-menu",styles:{height:j-1,transition:"all "+i+" ease-in-out",lineHeight:j+"px"}}).inject(this.elements.container);this.elements.contentView=new c.Element("div",{"class":"wux-welcome-content-view",styles:{top:j+e+2}}).inject(this.elements.container);this.elements.contentViewContainer=new c.Element("div",{"class":"wux-welcome-content-view-container",styles:{transition:"all "+i+" ease-in-out"}}).inject(this.elements.contentView);this.elements.credits=new c.Element("div",{html:this.options.credits,"class":"wux-welcome-credits"}).inject(this.elements.container)},_buildMenu:function(){var m=this;this._lastSelectedContentIndex=null;this._selectedContentIndex=0;this.elements.selection=new c.Element("div",{"class":"wux-welcome-menu-item-selection",styles:{transition:"all "+i+" ease-in-out"}}).inject(this.elements.menu).hide();this.elements.menuItems=[];this.options.menu.forEach(function(s,p){m.elements.menuItems.push(new c.Element("div",{html:s.title,"class":"wux-welcome-menu-item",styles:{transition:"all "+i+" ease-in-out"},events:{click:function(t){m.goToPageID(p)}}}));m.elements.menuItems[p].inject(m.elements.menu);var r;if(typeof s.content==="string"){r=new c.Element("iframe",{src:h(s.content),frameborder:0,onload:"window._flagFrameIsLoaded["+p+"]=true",styles:{width:"100%",position:"absolute",top:0,bottom:0,height:"100%"}});var n=0;var o=window.setInterval(function(){n++;if(n>20){window.clearInterval(o);if(s.contentError){r.src=h(s.contentError)}}},100)}else{r=s.content;if(r&&r.setStyles){r.setStyles({padding:40})}}var q=new c.Element("div",{html:r,"class":"wux-welcome-page",styles:s.styles});q.inject(m.elements.contentViewContainer)})},goToPageID:function(n,m){if(m===undefined){m=true}var o=this;o._lastSelectedContentIndex=o._selectedContentIndex;o._selectedContentIndex=n;if(o._lastSelectedContentIndex!==null&&o.elements.menuItems[o._lastSelectedContentIndex]){o.elements.menuItems[o._lastSelectedContentIndex].removeClassName("wux-ui-state-active")}var p=o.elements.menuItems[n];var q=(-n*100)+"%";o.elements.contentViewContainer.setStyles({transform:"translate3d("+q+", 0, 0)"});o.elements.selection.setStyles({transform:"translate3d("+p.getPosition().x+"px, "+p.getPosition().y+"px, 0)",backgroundColor:o.options.menu[n].bgColor||"#3CF",height:p.getDimensions().height,width:p.getDimensions().width});o.elements.menu.setStyles({borderBottom:"2px solid "+(o.options.menu[n].bgColor||"#3CF")});p.addClassName("wux-ui-state-active");if(m){k.newState({p:encodeURIComponent(o.options.menu[n].title),pid:n})}}});return l});define("DS/UIBehaviors/SwipeableMenu",["UWA/Core","DS/Core/Core","UWA/Controls/Abstract","DS/Core/PointerEvents"],function(g,d,f,c){var e=["webkit","moz","MS","o",""];function b(h,i,k){for(var j=0;j<e.length;j++){if(!e[j]){i=i.toLowerCase()}h.addEventListener(e[j]+i,k,false)}}var a=f.extend({defaultOptions:{target:null,menu:[],menuItemWidth:60},init:function(h){this._parent(h);this._isOpen=false;this._buildView();var i=this;this.options.menu.reverse().forEach(function(k,j){i._addMenuItem(k,j)});this._listenEvents();this._indexPositions(true);this.close()},_buildView:function(){this.elements.container=new g.Element("div",{"class":"wux-swipeablemenu",styles:{overflow:"hidden"}});this.elements.layersContainer=new g.Element("ul",{"class":"wux-ui-stack-h",styles:{position:"relative"}}).inject(this.elements.container);this.elements.layers=[];this.elements.cover=new g.Element("li",{"class":"",styles:{position:"relative",display:"block",width:this.options.target.getStyle("width"),height:this.options.target.getStyle("height"),zIndex:this.options.menu.length+1}}).inject(this.elements.layersContainer);this.options.target.inject(this.elements.cover)},_indexPositions:function(h){this._listOfMenuPositionAtBegin=[];this._listOfMenuPositionAtEnd=[];var l=0;for(var j=0;j<this.options.menu.length;j++){var k=this.options.menuItemWidth;this._listOfMenuPositionAtBegin[j]=-k;if(!h){this.elements.layers[j].setStyles({width:k,right:this._listOfMenuPositionAtBegin[j]})}l=k*(j+1);this._listOfMenuPositionAtEnd[j]=l;this._endPosition=l}return l},_listenEvents:function(){var n=this;var q,k;n._isPressed=false;var l;var o=this.options.menu.length;var j=false;function i(r){j=false;n._isPressed=true;l=n._indexPositions();q={x:r.clientX,y:r.clientY};n.elements.cover.setStyles({transition:"none",});n.options.menu.forEach(function(t,s){n.elements.layers[s].setStyles({transition:"none",})})}function m(r){if(n._isPressed&&n.options.menu.length>0){k={x:r.clientX-q.x,y:r.clientY-q.y};if(n.elements.cover.getPosition().x<20){if(Math.abs(k.x)>10&&-k.x<l){n.elements.cover.setStyles({transform:"translate3d("+k.x+"px, 0,0)"});n.options.menu.forEach(function(v,t){var u=n.options.menuItemWidth;var s=Math.abs(k.x)/o*(t+1)-u;if(s<n._listOfMenuPositionAtEnd[t]){n.elements.layers[t].setStyles({right:s})}})}else{if(-k.x>=l){j=true;n.open()}}}else{h()}}}function h(r){n._isPressed=false;n._indexPositions(true);if(!j&&n._listOfMenuPositionAtBegin){n.close();n.options.menu.forEach(function(t,s){n.elements.layers[s].setStyles({transition:"all ease-in-out 0.2s",right:n._listOfMenuPositionAtBegin[s]})})}}var p=g.extendElement(document);this.elements.cover.addEvent(c.POINTERDOWN,i);p.addEvent(c.POINTERMOVE,m);p.addEvent(c.POINTERUP,h)},open:function(){var i=this;this.elements.cover.addEventListener("animationend",function(){console.log("--",i.elements.cover.getOffset())},false);b(this.elements.cover,"animationIteration",function(){console.log("--",i.elements.cover.getOffset())});this.elements.cover.setStyles({transition:"all ease-in-out 0.2s",transform:"translate3d("+-this._endPosition+"px, 0,0)"});var h={x:-this._endPosition};var j=this.options.menu.length;i.options.menu.forEach(function(n,l){var m=i.options.menuItemWidth;var k=Math.abs(h.x)/j*(l+1)-m;if(k<i._listOfMenuPositionAtEnd[l]){i.elements.layers[l].setStyles({right:k})}});this._isOpen=true},close:function(){var h=this;h._isPressed=false;h.elements.cover.setStyles({transition:"all ease-in-out 0.2s",transform:"translate3d(0, 0,0)"});this._isOpen=false},toggle:function(){if(this._isOpen){this.close()}else{if(this.options.menu.length>0){this.open()}}},_addMenuItem:function(i,h){var k=this;var j=g.extend({position:"absolute",padding:"0 10px",top:0,bottom:0,right:0,boxSizing:"border-box",lineHeight:this.options.target.getStyle("height"),background:i.styles.backgroundColor},i.styles);this.elements.layers[h]=new g.Element("li",{html:i.label,"class":"",styles:j}).inject(this.elements.layersContainer);this.elements.layers[h].addEvent(c.POINTERUP,function(){k.elements.cover.setStyles({transition:"all ease-in-out 0.2s",transform:"translate3d(0, 0,0)"});if(i.callback){i.callback.call(this)}})}});return a});define("DS/Controls/TimeChooser",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom"],function(g,b,i,h,l,c,a){function f(m){if(Object.prototype.toString.call(m)!=="[object Date]"){return false}return !isNaN(m.getTime())}function e(){var m=this;this._arrowsInfo=[{name:"hoursUp",container:this.elements.topRow,onClick:function(n){m._setHours(m.value.getHours()+m.hoursStep,"clickOnHoursUp")},upFlag:true},{name:"minutesUp",container:this.elements.topRow,onClick:function(n){m._setMinutes(m.value.getMinutes()+m.minutesStep,"clickOnMinutesUp")},upFlag:true},{name:"secondsUp",container:this.elements.topRow,onClick:function(n){m._setSeconds(m.value.getSeconds()+m.secondsStep,"clickOnSecondsUp")},upFlag:true,secondsFlag:true},{name:"amPmUp",container:this.elements.topRow,onClick:function(n){m._setHours(m.value.getHours()+12,"clickOnAmPmUp")},upFlag:true,amPmFlag:true},{name:"hoursDown",container:this.elements.bottomRow,onClick:function(n){m._setHours(m.value.getHours()-m.hoursStep,"clickOnHoursDown")},upFlag:false},{name:"minutesDown",container:this.elements.bottomRow,onClick:function(n){m._setMinutes(m.value.getMinutes()-m.minutesStep,"clickOnMinutesDown")},upFlag:false},{name:"secondsDown",container:this.elements.bottomRow,onClick:function(n){m._setSeconds(m.value.getSeconds()-m.secondsStep,"clickOnSecondsDown")},upFlag:false,secondsFlag:true},{name:"amPmDown",container:this.elements.bottomRow,onClick:function(n){m._setHours(m.value.getHours()-12,"clickOnAmPmDown")},upFlag:false,amPmFlag:true}];this._arrowsDiv=[];this._arrowsInfo.forEach(function(p){var o="wux-controls-timechooser-arrow wux-ui-3ds";if(p.secondsFlag){o+=" wux-controls-timechooser-seconds"}else{if(p.amPmFlag){o+="  wux-controls-timechooser-ampm"}}if(p.upFlag){o+=" wux-ui-3ds-expand-up"}else{o+=" wux-ui-3ds-expand-down"}var n=new g.Element("button",{"class":o});m._arrowsDiv.push(n);n.inject(p.container)})}function k(){var m=this;this._inputsInfo=[{name:"hours",minValue:0,maxValue:23,onChange:function(n){m._setHours(n,"input_hours")}},{name:"minutes",minValue:0,maxValue:59,onChange:function(n){m._setMinutes(n,"input_minutes")}},{name:"seconds",minValue:0,maxValue:59,onChange:function(n){m._setSeconds(n,"input_seconds")},secondsFlag:true}];this._inputsDiv=[];this._inputsInfo.forEach(function(o){var n="wux-controls-timechooser-input";if(o.secondsFlag){n+=" wux-controls-timechooser-seconds"}m._inputsDiv.push(new g.Element("input",{"class":n}))});this._inputsDiv[0].inject(this.elements.inputsRow);this._inputsDiv[1].inject(this.elements.inputsRow);this._inputsDiv[2].inject(this.elements.inputsRow);this._amPmDiv=new g.Element("div",{html:"AM","class":"wux-controls-timechooser-ampm"}).inject(this.elements.inputsRow)}function d(){if(this.value){var n=this.value.getHours();if(this.mode==="12"){if(n>=12){if(n>=13){this._inputsDiv[0].value=n-12}else{this._inputsDiv[0].value=n}this._amPmDiv.textContent="PM"}else{if(n===0){this._inputsDiv[0].value=12}else{this._inputsDiv[0].value=n}this._amPmDiv.textContent="AM"}}else{this._inputsDiv[0].value=n}var m=this.value.getMinutes(),o=this.value.getSeconds();this._inputsDiv[1].value=(m<10?"0":"")+m;this._inputsDiv[2].value=(o<10?"0":"")+o}else{this._inputsDiv[0].value="";this._inputsDiv[1].value="";this._inputsDiv[2].value=""}}var j=i.inherit({name:"timeChooser",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-timechooser");this.elements.container.setAttribute("tabindex",0);this.elements.topRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-top-row"}).inject(this.elements.container);this.elements.inputsRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-inputs-row"}).inject(this.elements.container);k.call(this);this.elements.bottomRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-bottom-row"}).inject(this.elements.container);e.call(this);this.value=new Date()},handleEvents:function(){var m=this;this._arrowsDiv.forEach(function(o,n){a.addEventOnElement(m,o,"click",function(p){m._arrowsInfo[n].onClick.call(m)});a.addEventOnElement(m,o,"focus",function(p){this.blur();m.elements.container.focus()})});this._inputsDiv.forEach(function(n,o){a.addEventOnElement(m,n,"change",function(r){var p=parseInt(this.value);var q=m._inputsInfo[o];if((p>=q.minValue)&&(p<=q.maxValue)){q.onChange.call(m,p)}else{d.call(m)}})})},_applyMode:function(m){if(this.mode==="24"){this.getContent().setAttribute("mode","24")}else{this.getContent().setAttribute("mode","12")}d.call(this)},_preEditValue:function(m,n){if(!n){return true}if(typeof n==="string"){this.value=new Date(Date.parse(n));return false}else{if(n instanceof Date){if(g.equals(m,n)){return false}if(!f.call(this,n)){return false}return true}}return false},_applyValue:function(m){d.call(this);this.fire("change")},_applyPrecision:function(m){if(this.precision==="min"){this.getContent().setAttribute("precision","min")}else{this.getContent().setAttribute("precision","sec")}},_applyDisabled:function(m){this._parent();if(this.disabled){this._arrowsDiv.forEach(function(n){n.setAttributeNode(document.createAttribute("disabled"))});this._inputsDiv.forEach(function(n){n.setAttributeNode(document.createAttribute("disabled"))})}else{this._arrowsDiv.forEach(function(n){n.removeAttribute("disabled")});this._inputsDiv.forEach(function(n){n.removeAttribute("disabled")})}},setHours:function(m){this._setHours(m)},_setHours:function(m){if(this.value){var n=new Date(this.value);n.setHours(m);this.setPropertyFromUIInteraction("value",n)}},setMinutes:function(m){this._setMinutes(m)},_setMinutes:function(m){if(this.value){var n=new Date(this.value);n.setMinutes(m);this.setPropertyFromUIInteraction("value",n)}},setSeconds:function(m){this._setSeconds(m)},_setSeconds:function(m){if(this.value){var n=new Date(this.value);n.setSeconds(m);this.setPropertyFromUIInteraction("value",n)}},incrementAmPm:function(){this.setHours(this.value.getHours()+12)},decrementAmPm:function(){this.setHours(this.value.getHours()-12)},incrementHours:function(){this.setHours(this.value.getHours()+this.hoursStep)},decrementHours:function(){this.setHours(this.value.getHours()-this.hoursStep)},incrementMinutes:function(){this.setMinutes(this.value.getMinutes()+this.minutesStep)},decrementMinutes:function(){this.setMinutes(this.value.getMinutes()-this.minutesStep)},incrementSeconds:function(){this.setSeconds(this.value.getSeconds()+this.secondsStep)},decrementSeconds:function(){this.setSeconds(this.value.getSeconds()-this.secondsStep)},_applyProperties:function(m){this._parent(m);if(this.isDirty("mode")){this._applyMode(m.mode)}if(this.isDirty("value")){this._applyValue(m.value)}if(this.isDirty("precision")){this._applyPrecision(m.precision)}}});c.register(j,"DS/ControlsRec/AbstractRec");return j});define("DS/Controls/TimePicker",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Core/Core","DS/Core/PointerEvents","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/Popup","DS/Controls/TimeChooser","DS/WebRecordEnabler/Adapter"],function(g,a,j,k,h,c,m,e,o,d){function f(p){if(Object.prototype.toString.call(p)!=="[object Date]"){return false}return !isNaN(p.getTime())}function b(r,q){if(!f.call(this,r)||!f.call(this,q)){return false}var p={hour:"2-digit",minute:"2-digit"};if(this.precision==="sec"){p.second="2-digit"}return r.toLocaleTimeString("en",p)===q.toLocaleTimeString("en",p)}function l(){if(this.value){var q={hour:"2-digit",minute:"2-digit"};if(this.precision==="sec"){q.second="2-digit"}var p="";if(this.mode==="12"){p="en-US"}else{if(this.mode==="24"){p="en-GB"}}if(p&&this.value.toLocaleTimeString){this.elements.inputField.value=this.value.toLocaleTimeString(p,q)}}else{this.elements.inputField.value=""}}var n=j.inherit({name:"timePicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",category:"Behavior"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true}},buildView:function(){this._parent();this.elements.container.addClassName("wux-controls-timepicker");this.elements.inputField=new c({sizeInCharNumber:20,selectAllOnFocus:true}).inject(this.elements.container);this.elements.inputField.getContent().addClassName("wux-controls-timepicker-lineeditor");this.elements.timeChooserButton=new m({emphasize:"primary",icon:{iconName:"clock",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container);this.elements.timeChooserButton.getContent().addClassName("wux-controls-timepicker-button");i.call(this);this.value=new Date();this._onShowPopupValue=new Date()},handleEvents:function(){var p=this;a.addEventOnElement(this,this.elements.inputField,"change",function(r){r.stopPropagation();if(r.dsModel){if(r.dsModel.value){var q=new Date("2016/07/13 "+r.dsModel.value);if(q&&!isNaN(q.getTime())&&!b.call(p,q,p.value)){p.setPropertyFromUIInteraction("value",q)}l.call(p)}}})},getHours:function(){return this.value.getHours()},getMinutes:function(){return this.value.getMinutes()},_preEditValue:function(p,q){if(!q){return true}if(typeof q==="string"){this.value=new Date(Date.parse(q));return false}else{if(q instanceof Date){if(g.equals(p,q)){return false}return true}}},_applyValue:function(p){l.call(this);if(this.elements.popup&&this.elements.popup.visibleFlag){if(!b.call(this,this.elements.timeChooser.value,this.value)){this.elements.timeChooser.value=new Date(this.value)}this.fire("liveChange")}else{this.fire("change")}},_applyPrecision:function(p){if(this.precision!=="min"&&this.precision!=="sec"){this.precision=p;return}l.call(this);if(this.elements.timeChooser){this.elements.timeChooser.precision=this.precision}},_applyMode:function(p){l.call(this);if(this.elements.timeChooser){this.elements.timeChooser.mode=this.mode}},_applyHoursStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.hoursStep=this.hoursStep}},_applyMinutesStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.minutesStep=this.minutesStep}},_applySecondsStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.secondsStep=this.secondsStep}},_applyDisabled:function(p){this._parent();this.elements.inputField.disabled=this.disabled;this.elements.timeChooserButton.disabled=this.disabled},_applyPopupVisibleFlag:function(p){if(this.popupVisibleFlag){this.elements.popup.visibleFlag=true}else{this.elements.popup.visibleFlag=false}},_applyTouchMode:function(){this._parent();if(this.elements.timeChooserButton){this.elements.timeChooserButton.touchMode=this.touchMode}if(this.elements.inputField){this.elements.inputField.touchMode=this.touchMode}},_applyProperties:function(p){this._parent(p);if(this.isDirty("hoursStep")){this._applyHoursStep(p.hoursStep)}if(this.isDirty("minutesStep")){this._applyMinutesStep(p.minutesStep)}if(this.isDirty("secondsStep")){this._applySecondsStep(p.secondsStep)}if(this.isDirty("mode")){this._applyMode(p.mode)}if(this.isDirty("precision")){this._applyPrecision(p.precision)}if(this.isDirty("value")){this._applyValue(p.value)}}});function i(){var p=this;var q={target:this.elements.timeChooserButton.getContent(),position:"bottom",trigger:"click",constraint:"screen"};q.offset={x:-115,y:4};this.elements.popup=new e(q);this.elements.popup.addEventListener("hide",function(r){p.popupVisibleFlag=false;if(p.value&&!b.call(p,p.value,p._onShowPopupValue)){p.fire("change")}r.stopPropagation();p.fire("hide")});this.elements.popup.addEventListener("show",function(r){p.popupVisibleFlag=true;if(!p.elements.popup.getBody()){p.elements.timeChooser=new o({value:p.value,hoursStep:p.hoursStep,minutesStep:p.minutesStep,secondsStep:p.secondsStep,mode:p.mode,precision:p.precision});p.elements.timeChooser.addEventListener("change",function(s){s.stopPropagation();if(s.dsModel&&s.dsModel.value){if(!b.call(p,p.value,p.elements.timeChooser.value)){p.value=new Date(s.dsModel.value)}l.call(p)}});p.elements.popup.setBody(p.elements.timeChooser)}p._onShowPopupValue=new Date(p.value);if(p.value&&!b.call(p,p.value,p.elements.timeChooser.value)){p.elements.timeChooser.value=new Date(p.value)}r.stopPropagation();p.fire("show")})}d.register(n,"DS/ControlsRec/AbstractRec");return n});define("DS/Controls/Editor",["UWA/Core","DS/Controls/AbstractEditor","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom"],function(f,d,c,e,a){var b=d.inherit({name:"editor",markForRecordFlag:true,publishedProperties:{widthInCharNumber:{defaultValue:20,type:"integer",category:"Appearance"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"},nbRows:{defaultValue:2,type:"integer",category:"Appearance"},newLineMode:{defaultValue:"shiftEnter",type:"string",category:"Behavior"},autoCommitFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true,category:"Behavior"}},keymaps:{up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},"shift+return":{keydown:"consume",keyup:"preventDefaultAndConsume"},"return":{keydown:"validateValue",keyup:"preventDefault"}},commands:{consume:function(){return{stopPropagation:true}},validateValue:function(){var g=this.commitCurrentEntry();return{preventDefault:true,stopPropagation:false,infos:{actionPerformed:g}}},preventDefault:function(){return{preventDefault:true,stopPropagation:false}},preventDefaultAndConsume:function(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-editor");this._myInput=new f.Element("textarea",{type:"text"});this._myInput.addClassName("wux-ui-state-"+this.options.type);this._myInput.inject(this.elements.container);this._validFlag=true},handleEvents:function(){var g,i;var h=this;a.addEventOnElement(this,this._myInput,"change",function(j){j.stopPropagation()});a.addEventOnElement(this,this._myInput,"input",function(j){j.stopPropagation();if(h.autoCommitFlag){h.setPropertyFromUIInteraction("value",h._myInput.value)}else{h.setPropertyFromUIInteraction("valueToCommit",h._myInput.value)}});a.addEventOnElement(this,this._myInput,"blur",function(j){h.callMethodFromUIInteraction("commitCurrentEntry");j.preventDefault();h.fire("blur")})},_applyNewLineMode:function(){if(this.newLineMode==="enter"){this._keymapManager.registerKeymap("return",this.name+":consume",this.name+":preventDefaultAndConsume");this._keymapManager.registerKeymap(["shift+return"],this.name+":validateValue",this.name+":preventDefault")}else{if(this.newLineMode==="shiftEnter"){this._keymapManager.registerKeymap("shift+return",this.name+":consume",this.name+":preventDefaultAndConsume");this._keymapManager.registerKeymap(["return"],this.name+":validateValue",this.name+":preventDefault")}else{delete this._keymapManager._keymap["return"];delete this._keymapManager._keymap["shift+return"]}}},_applyMaxLength:function(){if(this.maxLength>0){this._myInput.setAttribute("maxlength",this.maxLength)}else{this._myInput.removeAttribute("maxlength")}},_applyWidthInCharNumber:function(){this._myInput.setAttribute("cols",this.widthInCharNumber)},_applyNbRows:function(g){if(this.nbRows>1){this._myInput.setAttribute("rows",this.nbRows)}else{this._myInput.removeAttribute("rows")}if(g!==this.nbRows){this.fire("dimensionsChanged")}},_applyProperties:function(g){this._parent(g);this._applyPlaceholder();this._applyWidthInCharNumber();this._applyNbRows();this._applyMaxLength();this._applyNewLineMode();this._realApplyRequiredFlag();if(this.isDirty("value")){this._applyValue(g.value,this.value);this.fire("change")}this._updateValidFlag()}});e.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/TileView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/UIBehaviors/SwipeableMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(b,f,a,g,i,e,h,d){var c=g.extend({defaultOptions:{size:"small",view:"tile",picture:{size:"cover",width:null,position:"center center"}},init:function(k){this._parent(k);this._isHighlighted=false;this.elements.container=new b.Element("div",{"class":"wux-controls-tileview wux-ui-size-"+this.options.size,styles:{padding:0}});this.elements.thumbnail=new b.Element("div",{"class":"wux-controls-tileview-container wux-ui-size-"+this.options.size,styles:{border:"none",margin:0}});var j=undefined;this.options.useSwipableMenu=true;if(k.gridEngine&&k.gridEngine.options.useSwipableMenu===false){this.options.useSwipableMenu=false;this.elements.thumbnail.inject(this.elements.container)}else{var j=new i({target:this.elements.thumbnail,menu:this.options.menu});j.getContent().setStyles({lineHeight:"60px",overflow:"visible"}).inject(this.elements.container)}this.elements.picture=new b.Element("div",{"class":"wux-controls-tileview-picture",styles:{backgroundImage:"",width:this.options.picture.width?this.options.picture.width:"",backgroundSize:this.options.picture.size,backgroundPosition:this.options.picture.position}}).inject(this.elements.thumbnail);this.elements.checkbox=new h({checkFlag:false,disabled:false}).inject(this.elements.picture);this.elements.checkbox.getContent().addClassName("wux-controls-tileview-checkbox wux-ui-size-"+this.options.size);var l=this;this.elements.container.addEvent("mouseenter",function(m){if(!l.isPreHighlighted){l.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted");l.isPreHighlighted=true}});this.elements.container.addEvent("mouseleave",function(m){if(l.isPreHighlighted){l.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted");l.isPreHighlighted=false}});this.elements.checkbox.addEventListener(e.POINTERDOWN,function(m){m.stopPropagation()});this.elements.checkbox.addEventListener(e.POINTERUP,function(m){m.stopPropagation()});this._listenToChanges=true;this.elements.checkbox.addEventListener("change",function(m){if(l._listenToChanges){if(!l.isHighlighted()){l.highlight()}else{l.unhighlight()}}});this.elements.cartouche=new b.Element("div",{"class":"wux-controls-tileview-cartouche",styles:{left:this.options.picture.width?this.options.picture.width:""}}).inject(this.elements.thumbnail);this.elements.cartoucheContent=new b.Element("div",{"class":"wux-controls-tileview-cartouche-content"}).inject(this.elements.cartouche);this.elements.icon=new b.Element("div",{"class":"wux-controls-tileview-icon wux-ui-size-"+this.options.size,styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent);this.elements.badgeTopRight=new b.Element("div",{"class":"wux-controls-tileview-badge-top-right"}).inject(this.elements.cartoucheContent);this.elements.badgeBottomRight=new b.Element("div",{"class":"wux-controls-tileview-badge-bottom-right"}).inject(this.elements.cartoucheContent);this.elements.color=new b.Element("div",{"class":"wux-controls-tileview-color"}).inject(this.elements.container);this.elements.colorBlank=new b.Element("div",{"class":"wux-controls-tileview-colorBlank"}).inject(this.elements.container);this.elements.title=new b.Element("div",{"class":"wux-controls-tileview-title wux-font-3dsregular"}).inject(this.elements.cartoucheContent);this.elements.subtitle=new b.Element("div",{"class":"wux-controls-tileview-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent);this.elements.menu=new b.Element("div",{"class":"wux-controls-tileview-menu wux-ui-size-"+this.options.size}).inject(this.elements.cartoucheContent);this.elements.menu.addClassName("wux-ui-3ds");this.elements.menu.addClassName("wux-ui-3ds-open-down");this.elements.description=new b.Element("div",{"class":"wux-controls-tileview-description",html:"Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the ..."}).inject(this.elements.cartoucheContent);this.elements.menu.addEvent(e.POINTERDOWN,function(n){n.preventDefault();var p=this;var m=p.cellView;if(m){var o=m.getCellInfos();if(o.cellModel&&o.cellModel.isSelected()){n.stopPropagation()}}if(l.options.useSwipableMenu===true){j._indexPositions()}});this.elements.menu.addEvent(e.POINTERUP,function(m){m.preventDefault();if(l.options.useSwipableMenu===true){j.toggle()}});this.setColor(this.options.color);this.setIcon(this.options.icon);this._attachEvents()},setIcon:function(j){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-tileview-icon wux-ui-size-"+this.options.size);if(j){this.elements.container.setAttribute("has-icon","true");this.elements.icon.setAttribute("has-icon","true");d.generateIcon(j,{target:this.elements.icon});this.elements.icon.show()}else{this.elements.container.setAttribute("has-icon","false");this.elements.icon.setAttribute("has-icon","false");this.elements.icon.hide()}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==true){this._listenToChanges=false;this.elements.checkbox.checkFlag=true;this._listenToChanges=true}},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==false){this._listenToChanges=false;this.elements.checkbox.checkFlag=false;this._listenToChanges=true}},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}});return c});define("DS/Controls/SmartInput",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Form","UWA/Controls/ToolTip","DS/Controls/Stack","DS/Controls/Knob","UWA/Controls/DatePicker","DS/Controls/Switch"],function(h,a,g){var c=g.extend({defaultOptions:{value:[0,0,0],labels:["x","y","z"],inputType:"number",onChange:null},init:function(i){this._parent(i);this._inputs=[];this._buildView();this.setValue(this.options.value);this._value=this.getValue()},setValue:function(j){var i=this;this._value=[];j.forEach(function(l,k){if(i._inputs[k]){i._inputs[k].setAttribute("value",l)}i._value.push(l)})},getValue:function(){this._value=[];var i=this;i._inputs.forEach(function(k,j){var l=k.value;i._value.push(l)});return this._value},_buildView:function(){this.elements.container=new h.Element("div",{"class":"wux-input-vector"});var i=this;this.options.value.forEach(function(m,l){var k=new h.Element("div",{"class":"wux-input-vector-label",styles:{textAlign:"right",display:"inline-block"}}).inject(i.elements.container);var n=i.options.labels[l];if(n){k.set({text:n+":",styles:{minWidth:40}})}var j=new h.Element("input",{type:i.options.inputType,styles:{width:50,height:14},events:{change:function(){if(i.options.onChange){i.options.onChange.call(i,i.getValue())}}}}).inject(i.elements.container);i._inputs.push(j)})}});var b=g.extend({defaultOptions:{value:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],onChange:null},init:function(i){this._parent(i);var k=this.options.value;var j=this;this._upVector=new c({labels:["up"],value:k[0],inputType:"text",onChange:function(){j._onChange()}});this._rightVector=new c({labels:["right"],value:k[1],inputType:"text",onChange:function(){j._onChange()}});this._dirVector=new c({labels:["dir"],value:k[2],inputType:"text",onChange:function(){j._onChange()}});this._posVector=new c({labels:["pos"],value:k[3],inputType:"text",onChange:function(){j._onChange()}});this._buildView()},_onChange:function(){console.log("-");if(this.options.onChange){this.options.onChange.call(this,this.getValue())}},setValue:function(i){this._value=[];this._upVector.setValue(i[0]);this._righVector.setValue(i[1]);this._dirVector.setValue(i[2]);this._posVector.setValue(i[3]);this._value.push(this._upVector.getValue());this._value.push(this._rightVector.getValue());this._value.push(this._dirVector.getValue());this._value.push(this._posVector.getValue())},getValue:function(){this._value=[];this._value.push(this._upVector.getValue());this._value.push(this._rightVector.getValue());this._value.push(this._dirVector.getValue());this._value.push(this._posVector.getValue());console.log(this._value);return this._value},_buildView:function(){this.elements.container=new h.Element("div",{"class":"wux-controls-matrix4x4"});this.elements.container.addContent(this._upVector).addContent(this._rightVector).addContent(this._dirVector).addContent(this._posVector)}});var e=g.extend({defaultOptions:{value:10,minValue:0,maxValue:100,stepValue:1,onChange:null},init:function(i){this._parent(i);this._value=this.options.value;this._buildView()},_buildView:function(){var i=this;this.elements.container=new h.Element("ul",{"class":"wux-input-distance"});var k=this.options.minValue.toString();if(this.options.minLabel){k=this.options.minLabel}this.elements.minValue=new h.Element("li",{html:k}).inject(this.elements.container);this.elements.inputRangeContainer=new h.Element("li",{}).inject(this.elements.container);this.elements.inputRange=new h.Element("input",{type:"range",min:this.options.minValue,max:this.options.maxValue,step:this.options.stepValue,events:{change:function(l){console.log("change");i._value=i.elements.inputRange.value;i.elements.valueContainer.setHTML(i._value);if(i.options.onChange){i.options.onChange.call(i,i._value)}i.dispatchEvent("onChange")}}}).inject(this.elements.inputRangeContainer);var j=this.options.maxValue.toString();if(this.options.maxLabel){j=this.options.maxLabel}this.elements.maxValue=new h.Element("li",{html:j}).inject(this.elements.container);this.elements.valueContainer=new h.Element("div",{html:this._value.toString(),styles:{color:"#444",minWidth:50,fontWeight:"bold",backgroundColor:"#FFF",borderRadius:5}}).inject(this.elements.container)}});function d(l){var j;var i;var k=l.name;switch(l.kind){case"text":i=50;j=new h.Controls.Form({fields:[{type:"text",name:k,label:l.label,value:l.value}]});break;case"combo":i=50;j=new h.Controls.Form({fields:[{type:"range",name:k,label:l.label,value:l.value,step:l.rules.stepValue,min:l.rules.minValue,max:l.rules.maxValue}]});break;case"switch":i=50;j=new WUX.Controls.Switch({value:l.value,label:l.label,onChange:l.onChange});break;case"translation":i=40;j=new c({value:l.value,labels:["Tx","Ty","Tz"],onChange:l.onChange});break;case"matrix4x4":i=40;var m={};if(l.value){m.value=l.value}m.onChange=l.onChange;j=new b(m);break;case"vector":i=40;j=new c({value:l.value,onChange:l.onChange});break;case"rotation":i=40;j=new c({value:l.value,labels:["Rx","Ry","Rz"],onChange:l.onChange});break;case"direction":i=40;j=new c({value:l.value,labelX:"up",labelY:"right",labelZ:"dir",onChange:l.onChange});break;case"angle":i=100;if(l.value===undefined){l.value=0}j=new WUX.Controls.Knob({graduationsLabel:true,value:l.value,minValue:0,maxValue:2*Math.PI,graduations:[{label:"0",value:0},{label:"&pi;/2",value:Math.PI/2},{label:"&pi;",value:Math.PI},{label:"3&pi;/2",value:3*Math.PI/2},{label:"2&pi;",value:2*Math.PI}],graduationsLabelColor:"black",activeGraduationsColor:"#3CF",inactiveGraduationsColor:"#CCC",knobIndicator:"line",knobMaterial:"pearl",onChange:l.onChange});break;case"intensity":if(l.value===undefined){l.value=0}i=100;j=new WUX.Controls.Knob({knobMaterial:"pearl",value:l.value,graduations:20,dynamicGraduations:true,minValue:l.rules.minValue,maxValue:l.rules.maxValue,onChange:l.onChange});break;case"systemColor":i=24;j=new h.Element("input",{type:"color",styles:{height:12,padding:0,margin:0,border:"none"},name:k,value:l.value});break;case"distance":i=50;j=new e({value:l.value,minValue:l.rules.minValue,maxValue:l.rules.maxValue,stepValue:l.rules.stepValue,onChange:l.onChange});break;case"number":i=50;j=new h.Element("input",{type:"number",min:l.rules.minValue,max:l.rules.maxValue,step:l.rules.stepValue,name:k,value:l.value});break;case"date":j=new h.Controls.DatePicker({type:"date",format:"%e %b %Y"});break;default:i=50;j=new h.Controls.Form({fields:[{type:l.kind,name:k,label:l.label,value:l.value}]});break}j.getHeight=function(){return i};return j}var f=g.extend({defaultOptions:{position:{parent:null,x:0,y:0},label:"Value",name:"smart_input",unit:"",kind:"string",value:undefined,inPlaceEdit:false,editEvent:"click",rules:{minLength:null,maxLength:null,minValue:null,maxValue:null,unit:null,dataType:null},onConfirm:null,onCancel:null,onChange:null},init:function(i){this._parent(i);console.warn("deprecated","Please DO NOT use anymore Controls/SmartInput, use SmartInputs/* instead")},buildView:function(){var m=this;this._smartInput=d(this.options);if(!this.options.inPlaceEdit){var l=new h.Element("button",{"class":"wux-smartinput-button wux-smartinput-button-valid",html:"V",events:{click:function(){m._onConfirm.call(m)}}});var n=new h.Element("button",{"class":"wux-smartinput-button wux-smartinput-button-cancel",html:"X",events:{click:function(){m._onCancel.call(m)}}});var k=this._smartInput.getHeight();var j=new WUX.Controls.Stack({styles:{height:k}});j.append(this._smartInput,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});j.append(l,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});j.append(n,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});var i;if(m.options.value){i=this.options.value.toString()+" "+this.options.unit}else{i=this._smartInput.getValue()}this.elements.container=new h.Element("div",{"class":"wux-smartinput",html:i});this._tooltip=new h.Controls.ToolTip(this.elements.container,j,{className:"wux-smartinput-tooltip",showOver:false,offsetX:10,offsetY:0});this.elements.container.addEvent(this.options.editEvent,function(p){h.extendElement(document).getElements(".wux-smartinput-tooltip").forEach(function(r){r.hide()});var o=m.elements.container.getOffsets();o.y+=20;m._tooltip.show();var q=m._tooltip.elements.tooltip;q.setStyle("position","fixed");q.show();q.setPosition(o);if(m.options.relativePosition){m._tooltip.elements.tooltip.inject(m.options.relativePosition)}})}else{this.elements.container=new h.Element("div",{"class":"wux-smartinput",html:this._smartInput})}},_onConfirm:function(){var i=this.getValue();this.elements.container.setHTML(i+" "+this.options.unit);if(this.options.onConfirm){this.options.onConfirm.call(this,{name:this.options.name,value:i})}this._tooltip.hide()},getValue:function(){var i;switch(this.options.kind){case"number":case"distance":i=this._smartInput._value;break;case"systemColor":i=this._smartInput.value;break;case"translation":case"rotation":case"angle":case"intensity":case"vector":case"matrix4x4":case"angle":i=this._smartInput.getValue().toString();break;case"switch":i=this._smartInput.getValue();break;case"date":i=this._smartInput.getDate().toString();console.log(i);break;default:i=this._smartInput.getFormValue(this.options.name);break}return i},_onCancel:function(){if(this.options.onCancel){this.options.onCancel.call(this)}this._tooltip.hide()},onConfirm:function(i){if(i){this.options.onConfirm=i}},onCancel:function(i){if(i){this.options.onCancel=i}}});return h.namespace("WUX/Controls/SmartInput",f)});define("DS/Controls/TreeNodeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Json","UWA/Utils","DS/Core/Core","DS/Utilities/Css3D","DS/Selection/HSOManager","DS/Controls/SmartInput","DS/UIBehaviors/Draggable","DS/UIBehaviors/Droppable","DS/Utilities/Object","DS/CoreEvents/ModelEvents","UWA/Utils/Client"],function(UWA,Event,Abstract,UWAJson,UWAUtils,WUX,WUXCss3d,HSOmanager,SmartInput,WUXDraggable,WUXDroppable,UtilsObject,ModelEvents,UWAClient){var FX_DURATION=200;var NAVIGATOR=UWAClient.Engine;var DEBUG=false;function wux_move(arrayToProcess,old_index,new_index){if(new_index>=arrayToProcess.length){var k=new_index-arrayToProcess.length;while((k--)+1){arrayToProcess.push(undefined)}}arrayToProcess.splice(new_index,0,arrayToProcess.splice(old_index,1)[0]);return arrayToProcess}function cleanArray(actual){var newArray=[];for(var i=0;i<actual.length;i++){if(actual[i]){newArray.push(actual[i])}}return newArray}var TreeNodeBase=Abstract.extend({defaultOptions:{expandAtInit:false,isFakeRoot:false,isRoot:false,isEditable:undefined,isDraggable:undefined,node:null,tree:null,animateOnExpand:false,onPreExpand:null,onPostExpand:null,onPreCollapse:null,onPostCollapse:null,UI:"default",rowIndex:null,data:null,renderSaver:100,allowTextCopy:false},init:function(options){this._parent(options);this.options=UWA.extend(this.options,options);this._uuid=UWA.Utils.getUUID();this._nodeDepth=-1;this._childrenSlots=[];this._children=(UWA.typeOf(this.options.children)==="array")?[]:null;this._childID=null;this._isExpanded=false;this._isInTreeListView=false;this._hasBeenAttached=false;this._rowIndex=null;this._isInWriteMode=false;this._updateViewTimeout=null;var me=this;this._modeIsExpandAll=false;this._modeIsMultiSel=false;if(UWA.typeOf(this.options.UI)==="string"){}this.buildSkeleton();if(this.options.isRoot){this._attachToView()}UWA.Element.addEvent.call(document,"keydown",function(event){var key=UWA.Event.whichKey(event);if(key==="ctrl"&&!me._modeIsMultiSel){me._modeIsMultiSel=true}});UWA.Element.addEvent.call(document,"keyup",function(event){var key=UWA.Event.whichKey(event);if(key==="ctrl"){me._modeIsMultiSel=false}})},delegateEvents:function(){WUX.warn("deprecated","don't use anymore the method delegateEvents on TreeNode")},getParent:function(){return this._parentNode},getRoot:function(){var root=this;while(root&&!root.options.isRoot){root=root.getParent()}return root},getPath:function(){var root=this;var path="";while(root&&!root.options.isRoot){if(root.elements.label&&root.elements.label.getText()){path=root.elements.label.getText()+" > "+path}root=root.getParent()}return path},isAscendantOf:function(node){var root=node;while(root&&!root.options.isRoot){root=root.getParent();if(root===this){return true}}return false},highlight:function(color){if(color===undefined){this.elements.label.addClassName("wux-datagrid-cell-highlighted")}else{this.elements.label.setStyles(color)}},unhighlight:function(){this.elements.label.removeClassName("wux-datagrid-cell-highlighted")},setLabel:function(label,notifyChange){if(notifyChange===undefined){notifyChange=true}this.options.label=label;if(this.isInWriteMode()){this.switchToWriteView()}else{this.switchToReadView()}var tree=this.getTree();if(tree&&notifyChange){tree._modelEvents.publish({context:this,event:"UPDATE_LABEL",data:label})}},getLabel:function(){return this.options.label},isInWriteMode:function(){return this._isInWriteMode},switchToWriteView:function(){var me=this;var model=this.options;var isEditableOptions=this.options.isEditable;if(isEditableOptions.switchToWriteView.callback===undefined){isEditableOptions.switchToWriteView.callback=function(e){this.switchToWriteView()}}var newValue=model.label;this.elements._readWriteContainer=isEditableOptions.switchToWriteView.view.call(this,this);this.elements._readWriteContainer.addEvent("change",function(e){newValue=this.value});var evts=isEditableOptions.switchToReadView.event.split(" ");evts.forEach(function(evt){me.elements._readWriteContainer.addEvent(evt,function(e){isEditableOptions.switchToReadView.callback.call(me,e,me);me._isInWriteMode=false;me.setLabel(newValue)})});this.elements.label.setContent(this.elements._readWriteContainer);this.elements._readWriteContainer.focus();this._isInWriteMode=true},switchToReadView:function(){var me=this;var isEditableOptions=this.options.isEditable;if(isEditableOptions&&isEditableOptions.switchToReadView&&isEditableOptions.switchToWriteView){if(isEditableOptions.switchToReadView.callback===undefined){isEditableOptions.switchToReadView.callback=function(e){this.switchToReadView()}}this.elements._readOnlyContainer=isEditableOptions.switchToReadView.view.call(this,this);var evts=isEditableOptions.switchToWriteView.event.split(" ");evts.forEach(function(evt){me.elements._readOnlyContainer.addEvent(evt,function(e){isEditableOptions.switchToWriteView.callback.call(me,e,me)})})}else{this.elements._readOnlyContainer=new UWA.Element("div",{html:this.options.label})}if(this.elements.label){this.elements.label.setContent(this.elements._readOnlyContainer)}this._isInWriteMode=false},addChild:function(child,index){if(!child.isAscendantOf(this)){if(child.getParent()===this){var oldIndex=this._children.indexOf(child);wux_move(this._children,oldIndex,index);this._children=cleanArray(this._children)}else{if(child.elements.container&&child.elements.container.parentNode){child.elements.container.parentNode.removeChild(child.elements.container)}if(child.getParent()){child.getParent().removeChild(child)}if(child.isExpanded()){child.collapse()}child.options.UI=this.options.UI;child.options.tree=this.options.tree;if(this.options.tree){this._onTreeAttach(index)}if(!this._children){this._children=[]}if(index!==undefined){this._children.splice(index,0,child);child._childID=this._children.length-1}else{child._childID=this._children.push(child)-1}}child._setParent(this);this._hasBeenAttached=true}else{console.warn("logical error","You tried to attach a node on one of its descendant, or on itself")}},addChildren:function(children,index){var me=this;this.children.forEach(function(child){me.addChild(child,index)})},_setParent:function(parentNode){this._parentNode=parentNode;if(parentNode){var uncles=parentNode.getNextBrothersNodes();if(uncles.length){uncles[0]._updateView(false)}parentNode._updateView(parentNode._isExpanded,parentNode._isExpanded)}this._inheritFromTree();if(this.getParent()&&this.getParent().getParent()){this.getParent().getParent()._updateView(false)}},_inheritFromTree:function(){if(this.options.isEditable===null||this.options.isEditable===undefined){var tree=this.getTree();if(tree){if(tree.options.isEditable){this.options.isEditable={};UWA.extend(this.options.isEditable,tree.options.isEditable,true)}}}},_unsetParent:function(){var oldParent=this.getParent();this._dettachFromView();var prevUncle=this.getPrevBrotherNode();var node=oldParent.getChildren().splice(this._childID,1)[0];if(prevUncle){prevUncle._updateView()}if(oldParent.getChildren().length===0&&oldParent._isExpanded){oldParent._isExpanded=false}if(oldParent){oldParent._updateView()}this._setParent(null);return node},_onTreeAttach:function(){this._buildExpander(false);var children=this.getChildren();if(children){children.forEach(function(child){child._onTreeAttach()})}},removeChild:function(child,setChildrenToNull){if(setChildrenToNull===undefined){setChildrenToNull=true}child.getContent().destroy();var indice=this._children.indexOf(child);if(indice!==-1){this._children.splice(indice,1)}if(this.getLastChild()){this.getLastChild()._buildExpander(false);this.getLastChild()._buildLink(true)}if(setChildrenToNull&&this.getChildren()&&this.getChildren().length===0){this._children=null}this._buildExpander(false);this._buildLink(true)},remove:function(){this.getParent().removeChild(this)},removeChildren:function(){var nChildren=this._children.length;for(var i=0;i<nChildren;i++){if(this._children[i]){this.removeChild(this._children[i])}}this._children=null;this.updateExpanderState()},buildSkeleton:function(test){if(this.elements.container&&this.elements.container.parentNode){this.elements.container.parentNode.removeChild(this.elements.container)}this.elements.container=new UWA.Element("li",{"class":"Container",styles:{position:"relative",overflow:"hidden",minHeight:16}});this._buildChildrenContainer()},updateExpanderState:function(){this._buildExpander(false)},_buildExpander:function(mustBeCreated){if(mustBeCreated===undefined){mustBeCreated=true}var me=this;var model=this.options;var uiTheme=model.UI;var shiftTop=(uiTheme.icon.size-(uiTheme.expander.size+2*uiTheme.expander.borderSize))/2;var shiftRight=0;if(this._children){switch(UWA.typeOf(this._children)){case"string":this._expandState="asyncState";this._nodeIsAsync=true;break;case"array":if(!this._isExpanded){this._expandState="expandState"}else{this._expandState="collapseState"}this._nodeIsAsync=false;break}}else{if(this.isRoot()){this._expandState="noExpandRoot"}else{this._expandState="noExpandState"}this._nodeIsAsync=false;shiftRight=(uiTheme.expander.size*uiTheme.expander.borderSize)/2;shiftTop=uiTheme.icon.size/2}var expanderTheme=this.options.UI[this._expandState];expanderTheme.styles.marginLeft=shiftRight;expanderTheme.styles.marginTop=shiftTop;if(mustBeCreated){if(model&&model.children){this.elements.container.setAttributes({"data-isExpanded":false})}this.elements.expander=new UWA.Element("li",expanderTheme);this.elements.expander.inject(this.elements.view);this.elements.expander.removeEvent("click");this.elements.expander.addEvent("click",function(event){if(!me._isExpanded){me.expand()}else{me.collapse()}})}else{if(this.elements.expander){this.elements.expander.set(this.options.UI[this._expandState]);if(this.options.UI.shadow){this.elements.expander.addClassName("Shadow")}}}},_isLastChild:function(){return this.getParent()&&((this.getParent().getChildren().indexOf(this)+1)===this.getParent().getChildren().length)},_buildLink:function(mustBeUpdated){if(!this.options.isRoot){var uiTheme=this.options.UI;if(mustBeUpdated===undefined){mustBeUpdated=false}var cssBottomProp="bottom";var cssBottomValue=-(uiTheme.layout.btMargin*2)+uiTheme.icon.size/2+"px";this._isLastChildFlag=this._isLastChild();if(this._isLastChild()){cssBottomProp="height";cssBottomValue=uiTheme.layout.btMargin*2+uiTheme.icon.size/2+uiTheme.link.size/2+"px"}var cssTopValue=-(Number(uiTheme.layout.btMargin))+"px";if(!mustBeUpdated){this.elements.verticalLink=new UWA.Element("li",{text:"","class":"Link"});this.elements.verticalLink.inject(this.elements.container)}if(this.elements.verticalLink){this.elements.verticalLink.setStyles({borderLeft:uiTheme.link.size+"px "+uiTheme.link.style+" "+uiTheme.link.color,top:cssTopValue,position:"absolute",left:this._marginLeft+uiTheme.expander.size/2});if(cssBottomProp==="bottom"){this.elements.verticalLink.setStyle("height","auto")}else{this.elements.verticalLink.setStyle("bottom","auto")}this.elements.verticalLink.setStyle(cssBottomProp,cssBottomValue)}}},_buildIcons:function(){var model=this.options;if(model&&model.icons){this.elements.icons=[];var nIcons=model.icons.length;for(var j=0;j<nIcons;j++){var ico=new UWA.Element("li",{"class":"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+model.icons[j]+")",backgroundSize:"100%"}});ico.inject(this.elements.view);this.elements.icons.push(ico)}}},setIcon:function(options){options=UWA.extend({picture:"",iconID:0},options);if(!this.elements.icons[options.iconID]){var ico=new UWA.Element("li",{"class":"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+options.picture+")",backgroundSize:"100%"}});ico.inject(this.elements.view);this.elements.icons[options.iconID](ico)}else{this.elements.icons[options.iconID].setStyles({marginLeft:this.options.UI.layout.lrMargin,background:"url("+options.picture+")",backgroundSize:"100%"})}},_buildLabel:function(){var model=this.options;var me=this;if(model.label){if(model.isRoot){this.options.UI.label.fontWeight="bold"}else{this.options.UI.label.fontWeight="normal"}this.elements.label=new UWA.Element("li",{"class":"wux-treenode-label",styles:this.options.UI.label});this.elements.label.setStyles(this.options.UI.label);if(this._isHighlighted){this.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"})}if(this.options.UI.shadow){this.elements.label.addClassName("Label Shadow")}this.elements.label.setStyles({backgroundColor:model.backgroundColor});this.elements.label.inject(this.elements.view);this.elements.label.addEvent("click",function(event){var tree=me.getTree();if(tree.options.onClick){tree.options.onClick.apply(me,me,me.options.data)}});this.elements.label.addEvent("click",function(event){var tree=me.getTree();if(tree){tree._modeIsMultiSel=event.ctrlKey;tree._modelEvents.publish({event:"click",data:me})}});this.elements.label.addEvent("dblclick",function(event){var tree=me.getTree();if(tree){tree._modelEvents.publish({event:"dblClick",data:me})}})}},getTree:function(){var rootNode=this.getRoot();if(rootNode){var tree=rootNode.options.tree;return tree}else{return this.options.tree}},buildNode:function(){var model=this.options;if(this.getParent()){this._nodeDepth=this.getParent()._nodeDepth+1}this.elements.container.setAttributes({"data-nodeDepth":this._nodeDepth});var rowClass;if(model.grid){rowClass="wux-tree-row"}if(model.isRoot){rowClass+=" wux-tree-headers"}this.elements.row=new UWA.Element("div",{"class":rowClass,styles:{display:"inline-block",whiteSpace:"pre",marginRight:14}});var uiTheme=this.options.UI;this._marginLeft=(this._nodeDepth)*(uiTheme.layout.lrMargin+(uiTheme.expander.size+uiTheme.expander.borderSize*2)*1+(uiTheme.icon.size-(uiTheme.expander.size+uiTheme.expander.borderSize*2))/2);this.elements.view=new UWA.Element("ul",{"class":"Node Horizontal",styles:{marginLeft:this._marginLeft+"px",position:"relative",display:"inline-block",zIndex:10,paddingTop:this.options.UI.layout.btMargin}});this._inheritFromTree();this._buildExpander();this._buildLink();this._buildIcons();this._buildLabel();this.elements.view.inject(this.elements.row);if(this._customizeNodeView){this._customizeNodeView()}this.elements.row.inject(this.elements.container,"top");if((this.options.expandAllAtInit&&this._nodeDepth>0)||this._nodeDepth===0){this.show()}else{this.hide()}this.setLabel(this.options.label,false)},_buildChildrenContainer:function(){this.elements.childrenContainer=new UWA.Element("ul",{"class":"wux-controls-treenodebase-children wux-ui-stack-v",styles:{}}).inject(this.elements.container)},getPrevBrotherNode:function(){if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);if(childIndex>0){childIndex--;return this.getParent().getNthChild(childIndex)}}},getNextBrotherNode:function(){if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);if(childIndex<this.getParent().getChildren().length){childIndex++;return this.getParent().getNthChild(childIndex)}}},getNextBrothersNodes:function(){var brotherNodes=[];if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);while(childIndex<this.getParent().getChildren().length-1){childIndex++;brotherNodes.push(this.getParent().getNthChild(childIndex))}}return brotherNodes},getChildIndex:function(){return this.getParent()&&this.getParent().getChildren()?this.getParent().getChildren().indexOf(this):-1},getChildren:function(){return this._children},hasChildren:function(){var child=this.getChildren();if(child&&child.length>0){return true}else{return false}},getAllDescendants:function(descendants){if(descendants===undefined){descendants=[]}else{descendants.push(this)}var children=this.getChildren();if(children){children.forEach(function(child){child.getAllDescendants(descendants)})}return descendants},getNthChild:function(iIndice){if(this.getChildren()){return this._children[iIndice]}},getLastChild:function(){return this._children[this._children.length-1]},_getRowIndex:function(){return this.options._rowIndex},_setRowIndex:function(rowIndex){this.options._rowIndex=rowIndex},onPreExpand:function(callback){if(callback){this.options.onPreExpand=callback}},onPostExpand:function(callback){if(callback){this.options.onPostExpand=callback}},_preExpandDone:function(){this.getTree()._modelEvents.publish({event:"PRE_EXPAND_DONE"})},expand:function(expandLevel){if(expandLevel===undefined){expandLevel=1}var me=this;var processExpand=function(){if(me._modeIsExpandAll!==true){me._modeIsExpandAll=expandLevel;if(me._modeIsExpandAll&&me._modeIsExpandAll>0){me._modeIsExpandAll--;me._processChildren(true)}}else{me._processChildren(true)}if(!me.getChildren()){me._buildExpander(false)}me.getTree()._modelEvents.publish({event:"expand",context:me,data:{node:me}});if(me.options.onPostExpand){me.options.onPostExpand.call(me)}me.getTree()._modelEvents.publish({event:"postExpand",context:me,data:{node:me}})};if(expandLevel>0&&!this.isExpanded()){me.getTree()._modelEvents.publish({event:"preExpand",context:me,data:{node:me}});if(me.options.onPreExpand){me.options.onPreExpand.call(me)}if(me.options.useAsyncPreExpand){me.getTree()._modelEvents.subscribe({event:"PRE_EXPAND_DONE"},function(){processExpand()})}else{processExpand()}}},expandAll:function(){this._modeIsExpandAll=true;this._processChildren(true);this._modeIsExpandAll=false},isExpanded:function(){return this._isExpanded},isRoot:function(){return this.options.isRoot},_showChildren:function(){var me=this;this._children.forEach(function(childNode){childNode._attachToView();if(me._modeIsExpandAll){childNode.expand(me._modeIsExpandAll)}if(me.options.animateOnExpand){var fx=new UWA.Fx(childNode.getContent(),{duration:FX_DURATION,transition:"quintIn"});fx.start({opacity:[0,1],marginTop:[-20,0]})}me.getTree()._onUpdate(childNode)});this._isExpanded=true;if(this.elements.expander){this.elements.expander.set(this.options.UI.collapseState)}},_processChildren:function(){var children=this.getChildren();this._loadModel(children)},_getObjectClass:function(){return"TreeNodeBase"},onPreCollapse:function(callback){if(callback){this.options.onPreCollapse=callback}},onPostCollapse:function(callback){if(callback){this.options.onPostCollapse=callback}},collapseNode:function(){console.warn("Please use the collapse method instead");this.collapse()},collapse:function(){if(this.isExpanded()){if(this.options.onPreCollapse){this.options.onPreCollapse.call(this)}this.getTree()._modelEvents.publish({event:"preCollapse",context:this,data:{node:this}});if(this._children){this._children.forEach(function(childNode){childNode._dettachFromView();childNode.collapse()})}this._isExpanded=false;this._expandState="expandState";if(this.isDrawn()){this.elements.expander.set(this.options.UI[this._expandState])}this.getTree()._modelEvents.publish({event:"collapse",context:this,data:{node:this}});if(this.options.onPostCollapse){this.options.onPostCollapse.call(this)}this.getTree()._modelEvents.publish({event:"postCollapse",context:this,data:{node:this}})}},_attachToView:function(childIndex){this.buildSkeleton();this.buildNode();this.show();if(this.getParent()&&!this.options.isRoot&&!this.getContent().isInjected()){var index=this.getParent().getChildren().indexOf(this);var parentContainer=this.getParent().elements.childrenContainer;if(parentContainer.children&&parentContainer.children[index]){parentContainer.insertBefore(this.getContent(),parentContainer.children[index])}else{parentContainer.appendChild(this.getContent())}}if(this.getParent()&&this.options.isRoot){var index=parseInt(this.getParent().getChildren().indexOf(this),10);var parentContainer=this.getTree().elements.treeContainer;if(parentContainer.children&&parentContainer.children[index]){parentContainer.insertBefore(this.getContent(),parentContainer.children[index])}else{parentContainer.appendChild(this.getContent())}this.show()}if(this.options.isRoot){this.show()}if(this.options.isRoot&&this.options.isFakeRoot){this.hide()}this._isDrawn=true;this._bindBehaviors()},_dettachFromView:function(){if(this.elements&&this.elements.container&&this.getContent()){this.getContent().destroy()}this._isDrawn=false},isDrawn:function(){return this._isDrawn},_bindBehaviors:function(){var me=this;var parentTree=this.getTree();if(this.options.isDraggable===undefined&&parentTree.options.isEditable){this.options.isDraggable=parentTree.options.isEditable.nodesAreDraggable}if(parentTree.options.isEditable){this.options.isEditable={autoExpandAtDrag:true,autoExpandAtDragDelay:1000};this.options.isEditable=UWA.merge(this.options.isEditable,parentTree.options.isEditable,true)}if(this.options.isDraggable){this._drag=new WUXDraggable(this,this.elements.view,{dataTransfer:{type:"Text",data:"toto"},data:this,onDragStart:function(e,ui){parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_START",data:me})}});var dropPos;this._drop=new WUXDroppable(this,this.elements.view,{onDragEnter:function(e,ui,data){parentTree._clearAutoExpandAtDragTimeout()},onDragOver:function(e,ui,data){var targetedObject=this;var dm=me.elements.view.getDimensions();var topThresh=Number(dm.height)/3;var middleThresh=dm.height*2/3;var mousePos=NAVIGATOR.ie?e.offsetY:e.layerY;if(mousePos<topThresh){dropPos="top";ui.setStyles({boxShadow:"inset 0px 1px 0px blue"});parentTree._clearAutoExpandAtDragTimeout()}else{if(mousePos>=topThresh&&mousePos<middleThresh){dropPos="middle";ui.setStyles({boxShadow:"inset -1px -1px 0px blue, inset 1px 1px 0px blue"});if(me.options.isEditable.autoExpandAtDrag&&!parentTree._toAutoExpandAtDrag){parentTree._toAutoExpandAtDrag=setTimeout(function(){targetedObject.expand()},me.options.isEditable.autoExpandAtDragDelay)}}else{dropPos="bottom";ui.setStyles({boxShadow:"inset 0px -1px 0px blue"});parentTree._clearAutoExpandAtDragTimeout()}}parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_OVER",data:me})},onDragLeave:function(e,ui){ui.setStyles({boxShadow:"none"});parentTree._clearAutoExpandAtDragTimeout();parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_LEAVE",data:me})},drop:function(e,ui,data){ui.setStyles({boxShadow:"none"});parentTree._modelEvents.publish({context:this,event:"NODE/PRE_DROP",data:data});if(this!==data.from){if(parentTree._onDropCallBack){parentTree._onDropCallBack.call(this,data)}else{var deltaDown=1,deltaUp=0;if(data.from.getParent()===this.getParent()){deltaDown=data.from.getParent().getChildren().indexOf(data.from)<this.getParent().getChildren().indexOf(this)?0:1;deltaUp=data.from.getParent().getChildren().indexOf(data.from)<this.getParent().getChildren().indexOf(this)?1:0}switch(dropPos){case"top":this.getParent().addChild(data.from,this.getParent().getChildren().indexOf(this)-deltaUp);break;case"middle":this.addChild(data.from);break;case"bottom":this.getParent().addChild(data.from,this.getParent().getChildren().indexOf(this)+deltaDown);break}}}else{console.warn("You dropped the node on itself")}parentTree._modelEvents.publish({context:this,event:"NODE/POST_DROP",data:data})}})}},_updateView:function(force,recursive){var me=this;if(this._updateViewTimeout){clearTimeout(this._updateViewTimeout)}function render(){if(force===undefined){force=false}if(recursive===undefined){recursive=false}if(force){me._dettachFromView();if(me.getParent()&&me.getParent()._isExpanded){me._attachToView()}if(DEBUG){var fx=new UWA.Fx(me.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF","#3F0"]});fx.start({backgroundColor:["#3F0","#FFF"]})}}else{me._buildExpander(false);me._buildLink(true);if(DEBUG){var fx=new UWA.Fx(me.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF","#3CF"]});fx.start({backgroundColor:["#3CF","#FFF"]})}}if(recursive){var children=me.getChildren();if(children){me.getChildren().forEach(function(child){if(child){child._updateView(force,true)}})}}}if(this.options.renderSaver){this._updateViewTimeout=setTimeout(render,this.options.renderSaver)}else{render()}},flash:function(color){if(color===undefined){color="#F1960C"}var fx=new UWA.Fx(this.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF",color]});fx.start({backgroundColor:[color,"#FFF"]})},dump:function(mode){return this._dump(mode,{icons:null,label:null})},_dump:function(mode,properties,output){if(!output){output={}}if(!mode){mode=1}if(properties===undefined){properties={icons:null,label:null}}for(var prop in properties){var propToCopy=this.options[prop];if(propToCopy){output[prop]=propToCopy}}var children=this.getChildren();if(children){switch(mode){default:case 1:output.children=[];children.forEach(function(child){output.children.push(child.dump(mode))});return output;case 2:return(UWA.Json.encode(UWA.Json.path(children,"$_children[*]")))}}return output},processChildren:function(callback){var children=this.getChildren();if(children){children.forEach(function(child){if(callback){callback.call(child,child);child.processChildren(callback)}})}},_loadModel:function(children){var expandChildren=true;var me=this;if(children){switch(UWA.typeOf(children)){case"string":if(expandChildren){UWA.Ajax.request(children,{async:true,onComplete:function(msg){me.removeChildren();var jsonObject=eval(msg);me._parseTree(jsonObject,me,me._uuid,me.options.UI);if(expandChildren){me._showChildren()}else{me.collapse()}},onFailure:function(msg){console.log("[!]\tError loading file:"+children)}})}break;case"array":if(expandChildren){me._showChildren()}break}}},search:function(value){var children=this.getChildren();if(children){children.forEach(function(child){var originalLabelStyle;if(child.options.label){var label=child.options.label.toLowerCase();if(value!==""){if(label.search(value.toLowerCase())!==-1){originalLabelStyle=WUX.Utilities.Css.recordState(child.elements.label,["box-shadow","font-weight","text-shadow","border"]);child.elements.label.setStyles({boxShadow:"inset 0px 0px 200px 0px #ffff00,inset 0px 0px 2px 1px white",fontWeight:"bold",textShadow:"0px 1px 1px white"});child.getParent().expand(1)}else{WUX.Utilities.Css.restoreState(child.elements.label,originalLabelStyle,["box-shadow","font-weight","text-shadow"])}}else{WUX.Utilities.Css.restoreState(child.elements.label,originalLabelStyle,["box-shadow","font-weight","text-shadow"]);child.expand(1)}}child.search(value)})}}});return UWA.namespace("WUX/Controls/TreeNodeBase",TreeNodeBase)});define("DS/Controls/TreeNode",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeNodeBase","DS/CoreEvents/Events"],function(f,a,e,b,c){var d=b.extend({defaultOptions:{pathElement:null},init:function(g){this._parent(g);this._isHighlighted=false},getPathElement:function(){return this.options.pathElement}});return f.namespace("WUX/Controls/TreeNode",d)});define("DS/Controls/TreeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Css3D","DS/Controls/TreeNodeBase","DS/Controls/TreeNode","DS/Utilities/MouseEvents","DS/CoreEvents/ModelEvents"],function(j,C,u,a,x,h,y,c,s,m,p){var q=5;var B=5;var A=5;var r="#333";var o="transparent";var v="solid";var k=1;var g=r;var f="#FFF";var d=10;var z=20;var i={"class":"Expander",text:"+",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var b={"class":"Expander",text:"â",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var l={"class":"Expander",text:"â¢",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var t={"class":"NoExpander Link",text:"",styles:{backgroundColor:o,marginTop:z/2,width:(d+2*k)/2,borderTop:k+"px "+v+" "+r,cursor:"pointer",zIndex:1000}};var e={"class":"NoExpander Link",text:"",styles:{backgroundColor:o,marginTop:z/2,width:(d+2*k)/2,cursor:"pointer",zIndex:1000}};var n={expander:{size:d,borderSize:k},icon:{size:z},link:{size:k,color:r,bgColor:o,style:v},label:{padding:A,cursor:"pointer",marginRight:5,marginLeft:B,borderRadius:0},layout:{btMargin:q,lrMargin:B},expandState:i,collapseState:b,asyncState:l,noExpandState:t,noExpandRoot:e};var w=u.extend({defaultOptions:{isEditable:false,expandAllAtInit:false,zoomFactor:100,hasFilterBox:false,isScrollable:true,UI:n,roots:[],nodeClass:c},init:function(D){this._parent(D);this._zoom=1;this._roots=[];this._modelEvents=new p();this.buildSkeleton();this._loadModel(this.options.roots);this._buildCustomView();this._buildScroller();this._listenEvents()},_clearAutoExpandAtDragTimeout:function(){if(this._toAutoExpandAtDrag){clearTimeout(this._toAutoExpandAtDrag);this._toAutoExpandAtDrag=null}},_listenEvents:function(){var D=this;j.Element.addEvent.call(this.elements.container,"mousewheel",function(G){var H=j.Event.wheelDelta(G);var F=G.shiftKey;if(F){if(Math.abs(H)===1){H=H*0.1}if(D._zoom+H>0.55&&D._zoom+H<10){D._zoom=D._zoom+H;D.setZoomFactor(D._zoom.toFixed(2))}}});if(this.options.isScrollable){var E=0;this._scroller.addEvent("onRefresh",function(){E++;if(E===2){D.elements.container.setStyle("width","auto");D.elements.container.getElement(".uwa-scroller").setStyle("width","auto")}if(E>=2){D.elements.container.getElement(".uwa-scroller").setStyle("width","auto")}})}},buildSkeleton:function(){var D=this;var E=this.elements;E.container=new j.Element("div",{"class":"WUX WUXTree",styles:{zoom:this.options.zoomFactor+"%",height:"100%",position:"relative"}});if(this.options.hasFilterBox){E.search=new j.Element("input",{type:"search",placeholder:"search in tree ...",styles:{backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 5px",border:"1px solid #FFF",marginLeft:12},events:{blur:function(F){D.search(E.search.value)},change:function(F){D.search(E.search.value)},keydown:function(F){D.search(E.search.value)}}});E.search.inject(E.container)}E.scrollContainer=new j.Element("div");E.scrollContainer.inject(E.container);E.treeAndGrid=new j.Element("ul",{"class":"Horizontal"});E.treeAndGrid.inject(E.scrollContainer);this.elements.treeContainer=new j.Element("li",{styles:{verticalAlign:"top",width:"100%"}});this.elements.treeContainer.inject(E.treeAndGrid);this._currentNodeID++;this._treeRoot=new this.options.nodeClass({isFakeRoot:true,isRoot:true,label:"Root",tree:this,UI:this.options.UI});this._treeRoot.inject(this.elements.treeContainer)},_buildCustomView:function(){},_buildScroller:function(){if(this.options.isScrollable){this._scroller=new j.Controls.Scroller(this.elements.scrollContainer,{momentum:true,scrollableX:false,scrollableY:true,scrollDrag:false})}},empty:function(){this.removeAllRoots()},addRoot:function(D){D.isRoot=true;D.tree=this;D.UI=this.options.UI;var E=this._createNode(D);E.getContent().addClassName("wux-tree-root");this._treeRoot.addChild(E);this._roots.push(E);this._updateRootsView(true);return E},removeRoot:function(D){D.getContent().destroy();var E=this._treeRoot._children.indexOf(D);if(E!==-1){this._treeRoot._children.splice(E,1);this._roots.splice(E,1)}},removeAllRoots:function(){var F=this.getRoots().length;for(var E=0;E<F;E++){var D=this.getNthRoot(0);this.removeRoot(D)}},_updateRootsView:function(){this._treeRoot.collapse();this._treeRoot.expand()},dump:function(D){return this._treeRoot.dump(D)},processNodes:function(D){this._treeRoot.processChildren(D)},toggle:function(){this.elements.container.toggle()},getRoots:function(){if(this._treeRoot.getChildren()){return this._treeRoot.getChildren()}else{return[]}},_getTrueRoot:function(){return this._treeRoot},getNthRoot:function(D){if(this._treeRoot.getChildren()){return this._getTrueRoot().getChildren()[D]}},setZoomFactor:function(D){this.options.zoomFactor=D;this._treeRoot.elements.container.setStyle("zoom",D)},_onUpdate:function(D){},_onPreExpand:function(D,E){},_onExpand:function(D,E){},_onPostExpand:function(D,E){},_onPreCollapse:function(D,E){},_onCollapse:function(D,E){},_onPostCollapse:function(D,E){},onExpand:function(D){return this._modelEvents.subscribe({event:"expand"},D)},onCollapse:function(D){return this._modelEvents.subscribe({event:"collapse"},D)},onNodeDragOver:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_OVER"},D)},onNodeDragStart:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_START"},D)},onNodeDragLeave:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_LEAVE"},D)},onNodePreDrop:function(D){return this._modelEvents.subscribe({event:"NODE/PRE_DROP"},D)},onNodeDrop:function(D){this._onDropCallBack=D},onNodePostDrop:function(D){return this._modelEvents.subscribe({event:"NODE/POST_DROP"},D)},onPreExpand:function(D){return this._modelEvents.subscribe({event:"preExpand"},D)},onPostExpand:function(D){return this._modelEvents.subscribe({event:"postExpand"},D)},onPreCollapse:function(D){return this._modelEvents.subscribe({event:"preCollapse"},D)},onPostCollapse:function(D){return this._modelEvents.subscribe({event:"postCollapse"},D)},onNodeClick:function(D){return this._modelEvents.subscribe({event:"click"},D)},onNodeDblClick:function(D){return this._modelEvents.subscribe({event:"dblClick"},D)},onLabelChange:function(D){this._modelEvents.subscribe({event:"UPDATE_LABEL"},D)},delegateEvents:function(D){},search:function(E){var D=this.getRoots();D.forEach(function(F){F.search(E)})},_createNode:function(D){return new this.options.nodeClass(D)},_loadModel:function(E){var F=this;function D(G,H,J){var I;J++;if(J===0){H.forEach(function(K){I=F.addRoot(K);D(I,K,J)})}else{if(H.children){H.children.forEach(function(K){I=F._createNode(K);G.addChild(I);D(I,K,J)})}}J--}D(this._treeRoot,E,-1)}});w.themes={"default":n};return j.namespace("WUX/Controls/TreeBase",w)});define("DS/Controls/TileCellView",["UWA/Core","DS/Controls/TileView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Utilities/Dom"],function(b,d,a,i,f,g,e){function h(j){return j.charAt(0).toUpperCase()+j.slice(1)}var c=a.extend({defaultOptions:{size:"small",menu:[]},init:function(k){var m=k.menu;k.menu=[];this._CtxMenuByRightClick=true;this._parent(k);this.elements.container.setStyles({border:"none"});this.elements.container.setAttribute("draggable","true");this.elements.container.dsView=this;this._view=new d(this.options).inject(this.elements.container);this._view.elements.menu.cellView=this;var l=this;this._view.elements.checkbox.addEventListener(f.POINTERDOWN,function(n){n.stopPropagation()});this._view.elements.checkbox.addEventListener(f.POINTERUP,function(n){n.stopPropagation()});this._view.elements.checkbox.addEventListener("click",function(n){if(l.getGridEngine()&&l.getGridEngine()._isTouchWithatCellHover===true){l.getGridEngine()._isTouchWithatCellHover=false;n.stopPropagation();l.getGridEngine()._enableInteractiveMultiSelMode()}},true);this._view._listenToChanges=true;this._view.elements.checkbox.addEventListener("change",function(o){if(l._view._listenToChanges){var n=l.getGridEngine();var p=l.getCellInfos();if(n&&p){n._enableInteractiveMultiSelMode();if(p.cellModel.isSelected()){p.cellModel.unselect()}else{if(!n.options.selection.canMultiSelect){n.options.TreedocModel.getXSO().empty()}p.cellModel.select()}n.options.lastSelectedNode=p.cellModel}}});this.setupContextualMenu(m);var j=this.getGridEngine().options.onContextualEvent;if(j){this._view.elements.menu.addEventListener(f.POINTERUP,function(q){var s=this;var p=s.cellView;l._CtxMenuByRightClick=false;if(f.isTouchEvent(q)){if(p.getGridEngine()._preventSelectionForTouchScroll){return}}var r=p.getCellInfos();if(r){var t=r.nodeModel;if(t&&!t.isSelected()){t.select(true);p.getGridEngine().setActiveNode(t,true)}}var n=p.getGridEngine().options.onContextualEvent;if(n){var o=document.createEvent("HTMLEvents");o.initEvent("contextmenu",true,false);o.pageX=q.pageX;o.pageY=q.pageY;s.dispatchEvent(o)}l._CtxMenuByRightClick=true;q.stopPropagation()})}else{this._view.elements.menu.addEventListener(f.POINTERDOWN,function(o){var p=this;var n=p.cellView;l._CtxMenuByRightClick=false;i.show(n._view.elements.container,[o.pageX,o.pageY]);l._CtxMenuByRightClick=true})}},setupContextualMenu:function(n){var m=this;var k=this.getGridEngine().options.onContextualEvent;if(k){g.addEventListener(this.elements.container,{callback:function(p){if(m.getGridEngine()){m.getGridEngine()._cellCtxMenuRequired=true;if(m._CtxMenuByRightClick===true){var o=m.getCellInfos();if(o){var q=o.nodeModel;if(q&&!q.isSelected()){q.select(true);m.getGridEngine().setActiveNode(q,true)}}}}return k.callback.call(k["this"],{context:m,menuContext:p.context,infos:p.info,data:p.data,cellInfos:m.getCellInfos()})}})}else{var l=this.getGridEngine().options.onContextualMenuReady;var j=l;if(typeof l==="function"){j=function(){var o=m.getCellInfos();if(o&&m._CtxMenuByRightClick===true){var p=o.nodeModel;if(p&&!p.isSelected()){p.select(true);m.getGridEngine().setActiveNode(p,true)}}return l.call(m,o)}}i.forget({target:this._view.elements.container,nodes:j});i.onReady({target:this._view.elements.container,nodes:j})}},updateInternalParameters:function(){this.setColor();this.setTitle();this.setSubtitle();this.setDescription();this.unhighlight();this.deactivate();this.unsetBadges()},setColor:function(j){this._view.setColor(j)},setIcon:function(j){this._view.setIcon(j)},setTitle:function(j){this._view.setTitle(j);if(!this.getGridEngine()||(this.getGridEngine()&&typeof this.getGridEngine().getShouldDisplayTooltipFlag==="function"&&this.getGridEngine().getShouldDisplayTooltipFlag()===true)){this.elements.container.title=j}},setSubtitle:function(j){this._view.setSubtitle(j)},setDescription:function(j){this._view.setDescription(j)},setPicture:function(j){this._view.setPicture(j)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var j=this._parent();var k=this.getVirtualCoordinates();j.nodeModel=this.getGridEngine().getCellModel(k.virtualRowID,k.virtualColumnID);return j},setPictureBackgroundSize:function(j){if(this._view&&this._view.elements.picture){this._view.elements.picture.setStyle("background-size",j)}},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="";this._view.elements.badgeTopRight.style.visibility="hidden";this._view.elements.badgeTopRight.className="";this._view.elements.badgeTopRight.addClassName("wux-controls-tileview-badge-top-right");this._view.elements.badgeBottomRight.style.backgroundImage="";this._view.elements.badgeBottomRight.style.visibility="hidden";this._view.elements.badgeBottomRight.className="";this._view.elements.badgeBottomRight.addClassName("wux-controls-tileview-badge-bottom-right")},setBadges:function(j){for(var l in j){var k=j[l];if(k){e.generateIcon(k,{target:this._view.elements["badge"+h(l)]});this._view.elements["badge"+h(l)].style.visibility="visible"}}}});return c});define("DS/Layouts/TreeNavigationNodeAbstract",["UWA/Core","DS/Controls/TreeNodeBase","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(d,b,a,c){});define("DS/Controls/SelectionChips",["UWA/Core","UWA/Class","UWA/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","i18n!DS/Controls/assets/nls/translation"],function(d,v,e,t,g,w,p,s){var i=false;function u(){this._preventEventsCpt++}function o(){this._preventEventsCpt--}function q(z){var y=false;this._items.forEach(function(B){var A=B.associatedChipCellView;if(B.isSelected){if(!A.isHighlighted){A.isHighlighted=true;y=true;A.addClassName("wux-ui-state-highlighted")}}else{if(A.isHighlighted){A.isHighlighted=false;y=true;A.removeClassName("wux-ui-state-highlighted")}}});if(y&&this._preventEventsCpt===0){this.fire("selectionChange")}}function k(D,A){var B=A.currentStyle||window.getComputedStyle(A,null),z=parseInt(B.borderLeftWidth,10),C=A.getBoundingClientRect(),y=D.clientX-z-C.left;return y}function r(B,A){B=B||window.event;var z=k.call(this,B,A);var y=A.getDimensions().width*1/4;if(z<y){return"left"}return"right"}function f(z){var y={chipCellView:undefined,dropPosition:""};y.chipCellView=w.firstParentWithClass(z.target,"wux-chip-cell-container");if(y.chipCellView===undefined){return y}if(z.type==="dragstart"||z.type==="dragover"||z.type==="dragenter"||z.type==="dragleave"||z.type==="drop"){y.dropPosition=r.call(this,z,y.chipCellView)}return y}function n(C){var y=this;var B={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var A=B[C.type];h.call(this);this._currentDnDInfos=f.call(this,C);j.call(this);function z(G,D){var H=true;var E=y[G+D];if(E){H=E.call(y,C,y._currentDnDInfos);if(i&&G!=="onDragOver"){console.info("[dnd]",G+D,">",H,C.target)}}else{if(i){console.warn("[dnd]","cannot find",G+D,"callback")}}if(H){var F=y[G+D+"Default"];if(F){if(i){if(E&&H){console.info("\t>[dnd]","dev want to continue to the default behavior for ",G+D," callback")}else{console.info("\t>[dnd]","use the default behavior for ",G+D," callback")}}F.call(y,C,y._currentDnDInfos)}}}if(this._currentDnDInfos.chipCellView){z(A,"Cell")}else{z(A,"Blank")}}function j(y,z){if(this._currentDnDInfos){if(this._currentDnDInfos.chipCellView){var z=this._currentDnDInfos.dropPosition;if(z==="left"){this._currentDnDInfos.activeSeparator=this._currentDnDInfos.chipCellView.dndFeedbackBefore}else{if(z==="right"){this._currentDnDInfos.activeSeparator=this._currentDnDInfos.chipCellView.dndFeedbackAfter}}}else{if(this._items.length>0){this._currentDnDInfos.activeSeparator=this._items[this._items.length-1].associatedChipCellView.dndFeedbackAfter}}if(this._currentDnDInfos.activeSeparator){this._currentDnDInfos.activeSeparator.setAttribute("is-active",true)}}}function h(){if(this._currentDnDInfos&&this._currentDnDInfos.activeSeparator){this._currentDnDInfos.activeSeparator.removeAttribute("is-active");this._currentDnDInfos=undefined}}function x(z,y){y=d.extend({source:{uuid:this._uuid,amd:"DS/Controls/SelectionChips"},data:{"dswebux/x-controls.selectionchips.data+json":""}},y);z.dataTransfer.setData("Text",JSON.stringify(y))}function b(y){var z=y.dataTransfer.getData("Text");try{return JSON.parse(z)}catch(y){console.warn('the element being in dataTransfer type "text" is not parsable usable JSON.parse')}}function a(y,z){var C=this;var B=new d.Element("div",{"class":"wux-chip-cell-container"});B.isHighlighted=false;B.associatedModelItem=z;B.label=new d.Element("li",{"class":"wux-chip-cell-label",text:z.chipOptions.label,title:z.chipOptions.label});B.appendChild(B.label);var A=new d.Element("li",{"class":"wux-chip-cell-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong"});B.appendChild(A);var D=true;B.addEvent(g.POINTERDOWN,function(E){D=z.isSelected;if(!z.isSelected){C._modifierKeysPressed=E.ctrlKey||E.shiftKey;w._pushUserInteractionContext();C.selectChip(z);w._popUserInteractionContext();C._modifierKeysPressed=false}});B.addEvent(g.POINTERUP,function(E){if(D&&z.isSelected){C._modifierKeysPressed=E.ctrlKey||E.shiftKey;w._pushUserInteractionContext();C.unselectChip(z);w._popUserInteractionContext();C._modifierKeysPressed=false}});B.addEvent("mouseenter",function(E){D=false;B.addClassName("wux-ui-state-prehighlighted")});B.addEvent("mouseleave",function(E){B.removeClassName("wux-ui-state-prehighlighted")});A.addEvent(g.POINTERDOWN,function(E){E.preventDefault();E.stopPropagation()});A.addEvent(g.POINTERUP,function(E){w._pushUserInteractionContext();C.removeChip(z.chipOptions.label);w._popUserInteractionContext()});B.setAttribute("draggable","true");return B}function m(A){var z={chipOptions:A,isSelected:false,associatedChipCellView:undefined};var y=new d.Element("ul",{"class":"wux-chip-cell-main-container"});var B=a.call(this,y,z);var C=new d.Element("span",{"class":"wux-chip-cell-drop-feedback"});var D=new d.Element("span",{"class":"wux-chip-cell-drop-feedback"});y.appendChild(C);y.appendChild(B);y.appendChild(D);z.associatedChipCellView=B;B.chipCellViewMainContainer=y;B.dndFeedbackBefore=C;B.dndFeedbackAfter=D;return{modelItem:z,chipCellView:B}}function l(C,G){var B=false;u.call(this);var z=b.call(this,C);if(z){var D=z.source.uuid;var I=G.chipCellView?G.chipCellView.associatedModelItem:undefined;if(this._uuid!==D||!I||!I.isSelected){var E=z.data["dswebux/x-controls.selectionchips.items+json"];var J=G.dropPosition;var F=this;if(this._uuid===D){for(var H=0;H<this._items.length;){if(this._items[H].isSelected){F.removeChip(H)}else{H++}}}if(E){var A=this._items.indexOf(I);var y=undefined;if(J==="left"){y=A!==-1?A:0}else{if(J==="right"){y=A!==-1?A+1:0}}E.forEach(function(L){B=true;F._onDragAndDropFlag=true;if(F._lastWidgetDiv.children.length>0&&y===undefined){L.index=F._items.length}else{L.index=y}var K=F.addChip(L);K.isSelected=true});q.call(this)}}}h.call(this);o.call(this);if(B&&this._preventEventsCpt===0){this.fire("change")}}var c=t.inherit({publishedProperties:{selection:{defaultValue:{toggle:true,mode:2,unselectAllOnEmptyArea:true},type:"object",category:"Behavior",noNeedToApplyFlag:true},shape:{defaultValue:0,type:"enum",category:"Appearance"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},onDragStartCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEndCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragOverCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEnterCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragLeaveCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDropCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDropBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragLeaveBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragOverBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEnterBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true}},_build:function(){this._parent();this._uuid=e.getUUID();this._preventEventsCpt=0;this.elements.container=new d.Element("div",{"class":"wux-controls-selectionChips"});this._placeholderDiv=new d.Element("div",{"class":"wux-controls-placeholder-selectionChips",text:this.placeholder}).inject(this.elements.container);this._clearAllDiv=new d.Element("div",{"class":"wux-controls-clear-selectionChips wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"}).inject(this.elements.container);this._lastWidgetDiv=new d.Element("div",{"class":"wux-controls-lastWidget-selectionChips"});this._items=[]},handleEvents:function(){var y=this;var z=n.bind(this);this.getContent().addEvent("dragstart",z);this.getContent().addEvent("drop",z);this.getContent().addEvent("dragover",z);this.getContent().addEvent("drag",z);this.getContent().addEvent("dragend",z);this.getContent().addEvent("dragleave",z);this.getContent().addEvent("dragenter",z);this._clearAllDiv.addEventListener(g.POINTERUP,function(B){var A=document.createEvent("HTMLEvents");A.initEvent("contextmenu",true,false);A.pageX=B.pageX;A.pageY=B.pageY;y.getContent().dispatchEvent(A)});p.addEventListener(this.getContent(),{callback:function(B){var A=[];A.push({type:"PushItem",title:s.clearAll,action:{callback:function(C){y.removeAllChips()}}});return A}});this.getContent().addEvent(g.POINTERDOWN,function(A){if(y.selection.unselectAllOnEmptyArea&&A.target.className.indexOf("wux-chip-cell-container")===-1&&A.target.className.indexOf("wux-chip-cell-label")===-1&&A.target.className.indexOf("wux-chip-cell-close")===-1){y.unselectAllChips(true)}});this._modifierKeysPressed=false},isInMultiSelection:function(){return this.selection.mode===c.SELECTION_MODE.MULTIPLE||this.selection.mode===c.SELECTION_MODE.MULTIPLE_ONKEYS&&this._modifierKeysPressed},_applyShape:function(y){this.elements.container.setAttribute("chip-shape",this.shape)},_applyPlaceholder:function(y){this._placeholderDiv.setText(this.placeholder)},_applyProperties:function(y){this._parent(y);if(this.isDirty("shape")){this._applyShape(y.shape)}if(this.isDirty("placeholder")){this._applyPlaceholder(y.placeholder)}},selectChip:function(z){var y=undefined;if(typeof z==="string"){this._items.some(function(A){if(A.chipOptions.label===z){y=A;return true}return false})}else{if(typeof z==="number"){if(z>=0&&z<this._items.length){y=this._items[z]}}else{y=z}}if(y!==undefined){if(!this.isInMultiSelection()){this._items.forEach(function(A){A.isSelected=false})}y.isSelected=true;q.call(this)}},selectAllChips:function(){if(!this.isInMultiSelection()){return}this._items.forEach(function(y){y.isSelected=true});q.call(this)},unselectChip:function(y){if(!this.selection.toggle&&!this.isInMultiSelection()){return}var z=undefined;if(typeof y==="string"){this._items.some(function(A){if(A.chipOptions.label===y){z=A;return true}return false})}else{if(typeof y==="number"){if(y>=0&&y<this._items.length){z=this._items[y]}}else{z=y}}if(z!==undefined){z.isSelected=false;q.call(this)}},unselectAllChips:function(){if(!this.selection.toggle&&!this.isInMultiSelection()&&!arguments&&!arguments[0]){return}this._items.forEach(function(y){y.isSelected=false});q.call(this)},addChip:function(z){if(!z){return}var A=undefined;if(typeof z==="string"){A={label:z}}else{if(typeof z==="object"){A=Object.assign({},z)}}if(!A||!A.label){return}if(A.index===undefined){A.index=this.elements.container.children.length}if(A.index<0||A.index>this.elements.container.children.length+1){return}var y=m.call(this,A);this._items.splice(A.index,0,y.modelItem);this._placeholderDiv.remove();if(A.index===this.elements.container.children.length){this.elements.container.appendChild(y.chipCellView.chipCellViewMainContainer)}else{this.elements.container.insertBefore(y.chipCellView.chipCellViewMainContainer,this.elements.container.children[A.index+1])}if(this._lastWidgetDiv.children.length>0&&!this._onDragAndDropFlag){this.elements.container.insertBefore(this._lastWidgetDiv,this.elements.container.children[A.index+1])}if(this._preventEventsCpt===0){this.fire("change")}return y.modelItem},addLastWidget:function(y){if(!y){return}if(this._placeholderDiv){this._placeholderDiv.remove()}this.elements.container.appendChild(this._lastWidgetDiv);this._lastWidgetDiv.setContent(y)},removeLastWidget:function(){if(!this._lastWidgetDiv.children.length){return}this._lastWidgetDiv.removeChild(this._lastWidgetDiv.firstChild)},removeAllContent:function(){if(!this._items.length>0){return}this._items=[];this.getContent().empty()},removeChip:function(C){var B=false;var y=undefined;if(typeof C==="string"){var A=this;this._items.some(function(E,D){if(E.chipOptions.label===C){A._items.splice(D,1);A.elements.container.removeChild(E.associatedChipCellView.chipCellViewMainContainer);y=E;B=true;return true}return false})}else{if(typeof C==="number"){if(C>=0&&C<this._items.length){var z=this._items.splice(C,1)[0];this.elements.container.removeChild(z.associatedChipCellView.chipCellViewMainContainer);y=z;B=true}}}if(this._items.length===0){if(this._lastWidgetDiv.children.length==0){this.getContent().insertBefore(this._placeholderDiv,this._clearAllDiv)}}if(B&&this._preventEventsCpt===0){this.fire("change")}return y},removeAllChips:function(){if(!this._items.length>0){return}this._items=[];this.getContent().empty();if(this._lastWidgetDiv.children.length==0){this._placeholderDiv.inject(this.getContent());this._clearAllDiv.inject(this.getContent())}else{this._lastWidgetDiv.inject(this.getContent())}if(this._preventEventsCpt===0){this.fire("change")}},updateChipOptions:function(D,y){var C=false;if(D===undefined||!y){return}var B=undefined;if(typeof y==="string"){B={label:y}}else{if(typeof y==="object"){B=Object.assign({},y)}}if(!B){return}var A=undefined;if(typeof D==="string"){this._items.some(function(F,E){if(F.chipOptions.label===D){A=F;return true}return false})}else{if(typeof D==="number"){if(D>=0&&D<this._items.length){A=this._items[D]}}}if(A!==undefined){var z=A.chipOptions;d.merge(B,z);A.chipOptions=B;var C=false;if(z.label!==B.label){A.associatedChipCellView.label.textContent=B.label;C=true}if(z.icon!==B.icon){}if(z.index!==B.index){this._items.splice(z.index,1);A.associatedChipCellView.chipCellViewMainContainer.remove();this._items.splice(B.index,0,A);this.elements.container.insertBefore(A.associatedChipCellView.chipCellViewMainContainer,this.elements.container.children[B.index+1]);C=true}if(C&&this._preventEventsCpt===0){this.fire("change")}}},getChipLabel:function(y){if(y>=0&&y<this._items.length){return this._items[y].chipOptions.label}return""},getChipPosition:function(y){var z=-1;this._items.some(function(B,A){if(B.chipOptions.label===y){z=A;return true}return false});return z},getAllChipsOptions:function(){var y=[];this._items.forEach(function(z){y.push(Object.assign({},z.chipOptions))});return y},getSelectedChipsOptions:function(){var y=[];this._items.forEach(function(z){if(z.isSelected){y.push(Object.assign({},z.chipOptions))}});return y},onDragStartCellDefault:function(A,z){var y=[];this._items.forEach(function(B){if(B.isSelected){y.unshift(B.chipOptions)}});x.call(this,A,{data:{"dswebux/x-controls.selectionchips.items+json":y}});A.dataTransfer.effectAllowed="move"},onDragEndCellDefault:function(z,y){},onDragOverCellDefault:function(z,y){z.preventDefault()},onDragEnterCellDefault:function(z,y){z.preventDefault()},onDragLeaveCellDefault:function(z,y){h.call(this);return true},onDropCellDefault:function(z,y){z.preventDefault();l.call(this,z,y)},onDropBlankDefault:function(z,y){l.call(this,z,y)},onDragLeaveBlankDefault:function(z,y){h.call(this)},onDragOverBlankDefault:function(z,y){z.preventDefault()},onDragEnterBlankDefault:function(z,y){z.preventDefault()}});c.SHAPE={RECTANGULAR:0,OVAL:1};c.SELECTION_MODE={SINGLE:0,MULTIPLE:1,MULTIPLE_ONKEYS:2};return c});define("DS/Controls/SearchEditor",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/SelectionChips","DS/Controls/LineEditor","DS/Controls/Popup"],function(g,a,f,d,c,e){var b=f.inherit({name:"searchEditor",publishedProperties:{multiSearchMode:{defaultValue:false,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-searchEditor");this.elements.container.setAttribute("tabindex",0);this._editor=new c({placeholder:"Search...",displayStyle:"lite",});this._editor.getContent().addClassName("wux-controls-searchEditor-editor");this._editor.inject(this.elements.container)},handleEvents:function(){var h=this;a.addEventOnElement(this,this._editor,"change",function(i){if(h.multiSearchMode){if(h._editor.value!=""){h._selectionChips.addChip({label:h._editor.value});h._editor.value=""}}});if(this._selectionChips){a.addEventOnElement(this,this._selectionChips,"change",function(i){if(h.multiSearchMode){if(!h._selectionChips.getAllChipsOptions().length){h._selectionChips.addLastWidget(h._editor)}}})}},_applyProperties:function(h){this._parent(h);if(this.isDirty("multiSearchMode")){this._applyMultiSearchMode(h.value)}},_applyMultiSearchMode:function(h){this._editor.value="";if(!this.multiSearchMode){if(this._selectionChips){this._selectionChips._clearAllDiv.remove();this._selectionChips.removeAllChips()}}else{if(!this._selectionChips){this._selectionChips=new d({}).inject(this.elements.container);this._selectionChips.addLastWidget(this._editor);this._selectionChips.getContent().addClassName("wux-controls-searchEditor-mainelement")}}},_showPopup:function(){},_buildPopup:function(){},getAllSelectedValues:function(){var h=[];if(this.multiSearchMode){this._selectionChips._items.forEach(function(i){h.push(i.chipOptions.label)})}else{h.push(this._editor.value)}return h}});return b});define("DS/Controls/Scroller",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Utilities/Css3D","DS/CoreEvents/ModelEvents","UWA/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/RAFDispatcher","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry"],function(d,q,j,c,r,g,i,m,a,p,f,l){var b=false;var k=10;var h=40;var n=800;function e(u){var w=0,v=0,t=0,s=0;if("detail" in u){v=u.detail}if("wheelDelta" in u){v=-u.wheelDelta/120}if("wheelDeltaY" in u){v=-u.wheelDeltaY/120}if("wheelDeltaX" in u){w=-u.wheelDeltaX/120}if("axis" in u&&u.axis===u.HORIZONTAL_AXIS){w=v;v=0}t=w*k;s=v*k;if("deltaY" in u){s=u.deltaY}if("deltaX" in u){t=u.deltaX}if((t||s)&&u.deltaMode){if(u.deltaMode===1){t*=h;s*=h}else{t*=n;s*=n}}if(t&&!w){w=(t<1)?-1:1}if(s&&!v){v=(s<1)?-1:1}return{spinX:w,spinY:v,pixelX:t,pixelY:s}}var o=j.extend({defaultOptions:{eventPeriod:0,scrollDebounceTimeout:0,scrollEndTimeout:201,useRequestAnimationFrame:false,events:{onScrollBegin:null,onScroll:null,onScrollEnd:null}},init:function(t,s){this._parent(s);this._modelEvents=new g({callMode:"asc"});this._target=t;this._beginScrollPosition={x:0,y:0};this._scrollPosition={x:0,y:0};this._lastScrollPosition=this._scrollPosition;this._scrollDirection={x:0,y:0};this._lastScrollDirection=this._scrollDirection;this._buildSkeleton();this._bindBehaviors();this._modelEvents.publish({event:"INIT",context:this})},_buildSkeleton:function(){var t=this;var s=new d.Element("div",{"class":"wux-scroller",styles:{position:"absolute",left:0,right:0,top:0,bottom:0}});this.elements.container=s;this._target.inject(this.elements.container)},onInit:function(s){return this._modelEvents.subscribe({event:"INIT"},s)},onScrollBegin:function(s){return this._modelEvents.subscribe({event:"SCROLL_START"},s)},onScroll:function(s){return this._modelEvents.subscribe({event:"SCROLL"},s)},_onVerticalScrollDirectionChanged:function(s){return this._modelEvents.subscribe({event:"VERTICAL_SCROLL_DIRECTION_CHANGED"},s)},_onHorizontalScrollDirectionChanged:function(s){return this._modelEvents.subscribe({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED"},s)},onScrollEnd:function(s){return this._modelEvents.subscribe({event:"SCROLL_END"},s)},_updatePosition:function(){this.setPosition({x:-this.elements.container.scrollLeft,y:-this.elements.container.scrollTop})},_bindBehaviors:function(){var C=this;var v=null;var y=true;var A;function w(){C._modelEvents.publish({event:"SCROLL",context:C})}var u=a.debounce(w,C.options.scrollDebounceTimeout);function D(G,F){C._updatePosition();if(y){if(b){console.log("<<<< BEGIN >>>>")}C._beginScrollPosition=C.getPosition();if(C.options.events.onScrollBegin){C.options.events.onScrollBegin.call(C,C.getPosition())}C._modelEvents.publish({event:"SCROLL_START",context:C});y=false;if(C.options.useRequestAnimationFrame){A=requestAnimationFrame(E)}}C._deltaPositionFromBeginning={x:C._scrollPosition.x-C._beginScrollPosition.x,y:C._scrollPosition.y-C._beginScrollPosition.y};if(b){console.log(">> Scroll _deltaPositionFromBeginning("+C._deltaPositionFromBeginning.x+", "+C._deltaPositionFromBeginning.y+")")}clearTimeout(v);if(!C.options.useRequestAnimationFrame){if(C.options.events.onScroll){C.options.events.onScroll.call(C,C.getPosition())}if(C.options.scrollDebounceTimeout>0){u()}else{w()}}v=setTimeout(function(){if(b){console.log("<<<< END >>>>")}C._deltaPositionFromBeginning={x:0,y:0};if(C.options.events.onScrollEnd){C.options.events.onScrollEnd.call(C,C.getPosition())}if(C.options.useRequestAnimationFrame){cancelAnimationFrame(A)}C._modelEvents.publish({event:"SCROLL_END",context:C});y=true},C.options.scrollEndTimeout)}function B(F){D(F)}function E(){if(C.options.events.onScroll){C.options.events.onScroll.call(C,C.getPosition())}if(C.options.scrollDebounceTimeout>0){u()}else{w()}A=requestAnimationFrame(E)}var t=false;try{var s=Object.defineProperty({},"passive",{get:function(){t=true}});window.addEventListener("testPassive",null,s);window.removeEventListener("testPassive",null,s)}catch(z){}if(this.options.scrollDebounceTimeout){var x=a.debounce(function(){B()},this.options.scrollDebounceTimeout);this.elements.container.addEventListener("scroll",x,t?{passive:true}:false)}else{this.elements.container.addEventListener("scroll",D,t?{passive:true}:false)}d.Element.addEvent.call(this.elements.container,"wheel",function(J){if(!J.ctrlKey&&!J.shiftKey){var F=e(J);var L=Math.abs(F.pixelY);var H=50;var K=0;var I=((F.pixelY<0)&&(C.elements.container.scrollTop===0))||((F.pixelY>0)&&(C.elements.container.scrollHeight-C.elements.container.scrollTop===C.elements.container.clientHeight));if(I){return}J.preventDefault();while(K<=L){K=K+H;var G=C.elements.container.scrollTop+(F.spinY*H);C.elements.container.scrollTop=G}}})},setPosition:function(s,t){if(s.x===undefined){s.x=this.elements.container.scrollLeft}if(s.y===undefined){s.y=this.elements.container.scrollTop}this._lastScrollDirection=this._scrollDirection;this._scrollDirection={x:(this._scrollPosition.x-this._lastScrollPosition.x)>0?1:-1,y:(this._scrollPosition.y-this._lastScrollPosition.y)>0?1:-1};if(this._lastScrollDirection.y!==0&&this._lastScrollDirection.y!==this._scrollDirection.y){this._modelEvents.publish({event:"VERTICAL_SCROLL_DIRECTION_CHANGED",context:this})}if(this._lastScrollDirection.x!==0&&this._lastScrollDirection.x!==this._scrollDirection.x){this._modelEvents.publish({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED",context:this})}this._lastScrollPosition=this._scrollPosition;this._scrollPosition=s;if(t){this.elements.container.scrollTop=s.y;this.elements.container.scrollLeft=s.x}},_resetDeltaScrollPositionFromBeginning:function(){this._beginScrollPosition={x:this._scrollPosition.x,y:this._scrollPosition.y};this._deltaPositionFromBeginning={x:0,y:0}},getDeltaScrollPositionFromBeginning:function(){return this._deltaPositionFromBeginning},resetPosition:function(){this.setPosition({x:0,y:0});this.setPosition({x:0,y:0},true)},scrollToPosition:function(E){console.warn("Don't use this method yet");E=d.extend({scrollDuration:2000,position:{x:0,y:0,onComplete:function(){}}},E);var t=this.elements.container;var D=t.scrollTop,z=t.scrollLeft,y=Math.PI/(E.scrollDuration/15),s=z-E.x,x=D-E.y;var B=0,A=0,C,v;var u=null;requestAnimationFrame(w);function w(G){var F;if(u===null){u=G;console.warn("start")}F=G-u;y=1-Math.cos((Math.PI*(1-((E.scrollDuration-F)/E.scrollDuration))));var I,H;if(s<0){I=t.scrollLeft<E.x}if(s>0){I=t.scrollLeft>E.x}if(x<0){H=t.scrollTop<E.y}if(x>0){H=t.scrollTop>E.y}if(H||I){if(t.scrollTop!==E.y){requestAnimationFrame(w);B=B+1;v=Math.floor(x*y);t.scrollTop=Math.floor(D-v)}if(t.scrollLeft!==E.x){requestAnimationFrame(w);A=A+1;C=Math.floor(s*y);t.scrollLeft=Math.floor(z-C)}}}},getPosition:function(s){if(s){return{x:this.elements.container.scrollLeft,y:-this.elements.container.scrollTop}}else{return this._scrollPosition}},getDeltaScrollPosition:function(){return{x:this._scrollPosition.x-this._lastScrollPosition.x,y:this._scrollPosition.y-this._lastScrollPosition.y}}});return o});define("DS/Layouts/GridEngine",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Layouts/GridEngineCellAbstract","DS/Utilities/Data","DS/Core/ActionsStack","DS/Controls/Gauge","DS/Utilities/Debug","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","UWA/Class","DS/Utilities/Array","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager"],function(e,n,j,l,L,F,o,I,w,i,f,y,x,h,b,D,t,g,a,p,K,A){var M="COLUMN_HEADER_CLICK";var N="EVT_CELL_CREATION";var k="EVT_CELL_DESTRUCTION";var m="POOL_UPDATE";var E=false;var v=false;var G=false;var z=false;var c=false;var r=0;var u=false;var s=0;var d=t.Engine;var J=(d.ie||d.chrome);var B=21474836;function H(T,X,Z){if(Z===undefined){Z=1}var U=X?T.currentTarget:(T.target||T.srcElement),P=U.currentStyle||window.getComputedStyle(U,null),Y=parseInt(P.borderLeftWidth,10),W=parseInt(P.borderTopWidth,10),V=U.getBoundingClientRect(),Q=T.changedTouches&&T.changedTouches.length?T.changedTouches[0].clientX:T.clientX,O=T.changedTouches&&T.changedTouches.length?T.changedTouches[0].clientY:T.clientY,S=Q*Z-Y-V.left,R=O*Z-W-V.top;return{offsetX:S,offsetY:R}}function C(Q,P){var O=Q;if(O){var R=(" "+O.className+" ").replace(/[\n\t]/g," ").indexOf(" "+P+" ")>-1;if(R){return O}else{return C(O.parentNode,P)}}else{}}var q=L.extend({defaultOptions:{model:null,parent:null,defaultCellMouseWidth:null,defaultCellMouseHeight:null,defaultCellTouchWidth:null,defaultCellTouchHeight:null,defaultCellWidth:100,defaultCellHeight:28,useDynamicCellSpacing:false,allowUnsafeHTMLContent:undefined,shouldCellAllowUnsafeHTMLContentAt:function(O){return O.manager.options.allowUnsafeHTMLContent},cellClass:f,showRowsHeader:false,showColumnsHeader:false,headersDimensions:{width:undefined,height:undefined},cellSpacing:{horizontal:0,vertical:0},height:400,infiniteScrolling:false,pageScrollValueTriggeringInfiniteScroll:undefined,virtualModelSize:null,numberOfColumns:null,deferredProcessingTimeout:100,useTransparentScroller:false,showScrollbarsOnHover:false,virtualView:true,performances:{renderingMode:"standard",renderingOptimization:0,preloadPool:false,enableColumnVirtualization:true,useRequestAnimationFrameRendering:false,use2PassRendering:false,resizeDebounceTimeout:100,numberOfRowsFactor:2,numberOfColumnsFactor:2,fullUpdateFactor:0.75,modelViewportFactor:0.5,minimumScrollDistance:0},debug:{minDurationBeforeNextRendering:0}},_applyTouchMode:function(O){this._isTouch=O;if(this._isTouch){if(this.options.defaultCellTouchWidth){this.options.defaultCellWidth=this.options.defaultCellTouchWidth}if(this.options.defaultCellTouchHeight){this.options.defaultCellHeight=this.options.defaultCellTouchHeight}}else{if(this.options.defaultCellMouseWidth){this.options.defaultCellWidth=this.options.defaultCellMouseWidth}if(this.options.defaultCellMouseHeight){this.options.defaultCellHeight=this.options.defaultCellMouseHeight}}if(this._isTouch){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}this.updateView(true)},_setUpdateViewOptions:function(O){if(this._updateViewOptions===undefined){this._updateViewOptions=this._updateViewDefaultOptions}this._updateViewOptions=e.merge(e.clone(this._updateViewDefaultOptions),this._updateViewOptions,O)},destroy:function(){this._freeUpPool(3);this._modelEvents.destroy();this._updateCellsContentDebounced=null;delete this._updateCellsContentDebounced;while(this.options.model.length>0){var S=this.options.model[this.options.model.length-1];while(S&&S.length>0){var O=S[S.length-1];if(O){if(O.destroy){O.destroy()}}S.pop()}this.options.model.pop()}p.clear(this.options.model);this.options=null;for(var R=0;R<this._listOfFreeCells.length;R++){this._listOfFreeCells[R].destroy()}for(var R=0;R<this._listOfFreeRowHeaders.length;R++){this._listOfFreeRowHeaders[R].destroy()}for(var R=0;R<this._listOfFreeColumnHeaders.length;R++){this._listOfFreeColumnHeaders[R].destroy()}p.clear(this._listOfFreeCells);p.clear(this._listOfFreeRowHeaders);p.clear(this._listOfFreeColumnHeaders);if(this.elements.container){var Q=this.elements.container;if(Q.__resizeListeners__){var P=Q.__resizeListeners__.length;for(var R=P-1;R>=0;R--){w.removeResizeListener(Q,Q.__resizeListeners__[R])}}}this._reusableCellContentManager.destroy();this._scrollerDimensions=null;this.removeMe();this._parent()},init:function(P){this._parent(P);var Q=this;this._name="GRIDENGINE";this._buildLayout();this.getContent().setAttribute("platform-name",t.Platform.name);this.__gridengineUUID=e.Utils.getUUID();if(!this.options.defaultCellMouseWidth){this.options.defaultCellMouseWidth=this.options.defaultCellWidth}if(!this.options.defaultCellMouseHeight){this.options.defaultCellMouseHeight=this.options.defaultCellHeight}if(!this.options.defaultCellTouchWidth){this.options.defaultCellTouchWidth=this.options.defaultCellWidth}if(!this.options.defaultCellTouchHeight){this.options.defaultCellTouchHeight=this.options.defaultCellHeight}this._isTouch=false;Object.defineProperty(this,"touchMode",{get:function O(){return Q._isTouch},set:function O(R){Q._applyTouchMode(R)}});this._debugPerformanceIssues=false;this._modelEvents=new o();this.__preventNextUpdateViewCounter=0;this._needToApplyCellContainerSizer=false;this._reusableCellContentManager=new A();this._listOfRenderedCells={};this._listOfFreeCells=[];this._listOfRenderedRowHeaders={};this._listOfFreeRowHeaders=[];this._listOfRenderedColumnHeaders={};this._listOfFreeColumnHeaders=[];this.__lastScrollPos={x:0,y:0};this._onModelRequestCB=null;this._onInfiniteScrollCB=null;this._deltaScrollPositionFromBeginning={x:0,y:0};this._onRequestRowHeaderCB=function(T){var R=T.virtualRowID;var S=R.toString();if(T.cellView.getContent){T.cellView.getContent().innerText=S}};this._onRequestColumnHeaderCB=function(T){var R=T.virtualColumnID;var S=R.toString();if(T.cellView.getContent){T.cellView.getContent().setText(S)}};this._onInternalRequestRowHeaderCB=function(R){if(this._headersDimension.width>0){this._isRequestingCell=true;if(this._onRequestRowHeaderCB){this._onRequestRowHeaderCB.call(Q,R)}if(R.cellView){var R=R.cellView.getCellInfos();R.cellView.nodeColor.inject(R.cellView.getContent());if(R.nodeModel&&R.nodeModel.options.color&&R.nodeModel.options.color!="initial"){R.cellView.nodeColor.style.background=R.nodeModel.options.color;R.cellView.nodeColor.style.display="";R.cellView.getContent().addClassName("wux-datagrid-cell-with-color")}else{R.cellView.nodeColor.style.display="none";R.cellView.getContent().removeClassName("wux-datagrid-cell-with-color")}}this._isRequestingCell=false}};this._onInternalRequestColumnHeaderCB=function(S){if(this._headersDimension.height>0){this._isRequestingCell=true;if(Q.options.showColumnsHeader&&Q._doesColumnNeedToBeRequested(S.virtualColumnID)){var R=S.cellView.getCellInfos();if(this._onRequestColumnHeaderCB){this._onRequestColumnHeaderCB.call(Q,R)}}this._isRequestingCell=false}};this._onInternalRequestCellCB=function(T){this._isRequestingCell=true;var R=Q.getModelSize();if(T.virtualRowID>=0&&T.virtualRowID<R.numberOfRows&&T.virtualColumnID>=0&&T.virtualColumnID<R.numberOfColumns){var S=T.cellView.getCellInfos();if(Q._onRequestCellCB){if(S.cellModel!==undefined){S.rowID=T.rowID;S.columnID=T.columnID;this._onRequestCellCB.call(Q,S);T.cellView.show(true)}if(Q._toDeferredProcessing){clearTimeout(Q._toDeferredProcessing)}Q._listOfCellFilters.process({actionParamsList:[{virtualRowID:T.virtualRowID,virtualColumnID:T.virtualColumnID,cellView:T.cellView,cellModel:Q.getCellModel(T.virtualRowID,T.virtualColumnID)}],chunckProcess:false})}}this._isRequestingCell=false};this._isMonoDimension=null;this.cellInfosCB=null;this._columnHeadersPool=[];this._updateCounter=0;this._renderOrder=0;this._poolDimensions={};this._numberOfRowsToRemove=0;this._numberOfColumnsToRemove=0;this._listOfCellsToBeUpdated={};this._updateViewDefaultOptions={generatePool:false,detachAllViews:true,updateCells:true,updateColumnsHeaders:true,onPreUpdate:null,onPostUpdate:null};this._updateViewOptions=this._updateViewDefaultOptions;this._listOfCellFilters=new x();this._virtualPos={virtualRowID:-1,virtualColumnID:-1};this._viewportBbox={minRowID:-1,minColumnID:-1,maxRowID:-1,maxColumnID:-1};this._modelSize={numberOfRows:0,numberOfColumns:0};this._poolContainerSize={};this._poolSize={numberOfRows:0,numberOfColumns:0};this._listenResize=true;if(this.options.model){this.loadModel(this.options.model,true)}this._observeEvents();this.removeMe=function(){Q=null}},_observeEvents:function(){var O=false;var P=this;this.onReady(function(){if(O===false){O=true;var Q={timeStamp:0,target:null,type:null};this.elements.container.addEvent(i.POINTERUP,function(U){if(U.originalEvent){var T={timeStamp:U.originalEvent.timeStamp,target:U.originalEvent.target,type:U.originalEvent.type};if(!(T.timeStamp===Q.timeStamp&&T.target===Q.target&&T.type==="mouseup"&&Q.type==="touchend")){Q={timeStamp:U.originalEvent.timeStamp,target:U.originalEvent.target,type:U.originalEvent.type};var S=C(U.target,"wux-datagrid-cell");if(U.which===1&&S&&S.dsView){var V=S.dsView.getCellInfos();var W=V.cellView.getVirtualCoordinates();var R=P.getCellModel(W.virtualRowID,W.virtualColumnID);if(R!==undefined){P._modelEvents.publish({event:"CLICK",context:R,data:V.cellView.getCellInfos()})}}}}});this.elements.container.addEvent(i.POINTERDOWN,function(S){var R=C(S.target,"wux-datagrid-cell");if(S.which===1&&R&&R.dsView){var T=R.dsView.getCellInfos();T.event=S;if(T.cellModel!==undefined){P._modelEvents.publish({event:"pointerDown",context:T.cellModel,data:T})}}})}})},registerReusableCellContent:function(O){this._reusableCellContentManager.register(O)},_reuseCellContent:function(O,P){var Q=this._reusableCellContentManager.use(O,P);P._setReusableContent(Q.component);return Q.component},_processModelRequest:function(P){var O=this;if(!O._isRequestingModelUpdate&&O._onModelRequestCB){O._isRequestingModelUpdate=true;setTimeout(function(){if(O._onModelRequestCBisAsync){O._modelEvents.subscribe({event:"modelRequestDone"},function(){if(P){O.initialize(true);O.updateView(true)}O._isRequestingModelUpdate=false})}var Q=O.getVirtualViewport();O._modelViewPort={minRowID:Math.max(0,Q.minRowID-O.getPoolNumberOfRows()*O.options.performances.modelViewportFactor),maxRowID:Math.ceil(Q.maxRowID+O.getPoolNumberOfRows()*O.options.performances.modelViewportFactor),minColumnID:Math.max(0,Q.minColumnID-O.getPoolNumberOfColumns()*O.options.performances.modelViewportFactor),maxColumnID:Math.ceil(Q.maxColumnID+O.getPoolNumberOfColumns()*O.options.performances.modelViewportFactor)};O._onModelRequestCB.call(O,{model:O.options.model,virtualRowID:Q.maxRowID,virtualColumnID:Q.maxColumnID,modelViewPort:O._modelViewPort});if(!O._onModelRequestCBisAsync){if(P){O.initialize(true);O.updateView(true)}O._isRequestingModelUpdate=false}},1)}},_computeModelSize:function(R){var Q=this;var O;var P;Q._checkIfMonoDimension();if(!Q._isMonoDimension){O=Q.options.model.length;P=Q.options.model[this._getModelMinRowID()]?Q.options.model[this._getModelMinRowID()].length:0}else{if(Q.options.numberOfColumns){P=Q.options.numberOfColumns}else{P=Math.floor(Q.getContent().getDimensions().width/Q._getCellWidth());if(Q.options.model.length>0&&Q.options.model.length<P){P=Q.options.model.length}}}if(Q.options.model.length>0&&P===0){P=1}Q._numberOfColumns=P;Q._modelSize.numberOfColumns=Q._numberOfColumns;if(Q._isMonoDimension){O=P!==0?Math.ceil(Q.options.model.length/P):0}if(Q.options.model.length>0&&O===0){O=1}Q._modelSize.numberOfRows=O;if(v){console.warn("[ ] - compute model size",O,"x",P)}if(this.options.virtualModelSize===null||R){Q.setCellsContainerSize({width:P*Q._getCellWidth(),height:O*Q._getCellHeight()},R)}else{Q.setCellsContainerSize({width:this.options.virtualModelSize.numberOfColumns*Q._getCellWidth(),height:this.options.virtualModelSize.numberOfRows*Q._getCellHeight()},R)}return{numberOfRows:O,numberOfColumns:P}},prepareUpdateView:function(){if(this._updateCounter===0&&this.elements.container){this._willBeUpdated()}this._updateCounter++;if(u){s++;console.group("view_transaction_"+s);console.log("-- prepare --")}},_willBeUpdated:function(){},_hasBeenUpdated:function(){this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:false}})},pushUpdateView:function(O){if(u){console.log("-- push --");console.groupEnd("Transaction_"+s)}this._updateCounter--;if(this._updateCounter===0){if(this.__preventNextUpdateViewCounter===0){this.updateView(O)}else{this.__preventNextUpdateViewCounter=0;this._hasBeenUpdated()}}if(this._updateCounter<0){console.warn("[WARNING]","You pushed too many updateView")}},lockUI:function(O){O=e.extend({changeOpacity:true},O);if(!this.__preventFFLockUIWhenScrollOnDragOver){this.getScroller().getContent().addClassName("wux-ui-locked")}this.getScroller().getContent().setAttribute("wux-opacity",O.changeOpacity)},unlockUI:function(){this.getScroller().getContent().removeClassName("wux-ui-locked");this.getScroller().getContent().removeAttribute("wux-opacity")},_preventNextUpdateView:function(){if(v){console.warn("[!] - Prevent next UpdateView")}this.__preventNextUpdateViewCounter=1},_unpreventNextUpdateView:function(){if(v){console.warn("[!] - UnPrevent next UpdateView")}this.__preventNextUpdateViewCounter=0},removeRow:function(O){this.prepareUpdateView();this.options.model.splice(O,1);this.pushUpdateView(true)},loadModel:function(O,T){var S=this;if(T===undefined){T=false}if(!T){this._destroyPool();if(!O){O=this.options.model}var R=O.length;if(R>=0){for(var Q=0;Q<R;Q++){var P=O[Q].length;if(P>=0){O[Q]=[]}}}this.options.model=[]}this.options.model=O;this._gridDimension={width:"100%",height:this.options.height};this._adjustLayout();this._computeModelSize();if(T){this._adjustLayout();this._computeModelSize();this._alreadyRendered=false;w.onNodeRendered(S.elements.container,function(){if(S._alreadyRendered===false){S._alreadyRendered=true;if(S.options.model.length){if(S.options.model.length&&(S.options.model[0]===undefined||(S.options.model[0]!==undefined&&!S.options.model[0].length))){S._isMonoDimension=true;S.elements.container.setAttribute("is-mono-dimensional","true")}else{S._isMonoDimension=false;S.elements.container.setAttribute("is-mono-dimensional","false")}}S._computeModelSize();if(S.options.performances.preloadPool===true){S.__preloadPool()}S.getViewportDimensions(true);S.initialize();if(S.options.useDynamicCellSpacing){S._computeDynamicCellSpacing()}S.runEngine();if(S.getScroller()){S._scrollerDimensions=S.getScroller().getContent().getDimensions()}S._heavyDataColumnModelRequest("onReady");S._onEndResizeOrOnReadyModelCompletionRequest("onReady");S._modelEvents.publish({event:"READY",context:S});var U=document.createEvent("Event");U.initEvent("dimensionsChanged",true,false);S.getContent().dispatchEvent(U)}else{S._computeModelSize();S.__cachedScrollPos={x:0,y:0};S.updateView(true)}});if(!S.options.manageHeight){w.addEndResizeListener(this.elements.container,S._endResizeCallback.bind(this),this.options.performances.resizeDebounceTimeout)}}},_endResizeCallback:function(){var P=this;if(P.getContent()){if(this._debugPerformanceIssues){console.log("["+P._name+"]:resize")}if(P.getScroller()){P._scrollerDimensions=P.getScroller().getContent().getDimensions()}P.getViewportDimensions(true);P._gridDimension={width:"100%",height:P.elements.container.getDimensions().height};if(P.options.useDynamicCellSpacing){P._computeDynamicCellSpacing()}P._adjustLayout();P._freeUpPool(2);P._computePoolSize();P._renderViewPort(true);P._onEndResizeOrOnReadyModelCompletionRequest("onResize");P._modelEvents.publish({event:"RESIZE",context:P,data:P.getContent().getDimensions()});var O=document.createEvent("Event");O.initEvent("dimensionsChanged",true,false);P.getContent().dispatchEvent(O)}},_heavyDataColumnModelRequest:function(X,O){var T=this;if(T._onHeavyDataColumnModelRequestCB){var V=[];var S=[];T.processPoolCells(function(Y){var Z=Y.cellView.getCellInfos();if(S.indexOf(Z.virtualRowID)===-1){V.push(Z.nodeModel);S.push(Z.virtualRowID)}});var R=this.getVirtualViewport(false);var W=R.minColumnID;var Q=R.maxColumnID;var P=(X=="showColumn")&&O&&O.columnID?O.columnID:undefined;if(P&&(P<W||P>Q)){return}var U={shownColumnID:P,minVisibleColumnID:W,maxVisibleColumnID:Q};if(V.length){T._onHeavyDataColumnModelRequestCB.call(T,{displayNodesArray:V,context:X,data:U})}}},_onEndResizeOrOnReadyModelCompletionRequest:function(S){var Q=this;if(Q._onEndResizeOrOnReadyModelRequestCB&&Q.options.infiniteScrolling){var P=Q.getViewportDimensions(true);var R=Math.floor((P.width-Q.options.cellSpacing.horizontal)/(Q.options.defaultCellWidth+Q.options.cellSpacing.horizontal));var O=Math.ceil((P.height-Q.options.cellSpacing.vertical)/(Q.options.defaultCellHeight+Q.options.cellSpacing.vertical));Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=true;setTimeout(function(){if(Q._onEndResizeOrOnReadyModelRequestCBisAsync){Q._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},function(){Q.initialize(true,true);Q.updateView(true);Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=false})}Q._onEndResizeOrOnReadyModelRequestCB.call(Q,{model:Q.options.model,RowMaxNumber:O,ColumnsMaxNumber:R,viewportDimensions:P,context:S});if(!Q._onEndResizeOrOnReadyModelRequestCBisAsync){Q.initialize(true);Q.updateView(true);Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=false}},1)}},_checkIfMonoDimension:function(){var P=this;if(this._isMonoDimension===null){var O=this.getVirtualViewport();if(P.options.model.length>0){if(P.options.model.length&&(P.options.model[O.minRowID]===undefined||(P.options.model[O.minRowID]!==undefined&&!P.options.model[O.minRowID].length))){P._isMonoDimension=true;P.elements.container.setAttribute("is-mono-dimensional","true")}else{P._isMonoDimension=false;P.elements.container.setAttribute("is-mono-dimensional","false")}}else{this._isMonoDimension=null}}if(v){console.warn("model is mono dimension",P._isMonoDimension)}},_adjustLayout:function(){var O=this;if(O.options.headersDimensions.width||O.options.headersDimensions.height){O._setHeadersDimensions({width:O.options.showRowsHeader?O.options.headersDimensions.width:0,height:O.options.showColumnsHeader?O.options.headersDimensions.height:0})}else{O._setHeadersDimensions({width:O.options.showRowsHeader?O._getCellWidth():0,height:O.options.showColumnsHeader?O._getCellHeight():0})}},onGridResize:function(O){return this._modelEvents.subscribe({event:"RESIZE"},O)},onReady:function(O){if(this._alreadyRendered){return O.call(this)}else{return this._modelEvents.subscribe({event:"READY"},O)}},onPerformanceAnalysisAvailbale:function(O){return this._modelEvents.subscribe({event:"performanceAnalysisAvailable"},O)},initialize:function(S,R){var Q=this;if(!R){Q.__cachedScrollPos={x:0,y:0};Q.__cachedScrollDistance=0}var O=Q.options.model.length;var P;if(Q.options.model[0]&&Q.options.model[0].length){P=Q.options.model[0].length}else{if(Q.options.numberOfColumns){P=Q._numberOfColumns}else{P=Math.floor(Q.getContent().getDimensions().width/Q._getCellWidth())}}this.updateModelSize({numberOfRows:O,numberOfColumns:P});if(!S){Q._generatePool();Q._setVirtualPosition({virtualRowID:0,virtualColumnID:0})}},_setVirtualPosition:function(P,O){e.extend(this._virtualPos,P);this._computeVirtualViewport(O)},_computeVirtualViewportFromScrollPosition:function(){var Q=this._getVirtualPositionFromScrollPosition();var R=this.getPoolNumberOfRows();var S=this.getPoolNumberOfColumns();Q.rowID=Q.rowID+Math.floor(R/this.options.performances.numberOfRowsFactor/2);Q.columnID=Q.columnID+Math.floor(S/this.options.performances.numberOfColumnsFactor/2);var P=Math.floor(R/2);var O=Math.floor(S/2);var T={minRowID:Math.max(Q.rowID-P,0),maxRowID:Math.min(Q.rowID-P+R,this._modelSize.numberOfRows-1),minColumnID:Math.max(Q.columnID-O,0),maxColumnID:Math.min(Q.columnID-O+S,this._modelSize.numberOfColumns-1)};return T},_computeVirtualViewport:function(){var W=this.getViewportDimensions();var X=this.getScrollerPosition();var T=this.getModelSize();var U=T.numberOfRows;var O=T.numberOfColumns;var P=2;var V=Math.floor(X.y/this._getCellHeight())-P;var Q=Math.floor((X.y+W.height)/this._getCellHeight())+P;var S=Math.floor(X.x/this._getCellWidth())-P;var R=Math.floor((X.x+W.width)/this._getCellWidth())+P;V=Math.max(0,V);Q=Math.min(Q,U-1);S=Math.max(0,S);R=Math.min(R,O-1);this._viewportBbox={minRowID:V,maxRowID:Q,minColumnID:S,maxColumnID:R};this._virtualPos={virtualRowID:this._viewportBbox.minRowID,virtualColumnID:this._viewportBbox.minColumnID};return this._viewportBbox},_computeDeltaViewport:function(){var O=this._viewportBbox;var P=this._computeVirtualViewport();return{minRowID:P.minRowID-O.minRowID,maxRowID:P.maxRowID-O.maxRowID,minColumnID:P.minColumnID-O.minColumnID,maxColumnID:P.maxColumnID-O.maxColumnID}},getVirtualViewport:function(O){return this._viewportBbox},setCellsContainerSize:function(P,O){if(O===undefined){O=true}if((this._poolContainerSize.width!==P.width&&P.width>=0)||(this._poolContainerSize.height!==P.height&&P.height>=0)){e.extend(this._poolContainerSize,P);this._needToApplyCellContainerSizer=true}},getCellsContainerSize:function(){return this._poolContainerSize},updateModelSize:function(Q){var O=this.options.virtualModelSize;if(O!==null){this._modelSize.numberOfRows=O.numberOfRows;this._modelSize.numberOfColumns=O.numberOfColumns}else{if(Q){this._modelSize.numberOfRows=Q.numberOfRows;this._modelSize.numberOfColumns=Q.numberOfColumns;this._numberOfColumns=Q.numberOfColumns}else{var P=this.options.model.length;var R;if(this.options.model[0]&&this.options.model[0].length){R=this.options.model[0].length}else{if(this.options.numberOfColumns){R=this.options.numberOfColumns;this._numberOfColumns=this.options.numberOfColumns}else{R=Math.floor(this._viewportDimensions.width/this._getCellWidth());if(R===0){R=1}}}this.updateModelSize({numberOfRows:P,numberOfColumns:R})}}},getModelSize:function(O){if(O===undefined){O=true}if(O){this.updateModelSize()}return this._modelSize},updateHeight:function(O){this.elements.container.setStyle("height",O==="auto"?"100%":O)},_buildLayout:function(){this.elements.container=new e.Element("div",{"class":"wux-layouts-gridengine",styles:{overflow:"hidden",width:"100%",position:"relative",height:this.options.height==="auto"?"100%":this.options.height}});if(this.options.height==="auto"){w.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"})}this.elements.topHeaderLayout=new e.Element("ul",{"class":"wux-ui-stack-h",styles:{display:"block",position:"relative",zIndex:400002}}).inject(this.elements.container);this.elements.corner=new e.Element("li",{"class":"wux-layouts-gridengine-corner"}).inject(this.elements.topHeaderLayout);this.elements.columnsHeaderContainer=new e.Element("li",{"class":"wux-layouts-gridengine-columns-header-container",styles:{position:"absolute",top:0,bottom:0,right:0,whiteSpace:"nowrap",overflow:"hidden"}}).inject(this.elements.topHeaderLayout);this.elements.columnsHeaderContainerRel=new e.Element("div",{"class":"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.columnsHeaderContainer);this.elements.mainLayout=new e.Element("ul",{"class":"wux-ui-stack-h",styles:{display:"block",position:"relative"}}).inject(this.elements.container);this.elements.rowsHeaderContainer=new e.Element("li",{"class":"wux-layouts-gridengine-rows-header-container",styles:{position:"absolute",top:0,bottom:0,left:0,overflow:"hidden"}}).inject(this.elements.mainLayout);this.elements.rowsHeaderContainerRel=new e.Element("div",{"class":"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.rowsHeaderContainer);this.elements.gridHeaderContainer=new e.Element("li",{"class":"",styles:{position:"absolute",top:0,bottom:0,right:0}}).inject(this.elements.mainLayout);this.elements.gridHeaderContainerRel=new e.Element("div",{"class":"wux-layouts-gridengine-scroller-container","show-at-hover":this.options.showScrollbarsOnHover,styles:{position:"relative",}}).inject(this.elements.gridHeaderContainer);this.elements.poolContainerRel=new e.Element("div",{"class":"wux-layouts-gridengine-poolcontainer-rel",styles:{position:"relative",height:"100%",width:"100%"}});this.elements.poolContainerRelDettachable=new e.Element("div",{}).inject(this.elements.poolContainerRel);this.elements.poolContainerRel.inject(this.elements.container)},_beginUpdate:function(){if(E&&!this._hasBeenDetached){this._hasBeenDetached=true;if(this.elements.poolContainerRelDettachable){this.elements.poolContainerRelDettachable.hide()}}},_endUpdate:function(){if(E&&this._hasBeenDetached===true){if(this.elements.poolContainerRelDettachable){this.elements.poolContainerRelDettachable.show()}this._hasBeenDetached=false}},setHeadersDimensions:function(O){this._setHeadersDimensions(O)},_setHeadersDimensions:function(P){if(P.width!==undefined){if(P.width===0){this.elements.corner.hide();this.elements.rowsHeaderContainer.hide()}else{this.elements.corner.show();this.elements.rowsHeaderContainer.show()}}if(P.height!==undefined){if(P.height===0){this.elements.columnsHeaderContainer.hide()}else{this.elements.columnsHeaderContainer.show()}}w.setStyles(this.elements.rowsHeaderContainer,{width:P.width});w.setStyles(this.elements.gridHeaderContainer,{left:P.width});w.setStyles(this.elements.mainLayout,{position:"absolute",top:P.height,left:0,right:0,bottom:0});var Q=0;if(this.getScroller()){var O=this.getScroller().getPosition();Q=O.x}w.setStyles(this.elements.columnsHeaderContainer,{left:P.width+Q});w.setStyles(this.elements.corner,{width:P.width});w.setStyles(this.elements.topHeaderLayout,{height:P.height});this._headersDimension=P},getHeadersDimensions:function(){if(this._headersDimension.width===undefined){this._headersDimension.width=this._getCellWidth()}if(this._headersDimension.height===undefined){this._headersDimension.height=this._getCellHeight()}return this._headersDimension},getCellModel:function(Q,P){if(P===undefined){if(this._isMonoDimension){return this.options.model[Q]}else{return this.options.model[Math.floor(Q/this._numberOfColumns)][Q%this._numberOfColumns]}}else{if(this._isMonoDimension){return this.options.model[Q*this._numberOfColumns+P]}else{if(P===-1){return undefined}else{if(Q===-1){return undefined}else{var O=this.getModelSize();if(Q<O.numberOfRows&&P<O.numberOfColumns&&this.options.model[Q]){return this.options.model[Q][P]}}}}}},onModelRequest:function(O){this._onModelRequestCBisAsync=false;this._onModelRequestCB=O},onModelRequestAsync:function(O){this._onModelRequestCBisAsync=true;this._onModelRequestCB=O},modelRequestAsyncDone:function(){return this._modelEvents.publish({event:"modelRequestDone",context:this})},onEndResizeOrOnReadyModelRequest:function(O){this._onEndResizeOrOnReadyModelRequestCBisAsync=false;this._onEndResizeOrOnReadyModelRequestCB=O},onEndResizeOrOnReadyModelRequestAsync:function(O){this._onEndResizeOrOnReadyModelRequestCBisAsync=true;this._onEndResizeOrOnReadyModelRequestCB=O},EndResizeOrOnReadyModelRequestAsyncDone:function(){return this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},onInfiniteScroll:function(O){this._onInfiniteScrollCBisAsync=false;this._onInfiniteScrollCB=O},onInfiniteScrollAsync:function(O){this._onInfiniteScrollCBisAsync=true;this._onInfiniteScrollCB=O},infiniteScrollAsyncProcessDone:function(){return this._modelEvents.publish({event:"BottomReachedDone",context:this})},onHeavyDataColumnModelRequest:function(O){this._onHeavyDataColumnModelRequestCB=O},onCellRequest:function(O){this._onRequestCellCB=O},addEventListener:function(P,S,O){var Q=this;var R=function(U){if(!Q._isRequestingCell){var T=w.firstParentWithClass(U.target,"wux-datagrid-cell");if(T){var V=T.dsView.getCellInfos();S(U,V)}else{S(U)}}};Q.getContent().addEventListener(P,R,O);return R},removeEventListener:function(P,Q,O){this.getContent().removeEventListener(P,Q,O)},onCellClick:function(O){return this._modelEvents.subscribe({event:"CLICK"},O)},onCellPointerDown:function(O){return this._modelEvents.subscribe({event:"pointerDown"},O)},onRowHeaderRequest:function(O){this._onRequestRowHeaderCB=O},onColumnHeaderRequest:function(O){this._onRequestColumnHeaderCB=O},getScroller:function(){return this.elements.scroller},getScrollerPosition:function(P){if(this.__cachedScrollPos&&!P){return this.__cachedScrollPos}else{if(this.getScroller()){var O=this.getScroller()._scrollPosition;return{x:-O.x,y:-O.y}}else{return{x:0,y:0}}}},_syncScrollPositionToHeaders:function(){var O=this.getScrollerPosition(true);w.setStyles(this.elements.columnsHeaderContainer,{left:-O.x+this._headersDimension.width});w.setStyles(this.elements.rowsHeaderContainer,{top:-O.y})},setScrollerPosition:function(O,P){this._computePoolSize();if(this.getPoolNumberOfRows()===0&&this.getPoolNumberOfColumns()===0){this.onPostUpdateViewOnce(function(){this._computePoolSize();this._applyScrollerPosition(O)})}else{this._applyScrollerPosition(O,P)}},_applyScrollerPosition:function(O,P){if(this.getScroller()){if(!P){this.prepareUpdateView()}O.x=O.x||0;O.y=O.y||0;this.getScroller().elements.container.scrollLeft=O.x;this.getScroller().elements.container.scrollTop=O.y;if(!P){this.pushUpdateView(true)}}},getRowPosition:function(O){return(O)*this._getCellHeight()},getColumnPosition:function(O){return(O)*this._getCellWidth()},_doesColumnNeedToBeRequested:function(O){return true},_getVirtualPositionFromScrollPosition:function(O){if(O===undefined){if(this.getScroller()){O=this.getScrollerPosition()}else{O={x:0,y:0}}}return{rowID:parseInt(Math.abs(O.y)/this._getCellHeight(),10),columnID:parseInt(Math.abs(O.x)/this._getCellWidth(),10)}},_getCoordinatesFromEvent:function(S){var P=this.getScrollerPosition();var V=this.getHeadersDimensions();var R=this.elements.container.style.zoom?parseFloat(this.elements.container.style.zoom,10):1;var T=1+(1-R);var Q=H(S,true,T);var O=(Q.offsetX+P.x)-(V.width*R);var U=(Q.offsetY+P.y)-(V.height*R);if(Q.offsetX<V.width*R){return{rowID:this._getVirtualPositionFromScrollPosition({x:O,y:U}).rowID,columnID:-1}}else{if(Q.offsetY<V.height*R){return{columnID:this._getVirtualPositionFromScrollPosition({x:O,y:U}).columnID,rowID:-1}}else{return this._getVirtualPositionFromScrollPosition({x:O,y:U})}}},_getRowIDFromEvent:function(O){return this._getCoordinatesFromEvent(O).rowID},_getColumnIDFromEvent:function(O){return this._getCoordinatesFromEvent(O).rowID},_getCellInfosFromDom:function(O){if(O&&O.dsView){var P=O.dsView.getCellInfos();P.rowID=P.virtualRowID;P.columnID=P.virtualColumnID;return P}return{virtualRowID:undefined,virtualColumnID:undefined,cellModel:undefined,cellView:undefined,dataIndex:undefined,typeRepresentation:undefined,manager:undefined,isHeader:undefined}},_getCellInfosFromEventTarget:function(P){var O=C(P.target,"wux-datagrid-cell");return this._getCellInfosFromDom(O)},_draggable:function(Q){var P=false;var R=this;var S=function(T){if(T.type==="touchstart"){}P=true;var U=R._getCellInfosFromEventTarget(T);if(U){Q.begin(T,U)}};var O=function(T){P=false;var U=R._getCoordinatesFromEvent(T);if(U){Q.end(T,U)}};this.elements.container.addEventListener("touchstart",S);this.elements.container.addEventListener("mousedown",S);this.elements.container.addEventListener(i.POINTERMOVE,function(T){if(P){var U=R._getCoordinatesFromEvent(T);if(U){Q.drag(T,U)}}});this.elements.container.addEventListener("mouseup",O);this.elements.container.addEventListener("touchend",O)},runEngine:function(){var R=this;this.elements.scroller=new I(this.elements.poolContainerRel,{eventPeriod:0,useUWAScroller:this.options.useTransparentScroller}).inject(this.elements.gridHeaderContainerRel);w.setStyles(this.elements.scroller.getContent(),{position:"absolute",left:0,top:0,bottom:0,width:"100%",height:"100%"});R._hasBeenUpdated();var P;R.getScroller().getContent().addEventListener(i.POINTERMOVE,function(S){if(i.isTouchEvent(S)){R._preventSelectionForTouchScroll=true;clearTimeout(P);P=setTimeout(function(){R._preventSelectionForTouchScroll=false},2000)}},false);var O=0;this.elements.scroller.onScrollBegin(function(){R._beginScrollPosition=this.getPosition();R._scrollPositionFromBeginning={x:0,y:0};R.lockUI({changeOpacity:false})});this.elements.scroller.onScroll(function Q(ab){R._deltaScrollPositionFromBeginning=this.getDeltaScrollPositionFromBeginning();var ae=R.getScrollerPosition(true);R._syncScrollPositionToHeaders();R.__cachedScrollDistance=Math.sqrt((ae.x-R.__cachedScrollPos.x)*(ae.x-R.__cachedScrollPos.x)+(ae.y-R.__cachedScrollPos.y)*(ae.y-R.__cachedScrollPos.y));O+=R.__cachedScrollDistance;var X={x:ae.x-R.__cachedScrollPos.x,y:ae.y-R.__cachedScrollPos.y};R.__cachedScrollPos=ae;if(O>=R.options.performances.minimumScrollDistance){O=0;if(G){console.log("-")}var U=this.getPosition();R._scrollDirection=X;R.__lastScrollPos=U;var af=5*parseInt(R._getCellHeight(),10);var ag=5*parseInt(R._getCellWidth(),10);var ac=R.getCellsContainerSize();var Z=ac.height-R._viewportDimensions.height;if(Z-af>0){Z=Z-af}var aa=ac.width-R._viewportDimensions.width;if(aa-ag>0){aa=aa-ag}var W=false,T=false,V=false,S=false;var ad=R.options.pageScrollValueTriggeringInfiniteScroll;if(ad!=undefined){if(e.is(ad,"number")){if(ad<=0||ad>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1."}T=(Math.abs(ae.y)+ad*R._viewportDimensions.height>=ad*ac.height);S=(Math.abs(ae.y)>=Z&&Z>0);W=(Math.abs(ae.x)>=aa&&aa>0)}else{if(e.is(ad,"object")){if(ad.x!=undefined){if(ad.x<=0||ad.x>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x option. Please provide a value strictly between 0 and 1."}W=(Math.abs(ae.x)+ad.x*R._viewportDimensions.width>=ad.x*ac.width);V=(Math.abs(ae.x)>=aa&&aa>0)}else{W=(Math.abs(ae.x)>=aa&&aa>0)}if(ad.y!=undefined){if(ad.y<=0||ad.y>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y option. Please provide a value strictly between 0 and 1."}T=(Math.abs(ae.y)+ad.y*R._viewportDimensions.height>=ad.y*ac.height);S=(Math.abs(ae.y)>=Z&&Z>0)}else{T=(Math.abs(ae.y)>=Z&&Z>0)}}}}else{W=(Math.abs(ae.x)>=aa&&aa>0);T=(Math.abs(ae.y)>=Z&&Z>0)}if((X.x>0&&W)||(X.y>0&&T)){if(R._onInfiniteScrollCB&&R.options.infiniteScrolling&&(X.x>=0||X.y>=0)){if(!R._isRequestingModelUpdate){R._isRequestingModelUpdate=true;setTimeout(function(){if(R._onInfiniteScrollCBisAsync){R._modelEvents.subscribeOnce({event:"BottomReachedDone"},function(){R.prepareUpdateView();R.pushUpdateView(true);R._isRequestingModelUpdate=false})}else{R.prepareUpdateView()}var ah=R.getVirtualViewport();R._onInfiniteScrollCB.call(R,{reachBottom:T,reachRight:W,model:R.options.model,virtualRowID:ah.maxRowID,virtualColumnID:ah.maxColumnID,isVeryCloseFromRight:V,isVeryCloseFromBottom:S});if(!R._onInfiniteScrollCBisAsync){R.initialize(true);R._computeModelSize();R._isRequestingModelUpdate=false}},1)}}}var Y=function(){switch(R.options.performances.renderingMode){case"adaptive":R.updateView();break;case"standard":var aj=R.getViewportDimensions();if(Math.abs(U.y)===ac.height-R._gridDimension.height){R.updateView()}else{var ah=Math.abs(X.y)<=R.options.performances.fullUpdateFactor*aj.height;var ai=Math.abs(X.x)<=R.options.performances.fullUpdateFactor*aj.width;if(!R._isDebouncingUpdateView&&ah&&ai){R.iterativeUpdate(U,X)}else{R._freeUpPool(1);R.updateView()}}break}};if(R.options.performances.useRequestAnimationFrameRendering){K.addTask({namespace:"wux-gridengine-render"+R._uuid,callback:function(){Y()},taskArgs:[]},"wux-gridengine-render"+R._uuid)}else{Y()}}});this.elements.scroller.onScrollEnd(function(){R._preventSelectionForTouchScroll=false;if(R._deltaScrollPositionFromBeginning.x!==0||R._deltaScrollPositionFromBeginning.y!==0){if(R._deltaScrollPositionFromBeginning.y!==0||(R._deltaScrollPositionFromBeginning.x!==0&&R.options.performances.enableColumnVirtualization)){R._heavyDataColumnModelRequest("onScrollEnd")}}if(R.options.performances.renderingMode==="adaptive"){R._renderViewPort()}if(!R._preventScrollEnd){R._preventFullUpdate=false;R._requestModelIfNeeded(true)}else{R._preventScrollEnd=false}R.unlockUI()});this._modelEvents.subscribe({event:"UPDATE_VIEW"},function(){R._renderViewPort()});R._renderViewPort(true)},_applyCellsContainerSizeIfNeeded:function(){if(this._needToApplyCellContainerSizer===true){w.setStyles(this.elements.poolContainerRel,{width:this._poolContainerSize.width,height:this._poolContainerSize.height<=0?1:this._poolContainerSize.height});if((!d.chrome||window.navigator.userAgent.indexOf("Edge"))&&this._poolContainerSize.height>B){this.elements.poolContainerRel.style.height="1e+07px"}this._needToApplyCellContainerSizer=false;if(this._viewportDimensions.width<this._poolContainerSize.width){this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",true)}else{this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",false)}if(this._viewportDimensions.height<this._poolContainerSize.height){this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",true)}else{this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",false)}}},getListOfCellsInVisibleViewport:function(R){if(R===undefined){R={}}var O=this._computeVirtualViewport();var Q={};for(var S=O.minColumnID;S<=O.maxColumnID;S++){var T="-1_"+S;Q[T]=true;if(R.callback){R.callback({virtualRowID:-1,virtualColumnID:S})}}for(var S=O.minRowID;S<=O.maxRowID;S++){var T=S+"_-1";Q[T]=true;if(R.callback){R.callback({virtualRowID:S,virtualColumnID:-1})}}for(var S=O.minRowID;S<=O.maxRowID;S++){for(var P=O.minColumnID;P<=O.maxColumnID;P++){var T=S+"_"+P;Q[T]=true;if(R.callback){R.callback({virtualRowID:S,virtualColumnID:P})}}}return Q},_renderViewPort:function(W){if(this.getScroller()){switch(this.options.performances.renderingMode){case"adaptive":if(this._viewportBboxIsRendering!==true){this._listOfColumnCellPerformances={};this._beginUpdate();if(this._updateViewOptions.onPreUpdate){var R=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null;R.call(this)}this._applyCellsContainerSizeIfNeeded();if(this.options.height==="inherit"){this._applyInheritedHeight()}this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}});if(this._debugPerformanceIssues){console.time("["+this._name+"]:render viewport");window.performance.mark("gridengine_gridengine_renderviewport_begin")}this._viewportBboxIsRendering=true;var O=this.getListOfCellsInVisibleViewport({callback:(function(X){this._renderCell(X)}).bind(this)});for(var V in this._listOfRenderedCells){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}for(var V in this._listOfRenderedRowHeaders){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}for(var V in this._listOfRenderedColumnHeaders){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}this._viewportBboxIsRendering=false;if(this._debugPerformanceIssues){console.timeEnd("["+this._name+"]:render viewport")}this._notifyUpdateViewCompleted()}else{console.log("[E]")}break;case"standard":this._listOfColumnCellPerformances={};this._beginUpdate();if(W){this._freeUpPool(0)}if(this._updateViewOptions.onPreUpdate){var R=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null;R.call(this)}this._applyCellsContainerSizeIfNeeded();if(this.options.height==="inherit"){this._applyInheritedHeight()}this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}});var P=this._getVirtualPositionFromScrollPosition();var T=this.getPoolNumberOfRows();var Q=this.getPoolNumberOfColumns();var P=this._computeVirtualViewport();if(this._debugPerformanceIssues){console.time("["+this._name+"]:render viewport");window.performance.mark("gridengine_gridengine_renderviewport_begin")}this._viewportBboxIsRendering=true;if(this.options.showColumnsHeader===true){this._renderRow(-1)}var S=this.getNumberOfRows();if(this.options.showColumnsHeader===true&&S===0){this._renderRow(0)}for(var U=P.minRowID;U<=this._viewportBbox.maxRowID&&U<S;U++){this._renderRow(U)}this._viewportBboxIsRendering=false;if(this._debugPerformanceIssues){console.timeEnd("["+this._name+"]:render viewport")}this._notifyUpdateViewCompleted();break}}},_notifyUpdateViewCompleted:function(){this._endUpdate();this._validateLayout();if(this._debugPerformanceIssues){console.groupCollapsed("["+this._name+"]:Update View");for(var O in this._listOfColumnCellPerformances){var R=this._listOfColumnCellPerformances[O];var P=R.reduce(function(T,S){return T+S});var Q=P/R.length;console.info("rendering time for column",O+":",Math.round(P*100)/100,"ms . Mean time per cell:",Math.round(Q*1000)/1000,"ms","for",R.length,"cells")}window.performance.mark("gridengine_gridengine_renderviewport_end");this._modelEvents.publish({event:"performanceAnalysisAvailable",context:this,data:this._listOfColumnCellPerformances});this._listOfColumnCellPerformances={};console.groupEnd("["+this._name+"]:Update View")}this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:false}})},_renderColumn:function(T){var R=this;var Q=this.getPoolNumberOfRows();var O=this._viewportBbox;R._renderCell({virtualRowID:-1,virtualColumnID:T});var S=-1;for(var P=0;P<Q&&S<R._modelSize.numberOfRows-1;P++){S=Math.min(R._modelSize.numberOfRows-1,O.minRowID+P);R._renderCell({virtualCellID:S*R._numberOfColumns+T,virtualRowID:S,virtualColumnID:T})}},_renderRowCB:function(S){var Q=this;var O=Q.getVirtualViewport();if(S===-1&&Q.options.showColumnsHeader===true){var R=-1;for(var P=O.minColumnID;P<=O.maxColumnID;P++){Q._renderCell({virtualRowID:S,virtualColumnID:P})}}else{if(S<Q._modelSize.numberOfRows){this.elements.poolContainerRelDettachable.show();if(S>=0&&Q.options.showRowsHeader===true){Q._renderCell({virtualRowID:S,virtualColumnID:-1})}var R=-1;for(var P=O.minColumnID;P<=O.maxColumnID&&R<Q._modelSize.numberOfColumns-1;P++){R=Math.min(Q._modelSize.numberOfColumns-1,P);Q._renderCell({virtualRowID:S,virtualColumnID:P})}Q._lastRenderedRowID=S}else{this.elements.poolContainerRel.setStyle("height","1px");this.elements.poolContainerRelDettachable.hide()}}},_renderRow:function(P){switch(this.options.performances.renderingMode){case"adaptive":if(this._viewportBboxIsRendering!==true){this._renderRowCB(P)}break;case"standard":var O=this;O._renderRowCB(P);break}},_freeUpRow:function(P){for(var O=this._viewportBbox.minColumnID;O<=this._viewportBbox.maxColumnID;O++){this._freeUpCell(P,O)}if(z){console.log(this._listOfFreeCells.length)}},_freeUpPool:function(R){this._lastRenderedRowID=null;if(R===undefined){R=1}var P;for(P in this._listOfRenderedCells){var Q=this._listOfRenderedCells[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeCells.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeCells.unshift(Q)}if(R===0){this._listOfFreeCells.unshift(Q)}delete this._listOfRenderedCells[P]}for(P in this._listOfRenderedRowHeaders){var Q=this._listOfRenderedRowHeaders[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeRowHeaders.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeRowHeaders.unshift(Q)}if(R===0){this._listOfFreeRowHeaders.unshift(Q)}delete this._listOfRenderedRowHeaders[P]}for(P in this._listOfRenderedColumnHeaders){var Q=this._listOfRenderedColumnHeaders[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeColumnHeaders.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeColumnHeaders.unshift(Q)}if(R===0){this._listOfFreeColumnHeaders.unshift(Q)}delete this._listOfRenderedColumnHeaders[P]}var O={0:"flag cells as free",1:"hide cells + flag cells as free",2:"remove cells from dom + flag cells as free"};if(z){console.log("free up pool",O[R])}},_freeUpCellFromIdentifier:function(P){var O=P.split("_");var R=parseInt(O[0],10);var Q=parseInt(O[1],10);return this._freeUpCell(R,Q)},_freeUpCell:function(S,R){var O=S+"_"+R;var Q=this._getListOfRenderedForCellAt({virtualRowID:S,virtualColumnID:R});var T=this._getListOfFreeForCellAt({virtualRowID:S,virtualColumnID:R});if(Q[O]){var P=Q[O];P.getContent().style.display="none";P._clean();P._disposeReusableContent();T.push(P);delete Q[O];if(z){console.log("freeup",O,Q)}}},_getListOfFreeForCellAt:function(P){var O;if(P.virtualRowID!==-1&&P.virtualColumnID!==-1){O=this._listOfFreeCells}else{if(P.virtualRowID===-1){O=this._listOfFreeColumnHeaders}else{if(P.virtualColumnID===-1){O=this._listOfFreeRowHeaders}}}return O},_addToListOfRenderedForCellAt:function(Q,P){var O=Q.virtualRowID+"_"+Q.virtualColumnID;if(Q.virtualRowID!==-1&&Q.virtualColumnID!==-1){this._listOfRenderedCells[O]=P}else{if(Q.virtualRowID===-1){this._listOfRenderedColumnHeaders[O]=P}else{if(Q.virtualColumnID===-1){this._listOfRenderedRowHeaders[O]=P}}}return P},_getListOfRenderedForCellAt:function(P){var O;if(P.virtualRowID!==-1&&P.virtualColumnID!==-1){O=this._listOfRenderedCells}else{if(P.virtualRowID===-1){O=this._listOfRenderedColumnHeaders}else{if(P.virtualColumnID===-1){O=this._listOfRenderedRowHeaders}}}return O},_isCellRendered:function(Q){var P=this._getListOfRenderedForCellAt(Q);var O=Q.virtualRowID+"_"+Q.virtualColumnID;return Boolean(P[O])},_freeUpColumn:function(P){for(var O=this._viewportBbox.minRowID;O<=this._viewportBbox.maxRowID;O++){this._freeUpCell(O,P)}if(z){console.log(this._listOfFreeCells.length)}},__preloadPool:D.debounce(function(){var P=this._poolSizeMax.numberOfRows;var Q=this._poolSizeMax.numberOfColumns;var T=P*Q;var R=Object.keys(this._listOfRenderedCells).length+this._listOfFreeCells.length;var S=T-R;console.log("preload pool",T,"-",R,"=",S);if(S>0){do{if(S%P===0){var O=this.__createRowHeaderCell();O._free();this._listOfFreeRowHeaders.push(O);S--}var O=this.__createCell();O._free();this._listOfFreeCells.push(O);S--}while(S>0)}},10),__createCell:function(){var O=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:this._getCellWidth(),height:this._getCellHeight()});O.POOL_CELL_ID=r++;if(c){O.getContent().setStyles({transition:"all 1s"})}O.inject(this.elements.poolContainerRelDettachable);this._modelEvents.publish({context:O,data:{cellView:O,rowID:-1,columnID:-1},event:N});if(z){console.log("create cell")}return O},__createRowHeaderCell:function(){var P=this.getHeadersDimensions();var O=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:P.width,height:this._getCellHeight(),isHeader:true});O.getContent().addClassName("wux-datagrid-header");O.inject(this.elements.rowsHeaderContainerRel);O.nodeColor=new e.Element("div",{"class":"wux-datagrid-node-color",});this._modelEvents.publish({context:O,data:{cellView:O,rowID:-1,columnID:-1},event:N});if(z){console.log("create row header")}return O},__createColumnHeaderCell:function(){var Q=this.getHeadersDimensions();var P=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:this._getCellWidth(),height:Q.height,isHeader:true});P.getContent().addClassName("wux-datagrid-header");P.inject(this.elements.columnsHeaderContainerRel);var O=this;P.getContent().addEvent(i.POINTERUP,function(){O._modelEvents.subscribe({context:O,data:null,event:M})});this._modelEvents.publish({context:P,data:{cellView:P,rowID:-1,columnID:-1},event:N});if(z){console.log("create column header")}return P},_createCell:function(O){if(O.virtualRowID!==-1&&O.virtualColumnID!==-1){return this.__createCell()}else{if(O.virtualRowID===-1){return this.__createColumnHeaderCell()}else{return this.__createRowHeaderCell()}}},__getCellFromPool:function(R){var P;var O=R.virtualRowID+"_"+R.virtualColumnID;var Q=this._getListOfRenderedForCellAt(R);var S=this._getListOfFreeForCellAt(R);if(this._isCellRendered(R)){P=Q[O];if(z){console.log("reuse already rendered",O)}}else{if(S.length===0){P=this._createCell(R)}else{P=S.pop();if(c){P.getContent().setStyles({background:"rgb(15, 237, 197)",boxShadow:"0 0 10px silver",zIndex:10000})}P.getContent().style.display="block";if(R.virtualRowID!==-1&&R.virtualColumnID!==-1){P.inject(this.elements.poolContainerRelDettachable)}else{if(R.virtualRowID===-1){P.inject(this.elements.columnsHeaderContainerRel)}else{P.inject(this.elements.rowsHeaderContainerRel)}}if(c){setTimeout(function(){P.getContent().setStyles({background:"",boxShadow:"",zIndex:""})},1000)}if(z){console.log("reuse from free cells",O)}}this._addToListOfRenderedForCellAt(R,P)}if(!P){throw"Error cannot get a cell from pool"}return P},_isLayoutValid:function(){return !(this.__layoutIsInvalid===true)},_invalidateLayout:function(){this.__layoutIsInvalid=true},_validateLayout:function(){this.__layoutIsInvalid=false},needToRequestContentAt:function(O){return false},needToRenderCellAt:function(O){if(O.virtualColumnID===-1||O.virtualRowID===-1){return((this.options.showRowsHeader===true)&&(O.virtualColumnID===-1))||((this.options.showColumnsHeader===true)&&(O.virtualRowID===-1))}else{return true}},_renderCell:function(R){if(this.getCellModel(R.virtualRowID,R.virtualColumnID)!==undefined||(R.virtualRowID===-1)||(R.virtualColumnID===-1)){var S=this._isCellRendered(R)===false;if(S||(this.options.performances.renderingMode==="standard")){this._renderCellCB(R)}else{var O=this._isLayoutValid()===false;var P=this.needToRequestContentAt(R);var Q=this.needToRenderCellAt(R);if(this.options.performances.renderingMode==="adaptive"&&((O||P)&&Q)){this._renderCellCB(R)}}}},_renderCellCB:function(T){T.cellView=this.__getCellFromPool(T);var P=this.getPoolNumberOfRows()+1;var S=this.getPoolNumberOfColumns()+1;var O=T.virtualRowID===-1?T.virtualRowID:(T.virtualRowID%P);var Q=T.virtualColumnID===-1?T.virtualColumnID:(T.virtualColumnID%S);T.rowID=O;T.columnID=Q;T.cellID=O*this._numberOfColumns+T.virtualColumnID;var U;if(this._debugPerformanceIssues){if(this._listOfColumnCellPerformances[T.virtualColumnID]===undefined){this._listOfColumnCellPerformances[T.virtualColumnID]=[]}U=window.performance?performance.now():Date.now()}switch(this.options.performances.renderingOptimization){case 1:T.cellView.getContent().style.display="none";break;case 2:T.cellView.getContent().remove();break;default:break}if(G){console.log("c",T)}if(this.options.performances.use2PassRendering){T.cellView.updateInternalParameters()}T.cellView.getContent().style.display="none";T.cellView._setVirtualCoordinates({rowID:T.rowID,columnID:T.columnID,virtualRowID:T.virtualRowID,virtualColumnID:T.virtualColumnID});T.cellView.updateInternalParameters();this.__requestCellContent(T);T.cellView.placeCell();T.cellView.getContent().style.display="";switch(this.options.performances.renderingOptimization){case 1:T.cellView.getContent().style.display="block";break;case 2:if(T.virtualRowID===-1){this.elements.columnsHeaderContainerRel.appendChild(T.cellView.getContent())}else{if(T.virtualColumnID===-1){this.elements.rowsHeaderContainerRel.appendChild(T.cellView.getContent())}else{this.elements.poolContainerRelDettachable.appendChild(T.cellView.getContent())}}break;default:break}if(this._debugPerformanceIssues){var R=window.performance?performance.now():Date.now();this._listOfColumnCellPerformances[T.virtualColumnID].push(R-U)}},__requestCellContent:function(O){if(O.virtualColumnID===-1){if(this._onInternalRequestRowHeaderCB){this._onInternalRequestRowHeaderCB.call(this,O)}}else{if(O.virtualRowID===-1){if(this._onInternalRequestColumnHeaderCB){this._onInternalRequestColumnHeaderCB.call(this,O)}}else{if(this._onInternalRequestCellCB){this._onInternalRequestCellCB.call(this,O)}}}},_enableVisualDebug:function(){c=true},_disableVisualDebug:function(){c=false},enablePerformanceAnalysis:function(O){if(O!==undefined){this._name=O}this._debugPerformanceIssues=true&&J},disablePerformanceAnalysis:function(){this._debugPerformanceIssues=false},isPerformanceAnalysis:function(){return this._debugPerformanceIssues},iterativeUpdate:function(P,O){var Q=this;if(v){console.log(this.options.id,"------ iterative update --------")}Q._requestModelIfNeeded(true);this._deltaViewport=this._computeDeltaViewport();if(O.y>0){Q.shiftDownRecursive(P.y)}if(O.y<0){Q.shiftUpRecursive(P.y)}if(O.x>0){Q.shiftRightRecursive(P.x)}if(O.x<0){Q.shiftLeftRecursive(P.x)}},updateModel:function(O){this._internalUpdateModel(O)},_internalUpdateModel:function(O){if(O){this.options.model=O}this.initialize(true);this.prepareUpdateView();this.pushUpdateView(true)},_requestModelIfNeeded:function(S){var Q=this;var P=Q._modelViewPort&&!(Q._modelViewPort.minRowID<=Q.getVirtualViewport().minRowID&&Q._modelViewPort.maxRowID>=Q.getVirtualViewport().maxRowID);var R=Q._modelViewPort&&!(Q._modelViewPort.minColumnID<=Q.getVirtualViewport().minColumnID&&Q._modelViewPort.maxColumnID>=Q.getVirtualViewport().maxColumnID);var O=Q._modelViewPort&&(P||R);if(Q._modelViewPort===undefined||O){if(v&&(Q._modelViewPort!==undefined)){console.warn("----> request model")}Q._processModelRequest(S)}},_applyInheritedHeight:function(){var P=(this._scrollerDimensions&&(this.getCellsContainerSize().width>this._scrollerDimensions.width))?20:0;var O=(this.getCellsContainerSize().height+this.getHeadersDimensions().height+P);if(this.options.maxHeight){O=Math.min(O,this.options.maxHeight)}this.getContent().style.height=O+"px"},updateView:function(O){if(O||this._updateViewOptions.generatePool){this._generatePool()}this._modelEvents.publish({event:"UPDATE_VIEW",context:this});this._hasBeenUpdated()},onRightReached:function(O){return this._modelEvents.subscribe({event:"RIGHT_REACHED"},O)},onLeftReached:function(O){return this._modelEvents.subscribe({event:"LEFT_REACHED"},O)},onTopReached:function(O){return this._modelEvents.subscribe({event:"TOP_REACHED"},O)},onBottomReached:function(O){return this._modelEvents.subscribe({event:"BOTTOM_REACHED"},O)},shiftUpRecursive:function(O){if(this._deltaViewport.minRowID<0){for(var P=this._viewportBbox.minRowID-this._deltaViewport.minRowID;P>=this._viewportBbox.minRowID;P--){this._renderRow(P)}}if(this._deltaViewport.maxRowID<0){for(var P=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;P>=this._viewportBbox.maxRowID;P--){this._freeUpRow(P)}}},shiftLeftRecursive:function(O){if(this._deltaViewport.minColumnID<0){for(var P=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;P>=this._viewportBbox.minColumnID;P--){this._renderColumn(P)}}if(this._deltaViewport.maxColumnID<0){for(var P=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;P>=this._viewportBbox.maxColumnID;P--){this._freeUpColumn(P)}}},shiftDownRecursive:function(O){if(this._deltaViewport.minRowID>0){for(var P=this._viewportBbox.minRowID-this._deltaViewport.minRowID;P<=this._viewportBbox.minRowID;P++){this._freeUpRow(P)}}if(this._deltaViewport.maxRowID>0){for(var P=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;P<=this._viewportBbox.maxRowID;P++){this._renderRow(P)}}},shiftRightRecursive:function(O){if(this._deltaViewport.minColumnID>0){for(var P=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;P<=this._viewportBbox.minColumnID;P++){this._freeUpColumn(P)}}if(this._deltaViewport.maxColumnID>0){for(var P=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;P<=this._viewportBbox.maxColumnID;P++){this._renderColumn(P)}}},shiftDown:function(P,Q){var O=this._viewportBbox;var R=O.maxRowID+1;this._renderRow(R,true)},shiftRight:function(O){this._renderColumn(O)},shiftUp:function(O){this._renderRow(O,true)},shiftLeft:function(O){this._renderColumn(O)},_getModelMinRowID:function(){var P=-1;for(var O in this.options.model){P=O;break}return P},getNumberOfRows:function(){return this.options.model.length},getPoolNumberOfRows:function(){return this._poolSize.numberOfRows},getPoolNumberOfColumns:function(){return this._poolSize.numberOfColumns},_removeCellsFromPool:function(O,P){this._numberOfRowsToRemove=O;this._numberOfColumnsToRemove=P},_getEstimatedPoolSize:function(){var O=1;var R=this.elements.scroller.getDimensions();var P=O*parseInt(R.height/this._getCellHeight(),10)+2;var Q=O*parseInt(R.width/this._getCellWidth(),10)+2;return{numberOfRows:P,numberOfColumns:Q}},_destroyPool:function(){this._freeUpPool(2)},_doINeedToGeneratePool:function(){var O=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:this._computeModelSize().numberOfRows;return Math.floor(parseInt(this.getViewportDimensions().height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor)>=O},getViewportDimensions:function(O){if(this._viewportDimensions===undefined||O===true||true){this._viewportDimensions={width:this.elements.gridHeaderContainerRel.offsetWidth,height:this.elements.gridHeaderContainerRel.offsetHeight}}return this._viewportDimensions},_generatePool:function(O,P){var S=this.__computePoolSize(O,P);this._freeUpPool(1);this._poolSizeMax=S.poolSizeMax;this._poolSize=S.poolSize;var R="[GridEngine] - generate pool --";b.beginMeasure(R);var Q=this;this._needToApplyCellContainerSizer=true;this._updateViewOptions.generatePool=false;Q._modelEvents.publish({context:this,event:m});b.endMeasure(R)},_computePoolSize:function(W,P){var T=this._computeModelSize();if(W===undefined){W=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:T.numberOfRows}if(P===undefined){P=this._poolDimensions.numberOfColumns!==undefined?this._poolDimensions.numberOfColumns:T.numberOfColumns}var U=this.getViewportDimensions();var Q=1;var V,S,R,O;R=Math.ceil(Q*parseInt(U.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor);O=Math.ceil(Q*parseInt(U.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor);V=Math.ceil(Math.max(1,Math.min(Q*parseInt(U.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,W))+this._numberOfRowsToRemove);if(!this.options.performances.enableColumnVirtualization){S=P}else{S=Math.floor(Math.max(1,Math.max(Math.min(Q*parseInt(U.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,P),1))+this._numberOfColumnsToRemove)}this._poolSizeMax={numberOfRows:R,numberOfColumns:O};this._poolSize={numberOfRows:V,numberOfColumns:S};if(v){console.warn(this.options.id,"Viewport size",U.width,"x",U.height,"px");console.warn(this.options.id,"Generate a pool of ",V,"x",S,"cells")}},__computePoolSize:function(X,P){var U=this._computeModelSize();if(X===undefined){X=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:U.numberOfRows}if(P===undefined){P=this._poolDimensions.numberOfColumns!==undefined?this._poolDimensions.numberOfColumns:U.numberOfColumns}var V=this.getViewportDimensions();var Q=1;var W,T,R,O;R=Math.ceil(Q*parseInt(V.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor);O=Math.ceil(Q*parseInt(V.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor);W=Math.ceil(Math.max(1,Math.min(Q*parseInt(V.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,X))+this._numberOfRowsToRemove);if(!this.options.performances.enableColumnVirtualization){T=P}else{T=Math.floor(Math.max(1,Math.max(Math.min(Q*parseInt(V.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,P),1))+this._numberOfColumnsToRemove)}var Y={numberOfRows:R,numberOfColumns:O};var S={numberOfRows:W,numberOfColumns:T};if(v){console.warn(this.options.id,"Viewport size",V.width,"x",V.height,"px");console.warn(this.options.id,"Generate a pool of ",W,"x",T,"cells")}return{poolSize:S,poolSizeMax:Y}},onPreUpdateView:function(O){return this._modelEvents.subscribe({event:"preFullUpdateView"},O)},onPreUpdateViewOnce:function(O){return this._modelEvents.subscribeOnce({event:"preFullUpdateView"},O)},onPostUpdateView:function(O){if(window.__karma__!==undefined){return this.onPostUpdateViewODT(O)}else{return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},O)}},onPostUpdateViewODT:function(O){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},D.debounce(O,200))},onPostUpdateViewOnce:function(O){if(window.__karma__!==undefined){return this.onPostUpdateViewOnceODT(O)}else{return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},O)}},onPostUpdateViewOnceODT:function(O){return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},D.debounce(O,200))},onPoolUpdate:function(O){return this._modelEvents.subscribe({event:m},O)},onPoolCellCreation:function(O){this._modelEvents.subscribe({event:N},O)},onPoolCellDestruction:function(O){this._modelEvents.subscribe({event:k},O)},processPoolCells:function(Q){var O;for(O in this._listOfRenderedCells){var P=this._listOfRenderedCells[O];Q.call(this,{cellView:P})}},addCellsFilter:function(O){O=e.extend({match:function(Q){},onMatch:function(Q){},onMismatch:function(Q){}},O);var P=this;this._listOfCellFilters.pushAction({actionFunc:function(Q){if(O.match.call(P,Q)){Q.cellView._isFiltered=true;O.onMatch.call(P,Q)}else{if(Q.cellView._isFiltered){O.onMismatch.call(P,Q)}}}})},search:function(O){O=e.extend({match:function(R){},onComplete:function(R){}},O);var Q=this;var P=[];y.forEach(this.options.model,function(S,R){if(!Q._isMonoDimension){S.forEach(function(T,V){var U=Q.getCellModel(R,V);var W={cellModel:U,virtualRowID:R,virtualColumnID:V,virtualCellID:R*Q._numberOfColumns+V};if(O.match.call(Q,W)){P.push(W)}})}},100,function(){if(O.onComplete){O.onComplete.call(Q,{listOfMatchedCellModels:P})}})},removeAllCellsFilters:function(){this._listOfCellFilters.clear();this.updateView(true)},_getCellWidth:function(){return this.options.defaultCellWidth+this.options.cellSpacing.horizontal},_getCellHeight:function(){return this.options.defaultCellHeight+this.options.cellSpacing.vertical},_computeDynamicCellSpacing:function(){if(this.getScroller()){var P=this._scrollerDimensions;P.width=P.width-20;var O=(P.width%this.options.defaultCellWidth)/((Math.floor(P.width/this.options.defaultCellWidth)+1));this.options.cellSpacing={horizontal:O,vertical:O}}},_enableAutoScroll:function(P,Q){this._autoScrollDistance=P||{x:0,y:0};this._autoScrollPeriod=Q||20;this._disableAutoScroll();if(this._autoScrollInterval===undefined){var O=this;this._autoScrollInterval=window.setInterval(function(){var R=O.getScroller().elements.container;var S=R.scrollTop;var T=R.scrollLeft;if(S>=0){R.scrollTop=S+O._autoScrollDistance.y}if(T>=0){R.scrollLeft=T+O._autoScrollDistance.x}},this._autoScrollPeriod)}},_setAutoScrollVelocity:function(O){this._autoScrollDistance=O||{x:0,y:0}},_disableAutoScroll:function(){if(this._autoScrollInterval!==undefined){window.clearInterval(this._autoScrollInterval);delete this._autoScrollInterval}}});return q});define("DS/Layouts/ChannelView",["DS/Layouts/GridEngine","DS/Controls/ThumbnailCellView"],function(c,b){var a=c.extend({defaultOptions:{cellClass:b,numberOfColumns:1,defaultCellWidth:260,defaultCellHeight:170},init:function(d){d.numberOfColumns=d.model.length;this._parent(d);this.elements.container.setStyles({height:this.options.defaultCellHeight+20})}});return a});define("DS/Tree/GridView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/UIBehaviors/ContextualMenuManager","DS/Tree/TreeNodeModel","DS/Menu/ContextualMenu","DS/Utilities/Dom","DS/Utilities/TouchUtils"],function(e,c,l,g,d,b,n,f,h,a,k){var i=false;var m=false;var j=l.extend({defaultOptions:{width:"100%",strectchBackgroundImage:true,checkboxVisibleFlag:true,checkboxVisibilityFlag:"always",titleDisplayedOnTwoLines:false,model:[],selection:{unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableListSelection:false,canInteractiveMultiselectWithCheckboxClick:false,},enableActiveUI:false,enableKeyboardNavigation:false,layoutOnSingleRow:false,shouldDisplayTooltipFlag:true,displayBadges:true,onDragStartCellDefault:function(r,o){var p=undefined;var q=o.nodeModel;if(q){p=q.getTreeDocument()}if(p&&p.options.shouldAcceptDrag(q)){r.dataTransfer.setData("Text",JSON.stringify(o.nodeModel.dump()));r.dataTransfer.effectAllowed="move"}else{r.preventDefault()}},onDragEnterBlankDefault:function(p,o){o.manager.getScroller().getContent().addClassName("wux-ui-state-drag-over")},onDragLeaveBlankDefault:function(p,o){o.manager.getScroller().getContent().removeClassName("wux-ui-state-drag-over")},onDragOverCellDefault:function(p,o){},onDragOverBlankDefault:function(p,o){p.preventDefault()},onDropBlankDefault:function(p,o){p.preventDefault();return false},performances:{numberOfRowsFactor:3,numberOfColumnsFactor:3}},init:function(o){this._parent(o);this.options._firstLoadDone=0;this._modelEventsListener=[];this._xsoEventsListener=[];var p=this;this._isInteractiveMultiSelMode=false;this._interactiveCumulativeSelection=false;this.onCellPointerDown(function(s){var r=s.event;if(r&&g.isTouchEvent(r)){return}else{return p._onCellClickOrPointerDown(s)}});this.onCellClick(function(s){var r=s.event;if(r&&g.isTouchEvent(r)){if(!p._preventSelectionForTouchScroll){return p._onCellClickOrPointerDown(s)}else{return}}if(p._needToSelectAtRelease===true){if(p.isInMultiSelection()===false){p.options.TreedocModel.getXSO().empty();p.setActiveNode(s.cellModel,false);s.cellModel.select();p.options.lastSelectedNode=s.cellModel}else{if(p.options.selection.toggle){s.cellModel.unselect()}}}p._needToSelectAtRelease===false});this._modelEvents.subscribe({event:"active"},function q(r){p._updateAllPoolSelectedViews()});if(!this.options.TreedocModel&&this.options.model instanceof b){this.loadGridViewModel(this.options.model)}this.onReady(function(){this.elements.container.addClassName("wux-layout-gridview");this.elements.container.setAttribute("tabindex","0");if(this.options._observeDragAndDropEvents===undefined){this._observeDragAndDropEvents();this.options._observeDragAndDropEvents=true}if(this.options._observeDoubleClickEvent===undefined){this._observeDoubleClickEvent();this.options._observeDoubleClickEvent=true}this._updateCheckBoxVisibility();this._updateStrectchBackgroundImage();this._updateTitleDisplayedOnTwoLines();var v=this;if(this.options._observeContextualEvent===undefined){this.options._observeContextualEvent=true;var t=v.options.onContextualEvent;if(t){h.addEventListener(this.elements.container,{callback:function(y){var x=v._cellCtxMenuRequired?true:false;v._cellCtxMenuRequired=false;return t.callback.call(t["this"],{context:y.context,infos:y.info,data:y.data,cellInfos:undefined,infoContext:y.context,cellCtxMenuRequired:x})}})}else{var u=this.options.onContextualMenuReady;var s=u;if(typeof u==="function"){s=function(){var x=undefined;return u.call(v,x)}}n.onReady({target:this.elements.container,nodes:s})}}if(this.options.delayedInputModel){this.updateModel(this.options.model);this.options.delayedInputModel=null}var r=this.getScroller();if(r&&this.options.responsiveWidthBehavior){var w=r.getContent().getDimensions();this.onTileGridViewResize(w)}})},_onCellClickOrPointerDown:function(D){var w=this;var p=w.options.checkboxVisibilityFlag;if(p==="atCellHover"){var B=window.getComputedStyle(D.cellView._view.elements.checkbox.getContent());var x=B.display;if(x==="none"){w._isTouchWithatCellHover=true}}w._needToSelectAtRelease=false;if(D.cellModel.isSelected()&&!w.isInShiftSelection()){var o=D.event;if(o&&g.isTouchEvent(o)){if(w.options.selection.toggle&&w.isInMultiSelection()===true){D.cellModel.unselect()}}else{w._needToSelectAtRelease=true;return}}else{if(!w.isInMultiSelection()&&!w.isInShiftSelection()){w.options.TreedocModel.getXSO().empty()}w.setActiveNode(D.cellModel,false);D.cellModel.select();if(!w.isInShiftSelection()){w.options.lastSelectedNode=D.cellModel}}if(w.isInShiftSelection()&&w.options.lastSelectedNode!==D.cellModel){w.options.TreedocModel.prepareUpdate();w.options.TreedocModel.getXSO().empty();var q=w.options.lastSelectedNode;var y=D.cellModel;if(q&&y){var s=q._getRowID(true);var v=y._getRowID(true);var t=v>s?s:v;var A=t===s?v:s;var r=w.options.model;var u=0;var z=[];for(u=t;u<=A;u++){var C=r[u];if(C.isVisible()&&!C.isSelected()){w.setActiveNode(C,false);z.push(C)}}w.options.TreedocModel.getXSO().add(z);w.options.TreedocModel.pushUpdate()}}},firstParentWithClass:function(q,p){var o=q;if(o){var r=(" "+o.className+" ").replace(/[\n\t]/g," ").indexOf(" "+p+" ")>-1;if(r){return o}else{return this.firstParentWithClass(o.parentNode,p)}}else{return}},hasClass:function(p,o){var q=(" "+p.className+" ").replace(/[\n\t]/g," ").indexOf(" "+o+" ")>-1;return q},_observeDragAndDropEvents:function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},_observeDoubleClickEvent:function(){var o=this;o.elements.container.addEventListener("dblclick",function(q){var p=o.firstParentWithClass(q.target,"wux-datagrid-cell");if(q.which===1&&p&&p.dsView){var r=p.dsView.getCellInfos();r.event=q;if(r.cellModel!==undefined){o._modelEvents.publish({event:"dblclick",context:r.cellModel,data:r})}}})},_processDragAndDropCallback:function(u){var v=this;var t=this.firstParentWithClass(u.target,"wux-datagrid-cell");var w={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var A=w[u.type];var x=t&&t.dsView?t.dsView.getCellInfos():{manager:this};if(u.type==="dragstart"){var p=true;var y=v.options.TreedocModel?v.options.TreedocModel.getXSO():undefined;if(y&&x.nodeModel){p=y.isIn(x.nodeModel)}var z=v.options.TreedocModel?v.options.TreedocModel.options.shouldAcceptDrag(x.cellModel):false;if(z&&p){if(u.dataTransfer){var s=u.target.getBoundingClientRect();var r=u.clientX-s.left;var o=u.clientY-s.top;if(typeof(u.dataTransfer.setDragImage)==="function"){u.dataTransfer.setDragImage(u.target,r,o)}}}else{u.preventDefault()}}function q(F,B){var E=false;var C=v.options[F+B];if(C){E=C.call(x.parent,u,x);if(i&&F!=="onDragOver"){console.info("[dnd]",F+B,">",E,u.target)}}else{if(i){console.warn("[dnd]","cannot find",F+B,"callback")}}var D=v.options[F+B+"Default"];if(D){if(C===undefined||(C&&E)){if(i){if(C&&E){console.info("\t>[dnd]","dev want to continue to the default behavior for ",F+B," callback")}else{console.info("\t>[dnd]","use the default behavior for ",F+B," callback")}}D.call(x.parent,u,x)}}}if(x.cellView){q(A,"Cell")}else{q(A,"Blank")}},_updatePoolSelectedViews:function(o){this.processPoolCells(function(s){var r=s.cellView;if(r){var p=r.getCellInfos();if(p){var q=p.cellModel;if(q!==undefined&&q===o){if(this.options.enableActiveUI){if(q===this.options.activeNode){r.activate()}else{r.deactivate()}}if(o.isSelected()){r.highlight()}else{r.unhighlight()}}}}})},_updateAllPoolSelectedViews:function(){this.processPoolCells(function(r){var q=r.cellView;if(q){var o=q.getCellInfos();if(o){var p=o.cellModel;if(p!==undefined){if(this.options.enableActiveUI){if(p===this.options.activeNode){q.activate()}else{q.deactivate()}}if(p.isSelected()){q.highlight()}else{q.unhighlight()}}}}})},setActiveNode:function(p,o){return this._setActiveNode(p,o)},_setActiveNode:function(p,o){this.options.activeNode=p;if(o===true){if(this.options.enableActiveUI){this._modelEvents.publish({event:"active",context:p,data:p._getNodeInfos()})}}},_flattenTreeDocument:function(o){var p;if(o){p=o.getAllDescendants().filter(function(q){return q.isVisible()})}if(this.options.layoutOnSingleRow===true){this.options.numberOfColumns=p.length}return p},_observeSelMultiSel:function(){var s=this;this._modeIsMultiSel=false;this._modeIsListSel=false;this._modeIsShiftSel=false;var p=false;function o(x){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var A=z._getNodeInfos();if(A){var y=u(A,x);if(y.node){s.options.mutePoolrefresh=true;s.setActiveNode(y.node,false);s.options.lastSelectedNode=y.node;s.options.mutePoolrefresh=false;y.node.select(true);r(y.node,y.index)}}}p=false}function v(x){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var A=z._getNodeInfos();if(A){var y=u(A,x);if(y.node){s.setActiveNode(y.node,true);r(y.node,y.index)}}}p=false}function t(x){var C=s.options.lastSelectedNode;var y=C._getRowID(true);var B=s.options.activeNode;if(B){var E=B._getNodeInfos();if(E){var z=u(E,x);var D=w(y,z.index,B._getRowID(true));if(z.node){s.options.mutePoolrefresh=true;s.options.TreedocModel.prepareUpdate();var A=s.options.TreedocModel.getXSO();A.add(D.toSelect);A.remove(D.toUnselect);s.setActiveNode(z.node,false);s.options.mutePoolrefresh=false;s.options.TreedocModel.pushUpdate();r(z.node,z.index)}}}p=false}function u(E,z){var D=E.nodeModel._getRowID(true);var C=D+z;var B=undefined;var A=Math.ceil(s.options.model.length/s._numberOfColumns);var y=Math.ceil((D+1)/s._numberOfColumns);var x=(s._numberOfColumns===z&&A===y)||(-s._numberOfColumns===z&&1===y);while(z!==0){B=s.getCellModel(C);if(x){break}if(!B){if(z>0){z--;C--}else{z++;C++}}else{break}}return{index:C,node:B}}function w(z,E,y){var D=[];var C=[];var x=z;var A=undefined;while(x!==E){A=s.getCellModel(x);if(A&&!A.isSelected()){D.push(A)}if(E>=z){x++}else{x--}}if(x===E){A=s.getCellModel(x);if(A&&!A.isSelected()){D.push(A)}}x=((E-z)*(y-E)>=0)?E:y;var B=undefined;if(x!==y){while(x!==y){B=s.getCellModel(x);if(B&&B.isSelected()&&x!==E){C.push(B)}if(y>E){x++}else{x--}}if(x===y){B=s.getCellModel(x);if(B&&B.isSelected()){C.push(B)}}}return{toSelect:D,toUnselect:C}}function r(x,y){return s._scrollToNode(x,y)}function q(L){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var F=z._getNodeInfos();var B=F.nodeModel._getRowID(true);var M=s.getScrollerPosition();var G=s.getScroller();var H=G.getContent().getDimensions();var J=M.y;var E=M.x;var y=Math.ceil(H.height/(s.options.defaultCellHeight+s.options.cellSpacing.vertical));var I=Math.ceil(H.width/(s.options.defaultCellWidth+s.options.cellSpacing.horizontal));var N=0;var D=0;var A=0;var K=0;var C=1;var x=0;if(s.options.layoutOnSingleRow===false){D=B-B%s._numberOfColumns;A=(D*(s.options.defaultCellHeight+s.options.cellSpacing.vertical))/s._numberOfColumns-J;K=Math.ceil(A/(s.options.defaultCellHeight+s.options.cellSpacing.vertical))}else{D=B;A=(B*(s.options.defaultCellWidth+s.options.cellSpacing.horizontal))-E;K=Math.ceil(A/(s.options.defaultCellWidth+s.options.cellSpacing.horizontal))}if(L==="home"){return -B}else{if(L==="end"){return s.options.model.length-1-B}else{if(L==="pageup"){if(s.options.layoutOnSingleRow===false){N=-(K)*s._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B-s._numberOfColumns*C<0){x--;break}}N=-s._numberOfColumns*x}}else{N=-K;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B-C<0){x--;break}}N=-x}}return N}else{if(L==="pagedown"){if(s.options.layoutOnSingleRow===false){N=(y-K-1)*s._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B+s._numberOfColumns*C>=s.options.model.length){x--;break}}N=s._numberOfColumns*x;if(N===0){if((s.options.model.length-1)%s._numberOfColumns<B%s._numberOfColumns){N=s._numberOfColumns}}}}else{N=I-K-1;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B+C>=s.options.model.length){x--;break}}N=x}}return N}}}}}return 0}a.addEventOnElement(this,document,"keydown",function(y){var x=e.Event.whichKey(y);if(s.options.selection.enableListSelection&&(x==="shift"||x==="meta+[")){s._modeIsShiftSel=true}else{if(s.options.selection.canMultiSelect&&(x==="ctrl"||x==="meta+[")){s._modeIsMultiSel=true}}if(x==="ctrl+pageup"||x==="ctrl+pagedown"){y.preventDefault()}});a.addEventOnElement(this,document,"keyup",function(y){var x=e.Event.whichKey(y);if(x==="ctrl"||x==="meta+["){s._modeIsMultiSel=false}if(s.options.selection.enableListSelection&&x==="shift"||x==="meta+["){s._modeIsShiftSel=false}});if(this.options.enableKeyboardNavigation){a.addEventOnElement(this,s.getContent(),"keydown",function(z){if(p===false&&(z.target===s.getContent()||z.currentTarget===s.getContent())){var y=s.options.activeNode;if(y){var x=e.Event.whichKey(z);if([32,33,34,35,36,37,38,39,40].indexOf(z.keyCode)>-1){z.preventDefault();z.stopPropagation()}switch(x){case"ctrl+space":case"space":y.isSelected()?y.unselect():y.select();break;case"ctrl+right":v(1);break;case"shift+right":p=true;t(1);break;case"right":p=true;o(1);break;case"ctrl+left":v(-1);break;case"shift+left":p=true;t(-1);break;case"left":p=true;o(-1);break;case"ctrl+up":v(-s._numberOfColumns);break;case"shift+up":p=true;t(-s._numberOfColumns);break;case"up":p=true;o(-s._numberOfColumns);break;case"ctrl+down":v(s._numberOfColumns);break;case"shift+down":p=true;t(s._numberOfColumns);break;case"down":p=true;o(s._numberOfColumns);break;case"home":o(q(x));break;case"end":o(q(x));break;case"pageup":o(q(x));break;case"pagedown":o(q(x));break;case"ctrl+home":v(q("home"));break;case"ctrl+end":v(q("end"));break;case"ctrl+pageup":v(q("pageup"));break;case"ctrl+pagedown":v(q("pagedown"));break;case"shift+home":t(q("home"));break;case"shift+end":t(q("end"));break;case"shift+pageup":t(q("pageup"));break;case"shift+pagedown":t(q("pagedown"));break;default:}}}})}},isInMultiSelection:function(){return(this._modeIsMultiSel||this._isInteractiveMultiSelMode)},isInShiftSelection:function(){return this._modeIsShiftSel},loadGridViewModel:function(p){if(p){if(this.options.TreedocModel===p){return}var q=this;this.options.TreedocModel=p;this.options.model=this._flattenTreeDocument(p);if(this.options.model){var r=q.options.TreedocModel._getTrueRoot();if(r&&r.isVisible()){this.options.lastSelectedNode=r}else{if(r){var o=r.getVisibleChildren();if(o&&o.length>0){this.options.lastSelectedNode=o[0]}}}this._destroyPool();if(this.options._firstLoadDone===0){if(!this.getScroller()){this.options.delayedInputModel=this.options.model;this.loadModel(this.options.model,true)}else{this.loadModel(this.options.model,true)}}else{this.updateModel(this.options.model)}this.options._firstLoadDone=1;this._initSpecializedView()}if(this.options._observeSelMultiSel===undefined){this._observeSelMultiSel();this.options._observeSelMultiSel=true}this.AddModelEvents();this.options._firstLoadDone=1}},unloadGridViewModel:function(){this.RemoveModelEvents();this.options.TreedocModel=null;this.options.model=[];this._destroyPool();this.updateView(true)},AddModelEvents:function(){var q=this;var p=this.options.TreedocModel.getXSO().onChange(function(r){if(m){console.log("onChange")}if(q.options.mutePoolrefresh===true){return}q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true;q._onSelectionChange()});this._xsoEventsListener.push(p);p=this.options.TreedocModel.getXSO().onAdd(function(r){if(m){console.log("onAdd")}q._modelEvents.publish({event:"selectionAdded",context:r,data:r});q.setActiveNode(r);q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true});this._xsoEventsListener.push(p);p=this.options.TreedocModel.getXSO().onRemove(function(r){if(m){console.log("onRemove")}q._modelEvents.publish({event:"selectionRemoved",context:r,data:r});q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true});this._xsoEventsListener.push(p);var o=0;p=this.options.TreedocModel.addModelEventListener("prepareUpdate",function(r){if(m){console.log("prepareUpdate")}o++});this._modelEventsListener.push(p);p=this.options.TreedocModel.addModelEventListener("pushUpdate",function(v){if(m){console.log("pushUpdate")}o--;if(o<0){console.error("You pushed too many updates")}if(o===0){if(q.options.mutePoolrefresh){return}if(q.options.TreedocModel){var x=v.data.nodeModel;var s=q.options.model.indexOf(x);if(s===-1){if(q.options.TreedocModel._getTrueRoot()!==x){q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}else{var u=q._flattenTreeDocument(q.options.TreedocModel);var r=q.options.model;var w=false;if(u.length!==r.length){w=true}if(w===false){var t;for(t=0;t<u.length;t++){if(u[t]!==r[t]){w=true;break}}}if(w===true){q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}else{q._updateAllPoolSelectedViews()}}}else{q._updateAllPoolSelectedViews()}}}});this._modelEventsListener.push(p);p=this.options.TreedocModel.onUpdate(function(r){if(m){console.log("onUpdate")}if(q.options.mutePoolrefresh===true){return}if(!q._preventUpdateInternalModel){q._destroyPool();q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}q._preventUpdateInternalModel=false});this._modelEventsListener.push(p);p=this.options.TreedocModel.onPostExpand(function(){if(m){console.log("onPostExpand")}q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)});this._modelEventsListener.push(p);p=this.options.TreedocModel.onPostCollapse(function(){if(m){console.log("onPostCollapse")}q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)});this._modelEventsListener.push(p)},RemoveModelEvents:function(){if(this.options.TreedocModel){for(var o=0;o<this._modelEventsListener.length;o++){this.options.TreedocModel.getModelEvents().unsubscribe(this._modelEventsListener[o])}this._modelEventsListener.splice(0,this._modelEventsListener.length);for(var o=0;o<this._xsoEventsListener.length;o++){this.options.TreedocModel.getXSO().unsubscribe(this._xsoEventsListener[o])}this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}},_scrollToNode:function(r,z){var A=this;if(r){var D=A.getScrollerPosition();var v=A.getScroller();var y=v.getContent().getDimensions();if(A.options.layoutOnSingleRow===false){var t=z-z%A._numberOfColumns;var s=(t*(A.options.defaultCellHeight+A.options.cellSpacing.vertical))/A._numberOfColumns;var o=A.options.defaultCellHeight;var C=D.y;var x=C+y.height-o;var p=A.getCellsContainerSize().width>A.getScroller().getContent().getDimensions().width?20:0;if(s>x){v.getContent().scrollTop=s-y.height+o+p+4}if(s<=C){v.getContent().scrollTop=s}}if(A.options.layoutOnSingleRow===true){var q=A.options.defaultCellWidth;var u=D.x;var E=u+y.width-q;var B=z*(A.options.defaultCellWidth+A.options.cellSpacing.horizontal);var w=A.getCellsContainerSize().height>A.getScroller().getContent().getDimensions().height?20:0;if(B>E){v.getContent().scrollLeft=B-y.width+q+w+4}if(B<=u){v.getContent().scrollLeft=B}}}},_onSelectionChange:function(){},onSelectionAdd:function(o){return this._modelEvents.subscribe({event:"selectionAdded"},o)},onSelectionRemove:function(o){return this._modelEvents.subscribe({event:"selectionRemoved"},o)},onGridViewCellDoubleClick:function(o){return this._modelEvents.subscribe({event:"dblclick"},o)},setCheckBoxesVisible:function(o){if(o===true){this.options.checkboxVisibleFlag=true;this.options.checkboxVisibilityFlag="always"}else{this.options.checkboxVisibleFlag=false;this.options.checkboxVisibilityFlag="never"}this._updateCheckBoxVisibility()},getCheckBoxesVisible:function(){return this.options.checkboxVisibleFlag},setCheckboxVisibilityFlag:function(o){if(o==="always"){this.options.checkboxVisibilityFlag="always"}else{if(o==="atCellHover"){this.options.checkboxVisibilityFlag="atCellHover"}else{if(o==="never"){this.options.checkboxVisibilityFlag="never"}}}this._updateCheckBoxVisibility()},getCheckboxVisibilityFlag:function(){return this.options.checkboxVisibilityFlag},_updateCheckBoxVisibility:function(){if(this.options.checkboxVisibleFlag===false){this.elements.container.setAttribute("has-checkbox","never")}else{if(this.options.checkboxVisibilityFlag==="always"){this.elements.container.setAttribute("has-checkbox","always")}else{if(this.options.checkboxVisibilityFlag==="never"){this.elements.container.setAttribute("has-checkbox","never")}else{if(this.options.checkboxVisibilityFlag==="atCellHover"){if(k.getTouchMode()===true){this.elements.container.setAttribute("has-checkbox","always")}else{this.elements.container.setAttribute("has-checkbox","atCellHover")}}}}}},setStrectchBackgroundImage:function(o){if(o){this.options.strectchBackgroundImage=true}else{this.options.strectchBackgroundImage=false}this._updateStrectchBackgroundImage()},getStrectchBackgroundImage:function(){return this.options.strectchBackgroundImage},_updateStrectchBackgroundImage:function(){if(this.options.strectchBackgroundImage){if(this.elements&&this.elements.container){this.elements.container.setAttribute("strectch-background-image","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("strectch-background-image","false")}}},getTitleDisplayedOnTwoLines:function(){return this.options.titleDisplayedOnTwoLines},setTitleDisplayedOnTwoLines:function(o){if(o){this.options.titleDisplayedOnTwoLines=true}else{this.options.titleDisplayedOnTwoLines=false}this._updateTitleDisplayedOnTwoLines()},_updateTitleDisplayedOnTwoLines:function(){if(this.options.titleDisplayedOnTwoLines){if(this.elements&&this.elements.container){this.elements.container.setAttribute("title-multiple-lines","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("title-multiple-lines","false")}}},setShouldDisplayTooltipFlag:function(o){if(o===true){this.options.shouldDisplayTooltipFlag=true}else{if(o===false){this.options.shouldDisplayTooltipFlag=false}}this.updateView(true)},getShouldDisplayTooltipFlag:function(){return this.options.shouldDisplayTooltipFlag},destroy:function(){if(this.options.TreedocModel){this.unloadGridViewModel()}a.removeAllEventsOnElement(this);this.options.lastSelectedNode=null;this._parent()}});return j});define("DS/Tree/ThumbnailGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(h,c,g,a,e,f,b){var d=g.extend({defaultOptions:{width:"100%",cellClass:a,defaultCellHeight:160,defaultCellWidth:210,cellSpacing:{horizontal:10,vertical:10},animationFlag:true},init:function(i){this._parent(i);this._initSpecializedView()},_initSpecializedView:function(){var i=this;this.onCellRequest(function(k){if(!k.isHeader){k.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var j=k.nodeModel;k.cellView.setTitle(j.options.label);k.cellView.setSubtitle(j.options.subLabel);k.cellView.setPicture(j.options.thumbnail);k.cellView.setColor(j.options.color);k.cellView.setDescription(j.options.description);if(j.options.icons&&j.options.icons.length){k.cellView.setIcon(j.options.icons[0])}else{k.cellView.setIcon("")}if(i.options.displayBadges===true){k.cellView.setBadges(k.nodeModel.getBadges())}if(this.options.enableActiveUI){if(j===this.options.activeNode){k.cellView.activate()}}if(j.isSelected()){k.cellView.highlight()}if(this._onPostRequestCellCB){this._onPostRequestCellCB.call(i,k)}}});if(this.elements.container){this.elements.container.addEvent(e.POINTERUP,function(n){if(i.options.selection.unselectAllOnEmptyArea){if(e.isTouchEvent(n)){if(i._preventSelectionForTouchScroll){return}}var l=18;if(n.target.className.indexOf("wux-controls-thumbnail")===-1){var m=h.extendElement(n.target).getDimensions();var k=m.width;var j=m.height;if(n.offsetX<(k-l)&&n.offsetY<(j-l)){if(i.options.TreedocModel){i._disableInteractiveMultiSelMode();i.options.TreedocModel.getXSO().empty()}}}}})}},setAnimationOnCartoucheOver:function(i){if(i){this.options.animationFlag=true}else{this.options.animationFlag=false}this._updateAnimationOnCartoucheOver()},_updateAnimationOnCartoucheOver:function(i){if(this.options.animationFlag){if(this.elements&&this.elements.container){this.elements.container.setAttribute("animation-on-cartouche-over","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("animation-on-cartouche-over","false")}}},onPostCellRequest:function(i){this._onPostRequestCellCB=i},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){if((this.options.selection.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-thumbnail")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-thumbnail")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-thumbnail")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-thumbnail")}}}});return d});define("DS/Panels/PanelBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core"],function(e,a,d,c){var b=d.extend({defaultOptions:{},init:function(f){this._parent(f);this._buildView()},appendChild:function(g){var f=new e.Element("div",{styles:{width:"inherit"},html:g});this.elements.content.appendChild(f);return f},_buildView:function(){this.elements.container=e.Element("div",{"class":"wux-layouts-panel wux-panels-panelbase",styles:{minWidth:0,minHeight:0}});this.elements.panel=e.Element("div",{"class":"wux-panels-panelbase",styles:{display:"block"}});if(this.options.title){this.elements.title=e.Element("div",{"class":"wux-panels-panelbase-title",html:this.options.title}).inject(this.elements.panel)}this.elements.panel.inject(this.elements.container);this.elements.content=e.Element("div",{"class":"wux-panels-panelbase-content",styles:{display:"block"}}).inject(this.elements.panel)},});return b});define("DS/Windows/DockingElementForImmersiveFrame",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Windows/DockingElement"],function(f,e,a,b,d){var c=d.inherit({buildView:function(){this._parent();this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-immersiveFrameStyle");this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-immersiveFrameStyle");this.elements.expanderBar=new f.Element("div",{"class":"wux-windows-docking-element-expanderBar"}).inject(this.elements.dockingZone,"before");this.elements.collapseIconContainer=new f.Element("div",{"class":"wux-windows-docking-element-collapse-icon-container"}).inject(this.elements.expanderBar);this.elements.collapseIcon=new f.Element("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-windows-docking-element-collapseIcon"}).inject(this.elements.collapseIconContainer);this.useBordersFlag=false;this.useBackgroundFlag=false},_applyCollapseDockingZoneFlag:function(h){this._updatePinIcon();this._updateCollapserSize();var j=h?0:this.dockingZoneSize;var i=this.collapseDockingZoneFlag?this._scrollBarSize:0;var k=j+this._collapserSize+i;if(this.side&WUXDockAreaEnum.TopDockArea||this.side&WUXDockAreaEnum.BottomDockArea){this.elements.freeZone.setStyle("height","calc(100% - "+k+"px)")}else{if(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea){this.elements.freeZone.setStyle("width","calc(100% - "+k+"px)")}}if(this.side&WUXDockAreaEnum.LeftDockArea||this.side&WUXDockAreaEnum.RightDockArea){if(h){this.elements.dockingWithCollapserContainer.setStyle("width",this._collapserSize+"px")}else{this.elements.dockingWithCollapserContainer.setStyle("width",this.dockingZoneSize+this._collapserSize+this._scrollBarSize+"px")}}var g=this.elements.freeZone.getStyle("height");this._parent()},handleEvents:function(){var g=this;this._parent();this.elements.expanderBar.addEventListener("click",function(h){g._manageAutoCollapse();g._updatePinIcon()});this.elements.collapser.addEventListener("click",function(h){g._updatePinIcon()})},_updateContainedWindows:function(){if(this.side===WUXDockAreaEnum.BottomDockArea||this.side===WUXDockAreaEnum.TopDockArea){var k=null;var j=this.getContainedVisibleWindows();if(j.length===1){k=j[0]}if(k){k._moveTitleBar(true,this);k._updateTitleBarWidth()}var l=this.getContainedWindows();for(var g=0;g<l.length;g++){var h=l[g];if(h&&(h!==k)){h._moveTitleBar(false,this);h._updateTitleBarWidth()}}}this._parent()},_updateFromContainedWindows:function(){var h="left";if(this.side===WUXDockAreaEnum.BottomDockArea){var g=this.getContainedVisibleWindows();if(g.length===1){h="center"}}this.alignment=h;this._parent()},_updateCollapserSize:function(){if(!this.collapsibleFlag||!this.visibleDockingZoneFlag||!this.collapseDockingZoneFlag||(this.getContainedVisibleWindows().length===0)){this._collapserSize=0;this.elements.collapser.addClassName(this._hideClassName)}else{this._collapserSize=20;this.elements.collapser.removeClassName(this._hideClassName)}},_updatePinIcon:function(){if(!this.collapseDockingZoneFlag&&!this._collapseHoverFlag){this.elements.collapseIcon.removeClassName("wux-ui-3ds-pin");if(this.side&WUXDockAreaEnum.RightDockArea){this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down");this.elements.collapseIcon.addClassName("wux-ui-3ds-open-right")}else{if(this.side&WUXDockAreaEnum.BottomDockArea){this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up");this.elements.collapseIcon.addClassName("wux-ui-3ds-open-down")}else{if(this.side&WUXDockAreaEnum.LeftDockArea){this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down");this.elements.collapseIcon.addClassName("wux-ui-3ds-open-left")}else{if(this.side&WUXDockAreaEnum.TopDockArea){this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down");this.elements.collapseIcon.addClassName("wux-ui-3ds-open-up")}}}}}else{this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-left");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-up");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-down");this.elements.collapseIcon.removeClassName("wux-ui-3ds-open-right");this.elements.collapseIcon.addClassName("wux-ui-3ds-pin")}},_pointerEventsAllIfOverflow:function(){if(this.elements&&this.elements.dockingZone){if(this._hasScrollbar()){this.elements.dockingZone.setStyle("pointer-events","all");this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background")}else{if(this.side&WUXDockAreaEnum.TopDockArea){this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-has-background");this.elements.dockingZone.setStyle("pointer-events","")}else{this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background");this.elements.dockingZone.setStyle("pointer-events","")}}this._resetInteractiveDockArea()}},_getStretchSize:function(){if(this.side===WUXDockAreaEnum.TopDockArea||this.side==WUXDockAreaEnum.BottomDockArea){return parseInt(window.getComputedStyle(this.elements.dockingZoneMask).width)-parseInt(window.getComputedStyle(this.elements.expanderBar).width)-1}else{return parseInt(window.getComputedStyle(this.elements.dockingZoneMask).height)-parseInt(window.getComputedStyle(this.elements.expanderBar).height)-1}},});return c});define("DS/Panels/SidePanel",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Panels/PanelBase","DS/Utilities/Css","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(c,j,f,h,k,b,a,d){var g={left:"&#9664;",right:"&#9654;"};var i={right:"&#9664;",left:"&#9654;"};var e=k.extend({defaultOptions:{side:"left",isDockable:true},init:function(m){this._parent(m);this._modelEvents=new a();var o={transition:"all 0.2s ease-in-out",position:"absolute",top:0,bottom:0};var l={height:"100%"};if(this.options.side==="right"){o.right=0;l.right=-1}else{o.left=0;l.left=-1}this.elements.panel.setStyles(o);this.elements.panel.addClassName("wux-panels-sidepanel wux-panels-sidepanel-"+this.options.side);var n=this;this.elements.lateralHandle=new c.Element("div",{"class":"wux-panels-sidepanel-lateral-handle wux-panels-sidepanel-lateral-handle-"+this.options.side,styles:l});this.elements.lateralHandle.addEvent(d.POINTERUP,function(p){p.stopPropagation();p.preventDefault();n.slideToggle()});if(this.options.isDockable){this.elements.lateralHandle.inject(this.elements.container)}this.slideIn()},slideToggle:function(){if(!this.elements.panel.hasClassName("wux-ui-effects-slide-"+this.options.side)){this.slideOut()}else{this.slideIn()}},slideIn:function(){this.elements.container.setAttribute("data-isOpen","true");this.elements.panel.removeClassName("wux-ui-effects-slide-"+this.options.side);this._modelEvents.publish({event:"/PANEL/SLIDE_IN",data:this})},slideOut:function(){this.elements.container.setAttribute("data-isOpen","false");this.elements.panel.addClassName("wux-ui-effects-slide-"+this.options.side);this._modelEvents.publish({event:"/PANEL/SLIDE_OUT",data:this})},onSlideIn:function(l){return this._modelEvents.subscribe({event:"/PANEL/SLIDE_IN"},l)},onSlideOut:function(l){return this._modelEvents.subscribe({event:"/PANEL/SLIDE_OUT"},l)}});return e});define("DS/Controls/Tree",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeBase","DS/Controls/TreeNode","DS/Selection/HSOManager","DS/Selection/CSOManager","DS/Utilities/Css","DS/Panels/SidePanel"],function(h,y,e,g,q,m,v,u,l){var p="#04C7F0";var n="transparent";var t="solid";var i=1;var d=p;var c="#FFF";var b=10;var k="EVT_TREE_IS_SHOWN";var x="EVT_TREE_PANEL_IS_HIDDEN";function s(z,B){if(z instanceof Function){if(B instanceof Function){return z.toString()===B.toString()}return false}if(z===null||z===undefined||B===null||B===undefined){return z===B}if(z===B||z.valueOf()===B.valueOf()){return true}if(z instanceof Date){return false}if(B instanceof Date){return false}if(!(z instanceof Object)){return false}if(!(B instanceof Object)){return false}var A=Object.keys(z);if(z.pathElement!==undefined&&B.pathElement!==undefined){return z.pathElement.isEqual(B.pathElement)}return Object.keys(B).every(function(C){return A.indexOf(C)!==-1})?A.every(function(C){return s(z[C],B[C])}):false}var f={"class":"Expander",text:"+",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var a={"class":"Expander",text:"â",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var j={"class":"Expander",text:"â¢",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var r={"class":"NoExpander Link",text:"",styles:{backgroundColor:n,borderTop:i+"px "+t+" "+p,width:b/2,cursor:"pointer",zIndex:1000}};var w={shadow:true,expander:{size:b},link:{size:i,color:p,bgColor:n,style:t},label:{borderRadius:1,padding:"2px 4px",verticalAlign:"middle",border:"1px solid rgba(255,255,255,0.5)",minHeight:"1em",lineHeight:"1em"},expandState:f,collapseState:a,asyncState:j,noExpandState:r};var o=g.extend({defaultOptions:{isEditable:false,nodeClass:q},init:function(z){z.UI=w;this._parent(z);this.elements.container.addClassName("wux-controls-tree");this._highlightedNodes=[];this._modeIsMultiSel=false;this._modeIsListSel=false;this._selectionManagement()},_selectNode:function(A,z){var B={pathElement:A.options.pathElement};if(z){v.unique(B);m.unique(B)}else{if(v.isIn(B)){v.remove(B);m.remove(B)}else{v.add(B);m.add(B)}}return B},_selectionManagement:function(){var E=this;var F=null,D=null,z=0;this._onNodeClickCB=function(J){z++;if(!D&&F&&E._modeIsListSel){D=J;E._selectNode(J)}if((!F||(F!==null&&D!==null))&&(z%2!==0)){F=J;D=null;z=1}if(E._modeIsMultiSel){E._selectNode(J)}else{if(E._modeIsListSel){D=J;var H=J.getParent();if(H){var I=false;H.getChildren().forEach(function(L,K){if(s(L.options.pathElement,F.options.pathElement)){I=true}if((I&&!s(L.options.pathElement,D.options.pathElement))){E._selectNode(L)}if(s(L.options.pathElement,D.options.pathElement)){I=false}})}}else{E._selectNode(J,true)}}};this._onNodeClickToken=this.onNodeClick(this._onNodeClickCB);var C;var A=function(I){var J=I.pathElement;var H=E._searchPathElement(J);if(H&&H.elements&&H.elements.label){C=u.recordState(H.elements.label,["box-shadow","font-weight","text-shadow"]);E._highlightedNodes.push(H);H._isHighlighted=true;H.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"})}};var B=function(I){var J=I.pathElement;var H=E._searchPathElement(J);if(H&&H.elements&&H.elements.label){H._isHighlighted=false;u.restoreState(H.elements.label,C,["box-shadow","font-weight","text-shadow"])}};function G(){if(E.getContent().offsetParent&&!E._panelIsHidden){E._highlightedNodes.forEach(function(I,H){E._highlightedNodes.splice(H,1);if(I.elements&&I.elements.label&&C){u.restoreState(I.elements.label,C,["box-shadow","font-weight","text-shadow"])}});v.get().forEach(A)}}E.onPostExpand(function(H){G()});E.onPostCollapse(function(H){G()});E._modelEvents.subscribe({event:k},function(){G()});v.onPostAdd(function(H){G()});v.onRemove(B)},_buildCustomView:function(){this._panelIsHidden=false;this._sidePanel=new l({side:"left"}).inject(this.elements.container);this._sidePanel.elements.container.setStyles({minHeight:0,minWidth:0});this._sidePanel.elements.content.setStyles({height:"100%",boxSizing:"border-box",backgroundColor:"transparent",padding:"0 5px",pointerEvents:"none"});this._sidePanel.elements.panel.setStyles({backgroundColor:"transparent",border:"none",pointerEvents:"none"});var A=this._sidePanel.appendChild(this.elements.scrollContainer);A.setStyles({height:"100%"});var z=this;this._sidePanel.onSlideIn(function(){z._panelIsHidden=false;z._modelEvents.publish({event:k,data:z})});this._sidePanel.onSlideOut(function(){z._panelIsHidden=true;z._modelEvents.publish({event:x,data:z})})},onPanelSlideIn:function(z){return this._modelEvents.subscribe({event:k},z)},onPanelSlideOut:function(z){return this._modelEvents.subscribe({event:x},z)},slideOut:function(){this._sidePanel.slideOut()},slideIn:function(){this._sidePanel.slideIn()},_getNodeClass:function(){return"TreeNode"},_searchPathElement:function(B,C){if(C===undefined){C=false}if(B){var z;var A=this.getRoots();A.forEach(function(D){function E(H){var F=0;var G=null;if(H.options.pathElement&&H.options.pathElement.isAParentOf(B)){if(C){H.expand(1)}if(H._children&&H._isExpanded){for(F=0;F<H._children.length&&!G;F++){G=E(H._children[F])}}if(!G){G=H}}return G}z=D;z=E(D)});return z}}});return h.namespace("WUX/Controls/Tree",o)});define("DS/Layouts/ListView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Layouts/ListViewCellAbstract"],function(f,c,d,a,e){var b=d.extend({defaultOptions:{cellClass:a,defaultCellHeight:28,numberOfColumns:1},init:function(g){this._parent(g);var h=this;this.onPoolUpdate(function(){h.setCellsContainerSize({width:"100%"})});this.elements.container.addClassName("wux-layouts-listview")}});return b});define("DS/Tree/TileGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/TileCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(h,b,g,d,c,e,a){var f=g.extend({defaultOptions:{width:"100%",cellClass:d,defaultCellHeight:70,defaultCellWidth:260,cellSpacing:{horizontal:10,vertical:10},useSwipableMenu:true,responsiveWidthBehavior:false},onTileGridViewResize:function(j){if(!this.options.responsiveWidthBehavior){return}var o=j.width;var m=this.options.defaultCellWidth;var l=this.options.cellSpacing.horizontal;var n=this.getCellsContainerSize().height>this.getScroller().getContent().getDimensions().height?20:0;var p=Math.floor((o-l-n)/(m+l));var k=(o-l-n)-(p*(m+l));if(k>50){var q=p+1;var i=((o-l-n)/q)-l;if(i>=260){this.options.defaultCellWidth=i;this.updateView(true)}else{if(p>0){q=p;var i=((o-l-n)/q)-l;this.options.defaultCellWidth=i;this.updateView(true)}}}},init:function(i){this._parent(i);this._initSpecializedView()},_initSpecializedView:function(){var i=this;this.onCellRequest(function(k){if(!k.isHeader){k.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var j=k.nodeModel;k.cellView.setTitle(j.options.label);k.cellView.setSubtitle(j.options.subLabel);k.cellView.setPicture(j.options.thumbnail);k.cellView.setColor(j.options.color);k.cellView.setDescription(j.options.description);if(j.options.icons&&j.options.icons.length){k.cellView.setIcon(j.options.icons[0])}else{k.cellView.setIcon("")}if(i.options.displayBadges===true){k.cellView.setBadges(k.nodeModel.getBadges())}if(this.options.enableActiveUI){if(j===this.options.activeNode){k.cellView.activate()}}if(j.isSelected()){k.cellView.highlight()}if(this._onPostRequestCellCB){this._onPostRequestCellCB.call(i,k)}}});this.onGridResize(function(j){this.onTileGridViewResize(j)});if(this.elements.container){this.elements.container.addEvent(c.POINTERUP,function(n){if(i.options.selection.unselectAllOnEmptyArea){if(c.isTouchEvent(n)){if(i._preventSelectionForTouchScroll){return}}var l=18;if(n.target.className.indexOf("wux-controls-tile")===-1){var m=h.extendElement(n.target).getDimensions();var k=m.width;var j=m.height;if(n.offsetX<(k-l)&&n.offsetY<(j-l)){if(i.options.TreedocModel){i._disableInteractiveMultiSelMode();i.options.TreedocModel.getXSO().empty()}}}}})}},onPostCellRequest:function(i){this._onPostRequestCellCB=i},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){if((this.options.selection.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-tileView")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-tileView")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-tileView")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-tileView")}}}});return f});define("DS/Tree/CarouselView",["UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/TreeModel/TreeDocument","DS/Windows/DockingElement","DS/Utilities/Css","DS/Tree/ThumbnailGridView","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(g,d,t,m,k,v,l,h,c,a,o,w,i,u,j,f){var n=function(x){if(x.target.classList.contains("wux-layouts-carousel-main-content")){var y=g.Event.wheelDelta(x);if(y<0){p(x.currentTarget._mouseWheelArg)}if(y>0){q(x.currentTarget._mouseWheelArg)}}};var q=function(A){if(A.treeDocument){var x=A.treeDocument.getXSO();var B=x.get();if(B.length===0){A.treeDocument.getRoots()[0].select()}if(B.length>0){var y=B[B.length-1];var z=y.getPreviousVisibleNode();if(z){z.select(true);A.elements.gridView._scrollToNode(z,z._getRowID(true))}}}};var p=function(A){if(A.treeDocument){var x=A.treeDocument.getXSO();var B=x.get();if(B.length===0){A.treeDocument.getRoots()[0].select()}if(B.length>0){var y=B[B.length-1];var z=y.getNextVisibleNode();if(z){z.select(true);A.elements.gridView._scrollToNode(z,z._getRowID(true))}}}};var b=true;var r=false;var e=new h();var s=t.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(x){x.nodeView.setContent(x.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(x){x.nodeView.setContent(x.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(x){e.generateView(x.nodeModel.options.grid,{typePath:"object",readOnly:true,onViewCreated:function(y){x.nodeView.setContent(y)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(x){return x.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(x){x.nodeView.setStyles({backgroundImage:"url("+x.view.bigPicturePath(x)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:true,type:"boolean",category:"behavior"}},buildView:function(){var x=this;this.elements.container=new g.Element("div",{"class":"wux-layouts-carousel",tabindex:0});this.elements.header=new g.Element("div",{"class":"wux-layouts-carousel-header"}).inject(this.elements.container);this.elements.headerMainContainer=new g.Element("div",{"class":"wux-layouts-carousel-header-main-container"}).inject(this.elements.header);this.elements.headerTitleBar=new g.Element("ul",{"class":"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer);this.elements.headerTitle=new g.Element("span",{"class":"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar);this.elements.headerSubtitle=new g.Element("span",{"class":"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar);this.elements.headerToolbar=new g.Element("ul",{"class":"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer);this.elements.containerRel=new g.Element("div",{"class":"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent());if(!r){this.elements.gridView=new l({checkboxVisibleFlag:false,layoutOnSingleRow:true,height:"auto",infiniteScrolling:true,enableActiveUI:true,enableKeyboardNavigation:true,showScrollbarsOnHover:true})}else{this.elements.gridView=new ResponsiveThumbnailsCollectionView({displayedOptionalCellProperties:["None"],showScrollbarsOnHover:true});this.elements.gridView.layout.direction="horizontal";this.elements.gridView.layout.columnMaxWidth=190;this.elements.gridView.layout.useDynamicRowHeight=false;this.elements.gridView.getContent().setAttribute("theme-style","dark")}this.elements.gridView.getContent().setStyles({top:6,height:"auto"});this.elements.rightViewContent=new g.Element("div",{"class":"wux-layouts-carousel-right-content"});this.elements.dockingZoneContentForBottom=new g.Element("div",{"class":"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.gridView,styles:{height:"100%",position:"relative"}});this.elements.mainView=new g.Element("div",{"class":"wux-layouts-carousel-main"});this.elements.bottomDockingElement=new k({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:(r?214:168)+28,resizableFlag:false,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.elements.rightDockingElement=new k({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:true,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView;this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement;this.elements.mainViewContent=new g.Element("div",{"class":"wux-layouts-carousel-main-content"}).inject(this.elements.mainView);this.elements.mainViewLeftArrow=new o({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new j({shortHelp:f.previous,mouseRelativePosition:false}),clickMode:1});this.elements.mainViewRightArrow=new o({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new j({shortHelp:f.next,mouseRelativePosition:false}),clickMode:1});if(b){this.elements.bottomViewLeftArrow=new g.Element("div",{"class":"wux-layouts-carousel-bottom-prev wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom);this.elements.bottomViewRightArrow=new g.Element("div",{"class":"wux-layouts-carousel-bottom-next wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom)}this._observeEvents();this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container)},_postBuildView:function(){var x=this;this._parent()},_observeEvents:function(){var C=this;var D;var E;var y=function(){if(D){clearInterval(D)}if(E){clearInterval(E)}if(!r){C.getGridView()._disableAutoScroll()}};var F=function(){y();q(C);E=setTimeout(function(){D=setInterval(q,C,C.intervalTimer)},500)};var B=function(){y();p(C);E=setTimeout(function(){D=setInterval(p,C,C.intervalTimer)},500)};this.elements.mainViewLeftArrow.addEventListener("buttonclick",F);this.elements.mainViewRightArrow.addEventListener("buttonclick",B);if(b){this.elements.bottomViewLeftArrow.addEvent(i.POINTERDOWN,function(G){G.preventDefault();G.stopPropagation();C.getGridView()._enableAutoScroll({x:-10,y:0},10)});this.elements.bottomViewRightArrow.addEvent(i.POINTERDOWN,function(G){G.preventDefault();G.stopPropagation();C.getGridView()._enableAutoScroll({x:10,y:0},10)})}var z=false;var x=function(I,G,H){z=true;C.getGridView().onPostUpdateViewOnce(function(){z=false;if(H){H.call(C)}});I.call(C,C)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){x(q,C)},right:function(){x(p,C)}}});var A=function(G){G.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",A,false);this.elements.container.addEventListener("contextmenu",A,false);this.elements.mainViewLeftArrow.addEvent("mouseleave",y);this.elements.mainViewRightArrow.addEvent("mouseleave",y);if(b){this.elements.bottomViewLeftArrow.addEvent("mouseleave",y);this.elements.bottomViewRightArrow.addEvent("mouseleave",y);this.elements.bottomViewLeftArrow.addEvent(i.POINTERUP,y);this.elements.bottomViewRightArrow.addEvent(i.POINTERUP,y)}document.body.addEventListener("mouseup",y);document.body.addEventListener("mouseleave",y)},_manageKeyboardNavigation:function(x){var y=this;g.Element.addEvent.call(this.getContent(),"keydown",c.throttle(function(C){var B={input:true,textarea:true};if(B[C.target.tagName.toLowerCase()]===undefined){var z=(u.hasClass(C.target,"wux-layouts-carousel"))?C.target:u.firstParentWithClass(C.target,"wux-layouts-carousel");var D=(z===y.getContent());if(D){var A=g.Event.whichKey(C);if(x.keymap[A]!==undefined){x.keymap[A].call(y)}}}},x.throttleTime))},_applyHeight:function(x){if(this.height==="auto"){this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0})}else{if(typeof this.height==="number"){this.elements.container.setStyles({position:"",height:this.height})}}this._parent(x)},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:true});console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(B){this.elements.gridView.loadGridViewModel(this.treeDocument);if(this.treeDocument){var C=this;var y=this.treeDocument.getXSO();var A=c.debounce(function(D){C.onRightViewRequest(D)},100);var z=function(){var E=y.get();var D=E[E.length-1];C.onMainViewRequest({nodeModel:D,nodeView:C.elements.mainViewContent,view:C});A.call(C,{nodeModel:D,nodeView:C.elements.rightViewContent,view:C});C.onTitleRequest({nodeModel:D,nodeView:C.elements.headerTitle,view:C});C.onSubtitleRequest({nodeModel:D,nodeView:C.elements.headerSubtitle,view:C});if(!r){C.elements.gridView._setActiveNode(D,true)}};if(y.get().length>0){z.call(y)}y.onAdd(z);var x=this.treeDocument.getRoots();if(y.get().length===0&&x.length){this.treeDocument.getRoots()[0].select()}}this._parent(B)},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}},_applyToolBar:function(){var x=this;x.elements.headerToolbar.empty();this.toolbar.forEach(function(z){z.icon.fontIconSize="2x";z.icon.fontIconFamily=WUXManagedFontIcons.Font3DS;var A=new o({type:z.type,tooltipInfos:z.tooltipInfos,icon:z.icon,value:"1",displayStyle:"lite-borders",touchMode:true,clickMode:1}).inject(x.elements.headerToolbar);A.addEventListener("click",function y(B){B.stopPropagation();if(z.callback){z.callback()}})});this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar);this.elements.mainViewRightArrow.inject(this.elements.headerToolbar)},_applyScrollOnMainViewMouseWheel:function(x){if(this.scrollOnMainViewMouseWheel!==x){var y=this;if(this.scrollOnMainViewMouseWheel){this._mouseWheelsubscriptionDoneOneTimeAtLeast=true;g.Element.addEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=y}else{if(this._mouseWheelsubscriptionDoneOneTimeAtLeast===true){this._mouseWheelsubscriptionDoneOneTimeAtLeast=false;g.Element.removeEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=y}}}},_applyProperties:function(x){this._parent(x);this._applyHeight();this._applyTreeDocument();this._applyToolBar();this._applyScrollOnMainViewMouseWheel(x.scrollOnMainViewMouseWheel)},getGridView:function(){return this.elements.gridView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement}});s.USE_COLLECTION_VIEW=r;return s});define("DS/Tree/LightBoxView",["UWA/Core","DS/Core/Core","DS/Tree/CarouselView","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(g,e,b,c,a,f){var d=b.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"}},_preBuildView:function(){this._parent()},_postBuildView:function(){var h=this;window._lb=this;this._parent();this.elements.container.addClassName("wux-layouts-lightbox");this._applyVisibleFlag();var h=this},_applyVisibleFlag:function(h){if(this.visibleFlag){if(!this.elements.wrapper){this.elements.wrapper=new g.Element("div",{"class":"wux-layouts-lightbox-overlay",html:this.getContent()});this.elements.wrapper.inject(this.target)}}else{if(this.elements.wrapper){this.elements.wrapper.remove();this.elements.wrapper=undefined;this.fire("close")}}this._parent(h);var i=this;if(!b.USE_COLLECTION_VIEW){setTimeout(function(){i.getGridView().updateView(true)},1)}},_applyToolBar:function(){this._parent();var j=this;var i=new c({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:f.close,mouseRelativePosition:false}),clickMode:1}).inject(this.elements.headerToolbar);i.addEventListener("click",function h(k){k.stopPropagation();j.visibleFlag=false})}});return d});define("DS/SmartInputs/EulerOrientation",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/SmartInputs/Base","DS/Utilities/Css","DS/SmartInputs/VectorN"],function(d,j,e,h,b,f,c,i){var g="EVT_CHANGE";var a=i.extend({defaultOptions:{label:null,constraints:{minValue:-180,maxValue:180,stepValue:1},value:[0,0,0],graduations:null,units:"mm"},_smartInputClass:"wux-smartinputs-EulerOrientation",init:function(k){this._parent(k,3,"angle")}});return a});define("DS/Spreadsheet/Manager",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Spreadsheet/CellView","UWA/Class","DS/CoreEvents/ModelEvents","DS/Spreadsheet/CellModel","UWA/Utils","DS/Selection/XSO","DS/Layouts/GridEngine","DS/Utilities/Dom","DS/Core/PointerEvents","DS/UIBehaviors/ContextualMenuManager","DS/Core/ActionsStack","DS/Utilities/Data","DS/Utilities/Array","DS/Utilities/Debug","DS/Controls/Switch","DS/SmartInputs/Number","DS/SmartInputs/Angle","DS/SmartInputs/EulerOrientation","DS/SmartInputs/Distance","DS/SmartInputs/Vector3","DS/Controls/Button","DS/Controls/Toggle","DS/Utilities/Utils","DS/Menu/ContextualMenu","DS/WebRecordEnabler/Adapter","css!DS/Menu/assets/css/Menu.css"],function(h,D,L,n,C,d,s,o,k,J,u,x,l,B,H,z,t,f,v,j,c,b,m,p,G,e,E,q,y){var w=false;var K=false;var g={click:"click",dblClick:"dblClick"};function a(O,M){var Q={},P={},N;N=M.offsetParent;Q.x=O.touches?O.touches[0].pageX:O.pageX;Q.y=O.touches?O.touches[0].pageY:O.pageY;P.left=M.offsetLeft;P.top=M.offsetTop;while(N){P.left+=N.offsetLeft;P.top+=N.offsetTop;N=N.offsetParent}return{x:Q.x-P.left,y:Q.y-P.top}}function A(O,N){var M=O;if(M){var P=(" "+M.className+" ").replace(/[\n\t]/g," ").indexOf(" "+N+" ")>-1;if(P){return M}else{return A(M.parentNode,N)}}else{}}function F(N,M){var O=(" "+N.className+" ").replace(/[\n\t]/g," ").indexOf(" "+M+" ")>-1;return O}var r=function(O,M){if(M===undefined){M=0}var N=O.slice(0);return{getCurrent:function(){return N[M]},getNext:function(){M=++M%N.length;return this.getCurrent()},getPrevious:function(){if(--M<0){M+=N.length}return this.getCurrent()}}};var i=t.optimizedForEach;var I=u.extend({defaultOptions:{onCellChange:function(M){return M.event.target.value},scroller:null,viewport:null,sortFunction:function(R,O,N,Q){var P;var S=O[R].getCellContent();var M=N[R].getCellContent();if(S===M){P=0}else{if(Q!=="desc"){P=S<M?-1:1}else{P=S>M?-1:1}}return P}},init:function(N,M){var R=this;if(N.isEditable){var P={switchToWriteView:{event:"dblclick",callback:function(S){this.switchToWriteView()},view:function(U){if(!U.isHeader){var T=U.cellModel.getCellContent().toString();var S=new h.Element("input",{type:"text",value:T,"class":"wux-layouts-treeview-label"});setTimeout(function(){S.setSelectionRange(0,S.value.length)},10);return S}}},switchToReadView:{event:"blur",callback:function(S){this.switchToReadView()},view:function(U){if(!U.isHeader){var T;var S=U.cellModel.getCellContent().toString();if(typeof S==="string"){T=S}else{T=S.toString()}switch(U.dataIndex){default:return T}}}},nodesAreDraggable:true,cells:true};if(N.isEditable===true){N.isEditable=P}else{N.isEditable=h.extend(P,N.isEditable,true)}}this._parent(N);var R=this;this._instance=M;this._highlightedRows=new J({eventChannel:"/MANAGER/"+k.getUUID()});this._selectedRows=new J({useUniqueID:true,getElementID:function(S){return S},publishOnlyPrePostEvents:true,eventChannel:"/MANAGER/"+k.getUUID(),areEquals:function(S,T){return S===T}});this._selectedColumns=new J({eventChannel:"/MANAGER/"+k.getUUID()});this._selectedCells=new J({useUniqueID:true,publishOnlyPrePostEvents:true,eventChannel:"/MANAGER/"+k.getUUID(),areEquals:function(T,S){return T._getID()===S._getID()}});this._modeIsMultiSel=false;this._modeIsRange=false;this._allowSettingMultiSelMode=false;this._multiSelModeHasBeenForced=false;this._selectedRows.empty();this._selectedColumns.empty();this._selectedCells.empty();this._scroller=null;this._viewport=null;this._leftStaticContainer=null;this._topStaticContainer=null;this._cellsContainer=null;this._isPreparingView=0;this._abortComputing=false;this._listOfColumnIsEditableOptionsCached=[];this.options.model=[];this._cellsContentList=[];this._rowsList=[];this._columnsList=[];this._rowIndexes=[];this._listOfColumns=[];this._listOfColumnStates=[];this._listOfCellsInViewPort=[];this._listOfRowsPosition=[];this._listOfColumnPosition=[];this._listOfRowsHeight=[];this._listOfRowsPreviousHeight=[];this._listOfColumnsWidth=[];this._listOfColumnsPreviousWidth=[];this._listOfEditedCells=[];this._columnsReverseIndex=null;this._currentViewPort={rowMin:0,rowMax:0,columnMin:0,columnMax:0};this._previousViewPort={rowMin:0,rowMax:0,columnMin:0,columnMax:0};this._minVisibleCellCoordinates={rowID:1,columnID:1};this._maxVisibleCellCoordinates={rowID:1,columnID:1};this._lastScrollPos={x:0,y:0};this._deltaScrollPos={x:0,y:0};this.registerReusableCellContent({id:"picture",buildContent:function(){var S=R.options.defaultCellHeight-10;return new x.createElement("div",{align:"center",styles:{width:S,height:S,borderRadius:2,backgroundSize:"cover",backgroundPosition:"center",display:"inline-block",border:"1px solid rgb(157, 157, 157)",verticalAlign:"middle",position:"absolute",top:"50%",marginTop:-S/2,left:"50%",marginLeft:-S/2}})}});this.registerReusableCellContent({id:"color",buildContent:function(){var S=R.options.defaultCellHeight-10;return new h.Element("div",{align:"center","class":"wux-datagrid-cell-type-color",styles:{width:S/2,height:S,marginTop:-S/2,marginLeft:-S/4}})}});this.onPoolCellCreation(this._onPoolCellCreation.bind(this));this.onPoolCellDestruction(this._onPoolCellDestruction.bind(this));this._observeSelMultiSel();var O=this;var Q=false;this.onReady(function(){if(Q===false){x.addEventOnElement(this,this.elements.container,l.POINTERDOWN,function(){O._giveFocus()},true);var W=this;var Y;x.addEventOnElement(this,this.getScroller().getContent(),"mouseover",function(aa){var Z=F(aa.target,"wux-datagrid-cell")?aa.target:A(aa.target,"wux-datagrid-cell");if(Z&&Z!==Y){W._modelEvents.publish({event:"newActiveCell",data:Z.dsView.getCellInfos()});Y=Z}});x.addEventOnElement(this,this.getScroller().getContent(),"mouseleave",function(Z){if(F(Z.target,"wux-scroller")){W._modelEvents.publish({event:"newActiveCell",data:null})}});var T=this._getParent().options.onContextualEvent;if(T){q.addEventListener(this.elements.container,{callback:function(Z){return T.callback.call(T["this"],{context:Z.context,infos:Z.info,data:Z.data,treeview:{manager:O}})}})}else{var V=this.options.onContextualMenuReady;var S=V;if(typeof V==="function"){S=function(){console.warn("[DS/Tree/TreeListView] onContextualMenuReady is now deprecated, please use the new onContextualEvent option instead");return V.call(O,{manager:O})}}B.onReady({target:this.elements.container,nodes:S})}if(this.options.selection.unselectAllOnEmptyArea){this._listenToClickOnEmptyArea()}this._listOfEditedCells=[];this._modelEvents.subscribe({event:"cell:write"},function(aa){if(O._listOfEditedCells.length>0){O._listOfEditedCells.forEach(function(ab){if(aa.virtualRowID!==ab.virtualRowID&&aa.virtualColumnID!==ab.virtualColumnID){aa.cellView.switchToReadView()}});O._listOfEditedCells=[]}var Z=document.createAttribute("is-edited");aa.cellView.getContent().setAttributeNode(Z);O._listOfEditedCells.push(aa)});this._modelEvents.subscribe({event:"cell:read-only"},function(Z){Z.cellView.getContent().removeAttribute("is-edited");if(O._listOfEditedCells.length>0){O._listOfEditedCells=[]}});this._getParent()._datagrid.getContent().addEvent("blur",function(aa){setTimeout(function(){if(document.activeElement){var ab=F(document.activeElement,"wux-afr-actionbar")?document.activeElement:A(document.activeElement,"wux-afr-actionbar");var ac=F(document.activeElement,"wux-datagrid")?document.activeElement:A(document.activeElement,"wux-datagrid");if(ac&&(ac.getAttribute("wux-uuid")===O._instance._uxid)&&!ab){O._giveFocus()}else{O._lostFocus()}}},1);if(aa.relatedTarget){var Z=x.firstParentWithClass(aa.relatedTarget,"wux-datagrid");if((!Z||Z!==this)&&!W._multiSelModeHasBeenForced){W._modeIsListSel=false;W._modeIsMultiSel=false}}else{if(!W._multiSelModeHasBeenForced){W._modeIsListSel=false;W._modeIsMultiSel=false}}},true);this._getParent()._datagrid.getContent().addEvent("mouseleave",function(Z){if(!W._multiSelModeHasBeenForced){W._modeIsListSel=false;W._modeIsMultiSel=false}W._allowSettingMultiSelMode=false},true);this._getParent()._datagrid.getContent().addEvent("mouseenter",function(Z){W._allowSettingMultiSelMode=false},true);this._getParent()._datagrid.getContent().addEvent("mousemove",function(Z){W._allowSettingMultiSelMode=true},true);var U;this._getParent()._datagrid.getContent().addEvent("focus",function(ac){if(O.elements.container){var Z=F(ac.target,"wux-datagrid-cell")?ac.target:A(ac.target,"wux-datagrid-cell");var aa=O.elements.container.querySelector(".wux-datagrid-cell[is-edited]");if(aa){var ab=O._getCellViewFromDom(aa);if((Z&&ab.getContent().getAttribute("wux-uuid")!==Z.getAttribute("wux-uuid"))||Z===undefined){ab.switchToReadView()}}if(Z){U=Z.getAttribute("wux-uuid")}O._giveFocus()}},true);this._getParent().elements.formContainer.addEvent("blur",function X(Z){setTimeout(function(){var ab=F(document.activeElement,"wux-datagrid-cell")?Z.target:A(document.activeElement,"wux-datagrid-cell");if(ab){if(ab&&U!==ab.getAttribute("wux-uuid")){O._onCellBlur.call(O,Z)}}else{var aa=F(document.activeElement,"wux-afr-actionbar")?document.activeElement:A(document.activeElement,"wux-afr-actionbar");if(!aa){O._lostFocus()}}},1)},true);this._getParent().elements.formContainer.addEvent("change",this._onCellChange.bind(this));this._getParent().elements.formContainer.addEvent("submit",function(aa){aa.stopPropagation();aa.preventDefault();var Z=document.createEvent("CustomEvent");Z.initCustomEvent("change",true,true,null);if(document.activeElement.tagName!=="BUTTON"&&A(document.activeElement,"wux-datagrid-cell")){document.activeElement.dispatchEvent(Z)}O._giveFocus();return false},true);x.addEventOnElement(this,document,"keydown",function(aa){var Z=h.Event.whichKey(aa);if(Z==="esc"){if(O._listOfEditedCells.length>0){O._listOfEditedCells[0].cellView._cancelChanges()}}});this.getScroller().onScroll(function(){O.__preventDragAndDropOnBlankDuringScrollFlag=true;if(O.__preventDragAndDropOnBlankDuringScroll){clearTimeout(O.__preventDragAndDropOnBlankDuringScroll)}O.__preventDragAndDropOnBlankDuringScroll=setTimeout(function(){O.__preventDragAndDropOnBlankDuringScrollFlag=false},500)})}Q=true})},destroy:function(){x.removeAllEventsOnElement(this);this._instance=null;delete this._instance;this._selectedCells.empty();this._selectedCells=null;if(this.elements.container){B.forget({target:this.elements.container});this.processPoolCells(function(M){B.forget({target:M.cellView.elements.container})});t.clear(this._listOfColumnIsEditableOptionsCached);t.clear(this._cellsContentList);t.clear(this._rowsList);t.clear(this._columnsList);t.clear(this._rowIndexes);t.clear(this._listOfColumns);t.clear(this._listOfColumnStates);t.clear(this._listOfCellsInViewPort);t.clear(this._listOfRowsPosition);t.clear(this._listOfColumnPosition);t.clear(this._listOfRowsHeight);t.clear(this._listOfRowsPreviousHeight);t.clear(this._listOfColumnsWidth);t.clear(this._listOfColumnsPreviousWidth);this._parent()}},_onCellBlur:function(O){var M=A(O.target,"wux-datagrid-cell");if(M){var N=this._getCellViewFromDom(M);N.switchToReadView()}},_onCellChange:function(Q){var N=this;var M=A(Q.target,"wux-datagrid-cell");if(M){var P=N._getCellViewFromDom(M);var R=P.getCellInfos();var O=N._getViewForCell({cellView:P,virtualColumnID:R.virtualColumnID});N.setCellContent(R.virtualRowID,R.virtualColumnID,Q.target.value);R.event=Q;O.switchToReadView.callback.call(P,R);P.notifyModelUpdate();if(K){console.warn("[manager:change]",P,Q.target.value)}return false}},_computePoolSize:function(U,N){var R=this._computeModelSize();if(U===undefined){U=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:R.numberOfRows}if(N===undefined){N=this._poolDimensions.numberOfColumns!==undefined?this._poolDimensions.numberOfColumns:R.numberOfColumns}var S=this.getViewportDimensions();var O=1;var T,Q,P,M;P=Math.ceil(O*parseInt(S.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor);M=Math.ceil(O*parseInt(S.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor);if(this.options.virtualView){T=Math.ceil(Math.max(1,Math.min(P,U))+this._numberOfRowsToRemove);if(!this.options.performances.enableColumnVirtualization){Q=this.getNumberOfColumns()}else{Q=Math.ceil(Math.max(1,Math.max(Math.min(M,N),1))+this._numberOfColumnsToRemove)}}else{T=R.numberOfRows;Q=R.numberOfColumns}this._poolSizeMax={numberOfRows:P,numberOfColumns:M};this._poolSize={numberOfRows:T,numberOfColumns:Q};if(w){console.warn(this.options.id,"Viewport size",S.width,"x",S.height,"px");console.warn(this.options.id,"Generate a pool of ",T,"x",Q,"cells")}},needToIndexRowsPositions:function(){return true},_onPoolCellCreation:function(P){if(!P.cellView){P=P.data}var N=this;var O=P.cellView;var R={screenX:0,screenY:0};P.cellView.getContent().addEvent(l.POINTERDOWN,function(S){R={screenX:S.screenX,screenY:S.screenY}});P.cellView.getContent().addEvent(l.POINTERUP,function(S){if(Math.abs(S.screenX-R.screenX)<5||Math.abs(S.screenY-R.screenY)<5){N._cellViewBindings.onCellPointerUp.call(P,S)}});P.cellView.getContent().addEvent("dblclick",N._cellViewBindings.onCellDblClick.bind(P));if(N.options.isEditable){var Q=O.getVirtualCoordinates();var M=N._getMergedOption("isEditable",Q.virtualColumnID);P.cellView.getContent().addEvent(M.switchToWriteView.event,N._cellViewBindings.onEdition.bind(P))}},_onPoolCellDestruction:function(P){var N=this;if(!P.cellView){P=P.data}var O=P.cellView;P.cellView.getContent().removeEvent(l.POINTERUP,N._cellViewBindings.onCellPointerUp.bind(P));P.cellView.getContent().removeEvent("dblclick",N._cellViewBindings.onCellDblClick.bind(P));if(N.options.isEditable){var Q=O.getVirtualCoordinates();var M=N._getMergedOption("isEditable",Q.virtualColumnID);if(M){P.cellView.getContent().removeEvent(M.switchToWriteView.event,N._cellViewBindings.onEdition)}}},_cellViewBindings:{onCellPointerUp:function(O){var Q=this.cellView.getCellInfos();var N=Q.manager;if(!Q.cellView){Q=Q.data}var P=Q.cellView;if(O.button===0){var R=P.getVirtualCoordinates();var M=N.getCell(R.virtualRowID,R.virtualColumnID);N._modelEvents.publish({event:g.click,context:M,data:{model:M,view:P,cellModel:M,cellView:P,dataIndex:N.getDataIndexFromColumnID(R.virtualColumnID),virtualRowID:R.virtualRowID,virtualColumnID:R.virtualColumnID,isHeader:!(R.virtualColumnID>-1&&R.virtualRowID>-1)}})}},onCellDblClick:function(O){var Q=this.cellView.getCellInfos();var N=Q.manager;if(!Q.cellView){Q=Q.data}var P=Q.cellView;var R=P.getVirtualCoordinates();var M=N.getCell(R.virtualRowID,R.virtualColumnID);N._modelEvents.publish({event:g.dblClick,context:M,data:P.getCellInfos()})},onEdition:function(O){var P=this.cellView.getCellInfos();var M=P.manager;if(P.cellView.getContent().getAttributeNode("is-edited")){return}var N=M._getViewForCell({cellView:P.cellView,virtualColumnID:P.virtualColumnID});P.event=O;N.switchToWriteView.callback.call(P.cellView,P)}},loadModel:function(M,N){this._parent(M,N)},appendToModel:function(M,O){var N=this;N.prepareUpdateView();i(M.data,function(P){N.addRow(P)});N.pushUpdateView();if(O){O.call(this)}},exportColumnsPreferences:function(){return JSON.stringify(this.options.columns)},restoreColumnsPreferences:function(N){var O=this;var P=JSON.parse(N);var M={};P.forEach(function(R,Q){M[R.dataIndex]=Q});this.options.columns.forEach(function(R,Q){h.extend(O.options.columns[Q],P[M[R.dataIndex]],true)});this.updateView(true)},_postInitialization:function(){this.options.model=this.options.model.length?this.options.model:this.options.model;this._rowsList=[];var N=this.options.model.length;for(var P=0;P<N;P++){this._rowsList[P]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:P,columnID:-1,value:"",manager:this})}this._columnsList=[];var M=this.getNumberOfColumns();for(var O=0;O<M;O++){this._columnsList[O]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:-1,columnID:O,value:this.options.columns[O].text,manager:this})}this._listenEvents()},_endResizeCallback:function(){if(this.getContent()){this._setColumnsWidth();this._parent()}},scrollToRow:function(P,M){var O=this;var N=this.getRowPosition(P);var Q;switch(M){case"top":Q=Math.max(N,0);break;default:case"middle":Q=Math.max(N-O._viewportDimensions.height/2,0);break;case"bottom":Q=Math.max(N-O._viewportDimensions.height+this.options.defaultCellHeight,0);break}O.getScroller().setPosition({y:Q},true)},getCellModel:function(N,M){if(M===-1){if(!this._rowsList[N]){this._rowsList[N]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:N,columnID:-1,value:null,manager:this})}return this._rowsList[N]}else{if(N===-1){if(!this._columnsList[M]){this._columnsList[M]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:-1,columnID:M,value:null,manager:this})}return this._columnsList[M]}else{if(this.options.model[N]&&this.options.model[N][M]){return this.options.model[N][M]}}}},_getCellsModel:function(){return this.options.model},_initialize:function(){},updateRowViewWithException:function(N,M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}var O=this;this.processCellsOfRow(N,function(P,R,Q){if(Q!==M){O.updateCellView(R,Q)}});this._preventNextRowUpdateView=false},updateRowView:function(M){if(!this._preventNextRowUpdateView){this._preventNextRowUpdateView=false;this._renderRow(M)}},preventNextUpdateRowView:function(){console.log("prevent next update view");this._preventNextRowUpdateView=true},_doesCellNeedToDisplayed:function(N){var M=N.cellModel;if(M.isMerged()){return false}else{return true}},updateCellView:function(R,Q){if(typeof Q==="string"){Q=this.getColumnIDFromDataIndex(Q)}var M=this.getVirtualViewport(false);if((M.minRowID<=R&&R<=M.maxRowID&&M.minColumnID<=Q&&Q<=M.maxColumnID)||(R===-1||Q===-1)){var O=this.getCell(R,Q);if(O){var N=O.getView();var P=this;if(N){N.updateInternalParameters();if(R===-1){P._onRequestColumnHeaderCB.call(P,N.getCellInfos())}else{if(Q===-1){P._onRequestRowHeaderCB.call(P,N.getCellInfos())}else{P._onRequestCellCB.call(P,N.getCellInfos())}}}}}},_observeSelMultiSel:function(){var M=this;if(!this._multiSelModeHasBeenForced){this._modeIsMultiSel=false;this._modeIsListSel=false}x.addEventOnElement(this,document,"keydown",function(O){var N=h.Event.whichKey(O);switch(N){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":M._modeIsListSel=true;if(M._allowSettingMultiSelMode&&!M._multiSelModeHasBeenForced){M._modeIsMultiSel=true}break;case"ctrl":if(M._allowSettingMultiSelMode&&!M._multiSelModeHasBeenForced){M._modeIsMultiSel=true}break;default:}});x.addEventOnElement(this,document,"keyup",function(O){var N=h.Event.whichKey(O);switch(N){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":if(!M._multiSelModeHasBeenForced){M._modeIsListSel=false;M._modeIsMultiSel=false}break;case"ctrl":if(!M._multiSelModeHasBeenForced){M._modeIsMultiSel=false}break;default:}if(N==="enter"&&M._isInEdition){M._isInEdition=false}})},isInMultiSelection:function(){return(this._modeIsMultiSel||this._modeIsListSel)&&this.options.selection.canMultiSelect},isInListSelection:function(){return(this._modeIsMultiSel&&this._modeIsListSel)&&this.options.selection.canMultiSelect},forceMultiSelection:function(M){if(M===undefined){M=true}this._modeIsMultiSel=M&&this.options.selection.canMultiSelect;this._multiSelModeHasBeenForced=true},_listenToClickOnEmptyArea:function(){var M=this;x.addEventOnElement(this,this.elements.container,"click",function(N){if(N.target.className.indexOf("wux-scroller")!==-1){M.unselectAll()}})},_listenEvents:function(){var M=this;this.onMoveRow(function(N){M.processCellsOfRow(N.toRowID,function(O){if(O.options.rowID===N.fromRowID){O.options.rowID=N.toRowID}})});this._selectedCells.onPostAdd(function(N){N.forEach(function(O){O.highlight();if(O._view&&parseInt(O._view.elements.container.getAttribute("virtual-row-id"),10)===O.options.rowID&&parseInt(O._view.elements.container.getAttribute("virtual-column-id"),10)===O.options.columnID){O._view.highlight()}})});this._selectedCells.onPostRemove(function(N){N.forEach(function(O){O.unhighlight();if(O._view&&parseInt(O._view.elements.container.getAttribute("virtual-row-id"),10)===O.options.rowID&&parseInt(O._view.elements.container.getAttribute("virtual-column-id"),10)===O.options.columnID){O._view.unhighlight()}})});x.addEventOnElement(this,document,"keydown",function(O){var N=h.Event.whichKey(O);if(N==="ctrl"&&!M._modeIsMultiSel&&M._allowSettingMultiSelMode&&!M._multiSelModeHasBeenForced){M._modeIsMultiSel=true}if(N==="shift"&&!M._modeIsRange){M._modeIsRange=true}});x.addEventOnElement(this,document,"keyup",function(O){var N=h.Event.whichKey(O);if(N==="ctrl"&&!M._multiSelModeHasBeenForced){M._modeIsMultiSel=false}if(N==="shift"&&M._modeIsRange){M._modeIsRange=false}});this.onCellPointerDown(function(Q){var N=Q.cellView;var R=N.getVirtualCoordinates();var P=R.virtualRowID;var O=R.virtualColumnID;if(w){console.log("----->",this,Q,P,O)}if(!M.__disableInteractiveSort){if(O===-1){if(M.options.selection.rowHeaders){if(M.options.selection.canMultiSelect){if(!M.isRowSelected(P)){M.prepareUpdateView();if(!Q.event.ctrlKey){M._selectedCells.empty()}M.selectRow(P,!Q.event.ctrlKey);M.pushUpdateView()}}else{M.prepareUpdateView();M._selectedCells.empty();M.selectRow(P);M.pushUpdateView()}}}}});x.addEventOnElement(M,M.getContent(),"click",function(){M._hasBeenClicked=true;setTimeout(function(){M._hasBeenClicked=false},200)});this.onCellClick(function(N){var R=N.cellModel;var Z=N.cellView;var ac=Z.getVirtualCoordinates();var P=ac.virtualRowID;var ad=ac.virtualColumnID;if(!M.__disableInteractiveSort){if(P===-1){var ag=M._getColumnOptionValue(ad,"isSortable");var Y=["sort:asc","sort:desc"];var ah=M._getColumnState(ad);var W=r(Y,Y.indexOf(ah));var V=W.getNext();switch(V){case"sort:desc":if(ag){M.prepareUpdateView();M.sortColumnContent(ad,{typeOfCell:"number",sortOrder:"desc"});M.pushUpdateView()}break;case"sort:asc":if(ag){M.prepareUpdateView();M.sortColumnContent(ad,{typeOfCell:"number",sortOrder:"asc"});M.pushUpdateView()}break}}if(P!==-1&&ad!==-1&&M.options.selection.cells){M.prepareUpdateView();M._preventNextUpdateView();M.unselectAll({cells:true,updateView:false});if(M._modeIsRange){var ai=R;var X=M._selectedCells.get()[0];M._selectedCells.empty();M._selectedCells.add(X);var af,ae;var S,U,O,Q;var ab=X.getView().getVirtualCoordinates();var T=ai.getView().getVirtualCoordinates();if(ab.virtualRowID<T.virtualRowID){S=ab.virtualRowID;U=T.virtualRowID}else{U=ab.virtualRowID;S=T.virtualRowID}for(af=S;af<=U;af++){if(ab.virtualColumnID<T.virtualColumnID){O=ab.virtualColumnID;Q=T.virtualColumnID}else{Q=ab.virtualColumnID;O=T.virtualColumnID}for(ae=O;ae<=Q;ae++){if(!(af===ab.virtualRowID&&ae===ab.virtualColumnID)){var aa=M.getCell(af,ae);M._selectedCells.add(aa)}}}}else{if(M._modeIsMultiSel){M._selectedCells.add(R)}else{M._selectedCells.unique(R)}}M.pushUpdateView()}}})},_enableDisableInteractiveSort:E.debounce(function(){this.__disableInteractiveSort=this.__disableInteractiveSortNext;if(this.__disableInteractiveSort===false){}else{}},1000),_disableInteractiveSort:function(M){if(M===true){this.__disableInteractiveSort=true;this.__disableInteractiveSortNext=true}else{this.__disableInteractiveSortNext=true;this._enableDisableInteractiveSort()}},_enableInteractiveSort:function(){this.__disableInteractiveSortNext=false;this._enableDisableInteractiveSort()},getCell:function(O,N){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}if(N!==undefined){var M=this.getCellModel(O,N);if(M){if(M.options.shiftRowSpan){O=O+M.options.shiftRowSpan}if(M.options.shiftColSpan){N=N+M.options.shiftColSpan}}if(N===-1){if(!this._rowsList[O]){this._rowsList[O]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:O,columnID:-1,value:null,manager:this})}return this._rowsList[O]}else{if(O===-1){if(!this._columnsList[N]){this._columnsList[N]=new o({isHeader:true,isStatic:false,isEditable:false,rowID:-1,columnID:N,value:null,manager:this})}return this._columnsList[N]}else{if(this.options.model[O]&&this.options.model[O][N]){return this.options.model[O][N]}}}}},_getCellViewFromDom:function(N,M){if(M){var O=A(N,"wux-datagrid-cell");if(O){return O.dsView}else{}}else{return N.dsView}},_getCellViewDom:function(N,M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}return this.elements.container.querySelector('.wux-datagrid-cell[virtual-row-id="'+N+'"][virtual-column-id="'+M+'"]')},_getCellView2:function(N,M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}return this.elements.container.querySelector('.wux-datagrid-cell[virtual-row-id="'+N+'"][virtual-column-id="'+M+'"]').dsView},_getCellView:function(N,M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}if(N===-1){return this._listOfRenderedColumnHeaders[N+"_"+M]}else{if(M===-1){return this._listOfRenderedRowHeaders[N+"_"+M]}else{return this._listOfRenderedCells[N+"_"+M]}}},getCellContent:function(O,N){var M=this.getCell(O,N);if(M){return M.getCellContent()}},setCell:function(O,M,N){if(M===-1){this._rowsList[O]=N}else{if(O===-1){this._columnsList[M]=N}else{if(this.options.model[O]===undefined){this.options.model[O]=[]}this.options.model[O][M]=N}}},_getColumnIdentifiers:function(O){var M,N;if(typeof O==="string"){N=O;M=this.getColumnIDFromDataIndex(O)}else{M=O;N=this.getDataIndexFromColumnID(O)}return{literalColumnID:N,numericalColumnID:M}},setCellContent:function(R,P,Q){var N=this.getCell(R,P);if(N){var M,O;if(typeof P==="string"){O=P;M=this.getColumnIDFromDataIndex(P)}else{M=P;O=this.getDataIndexFromColumnID(P)}N.setCellContent(Q);this._modelEvents.publish({event:"changeContent",data:{cellModel:N,rowID:R,columnID:M,virtualRowID:R,virtualColumnID:M,dataIndex:O,value:Q}})}},onCellContentChange:function(M){return this._modelEvents.subscribe({event:"changeContent"},M)},getRow:function(O,P){var M;if(O===-1){M=this._columnsList}else{M=this.options.model[O]}if(P===undefined){P=0}switch(P){default:case 0:return M;case 1:var N={};i(this.options.columns,function(R,Q){N[R.dataIndex]=M[Q].getCellContent()});return N}},getRows:function(O){switch(O){case 1:var N=[];var M=this;this.processRows(function(Q,P){N.push(M.getRow(P,1))});return N;default:return this.options.model}},getNumberOfColumns:function(){return this.options.columns.length},getNumberOfVisibleColumns:function(){var N=0;var M=this;this.options.columns.forEach(function(O){if(M.getColumnWidth(O.dataIndex)>0){N++}});return N},getLastVisibleColumnDataIndex:function(){var N;var M=this;this.options.columns.forEach(function(O){if(M.getColumnWidth(O.dataIndex)>0){N=O.dataIndex}});return N},getColumns:function(){return this._instance.options.columns||[]},getColumn:function(O,M){if(typeof O==="string"){O=this.getColumnIDFromDataIndex(O)}if(M===undefined){M=false}var N=[];this.processCellsOfColumn({columnID:O,updateView:false},function(P){N.push(P)});return N},getColumnOptions:function(M){if(M!==-1){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}return this.options.columns[M]}else{return{}}},setColumnOptions:function(N,M){if(N!==-1){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}h.extend(this.options.columns[N],M)}},_getMergedOption:function(P,Q){if(typeof Q==="string"){Q=this.getColumnIDFromDataIndex(Q)}var S=this.getColumnOptions(Q);var N=S?S[P]:{};var M=this.options[P];if(N!==undefined){var O={opt:N};var R={opt:M};return h.extend(R,O,true).opt}else{return M}},_getColumnOptionValue:function(P,O){if(typeof P==="string"){P=this.getColumnIDFromDataIndex(P)}if(P>-1){var M=this.options[O];var N=this.getColumnOptions(P)[O];if(M!==undefined){if(N!==undefined){return N}else{return M}}else{if(N!==undefined){return N}}}},getColumnContent:function(P,M){if(typeof P==="string"){P=this.getColumnIDFromDataIndex(P)}if(M===undefined){M=false}var O=[];var N=0;i(this.options.model,function(Q){if(N>0&&!M){O.push(Q[P])}N++});return O},setColumn:function(M,N){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.processCellsOfColumn(N,function(O,Q,P){if(Q>0){O.setCellContent(M[Q-1].getCellContent())}})},setColumnContent:function(M,N){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.processCellsOfColumn(N,function(O,Q,P){if(Q>0){O.setCellContent(M[Q-1])}})},setRow:function(N,M){this.processCellsOfRow(M,function(O,Q,P){O.setCellContent(N[P])})},setRowModel:function(O,P){var N=this;N.prepareUpdateView();for(var M in P){N.setCellContent(O,M,P[M])}N.pushUpdateView()},getRowModel:function(M){return this.getRow(M,1)},_getParent:function(){return this._instance._parentObject||this._instance},setColumnOrderState:function(M,N){this._setColumnState(M,"sort:"+N);this._updateViewColumnSort(M)},getColumnOrderState:function(M){var N=this._getColumnState(M);return N?N.replace("sort:",""):"none"},getOrderedColumnState:function(){var M;var N=this;this.options.columns.forEach(function(O,P){var Q=N.getColumnOrderState(O.dataIndex);if(Q==="asc"||Q==="desc"){M={columnID:P,dataIndex:O.dataIndex,sortOrder:Q}}});return M},_updateViewColumnSort:function(O){if(typeof O==="string"){O=this.getColumnIDFromDataIndex(O)}var N=this._getColumnState(O);var M=this.getCellModel(-1,O);this.prepareUpdateView();switch(N){case"sort:none":M.removeClass("wux-ui-sort-desc");M.removeClass("wux-ui-sort-asc");break;case"sort:desc":M.addClass("wux-ui-sort-desc");M.removeClass("wux-ui-sort-asc");break;case"sort:asc":M.removeClass("wux-ui-sort-desc");M.addClass("wux-ui-sort-asc");break}this.pushUpdateView()},_setColumnState:function(N,O){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}var M=this.getOrderedColumnState();if(M){this._listOfColumnStates[M.columnID]=null}this._listOfColumnStates[N]=O},_getColumnState:function(M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}return this._listOfColumnStates[M]},sortColumnContent:function(R,N){var Q=this;this.prepareUpdateView();if(typeof R==="string"){R=this.getColumnIDFromDataIndex(R)}var P=this._getColumnIdentifiers(R);var S=this.getColumnOptions(P.numericalColumnID);N=h.extend({sortOrder:"asc",sortFunction:S.sortFunction||function(V,U){var X;var Y=V[R].getCellContent();var T=U[R].getCellContent();if(Y===T){X=0}else{var Z=Number(Y);var W=Number(T);if(isNaN(Z)||isNaN(W)){X=Y<T?-1:1}else{X=Z<W?-1:1}}return X}},N);if(N.sortFunction){this._setColumnState(R,"sort:"+N.sortOrder);for(var O=0;O<this.getRow(-1).length;O++){if(O!==R){var M=Q.getRow(-1)[O];if(M._view){M._view.getContent().removeClassName("wux-ui-sort-desc");M._view.getContent().removeClassName("wux-ui-sort-asc")}M.removeClass("wux-ui-sort-desc");M.removeClass("wux-ui-sort-asc")}}this.getCell(-1,R).removeClass("wux-ui-sort-desc");this.getCell(-1,R).removeClass("wux-ui-sort-asc");this.getCell(-1,R).addClass("wux-ui-sort-"+N.sortOrder);this.options.model.sort(function(V,U){var T=N.sortOrder==="asc"?1:-1;return T*N.sortFunction(V,U)});this._modelEvents.publish({event:"sort",data:{columnID:R,columnDataIndex:this.getDataIndexFromColumnID(R),sortOrder:N.sortOrder}});this._computeVirtualViewport();this.pushUpdateView(true)}},onSortColumnContent:function(M){return this._modelEvents.subscribe({event:"sort"},M)},_setColumnsWidth:function(){var U=false;if(U){console.log("[] --- Compute columns width ---")}var S=this;this.setCellsContainerSize({width:0},false);var O=Math.floor(S.getContent().getBoundingClientRect().width);var Q=(O-S.getHeadersDimensions().width);if(this.getCellsContainerSize().width>Q){Q=this.getCellsContainerSize().width}var P=0;if(this.getScroller()){P=this.getCellsContainerSize().height>this.getScroller().getContent().getDimensions().height?20:0}var M=Q-P;var N=[];this._columnsReverseIndex={};i(S.options.columns,function(Z,W){var Y=S.options.defaultCellWidth;S._columnsReverseIndex[Z.dataIndex]=W;if(!S.isColumnHidden(W)||Z.isHidden!==true){if(Z.width===undefined){Z.width=S.options.defaultCellWidth}if(Z.width!==undefined){if(Z.width==="minimal"){var X=S._computeMinimalColumnWidth(Z.dataIndex);if(X){Y=X;if(U){console.log(W,Z.dataIndex,"->",X,"min",M)}}else{N.push(W)}}else{if(Z.width!=="auto"){if(typeof Z.width!=="number"&&Z.width.indexOf("%")!==-1){var V=Math.floor(Q*parseInt(Z.width,10)/100)-1;if(V<=0){V=S.options.defaultCellWidth}Y=V;if(U){console.log(W,Z.dataIndex,Z.width,"->",V,"px",M)}}else{Y=Z.width;if(U){console.log(W,Z.dataIndex,Z.width,"->",Z.width,"px",M)}}}else{Y=0;N.push(W)}}}}else{Y=0;if(U){console.log(W,Z.dataIndex,Z.width,"->",0,"px",M)}}if(!S.isColumnHidden(W)&&Z.width!=="auto"){var X=(Z.minWidth!==null&&Z.minWidth!==undefined)?Z.minWidth:0;var aa=(Z.maxWidth!==null&&Z.maxWidth!==undefined)?Z.maxWidth:Infinity;Y=Math.min(aa,Math.max(X,Y))}M=M-Y;S._setColumnWidth(W,Y,false)});i(N,function(Z,V){var Y=S.options.columns[Z];var ab=Math.floor((M)/(N.length-V));var X=Math.max(S.options.defaultCellWidth,ab);if(!S.isColumnHidden(V)){var W=(Y.minWidth!==null&&Y.minWidth!==undefined)?Y.minWidth:0;var aa=(Y.maxWidth!==null&&Y.maxWidth!==undefined)?Y.maxWidth:Infinity;X=Math.min(aa,Math.max(W,X))}M=M-X;S._setColumnWidth(Z,X,false);if(U){console.log(Z,S.getDataIndexFromColumnID(Z),"->",X,"auto",M)}});this._indexColumnsPosition({fromColumnID:0,async:false});var R=S.getLastVisibleColumnDataIndex();var T=S.getColumnPosition(R)+S.getColumnWidth(R);S.setCellsContainerSize({width:T},true);if(U){console.log(this.options.columns)}},_applyCellsContainerSizeIfNeeded:function(){if(this._needToApplyCellContainerSizer===true){this._setColumnsWidth()}this._parent()},_computeMinimalColumnWidth:function(S,X){if(X===undefined){X=true}if(typeof S==="string"){S=this.getColumnIDFromDataIndex(S)}var M=0;var V=new h.Element("div",{styles:{display:"inline-block",position:"relative",opacity:1}}).inject(this.elements.poolContainerRel,"top");var T;if(X){T=this.getContent().querySelectorAll('.wux-datagrid-cell[virtual-column-id="'+S+'"]')}else{T=this.elements.poolContainerRel.querySelectorAll('.wux-datagrid-cell[virtual-column-id="'+S+'"]')}var O=T.length;for(var R=0;R<O;R++){var Q=T[R];var U=Q.cloneNode(true);U.style.display="inline-block";U.style.transform="";U.style.position="static";U.style.width="";U.style.top="";U.style.left="";var W=U.querySelector(".wux-layouts-treeview-node");if(W){W.style.position="static"}V.setHTML(U);var P=V.getDimensions().width;if(P>M){M=P}}V.remove();var N=M+10;return N},sizeColumnToFit:function(M,N){if(N===undefined){N=true}if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}this.onPostUpdateViewOnce(function(){this.prepareUpdateView();this.setColumnWidth(M,this._computeMinimalColumnWidth(M,N));this.pushUpdateView()});this.prepareUpdateView();this.setColumnWidth(M,this._computeMinimalColumnWidth(M,N));this.pushUpdateView()},getCellMinimalDimensions:function(Q,P){if(typeof P==="string"){P=this.getColumnIDFromDataIndex(P)}var O=new h.Element("div",{styles:{display:"inline-block",opacity:0}}).inject(this.elements.container);var N=this.elements.container.querySelector('.wux-datagrid-cell[virtual-row-id="'+Q+'"][virtual-column-id="'+P+'"]');if(N){var M=N.parentNode;O.setHTML(N);var R=O.getDimensions();M.appendChild(N)}return R},setColumnWidth:function(P,M,O){if(P!==undefined){if(M<0){M=0}if(typeof P==="string"){P=this.getColumnIDFromDataIndex(P)}this.options.columns[P].width=M;this._requireFullUpdate();this._invalidateLayout();var N=this;setTimeout(function(){N._instance._hideColumnInsertionMark()},100);this._setColumnsWidth();this._modelEvents.publish({event:"/MANAGER/COLUMN/WIDTH",data:{dataIndex:this.getDataIndexFromColumnID(P),columnID:P,width:M}})}},_setColumnWidth:function(P,N,O){if(O===undefined){O=true;this.prepareUpdateView()}if(P===-1){this._setHeadersDimensions({width:N})}else{if(typeof P==="string"){P=this.getColumnIDFromDataIndex(P)}var M=this.getColumnWidth(P);this.setCellsContainerSize({width:this.getCellsContainerSize()-M+N},false);this._listOfColumnsWidth[P]=N;this._modelEvents.publish({event:"/MANAGER/COLUMN/WIDTH",data:{columnID:P,width:N}});if(O){this._indexColumnsPosition({fromColumnID:P,onVisibleComplete:this.pushUpdateView.bind(this),async:false})}}},getCellPosition:function(N,M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}var P=this.getRowPosition(N);var O=this.getColumnPosition(M);return{top:P,left:O}},getColumnWidth:function(M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}if(M===-1){return this.getHeadersDimensions().width}else{return this._listOfColumnsWidth&&this._listOfColumnsWidth[M]!==undefined?this._listOfColumnsWidth[M]:this.options.defaultCellWidth}},isColumnHidden:function(M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}return this.options.columns[M].isHidden||this.getColumnWidth(M)===0},_renderCell:function(N){if(window.__karma__===undefined){var M=this.getDataIndexFromColumnID(N.virtualColumnID);if(N.virtualColumnID===-1||M!==undefined){if(N.virtualColumnID===-1||this.isColumnHidden(M)===false){return this._parent(N)}}}else{return this._parent(N)}},onColumnWidthUpdate:function(M){return this._modelEvents.subscribe({event:"/MANAGER/COLUMN/WIDTH"},M)},setCellSpan:function(S,R,O){this.prepareUpdateView();O=h.extend({rowSpan:1,colSpan:1,shiftRowSpan:0,shiftColSpan:0},O);var N=this.getCell(S,R);N.resetSpan();for(var Q=0;Q<O.rowSpan;Q++){for(var M=0;M<O.colSpan;M++){var P=this.getCell(S+Q,R+M);P.setRowSpan(O.rowSpan,-Q);P.setColSpan(O.colSpan,-M)}}this.pushUpdateView()},setRowHeight:function(O,M,N){if(N===undefined){N=true}this.prepareUpdateView();this._invalidateLayout();this._instance._hideRowInsertionMark();var P=this.getRowHeight(O);this.setCellsContainerSize({height:this.getCellsContainerSize().height-P+M},false);this._listOfRowsHeight[O]=M;this._modelEvents.publish({event:"/MANAGER/ROW/HEIGHT",data:{rowID:O,height:M}});if(this.needToIndexRowsPositions()&&N){this._needToIndexRowsPosition();this.pushUpdateView()}else{this.pushUpdateView()}},_needToIndexRowsPosition:function(){this._updateViewOptions.onPreUpdate=function(){this._indexRowsPosition({fromRowID:0,async:false})}},_indexRowsPosition:function(O){var Q=this;if(this._timeoutRowsPosIndexation){clearTimeout(this._timeoutRowsPosIndexation)}O=h.extend({fromRowID:0,toRowID:Q.getNumberOfRows(),oncomplete:null,onVisibleComplete:null,async:true},O);var M=this.getVisibleViewport();var P=false;var N=function(){var S="[Manager] - Index row position";f.beginMeasure(S);for(var R=O.fromRowID;R<O.toRowID+1;R++){var T=0;if(R>0){T=Q.getRowHeight(R-1)+Q.getRowPosition(R-1)}Q._listOfRowsPosition[R]=T;if(R===M.maxRowID){if(O.onVisibleComplete){P=true;O.onVisibleComplete.call(Q)}}}if(P===false){if(O.onVisibleComplete){P=true;O.onVisibleComplete.call(Q)}}f.endMeasure(S);if(O.oncomplete){O.oncomplete.call(Q)}};if(O.async){this._timeoutRowsPosIndexation=setTimeout(N,1)}else{N()}},_getVirtualPositionFromScrollPosition:function(P){if(P===undefined){if(this.getScroller()){P=this.getScrollerPosition()}else{P={x:0,y:0}}}var O=Math.floor(P.y/this.options.defaultCellHeight);var N=Math.floor(P.x/this.options.defaultCellWidth);var M={rowID:O,columnID:N};if(this.getRowPosition(M.rowID)<P.y){while(this.getRowPosition(M.rowID)<P.y){M.rowID++}M.rowID--}else{if(this.getRowPosition(M.rowID)>P.y){while(this.getRowPosition(M.rowID)>P.y){M.rowID--}}}if(this.options.performances.enableColumnVirtualization){if(this.getColumnPosition(M.columnID)<P.x){while(this.getColumnPosition(M.columnID)<P.x){M.columnID++}M.columnID--}else{if(this.getColumnPosition(M.columnID)>P.x){while(this.getColumnPosition(M.columnID)>P.x){M.columnID--}}}}return M},getRowPosition:function(M){if(M===0){return 0}else{if(this.needToIndexRowsPositions()&&this._listOfRowsPosition[M]!==undefined){return this._listOfRowsPosition[M]}else{return(M)*this.options.defaultCellHeight}}},_indexColumnsPosition:function(O){var Q=this;O=h.extend({fromColumnID:0,toColumnID:this.getNumberOfColumns(),oncomplete:null,onVisibleComplete:null,async:true},O);if(this._timeoutColumnsPosIndexation){clearTimeout(this._timeoutColumnsPosIndexation)}var M=this.getVisibleViewport();var P=false;var N=function(){for(var R=O.fromColumnID;R<=O.toColumnID+1;R++){var S=0;if(R>0){S=Q.getColumnWidth(R-1)+Q.getColumnPosition(R-1)}Q._listOfColumnPosition[R]=S;if(R===M.maxColumnID){if(O.onVisibleComplete){P=true;O.onVisibleComplete.call(Q)}}}if(P===false){if(O.onVisibleComplete){P=true;O.onVisibleComplete.call(Q)}}if(O.oncomplete){O.oncomplete.call(Q)}};if(O.async){this._timeoutColumnsPosIndexation=setTimeout(N,1)}else{N()}},getColumnPosition:function(M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}if(M===0){return 0}else{if(this._listOfColumnPosition[M]!==undefined&&this._listOfColumnPosition[M]!==null){return this._listOfColumnPosition[M]}else{return(M)*this.options.defaultCellWidth}}},getRowHeight:function(M){if(M===-1){return this.getHeadersDimensions().height}else{return this._listOfRowsHeight&&this._listOfRowsHeight[M]!==undefined?this._listOfRowsHeight[M]:this.options.defaultCellHeight}},onRowHeightUpdate:function(M){return this._modelEvents.subscribe({event:"/MANAGER/ROW/HEIGHT"},M)},removeRows:function(N){var M=this;i(N,function(O){M.removeRow(O)})},removeRow:function(M){this.prepareUpdateView();this.hideRow(M);this.unselectRow(M);this.processCells(function(N,O,P){N.options.rowID=O-1},{minRowID:M+1,minColumnID:0});this.options.model.splice(M,1);this._listOfRowsPosition.splice(M,1);this._listOfRowsHeight.splice(M,1);this._listOfRowsPreviousHeight.splice(M,1);this._listOfRowsPreviousHeight.splice(M,1);this._needToIndexRowsPosition();this.pushUpdateView(true);this._processRowModel(M,function(N){N.destroy()});this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"/MANAGER/ROWS/REMOVE",data:{rowID:M}})},onRemoveRow:function(M){this._modelEvents.subscribe({event:"/MANAGER/ROWS/REMOVE"},M)},removeColumn:function(N){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.prepareUpdateView();var M=this;this.hideColumn(N);this.unselectColumn(N);this.processCellsOfColumn(N,function(O,P,Q){M._onDetachFromView(P,Q,true)});this.processCells(function(O,P,Q){O.options.columnID=Q-1},{minRowID:0,minColumnID:N});this.processRows(function(P,O){M.options.model[O].splice(N,1)});this._setColumnsWidth();M.options.columns.splice(N,1);this.updateView(true);this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"/MANAGER/COLUMNS/REMOVE",data:{columnID:N}});this.pushUpdateView()},processCellsOfColumn:function(Q,T){var R=0;var N={columnID:0,minRowID:0,maxRowID:this.options.model.length,updateView:true};var P={};if(typeof Q==="object"){P=Q}else{P.columnID=Q}P=h.extend(N,P);if(typeof P.columnID==="string"){P.columnID=this.getColumnIDFromDataIndex(P.columnID)}var O=this.options.model;var M=O.length;for(R=0;R<M;R++){var S=O[R];if(T&&S[P.columnID]!==undefined){if(T&&R>=P.minRowID&&R<=P.maxRowID){T.call(S[P.columnID],S[P.columnID],R,P.columnID)}}}if(P.updateView){this.updateView()}},_processRowModel:function(Q,R){var O=this.options.model[Q];if(O!==undefined){var M=O.length;var N=this.getCell(Q,-1);R.call(N,N);for(var P=0;P<M;P++){var N=this.getCell(Q,P);R.call(N,N)}}},processCellsOfRow:function(R,S){var Q=0;if(!S){return}var M={rowID:0,minColumnID:0,maxColumnID:this.options.model[0]?this.options.model[0].length:0};var O={};if(typeof R==="object"){O=R}else{O.rowID=R}O=h.extend(M,O);if(O.rowID!==-1){var N=this.options.model[O.rowID];if(N!==undefined){for(Q=O.minColumnID;Q<O.maxColumnID;Q++){var P=this.getCell(O.rowID,Q);if(P){S.call(P,P,O.rowID,Q)}}}}},enableDebug:function(){w=true},disableDebug:function(){w=false},isDebug:function(){return w},processRows:function(O,M){var N=0;i(this.options.model,function(P){if(O){O.call(P,P,N)}N++})},styleRow:function(N,M){this.processCellsOfRow(N,function(O,Q,P){O.setCellStyle(M)});this.updateView(true)},_selectRowProcessCB:function(M,Q,P,O){this.selectCell(Q,P,O);M.addClass("wux-datagrid-row-highlighted");var N=M.getView();if(N){N.getContent().addClassName("wux-datagrid-row-highlighted")}},selectRows:function(M,R){if(!M||M.length===0){return}if(R===undefined){R=true}if((!this._selectedColumns.isEmpty()||!this._selectedRows.isEmpty())&&R){this.unselectAll({updateView:false})}var P=[];var O=[];var Q=this;var N=Q.options.model[0]?Q.options.model[0].length:0;M.forEach(function(U){if(U!==null&&U!==undefined&&U>=0&&O.indexOf(U)===-1){O.push(U);P.push(Q.getCell(U,-1));Q.selectCell(U,-1,true);if(Q.options.model[U]!==undefined){for(var T=0;T<N;T++){var S=Q.getCell(U,T);if(S){P.push(S);Q._selectRowProcessCB(S,U,T,true)}}}}});this._selectedCells.add(P);this._modelEvents.publish({context:this,event:"/MANAGER/SELECT/ROWS",data:O});this._selectedRows.add(O);this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},selectRow:function(O,N){if(O===null||O===undefined||O<0){return}if(N===undefined){N=true}if((!this._selectedColumns.isEmpty()||!this._selectedRows.isEmpty())&&N){this.unselectAll({updateView:false})}this.selectCell(O,-1);var M=this;this.processCellsOfRow({rowID:O,minColumnID:0},function(P,R,Q){M._selectRowProcessCB(P,R,Q)});this._modelEvents.publish({context:this,event:"/MANAGER/SELECT/ROW",data:O});this._selectedRows.add(O);this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},isRowSelected:function(M){return this._selectedRows.isIn(M)},_unselectRowProcessCB:function(M,O,N){if(M&&M.isSelected()){this.unselectCell(O,N)}},unselectRow:function(N){if(N===null||N===undefined||N<0){return}this.unhighlightRow(N);var M=this;this.processCellsOfRow({rowID:N,minColumnID:0},function(O,Q,P){M._unselectRowProcessCB(O,Q,P)});this.removeRowClass(N,"wux-datagrid-row-highlighted");this._modelEvents.publish({context:this,event:"/MANAGER/UNSELECT/ROW",data:N});this._selectedRows.remove(N);this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},getSelectedRows:function(){return this._selectedRows.get()},selectColumn:function(M,N){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}if(N===undefined){N=true}if(N){this.unselectAll({updateView:false})}this.highlightColumn(M,true);this._modelEvents.publish({context:this,event:"/MANAGER/SELECT/COLUMN",data:M});this._selectedColumns.add(M);this._setColumnState(M,"select");this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},unselectAllColumns:function(){if(this._selectedColumns.get().length>0){this.withUpdate(function(){while(this._selectedColumns.get().length>0){this.unselectColumn(this._selectedColumns.get()[0])}})}},unselectColumn:function(M){if(typeof M==="string"){M=this.getColumnIDFromDataIndex(M)}this.unhighlightColumn(M,true);this._modelEvents.publish({context:this,event:"/MANAGER/UNSELECT/COLUMN",data:M});this._selectedColumns.remove(M);this._setColumnState(M);this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},getSelectedColumns:function(){return this._selectedColumns.get()},_focusCell:function(P,N){var M=this.getCell(P,N);this._focusedCell=M;M.select();var O=M.getView();if(O){O.select()}},selectCell:function(Q,O,N){var M=this.getCell(Q,O);if(!M){return}var P=this._getCellView(Q,O);if(P){M._view=P;M._view._cellModel=M}if(!N){this._selectedCells.add(M)}M.select();var P=M.getView();if(P&&parseInt(P.elements.container.getAttribute("virtual-row-id"),10)===Q&&parseInt(P.elements.container.getAttribute("virtual-column-id"),10)===O){P.select()}if(!N){this._modelEvents.publish({event:"selectionChange",context:this,data:{}})}},unselectCell:function(P,N){var M=this.getCell(P,N);if(!M){return}this._selectedCells.remove(M);M.unselect();var O=M.getView();if(O){O.unselect()}this._selectedCells.remove(M);this._modelEvents.publish({event:"selectionChange",context:this,data:{}})},getSelectedCells:function(){return this._selectedCells.get()},selectAll:function(){var M=this;this.prepareUpdateView();this.processRows(function(O,N){M.selectRow(N,false)});this.pushUpdateView()},unselectAll:function(O){O=h.extend({rows:true,columns:true,cells:true,updateView:true},O);if(O&&O.updateView){this.prepareUpdateView()}var P=this;if(O.columns){var N=this.getSelectedColumns();while(N[0]!==undefined){P.unselectColumn(N[0])}}if(O.rows){var Q=this.getSelectedRows();for(var M=0;M<Q.length;M++){P.unselectRow(Q[M])}}this._selectedCells.empty();if(O&&O.updateView){this.pushUpdateView()}},highlightRow:function(N){var M=this.getCell(N,-1);if(M){if(M.getView()){M.getView().highlight()}}this.processCellsOfRow(N,function(O,Q,P){O.highlight();if(O.getView()){O.getView().highlight()}});this._highlightedRows.add(N)},unhighlightRow:function(N){var M=this.getCell(N,-1);if(M){if(M.getView()){M.getView().unhighlight()}}this.processCellsOfRow(N,function(O,Q,P){O.unhighlight();if(O.getView()){var R=O.getView().getCellInfos();if(R.virtualRowID===Q&&R.virtualColumnID===P){O.getView().unhighlight()}}});this._highlightedRows.remove(N)},isRowHighlighted:function(M){return this._highlightedRows.isIn(M)},highlightColumn:function(O,M){var N=this;if(typeof O==="string"){O=this.getColumnIDFromDataIndex(O)}N.processCellsOfColumn(O,function(P,S,Q){if(M){P.select()}else{P.highlight()}var R=P.getView();if(R){if(M){R.select()}else{R.highlight()}}})},unhighlightColumn:function(O,M){var N=this;if(typeof O==="string"){O=this.getColumnIDFromDataIndex(O)}N.processCellsOfColumn(O,function(P,S,Q){if(M){this._manager.getCell(S,-1).inactive();P.unselect()}else{P.unhighlight()}var R=P.getView();if(R){if(M){R.unselect()}else{R.unhighlight()}}})},hideRow:function(M){if(!this.isRowHidden(M)){this.prepareUpdateView();var N=this.getRowHeight(M);this._listOfRowsPreviousHeight[M]=N;this.setRowHeight(M,0);this.getCell(M,-1)._hide();this.processCellsOfRow(M,function(O,Q,P){O._hide()});this.getCell(M,-1)._hide();this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._requireFullUpdate();this.pushUpdateView()}},showRow:function(M){this.prepareUpdateView();var N=this._listOfRowsPreviousHeight[M]!==undefined?this._listOfRowsPreviousHeight[M]:this.options.defaultCellHeight;this.setRowHeight(M,N);this.getCell(M,-1)._show();this.processCellsOfRow(M,function(O,Q,P){O._show()});this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._requireFullUpdate();this.pushUpdateView()},isRowHidden:function(M){return this.getRowHeight(M)===0},hideColumn:function(N){if(!this.isColumnHidden(N)){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.options.columns[N].isHidden=true;this.prepareUpdateView();var M=this.getColumnWidth(N);this._listOfColumnsPreviousWidth[N]=M;this._listOfColumnsWidth[N]=0;this._setColumnsWidth();this.getCell(-1,N)._hide();this.processCellsOfColumn(N,function(O,Q,P){O._hide()});this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"hideColumn",data:{columnID:N}});this._modelEvents.publish({event:"columnVisibilityChanged",data:{columnID:N,isHidden:true}});this._requireFullUpdate();this.pushUpdateView(true)}},showColumn:function(N){if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.options.columns[N].isHidden=false;this.prepareUpdateView();var M=this._listOfColumnsPreviousWidth[N];this._listOfColumnsWidth[N]=M;this._setColumnsWidth();this.getCell(-1,N)._show();this.processCellsOfColumn(N,function(O,Q,P){O._show()});this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"showColumn",data:{columnID:N}});this._modelEvents.publish({event:"columnVisibilityChanged",data:{columnID:N,isHidden:false}});this._heavyDataColumnModelRequest("showColumn",{columnID:N});this._requireFullUpdate();this.pushUpdateView(true)},onShowColumn:function(M){return this._modelEvents.subscribe({event:"showColumn"},M)},onHideColumn:function(M){return this._modelEvents.subscribe({event:"hideColumn"},M)},onColumnVisibilityChange:function(M){return this._modelEvents.subscribe({event:"columnVisibilityChanged"},M)},unstyleRow:function(M){this.processCellsOfRow(M,function(N,P,O){N.setCellStyle({background:"",color:""})});this.updateView(true)},styleColumn:function(N,M){this.processCellsOfColumn(N,function(O,Q,P){O.setCellStyle(M)});this.updateView(true)},addColumnClass:function(Q,N,P){if(P===undefined){P=false}var O=function(R,U,T){R.addClass(N);var S=R.getView();if(S){S.getContent().addClassName(N)}};if(P){var M=this.getVisibleViewport();this.processCellsOfColumn({minRowID:M.minRowID,maxRowID:M.maxRowID,updateView:false},O)}else{this.prepareUpdateView();this.processCellsOfColumn(Q,O);this.pushUpdateView()}},removeColumnClass:function(Q,N,P){if(P===undefined){P=false}var O=function(R,U,T){R.addClass(N);var S=R.getView();if(S){S.getContent().removeClassName(N)}};if(P){var M=this.getVisibleViewport();this.processCellsOfColumn({minRowID:M.minRowID,maxRowID:M.maxRowID,updateView:false},O)}else{this.prepareUpdateView();this.processCellsOfColumn(Q,O);this.pushUpdateView()}},addRowClass:function(O,M,N){this.processCellsOfRow({rowID:O,minColumnID:N?-1:0},function(P,S,R){P.addClass(M);var Q=P.getView();if(Q){Q.getContent().addClassName(M)}})},removeRowClass:function(O,M,N){this.processCellsOfRow({rowID:O,minColumnID:N?-1:0},function(P,S,R){P.removeClass(M);var Q=P.getView();if(Q){Q.getContent().removeClassName(M)}})},unstyleColumn:function(M){this.processCellsOfColumn(M,function(N,P,O){N.setCellStyle({background:"",color:""})});this.updateView(true)},_processCells:function(T,S,N){var R=h.extend({minRowID:1,minColumnID:1,maxRowID:this.getNumberOfRows(),maxColumnID:this.getNumberOfColumns()},N);for(var P=R.minRowID;P<R.maxRowID;P++){for(var O=R.minColumnID;O<R.maxColumnID;O++){var Q=T[P];if(Q){var M=Q[O];if(M){S.call(M,M,P,O)}}}}},processCells:function(N,M){this._processCells(this.options.model,N,M)},getVisibleViewport:function(){return this._viewportBbox},_computeModelSize:function(R){var P=this;var M=P.options.model.length;var N=P.getLastVisibleColumnDataIndex();var Q=P.getColumnPosition(N)+P.getColumnWidth(N);var O=P.getRowPosition(M-1)+P.getRowHeight(M-1);P.setCellsContainerSize({width:Q,height:O},R!==undefined);P._modelSize={numberOfRows:M,numberOfColumns:this.options.columns.length};return P._modelSize},_computeVirtualViewport:function(){var U=this.getViewportDimensions();var V=this.getScrollerPosition();var Q=this.getModelSize();var R=Q.numberOfRows;var M=1;var W=this._getVirtualPositionFromScrollPosition();var S=this._getVirtualPositionFromScrollPosition({x:V.x+U.width,y:V.y+U.height});var T=W.rowID-M;var N=S.rowID+M;var P=this.options.performances.enableColumnVirtualization?(W.columnID-M):0;var O=this.options.performances.enableColumnVirtualization?(S.columnID+M):(this.options.columns.length-1);T=Math.max(0,T);N=Math.min(N,R-1);P=Math.max(0,P);O=Math.min(O,this.options.columns.length-1);this._viewportBbox={minRowID:T,maxRowID:N,minColumnID:P,maxColumnID:O};this._virtualPos={virtualRowID:this._viewportBbox.minRowID,virtualColumnID:this._viewportBbox.minColumnID};return this._viewportBbox},moveColumn:function(O,N,M){if(typeof O==="string"){O=this.getColumnIDFromDataIndex(O)}if(typeof N==="string"){N=this.getColumnIDFromDataIndex(N)}this.prepareUpdateView();this.unselectAll({updateView:false});t.array2dMove(this.options.columns,O,N);this.options.model=t.array2dTranspose(this.options.model);t.array2dMove(this.options.model,O,N);this.options.model=t.array2dTranspose(this.options.model);t.array2dMove(this._listOfColumnsWidth,O,N);t.array2dMove(this._columnsList,O,N);this._setColumnsWidth();this.pushUpdateView(true);this._modelEvents.publish({event:"/MANAGER/COLUMNS/MOVE",data:{fromColumnID:O,toColumnID:N}})},onMoveColumn:function(M){return this._modelEvents.subscribe({event:"/MANAGER/COLUMNS/MOVE"},M)},moveRow:function(O,M){console.log("move",O,M);this.prepareUpdateView();t.array2dMove(this.options.model,O,M);if(this._selectedRows.isIn(O)){this.unselectCell(O,-1);this.selectCell(M,-1)}this._modelEvents.publish({event:"/MANAGER/ROWS/MOVE",data:{fromRowID:O,toRowID:M}});var N=this._doINeedToGeneratePool();this.pushUpdateView(N)},onMoveRow:function(M){this._modelEvents.subscribe({event:"/MANAGER/ROWS/MOVE"},M)},getColumnIndexFromColumnID:function(M){console.warn("[deprecated] - please use getColumnIDFromDataIndex()");return this.getDataIndexFromColumnID(M)},getDataIndexFromColumnID:function(N){var M=this.options.columns;if(N>=0&&N<M.length){return M[N].dataIndex}},getColumnIDFromColumnIndex:function(M){console.warn("[deprecated] - please use getColumnIDFromDataIndex()");return this.getColumnIDFromDataIndex(M)},_needToComputeColumnReverseDataIndexes:function(){this._columnsReverseIndex=null},getColumnIDFromDataIndex:function(N){var Q;if(this._columnsReverseIndex&&this._columnsReverseIndex[N]!==undefined){Q=this._columnsReverseIndex[N]}else{var M=this.getNumberOfColumns();var P=this.options.columns;for(var O=0;O<M;O++){if(P[O].dataIndex===N){Q=O;break}}}return Q},addRow:function(M,S){this.prepareUpdateView();var W=this.getNumberOfRows();var T=this;var V=new o({isHeader:true,isStatic:true,rowID:W,columnID:-1,value:"",scroller:this._scroller,viewport:this._viewport,manager:this},this._leftStaticContainer);this._register({rowID:W,columnID:-1,cell:V});var O=this.getColumns();for(var P=0;P<O.length;P++){var N=O[P].dataIndex;var Q=this.getColumnIDFromDataIndex(N);var U=this.isColumnHidden(Q);V=new o({isHeader:false,isStatic:false,isHidden:U,isEditable:this.options?this.options.isEditable:this._isEditable,rowID:W,columnID:Q,value:M?M[N]:"",scroller:this._scroller,viewport:this._viewport,manager:this},this._cellsContainer);this._register({rowID:W,columnID:Q,cell:V})}if(S!==undefined&&S!==W){this.moveRow(W,S)}i(this.getSelectedRows(),function(X){if(X>=S){T.unselectRow(X);T.selectRow(X+1)}});var R=this._doINeedToGeneratePool();this.pushUpdateView(R);this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"/MANAGER/ROWS/ADD"});return W},addColumn:function(M){M=h.extend({column:{text:"First Name",dataIndex:"firstname"},data:[]},M);var O=this.options.columns.push(M.column)-1;this._instance._listOfColumns.push(M.column.dataIndex);var N=this;this.processRows(function(R,Q){var S=M.data;var P=new o({isHeader:false,isStatic:false,isHidden:false,isEditable:N.options?N.options.isEditable:N._isEditable,rowID:Q,columnID:O,value:S?S[Q]:"",scroller:N._scroller,viewport:N._viewport,manager:N},N._cellsContainer);N._register({rowID:Q,columnID:O,cell:P})});this._setupColumnType(M.column);this._setColumnsWidth();this._generatePool(true);this.updateView(true)},addRows:function(V){var R=this;var U=this.getNumberOfRows();for(var O=0;O<V.length;O+=1){var T=new o({isHeader:true,isStatic:true,rowID:U,columnID:-1,value:"",scroller:this._scroller,viewport:this._viewport,manager:this},this._leftStaticContainer);this._register({rowID:U,columnID:-1,cell:T});var N=this.getColumns();for(var P=0;P<N.length;P++){var M=N[P].dataIndex;var Q=this.getColumnIDFromDataIndex(M);var S=this.isColumnHidden(Q);T=new o({isHeader:false,isStatic:false,isHidden:S,isEditable:this.options?this.options.isEditable:this._isEditable,rowID:U,columnID:Q,value:V[O]?V[O][M]:"",scroller:this._scroller,viewport:this._viewport,manager:this},this._cellsContainer);this._register({rowID:U,columnID:Q,cell:T})}U+=1}if(this.getNumberOfRows()!==this.getPoolNumberOfRows()){this._generatePool()}this.updateView();i(this.getSelectedRows(),function(W){if(W>=U){R.unselectRow(W);R.selectRow(W+1)}})},onAddRow:function(M){this._modelEvents.subscribe({event:"/MANAGER/ROWS/ADD"},M)},_onDetachFromView:function(O,N,P){if(P===undefined){P=false}var M=this.getCell(O,N);if(M){if(M._view){M._view.elements.container.remove();M._view=null}}},onCellClick:function(M){return this._modelEvents.subscribe({event:g.click},M)},onCellDblClick:function(M){return this._modelEvents.subscribe({event:g.dblClick},M)},_dump:function(){var N=this;var M="\n";i(N.options.model,function(P,O){if(O===0){M=M+"   ";i(P,function(Q,R){M=M+"\t\t["+R+"]"});M=M+"\n"}M=M+"["+O+"]";i(P,function(Q){M=M+"\t\t"+Q.getCellContent()});M=M+"\n"});return M},_register:function(M){this.setCell(M.rowID,M.columnID,M.cell);this.updateModelSize({numberOfRows:this.getNumberOfRows(),numberOfColumns:this.getNumberOfColumns()})},withUpdate:function(M){this.prepareUpdateView();M.call(this);this.pushUpdateView()},prepareUpdateView:function(){if(this._isPreparingView===undefined){this._isPreparingView=0}this._isPreparingView++;if(w){console.log("prepare",this._isPreparingView)}this._parent()},pushUpdateView:function(M){if(this._isPreparingView>0){this._isPreparingView--}if(w){console.log("push",this._isPreparingView)}this._parent(M)},_doesRowNeedToBeRequested:function(M){return !this.isRowHidden(M)},_doesColumnNeedToBeRequested:function(M){return M<this.options.columns.length},empty:function(){this.prepareUpdateView();for(var M=this.getNumberOfRows()-1;M>=0;M--){this.removeRow(M)}t.clear(this.options.model);t.clear(this._cellsContentList);t.clear(this._rowsList);t.clear(this._rowIndexes);t.clear(this._listOfCellsInViewPort);t.clear(this._listOfRowsPosition);t.clear(this._listOfRowsHeight);t.clear(this._listOfRowsPreviousHeight);this._viewportBbox={};this._previousViewPort={rowMin:0,rowMax:0,columnMin:0,columnMax:0};this._minVisibleCellCoordinates={rowID:1,columnID:1};this._maxVisibleCellCoordinates={rowID:1,columnID:1};this._lastScrollPos={x:0,y:0};this._deltaScrollPos={x:0,y:0};this.pushUpdateView(true)},showLoadIndicator:function(M){this._instance.elements.loader.on(M)},hideLoadIndicator:function(){this._instance.elements.loader.off()},updateLoadIndicator:function(M){this._instance.elements.loader.update(M)},_update:function(M){},_requireFullUpdate:function(){this.__preventNextUpdateViewCounter=0;this._needFullUpdate=true},updateView:function(M){if(M===true){this._setColumnsWidth();this._updateViewOptions.generatePool=M}if(this._isPreparingView===0){if(w){if(this._updateViewOptions.generatePool){console.warn("------------- [update view & generate pool] --------------")}else{console.warn("------------- [update view] --------------")}}if(this._updateViewOptions&&this._updateViewOptions.detachAllViews){this._beginUpdate()}this._parent();if(this._debugPerformanceIssues){this._listOfColumnPerformances={}}if(this._updateViewOptions&&this._updateViewOptions.detachAllViews){this._endUpdate()}}},_getEditView:function(T,O){var R=this;var N;var M=T.getValue||function(U){return U.cellModel.getCellContent()};var S=T.setValue||function(V,U){V.cellModel.setCellContent(U)};var P=T.onChange||function(U){console.log("change",U.cellModel.getCellContent())};switch(T.type){case"picture":N=function(V){if(V.virtualRowID>-1){var U=V.manager._reuseCellContent("picture",V.cellView);if(U){U.style.backgroundImage=M.call(R,O.cellView.getCellInfos())}}};break;case"boolean":N=function(V){if(V.virtualRowID>-1){var U=new v({size:"mid",value:M.call(R,O.cellView.getCellInfos())});U.getContent().setStyles({verticalAlign:"middle"});U.onChange(function(W){var X=this.getValue();S.call(R,O.cellView.getCellInfos(),X);if(P){P.call(R,O.cellView.getCellInfos())}});return U}};break;case"color":N=function(V){if(V.virtualRowID>-1){var U=V.manager._reuseCellContent("color",V.cellView);if(U){U.style.backgroundColor=M.call(R,O.cellView.getCellInfos())}}};break;case"datetime":N=function(V){if(V.virtualRowID>-1){var U=M.call(R,O.cellView.getCellInfos()).toString().split(" ").splice(0,5).join(" ");return U}};break;case"smartinput-distance":case"smartinput-orientation":case"smartinput-angle":case"smartinput-vector":case"smartinput-number":var Q={"smartinput-distance":m,"smartinput-orientation":b,"smartinput-angle":c,"smartinput-vector":p,"smartinput-number":j};N=function(V){if(V.virtualRowID>-1){var U=new Q[T.type]({value:M.call(R,O.cellView.getCellInfos()),units:""});x.addEventOnElement(this,U,"change",function(){S.call(R,O.cellView.getCellInfos(),this.getValue())});return U}};break;default:case"string":N=function(V){if(V.virtualRowID>-1){var U=new h.Element("input",{type:"text",value:M.call(R,O.cellView.getCellInfos())});return U}};break}return N},_getViewForCell:function(N){var P=this;var S=this.getColumnOptions(N.virtualColumnID);var R=S?S.isEditable:{};function M(V,U){if(V.virtualRowID>-1){var T=new x.createElement("div");S.commands.forEach(function(X){if(!X.viewScope||X.viewScope===U){var W=new G({label:X.label,emphasize:X.isPrimary?"primary":undefined,icon:X.icon});W.getContent().setAttribute("internalCommand",X.command);x.addEventOnElement(this,W.getContent(),l.POINTERDOWN,function(Y){Y.stopPropagation();Y.preventDefault()});x.addEventOnElement(this,W.getContent(),l.POINTERUP,function(Y){Y.stopPropagation();Y.preventDefault();P._modelEvents.publish({event:"command:"+X.command,data:N.cellView.getCellInfos()})});T.appendChild(W.getContent())}});return T}}if(N.virtualColumnID>-1&&S.isEditable===undefined&&S.type!==undefined){switch(S.type){case"commands":R={switchToWriteView:{event:"",view:function(T){return M(T,"write")}},switchToReadView:{view:function(T){return M(T,"read")}}};break;case"boolean":R={switchToWriteView:{event:"",view:this._getEditView(S,N)},switchToReadView:{}};break;case"picture":R={switchToWriteView:{event:"",callback:function(){}},switchToReadView:{view:this._getEditView(S,N)}};break;case"color":R={switchToWriteView:{event:"",callback:function(){}},switchToReadView:{view:this._getEditView(S,N)}};break;case"datetime":R={switchToWriteView:{event:"",callback:function(){}},switchToReadView:{view:this._getEditView(S,N)}};break;case"smartinput-distance":case"smartinput-orientation":case"smartinput-angle":case"smartinput-vector":case"smartinput-number":R={switchToWriteView:{event:"",callback:function(){},view:this._getEditView(S,N)},switchToReadView:{event:"blur",callback:function(T){this.switchToReadView()}}};break;default:case"string":R={switchToWriteView:{event:"",callback:function(){},view:this._getEditView(S,N)},switchToReadView:{}};break}}var O=h.clone(this.options.isEditable);var Q=O;if(O!==false){Q=h.extend(O,R,true)}return Q},_setupColumnType:function(M){switch(M.type){case"selection":M.onCellChange=function(N){return N.event.target.parentNode.dsModel.checkFlag};M.onCellRequest=function(O){if(!O.isHeader){var N=new e({type:"checkbox",checkFlag:Boolean(O.manager.isRowSelected(O.virtualRowID))});x.addEventOnElement(this,N.getContent(),l.POINTERDOWN,function(P){P.stopPropagation()});x.addEventOnElement(this,N.getContent(),l.POINTERUP,function(P){P.stopPropagation()},true);x.addEventOnElement(this,N.getContent(),"change",function(P){if(P.dsModel.checkFlag){O.manager.selectRow(O.virtualRowID,false)}else{O.manager.unselectRow(O.virtualRowID,false)}O.manager._giveFocus()});O.cellView.getContent().setHTML(N)}};break;default:}},getDistinctValuesFromColumns:function(){var M={};var N={};var O=this;this.processRows(function(U,T){var R=O.getNumberOfColumns();for(var S=0;S<R;S++){var Q=O.getDataIndexFromColumnID(S);var P=O.getCellContent(T,S);if(M[Q]===undefined){M[Q]=[];N[Q]={}}if(N[Q][P]===undefined){N[Q][P]=true;M[Q].push(P)}}});return M},_giveFocus:function(M){this._instance.elements.container.addClassName("wux-ui-state-focused");if(M){this._instance.elements.container.focus()}},_lostFocus:function(){if(this._instance.options.changeColorOnFocus){this._instance.elements.container.removeClassName("wux-ui-state-focused")}if(this._listOfEditedCells&&this._listOfEditedCells.length>0){this._listOfEditedCells.forEach(function(M){M.cellView.switchToReadView()});t.clear(this._listOfEditedCells)}},_removeAllInteractiveUIFeedBacks:function(){},_recordInteractionFromUI:function(M){var N=this;y.addCustomInteraction(N._instance._parentObject.getContent(),{type:"webUX_event",reason:M.reason||"",event:M.event||"",data:M.data||{},eventOptions:{}},"DS/SpreadsheetRec/DataGridRec",{checkAbstract:false,checkVisibility:false})},enableDragOverStateForBlank:function(){this.disableDragOverStateForRow();if(this.getScroller()){this.getScroller().getContent().addClassName("wux-ui-state-drag-over")}},disableDragOverStateForBlank:function(){if(this.getScroller()){this.getScroller().getContent().removeClassName("wux-ui-state-drag-over")}},disableDragOverStateForRow:function(){this._instance._hideRowInsertionMark()},enableDragAutoScroll:function(){return this._enableDragAutoScroll()},_enableDragAutoScroll:function(){this.__enableDragAutoScroll=true;this._enableAutoScroll()},disableDragAutoScroll:function(){return this._disableDragAutoScroll()},_disableDragAutoScroll:function(){this.__enableDragAutoScroll=false;this._disableAutoScroll()},_scrollToPosition:function(R,S){var M=Boolean(window.chrome)&&Boolean(window.chrome.webstore);if(M&&!this.__enableDragAutoScroll){return}var O=a(R,this.getScroller().elements.container);var N=O.y;var U=this._scrollerDimensions.height;var P=50;var Q=0;var T=30;if(N<=P){Q=-(P-N)/P*T}else{if(U-P<=N){Q=(N-(U-P))/P*T}}this._setAutoScrollVelocity({x:0,y:Q})}});return h.namespace("WUX/Controls/SpreadsheetManager",I)});define("DS/Spreadsheet2/Manager",["DS/Spreadsheet/Manager"],function(a){return a});define("DS/Spreadsheet/DataGrid",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Loader","DS/Spreadsheet/Manager","DS/Spreadsheet/CellModel","DS/Core/ActionsStack","DS/Spreadsheet/CellView","DS/Utilities/Data","UWA/Utils/Client","UWA/Utils","DS/Utilities/Utils"],function(f,n,u,r,h,j,b,m,p,g,c){var d=false;var i=false;var s="wux-ui-state-drag-over";var q=p.Engine;var e=-1;function t(x,w){var v=x;if(v){var y=(" "+v.className+" ").replace(/[\n\t]/g," ").indexOf(" "+w+" ")>-1;if(y){return v}else{return t(v.parentNode,w)}}else{}}function a(w,v){var x=(" "+w.className+" ").replace(/[\n\t]/g," ").indexOf(" "+v+" ")>-1;return x}function l(y,C){var z=y.target;if(C!==undefined){z=t(z,C)}var v=z.currentStyle||window.getComputedStyle(z,null),D=parseInt(v.borderLeftWidth,10),B=parseInt(v.borderTopWidth,10),A=z.getBoundingClientRect(),x=y.clientX-D-A.left,w=y.clientY-B-A.top;return{offsetX:x,offsetY:w}}var o=n.extend({defaultOptions:{managerClass:r,data:null,headersDimensions:{width:undefined,height:25},defaultCellMouseWidth:null,defaultCellMouseHeight:null,defaultCellTouchWidth:null,defaultCellTouchHeight:null,defaultCellWidth:100,defaultCellHeight:50,showScrollbarsOnHover:false,show:{rowHeaders:true,columnHeaders:true},resize:{rows:false,columns:false},selection:{cells:true,rowHeaders:true,columnHeaders:false,unselectAllOnEmptyArea:true,canMultiSelect:true},enableDragAndDrop:true,showLoaderIndicator:false,showVerticalLines:false,alternateRowColor:false,useTransparentScroller:false,isEditable:false,rowsAreDraggable:true,allowUnsafeHTMLContent:undefined,shouldCellAllowUnsafeHTMLContentAt:function(v){return v.manager.options.allowUnsafeHTMLContent},onDragStartColumnHeaderDefault:function(w,x){var v="'"+x.dataIndex+"'";w.dataTransfer.setData("Text",v);w.dataTransfer.effectAllowed="move";x.manager.__draggedAreaVirtualColumnID=x.virtualColumnID;x.manager.__draggedArea="column";x.manager.__draggedColumnID=x.virtualColumnID;x.manager.lockUI()},onDragEnterColumnHeaderDefault:function(v,w){if(w.manager.__draggedArea==="column"){if(w.virtualColumnID>w.manager.__draggedAreaVirtualColumnID){this._showColumnInsertionMark(w.manager.getScroller().getPosition().x+w.manager.getHeadersDimensions().width+w.manager.getColumnPosition(w.dataIndex)+w.manager.getColumnWidth(w.dataIndex))}else{this._showColumnInsertionMark(w.manager.getScroller().getPosition().x+w.manager.getHeadersDimensions().width+w.manager.getColumnPosition(w.dataIndex))}}},onDragLeaveColumnHeaderDefault:function(w,v){this._hideColumnInsertionMark()},onDragEndColumnHeaderDefault:function(w,v){delete v.manager.__draggedAreaVirtualColumnID;delete v.manager.__draggedArea;this._hideColumnInsertionMark();v.manager.unlockUI()},onDropColumnHeaderDefault:function(x,w){if(w.manager.__draggedAreaVirtualColumnID!==undefined){var v=x.dataTransfer.getData("Text");if((v.length>=2)&&(v.charAt(0)==="'")&&(v.charAt(v.length-1)==="'")){v=v.slice(1,v.length-1)}this._hideRowInsertionMark();w.manager.moveColumn(v,w.dataIndex);w.manager._recordInteractionFromUI({event:"drop:move-column",data:{fromVirtualColumnID:v,toVirtualColumnID:w.dataIndex}});w.manager.unlockUI()}},onDragStartRowHeaderDefault:function(v,w){this.serializeDragAndDropEvent(v,{data:{"dswebux/x-spreadsheet.datagrid.rows+json":[w.manager.getRow(w.virtualRowID,1)]}});v.dataTransfer.effectAllowed="move";w.manager.__draggedVirtualRowID=w.virtualRowID},onDragOverRowHeaderDefault:function(v,w){if(w.dropPosition==="top"){this._showRowInsertionMark(w.manager.getScroller().getPosition().y+w.manager.getHeadersDimensions().height+w.manager.getRowPosition(w.virtualRowID))}else{this._showRowInsertionMark(w.manager.getScroller().getPosition().y+w.manager.getHeadersDimensions().height+w.manager.getRowPosition(w.virtualRowID)+w.manager.getRowHeight(w.virtualRowID))}},onDragLeaveRowHeaderDefault:function(v,w){this._hideRowInsertionMark()},onDropRowHeaderDefault:function(y,x){var w=this.unserializeDragAndDropEvent(y);if(w.source.uuid===this._uxid){if(x.manager.__draggedVirtualRowID<x.virtualRowID){if(x.dropPosition==="top"){x.manager.moveRow(x.manager.__draggedVirtualRowID,Math.max(0,x.virtualRowID-1))}else{x.manager.moveRow(x.manager.__draggedVirtualRowID,x.virtualRowID)}}else{if(x.dropPosition==="top"){x.manager.moveRow(x.manager.__draggedVirtualRowID,x.virtualRowID)}else{x.manager.moveRow(x.manager.__draggedVirtualRowID,x.virtualRowID+1)}}}else{var v=w.data["dswebux/x-spreadsheet.datagrid.rows+json"];if(v){if(x.dropPosition==="top"){v.forEach(function(A,z){console.log("+",Math.max(0,x.virtualRowID-1+z));x.manager.addRow(A,Math.max(0,x.virtualRowID+z))})}else{v.forEach(function(A,z){console.log("+",x.virtualRowID+z);x.manager.addRow(A,x.virtualRowID+1+z)})}}}},onDragEndRowHeaderDefault:function(v,w){delete w.manager.__draggedVirtualRowID},onDragStartCellDefault:function(v,w){},onDropCellDefault:function(w,v){},onDragEnterBlankDefault:function(v,w){this._hideColumnInsertionMark();this._hideRowInsertionMark();this.getManager().getScroller().getContent().addClassName("wux-ui-state-drag-over")},onDragLeaveBlankDefault:function(v,w){this._hideColumnInsertionMark();this._hideRowInsertionMark();this.getManager().getScroller().getContent().removeClassName("wux-ui-state-drag-over")},onDropBlankDefault:function(y,x){var w=this.unserializeDragAndDropEvent(y);if(w.source.uuid===this._uxid){x.manager.moveRow(x.manager.__draggedVirtualRowID,x.manager.getNumberOfRows()-1)}else{var v=w.data["dswebux/x-spreadsheet.datagrid.rows+json"];if(v){v.forEach(function(z){x.manager.addRow(z,x.virtualRowID)})}}},performances:{numberOfRowsFactor:2,numberOfColumnsFactor:1.2,fullUpdateFactor:2,enableColumnVirtualization:false,debounceCellInternalUpdateTimer:0},isSortable:true,showTaskManager:false,apiVersion:2},init:function(w,v){this._parent(w);this._uxid=g.getUUID();this._parentObject=v;this._listOfColumns=[];this.buildView();var x=this;this._buildGrid();if(this.options.enableDragAndDrop===true){this.elements.container.addEvent("dragstart",this._onDragStart.bind(this));this.elements.container.addEvent("drop",this._onDrop.bind(this));this.elements.container.addEvent("dragover",this._onDragOver.bind(this));this.elements.container.addEvent("drag",this._onDrag.bind(this));this.elements.container.addEvent("dragend",this._onDragEnd.bind(this));this.elements.container.addEvent("dragleave",this._onDragLeave.bind(this));this.elements.container.addEvent("dragenter",this._onDragEnter.bind(this))}this.elements.container.addEvent("mouseleave",function(){x._hideRowInsertionMark();x._hideColumnInsertionMark();x._cellsManager._removeAllInteractiveUIFeedBacks()});this._onBlurCB=function(z){var y=x._cellsManager;setTimeout(function(){if(y&&y._instance){var C=document.activeElement;if(C){var A=a(C,"wux-afr-actionbar")?C:t(C,"wux-afr-actionbar");var B=a(C,"wux-datagrid")?C:t(C,"wux-datagrid");if(B&&(B.getAttribute("wux-uuid")===y._instance._uxid)&&!A){y._giveFocus()}else{if(!B&&!A){y._lostFocus()}}}}},1)};f.Element.addEvent.call(document.body,"blur",this._onBlurCB,true);this.elements.container.addEvent("focus",function(y){x._cellsManager._giveFocus()});if(this.options.alternateRowColor){this.elements.container.setAttribute("alternate-row-color","true")}if(this.options.showVerticalLines){this.elements.container.setAttribute("show-vertical-lines","true")}else{this.elements.container.setAttribute("show-vertical-lines","false")}},destroy:function(){if(this._onBlurCB){f.Element.removeEvent.call(document.body,"blur",this._onBlurCB,true);this._onBlurCB=null}this._cellsManager.destroy();this._cellsManager=null;this._parent()},serializeDragAndDropEvent:function(w,v){v=f.extend({source:{uuid:this._uxid,amd:"DS/Spreadsheet/DataGrid"},data:{"dswebux/x-spreadsheet.datagrid.data+json":""}},v);w.dataTransfer.setData("Text",JSON.stringify(v));return JSON.stringify(v)},unserializeDragAndDropEvent:function(v){var w=v.dataTransfer.getData("Text");try{return JSON.parse(w)}catch(v){console.warn('the element being in dataTransfer type "text" is not parsable usable JSON.parse')}},_buildGrid:function(w){if(w){f.extend(this.options,w)}var x=this;x.elements.container.setAttribute("wux-uuid",this._uxid);if(x._cellsManager){x._cellsManager.destroy();x._cellsManager=null;delete x._cellsManager}x._cellsManager=new this.options.managerClass({allowUnsafeHTMLContent:this.options.allowUnsafeHTMLContent,shouldCellAllowUnsafeHTMLContentAt:this.options.shouldCellAllowUnsafeHTMLContentAt,allowTextCopy:this.options.allowTextCopy,touchMode:this.options.touchMode,onContextualMenuReady:this.options.onContextualMenuReady,selection:this.options.selection,isEditable:this.options.isEditable,iconsSize:this.options.iconsSize,columns:this.options.columns,parent:this,headersDimensions:this.options.headersDimensions,cellClass:this.options.cellClass,defaultCellMouseWidth:this.options.defaultCellMouseWidth,defaultCellMouseHeight:this.options.defaultCellMouseHeight,defaultCellTouchWidth:this.options.defaultCellTouchWidth,defaultCellTouchHeight:this.options.defaultCellTouchHeight,defaultCellWidth:this.options.defaultCellWidth,defaultCellHeight:this.options.defaultCellHeight,manageHeight:this.options.manageHeight,showRowsHeader:this.options.show.rowHeaders,showColumnsHeader:this.options.show.columnHeaders,isSortable:this.options.isSortable,infiniteScrolling:this.options.infiniteScrolling,height:this.options.height,maxHeight:this.options.maxHeight,resize:this.options.resize,useTransparentScroller:this.options.useTransparentScroller,showScrollbarsOnHover:this.options.showScrollbarsOnHover,performances:this.options.performances||{}},this);if(this.options.data&&this.options.columns){var v=this._loadInternalModel();if(d){console.log("- model loaded in datagrid",v)}x._cellsManager.loadModel(v,true);x._cellsManager._postInitialization();x.elements.container.empty();if(x.options.showLoaderIndicator){x.elements.loader.inject(x.elements.container);x.elements.loaderOverlay.inject(x.elements.container)}x._cellsManager.inject(this.elements.container);x._cellsManager.onReady(function(){x._parentObject.elements.container.setAttribute("wux-api-version",x.options.apiVersion)});x._manageCellRequests()}},_processDragAndDropCallback_v2:function(A){var D=this;if(A.type==="dragend"||A.type==="drop"||A.type==="dragcancel"){if(this.options.enableScrollOnDrag&&(q.ie||q.firefox)){D._cellsManager._disableDragAutoScroll();setTimeout(function(){D._cellsManager._removeAllInteractiveUIFeedBacks()},10)}D._cellsManager.disableDragOverStateForBlank();D._cellsManager.disableDragOverStateForRow()}if(A.type==="dragleave"){if(!(a(A.target,"wux-scroller")||a(A.target,"wux-datagrid-cell"))){if(!t(A.target,"wux-datagrid-cell")&&!t(A.target,"wux-scroller")){return}}}if(A.type==="drop"||A.type==="dragend"){if(D._currentDropCellView){D._currentDropCellView.removeAttribute("wux-ui-drop-position")}}var E={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var G=E[A.type];var F=this._getDragAndDropInfos(A);if(A.type==="dragstart"){var B=this._parentObject._shouldAcceptDrag(F);if(B){if(A.dataTransfer){var y=A.target.getBoundingClientRect();var x=A.clientX-y.left;var v=A.clientY-y.top;if(typeof(A.dataTransfer.setDragImage)==="function"){A.dataTransfer.setDragImage(A.target,x,v)}}}else{A.preventDefault()}}function w(N,I){var M=false;var H=z?z[N+I]:false;var K=F.parent.options[N+I];var J=H||K;if(J){M=J.call(F.parent,A,F);if(i&&N!=="onDragOver"){console.info("[dnd]",N+I,">",M,A.target)}}else{if(i){console.warn("[dnd]","cannot find",N+I,"callback")}}var L=D.options[N+I+"Default"];if(L){if(J===undefined||(K&&M)){if(i){if(K&&M){console.info("\t>[dnd]","dev want to continue to the default behavior for ",N+I," callback")}else{console.info("\t>[dnd]","use the default behavior for ",N+I," callback")}}L.call(F.parent,A,F)}}}if(F.cellView){var C=F.cellView.getVirtualCoordinates();var z=F.cellView.getGridEngine().getColumnOptions(C.virtualColumnID);if(F.isHeader){if(F.virtualColumnID===-1){w(G,"RowHeader")}if(F.virtualRowID===-1){w(G,"ColumnHeader")}}else{if(A.type==="dragover"){if(this.options.enableScrollOnDrag&&(q.ie||q.firefox)){if(!D._cellsManager.__enableDragAutoScroll){D._cellsManager._enableDragAutoScroll()}D._cellsManager._scrollToPosition(A)}if(q.firefox){D._cellsManager.__preventFFLockUIWhenScrollOnDragOver=true}if(D.__toStopDragScroll){window.clearTimeout(D.__toStopDragScroll)}D.__toStopDragScroll=window.setTimeout(function(){if(D._cellsManager){D._cellsManager._disableDragAutoScroll();D._cellsManager.__preventFFLockUIWhenScrollOnDragOver=false}},300)}w(G,"Cell")}}else{if(!D._cellsManager.__preventDragAndDropOnBlankDuringScrollFlag){w(G,"Blank")}}if(A.type==="drop"||A.type==="dragend"){F.manager.disableDragOverStateForRow();F.manager.disableDragOverStateForBlank()}},_computeDragPosition:function(A,B){A=A||window.event;var y=l(A,"wux-datagrid-cell");var C=y.offsetY;if(B&&B.cellView){var v="middle";var w=B.cellView.getDimensions();var x=w.height*1/4;var z=w.height*3/4;if(C<x){v="top"}else{if(C>=x&&C<z){v="middle"}else{v="bottom"}}if(this._currentDropCellView!==B.view){if(this._currentDropCellView){this._currentDropCellView.removeAttribute("wux-ui-drop-position")}this._currentDropCellView=B.view}if(B.cellView._currentDropPosition!==v){B.cellView._currentDropPosition=v;B.view.setAttribute("wux-ui-drop-position",v)}return v}},_getDragAndDropInfos:function(w){var v=t(w.target,"wux-datagrid-cell");if(v){var x=this.getManager()._getCellViewFromDom(v).getDragAndDropInfos().from;if((w.type==="dragover"||w.type==="dragenter"||w.type==="dragleave")&&x&&x.cellView){x.dropPosition=this._computeDragPosition(w,x)}if(x===undefined){x={manager:this.getManager(),parent:this.getManager()._instance}}return x}else{return{manager:this.getManager(),parent:this.getManager()._instance}}},_onDragStart:function(y){var z=this.getManager()._getCellInfosFromDom(y.target);var A=true;if(z.isHeader&&z.virtualRowID===-1){A=this.getManager().getColumnOptions(z.dataIndex).isDraggable;if(A!==false){A=true}}else{var w=true;if(z&&z.nodeModel){w=z.nodeModel.isSelected()}if(!w){A=false;var v=t(y.target,"wux-datagrid-cell");if(v){var x=this.getManager()._getCellViewFromDom(v);if(x){A=x._uiNodeUpForTouchOrDownForMouse(y,"up")}}}if(A){A=this.options.shouldAcceptDrag(z)}}if(!A){y.preventDefault();if(i){console.warn("dragstart prevented")}}else{this._processDragAndDropCallback_v2(y)}},_onDrag:function(w){this._processDragAndDropCallback_v2(w);var v=this._getDragAndDropInfos(w);if(this.options.onDrag){this.options.onDrag.call(this,w,v)}},_onDragEnd:function(v){var w=this.getManager()._getCellInfosFromDom(v.target);var x=this.options.shouldAcceptDrag(w);if(!x){v.preventDefault()}else{this._processDragAndDropCallback_v2(v)}},_onDrop:function(v){v.preventDefault();v.stopPropagation();this._hideColumnInsertionMark();this._hideRowInsertionMark();this._processDragAndDropCallback_v2(v)},_onDragOver:function(v){v.preventDefault();this._processDragAndDropCallback_v2(v)},_onDragLeave:function(v){this._processDragAndDropCallback_v2(v)},_onDragEnter:function(v){v.preventDefault();v.stopPropagation();this._processDragAndDropCallback_v2(v)},_showRowInsertionMark:function(v){var w=this;setTimeout(function(){if(w._insertRowMark===undefined){w._insertRowMark=new f.Element("div",{"class":"wux-datagrid-row-insertion-mark",styles:{position:"absolute",top:v,left:0,height:2,right:0,zIndex:400010}}).inject(w.elements.container)}else{w._insertRowMark.setStyles({display:"block",top:v})}},10)},_hideRowInsertionMark:function(){if(this._insertRowMark!==undefined){var v=this;v._insertRowMark.hide()}},_showColumnInsertionMark:function(v){var w=this;setTimeout(function(){if(w._insertMark===undefined){w._insertMark=new f.Element("div",{"class":"wux-datagrid-column-insertion-mark",styles:{position:"absolute",top:0,left:v,width:2,bottom:0,zIndex:400010}}).inject(w.elements.container)}else{w._insertMark.setStyles({display:"block",left:v});if(!w._insertMark.parentNode){w._insertMark.inject(w.elements.container)}}},1)},_hideColumnInsertionMark:function(){if(this._insertMark!==undefined){var v=this;v._insertMark.hide()}},_highlightDropArea:function(v){this._unhighlightDropArea();this._currentDropArea=v;this._currentDropArea.elements.container.addClassName(s)},_unhighlightDropArea:function(){if(this._currentDropArea){this._currentDropArea.elements.container.removeClassName(s).removeAttribute("wux-ui-drop-position")}},_getGlobalIsEditableOptions:function(){var v=this._cellsManager.options.isEditable;if(v===true){return true}if(v===false){return false}if(typeof v==="object"){return{switchToWriteView:v.switchToWriteView,switchToReadView:v.switchToReadView,rowsHeaders:v.rowsHeaders,columnsHeaders:v.columnsHeaders,cells:v.cells,columnsAreDraggable:v.columnsAreDraggable,rowsAreDraggable:v.rowsAreDraggable}}},_manageCellRequests:function(){var w=this;this._cellsManager._listOfColumnPerformances={};function v(F){var x;if(w._cellsManager._debugPerformanceIssues){if(w._cellsManager._listOfColumnPerformances[F.dataIndex]===undefined){w._cellsManager._listOfColumnPerformances[F.dataIndex]=[]}x=window.performance?performance.now():Date.now()}var C=F.virtualRowID;var A=F.virtualColumnID;var G=F.cellModel;if(G){var E=G.getCellContent();var B=w._getGlobalIsEditableOptions();var D=w._cellsManager.getColumnOptions(A);if(!D.onCellRequest){var z=D?D.isEditable:{};var y=f.extend(B,z,true);if(y.switchToReadView){F.cellView._virtualRowID=C;F.cellView._virtualColumnID=A}else{F.cellView._virtualRowID=C;F.cellView._virtualColumnID=A;if(c.getUnsafeHTMLContentValueToApply(F.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(F)===false)){F.cellView.getContent().textContent=E}else{F.cellView.getContent().innerHTML=E}}}}if(w._cellsManager._debugPerformanceIssues){var H=window.performance?performance.now():Date.now();w._cellsManager._listOfColumnPerformances[F.dataIndex].push(H-x)}}w._cellsManager.onCellRequest(v);w._cellsManager.onColumnHeaderRequest(w._columnHeaderRequest.bind(w))},_columnHeaderRequest:function(y){var w=this;var v=y.virtualColumnID;var x=w.options.columns[v];var A;if(x){A=w.options.columns[v].text;y.cellView.getContent().setContent(A);y.isHeader=true;var z=w._cellsManager.getColumnOptions(v);if(z.onCellRequest){w._cellsManager._isRequestingCell=true;z.onCellRequest.call(w._cellsManager,y);w._cellsManager._isRequestingCell=false}}},updateHeight:function(v){this.elements.container.setStyle("height",v==="auto"?"":v);if(v==="auto"){this.elements.container.setStyles({position:"absolute",top:0,left:0,bottom:0,width:"100%"})}else{this.elements.container.setStyle("position","relative")}this.getManager().updateHeight(v)},buildView:function(){var v=this;this.elements.container=new f.Element("div",{"class":"wux-datagrid",tabindex:0,styles:{position:"relative",height:this.options.height==="auto"?"":this.options.height}});if(this.options.height==="auto"){this.elements.container.setStyles({position:"absolute",top:0,left:0,bottom:0,width:"100%"})}if(v.options.showLoaderIndicator){this.elements.loader=new u({asyncUpdate:false});this.elements.loaderOverlay=new f.Element("div",{"class":"wux-datagrid-overlay"});this.elements.loaderOverlay.inject(this.elements.container);this.elements.loader.inject(this.elements.container);this.elements.loader.getContent().setStyles({position:"absolute",top:"50%",left:"50%",zIndex:10000000})}},_loadInternalModel:function(F){this._cellsManager.prepareUpdateView();var B=new j();var z=[];var G=this.options;var A=0;var E;var x=G.data.length;var y=G.columns.length;var C=this;var D=0;var w=0;this._cellsManager.empty();this.options.columns.forEach(function(I,H){C._listOfColumns.push(I.dataIndex);if(C.options.columns[H].minWidth===undefined){C.options.columns[H].minWidth=0}if(C.options.columns[H].width===undefined){C.options.columns[H].width=C.options.defaultCellWidth}C.getManager()._setupColumnType(I);C._cellsManager._columnsList[H]=new h({isHeader:true,rowID:-1,columnID:H,value:I.text,manager:this})});var v=(x)*(y);if(C.options.showLoaderIndicator){this.elements.loader.on(0,true);this.elements.loaderOverlay.addClassName("wux-ui-state-on")}m.forEach(G.data,function(N,K){A++;var L=parseInt(A*y/v*100,10).toString()+"%";if(C.options.showLoaderIndicator){setTimeout(function(){C.elements.loader.update(L)},0)}if(!z[K+D]){z[K+D]=[]}var M=C._readRowData(G.data,K);for(var J=0;J<M.length-1;J++){var H;var I=M[J];if(typeof I==="object"&&I.properties){H=f.extend({isHeader:false,isEditable:C.options.isEditable,rowID:K+D,columnID:J+w,value:I.value,manager:C._cellsManager},I);if(I.properties.rowSpan!==1||I.properties.colSpan!==1){B.pushAction({actionObj:C._cellsManager,actionFunc:C._cellsManager.setCellSpan,actionParamsList:[K+D,J+w,{rowSpan:I.properties.rowSpan,colSpan:I.properties.colSpan}]})}}else{H={isHeader:false,isEditable:C.options.isEditable,rowID:K+D,columnID:J+w,value:M[J],manager:C._cellsManager}}E=new h(H,C.elements.cellsContainer);z[K+D][J+w]=E}},100,function(){C._cellsManager.pushUpdateView();if(F){F.call(C)}if(C.options.showLoaderIndicator){C.elements.loader.off();C.elements.loaderOverlay.removeClassName("wux-ui-state-on")}C.__loadOverlayTimeOut=window.setTimeout(function(){if(C.elements&&C.elements.loaderOverlay){C.elements.loaderOverlay.remove();C.__loadOverlayTimeOut=null}},500)});this._cellsManager.onReady(function(){B.play();C.options.columns.forEach(function(I,H){if(I.isHidden){C._cellsManager.hideColumn(I.dataIndex)}})});return z},getManager:function(){return this._cellsManager},_readRowData:function(y,A){var z=[];var x=A;var w=this.options.columns.length;for(var v=0;v<w;v++){if(y[x][this._listOfColumns[v]]!==undefined){z.push(y[x][this._listOfColumns[v]])}else{z.push("")}}if(y[x]._rowProperties){z.push(y[x]._rowProperties)}else{z.push({rowIndex:null,isHidden:false})}return z}});var k=n.extend({defaultOptions:{data:[],useHeaders:true,useFormulaBar:false,useDynamicLoading:true,headersAreStatic:true,_autoDisplay:true,onDrop:null,onDragOver:null,onDragLeave:null,height:300,isEditable:false,headersDimensions:{width:50,height:25},defaultCellHeight:50,settings:null,alternateRowColor:false,cellClass:b,shouldAcceptDrag:function(v){return true}},init:function(w,v){this._parent(w);if(v===undefined){v=this}this.elements.container=new f.Element("div");this._datagrid=new o(this.options,v);this._setEditionMode(1);this.buildView()},updateHeight:function(v){this._datagrid.updateHeight(v)},_setEditionMode:function(v){this._editionMode=v},_getEditionMode:function(v){return this._editionMode},destroy:function(){this._datagrid.destroy();this._datagrid=null;if(this.__loadOverlayTimeOut){window.clearTimeout(this.__loadOverlayTimeOut)}this._parent()},_shouldAcceptDrag:function(w){var y=this.getManager().getColumnOptions(w.dataIndex);if(!w.isHeader){var v=y.isColumnDraggable;if(v===undefined){v=true}if(v){return this.options.shouldAcceptDrag(w)}else{return false}}else{if(w.virtualRowID===-1){var x=y.isColumnMovable;if(x===undefined){x=true}return x}else{return this._datagrid.options.rowsAreDraggable}}},getManager:function(){return this._datagrid._cellsManager},loadModel:function(v){this._datagrid._buildGrid(v);this._datagrid._manageCellRequests()},reloadModel:function(){var v=this._datagrid._loadInternalModel();this.loadModel(v)},buildView:function(){this.elements.formContainer=new f.Element("form",{styles:{height:"100%",margin:0,padding:0}}).inject(this.elements.container);var v=document.createAttribute("novalidate");this.elements.formContainer.setAttributeNode(v);this.elements.formSubmitButton=new f.Element("input",{type:"submit",styles:{display:"none"}}).inject(this.elements.formContainer);this._datagrid.inject(this.elements.formContainer)},giveFocus:function(){this._datagrid.elements.container.focus()},lostFocus:function(){this._datagrid.elements.container.blur()}});return f.namespace("WUX/Controls/Spreadsheet",k)});define("DS/Spreadsheet/RulesEditor",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Spreadsheet/DataGrid","DS/Core/ActionsStack","DS/Core/PointerEvents"],function(h,a,g,f,c,b,e){var d=g.extend({defaultOptions:{spreadsheet:null},init:function(i){this._parent(i);console.warn("Do not use","Spreadsheet/RulesEditor");this._rules={};this._actionStack=new b();this._buildView();this._fillView();this._buildBottomHeader()},_buildView:function(){this.elements.container=new h.Element("div",{styles:{position:"absolute",top:5,bottom:5,right:5,left:5,padding:20,backgroundColor:"rgba(255,255,255,1)",border:"1px solid white",zIndex:1000}}).inject(document.body);this.elements.topHeader=new h.Element("h1",{"class":"wux-datagrid-preference-topheader",html:"Rules"}).inject(this.elements.container);this.elements.body=new h.Element("div",{"class":"wux-datagrid-preference-body",styles:{overflow:"hidden"}}).inject(this.elements.container);this.elements.bottomHeader=new h.Element("div",{"class":"wux-datagrid-preference-bottomheader",styles:{textAlign:"right"}}).inject(this.elements.container)},show:function(){this._actionStack.clear();this.elements.container.show()},_buildBottomHeader:function(){var i=new h.Element("button",{"class":"wux-controls-button",html:"Apply"}).inject(this.elements.bottomHeader);var k=new h.Element("button",{"class":"wux-controls-button",html:"Cancel"}).inject(this.elements.bottomHeader);var j=this;i.addEventListener(e.POINTERUP,function(){j.applySetting();j.elements.container.hide()});k.addEventListener(e.POINTERUP,function(){j.elements.container.hide()})},applySetting:function(){var j=this.options.spreadsheet;var i=j.getManager();var k=this._rulesGrid.getManager();var l=[];k.getRows().forEach(function(n,m){var o={};n.forEach(function(p,q){o[k.getDataIndexFromColumnID(q)]=p.getCellContent()});if(o.active){l.push({match:function(p){if(p.dataIndex===o.column){switch(o.operator){case"is":if(p.cellModel.getCellContent()===o.value){return true}break;case"contains":if(p.cellModel.getCellContent().indexOf(o.value)!==-1){return true}break;case"greater":if(p.cellModel.getCellContent()>o.value){return true}break;case"lower":if(p.cellModel.getCellContent()<o.value){return true}break}}},onMatch:function(p){switch(o.ruleAction){case"hide":i.hideRow(p.virtualRowID);break;case"show":i.showRow(p.virtualRowID);break;case"remove":i.removeRow(p.virtualRowID);break;case"highlight":i.highlightRow(p.virtualRowID);break;case"unhighlight":i.unhighlightRow(p.virtualRowID);break}},stopProcessingRowAtMatch:true})}});i.applyRules(l)},_fillView:function(){var n=[];var o=this.options.spreadsheet;var m=o.getManager().options.columns;var i=function(s){var r=new h.Element("select");s.options.forEach(function(u){var t=new h.Element("option",{html:u.label,value:u.value}).inject(r)});s.cellModel.setCellContent(r.value);r.addEventListener("change",function(t){s.cellModel.setCellContent(this.value)});return r};var q=function(r){var s=[];m.forEach(function(t){s.push({label:t.text,value:t.dataIndex})});return new i({options:s,cellModel:r.cellModel})};var j=function(r){var s=[{label:"is",value:"is"},{label:"contains",value:"contains"},{label:"is greater than",value:"greater"},{label:"is lower than",value:"lower"}];return new i({options:s,cellModel:r.cellModel})};var k=function(r){var s=[{label:"highlight",value:"highlight"},{label:"unhighlight",value:"unhighlight"},{label:"show",value:"show"},{label:"hide",value:"hide"},{label:"remove",value:"remove"}];return new i({options:s,cellModel:r.cellModel})};m.forEach(function(t,s){var r={colVisibility:!o.getManager().isColumnHidden(s),colName:t.text,colColor:"#FFFFFF"};n.push(r)});var l=new c({columns:[{text:"Enable/Disable",dataIndex:"active",width:"10%"},{text:"Column value",dataIndex:"column",width:"20%"},{text:"Operator",dataIndex:"operator",width:"10%"},{text:"Value to match",dataIndex:"value",width:"20%"},{text:"Action",dataIndex:"ruleAction",width:"20%"},{text:"",dataIndex:"editRules",width:"20%"}],data:n,selection:{cells:false},headersDimensions:{width:40,height:20},isEditable:{switchToWriteView:{event:"",callback:function(r){},view:function(r){},},switchToReadView:{event:"blur",callback:function(r){this.switchToReadView()},view:function(v){switch(v.dataIndex){case"column":return new q({cellModel:v.cellModel});case"operator":return new j({cellModel:v.cellModel});case"ruleAction":return new k({cellModel:v.cellModel});case"value":return new h.Element("input",{type:"text",value:v.cellModel.getCellContent(),events:{change:function(w){v.cellModel.setCellContent(this.value)}}});case"active":var t=new h.Element("input",{type:"checkbox",events:{change:function(w){v.cellModel.setCellContent(this.checked)}}});if(v.cellModel.getCellContent()===true){t.setAttribute("checked","true")}return t;case"editRules":var s=new h.Element("div");var u=new h.Element("div",{html:"+",styles:{height:16,width:16,minWidth:16,textAlign:"center",padding:0,lineHeight:"16px",borderRadius:"50%",fontWeight:800,color:"grey",fontSize:"14px"},"class":"wux-controls-button wux-ui-state-no-selection",events:{click:function(w){v.manager.addRow(undefined,v.virtualRowID)}}}).inject(s);var r=new h.Element("div",{html:"-",styles:{height:16,width:16,minWidth:16,textAlign:"center",padding:0,lineHeight:"16px",borderRadius:"50%",fontWeight:800,color:"grey",fontSize:"14px"},"class":"wux-controls-button wux-ui-state-no-selection",events:{click:function(w){v.manager.removeRow(v.virtualRowID)}}}).inject(s);return s;default:return new h.Element("div",{html:v.cellModel.getCellContent()})}},},rowsHeaders:false,columnsHeaders:false,cells:true,columnsAreDraggable:false,rowsAreDraggable:true},height:"auto"}).inject(this.elements.body);this._rulesGrid=l;l.getManager().onRowHeaderRequest(function(u){var s=this._getCellsModel();var t=u.virtualRowID;u.cellView.getContent().setStyles({paddingLeft:5,paddingRight:5});if(s[t]){var v=s[t][0];var r;if(v){r=new h.Element("div",{"class":"wux-ui-hamburger",styles:{opacity:0.5,margin:5,fontSize:"1.5em"}})}if(u.cellView.getContent){u.cellView.getContent().setHTML(r)}}});l.elements.container.setStyles({width:800});var p=this;l.getManager().onMoveRow(function(r){p._actionStack.pushAction({actionObj:o.getManager(),actionFunc:o.getManager().moveColumn,actionParamsList:[r.fromRowID,r.toRowID]})})}});return d});define("DS/Spreadsheet/Preferences",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Spreadsheet/DataGrid","DS/Core/ActionsStack","DS/Core/PointerEvents"],function(h,a,g,f,c,b,d){var e=g.extend({defaultOptions:{spreadsheet:null},init:function(i){this._parent(i);this._thingsToApply={};this._actionStack=new b();this._buildView();this._fillView();this._buildBottomHeader()},_buildView:function(){this.elements.container=new h.Element("div",{styles:{position:"absolute",top:5,bottom:5,right:5,left:5,padding:20,backgroundColor:"rgba(255,255,255,1)",border:"1px solid white",zIndex:1000}}).inject(document.body);this.elements.topHeader=new h.Element("h1",{"class":"wux-datagrid-preference-topheader",html:"Grid preferences"}).inject(this.elements.container);this.elements.body=new h.Element("div",{"class":"wux-datagrid-preference-body"}).inject(this.elements.container);this.elements.bottomHeader=new h.Element("div",{"class":"wux-datagrid-preference-bottomheader",styles:{textAlign:"right"}}).inject(this.elements.container)},show:function(){this._actionStack.clear();this.elements.container.show()},_buildBottomHeader:function(){var i=new h.Element("button",{"class":"wux-controls-button",html:"Apply"}).inject(this.elements.bottomHeader);var k=new h.Element("button",{"class":"wux-controls-button",html:"Cancel"}).inject(this.elements.bottomHeader);var j=this;i.addEventListener(d.POINTERUP,function(){j.applySetting();j.elements.container.hide()});k.addEventListener(d.POINTERUP,function(){j.elements.container.hide()})},applySetting:function(){var l=this;var j=this.options.spreadsheet;for(var k in l._thingsToApply){var i=l._thingsToApply[k];if(i.bgColor!==undefined){l._actionStack.pushAction({actionObj:j.getManager(),actionFunc:j.getManager().styleColumn,actionParamsList:[parseInt(k,10),{backgroundColor:i.bgColor}]})}if(i.visibility!==undefined){var m;if(i.visibility){m=j.getManager().showColumn}else{m=j.getManager().hideColumn}l._actionStack.pushAction({actionObj:j.getManager(),actionFunc:m,actionParamsList:[parseInt(k,10)]})}}l._actionStack.play()},_fillView:function(){var i=[];var l=this.options.spreadsheet;var k=l.getManager().options.columns;k.forEach(function(p,o){var n={colVisibility:!l.getManager().isColumnHidden(o),colName:p.text,colColor:"#FFFFFF"};i.push(n)});var j=new c({columns:[{text:"Column",dataIndex:"colName"},{text:"Hide/Show",dataIndex:"colVisibility"},{text:"Color",dataIndex:"colColor"}],data:i,selection:{cells:false},headersDimensions:{width:40,height:20},isEditable:{switchToWriteView:{event:"dblclick",callback:function(n){this.switchToWriteView()},view:function(n){return new h.Element("input",{type:"text",value:n.getCellContent(),})},},switchToReadView:{event:"blur",callback:function(n){this.switchToReadView()},view:function(o){switch(o.cellModel.getColumnID()){case 2:var p=l.getManager().getColumnOptions(o.cellModel.getRowID());return new h.Element("input",{type:"color",value:p._bgcolor||"#FFFFFF",events:{change:function(s){console.log(this.value);var r=this.value;var q=o.cellModel.getRowID();p._bgcolor=r;if(!m._thingsToApply[q]){m._thingsToApply[q]={}}m._thingsToApply[q].bgColor=r}}});case 1:var n=new h.Element("input",{type:"checkbox",events:{change:function(r){var q=o.cellModel.getView().getVirtualCoordinates().virtualRowID;if(!m._thingsToApply[q]){m._thingsToApply[q]={}}m._thingsToApply[q].visibility=this.checked}}});if(o.cellModel.getCellContent()===true){n.setAttribute("checked","true")}return n;default:return new h.Element("div",{html:o.cellModel.getCellContent()})}},},rowsHeaders:false,columnsHeaders:false,cells:true,columnsAreDraggable:false,rowsAreDraggable:true}}).inject(this.elements.body);j.getManager().onRowHeaderRequest(function(o){o.cellView.getContent().setStyles({paddingLeft:5,paddingRight:5});var n;n=new h.Element("div",{"class":"wux-ui-fa wux-ui-fa-bars"});if(o.cellView.getContent){o.cellView.getContent().setHTML(n)}});j.elements.container.setStyles({width:440});var m=this;j.getManager().onMoveRow(function(n){m._actionStack.pushAction({actionObj:l.getManager(),actionFunc:l.getManager().moveColumn,actionParamsList:[n.fromRowID,n.toRowID]})})}});return e});define("DS/Spreadsheet2/DataGrid",["DS/Spreadsheet/DataGrid"],function(a){return a});define("DS/Tree/Manager",["UWA/Core","UWA/Class","DS/Spreadsheet/Manager","DS/Tree/TreeNodeModel","DS/Utilities/Array","DS/Tree/TreeDocument","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/RAFDispatcher","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Utilities/Dom","DS/Selection/XSO","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Tree/commands/TreeListViewCommands","DS/WebRecordEnabler/Adapter","UWA/Utils/Client"],function(g,q,j,l,n,k,i,e,u,h,c,r,f,m,o,p,d,s){var b=false;var t=false;function v(z){if(!z.hasOwnProperty("offsetX")){var y=z.target||z.srcElement,x=y.getBoundingClientRect(),w=z.clientX-x.left,A=z.clientY-x.top;return{offsetX:w,offsetY:A}}else{return{offsetX:z.offsetX,offsetY:z.offsetY}}}var a=j.extend({defaultOptions:{getValue:function(w){return w.nodeModel.options.grid[w.dataIndex]},onCellChange:function(w){if(w.event.dsModel){return w.event.dsModel.value}else{return w.event.target.value}},setValue:function(x){if(x.dataIndex==="tree"){x.nodeModel.updateOptions({label:x.value})}else{var w={};w[x.dataIndex]=x.value;x.nodeModel.updateOptions({grid:w})}}},init:function(z,x){var A=this;A._parent(z,x);this._typeRepFactory=new h();A._enableDebouncedSyncModel=false;A._isInEdition=false;A._listOfEditedCells=[];A._listOfDragOveredCellView=[];A._lastClickTime=0;A._lastClickRow=-1;A._activeElement=undefined;var y=function(E,D){return E._getID()===D._getID()};var C=function(D){return D._getID()};this._listOfModifiedNodes=new f({id:"listOfModifiedNodes",publishOnlyPrePostEvents:true,getElementID:this.options.performances.renderingMode==="adaptive"?C:undefined,useUniqueID:true,areEquals:y});this._xsoNodes=new f({getElementID:C,useUniqueID:true,areEquals:y});this._pxsoNodes=new f({getElementID:C,useUniqueID:true,areEquals:y});A._numberOfVisibleNodesInDocument=0;A._syncCounter=0;A._isExpandingCounter=0;A._needFullUpdate=false;A._createDocument(x.options.treeDocument);A.registerReusableCellContent({id:"_selection",buildContent:function(){var D=new e({checkFlag:false});D.getContent().addEventListener(i.POINTERDOWN,function(E){E.stopPropagation()});D.getContent().addEventListener("focus",function(E){E.preventDefault();E.stopPropagation()});return D}});A.onCellContentChange(function(E){var D=A.getTreeNodeModelFromRowID(E.virtualRowID);if(E.dataIndex!=="tree"&&A.getColumnOptions(E.virtualColumnID)&&A.getColumnOptions(E.virtualColumnID).type!=="selection"){D.options.grid[E.dataIndex]=E.value}});this._modelEvents.subscribe({event:"active"},function B(){A._activeNode=this;A._setActiveStateForNode(this)});this._modelEvents.subscribe({event:"inactive"},function w(){A._activeNode=null;A._unsetActiveStateForNode(this)});this._managePreSelection();this._manageKeyboard()},destroy:function(){this._tree=null;this._activeNodeAtShift=null;this._activeNode=null;this._resetListOfUpdatedNodes();this._listOfModifiedNodes=null;this._keymapManager.destroy();this._keymapManager=null;this._typeRepFactory.destroy();this._typeRepFactory=null;this._updateViewOptions=null;if(this.getDocument()){this._cleanBindingOnDocument()}this._treeDocument=null;this._xsoNodes=null;this._pxsoNodes=null;this._selectedColumns=null;this._selectedRows=null;this._highlightedRows=null;this._parent()},getNodesXSO:function(){if(!this.options.selection.viewBased){return this.getDocument().getXSO()}else{return this._xsoNodes}},getNodesPXSO:function(){if(!this.options.selection.viewBased){return this.getDocument().getPXSO()}else{return this._pxsoNodes}},_observeSelMultiSel:function(){var w=this;if(!this._multiSelModeHasBeenForced){this._modeIsMultiSel=false;this._modeIsListSel=false}r.addEventOnElement(this,document,"keydown",function(y){var x=g.Event.whichKey(y);switch(x){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":w._modeIsListSel=true;if(w._allowSettingMultiSelMode&&!w._multiSelModeHasBeenForced){w._modeIsMultiSel=true}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w.getActiveNode()?w.getActiveNode().getStructurePath():undefined,modeIsListSel:true,modeIsMultiSel:true}});break;case"ctrl":if(w._allowSettingMultiSelMode&&!w._multiSelModeHasBeenForced){w._modeIsMultiSel=true}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w._activeNodeAtShift,modeIsListSel:w._modeIsListSel,modeIsMultiSel:true}});break;default:}});r.addEventOnElement(this,document,"keyup",function(y){var x=g.Event.whichKey(y);switch(x){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":if(!w._multiSelModeHasBeenForced){w._modeIsListSel=false;w._modeIsMultiSel=false}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:null,modeIsListSel:false,modeIsMultiSel:false}});break;case"ctrl":if(!w._multiSelModeHasBeenForced){w._modeIsMultiSel=false}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w._activeNodeAtShift,modeIsListSel:w._modeIsListSel,modeIsMultiSel:true}});break;default:}if(x==="enter"&&w._isInEdition){w._isInEdition=false}})},_managePreSelection:function(){var y=this;if(this.options.selection.preSelection){this.elements.poolContainerRel.addEvent("mouseleave",function(){y.getNodesPXSO().empty()});var z;var A=0;var x=false;var w=function(D,E){var C=y.getDocument();if(E){var B=E.nodeModel;if(E&&E.virtualRowID>-1){if(z){A=B._getRowID()-z.nodeModel._getRowID();if(A!==0||x===true){if(!y.getNodesXSO().isIn(E.nodeModel)){C.prepareUpdate();y.getNodesPXSO().unique(E.nodeModel);y.removeRowClass(z.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",true);y.addRowClass(B._getRowID(),"wux-datagrid-cell-prehighlighted",true);y._preventNextUpdateView();C.pushUpdate();x=false}else{C.prepareUpdate();y.getNodesPXSO().empty();y.removeRowClass(z.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",true);y._preventNextUpdateView();C.pushUpdate();x=false}}}z=E}}};r.addEventOnElement(this,this,"mousemove",w);r.addEventOnElement(this,this,"mouseenter",function(){x=true})}},_goToNode:function(z,D,B){var x=this;var y;var E;if(z){if(D===1){y=z.getNextVisibleNode()}if(D===0){y=z}if(D===-1){y=z.getPreviousVisibleNode()}}if(y){if(!x._modeIsListSel){x._activeNodeAtShift=y}var C=y._getRowID();if(C>-1){var w=x.getNodesXSO();var A=x._shouldBeSelected(y);x.prepareUpdateView();if(!x.isInMultiSelection()){if(!B||A){w.empty()}if(A){w.add(y)}}if(x._modeIsListSel){if(w.get().length===0){E=null}else{if(y._getRowID()>x._activeNodeAtShift._getRowID()){E="after"}if(y._getRowID()===x._activeNodeAtShift._getRowID()){E=null}if(y._getRowID()<x._activeNodeAtShift._getRowID()){E="before"}}if(E==="after"){if(D===1){if(A){w.add(y)}}else{w.remove(z)}}if(E==="before"){if(D===-1){if(A){w.add(y)}}else{w.remove(z)}}if(E===null){w.remove(z)}}x._setActiveAndScrollToNode(y);x._keymapManager.listen();x.pushUpdateView()}}else{x._keymapManager.listen()}},_setActiveAndScrollToNode:function(z){var y=this;var E=z._getRowID();y.setActiveNode(z);var B=y.getScroller();var D=y.getViewportDimensions();var G=y.getScrollerPosition();var A=y.getRowPosition(E);var w=y.getRowHeight(E);var F=G.y;var C=F+D.height-w;var x=y.getCellsContainerSize().width>D.width?20:0;if(A>C){B.getContent().scrollTop=A-D.height+w+x+4}if(A<=F){B.getContent().scrollTop=A}},_manageKeyboard:function(){var z=this;var x=this._getParent();this._commandRegistry=new o();this._keymapManager=new m({jsModel:z,target:x.getContent(),commandsRegistry:this._commandRegistry,shouldProcessEvent:function(E){var D=E.event;var C=g.Event.whichKey(D);var B=D.target.tagName.toLowerCase();if(B==="input"||B==="textarea"){if(C==="tab"){return true}else{return false}}else{return true}}});this._keymapManager.spy(function(B){z._recordInteractionFromUI({event:"keymapmanager:dispatch-command",data:B})});if(x.options.enableActiveUI&&x.options.enableKeyboardNavigation){var w=x.options.keymaps;for(var y in w){this._keymapManager.registerKeymap(y,w[y])}for(var A in p){this._commandRegistry.registerCommand(A,p[A])}}},getCommandRegistry:function(){return this._commandRegistry},getTypeRepresentationFactory:function(){return this._typeRepFactory},getKeymapManager:function(){return this._keymapManager},_resetListOfUpdatedNodes:function(){this._listOfModifiedNodes.empty()},_listenToClickOnEmptyArea:function(){var y=this;var w=18;var x=false;this.elements.container.addEvent(i.POINTERDOWN,function(D){x=false;var C=v(D);if(D.target.className.indexOf("wux-scroller")!==-1){var B=g.extendElement(D.target).getDimensions();var A=B.width;var z=B.height;if(C.offsetX<(A-w)&&C.offsetY<(z-w)){x=true}}});this.elements.container.addEvent(i.POINTERUP,function(E){if(x){if(i.isTouchEvent(E)){if(y._preventSelectionForTouchScroll){return}}var D=v(E);if(E.target.className.indexOf("wux-scroller")!==-1){var C=g.extendElement(E.target).getDimensions();var B=C.width;var z=C.height;if(D.offsetX<(B-w)&&D.offsetY<(z-w)){var A=y.getNodesXSO();A.empty()}}}x=false})},_setRowLastClick:function(x,w){this._lastClickTime=w;this._lastClickRow=x},_getRowLastClick:function(w){return(this._lastClickRow===w)?this._lastClickTime:0},isEveryVisibleNodeSelected:function(){if(this.getNodesXSO().isEmpty()){return false}var x=0;var w=this.getNodesXSO().get();w.forEach(function(y){if(y._getRowID()!==null){x++}});return this._numberOfVisibleNodesInDocument===x},getDocument:function(){return this._treeDocument},_doesCellNeedToDisplayed:function(x){var w=x.cellModel;if(w.isMerged()){return false}else{return true}},addRow:function(x,w){if(typeof w==="number"||w===undefined){return this._parent(x,w)}else{if(w instanceof l){console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the addRow() method but use the TreeDocument or TreeNodeModel API instead");if(x instanceof Array){return w.addChild(x)}else{if(x instanceof l){return w.addChild(x)}else{return w.addChild([x])}}}}return -1},removeRow:function(w){if(w instanceof l){console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the removeRow() method but use the TreeDocument or TreeNodeModel API instead");w.remove()}else{if(typeof w==="number"||w===undefined){this._parent(w)}}},moveColumn:function(y,x,w){if(typeof y==="string"){y=this.getColumnIDFromDataIndex(y)}if(typeof x==="string"){x=this.getColumnIDFromDataIndex(x)}this.prepareUpdateView();n.array2dMove(this.options.columns,y,x);this.options.model=n.array2dTranspose(this.options.model);n.array2dMove(this.options.model,y,x);this.options.model=n.array2dTranspose(this.options.model);n.array2dMove(this._listOfColumnsWidth,y,x);n.array2dMove(this._columnsList,y,x);this._needToComputeColumnReverseDataIndexes();this._freeUpPool(2);this._reflectView();this.pushUpdateView(true);this._modelEvents.publish({event:"/MANAGER/COLUMNS/MOVE",data:{fromColumnID:y,toColumnID:x}})},removeColumn:function(w){if(typeof w==="string"){w=this.getColumnIDFromDataIndex(w)}this.prepareUpdateView();this.options.columns.splice(w,1);this._needToComputeColumnReverseDataIndexes();this._freeUpPool(2);this._reflectView();this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"/MANAGER/COLUMNS/REMOVE",data:{columnID:w}});this.pushUpdateView()},_getTrueRoot:function(){return this._treeDocument._getTrueRoot()},getNthRoot:function(w){if(this._getTrueRoot().getChildren()){return this._getTrueRoot().getChildren()[w]}return null},getRoots:function(){return this._getTrueRoot().getChildren()||[]},_prepareSync:function(){this._syncCounter++},_pushSync:function(){this._syncCounter--;this._syncRowIndexes(true)},_applyCellsContainerSizeIfNeeded:function(){if(this._needToApplyCellContainerSizer===true){this._computeModelSize()}this._parent()},_nodeModelToRowModel:function(y){var w=this;var z={};var x=y._getNodeInfos();w.getColumns().forEach(function(B){var A=w._getColumnOptionValue(B.dataIndex,"getValue");x.dataIndex=B.dataIndex;if(A){z[B.dataIndex]=A.call(w,x)}});return z},_syncRowIndexes:function(){this.syncModel()},addRoot:function(x){var w=this.getDocument()._getTrueRoot().addChild(x);this._syncRowIndexes();w._tree=this._tree;return w},removeRoot:function(x){this.prepareUpdateView();var w=this.getDocument()._getTrueRoot().removeChild(x);this.pushUpdateView();return w},_bindJSEventOnDocument:function(x,y,z){var w=this.addEventListener(y,z);this._jsEventListeners.push({caller:x,eventType:y,callback:w})},_bindEventOnXSO:function(w,x){this._XSOEventListeners.push(this.getNodesXSO()[w](x))},_bindEventOnDocument:function(w,x){this._listeners.push(this.getDocument().subscribe({event:w},x))},_cleanBindingOnDocument:function(){var x=this;this._listeners.forEach(function(y){x.getDocument().unsubscribe(y)});this._jsEventListeners.forEach(function(y){y.caller.removeEventListener(y.eventType,y.callback)});var w=this.getNodesXSO();if(w){this._XSOEventListeners.forEach(function(y){w.unsubscribe(y)})}this._listeners=[];this._jsEventListeners=[];this._XSOEventListeners=[]},search:function(w){return this.getDocument().search(w)},_createDocument:function(O){var H=this;if(O){this._treeDocument=O}else{this._treeDocument=new k({useAsyncPreExpand:this._instance.options.useAsyncPreExpand})}this._treeDocument._observeEvents();this._XSOEventListeners=[];this._jsEventListeners=[];this._listeners=[];this._resetListOfUpdatedNodes();var L=0;this._bindEventOnDocument("preDestroyDocument",function(){H.unloadDocument()});this._bindEventOnDocument("nodeModelUpdate",function E(T){H._unpreventNextUpdateView();H._syncRowModelWithTreeNodeModel(T.target);if(!H._needFullUpdate){H._listOfModifiedNodes.add(T.target);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}});this._bindEventOnDocument("prepareUpdate",function A(){H.prepareUpdateView();L++});this._bindEventOnDocument("pushUpdate",function S(){H.pushUpdateView();L--;if(L<0){console.error("You pushed too many updates")}});this._bindEventOnDocument("hide",function(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("show",function(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("filter",function(){H._reflectView()});this._bindEventOnDocument("removeChild",function y(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("addChild",function J(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("empty",function G(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("expandStateChange",function(T){H.updateCellView(T.target._getRowID(),"tree");if(T.data.state==="partiallyExpanded"){H._reflectView()}});this._bindEventOnDocument("sortChildren",function(){H._reflectView()});["expandStateChange","matchSearch","unmatchSearch"].forEach(function(T){H._bindEventOnDocument(T,function(U){if(!H._needFullUpdate){H._listOfModifiedNodes.add(U.target)}})});["matchSearch","unmatchSearch"].forEach(function(T){H._bindEventOnDocument(T,function(){H._requireFullUpdate()})});this._bindEventOnDocument("documentPreExpandAll",function(){H.prepareUpdateView()});this._bindEventOnDocument("documentPostExpandAll",c.debounce(function(){H._reflectView();H.pushUpdateView()},10));this._bindEventOnDocument("documentPreCollapseAll",function(){H.prepareUpdateView()});this._bindEventOnDocument("documentPostCollapseAll",function(){H._reflectView();H.pushUpdateView()});function x(){if(s.Engine.ie){if(H._activeElement===H._instance.elements.container){return true}if(H._activeElement){var T=H._activeElement.parentNode;while(T){if(H._activeElement.parentNode===H._instance.elements.container){return true}T=T.parentNode}}return false}else{return false}}this._bindEventOnDocument("preExpandAll",function(T){T.target.setState({state:"expanding"});H.updateCellView(T.data.virtualRowID,"tree");H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postExpandAll",function(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preCollapseAll",function P(T){H.updateCellView(T.data.virtualRowID,"tree");H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postCollapseAll",function K(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preExpandPrivate",function N(){H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postExpand",function M(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preCollapse",function F(){H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postCollapse",function C(){H._updateViewOptions.generatePool=true;H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("highlight",function D(T){var U=T.data.nodeModel;var V=U._getRowID();H.selectRow(V,false)});this._bindEventOnDocument("unhighlight",function I(T){var U=T.data.nodeModel;var V=U._getRowID();H.unselectRow(V)});var R=function(){if(H._toCellWillBeEdited){clearTimeout(H._toCellWillBeEdited);H._toCellWillBeEdited=null}};this.addEventListener("dblclick",function(T,U){R()});var z=this.getNodesXSO();this._bindEventOnXSO("onChange",function(){R()});if(this._getParent().options.enableActiveUI===false&&!this.__isComboBox__){delete z.options.getElementID}this._bindEventOnXSO("onPreEmpty",function(){H.prepareUpdateView()});this._bindEventOnXSO("onEmpty",function(){var T=H.getColumnIDFromDataIndex("selection");H.updateCellView(-1,T);H.pushUpdateView()});function B(){if(H._isPreparingView===1){var V=H.getColumnIDFromDataIndex("selection");var U=H.getCell(-1,V);if(U){var T=U.getView();if(T){H._onRequestColumnHeaderCB.call(H,T.getCellInfos())}}}}this._bindEventOnXSO("onPostAdd",B);this._bindEventOnXSO("onPostRemove",B);if(true||H.options.performances.renderingMode==="standard"){if(this._getParent().options.enableActiveUI===false&&!this.__isComboBox__){this._bindEventOnXSO("onAdd",function(T){var U=T._getRowID(false);H.prepareUpdateView();H.unselectAllColumns();if(U!==null&&U>=0){H.selectRow(U,false)}H.setActiveNode(T);if(!H._needFullUpdate&&H._isPreparingView<=2){H._preventNextUpdateView()}H.pushUpdateView()});this._bindEventOnXSO("onRemove",function(T){var U=T._getRowID();H.prepareUpdateView();H._setRowLastClick(U,0);T.unselect();H.unselectRow(U,false);H.setActiveNode(T);if(!H._needFullUpdate&&H._isPreparingView<=2){H._preventNextUpdateView()}H.pushUpdateView()})}else{this._bindEventOnXSO("onAdd",function(T){if(H.options.selection.viewBased===false){T.select()}});this._bindEventOnXSO("onPostAdd",function(U){if(U.length===0){return}H.prepareUpdateView();var T=[];U.forEach(function W(X){T.push(X._getRowID(false));if(!H._needFullUpdate&&X.isSelectionChangeFromUI()){H._preventNextUpdateView()}});H.selectRows(T,false);if(H.options.selection.preselection){H.getNodesPXSO().remove(U)}var V=U[U.length-1];H._setRowLastClick(V._getRowID(false),Date.now());H.setActiveNode(V);if(!H._needFullUpdate){H._listOfModifiedNodes.add(U);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}H.pushUpdateView()});this._bindEventOnXSO("onPostRemove",function(T){if(T.length===0){return}H.prepareUpdateView();T.forEach(function(V){var W=V._getRowID();if(V.isSelectionChangeFromUI()){H._preventNextUpdateView()}if(W!==null&&W>=0){H.unselectRow(W,false)}if(H.options.selection.viewBased===false){V.unselect()}});var U=T[T.length-1];H._setRowLastClick(-1,0);H.setActiveNode(U);if(!H._needFullUpdate){H._listOfModifiedNodes.add(T);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}H.pushUpdateView()})}}else{var w=function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.prepareUpdateView();if(!H._needFullUpdate){H._listOfModifiedNodes.add(T);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get(),T.options.label)}}H.pushUpdateView()};this._bindEventOnXSO("onAdd",w);this._bindEventOnXSO("onRemove",w)}var Q=this.getNodesPXSO();Q.onAdd(function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.addRowClass(U,"wux-datagrid-cell-prehighlighted")});Q.onRemove(function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.removeRowClass(U,"wux-datagrid-cell-prehighlighted")})},pushUpdateView:function(w){if((this._isPreparingView-1)===0&&this.__mustSyncModel===true){this.__mustSyncModel=false;this.syncModel(false);this._updateViewOptions.generatePool=true}this._parent(w)},updateView:function(y){this.options.performances.minimumScrollDistance=this.options.defaultCellHeight*0.5;var z=this;if(z._toCellWillBeEdited){clearTimeout(z._toCellWillBeEdited);z._toCellWillBeEdited=null}if(!this._needFullUpdate){var B=this._listOfModifiedNodes.get();if(B.length>0){if(z.isPerformanceAnalysis()){console.time("["+z._name+"]:smart update")}z.getViewportDimensions(true);var w=z._computeVirtualViewport();this._beginUpdate();B.forEach(function x(C){var D=C._getRowID();if(D!==null&&D!==undefined&&D<=w.maxRowID&&D>=w.minRowID){z.updateRowView(D)}else{if(z.isPerformanceAnalysis()){console.log("["+z._name+"]:ignore this node outside viewport or hidden",C.getLabel(),w)}}});this._resetListOfUpdatedNodes();this._endUpdate();if(z.isPerformanceAnalysis()){console.timeEnd("["+z._name+"]:smart update")}z._needFullUpdate=false;this._updateSelectAllCheckBox();var A=this.getActiveNode();if(A){z._setActiveStateForNode(A)}else{z._unsetActiveStateForNode(A)}this._notifyUpdateViewCompleted();return}}if((this._enableDebouncedSyncModel&&!this._debounceReflectView)||(this._enableDebouncedSyncModel===false)){this._parent(y);z._needFullUpdate=false}var A=this.getActiveNode();if(A){z._setActiveStateForNode(A)}else{z._unsetActiveStateForNode(A)}this._resetListOfUpdatedNodes();this._updateSelectAllCheckBox()},needToRequestContentAt:function(w){return this._listOfModifiedNodes.get().some(function(x){return x._getRowID()===w.virtualRowID})},updateCellView:function(x,w){if(x instanceof l){this._parent(x._getRowID(),w)}else{this._parent(x,w)}},_syncRowModelWithTreeNodeModel:function(y){var x=this;var z=this._nodeModelToRowModel(y);for(var w in z){x.setCellContent(y._getRowID(),w,z[w])}},updateRowViewWithException:function(x,w){if(x!==null&&x!==undefined){if(x instanceof l){this._syncRowModelWithTreeNodeModel(x);this._parent(x._getRowID(),w)}else{this._syncRowModelWithTreeNodeModel(this.getTreeNodeModelFromRowID(x));this._parent(x,w)}this._requireFullUpdate()}},updateRowView:function(w){if(w instanceof l){this._syncRowModelWithTreeNodeModel(w);this._parent(w._getRowID(true))}else{if(w>-1){var x=this.getTreeNodeModelFromRowID(w);if(x){this._syncRowModelWithTreeNodeModel(x)}this._parent(w)}}this._requireFullUpdate()},syncModel:function(G,y){var D=this;D.onPostUpdateViewOnce(function(){D._heavyDataColumnModelRequest("syncModel")});this._requireFullUpdate();if(y===undefined){y=true}if(G===undefined){G=true}var x=this;var E=0;var F=false;var w=false;x._computeVirtualViewport();var z=x.getVirtualViewport();var C=function(){x.prepareUpdateView();x.empty();x._freeUpPool(2);x._numberOfVisibleNodesInDocument=0;F=true;if(t){console.time("sync model");console.time("sync view")}};var B=function(){x._setColumnsWidth();x.onPreUpdateViewOnce(function(){x._computeVirtualViewport()});x._debounceReflectView=null;x.pushUpdateView();w=true;if(t){console.timeEnd("sync view")}};C();var A=0;x.getDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:false,processNode:function(H){if(H.nodeModel.isVisible()&&!H.nodeModel.hasNoRepresentation()){var J=x._nodeModelToRowModel(H.nodeModel);H.nodeModel._rowID=E;x.addRow(J);var I=x.getRowHeight(E);if(I!==x.options.defaultCellHeight){x.setRowHeight(E,I,false)}if(E===0){x._listOfRowsPosition[E]=0}else{x._listOfRowsPosition[E]=A}A=A+I;if(H.nodeModel.isSelected()||H.nodeModel.isHighlighted()){x.selectRow(E,false)}if(y&&z.maxRowID===E){B()}x._numberOfVisibleNodesInDocument++;E++}else{H.nodeModel._rowID=null}}});if(t){console.timeEnd("sync model")}if(!y||(w===false&&F===true)){B()}},_reflectView:function(){this.__mustSyncModel=true},selectAll:function(){var x=this;var w=x.getDocument();var y=[];w.withTransactionUpdate(function(){w._getTrueRoot().processDescendants({processNode:function(z){if(w.options.shouldBeSelected.call(w,z.nodeModel)){y.push(z.nodeModel)}}});x.getNodesXSO().add(y)})},selectAllVisibleNodes:function(){if(this.options.selection.canMultiSelect===true){var x=this;var w=x.getDocument();var y=[];w.withTransactionUpdate(function(){w._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(z){if(w.options.shouldBeSelected.call(w,z.nodeModel)){y.push(z.nodeModel)}}});x.getNodesXSO().add(y)})}},unselectAll:function(){this.withUpdate(function(){this.getNodesPXSO().empty();this.getNodesXSO().empty()})},_selectRowProcessCB:function(w,z,y,x){this._parent(w,z,y,x);if(this.getColumnOptions(y)&&this.getColumnOptions(y).type==="selection"){this.updateCellView(z,y)}},_unselectRowProcessCB:function(w,y,x){this._parent(w,y,x);if(this.getColumnOptions(x)&&this.getColumnOptions(x).type==="selection"){this.updateCellView(y,x)}},_restoreSelection:function(){var w=this;w.prepareUpdateView();this.getNodesXSO().get().forEach(function(x){var y=x._getRowID();if(y!==null){w.selectRow(y,false)}});w.pushUpdateView()},loadDocument:function(w){this._freeUpPool(2);this._isPreparingView=0;this._updateCounter=0;this.prepareUpdateView();if(this._treeDocument){this.unloadDocument();this._cleanBindingOnDocument()}this._createDocument(w);this._syncRowIndexes(true);this._setColumnsWidth();this._restoreSelection();this.pushUpdateView(true)},unloadDocument:function(){this.prepareUpdateView();this.empty();if(this.options.selection.viewBased===true){this.getNodesPXSO().empty();this.getNodesXSO().empty()}this._cleanBindingOnDocument();this._createDocument();this.pushUpdateView(true)},scrollToNode:function(z,w,x){if(x===undefined){x=true}var y=z._getRowID(true);this.scrollToRow(y,w);if(x===true){this.updateView()}},isNodeInVisibleViewport:function(w){return(this.nodePositionInVisibleViewport(w)===0)},nodePositionInVisibleViewport:function(y){if(!this._scrollerDimensions){return 0}var w=this.getRowPosition(y._getRowID());var A=this.getScrollerPosition().y;if(A>w){return -1}var x=this.getRowHeight(y._getRowID());var z=this.getScroller().getContent().getDimensions().height;if((w+x)>(A+z)){return 1}return 0},expandAll:function(){this.prepareUpdateView();var w=this.unloadDocument();var x=w.getAllDescendants();n.optimizedForEach(x,function(y){if(y.hasChildren()){y.expand()}});this.loadDocument(w);this.pushUpdateView()},collapseAll:function(){this.prepareUpdateView();var w=this.unloadDocument();var x=w.getAllDescendants();n.optimizedForEach(x,function(y){if(y.hasChildren()){y.collapse()}});this.loadDocument(w);this.pushUpdateView()},getTreeNodeModelFromRowID:function(w){return this.getCellContent(w,"tree")},onNodeDblClick:function(w){return this._modelEvents.subscribe({event:"dblClick"},w)},onNodeClick:function(w){return this.onCellClick(w)},sortColumnContent:function(B,x){var A=this;this.prepareUpdateView();if(typeof B!=="string"){B=this.getDataIndexFromColumnID(B)}var z=this.getColumnIDFromDataIndex(B);var C=this.getColumnOptions(z);x=g.extend({sortOrder:"asc",sortFunction:C.sortFunction||function(E,D){if(B==="tree"){return E.options.label<D.options.label?-1:1}else{if(E.options.grid[B]===D.options.grid[B]){return 0}if(E.options.grid[B]===null){return -1}if(D.options.grid[B]===null){return 1}if(E.options.grid[B]===undefined){return -1}if(D.options.grid[B]===undefined){return 1}return E.options.grid[B]<D.options.grid[B]?-1:1}}},x);this._setColumnState(z,"sort:"+x.sortOrder);for(var y=0;y<this.getRow(-1).length;y++){if(y!==z){var w=A.getRow(-1)[y];if(w._view){w._view.getContent().removeClassName("wux-ui-sort-desc");w._view.getContent().removeClassName("wux-ui-sort-asc")}w.removeClass("wux-ui-sort-desc");w.removeClass("wux-ui-sort-asc")}}this.getCell(-1,z).removeClass("wux-ui-sort-desc");this.getCell(-1,z).removeClass("wux-ui-sort-asc");this.getCell(-1,z).addClass("wux-ui-sort-"+x.sortOrder);this.getDocument()._getTrueRoot().sortChildren({isRecursive:true,sortFunction:function(F,E){var D=x.sortOrder==="asc"?1:-1;return D*x.sortFunction(F,E)}});this._reflectView();this.pushUpdateView(true);this._modelEvents.publish({event:"sort",data:{columnID:z,columnDataIndex:B,sortOrder:x.sortOrder}})},restoreColumnsPreferences:function(w){this._parent(w);this._syncRowIndexes(true)},_onCellChange:function(A){if(!this._isRequestingCell){var w=this;var B=r.firstParentWithClass(A.target,"wux-datagrid-cell");if(B){var D=w._getCellViewFromDom(B);var E=D.getCellInfos();if(!E.isHeader){var x=this._getColumnOptionValue(E.dataIndex,"setValue");var z=this._getColumnOptionValue(E.dataIndex,"onCellChange");var y=E;y.event=A;var C=z.call(this,y);y.value=C;x.call(this,y);w._recordInteractionFromUI({event:"node:change",data:{nodeRecordPath:E.nodeModel?E.nodeModel.getStructurePath():E.nodeModel,dataIndex:E.dataIndex,virtualRowID:E.virtualRowID,virtualColumnID:E.virtualColumnID,value:C}});w._giveFocus();if(b){console.warn("[manager:change]",D,C)}this._preventNextRowUpdateView=false}}else{w._giveFocus()}}},_setupColumnType:function(w){var x=this;switch(w.type){case"selection":w.isSortable=false;w.setValue=function(C){C.nodeModel.selectionChangeIsFromUI();if(C.value||x._modeIsListSel){if(x.options.selection.canMultiSelect){if(x._modeIsListSel){var A=x.getDocument();var z=A.getXSO().get();var B;if(z.length===0){B=A.getChildren()[0]}else{if(x._getParent().options.enableActiveUI===true){B=x.getActiveNode()}else{B=z[0]}}var y=C.nodeModel;A.withTransactionUpdate(function(){var J=B._getRowID();var I=y._getRowID();var D=(J<I?1:-1);var E=true;if(J===I){E=x.getNodesXSO().isIn(B)}var H=[];if(x._shouldBeSelected(B)){H.push(B)}for(var G=J+D;(D>0&&G<=I)||(D<0&&G>=I);G+=D){var F=x.getTreeNodeModelFromRowID(G);if(x._shouldBeSelected(F)){H.push(F)}if(E&&!x.getNodesXSO().isIn(F)){E=false}}if(E){C.cellView.__unselectNodes(H)}else{C.cellView.__selectNodes(H)}})}else{x.getNodesXSO().add(C.nodeModel)}}else{x.getNodesXSO().unique(C.nodeModel)}}else{x.getNodesXSO().remove(C.nodeModel)}};w.getValue=function(y){return x.getNodesXSO().isIn(y.nodeModel)};w.onCellChange=function(y){x._giveFocus(true);return y.event.target.dsModel.checkFlag};w.onCellRequest=function(B){if(!B.isHeader){var A=B.cellView.reuseCellContent("_selection");if(A){var z=B.manager.getDocument();var y=B.manager._shouldBeSelected(B.nodeModel);A.disabled=B.isHeader?false:!y;A.checkFlag=B.manager.getNodesXSO().isIn(B.nodeModel)}}else{if(x.options.selection.canMultiSelect){if(x._selectAllToggleTimer){clearTimeout(x._selectAllToggleTimer)}x._updateSelectAllCheckBox()}}};break;case"tree":case"picture":case"boolean":case"color":break;default:if(w.typeRepresentation!==undefined){if(w.setValue===undefined){w.setValue=function(z){var y={};y[z.dataIndex]=z.value;if(z.nodeModel._isUsingDataModel()){z.manager.prepareUpdateView();z.nodeModel._getDataModel().update({grid:y});z.manager.pushUpdateView()}else{z.nodeModel.updateOptions({grid:y});z.manager.updateRowViewWithException(z.nodeModel,z.dataIndex)}}}w.onCellRequest=function(B){if(!B.isHeader){var y=B.manager._getColumnOptionValue(B.dataIndex,"getValue");var z=y.call(B.manager,B);var A=!x._isCellEditable(B);B.cellView._disposeReusableContent();this._typeRepFactory.generateView(z,{typePath:w.typeRepresentation,readOnly:A,context:"inlinedTemplate",onViewCreated:function(C){B.cellView._setReusableContent(C,"_typeRep-"+w.typeRepresentation);if(!C.readOnly){B.cellView.getContent().setAttribute("draggable",false)}}})}}}break}},_getViewOptions:function(){return this._instance._parentObject.options},_shouldBeSelected:function(x){var w=this.getDocument();if(this._getViewOptions().selection.viewBased===true){return this._getViewOptions().nodeShouldBeSelected.call(w,x)}else{return w.options.shouldBeSelected.call(w,x)}},_updateSelectAllCheckBox:function(){var w=this;var z=this._getCellViewDom(-1,"selection");if(z){var y=z.dsView.getCellInfos();if(this._selectAllCheckBox===undefined){this._preventSelectAllCheckBoxListenChange=false;this._selectAllCheckBox=new e({});this._selectAllCheckBox.getContent().addEventListener(i.POINTERDOWN,function(A){A.stopPropagation()});this._selectAllCheckBox.getContent().addEventListener("focus",function(A){A.preventDefault();A.stopPropagation()});this._selectAllCheckBox.getContent().addEventListener("change",function(A){if(w._preventSelectAllCheckBoxUpdate){return}w._preventSelectAllCheckBoxUpdate=true;if(A.dsModel.checkFlag){w.selectAllVisibleNodes()}else{w.unselectAll()}w._selectAllCheckBox.mixedState=false;w._giveFocus();w._preventSelectAllCheckBoxUpdate=false})}if(!this._preventSelectAllCheckBoxUpdate){this._preventSelectAllCheckBoxUpdate=true;var x=this.getNodesXSO().isEmpty();this._selectAllCheckBox.checkFlag=!x;this._selectAllCheckBox.mixedState=!x&&!w.isEveryVisibleNodeSelected();this._preventSelectAllCheckBoxUpdate=false}y.cellView.getContent().setHTML(this._selectAllCheckBox)}},_isCellEditable:function(C){var w=false;var y=this._getParent();var D=C.manager.getColumnOptions(C.virtualColumnID);var B=C.manager.getDocument().options.shouldBeEditable.call(C.nodeModel,C.nodeModel);var A=(y.options.shouldBeEditable===undefined||(typeof y.options.shouldBeEditable==="function"&&y.options.shouldBeEditable.call(C.nodeModel,C)));if(A===undefined){A=true}var x=(D.isEditable===undefined||D.isEditable===true);var z=B&&A&&x;if(w){console.log("cell [",C.virtualRowID,",",C.dataIndex,"]","node is editable:",B,"cell is editable:",A,"column is editable:",x,">>",z)}return z},setActiveNode:function(w){if(this._instance.options.enableActiveUI){if(w){if(this._activeNode!==w){this._activeNode=w;this._modelEvents.publish({event:"active",context:w,data:w._getNodeInfos()})}}else{this.unsetActiveNode()}}},getActiveNode:function(){return this._activeNode},unsetActiveNode:function(w){if(this.getActiveNode()){this._modelEvents.publish({event:"inactive",context:w})}},_enableActiveStateForNode:function(x){var y=x._getRowID();var w=this;this.disableDragOverStateForRow();this.disableDragOverStateForBlank();if(w._activeMarkBG===undefined){w._activeMarkBG=new g.Element("div",{"class":"wux-tree-active-element-bg wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:w.getRowPosition(y),left:0,height:w.getRowHeight(y),right:0}}).inject(w.elements.poolContainerRelDettachable);w._activeMarkFG=new g.Element("div",{"class":"wux-tree-active-element-fg wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:w.getRowPosition(y),left:0,height:w.getRowHeight(y),right:0}}).inject(w.elements.poolContainerRelDettachable)}else{this._activeMarkFG.style.display="block";w._activeMarkBG.style.display="block"}},_computeStyleForActiveState:function(y){var z=y._getRowID();var x,w;x=this.getRowPosition(z);w=this.getRowHeight(z);return{top:x,left:0,height:w,right:0}},_setActiveStateForNode:function(y){this._enableActiveStateForNode(y);var x=this._computeStyleForActiveState(y);var w="middle";this._activeMarkBG.setAttribute("wux-ui-drop-position",w);this._activeMarkBG.setStyles({height:x.height-2,top:x.top+1,left:x.left+1,right:x.right+2,width:x.width,border:"1px solid white",background:"transparent",display:""});this._activeMarkFG.setAttribute("wux-ui-drop-position",w);this._activeMarkFG.setStyles({height:x.height,top:x.top,left:x.left,right:x.right+1,width:x.width,display:""})},_unsetActiveStateForNode:function(w){if(this._activeMarkBG){this._activeMarkBG.removeAttribute("wux-ui-drop-position");this._activeMarkFG.removeAttribute("wux-ui-drop-position");this._activeMarkBG.style.display="none";this._activeMarkFG.style.display="none"}},enableDragOverStateForRow:function(x){var w=this;this.disableDragOverStateForRow();this.disableDragOverStateForBlank();if(w._insertNodeMarkBG===undefined){w._insertNodeMarkBG=new g.Element("div",{"class":"wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:w.getRowPosition(x),left:0,height:w.getRowHeight(x),right:0}}).inject(w.elements.poolContainerRelDettachable);w._insertNodeMarkFG=new g.Element("div",{"class":"wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:w.getRowPosition(x),left:0,height:w.getRowHeight(x),right:0}}).inject(w.elements.poolContainerRelDettachable)}else{this._insertNodeMarkBG.show();w._insertNodeMarkFG.show()}},setDragOverStateForNode:function(A,y){var B=A._getRowID();var z=this;if(z._currentDropPosition!==y){z.enableDragOverStateForRow(B,y);z._currentDropPosition=y;var x,w,C;switch(y){case"top":x=z.getRowPosition(B);w=2;if(z.isColumnHidden("tree")){C=0}else{C=z.getColumnPosition("tree")+z._getCellView2(B,"tree")._nodeOffsetX}break;default:case"middle":x=z.getRowPosition(B);w=z.getRowHeight(B);C=0;break;case"bottom":x=z.getRowPosition(B)+z.getRowHeight(B);w=2;if(z.isColumnHidden("tree")){C=0}else{C=z.getColumnPosition("tree")+z._getCellView2(B,"tree")._nodeOffsetX}break}if(this._insertNodeMarkBG){this._insertNodeMarkBG.setAttribute("wux-ui-drop-position",y);this._insertNodeMarkBG.setStyles({height:w,top:x,left:C,right:0})}if(this._insertNodeMarkFG){this._insertNodeMarkFG.setAttribute("wux-ui-drop-position",y);this._insertNodeMarkFG.setStyles({height:w,top:x,left:C,right:0})}}},disableDragOverStateForRow:function(){this._currentDropPosition=null;if(this._insertNodeMarkBG){this._insertNodeMarkBG.hide()}if(this._insertNodeMarkFG){this._insertNodeMarkFG.hide()}},_removeAllInteractiveUIFeedBacks:function(){this._lastDragOveredRowID=null;this.disableDragOverStateForRow();this.disableDragOverStateForBlank()},_recordInteractionFromUI:function(w){var x=this;d.addCustomInteraction(x._instance._parentObject.getContent(),{type:"webUX_event",reason:w.reason||"",event:w.event||"",data:w.data||{},eventOptions:{}},"DS/TreeRec/TreeListViewRec",{checkAbstract:false,checkVisibility:false})}});return a});define("DS/Tree/TreeListView",["UWA/Core","DS/Spreadsheet/DataGrid","DS/Core/PointerEvents","DS/Tree/TreeNodeView","DS/Tree/TreeNodeModel","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Utils","DS/WebRecordEnabler/Adapter","DS/TouchDragAndDropPolyfill/TouchDragAndDropPolyfill"],function(e,k,h,i,f,g,a,j,b,d){var l=document.createElement("DIV");function c(o,p){if(j.getUnsafeHTMLContentValueToApply(p)){l.innerHTML=o}else{l.innerText=o}return l.textContent||l.innerText||""}var n=k.extend({defaultOptions:{apiVersion:2,roots:[],columns:[],cellClass:i,managerClass:g,defaultCellMouseHeight:28,defaultCellTouchHeight:38,defaultCellHeight:28,defaultYDistanceOfTopBadgesFromIconCenter:8,defaultYDistanceOfBottomBadgesFromIconCenter:10,numberOfColumns:1,headersDimensions:{width:undefined,height:undefined},expanderStyle:"classic",changeColorOnFocus:true,show:{rowHeaders:false,columnHeaders:true},selection:{viewBased:false,nodes:true,cells:false,rowHeaders:true,columnHeaders:true,unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableListSelection:false},enableDragAndDrop:true,enableActiveUI:false,enableKeyboardNavigation:false,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel",},enableTreeColumnEllipsisOverflow:false,shouldDisplayTooltip:function(o){if(o.dataIndex==="tree"&&!o.isHeader){return{shortHelp:c(o.nodeModel.options.label,o.manager.options.shouldCellAllowUnsafeHTMLContentAt?o.manager.options.shouldCellAllowUnsafeHTMLContentAt(o):true)}}else{if(o.cellModel.options.value){if(typeof o.cellModel.options.value==="string"){return{shortHelp:o.cellModel.options.value}}else{if(o.cellModel.options.value.toString){return{shortHelp:o.cellModel.options.value.toString()}}else{return{shortHelp:""}}}}else{return{shortHelp:""}}}},performances:{buildLinks:true,numberOfRowsFactor:1.4,numberOfColumnsFactor:1,fullUpdateFactor:0.95,enableColumnVirtualization:false,debounceCellInternalUpdateTimer:0,debounceCellRequest:false},useAsyncPreExpand:false,showScrollbarsOnHover:false,enableScrollOnDrag:false,enableExpandOnDoubleClick:false,onDragStartCell:function(p,q){var o=[];q.manager.getNodesXSO().get().concat().sort(function(s,r){return s._getRowID()>r._getRowID()?+1:-1}).forEach(function(r){o.push(r.dump())});this.serializeDragAndDropEvent(p,{data:{"dswebux/x-tree.treenodemodel+json":o,"dswebux/x-tree.treenodemodel+number":q.nodeModel._getID()}});p.dataTransfer.effectAllowed="move"},onDragEnterRowHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDragLeaveRowHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDragStartColumnHeader:function(p,o){o.manager.__draggedColumnID=o.virtualColumnID;return true},onDragEnterColumnHeaderDefault:function(q,p){p.manager.disableDragOverStateForBlank();p.manager.disableDragOverStateForRow();if(p.manager.__draggedArea==="column"){var o=p.manager.getScroller().getPosition().x+p.manager.getHeadersDimensions().width+p.manager.getColumnPosition(p.dataIndex);if(p.manager.__draggedColumnID<p.virtualColumnID){o=o+p.manager.getColumnWidth(p.dataIndex)}else{}this._showColumnInsertionMark(o)}},onDragLeaveColumnHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow();this._hideColumnInsertionMark()},onDragEnterCellDefault:function(p,o){o.manager.enableDragOverStateForRow(o.virtualRowID,o.dropPosition)},onDragOverCellDefault:function(p,o){o.manager.setDragOverStateForNode(o.nodeModel,o.dropPosition)},onDragLeaveCellDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDropCellDefault:function(s,p){var q=p.parent;var r=this.unserializeDragAndDropEvent(s);if(r){var o=r.source.uuid;if(this._uxid===o){this._dndMode="move"}else{this._dndMode="copy"}p.mode=this._dndMode;p.manager._recordInteractionFromUI({event:"drop:node",data:{unserializedData:r,dropPosition:p.dropPosition,mode:this._dndMode,nodeRecordPath:p.nodeModel?p.nodeModel.getStructurePath():p.nodeModel,virtualRowID:p.virtualRowID,virtualColumnID:p.virtualColumnID,dataIndex:p.dataIndex}});this.getManager()._getParent()._applyDropCell(r,p)}},onDropRowHeaderDefault:function(){},onDragEndCellDefault:function(){},onDragEnterBlankDefault:function(p,o){setTimeout(function(){o.manager.enableDragOverStateForBlank()},10)},onDragLeaveBlankDefault:function(p,o){o.manager.disableDragOverStateForBlank()},onDropBlankDefault:function(r,q){q.manager.disableDragOverStateForBlank();var p=this.unserializeDragAndDropEvent(r);if(p){var o=p.source.uuid;if(this._uxid===o){this._dndMode="move"}else{this._dndMode="copy"}q.mode=this._dndMode;q.manager._recordInteractionFromUI({event:"drop:blank",data:{unserializedData:p,dropPosition:q.dropPosition,mode:this._dndMode,nodeRecordPath:q.nodeModel?q.nodeModel.getStructurePath():q.nodeModel,virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID,dataIndex:q.dataIndex}});this.getManager()._getParent()._applyDropBlank(p,q)}},onDragStartRowHeaderDefault:function(){},useTransparentScroller:false},init:function(q){var t=this;if(q===undefined){q={}}if(!q.columns){q.columns=e.clone(this.defaultOptions.columns)}var o=e.extend(e.clone(this.defaultOptions.selection),q.selection);if(q){if(q.isEditable){var s={switchToWriteView:{event:h.POINTERHIT,callback:function(A){var y=A.event;if((y&&y.multipleHitCount===1&&!o.toggle)||(y&&y.multipleHitCount===2&&o.toggle)){var z=this;if(!A.isHeader&&((A.dataIndex==="tree"&&a.firstParentWithClass(A.event.target,"wux-layouts-treeview-node")||((A.dataIndex!=="tree"&&!a.hasClass(A.event.target,"wux-layouts-treeview-node")))))){var C=A.manager.getColumnOptions(A.virtualColumnID);var w=A.manager._isCellEditable(A);if(C.typeRepresentation===undefined&&w){if(o.toggle){this.switchToWriteView()}else{if((!t.getManager().isInMultiSelection()&&t.getManager().getNodesXSO().get().length===1)||t.getManager().options.selection.cells===true){var B=A.manager._getRowLastClick(A.virtualRowID);var v=Date.now()-B;if((B!==0&&v>300&&A.manager.getNodesXSO().isIn(A.nodeModel))||(B!==0&&v>300&&t.getManager().options.selection.cells===true)){if(!A.manager.isInMultiSelection()){var x=function(){z._isCurrentlyEdited=false;z.switchToWriteView()};if(window.__karma__!==undefined||h.isTouchEvent(y)){x()}else{if(A.manager._toCellWillBeEdited){clearTimeout(A.manager._toCellWillBeEdited)}A.manager._toCellWillBeEdited=setTimeout(x,500)}}}A.manager._setRowLastClick(A.virtualRowID,Date.now())}}}}}},view:function(w){if(!w.isHeader){if(!w.typeRepresentation){var v=w.cellView;switch(w.dataIndex){case"tree":if(w.nodeModel!==""){v.setLabel(w.nodeModel.options.label);v.setIcons(w.nodeModel.getIcons());v.setBadges(w.nodeModel.options.badges);v._setExpanderState(w.nodeModel.getState());v._setDepth(w.nodeModel.getNodeDepth())}break;default:var x=new e.Element("input",{type:"text",value:w.cellModel.getCellContent().toString(),"class":"wux-layouts-treeview-label"});v.getContent().setContent(x);x.select()}}}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(w){if(!w.isHeader){switch(w.dataIndex){default:var v=w.cellModel.getCellContent();return(v!==undefined&&v!==null)?w.cellModel.getCellContent().toString():""}}}},nodesAreDraggable:true,cells:true};var u={switchToWriteView:{event:h.POINTERHIT,callback:function(y){var x=y.event;if((x&&x.multipleHitCount===1&&!o.toggle)||(x&&x.multipleHitCount===2&&o.toggle)){if(!y.isHeader&&((y.dataIndex==="tree"&&a.firstParentWithClass(y.event.target,"wux-layouts-treeview-label")||((y.dataIndex!=="tree"&&!a.hasClass(y.event.target,"wux-layouts-treeview-label")))))){var A=y.manager.getColumnOptions(y.virtualColumnID);var w=y.manager._isCellEditable(y);if(A.typeRepresentation===undefined&&w){if(o.toggle){this.switchToWriteView()}else{if((!t.getManager().isInMultiSelection()&&t.getManager().getNodesXSO().get().length===1)||t.getManager().options.selection.cells===true){var z=y.manager._getRowLastClick(y.virtualRowID);var v=Date.now()-z;if((z!==0&&v>300&&y.manager.getNodesXSO().isIn(y.nodeModel))||(z!==0&&v>300&&t.getManager().options.selection.cells===true)){if(!y.manager.isInMultiSelection()){this._isCurrentlyEdited=false;this.switchToWriteView()}}y.manager._setRowLastClick(y.virtualRowID,Date.now())}}}}}},view:function(v){if(!v.isHeader){var w=v.manager.getColumnOptions(v.virtualColumnID);if(!v.typeRepresentation){if(v.dataIndex!=="tree"){if(w.onCellRequest){v.readOnly=false;return w.onCellRequest.call(v.manager,v)}else{return v.cellModel.getCellContent().toString()}}}}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(w){var x=w.manager.getColumnOptions(w.virtualColumnID);if(!w.isHeader){if(!w.typeRepresentation){if(w.dataIndex==="tree"){var v=w.cellView;if(w.nodeModel!==""){v.setLabel(w.nodeModel.options.label);v.setIcons(w.nodeModel.getIcons());v.setBadges(w.nodeModel.options.badges);v._setExpanderState(w.nodeModel.getState());v._setDepth(w.nodeModel.getNodeDepth())}}if(x.onCellRequest){w.readOnly=true;x.onCellRequest.call(w.manager,w)}}}}},nodesAreDraggable:true,cells:true};if(q.isEditable==="auto"){q.isEditable=u;this._setEditionMode(2)}else{this._setEditionMode(1);if(q.isEditable===true){q.isEditable=s}else{q.isEditable=e.extend(s,q.isEditable,true)}}}}this._setupColumns(q);this._currentNodeDropArea=null;this._parent(q,this);this.markForRecord(this.getContent());this.elements.container.dsModel=this;this.elements.container.setAttribute("data-rec-id","treeListView");this.elements.container.addClassName("wux-tree-treelistview");this.elements.container.setAttribute("expander-style",this.options.expanderStyle);if(!this.options.changeColorOnFocus){this._datagrid.elements.container.addClassName("wux-ui-state-focused")}this._treeWidth=200;this._depth=-1;this._rowID=-1;this.getManager()._tree=this;var r=this.getManager();this._modelEvents=r._modelEvents;if(q.roots){if(q.useAsyncPreExpand){this.getManager().getDocument().options.useAsyncPreExpand=true}this.getManager().getDocument().loadModel(q.roots);this.getManager()._syncRowIndexes(true)}this._observeEvents();if(q.treeDocument){this.getManager().loadDocument(q.treeDocument)}var p=this.getManager().onReady(function(){t._modelEvents.unsubscribe(p);t._manageColumnsCSS(q)})},_applyDropBlank:function(q,p){var o=q.data["dswebux/x-tree.treenodemodel+json"];if(p.mode==="move"){p.manager.getDocument().prepareUpdate();p.manager.getNodesXSO().get().forEach(function(r){r.remove()});p.manager.getDocument().pushUpdate()}if(o){o.forEach(function(s){var r=new f(s);p.manager.getDocument().addChild(r)})}p.manager.disableDragOverStateForBlank()},_applyDropCell:function(s,p){var q=this;var r=s.data["dswebux/x-tree.treenodemodel+number"];var o=s.data["dswebux/x-tree.treenodemodel+json"];if(p.dropPosition==="middle"&&p.nodeModel._getID()===r){return}if(o){o.forEach(function(z,u){var y=new f(z);var x=p.nodeModel;var A=p.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:p.dropPosition==="middle"?x:x.getParent(),draggedTreeNodeModel:y,dropPosition:p.dropPosition});if(A){p.manager.getDocument().prepareUpdate();var t=x.getParent();var w=t.getChildren().indexOf(x);if(p.mode==="move"){p.manager.getDocument().prepareUpdate();p.manager.getNodesXSO().get().forEach(function(B){B.remove()});p.manager.getDocument().pushUpdate()}if(p.virtualRowID!==-1){var v=p.manager;switch(p.dropPosition){case"top":w=t.getChildren().indexOf(x);t.addChild(y,w);break;default:case"middle":v.getDocument().options.insert.call(v.getDocument(),y,x);break;case"bottom":x.getParent().addChild(y,x.getParent().getChildren().indexOf(x)+1+u);break}}p.manager.getDocument().pushUpdate()}})}},_setEditionMode:function(o){this._editionMode=o},_getEditionMode:function(){return this._editionMode},_shouldAcceptDrag:function(p){var r=this.getManager().getColumnOptions(p.dataIndex);if(!r){return false}if(!p.isHeader){var o=r.isColumnDraggable;if(o===undefined){o=true}if(o){return this.getDocument().options.shouldAcceptDrag(p.nodeModel,p)}else{return false}}else{if(p.virtualRowID===-1){var q=r.isColumnMovable;if(q===undefined){q=true}return q}else{return false}}},_getTrueRoot:function(){return this.getManager()._getTrueRoot()},getDocument:function(){return this.getManager().getDocument()},getNthRoot:function(o){return this.getManager().getNthRoot(o)},getRoots:function(){return this.getManager().getRoots()},toggle:function(){this.elements.container.toggle()},_syncRowIndexes:function(){return this.getManager()._syncRowIndexes()},addRoot:function(o){return this.getManager().addRoot(o)},_updateTreeColumnWidth:function(p){var o=p.elements.layout.getDimensions().width;this._treeWidth=this._treeWidth<o?o:this._treeWidth;this.getManager().setColumnWidth("tree",this._treeWidth)},_setupColumns:function(o){var r=this;var q={text:"Tree",dataIndex:"tree",width:"auto",getValue:function(s){return s.nodeModel},onCellRequest:function(t){if(t.virtualRowID>-1){var s=t.cellView;if(t.nodeModel!==""){if(r.options.shouldDisplayTooltip===undefined){s.getContent().setAttribute("title",t.nodeModel.getLabel())}s.setLabel(t.nodeModel.getLabel());s.setIcons(t.nodeModel.getIcons());s.setBadges(t.nodeModel.getBadges());if(s.elements.badgeTopRight.style.top!==(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"){s.elements.badgeTopRight.style.top=(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"}if(s.elements.badgeBottomRight.style.top!==r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"){s.elements.badgeBottomRight.style.top=r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"}if(s.elements.badgeTopLeft.style.top!==(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"){s.elements.badgeTopLeft.style.top=(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"}if(s.elements.badgeBottomLeft.style.top!==r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"){s.elements.badgeBottomLeft.style.top=r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"}s._setExpanderState(t.nodeModel._expandState);s._setDepth(t.nodeModel._nodeDepth);t.cellView.elements.container.setContent(t.cellView.elements.layout)}}},isDraggable:true};var p;for(p=0;p<o.columns.length;p++){if(o.columns[p].dataIndex==="tree"){break}}if(p!==o.columns.length){o.columns[p]=e.extend(q,o.columns[p],true)}else{o.columns.unshift(q)}},_manageColumnsCSS:function(o){var p=0;for(p=0;p<o.columns.length;p++){if(o.columns[p].allowTextCopy===true){this.getManager().addColumnClass(p,"wux-ui-allowTextCopy")}}},loadColumns:function(o){this.getManager().empty();this.getManager()._needToComputeColumnReverseDataIndexes();this.getManager().prepareUpdateView();this._setupColumns({columns:o});this.options.columns=o;this._datagrid.options.columns=o;this.getManager().options.columns=o;this._datagrid._loadInternalModel();this.getManager()._syncRowIndexes(true);this.getManager().pushUpdateView(true);this.getManager()._syncRowIndexes();this.getManager()._syncScrollPositionToHeaders()},_observeEvents:function(){if(this.options.enableTreeColumnEllipsisOverflow===true){this.getContent().setAttribute("tree-overflow","true")}if(this.options.enableExpandOnDoubleClick){this.getManager().addEventListener("dblclick",function(o,p){if(p&&!p.isHeader){if(p.nodeModel.isExpanded()){p.nodeModel.collapse()}else{p.nodeModel.expand()}}})}},onExpand:function(o){return this.getManager().getDocument().subscribe({event:"expand"},o)},onCollapse:function(o){return this.getManager().getDocument().subscribe({event:"collapse"},o)},onNodeDragOver:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_OVER"},o)},onNodeDragStart:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_START"},o)},onNodeDragLeave:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_LEAVE"},o)},onNodePreDrop:function(o){return this.getManager().getDocument().subscribe({event:"NODE/PRE_DROP"},o)},onNodePostDrop:function(o){return this.getManager().getDocument().subscribe({event:"NODE/POST_DROP"},o)},onPreExpand:function(o){return this.getManager().getDocument().subscribe({event:"preExpand"},o)},onPostExpand:function(o){return this.getManager().getDocument().subscribe({event:"postExpand"},o)},onPreCollapse:function(o){return this.getManager().getDocument().subscribe({event:"preCollapse"},o)},onPostCollapse:function(o){return this.getManager().getDocument().subscribe({event:"postCollapse"},o)},onNodeClick:function(o){return this.getManager()._modelEvents.subscribe({event:"nodeclick"},o)},onNodeDblClick:function(o){return this.getManager()._modelEvents.subscribe({event:"nodeDblClick"},o)},onLabelChange:function(o){return this.getManager().getDocument().subscribe({event:"UPDATE_LABEL"},o)}});var m={nodeShouldBeSelected:function(o){return true},allowUnsafeHTMLContent:undefined,shouldCellAllowUnsafeHTMLContentAt:function(o){return o.manager.options.allowUnsafeHTMLContent},enableScrollOnDrag:true,defaultCellHeight:38,defaultCellWidth:200,changeColorOnFocus:true,iconsSize:22,roots:[],height:400,infiniteScrolling:true,useAsyncPreExpand:true,isEditable:true,resize:{columns:true,rows:true},columns:[{text:"Tree",dataIndex:"tree",width:"auto"}],apiVersion:2,selection:{viewBased:false,nodes:true,preSelection:false,toggle:false,rowHeaders:false,unselectAllOnEmptyArea:true,enableListSelection:true,canMultiSelect:true},show:{rowHeaders:true,columnHeaders:true},headersDimensions:{width:50,height:24},enableTreeColumnEllipsisOverflow:true,enableKeyboardNavigation:true,enableActiveUI:true,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel",pageup:"treelistview:go-to-previous-page-node",pagedown:"treelistview:go-to-next-page-node","shift+pageup":"treelistview:go-to-previous-page-node","shift+pagedown":"treelistview:go-to-next-page-node","ctrl+pageup":"treelistview:go-to-previous-page-node","ctrl+pagedown":"treelistview:go-to-next-page-node",home:"treelistview:go-to-first-visible-node",end:"treelistview:go-to-last-visible-node","ctrl+home":"treelistview:go-to-first-visible-node","ctrl+end":"treelistview:go-to-last-visible-node","shift+home":"treelistview:go-to-first-visible-node","shift+end":"treelistview:go-to-last-visible-node","ctrl+a":"treelistview:select-all",f2:"treelistview:edit-label"},performances:{renderingMode:"adaptive",preloadPool:true,useRequestAnimationFrameRendering:true,enableColumnVirtualization:true}};n.SETTINGS={extend:function(p,o){if(typeof p==="string"){return e.extend(e.clone(n.SETTINGS[p]),o,true)}else{return e.extend(e.clone(p),o,true)}}};Object.defineProperty(n.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return e.extend(e.clone(m),{columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{text:"Tree",dataIndex:"tree",width:"auto"}],performances:{renderingMode:"adaptive",}})}});Object.defineProperty(n.SETTINGS,"STANDARD",{get:function(){return e.clone(m)}});b.register(n,"DS/TreeRec/TreeListViewRec");return n});define("DS/Tweakers/GeneratedToolbar",["UWA/Core","UWA/Element","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Toolbar","DS/Tweakers/TypeRepresentationFactory","DS/Tree/TreeListView","DS/Tweakers/CustomTreeNodeViewTweaker","DS/Controls/TooltipModel","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","UWA/Class/Promise","DS/Utilities/Utils","DS/Utilities/Dom",],function(f,n,b,p,s,o,h,i,g,j,k,e,d,q){function l(){var v=0;function z(C,D,B,F){var E=0;v=0;var A=[];for(var G in B){if(!B[G]||B[G].length===0){return}B[G].forEach(function(I){var J=E>0&&I===B[G][0];var H=y(C,I,J,F);A.push(H)});E++}return A}function y(D,J,E,B){var C,H,G,I;var F={};F.id=J._ID;C=f.createElement("div",{"class":"wux-generated-toolbar-items"});C.toolbarProperties=C.toolbarProperties||{};C.toolbarProperties.order=t;t++;C._treeNodeModel=J;I=J.options.label;if(I&&J.options.displayLabel){H=f.createElement("div",{"class":"wux-generated-toolbar-items-label",html:I}).inject(C)}G=f.createElement("div",{"class":"wux-generated-toolbar-items-tweaker"}).inject(C);var A=function(O){if(!J._associatedView){J._hasBeenUpdatedSinceViewGeneration=true;return}var L=J.options.grid.semantics?J.options.grid.semantics:{};for(var P in J.options){if(Object.getPrototypeOf(J._associatedView).publishedProperties[P]){L[P]=J.options[P]}}L.value=J.options.grid.data;L.context=J._associatedView.context;if(J._associatedView.tooltipInfos){J._associatedView.tooltipInfos.shortHelp=J.options.tooltip}else{if(J.options.tooltip){L.tooltipInfos=new g({shortHelp:J.options.tooltip})}}var M=x.typeRepresentationFactory.getRegisteredTypeRepresentation(J.options.grid.typeRep);var K=x.typeRepresentationFactory.getTemplateIdentifierFromTypeRep(M,"inlinedTemplate");var N=x.typeRepresentationFactory.getRegisteredTypeTemplate(K);d.setTweakerProperties(J._associatedView,L,M,N)};J.addEventListener("nodeModelUpdate",A);x.promises.push(x.typeRepresentationFactory.generateView(J.options.grid.data,{typePath:J.options.grid.typeRep,readOnly:J.options.readOnly,touchMode:J.options.touchMode,disabled:J.options.disabled,context:"inlinedTemplate",semantics:f.clone(J.options.grid.semantics)}).then(function(K){if(K!==undefined){G.setContent(K);if(J.options.tooltip){K.tooltipInfos=new g({shortHelp:J.options.tooltip})}F.tweaker=K;K.context=B;J._associatedView=K;if(J._hasBeenUpdatedSinceViewGeneration){A()}K.addEventListener("change",function(){if(D&&J){D.prepareUpdate();J.setAttribute("data",K.value);D.pushUpdate()}})}}));x._toolbar.add("element",{element:C,position:J.options.position||"near",index:v});v++;if(E){x._toolbar.add("separator",{element:C,index:v});v++}return F}var x=this,u,w,t=0;x._toolbar.showEverything();x._toolbar.clear();if(!x.items){return}w={near:{},center:{},far:{}};x.items.getChildren().forEach(function(C){var A,B;A=C.options.position;B=C.options.category||"other";if(!A||w[A]===undefined){A="near"}if(!w[A][B]){w[A][B]=[]}w[A][B].push(C)});x.promises=[];x.array1=z(this.items,"near",w.near,this.context);x.array2=z(this.items,"center",w.center,this.context);x.array3=z(this.items,"far",w.far,this.context);e.allSettled(x.promises).then(function(A){x._toolbar.fire("onReady");x._toolbar.fire("dimensionsChanged")})}function a(){var t=this;if(t._popupTreeListView){t._popupTreeListView.hide()}t._toolbar.enablePopupDefaultBehavior()}function c(){var D=this;function F(){if(C&&!t){D._popupTreeListView.inject(C);t=true}}function E(I,K){var L=w;if(I._treeNodeModel){var J=I._treeNodeModel._getRowID();if(K){H.showRow(J)}else{H.hideRow(J)}}}function x(){if(H){var J=H.getRows();for(var I=0;J&&I<J.length;I++){H.hideRow(I)}}}function v(){var I,J;F();I=D._toolbar._getNearestHiddenElement();if(D._toolbar._isSeparator(I)){J=I;I=J.nextSibling}return{toolbarItemElement:I,toolbarSeparatorElement:J}}function G(){var I=0;F();for(var J=0;H&&J<H.getNumberOfRows();J++){if(!H.isRowHidden(J)){I++}}return I}function B(I){E(I,true);I.hide()}function y(I){E(I,false);I.show()}var H,w,u,C,A,t,z;u=D._toolbar.elements.dropdownPopup;C=u?D._toolbar.elements.dropdownPopup.elements.container:null;t=false;A=new i({doc:D.items});z={height:"inherit",defaultCellWidth:20,enableDragAndDrop:false};z=f.merge(z,A.treeOptions);if(!D._popupTreeListView){D._popupTreeListView=new h(z)}else{D._popupTreeListView.show()}H=D._popupTreeListView.getManager();w=H.getDocument();D._popupTreeListView.getContent().addClassName("wux-toolbar-popup-treeList");if(C&&!t){D._popupTreeListView.inject(C);H.loadDocument(D.items);t=true;C.addEventListener("show",function(){var L=D._computeColumnsWidthInPopup();var J=L.secondColumnWidth+10;var K=L.firstColumnWidth;if(K>0){K=K+40}H.setColumnWidth(0,K);H.setColumnWidth(1,J);C.style.width=K+J+10+"px";var I=document.createEvent("Event");I.initEvent("dimensionsChanged",true,false);C.dispatchEvent(I)})}x();D._toolbar.enablePopupBehavior({getLastInPopup:v,getNbElementsInPopup:G,addToPopup:B,addToToolbar:y})}function m(C){var v=C;if(!v.entries){return}var D=[];function x(M){if(M.dataElements){var L=null,J=null;var K={label:"title",typeRepresentation:"type"};for(L in M.dataElements){J=L;if(K.hasOwnProperty(L)){J=K[L]}Object.defineProperty(M,J,Object.getOwnPropertyDescriptor(M.dataElements,L));delete M.dataElements[L]}}}var A=v.entries,u=A.length,F=0,I=0,H=null,t=null,E=0;for(F=0;F<u;++F){H=A[F];if(!H.dataElements){throw new Error("Missing dataElements on",H)}if(!H.dataElements.typeRepresentation){throw new Error("Missing dataElements.typeRepresentation on",H)}if(H.grid){throw new Error("grid is a reserved keyword")}H.grid={};Object.defineProperty(H.grid,"typeRep",Object.getOwnPropertyDescriptor(H.dataElements,"typeRepresentation"));delete H.dataElements.typeRepresentation;H.grid.semantics={};if(undefined!==H.dataElements.icon&&null!==H.dataElements.icon){Object.defineProperty(H.grid.semantics,"icon",Object.getOwnPropertyDescriptor(H.dataElements,"icon"));delete H.dataElements.icon}if(undefined!==H.dataElements.label&&null!==H.dataElements.label){Object.defineProperty(H.grid.semantics,"label",Object.getOwnPropertyDescriptor(H.dataElements,"label"))}if(undefined!==H.dataElements.readOnly&&null!==H.dataElements.readOnly){Object.defineProperty(H.grid,"readOnly",Object.getOwnPropertyDescriptor(H.dataElements,"readOnly"))}if(undefined!==H.dataElements.disabled&&null!==H.dataElements.disabled){Object.defineProperty(H.grid,"disabled",Object.getOwnPropertyDescriptor(H.dataElements,"disabled"))}if(undefined!==H.dataElements.value&&null!==H.dataElements.value){Object.defineProperty(H.grid,"data",Object.getOwnPropertyDescriptor(H.dataElements,"value"))}if(H.dataElements.hasOwnProperty("value")){delete H.dataElements.value}if(H.grid.data===undefined){if(H.children){H.grid.data={};Object.defineProperty(H.grid.data,"menu",Object.getOwnPropertyDescriptor(H,"children"));delete H.children;E=H.grid.data.menu.length;for(I=0;I<E;++I){t=H.grid.data.menu[I];x(t);if(t.children&&t.children.length>0){Object.defineProperty(t,"submenu",Object.getOwnPropertyDescriptor(t,"children"));delete t.children;var z=t.submenu;var B=z.slice(0,z.length);var y=null;while(B.length>0){y=B.splice(0,1)[0];if(y.children&&y.children.length>0){B=B.concat(y.children);Object.defineProperty(y,"submenu",Object.getOwnPropertyDescriptor(y,"children"));delete y.children}x(y)}}}}}var w=null;for(w in H.dataElements){Object.defineProperty(H,w,Object.getOwnPropertyDescriptor(H.dataElements,w));delete H.dataElements[w]}delete H.dataElements;if(H.action){if(H.grid.data===undefined){H.grid.data={}}for(w in H.action){Object.defineProperty(H.grid.data,w,Object.getOwnPropertyDescriptor(H.action,w));delete H.action[w]}delete H.action}var G=new k(H);G._ID=H.id;D.push(G)}return{nodes:D,typeReps:v.typeRepresentations,enums:v.enums}}var r=p.inherit({name:"generatedToolbar",publishedProperties:{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},items:{defaultValue:null,type:"DS/Treeitems/TreeDocument",category:"Model"},typeRepresentationFactory:{defaultValue:null,type:"DS/Tweakers/TypeRepresentationFactory",category:"Model"},popupDisplayStyle:{defaultValue:"TreeListView",type:"string",category:"Appearance"},context:{defaultValue:undefined,type:"object"}},_toolbar:null,_popupTreeListView:null,createTreeDocument:function(v){var u=null;var t=m(v);if(t){u=new j();u.prepareUpdate();u.addRoot(t.nodes);u.pushUpdate()}return u},updateModel:function(u){if(this.items){this.items.empty()}var t=m(u);if(t){if(!this.items){this.items=new j()}this.items.prepareUpdate();this.items.addRoot(t.nodes);this.items.pushUpdate()}},buildView:function(){this._toolbar=new s();this._properties.typeRepresentationFactory.value=new o();this.elements=this._toolbar.elements},_applyProperties:function(t){this._parent(t);if(this.isDirty("direction")){this._applyDirection(t.direction)}if(this.isDirty("overflowManagement")){this._applyOverflowManagement(t.overflowManagement)}if(this.isDirty("items")){this._applyItems(t.items)}this._applyPopupDisplayStyle(t.popupDisplayStyle)},_applyOverflowManagement:function(t){this._toolbar.overflowManagement=this.overflowManagement},_applyDirection:function(t){this._toolbar.direction=this.direction},_applyItems:function(t){var u=this;if(u.items){u.items.getModelEvents().addEventListener("addChild",function(v){l.call(u)});u.items.getModelEvents().addEventListener("removeChild",function(v){l.call(u)})}l.call(u)},_applyPopupDisplayStyle:function(t){if(this.popupDisplayStyle==="TreeListView"){c.call(this)}else{if(this.popupDisplayStyle==="Basic"){a.call(this)}}},updateNodeModel:function(t,B){if(this.items){var w=undefined;var v=this.items.getChildren().length;for(var z=0;z<v;z++){w=this.items.getChildren()[z];if(w&&this.getNodeModelByID(t)){this.getNodeModelByID(t).updateOptions(B);return true}else{if(w.options.grid.data&&w.options.grid.data.menu){var u=w.options.grid.data.menu;var y=u.length;for(var A=0;A<y;A++){var x=u[A];if(x.id===t){Object.keys(B).forEach(function(C){var D=B[C];x[C]=D;return true})}else{if(x.submenu){this.updateNodeModelSubMenu(x,t,B)}}}}}}}},updateNodeModelSubMenu:function(w,y,v){if(w.submenu){var u=w.submenu;var x=u.length;for(var t=0;t<x;t++){var w=u[t];if(w.id===y){Object.keys(v).forEach(function(z){var A=v[z];w[z]=A;return true})}else{if(w.submenu){this.updateNodeModelSubMenu(w,y,v)}}}}},_computeColumnsWidthInPopup:function(){var x=function(B){var C=B;if(C.hasClassName("wux-tweakers")){return C.dsModel}else{for(var D in C.getChildren()){var A=x(C.getChildren()[D]);if(A){return A}}}return undefined};var u=this._toolbar._getNearestHiddenElement();var z=0;var y=0;while(u){if(this._toolbar._isSeparator(u)||!u._treeNodeModel){u=u.nextSibling}else{var t=u._treeNodeModel.options.label;if(t){var v=window.getComputedStyle(u,null);z=Math.max(z,q.computeStringWidth(t,parseFloat(v.getPropertyValue("font-size")),v.getPropertyValue("font-family"),false))}var w=x(u);if(w){y=Math.max(y,w.computeContentSize())}u=u.nextSibling}}return{firstColumnWidth:z,secondColumnWidth:y}},getNodeModelByID:function(w){if(this.items){var v=undefined;var t=this.items.getRoots();for(var u=0;u<t.length;u++){v=t[u];if(v._ID===w){return v}}}}});return r});define("DS/Tree/MultiViews",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/ThumbnailGridView","DS/Tree/TileGridView"],function(d,c,g,f,l,b,j,e,h,i){var a={useRequestAnimationFrameRendering:true,debounceCellInternalUpdateTimer:0,debounceCellRequest:false};var k=g.inherit({name:"multiviews",publishedProperties:{views:{defaultValue:{listview:{id:"listview",icon:"list",buildView:function(m){var n=new e({apiVersion:2,infiniteScrolling:true,columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{dataIndex:"color2",width:40,getValue:function(o){return o.nodeModel.options.color},onCellRequest:function(p){if(!p.isHeader){var o=p.cellView.reuseCellContent("color2");if(o){o.setStyles({backgroundColor:p.nodeModel.options.color})}}}},{dataIndex:"ctx",width:40,onCellRequest:function(o){if(!o.isHeader){o.cellView.reuseCellContent("ctx")}}},{dataIndex:"tree",width:"auto"},{dataIndex:"subtitle",width:"auto",getValue:function(o){return o.nodeModel.options.subLabel}}],height:"auto",selection:{toggle:false},useAsyncPreExpand:true,performances:a});n.getManager().registerReusableCellContent({id:"color2",buildContent:function(){return new d.Element("div",{styles:{"border-radius":10,display:"inline-block",border:"1px solid #9d9d9d","vertical-align":"middle",position:"absolute",top:5,left:10,width:20,height:20}})}});n.getManager().registerReusableCellContent({id:"ctx",buildContent:function(){return new d.Element("div",{"class":"wux-ui-fa wux-ui-fa-chevron-down"})}});return n},loadModel:function(m){this.getManager().loadDocument(m.treeDocument)},onBeingActive:function(){this.giveFocus()}},tileview:{id:"tileview",icon:"th-list",buildView:function(m){return new i({height:"auto",})},loadModel:function(m){this.loadGridViewModel(m.treeDocument)}},thumbnailview:{id:"thumbnailview",icon:"th-large",buildView:function(m){return new h({height:"auto",performances:a})},loadModel:function(m){this.loadGridViewModel(m.treeDocument)}}},type:"object",category:"Appearance"},activeView:{defaultValue:"listview",type:"string",category:"Appearance"},treeDocument:{defaultValue:null,type:"object",category:"Model"}},_preBuildView:function(){this.elements.container=new d.Element("div",{"class":"wux-layouts-multiviews",tabindex:0});this.elements.containerRel=new d.Element("div",{"class":"wux-layouts-multiviews-rel",tabindex:0}).inject(this.elements.container);this.elements.toolbar=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar"}).inject(this.elements.containerRel);this.elements.content=new d.Element("div",{"class":"wux-layouts-multiviews-content"}).inject(this.elements.containerRel);this.elements.toolbarSelection=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-selection"}).inject(this.elements.toolbar);this.elements.toolbarNumberOfElements=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-numberElements"}).inject(this.elements.toolbar);this.elements.toolbarViews=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-views"}).inject(this.elements.toolbar);this.elements.buttonGroup=new b();this.elements.buttonGroup.inject(this.elements.toolbarViews);this._parent()},_applyActiveView:function(){var n=this;for(var o in this.views){var m=this.views[o];console.warn(n.activeView,m.id,n.activeView===m.id);if(n.activeView===m.id){n.elements.content.setContent(m.view);m.loadModel.call(m.view,{treeDocument:n.treeDocument});this.elements.buttonGroup.value=n.activeView}}},_applyViews:function(){console.info("apply views");this._parent();this.elements.toolbarViews.empty();this.elements.content.empty();this.elements.buttonGroup=new b({minWidth:110});this.elements.buttonGroup.inject(this.elements.toolbarViews);var n=this;for(var o in this.views){var m=this.views[o];n.elements.buttonGroup.addChild(new j({type:"radio",iconSize:"2x",minWidth:110,emphasize:"info",displayStyle:"lite",icon:m.icon,value:m.id}));if(m.buildView){if(m.view===undefined){m.view=m.buildView.call(n,{treeDocument:n.treeDocument})}}}this.elements.buttonGroup.addEventListener("change",function(p){n.activeView=p.dsModel.value[0];if(n.views[p.dsModel.value].onBeingActive){n.views[p.dsModel.value].onBeingActive.call(n.views[p.dsModel.value].view)}})},getView:function(m){return this.views[m].view},_applyTreeDocument:function(){if(this.treeDocument){var p=this;for(var q in this.views){var n=this.views[q];if(n.loadModel){n.loadModel.call(n.view,{treeDocument:p.treeDocument})}}var o=p.treeDocument.getAllDescendants().length;var m=p.treeDocument.getXSO();m.onChange(function(){var r=p.treeDocument.getAllDescendants().length;p.elements.toolbarNumberOfElements.setText(r.toString());p.elements.toolbarSelection.setText(m.get().length.toString())});p.elements.toolbarNumberOfElements.setText(o.toString());this.elements.toolbarSelection.setText(m.get().length.toString())}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}},_applyProperties:function(m){this._parent(m);this._applyViews();this._applyTreeDocument();this._applyActiveView()}});return k});define("DS/Tree/ListView",["DS/Core/Core","DS/Tree/TreeListView"],function(c,b){var a=b.extend({defaultOptions:b.SETTINGS.extend("STANDARD",{show:{columnHeaders:false,rowHeaders:false}}),init:function(d){this._parent(d);this.getContent().addClassName("wux-tree-listview")}});a.SETTINGS={extend:b.SETTINGS.extend};Object.defineProperty(a.SETTINGS,"STANDARD",{get:function(){return UWA.extend(b.SETTINGS.STANDARD,{show:{columnHeaders:false,rowHeaders:false}})}});Object.defineProperty(a.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return UWA.extend(b.SETTINGS.STANDARD_CHECKBOXES,{show:{columnHeaders:false,rowHeaders:false}})}});return a});define("DS/Tree/PropertyListView",["DS/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(d,c,g){var f=g.extend({init:function(j){this._parent(j)},updateInternalParameters:function(){this._parent();var k=this.getCellInfos();if(k){var l=k.nodeModel;var j=l.getNextNode();(l.options.grid.type==="category")?this.getContent().addClassName("wux-controls-propertylistview-category"):this.getContent().removeClassName("wux-controls-propertylistview-category");(l.options.grid.value)?this.getContent().removeClassName("wux-controls-propertylistview-category-off"):this.getContent().addClassName("wux-controls-propertylistview-category-off");((l.options.grid.type==="category"&&!l.isExpanded())||(l.options.grid.type==="category"&&l.isExpanded()&&l.getVisibleChildren().length===0)||(l.options.grid.type!=="category"&&j&&j.options.grid.type==="category"))?this.getContent().addClassName("wux-controls-propertylistview-expander"):this.getContent().removeClassName("wux-controls-propertylistview-expander")}}});var a=undefined;var i=d.inherit({name:"propertyListView",publishedProperties:{treeDocument:{defaultValue:undefined,type:"DS/TreeModel/TreeDocument",category:"Behavior"},typeFactory:{defaultValue:undefined,type:"DS/Tweakers/TypeRepresentationFactory",category:"Behavior"}},_applyTreeDocument:function(){if(this.elements.editor){var j=this.elements.editor.getManager();if(j){j.loadDocument(this.treeDocument)}}},_applyTypeFactory:function(){a=this.typeFactory},handleEvents:function(){var k=this;if(k.elements.editor){var j=k.elements.editor.getManager();if(j){j.addEventListener("click",function(n,o){if(o&&o.dataIndex==="tree"){var m=o.nodeModel;if(m&&m.options&&m.options.grid&&m.options.grid.type==="category"){(m.isExpanded())?m.collapse():m.expand()}}});var l=j.getDocument();if(l){l.options.shouldAcceptDrag=function(m){return false};l.expandAll();l.onNodeModelUpdate(function(m){if(m&&m.target){var n=m.target;if(n.options.grid.type==="category"){l.prepareUpdate();(n.options.grid.value)?n.showChildNodes():n.hideChildNodes();l.pushUpdate()}}})}}}},buildView:function(){this.elements.container.addClassName("wux-controls-propertylistview");this.elements.editor=new c(b);this.elements.editor.inject(this.elements.container)},_applyProperties:function(j){this._parent(j);if(this.isDirty("treeDocument")){this._applyTreeDocument()}this._applyTypeFactory()}});function h(j){if(j.event&&j.event.dsModel){return j.event.dsModel.value}}function e(k){var j=k.nodeModel.options;j.grid.value=k.value;k.manager.updateRowViewWithException(k.nodeModel,k.dataIndex)}var b={apiVersion:2,defaultCellHeight:38,height:"auto",cellClass:f,show:{rowHeaders:false,columnHeaders:false},expanderStyle:"triangle",performances:{buildLinks:false},resize:{columns:true},selection:false,columns:[{dataIndex:"tree",text:"Label",isDraggable:false,isHidden:false,width:160,},{dataIndex:"value",text:"Value",isEditable:true,width:90,onCellRequest:function(n){if(a){var j=n.cellView;if(n.nodeModel&&n.nodeModel.options){var m=n.nodeModel.options.grid;var l=m.value;var k=m.type;if(k!==null){a.generateView(l,{typePath:k,context:"inlinedTemplate",onViewCreated:function(o){if(o!==undefined){j.getContent().setContent(o);if(m.available===false){o.disabled=true;if(o.elements.internalView){o.elements.internalView.disabled=true}}}}})}}}},onCellChange:h,setValue:e},{dataIndex:"value2",text:"Detailed Value",isEditable:true,width:"auto",onCellRequest:function(n){if(a){var j=n.cellView;if(n.nodeModel&&n.nodeModel.options){var m=n.nodeModel.options.grid;var l=m.value;var k=(m.detailedType!==undefined)?m.detailedType:m.type;if(k==="category"){k="gfx_category"}if(k){a.generateView(l,{typePath:k,context:"detailedTemplate",onViewCreated:function(o){if(o!==undefined){j.getContent().setContent(o);if(m.available===false){o.disabled=true;if(o.elements.internalView){o.elements.internalView.disabled=true}}}}})}}}},onCellChange:h,setValue:e}]};return i});define("DS/Notifications/NotificationsManagerViewOnTreeListView",["DS/WebappsUtils/WebappsUtils","UWA/Core","UWA/Class","DS/Tree/TreeListView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],function(c,e,b,g,a,f){function j(){var k={defaultCellHeight:30,apiVersion:2,columns:[{dataIndex:"tree",text:"Tree",isHidden:true},{text:"Id",dataIndex:"count",width:75,onCellRequest:function(n){var l=n.cellView;if(n.nodeModel&&n.nodeModel.options){var m=n.nodeModel.options.grid;l.getContent().setContent(String(m.count))}}},{text:"Level",dataIndex:"level",width:100},{text:"Title",dataIndex:"title",width:"auto"},{text:"Subtitle",dataIndex:"subtitle",width:"auto"},{text:"Message",dataIndex:"message",width:"auto"},{text:"Number",dataIndex:"number",width:"auto"}],roots:[],height:300,isSortable:false};k.resize={columns:true,rows:false};this._treeListView=new g(k)}function i(){this._manager.getHistory().prepareUpdate();var l=this;var k=this._manager.getHistory().search({match:function(n){var m=n.nodeModel._getRowID();if(n.nodeModel.options.grid.category.toLowerCase()===l._filter.toLowerCase()){l._treeListView.getManager().showRow(m)}else{l._treeListView.getManager().hideRow(m)}}});this._manager.getHistory().pushUpdate()}var d=b.singleton({defaultOptions:{},init:function(k){this._parent(k);j.call(this);this._manager=null;this._stackingPolicy=0;this._notificationsStacks={};this._filter="";this._tokenNotificationAdded=undefined},setNotificationManager:function(k){if(this._manager===k){return}if(this._tokenNotificationAdded){this._manager.unsuscribeToNotificationAdded(this._tokenNotificationAdded)}this._manager=k;if(this._manager){var l=this._buildDisplayedTreedocument(this._manager.getHistory());var m=this;this._tokenNotificationAdded=this._manager.suscribeToNotificationAdded(function(p){var q=m._manager.getHistory();var n=q.getAllDescendants()[q.getAllDescendants().length-1];m._onAddNotification(n);var o=m._lastManagedNode;if(m._treeListView.getManager().getScroller()){m._treeListView.getManager().scrollToNode(o,"bottom")}o.select(true);m._treeListView.getManager().updateView()})}else{this._treeListView.getManager().loadDocument()}},setFilterDisplayedNotification:function(k){if(this._filter===k){return}this._filter=k||"";if(this._manager){i.call(this)}},getFilterDisplayedNotification:function(){return this._filter},inject:function(k){this._treeListView.inject(k)},remove:function(k){this._treeListView.remove(k)},setStackingPolicy:function(k){if(this._stackingPolicy==k){return}if(k!=0&&(k%2!=1||k>31)){console.log("NotificationsManagerOnScreen stackingPolicy wrong input value");return}this._stackingPolicy=k},getStackingPolicy:function(){return this._stackingPolicy},_buildDisplayedTreedocument:function(m){var k=undefined;var n=this;if(m){k=new a;n._treeListView.getManager().loadDocument(k);var l=m.getChildren();l.forEach(function(p,o){n._onAddNotification(p)})}return undefined},_onAddNotification:function(m){var k=undefined;if(this._stackingPolicy===0){k=new f({label:m.options.label,grid:m.options.grid});k.options.grid.number=1;this._treeListView.getManager().getDocument().addRoot(k)}else{var l=this._getNotificationsStackIdentifier(m.options.grid);if(l&&this._notificationsStacks[l]&&(this._stackingPolicy<16||h.call(this,this._lastManagedNode.options.grid,m.options.grid))){k=this._notificationsStacks[l];k.updateOptions({grid:{number:k.options.grid.number+1}})}else{k=new f({label:m.options.label,grid:m.options.grid});k.options.grid.number=1;this._notificationsStacks[l]=k;this._treeListView.getManager().getDocument().addRoot(k)}}this._lastManagedNode=k},_getNotificationsStackIdentifier:function(l){var k="";if(this._stackingPolicy&1){k+=l.level}if(this._stackingPolicy&2){k+=l.category}if(this._stackingPolicy&4){k+=l.title}if(this._stackingPolicy&8){k+=l.subtitle}return k}});function h(l,k){if(this._stackingPolicy&1){if(l.level!==k.level){return false}}if(this._stackingPolicy&2){if(l.category!==k.category){return false}}if(this._stackingPolicy&4){if(l.title!==k.title){return false}}if(this._stackingPolicy&8){if(l.subtitle!==k.subtitle){return false}}return true}return d});define("DS/Tree/Tree",["UWA/Core","UWA/Class","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(e,b,c,a){var d=c.extend({defaultOptions:{cellClass:a,defaultCellHeight:28,numberOfColumns:1,headersDimensions:{width:undefined,height:undefined},show:{rowHeaders:false,columnHeaders:false}},init:function(f){this._parent(f);this.elements.container.addClassName("wux-controls-treebase")}});d.SETTINGS=c.SETTINGS;return d});define("DS/Tree/FileTreeView",["DS/Tree/Tree","DS/Tree/Manager"],function(c,b){var d=b.extend({defaultOptions:{defaultCellMouseWidth:null,defaultCellMouseHeight:26,defaultCellTouchWidth:null,defaultCellTouchHeight:38,defaultCellHeight:26},init:function(e,f){this._parent(e,f)},getRowHeight:function(f){var e=0;if(f===-1){return this.options.defaultCellHeight}else{if(this.getTreeNodeModelFromRowID(f).isRoot()){e=this.options.defaultCellHeight+10}else{e=this.options.defaultCellHeight}}return e}});var a=c.extend({defaultOptions:{apiVersion:2,defaultCellHeight:26,managerClass:d,expanderStyle:"triangle",performances:{buildLinks:false,useRequestAnimationFrameRendering:false,debounceCellInternalUpdateTimer:1,debounceCellRequest:false}},init:function(e){e.defaultCellHeight=26;if(e.columns===undefined){this._parent(e)}else{if(e.columns.length>1){throw"You should not use multiple columns with this component."}else{if(e.columns[0].dataIndex!=="tree"){throw'You should have a column option with dataIndex "tree" '}else{this._parent(e)}}}this.elements.container.addClassName("wux-tree-filetreeview")}});return a});define("DS/Controls/ComboBoxBase",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Array","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/CommandsRegistry"],function(c,d,p,q,A,n,g,i,l,f,v,t,o,u,s){var h=v.extend({syncModel:function(C,B){r.call(this.getDocument());this._parent(C,B)}});var m=f.extend({updateInternalParameters:function(){this._parent();var D=this.getCellInfos();if(!D.isHeader){if(D.nodeModel._wuxComboBoxPreselected){this.getContent().addClassName("wux-controls-combobox-row-preselected")}else{this.getContent().removeClassName("wux-controls-combobox-row-preselected")}var B=D.nodeModel.options.comboBoxSemantics||"leaf";var C=document.createAttribute("semantics");C.value=B;this.getContent().setAttributeNode(C)}}});function r(){var B=0;this._getTrueRoot().processDescendants({onlyVisibleNodes:false,processNode:function(C){C.nodeModel._unfilteredRowID=B;B++}})}function y(){var D=this;t.addEventOnElement(this,this.elements.container,"mousewheel",function(F){if(D.disabled){return}if(D.multiSelFlag&&!D._isPopupOpened()){return}if(document.activeElement===D._getMainElement()||D.getContent().hasAttribute("focused")){F.preventDefault();F.stopPropagation();var G=c.Event.wheelDelta(F);if(G<0){for(var E=0;E>G;E--){D.callMethodFromUIInteraction("incrementIndex")}}else{for(var E=0;E<G;E++){D.callMethodFromUIInteraction("decrementIndex")}}}});var C=document;if(D.getContent()&&D.getContent().ownerDocument){C=D.getContent().ownerDocument}var B=function(H){if(D._isPopupOpened()){var F=t.firstParentWithClass(H.target,"wux-controls-combobox-popup");if(!F){var G=t.firstParentWithClass(H.target,"wux-controls-combobox");var E=G?G.dsModel===D:false;if(!E){t._pushUserInteractionContext();D.callMethodFromUIInteraction("_hidePopup",!D._validateOnBlurForTMCAndFilterApp&&!D.multiSelFlag);t._popUserInteractionContext()}}}};t.addEventOnElement(this,C.body,"mousedown",B,true);t.addEventOnElement(this,C.body,"touchstart",B,true)}function b(){if(this._model){if(this.multiSelFlag&&!this._firstLoadModel){this.selectedIndexes=[]}var D=true;if(this._addChildCB){this._model.unsubscribe(this._addChildCB);this._addChildCB=undefined}if(this._removeChildCB){this._model.unsubscribe(this._removeChildCB);this._removeChildCB=undefined;D=false}if(D){if(this.elements.treeListView&&this.elements.treeListView.getManager().getDocument()){this.elements.treeListView.getManager().unloadDocument();this.elements.treeListView.getManager()._treeDocument=null}if(this._model){this._model.destroy();delete this._model}}this._model=undefined}this._allDescendants=undefined;var G=this;if(this.elementsList.length){this._model=new i({shouldBeEditable:function(){return G.multiSelFlag}});this._model.prepareUpdate();var H=typeof(this.elementsList[0])==="string";for(var E=0;E<this.elementsList.length;E++){var C;if(H){C={label:this.elementsList[E]}}else{C={label:this.elementsList[E].labelItem,grid:{valueItem:this.elementsList[E].valueItem}}}if(this.elementsList[E].labelItem&&this.elementsList[E].labelItem!==""){this._model.options._hasAtLeastOneLabel=true}if(this.elementsList[E].iconItem){this._model.options._hasAtLeastOneIcon=true;if(typeof(this.elementsList[E].iconItem)==="string"){if(this.elementsList[E].iconItem.indexOf(".")===-1){this.elementsList[E].iconItem={iconName:this.elementsList[E].iconItem}}}C.icons=[this.elementsList[E].iconItem]}this._model.addRoot(new l(C))}this._model.pushUpdate()}else{if(this.elementsTree){this._model=this.elementsTree;var B=function(){G._allDescendants=undefined;r.call(G._model);G._updateNbDisplayedElements();G._updatePopupHeight()};this._addChildCB=this._model.addModelEventListener("addChild",B);this._removeChildCB=this._model.addModelEventListener("removeChild",B)}else{this._model=new i({shouldBeEditable:function(){return G.multiSelFlag}})}}this._firstLoadModel=false;if(this._model){r.call(this._model);if(this._treeListViewReady){this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-iconandtext");this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-icononly");if(this._model.options._hasAtLeastOneIcon){if(this._model.options._hasAtLeastOneLabel){this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext")}else{this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")}}}this._model.getXSO().onAdd(function(I){if(G._preventXSOCB){return}if(G.multiSelFlag){o.pushUnique(G.selectedIndexes,I._unfilteredRowID);G._applySelectedIndexes()}else{if(!G._isPopupOpened()){G.selectedIndex=I._unfilteredRowID}else{G._properties.preselectedIndex.value=I._unfilteredRowID;G._applyPreselectedIndex()}}});var F=false;this._model.getXSO().onRemove(function(I){if(G._preventXSOCB){return}if(G.multiSelFlag){if(G._model.getXSO().get().length){G.selectedIndexes.splice(G.selectedIndexes.indexOf(I._getRowID(1)),1)}else{o.clear(G.selectedIndexes)}if(!F){G._removeIndex=true;G._applySelectedIndexes();G._removeIndex=false}}});this._model.getXSO().onPreEmpty(function(){F=true});this._model.getXSO().onEmpty(function(){F=false})}this._modelHasChanged=true;this._updateNbDisplayedElements();this._updatePopupHeight();if(this._modelLoaded){this._modelLoaded()}}function j(E,C){if(E===undefined){C.value=-1;return 1}if(E===-1&&this.reachablePlaceholderFlag){return 0}if(E<-1&&this.reachablePlaceholderFlag){C.value=-1;return 1}var D=this._getAllDescendants();if(D.length===0){if(E!==-1){C.value=-1;return 1}return 0}if(E<=-0.5&&!this.reachablePlaceholderFlag){C.value=0;return 1}if(E>=D.length){C.value=D.length-1;return 1}if((C.value=Math.round(E))!==E){return 1}if(!this.isIndexValid(E)){if(this._direction===0){return 2}else{if(this._direction===1){var B=a.call(this,E);if(B===-1){return 2}C.value=B;return 1}else{var B=z.call(this,E);if(B===this._getAllDescendants().length){return 2}C.value=B;return 1}}}return 0}function x(C){var B=C;do{B=a.call(this,B);if(B===-1){return B}}while(!this.isIndexValid(B));return B}function a(E){var C=-1;if(E!==undefined){if(E<this._getAllDescendants().length-1){C=E+1}return C}if(this._isPopupOpened()){var D=this._model.getXSO().get();if(D.length>0){var B=D[D.length-1]._unfilteredRowID;if(B<this._getAllDescendants().length-1){C=B+1}}else{C=0}}else{if(this.multiSelFlag){if(this.selectedIndexes[this.selectedIndexes.length-1]<this._getAllDescendants().length-1){C=this.selectedIndexes[this.selectedIndexes.length-1]+1}}else{if(this.selectedIndex<this._getAllDescendants().length-1){C=this.selectedIndex+1}}}return C}function w(C){var B=C;do{B=z.call(this,B);if(B===this._getAllDescendants().length){return B}}while(!this.isIndexValid(B));return B}function z(E){var C=this._getAllDescendants().length;if(E!==undefined){if(E>(this.reachablePlaceholderFlag&&!this._isPopupOpened()?-1:0)){C=E-1}return C}if(this._isPopupOpened()){var D=this._model.getXSO().get()[0];if(D){var B=D._unfilteredRowID;if(B>0){C=B-1}}}else{if(this.selectedIndex>(this.reachablePlaceholderFlag?-1:0)){C=this.selectedIndex-1}}return C}function e(B,G){var D=this.elements.treeListView.getManager();if(!B){D.setScrollerPosition({x:0,y:0})}else{var J=this.elements.treeListView.getManager().options.defaultCellHeight;var E=B._getRowID(1)*J;if(G){var C=Math.max(0,E-J*Math.floor(this.nbDisplayedElements/2));D.setScrollerPosition({x:0,y:C})}else{var F=this.nbDisplayedElements*J;var K=this.elements.treeListView.getManager().getScrollerPosition();var I=K.y;var H=I+F-J;if(E>H){D.setScrollerPosition({x:0,y:E-F+J})}else{if(E<I){D.setScrollerPosition({x:0,y:E})}}}}}var k=q.inherit({name:"comboBoxBase",publishedProperties:{nbDisplayedElements:{defaultValue:-1,type:"integer",readOnly:true,category:"Appearance"},selectedIndex:{defaultValue:-1,type:"integer",category:"Appearance",recordFlag:true},preselectedIndex:{defaultValue:-1,type:"integer",readOnly:true,category:"Appearance"},selectedIndexes:{defaultValue:[],type:"array",category:"Appearance",recordFlag:true},value:{defaultValue:undefined,type:"object",category:"Appearance",recordFlag:true},currentValue:{defaultValue:undefined,type:"object",category:"Appearance",uiDisplay:false},label:{defaultValue:"",type:"string",readOnly:true,category:"Appearance"},currentLabel:{defaultValue:"",type:"string",readOnly:true,category:"Appearance"},elementsList:{defaultValue:[],type:"array",category:"Model"},elementsTree:{defaultValue:undefined,type:"array",category:"Model"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},reachablePlaceholderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},_validateOnBlurForTMCAndFilterApp:{defaultValue:false,type:"boolean",category:"Behavior",readOnly:true,noNeedToApplyFlag:true}},buildView:function(){this.elements.container.addClassName("wux-controls-combobox");this._model=null;this._firstLoadModel=true;this._lastValidatedPreselectedIndex=undefined;this._lastValidatedSelectedIndex=undefined;this._treeListViewReady=false;this._direction=0;this._preventXSOCB=false;this._removeIndex=false;this._lastValidatedSelectedIndexes=[]},handleEvents:function(){y.call(this)},destroy:function(){this._hidePopup(true);if(this._addChildCB){this._model.unsubscribe(this._addChildCB);this._addChildCB=undefined}if(this._removeChildCB){this._model.unsubscribe(this._removeChildCB);this._removeChildCB=undefined}this._allDescendants=null;this._parent();if(this.elementsList){this._model.destroy()}},isIndexValid:function(B){if(B<-1||B>=this._getAllDescendants().length){return false}if(B===-1){return this.reachablePlaceholderFlag}var C=this._getAllDescendants()[B];if(!C){return false}return this._model.options.shouldBeSelected(C)},incrementIndex:function(){this._direction=1;var C=this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode();if(C){this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-next-visible-node-no-empty-xso",this.elements.treeListView.getManager());B=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID;if(this.multiSelFlag){this._properties.preselectedIndex.value=B;this._applyPreselectedIndex()}else{}}else{var B=x.call(this);if(B>=0){if(this._isPopupOpened()){this._selectInList(B)}else{this.selectedIndex=B}}}this._direction=0},decrementIndex:function(){this._direction=2;var B=this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode();if(B){var D=this.preselectedIndex;this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-previous-visible-node-no-empty-xso",this.elements.treeListView.getManager());C=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID;if(this.multiSelFlag){this._properties.preselectedIndex.value=C;this._applyPreselectedIndex()}else{if(!this._isPopupOpened()&&D===C&&this.reachablePlaceholderFlag){this.selectedIndex=-1}}}else{var C=w.call(this);if(C!==this._getAllDescendants().length){if(this._isPopupOpened()){this._selectInList(C)}else{this.selectedIndex=C}}}this._direction=0},getPopupWidth:function(){var B=this.elements.container.getBoundingClientRect().width;if(this.multiSelFlag){var C=this.elements.treeListView._treeWidth;return C>B?C:B}return B},_selectInList:function(D){this._preventXSOCB=true;var C=this.multiSelFlag?D:[D];var B;if(this.multiSelFlag&&this._removeIndex&&this._treeListViewReady){B=this.elements.treeListView.getManager().getActiveNode()}this._model.prepareUpdate();this._model.getXSO().empty();for(var E=0;E<C.length;E++){if(C[E]>=0&&C[E]<this._getAllDescendants().length){this._getAllDescendants()[C[E]].select()}}if(!this.multiSelFlag||!this._removeIndex){this._properties.preselectedIndex.value=C[C.length-1];this._applyPreselectedIndex(1);B=this._getAllDescendants()[this.preselectedIndex]}if(this._treeListViewReady){this.elements.treeListView.getManager().setActiveNode(B)}this._model.pushUpdate();this._preventXSOCB=false},_addCommonEvents:function(){var B=this;if(this.elements.expander){t.addEventOnElement(this,this.elements.expander,d.POINTERUP,function(C){C.preventDefault();if(B.disabled){return}if(B._isPopupOpened()){B.callMethodFromUIInteraction("_hidePopup",!B.multiSelFlag&&!B._validateOnBlurForTMCAndFilterApp)}else{B.callMethodFromUIInteraction("_showPopup")}});t.addEventOnElement(this,this.elements.expander,"click",function(C){C.stopPropagation()})}if(!this._getMainElement){return}this._getMainElement().addEventListener(d.POINTERDOWN,function(C){});this._getMainElement().addEventListener(d.POINTERUP,function(C){C.preventDefault()});t.addEventOnElement(this,this._getMainElement(),"keydown",function(E){var D=false;switch(E.keyCode){case p.ARROWUP:if(B.multiSelFlag&&B._isPopupOpened()||!B.multiSelFlag&&!E.shiftKey&&!E.ctrlKey){D=true;B.callMethodFromUIInteraction("decrementIndex")}E.stopPropagation();break;case p.ARROWDOWN:if(B.multiSelFlag&&B._isPopupOpened()||!B.multiSelFlag&&!E.shiftKey&&!E.ctrlKey){D=true;B.callMethodFromUIInteraction("incrementIndex")}E.stopPropagation();break;case p.ESCAPE:if(B._isPopupOpened()){var C=B.preselectedIndex;var F=B._isPopupOpened();B.callMethodFromUIInteraction("_hidePopup",1);if(C!==B.preselectedIndex){E.actionPerformed=true;B._actionPerformedOnKeyDown=true}if(F){E.stopPropagation();B._stopPropagation=true}}break;case (B.multiSelFlag&&p.TAB):if(B._isPopupOpened()){B.callMethodFromUIInteraction("_hidePopup",!B.multiSelFlag)}E.stopPropagation();break;case (E.ctrlKey&&p.SPACE):if(B.multiSelFlag&&B._isPopupOpened()&&B._treeListViewReady){this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:toggle-selection",this.elements.treeListView.getManager())}E.stopPropagation();break}if(D){E.preventDefault()}})},_updatePopupHeight:function(){if(this.elements.treeListViewContainer){var D=this.nbDisplayedElements;var B=this._getCurrentTouchMode()?38:22;var E=(B*D)+"px";if(this.elements.treeListViewContainer.style.height!==E){var C=this._isPopupOpened();this.elements.popup.visibleFlag=false;this.elements.treeListViewContainer.style.height=E;this.elements.popup.visibleFlag=C;if(this.elements.treeListView){this.elements.treeListView.updateHeight(E)}}}},_managePopupOverlaping:function(B){var C=this._properties.nbDisplayedElements.value;this._updateNbDisplayedElements(B);if(C!==this._properties.nbDisplayedElements.value){this._updatePopupHeight()}},_updateNbDisplayedElements:function(B){var C=this._getAllDescendants().length;if(!B){this._properties.nbDisplayedElements.value=(C<10?C:10)}else{this._reduceNbDisplayedToAvoidOverlaping(B,C<10?C:10)}},_reduceNbDisplayedToAvoidOverlaping:function(C,D){var B=this._getCurrentTouchMode()?38:22;if(D>3){D--;if(D*B>C.bottom&&D*B>C.top){this._reduceNbDisplayedToAvoidOverlaping(C,D)}else{this._properties.nbDisplayedElements.value=D}}else{this._properties.nbDisplayedElements.value=D}},_hidePopup:function(B){if(!this._isPopupOpened()){return}if(B){if(this.multiSelFlag){this.selectedIndexes=this._lastValidatedSelectedIndexes.slice()}else{}}else{if(this.multiSelFlag){this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()}else{this.selectedIndex=this._model.getXSO().get().length?this._model.getXSO().get()[0]._unfilteredRowID:-1}}if(this.multiSelFlag){this._properties.preselectedIndex.value=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1;this._applyPreselectedIndex()}else{this._properties.preselectedIndex.value=this.selectedIndex;this._applyPreselectedIndex()}this.elements.popup.visibleFlag=false;this.fire("hide",{cancelPopupSelection:B});if(this._popupHidden){this._popupHidden(B)}if(B){if(!this.multiSelFlag){this._model.getXSO().empty();if(this.selectedIndex>-1){this._model.getXSO().add(this._getAllDescendants()[this.selectedIndex])}}}},_buildPopup:function(){if(!this.elements.popup){var G=this;var F={target:this,position:"bottom",offset:{x:0,y:4},alignment:this.multiSelFlag?"near":"center",className:"wux-controls-combobox-popup wux-controls-popup",constraint:"screen",overlap:false,trigger:"",overlapCallback:function(J){G._managePopupOverlaping(J)}};this.elements.popup=new A(F);if(this.recId){this.elements.popup.recId=this.recId+"-popup"}this.elements.treeListViewContainer=new c.Element("div");this.elements.popup.setBody(this.elements.treeListViewContainer);this._updatePopupHeight();var G=this;var C=this.nbDisplayedElements;var B=this._getCurrentTouchMode()?38:22;var I=(B*C)+"px";var E={managerClass:h,manageHeight:true,expanderStyle:"none",columns:[{dataIndex:"selection",type:"selection",isHidden:true},{text:"tree",dataIndex:"tree",isHidden:false,isEditable:false,width:"auto"},{text:"valueItem",dataIndex:"valueItem",isHidden:true,isEditable:false,isDraggable:false,width:0}],defaultCellHeight:B,defaultCellWidth:50,height:I,isEditable:true,resize:{columns:true,rows:false},show:{rowHeaders:false,columnHeaders:false},selection:{rowHeaders:false,columnHeaders:false,unselectAllOnEmptyArea:false,preSelection:true,toggle:false,canMultiSelect:G.multiSelFlag,enableListSelection:G.multiSelFlag},treeDocument:this._model,performances:{useRequestAnimationFrameRendering:true},shouldAcceptDrag:function(){return false},apiVersion:2,cellClass:m,enableActiveUI:true,enableKeyboardNavigation:true,allowUnsafeHTMLContent:false};this.elements.treeListView=new g(E);this.elements.treeListView.getManager().__isComboBox__=true;this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview");if(this._model.options._hasAtLeastOneIcon){if(this._model.options._hasAtLeastOneLabel){this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext")}else{this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")}}this._applyMultiSelFlag();var G=this;var D={x:-1,y:-1};var H=true;t.addEventOnElement(this,this.elements.popup.getContent(),"mousemove",function(N){var K=N.clientX,J=N.clientY;if(K===D.x&&J===D.y&&H){return}var L=t.firstParentWithClass(N.target,"wux-datagrid-cell");if(L&&L.dsView&&L.dsView._cellInfos&&L.dsView._cellInfos.cellModel&&L.dsView._cellInfos.cellModel.options){var M=L.dsView._cellInfos.nodeModel._unfilteredRowID;G.setReadOnlyPropertyFromUIInteraction("preselectedIndex",{value:parseInt(M)})}D.x=K;D.y=J;H=true},true);this.elements.popup.getContent().addEvent("mousewheel",function(){H=false});this.elements.treeListView.onNodeClick(function(J){if(G._getMainElement&&!d.isLastEventTouch()){G._getMainElement().focus()}if(G.isIndexValid(J.nodeModel._unfilteredRowID)){if(!G.multiSelFlag){G._hidePopup()}}});this.elements.treeListView.getManager().onReady(function(){G._treeListViewReady=true;if(G.selectedIndex!==-1){var J=G._getAllDescendants();if(J.length>G.nbDisplayedElements){var K=G.selectedIndex;if(G.multiSelFlag&&G.selectedIndexes.length>0){K=G.selectedIndexes[G.selectedIndexes.length-1]}e.call(G,J[K],true)}}G.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-colors")});if(this.multiSelFlag){t.addEventOnElement(this,window,"blur",function(J){if(G._isPopupOpened()){G._hidePopup(!G.multiSelFlag)}})}}else{this._updateNbDisplayedElements();this._updatePopupHeight()}},_getAllDescendants:function(){if(!this._allDescendants){this._allDescendants=this._model.getAllDescendants()}return this._allDescendants},_showPopup:function(){if(this._isPopupOpened()){return}this.fire("preDropdown");this._buildPopup();var C=this.getPopupWidth();this.elements.treeListViewContainer.style.width=C+"px";var B=this;this.elements.treeListView.getManager().onPostUpdateViewOnce(function(){if(!B._getAllDescendants()){return}var D;if(B.multiSelFlag&&B.selectedIndexes.length>0||!B.multiSelFlag&&B.selectedIndex!==-1){D=B._getAllDescendants()[B.preselectedIndex]}if(B.multiSelFlag&&!D&&B._getAllDescendants().length){this.setActiveNode(B._getAllDescendants()[0])}else{this.setActiveNode(D)}if(D){if(B._getAllDescendants().length>B.nbDisplayedElements){e.call(B,D,true)}}});this.elements.popup.visibleFlag=true;if(this._modelHasChanged){this.elements.treeListView.inject(this.elements.treeListViewContainer);this.elements.treeListView.getManager().loadDocument(this._model);this._modelHasChanged=false}if(this._getMainElement){this._getMainElement().focus()}if(this.multiSelFlag){this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()}if(this._popupDisplayed){this._popupDisplayed()}this.fire("show")},_isPopupOpened:function(){return this.elements.popup&&this.elements.popup.visibleFlag},_updateCurrentProperties:function(){if((!this.multiSelFlag&&this.selectedIndex===-1)||(this.multiSelFlag&&this.selectedIndexes.length===0)){this._properties.value.value=this.multiSelFlag?[]:undefined;this._properties.currentValue.value=this.multiSelFlag?[]:undefined;this._properties.label.value="";this._properties.currentLabel.value=""}else{var B=[];var F="";var D=this.multiSelFlag?this.selectedIndexes:[this.selectedIndex];for(var C=0;C<D.length;C++){var E=this._getAllDescendants()[D[C]];if(E){if(E.options.grid.valueItem!==undefined){o.pushUnique(B,E.options.grid.valueItem)}else{o.pushUnique(B,E.options.label)}F+=E.options.label;if(C!==D.length-1&&D.length>1){F+=", "}}}this._properties.value.value=this.multiSelFlag?B:B[0];this._properties.currentValue.value=this.multiSelFlag?B:B[0];this._properties.label.value=F;this._properties.currentLabel.value=F}},_applyPreselectedIndex:function(C){var D=this._lastValidatedPreselectedIndex!==this.preselectedIndex;if(!D&&!C){return}var E={value:0};var B=j.call(this,this.preselectedIndex,E);if(B===1){this._properties.preselectedIndex.value=E.value;this._applyPreselectedIndex();return}else{if(B===2){this._properties.preselectedIndex.value=this._lastValidatedPreselectedIndex?this._lastValidatedPreselectedIndex:-1;return}}var F=this._getAllDescendants();if(this._lastValidatedPreselectedIndex!==undefined&&this._lastValidatedPreselectedIndex>=0&&this._lastValidatedPreselectedIndex<F.length){F[this._lastValidatedPreselectedIndex]._wuxComboBoxPreselected=false;if(this._treeListViewReady){this.elements.treeListView.getManager().removeRowClass(F[this._lastValidatedPreselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")}}this._lastValidatedPreselectedIndex=this.preselectedIndex;if(this.preselectedIndex!==-1){F[this.preselectedIndex]._wuxComboBoxPreselected=true;if(this._treeListViewReady){this.elements.treeListView.getManager().addRowClass(F[this.preselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")}}if(this._preselectedIndexModified){this._preselectedIndexModified()}if(this.elements.popup&&this.elements.popup.visibleFlag&&D){this.fire("preselectionChange")}},_applySelectedIndex:function(C){if(this.multiSelFlag){return}var E=true;var D={value:0};var B=j.call(this,this.selectedIndex,D);if(B===1){if(D.value===C){this._properties.selectedIndex.value=C;return}this.selectedIndex=D.value;return}else{if(B===2){this._properties.selectedIndex.value=this._lastValidatedSelectedIndex?this._lastValidatedSelectedIndex:(this.reachablePlaceholderFlag?-1:0);E=false}}if(this._modelChanged){E=E&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&this.selectedIndex!==-1)}else{E=E&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&this.selectedIndex===-1)}this._lastValidatedSelectedIndex=this.selectedIndex;this._selectInList(this.selectedIndex);if(this._selectedIndexModified){this._selectedIndexModified()}this._updateCurrentProperties();if(E){this.fire("change")}},_applySelectedIndexes:function(C,F){if(!this.multiSelFlag){return}var E=true;var G=[];for(var D=0;D<this.selectedIndexes.length;D++){var B=this.selectedIndexes[D];if(this.isIndexValid(B)){o.pushUnique(G,B)}}if(G.length>0){this._properties.selectedIndexes.value=G}else{if(G.length===0&&this.selectedIndexes.length>0){this._properties.selectedIndexes.value=C||[];E=false}}if(this._modelChanged){}else{E=E&&(!C||!c.Array.equals(C,this.selectedIndexes))}this._selectInList(this.selectedIndexes);if(this._selectedIndexModified){this._selectedIndexModified()}this._updateCurrentProperties();if(E){this.fire("change")}},_applyValue:function(B){var H=0;var G=[];var J=undefined;if(this.multiSelFlag){J=(this.value!==undefined)?this.value:[]}else{J=(this.value!==undefined)?[this.value]:[]}var C=this._getAllDescendants();var I=J.length;if(J&&I>0){for(var F=0;F<J.length;){var D=false;for(H=0;H<C.length;H++){var E=C[H];if(E.options.grid.valueItem!==undefined){if(E.options.grid.valueItem===J[F]){o.pushUnique(G,H);D=true;break}}else{if(E.options.label===J[F]){o.pushUnique(G,H);D=true;break}}}if(!D){J.splice(F,1)}else{F++}}}if(!this.multiSelFlag){if(H===C.length){this._properties.value.value=B}else{this.selectedIndex=G.length>0?G[0]:-1}}else{if(G.length>0){this.selectedIndexes=G}else{if(I>0){this._properties.value.value=B}else{this._properties.value.value=[];this.selectedIndexes=[]}}}this._properties.currentValue.value=this.value},_applyCurrentValue:function(B){this.value=this.currentValue},_applyElementsList:function(){this._modelChanged=true;this._forceApplyProperties(["selectedIndex","selectedIndexes"]);this._modelChanged=false},_applyElementsTree:function(){this._modelChanged=true;this._forceApplyProperties(["selectedIndex","selectedIndexes"]);this._modelChanged=false},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.mainElement.disabled=true;this.elements.expander.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.mainElement.disabled=false;this.elements.expander.removeAttribute("disabled")}},_applyMultiSelFlag:function(C){var B=this.elements.treeListView;if(B){B.getManager().options.selection.canMultiSelect=this.multiSelFlag;if(this.multiSelFlag){B.getManager().showColumn(0)}else{B.getManager().hideColumn(0)}B.getManager().options.selection.enableListSelection=this.multiSelFlag}if(this.multiSelFlag){if(this.selectedIndexes.length===0){this.selectedIndexes=(this.selectedIndex===-1)?[]:[this.selectedIndex]}this.selectedIndex=-1;if(this.elements.popup){this.elements.popup.alignment="near"}this.getContent().setAttributeNode(document.createAttribute("multiple"))}else{if(this.selectedIndexes.length>0){this.selectedIndex=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1;this._properties.selectedIndexes.value=[]}if(this.elements.popup){this.elements.popup.alignment="center"}this.getContent().removeAttribute("multiple")}},_applyReachablePlaceholderFlag:function(){if(this.enableSearchFlag){this.reachablePlaceholderFlag=true}if(!this.reachablePlaceholderFlag){if(!this.multiSelFlag&&this.selectedIndex===-1&&this.currentValue===undefined&&this.value===undefined&&this.currentLabel===""&&this.label===""){this.selectedIndex=x.call(this,-1)}}},_applyTouchMode:function(B){this._parent(B);if(!this._treeListViewReady){return}if(this._getCurrentTouchMode()){this.elements.treeListView.options.defaultCellHeight=38;this.elements.treeListView._datagrid.options.defaultCellHeight=38;this.elements.treeListView.getManager().options.defaultCellHeight=38}else{this.elements.treeListView.options.defaultCellHeight=22;this.elements.treeListView._datagrid.options.defaultCellHeight=22;this.elements.treeListView.getManager().options.defaultCellHeight=22}this.elements.treeListView.getManager()._indexRowsPosition({async:false});this._updatePopupHeight()},_applyProperties:function(B){this._parent(B);if(this.isDirty("elementsList")||this.isDirty("elementsTree")){b.call(this)}if(this.isDirty("reachablePlaceholderFlag")){this._applyReachablePlaceholderFlag(B.reachablePlaceholderFlag)}if(this.isDirty("touchMode")){this._applyTouchMode(B.touchMode)}if(this.isDirty("currentValue")&&B&&B.hasOwnProperty("currentValue")){this._applyCurrentValue(B.currentValue)}if(this.isDirty("value")&&B&&B.hasOwnProperty("value")){this._applyValue(B.value)}if(this.isDirty("selectedIndex")||this.isDirty("elementsList")||this.isDirty("elementsTree")){this._applySelectedIndex(B.selectedIndex)}if(this.isDirty("selectedIndexes")||this.isDirty("elementsList")||this.isDirty("elementsTree")){this._applySelectedIndexes(B.selectedIndexes)}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag()}},_giveFocus:function(){if(this._isFocused()){return}this._parent();this._getMainElement().focus()}});return k});define("DS/Controls/ComboBox",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Controls/Button","DS/Controls/ComboBoxBase","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/LineEditor"],function(c,d,k,l,s,i,h,o,n,p){function b(){this.elements.mainElement=new p({displayStyle:"text"}).inject(this.elements.container);this.elements.mainElement._myInput.addClassName("wux-controls-combobox-mainelement");this.elements.expander=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:true,name:"Button"}).inject(this.elements.container);this.elements.expander.setAttribute("style","border-left-width: 0px;")}function m(){var x=this;this._getMainElementTag().addEventListener("uncommittedChange",function(z){z.stopPropagation();x.fire("uncommittedChange")});this._getMainElementTag().addEventListener("change",function(z){z.stopPropagation()});var y=0;var v=function(){var C=false;var B=false;if(!y){C=x.preselectedIndex===x.selectedIndex&&x.selectedIndex===-1&&x._lastCustomEntry!==x._getMainElement().value;if(x.preselectedIndex===-1){x._lastCustomEntry=x._getMainElement().value}}else{clearTimeout(y);y=0;var A=x._getMainElement().value;var z=-1;x._model.search({match:function(D){if(x._model.options.shouldBeSelected(D.nodeModel)&&(A.toLowerCase()===D.nodeModel.options.label.toLowerCase())){D.nodeModel._getRowID(1);z=D.nodeModel._unfilteredRowID}},shouldStop:function(D){return z!==-1}});C=z===x.selectedIndex&&z===-1&&x._lastCustomEntry!==A;if(z===-1){x._lastCustomEntry=A}if(x.selectedIndex!==z){x.selectedIndex=z;B=true}}if(C){B=true;x._applySelectedIndex()}return B};if(this._validateOnBlurForTMCAndFilterApp){this._getMainElement().addEventListener("blur",function(z){v()})}var u=false;var t;n.addEventOnElement(this,this._getMainElement(),"keydown",function(z){if(x._getMainElement().value!==t){t=x._getMainElement().value}u=false;if(z.keyCode>=k.KEY0&&z.keyCode<=k.Z){u=true}else{if(z.keyCode>=k.NUMPAD0&&z.keyCode<=k.SLASH){u=true}else{if(z.keyCode===k.DELETE||z.keyCode===k.BACKSPACE||z.keyCode===k.SPACE){u=true}else{if(z.keyCode>=k.SEMICOLON&&z.keyCode<=222){u=true}else{if(z.keyCode===k.ENTER){var B=x._isPopupOpened();var A=v();z.actionPerformed=A;x._actionPerformedOnKeyDown=A;if(B){z.stopPropagation();x._stopPropagation=true}x.callMethodFromUIInteraction("_hidePopup");x._getMainElement().removeClassName("wux-controls-lineeditor-hideCursor")}}}}}});var w;n.addEventOnElement(this,this._getMainElement(),"keyup",function(A){if(x._actionPerformedOnKeyDown){A.actionPerformed=x._actionPerformedOnKeyDown;x._actionPerformedOnKeyDown=undefined}if(x._stopPropagation){A.stopPropagation();x._stopPropagation=undefined}if(A.keyCode===k.TAB||!u){return}var B=this.value;x.elements.mainElement.value=B;if(y){clearTimeout(y);y=0}y=setTimeout(function z(){var D=false;if((A.keyCode===k.DELETE||A.keyCode===k.BACKSPACE)&&x._emptySearched&&B===""&&w&&(w===k.DELETE||w===k.BACKSPACE)){D=true}x._emptySearched=B==="";x.callMethodFromUIInteraction("_showPopup");var E=x.callMethodFromUIInteraction("_showMatchingLabel",B);x.setPropertyFromUIInteraction("_isFiltering",true);var F=x._nbDisplayedItems===0;x.callMethodFromUIInteraction("_updateNbDisplayedElements");x.callMethodFromUIInteraction("_updatePopupHeight");if(x.generateRegexpString===x.publishedProperties.generateRegexpString.defaultValue){x._currentStartFiltered=x._getMainElement().selectionStart}else{x._currentStartFiltered=0}var C=-1;if(F||(D||!x.autocompleteFlag)&&E===-1){D=false}else{if(E!==-1){C=E}else{C=x._firstVisibleSelectableIndex}}x.callMethodFromUIInteraction("_selectInList",C);clearTimeout(y);y=0},500);w=A.keyCode})}function e(){this.elements.mainElement=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-mainelement",type:"text",tabindex:0,isTextField:false,name:"Button"}).inject(this.elements.container);this.elements.iconPlaceholder=new c.Element("div",{"class":"wux-comboBox-icon-placeholder"}).inject(this.elements.mainElement);if(!this.elements.text){this.elements.text=c.createElement("span").inject(this.elements.mainElement)}this.elements.expander=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:false,name:"Button"}).inject(this.elements.container);if(!this.actionOnClickFlag){this.elements.expander.setAttribute("style","border-left-width: 0px;")}this.elements.mainElement.setAttribute("action",this.actionOnClickFlag)}function g(){var u=this;if(this.actionOnClickFlag){n.addEventOnElement(this,this.elements.mainElement,d.POINTERUP,function(x){x.stopPropagation();u.fire("click")})}else{n.addEventOnElement(this,this.elements.mainElement,d.POINTERUP,function(){if(u._isPopupOpened()){u.callMethodFromUIInteraction("_hidePopup",!u.multiSelFlag)}else{u.callMethodFromUIInteraction("_showPopup")}})}this._getMainElement().addEventListener("dblclick",function(x){x.stopPropagation()});this._getMainElement().addEventListener("click",function(x){x.stopPropagation()});var t=false;n.addEventOnElement(this,this._getMainElement(),"keydown",function(x){t=false;if(x.keyCode>=k.KEY0&&x.keyCode<=k.Z){t=true}else{if(x.keyCode>=k.NUMPAD0&&x.keyCode<=k.NUMPAD9){t=true}}if(u.multiSelFlag&&!u._isPopupOpened()){t=false}if(!k.validate(x.keyCode)){return}if(!u.actionOnClickFlag||u._isPopupOpened()||!u.mainElementVisibleFlag){if(u._isPopupOpened()){if(!u.multiSelFlag||x.keyCode!==k.SPACE){u.callMethodFromUIInteraction("_hidePopup");x.stopPropagation();u._stopPropagation=true}}else{u.callMethodFromUIInteraction("_showPopup");x.stopPropagation();u._stopPropagation=true}}else{x.stopPropagation();u.fire("click")}});var v;var w="";n.addEventOnElement(this,this._getMainElement(),"keyup",function(x){if(u._actionPerformedOnKeyDown){x.actionPerformed=u._actionPerformedOnKeyDown;u._actionPerformedOnKeyDown=undefined}if(u._stopPropagation){x.stopPropagation();u._stopPropagation=undefined}if(x.keyCode===k.SPACE){x.stopPropagation()}if(x.keyCode===k.TAB||!t){return}if(v){clearTimeout(v)}w+=String.fromCharCode(x.keyCode);v=setTimeout(function(){n._pushUserInteractionContext();var y=-1;u._model.search({match:function(z){if(u._model.options.shouldBeSelected(z.nodeModel)&&(new RegExp(u.generateRegexpString(w),"i")).test(z.nodeModel.options.label)){y=z.nodeModel._getRowID(1)}},shouldStop:function(z){return y!==-1}});if(y!==-1){if(u.multiSelFlag){u.selectedIndexes=[y]}else{u.selectedIndex=y}}w="";n._popUserInteractionContext()},500)})}function a(){if(this.elements.iconPlaceholder){if(this._generatedIcon!==undefined){this.elements.iconPlaceholder.removeChild(this._generatedIcon);this.elements.text.style.displayStyle="inline-block";this.elements.mainElement.style.textAlign="initial";this.elements.iconPlaceholder.style.marginRight="0px";this.elements.iconPlaceholder.style.paddingLeft="0px";delete this._generatedIcon}if(this.selectedIndex!==-1){var t=this._getAllDescendants()[this.selectedIndex];if(t.options.icons&&t.options.icons.length>0&&t.options.icons[0]){this._generatedIcon=n.generateIcon(t.options.icons[0]);this._generatedIcon.inject(this.elements.iconPlaceholder);if(t.options.label===""){this.elements.text.style.displayStyle="none";this.elements.mainElement.style.textAlign="center";if(!this.actionOnClickFlag&&this.expanderVisibleFlag){if(!this.touchMode){this.elements.iconPlaceholder.style.paddingLeft="11px"}else{this.elements.iconPlaceholder.style.paddingLeft="19px"}}}else{this.elements.iconPlaceholder.style.marginRight="11px"}}}}}function f(){if(this.elements.mainElement){if(this.elements.iconPlaceholder){this.elements.mainElement.removeChild(this.elements.iconPlaceholder);delete this.elements.iconPlaceholder}if(this.elements.text){this.elements.mainElement.removeChild(this.elements.text);delete this.elements.text}this.elements.container.removeChild(this._getMainElementTag());delete this.elements.mainElement;this.elements.container.removeChild(this.elements.expander);delete this.elements.expander}if(this.enableSearchFlag===true){b.call(this);m.call(this)}else{e.call(this);g.call(this)}this._addCommonEvents();this._applyDisplayStyle()}function r(){if(this._isFiltering){this._model.prepareUpdate();this._getAllDescendants().forEach(function(t){if(t.isHidden()){t.show()}if(!t.isExpanded()){t.expand()}});this._model.pushUpdate();this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._currentStartFiltered=-1;this._getMainElement().selectionStart=this._getMainElement().selectionEnd;this._isFiltering=false;this._updateNbDisplayedElements();this._updatePopupHeight()}}function j(){var t=this;this._model.getXSO().onAdd(function(u){if(!t.mainElementVisibleFlag){return}if(!t.autocompleteFlag){return}if(t.enableSearchFlag&&t._isFiltering){t.elements.mainElement.value=u.options.label;t._getMainElement().selectionStart=t._currentStartFiltered}})}var q=h.inherit({name:"comboBox",markForRecordFlag:true,publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},mainElementVisibleFlag:{defaultValue:true,type:"boolean",category:"Appearance"},expanderVisibleFlag:{defaultValue:true,type:"boolean",category:"Appearance"},enableSearchFlag:{defaultValue:true,type:"boolean",category:"Behavior"},generateRegexpString:{defaultValue:function(t){return"^"+t},type:"function",category:"Behavior",uiDisplay:false},useMatchingSearchFunction:{defaultValue:false,type:"boolean",category:"Behavior",uiDisplay:false},isNodeMatchingSearch:{defaultValue:function(u,t){return this.displayChildrenSearchMethod(u,t)},type:"function",category:"Behavior",uiDisplay:false},autocompleteFlag:{defaultValue:true,type:"boolean",category:"Behavior"},actionOnClickFlag:{defaultValue:false,type:"boolean",category:"Behavior"},expanderIcon:{defaultValue:"expand-down",type:"object",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"}},buildView:function(){this._parent();this._regex="";this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._currentStartFiltered=-1;this._lastCustomEntry="";this._isFiltering=false;this._emptySearched=false},_updateNbDisplayedElements:function(t){if(this.enableSearchFlag&&this._isFiltering){if(!t){this._properties.nbDisplayedElements.value=(this._nbDisplayedItems<10?this._nbDisplayedItems:10)}else{this._properties.nbDisplayedElements.value=this._reduceNbDisplayedToAvoidOverlaping(t,this._nbDisplayedItems<10?this._nbDisplayedItems:10)}}else{this._parent(t)}},_showMatchingLabel:function(w){this._model.prepareUpdate();var v=-1;this._regex=w;var t=undefined;if(this.useMatchingSearchFunction){this._getAllDescendants().forEach(function(x){x.options.alreadyTreated=undefined})}else{t=new RegExp(this.generateRegexpString(this._regex),"i")}var u=this;this._model.search({match:function(y){var x=false;if(u.useMatchingSearchFunction){x=u.isNodeMatchingSearch.call(u,w,y)}else{x=t.test(y.nodeModel.options.label)}if(x){if(y.nodeModel.isHidden()){y.nodeModel.show()}if(w===y.nodeModel.getLabel()){v=y.nodeModel._unfilteredRowID}}else{if(!y.nodeModel.isHidden()){y.nodeModel.hide()}}}});this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._getAllDescendants().forEach(function(x){if(!x.isHidden()){x.getParents().forEach(function(y){if(y.isHidden()){y.show();u._nbDisplayedItems++}if(!y.isExpanded()){y.expand()}});if(u._firstVisibleSelectableIndex===-1&&u._model.options.shouldBeSelected(x)){u._firstVisibleSelectableIndex=x._unfilteredRowID}u._nbDisplayedItems++}});this._model.pushUpdate();return v},getPopupWidth:function(){return(this.mainElementVisibleFlag?this._parent():this.elements.treeListView._treeWidth)},displayBrothersSearchMethod:function(w,t){var u=t.nodeModel;if(u.options.alreadyTreated!==undefined){return u.options.alreadyTreated}if(u.getLabel().toLowerCase().includes(w.toLowerCase())){var v=u.getParent().getChildren();if(v){v.forEach(function(x){if(x.isHidden()){x.show()}else{x.options.alreadyTreated=true}})}return true}else{return false}},displayChildrenSearchMethod:function(w,u){var v=u.nodeModel;if(v.options.alreadyTreated!==undefined){return v.options.alreadyTreated}if(v.getLabel().toLowerCase().includes(w.toLowerCase())){var t=function(y){var x=y.getChildren();if(x){x.forEach(function(z){z.options.alreadyTreated=true;t(z)})}};t(v);return true}else{return false}},_preselectedIndexModified:function(){},_selectedIndexModified:function(){if(!this.mainElementVisibleFlag){return}if(this.enableSearchFlag){this._emptySearched=false;if(this.selectedIndex===-1){this.elements.mainElement.value=this._lastCustomEntry}else{this._lastCustomEntry="";this.elements.mainElement.value=this._getAllDescendants()[this.selectedIndex].options.label}}else{if((!this.multiSelFlag&&this.selectedIndex===-1)||(this.multiSelFlag&&this.selectedIndexes.length===0)){this.elements.mainElement.value=this._lastCustomEntry;this.elements.mainElement.addClassName("wux-combobox-placeholderstyle");if(this.placeholder){this.elements.text.textContent=this.placeholder}else{this.elements.text.textContent=""}}else{this.elements.mainElement.removeClassName("wux-combobox-placeholderstyle");if(this.multiSelFlag){var t="";for(var u=0;u<this.selectedIndexes.length;u++){var v=this._getAllDescendants()[this.selectedIndexes[u]];if(v){t+=v.options.label;if(u!==this.selectedIndexes.length-1){t+=", "}}}this.elements.text.textContent=t}else{if(this.selectedIndex>=0&&this.selectedIndex<this._getAllDescendants().length){this.elements.text.textContent=this._getAllDescendants()[this.selectedIndex].options.label}else{this.elements.text.textContent=""}}}if(!this.multiSelFlag){a.call(this)}}},_popupHidden:function(t){r.call(this);this._selectedIndexModified()},_modelLoaded:function(){r.call(this);j.call(this)},_updateCurrentProperties:function(){if(this.enableSearchFlag&&this.selectedIndex===-1){this._properties.value.value=this._lastCustomEntry!==""?this._lastCustomEntry:undefined;this._properties.currentValue.value=this._lastCustomEntry!==""?this._lastCustomEntry:undefined;this._properties.label.value=this._lastCustomEntry;this._properties.currentLabel.value=this._lastCustomEntry}else{this._parent()}},_getMainElement:function(){if(this.mainElementVisibleFlag){if(this.elements.mainElement instanceof p){return this.elements.mainElement.getContent().dsModel._myInput}return this.elements.mainElement}else{return this.elements.expander}},_getMainElementTag:function(){if(this.elements.mainElement instanceof p){return this.elements.mainElement.getContent()}return this.elements.mainElement},_applyPlaceholder:function(){this.elements.mainElement.placeholder=this.placeholder},_applyMainElementVisibleFlag:function(){this._applyProperties({})},_applyExpanderVisibleFlag:function(){var t=this._getMainElementTag();if(this.expanderVisibleFlag){this.elements.expander.show();this.getContent().removeAttribute("no-expander");t.removeClassName("wux-combobox-mainelement-noexpander")}else{this.elements.expander.hide();this.getContent().setAttributeNode(document.createAttribute("no-expander"));t.addClassName("wux-combobox-mainelement-noexpander")}},_applyEnableSearchFlag:function(){if(!this.mainElementVisibleFlag){return}if(this.enableSearchFlag){this.reachablePlaceholderFlag=true}this._applyProperties({})},_applyAutocompleteFlag:function(){if(this.enableSearchFlag&&this._isFiltering){if(this.autocompleteFlag){this._preselectedIndexModified()}else{this.elements.mainElement.value=this._regex}}},_applyActionOnClickFlag:function(){if(this.enableSearchFlag||!this.mainElementVisibleFlag){return}this._applyProperties({})},_applyDisplayStyle:function(){if(this.displayStyle==="lite"){if(!this.enableSearchFlag){this.elements.mainElement.addClassName("wux-ui-style-lite")}else{this.elements.mainElement.displayStyle="lite"}this.elements.expander.addClassName("wux-ui-style-lite")}else{if(this.displayStyle==="normal"){if(!this.enableSearchFlag){this.elements.mainElement.removeClassName("wux-ui-style-lite")}else{this.elements.mainElement.displayStyle="text"}this.elements.expander.removeClassName("wux-ui-style-lite")}}},_applyExpanderIcon:function(){if(this.elements.icon){this.elements.icon.remove()}this.elements.icon=n.generateIcon(this.expanderIcon).inject(this.elements.expander);this.elements.icon.addClassName("wux-controls-combobox-icon")},_applyProperties:function(t){var u=this.isDirty("enableSearchFlag")||(this.isDirty("actionOnClickFlag")&&this.enableSearchFlag===false)||this.isDirty("mainElementVisibleFlag");if(u){f.call(this);if(!this.mainElementVisibleFlag){this._getMainElementTag().hide();this.elements.expander.addClassName("wux-combobox-expander-nomainelement");this.elements.expander.setAttribute("style","border-left-width:1px;")}}this._parent(t);if(this.isDirty("expanderIcon")||u){this._applyExpanderIcon(t.expanderIcon)}if(this.isDirty("placeholder")||u){this._applyPlaceholder(t.placeholder)}if(this.isDirty("autocompleteFlag")||u){this._applyAutocompleteFlag(t.autocompleteFlag)}if(!this.isDirty("selectedIndex")&&u){this._applySelectedIndex(t.selectedIndex)}if(!this.isDirty("selectedIndexes")&&u){this._applySelectedIndexes(t.selectedIndexes)}if(this.isDirty("expanderVisibleFlag")||u){this._applyExpanderVisibleFlag(t.expanderVisibleFlag)}}});o.register(q,"DS/ControlsRec/AbstractRec");return q});define("DS/Tweakers/StringViewModules",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/ColorPicker","DS/Controls/ComboBox","DS/Controls/ButtonGroup","DS/Controls/Button","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils"],function(h,c,u,v,z,r,A,j,a,n,g,p,w){function m(C,D){switch(C){case"integer":var B=parseInt(D,10);if(isNaN(B)){this.valueType="string";B=D?D.toString():""}return B;case"number":var B=parseFloat(D);if(isNaN(B)){this.valueType="string";B=D?D.toString():""}return B;case"boolean":return(/true/i.exec(D)!==null||D==="1");case"string":return D?D.toString():"";case"object":return JSON.parse(D);default:return D}}function d(B,C){if(typeof(C)==="string"){return C}if(B==="object"){return JSON.stringify(C)}else{if((B==="integer"||B==="number")&&((Number.isNan&&Number.isNaN(C)===true)||(isNaN!==undefined&&isNaN(C)===true))){return"NaN"}else{if(B==="integer"||B==="number"){return C.toString()}else{return C}}}}function t(B){return g.getWebappsBaseUrl()+B}var i=function(C,B){v.prototype.baseViewModule.call(this,C,B)};c.applyMixin(i,v.prototype.baseViewModule);var y=function(C,B){i.call(this,C,B)};c.applyMixin(y,i);y.prototype.buildView=function(){var B=this._options.viewOptions||{};B.escapeHTML=this._tweaker.escapeHTML;B.touchMode=this._tweaker._getCurrentTouchMode();B.disabled=this._tweaker.readOnly;B.selectAllOnFocus=true;B.fireOnlyFromUIInteractionFlag=true;B.autoCommitFlag=true;this._view=new z(B);this.setValue(this._tweaker.value)};y.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;if(!B||!D){return}u.addEventOnElement(D,B,"focus",function(E){E.stopPropagation()});u.addEventOnElement(D,B,"blur",function(E){E.stopPropagation();D.onPostEdit()});u.addEventOnElement(D,B,"uncommittedChange",function(E){E.stopPropagation();D.onPreEdit()});if(B._myInput){u.addEventOnElement(D,B._myInput,"keydown",function(E){if(E.keyCode===p.ESCAPE){D.onCancelEdit()}if((E.keyCode===p.ENTER)&&!E.ctrlKey&&!E.shiftKey&&!E.altKey&&D._liveChangeOccurred){D.onChange()}})}u.addEventOnElement(D,B,"change",function(G){G.stopPropagation();var F=B.value;var E=undefined;if(F===undefined||F===null){E=F}else{E=m.call(D,D.valueType,F)}C.setTweakerValue(E)})};y.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}if(C===undefined||C===null){B.value=C}else{B.value=d(D.valueType,C)}};var k=function(C,B){y.call(this,C,B)};c.applyMixin(k,y);k.prototype.buildView=function(){var B=this._options.viewOptions||{};B.escapeHTML=this._tweaker.escapeHTML;B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker.touchMode;B.fireOnlyFromUIInteractionFlag=true;B.selectAllOnFocus=true;B.autoCommitFlag=true;B.nbRows=0;B.widthInCharNumber=0;this._view=new r(B);this._tweaker.getContent().addClassName("wux-tweakers-editor");this.setValue(this._tweaker.value)};k.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.getContent().removeClassName("wux-tweakers-editor")}y.prototype.destroy.call(this)};k.prototype.setValue=function(C){var B=this._view;if(B){B.value=C}};var l=function(C,B){this._inlinedLineEditor=undefined;this._standardEditor=undefined;i.call(this,C,B)};c.applyMixin(l,i);l.prototype.buildView=function(){this._inlinedLineEditor=new h.Element("div");this._inlinedLineEditor.addClassName("wux-controls-abstract wux-controls-lineeditor wux-tweakers-multirep-tweakerstring");this._inlinedLineEditor._myInput=new h.Element("input");this._inlinedLineEditor._myInput.inject(this._inlinedLineEditor);this._standardEditor=new k(this._tweaker);this._view=w._buildInlineEditor(this._tweaker,this._inlinedLineEditor,this._standardEditor,{offset:1});this._view.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor");this.setValue(this._tweaker.value);this.setTouchMode(this._tweaker._getCurrentTouchMode())};l.prototype.handleEvents=function(){var C=this;var B=function(){if(C._view.embeddedContainer){C._view.embeddedContainer.visibleFlag=true}else{C._view.editBtn.getContent().click()}C._standardEditor._view._giveFocus()};u.addEventOnElement(C,C._inlinedLineEditor._myInput,"focus",B)};l.prototype.setTouchMode=function(B){if(!this._view){return}if(B===true){this._inlinedLineEditor.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedLineEditor.removeAttribute("touch-mode")}this._standardEditor.setTouchMode(B);if(this._view.embeddedContainer){this._view.embeddedContainer.touchMode=B}this._view.editBtn.touchMode=B};l.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}this._inlinedLineEditor._myInput.value=C;this._standardEditor.setValue(C)};l.prototype.destroy=function(){if(this._view){this._view.remove()}if(this._inlinedLineEditor){this._inlinedLineEditor.remove()}if(this._standardEditor){this._standardEditor.destroy()}if(this._view.embeddedContainer){this._view.embeddedContainer.visibleFlag=false;this._view.embeddedContainer.destroy()}if(this._view.editBtn){this._view.editBtn.destroy()}if(this._view){this._view.destroy()}delete this._view};var x=function(C,B){this._inlinedLineEditor=undefined;this._standardEditor=undefined;i.call(this,C,B)};c.applyMixin(x,i);x.prototype.buildView=function(){this._inlinedLineEditor=new h.Element("div");this._inlinedLineEditor.addClassName("wux-tweakers wux-tweakers-string-label");this._standardEditor=new h.Element("div");this._standardEditor.addClassName("wux-tweakers-standardEditor");this._view=w._buildInlineEditor(this._tweaker,this._inlinedLineEditor,this._standardEditor,{offset:true,hasNoButton:true});this.setValue(this._tweaker.value);this.setTouchMode(this._tweaker._getCurrentTouchMode())};x.prototype.setTouchMode=function(B){if(!this._view){return}if(B===true){this._inlinedLineEditor.setAttributeNode(document.createAttribute("touch-mode"));this._standardEditor.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedLineEditor.removeAttribute("touch-mode");this._standardEditor.removeAttribute("touch-mode")}if(this._view.embeddedContainer){this._view.embeddedContainer.touchMode=B}};x.prototype.setValue=function(B){if(this._tweaker.escapeHTML&&B){B=h.String.escapeHTML(B)}this._inlinedLineEditor.setContent(B);this._standardEditor.setContent(B)};x.prototype.destroy=function(){if(this._view){this._view.remove()}if(this._inlinedLineEditor){this._inlinedLineEditor.remove()}if(this._standardEditor){this._standardEditor.remove()}if(this._view.embeddedContainer){this._view.embeddedContainer.visibleFlag=false;this._view.embeddedContainer.destroy()}if(this._view){this._view.destroy()}delete this._view};var s=function(C,B){i.call(this,C,B)};c.applyMixin(s,i);s.prototype.buildView=function(){var B=this._options.viewOptions||{};B.elementsList=this._tweaker.possibleValues.map(function(C){return(typeof C==="string")?C:{labelItem:C.value,iconItem:C.icon}});B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;B.reachablePlaceholderFlag=this._tweaker.allowResetToUndefinedByUIFlag;B.placeholder=this._tweaker.usageDescription;this._view=new j(B);this.setValue(this._tweaker.value)};s.prototype.computeTweakerContentLength=function(){return u.computeStringWidth(this._view.value,this._tweaker.getFontSize(),this._tweaker.getFontFamily(),this._tweaker.getEditedState())+30};s.prototype.handleEvents=function(){var D=this;var E=this._tweaker;var C=this._view;var B=false;if(!C||!E){return}u.addEventOnElement(E,C,"show",function(F){F.stopPropagation();E.onShow()});u.addEventOnElement(E,C,"hide",function(F){F.stopPropagation();E.onHide({cancelFlag:(F.options.cancelPopupSelection?true:false)})});u.addEventOnElement(E,C,"preselectionChange",function(G){G.stopPropagation();var F;F=C._getAllDescendants()[C.preselectedIndex].options.grid.valueItem;if(!F){F=C._getAllDescendants()[C.preselectedIndex].options.label}B=true;D.setTweakerValue(F);B=false});u.addEventOnElement(E,C,"change",function(F){F.stopPropagation();if(!B){D.setTweakerValue(C.value);E.onPostEdit()}})};s.prototype.setValue=function(C){var B=this._view;if(!B){return}if(C===undefined||C===null){B.value=undefined}else{B.value=C}};s.prototype.setPossibleValues=function(B){if(this._view){this._view.elementsList=B.map(function(C){return(typeof C==="string")?C:{labelItem:C.value,iconItem:C.icon}})}};s.prototype.setUsageDescription=function(B){if(!this._view){return}this._view.placeholder=B};s.prototype.setAllowResetToUndefinedByUIFlag=function(B){if(!this._view){return}this._view.reachablePlaceholderFlag=B};var f=function(C,B){i.call(this,C,B)};c.applyMixin(f,i);f.prototype.buildView=function(){this._view=h.createElement("div",{"class":"wux-ui-icon"});this.setValue(this._tweaker.value)};f.prototype.setValue=function(D,C){var B=this._view;if(!B){return}if((D&&!C)||(D&&C&&D.iconName&&C.iconName&&D.iconName!==C.iconName)||(D&&C&&!D.iconName&&!C.iconName&&D!==C)){this._view.className="";this._view.addClassName("wux-ui-icon");u.generateIcon(D,{target:B})}};var b=function(C,B){i.call(this,C,B)};c.applyMixin(b,i);b.prototype.buildView=function(){var B=this._options.viewOptions||{};B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;this._view=new a(B);this.setPossibleValues(this._tweaker.possibleValues);this.setValue(this._tweaker.value)};b.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;u.addEventOnElement(D,B,"change",function(E){E.stopPropagation();C.setTweakerValue(B.value[0])})};b.prototype.setPossibleValues=function(F){var H=this._tweaker;var D=this._view;if(!D||!H||!F){return}var C=D.getButtonCount();for(var B=0;B<C;B++){var E=D.getButton(0);D.removeChild(E);E.destroy()}if(F&&Array.isArray(F)){F.forEach(function(I){if(typeof I==="string"){D.addChild(new n({type:"radio",label:I,value:I}))}else{I.type="radio";D.addChild(new n(I))}})}else{if(typeof F==="object"){for(var G in F){if(typeof G==="string"){D.addChild(new n({type:"radio",label:G,value:G}))}else{G.type="radio";D.addChild(new n(G))}}}}};b.prototype.setValue=function(C){var D=this._tweaker;var B=this._view;if(!B||!D){return}B.value=[C]};var q=function(C,B){i.call(this,C,B)};c.applyMixin(q,i);q.prototype.buildView=function(){var B=this._options.viewOptions||{};B.disabled=this._tweaker.readOnly;B.touchMode=this._tweaker._getCurrentTouchMode();B.fireOnlyFromUIInteractionFlag=true;this._view=new A(B);this.setValue(this._tweaker.value)};q.prototype.handleEvents=function(){var C=this;var D=this._tweaker;var B=this._view;u.addEventOnElement(D,B,"show",function(E){E.stopPropagation();D.onShow()});u.addEventOnElement(D,B,"hide",function(E){E.stopPropagation();D.onHide()});u.addEventOnElement(D,B,"keydown",function(E){if(E.keyCode===p.ESCAPE){D.onCancelEdit()}});u.addEventOnElement(D,B,"liveChange",function(E){E.stopPropagation();D.onPreEdit();C.setTweakerValue(B.value)});u.addEventOnElement(D,B,"change",function(E){E.stopPropagation();C.setTweakerValue(B.value);D.onPostEdit()})};q.prototype.setValue=function(C){var E=this._tweaker;var B=this._view;if(!B||!E){return}var D=C;if(E.readOnly){if(E.escapeHTML&&C){D=h.String.escapeHTML(this.value);E._properties.value.value=D}}B.value=d(this.valueType,D)};var e=function(C,B){i.call(this,C,B)};c.applyMixin(e,i);e.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-color-square");this.setValue(this._tweaker.value)};e.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.style.backgroundColor="";this._tweaker.elements.container.removeClassName("wux-tweakers-color-square")}};e.prototype.setValue=function(B){var C=this._tweaker;if(!C){return}this._tweaker.elements.container.style.backgroundColor="#"+B};e.prototype.setTouchMode=function(B){};var o={Base:i,LineEditor:y,ComboBox:s,Icon:f,ButtonGroup:b,ColorPicker:q,ColorSquare:e,Editor:k,LineEditorDotsEditor:l,StringDotsEditor:x};return o});define("DS/Tweakers/TweakerURLObject",["UWA/Core","DS/Tweakers/TweakerBase","DS/Tweakers/StringViewModules","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/LineEditor","DS/Controls/Button","DS/Utilities/Dom","DS/Core/PointerEvents"],function(f,m,c,h,j,d,i,a,g){var n=m.inherit({name:"TweakerURLObject",publishedProperties:{value:{defaultValue:undefined,type:"object"},displayStyle:{defaultValue:"clickableLabel",type:"string"},hyperlinkTarget:{defaultValue:"_blank",type:"string"}},getStringFromValue:function(o){return o?o.label:""},_applyHyperlinkTarget:function(){if(this.elements._viewModule&&this.elements._viewModule.setHyperLinkTarget){this.elements._viewModule.setHyperLinkTarget(this.hyperLinkTarget)}}});var l=function(p,o){m.prototype.baseViewModule.call(this,p,o)};j.applyMixin(l,m.prototype.baseViewModule);var e=function(p,o){c.LineEditor.call(this,p,o)};j.applyMixin(e,c.LineEditor);e.prototype.setValue=function(p){var q=this._tweaker;var o=this._view;if(!o||!q){return}o.value=p?p.label:""};e.prototype.setTweakerValue=function(p){if(this._tweaker){var o=f.clone(this._tweaker.value,false);o.label=p;m.prototype.baseViewModule.prototype.setTweakerValue.call(this,o)}};var b=function(p,o){l.call(this,p,o)};j.applyMixin(b,l);b.prototype.buildView=function(){if(!this._tweaker.elements.container){return}this._view=[];this._tweaker.getContent().addClassName("wux-tweakers-urlobject");this._labelDiv=f.createElement("a",{"class":"wux-tweakers-string-label"});this._iconDiv=f.createElement("span",{"class":"wux-tweakers-string-icon"});this._view.push(this._iconDiv);this._view.push(this._labelDiv);this.setTouchMode(this._tweaker.touchMode);this.setValue(this._tweaker.value);this.setHyperLinkTarget(this._tweaker.hyperlinkTarget)};b.prototype.handleEvents=function(){var o=this._tweaker;h.addEventOnElement(this,this._labelDiv,g.POINTERHIT,function(s){if(!o.value||!o.value.func){return}if(typeof o.value.func==="function"){o.value.func({context:o.context})}else{if(o.value.module){var p=o.value.module;var r=o.value.func;var q=o.value.argument;if(!q){q={}}q.context=o.context;require([p],function(t){if(t){var u=t[r];if(u&&typeof u==="function"){u(q)}}})}}})};b.prototype.setValue=function(t){if(!this._view||!this._tweaker){return}var s=this._tweaker.value;var p=s?s.url:undefined;var r=s?s.parameters:undefined;var o=s?s.label:undefined;var q=s?s.icon:undefined;if(p){this._labelDiv.href=p+(r?r:"");if(s.target&&s.target!==this._tweaker.hyperlinkTarget){this._tweaker.hyperlinkTarget=s.target}}else{this._labelDiv.href="javascript:;";this._tweaker.hyperlinkTarget="_self"}this._labelDiv.textContent=o;if(q){h.generateIcon(q,{target:this._iconDiv});this._iconDiv.show()}else{this._iconDiv.hide()}this.updateReferenceValueLabel()};b.prototype.setTouchMode=function(p,o){if(!this._view){return}this._view.touchMode=p};b.prototype.setHyperLinkTarget=function(p,o){if(!this._view){return}if(p!==o){this._labelDiv.setAttribute("target",p)}};b.prototype.usesReferenceValueLabel=function(){return true};var k=function(p,o){l.call(this,p,o)};j.applyMixin(k,l);k.prototype.buildView=function(){var p=this;if(!this._tweaker.elements.container){return}var o=this._options.viewOptions||{};o.escapeHTML=this._tweaker.escapeHTML;o.touchMode=this._tweaker._getCurrentTouchMode();o.disabled=this._tweaker.readOnly;o.selectAllOnFocus=true;o.fireOnlyFromUIInteractionFlag=true;o.autoCommitFlag=true;o.displayClearFieldButtonFlag=true;this._view=[];this._tweaker.getContent().addClassName("wux-tweakers-urlobject");this._view._lineEditor=new d(o);this._view._lineEditor.getContent().addClassName("wux-tweakers-urlobject-editor");this._view.push(this._view._lineEditor);this._view._editBtn=new i({label:"..."});this._view._editBtn.getContent().addClassName("wux-tweakers-urlobject-button");this._view.push(this._view._editBtn);this._view._giveFocus=function(){p._view._lineEditor._giveFocus()};this.setTouchMode(this._tweaker.touchMode);this.setValue(this._tweaker.value)};k.prototype.handleEvents=function(){var o=this._view;var r=this._tweaker;var q=this;var p=q._view._lineEditor;o._editBtn.onClick=function(w){var t=function(x,z,y){require([x],function(B){if(B){var C=B[z];if(C&&typeof C==="function"){var A=y;if(!A){A={}}A.context=q._tweaker.context;C(A)}}})};if(q._tweaker.value&&typeof q._tweaker.value==="function"){q._tweaker.value({context:q._tweaker.context})}else{if(q._tweaker.value&&q._tweaker.value.module){var s=q._tweaker.value.module;var v=q._tweaker.value.func;var u=q._tweaker.value.argument;if(!u){u={}}u.context=q._tweaker.context;t(s,v,u)}}};this._view=p;c.LineEditor.prototype.handleEvents.call(this);this._view=o;this._view._giveFocus=function(){q._view._lineEditor._giveFocus()}};k.prototype.setValue=function(q,o){if(!this._view||!this._tweaker){return}var p=this._tweaker.value;this._view._lineEditor.value=p?p.label:undefined;this.updateReferenceValueLabel()};k.prototype.setTweakerValue=function(p){if(this._tweaker){var o=f.clone(this._tweaker.value,false);if(o===undefined){o={}}o.label=p;m.prototype.baseViewModule.prototype.setTweakerValue.call(this,o)}};k.prototype.setTouchMode=function(p,o){if(!this._view){return}this._view.touchMode=p};k.prototype.usesReferenceValueLabel=function(){return true};n.prototype.baseViewModule=l;n.prototype.VIEW_MODULES={clickableLabel:{classObject:e},clickableLabel_readOnly:{classObject:b,options:{viewOptions:{displayStyle:"clickableLabel"}}},searchableLink:{classObject:k},searchableLink_readOnly:{classObject:b,options:{viewOptions:{displayStyle:"searchableLink"}}}};n.prototype.registerViewModule=function(o,p){return;if(!o||!p||!p.classObject&&!p.classPath){return}if(n.prototype.VIEW_MODULES[o]!==undefined){return}n.prototype.VIEW_MODULES[o]=p};return n});define("DS/Tweakers/TweakerString",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Tweakers/StringViewModules","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils"],function(e,f,a,j,c,d,l,i){function k(m,n){switch(m){case"integer":return parseInt(n,10);case"number":return parseFloat(n);case"boolean":return(/true/i.exec(n)!==null||n==="1");case"string":return n?n.toString():"";case"object":return JSON.parse(n);default:return n}}function h(m,n){if(n===undefined||n===null||typeof(n)==="string"){return n}else{if(f.equalsToNaN(n)){return undefined}else{if(typeof(n)==="object"&&!(n instanceof Array)&&!(n instanceof Date)){if(n.iconName!==undefined&&n.fontIconFamily!==undefined){return n}else{return JSON.stringify(n)}}else{return String(n)}}}}function b(m){return d.getWebappsBaseUrl()+m}var g=j.inherit({name:"TweakerString",publishedProperties:{displayStyle:{defaultValue:"lineEditor",type:"string"},value:{defaultValue:"",type:"string",advancedSetter:true,recordFlag:true},valueType:{defaultValue:"string",type:"string"}},_upgradeValue:function(m){if(typeof(m)!=="string"){return h(this.valueType,m)}else{if(this.escapeHTML){return e.String.escapeHTML(m)}}return m}});g.prototype.baseViewModule=c.Base;g.prototype.VIEW_MODULES={lineEditor:{classObject:c.LineEditor},password:{classObject:c.LineEditor,options:{viewOptions:{displayStyle:"password"}}},password_readOnly:{classObject:c.LineEditor,options:{viewOptions:{displayStyle:"password"}}},link:{classObject:c.LineEditor},link_readOnly:{classObject:j.prototype.VIEW_MODULES.readOnly.classObject,options:{hyperlink:1}},combo:{classObject:c.ComboBox,options:{viewOptions:{enableSearchFlag:false,actionOnClickFlag:false}}},icon:{classObject:c.Icon},icon_readOnly:{classObject:c.Icon},buttonGroup:{classObject:c.ButtonGroup},buttonGroup_readOnly:{classObject:c.ButtonGroup},color:{classObject:c.ColorPicker},color_readOnly:{classObject:c.ColorSquare},editor_readOnly:{classObject:j.prototype.VIEW_MODULES.readOnly.classObject,options:{wrap:1}},editor:{classObject:c.Editor},editorInline:{classObject:c.LineEditorDotsEditor},editorInline_readOnly:{classObject:c.StringDotsEditor}};g.prototype.registerViewModule=function(m,n){return;if(!m||!n||!n.classObject&&!n.classPath){return}if(g.prototype.VIEW_MODULES[m]!==undefined){return}g.prototype.VIEW_MODULES[m]=n};return g});define("DS/Tweakers/TweakerBlob",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerString","DS/WebappsUtils/WebappsUtils","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerUtils","DS/Controls/Button"],function(c,f,l,h,a,m,j,e){var g="No name";var i=l.inherit({name:"tweakerBlob",publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},blob:{defaultValue:undefined,type:"object",category:"Model"},displayStyle:{defaultValue:"label",type:"string",category:"Appearance"},augmentedDisplay:{defaultValue:undefined,type:"string",category:"Appearance"},},_applyPlaceholder:function(){if(this.elements._viewModule){this.elements._viewModule.setPlaceholder(this.placeholder)}},_applyBlob:function(){var o=this;if(o.blob){var n=new FileReader();n.onloadend=function(p){if(o.value!==p.target.result){o.value=p.target.result}};n.readAsDataURL(o.blob)}if(this.elements._viewModule){this.elements._viewModule.setBlob(this.blob)}},_applyValue:function(){this.blob=this._dataURLtoBlob(this.value);this.onChange()},_applyDisabled:function(n){this._parent();if(this.elements._viewModule&&this.elements._viewModule.setDisabled){this.elements._viewModule.setDisabled(this.disabled)}},_dataURLtoBlob:function(r){if(!r){return}var o=r.split(",");var t=o[0].match(/:(.*?);/);if(!t||t.length<2){return}var q=o[0].match(/:(.*?);/)[1];var p=atob(o[1]),u=p.length,s=new Uint8Array(u);while(u--){s[u]=p.charCodeAt(u)}return new Blob([s],{type:q})}});var b=function(o,n){l.prototype.baseViewModule.call(this,o,n)};f.applyMixin(b,l.prototype.baseViewModule);b.prototype.setBlob=function(){};b.prototype.setBlobName=function(){};b.prototype.setDisabled=function(){};b.prototype.setPlaceholder=function(){};var d=function(o,n){this._inlinedView=undefined;b.call(this,o,n)};f.applyMixin(d,b);d.prototype.buildView=function(){var q=this;var r=q._tweaker;var p=r._getCurrentTouchMode();r.elements.container.addClassName("wux-tweakers-blob");var o=c.createElement("div",{"class":"wux-tweakers-blob-main"});q._inlinedView=c.createElement("div",{"class":"wux-tweakers-blob-inlinedView"});if(p===true){q._inlinedView.setAttributeNode(document.createAttribute("touch-mode"))}else{q._inlinedView.removeAttribute("touch-mode")}q._inlinedView._spanText=document.createElement("span");q._inlinedView._spanText.className="wux-tweakers-blob-span-text wux-tweakers-blob-span-text-placeholder";q._inlinedView._spanText.textContent=r.placeholder;q._inlinedView.appendChild(q._inlinedView._spanText);q._inlinedView._placeholderDnD=document.createElement("div");q._inlinedView._placeholderDnD.className="wux-tweakers-blob-draggable-div";q._inlinedView._placeholderDnD.style.display="none";q._inlinedView.appendChild(q._inlinedView._placeholderDnD);var n=document.createElement("span");n.className="wux-ui-3ds wux-ui-3ds-doc-add wux-ui-3ds-lg wux-tweakers-blob-span";q._inlinedView._placeholderDnD.appendChild(n);q._inlinedView.inject(o);q._editBtn=new e({showLabelFlag:false,icon:{iconName:"upload",iconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},touchMode:p});q._editBtn.getContent().addClassName("wux-tweakers-multirep-button");q._editBtn.inject(o);q._editBtn._blobFinderInput=document.createElement("input");q._editBtn._blobFinderInput.type="file";q._editBtn._blobFinderInput.className="wux-tweakers-blobFinder-input";q._editBtn.getContent().appendChild(q._editBtn._blobFinderInput);q._editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor");q._view=o;q.setBlob(this._tweaker.blob)};d.prototype.handleEvents=function(){var p=this;var q=p._tweaker;var n=p._view;function o(t){t.stopPropagation();var s;if(t.dataTransfer){t.preventDefault();s=t.dataTransfer.files[0];q._blobName=t.dataTransfer.files[0].name;p._inlinedView.removeClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="none"}else{if(p._editBtn._blobFinderInput.files&&p._editBtn._blobFinderInput.files.length){s=p._editBtn._blobFinderInput.files[0];q._blobName=p._editBtn._blobFinderInput.files[0].name}else{}}var r=new FileReader();r.onloadend=function(u){if((q.value!==u.target.result)||(!u.target.result)){p.setTweakerValue(u.target.result);p.setBlob(q.blob)}else{p.setBlob(q.blob)}};if(s){r.readAsDataURL(s)}}p._editBtn._blobFinderInput.addEventListener("change",o);n.addEventListener("dragover",function(r){r.preventDefault();p._inlinedView.addClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="block"});n.addEventListener("drop",o);n.addEventListener("dragleave",function(r){r.preventDefault();p._inlinedView.removeClassName("wux-tweakers-blob-ondragover");p._inlinedView._placeholderDnD.style.display="none"})};d.prototype.setPlaceholder=function(n){if(!this._view){return}if(this._inlinedView&&this._inlinedView._spanText&&!this.blob){this._inlinedView._spanText.textContent=n}};d.prototype.setBlob=function(n){if(!this._view){return}if(this._tweaker.value&&this._tweaker.blob&&!this._tweaker._blobName){this._tweaker._blobName=g}else{if(!this._tweaker.value&&!this._tweaker.blob){this._tweaker._blobName=this._tweaker.placeholder;this._editBtn._blobFinderInput.value=""}}if(this._inlinedView&&this._inlinedView._spanText){this._inlinedView._spanText.textContent=this._tweaker._blobName;this._inlinedView._spanText.className="wux-tweakers-blob-span-text"}};d.prototype.setTouchMode=function(n){if(!this._view){return}if(n===true){this._inlinedView.setAttributeNode(document.createAttribute("touch-mode"))}else{this._inlinedView.removeAttribute("touch-mode")}this._editBtn.touchMode=n};d.prototype.setDisabled=function(n){if(!this._view){return}if(n===true){this._inlinedView.setAttributeNode(document.createAttribute("disabled"));if(this._inlinedView.getAttributeNode("focused")){this._inlinedView.removeAttribute("focused")}}else{this._inlinedView.removeAttribute("disabled")}this._editBtn.disabled=n;if(n){this._view.style.pointerEvents="none"}else{this._view.style.pointerEvents="auto"}};d.prototype.destroy=function(){this._tweaker.elements.container.removeClassName("wux-tweakers-blob");if(this._inlinedView){this._inlinedView.remove();this._inlinedView.destroy()}if(this._editBtn){this._editBtn.remove();this._editBtn.destroy()}b.prototype.destroy.call(this)};var k=function(o,n){b.call(this,o,n)};f.applyMixin(k,b);k.prototype.buildView=function(){var o=this;var p=o._tweaker;var n=p.elements.container;n.addClassName("wux-tweakers-string-label");if(p.value&&!p._blobName){p._blobName=g}if(p._blobName){n.textContent=p._blobName}};k.prototype.setBlob=function(p){var o=this;var q=o._tweaker;var n=q.elements.container;if(this._tweaker.blob&&!this._tweaker._blobName){this._tweaker._blobName=g}else{if(!this._tweaker.value&&!this._tweaker.blob){this._tweaker._blobName=this._tweaker.placeholder}}n.textContent=q._blobName};k.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.textContent="";this._tweaker.elements.container.removeClassName("wux-tweakers-string-label")}b.prototype.destroy.call(this)};i.prototype.baseViewModule=b;i.prototype.VIEW_MODULES={readOnly:{classObject:k},label:{classObject:d}};i.prototype.registerViewModule=function(n,o){return;if(!n||!o||!o.classObject&&!o.classPath){return}if(i.prototype.VIEW_MODULES[n]!==undefined){return}i.prototype.VIEW_MODULES[n]=o};return i});define("DS/Tweakers/TweakerColor",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerString","DS/Controls/ColorPicker","DS/Controls/ColorChooser","DS/Controls/ColorCanvas","DS/Utilities/KeyboardUtils","DS/Utilities/Dom"],function(g,i,k,l,b,e,o,c){var d=k.inherit({name:"TweakerColor",publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true},valueType:{defaultValue:"color",type:"string"},displayStyle:{defaultValue:"inline",type:"string"}},_upgradeValue:function(p){var q=p;if(q){q=q.toString();q=q.charAt(0)==="#"?q.substring(1,q.length):q}return this._parent(q)}});var n=function(q,p){k.prototype.baseViewModule.call(this,q,p)};n.prototype.computeTweakerContentLength=function(){return this._getCurrentTouchMode()?38:22};i.applyMixin(n,k.prototype.baseViewModule);var h=function(q,p){n.call(this,q,p)};i.applyMixin(h,n);h.prototype.buildView=function(){this._tweaker.elements.container.addClassName("wux-tweakers-color-square");this.setValue(this._tweaker.value)};h.prototype.destroy=function(){if(this._tweaker.elements.container){this._tweaker.elements.container.style.backgroundColor="";this._tweaker.elements.container.removeClassName("wux-tweakers-color-square")}};h.prototype.setValue=function(p){var q=this._tweaker;if(!q){return}if(typeof p==="string"&&p.charAt(0)==="#"){p=p.substr(1)}q.elements.container.style.backgroundColor="#"+p};h.prototype.setTouchMode=function(p){};var j=function(q,p){n.call(this,q,p)};i.applyMixin(j,n);j.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new l(p)};j.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}n.prototype.destroy.call(this)};j.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;p.elements._colorChooser.addEventListener("beginEdit",function(s){s.stopPropagation()});p.elements._colorChooser.elements._slider.addEventListener("beginEdit",function(s){s.stopPropagation()});p.addEventListener("show",function(s){s.stopPropagation();r.onShow()});p.addEventListener("hide",function(s){s.stopPropagation();r.onHide(s.options)});p.addEventListener("change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});p.addEventListener("liveChange",function(s){s.stopPropagation();q.setTweakerValue(p.value)});c.addEventOnElement(this,p,"keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit()}})};j.prototype.setValue=function(q){var p=this._view;if(!p){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q};var m=function(q,p){n.call(this,q,p)};i.applyMixin(m,n);m.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new b(p);if(this._tweaker.value!==this._view.value){this._tweaker.value=this._view.value}};m.prototype.handleEvents=function(){var q=this;var r=this._tweaker;var p=this._view;p.addEventListener("beginEdit",function(s){s.stopPropagation();r.onPreEdit()});p.addEventListener("endEdit",function(s){s.stopPropagation();r.onPostEdit()});p.addEventListener("change",function(s){s.stopPropagation();q.setTweakerValue(p.value)});p.addEventListener("keydown",function(s){if(s.keyCode===o.ESCAPE){r.onCancelEdit()}})};m.prototype.setValue=function(q){var r=this._tweaker;var p=this._view;if(!p||!r){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q;if(p.value!==q){r.value=p.value}};var f=function(q,p){n.call(this,q,p)};i.applyMixin(f,n);f.prototype.buildView=function(){var p=this._options.viewOptions||{};p.touchMode=this._tweaker._getCurrentTouchMode();p.value=this._tweaker.value;p.fireOnlyFromUIInteractionFlag=true;p.handleEditionCancel=false;this._view=new e(p)};f.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var p=this._view;p.addEventListener("beginEdit",function q(t){t.stopPropagation();s.onPreEdit()});p.addEventListener("endEdit",function(t){t.stopPropagation();s.onPostEdit()});p.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(p.value)});p.addEventListener("keydown",function(t){if(t.keyCode===o.ESCAPE){s.onCancelEdit()}})};f.prototype.setValue=function(q){var p=this._view;if(!p){return}if(typeof q==="string"&&q.charAt(0)==="#"){q=q.substr(1)}p.value=q};var a=function(q,p){n.call(this,q,p)};i.applyMixin(a,n);a.prototype.buildView=function(){this._view=g.createElement("div",{"class":"wux-tweakers-color-colorbar"});var p=this._options.viewOptions||{};p.handleEditionCancel=false;this._colorPickerVM=new j(this._tweaker,p);this._colorPickerVM._view.inject(this._view);this._colorCanvasVM=new f(this._tweaker,p);this._colorCanvasVM._view.inject(this._view)};a.prototype.handleEvents=function(){var p=this;var q=this._tweaker;q.addEventListener("show",function(r){p._colorCanvasVM._view.elements._pickerCursor.hide()});q.addEventListener("hide",function(r){p._colorCanvasVM._view.elements._pickerCursor.show()})};a.prototype.setValue=function(q){var r=this._tweaker;var p=this._view;if(!p||!r){return}r.disableEvents();var s=false;this._colorPickerVM.setValue(q);s=s||this._colorPickerVM._updateFromView;this._colorCanvasVM.setValue(q);s=s||this._colorCanvasVM._updateFromView;r.enableEvents()};a.prototype.setTouchMode=function(p){this._colorCanvasVM.setTouchMode(p);this._colorPickerVM.setTouchMode(p)};a.prototype.destroy=function(){this._colorPickerVM.destroy();this._colorCanvasVM.destroy();n.prototype.destroy.call(this)};d.prototype.baseViewModule=n;d.prototype.VIEW_MODULES={readOnly:{classObject:h},inline:{classObject:j},std_readOnly:{classObject:h},std:{classObject:m},colorBar_readOnly:{classObject:h},colorBar:{classObject:a},canvas:{classObject:f}};d.prototype.registerViewModule=function(p,q){return;if(!p||!q||!q.classObject&&!q.classPath){return}if(d.prototype.VIEW_MODULES[p]!==undefined){return}d.prototype.VIEW_MODULES[p]=q};return d});define("DS/Tweakers/TweakerMultiRep",["UWA/Core","DS/Core/PointerEvents","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerString","DS/Controls/Button","DS/Windows/Dialog","DS/Controls/Popup"],function(c,d,j,i,e,h,a){var b=j.inherit({name:"TweakerMultiRep",editor:undefined,publishedProperties:{displayStyle:{defaultValue:"inline",type:"string"},liveChangeFlag:{defaultValue:false,type:"boolean"}},_preEditValue:function(k,l){return true},_postBuildView:function(){switch(this.displayStyle){case"inline":this._buildInlineEditor();break;case"std":this._buildStdEditor();break}if(this._preEditValue(null,this.value)){this._applyValue(this.value)}this._applyReadOnly()},_applyValue:function(k){switch(this.displayStyle){case"inline":this._applyValueInline(k);if(this.editor&&!c.equals(this.value,this.editor.value)){if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{if(typeof this.value!=="undefined"&&this.value!==null){this.editor.value=this.value}}}break;case"std":this._applyValueStd(k);break}if(this.readOnly){if(this.value&&this.value.length>0){if(this.elements.editBtn){this.elements.editBtn.visibleFlag=true}}}},_applyValueInline:function(){},_applyTouchMode:function(){if(this.elements.editBtn){this.elements.editBtn.touchMode=this.touchMode}if(this.internalTweakerString){this.internalTweakerString.touchMode=this.touchMode}},_applyDialogOptions:function(){if(this._dialog){this._dialog.title=this.dialogOptions.title;this._dialog.icon=this.dialogOptions.icon;this._dialog.width=this.dialogOptions.width;this._dialog.height=this.dialogOptions.height;var l=f.call(this,this.getContent());var k=l&&l.modalFlag;if(k){this.dialogOptions.modalFlag=true}this._dialog.modalFlag=this.dialogOptions.modalFlag}},_applyValueStd:function(k){if(this.elements.internalView){this.elements.internalView.value=this.value}},_applyReadOnly:function(){switch(this.displayStyle){case"inline":if(this.internalTweakerString){this.internalTweakerString.readOnly=this.readOnly;if(!this.readOnly&&this.elements.editBtn){this.elements.editBtn.visibleFlag=true;this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor")}else{if(this.readOnly&&this.elements.editBtn){if(this.value===undefined||this.value===null||(this.value&&this.value.length===0)){this.elements.editBtn.visibleFlag=false}this.elements.editBtn.getContent().removeClassName("wux-tweakers-multirep-button-line-editor")}}}if(this.editor){this.editor.readOnly=this.readOnly}break;case"std":this._parent();break}},_buildInlineEditor:function(){var k=this;if(this.elements.internalView){this.elements.internalView.remove()}this.elements.internalView=c.createElement("div");this.elements.internalView.addClassName("wux-tweakers-multirep wux-tweakers-multirep-inline-editor");this.internalTweakerString=new i({readOnly:this.readOnly});this.internalTweakerString.inject(this.elements.internalView);this.elements.internalView.inject(this.elements.container);this.internalTweakerString.getContent().addClassName("wux-tweakers-multirep-tweakerstring");this.internalTweakerString.getContent().addEventListener("change",function(l){l.stopPropagation();if(k._dialog&&k._dialog.visibleFlag){return}if(k.editor&&k.editor._changeOptions){k._changeOptions=k.editor._changeOptions}k._processValueFromString(k.internalTweakerString.value);if(k._preEditValue(null,k.value)){k._applyValue(k.value);if(k._popup&&k._popup.visibleFlag){if(k.internalTweakerString.value!=="[]"&&JSON.stringify(k._changeOptions)!==k.internalTweakerString.value){k.fire("liveChange",k._changeOptions)}}else{if(!k._popup||(k._popup&&!k._popup.visibleFlag)){if(k._lockUI){return}k.fire("change",k._changeOptions)}}}});this.elements.editBtn=new e({label:"..."});this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button");if(!this.readOnly){this.elements.editBtn.getContent().addClassName("wux-tweakers-multirep-button-line-editor")}this.elements.editBtn.inject(this.elements.internalView);this._applyAugmentedDisplay()},_processValueFromString:function(k){},_processValueFromCopy:function(k){console.log("Override the method _processValueFromCopy of the TweakerMultirep to correctly manage the update of the value");this.value=k},_copyValueForDialog:function(){console.log("Override the method _copyValueForDialog of the TweakerMultirep to correctly manage the update of the value");return this.value},_buildStdEditor:function(){},_buildEditor:function(k){},_buildDialog:function(){var o=this;o.editor=o._buildEditor({displayStyle:"std",value:o._copyValueForDialog(),readOnly:o.readOnly,valueType:o.valueType,liveChangeFlag:o.liveChangeFlag});var q=function(r){o._dialog.visibleFlag=false;if(o.editor){o._dialog.destroy();o._dialog=undefined}o.fire("cancelEdit")};var l=new h({title:o.dialogOptions.title?o.dialogOptions.title:o.editorTitle,icon:o.dialogOptions.icon,content:o.editor,resizableFlag:true,height:o.dialogOptions.height?o.dialogOptions.height:240,width:o.dialogOptions.width?o.dialogOptions.width:200,identifier:o.dialogOptions.identifier?o.dialogOptions.identifier:"",buttons:{Ok:new e({onClick:function(t){var s=o.value;if(o.editor){o._processValueFromCopy(o.editor.value);o._applyValue()}t.dsModel.dialog.visibleFlag=false;s=JSON.stringify(s,function(w,u){return u===undefined?null:u});var r=JSON.stringify(o.editor.value,function(w,u){return u===undefined?null:u});if(s!==r){o.fire("change",o.value)}}}),Cancel:new e({onClick:q})},autoCloseFlag:false});l.addEventListener("close",q);var p=g.call(this,o.getContent());if(p){p.addWindow(l)}else{if(document.body){l.inject(document.body);l.getContent().setStyle("z-index",1000)}}var n=f.call(this,o.getContent());var m=n&&n.modalFlag;if(m){o.dialogOptions.modalFlag=true}l.modalFlag=o.dialogOptions.modalFlag;if(!p){var k=o.getContent().getParent(".wux-controls-popup");if(k){l.getContent().parentElement.setStyle("z-index",parseInt(k.getStyle("zIndex"))+1)}}l.position={at:"center center",my:"center center"},o._dialog=l;if((o.value&&o.value.length===0||!o.value||o.value===null)&&o._placeholderView){o._placeholderView()}else{if(o.elements._placeholder){o.elements._placeholder.style.display="none"}}o._dialog.addEventListener("change",function(r){r.stopPropagation()});return l},_buildPopup:function(n){var m=this;m.editor=m._buildEditor({displayStyle:"std",value:m.value,readOnly:m.readOnly,valueType:m.valueType});if(m.editor){m.editor.addEventListener("change",function(q){q.stopPropagation();m.editorInitialValue=m.editor.value;q.stopPropagation();if(m._popup&&m._popup.visibleFlag){if(m.value!==m.editor.value){m.value=m.editor.value}else{m.fire("liveChange",m.editor._changeOptions)}}else{if(!m._popup||(m._popup&&!m._popup.visibleFlag)){if(m.value!==m.editor.value){m.value=m.editor.value}else{m.fire("change",m.editor._changeOptions)}}}})}var l=this.name?this.name.toLowerCase().replace("tweaker",""):undefined;var p="wux-controls-popup wux-controls-popup-tweaker-multi-rep";if(l){p=p+" wux-controls-popup-tweaker-"+l}var k=new a({target:n,position:"bottom",alignment:"far",className:p});k.getContent().setStyle("height","176px");k.getContent().setStyle("width",m.internalTweakerString.getContent().offsetWidth+m.elements.editBtn.getContent().offsetWidth-parseInt(k.getContent().getStyle("padding-right"))-parseInt(k.getContent().getStyle("padding-left"))+"px");function o(q){if(k.visibleFlag&&!k.isElementInside(q.target)&&(!m.elements.editBtn||!m.elements.editBtn.getContent().contains(q.target))){k.hide();document.body.removeEventListener(d.POINTERDOWN,o)}}k.addEventListener("show",function(q){if(!q.target||q.target.dsModel!==k){return}if(m.value){try{m.initialValue=JSON.parse(JSON.stringify(m.value))}catch(q){m.initialValue=undefined}}m._applyValue();m._applyValueStd();if(m._popup.getBody()){var r=m._popup.getBody().doc;if(r&&m.doc&&r.getChildren()!==m.doc.getChildren()){r=m.doc;if(m.value&&m.value.length===0||!m.value||m.value===null){m._placeholderView.call(m)}else{if(m.elements._placeholder){m.elements._placeholder.style.display="none"}k.setBody(m.editor)}}else{if(!r){if(m.value&&m.value.length===0||!m.value||m.value===null){m._placeholderView()}else{if(m.elements._placeholder){m.elements._placeholder.style.display="none"}k.setBody(m.editor)}}}}document.body.addEventListener(d.POINTERDOWN,o);m.internalTweakerString.getContent().addEventListener("focus",o);if(m.editor&&m.editor._applyDisplayRowIndexes){m.editor._applyDisplayRowIndexes()}});k.addEventListener("hide",function(q){m._applyValueInline();if((m.value&&m.initialValue&&JSON.stringify(m.value)!==JSON.stringify(m.initialValue))||(!m.initialValue&&m.value)){m.fire("change")}});k.setBody(m.editor);return k},_applyDisplayRowIndexes:function(){},_applyAugmentedDisplay:function(k){var l=this;if(this.elements.editBtn){this.elements.editBtn.addEventListener("click",function(m){m.stopPropagation();if(l.editor){l.lastEditor=l.editor}if(l.augmentedDisplay==="dialog"){if(!l._dialog){if(l._popup){l._popup.destroy()}l._dialog=l._buildDialog()}l._dialog.visibleFlag=true}else{if(l._dialog){l._dialog.destroy()}if(!l._popup&&l.elements.editBtn){l._popup=l._buildPopup(l.elements.editBtn);l.elements.editBtn._popup=l._popup}l._popup.getContent().setStyle("width",l.internalTweakerString.getContent().offsetWidth+l.elements.editBtn.getContent().offsetWidth+"px");l._popup._updateView();l._popup.toggle()}})}},_applyProperties:function(k){if(this.isDirty("augmentedDisplay")){this._applyAugmentedDisplay(k.augmentedDisplay)}if(this.isDirty("dialogOptions")){this._applyDialogOptions(k.dialogOptions)}if(this.isDirty("readOnly")){this._applyReadOnly(k.readOnly)}}});function g(l){var m=l.getParent(".wux-windows-immersive-frame");if(m){return m.dsModel}var k=l.getParent(".wux-controls-popup");if(k){return g(k.dsModel.target.getContent())}return null}function f(l){var m=l.getParent(".wux-windows-window");if(m){return m.dsModel}var k=l.getParent(".wux-controls-popup");if(k){return f(k.dsModel.target.getContent())}return null}return b});define("DS/Tweakers/TweakerArray",["UWA/Core","DS/Tweakers/TweakerMultiRep","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/Tree/TreeListView","DS/TreeModel/TreeNodeModel","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/TweakerUtils","DS/Utilities/Dom"],function(c,o,h,r,e,j,p,u,s){var q=5;var w=20;var d=o.inherit({name:"tweakerArray",doc:undefined,publishedProperties:{editorTitle:{defaultValue:"Array Editor",type:"string"},valueType:{defaultValue:"string",type:"string"},value:{defaultValue:[],type:"array",advancedSetter:true},displayRowIndexes:{defaultValue:true,type:"boolean"},itemEditionTrigger:{defaultValue:"double click",type:"string"}},buildView:function(){if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-array")}if(!this.dialogOptions.title){this.dialogOptions.title=this.editorTitle}},_preEditValue:function(x,y){if(typeof y==="undefined"||(c.typeOf(y)==="array"&&y.length===0)||y===null){return true}if(c.typeOf(y)!=="typedarray"&&!t.call(this,this.valueType,y)){return false}return this._parent(x,y)},_convertValueToStringRepresentation:function(){var x=[];for(var y in this.value){if(!this.value.hasOwnProperty(y)){break}x.push(u._getStringRepresentationFromValue(this.valueType,this.value[y]))}return x},_applyValueInline:function(z){var x="";var B=this._convertValueToStringRepresentation();if(this.value&&this.value.length>0){if(typeof this.value==="string"&&this.value.indexOf("[")===0){x=this.value}else{x="[";for(var y in this.value){if(!this.value.hasOwnProperty(y)){break}var A="";if(typeof this.value[y]==="object"){try{A=JSON.stringify(this.value[y])}catch(C){return""}}else{if(typeof this.value[y]==="string"){A=B[y].replace(/\\"/g,'"');A='"'+A.replace(/"/g,'\\"')+'"'}else{if(B){if(typeof B[y]==="string"){A=B[y].replace(/\\"/g,'"');A='"'+A.replace(/"/g,'\\"')+'"'}else{A=B[y]}}else{A=this.value[y]}}}x+=A+","}if(x.slice(-1)===","){x=x.substring(0,x.length-1)}x+="]"}}else{if(typeof this.value==="undefined"||this.value===null){x=""}else{if(this.value&&this.value.length===0){x="[]"}}}if(this.internalTweakerString){if(!(this.internalTweakerString.value==="[]"&&(typeof this.value==="undefined"||this.value===null)&&!z)){this.internalTweakerString.value=x}}if(this.editor&&!c.equals(this.value,this.editor.value)){this.editor._isValueBeingSet=true;if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{this.editor.value=this.value}this.editor._isValueBeingSet=false}this._updateEditorColumnsOption()},_applyValueStd:function(y){var A=this;var x=A.itemEditionTrigger==="in place";this._isValueBeingSet=true;if(!A.doc){A._buildStdEditor()}if(A.doc){A.editor.getManager().prepareUpdateView();if((A.value===undefined||A.value===null||A.value&&A.value.length===0)){A.doc.empty();var B=new j({grid:{data:undefined},inEdition:x});A.doc.addRoot(B)}if(A.value&&A.value.length!==0&&A.value!==y){A.doc.empty();if(Array.isArray(A.value)||c.typeOf(A.value)==="typedarray"){for(var z=0;z<A.value.length;z++){var B=new j({grid:{data:A.value[z]},inEdition:x});A.doc.addRoot(B)}}}else{if(A.value&&A.value.length>0){var C=A.doc._getTrueRoot().getChildren();for(var z=0;z<A.value.length;z++){if(C&&z<C.length&&A.value[z]!==C[z].options.grid.data){C[z].updateOptions({grid:{data:A.value[z]},inEdition:x})}else{if(!C||z>=C.length){var B=new j({grid:{data:A.value[z]},inEdition:x});A.doc.addChild(B)}}}if(C&&C.length>A.value.length){while(A.value.length!==C.length){A.doc.removeRoot(C[A.value.length])}}}}A.editor.getManager().pushUpdateView()}this._isValueBeingSet=false;this._updateEditorColumnsOption()},_applyReadOnly:function(x){switch(this.displayStyle){case"inline":this._parent();break;case"std":this._parent();this._updateEditorColumnsOption();break}},_applyValueType:function(x){if(this.editor){this.editor.valueType=this.valueType}this._updateEditorColumnsOption()},_applyDisplayRowIndexes:function(){if(this.editor){this.editor.getManager().setHeadersDimensions({width:this.displayRowIndexes?(this.editor.getManager().getDocument().getRoots().length-1).toString().length*q+w:undefined,height:0})}},_applyItemEditionTrigger:function(y){var z=this;if(z.doc){var x=z.doc.getAllDescendants();x.forEach(function A(B){var C=z.itemEditionTrigger==="in place";if(B.options.inEdition!==C){B.options.inEdition=C}})}},_handleEvents:function(){var x=this;this.getContent().addEventListener("change",function(y){if(x.internalTweakerString){x._applyValueInline()}})},_applyProperties:function(x){if(this.isDirty("valueType")){this._applyValueType(x.valueType)}if(this.isDirty("displayRowIndexes")){this._applyDisplayRowIndexes()}if(!this._preEditValue(null,this.value)){this.value=[]}this._parent(x)},_updateEditorColumnsOption:function(){if(this.editor&&this.displayStyle==="std"){this.editor.getManager().setColumnOptions("data",{isEditable:!this.readOnly});this.editor.getManager().setColumnOptions("column_action",{isHidden:c.typeOf(this.value)==="typedarray"||this.readOnly});this.editor.getManager().updateView(true)}},_buildInlineEditor:function(){this._parent();this.elements.internalView.addClassName("wux-tweakers-array-inline-editor")},_applyLiveChangeFlag:function(){if(this.editor&&this.liveChangeFlag){u.enableLiveChangeOnTreeListView(this.editor)}},_buildStdEditor:function(){var y=this;var x=30;var z={defaultCellHeight:x,height:"auto",isSortable:false,apiVersion:2,resize:{columns:true},selection:{toggle:false,canMultiSelect:false,unselectAllOnEmptyArea:false},show:{rowHeaders:y.displayRowIndexes,columnHeaders:false},headersDimensions:{width:q+w,height:0},columns:[{dataIndex:"tree",isHidden:true,isEditable:true},{dataIndex:"data",text:"Value",width:"auto",onCellRequest:function(H){if(!H.nodeModel||!H.nodeModel.options){return}var D=H.nodeModel.options;var F=D.grid;var E=F.data;var B=y.valueType;var C=H.cellView.getContent();if(B==="typedarray"){var A=(y.value&&y.value.constructor&&y.value.constructor.name)?y.value.constructor.name.toLocaleLowerCase():"String";B=A.replace("array","")}else{if(B==="auto"){B=c.typeOf(E)}}var G={typePath:B,touchMode:F.touchMode,context:"inlinedTemplate",readOnly:!D.inEdition,onViewCreated:function(I){if(I!==undefined){H.cellView._setReusableContent(I);s.onNodeRendered(I.getContent(),function(){if(D.giveFocus){if(D.inEdition){s._pushUserInteractionContext();I._giveFocus();s._popUserInteractionContext()}else{H.cellView.getGridEngine()._giveFocus(true)}if(H.cellView){if(D.inEdition){H.cellView.getContent().setAttribute("draggable",false)}}}})}}};if(WUX.typeRepFactory!==undefined&&!F._buildFailure){WUX.typeRepFactory.generateView(E,G)}else{WUX.typeRepFactory=new p();WUX.typeRepFactory.onReady=function(){if(!F._buildFailure){WUX.typeRepFactory.generateView(E,G)}}}},onCellChange:function(A){if(A.event&&A.event.dsModel){return A.event.dsModel.value}}},{dataIndex:"column_action",isEditable:false,width:50,text:"",isHidden:c.typeOf(this.value)==="typedarray"||y.readOnly,onCellRequest:function(D){if(!D.isHeader){var B=D.cellView.getContent();var A=new h({icon:"plus",displayStyle:"lite"});A.getContent().addClassName("wux-tweakers-array-add-element");A.getContent().setStyle("margin-right","5");A.getContent().addEvent("click",function(E){g.call(y);i.call(y,D.rowID);E.stopPropagation()});A.visibleFlag=D.nodeModel.isSelected();B.setContent(A);D.btnPlus=A;var C=new h({icon:"minus",displayStyle:"lite"});C.getContent().addClassName("wux-tweakers-array-remove-element");C.getContent().addEvent("click",function(E){v.call(y);i.call(y,D.rowID);E.stopPropagation()});C.visibleFlag=D.nodeModel.isSelected();B.addContent(C);D.btnMinus=C}}}],shouldAcceptDrag:function(B){var A=B&&B.nodeModel?B.nodeModel.options.inEdition:false;return !this.readOnly&&c.typeOf(this.value)!=="typedarray"&&!A}};z.onDragOverCell=function(B,A){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}if(A.dropPosition==="middle"){A.dropPosition="top"}A.manager.setDragOverStateForNode(A.nodeModel,A.dropPosition)};z.onDropCell=function(D,B){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}var C=this.unserializeDragAndDropEvent(D);if(C){var A=C.source.uuid;if(this._uxid!==A){return false}}if(B.dropPosition==="middle"){B.dropPosition="top"}y._cellJustDropped=true;return true};z.onDragEnterBlank=function(B,A){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}return true};z.onDropBlank=function(D,B){if(y.readOnly||c.typeOf(y.value)==="typedarray"){return false}var C=this.unserializeDragAndDropEvent(D);if(C){var A=C.source.uuid;if(this._uxid!==A){return false}}y._cellJustDropped=true;return true};z.headersDimensions={width:q+w,height:0};y.editor=new e(z);y._applyLiveChangeFlag();s.addEventOnElement(y,y.editor.getManager(),"click",function(A,B){i.call(y,B?B.data.rowID:null);a.call(y,B,A,"click")});s.addEventOnElement(y,y.editor.getManager(),"dblclick",function(A,B){a.call(y,B,"double click")});s.addEventOnElement(y,y.editor.getManager(),"liveChange",function(A,B){l.call(y,B)});y.editor.getManager().addEventListener("mouseover",function(A,B){i.call(y,B?B.data.rowID:null)});y.editor.getContent().addEventListener("mouseleave",function(A){i.call(y)});y.editor.getContent().addEventListener("keyup",function(D){if(D.keyCode===r.DELETE){if(y.doc&&y.doc.getXSO()){var C=y.doc.getXSO().get();var A=C[0]._getRowID();for(var B=0;B<C.length;B++){y.doc.removeRoot(C[B])}y.doc.getAllDescendants()[A].select()}}});y.editor.getContent().addEventListener("keydown",function(D){if(r.previous(D.keyCode)){var A=y.doc.getXSO().get()[0]._getRowID();var B=y.doc.getAllDescendants()[A-1];if(B){y.doc.getXSO().empty();B.select();var F=y.editor.getManager().nodePositionInVisibleViewport(B);if(F<0){y.editor.getManager().scrollToNode(B,"top")}else{if(F>0){y.editor.getManager().scrollToNode(B,"bottom")}else{y.editor.getManager().updateView()}}}}else{if(r.next(D.keyCode)){var A=y.doc.getXSO().get()[0]._getRowID();var B=y.doc.getAllDescendants()[A+1];if(B){y.doc.getXSO().empty();B.select();var F=y.editor.getManager().nodePositionInVisibleViewport(B);if(F<0){y.editor.getManager().scrollToNode(B,"top")}else{if(F>0){y.editor.getManager().scrollToNode(B,"bottom")}else{y.editor.getManager().updateView()}}}}else{if(D.keyCode===r.F2){var C,E=y.doc.getSelectedNodes();if(E.length===0){return}C=E[0];if(y.itemEditionTrigger!=="in place"){if(!C.options.inEdition){b.call(y,C)}else{m.call(y,C,false,true)}}}}}});y.doc=y.editor.getDocument();y.doc.onNodeModelUpdate(function(A){if(!y._isValueBeingSet){f.call(y)}});y.doc.addModelEventListener("addChild",function(A){if(!y._isValueBeingSet){if(!y._cellJustDropped){b.call(y,A.data.nodeModel)}y._cellJustDropped=false;y._applyDisplayRowIndexes();f.call(y)}});y.doc.addModelEventListener("removeChild",function(A){if(!y._isValueBeingSet){y._applyDisplayRowIndexes();f.call(y)}});y.editor.getContent().addClassName("wux-tweakers-array-editor");y.elements.internalView=c.createElement("div",{"class":"wux-tweakers-array-container"});y.editor.inject(y.elements.internalView);y.elements.internalView.inject(y.elements.container)},_buildEditor:function(x){return new d(x)},_processValueFromString:function(C){var A=this;function B(K){var D,G,F,H;function I(){var O,S,T,M,V,Q,P,N,R,U,L;O="";S=1;T=G[0];M=F[T]||",";P=M!==",";N=M==='"';L=T==="{"||T==="[";V=false;while(!V&&S<=G.length){Q=G.indexOf(M,S)+(P?1:0);O=Q>0?G.slice(0,Q):G;if(L){R=(O.match(new RegExp(T==="["?"\\[":T,"g"))||[]).length;U=(O.match(new RegExp(M==="]"?"\\]":M,"g"))||[]).length}if((!L||R===U)&&(O.length===1||!N||O.slice(-2)[0]!==H)){V=true}S=Q}if(S>0){G=G.slice(S+(P?0:1),G.length)}else{G=""}if(G.startsWith(",")){G=G.slice(1)}if(T==='"'&&M==='"'){O=O.slice(1,-1)}O=O.replace(/\\"/g,'"');return O}D=[];F={'"':'"',"{":"}","[":"]"};H="\\";G=K;while(G&&G.length>0){var J=G.length;var E=I();D.push(E);if(J===G.length){throw new Error("The stringified array value cannot be splited")}}return D}this._isValueBeingSet=true;if(typeof C==="string"){if((this.value===undefined&&(C===""||C==="[]"))||(C===""||C==="[]")){if(this.value){this.value.length=0}this._isValueBeingSet=false;return}var z;if(C.indexOf("[")===0){z=B(C.substring(1,C.length-1))}else{z=B(C)}for(var x=0;x<z.length;x++){if(typeof z[x]==="string"){var y=z[x].replace(/\\"/g,'"');z[x]=k.call(this,this.valueType,y,true)}else{z[x]=k.call(this,this.valueType,z[x],true)}}if(!t.call(this,this.valueType,z)){return}if(Array.isArray(z)){this._processValueFromCopy(z)}}this._isValueBeingSet=false},_processValueFromCopy:function(x){if(c.equals(this.value,x)){return}if(x&&x.length!==0){if(!t.call(this,this.valueType,x)){return}}if(typeof this.value==="undefined"||this.value===null){if(x&&x.length>0){this.value=[]}}if(c.typeOf(x)==="typedarray"){if(c.typeOf(this.value)==="typedarray"){if(x.length===this.value.length){for(var y=0;y<x.length;y++){if(this.value[y]!==x[y]){this.value[y]=x[y]}}}}}else{if(Array.isArray(x)){if(c.typeOf(this.value)==="typedarray"){if(x.length===this.value.length){for(var y=0;y<x.length;y++){if(this.value[y]!==x[y]){this.value[y]=x[y]}}}}else{if(x!==undefined&&this.value!==undefined&&this.value!==null){if(c.typeOf(this.value)!=="typedarray"&&c.typeOf(this.value)!=="array"){this.value=[]}for(var y=0;y<x.length;y++){var z=x[y];if(z!==null){if(y<this.value.length&&this.value[y]!==z){this.value[y]=z}else{if(y>=this.value.length){this.value.push(z)}}}}if(this.value.length>x.length){this.value.splice(x.length,this.value.length-x.length)}}}}}},_copyValueForDialog:function(){if(this.value){return this.value.slice()}else{return undefined}},_placeholderView:function(){var y=this;var x=y.itemEditionTrigger==="in place";if(!y.elements._placeholder){y.elements._placeholder=c.createElement("div",{"class":"wux-tweakers-array-placeholder"});var z=c.createElement("span",{"class":"wux-tweakers-array-placeholder-span"}).inject(y.elements._placeholder);z.setContent("Click here to add items");c.createElement("span",{"class":"wux-tweakers-array-placeholder-icon wux-ui-3ds wux-ui-3ds-list-add wux-ui-3ds-3x"}).inject(y.elements._placeholder);y.elements._placeholder.addEventListener("click",function(B){if(!y.doc){y._buildStdEditor()}y.elements._placeholder.style.display="none";y._lockUI=true;y.doc.empty();y._lockUI=false;var A=new j({grid:{data:k.call(y,y.valueType,(y.valueType==="date"?new Date():""))},inEdition:x});y.doc.addRoot(A);if(y._popup){y._popup.setBody(y.editor)}else{if(y._dialog){y._dialog.content=y.editor}}})}if(y._popup){y._popup.setBody(y.elements._placeholder)}else{if(y._dialog){y._dialog.content=y.elements._placeholder}}y.elements._placeholder.style.display="block"}});function i(B){var A=this;function z(E,D){E.btnMinus.visibleFlag=D;E.btnPlus.visibleFlag=D}function x(D,E){return D&&(D===E||D.nodeModel.isSelected())}function y(G){var E,D,F;if(G===null||!isFinite(G)){return null}E=A.editor.getManager();D=E.getCell(G,"column_action");F=D?D.getView():null;return F?F.getCellInfos():null}var C=y(B);if(A._lastSelectedCellInfos&&!x(A._lastSelectedCellInfos,C)){z(A._lastSelectedCellInfos,false);A._lastSelectedCellInfos=null}if(A._lastHoveredCellInfos&&!x(A._lastHoveredCellInfos,C)){z(A._lastHoveredCellInfos,false);A._lastHoveredCellInfos=null}if(C&&C.btnMinus&&C.btnPlus){z(C,true);if(C.nodeModel.isSelected()){A._lastSelectedCellInfos=C}else{A._lastHoveredCellInfos=C}}}function a(y,x){var z;if(!y){m.call(this,this._currentlyInEdition,false,true);return}z=y.nodeModel;if(!this.readOnly&&this.itemEditionTrigger===x&&z){b.call(this,z)}else{if(this._currentlyInEdition&&this._currentlyInEdition!==z&&y.columnID!==2){m.call(this,this._currentlyInEdition,false,true)}}}function m(z,x,y){if(!z){return}z.options.inEdition=x;z.options.giveFocus=y;this._currentlyInEdition=x?z:null;z.notifyModelUpdate();this.editor.getManager().updateView()}function b(x){if(!this.doc){return}if(this._currentlyInEdition&&x===this._currentlyInEdition){return}this.doc.prepareUpdate();if(this._currentlyInEdition){if(this.itemEditionTrigger==="in place"){this._currentlyInEdition=null}else{m.call(this,this._currentlyInEdition,false,false)}}m.call(this,x,true,true);this.doc.unselectAll();x.select();this.doc.pushUpdate()}function f(){var B=this;if(B.doc!==undefined){var x=B.doc.getRoots();var C=[];for(var z=0;z<x.length;z++){var A=x[z];if(A.options.grid.type!=="addItem"){if(typeof A.options.grid.data==="string"){var y=k.call(B,(B.valueType!=="typedarray"?B.valueType:"number"),A.options.grid.data);if(n.call(B,B.valueType,y)){C.push(y)}else{B._applyValue(B.value);return}}else{if(n.call(B,B.valueType,A.options.grid.data)){C.push(A.options.grid.data)}else{C.push(undefined)}}}}if((B._dialog&&B._dialog.visibleFlag)||(B._popup&&B._popup.visibleFlag)){if(!B._lockUI&&C!==undefined&&JSON.stringify(C)!==JSON.stringify(B._changeOptions)){B.fire("liveChange",C);B._changeOptions=C;B.editor.value=C}}if(!B._dialog||B._dialog&&!B._dialog.visibleFlag){B._processValueFromCopy(C);B._applyValue(B.value)}}}function l(E){var C=this;if(E.cellView._reusableContent){if(C.doc!==undefined){var x=C.doc.getRoots();var D=[];for(var A=0;A<x.length;A++){var B=x[A];if(B.options.grid.type!=="addItem"){if(typeof B.options.grid.data==="string"){var y;if(E.nodeModel===B){y=k.call(C,(C.valueType!=="typedarray"?C.valueType:"number"),E.cellView._reusableContent.value)}else{y=k.call(C,(C.valueType!=="typedarray"?C.valueType:"number"),B.options.grid.data)}if(n.call(C,C.valueType,y)){D.push(y)}else{C._applyValue(C.value);return}}else{if((n.call(C,C.valueType,E.cellView._reusableContent.value))||(n.call(C,C.valueType,B.options.grid.data))){var y;if(E.nodeModel===B){D.push(E.cellView._reusableContent.value)}else{D.push(B.options.grid.data)}}else{D.push(undefined)}}}}if(C._dialog&&C._dialog.visibleFlag||C._popup&&C._popup.visibleFlag){var z=C.editor.value;C.editor.value=D;if(JSON.stringify(z)!==JSON.stringify(C.editor.value)){C.fire("liveChange",C.editor.value)}}}}}function g(){var A=this;var B=new j({grid:{data:k.call(A,A.valueType,(A.valueType==="date"?new Date():""))}});var C=A.doc.getSelectedNodes();if(C.length!==0){var z=C[0];var y=z._getLocalID();var x=A.doc.getNthRoot(y+1);A.doc.insertBefore(B,x)}else{var x=A.doc.getNthRoot(0);A.doc.insertBefore(B,x)}A._applyDisplayRowIndexes()}function v(){var z=this;var x=z.doc.getChildren().length;if(x>1){var A=z.doc.getSelectedNodes();var y=0;if(A.length!==0){y=A[0]._getRowID();z.doc.removeRoot(A[0])}else{y=z.doc.getNthRoot(x-1)._getRowID()+1;z.doc.removeRoot(z.doc.getNthRoot(x-1))}}else{if(x==1){var A=z.doc.getSelectedNodes();(A.length!==0)?z.doc.removeRoot(A[0]):z.doc.removeRoot(z.doc.getNthRoot(x-1));z._placeholderView()}}z._applyDisplayRowIndexes()}function t(B,A){if(A){if(A.length>0){for(var z=0;z<A.length;z++){var y=A[z];if(typeof y==="undefined"){return false}var x=n.call(this,B,y);if(!x){return false}}}else{return false}}return true}function n(x,y){if(y===undefined){return true}if(x==="auto"){x=c.typeOf(y)}return u._isFromType(x,y)}function k(y,z,x){switch(y){case"auto":if(c.typeOf(z)==="string"){try{parsedValue=JSON.parse(z);return parsedValue}catch(A){return z}}return z;default:return u._getValueFromString(y,z,x)}}return d});define("DS/Tweakers/TweakerObjectBase",["UWA/Core","DS/Tweakers/TweakerMultiRep","DS/Controls/Button","DS/Tree/TreeListView","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/TreeModel/TreeDocument","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/ModelProxy","DS/Utilities/DocUtils","DS/Utilities/Utils","DS/Controls/TooltipModel","DS/Tweakers/CustomTreeNodeViewTweaker","DS/Tweakers/TweakerUtils"],function(e,d,i,g,f,n,b,c,p,q,j,h,o,m){function l(r){if(r){var s=r.options.grid;var t=!r._isTrueRoot();r.prepareUpdate();r.addChild(new f({label:"Add property to <b>"+(t?s.name:"current object")+"</b>",temporary:true}));if(!r.isExpanded()){r.expand()}r.pushUpdate()}}function a(w){var u=this;if(w){var t=w.getChildren()?w.getLastChild():null;var r=w.options.grid;var s=t&&t.options.temporary;var v=w._isTrueRoot()?u.value:r.data;if(r.type==="object"||typeof v==="object"){if(!s){l(w,{data:v})}}else{if(s){w.prepareUpdate();t.remove();w.pushUpdate()}}}}var k=d.inherit({name:"tweakerObjectBase",doc:undefined,publishedProperties:{editorTitle:{defaultValue:"Object Editor",type:"string",category:"Appearance"},hierarchyCriteria:{defaultValue:"category",type:"string",category:"Behavior"},configuration:{defaultValue:undefined,type:"objet",category:"Behavior"},recursionDepth:{defaultValue:0,type:"integer",category:"Behavior"},permanentReadOnly:{defaultValue:true,type:"boolean",category:"Behavior"},uiOptions:{defaultValue:{height:"inherit",maxHeight:"100%"},type:"object",category:"Appearance"},labelDisplay:{defaultValue:"left",type:"string",category:"Appearance"},failureCapture:{defaultValue:true,type:"boolean",category:"Behavior"},onFailure:{defaultValue:undefined,type:"function",category:"Behavior"},displayMode:{defaultValue:"twoColumns",type:"string",category:"Appearance"},authoringFlag:{defaultValue:false,type:"boolean",category:"Behavior"},authoringFilters:{defaultValue:undefined,type:"object",category:"Behavior"},typeDisplayFlag:{defaultValue:false,type:"boolean",category:"Appearance"}},buildView:function(){if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-object")}if(!this.dialogOptions.title){this.dialogOptions.title=this.editorTitle}},buildPropertyList:function(){return[]},_applyHierarchyCriteria:function(){this._applyValue()},_applyRecursionDepth:function(){this._applyValue()},_applyConfiguration:function(r){if(!this.configuration){this.configuration={}}else{if(!(j.isObjectEmpty(this.configuration)&&!r)){this._applyValue()}}},_applyProperties:function(r){this._parent(r);if(this.isDirty("labelDisplay")){this._applyLabelDisplay()}if(this.isDirty("displayMode")){this._applyDisplayMode()}if(this.isDirty("configuration")){this._applyConfiguration()}this._applyLiveChangeFlag()},_applyValueStd:function(s){function t(v){for(var w=0;w<v.length;w++){var z=v[w];var x=z.name||z;var y=(z.referenceValue!=undefined?z.referenceValue:z.defaultValue);if(y===undefined||y===null){if(z.type){switch(z.type){case"string":y="";break;case"number":y=0;break}}}if(typeof v[w]==="string"){v[w]={name:v[w]}}v[w].data=y;if(v[w].properties){t(v[w].properties)}}}var u=this;if(u.doc&&!u._preventEditorRefresh){u.doc.prepareUpdate();u.doc.empty();var r=u.buildPropertyList();t(r);if(u.hierarchyCriteria){p.modelToTreeDocument.call(u.doc,p.hierarchyFilter.call(r,{criteria:u.hierarchyCriteria}),"hierarchical","name");if(u.hierarchyCriteria!=="flat"){u.doc.expandNLevels({numberOfLevelsToExpand:0})}if(u.authoringFlag){u._applyAuthoringFlag()}}else{p.modelToTreeDocument.call(u.doc,r,"flat","name")}u.doc.pushUpdate()}},_processValueFromString:function(t){try{if(t){var s=JSON.parse(t);if(this.authoringFlag||j.arePrototypesEqual(this.value,s)){this.value=JSON.parse(t)}}}catch(r){this.value=undefined}},_createFlattenedObject:function(u){var r={};var t=this.buildPropertyList(u);for(var s=0;s<t.length;s++){r[t[s].name]=u&&typeof u==="object"?u[t[s].name]:undefined}return r},_copyValueForDialog:function(){if(this.value){return JSON.parse(JSON.stringify(this.value))}else{return undefined}},_buildInlineEditor:function(){this._parent();this.elements.internalView.addClassName("wux-tweakers-object-inline-editor")},onPostUpdateView:function(s){if(this.editor){var r=this.editor.getManager();if(r){return r.onPostUpdateView(s)}}},onPostUpdateViewOnce:function(s){if(this.editor){var r=this.editor.getManager();if(r){return r.onPostUpdateViewOnce(s)}}},_applyValueInline:function(){if(!this.internalTweakerString){this._buildInlineEditor()}if(this.internalTweakerString){try{this.internalTweakerString.value=JSON.stringify(this.value)}catch(r){this.internalTweakerString.value=""}}if(this.editor&&!e.equals(this.value,this.editor.value)){this.editor._isValueBeingSet=true;if(this.augmentedDisplay==="dialog"){this.editor.value=this._copyValueForDialog()}else{this.editor.value=this.value}}},_handleEvents:function(){var r=this;this.getContent().addEventListener("liveChange",function(s){if(r._changeOptions){s.options=r._changeOptions}});this.getContent().addEventListener("change",function(s){if(r.internalTweakerString){r._applyValueInline()}if(r._changeOptions){s.options=r._changeOptions}})},_applyLabelDisplay:function(){if(this.editor){if(this.customTreeNodeView){this.customTreeNodeView.labelDisplay=this.authoringFlag?"left":this.labelDisplay}this.editor.getManager().updateView(true)}},_applyLiveChangeFlag:function(){if(this.editor&&this.liveChangeFlag){m.enableLiveChangeOnTreeListView(this.editor)}},_applyTypeDisplayFlag:function(){var s=this;if(!s.editor){return}var r=s.editor.getManager();r.prepareUpdateView();if(s.displayStyle==="std"&&!s.authoringFlag){if(s.typeDisplayFlag){if(this.displayMode==="twoColumns"){r.showColumn("tweakerType");r.setColumnOptions("tree",{width:"30%"});r.setColumnOptions("tweakerType",{width:"10%"});r.setColumnOptions("data",{width:"60%"})}else{if(this.displayMode==="oneColumn"){r.hideColumn("tweakerType");r.setColumnOptions("data",{width:"100%"})}else{}}}else{r.hideColumn("tweakerType");if(this.displayMode==="twoColumns"){r.setColumnOptions("tree",{width:"40%"});r.setColumnOptions("data",{width:"60%"})}else{if(this.displayMode==="oneColumn"){r.setColumnOptions("data",{width:"100%"})}else{}}}}r.pushUpdateView(true)},_applyDisplayMode:function(){function s(u,t){t=t||{};u.setOption("defaultCellHeight",t.cellHeight||38);u.setColumnOptions("tree",{width:t.widthTree||"40%"});u.setColumnOptions("data",{width:t.widthTweaker||"53%"});u._needToIndexRowsPosition()}if(!this.editor){return}var r=this.editor.getManager();r.prepareUpdateView();if(this.displayStyle==="std"){if(this.customTreeNodeView){this.customTreeNodeView.displayMode=this.displayMode}if(this.displayMode==="oneColumn"){s(r,{cellHeight:60,widthTree:"0%",widthTweaker:"100%"});r.hideColumn("tree");r.hideColumn("tweakerType");r.setColumnOptions("data")}else{if(this.typeDisplayFlag&&!this.authoringFlag){s(r,{widthTree:"30%"});r.showColumn("tweakerType")}else{s(r)}r.showColumn("tree")}}r.pushUpdateView(true)},_applyAuthoringFlag:function(){var s=this;if(s.displayStyle!=="inline"){if(!s.editor){return}var r=s.editor.getManager();r.prepareUpdateView();if(s.customTreeNodeView){s.customTreeNodeView.labelDisplay=s.authoringFlag?"left":s.labelDisplay}s.doc.prepareUpdate();if(s.authoringFlag){r.showColumn("remove");r.showColumn("type");r.hideColumn("tweakerType");r.setColumnOptions("data",{width:"25%"});s.doc.getAllDescendants().forEach(function(t){a.call(s,t)});a.call(s,s.doc._getTrueRoot());s._initTypeRepForProp()}else{r.hideColumn("remove");r.hideColumn("type");if(s.typeDisplayFlag&&s.displayMode==="twoColumns"){r.setColumnOptions("tweakerType",{width:"15%"});r.showColumn("tweakerType")}else{if(s.displayMode==="oneColumn"){r.setColumnOptions("data",{width:"100%"})}else{r.setColumnOptions("data",{width:"53%"})}}s.doc.getAllDescendants().forEach(function(t){if(t.options.temporary){t.remove()}})}s.doc.pushUpdate();r.pushUpdateView()}else{if(s.editor){s.editor.authoringFlag=s.authoringFlag}}},_checkAuthoringFilters:function(){if(this.authoringFilters){for(var s in this.authoringFilters){if(this.authoringFilters[s].types){for(var r in this.authoringFilters[s].types){if(!WUX.typeRepFactory.IsRegisterTypeRepresentations(this.authoringFilters[s].types[r])){console.warn("[WEBUX][TweakerObjectBase] The required type representation ("+this.authoringFilters[s].types[r]+") is not registered in the TypeRepresentationFactory. The field will not be added.");delete this.authoringFilters[s].types[r]}}}else{console.warn("[WEBUX][TweakerObjectBase] No type defined for the authoring filter ("+s+").")}}}},_initTypeRepForProp:function(){var r=this;this._filterForProp={};if(this.doc){this.doc.getAllDescendants().forEach(function(t){var D=t.options.grid;WUX.typeRepFactory=new c();var u="filteredType"+D.path;u=u.split(".").join("_");WUX.typeRepFactory.typeEnums.customAllSupportedTypes=undefined;r._checkAuthoringFilters();if(!r.configuration[D.path]||!r.configuration[D.path].authoringFilters){if(r.authoringFilters&&r.authoringFilters.allSupportedTypes){function s(){var L=[];for(var K in r.authoringFilters){if(K==="allSupportedTypes"){for(var J in r.authoringFilters[K].types){L.push(r.authoringFilters[K].types[J])}}}return L.sort(function(N,M){return N.toLowerCase().localeCompare(M.toLowerCase())})}if(r.authoringFilters.allSupportedTypes.defaultType!==undefined){D.defaultType=r.authoringFilters.allSupportedTypes.defaultType}if(r.authoringFilters.allSupportedTypes.defaultValue!==undefined){D.defaultValue=r.authoringFilters.allSupportedTypes.defaultValue}WUX.typeRepFactory.registerEnum("customAllSupportedTypes",s);var I=WUX.typeRepFactory.registerTypeRepresentations({customAllSupportedTypes:{stdTemplate:"enumSearchableCombo"}})}if(r._filterForProp&&!r._filterForProp[u]){var w="allSupportedTypes";if(WUX.typeRepFactory.typeEnums.customAllSupportedTypes!==undefined){w="customAllSupportedTypes"}var H=WUX.typeRepFactory._getTypeData(r.valueType+"."+D.path).realType||"default";var C=D.type?D.type:(r.authoringFilters&&r.authoringFilters.allSupportedTypes&&r.authoringFilters.allSupportedTypes["defaultType"])?r.authoringFilters.allSupportedTypes["defaultType"]:H;WUX.typeRepFactory.generateView(C,{typePath:w,context:"inlinedTemplate",onViewCreated:function(J){if(J!==undefined){r._filterForProp[u]=J}}})}}else{if(r.configuration[D.path]&&r.configuration[D.path].authoringFilters){if(!Array.isArray(r.configuration[D.path].authoringFilters)){r.configuration[D.path].authoringFilters=[r.configuration[D.path].authoringFilters]}var B=0;var G;var A=r.configuration[D.path].authoringFilters[B];G=function s(){var L=[];for(var K in r.authoringFilters){for(B=0;B<r.configuration[D.path].authoringFilters.length;B++){if(K===r.configuration[D.path].authoringFilters[B]){for(var J in r.authoringFilters[K].types){L.push(r.authoringFilters[K].types[J])}}}}return L.sort(function(N,M){return N.toLowerCase().localeCompare(M.toLowerCase())})};WUX.typeRepFactory.registerEnum(u,G);var z={};z[u]={stdTemplate:"enumSearchableCombo"};var I=WUX.typeRepFactory.registerTypeRepresentations(z);if(r._filterForProp&&!r._filterForProp[u]){var E="default";var F;var y=0;if(D.authoringFilters instanceof Array){for(var x=0;x<D.authoringFilters.length;x++){var v=D.authoringFilters[x];if(r.authoringFilters[v].defaultType&&r.authoringFilters[v].defaultTypeWeight){if(r.authoringFilters[v].defaultTypeWeight>y){E=r.authoringFilters[v].defaultType;y=r.authoringFilters[v].defaultTypeWeight;if(r.authoringFilters[v].defaultValue){F=r.authoringFilters[v].defaultValue}}}else{if(r.authoringFilters[v].defaultType&&y===0){E=r.authoringFilters[v].defaultType;if(r.authoringFilters[v].defaultValue){F=r.authoringFilters[v].defaultValue}}}}}else{if(typeof D.authoringFilters==="string"){if(r.authoringFilters[D.authoringFilters].defaultType!==undefined){E=r.authoringFilters[D.authoringFilters].defaultType}if(r.authoringFilters[D.authoringFilters].defaultValue!==undefined){F=r.authoringFilters[D.authoringFilters].defaultValue}}}if(E!=="default"){D.defaultType=E}if(F!==undefined){D.defaultValue=F}WUX.typeRepFactory.generateView(D.type?D.type:E,{typePath:u,context:"inlinedTemplate",onViewCreated:function(J){if(J!==undefined){r._filterForProp[u]=J}}})}}}})}},_buildStdEditor:function(){var t=this;var u=window.location.pathname.indexOf("WUXPortalUI");t._portalTweaker=u>=0;t.doc=new b({shouldAcceptDrag:function(w){return false}});if(!t.configuration){t.configuration={}}t.customTreeNodeView=new o(t);var v=e.clone(this.uiOptions);if(v.height==="auto"){v.height="inherit"}else{if(v.height==="inherit"){v.height="auto"}}var s=e.merge(t.customTreeNodeView.treeOptions,v);s.performances.resizeDebounceTimeout=500;t.editor=new g(s);var r=t.editor.getManager();if(t.liveChangeFlag){m.enableLiveChangeOnTreeListView(t.editor)}r.onNodeClick(function(w){if(w.dataIndex==="tree"&&!t.authoringFlag){var x=w.cellView.getCellInfos().nodeModel;if(x.isExpanded()){x.collapse()}else{x.expand()}}});t.doc.onNodeModelUpdate(function(z){if(z.target){var A=z.target.options.grid.name;var w=z.target.options.grid.path;var C=(z.target.options.grid.data===undefined&&z.target.options.grid.defaultValue!==undefined)?z.target.options.grid.defaultValue:z.target.options.grid.data;if(t.onNodeUpdate){var B=!z.target.getParent();var x=j.getObjectPropertyInfo(t.value,w).value;var y=t.onNodeUpdate(A,w,C,{removed:B});if(t.authoringFlag&&((typeof C==="object"&&x!==C)||(typeof x==="object"&&typeof C!=="object")||(C===undefined))){t._applyValueStd()}else{t.customTreeNodeView.updateNodeParent(z.target,r);t.customTreeNodeView.updateNodeChildren(z.target,r,t.value)}t._changeOptions={propertyChangePath:w,propertyChangeName:A,propertyChangeValue:C}}}});t.editor.getContent().addClassName("wux-tweakers-object-editor-full");t.elements.internalView=e.createElement("div",{"class":"wux-tweakers-object-container-full"});t.editor.inject(t.elements.internalView);t.elements.internalView.inject(t.elements.container);r.setColumnOptions("remove",{dataIndex:"remove",isEditable:false,width:30,text:"Remove",isHidden:true,onCellRequest:function(z){var A=z.nodeModel;var w=A.options.grid;if(!z.isHeader&&!A.options.temporary){var y=z.cellView.getContent();var x=new i({icon:"close",displayStyle:"lite",tooltipInfos:new h({shortHelp:"Remove this property"})});x.getContent().addEvent("click",function(){if(t.value&&w.path){var B=w.path;var E=B.split(".");var F=E[E.length-1];for(var C in t.configuration){if(t.configuration.hasOwnProperty(C)&&C.startsWith(B)){delete t.configuration[C]}}A.prepareUpdate();var D=j.removeObjectProperty(t.value,B);if(D){A.remove()}A.pushUpdate();t.fire("change",{propertyChangeName:F,propertyChangePath:B})}});y.setContent(x);z.removeButton=x}}});r.setColumnOptions("tweakerType",{dataIndex:"tweakerType",isEditable:false,width:"auto",text:"TweakerType",isHidden:true,onCellRequest:function(w){var x=t._getTweakerTypeFromCellInfos(w);w.cellView.getContent().setText(x)}});r.setColumnOptions("data",{dataIndex:"data",text:"Value",isEditable:true,width:"auto",onCellRequest:function(y){if(!y.isHeader&&y.nodeModel&&y.nodeModel.options&&!y.nodeModel.options.temporary){var w=m._setModelViewForDataColumnOneColumnCase(t,y);var x=y.nodeModel.options.grid;if(WUX.typeRepFactory!==undefined&&!x._buildFailure){WUX.typeRepFactory.generateView(w.data,w.generateViewOptions)}else{WUX.typeRepFactory=new c();WUX.typeRepFactory.onReady=function(){WUX.typeRepFactory.generateView(w.data,w.generateViewOptions)}}}},});r.setColumnOptions("type",{dataIndex:"type",isEditable:false,width:"auto",text:"Type",isHidden:true,onCellRequest:function(y){if(!y.isHeader&&!y.nodeModel.options.temporary){if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}var w="filteredType"+y.nodeModel.options.grid.path;w=w.split(".").join("_");if(t._filterForProp&&t._filterForProp[w]){y.cellView.getContent().setContent(t._filterForProp[w])}else{var x="allSupportedTypes";if(WUX.typeRepFactory.typeEnums.customAllSupportedTypes!==undefined){x="customAllSupportedTypes"}WUX.typeRepFactory.generateView(y.nodeModel.options.grid.type||"default",{typePath:x,context:"inlinedTemplate",onViewCreated:function(z){if(z!==undefined){if(t._filterForProp){t._filterForProp[w]=z;y.cellView.getContent().setContent(t._filterForProp[w])}}}})}}},onCellChange:function(w){if(w.event&&w.event.dsModel){return w.event.dsModel.value}},setValue:function(z){var A=z.nodeModel;var x=A.options.grid;if(z.value==="default"||z.value==="defaultRep"||z.value==="uwaObject"){x.type=undefined;if(t.configuration[x.path]){t.configuration[x.path].type=undefined}}else{x.type=z.value;if(!t.configuration[x.path]){t.configuration[x.path]={}}t.configuration[x.path].type=z.value}var w=r.getCell(z.rowID,"data");if(w){var y=w.getView();if(y){y.updateView()}}a.call(t,A)},getValue:function(w){return w.nodeModel.options.grid.type}});r.setColumnOptions("tree",{onCellRequest:function(C){if(!C.isHeader){var B=C.cellView;var D=C.nodeModel;if(D){if(t.editor.options.shouldDisplayTooltip===undefined){B.getContent().setAttribute("title",D.getLabel())}if(t.authoringFlag){var x=B.elements.labelContainer;var z=D.options;var y=z.grid;x.style.display="inline-block";if(!z.temporary){if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}WUX.typeRepFactory.generateView(y.name,{typePath:"string",context:"inlinedTemplate",onViewCreated:function(E){if(E!==undefined){x.setContent(E)}}})}else{var A=new i({icon:"plus",label:z.label,allowUnsafeHTMLLabel:true,displayStyle:"lite",tooltipInfos:new h({shortHelp:"Add a new property"})});A.onClick=function w(){var I=D.getParent();var M=I.options.grid.data;var F=I.options.grid.path||"";var N=(t.authoringFilters&&t.authoringFilters.allSupportedTypes&&t.authoringFilters.allSupportedTypes.defaultType!==undefined)?t.authoringFilters.allSupportedTypes.defaultType:"default";var G=I.options.grid.name||"";if(typeof M!=="object"||M===undefined){if(G.length>0){M={};I.prepareUpdate();I.options.grid.data=M;I.pushUpdate();j.setObjectProperty(t.value,F,M)}else{M=t.value}}if(I&&M!==undefined){var H,E,L,K="NewProp",J=1;if(M.hasOwnProperty(K)){do{L=K+"_"+J;J++}while(M.hasOwnProperty(L));K=L}H=F+(F.length>0?".":"")+K;E=(t.authoringFilters&&t.authoringFilters.allSupportedTypes&&t.authoringFilters.allSupportedTypes.defaultValue!==undefined)?t.authoringFilters.allSupportedTypes.defaultValue:undefined;var O=t.getPropertyDefinition({propPath:H,propName:K,propValue:E});O.data=E;O.type=N;I.prepareUpdate();D.updateOptions({temporary:false,label:K,grid:O});j.addObjectProperty(t.value,H,E);a.call(t,I||t.doc._getTrueRoot());I.pushUpdate();t.fire("change",{propertyChangeName:K,propertyChangePath:H})}};x.setContent(A);C.addButton=A}}else{B.setLabel(D.getLabel())}B.setIcons(D.getIcons());B.setBadges(D.getBadges());B._setExpanderState(D._expandState);B._setDepth(D._nodeDepth);C.cellView.elements.container.setContent(C.cellView.elements.layout)}}},onCellChange:function(C){var x=C.event?C.event.dsModel:null;var y=C.nodeModel.options.grid;if(x){var D=y.path;var B=D.split(".");var z=B[B.length-1];var w=x.value;var A="";if(B.length>1){A+=D.substr(0,D.length-z.length)}A+=w;if(t.value&&w.length>0&&A&&!j.isPropertyInObject(t.value,A)){return{name:w,path:A}}else{x.value=z;return{name:z,path:D}}}return null},setValue:function(D){function z(F){if(F&&!F.options.temporary){if(F.options.grid.path.substr(0,w.length)===w){F.prepareUpdate();F.options.grid.path=A+F.options.grid.path.substr(w.length);F.pushUpdate()}F.getAllDescendants().forEach(function(G){z(G)})}}var x=D.nodeModel;var y=x.options.grid;var C=D.value.name;var A=D.value.path;var w=y.path;if(A!==w){t.doc.prepareUpdate();z(x);for(var E in t.configuration){if(t.configuration.hasOwnProperty(E)&&E.startsWith(w)){var B=A+E.substr(w.length);t.configuration[B]=t.configuration[E];delete t.configuration[E]}}x.prepareUpdate();x.options.label=y.name=C;j.removeObjectProperty(t.value,w);j.addObjectProperty(t.value,A,y.data);t.customTreeNodeView.updateNodeParent(x,r);x.pushUpdate();t.doc.pushUpdate()}}});if(t.authoringFlag){t._applyAuthoringFlag()}t._applyDisplayMode();t._applyTypeDisplayFlag()},_getTweakerTypeFromCellInfos:function(y){var x=this;var z=undefined;var s=y.nodeModel;var v=s.options.grid;var u=v.data;var r="filteredType"+v.path;r=r.split(".").join("_");var t="allSupportedTypes";if(x.authoringFilters&&x.configuration&&x.configuration[v.path]&&x.configuration[v.path].authoringFilters){if(!Array.isArray(x.configuration[v.path].authoringFilters)){x.configuration[v.path].authoringFilters=[x.configuration[v.path].authoringFilters]}if(x.configuration[v.path].authoringFilters[0]){t=x.configuration[v.path].authoringFilters[0]}}if(WUX.typeRepFactory===undefined){WUX.typeRepFactory=new c()}var w=WUX.typeRepFactory._getTypeData(x.valueType+"."+v.path).realType;if(x._filterForProp&&x._filterForProp[r]){z=x._filterForProp[r].value}else{if(x.authoringFilters&&x.authoringFilters[t]&&x.authoringFilters[t].defaultType in x.authoringFilters[t]["types"]){z=x.authoringFilters[t].defaultType}else{if(w!==""&&w!==undefined){z=w}else{if(x.configuration&&x.configuration[v.path]){z=x.configuration[v.path].type}else{}}}}if(!z){z=e.typeOf(u)}return z}});return k});define("DS/Tweakers/TweakerWUXAbstract",["UWA/Core","DS/Tweakers/TweakerObjectBase"],function(c,b){var a=b.inherit({name:"tweakerWUXAbstract",doc:undefined,publishedProperties:{},buildView:function(){this._parent()},buildPropertyList:function(){if(this.value){var d=[];for(var f in this.value.publishedProperties){var e=this.value;do{e=Object.getPrototypeOf(e)}while(!e.hasOwnProperty(f));var g=this.value.publishedProperties[f];if(g.uiDisplay!==false){d.push({name:f,className:e.name,referenceValue:this.value[f],defaultValue:g.defaultValue,type:g.type,category:g.category,readOnly:g.readOnly,touchMode:this.value.touchMode})}}return d}else{return[]}},onNodeUpdate:function(f,d,g){if(c.typeOf(this.value[f])==="array"||c.typeOf(this.value[f])==="object"){if(JSON.stringify(this.value[f])!==JSON.stringify(g)){this.value[f]=g;this.fire("change")}else{var e="_apply"+f.substring(0,1).toUpperCase()+f.substring(1,f.length);(this.value[e])?this.value[e]():this.value._applyProperties()}}if(c.equals(this.value[f],g)===false){this.value[f]=g;this.fire("change")}else{if(c.typeOf(this.value[f])==="object"||c.typeOf(this.value[f])==="array"){var e="_apply"+f.substring(0,1).toUpperCase()+f.substring(1,f.length);(this.value[e])?this.value[e]():this.value._applyProperties()}}}});return a});define("DS/Core/ModelEvents",["DS/CoreEvents/ModelEvents"],function(a){console.log("Please, now use DS/CoreEvents/ModelEvents instead of DS/Core/ModelEvents");return a});define("DS/Tweakers/TweakerObject",["UWA/Core","DS/Tweakers/TweakerObjectBase","DS/Utilities/Utils","DS/Utilities/Array"],function(d,h,g,i){function c(j){j=j||{};if(this.filter.parameters.displayFunctions){return true}if(this.configuration&&this.configuration[j.propName]&&this.configuration[j.propName].type){return(this.configuration[j.propName].type!=="function")}return typeof(j.propValue)!=="function"}function f(k){k=k||{};for(var j=0;j<this.filter.parameters.exceptions.length;j++){if(this.filter.parameters.exceptions[j]===k.propName){return !k.isAllExcept}}return k.isAllExcept}function b(j){j=j||{};if(new RegExp("^__").test(j.propName)||j.propName==="constructor"){return -1}if(this.configuration&&this.configuration[j.propPath]&&this.configuration[j.propPath].uiDisplay!==undefined){return this.configuration[j.propPath].uiDisplay?1:-1}if(this.filter.parameters.matchingRegexp&&!(new RegExp(this.filter.parameters.matchingRegexp).test(j.propName))){return -1}return 0}function a(m){var j=m;if(typeof m!=="object"||m===null||m===undefined){return false}var l=Object.getPrototypeOf(m);if(!l){return false}var k=Object.getPrototypeOf(l);return !(l&&k&&(l!==k))}var e=h.inherit({name:"tweakerObject",doc:undefined,publishedProperties:{filter:{type:"object",defaultValue:{mode:"standard",parameters:{matchingRegexp:"",displayFunctions:true,displayChainOfPrototypes:false}}}},buildView:function(){this._parent()},_applyFilter:function(){this._applyValue()},buildPropertyList:function(){function m(y,z,w,u){var x=y;do{var v=Object.getOwnPropertyNames(x);v.forEach(function(C){var B=(w&&u)?u+"."+C:C;var A=o._treatProperty({propName:C,propPath:B,propValue:x[C]});if(A&&a(x[C])&&z!==o.recursionDepth){m(x[C],z+1,A,B)}if(w){w.properties=w.properties||[];w.properties=w.properties.concat(A)}else{q=q.concat(A)}if(A&&A.name){l[B]=true}});x=Object.getPrototypeOf(x)}while(j&&x)}var o,q,l,j;o=this;l={};q=[];if(this.value!==undefined&&this.value!==null){if(typeof(this.filter.mode)==="string"){j=true;if(this.filter.mode==="standard"){j=this.filter.parameters.displayChainOfPrototypes}m(this.value,0)}if(typeof(this.filter.mode)==="function"){return this.filter.mode.call(this)}}if(o.configuration&&(this.value===undefined||a(this.value))){var t=d.clone(this.value)||{};for(var s in o.configuration){if(l[s]){break}var r=s.split(".");var k=t;for(var n=0;n<r.length;n++){var p=r[n];if(n<r.length-1){if(k[p]===undefined||k[p]===null||typeof k[p]!=="object"){k[p]={}}}else{k[p]=undefined}k=k[p]}}i.clear(q);m(t,0)}return q},_buildEditor:function(j){this._parent(j);j.value=this._createFlattenedObject(j.value);j.authoringFlag=this.authoringFlag;if(j.authoringFlag){j.readOnly=false}j.recursionDepth=this.recursionDepth;j.configuration=this.configuration;j.typeDisplayFlag=this.typeDisplayFlag;if(this.value===undefined&&j.value!==undefined&&Object.keys(j.value).length!==0){this._lockUI=true;this.value=this._createFlattenedObject(j.value);this._lockUI=false}j.authoringFilters=this.authoringFilters;return new e(j)},_applyProperties:function(j){this._parent(j)},getStringFromValue:function(l){var j="{/n";for(var k in l){j=j+k+": "+l[k]+"/n"}j=j+"}";return j},_treatProperty:function(j){j=j||{};j.propPath=j.propPath||j.propName;j.filterMode=this.filter.mode;if(this.isPropertyValidWithMode(j)){return this.getPropertyDefinition(j)}return[]},isPropertyValidWithMode:function(k){k=k||{};k.propPath=k.propPath||k.propName;var j=b.call(this,k);if(j!==0){return j>0}switch(k.filterMode){case"standard":return c.call(this,k);break;case"noneExcept":k.isAllExcept=false;return f.call(this,k);break;case"allExcept":k.isAllExcept=true;return f.call(this,k);break;default:return[];break}},getPropertyDefinition:function(j){j=j||{};j.propPath=j.propPath||j.propName;var k={name:j.propName,path:j.propPath,referenceValue:j.propValue,touchMode:j.touchMode};if(this.configuration&&this.configuration[j.propPath]){k=d.merge(k,this.configuration[j.propPath])}return k},onNodeUpdate:function(l,j,m,k){if(j!==undefined&&j!==null){this._preventEditorRefresh=true;if(k&&k.removed){g.removeObjectProperty(this.value,j)}else{if(!g.setObjectProperty(this.value,j,m)){if(this.value===undefined){this.value={}}g.addObjectProperty(this.value,j,m)}}this._preventEditorRefresh=false;m=this.value;return m}}});return e});define("DS/Tweakers/TweakerUWAObject",["UWA/Core","DS/Tweakers/TweakerObject"],function(c,a){var b=a.inherit({name:"tweakerUWAObject",doc:undefined,publishedProperties:{},buildView:function(){this._parent()},buildPropertyList:function(){if(this.value!==undefined&&this.value!==null){if(this.filter.mode==="onlyOptions"){return this._treatProperty({propName:"options",propValue:this.value.options})}}return this._parent()},_treatProperty:function(d){d=d||{};if(d.propName==="options"&&typeof(d.propValue)==="object"){var e=[];var g=this;var f=Object.getOwnPropertyNames(d.propValue);f.forEach(function(h){e=e.concat(g._treatProperty({propName:h,propValue:d.propValue[h]}))});return e}else{return this._parent(d)}},isPropertyValidWithMode:function(d){if(d.propName==="defaultOptions"||d.propName==="elements"){return false}if(d.filterMode==="onlyOptions"){d.filterMode="standard";return this._parent(d)}return this._parent(d)},onNodeUpdate:function(e,d,f){if(this.value[e]!==undefined){if(c.equals(this.value[e],f)===false){this.value[e]=f;this.fire("change")}}else{if(c.equals(this.value.options[e],f)===false){this.value.options[e]=f;this.fire("change")}}}});return b});define("DS/UIBehaviors/Kinetic",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","UWA/Class","DS/Core/ModelEvents","DS/Core/PointerEvents"],function(g,k,i,c,a,b,h){var j=false;var d=10;function m(o,n){if(o===undefined){o={x:0,y:0}}if(n===undefined){n={x:0,y:0}}return{x:o.x-n.x,y:o.y-n.y}}function l(o,n){return{x:o.x+n.x,y:o.y+n.y}}function f(){return{x:0,y:0}}var e=a.extend({defaultOptions:{scrollX:true,scrollY:true,snap:true,viewport:null,range:{xMin:0,xMax:10000,yMin:0,yMax:10000,},sideBorderSize:30,duration:100,viscosity:0.2},init:function(n){this.options=g.extend(this.defaultOptions,n);this._parent(n);this._view,this._min,this._max,this._offset,this._initialPosition,this._pressed,this._xform,this._velocity=f(),this._frame=f(),this._timestamp,this._ticker,this._amplitude=f(),this._target=f(),this._timeConstant=f(),this._snap;this._isFromBorder=null;this._view=this.options.target;this._max=parseInt(getComputedStyle(this._view).height,10)-innerHeight;this._offset=this._min=f();this._pressed=false;this._timeConstant=this.options.duration;this._x=0;this._y=0;this._px=0;this._py=0;var o=this;this._xform="transform";["webkit","Moz","O","ms"].every(function(p){var q=p+"Transform";if(typeof o._view.style[q]!=="undefined"){o._xform=q;return false}return true});this._modelEvents=new b();this._buildTouchBorders();this._bindEvents()},_buildTouchBorders:function(){var n=this;this.elements={};this.elements.leftBorder=new g.Element("div",{styles:{position:"absolute",height:"100%",width:this.options.sideBorderSize,background:j?"rgba(0,125,0,0.3)":"",top:0}}).inject(this._view);this.elements.leftBorder.addEvent(h.POINTERUP,function(o){this.setStyles({width:n.options.sideBorderSize})});this.elements.leftBorder.addEvent(h.POINTERDOWN,function(o){this.setStyles({width:"100%"})});this.elements.rightBorder=new g.Element("div",{styles:{position:"absolute",height:"100%",width:this.options.sideBorderSize,background:j?"rgba(125,0,0,0.3)":"",top:0,right:0}}).inject(this._view);this.elements.rightBorder.addEvent(h.POINTERUP,function(o){this.setStyles({width:n.options.sideBorderSize});this._isFromBorder="right"});this.elements.rightBorder.addEvent(h.POINTERDOWN,function(o){this.setStyles({width:"100%"});this._isFromBorder="left"})},_bindEvents:function(){if(typeof window.ontouchstart!=="undefined"){this._view.addEventListener("touchstart",this._start.bind(this));this._view.addEventListener("touchmove",this.drag.bind(this));this._view.addEventListener("touchcancel",this._stop.bind(this));this._view.addEventListener("touchend",this._stop.bind(this))}this._view.addEventListener("mousedown",this._start.bind(this));this._view.addEventListener("mousemove",this.drag.bind(this));this._view.addEventListener("mouseleave",this._stop.bind(this));this._view.addEventListener("mouseup",this._stop.bind(this))},onAnimationEnd:function(n){return this._modelEvents.subscribe({event:"ANIMATION_END"},n)},onRelease:function(n){return this._modelEvents.subscribe({event:"_stop"},n)},_getPointerPosition:function(n){if(n.targetTouches&&(n.targetTouches.length>=1)){return{x:n.targetTouches[0].clientX,y:n.targetTouches[0].clientY}}return{x:n.clientX,y:n.clientY}},_registerPosition:function(n){if(this._offset&&this._snap){this._forceBeginPos={x:parseInt(n,10)/100*this._snap.x,y:0}}},_disableInteractions:function(){this._view.setStyles({pointerEvents:"none",background:"red"})},_enableInteractions:function(){this._view.setStyles({pointerEvents:"auto"})},getPosition:function(){return this._offset},getFinalPosition:function(){return this._target},getPositionPercent:function(){return this._offsetPercent},getFinalPositionPercent:function(){return{x:Math.min(Math.max((this._target.x/this._snap.x*100),this._min.x),this._max.x),y:Math.min(Math.max((this._target.y/this._snap.y*100),this._min.y),this._max.y)}},_observeParameters:function(){var p,n,u,s,q;if(this._pressed){p=Date.now();n=p-this._timestamp;this._timestamp=p;if(!this._prevOffset){this._prevOffset={x:0,y:0}}u={x:this._x-this._px,y:this._y-this._py,};this._px=this._x;this._py=this._y;this._prevOffset=this.offset;this._frame=this._offset;var t=1000;s=t*u.x/(1+n);q=t*u.y/(1+n);var r=0.8;var o=0.2;this._velocity={x:r*s+o*this._velocity.x,y:r*q+o*this._velocity.y}}},_resetParams:function(){this._px=0;this._py=0},_inertialScroll:function(){var n,o;if(this._amplitude&&!this._pressed){n=Date.now()-this._timestamp;o={x:-this._amplitude.x*Math.exp(-n/this._timeConstant),y:-this._amplitude.y*Math.exp(-n/this._timeConstant)};if(this.options.duration&&(o.x>5||o.x<-5||o.y>5||o.y<-5)){this.scroll(l(this._target,o));requestAnimationFrame(this._inertialScroll.bind(this))}else{this.scroll(this._target,true);if(this.options.duration){this._view.setStyles({transition:this._oldTransitionValue})}this._modelEvents.publish({context:this,event:"ANIMATION_END",data:{finalPositionInPixel:this.getFinalPosition(),finalPositionInPercent:this.getFinalPositionPercent(),fromBorder:this._isFromBorder?true:false,fromWhichBorder:this._isFromBorder}});this._isFromBorder=false;this._lastOffsetPercent=this._offsetPercent}}else{this._modelEvents.publish({context:this,event:"ANIMATION_END",data:{finalPositionInPixel:this.getFinalPosition(),finalPositionInPercent:this.getFinalPositionPercent(),fromBorder:this._isFromBorder?true:false,fromWhichBorder:this._isFromBorder}});this._isFromBorder=false;this._lastOffsetPercent=this._offsetPercent}},_start:function(o){o.preventDefault();if(j){console.warn("start")}this._pressed=true;this._initialPosition=this._getPointerPosition(o);this._velocity=this._amplitude=f();this._frame=this._offset=this._target;this._timestamp=Date.now();var n=this.options.viewport?this.options.viewport:this._view.getParent().getDimensions();this._min={x:this.options.range.xMin,y:this.options.range.yMin};this._max={x:this.options.range.xMax/100*n.width,y:this.options.range.yMax/100*n.height};this._snap={x:n.width,y:n.height};this._oldTransitionValue=this._view.getStyle("transition");this._view.setStyles({transition:"none"});clearInterval(this._ticker);this._ticker=setInterval(this._observeParameters.bind(this),100);return false},drag:function(n){if(j){console.log("pointermove")}var p,o;if(this._pressed){p=this._getPointerPosition(n);o=m(this._initialPosition,p);if(o.x>d||o.x<-d||o.y>d||o.y<-d){this._initialPosition=p;if(this._forceBeginPos){this._offset=m(this._forceBeginPos,p);this._offset.x=-this._forceBeginPos.x;this._forceBeginPos=null}this.scroll(l(this._offset,o))}}n.preventDefault();return false},scroll:function(o,n){this._x=this._offset.x=(!this.options.scrollX)?0:o.x;this._y=this._offset.y=(!this.options.scrollY)?0:o.y;if(this._x){this._x=this._offset.x=(o.x>this._max.x)?this._max.x:(o.x<this._min.x)?this._min.x:o.x}if(this._y){this._y=this._offset.y=(o.y>this._max.y)?this._max.y:(o.y<this._min.y)?this._min.y:o.y}this._offsetPercent={x:this._offset.x/this._snap.x*100,y:this._offset.y/this._snap.y*100};if(j){console.log("-- scroll --",o.x,":",this._offset.x,this._snap.x,"=",this._offsetPercent.x)}if(this.options.duration||n){this._view.style[this._xform]="translate3d("+(-this._offsetPercent.x)+"%,"+(-this._offsetPercent.y)+"%, 0)"}this.elements.leftBorder.setStyles({left:this._offsetPercent.x+"%"});this.elements.rightBorder.setStyles({right:-this._offsetPercent.x+"%"})},_stop:function(p){if(this._pressed){if(j){console.warn("stop")}this._pressed=false;var o=this.options.viewport?this.options.viewport:this._view.getParent().getDimensions();this._snap={x:o.width,y:o.height};clearInterval(this._ticker);this._target=this._offset;if(j){console.log("target",this._target);console.log("delta",this._delta);console.log("velocity",this._velocity)}if(this._velocity.x>10||this._velocity.x<-10||this._velocity.y>10||this._velocity.y<-10){var n=0.8;this._amplitude={x:n*this._velocity.x,y:n*this._velocity.y,};this._target=l(this._offset,this._amplitude)}this._target={x:Math.round(this._target.x/this._snap.x)*this._snap.x,y:Math.round(this._target.y/this._snap.y)*this._snap.y,};this._amplitude=m(this._target,this._offset);this._timestamp=Date.now();if(this._velocity.x||this._velocity.y){this._modelEvents.publish({context:this,event:"_stop",data:{finalPositionInPixel:this.getFinalPosition(),finalPositionInPercent:this.getFinalPositionPercent(),fromBorder:this._isFromBorder?true:false,fromWhichBorder:this._isFromBorder}});this._isFromBorder=false;requestAnimationFrame(this._inertialScroll.bind(this))}else{this._view.setStyles({transition:this._oldTransitionValue})}}}});return e});define("DS/Layouts/SlidingViews",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/UIBehaviors/Kinetic","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,l,b,j,h,d,c,f,g,a){window._flagFrameIsLoaded=[];var m=function(n){if(n.indexOf("http://")===0||n.indexOf("https://")===0){return n}else{return d.getWebappsBaseUrl()+n}};var i="CHANGE";var k=h.extend({defaultOptions:{kinetic:true,orientation:"horizontal",showPager:true,views:[],viewsBar:null,activateViewOn:null,viewsWidth:"100%",translateFactor:100,effectDuration:"0.2s",pageBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-page-content",styles:{overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}})},selectedViewsIndicatorBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-views-item-selection wux-font-arial-regular"})},viewsIndicatorBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-views-item",html:n.label,})},pagerTarget:null,prevPage:null,nextPage:null,},init:function(n){this._parent(n);this._modelEvents=new c();this._selectedContentIndex=-1;this._views=[];this._buildLayout();this._buildviews();if(this.options.kinetic){this._bindKinetic()}var o=this;a.onNodeRendered(o.elements.selection,function(){o.goToNthView(0)})},_buildLayout:function(){this.elements.container=new e.Element("div",{"class":"wux-layouts-slidingviews"});this.elements.views=new e.Element("div",{"class":"wux-layouts-slidingviews-views",styles:{height:"auto",borderTop:"none",textAlign:"center",padding:"5px 10px",position:"relative",display:this.options.showPager?"block":"none"}}).inject(this.elements.container);this.elements.viewsContainer=new e.Element("div",{styles:{position:"relative",display:"inline-block"}}).inject(this.elements.views);this.elements.contentView=new e.Element("div",{"class":"wux-layouts-slidingviews-content-view",styles:{height:"inherit"}}).inject(this.elements.container);this.elements.contentViewContainer=new e.Element("ul",{"class":"wux-layouts-slidingviews-content-view-container wux-ui-stack-h",styles:{position:"relative",height:100+"%"}}).inject(this.elements.contentView);this.elements.contentViewContainer.setStyles({transition:"all "+this.options.effectDuration+" ease-in-out"})},_buildviews:function(){var n=this;this._lastSelectedContentIndex=null;this._selectedContentIndex=0;this.elements.selection=n.options.selectedViewsIndicatorBuilder({});if(this.options.pagerTarget){this.elements.selection.inject(n.options.pagerTarget)}else{this.elements.selection.inject(n.elements.viewsContainer)}this.elements.viewsItems=[];this.options.views.forEach(function(p,o){n.addView(p,o)})},_bindKinetic:function(){this._kin=new f({target:this.elements.contentViewContainer,scrollX:true,scrollY:false,range:{xMin:0,xMax:(this._views.length-1)*100,yMin:0,yMax:0,},duration:100,viscosity:500});var n=this;this._kin.onRelease(function(){n.goToNthView(this.getFinalPositionPercent().x/100,undefined,true)})},addView:function(y,r){var w=this;if(r===undefined){r=w.elements.viewsItems.length}var x=w.options.viewsIndicatorBuilder({index:r+1,label:y.title||r});x.addEvent(g.POINTERUP,function(z){w.elements.contentViewContainer.setStyles({transition:"all "+w.options.effectDuration+" ease-in-out"});w.goToNthView(r)});w.elements.viewsItems.splice(r,0,x);if(this.options.pagerTarget){x.inject(w.options.pagerTarget)}else{x.inject(w.elements.viewsContainer)}var t,o;var s=y.content;if(typeof s.html==="string"){if(s.iframe){o=new e.Element("iframe",{allowfullscreen:"true",src:m(s.html),frameborder:0,onload:"window._flagFrameIsLoaded["+r+"]=true",styles:{width:"100%",position:"absolute",top:0,bottom:0,height:"100%",overflow:"auto","-webkit-overflow-scrolling":"touch"}});var n=0;var q=window.setInterval(function(){n++;if(n>20){window.clearInterval(q);if(y.contentError){o.src=m(y.contentError)}}},100)}else{o=new e.Element("div",{styles:{padding:10,overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}});var p="Ajax";if(d.getWebappsBaseUrl()!=="../"){p="Data"}e[p].request(s.html,{async:true,onComplete:function(z){o.setHTML(z);if(s.onLoad){s.onLoad(z)}}})}}else{o=y.content.html}if(!y.styles){y.styles={}}y.styles.verticalAlign="top";y.styles.width=this.options.viewsWidth;t=this.options.pageBuilder.call(this,r);if(o){t.setHTML(o)}var u=(y["class"]?y["class"]:"");var v=new e.Element("li",{html:t,"class":"wux-layouts-slidingviews-page "+u,styles:y.styles,});if(v.getContent){v.getContent().setHTML(t)}else{v.setHTML(t)}v.inject(w.elements.contentViewContainer);w._views.splice(r,0,t);return t},removeView:function(n){if(this.getViews().length>1){this.elements.viewsItems[n].destroy();this.elements.viewsItems.splice(n,1);if(this._views[n].destroy){this._views[n].destroy()}if(this._views[n]&&this._views[n].remove){this._views[n].remove()}this._views.splice(n,1);if(n===this._selectedContentIndex){this.goToNthView(Math.max(0,n-1))}}},getViews:function(){return this._views},getView:function(n){return this._views[n]},getCurrentViewID:function(){return this._selectedContentIndex===-1?0:this._selectedContentIndex},getCurrentView:function(){return this.getView(this.getCurrentViewID())},goToPreviousView:function(){return this.goToNthView(this.getCurrentViewID()-1)},goToNthView:function(n,q,t){var p=this;if(q===undefined){q=true}if(n>p.elements.viewsItems.length-1){n=p.elements.viewsItems.length-1}if(n<0){n=0}p._lastSelectedContentIndex=p._selectedContentIndex;p._selectedContentIndex=n;if(p._lastSelectedContentIndex!==null&&p.elements.viewsItems[p._lastSelectedContentIndex]){p.elements.viewsItems[p._lastSelectedContentIndex].removeClassName("wux-ui-state-active")}var o=p.elements.viewsItems[n];if(o){var s=(-n*this.options.translateFactor)+"%";p.elements.contentViewContainer.setStyles({transform:"translate3d("+s+", 0px, 0)"});if(!t&&this.options.kinetic){p._kin._registerPosition(s)}var r=0;r=o.getOffsets().x-parseInt(o.getStyle("paddingLeft"),10)/2;r=o.getPosition().x;p.elements.selection.setHTML(p.elements.viewsItems[n].getHTML());p.elements.selection.setStyles({position:"absolute",top:"auto",transform:"translate3d("+r+"px, "+0+"px, 0)",height:o.getDimensions().height,width:o.getDimensions().width});o.addClassName("wux-ui-state-active");if(q){this._modelEvents.publish({event:i,data:{viewID:n}})}}else{console.warn("Something gone wrong, try to reach view with index:",n)}return this.getView(n)},onViewChange:function(n){return this._modelEvents.subscribe({event:i,},n)}});return k});define("DS/Layouts/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/TreeNavigationNodeAbstract","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom"],function(h,g,f,d,e,c,b,a){});define("DS/Tree/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Layouts/ListView","DS/Tree/TreeDocument","DS/Layouts/ListViewCellAbstract","DS/CoreEvents/ModelEvents","DS/Tree/TreeNodeView"],function(g,j,h,e,l,i,b,k,a,q,d,n){function c(u){var w=u.cellInfos.cellModel||u.cellInfos.nodeModel;var s=u.controller;var r;if(w.options.isTerminal){r=w._nodeDepth}else{r=w._nodeDepth+1}var x=s.getView(r);if(!x){x=s.addView({title:g.clone(w.options.label),content:{html:null,iframe:false,onLoad:function(){}}})}u.cellInfos.node=w;u.cellInfos.nodeModel=w;u.cellInfos.page=x;if(!w.options.isTerminal){x.setBackTitle(g.clone(w.getParent().options.label));x.setTitle(g.clone(w.options.label));var v=w.getChildren();x.elements.pageContent.empty();if(w.options.content){x.addContent(w.options.content)}if(v){x._listView.inject(x.elements.pageContent);x._listView.updateModel(v)}var t=w._nodeDepth+1;s.goToNthView(t)}u.treeNavigation._modelEvents.publish({event:"SELECT",data:u.cellInfos,context:u.context})}function m(s){var r=new k({model:s.model,height:"auto",cellClass:o,defaultCellHeight:40});r.onCellRequest(function(u){var t=u.cellModel.options.label.toString();u.cellView.getContent().innerHTML=t;if(u.cellModel.options.type==="header"){u.cellView.getContent().addClassName("wux-layouts-treenavigation-header")}else{u.cellView.getContent().removeClassName("wux-layouts-treenavigation-header")}});r.onCellClick(function(t){if(t.cellModel.options.type!=="header"){if(t.cellModel.hasChildren()){t.cellModel.expand()}else{c({cellInfos:t,treeNavigation:s.treeNavigation,controller:s.controller})}}});return r}var o=q.extend({init:function(r){this._parent(r)},updateInternalParameters:function(s){var u=this.getCellInfos();var r=u.cellModel;var t=u.cellView;if(u.virtualRowID>-1&&u.virtualColumnID>-1){t.getContent().setAttribute("has-children",r.hasChildren());if(r.options.type){t.getContent().setAttribute("type",r.options.type)}else{t.getContent().removeAttribute("type")}if(r.options.keywords&&r.options.keywords.indexOf("new")>-1){t.getContent().setAttribute("is-new",true)}else{t.getContent().removeAttribute("is-new")}if(r.options.keywords&&r.options.keywords.indexOf("update")>-1){t.getContent().setAttribute("is-updated",true)}else{t.getContent().removeAttribute("is-updated")}if(r.options.keywords&&r.options.keywords.indexOf("dev")>-1){t.getContent().setAttribute("is-dev",true)}else{t.getContent().removeAttribute("is-dev")}if(r.options.keywords&&r.options.keywords.indexOf("deprecated")>-1){t.getContent().setAttribute("is-deprecated",true)}else{t.getContent().removeAttribute("is-deprecated")}}this._parent(s)}});var p=j.extend({defaultOptions:{treeNavigation:null,controller:null,model:[]},init:function(r){this._parent(r);this._buildView();this._buildListView();this.setBackTitle()},_buildListView:function(){this._listView=m({model:"value",context:this,treeNavigation:this.options.treeNavigation,controller:this.options.controller});this._listView.inject(this.elements.pageContent)},_buildView:function(){var s=this;this.elements.container=new g.Element("div",{"class":"wux-layouts-treenavigation-page-content",styles:{height:"inherit"}});this.elements.topHeader=new g.Element("ul",{"class":"wux-layouts-treenavigation-topheader"}).inject(this.elements.container);this.elements.topHeaderLeft=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-left",styles:{"float":"left"}}).inject(this.elements.topHeader);this.elements.topHeaderTitle=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-title wux-font-3dsregular"}).inject(this.elements.topHeader);this.elements.topHeaderRight=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-right"}).inject(this.elements.topHeader);this.elements.pageContent=new g.Element("div",{"class":"wux-layouts-treenavigation-pageContent"}).inject(this.elements.container);function r(t){s.options.controller.goToPreviousView()}this.elements.topHeaderLeft.addEventListener(i.POINTERUP,r)},goToChildren:function(v){var u=this;var r=u.options.controller;if(r){var w=r.getView(v._nodeDepth+1);if(!w){w=r.addView({title:g.clone(v.options.label),content:{html:null,iframe:false,onLoad:function(){}}})}w.setBackTitle(v.getParent().options.label);w.setTitle(v.options.label);var t=v.getChildren();w.elements.pageContent.empty();if(v.options.content){w.addContent(v.options.content)}else{if(t){w._listView.inject(w.elements.pageContent);w._listView.updateModel(t)}}var s=v._nodeDepth+1;r.goToNthView(s);return w}},setHTML:function(r){this.elements.pageContent.setHTML(r)},addContent:function(r){this.elements.pageContent.appendChild(r)},empty:function(){},updateLeftTitle:function(){var r=new g.Element("span",{html:this.options.leftTitle});var s=this;b.onNodeRendered(r,function(){setTimeout(function(){if(r.getDimensions().height>s.elements.topHeaderLeft.getDimensions().height){s.elements.topHeaderLeft.setStyles({lineHeight:"15px",fontSize:10})}else{s.elements.topHeaderLeft.setStyles({lineHeight:"30px",fontSize:""})}if(r.getDimensions().width>=s.elements.topHeaderLeft.getDimensions().width-5){s.elements.topHeaderLeft.setStyles({fontSize:10})}},100)});if(this.options.leftTitle&&this.options.leftTitle!==""){this.elements.topHeaderLeft.show();this.elements.topHeaderLeft.setHTML(r)}else{}},setBackTitle:function(r){this.options.leftTitle=r;this.updateLeftTitle()},setRightTitle:function(t){var r=new g.Element("span",{html:t});var s=this;b.onNodeRendered(r,function(){setTimeout(function(){if(r.getDimensions().height>s.elements.topHeaderRight.getDimensions().height){s.elements.topHeaderRight.setStyles({lineHeight:"15px",fontSize:10})}else{s.elements.topHeaderRight.setStyles({lineHeight:"30px",fontSize:""})}if(r.getDimensions().width>=s.elements.topHeaderRight.getDimensions().width-5){s.elements.topHeaderRight.setStyles({fontSize:10})}},1)});if(t){this.elements.topHeaderRight.show();this.elements.topHeaderRight.setHTML(r)}else{this.elements.topHeaderRight.hide()}},setTitle:function(r){this.elements.topHeaderTitle.setHTML(r)}});var f=j.extend({defaultOptions:{defaultCellHeight:60},init:function(r){this._parent(r);this._modelEvents=new d();this._dataModel=new a();this.elements.container=new g.Element("div",{"class":"wux-layouts-treenavigation",styles:{}});if(this.options.roots){this._dataModel.loadModel(this.options.roots);this.loadModel(this._dataModel)}},getModel:function(){return this._dataModel},loadModel:function(r){var s=this;this._dataModel=r;this._controller=new l({kinetic:false,showPager:false,pageBuilder:function(t){return new p({treeNavigation:s,controller:this})}});this._controller.getContent().setStyles({height:"inherit"});this._backID=-1;this._onBack=null;this._buildView();this._indexTree();this._getController().onViewChange(function(){s._modelEvents.publish({event:"CHANGE_PAGE"})});this._dataModel.onPostExpand(function(t){c({cellInfos:t.data,treeNavigation:s,controller:s._getController()})})},_indexNode:function(t,w,v,r){var s=this;if(v===undefined){v=[]}w++;var u=v.slice();if(r!==undefined){u.push(r);t.options["@view"]=t.getContent();t.options["@path"]=u;this._searchIndex.push(t.options)}if(t.getChildren()){w++;t.getChildren().forEach(function(y,x){s._indexNode(y,w,u,x)})}},_indexTree:function(){this._searchIndex=[];var r=this._getController().getCurrentView();this._searchResults=new g.Element("div",{"class":"wux-layouts-treenavigation-search-layer"}).hide();r.addContent(this._searchResults)},search:function(r){var s=this;var v=this._getController().getCurrentView();v.addContent(this._searchResults);if(r){this._searchResults.empty();this._searchResults.show();var u=this._dataModel.search({match:function(w){if(w.nodeModel.options.type!=="header"&&w.nodeModel.options.label.toLowerCase().indexOf(r)!==-1){return true}}});var t=m({model:u,context:this,treeNavigation:this,controller:this._controller});t.onCellClick(function(w){console.log("path",w.cellModel.getPath());s._searchResults.hide();w.cellModel.getPath().forEach(function(x){x.expand()})});t.inject(this._searchResults)}else{this._searchResults.hide()}},_getController:function(){return this._controller},_buildView:function(){this.elements.container.empty();this.elements.viewContent=new g.Element("div",{"class":"wux-layouts-treenavigation-content",html:"",styles:{height:"inherit"}}).inject(this.elements.container);this._controller.getContent().inject(this.elements.viewContent);var s=this;this._controller.addView({title:"Root",content:{html:null,iframe:false,onLoad:function(){}}});var r=s._controller.getView(0);r._listView.updateModel(this._dataModel.getRoots())},onNodeSelection:function(r){return this._modelEvents.subscribe({event:"SELECT"},function(s){r.call(this,s)})},onBack:function(r){return this._modelEvents.subscribe({event:"BACK"},r)},onPageChange:function(r){return this._modelEvents.subscribe({event:"CHANGE_PAGE"},r)},setTitle:function(r){this._dataModel._getTrueRoot().options.label=r;this._getController().getCurrentView().setTitle(r)},setRightTitle:function(r){this._getController().getCurrentView().setRightTitle(r)},_setBackID:function(r){this._backID=r},_getBackID:function(r){return this._backID}});return f});define("DS/Tweakers/TweakerEnum",["UWA/Core","DS/Utilities/Utils","DS/Tweakers/TweakerBase","DS/Controls/ComboBox","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/Controls/Button","DS/Tweakers/TweakerUtils"],function(d,g,o,p,a,m,l,j){var n=o.inherit({name:"tweakerEnum",publishedProperties:{displayStyle:{defaultValue:"combo",type:"string"},valueType:{defaultValue:"enumString",type:"string"}},_buildView:function(){this._viewCreated=false},_postBuildView:function(){this._viewCreated=true;this._applyDisplayStyle();this._parent()},_applyDisplayStyle:function(q){if(this._viewCreated){this._parent(q)}},getStringFromValue:function(q){return i(this.valueType,q,this.possibleValues)}});function k(s,q,t){switch(s){case"enumInteger":return parseInt(q,10);case"number":return parseFloat(q);case"boolean":return(/true/i.exec(q)!==null||q==="1");case"enumString":return q;case"enumCustom":for(var r in t){if(t[r].toString()==q){return t[r]}}break;case"enumValueToProperty":for(var r in t){if(r.toString()==q){return r}}break;case"object":return JSON.parse(q);default:return q}}function i(r,s,t){if(s===undefined){return""}if(r==="object"){return JSON.stringify(s)}else{if((r==="enumInteger"||r==="number")&&((Number.isNan&&Number.isNaN(s)===true)||(isNaN!==undefined&&isNaN(s)===true))){return"NaN"}else{if(r==="enumInteger"||r==="number"||r==="enumString"){return s.toString()}else{if(r==="enumCustom"){for(var q in t){if(q==s){return q}if(t[q]==s){return q}}}else{if(r==="enumValueToProperty"){for(var q in t){if(q==s){return t[q]}}}else{return j._getValueFromString(r,s)}}}}}}var c=function(r,q){o.prototype.baseViewModule.call(this,r,q)};g.applyMixin(c,o.prototype.baseViewModule);var b=function(r,q){this._loadEntriesBinded=e.bind(this);c.call(this,r,q)};g.applyMixin(b,c);b.prototype.buildView=function(){var q=this._options.viewOptions||{};var r=this._tweaker;q.touchMode=r._getCurrentTouchMode();q.disabled=r.readOnly;q.fireOnlyFromUIInteractionFlag=true;q.reachablePlaceholderFlag=r.allowResetToUndefinedByUIFlag;q.placeholder=r.usageDescription;this._view=new p(q);this.setPossibleValues(this._tweaker.possibleValues);this.setValue(this._tweaker.value)};b.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var q=this._view;q.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(k(s.valueType,q.value,s.possibleValues))});q.addEventListener("show",function(t){t.stopPropagation();s.onShow()});q.addEventListener("hide",function(t){t.stopPropagation();s.onHide({cancelFlag:(t.options.cancelPopupSelection?true:false)})});q.addEventListener("preselectionChange",function(u){u.stopPropagation();if(q.preselectedIndex>=0){var t=q._getAllDescendants()[q.preselectedIndex].options.grid.valueItem;if(t===undefined){t=q._getAllDescendants()[q.preselectedIndex].options.label}r.setTweakerValue(k(s.valueType,t,s.possibleValues))}else{r.setTweakerValue(undefined)}});if(s.valueType==="enumDyn"&&typeof s.possibleValues==="function"){q.addEventListener("preDropdown",this._loadEntriesBinded)}};b.prototype.destroy=function(){this._view.removeEventListener("preDropdown",this._loadEntriesBinded);c.prototype.destroy.call(this)};b.prototype.getModifiableOptions=function(){return["enableSearchFlag","mainElementVisibleFlag","expanderIcon"]};b.prototype.setEnableSearchFlag=function(q){if(!this._view){return}this._view.enableSearchFlag=q};b.prototype.setUsageDescription=function(q){if(!this._view){return}this._view.placeholder=q};b.prototype.setAllowResetToUndefinedByUIFlag=function(q){if(!this._view){return}this._view.reachablePlaceholderFlag=q};b.prototype.setMainElementVisibleFlag=function(q){if(!this._view){return}this._view.mainElementVisibleFlag=q};b.prototype.setExpanderIcon=function(q){if(!this._view){return}this._view.expanderIcon=q};b.prototype.setValue=function(u){var v=this._tweaker;var r=this._view;if(typeof v.possibleValues==="function"){this._lockValueUpdate=true;r.elementsList=v.possibleValues.call(v).slice(0)}var q=r.elementsList;if(!q||q.length===0||u===""||u===undefined){r.selectedIndex=-1}else{if(typeof u==="undefined"||u===null){return}var s=u.toString();for(var t=0;t<q.length;t++){if(u===q[t]||u===q[t].valueItem||s===q[t]||s===q[t].valueItem){r.selectedIndex=t;break}}}};b.prototype.setPossibleValues=function(q){if(!this._view){return}this._view.removeEventListener("preDropdown",this._loadEntriesBinded);if(this._tweaker.valueType==="enumDyn"&&typeof q==="function"){this._view.addEventListener("preDropdown",this._loadEntriesBinded)}else{this._view.elementsList=f.call(this)}};function e(){if(this._view){this._view.elementsList=this._tweaker.possibleValues.call(this._tweaker).slice(0)}}function f(){var t=this._tweaker;if(t.possibleValues!==undefined){if(t.valueType==="enumString"){if(d.typeOf(t.possibleValues)==="object"){var u=[];for(var r in t.possibleValues){if(t.possibleValues.hasOwnProperty(r)){u.push({valueItem:t.possibleValues[r],labelItem:r})}}return u}else{if(d.typeOf(t.possibleValues)==="array"){return t.possibleValues.map(function(v){return(typeof v==="string")?v:{labelItem:(typeof v.label==="undefined"?v.value:v.label),valueItem:v.value,iconItem:v.icon}})}}return t.possibleValues}else{if(t.valueType==="enumDyn"&&typeof t.possibleValues==="function"){return[]}else{var s=[];if(t.possibleValues.constructor===Array){for(var q=0;q<t.possibleValues.length;q++){s.push(i(t.valueType,t.possibleValues[q],t.possibleValues))}}else{if(t.valueType==="enumValueToProperty"){for(var r in t.possibleValues){s.push({labelItem:t.possibleValues[r],valueItem:r})}}else{for(var r in t.possibleValues){s.push({labelItem:i(t.valueType,r,t.possibleValues),valueItem:t.possibleValues[r]})}}}return s}}}return[]}var h=function(r,q){c.call(this,r,q)};g.applyMixin(h,c);h.prototype.buildView=function(){var r=this._options.viewOptions;r.disabled=this._tweaker.readOnly;r.touchMode=this._tweaker._getCurrentTouchMode();r.fireOnlyFromUIInteractionFlag=true;this._view=new a(r);var q=this._tweaker.value;this.setPossibleValues(this._tweaker.possibleValues);this.setValue(q)};h.prototype.handleEvents=function(){var r=this;var s=this._tweaker;var q=this._view;q.addEventListener("change",function(t){t.stopPropagation();r.setTweakerValue(q.value)})};h.prototype.setPossibleValues=function(u){var w=this._tweaker;var s=this._view;if(!s||!w||!u){return}var r=s.getButtonCount();for(var q=0;q<r;q++){var t=s.getButton(0);s.removeChild(t);t.destroy()}if(w.valueType==="enumString"){u.forEach(function(x){if(typeof x==="object"){s.addChild(new l({type:s.type,label:x.label,value:x.value,icon:x.icon}))}else{s.addChild(new l({type:s.type,label:x,value:x}))}})}else{if(w.valueType==="enumDyn"){}else{if(w.valueType==="enumValueToProperty"){for(var v in u){s.addChild(new l({type:s.type,label:u[v],value:v}))}}else{for(var v in u){s.addChild(new l({type:s.type,label:v,value:u[v]}))}}}}};h.prototype.setValue=function(r){var s=this._tweaker;var q=this._view;if(!q||!s){return}q.value=r};n.prototype.baseViewModule=c;n.prototype.VIEW_MODULES={combo:{classObject:b,options:{viewOptions:{enableSearchFlag:false}}},comboLite:{classObject:b,options:{viewOptions:{enableSearchFlag:false,mainElementVisibleFlag:false,displayStyle:"lite"}}},searchableCombo:{classObject:b},buttonGroup:{classObject:h},buttonGroup_readOnly:{classObject:h}};n.prototype.registerViewModule=function(q,r){return;if(!q||!r||!r.classObject&&!r.classPath){return}if(n.prototype.VIEW_MODULES[q]!==undefined){return}n.prototype.VIEW_MODULES[q]=r};return n});define("DS/Tweakers/TweakerVariant",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerEnum","DS/Tweakers/TypeRepresentationFactory"],function(f,h,a,j,i,c){var e=j.inherit({name:"TweakerVariant",publishedProperties:{valueTypes:{defaultValue:undefined,type:"string"},currentType:{defaultValue:undefined,type:"string"},displayStyle:{defaultValue:"editors",type:"string"}},_postBuildView:function(){this._parent();if(this.elements.container!==undefined){this.elements.container.addClassName("wux-tweakers-variant")}},_applyProperties:function(k){this._parent(k);if(this.isDirty("valueTypes")){this._applyValueTypes()}if(this.isDirty("currentType")){this._applyCurrentType()}},_applyCurrentType:function(){if(this.elements._viewModule&&this.elements._viewModule.setCurrentType){this.elements._viewModule.setCurrentType(this.currentType)}},_applyValueTypes:function(){if(this.elements._viewModule&&this.elements._viewModule.setValueTypes){this.elements._viewModule.setValueTypes(this.valueTypes)}}});var g=function(l,k){j.prototype.baseViewModule.call(this,l,k)};h.applyMixin(g,j.prototype.baseViewModule);g.prototype.setValueTypes=function(){};g.prototype.setCurrentType=function(){};var d=function(l,k){g.call(this,l,k)};h.applyMixin(d,g);d.prototype.buildView=function(){this._view=[];var l=f.createElement("div",{"class":"wux-tweakers-variant-typeContainer"});var k=new i({value:this._tweaker.currentType,touchMode:this._tweaker._getCurrentTouchMode(),displayStyle:"comboLite"});k.getContent().addClassName("wux-tweakers-variant-typeCustomizer");k.applyPropertiesOnView({expanderIcon:"cog"});k.elements._viewModule._view.elements.icon.style.fontSize="1.2em";this._view.push(l);this._view.push(k);this.setCurrentType(this._tweaker.currentType)};d.prototype.handleEvents=function(){var k=this;a.addEventOnElement(this._view[1],this._view[1],"change",function(l){l.stopPropagation();k._tweaker.currentType=l.dsModel.value})};d.prototype.setValue=function(k){if(!this._view||this._view.length<3){return}this._view[2].value=k};d.prototype.setValueTypes=function(k){if(!this._view||this._view.length<2||k===undefined){return}this._view[1].setProperties({possibleValues:k.trim().split("|"),value:this._tweaker.currentType})};d.prototype.setCurrentType=function(p){if(!this._view||this._view.length<2){return}this._view[1].value=p;var q=parseInt(Date.now());this._currentTimeStamp=q;if(this._view.length>2){var l=this._view.pop();l.remove();l.destroy()}var m=this;var k=function(r){if(r!==undefined){m._view.push(r);r.inject(m._view[0]);a.addEventOnElement(r,r,"preEdit",function(s){s.stopPropagation();m._tweaker.onPreEdit()});a.addEventOnElement(r,r,"postEdit",function(s){s.stopPropagation();m._tweaker.onPostEdit()});["liveChange","change"].forEach(function(s){a.addEventOnElement(r,r,s,function(t){t.stopPropagation();m.setTweakerValue(r.value)})});m.setTweakerValue(r.value);m._tweaker.fire("currentTypeChange")}};var o=function(){return m._currentTimeStamp===q};var n={touchMode:this._tweaker._getCurrentTouchMode(),typePath:p,context:"inlinedTemplate",onViewCreated:k,needToCreateViewAfterRequireEnded:o,semantics:{allowResetToUndefinedByUIFlag:this._tweaker.allowResetToUndefinedByUIFlag}};if(WUX.typeRepFactory!==undefined){WUX.typeRepFactory.generateView(this._tweaker.value,n)}else{WUX.typeRepFactory=new c({onReady:function(){this.generateView(m._tweaker.value,n)}})}};d.prototype.setTouchMode=function(l){if(!this._view||this._view.length<2){return}var k=this._tweaker._getCurrentTouchMode();this._view[1].touchMode=k;if(this._view.length>2){this._view[2].touchMode=k}};var b=function(l,k){g.call(this,l,k)};h.applyMixin(b,g);b.prototype.buildView=function(){this.setCurrentType(this._tweaker.currentType)};b.prototype.setValue=function(k){if(!this._view){return}this._view.value=k};b.prototype.setCurrentType=function(o){var p=parseInt(Date.now());this._currentTimeStamp=p;if(this._view!==undefined){this._view.remove();this._view.destroy();this._view=undefined}var l=this;var k=function(q){if(q!==undefined){l._view=q;l.inject(l._tweaker.elements.container);l.setTweakerValue(q.value);l._tweaker.fire("currentTypeChange")}};var n=function(){return l._currentTimeStamp===p};var m={touchMode:this._tweaker._getCurrentTouchMode(),readOnly:true,typePath:o,context:"inlinedTemplate",onViewCreated:k,needToCreateViewAfterRequireEnded:n,semantics:{allowResetToUndefinedByUIFlag:this._tweaker.allowResetToUndefinedByUIFlag}};if(WUX.typeRepFactory!==undefined){WUX.typeRepFactory.generateView(this._tweaker.value,m)}else{WUX.typeRepFactory=new c({onReady:function(){this.generateView(l._tweaker.value,m)}})}};b.prototype.setTouchMode=function(k){if(!this._view){return}this._view.touchMode=this._tweaker._getCurrentTouchMode()};e.prototype.baseViewModule=g;e.prototype.VIEW_MODULES={readOnly:{classObject:b},editors:{classObject:d}};e.prototype.registerViewModule=function(k,l){return;if(!k||!l||!l.classObject&&!l.classPath){return}if(e.prototype.VIEW_MODULES[k]!==undefined){return}e.prototype.VIEW_MODULES[k]=l};return e});define("DS/Controls/TabBar",["UWA/Core","DS/Controls/Abstract","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/TooltipModel","DS/WebRecordEnabler/Adapter","i18n!DS/Controls/assets/nls/translation.json","DS/Menu/Menu"],function(d,N,I,K,q,z,j,F,a,x,A,v,B,l,o,E){var f="selectTab";var D="pinTab";var b="unpinTab";var s="editTab";var H="removeTab";var h="endDragTab";var P="beginDragTab";var O="changeLabelTab";var J="newTab";var n="endEditTab";var L="preNewTab";var u="contextualMenu";var g;var m;var G;var w=N.inherit({name:"tabBar",markForRecordFlag:true,publishedProperties:{newTabButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},pinFlag:{defaultValue:true,type:"boolean",category:"Behavior"},editableFlag:{defaultValue:false,type:"boolean",category:"Behavior"},centeredFlag:{defaultValue:true,type:"boolean",category:"Appearance"},closeButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},minWidth:{defaultValue:-1,type:"number",category:"Appearance"},slideStep:{defaultValue:200,type:"number",category:"Behavior"},pinnedList:{defaultValue:undefined,type:"array",category:"Behavior",advancedSetter:true,recordFlag:true},displayStyle:{defaultValue:"normal",type:"array",category:"Appearance"},value:{defaultValue:undefined,type:"array",category:"Behavior",recordFlag:true},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},reorderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:true,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:undefined,type:"boolean",category:"Behavior"},},buttonGroup:null,newTabButton:null,newTabComboBox:null,showPreviousButton:null,showNextButton:null,slide:Number,pinnedListIsBeingUpdated:false,buildView:function(){this.modelEvent=new q();this.elements.container.addClassName("wux-controls-tabBar");this._history=new A();this.elements.buttonsContainer=new d.createElement("div",{"class":"wux-controls-tabBar-buttonsContainer"}).inject(this.elements.container);this.elements.tabBar=new d.createElement("div",{"class":"wux-controls-tabBar-tabs"}).inject(this.elements.container);this.elements.containerAddandNextButton=new d.Element("div",{"class":"wux-controls-tabBar-buttonsContainer-addandnext"}).inject(this.elements.buttonsContainer);this.elements.buttonGroupContainer=new d.Element("div",{"class":"wux-controls-tabBar-tabs-container"}).inject(this.elements.tabBar);this.buttonGroup=new I();this.buttonGroup.inject(this.elements.buttonGroupContainer);this.buttonGroup.getContent().setAttribute("role","presentation");this._applyCenteredFlag();this.newTabButton=new F({icon:"plus",value:"NewTab",allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton});this.newTabButton.tooltipInfos=new B({shortHelp:o.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.newTabButton.getContent().inject(this.elements.buttonsContainer);this.newTabButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNewTab");if(!this.newTabButtonFlag){this.newTabButton.getContent().hide()}this.buttonGroup.multiSelFlag=this.multiSelFlag;this.togglesTab={};this.valueSource=undefined;this.valueTarget=undefined},_postBuildView:function(){this.cptSelection=0;this.historySelection=[]},_handleEvents:function(){var T=this;var U=false;function S(){T.redrawTabBar()}this._onResizeFun=S;z.addResizeListener(this.elements.container,this._onResizeFun,0);z.onNodeRendered(this.elements.container,function(){if(T.elements.container!==undefined&&T.displayStyle.indexOf("strip")!==-1){if(T.multiSelFlag){T._applyMultiSelFlag()}T._postEditTouchMode();T.redrawTabBar()}});this.newTabButton.addEventListener("click",function(){k.call(T)});z.addEventOnElement(this,this.buttonGroup,j.POINTERDOWN,function(W){U=false;if(T.closeButtonFlag&&W.which===2){var V=W.target.parentNode;if(!V.dsModel){U=false}else{U=true}}if(W.target.value==="close"){U=true}return U});z.addEventOnElement(this,this.buttonGroup,j.POINTERUP,function(W){if(U){U=false;var V,X;if(W.target.dsModel instanceof F){V=W.target.dsModel}else{V=W.target.parentNode.dsModel}if(V===undefined){return}if(V){X=V.value}if(X!==undefined&&T.getButtonFromValue(X).elements._closeButton===undefined){return}T._closeListener(V);t(T);T.redrawTabBar()}});var R=function Q(V){if(T._preventButtonGroupListener){return}V.stopPropagation();if(T.disabled){return}T._endEditTab();var ad=T.getButtonFromValue(V.dsModel.value);if(!Array.isArray(ad)){ad=[ad]}T.setPropertyFromUIInteraction("value",T.buttonGroup.value);for(var W=0;W<ad.length;W++){var Z=ad[W];var ac=Z._index;if(ac!==-1){if(Z.checkFlag){if(T.cptSelection!==undefined){T.cptSelection++;T._setHistoryFromButton(Z,T.cptSelection)}T.modelEvent.publish({event:f,data:{index:ac,tabBar:T}})}if(T.displayStyle.indexOf("bullet")!==-1){var af=p(T.buttonGroup._getButtonList(),Z);if(af){if(Z.value==T.value&&!Z.checkFlag){Z.checkFlag=true}af.checkFlag=Z.checkFlag;af.show()}T._updateView();T.buttonGroup.getContent().setStyle("margin-left",0+"px");if(!this.showComboBoxFlag){if(T.showPreviousButton){T.showPreviousButton.disabled=true}if(T.showNextButton){T.showNextButton.disabled=false}}}else{if(T.displayStyle.indexOf("normal")!==-1){var ab=C(T.togglesTab,Z);if(ab){ab.checkFlag=Z.checkFlag}T._updateView()}else{if(T.displayStyle.indexOf("panel")!==-1){var aa=T.getIndexesByValues(T.value);aa=aa.sort();for(var Y=0;Y<aa.length;Y++){var X=T.getValueByIndex(aa[Y]);var Z=T.getButtonFromValue(X);if(Z!==undefined&&!Array.isArray(Z)||Array.isArray(Z)&&Z.length>0){if(Y===0){Z.getContent().setStyles({"border-bottom":"1px solid #f1f1f1"})}}}var ae=T.buttonGroup._getButtonList();for(var Y=0;Y<ae.length;Y++){var Z=ae[Y];if(T.displayStyle.indexOf("panel")!==-1){if(!Z.checkFlag){Z.getContent().setStyles({"border-bottom":"1px solid #b4b6ba"})}}}}}}}}T.redrawTabBar()};this.buttonGroup.addEventListener("change",R);this.buttonGroup.addEventListener("buttonclick",function(W){var V=W;W.stopPropagation();if(V){while(V&&!(V.dsModel instanceof F||V.dsModel instanceof a)){if(W.parentElement){V=W.parentElement}else{break}}T.fire("tabButtonClick",{value:T.getValueByIndex(T.buttonGroup.getButtonIndex(V.dsModel))})}});this.buttonGroup.addEventListener("buttonDblClick",function(V){V.stopPropagation()});z.addEventOnElement(this,this.buttonGroup,j.POINTERHIT,function(W){W.preventDefault();if(W.multipleHitCount!==2){return}if(T.disabled){return}var X=W.target;while(X&&(!X.dsModel||!(X.dsModel instanceof F))){X=X.getParent()}if(X){var V=T.getButtonFromValue(X.dsModel.value);if(V instanceof a){V=p(T.buttonGroup._getButtonList(),V)}if(T.editableFlag){T._editTab(V.value)}else{if(T.pinFlag){T._pinTab(V.value,"buttonGroup_dblClick")}}}});z.addEventOnElement(this,document,j.POINTERUP,function(V){if(g&&g.getContent().getAttributeNode("focused")===null){T._endEditTab()}});z.addEventOnElement(this,this.buttonGroup.getContent(),"mousewheel",function(V){if(T._hasOverflow()&&T.buttonGroup.getContent().hasAttribute("focused")){var W=d.Event.wheelDelta(V);if(W>0){T._slideTabBar("right")}else{T._slideTabBar("left")}V.stopPropagation();V.preventDefault()}})},_onDragPointerDown:function(U){if(this.disabled){return}var S=this;if(U.dsModel){var T=this.getButtonFromValue(U.dsModel.value);if(T){this.valueSource=T.value}}function R(V){if(V.target.parentNode&&V.target.parentNode.dsModel===S.buttonGroup&&S.valueSource!==undefined){S._onDragPointerMove(V)}}function Q(V){if(S.valueSource!==undefined){S._onDragPointerUp(V)}z.removeEventOnElement(S,document,j.POINTERMOVE,R);z.removeEventOnElement(S,document,j.POINTERUP,Q)}z.addEventOnElement(this,document,j.POINTERMOVE,R);z.addEventOnElement(this,document,j.POINTERUP,Q);this.modelEvent.publish({event:P,data:{}})},_onDragPointerMove:function(R){if(!this.disabled&&R.button===0){R.preventDefault();var Q;if(R.target&&R.target.dsModel){Q=R.target.dsModel}else{if(R.target.dsModel===undefined){if(R.target.parentElement){Q=R.target.parentElement.dsModel}}}if(Q&&Q.value!==this.valueSource){this.callMethodFromUIInteraction("_exchangeTabs",this.valueSource,Q.value)}}},_exchangeTabs:function(U,V){this.value=[U];var Q=this.getButtonFromValue(V);var R=this.getButtonFromValue(U);if(Q&&R&&R.value!==undefined&&Q.value!==undefined&&R.value!==Q.value){this.valueTarget=Q.value;var T=Q._index;var S=R._index;this.buttonGroup.moveButton(S,T);Q._index=S;R._index=T;this.modelEvent.publish({event:h,data:{valueButtonDragged:U,valueButtonTarget:V,valueTab:this.value}});this._changeButtonIndexInComboBox(R,R._index);this._changeButtonIndexInComboBox(Q,Q._index);t(this);this.fire("beginReorder",{value:R.value})}},_onDragPointerUp:function(Q){if(this.valueTarget!==undefined){this.valueSource=undefined;this.valueTarget=undefined;this.redrawTabBar();this.fire("endReorder")}},_applyShowComboBoxFlag:function(Q){if(!this.showComboBoxFlag){var R=this;if(this.tabComboBox){this.tabComboBox.removeEventListener("change",this._comboCB.bind(this));this.tabComboBox.getContent().hide();this.tabComboBox.destroy();this.tabComboBox=null}this._createButtonsNextAndPrevious()}else{this.tabComboBox=new x({elementsTree:this._history,mainElementVisibleFlag:false,enableSearchFlag:false,displayStyle:(this.displayStyle.indexOf("strip")!==-1)?"lite":"normal",}).inject(this.elements.buttonsContainer,"before");this.tabComboBox.tooltipInfos=new B({shortHelp:o.listAllItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.tabComboBox.getContent().addClassName("wux-controls-tabBar-combobox");this.tabComboBox.addEventListener("change",this._comboCB.bind(this));this._updateComboBox();if(this.showPreviousButton){this.showPreviousButton.destroy();this.showPreviousButton=null}if(this.showNextButton){this.showNextButton.destroy();this.showNextButton=null}}if(this.displayStyle.indexOf("panel")!==-1){if(this.tabComboBox){this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel")}}this.redrawTabBar()},_applyCenteredFlag:function(){if(this.centeredFlag){this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered");this.elements.tabBar.addClassName("wux-controls-tabBar-centered");this.elements.container.addClassName("wux-controls-tabBar-centered")}else{this.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered");this.elements.tabBar.removeClassName("wux-controls-tabBar-centered");this.elements.container.removeClassName("wux-controls-tabBar-centered")}},_applyReorderFlag:function(){var R=this;function Q(S){if(R.disabled){return}R._onDragPointerDown(S)}if(this.reorderFlag){z.addEventOnElement(this,this.elements.container,j.POINTERDOWN,Q)}else{z.removeEventOnElement(this,this.elements.container,j.POINTERDOWN,Q)}},_applyMultiSelFlag:function(){this.buttonGroup.multiSelFlag=this.multiSelFlag;for(var Q in this.togglesTab){if(this.togglesTab.hasOwnProperty(Q)){this.togglesTab[Q].multiSelFlag=this.multiSelFlag}}if(!this.multiSelFlag&&this.value&&this.value.length>0){var R=this._getMaxHistory();if(R){this.value=[R]}else{this.value=[]}}else{this.buttonGroup._applyValue()}},_preEditPinnedList:function(R,T){if(!this.pinnedListIsBeingUpdated){this.pinnedListIsBeingUpdated=true;if(this.pinnedList===undefined){this.pinnedList=[]}if(R===undefined){R=[]}var V=M.call(this,T,R);var S=M.call(this,R,T);for(var Q=0;Q<V.length;Q++){this.pinTab(V[Q])}for(var U=0;U<S.length;U++){this.pinTab(S[U])}this.pinnedListIsBeingUpdated=false}},_applyPinFlag:function(Q){if(!this.pinFlag){this.pinnedList=[]}},_applyProperties:function(Q){this.slide=0;if(this.isDirty("centeredFlag")){this._applyCenteredFlag(Q.centeredFlag)}if(this.isDirty("showComboBoxFlag")){this._applyShowComboBoxFlag(Q.showComboBoxFlag)}if(this.isDirty("reorderFlag")){this._applyReorderFlag(Q.reorderFlag)}if(this.isDirty("recId")){this._applyRecId(Q.recId)}},_applyCloseButtonFlag:function(){for(var Q=0;Q<this.buttonGroup.getButtonCount();Q++){this.setAllowClosableFlagOnValue(this.getValueByIndex(Q),this.closeButtonFlag)}if(this.showComboBoxFlag){this._updateComboBox()}},_applyDisabled:function(){this.buttonGroup.disabled=this.disabled;if(!this.showComboBoxFlag||this.displayStyle.indexOf("strip")!==-1){if(this.showPreviousButton){this.showPreviousButton.disabled=this.disabled}if(this.showNextButton){this.showNextButton.disabled=this.disabled}}else{if(this.tabComboBox){this.tabComboBox.disabled=this.disabled}}if(this.newTabButton){this.newTabButton.disabled=this.disabled}},_applyNewTabButtonFlag:function(){if(this.displayStyle.indexOf("strip")!==-1&&this.showComboBoxFlag){i.call(this)}if(this.newTabButtonFlag){if(this.tabComboBox&&this.tabComboBox.visibleFlag){this.newTabButton.getContent().hide()}else{this.newTabButton.getContent().show();this.newTabButton.getContent().style.marginLeft=(this.displayStyle.indexOf("strip")!==-1)?"0px":-this.buttonGroup.getContent().offsetLeft+"px"}}else{this.newTabButton.getContent().hide()}},_applyTouchMode:function(){this._postEditTouchMode()},_postEditTouchMode:function(){var Q=this._getCurrentTouchMode();this._parent();if(Q===true){this.elements.container.setAttributeNode(document.createAttribute("touch-mode"));this.elements.tabBar.setAttributeNode(document.createAttribute("touch-mode"));this.elements.buttonGroupContainer.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.container.removeAttribute("touch-mode");this.elements.tabBar.removeAttribute("touch-mode");this.elements.buttonGroupContainer.removeAttribute("touch-mode")}this.buttonGroup.touchMode=Q;if(this.tabComboBox){this.tabComboBox.touchMode=Q}if(this.showNextButton){this.showNextButton.touchMode=Q}if(this.newTabButton){this.newTabButton.touchMode=Q}if(this.showPreviousButton){this.showPreviousButton.touchMode=Q}},_applyMinWidth:function(){if(this.minWidth!==-1){this.elements.container.setStyles({width:this.minWidth+"px"})}else{this.elements.container.setStyles({width:""})}this.buttonGroup.getContent().setStyle("margin-left","0px");if(!this.showComboBoxFlag){this.showPreviousButton.disabled=true;this.showNextButton.disabled=false}this.redrawTabBar()},_closeListener:function(R){this.modelEvent.publish({event:H,data:{index:R._index,value:R.value,tabBar:this}});this.fire("removeTab",{index:R._index,value:R.value,tabBar:this});if(this.autoCloseFlag){if(this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&this.pinnedList.indexOf(R.value)!==-1){this._removePinnedButton(R.value)}if(this.showComboBoxFlag){this._removeValueComboBox(R.value)}this.removeTab(R.value);R.remove();this._removeHistoryFromButton(R.value);var T=this.buttonGroup._getButtonList();for(var Q=T.length-1;Q>=0;Q--){var R=T[Q];if(R instanceof a&&R.checkFlag){R.remove()}}var S=this._getMaxHistory();if(S){this.setPropertyFromUIInteraction("value",[S])}else{this.setPropertyFromUIInteraction("value",[])}}},_searchItemInContextualMenu:function(S,R){var Q=false;if(S!==undefined){S.forEach(function(T){if(T.title===R){Q=true}})}return Q},_createCloseButtonFlag:function(Q){var R=this;if(this.displayStyle.indexOf("strip")!==-1){Q.elements._closeButton=new d.Element("div",{"class":"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-chevron-down"});Q.getContent().insertBefore(Q.elements._closeButton,Q.getContent().lastChild.nextSibling);Q.elements._closeButton.addClassName("button-close-unvisible");Q.elements._closeButton.addEventListener("click",function(V){var T=this;var W=[];if(R.closeButtonFlag&&!R._searchItemInContextualMenu(W,o.close)){W.push({type:"PushItem",title:o.close,action:{callback:function(){R._closeListener(T.parentNode.dsModel)}}})}if(R.editableFlag&&!R._searchItemInContextualMenu(W,o.rename)){W.push({type:"PushItem",title:o.rename,action:{callback:function(){R._editTab(T.parentNode.dsModel.value)}}})}R.modelEvent.publish({event:u,data:{menu:W,index:T.parentNode.dsModel._index,value:T.parentNode.dsModel.value}});var S=this.parentNode.getBoundingClientRect();var U=26;if(T.parentNode.dsModel.touchMode===true){U=44}if(W.length!==0){E.show(W,{position:{x:S.left+S.width-U,y:S.top+S.height}})}})}else{if(this.displayStyle.indexOf("bullet")===-1&&!Q.elements._closeButton||Q.elements._closeButton&&Q.getContent().lastChild!==Q.elements._closeButton){Q.elements._closeButton=new d.Element("button",{"class":"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-wrong"});Q.getContent().insertBefore(Q.elements._closeButton,Q.getContent().lastChild.nextSibling);Q.elements._closeButton.value="close"}}Q.getContent().addClassName("wux-controls-tabbar-closebutton")},_updateView:function(){var U=this.buttonGroup._getButtonList();for(var T=0;T<U.length;T++){if(U[T] instanceof F){var Q;if(this.displayStyle.indexOf("bullet")!==-1){Q=C(this.buttonGroup._getButtonList(),U[T])}else{Q=C(this.togglesTab,U[T])}if(Q){if(this.displayStyle.indexOf("bullet")!==-1){U[T].visibleFlag=Q.checkFlag;Q.checkFlag=U[T].checkFlag}}}else{if(U[T] instanceof a){U[T].show();if(U[T].elements.checkSign.hasClassName(U[T]._toggleIcon)){U[T].elements.checkSign.removeClassName(U[T]._toggleIcon)}if(this.buttonGroup.value.length<=0){if(U[0]){U[0].checkFlag=true}}if(U[T]){var S=p(U,U[T]);if(S&&S instanceof F){S.visibleFlag=U[T].checkFlag;S.checkFlag=U[T].checkFlag}}}}if(this.pinnedList&&this.pinnedList.indexOf(U[T].value)!==-1){U[T].show()}}if(this.displayStyle.indexOf("normal")!==-1){for(var R=0;R<U.length;R++){U[R].show()}}this.redrawTabBar()},_applyDisplayStyle:function(T){var S=this.value?this.value.slice():[];if(this.displayStyle.indexOf("bullet")!==-1){if(this.touchMode){this.touchMode=false}if(this.closeButtonFlag){this.closeButtonFlag=false}}var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();if(this.displayStyle.indexOf("normal")!==-1){R.removeClassName("wux-controls-toggle-selectbutton");R.removeClassName("wux-controls-toggle-pinnedbutton")}}for(var Q in this.togglesTab){if(this.displayStyle.indexOf("normal")!==-1){this.buttonGroup.removeChild(this.togglesTab[Q])}else{if(this.displayStyle.indexOf("bullet")!==-1){this.buttonGroup.addChild(this.togglesTab[Q])}}}if(this.displayStyle.indexOf("wide")===-1){this.getContent().removeClassName("wux-controls-tabbar-display-wide")}else{this.getContent().addClassName("wux-controls-tabbar-display-wide")}if(this.displayStyle.indexOf("vertical")!==-1){this.elements.buttonsContainer.addClassName("wux-controls-tabbar-vertical");this.elements.tabBar.addClassName("wux-controls-tabbar-vertical");this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-vertical");var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.addClassName("wux-controls-tabbar-vertical");R.tooltipInfos=new B({shortHelp:V[U].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){R.dsModel.showLabelFlag=false}}if(this.showComboBoxFlag){this.tabComboBox.remove();this.tabComboBox.inject(this.elements.container)}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel");this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.removeClassName("wux-controls-tabbar-panel");if(this.displayStyle.indexOf("strip")!==-1){this.elements.container.addClassName("wux-controls-tabbar-vertical")}else{this.elements.container.removeClassName("wux-controls-tabbar-vertical")}}else{if(this.displayStyle.indexOf("panel")!==-1){var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.addClassName("wux-controls-tabbar-panel")}this.buttonGroup.getContent().addClassName("wux-controls-tabbar-panel");this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel")}else{this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-vertical");this.elements.tabBar.removeClassName("wux-controls-tabbar-vertical");this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-vertical");var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.tooltipInfos=null;R.removeClassName("wux-controls-tabbar-vertical");R.removeClassName("wux-controls-tabbar-panel")}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel");this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.removeClassName("wux-controls-tabbar-panel");if(this.tabComboBox&&this.showComboBoxFlag){this.tabComboBox.remove();this.tabComboBox.inject(this.elements.tabBar,"before")}}}if(this.displayStyle.indexOf("strip")!==-1){this.pinFlag=false;c.call(this);this._addTooltips();this.menuContextual=[]}else{if(T&&(T.indexOf("strip")!==-1||T==="strip")){r.call(this)}}this._updateView();this.buttonGroup.getContent().setStyle("margin-left","0px");if(this.tabComboBox){if(this.displayStyle.indexOf("panel")!==-1){this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel")}else{this.tabComboBox.getContent().removeClassName("wux-controls-tabbar-panel")}}this.value=S},_addPinnedButton:function(R){if(!this.pinnedList){this.setPropertyFromUIInteraction("pinnedList",[])}if(this.pinnedList.indexOf(R)===-1){this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.push,R)}var S=this.getButtonFromValue(R);if(this.displayStyle.indexOf("bullet")!==-1){S.show()}S.getContent().setAttributeNode(document.createAttribute("pinned"));var Q=C(this.togglesTab,S);if(Q){Q.getContent().setAttributeNode(document.createAttribute("pinned"))}return this.pinnedList},_removePinnedButton:function(R){var T=this.getButtonFromValue(R);if(T&&T.getContent().getAttributeNode("pinned")){T.getContent().removeAttributeNode(T.getContent().getAttributeNode("pinned"))}else{console.log("Ohoh ... This tab should have been pinned ...")}var Q=C(this.togglesTab,T);if(Q){Q.getContent().removeAttributeNode(Q.getContent().getAttributeNode("pinned"))}for(var S=0;S<this.pinnedList.length;S++){if(this.pinnedList[S]===R){this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.splice,S,1)}}return this.pinnedList},_getMaxHistory:function(){var U;var T=0;if(!(this.historySelection[0]&&this.getButtonFromValue(this.historySelection[0].value)&&this.getButtonFromValue(this.historySelection[0].value).visibleFlag)){for(var Q=0;Q<this.buttonGroup.getButtonCount();Q++){if(this.getButtonFromValue(this.getValueByIndex(Q)).visibleFlag){U=this.getValueByIndex(Q)}}}for(var S in this.historySelection){var R=this.getButtonFromValue(this.historySelection[S].value);if(this.historySelection[S].cpt!==undefined&&T<=this.historySelection[S].cpt&&R&&R.visibleFlag){U=this.historySelection[S].value;T=this.historySelection[S].cpt}}return U},_setHistoryFromButton:function(R,S){for(var Q in this.historySelection){if(this.historySelection[Q].value!==undefined&&this.historySelection[Q].value===R.value){this.historySelection[Q].cpt=S;return}}},_removeHistoryFromButton:function(R){for(var Q in this.historySelection){if(this.historySelection[Q].value!==undefined&&this.historySelection[Q].value===R){this.historySelection.splice(Q,1);return}}},_indexesFromValues:function(Q){var S=[];if(Q!==undefined&&Q!==null){var V=this.buttonGroup._getButtonList();for(var R=0;R<Q.length;R++){for(var U=0;U<V.length;U++){var T=V[U];if(T.value===Q[R]&&T instanceof F){S.push(T._index)}}}}return S},_hasOverflow:function(){var Z=this;var S=0;if(Z.showComboBoxFlag){if(Z.tabComboBox&&Z.tabComboBox.getContent()){S=Z.tabComboBox.getContent().getBoundingClientRect().width}}var ad=0;if(Z.newTabButtonFlag){if(Z.newTabButton&&Z.newTabButton.getContent()){ad=Z.newTabButton.getContent().getBoundingClientRect().width}}var ae=Z.buttonGroup.getContent().getBoundingClientRect().width+S+ad;var ab=Z.elements.container.getBoundingClientRect().width;if(ab!==0){if(Z.showComboBoxFlag||Z.newTabButtonFlag){var R=0;Z._applyInheritWidthToButtons();var aa=Z.buttonGroup._getButtonList();for(var V=0;V<aa.length;V++){var W=aa[V];if(W.visibleFlag){var Q=window.getComputedStyle(W.getContent(),null);var T=parseInt(Q.marginLeft.slice(0,-2));var X=parseInt(Q.marginRight.slice(0,-2));var ac=W.getContent().getBoundingClientRect().width+T+X;R=R+ac}}if(R+ad>ab+1){if(this.displayStyle.indexOf("strip")==-1){var U=(100/Z.getVisibleTabCount())+"%";var aa=Z.buttonGroup._getButtonList();for(var V=0;V<aa.length;V++){var W=aa[V];if(W.visibleFlag){W.getContent().style.width=U}}}Z.getContent().setAttributeNode(document.createAttribute("overflow"));if(!Z.centeredFlag){Z.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered");Z.elements.tabBar.removeClassName("wux-controls-tabBar-centered");Z.elements.container.removeClassName("wux-controls-tabBar-centered")}return true}else{Z._applyInheritWidthToButtons()}}else{if(ae>ab){Z.getContent().setAttributeNode(document.createAttribute("overflow"));if(this.displayStyle.indexOf("panel")!==-1&&!this.showComboBoxFlag){var Y;(this.touchMode===true)?Y="38px":Y="22px";this.elements.tabBar.style.marginLeft=Y}return true}}}this.getContent().removeAttribute("overflow");if(this.displayStyle.indexOf("panel")!==-1&&!this.showComboBoxFlag){this.elements.tabBar.style.marginLeft="0px"}if(this.centeredFlag&&this.showComboBoxFlag){this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered");this.elements.tabBar.addClassName("wux-controls-tabBar-centered");this.elements.container.addClassName("wux-controls-tabBar-centered")}return false},_createButtonsNextAndPrevious:function(){var Q=this;if(!this.showPreviousButton){this.showPreviousButton=new F({icon:(this.displayStyle.indexOf("strip")!==-1)?{iconName:"open-left",fontIconFamily:1}:"PreviousImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});this.showPreviousButton.tooltipInfos=new B({shortHelp:o.previousItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")}this.showPreviousButton.getContent().inject(this.elements.buttonsContainer);this.showPreviousButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonPrevious");this.showPreviousButton.addEventListener("click",function(){Q._slideTabBar("left")})}if(!this.showNextButton){this.showNextButton=new F({icon:(this.displayStyle.indexOf("strip")!==-1)?{iconName:"open-right",fontIconFamily:1}:"NextImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});this.showNextButton.tooltipInfos=new B({shortHelp:o.nextItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip")}this.showNextButton.getContent().inject(this.elements.containerAddandNextButton);this.showNextButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNext");this.showNextButton.addEventListener("click",function(){Q._slideTabBar("right")})}this._showButtonsNextAndPrevious()},_showButtonsNextAndPrevious:function(){var Y=false;if(!this.showPreviousButton.visibleFlag){this._slideTabBar("left")}if(!(this.showPreviousButton.visibleFlag&&this.showNextButton.visibleFlag)){this.showPreviousButton.visibleFlag=true;this.showNextButton.visibleFlag=true;if(this.displayStyle.indexOf("immersif")!==-1){this.showPreviousButton.elements.icon.addClassName("wux-controls-showprevious-immersif");this.showNextButton.elements.icon.addClassName("wux-controls-shownext-immersif");this.showPreviousButton.getContent().addClassName("wux-controls-showprevious-immersif");this.showNextButton.getContent().addClassName("wux-controls-shownext-immersif");this.elements.buttonGroupContainer.addClassName("wux-controls-buttonGroup-immersif")}else{this.showPreviousButton.elements.icon.removeClassName("wux-controls-showprevious-immersif");this.showNextButton.elements.icon.removeClassName("wux-controls-shownext-immersif");this.showPreviousButton.getContent().removeClassName("wux-controls-showprevious-immersif");this.showNextButton.getContent().removeClassName("wux-controls-shownext-immersif");this.elements.buttonGroupContainer.removeClassName("wux-controls-buttonGroup-immersif")}var W=this.buttonGroup._getButtonList();for(var S=0;S<W.length;S++){var T=W[S];if(!Y&&T.visibleFlag===true&&this.displayStyle.indexOf("immersif")!==-1){T.getContent().addClassName("wux-controls-button-show-firstbutton")}else{if(S===W.length-1&&this.displayStyle.indexOf("bullet")!==-1){W[W.length-1].getContent().addClassName("wux-controls-button-show-lastbutton")}}}var X=false;for(var R=W.length-1;R>=0;R--){var T=W[R];if(!X&&T.visibleFlag===true){if(this.displayStyle.indexOf("immersif")!==-1){T.getContent().addClassName("wux-controls-button-show-lastbutton");T.getContent().removeClassName("wux-controls-button-show-firstbutton")}X=true}}}var U=this.buttonGroup.getContent().scrollWidth;var V=this.elements.tabBar.getBoundingClientRect().width;var Q=V-U;if(this.slide>0){this.slide=0}if(this.slide<Q){this.slide=Q}this._manageButtonsVisibility(Q);t(this)},_hideButtonsNextAndPrevious:function(){if(this.showPreviousButton&&this.showNextButton){if(this.showPreviousButton.visibleFlag){this.showPreviousButton.visibleFlag=false;this.showNextButton.visibleFlag=false;this._slideTabBar("left")}else{this.showPreviousButton.visibleFlag=false;this.showNextButton.visibleFlag=false}t(this)}},_manageButtonsVisibility:function(Q){if(this.showPreviousButton&&this.showNextButton){if(Q===0){this._hideButtonsNextAndPrevious()}else{this.showPreviousButton.visibleFlag=true;this.showNextButton.visibleFlag=true;if(this.slide===0){this.showPreviousButton.disabled=true;this.showNextButton.disabled=false}else{if(this.slide===Q){this.showPreviousButton.disabled=false;this.showNextButton.disabled=true}else{this.showPreviousButton.disabled=false;this.showNextButton.disabled=false}}}}else{if(this.slide===0){this._maxSlide="left"}else{if(this.slide===Q){this._maxSlide="right"}else{this._maxSlide=""}}}},_slideTabBar:function(V){if(V==="left"&&(this.showPreviousButton&&this.showPreviousButton.disabled||this._maxSlide==="left")){return}else{if(V==="right"&&(this.showNextButton&&this.showNextButton.disabled||this._maxSlide==="right")){return}}var U=this.buttonGroup.getContent().scrollWidth;var S=this.elements.tabBar.getBoundingClientRect().width;var R=S-U;R=R>0?0:R;if(this.slide>0){this.slide=0}if(this.slide<R){this.slide=R}var Q;if(V==="right"){Q=this.slide-this.slideStep;var T=(Q>R)?Q:R;if(this.slide+T<R){if(this.displayStyle.indexOf("immersif")!==-1){this.slide+=(R-this.slide)}else{this.slide+=(R-this.slide-5)}R=this.slide}else{this.slide+=T;if(this.displayStyle.indexOf("immersif")===-1){this.slide+=-5;R+=-5}}}else{if(V==="left"){Q=this.slide+this.slideStep;this.slide=(Q<=0)?Q:0}}this.buttonGroup.getContent().setStyle("margin-left",this.slide+"px");this._manageButtonsVisibility(R)},_applyValue:function(Q){if(this.value!==undefined){if(d.equals(Q,this.value)){return}this.buttonGroup.value=this.value;if(this.tabComboBox&&this.showComboBoxFlag){this.tabComboBox.currentValue=this.value[0]}var R=this.getButtonFromValue(this.value[0]);this._slideToValue();if(this.displayStyle.indexOf("strip")!==-1){if(R&&R.elements._closeButton){R.elements._closeButton.removeClassName("button-close-unvisible");R.getContent().addClassName("remove-padding-class")}if(Q){var S=this.getButtonFromValue(Q[0]);if(S&&S.elements._closeButton){S.elements._closeButton.addClassName("button-close-unvisible");S.getContent().removeClassName("remove-padding-class")}}}if(this.displayStyle.indexOf("bullet")!==-1){this._updateView()}this.redrawTabBar();this.fire("change")}},_slideToValue:function(){if(this.value&&this.value.length>0){var T=this.getButtonFromValue(this.value[0]);if(T){var V=this.buttonGroup.getContent().scrollWidth;var R=this.elements.tabBar.getBoundingClientRect().width;var Q=R-V;var U=T.getContent().getPosition(this.buttonGroup.getContent()).x;var W=U+T.getContent().getDimensions().outerWidth;var S=this.elements.tabBar.getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left;if(S>=0&&U>=0&&S>=U){this.slide=-U}else{if(R+S<W){this.slide=R-W}else{return}}if(this.slide<Q){this.slide=Q}if(this.slide>0){this.slide=0}this.buttonGroup.getContent().setStyle("margin-left",this.slide+"px")}}},_comboCB:function(Q){Q.stopPropagation();if(this.showComboBoxFlag&&this.value[0]!==this.tabComboBox.currentValue){this.setPropertyFromUIInteraction("value",[this.tabComboBox.currentValue])}},_removeValueComboBox:function(R){for(var Q=0;Q<this._history.getRoots().length;Q++){if(this._history.getRoots()[Q].options.grid.valueItem===R){this._history.removeRoot(this._history.getRoots()[Q])}}this.tabComboBox.elementsTree=this._history},_removeTooltips:function(){var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R].getContent();Q.tooltipInfos=null}},_addTooltips:function(){var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R].getContent();Q.tooltipInfos=new B({shortHelp:S[R].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton})}},_updateComboBox:function(Q){var U=this.buttonGroup._getButtonList();for(var S=0;S<U.length;S++){if(U[S].visibleFlag){var T=new v({label:U[S].label,index:U[S]._index,grid:{valueItem:U[S].value},icons:U[S].icon?[{iconName:(U[S].icon instanceof Object?U[S].icon.iconName:U[S].icon)}]:""});var V=false;for(var R=0;R<this._history.getRoots().length;R++){if(this._history.getRoots()[R].options.grid.valueItem===T.options.grid.valueItem||(Q!==undefined&&Q===this._history.getRoots()[R].options.index)){V=true;this._history.getRoots()[R].options.label=T.options.label;this._history.getRoots()[R].options.icons=T.options.icons;this._history.getRoots()[R].options.grid.valueItem=T.options.grid.valueItem;break}}if(!V){this._history.addRoot(T,U[S]._index)}else{}}}this.tabComboBox.elementsTree=this._history},_changeButtonIndexInComboBox:function(S,R){var T=new v({label:S.label,grid:{valueItem:S.value}});var U;for(var Q=0;Q<this._history.getRoots().length;Q++){if(this._history.getRoots()[Q].options.grid.valueItem===T.options.grid.valueItem){U=this._history.getRoots()[Q];break}}if(U){this._history.removeRoot(U)}this._history.addRoot(T,R)},getButtonFromValue:function(V){var U=this.buttonGroup._getButtonList();var T;if(U){if(Array.isArray(V)){var S=[];for(var R=0;R<U.length;R++){T=U[R];for(var Q=0;Q<V.length;Q++){if(V[Q]===T.value&&T instanceof F&&this.displayStyle.indexOf("bullet")===-1){S.push(T)}else{if(V[Q]===T.value&&T instanceof a&&this.displayStyle.indexOf("bullet")!==-1){S.push(T)}}}}return S}else{for(var R=0;R<U.length;R++){T=U[R];if(T.value===V){return T}}}}},_updateButtonFocus:function(){if(this.value&&this.value.length>0){var Q=this.getButtonFromValue(this.value[0]);if(Q){Q.getContent().blur();Q.getContent().focus()}}},getWidthWithoutScroll:function(){this.redrawTabBar();if(G){return G}},getMinWidthWithoutScroll:function(){this.redrawTabBar();var S=0;var R=this.getVisibleTabCount();var T=this.buttonGroup._getButtonList();for(var Q=0;Q<R;Q++){if(T[Q]){S=S+T[Q].getContent().getBoundingClientRect().minWidth}}if(this.showComboBoxFlag){S=S+this.tabComboBox.getContent().getBoundingClientRect().width}return S},getWidthOfAllVisibleButtons:function(){var T=this;var U=0;var S=T.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R];if(Q.visibleFlag){U=U+this.getWidthOfButton(Q)}}return U+3},getWidthOfButton:function(Q){var R=window.getComputedStyle(Q.getContent(),null);var T=parseInt(R.marginLeft.slice(0,-2));var S=parseInt(R.marginRight.slice(0,-2));return Q.getContent().getBoundingClientRect().width+T+S},_applyInheritWidthToButtons:function(){var T=this;var S=T.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R];if(Q.visibleFlag){Q.getContent().style.width="inherit"}}},_getButtonByIndex:function(Q){var T=this.buttonGroup._getButtonList();var S;if(T){for(var R=0;R<T.length;R++){S=T[R];if(S._index===Q){return S}}}return undefined},getValueByIndex:function(Q){var R=this._getButtonByIndex(Q);if(R){return R.value}else{return undefined}},getIndexesByValues:function(V){var U=[];for(var T=0;T<V.length;T++){var S=this.getButtonFromValue(V[T]);if(this.displayStyle.indexOf("bullet")===-1){if(S===undefined){U[T]=undefined}else{var R=S._index;if(R!==undefined){U[T]=R}}}else{var Q=p(this.buttonGroup._getButtonList(),S);if(Q===undefined){U[T]=undefined}else{var R=Q._index;if(R){U[T]=R}}}}return U},getTabCount:function(){if(this.buttonGroup){if(this.displayStyle.indexOf("bullet")!==-1){return this.buttonGroup.getButtonCount()/2}else{return this.buttonGroup.getButtonCount()}}},getVisibleTabCount:function(){if(this.buttonGroup){var Q=0;var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){if(S[R].visibleFlag){Q++}}return Q}},_getVisibleTabButtons:function(){if(this.buttonGroup){var Q=[];var T=this.buttonGroup._getButtonList();for(var S=0;S<T.length;S++){var R=T[S];if(R.visibleFlag){Q.push(R)}}return Q}return null},add:function(Y){if(Y.allowClosableFlag===undefined){Y.allowClosableFlag=true}var T=this.buttonGroup.getButtonCount();if(Y.index===undefined){Y.index=T}if(Y.isSelected===undefined||Y.isSelected===null){Y.isSelected=false}if(Y.showTitleFlag===undefined||Y.showTitleFlag===null){Y.showTitleFlag=true}var V=(Y.value!==undefined&&Y.value!==null)?Y.value:Y.index;var S=1;while(this.getButtonFromValue(V)){V++}var ab=Y.icon;if(ab&&ab.iconName){ab={iconName:ab.iconName,fontIconFamily:ab.fontIconFamily?ab.fontIconFamily:0}}var W=new F({label:Y.label,type:"radio",value:V,checkFlag:Y.isSelected,clickMode:S,showLabelFlag:Y.showTitleFlag,icon:ab,touchMode:Y.touchMode,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});W._index=Y.index;var X=new a({type:"radio",value:V,checkFlag:Y.isSelected,clickMode:S,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});X._index=Y.index;var R=Y.index;while(this.togglesTab.hasOwnProperty(R)){R++}this.togglesTab[R]=X;if(this.closeButtonFlag&&Y.allowClosableFlag){this._createCloseButtonFlag(W)}var aa;if(T===0){W.inject(this.buttonGroup.elements.container)}else{var Z=this.buttonGroup._getButtonList();for(var U=0;U<Z.length;U++){var Q=Z[U];if(Q._index<Y.index){aa=Q}}}if(aa){W.inject(aa.getContent(),"after")}else{W.inject(this.buttonGroup.getButton(0).getContent(),"before")}this._updateIndexOfTab();this.buttonGroup._updateChildPropertiesAndListeners(W,W._index);this.historySelection[this.historySelection.length]={value:W.value,cpt:this.cptSelection};W.getContent().setAttribute("role","tab");if(!this.showComboBoxFlag){if(this.displayStyle.indexOf("strip")===-1){this._hideButtonsNextAndPrevious()}}this._applyDisplayStyle();if(this.showComboBoxFlag){this._updateComboBox()}t(this);return W},addTab:function(S,R,Q,V,U,X,W){var T={label:S,index:R,isSelected:Q,value:V,icon:U,allowClosableFlag:X,showTitleFlag:W};return this.add(T)},setAllowClosableFlagOnValue:function(R,S){var Q=this.getButtonFromValue(R);if(Q){if(this.closeButtonFlag&&S&&!Q.elements._closeButton){this._createCloseButtonFlag(Q)}if(Q.elements._closeButton){if(this.closeButtonFlag&&S){Q.elements._closeButton.show();Q.getContent().addClassName("wux-controls-tabbar-closebutton")}else{Q.elements._closeButton.hide();Q.getContent().removeClassName("wux-controls-tabbar-closebutton")}}}},changeLabel:function(S,R){var Q=new Error("DEPRECATED METHOD");Q.name="WARNING";console.warn(Q.stack);var U=this;var T=this.buttonGroup.getButton(S);T.label=R;U.modelEvent.publish({event:O,data:{index:S,label:R}})},removeTab:function(S,T){var U=(this.value.indexOf(S)!==-1);if(this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&this.pinnedList.indexOf(S)!==-1){this._removePinnedButton(S)}if(this.getButtonFromValue(S)===undefined){return}this._preventButtonGroupListener=U;if(T){this.getButtonFromValue(S).visibleFlag=false;document.body.appendChild(this.getButtonFromValue(S).getContent())}this.buttonGroup.removeChild(this.getButtonFromValue(S));this._preventButtonGroupListener=false;if(this.displayStyle.indexOf("bullet")!==-1){var Q=y(this.togglesTab,S);this.togglesTab[Q].destroy();this.togglesTab[Q]=null;delete this.togglesTab[Q]}this._updateIndexOfTab();if(this.showComboBoxFlag){this._removeValueComboBox(S)}this._removeHistoryFromButton(S);if(U){var R=this._getMaxHistory();if(R){this.value=[R]}else{this.value=[]}}t(this);this._updateIndexOfTab();this.redrawTabBar()},updateTab:function(T,R){var Q=this.getButtonFromValue(T);if(Q){var S=((Q.label!=R.label)||(Q.icon!=R.icon));if(R.label!==undefined){Q.label=R.label;if(Q.elements._closeButton){Q.getContent().insertBefore(Q.elements._closeButton,Q.elements.lastChild)}}if(R.icon!==undefined){Q.icon=R.icon}if(R.allowClosableFlag!==undefined){this.setAllowClosableFlagOnValue(T,R.allowClosableFlag)}if(R.showTitleFlag!==undefined){Q.showLabelFlag=R.showTitleFlag}if(S&&this.showComboBoxFlag){this._updateComboBox()}}},getOptionFromButton:function(R,S){var Q=this.getButtonFromValue(S);if(Q&&Q[R]){return Q[R]}},setOptionFromButton:function(S,R,T){var Q=this.getButtonFromValue(T);if(Q){Q[S]=R}if(this.showComboBoxFlag&&(S==="icon"||S==="label")){this._updateComboBox()}},_editTab:function(V){var U=this;m=U.getButtonFromValue(V);if(U.closeButtonFlag&&m.elements._closeButton){m.elements._closeButton.hide()}var R=m.getContent().getBoundingClientRect().width-parseInt(window.getComputedStyle(m.getContent()).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(m.getContent()).getPropertyValue("border-right"));var Q=m.getContent().getBoundingClientRect().height-8;var T=m.elements.container.getElements(".wux-controls-lineeditor");if(m instanceof F&&(U.editableFlag||m.label===o.newTab)&&T.length===0){var X=m.elements.text?m.elements.text.innerHTML:"";var W=m.elements.text?m.elements.text.getBoundingClientRect().width:0;if(m.elements.text){m.elements.text.hide()}m.getContent().addClassName("wux-controls-tabbar-button-nopadding");g=new K({value:X,touchMode:this.touchMode,selectAllOnFocus:(this.displayStyle.indexOf("strip")!==-1)?true:false}).inject(m.elements.container);g.getContent().setAttributes({height:Q+"px",width:R+"px",position:"relative"});var S=U.displayStyle==="panel"||"strip"?"22px":"11px";g._myInput.style.width=(this.displayStyle.indexOf("strip")!==-1)?W+"px":R-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("padding-left"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("padding-right"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("border-right"))+"px";g._myInput.style.height=this.touchMode?"22px":S;g._myInput.style.minWidth="44px";g._myInput.style.marginLeft=m.elements.text?"0px":"4px";g._myInput.style.lineHeight=g._myInput.style.height;g.getContent().style.display="inline-block";g._myInput.focus()}U.modelEvent.publish({event:s,data:{value:V}});this.fire("edit",{value:V})},_endEditTab:function(){var R=this;if(m){var Q=m.elements.container.getElements(".wux-controls-lineeditor");if(Q&&Q[0]){m.label=Q[0].dsModel.value;if(Q[0].parentElement){Q[0].remove()}m.getContent().removeClassName("wux-controls-tabbar-button-nopadding");if(m.elements.text){m.elements.text.show()}if(R.closeButtonFlag&&m.elements._closeButton){m.elements._closeButton.show()}if(this.showComboBoxFlag&&this.tabComboBox){R._updateComboBox()}R.modelEvent.publish({event:n,data:{button:m}});R.fire("endEdit",{button:m})}}},_updateIndexOfTab:function(){var R=this.buttonGroup._getButtonList();for(var Q=0;Q<R.length;Q++){R[Q]._index=Q}},_setTabVisibility:function(V,Q){var U=this;var R=U.getButtonFromValue(V);var T=R.visibleFlag;R.visibleFlag=Q;R.checkFlag=false;if(this.showComboBoxFlag){if(!Q&&T){this._removeValueComboBox(V)}else{if(Q&&!T){this._updateComboBox()}}}if(!Q&&this.value&&this.value.length===1&&this.value[0]===V){var S=this._getMaxHistory();if(S){this.value=[S]}else{this.value=[]}}t(this)},pinTab:function(Q){this._pinTab(Q)},_pinTab:function(T){var S=this;var R=S.getButtonFromValue(T);var Q=R._index;if(R&&S.pinFlag){if(this.pinnedList&&this.pinnedList.indexOf(T)!==-1){this._removePinnedButton(R.value);S.modelEvent.publish({event:b,data:{index:Q,value:R.value}});S.fire("pinStateChange",{value:T,pinnedFlag:false})}else{this._addPinnedButton(R.value);S.modelEvent.publish({event:D,data:{index:Q,value:R.value}});S.fire("pinStateChange",{value:T,pinnedFlag:true})}S.fire("change");S.redrawTabBar();S._hasOverflow()}},redrawTabBar:function(){var U=this.buttonGroup.getContent().getBoundingClientRect().width;if(this.displayStyle.indexOf("panel")!==-1&&this.tabComboBox){var V=24;if(this.touchMode){V=36}var S=2*V;this.buttonGroup.visibleFlag=true;this.tabComboBox.getContent().addClassName("wux-button-tabBar-combo-right");if(this.getContent().getBoundingClientRect().width<S){this.buttonGroup.visibleFlag=false;this.tabComboBox.getContent().removeClassName("wux-button-tabBar-combo-right")}}if(this.visibleFlag&&U!==0){if(this._hasOverflow()||(this.displayStyle.indexOf("panel")!==-1&&!this.buttonGroup.visibleFlag)){G=U+2;if(this.showComboBoxFlag){this._addTooltips();this.tabComboBox.show();if(this.displayStyle.indexOf("strip")!==-1){this._showButtonsNextAndPrevious()}}else{this._showButtonsNextAndPrevious()}if(this.slide>1){this._updateButtonFocus()}if(this.touchMode){if(this.elements.tabBar.getSize().width<54){this._hideButtonsNextAndPrevious()}}else{if(this.elements.tabBar.getSize().width<36){this._hideButtonsNextAndPrevious()}}}else{this.buttonGroup.getContent().setStyle("margin-left",0+"px");G=U+2;if(this.showComboBoxFlag){this._removeTooltips();this.tabComboBox.hide();if(this.displayStyle.indexOf("strip")!==-1){if(this.showPreviousButton&&this.showNextButton){this._hideButtonsNextAndPrevious()}}}else{this._hideButtonsNextAndPrevious()}}if(this.newTabButtonFlag){this._applyNewTabButtonFlag()}if(this.buttonGroup.value){var T=this.buttonGroup._getButtonList();for(var R=0;R<T.length;R++){var Q=T[R];if(this.displayStyle.indexOf("bullet")!==-1&&Q.checkFlag){Q.getContent().addClassName("wux-controls-toggle-selectbutton")}e(this,Q)}}if(this.showComboBoxFlag){this._updateComboBox()}}},onSelectTab:function(Q){return this.modelEvent.subscribe({event:f},Q)},onBeginTabDrag:function(Q){return this.modelEvent.subscribe({event:P},Q)},onEndTabDrag:function(Q){return this.modelEvent.subscribe({event:h},Q)},unPinTab:function(Q){return this.modelEvent.subscribe({event:b},Q)},onPinTab:function(Q){return this.modelEvent.subscribe({event:D},Q)},onEditTab:function(Q){return this.modelEvent.subscribe({event:s},Q)},onEndEditTab:function(Q){return this.modelEvent.subscribe({event:n},Q)},onChangeLabelTab:function(Q){return this.modelEvent.subscribe({event:O},Q)},onPreNewTab:function(Q){return this.modelEvent.subscribe({event:L},Q)},onNewTab:function(Q){return this.modelEvent.subscribe({event:J},Q)},onRemoveTabEvent:function(Q){return this.modelEvent.subscribe({event:H},Q)},onContextualMenuEvent:function(Q){return this.modelEvent.subscribe({event:u},Q)},destroy:function(){function R(T,S){if(T&&T[S]){T[S].destroy();T[S]=null}}z.removeResizeListener(this.elements.container,this._onResizeFun,0);R(this,"buttonGroup");R(this,"newTabButton");R(this,"showPreviousButton");R(this,"showNextButton");R(this,"newTabComboBox");R(this,"tabComboBox");for(var Q in this.togglesTab){if(Q){R(this.togglesTab,Q)}}this._parent()}});var C=function(S,R){if(!S||!R){throw new Error("WRONG PARAMETERS")}for(var Q in S){if(R.value===S[Q].value){return S[Q]}}};var y=function(S,R){for(var Q in S){if(R===S[Q].value){return Q}}};var p=function(S,Q){if(!S||!Q){throw new Error("WRONG PARAMETERS")}for(var R=0;R<S.length;++R){if(Q.value===S[R].value&&S[R] instanceof F){return S[R]}}};var e=function(Q,S){if(!Q||!S){throw new Error("WRONG PARAMETER")}if(Q.pinnedList&&Q.pinnedList.length>0){for(var R=0;R<Q.pinnedList.length;++R){if(S.value===Q.pinnedList[R]){if(Q.displayStyle.indexOf("normal")!==-1){S.getContent().removeClassName("wux-controls-toggle-pinnedbutton")}else{if(Q.displayStyle.indexOf("bullet")!==-1){S.getContent().addClassName("wux-controls-toggle-pinnedbutton");S.show()}}}}}};var t=function(Q){if(Q.displayStyle.indexOf("strip")!==-1){return}var V=Q._getVisibleTabButtons();var S;var R=0;var W="wux-controls-button-";var U=Q.getVisibleTabCount();if(U===1){V[0].getContent().addClassName(W+"onlyone");V[0].getContent().removeClassName(W+"allothers");V[0].getContent().removeClassName(W+"lastone");V[0].getContent().removeClassName(W+"firstone");if(Q.displayStyle.indexOf("normal")!==-1){V[0].getContent().setStyle("margin-right",0+"px")}if(V[1]){V[1].getContent().addClassName(W+"lastone")}}else{for(var T=0;T<U;T++){Q.slide=0;S=V[T].getContent();S.removeClassName(W+"show-lastbutton");S.removeClassName(W+"show-firstbutton");if(V[T].visibleFlag===true){if(Q.displayStyle.indexOf("bullet")!==-1){if(R===0){S.addClassName(W+"firstone");S.removeClassName(W+"allothers");S.removeClassName(W+"lastone");S.removeClassName(W+"onlyone");R=1}else{if(T===U-1){S.addClassName(W+"lastone");S.removeClassName(W+"allothers");S.removeClassName(W+"firstone");S.removeClassName(W+"onlyone")}else{S.addClassName(W+"allothers");S.removeClassName(W+"onlyone");S.removeClassName(W+"firstone");S.removeClassName(W+"lastone")}}}else{if(T===0){S.addClassName(W+"firstone");S.removeClassName(W+"allothers");S.removeClassName(W+"lastone");S.removeClassName(W+"onlyone")}else{if(T===U-1){S.addClassName(W+"lastone");S.removeClassName(W+"allothers");S.removeClassName(W+"firstone");S.removeClassName(W+"onlyone")}else{S.addClassName(W+"allothers");S.removeClassName(W+"onlyone");S.removeClassName(W+"firstone");S.removeClassName(W+"lastone")}}}}}}};var k=function(){var T=this.add({label:o.newTab,touchMode:this.touchMode});var S=T._index;var V=T.value;this.modelEvent.publish({event:L,data:{index:S,value:T.value}});this.fire("preAddTab",{index:S,value:T.value});if(V!==T.value){this.historySelection[this.historySelection.length]={value:T.value,cpt:1};if(this.showComboBoxFlag){this._updateComboBox(S)}}this.buttonGroup.selectIndex(S);this._editTab(T.value);var U=this.buttonGroup.getContent().scrollWidth;var R=this.elements.tabBar.getBoundingClientRect().width;var Q=R-U;this.slide=(R/2)-(T.getContent().getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left);if(this.slide<Q){this.slide=Q}if(this.displayStyle.indexOf("immersif")===-1){this.slide-=5}this.redrawTabBar();if(g){g._myInput.focus()}this.modelEvent.publish({event:J,data:{index:S}});this.fire("addTab",{index:S})};var c=function(){this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-strip");this.elements.buttonsContainer.addClassName("wux-controls-tabbar-strip");this.elements.container.addClassName("wux-controls-tabbar-strip");if(this.newTabButton){this.newTabButton.inject(this.elements.containerAddandNextButton);this.newTabButton.getContent().addClassName("wux-controls-tabbar-strip");this.newTabButton.icon="plus";this.newTabButton.label="";if(!this.newTabButtonFlag){this.newTabButton.hide()}}if(!this.showPreviousButton&&!this.showNextButton){this._createButtonsNextAndPrevious()}if(this.showPreviousButton){this.showPreviousButton.icon={iconName:"open-left",fontIconFamily:1};this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")}if(this.showNextButton){this.showNextButton.icon={iconName:"open-right",fontIconFamily:1};this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip")}if(this.newTabButton){this.newTabButton.getContent().style.marginLeft="0px"}if(this.tabComboBox){this.tabComboBox.expanderIcon=this.newTabButtonFlag?"list-add":"list";this.tabComboBox.getContent().addClassName("wux-controls-tabbar-strip");if(!this.tabComboBox.elements.popup){this.tabComboBox._buildPopup()}this.tabComboBox.elements.popup.alignment="left";this.tabComboBox.elements.popup.getContent().addClassName("wux-controls-tabbar-strip");this.tabComboBox.elements.treeListView.getManager().options.defaultCellHeight=30;i.call(this);this.tabComboBox.inject(this.elements.containerAddandNextButton)}if(this.displayStyle.indexOf("strip-box")!==-1){this.elements.container.addClassName("wux-controls-tabbar-strip-box")}};var r=function(){this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-strip");this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-strip");this.elements.container.removeClassName("wux-controls-tabbar-strip");this.elements.container.removeClassName("wux-controls-tabbar-strip-box");if(this.showPreviousButton){this.showPreviousButton.destroy();this.showPreviousButton=null}if(this.showNextButton){this.showNextButton.destroy();this.showNextButton=null}if(this.tabCombobox){this.tabCombobox.destroy();this.tabCombobox=null}this._applyShowComboBoxFlag();this._applyNewTabButtonFlag()};var i=function(){if(!this.newTabComboBox){this.newTabComboBox=new F({icon:"plus",label:o.newTab,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,});this.newTabComboBox.tooltipInfos=new B({shortHelp:o.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.newTabComboBox.elements.container.addClassName("wux-controls-tabbar-newbuttoncombo");var R=this;this.newTabComboBox.addEventListener("click",function(){k.call(R)});if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup){var Q=this.tabComboBox.elements.popup.getBody();var S=d.createElement("div");this.newTabComboBox.inject(S);Q.inject(S);this.tabComboBox.elements.popup.setBody(S)}}var Q=undefined;if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup){Q=this.tabComboBox.elements.popup.getBody()}if(this.newTabButtonFlag&&this.showComboBoxFlag){if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup&&Q.contains(this.newTabComboBox.getContent())===false){Q=this.tabComboBox.elements.popup.getBody();var S=d.createElement("div");this.newTabComboBox.inject(S);Q.inject(S);this.tabComboBox.elements.popup.setBody(S)}this.newTabComboBox.show();if(Q){Q.addClassName("wux-controls-tabbar-combopopup")}}else{this.newTabComboBox.hide();if(Q){Q.removeClassName("wux-controls-tabbar-combopopup")}}};var M=function(T,S){var Q=[];for(var R=0;R<T.length;R++){if(S.indexOf(T[R])===-1){Q.push(T[R])}}return Q};l.register(w,"DS/ControlsRec/AbstractRec");return w});define("DS/Controls/Tab",["UWA/Core","UWA/Class","DS/Controls/Abstract","DS/Controls/TabBar","DS/Utilities/Utils","DS/Controls/Button"],function(c,a,e,f,i,g){var b=e.inherit({name:"tab",markForRecordFlag:true,publishedProperties:{tabBar:{defaultValue:undefined,type:f},tabBarDOMContainer:{defaultValue:undefined,type:Object},tabPanelContainer:{defaultValue:undefined,type:Object},displayStyle:{defaultValue:"normal",type:String,category:"Appearance"},value:{defaultValue:undefined,type:[],recordFlag:true},multiSelFlag:{defaultValue:false,type:Boolean,category:"Behavior"},reorderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:true,type:"boolean",category:"Behavior"},touchMode:{defaultValue:undefined,type:"boolean",category:"Accessibility",advancedSetter:true},multiSelLayout:{defaultValue:"vertical",type:String,category:"Appearance"},newTabButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:undefined,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-tab");if(!this.tabBarDOMContainer){this.tabBarDOMContainer=new c.Element("div",{"class":"tabBarContainer"});this.tabBarDOMContainer.inject(this.elements.container,"top")}if(!this.tabPanelContainer){this.tabPanelContainer=new c.Element("div",{"class":"tabContainer"});this.tabPanelContainer.inject(this.elements.container,"bottom")}if(!this.tabBar){this.tabBar=new f({allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton})}this._tabContent=[]},_postBuildView:function(){if(this.tabBar){this.tabBar.allowUnsafeHTMLOnTabButton=this.allowUnsafeHTMLOnTabButton}},_applyReorderFlag:function(){if(this.tabBar){this.tabBar.reorderFlag=this.reorderFlag}},_applyTabBar:function(l){if(l){l.remove()}if(this.tabBar&&this.tabBarDOMContainer){if(c.is(this.tabBar,"element")){this.tabBar=new c.extendElement(this.tabBar)}this.tabBar.inject(this.tabBarDOMContainer)}},_applyTabBarDOMContainer:function(l){if(l){l.remove()}if(this.tabBarDOMContainer){if(c.is(this.tabBarDOMContainer,"element")){this.tabBarDOMContainer=new c.extendElement(this.tabBarDOMContainer)}this._applyTabBar()}},_applyTabPanelContainer:function(l){if(l){l.remove()}if(this.tabPanelContainer){if(c.is(this.tabPanelContainer,"element")){this.tabPanelContainer=new c.extendElement(this.tabPanelContainer)}this.tabPanelContainer.addClassName("wux-controls-tab-container")}},_applyShowComboBoxFlag:function(){if(this.tabBar){this.tabBar.showComboBoxFlag=this.showComboBoxFlag}},_applyNewTabButtonFlag:function(){if(this.displayStyle.indexOf("strip")!==-1&&this.tabBar){this.tabBar.newTabButtonFlag=this.newTabButtonFlag}},_applyAutoCloseFlag:function(){if(this.tabBar){this.tabBar.autoCloseFlag=this.autoCloseFlag}},_applyDisabled:function(){this._parent();if(this.tabBar){this.tabBar.disabled=this.disabled}},_applyTouchMode:function(){this._postEditTouchMode()},_postEditTouchMode:function(){var l=this._getCurrentTouchMode();this._parent();if(this.tabBar){this.tabBar.touchMode=l}},_applyDisplayStyle:function(){if(this.tabBar&&this.displayStyle&&this.tabPanelContainer){this.tabBar.displayStyle=this.displayStyle;if(this.displayStyle.indexOf("panel")!==-1){this.tabPanelContainer.addClassName("wux-controls-tabbar-panel")}if(this.displayStyle.indexOf("strip")!==-1){this.tabPanelContainer.addClassName("wux-controls-tab-strip");if(this.displayStyle.indexOf("strip-box")!==-1){this.tabPanelContainer.addClassName("wux-controls-tab-strip-box")}}else{this.tabPanelContainer.removeClassName("wux-controls-tab-strip");this.tabPanelContainer.removeClassName("wux-controls-tab-strip-box")}if(this.displayStyle.indexOf("vertical")!==-1){if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.addClassName("wux-controls-tabbar-vertical");this.tabPanelContainer.addClassName("wux-controls-tabbar-vertical");var n=this.tabBar.buttonGroup._getButtonList();for(var m=0;m<n.length;m++){var l=n[m];if(l){if(l.elements.text){l.elements.text.hide()}if(l.elements.icon){l.elements.icon.style.margin="0px 0px 0px 0px"}}}}}else{if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.removeClassName("wux-controls-tabbar-vertical");this.tabPanelContainer.removeClassName("wux-controls-tabbar-vertical");var n=this.tabBar.buttonGroup._getButtonList();for(var m=0;m<n.length;m++){var l=n[m];if(l){if(l.elements.text&&l.showLabelFlag==true){l.elements.text.show()}if(l.elements.icon&&l.label&&l.label!==""&&l.showLabelFlag==true){l.elements.icon.style.margin="0px 11px 0px 0px"}}}}}this.redrawTabBar()}},_applyMultiSelFlag:function(){if(this.tabBar){this.tabBar.multiSelFlag=this.multiSelFlag;this._applyDisplayStyle();this._applyMultiSelLayout()}},_applyMultiSelLayout:function(){if(this.multiSelFlag){if(this.multiSelLayout==="horizontal"){this.tabPanelContainer.addClassName("wux-controls-tab-horizontalMultiSelLayout");return}}this.tabPanelContainer.removeClassName("wux-controls-tab-horizontalMultiSelLayout")},_applyValue:function(o){if(o){var l=this.getIndexesFromValues(o);for(var p=0;p<l.length;p++){if(!this.tabBar.pinnedList||this.tabBar.pinnedList.indexOf(this.getPageValueFromIndex(l[p]))===-1){this._hideContent(this.getPageValueFromIndex(l[p]))}}}if(this.tabBar){this.tabBar.value=this.value;h.call(this);var n=this.getIndexesFromValues(this.value);n=n.sort();for(var m=0;m<n.length;m++){this._showContent(this.getPageValueFromIndex(n[m]))}this.redrawTabBar();this._checkForMultiSelection();this.fire("change")}},_applyRecId:function(){if(this.tabBar){this.tabBar.recId=this.recId}},_applyProperties:function(l){this._parent(l);if(this.isDirty("tabBar")){this._applyTabBar(l.tabBar)}if(this.isDirty("tabBarDOMContainer")){this._applyTabBarDOMContainer(l.tabBarDOMContainer)}if(this.isDirty("tabPanelContainer")){this._applyTabPanelContainer(l.tabPanelContainer)}if(this.isDirty("showComboBoxFlag")){this._applyShowComboBoxFlag(l.showComboBoxFlag)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(l.displayStyle)}if(this.isDirty("value")){this._applyValue(l.value)}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag(l.multiSelFlag)}if(this.isDirty("reorderFlag")){this._applyReorderFlag(l.reorderFlag)}if(this.isDirty("newTabButtonFlag")){this._applyNewTabButtonFlag(l.newTabButtonFlag)}if(this.isDirty("autoCloseFlag")){this._applyAutoCloseFlag(l.autoCloseFlag)}},_checkForMultiSelection:function(){if(!this.tabPanelContainer){return}var l=[];var n=0;if(this.value){n=this.value.length}if(this.tabBar.pinnedList){for(var m=0;m<this.tabBar.pinnedList.length;m++){if(this.value.indexOf(this.tabBar.pinnedList[m])!==-1){l.push(this.tabBar.pinnedList[m])}}n=n+this.tabBar.pinnedList.length-l.length}if(n>1){this.tabPanelContainer.addClassName("wux-controls-tab-multiSelection")}else{this.tabPanelContainer.removeClassName("wux-controls-tab-multiSelection")}},getPageCount:function(){return this.tabPanelContainer.getChildren().length},getPageContent:function(l){var n=this.tabPanelContainer.getChildren();var m=n[l];return m},getPageContentFromValue:function(m){for(var l in this._tabContent){if(this._tabContent[l].value===m){return this._tabContent[l].content}}},getPageContentFromIndex:function(l){for(var m in this._tabContent){if(this._tabContent[m].index===l){return this._tabContent[m].content}}},setPageContentFromIndex:function(m,n){if(this._tabContent&&this._tabContent.length>m){var l=this._tabContent[m].content;if(c.is(n,"element")){n=new c.extendElement(n)}n.id=this._tabContent[m].value;n.inject(l,"before");if(l.getStyle("display")==="none"){n.setStyle("display","none")}this._tabContent[m].content=n;return l.remove()}},getPageIndexFromValue:function(m){for(var l in this._tabContent){if(this._tabContent[l].value===m){return this._tabContent[l].index}}},getOptionFromButton:function(l,m){return this.tabBar.getOptionFromButton(l,m)},setOptionFromButton:function(m,l,n){return this.tabBar.setOptionFromButton(m,l,n)},getPageValueFromIndex:function(l){for(var m in this._tabContent){if(this._tabContent[m].index!==undefined&&this._tabContent[m].index===l){return this._tabContent[m].value}}},add:function(m){var l=this.tabBar.add({label:m.label,index:m.index,isSelected:false,value:m.value,icon:m.icon,allowClosableFlag:m.allowClosableFlag,showTitleFlag:m.showTitleFlag});k.call(this,m.content,l._index,l.value);if(!m.isSelected){this._hideContent(l.value)}else{this._showContent(l.value)}if(m.isSelected){this.value=[l.value]}this._applyDisplayStyle();this._postEditTouchMode();return{button:l,value:l.value}},addTab:function(r,o,n,l,s,q,t,m){var p={label:r,content:o,index:n,isSelected:l,value:s,icon:q,allowClosableFlag:t,showTitleFlag:m};return this.add(p)},removeTab:function(m,o){var l=this.getIndexOf(m);var n=this.getPageValueFromIndex(l);if(l>=0){return this.removeTabContent(n,o)}},removeTabContent:function(p,r){var q=this.tabPanelContainer.getChildren();var o=this.getPageContentFromValue(p);var l=this.getPageIndexFromValue(p);if(l===undefined||l>=q.length||l<0){return}else{for(var n=0;n<this._tabContent.length;n++){if(this._tabContent[n].index!==undefined&&this._tabContent[n].index===l){this._tabContent[n].index=undefined;this._tabContent.splice(n,1);break}}var m=d.call(this,p);if(m){m.remove()}if(this.tabBar){this.tabBar.removeTab(p,r)}h.call(this);if(o.visibleFlag){o.show()}return m}},clear:function(){while(this.getPageCount()>0){this.removeTab(this.getPageContentFromIndex(0))}},getIndexOf:function(p){var l=-1;var o=this.getPageCount();for(var m=0;m<o;m++){var n=this.getPageContentFromIndex(m);if(n===p){l=m;break}}return l},getIndexesFromValues:function(l){return this.tabBar._indexesFromValues(l)},redrawTabBar:function(){this.tabBar.redrawTabBar();if(this.tabPanelContainer){if(this.displayStyle.indexOf("vertical")!==-1){this.tabPanelContainer.setStyles({width:this.getContent().getDimensions().width-this.tabBar.getContent().getDimensions().width-4+"px"})}else{this.tabPanelContainer.setStyles({width:"auto"})}}},isPinned:function(l){if(this.tabBar.pinFlag){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.indexOf(l)!==-1){return true}}return false},_showContent:function(m){var l=this.getPageContentFromValue(m);if(l){l.show()}},_showPinnedContent:function(){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var l=this.getIndexesFromValues(this.tabBar.pinnedList);l=l.sort();for(var m=0;m<l.length;m++){var n=this.getPageContentFromIndex(l[m]);if(n){n.show()}}}},_hideContent:function(m){var l=this.getPageContentFromValue(m);if(l){l.hide()}},_setTabVisibility:function(n,l){var m=this.getPageContentFromValue(n);if(m){if(l&&this.value.indexOf(n)!==-1){m.show()}else{m.hide()}}this.tabBar._setTabVisibility(n,l);this.redrawTabBar()},_redrawBorder:function(){var n=this.getIndexesFromValues(this.value);var q;var m=n.sort();var r=m;if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var p=this.getIndexesFromValues(this.tabBar.pinnedList);for(var o=0;o<p.length;o++){if(r.indexOf(p[o])===-1){r.push(p[o])}}}else{r=m}i.sortNumberArray(r);for(var l=0;l<r.length;l++){if(r.length>1&&r[l]!==r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.addClassName("wux-controls-tab-borderSeparator")}}else{if(r.length>1&&r[l]===r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}else{if(r.length===1&&r[l]===r[0]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}}}if(r.length>1&&r[l]===r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}if(r.length>1&&r[l]===r[0]){q=this.getPageContentFromIndex(r[l]);if(q){q.addClassName("wux-controls-tab-borderSeparator")}}}},_handleEvents:function(){var l=this;this.tabBar.addEventListener("change",function(m){m.stopPropagation();l.value=l.tabBar.value;l._redrawBorder();l.fire("onSelectTab",m)});this.tabBar.onEndTabDrag(function(m){j.call(l,m.valueButtonDragged,m.valueButtonTarget);l._redrawBorder()});this.tabBar.onPinTab(function(){l._checkForMultiSelection();l._showPinnedContent();l._redrawBorder()});this.tabBar.unPinTab(function(o){var m=o.value;var n=l.getPageContentFromValue(m);if(n){n.setStyles({"background-color":""});if(n&&l.value.indexOf(m)===-1){n.hide()}l._redrawBorder();l._checkForMultiSelection()}});this.tabBar.onRemoveTabEvent(function(m){if(l.tabBar!==m.tabBar){return}if(l.autoCloseFlag){l.removeTabContent(m.value);l.value=l.tabBar.value;l._redrawBorder()}l.fire("close")});this.tabBar.onPreNewTab(function(m){k.call(l,new c.Element("div"),m.index,m.value)})}});return b;function j(o,m){var s=this.getPageIndexFromValue(o);var r=this.getPageIndexFromValue(m);if(s-r===1){this.tabPanelContainer.insertBefore(d.call(this,o),d.call(this,m))}else{if(r-s===1){this.tabPanelContainer.insertBefore(d.call(this,m),d.call(this,o))}else{var p=d.call(this,m);var q=d.call(this,o);var n,l;if(p){n=p.nextSibling}if(q){l=q.nextSibling}if(n){this.tabPanelContainer.insertBefore(q,n)}else{q.inject(this.tabPanelContainer)}if(l){this.tabPanelContainer.insertBefore(p,l)}else{p.inject(this.tabPanelContainer)}}}h.call(this)}function k(p,n,q){var r=this.tabPanelContainer.getChildren();if(p){if(c.is(p,"element")){p=new c.extendElement(p)}p.id=q;if(n===undefined||r.length===0){p.inject(this.tabPanelContainer)}else{var m=undefined;var l=0;for(var o=0;o<this._tabContent.length;o++){if(this._tabContent[o].index<n&&this._tabContent[o].index>=l){m=this._tabContent[o].content;l=this._tabContent[o].index}}if(m){p.inject(m,"after")}else{p.inject(this.tabPanelContainer.getChildren()[0],"before")}}}this._tabContent[this._tabContent.length]={content:p,value:q,index:n};h.call(this)}function h(){if(this._tabContent){for(var m=0;m<this._tabContent.length;m++){if(this._tabContent.hasOwnProperty(m)){var l=this.getIndexesFromValues([this._tabContent[m].value]);if(this._tabContent[m].value!==undefined&&l!==undefined){this._tabContent[m].index=l[0]}}}}}function d(m){var n=this.tabPanelContainer.childNodes;for(var l in n){if(parseInt(n[l].id)===m){return n[l]}}}});define("DS/Tree/TabMdlView",["DS/Controls/Abstract","DS/Controls/Tab","DS/TreeModel/TreeNodeModel",],function(h,f,g){function b(k){for(var j=0;j<this.length;j++){if(this[j].nodeModel===k){return{index:j,item:this[j]}}}}function e(k){for(var j=0;j<this.length;j++){if(this[j].value===k){return this[j]}}}function d(k){for(var j=0;j<this.length;j++){if(this[j].button===k){return this[j]}}}function a(j){var i=this._tab.addTab(j.options.label,new UWA.createElement("div"),undefined,true,undefined,(j.options.icons&&j.options.icons.length>0)?j.options.icons[0]:undefined);this._nodesModel.push({value:i.value,button:i.button,nodeModel:j})}var c=h.inherit({name:"TabMdlView",_tab:undefined,_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel"}},buildView:function(){this._parent();this._tab=new f({multiSelFlag:true,displayStyle:"panel",showComboBoxFlag:true});if(this._tab.tabBar){this._tab.tabBar.editableFlag=true}this._tab.inject(this.elements.container)},_applyModel:function(){var k=this;if(!k._tab){return}k._tab.clear();k._nodesModel=[];if(k.model){var i=k.model.getChildren();if(i&&i.length>0){i.forEach(function(l){a.call(k,l)})}var j=k.model?(k.model._treeDocument||k.model.getTreeDocument()):undefined;if(j){j.onNodeModelUpdate(function(l){if(!l||!l.target||!l.target.options||!l.target.options.grid){return}var n=b.call(k._nodesModel,l.target);if(n&&n.item&&n.item.button){var m=l.target.options;if(m.label!==n.item.button.label){n.item.button.label=m.label}if(m.icons&&m.icons[0]!==n.item.button.icon){n.item.button.icon=m.icons[0]}}});j._bindEventOnDocument("addChild",function(l){if(!l||!l.data||!l.data.nodeModel||l.data.nodeModel._nodeDepth!==k._modelDepth){return}a.call(k,l.data.nodeModel)});j._bindEventOnDocument("removeChild",function(l){if(!l||!l.data||!l.data.nodeModel||!l.parent||l.parent._nodeDepth!==k._modelDepth-1){return}var m=b.call(k._nodesModel,l.data.nodeModel);if(m&&m.item){k._tab.removeTabContent(m.item.value);k._nodesModel.splice(m.index,1)}})}}},_applyProperties:function(i){this._parent(i);if(this.isDirty("model")){this._applyModel()}},setContent:function(k,j){var i=b.call(this._nodesModel,k);if(i&&i.index!==undefined&&this._tab){this._tab.setPageContentFromIndex(i.index,j);i.item.content=j}},getNodeContent:function(j){var i=b.call(this._nodesModel,j);if(i&&i.index!==undefined&&this._tab){return this._tab.getPageContentFromIndex(i.index)}return null},handleEvents:function(){var j=this;j.elements.container.addEventListener("change",function(k){if(k&&k.target&&k.target.dsModel&&k.target.dsModel===j._tab&&!j._lockUpdate){var l=k.target.dsModel.value}});if(j._tab){var i=j._tab.tabBar;if(i){i.onEndEditTab(function(k){if(!k||!k.button){return}var l=d.call(j._nodesModel,k.button);if(l){l.nodeModel.updateOptions({label:k.button.label})}})}}}});return c});define("DS/Windows/WindowGroup",["UWA/Core","UWA/Array","DS/Windows/Window","DS/Controls/Tab","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Utilities/Utils"],function(e,b,j,h,f,a,g){Object.defineProperty(Array.prototype,"inter",{enumerable:false,writable:true,value:function(m){var k=[];var n=this.concat(m);for(var l=0;l<n.length;l++){var o=n[l];if(!(m.indexOf(o)!=-1&&this.indexOf(o)!=-1)){k.push(o)}}return k}});var c;c=j.inherit({publishedProperties:{groupType:{defaultValue:WUXWindowGroupTypeEnum.GroupAsTab,readOnly:true},currentWindows:{defaultValue:[]},width:{defaultValue:-1,type:"integer",category:"Appearance"},height:{defaultValue:-1,type:"integer",category:"Appearance"},},_computedIdentifier:"",buildView:function(){this._parent();this.elements.container.addClassName("wux-windows-windowgroup");this.elements._contentDiv.addClassName("wux-windows-windowgroup-content");this.elements._tabBarContainer=new e.Element("div",{"class":"wux-windows-windowgroup-tab-bar-container"});this.elements._tabBarContainer.inject(this.elements._titleDiv,"before");this.elements._titleDiv.hide();this.elements._draggableZoneDiv=new e.Element("div",{"class":"wux-windows-windowgroup-draggable-zone"});this.elements._draggableZoneDiv.inject(this.elements._titleP,"before");this._tab=new h({tabBarDOMContainer:this.elements._tabBarContainer,tabPanelContainer:this.elements._contentDiv,multiSelFlag:true,displayStyle:["panel","wide"],showComboBoxFlag:true,autoCloseFlag:false,reorderFlag:false});this._tab.tabBar.pinFlag=true;this._tab.tabBar.centeredFlag=false;this._tab.tabBar.closeButtonFlag=this.closeButtonFlag;this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},_applyTouchMode:function(){this._parent();this._postEditTouchMode()},_postEditTouchMode:function(){this._parent();var k=this._getCurrentTouchMode();if(this._tab){this._tab.touchMode=k}this._updateMaxTabbarWidth()},_applyCurrentWindows:function(k){var l=[];var u=[];var q=this._tab.tabBar.pinnedList;if(q){u=this._tab.getIndexesFromValues(q)}if(this.currentWindows!=undefined&&this.currentWindows.length!==0){if(this.currentWindows.length>=1){for(var o=0;o<this.currentWindows.length;o++){var r=this._getIndexFromWindow(this.currentWindows[o]);var t=this._tab.getPageValueFromIndex(r);if(u.length>0){var m=true;for(var p=0;p<u.length;p++){if(r==u[p]){m=false}}if(m||this._tab.tabBar.value.indexOf(t)!=-1){l.push(t)}}else{l.push(t)}}}if(!e.equals(this._tab.value,l)){this._tab.value=l}}this._updateResizableFlag();this._updateWidthAndHeight();this._updateMinWidth();this._updateMinHeight();this._updateMovableFlag();this._tab.tabBar._slideToValue();if(k){for(var p=0;p<k.length;p++){var s=k[p];if(s&&this.currentWindows.indexOf(s)==-1&&s.windowGroup===this){s.activeFlag=false}}}this._updateCurrentWindowsActiveFlag();if(this.currentDockArea!=WUXDockAreaEnum.NoneDockArea){var n=this.immersiveFrame.getDockingElement(this.currentDockArea);if(n){n._pointerEventsAllIfOverflow();n._updateDockingZoneSize()}}},_updateCurrentWindowsActiveFlag:function(){var m=this.getEmbeddedWindows();if(m){for(var l=0;l<m.length;l++){var k=m[l];if(k&&this.currentWindows&&this.currentWindows.indexOf(k)!=-1){k.activeFlag=this.activeFlag}else{if(k){k.activeFlag=false}}}}},_applyActiveFlag:function(){this._parent();this._updateCurrentWindowsActiveFlag()},_applyImmersiveFrame:function(l){this._parent(l);var o=this.immersiveFrame;var n=this.getEmbeddedWindows();for(var m=0;m<n.length;m++){var k=n[m];if(k){k.immersiveFrame=o}}},_applyCurrentDockArea:function(m){var p=this.currentDockArea;if((p===WUXDockAreaEnum.BottomDockArea)||(p===WUXDockAreaEnum.TopDockArea)){this._setTabMultiSelLayout("horizontal")}else{this._setTabMultiSelLayout("vertical")}this._parent(m);var k=this;var o=this.getEmbeddedWindows();for(var n=0;n<o.length;n++){var l=o[n];if(l){l.currentDockArea=p}}this._updateWidthAndHeight();this._updateMinWidth();this._tab.tabBar.redrawTabBar()},_applyRecId:function(k){this._parent(k);if(typeof this.recId!=="undefined"&&this.recId!==null){this._tab.recId=this.recId+"_Tab"}},_applyMinWidth:function(k){this._parent(k);var l=this.minWidth;if(l!==undefined){this.elements._mainContentDiv.setStyle("min-width",l+"px")}else{this.elements._mainContentDiv.setStyle("min-width","")}},_applyWidth:function(k){if(this.width!==null){this._updateMaxWidth();if(this.width===-1){this.getContent().setStyle("width","auto");this.elements._mainContentDiv.setStyle("width","auto");if(this.currentDockArea===WUXDockAreaEnum.NoneDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea||this.currentDockArea===WUXDockAreaEnum.BottomDockArea){if(this.elements._footerDiv){this.elements._footerDiv.setStyle("width","calc(100% - 10px)")}}else{if(this.elements._footerDiv){this.elements._footerDiv.setStyle("width","calc(100% - 10px)")}}}else{if(typeof this.minWidth!=="undefined"){if(this.width>=this.minWidth){d.call(this,this.width);this.elements._mainContentDiv.setStyle("width",this.width+"px")}else{if(this.minWidth){this.width=this.minWidth}}}}if(k&&(this.width!==k)){this._fireAndBroadcast("resize",{bubbles:false})}}this._tab.tabBar.redrawTabBar();this._updateTitleBarWidth()},_applyHeight:function(k){this._updateMaxHeight();if(this.height!==null){if(this.height===-1){this.elements._mainContentDiv.setStyle("height","");this._updateContentHeight()}else{if(this.height>=this.minHeight){i.call(this,this.height);this._updateContentHeight()}else{this.height=this.minHeight}if(k&&(this.height!==k)){this.fire("resize",{bubbles:false})}}}},_applyMaximizedFlag:function(){this._parent();this._updateTabCloseButtons()},_applyCloseButtonFlag:function(){this._parent();this._updateMaxTabbarWidth()},_applyMaximizeButtonFlag:function(){this._parent();this._updateMaxTabbarWidth()},_applyAllowMaximizeFlag:function(){this._parent();this._updateMaxTabbarWidth()},_updateWidthAndHeight:function(){if(this.currentWindows.length>0){this._updateResizableFlag();var s=this._getTabMultiSelLayout()!=="horizontal";if(s){var q=this.currentWindows[0].width;var m=this.currentWindows[0].height===-1;var r=m?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).height):this.currentWindows[0].height;for(var p=1;p<this.currentWindows.length;p++){var n=this.currentWindows[p];if(n.width!==-1){q=q>n.width?q:n.width}if(n.height===-1){r=r+parseInt(window.getComputedStyle(n.getContent()).height)+1}else{m=false;r=r+n.height+1}}if(this.width!==q){this.width=q}else{this._applyWidth()}if(m){this.height=-1}else{if(r&&this.height!==r){this.height=r}else{this._applyHeight()}}}else{var t=this.currentWindows[0].height;var l=this.currentWindows[0].width===-1;var o=l?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).width):this.currentWindows[0].width;for(var p=1;p<this.currentWindows.length;p++){var n=this.currentWindows[p];if(n.resizableFlag===false||n.resizableFlag==="horizontal"){t=t>n.height?t:this.currentWindows[p].height}if(n.width===-1){o=o+parseInt(window.getComputedStyle(n.getContent()).width)+1}else{l=false;o=o+n.width+1}}if(l){this.width=-1}else{if(o&&this.width!==o){this.width=o}else{this._applyWidth()}}if(t&&this.height!==t){this.height=t}else{this._applyHeight()}}}},_updateMaxTabbarWidth:function(){var m=0;if(this.closeButtonFlag){m++}if(this.maximizeButtonFlag&&this.allowMaximizeFlag){m++}var k=24;if(this.touchMode){k=36}if(this._tab.tabBar.centeredFlag){var l="100%";var n=this.immersiveFrame.getDockingElement(this.currentDockArea);if(n){l=n._getFixedAreaWidth()-k+"px"}this.elements._tabBarContainer.setStyle("max-width",l)}else{this.elements._tabBarContainer.setStyle("max-width","calc(100% - "+k*(m+1)+"px)")}},_applyProperties:function(k){this._parent(k);if(this.isDirty("currentWindows")){this._applyCurrentWindows(k.currentWindows)}this._postEditTouchMode()},_setTitleBarCenteredFlag:function(k){this._parent(k);if(this._tab&&this._tab.tabBar){this._tab.tabBar.centeredFlag=k}if(this.elements._draggableZoneDiv){if(k){this.elements._draggableZoneDiv.hide()}else{this.elements._draggableZoneDiv.show()}}},_computeDropInsertionData:function(o){var l=-1;var s="after";var m=-1;var t=this._tab.tabBar._getVisibleTabButtons();var u=this.elements._titleBarDiv.getBoundingClientRect().left;var q=u;if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){var r=this._tab.tabBar.tabComboBox.getContent().getBoundingClientRect().right;if(o.x>r){return{movedWindowNewIndex:l,targetWindow:this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:s,stopWindowGroupTabBarSliding:true}}}for(var n=0;n<t.length;n++){var p=this._tab.tabBar.getButtonFromValue(this._tab.getPageValueFromIndex(n));var k=p.getContent().getBoundingClientRect().left;var w=p.getContent().getBoundingClientRect().right;var v=0;if(w<=u){continue}else{if(k<=u){v=Math.abs(w-u)}else{v=this._tab.tabBar.getWidthOfButton(p)}}if(o.x<q+(v/2)){l=n;m=n;s="before";break}else{if(o.x<q+v){if(n+1<t.length){l=n+1}else{l=n}m=n;s="after";break}}q+=v}return{movedWindowNewIndex:l,targetWindow:(m!=-1)?this._getWindowFromIndex(m):this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:s}},getCollapsibleState:function(){for(var k=0;k<this.currentWindows.length;k++){if(!this.currentWindows[k].collapsibleFlag){return false}}return((this.groupType===WUXWindowGroupTypeEnum.GroupAsTab)&&(this.currentDockArea!==WUXDockAreaEnum.TopDockArea)&&(this.currentDockArea!==WUXDockAreaEnum.BottomDockArea))},getFloatableState:function(){var n=true;var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k){n=k.getFloatableState();if(!n){break}}}return n},getEmbeddedWindows:function(){var m=[];var n=this._tab.getPageCount();for(var l=0;l<n;l++){var k=this._getWindowFromIndex(l);m.push(k)}return m},getVisibleEmbeddedWindows:function(){var m=[];var n=this._tab.getPageCount();for(var l=0;l<n;l++){var k=this._getWindowFromIndex(l);if(k.visibleFlag){m.push(k)}}return m},containsWindow:function(k){var o=false;if(k){var n=this.getEmbeddedWindows();var m=n.length;while(m--){var l=n[m];if(l===k){o=true;break}}}return o},attachWindow:function(l,n,k){var m=-1;if(l){if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){m=this._stackWindowNextTo(l,n,k,undefined)}else{}}if(m>0){}return m},_stackWindowNextTo:function(y,t,r,u,C){var D=this;function m(H){y._onDragPointerDown(H);var G=H.dsModel;var F=D._getWindowFromIndex(D._tab.getPageIndexFromValue(G.value));y.addEventListener("stopWindowDrag",function(){if(G&&F&&!D.containsWindow(F)){G.destroy();var I=D.getEmbeddedWindows();if(I.length===0){D.destroy()}}})}var E=-1;if(y){if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){if(this.containsWindow(y)){return E}if(y&&y.isAWindowGroup()&&(y.groupType===WUXWindowGroupTypeEnum.GroupAsTab)){var n=y.getEmbeddedWindows();E=1;for(var v in n){var k=n[v];E=k._attachToWindow(t,r,u,C)===-1?-1:E}return E}if(y&&y._canBeSnapSource(t,r)&&(y!==t)&&(!t||((r===WUXSnapAreaEnum.InsideArea)&&t._canBeSnapTarget(y,r)))){var z=y.activeFlag;if(t){if(t===this){E=1}else{E=(this.containsWindow(t))?1:-1}}else{if(this.getEmbeddedWindows().length===0){E=1}}if(E<0){return E}var x=y.windowGroup;if(x){if(x===this&&this.containsWindow(y)){return 1}var o=false;var s=x.getAbsolutePosition();if(!t&&(x.groupType===WUXWindowGroupTypeEnum.GroupAsGrid)){E=x._attachToWindow(this,y,WUXSnapAreaEnum.BottomArea,u,C);if(E<0){return E}o=true}var p=x.detachWindow(y);if(o){x.setAbsolutePosition(s)}}if(t&&y.getDockedFlag()){y.currentDockArea=WUXDockAreaEnum.NoneDockArea}y.expandedFlag=true;if(y.resizableFlag===true||y.resizableFlag==="true"||y.resizableFlag==="vertical"||y.resizableFlag==="horizontal"){if(r===WUXSnapAreaEnum.InsideArea){if(y.resizableFlag===true||y.resizableFlag==="true"||y.resizableFlag==="horizontal"){y.width=this._getMonoSelectionWidth()}if(y.resizableFlag===true||y.resizableFlag==="true"||y.resizableFlag==="vertical"){if(t.height===-1){y.height=t.elements._mainContentDiv.clientHeight}else{y.height=t.height}}}}y.setPropertyFromUIInteraction("maximizedFlag",this.maximizedFlag);if(!t&&y.getDockedFlag()){this.setPropertyFromUIInteraction("currentDockArea",y.currentDockArea);this.inject(y.getContent(),"before")}var l=y.getAbsolutePosition();y.remove();var A;if(u){var w=this.getEmbeddedWindows();if(w.indexOf(t)!==-1){var q=w.indexOf(t);if(u==="before"){A=q}else{if(u==="after"){A=q+1}}}}this._tab.addTab(y.title,y.getContent(),A,true,undefined,y.icon,y.closeButtonFlag,y.showTitleFlag||!y.icon);y.windowGroup=this;this._updateRecId();var B=this._tab.tabBar.getButtonFromValue(this._tab.value[0]);if(B){a.addEventOnElement(this,B,f.POINTERDOWN,m)}if(this.getDockedFlag()){y.currentDockArea=this.currentDockArea}else{if(!t){if(y.getDockedFlag()){this.currentDockArea=y.currentDockArea}}}if(!t){this.setAbsolutePosition(l)}this._updateVisibleState();this._updateTitle();this._updateCloseButtonFlag();this._updateAllowedDockAreas();this._updateResizableFlag();this._updateMaximizedState();this._postEditTouchMode();this._updateTabCloseButtons();this._updateMaximizeButtonFlag();this._updateAllowMaximizeFlag();if(!y.visibleFlag){this._setWindowVisibility(y,y.visibleFlag)}if(this.activeFlag||z){this.activeFlag=true;this._updateCurrentWindows()}}}}this._updateComputedIdentifier();return E},detachWindow:function(k){return this._detachWindow(k,false)},_detachWindow:function(p,k){var n=-1;if(p){if(!this.containsWindow(p)){return n}if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){var s=this.currentWindows.length;var m=this.getAbsolutePosition();n=1;var o=this.activeFlag;this.activeFlag=false;p.getContent().hide();var l=this.getEmbeddedWindows().length===2?(this.getEmbeddedWindows()[0]===p?this.getEmbeddedWindows()[1]:this.getEmbeddedWindows()[0]):this;if(k&&this.getEmbeddedWindows().length!==1){this._tab.removeTab(p.getContent(),true)}else{this._tab.removeTab(p.getContent(),false)}if(p.windowGroup===this){p.windowGroup=null}if(k){p._saveWindowGroupInPreferences(l)}if(!p._isBeingClosed){if(this.immersiveFrame){if(p.getDockedFlag()){this.immersiveFrame.dockWindow(p,p.currentDockArea)}else{this.immersiveFrame.moveWindowToImmersiveFrame(p)}}if(p.visibleFlag){p.getContent().show()}p._updateFromEmbeddedState()}var q=this.getEmbeddedWindows();if(q.length===0){var m;var r=this.windowGroup;if(r&&!p._isBeingClosed){m=r.getAbsolutePosition();n=r.attachWindow(p,this,WUXSnapAreaEnum.BottomArea)}else{if(this.immersiveFrame){this.immersiveFrame.dockWindow(p,this.currentDockArea);p.inject(this.getContent(),"before")}}if(k){this.visibleFlag=false}else{this.destroy()}if(r){r.setAbsolutePosition(m);return n}}else{this._updateVisibleState();this._updateCloseButtonFlag();this._updateMaximizeButtonFlag();this._updateAllowMaximizeFlag();this._applyResizableFlag();if(q.length===1){var l=q[0];this._detachWindow(l,k);l.maximizedFlag=this.maximizedFlag}if(q.length>=1){p.maximizedFlag=false}}if(o){p.activeFlag=true}p.setAbsolutePosition(m);p._applyWidth();p._applyHeight();if(q.length>1){this._updateTitle();this._updateAllowedDockAreas();this._updateMovableFlag()}}}this._updateComputedIdentifier();this._updateRecId();return n},_createWindowGroup:function(k){return new c({groupType:k,immersiveFrame:this.immersiveFrame})},_canBeSnapSource:function(p,k){var o=true;var n=this.getEmbeddedWindows();for(var m=0;m<n.length;m++){var l=n[m];if(l){o=l._canBeSnapSource(p,k);if(!o){break}}}return o},_canBeSnapTarget:function(l,k){var p=true;var o=this.getEmbeddedWindows();for(var n=0;n<o.length;n++){var m=o[n];if(m){p=m._canBeSnapTarget(l,k);if(!p){break}}}return p},attachToWindow:function(q,k){var m=-1;if(q&&(k!==WUXSnapAreaEnum.NoneArea)&&(k!==WUXSnapAreaEnum.OutsideArea)&&this._canBeSnapSource(q,k)&&q._canBeSnapTarget(this,k)){if(this.groupType===WUXWindowGroupTypeEnum.GroupAsTab){m=1;if(k===WUXSnapAreaEnum.InsideArea){var p=this.currentWindows.slice();var o=this.getEmbeddedWindows();for(var n=0;n<o.length;n++){var l=o[n];if(l){var r=l.attachToWindow(q,k);if(r<0){m=r}}}if(q instanceof c){q.currentWindows=p}else{if(q.windowGroup){q.windowGroup.currentWindows=p}}}else{m=this._parent(q,k)}}else{}}return m},_pinOrUnpinWindow:function(k){if(k&&this.getEmbeddedWindows().indexOf(k)!==-1){var l=this._tab.getPageValueFromIndex(this._getIndexFromWindow(k));if(k.pinnedFlag){this._tab.tabBar.pinTab(l)}else{this._tab.tabBar.unPinTab(l)}}},_setTabMultiSelLayout:function(k){this._tab.multiSelLayout=k},_getTabMultiSelLayout:function(){return this._tab.multiSelLayout},_fireAndBroadcast:function(n,l){this._parent(n,l);var o=this.currentWindows;for(var m=0;m<o.length;m++){var k=o[m];if(k){k._fireAndBroadcast(n,l)}}},_updateTitle:function(){var o="";var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k){if(l===0){o="["}else{o+=", "}o+=k.title;if(l===m.length-1){o+="]"}else{if(l===5){o+=", ...]";break}}var n=this._tab.getPageValueFromIndex(this._getIndexFromWindow(k));if(this._tab.getOptionFromButton("label",n)!==k.title){this._tab.setOptionFromButton("label",k.title,n)}if(this._tab.getOptionFromButton("icon",n)!==k.icon){this._tab.setOptionFromButton("icon",k.icon,n)}}}this.title=o},_updateVisibleState:function(){var k=false;var n=this.getEmbeddedWindows();for(var m=0;m<n.length;m++){var l=n[m];if(l&&l.visibleFlag){k=true}}this.visibleFlag=k},_updateContentVisibleStateChange:function(){this._parent();var m=this.currentWindows;for(var k=0;k<m.length;k++){var l=m[k];l._updateContentVisibleStateChange()}},_updateCloseButtonFlag:function(){var n=false;var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k&&k.closeButtonFlag){n=true;break}}this.closeButtonFlag=n;if(this.maximizedFlag){this._updateTabCloseButtons()}},_updateTabCloseButtons:function(){var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k&&this.maximizedFlag){this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(k)),k.closeButtonFlag)}else{this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(k)),false)}}},_updateMaximizeButtonFlag:function(){var k=true;if(!this.allowMaximizeFlag){k=false}else{var n=this._getCurrentAndPinnedWindows();for(var m=0;m<n.length;m++){var l=n[m];if(l&&(!l.maximizeButtonFlag||!l.allowMaximizeFlag)){k=false;break}}}this.maximizeButtonFlag=k},_updateAllowMaximizeFlag:function(){var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k&&(!k.allowMaximizeFlag)){this.allowMaximizeFlag=false;return}}this.allowMaximizeFlag=true},_updateAllowedDockAreas:function(){var k=WUXDockAreaEnum.LeftDockArea+WUXDockAreaEnum.TopDockArea+WUXDockAreaEnum.RightDockArea+WUXDockAreaEnum.BottomDockArea;var o=this.getEmbeddedWindows();for(var n=0;n<o.length;n++){var m=o[n];if(m){for(var l in WUXDockAreaEnum){var p=WUXDockAreaEnum[l];if(!(m.allowedDockAreas&p)&&(k&p)){k=k-p;if(k===0){break}}}}}this.allowedDockAreas=k},_updateRecId:function(){var o="WindowGroup_";var k=o;var n=this.getEmbeddedWindows();for(var m=0;m<n.length;m++){var l=n[m];if(l&&l.recId){if(k!==o){k=k+";"}k=k+l.recId}}if(k!==o){this.recId=k}},_onCloseButtonClick:function(n){var l=this.getVisibleEmbeddedWindows();if(l){for(var k=l.length-1;k>=0;k--){var m=l[k];if(m&&m.closeButtonFlag){m.close()}}}},_updateComputedIdentifier:function(){var k="[";var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){if(l!==0){k=k+";"}k=k+m[l].identifier}k=k+"]";this._computedIdentifier=k},_updateMaximizedState:function(){var k=false;var n=this.getEmbeddedWindows();for(var m=0;m<n.length;m++){var l=n[m];if(l&&l.maximizedFlag){k=true;break}}this.maximizedFlag=k},_updateResizableFlag:function(){var m=false;var o=this.currentWindows;if(o.length!==1){var n=this._getTabMultiSelLayout()!=="horizontal";for(var l=0;l<o.length;l++){var k=o[l];if(k){if(n&&(k.resizableFlag===true||k.resizableFlag==="true"||k.resizableFlag==="horizontal")){m="horizontal";break}else{if(!n&&(k.resizableFlag===true||k.resizableFlag==="true"||k.resizableFlag==="horizontal")){m="vertical";break}}}}this.resizableFlag=m}else{this.resizableFlag=this.currentWindows[0].resizableFlag}},_updateMinWidth:function(){if(this.currentWindows&&this.currentWindows.length>0){var k;var n=0;if(this.currentDockArea===WUXDockAreaEnum.BottomDockArea||this.currentDockArea===WUXDockAreaEnum.TopDockArea){if(this._tab&&this._tab.tabBar){var q;if(!this._tab.tabBar.centeredFlag){q=this._tab.tabBar.getWidthOfAllVisibleButtons();this._tab.tabBar._applyInheritWidthToButtons();var o=parseInt(window.getComputedStyle(this.elements._titleBarDiv).width);var m=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width);if(!isNaN(o)&&!isNaN(m)){q=q+o-m}}else{q=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width)+2}n=q;if(this.immersiveFrame){var p=this.immersiveFrame.getDockingElement(this.currentDockArea)._getStretchSize();if(n>p){n=p-1}}}}for(var l=0;l<this.currentWindows.length;l++){k=this.currentWindows[l];if(k&&k.width!=-1){if(n<k.minWidth){n=k.minWidth}}}n=parseInt(n);this.minWidth=n}},_updateMinHeight:function(){if(this.currentWindows&&this.currentWindows.length>0){var k;var m=this.currentWindows[0].minHeight;for(var l=0;l<this.currentWindows.length;l++){k=this.currentWindows[l];if(k){if(m<k.minHeight){m=k.minHeight}}}this.minHeight=m}},_updateMovableFlag:function(){var n=true;var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){var k=m[l];if(k&&!k.movableFlag){n=false;break}}this.movableFlag=n},_getMonoSelectionWidth:function(){var m=this._getCurrentAndPinnedWindows();if(m.length===1){if(this.width===-1){return parseInt(window.getComputedStyle(m[0].getContent()).width)}else{return this.width}}else{if(m.length>1){for(var l=0;l<m.length;l++){var k=m[l];if(k.width!==-1){return k.width}}return parseInt(window.getComputedStyle(m[0].getContent()).width)}}},_getCurrentAndPinnedWindows:function(){var r=this._tab.value;var o=[];var n=this._tab.getIndexesFromValues(r);for(var l=0;l<n.length;l++){var p=n[l];if(p>=0){var k=this._getWindowFromIndex(p);if(k){o.push(k)}}}var q=this._tab.tabBar.pinnedList;if(q){var s=this._tab.getIndexesFromValues(q);for(var l=0;l<s.length;l++){var m=s[l];if(m>=0&&n.indexOf(m)==-1){var k=this._getWindowFromIndex(m);if(k){o.push(k)}}}}return o},_updateCurrentWindows:function(){var n=this._getCurrentAndPinnedWindows();this._updateHorizontallyStretchableFlag();this._updateVerticallyStretchableFlag();var k=this.currentWindows.inter(n);this.currentWindows=n;for(var l=0;l<k.length;l++){var m=k[l];m._updateContentVisibleStateChange()}this._applyPosition()},_updateHorizontallyStretchableFlag:function(){var m=this._getCurrentAndPinnedWindows();var k=false;for(var l=0;l<m.length;l++){if(m[l]&&m[l].horizontallyStretchableFlag===true){k=true;break}}this.horizontallyStretchableFlag=k},_updateVerticallyStretchableFlag:function(){var l=this._getCurrentAndPinnedWindows();var m=false;for(var k=0;k<l.length;k++){if(l[k]&&l[k].verticallyStretchableFlag===true){m=true;break}}this.verticallyStretchableFlag=m},_getWindowFromIndex:function(l){var m=this._tab.getPageContentFromIndex(l);var k=(m&&m.dsModel)?m.dsModel:m;return k},_getIndexFromWindow:function(k){return this._tab.getIndexOf(k.getContent())},_setWindowVisibility:function(l){var k=l.visibleFlag;this._tab._setTabVisibility(this._tab.getPageValueFromIndex(this._getIndexFromWindow(l)),k);if(!k){if(this.currentWindows.indexOf(l)!==-1){this.currentWindows.splice(this.currentWindows.indexOf(l),1)}if(this.currentWindows.length===0){var o=this.getEmbeddedWindows();for(var n=0;n<o.length;n++){var m=o[n];if(m.visibleFlag){this.currentWindows=[m];break}}}}else{if(k&&this.currentWindows.length===0){this.currentWindows=[l]}}this._updateVisibleState()},_manageReorder:function(o,p){var l=this._getIndexFromWindow(o);if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar.tabComboBox&&this._tab.tabBar.tabComboBox.visibleFlag){if(!g.isMouseOverElement(this._tab.tabBar.buttonGroup.getContent(),p)){this.immersiveFrame._stopWindowGroupTabBarSliding();return}var k=this.elements._titleBarDiv.getBoundingClientRect().left;var q=this._tab.tabBar.buttonGroup.getContent().getBoundingClientRect().right;var n=7;if(Math.abs(p.x-k)<=n){this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"left")}else{if(Math.abs(p.x-q)<=n){this.immersiveFrame._startWindowGroupTabBarSliding(this._tab.tabBar,"right")}else{this.immersiveFrame._stopWindowGroupTabBarSliding()}}}var m=this._computeDropInsertionData(p);if(m.stopWindowGroupTabBarSliding){this.immersiveFrame._stopWindowGroupTabBarSliding()}if(l!==m.movedWindowNewIndex){this._tab.tabBar._exchangeTabs(this._tab.getPageValueFromIndex(l),this._tab.getPageValueFromIndex(m.movedWindowNewIndex));this._tab.tabBar._slideToValue()}},close:function(){if(!this.autoCloseFlag){this.fire("close")}else{var k=this.activeFlag;var m=this.getEmbeddedWindows();if(m){for(var l=m.length-1;l>=0;l--){var n=m[l];if(n){n.close()}}}m=this.getEmbeddedWindows();if(m&&m.length>1&&k){this.activeFlag=true}}},_saveDockAreaInPreferences:function(){for(var l=0;l<this.getEmbeddedWindows().length;l++){var k=this.getEmbeddedWindows()[l];k._saveDockAreaInPreferences()}},_saveMaximizeInPreferences:function(){for(var l=0;l<this.getEmbeddedWindows().length;l++){var k=this.getEmbeddedWindows()[l];k._saveMaximizeInPreferences()}},_savePositionInPreferences:function(){for(var l=0;l<this.getEmbeddedWindows().length;l++){var k=this.getEmbeddedWindows()[l];k._savePositionInPreferences()}},_saveDimensionsInPreferences:function(){for(var l=0;l<this.getEmbeddedWindows().length;l++){var k=this.getEmbeddedWindows()[l];k._saveDimensionsInPreferences()}},handleEvents:function(){this._parent();var k=this;this._tab.tabBar.addEventListener("pinStateChange",function(m){var l=k._getWindowFromIndex(k._tab.getPageIndexFromValue(m.options.value));if(l&&m.options.pinnedFlag!==undefined){l._properties.pinnedFlag.value=m.options.pinnedFlag;if(typeof l.identifier!=="undefined"){l._savePinnedFlagInPreferences()}}else{console.log(m)}});this._tab.addEventListener("change",function(l){k._applyPosition();k._updateCurrentWindows()});this._tab.tabBar.onRemoveTabEvent(function(l){k._getWindowFromIndex(l.index).close()});this._tab.tabBar.onPinTab(function(l){k._updateCurrentWindows()});this._tab.tabBar.unPinTab(function(l){k._updateCurrentWindows()});this.elements._contentDiv.addEventListener("placeChange",function(l){});this.addEventListener("move",function(l){k._tab.tabBar.tabComboBox._hidePopup()})}});var d=function(m){if((this.resizableFlag===true||this.resizableFlag==="true"||this.resizableFlag==="horizontal")&&m>=this.minWidth){var l=this.getEmbeddedWindows();for(var k=0;k<l.length;k++){if(l[k].resizableFlag===true||l[k].resizableFlag==="true"||l[k].resizableFlag==="horizontal"){l[k].width=m}}}};var i=function(k){if((this.resizableFlag===true||this.resizableFlag==="true"||this.resizableFlag==="vertical")&&k>=this.minHeight){var m=this.getEmbeddedWindows();for(var l=0;l<m.length;l++){if(m[l].resizableFlag===true||m[l].resizableFlag==="true"||m[l].resizableFlag==="vertical"){m[l].height=k}}}};return c});define("DS/Windows/Panel",["UWA/Core","DS/Windows/Window","DS/Windows/WindowGroup","DS/Utilities/Utils","DS/Controls/Button","DS/Controls/Expander","DS/Controls/ButtonGroup","DS/Core/PointerEvents"],function(b,i,d,e,g,h,a,c){var f=i.inherit({name:"panel",publishedProperties:{collapsibleFlag:{defaultValue:true,type:"boolean",category:"Behavior"},snappableFlag:{defaultValue:true,type:"boolean",category:"Behavior"},floatableFlag:{defaultValue:true,type:"boolean",category:"Behavior"},headerPopupContent:{defaultValue:undefined,type:Object,category:"Behavior"},pinnedFlag:{defaultValue:false,type:"boolean",category:"Behavior"},showTitleFlag:{defaultValue:true,type:"boolean",category:"Behavior"}},buildView:function(){this._parent();this.elements.container.addClassName("wux-windows-panel");this.elements._titleBarDiv.addClassName("wux-windows-panel");this.elements._buttonsDiv=new b.Element("div",{"class":"wux-windows-panel-buttons"});this.elements._buttonsDiv.inject(this.elements._mainContentDiv,"top");this.elements._buttonsDiv.hide();this.allowedDockAreas=WUXDockAreaEnum.TopDockArea|WUXDockAreaEnum.BottomDockArea|WUXDockAreaEnum.LeftDockArea|WUXDockAreaEnum.RightDockArea},_applyHeaderPopupContent:function(m){function j(p){if(n.elements._headerPopup&&p.target.parentNode!==n.elements._headerPopup.elements.header&&p.target.parentNode!==n.elements._headerPopup.elements.headerContainer&&p.target.parentNode!==n.elements._headerPopup.elements.expanderContainer){var o=Object.keys(n.buttons).length;if(n.buttons!==undefined&&o>0&&p.target.parentNode!==n.buttons.Ok.getContent()&&p.target!==n.buttons.Ok.getContent()&&p.target.parentNode!==n.buttons.Cancel.getContent()&&p.target!==n.buttons.Cancel.getContent()){n.elements._headerPopup.close()}else{if(o===0){n.elements._headerPopup.close()}}}}function l(p){if(n.elements._headerPopup&&p.target.parentNode!==n.elements._headerPopup.elements.header&&p.target.parentNode!==n.elements._headerPopup.elements.headerContainer&&p.target.parentNode!==n.elements._headerPopup.elements.expanderContainer&&n.headerPopupContent.content.tagName!=="DIV"&&!n.headerPopupContent.content.getContent().contains(p.target.parentNode)){var o=Object.keys(n.buttons).length;if(n.buttons!==undefined&&o>0&&p.target.parentNode!==n.buttons.Ok.getContent()&&p.target!==n.buttons.Ok.getContent()&&p.target.parentNode!==n.buttons.Cancel.getContent()&&p.target!==n.buttons.Cancel.getContent()){n.elements._headerPopup.close();if(p.target!==n.elements._titleBarDiv){p.stopPropagation()}}else{if(o===0){n.elements._headerPopup.close();p.stopPropagation()}}}}function k(o){n.elements._headerPopup.close()}if(this.elements._headerPopup){if(this.headerPopupContent.title){this.elements._headerPopup.header=this.headerPopupContent.title;this.headerPopupContent.content=this.elements._headerPopup.body}}else{if(!this.elements._headerPopup){if(this.headerPopupContent.content){this.elements._headerPopup=new h({header:this.headerPopupContent.title,body:this.headerPopupContent.content,style:"mode-selector"});this.elements._buttonsDiv.removeClassName("wux-windows-panel-buttons");this.elements._buttonsDiv.addClassName("wux-windows-panel-expander");this.elements._mainContentDiv.style.background="";this.elements._contentDiv.style.animation="wux-unblur 0.3s forwards";this.elements._mainContentDiv.style.pointerEvents="all";document.removeEventListener(c.POINTERUP,j);document.removeEventListener(c.POINTERDOWN,l,true);if(m&&m.content){m.content.removeEventListener("buttonclick",k)}this.elements._buttonsDiv.show();var n=this;this.headerPopupContent.content.addEventListener("buttonclick",k);this.elements._headerPopup.addEventListener("transitionend",function(o){if(o.target===n.elements._headerPopup){o.stopPropagation()}});this.elements._headerPopup.addEventListener("expand",function(o){n.elements._mainContentDiv.style.background="rgba(255, 255, 255, 0.76)";n.elements._contentDiv.style.animation="wux-blur 0.3s forwards";n.elements._mainContentDiv.style.pointerEvents="none";document.addEventListener(c.POINTERUP,j);document.addEventListener(c.POINTERDOWN,l,true)});this.elements._headerPopup.addEventListener("collapse",function(o){n.elements._mainContentDiv.style.background="";n.elements._contentDiv.style.animation="wux-unblur 0.3s forwards";n.elements._mainContentDiv.style.pointerEvents="all";document.removeEventListener(c.POINTERUP,j);document.removeEventListener(c.POINTERDOWN,l,true)});this.elements._titleBarDiv.addEventListener(c.POINTERDOWN,function(o){n.elements._headerPopup.close()})}else{this.elements._headerPopup=new b.Element("div",{"class":"wux-windows-panel-simplesuperfeature",text:this.headerPopupContent.title});this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons");this.elements._buttonsDiv.removeClassName("wux-windows-panel-expander")}this.elements._headerPopup.inject(this.elements._buttonsDiv);this._applyButtons()}}},_applyTouchMode:function(){this._parent();this._postEditTouchMode()},_postEditTouchMode:function(){this._parent()},_superFeatureCallback:function(j,m,l,k){if(l){this.headerPopupContent={title:j.label,content:k}}j.checkFlag=true;if(m){m()}return j.label},buildSuperFeature:function(n){var m=this;var l=!n.title;var o=undefined;if(this.elements._buttonsDiv.hasChildNodes()&&this.elements._headerPopup){for(var k=0;k<this.elements._buttonsDiv.childNodes.length;k++){var p=this.elements._buttonsDiv.childNodes[k];if((p.dsModel&&p.dsModel instanceof h)||p.hasClassName("wux-windows-panel-simplesuperfeature")){p.remove();this.elements._headerPopup=undefined}}}if(n.content){o=new b.Element("div",{"class":"wux-windows-panel-superfeature"});o.setStyles({display:"flex","justify-content":"space-around"});for(var k=0;k<n.content.length;k++){var j=new g({type:"radio",label:n.content[k].label,icon:n.content[k].icon,value:k,displayStyle:"lite-borders",clickMode:1,onClick:function(q){m._superFeatureCallback(q.dsModel,n.content[q.dsModel.value].onSelect,l,o)}});j.inject(o);j.getContent().setStyle("flex-grow","1");if(k===0){this._superFeatureCallback(j,n.content[0].onSelect,l,o)}}}if(!n.content&&!l){this.headerPopupContent={title:n.title}}else{this.headerPopupContent={title:n.title,content:o}}return this.headerPopupContent},buildStandardButtons:function(){var j=new g({icon:{iconName:"check",fontIconFamily:WUXManagedFontIcons.Font3DS},emphasize:"secondary"});j.elements.container.addClassName("wux-windows-panel-apply");var k=new g({icon:{iconName:"wrong",fontIconFamily:WUXManagedFontIcons.Font3DS}});k.elements.container.addClassName("wux-windows-panel-cancel");this.buttons={Ok:j,Cancel:k};j.addEventListener(c.POINTERUP,function(l){l.stopPropagation()});k.addEventListener(c.POINTERUP,function(l){l.stopPropagation()})},getCollapsibleState:function(){return(this.collapsibleFlag&&(this.currentDockArea!==WUXDockAreaEnum.TopDockArea)&&(this.currentDockArea!==WUXDockAreaEnum.BottomDockArea)&&!this.maximizedFlag&&!((this.currentDockArea===WUXDockAreaEnum.LeftDockArea)&&(this.verticallyStretchableFlag))&&!((this.currentDockArea===WUXDockAreaEnum.RightDockArea)&&(this.verticallyStretchableFlag)))},getFloatableState:function(){return this.floatableFlag},supportsGroupType:function(j){return(j===WUXWindowGroupTypeEnum.GroupAsTab)},_canBeSnapSource:function(l,j){var k=((l&&this.snappableFlag&&(l!==this))||(j===WUXSnapAreaEnum.OutsideArea)||(j===WUXSnapAreaEnum.NoneArea));if(k&&l){k=(l.immersiveFrame===this.immersiveFrame)}if(k&&(j!==WUXSnapAreaEnum.OutsideArea)&&(j!==WUXSnapAreaEnum.NoneArea)){var m=(j===WUXSnapAreaEnum.InsideArea)?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;k=this.supportsGroupType(m)}if(k&&l&&(j!==WUXSnapAreaEnum.OutsideArea)){if(l.getDockedFlag()){k=(this.allowedDockAreas&l.currentDockArea)}}if(k&&l&&l.maximizedFlag&&!this.allowMaximizeFlag){k=false}return k},_canBeSnapTarget:function(k,j){var l=(k&&(k!==this)&&((j===WUXSnapAreaEnum.OutsideArea)||(this.snappableFlag)));if(l&&(j!==WUXSnapAreaEnum.OutsideArea)&&(j!==WUXSnapAreaEnum.NoneArea)){var m=(j===WUXSnapAreaEnum.InsideArea)?WUXWindowGroupTypeEnum.GroupAsTab:WUXWindowGroupTypeEnum.GroupAsGrid;l=this.supportsGroupType(m)}if(l&&k){l=(k.immersiveFrame===this.immersiveFrame)}if(l&&this.getDockedFlag()){switch(this.currentDockArea){case WUXDockAreaEnum.LeftDockArea:case WUXDockAreaEnum.RightDockArea:l=((j===WUXSnapAreaEnum.OutsideArea)||(j===WUXSnapAreaEnum.TopArea)||(j===WUXSnapAreaEnum.BottomArea)||(j===WUXSnapAreaEnum.InsideArea));break;case WUXDockAreaEnum.TopDockArea:case WUXDockAreaEnum.BottomDockArea:l=((j===WUXSnapAreaEnum.OutsideArea)||(j===WUXSnapAreaEnum.LeftArea)||(j===WUXSnapAreaEnum.RightArea)||(j===WUXSnapAreaEnum.InsideArea));break}}return l},_createWindowGroup:function(k){var n=this.width;var m=this.height;var l={my:"top left",at:"top left",of:this.position.of,collision:this.position.collision};var j=e.getPositionRelativeToOffsetParent(this,l);return new d({groupType:k,immersiveFrame:this.immersiveFrame,activeFlag:false,width:n,height:m,position:j,maximizedFlag:this.maximizedFlag})},_updateFromCollapsibleState:function(){this._parent()},_applyButtons:function(j){this._parent(j);if(this.elements._buttonsDiv.childNodes.length==0){this.elements._buttonsDiv.hide()}else{if(!this.elements._headerPopup){this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons")}this.elements._buttonsDiv.show()}},_applyCollapsibleFlag:function(){this._updateFromCollapsibleState()},_applyFloatableFlag:function(){if(!this.floatableFlag){if(!this.currentDockArea){var k=WUXDockAreaEnum.LeftDockArea;if(!(k&this.allowedDockAreas)){for(var j in WUXDockAreaEnum){if(WUXDockAreaEnum[j]!=WUXDockAreaEnum.NoneDockArea&&(WUXDockAreaEnum[j]&this.allowedDockAreas)){k=WUXDockAreaEnum[j]}}}if(this.windowGroup){this.windowGroup.currentDockArea=k}else{this.currentDockArea=k}}}},_applyWindowGroup:function(j){this._parent(j);if(this.pinnedFlag){this._applyPinnedFlag()}},_applyPinnedFlag:function(){if(this.windowGroup){this.windowGroup._pinOrUnpinWindow(this)}},_applyShowTitleFlag:function(){if(this.showTitleFlag||!this.icon||this.icon.iconName===""){this.elements._titleP.setStyle("display","")}else{this.elements._titleP.setStyle("display","none")}this._updateTitleStyle()},_applyIcon:function(j){this._parent(j);this._applyShowTitleFlag();this._updateTitleStyle()},_applyTitle:function(j){this._parent(j);this._applyShowTitleFlag();this._updateTitleStyle()},_applyProperties:function(j){this._parent(j);if(this.isDirty("collapsibleFlag")){this._applyCollapsibleFlag()}if(this.isDirty("floatableFlag")){this._applyFloatableFlag()}this._applyShowTitleFlag()},_applyVerticallyStretchableFlag:function(j){this._parent(j);this._applyCollapsibleFlag()},handleEvents:function(){this._parent();var j=this},_updateTitleStyle:function(){if(this.elements._titleP.getStyle("display")==="none"||this.title===""){this.elements.iconPlaceholder.addClassName("wux-windows-icon-no-title")}else{this.elements.iconPlaceholder.removeClassName("wux-windows-icon-no-title")}},_savePinnedFlagInPreferences:function(){var k={pinnedFlag:this.pinnedFlag};var j="pinnedFlag";this._saveDataInPreferences(j,k);if(this._savedPreferencesKeys.indexOf(j)===-1){this._savedPreferencesKeys.push(j)}},_getPinnedFlagFromPreferences:function(){return this._getDataFromPreferences("pinnedFlag")},_readWindowPreferences:function(){this._parent();var j=this._getPinnedFlagFromPreferences();if(j){this.pinnedFlag=j.pinnedFlag}}});return f});define("DS/Windows/ImmersiveFrame",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Windows/DockingElement","DS/Windows/DockingElementForImmersiveFrame","DS/Windows/Window","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/WebRecordBase/Utils","DS/Windows/Panel","i18n!DS/Windows/assets/nls/translation"],function(e,p,g,d,q,i,a,s,r,t,h,j,o){function f(G,D){var F=null;var E=WUXSnapAreaEnum.NoneArea;if(G){for(var w in this.windows){var A=this.windows[w];if(A){if(A.windowGroup&&(A.windowGroup.groupType===WUXWindowGroupTypeEnum.GroupAsTab)){A=A.windowGroup}if(A!==G){var z=A.getBoundingClientRect();if(d.rectContains(z,D)){if(G._canBeSnapSource(A,WUXSnapAreaEnum.LeftArea)&&A._canBeSnapTarget(G,WUXSnapAreaEnum.LeftArea)){var B=A._getSnapAreaRect(WUXSnapAreaEnum.LeftArea);if(d.rectContains(B,D)){F=A;E=WUXSnapAreaEnum.LeftArea}}if(!F&&G._canBeSnapSource(A,WUXSnapAreaEnum.RightArea)&&A._canBeSnapTarget(G,WUXSnapAreaEnum.RightArea)){var x=A._getSnapAreaRect(WUXSnapAreaEnum.RightArea);if(d.rectContains(x,D)){F=A;E=WUXSnapAreaEnum.RightArea}}if(!F&&G._canBeSnapSource(A,WUXSnapAreaEnum.TopArea)&&A._canBeSnapTarget(G,WUXSnapAreaEnum.TopArea)){var v=A._getSnapAreaRect(WUXSnapAreaEnum.TopArea);if(d.rectContains(v,D)){F=A;E=WUXSnapAreaEnum.TopArea}}if(!F&&G._canBeSnapSource(A,WUXSnapAreaEnum.BottomArea)&&A._canBeSnapTarget(G,WUXSnapAreaEnum.BottomArea)){var C=A._getSnapAreaRect(WUXSnapAreaEnum.BottomArea);if(d.rectContains(C,D)){F=A;E=WUXSnapAreaEnum.BottomArea}}if(!F&&G._canBeSnapSource(A,WUXSnapAreaEnum.InsideArea)&&A._canBeSnapTarget(G,WUXSnapAreaEnum.InsideArea)){var y=A._getSnapAreaRect(WUXSnapAreaEnum.InsideArea);if(d.rectContains(y,D)){F=A;E=WUXSnapAreaEnum.InsideArea}}if(F){break}}}}}}if(this._snapTargetWindow!==F){if(this._snapTargetWindow){this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea}this._snapTargetWindow=F;if(this._snapTargetWindow){this._snapPointer=D;this._snapTargetWindow.activeSnapArea=E;if(G){this._initStackingWindowsTimer(this._snapTargetWindow,G)}}}}function m(z,A){var w=null;if(z.immersiveFrame===this&&z.allowedDockAreas){for(var x=0;x<this.dockingElements.length;x++){var B=this.dockingElements[x];if(!(z.allowedDockAreas&B.side)||this._snapTargetWindow||w){B.interactiveDockAreaVisibleFlag=false;continue}var v=u.call(this,B.side);if((A.x<v.x||A.x>=v.x+v.width)||(A.y<v.y||A.y>=v.y+v.height)){n(B);continue}if(B.collapseDockingZoneFlag){B.collapseMemory=true;B.collapseDockingZoneFlag=false}if(!B.visibleDockingZoneFlag){if(B.getContainedVisibleWindows().length===0){var C=B.dockingZoneSize;var y=window.getComputedStyle(z.getContent());if((B.side===WUXDockAreaEnum.TopDockArea)||(B.side==WUXDockAreaEnum.BottomDockArea)){C=parseInt(y.height)}else{C=parseInt(y.width)}if(!isNaN(C)){B.dockingZoneSize=C}}B.visibleDockingZoneFlag=true}B.interactiveDockAreaVisibleFlag=true;w=B}}if(this._activeDockingElement!==w){if(this._activeDockingElement){n(this._activeDockingElement)}this._activeDockingElement=w}}function k(z,B,y){if(this._snapTargetWindow){if(!h.isReplaying()){var A=y?y:this._snapTargetWindow;var x=this._snapTargetWindow.activeSnapArea;var w=A.isAWindowGroup()?A._computedIdentifier:A.identifier;if(w){z.callMethodFromUIInteraction("_locateAndAttachToWindow",w,x,B)}z._attachToWindow(A,x,B,true)}var v=z.elements.container?z:A;v._saveWindowGroupInPreferences();v._saveDockAreaInPreferences();this._snapTargetWindow.activeSnapArea=WUXSnapAreaEnum.NoneArea;this._snapTargetWindow=null}else{if(this._activeDockingElement){if(!h.isReplaying()){z.setPropertyFromUIInteraction("currentDockArea",this._activeDockingElement.side)}if(z.currentDockArea===this._activeDockingElement.side){z._saveDockAreaInPreferences();if(this._activeDockingElement.getContainedVisibleWindows().length===1){this._activeDockingElement._saveDockingZoneSizeInPreferences()}}}}if(this._activeDockingElement){this._activeDockingElement.interactiveDockAreaVisibleFlag=false;this._activeDockingElement=null}if(z.elements.container){z.elements.container.removeClassName("wux-windows-window-furtive")}}function n(v){if(v){v.interactiveDockAreaVisibleFlag=false;if(v.collapseMemory){v.collapseDockingZoneFlag=true;v.collapseMemory=false}if(v.getContainedVisibleWindows().length===0){v.visibleDockingZoneFlag=false}}}function u(v){var x=this.getContent().getBoundingClientRect();var w=this.getDockingElement(v).getContent().getBoundingClientRect();switch(v){case WUXDockAreaEnum.TopDockArea:return{x:x.left,y:w.top-this._dockingSensibilityZoneSize,width:x.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.BottomDockArea:return{x:x.left,y:w.bottom-this._dockingSensibilityZoneSize,width:x.width,height:2*this._dockingSensibilityZoneSize};case WUXDockAreaEnum.LeftDockArea:return{x:w.left-this._dockingSensibilityZoneSize,y:x.top,width:2*this._dockingSensibilityZoneSize,height:x.height};case WUXDockAreaEnum.RightDockArea:return{x:w.right-this._dockingSensibilityZoneSize,y:x.top,width:2*this._dockingSensibilityZoneSize,height:x.height}}}var c=400;var b=900;var l=p.inherit({markForRecordFlag:true,publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:true,category:"Behavior"},_ActionBar_V3:{defaultValue:false,type:"boolean",category:"Appearance",noNeedToApplyFlag:true},dockingElementsPriority:{defaultValue:[WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea,WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea],type:"Array",readOnly:true,category:"Behavior"}},windows:undefined,dockingElements:undefined,resizerSize:10,_postBuildView:function(){this.elements.container.addClassName("wux-windows-immersive-frame");r.setElementRecordMode(this.elements.container,t.RecordModes.DEFAULT_AND_CHILD);if(this._ActionBar_V3){this._properties.dockingElementsPriority.value=[WUXDockAreaEnum.TopDockArea,WUXDockAreaEnum.BottomDockArea,WUXDockAreaEnum.LeftDockArea,WUXDockAreaEnum.RightDockArea]}for(var v=0;v<this.dockingElementsPriority.length;v++){this._addDockingZone(this.dockingElementsPriority[v],200)}this._snapTargetWindow=null;this._activeDockingElement=null;this._dockingSensibilityZoneSize=22;this.elements.pointerEventsDiv=new e.Element("div",{"class":"wux-windows-immersive-frame-pointer-events"}).inject(this.elements.container);this.elements.pointerEventsDiv.hide();var w=this;q.onNodeRendered(this.getContent(),function(){if(w._onResizeFun){w._onResizeFun()}})},init:function(v){this.windows={};this.dockingElements=[];this._parent(v)},dockWindow:function(v,z){if(v&&v.allowedDockAreas&&v.allowedDockAreas&z){var x=this.getDockingElement(z);if(x){if(!v.windowGroup||(v.currentDockArea!=z)){x.interactiveDockAreaVisibleFlag=false;x.visibleDockingZoneFlag=true;x.onTransitionEnd();if((x.getContainedVisibleWindows().length===0)&&x._isCurrentlyCalledFromUIInteraction()){var y=x.dockingZoneSize;var w=window.getComputedStyle(v.getContent());if((x.side===WUXDockAreaEnum.TopDockArea)||(x.side==WUXDockAreaEnum.BottomDockArea)){y=parseInt(w.height)}else{y=parseInt(w.width)}if(!isNaN(y)){x.dockingZoneSize=y}}if(!v.getContent().isInjected(x.elements.dockingZone)){v.inject(x.elements.dockingZone)}v.getContent().setStyle("z-index",100)}v.immersiveFrame=this;v.currentDockArea=z;x._updateFromContainedWindows();x._updateContainedWindows()}}return(v.currentDockArea===z)?1:-1},undockWindow:function(v){if(v){var y=v.currentDockArea;var z=this.getDockingElement(y);if(!v._isBeingClosed){if(!v.windowGroup||(y!==WUXDockAreaEnum.NoneDockArea)){var x=v.getAbsolutePosition();this.moveWindowToImmersiveFrame(v);v.getContent().setStyle("z-index",1000);v.setAbsolutePosition(x)}v.currentDockArea=WUXDockAreaEnum.NoneDockArea}else{var w=v.getContent().getParent();if(w){w.removeChild(v.getContent())}}if(z){z._updateFromContainedWindows();z._updateContainedWindows();z._pointerEventsAllIfOverflow();z._resetInteractiveDockArea()}}},getFreeZone:function(){return this.dockingElements[this.dockingElements.length-1].elements.freeZone},setContentInBackgroundLayer:function(v){if(!v){if(this._backgroundLayerDiv){this._backgroundLayerDiv.empty();this._backgroundLayerDiv.remove();delete this._backgroundLayerDiv}return}if(!this._backgroundLayerDiv){this._backgroundLayerDiv=new e.Element("div",{styles:{top:0,bottom:0,right:0,left:0,position:"absolute",width:"100%",height:"100%",pointerEvents:"all"}});this._backgroundLayerDiv.inject(this.getContent(),"top")}if(v.inject){v.inject(this._backgroundLayerDiv)}else{this._backgroundLayerDiv.appendChild(v)}},moveWindowToMaximizeZone:function(v){if(v){v.inject(this.getFreeZone());if(this._ActionBar_V3&&(v.currentDockArea===WUXDockAreaEnum.TopDockArea||v.currentDockArea===WUXDockAreaEnum.BottomDockArea)){v._moveTitleBar(false,this.getDockingElement(v.currentDockArea))}}},moveWindowToImmersiveFrame:function(v){if(v){v.inject(this.elements.container);if(this._ActionBar_V3){if(v.currentDockArea===WUXDockAreaEnum.TopDockArea||v.currentDockArea===WUXDockAreaEnum.BottomDockArea){v._moveTitleBar(true,this.getDockingElement(v.currentDockArea))}else{v._moveTitleBar(false,this.getDockingElement(v.currentDockArea))}}}},_addDockingZone:function(w,v){var x=this;var A=this._ActionBar_V3?a:i;var z="";if(this.recId){switch(w){case WUXDockAreaEnum.LeftDockArea:z="LeftDockArea";break;case WUXDockAreaEnum.RightDockArea:z="RightDockArea";break;case WUXDockAreaEnum.TopDockArea:z="TopDockArea";break;case WUXDockAreaEnum.BottomDockArea:z="BottomDockArea";break}}var y=new A({identifier:this.identifier,side:w,dockingZoneSize:v,visibleDockingZoneFlag:false,collapseDockingZoneFlag:false,recId:z});y.elements.container.addClassName("wux-immersive-frame-component");if(!this._ActionBar_V3){y.useBackgroundFlag=true}if(this.dockingElements.length===0){y.inject(this.elements.container)}else{y.inject(this.dockingElements[this.dockingElements.length-1].elements.freeZone)}this.dockingElements.push(y)},_removeDockingZone:function(v){var w=this;if((this.dockingElements.length<=v)||(v<0)){return}if(v!==this.dockingElements.length-1){if(v===0){this.dockingElements[v+1].inject(this.elements.container)}else{this.dockingElements[v+1].inject(this.dockingElements[v-1].elements.freeZone)}}this.dockingElements[v].hide();this.dockingElements.splice(v,1)},_updateAllDockingZoneSize:function(){for(var v=0;v<this.dockingElements.length;v++){var w=this.dockingElements[v];if(w){w._updateDockingZoneSize()}}},_applyProperties:function(v){this._parent(v)},addWindow:function(v){var w=this;if(!this.containsWindow(v)){this.windows[w._computeUniqueIdentifier(v)]=v;v.getContent().setStyle("z-index",1000);if(v.currentDockArea===WUXDockAreaEnum.NoneDockArea&&!v.maximizedFlag){this.moveWindowToImmersiveFrame(v)}v.immersiveFrame=this;v.position.of=this.getContent();v.position.constraint=this.getContent();v._applyPosition();v.addEventListener("windowDrag",function(D){w.elements.pointerEventsDiv.show();var A=D.dsModel;if(A){if(A.visibleFlag===false){return}if(Math.abs(D.options.deltaX)>15||Math.abs(D.options.deltaY)>15){if(A.getDockedFlag()||A.windowGroup){var B=A.getContent().getSize();if(A.windowGroup){if(d.isMouseOverElement(A.windowGroup.elements._titleBarDiv,D.options)){A.windowGroup._manageReorder(A,D.options);return}var C=A.windowGroup;if(C.getEmbeddedWindows().length===2){for(var z=0;z<2;z++){var x=C.getEmbeddedWindows()[z];if(x!==A){C=x;break}}}A.windowGroup.activeSnapArea=WUXSnapAreaEnum.NoneArea;A.windowGroup._detachWindow(A,v._isCurrentlyCalledFromUIInteraction());w._clearStackingWindowsTimer();w._stopWindowGroupTabBarSliding();A=w._replaceFakedWindowByReallyMovedWindow(A);A._saveWindowGroupInPreferences(C)}if(A.getFloatableState()){A.currentDockArea=WUXDockAreaEnum.NoneDockArea;A._saveDockAreaInPreferences()}A.activeFlag=true;A.bringToFront();var y=A.getContent().getSize();if((y.width!==B.width)||(y.height!==B.height)){A._ensureTitleBarUnderPointer(D.options)}}}if(!A.windowGroup){f.call(w,A,D.options);m.call(w,A,D.options);if(w._snapTargetWindow||w._activeDockingElement){A.elements.container.addClassName("wux-windows-window-furtive")}else{A.elements.container.removeClassName("wux-windows-window-furtive")}}}});v.addEventListener("stopWindowDrag",function(y){w._stopWindowGroupTabBarSliding();var z,x;if(w._fakeStackedWindow){z="before";x=w._fakeStackedWindow;f.call(w,y.dsModel,y.options);w._snapSourceWindow.show()}k.call(w,y.dsModel,z,x);if(w._fakeStackedWindow&&w._fakeStackedWindow.windowGroup){w._fakeStackedWindow.windowGroup._detachWindow(w._fakeStackedWindow,true);w._fakeStackedWindow.hide()}w._resetStackedWindowData();w.elements.pointerEventsDiv.hide()});v.addEventListener("startResize",function(x){w.elements.pointerEventsDiv.show();w.elements.pointerEventsDiv.setStyle("cursor",x.options.cursor)});v.addEventListener("stopResize",function(x){w.elements.pointerEventsDiv.hide();w.elements.pointerEventsDiv.setStyle("cursor","default")});v.addEventListener("visibleStateChange",function(A){if(v.currentDockArea!==WUXDockAreaEnum.NoneDockArea){var z=w.getDockingElement(v.currentDockArea);if(z){if(v.visibleFlag){z.visibleDockingZoneFlag=true}else{var B=z.getContainedVisibleWindows();var x=0;for(var y=0;y<B.length;y++){if(B[y].getContent().hasClassName("wux-windows-window")&&B[y].getContent().getStyle("display")!=="none"){x++}}if(x===0){z.visibleDockingZoneFlag=false}}}}});this.fire("addWindow",{window:v})}},removeWindow:function(w){if(w){for(var x in this.windows){var v=this.windows[x];if(v&&(v===w)){if(w.currentDockArea!==WUXDockAreaEnum.NoneDockArea){this.undockWindow(w)}if(w.position.of===this.getContent()){w.position.of=null}if(w.position.constraint===this.getContent()){w.position.constraint=null}if(this.elements&&this.elements.container){w.remove()}delete this.windows[x];w.immersiveFrame=null;break}}this.fire("removeWindow",{window:w})}},getDockingElement:function(v){return this.dockingElements[this.dockingElementsPriority.indexOf(v)]},containsWindow:function(w){var x=false;if(w){for(var y in this.windows){var v=this.windows[y];if(v&&(v===w)){x=true;break}}}return x},_computeUniqueIdentifier:function(w){if(!w){return}var x=(typeof w.identifier!=="undefined"&&w.identifier!=="")?w.identifier:"1";var v=2;while(this.windows[x]!==undefined){x=v;v++}return x},_getWindowFromIdentifier:function(x){for(var w in this.windows){if(!this.windows.hasOwnProperty(w)){continue}var v=this.windows[w];if(v.identifier===x){return v}}return undefined},handleEvents:function(){var A=this;for(var y=0;y<A.dockingElements.length;y++){var C=A.dockingElements[y];if(C){C.addEventListener("dockResize",function(D){A._manageAllPointerEventsOnDockingElements()})}}function z(){if(A.elements.container){for(var I in A.windows){var E=A.windows[I];if(E){E._applyWidth();E._applyHeight();E._applyPosition()}}A._manageAllPointerEventsOnDockingElements();var F=window.getComputedStyle(A.getContent());var H=parseInt(F.width)>480&&parseInt(F.height)>640;for(var D in WUXDockAreaEnum){var G=A.getDockingElement(WUXDockAreaEnum[D]);if(G){G.autoExpandFlag=H}}}}A._onResizeFun=z;function w(D){A.fire("freeZoneResize")}A._resizeFreeZoneFun=w;q.addResizeListener(this.elements.container,A._onResizeFun);q.addResizeListener(this.getFreeZone(),A._resizeFreeZoneFun);q.removeEventOnElement(this,this.elements.pointerEventsDiv,"click",function(){A.elements.pointerEventsDiv.hide()});var x=function(){A._manageAllPointerEventsOnDockingElements();A.removeEventListener("transitionend",x)};var B=function(){A.addEventListener("transitionend",x)};for(var v in WUXDockAreaEnum){var C=this.getDockingElement(WUXDockAreaEnum[v]);if(C){C.addEventListener("collapse",B);C.addEventListener("expand",B)}}},destroy:function(){if(this.elements&&this.elements.container){q.removeResizeListener(this.elements.container,this._onResizeFun);q.removeResizeListener(this.getFreeZone(),this._resizeFreeZoneFun);if(this._fakeStackedWindowSaved){this._fakeStackedWindowSaved.destroy();this._fakeStackedWindowSaved=null}this._parent()}},_manageAllPointerEventsOnDockingElements:function(){this.getDockingElement(WUXDockAreaEnum.BottomDockArea)._pointerEventsAllIfOverflow();this.getDockingElement(WUXDockAreaEnum.BottomDockArea)._resetInteractiveDockArea();this.getDockingElement(WUXDockAreaEnum.TopDockArea)._pointerEventsAllIfOverflow();this.getDockingElement(WUXDockAreaEnum.TopDockArea)._resetInteractiveDockArea();this.getDockingElement(WUXDockAreaEnum.LeftDockArea)._pointerEventsAllIfOverflow();this.getDockingElement(WUXDockAreaEnum.LeftDockArea)._resetInteractiveDockArea();this.getDockingElement(WUXDockAreaEnum.RightDockArea)._pointerEventsAllIfOverflow();this.getDockingElement(WUXDockAreaEnum.RightDockArea)._resetInteractiveDockArea()},_initStackingWindowsTimer:function(x,v){this._clearStackingWindowsTimer();var w=this;this._stopDragOccured=false;this._stackingTimeOut=setTimeout(function(){if(!w._stopDragOccured&&x.activeSnapArea===WUXSnapAreaEnum.InsideArea){w._snapTargetWindowForFeedback=x;var z=x._computeDropInsertionData(w._snapPointer);var y=w._getOrCreateFakePanelForStacking(v);w._snapSourceWindow=v;k.call(w,y,z.beforeOrAfter,z.targetWindow);v.hide();if(w._fakeStackedWindow.windowGroup){w._fakeStackedWindow.windowGroup.activeSnapArea=WUXSnapAreaEnum.InsideArea}}else{if(x){x.activeSnapArea=WUXSnapAreaEnum.NoneArea}}},c)},_clearStackingWindowsTimer:function(){if(this._stackingTimeOut){clearTimeout(this._stackingTimeOut);this._stackingTimeOut=null}},_startWindowGroupTabBarSliding:function(x,w){if(!this._windowGroupTabBarSlidingInterval){var v=this;this._windowGroupTabBarSliding=x;this._windowGroupTabBarSlidingDirection=w;this._windowGroupTabBarSlidingInterval=window.setInterval(function(){if(v._windowGroupTabBarSliding){v._windowGroupTabBarSliding._slideTabBar(v._windowGroupTabBarSlidingDirection)}},b)}},_stopWindowGroupTabBarSliding:function(){if(this._windowGroupTabBarSlidingInterval){window.clearInterval(this._windowGroupTabBarSlidingInterval);delete this._windowGroupTabBarSlidingInterval;this._windowGroupTabBarSlidingInterval=null;this._windowGroupTabBarSliding=null;this._windowGroupTabBarSlidingDirection=null}},_getOrCreateFakePanelForStacking:function(y){var x,A,w,v;if(!this._fakeStackedWindow){this._fakeStackedWindow=this._fakeStackedWindowSaved;if(!this._fakeStackedWindow){v=new e.Element("div",{"class":"wux-window-stacking-place-holder-container"});var z=new e.Element("div",{"class":"wux-window-stacking-place-holder"}).inject(v);z.innerText=o.stackingPlaceHolder;this._fakeStackedWindow=new j({resizableFlag:true,immersiveFrame:this,identifier:this.identifier+"_fakeStackedWindow",content:v})}if(!this._fakeStackedWindowSaved){this._fakeStackedWindowSaved=this._fakeStackedWindow}}if(!y.isAWindowGroup()){x=y.title;A=y.showTitleFlag;w=y.icon}else{x="( "+y.getEmbeddedWindows().length+" )";w="folder";A=true}this._fakeStackedWindow.title=x;this._fakeStackedWindow.showTitleFlag=A;this._fakeStackedWindow.icon=w;d.setPosition(this._fakeStackedWindow,y.position);this._fakeStackedWindow.show();return this._fakeStackedWindow},_computeFiringWindowDragEvents:function(v){var w=v;if(this._fakeStackedWindow&&(v!==this._fakeStackedWindow)){if(this._fakeStackedWindow.visibleFlag){w=this._fakeStackedWindow}else{w=this._snapSourceWindow}}return w},_replaceFakedWindowByReallyMovedWindow:function(v){if(v===this._fakeStackedWindow){this._fakeStackedWindow.hide();d.setPosition(this._snapSourceWindow,v.position);this._snapSourceWindow.show();this._snapSourceWindow.activeFlag=true;return this._snapSourceWindow}return v},_resetStackedWindowData:function(v){this._fakeStackedWindow=null;this._snapSourceWindow=null;this._stopDragOccured=true}});r.register(l,"DS/ControlsRec/AbstractRec");return l});define("DS/Tree/PanelMdlView",["DS/Core/BaseComponent","DS/Windows/Panel","DS/TreeModel/TreeNodeModel",],function(c,b,d){function g(k){for(var j=0;j<this.length;j++){if(this[j].nodeModel===k){return{index:j,item:this[j]}}}}function f(k){for(var j=0;j<this.length;j++){if(this[j].value===k){return this[j]}}}function i(j){for(var k=0;k<this.length;k++){if(this[k].panel===j){return this[k]}}}function h(k){var j=g.call(this._nodesModel,k);if(j&&j.item&&j.item.panel){j.item.panel.destroy();this._nodesModel.splice(j.index,1)}}function e(l){var j=new b({title:l.options.label,icon:l.options.icons?l.options.icons[0]:undefined,expandedFlag:l.options.state,immersiveFrame:this.immersiveFrame,resizableFlag:true,autoCloseFlag:false,closeButtonFlag:this.closeButtonFlag});var m;if(this._nodesModel.length>0){m=this._nodesModel[0].panel}if(m){j.attachToWindow(m,WUXSnapAreaEnum.InsideArea)}this._nodesModel.push({value:j.identifier,panel:j,nodeModel:l});var k=this;j.addEventListener("close",function(o){o.target.dsModel.visibleFlag=false;if(k.removeChildOnCloseFlag){var n=i.call(k._nodesModel,o.target.dsModel);n.nodeModel.remove()}})}var a=c.inherit({name:"PanelMdlView",_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel",},immersiveFrame:{defaultValue:undefined,type:Object,},closeButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},removeChildOnCloseFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},_applyModel:function(){var l=this;if(l._nodesModel){l._nodesModel.forEach(function(m){m.panel.visibleFlag=false;m.panel.destroy()})}l._nodesModel=[];if(l.model){var j=l.model.getChildren();j.forEach(function(m){e.call(l,m)});var k=l.model?(l.model._treeDocument||l.model.getTreeDocument()):undefined;if(k){k.onNodeModelUpdate(function(m){if(!m||!m.target||!m.target.options||!m.target.options.grid){return}var o=g.call(l._nodesModel,m.target);if(o&&o.item&&o.item.panel){var n=m.target.options;if(n.label!==o.item.panel.title){o.item.panel.title=n.label}if(n.icons&&n.icons[0]!==o.item.panel.icon){o.item.panel.icon=n.icons[0]}}});k._bindEventOnDocument("addChild",function(m){if(!m||!m.data||!m.data.nodeModel||m.data.nodeModel._nodeDepth!==l._modelDepth){return}e.call(l,m.data.nodeModel)});k._bindEventOnDocument("removeChild",function(m){if(!m||!m.data||!m.data.nodeModel||!m.parent||m.parent._nodeDepth!==l._modelDepth-1){return}h.call(l,m.data.nodeModel)})}}},_applyProperties:function(j){this._parent(j);if(this.isDirty("model")){this._applyModel()}},setContent:function(l,k){var j=g.call(this._nodesModel,l);if(j&&j.item&&j.item.panel){j.item.panel.content=k;j.item.content=k}}});return a});define("DS/Controls/Deck",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Maths/Vector3","DS/Utilities/Utils"],function(h,b,g,e,a,d){var c={translate:true,translate3d:true,translateX:true,translateY:true,translateZ:true,rotate:true,rotate3d:true,rotateX:true,rotateY:true,rotateZ:true,scale3d:true};var f=g.extend({init:function(i){this._transitionCounter=0;var j={selector:null,onComplete:function(){}};this.settings=h.extend(j,i);this.container=document.querySelector(this.settings.container);if(typeof this.settings.selector==="string"){this.items=d.listToArray(document.querySelectorAll(this.settings.selector));e.log("selector is string")}else{this.items.push(this.settings.selector);e.log("selector is uwa element")}e.log(this.items);this.currentEffectIndice=0;this.play()},buildSkeleton:function(){var i=this.elements;i.container=new h.Element("div",{"class":"AfrActionBar2",events:null});i.itemContainer=i.container},_attachTransition:function(){var i=this;this._transitionCounter=this.items.length;this.items.forEach(function(j){j.style.webkitTransition=i.settings.duration+"ms "+i.settings.ease});setTimeout(function(){i.nextEffect()},i.settings.duration)},_dettachTransition:function(){this.items.forEach(function(i){i.style.webkitTransition=""})},initial:function(){this.items.forEach(function(i){i.style.webkitTransform=""})},play:function(k){if(k===undefined){k=0}var j=this.settings.distributions[k];if(j){var m=this;var l;var o=this.items.length;this._attachTransition();setTimeout(function(){for(l=0;l<o;l++){m._iterate(l,m.items[l],j)}},10)}},_iterate:function(n,r,j){var l=r.style.webkitTransform;for(var o in j){if(typeof j[o]==="string"){r.style[o]=j[o]}else{var p=j[o](n,r,this.items);if(c[o]){var m="";var q="";switch(o){case"scale3d":q=/scale3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)\)/;var k=new a([p.x,p.y,p.z]);m=k.toString();break;case"translate3d":q=/translate3d\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/;var k=new a([p.x,p.y,p.z]);m=k.toString();break;case"rotate3d":q=/rotate3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)rad\)/;var k=new a([p.x,p.y,p.z]);m=k.toString()+", "+p.a+"rad";break}l=l.replace(q,"");l+=" "+o+"("+m+")"}else{r.style[o]=p}}}e.log("transform:"+l);r.style.webkitTransform=l},nextEffect:function(){this.currentEffectIndice++;if(this.settings.distributions[this.currentEffectIndice]){this.play(this.currentEffectIndice)}}});return f});define("DS/Controls/Tile",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Color","DS/Controls/Deck","DS/Core/PointerEvents"],function(g,l,i,c,j,e,a,h){var b="push-left";var k="push-right";var f="flip";function d(r){var o=parseFloat(r),n=r.replace(/^[\-\d\.]+/,"");return isNaN(o)?{v:n,f:color,u:""}:{v:o,f:interpolate,u:n}}var m=i.extend({defaultOptions:{rows:2,container:window,color:false,effects:"flip",button:false},init:function(n){this._parent(n);var p=this;this._id=g.Utils.getUUID();this._flagIsSecondary=false;var o=this.options.effects.split(":");this._effect=o[0];this._effectParam=parseFloat(o[1]);if(o[1]){this._effectParamUnit=o[1].replace(/^[\-\d\.]+/,"")}this.buildSkeleton();this._zIndex=this.elements.container.style.zIndex;this.elements.infos.addEvent(h.POINTERUP,function(q){q.preventDefault();q.stopPropagation();switch(p._effect){case f:p.rotate();break;case b:p.pushLeft();break;case k:p.pushRight();break}})},buildSkeleton:function(){var s=this;var u="white";if(this.options.color){u=e.random()}var n=800,q=200;var p="url(http://placekitten.com/g/"+(Math.ceil(n+Math.random()*n))+"/"+(Math.ceil(q+Math.random()*q))+")";var t=this.elements,o=this.options;var r="";if(this._effect==b||this._effect==k){r=""}if(this._effect==f){r=" Back"}t.container=new g.Element("div",{id:s._id,"class":"WUXTile",events:null});t.container.setAttributes({"data-color":e.hexToHsl(u)});t.front=new g.Element("div",{"class":"Primary Tile",id:g.Utils.getUUID(),styles:{backgroundSize:"cover",background:u},events:null});t.back=new g.Element("div",{"class":"Secondary Tile"+r,html:{tag:"div","class":"Logo"},events:null});t.infos=new g.Element("div",{"class":"Infos",html:"i",events:null});if(!this.options.button){t.infos.hide()}t.infos.inject(t.container);t.front.inject(t.container);t.back.inject(t.container)},setPrimaryViewContent:function(n,o){this.elements.front.setHTML(n);if(o){this.elements.front.setStyles(o)}},setSecondaryViewContent:function(n,o){this.elements.back.setHTML(n);if(o){this.elements.front.setStyles(o)}},setAlternativeViewContent:function(n,o){if(this.elements.container.hasClassName("Flip")){this.setPrimaryViewContent(n,o);this.displayPrimaryView()}else{this.setSecondaryViewContent(n,o);this.displaySecondaryView()}},toggleView:function(n,o){if(this.elements.container.hasClassName("Flip")){if(n){this.setPrimaryViewContent(n,o)}this.displayPrimaryView()}else{if(n){this.setSecondaryViewContent(n,o)}this.displaySecondaryView()}},displayAlternativeView:function(n,o){console.warn("deprecated","Controls/Tile","method displayAlternativeView is deprecated. Please use toggleView method");this.toggleView(n,o)},getPrimaryView:function(){return this.elements.front},getSecondaryView:function(){return this.elements.back},pushLeft:function(){this.elements.container.toggleClassName("wux-ui-state-left");var o=this;var p='[id="'+o.getPrimaryView().id+'"]';var q=this._effectParam;if(!this._flagIsSecondary){q="-"+q}if(this._flagIsSecondary&&this._effectParamUnit=="px"){q=0}q=q+this._effectParamUnit;this._flagIsSecondary=!this._flagIsSecondary;var n=new a({selector:p,container:"body",distributions:[{translate3d:function(t,s,r){return{x:q,y:0,z:0}}}],duration:200,ease:"ease-in-out"})},pushRight:function(){this.elements.container.toggleClassName("wux-ui-state-right");var n=this;var o='[id="'+n.getPrimaryView().id+'"]';var p=this._effectParam;if(this._flagIsSecondary){p=0}if(this._flagIsSecondary&&this._effectParamUnit=="px"){p=0}p=p+this._effectParamUnit;this._flagIsSecondary=!this._flagIsSecondary;this.elements.front.setStyles({transition:"transform ease-in-out 0.2s"});this.elements.front.setStyles({transform:"translate3d("+(p)+", 0, 0)"})},displayPrimaryView:function(n,o){if(n){this.setPrimaryViewContent(n,o)}this.elements.container.removeClassName("Flip")},displaySecondaryView:function(n,o){if(n){this.setSecondaryViewContent(n,o)}this.elements.container.addClassName("Flip")},rotate:function(){this.elements.container.toggleClassName("Flip")}});return g.namespace("WUX/Controls/Tile",m)});define("DS/Controls/Calendar",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/Utils","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/Controls/ComboBox","DS/Controls/Button"],function(e,m,g,h,a,i,f,n,k,d,p,l){var j;function c(q){return q<10?"0"+q:String(q)}var b=g.inherit({name:"calendar",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",advancedSetter:true,recordFlag:true},referenceDate:{defaultValue:null,type:"date",category:"Behavior"},minValue:{defaultValue:null,type:"date",category:"Behavior"},maxValue:{defaultValue:null,type:"date",category:"Behavior"}},blackBoxFlag:true,buildView:function(){j=new Date().getDate();this._updateLanguage();this.currentDate=new Date();this._properties.referenceDate.value=new Date();var r=Date.locale.month_names[this.currentDate.getMonth()],q=this.currentDate.getFullYear();this.elements.container.addClassName("wux-controls-calendar");this.elements.container.setAttribute("tabindex",0);this.elements.calendarHeader=new e.Element("div",{"class":"wux-controls-calendar-header"}).inject(this.elements.container);this.elements.left=new e.Element("div",{"class":"wux-controls-calendar-button  left","data-inc":"left"}).inject(this.elements.calendarHeader);this.elements.left.innerHTML='<i class="wux-ui-3ds wux-ui-3ds-expand-left"></i>';this.elements.center=new e.Element("div",{"class":"wux-controls-calendar-center"}).inject(this.elements.calendarHeader);this.monthsCombo=new p({elementsList:Date.locale.month_names,currentValue:Date.locale.month_names[this.currentDate.getMonth()],enableSearchFlag:true,autocompleteFlag:true,expanderVisibleFlag:false}).inject(this.elements.center);this.monthsCombo.getContent().style.maxWidth="72px";this._buildYearsList();this.elements.right=new e.Element("div",{html:">","class":"wux-controls-calendar-button  right","data-inc":"right"}).inject(this.elements.calendarHeader);this.elements.right.innerHTML='<i class="wux-ui-3ds wux-ui-3ds-expand-right"></i>';this.elements.calendarContainer=new e.Element("table",{"class":"wux-controls-calendar-table"}).inject(this.elements.container);this.elements.calendarTabHead=new e.Element("thead",{"class":"wux-controls-calendar-table-head",html:function(){return"<tr></tr>"}}).inject(this.elements.calendarContainer);this._updateColumnsHeader();this.elements.calendarFooter=new e.Element("div",{"class":"wux-controls-calendar-footer"}).inject(this.elements.container);this.elements.timePicker=new e.Element("div",{"class":"wux-controls-calendar-timePicker"}).inject(this.elements.calendarFooter);this.todayButton=new l({label:"Today"}).inject(this.elements.calendarFooter);this.todayButton.getContent().addClassName("wux-controls-calendar-todaybutton");this._properties.value.value=new Date(this.currentDate)},_buildCalendarDays:function(F,x){var J=this;var I=new Date(x,F);var A=o.call(J,I);var E=new Date();var z=new e.Element("tbody");var G;I.setDate(I.getDate()-A);var H=I.getMonth();var y=I.getFullYear();for(var D=0;D<A;D++){if(D===0){G=new e.Element("tr");z.appendChild(G)}var t=I.getDate();var L=String(Date.locale.day_names[D]+", "+Date.locale.month_names[H]+" "+t+", "+y);var r="other-date";if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}var s=new e.Element("td",{"class":r,text:t,title:L,});a.addEventOnElement(this,s,"click",function(P){if((J.disabled===false)&&(!this.hasClassName("unclickable"))){J._decrement();var Q=J.elements.container.querySelectorAll(".days");if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");if(Q[this.innerHTML-1]!==undefined){Q[this.innerHTML-1].classList.toggle("selected")}}else{if(Q[this.innerHTML-1]!==undefined){Q[this.innerHTML-1].classList.toggle("selected")}}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});s.setData("value",c(t)+"/"+c(H+1)+"/"+y);G.appendChild(s);I.setDate(t+1)}var v=A;var u=I.getMonth();var q=I.getFullYear();while(I.getMonth()===F){var t=I.getDate();if(v===0){G=new e.Element("tr");z.appendChild(G)}var L=String(Date.locale.day_names[v]+", "+Date.locale.month_names[u]+" "+t+", "+q);v=(v+1)%(Date.locale.day_names.length);var r="";r="days";if(t===E.getDate()&&E.getMonth()===F&&E.getFullYear()===x){r="today"}if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}if(this.value){if(t===this.value.getDate()&&u===this.value.getMonth()&&q===this.value.getFullYear()){r+=" selected"}}this.elements.days=new e.Element("td",{"class":r,title:L,text:t,}).setData("value",c(t)+"/"+c(u+1)+"/"+q);a.addEventOnElement(this,this.elements.days,"click",function(P){P.stopPropagation();if((J.disabled===false)&&(!this.hasClassName("unclickable"))){if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");this.classList.toggle("selected")}else{this.classList.toggle("selected")}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});G.appendChild(this.elements.days);I.setDate(t+1)}if(v!==0){var K=I.getMonth();var B=I.getFullYear();for(var C=v;C<Date.locale.day_names.length;C++){var t=I.getDate();var L=String(Date.locale.day_names[C]+", "+Date.locale.month_names[K]+" "+t+", "+B);var r="other-date";if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}var w=new e.Element("td",{"class":r,text:t,title:L,}).setData("value",c(t)+"/"+c(K+1)+"/"+B);a.addEventOnElement(this,w,"click",function(){if((J.disabled===false)&&(!this.hasClassName("unclickable"))){J._incremFromAfterDay=true;J._increment();var P=J.elements.container.querySelectorAll(".days");if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");P[this.innerHTML-1].classList.toggle("selected")}else{P[this.innerHTML-1].classList.toggle("selected")}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});G.appendChild(w);I.setDate(t+1)}}z.appendChild(G);return z},_buildYearsList:function(){var r=this.referenceDate.getFullYear();var u=-10;var q=10;var t=false;if(this.yearsList&&this.yearsList.indexOf(r.toString())===-1){t=true}this.yearsList=[];if(this.minValue){u=this.minValue.getFullYear()-r}if(this.maxValue){q=this.maxValue.getFullYear()-r}for(var s=u;s<=q;s++){this.yearsList[this.yearsList.length]=String(r+s);t=true}if(this.yearsCombo){this.yearsCombo.elements.mainElement.getContent().addClassName("wux-calendar-yearscombo");if(t){this._isBuildYearsList=true;if(this.yearsCombo.elementsList.toString()!==this.yearsList.toString()){this.monthsCombo.currentValue=Date.locale.month_names[this.referenceDate.getMonth()];this.yearsCombo.elementsList=this.yearsList}this.yearsCombo.currentValue=r.toString();this._isBuildYearsList=undefined}}else{this.yearsCombo=new p({elementsList:this.yearsList,currentValue:this.currentDate.getFullYear().toString(),enableSearchFlag:true,autocompleteFlag:true,expanderVisibleFlag:false}).inject(this.elements.center)}this.yearsCombo.getContent().style.maxWidth="74px";this.yearsCombo.getContent().style.marginLeft="4px"},handleEvents:function(){var r=this;r._isLeftDown=false;r._isRightDown=false;this.elements.left.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){r._isLeftDown=true}});this.elements.left.addEvent(f.POINTERUP,function(t){if(r.disabled===false&&r._isLeftDown){r._decrement();r.elements.calendarTab.className="";r._isLeftDown=false}});this.elements.right.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){r._isRightDown=true}});this.elements.right.addEvent(f.POINTERUP,function(t){if(r.disabled===false&&r._isRightDown){r._increment();r.elements.calendarTab.className="";r._isRightDown=false}});this.monthsCombo.addEventListener("show",function(t){t.stopPropagation()});this.yearsCombo.addEventListener("show",function(t){t.stopPropagation()});this.monthsCombo.addEventListener("hide",function(t){t.stopPropagation()});this.yearsCombo.addEventListener("hide",function(t){t.stopPropagation()});this.monthsCombo.addEventListener("change",function(u){u.stopPropagation();var t=Date.locale.month_names.indexOf(r.monthsCombo.currentValue);if(t===-1){t=r.referenceDate.getMonth();r.monthsCombo.value=Date.locale.month_names[r.referenceDate.getMonth()].toString()}if(r._isCurrentlyCalledFromUIInteraction()){r._setReferenceDate(new Date(r.referenceDate.getFullYear(),t,1))}else{r._setReferenceDate(new Date(r.referenceDate.getFullYear(),t,r.referenceDate.getDate()))}r._redrawCalendar()});this.yearsCombo.addEventListener("change",function(x){x.stopPropagation();var w;var v=parseInt(r.yearsCombo.currentValue);if(isNaN(v)){r.yearsCombo.value=r.referenceDate.getFullYear().toString()}else{if(!(v>=1000&&v<=9999)){r.yearsCombo.value=r.referenceDate.getFullYear().toString()}}var u=Date.locale.month_names.indexOf(r.monthsCombo.currentValue);if(!r._isBuildYearsList&&(u!==r.referenceDate.getMonth()||parseInt(r.yearsCombo.currentValue)!==r.referenceDate.getFullYear())){var t=new Date(parseInt(r.yearsCombo.currentValue),u,1);if(!isNaN(t)){r._setReferenceDate(t);w=true}else{r.yearsCombo.value=String(r.referenceDate.getFullYear())}}if(w){r._buildYearsList();r._redrawCalendar()}});a.addEventOnElement(this,this.todayButton.getContent(),"buttonclick",function(u){if(r.disabled===false){var t;t=new Date();r._properties.referenceDate.value=t;r._setCurrentDate(t);r.elements.calendarTab.remove();r.elements.calendarTabHead.show();r.elements.calendarTab=r._buildCalendarDays(r.currentDate.getMonth(),r.currentDate.getFullYear(),t.getDate());r.elements.calendarTab.inject(r.elements.calendarContainer);r._redrawCalendar()}});this.elements.calendarContainer.addEventListener(f.POINTERMOVE,function(t){t.preventDefault();t.stopPropagation()});this.elements.container.addEvent("mousewheel",function(t){if(r.disabled===false&&(r.elements.container===document.activeElement||r.getContent().hasAttribute("focused"))){t.preventDefault();t.stopPropagation();var u=e.Event.wheelDelta(event);if(u>0){r._decrement()}else{r._increment()}}});a.addEventOnElement(this,this.elements.container,"keydown",function(u){var t;if(u.keyCode===n.LEFTARROW){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()-1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_leftArrow")}else{if(u.keyCode===n.RIGHTARROW){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()+1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_rightArrow")}else{if(u.keyCode===n.ARROWUP){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()-7);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_arrowUp")}else{if(u.keyCode===n.ARROWDOWN){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()+7);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_arrowDown")}else{if(u.keyCode===n.PAGEUP){t=new Date(r.referenceDate);t.setMonth(r.referenceDate.getMonth()-1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_pageUp")}else{if(u.keyCode===n.PAGEDOWN){t=new Date(r.referenceDate);t.setMonth(r.referenceDate.getMonth()+1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_pageDown")}}}}}}});var q,s;a.addEventOnElement(this,document,f.POINTERUP,function(t){clearTimeout(s);clearInterval(q)});this.elements.left.addEvent(f.POINTERUP,function(t){t.stopPropagation();t.preventDefault();clearTimeout(s);clearInterval(q)});this.elements.left.addEvent(f.POINTERDOWN,function(t){t.stopPropagation();t.preventDefault();s=setTimeout(function(){q=setInterval(function(){a._pushUserInteractionContext();r._decrement();a._popUserInteractionContext()},100)},100)});this.elements.right.addEvent(f.POINTERUP,function(t){t.stopPropagation();t.preventDefault();clearTimeout(s);clearInterval(q)});this.elements.right.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){t.stopPropagation();t.preventDefault();s=setTimeout(function(){q=setInterval(function(){a._pushUserInteractionContext();r._increment();a._popUserInteractionContext()},100)},100)}});h.onlanguagechange(function(t){r._updateLanguage();r._updateColumnsHeader();r._redrawCalendar()})},_applyProperties:function(q){this._parent(q);this._preventRedraw=true;if(this.isDirty("referenceDate")){this._applyReferenceDate()}if(this.isDirty("minValue")){this._applyMinValue()}if(this.isDirty("maxValue")){this._applyMaxValue()}if(this.isDirty("value")){this._applyValue(q.value)}this._preventRedraw=false;if(this._redrawNeeded){if(this.value){this._setReferenceDate(this.value)}else{if(!this.referenceDate){this._setReferenceDate(new Date())}}this._redrawCalendar();this._redrawNeeded=false}},_applyMinValue:function(){this._correctValueToMinMaxValues();this._buildYearsList();this._updateArrows()},_applyMaxValue:function(){this._correctValueToMinMaxValues();this._buildYearsList();this._updateArrows()},_correctValueToMinMaxValues:function(){if(!i.isDateInBetween(this.minValue,this.value,this.maxValue,"day")){if(this.minValue&&this.value<this.minValue){this.value=this.minValue;this._setCurrentDate(this.value)}else{if(this.maxValue&&this.value>this.maxValue){this.value=this.maxValue;this._setCurrentDate(this.value)}}}if(this.value){this._updateLanguage();this._redrawCalendar()}},_preEditValue:function(q,r){if(!r){return true}if(typeof r==="string"){this.value=new Date(Date.parse(r));return false}else{if(r instanceof Date){if(e.equals(q,r)){return false}else{if(!i.isDateInBetween(this.minValue,r,this.maxValue,"day")){return false}}return true}}},_applyValue:function(q){this._setCurrentDate(this.value);if(!this.value){this._redrawCalendar()}},_applyReferenceDate:function(){if(this.referenceDate){this._setReferenceDate(this.referenceDate)}else{var q=new Date();this._setReferenceDate(q)}this._redrawCalendar();if(this.referenceDate){this._buildYearsList()}},_increment:function(){var r=this;var q;if(r.referenceDate.getMonth()===11){q=r._setReferenceDate(new Date(r.referenceDate.getFullYear()+1,0,1))}else{q=r._setReferenceDate(new Date(r.referenceDate.getFullYear(),r.referenceDate.getMonth()+1,1))}if(q){r._redrawCalendar()}},_decrement:function(){var r=this;var q;if(r.referenceDate.getMonth()===0){q=r._setReferenceDate(new Date(r.referenceDate.getFullYear()-1,11,1))}else{q=r._setReferenceDate(new Date(r.referenceDate.getFullYear(),r.referenceDate.getMonth()-1,1))}if(q){r._redrawCalendar()}},_setCurrentDate:function(r){var t=this.currentDate;if(e.equals(this.currentDate,r)){return}var s,q;if(this.minValue){s=new Date(this.minValue.getFullYear(),0,1)}if(this.maxValue){q=new Date(this.maxValue.getFullYear(),11,31)}if(i.isDateInBetween(s,r,q,"day")){if(r){this.currentDate=new Date(r);this.value=this.currentDate;this._setReferenceDate(this.value);if(!(this.value.getDate()===t.getDate()&&this.value.getMonth()===t.getMonth()&&this.value.getFullYear()===t.getFullYear())){this.fire("change")}return true}}return false},_setReferenceDate:function(r){if(e.equals(this.referenceDate,r)){return}var s,q;if(this.minValue){s=new Date(this.minValue.getFullYear(),0,1)}if(this.maxValue){q=new Date(this.maxValue.getFullYear(),11,31)}if(i.isDateInBetween(s,r,q,"day")){this.referenceDate=new Date(r);return true}return false},incrementDayValue:function(){if(this.value){var q=new Date(this.value);q.setDate(this.value.getDate()+1);this.value=q}},decrementDayValue:function(){if(this.value){var q=new Date(this.value);q.setDate(this.value.getDate()-1);this.value=q}},incrementMonthValue:function(){if(this.value){var q=new Date(this.value);q.setMonth(this.value.getMonth()+1);this.value=q}},decrementMonthValue:function(){if(this.value){var q=new Date(this.value);q.setMonth(this.value.getMonth()-1);this.value=q}},incrementYearValue:function(){if(this.value){var q=new Date(this.value);q.setFullYear(this.value.getFullYear()+1);this.value=q}},decrementYearValue:function(){if(this.value){var q=new Date(this.value);q.setFullYear(this.value.getFullYear()-1);this.value=q}},_redrawCalendar:function(){var t=this.referenceDate.getMonth();var r=this.referenceDate.getFullYear();if(this._preventRedraw){this._redrawNeeded=true;return}var q=new Date();if(this.elements.calendarTab){this.elements.calendarTab.remove()}var s=Date.locale.day_names[o.call(this,q)]+", "+Date.locale.month_names[q.getMonth()]+" "+q.getDate()+", "+q.getFullYear();this.elements.calendarFooter.set("title",s);this.elements.calendarTab=this._buildCalendarDays(t,r);this.elements.calendarTabHead.show();this.elements.calendarFooter.show();this.elements.calendarTab.inject(this.elements.calendarContainer);this._buildYearsList();this.monthsCombo.currentValue=Date.locale.month_names[this.referenceDate.getMonth()];this.yearsCombo.currentValue=this.referenceDate.getFullYear().toString();this._updateArrows()},_updateArrows:function(){var q=true;if(this.minValue){if(this.referenceDate.getMonth()===0){if(this.minValue.getFullYear()>this.referenceDate.getFullYear()-1){q=false}}else{if(this.minValue.getFullYear()>this.referenceDate.getFullYear()){q=false}}if(!q){this.elements.left.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.left.removeAttribute("disabled")}}q=true;if(this.maxValue){if(this.referenceDate.getMonth()===11){if(this.maxValue.getFullYear()<this.referenceDate.getFullYear()+1){q=false}}else{if(this.maxValue.getFullYear()<this.referenceDate.getFullYear()){q=false}}if(!q){this.elements.right.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.right.removeAttribute("disabled")}}},_updateColumnsHeader:function(){var t="";for(var r=0;r<Date.locale.day_names_short.length;r++){var q=Date.locale.day_names_short[r],s=Date.locale.day_names[r];t+="<th scope='col' title='"+s+"'>"+q+"</th>"}this.elements.calendarTabHead.innerHTML=t},_fadeOut:function(q){q.style.opacity=1;(function r(){if((q.style.opacity-=0.1)<0){q.style.display="none"}else{requestAnimationFrame(r)}})()},_fadeIn:function(q){q.style.opacity=0;(function r(){var s=parseFloat(q.style.opacity);if(((s+=0.1)<=1)){q.style.opacity=s;requestAnimationFrame(r)}})()},_slide:function(r,s,t){if(r){if(s==="toLeft"){s="300px"}else{if(s==="toRight"){s="-300px"}}r.addClassName("wux-controls-calendar-table-animated");r.setStyle("margin-left",s);r.setStyle("opacity","0");var q=function(u){if(t){t()}r.removeClassName("wux-controls-calendar-table-animated");r.setStyle("margin-left","0px");r.setStyle("opacity","1");r.removeEvent("transitionend",q)};r.addEvent("transitionend",q)}},_capitalizeFirstLetter:function(q){return q.charAt(0).toUpperCase()+q.slice(1)},_updateLanguage:function(){var q=k.Engine;if(q.safari||navigator.platform==="iPad"||navigator.platform==="iPhone"){if(h.currentLanguage==="fr"||h.currentLanguage==="fr-FR"||h.currentLanguage==="FR"){Date.locale={day_names:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_names_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],month_names:["Janvier","FÃÂ©vrier","Mars","Avril","Mai","Juin","Juillet","AoÃÂ»t","Septembre","Octobre","Novembre","DÃÂ©cembre"],month_names_short:["Jan","Fev","Mar","Avr","Mai","Jun","Jul","AoÃÂ»","Sep","Oct","Nov","DÃÂ©c"]}}else{Date.locale={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}}else{var t=new Date(0,0,1);var s=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours());t=s;Date.locale={};Date.locale.day_names=[];Date.locale.day_names_short=[];Date.locale.month_names=[];Date.locale.month_names_short=[];for(var r=0;r<7;r++){Date.locale.day_names.push(this._capitalizeFirstLetter(t.toLocaleDateString(h.currentLanguage,{weekday:"long"})));Date.locale.day_names_short.push(t.toLocaleDateString(h.currentLanguage,{weekday:"short"}));t.setDate(t.getDate()+1)}for(var r=0;r<12;r++){Date.locale.month_names.push(this._capitalizeFirstLetter(t.toLocaleDateString(h.currentLanguage,{month:"long"})));Date.locale.month_names_short.push(t.toLocaleDateString(h.currentLanguage,{month:"short"}));t.setMonth(t.getMonth()+1)}}if(this.monthsCombo&&this.monthsCombo.elementsList.toString()!==Date.locale.month_names.toString()){this.monthsCombo.elementsList=Date.locale.month_names}}});var o=function(t){var r=k.Engine;if(r.safari||navigator.platform==="iPad"||navigator.platform==="iPhone"){return t.getDay()}var q=t.toLocaleDateString(h.currentLanguage,{weekday:"short"});var s=Date.locale.day_names_short.indexOf(q);return s};d.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/DatePicker",["UWA/Core","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/Popup","DS/Controls/Calendar","DS/Controls/TimePicker","DS/Controls/LineEditor","DS/Controls/Button","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils"],function(h,j,k,a,l,f,c,q,b,o,e,p){function g(r){if(Object.prototype.toString.call(r)!=="[object Date]"){return false}return !isNaN(r.getTime())}function d(s,r){if(!g(s)||!g(r)){return false}if(s.getTime()===r.getTime()){return true}else{return false}}function n(){if(this._preventUpdateView){this._updateViewNeeded=true;return}if(this.value){if(this._editModeFlag){var s={year:"numeric",month:"2-digit",day:"2-digit"};if(this.timePickerFlag){s.hour="2-digit";s.minute="2-digit";if(this.timePickerPrecision==="sec"){s.second="2-digit"}s.hour12=false}if(this.timePickerFlag){this.elements.inputField.value=(this.value?this.value.toLocaleString("en-GB",s):"")}else{this.elements.inputField.value=(this.value?this.value.toLocaleDateString("en-GB",s):"")}this._editModeFlag=false}else{var r={year:"numeric",month:"short",day:"numeric"};if(this.timePickerFlag){r.hour="2-digit";r.minute="2-digit";if(this.timePickerPrecision==="sec"){r.second="2-digit"}}if(this.timePickerFlag){this.elements.inputField.value=(this.value?this.value.toLocaleString(this._currentLanguage,r):"")}else{this.elements.inputField.value=(this.value?this.value.toLocaleDateString(this._currentLanguage,r):"")}}}else{this.elements.inputField.value="";this._editModeFlag=false}}var m=j.inherit({name:"datePicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},minValue:{defaultValue:null,type:"date",category:"Behavior"},maxValue:{defaultValue:null,type:"date",category:"Behavior"},timePickerFlag:{defaultValue:false,type:"boolean",category:"Appearance"},timePickerPrecision:{defaultValue:"min",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true}},blackBoxFlag:true,_smartInputClass:"wux-controls-datepicker",keymaps:{esc:"manageEscape",},commands:{manageEscape:function i(){if(this.elements.popup&&this.elements.popup.visibleFlag){this.elements.popup.visibleFlag=false}}},buildView:function(){var r=this;this._editModeFlag=false;this.elements.container.addClassName(this._smartInputClass);this.elements.inputField=new b({sizeInCharNumber:20,fireOnlyFromUIInteractionFlag:true}).inject(this.elements.container);this.elements.calendarButton=new o({emphasize:"primary",icon:{iconName:"calendar",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container);this.elements.calendarButton.getContent().addClassName("wux-controls-datepicker-button");this.elements.popupContent=new h.Element("div",{"class":"wux-controls-datepicker-popup-content"});this._currentLanguage=k.currentLanguage;this.value=new Date();this.publishedProperties.value.defaultValue=new Date();this._buildPopup()},handleEvents:function(){var r=this;a.addEventOnElement(this,this.elements.inputField,"change",function(y){y.stopPropagation();if(y.dsModel.value!=""){var u=y.dsModel.value.substring(0,2),x=y.dsModel.value.substring(3,5),w=y.dsModel.value.substring(6,10);var t=new Date(w,x-1,u);var s,v,z;if(r.timePickerFlag){s=y.dsModel.value.substring(12,14);v=y.dsModel.value.substring(15,17);if(r.timePickerPrecision==="sec"){z=y.dsModel.value.substring(18,20)}t.setHours(s);t.setMinutes(v);if(r.timePickerPrecision==="sec"){t.setSeconds(z)}}else{if(r.value){t.setHours(r.value.getHours());t.setMinutes(r.value.getMinutes());t.setSeconds(r.value.getSeconds())}}if(g(t)){if(((t>r.minValue)||!r.minValue)&&((t<r.maxValue)||!r.maxValue)){r.setPropertyFromUIInteraction("value",new Date(t))}else{r._editModeFlag=false;n.call(r)}}}else{if(y.dsModel.value===""){r.setPropertyFromUIInteraction("value",null)}else{r._editModeFlag=false;n.call(r)}}if(r.elements.calendar){r.elements.calendar.referenceDate=new Date(r.value);r.elements.calendar.value=new Date(r.value)}});a.addEventOnElement(this,this.elements.inputField,"focus",function(s){r._editModeFlag=true;n.call(r);s.dsModel._myInput.select()});a.addEventOnElement(this,this.elements.inputField,"blur",function(s){r._editModeFlag=false;if(r.elements.popup&&!r.elements.popup.visibleFlag){n.call(r)}});a.addEventOnElement(this,this.elements.calendarButton,"click",function(s){s.stopPropagation()});k.onlanguagechange(function(s){r._editModeFlag=false;r._currentLanguage=k.currentLanguage;n.call(r)})},incrementDay:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setDate(r.getDate()+1);if((r<this.maxValue)||!this.maxValue){this.value.setDate(this.value.getDate()+1);this._editModeFlag=false;this._applyValue(s)}}},decrementDay:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setDate(r.getDate()-1);if((r>this.minValue)||!this.minValue){this.value.setDate(this.value.getDate()-1);this._editModeFlag=false;this._applyValue(s)}}},incrementMonth:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setMonth(r.getMonth()+1);if((r<this.maxValue)||!this.maxValue){this.value.setMonth(this.value.getMonth()+1);this._editModeFlag=false;this._applyValue(s)}}},decrementMonth:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setMonth(r.getMonth()-1);if((r>this.minValue)||!this.minValue){this.value.setMonth(this.value.getMonth()-1);this._editModeFlag=false;this._applyValue(s)}}},_preEditValue:function(r,s){if(!s){return true}if(typeof s==="string"){this.value=new Date(Date.parse(s));return false}else{if(s instanceof Date){if(h.equals(r,s)){return false}else{if(!l.isDateInBetween(this.minValue,s,this.maxValue,"day")){return false}}return true}}},_applyValue:function(s){var t=this;if(this.value){if(!g(this.value)){this.value=new Date();return}this._editModeFlag=false;var r=new Date(s);if(!(r.getDate()===this.value.getDate()&&r.getMonth()===this.value.getMonth()&&r.getFullYear()===this.value.getFullYear()&&r.getSeconds()===this.value.getSeconds()&&r.getHours()===this.value.getHours()&&r.getMinutes()===this.value.getMinutes())){n.call(this);this.fire("change")}}else{n.call(this)}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.calendarButton.disabled=true;this.elements.inputField.disabled=true}else{this.elements.calendarButton.disabled=false;this.elements.inputField.disabled=false}},_applyTouchMode:function(){this._parent();if(this.elements.calendarButton){this.elements.calendarButton.touchMode=this.touchMode}if(this.elements.inputField){this.elements.inputField.touchMode=this.touchMode}},_applyMinValue:function(){this._correctValueToMinMaxValues();if(this.elements.calendar){this.elements.calendar.minValue=this.minValue}},_applyMaxValue:function(){this._correctValueToMinMaxValues();if(this.elements.calendar){this.elements.calendar.maxValue=this.maxValue}},_correctValueToMinMaxValues:function(){if(!l.isDateInBetween(this.minValue,this.value,this.maxValue,"day")){if(this.minValue&&this.value<this.minValue){this.value=this.minValue}else{if(this.maxValue&&this.value>this.maxValue){this.value=this.maxValue}}}},_applyTimePickerFlag:function(){if(!this.elements.timePicker){if(this.timePickerFlag&&this.elements.calendar){this._buildTimePicker()}else{return}}this._editModeFlag=false;n.call(this)},_applyTimePickerPrecision:function(){if(this.elements.timePicker){this.elements.timePicker.precision=this.timePickerPrecision}this._editModeFlag=false;n.call(this)},_applyProperties:function(r){this._parent(r);this._preventUpdateView=true;if(this.isDirty("value")){this._applyValue(r.value)}if(this.isDirty("minValue")){this._applyMinValue(r.minValue)}if(this.isDirty("maxValue")){this._applyMaxValue(r.maxValue)}if(this.isDirty("timePickerFlag")){this._applyTimePickerFlag(r.timePickerFlag)}if(this.isDirty("timePickerPrecision")){this._applyTimePickerPrecision(r.timePickerPrecision)}this._preventUpdateView=false;if(this._updateViewNeeded){n.call(this);this._updateViewNeeded=false}},_giveFocus:function(){if(this._isFocused()){return}this._editModeFlag=true;this.elements.inputField._giveFocus();this.elements.inputField._myInput.select()},_applyPopupVisibleFlag:function(r){if(this.popupVisibleFlag){if(this.elements.popup){this.elements.popup.visibleFlag=true}}else{if(this.elements.popup){this.elements.popup.visibleFlag=false}}},_buildPopup:function(){var r=this;var s={target:this.elements.calendarButton.getContent(),position:"bottom",trigger:"click",constraint:"screen"};s.offset={x:-180,y:4};this.elements.popup=new f(s);this.elements.popup.addEventListener("show",function(t){t.stopPropagation();if(!r.elements.popup.getBody()){r._buildCalendarAndButtons();if(r.timePickerFlag){r._buildTimePicker()}r.elements.popup.setBody(r.elements.popupContent)}r._onShowPopupValue=new Date(r.value);if(r.elements.calendar){if(r.value){r.elements.calendar.referenceDate=new Date(r.value);r.elements.calendar.value=new Date(r.value);if(r.elements.timePicker){r.elements.timePicker.value=new Date(r.value)}}else{r.elements.calendar.value=null;if(r.elements.timePicker){r.elements.timePicker.value=null}}}r.setPropertyFromUIInteraction("popupVisibleFlag",true);r.fire("show")});this.elements.popup.addEventListener("hide",function(t){if(t.target===r.elements.popup.getContent()){t.stopPropagation();if(r.elements.timePicker&&r.value&&!d(r.elements.timePicker.value,r.value)){r.setPropertyFromUIInteraction("value",r.elements.timePicker.value,"timePicker_change")}r.setPropertyFromUIInteraction("popupVisibleFlag",false);r.fire("hide");n.call(r)}});this.elements.popup.getContent().addEventListener("keydown",function(t){if(p.ESCAPE===t.keyCode){if(r.elements.popup&&r.elements.popup.visibleFlag){r.elements.popup.visibleFlag=false}}})},_buildCalendarAndButtons:function(){var r=this;this.elements.calendar=new c({value:this.value,minValue:this.minValue,maxValue:this.maxValue,fireOnlyFromUIInteractionFlag:true});this.elements.calendar.inject(this.elements.popupContent);this.elements.calendar.addEventListener("change",function(u){u.stopPropagation();if(u.dsModel&&u.dsModel.value){var s=new Date(u.dsModel.value);if(r.elements.timePicker){s.setHours(r.elements.timePicker.value.getHours());s.setMinutes(r.elements.timePicker.value.getMinutes());s.setSeconds(r.elements.timePicker.value.getSeconds())}else{if(r.value){s.setHours(r.value.getHours());s.setMinutes(r.value.getMinutes());s.setSeconds(r.value.getSeconds())}else{var t=new Date();s.setHours(t.getHours());s.setMinutes(t.getMinutes());s.setSeconds(t.getSeconds())}}r.setPropertyFromUIInteraction("value",s);if(r.elements.timePicker){if(r.elements.timePicker.value){r.elements.timePicker.value.setDate(r.value.getDate());r.elements.timePicker.value.setMonth(r.value.getMonth());r.elements.timePicker.value.setFullYear(r.value.getFullYear())}else{r.elements.timePicker.value=new Date(r.value)}}if(r.elements.popup&&r.elements.popup.visibleFlag){r.elements.popup.visibleFlag=false}r._editModeFlag=false}})},_buildTimePicker:function(){var s=this;s.elements.timePicker=new q({value:this.value,precision:this.timePickerPrecision});var r=s.elements.popupContent.querySelector(".wux-controls-calendar-timePicker");s.elements.calendar.elements.timePicker.style.display="block";s.elements.timePicker.inject(r);if(s.timePickerPrecision==="min"){s.elements.timePicker.elements.popup.offset.x=-80}this.elements.timePicker.addEventListener("change",function(t){t.stopPropagation();if(t.dsModel&&t.dsModel.value){if(s.elements.timePicker.value&&s.value){s.elements.timePicker.value.setDate(s.value.getDate());s.elements.timePicker.value.setMonth(s.value.getMonth());s.elements.timePicker.value.setFullYear(s.value.getFullYear())}else{s.elements.timePicker.value=new Date(s.value)}s._editModeFlag=false}});this.elements.timePicker.addEventListener("show",function(t){t.stopPropagation()});this.elements.timePicker.addEventListener("hide",function(t){t.stopPropagation()})}});e.register(m,"DS/ControlsRec/AbstractRec");return m});define("DS/Tweakers/TweakerDate",["UWA/Core","DS/Tweakers/TweakerRange","DS/Controls/DatePicker","DS/Controls/TimePicker","DS/Utilities/Utils"],function(b,c,f,h,e){var i=c.inherit({name:"tweakerDate",publishedProperties:{value:{defaultValue:null,type:"date",advancedSetter:true},minValue:{defaultValue:null,type:"date"},maxValue:{defaultValue:null,type:"date"},timePickerFlag:{defaultValue:false,type:"boolean"},timePickerPrecision:{defaultValue:"min",type:"string"},displayStyle:{defaultValue:"date",type:"string"}},_applyTimePickerFlag:function(j){if(this.elements._viewModule&&this.elements._viewModule.setTimePickerFlag){this.elements._viewModule.setTimePickerFlag(this.timePickerFlag)}},_applyTimePickerPrecision:function(j){if(this.elements._viewModule&&this.elements._viewModule.setTimePickerPrecision){this.elements._viewModule.setTimePickerPrecision(this.timePickerPrecision)}},_applyProperties:function(j){this._parent(j);if(this.isDirty("timePickerFlag")){this._applyTimePickerFlag(j.timePickerFlag)}if(this.isDirty("timePickerPrecision")){this._applyTimePickerPrecision(j.timePickerPrecision)}},getStringFromValue:function(k){var j={year:"numeric",month:"short",day:"numeric"};if(this.displayStyle==="date"){if(this.timePickerFlag){j.hour="numeric";j.minute="numeric";if(this.timePickerPrecision==="sec"){j.second="numeric"}}}else{if(this.displayStyle==="time"){j={hour:"numeric",minute:"numeric"};if(this.timePickerPrecision==="sec"){j.second="numeric"}}}if(k&&!k.toLocaleDateString){k=this._upgradeValue(k)}return k?k.toLocaleDateString(WUX.currentLanguage,j):""},_upgradeValue:function(j){if(e.equalsToNaN(j)){return undefined}var k=j;if(typeof j!=="undefined"&&j!==null&&!(j instanceof Date)){k=new Date(j)}return this._parent(k)}});var d=function(k,j){c.prototype.baseViewModule.call(this,k,j)};e.applyMixin(d,c.prototype.baseViewModule);d.prototype.handleEvents=function(){var j=this._view;if(j===undefined){return}var l=this._tweaker;var k=this;if(l.readOnly){return}j.addEventListener("change",function(m){m.stopPropagation();k.setTweakerValue(j.value)});j.addEventListener("liveChange",function(m){m.stopPropagation();k.setTweakerValue(j.value)});j.addEventListener("show",function(m){m.stopPropagation();l.onShow()});j.addEventListener("hide",function(m){m.stopPropagation();l.onHide()})};d.prototype.setTimePickerFlag=function(){};d.prototype.setTimePickerPrecision=function(){};var g=function(k,j){d.call(this,k,j)};e.applyMixin(g,d);g.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.precision=this._tweaker.precision;j.touchMode=this._tweaker.touchMode;j.fireOnlyFromUIInteractionFlag=true;this._view=new h(j);this.setValue(this._tweaker.value)};g.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}d.prototype.destroy.call(this)};g.prototype.setValue=function(k,j){if(!this._view){return}this._view.value=k};g.prototype.setTimePickerPrecision=function(j){if(!this._view){return}this._view.precision=j};var a=function(k,j){d.call(this,k,j)};e.applyMixin(a,d);a.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var j=this._options.viewOptions||{};j.timePickerFlag=this._tweaker.timePickerFlag;j.timePickerPrecision=this._tweaker.timePickerPrecision;j.touchMode=this._tweaker.touchMode;j.fireOnlyFromUIInteractionFlag=true;this._view=new f(j);this.setValue(this._tweaker.value)};a.prototype.destroy=function(){if(this._view){this._view.popupVisibleFlag=false}d.prototype.destroy.call(this)};a.prototype.setValue=function(k,j){if(!this._view){return}if(typeof(k)==="string"){k=new Date(k)}this._view.value=k};a.prototype.setTimePickerPrecision=function(j){if(!this._view){return}if(this._view.timePickerPrecision){this._view.timePickerPrecision=j}};a.prototype.setTimePickerFlag=function(j){if(!this._view){return}if(this._view.timePickerFlag){this._view.timePickerFlag=j}};i.prototype.baseViewModule=d;i.prototype.VIEW_MODULES={time:{classObject:g},date:{classObject:a}};i.prototype.registerViewModule=function(j,k){return;if(!j||!k||!k.classObject&&!k.classPath){return}if(i.prototype.VIEW_MODULES[j]!==undefined){return}i.prototype.VIEW_MODULES[j]=k};return i});