define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience",["DS/VCXWebComponents/VCXWebComponentOccurrence"],function(b){var a=b.extend({init:function(){this._parent();this._tooltip="$(##Actor.Name)";this._hyperlinkID=-1;this._eFreeze=0}});Object.defineProperty(a.prototype,"tooltip",{enumerable:true,get:function(){return this._tooltip},set:function(c){this._tooltip=c}});Object.defineProperty(a.prototype,"hyperlinkID",{enumerable:true,get:function(){return this._hyperlinkID},set:function(c){this._hyperlinkID=c}});Object.defineProperty(a.prototype,"eFreeze",{enumerable:true,get:function(){return this._eFreeze},set:function(c){this._eFreeze=c}});Object.defineProperty(a.prototype,"componentType",{enumerable:true,get:function(){return"VCXComponentOccurrenceExperience"}});return a});define("DS/VCXWebExperienceBase/VCXWebBaseKernelTools",[],function(){Number.isInteger=Number.isInteger||function(a){return typeof a==="number"&&isFinite(a)&&Math.floor(a)===a};if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(b,c){if(this===null){throw new TypeError('"this" is null or not defined')}var f=Object(this);var d=f.length>>>0;if(d===0){return false}var e=c|0;var a=Math.max(e>=0?e:d-Math.abs(e),0);while(a<d){if(f[a]===b){return true}a++}return false}})}if(!String.prototype.includes){String.prototype.includes=function(a,b){if(typeof b!=="number"){b=0}if(b+a.length>this.length){return false}else{return this.indexOf(a,b)!==-1}}}});define("DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices",["DS/SceneGraphOverrides/SceneGraphOverrideSet",],function(a){return{createAndPushSceneGraphOverrideSet:function(b,d){var f=null;var c=b.getManager("VCXContextManager").getRootNode();if(c){if(d){}else{d=b.getManager("VCXContextManager").getMainViewer()}if(d){var e=d.getSceneGraphOverrideSetManager();f=new a(c);e.pushSceneGraphOverrideSet(f)}}return f},removeSceneGraphOverrideSet:function(c,f,d){var b=false;if(c&&f){}else{return b}if(d){}else{var d=c.getManager("VCXContextManager").getMainViewer()}if(d){var e=d.getSceneGraphOverrideSetManager();e.removeSceneGraphOverrideSet(f);b=true}return b},getSceneGraphOverride:function(d,c){var b=null;if(d){b=d.getUniqueOverrideFromPathElement(c);if(!b){b=d.createOverride(c)}}return b},}});"use strict";var VCXBaseDictionary=function(){var d={VCXWebComponentOccurrence:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableOccurrence",VCXIVisibility:"DS/VCXWebVisibilityImpl/VCXVisibilityOccurrence",VCXIModelNavigable:"DS/WebApplicationBase/VCXAModelNavigable",W3AISGNodeHolder:"DS/WebApplicationBase/W3AASGNodeHolder"},VCXScenario:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableScenario"},VCXContextManager:{W3AIManager:"DS/VCXWebExperienceBase/VCXContextManager"},VCXScenarioManager:{VCXIModifiable:"DS/VCXWebScenarioManager/VCXModifiableScenarioManager",W3AIManager:"DS/VCXWebScenarioManager/VCXScenarioManager"},VCXDocManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableDocManager",W3AIManager:"DS/VCXWebExperienceBase/VCXDocManager"},VCXCommandManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableCommandManager",W3AIManager:"DS/VCXWebKernelCommands/VCXCommandManager"},VCXMetaPropertyManager:{W3AIManager:"DS/VCXWebModifiables/VCXMetaPropertyManager"},VCXLinkedPropertyManager:{W3AIManager:"DS/VCXWebModifiables/VCXLinkedPropertyManager"},VCXUnitManager:{VCXIModifiable:"DS/VCXWebUnits/VCXUnitManagerModifiable",W3AIManager:"DS/VCXWebUnits/VCXUnitManager"},VCXModelChangeListener:{W3AIManager:"DS/VCXWebModifiables/VCXModelChangeListener"},};var b={VCXIModifiable:"DS/VCXWebModifiables/VCXIModifiable",VCXIVisibility:"DS/VCXWebVisibility/VCXIVisibility",W3AISGNodeHolder:"DS/WebApplicationBase/W3AISGNodeHolder",W3AIManager:"DS/WebApplicationBase/W3AIManager",VCXIModelNavigable:"DS/WebApplicationBase/VCXIModelNavigable"};var a={VCXScenario:"DS/VCXKeyFramer/VCXScenario",VCXWebComponentOccurrence:"DS/VCXWebComponents/VCXWebComponentOccurrence",VCXDocManager:"DS/VCXWebExperienceBase/VCXDocManager",VCXScenarioManager:"DS/VCXWebScenarioManager/VCXScenarioManager",VCXCommandManager:"DS/VCXWebKernelCommands/VCXCommandManager",VCXContextManager:"DS/VCXWebExperienceBase/VCXContextManager",VCXMetaPropertyManager:"DS/VCXWebModifiables/VCXMetaPropertyManager",VCXLinkedPropertyManager:"DS/VCXWebModifiables/VCXLinkedPropertyManager",VCXUnitManager:"DS/VCXWebUnits/VCXUnitManager",VCXModelChangeListener:"DS/VCXWebModifiables/VCXModelChangeListener"};var c=["DS/WebExtensionServers/WebExtensionServer"];Object.keys(d).forEach(function(e){Object.keys(d[e]).forEach(function(f){c.push(d[e][f])})});Object.keys(b).forEach(function(e){c.push(b[e])});Object.keys(a).forEach(function(e){c.push(a[e])});define("DS/VCXWebExperienceBase/VCXBaseDictionary",c,function(){var e=arguments;var g=e[0];var f={fillServer:function(){var j=new g();var h=0;var i=this;Object.keys(d).forEach(function(k){Object.keys(d[k]).forEach(function(m){h++;var l=e[h];var n=c[h];l.GetOrigin=function(){return n};j.AddExtension(k,m,l)})});Object.keys(b).forEach(function(l){h++;var k=e[h];j.AddInterface(l,k)});Object.keys(a).forEach(function(m){h++;var k=e[h];var l=c[h];k.GetOrigin=function(){return l};j.AddComponent(m,k)});return j}};return f})};VCXBaseDictionary();define("DS/VCXWebExperienceBase/VCXNLSManager",["DS/WebApplicationBase/W3AAManager"],function(b){var a=b.extend({init:function(){this._NLSMap={}},initialize:function(){},unInitialize:function(){},GetNLS:function(c){return this._NLSMap[c]},AddNLS:function(c,d){this._NLSMap[c]=d}});Object.defineProperty(a.prototype,"componentType",{enumerable:true,get:function(){return"VCXNLSManager"}});return a});define("DS/VCXWebExperienceBase/VCXPathElementTools",["UWA/Class","DS/Visualization/PathElement",],function(a,c){var b=a.singleton({getMesh3dPathElement:function(f){if(!f){return null}var g=new c();for(var e=0;e<f.externalPath.length;++e){g.addElement(f.externalPath[e])}var d=g.getLastElement();while(d){d=d.children.length?d.children[0]:null;if(d){g.addElement(d);if("Mesh3D"===d.getNodeType()){return g}}}return null},getMesh3dPathElements:function(f,k){var g=[];if(!f.externalPath||!f.externalPath.length){return g}if("Mesh3D"===f.getLastElement().getNodeType()){g.push(f)}var n=new c();for(var m=0;m<f.externalPath.length;++m){n.addElement(f.externalPath[m])}var h=n.getLastElement();for(var m=0;m<h.children.length;++m){var d=true;for(var l=0;l<k.length;++l){if(k[l]===h.children[m].productType){d=false;break}}if(!d){continue}var o=n.clone();o.addElement(h.children[m]);var e=this.getMesh3dPathElements(o,k);if(e&&e.length){g=g.concat(e)}}return g},getLeafNameOfPathElement:function(g){if(!g){return""}var e=g.externalPath.length-1;if(e<0){return""}do{var f=g.externalPath[e];var d=f.getName();if(d&&d!==""){return d}e=e-1}while(e>0);return""}});return b});require(["DS/VCXWebExperienceBase/VCXWebBaseKernelTools"],function(a){});define("DS/VCXWebExperienceBase/VCXExperienceBase",["DS/WebApplicationBase/WebApplicationBase","DS/VCXWebExperienceBase/VCXBaseDictionary","DS/VCXWebKernelCommands/VCXCmdChangeComponent"],function(c,b,a){var d=c.extend({init:function(j){this._parent(j,b);var k=this.Factory.BuildComponent("VCXCommandManager");k.SetID("VCXCommandManagerID");k.SetPersistency(1);this._ManagerSet.addManager("VCXCommandManager",k);var i=this.Factory.BuildComponent("VCXScenarioManager");i.SetID("VCXScenarioManagerID");i.SetPersistency(1);this._ManagerSet.addManager("VCXScenarioManager",i);var n=this.Factory.BuildComponent("VCXDocManager");n.SetID("VCXDocManagerID");n.SetPersistency(1);this._ManagerSet.addManager("VCXDocManager",n);var l=this.Factory.BuildComponent("VCXContextManager");l.SetID("VCXContextManagerID");l.SetPersistency(1);this._ManagerSet.addManager("VCXContextManager",l);var f=this.Factory.BuildComponent("VCXMetaPropertyManager");f.SetID("VCXMetaPropertyManagerID");f.SetPersistency(1);this._ManagerSet.addManager("VCXMetaPropertyManager",f);var m=this.Factory.BuildComponent("VCXLinkedPropertyManager");m.SetID("VCXLinkedPropertyManagerID");m.SetPersistency(1);this._ManagerSet.addManager("VCXLinkedPropertyManager",m);var h=this.Factory.BuildComponent("VCXUnitManager");h.SetID("VCXUnitManagerID");h.SetPersistency(1);this._ManagerSet.addManager("VCXUnitManager",h);var g=this.Factory.BuildComponent("VCXModelChangeListener");g.SetID("VCXModelChangeListenerID");g.SetPersistency(1);this._ManagerSet.addManager("VCXModelChangeListener",g);var e=new a(this.getManager("VCXCommandManager"),this.ComponentsMap);e.AddComponents([k,i,n,l,f,m,]);this.getManager("VCXCommandManager").Do(e);this._bModifiablesAdvancedProperties=false},Clean:function(){this._parent()},AddDictionary:function(e){this._parent(e)},AddDictionaryApp:function(e){this._parent(e)},AddDictionaryBase:function(e){this._parent(e)},});Object.defineProperty(d.prototype,"ModifiablesAdvancedProperties",{enumerable:true,get:function(){return this._bModifiablesAdvancedProperties},set:function(e){this._bModifiablesAdvancedProperties=e}});return d});define("DS/VCXWebExperienceBase/VCXDocManager",["DS/CoreEvents/Events","DS/WebApplicationBase/W3AAManager","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueHyperlinkId"],function(b,d,i,g,h,e,f,a){var c=d.extend({initialize:function(){this._map=[];this._defaultImageIdx=-1;this.actorDocManager=null},initActorDocManager:function(m){if(this.actorDocManager){m();return}var l=this;var j=l._experienceBase.getManager("VCXCAT3DXModelManager");if(j&&!j.IsLocalMode()){var k=l._experienceBase.getManager("VCXContextManager").getRootComponent();if(k){l._experienceBase.getManager("VCXCAT3DXModelManager").CreateActor("VCXActorDocManager",undefined,k).done(function(n){if(n){l.actorDocManager=n;var o=l.actorDocManager.QueryInterface("VCXIModifiable");o.GetProperties();m()}else{console.log("VCXActorDocManager not built !")}})}else{console.error("CityUrbanManager: Missing father experience!")}}else{if(m){m()}}},unInitialize:function(){this._map=[];this._defaultImageIdx=-1},postInitialize:function(){},SetDefaultImageIndex:function(j){this._defaultImageIdx=j},GetDefaultImageIndex:function(){return this._defaultImageIdx},AddOrModifyDoc:function(l,j){if(l===null){console.log("DocManager::AddOrModifyDoc vcxPropPath NULL !!");return}var k=this.AddOrModifyDocInt(l,j);var m=new f();m.SetValue(k);b.publish({event:"VCX_DOC_ADDED"});return m},AddOrModifyDocInt:function(m,k){var j=this;var l=j.HasDocInt(m);var n=0;if(l>=0){n=l}else{n=this._map.length;this._map[n]=m}if(this.actorDocManager){this.actorDocManager.AddDocToBase64Map(n,m,k)}return n},RemoveDocument:function(j){delete this._map[j];if(this.actorDocManager){this.actorDocManager.RemoveDocument(j)}},AddOrModifyHyperlink:function(l){var k=new a();if(l!==null){var j=this.AddOrModifyDocInt(l);k.SetValue(j);b.publish({event:"VCX_DOC_ADDED"})}else{k.SetValue(-1)}return k},HasDocInt:function(m){var j=-1;var l=false;for(var k=0;k<this._map.length&&!l;k++){var n=this._map[k];if(m&&m.IsEqualTo(n)){l=true;j=k}}return j},GetPropPath:function(k){var j=this._map[k];return j},IsEmpty:function(){if(this._map.length>0){return false}else{return true}},NumberOfDoc:function(){return this._map.length},BuildPathFromString:function(m,o){if(typeof m==="string"){}else{console.log("DocManager: strData is empty !!");return}var k=new i();var j=new g();j.SetValue(0);k.SetPathType(j);var l=new h();l.SetValue(m);k.SetValueURL(l);if(m.indexOf("blob:")>=0){if(o){}else{o=""}var n=new h();n.SetValue(o);k.SetFileName(n)}return k},BuildPathFromLink:function(l,o){var k=null;if(l){}else{return k}var m=new e();m.SetValue(l);var j=new g();var n=1;if(o){n=o}j.SetValue(n);k=new i();k.SetPathType(j);k.SetValueLink(m);return k},AddFileNameToDoc:function(l,n){if(l!=="undefined"&&n){if(n.indexOf(".")<0){n="."+n}var k=l+n;var j=this._map[l];var m=j.GetFileName();if(m){}else{m=new h()}m.SetValue(k);j.SetFileName(m)}},GetDocMapClone:function(){var l={};for(var k in this._map){if(this._map.hasOwnProperty(k)){var j=this._map[k];l[k]=j.Clone()}}return l}});Object.defineProperty(c.prototype,"componentType",{enumerable:true,get:function(){return"VCXDocManager"}});return c});define("DS/VCXWebExperienceBase/VCXContextManager",["DS/CoreEvents/Events","DS/WebApplicationBase/W3AAManager","DS/Visualization/Node3D","DS/WebappsUtils/WebappsUtils","DS/SceneGraphOverrides/SceneGraphOverrideSet","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/Visualization/PathElement"],function(a,g,h,b,f,j,e,c){var i;"use strict";var d=g.extend({init:function(){this._showRoomMode=false;this._playerMode=false;this._openSMG=false;this._cityMode=false;this._prodHighMode=false;this._ExperienceIn3DPlay=false;this.useTraverseGraph=false;this._displayUI=true;this._displayUIAssemblyPanelMode=true;this._displayUIDressupsPanelMode=true;this._displayUIScenariosPanelMode=true;this._displayUIPropertiesPanelMode=true;this._trapSelectionPick=null;this._trapSelectionPrePick=null;this._displayPaper=true;this._rootInfos={componentType:"VCXWebComponentOccurrence",productType:"Reference3D",name:"Experience",id:"VCX_Root",};this._cat3DXIntegration=false;this._openProduct=false;this._openAmbience=false;this._fileMode=false;this._pickerHasCanonicsDetection=false},initialize:function(){this.viewers=[];this._UseOverrideSet=true;e.setNotificationManager(j);e.setStackingPolicy(7)},postInitialize:function(){this._nRootNode=null;this._nPartsNode=null;this._activeCamera=null;this._activeGround=null;var k=this.getMainViewer();if(k){if(typeof this._trapSelectionPick!=="boolean"&&k.picking){this._trapSelectionPick=Boolean(k.picking.trapSelection)}if(typeof this._trapSelectionPrePick!=="boolean"&&k.pPicking){this._trapSelectionPrePick=Boolean(k.pPicking.trapSelection)}}this.InitEventListeners();this.traverseGraphMustBePerformed=true},getUpdatePriority:function(){return -8},unInitialize:function(){if(this._SharedSceneGraphOverrideSet){var l=this.getMainViewer();if(l){var m=l.getSceneGraphOverrideSetManager();m.removeSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet)}this._SharedSceneGraphOverrideSet=null}this.UnInitEventListeners();if(this._nRootNode){this._experienceBase.getManager("VCXContextManager").getMainViewer().removeNode(this._nRootNode);this._nRootNode=null;this._nPartsNode=null;this._pRootPathElement=null}delete this._currentWorkingRoot;delete this._activeCamera;delete this._activeGround;delete this._activeBOM;if(this._cRootComponent){var k=this._cRootComponent.QueryInterface("VCXIModelNavigable");if(k){k.clear()}this._cRootComponent=null}this._playerMode=false;this._openSMG=false;this._cityMode=false;this._prodHighMode=false;this._showRoomMode=false;this._ExperienceIn3DPlay=false;this._trapSelectionPick=null;this._trapSelectionPrePick=null;this._pickerHasCanonicsDetection=false;e.removeNotifications("","")},getUrlVars:function(){var n={};var k={};var m=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(o,p,q){n[p]=decodeURIComponent(q)});var l;if(n.widgetDomain){l=n.widgetDomain}else{if(n.uwaUrl){l=n.uwaUrl}}if(l){m=(l).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(o,p,q){k[p]=q})}else{k=n}return k},isIE11:function(){var o=["msTextCombineHorizontal"];var n=document;var k=n.body;var l=k.style;var m;if(l[o[0]]!==undefined){return true}else{return false}},useOverrideSet:function(k){this._UseOverrideSet=k},setPlayerMode:function(){this._playerMode=true},getPlayerMode:function(){return this._playerMode},setOpenSMG:function(){this._openSMG=true},getOpenSMG:function(){return this._openSMG},setCityMode:function(){this._cityMode=true},getCityMode:function(){return this._cityMode},setDisplayUIMode:function(k){this._displayUI=k},getDisplayUIMode:function(){return this._displayUI},setProdHighMode:function(){this._prodHighMode=true},getProdHighMode:function(){return this._prodHighMode},setDisplayUIAssemblyPanelMode:function(k){this._displayUIAssemblyPanelMode=k},getDisplayUIAssemblyPanelMode:function(){return this._displayUIAssemblyPanelMode},setDisplayUIDressupsPanelMode:function(k){this._displayUIDressupsPanelMode=k},getDisplayUIDressupsPanelMode:function(){return this._displayUIDressupsPanelMode},setDisplayUIScenariosPanelMode:function(k){this._displayUIScenariosPanelMode=k},getDisplayUIScenariosPanelMode:function(){return this._displayUIScenariosPanelMode},setDisplayUIPropertiesPanelMode:function(k){this._displayUIPropertiesPanelMode=k},getDisplayUIPropertiesPanelMode:function(){return this._displayUIPropertiesPanelMode},setDisplayPaper:function(k){this._displayPaper=k},getDisplayPaper:function(){return this._displayPaper},setTrapSelectionRequirements:function(k){if(!k){return}if(typeof k.pick==="boolean"){this._trapSelectionPick=k.pick}if(typeof k.prePick==="boolean"){this._trapSelectionPrePick=k.prePick}},getTrapSelectionRequirements:function(){return{pick:this._trapSelectionPick,prePick:this._trapSelectionPrePick}},setExperienceIn3DPlay:function(){this._ExperienceIn3DPlay=true},getExperienceIn3DPlay:function(){return this._ExperienceIn3DPlay},InitEventListeners:function(){i=this;this.event_VCX_PROPERTIES_CHANGED=a.subscribe({event:"VCX_PROPERTIES_CHANGED"},function(k){i.renderAll()});this.event_VCX_MODIFIABLE_CHANGED=a.subscribe({event:"VCX_MODIFIABLE_CHANGED"},function(){i.renderAll({updateInfinitePlane:true})});this.event_VCX_BEGIN_TRANSITION=a.subscribe({event:"VCX_BEGIN_TRANSITION"},function(){i.applyToViewers(function(k){k.setGroundShadowAutomaticUpdate(false)})});this.event_VCX_END_TRANSITION=a.subscribe({event:"VCX_END_TRANSITION"},function(){i.applyToViewers(function(k){k.setGroundShadowAutomaticUpdate(true)});i.renderAll({updateInfinitePlane:true})})},setShowRoomMode:function(){this._showRoomMode=true},getShowRoomMode:function(){return this._showRoomMode},setPickerCanonicsDetection:function(){this._pickerHasCanonicsDetection=true},getPickerCanonicsDetection:function(){return this._pickerHasCanonicsDetection},UnInitEventListeners:function(){i=null;a.unsubscribe(this.event_VCX_PROPERTIES_CHANGED);delete this.event_VCX_PROPERTIES_CHANGED;a.unsubscribe(this.event_VCX_MODIFIABLE_CHANGED);delete this.event_VCX_MODIFIABLE_CHANGED;a.unsubscribe(this.event_VCX_BEGIN_TRANSITION);delete this.event_VCX_BEGIN_TRANSITION;a.unsubscribe(this.event_VCX_END_TRANSITION);delete this.event_VCX_END_TRANSITION},setFrameWindow:function(k){if(this.frameWindow===undefined){this.frameWindow=k}else{}this.addViewer("MainViewer",this.getMainViewer())},getFrameWindow:function(){return this.frameWindow},getContext:function(){return this.getFrameWindow().options.context},getUIFrame:function(){return this.getFrameWindow().getUIFrame()},getViewers:function(){return this.viewers},addViewer:function(l,k){k.viewerID=l;this.viewers.push(k)},removeViewer:function(l){for(var k=0;k<this.viewers.length;k++){if(this.viewers[k].viewerID===l){this.viewers[k]=null;this.viewers.splice(k,1);return}}},applyToViewers:function(l){if(l){for(var k=0;k<this.viewers.length;k++){l(this.viewers[k])}}},getMainViewer:function(){if(this.frameWindow){return this.frameWindow.getViewer()}return null},setActiveCamera:function(k){this._activeCamera=k},getActiveCamera:function(){if(this._activeCamera){return this._activeCamera}var l=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentCamera");if(l&&l.length>0){this._activeCamera=l[0];return l[0]}var k=this._experienceBase.ComponentsMap.GetComponentFromType("VCXWebComponentCamera");if(k&&k.length>0){this._activeCamera=k[0];return k[0]}},setActiveViewport:function(k){this._activeViewport=k},getActiveViewport:function(){if(this._activeViewport){return this._activeViewport}var k=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentViewport");if(k&&k.length>0){this._activeViewport=k[0];return this._activeViewport}return null},setActiveGround:function(k){this._activeGround=k},getActiveGround:function(){if(!this._activeGround){var k=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGround");if(k&&k.length===1){this._activeGround=k[0]}}return this._activeGround},setActiveBOM:function(k){this._activeBOM=k},getActiveBOM:function(){if(!this._activeBOM){var k=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentBOM");if(k&&k.length===1){this._activeBOM=k[0]}}return this._activeBOM},getActionBar:function(){return this.frameWindow.getActionBar()},setRootNode:function(l){this._nRootNode=l;if(this.getRootComponent()){var k=this.getRootComponent().QueryInterface("W3AISGNodeHolder");if(k){this._pRootPathElement=new c([this._nRootNode]);k.setPathElement(this._pRootPathElement)}}},getRootComponent:function(){if(!this._cRootComponent){var k="VCX_Root";var m=this.getRootComponentType();this._cRootComponent=this._experienceBase.Factory.BuildComponent(m);if(this._cRootComponent){this._cRootComponent.SetPersistency(0);this._cRootComponent.SetID(k);var l;l=this._cRootComponent.QueryInterface("VCXIModelNavigable");l.setWorkingRoot(l);if(!this._currentWorkingRoot){this._currentWorkingRoot=l.GetObject()}this._experienceBase.ComponentsMap.AddComponent(this._cRootComponent);this.getRootNode()}}return this._cRootComponent},getRootComponentName:function(){var k=null;var r=this.getRootComponent();if(!r){return k}var m=r.QueryInterface("VCXIModelNavigable").getChildren();for(var q=0;q<m.length;++q){var n=r.QueryInterface("VCXIModelNavigable").getChildren()[q];if(!n){continue}var o=n.QueryInterface("VCXIModifiable");if(!o){continue}var p=o.GetProperty("Actor.AssetID");if(!p){continue}var l=p.GetPropertyValue().Value;if(l&&(l.lastIndexOf(".")>0)){var s=l.lastIndexOf(".");k=l.substr(0,s);break}}return k},getRootComponentType:function(){return this._rootInfos.componentType},getRootNode:function(){if(!this._nRootNode){var k=new h();k.productType=this._rootInfos.productType;k.name=this._rootInfos.name;k.VCX_ROOT_ID=this._rootInfos.id;this.getMainViewer().addNode(k);this.setRootNode(k)}return this._nRootNode},getRootPathElement:function(){if(!this._pRootPathElement){this.getRootNode()}return this._pRootPathElement},_extractModuleFromUrl:function(k){var l=k.split("/");return l[0]},_loadCssRessource:function(l,k){var n=document.getElementsByTagName("head")[0];var o=n.getElementsByTagName("link");var p=null;for(var m=0;m<o.length;m++){p=o[m];if(p.href.search(l)>-1){p.disabled=false;return}}p=document.createElement("link");p.type="text/css";p.rel="stylesheet";if(k===undefined){p.href=l}else{p.href=b.getWebappsBaseUrl()+l}n.appendChild(p)},loadCssFile:function(l,k){var m=this._extractModuleFromUrl(l);this._loadCssRessource(l,k);var n=m+"/"+m+".css";if(n!==l){this._loadCssRessource(n,k)}},unloadCssFile:function(k){var l=this._extractModuleFromUrl(k);this._unloadCssRessource(k);var m=l+"/"+l+".css";if(m!==k){this._unloadCssRessource(m)}},_unloadCssRessource:function(k){var m=document.getElementsByTagName("head")[0];var n=m.getElementsByTagName("link");for(var l=0;l<n.length;l++){var o=n[l];if(o.href.search(k)>-1){o.disabled=true;return}}},isTouchCompliantDevice:function(){var l=navigator.userAgent.toLowerCase();var k=("ontouchstart" in document.documentElement)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0)||(l.match(/(iphone|ipod|ipad)/)||l.match(/(android)/)||l.match(/(iemobile)/)||l.match(/iphone/i)||l.match(/ipad/i)||l.match(/ipod/i)||l.match(/blackberry/i)||l.match(/bada/i));if(k){return true}else{return false}},renderAll:function(k){this.applyToViewers(function(l){l.render(k)})},setAllViewerSensitive:function(k){this.applyToViewers(function(l){l.setManipulators({activated:k,preActivate:k});l.currentViewpoint.setControlActive({viewpoint:k,picking:k})})},takeReleaseControlActive:function(k){if(!k){k=this.getMainViewer()}this.setAllViewerSensitive(false);k.setManipulators({activated:true,preActivate:true});k.currentViewpoint.setControlActive({viewpoint:true,picking:true})},getSharedSceneGraphOverrideSet:function(){if(this._UseOverrideSet){if(!this._SharedSceneGraphOverrideSet){var k=this.getRootNode();var l=this.getMainViewer();if(k&&l){this._SharedSceneGraphOverrideSet=new f(k);var m=l.getSceneGraphOverrideSetManager();m.pushSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet)}}}return this._SharedSceneGraphOverrideSet},getSharedSceneGraphOverride:function(m){if(m){var k=this.getSharedSceneGraphOverrideSet();if(k){var l=k.getUniqueOverrideFromPathElement(m);if(!l){l=k.createOverride(m)}}}return l},addNotification:function(k){k.category=k.message;j.addNotif(k)},removeNotification:function(k,l){e.removeNotifications(l,k)},clearAllNotifications:function(){e.removeNotifications()},update:function(l){this._parent(l);if(this.traverseGraphMustBePerformed&&this.useTraverseGraph){var k=this.getRootComponent();if(k&&k.ChangeVisuProperties){k.ChangeVisuProperties(null,null,null,0);this.traverseGraphMustBePerformed=false}if(!this.odtPerfo){this.renderAll()}}if(this.odtPerfo){this.renderAll()}},postUpdate:function(k){this._parent(k);this.partHasMoved=false},zoomFitAll:function(){this.applyToViewers(function(k){k.currentViewpoint.reframe(null,0)})},setRootOptions:function(m){var k={componentType:true,productType:true,name:true,id:true,};for(var l in m){if(m.hasOwnProperty(l)&&k[l]){this._rootInfos[l]=m[l]}}},CheckInputFile:function(n){var k={supported:true};var m=this._experienceBase.getManager("VCXCAT3DXModelManager");if(m){var l=m.GetApplicationMode();if(!n&&l!==0){k.supported=false;k.message="Feature not supported: open file from disk."}else{if(n&&l===0){k.supported=false;k.message="Feature not supported: open file from collabspace (file mode)."}}}else{if(n){k.supported=false;k.message="Feature not supported: open file from collabspace (file mode)."}}return k},CheckInputExtension:function(n){var m={supported:true};var p=this.getCityMode();if(n==="ctps"||(n==="urb")||(n==="ctxp")){if(!p){m.supported=false;m.message="Extension not supported."}}var l=this.getProdHighMode();var k=this.getPlayerMode();var o=this.getExperienceIn3DPlay();if(n==="smgxml"||n==="smg"||n==="smgs"||n==="smggeom"||n==="3dxml"||n==="json"||n==="exprd"){if(l||k||o){}else{m.supported=false;m.message="Extension not supported in CityIllustration."}}if(n==="tga"){m.supported=false;m.message="Feature not supported: creation of 2D panel with TGA image"}return m},setCat3DXIntegration:function(){this._cat3DXIntegration=true},getCat3DXIntegration:function(){return this._cat3DXIntegration},setSupportOpenAmbience:function(){this._openAmbience=true},getSupportOpenAmbience:function(){return this._openAmbience},setSupportOpenProduct:function(){this._openProduct=true},getSupportOpenProduct:function(){return this._openProduct},setFileMode:function(){this._fileMode=true},getFileMode:function(){return this._fileMode},});Object.defineProperty(d.prototype,"componentType",{enumerable:true,get:function(){return"VCXContextManager"}});return d});define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience",["DS/VCXWebModifiablesImpl/VCXModifiableOccurrence","DS/VCXWebModifiablesServices/VCXModifiablesAccess","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueEnum"],function(f,i,g,e,c,h,b,a){var d=f.extend({init:function(){this._parent();this._requestedHyperlinkID=-1},OnChangeProperty:function(n,l,q){if(!q){q={}}if(q.fromChildClass){}else{if(this.OnChangePropertyBegin(iPropertyName,iPropertyValue)){return true}}switch(n){case"Actor.Hyperlink":var o=l.GetValue();if(typeof o!=="undefined"){this._requestedHyperlinkID=o}return true;case"Actor.ToolTip":var m=this.GetObject();var k=l.GetValue();if(m.tooltip!==k){m.tooltip=k}return true;case"Actor.Freeze":var m=this.GetObject();var j=l.GetValue();if(typeof j!=="undefined"){m.eFreeze=j}return true;default:var m=this.GetObject();var r=false;var p=m.QueryInterface("VCXIPulseBehavior");if(p){r=p.OnChangeProperty(n,l,q)}if(r){return true}else{q.fromChildClass=true;return this._parent(n,l,q)}}return false},OnChangePropertiesEnd:function(){var k=this.GetObject();if(k.hyperlinkID!==this._requestedHyperlinkID){k.hyperlinkID=this._requestedHyperlinkID;var j=this.GetObject()._experienceBase.getManager("VCXHyperlinkManager");if(j){if(k.hyperlinkID>=0){j.RegisterInteractableObject(this.GetObject())}else{j.UnRegisterInteractableObject(this.GetObject())}}}return this._parent()},GetProperty:function(n){var r="._ComputedText";var p=null;if(n==="Actor.Hyperlink"){var m=this.GetObject();var k=new b();k.SetValue(m.hyperlinkID);var q=new e(n,0,true,"VCXWebModifiables/VCXWebModifiables");q.SetGroupId("Group.Actions");p=new g(q,k)}else{if(n==="Actor.ToolTip"){var m=this.GetObject();var l=new h();l.SetValue(m.tooltip);p=new g(new e(n,0,true,"VCXWebComposer/VCXWebComposer"),l)}else{if(n.endsWith(r)){var s=n.substring(0,n.length-r.length);var v=this.GetProperty(s);var w="";if(v){var o=v.GetPropertyValue().ToString();if(o){w=i.ValuateLinkedProperties(o,this.GetObject()._experienceBase,this.GetObject().GetID(),this.GetObject().GetID(),null)}}var l=new h(w);var q=new e(s,1,false);p=new g(q,l)}else{if(n==="Actor.Freeze"){var m=this.GetObject();var t=new a();t.SetValue(m.eFreeze);var j=new c(n,1,false,"VCXWebModifiables/VCXWebModifiables");j.AddOrModifyChoice(0,"Freeze.NoFreeze");j.AddOrModifyChoice(1,"Freeze.Freeze");j.AddOrModifyChoice(2,"Freeze.FreezeInPlay");p=new g(j,t)}else{var u=this.GetObject().QueryInterface("VCXIPulseBehavior");if(u){p=u.GetProperty(n)}}}}}if(!p){p=this._parent(n)}return p},GetProperties:function(k){var j=this._parent();j.AddOrModifyProperty(this.GetProperty("Actor.ToolTip"));j.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink"));var l=this.GetObject().QueryInterface("VCXIPulseBehavior");if(l){l.GetProperties(j)}return j}});return d});define("DS/VCXWebExperienceBase/VCXInteractableObjectsManager",["DS/WebApplicationBase/W3AAManager","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebModifiables/VCXModelChangeListener","DS/VCXWebVisibility/VCXIVisibility"],function(e,c,b,a){var d=e.extend({initialize:function(){this._registredInteractableObjects=[];this._bActiveInteraction=false;this._dirty=false;this._sorted=false},GetActiveInteraction:function(){var l=this._experienceBase.getManager("VCXModelChangeListener");if(l){if(this._dirty){this._dirty=false;this._sorted=false;this._bActiveInteraction=false;for(var j=0;j<this._registredInteractableObjects.length;j++){var h=this._experienceBase.ComponentsMap.GetComponentFromID(this._registredInteractableObjects[j]);if(h){var f=h.QueryInterface("VCXIVisibility");if(f){if(f.GetVisibility()!==a.EVisState.Hidden){var g=h.QueryInterface("VCXIModifiable");var k=g.GetProperty("Actor.Opacity");if(k&&k.GetPropertyValue()&&k.GetPropertyValue().Value){this._bActiveInteraction=true;break}}}}}}}return this._bActiveInteraction},update:function(f){var g=this._experienceBase.getManager("VCXModelChangeListener");if(g){if(g.hasChanged(b.FChangeFlag.Visibility)){this._sorted=false;this._dirty=true}}},RegisterInteractableObject:function(f){this._registredInteractableObjects.push(f.GetID());this._sorted=false;this._dirty=true},UnRegisterInteractableObject:function(g){var f=this._registredInteractableObjects.indexOf(g.GetID());if(f>-1){this._registredInteractableObjects.splice(f,1);this._dirty=true}},GetSortedInteractableObjects:function(){if(!this._sorted){this._registredInteractableObjects=c.sortListDisplayPriority(this._experienceBase,this._registredInteractableObjects);this._sorted=true}return this._registredInteractableObjects}});Object.defineProperty(d.prototype,"componentType",{enumerable:true,get:function(){return"VCXInteractableObjectsManager"}});return d});define("DS/VCXWebExperienceBase/VCXHyperlinkManagerBase",["DS/VCXWebExperienceBase/VCXInteractableObjectsManager","DS/VisuEvents/EventsManager","DS/VCXWebModifiablesServices/VCXModifiablesAccess"],function(d,c,b){var a=d.extend({init:function(){this._strEventToListen=""},initialize:function(){this._parent()},postInitialize:function(){var f=this;this.onVisuEvent=function e(i){if(f.GetActiveInteraction()){var g=b.GetModifiableFromEvent(i,f._experienceBase);if(g){var h=g.GetObject().GetID();f._experienceBase.getManager("VCXAPIManager").ActivateHyperlink(h)}}};if(this._strEventToListen){c.addEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().canvas,this._strEventToListen,this.onVisuEvent)}},unInitialize:function(){this._parent();c.removeEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().canvas,this._strEventToListen,this.onVisuEvent);this._strEventToListen=""},OpenHyperlink:function(e){},_getHyperlinkInfos:function(e){var g=null;if(e){g=this._getPropertyPathFromModifiable(e)}var f={};if(g){f=this._getHyperlinkInfosFromProperty(g)}return f},_getPropertyPathFromModifiable:function(h){if(h){}else{return}var k=null;var f=-1;var g=h.GetProperty("Actor.Hyperlink");var j=false;if(g){var e=g.GetPropertyValue();f=parseInt(e.GetValue(),10);if(f>=0){j=true}}if(j){var i=this._experienceBase.getManager("VCXDocManager");if(i){k=i.GetPropPath(f)}}return k},_getHyperlinkInfosFromProperty:function(h){var g={};var i=-1;if(h){var f=h.GetPathType();i=f.GetValue()}if(i===0){var k=h.GetValueURL().GetValue();var j=k;if(k.indexOf("blob:")<0&&k.indexOf("ftp:")<0){j=k.toLowerCase()}var e=h.GetFileName().GetValue();g={url:j,filename:e}}return g},BuildPropertyForHyperlink:function(f,h){var k=-1;var i="";if(h.indexOf("blob:")<0){k=0}else{i=h.toLowerCase()}if(i.indexOf("http")>=0){k=0}var g=false;if(k===0){g=true;var e=this._experienceBase.getManager("VCXDocManager").BuildPathFromString(h,"");var j=this._experienceBase.getManager("VCXDocManager").AddOrModifyHyperlink(e);h=j.GetValue()}if(!g){h=f.GetProperty("Actor.Hyperlink").GetPropertyValue().GetValue()}return h},});Object.defineProperty(a.prototype,"componentType",{enumerable:true,get:function(){return"VCXHyperlinkManagerBase"}});return a});define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueFloat"],function(e,h,d,f,b,c,a){var g=e.extend({OnChangeProperty:function(j,i,k){if(!k){k={}}if(k.fromChildClass){}else{if(this.OnChangePropertyBegin(iPropertyName,iPropertyValue)){return true}}switch(j){case"Actor.LayerOpacity":var l=this.GetObject();l.layerOpacity=i.GetValue();break;case"Actor.Rendering":var l=this.GetObject();l.renderingMode=i.GetValue();break;case"Actor.Priority":var l=this.GetObject();l.priority=i.GetValue();break;default:k.fromChildClass=true;return this._parent(j,i,k)}return true},OnChangePropertiesEnd:function(){var j=this.GetObject();if(j.getDirtyFlag(h.FDirty.Priority)){var i=j._experienceBase.getManager("VCXVisuManager");if(i){i.dirtifyRenderPriority()}}return this._parent()},GetProperty:function(k){var n=null;if(k==="Actor.LayerOpacity"){var i=this.GetObject().layerOpacity;var j=new a();j.SetValue(i);var o=new f(k,0,true,"VCXWebModifiables/VCXWebModifiables");o.SetBounds(0,1,0.1);o.SetGroupId("Group.CustomRendering");n=new d(o,j)}else{if(k==="Actor.Rendering"){var q=this.GetObject().renderingMode;var l=new c();l.SetValue(q);var o=new b(k,0,true,"VCXWebModifiables/VCXWebModifiables");o.AddOrModifyChoice(h.ERenderingMode.Smooth,"Actor.Rendering.Smooth");o.AddOrModifyChoice(h.ERenderingMode.SmoothOutline,"Actor.Rendering.SmoothOutline");o.AddOrModifyChoice(h.ERenderingMode.Technical,"Actor.Rendering.Technical");o.AddOrModifyChoice(h.ERenderingMode.FlatTechnical,"Actor.Rendering.FlatTechnical");o.AddOrModifyChoice(h.ERenderingMode.Silhouette,"Actor.Rendering.Silhouette");o.SetGroupId("Group.CustomRendering");n=new d(o,l)}else{if(k==="Actor.Priority"){var p=this.GetObject().priority;var m=new c();m.SetValue(p);var o=new b(k,0,true,"VCXWebModifiables/VCXWebModifiables");o.AddOrModifyChoice(0,"Actor.Priority.VeryLow");o.AddOrModifyChoice(1,"Actor.Priority.Low");o.AddOrModifyChoice(2,"Actor.Priority.Normal");o.AddOrModifyChoice(3,"Actor.Priority.High");o.AddOrModifyChoice(4,"Actor.Priority.VeryHigh");o.SetGroupId("Group.CustomRendering");n=new d(o,m)}else{n=this._parent(k)}}}return n},GetProperties:function(j){var i=this._parent();i.AddOrModifyProperty(this.GetProperty("Actor.LayerOpacity"));i.AddOrModifyProperty(this.GetProperty("Actor.Rendering"));i.AddOrModifyProperty(this.GetProperty("Actor.Priority"));return i}});return g});define("DS/VCXWebExperienceBase/VCXOverridesChangeServices",["DS/Visualization/ThreeJS_DS","DS/VCXWebExperienceBase/VCXPathElementTools","DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices"],function(b,a,c){return{Ghost:function(d,f,h,l,k){var m=true;var g=a.getMesh3dPathElements(f,["Instance3D"]);if(!g){return false}if(h===undefined){h=true}if(h&&l===undefined){l=0.1}if(k===undefined){k=2}for(var j=0;j<g.length;++j){var e=c.getSceneGraphOverride(d,g[j]);if(e){if(h){e.setOpacity(l,true)}if(k===1){e.setPickability("PICKABLE",true)}else{if(k===2){e.setPickability("IGNORED",true)}}}}return m},UnGhost:function(h,g){var d=a.getMesh3dPathElements(g,["Instance3D"]);if(!d){return false}for(var f=0;f<d.length;++f){var e=c.getSceneGraphOverride(h,d[f]);if(e){h.deleteOverride(e)}}},}});define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExt",["DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(a,c){var b=a.extend({init:function(){this._parent();this._renderingMode=0;this._layerOpacity=0.5;this._priority=2;this._localMaterial=null;this._globalMaterial=null}});Object.defineProperty(a.prototype,"layerOpacity",{enumerable:true,get:function(){return this._layerOpacity},set:function(d){if(this._layerOpacity!==d){this._layerOpacity=d;this._dirtyMask|=c.FDirty.LayerOpacity}}});Object.defineProperty(a.prototype,"renderingMode",{enumerable:true,get:function(){return this._renderingMode},set:function(d){if(this._renderingMode!==d){this._renderingMode=d;this._dirtyMask|=(c.FDirty.RenderingMode|c.FDirty.Priority)}}});Object.defineProperty(a.prototype,"priority",{enumerable:true,get:function(){return this._priority},set:function(d){if(this._priority!==d){this._priority=d;this._dirtyMask|=c.FDirty.Priority}}});Object.defineProperty(a.prototype,"localMaterial",{enumerable:true,get:function(){return this._localMaterial},set:function(d){this._localMaterial=d;this._dirtyMask|=(c.FDirty.Material|c.FDirty.Color|c.FDirty.Alpha)}});Object.defineProperty(a.prototype,"globalMaterial",{enumerable:true,get:function(){return this._globalMaterial}});c.addDirtyFlags(["LayerOpacity","RenderingMode","Priority","Material"]);Object.defineProperty(b.prototype,"componentType",{enumerable:true,get:function(){return"VCXComponentOccurrenceExt"}});return b});