define("DS/WebToWinInfra/WebToWinCom",["UWA/Core","UWA/Utils/InterCom","UWA/Json",],function(c,b,a){var d;d={_WebToWinCom_server:null,_created_socket:[],createSocket:function(f){if(!UWA.is(this._WebToWinCom_server)){this._init(f)}if(UWA.is(f.socket_id)){if(this._created_socket.indexOf(f.socket_id)!==-1){throw new Error("WebToWinCom: socket with id "+f.socket_id+" already created")}else{var e=new b.Socket(f.socket_id,{dispacthRetryInterval:0});e.subscribeServer("WebToWinComServer");this._created_socket.push(f.socket_id);return e}}else{throw new Error("WebToWinCom: socket_id not found")}},deleteSocket:function(f){var e=this._created_socket.indexOf(f);if(e!==-1){this._created_socket.splice(e,1)}},_init:function(e){var f=this;f._WebToWinCom_server=new b.Server("WebToWinComServer",{isPublic:false})},createJSONArrayModif:function(f,e){var g=[];var h=this;e.forEach(function(k){ObjId=k.physicalid;var j=k.attributes;g.push({action:f,objectId:{physicalid:ObjId,attributes:j}})});var i='{ "objects_name": '+a.encode(g)+"}";return i},createJSONArrayArg:function(g,e){var f={action:g,Args:[]};var h=this;e.forEach(function(i){ArgName=i.argname;ArgValue=i.argvalue;f.Args.push({Name:ArgName,Value:ArgValue})});return JSON.stringify(f)},createJSONArrayAction:function(g,e){var f={action:g,objectIds:[]};var h=this;e.forEach(function(i){ObjId=i.physicalid;f.objectIds.push(ObjId)});return JSON.stringify(f)},createJSONArrayMessage:function(f,g){var e={action:f,severity:g.severity,ID:g.ID,message:g.message};return JSON.stringify(e)},parseContextualMenu:function(g){if(g.actions.length>0){var i=g.actions;var h=this;var j=[];var e=0;var f=i.length;for(e=0;e<f;e++){j[e]=this._getActionsForOneObject(i[e],i[e].actions,"")}}return j},_getActionsForOneObject:function(g,k,i){var j=this;var e=[];var f=0;var h=k.length;for(f=0;f<h;f++){e[f]=this._getOneActionForOneObject(g,k[f],i);console.log(e)}return e},_getOneActionForOneObject:function(g,f,e){var k=this;var j;if(UWA.is(f.items)){j={text:f.title,fonticon:f.icon,};if((f.id!==undefined)&&(f.id!==null)){j.actionId=f.id}j.items=this._getActionsForOneObject(g,f.items,f.title)}else{var i=false,h=false,m=true;j={text:f.title,icon:f.image,multisel:f.multisel,sourcejs:f.sourcejs};var l=f.availabilityMode;if(m===true){j.availabilityMode=f.availabilityMode}if(f.id!==undefined){j.actionId=f.id;j.data=f.id}if(f.accelerator!==undefined){j.accelerator=m?f.accelerator:f.get("accelerator")}if(UWA.is(f.disabled)){j.disabled=m?f.disabled:f.get("disabled")}if(UWA.is(e)){j.menu=e}}return j},};return d});