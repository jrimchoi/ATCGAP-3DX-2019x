define("DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityUtility",["DS/CfgBaseUX/scripts/CfgUtility"],function(a){var b={getEffectivityJSON:function(k){var j=k.InstanceID;var f=k.InstanceLength;var c=k.Version;var e=k.TargetFormat;var d=k.View;var g=k.Domains;var i=k.withDescription;var h=new Promise(function(r,q){var p={version:c,output:{targetFormat:e,withDescription:i,view:d,domains:g},pidList:"["+j+"]"};if(c=="1.2"){p={version:c,pidList:j}}var n="/resources/modeler/configuration/navigationServices/getMultipleFilterableObjectInfo";var o=JSON.stringify(p);var l=function(s){r(s)};var m=60000;a.makeWSCall(n,"POST","enovia","application/json",o,l,q,true,null,m)});return h}};return b});define("DS/CfgWebAppEffectivityUX/facets/EffectivityFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask"],function(f,d,b,c,e){var a=d.extend({init:function(){this._parent.apply(this,arguments);if(!this.elements.container){this.elements.container=f.createElement("div",{styles:{height:"100%"}})}},updateFacet:function(){var g=this;e.mask(this.elements.container);require(["DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityView","DS/CfgBaseUX/scripts/CfgController"],function(k,i){if(g.elements&&g.elements.container){var j=g.getModel();var l="";var m=g.getOccurrence().getOptions("Effectivity");if(m){l=m.targets[0].id}else{l=j.get("objectId")}var h=j.getTenant();if(!j){return false}i.init(null,"","3DDashboard");g.elements.container.setContent("");k.displayEffectivity(g.elements.container,l,h)}})},destroyComponent:function(){if(f.is(this.destroy,"function")){this.destroy()}}});return a});define("DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityView",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Alert","UWA/Controls/Popup","css!DS/CfgWebAppEffectivityUX/CfgWebAppEffectivityUX","DS/CfgEvolutionUX/CfgFilterView","DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityUtility","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS","DS/CfgBaseUX/scripts/CfgUtility","DS/UIKIT/Mask"],function(f,a,i,d,l,e,h,g,k,j,c){var b={displayEffectivity:function(s,u,o){this.renderDiv=s;this.instanceId=u;this.ofcExpression="";this.projExpression="";var q=this;window.enoviaServerEffectivityWidget={instanceIDcheck:this.instanceId,ofcExpression:this.ofcExpression,projExpression:this.projExpression};var n=document.querySelector("#mainContainer");if(!n){this.MainContainer=new UWA.Element("div",{id:"mainContainer",styles:{width:"100%",height:"100%",overflow:"auto"}});this.viewPanel=new UWA.Element("div",{className:"filter-dialog-viewpanel",id:"viewPanel",styles:{"float":"right",display:"table-row"}});this.evolutionHeaderDiv=new UWA.Element("div",{id:"evolutionHeaderDiv",html:"<h5>"+k.CFG_Label_Evolution+"</h5>",styles:{display:"table-row"}});this.evolutionContainer=new UWA.Element("div",{id:"evolutionContainer",styles:{width:"100%","float":"left",display:"table-row","margin-bottom":"20px"}});this.variantHeaderDiv=new UWA.Element("div",{id:"variantHeaderDiv",html:"<h5>"+k.CFG_Label_Variant+"</h5>",styles:{}});this.variantContainer=new UWA.Element("div",{id:"variantContainer",styles:{width:"100%",display:"table-row","float":"left",overflow:"auto","margin-top":"10px"}});var r={};r.parentElement=this.viewPanel;var m=new h(r);this.MainContainer.appendChild(this.viewPanel);enoviaServerFilterWidget.tenant=o;var v={InstanceID:q.instanceId,InstanceLength:1,Version:"1.0",TargetFormat:"TXT",withDescription:"YES",View:"ALL",Domains:"ALL"};j.populate3DSpaceURL().then(function(w){j.populateSecurityContext().then(function(x){g.getEffectivityJSON(v).then(function(D){var z=document.querySelector("#variantContainer");var y=document.querySelector("#evolutionContainer");var H=document.querySelector("#variantHeaderDiv");var E=document.querySelector("#evolutionHeaderDiv");var A=document.querySelector("#prjView");var F=document.querySelector("#ofcView");var B=enoviaServerEffectivityWidget.instanceIDcheck;var C=D.expressions;var G="";var I="";if(C[B].status==="ERROR"){j.showwarning(k.CFG_Service_Fail,"error");return Promise.reject(D)}if(C[B].hasEffectivity==="YES"){if((C[B].content.Variant!=null)){H.style.visibility="visible";E.style.visibility="visible";z.style.visibility="visible";G=C[B].content.Variant}else{G=k.CFG_Blank_VariantExpr}if((C[B].content.Evolution!=null)){H.style.visibility="visible";E.style.visibility="visible";z.style.visibility="visible";if((C[B].content.Evolution.Current!=null)){I=C[B].content.Evolution.Current;enoviaServerEffectivityWidget.ofcExpression=C[B].content.Evolution.Current;y.innerText=enoviaServerEffectivityWidget.ofcExpression}else{y.innerText=k.CFG_Blank_EvolutionExpr;enoviaServerEffectivityWidget.ofcExpression=k.CFG_Blank_EvolutionExpr}if((C[B].content.Evolution.Projected!=null)){I=C[B].content.Evolution.Projected;enoviaServerEffectivityWidget.projExpression=C[B].content.Evolution.Projected}else{y.innerText=k.CFG_Blank_EvolutionExpr;enoviaServerEffectivityWidget.projExpression=k.CFG_Blank_EvolutionExpr}}else{y.innerText=k.CFG_Blank_EvolutionExpr}if((C[B].content.ConfigChange!=null)){if((C[B].content.ConfigChange.Current!=null)){I=C[B].content.ConfigChange.Current;enoviaServerEffectivityWidget.ofcExpression=C[B].content.ConfigChange.Current;y.innerText=enoviaServerEffectivityWidget.ofcExpression}else{y.innerText=k.CFG_Blank_EvolutionExpr;enoviaServerEffectivityWidget.ofcExpression=k.CFG_Blank_EvolutionExpr}if((C[B].content.ConfigChange.Projected!=null)){I=C[B].content.ConfigChange.Projected;enoviaServerEffectivityWidget.projExpression=C[B].content.ConfigChange.Projected}else{y.innerText=k.CFG_Blank_EvolutionExpr;enoviaServerEffectivityWidget.projExpression=k.CFG_Blank_EvolutionExpr}}z.innerText=G}if(C[B].hasEffectivity==="NO"){H.style.visibility="visible";E.style.visibility="visible";z.style.visibility="visible";y.innerText=k.CFG_Valid_EvolutionExpr;z.innerText=k.CFG_Valid_VariantExpr;enoviaServerEffectivityWidget.projExpression=k.CFG_Valid_EvolutionExpr;enoviaServerEffectivityWidget.ofcExpression=k.CFG_Valid_EvolutionExpr}c.unmask(q.renderDiv)},function(y){console.log(y);return Promise.reject(y)})},function(x){return Promise.reject(x)})},function(w){return Promise.reject(w)});this.MainContainer.appendChild(this.evolutionHeaderDiv);this.MainContainer.appendChild(this.evolutionContainer);this.MainContainer.appendChild(this.variantHeaderDiv);this.MainContainer.appendChild(this.variantContainer);this.renderDiv.appendChild(this.MainContainer);this.variantHeaderDiv.style.visibility="hidden";this.evolutionHeaderDiv.style.visibility="hidden";this.variantContainer.style.visibility="hidden";var p=document.querySelector("#prjView");if(p){p.addEventListener("click",function(){var w=document.querySelector("#evolutionContainer");w.innerText=enoviaServerEffectivityWidget.projExpression})}var t=document.querySelector("#ofcView");if(t){t.addEventListener("click",function(){var w=document.querySelector("#evolutionContainer");w.innerText=enoviaServerEffectivityWidget.ofcExpression})}}else{c.unmask(q.renderDiv)}}};return b});define("DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns",["UWA/Core","UWA/Class","DS/UIKIT/Spinner","DS/Utilities/Dom","DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityUtility","DS/EffectivityInlineEditor/EffectivityInlineEditor","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgUtility","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgData","DS/ApplicationFrame/CommandsManager","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Mask","DS/PADUtils/PADContext"],function(g,s,j,t,n,e,m,q,l,k,r,i,d,v,b,f,w,o){var c="E";var h=true;function p(z,A,x){if(!z.isHeader){if(z.cellModel.options.value){var y=z.cellView.reuseCellContent(A);if(y){y.innerText=z.cellModel.options.value}}else{z.cellView.reuseCellContent(x)}}}function u(){var x=function(y){if(h){if(y.isCHGRoleAvail==true){c="EE";a._columnDataIndex=["Effectivity","VariantEffectivity","CurrentEvolutionEffectivity","ProjectedEvolutionEffectivity"];a._columnDef={Effectivity:{dataIndex:"Effectivity",text:m.CFG_EFFECTIVITY_HEADER,width:100,minWidth:80,maxWidth:200,isHidden:true,onCellRequest:function(z){p(z,"effecivity_col_value","effecivity_col_colloader")},xnav_options:{layout:{width:100,minWidth:80,maxWidth:200,removable:true,hidden:true},exportable:{lock:true,value:false}}},VariantEffectivity:{dataIndex:"VariantEffectivity",text:m.CFG_VARIANT_HEADER,width:300,minWidth:200,maxWidth:500000,isHidden:true,onCellRequest:function(z){p(z,"variant_effecivity_col_value","variant_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:true,hidden:true},exportable:{lock:true,value:false}}},CurrentEvolutionEffectivity:{dataIndex:"CurrentEvolutionEffectivity",text:m.CFG_CURRENT_EVOLUTION_HEADER,width:300,minWidth:200,maxWidth:500000,isHidden:true,onCellRequest:function(z){p(z,"current_evolution_effecivity_col_value","current_evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:true,hidden:true},exportable:{lock:true,value:false}}},ProjectedEvolutionEffectivity:{dataIndex:"ProjectedEvolutionEffectivity",text:m.CFG_PROJECTED_EVOLUTION_HEADER,width:300,minWidth:200,maxWidth:500000,isHidden:true,onCellRequest:function(z){p(z,"projected_evolution_effecivity_col_value","projected_evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:true,hidden:true},exportable:{lock:true,value:false}}}}}else{if(y.isCFGRoleAvail==true||y.isCSVRoleAvail==true){c="VE";a._columnDataIndex=["Effectivity","VariantEffectivity","EvolutionEffectivity"];a._columnDef={Effectivity:{dataIndex:"Effectivity",text:m.CFG_EFFECTIVITY_HEADER,width:100,minWidth:80,maxWidth:200,isHidden:true,onCellRequest:function(z){onCellRequest:p(z,"effecivity_col_value","effecivity_col_colloader")},xnav_options:{layout:{width:100,minWidth:80,maxWidth:200,removable:true,hidden:true},exportable:{lock:true,value:false}}},VariantEffectivity:{dataIndex:"VariantEffectivity",text:m.CFG_VARIANT_HEADER,width:300,minWidth:200,maxWidth:500000,isHidden:true,onCellRequest:function(z){onCellRequest:p(z,"variant_effecivity_col_value","variant_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:true,hidden:true},exportable:{lock:true,value:false}}},EvolutionEffectivity:{dataIndex:"EvolutionEffectivity",text:m.CFG_EVOLUTION_HEADER,width:300,minWidth:200,maxWidth:500000,isHidden:true,onCellRequest:function(z){onCellRequest:p(z,"evolution_effecivity_col_value","evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:true,hidden:true},exportable:{lock:true,value:false}}}}}}}};l.rolesAvailable(x)}var a=s.singleton({_columnDataIndex:["Effectivity"],_columnDef:{Effectivity:{dataIndex:"Effectivity",text:m.CFG_EFFECTIVITY_HEADER,width:100,minWidth:80,maxWidth:200,isHidden:true,onCellRequest:function(x){p(x,"effecivity_col_value","effecivity_col_colloader")},xnav_options:{layout:{width:100,minWidth:80,maxWidth:200,removable:true,hidden:true},exportable:{lock:true,value:false}}}},init:function(x){this._parent(x);q.init(null,"","3DDashboard")},isAdditionalColumnsAvailable:function(x){if(g.is(x,"function")===false){throw new Error("A callback function should be defined")}u();setTimeout(function(){x(true)},500)},getName:function(){return"CfgEffectivityColumns"},getManagedColumnNames:function(){return this._columnDataIndex},toBeUpdated:function(x){var y=false;if(c==="EE"){if(x.Effectivity===undefined||x.Effectivity===""||x.VariantEffectivity===undefined||x.VariantEffectivity===""||x.CurrentEvolutionEffectivity===undefined||x.CurrentEvolutionEffectivity===""||x.ProjectedEvolutionEffectivity===undefined||x.ProjectedEvolutionEffectivity===""){y=true}}else{if(c==="VE"){if(x.Effectivity===undefined||x.Effectivity===""||x.VariantEffectivity===undefined||x.VariantEffectivity===""||x.EvolutionEffectivity===undefined||x.EvolutionEffectivity===""){y=true}}else{if(c==="E"){if(x.Effectivity===undefined||x.Effectivity===""){y=true}}}}return y},updateAttributes:function(y,x){if(g.is(y,"object")===false){throw new Error("The object ids to modify must be specify")}if(g.is(x,"function")===false){throw new Error("A callback function should be defined")}setTimeout(function(){var B={pids:{},relids:{}},z=0;var A=y.relids;if(c==="EE"){if(y.pids.length>0){for(z=0;z<y.pids.length;z++){B.pids[y.pids[z]]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "}}localStorage.setItem("rootDetails",y.pids);if(A.length==0){x(B)}}}else{if(c==="VE"){if(y.pids.length>0){for(z=0;z<y.pids.length;z++){B.pids[y.pids[z]]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "}}localStorage.setItem("rootDetails",y.pids);if(A.length==0){x(B)}}}else{if(c==="E"){if(y.pids.length>0){for(z=0;z<y.pids.length;z++){B.pids[y.pids[z]]={Effectivity:" "}}localStorage.setItem("rootDetails",y.pids);if(A.length==0){x(B)}}}}}if(A.length>0){if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}l.populate3DSpaceURL().then(function(C){l.populateSecurityContext().then(function(F){var H="";var I=100;var D=0;var G=D+I;while(A.length>=D){H=A.slice(D,G);D+=I;G+=I;var E={InstanceID:H,InstanceLength:A.length,Version:"1.0",TargetFormat:"TXT",withDescription:"YES",View:"ALL",Domains:"ALL"};if(H.length>0){n.getEffectivityJSON(E).then(function(K){if(c==="EE"){var J=localStorage.getItem("rootDetails")?localStorage.getItem("rootDetails").split(","):[];for(z=0;z<J.length;z++){B.pids[J[z]]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "}}for(var M in K.expressions){if(K.expressions.hasOwnProperty(M)){if(K.expressions[M].hasEffectivity=="NO"){B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_NO,VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "}}else{if(K.expressions[M].hasEffectivity=="YES"){var N=" ";var P=" ";var O=" ";if(K.expressions[M].content!==null&&K.expressions[M].content.Variant!==null&&K.expressions[M].content.Variant!==undefined&&K.expressions[M].content.Variant!==""){N=K.expressions[M].content.Variant;N=N.replace(/[\r\n]+/g," ")}if(K.expressions[M].content!==null&&K.expressions[M].content.Evolution!==null&&K.expressions[M].content.Evolution!==undefined&&K.expressions[M].content.Evolution!==""){P=K.expressions[M].content.Evolution.Current;O=K.expressions[M].content.Evolution.Projected;if(P!==undefined&&P!==null&&P!==""){P=P.replace(/[\r\n]+/g," ")}else{P=" "}if(O!==undefined&&O!=null&&O!==""){O=O.replace(/[\r\n]+/g," ")}else{O=" "}}B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_YES,VariantEffectivity:N,CurrentEvolutionEffectivity:P,ProjectedEvolutionEffectivity:O}}else{if(K.expressions[M].hasEffectivity=="ERROR"||K.expressions[M].status!="SUCCESS"){B.relids[M]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "}}}}}}}else{if(c==="VE"){var J=localStorage.getItem("rootDetails")?localStorage.getItem("rootDetails").split(","):[];for(z=0;z<J.length;z++){B.pids[J[z]]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "}}for(var M in K.expressions){if(K.expressions.hasOwnProperty(M)){if(K.expressions[M].hasEffectivity=="NO"){B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_NO,VariantEffectivity:" ",EvolutionEffectivity:" "}}else{if(K.expressions[M].hasEffectivity=="YES"){var N=" ";var L=" ";if(K.expressions[M].content!==null&&K.expressions[M].content.Variant!==null&&K.expressions[M].content.Variant!==undefined&&K.expressions[M].content.Variant!==""){N=K.expressions[M].content.Variant;N=N.replace(/[\r\n]+/g," ")}if(K.expressions[M].content!==null&&K.expressions[M].content.Evolution!==null&&K.expressions[M].content.Evolution!==undefined&&K.expressions[M].content.Evolution!==""){L=K.expressions[M].content.Evolution.Current;if(L!==undefined&&L!==null&&L!==""){L=L.replace(/[\r\n]+/g," ")}else{L=" "}}B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_YES,VariantEffectivity:N,EvolutionEffectivity:L}}else{if(K.expressions[M].hasEffectivity=="ERROR"||K.expressions[M].status!="SUCCESS"){B.relids[M]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "}}}}}}}else{if(c==="E"){var J=localStorage.getItem("rootDetails").split(",");for(z=0;z<J.length;z++){B.pids[J[z]]={Effectivity:" "}}for(var M in K.expressions){if(K.expressions.hasOwnProperty(M)){if(K.expressions[M].hasEffectivity=="NO"){B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_NO}}else{if(K.expressions[M].hasEffectivity=="YES"){B.relids[M]={Effectivity:m.CFG_EFFECTIVITY_YES}}else{if(K.expressions[M].hasEffectivity=="ERROR"||K.expressions[M].status!="SUCCESS"){B.relids[M]={Effectivity:" "}}}}}}}}}x(B)},function(J){return Promise.reject(J)})}}},function(D){return Promise.reject(D)})},function(C){return Promise.reject(C)})}},200)},getAdditionalColumnsUX:function(A){var z=[];for(var y=0;y<A.length;y++){z.push(A[y].dataIndex)}for(var C=0;C<this._columnDataIndex.length;C++){var D=this._columnDataIndex[C];var B=g.clone(this._columnDef[D]);var x=z.indexOf(D);if(x===-1){A.push(B)}else{A[x]=g.extend(A[x],B,true)}}},provideDisplayTooltip:function(y){var x=null;switch(y.dataIndex){case"Effectivity":case"VariantEffectivity":case"CurrentEvolutionEffectivity":case"ProjectedEvolutionEffectivity":if(y.cellModel.options.value==" "){x=""}break;default:break}return x},registerReusableCellContent:function(x){if(c==="EE"){x.getManager().registerReusableCellContent({id:"effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"variant_effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"current_evolution_effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"projected_evolution_effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"effecivity_col_value",buildContent:function(){return t.createElement("span")}});x.getManager().registerReusableCellContent({id:"variant_effecivity_col_value",buildContent:function(){return t.createElement("span")}});x.getManager().registerReusableCellContent({id:"current_evolution_effecivity_col_value",buildContent:function(){return t.createElement("span")}});x.getManager().registerReusableCellContent({id:"projected_evolution_effecivity_col_value",buildContent:function(){return t.createElement("span")}})}else{if(c==="VE"){x.getManager().registerReusableCellContent({id:"effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"variant_effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"evolution_effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"effecivity_col_value",buildContent:function(){return t.createElement("span")}});x.getManager().registerReusableCellContent({id:"variant_effecivity_col_value",buildContent:function(){return t.createElement("span")}});x.getManager().registerReusableCellContent({id:"evolution_effecivity_col_value",buildContent:function(){return t.createElement("span")}})}else{if(c==="E"){x.getManager().registerReusableCellContent({id:"effecivity_col_colloader",buildContent:function(){return t.createElement("div",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}});x.getManager().registerReusableCellContent({id:"effecivity_col_value",buildContent:function(){return t.createElement("span")}})}}}},cancelVariantDialog:function(){a.cfgVarDialog.closeDialog()},setVariantEffectivity:function(){var y=null;var x=a.cfgVarEffectivityInlineEditor.getExpressions();if(x.effectivity=="ERROR"){l.showwarning(m.Syntax_Error,"error");return}else{if(x.effectivity.length==0){y=""}else{y=d.VariantJSONtoXMLConverter(x)}}var C=null;if(a.ite_options.auth.headers.length>0){C={operationheader:{key:a.ite_options.auth.headers[0].key,value:a.ite_options.auth.headers[0].value}}}var z=function(E){console.log(E);var D=new Array();D.push(a.ite_options.node);o.get().getPADTreeDocument().withTransactionUpdate(function(){l.refreshEffectvity(D,"Variant","All")});a.cfgVarDialog.closeDialog();if((E.expressions!==undefined&&E.expressions[a.ite_options.instanceID].status.toUpperCase()==="SUCCESS"&&E.expressions[a.ite_options.instanceID].hasEffectivity.toUpperCase()!=="ERROR")||(E.unset!==undefined&&(E.unset.Variant.status.toUpperCase()==="SUCCESS"||E.unset.Variant.status.toUpperCase()==="WARNING"))){l.showwarning(m.Service_OK,"success")}else{l.showwarning(m.Service_Fail,"error")}};var B=function(D){console.log(response);a.cfgVarDialog.closeDialog();l.showwarning(m.Service_Fail,"error")};if(y==""){var A={wsOptions:C,instanceID:a.ite_options.instanceID,domain:"Variant"};l.unsetEffectivity(A).then(function(D){z(D)},function(D){B(D)})}else{A={wsOptions:C,version:"1.1",domain:"Variant",view:"All",expressionList:[{pid:a.ite_options.instanceID,expressions:[{domain:"Variant",content:y}]}]};l.setMultipleFilterableObjectInfo(A).then(function(D){z(D)},function(D){B(D)})}},initVariantDialog:function(z){var y=z.options.relationid;var x=z.options.label;var B=z._parentNode.options.resourceid;if(y&&y!==""&&window.cfgCmdWidgetData&&window.cfgCmdWidgetData._isDecouplingActivated===true&&window.cfgCmdWidgetData._isConfigAvailable===true){a.ite_options={node:z,contextData:null,varEffJsonWithLabel:null,parentDiv:null,parentID:B,instanceID:y,mode:"ITEOnDashboard",iconModelURL:null,auth:{headers:[]},dialogue:{header:m.CFG_EDIT_VARIANT_HEADER+" - "+x,target:widget.body,buttonArray:null}};a.ite_options.dialogue.buttonArray=[{label:m.Edit_Var_OK,handler:a.setVariantEffectivity,className:"primary"},{label:m.Edit_Var_Cancel,handler:a.cancelVariantDialog,className:"default"}];v.clear();a.cfgVarDialog=new r(a.ite_options);a.ite_options.parentDiv=a.cfgVarDialog.container;a.cfgVarDialog.render();w.mask(a.cfgVarDialog.container);var A=function(){a.ite_options.contextData=null;var C={parentID:a.ite_options.parentID};var D=l.getConfiguredObjectInfo(C);D.then(function(F){if(F==null||F=="undefined"){a.ite_options.contextData=null}else{if(F.version=="1.0"){a.ite_options.contextData=F.Contexts.Content.results}else{if(F.version=="1.1"){a.ite_options.contextData=F.contexts.content.results}}}if(a.ite_options.contextData==null||a.ite_options.contextData==0){l.showwarning(m.No_Model_Error,"error");a.cancelVariantDialog();return}if(F.version=="1.1"&&F.enabledCriterias.feature=="false"){l.showwarning(m.No_Variant_Crit_Error,"error");a.cancelVariantDialog();return}console.log("Configured Objects/models loaded");a.ite_options.varEffJsonWithLabel=null;var G={version:"1.0",targetFormat:"XML",withDescription:"YES",view:"All",domains:"All",pidList:"["+a.ite_options.instanceID+"]"};var E=l.getMultipleFilterableObjectInfo(G);E.then(function(I){var H=l.isChangeControlled(a.ite_options.parentID);H.then(function(S){var M=null;var N="";var T=a.ite_options.instanceID;var O=I.expressions;if(O[T].status==="ERROR"||O[T].hasEffectivity==="ERROR"){console.log("getMultipleFilterableObjectInfo Service Failure");l.showwarning(m.Service_Fail,"error");a.cancelVariantDialog();return}if(O[T].hasEffectivity==="NO"){console.log("Has No Effectivity");M=false}else{if(O[T].content.ConfigChange!=null&&O[T].content.ConfigChange!="undefined"){console.log("Non Decoupled/Legacy Effectivity");l.showwarning(m.Legacy_Eff_Error,"error");a.cancelVariantDialog();return}else{if(O[T].content.Variant==null||O[T].content.Variant==""||O[T].content.Variant=="undefined"){console.log("Evolution Effectivity might be set hence Variant would be null or undefined");M=false}else{console.log("Decoupled Variant Effectivity");M=true;N=O[T].content.Variant}}if(S=="none"){a.ite_options.evoEffXML=O[T].content.Evolution.Current}else{a.ite_options.evoEffXML=O[T].content.Evolution.Projected}if(a.ite_options.evoEffXML&&a.ite_options.evoEffXML.indexOf("OperationHandler")>=0){a.ite_options.evoEffXML=""}a.ite_options.evoExpJson=d.EvolutionXMLtoJSONforFilterVariant(a.ite_options.evoEffXML)}var R=null;var Q=null;var K={effectivity:[]};if(M==true){R=d.VariantXMLToJSONConverter(N);Q=d.VariantDescXMLtoJSONConverter(N)}for(var V=0;V<a.ite_options.contextData.length;V++){var Z=a.ite_options.contextData[V];var Y=l.getAttributeValue(Z.basicData,"name");if(Array.isArray(Y)){Y=Y[0]}var L={name:Y,Combinations:[],evoExp:""};if(M==true){for(var W=0;W<R.length;W++){var X=JSON.parse(R[W]);if(X.name==Y){if(X.Combinations.length>0){X=l.fillVariantDictionaryWithDisplayName(X,Q);L=X}break}}}if(a.ite_options.evoEffXML){a.ite_options.evoExpJson.contextsFilterXML.forEach(function(ab){if(ab.name==Y){L.evoExp=ab.expression}})}K.effectivity.push(L)}a.ite_options.varEffJsonWithLabel=K;console.log("Effectivity Loaded for :"+T);var P=i.get();if(P&&P.AuthoringContextHeader){for(var aa in P.AuthoringContextHeader){a.ite_options.auth.headers.push({key:aa,value:P.AuthoringContextHeader[aa]})}}a.ite_options.iconModelURL=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png";a.cfgVarEffectivityInlineEditor=new e();a.cfgVarEffectivityInlineEditor.init(a.ite_options);w.unmask(a.cfgVarDialog.container);var U=document.getElementsByClassName("CfgITEOnDashboardDialog")[0];U.setAttribute("style",U.getAttribute("style")+"min-height:380px !important;min-width:240px !important;");var J=U.getElementsByClassName("modal-body")[0];J.setAttribute("style",J.getAttribute("style")+"overflow-y:auto !important;")},function(J){if(document.getElementsByClassName("CfgITEOnDashboardDialog")[0]){l.showwarning(m.Service_Fail,"error")}})},function(H){if(document.getElementsByClassName("CfgITEOnDashboardDialog")[0]){l.showwarning(m.Service_Fail,"error")}})},function(E){if(document.getElementsByClassName("CfgITEOnDashboardDialog")[0]){l.showwarning(m.Service_Fail,"error")}})};q.init();if(widget){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}l.populate3DSpaceURL().then(function(){l.populateSecurityContext().then(function(){A()})})}},getAdditionalCtxMenu:function(H){if(g.is(H.callback,"function")===false){throw new Error("A callback function should be defined")}if(H.ctxParams===undefined){throw new Error("No Ctx params given")}var z=null,x=false,B=H.ctxParams;if(B.graphview){z=B.graphview.node}else{if(B.treeview){z=B.treeview.nodeModel?B.treeview.nodeModel:B.treeview.cellModel;x=B.treeview.isHeader}else{z=B.cellInfos?B.cellInfos.nodeModel?B.cellInfos.nodeModel:B.cellInfos.cellModel:null}}var G=H.treeDocument.getSelectedNodes();if(z){if(!(B.treeview&&B.treeview.isHeader)){var F;var E;var C="enabled";var A="enabled";F=b.getCommand("CopyVariantEffectivity");if(F!=undefined){F._checkSelection();if(F._isEnabled==false){C="disabled"}}E=b.getCommand("PasteVariantEffectivity");if(E!=undefined){E._checkSelection();if(E._isEnabled==false){A="disabled"}}var y={type:"PushItem",icon:"url("+f.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Copy_Variant_Effectivity.png")+")",title:m.CFG_COPY_VARIANT_EFFECTIVITY,state:C,action:{context:{nodes:G},callback:function(I){F.execute()}}};var D={type:"PushItem",icon:"url("+f.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Paste_Variant_Effectivity.png")+")",title:m.CFG_PASTE_VARIANT_EFFECTIVITY,state:A,action:{context:{nodes:G},callback:function(I){E.execute()}}}}}setTimeout(function(){H.callback("copyVariantEffectivityCtx",y);H.callback("pasteVariantEffectivityCtx",D)},50)},getOnCellClickCB:function(y){var x;var z=this;switch(y){case"Effectivity":x=function(B){var A=this.getManager().getTreeNodeModelFromRowID(B.virtualRowID)};break;case"VariantEffectivity":x=function(B){var A=this.getManager().getTreeNodeModelFromRowID(B.virtualRowID);if(o.get&&o.get().getEditMode()===true){z.initVariantDialog(A)}};break;default:break}return x}});return a});