define("DS/ENOGantt/Infra",["UWA/Class","DS/Foundation2/FoundationV2Data","DS/E6WCommonUI/UIHelper","DS/ENOGantt/Ven/Ext","DS/ENOGantt/Ven/Bryntum","DS/ENOGantt/Nls/Eno/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Ext/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Sch/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Gnt/"+window.languageGlobalVar,],function(b,g,c,a,d,f){a.ns("App");App.Gantt={};App.csrf={name:"",value:"",};App.Gantt.filter={fields:{},filterBy:{},};App.Nls=f;var e={isReadOnly:function(h){var n=h["current.access[modify]"];var j=h.current;var k="TRUE"==h["type.kindof[Experiment]"];var l=h.routeId;if(n){if(c.isMobile()){return true}if(j=="Complete"||j=="Archive"||j=="Cancel"){return true}if(k&&l){return true}return false}return true},getColumnsInfo:function(n){var o={};var w=JSON.parse(n);var r={};var h=[];var p={};var k=[];o.customeColumnEditableData=p;o.customeColumnDataIndex=h;o.columns=k;o.columnsIndex=r;for(i=0,m=w.length;i<m;i++){var l=w[i];if(l.customColumn){h.push(l.dataIndex);var s=l.name;var y=l.editable;p[s]={isEditable:y,xtype:l.xtype}}var v=l.name;if(v==undefined){r[l.text]=i}r[v]=i;if(l.columnIndex&&l.columnIndex>0){k.splice(l.columnIndex,0,l)}else{k.push(l)}}var t=r.Name;var u=w[t];u.width=350;if(App.Infra.ViewId==App.Infra.Views.VIEW_WBS||App.Infra.ViewId==App.Infra.Views.VIEW_TEMPLATE_WBS){u.width=200;u.layout="vbox";u.items=[{xtype:"textfield",width:"100%",emptyText:App.Nls["emxProgramCentral.Common.Filter"],enableKeyEvents:true,reference:"filterByName",}]}var q=r.Status;var j=w[q];j.renderer=function(C,D,A){var z=A.get("Status");var B=App.Nls["emxProgramCentral.Gantt.TaskStatus."+z];if(B){return'<div title="'+B+'" class="status '+z+'">&nbsp;</div>'}};var x=r.Dependency;w[x].useSequenceNumber=true;delete w[x].editor;return o},};return b.extend({init:function(j){var k=this;var l=[];if(!enoviaServer.viewId){enoviaServer.viewId="WBSView"}var h="/resources/v1/modeler/projects/"+enoviaServer.physicalId+"?$indexBasedImages=false&$include=none&$fields=none,columns,estimatedStartDate,dueDate,modifyAccess,kindofBaseline,kindofExperiment,kindofTemplate,policy,title,PALId,sequenceOrder,state,policy,modifyAccess,estimatedFinishDate,actualStartDate,actulFinishDate,percentComplete,estimatedDurationInputValue,estimatedDurationInputUnit,actualDuration,constraintDate,defaulConstraintType,scheduleFrom,scheduleBasedOn,typeicon&viewId="+enoviaServer.viewId;g.ajaxRequest({url:h,dataType:"json",callback:function(n){k.setupInfra(n);j.loadWidget()}})},format:function(l){var k=new Array();for(idx=0;idx<l.length;idx++){var h=l[idx];var j=h.dataelements;if(h.children&&h.children.length>0){j.children=this.format(h.children)}k.push(j)}return k},setupInfra:function(h){var s=h.data;var v=s[0].dataelements;var k=s[0].relelements;var D=("TRUE"==v.kindofTemplate);var w=("TRUE"==v.kindofBaseline);var z=("TRUE"==v.kindofExperiment);var u=("TRUE"==v.modifyAccess);var x=c.isMobile();u=u&&(!x);var t=true;var r=true;var o=false;var l=true;var n=true;var q={VIEW_WBS:"WBSView",VIEW_ACTUAL:"ActualWBSView",VIEW_PLAN_VERSUS_ACTUAL:"PlannedVsActualView",VIEW_BASELINE_WBS:"ProjectBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE:"BaselineVsCurrentBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE2:"BaselineVsCurrentBaselineView2",VIEW_EXPERIMENT_VERSUS_PROJECT:"ExperimentVsProjectView",VIEW_TEMPLATE_WBS:"ProjectTemplateView",VIEW_STATUS_REPORT:"StatusReportViewer"};if(!enoviaServer.viewId){enoviaServer.viewId=q.VIEW_WBS}var C=enoviaServer.viewId;if(q.VIEW_WBS==C){t=!u;r=false;if(z){var B=v.routeId;if(B){t=true}r=true}}else{if(q.VIEW_TEMPLATE_WBS==C){t=!u}else{if(q.VIEW_PLAN_VERSUS_ACTUAL==C){r=false;o=true}else{if(q.VIEW_BASELINE_VERSUS_CURRENT_BASELINE==C){r=false;o=true}else{if(q.VIEW_BASELINE_VERSUS_CURRENT_BASELINE2==C){o=true}else{if(q.VIEW_EXPERIMENT_VERSUS_PROJECT==C){o=true}else{if(q.VIEW_STATUS_REPORT==C){o=true;l=false;n=false}}}}}}}App.Infra={ViewId:enoviaServer.viewId,ReadOnly:t,HideView:r,BaselineRequired:o,ToolbarRequired:l,NameFilterRequired:n,TypeOf:{ProjectTemplate:D,ProjectBaseline:w,Experiment:z,},Views:q,};var j=v.columns;delete v.columns;var A=e.getColumnsInfo(j);var p=A.columns;var y=A.columnsIndex;App.Infra.CustomeColumnDataIndex=A.customeColumnDataIndex;App.Infra.customeColumnEditableData=A.customeColumnEditableData;App.Infra.Columns=p,App.Infra.ColumnIndex=y,App.Infra.ExtTaskArray=new Array();App.Infra.expandStatus={};App.Infra.Load={};App.Infra.projectDataElements=v;App.Infra.RootProjectname=v.title;App.Infra.projectRelElements=k;App.Infra.isCustomizedEnvironment=false;a.Ajax.request({url:"../../programcentral/gantt/data/emxGanttService.jsp?mode=getCustomizationFlag",async:false,success:function(E){var F=JSON.parse(E.responseText.trim());if(F.isCustomizedEnvironment){App.Infra.isCustomizedEnvironment=F.isCustomizedEnvironment}}});return App}})});