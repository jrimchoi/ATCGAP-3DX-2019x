define("DS/ENOGantt/View/ResourceUtilizationContextMenu",["UWA/Class","DS/ENOGantt/Ven/Ext",],function(b,a){var c=b.extend({init:function(){a.define("DS.ENOGantt.View.ResourceUtilizationContextMenu",{extend:"Ext.menu.Menu",constructor:function(){var o=a.ComponentQuery.query("#dpmprojectgantt")[0];var h=a.ComponentQuery.query("#dpmresourceutilizationpanel")[0];var f=h.context;var l=f.getId();var n=f.getName();var m=h.getSelection()[0];var i=m.get("Id");var g=m.getName();var e=m.get("Type");var j=m.get("isReadOnly");var d=true;if(i.indexOf("assignment-")!=-1){d=false}_unassign=function(){if(d){var q=o.taskStore.resourceStore.getModelById(i.replace("resource-",""));var s=o.getAssignmentStore();var p=s.getAssignmentForTaskAndResource(f,q);var r=p.getTaskId();o.crudManager.transport.sync.params.contextTaskId=r;a.MessageBox.confirm(App.Nls["emxProgramCentral.Gantt.ResourceUtilization.RemoveResource.Alert.Header"],App.Nls["emxProgramCentral.Gantt.ResourceUtilization.RemoveResource.Alert.Body"],function(t){if(t==="yes"){o.assignmentStore.remove(p);o.crudManager.sync();o.taskStore.resourceStore.remove(q);o.crudManager.commit()}})}else{a.MessageBox.confirm(App.Nls["emxProgramCentral.Gantt.ResourceUtilization.RemoveAssignment.Alert.Header"],App.Nls["emxProgramCentral.Gantt.ResourceUtilization.RemoveAssignment.Alert.Body"],function(x){if(x==="yes"){var t=o.taskStore.assignmentStore.getModelById(i.replace("assignment-",""));var v=t.getResource();var w=t.getTaskId();o.crudManager.transport.sync.params={contextTaskId:w};if(w==l){var u=v.getId();var y=h.resourceStore.getModelById("resource-"+u);o.assignmentStore.remove(t);o.crudManager.sync();o.taskStore.resourceStore.remove(v);o.crudManager.commit()}else{o.assignmentStore.remove(t);o.crudManager.sync()}}})}};var k=enoviaServer.computeUrl("/common/images/");this.items=[{text:App.Nls["emxProgramCentral.Common.OpenInNewTab"],icon:k+"iconActionOpenShortcuts.png",iconCls:"tBarIcon",handler:function(){var q="";if(d){q=m.getId().replace("resource-","")}else{q=m.get("TaskId")}var p="../../common/emxNavigator.jsp?physicalId="+q;if(window.IFWE){p=enoviaServer.computeUrl("/common/")+"emxNavigator.jsp?physicalId="+q}window.open(p)}},{text:App.Nls["emxProgramCentral.Common.Remove"],icon:k+"iconActionDelete.png",iconCls:"tBarIcon",hidden:e=="External"||h.readOnly,handler:function(){var u=o.taskStore.assignmentStore;var r=u.getModifiedRecords();var q=r&&r.length>0;var p=o.taskStore;var t=p.getModifiedRecords();var s=t&&t.length>0;if(q||s){a.MessageBox.confirm(App.Nls["emxProgramCentral.Gantt.ResourceUtilization.RemoveAssignment.Alert.Header"],App.Nls["emxProgramCentral.Project.DiscardChanges"],function(w){if(w==="yes"){var v=h.getStore();v.rejectChanges();o.getCrudManager().reject();_unassign()}})}else{_unassign()}}}];this.callParent(arguments)},})},});return c});