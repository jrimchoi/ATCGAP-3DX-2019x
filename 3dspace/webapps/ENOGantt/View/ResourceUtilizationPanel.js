define("DS/ENOGantt/View/ResourceUtilizationPanel",["UWA/Class","DS/ENOGantt/Ven/Ext","DS/ENOGantt/Ven/Bryntum","DS/ENOGantt/Data/ResourceUtilizationStore","DS/ENOGantt/View/ResourceUtilizationContextMenu","DS/ENOGantt/View/FindResource"],function(b,a,c,g,e,d){var f=b.extend({init:function(){var i=new e();var j=this;var h=function(){var k=a.create("Sch.plugin.TreeCellEditing",{clicksToEdit:2,id:"resourceutilizationcellediting",listeners:{beforeEdit:function(q,o,n){var p=a.ComponentQuery.query("#dpmresourceutilizationpanel")[0];var l=o.record;var m=l.originalAssignment.data.Type;var r=l.data.isReadOnly;if("Internal"==m&&!r){p.setReadOnly(r);return true}else{return false}},edit:function(p,o,n){if(o.originalValue!=o.value){var l=o.record;var q=o.value;l.originalAssignment.set("Units",q);var r=a.ComponentQuery.query("#dpmprojectgantt")[0];var m=r.taskStore.assignmentStore.getModelById(l.originalAssignment.data.Id);m.set("Units",q)}},validateEdit:function(n,m,l){if(m.originalValue===m.value){return}}}});return k};a.define("DS.ENOGantt.View.ResourceUtilizationPanel",{extend:"Gnt.panel.ResourceUtilization",xtype:"dpmresourceutilizationpanel",split:true,numberFormat:"0.0",scrollable:false,region:"south",text:"Assignment Panel",contextId:"",calculateAsync:false,highlightWeekends:true,readOnly:App.Infra.ReadOnly,plugins:h(),resourceStoreClass:"DS.ENOGantt.data.ResourceUtilizationStore",zoomOnTimeAxisDoubleClick:false,lockedGridConfig:{emptyText:App.Nls["emxProgramCentral.Common.NoObjectsFound"],},closeToolText:App.Nls["emxProgramCentral.Common.Close"],headerPosition:"top",title:App.Nls["emxProgramCentral.Common.ManageResources"],tools:[{type:"close",tooltip:App.Nls["emxProgramCentral.Common.Close"],callback:function(k){k.setHidden(true)}}],listeners:{collapse:function(l,k){var m=a.ComponentQuery.query("#dpmprojectgantt")[0];if(App.Infra.ExtTaskArray.length>0){m.taskStore.remove(App.Infra.ExtTaskArray);App.Infra.ExtTaskArray=new Array();m.taskStore.commitChanges()}l.hide()},beforeitemcontextmenu:function(l,k,n,m,p){p.stopEvent();var o=a.create("DS.ENOGantt.View.ResourceUtilizationContextMenu");o.showAt(p.getXY())}},constructor:function(){this.viewConfig.markDirty=true;delete this.columns[0].flex;this.columns[0].resizable=true;this.columns[0].width=200;this.columns[0].text=App.Nls["emxProgramCentral.Gantt.ResourceUtilization.Header.Name"];this.columns[0].layout="vbox";this.columns[0].sortable=true;if(!this.readOnly){var k=new d();this.columns[0].items=[{xtype:"dpmfindresourceview"}]}this.columns.push({xtype:"numbercolumn",text:App.Nls["emxProgramCentral.Gantt.ResourceUtilization.Header.PercentAllocation"],align:"center",dataIndex:"Units",editable:true,editor:{xtype:"percentfield",minValue:10,maxValue:100,step:10,},},{xtype:"numbercolumn",text:App.Nls["emxProgramCentral.Gantt.ResourceUtilization.Header.Worktime"],align:"center",dataIndex:"WorkTime",});this.callParent(arguments)},})}});return f});