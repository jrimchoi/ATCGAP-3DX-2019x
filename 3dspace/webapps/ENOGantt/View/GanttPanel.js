define("DS/ENOGantt/View/GanttPanel",["DS/ENOGantt/GanttUtil","DS/ENOGantt/Data/CrudManager","DS/ENOGantt/View/Toolbar","DS/ENOGantt/View/FilterField","DS/ENO6WPlugins/jQuery","DS/ENOGantt/Ven/Ext","DS/ENOGantt/View/GanttRefinement","DS/ENOGantt/GanttConstants","DS/ENOGantt/Custom/DPMGanttAll"],function(d,g,f,b,l,c,i,k,h){var a=d.getDateFormat();var e=false;return function j(){e=(mode==null||mode==undefined||mode=="full");cpnl=this;var m=k.actionType;this.listeners={beforetaskdrag:function(o,n,q,p){return n.isStartDateEditable()&&n.isEndDateEditable()},beforetaskresize:function(o,n,q,p){return d.isValidTaskResize(n,q,p)},aftertaskresize:function(o,n,p){cpnl.cacheTaskChangeData("TaskResize",n)},taskdrop:function(o,n,p){cpnl.cacheTaskChangeData("TaskDragDrop",n)},dependencydrop:function(s,p,r,q){if(r){var o=p.getTo();var n=gantt.taskStore.getModelById(o);cpnl.cacheDependencyData(n)}},};this.getPredecessorGrid=function(){c.define("PredecessorGrid",{extend:"Gnt.widget.DependencyGrid",readOnly:false,height:220,scrollable:true,tbar:[],buildColumns:function(){var n=this.callParent(arguments);n[0].renderer=function(p,r,o){var q=c.ComponentQuery.query("dpmprojectgantt")[0];return o.getSourceTask(q.taskStore).get("TaskSequenceId")};n[0].getSortParam=function(){return"predTaskSeqNumber"};n[1].renderer=function(p,r,o){var q=c.ComponentQuery.query("dpmprojectgantt")[0];return o.getSourceTask(q.taskStore).get("Name")};n[1].getSortParam=function(){return"Predecessor"};n[2].sortable=false;n[1].editor=false;n[2].editor=false;n[3].editor=false;return n},});return c.create("PredecessorGrid")};this.getSuccessorGrid=function(){c.define("SuccessorGrid",{extend:"Gnt.widget.DependencyGrid",readOnly:false,direction:"successors",height:220,scrollable:true,tbar:[],buildColumns:function(){var n=this.callParent(arguments);n[0].renderer=function(p,r,o){var q=c.ComponentQuery.query("dpmprojectgantt")[0];return o.getTargetTask(q.taskStore).get("TaskSequenceId")};n[0].getSortParam=function(){return"taskSeqNumber"};n[1].renderer=function(p,r,o){var q=c.ComponentQuery.query("dpmprojectgantt")[0];return o.getTargetTask(q.taskStore).get("Name")};n[1].getSortParam=function(){return"Successor"};n[2].sortable=false;n[1].editor=false;n[2].editor=false;n[3].editor=false;return n}});return c.create("SuccessorGrid")};this.getTaskForm=function(){var o=App.Infra.TypeOf.ProjectTemplate;var n=c.define("MyTaskForm",{extend:"Gnt.widget.taskeditor.TaskForm",percentDoneConfig:{hidden:o,readOnly:true,forceReadOnly:true,editor:null},nameConfig:{readOnly:true,forceReadOnly:true,editor:null},durationConfig:{readOnly:true,forceReadOnly:true,editor:null},startConfig:{hidden:o,readOnly:true,forceReadOnly:true,format:a,editor:null},finishConfig:{hidden:o,readOnly:true,forceReadOnly:true,format:a,editor:null},scrollable:false,});return n};this.getTaskEditor=function(q){var o=cpnl.getPredecessorGrid();var n=cpnl.getSuccessorGrid();var p=c.create("Gnt.plugin.TaskEditor",{id:"taskEditor",height:350,taskFormClass:cpnl.getTaskForm(),showNotes:false,showAdvancedForm:false,showAssignmentGrid:false,showDependencyGrid:false,taskFormConfig:{effortConfig:{hidden:true},showBaseline:false},panelConfig:{items:[{title:App.Nls["emxProgramCentral.Gantt.TaskEditor.Predecessors"],items:o},{title:App.Nls["emxProgramCentral.Gantt.TaskEditor.Successors"],items:n}]},listeners:{loadtask:function(s,r){o.loadDependencies(r);o.store.sort("predTaskSeqNumber","ASC");n.loadDependencies(r);n.store.sort("taskSeqNumber","ASC")}},buttons:[{text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Ok"],handler:function(){this.config.$initParent.ownerCt.close()}},{text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Cancel"],handler:function(){this.config.$initParent.ownerCt.close()}},]});return p};this.getProjectEditor=function(o){var n=c.define("MyProjectForm",{extend:"Gnt.widget.taskeditor.ProjectForm",constructor:function(p){this.callParent(arguments);this.add({xtype:"displayfield",fieldLabel:"Schedule From",name:"ProjectScheduleFrom",})}});return c.create("Gnt.plugin.taskeditor.ProjectEditor",{height:250,buttons:[],projectFormClass:n,projectFormConfig:{allowDependenciesConfig:{hidden:true}},showDescription:false})};this.getDependencyEditor=function(p){var o=App.Infra.ReadOnly;var n=c.create("Gnt.plugin.DependencyEditor",{id:"dependencyEditor",showLag:true,constrain:true,buttons:[{id:"dependencyEditorOKBtn",text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Ok"],scope:this,hidden:o,handler:function(){var q=p.dependencyEditor;var t=q.dependencyRecord;q.getForm().updateRecord(t);var s=gantt.getDependencyStore();var r=s.getTargetTask(t);cpnl.cacheDependencyData(r);q.collapse()}},{id:"dependencyEditorCancelBtn",text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Cancel"],scope:this,handler:function(){p.dependencyEditor.collapse()}},{id:"dependencyEditorDeleteBtn",text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Delete"],scope:this,hidden:o,handler:function(){var q=p.dependencyEditor,v=q.dependencyRecord;var u=gantt.getDependencyStore();var s=u.getTargetTask(v);var r=s.data.PercentDone;var w=s.data.State;var t=App.Nls.Complete;if(w!=t){u.remove(v);cpnl.cacheDependencyData(s)}q.collapse()}}],});return n};this.getTaskContextMenuPlugin=function(p){var o=new Array();var n=c.create("Gnt.plugin.TaskContextMenu",{id:"RMBMenu",taskEditorInjected:true,createMenuItems:function(){var w={requiresTask:true,id:"rmbOpenTaskAction",text:App.Nls["emxProgramCentral.Common.OpenInNewTab"],iconCls:"icon iconActionOpen",handler:function(){var A=this.rec.getId();if(A.indexOf("_")>=0){A=A.split("_")[0]}var z="../../common/emxNavigator.jsp?objectId="+A;window.open(z)}};if(viewId==App.Infra.Views.VIEW_STATUS_REPORT){o.push(w);return o}var x=cpnl.getExpandNLevelRMBConfig(this);var q=cpnl.getExpandAllRMBConfig(this);var y=cpnl.getAddTaskRMBConfig(this);var r=cpnl.getAddGateRMBConfig(this);var u=cpnl.getAddMilestoneRMBConfig(this);var v=cpnl.getAddPhaseRMBConfig(this);var t=cpnl.getDeleteRMBConfig(this);var s={requiresTask:true,id:"rmbAssignAction",text:App.Nls["emxProgramCentral.Common.ManageResources"],iconCls:"icon iconManageResource",isValidAction:this.isValidManageResourceAction,handler:function(){var z=c.ComponentQuery.query("dpmresourceutilizationpanel")[0];var F=c.ComponentQuery.query("dpmprojectgantt")[0];if(z.isHidden()){z.show();z.expand()}F.resourceStore.removeAll();F.assignmentStore.removeAll();F.taskStore.resourceStore.commitChanges();F.taskStore.assignmentStore.commitChanges();if(App.Infra.ExtTaskArray.length>0){F.taskStore.remove(App.Infra.ExtTaskArray);App.Infra.ExtTaskArray=new Array();F.taskStore.commitChanges()}z.refreshViews();var A=this.rec;var D=A.getId();var G=this.rec.get("TaskProjectId");var C=gantt.taskStore.getModelById(G);var E=C.get("StartDate").getTime();var B=C.get("EndDate").getTime();z.context=A;z.contextId=D;var I=App.Nls["emxProgramCentral.Common.ManageResources"]+" : "+z.context.getName();z.setTitle(I);var H=getAssignments+"&taskId="+D;c.Ajax.request({url:getAssignments,method:"GET",async:false,params:{taskId:D,taskProjectId:G,projectStart:E,projectEnd:B,},success:function(L,J){var Q=JSON.parse(L.responseText);var K=Q.externals.rows;var N=F.taskStore.data.items[0];var M=K.length;if(M>0){for(var O=0;O<M;O++){var S=K[O];var R=S.Id;if(S.Name!="root"){S.visible=true;S.Id=R;S.Rollup=false;S.ReadOnly=true;S.ExternalTask=true;S.expanded=true;var P=c.create("MyTaskModel",S);App.Infra.ExtTaskArray.push(P);N.addSubtask(P);N.nextSibling=""}F.taskStore.commitChanges()}}if(Q.resources.rows.length>0){F.taskStore.resourceStore.add(Q.resources.rows)}if(Q.assignments.rows.length>0){F.taskStore.assignmentStore.add(Q.assignments.rows)}F.taskStore.resourceStore.commitChanges();F.taskStore.assignmentStore.commitChanges();F.taskStore.commitChanges();F.taskStore.filterBy(function(T){if(T.get("ExternalTask")){return false}return true})},failure:function(J,K){console.log("server-side failure with status code "+J.status)}})}};if(viewId==App.Infra.Views.VIEW_WBS){o.push(w);o.push({xtype:"menuseparator"});o.push(y);o.push(v);o.push(r);o.push(u);o.push(t);o.push({xtype:"menuseparator"});o.push(s);o.push({xtype:"menuseparator"})}o.push(q);o.push(x);return o},isTaskAllExpanded:function(q){return q.hasChildNodes()},expandNLevelFromRMBHandler:function(q){cpnl.performExpandNLevel(this.rec,q)},expandAllFromRMBHandler:function(){cpnl.performExpandAll(this.rec)},isValidAddTaskAbove:function(q){return d.isValidAddTaskAbove(q)},isValidAddSubTask:function(q){return d.isValidAddSubTask(q)},isValidManageResourceAction:function(q){return d.isValidManageResourceAction(q)},isValidDeleteTask:function(q){return d.isValidDeleteTask(q)},addOrDeleteTaskHandler:function(q){if(d.isValidRMBOperation(this.rec,q.id)){cpnl.syncOnAddRemoveTask(this,q.id)}},});return n};this.getResourcePanelContextId=function(){var n=c.ComponentQuery.query("dpmresourceutilizationpanel")[0];var o=n.context;var p="";if(o){p=o.getId()}return p};this.getPrintablePlugin=function(){c.define("DS.ENOGantt.View.GanttPanel.Plugin.Printable",{extend:"Gnt.plugin.Printable",showExportDialog:function(){me=this;me.callParent(arguments);activeDialog=this.getActiveExportDialog();form=activeDialog.form.getForm();fields=form.getFields();fieldSize=fields.length;for(idx=0;idx<fieldSize;idx++){field=fields.getAt(idx);fieldName=field.getName();if("range"==fieldName){store=field.getStore();store.removeAt(3);store.removeAt(1)}else{if("rowsRange"==fieldName){field.hide()}else{if("exporterId"==fieldName){field.hide()}else{if("format"==fieldName){field.hide()}else{if("orientation"==fieldName){field.hide()}}}}}}}});return c.create("DS.ENOGantt.View.GanttPanel.Plugin.Printable")};this.getProgressLinePlugin=function(){return{ptype:"gantt_progressline",disabled:true,}};this.getExpandNLevelRMBConfig=function(n){return{text:App.Nls["emxProgramCentral.Gantt.ExpandNLevel"],itemId:"expandTaskMenu",isValidAction:n.isTaskAllExpanded,iconCls:"icon icon-expandNLevel",menu:{plain:true,defaults:{scope:n},items:d.getSelectiveItemArray(5,"RMB_expandLevel_",n.expandNLevelFromRMBHandler,n.expandAllFromRMBHandler)}}};this.getExpandAllRMBConfig=function(n){return{handler:n.expandAllFromRMBHandler,itemId:"rmbExpandAll",text:App.Nls["emxProgramCentral.Gantt.ExpandAll"],isValidAction:n.isTaskAllExpanded,iconCls:"icon icon-expandall",}};this.getAddTaskRMBConfig=function(o){var p=cpnl.getAddTaskAboveRMBConfig(o);var n=cpnl.getAddSubTaskRMBConfig(o);return{text:App.Nls["emxProgramCentral.Common.AddTask"],itemId:"addTaskMenu",iconCls:"icon iconSmallTask",menu:{plain:true,defaults:{scope:o},items:[p,n]}}};this.getAddTaskAboveRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.ADD_TASK_ABOVE,text:App.Nls["emxProgramCentral.Common.InsertTaskAbove"],isValidAction:n.isValidAddTaskAbove,iconCls:"icon iconActionInsertRowBefore",}};this.getAddSubTaskRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.ADD_SUB_TASK,text:App.Nls["emxProgramCentral.Common.AddSubtaskBelow"],isValidAction:n.isValidAddSubTask,iconCls:"icon iconActionInsertRowAfter",}};this.getAddGateRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.ADD_GATE,text:App.Nls["emxProgramCentral.Common.AddGate"],isValidAction:n.isValidAddSubTask,iconCls:"icon iconSmallGate",}};this.getAddMilestoneRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.ADD_MILESTONE,text:App.Nls["emxProgramCentral.Common.AddMilestone"],isValidAction:n.isValidAddSubTask,iconCls:"icon iconSmallMilestone",}};this.getAddPhaseRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.ADD_PHASE,text:App.Nls["emxProgramCentral.Common.AddPhase"],isValidAction:n.isValidAddSubTask,iconCls:"icon iconSmallPhase",}};this.getDeleteRMBConfig=function(n){return{handler:n.addOrDeleteTaskHandler,requiresTask:true,id:m.DELETE,text:App.Nls["emxProgramCentral.Common.Delete"],isValidAction:n.isValidDeleteTask,iconCls:"icon iconActionDelete",}};this.activateRMBMenu=function(n,p,o){o.stopEvent();n.rec=p;n.triggerEventXY=o.getXY();n.configureMenuItems(o);n.showAt(o.getXY());n.focus()};this.performExpandNLevel=function(n,p){var o=App.Gantt.gantt;App.Gantt.toolbar.expandAll.expanded=true;gantt.setLoading(true);c.Function.defer(function(){d.selectiveExpandFromRMB(n,p.level);var q=new i();q.refine(true);o.setLoading(false);App.Gantt.toolbar.expandAll.expanded=false},100)};this.performExpandAll=function(n){var o=App.Gantt.gantt;App.Gantt.toolbar.expandAll.expanded=true;gantt.setLoading(true);c.Function.defer(function(){d.expandAllFromRMB(n);var p=new i();p.refine(true);o.setLoading(false);App.Gantt.toolbar.expandAll.expanded=false},100)};this.syncOnAddRemoveTask=function(w,x){var p=new Array();var v=gantt.getTaskStore();var n=g.transport.sync.url;var E=w.rec;var u={};p.push(x);p.push(u);u=cpnl.preProcessAddRemove(p);var q;switch(x){case m.ADD_PHASE:q="Phase";break;case m.ADD_GATE:q="Gate";break;case m.ADD_MILESTONE:q="Milestone";break;default:q="Task"}var r=v.model;var s=new r({leaf:true});s.setPercentDone(0);s.set(s.startDateField,E.getStartDate());s.set(s.endDateField,E.getEndDate());s.set(s.durationField,E.getDuration());s.set(s.durationUnitField,E.getDurationUnit()||"d");s.data.DisplayStartDate=E.getStartDate();s.data.DisplayFinishDate=E.getEndDate();if(m.DELETE==x){var A=this.getResourcePanelContextId();var B=false;var C=gantt.lockedGrid.getSelectionModel().selected.items;var o=new Array();for(var z=0,y=C.length;z<y;z++){o.push(C[z].id);if(A!=""&&C[z].id==A){B=true}}if(B){gantt.resourceStore.removeAll();gantt.assignmentStore.removeAll();var D=c.ComponentQuery.query("dpmresourceutilizationpanel")[0];D.collapse()}v.removeTasks(C);g.transport.sync.params={selectedTaskIdForDelete:o}}else{var t;if(m.ADD_TASK_ABOVE==x){E.addTaskAbove(s);t=saveDataURL+"&addTaskAbove=true&type="+q+"&selectedTaskId="+E.id}else{E.addSubtask(s);t=saveDataURL+"&addTaskAbove=false&type="+q}g.transport.sync.url=t}g.sync();p=new Array();p.push(x);p.push(n);if(d.isAddTask(x)){p.push(w)}else{if(d.isDeleteTask(x)){p.push(u)}}cpnl.postProcessAddRemove(p)};this.preProcessAddRemove=function(t){var p=t[0];if(d.isDeleteTask(p)){var w=t[1];var x=gantt.lockedGrid.getSelectionModel().selected;var r=x.items;for(var q=0,n=x.length;q<n;q++){var s=r[q].id;var o=gantt.taskStore.getModelById(s);var v=o.get("TaskProjectId");if(!w[v]){w[v]=0}var u=w[v];w[v]=parseInt(u)+1}return w}};this.postProcessAddRemove=function(u){var n=u[0];var r=u[1];g.transport.sync.url=r;if(d.isAddTask(n)){var p=u[2];var q=p.rec;var x=q.get("TaskProjectId");x=(x==null)?q.id:x;var s=gantt.taskStore.getModelById(x);var v=s.get("LastSequence");v=(v)?v:0;s.set("LastSequence",parseInt(v)+1)}else{if(d.isDeleteTask(n)){var y=u[2];for(var t in y){var w=gantt.taskStore.getModelById(t);var o=y[t];var v=w.get("LastSequence");w.set("LastSequence",parseInt(v)-parseInt(o))}}}g.commit()};this.getGanttPlugin=function(t){var o=[];o.push(this.getPrintablePlugin());var p=this.getTaskContextMenuPlugin(t);o.push(p);if(viewId=="WBSView"||viewId=="ProjectTemplateView"){var q=this.getTaskEditor(t);o.push(q);var n=this.getProjectEditor(t);o.push(n);t.dependencyEditor=this.getDependencyEditor(t);o.push(t.dependencyEditor);var r=this.getCellEditorPlugin(t);o.push(r);var s=this.getProgressLinePlugin();o.push(s)}return o};this.cacheCustomColumn=function(s,o){var r=o.data.Id;var t=s.column.text;var n=s.column.columnDataType;var u=s.value;var q=s.originalValue;var p=s.column.selectable;if(n&&n=="datefield"){u=cpnl.getFormattedDate(u);q=cpnl.getFormattedDate(new Date(q))}cacheCustomColumnURL+="&taskId="+r+"&columnLabel="+t+"&newValue="+u+"&oldValue="+q+"&selectable="+p+"&columnDataType="+n;l.ajax({url:cacheCustomColumnURL,async:false,})};this.getDependencyModel=function(o){var A={SS:0,SF:1,FS:2,FF:3};var r="";var u="";var q="0.0";var t="d";var z=false;var x=o.split(":");if(x.length>2){z=true}if(z){r=x[0]+":"+x[1]}else{r=x[0]}var v=x[x.length-1];var s=v.search("\\-")!=-1?"-":"+";var w=v.split(s);var y=w.length>1;u=w[0];u=A[u.toUpperCase()];if(y){var p=w[1];var B=p.split(" ");q=B[0];t=B[1]}q=("-"==s)?(s+q):q;var n=c.create("Gnt.model.Dependency",{From:r,Type:u,Lag:q,LagUnit:t});return n};this.getDependencyModelArray=function(s){var r=[];s=s.trim();if(s&&s!=""){var q=(s.search(",")!="-1")?true:false;if(!q){var n=this.getDependencyModel(s);r.push(n)}else{dependencyArr=s.split(",");for(var o=0;o<dependencyArr.length;o++){var p=dependencyArr[o];var n=this.getDependencyModel(p);r.push(n)}}}return r};this.cacheDependencyData=function(F,t){var I=App.Gantt.gantt.getDependencyStore();var G=[];var z=(t&&t.isInlineEdit);var J=F.data;var o=J.Id;var B=J.TaskSequenceId;var w=J.Policy;var s=J.State;var D=J.TaskProjectId;var r=null;if(z){r=this.getDependencyModelArray(t.dependencyVal)}else{r=I.getTaskIncomingDependencies(F)}if(r.length==0){var A={taskId:o,taskSequenceId:B,policy:w,state:s,taskProjectId:D,fromTaskProjectId:n};G.push(A)}else{for(var E=0;E<r.length;E++){var y=r[E];var A=y.data;var x=A.Type;var p=A.Lag;var q=A.LagUnit;var v=null;var H=null;var n=null;if(z){H=A.From;if(H.indexOf(":")!=-1){H="{"+H+"}"}}else{var u=I.getSourceTask(y);H=u.data.TaskSequenceId;v=u.data.Id;n=u.data.TaskProjectId}var A={taskId:o,taskProjectId:D,taskSequenceId:B,policy:w,state:s,dependencyNumber:x,dependencyLag:p,lagUnit:q,fromSequenceId:H.toString(),fromTaskId:v,fromTaskProjectId:n};G.push(A)}}if(cacheDependencyDataURL.indexOf("emxGanttService.jsp")!=-1){cacheDependencyDataURL=z?(cacheDependencyDataURL+"&isInlineEdit=true"):cacheDependencyDataURL;var C=l.ajax({url:cacheDependencyDataURL,dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify(G),}).responseText;if(C!=null&&C.trim()){F.reject()}}};this.cacheTaskChangeData=function(o,t,v){var G=t.data;var p=G.Id;var z=G.Policy;var u=G.State;var x=G.ScheduleFrom;var F=G.CalendarId;var E=G.CalendarModifiedDate;var w=G.PercentDone;w=parseFloat(w);var q=G.StartDate;var D=G.EndDate;var n=G.Duration;var C=G.DurationUnit;var y="";if("InlineEdit"==o){if(v.isStartDateEdited){y="ESD"}else{if(v.isFinishDateEdited){y="EED"}else{y="DURATION"}}}else{if("TaskDragDrop"==o){if(D==null&&q!=undefined){var s=G.Duration;var C=G.DurationUnit;D=c.Date.add(q,C,s)}}if("TaskResize"==o){if(z!="Project Review"&&(n!=null&&n==0)){var B=App.Nls["emxProgramCentral.Common.ValueMustBeAPositiveReal"];c.Msg.alert(B);t.reject();return}}}if(!q&&!D){return}q=cpnl.getFormattedDate(q);D=cpnl.getFormattedDate(D);var r="&action="+o+"&inlineEditFor="+y+"&taskId="+p+"&duration="+n+"&durationUnit="+C+"&state="+u+"&policy="+z+"&projectScheduleFrom="+x+"&startDate="+q+"&endDate="+D+"&calendarId="+F+"&calendarModifiedDate="+E;if(cacheTaskChangeDataURL.indexOf("emxGanttService.jsp")!=-1){cacheTaskChangeDataURL=cacheTaskChangeDataURL+r;var A=l.ajax({url:cacheTaskChangeDataURL}).responseText;if(A!=null&&A.trim()){t.reject()}}};this.getFormattedDate=function(o){if(o instanceof Date){var n=c.Date.format(o,"d-m-Y");var p=o.getHours()+":"+o.getMinutes()+":"+o.getSeconds();return n+" "+p}return""};this.getCellEditorPlugin=function(o){var n=c.create("Sch.plugin.TreeCellEditing",{clicksToEdit:2,id:"CellEditorPlugin",listeners:{edit:function(r,q,p){cpnl.processCellEdit(r,q,p)},validateEdit:function(r,q,p){if(q.originalValue===q.value){return}if(!d.isValidCellEdit(r,q,p)){q.cancel=true}}}});return n};this.processCellEdit=function(t,r,q){var p={};var o=r.record;var s=r.field;var u=r.value;var n=r.column.customColumn;if(n){cpnl.cacheCustomColumn(r,o)}else{if("Dependency"==s){if(u!=""){u=d.parseDependencyString(u).actualValue}o.set("Dependency",u);p.isInlineEdit=true;p.dependencyVal=u;cpnl.cacheDependencyData(o,p)}else{if("StartDate"==s){p.isStartDateEdited=true;o.setStartDate(u)}else{if("EndDate"==s){p.isFinishDateEdited=true;o.setEndDate(u)}else{if("Duration"==s){o.setDuration(parseFloat(u))}}}cpnl.cacheTaskChangeData("InlineEdit",o,p)}}};this.getNameFilter=function(){if(e){return new b()}return null};this.getNameColumn=function(){var n=App.Infra.Columns[0];if(e){n.width=200}n.items=this.getNameFilter();n.layout="vbox";return n};this.populateRefinementKeys=function(q){for(var p in q){if(q.hasOwnProperty(p)){var o=q[p].name;if(o){var r=q[p].columnLabel;var n=q[p].columnDataType;App.Gantt.filter.fields[o]={fieldLabel:r,fieldDataType:n,}}else{if(q[p].columns){this.populateRefinementKeys(q[p].columns)}}}}};this.getGanttChartColumn=function(){var n=[];var q=null;var o=App.Infra.Columns;var p=this.getNameColumn();o[0]=p;var r=o[1];r.sortable=false;r.renderer=function(v,w,t){var s=t.get("Status");var u=App.Nls["emxProgramCentral.Gantt.TaskStatus."+s];if(u){return'<div title="'+u+'" class="status '+s+'">&nbsp;</div>'}};if(e){this.populateRefinementKeys(o)}return o};this.initComponent=function(){c.define("MyApp.DemoGanttPanel",{extend:"Gnt.panel.Gantt",cls:"my-toolbar",xtype:"dpmprojectgantt",zoomOnTimeAxisDoubleClick:false,initComponent:function(){App.Gantt.gantt=this;App.Gantt.filter={fields:{},filterBy:{},};App.Gantt.toolbar={expandAll:{expanded:false,}};c.apply(this,{readOnly:App.Infra.ReadOnly,columns:cpnl.getGanttChartColumn(),tbar:function(){if(e){var q=new f();return q}return null}(),});this.callParent(arguments)},expandAll:function(){this.lockedGrid.getView().blockRefresh=this.normalGrid.getView().blockRefresh=true;this.callParent(arguments);this.lockedGrid.getView().blockRefresh=this.normalGrid.getView().blockRefresh=false;this.refreshViews()}});var n=new Date();var o=k.gantt.lockedGrid.width;if(!e){o=200}var p=new MyApp.DemoGanttPanel({region:"center",rowHeight:32,selModel:new c.selection.TreeModel({ignoreRightMouseSelection:false,mode:"MULTI"}),rightLabelField:"Name",crudManager:g,taskStore:g.getTaskStore(),viewPreset:"weekAndDayLetter",tooltipTpl:(!App.Infra.TypeOf.ProjectTemplate)?c.create("DS.ENOGantt.DPMGanttAll.TooltipTamplate",null,a):false,lockedViewConfig:{getRowClass:function(q){return q.isRoot()?"root-row":""},},lockedGridConfig:{width:o,listeners:{afteritemexpand:function(q,r,t,s){if(!App.Gantt.toolbar.expandAll.expanded){var u=new i();u.refine(true)}},},},schedulerConfig:{hideCollapseTool:true,},highlightWeekends:true,showTodayLine:true,loadMask:true,autoFitOnLoad:true,columnLines:true,enableBaseline:App.Infra.BaselineRequired,baselineVisible:App.Infra.BaselineRequired,enableProgressBarResize:false,showRollupTasks:false,allowParentTaskMove:false,enableTaskReordering:false,toggleParentTasksOnClick:false,plugins:cpnl.getGanttPlugin(this),});p.on(this.listeners);return p}}});