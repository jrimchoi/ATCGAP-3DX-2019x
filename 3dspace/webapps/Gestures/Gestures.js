define("DS/Gestures/BasicGesture",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/CoreEvents/Events"],function(e,f,a){var d=0;var b=0;var c=e.extend({init:function(g){this.name=g?g:"";this.id=d++;this.view=[];this.priority=1000;this._order=0;this._needsUpdate=false;this.currentEvent=null;this.events=[];this.debugEvents=false;this.state=c.State.INIT;this.firstChange=false;this.lastChange=false;this.gestures=[];this.requiredBy=0;this.maskedBy=[];this.callbacks=[];this.action="";return this},setView:function(g){if(!g){return}if(g instanceof Array){this.view=[];for(var h=0;h<g.length;h++){this.view.push(g[h])}}else{this.view=[g]}},setAction:function(g){this.action=g},addView:function(g){if(!g){return}this.view.push(g)},removeView:function(g){if(!g){return}var h=this.view.indexOf(g);if(h===-1){return}this.view.splice(h,1)},resetView:function(){this.view=[]},setPriority:function(g){this.priority=g},requireGesture:function(g){this.gestures.push(g);g.requiredBy++;this._needsUpdate=true},maskGesture:function(g){if(g!==null){g.maskedBy.push(this)}},addCallback:function(g){if(typeof g==="function"){for(var j=0;j<this.callbacks.length;j++){if(this.callbacks[j].cb===g){return this.callbacks[j].uid}}var h=this._getEventID();this.callbacks.push({cb:g,uid:h});return h}return null},removeCallback:function(g){if(typeof g==="function"){for(var h=0;h<this.callbacks.length;h++){if(this.callbacks[h].cb===g){this.callbacks[h].cb=null;return true}}}return false},removeCallbackFromToken:function(h){for(var g=0;g<this.callbacks.length;g++){if((this.callbacks[g].uid===h)&&this.callbacks[g].cb){this.callbacks[g].cb=null;return true}}return false},executeCallbacks:function(j){var k=false,h;var g=this.callbacks.slice();for(h=0;h<g.length;h++){if(g[h].cb){g[h].cb.call(this,j)}else{k=true}}k&&this._updateCBArray()},_updateCBArray:function(){if(!this.callbacks.length){return}var h=[];for(var g=0;g<this.callbacks.length;g++){if(this.callbacks[g].cb){h.push(this.callbacks[g])}}this.callbacks=h},_getEventID:function(){var g=this.id+"_"+b;b++;return g},isUsed:function(){return this.callbacks.length||this.requiredBy},_dispose:function(h){this._updateCBArray();if(!this.isUsed()){for(var g=0;g<this.gestures.length;g++){this.gestures[g].requiredBy--;!this.gestures[g].requiredBy&&this.gestures[g]._dispose(h)}h&&h.apply(this);this.view=[]}},detect:function(g){this.currentEvent=g},execute:function(h){if((this.state===c.State.OK)||(this.state===c.State.CHANGE)){if(!h){for(var g=0;g<this.maskedBy.length;g++){var j=this.maskedBy[g];if((j.state===c.State.OK)||(j.state===c.State.CHANGE)){return}}}this.triggerEvent(this.currentEvent)}},update:function(){switch(this.state){case c.State.KO:case c.State.OK:case c.State.CANCEL:this.changeState(c.State.INIT);break;case c.State.CHANGE:if(this.lastChange){this.lastChange=false;this.changeState(c.State.INIT)}break;default:break}},setDebugEvents:function(g){this.debugEvents=g},changeState:function(h,g){this.firstChange=(this.state===c.State.BEGIN)&&(h===c.State.CHANGE);this.lastChange=!!g;this.state=h;if(this.debugEvents>=5){console.log("Gesture "+this.name+" change state to "+c.printState(this.state))}},getState:function(){return this.state},getName:function(){return this.name},getEvents:function(){return this.events},triggerEvent:function(){var g={eventChannel:"/VISU/",eventType:"@on"+this.name+"Event",eventID:this.id,from:this.currentEvent,gesture:this,state:this.firstChange?"begin":(this.lastChange?"end":"")};switch(this.debugEvents){case 0:case 1:break;case 2:if(this.state===c.State.OK){console.log(g)}break;case 3:if(this.state===c.State.CHANGE){console.log(g)}break;case 4:case 5:case 6:console.log(g);break;default:break}a.publish({event:"/VISU/on"+this.name,data:g});if(c.RecordEventsManager){window.WebVisuCurrentGesture=this}this.executeCallbacks(g);if(c.RecordEventsManager){window.WebVisuCurrentGesture=null}if(c.RecordEventsManager){c.RecordEventsManager.recordBasicGesture(this)}},getElapsedTime:function(){if(this.getEvents().length>0){var g=this.getEvents()[0].currentTime-this.getEvents()[0].startTime;return g}return null}});c.State={INIT:0,BEGIN:1,CHANGE:2,OK:3,KO:4,CANCEL:5};c.printState=function(g){switch(g){case c.State.INIT:return"INIT";case c.State.BEGIN:return"BEGIN";case c.State.CHANGE:return"CHANGE";case c.State.OK:return"OK";case c.State.KO:return"KO";case c.State.CANCEL:return"CANCEL";default:return""}};c.RecordEventsManager=null;c.setRecordEventsManager=function(g){this.RecordEventsManager=g};return UWA.namespace("THREEDS/Gestures/BasicGesture",c)});define("Gestures/BasicGesture",["DS/Gestures/BasicGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/BasicGesture");return b});define("DS/Gestures/SmartEditGesture",["DS/CoreEvents/Events","DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(a,d,b,e,f){var c=e.extend({init:function(){this._parent("SmartEdit");this.priority=10;this.identifier=null;this.maxTimeTouch=300;this.maxTimeMouse=300;this.maxDistance=10;this.timer=null;this._type=-1;this.event=null;return this},detect:function(m){this._parent(m);var l=this;var k=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.BEGIN,b.State.MOVE,b.State.IDLE]);var i=THREEDS.VisuEventsManager.getMouseEvents(null,this.view);var j=null;switch(this.state){case e.State.INIT:if(k.length===1||this.onlyLeftMouse(i)){this.resetTimer();if(k.length===1){j=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.BEGIN],this.view);this._type=1}else{if(i.length){j=THREEDS.VisuEventsManager.getMouseEventsByStates([b.State.BEGIN],0,this.view);this._type=0}}if(j&&j.length===1){this.resetTimer();var g=(this._type===1)?this.maxTimeTouch:this.maxTimeMouse;this.identifier=j[0].identifier;this.event=j[0];if(!g){this.events=[j[0]];this.changeState(e.State.OK);this._type=-1}else{if(!f.isReplaying()){this.timer=setTimeout(function(){l.events=[j[0]];l.changeState(e.State.OK);l.execute(true);l._type=-1},g)}this.changeState(e.State.BEGIN)}}else{this._type=-1}}break;case e.State.BEGIN:var h=null;if(this._type===1){h=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}else{if(this._type===0){h=this.event}}if((this._type===1&&k.length!==1)||(this._type===0&&!this.onlyLeftMouse(i))||(h===null)||(h.state===b.State.END)){this.resetTimer();this.changeState(e.State.KO)}else{if(h.state===b.State.MOVE){if(h.offsetPosition.length()>this.maxDistance){this.events=[h];this.changeState(e.State.OK);this._type=-1}}}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.changeState(e.State.INIT);break;default:break}},onlyLeftMouse:function(g){for(var h=0;h<g.length;h++){if((g[h].button!==0)&&(g[h].button!==-1)){return false}}return true},resetTimer:function(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null;this._type=-1}},whenKO:function(){this.resetTimer();this.changeState(e.State.KO)}});return UWA.namespace("THREEDS/Gestures/SmartEditGesture",c)});define("DS/Gestures/DragGesture",["DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/Visualization/ThreeJS_DS"],function(a,d,b){var c=d.extend({init:function(){this._parent("Drag");this.priority=10;this.identifier=null;this.minDistance=5;return this},detect:function(j){this._parent(j);switch(this.state){case d.State.INIT:this.identifier=null;var k=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([a.State.BEGIN],this.view);if(k.length===1){if(k[0].type==="Touch"){this.identifier=k[0].identifier}this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:var g=null;if(this.identifier!==null){var i=THREEDS.VisuEventsManager.getTouchEvents(this.view);if(i.length===1){g=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}}else{var f=THREEDS.VisuEventsManager.getMouseEvents(null,this.view,true);if((f.length===1)&&(f[0].getButton()===a.MouseButton.LEFT)){g=f[0]}}if(g){if(g.offsetPosition.length()>this.minDistance){var h=(g.getState()===a.State.END);var e=j[0].getJSEvent();if(!h&&e.preventDefault){e.preventDefault()}this.events=[g];this.changeState(d.State.CHANGE)}}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:var g=null;if(this.identifier!==null){var i=THREEDS.VisuEventsManager.getTouchEvents(document);if(i.length===1){g=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}}else{var f=THREEDS.VisuEventsManager.getMouseEvents(null,document,true);if((f.length===1)&&(f[0].getButton()===a.MouseButton.LEFT)){g=f[0]}}if(g){var h=(g.getState()===a.State.END);var e=j[0].getJSEvent();if(!h&&e.preventDefault){e.preventDefault()}this.events=[g];this.changeState(d.State.CHANGE,h)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.identifier=null;break;default:break}},getTouchPoint:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();return e}return null},getDistanceFromOrigin:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getOffsetPosition();return e.length()}return null},getLastTraveledDistance:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getDeltaPosition();return e.length()}return null},getTotalTraveledDistFromOrigin:function(){var e=0;if(this.getEvents().length>0){e=this.getEvents()[0].getTraveledDistance();return e}return null},getLastTraveledVector:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getDeltaPosition();return e}return null},getDirectionFromOrigin:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getOffsetPosition();return e}return null}});return UWA.namespace("THREEDS/Gestures/DragGesture",c)});define("DS/Gestures/HoldGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(c,b,d,e){var a=d.extend({init:function(){this._parent("Hold");this.priority=10;this.identifier=null;this.maxTime=THREEDS.VisuEventsManager.getHoldTime();this.maxDistance=10;this.timer=null;this.startTime=0;this.endTime=0;return this},detect:function(i){this._parent(i);var h=this;switch(this.state){case d.State.INIT:var g=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.BEGIN,b.State.MOVE,b.State.IDLE]);if(g.length===1){this.resetTimer();g=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.BEGIN],this.view);if(g.length===1){this.identifier=g[0].identifier;if(!e.isReplaying()){this.timer=setTimeout(function(){h.events=[g[0]];h.endTime=new Date().getTime();h.changeState(d.State.OK);h.execute(true)},this.maxTime)}this.startTime=g[0].startTime;this.changeState(d.State.BEGIN)}}break;case d.State.BEGIN:var g=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.BEGIN,b.State.MOVE,b.State.IDLE]);var f=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);if((g.length!==1)||(f===null)||(f.state===b.State.END)){this.resetTimer();this.changeState(d.State.KO)}else{if(f.state===b.State.MOVE){if(f.offsetPosition.length()>this.maxDistance){this.resetTimer();this.changeState(d.State.KO)}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}},resetTimer:function(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}},getTouchPoint:function(){if(this.getEvents().length>0){var f=this.getEvents()[0].getCurrentPosition();return f}return null},getElapsedTime:function(){if(this.getEvents().length>0){var f=this.endTime-this.startTime;return f}return null}});return UWA.namespace("THREEDS/Gestures/HoldGesture",a)});define("Gestures/HoldGesture",["DS/Gestures/HoldGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/HoldGesture");return b});define("DS/Gestures/MouseDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(e){this._parent(a.printMouseButton(e)+"MouseDown");this.priority=0;this.button=e;return this},detect:function(g){this._parent(g);switch(this.state){case d.State.INIT:var f=THREEDS.VisuEventsManager.getMouseEventsByStates([a.State.BEGIN],this.button,this.view);if(f.length){var e=f[0];this.events=[e];this.changeState(d.State.OK);return}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/MouseDownGesture",b)});define("Gestures/MouseDownGesture",["DS/Gestures/MouseDownGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MouseDownGesture");return b});define("DS/Gestures/EditGesture",["DS/CoreEvents/Events","DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/WebRecordEnabler/Adapter"],function(b,d,c,e,f){var a=e.extend({init:function(){this._parent("Edit");this.priority=10;this.identifier=null;this.maxTimeTouch=THREEDS.VisuEventsManager.getHoldTime();this.maxTimeMouse=THREEDS.VisuEventsManager.getHoldTime();this.maxDistance=10;this.timer=null;this._type=-1;this.event=null;return this},detect:function(m){this._parent(m);var l=this;var k=THREEDS.VisuEventsManager.getTouchEventsByStates([c.State.BEGIN,c.State.MOVE,c.State.IDLE]);var i=THREEDS.VisuEventsManager.getMouseEvents(null,this.view);var j=null;switch(this.state){case e.State.INIT:if(k.length===1||this.onlyLeftMouse(i)){this.resetTimer();if(k.length===1){j=THREEDS.VisuEventsManager.getTouchEventsByStates([c.State.BEGIN],this.view);this._type=1}else{if(i.length){j=THREEDS.VisuEventsManager.getMouseEventsByStates([c.State.BEGIN],0,this.view);this._type=0}}if(j&&j.length===1){this.resetTimer();var g=(this._type===1)?this.maxTimeTouch:this.maxTimeMouse;this.identifier=j[0].identifier;this.event=j[0];if(!g){this.events=[j[0]];this.changeState(e.State.OK);this.execute(true);this._type=-1}else{if(!f.isReplaying()){this.timer=setTimeout(function(){l.events=[j[0]];l.changeState(e.State.OK);l.execute(true);l._type=-1},g)}this.whenBegin()}}else{this._type=-1}}break;case e.State.BEGIN:var h=null;if(this._type===1){h=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}else{if(this._type===0){h=this.event}}if((this._type===1&&k.length!==1)||(this._type===0&&!this.onlyLeftMouse(i))||(h===null)||(h.state===c.State.END)){this.whenKO()}else{if(h.state===c.State.MOVE){if(h.offsetPosition.length()>this.maxDistance){this.whenKO()}}}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.changeState(e.State.INIT);break;default:break}},onlyLeftMouse:function(g){for(var h=0;h<g.length;h++){if((g[h].button!==0)&&(g[h].button!==-1)){return false}}return true},setTimerTouch:function(g){this.maxTimeTouch=g},setTimerMouse:function(g){this.maxTimeMouse=g},resetTimer:function(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null;this._type=-1}},whenBegin:function(){this.changeState(e.State.BEGIN);var g={eventChannel:"/VISU/",eventType:"@onEditEventBegin",eventID:this.id,from:this.currentEvent,gesture:this};b.publish({event:"/VISU/onEditEventBegin",data:g})},whenKO:function(){this.resetTimer();this.changeState(e.State.KO);var g={eventChannel:"/VISU/",eventType:"@onEditEventKO",eventID:this.id,from:this.currentEvent,gesture:this};b.publish({event:"/VISU/onEditEventKO",data:g})}});return UWA.namespace("THREEDS/Gestures/EditGesture",a)});define("Gestures/EditGesture",["DS/Gestures/EditGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/EditGesture");return b});define("DS/Gestures/TwoFingerTapGesture",["DS/Gestures/BasicGesture"],function(b){var a=b.extend({init:function(){this._parent();this.priority=100;this.name="TwoFingerTapGesture";return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/TwoFingerTapGesture",a)});define("Gestures/TwoFingerTapGesture",["DS/Gestures/TwoFingerTapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/TwoFingerTapGesture");return b});define("DS/Gestures/FlickGesture",["DS/Gestures/BasicGesture"],function(b){var a=b.extend({init:function(){this._parent();this.priority=100;this.name="FlickGesture";return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/FlickGesture",a)});define("Gestures/FlickGesture",["DS/Gestures/FlickGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/FlickGesture");return b});define("DS/Gestures/KeyUpGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(){this._parent("KeyUp");this.priority=0;this.key=0;return this},detect:function(h){this._parent(h);switch(this.state){case d.State.INIT:for(var g=0;g<h.length;g++){var f=h[g];var k=f.getType();var j=f.getState();if(k==="Keyboard"){var e=f.getKey();if(j===a.State.END){this.events=[f];this.key=e;this.changeState(d.State.OK);return}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/KeyUpGesture",c)});define("Gestures/KeyUpGesture",["DS/Gestures/KeyUpGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/KeyUpGesture");return b});define("DS/Gestures/DoubleClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(e){this._parent(a.printMouseButton(e)+"DoubleClick");this.priority=100;this.button=e;this.currentTime=0;this.maxTime=300;this.maxDistance=15;this.lastClickTime=0;this.lastClickPosition=new c.Vector2();return this},detect:function(f){this._parent(f);var e=this.gestures[0];if(!e){return}this.currentTime=new Date().getTime();switch(this.state){case d.State.INIT:if(e.getState()===d.State.OK){this.lastClickTime=this.currentTime;this.lastClickPosition.copy(e.events[0].currentPosition);this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(e.getState()===d.State.OK){if((this.currentTime-this.lastClickTime<this.maxTime)&&(this.lastClickPosition.sub(e.events[0].currentPosition).length()<this.maxDistance)){this.events=e.getEvents();this.changeState(d.State.OK)}else{this.lastClickTime=this.currentTime;this.lastClickPosition.copy(e.events[0].currentPosition)}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/DoubleClickGesture",b)});define("Gestures/DoubleClickGesture",["DS/Gestures/DoubleClickGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/DoubleClickGesture");return b});define("DS/Gestures/HoldMouseDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture","DS/Gestures/MouseDownGesture","DS/WebRecordEnabler/Adapter"],function(d,a,e,b,f){var c=e.extend({init:function(h,g){this._parent("Hold"+a.printMouseButton(h)+"MouseDown");this.priority=10;this.button=h;this.maxTime=g?g:THREEDS.VisuEventsManager.getHoldTime();this.maxDistance=10;this.timer=null;return this},detect:function(l){this._parent(l);var h=THREEDS.VisuEventsManager.getMouseEvents(null,this.view);var k=this;switch(this.state){case e.State.INIT:for(var j=0;j<h.length;j++){var g=h[j];if((g.state===a.State.BEGIN)&&(g.button===this.button)){this.resetTimer();this.evt=g;if(!f.isReplaying()){this.timer=setTimeout(function(){k.events=[g];k.changeState(e.State.OK);k.execute(true)},this.maxTime)}this.changeState(e.State.BEGIN);return}}break;case e.State.BEGIN:if((this.evt===null)||(this.evt.state===a.State.END)||((this.evt.state===a.State.MOVE)&&(this.evt.offsetPosition.length()>this.maxDistance))){this.resetTimer();this.changeState(e.State.KO)}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.changeState(e.State.INIT);break;default:break}},resetTimer:function(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}}});return UWA.namespace("THREEDS/Gestures/HoldMouseDownGesture",c)});define("Gestures/HoldMouseDownGesture",["DS/Gestures/HoldMouseDownGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/HoldMouseDownGesture");return b});define("DS/Gestures/MouseOutGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,b,d){var a=d.extend({init:function(){this._parent("MouseOut");this.priority=0;return this},detect:function(h){this._parent(h);var f=THREEDS.VisuEventsManager.getMouseEvents();switch(this.state){case d.State.INIT:for(var g=0;g<f.length;g++){var e=f[g];if((e.state===b.State.CANCEL)&&(e.button===b.MouseButton.NONE)){this.events=[e];this.changeState(d.State.OK);return}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/MouseOutGesture",a)});define("Gestures/MouseOutGesture",["DS/Gestures/MouseOutGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MouseOutGesture");return b});define("DS/Gestures/PrimaryPointerDownUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(c,a,d,e){var b=e.extend({init:function(){this._parent("PrimaryPointerDownUnique");this.priority=10;this.identifier=null;return this},detect:function(g){this._parent(g);switch(this.state){case e.State.INIT:var h=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([a.State.BEGIN],this.view);if(h.length===1){var i=THREEDS.VisuEventsManager.getTouchEvents();var f=THREEDS.VisuEventsManager.getMouseEvents();if(i.length+f.length<=2){this.events=[h[0]];this.changeState(e.State.OK)}}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.identifier=null;this.changeState(e.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerDownUniqueGesture",b)});define("Gestures/PrimaryPointerDownUniqueGesture",["DS/Gestures/PrimaryPointerDownUniqueGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PrimaryPointerDownUniqueGesture");return b});define("DS/Gestures/LongHoldGesture",["DS/Gestures/HoldGesture"],function(a){var b=a.extend({init:function(){this._parent();this.priority=100;this.name="LongHold";this.maxTime=THREEDS.VisuEventsManager.getLongHoldTime();return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/LongHoldGesture",b)});define("Gestures/LongHoldGesture",["DS/Gestures/LongHoldGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/LongHoldGesture");return b});define("DS/Gestures/PrimaryPointerClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(c,a,d,e){var b=e.extend({init:function(){this._parent("PrimaryPointerClick");this.priority=10;this.identifier=null;this.maxTime=300;this.maxDistance=10;return this},detect:function(h){this._parent(h);switch(this.state){case e.State.INIT:this.identifier=null;var i=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([a.State.BEGIN],this.view);if(i.length===1){if(i[0] instanceof d){this.identifier=i[0].identifier}this.changeState(e.State.BEGIN)}break;case e.State.BEGIN:var f=null;if(this.identifier!==null){var g=THREEDS.VisuEventsManager.getTouchEvents(this.view);if(g.length>1){return}f=THREEDS.VisuEventsManager.getTouchEventById(this.identifier)}else{f=THREEDS.VisuEventsManager.getMouseEvents(a.MouseButton.LEFT,this.view)[0]}if(f){if(f.state===a.State.MOVE){if((f.offsetPosition.length()>this.maxDistance)||(f.currentTime-f.startTime>this.maxTime)){this.changeState(e.State.KO)}}else{if(f.state===a.State.END){if((f.offsetPosition.length()>this.maxDistance)||(f.currentTime-f.startTime>this.maxTime)){this.changeState(e.State.KO)}else{this.events=[f];this.changeState(e.State.OK)}}}}else{this.changeState(e.State.KO)}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.identifier=null;this.changeState(e.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerClickGesture",b)});define("Gestures/PrimaryPointerClickGesture",["DS/Gestures/PrimaryPointerClickGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PrimaryPointerClickGesture");return b});define("DS/Gestures/PrimaryPointerDoubleClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(e){this._parent("PrimaryPointerDoubleClick");this.priority=100;this.currentTime=0;this.maxTime=300;this.maxDistance=15;this.lastClickTime=0;this.lastClickPosition=new b.Vector2();return this},detect:function(f){this._parent(f);var e=this.gestures[0];if(!e){return}this.currentTime=new Date().getTime();switch(this.state){case d.State.INIT:if(e.getState()===d.State.OK){this.lastClickTime=this.currentTime;this.lastClickPosition.copy(e.events[0].currentPosition);this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(e.getState()===d.State.OK){if((this.currentTime-this.lastClickTime<this.maxTime)&&(this.lastClickPosition.sub(e.events[0].currentPosition).length()<this.maxDistance)){this.events=e.getEvents();this.changeState(d.State.OK)}else{this.lastClickTime=this.currentTime;this.lastClickPosition.copy(e.events[0].currentPosition)}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerDoubleClickGesture",c)});define("Gestures/PrimaryPointerDoubleClickGesture",["DS/Gestures/PrimaryPointerDoubleClickGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PrimaryPointerDoubleClickGesture");return b});define("DS/Gestures/HoldTapGesture",["DS/Gestures/BasicGesture"],function(b){var a=b.extend({init:function(){this._parent();this.priority=100;this.name="HoldTapGesture";return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/HoldTapGesture",a)});define("Gestures/HoldTapGesture",["DS/Gestures/HoldTapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/HoldTapGesture");return b});define("DS/Gestures/MouseWheelGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("MouseWheel");this.priority=0;this.delta=0;return this},detect:function(g){this._parent(g);switch(this.state){case d.State.INIT:var f=THREEDS.VisuEventsManager.getMouseEventsByStates([a.State.BEGIN],a.MouseButton.WHEEL,this.view);if(f.length){var e=f[0];this.events=[e];this.delta=UWA.Event.wheelDelta(e.getJSEvent());this.changeState(d.State.OK);return}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/MouseWheelGesture",b)});define("Gestures/MouseWheelGesture",["DS/Gestures/MouseWheelGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MouseWheelGesture");return b});define("DS/Gestures/LongEditGesture",["DS/Gestures/EditGesture"],function(a){var b=a.extend({init:function(){this._parent();this.priority=100;this.name="LongEdit";this.maxTimeTouch=1000;this.maxTimeMouse=1000;return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/LongEditGesture",b)});define("Gestures/LongEditGesture",["DS/Gestures/LongEditGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/LongEditGesture");return b});define("DS/Gestures/PrimaryPointerUpUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(c,a,d,e){var b=e.extend({init:function(){this._parent("PrimaryPointerUpUnique");this.priority=10;this.identifier=null;return this},detect:function(g){this._parent(g);switch(this.state){case e.State.INIT:var h=THREEDS.VisuEventsManager.getPrimaryPointerEventsByStates([a.State.END],this.view);if(h.length===1){var i=THREEDS.VisuEventsManager.getTouchEvents();var f=THREEDS.VisuEventsManager.getMouseEvents();if(i.length+f.length<=2){this.events=[h[0]];this.changeState(e.State.OK)}}break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.identifier=null;this.changeState(e.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerUpUniqueGesture",b)});define("Gestures/PrimaryPointerUpUniqueGesture",["DS/Gestures/PrimaryPointerUpUniqueGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PrimaryPointerUpUniqueGesture");return b});define("DS/Gestures/PinchPanRotateGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("PinchPanRotate");this.priority=10;this.touches=[];this.fingersVector=new c.Vector2();this.distance=null;this.lastDistance=0;this.orientation=null;this.lastOrientation=0;this.deltaOrientation=0;return this},detect:function(g){this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END],this.view);if(this.touches.length===2){this.fingersVector.subVectors(this.touches[1].getCurrentPosition(this.view),this.touches[0].getCurrentPosition(this.view));if(this.distance===null){this.distance=this.fingersVector.length()}if(this.orientation===null){this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)}this.lastDistance=this.distance;this.distance=this.fingersVector.length();this.lastOrientation=this.orientation;this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x);this.deltaOrientation=this.orientation-this.lastOrientation;var h=(this.deltaOrientation>=0)?1:-1;h*=2*Math.PI;if(Math.abs(this.deltaOrientation-h)<Math.abs(this.deltaOrientation)){this.deltaOrientation-=h}}switch(this.state){case d.State.INIT:this.distance=null;this.orientation=null;if(this.touches.length>0){this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===2){var e=g[0].getJSEvent();if(e.preventDefault){e.preventDefault()}this.events=this.touches;this.changeState(d.State.CHANGE)}break;case d.State.CHANGE:if(this.touches.length===2){var e=g[0].getJSEvent();if(e.preventDefault){e.preventDefault()}var f=(this.touches[0].getState()===a.State.END)||(this.touches[1].getState()===a.State.END);this.events=this.touches;this.changeState(d.State.CHANGE,f)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];this.distance=null;this.orientation=null;break;default:break}},getAngle:function(){return(this.orientation||0)},getDeltaAngle:function(){return this.deltaOrientation}});return UWA.namespace("THREEDS/Gestures/PinchPanRotateGesture",b)});define("Gestures/PinchPanRotateGesture",["DS/Gestures/PinchPanRotateGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PinchPanRotateGesture");return b});define("DS/Gestures/SpreadGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("Spread");this.priority=10;this.touches=[];this.fingersVector0_1=new c.Vector2();this.fingersVector1_2=new c.Vector2();this.fingersVector2_0=new c.Vector2();this.latencyTime=30;this.initTime=0;this.distance=null;this.lastDistance=0;this.initDistance=0;this.distanceMin=0;return this},detect:function(f){this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END],this.view);if(this.touches.length===3){this.fingersVector0_1.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition);this.fingersVector1_2.subVectors(this.touches[2].currentPosition,this.touches[1].currentPosition);this.fingersVector2_0.subVectors(this.touches[0].currentPosition,this.touches[2].currentPosition);if(this.distance===null){this.distance=this.fingersVector0_1.length()+this.fingersVector1_2.length()+this.fingersVector2_0.length()}this.lastDistance=this.distance;this.distance=this.fingersVector0_1.length()+this.fingersVector1_2.length()+this.fingersVector2_0.length()}switch(this.state){case d.State.INIT:this.distance=null;if(this.touches.length===3){this.preventDefault(this.touches);this.initTime=new Date().getTime();this.initDistance=this.distance;this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===3){this.events=this.touches;this.preventDefault(this.events);this.changeState(d.State.CHANGE)}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:if(this.touches.length===3){var e=(this.touches[0].getState()===a.State.END)||(this.touches[1].getState()===a.State.END)||(this.touches[2].getState()===a.State.END);this.events=this.touches;this.preventDefault(this.events);this.changeState(d.State.CHANGE,e)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];this.distance=null;break;default:break}},preventDefault:function(h){for(var g=0;g<h.length;g++){var e=h[g];var f=e.getJSEvent();if(f.preventDefault){f.preventDefault()}}}});return UWA.namespace("THREEDS/Gestures/SpreadGesture",b)});define("Gestures/SpreadGesture",["DS/Gestures/SpreadGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/SpreadGesture");return b});define("DS/Gestures/ClickGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,b,d){var a=d.extend({init:function(e){this._parent(b.printMouseButton(e)+"Click");this.priority=10;this.button=e;this.maxTime=300;this.maxDistance=10;return this},detect:function(h){this._parent(h);var f=THREEDS.VisuEventsManager.getMouseEvents(null,this.view);switch(this.state){case d.State.INIT:for(var g=0;g<f.length;g++){var e=f[g];if((e.state===b.State.BEGIN)&&(e.button===this.button)){this.changeState(d.State.BEGIN);return}}break;case d.State.BEGIN:for(var g=0;g<f.length;g++){var e=f[g];if(e.button===this.button){if(e.state===b.State.MOVE){if((e.offsetPosition.length()>this.maxDistance)||(e.currentTime-e.startTime>this.maxTime)){this.changeState(d.State.KO);return}}else{if(e.state===b.State.END){if((e.offsetPosition.length()>this.maxDistance)||(e.currentTime-e.startTime>this.maxTime)){this.changeState(d.State.KO)}else{this.events=[e];this.changeState(d.State.OK)}return}}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/ClickGesture",a)});define("Gestures/ClickGesture",["DS/Gestures/ClickGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/ClickGesture");return b});define("DS/Gestures/MediumHoldGesture",["DS/Gestures/HoldGesture"],function(a){var b=a.extend({init:function(){this._parent();this.priority=100;this.name="MediumHold";this.maxTime=THREEDS.VisuEventsManager.getMediumHoldTime();return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/MediumHoldGesture",b)});define("Gestures/MediumHoldGesture",["DS/Gestures/MediumHoldGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MediumHoldGesture");return b});define("DS/Gestures/PinchTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(){this._parent("PinchTap");this.priority=10;this.maxTime=300;this.maxDistance=10;return this},detect:function(g){this._parent(g);switch(this.state){case d.State.INIT:var f=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE],this.view);if(f.length===2){this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:var f=THREEDS.VisuEventsManager.getTouchEvents();if(f.length>2){this.changeState(d.State.KO);return}for(var e=0;e<f.length;e++){var j=f[e];var h=j.getState();if(h===a.State.MOVE){if((j.offsetPosition.length()>this.maxDistance)||(j.currentTime-j.startTime>this.maxTime)){this.changeState(d.State.KO);return}}else{if(h===a.State.END){if((j.offsetPosition.length()>this.maxDistance)||(j.currentTime-j.startTime>this.maxTime)){this.changeState(d.State.KO);return}else{if(f.length===1){this.events.push(j);this.changeState(d.State.OK);return}else{if(f.length===2){this.events=[j]}}}}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PinchTapGesture",c)});define("Gestures/PinchTapGesture",["DS/Gestures/PinchTapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PinchTapGesture");return b});define("DS/Gestures/PanGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("Pan");this.priority=10;this.touches=[];this.fingersVector=new c.Vector2();this.latencyTime=200;this.initTime=0;this.distance=null;this.lastDistance=0;this.initDistance=0;this.distanceMax=10;this.orientation=null;this.lastOrientation=0;this.initOrientation=0;this.orientationMax=0.1;this.barycenter=null;this.lastBarycenter=new c.Vector2();this.initBarycenter=new c.Vector2();this.barycenterMin=10;return this},detect:function(g){this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END],this.view);if(this.touches.length===2){var e=g[0].getJSEvent();if(e.preventDefault){e.preventDefault()}this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition);if(this.distance===null){this.distance=this.fingersVector.length()}if(this.orientation===null){this.orientation=Math.acos(Math.min(Math.max((this.touches[1].currentPosition.x-this.touches[0].currentPosition.x)/this.distance,-1),1))}if(this.barycenter===null){this.barycenter=new c.Vector2();this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}this.lastDistance=this.distance;this.distance=this.fingersVector.length();this.lastOrientation=this.orientation;this.orientation=Math.acos(Math.min(Math.max((this.touches[1].currentPosition.x-this.touches[0].currentPosition.x)/this.distance,-1),1));this.lastBarycenter.copy(this.barycenter);this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}switch(this.state){case d.State.INIT:if(this.touches.length===2){this.initTime=new Date().getTime();this.initDistance=this.distance;this.initOrientation=this.orientation;this.initBarycenter.copy(this.barycenter);this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===2){if(new Date().getTime()-this.initTime>this.latencyTime){if((Math.abs(this.distance-this.initDistance)<this.distanceMax)&&(Math.abs(this.orientation-this.initOrientation)<this.orientationMax)&&(this.initBarycenter.sub(this.barycenter).length()>this.barycenterMin)){this.events=this.touches;this.changeState(d.State.CHANGE)}else{this.changeState(d.State.KO)}}}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:if(this.touches.length===2){var f=(this.touches[0].getState()===a.State.END)||(this.touches[1].getState()===a.State.END);this.events=this.touches;this.changeState(d.State.CHANGE,f)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];this.distance=null;this.orientation=null;this.barycenter=null;break;default:break}},getFirstTouchPosition:function(e){var f;if(this.getEvents().length===2){f=this.getEvents()[0].getCurrentPosition();return f}return null},getSecondTouchPosition:function(f){var e;if(this.getEvents().length===2){e=this.getEvents()[1].getCurrentPosition();return e}return null},getDistanceFromOrigin:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();e.sub(this.getEvents()[0].getStartPosition());return e.length()}return null},getLastTraveledDistance:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();e.sub(this.getEvents()[0].getLastPosition());return e.length()}return null},getTotalTraveledDistFromOrigin:function(){var e=0;if(this.getEvents().length>0){e=this.getEvents()[0].getTraveledDistance();return e}return null},getLastTraveledVector:function(){if(this.getEvents().length>0){var e=this.getEvents()[0]._currentPosition.clone();e.sub(this.getEvents()[0]._lastPosition);return e}return null},getDirectionFromOrigin:function(){if(this.getEvents().length>0){var e=this.getEvents()[0]._currentPosition.clone();e.sub(this.getEvents()[0]._startPosition);return e}return null}});return UWA.namespace("THREEDS/Gestures/PanGesture",b)});define("Gestures/PanGesture",["DS/Gestures/PanGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PanGesture");return b});define("DS/Gestures/SwipeGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(){this._parent("Swipe");this.priority=10;this.touches=[];this.identifier=null;this.minDistance=5;return this},detect:function(h){this._parent(h);this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END]);switch(this.state){case d.State.INIT:if((this.touches.length===1)&&(this.touches[0].isInView(this.view))){this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===1){if(this.touches[0].offsetPosition.length()>this.minDistance){var g=(this.touches[0].getState()===a.State.END);var e=h[0].getJSEvent();if(!g&&e.preventDefault){e.preventDefault()}this.events=this.touches;this.changeState(d.State.CHANGE)}}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:if(this.touches.length===1){var g=(this.touches[0].getState()===a.State.END);var e=h[0].getJSEvent();if(!g&&e.preventDefault){e.preventDefault()}this.events=this.touches;this.changeState(d.State.CHANGE,g)}else{if(this.touches.length===2){var i=this.touches[0].getState();var f=this.touches[1].getState();if((i===a.State.BEGIN)||(f===a.State.BEGIN)){this.changeState(d.State.CHANGE,true)}else{this.changeState(d.State.KO)}}else{this.changeState(d.State.KO)}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];break;default:break}},getSwipeOrigin:function(){var e;if(this.getEvents().length>0){e=this.getEvents()[0].getStartPosition()}return e},getSwipeVector:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();e.sub(this.getEvents()[0].getStartPosition());return e}return null},getSwipeDuration:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].currentTime-this.getEvents()[0].startTime;return e}return null}});return UWA.namespace("THREEDS/Gestures/SwipeGesture",c)});define("Gestures/SwipeGesture",["DS/Gestures/SwipeGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/SwipeGesture");return b});define("DS/Gestures/PrimaryPointerMoveUniqueGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/VisuEvents/TouchEvent","DS/Gestures/BasicGesture"],function(b,a,d,e){var c=e.extend({init:function(){this._parent("PrimaryPointerMoveUnique");this.priority=10;return this},detect:function(g){this._parent(g);switch(this.state){case e.State.INIT:case e.State.CHANGE:var l=false;var m=THREEDS.VisuEventsManager.getScreenEvents();var k=m.length;var o=null;if(k>0){if(k===1){var n=m[0].getType();var f=m[0].getState();if(n==="Mouse"||n==="Touch"){l=(f===a.State.MOVE);o=m[0]}}else{if(k===2){var i=THREEDS.VisuEventsManager.getMouseEventsByStates([a.State.MOVE],a.MouseButton.NONE,this.view);var h=THREEDS.VisuEventsManager.getMouseEventsByStates([a.State.MOVE],a.MouseButton.LEFT,this.view);var j=THREEDS.VisuEventsManager.getTouchEvents(this.view);l=((i.length===1)&&(h.length===1))||((j.length===1)&&(j[0].getState()===a.State.MOVE)&&(!i.length)&&(!h.length));o=(h.length)?h[0]:j[0]}}}if(l){this.events=[o];this.changeState(e.State.CHANGE);return}this.changeState(e.State.INIT);break;case e.State.KO:case e.State.OK:case e.State.CANCEL:this.changeState(e.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/PrimaryPointerMoveUniqueGesture",c)});define("Gestures/PrimaryPointerMoveUniqueGesture",["DS/Gestures/PrimaryPointerMoveUniqueGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PrimaryPointerMoveUniqueGesture");return b});define("DS/Gestures/ReleaseGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,b,d){var a=d.extend({init:function(){this._parent("Release");this.priority=0;return this},detect:function(f){this._parent(f);switch(this.state){case d.State.INIT:var e=THREEDS.VisuEventsManager.getTouchEventsByStates([b.State.END],this.view);if(e.length){this.events=e.slice();this.changeState(d.State.OK);return}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/ReleaseGesture",a)});define("Gestures/ReleaseGesture",["DS/Gestures/ReleaseGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/ReleaseGesture");return b});define("DS/Gestures/PunctualSwipeGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("PunctualSwipe");return this},detect:function(e){this._parent(e);switch(this.state){case d.State.INIT:case d.State.BEGIN:case d.State.CHANGE:case d.State.KO:case d.State.OK:case d.State.CANCEL:default:break}}});return UWA.namespace("THREEDS/Gestures/PunctualSwipeGesture",b)});define("Gestures/PunctualSwipeGesture",["DS/Gestures/PunctualSwipeGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PunctualSwipeGesture");return b});define("DS/Gestures/KeyDownGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(){this._parent("KeyDown");this.priority=0;this.key=0;return this},detect:function(h){this._parent(h);switch(this.state){case d.State.INIT:for(var g=0;g<h.length;g++){var f=h[g];var k=f.getType();var j=f.getState();if(k==="Keyboard"){var e=f.getKey();if(j===a.State.BEGIN){this.events=[f];this.key=e;this.changeState(d.State.OK);return}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/KeyDownGesture",c)});define("Gestures/KeyDownGesture",["DS/Gestures/KeyDownGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/KeyDownGesture");return b});define("DS/Gestures/MouseUpGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(e){this._parent(a.printMouseButton(e)+"MouseUp");this.priority=0;this.button=e;return this},detect:function(g){this._parent(g);switch(this.state){case d.State.INIT:var f=THREEDS.VisuEventsManager.getMouseEventsByStates([a.State.END],this.button,this.view);if(f.length){var e=f[0];this.events=[e];this.changeState(d.State.OK);return}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/MouseUpGesture",c)});define("Gestures/MouseUpGesture",["DS/Gestures/MouseUpGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MouseUpGesture");return b});define("DS/Gestures/TouchGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("Touch");this.priority=0;return this},detect:function(f){this._parent(f);switch(this.state){case d.State.INIT:var e=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN],this.view);if(e.length){this.events=e.slice();this.changeState(d.State.OK);return}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/TouchGesture",b)});define("Gestures/TouchGesture",["DS/Gestures/TouchGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/TouchGesture");return b});define("DS/Gestures/RotateGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("Rotate");this.priority=10;this.touches=[];this.fingersVector=new c.Vector2();this.latencyTime=200;this.initTime=0;this.distance=null;this.lastDistance=0;this.initDistance=0;this.distanceMax=10;this.orientation=null;this.lastOrientation=0;this.deltaOrientation=0;this.initOrientation=0;this.orientationMin=0.1;this.barycenter=null;this.lastBarycenter=new c.Vector2();this.initBarycenter=new c.Vector2();return this},detect:function(g){this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END],this.view);if(this.touches.length===2){var e=g[0].getJSEvent();if(e.preventDefault){e.preventDefault()}this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition);if(this.distance===null){this.distance=this.fingersVector.length()}if(this.orientation===null){this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)}if(this.barycenter===null){this.barycenter=new c.Vector2();this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}this.lastDistance=this.distance;this.distance=this.fingersVector.length();this.lastOrientation=this.orientation;this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x);this.deltaOrientation=this.orientation-this.lastOrientation;var i=(this.deltaOrientation>=0)?1:-1;i*=2*Math.PI;if(Math.abs(this.deltaOrientation-i)<Math.abs(this.deltaOrientation)){this.deltaOrientation-=i}this.lastBarycenter.copy(this.barycenter);this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}switch(this.state){case d.State.INIT:if(this.touches.length===2){this.initTime=new Date().getTime();this.initDistance=this.distance;this.initOrientation=this.orientation;this.initBarycenter.copy(this.barycenter);this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===2){if(new Date().getTime()-this.initTime>this.latencyTime){var h=Math.abs(this.orientation-this.initOrientation);h=Math.min(h,Math.abs(h-2*Math.PI));if((Math.abs(this.distance-this.initDistance)<this.distanceMax)&&(h>this.orientationMin)){this.events=this.touches;this.changeState(d.State.CHANGE)}else{this.changeState(d.State.KO)}}}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:if(this.touches.length===2){var f=(this.touches[0].getState()===a.State.END)||(this.touches[1].getState()===a.State.END);this.events=this.touches;this.changeState(d.State.CHANGE,f)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];this.distance=null;this.orientation=null;this.barycenter=null;break;default:break}},getAngle:function(){return(this.orientation||0)},getDeltaAngle:function(){return this.deltaOrientation},getFirstTouchPosition:function(e){var f;if(this.getEvents().length===2){f=this.getEvents()[0].getCurrentPosition();return f}return null},getSecondTouchPosition:function(f){var e;if(this.getEvents().length===2){e=this.getEvents()[1].getCurrentPosition();return e}return null},getOriginDirection:function(f){if(this.getEvents().length===2){var e=this.getEvents()[1].getStartPosition();e.sub(this.getEvents()[0].getStartPosition());return e}return null},getCurrentDirection:function(e){if(this.getEvents().length===2){var f=this.getEvents()[1].getCurrentPosition();f.sub(this.getEvents()[0].getCurrentPosition());return f}return null},getLastDirection:function(f){if(this.getEvents().length===2){var e=this.getEvents()[1].getLastPosition();e.sub(this.getEvents()[0].getLastPosition());return e}return null}});return UWA.namespace("THREEDS/Gestures/RotateGesture",b)});define("Gestures/RotateGesture",["DS/Gestures/RotateGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/RotateGesture");return b});define("DS/Gestures/DoublePinchTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("DoublePinchTap");this.priority=100;this.currentTime=0;this.maxTime=600;this.maxDistance=15;this.lastTapTime=0;this.lastTapPosition=0;return this},detect:function(f){this._parent(f);var e=this.gestures[0];if(!e){return}this.currentTime=new Date().getTime();switch(this.state){case d.State.INIT:if(e.getState()===d.State.OK){this.lastTapTime=this.currentTime;this.lastPosition=e.events[1].currentPosition;this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(e.getState()===d.State.OK){if((this.currentTime-this.lastTapTime<this.maxTime)&&(this.lastPosition.sub(e.events[1].currentPosition).length()<this.maxDistance)){this.events=e.getEvents();this.changeState(d.State.OK)}else{this.lastTapTime=this.currentTime;this.lastPosition=e.events[1].currentPosition}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/DoublePinchTapGesture",b)});define("Gestures/DoublePinchTapGesture",["DS/Gestures/DoublePinchTapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/DoublePinchTapGesture");return b});define("DS/Gestures/HoldDragGesture",["DS/Gestures/BasicGesture"],function(b){var a=b.extend({init:function(){this._parent();this.priority=100;this.name="HoldDragGesture";return this},detect:function(c){this._parent(c)}});return UWA.namespace("THREEDS/Gestures/HoldDragGesture",a)});define("Gestures/HoldDragGesture",["DS/Gestures/HoldDragGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/HoldDragGesture");return b});define("DS/Gestures/PinchGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("Pinch");this.priority=10;this.touches=[];this.fingersVector=new c.Vector2();this.latencyTime=200;this.initTime=0;this.distance=null;this.lastDistance=0;this.initDistance=0;this.distanceMin=10;this.orientation=null;this.lastOrientation=0;this.deltaOrientation=0;this.initOrientation=0;this.orientationMax=0.1;this.barycenter=null;this.lastBarycenter=new c.Vector2();this.initBarycenter=new c.Vector2();return this},detect:function(g){this.touches=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE,a.State.END],this.view);if(this.touches.length===2){var e=g[0].getJSEvent();if(e.preventDefault){e.preventDefault()}this.fingersVector.subVectors(this.touches[1].currentPosition,this.touches[0].currentPosition);if(this.distance===null){this.distance=this.fingersVector.length()}if(this.orientation===null){this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x)}if(this.barycenter===null){this.barycenter=new c.Vector2();this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}this.lastDistance=this.distance;this.distance=this.fingersVector.length();this.lastOrientation=this.orientation;this.orientation=Math.atan2(this.fingersVector.y,this.fingersVector.x);this.deltaOrientation=this.orientation-this.lastOrientation;var i=(this.deltaOrientation>=0)?1:-1;i*=2*Math.PI;if(Math.abs(this.deltaOrientation-i)<Math.abs(this.deltaOrientation)){this.deltaOrientation-=i}this.lastBarycenter.copy(this.barycenter);this.barycenter.addVectors(this.touches[0].currentPosition,this.touches[1].currentPosition);this.barycenter.multiplyScalar(0.5)}switch(this.state){case d.State.INIT:if(this.touches.length===2){this.initTime=new Date().getTime();this.initDistance=this.distance;this.initOrientation=this.orientation;this.initBarycenter.copy(this.barycenter);this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(this.touches.length===2){if(new Date().getTime()-this.initTime>this.latencyTime){var h=Math.abs(this.orientation-this.initOrientation);h=Math.min(h,Math.abs(h-2*Math.PI));if((Math.abs(this.distance-this.initDistance)>this.distanceMin)&&(h<this.orientationMax)){this.events=this.touches;this.changeState(d.State.CHANGE)}else{this.changeState(d.State.KO)}}}else{this.changeState(d.State.KO)}break;case d.State.CHANGE:if(this.touches.length===2){var f=(this.touches[0].getState()===a.State.END)||(this.touches[1].getState()===a.State.END);this.events=this.touches;this.changeState(d.State.CHANGE,f)}else{this.changeState(d.State.KO)}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);this.touches=[];this.distance=null;this.orientation=null;this.barycenter=null;break;default:break}},getAngle:function(){return(this.orientation||0)},getDeltaAngle:function(){return this.deltaOrientation},getFirstTouchPosition:function(e){var f;if(this.getEvents().length===2){f=this.getEvents()[0].getCurrentPosition();return f}return null},getSecondTouchPosition:function(f){var e;if(this.getEvents().length===2){e=this.getEvents()[1].getCurrentPosition();return e}return null},getInitialDistance:function(e){var g=-1;if(this.getEvents().length===2){var f=this.getEvents()[1].getStartPosition();f.sub(this.getEvents()[0].getStartPosition());g=f.length()}return g},getDistance:function(e){var g=-1;if(this.getEvents().length===2){var f=this.getEvents()[1].getCurrentPosition();f.sub(this.getEvents()[0].getCurrentPosition());g=f.length()}return g}});return UWA.namespace("THREEDS/Gestures/PinchGesture",b)});define("Gestures/PinchGesture",["DS/Gestures/PinchGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/PinchGesture");return b});define("DS/Gestures/MouseMoveGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("MouseMove");this.priority=0;return this},detect:function(h){this._parent(h);var f=THREEDS.VisuEventsManager.getMouseEvents(a.MouseButton.NONE,this.view);switch(this.state){case d.State.INIT:case d.State.CHANGE:for(var g=0;g<f.length;g++){var e=f[g];if(e.state===a.State.MOVE){this.events=[e];this.changeState(d.State.CHANGE);return}else{this.changeState(d.State.INIT);return}}this.changeState(d.State.INIT);break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}}});return UWA.namespace("THREEDS/Gestures/MouseMoveGesture",b)});define("Gestures/MouseMoveGesture",["DS/Gestures/MouseMoveGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/MouseMoveGesture");return b});define("DS/Gestures/DoubleTapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(c,a,d){var b=d.extend({init:function(){this._parent("DoubleTap");this.priority=100;this.currentTime=0;this.maxTime=400;this.maxDistance=15;this.lastTapTime=0;this.lastTapPosition=new c.Vector2();this.lastTapTimeTemp=0;this.lastTapPositionTemp=new c.Vector2();this.firstTapStartTime=0;return this},detect:function(h){this._parent(h);var e=this.gestures[0];if(!e){return}this.currentTime=new Date().getTime();switch(this.state){case d.State.INIT:if(e.getState()===d.State.OK){this.lastTapTime=this.currentTime;this.lastTapPosition.copy(e.events[0].currentPosition);this.lastTapTimeTemp=this.currentTime;this.lastTapPositionTemp.copy(e.events[0].currentPosition);this.firstTapStartTime=e.events[0].startTime;this.changeState(d.State.BEGIN)}break;case d.State.BEGIN:if(e.getState()===d.State.OK){if((this.currentTime-this.lastTapTime<this.maxTime)&&(this.lastTapPosition.sub(e.events[0].currentPosition).length()<this.maxDistance)){this.events=e.getEvents();this.changeState(d.State.OK)}else{this.lastTapTime=this.currentTime;this.lastTapPosition.copy(e.events[0].currentPosition);this.lastTapPositionTemp.copy(e.events[0].currentPosition);this.lastTapTimeTemp=this.currentTime;this.firstTapStartTime=e.events[0].startTime}}else{var g=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN],this.view);if((this.currentTime-this.lastTapTimeTemp<this.maxTime)&&(this.lastTapPositionTemp.sub(e.events[0].currentPosition).length()<this.maxDistance)){if(g[0]){var f=g[0].getJSEvent();if(f&&f.preventDefault){f.preventDefault()}}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}},getElapsedTime:function(){if(this.getEvents().length>0){var e=this.currentTime-this.firstTapStartTime;return e}return null},getTouchPoint:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();return e}return null}});return UWA.namespace("THREEDS/Gestures/DoubleTapGesture",b)});define("Gestures/DoubleTapGesture",["DS/Gestures/DoubleTapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/DoubleTapGesture");return b});define("DS/Gestures/TapGesture",["DS/Visualization/ThreeJS_DS","DS/VisuEvents/ScreenEvent","DS/Gestures/BasicGesture"],function(b,a,d){var c=d.extend({init:function(){this._parent("Tap");this.priority=10;this.identifier=null;this.maxTime=300;this.maxDistance=10;return this},detect:function(g){this._parent(g);switch(this.state){case d.State.INIT:var f=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN,a.State.MOVE,a.State.IDLE]);if(f.length===1){f=THREEDS.VisuEventsManager.getTouchEventsByStates([a.State.BEGIN],this.view);if(f.length===1){this.identifier=f[0].identifier;this.changeState(d.State.BEGIN)}}break;case d.State.BEGIN:var f=THREEDS.VisuEventsManager.getTouchEvents();if(f.length>1){return}var e=THREEDS.VisuEventsManager.getTouchEventById(this.identifier);if(e===null){this.changeState(d.State.KO)}else{if(e.state===a.State.MOVE){if((e.offsetPosition.length()>this.maxDistance)||(e.currentTime-e.startTime>this.maxTime)){this.changeState(d.State.KO)}}else{if(e.state===a.State.END){if((e.offsetPosition.length()>this.maxDistance)||(e.currentTime-e.startTime>this.maxTime)){this.changeState(d.State.KO)}else{this.events=[e];this.changeState(d.State.OK)}}}}break;case d.State.KO:case d.State.OK:case d.State.CANCEL:this.changeState(d.State.INIT);break;default:break}},getTouchPoint:function(){if(this.getEvents().length>0){var e=this.getEvents()[0].getCurrentPosition();return e}return null}});return UWA.namespace("THREEDS/Gestures/TapGesture",c)});define("Gestures/TapGesture",["DS/Gestures/TapGesture","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Gestures/TapGesture");return b});