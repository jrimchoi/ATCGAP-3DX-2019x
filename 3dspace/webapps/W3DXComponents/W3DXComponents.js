/*! -- Copyright 2014 Dassault Systemes. All rights reserved. */
define("DS/W3DXComponents/Views/Item/SkeletonRootView",["UWA/Core","DS/W3DXComponents/ContentSet","DS/W3DXComponents/Views/Layout/ChannelView","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/W3DXComponents/Views/Item/TileView","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Button","css!DS/W3DXComponents/W3DXComponents"],function(h,j,g,k,e,c,f,d){var i="root-skeleton",b;function a(m,o,n,l){if(typeof m[o]==="function"){return m[o].apply(n,l)}else{return h.clone(m[o],false)}}b=j.extend({name:i,defaultOptions:{defaultView:"channel",actions:{},switcher:{},detail:{},contents:{views:[{id:"channel",view:g},{id:"tile",view:k,itemView:c},{id:"list",view:e}]}},_getButtonGroup:function(m){var n=this,l,o;if(!h.is(m)){return}l=m.events||(m.events={});o=l.onClick;l.onClick=function(q,p){if(o){o(q,p)}n.dispatchEvent("onClick",[p,q])};return new f(m||{})},getContentsViewOptions:function(l){var m=a(this.options,"buttonGroup",this.collection),n;l=(l||{});l["default"]=(l.id===this.options.defaultView);l=h.clone(l,false);if(h.is(m)&&l.id!=="channel"){l.header=UWA.createElement("div",{"class":"btn-grp-wrapper"});this._getButtonGroup(m).inject(l.header)}return this._parent.call(this,l)},onMaximized:function(m){var l=this.switcherView.getValue();m=m||{};if(m.type&&m.type==="maximized"){this._windowed=false}else{this._windowed=true}!this._windowed&&(l="tile");this.dispatchEvent("onSwitch",[null,l])},onViewChange:function(l){this.onMaximized.apply(this,arguments)}});return b});define("DS/W3DXComponents/Views/Layout/ScrollView",["UWA/Core","UWA/Event","UWA/Element","UWA/Class/View","UWA/Class/Timed","UWA/Utils/Client","UWA/Fx","DS/UIKIT/Scroller","DS/UIKIT/Spinner","css!DS/W3DXComponents/W3DXComponents"],function(f,x,n,q,a,o,h,u,i){var p={DEACTIVATED:"deactivated",READY:"ready",PULLING:"pulling",RELEASING:"releasing",LOADING:"loading"};function c(D,C,B){var A={};function z(F,E){return F+Math.round((E-F)*B)}function y(E){E=Math.min(E,255);E=Math.max(E,0);var F=E.toString(16);if(F.length<2){F="0"+F}return F}A.r=z(D.r,C.r);A.g=z(D.g,C.g);A.b=z(D.b,C.b);A.cssColor="#"+y(A.r)+y(A.g)+y(A.b);return A}function m(y){var z=y.offsetParent;if(z!==document.body){return z}else{return null}}function g(F,A,y,z,E){var D=y>F?(y-F)/(A-F):0,C=D*180,B=y;z=f.is(z)?z:true;E=f.is(E)?E:true;z&&s.call(this,C);E&&l.call(this,B,this.axis)}function s(y){if(f.is(y,"number")){this.elements.pullareaIcon.setStyles({"-webkit-transform":"rotate3d(0, 0, 1, "+y+"deg)","-ms-transform":"rotate3d(0, 0, 1, "+y+"deg)","-moz-transform":"rotate3d(0, 0, 1, "+y+"deg)",transform:"rotate3d(0, 0, 1, "+y+"deg)"})}}function l(y,z){var A;if(f.is(y,"number")){if(z==="x"){A="translate3d("+y+"px, 0, 0)"}else{A="translate3d(0, "+y+"px, 0)"}this.scroller.getContent().setStyles({"-webkit-transform":A,"-ms-transform":A,"-moz-transform":A,transform:A})}}function b(z){var y=this.elements;switch(z){case p.PULLING:y.pullareaText.setText("Pull to refresh");y.pullareaIcon.show();y.pullareaLoader.hide();this.scroller.elements.content.setStyle("overflow-"+this.axis,"visible");this.pullToRefreshState=p.PULLING;break;case p.RELEASING:y.pullareaText.setText("Release to refresh");y.pullareaIcon.addClassName("spin").show();this.fx.tween("spinhack",180,720);setTimeout(function(){y.pullareaIcon.removeClassName("spin")},this.spinningTime);y.pullareaLoader.hide();this.pullToRefreshState=p.RELEASING;break;case p.LOADING:y.pullareaText.hide();y.pullareaIcon.hide();y.pullareaLoader.show();this.container.addClassName("ease");l.call(this,this.pullLoadingPosition,this.axis);this.pullToRefreshState=p.LOADING;break;default:case p.READY:case p.DEACTIVATED:this.container.addClassName("ease");g.call(this,0,0,0);setTimeout(function(A){var B=A.elements;if(B){B.pullareaText&&B.pullareaText.hide();B.pullareaIcon&&B.pullareaIcon.hide();B.pullareaLoader&&B.pullareaLoader.hide();A.container&&A.container.removeClassName("ease")}},300,this);this.scroller.elements.content.setStyle("overflow-"+this.axis,"auto");this.pullToRefreshState=z===p.DEACTIVATED?p.DEACTIVATED:p.READY;break}}function k(z){var y=this.elements;switch(z){default:case p.READY:y.infiniteareaLoader.hide();y.infinitearea.show();this.infiniteScrollState=p.READY;break;case p.LOADING:y.infinitearea.show();y.infiniteareaLoader.show();this.infiniteScrollState=p.LOADING;break;case p.DEACTIVATED:y.infiniteareaLoader.hide();y.infinitearea.hide();this.infiniteScrollState=p.DEACTIVATED;break}}function t(){this.scroller.elements.content.addEvents({resize:j.bind(this),scroll:j.bind(this)});this.container.addEvents({touchstart:j.bind(this),touchend:j.bind(this),touchcancel:j.bind(this),resize:j.bind(this)})}function d(){this.container.addEvents({touchmove:j.bind(this),})}function e(){this.container.removeEvent("touchmove")}function w(){n.addEvent.call(window,"touchend",this._getReleaseHandler(),true,1,true);this.container.addEvent("touchmove",x.stop)}function r(){n.removeEvent.call(window,"touchend",this._getReleaseHandler(),true);e.call(this)}function j(B){var y,A=this,z=B.type;switch(z){case"touchstart":case"mousedown":case"MSPointerDown":A.pullPosition=0;A._handlePull(B);break;case"touchmove":case"mousemove":case"MSPointerMove":A._handlePull(B);break;case"touchend":case"touchcancel":case"mouseup":case"MSPointerUp":A.pullPosition=-1;break;case"scroll":A._handleScroll();break;case"DOMSubtreeModified":case"orientationchange":case"resize":A._handleScroll();break}return y}u=u.extend({getPosition:function(){var y=this.elements.content;return{y:-y.scrollTop,x:-y.scrollLeft}},getProgress:function(z){var A=this.elements,B=z==="x"?"width":"height",D=this.getPosition()[z],C=A.container.getDimensions()[B],y=A.content.getScrolls()[B];return y>0?Math.min((C+Math.abs(D))/y,1):1},isMaxPosition:function(y,A){var z=this.elements.content;if(y==="x"){return A>0?(z.scrollLeft>=z.scrollWidth-z.clientWidth):(z.scrollLeft<=0)}else{if(y==="y"){return A>0?(z.scrollTop>=z.scrollHeight-z.clientHeight):(z.scrollTop<=0)}}},});var v=q.extend(a,{tagName:"div",className:"scroll-view",pullPosition:-1,pullLoadingPosition:40,pullMinPosition:20,pullMaxPosition:75,pullFactor:0.6,scrollMaxProgress:0.85,loadingMinTime:500,spinningTime:1600,defaultOptions:{orientation:"vertical",useInfiniteScroll:true,usePullToRefresh:true,loadingCompleteEvent:"loadingComplete",scrollEndEvent:"infiniteScrollEnd",},setup:function(A){var y=A.view,z=A.orientation;this.view=y;this.listenTo(y,this.options.scrollEndEvent,k.bind(this,p.DEACTIVATED));this.listenTo(y,this.options.loadingCompleteEvent,this.endLoading.bind(this));this.options.orientation=(z==="vertical"||z==="horizontal")?z:this.defaultOptions.orientation;if(this.options.orientation==="horizontal"){this.axis="x";this.dimension="width"}else{this.axis="y";this.dimension="height"}},render:function(){var B=this.elements,z=this.options,y=this.view,A=this;y.render();y.container.setStyle((this.options.orientation==="horizontal"?"height":"width"),"100%");this.container.removeClassName("horizontal").removeClassName("vertical").addClassName(z.orientation).empty();B.pullareaLoader=new i({visible:false});B.infiniteareaLoader=new i({visible:false});B.pullarea=new n("div",{"class":"pullarea",html:{tag:"div","class":"pullarea-info",html:[B.pullareaLoader,new n("span",{"class":"fonticon fonticon-arrows-ccw"}).hide(),new n("span",{"class":"text"}).hide()]}}).inject(this.container);B.infinitearea=new n("div",{"class":"infinitearea",html:{tag:"div","class":"infinitearea-info",html:[B.infiniteareaLoader]}});this.scroller=new u({element:new n("div",{html:[{tag:"div","class":"scrollable-body",html:y.container},{tag:"div","class":"scrollable-footer",html:B.infinitearea}]})});this.scroller.getContent().setStyle(this.dimension,"100%");this.scroller.inject(this.container);B.pullareaInfo=B.pullarea.getElement(".pullarea-info");B.infiniteareaInfo=B.infinitearea.getElement(".infinitearea-info");B.pullareaIcon=B.pullarea.getElement("span.fonticon");B.pullareaText=B.pullarea.getElement("span.text");this.fx=new h(B.pullareaIcon,{duration:this.spinningTime,transition:"backOut",events:{onAnimate:function(){s.call(A,this.current.spinhack)}}});t.call(this);b.call(this,this.options.usePullToRefresh?p.READY:p.DEACTIVATED);k.call(this,this.options.useInfiniteScroll?p.READY:p.DEACTIVATED);return this},isLoading:function(){return this.infiniteScrollState===p.LOADING||this.pullToRefreshState===p.LOADING},endLoading:function(){function y(){if(this.infiniteScrollState===p.LOADING){k.call(this,p.READY)}if(this.pullToRefreshState===p.LOADING){b.call(this,p.READY)}this._handleScroll()}this.setDelayed("endLoading",y,this.loadingMinTime)},usePullToRefresh:function(y){b.call(this,y?p.READY:p.DEACTIVATED)},useInfiniteScroll:function(y){k.call(this,y?p.READY:p.DEACTIVATED)},_getReleaseHandler:function(){if(!f.is(this.handler)){this.handler=this._handleRelease.bind(this)}return this.handler},_handlePull:function(z){var A=this.pullToRefreshState,y=this.axis,C=x.getPosition(z)[y],B;if(A===p.DEACTIVATED){return}B=this.pullPosition!==-1?(C-this.pullPosition)*this.pullFactor:0;if(A===p.READY&&this.pullPosition===0){this.pullPosition=C;d.call(this)}else{if(A===p.READY&&!this.isLoading()&&B>0&&this.scroller.isMaxPosition(y,-1)){b.call(this,p.PULLING);w.call(this);g.call(this,this.pullMinPosition,this.pullMaxPosition,B);x.stop(z)}else{if(A===p.PULLING){if(B>this.pullMaxPosition){b.call(this,p.RELEASING)}g.call(this,this.pullMinPosition,this.pullMaxPosition,B)}else{if(A===p.RELEASING){g.call(this,this.pullMinPosition,this.pullMaxPosition,B,false,true)}}}}},_handleRelease:function(){if(this.pullToRefreshState===p.RELEASING){b.call(this,p.LOADING);if(this.options.useInfiniteScroll){k.call(this,p.READY)}this.dispatchEvent("onPullToRefresh")}else{b.call(this,p.READY)}r.call(this)},_handleScroll:function(y){if((this.options.useInfiniteScroll&&this.infiniteScrollState!==p.DEACTIVATED&&!this.isLoading()&&this.scroller.getProgress(this.axis)>this.scrollMaxProgress&&m(this.container)!==null)||!!y){k.call(this,p.LOADING);this.dispatchEvent("onInfiniteScroll")}},scrollToPosition:function(z,B,A){this.scroller.scrollTo(z,B,A)},scrollToElement:function(z,y,A){this.scroller.scrollToElement(z,y,A)},destroy:function(){if(this.view){this.view.destroy()}this.removeEvents();this.container.removeEvents();this.stopListening();this._parent()}});return v});define("DS/W3DXComponents/Views/Plugins/LazyLoading",["UWA/Core"],function(c){var b={defaultImgSrc:"",loaderSrc:"",imgElem:"",imgSrc:""};var a={triggerLoading:function(f,d,g){var e=this;f.setAttribute("src",g);UWA.createElement("img",{styles:{display:"none"},events:{load:function(){e.onLoad();this.destroy()},error:function(){e.onLoadError();this.destroy()}}}).inject(document.body).setAttribute("src",d)},setSrc:function(e,d){e.setAttribute("src",d)},onLoading:function(){var f=c.extend(b,this.lazyLoading,true),e=f.imgElem,d=f.imgSrc,g=f.loaderSrc;this.triggerLoading(e,d,g)},onLoadError:function(){var f=this.lazyLoading,e=f.imgElem,d=f.defaultImgSrc;this.setSrc(e,d);this.dispatchEvent("onLoadError")},onLoad:function(){var f=this.lazyLoading,e=f.imgElem,d=f.imgSrc;this.setSrc(e,d);this.dispatchEvent("onLoad")}};return a});define("DS/W3DXComponents/PDFViewer",["UWA/Core","UWA/Event","UWA/Class/View","UWA/Utils","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Alert","DS/UIKIT/Mask","DS/PDFjs/PDFjs","DS/WAFData/WAFData","i18n!DS/W3DXComponents/assets/nls/PDFViewer","css!DS/W3DXComponents/W3DXComponents"],function(g,m,a,f,i,j,h,e,c,k,d){var l=function(u,q,o){var t,s,n,r,v;function p(){var w=new Date().getTime()-r;if(w<q&&w>=0){t=setTimeout(p,q-w)}else{t=null;if(!o){v=u.apply(n,s);if(!t){n=s=null}}}}return function(){n=this;s=arguments;r=new Date().getTime();var w=o&&!t;if(!t){t=setTimeout(p,q)}if(w){v=u.apply(n,s);n=s=null}return v}};var b=a.extend({tagName:"div",className:"pdf-viewer",url:"",pageNum:1,scale:100,forceFit:false,stickyViewer:false,downloadUrl:"",fullScreen:false,_fullScreenButton:null,_pageRendering:false,_pageNumPending:null,_canvas:null,_pdfDoc:null,_zoomChanged:false,domEvents:{resize:"_onResize"},setup:function(n){n=n||{};n.requestsOptions=n.requestsOptions||{};var o=this;o.url=n.url||"";o.scale=parseInt(n.scale)||100;o.pageNum=parseInt(n.pageNum)||1;o.forceFit=n.forceFit===false?false:true;o.stickyViewer=n.stickyViewer;o.fullScreen=n.fullScreen;o.downloadUrl=n.downloadUrl||"";o.deactivateShortcutsOnBlur=n.forceFit===true?true:false;o.options=n},render:function(){var r=this,q=g.createElement,n=r.container,p=r.elements,o="",s=r._getClientInformation();if(r.stickyViewer){n.addClassName("sticky-pdf-viewer");o=" sticky-toolbar"}n.addClassName("shortcuts-active");q("div",{"class":r.className+"-toolbar"+o,html:[{"class":r.className+"-pagetools",html:[new i({className:r.className+"-previouspage-btn default",icon:"fonticon-left-dir",events:{onClick:r._onPrevPage.bind(r)}}),new i({className:r.className+"-nextpage-btn default",icon:"fonticon-right-dir",events:{onClick:r._onNextPage.bind(r)}}),q("span",{"class":r.className+"-pages",html:[p.pageNum=new j({className:r.className+"-page-num",events:{onKeyDown:function(t){if(m.whichKey(t)==="return"){r.pageNum=parseInt(t.target.value);r._queueRenderPage(r.pageNum||1)}}}}),{tag:"span",text:" / ",styles:{margin:"0 5px 0 5px"}},p.pageCount=q("div",{"class":r.className+"-page-count"}),{tag:"span",text:" pages",styles:{"margin-left":"5px"}}]}),new i({className:r.className+"-zoomout-btn default",icon:"fonticon-minus",events:{onClick:r._onZoomOut.bind(r)}}),new i({className:r.className+"-zoomin-btn default",icon:"fonticon-plus",events:{onClick:r._onZoomIn.bind(r)}}),r.forceFit?"":new i({className:r.className+"-zoomfit-btn default",icon:"fonticon-arrow-double-combo",events:{onClick:r._onZoomFit.bind(r)}}),!r.downloadUrl?"":new i({className:r.className+"-download-btn default",icon:"fonticon-download",events:{onClick:r._downloadAction.bind(r)}}),!r.fullScreen?"":r._fullScreenButton=new i({className:r.className+"-fullscreen-btn default",icon:"fonticon-resize-full",events:{onClick:r._fullScreen.bind(r)}})]}]}).inject(n);q("div",{"class":r.className+"-canvas-wrapper",html:[{tag:"canvas","class":r.className+"-canvas"}]}).inject(n);r._canvas=r.getElement("."+r.className+"-canvas");r._downloadPdf();if(!(s.isIphone||s.isIpad)){if(r.deactivateShortcutsOnBlur){window.addEventListener("click",r._deactivateShortcuts.bind(r));r.container.addEvent("click",r._activateShortcuts.bind(r))}document.body.addEventListener("keyup",r._manage_shortcuts.bind(r),false)}return r},renderPage:function(n){this._queueRenderPage(n)},notify:function(n){n=n||{};var o=this;if(!o._alert){o._alert=new h({className:o.className+"-alert"}).inject(o.container||window.body)}o._alert.add(n);o._alert.show()},setUrl:function(n){var o=this;o.url=n;o._downloadPdf()},_renderPage:function(n){var o=this;if(!o._pdfDoc){return}o._pageRendering=true;n=n||o.pageNum;if(n>o._pdfDoc.numPages){n=o._pdfDoc.numPages}if(n<=0){n=1}o.pageNum=n;o._pdfDoc.getPage(n).then(function(u){var t,r,p,s=o._canvas,q=o.container;s.width=q.getDimensions().width*(o.scale/100)-45;p=u.getViewport(s.width/u.getViewport(1).width);s.height=p.height;t={canvasContext:s.getContext("2d"),viewport:p};r=u.render(t);r.promise.then(function(){o._pageRendering=false;if(o._pageNumPending!==null){o._renderPage(o._pageNumPending);o._pageNumPending=null}})["catch"](o._catchPDfjsError.bind(o));q.setStyle("height",p.height+54+"px")})["catch"](o._catchPDfjsError.bind(o));o.elements.pageNum.setValue(o.pageNum)},_downloadPdf:function(){var p=this,n=p.container;function q(r){r=new Uint8Array(r);c.getDocument(r).then(function(s){p._pdfDoc=s;p.elements.pageCount.textContent=p._pdfDoc.numPages;e.unmask(n);p._queueRenderPage(p.pageNum)})["catch"](p._catchPDfjsError.bind(p))}function o(r){g.log(r);e.unmask(n);if(p.options.requestsOptions.onFailure){p.options.requestsOptions.onFailure()}else{p.notify({message:d.unreachableUrl,className:"error"})}}if(!p.url){return}e.mask(n);k.handleRequest(p.url,{method:"GET",type:"arraybuffer",authentication:p.options.requestsOptions.authentication,onComplete:q,onFailure:o,onTimeout:o})},_queueRenderPage:function(n){var o=this;if(o._pageRendering){o._pageNumPending=n||o.pageNum}else{o._renderPage(n)}},_onPrevPage:function(){var n=this;if(n.pageNum<=1){return}n.pageNum--;n._queueRenderPage(n.pageNum)},_onNextPage:function(){var n=this;if(n.pageNum>=n._pdfDoc.numPages){return}n.pageNum++;n._queueRenderPage(n.pageNum)},_onZoomIn:function(){var n=this;if(n.forceFit){n._zoomChanged=true}n.scale+=10;n._queueRenderPage(n.pageNum)},_onZoomOut:function(){var n=this,o=n.scale,p;if(n.forceFit){n._zoomChanged=true}p=o-10;if(p<=0){p=10}if(p===o){return}n.scale=p;n._queueRenderPage(n.pageNum)},_onZoomFit:function(){var n=this;n.scale=100;n._queueRenderPage(n.pageNum)},_onResize:function(){var n=this;if(n.forceFit&&!n._zoomChanged){l(n._onZoomFit(),1000,false)}else{n._zoomChanged=false}},_downloadAction:function(){var n=this,o=n._getClientInformation();window.open(n.downloadUrl,(o.isIphone||o.isIpad)&&o.isSafari?"_blank":"_self")},_fullScreen:function(){var n=this.container;if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement){if(n.requestFullscreen){n.requestFullscreen()}else{if(n.mozRequestFullScreen){n.mozRequestFullScreen()}else{if(n.webkitRequestFullscreen){n.webkitRequestFullscreen()}}}this._fullScreenButton.setIcon("fonticon-resize-small")}else{if(document.cancelFullScreen){document.cancelFullScreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}}}this._fullScreenButton.setIcon("fonticon-resize-full")}},_getClientInformation:function(){var o=f.Client,n=o.Platform,p=o.Engine;return{isIpad:(n.ipad===true),isIphone:(p.name==="safari")&&n.ios&&(n.ipad===false),isSafari:(p.name==="safari")}},_catchPDfjsError:function(n){e.unmask(this.container);this.notify({message:(n&&n.message)||"An error occured.",className:"error"})},_activateShortcuts:function(){this.container.addClassName("shortcuts-active")},_deactivateShortcuts:function(){this.container.removeClassName("shortcuts-active")},_manage_shortcuts:function(o){var n=this;if(this.container.hasClassName("shortcuts-active")){switch(o.keyCode){case 27:if(g.is(n._fullScreenButton)){n._fullScreenButton.setIcon("fonticon-resize-full")}break;case 37:n._onPrevPage();break;case 39:n._onNextPage();break;case 107:n._onZoomIn();break;case 109:n._onZoomOut();break;default:break}}},destroy:function(){var n=this,o=n._getClientInformation();n._canvas&&n._canvas.destroy();n._pdfDoc=null;n._alert&&n._alert.destroy();n._alert=null;if(!(o.isIphone||o.isIpad)){document.body.removeEvent("keyup",n._manage_shortcuts)}return n._parent.apply(n,arguments)},});return b});define("DS/W3DXComponents/LanguagePicker",["UWA/Core","UWA/Class/View","DS/WAFData/WAFData","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","i18n!DS/W3DXComponents/assets/nls/LanguagePicker"],function(g,f,a,c,b,h,e){var d=f.extend({_propertyName:null,_passportUrl:null,_service:{url:null,data:{}},_getSupportedLanguages:null,_getCurrentLanguage:null,_setCurrentLanguage:null,_modal:null,_saveButton:null,_cancelButton:null,_currentLanguage:null,_language:null,className:"language-picker",_createContent:function(){var i,k=[];i=this._getSupportedLanguages();this._currentLanguage=this._getCurrentLanguage();this._language=this._currentLanguage;this.saveButton=new b({value:e.Save,className:"primary",events:{onClick:function(){this.saveButton.load();this.cancelButton.setDisabled();for(var m=0;m<k.length;m++){k[m].setDisabled()}this._service.onComplete=function(){if(this._language!==this._currentLanguage){this._setCurrentLanguage(this._language)}else{this._modal.hide()}}.bind(this);this._service.onFailure=function(){this.saveButton.load(false);this.cancelButton.setDisabled(false);for(var n=0;n<k.length;n++){k[n].setDisabled(false)}}.bind(this);if(this._service.url!==null){if(typeof this._propertyName==="function"){this._service.data=g.Json.encode(this._propertyName(this._language))}else{if(typeof this._propertyName==="string"){this._service.data[this._propertyName]=g.Json.encode(this._language)}}g.Data.request(this._service.url,this._service)}else{if(this._passportUrl!==null){this._service.url=((this._passportUrl.slice(-1)==="/")?this._passportUrl:(this._passportUrl+"/"))+"my-profile/update/language/"+this._language;a.authenticatedRequest(this._service.url,{method:"POST",onComplete:this._service.onComplete,onFailure:this._service.onComplete})}else{this._setCurrentLanguage(this._language)}}}.bind(this)}});this.cancelButton=new b({value:e.Cancel,events:{onClick:function(){this._modal.hide()}.bind(this)}});for(var j in i){var l=new h({name:"language",label:i[j].localizedName+" ("+i[j].staticName+")",value:j,className:"primary",events:{onChange:this._changeLanguage.bind(this)}});if(this._language===j){l.check()}k.push(l)}this._modal=new c({closable:true,header:"<h4>"+e.LanguagePreferences+"</h4>",body:k,footer:[this.saveButton,this.cancelButton],events:{onHide:function(){this.destroy()}.bind(this)}});return this._modal},_changeLanguage:function(i){this._language=i.target.value},render:function(){this.container.setContent(this._createContent());return this},show:function(){this._modal.show()},setup:function(i){if(i){g.merge(this._service,i.service);if(i.hasOwnProperty("propertyName")){this._propertyName=i.propertyName}if(i.hasOwnProperty("passportUrl")){this._passportUrl=i.passportUrl}if(i.hasOwnProperty("availableLanguagesGetter")&&i.hasOwnProperty("currentLanguageGetter")&&i.hasOwnProperty("currentLanguageSetter")){this._getSupportedLanguages=i.availableLanguagesGetter;this._getCurrentLanguage=i.currentLanguageGetter;this._setCurrentLanguage=i.currentLanguageSetter}}return this}});return d});define("DS/W3DXComponents/Views/Plugins/Multisel",function(){var b=this;var a={_initSelectionSet:function(){if(!this._selectionState){this._selectionState={isActive:false,selectedObjects:[],wasExplicitlyActivated:false}}},resetSelectionState:function(){if(this._selectionState){this._selectionState.isActive=false;this._selectionState.selectedObjects=[];this._selectionState.wasExplicitlyActivated=false}},setMultisel:function(c){this._selectionState=c;this.dispatchEvent("onSetMultisel")},activateMultisel:function(c){this._initSelectionSet();this._selectionState.isActive=true;this._selectionState.wasExplicitlyActivated=c;this.dispatchEvent("onActivateMultisel")},deactivateMultisel:function(){this.resetSelectionState();this.dispatchEvent("onDeactivateMultisel")},addSelection:function(c){this._initSelectionSet();this._selectionState.selectedObjects.push(c);this.dispatchEvent("onAddSelection",c)},removeSelection:function(c){if(this._selectionState){for(var d=this._selectionState.selectedObjects.length-1;d>=0;d--){if(this._selectionState.selectedObjects[d].id===c.id){this._selectionState.selectedObjects.splice(d,1)}}this.dispatchEvent("onRemoveSelection",c)}},isSelected:function(c){if(this._selectionState){var d=this._selectionState.selectedObjects.filter(function(e){return(e.id===c.id)});if(d.length>0){return true}else{return false}}else{return false}},selectionIsEmpty:function(){this._initSelectionSet();return(this._selectionState.selectedObjects.length===0)},getSelectionState:function(){this._initSelectionSet();return this._selectionState},getSelection:function(){this._initSelectionSet();return this._selectionState.selectedObjects}};return a});define("DS/W3DXComponents/Models/ActionModel",["UWA/Core","UWA/Class/Model"],function(b,a){var c=a.extend({defaults:{title:"",icon:"",id:"",context:false,overflow:true}});return c});define("DS/W3DXComponents/Views/GraphView",["UWA/Core","UWA/Class/View","DS/UIKIT/Alert","DS/3DXHighcharts/3DXHighcharts","i18n!DS/W3DXComponents/assets/nls/Views/GraphView","css!DS/W3DXComponents/W3DXComponents"],function(k,B,A,a,s){var D="line",i="column",z="pie",j="donut",y="table",c="linear",q="datetime",r="logarithmic",d="none",x="normal",f="percent",G="error",w="warning",u="#000000",e="#3A7DCC",h="#F8941C",m="#FFCB06",o="#9EC944",p="#34B0D2",t="#8A5DC0",b="#D95F5C",F="#B22222";var C=[e,h,m,o,p,t,b],E={enabled:false},g={enabled:false};function v(){try{a.setOptions({lang:{contextButtonTitle:s.contextButtonTitle,drillUpText:s.drillUpText,loading:s.loading,resetZoomTitle:s.resetZoomTitle,months:[s.jan,s.feb,s.mar,s.apr,s.may,s.jun,s.jul,s.aug,s.sep,s.oct,s.nov,s.dec],shortMonths:[s.sjan,s.sfeb,s.smar,s.sapr,s.smay,s.sjun,s.sjul,s.saug,s.ssep,s.soct,s.snov,s.sdec],weekdays:[s.sun,s.mon,s.tue,s.wen,s.thu,s.fri,s.sat]}})}catch(H){k.log("Graph View Error: Highcharts is not defined. Can't be translated.")}}function l(I,H){return I.replace(/\{([\w\-]+)\}/g,function(J,K){return H[K]!==undefined?H[K]:""})}var n=B.extend({tagName:"div",className:"w3dx-GraphView",defaultOptions:{custoClass:"",title:"",subtitle:"",type:D,xAxis:{title:"",categories:[],type:c},yAxis:{title:""},series:[],unit:"",stacking:"",showPlot:false,animation:true,width:null,height:null},_highcharts:null,_tableEl:null,_alert:null,_messages:[],_isInjected:false,setup:function(H){H=H||{};H.series=H.series||[];H.xAxis=H.xAxis||{};H.yAxis=H.yAxis||{};H.xAxis.categories=H.xAxis.categories||[];this.options=k.extend(k.clone(this.defaultOptions),H||{},true);this._parent(H)},render:function(){var J,H=this.options,I=H.series;J=H.type=H.type.toLowerCase();this.container.addClassName(H.custoClass);if(!I.length){this._notify({message:s.noValidDataProvided,type:w});return this}if(J===y){if(this._highcharts){this._highcharts.destroy();this._highcharts=null}this._drawTable()}else{try{if(this._tableEl){this._tableEl.destroy();this._tableEl=null}this._drawHighcharts()}catch(K){this._notify({message:K.message,})}}return this},reflow:function(){if(this._highcharts){this._highcharts.reflow()}return this},setSize:function(I,H){I=I||100;H=H||100;if(this._highcharts){this._highcharts.setSize(I,H)}else{if(this._tableEl){this._tableEl.setStyles({width:I,height:H})}}return this},destroy:function(){if(this._highcharts){this._highcharts.destroy();this._highcharts=null}if(this._tableEl){this._tableEl.destroy();this._tableEl=null}if(this._alert){this._alert.destroy();this._alert=null}this._messages=null;this._parent()},_parseGraphOption:function(H){var I={},J=H.type;if(H.xAxis.type===q){H.xAxis.categories=null}switch(J){case D:I=this._getLineOptions(H);break;case z:case j:I=this._getPieDonutOptions(H);break;case i:I=this._getColumnOptions(H);break;default:k.log("DS/W3DXComponents/Views/GraphView : Error => No valid type found in chart options");throw {message:l(s.TypeGraphNotDef,{typeGraph:J})}}I.title={text:H.title,};I.subtitle={text:H.subtitle,};return I},_getLineOptions:function(K){var M={},H=K.xAxis,N=K.unit,J=K.showPlot,L=K.stacking,I=H.categories||[];M.plotOptions={area:{fillOpacity:0.1,marker:{enabled:J}},line:{marker:{enabled:J}}};M.xAxis={title:{text:H.title},type:H.type};M.xAxis.categories=I.length?I:null;M.yAxis={title:{text:K.yAxis.title+(N?" ("+N+")":"")},plotLines:[{value:0,width:1,color:"#808080"}]};M.tooltip={pointFormat:"{series.name}: <b>{point.y}</b>"+(L!==d?" ({point.percentage:.1f}%)<br/>":"")};M.series=K.series;M=this._getThresholdOptions(M,K);return M},_getColumnOptions:function(J){var L={},M=J.unit,H=J.xAxis,K=J.stacking,I=H.categories||[];L.xAxis={title:{text:H.title},type:H.type};L.yAxis={allowDecimals:false,title:{text:J.yAxis.title+(M?" ("+M+")":"")}};L.xAxis.categories=I.length?I:null;L.tooltip={pointFormat:"{series.name}: <b>{point.y}</b>"+(K!==d?" ({point.percentage:.1f}%)<br/>":"")};L.series=J.series;L=this._getThresholdOptions(L,J);return L},_getPieDonutOptions:function(H){var I={};I.plotOptions={pie:{allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:true,color:u,connectorColor:u},showInLegend:true}};I.tooltip={pointFormat:"<b>Total: {point.y}</b> ({point.percentage:.1f} %)"};I.series=[{type:z,name:H.unit,data:H.series[0].data,innerSize:H.type===j?"60%":"0%"}];return I},_getThresholdOptions:function(L,Q){var K=L.yAxis,M=K.plotLines,H=Q.yAxis,N=H.thresholdMin||{},J=H.thresholdMax||{},O=N.value,P=J.value,I="ShortDash";if(!M){M=K.plotLines=[]}if(N&&k.is(O)){M.push({id:"limit-min",color:o,dashStyle:I,width:2,value:O||0,zIndex:100,label:{text:N.title||""}})}if(J&&k.is(P)){M.push({id:"limit-max",color:F,dashStyle:I,width:2,value:P||0,zIndex:100,label:{text:J.title||""}})}return L},_drawHighcharts:function(){var I,L,H=this.options,J=H.expertOpts,K=H.stacking||d,N=H.unit;L=this._parseGraphOption(H);k.extend(L,{chart:{renderTo:this.container,type:H.type,width:H.width||null,height:H.height||null},plotOptions:{series:{animation:H.animation,stacking:K===d?null:K}},legend:{borderWidth:0},tooltip:{valueSuffix:N},colors:C,credits:E,exporting:g},true);if(J){k.extend(L,J,true)}this._messages=[];try{this._highcharts=new a.Chart(L)}catch(M){k.log(M);k.log("GraphView: Provided highcharts options:");k.log(L);I=M.message||"";if(!HighchartsAdapter){I=s.highchartsStandaloneNotDef+";<br/> "+I}this._notify({message:I||" "+s.errorInOptions})}},_drawTable:function(){var ad,ab,Q,J,I,L,O,M,af,H,Z,T,V=0,ae=[],K=[],aa=k.createElement,R=this,U=R.container,N=R.options,S=N.series||[],W=N.unit||"",P=N.xAxis||{},Y=P.categories||[],ac=!!(Y.length);function X(){R._notify({message:s.noValidDataProvided,type:w})}if(S.length&&S[0].data){Z=S[0];ae=Z.data}else{X();return}af=aa("table",{"class":this.className+"-table table table-striped table-hover",html:[aa("thead",{html:T=aa("tr",{"class":"th-row row"})}),H=aa("tbody")]});K=Z.columns||[];if(ac&&K.length){T.addContent({tag:"th","class":"th-col col",html:"&nbsp;"})}for(ad=0,O=K.length;ad<O;ad++){T.addContent({tag:"th","class":"th-col col",html:K[ad]+""})}for(ad=0,L=ae.length;ad<L;ad++){Q=ae[ad];I=aa("tr",{"class":"tb-row row"}).inject(H);if(ac){M=Y[ad]||"";I.addContent({tag:"td","class":"tb-col col category",html:M+""})}for(ab=0,J=Q.length;ab<J;ab++){V++;I.addContent({tag:"td","class":"tb-col col",html:Q[ab]+""})}}if(!V){X();return}R._messages=[];U.setContent(af);if(W){U.addContent({tag:"div","class":"unit",html:"("+W+")"})}},_notify:function(I){var K,J,L=this._alert,H=this.container;I=I||{};J=I.type||G;K=J.ucfirst()+": <b>"+(I.message||s.errorNotSpec)+".</b>";if(!H){k.log(K);return}if(L){L.destroy()}H.empty();this._alert=L=new A({className:this.className+"-notify",closable:I.closable||false,visible:true,autoHide:I.autoHide||false,hideDelay:I.hideDelay||4000,}).inject(H);if(this._isInjected){L.add({message:K,className:J})}else{this._messages.push(I)}},onPostInject:function(){var H=this;H._isInjected=true;H._messages.forEach(function(I){H._notify(I)});H._messages=[]}});n.TYPE_LINE=D;n.TYPE_COLUMN=i;n.TYPE_PIE=z;n.TYPE_DONUT=j;n.TYPE_TABLE=y;n.XAXIS_TYPE_LINEAR=c;n.XAXIS_TYPE_DATETIME=q;n.XAXIS_TYPE_LOG=r;n.STACKING_NONE=d;n.STACKING_NORMAL=x;n.STACKING_PERCENT=f;v();return n});define("DS/W3DXComponents/Views/Temp/DeprecatedAutocomplete",["UWA/Core","UWA/Event","UWA/Data","UWA/Json","UWA/Controls/Abstract","UWA/String"],function(g,b,c,a,f,e){var d=f.extend({typeTimeout:null,dataCache:{},itemCache:{},defaultOptions:{suggestUrl:null,suggestKey:"",placeholder:"",shouldExist:false,itemDataKey:"item",dataParser:null,typeDelay:500,minLength:1,maxHeight:"auto",suggestFormat:"{name}",className:"uwa-autocomplete nv-autocomplete"},init:function(h){this._parent(h);this.buildSkeleton();this.attachEvents()},buildSkeleton:function(){var i=this.elements,h=this.options.className;i.form=g.createElement("form",{"class":h});i.inputContainer=g.createElement("div",{"class":h+"-searchbox"}).inject(i.form);i.input=g.createElement("input",{"class":h+"-input",placeholder:this.options.placeholder,type:"text"}).inject(i.inputContainer);this.resetInput();i.suggestsContainer=g.createElement("div",{"class":h+"-suggests"}).inject(i.form);i.suggests=g.createElement("ul").inject(i.suggestsContainer);i.container=i.form},attachEvents:function(){var h=this.elements;h.input.addEvent("keyup",this.onKeyUp.bind(this));h.input.addEvent("blur",this.onBlur.bind(this));h.input.addEvent("focus",this.onFocus.bind(this));h.form.addEvent("submit",function(j){var i=this.itemCache[h.input.value.toLowerCase()];b.stop(j);if(!this.options.shouldExist||i){if(this.options.suggestKey&&i){h.input.value=i[this.options.suggestKey]}this.dispatchEvent("onSelect",[h.input.value,i]);h.input.blur();this.dispatchEvent("onHideSuggests")}return false}.bind(this))},getSuggestions:function(i){var h;if(!i){return}if(this.dataCache[i]){this.dispatchEvent("onUpdateSuggests",[this.dataCache[i]]);this.typeTimeout=null;return}if(this.options.suggestUrl){h=this.options.suggestUrl.replace("{text}",i);c.getText(h,function(j){j=this.dataParse(j);if(j.length>0){this.dataCache[i]=j;this.dispatchEvent("onUpdateSuggests",[j])}this.typeTimeout=null}.bind(this))}},dataParse:function(j){var l,h,i,k=this.options.dataParser;if(g.is(k,"function")){j=k(j)}else{if(a.isJson(j)){j=a.decode(j);i=true}else{j=a.xmlToJson(j);for(l in j){if(j.hasOwnProperty(l)){j=j[l];break}}}for(l in j){if(j.hasOwnProperty(l)){if(!h){h=l}if(Array.isArray(j[l])){j=j[l];i=true}}}if(!i&&h){j=[j[h]]}}return Array.isArray(j)?j:[]},resizeSuggests:function(){var i=this.elements,h=i.input.getDimensions();i.suggestsContainer.setStyle("width",h.width+"px");if(this.options.maxHeight&&this.options.maxHeight!=="auto"){i.suggestsContainer.setStyle("height",this.options.maxHeight+"px")}},getFormattedSuggest:function(h){return this.options.suggestFormat.replace(/\{(\w+)\}/g,function(k,l){var j=g.is(h,"string")?h:h[l];return j})},resetInput:function(){var h=this.elements;if(!h.input.placeholder){h.input.value=this.options.placeholder}else{h.input.value=""}this.resetCache()},getFocus:function(){this.elements.input.focus()},resetCache:function(){this.dataCache={};this.itemCache={}},onUpdateSuggests:function(h){var k,i,j=this.elements;j.suggests.empty();this.dispatchEvent("onShowSuggests");if(Array.isArray(h)&&h.length!==0){h.forEach(function(l){var m=this.getFormattedSuggest(l);k=g.createElement("li");i=g.createElement("a").inject(k);i.setHTML(m);k.inject(j.suggests);if(this.options.suggestKey){this.itemCache[l[this.options.suggestKey].toLowerCase()]=l}i.addEvent("click",function(n){var o=this.options.suggestKey?n[this.options.suggestKey]:e.stripTags(this.getFormattedSuggest(n));this.dispatchEvent("onSelect",[o,n])}.bind(this,l))}.bind(this));this.resizeSuggests()}},onSelect:function(i,h){this.elements.input.value=i;this.dispatchEvent("onHideSuggests")},onHideSuggests:function(){var h=this.elements;h.container.removeClassName(this.options.className+"-suggestsDisplayed")},onShowSuggests:function(){var h=this.elements;h.container.addClassName(this.options.className+"-suggestsDisplayed")},onBlur:function(h){setTimeout(function(){this.dispatchEvent("onHideSuggests")}.bind(this),200)},onFocus:function(i){var j=this.elements,h=b.getElement(i);if(j.input.value===this.options.placeholder){j.input.value=""}this.getSuggestions(h.value)},onKeyUp:function(i){var h=b.getElement(i);if(h.value.length===0){this.onHideSuggests();return}if(h.value.length>=this.options.minLength&&!this.typeTimeout){clearTimeout(this.typeTimeout);this.typeTimeout=setTimeout(function(){this.getSuggestions(h.value)}.bind(this),this.options.typeDelay)}}});return d});define("DS/W3DXComponents/IdCard",["UWA/Core","UWA/Event","UWA/Array","UWA/Utils","UWA/Class","UWA/Class/View","UWA/Class/Model","UWA/Class/Debug","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu","DS/UIKIT/Native/Dropdown","DS/UIKIT/Input/Text","DS/CefCommunication/CefCommunication","i18n!DS/W3DXComponents/assets/nls/IdCard","css!DS/W3DXComponents/W3DXComponents"],function(j,v,B,x,l,G,z,e,q,i,c,u,E,o){var f=10,r=38,J=400,y=28,t=10,D=38,h=38+t,w=0.25,k=0.4,p={view:0,edit:1},b={menu:0,list:1},H="bottom",K=["title","banner","thumbnail"],n=x.Client.Features.touchEvents,I=/translateX\((([0-9\.\-]+)(?:px)*?)\)/,a=0.1;function C(M,Q,N,L){var P=M[Q],O=j.typeOf(P);switch(O){case"function":return P.apply(N,L);case"class":return P;default:if(P instanceof l){return P}else{return j.clone(P)}}}function d(L,N){if(L){var M=L.getParent();if(M){if(N){M.replaceChild(N,L)}else{L.destroy()}return L}}return false}function m(L){target=v.getElement(L);if(target&&target!==viewMoreBtn.elements.container){this._viewMoreModal.hide()}}var F=i.extend({defaultOptions:{bound:false,position:"",removeOnHide:false},_onWindowClick:function(M){var L=this.options.menuIcon,N=v.getElement(M);if(N===L||N.isInjected(L)){M.stopPropagation();this.toggle()}else{this.hide()}},init:function(){this._parent.apply(this,arguments);this._onWindowClick=this._onWindowClick.bind(this);this.options.menuIcon.addEvent("click",this._onWindowClick);this.addEvents({onShow:function(){j.extendElement(document.body).addEvent("click",this._onWindowClick)},onHide:function(){j.extendElement(document.body).removeEvent("click",this._onWindowClick)}})}});var s=z.extend({defaults:{actions:null,facets:null,banner:null,thumbnail:null,title:null,ownerName:null,date:null,description:null,editView:null,editViewOptions:null},_retrieve:function(N,P){var O,M,L=void 0;if(typeof(N)==="string"&&P&&typeof(P)==="object"){O=N.split("->",2);M=O.length;if(M>1){L=this._retrieve(O[1],P[O[0]])}else{if(M===1){L=P[N]}}}return L},get:function(L){return this._retrieve(L,this._attributes)},init:function(M,L){if(L&&L.idCard){this._idCard=L.idCard}else{throw new Error("ID card instance could not be found.")}return this._parent.apply(this,arguments)},destroy:function(){this._idCard=null;this.removeEvents();this.stopListening()},"onChange:actions":function(L,M){if(!this._idCard._useNativeActionMenu()&&(j.typeOf(M)==="array")&&(M.length>f)){console.warn("The total of action buttons in the header should not exceed "+f+"!")}}});var A=G.extend({_rendered:false,_controls:null,_createContent:function(){return""},_registerControl:function(L,M){if(typeof L==="string"){if(this._controls[L]){this._controls[L].destroy()}this._controls[L]=M;return M}else{throw new Error("Invalid arguments!")}},_unregisterControl:function(L){if(typeof L==="string"){if(this._controls[L]){this._controls[L].destroy();delete this._controls[L]}}else{throw new Error("Invalid arguments!")}},init:function(){this._controls={};return this._parent.apply(this,arguments)},render:function(){this.container.setContent(this._createContent());this._rendered=true;return this},inject:function(){if(!this._rendered){this.render()}return this._parent.apply(this,arguments)},destroy:function(){var M,L=null,N=this._controls;for(L in N){if(N.hasOwnProperty(L)){N[L].destroy();delete N[L]}}this.stopListening();this.dispatchEvent("onDestroy",[this]);M=this._parent();this.options=null;this.container=null;this.tagName=null;this.className=null;this.attributes=null;this.domEvents=null;return M}}),g=A.extend({_config:null,_attributesMapping:null,_collapsed:false,_folded:false,_minimized:false,_facetsLikeTabs:true,_editableElements:K,_selectedFacet:null,_selectedFacetName:null,_previouslySelectedFacetName:null,_mode:p.view,_actionsLayout:b.menu,_facetsLayout:b.menu,_transitioning:false,_inDOM:false,_facetsScrollToLeft:0,_nativeActionMenu:false,model:null,tagName:"div",className:"id-card without-banner without-thumbnail",domEvents:{resize:"_onResize","keyup .title-section > input":"_onTitleChangeRequest","click .banner-section .fonticon-pencil":"_onBannerChangeRequest","click .thumbnail-section .fonticon-pencil":"_onThumbnailChangeRequest"},_useNativeActionMenu:function(){return(this._nativeActionMenu===true)&&E.isAvailable()},_getModelAttribute:function(Q,N){if(!Q&&!N){throw new Error("Attribute name and getter are both missing!")}var M,P=this.model,L=this._attributesMapping,O=(L&&L[Q])||Q;if(!N){if(typeof(O)==="function"){N=O}else{N=P.get}}M=N.call(P,O);if(!j.typeOf(M)){return""}else{return(M+"")}},_createTitleSection:function(){return{"class":"title-section",html:{tag:"h1",html:[{tag:"span",html:this._config.get("title")}]}}},_createList:function(O,ae){if(!O){throw new Error("List type argument is missing")}var X,ab,ac,af=this,U=O+"s",R=null,M=null,Z=[],Y=[],S,L,aa,ag,P,ad=this._facetsLikeTabs,V,N=null;L=j.clone(this._config.get(U));if(L&&(L.length>0||((O==="action")&&this._useNativeActionMenu()))){Y=[];Z=[];if(O==="facet"){ag=this.getSelectedFacet();switch(j.typeOf(ag)){case"number":P=function(aj,ai){return(ag===ai)?"selected":""};break;case"string":P=function(ai){return(ag===ai)?"selected":""};break;default:P=function(){return""};break}}for(ab=0,ac=L.length;ab<ac;ab++){X=L[ab];aa=false;if(!X.icon||!X.text){aa=true;S=""}else{if(O==="facet"){S=this._getFacetValue(X);if((ad===false)&&!S){aa=true}}else{S=""}}X.hidden=aa;if(X.handler){V=(function(){var ak=X.name||ab,ai=O,aj=X.handler;return function(al){if(ai==="facet"){this.selectFacet(ak)}else{aj.call(this);this.dispatchEvent("onActionSelect",[ak])}}})().bind(this)}else{V=null}if(ae!==b.list){Y.push({className:O+(aa?" hidden":""),text:(X.text?(X.text+(S?" | ":"")):"")+(S||""),icon:"fonticon fonticon-"+X.icon,selectable:(O==="facet"),handler:(V?V:null)})}if(ae!==b.menu){if(O==="action"){X.listElt=j.createElement("span",{"class":O+" interactive"+(aa?" hidden":""),html:{tag:"span","class":"fonticon fonticon-"+X.icon},events:(V?{click:V}:null)})}else{N=j.createElement("span",{"class":"fonticon fonticon-"+X.icon});X.listElt=j.createElement("div",j.merge(X.name?{"data-name":X.name}:{},{"class":O+(aa?" hidden":"")+(V?"":" idc-disabled ")+" interactive "+((ad!==false)?" tab-behavior":"")+(" "+P(X.name,ab)),html:[N,((ad!==false)?{tag:"span","class":"facet-label",html:X.text}:""),((ad!==false)&&X.text&&S?{tag:"span","class":"facet-text-separator",html:"|"}:""),(S?{tag:"span","class":"facet-count",html:S}:"")],"data-position":""+ab,events:(V?{click:V}:null)}))}Z.push(X.listElt);if(!n){this._registerControl(O+"Tooltip"+ab,new q({target:((ad===false)||(O==="action"))?X.listElt:N,body:X.text,position:H}))}}}if(ae!==b.menu){R=j.createElement("div",{"class":O+"s-list",html:Z})}if(ae!==b.list){var ah=null,Q=null,T=null,W=j.createElement("div",{"class":"menu-icon-wrapper interactive",html:{"class":"fonticon "+((O==="action")?"fonticon-down-open":"fonticon-menu-dot")},events:(O==="action")?{click:function(){af.dispatchEvent("onActionMenuIconClick",[W,af,Q])}}:null});if((O==="action")&&this._useNativeActionMenu()){T=c;ah=W}else{T=F}Q=this._registerControl(O+"sMenu",new T({items:Y,menuIcon:W,target:ah}));if(O==="facet"){Q.addEventOnce("onShow",function(){var ai=af.getSelectedFacet();if(j.is(ai)){af._highlightFacet(af._getFacetElt(ai,true))}})}Q.elements.container.getElements(".item").forEach(function(ak,ai){var aj={"data-position":ai};if(L[ai].name){aj["data-name"]=L[ai].name}ak.set(aj)});M=j.createElement("div",{"class":O+"s-menu",html:[W,Q]})}this._config.set(U+"WithExtraData",L);return(R?(M?[R,M]:R):(M?M:null))}else{return null}},_createBannerSection:function(){var L=this._config.get("banner->url"),M;if(L){M=j.createElement("span",{"class":"fonticon fonticon-pencil interactive"});if(!n){this._registerControl("bannerEditTooltip",new q({target:M,body:o.Change,position:H}))}return{"class":"banner-section"+(this._config.get("banner->alwaysEditable")===true?" edit-mode":""),html:[{"class":"banner",styles:{"background-image":"url('"+L+"')"}},M]}}else{return{"class":"banner-section"}}},_createThumbnailSection:function(){var M=this._config.get("thumbnail->url"),L;if(M){L=j.createElement("span",{"class":"fonticon fonticon-pencil interactive"});if(!n){this._registerControl("thumbnailEditTooltip",new q({target:L,body:o.Change,position:H}))}return{"class":"thumbnail-section"+(this._config.get("thumbnail->alwaysEditable")===true?" edit-mode":""),html:[{"class":"thumbnail"+(this._config.get("thumbnail->squareFormat")===true?" square-format":""),styles:{"background-image":"url('"+M+"')"}},L]}}else{return{"class":"thumbnail-section"}}},_createActionsSection:function(){return{"class":"actions-section",html:this._createList("action",this._useNativeActionMenu()?"menu":undefined)}},_createHeaderSection:function(){return{"class":"header-section",html:[this._createTitleSection(),this._createActionsSection()]}},_createDetailedInfoSection:function(){var L=this._config.get("date"),O=this._config.get("ownerName"),N=this._config.get("description"),M=this._config.get("publicationText");return{"class":"detailed-info-section",html:[{"class":"owner-name-section",html:[(M&&O?{tag:"span","class":"text-muted",html:M}:""),(O?{tag:"span","class":"text-primary",html:O}:""),(L?{tag:"span","class":"text-muted",html:(O?" : ":"")+L}:"")]},(N?{"class":"description-section",html:N}:null)]}},_createMainSection:function(){return{"class":"main-section",html:{"class":"info-and-thumbnail-section",html:[this._createThumbnailSection(),{"class":"info-section",html:[this._createHeaderSection(),this._createDetailedInfoSection()]}]}}},_createFacetsSection:function(){var M={"class":"facets-section",html:{"class":"facets",html:this._createList("facet")}};var N=false,L=this._config.get("facetsWithExtraData");if(!L){N=true}else{if(this._facetsLikeTabs&&(L.length<=1)){N=true}else{N=!L.some(function(O){return !O.hidden})}}if(N===true){this.container.addClassName("without-facets")}else{this.container.removeClassName("without-facets")}return M},_refreshSection:function(Q){var N,M=null,P=undefined,O=this.elements,L=Q+"Section";if(O[L]){switch(Q){case"actions":for(P in this._controls){if(this._controls.hasOwnProperty(P)&&(P.indexOf("actionTooltip")===0)){this._unregisterControl(P)}}break;case"facets":for(P in this._controls){if(this._controls.hasOwnProperty(P)&&(P.indexOf("facetTooltip")===0)){this._unregisterControl(P)}}break;default:break}N=this["_create"+Q.ucfirst()+"Section"]();if(N){M=j.createElement("div",N)}d(O[L],M);if(!M){delete O[L]}else{O[L]=M}switch(Q){case"actions":this._adaptActionsLayout();break;case"facets":this._facetsScrollToLeft=0;this._adaptFacetsLayout();break;default:break}}},_handleFacetsVisibility:function(T,Q,N,U){var S=false,M=[],P=0,O=N.getElements(".facet:not(.hidden)"),R=this.container.hasClassName("facets-as-list"),L=Math.floor((T-(R?0:D))/h);if(!j.is(Q,"number")){throw new Error('"facetsScrollToLeft" is supposed to be a number')}if(!N){N=this.getElement(".facets-list")}if(!j.is(U,"number")){U=Math.ceil((N.getSize().width-Q-T+(R?0:D))/h)}P=Math.max(0,O.length-L-U);if((U>0)||(P>0)){S=true;if(P>0){M=O.slice(0,P)}if(U>0){M=M.concat(O.reverse().slice(0,U))}}O.forEach(function(V){if(M.indexOf(V)<0){V.removeClassName("resp-hidden")}else{V.addClassName("resp-hidden")}});return S},_getMinimumScrollForFacetEltToBeVisible:function(M,N){var P,L,O=0;if(!N){N=this.getElement(".facets-list")}if(this.container&&this._inDOM===true){L=Math.round(M.getPosition(this.elements.facetsSection,"left").x);if(L<=0){O=L}else{L=this.elements.facetsSection.getSize().width-L-h;P=D;if(L>=P){O=0}else{O=Math.ceil((P-L)/h)*h}}}return O},_scrollFacetSectionToFacetElt:function(L,N){var M;if(!N){N=this.getElement(".facets-list")}if(this.container&&this._inDOM===true){if(!L){M=N.style.transform;if(M){M=M.match(I)}if(M){this._facetsScrollToLeft=+M[2]}else{this._facetsScrollToLeft=0}}else{this._facetsScrollToLeft=Math.round(L.getPosition(this.elements.facetsSection,"left").x)+this._facetsScrollToLeft}if(x.Client.Platform.ios){N.style["-webkit-transform"]="translateX(-"+this._facetsScrollToLeft+"px)"}N.style.transform="translateX(-"+this._facetsScrollToLeft+"px)"}},_scrollFacetSectionAndHandleFacetsVisibility:function(O,T){var R=false,S=0,U,P=O.getElement(".facet.selected"),M=P,L,Q,N;if(P){if(!P.hasClassName("resp-hidden")&&(T>=(h*3+D))){Q=P;do{Q=Q.previousElementSibling}while(Q&&Q.hasClassName("hidden"));if(Q&&Q.hasClassName("resp-hidden")){M=Q}else{L=P;do{L=L.nextElementSibling}while(L&&L.hasClassName("hidden"));if(L){M=L}}}S=this._getMinimumScrollForFacetEltToBeVisible(M,O)}U=(O.getSize().width-(this._facetsScrollToLeft+S)-T+(this.container.hasClassName("facets-as-list")?0:D))/h;N=Math.abs(U-Math.floor(U));if(N<=a){U=Math.max(0,Math.floor(U))}else{U=Math.max(0,Math.ceil(U))}R=this._handleFacetsVisibility(T,this._facetsScrollToLeft+S,O,U);this._scrollFacetSectionToFacetElt(O.getElement(".facet:not(.resp-hidden):not(.hidden)"),O);return R},_adaptSectionLayout:function(L){var O=L.type,Q=this.getElement("."+O+"s-list");if(!Q){return false}var N,M=Q.getSize(),R="_"+O+"sLayout",S=Q.hasClassName("minimized"),P=j.is(L.maxWidth)?L.maxWidth:(L.containerWidth*L.maxWidthInPercent);if(M.width<Math.floor(P)){N=false;this[R]=b.list;this.container.addClassName(O+"s-as-list");if(O==="facet"){if(S){Q.removeClassName("without-counts");if(Q.getSize().width>P){Q.addClassName("without-counts")}else{Q.removeClassName("minimized");if(Q.getSize().width>P){Q.addClassName("minimized")}}if(this._facetsLikeTabs!==false){N=this._scrollFacetSectionAndHandleFacetsVisibility(Q,P)}}else{if(this._facetsLikeTabs!==false){this._handleFacetsVisibility(P,0,Q,0)}}}}else{N=true;if(M.width>r){this[R]=b.menu;this.container.removeClassName(O+"s-as-list")}if((O==="facet")&&(this._facetsLikeTabs!==false)){if(!Q.hasClassName("without-counts")){if(!S){Q.addClassName("minimized")}if((P===0)||(Q.getSize().width>P)){Q.addClassName("without-counts")}}N=this._scrollFacetSectionAndHandleFacetsVisibility(Q,P)}}if(N){if(M.width>r){this[R]=b.menu;this.container.removeClassName(O+"s-as-list")}}else{this[R]=b.list;this.container.addClassName(O+"s-as-list")}return true},_adaptActionsLayout:function(){var Q,S,M,P,L,N=this.container,R=w,O=this.getElement(".actions-list"),T=this.getElement(".header-section");if(!T||!O){return false}P=T.getSize().width;S=O.getSize().width;if(S>(R*P)){if(this._actionsLayout===b.list){N.addClassName("with-priority-title")}Q=this.getElement(".title-section h1");L=Q.getSize().height;M=0;Q.getElements("span").forEach(function(U){M+=U.getSize().width});R=1-(M/P);if(L>y&&R>k){R=k}}else{N.removeClassName("with-priority-title")}return this._adaptSectionLayout({type:"action",maxWidthInPercent:R,containerWidth:P})},_adaptFacetsLayout:function(){var L=this.getElement(".facets");if(L){return this._adaptSectionLayout({type:"facet",maxWidthInPercent:1,containerWidth:L.getSize().width})}},_makeTransition:function(L,N){var M=this;this._transitioning=true;this.container.addClassName("transitioning");L.call(this);this._transitioning=false;setTimeout(function(){if((M._transitioning===false)&&M.container){M.container.removeClassName("transitioning")}},N);return this},_handleImagesDisplay:function(){if(this.container.getSize().width<=J){this.container.addClassName("small-size-id-card");this.container.addClassName("without-banner");this.container.addClassName("without-thumbnail")}else{this.container.removeClassName("small-size-id-card");if(!this._minimized&&!this._collapsed&&!this._folded){if(this._config.get("thumbnail->url")){this.container.removeClassName("without-thumbnail")}else{this.container.addClassName("without-thumbnail")}if(this._config.get("banner->url")){this.container.removeClassName("without-banner")}else{this.container.addClassName("without-banner")}}}},_getFacet:function(L){var N=null,M=this._config.get("facets");if(M&&M.length>0){switch(j.typeOf(L)){case"string":N=M.detect(function(O){return(O.name===L)});break;case"number":N=M[L];break;default:throw new Error("Invalid facet key!")}}return N},_getFacetElt:function(N,O){var L=null,M=j.typeOf(N);if(O!==true){O=false}switch(M){case"string":case"number":L=this.getElement(".facets-"+(O?"menu":"list")+" .facet[data-"+(M==="string"?"name":"position")+'="'+N+'"]');break;default:throw new Error("Invalid facet key!")}return L},_getFacetValue:function(M){var L="";if(M&&(M.attribute||M.getter)){L=this._getModelAttribute(M.attribute,M.getter)}return L},_getFacetName:function(M){var L=null;if(M){L=M.name;if(!L){L=[];if(M.text){L.push("t_"+M.text)}if(M.icon){L.push("i_"+M.icon)}L=L.join("&");if(L){L=x.getCheckSum(L)}}}if(!L){L=x.getUUID()}return L},_setConfig:function(N){var M=this.model,O={},L=this.options;N.forEach(function(P){O[P]=C(L,P,M)});if(N.indexOf("bannerUrl")>-1){O.banner=j.merge(O.banner||{},{url:O.bannerUrl});delete O.bannerUrl}if(N.indexOf("thumbnailUrl")>-1){O.thumbnail=j.merge(O.thumbnail||{},{url:O.thumbnailUrl});delete O.thumbnailUrl}["title","ownerName","date","description"].forEach(function(P){O[P]=this._getModelAttribute(P)},this);if(j.is(O.facets,"array")){O.facets.forEach(function(P){P.value=this._getFacetValue(P)},this)}this._config.set(O);return this},_onResize:function(){if(this._rendered&&(this.container.getSize().width>0)){this._handleImagesDisplay();if(!this._useNativeActionMenu()){this._adaptActionsLayout()}this._adaptFacetsLayout()}},onInjected:function(){if(this.container){this._inDOM=true;this._onResize();this.container.addClassName("ready")}},_highlightFacet:function(M){if(M){var L,N,O=M.hasClassName("item"),P=this.getElements(".facet.selected");if(P.some(function(Q){return Q===M})){return false}else{P.forEach(function(Q){Q.removeClassName("selected")})}M.addClassName("selected");L=parseInt(M.getAttribute("data-position"),10);N=this._getFacetElt(L,!O);if(N){N.addClassName("selected")}}else{console.warn("The facet element to highlight could not be found")}return this},_injectEditView:function(L,M){var N=this._registerControl("editView",new L(j.merge({model:this.model},this._config.get("editViewOptions"))));N.render();N.inject(M);return N},_onTitleChangeRequest:function(M){var L=this._controls.titleInput;if(L){this.dispatchEvent("onTitleChangeRequest",[L.getValue(),this])}},_onBannerChangeRequest:function(L){this.dispatchEvent("onBannerChangeRequest",[this])},_onThumbnailChangeRequest:function(L){this.dispatchEvent("onThumbnailChangeRequest",[this])},_createContent:function(){return[this._createBannerSection(),this._createMainSection(),this._createFacetsSection()]},init:function(N){var L,O,P,M=N&&N.model;if(!M){throw new Error("Model is missing")}if(!this._attributesMapping){this._attributesMapping={}}this._config=new s({},{idCard:this});this.listenTo(N.model,"onChange",this.render);L=this._refreshSection;O=L.bind(this,"title");P=L.bind(this,"detailedInfo");this.listenTo(this._config,{"onChange:title":O,"onChange:date":P,"onChange:ownerName":P,"onChange:description":P,"onChange:facets":L.bind(this,"facets"),"onChange:actions":L.bind(this,"actions"),"onChange:banner":L.bind(this,"banner"),"onChange:thumbnail":L.bind(this,"thumbnail")});["folded","collapsed","minimized","facetsLikeTabs","editableElements","attributesMapping","nativeActionMenu"].forEach(function(Q){if(N.hasOwnProperty(Q)){this["_"+Q]=C(N,Q,M)}},this);this.addEventOnce("onRender",function(){var R=this,Q=C(N,"selectedFacet",M);if(!j.is(this._selectedFacet)){R.selectFacet(Q)}if(this._folded===true){this._folded=false;this.fold()}if(this._collapsed===true){this._collapsed=false;this.collapse()}if(this._minimized){this._minimized=false;this.minimize()}});this._parent.apply(this,arguments);this.dispatchEvent("onInit",[this,N])},setOptions:function(L,M){if(L){var N={};if(j.is(M)&&(typeof(L)==="string")){N[L]=M}else{N=L}this._parent(N);this._setConfig(Object.keys(N))}return this},setup:function(L){return this.setOptions(j.merge(j.clone(L,false),this.options))},render:function(){if(!this._rendered){this._parent()}else{this.setOptions(this.options)}this.dispatchEvent("onRender",[this]);return this},onRender:function(){this.selectFacet(this._selectedFacet);if(this._mode===p.edit){this.switchToEditMode()}["title","actions","facets","banner","thumbnail","detailed-info"].forEach(function(M){var L=M.camelCase()+"Section";this.elements[L]=this.getElement("."+M+"-section");if(!this.elements[L]){delete this.elements[L]}},this);if(this._mode===p.edit){this._mode=p.view;this.switchToEditMode()}this._onResize();return this},minimize:function(){if(!this._minimized){this._minimized=true;this.container.addClassName("without-banner");this.container.addClassName("without-thumbnail");this.container.addClassName("minimized")}return this},maximize:function(){if(this._minimized){this._minimized=false;this._handleImagesDisplay();this.container.removeClassName("minimized")}return this},isMinimized:function(){return this._minimized},selectFacet:function(M,P){if(!j.is(M,"number")&&!j.is(M,"string")){return false}var L,O=M,Q=this._getFacet(O),N=this.getSelectedFacet();if(!j.is(N)&&!Q){O=0;Q=this._getFacet(O)}if(!Q){return false}if(this._facetsLikeTabs!==false){L=this._getFacetElt(O);if(!L&&!this._rendered){this.setOption("selectedFacet",M);return this}if(this._highlightFacet(L)){this._selectedFacet=L.getAttribute("data-name")||parseInt(L.getAttribute("data-position"),10);this._previouslySelectedFacetName=this._selectedFacetName;this._selectedFacetName=this._getFacetName(Q);this._adaptFacetsLayout()}else{return this}}if(!(P&&P.silent===true)&&((this._previouslySelectedFacetName!==this._selectedFacetName)||(this._facetsLikeTabs===false))){Q.handler.call(this);this.dispatchEvent("onFacetSelect",[this._selectedFacet,N])}return this},getSelectedFacet:function(){return this._selectedFacet},collapse:function(){if(!this._collapsed&&(this._mode===p.view)){this._collapsed=true;this.container.addClassName("without-banner");this.container.addClassName("without-thumbnail");this.container.addClassName("collapsed")}return this},expand:function(){if(this._collapsed){this._collapsed=false;this._handleImagesDisplay();this.container.removeClassName("collapsed")}return this},isCollapsed:function(){return this._collapsed},fold:function(){this._makeTransition(function(){if(!this._folded&&(this._mode===p.view)){this._folded=true;this.container.addClassName("without-banner");this.container.addClassName("without-thumbnail");this.container.addClassName("folded")}},200);return this},unfold:function(){this._makeTransition(function(){if(this._folded){this._folded=false;this._handleImagesDisplay();this.container.removeClassName("folded")}},300);return this},isFolded:function(){return this._folded},switchToEditMode:function(){if(this._mode!==p.edit){var P,R=this,Q=this.model,T=this._folded,N=this._collapsed,U=this._editableElements,O=this.elements.bannerSection,L=this.getElement(".title-section"),V=this.elements.thumbnailSection,M=this._config.get("editView"),S=j.typeOf(M);if(B.isArray(U)&&U.length>0){if(T){this.unfold()}if(N){this.expand()}this._mode=p.edit;this.container.addClassName("edit-mode");this.stopListening(Q,"onChange",this.render);if(L&&(U.indexOf("title")>=0)){L.addClassName("edit-mode");switch(S){case"class":this._injectEditView(M,L);break;case"string":require([M],function(W){R._injectEditView(W,L)});break;default:P=this._registerControl("titleInput",new u({value:(this._config.get("title").unescapeHTML()||"")}));P.inject(L);P.focus();break}}if(this._config.get("banner->url")&&(U.indexOf("banner")>=0)){O.addClassName("edit-mode")}if(this._config.get("thumbnail->url")&&(U.indexOf("thumbnail")>=0)){V.addClassName("edit-mode")}if(T===true){this.addEventOnce("onSwitchToViewMode",this.fold)}if(N===true){this.addEventOnce("onSwitchToViewMode",this.collapse)}this.dispatchEvent("onSwitchToEditMode",[this])}}return this},switchToViewMode:function(){if(this._mode!==p.view){var M=this.getElement(".title-section"),L=this.elements.bannerSection,N=this.elements.thumbnailSection;this._mode=p.view;this.container.removeClassName("edit-mode");if(M){this._unregisterControl("titleInput");this._unregisterControl("editView");M.removeClassName("edit-mode")}if(L&&(this._config.get("banner->alwaysEditable")!==true)){L.removeClassName("edit-mode")}if(N&&(this._config.get("thumbnail->alwaysEditable")!==true)){N.removeClassName("edit-mode")}this.render();this.listenTo(this.model,"onChange",this.render);this.dispatchEvent("onSwitchToViewMode",[this])}return this},destroy:function(){this._config.destroy();this._config=null;this._inDOM=false;return this._parent.apply(this,arguments)}});return g});define("DS/W3DXComponents/Views/Layout/CardView",["UWA/Core","UWA/Event","UWA/Element","UWA/Utils/Client","UWA/Class/View","css!DS/W3DXComponents/W3DXComponents"],function(f,h,c,e,b){var i=e.Features;function d(n,m,l,k){if(n==="init"){c.addEvents.call(m,{touchstart:l,mousedown:l,MSPointerDown:l,},undefined,undefined,k)}else{if(n==="start"){c.addEvents.call(m,{touchmove:l,mousemove:l,MSPointerMove:l,touchend:l,touchcancel:l,mouseup:l,MSPointerUp:l},undefined,undefined,k)}else{if(n==="stop"){c.removeEvents.call(m,{touchmove:l,mousemove:l,MSPointerMove:l,touchcancel:l,touchend:l,mouseup:l,MSPointerUp:l})}else{if(n==="destroy"){c.removeEvents.call(m,{touchstart:l,mousedown:l,MSPointerDown:l,touchmove:l,mousemove:l,MSPointerMove:l,touchcancel:l,touchend:l,mouseup:l,MSPointerUp:l})}}}}}function g(l){var k=l.type;return k.indexOf("mouse")!==-1?"mouse":k.indexOf("touch")!==-1?"touch":k.indexOf("ointer")!==-1?"pointer":"none"}function j(k){return(k.type==="touchstart"||h.whichButton(k)===0)}var a=b.extend({tagName:"div",elements:{},className:"cardview",cards:null,_currIndex:1,contWidthCache:null,_eventHandler:null,dragInitEvent:null,dragMoveEvent:null,isDragging:null,dragPositions:[],maxAnimDuration:550,dragThreshold:60,isMuted:false,isTracking:null,isAnimActive:false,transitionProp:"",lastShownIndex:null,defaultOptions:{index:0,cardBackground:"white",bounce:true},init:function(l,k){if(!Array.isArray(l)){throw new Error("Elements must be of type array.")}this._parent(k);this._currIndex=this.options.index;this.cards=this.mapElements(l)},setup:function(l){var m=this,k=m.container;if(i.matrixCSS){m.setPosition=function(o,n){var q=f.is(n.x,"number")?n.x+"px":(n.x||0),p=f.is(n.y,"number")?n.y+"px":(n.y||0);o.setStyle(o.getStyleName("transform",true),"translate3d("+q+","+p+", 0)")}}else{m.setPosition=function(o,n){var q=f.is(n.x,"number")?n.x+"px":(n.x||0),p=f.is(n.y,"number")?n.y+"px":(n.y||0);o.setStyle(o.getStyleName("transform",true),"translate("+q+","+p+")")}}m.transitionProp=k.getStyleName("transform",true);m._parent(l)},render:function(){var k=this;k.buildCards(0,k.cards.length-1);return k},mapElements:function(k){return k.map(function(l){if(l instanceof b){l.render()}return{container:null,content:l,_animCount:0,_isDragged:false,_index:null}})},buildCard:function(l,k){return f.createElement("div",{"class":this.className+"-card",html:l,styles:k})},buildCards:function(s,r){var p=this.cards,q=document.createDocumentFragment(),o=s||0,m=r||0,k=r+1,n;for(;o<=m;o++){n=p[o];n.container=this.buildCard(n.content||null,{backgroundColor:this.options.cardBackground});this.setPosition(n.container,{x:o<=this._currIndex?0:"100%",y:null});n.container.inject(q)}if(p[k]&&p[k].container&&p[k].container.isInjected()){c.inject.call(q,p[k].container,"before")}else{this.container.appendChild(q)}},onPreInject:function(){this.initDragEvents()},getContainerDim:function(){if(!this.container){return 0}return this.container.getDimensions().innerWidth},onDragInit:function(m){if(this.isDragging||!j(m)){return}var l=this,n=l.getContainerDim(),o=l.cards,p=l._currIndex,k=o[p];if(!k){return}l.dragInitEvent={width:l.getContainerDim(),position:h.getPosition(m),time:m.timeStamp,draggedCard:k};d("start",l.container,l._eventHandler);l.contWidthCache=n;l.isTracking=g(m)},onDragMove:function(y){if(!this.dragInitEvent||this.isTracking!==g(y)){return}var q=this,v=q.options,C=h.getPosition(y),l=q.dragInitEvent,A=q.dragMoveEvent,s=l.position,n=q.cards,z=q._currIndex,t=l.width,o=C.x-s.x,p=y.timeStamp,k=false,w,B,m,x,r,u;if(q.isDragging&&A){h.stop(y);w=C.x-(A?q.dragMoveEvent.position.x:0);x=A.draggedCard;B=A.direction;m=(B==="right"||A.bounce?o:t-Math.abs(o));q.setPosition(x.container,{x:m,y:null});f.extend(q.dragMoveEvent,{time:p,position:C,currentDelta:{x:w,y:null}})}else{if(Math.abs(o)>=q.dragThreshold){q.blockScroll();B=o>0?"right":"left";if(B==="right"){r=z+1;x=n[z];u=z}else{r=z-2;x=n[z+1];u=z+1}if((z===0&&B==="right")||(z===n.length-1&&B==="left")){if(!v.bounce){q.resetDragFlags();return}k=true;if(!x){x=n[z];u=z}}x._isDragged=true;q.isDragging=true;q.isAnimActive=true;q.dragMoveEvent={draggedCard:x,index:u,currentPos:{x:m,y:null},position:C,time:p,direction:B||null,bounce:k,currentDelta:{x:w,y:null}};q.throwEvent("onStartDrag",x,{direction:B,index:u},y)}}},onDragStop:function(y){var r=this,D=r.dragInitEvent;if(r.isTracking!==g(y)||!r.isDragging){r.resetDragFlags(D?D.card:null);return}var B=r.dragMoveEvent,x={time:y.timeStamp,position:h.getPosition(y)},u=r.container,E=D.position,w=x.position,A=x.time-D.time,m=D.width,s=B.currentDelta,z=r.calculateSpeed(E,w,A),q=u.getPosition(document.documentElement).x,l=B.draggedCard,t=false,C=B.direction,o=r._currIndex,k=B.bounce,n,p;function v(G){var H=G._index,I,F;if(!k){if((C==="right"&&t)||(C==="left"&&!t)){I=H-1}else{if((C==="left"&&t)||(C==="right"&&!t)){I=H}}}else{I=H;F="onPullCard"}r.isAnimActive=false;if(I!==r.lastShownIndex){r.lastShownIndex=I;F="onShowCard"}if(F){r.throwEvent(F,G,{direction:C,index:I},y)}G._index=null}r.deblockScroll();d("stop",u,r._eventHandler);if(!k){n=r.calculateFinalPosition(s,w,m,q,z);if(n===m&&C==="right"){r.updateIndex("left");t=true}else{if(n===0&&C==="left"){r.updateIndex("right");t=true}}}else{n=0}p=r.calculateTime(n,q,w,z);r.animateCardPosition(l,{x:n,y:null},{duration:Math.min(p,r.maxAnimDuration),cb:v});r.throwEvent("onEndDrag",l,{direction:C,index:C==="right"?o:o+1,didSnap:t},y);r.resetDragFlags(l)},blockScroll:function(){var l=this,k=l.container;k.addEvents({mousemove:h.preventDefault,touchmove:h.preventDefault})},deblockScroll:function(){var l=this,k=l.container;k.removeEvent("mousemove",h.preventDefault);k.removeEvent("touchmove",h.preventDefault)},calculateFinalPosition:function(l,n,k,q,p){var o,m=l.x;if(m>0){if(n.x>=(q+k*0.4)||p>=0.5){o=k}else{o=0}}else{if(m<0){if(n.x<=(q+k*0.6)||p>=0.5){o=0}else{o=k}}else{if(n.x<=(q+k*0.5)){o=0}else{o=k}}}return o},calculateSpeed:function(p,n,k){var m=1.9,l,o;o=Math.abs(p.x-n.x);l=Math.min(o/k,m);return l},throwEvent:function(l,k,n,m){this.dispatchEvent(l,[this,k,n,m])},calculateTime:function(l,n,m,k){return Math.abs(l+n-m)/k},resetDragFlags:function(k){var l=this;l.dragInitEvent=null;l.dragMoveEvent=null;l.isTracking=null;l.isDragging=false;l.dragPositions=[];if(k){k._isDragged=false}},updateShadows:function(){var k=this._currIndex;this.removeShadow(k-1);this.addShadow(k);this.removeShadow(k+2);this.addShadow(k+1)},updateIndex:function(l){var k=this;k._currIndex=l==="left"?k._currIndex-1:k._currIndex+1},removeAnimationStyles:function(k){k.setStyles({transitionDuration:"",transitionProperty:"",perspective:"",fontSmoothing:"",transformOrigin:"",transitionTimingFunction:"",transitionDelay:"",transformStyle:""})},getAnimStyles:function(k,q){var p=this,l=p.container,m=p.transitionProp||l.getStyleName("transform",true),r=k.x||0,o=k.y||0,n={transformOrigin:"0 0",fontSmoothing:"antialiased",perspective:800,transitionDelay:"0ms",transitionDuration:Math.round(q,10)+"ms",transitionProperty:m,transformStyle:"preserve-3d",transitionTimingFunction:"cubic-bezier(0.33, 0.66, 0.66, 1)"};if(i.matrixCSS){n.transform="translate3d("+r+"px, "+o+"px, 0)"}else{n.transform="translate("+r+"px, "+o+"px)"}return n},setPosition:function(){},animateCardPosition:function(n,r,v){var s=this,k=v||{},t=r,q=t.x,p=n.container,o=k.duration||400,u=s.getAnimStyles(t,o),l;function m(){clearTimeout(l);n._animCount--;s.removeAnimationStyles(p);p.removeEvent("transitionEnd");if(n._animCount!==0||n._isDragged){return}n._index=s.cards.indexOf(n);s.setPosition(p,{x:q===s.contWidthCache?"100%":0,y:null});if(f.is(k.cb,"function")){k.cb.call(null,n)}}l=setTimeout(m,s.maxAnimDuration+20);n._animCount++;p.addEvent("transitionEnd",m);p.setStyles(u)},initDragEvents:function(){var l=this,k=l.container;if(!k){throw new Error("Render CardView before injecting.")}k.addEvent("click",function(m){if(l.isAnimActive){h.stop(m);return false}},undefined,undefined,true);l._eventHandler=l._eventHandler||l.handleEvent.bind(l);d("init",k,l._eventHandler,true)},removeDragEvents:function(){var l=this,k=l.container;d("destroy",k,this._eventHandler);k.removeEvents()},handleEvent:function(m){var l=this,k=m.type;switch(k){case"touchstart":case"mousedown":case"MSPointerDown":l.onDragInit(m);break;case"touchmove":case"mousemove":case"MSPointerMove":l.onDragMove(m);break;case"touchend":case"touchcancel":case"mouseup":case"MSPointerUp":l.onDragStop(m);break}},addCards:function(l,t){var q=this,m=t||{},p=m.where||"after",o=q.cards,k=q._currIndex,u=f.is(q.lastShownIndex)?q.lastShownIndex:k,n,s,r;if(!Array.isArray(l)){throw new Error("Elements should be of type Array.")}if(!f.is(p,"number")&&!f.is(p,"string")){throw new Error("Where must be of type string or number.")}if(l.length===0){return}n=q.mapElements(l);switch(p){case"after":s=o.length;o=o.concat(n);r=o.length-1;break;case"before":s=0;o=n.concat(o);r=n.length-1;k+=n.length;u+=n.length;break;default:p=p>(o.length-1)?o.length:p;s=p;o=o.slice(0,p).concat(n).concat(o.slice(p));k=p>k?k:k+p;u=p>u?u:u+p;r=n.length-1}q.cards=o;q._currIndex=k;q.lastShownIndex=u;q.buildCards(s,r)},addEmptyCard:function(k){this.addCards([null],k)},setCardContent:function(m,l){var k=this.cards[l];if(!k){return}if(m instanceof b){m.render()}if(k.content){k.content.destroy()}k.content=m;k.content.inject(k.container.empty())},removeShadow:function(l){var k=this.cards[l];if(!k||!k.container){return}k.container.removeClassName("shadow")},addShadow:function(l){var k=this.cards[l];if(!k||!k.container){return}k.container.addClassName("shadow")},removeCards:function(m,l){if(!f.is(m,"number")||!f.is(l,"number")){throw new Error("Arguments must be of type number.")}else{if(l-m<0){throw new Error("Error with indexes.")}}var k=this.cards.splice(m,l-m);k.forEach(function(n){if(n.content){n.content.destroy()}n.container.destroy()})},getCardAt:function(k){return this.cards[k]||null},mute:function(){if(this.isMuted){return}var l=this,k=l.container;l.isMuted=true;d("destroy",k,l._eventHandler)},unMute:function(){if(!this.isMuted){return}var l=this,k=l.container;l.isMuted=false;d("init",k,l._eventHandler)},destroy:function(){var k=this;k.removeDragEvents();k.stopListening();k.resetDragFlags();k.cards.forEach(function(m){var n=m.content,l=m.container;if(n){n.destroy()}if(l){l.destroy()}});k._parent();k.cards.length=0}});return a});define("DS/W3DXComponents/Views/Temp/TempHandlebars",[],function(){var a=(function(){var b=(function(){var n;function o(p){this.string=p}o.prototype.toString=function(){return""+this.string};n=o;return n})();var l=(function(w){var x={};var q=w;var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var n=/[&<>"'`]/g;var r=/[&<>"'`]/;function z(A){return y[A]||"&amp;"}function v(C,B){for(var A in B){if(Object.prototype.hasOwnProperty.call(B,A)){C[A]=B[A]}}}x.extend=v;var p=Object.prototype.toString;x.toString=p;var o=function(A){return typeof A==="function"};if(o(/x/)){o=function(A){return typeof A==="function"&&p.call(A)==="[object Function]"}}var o;x.isFunction=o;var u=Array.isArray||function(A){return(A&&typeof A==="object")?p.call(A)==="[object Array]":false};x.isArray=u;function t(A){if(A instanceof q){return A.toString()}else{if(!A&&A!==0){return""}}A=""+A;if(!r.test(A)){return A}return A.replace(n,z)}x.escapeExpression=t;function s(A){if(!A&&A!==0){return true}else{if(u(A)&&A.length===0){return true}else{return false}}}x.isEmpty=s;return x})(b);var e=(function(){var o;var p=["description","fileName","lineNumber","message","name","number","stack"];function n(u,t){var r;if(t&&t.firstLine){r=t.firstLine;u+=" - "+r+":"+t.firstColumn}var s=Error.prototype.constructor.call(this,u);for(var q=0;q<p.length;q++){this[p[q]]=s[p[q]]}if(r){this.lineNumber=r;this.column=t.firstColumn}}n.prototype=new Error();o=n;return o})();var j=(function(y,B){var A={};var w=y;var u=B;var D="1.3.0";A.VERSION=D;var o=4;A.COMPILER_REVISION=o;var r={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};A.REVISION_CHANGES=r;var v=w.isArray,q=w.isFunction,p=w.toString,n="[object Object]";function t(F,E){this.helpers=F||{};this.partials=E||{};x(this)}A.HandlebarsEnvironment=t;t.prototype={constructor:t,logger:z,log:s,registerHelper:function(F,G,E){if(p.call(F)===n){if(E||G){throw new u("Arg not supported with multiple helpers")}w.extend(this.helpers,F)}else{if(E){G.not=E}this.helpers[F]=G}},registerPartial:function(E,F){if(p.call(E)===n){w.extend(this.partials,E)}else{this.partials[E]=F}}};function x(E){E.registerHelper("helperMissing",function(F){if(arguments.length===2){return undefined}else{throw new u("Missing helper: '"+F+"'")}});E.registerHelper("blockHelperMissing",function(H,G){var F=G.inverse||function(){},I=G.fn;if(q(H)){H=H.call(this)}if(H===true){return I(this)}else{if(H===false||H==null){return F(this)}else{if(v(H)){if(H.length>0){return E.helpers.each(H,G)}else{return F(this)}}else{return I(H)}}}});E.registerHelper("each",function(F,N){var L=N.fn,H=N.inverse;var J=0,K="",I;if(q(F)){F=F.call(this)}if(N.data){I=C(N.data)}if(F&&typeof F==="object"){if(v(F)){for(var G=F.length;J<G;J++){if(I){I.index=J;I.first=(J===0);I.last=(J===(F.length-1))}K=K+L(F[J],{data:I})}}else{for(var M in F){if(F.hasOwnProperty(M)){if(I){I.key=M;I.index=J;I.first=(J===0)}K=K+L(F[M],{data:I});J++}}}}if(J===0){K=H(this)}return K});E.registerHelper("if",function(G,F){if(q(G)){G=G.call(this)}if((!F.hash.includeZero&&!G)||w.isEmpty(G)){return F.inverse(this)}else{return F.fn(this)}});E.registerHelper("unless",function(G,F){return E.helpers["if"].call(this,G,{fn:F.inverse,inverse:F.fn,hash:F.hash})});E.registerHelper("with",function(G,F){if(q(G)){G=G.call(this)}if(!w.isEmpty(G)){return F.fn(G)}});E.registerHelper("log",function(G,F){var H=F.data&&F.data.level!=null?parseInt(F.data.level,10):1;E.log(H,G)})}var z={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(G,E){if(z.level<=G){var F=z.methodMap[G];if(typeof console!=="undefined"&&console[F]){console[F].call(console,E)}}}};A.logger=z;function s(F,E){z.log(F,E)}A.log=s;var C=function(E){var F={};w.extend(F,E);return F};A.createFrame=C;return A})(l,e);var h=(function(w,A,q){var y={};var v=w;var t=A;var p=q.COMPILER_REVISION;var s=q.REVISION_CHANGES;function o(D){var C=D&&D[0]||1,F=p;if(C!==F){if(C<F){var B=s[F],E=s[C];throw new t("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+B+") or downgrade your runtime to an older version ("+E+").")}else{throw new t("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+D[1]+").")}}}y.checkRevision=o;function x(B,E){if(!E){throw new t("No environment passed to template")}var D=function(G,I,K,L,J,M){var F=E.VM.invokePartial.apply(this,arguments);if(F!=null){return F}if(E.compile){var H={helpers:L,partials:J,data:M};J[I]=E.compile(G,{data:M!==undefined},E);return J[I](K,H)}else{throw new t("The partial "+I+" could not be compiled when running in runtime-only mode")}};var C={escapeExpression:v.escapeExpression,invokePartial:D,programs:[],program:function(G,H,I){var F=this.programs[G];if(I){F=u(G,H,I)}else{if(!F){F=this.programs[G]=u(G,H)}}return F},merge:function(H,G){var F=H||G;if(H&&G&&(H!==G)){F={};v.extend(F,G);v.extend(F,H)}return F},programWithDepth:E.VM.programWithDepth,noop:E.VM.noop,compilerInfo:null};return function(I,G){G=G||{};var J=G.partial?G:E,K,H;if(!G.partial){K=G.helpers;H=G.partials}var F=B.call(C,J,I,K,H,G.data);if(!G.partial){E.VM.checkRevision(C.compilerInfo)}return F}}y.template=x;function r(C,D,E){var B=Array.prototype.slice.call(arguments,3);var F=function(H,G){G=G||{};return D.apply(this,[H,G.data||E].concat(B))};F.program=C;F.depth=B.length;return F}y.programWithDepth=r;function u(B,C,D){var E=function(G,F){F=F||{};return C(G,F.data||D)};E.program=B;E.depth=0;return E}y.program=u;function n(B,D,F,G,E,H){var C={partial:true,helpers:G,partials:E,data:H};if(B===undefined){throw new t("The partial "+D+" could not be found")}else{if(B instanceof Function){return B(F,C)}}}y.invokePartial=n;function z(){return""}y.noop=z;return y})(l,e,j);var g=(function(x,z,p,t,w){var y;var n=x;var q=z;var s=p;var v=t;var r=w;var u=function(){var A=new n.HandlebarsEnvironment();v.extend(A,n);A.SafeString=q;A.Exception=s;A.Utils=v;A.VM=r;A.template=function(B){return r.template(B,A)};return A};var o=u();o.create=u;y=o;return y})(j,b,e,l,h);var k=(function(r){var p;var o=r;function n(s){s=s||{};this.firstLine=s.first_line;this.firstColumn=s.first_column;this.lastColumn=s.last_column;this.lastLine=s.last_line}var q={ProgramNode:function(u,w,t,v){var s,x;if(arguments.length===3){v=t;t=null}else{if(arguments.length===2){v=w;w=null}}n.call(this,v);this.type="program";this.statements=u;this.strip={};if(t){x=t[0];if(x){s={first_line:x.firstLine,last_line:x.lastLine,last_column:x.lastColumn,first_column:x.firstColumn};this.inverse=new q.ProgramNode(t,w,s)}else{this.inverse=new q.ProgramNode(t,w)}this.strip.right=w.left}else{if(w){this.strip.left=w.right}}},MustacheNode:function(x,w,s,u,t){n.call(this,t);this.type="mustache";this.strip=u;if(s!=null&&s.charAt){var v=s.charAt(3)||s.charAt(2);this.escaped=v!=="{"&&v!=="&"}else{this.escaped=!!s}if(x instanceof q.SexprNode){this.sexpr=x}else{this.sexpr=new q.SexprNode(x,w)}this.sexpr.isRoot=true;this.id=this.sexpr.id;this.params=this.sexpr.params;this.hash=this.sexpr.hash;this.eligibleHelper=this.sexpr.eligibleHelper;this.isHelper=this.sexpr.isHelper},SexprNode:function(x,u,s){n.call(this,s);this.type="sexpr";this.hash=u;var w=this.id=x[0];var v=this.params=x.slice(1);var t=this.eligibleHelper=w.isSimple;this.isHelper=t&&(v.length||u)},PartialNode:function(s,u,v,t){n.call(this,t);this.type="partial";this.partialName=s;this.context=u;this.strip=v},BlockNode:function(v,t,s,w,u){n.call(this,u);if(v.sexpr.id.original!==w.path.original){throw new o(v.sexpr.id.original+" doesn't match "+w.path.original,this)}this.type="block";this.mustache=v;this.program=t;this.inverse=s;this.strip={left:v.strip.left,right:w.strip.right};(t||s).strip.left=v.strip.right;(s||t).strip.right=w.strip.left;if(s&&!t){this.isInverse=true}},ContentNode:function(s,t){n.call(this,t);this.type="content";this.string=s},HashNode:function(t,s){n.call(this,s);this.type="hash";this.pairs=t},IdNode:function(y,x){n.call(this,x);this.type="ID";var w="",u=[],z=0;for(var v=0,s=y.length;v<s;v++){var t=y[v].part;w+=(y[v].separator||"")+t;if(t===".."||t==="."||t==="this"){if(u.length>0){throw new o("Invalid path: "+w,this)}else{if(t===".."){z++}else{this.isScoped=true}}}else{u.push(t)}}this.original=w;this.parts=u;this.string=u.join(".");this.depth=z;this.isSimple=y.length===1&&!this.isScoped&&z===0;this.stringModeValue=this.string},PartialNameNode:function(s,t){n.call(this,t);this.type="PARTIAL_NAME";this.name=s.original},DataNode:function(t,s){n.call(this,s);this.type="DATA";this.id=t},StringNode:function(s,t){n.call(this,t);this.type="STRING";this.original=this.string=this.stringModeValue=s},IntegerNode:function(s,t){n.call(this,t);this.type="INTEGER";this.original=this.integer=s;this.stringModeValue=Number(s)},BooleanNode:function(s,t){n.call(this,t);this.type="BOOLEAN";this.bool=s;this.stringModeValue=s==="true"},CommentNode:function(t,s){n.call(this,s);this.type="comment";this.comment=t}};p=q;return p})(e);var c=(function(){var o;var n=(function(){var w={trace:function s(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function r(x,A,B,E,D,z,C){var y=z.length-1;switch(D){case 1:return new E.ProgramNode(z[y-1],this._$);break;case 2:return new E.ProgramNode([],this._$);break;case 3:this.$=new E.ProgramNode([],z[y-1],z[y],this._$);break;case 4:this.$=new E.ProgramNode(z[y-2],z[y-1],z[y],this._$);break;case 5:this.$=new E.ProgramNode(z[y-1],z[y],[],this._$);break;case 6:this.$=new E.ProgramNode(z[y],this._$);break;case 7:this.$=new E.ProgramNode([],this._$);break;case 8:this.$=new E.ProgramNode([],this._$);break;case 9:this.$=[z[y]];break;case 10:z[y-1].push(z[y]);this.$=z[y-1];break;case 11:this.$=new E.BlockNode(z[y-2],z[y-1].inverse,z[y-1],z[y],this._$);break;case 12:this.$=new E.BlockNode(z[y-2],z[y-1],z[y-1].inverse,z[y],this._$);break;case 13:this.$=z[y];break;case 14:this.$=z[y];break;case 15:this.$=new E.ContentNode(z[y],this._$);break;case 16:this.$=new E.CommentNode(z[y],this._$);break;case 17:this.$=new E.MustacheNode(z[y-1],null,z[y-2],p(z[y-2],z[y]),this._$);break;case 18:this.$=new E.MustacheNode(z[y-1],null,z[y-2],p(z[y-2],z[y]),this._$);break;case 19:this.$={path:z[y-1],strip:p(z[y-2],z[y])};break;case 20:this.$=new E.MustacheNode(z[y-1],null,z[y-2],p(z[y-2],z[y]),this._$);break;case 21:this.$=new E.MustacheNode(z[y-1],null,z[y-2],p(z[y-2],z[y]),this._$);break;case 22:this.$=new E.PartialNode(z[y-2],z[y-1],p(z[y-3],z[y]),this._$);break;case 23:this.$=p(z[y-1],z[y]);break;case 24:this.$=new E.SexprNode([z[y-2]].concat(z[y-1]),z[y],this._$);break;case 25:this.$=new E.SexprNode([z[y]],null,this._$);break;case 26:this.$=z[y];break;case 27:this.$=new E.StringNode(z[y],this._$);break;case 28:this.$=new E.IntegerNode(z[y],this._$);break;case 29:this.$=new E.BooleanNode(z[y],this._$);break;case 30:this.$=z[y];break;case 31:z[y-1].isHelper=true;this.$=z[y-1];break;case 32:this.$=new E.HashNode(z[y],this._$);break;case 33:this.$=[z[y-2],z[y]];break;case 34:this.$=new E.PartialNameNode(z[y],this._$);break;case 35:this.$=new E.PartialNameNode(new E.StringNode(z[y],this._$),this._$);break;case 36:this.$=new E.PartialNameNode(new E.IntegerNode(z[y],this._$));break;case 37:this.$=new E.DataNode(z[y],this._$);break;case 38:this.$=new E.IdNode(z[y],this._$);break;case 39:z[y-2].push({part:z[y],separator:z[y-1]});this.$=z[y-2];break;case 40:this.$=[{part:z[y]}];break;case 43:this.$=[];break;case 44:z[y-1].push(z[y]);break;case 47:this.$=[z[y]];break;case 48:z[y-1].push(z[y]);break}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function t(y,x){throw new Error(y)},parse:function v(G){var N=this,D=[0],W=[null],I=[],X=this.table,y="",H=0,U=0,A=0,F=2,K=1;this.lexer.setInput(G);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var z=this.lexer.yylloc;I.push(z);var B=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function M(Z){D.length=D.length-2*Z;W.length=W.length-Z;I.length=I.length-Z}function L(){var Z;Z=N.lexer.lex()||1;if(typeof Z!=="number"){Z=N.symbols_[Z]||Z}return Z}var T,P,C,S,Y,J,R={},O,V,x,E;while(true){C=D[D.length-1];if(this.defaultActions[C]){S=this.defaultActions[C]}else{if(T===null||typeof T=="undefined"){T=L()}S=X[C]&&X[C][T]}if(typeof S==="undefined"||!S.length||!S[0]){var Q="";if(!A){E=[];for(O in X[C]){if(this.terminals_[O]&&O>2){E.push("'"+this.terminals_[O]+"'")}}if(this.lexer.showPosition){Q="Parse error on line "+(H+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[T]||T)+"'"}else{Q="Parse error on line "+(H+1)+": Unexpected "+(T==1?"end of input":"'"+(this.terminals_[T]||T)+"'")}this.parseError(Q,{text:this.lexer.match,token:this.terminals_[T]||T,line:this.lexer.yylineno,loc:z,expected:E})}}if(S[0] instanceof Array&&S.length>1){throw new Error("Parse Error: multiple actions possible at state: "+C+", token: "+T)}switch(S[0]){case 1:D.push(T);W.push(this.lexer.yytext);I.push(this.lexer.yylloc);D.push(S[1]);T=null;if(!P){U=this.lexer.yyleng;y=this.lexer.yytext;H=this.lexer.yylineno;z=this.lexer.yylloc;if(A>0){A--}}else{T=P;P=null}break;case 2:V=this.productions_[S[1]][1];R.$=W[W.length-V];R._$={first_line:I[I.length-(V||1)].first_line,last_line:I[I.length-1].last_line,first_column:I[I.length-(V||1)].first_column,last_column:I[I.length-1].last_column};if(B){R._$.range=[I[I.length-(V||1)].range[0],I[I.length-1].range[1]]}J=this.performAction.call(R,y,U,H,this.yy,S[1],W,I);if(typeof J!=="undefined"){return J}if(V){D=D.slice(0,-1*V*2);W=W.slice(0,-1*V);I=I.slice(0,-1*V)}D.push(this.productions_[S[1]][0]);W.push(R.$);I.push(R._$);x=X[D[D.length-2]][D[D.length-1]];D.push(x);break;case 3:return true}}return true}};function p(x,y){return{left:x.charAt(2)==="~",right:y.charAt(0)==="~"||y.charAt(1)==="~"}}var q=(function(){var A=({EOF:1,parseError:function C(F,E){if(this.yy.parser){this.yy.parser.parseError(F,E)}else{throw new Error(F)}},setInput:function(E){this._input=E;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var F=this._input[0];this.yytext+=F;this.yyleng++;this.offset++;this.match+=F;this.matched+=F;var E=F.match(/(?:\r\n?|\n).*/g);if(E){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return F},unput:function(G){var E=G.length;var F=G.split(/(?:\r\n?|\n)/g);this._input=G+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-E-1);this.offset-=E;var I=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(F.length-1){this.yylineno-=F.length-1}var H=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:F?(F.length===I.length?this.yylloc.first_column:0)+I[I.length-F.length].length-F[0].length:this.yylloc.first_column-E};if(this.options.ranges){this.yylloc.range=[H[0],H[0]+this.yyleng-E]}return this},more:function(){this._more=true;return this},less:function(E){this.unput(this.match.slice(E))},pastInput:function(){var E=this.matched.substr(0,this.matched.length-this.match.length);return(E.length>20?"...":"")+E.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var E=this.match;if(E.length<20){E+=this._input.substr(0,20-E.length)}return(E.substr(0,20)+(E.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var E=this.pastInput();var F=new Array(E.length+1).join("-");return E+this.upcomingInput()+"\n"+F+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var K,I,F,H,G,E;if(!this._more){this.yytext="";this.match=""}var L=this._currentRules();for(var J=0;J<L.length;J++){F=this._input.match(this.rules[L[J]]);if(F&&(!I||F[0].length>I[0].length)){I=F;H=J;if(!this.options.flex){break}}}if(I){E=I[0].match(/(?:\r\n?|\n).*/g);if(E){this.yylineno+=E.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:E?E[E.length-1].length-E[E.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+I[0].length};this.yytext+=I[0];this.match+=I[0];this.matches=I;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(I[0].length);this.matched+=I[0];K=this.performAction.call(this,this.yy,this,L[H],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(K){return K}else{return}}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function x(){var E=this.next();if(typeof E!=="undefined"){return E}else{return this.lex()}},begin:function y(E){this.conditionStack.push(E)},popState:function D(){return this.conditionStack.pop()},_currentRules:function B(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function y(E){this.begin(E)}});A.options={};A.performAction=function z(J,F,I,E){function G(L,K){return F.yytext=F.yytext.substr(L,F.yyleng-K)}var H=E;switch(I){case 0:if(F.yytext.slice(-2)==="\\\\"){G(0,1);this.begin("mu")}else{if(F.yytext.slice(-1)==="\\"){G(0,1);this.begin("emu")}else{this.begin("mu")}}if(F.yytext){return 14}break;case 1:return 14;break;case 2:this.popState();return 14;break;case 3:G(0,4);this.popState();return 15;break;case 4:return 35;break;case 5:return 36;break;case 6:return 25;break;case 7:return 16;break;case 8:return 20;break;case 9:return 19;break;case 10:return 19;break;case 11:return 23;break;case 12:return 22;break;case 13:this.popState();this.begin("com");break;case 14:G(3,5);this.popState();return 15;break;case 15:return 22;break;case 16:return 41;break;case 17:return 40;break;case 18:return 40;break;case 19:return 44;break;case 20:break;case 21:this.popState();return 24;break;case 22:this.popState();return 18;break;case 23:F.yytext=G(1,2).replace(/\\"/g,'"');return 32;break;case 24:F.yytext=G(1,2).replace(/\\'/g,"'");return 32;break;case 25:return 42;break;case 26:return 34;break;case 27:return 34;break;case 28:return 33;break;case 29:return 40;break;case 30:F.yytext=G(1,2);return 40;break;case 31:return"INVALID";break;case 32:return 5;break}};A.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];A.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[3],inclusive:false},INITIAL:{rules:[0,1,32],inclusive:true}};return A})();w.lexer=q;function u(){this.yy={}}u.prototype=w;w.Parser=u;return new u})();o=n;return o})();var m=(function(r,n){var o={};var s=r;var p=n;o.parser=s;function q(t){if(t.constructor===p.ProgramNode){return t}s.yy=p;return s.parse(t)}o.parse=q;return o})(c,k);var f=(function(s){var r={};var n=s;function p(){}r.Compiler=p;p.prototype={compiler:p,disassemble:function(){var y=this.opcodes,x,v=[],A,z;for(var w=0,t=y.length;w<t;w++){x=y[w];if(x.opcode==="DECLARE"){v.push("DECLARE "+x.name+"="+x.value)}else{A=[];for(var u=0;u<x.args.length;u++){z=x.args[u];if(typeof z==="string"){z='"'+z.replace("\n","\\n")+'"'}A.push(z)}v.push(x.opcode+" "+A.join(" "))}}return v.join("\n")},equals:function(u){var t=this.opcodes.length;if(u.opcodes.length!==t){return false}for(var x=0;x<t;x++){var y=this.opcodes[x],v=u.opcodes[x];if(y.opcode!==v.opcode||y.args.length!==v.args.length){return false}for(var w=0;w<y.args.length;w++){if(y.args[w]!==v.args[w]){return false}}}t=this.children.length;if(u.children.length!==t){return false}for(x=0;x<t;x++){if(!this.children[x].equals(u.children[x])){return false}}return true},guid:0,compile:function(t,v){this.opcodes=[];this.children=[];this.depths={list:[]};this.options=v;var w=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(w){for(var u in w){this.options.knownHelpers[u]=w[u]}}return this.accept(t)},accept:function(v){var u=v.strip||{},t;if(u.left){this.opcode("strip")}t=this[v.type](v);if(u.right){this.opcode("strip")}return t},program:function(v){var u=v.statements;for(var w=0,t=u.length;w<t;w++){this.accept(u[w])}this.isSimple=t===1;this.depths.list=this.depths.list.sort(function(y,x){return y-x});return this},compileProgram:function(v){var t=new this.compiler().compile(v,this.options);var w=this.guid++,y;this.usePartial=this.usePartial||t.usePartial;this.children[w]=t;for(var x=0,u=t.depths.list.length;x<u;x++){y=t.depths.list[x];if(y<2){continue}else{this.addDepth(y-1)}}return w},block:function(y){var x=y.mustache,u=y.program,t=y.inverse;if(u){u=this.compileProgram(u)}if(t){t=this.compileProgram(t)}var w=x.sexpr;var v=this.classifySexpr(w);if(v==="helper"){this.helperSexpr(w,u,t)}else{if(v==="simple"){this.simpleSexpr(w);this.opcode("pushProgram",u);this.opcode("pushProgram",t);this.opcode("emptyHash");this.opcode("blockValue")}else{this.ambiguousSexpr(w,u,t);this.opcode("pushProgram",u);this.opcode("pushProgram",t);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}}this.opcode("append")},hash:function(w){var v=w.pairs,y,x;this.opcode("pushHash");for(var u=0,t=v.length;u<t;u++){y=v[u];x=y[1];if(this.options.stringParams){if(x.depth){this.addDepth(x.depth)}this.opcode("getContext",x.depth||0);this.opcode("pushStringParam",x.stringModeValue,x.type);if(x.type==="sexpr"){this.sexpr(x)}}else{this.accept(x)}this.opcode("assignToHash",y[0])}this.opcode("popHash")},partial:function(t){var u=t.partialName;this.usePartial=true;if(t.context){this.ID(t.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",u.name);this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){this.sexpr(t.sexpr);if(t.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ambiguousSexpr:function(x,v,u){var y=x.id,w=y.parts[0],t=v!=null||u!=null;this.opcode("getContext",y.depth);this.opcode("pushProgram",v);this.opcode("pushProgram",u);this.opcode("invokeAmbiguous",w,t)},simpleSexpr:function(t){var u=t.id;if(u.type==="DATA"){this.DATA(u)}else{if(u.parts.length){this.ID(u)}else{this.addDepth(u.depth);this.opcode("getContext",u.depth);this.opcode("pushContext")}}this.opcode("resolvePossibleLambda")},helperSexpr:function(w,u,t){var x=this.setupFullMustacheParams(w,u,t),v=w.id.parts[0];if(this.options.knownHelpers[v]){this.opcode("invokeKnownHelper",x.length,v)}else{if(this.options.knownHelpersOnly){throw new n("You specified knownHelpersOnly, but used the unknown helper "+v,w)}else{this.opcode("invokeHelper",x.length,v,w.isRoot)}}},sexpr:function(u){var t=this.classifySexpr(u);if(t==="simple"){this.simpleSexpr(u)}else{if(t==="helper"){this.helperSexpr(u)}else{this.ambiguousSexpr(u)}}},ID:function(w){this.addDepth(w.depth);this.opcode("getContext",w.depth);var u=w.parts[0];if(!u){this.opcode("pushContext")}else{this.opcode("lookupOnContext",w.parts[0])}for(var v=1,t=w.parts.length;v<t;v++){this.opcode("lookup",w.parts[v])}},DATA:function(v){this.options.data=true;if(v.id.isScoped||v.id.depth){throw new n("Scoped data references are not supported: "+v.original,v)}this.opcode("lookupData");var w=v.id.parts;for(var u=0,t=w.length;u<t;u++){this.opcode("lookup",w[u])}},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,u){this.opcodes.push({opcode:"DECLARE",name:t,value:u})},addDepth:function(t){if(t===0){return}if(!this.depths[t]){this.depths[t]=true;this.depths.list.push(t)}},classifySexpr:function(w){var v=w.isHelper;var x=w.eligibleHelper;var u=this.options;if(x&&!v){var t=w.id.parts[0];if(u.knownHelpers[t]){v=true}else{if(u.knownHelpersOnly){x=false}}}if(v){return"helper"}else{if(x){return"ambiguous"}else{return"simple"}}},pushParams:function(v){var t=v.length,u;while(t--){u=v[t];if(this.options.stringParams){if(u.depth){this.addDepth(u.depth)}this.opcode("getContext",u.depth||0);this.opcode("pushStringParam",u.stringModeValue,u.type);if(u.type==="sexpr"){this.sexpr(u)}}else{this[u.type](u)}}},setupFullMustacheParams:function(v,u,t){var w=v.params;this.pushParams(w);this.opcode("pushProgram",u);this.opcode("pushProgram",t);if(v.hash){this.hash(v.hash)}else{this.opcode("emptyHash")}return w}};function o(v,w,x){if(v==null||(typeof v!=="string"&&v.constructor!==x.AST.ProgramNode)){throw new n("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+v)}w=w||{};if(!("data" in w)){w.data=true}var u=x.parse(v);var t=new x.Compiler().compile(u,w);return new x.JavaScriptCompiler().compile(t,w)}r.precompile=o;function q(t,u,v){if(t==null||(typeof t!=="string"&&t.constructor!==v.AST.ProgramNode)){throw new n("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t)}u=u||{};if(!("data" in u)){u.data=true}var x;function w(){var A=v.parse(t);var z=new v.Compiler().compile(A,u);var y=new v.JavaScriptCompiler().compile(z,u,undefined,true);return v.template(y)}return function(z,y){if(!x){x=w()}return x.call(this,z,y)}}r.compile=q;return r})(e);var i=(function(v,y){var x;var n=v.COMPILER_REVISION;var r=v.REVISION_CHANGES;var s=v.log;var t=y;function p(A){this.value=A}function z(){}z.prototype={nameLookup:function(D,B){var C,A;if(D.indexOf("depth")===0){C=true}if(/^[0-9]+$/.test(B)){A=D+"["+B+"]"}else{if(z.isValidJavaScriptVariableName(B)){A=D+"."+B}else{A=D+"['"+B+"']"}}if(C){return"("+D+" && "+A+")"}else{return A}},compilerInfo:function(){var B=n,A=r[B];return"this.compilerInfo = ["+B+",'"+A+"'];\n"},appendToBuffer:function(A){if(this.environment.isSimple){return"return "+A+";"}else{return{appendToBuffer:true,content:A,toString:function(){return"buffer += "+A+";"}}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(A,C,E,D){this.environment=A;this.options=C||{};s("debug",this.environment.disassemble()+"\n\n");this.name=this.environment.name;this.isChild=!!E;this.context=E||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.compileChildren(A,C);var G=A.opcodes,F;this.i=0;for(var B=G.length;this.i<B;this.i++){F=G[this.i];if(F.opcode==="DECLARE"){this[F.name]=F.value}else{this[F.opcode].apply(this,F.args)}if(F.opcode!==this.stripNext){this.stripNext=false}}this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new t("Compile completed with content left on stack")}return this.createFunctionContext(D)},preamble:function(){var A=[];if(!this.isChild){var B=this.namespace;var C="helpers = this.merge(helpers, "+B+".helpers);";if(this.environment.usePartial){C=C+" partials = this.merge(partials, "+B+".partials);"}if(this.options.data){C=C+" data = data || {};"}A.push(C)}else{A.push("")}if(!this.environment.isSimple){A.push(", buffer = "+this.initializeBuffer())}else{A.push("")}this.lastContext=0;this.source=A},createFunctionContext:function(E){var G=this.stackVars.concat(this.registers.list);if(G.length>0){this.source[1]=this.source[1]+", "+G.join(", ")}if(!this.isChild){for(var D in this.context.aliases){if(this.context.aliases.hasOwnProperty(D)){this.source[1]=this.source[1]+", "+D+"="+this.context.aliases[D]}}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.pushSource("return buffer;")}var H=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var C=0,A=this.environment.depths.list.length;C<A;C++){H.push("depth"+this.environment.depths.list[C])}var F=this.mergeSource();if(!this.isChild){F=this.compilerInfo()+F}if(E){H.push(F);return Function.apply(this,H)}else{var B="function "+(this.name||"")+"("+H.join(",")+") {\n  "+F+"}";s("debug",B+"\n\n");return B}},mergeSource:function(){var E="",C;for(var D=0,A=this.source.length;D<A;D++){var B=this.source[D];if(B.appendToBuffer){if(C){C=C+"\n    + "+B.content}else{C=B.content}}else{if(C){E+="buffer += "+C+";\n  ";C=undefined}E+=B+"\n  "}}return E},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var A=["depth0"];this.setupParams(0,A);this.replaceStack(function(B){A.splice(1,0,B);return"blockHelperMissing.call("+A.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var B=["depth0"];this.setupParams(0,B);var A=this.topStack();B.splice(1,0,A);this.pushSource("if (!"+this.lastHelper+") { "+A+" = blockHelperMissing.call("+B.join(", ")+"); }")},appendContent:function(A){if(this.pendingContent){A=this.pendingContent+A}if(this.stripNext){A=A.replace(/^\s+/,"")}this.pendingContent=A},strip:function(){if(this.pendingContent){this.pendingContent=this.pendingContent.replace(/\s+$/,"")}this.stripNext="strip"},append:function(){this.flushInline();var A=this.popStack();this.pushSource("if("+A+" || "+A+" === 0) { "+this.appendToBuffer(A)+" }");if(this.environment.isSimple){this.pushSource("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression";this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(A){if(this.lastContext!==A){this.lastContext=A}},lookupOnContext:function(A){this.push(this.nameLookup("depth"+this.lastContext,A,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"';this.replaceStack(function(A){return"typeof "+A+" === functionType ? "+A+".apply(depth0) : "+A})},lookup:function(A){this.replaceStack(function(B){return B+" == null || "+B+" === false ? "+B+" : "+this.nameLookup(B,A,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(A,B){this.pushStackLiteral("depth"+this.lastContext);this.pushString(B);if(B!=="sexpr"){if(typeof A==="string"){this.pushString(A)}else{this.pushStackLiteral(A)}}},emptyHash:function(){this.pushStackLiteral("{}");if(this.options.stringParams){this.push("{}");this.push("{}")}},pushHash:function(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:[],types:[],contexts:[]}},popHash:function(){var A=this.hash;this.hash=this.hashes.pop();if(this.options.stringParams){this.push("{"+A.contexts.join(",")+"}");this.push("{"+A.types.join(",")+"}")}this.push("{\n    "+A.values.join(",\n    ")+"\n  }")},pushString:function(A){this.pushStackLiteral(this.quotedString(A))},push:function(A){this.inlineStack.push(A);return A},pushLiteral:function(A){this.pushStackLiteral(A)},pushProgram:function(A){if(A!=null){this.pushStackLiteral(this.programExpression(A))}else{this.pushStackLiteral(null)}},invokeHelper:function(E,B,A){this.context.aliases.helperMissing="helpers.helperMissing";this.useRegister("helper");var C=this.lastHelper=this.setupHelper(E,B,true);var F=this.nameLookup("depth"+this.lastContext,B,"context");var D="helper = "+C.name+" || "+F;if(C.paramsInit){D+=","+C.paramsInit}this.push("("+D+",helper ? helper.call("+C.callParams+") : helperMissing.call("+C.helperMissingParams+"))");if(!A){this.flushInline()}},invokeKnownHelper:function(C,A){var B=this.setupHelper(C,A);this.push(B.name+".call("+B.callParams+")")},invokeAmbiguous:function(A,E){this.context.aliases.functionType='"function"';this.useRegister("helper");this.emptyHash();var B=this.setupHelper(0,A,E);var C=this.lastHelper=this.nameLookup("helpers",A,"helper");var F=this.nameLookup("depth"+this.lastContext,A,"context");var D=this.nextStack();if(B.paramsInit){this.pushSource(B.paramsInit)}this.pushSource("if (helper = "+C+") { "+D+" = helper.call("+B.callParams+"); }");this.pushSource("else { helper = "+F+"; "+D+" = typeof helper === functionType ? helper.call("+B.callParams+") : helper; }")},invokePartial:function(A){var B=[this.nameLookup("partials",A,"partial"),"'"+A+"'",this.popStack(),"helpers","partials"];if(this.options.data){B.push("data")}this.context.aliases.self="this";this.push("self.invokePartial("+B.join(", ")+")")},assignToHash:function(B){var D=this.popStack(),A,C;if(this.options.stringParams){C=this.popStack();A=this.popStack()}var E=this.hash;if(A){E.contexts.push("'"+B+"': "+A)}if(C){E.types.push("'"+B+"': "+C)}E.values.push("'"+B+"': ("+D+")")},compiler:z,compileChildren:function(A,D){var F=A.children,H,G;for(var E=0,B=F.length;E<B;E++){H=F[E];G=new this.compiler();var C=this.matchExistingProgram(H);if(C==null){this.context.programs.push("");C=this.context.programs.length;H.index=C;H.name="program"+C;this.context.programs[C]=G.compile(H,D,this.context);this.context.environments[C]=H}else{H.index=C;H.name="program"+C}}},matchExistingProgram:function(D){for(var C=0,B=this.context.environments.length;C<B;C++){var A=this.context.environments[C];if(A&&A.equals(D)){return C}}},programExpression:function(B){this.context.aliases.self="this";if(B==null){return"self.noop"}var G=this.environment.children[B],F=G.depths.list,E;var D=[G.index,G.name,"data"];for(var C=0,A=F.length;C<A;C++){E=F[C];if(E===1){D.push("depth0")}else{D.push("depth"+(E-1))}}return(F.length===0?"self.program(":"self.programWithDepth(")+D.join(", ")+")"},register:function(A,B){this.useRegister(A);this.pushSource(A+" = "+B+";")},useRegister:function(A){if(!this.registers[A]){this.registers[A]=true;this.registers.list.push(A)}},pushStackLiteral:function(A){return this.push(new p(A))},pushSource:function(A){if(this.pendingContent){this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));this.pendingContent=undefined}if(A){this.source.push(A)}},pushStack:function(B){this.flushInline();var A=this.incrStack();if(B){this.pushSource(A+" = "+B+";")}this.compileStack.push(A);return A},replaceStack:function(H){var C="",D=this.isInline(),G,B,E;if(D){var F=this.popStack(true);if(F instanceof p){G=F.value;E=true}else{B=!this.stackSlot;var A=!B?this.topStackName():this.incrStack();C="("+this.push(A)+" = "+F+"),";G=this.topStack()}}else{G=this.topStack()}var I=H.call(this,G);if(D){if(!E){this.popStack()}if(B){this.stackSlot--}this.push("("+C+I+")")}else{if(!/^stack/.test(G)){G=this.nextStack()}this.pushSource(G+" = ("+C+I+");")}return G},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var C=this.inlineStack;if(C.length){this.inlineStack=[];for(var B=0,A=C.length;B<A;B++){var D=C[B];if(D instanceof p){this.compileStack.push(D)}else{this.pushStack(D)}}}},isInline:function(){return this.inlineStack.length},popStack:function(A){var C=this.isInline(),B=(C?this.inlineStack:this.compileStack).pop();if(!A&&(B instanceof p)){return B.value}else{if(!C){if(!this.stackSlot){throw new t("Invalid stack pop")}this.stackSlot--}return B}},topStack:function(B){var A=(this.isInline()?this.inlineStack:this.compileStack),C=A[A.length-1];if(!B&&(C instanceof p)){return C.value}else{return C}},quotedString:function(A){return'"'+A.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(E,C,B){var D=[],F=this.setupParams(E,D,B);var A=this.nameLookup("helpers",C,"helper");return{params:D,paramsInit:F,name:A,callParams:["depth0"].concat(D).join(", "),helperMissingParams:B&&["depth0",this.quotedString(C)].concat(D).join(", ")}},setupOptions:function(C,B){var I=[],F=[],H=[],A,D,G;I.push("hash:"+this.popStack());if(this.options.stringParams){I.push("hashTypes:"+this.popStack());I.push("hashContexts:"+this.popStack())}D=this.popStack();G=this.popStack();if(G||D){if(!G){this.context.aliases.self="this";G="self.noop"}if(!D){this.context.aliases.self="this";D="self.noop"}I.push("inverse:"+D);I.push("fn:"+G)}for(var E=0;E<C;E++){A=this.popStack();B.push(A);if(this.options.stringParams){H.push(this.popStack());F.push(this.popStack())}}if(this.options.stringParams){I.push("contexts:["+F.join(",")+"]");I.push("types:["+H.join(",")+"]")}if(this.options.data){I.push("data:data")}return I},setupParams:function(D,C,B){var A="{"+this.setupOptions(D,C).join(",")+"}";if(B){this.useRegister("options");C.push("options");return"options="+A}else{C.push(A);return""}}};var o=("break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield").split(" ");var w=z.RESERVED_WORDS={};for(var u=0,q=o.length;u<q;u++){w[o[u]]=true}z.isValidJavaScriptVariableName=function(A){if(!z.RESERVED_WORDS[A]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(A)){return true}return false};x=z;return x})(j,e);var d=(function(w,B,o,s,v){var y;var n=w;var u=B;var r=o.parser;var q=o.parse;var x=s.Compiler;var A=s.compile;var p=s.precompile;var C=v;var z=n.create;var t=function(){var D=z();D.compile=function(E,F){return A(E,F,D)};D.precompile=function(E,F){return p(E,F,D)};D.AST=u;D.Compiler=x;D.JavaScriptCompiler=C;D.Parser=r;D.parse=q;return D};n=t();n.create=t;y=n;return y})(g,k,m,f,i);return d})();return a});define("DS/W3DXComponents/Views/Layout/PanelSlider/PanelSlider",["UWA/Core","UWA/Event","UWA/Element","UWA/Utils/Client","UWA/Class/View","css!DS/W3DXComponents/W3DXComponents"],function(g,a,b,f,e){var d=f.Features,c=e.extend({className:"panel-slider",tagName:"div",_elements:null,_nextIndex:0,_ANIM_TMR:500,_displayedPanels:0,_panelsContent:null,_panels:null,_isMuted:false,_totalSizes:0,_cachedWidth:null,init:function(j,h){var i=this;if(!Array.isArray(j)){throw new Error("Arguments must be of type array")}if(h&&!Array.isArray(h.layout)){throw new Error("Layout options should be an Object[] of {className: String, size: Number}")}i._elements=j;i._panels=[];i._panelsContent=[];i._parent(h)},_initEvents:function(){b.addEvent.call(this.placeHolder,"resize",this._resize.bind(this))},_removeEvents:function(){this.placeHolder&&b.removeEvent.call(this.placeHolder,"resize")},render:function(){var i=this,h=i.options;i.elements.body=i.container;i.container.addClassName(i.className);h.className&&i.container.addClassName(h.className);i.setLayout(h.layout);i._buildPanels(i._elements);return i},_doIntelligentRelayout:function(u){var q=this,h=u||{},n=h.index,p=h.indexRef,j=h.animate,t=h.prevLayout,s=h.layoutDelta,r=n-p-1,l=0,i=0,k=null,m=n-q._displayedPanels;function o(){l++;if(l<i){return}q._nextIndex=n+1;q._cleanUnShownSlides({force:true});q._resizePanels({from:q._nextIndex});q._resetActiveClasses();if(k){q._throwEvents(k)}q._isMuted=false;h.callback&&h.callback.apply(h.scope||q,[n,q._panelsContent[n],q])}if(r>0){k="next"}else{if(r<0){k="back"}}q._isMuted=true;if(m>=0){i++;q._resizePanels({from:0,to:m,animate:j,layout:t,callback:o})}i++;q._resizePanels({from:m+1,to:n,animate:j,indexRef:s<0?n+1:p,callback:o});i++;if(n+1!==q._panels.length-1){q._resizePanels({from:n+1,to:q._panels.length-1,animate:j,layout:t,indexRef:s<0?n+1:p,callback:o})}else{o()}},setLayout:function(l,t){var m=this,q=m.getContent(),h=g.merge(t||{},{animate:true,index:null}),s=this.options.layout,k=this._nextIndex,n=h.index,i=h.animate?{size:true,position:true}:null,p,j,r,o;if(this._isMuted){h.callback&&h.callback.call(h.scope,false);return}m._totalSizes=0;m.options.layout=l;m._displayedPanels=m.options.layout.length;m.options.layout.forEach(function(u){m._totalSizes+=u.size});j=m._calculateRefSizes(m._cachedWidth);m._currHiddenSize=j.currHiddenSize;m._currEmptySize=j.currEmptySize;if(q&&q.isInjected()){p=m.options.layout.length-s.length;if(p===0&&!g.is(n)&&(n!==(k-1))){m._resize({force:true})}r=g.is(n)?n:(k-1>m._displayedPanels-1)?k-1:m._displayedPanels-1;o=r-k-1;if(p>=0&&(r-m._displayedPanels<=0)){m.slideTo(r,{doSlide:h.animate,callback:h.callback,scope:h.scope})}else{m._doIntelligentRelayout({index:r,indexRef:k,animate:i,prevLayout:s,layoutDelta:p,callback:h.callback,scope:h.scope})}}},_buildPanels:function(m){var k=0,j=this._displayedPanels,h;for(;k<j;k++){h=this._buildPanel(m[k],{className:this.options.layout[k].className,active:true}).inject(this.elements.body);this._panels[k]=h;this._panelsContent[k]=m[k]}this._nextIndex=k;this._addEmptyPanel();this._panelsContent=this._panelsContent.concat(m.slice(k))},_buildPanel:function(j,i){var h="panel ";if(i){h+=i.className||"";h+=i.active?" active":""}return g.createElement("div",{"class":h,html:j})},onPostInject:function(){var h=this;h.placeHolder=this.getContent().getParent();h._resize();h._initEvents()},_calculateRefSizes:function(j,k,m){var l=k||this.options.layout,i=l.length,h=m||this._totalSizes;return{currEmptySize:j*l[i-1].size/this._totalSizes,currHiddenSize:j*l[0].size/this._totalSizes}},_resize:function(i){var m=this,l=i||{},k=m.getContent(),h,j;if(!k||!k.isInjected()){l.callback&&l.callback.call(l.scoe,false);return}j=k.getDimensions().innerWidth;if(m._cachedWidth!==j||l.force){h=m._calculateRefSizes(j);m._currHiddenSize=h.currHiddenSize;m._currEmptySize=h.currEmptySize;m._cachedWidth=j;m._resizePanels({from:0,to:m._nextIndex,animate:l.animate?{size:true,position:true}:null,callback:l.callback})}},_calculatePanelDim:function(t){var p=this,q=t.index,k=t.layoutOffset,n=t.indexRef||p._nextIndex,i=p._displayedPanels,r=t.layout||p.options.layout,o=p._cachedWidth,j=t.allSizes||p._totalSizes,l=r[Math.max(q-k,0)],s=r[Math.max(q-k-1,0)],h=r[0].size/j*o,m;if(q<(n-i)){m={width:h,left:"-"+h,active:false,className:r[0].className}}else{if(q===(n-i)){m={width:h,left:0,active:true,className:r[0].className}}else{if(q!==n){m={width:o*l.size/j,left:t.posOffset||0,active:true,className:l.className}}else{if(q===n){m={width:s?o*s.size/j:undefined,left:o,active:false,className:r[r.length-1].className}}}}}m.index=q;return m},_removeAnimationStyles:function(h){h.setStyles({transitionDuration:"",transitionProperty:"",perspective:"",fontSmoothing:"",transformOrigin:"",transitionTimingFunction:"",transitionDelay:"",transformStyle:""})},_getAnimationStyles:function(j,m,k){var n=this,p=!!(k.position||k.size),i=n.container,o=Math.round(m,10),l=Math.round(j,10),h=i.getStyleName("transform",true),q={width:l||undefined,transformStyle:"preserve-3d"};if(p){g.extend(q,{transformOrigin:"0 0",fontSmoothing:"antialiased",perspective:800,transitionDelay:"0ms",transitionDuration:n._ANIM_TMR+"ms",transitionProperty:[k.size?"width":""].concat([k.position?h:""]).join(","),transitionTimingFunction:"cubic-bezier(0.77, 0, 0.175, 1)"})}if(d.matrixCSS){q.transform="translate3d("+o+"px, 0, 0)"}else{q.transform="translate("+o+"px, 0)"}return q},_resizePanels:function(k){var r=this,t=r._nextIndex,o=t-r._displayedPanels,x=k||{},j=r._panels,z=g.is(x.from)?x.from:o,y=g.is(x.to)?x.to:t,n=y-(z||1),A=0,p=[],w=0,q=false,v=false,h,C,m,s,u;function D(){clearTimeout(u);if(v){return}v=true;p.forEach(function(l){var i=j[l.index];r._resetPanelLayoutClasses(i,l.className,{active:l.active})});if(g.is(x.callback,"function")){x.callback.call()}}function B(i,l){if(a.getElement(l)!==i){return}if(A===n){A++;D()}else{A++}i.removeEvent("transitionEnd");r._removeAnimationStyles(i)}x.animate=x.animate||{};q=(x.animate.size||x.animate.position);if(x.layout){x.layout.forEach(function(i){w+=i.size})}else{x.layout=r.options.layout;w=r._totalSizes}for(;z<=y;z++){C=j[z];if(C){m=p[p.length-1];h=r._calculatePanelDim({index:z,layoutOffset:o,posOffset:(m&&m.active)?m.left+m.width:null,layout:x.layout,allSizes:w,indexRef:x.indexRef});s=r._getAnimationStyles(h.width,h.left,x.animate);p.push(h);C.removeEvent("transitionEnd");if(q){C.addEvent("transitionEnd",B.bind(null,C));C.setStyles(s)}else{C.setStyles(s)}}}if(!q){if(x.callback){setTimeout(D,0)}}else{u=setTimeout(D,r._ANIM_TMR+20)}},_resetPanelLayoutClasses:function(h,j,i){var k=i||{};h.className="panel "+j+(k.active?" active":"")},_resetActiveClasses:function(){var j=this._nextIndex-this._displayedPanels,h=this._nextIndex,n=this._nextIndex-this._displayedPanels,k=this.options.layout,m;for(;j<h;j++){m=j-n;this._resetPanelLayoutClasses(this._panels[j],k[m].className,{active:true})}},insertPanel:function(j,h,i){this.insertPanels([j],h,i)},insertPanels:function(h,t,s){var m=this,i=g.merge(s||{},{resize:false,animate:false}),k=m._nextIndex,n=m._panels,p=0,l=m.elements.body,r=document.createDocumentFragment();function q(w,v){var u=m._buildPanel(w);n.splice(v,0,u);u.inject(r)}function o(){var u=l.getElement(".panel:nth-child("+(t+1)+")");u?b.inject.call(r,u,"before"):b.inject.call(r,l);m._cleanUnShownSlides({force:true});i.callback&&i.callback.call(i.scope,m)}function j(w,u){var v=u+t;if(v>=k){m._panelsContent.splice(v,0,w)}else{q(w,v);p++}}h.forEach(j);if(i.resize){m._resizePanels({animate:i.animate?{position:true,size:true}:false,from:t,to:m._nextIndex,callback:o})}else{setTimeout(o,0)}},getPanel:function(i){var j=this,h=j._panels;return i>=j._nextIndex||!h[i]?null:h[i]},getPanels:function(){var h=this._panels;return h.slice(0,h.length-1)},_addEmptyPanel:function(){var k=this,h=k._nextIndex,j=k._panels,i=j[h];i=k._buildPanel(null,h);i.setStyles({width:k._currEmptySize||0,});k._setPanelPosition(i,k._cachedWidth);j[h]=i;i.inject(k.elements.body)},_setPanelPosition:function(i,h){if(d.matrixCSS){i.setStyle("transform","translate3d("+h+"px, 0, 0)")}else{i.setStyle("transform","translate("+h+"px, 0)")}},_cleanSlide:function(j,i){var h=this;if(i.force===true){j.empty()}else{setTimeout(function(){j.empty()},h._ANIM_TMR)}},_cleanUnShownSlides:function(h){var k=this,j=h||{};function i(){var o=k._nextIndex+1,n=k._panels,p=k._panelsContent,m=n.length;if(n[k._nextIndex]){n[k._nextIndex].empty()}else{k._addEmptyPanel()}for(;o<m;o++){(p[o]&&g.is(p[o],"element")&&b.isInjected.apply(p[o]))&&(n[o].removeChild(p[o]));n[o].destroy()}n.splice(k._nextIndex+1);if(j.cb){j.cb.call(k)}}if(j.force){i()}else{setTimeout(function(){i()},k._ANIM_TMR)}},addPanel:function(i,h,j){if(this._panels[h]){this._panels[h].setContent(i)}this._panelsContent[h]=i;if(j&&j.mute){return}if((h<this._nextIndex)&&(h>this._nextIndex-this.options.layout.length)){this.dispatchEvent("onPanelShown",h)}},slideNext:function(i){var k=this,h,l,j=i||{};if(k._isMuted){j.callback&&j.callback.call(j.scope,false);return}k._isMuted=true;h=k._nextIndex;l=k._displayedPanels;if(j.content){k._panelsContent[k._nextIndex]=j.content}k._panels[h].setContent(k._panelsContent[h]);h=++k._nextIndex;k._resizePanels({animate:{size:true,position:true},from:h-l-1,to:h-1,callback:function(){var m=h-1;k._addEmptyPanel();k._throwEvents("next");k._isMuted=false;j.callback&&j.callback.apply(j.scope||k,[m,k._panelsContent[m],k])}})},slideBack:function(j){var l=this,h=l._nextIndex,m=l._displayedPanels,i=l._panels,k=j||{};if(l._isMuted){k.callback&&k.callback.call(k.scope,false);return}l._isMuted=true;if(i[h-m]){h=--l._nextIndex;l._resizePanels({animate:{size:true,position:true},from:h-m,callback:function(){var n=h-1;i[h].removeClassName("active");i[h+1].destroy();i.pop();l._cleanSlide(i[h],{force:true});l._throwEvents("back");l._isMuted=false;k.callback&&k.callback.apply(k.scope||l,[n,l._panelsContent[n],l])}})}},slideTo:function(n,q){var m=this,h=g.merge(q||{},{doSlide:true}),o=m._panels,k=m._panelsContent,l=m._nextIndex,j=m._displayedPanels,p;function i(x,w){var t=x,s=w,v=document.createDocumentFragment(),r=m.elements.body,u;for(;t<s;t++){u=o[t];if(u){u.setContent(k[t])}else{u=m._buildPanel(k[t],t);u.setStyle("width",m._currHiddenSize);m._setPanelPosition(u,m._cachedWidth);u.inject(v);o.push(u)}}r.appendChild(v)}if(m._isMuted){h.callback&&h.callback.call(h.scope,false);return}m._isMuted=true;if(n<0){g.log("[PanelSlider] Cannot slide to that panel!");return}if(n>=l||l<=j){i(l,n+1);l=n+1;p="next"}else{if(n<=j){l=n+1;p="back"}}m._nextIndex=l;m._resize({force:true,animate:h.doSlide,callback:function(r){m._isMuted=false;if(r){return}h.callback&&h.callback.apply(h.scope||m,[n,m._panelsContent[n],m]);m._throwEvents(p);m._cleanUnShownSlides({force:true})}})},_throwEvents:function(j){var i=this,h;switch(j){case"next":i.dispatchEvent("onSlideNext");h=i._nextIndex-1;break;case"back":i.dispatchEvent("onSlideBack");h=i._nextIndex-i.options.layout.length;break}i.dispatchEvent("onPanelShown",h)},isMuted:function(){return !!this._isMuted},refresh:function(h){this._resize({force:true},h)},getLayoutSize:function(){this.options.layout.length},destroy:function(){var h=this;h._removeEvents();h.stopListening();h._panelsContent.forEach(function(i){if(i&&g.is(i.destroy,"function")){i.destroy()}});h._panels.forEach(function(i){if(i){i.removeEvent("transitionEnd");i.destroy()}});h._panelsContent.length=0;h._panels.length=0;h._parent()}});return c});define("DS/W3DXComponents/AppNavigationPersistence",["UWA/Core","UWA/Class",],function(d,a){var c=null,b=a.extend({_localStorage:null,_isFirstInit:null,_getLocalStorage:function(){this._localStorage=JSON.parse(localStorage.getItem(widget.id))},_setLocalStorage:function(){try{localStorage.setItem(widget.id,JSON.stringify(this._localStorage))}catch(f){console.error(f)}},_removeLocalStorage:function(){localStorage.removeItem(widget.id)},setRoute:function(e){if(this._localStorage){if(this._localStorage.route){this._isFirstInit=false}else{this._isFirstInit=true}this._localStorage.route=e}else{this._isFirstInit=true;this._localStorage={route:e}}this._setLocalStorage()},getRoute:function(){return(this._localStorage&&this._localStorage.route)?this._localStorage.route:null},isFirstInit:function(){return this._isFirstInit},setFacetViewMode:function(f,e){if(this._localStorage){if(!this._localStorage.facetViewMode){this._localStorage.facetViewMode={}}this._localStorage.facetViewMode[f]=e}else{this._localStorage={facetViewMode:{}};this._localStorage.facetViewMode[f]=e}this._setLocalStorage()},getFacetViewMode:function(){return(this._localStorage&&this._localStorage.facetViewMode)?this._localStorage.facetViewMode:null},clear:function(){this._localStorage=null;this._isFirstInit=true;this._removeLocalStorage()},init:function(e){this._parent.apply(this,arguments);this._getLocalStorage()}});return{getInstance:function(){if(c===null){c=new b()}return c}}});define("DS/W3DXComponents/Collections/ActionsCollection",["UWA/Core","UWA/Class/Collection","UWA/Class/Model","DS/W3DXComponents/Models/ActionModel"],function(e,f,d,g){var b="actions";function a(h,j){var i;if(h){i=h[j];if(e.is(i,"function")){i=i.call(h)}}return i}var c=f.extend({model:g,name:b,url:function(){return"/"+this.name},setup:function(l,i){var j=i._modelKey,h,k;if(j&&j instanceof d){this._modelKey=j;this.url=a(j,"url")+Object.getPrototypeOf(this).url.call(this)}}});return c});define("DS/W3DXComponents/Views/Temp/TempView",["DS/W3DXComponents/Views/Temp/TempHandlebars","UWA/Core","UWA/Class/View","UWA/Utils"],function(h,d,c,a){var g=["template","templateHelpers","mapping"],e=(function(j){function m(n){n._isShown=true;k(n)}function l(n){n._isRendered=true;k(n)}function k(n){if(n._isShown&&n._isRendered&&i(n)){n.dispatchEvent("onDomRefresh")}}function i(n){return j.contains(n.container)}return function(n){n.addEvent("onShow",function(){m(n)},this);n.addEvent("onRender",function(){l(n)},this)}})(document.documentElement),f={get:a.memoize(function(i){return h.compile(i)})};var b=c.extend({init:function(k){var l,j;k=d.clone(k||{},false);for(l=g.length-1;l>=0;l--){j=g[l];if(k.hasOwnProperty(j)){this[j]=k[j];delete k[j]}}this._parent.call(this,k);e(this);this.listenTo(this,"onShow",this.onShowCalled)},id:function(){return this.cid},applyMapping:function(m,j){var k,l,i=m,n;for(k in j){l=j[k];if(d.is(l,"function")){i[k]=l.call(this)}else{n=l.split(/[\.\[\]]/);n.unshift(m);i[k]=n.reduce(function(o,p){return o&&o[p]})}}return i},getTemplate:function(){var i=this.template;return f.get(d.is(i,"function")?i.call(this):i)},mixinTemplateHelpers:function(i){i=i||{};var j=this.templateHelpers||{};if(d.is(j,"function")){j=j.call(this)}j.cid=this.cid;if(this.name){j.name=this.name}return d.extend(i,j)},onShowCalled:function(){},onPostInject:function(){this.dispatchEvent("onShow")},destroy:function(){this.isDestroyed=true;this.dispatchEvent("onDestroy");this.stopListening();this._parent.apply(this,arguments);return this}});return b});define("DS/W3DXComponents/Views/Temp/TempItemView",["DS/W3DXComponents/Views/Temp/TempView"],function(a){var b=a.extend({serializeData:function(){var c={};if(this.model){c=this.model.toJSON();if(this.mapping){c=this.applyMapping(c,this.mapping)}}else{if(this.collection){c={items:this.collection.toJSON()}}}return c},render:function(){this.isDestroyed=false;this.dispatchEvent("onBeforeRender");this.dispatchEvent("onBeforeItemRendered");var e=this.serializeData(),d=this.getTemplate();e=this.mixinTemplateHelpers(e);var c=d(e);this.container.setHTML(c);this.dispatchEvent("onRender");this.dispatchEvent("onItemRendered");return this},destroy:function(){if(this.isDestroyed){return}this.dispatchEvent("onItemBeforeDestroy");this._parent.apply(this,arguments);this.dispatchEvent("onItemDestroyed")}});return b});define("DS/W3DXComponents/Views/EmptyView",["DS/W3DXComponents/Views/Temp/TempItemView","i18n!DS/W3DXComponents/assets/nls/Views/EmptyView.json","css!DS/W3DXComponents/W3DXComponents",],function(c,d){var a="empty-view";var b=c.extend({name:a,tagName:"div",defaultOptions:{icon:undefined,title:d.noItem,subtitle:""},setup:function(){this.container.addClassName(this.getClassNames())},template:function(){var e='<div class="'+this.getClassNames("-infos")+'">',f=this.options.icon,g=this.options.title;if(f){e+='<span class="'+this.getClassNames("-icon")+" center-block fonticon fonticon-5x fonticon-"+f+'" ></span>'}if(g){e+='<span class="'+this.getClassNames("-title")+' center-block">'+g+"</span>"}e+="</div>";return e},});return b});define("DS/W3DXComponents/Views/Item/FilterView",["UWA/Core","DS/W3DXComponents/Views/Temp/TempItemView","css!DS/W3DXComponents/W3DXComponents"],function(d,b){var a="filter";var c=b.extend({name:"filter",tagName:"ul",template:'                            {{#each filters}}                                <li data-field={{field}}">{{value}}</li> |                             {{/each}}                            <li class="selected">All</li>                        ',domEvents:{"click li":"onClickCalled"},init:function(e){var f=UWA.clone(e,false);["container","template","tagName","domEvents"].forEach(function(g){delete f[g]});this._parent(f)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},onClickCalled:function(f){this.dispatchEvent("onClick",{field:f.target.dataset.field,value:f.target.textContent});this.getElement(".selected").removeClassName("selected");f.target.addClassName("selected")},serializeData:function(){return this.model}});return c});define("DS/W3DXComponents/Views/Temp/TempCollectionView",["DS/W3DXComponents/Views/Temp/TempView","UWA/Core","UWA/Class/Model"],function(f,c,b){var e=["itemView","emptyView","itemViewOptions","itemViewEventPrefix","filterer"];function a(g,h){g=UWA.extendElement(g);h?g.show():g.hide()}var d=f.extend({itemViewEventPrefix:"ItemView",filterCallback:function(g,h){a(g.container,h)},init:function(h){var j,g;h=c.clone(h||{},false);for(j=e.length-1;j>=0;j--){g=e[j];if(h.hasOwnProperty(g)){this[g]=h[g];delete h[g]}}this._initChildViewStorage();this._initVisibleItemsStorage();this._parent.call(this,h);this._initialEvents();this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment();this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){this.isBuffering=false;this.appendBuffer(this,this.elBuffer);this._triggerShowBufferedChildren();this.initRenderBuffer()},_triggerShowBufferedChildren:function(){if(this._isShown){this._bufferedChildren.forEach(function(g){g.dispatchEvent("onShow")});this._bufferedChildren=[]}},_initChildViewStorage:function(){this.children={}},_initVisibleItemsStorage:function(){this.visibleItems=[]},_initialEvents:function(){this._parent.apply(this,arguments);if(this.collection){this.listenTo(this.collection,{onAdd:this.addChildView,onRemove:this.removeItemView,onReset:this.render})}},addChildView:function(j,k,h){this.destroyEmptyView();var i=this.getItemView(j);var g=this.collection.indexOf(j);this.addItemView(j,i,g)},onShowCalled:function(){for(var g in this.children){this.children[g].dispatchEvent("onShow")}},render:function(){this.isDestroyed=false;this.triggerBeforeRendered();this._renderChildren();this.triggerRendered();return this},triggerBeforeRendered:function(){this.dispatchEvent("onBeforeRender");this.dispatchEvent("onCollectionBeforeRender")},triggerRendered:function(){this.dispatchEvent("onRender");this.dispatchEvent("onCollectionRendered")},_renderChildren:function(){this.startBuffering();this.destroyChildren();this.visibleItems.length=0;this.showCollection();this.collection.isEmpty()&&this.dispatchEvent("onVisibilityChange",[this.visibleItems]);this.endBuffering()},showCollection:function(){var g;this.collection.forEach(function(i,h){g=this.getItemView(i);this.addItemView(i,g,h)},this)},showEmptyView:function(){var h=this.getEmptyView();if(h&&!c.is(this._emptyView)){var g=new b();this._emptyView=this.addItemView(g,h,0)}},destroyEmptyView:function(){if(c.is(this._emptyView)){this.removeChildView(this._emptyView)}},getEmptyView:function(){return this.emptyView},getItemView:function(h){var g=this.itemView;if(!g){throw new Error("An `itemView` must be specified")}return g},filter:function(g,j){var i,h;if(c.is(g,"function")||g===null){this.filterer=g}if(c.is(j,"function")||j===null){this.filterCallback=j}this.collection.forEach(function(l,k){i=(c.is(this.filterer,"function")?this.filterer(l,k):true);h=this.getChildView(l);if(!h){throw new Error("No view foun for #"+l.cid)}this.filterCallback(h,i);this.updateVisibleItems(h.model,i,false)},this);this.dispatchEvent("onVisibilityChange",[this.visibleItems])},getChildView:function(h){var i=this.collection,g;if(!i){return}g=this.collection.get(h);return g?this.children[g.cid]:undefined},addItemView:function(l,k,i){var n=this.itemViewOptions,m,h=this.getEmptyView(),j=k===h;m=c.is(this.filterer,"function")?this.filterer(l,i):true;if(c.is(n,"function")){n=n.call(this,l,i)}var g=this.buildItemView(l,k,n);this.addChildViewEventForwarding(g);this.dispatchEvent("onBeforeItemAdded",g);if(!j&&this.filterer){this.filterCallback(g,m)}this.children[l.cid]=g;this.renderItemView(g,i);if(this._isShown&&!this.isBuffering){g.dispatchEvent("onShow")}this.dispatchEvent("onAfterItemAdded",g);if(!j){this.updateVisibleItems(l,m)}return g},addChildViewEventForwarding:function(g){var h=this.itemViewEventPrefix;g.addEvent("onAnyEvent",function(){var i=Array.prototype.slice.call(arguments);var j=i[0].substring(0,2)=="on"?i[0].substring(2,i[0].length):i[0];i[0]="on"+h+j;i.splice(1,0,g);this.dispatchEvent(i.splice(0,1)[0],i)},this)},renderItemView:function(g,h){g.render();this.appendHtml(this,g,h)},buildItemView:function(i,g,j){var h=c.extend({model:i},(j||{}));return new g(h)},removeItemView:function(h){var g=this.children[h.cid];this.removeChildView(g)},removeChildView:function(g){var h;if(g){h=this.getEmptyView();delete this.children[g.model.cid];this.updateVisibleItems(g.model,false,true,"removeChildView");g.destroy();if(this.isBuffering&&g.container.parentNode===this.elBuffer){this.elBuffer.removeChild(g.container)}if(h&&g instanceof h){delete this._emptyView}}this.dispatchEvent("onItemRemoved",g)},onVisibilityChange:function(){var g=this.visibleItems.length;if(g===0){this.showEmptyView()}else{this.destroyEmptyView()}},appendBuffer:function(h,g){h.container.addContent(g)},appendHtml:function(g,i,h){if(g.isBuffering){g.elBuffer.appendChild(i.container);g._bufferedChildren.push(i)}else{g.container.appendChild(i.container)}},updateVisibleItems:function(k,h,m){var i=false;!c.is(m)&&(m=true);var g=this.visibleItems,j=g.indexOf(k),l=(j!==-1);if(h&&!l){g.push(k);i=true}else{if(!h&&l){g.splice(j,1);i=true}}if(i&&m){this.dispatchEvent("onVisibilityChange",[g])}return i},destroy:function(){if(this.isDestroyed){return}this.dispatchEvent("onCollectionBeforeDestroyed");this.destroyChildren();this.dispatchEvent("onCollectionDestroyed");this._parent.apply(this,arguments)},destroyChildren:function(){for(var g in this.children){this.removeChildView(this.children[g])}}});return d});define("DS/W3DXComponents/Views/Layout/NestedScrollView",["DS/W3DXComponents/Views/Layout/ScrollView","UWA/Core","DS/W3DXComponents/Views/Temp/TempItemView","css!DS/W3DXComponents/W3DXComponents"],function(f,d,e){var g=["nested"],b="scroll-nested";function a(h,k,i){var j;if(h){j=h[k];if(d.is(j,"function")){j=j.call(i,h)}}return j}var c=e.extend({name:b,template:"",tagName:"div",defaultOptions:{orientation:"vertical",scrollPosition:null,useInfiniteScroll:true,usePullToRefresh:true},init:function(j){var k,h;j=d.clone(j||{},false);for(k=g.length-1;k>=0;k--){h=g[k];if(j.hasOwnProperty(h)){this[h]=j[h];delete j[h]}}["container","tagName","template","itemViewEventPrefix","itemViewContainer","domEvents"].forEach(function(i){delete j[i]});this._parent.call(this,j)},setup:function(){this.container.addClassName(this.getClassNames("-container"));delete this.options.events;this._initNestedView();this._initScrollView();this.listenTo(this.collection,{onReset:function(){var h=this.getOption("useInfiniteScroll");this.scrollView&&this.scrollView.useInfiniteScroll(h)}})},_initScrollView:function(){var h=this.nestedView,j,i;if(!h){return}j=this._scrollViewEvents={onInfiniteScroll:function(){Array.prototype.unshift.call(arguments,this.scrollView);this.dispatchEvent("onInfiniteScroll",arguments)},onPullToRefresh:function(){Array.prototype.unshift.call(arguments,this.scrollView);this.dispatchEvent("onPullToRefresh",arguments)}};i=this.scrollView=new f(d.extend(this.options,{view:h}));this.listenTo(i,j);return this.scrollView},_initNestedView:function(){var i,h,j=a(this,"nested",this);i=this._nestedViewEvents={onItemViewDrag:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewDrag",arguments)},onItemViewCheck:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewCheck",arguments)},onItemViewSelect:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewSelect",arguments)},onItemViewUnSelect:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewUnSelect",arguments)},onItemViewClick:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewClick",arguments)},onItemViewDblClick:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewDblClick",arguments)},onItemViewContextMenu:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewContextMenu",arguments)},onItemViewActionClick:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onItemViewActionClick",arguments)},onAddSelection:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onAddSelection",arguments)},onRemoveSelection:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onRemoveSelection",arguments)},onDeactivateMultisel:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onDeactivateMultisel",arguments)},onUnSelectAll:function(){Array.prototype.unshift.call(arguments,this.nestedView);this.dispatchEvent("onUnSelectAll",arguments)}};h=this.nestedView=new j(d.extend({collection:this.collection},this.options));this.listenTo(h,i);return h},onRender:function(){this.scrollView&&this.injectSubView(this.scrollView);return this._parent.apply(this,arguments)},injectSubView:function(j,h){var i=h?this.getElement(h):this.container;if(j&&i){this.undelegateDOMEvents();j.render().inject(i);this.delegateDOMEvents()}},selectItemView:function(k,i){i||(i={});var h=this.nestedView,j=h.selectItemView&&h.selectItemView.apply(h,arguments);return(i.scrollPosition&&this.scrollToItemView(j,i.scrollPosition))||j},getSelectedItemView:function(i){var h=this.nestedView;return(h.getSelectedItemView&&h.getSelectedItemView.apply(h,arguments))},unSelectAll:function(i){var h=this.nestedView;return(h.unSelectAll&&h.unSelectAll.apply(h,arguments))},setShadings:function(i){var h=this.nestedView;return(h.setShadings&&h.setShadings.apply(h,arguments))},resetShadings:function(){var h=this.nestedView;return(h.resetShadings&&h.resetShadings.apply(h,arguments))},scrollToItemView:function(j,h){var i;i=j instanceof e?j:this.nestedView.getChildView(j);if(!i){return}var k=this.getOption("scrollDuration");k=k>0?k:0;this.scrollView.scrollToElement(i.container,h,k);return i},scrollToPosition:function(){var h=this.scrollView;return(h.scrollToPosition&&h.scrollToPosition.apply(h,arguments))},onItemViewSelect:function(){var h=this.getOption("scrollPosition"),j;if(!h){return}j=arguments[arguments.length-1];if(h==="auto"){var i=this.isElementInViewport(j.container,true);if(i.isInViewport){return}else{if(i.posOverflow.top){h="top"}else{if(i.posOverflow.bottom){h="bottom"}}}}this.scrollToItemView(j,h)},isElementInViewport:function(i,k){var h={},j=i.getBoundingClientRect();h.isInViewport=j.top>=50&&j.left>=0&&j.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&j.right<=(window.innerWidth||document.documentElement.clientWidth);if(k){h.posOverflow={};h.posOverflow.top=j.top>=50?false:true;h.posOverflow.left=j.left>=0?false:true;h.posOverflow.bottom=j.bottom<=(window.innerHeight||document.documentElement.clientHeight)?false:true;h.posOverflow.right=j.right<=(window.innerWidth||document.documentElement.clientWidth)?false:true}return h},destroy:function(){if(this.isDestroyed){return}var i=this.scrollView,h=this.nestedView;this.stopListening(i,this._scrollViewEvents);this.stopListening(h,this._nestedViewEvents);i.destroy();delete this.scrollView;delete this.nestedView;return this._parent.apply(this,arguments)}});return c});define("DS/W3DXComponents/Views/Temp/TempCompositeView",["DS/W3DXComponents/Views/Temp/TempCollectionView","UWA/Core"],function(c,b){var a=c.extend({_initialEvents:function(){this.listenToOnce(this,"onRender",function(){if(this.collection){this.listenTo(this.collection,{onAdd:this.addChildView,onRemove:this.removeItemView,onReset:this._renderChildren})}})},serializeData:function(){var d={};if(this.model){d=this.model.toJSON();if(this.mapping){d=this.applyMapping(d,this.mapping)}}return d},render:function(){this.isRendered=true;this.isDestroyed=false;this.resetItemViewContainer();var d=this.renderModel();this.container.setHTML(d);this.dispatchEvent("onCompositeModelRendered");this._renderChildren();this.dispatchEvent("onCompositeRendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){this.dispatchEvent("onCompositeCollectionBeforeRender");this._parent.apply(this,arguments);this.dispatchEvent("onCompositeCollectionRendered")}},renderModel:function(){var e={};e=this.serializeData();e=this.mixinTemplateHelpers(e);var d=this.getTemplate();return d(e)},appendBuffer:function(f,e){var d=this.getItemViewContainer(f);d.addContent(e)},appendHtml:function(e,g,f){if(e.isBuffering){e.elBuffer.appendChild(g.container);e._bufferedChildren.push(g)}else{var d=this.getItemViewContainer(e);d.appendChild(g.container)}},getItemViewContainer:function(g){if("itemViewContainerElem" in g){return g.itemViewContainerElem}var e,f=this.options.itemViewContainer||this.itemViewContainer;if(f){var d=b.is(f,"function")?f.call(this):f;e=g.container.getElement(d)}else{e=g.container}g.itemViewContainerElem=e;return e},resetItemViewContainer:function(){if(this.itemViewContainerElem){delete this.itemViewContainerElem}}});return a});define("DS/W3DXComponents/Views/Item/CounterView",["UWA/Core","DS/W3DXComponents/Views/Temp/TempItemView","css!DS/W3DXComponents/W3DXComponents"],function(c,d){var b="set-detail-view";var a=d.extend({name:b,tagName:"div",template:function(){return'                                {{#if title}}<span class="'+this.getClassNames("-title")+'">{{title}}</span>                                <span class="'+this.getClassNames("-count")+'">{{itemsLength}}</span>{{/if}}                            '},init:function(e){var f=this;e=c.clone(e||{},false);["container","template","tagName"].forEach(function(g){delete e[g]});this._parent.call(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},mixinTemplateHelpers:function(){var f=this._parent.apply(this,arguments),g=this.collection,e=(g.state&&g.state.totalRecords);!e&&(e=g.size());f.itemsLength=e;return f},setOptions:function(e){this._parent.apply(this,arguments);var g=this.collection;if(e.title){var f=this.templateHelpers||(this.templateHelpers={});f.title=e.title||f.title;if(g){this.listenTo(g,{onAdd:this.render,onRemove:this.render,onReset:this.render})}}else{if(g){this.stopListening(g)}}return this}});return a});define("DS/W3DXComponents/Views/Item/ActionView",["DS/W3DXComponents/Views/Temp/TempItemView","UWA/Core","UWA/Event","UWA/Class/Events","DS/UIKIT/Tooltip","css!DS/W3DXComponents/W3DXComponents","css!DS/UIKIT/UIKIT.css"],function(f,c,g,e,d){var b="action";var a=f.extend({name:b,tagName:"div",template:function(){return'<div class="'+this.getClassNames("-icon-wrapper")+'"><span  class="fonticon fonticon-2x fonticon-{{icon}}"></span></div>'},domEvents:function(){return{click:this.dispatchAsEventListener("onClick"),touchstart:this.dispatchAsEventListener("onClick")}},init:function(h){h=c.clone(h||{},false);["container","template","tagName","domEvents"].forEach(function(i){delete h[i]});this._parent.call(this,h)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},onRender:function(){if(c.is(this.model.get("title"))&&this.model.get("title").trim().length>0){new d({position:"bottom",target:this.container,body:this.model.get("title")})}}});return a});define("DS/W3DXComponents/Views/Item/DropDownActionView",["UWA/Core","DS/W3DXComponents/Views/Temp/TempItemView","css!DS/W3DXComponents/W3DXComponents","css!DS/UIKIT/UIKIT.css"],function(c,d){var b="drop-down-action";var a=d.extend({name:b,tagName:"li",template:function(){return'                                <span class="'+this.getClassNames("-icon-wrapper")+'"><span class="fonticon fonticon-2x fonticon-{{icon}}"></span></span>                                <span class="'+this.getClassNames("-title")+'">{{title}}</span>                            '},domEvents:function(){return{click:this.dispatchAsEventListener("onClick")}},init:function(e){e=c.clone(e||{},false);["className","container","template","tagName","domEvents"].forEach(function(f){delete e[f]});this._parent.call(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"));if(this.model){this.listenTo(this.model,{onChange:this.render})}}});return a});define("DS/W3DXComponents/Views/Layout/ActionsView",["UWA/Core","DS/W3DXComponents/Views/Item/ActionView","DS/W3DXComponents/Views/Temp/TempCollectionView","UWA/Event","css!DS/W3DXComponents/W3DXComponents"],function(e,a,d,g){var b="actions",f=50;var c=d.extend({name:b,tagName:"div",itemView:a,itemViewEventPrefix:"Action",domEvents:function(){var h=this;return{resize:this.dispatchAsEventListener("onResize")}},defaultOptions:{updateOnResize:true},init:function(h){h=e.clone(h||{},false);["container","template","tagName","itemViewEventPrefix","domEvents"].forEach(function(i){delete h[i]});this._parent.call(this,h)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},updateOverflow:function(){var h=this.container.offsetWidth-1,i=Math.floor(h/f),j=(this.overflowActions=this.visibleItems.slice(i));this.dispatchEvent("onUpdateOverflow",[this.overflowActions])},onUpdateOverflow:function(i){var h=function(k,j){k.forEach(function(l){l.set({visible:j})})};h(i,false);h(this.collection.without(i),true)},onAfterItemAdded:function(){this.updateOverflow()},onItemRemoved:function(){this.updateOverflow()},onResize:function(){this.updateOverflow()},onVisibilityChange:function(){this.updateOverflow()},onDestroy:function(){this.container.removeEvent()}});return c});define("DS/W3DXComponents/Views/Layout/DropDownActionsView",["DS/W3DXComponents/Views/Item/DropDownActionView","DS/W3DXComponents/Views/Temp/TempCompositeView","UWA/Core","UWA/Element","UWA/Event","css!DS/W3DXComponents/W3DXComponents"],function(a,d,c,f,e){var b="drop-down-actions",g=["position","positionOptions"];var h=d.extend({name:b,tagName:"div",itemView:a,itemViewContainer:function(){return"."+b+"-wrapper"},itemViewEventPrefix:"Action",position:function(){throw new Error("You must specify a position!")},positionOptions:{},template:function(){return'                        <ul class="'+this.getClassNames("-wrapper")+'"></ul>                    '},init:function(k){var l,j;k=c.clone(k||{},false);for(l=g.length-1;l>=0;l--){j=g[l];if(k.hasOwnProperty(j)){this[j]=k[j];delete k[j]}}["container","template","itemViewContainer","itemViewEventPrefix","tagName"].forEach(function(i){delete k[i]});this._parent.call(this,k)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},updatePosition:function(){var j=this,i=function(k){return c.is(k,"function")?k.call(j):k};if(!this.isDestroyed){this.container.setPosition(i(this.position||this.options.position),i(this.positionOptions||this.options.positionOptions))}return this},onShow:function(){f.addEvent.call(document,"click",this.onClickOutside.bind(this),null,0,true);f.addEvent.call(this.container.getParent(),"resize",this.updatePosition.bind(this),null,0,true);this.updatePosition()},onClickOutside:function(i){if(!i||!e.getElement(i).isInjected(this.container)&&e.getElement(i)!==this.container){this.destroy()}},onDestroy:function(){f.removeEvent.call(document,"click",this.onClickOutside,true);f.removeEvent.call(this.container.getParent(),"resize",this.updatePosition,true)}});return h});define("DS/W3DXComponents/Views/Item/ActionsInlineView",["UWA/Class/Collection","UWA/Core","DS/W3DXComponents/Views/Layout/ActionsView","DS/W3DXComponents/Views/Layout/DropDownActionsView","DS/W3DXComponents/Views/Temp/TempItemView","DS/UIKIT/Native/Dropdown","DS/W3DXComponents/Collections/ActionsCollection","css!DS/W3DXComponents/W3DXComponents"],function(j,g,f,b,d,a,e){var h="actions-inline",c=["alwaysOverflow"];var i=d.extend({name:h,tagName:"div",template:function(){return'                                <div class="'+this.getClassNames("-wrapper")+'"></div>                                <div class="action-container actions-inline-dotted hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-dot-3"></span></div>                                </div>                            '},domEvents:{"click .actions-inline-dotted":"onClickDotted","touchstart .actions-inline-dotted":"onClickDotted"},init:function(l){var m,k;l=g.clone(l||{},false);for(m=c.length-1;m>=0;m--){k=c[m];if(l.hasOwnProperty(k)){this[k]=l[k];delete l[k]}}["container","template","tagName","domEvents"].forEach(function(n){delete l[n]});this.contextualActions=l.contextualActions;this._parent.call(this,l)},setup:function(){this.container.addClassName(this.getClassNames("-container"));this._initActionsView()},_initActionsView:function(){var k,n,l,m=this;k=this._actionsViewEvents={onVisibilityChange:function(){Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onVisibilityChange",arguments)},onActionClick:function(p,o){o.preventDefault();Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onActionClick",arguments)},onUpdateOverflow:this.onUpdateOverflow,onDestroy:function(){this.stopListening(this.actionsView,this._actionsViewEvents);delete this.actionsView},onResize:function(){!!this.dropDown&&this.dropDown.filter()}};l=this.actionsView=new f({collection:this.collection,filterer:this.isActionsVisible.bind(this)});this.listenTo(l,k);return l},_initDottedElem:function(){var k;k=this.dottedElem=this.getElement("."+this.name+"-dotted");return k},getContextualArg:function(){return this},_updateContextualActions:function(){var l=this;var n;this.contextualActions=[];var k=function(o){var p=o.handler;if(p){o.handler=function(){p(l.getContextualArg())}}if(o.items){o.items.forEach(k)}};if(this.options&&this.options.contextualActions){var m=this.options.contextualActions;if(typeof m==="function"){n=m.apply(this.model)}else{n=g.clone(m)}if(n&&n instanceof Array){n.forEach(k);this.contextualActions=n}}},_initDropDownMenu:function(){var k=this.dottedElem,n,o,l,m=this;this._updateContextualActions();var o=this.dropDown=new a({target:this.dottedElem,items:this.contextualActions});this.dropDown.show()},addContextualAction:function(k){return this.dropDown.addItem(k)},_executeHandler:function(m,k,l){l(m,k)},_initDropDown:function(){var k=this.dottedElem,n,o,l,m=this;l=this._dropDownEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.dropDown);this.dispatchEvent("onActionClick",arguments);this.destroyDropDown()},onDestroy:function(){this.stopListening(this.dropDown,this._dropDownEvents);delete this.dropDown}};o=this.dropDown=new b({collection:this.collection,filterer:this.isActionsOverflow.bind(this),position:function(){var u=this.container.getSize(),q=k.getOffsets();var t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);var v,p=q.x-u.width+k.offsetWidth;var s=12,r=k.offsetHeight+q.y+u.height;if((r>t+s)||(r>window.innerHeight+s)){v=q.y-u.height+s}else{v=q.y+k.offsetHeight-s}return g.merge({x:p,y:v},q)}});this.listenTo(o,l);return o},injectSubView:function(m,k){var l=this.container.getElement(k);if(m&&l){this.undelegateDOMEvents();l.grab(m.render().getContent());this.delegateDOMEvents()}},isActionsVisible:function(n,m){var l=!n.get("overflow"),k=this.options.filterer;if(g.is(k,"function")){k=k.call(this,n,m);l=l&&k}return l},isActionsOverflow:function(n,m){var l=!n.get("visible")||n.get("overflow"),k=this.options.filterer;if(g.is(k,"function")){k=k.call(this,n,m);l=l&&k}return l},hasOverflowAction:function(){var l=this.collection,k=false;if(this.collection){k=this.collection.some(this.isActionsOverflow,this)}return k},destroyDropDown:function(){if(this.dropDown){this.dropDown.destroy();delete this.dropDown}},onRender:function(){this._initDottedElem();this.injectSubView(this.actionsView,"."+this.name+"-wrapper")},onShow:function(){this.actionsView.dispatchEvent("onShow")},onClickDotted:function(k){this.dispatchEvent("onActionClickDotted");if(this.contextualActions){if(this.dropDown){return}this._initDropDownMenu()}else{if(this.dropDown){return}this._initDropDown().render().inject(document.body)}k.stopPropagation()},onUpdateOverflow:function(){if(!this._isShown){return}if(this.hasOverflowAction()){this.dottedElem.removeClassName("hidden");this.dispatchEvent("onDottedVisible")}else{this.destroyDropDown();this.dottedElem.addClassName("hidden");this.dispatchEvent("onDottedHidden")}},destroy:function(){if(this.isDestroyed){return}this.actionsView.destroy();this.destroyDropDown();delete this.dottedElem;return this._parent.apply(this,arguments)}});return i});define("DS/W3DXComponents/Views/Item/TileView",["DS/W3DXComponents/Views/Temp/TempHandlebars","UWA/Class/Collection","UWA/Core","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Views/Plugins/LazyLoading","DS/W3DXComponents/Views/Temp/TempItemView","DS/UIKIT/Input/Toggle","DS/W3DXComponents/Collections/ActionsCollection","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","css!DS/UIKIT/UIKIT.css","css!DS/W3DXComponents/W3DXComponents"],function(a,n,k,f,j,d,i,e,h,g){var l="tile",c=["lazyLoading"],o=function(p,r){var q;if(p){q=p[r];if(k.is(q,"function")){q=q.call(p)}}return q};function b(){a.registerHelper("getImgAttrs",function(p){var s="",r,q;if(!p){return}for(r in p){q=p[r];if(!k.is(q)){break}r=a.Utils.escapeExpression(r);q=a.Utils.escapeExpression(q);s+=r+'="'+q+'" '}return new a.SafeString(s)})}b();var m=d.extend(j,{name:l,tagName:"div",template:function(){return'                                        <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                            <div class="toggle toggle-primary">                                                <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                                <label class="control-label" for="checkbox-{{cid}}"></label>                                            </div>                                        </div>                                        <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                            <div class="'+this.getClassNames("-header")+'">                                                {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                            </div>                                            <div class="'+this.getClassNames("-body")+'">                                                {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}	                                                <div class="'+this.getClassNames("-title")+'">{{{title}}}</div>                                                <div class="'+this.getClassNames("-subtitle")+'">{{{subtitle}}}</div>                                                <div class="'+this.getClassNames("-content")+'">{{{content}}}</div>                                            <progress max="100" value="10" class="'+this.getClassNames("-progress")+'"></progress>                                            </div>                                            <div class="'+this.getClassNames("-actions")+'">                                                <div class="actions-inline-container">                                                    <div class="action-container single-action hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                                    </div>                                                    <div class="action-container actions-inline-dotted hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        </div>                                    '},domEvents:function(){return{"click .tile-sub-container":function(p){if(!p||!p.target||!this.container.getElement(".actions-inline-container")||!this.container.getElement(".actions-inline-container").contains(p.target)){this.dispatchEvent("onClick",[p])}},"contextmenu .tile-sub-container":function(p){p.preventDefault();this.dispatchEvent("onContextMenu",[p]);return false},dragstart:this.dispatchAsEventListener("onDrag"),"dblclick .tile-sub-container":function(p){if(!p||!p.target||!this.container.getElement(".actions-inline-container")||!this.container.getElement(".actions-inline-container").contains(p.target)){this.dispatchEvent("onDblClick",[p])}},"change .tile-check input":this.dispatchAsEventListener("onCheck")}},init:function(q){var s=this,r,p;q=k.clone(q||{},false);if(!q.attributes){q.attributes={}}for(r=c.length-1;r>=0;r--){p=c[r];if(q.hasOwnProperty(p)){this[p]=q[p];delete q[p]}}["container","template","tagName","domEvents"].forEach(function(t){delete q[t]});this._parent.call(this,q)},setup:function(){this.container.addClassName(this.getClassNames("-container"));this.listenTo(this.model,{onAdd:this.onAdd,onChange:this.render,onProgress:this.onProgress,onLoad:this.onLoad});if(!this.options.contextualActions&&this.model.actions&&this.model.actions instanceof e){this.listenTo(this.model.actions,{onRemove:this.render,onAdd:this.render,onChange:this.render})}this.manageLazyLoading()},_executeHandler:function(r,p,q){q(r,p)},_initDropDown:function(){var p,s,t,q,r=this;p=this.container.getElement(".actions-inline-dotted .action-icon-wrapper");t=this.dropDown=new h({target:p,items:this.contextualActions});this.dropDown.show()},updateContextualActions:function(p){this.options.contextualActions=p;this._updateContextualActions()},_updateContextualActions:function(){var q=this;var s;this.contextualActions=[];var p=function(t){var u=t.handler;if(u){t.handler=function(){u(q)}}if(t.items){t.items.forEach(p)}};if(this.options&&this.options.contextualActions){var r=this.options.contextualActions;if(typeof r==="function"){s=r.apply(this.model)}else{s=k.clone(r)}if(s&&s instanceof Array){s.forEach(p);this.contextualActions=s}}else{if(this.model.actions){if(k.is(this.model.actions,"function")){s=this.model.actions()}else{s=this.model.actions}if(s instanceof e){s=s.map(function(t){return{text:t.get("title"),fonticon:t.get("icon"),multisel:false,handler:function(){q.dispatchEvent("onActionClick",[q,{model:t},arguments[0]])}}});if(s&&s instanceof Array&&s.length>0){this.contextualActions=s}}else{console.log("TileView: actions on model not correctly defined.")}}}},_setAspectRatios:function(){var p=this.container.getElement(".tile-image");if(p){p.onload=function(){var q=this.naturalWidth/this.naturalHeight;if(q>1){this.removeClassName("portrait");this.addClassName("landscape")}else{this.removeClassName("landscape");this.addClassName("portrait")}}}},mixinTemplateHelpers:function(){var q=this._parent.apply(this,arguments),p;(p=q.imgAttrs)&&k.is(p,"function")&&(q.imgAttrs=p.call(this));q.withMultisel=this.options.withMultisel;return q},manageLazyLoading:function(){if(!this.lazyLoading){return}var p=this.templateHelpers||(this.templateHelpers={});p.lazyLoading=this.lazyLoading},persistCheckbox:function(){var p=this.container.getElement("."+l+"-check");p.addClassName("persist")},unPersistCheckbox:function(){var p=this.container.getElement("."+l+"-check");p.removeClassName("persist")},setShading:function(q){for(var p=0;p<q.length;p++){if(q[p].criteria(this.model)){this.container.setStyle("background-color",q[p].color);this.container.addClassName("shaded");this.container.getElement(".tile-header").setStyle("outline-color",q[p].color)}}},resetShading:function(){this.container.style.backgroundColor="";this.container.removeClassName("shaded")},select:function(p){p||(p={});this.container.addClassName("selected");if(this.container.getElement("."+l+"-check input")){this.container.getElement("."+l+"-check input").checked=true}if(!p.silent){this.dispatchEvent("onSelect")}},unSelect:function(p){this.container.removeClassName("selected");if(this.container.getElement("."+l+"-check input")){this.container.getElement("."+l+"-check input").checked=false}if(p&&!p.silent){this.dispatchEvent("onUnSelect")}},isSelected:function(){return this.container.hasClassName("selected")},onBeforeRender:function(){if(this.dropDown){this.dropDown.destroy();delete this.dropDown}if(this.container.getElement(".actions-inline-dotted")){this.container.getElement(".actions-inline-dotted").removeEvent("click")}},onRender:function(){var p=this;this._setAspectRatios();this.container.addClassName("with-actions");if(this.options.actionButtonBinding){this.options.actionButtonBinding(this)}else{this._updateContextualActions();if(this.contextualActions){if(this.contextualActions.length===1){var q=this.contextualActions[0];this.container.getElement(".single-action").removeClassName("hidden");q.fonticon&&this.container.getElement(".single-action .fonticon").addClassName("fonticon-"+q.fonticon);q.handler&&this.container.getElement(".single-action").addEvent("click",function(){p._actionTooltip&&p._actionTooltip.hide();q.handler.apply(p,arguments)});if(k.is(q.text)&&q.text.trim().length>0){delete this._actionTooltip;this._actionTooltip=new g({position:"bottom",target:this.container.getElement(".single-action"),body:q.text})}}else{if(this.contextualActions.length>1&&this.container.getElement(".actions-inline-dotted")){this.container.getElement(".actions-inline-dotted").removeClassName("hidden");this.container.getElement(".actions-inline-dotted").addEvent("click",function(r){if(p.contextualActions){if(p.dropDown){return}p.dispatchEvent("onActionClickDotted",p);p._initDropDown()}})}}}}},onItemRendered:function(){if(!this.lazyLoading){return}this.lazyLoading=k.merge({imgElem:this.getElement("."+l+"-image"),imgSrc:this.model.get("image")},this.lazyLoading)},onProgress:function(p){this.getElement("progress").value=p},onLoad:function(){this.container.removeClassName("progress");this.getElement("progress").value=0},onAdd:function(q,r,p){if(p.isProgress){this.container.addClassName("progress")}},destroy:function(){if(this.isDestroyed){return}if(this.dropDown){this.dropDown.destroy();delete this.dropDown}if(this._actionTooltip){this._actionTooltip.destroy();delete this._actionTooltip}if(this.container.getElement(".actions-inline-dotted")){this.container.getElement(".actions-inline-dotted").removeEvent("click")}return this._parent.apply(this,arguments)}});return m});define("DS/W3DXComponents/Views/Item/RowView",["UWA/Core","DS/W3DXComponents/Views/Temp/TempHandlebars","DS/W3DXComponents/Views/Temp/TempItemView","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Toggle","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/UIKIT/Tooltip","css!DS/W3DXComponents/W3DXComponents"],function(k,b,f,j,i,g,e,h){var l="row",m=function(n,p){var o;if(n){o=n[p];if(k.is(o,"function")){o=o.call(n)}}return o};function d(){b.registerHelper("propertyHelper",function(r,s,o){var p=s.property||s,q=s.type||null,n=r[p]||"";switch(q){case"date":n=new Date(n*1000).toLocaleString();break;default:break}return a(n)})}function a(n){return n.toString().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}d();var c=f.extend({name:l,tagName:"tr",template:function(){return'                            {{#if withMultisel}}<td class="row-data-check">                                <div class="row-check">                                    <div class="toggle toggle-primary">                                        <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                        <label class="control-label" for="checkbox-{{cid}}"></label>                                    </div>                                </div>                            </td>{{/if}}                            {{#each properties}}                                <td class="row-data{{#if this.actions}}-actions{{/if}}" >                                    {{#if this.actions}}                                        <div class="actions-inline-container">                                            <div class="action-container single-action hidden">                                                <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                            </div>                                            <div class="action-container actions-inline-dotted hidden">                                                <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                            </div>                                        </div>                                    {{/if}}                                    {{#if this.icon}}<img src="{{../../this.icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                    {{#unless this.actions}}{{propertyHelper ../../this ../this}}{{/unless}}                                </td>                            {{/each}}                            '},domEvents:function(){return{"click .row-data":this.dispatchAsEventListener("onClick"),dragstart:this.dispatchAsEventListener("onDrag"),"change .row-check input":this.dispatchAsEventListener("onCheck")}},defaultOptions:{properties:null},init:function(n){n=k.clone(n||{},false);if(!n.attributes){n.attributes={}}k.extend(n.attributes,{draggable:"true"});["className","container","template","tagName","domEvents"].forEach(function(o){delete n[o]});this._parent.call(this,n)},setup:function(){this.container.addClassName(this.getClassNames("-container"));this.listenTo(this.model,"onChange",this.render);if(!this.options.contextualActions&&this.model.actions&&this.model.actions instanceof g){this.listenTo(this.model.actions,{onRemove:this.render,onAdd:this.render,onChange:this.render})}},_initDropDown:function(){var n,q,r,o,p=this;n=this.container.getElement(".actions-inline-dotted");r=this.dropDown=new j({target:n,items:this.contextualActions});this.dropDown.show()},updateContextualActions:function(n){this.options.contextualActions=n;this._updateContextualActions()},_updateContextualActions:function(){var o=this;var q;this.contextualActions=[];var n=function(r){var s=r.handler;if(s){r.handler=function(){s(o)}}if(r.items){r.items.forEach(n)}};if(this.options&&this.options.contextualActions){var p=this.options.contextualActions;if(typeof p==="function"){q=p.apply(this.model)}else{q=k.clone(p)}if(q&&q instanceof Array){q.forEach(n);this.contextualActions=q}}else{if(this.model.actions){if(k.is(this.model.actions,"function")){q=this.model.actions()}else{q=this.model.actions}if(q instanceof g){q=q.map(function(r){return{text:r.get("title"),fonticon:r.get("icon"),multisel:false,handler:function(){o.dispatchEvent("onActionClick",[o,{model:r},arguments[0]])}}});if(q&&q instanceof Array&&q.length>0){this.contextualActions=q}}else{console.log("TileView: actions on model not correctly defined.")}}}},injectSubView:function(p,n){var o=this.container.getElement(n);if(p&&o){this.undelegateDOMEvents();p.render().inject(o);this.delegateDOMEvents()}},setOptions:function(n){this._parent.apply(this,arguments);var o;if(n.properties){o=this.templateHelpers||(this.templateHelpers={});o.properties=n.properties||o.properties||Object.keys(this.model.defaults())}return this},persistCheckbox:function(){var n=this.container.getElement("."+l+"-check");n.addClassName("persist")},unPersistCheckbox:function(){var n=this.container.getElement("."+l+"-check");n.removeClassName("persist")},setShading:function(o){for(var n=0;n<o.length;n++){if(o[n].criteria(this.model)){this.container.setStyle("background-color",o[n].color)}}},resetShading:function(){this.container.style.backgroundColor=""},onBeforeRender:function(){if(this.dropDown){this.dropDown.destroy();delete this.dropDown}if(this.container.getElement(".actions-inline-dotted")){this.container.getElement(".actions-inline-dotted").removeEvent("click")}},mixinTemplateHelpers:function(){var n=this._parent.apply(this,arguments);n.withMultisel=this.options.withMultisel;return n},onRender:function(){var n=this;this.container.addClassName("with-actions");if(this.options.actionButtonBinding){this.options.actionButtonBinding(this)}else{this._updateContextualActions();if(this.contextualActions){if(this.contextualActions.length===1){var o=this.contextualActions[0];this.container.getElement(".single-action").removeClassName("hidden");o.fonticon&&this.container.getElement(".single-action .fonticon").addClassName("fonticon-"+o.fonticon);o.handler&&this.container.getElement(".single-action").addEvent("click",o.handler);if(k.is(o.text)&&o.text.trim().length>0){delete this._actionTooltip;this._actionTooltip=new h({position:"bottom",target:this.container.getElement(".single-action"),body:o.text})}}else{if(this.contextualActions.length>1&&this.container.getElement(".actions-inline-dotted")){this.container.getElement(".actions-inline-dotted").removeClassName("hidden");this.container.getElement(".actions-inline-dotted").addEvent("click",function(p){if(n.contextualActions){if(n.dropDown){return}n.dispatchEvent("onActionClickDotted",n);n._initDropDown()}})}}}}},select:function(n){n||(n={});this.container.addClassName("selected");if(this.container.getElement("."+l+"-check input")){this.container.getElement("."+l+"-check input").checked=true}if(!n.silent){this.dispatchEvent("onSelect")}},unSelect:function(n){this.container.removeClassName("selected");if(this.container.getElement("."+l+"-check input")){this.container.getElement("."+l+"-check input").checked=false}if(n&&!n.silent){this.dispatchEvent("onUnSelect")}},isSelected:function(){return this.container.hasClassName("selected")},destroy:function(){if(this.isDestroyed){return}if(this.actionsView){this.actionsView.destroy();delete this.actionsView}if(this._actionTooltip){this._actionTooltip.destroy();delete this._actionTooltip}return this._parent.apply(this,arguments)}});return c});define("DS/W3DXComponents/Views/Item/ThumbnailView",["DS/W3DXComponents/Views/Item/TileView","css!DS/UIKIT/UIKIT.css","css!DS/W3DXComponents/W3DXComponents"],function(b){var a="thumbnail";var c=b.extend({name:a,init:function(d){this._parent.call(this,d);if(this.getOption("thumbnailType")){var e=this.getOption("thumbnailType");if(e==="small"){this.container.className+=" small-thumbnail-container"}}}});return c});define("DS/W3DXComponents/Views/Layout/TableView",["UWA/Core","DS/W3DXComponents/Views/Temp/TempCompositeView","DS/W3DXComponents/Views/Temp/TempItemView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/Plugins/Multisel","css!DS/W3DXComponents/W3DXComponents"],function(c,d,e,g,b){var a="table";var f=d.extend(b,{name:a,tagName:"table",itemView:g,template:function(){return'                                {{#if headers}}                                    <thead>                                        <tr>                                            {{#if withMultisel}}<th class="'+this.getClassNames("-check")+'"></th>{{/if}}                                            {{#each headers}}                                                <th {{#if actions}}                                                        class="'+this.getClassNames("-actions")+'"                                                    {{else}}                                                        {{#if sortable}}class="sortable"{{/if}} data-property="{{property}}"                                                    {{/if}}                                                >{{label}}</th>                                            {{/each}}                                        </tr>                                    </thead>                                {{/if}}                                <tbody></tbody>                                <tfoot></tfoot>                            '},itemViewContainer:"tbody",defaultOptions:{headers:null,defaultItem:null,selectionMode:"oneToOne",headerOnEmpty:true},domEvents:{"click th.sortable":"onClickHeader"},selectedHeader:{el:null,sort:"descending"},init:function(h){h=c.clone(h||{},false);["container","tagName","template","itemViewEventPrefix","itemViewContainer","domEvents"].forEach(function(i){delete h[i]});this._initSelectionSet();this._parent.call(this,h)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},setOptions:function(h){this._parent.apply(this,arguments);var j;if(h.headers){j=this.templateHelpers||(this.templateHelpers={});j.headers=h.headers||j.headers||[];if(this.templateHelpers.headers.length>0){this.itemViewOptions=c.extend(this.itemViewOptions||{},{properties:j.headers.map(function(o){var m=["property","type","icon","actions"],n={},l;for(var k=0;k<m.length;k++){l=m[k];n[l]=o[l]}return n})},true)}}if(h.sort){this.sort=h.sort}var i=(this.getOption("selectionMode")==="nullToMany")?true:false;this.itemViewOptions=c.merge({withMultisel:i},this.itemViewOptions||{},true);return this},mixinTemplateHelpers:function(){var h=this._parent.apply(this,arguments);h.withMultisel=(this.getOption("selectionMode")==="nullToMany")?true:false;return h},setShadings:function(k){var j;for(var h=0;h<this.collection.length;h++){j=this.getChildView(this.collection._models[h]);j.setShading(k)}},resetShadings:function(){var j;for(var h=0;h<this.collection.length;h++){j=this.getChildView(this.collection._models[h]);j.resetShading()}},sort:function(k,h,i){var j=k.sortBy(function(l){if(UWA.is(i,"function")){return i.call(l)}else{var n=i.split(/[\.\[\]]/),m=null;n.unshift(l.toJSON());m=n.reduce(function(o,p){return o[p]});return m&&m.toLowerCase()}});if(h==="descending"){j.reverse()}k.reset(j);this.dispatchEvent("onSort",[h,i])},onClickHeader:function(j){var i=j.target||j.srcElement;var h=i.dataset?i.dataset.property:i.getAttribute("data-property");h=this.itemViewOptions.mapping?this.itemViewOptions.mapping[h]:h;if(this.selectedHeader.el){this.selectedHeader.el.removeClassName(this.selectedHeader.sort)}this.selectedHeader.el=i;this.selectedHeader.sort=(this.selectedHeader.sort==="descending")?"ascending":"descending";this.selectedHeader.el.addClassName(this.selectedHeader.sort);this.sort(this.collection,this.selectedHeader.sort,h)},selectItemView:function(l,j){var m=this.getOption("selectionMode"),k,i,h;if(!m){return}k=l instanceof e?l:this.getChildView(l);if(!k){return}i=this.currentItemView;h=(i&&i===k);switch(m){case"oneToOne":this.selectOneToOne(k,h,j);break;case"nullToOne":this.selectNullToOne(k,h,j);break;case"nullToMany":this.selectOneToMany(k,j);break;default:break}return k},addSelectedClass:function(h){var i=this.getChildView(h);i.select({silent:true})},removeSelectedClasses:function(){var j;for(var h=0;h<this.collection.length;h++){j=this.getChildView(this.collection._models[h]);j.unSelect({silent:true})}},getSelectedItemView:function(){return this.currentItemView},selectNullToOne:function(j,h,i){this.unSelectAll();if(!h){this.currentItemView=j;j.select()}return j},selectOneToOne:function(j,h,i){if(!h){this.unSelectAll();this.currentItemView=j;j.select()}return j},selectOneToMany:function(i,h){i.select(h);return i},unselectOneToMany:function(h){h.unSelect({silent:true})},unSelectAll:function(i){if(!i){i={}}var h=this.currentItemView;if(!h){return}h.unSelect(i);delete this.currentItemView;if(!i.silent){this.dispatchEvent("onUnSelectAll")}},destroyEmptyView:function(){if(!this.options.headerOnEmpty){this.container.getElement("thead").show()}this._parent.apply(this,arguments)},showEmptyView:function(){if(!this.options.headerOnEmpty){this.container.getElement("thead").hide()}this._parent.apply(this,arguments)},onRender:function(){var h=this.getOption("defaultItem");if(!h){return}this.selectItemView(h)},onActivateMultisel:function(){this.refreshUI()},onDeactivateMultisel:function(){this.cleanUI()},onSetMultisel:function(){this.refreshUI()},onAddSelection:function(h){var i=this.getChildView(h);this.selectOneToMany(i,{silent:true})},onItemRemoved:function(){if(this._selectionState.isActive){this.deactivateMultisel()}},onRemoveSelection:function(h){var i=this.getChildView(h);if(i){this.unselectOneToMany(i)}},cleanUI:function(){var j;for(var h=0;h<this.collection.length;h++){j=this.getChildView(this.collection._models[h]);if(j){j.unPersistCheckbox();j.unSelect()}}this.container.removeClassName(this.getClassNames("-multisel"))},populateUI:function(){var j;if(this._selectionState.isActive){for(var h=0;h<this.collection.length;h++){j=this.getChildView(this.collection._models[h]);j.persistCheckbox()}var l,k=this._selectionState.selectedObjects;for(var h=0;h<k.length;h++){l=this.getChildView(this.collection.get(k[h].id));l.select({silent:true})}this.container.addClassName(this.getClassNames("-multisel"))}else{if(this._selectionState.selectedObjects.length===1){l=this.getChildView(this.collection.get(this._selectionState.selectedObjects[0].id));l.select({silent:true})}}},refreshUI:function(){this.cleanUI();this.populateUI()},onItemViewClick:function(h,i){if(this._selectionState.isActive){this.selectItemView(h,{event:i,silent:true})}else{this.selectItemView(h,{event:i,silent:false})}}});return f});define("DS/W3DXComponents/Views/Layout/TableScrollView",["DS/W3DXComponents/Views/Layout/TableView","DS/W3DXComponents/Views/Layout/NestedScrollView","css!DS/W3DXComponents/W3DXComponents"],function(a,c){var b="table-scroll";var d=c.extend({name:b,nested:a});return d});define("DS/W3DXComponents/Views/Layout/GridView",["UWA/Class/View","DS/W3DXComponents/Views/Plugins/Multisel","DS/W3DXComponents/Views/Temp/TempCollectionView","DS/W3DXComponents/Views/Temp/TempItemView","DS/W3DXComponents/Views/Item/ThumbnailView","UWA/Core","css!DS/W3DXComponents/W3DXComponents","css!DS/UIKIT/UIKIT.css"],function(c,f,i,e,b,j){var k="grid";function d(n,m){if(!a(n)||isNaN(n)||!isFinite(n)||~~n!==n){throw new TypeError("`"+m+"` must be a finite integer")}return n}function a(m){return(m-0)==m}function l(m,o){var n;if(m){n=m[o];if(j.is(n,"function")){n=n.call(m)}}return n}function h(m){if(!m){return}var n;m.itemView&&(n=l(m.itemView.prototype,"className"));return n||""}var g=i.extend(f,{name:k,tagName:"div",itemView:b,defaultOptions:{layout:null,defaultItem:null,selectionMode:"oneToOne",className:"",header:null},init:function(m){m=j.clone(m||{},false);["container","tagName","template","itemViewEventPrefix","domEvents"].forEach(function(n){delete m[n]});this._initSelectionSet();this._parent.call(this,m)},setup:function(){var n=8;this.container.addClassName(this.getClassNames("-container"));if(this.options&&this.options.layout&&this.options.layout.column===1){return}for(var m=0;m<n;m++){UWA.createElement("div",{"class":"by-pass-flex"}).inject(this.container)}},setOptions:function(n){!this._itemViewOptions&&(this._itemViewOptions=(this.itemViewOptions||{}));this._parent.apply(this,arguments);if(n.hasOwnProperty("layout")){var m,p,r=n.layout,s,o,t="";p=(this._itemViewOptions.className?this._itemViewOptions.className:h(this));m={className:p,attributes:{styles:""}};this.container&&this.container.removeClassName("row-layout").removeClassName("column-layout").removeClassName("uikit-layout");r&&(o=r.column);r&&(s=r.row);if(o){if(o.xsmall||o.small||o.medium||o.large){o.xsmall&&(12%o.xsmall===0)&&(t+=(" col-xs-"+12/o.xsmall));o.small&&(12%o.small===0)&&(t+=(" col-sm-"+12/o.small));o.medium&&(12%o.medium===0)&&(t+=(" col-md-"+12/o.medium));o.large&&(12%o.large===0)&&(t+=(" col-lg-"+12/o.large));this.addClassName("uikit-layout");m={className:p+t,attributes:{styles:{flex:"none"}}}}else{this.addClassName("column-layout");m={className:p,attributes:{styles:{height:"",width:(100/o).toFixed(2)+"%",flex:"none"}}}}}else{if(s){this.addClassName("row-layout");m={className:p,attributes:{styles:{width:"",height:(100/s).toFixed(2)+"%",flex:"none"}}}}}this.itemViewOptions=j.merge(m,this._itemViewOptions||{},true)}var q=(this.getOption("selectionMode")==="nullToMany")?true:false;this.itemViewOptions=j.merge({withMultisel:q},this.itemViewOptions||{},true);return this},addClassName:function(m){if(this.container){this.container.addClassName(m)}else{this.options.className||(this.options.className="");this.options.className+=" "+m}return this},setShadings:function(o){var n;for(var m=0;m<this.collection.length;m++){n=this.getChildView(this.collection._models[m]);n.setShading(o)}},resetShadings:function(){var n;for(var m=0;m<this.collection.length;m++){n=this.getChildView(this.collection._models[m]);n.resetShading()}},selectItemView:function(q,o){var r=this.getOption("selectionMode"),p,n,m;if(!r){return}p=q instanceof e?q:this.getChildView(q);if(!p){return}n=this.currentItemView;m=(n&&n===p);switch(r){case"oneToOne":this.selectOneToOne(p,m,o);break;case"nullToOne":this.selectNullToOne(p,m,o);break;case"nullToMany":this.selectOneToMany(p,o);break;default:break}return p},addSelectedClass:function(m){var n=this.getChildView(m);n.select({silent:true})},removeSelectedClasses:function(){var n;for(var m=0;m<this.collection.length;m++){n=this.getChildView(this.collection._models[m]);n.unSelect({silent:true})}},getSelectedItemView:function(){return this.currentItemView},selectNullToOne:function(o,m,n){this.unSelectAll();if(!m){this.currentItemView=o;o.select(n)}return o},selectOneToOne:function(o,m,n){if(!m){this.unSelectAll();this.currentItemView=o;o.select(n)}return o},selectOneToMany:function(n,m){this.currentItemView=n;n.select(m);return n},unselectOneToMany:function(m){m.unSelect({silent:true})},unSelectAll:function(n){if(!n){n={}}var m=this.currentItemView;if(!m){return}m.unSelect(n);delete this.currentItemView;if(!n.silent){this.dispatchEvent("onUnSelectAll")}},appendBuffer:function(n,m){n.container.insertBefore(m,n.container.getElement(".by-pass-flex"))},appendHtml:function(m,o,n){if(m.isBuffering){m.elBuffer.appendChild(o.container);m._bufferedChildren.push(o)}else{m.container.insertBefore(o.container,m.container.getElement(".by-pass-flex"))}},onRender:function(){var m=this.getOption("defaultItem"),n=this.getOption("header");if(j.is(n)){n=(j.is(n,"function")?n.call(this):n);n.inject&&n.inject(this.container,"top")}m&&this.selectItemView(m)},onActivateMultisel:function(){this.refreshUI()},onDeactivateMultisel:function(){this.cleanUI()},onSetMultisel:function(){this.refreshUI()},onAddSelection:function(m){var n=this.getChildView(m);this.selectOneToMany(n,{silent:true})},onItemRemoved:function(){if(this._selectionState.isActive){this.deactivateMultisel()}},onRemoveSelection:function(m){var n=this.getChildView(m);if(n){this.unselectOneToMany(n)}},cleanUI:function(){var n;for(var m=0;m<this.collection.length;m++){n=this.getChildView(this.collection._models[m]);if(n){n.unPersistCheckbox();n.unSelect()}}this.container.removeClassName(this.getClassNames("-multisel"))},populateUI:function(){var n;if(this._selectionState.isActive){for(var m=0;m<this.collection.length;m++){n=this.getChildView(this.collection._models[m]);n.persistCheckbox()}var p,o=this._selectionState.selectedObjects;for(var m=0;m<o.length;m++){p=this.getChildView(this.collection.get(o[m].id));p.select({silent:true})}this.container.addClassName(this.getClassNames("-multisel"))}else{if(this._selectionState.selectedObjects.length===1){p=this.getChildView(this.collection.get(this._selectionState.selectedObjects[0].id));p.select({silent:true})}}},refreshUI:function(){this.cleanUI();this.populateUI()},onItemViewClick:function(m,n){if(this._selectionState.isActive){this.selectItemView(m,{event:n,silent:true})}else{this.selectItemView(m,{event:n,silent:false})}}});return g});define("DS/W3DXComponents/Views/Layout/GridScrollView",["DS/W3DXComponents/Views/Layout/GridView","DS/W3DXComponents/Views/Layout/NestedScrollView","css!DS/W3DXComponents/W3DXComponents"],function(d,b){var a="grid-scroll";var c=b.extend({name:a,nested:d});return c});define("DS/W3DXComponents/Views/Layout/ListView",["DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Item/TileView","css!DS/W3DXComponents/W3DXComponents"],function(a,d){var b="list";var c=a.extend({name:b,defaultOptions:{layout:{column:1},selectionMode:"oneToOne",itemView:d,scrollPosition:"auto",useInfiniteScroll:true,usePullToRefresh:true,scrollDuration:200}});return c});define("DS/W3DXComponents/Views/Layout/ChannelView",["UWA/Core","DS/W3DXComponents/Views/Layout/GridScrollView","css!DS/W3DXComponents/W3DXComponents"],function(d,a){var c="channel";var b=a.extend({name:c,defaultOptions:{layout:{row:1},orientation:"horizontal",useInfiniteScroll:true,usePullToRefresh:true}});return b});define("DS/W3DXComponents/Views/Temp/TempAutocomplete",["UWA/Core","UWA/Event","UWA/String","DS/W3DXComponents/Views/Temp/DeprecatedAutocomplete","DS/UIKIT/Spinner","i18n!DS/W3DXComponents/assets/nls/Views/Temp/TempAutocomplete","css!DS/W3DXComponents/W3DXComponents"],function(i,e,b,g,c,j){var h=g.extend({_prevText:"",_suggestsIndex:0,defaultOptions:{attributes:{type:"autocomplete",autocomplete:"off"},className:"temp-autocomplete"},resizeSuggests:function(){return},init:function(k){this._parent(k);k=k||{};this.collection=(k.collection)?k.collection:null;this.getSuggestions=k.getSuggestions||this.getSuggestions;this.suggestDistinction=k.suggestDistinction||this.suggestDistinction},attachEvents:function(){this._parent.apply(this,arguments);var k=this.elements;k.input.addEvent("keydown",this.onKeyDown.bind(this));k.input.addEvent("paste",this.onPaste.bind(this));k.input.addEvent("drop",this.onPaste.bind(this))},getId:function(){return this.elements.input.id},getName:function(){return this.elements.input.name},getFormattedLabel:function(k){return this.options.labelFormat.replace(/\{(\w+)\}/g,function(n,o){var l=UWA.is(k,"string")?k:k[o];return l})},suggestDistinction:function(k){return false},successProcess:function(l,m){l=UWA.is(l,"string")?this.dataParse(l):l;if(l.length===0&&this.options.onEmailAddress){if(b.isEmail(m)){var k=this.options.onEmailAddress(m);if(k){l=[k]}}}if(l.length>0){this.dataCache[m]=l}this.dispatchEvent("onUpdateSuggests",[l]);this.elements.spin.hide();this.typeTimeout=null},onUpdateSuggests:function(n){var p=this,o,u,t,s=this.elements,k;s.suggests.empty();if(Array.isArray(n)&&n.length>0){var l=function(){var x=function(y){var z=p.options.suggestKey?y[p.options.suggestKey]:b.stripTags(p.getFormattedSuggest(y));p.elements.input.set({"data-key":z});p.dispatchEvent("onSelect",[z,y,k])}.bind(this,v);var w=navigator.userAgent.match(/(iPhone|iPad|iPod)/g)?true:false;if(w){u.addEvent("touchstart",x)}else{u.addEvent("click",x);u.addEvent("mouseover",function(z){var y=e.getElement(z);s.suggests.getElement(".selected").removeClassName("selected");y.parentNode.addClassName("selected")})}};var r=Math.min(n.length,8);for(var m=0;m<r;m++){var v=n[m];var q=this.getFormattedSuggest(v);k=this.suggestDistinction(v);q=k?q+" ("+k+")":q;if(this.options.suggestKey){this.itemCache[v[this.options.suggestKey].toLowerCase()]=v}o=UWA.createElement("li");u=UWA.createElement("a",{text:q}).inject(o);o.inject(s.suggests);if(k){o.addClassName("distinct");if(this.options.unlockDistinctClick){l()}else{o.addClassName("locked")}}else{l()}}t=this.elements.suggests.getElement("li:not(.locked)");if(t){t.addClassName("selected")}p._suggestsIndex=0;this.resizeSuggests()}else{o=UWA.createElement("li");u=UWA.createElement("a").inject(o);u.setHTML(j.NoResults);o.inject(s.suggests);o.addClassName("error-suggest")}this.dispatchEvent("onShowSuggests")},onSelect:function(k,l){if(l){this.elements.input.value=this.getFormattedLabel(l);this.resetInput();this.onHideSuggests();setTimeout(function(){this.getFocus()}.bind(this),100)}},onBlur:function(k){setTimeout(function(){this.dispatchEvent("onHideSuggests")}.bind(this),200)},onFocus:function(l){var n=this,m=this.elements,k=e.getElement(l);if(m.input.value===this.options.placeholder){m.input.value=""}this.getSuggestions(k.value,this.dataCache,function(o){n.successProcess(o,k.value)});this.dispatchEvent("onFocused",l)},onShowSuggests:function(){var k=this.elements;if(k.input.value.length>0){k.container.addClassName(this.options.className+"-suggestsDisplayed")}},onPaste:function(k){setTimeout(function(){this.onKeyUp(k)}.bind(this),50)},onKeyDown:function(p){var o=this;var n=o.elements.suggests.getElements("li:not(.locked)");var m=n[o._suggestsIndex];var k=p.code||p.key;function l(r){var q=o._suggestsIndex+r;if(n[q]){m.removeClassName("selected");o._suggestsIndex=q;n[q].addClassName("selected")}}if(o.elements.container.hasClassName(this.options.className+"-suggestsDisplayed")){switch(k){case"Escape":case"Esc":o.onHideSuggests();break;case"ArrowDown":case"Down":l(1);break;case"ArrowUp":case"Up":l(-1);break;case"Enter":case"NumpadEnter":if(m&&m.getElement("a")){m.getElement("a").triggerEvent("click")}break;default:return}e.stop(p)}else{if(k==="ArrowDown"||k==="Down"){o.onShowSuggests()}}},onKeyUp:function(l){var n=this;var k=this.elements.input;var m=k.value;if(m===this._prevText){return}else{if(m.trim().length===0){this.resetInput();this.onHideSuggests();this.typeTimeout=null;return}else{this._prevText=m;k.removeAttribute("data-key");if(m.length>=this.options.minLength){clearTimeout(this.typeTimeout);this.showSpin();this.typeTimeout=setTimeout(function(){this.getSuggestions(m,this.dataCache,function(o){n.successProcess(o,m)})}.bind(this),this.options.typeDelay)}}}},resetInput:function(l){this.elements.input.value="";this._prevText="";var k=document.createEvent("HTMLEvents");k.initEvent("change",false,true);this.elements.input.dispatchEvent(k);if(l){this.resetCache()}},showSpin:function(){var l,k=this.elements;k.suggests.empty();this.elements.spin.show();l=UWA.createElement("li");l.addClassName("li-spinner");this.elements.spin.inject(l);l.inject(k.suggests);this.dispatchEvent("onShowSuggests")},buildSkeleton:function(){this._parent.apply(this,arguments);if(this.options.id){this.elements.input.id=this.options.id}if(this.options.name){this.elements.input.name=this.options.name}if(this.options.attributes){this.elements.input.set(this.options.attributes)}this.elements.spin=new c({className:"small"});new a(this.elements.input,this.options.container)}});var f,d;f=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"];d=20;function a(l,k){var q;function m(){if(window.getComputedStyle){return window.getComputedStyle(l)}return l.currentStyle}function o(){return k}function s(){var v,u,t;v=m();for(t=0;t<f.length;t++){u=v[f[t]];if(u!==undefined&&u!==null){q.style[f[t]]=u}}q.disabled="disabled";q.style.whiteSpace="pre";q.style.position="absolute";q.style.top=q.style.left="-9999em"}function p(){var u,t;u=l.value||l.placeholder;if(u===q.value){return}q.setText(u);t=q.offsetWidth+d;if(k&&k.offsetWidth){t=(k.offsetWidth>q.offsetWidth)?q.offsetWidth:k.offsetWidth-4}l.style.width=t+"px"}function n(t){var u;u=t?"remove":"add";l[u+"Event"]("keydown",p);l[u+"Event"]("keyup",p);l[u+"Event"]("input",p);l[u+"Event"]("paste",p);l[u+"Event"]("change",p)}function r(){n(true);q.destroy();l.style.width=""}q=i.createElement("span");document.body.appendChild(q);s();n();p();return{remap:s,refresh:p,destroy:r}}return h});define("DS/W3DXComponents/Views/Item/MultiselView",["UWA/Core","UWA/Event","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/UIKIT/Tooltip","i18n!DS/W3DXComponents/assets/nls/Views/Item/MultiselView","css!DS/W3DXComponents/W3DXComponents"],function(b,d,g,c,f){var a="multisel-action-view";var e=g.extend({tagName:"div",template:function(){return'                                <div class="'+this.getClassNames("-multisel-button")+'">                                    <input type="checkbox" id="{{cid}}-multisel-button" name="{{cid}}-buttons" value="multisel"/>                                    <label class="multisel-label fonticon fonticon-2x fonticon-select-on" for="{{cid}}-multisel-button"></label>                                    <div class="multisel-counter">{{counter}}</div>                                </div>                                <div class="'+this.getClassNames("-wrapper")+'"></div>                                <div class="action-container actions-inline-dotted hidden">                                    <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-open-down"></span></div>                                </div>                            '},domEvents:{"change input":"onChangeInput",},init:function(h){this.buildMultiselActions=h.buildMultiselActions||function(){return[]};this._parent.apply(this,arguments)},setup:function(){this._parent.apply(this,arguments);var h=this.templateHelpers||(this.templateHelpers={});h.counter=h.counter||0;this.isInMultiselMode=false},onChangeInput:function(i){var h=d.getElement(i);if(h.checked){this.dispatchEvent("onMultiselOn",[this,h.value])}else{this.exitMultisel();this.dispatchEvent("onMultiselOff",[this,h.value])}},resetMultisel:function(){this.templateHelpers.counter=0;this.collection.reset();this.container.getElement("input").checked=false},_filterActions:function(k,i){var h=[],m=UWA.clone(k);for(var l=0;l<m.length;l++){if(m[l].items){var n=m[l];n.items=this._filterActions(m[l].items,i);h.push(n)}else{if(m[l].id){if(i.indexOf(m[l].id)>-1){if(m[l].multisel){h.push(m[l])}}}else{if(m[l].multisel){h.push(m[l])}}}}return h},buildMultisel:function(h){if(h.isActive){var i=h.selectedObjects.length;this._updateCounter(i);this.selectedModels=h.selectedObjects;this.contextualActions=this.options.contextualActions=this.buildMultiselActions(this.selectedModels);this.render();this.container.getElement("input").checked="checked";this.dottedElem.removeClassName("hidden");this.dispatchEvent("onDottedVisible");if((i===0)&&!h.wasExplicitlyActivated){this.exitMultisel()}}},getContextualArg:function(){return this.selectedModels},_executeHandler:function(j,h,i){i(this.selectedModels)},_updateCounter:function(h){this.templateHelpers.counter=h;this.container.getElement(".multisel-counter").setText(h)},exitMultisel:function(){this.container.getElement("input").checked=false;this._updateCounter(0);this.destroyDropDown();this.dottedElem.addClassName("hidden");this.dispatchEvent("onDottedHidden")},setOptions:function(h){this._parent.apply(this,arguments);var i=this.collection;if(i){this.listenTo(i,{onReset:function(){this.render();this.container.getElement("input").checked="checked"}})}return this},onRender:function(){this._parent.apply(this,arguments);delete this.tooltip;this.tooltip=new c({position:"bottom",target:this.container.getElement(".multisel-label"),body:f.tooltipMultiselIcon})}});return e});define("DS/W3DXComponents/Views/Item/SwitcherView",["UWA/Core","UWA/Utils","UWA/Event","DS/W3DXComponents/Views/Temp/TempItemView","DS/UIKIT/Tooltip","DS/UIKIT/IconDropdown","css!DS/W3DXComponents/W3DXComponents"],function(c,b,g,f,e,h){var a="switcher";var d=f.extend({name:a,tagName:"div",template:function(){if(this.getOption("tempSingleIconOnMobile")){return'                            {{#each buttons}}                                <div style="display: none;" class="'+this.getClassNames("-button")+'">                                    <input type="radio" id="{{../cid}}-{{id}}-button" name="{{../cid}}-buttons" value="{{id}}" {{#if default}}checked="checked"{{/if}}/>                                    <label for="{{../cid}}-{{id}}-button"/>                                </div>                            {{/each}}                            <div class="'+this.getClassNames("-button")+'">                              <label id="switch-view-button"/>                                <span style="font-size: 24px; margin: 0;" class="fonticon fonticon-view-big-thb"></span>                              </label>                            </div>                                                        '}else{return'                            {{#each buttons}}                                <div class="'+this.getClassNames("-button")+'">                                    <input type="radio" id="{{../cid}}-{{id}}-button" name="{{../cid}}-buttons" value="{{id}}" {{#if default}}checked="checked"{{/if}}/>                                    <label for="{{../cid}}-{{id}}-button"/>                                </div>                            {{/each}}                            '}},domEvents:{"change input":"onChange"},defaultOptions:{buttons:[]},init:function(i){i=c.clone(i||{},false);["container","template","tagName","domEvents"].forEach(function(j){delete i[j]});this._parent.call(this,i)},setup:function(){var i=this.templateHelpers||(this.templateHelpers={});this.container.addClassName(this.getClassNames("-container"));i.buttons=i.buttons||this.getOption("buttons")},onRender:function(){var o=this;if(this.getOption("tempSingleIconOnMobile")){var i=c.extendElement(o.container).getElement("#switch-view-button");var n=o.options.buttons.filter(function(p){return p["default"]})[0];n=n?n:{};var m=function(p){switch(p){case"thumbnail":return"view-small-thb";case"tilebig":return"view-big-tile";case"tile":return"view-small-tile";case"table":return"view-list";default:return""}};var l=[];o.options.buttons.forEach(function(p){l.push({name:p.id,fonticon:m(p.id),description:p.title,selectable:true,selected:(n.id===p.id)?true:false})});var k=new e({position:"bottom",target:i});var j=new h({target:i,items:l,events:{onClick:function(q,p){if(!p.actived){o.dispatchEvent("onSwitch",[o,p.name]);this.items.forEach(function(r){r.actived=false});p.actived=true;i.children[0].className=p.elements.icon.className;k.setBody(p.description)}}}});j.items.forEach(function(p){if(p.name===n.id){i.children[0].className=p.elements.icon.className;k.setBody(p.description)}})}else{this.options.buttons.forEach(function(p){if(c.is(p.title)&&p.title.trim().length>0){var q=c.extendElement(o.container).getElement("#"+o.cid+"-"+p.id+"-button");new e({position:"bottom",target:q.getParent(),body:p.title})}})}},clear:function(){var i=this.container.getElements("input");i.map(function(j){j.removeAttribute("checked")})},setValue:function(j){var i=this.container.getElement("input#"+this.cid+"-"+j+"-button");if(!c.is(i)){return}this.clear();i.setAttribute("checked","checked");this.dispatchEvent("onSwitch",[this,j])},getValue:function(){var j=this.container.getElements("input"),k,m;for(var l=0;k=j[l];l++){if(k.checked){m=k;break}}return m.value},onChange:function(j){var i=g.getElement(j);if(i.checked){this.dispatchEvent("onSwitch",[this,i.value])}}});return d});define("DS/W3DXComponents/Views/Item/SetView",["DS/W3DXComponents/Views/Item/SwitcherView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Temp/TempItemView","DS/W3DXComponents/Collections/ActionsCollection","UWA/Core","DS/W3DXComponents/Views/Item/MultiselView","css!DS/W3DXComponents/W3DXComponents"],function(a,b,j,d,f,h,c){var i="set";function e(o,m,n){var l;o.forEach(function(p){if(p[m]===n){l=p}});return l}function k(l,n){var m;if(l){m=l[n];if(h.is(m,"function")){m=m.call(l)}}return m}var g=d.extend({name:i,tagName:"div",template:function(){return'                        <div class="'+this.getClassNames("-header")+'">                            <div class="'+this.getClassNames("-detail")+'"></div>                            <div class="'+this.getClassNames("-actions")+'"></div>                            <div class="'+this.getClassNames("-multiselHeader")+'"></div>                            <div class="'+this.getClassNames("-switcher")+'"></div>                        </div>                        <div class="'+this.getClassNames("-contents")+'"></div>                    '},defaultOptions:{actions:{},switcher:{},detail:{},multiselHeader:{},contents:{},multiselAction:{id:"multisel",icon:"check",overflow:false}},actions:b,switcher:a,detail:j,multiselHeader:c,init:function(l){l=h.clone(l||{},false);l&&l.actions&&l.actions.view&&(this.actions=l.actions.view);l&&l.detail&&l.detail.view&&(this.detail=l.detail.view);l&&l.switcher&&l.switcher.view&&(this.switcher=l.switcher.view);l&&l.multiselHeader&&l.multiselHeader.view&&(this.multiselHeader=l.multiselHeader.view);["container","template","tagName"].forEach(function(m){delete l[m]});this._parent.call(this,l)},setup:function(){var p=this.getOption("contents"),o=(this.getOption("contents").selectionMode==="nullToMany")?true:false,n=this.getOption("defaultView"),l;this.container.addClassName(this.getClassNames("-container"));for(var m=0;m<p.views.length;m++){if(p.views[m]["default"]){l=p.views[m];break}}if(l){console.log("DS/W3DXComponents/Views/Item/SetView - Use of deprecated option contents.views[n].default=true, use contents.defaultView instead");n=l.id}if(!n){n=p.views[0].id}this.currentViewId=n;this._initDetailView();if(o){this._initMultiselHeaderView()}this._initActionsView();this._initSwitcherView();this._initContentsViews(p.views)},_initDetailView:function(){var n,l,m=k(this,"detail");n=this.detailView=new m(this.getDetailViewOptions());return n},getDetailViewOptions:function(){return h.extend(this.getOption("detail"),{collection:this.collection})},_initMultiselHeaderView:function(){if(!this.getOption("actions").collection){return}var p={},q="onItemViewSelect",o=this,m,n,l=k(this,"multiselHeader");n=this._multiselHeaderViewEvents={onMultiselOn:function(){this.contentsViews[this.currentViewId].nestedView.activateMultisel(true);this.dispatchEvent("onMultiselOn",arguments)},onMultiselOff:function(){this.contentsViews[this.currentViewId].nestedView.deactivateMultisel();this.dispatchEvent("onMultiselOff",arguments)},onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onActionClick",arguments)}};m=this.multiselHeaderView=new l(this.getMultiselHeaderViewOptions());this.listenTo(m,n);return m},getMultiselHeaderViewOptions:function(){var n=new f();var m=(this.getOption("contents").selectionMode==="nullToMany")?true:false;var l=this.getOption("buildMultiselActions");n=(h.is(n,"function")?n.call(this):n);return{collection:n,withMultisel:m,buildMultiselActions:l}},buildMultiselOnCheck:function(l){if(this.multiselHeaderView){var m=this.contentsViews[this.currentViewId].nestedView;var n=m.getSelectionState();if(m.isSelected(l)){m.removeSelection(l)}else{if(!n.isActive){m.activateMultisel(false)}m.addSelection(l)}this.multiselHeaderView.buildMultisel(n)}if(m.selectionIsEmpty()&&!n.wasExplicitlyActivated){m.deactivateMultisel()}},buildMultiselOnClick:function(l){if(this.multiselHeaderView){var m=this.contentsViews[this.currentViewId].nestedView;var n=m.getSelectionState();if(n.isActive){if(m.isSelected(l)){m.removeSelection(l)}else{m.addSelection(l)}this.multiselHeaderView.buildMultisel(n)}else{m.deactivateMultisel();m.addSelection(l)}if(m.selectionIsEmpty()&&!n.wasExplicitlyActivated){m.deactivateMultisel()}}},_initActionsView:function(){if(!this.getOption("actions").collection){return}var m,l,n=k(this,"actions");l=this._actionsViewEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onActionClick",arguments)},onVisibilityChange:this.onVisibilityChange};m=this.actionsView=new n(this.getActionsViewOptions());this.listenTo(m,l);return m},getActionsViewOptions:function(){var l=this.getOption("actions"),m=l.collection;m=(h.is(m,"function")?m.call(this):m);return h.merge({collection:m},l)},_initSwitcherView:function(){var n,l,m=k(this,"switcher");l=this._switcherViewEvents={onSwitch:function(){Array.prototype.unshift.call(arguments,this.switcherView);this.dispatchEvent("onSwitch",arguments)}};n=this.switcherView=new m(this.getSwitcherViewOptions());this.listenTo(n,l);return n},getSwitcherViewOptions:function(){return h.extend(this.getOption("switcher"),{buttons:this.getOption("contents").views,tempSingleIconOnMobile:this.getOption("tempSingleIconOnMobile")})},_initContentsViews:function(l){this.contentsViews={};l.forEach(function(m,n){if(this.currentViewId===m.id){this.contentsViews[m.id]=this._buildContentsView(m)}else{if(!this.getOption("lazyRender")){this.contentsViews[m.id]=this._buildContentsView(m)}}},this);return this.contentsViews},getContentsViewOptions:function(l){var m=this.getOption("contents"),n=h.extend(UWA.clone(m),l,true);return h.extend(n,{collection:this.collection})},_buildContentsView:function(l){if(!l||!l.view){return}if(this.contentsViews[l.id]){throw new Exception("View is already built")}var m=new l.view(this.getContentsViewOptions(l));var n={onItemViewDrag:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onItemViewDrag",arguments)},onItemViewCheck:function(){Array.prototype.unshift.call(arguments,m);if(arguments[2] instanceof d){this.buildMultiselOnCheck(arguments[2].model)}else{this.buildMultiselOnCheck(arguments[2])}this.dispatchEvent("onItemViewCheck",arguments)},onItemViewClick:function(){Array.prototype.unshift.call(arguments,m);if(arguments[2] instanceof d){this.buildMultiselOnClick(arguments[2].model)}else{this.buildMultiselOnClick(arguments[2])}this.dispatchEvent("onItemViewClick",arguments)},onItemViewDblClick:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onItemViewDblClick",arguments)},onItemViewContextMenu:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onItemViewContextMenu",arguments)},onItemViewSelect:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onItemViewSelect",arguments)},onAddSelection:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onAddSelection",arguments)},onRemoveSelection:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onRemoveSelection",arguments)},onDeactivateMultisel:function(){Array.prototype.unshift.call(arguments,m);this.multiselHeaderView.exitMultisel();this.dispatchEvent("onDeactivateMultisel",arguments)},onUnSelectAll:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onUnSelectAll",arguments)},onInfiniteScroll:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onInfiniteScroll",arguments)},onPullToRefresh:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onPullToRefresh",arguments)},onRender:function(){Array.prototype.unshift.call(arguments,m);this.dispatchEvent("onRenderContentView",arguments)},onDestroy:function(){Array.prototype.unshift.call(arguments,m);this.stopListening(m);this.dispatchEvent("onDestroyContentView",arguments)}};this.listenTo(m,n);m.container.hide();return m},onRender:function(){var l=this.name;if(!this.currentViewId){throw Exception("No default view defined")}this.injectSubView(this.multiselHeaderView,"."+l+"-multiselHeader");this.dispatchEvent("onMultiselHeaderView",this.multiselHeaderView);this.injectSubView(this.detailView,"."+l+"-detail");this.dispatchEvent("onRenderDetailView",this.detailView);this.actionsView&&this.injectSubView(this.actionsView,"."+l+"-actions")&&this.dispatchEvent("onRenderActionsView",this.actionsView);for(var m in this.contentsViews){if(this.contentsViews[m]){this.injectSubView(this.contentsViews[m],"."+this.name+"-contents")}}this.injectSubView(this.switcherView,"."+l+"-switcher");this.dispatchEvent("onRenderSwitcherView",this.switcherView);this.switcherView.setValue(this.currentViewId);return this},showContentsView:function(r,u){var s,o;if(!this.contentsViews[r]){var l=this.getOption("contents");for(var m=0;m<l.views.length;m++){if(l.views[m].id===r){o=l.views[m];break}}this.contentsViews[r]=this._buildContentsView(o);this.injectSubView(this.contentsViews[r],"."+this.name+"-contents")}var q=this.contentsViews[r];u||(u={});s=u.selectedItemView;s&&(s=this.selectItemView(s.model,{silent:true,view:q}));q.container.show();s?this.scrollToItemView(s,{view:q,scrollPosition:this.getContentsViewOptions().scrollPosition}):false;if(this.currentShadings){if(q.setShadings){q.setShadings(this.currentShadings)}}else{if(q.resetShadings){q.resetShadings()}}var t=(q.nestedView.options.selectionMode==="nullToMany")?true:false;if(t){var n=this.contentsViews[this.currentViewId];if(n&&n.nestedView.options.selectionMode!=="nullToMany"){n.nestedView.resetSelectionState()}if(n&&n.nestedView.getSelectionState&&q.nestedView.setMultisel){if(n.nestedView.getSelectionState()){var p=h.extend({},n.nestedView.getSelectionState());q.nestedView.setMultisel(p);this.multiselHeaderView.buildMultisel(p)}}}this.currentViewId=r},injectSubView:function(n,l){var m=this.container.getElement(l);if(n&&m){this.undelegateDOMEvents();m.grab(n.render().getContent());this.delegateDOMEvents()}},switchView:function(l){this.switcherView.setValue(l)},selectItemView:function(m,l){l||(l={});var n=(l.view||this.contentsViews[this.currentViewId]);return(n&&n.selectItemView&&n.selectItemView(m,l))},selectItemViews:function(){if(this.getSelection()){var m=this.getSelection()._models;for(var l=0;l<m.length;l++){this.selectItemView(m[l],{silent:true})}}},getSelectedItemView:function(l){l||(l={});var m=(l.view||this.contentsViews[this.currentViewId]);return(m&&m.getSelectedItemView&&m.getSelectedItemView())},getSelection:function(){return this.contentsViews[this.currentViewId].nestedView.getSelection()},unSelectAll:function(l){l||(l={});var m=(l.view||this.contentsViews[this.currentViewId]);return(m&&m.unSelectAll&&m.unSelectAll(l))},setShadings:function(l){l=l||{};this.currentShadings=l;var m=(l.view||this.contentsViews[this.currentViewId]);return(m&&m.setShadings&&m.setShadings(this.currentShadings))},resetShadings:function(){this.currentShadings=null;var l=this.contentsViews[this.currentViewId];return(l&&l.resetShadings&&l.resetShadings())},scrollToItemView:function(m,l){l||(l={});var n=(l.view||this.contentsViews[this.currentViewId]);return(n&&n.scrollToItemView&&n.scrollToItemView(m,l.scrollPosition))},scrollToPosition:function(m,l){l||(l={});var n=(l.view||this.contentsViews[this.currentViewId]);return(n&&n.scrollToPosition&&n.scrollToPosition(m.x,m.y))},minimize:function(){if(this.isMinimized){return}this.isMinimized=true;this.container.addClassName("minimized");this.dispatchEvent("onMinimized")},maximize:function(){if(!this.isMinimized){return}this.isMinimized=false;this.container.removeClassName("minimized");this.dispatchEvent("onMaximized")},onVisibilityChange:function(){var l=arguments[arguments.length-1];if(!l.length){this.getElement(".set-actions").removeClassName("with-actions")}else{this.getElement(".set-actions").addClassName("with-actions")}},onSwitch:function(){var n=arguments[arguments.length-1],q=this.getOption("contents").views,m=e(q,"id",n),o,p=this.getSelectedItemView();var l=this.currentViewId,o=this.contentsViews[l];l=arguments[arguments.length-1];if(o){o.container.hide();o.unSelectAll({silent:true})}if(l){this.showContentsView(l,{selectedItemView:p})}},onShow:function(){this.detailView&&this.detailView.dispatchEvent("onShow");this.switcherView&&this.switcherView.dispatchEvent("onShow");this.actionsView&&this.actionsView.dispatchEvent("onShow");this.multiselHeaderView&&this.multiselHeaderView.dispatchEvent("onShow")},destroyContentsViews:function(){for(var l in this.contentsViews){if(this.contentsViews[l]){this.contentsViews[l].destroy()}}this.contentsViews.length=0},destroy:function(){if(this.isDestroyed){return}this.actionsView&&this.stopListening(this.actionsView,this._actionsViewEvents);this.stopListening(this.switcherView,this._switcherViewEvents);if(this.detailView){this.detailView.destroy();delete this.detailView}if(this.multiselHeaderView){this.multiselHeaderView.destroy();delete this.multiselHeaderView}if(this.actionsView){this.actionsView.destroy();delete this.actionsView}if(this.switcherView){this.switcherView.destroy();delete this.switcherView}this.destroyContentsViews();return this._parent.apply(this,arguments)}});return g});define("DS/W3DXComponents/MemberSet",["UWA/Core","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/SetView","DS/W3DXComponents/Views/Item/TileView","DS/W3DXComponents/Collections/ActionsCollection","i18n!DS/W3DXComponents/assets/nls/MemberSet","css!DS/W3DXComponents/W3DXComponents"],function(d,j,h,b,g,a,f){var e="member-set";function i(k,m){var l;if(k){l=k[m];if(d.is(l,"function")){l=l.call(k)}}return l}var c=b.extend({name:e,defaultOptions:{contents:{views:[{id:"tile",title:f.titleTileView,view:j,itemView:g,"default":true},{id:"table",title:f.titleTableView,view:h}],}},template:function(){return'                <div class="'+this.getClassNames("-header")+'">                    <div class="'+this.getClassNames("-multiselHeader")+'"></div>                    <div class="'+this.getClassNames("-detail")+'"></div>                    <div class="'+this.getClassNames("-actions")+'"></div>                    <div class="'+this.getClassNames("-switcher")+'"></div>                </div>                <div class="'+this.getClassNames("-slidepanel")+'"></div>                <div class="'+this.getClassNames("-contents")+'"></div>            '},init:function(k){this._parent(k)},setup:function(){this._parent.apply(this,arguments);if(this.options.slidepanel){this.slidepanel=this.options.slidepanel;this._initSlidepanelView()}},_initSlidepanelView:function(){var l,k=i(this,"slidepanel");l=this.slidepanelView=new k.view(this.getSlidepanelViewOptions());return l},getSlidepanelViewOptions:function(){var k=this;return d.extend(this.getOption("slidepanel").viewOptions,{collection:this.collection,onClose:function(){k.refreshHeight()}})},togglePanel:function(){if(this.slidepanelView.container.hasClassName("expanded")){this.slidepanelView.hide()}else{this.slidepanelView.show();this.slidepanelView.getElement("tr:not(.hidden) input").focus()}this.refreshHeight()},onRender:function(){this.injectSubView(this.slidepanelView,"."+e+"-slidepanel");this._parent.apply(this,arguments)},refreshHeight:function(){var l=this.container.getElement("."+e+"-slidepanel");var k=this.container.getElement("."+e+"-contents");var m=this.container;var n=m.getSize().height-l.getSize().height-50;k.setStyle("height",n+"px")},});return c});define("DS/W3DXComponents/Views/Item/LabelManagerView",["UWA/Core","UWA/Event","UWA/Element","UWA/Utils","DS/W3DXComponents/Views/Temp/TempItemView","DS/W3DXComponents/Views/Temp/TempAutocomplete","css!DS/W3DXComponents/W3DXComponents"],function(g,f,a,b,c,e){var h="labelselector-item-view";var d=function(m,k,l){var j;m.forEach(function(n){if(n[k]===l){j=n}});return j};var i=c.extend({tagName:"div",className:h+"-container",name:h,template:function(){return'                                <table>                                    {{#each categories}}                                        <tr class="tr-{{id}}">                                            <td>                                                <span id="{{id}}-label">{{name}}</span>                                            </td>                                            <td>                                                <div id="{{id}}-wrapper" class="'+h+'-wrapper"></div>                                            </td>                                        </tr>                                    {{/each}}                                </table>'},domEvents:{"click .supp-icon":"onClickSuppCalled","click tr":"onLineClick"},init:function(j){j=j||{};this.collection=(j.collection)?j.collection:null;this._parent(j);this.newObjects=[];document.body.addEventListener("mousedown",this.clickOutside.bind(this))},setup:function(){var j=this.templateHelpers||(this.templateHelpers={});j.categories=j.categories||(this.options.categories||[])},clickOutside:function(j){if(j.target!==this.container&&!this.container.contains(j.target)){this.container.removeClassName("highlighted");if(this.container.getElement(".highlighted")){this.container.getElement(".highlighted").removeClassName("highlighted")}}},onLineClick:function(l){var j=f.getElement(l);var k=j.getElement("input");k.focus()},onFocus:function(l){var k=f.getElement(l);var j=k.dataset?k.dataset.category:k.getAttribute("data-category");if(this.container.getElement(".highlighted")){this.container.getElement(".highlighted").removeClassName("highlighted")}this.container.getElement("#"+j+"-label").addClassName("highlighted");this.container.addClassName("highlighted")},onClickSuppCalled:function(k){var j=f.getElement(k);this.removeObject(j.parentElement.dataset.id)},validateSelection:function(j,k){this.newObjects.map(function(l){if(l.item===k){j=l.selection}});return j=j||b.getUUID()},addObject:function(m,p,o,k,n){var m=this.validateSelection(m,o);if(!this.options.allowMultipleCategories){this.removeObject(m)}var l=this.autocomplete.getFormattedLabel(o);this.renderOneLabel(m,l,n);var j={selection:m,categoryId:p,prevDistinction:k,item:o};this.newObjects.push(j);this.dispatchEvent("onUpdate",[this.newObjects])},removeObject:function(l){var j=this.container.getElement('[data-id="'+l+'"]');if(j){var k=d(this.newObjects,"selection",l);this.newObjects.splice(this.newObjects.indexOf(k),1);j.remove();this.dispatchEvent("onUpdate",[this.newObjects])}},renderOneLabel:function(l,k,j){new a("span",{"data-id":l,"class":"label-object",html:[{tag:"div","class":"formatted-label",text:k},{tag:"div","class":"supp-icon",html:"&times;"}]}).inject(j,"before")},getJsonObjects:function(){return this.newObjects},attachAutocomplete:function(l,j){var k=this;g.extend(this.options,{collection:this.collection,container:j,events:{onSelect:function(n,o,m){if(o){k.addObject(n,l,o,m,this.getContent())}},onFocused:function(m){k.onFocus(m)}},attributes:{"data-category":l}});if(this.options.autocompleteExtension){this.autocomplete=new this.options.autocompleteExtension(this.options)}else{this.autocomplete=new e(this.options)}return this.autocomplete.inject(j)},onRender:function(){var j=this.options.categories;for(var k=0;k<j.length;k++){this.attachAutocomplete(j[k].id,this.container.getElement("#"+j[k].id+"-wrapper"))}}});return i});define("DS/W3DXComponents/Views/Item/PanelAddMemberView",["UWA/Core","UWA/Element","UWA/Class/View","DS/W3DXComponents/Views/Item/LabelManagerView","DS/UIKIT/Input/Button","i18n!DS/W3DXComponents/assets/nls/Views/Item/PanelAddMemberView","css!DS/W3DXComponents/W3DXComponents"],function(e,c,d,h,b,g){var a="paneladdmember-item-view";var f=d.extend({tagName:"div",className:a+"-container",name:a,labels:[],init:function(i){this.options=i;if(this.options.saveProcess){this.saveProcess=this.options.saveProcess}this.onClose=this.options.onClose?this.options.onClose:function(){return};this._parent(i);this.buildSkeleton()},buildSkeleton:function(){this.buildBody();this.buildButton();this.container.setHTML([this.elements.labelmanager,this.elements.buttons])},buildButton:function(){var j=this;var i=new b({value:g.Add,className:"primary",disabled:true,events:{onClick:function(){j.onSaveCalled()}}});var k=new b({value:g.Cancel,className:"default",events:{onClick:function(){j.onCancelCalled()}}});this.elements.buttons=e.createElement("div",{"class":a+"-buttons"});this.elements.buttons.save=i;this.elements.buttons.cancel=k;this.elements.buttons.addContent([i,k])},buildBody:function(){var j=this;var i=e.extend({spreadClick:true,events:{onUpdate:function(k){j.elements.buttons.save.setDisabled(k.length<1);j.labels=k}}},this.options);this.addMemberBody=new h(i);this.elements.labelmanager=e.createElement("div",{"class":a+"-body",html:this.addMemberBody.render()})},saveProcess:function(j){for(var k=0;k<j.length;k++){this.collection.add({people:j[k].selection,role:j[k].categoryId})}},show:function(){this.container.addClassName("expanded")},hide:function(){this.container.removeClassName("expanded")},onSaveCalled:function(){var i=this.labels;this.saveProcess(i);this.resetView()},onCancelCalled:function(){this.resetView()},resetView:function(){this.hide();this.buildSkeleton();this.render();this.onClose()}});return f});define("DS/W3DXComponents/ContentSet",["DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/ListView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/SetView","DS/W3DXComponents/Views/Item/TileView","UWA/Core","i18n!DS/W3DXComponents/assets/nls/ContentSet","css!DS/W3DXComponents/W3DXComponents"],function(i,c,h,b,a,d,g){var e="content-set";var f=b.extend({name:e,defaultOptions:{actions:{},switcher:{},detail:{},contents:{defaultView:"thumbnail",views:[{id:"thumbnail",title:g.titleThumbnailView,view:i},{id:"tile",title:g.titleTileView,view:i,itemView:a},{id:"table",title:g.titleTableView,view:h},{id:"list",view:c,selectionMode:"oneToOne"}]}},getSwitcherViewOptions:function(){var j=d.clone(this._parent.apply(this,arguments));j.buttons.pop();return j},onPositionChange:function(j,k){switch(k){case"left":this.minimize();break;case"right":this.maximize();break;default:this.maximize();break}},onMinimized:function(){this.dispatchEvent("onSwitch",[null,"list"])},onMaximized:function(){var j=this.switcherView.getValue();this.dispatchEvent("onSwitch",[null,j])}});return f});define("DS/W3DXComponents/Skeleton",["UWA/Core","UWA/Element","UWA/Utils","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","UWA/Class/Promise","DS/UIKIT/Mask","DS/UIKIT/Tooltip","DS/W3DXComponents/Views/Layout/PanelSlider/PanelSlider","DS/W3DXComponents/Views/Layout/CardView","DS/W3DXComponents/Views/Layout/ListView","DS/W3DXComponents/Views/Item/TileView","DS/W3DXComponents/Views/Layout/ChannelView","DS/W3DXComponents/Views/Item/SkeletonRootView","DS/W3DXComponents/IdCard","DS/WebAppsFoundations/Router","DS/WebAppsFoundations/AbstractHistory","i18n!DS/W3DXComponents/assets/nls/Skeleton","css!DS/UIKIT/UIKIT.css","css!DS/W3DXComponents/W3DXComponents"],function(g,t,b,j,E,x,d,F,z,B,r,c,i,p,w,A,D,C,l){"use strict";function e(G){var H=[];if(g.is(G,"string")){H[0]=G}else{H=G}return new d(function(J,I){require(H,function(){J.call(null,Array.prototype.slice.call(arguments))},function(K){I("Error loading modules."+((K&&K.requireModules)?K:""))})})}function q(H,I,G){G=g.merge(G||{},{clone:true});var J=g.is(I,"function")?I.call(null,H):I||{};return G.clone?g.clone(J,false):J}function n(H,J){var I=[],G=J&&(g.is(J.cacheFacets)?J.cacheFacets:true),K=u(H,J);if(H._facets){return H._facets}if(K&&K.facets){I=K.facets;if(g.is(I,"function")){I=I.call(H)}G&&(H._facets=I)}return I}function u(G,H){var I=G._idCardOptions,J;if(!I){J=H.idCardOptions;I=g.is(J,"function")?J.call(null,G):J||{};G._idCardOptions=I}return I}function o(G,K){var H=Object.keys(G),J={},I;H.forEach(function(L){I=g.clone(G[L],false);J[L]=g.merge(I,K)});return J}var k,h;var a=j.extend({defaults:{renderer:null,id:null,isLoading:false,isPanelRendered:false,panelNode:null,isRoot:false,facetIndex:null,currentPromises:null,},getActiveView:function(){var I=this,G=I.get("panelNode"),H=G?G.get("activeNode"):null,J=H?H.get("activeFacet"):null;return J?J.view:null},getActiveModel:function(){var H=this,G=H.get("panelNode");return G?G.getActiveModel():null},setup:function(){this.set("currentPromises",{})},destroy:function(G){this.get("panelNode")&&this.get("panelNode").destroy(G)}});var s=j.extend({defaults:{nodeCollection:null,activeNode:null,cardView:null},setup:function(G){var I,H=new m();G||(G={});this.set("nodeCollection",H);if(G.addNode){I=new y();H.add(I);this.set("activeNode",I)}},getActiveModel:function(){var G=this,H=G.get("activeNode");return H?H.get("assignedModel")||null:null},setActiveNode:function(I){var H=this,G=H.get("nodeCollection");if(g.is(I,"number")){I=G.at(I)}if(!I||!(I instanceof j)||G.indexOf(I)<0){throw new Error("Node doesn't belong to this collection.")}H.set("activeNode",I)},attachNode:function(G){this.get("nodeCollection").add(G)},destroy:function(O){var K=this,N=K.get("nodeCollection"),I=K.get("cardView"),M=3,L=0,J=[],H=O||{};function G(P){var Q=P;Q.forEach(function(R){R.destroy(H)})}N.forEach(function(P){J.push(P);if(L!==0&&L%M===0){setTimeout(G(J),0);J=[];L=0}else{L++}});G(J);if(I){I.destroy();I=null}}});var y=j.extend({defaults:{assignedModel:null,idCard:null,facets:null,activeFacet:null,isRoot:false,placeHolder:null},setup:function(H){(H=H||{});var I=this,G=H.assignedModel,J=G?G._facetObjs||[]:[];I.set("facets",J);G&&(G._facetObjs=J);I.nodeCollection=new m(H.nodes);I.listenTo(I,"onChange:assignedModel",this.onAssignedModel)},onAssignedModel:function(K,H){if(!H){return}var G=K,J=G.get("facets"),I=H._facetObjs||[];J=J.concat(I);G.set("facets",J);H._facetObjs=J},destroyFacet:function(M,I,H){var K=g.merge(H||{},{removeFacet:true}),L=this.get("facets"),G=M.view,J=L.indexOf(M);G&&G.destroy();g.extend(M,{view:null,viewType:null});if(K.deleteRef){g.extend(M,{collection:null,reference:null});K.removeFacet&&L.splice(J,1)}},destroyFacets:function(G){var I=g.merge(G||{},{removeFacet:false}),H=this;H.get("facets").forEach(function(K,J){H.destroyFacet(K,J,I)});I.deleteRef&&H.set("facets",[])},setActiveFacet:function(I){var G=this,H=G.get("facets");if(H.indexOf(I)<0){throw new Error("Facet does not exist in node.")}G.set("activeFacet",I)},getFacet:function(G){var H=G;return this.get("facets").detect(function(I){return I.reference===H})||null},setFacet:function(G,H){var K=this,J=H||{},L=K.get("facets"),I,M;I=K.getFacet(K,G);M={viewType:J.viewType||null,collection:null,url:null,index:J.index,view:null,reference:G};if(I){K.destroyFacet(L,I,{deleteRef:true});I=M}else{L.push(M)}return M},destroy:function(J){var M=this,I=this.pick(["idCard","facets","assignedModel","placeHolder"]),G=I.idCard,N=I.facets,L=I.placeHolder,H=I.assignedModel,K=J||{};M.destroyFacets(K);if(L){L.destroy();M.set("placeHolder",null)}if(G){G.destroy();M.set("idCard",null)}if(K.deleteRef){N.length=0;H&&g.extend(H,{_facets:null,_facetObjs:null})}}});var m=E.extend({model:y,fetch:function(){}});var v={EXPANDED:"expanded",CONTRACTED:"contracted",COLLAPSED:"collapsed"};var f=x.extend({tagName:"div",className:"skeleton",elements:null,panelSlider:null,placeHolder:null,rendererMap:null,rootRenderer:null,rootRendererName:null,widthCache:null,heightCache:null,expandedLayout:[{size:25,className:"left"},{size:75,className:"right"}],contractedLayout:[{size:100,className:"left"}],collapsedLayout:[{size:100,className:"right"}],leftColumnMax:400,leftColumnMin:280,leftColumnDefaultRatio:25,cardBuildOffset:5,state:"contracted",slideCb:null,currentRoute:null,currentRouteSteps:null,tempRouteSteps:null,eventList:null,MAX_UNBUILT_DISTANCE:3,defaultOptions:{widthThreshold:560,rootIdCardOptions:null,responsiveTrigger:function(){return false},minimizeIdCards:true,height:"100%",startRoute:null,rendererOptions:{collection:E,view:null,swipe:b.Client.Features.touchEvents&&!b.Client.Features.pointerEvents,idKey:null,viewOptions:null,collectionOptions:null,fetchOptions:null,fetchMode:"always",cacheFacets:true,idCardOptions:null}},init:function(G,H){H||(H={});var I=this,K=H.rootIdCardOptions,J;if(!G){throw new Error("Renderer map needs to be specified.")}else{if(K&&(!K.model||!K.facets)){throw new Error("If you specify rootIdCardOptions you need to specify a model and facets.")}}I._parent(H);I.rootRendererName=H.root&&G[H.root]?H.root:Object.keys(G)[0];I.rendererMap=o(G,I.options.rendererOptions);I.currentRouteSteps=[];I.elements={};I.eventList=[];I.options.startRoute=I.options.startRoute||(I.options.rootIdCardOptions?"/":"/"+I.rootRendererName+"/");I.history=J=I.options.history||new C();I.router=new D({routes:{"(*path)(/?*)":I.goTo.bind(I)},History:J,});if(g.is(J.started)&&!J.started){I.history.start({silent:true})}},render:function(){var H=this,G=H.elements;H.container.addClassName("skeleton-cnt contracted");G.content=H.container;if(!H.panelSlider){H.buildPanelSlider()}H.router.navigate(H.currentRoute||H.options.startRoute,{trigger:true});return H},onPostInject:function(){var I=this,H=I.elements,G=I.options;if(!H.content){throw new Error("You must render this view before you try to inject it.")}if(I.panelSlider){I.placeHolder=this.getContent().getParent();I.panelSlider.placeHolder=I.placeHolder;I.setHeight(G.height,{shouldCache:false});I.initContainerEvents()}},goTo:function(J,G){var K=this,I=K.parseRoute(J||"/",K.rendererMap,{rootIdCardOptions:K.options.rootIdCardOptions,defaultRootRenderer:K.rootRendererName}),M=b.parseQuery(G||""),N=M.f||M.facet,L=M.s||M.state,H=I[I.length-1];if(I.length===1&&K.options.rootIdCardOptions&&!H.get("renderer")){H.set("facetIndex",N?parseInt(N):0)}else{if(N){if(!H.id){throw new Error("Facet index can only be specified after an ID and at the end of a route path.")}else{I.push(new a({facetIndex:N?parseInt(N):0}))}}}K.mergeRoutes(I,K.currentRouteSteps||[],{state:L}).then(function(Q){var P=Q.steps,R=Q.config,O=K.currentRouteSteps;K.currentRouteSteps=P;K.tempRouteSteps=null;K.currentRoute=K.getRoute();K.updateStepStates(P,{minimizeIdCards:K.options.minimizeIdCards,addSelectedClass:R.addSelectedClass});if((P.length-1!==0)&&!K.areStepsEqual(P.length-1,O,P)){K.eventList.push({name:"onItemSelect",args:[P[P.length-1].get("panelNode").getActiveModel()]})}R.notifyPosition&&K.notifyViewsPosition();R.emptyEventQueue&&K.throwEvents(K.eventList)})["catch"](function(O){O||(O="");K.eventList=[];g.log("Error building route.\n"+O.stack||O)})},throwEvents:function(I){var J=this,H,G;!Array.isArray(I)&&(I=[I]);I.forEach(function(K){H=K.context||J;G=K.args.map(function(L){return L?q(J,L,{clone:false}):null});H.dispatchEvent(K.name,G)});I.length=0},parseRoute:function(P,N,R){R||(R={});var Q=[],O=[],I,M;function K(S){throw new Error(S.msg||'Could not find "'+S.renderer+'" in renderer map while parsing route: /'+P+"/.")}function H(S){return !g.is(N[S])}function G(S){if(!S){K({renderer:S})}M=O[O.length-1];if(H(S)){I=S;if((!M&&L!==0)||(M&&M.id)){K({renderer:S})}if(M){M.set("id",I)}else{if(L===0){K({msg:"You cannot specify an ID directly at the root."})}}}else{O.push(new a({renderer:S}))}}P=P.trim().replace(/^\/|\/$/g,"");Q=P.split("/");if(!P){if(!R.rootIdCardOptions){O.push(new a({renderer:R.defaultRootRenderer}))}else{O.push(new a())}return O}for(var L=0,J=Q.length;L<J;L++){G(Q[L])}return O},stringifySteps:function(G,H){H||(H={});var I="";G.forEach(function(L,N){var O=L.id||null,M=L.get("renderer"),K=L.get("facetIndex"),J=g.is(K);I+="/";if(M){I+=M+"/";I+=O?O:""}if(G.length-1===N){I+=J?"?"+b.toQueryString({f:K}):""}});if(H.state){I+=(I.indexOf("?")<0?"?":"&")+b.toQueryString({s:H.state})}return I},getFacetIndex:function(H,K){var L,J;for(var I=0,G=K.length;I<G;I++){L=K[I];J=L.handler._opts;if(L&&(H===J.rendererRef)){return I}}},selectFacet:function(G,U,Y,J){J||(J={});var N=this,L=U[G],O=L.get("panelNode"),R=J.node||O.get("activeNode"),S=R.get("placeHolder"),K=R.get("assignedModel"),V=J.idCard||N.getIdCardAt(G),H=L.get("renderer"),Q=Y[H],P=L.get("facetIndex"),W={steps:U,stepIndex:G,node:R,placeHolder:S},X,M;function I(){if(!V||!V.getContent()){return d.resolve()}V.selectFacet(P,{silent:true});return d.resolve()}function T(ah){var ab=ah.facet,Z=N.getState(),ae=ah.steps,af=ab.view,aa=R.get("activeFacet").view===af,ad,ac,ag=[];if(!af){return}!aa&&N.hideFacet(ab,{notify:false});if(!af.getContent().isInjected()){af.inject(S);aa&&N.showFacet(ab)}if(Z===v.EXPANDED){if(ah.stepIndex===ae.length-1){ag.push({name:"onPositionChange",args:[Z,"right"],context:af})}else{ag.push({name:"onPositionChange",args:[Z,"left"],context:af})}}else{ag.push({name:"onPositionChange",args:[Z,null],context:af})}ad=N.getViewAt(ae.length-1)?N.getViewAt(ae.length-1).getContent():null;ac=N.getViewAt(ae.length-2)?N.getViewAt(ae.length-2).getContent():null;if(Z===v.EXPANDED){if(ad&&ac&&ad.isInjected()&&ac.isInjected()){ag.push({name:"onRouteChange",args:[N.getRoute(),N]})}}else{if(ad&&ad.isInjected()){ag.push({name:"onRouteChange",args:[N.getRoute(),N]})}}N.throwEvents(ag.concat(N.eventList||[]));return d.resolve()}if(G===0&&!V){g.merge(W,{key:"_modelKey",fetchOptions:Q.fetchOptions?g.clone(Q.fetchOptions,false):null,rendererRef:H})}else{X=n(K,Q);if(H){M=H;P=N.getFacetIndex(H,X)}else{if(g.is(P)){P=Math.min(X.length-1,P);M=X[P]&&X[P].handler._opts.rendererRef}}if(!M){return d.resolve()}g.merge(g.merge(W,{facetIndex:P,rendererRef:M}),X[P]?X[P].handler._opts:{})}I().then(N.loadFacet.bind(N,W)).then(T)["catch"](N.treatError.bind(N));return d.resolve()},areStepsEqual:function(L,G,S){var N=G[L],K=G[L-1],M=S[L],I=S[L-1],O=["id","renderer"],R=false,J,H,Q,P;if(N&&M){J=N.pick(O);H=M.pick(O);Q=K?K.pick(O):{};P=I?I.pick(O):{};R=(Q.id&&P.renderer&&Q.id===P.id&&Q.renderer===P.renderer)||(L===0)}return R},updateStepStates:function(M,P){var L=this,P=g.merge(P||{},{minimizeIdCards:true,addSelectedClass:false}),O,G,I,H,N,K,J;M.forEach(function(Q,R){O=Q.get("panelNode");G=O&&O.get("cardView");I=L.getIdCardAt(R);J=M[R+1],N=Q.getActiveView(),K=J?J.getActiveModel():null,H=Q.id;if(R===M.length-1){G&&G.unMute();return}G&&G.mute();P.minimizeIdCards&&I&&I.minimize();P.addSelectedClass&&N&&K&&L.selectItemView(K,N)});L.adaptRootView();I=L.getIdCardAt(M.length-1);I&&I.maximize()},destroySteps:function(H,I){I||(I={});var J=I.from||0,G=I.to||H.length;for(;J<G;J++){H[J]&&H[J].destroy({deleteRef:true})}if(Array.isArray(I.oldSteps)){I.oldSteps.forEach(function(K){K.destroy({deleteRef:true})})}return d.resolve()},mergeRoutes:function(Q,ab,L){L||(L={});var P=this,ae=P.MAX_UNBUILT_DISTANCE,S=true,aj=0,Z=0,ai=ab.length-1,O=Q.length-1,U=0,ah=[],ag={},Y=[],W,R,ad,J,M,I,ac,V,aa;function H(ao,an){var am=[];for(var al=ao,ak=an;al<=ak;al++){am.push(P.renderStep(al,Q))}return d.all(am)}function af(){return d.resolve({steps:Q,config:ag})}function X(ar,ao){var am=false,aq=["facetIndex","renderer"],au,at,al,ak,ap,an;if(ar&&ao){au=ar.pick(aq);at=ao.pick(aq);al=au.renderer;ak=at.renderer;ap=au.facetIndex;an=at.facetIndex;if(al&&ak){am=al===ak}else{am=ap===an}}return am}function G(ak){if(g.is(ak,"array")){return d.all(ak.map(G))}else{if(ak&&ak.render){return ak.render()}else{return d.resolve()}}}function K(){P.destroySteps(ab,{from:Z,oldSteps:Y});return d.resolve()}function T(){ah.forEach(function(ak){P.selectFacet(ak,Q,P.rendererMap)});return d.resolve()}for(;Z<=O;Z++){var N;W=ab[Z];R=Q[Z];I=P.areStepsEqual(Z,Q,ab);ad=W&&W.get("renderer");J=R&&R.get("renderer");S=(I&&!W.get("isPanelRendered"))||!I;if(S){!g.is(aa)&&(aa=Z);aj++;if(I){R.set(W.pick(["panelNode","currentPromises","isRoot"]))}else{if(W&&W.get("isPanelRendered")){N=W;N&&Y.push(N)}}R.set("isLoading",Z>=(Q.length-P.expandedLayout.length));R.set("isPanelRendered",false)}else{ad&&J&&(ad!==J)&&((ai!==O)||(Z!==O))&&(ah.push(Z));Q[Z].set(W.pick(["isLoading","isPanelRendered","isRoot","currentPromises","panelNode"]))}}U=Z-1;P.tempRouteSteps=Q;ah.forEach(function(am){var ao=Q[am],ak=ao.get("panelNode"),an,ap,al;if(!ao.get("isPanelRendered")){return}an=ak.get("activeNode"),ap=an.setFacet(""),al=Q[am].getActiveView();P.switchFacets(ap,an.get("activeFacet"),{notify:false});an.setActiveFacet(ap);if(al){P.eventList.push({name:"onFacetUnselect",args:[P],context:al});P.deSelectItemView(al)}});if((aa===0&&O===0)||(Math.abs(aa-O)>=ae&&aa>0)){if(U===0){V=(function(){if(P.getState()!==v.CONTRACTED){return P.setContractedLayout({index:U})}else{return d.resolve()}})().then(P.renderStep.bind(P,U,Q))}else{V=P.doSliderAction("slideTo",P[P.getState()+"Layout"].length-1,{doSlide:false}).then(function(){Q[0].set({isPanelRendered:false,isLoading:false});Y.push(Q[0])}).then(H.bind(P,Math.max(U-1,0),U))}}else{if((O===ai)&&P.areStepsEqual(O,Q,ab)&&P.areStepsEqual(Math.max(O-1,0),Q,ab)&&(g.is(Q[U].get("facetIndex"))||Q[U].get("renderer"))&&!X(Q[U],ab[U])){V=P.selectFacet(O,Q,P.rendererMap)}else{if(aj===0&&O>=0&&(O!==ai)&&(Q.length!==ab.length-1)){ag.notifyPosition=true;ag.emptyEventQueue=true;P.getViewAt(U)&&(P.eventList.push({name:"onRouteChange",args:[P.getRoute(),P]}));P.deSelectItemView(P.getViewAt(U));if(O===0&&P.state===v.EXPANDED){V=P.setContractedLayout({index:U,animate:false})}else{V=P.doSliderAction("slideTo",U,{animate:false})}}else{if((Q.length===ab.length-1)&&P.areStepsEqual(O,Q,ab)){ag.notifyPosition=true;ag.emptyEventQueue=true;U=Math.max(U-1,0);ac=P.panelSlider.getPanels().length-2;P.deSelectItemView(P.getViewAt(Q.length-1));P.getViewAt(ac)&&(P.eventList.push({name:"onRouteChange",args:[P.getRoute(),P]}));V=(function(){if(!Q[U].get("isPanelRendered")){return P.doSliderAction("insertPanel",null,ac,{resize:true,animate:true}).then(function(){return d.resolve({doSlide:false})})}else{return d.resolve({doSlide:true})}})().then(function(ak){ak||(ak={});if(O===0&&P.state===v.EXPANDED){return P.setContractedLayout({index:U}).then(P.renderStep.bind(P,U,Q))}else{if(ak.doSlide){return P.doSliderAction("slideBack").then(P.renderStep.bind(P,U,Q))}else{return P.renderStep(U,Q)}}})}else{if(P.areStepsEqual(ai,ab,Q)&&(O===ai+1)){M=P.calculateLayout();ag.addSelectedClass=true;P.eventList.push({name:"onPositionChange",args:[v.EXPANDED,(M===v.EXPANDED?"left":null)],context:Q[ai].getActiveView()});if(P.state===v.CONTRACTED&&M===v.EXPANDED){V=P.renderStep(U,Q).then(function(ak){return P.setExpandedLayout().then(function(){return d.resolve(ak)})})}else{V=P.renderStep(U,Q).then(function(ak){return P.doSliderAction("slideNext").then(function(){return d.resolve(ak)})})}}else{if(ai===O&&!P.areStepsEqual(U,Q,ab)&&P.areStepsEqual(U-1,Q,ab)){ag.addSelectedClass=true;V=P.renderStep(U,Q)}else{if(P.areStepsEqual(U,Q,ab)&&X(Q[U],ab[U])&&O===ai&&L.state){ag.notifyPosition=true;ag.emptyEventQueue=true;M=P.calculateLayout();V=(function(){var ak;if(L.state===v.COLLAPSED){ak=P.setCollapsedLayout()}else{if(M===v.CONTRACTED){ak=P.setContractedLayout()}else{ak=P.setExpandedLayout()}}return ak})().then(function(){P.getViewAt(U)&&(P.eventList.push({name:"onRouteChange",args:[P.getRoute(),P]}));return d.resolve()})}else{ag.addSelectedClass=true;if(ai>O&&P.panelSlider.getPanels().length>O){V=P.doSliderAction("slideTo",U).then(H.bind(P,Math.max(U-1,0),U))}else{V=H(Math.max(U-1,0),U).then(function(am){var al=P.getRenderedPanelsCount(Q,{limit:U}),ak=function(){return d.resolve(am)};if(L.state===v.COLLAPSED){return P.setCollapsedLayout({steps:Q,force:true,index:al,animate:false}).then(ak)}else{if(P.getState()!==v.EXPANDED){return P.setExpandedLayout({animate:false,index:al}).then(ak)}else{return P.doSliderAction("slideTo",al,{doSlide:false}).then(ak)}}})}}}}}}}}return V.then(G).then(T).then(K).then(af)["catch"](P.treatError.bind(P))},deSelectItemView:function(G){if(!G){return}if(g.is(G.removeSelectedClasses,"function")){G.removeSelectedClasses()}else{if(g.is(G.unSelectAll,"function")){g.log("Skeleton: 'unSelectAll' is deprecated in favor of 'removeSelectedClasses'.");G.unSelectAll()}}},selectItemView:function(H,G){if(!G){return}if(g.is(G.addSelectedClass,"function")){G.selectItemView(H)}else{if(g.is(G.selectItemView,"function")){g.log("Skeleton: 'unSelectAll' is deprecated in favor of 'removeSelectedClasses'.");G.selectItemView(H,{silent:true,trigger:false})}}},doSliderAction:function(H){var G=arguments,J=this.panelSlider,I=H;[].splice.call(G,0,1);if(!g.is(G[G.length-1],"object")){[].push.call(G,{})}return new d(function(K){G[G.length-1].callback=K;J[I].apply(J,G)})},selectItem:function(G){var H=this,I;if(H.panelSlider.isMuted()){return}I=H.getCollectionAt(H.currentRouteSteps.length-1);if(!I){return}if(G instanceof j&&I.get(G)){H.onItemViewSelect(G)}else{if(g.is(G,"number")){G=I.at(G);G&&H.onItemViewSelect(G)}}},getRenderedPanelsCount:function(I,K){K||(K={});var H=0,L=0,G=g.is(K.limit)?K.limit:I.length,J;for(;L<G;L++){J=I[L];if(J.get("isPanelRendered")||J.get("isLoading")){H++}}return H},renderStep:function(I,H){var J=this,G=H[I],N=J.panelSlider,K=N.getPanels(),M=J.getRenderedPanelsCount(H,{limit:I}),P,O;function L(){G.set("isLoading",false);return d.resolve()}if(G.get("isPanelRendered")&&!G.get("isLoading")){return}G.set("isPanelRendered",true);if(K[M]){O=M;G.set("isLoading",false);P=J.loadPanel(I,H,N.getPanel(O)||O)}else{O=M;P=J.doSliderAction("insertPanel",null,O).then(L).then(J.loadPanel.bind(J,I,H,N.getPanel(O)||O))}return P},getCollectionAt:function(G){var I=this,H=I.getNodeAt(G),J=H?H.get("activeFacet"):null;return J?J.collection:null},treatError:function(K){if(!K){return}g.log("Error: "+(K.reason||K)+(K.reason&&K.reason.stack?"\n"+K.reason.stack:""));var M=this,I=K.steps,N=K.stepIndex||0,H=[],L;M.eventList=[];for(var J=0,G=N;J<G;J++){H.push(I[J].clone())}M.destroySteps(H,K.stepIndex);L=H[H.length-1];if(L){L.set("id",null);M.router.navigate(M.stringifySteps(H,{rootIdCardOptions:M.options.rootIdCardOptions}),{trigger:true})}else{M.router.navigate((M.options.rootIdCardOptions?"/":"/"+M.rootRendererName+"/"),{trigger:true})}return d.reject()},loadPanel:function(G,W,S){var P=this,X=P.rendererMap,O=W[G],M=W[G-1],L=M?X[M.get("renderer")]:null,H=M?M.get("currentPromises"):null,K=P.panelSlider,Q,U,R,T,I;R=O.get("panelNode");if(!R){R=new s({addNode:true});O.set("panelNode",R)}if(M&&!M.get("panelNode")){T=new s({addNode:true});M.set("panelNode",T)}else{if(M){T=M.get("panelNode")}}function N(){var Y=H.loadCollection;H.loadCollection=Y=Y||(L?P.getRendererModules(L,["collection"]):null);return Y}function V(Z){var ab=Z.collection,Y=H.fetchCollection,ad,ac,aa;ad=T.get("activeNode").getFacet(M.get("renderer"));ad||(ad=T.get("activeNode").setFacet(M.get("renderer")));aa=g.merge({_modelId:M?M.get("id"):null},q(null,L.collectionOptions));ac=ad.collection||P.createCollection(null,ab,aa);ad.collection=ac;H.fetchCollection=Y=Y||P.doCollectionAction("fetch",ac,q(null,L.fetchOptions));return Y}function J(ae){var Z=R.get("activeNode"),ab={},Y,ad,ac,af,aa;if(ae){aa=L;if(ae.length>0){ad=ae.model;af=M.id;ab[aa.idKey||(ad&&ad.prototype.idAttribute)||"id"]=af;Y=ae.findWhere(ab);if(Y){Z.set("assignedModel",Y)}else{return d.reject({stepIndex:G,steps:W,reason:"Model with id '"+af+"' was not found."})}}else{return d.reject({stepIndex:G,steps:W,reason:"Collection is empty."})}}else{if(G===0){Z.set("isRoot",true);R.set("isRoot",true);aa=X[O.get("renderer")]}}R.attachNode(Z);ac=P.buildPanelContent({node:Z,renderer:aa,stepIndex:G,step:O,steps:W,parentCollection:ae});if(g.is(S,"element")){S.setContent(ac.el)}else{K.addPanel(ac.el,S)}R.setActiveNode(Z);O.set("currentPromises",{});M&&M.set("currentPromises",{});return d.resolve(ac)}Q=T?T.get("activeNode"):null;I=Q?Q.get("activeFacet")||Q.get("facets")[0]:null;U=I?I.collection:null;return new d(function(Z,Y){if(G===0||U){return J(U).then(Z)["catch"](Y)}else{return N().then(V).then(J).then(Z)["catch"](Y)}})},getFacet:function(G){var I=this,H=G.node,K=G.rendererRef,J=H.get("activeFacet"),L=H.getFacet(K);if(!L){L=H.setFacet(K,{index:G.facetIndex||0})}if(J===L){J.view&&I.throwEvents({name:"onFacetSelect",context:J.view,args:[this]});return d.reject("Facet is already selected.")}else{if(L.view){I.switchFacets(L,J,[I])}else{if(J){I.hideFacet(J)}}return d.resolve(g.merge(G,{facet:L}))}},renderFacet:function(X){var M=this,L=X.rendererRef,H=X.node.get("assignedModel"),G=X.facet,T=X.rendererModules,K=X.steps[X.stepIndex],Y=T.collection,W=g.merge(q(H,X.viewOptions),{model:H}),U=M.rendererMap[L],J=M.options,P=U?U.fetchMode||"once":null,N,R,S,V;function I(){return d.resolve(g.merge({fetchArgs:arguments},X))}function O(){if(g.is(L,"string")&&U){K.set("renderer",L);K.set("facetIndex",null)}else{K.set("renderer","");K.set("facetIndex",X.facetIndex)}}function Q(){P!=="never"&&((P==="once"&&R.length===0)||P==="always")&&(M.doCollectionAction("fetch",R,q(H,U.fetchOptions)));return d.resolve()}if(G.view){R=G.view.collection;R&&P==="always"&&(S=Q().then(I));O();return S||d.resolve(X)}if(g.is(W.itemView,"string")){g.log("Warning: If the view options contain an item view as an AMD module it will not be loaded dynamically by the skeleton.")}if(g.is(L,"string")&&U){V=T.view||(X.stepIndex===0?w:c);W=g.merge(X.stepIndex===0?{defaultView:(J.useRootChannelView?"channel":"tile")}:{},g.merge(W,q(H,U.viewOptions)));N=q(H,U.collectionOptions);N[X.key]=H||null;G.collection=R=G.collection||M.createCollection(H,Y,N);G.view=M.createCollectionView(V,g.extend({collection:R},W)).render();M.initCollectionViewEvents(G.view);S=Q().then(I)}else{V=T.view;if(V){G.view=M.createDetailView(V,W);G.view.render()}S=d.resolve(g.merge(X))}O();return S},setActiveFacet:function(G){var H=G.node,I=G.facet;H.setActiveFacet(I);return d.resolve(G)},loadFacet:function(G){var N=this,P=N.rendererMap,I=G.node,R=G.rendererRef,M=I.get("assignedModel"),Q=G.placeHolder,O=P[R];function H(S){return d.reject(S&&S.reason?S:g.merge(G,{reason:S}))}function L(T){var U=T.steps[T.stepIndex],S=T.facet.view,W=P[U.get("renderer")]||{},Y=U.id,X=S.collection,V;if(S&&X&&Y){V={};V[W.idKey||(X.model.prototype.idAttribute)||"id"]=Y;if(X.length===0){X.addEventOnce("onSync",function(){N.selectItemView(X.findWhere(V),S)})}else{N.selectItemView(X.findWhere(V),S)}}return d.resolve(T)}function J(S){F.unmask(Q);return d.resolve(g.merge({rendererModules:S},G))}function K(S){if(S.facet.view){return d.resolve(S)}if(!O){return N.getRendererModules({view:R},["view"])}else{if(g.is(R,"string")&&O){return N.getRendererModules(O,["view","collection"])}}}if(!M){throw new Error("Cannot load facet of uninitialized node")}if(G.adaptableView){throw new Error("Adaptable view no longer supported, you should create a parent view that manages both subviews.")}F.mask(Q);return N.getFacet(G).then(N.setActiveFacet.bind(N)).then(K).then(J).then(N.renderFacet.bind(N)).then(L)["catch"](H)},getRendererModules:function(L,K){var H={},J=[],I=[];function G(M){Array.prototype.forEach.call(M,function(O,N){O&&(H[I[N]]=O)});return d.resolve(H)}K||(K=[]);K.forEach(function(N){var M=L[N];switch(g.typeOf(M)){case"string":J.push(M);I.push(N);break;case"class":case"function":H[N]=M;break;default:H[N]=null}});return e(J).then(G)},buildPanelSlider:function(){var I=this,H=[{size:1,className:"left"}],G=new B([],{layout:H,container:I.getContent(),events:{onSlideNext:I.onSlideEnd.bind(I,"right"),onSlideBack:I.onSlideEnd.bind(I,"left")}});G.render();I.panelSlider=G},onSlideEnd:function(J){var I=this,H=I.getSteps();function G(L){var M=I.getState(),K;switch(M){case v.EXPANDED:K=I.expandedLayout.length;break;case v.COLLAPSED:K=I.collapsedLayout.length;break;case v.CONTRACTED:K=I.contractedLayout.length;break}return L.call(I,K-1)}switch(J){case"left":I.eventList.push({name:"onSlide",args:[G.bind(I,I.getViewAt),G.bind(I,I.getModelAt),"left"]});break;case"right":I.eventList.push({name:"onSlide",args:[I.getViewAt.bind(I,H.length-1),I.getModelAt.bind(I,H.length-1),"right"]});break}},onActionClick:function(I,H,L){var K=this,G=Array.prototype.slice.call(arguments,3),J=K.getNodeAt(H);G.unshift(K.getViewAt(H),K);L.apply(J.get("idCard"),G)},onFacetClick:function(H){var I=this,G=Array.prototype.slice.call(arguments,0,0);G=G.concat(Array.prototype.slice.call(arguments,1));H.apply(I,G)},wrapActionFunction:function(L,J,G){var I=this,H=L,K=G;return function(){var N=H.call(J.get("assignedModel"),arguments),M;if(N&&Array.isArray(N)){M=I.wrapActions(N,J,K)}return M}},wrapFacetFunction:function(I,H){var K=this,G=H,J=G.node;return function(){var L=J.get("assignedModel"),M=L._facets||I.call(L,arguments),N;if(M&&Array.isArray(M)){N=K.wrapFacets(M,G)}return N}},wrapFacets:function(I,G){var H=this;return I.map(function(M,L){var K=g.clone(M.handler),J=g.clone(G,false);g.merge(J,{facetIndex:L});return g.merge({handler:(K)?H.onFacetClick.bind(H,K,J):null},M)})},wrapActions:function(J,I,G){var H=this;return J.map(function(L){var K=g.clone(L.handler);return g.merge({handler:H.onActionClick.bind(H,I.model,G,K)},L)})},createIdCard:function(G,K,J,O,I){var L=this,P=g.clone(I,false)||{},H=P.actions,N=P.facets,M;P.model=G.get("assignedModel");P.selectedFacet=null;if(Array.isArray(H)){P.actions=L.wrapActions(H,G,J)}else{if(g.is(H,"function")){M=g.clone(P.actions);P.actions=L.wrapActionFunction(M,G,J)}}if(Array.isArray(N)){P.facets=L.wrapFacets(N,{node:G,placeHolder:K,stepIndex:J,steps:O})}else{if(g.is(N,"function")){M=g.clone(P.facets);P.facets=L.wrapFacetFunction(M,{node:G,placeHolder:K,stepIndex:J,steps:O})}}return new A(P)},buildPanelTitle:function(H,G){return g.createElement("div",{"class":this.className+"-id-cnt",html:[G]})},initCollectionViewEvents:function(G){G.addEvent("onItemViewSelect",this.onItemViewSelect.bind(this))},initContainerEvents:function(){t.addEvent.call(this.container,"resize",this.onResize.bind(this));this.panelSlider._removeEvents()},getModelPosition:function(K){var L=this,J=0,N=L.currentRouteSteps,I=N.length,G,M,H,O;for(;J<I;J++){H=N[J];O=H.get("panelNode");if(!H.get("isPanelRendered")||!O){continue}G=O.get("activeNode");M=G.get("activeFacet");if(M.collection===K.collection){break}}return{panelIndex:J,facet:M}},notifyViewsPosition:function(){var H=this,K=H.currentRouteSteps.length-1,J=H.getState(),G,I;if(J===v.EXPANDED){G=H.getViewAt(K-1);I=H.getViewAt(K);if(G){H.eventList.push({name:"onPositionChange",args:[J,"left"],context:G})}if(I){H.eventList.push({name:"onPositionChange",args:[J,"right"],context:I})}}else{G=H.getViewAt(K);if(G){H.eventList.push({name:"onPositionChange",args:[J,null],context:G})}}},switchViews:function(H,G){H.getContent().addClassName("push");G.getContent().removeClassName("push")},createCollectionView:function(H,G){return new H(G)},createDetailView:function(G,H){return new G(H)},buildPanelContent:function(I){var K=this,J=I.node,L=I.renderer,G=K.buildNodeContent(I),H=K.buildPanelControls(J);return{el:[H,(L&&L.swipe&&I.parentCollection)?K.createCardView(G.el,I):G.el],render:G.render}},buildPanelControls:function(){var G,J,I=this,H=g.createElement;G=H("div",{"class":"fonticon fonticon-left-open skeleton-ctrl-back",events:{click:function(){I.slideBack();k.hide()}}});J=H("div",{"class":"skeleton-ctrl-collapse",events:{click:function(){I.toggleCollapse();h.hide()}}});k&&k.destroy();k=new z({position:"right",target:G,body:l.backIcon,offset:{x:0,y:0}});h&&h.destroy();h=new z({position:"bottom",target:J,body:l.collapseIcon,offset:{x:0,y:0}});return H("div",{"class":"skeleton-ctrl",html:[G,J]})},buildNodeContent:function(K){var S=this,L=S.options,M=K.node,O=K.stepIndex,U=K.steps,T=K.renderer,R=g.createElement,G=R("div",{"class":"skeleton-panel"}),Q=R("div",{"class":"facetviews"}),J="If you specify rootIdCardOptions you need to specify a model and facets.",P,N,I,V;if(O===0){if(L.rootIdCardOptions){V={};N=u(V,{idCardOptions:L.rootIdCardOptions});if(N.facets){if(!N.model){throw new Error(J)}P=N.model;g.extend(P,V);M.set("assignedModel",P);I=S.createIdCard(M,Q,O,U,N);M.set("idCard",I);S.buildPanelTitle(M,I).inject(G)}else{throw new Error(J)}}else{S.buildPanelTitle(M,null).inject(G);M.set("assignedModel",new j())}}else{P=M.get("assignedModel");N=u(P,T);I=S.createIdCard(M,Q,O,U,N);M.set("idCard",I);S.buildPanelTitle(M,I).inject(G)}function H(){var W=g.merge({},{idCard:N?I:null,node:M});return S.selectFacet(O,U,S.rendererMap,W)}Q.inject(G);M.set("placeHolder",Q);return{el:G,render:H}},createCardView:function(I,K){K=g.clone(K,false);var O=this,J=K.step,N=K.parentCollection,S=J.get("panelNode"),H=S.get("cardView"),L=S.get("activeNode"),M=L.get("assignedModel"),T=N.indexOf(M),Q=O.cardBuildOffset,G,R;function P(W,V){var U=[];for(;W<V;W++){if(N.at(W)){U.push(null)}}return U}if(H){H.destroy()}R=Math.min(Q,T);G=P(T-Q,T+Q);G[R]=I;H=new r(G,{index:R,events:{onShowCard:O.onShowCard.bind(O,K,T),onStartDrag:O.onStartDrag.bind(O,K),onEndDrag:O.onEndDrag.bind(O,K)}});H.render();S.set("cardView",H);return H},onShowCard:function(I,H,G,J,N){if(!J._dragEvent){return}var M=this,L=I.parentCollection,S=J._dragEvent,Q=S.ghostContent,V=S.nextModelIndex,K=L.at(V),R=S.direction,P=N.index,U=M.cardBuildOffset,T,W;function O(ac,ab){var aa=[],Z=ac,Y=ab,X;for(;Z<Y;Z++){X=Z-V+P;if(L.at(Z)&&!G.getCardAt(X)){aa.push(null)}}return aa}T=M.getViewAt(I.steps.length-2);if(T&&T.selectItemView){T.selectItemView(K,{silent:true})}if(Q){Q.content.render()}if(R==="right"){W=O(V-U,V);G.addCards(W,{where:"before"})}else{W=O(V+1,V+U);G.addCards(W)}M.dispatchEvent("onItemSelect",K);delete J._dragEvent},onStartDrag:function(X,J,G,H){var O=this,N=X.step,V=X.parentCollection,W=N.get("panelNode"),L=W.get("activeNode"),S=V.indexOf(L.get("assignedModel")),I=O.getDragNextIndex(S,H),T=I.nextModelIndex,R=I.nextCardIndex,M,Q,U,K,P;if(T<0||S<0){return}M=V.at(T);if(!M){return}K=W.get("nodeCollection").findWhere({assignedModel:M});P={currModelIndex:S,nextModelIndex:T,nextCardIndex:R,ghostContent:null,direction:H.direction,collection:V};if(!K){Q=new y({assignedModel:M});X.node=Q;U=O.buildNodeContent(X);J.setCardContent(U.el,R);P.ghostContent={node:Q,content:U}}else{P.newActiveNode=K}G._dragEvent=P},onEndDrag:function(I,H,K,P){if(!K._dragEvent){return}var O=this,M=P.didSnap,R=K._dragEvent,S=I.step.get("panelNode"),Q=R.ghostContent,J=Q?Q.node:R.newActiveNode,G,L,N;if(M){N=J.get("assignedModel");S.attachNode(J);S.setActiveNode(J);G=O.currentRouteSteps[I.stepIndex-1];if(G){L=O.rendererMap[G.get("renderer")];G.set(G.idAttribute,N.get(L.idKey||N.idAttribute||"id"))}}else{if(!S.get("nodeCollection").get(J)){J.destroy()}}},getDragNextIndex:function(K,I){var J=I.direction,H,G;if(J==="left"){G=K+1;H=I.index}else{G=K-1;H=I.index-1}return{nextCardIndex:H,nextModelIndex:G}},doCollectionAction:function(H,I,G){G||(G={});return new d(function(J){I[H](g.merge({onComplete:function(){J.apply(null,arguments);G.onComplete&&G.onComplete.apply(null,arguments)},onFailure:function(){J.apply(null,arguments);G.onFailure&&G.onFailure.apply(null,arguments)}},G))})},createCollection:function(H,I,G){return new I(null,G)},onItemViewSelect:function(){var P=this,U=arguments[arguments.length-1],N=U.model||U,K=P.getModelPosition(N),M=K.panelIndex,O=P.expandedLayout.length,L=P.getModelAt(M+1),H,G,T,S,J,R,I,Q;if(P.panelSlider.isMuted()){return}S=P.currentRouteSteps.map(function(V){return V.clone()});if(L&&(N===P.getModelAt(M+1)||(L.id&&N.id&&(L.id===N.id)))){P.throwEvents({name:"onFacetSelect",args:[P],context:P.getViewAt(M+1)});return}if(M===(S.length-O)){H=S[M+1];S.pop()}T={facetIndex:0};J=S[M];R=P.rendererMap[J.get("renderer")];Q=n(N,R);G=N.get(R.idKey||N.idAttribute||"id");if(!G){throw new Error("Every model must specify an ID, either through the 'id' property of the model or the one specified by the 'idKey' property of the renderer.")}if(Q.length===0){g.log("It is not possible to select an item that has no facets.");return}J.set(J.idAttribute,G);S.splice(M+1,S.length-1,new a(T));I={rootIdCardOptions:P.options.rootIdCardOptions,state:P.getState()===v.COLLAPSED?v.COLLAPSED:null};P.router.navigate(P.stringifySteps(S,I),{trigger:true});H&&setTimeout(H.destroy.bind(H),0)},calculateLayout:function(H){var K=this,J=H||{},G=g.is(J.respTrigger)?J.respTrigger:K.callResponsiveTrigger(),L=K.options,I=J.width||(K.widthCache||K.container.getDimensions().innerWidth);if(I>=L.widthThreshold||G){return v.EXPANDED}else{return v.CONTRACTED}},onResize:function(Q){var L=this,H=Q||{},I=L.container.getDimensions().innerWidth,M=L.currentRouteSteps,O=L.panelSlider,N=L.state,P,J,G;function K(){if(N!==L.state){L.notifyViewsPosition()}return d.resolve()}if(I!==0&&L.widthCache!==I||H.force){L.widthCache=I;O._cachedWidth=I;G=L.callResponsiveTrigger();J=L.calculateLayout({respTrigger:G});L.adaptRootView({respTriggerOutput:G});if(L.state===v.COLLAPSED||M.length<=1){O.refresh();return}switch(J){case v.EXPANDED:P=L.setExpandedLayout({animate:false});break;case v.CONTRACTED:if(L.state!==v.CONTRACTED){P=L.setContractedLayout({animate:false})}else{P=L.doSliderAction("refresh")}break}return P.then(K)}},callResponsiveTrigger:function(I){var H=this,G=H.options;return G.responsiveTrigger.call(H,{state:I||H.state})},adaptRootView:function(H){var J=this,K=J.options,I=H||{},N=I.respTriggerOutput||J.callResponsiveTrigger(),G=K.useRootChannelView,M=J.currentRouteSteps.length-1,L=J.getViewAt(0);if(!G||M!==0){return}if(!L||!L.switchView){return}if(!N){L.switchView("channel")}else{L.switchView("tile")}},setExpandedLayout:function(Q){var L=this,G=Q||{},K=L.elements,N=K.content,I=L.widthCache||L.container.getDimensions().innerWidth,J=I*0.25,P=L.expandedLayout[0].size,O=L.leftColumnMin,H=L.leftColumnMax,M=L.leftColumnDefaultRatio;if(J<=O){P=O/I*100}else{if(J>=H){P=H/I*100}else{P=M}}L.expandedLayout[0].size=P;L.expandedLayout[1].size=100-P;return L.doSliderAction("setLayout",L.expandedLayout,G).then(function(){N.removeClassName(v.CONTRACTED);N.removeClassName(v.COLLAPSED);N.addClassName(v.EXPANDED);L.state=v.EXPANDED;return d.resolve()})},setContractedLayout:function(G){var K=this,H=K.elements,J=H.content,I=G||{};return K.doSliderAction("setLayout",K.contractedLayout,I).then(function(){J.removeClassName(v.EXPANDED);J.removeClassName(v.COLLAPSED);J.addClassName(v.CONTRACTED);K.state=v.CONTRACTED;return d.resolve()})},slideBack:function(){var I=this,H,G;if(I.panelSlider.isMuted()||I.currentRouteSteps.length===1){return}G=I.currentRouteSteps.map(function(J){return J});G.pop();H=G[G.length-1];H&&H.set("id",null);I.router.navigate(I.stringifySteps(G,I.options),{trigger:true})},setCollapsedLayout:function(H){H||(H={});var L=this,M=L.elements,K=M.content,G=H.steps||L.currentRouteSteps,J=L.collapsedLayout,N;function I(O){g.log("Skeleton: Error modifying collapsed layout "+(O?O.stack||O:""))}if(L.panelSlider.isMuted()||G.length<=1||(L.state===v.CONTRACTED&&(g.is(H.force)&&!H.force))){return d.resolve()}if(L.state!==v.COLLAPSED){N=L.doSliderAction("setLayout",J,H).then(function(){K.removeClassName(v.EXPANDED);K.removeClassName(v.CONTRACTED);K.addClassName(v.COLLAPSED);L.state=v.COLLAPSED;return d.resolve()})}else{N=d.resolve()}return N["catch"](I)},toggleCollapse:function(){var G=this;G.router.navigate(G.stringifySteps(G.currentRouteSteps,{rootIdCardOptions:G.options.rootIdCardOptions,state:G.getState()===v.COLLAPSED?"auto":v.COLLAPSED}),{trigger:true})},getViewAt:function(J){var I=this.getSteps(),H=I[J]?I[J].get("panelNode"):null,K=H?H.get("activeNode"):null,L=K?K.get("activeFacet"):null,G=L?L.view:null;if(!L){return null}return G},getNodeAt:function(I){var H=this.getSteps(),G=H[I]?H[I].get("panelNode"):null,J=G?G.get("activeNode"):null;return J},getIdCardAt:function(G){var I=this,H=I.getNodeAt(G);return H?H.get("idCard"):null},getModelAt:function(G){var I=this,H=I.getNodeAt(G);return H?H.get("assignedModel"):null},getCurrentPanelIndex:function(){return this.getSteps().length-1},setHeight:function(G,H){var L=this,K=L.getContent(),J={shouldCache:true},I=g.merge(H||{},J);if(!K){throw new Error("Content has not yet been created.")}L.heightCache=(I.shouldCache)?G:L.heightCache;switch(g.typeOf(G)){case"string":K.setStyle("height",G);break;case"number":K.setStyle("height",G+"px");break}},getState:function(){return this.state},getSkeletonState:function(){g.log("Skeleton: `getSkeletonState` is deprecated, use `getState` instead.");return this.getState.apply(this,arguments)},getSteps:function(){return this.tempRouteSteps||this.currentRouteSteps},getRoute:function(){var G=this,H=G.getState();return this.stringifySteps(G.getSteps(),{rootIdCardOptions:G.options.rootIdCardOptions,state:H===v.COLLAPSED?H:null})},setRoute:function(G){this.router.navigate(G,{trigger:true})},getActiveIdCard:function(){var H=this,G=H.getNodeAt(H.getSteps().length-1);return G?G.get("idCard"):null},refresh:function(){this.onResize({force:true})},hideFacet:function(L,H){if(!L){return}var J=this,I=H||{},G=L.view,K=g.is(I.notify)?I.notify:true;if(G){G.getContent().hide();if(K){J.throwEvents({name:"onFacetUnselect",args:[J],context:G})}}},showFacet:function(L,H){if(!L){return}var J=this,I=H||{},G=L.view,K=g.is(I.nofity)?I.notify:true;if(G){G.getContent().show();if(K){J.throwEvents({name:"onFacetSelect",args:[J],context:G})}}},switchFacets:function(G,J,H){var I=this;I.hideFacet(J,H);I.showFacet(G,H)},destroy:function(){var H=this,G=H.currentRouteSteps;H.stopListening();try{G.forEach(function(J){J.destroy({deleteRef:true})});if(H.panelSlider){H.panelSlider.destroy();H.panelSlider=null}}catch(I){g.log("Skeleton: Error destroying skeleton: "+I.stack)}G.length=0;H.tempRouteSteps&&(H.tempRouteSteps.length=0);H.rendererMap=null;H._parent.apply(H,arguments)}});g.extend(f,{getRendererHandler:function(J,H){var L=J,K={key:"_modelKey",fetchOptions:null,viewOptions:null},I=g.merge(H||{},K),G;if(!g.is(L,"string")&&!g.is(L,"class")){throw new Error("Renderer must be a string that references another renderer or a Constructor.")}G=function(N){var P=this,M=P.currentRouteSteps.map(function(Q){return Q.clone()}),O=M[N.stepIndex];if(g.is(L,"string")&&P.rendererMap[L]){O.set("renderer",L);O.set("facetIndex",null)}else{O.set("facetIndex",N.facetIndex);O.set("renderer",null)}O.set("id",null);M.splice(N.stepIndex+1,M.length);this.router.navigate(P.stringifySteps(M,{rootIdCardOptions:P.options.rootIdCardOptions,state:P.getState()}),{trigger:true})};I.rendererRef=L;G._opts=I;return G}});return f});