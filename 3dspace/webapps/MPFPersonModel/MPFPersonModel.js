define("DS/MPFPersonModel/MePersonDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFUrl/UrlUtils"],function(b,a){var d;var c={};c.ALLOW_CREATION="creationAllowed";c.PLATFORM="platform";d=b.extend({init:function(e){this._parent(e,"/me")},url:function(h,j,g){var f;var e;var i;g||(g={});f=this.connector.url(this.resourcePath);e=g[c.ALLOW_CREATION];if(e){f=(new a(f)).addParameter(c.ALLOW_CREATION,e).getUrl()}i=g[c.PLATFORM];if(i){f=(new a(f)).addParameter(c.PLATFORM,i).getUrl()}return f},request:function(f,e){if(e.method==="GET"){return this.connector.request(f,e)}else{e.onComplete()}}});d.Params=Object.freeze(c);return d});define("DS/MPFPersonModel/PersonModel",["DS/MPFModel/MPFModel","DS/MPFUtils/MPFUtils"],function(d,c){var e={};var a={};e.ID="id";e.FIRST_NAME="firstName";e.LAST_NAME="lastName";e.EMAIL="email";e.COMPANY="company";e.PERSON_ROLES="PersonRoles";e.BUYER_TYPE="buyerType";e.HAS_PUBLIC_SELLER_ROLE_ASSIGNED="HasPublicSellerRoleAssigned";a.BUYER="buyer";a.SHOP_OPERATOR="ShopOperator";a.OPERATOR="DSOperator";a.EMP_ADMIN="Admin";var b=d.extend({defaults:function(){var f={};f[e.ID]=null;f[e.FIRST_NAME]=null;f[e.LAST_NAME]=null;f[e.EMAIL]=null;f[e.COMPANY]=null;return f},setup:function(f,g){this._parent(f,g);this._type="PersonModel"},parse:function(f){return f},validate:c.doNothing,getFirstName:function(){return this.get(e.FIRST_NAME)},getLastName:function(){return this.get(e.LAST_NAME)},getCompany:function(){return this.get(e.COMPANY)},getCompanyId:function(){var f=this.getCompany();return f&&f.match(/\/([0-9A-F]{32})$/)[1]},getEmail:function(){return this.get(e.EMAIL)},getID:function(){return this.get(e.ID)},getRoles:function(){return this.get(e.PERSON_ROLES)},getBuyerType:function(){return this.get(e.BUYER_TYPE)},hasRole:function(h){var g;var f;g=this.getRoles()||[];f=c.findInArray(g,function(i){return i.Role===h});return !!f},isDSOperator:function(){return this.hasRole(a.OPERATOR)},isSeller:function(){return this.get(e.HAS_PUBLIC_SELLER_ROLE_ASSIGNED)==="TRUE"},isEmpAdmin:function(){var f;f=this.getRoles()||[];return f.some(function(g){return g.Role===a.EMP_ADMIN&&g.Project!=="Public"})},isAdminOfThisEMP:function(f){var g;g=this.getRoles()||[];return g.some(function(h){return h.Role===a.EMP_ADMIN&&h.Project===f})}});b.Fields=Object.freeze(e);b.Roles=Object.freeze(a);return b});define("DS/MPFPersonModel/ShopPersonsDataProxy",["DS/MPFDataProxy/DataProxy","UWA/Core","DS/MPFUrl/UrlUtils","DS/MPFCompanyModel/CompanyMemberDataProxy"],function(c,b,a,d){var e=c.extend({doDelete:null,doPatch:null,init:function(f){this._parent(f,"/mdshop/shops/{0}/members",new d(f))},request:function(g,f){if(f.method==="POST"||f.method==="PUT"){f.method="PATCH"}this._parent(g,f)},url:function(h,l,g){var i=h.parentResourceId;var k=b.String.format(this.resourcePath,i);var f;var j;f=this.connector.url(k);if(g.companyId){j=new a(f);j.addParameter("legalEntityID",g.companyId);f=j.getUrl()}return f},urlDelete:null,urlGet:function(f){return this.connector.url(b.String.format(this.resourcePath,f.parentResourceId||f.collection.parentResourceId))},urlPost:null,urlPatch:null});return e});define("DS/MPFPersonModel/PersonDataProxy",["DS/MPFDataProxy/DataProxy"],function(a){var b;b=a.extend({init:function(c){this._parent(c,"/mdpeople/people")}});return b});define("DS/MPFPersonModel/PersonCollection",["DS/MPFModel/MPFCollection","DS/MPFPersonModel/PersonModel"],function(c,b){var a=c.extend({model:b,addAll:function(f,g){var j=this;if(f&&f.length){var e=[];for(var h=0;h<f.length;h++){e.push({op:"add",value:f[h]})}var d={onComplete:function(k){for(var n=0;n<f.length;n++){var l=undefined;for(var m=0;m<k.length;m++){if(k[m].email.toLowerCase()===f[n].email.toLowerCase()){l=k[m];break}}j.add(new b(l,{dataProxy:j.dataProxy}))}if(g.onComplete){g.onComplete()}},onFailure:g.onFailure};if(g.companyId){d.companyId=g.companyId}this._doPatch(e,d)}},removeOne:function(i,g){var h=this;var f=g.remove;if(i){var e=[{op:"remove",path:"/"+i,value:{Roles:g.roles,ShopId:g.shopID}}];var d={onComplete:function(j){h.remove(i);if(g.onComplete){g.onComplete()}},onFailure:g.onFailure};if(g.companyId){d.companyId=g.companyId}this._doPatch(e,d)}},updateRoles:function(f,d){var e={};e.Roles=d.newRoles;if(d.shopId){e.ShopId=d.shopId}this._doPatch([{op:"modify",path:"/"+f,value:e}],{companyId:d.companyId})},_doPatch:function(g,f){if(g){if(f.companyId){this.parentResourceId=f.companyId}var e=this.dataProxy.delegate?this.dataProxy.delegate.url(this,"",f):this.dataProxy.url(this,"",f);if(e){var d={method:"PATCH",data:JSON.stringify(g),onComplete:f.onComplete,onFailure:f.onFailure};this.dataProxy.request(e,d)}}}});return a});