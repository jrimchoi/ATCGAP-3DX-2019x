define("DS/IterationsWebInWinWidget/IterationsWebInWinWidget",["UWA/Controls/Abstract","DS/ENO6WPlugins/jQuery","DS/WAFData/WAFData","DS/LifecycleServices/LifecycleServices","DS/WebInWinHelper/WebInWinHelper","DS/IterationsWidget/IterationsWidget","DS/LifecycleServices/LifecycleServicesSettings"],function(h,g,a,c,e,b,f){var d=h.extend({defaultOptions:{wintop:false,},webToWinCom_Socket:null,ContextualMenus:null,context:null,displayNotification:function(i){LifecycleAlert.displayNotification(i)},init:function(l,i,j){var k=this;this.widget=l;this.context=this;this.options=j;this.selectedOid=null;this.isWebInWinODTMode=j.isWebInWinODTMode;if(j.isWebInWinODTMode==true){window.IterationsWebInWinPayload=j.IterationsWebInWinPayload}this.securityContext=null;e.initTenant(k);e.getServices(k);this.contextMenuObject=null;if(this.options.wintop==true){this.webToWinCom_Socket=e.createWebInWinSocket("webinwiniteration_socket_")}this.options.webToWinComSocket=this.webToWinCom_Socket;this.parentWidget=i;this._parent(j);var m=UWA.createElement("div",{"class":"webinwin_iteration_frame",id:"webinwiniteration"});this.elements.container=m;m.style.width="100%";m.style.height="100%";m.setAttribute("data-rec-id",m.id);this.widget.body.setAttribute("data-rec-id","iterationsWebInWinWidgetParent");m.dataset.webinwinSocket=this.options.webToWinComSocket;window._webinwincom_socket=this.options.webToWinComSocket;this.iterationWidget=new b(this.widget,this.parentWidget,this.options)},setTitle:function(i){this.titleWidget.innerHTML=i},setTitleFromObject:function(i){if(i&&i.displayName){this.setTitle(i.displayName+" "+i.revision)}},getAttributes:function(j){var k=[];var i=this;c.listAttributes(j.platformID,[j.physicalid],["attribute[PLMEntity.V_Name]","revision"],function l(r){var q=r.results;var s=q[0];var n=s.revision;var o=s["attribute[PLMEntity.V_Name]"];var p=s["attribute[PLMEntity.V_usage]"];if(o==null){o=""}k={physicalid:r.physicalid,name:o,rev:n,type:p};i.onComplete(i,k)},function m(n){})},onComplete:function(i,k){window._oidAlias=k.name+" "+k.rev;var l=i.elements.container;if(typeof l!==undefined&&l!=null){while(l.hasChildNodes()){l.removeChild(l.lastChild)}}i.iterationWidget.buildWebInWinUI(i.webToWinCom_Socket);var j={physicalid:i.selectedOid,type:k.type};i.iterationWidget.setObject(j);i.iterationWidget.inject(i.elements.container)},initDatafromWin:function(j){var k=this;window._tenant=k.tenant;var l=[];e.setCSOSelectionIteration(k.webToWinCom_Socket,j);j.forEach(function(q){var n=q.physicalId;var p=q.name;var o={physicalid:n,name:p,tenant:k.tenant};l.push(o)});this.iterationWidget.setOptions(this.options);var m=k.elements.container;if(typeof m!==undefined&&m!=null){while(m.hasChildNodes()){m.removeChild(m.lastChild)}}if(l.length!=0){var i=l[0].physicalid;k.selectedOid=l[0].physicalid;k.selectedObj=l[0];window._oidAlias=l[0].name}e.sendGetLicenseNotif(k.webToWinCom_Socket)},onLicenseList:function(k){var l=this;l.licenseList=[];function o(i){this.license=i.license;this.authorized=i.authorized}o.prototype.getAvailable=function(i){if(typeof i!==undefined){if(this.license===i){return this.authorized}}};if(k.length!=0){for(var j=0;j<k.length;j++){var n=new o(k[j]);l.licenseList.push(n)}}if(l.licenseList.length>0){window._licenseList=l.licenseList}(l.isWebInWinODTMode==true)?window._isWebInWinODTMode=true:window._isWebInWinODTMode=false;if(l.licenseList.length>0){window._licenseList=l.licenseList}var m="DS/UWPClientCode/PublicAPI";if(l.isWebInWinODTMode==true){l.iterationWidget.buildWebInWinUI(l.webToWinCom_Socket,l.isWebInWinODTMode);l.iterationWidget.setObject(l.selectedObj);l.iterationWidget.inject(l.elements.container);return}require([m],function(i){c.getSecurityContextPromise(l.tenant).then(function(p){if(p!==null){l.securityContext=p;if(l.licenseList.length>0){window._licenseList=l.licenseList}l.options.securityContext=p;l.iterationWidget.buildWebInWinUI(l.webToWinCom_Socket,l.isWebInWinODTMode);l.iterationWidget.setObject(l.selectedObj);l.iterationWidget.inject(l.elements.container)}})})},onResize:function(){},onRefresh:function(){},initEnvfromWin:function(j){var i=this},});d.prototype.init=function(){c.getSecurityContextPromise().then(function(i){that.securityContext=i;var k=f.get3DSpaceWSUrl(that.tenant,"/resources/iteration/list/iterationlist",null);var j=function(l){if(typeof onError==="function"){c.onWebServiceError(onError,l)}};a.authenticatedRequest(k,{method:"POST",type:"json",headers:headers,timeout:600000,data:JSON.stringify(data),onComplete:function(l){console.log("IterationInfos: COMPLETED")},onFailure:function(l){console.log("attributes:Failure..."+l)},ontimeout:function(){var l="attributes: A connection timeout occured.";console.log(l)}})})};return d});