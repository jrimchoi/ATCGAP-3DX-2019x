/*!  COPYRIGHT DASSAULT SYSTEMES 2014   */
var byteArrayReader=function(a){this.buffer=a;this.currentPosition=0;this.readAt=function(b){return this.buffer[b]};this.length=function(){return buffer.length};this.getCurrentPosition=function(){return this.currentPosition};this.setPosition=function(b){this.currentPosition=b};this.read=function(){return this.buffer[this.currentPosition++]};this.readDouble=function(b,e){var c=new DataView(buffer.buffer);var d=c.getFloat64(b,true);return d};this.readUcompressedInt=function(b){if(b){return(this.read()<<24|this.read()<<16|this.read()<<8|this.read())>>>0}else{return(this.read()|this.read()<<8|this.read()<<16|this.read()<<24)>>>0}};this.readInt=function(b){if(b){return this.read()<<24|this.read()<<16|this.read()<<8|this.read()}else{return this.read()|this.read()<<8|this.read()<<16|this.read()<<24}};this.clone=function(){return new byteArrayReader(this.buffer)};this.getDataViews=function(c,b){views=[];views.push({dataView:new DataView(this.buffer.buffer,c,b),buffer:this.buffer,offset:c});return views}};var multiTabDecorations=function(){var b=2048;var e=null;var a=[];var c=0;var d=0;this.addDecoration=function(j){if(!e){e=new Uint8Array(b);a=[e]}var g=c;if((d+j.length)>b){var f=b-d;var h=(d+j.length)-b;this.writeDecoration(j,0,f);d=0;e=new Uint8Array(b);a.push(e);this.writeDecoration(j,f,h)}else{this.writeDecoration(j,0,j.length)}c+=j.length;return g+1};this.writeDecoration=function(h,j,g){for(var f=0;f<g;f++){e[d++]=h[j+f]}};this.getConcatenatedBlocks=function(){if(c==0){return null}var f=new Uint8Array(c);var g=0;for(var l=0;l<a.length;l++){for(var h=0;h<b;h++){f[g++]=a[l][h]}}return f}};define("DS/Formats/CGRFile",["DS/Mesh/Mesh","DS/Mesh/ThreeJS_Base"],function(be,ap){var g=false;var aM=false;var b9=true;var C=true;var a2=false;var bI=false;var h=false;var aO=true;var b3=210042110;var U=true;var o=new Float32Array(100);var bL=new Int16Array(100);var ay=new Uint8Array(100);var aN=4278190080;var f=4128768;var b=61440;var F=3840;var Q=255;var bR={UNDEFINED:255,FACE3:80,PLANARFACE3:81,LINE3:82,POLYLINE3:83,MARKER3:84,FIXEDARROW:85,FIXEDPLAN:86,CYLINDER:87,CURVEDPIPE:88,ANNOTEXT3:89,EDGE3:96,ARROW3:119,INTERNALSMOOTHEDGE3:134,ARCELLIPSE3:156,ARCCIRCLE3:157,IMAGEPIXEL3:160,EDGECRV3:162};var p=new Map([["Monos.pfb","Monospac821 BT"],["DSISO1.otf","DS ISO 1"]]);var aG=1;var aX={NORMAL:0,STATIC:1,EXCLUDE:2,EXCLUDE_STATIC:3,NOZ:4,NOZ_STATIC:5,EXCLUDE_NOZ:6,EXCLUDE_NOZ_STATIC:7};var ac={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5,};var aw={LAYER_MAX:4294967295,LAYER_MAX_MINUS_ONE:4294967294,STREAM_NONE:0,STREAM_MATERIAL:1,STREAM_INHERIT_INT:2,STREAM_INHERIT_UINT:4,STREAM_INHERIT_ULONG:8,STREAM_LAYER_INT:16,STREAM_LAYER_UINT:32,STREAM_LAYER_ULONG:64,STREAM_UVTRANSFO:128,STREAM_MAPPING_INFO:256,STREAM_ALL_INT:403,STREAM_ALL_UINT:421,STREAM_ALL_ULONG:457};var ak=[1,1,2,3,4,5,6,7,8];var W=function(cn,co){this.name=co;this.conversion=false;this.version=0;this.bitBoolean=0;this.bitPacking=0;this.intPacking=0;this.gasPacking=0;this.global_gas=[];var cl=true;this.expandCGR=false;var cs=false;var cr=[];this.isInherit=false;this.textures=new X();this.materials=new X();this.fakeMultiRep=new X();this.reps=[];this.reps[aX.NORMAL]=new X();this.reps[aX.EXCLUDE]=new X();this.reps[aX.EXCLUDE_NOZ]=new X();this.reps[aX.EXCLUDE_STATIC]=new X();this.reps[aX.EXCLUDE_NOZ_STATIC]=new X();this.reps[aX.NOZ]=new X();this.reps[aX.NOZ_STATIC]=new X();this.reps[aX.STATIC]=new X();this.axisSystems=new X();this.sgRep=[];this.nbRep=0;this.decorations=new multiTabDecorations();this.refPlanes=new X();this.texts=new X();this.currentMatrix=[];this.staticMode=[];this.multiRefNode=new X();this.buffer=cn;this.numberOfVertices=0;this.cgrContainer=null;this.bitContainer=0;this.bitsRemaining=0;this.nbBitsPerVertex=0;var cm=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,2147483647];var cq=0;var cp=[0,0,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9];this.isLightScenegraph=function(){return cs};this.createMatrix3=function(ct){var cu=[ct[0],ct[1],0,ct[2],ct[3],0,ct[4],ct[5],1];return cu};this.addReps=function(cB,cv,cw,cA){var cy=0;var cx=0;var cz=cA?1:0;cy=cw?1:0;cx=cv?1:0;var ct=cy<<2|cz<<1|cx;if(this.expandCGR){ct=0}var cu=this.reps[ct].add(cB);return{renderType:ct,indice:cu}};this.setReps=function(ct){this.reps=ct};this.getAllReps=function(){return this.reps};this.initReps=function(){this.reps=[];this.reps[aX.NORMAL]=new X();this.reps[aX.EXCLUDE]=new X();this.reps[aX.EXCLUDE_NOZ]=new X();this.reps[aX.EXCLUDE_STATIC]=new X();this.reps[aX.EXCLUDE_NOZ_STATIC]=new X();this.reps[aX.NOZ]=new X();this.reps[aX.NOZ_STATIC]=new X();this.reps[aX.STATIC]=new X()};this.getReps=function(cu,ct){return this.reps[ct].get(cu)};this.getBytesRemain=function(){return this.buffer.getBytesRemain()};this.readString=function(cv){var ct=new String();for(var cu=0;cu<cv;cu++){var cw=String.fromCharCode(this.buffer.read());ct+=cw}return ct};this.readStringWithLength=function(cv){var ct=new String();var cv=this.readCompressedInt();for(var cu=0;cu<cv;cu++){var cw=String.fromCharCode(this.buffer.read());ct+=cw}return ct};this.readUnicodeString=function(cw){var ct=new String();for(var cu=0;cu<cw-1;cu++){var cv=this.readUnsignedShort();ct+=String.fromCharCode(cv)}this.readUnsignedShort();return ct};this.setCurrentPosition=function(ct){this.buffer.setPosition(ct)};this.getCurrentPosition=function(){return this.buffer.getCurrentPosition()};this.skip=function(ct){this.buffer.setPosition(this.buffer.getCurrentPosition()+ct)};this.readClassName=function(){var ct=this.readUnsignedChar();return ct};this.getUnstreamer=function(ct){switch(ct){case 97:return new z();break;case 98:return new j();break;case 99:return new bC();break;case 100:return new b2();break;case 101:return new bi();break;case 102:return new O();break;case 103:return new z();break;case 104:return new bf();break;case 112:return new ci();break;case 113:return new bJ();break;case 114:return new z();break;case 115:return new z();break;case 116:return new cc();break;case 120:return new a9();break;case 137:return new bN();break;case 145:return new z();break;case 146:return new z();break;case 147:return new bd();break;case 148:return new z();break;case 149:return new ax();break;case 150:return new z();break;case 152:return new ca();break;case 153:return new z();break;case 154:return new ao();break;case 158:return new z();break;case 159:return new z();break;case 161:return new bk();break;case 163:return new bS();break;case 170:return new ab();break;case 171:return new aR();break;case 172:return new bu();break;case 173:return new a0();break;case 174:return new bM();break;case 175:return new B();break;case 176:return new ai();break;case 179:return new z();break;case 181:return new z();break;case 182:return new ag();break;case 183:return new bt();break;case 184:return new z();break;case 185:return new bU();break;case 186:return new v();break;case 188:return new z();break;case 255:return new z();break;default:this.error="file is corrupted.  unknown className..."+ct;return null;break}};this.readGraphicAttributeSet=function(){return new bl(this.readUncompressedInt(),this.readUncompressedInt())};this.readMatrix=function(){var cA=[];var cy=0;if(this.version>=210021610){var cx=this.readCompressedInt();var cv=this.readUnsignedChar();var cz=[];this.readDoubles(cz,cv);var ct=0;var cu=0;for(cy=0,ct=0;cy<16;cy++){cu=(cx&(3<<2*cy))>>2*cy;switch(cu){case 0:cA[cy]=cz[ct++];break;case 1:case -1:cA[cy]=0;break;case -2:case 2:cA[cy]=1;break;case 3:case -3:cA[cy]=-1;break;default:break}}}else{for(var cy=0;cy<16;++cy){cA.push(this.readFloat())}}var cw=new ap.Matrix4();cw.set(cA[0],cA[4],cA[8],cA[12],cA[1],cA[5],cA[9],cA[13],cA[2],cA[6],cA[10],cA[14],cA[3],cA[7],cA[11],cA[15]);return cw};this.read2DMatrix=function(){var cv=[];var cu=0;for(var cu=0;cu<16;++cu){cv.push(this.readFloat())}var ct=new ap.Matrix4();ct.set(cv[0],cv[4],cv[8],cv[12],cv[1],cv[5],cv[9],cv[13],cv[2],cv[6],cv[10],cv[14],cv[3],cv[7],cv[11],cv[15]);return ct};this.readFloatArray=function(cu,ct,cv){this.buffer.readFloatArray(cu,ct,cv,this.conversion)};this.readFloatArrayBuffer=function(ct,cu){this.buffer.readFloatArrayBuffer(ct,cu,this.conversion)};this.readDouble=function(){var ct=this.buffer.readDouble(this.conversion);return ct};this.readDoubles=function(ct,cv){for(var cu=0;cu<cv;++cu){ct.push(this.readDouble())}};this.getNumberOfVertices=function(){return this.numberOfVertices};this.setNumberOfVertices=function(cu){this.numberOfVertices=cu;if(this.bitPacking){if(cu<500){cq=cp[this.numberOfVertices];return}cq=0;var ct=cu;do{++cq}while(ct>>=1)}};this.setContainer=function(ct){this.cgrContainer=ct};this.getContainer=function(){return this.cgrContainer};this.readBits=function(cu){var cv;if(cu<=this.bitsRemaining){cv=this.bitContainer&cm[cu];this.bitContainer>>=cu;this.bitsRemaining-=cu}else{if(cu<=32){cv=0;var cw=cu;cv|=this.bitContainer&cm[this.bitsRemaining];cw-=this.bitsRemaining;this.bitContainer=this.readUncompressedInt();cv|=(this.bitContainer&cm[cw])<<this.bitsRemaining;this.bitContainer>>=cw;this.bitsRemaining=32-cw}else{var ct=0;var cw=cu;do{while(this.bitsRemaining&&cw){cv|=(this.bitContainer&1)<<ct++;bitContainer>>=1;this.bitsRemaining--;cw--}if(cw){this.bitContainer=this.readUncompressedInt();this.bitsRemaining=32}}while(cw)}}return cv};this.readBit=function(){var ct=0;if(this.bitsRemaining){ct=this.bitContainer&1;this.bitContainer>>=1;this.bitsRemaining--;return ct}else{this.bitContainer=this.readUncompressedInt();ct=this.bitContainer&1;this.bitContainer>>=1;this.bitsRemaining=31;return ct}};this.readBoolean=function(){var ct;if(this.bitBoolean){ct=this.readBit()}else{ct=this.readUnsignedChar()}return ct};this.readPositions=function(cx,cC,ct){var cJ=3*cx;var cv=this.readBoolean();if(cv){this.readFloatArray(cJ,3*cC,ct)}else{var cF=Math.ceil(cC/4);var cy=this.buffer.getByteView(cF,ay);var cI=this.readCompressedInt();if(cI>o.length){o=new Float32Array(cI)}this.readFloatArrayBuffer(cI,o);var cu=0;var cG=0;var cE=0;var cD=0;var cB=0;var cA=0;var cH=0;for(var cz=0;cz<cC;cz++){if(cG==0){cH=(cy[cu]&3)}if(cG==1){cH=(cy[cu]&12)>>2}if(cG==2){cH=(cy[cu]&48)>>4}if(cG==3){cH=(cy[cu]&192)>>6;cG=-1;cu++}cG++;var cw=3*cz;if(cH==0){ct[cJ++]=o[cE];ct[cJ++]=o[cE+1];ct[cJ++]=o[cE+2];cD=o[cE];cB=o[cE+1];cA=o[cE+2];cE+=3}else{if(cH==2){ct[cJ++]=cD;ct[cJ++]=cB;ct[cJ++]=o[cE];cA=o[cE];cE++}else{if(cH==3){ct[cJ++]=cD;ct[cJ++]=o[cE];ct[cJ++]=o[cE+1];cB=o[cE];cA=o[cE+1];cE+=2}else{ct[cJ++]=cD;ct[cJ++]=cB;ct[cJ++]=cA}}}}}};this.readOldPositionsArrayBuffer=function(cD,ct,cy){var cv=this.readBoolean();if(cv){for(var cB=0;cB<cD;++cB){ct[cy++]=this.readFloat()}}else{var cG=Math.ceil(cD/12);var cz=new Uint8Array(cG);this.readBytes(cG,cz);var cI=this.readCompressedUInt();var cx=new Float32Array(cI);for(var cB=0;cB<cI;++cB){cx[cB]=this.readFloat()}var cu=0;var cH=0;var cF=0;var cE=0;var cC=0;var cA=0;for(var cB=0;cB<cD/3;cB++){if(cH==0){flagvalue=(cz[cu]&3)}if(cH==1){flagvalue=(cz[cu]&12)>>2}if(cH==2){flagvalue=(cz[cu]&48)>>4}if(cH==3){flagvalue=(cz[cu]&192)>>6;cH=-1;cu++}cH++;var cw=3*cB;if(flagvalue==0){ct[cy*3+cw]=cx[cF];ct[cy*3+cw+1]=cx[cF+1];ct[cy*3+cw+2]=cx[cF+2];cE=cx[cF];cC=cx[cF+1];cA=cx[cF+2];cF+=3}else{if(flagvalue==2){ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cC;ct[cy*3+cw+2]=cx[cF];cA=cx[cF];cF++}else{if(flagvalue==3){ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cx[cF];ct[cy*3+cw+2]=cx[cF+1];cC=cx[cF];cA=cx[cF+1];cF+=2}else{ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cC;ct[cy*3+cw+2]=cA}}}}}};this.readPositionsArrayBuffer=function(cD,ct,cy){var cv=this.readBoolean();if(cv){for(var cB=0;cB<3*cD;++cB){ct[cy*3+cB]=this.readFloat()}}else{var cG=Math.ceil(cD/4);var cz=new Uint8Array(cG);this.readBytes(cG,cz);var cJ=this.readCompressedInt();var cx=new Float32Array(cJ);for(var cB=0;cB<cJ;++cB){cx[cB]=this.readFloat()}var cu=0;var cH=0;var cF=0;var cE=0;var cC=0;var cA=0;var cI=0;for(var cB=0;cB<cD;cB++){if(cH==0){cI=(cz[cu]&3)}if(cH==1){cI=(cz[cu]&12)>>2}if(cH==2){cI=(cz[cu]&48)>>4}if(cH==3){cI=(cz[cu]&192)>>6;cH=-1;cu++}cH++;var cw=3*cB;if(cI==0){ct[cy*3+cw]=cx[cF];ct[cy*3+cw+1]=cx[cF+1];ct[cy*3+cw+2]=cx[cF+2];cE=cx[cF];cC=cx[cF+1];cA=cx[cF+2];cF+=3}else{if(cI==2){ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cC;ct[cy*3+cw+2]=cx[cF];cA=cx[cF];cF++}else{if(cI==3){ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cx[cF];ct[cy*3+cw+2]=cx[cF+1];cC=cx[cF];cA=cx[cF+1];cF+=2}else{ct[cy*3+cw]=cE;ct[cy*3+cw+1]=cC;ct[cy*3+cw+2]=cA}}}}}};this.readNormalsArrayBuffer=function(cu,cK,cy){if(cu==0){return}var cD=1/32767;if(this.version>1101220){var cE=this.readCompressedInt();if(cE>bL.length){bL=new Int16Array(cE)}this.buffer.readShortArrayBuffer(cE,bL,this.conversion);var cO=Math.ceil(cu/2);if(cO>ay.length){ay=new Uint8Array(cO)}var cN=this.buffer.getByteView(cO,ay);var cH=-1;var cG=0;var cC=0;var cB=0;var cv=3*cu;var cL=cy*3;var cx;for(var cF=0;cF<cv;cF++){if(cF%2){cx=(cN[cH]&240)>>4}else{cx=(cN[++cH]&15)}switch(cx){case 0:cC=cK[cL+1]=bL[cG++]*cD;cB=cK[cL+2]=bL[cG++]*cD;cK[cL]=Math.sqrt(1-(cC*cC+cB*cB));break;case 1:cC=cK[cL+1]=bL[cG++]*cD;cB=cK[cL+2]=bL[cG++]*cD;cK[cL]=-Math.sqrt(1-(cC*cC+cB*cB));break;case 2:cC=cK[cL]=bL[cG++]*cD;cB=cK[cL+2]=bL[cG++]*cD;cK[cL+1]=Math.sqrt(1-(cC*cC+cB*cB));break;case 3:cC=cK[cL]=bL[cG++]*cD;cB=cK[cL+2]=bL[cG++]*cD;cK[cL+1]=-Math.sqrt(1-(cC*cC+cB*cB));break;case 4:cC=cK[cL]=bL[cG++]*cD;cB=cK[cL+1]=bL[cG++]*cD;cK[cL+2]=Math.sqrt(1-(cC*cC+cB*cB));break;case 5:cC=cK[cL]=bL[cG++]*cD;cB=cK[cL+1]=bL[cG++]*cD;cK[cL+2]=-Math.sqrt(1-(cC*cC+cB*cB));break;case 6:cK[cL]=1;cK[cL+1]=0;cK[cL+2]=0;break;case 7:cK[cL]=-1;cK[cL+1]=0;cK[cL+2]=0;break;case 8:cK[cL]=0;cK[cL+1]=1;cK[cL+2]=0;break;case 9:cK[cL]=0;cK[cL+1]=-1;cK[cL+2]=0;break;case 10:cK[cL]=0;cK[cL+1]=0;cK[cL+2]=1;break;case 11:cK[cL]=0;cK[cL+1]=0;cK[cL+2]=-1;break}cL=cL+3}}else{var cA=[];var cD=1/32767;var cJ=cu/3;this.readShortArray(2*cJ,cA);var cO=Math.ceil(cJ/8);var cN=new Uint8Array(cO);cN=this.buffer.getByteView(cO,ay);var ct=0,cH=-1;var cC,cw;var cz;for(var cI=0,cG=0,cF=0;cI<cu;cI+=3,cG+=2,cF++){cK[cI]=cA[cG]*cD;cK[cI+1]=cA[cG+1]*cD;cz=1-(cK[cI]*cK[cI]+cK[cI+1]*cK[cI+1]);ct=cF%8;if(ct==0){cH++}if(cz<=0){cw=0}else{if(cz<=0.03){cC=0.05}else{cC=0.25+cz*(0.25+1/(1+cz))}var cM;while(1){cw=0.5*(cC+cz/cC);cM=cC-cw;if(cM<cD&&cM>-cD){cC=cw;break}cC=cw}}cK[cI+2]=cN[cH]&(1<<ct)?-cw:cw}}};this.readNormals=function(cy,cz,ct){var cI=3*cy;if(cz==0){return}var cF=1/32767;if(this.version>1101220){var cB=this.readCompressedInt();if(cB>bL.length){bL=new Int16Array(cB)}this.buffer.readShortArrayBuffer(cB,bL,this.conversion);var cD=Math.ceil(cz/2);if(cD>ay.length){ay=new Uint8Array(cD)}var cA=this.buffer.getByteView(cD,ay);var cx=-1;var cw=0;var cH=0;var cG=0;var cC=3*cz;var cE=cy;var cv;for(var cu=0;cu<cC/3;cu++){if(cu%2){cv=(cA[cx]&240)>>4}else{cv=(cA[++cx]&15)}switch(cv){case 0:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=Math.sqrt(1-(cH*cH+cG*cG));ct[cI++]=cH;ct[cI++]=cG;break;case 1:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=-Math.sqrt(1-(cH*cH+cG*cG));ct[cI++]=cH;ct[cI++]=cG;break;case 2:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=cH;ct[cI++]=Math.sqrt(1-(cH*cH+cG*cG));ct[cI++]=cG;break;case 3:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=cH;ct[cI++]=-Math.sqrt(1-(cH*cH+cG*cG));ct[cI++]=cG;break;case 4:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=cH;ct[cI++]=cG;ct[cI++]=Math.sqrt(1-(cH*cH+cG*cG));break;case 5:cH=bL[cw++]*cF;cG=bL[cw++]*cF;ct[cI++]=cH;ct[cI++]=cG;ct[cI++]=-Math.sqrt(1-(cH*cH+cG*cG));break;case 6:ct[cI++]=1;ct[cI++]=0;ct[cI++]=0;break;case 7:ct[cI++]=-1;ct[cI++]=0;ct[cI++]=0;break;case 8:ct[cI++]=0;ct[cI++]=1;ct[cI++]=0;break;case 9:ct[cI++]=0;ct[cI++]=-1;ct[cI++]=0;break;case 10:ct[cI++]=0;ct[cI++]=0;ct[cI++]=1;break;case 11:ct[cI++]=0;ct[cI++]=0;ct[cI++]=-1;break}cE=cE+3}}};this.readTextures=function(cz,cx,cA,cu){var cy=cA*cx;if(cA==3){this.readFloatArray(3*cz,cy,cu);return}var cw=0;var cv=0;var ct=new Float32Array(cy);this.readFloatArray(0,cy,ct);if(cA==1){for(cw=0;cw<cy;cw++){cu[3*cz+cv++]=ct[cw];cu[3*cz+cv++]=0;cu[3*cz+cv++]=0}}else{if(cA==2){for(cw=0;cw<cy;cw+=2){cu[3*cz+cv++]=ct[cw];cu[3*cz+cv++]=ct[cw+1];cu[3*cz+cv++]=0}}}};this.unpackcArray=function(cu,cw,cv){if(this.bitPacking){for(var ct=0;ct<cu;++ct){cw[ct+cv]=this.readBits(cq)}return}else{if(this.version>=1100600){if(this.numberOfVertices<256){this.buffer.readBytes(cv,cu,cw);return}}}if(this.numberOfVertices<65536){this.buffer.readUnsignedShortArray(cv,cu,cw,false)}else{if(this.numberOfVertices<16777216){this.buffer.unpackc24(cv,cu,cw)}else{for(var ct=0;ct<cu;++ct){cw[ct+cv]=this.readCompressedInt()}}}};this.unpackc=function(){if(this.bitPacking){return this.readBits(cq)}if(this.version>=1100600){if(this.numberOfVertices<256){return this.readUnsignedChar()}}if(this.numberOfVertices<65536){return(this.readUnsignedChar()<<8&65280)|(this.readUnsignedChar()&255)}else{if(this.numberOfVertices<16777216){return(this.readUnsignedChar()<<16&16711680)|(this.readUnsignedChar()<<8&65280)|(this.readUnsignedChar()&255)}else{return this.readCompressedInt()}}};this.getStaticMode=function(){if(this.staticMode.length){var ct=this.staticMode[this.staticMode.length-1];if(ct){return ct}}return null};this.pushStaticMode=function(ct){this.staticMode.push(ct)};this.popStaticMode=function(){this.staticMode.pop()};this.getGAS=function(){if(this.global_gas.length){return this.global_gas[this.global_gas.length-1].inherited}};this.pushGAS=function(cx,cw){var cy,cz=0;if(this.global_gas.length){var ct=this.global_gas[this.global_gas.length-1];cz=ct.inh_mode;cy=ct.inherited;if(cz&4){cx.setColor(cy.getColor());var cu=cy.getRGBAColor();cx.setRGBAColorRGBChannel(cu[0],cu[1],cu[2])}if(cz&4096){var cu=cy.getRGBAColor();cx.setRGBAColorAlphaChannel(cu[3])}if(cz&16){cx.setLineThickness(cy.getLineThickness())}if(cz&64){cx.setLinetype(cy.getLinetype())}if(
/*!(current_mode)*/
1){var cv=cy.isHidden();if(cv){cx.setShowMode(cv)}}}this.global_gas.push({inh_mode:(cz|cw),inherited:cx});return cx};this.popGAS=function(){return this.global_gas.pop()};this.popMatId=function(){if(cr.length>0){var ct=cr.pop();if(ct.inherit){this.isInherit=false}return ct}else{return{file:"",id:-1}}};this.pushMatId=function(cy,cx,cw){var ct=aw.LAYER_MAX;if(cr.length){var cv=cr[cr.length-1];ct=cv.layer}if(cw!==ct){if((cw<ct)&&(cx!==0)){var cu=true;if(this.isInherit==true){cu=false}this.isInherit=true;cr.push({file:cy.file,id:cy.id,inherit:cu,layer:cw})}else{var cv=cr[cr.length-1];if(cv){cr.push({file:cv.file,id:cv.id,inherit:false,layer:cv.layer})}}}else{if((cx==2)||(cx==1&&!this.isInherit)){var cu=true;if(this.isInherit==true){cu=false}this.isInherit=true;cr.push({file:cy.file,id:cy.id,inherit:cu,layer:cw})}else{if(!this.isInherit&&cx==0){cr.push({file:"",id:-1,inherit:false,layer:cw})}else{var cv=cr[cr.length-1];cr.push({file:cv.file,id:cv.id,inherit:false,layer:cv.layer})}}}};this.check=function(){if(cr.length!=0){console.warn("material stack length = "+cr.length)}if(this.global_gas.length!=0){console.warn("GAS stack length = "+this.global_gas.length)}if(this.currentMatrix.length!=0){console.warn("currentMatrix stack length = "+this.currentMatrix.length)}};this.pushMatrix=function(cu){var ct=this.currentMatrix[this.currentMatrix.length-1];var cv;if(ct==null){cv=cu}else{cv=new ap.Matrix4();cv.multiplyMatrices(ct,cu)}this.currentMatrix.push(cv);return cv};this.popMatrix=function(){return this.currentMatrix.pop()};this.getLightDataStreaming=function(){return cl};this.setLightDataStreaming=function(ct){cl=ct};this.copyStreamerInheritance=function(ct){ct.setLightDataStreaming(this.getLightDataStreaming());ct.conversion=this.conversion;ct.version=this.version;ct.global_gas=this.global_gas;ct.textures=this.textures;ct.materials=this.materials;ct.decorations=this.decorations;ct.sgRep=this.sgRep;ct.nbRep=this.nbRep};this.getCurrentMatrix=function(){return this.currentMatrix[this.currentMatrix.length-1]};this.getCurrentMatId=function(){var ct=cr[cr.length-1];if(ct){return{file:ct.file,id:ct.id}}return null}};W.prototype.readFloat=function(){return this.buffer.readFloat(this.conversion)};W.prototype.readUnsignedChar=function(){return this.buffer.read()};W.prototype.readBytes=function(cl,cn){for(var cm=0;cm<cl;cm++){cn[cm]=this.buffer.read()}};W.prototype.readShortArray=function(cl,cm){this.buffer.readShortArray(0,cl,cm,this.conversion)};W.prototype.readUnsignedShort=function(){if(this.conversion){return this.buffer.read()<<8|this.buffer.read()}else{return this.buffer.read()|this.buffer.read()<<8}};W.prototype.readShort=function(){var cm=this.buffer.read();var cl=this.buffer.read();if(this.conversion){var cn=(cm&127)<<8|cl;cn=cn-((cm&128)<<8);return cn}else{var cn=(cl&127)<<8|cm;cn=cn-((cl&128)<<8);return cn}};W.prototype.readUncompressedUInt=function(){return this.buffer.readUncompressedInt(this.conversion)};W.prototype.readUncompressedInt=function(){return this.buffer.readInt(this.conversion)};W.prototype.readUncompressedIntArray=function(cm,cn){for(var cl=0;cl<cm;cl++){cn[cl]=this.readUncompressedInt()}};W.prototype.readCompressedUInt=function(){if(this.intPacking){return this.readCompressedInt()}if(this.version>=1101410){var cl=this.readUnsignedChar();if(cl==255){return this.buffer.readInt(this.conversion)}else{return cl}}else{return this.buffer.readInt(this.conversion)}};W.prototype.readCompressedInt=function(){if(this.version>=1100600){var cl=this.buffer.read();if(cl<255){return cl}return this.buffer.readInt(this.conversion)}else{return this.buffer.readInt(this.conversion)}};var bl=function(cm,cl){this.set=cm||0;this.rgba=cl||0};bl.prototype={constructor:bl,setColor:function(cl){this.set&=(~(255<<24));this.set|=(cl&255)<<24},setRGBAColorRGBChannel:function(cn,cm,cl){this.rgba&=(~(16777215<<8));this.rgba|=((cn<<16|cm<<8|cl)&16777215)<<8},setRGBAColorAlphaChannel:function(cl){this.rgba&=(~(255));this.rgba|=(cl&255)},setLinetype:function(cl){this.set&=(~(63<<18));this.set|=(cl&63)<<18},setType:function(cl){this.set&=(~(3<<4));this.set|=(cl&3)<<4},setShowMode:function(cl){this.set&=(~(1<<3));this.set|=(cl&1)<<3},setLineThickness:function(cl){this.set&=(~(63<<12));this.set|=(cl&63)<<12},getColor:function(){return((this.set>>24)&255)},getRGBAColor:function(){var cl=[];cl[0]=((this.rgba>>24)&255);cl[1]=((this.rgba>>16)&255);cl[2]=((this.rgba>>8)&255);cl[3]=(this.rgba&255);return cl},getDisplayedColor:function(){if(this.getColor()==255){return this.getRGBAColor()}else{var cl=[];switch(this.getColor()){case 254:case 253:cl[0]=0;cl[1]=0;cl[2]=0;cl[3]=255;break;case 252:cl[0]=62;cl[1]=102;cl[2]=85;cl[3]=255;break;case 251:case 250:cl[0]=255;cl[1]=128;cl[2]=0;cl[3]=255;break;case 249:cl[0]=0;cl[1]=0;cl[2]=0;cl[3]=255;break;case 248:cl[0]=255;cl[1]=255;cl[2]=255;cl[3]=255;break;case 247:cl[0]=255;cl[1]=0;cl[2]=0;cl[3]=255;break;case 246:cl[0]=0;cl[1]=255;cl[2]=0;cl[3]=255;break;case 245:cl[0]=0;cl[1]=0;cl[2]=255;cl[3]=255;break;case 244:cl[0]=255;cl[1]=255;cl[2]=0;cl[3]=255;break;case 243:cl[0]=255;cl[1]=0;cl[2]=255;cl[3]=255;break;case 242:cl[0]=0;cl[1]=255;cl[2]=255;cl[3]=255;break;case 241:cl[0]=0;cl[1]=255;cl[2]=0;cl[3]=255;break;case 240:cl[0]=255;cl[1]=0;cl[2]=0;cl[3]=255;break;case 239:cl[0]=255;cl[1]=0;cl[2]=0;cl[3]=255;break;default:cl[0]=0;cl[1]=0;cl[2]=0;cl[3]=255;break}return cl}},getLinetype:function(){return((this.set>>18)&63)},getLineThickness:function(){var cl=((this.set>>12)&63);if(cl>ak.length){cl=1}else{cl=ak[cl]}return cl},getType:function(){return((this.set>>4)&3)},isNoZ:function(){return(this.getType()==0)},isSolid:function(){if(this.getType()==3){return 1}return 0},isHidden:function(){return((this.set>>3)&1)},isTransparent:function(){return((this.set>>7)&1)},clone:function(){return new bl(this.set,this.rgba)}};var a=function(cr){var cs=cr.readUncompressedInt(false);var cp=4294967295&cr.readUncompressedInt(false);cp|=(4294967295&cr.readUncompressedInt(false))<<32;var cm=4294967295&cr.readUncompressedInt(false);cm|=(4294967295&cr.readUncompressedInt(false))<<32;if(!cb){return}var cz=4294967295&cr.readUncompressedInt(false);cz|=(4294967295&cr.readUncompressedInt(false))<<32;var co=4294967295&cr.readUncompressedInt(false);co|=(4294967295&cr.readUncompressedInt(false))<<32;var cy=cr.readUncompressedInt(false);var ct=cr.readUncompressedInt(false);var cx=cr.readUncompressedInt(false);var cw=cr.readUncompressedInt(false);var cv=cr.readUncompressedInt(false);var cq=new Uint8Array(8);var cu=cr.readBytes(8,cq);var cl=cr.readUncompressedInt(false);var cn=cr.readUncompressedInt(false)};var by=function(cl){this.offset=cl.readUncompressedInt(false);this.length=cl.readUncompressedInt(false);var cn=cl.readUncompressedInt(false);this.beginPos=cl.readUncompressedInt(false);var cm=cl.readUncompressedInt(false)};var s=function(cr,co){var cq=cr.readUncompressedInt(false);this.id=cr.readUncompressedInt(false);var cs=cr.readUnsignedShort(false);var cn=new a(cr);var cm=cr.readUncompressedInt(false);this.blocs=[];var cu=[];var ct;var cp;if(cm>0){for(var cl=0;cl<cm;++cl){this.blocs.push(new by(cr))}}if(co>0){ct=cr.readUncompressedInt(false);cp=cr.readUncompressedInt(false);for(var cl=0;cl<co;++cl){cu.push(new aV(cr))}}this.getRootTocEntry=function(){for(var cv=0;cv<cu.length;++cv){var cw=cu[cv].fatherId;if(cu[cv].fatherId==0){return cu[cv]}}};this.getChildEntryByFatherId=function(cx,cv){for(var cw=0;cw<cu.length;++cw){if(cu[cw].fatherId==cx){if(cu[cw].name==cv){return cu[cw]}}}};this.getChildEntry=function(cw,cv){return this.getChildEntryByFatherId(cw.getId(),cv)}};var bQ={TEXTURE_SIMPLE:0,TEXTURE_SIMPLE_WITH_MIPMAP:1,TEXTURE_VOLUME:2,TEXTURE_VOLUME_WITH_MIPMAP:3,TEXTURE_CUBIC_ENV_MAP:4,TEXTURE_CUBIC_ENV_MAP_WITH_MIPMAP:5};var ar={Version0:-1159921408,Version0Converted:-86375937,Version1:122298,Version1Converted:-16655622,Version2:-86376192,Version2Converted:121594,Version3:-86376177,Version3Converted:251779834};var ck={L:0,LA:1,RGB:2,RGBA:3,BILEVEL:4,BADFORMAT:5,RGB_S3TC_DXT1:6,RGBA_S3TC_DXT1:7,RGBA_S3TC_DXT3:8,RGBA_S3TC_DXT5:9,RGB_f:10,RGBA_f:11,BGR:12,BGRA:13};var a8={Stream_DEFAULT:0,Stream_BADCOMPRESSED:1,Stream_CCITTG3:2,Stream_UNCOMPRESSED:3,Stream_PNG:4,Stream_JPEG:5};var bH=function(){this.unstream=function(cs,cm){var cq;var ct;var cn;var cz;var cy;var cA=false;var cp=cs.conversion;var cl=0;cl=cs.readCompressedInt();if(cp){if((cl==ar.Version0)||(cl==ar.Version1)){cn=cs.readCompressedInt()}else{if((cl==ar.Version0Converted)||(cl==ar.Version1Converted)){cn=cs.readCompressedInt()}else{if(cl==ar.Version2){}else{if(cl==ar.Version2Converted){}else{if(cl==ar.Version3){}else{if(cl==ar.Version3Converted){}else{cn=cl}}}}}}}else{if((cl==ar.Version0)||(cl==ar.Version1)){cn=cs.readCompressedInt()}else{if((cl==ar.Version0Converted)||(cl==ar.Version1Converted)){cn=cs.readCompressedInt()}else{if(cl==ar.Version2){}else{if(cl==ar.Version2Converted){}else{if(cl==ar.Version3){}else{if(cl==ar.Version3Converted){}else{cn=cl}}}}}}}if((cl!=ar.Version2)&&(cl!=ar.Version2Converted)&&(cl!=ar.Version3)&&(cl!=ar.Version3Converted)){cz=cs.readCompressedInt();var cu;cu=cs.readCompressedInt();cy=cs.readCompressedInt();var cx=cs.readCompressedInt();var cB=cs.readFloat();var cv=cs.readFloat();if(cy==0){return null}ct=new Uint8Array(cu);cs.readBytes(cu,ct)}else{var co;co=cs.readCompressedInt();switch(co){case a8.Stream_BADCOMPRESSED:cn=cs.readCompressedInt();cz=cs.readCompressedInt();var cu;cu=cs.readCompressedInt();cy=cs.readCompressedInt();cx=cs.readCompressedInt();cB=cs.readFloat();cv=cs.readFloat();return -1;case a8.Stream_CCITTG3:cn=cs.readCompressedInt();cz=cs.readCompressedInt();var cu;cu=cs.readCompressedInt();cy=cs.readCompressedInt();cx=cs.readCompressedInt();cB=cs.readFloat();cv=cs.readFloat();if(cy==0){console.log(" BILEVEL texture format is not supported ");return null}else{return null}break;case a8.Stream_UNCOMPRESSED:cn=cs.readCompressedInt();cz=cs.readCompressedInt();var cu;cu=cs.readCompressedInt();cy=cs.readCompressedInt();cx=cs.readCompressedInt();cB=cs.readFloat();cv=cs.readFloat();if((cl==ar.Version3)||(cl==ar.Version3Converted)){if(cy==ck.RGB_S3TC_DXT1||cy==ck.RGBA_S3TC_DXT1||cy==ck.RGBA_S3TC_DXT3||cy==ck.RGBA_S3TC_DXT5){var cr=cs.readCompressedInt()}}ct=new Uint8Array(cu);cs.readBytes(cu,ct);break;case a8.Stream_PNG:cA=true;cn=cs.readCompressedInt();cz=cs.readCompressedInt();var cw=cs.readCompressedInt();cy=cs.readCompressedInt();cx=cs.readCompressedInt();cB=cs.readFloat();cv=cs.readFloat();var ct=new Uint8Array(cw);if(cw){cs.readBytes(cw,ct)}else{return null}break;case a8.Stream_JPEG:break;default:break}}return{img:ct,width:cn,height:cz,format:cy,url:cm,xPixelSize:cB,yPixelSize:cv,compression:cA}}};var k=function(){this.unstream=function(cq,cn){var cl=new bH();var cp=cl.unstream(cq,cn);if(cp===null){return null}var cm=cq.readStringWithLength();var co=cm.split("\\");var cn=co[co.length-1];cp.url=cn;return cp}};var bX=function(){this.unstream=function(cq,cm){var cl=1;var cv={mipmaps:[],width:0,height:0,format:null,mipmapCount:1,url:cm};var cs=cq.readCompressedInt();if(cs==0){var cn=cq.readCompressedInt();cv.mipmapCount=cq.readCompressedUInt();cv.width=cq.readCompressedUInt();cv.height=cq.readCompressedUInt();cv.format=cq.readCompressedInt();cv.streamCmpFormat=cn;if(0==cv.mipmapCount){cl=0}var co=cv.width;var ct=cv.height;for(var cr=1;cr<=cv.mipmapCount;cr++){var cu=new bH();var cp=cu.unstream(cq,cm);if(cv.format==3){return cp}cv.mipmaps.push({data:cp.img,width:cp.width,height:cp.height});ct/=2;if(ct<1){ct=1}co/=2;if(co<1){co=1}}}else{cl=0}return cv}};var u=function(){this.unstream=function(cK){var cx=new be.Material;var cv=cK.readCompressedInt();var cu=cK.readFloat();var cF=cK.readFloat();var cL=cK.readFloat();cx.colorAmbient[0]=cu;cx.colorAmbient[1]=cF;cx.colorAmbient[2]=cL;var ct=cK.readFloat();var cC=cK.readFloat();var cJ=cK.readFloat();cx.colorDiffuse[0]=ct;cx.colorDiffuse[1]=cC;cx.colorDiffuse[2]=cJ;var cn=cK.readFloat();var cr=cK.readFloat();var cA=cK.readFloat();cx.colorSpecular[0]=cn;cx.colorSpecular[1]=cr;cx.colorSpecular[2]=cA;cx.shininess=cK.readFloat();cx.shininess*=255;cx.ambientCoef=cK.readFloat();cx.diffuseCoef=cK.readFloat();cx.specularCoef=cK.readFloat();cx.transparent=cK.readFloat();cx.reflectivityCoef=cK.readFloat();var cI=((cK.version<2100190)&&(cK.version>=2100000))||(cK.version<1102110);var cH=cK.readUnsignedChar();if(cH){if(cI){var cp=cK.readUnsignedChar();if(cp){var co=0;co=cK.readCompressedInt();if(cK.textures.isValidMultiRefIndex(co)){var cs=cK.textures.getIndex(co);cx.textureId=cs}else{var cD=new k();var cz=cD.unstream(cK);var cG=cK.textures.add(cz);cK.textures.addMultiRefIndex(co,cG);cx.textureId=cG}}else{var cD=new k();var cz=cD.unstream(cK);var cG=cK.textures.add(cz);cx.textureId=cG}}else{var cB=cK.getContainer();var cm;if(cB){cm=cB.getResourceCGRContainer()}if(cm){var cG=cm.getResource(cK);cx.textureId=cG}}}cx.textureImageNumberComposante=cK.readCompressedInt();cx.textureBlending=cK.readCompressedInt();cx.magFilter=cK.readCompressedInt();cx.minFilter=cK.readCompressedInt();var cy=cK.readCompressedInt();switch(cy){case 0:cx.mappingFunction="USER_MAPPING";break;case 3:cx.mappingFunction="SPHERICAL_ENV_MAP";break}cx.textureWrapS=cK.readCompressedInt();cx.textureWrapT=cK.readCompressedInt();cx.addedComposantInTexEnv=cK.readCompressedInt();cK.skip(76);if(!cI){var cw=cK.readUnsignedChar();if(cw){cx.textureId=-1;var cE=cK.readCompressedInt();var cq=cE==7?true:false;var cl=new au();cl.unstream(cK);if(cl){cx.shaderMaterial={name:cl.name,param:cl.parameters,PDSFX:cq}}}}return cx}};var aC=function(){this.skip=function(cl){this.unstream(cl,true)};this.unstreamTexture=function(co){var cq=1;var cm=0;var cl=0;if(co.version>=210041930){cl=co.readCompressedInt();if(co.textures.isValidMultiRefIndex(cl)){cm=co.textures.getIndex(cl);cq=0}}if(cq){var cn=new bH();var cp=cn.unstream(co);if(cp!=null){cm=co.textures.add(cp)}if(cp&&co.version>=210041930){co.textures.addMultiRefIndex(cl,cm)}}return cm};this.unstream=function(cE,cm){var cz=-1;var cx={};if(!cm){var cl=new u();cx=cl.unstream(cE)}var cy=cE.readStringWithLength();var cw={tab:[]};cx.physicalMaterial=JSON.parse(cy);var ct=cE.readCompressedUInt();var cu=cE.readCompressedUInt();var cp=cx.physicalMaterial.Version;var co=0;if(cx.physicalMaterial&&cx.physicalMaterial.PhysicalMaterial&&cx.physicalMaterial.PhysicalMaterial.MappingOperator&&cx.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation){var cC=cx.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation;cx.physicalMaterial.PhysicalMaterial.MappingOperator.UvTransformation=[cC[0],cC[1],cC[2],cC[4],cC[5],cC[6],cC[8],cC[9],cC[10]]}if(cp&&cp>=3){co=cE.readCompressedUInt()}var cs=cE.readBoolean();var cr=false;if(cp&&cp>=0.2){cr=cE.readBoolean()}for(var cB=0;cB<ct;cB++){var cq=false;cz=-1;var cG=cE.readStringWithLength();if(cp>0){cq=cE.readBoolean()}if(cq){cz=this.unstreamTexture(cE)}else{cz=bo(cE)}if(cz>=0){var cD=cx.physicalMaterial.PhysicalMaterial.FloatParameter;var cA=cD[cG];cA.Texture=cz}}for(cB=ct;cB<(cu+ct);cB++){var cq=false;cz=-1;var cG=cE.readStringWithLength();if(cp>0){cq=cE.readBoolean()}if(cq){cz=this.unstreamTexture(cE)}else{cz=bo(cE)}if(cz>=0){var cF=cx.physicalMaterial.PhysicalMaterial.Float3Parameter;var cA=cF[cG];cA.Texture=cz}}cz=-1;var cv=null;if(cx.physicalMaterial.PhysicalMaterial&&cx.physicalMaterial.PhysicalMaterial.MapParameter){cv=cx.physicalMaterial.PhysicalMaterial.MapParameter.normalMap}if(cs){cz=bo(cE);if(cz>=0){if(cv){cv.Texture=cz}else{cx.physicalMaterial.PhysicalMaterial.NormalMap.Texture=cz}}}if(cr){bo(cE)}for(cB=0;cB<co;cB++){var cq=false;cz=-1;var cG=cE.readStringWithLength();var cn=cx.physicalMaterial.PhysicalMaterial.MapParameter[cG];if(cp>0){cq=cE.readBoolean()}if(cq){cz=this.unstreamTexture(cE)}else{cz=bo(cE)}if(cz>=0){if(cn){cn.Texture=cz}}}return cx}};var aK=function(){this.unstream=function(cB){var cv={};var cy;var cn=0;cn=cB.readCompressedInt();if(cB.materials.isValidMultiRefIndexWithName(cn,cB.name)){cy=cB.materials.getIndexWithName(cn,cB.name);cv=cB.materials[cy]}else{var cm=cB.readStringWithLength();var cC=JSON.parse(cm);if(cC.images&&cC.textures){var cz=cB.getContainer();var cl;if(cz){cl=cz.getResourceCGRContainer()}var cs=[];if(cl){for(var cA=0;cA<cC.images.length;cA++){var cG=cl.getImage(cB,cC.images[cA].byteOffset,cC.images[cA].byteOffset+cC.images[cA].byteLength);cs.push(cG)}}var cx=[];if(cC.images&&cC.images.length){for(var cA=0;cA<cC.images.length;cA++){cx.push(false)}}var cu=[];for(var cA=0;cA<cC.textures.length;cA++){var cF=false;var co=cC.textures[cA];if(cx[co.image]){cF=true}cx[co.image]=true;var cG=cs[co.image];var cE={noTranferable:cF,compression:cG.compression,format:cG.format,height:cG.height,width:cG.width,img:cG.img,wrap:[1,1],filter:[1,1]};if(co.uWrap&&co.uWrap!="REPEAT"){cE.wrap[0]=0}if(co.vWrap&&co.vWrap!="REPEAT"){cE.wrap[1]=0}if(co.magFilter){cE.filter[1]=ac[co.magFilter]}if(co.minFilter){cE.filter[0]=ac[co.minFilter]}var cp=cB.textures.add(cE);cu.push(cp)}}var cq=cC.materials[0];var cr=cv;if(cq.type=="Visu.Basic"){cv.colorDiffuse=cq.DiffuseColor;cv.diffuseCoef=cq.DiffuseCoeff;cv.colorAmbient=cq.AmbientColor;cv.ambientCoef=cq.AmbientCoeff;cv.colorSpecular=cq.SpecularColor;cv.specularCoef=cq.SpecularCoeff;cv.reflectivityCoef=cq.ReflectionCoeff;cv.textureId=cq.Texture?cu[cq.Texture.texture]:undefined;if(cv.textureId!=undefined){var cw=cB.textures.get(cv.textureId);cv.minFilter=cw.filter[0];cv.magFilter=cw.filter[1];cv.textureWrapS=cw.wrap[0];cv.textureWrapT=cw.wrap[1]}cv.shininess=cq.ShininessCoeff*255;cv.transparency=cq.TransparencyCoeff;cv.alphaTest=0.5*cq.IsAlphaTestEnabled}else{if(cq.type=="Visu.SpecularGlossiness"||cq.type=="Visu.SpecularGlossiness@17x"||cq.type=="Visu.EVisuPBR"){for(var cD in cq){var ct=cq[cD];if(ct.texture){ct.texture=cu[ct.texture]}}cv.physicalMaterial={};cv=cv.physicalMaterial;cv.PhysicalMaterial=cq;cv.PhysicalMaterial.isVisDescription=true}}var cy=cB.materials.add(cr);cB.materials.addMultiRefIndexWithName(cn,cy,cB.name)}return cr}};var bo=function(co){var cl=-1;var cp=co.getContainer();var cn;if(cp){cn=cp.getResourceCGRContainer()}var cm="";if(cn){cl=cn.getResource(co)}return cl};var au=function(){this.parameters={};this.name="";this.unstream=function(cn){this.parametersUnstream(cn);var co=cn.getContainer();var cl;if(co){cl=co.getResourceCGRContainer()}if(cl){var cm=cl.getResourceShader(cn)}if(cm===null){return null}if(cm){this.name=cm.name}};this.parametersUnstream=function(cw){var cq=cw.readCompressedInt();var cv=[];for(var cs=0;cs<cq;++cs){cv[cs]=cw.readStringWithLength()}var co=cw.readCompressedInt();for(var cs=0;cs<co;++cs){var cx=cw.readCompressedInt();switch(cx){case 0:var cp=cw.readCompressedInt();break;case 1:var cp=cw.readCompressedInt();var cy=cw.readFloat();var cn=cv[cs];this.parameters[cn]=cy;break;case 2:var cp=cw.readCompressedInt();var cr=[];cw.readFloatArray(0,4,cr);var cn=cv[cs];this.parameters[cn]=cr;break;case 4:var cp=cw.readCompressedInt();var cu=cw.getContainer();var ct;if(cu){ct=cu.getResourceCGRContainer()}var cm="";if(ct){var cl=ct.getResource(cw);if(ad[cl]){if(ad[cl].url){cm=ad[cl].url}}}var cn=cv[cs];this.parameters[cn]={imgId:cl,url:cm};break;case 5:var cp=cw.readCompressedInt();var cr=[];cw.readFloatArray(0,4,cr);var cn=cv[cs];this.parameters[cn]=cr;break;case 6:var cp=cw.readCompressedInt();var cr=[];cw.readFloatArray(0,4,cr);var cn=cv[cs];this.parameters[cn]=cr;break}}}};var x=function(){this.name="";this.unstream=function(cn){var cl=cn.readStringWithLength();var co=cl.lastIndexOf("\\");if(co!==-1){cl=cl.substring(co+1,cl.length)}co=cl.lastIndexOf(".");if(co!==-1){cl=cl.substring(0,co)}var cm=cn.readCompressedInt();cn.skip(cm);this.name=cl}};var av=function(){this.unstream=function(cs){var cu=[];for(var co=0;co<2;co++){var cr=cs.readUnsignedChar();if(cr){var cl=cs.readUnsignedChar();var cm=0;if(cl){cm=cs.readCompressedInt();if(cs.materials.isValidMultiRefIndexWithName(cm,cs.name)){cu[co]=cs.materials.getIndexWithName(cm,cs.name)}else{var cn=null;var ct=cs.readCompressedInt();if(ct===1){cn=new av()}else{cn=new u()}var cq=cn.unstream(cs);if(ct===1){cp=cq}else{var cp=cs.materials.add(cq)}cs.materials.addMultiRefIndexWithName(cm,cp,cs.name);cu[co]=cp}}else{var cn=null;var ct=cs.readCompressedInt();if(ct===1){cn=new av()}else{cn=new u()}var cq=cn.unstream(cs);var cp;if(ct===1){cp=cq}else{cp=cs.materials.add(cq)}cu[co]=cp}}}return cu[0]}};var l=function(){this.posBuffer=[];this.normalBuffer=[];this.textureBuffer=[];this.uvsBuffer=[];this.binormalsBuffer=[];this.tangentsBuffer=[];this.numberOfVertices=0};l.prototype.getNumberOfVertices=function(){return this.numberOfVertices};l.prototype.unstream=function(cs){var cw,cv,cr,cu,cl,cm;this.numberOfVertices=cs.readCompressedInt();cw=cs.readCompressedInt();this.hasTextures=cs.readUnsignedChar();this.hasUVs=cs.readUnsignedChar();this.hasTangentsBinormals=cs.readUnsignedChar();var cr=0;if(this.hasTextures){cr=cs.readUnsignedChar();cs.readTextures(0,this.numberOfVertices,cr,this.textureBuffer)}if(this.numberOfVertices){cs.readPositions(0,this.numberOfVertices,this.posBuffer,0)}if(cw){cs.readNormals(0,cw,this.normalBuffer,0)}if(this.hasUVs&&this.numberOfVertices){this.uvsBuffer=new Float32Array(this.numberOfVertices*2);cs.readFloatArray(0,this.numberOfVertices*2,this.uvsBuffer)}if(this.hasTangentsBinormals){cs.readFloatArray(0,this.numberOfVertices*3,this.tangentsBuffer);cs.readFloatArray(0,this.numberOfVertices*3,this.binormalsBuffer)}if(cs.version>=210041920){var ct=cs.readUnsignedChar();if(ct){var cq=cs.readCompressedInt();if(cq>0){for(var co=0;co<cq;++co){var cn=cs.readUnsignedChar();var cp=cs.readStringWithLength();cs.skip(4*cn*this.numberOfVertices)}}}}};l.prototype.allocateBuffers=function(){this.posBuffer=new Array(this.numberOfVertices*3);if(this.totalNumberOfNormals){this.normalBuffer=new Array(this.totalNumberOfNormals*3)}if(this.hasTextures){this.textureBuffer=new Array(this.numberOfVertices*3)}if(this.hasUVs){this.uvsBuffer=new Array(this.numberOfVertices*2)}if(this.hasTangentsBinormals){this.tangentsBuffer=new Array(this.numberOfVertices*3);this.binormalsBuffer=new Array(this.numberOfVertices*3)}};var aY=function(){l.call(this);this.totalNumberOfNormals=0;this.nbTexCoords=0;this.hasTextures=false;this.hasUVs=false;this.hasTangentsBinormals=false};aY.prototype=new l;aY.prototype.constructor=aY;aY.prototype.partUnStreamHeader=function(cn){this.numberOfVertices=cn.readCompressedInt();this.totalNumberOfNormals=cn.readCompressedInt();var cp=cn.readUnsignedChar();this.hasTextures=cp&1;this.hasUVs=cp&2;this.hasTangentsBinormals=cp&4;this.hasExtraTextures=cp&16;if(this.hasTextures){this.nbTexCoords=cn.readUnsignedChar()}if(this.hasExtraTextures){this.nbExtraTextureSet=cn.readCompressedInt();this.extraTextureSet=[];for(var cm=0;cm<this.nbExtraTextureSet;++cm){var co=cn.readUnsignedChar();var cl=cn.readStringWithLength();this.extraTextureSet.push({dimension:co,identifier:cl})}}this.allocateBuffers()};aY.prototype.partUnStream=function(cp,cn,cl,co,cq){if(co){cp.readPositions(cn,co,this.posBuffer)}if(this.totalNumberOfNormals){cp.readNormals(cl,cq,this.normalBuffer)}if(this.hasTextures){cp.readTextures(cn,co,this.nbTexCoords,this.textureBuffer)}if(this.hasUVs&&this.numberOfVertices){cp.readFloatArray(2*cn,2*co,this.uvsBuffer)}if(this.hasTangentsBinormals){cp.readFloatArray(3*cn,3*co,this.tangentsBuffer);cp.readFloatArray(3*cn,3*co,this.binormalsBuffer)}if((this.nbExtraTextureSet>0)&&cp.version>=210041920){for(var cm=0;cm<this.nbExtraTextureSet;++cm){var cr=this.extraTextureSet[cm].dimension;cp.skip(4*cr*co)}}};var cd=function(){this.geomType=0;this.nbPrimitives=0;this.primitives=[];this.attribute=null;this.material={file:"",id:-1}};cd.prototype.unstreamPrimSet=function(co){this.geomType=b5[co.readCompressedInt()];this.nbPrimitives=co.readCompressedInt();this.primitives=new Array(this.nbPrimitives);for(var cn=0;cn<this.nbPrimitives;++cn){var cm=co.readUnsignedChar();var cl=null;switch(cm){case 1:cl=new Y();break;case 2:cl=new J();break;case 3:cl=new bb();break;case 4:console.log("primitive type not handled..");break;case 5:cl=new bP();break;case 6:cl=new at();break;default:console.log("primitive type not handled..");break}if(cl){cl.unstream(co);this.primitives[cn]=cl}}};var n=function(){cd.call(this)};n.prototype=Object.create(cd.prototype);n.prototype.constructor=n;n.prototype.unstream=function(cs){this.unstreamPrimSet(cs);for(var cn=0;cn<this.primitives.length;++cn){var cq=cs.readGraphicAttributeSet();var co=cs.pushGAS(cq,0);var cl=co.getDisplayedColor();var ct=co.getType();var cr=co.isSolid();var cm=co.isNoZ();var cu=1;var cp=be.LinePatternEnum.SOLID;if(this.geomType=="WIRE_EDGE"){cu=co.getLineThickness();cp=co.getLinetype()}if(cm){this.noZ=true}var cq={fill:new be.FillAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),cr),line:new be.LineAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),cu,cp),point:new be.PointAttributes()};if(this.primitives[cn].symbol){cq.point=new be.PointAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),co.getLineThickness(),this.primitives[cn].symbol)}this.primitives[cn].gas=cq;cs.popGAS()}};var aD=function(){cd.call(this)};aD.prototype=Object.create(cd.prototype);aD.prototype.constructor=aD;aD.prototype.unstream=function(ct){this.unstreamPrimSet(ct);var cr=ct.readGraphicAttributeSet();var cp=ct.pushGAS(cr,0);var cl=cp.getDisplayedColor();var cu=cp.getType();var cs=cp.isSolid();var cm=cp.isNoZ();var cv=1;var cq=be.LinePatternEnum.SOLID;if(cm){this.noZ=true}if(this.geomType=="WIRE_EDGE"){cv=cp.getLineThickness();cq=cp.getLinetype()}var cr={fill:new be.FillAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),cs),line:new be.LineAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),1,be.LinePatternEnum.SOLID),point:new be.PointAttributes()};for(var cn=0;cn<this.primitives.length;++cn){if(this.primitives[cn].symbol){var co={fill:cr.fill,line:cr.line,point:new be.PointAttributes(new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255),cp.getLineThickness(),this.primitives[cn].symbol)};this.primitives[cn].gas=co;continue}this.primitives[cn].gas=cr}ct.popGAS()};var aJ=function(){cd.call(this)};aJ.prototype=Object.create(cd.prototype);aJ.prototype.constructor=aJ;aJ.prototype.unstream=function(cD){n.prototype.unstream.call(this,cD);var cl=0;var cn=[];var cE=this.primitives.length;for(var cB=0;cB<cE;cB++){cn[cB]=[]}if(cD.version>=210041800){cl=cD.readCompressedUInt()}if(cl>0){var cu=cD.readUnsignedChar();if(cu){for(var cB=0;cB<cl;cB++){var cy=cD.readUnsignedChar();if(cy){var co={material:null,inheritanceMaterial:null,layer:null};var cq=cD.readStringWithLength();var cC=cD.readCompressedUInt();for(var cA=0;cA<cC;cA++){var cs=cD.readCompressedUInt();cn[cs].push(co)}var cw=cD.readCompressedUInt();if(cw>0){for(var cA=0;cA<cw;cA++){var cv=this.materialApplicationUnstream(cD,aw.STREAM_ALL_UINT);if(cA==(cw-1)){cv.material.primWithMaterials=true;co.material=cv.material;co.inheritanceMaterial=cv.inheritanceMaterial;co.layer=cv.layer}}}}}for(var cB=0;cB<cE;cB++){var cz=this.primitives[cB];var ct=cn[cB];for(var cA=0;cA<ct.length;cA++){cD.pushMatId(ct[cA].material,ct[cA].inheritanceMaterial,ct[cA].layer)}cz.material=cD.getCurrentMatId();if(cz.material){cz.material.primWithMaterials=true}for(var cA=0;cA<ct.length;cA++){cD.popMatId()}}var cp=(cD.version==210041800)?aw.STREAM_ALL_UINT:aw.STREAM_ALL_ULONG;var cr=cD.readCompressedUInt();for(var cB=0;cB<cr;++cB){var cs=cD.readUncompressedInt();var cw=cD.readCompressedUInt();if(cw>0){for(var cA=0;cA<cw;++cA){var cv=this.materialApplicationUnstream(cD,aw.streamSettings);if(cw==0){cD.pushMatId(cv.material,cv.inheritanceMaterial,cv.layer);cx=cD.getCurrentMatId();cD.popMatId()}}}}}}else{cE=this.primitives.length;for(var cB=0;cB<cE;cB++){var cm=cD.readUnsignedChar();if(cm){var cv=this.materialApplicationUnstream(cD,aw.STREAM_MATERIAL);var cx=cv.material;cx.primWithMaterials=true;this.primitives[cB].material=cx}}}};aJ.prototype.unstreamMaterial=function(cu){var ct={file:"",id:-1};var cv=0;var cm=cu.readUnsignedChar();var cn=0;var cs=null;var cq=null;if(cm){cn=cu.readCompressedInt();if(cu.materials.isValidMultiRefIndexWithName(cn,cu.name)){ct={file:"",id:cu.materials.getIndexWithName(cn,cu.name)};return ct}}if(cu.version>=210021320){var cw=cu.readCompressedInt();if(cw===1){cq=new av()}else{if(cw===4){cq=new aC()}else{if(cw===9&&cu.version>=210042100){cq=new aK()}else{cq=new u()}}}}else{cq=new u()}cs=cq.unstream(cu);var cl=cu.getCurrentPosition();var co=cu.getBytesRemain();if(co>32){co=32}var cp=cu.readString(co);cu.setCurrentPosition(cl);if(cp.indexOf('{\n"Version" : ')!==-1){fakeUnstreamer=new aC();fakeUnstreamer.skip(cu)}if(cw===1){var cr=cs}else{var cr=cu.materials.add(cs)}ct={file:"",id:cr};if(cm){cu.materials.addMultiRefIndexWithName(cn,cr,cu.name)}return ct};aJ.prototype.materialApplicationUnstream=function(cp,cm){var cl={material:null,inheritanceMaterial:1,layer:0};if(cm&aw.STREAM_MATERIAL){cl.material=this.unstreamMaterial(cp)}if(cp.version>=1100500){if(cm&aw.STREAM_INHERIT_INT){cl.inheritanceMaterial=cp.readCompressedInt()}else{if(cm&aw.STREAM_INHERIT_UINT){cl.inheritanceMaterial=cp.readCompressedInt()}else{if(cm&aw.STREAM_INHERIT_ULONG){cl.inheritanceMaterial=cp.readUncompressedInt()}}}}else{if(cm&(aw.STREAM_INHERIT_INT|aw.STREAM_INHERIT_UINT|aw.STREAM_INHERIT_ULONG)){cl.inheritanceMaterial=1}}if(cm&aw.STREAM_LAYER_INT){cl.layer=cp.readUncompressedInt()}else{if(cm&aw.STREAM_LAYER_UINT){cl.layer=cp.readCompressedInt()}else{if(cm&aw.STREAM_LAYER_ULONG){cl.layer=cp.readUncompressedUInt()}}}if(cm&aw.STREAM_UVTRANSFO){var cr=false;if(cp.version>=210041900){var cr=cp.readBoolean();if(cr){cp.readFloat();cp.readFloat();cp.readFloat();cp.readFloat()}}}if(cm&aw.STREAM_MAPPING_INFO){if(cp.version>=210042100){var cs=cp.readBoolean();if(!cs){var cn=cp.readStringWithLength();cn=JSON.parse(cn);cn=cn.mappings[cn.uvSlots.Default];cl.mapping={type:0,ObjectTransformation:null,UvTransformation:null};if(cn.uvTransform){cl.mapping.UvTransformation=cp.createMatrix3(cn.uvTransform)}if(cn.operator){var co=cn.operator.type;if(co=="PLANAR"){cl.mapping.type=1}else{if(co=="SPHERICAL"){cl.mapping.type=2}else{if(co=="SPHERICAL_NORMALIZED"){cl.mapping.type=3}else{if(co=="CUBIC"){cl.mapping.type=4}else{if(co=="CYLINDRICAL"||co=="FINITE_CYLINDRICAL"){cl.mapping.type=5}else{if(co=="INFINITE_CYLINDRICAL"){cl.mapping.type=6}else{if(co=="INFINITE_CYLINDRICAL_NORMALIZED"){cl.mapping.type=7}}}}}}}if(cn.operator.transform){var cq=cn.operator.transform;cl.mapping.ObjectTransformation=cq}}}}}return cl};var b2=function(){};b2.prototype.skip=function(cm,cn){var cl=cm.readCompressedInt();if(cl<0){cl=-cl-2}cm.skip(cl-4)};b2.prototype.unstream=function(cx,cn){var cs=new e();var cA=cx.readCompressedInt();if(cA<0){cA=-cA-2}var co=cx.getCurrentPosition()+cA-4;cs.rep.unstream(cx);cx.setNumberOfVertices(16777216);var cr=cx.readCompressedInt();if(cr<=0){cx.popMatId();cx.popGAS();return null}var cm;var cp;for(var cz=0;cz<cr;cz++){cm=cx.readUnsignedChar();cp=null;switch(cm){case bR.FACE3:cp=new a3();break;case bR.PLANARFACE3:cp=new a3();break;case bR.LINE3:cp=new K();break;case bR.POLYLINE3:cp=new K();break;case bR.MARKER3:cp=new ch();break;case bR.FIXEDARROW:cp=new L();break;case bR.FIXEDPLAN:cp=new aA();break;case bR.CYLINDER:cp=new br();break;case bR.CURVEDPIPE:cp=new a5();break;case bR.ANNOTEXT3:cp=new I();break;case bR.ARROW3:cp=new R();break;case bR.ARCELLIPSE3:cp=new E();break;case bR.ARCCIRCLE3:cp=new c();break;case bR.IMAGEPIXEL3:cp=new aS();break;case bR.UNDEFINED:break;default:return}if(cp!==null){cp.unstream(cx);var cy=cx.readGraphicAttributeSet();var ct=cx.pushGAS(cy,0);var cl=ct.getDisplayedColor();var cw=cs.rep.repGAS.getType();var cu=0;if(cw===3){cu=1}var cq=new be.Color(cl[0]/255,cl[1]/255,cl[2]/255,cl[3]/255);var cv={fill:new be.FillAttributes(cq,cu),line:new be.LineAttributes(cq,ct.getLineThickness(),ct.getLinetype()),point:new be.PointAttributes()};if(cp.primitive&&cp.primitive.symbol){cv.point.symbol=cp.primitive.symbol;cv.point.color=cq}cs.addGP(cp,cv,cx,cn);cx.popGAS()}else{cx.readGraphicAttributeSet()}}cs.checkGP(cx,cn);cs.addMesh(cx);return cs.rep};var bJ=function(){};bJ.prototype.unstream=function(cB){var cp=new b6();var ct=cB.readCompressedInt();if(ct<0){ct=-ct-2}cp.rep.unstream(cB);var cC=cB.readCompressedInt();var co=new be.PrimitiveGroup();co.fillAttr=new be.FillAttributes();co.lineAttr=new be.LineAttributes();co.pointAttr=new be.PointAttributes();var cv=[0];var cx;for(var cz=0;cz<cC;++cz){var cs=null;var cu=cB.readUnsignedChar();cx=null;switch(cu){case 121:cx=new bm();break;case 128:cx=new bF();break;case 129:cx=new b4();break;case 130:cx=new bY();break;case 131:cx=new bB();break;case 132:cx=new aP();break;case 135:cx=new bG();break;case 136:cx=new a1();break;case 164:cx=new r();break;case 165:cx=new bV();break;case 166:cx=new y();break;case 167:cx=new bj();break;case 168:cx=new aZ();break;case 169:cx=new aq();break;case 105:cx=new N();break;default:break}if(cx){var cr=cx.unstream(cB);var cn=cB.readGraphicAttributeSet();var cq=cB.pushGAS(cn,0);var cm=cq.getDisplayedColor();var cl=cp.rep.repGAS.getType();var cA=0;if(cl===3){cA=1}var cy=new be.Color(cm[0]/255,cm[1]/255,cm[2]/255,cm[3]/255);var cw={fill:new be.FillAttributes(cy,cA,true),line:new be.LineAttributes(cy,cq.getLineThickness(),cq.getLinetype()),point:new be.PointAttributes()};if(cx.primitive&&cx.primitive.symbol){cw.point.symbol=cx.primitive.symbol;cw.point.color=cy}if(h&&cx instanceof N){cx.text.color=cy;cB.texts.add(cx.text)}if(cr){cp.addGP(cx,cw)}cB.popGAS()}}cp.addMesh(cB);return cp.rep};var G=function(){};G.prototype.unstreamRep=function(cP,cM){if(!cM){cM=new P()}var cH=cP.readCompressedInt();var co=null;var cN=false;cM.rep.unstream(cP);if(cP.version>=2100000){var cI=0;var cq=cP.readUnsignedChar();if(cq){cM.vertexBuffer=new aY();cM.vertexBuffer.partUnStreamHeader(cP);cI=cM.vertexBuffer.getNumberOfVertices()}var cF=0;cM.nbLODFaces=cP.readUnsignedChar();var cB=0;if(cM.nbLODFaces){var cB=new Float32Array(cM.nbLODFaces+1);cP.readFloatArray(0,cM.nbLODFaces+1,cB)}else{if(cP.version>210041930){cB=cP.readDouble()}else{cB=cP.readFloat()}}if(aM){cM.rep.node.sag=cB}if(cP.version>=210021620){var cO=cP.readDouble()}cP.setNumberOfVertices(cI);var cm=0;cM.posInNextStreamer=cP.readCompressedInt();var cn=0;var cz=0;var cK=0;var cl=[];var cx=0;var cp=0;while(cm<=w.LSG){if(cM.nbLODFaces==0&&(cm==w.LOD1||cm==w.LOD2||cm==w.LOD3||cm==w.FACES)){cm++;continue}if(cM.nbLODFaces==0&&cm==w.LOD0){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("LOD0");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);ct.setNumberOfVertices(cM.vertexBuffer.getNumberOfVertices())}cM.unStreamFaces(ct);if(cM.sets[0]){if(cM.sets[0].noZ){cN=true}}}}else{if(cm==w.LOD0){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("LOD0");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);cx+=cy;cp+=cA}}}}if(cm==w.LOD1){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("LOD1");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);cx+=cy;cp+=cA}}}if(cm==w.LOD2){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("LOD2");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);cx+=cy;cp+=cA}}}if(cm==w.LOD3){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("LOD3");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);cx+=cy;cp+=cA}}}if(cm==w.FACES){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var ct=cD.getStreamerByName("FACES");cP.copyStreamerInheritance(ct);if(ct){ct.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=ct.readCompressedInt();if(cq){var cy=ct.readCompressedInt();var cA=ct.readCompressedInt();ct.setNumberOfVertices(cx+cy);cM.vertexBuffer.partUnStream(ct,cx,cp,cy,cA);cx+=cy;cp+=cA}else{ct.setNumberOfVertices(0)}cM.unStreamFaces(ct);if(cM.sets[0]){if(cM.sets[0].noZ){cN=true}}}}if(cm==w.LSG){var cD=cP.getContainer();if(!cD){cP.error=" container not found";return false}var cw=cD.getStreamerByName("LSG");if(cw){cP.copyStreamerInheritance(cw);cw.setNumberOfVertices(cI);if(cq){cw.setNumberOfVertices(cI)}else{cw.setNumberOfVertices(0)}cw.setCurrentPosition(cM.posInNextStreamer);cM.posInNextStreamer=cw.readCompressedInt();var cv=cM.sets.length;var cu=cw.readUnsignedChar();cM.nbSets=cu+cv;for(var cL=0;cL<cu;++cL){var cs=cw.readUnsignedChar();switch(cs){case 1:cM.sets[cL+cv]=new aD();break;case 2:cM.sets[cL+cv]=new n();break;default:cM.sets[cL+cv]=null;return}if(cM.sets[cL+cv]){cM.sets[cL+cv].unstream(cw);if(cM.sets[cL+cv].noZ){cN=true;var cG=cP.popGAS();cG.inherited.setType(0);cP.pushGAS(cG.inherited,cG.inh_mode)}}}}}cm++}if(!cN){var cC=cP.getGAS();var cs=cC.getType();if(cs==0){var cG=cP.popGAS();cG.inherited.setType(2);cP.pushGAS(cG.inherited,cG.inh_mode)}}}else{var cl=[];var cq=cP.readUnsignedChar();if(cq){cM.vertexBuffer=new aY();cM.vertexBuffer.unstream(cP);cP.setNumberOfVertices(cM.vertexBuffer.getNumberOfVertices())}var cB=0;cB=cP.readFloat();cM.nbLODFaces=cP.readUnsignedChar();if(aM){cM.rep.node.sag=cB}for(var cL=0;cL<cM.nbLODFaces;++cL){var cs=cP.readUnsignedChar();var cr=[];var cE;switch(cs){case 1:cE=new Y();break;case 4:cE=new aB();break}if(cE){cr.push(cE.unstream(cP))}cP.readFloat();cP.readUncompressedInt();var cJ=cP.readUncompressedInt()}cM.nbSets=cP.readUnsignedChar();for(var cL=0;cL<cM.nbSets;++cL){var cs=cP.readUnsignedChar();switch(cs){case 1:cM.sets[cL]=new aD();break;case 2:cM.sets[cL]=new n();break;default:cM.sets[cL]=null;return}if(cM.sets[cL]){cM.sets[cL].unstream(cP);if(cM.sets[cL].noZ){cN=true;var cG=cP.popGAS();cG.inherited.setType(0);cP.pushGAS(cG.inherited,cG.inh_mode)}}}if(!cN){var cC=cP.getGAS();var cs=cC.getType();if(cs==0){var cG=cP.popGAS();cG.inherited.setType(2);cP.pushGAS(cG.inherited,cG.inh_mode)}}}return cM};var ax=function(){this.repPosInStreamer=0};ax.prototype=Object.create(G.prototype);ax.prototype.constructor=ax;ax.prototype.unstream=function(co){var cq=new P();var cl=this.unstreamRep(co,cq);if(!cq.posInNextStreamer){cq.posInNextStreamer=0}if(co.version<2100000){cq.posInNextStreamer=co.readCompressedInt()}if(U&&!h){if(!cl){return false}var cn=co.getContainer();var cm=cn?cn.getStreamerByName("SurfacicReps"):co;if(cn){cm.setCurrentPosition(cq.posInNextStreamer)}co.copyStreamerInheritance(cm);var cp=new a6();if(cm){cp.unstreamRep(cm,cq)}else{if(cm.cgrContainer){return}else{cp.unstream(cm,cq)}}}if(!cl){return false}cq.addMesh(co);return cq.rep};var a6=function(){};a6.prototype.unStreamEdgeIndex=function(cn){var cm=cn.readCompressedInt();var cl=cn.readCompressedInt()};a6.prototype.unstreamRep=function(cQ,cm){if(cQ.version<1101410){return}if(!cm){return}cQ.setLightDataStreaming(false);var cA=cQ.readCompressedInt();var cO=cQ.readFloat();var cw=cQ.readFloat();if(cQ.version>=210041720){var cx=cQ.readUnsignedChar();if(cx&128){cQ.skip(4)}}var cq=cm.getSet("FACE");var cr=cm.getSet("EDGE");var cI=cq.length;var cL=cr.length;var cR=cm.nbLODFaces;var cP=cQ.readCompressedInt();var cH=[];var cz=new a3();if(cI){for(var cM=0;cM<cI;cM++){var cF=cq[cM];cz.unstream(cQ);cF.cgmId=cz.node.cgmId;cF.decoration=cz.decoration;cF.boundingSphere=cz.boundingSphere}}for(var cM=0;cM<cR;cM++){cz.unstream(cQ)}var cu=new ah();if(cL&&cr){for(cM=0;cM<cL;cM++){var ct=cr[cM];cu.unstream(cQ);ct.cgmId=cu.node.cgmId;ct.decoration=cu.decoration;this.unStreamEdgeIndex(cQ)}}for(var cM=0;cM<cP;cM++){var cp=cQ.readCompressedInt();var co=cQ.readUncompressedInt();var cl=cQ.readUncompressedInt();if(cQ.version>=1101710){cQ.setLightDataStreaming(true)}if(cp){var cK=new K();for(var cJ=0;cJ<cp;cJ++){cK.skip(cQ)}}if(cQ.version>=1101710){cQ.setLightDataStreaming(false)}}var cn=null;var cv=cm.nbSets;var cs=new ah();var cB=new ch();for(var cy=0;cy<cv;++cy){var cD=cm.sets[cy];var cN=cD.primitives;for(var cJ=0;cJ<cN.length;cJ++){var cC=cN[cJ];if((cD.geomType=="FACE")||(cD.geomType=="EDGE")){continue}var cG=null;var cE=cQ.readUnsignedChar();switch(cE){case 80:cG=new a3();break;case 81:cG=new a3();break;case 82:cG=new K();break;case 84:cG=cB;break;case 96:cG=cs;break;case 162:cG=new aQ();break;case 134:cG=new bA();break;case 86:cG=new aA();break;case 187:cG=new ae();break;default:return}if(cG){cG.unstream(cQ);cC.cgmId=cG.node.cgmId;cC.decoration=cG.decoration;cC.boundingSphere=cG.boundingSphere}if((cE==96)||(cE==162)){this.unStreamEdgeIndex(cQ)}}}cQ.setLightDataStreaming(true)};var a9=function(){};a9.prototype.unstream=function(cJ){var cz=new bz();var cx=cJ.readCompressedInt();var cG=false;cz.nbIndicesTotal=0;cz.vertexBuffer=new l();var cD=null;var cm=null;cz.rep.unstream(cJ);var cs=cJ.readFloat();if(aM){cz.rep.node.sag=cs}var cF=cJ.readFloat();var co=cJ.readFloat();if(cJ.version>=210041740){var cp=cJ.readUnsignedChar();if(cp&128){cJ.skip(8)}}var cv=null;cz.nbElEdge=cJ.readCompressedInt();if(cz.nbElEdge){for(var cE=(cz.nbElEdge-1);cE>=0;cE--){cD=new K();cD.primitive.indices=cz.indexBuffer;cD.vertexBuffer=cz.vertexBuffer;cD.unstream(cJ);cD.primitive.cgmId=cD.node.cgmId;if(cD.decoration){cD.primitive.decoration=cD.decoration}cz.nbIndicesTotal+=cD.primitive.count;var cw=cJ.readGraphicAttributeSet();var ct=cJ.pushGAS(cw,0);var cn=ct.getDisplayedColor();cJ.popGAS();if(ct.isNoZ()){cG=true;var cy=cJ.popGAS();cy.inherited.setType(0);cJ.pushGAS(cy.inherited,cy.inh_mode)}var cA={fill:new be.FillAttributes(new be.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255)),line:new be.LineAttributes(new be.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),ct.getLineThickness(),ct.getLinetype()),point:new be.PointAttributes()};cD.primitive.attr=cA;var cq=cz.edgePrimitivesSets.length;for(var cC=0;cC<cq;cC++){var cI=cz.edgePrimitivesSets[cC];if(be.isEqualGAS(cI.attr,cD.primitive.attr)){cI.set.push(cD.primitive);cI.nbIndices+=cD.primitive.count;break}}if(cC==cz.edgePrimitivesSets.length){var cr={};cr.attr=cD.primitive.attr;cr.nbIndices=cD.primitive.count;cr.set=[];cr.set.push(cD.primitive);cz.edgePrimitivesSets.push(cr)}}}cz.nbElPoints=cJ.readCompressedInt();if(cz.nbElPoints){for(var cE=(cz.nbElPoints-1);cE>=0;cE--){var cm=new ch();cm.vertexBuffer=cz.vertexBuffer;cm.primitive.indices=cz.indexBuffer;cm.unstream(cJ);cm.primitive.cgmId=cm.node.cgmId;if(cm.decoration){cm.primitive.decoration=cm.decoration}cz.nbIndicesTotal+=cm.primitive.count;var cq=cz.pointPrimimitivesSets.length;for(cC=0;cC<cq;cC++){var cH=cz.pointPrimimitivesSets[cC];if(cH.symbol==cm.primitive.symbol){cH.set.push(cm.primitive);cH.nbIndices+=cm.primitive.count;break}}if(cC==cz.pointPrimimitivesSets.length){var cr={};cr.symbol=cm.primitive.symbol;cr.nbIndices=cm.primitive.count;cr.set=[];cr.set.push(cm.primitive);cz.pointPrimimitivesSets.push(cr)}}var cw=cJ.readGraphicAttributeSet();var ct=cJ.pushGAS(cw,0);var cn=ct.getDisplayedColor();cJ.popGAS();if(ct.isNoZ()){cG=true;var cy=cJ.popGAS();cy.inherited.setType(0);cJ.pushGAS(cy.inherited,cy.inh_mode)}var cA={fill:new be.FillAttributes(new be.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255)),line:new be.LineAttributes(new be.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255),ct.getLineThickness(),ct.getLinetype()),point:new be.PointAttributes(new be.Color(cn[0]/255,cn[1]/255,cn[2]/255,cn[3]/255))};for(var cE=0;cE<cz.pointPrimimitivesSets.length;cE++){var cr=cz.pointPrimimitivesSets[cE];if(cr.symbol!=cA.point.symbol){var cu=cA.point.clone();cu.symbol=cr.symbol;var cB={fill:cA.fill,line:cA.line,point:cu};cr.attr=cB}else{cr.attr=cA}}}if(!cG){var ct=cJ.getGAS();var cl=ct.getType();if(cl==0){var cy=cJ.popGAS();cy.inherited.setType(2);cJ.pushGAS(cy.inherited,cy.inh_mode)}}cz.addMesh(cJ);return cz.rep};var bi=function(){};bi.prototype=Object.create(G.prototype);bi.prototype.constructor=bi;bi.prototype.unstream=function(cr){var cm=new am();var co=cr.readCompressedInt();cm.rep.unstream(cr);cm.vertexBuffer=new l();cm.nbLODFaces=cr.readCompressedInt();if(cm.nbLODFaces>0){var cq=[];for(var cn=1;cn<=cm.nbLODFaces;++cn){cq.push(cr.readFloat())}var cl=new br();cl.unstream(cr,cm.vertexBuffer);cm.sets.push(cl);for(var cn=1;cn<=cm.nbLODFaces-2;cn++){var cs=new br();cs.skip(cr)}var cp=new K();cp.skip(cr)}cm.addMesh(cr);return cm.rep};var cc=function(){};cc.prototype=Object.create(G.prototype);cc.prototype.constructor=cc;cc.prototype.unstream=function(co){var cp=new Z();var cn=co.readCompressedInt();cp.rep.unstream(co);var cs=new aA();cs.unstream(co);var cq=co.getGAS();var cr=cq.getDisplayedColor();var cm=[cr[0]/255,cr[1]/255,cr[2]/255,cr[3]/255];var cl=cs.primitive;cp.refPlane.push({rep:cp.rep.node,origin:cl.origin,xAxis:cl.direction1,yAxis:cl.direction2,color:cm,length:cl.length,mode:cl.mode});cp.addMesh(co);return null};var bC=function(){};bC.prototype=Object.create(G.prototype);bC.prototype.constructor=bC;bC.prototype.unstream=function(cr){var cp=new al();var cn=cr.readCompressedInt();cp.rep.unstream(cr);cp.vertexBuffer=new l();cp.nbLODFaces=cr.readCompressedInt();if(cp.nbLODFaces>0){var cq=[];for(var cm=1;cm<=cp.nbLODFaces;++cm){cq.push(cr.readFloat())}var cl=new a5();cl.unstream(cr,cp.vertexBuffer);cp.sets.push(cl);for(var cm=1;cm<=cp.nbLODFaces-2;cm++){var cs=new a5();cs.skip(cr)}var co=new K();co.skip(cr)}cp.addMesh(cr);return cp.rep};var aR=function(){};aR.prototype=Object.create(G.prototype);aR.prototype.constructor=aR;aR.prototype.unstream=function(co){var cp=new bD();var cm=co.readCompressedInt();cp.rep.unstream(co);cp.vertexBuffer=new l();var cn=co.readUnsignedChar();if(cn>0){var cl=new bm();cl.unstream(co);cp.gp=cl}cp.addMesh(co);return cp.rep};var ab=function(){};ab.prototype=Object.create(G.prototype);ab.prototype.constructor=ab;ab.prototype.unstream=function(cn){var co=new bp();var cm=cn.readCompressedInt();co.rep.unstream(cn);co.vertexBuffer=new l();var cl=new b4();cl.unstream(cn);co.gp=cl;co.addMesh(cn);return co.rep};var bf=function(){};bf.prototype=Object.create(G.prototype);bf.prototype.constructor=bf;bf.prototype.unstream=function(cn){var co=new cj();var cm=cn.readCompressedInt();co.rep.unstream(cn);co.vertexBuffer=new l();var cl=new K();cl.unstream(cn);co.gp=cl;co.addMesh(cn);return co.rep};var bk=function(){};bk.prototype=Object.create(G.prototype);bk.prototype.constructor=bk;bk.prototype.getAxisSystemInfo=function(cn){var cm=cn.getCurrentPosition();b2.prototype.skip.call(this,cn);var cl;var cp=0;if(cn.version>=210042110){cl=cn.readFloat();cp=cn.readCompressedInt()}else{cl=cn.readCompressedInt()}var co=cn.readCompressedInt();cn.setCurrentPosition(cm);return{isMonoPlane:co,mode:cp,axisLength:cl}};bk.prototype.unstream=function(cn){var cm=cn.readCompressedInt();var cq=this.getAxisSystemInfo(cn);b2.prototype.unstream.call(this,cn,cq);var cl;if(cn.version>=210042110){cl=cn.readFloat();var cp=cn.readCompressedInt()}else{cl=cn.readCompressedInt()}var co=cn.readCompressedInt();return null};var bu=function(){};bu.prototype=Object.create(G.prototype);bu.prototype.constructor=bu;bu.prototype.unstream=function(cp){var cn=new aa();var cm=cp.readCompressedInt();cn.rep.unstream(cp);cn.vertexBuffer=new l();var co=cp.readUnsignedChar();if(co>0){var cl=new bF();cl.unstream(cp);cn.gp=cl}cn.addMesh(cp);return cn.rep};var a0=function(){};a0.prototype=Object.create(G.prototype);a0.prototype.constructor=a0;a0.prototype.unstream=function(co){var cn=new T();var cm=co.readCompressedInt();cn.rep.unstream(co);cn.vertexBuffer=new l();var cl=new bG();cl.unstream(co);cn.gp=cl;cn.addMesh(co);return cn.rep};var ai=function(){};ai.prototype=Object.create(G.prototype);ai.prototype.constructor=ai;ai.prototype.unstream=function(cp){var cq=new bK();var co=cp.readCompressedInt();cq.rep.unstream(cp);cq.vertexBuffer=new l();cq.unstreamPerforatedPolygon(cp);var cn=cp.readCompressedInt();for(var cm=0;cm<cn;cm++){var cl=new bB();cl.unstream(cp);cq.gp.push(cl)}if(cq.gp.length){cq.addMesh(cp);return cq.rep}cp.popMatId();cp.popGAS();return null};var bM=function(){};bM.prototype=Object.create(G.prototype);bM.prototype.constructor=bM;bM.prototype.unstream=function(co){var cp=new b0();var cn=co.readCompressedInt();cp.rep.unstream(co);cp.vertexBuffer=new l();var cm=new bB();var cl=cm.unstream(co);cp.gp=cm;if(cl){cp.addMesh(co);return cp.rep}else{return null}};var B=function(){};B.prototype=Object.create(G.prototype);B.prototype.constructor=B;B.prototype.unstream=function(co){var cp=new bW();var cn=co.readCompressedInt();cp.rep.unstream(co);cp.vertexBuffer=new l();var cm=new y();var cl=cm.unstream(co);cp.gp=cm;if(cl){cp.addMesh(co);return cp.rep}else{return null}};var a7={LINES:0,LINE_STRIP:1,LINE_LOOP:2};var bq=function(){this.node=new be.SGPrimitive();this.vertexBuffer=null;this.primitive=null;this.decoration=0};bq.prototype=Object.create(bq.prototype);bq.prototype.constructor=bq;bq.prototype.unstreamPrimitive=function(co){this.node.cgmId=0;this.decoration=0;if(co.version>=1100700){this.node.cgmId=co.readUncompressedInt()}else{if(co.version>=1100200){this.node.cgmId=co.readCompressedInt()}}if(co.version>=1100800){var cl=co.readUnsignedShort();if(cl>0){if((cl!=1)&&(cl!=65535)){var cm=co.decorations;var cp=[];cp.push(cl);for(var cn=0;cn<cl;cn++){cp.push(co.readUnsignedChar())}this.decoration=cm.addDecoration(cp)}}}};bq.prototype.create2DArcCircleGP=function(ct,cp,cm,cu,cq,cs,cl,cv,cw){cp.start=0;if(cl<cs){cl+=Math.PI*2}var cr=ct.posBuffer.length/3;if(cw){cp.connectivity=be.ConnectivityTypeEnum.TRIANGLES;cp.count+=(cv-2)*3;for(var co=0;co<cv;++co){var cn=cs+(cl-cs)*co/(cv-1);ct.posBuffer.push(cm+cq*Math.cos(cn));ct.posBuffer.push(cu+cq*Math.sin(cn));ct.posBuffer.push(0);ct.normalBuffer.push(0);ct.normalBuffer.push(0);ct.normalBuffer.push(1)}for(var co=1;co<cv-1;co++){cp.indices.push(0);cp.indices.push(co);cp.indices.push(co+1)}}else{cp.connectivity=be.ConnectivityTypeEnum.LINES;cp.count+=2+(cv-2)*2;var cn=cs;ct.posBuffer.push(cm+cq*Math.cos(cn));ct.posBuffer.push(cu+cq*Math.sin(cn));ct.posBuffer.push(0);for(var co=1;co<cv;++co){cn=cs+(cl-cs)*co/(cv-1);cp.indices.push(cr++);ct.posBuffer.push(cm+cq*Math.cos(cn));ct.posBuffer.push(cu+cq*Math.sin(cn));ct.posBuffer.push(0);cp.indices.push(cr)}}};bq.prototype.createPolylineGP=function(cm,cl,co,cp){cl.start=0;cl.connectivity=be.ConnectivityTypeEnum.LINES;switch(cp){case 0:cl.count+=co;for(var cn=0;cn<co;++cn){cl.indices.push(cm++)}break;case 1:cl.count+=2+(co-2)*2;for(var cn=1;cn<co;++cn){cl.indices.push(cm++);cl.indices.push(cm)}break;case 2:cl.count+=4+(co-2)*2;var cq=cm;for(var cn=0;cn<(co-1);++cn){cl.indices.push(cm++);cl.indices.push(cm)}cl.indices.push(cm);cl.indices.push(cq);break;default:return null;break}};bq.prototype.createPolygonGP=function(cr,cq,cu,cl,cs,cv){cq.start=0;if(cv){cq.connectivity=be.ConnectivityTypeEnum.TRIANGLES;var cm=0;switch(cs){case 0:case 4:cq.count+=cl;for(var cn=0;cn<cl;++cn){cq.indices.push(cu[cr++])}break;case 1:case 5:cq.count+=(cl-2)*3;var cw=0;for(var cn=0;cn<cl-2;cn++){cq.indices.push(cu[cr]);cq.indices.push(cu[cr+1+cw]);cq.indices.push(cu[cr+2-cw]);cr++;cw=1-cw}cr+=2;break;case 2:case 6:cq.count+=(cl-2)*3;var cp=cu[cr];for(var cn=0;cn<cl-2;cn++){cq.indices.push(cp);cq.indices.push(cu[cr+2]);cq.indices.push(cu[cr+1]);cr++}cr+=2;break;default:return null;break}}else{cq.connectivity=be.ConnectivityTypeEnum.LINES;cq.count=2+(cl-1)*2;var ct=cr;for(var co=1;co<cl;++co){cq.indices.push(cr++);cq.indices.push(cr)}cq.indices.push(cr);cq.indices.push(ct)}return cr};var ba=function(){bq.call(this);this.boundingBoxCenter=new Float32Array(3);this.boundingBoxDim=new Float32Array(3);this.boundingSphere=null};ba.prototype=Object.create(bq.prototype);ba.prototype.constructor=ba;ba.prototype.unstreamBBox=function(cn){this.unstreamPrimitive(cn);for(var cm=0;cm<3;cm++){this.boundingBoxCenter[cm]=cn.readFloat()}for(var cm=0;cm<3;cm++){this.boundingBoxDim[cm]=cn.readFloat()}var co=new Array(3);for(var cm=0;cm<3;cm++){co[cm]=cn.readFloat()}var cl=cn.readFloat();if(g){this.boundingSphere={center:co,radius:cl}}};var a3=function(){ba.call(this)};a3.prototype=Object.create(ba.prototype);a3.prototype.constructor=a3;a3.prototype.unstream=function(cG){var cp;if(cG.version>=1101410){this.unstreamBBox(cG);if(cG.getLightDataStreaming()){this.primitive=new Y();this.primitive.unstream(cG);var co=cG.readUnsignedChar();if(co){this.vertexBuffer=new l();this.vertexBuffer.unstream(cG)}}if(cG.version>=1101430){cp=cG.readUnsignedChar()}else{cp=0}return}this.unstreamBBox(cG);var cm,cv;var cH=cG.readCompressedInt();var cs=cG.readCompressedInt();var cF=cG.readCompressedInt();var cn=cG.readCompressedInt();var cu=cG.readCompressedInt();this.primitive=new Y();if(cG.version>=1100700){cm=cG.readUnsignedChar()}var cv=cG.readUnsignedChar();var cr=(cv&1)||(cv&2);var cD=(cv&4)||(cv&8);if(!this.vertexBuffer){this.vertexBuffer=new l()}if(cr){cG.readFloatArray(0,cH,this.vertexBuffer.posBuffer);var cA=cG.readUnsignedChar();if(cA){cG.readFloatArray(0,cH,this.vertexBuffer.uvBuffer)}if(cG.version>1100820){multiple_texture=cG.readUnsignedChar()}}if(cD){if(cG.version>1000800){cG.readShortArray(cs,this.vertexBuffer.normalBuffer);var cw=1/32767;for(var cC=0;cC<cs;cC++){this.vertexBuffer.normalBuffer[cC]*=cw}}else{cG.readFloatArray(0,cs,this.vertexBuffer.normalBuffer)}}if(cF){if(cG.version>=1100600){cG.unpackcArray(3*cF,this.primitive.indices,0)}else{if(cG.version>1000500){cG.unpackcArray(3*cF,this.primitive.indices,0)}else{this.primitive.indices=cG.readUncompressedIntArray((3*cF),this.primitive.indices)}}}var cx=[];var cz=this.primitive.indices.length;if(cn){var cE=[];if(cG.version>1000500){cG.unpackcArray(cn,cE,0)}else{cG.readUncompressedIntArray(cn,cE)}for(cC=(cn-1);cC>=0;cC--){var cy=cE[cC];if(cG.version>=1100600){cG.unpackcArray(cy,cx,0)}else{if(cG.version>1000500){cG.unpackcArray(cy,cx,0)}else{cG.readUncompressedIntArray(cy,cx)}}for(var cB=2;cB<cy;++cB){if(cB%2){this.primitive.indices[cz++]=cx[cB];this.primitive.indices[cz++]=cx[cB-1];this.primitive.indices[cz++]=cx[cB-2]}else{this.primitive.indices[cz++]=cx[cB-1];this.primitive.indices[cz++]=cx[cB];this.primitive.indices[cz++]=cx[cB-2]}}}}if(cu){var cq=[];if(cG.version>1000500){cG.unpackcArray(cu,cq,0)}else{cG.readUncompressedIntArray(cu,cq)}for(cC=(cu-1);cC>=0;cC--){var cl=cq[cC];if(cG.version>=1100600){cG.unpackcArray(cl,cx,0)}else{if(cG.version>1000500){cG.unpackcArray(cl,cx,0)}else{cG.readUncompressedIntArray(cl,cx)}}for(var cB=2;cB<cl;++cB){this.primitive.indices[cz++]=cx[0];this.primitive.indices[cz++]=cx[cB-1];this.primitive.indices[cz++]=cx[cB]}}}var ct=cG.readUnsignedChar();if(ct){cG.readFloatArray(0,(cH*2)/3,this.vertexBuffer.uvBuffer)}if(!cH&&cs==3){this.planarNormals=this.vertexBuffer.normalBuffer}else{if(cH&&cs==3){this.planarNormals=this.vertexBuffer.normalBuffer}else{if(cH||cs){}}}};var A=function(){a3.call(this)};A.prototype=Object.create(a3.prototype);A.prototype.constructor=A;var ae=function(){bq.call(this)};ae.prototype=Object.create(bq.prototype);ae.prototype.constructor=ae;ae.prototype.unstream=function(cm){if(cm.version>=210021710){this.unstreamPrimitive(cm);var cl=cm.readCompressedUInt()}};var ah=function(){bq.call(this);this.fref1=null;this.fref2=null;this.vizEdge=null};ah.prototype=Object.create(bq.prototype);ah.prototype.constructor=ah;ah.prototype.unstream=function(cl){if(cl.version>=1101410){this.unstreamPrimitive(cl);if(cl.getLightDataStreaming()){this.vizEdge=new J();this.vizEdge.unstream(cl);this.vertexBuffer=new l();this.vertexBuffer.posBuffer=vizEdge.linePos}return}};var aQ=function(){ah.call(this)};aQ.prototype=Object.create(ah.prototype);aQ.prototype.constructor=aQ;aQ.prototype.unstream=function(cl){ah.prototype.unstream.call(this,cl);if(cl.readBoolean()){var cm=cl.readCompressedUInt();if(cm){cl.skip(3*cm*4)}}};var br=function(){ba.call(this)};br.prototype=Object.create(ba.prototype);br.prototype.constructor=br;br.prototype.unstream=function(cH,cF){this.unstreamBBox(cH);var cG=cH.readCompressedInt();var cz=cH.readCompressedInt();var cu=new Float32Array(3);cu[0]=cH.readFloat();cu[1]=cH.readFloat();cu[2]=cH.readFloat();var cv=1/Math.sqrt(cu[0]*cu[0]+cu[1]*cu[1]+cu[2]*cu[2]);var cw=new Float32Array(3);cw[0]=cv*cu[0];cw[1]=cv*cu[1];cw[2]=cv*cu[2];var co=true;var cy=new Float32Array(12*cG);var ct=new Float32Array(12*cG);var cn=new Uint32Array(12*(cG-1));var cI=0;var cx=0;var cC=0;for(var cA=0;cA<cG;cA++){cy[cI++]=cH.readFloat();cy[cI++]=cH.readFloat();cy[cI++]=cH.readFloat()}var cD=new Float32Array(3);for(var cA=0;cA<3;cA++){cD[cA]=cH.readFloat()}var cE=new Float32Array(3);for(var cA=0;cA<3;cA++){cE[cA]=cH.readFloat()}if(cG>2){var cm=new ap.Vector3(cy[3]-cy[0],cy[4]-cy[1],cy[5]-cy[2]);var cl=new ap.Vector3(cy[0]+cu[0]-cy[3],cy[1]+cu[1]-cy[4],cy[2]+cu[2]-cy[5]);cm.normalize();cl.normalize();cm.cross(cl);cm.normalize();var cr=new ap.Vector3(cD[0],cD[1],cD[2]);var cB=cm.dot(cr);if(cB<0){co=false}}var cq=(2*Math.PI)/cG;if(co){for(var cA=0;cA<cG;cA++){var cJ=Math.cos(cA*cq);var cp=Math.sin(cA*cq);ct[cx++]=cJ*cD[0]+cp*cE[0];ct[cx++]=cJ*cD[1]+cp*cE[1];ct[cx++]=cJ*cD[2]+cp*cE[2]}}else{for(var cA=cG;cA>0;cA--){var cJ=Math.cos(cA*cq);var cp=Math.sin(cA*cq);ct[cx++]=cJ*cD[0]+cp*cE[0];ct[cx++]=cJ*cD[1]+cp*cE[1];ct[cx++]=cJ*cD[2]+cp*cE[2]}}for(var cA=0;cA<cG;cA++){cy[cI++]=cy[cA*3]+cu[0];cy[cI++]=cy[cA*3+1]+cu[1];cy[cI++]=cy[cA*3+2]+cu[2];ct[cx++]=ct[cA*3];ct[cx++]=ct[cA*3+1];ct[cx++]=ct[cA*3+2]}if(co){for(var cA=0;cA<cG-1;cA++){cn[cC++]=cA;cn[cC++]=cA+1;cn[cC++]=cA+cG;cn[cC++]=cA+cG;cn[cC++]=cA+1;cn[cC++]=cA+1+cG}cn[cC++]=0;cn[cC++]=cG;cn[cC++]=cG-1;cn[cC++]=cG*2-1;cn[cC++]=cG-1;cn[cC++]=cG}else{for(var cA=0;cA<cG-1;cA++){cn[cC++]=cA+cG;cn[cC++]=cA+1+cG;cn[cC++]=cA;cn[cC++]=cA;cn[cC++]=cA+1+cG;cn[cC++]=cA+1}cn[cC++]=cG;cn[cC++]=0;cn[cC++]=cG*2-1;cn[cC++]=cG-1;cn[cC++]=cG*2-1;cn[cC++]=0}var cs=cI/3;for(var cA=0;cA<cG;cA++){ct[cx++]=-cw[0];ct[cx++]=-cw[1];ct[cx++]=-cw[2];cy[cI++]=cy[cA*3];cy[cI++]=cy[cA*3+1];cy[cI++]=cy[cA*3+2]}if(co){for(var cA=0;cA<cG-2;cA++){cn[cC++]=cs;cn[cC++]=cs+cG-1-cA;cn[cC++]=cs+cG-2-cA}}else{for(var cA=0;cA<cG-2;cA++){cn[cC++]=cs;cn[cC++]=cs+cG-2-cA;cn[cC++]=cs+cG-1-cA}}var cs=cI/3;for(var cA=0;cA<cG;cA++){ct[cx++]=cw[0];ct[cx++]=cw[1];ct[cx++]=cw[2];cy[cI++]=cy[(cA+cG)*3];cy[cI++]=cy[(cA+cG)*3+1];cy[cI++]=cy[(cA+cG)*3+2]}if(co){for(var cA=0;cA<cG-2;cA++){cn[cC++]=cs;cn[cC++]=cs+cG-2-cA;cn[cC++]=cs+cG-1-cA}}else{for(var cA=0;cA<cG-2;cA++){cn[cC++]=cs;cn[cC++]=cs+cG-1-cA;cn[cC++]=cs+cG-2-cA}}if(cz>0){cH.skip(3*cz*4)}if(!cF){this.vertexBuffer=new l();this.vertexBuffer.posBuffer=cy;this.vertexBuffer.normalBuffer=ct;this.primitive=new bv();this.primitive.indices=cn}else{cF.posBuffer=cy;cF.normalBuffer=ct;this.indices=cn}};br.prototype.skip=function(cn){this.unstreamBBox(cn);var cl=cn.readCompressedInt();var cm=cn.readCompressedInt();cn.skip(12);cn.skip(12*cl);cn.skip(24);cn.skip(12*cm)};var a5=function(){ba.call(this)};a5.prototype=Object.create(ba.prototype);a5.prototype.constructor=a5;a5.prototype.unstream=function(cG,cE){this.unstreamBBox(cG);var cv=cG.readCompressedInt();var cw=new Float32Array(3*cv);for(var cA=0;cA<3*cv;cA++){cw[cA]=cG.readFloat()}var cD=cG.readCompressedInt();var cq=cD*(cv+2);var cx=new Float32Array(3*cq);for(var cA=0;cA<3*(cD*cv);cA++){cx[cA]=cG.readFloat()}var cs=3*(cD*cv);var cH=3*(cD*(cv+1));for(var cA=0,cy=3*cD-3;cA<3*cD;cA+=3,cy-=3){cx[cs+cA]=cx[cA];cx[cs+cA+1]=cx[cA+1];cx[cs+cA+2]=cx[cA+2];cx[cH+cA]=cx[cs-3*cD+cy];cx[cH+cA+1]=cx[cs-3*cD+cy+1];cx[cH+cA+2]=cx[cs-3*cD+cy+2]}var cu=new Float32Array(3);for(var cA=0;cA<3;cA++){cu[cA]=cG.readFloat()}var cF=new Float32Array(3);for(var cA=0;cA<3;cA++){cF[cA]=cG.readFloat()}var cl=cG.readFloat();var ct=new Float32Array(3*cq);var cp,co,cm;for(var cA=0,cy=cD-1,cB=0;cA<cD*cv;cA++,cy--){cp=(cx[3*cA]-cw[3*cB])*cl;co=(cx[3*cA+1]-cw[3*cB+1])*cl;cm=(cx[3*cA+2]-cw[3*cB+2])*cl;if(cp==0&&co==0&&cm==0){if(cB==0){nnormalBuffer[3*cA]=cu[0];ct[3*cA+1]=cu[1];ct[3*cA+2]=cu[2]}else{ct[3*cA]=cF[0];ct[3*cA+1]=cF[1];ct[3*cA+2]=cF[2]}}else{ct[3*cA]=cp;ct[3*cA+1]=co;ct[3*cA+2]=cm}if(cy==0){cy=cD;cB++}}for(var cA=0;cA<3*cD;cA+=3){ct[cs+cA]=cu[0];ct[cs+cA+1]=cu[1];ct[cs+cA+2]=cu[2];ct[cH+cA]=cF[0];ct[cH+cA+1]=cF[1];ct[cH+cA+2]=cF[2]}var cC=0;var cn=new Uint32Array(6*(cv-1)*(cD)+((cD-2)*6));for(var cA=1;cA<cv;cA++){for(var cy=0;cy<cD-1;cy++){cn[cC++]=cy+1+((cA-1)*cD);cn[cC++]=cy+((cA-1)*cD);cn[cC++]=cy+(cA*cD);cn[cC++]=cy+1+((cA-1)*cD);cn[cC++]=cy+(cA*cD);cn[cC++]=cy+1+(cA*cD)}cn[cC++]=(cA*cD);cn[cC++]=((cA-1)*cD);cn[cC++]=(cA*cD)-1;cn[cC++]=(cA*cD)-1;cn[cC++]=((1+cA)*cD)-1;cn[cC++]=(cA*cD)}var cr=cD*cv;for(var cA=0;cA<cD-2;cA++){cn[cC++]=cr;cn[cC++]=cr+cD-2-cA;cn[cC++]=cr+cD-1-cA}cr=cD*(cv+1);for(var cA=0;cA<cD-2;cA++){cn[cC++]=cr;cn[cC++]=cr+cD-2-cA;cn[cC++]=cr+cD-1-cA}var cz=cG.readCompressedInt();cG.skip(3*cz*4);if(!cE){this.vertexBuffer=new l();this.vertexBuffer.posBuffer=cx;this.vertexBuffer.normalBuffer=ct;this.primitive=new bv();this.primitive.indices=cn}else{cE.posBuffer=cx;cE.normalBuffer=ct;this.indices=cn}};a5.prototype.skip=function(cn){this.unstreamBBox(cn);var co=cn.readCompressedInt();cn.skip(3*co*4);var cl=cn.readCompressedInt();cn.skip(3*cl*co*4);cn.skip(12);cn.skip(12);cn.skip(4);var cm=cn.readCompressedInt();cn.skip(3*cm*4)};var ch=function(){bq.call(this);this.noRender=true;this.primitive=new bv();this.vertexBuffer=null};ch.prototype=Object.create(bq.prototype);ch.prototype.constructor=ch;ch.prototype.unstream=function(cn){this.unstreamPrimitive(cn);if(cn.getLightDataStreaming()){if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.symbol=cn.readCompressedInt();var cl=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=be.ConnectivityTypeEnum.POINTS;var co=cn.readCompressedInt();this.primitive.count=co;for(var cm=0;cm<co;cm++){this.vertexBuffer.posBuffer.push(cn.readFloat());this.vertexBuffer.posBuffer.push(cn.readFloat());this.vertexBuffer.posBuffer.push(cn.readFloat());this.primitive.indices.push(cl++)}}};var L=function(){bq.call(this);this.noRender=true};L.prototype=Object.create(bq.prototype);L.prototype.constructor=L;L.prototype.unstream=function(ct){this.unstreamPrimitive(ct);var cr=ct.readFloat();var cp=ct.readFloat();var cm=ct.readFloat();var co=ct.readFloat();var cs=ct.readFloat();var cl=ct.readFloat();var cu=ct.readCompressedInt();var cq=ct.readCompressedInt();var cv=ct.readCompressedInt();if(cv){var cn=ct.readStringWithLength()}this.primitive={origin:[cr,cp,cm],direction:[co,cs,cl]}};var aA=function(){bq.call(this);this.noRender=true};aA.prototype=Object.create(bq.prototype);aA.prototype.constructor=aA;aA.prototype.unstream=function(ct){this.unstreamPrimitive(ct);if(ct.getLightDataStreaming()){var cp=ct.readFloat();var co=ct.readFloat();var cl=ct.readFloat();var cw=ct.readFloat();var cs=ct.readFloat();var cn=ct.readFloat();var cv=ct.readFloat();var cr=ct.readFloat();var cm=ct.readFloat();var cu=ct.readFloat();var cq=0;if(ct.version>=1100910){cq=ct.readUnsignedChar()}this.primitive={origin:[cp,co,cl],direction1:[cw,cs,cn],direction2:[cv,cr,cm],length:cu,mode:cq}}};var I=function(){bq.call(this);this.noRender=true};I.prototype=Object.create(bq.prototype);I.prototype.constructor=I;I.prototype.unstream=function(cq){this.unstreamPrimitive(cq);var co=cq.readFloat();var cn=cq.readFloat();var cl=cq.readFloat();var cr=cq.readFloat();var cp=cq.readCompressedInt();var cs=cq.readCompressedInt();var ct=cq.readCompressedInt();if(ct){var cm=cq.readString(ct)}};var R=function(){bq.call(this);this.noRender=true};R.prototype=Object.create(bq.prototype);R.prototype.constructor=R;R.prototype.unstream=function(ct){this.unstreamPrimitive(ct);var cr=ct.readFloat();var cp=ct.readFloat();var cm=ct.readFloat();var co=ct.readFloat();var cs=ct.readFloat();var cl=ct.readFloat();var cu=ct.readCompressedInt();var cq=ct.readCompressedInt();var cv=ct.readCompressedInt();if(cv){var cn=ct.readStringWithLength()}this.primitive={origin:[cr,cp,cm],direction:[co,cs,cl]}};var E=function(){bq.call(this);this.noRender=true};E.prototype=Object.create(bq.prototype);E.prototype.constructor=E;E.prototype.unstream=function(cl){this.unstreamPrimitive(cl);cl.skip(47)};var c=function(){bq.call(this);this.noRender=true};c.prototype=Object.create(bq.prototype);c.prototype.constructor=c;c.prototype.unstream=function(cl){this.unstreamPrimitive(cl);cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readCompressedInt();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat();cl.readFloat()};var aS=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.symbol=null};aS.prototype=Object.create(bq.prototype);aS.prototype.constructor=aS;aS.prototype.unstream=function(cw){this.unstreamPrimitive(cw);var cl="";var cn=cw.readUnsignedChar();if(cn){var cq=new bH();var cr=cq.unstream(cw);var cp=cw.readFloat();var cv=cw.readFloat();var cx=cw.readFloat();var cu=cw.readCompressedInt();var cm=cw.readCompressedInt();var co=cw.readCompressedInt();if(cr){var cs=cw.textures.add(cr);this.primitive.symbol={file:"",id:cs}}}if(!this.vertexBuffer){this.vertexBuffer=new l()}var ct=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cp);this.vertexBuffer.posBuffer.push(cv);this.vertexBuffer.posBuffer.push(cx);this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=be.ConnectivityTypeEnum.POINTS;this.primitive.count=1;this.primitive.indices.push(0);return true};var bn={CROSS:1,PLUS:2,OPEN_ARROW:14,UNFILLED_ARROW:15,BLANKED_ARROW:16,FILLED_ARROW:17,UNFILLED_CIRCLE:18,BLANKED_CIRCLE:19,FILLED_CIRCLE:20,CROSSED_CIRCLE:21,BLANKED_SQUARE:22,FILLED_SQUARE:23,BLANKED_TRIANGLE:24,FILLED_TRIANGLE:25,MANIPULATOR_SQUARE:26,MANIPULATOR_DIAMOND:27,MANIPULATOR_CIRCLE:28,MANIPULATOR_TRIANGLE:29,DOUBLE_OPEN_ARROW:30,WAVE:31,DOUBLE_FILLED_ARROW:32};var aP=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};aP.prototype=Object.create(bq.prototype);aP.prototype.constructor=aP;aP.prototype.lineType=null;aP.prototype.unstream=function(cm){this.unstreamPrimitive(cm);var co=cm.readUnsignedChar();var cn=[];cm.readFloatArray(0,4,cn);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cl=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cn[0]);this.vertexBuffer.posBuffer.push(cn[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cn[2]);this.vertexBuffer.posBuffer.push(cn[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cn[2]);this.vertexBuffer.posBuffer.push(cn[3]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cn[0]);this.vertexBuffer.posBuffer.push(cn[3]);this.vertexBuffer.posBuffer.push(0);if(co){this.primitive.connectivity=be.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=6;this.primitive.indices.push(cl);this.primitive.indices.push(cl+1);this.primitive.indices.push(cl+2);this.primitive.indices.push(cl+2);this.primitive.indices.push(cl+3);this.primitive.indices.push(cl+0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1)}else{this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;this.primitive.count=8;this.primitive.indices.push(cl);this.primitive.indices.push(cl+1);this.primitive.indices.push(cl+1);this.primitive.indices.push(cl+2);this.primitive.indices.push(cl+2);this.primitive.indices.push(cl+3);this.primitive.indices.push(cl+3);this.primitive.indices.push(cl+0)}return true};var bG=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.primitives=[]};bG.prototype=Object.create(bq.prototype);bG.prototype.constructor=bG;bG.prototype.lineType=null;bG.prototype.unstream=function(cr){this.unstreamPrimitive(cr);if(cr.version>1101410){var cz=cr.readCompressedInt();var cx=[];cr.readFloatArray(0,2,cx);var cA=cr.readFloat();var co=cr.readCompressedInt()}var cu=[];cr.readFloatArray(0,2,cu);var cm=new ap.Vector2(cu[0],cu[1]);cm.normalize();var cn=cr.readFloat();var cw=cA*Math.tan(cn);if(!this.vertexBuffer){this.vertexBuffer=new l()}var cp=this.vertexBuffer.posBuffer.length/3;if(co!==bn.WAVE){this.vertexBuffer.posBuffer.push(cx[0]-cm.x*cA+cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cm.y*cA-cm.x*cw);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]);this.vertexBuffer.posBuffer.push(cx[1]);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]-cm.x*cA-cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cm.y*cA+cm.x*cw);this.vertexBuffer.posBuffer.push(0)}switch(co){case bn.OPEN_ARROW:var cv=new bv();this.createPolylineGP(cp,cv,3,1);this.primitive=cv;break;case bn.UNFILLED_ARROW:var cv=new bv();cv.count=0;var cy=[0,1,2];this.createPolygonGP(0,cv,cy,cy.length,0,false);this.primitive=cv;break;case bn.BLANKED_ARROW:case bn.FILLED_ARROW:var cv=new bv();cv.count=0;var cy=[0,1,2];this.createPolygonGP(0,cv,cy,cy.length,0,true);this.primitive=cv;break;case bn.DOUBLE_OPEN_ARROW:var cv=new bv();this.createPolylineGP(cp,cv,3,1);var cp=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x-cm.x*cA+cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y-cm.y*cA-cm.x*cw);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x-cm.x*cA-cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y-cm.y*cA+cm.x*cw);this.vertexBuffer.posBuffer.push(0);this.createPolylineGP(cp,cv,3,1);this.primitive=cv;break;case bn.DOUBLE_FILLED_ARROW:var cv=new bv();cv.count=0;var cy=[0,1,2];this.createPolygonGP(0,cv,cy,cy.length,0,true);var cp=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x-cm.x*cA+cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y-cm.y*cA-cm.x*cw);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cx[0]-cA*cm.x-cm.x*cA-cm.y*cw);this.vertexBuffer.posBuffer.push(cx[1]-cA*cm.y-cm.y*cA+cm.x*cw);this.vertexBuffer.posBuffer.push(0);var cy=[3,5,4];this.createPolygonGP(0,cv,cy,cy.length,0,true);this.primitive=cv;break;case bn.WAVE:var cn=Math.acos(-cm.y);cn=Math.asin(cm.x)<0?-cn:cn;var cq=cA*0.5;var ct=cx[0]+cq*cm.y;var cs=cx[1]-cq*cm.x;var cl=new bv();this.create2DArcCircleGP(this.vertexBuffer,cl,ct,cs,cq,cn,cn+Math.PI,17,false);var ct=cx[0]-cq*cm.y;var cs=cx[1]+cq*cm.x;this.create2DArcCircleGP(this.vertexBuffer,cl,ct,cs,cq,cn+Math.PI,cn,17,false);this.primitive=cl;break;default:var cl=new bv();this.create2DArcCircleGP(this.vertexBuffer,cl,cx[0],cx[1],cA/2,0,2*Math.PI,17,true);this.primitive=cl;break}return true};var a1=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.primitives=[]};a1.prototype=Object.create(bq.prototype);a1.prototype.constructor=a1;a1.prototype.lineType=null;a1.prototype.unstream=function(cF){this.unstreamPrimitive(cF);var cl=cF.readCompressedInt();var cz=[];cF.readFloatArray(0,2,cz);var cw=cF.readFloat();var cA=cF.readCompressedInt();if(!this.vertexBuffer){this.vertexBuffer=new l()}var cm=this.vertexBuffer.posBuffer.length/3;switch(cA){case bn.UNFILLED_CIRCLE:var cp=new bv();this.create2DArcCircleGP(this.vertexBuffer,cp,cz[0],cz[1],cw/2,0,2*Math.PI,17,false);this.primitive=cp;break;case bn.BLANKED_CIRCLE:case bn.MANIPULATOR_CIRCLE:var cp=new bv();this.create2DArcCircleGP(this.vertexBuffer,cp,cz[0],cz[1],cw/2,0,2*Math.PI,17,false);this.primitive=cp;break;case bn.FILLED_CIRCLE:var cp=new bv();this.create2DArcCircleGP(this.vertexBuffer,cp,cz[0],cz[1],cw/2,0,2*Math.PI,17,true);this.primitive=cp;break;case bn.CROSSED_CIRCLE:var cp=new bv();this.create2DArcCircleGP(this.vertexBuffer,cp,cz[0],cz[1],cw/2,0,2*Math.PI,17,true);var cu={backgoundColor:true};var cs=cF.materials.add(cu);cp.material={file:"",id:cs};this.primitives.push(cp);var co=new bv();this.create2DArcCircleGP(this.vertexBuffer,co,cz[0],cz[1],cw/2,0,2*Math.PI,17,false);var cq=cw/2;var cy=cq*Math.cos(Math.PI/4);var cE=cq*Math.sin(Math.PI/4);var cv=cq*Math.cos(5*Math.PI/4);var cC=cq*Math.sin(5*Math.PI/4);var cm=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cz[0]+cy);this.vertexBuffer.posBuffer.push(cz[1]+cE);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]+cv);this.vertexBuffer.posBuffer.push(cz[1]+cC);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cy);this.vertexBuffer.posBuffer.push(cz[1]-cC);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cv);this.vertexBuffer.posBuffer.push(cz[1]-cE);this.vertexBuffer.posBuffer.push(0);this.createPolylineGP(cm,co,4,0);this.primitives.push(co);break;case bn.BLANKED_SQUARE:case bn.FILLED_SQUARE:case bn.MANIPULATOR_SQUARE:case bn.MANIPULATOR_DIAMOND:var cq=cw/2;this.vertexBuffer.posBuffer.push(cz[0]-cq);this.vertexBuffer.posBuffer.push(cz[1]-cq);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cq);this.vertexBuffer.posBuffer.push(cz[1]+cq);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]+cq);this.vertexBuffer.posBuffer.push(cz[1]+cq);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]+cq);this.vertexBuffer.posBuffer.push(cz[1]-cq);this.vertexBuffer.posBuffer.push(0);var cx=new bv();cx.count=0;var cr=[0,1,2,0,2,3];this.createPolygonGP(0,cx,cr,cr.length,0,true);this.primitive=cx;break;case bn.BLANKED_TRIANGLE:case bn.FILLED_TRIANGLE:case bn.MANIPULATOR_TRIANGLE:var cq=cw/2;this.vertexBuffer.posBuffer.push(cz[0]);this.vertexBuffer.posBuffer.push(cz[1]+cq);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cq);this.vertexBuffer.posBuffer.push(cz[1]-cq);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]+cq);this.vertexBuffer.posBuffer.push(cz[1]-cq);this.vertexBuffer.posBuffer.push(0);var cB=new bv();cB.count=0;var cr=[0,1,2];this.createPolygonGP(0,cB,cr,cr.length,0,true);this.primitive=cB;break;case bn.CROSS:case bn.PLUS:var ct=cw*0.5;var cG=1;var cD=0;if(cA==bn.CROSS){cG=Math.PI/4;cD=-cG}cG*=ct;cD*=ct;this.vertexBuffer.posBuffer.push(cz[0]+cG);this.vertexBuffer.posBuffer.push(cz[1]+cD);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cG);this.vertexBuffer.posBuffer.push(cz[1]-cD);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]-cD);this.vertexBuffer.posBuffer.push(cz[1]+cG);this.vertexBuffer.posBuffer.push(0);this.vertexBuffer.posBuffer.push(cz[0]+cD);this.vertexBuffer.posBuffer.push(cz[1]-cG);this.vertexBuffer.posBuffer.push(0);var cn=new bv();this.createPolylineGP(cm,cn,4,0);this.primitive=cn;break;default:var cp=new bv();this.create2DArcCircleGP(this.vertexBuffer,cp,cz[0],cz[1],cw/2,0,2*Math.PI,17,true);this.primitive=cp;break}return true};var y=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.symbol=null};y.prototype=Object.create(bq.prototype);y.prototype.constructor=y;y.prototype.lineType=null;y.prototype.unstream=function(cu){this.unstreamPrimitive(cu);var cv=[];cu.readFloatArray(0,2,cv);var cp=0;var cn=cu.readCompressedInt();var ct=cu.readCompressedInt();var cm=cu.readCompressedInt();var cq=cu.readCompressedInt();cp=cu.readCompressedInt();if(cu.readBoolean()){var co=new bH();var cl=co.unstream(cu);if(cl!=null){if(cp>0){cl.zoom=true}var cr=cu.textures.add(cl);this.symbol={file:"",id:cr}}}if(!this.vertexBuffer){this.vertexBuffer=new l()}var cs=this.vertexBuffer.posBuffer.length/3;this.vertexBuffer.posBuffer.push(cv[0]);this.vertexBuffer.posBuffer.push(cv[1]);this.vertexBuffer.posBuffer.push(0);this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=be.ConnectivityTypeEnum.POINTS;this.primitive.count=1;this.primitive.indices.push(0);return true};var bV=function(){bq.call(this);this.vertexBuffer=null;this.primitives=[];this.primitive=new bv()};bV.prototype=Object.create(bq.prototype);bV.prototype.constructor=bV;bV.prototype.lineType=null;bV.prototype.unstream=function(cs){this.unstreamPrimitive(cs);var ct=[];var cu=[];var cx=[];var cw=[];cs.readFloatArray(0,2,ct);cs.readFloatArray(0,2,cu);var cq=cs.readFloat();var cm=cs.readFloat();var cn=cs.readFloat();var cy=cs.readCompressedInt();cs.readFloatArray(0,10,cx);cs.readFloatArray(0,2,cw);var cp=cs.readStringWithLength();if(!this.vertexBuffer){this.vertexBuffer=new l()}var cr=this.vertexBuffer.posBuffer.length/3;for(var co=0;co<5;co++){this.vertexBuffer.posBuffer.push(coords[co*2]);this.vertexBuffer.posBuffer.push(coords[co*2+1]);this.vertexBuffer.posBuffer.push(0)}if(cy){var cl=new bv();cl.node.cgmId=this.primitive.node.cgmId;if(this.primitive.decoration){cl.decoration=this.primitive.decoration}cl.start=cl.indices.length;cl.connectivity=be.ConnectivityTypeEnum.TRIANGLES;cl.count=3;cl.indices.push(2);cl.indices.push(3);cl.indices.push(4);var cv=new bv();cv.node.cgmId=this.primitive.node.cgmId;if(this.primitive.decoration){cv.decoration=this.primitive.decoration}cv.start=cv.indices.length;cv.connectivity=be.ConnectivityTypeEnum.LINES;cv.count=2;cv.indices.push(0);cv.indices.push(1);this.primitive.push(cl);this.primitive.push(cv)}else{this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;this.primitive.count=8;this.primitive.indices.push(0);this.primitive.indices.push(1);this.primitive.indices.push(2);this.primitive.indices.push(3);this.primitive.indices.push(3);this.primitive.indices.push(4);this.primitive.indices.push(4);this.primitive.indices.push(2)}return true};var r=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.text=null};r.prototype=Object.create(bq.prototype);r.prototype.constructor=r;r.prototype.lineType=null;r.prototype.unstream=function(cr){this.unstreamPrimitive(cr);var ct=[];cr.readFloatArray(0,2,ct);var cv=cr.readFloat();var co=cr.readCompressedInt();var cp=cr.readCompressedInt();var cs=null;var cq=null;if(cr.readBoolean()){cs=cr.readGraphicAttributeSet()}if(cr.readBoolean()){cq=cr.readGraphicAttributeSet()}var cl=cr.readCompressedInt();if(cl>0){var cn="";var cu=[];cr.readShortArray(cl,cu);for(var cm=0;cm<cl;cm++){cn+=String.fromCharCode(cu[cm])}}this.text={text:cn,anchor:{x:ct[0],y:ct[1]},height:cv};return false};var bj=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.nodes=[]};bj.prototype=Object.create(bq.prototype);bj.prototype.constructor=bj;bj.prototype.lineType=null;bj.prototype.unstream=function(cP){this.unstreamPrimitive(cP);var ct=cP.readCompressedInt();var cH=cP.readCompressedInt();var cO=cP.readCompressedInt();var cC=cP.readCompressedInt();var cJ=cP.readCompressedInt();var cp=cP.readFloat();var cm=cP.readFloat();var cn=cP.readFloat();var cw=[];if(ct>0&&cH>0){var cE=[];var cL=[];cP.readFloatArray(0,2*cH,cE);cP.readFloatArray(0,ct,this.nodes);cP.readFloatArray(0,cH,cL)}if(cO>0){var cN=[];cP.readFloatArray(0,2*cO,cN)}if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cl=this.vertexBuffer.posBuffer.length/3;this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;if(cC){cP.readFloatArray(0,2*cC,cw);for(var cK=0;cK<cC;cK++){this.primitive.indices.push(cl++);this.vertexBuffer.posBuffer.push(cw[cK*2]);this.vertexBuffer.posBuffer.push(cw[cK*2+1]);this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cl)}this.primitive.count=2*cC-2;return true}else{var cA=0.01;var cM=cm-cp;if(cM==0){return false}var cq=((Math.PI/Math.acos(1-(cA/cn)))*0.5+0.5);if(cq>100){cq=100}var cD=cq+1;var cs=cM/cq;var cz,cy,cB;cB=cp;var cr=1;var cu=true;for(var cI=0;cI<(cq+1);cI++){var co,cx,cv,cF;co=0;cx=0;cv=0;cF=0;var cG=0;for(var cK=0;cK<cH;cK++){if((Math.abs(cB-cm)<=0.00001)&&(cK==(cH-1))){cF=1}else{cF=this.computeBSplineBase(cK,cJ,cB,cr)}co+=(cF*cE[cG]*cL[cK]);cx+=(cF*cE[cG+1]*cL[cK]);cv+=(cF*cL[cK]);cG+=2}if(cv<=1e-15){cD--}else{cz=co/cv;cy=cx/cv;this.vertexBuffer.posBuffer.push(cz);this.vertexBuffer.posBuffer.push(cy);this.vertexBuffer.posBuffer.push(0);if(!cu){this.primitive.indices.push(cl++);this.primitive.indices.push(cl)}cu=false}cB=cp+(cI+1)*cs}if(cD>0){this.primitive.count=2*cD-2;return true}return false}};bj.prototype.computeBSplineBase=function(cp,co,cs,cq){var ct=0;if(co==1){if((cs>=this.nodes[cp])&&(cs<this.nodes[cp+1])){ct=1}else{ct=0}}else{if((cs<this.nodes[cp])||(cs>=this.nodes[cp+co])){ct=0}else{var cm=this.computeBSplineBase(cp,co-1,cs,cq);var cu=this.computeBSplineBase(cp+1,co-1,cs,cq);var cr=0.000001*cq;var cn;if(Math.abs(this.nodes[cp]-this.nodes[cp+co-1])<=cr){cn=0}else{cn=(cs-this.nodes[cp])/(this.nodes[cp+co-1]-this.nodes[cp])}var cl;if(Math.abs(this.nodes[cp+1]-this.nodes[cp+co])<=cr){cl=0}else{cl=(this.nodes[cp+co]-cs)/(this.nodes[cp+co]-this.nodes[cp+1])}ct=cn*cm+cl*cu}}return ct};var aZ=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};aZ.prototype=Object.create(bq.prototype);aZ.prototype.constructor=aZ;aZ.prototype.lineType=null;aZ.prototype.unstream=function(cT){this.unstreamPrimitive(cT);var cP=cT.readCompressedInt();var cJ=[];if(cP>0){cT.readFloatArray(0,2*cP,cJ);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cl=this.vertexBuffer.posBuffer.length/3;this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;if(cP<4){return false}var cD=(cP-1)%3;var ct=cP-cD;var cB=0;var cQ,cr,cO,cq,cM,co,cK,cm;var cC,cA,cN,cL,cp,cn;cQ=cJ[0],cr=cJ[1];var cH=2;for(var cI=0;cI<(ct-1);cI+=3){cO=cJ[cH];cq=cJ[cH+1];cM=cJ[cH+2];co=cJ[cH+3];cK=cJ[cH+4];cm=cJ[cH+5];cC=cK-cQ+3*cO-3*cM;cA=cm-cr+3*cq-3*co;cN=3*(cM-2*cO+cQ);cL=3*(co-2*cq+cr);cp=3*(cO-cQ);cn=3*(cq-cr);var cs=Math.sqrt((cQ-cK)*(cQ-cK)+(cr-cm)*(cr-cm))/2;cB=0.01;var cu=0;if((cs>0)&&(cB>=0)&&(cB<=(2*cs))){var cS=Math.acos(1-(cB/cs));if(cS>0){cu=Math.floor((Math.PI/cS)*0.5+0.5)}}if(cu<=0){cu=1}if(cu>100){cu=100}var cF=cu+1;var cR=1;var cv=cR/cu;var cz,cw,cE;cz=cQ;cw=cr;this.vertexBuffer.posBuffer.push(cz);this.vertexBuffer.posBuffer.push(cw);this.vertexBuffer.posBuffer.push(0);cE=cv;for(var cG=0;cG<cu;cG++){cz=cC*Math.pow(cE,3)+cN*Math.pow(cE,2)+cp*cE+cQ;cw=cA*Math.pow(cE,3)+cL*Math.pow(cE,2)+cn*cE+cr;this.vertexBuffer.posBuffer.push(cz);this.vertexBuffer.posBuffer.push(cw);this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cl++);this.primitive.indices.push(cl);cE+=cv}this.primitive.count=2*cF-2;cQ=cK;cr=cm;cH+=6}if(cD>0){for(var cI=0;cI<cD+1;cI++){this.vertexBuffer.posBuffer.push(cJ[2*(ct-1+cI)]);this.vertexBuffer.posBuffer.push(cJ[2*(ct-1+cI)+1]);this.primitive.indices.push(cl++);this.primitive.indices.push(cl)}}this.primitive.count+=2*(cD+1);return true}return false};var aq=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.primitives=[]};aq.prototype=Object.create(bq.prototype);aq.prototype.constructor=aq;aq.prototype.lineType=null;aq.prototype.unstream=function(cE){this.unstreamPrimitive(cE);var cB=cE.readCompressedInt();var cD=[];var cs=0;cE.readUncompressedIntArray(cB,cD);for(var cA=0;cA<cB;++cA){cs+=cD[cA]}var cr=0;if(cE.version<1101840||(cE.version>=2100000&&cE.version<2100130)){cr=cs}else{cr=cE.readCompressedInt()}var cy=[];cE.readFloatArray(0,2*cr,cy);if(!this.vertexBuffer){this.vertexBuffer=new l()}var cl=this.vertexBuffer.posBuffer.length/3;for(var cA=0;cA<cr;cA++){this.vertexBuffer.posBuffer.push(cy[cA*2]);this.vertexBuffer.posBuffer.push(cy[cA*2+1]);this.vertexBuffer.posBuffer.push(0)}var cw=cE.readCompressedInt();if(cw){var cv=new bv();cv.cgmId=this.primitive.cgmId;cv.start=cv.indices.length;cv.connectivity=be.ConnectivityTypeEnum.TRIANGLES;var ct=cE.readCompressedInt();var cz=[];var cn=[];var cC=0;var cu=[];cE.readUncompressedIntArray(ct,cz);cE.readUncompressedIntArray(ct,cn);for(var cA=0;cA<ct;++cA){cC+=cz[cA]}cE.readUncompressedIntArray(cC,cu);cv.count=0;var co=0;for(var cA=0;cA<ct;++cA){switch(cn[cA]){case 0:case 4:cv.count+=cz[cA];for(var cx=0;cx<cz[cA];++cx){cv.indices.push(cu[co++]-1)}break;case 1:case 5:cv.count+=(cz[cA]-2)*3;var cq=0;for(var cx=0;cx<cz[cA]-2;cx++){cv.indices.push(cu[co]-1);cv.indices.push(cu[co+1+cq]-1);cv.indices.push(cu[co+2-cq]-1);co++;cq=1-cq}co+=2;break;case 2:case 6:cv.count+=(cz[cA]-2)*3;var cp=cu[co]-1;for(var cx=0;cx<cz[cA]-2;cx++){cv.indices.push(cu[cp]-1);cv.indices.push(cu[co+2]-1);cv.indices.push(cu[co+1]-1);co++}co+=2;break;default:return null;break}}this.primitives.push(cv);return true}else{var cm=new bv();cm.cgmId=this.primitive.cgmId;cm.start=cm.indices.length;cm.connectivity=be.ConnectivityTypeEnum.LINES;cm.count=2*cr-2;var cp=cl;for(var cA=1;cA<cr;cA++){cm.indices.push(cl++);cm.indices.push(cl)}cm.indices.push(cl);cm.indices.push(cp);this.primitives.push(cm);return true}};var N=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.text=null;this.noRender=true};N.prototype=Object.create(bq.prototype);N.prototype.constructor=N;N.prototype.lineType=null;N.prototype.unstream=function(cB){var cK=cB.readCompressedInt();var cn=[];cB.readBytes(cK,cn);var cz="";for(var cT=0;cT<cn.length;cT++){cz+=String.fromCharCode(cn[cT])}var cy=cz.substring(cz.length-5,cz.length);var cA=true;if(cy===".font"||cy===".FONT"){cA=false}if(p.get(cz)){cz=p.get(cz)}if(cz.indexOf(".")!==-1){cz=cz.split(".")[0]}var cD=cB.readCompressedInt();var cq="";for(var cT=0;cT<cD;cT++){cq+=String.fromCharCode(cB.readUnsignedShort())}cB.readUnsignedShort();var cw=cB.readFloat();var cl=cB.readFloat();var cm=cB.readFloat();var cp=cB.readFloat();var cS=cB.readShort();var cF=[];cB.readFloatArray(0,4,cF);var cJ=cB.readFloat();var cO=cB.readShort();var cG=cB.readShort();var cI=[];cB.readFloatArray(0,2,cI);var cN=cB.readFloat();var cP=cB.readFloat();var cs=cB.readFloat();var cr=cB.readFloat();var cE=cB.readFloat();var co=cB.readShort();var ct=false;var cH=-1;if(cB.version>=2100020||(cB.version>=1101600&&cB.version<2100000)){var ct=cB.readCompressedInt()}if(cB.version>=2100070||(cB.version>=1101730&&cB.version<2100000)){var cH=cB.readCompressedInt()}var cV=cB.readCompressedInt();var cL=cB.readCompressedInt();var cU=cB.readFloat();var cx=cB.readFloat();var cu=cB.readFloat();var cQ=cB.readFloat();var cv=[cU,cx,cu,cQ];if(cB.version>=1101330){var cM=cB.readFloat()}var cR=[];cB.readFloatArray(0,22,cR);if(cA){cB.readFloat();cB.readFloat();cB.readFloat();cB.readFloat();cB.readFloat();cB.readFloat();cB.readFloat()}if(h){var cC=cB.getCurrentMatrix();this.text={text:cq,bbox:cv,horJustif:cS,verJustification:co,matrix:cC,fontName:cz,color:null,stroke:false,path:cO}}};var ce=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};ce.prototype=Object.create(bq.prototype);ce.prototype.constructor=ce;ce.prototype.lineType=null;ce.prototype.unstream=function(co){var cm=bB.prototype.unstream.call(this,co);var cl=co.readCompressedInt();if(cl>0){var cn=[];co.readUncompressedIntArray(cl,cn)}return cm};var bB=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};bB.prototype=Object.create(bq.prototype);bB.prototype.constructor=bB;bB.prototype.lineType=null;bB.prototype.unstream=function(cG){this.unstreamPrimitive(cG);var cy=cG.readUnsignedChar();if((cG.version>=1101900&&cG.version<2100000)||(cG.version>=2100170)){var cC=cG.readCompressedInt();if(cC==0){cG.readCompressedInt();cG.readCompressedInt();return false}var cz=[];var cF=cG.readCompressedInt();if(cF>0){var cr=[];cG.readFloatArray(0,cF*2,cz)}var cs=cG.readCompressedInt();var cv=0;var cD=[];if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cm=this.vertexBuffer.posBuffer.length/3;for(var cB=0;cB<cC;++cB){this.vertexBuffer.posBuffer.push(cz[cB*2]);this.vertexBuffer.posBuffer.push(cz[cB*2+1]);this.vertexBuffer.posBuffer.push(0)}if(cs>0){for(var cB=0;cB<cC;++cB){this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(0);this.vertexBuffer.normalBuffer.push(1)}var co=[];var cA=[];for(var cB=0;cB<cs;++cB){co[cB]=cG.readUncompressedInt()}for(var cB=0;cB<cs;++cB){cA[cB]=cG.readUncompressedInt()}var cE=0;for(var cB=0;cB<cs;cB++){cE+=cA[cB]}var ct=[];for(var cB=0;cB<cE;++cB){ct[cB]=cG.readUncompressedInt()-1}this.primitive.count=0;var cp=cm;for(var cB=0;cB<cs;++cB){cp=this.createPolygonGP(cp,this.primitive,ct,cA[cB],co[cB],true)}}else{this.createPolygonGP(cm,this.primitive,undefined,cF,undefined,false)}if(cy==4||cy==3){return false}return true}else{if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.connectivity=be.ConnectivityTypeEnum.TRIANGLES;this.primitive.start=this.primitive.indices.length;var cm=this.vertexBuffer.posBuffer.length/3;var cF=cG.readCompressedInt();if(cF>0){var cr=[];cG.readFloatArray(0,2*cF,cr)}if(cy==1){var cs=cG.readCompressedInt();if(cs>0){var cv=0;var cD=[];var co=[];var cA=[];for(var cB=0;cB<cs;++cB){co[cB]=cG.readUncompressedInt()}for(var cB=0;cB<cs;++cB){cA[cB]=cG.readUncompressedInt();if(co[cB]===0||co[cB]===4){cv+=cA[cB]/3}if(co[cB]===1||co[cB]===5){cv+=cA[cB]-2}if(co[cB]===2||co[cB]===6){cv+=cA[cB]-2}}var cn=0;for(var cB=0;cB<cs;cB++){cn+=cA[cB]}var cu=[];for(var cB=0;cB<cn;++cB){cu[cB]=cG.readUncompressedInt()}var cq=0;for(var cB=0;cB<cs;++cB){if(co[cB]===0||co[cB]===4){var cn=cA[cB];for(var cx=0;cx<cn;++cx){this.primitive.indices.push(cu[cq++]-1+cm)}}if(co[cB]===1||co[cB]===5){var cw=cA[cB];for(var cx=2;cx<cw;++cx){if(cx%2){this.primitive.indices.push(cu[cq+cx]-1+cm);this.primitive.indices.push(cu[cq+cx-1]-1+cm);this.primitive.indices.push(cu[cq+cx-2]-1+cm)}else{this.primitive.indices.push(cu[cq+cx-1]-1+cm);this.primitive.indices.push(cu[cq+cx]-1+cm);this.primitive.indices.push(cu[cq+cx-2]-1+cm)}}cq+=cw}if(co[cB]===2||co[cB]===6){var cl=cA[cB];for(var cx=2;cx<cl;++cx){this.primitive.indices.push(cu[cq]-1+cm);this.primitive.indices.push(cu[cq+cx-1]-1+cm);this.primitive.indices.push(cu[cq+cx]-1+cm)}cq+=cl}}}for(var cB=0;cB<cF;++cB){this.vertexBuffer.posBuffer.push(cr[2*cB]);this.vertexBuffer.posBuffer.push(cr[2*cB+1]);this.vertexBuffer.posBuffer.push(0)}}if((cy==4)||(cy==3)){return false}return true}};var bm=function(){bq.call(this);this.primitive=new bv()};bm.prototype=Object.create(bq.prototype);bm.prototype.constructor=bm;bm.prototype.lineType=null;bm.prototype.unstream=function(cr){this.unstreamPrimitive(cr);var cm=cr.readDouble();var cq=cr.readDouble();var cn=cr.readDouble();var co=cr.readDouble();var cl=cr.readDouble();var cv=cr.readUnsignedChar();var cs=cr.readCompressedInt();var cu=cr.readDouble();var cp=cr.readDouble();var ct=17;if(!this.vertexBuffer){this.vertexBuffer=new l()}this.create2DArcCircleGP(this.vertexBuffer,this.primitive,cm,cq,cn,co,cl,ct,cv);return true};var b4=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};b4.prototype=Object.create(bq.prototype);b4.prototype.constructor=b4;b4.prototype.lineType=null;b4.prototype.unstream=function(cs){this.unstreamPrimitive(cs);this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;if(!this.vertexBuffer){this.vertexBuffer=new l()}var cq=this.vertexBuffer.posBuffer.length/3;var cl=cs.readCompressedInt();var cp=cs.readUnsignedChar();var ct=false;if(cp==0&&cl&1){cl--;ct=true}for(var co=0;co<cl;++co){this.vertexBuffer.posBuffer.push(cs.readFloat());this.vertexBuffer.posBuffer.push(cs.readFloat());this.vertexBuffer.posBuffer.push(0)}if(ct){cs.readFloat();cs.readFloat()}this.createPolylineGP(cq,this.primitive,cl,cp);if((cs.version>=1101850&&cs.version<2100000)||cs.version>=2100170){var cn=cs.readUnsignedChar()}else{if(cl==2){var cm=this.vertexBuffer.posBuffer.length-6;var cr=(this.vertexBuffer.posBuffer[cm]-this.vertexBuffer.posBuffer[cm+3])*(this.vertexBuffer.posBuffer[cm]-this.vertexBuffer.posBuffer[cm+3]);cr+=(this.vertexBuffer.posBuffer[cm+1]-this.vertexBuffer.posBuffer[cm+4])*(this.vertexBuffer.posBuffer[cm+1]-this.vertexBuffer.posBuffer[cm+4]);if(cr>=1000000000000){}}}return true};var bY=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};bY.prototype=Object.create(bq.prototype);bY.prototype.constructor=bY;bY.prototype.lineType=null;bY.prototype.unstream=function(cn){this.unstreamPrimitive(cn);if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.symbol=cn.readCompressedInt();var cl=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;this.primitive.connectivity=be.ConnectivityTypeEnum.POINTS;var co=cn.readCompressedInt();this.primitive.count=co;for(var cm=0;cm<co;cm++){this.vertexBuffer.posBuffer.push(cn.readFloat());this.vertexBuffer.posBuffer.push(cn.readFloat());this.vertexBuffer.posBuffer.push(0);this.primitive.indices.push(cl++)}return true};var bF=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv()};bF.prototype=Object.create(bq.prototype);bF.prototype.constructor=bF;bF.prototype.lineType=null;bF.prototype.unstream=function(cJ){this.unstreamPrimitive(cJ);var cy=cJ.readDouble();var cv=cJ.readDouble();var cH=cJ.readDouble();var cs=cJ.readDouble();var cF=cJ.readDouble();var cz=cJ.readDouble();var cr=cJ.readDouble();var cE=cJ.readUnsignedChar();var ct=cJ.readCompressedInt();var cp=cJ.readDouble();var cl=cJ.readDouble();var cq=(cH>cs)?cH:cs;if(cz<cF){cz+=(2*Math.PI)}if(cF<0){cF+=(2*Math.PI);cz+=(2*Math.PI)}var cn=cz-cF;var cI=17;var co=cn/(cI-1);var cu=[];cu[0]=cp*cH;cu[1]=cl*cs;cu[2]=0;var cw=cs/cH;var cB=Math.cos(co);var cx=Math.sin(co);var cG=0;var cD=3;for(cG=1;cG<cI;cG++){cu[cD]=cB*cu[cD-3]-cx*cu[cD-2]/cw;cu[cD+1]=cx*cu[cD-3]*cw+cB*cu[cD-2];cu[cD+2]=0;cD+=3}var cC=new ap.Matrix4();cC.makeRotationZ(cr);cC.setPosition({x:cy,y:cv,z:0});cD=0;var cA=new ap.Vector4();for(cG=0;cG<cI;cG++){cA.set(cu[cD],cu[cD+1],0,1);cA.applyMatrix4(cC);cu[cD]=cA.x;cu[cD+1]=cA.y;cu[cD+2]=0;cD+=3}if(!this.vertexBuffer){this.vertexBuffer=new l()}this.primitive.start=this.primitive.indices.length;var cm=this.vertexBuffer.posBuffer.length/3;if(cE){this.primitive.connectivity=be.ConnectivityTypeEnum.TRIANGLES;this.primitive.count=(cI-2)*3;this.vertexBuffer.posBuffer=cu;for(var cG=1;cG<cI-1;cG++){this.primitive.indices.push(0);this.primitive.indices.push(cG);this.primitive.indices.push(cG+1)}}else{this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;this.primitive.count=2+(cI-2)*2;this.vertexBuffer.posBuffer=cu;for(var cG=1;cG<cI;++cG){this.primitive.indices.push(cm++);this.primitive.indices.push(cm)}}return true};var K=function(){bq.call(this);this.vertexBuffer=null;this.primitive=new bv();this.noRender=true};K.prototype=Object.create(bq.prototype);K.prototype.constructor=K;K.prototype.lineType=null;K.prototype.unstream=function(ct){this.unstreamPrimitive(ct);if(ct.getLightDataStreaming()){this.primitive.connectivity=be.ConnectivityTypeEnum.LINES;if(!this.vertexBuffer){this.vertexBuffer=new l()}var cr=this.vertexBuffer.posBuffer.length/3;this.primitive.start=this.primitive.indices.length;var cm=ct.readCompressedInt();var cp=ct.readCompressedInt();this.primitive.count=cm;switch(cp){case 0:this.primitive.count=cm;for(var cn=0;cn<cm;++cn){this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.primitive.indices.push(cr++)}break;case 1:this.primitive.count=2+(cm-2)*2;this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());for(var cn=1;cn<cm;++cn){this.primitive.indices.push(cr++);this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.primitive.indices.push(cr)}break;case 2:this.primitive.count=4+(cm-2)*2;var cl=cr;this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());for(var cn=1;cn<cm;++cn){this.primitive.indices.push(cr++);this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.vertexBuffer.posBuffer.push(ct.readFloat());this.primitive.indices.push(cr)}this.primitive.indices.push(cr);this.primitive.indices.push(cl);break;default:return null;break}if(cm==2){var cq=this.vertexBuffer.posBuffer.length-6;var co=this.vertexBuffer.posBuffer;var cs=(co[cq]-co[cq+3])*(co[cq]-co[cq+3]);cs+=(co[cq+1]-co[cq+4])*(co[cq+1]-co[cq+4]);cs+=(co[cq+2]-co[cq+5])*(co[cq+2]-co[cq+5]);if(cs>=1000000000000){this.primitive.noRender=true}}}};K.prototype.skip=function(cl){this.unstreamPrimitive(cl);if(cl.getLightDataStreaming()){var cm=cl.readCompressedInt();var cn=cl.readCompressedInt();if(cm>0){cl.skip(3*cm*4)}}};var bA=function(){K.call(this)};bA.prototype=Object.create(K.prototype);bA.prototype.constructor=bA;var q={CGR_STREAM_NO_COMPRESSION:0,CGR_STREAM_COMPRESS_POSITION_1:1,CGR_STREAM_COMPRESS_NORMAL_1:2,};var bO={SGV6_ATTRIBUTE_GAS:1,SGV6_ATTRIBUTE_TEXTURE_MATRIX:2,SGV6_ATTRIBUTE_RENDERING_MODE:4,SGV6_ATTRIBUTE_POINT_TYPE:8,SGV6_ATTRIBUTE_POINT_SIZE:16};var cg=function(){};var af=0;var t=[];cg.prototype.buildRep=function(c8,cm,cL){var cV=c8.posBuffer;var cC=c8.uvsBuffer;var cr=c8.binormalsBuffer;var co=c8.tangentsBuffer;var ct=c8.normalBuffer;var cD=c8.textureBuffer;var cy=cV.length/3;var c2=ct.length/3;for(var c5=0;c5<c2;c5++){t[c5]={normal:[ct[c5*3],ct[c5*3+1],ct[c5*3+2]],newIdx:c5,next:null}}for(var c5=c2;c5<cy;c5++){t[c5]=null}var cE=new be.Mesh();var cp=c2;var cx=0;var cJ=0;var cw=cm.length;var cT=0;for(c5=0;c5<cw;c5++){var cF=cm[c5];var cJ=cF.set.length;for(c3=0;c3<cJ;c3++){cT+=cF.set[c3].indices.length}}if(cT==0){return null}var cH=new Uint32Array(cT);var cU=0;for(c5=0;c5<cw;c5++){var cq=0;var cF=cm[c5];var c0=(cF.material==null)?cL.getCurrentMatId():cF.material;switch(cF.connectivity){case be.ConnectivityTypeEnum.TRIANGLES:cq=new be.DrawingGroup(be.convertToMaterial3js(cF.gas,2),c0,4,cU,cF.nbIndices,undefined,undefined,ap.GeomTypeEnum[cF.geomType]);break;case be.ConnectivityTypeEnum.LINES:cq=new be.DrawingGroup(be.convertToMaterial3js(cF.gas,1),c0,1,cU,cF.nbIndices,undefined,undefined,ap.GeomTypeEnum[cF.geomType]);break;case be.ConnectivityTypeEnum.POINTS:cq=new be.DrawingGroup(be.convertToMaterial3js(cF.gas,0),c0,0,cU,cF.nbIndices,undefined,undefined,ap.GeomTypeEnum[cF.geomType]);break;default:break}var cJ=cF.set.length;cq.primitives=new Array(cJ);for(var c3=0;c3<cJ;c3++){var cG=cU;var cv=cF.set[c3];var cN=cv.indices.length;var cK=cv.planarNormals;var cu=cv.planarNormals?cv.planarNormals.length:0;var c6=cv.indices;for(var c1=0;c1<cN;c1++){var c4=false;var da=c6[c1];var cW=null;var cS=0;if(cu>0||da>=c2){if(cu>0){cW=cK}var cn=t[da];while(cn!==null){if(cW==null){c4=true;cS=cn.newIdx;break}else{if((cn.normal[0]==cW[0])&&(cn.normal[1]==cW[1])&&(cn.normal[2]==cW[2])){c4=true;cS=cn.newIdx;break}}cn=cn.next}if(c4){cH[cU++]=cS}else{t[da]={normal:cW,newIdx:cp,next:t[da]};cH[cU++]=cp++}}else{cH[cU++]=da}}var cA=new be.MeshPrimitive(cv.cgmId,cq,cG,cN);if(cv.decoration){cA.decoration=cv.decoration}if(cv.boundingSphere){cA.boundingSphere=cv.boundingSphere}cq.primitives[c3]=cA}cE.drawingGroups.push(cq)}var cR=new Float32Array(3*cp);var cQ=new Float32Array(3*cp);var cB=null;if(c8.hasUVs){cB=new Float32Array(3*cp)}var cZ=null;if(c8.hasTangentsBinormals){cZ=new Float32Array(3*cp)}var df=null;if(c8.hasTangentsBinormals){df=new Float32Array(3*cp)}var cs=null;if(c8.hasTextures){cs=new Float32Array(3*cp)}var cz=ct.length;for(var c5=0;c5<cy;++c5){var cn=t[c5];while(cn!==null){var cl=3*c5;var cP=3*cn.newIdx;cR[cP]=cV[cl];cR[cP+1]=cV[cl+1];cR[cP+2]=cV[cl+2];if(cn.normal){cQ[cP]=cn.normal[0];cQ[cP+1]=cn.normal[1];cQ[cP+2]=cn.normal[2]}else{cQ[cP]=1;cQ[cP+1]=0;cQ[cP+2]=0}if(c8.hasUVs){cB[cP]=cC[cl];cB[cP+1]=cC[cl+1];cB[cP+2]=cC[cl+2]}if(c8.hasTangentsBinormals){cZ[cP]=cr[cl];cZ[cP+1]=cr[cl+1];cZ[cP+2]=cr[cl+2]}if(c8.hasTangentsBinormals){df[cP]=co[cl];df[cP+1]=co[cl+1];df[cP+2]=co[cl+2]}if(c8.hasTextures){cs[cP]=cD[cl];cs[cP+1]=cD[cl+1];cs[cP+2]=cD[cl+2]}cn=cn.next}}cE.vertexIndexArray=cH;cE.vertexPositionArray=cR;cE.vertexNormalArray=cQ;cE.vertexUvArray=cs;cE.vertexTangentArray=df;cE.vertexBinormalArray=cZ;var de=new ap.Color();var c9=new ap.Color();var cM=this.rep.repGas;var cX=(cM>>24)&255;var c7=(cM>>16)&255;var dc=(cM>>8)&255;var dd=(cM&255);de.setRGB(cX,c7,dc);c9.setRGB(cX,c7,dc);cE.gas.fill={color:de,opacity:dd};cE.gas.line={color:c9,opacity:dd,lineWidth:1};var db=[0,0,0];var cI=[0,0,0];var cO=cE.vertexPositionArray.length;if(cO>=3){db=[cE.vertexPositionArray[0],cE.vertexPositionArray[1],cE.vertexPositionArray[2]];cI=[cE.vertexPositionArray[0],cE.vertexPositionArray[1],cE.vertexPositionArray[2]];for(var cY=0;cY<cO;cY+=3){if(cE.vertexPositionArray[cY]<db[0]){db[0]=cE.vertexPositionArray[cY]}if(cE.vertexPositionArray[cY+1]<db[1]){db[1]=cE.vertexPositionArray[cY+1]}if(cE.vertexPositionArray[cY+2]<db[2]){db[2]=cE.vertexPositionArray[cY+2]}if(cE.vertexPositionArray[cY]>cI[0]){cI[0]=cE.vertexPositionArray[cY]}if(cE.vertexPositionArray[cY+1]>cI[1]){cI[1]=cE.vertexPositionArray[cY+1]}if(cE.vertexPositionArray[cY+2]>cI[2]){cI[2]=cE.vertexPositionArray[cY+2]}}}cE.AABB={min:db,max:cI};return cE};cg.prototype.resolvedInheritance=function(cu,cx){cx.globalMatrix=cu.getCurrentMatrix();if(cx.axis){var cm=cu.axisSystems.add(cx);cx.axisSystems=cm;cu.popMatId();cu.popGAS();return this}if(cx.refPlanes){var cm=cu.refPlanes.add(cx);cx.refPlaneInd=cm;return this}var cs=cu.getGAS();var cv=cs.getType();var cq=cs.isNoZ();var cn=cs.isHidden();var ct=cs.isSolid();var co=cu.getStaticMode();var cl=cs.getDisplayedColor();var cp=new ap.Color(cl[0]/255,cl[1]/255,cl[2]/255);var cr=(cl[3]/255||1);cx.gas.fill={color:cp,opacity:cr,solid:ct};cx.gas.line={color:cp,opacity:cr,lineWidth:cs.getLineThickness(),pattern:be.LinePatternEnum.SOLID};cx.gas.point={color:cp,opacity:cr,pointsize:1,symbol:1};this.rep.node.solid=ct;if(g&&cx.rep instanceof be.SGRep){cx.rep.boundingSphere=this.rep.boundingSphere}if(cq){cx.noZ=true}if(cn){cx.noShow=true}if(co){cx.attachedPoint=co}var cw=cu.addReps(cx,co,cq,this.rep.excludeFromBounding);if(cw){this.rep.renderType=cw.renderType;this.rep.repIndice=cw.indice}};cg.prototype.getCompressedRep=function(cl){if(this.rep.node.type){var cn=cl.sgRep;var cm=cl.nbRep++;cn.push(this.rep.node.cgmId+1);cn.push(this.rep.node.solid);cn.push(this.rep.node.namingContext);if(aM){cn.push(this.rep.node.sag)}if(g){cn.push(this.rep.boundingSphere.radius);cn.push(this.rep.boundingSphere.center[0]);cn.push(this.rep.boundingSphere.center[1]);cn.push(this.rep.boundingSphere.center[2])}this.rep.node=cm;return cm}else{return this.rep.node}};cg.prototype.addMesh=function(cl){var cm=this.build(cl);if(cm==null){cl.popMatId();cl.popGAS();return null}this.resolvedInheritance(cl,cm);cm.rep=this.getCompressedRep(cl);cl.popMatId();cl.popGAS();return this};var aH=function(){cg.call(this);this.rep=new D()};aH.prototype=Object.create(cg.prototype);aH.prototype.constructor=aH;var bx=function(){cg.call(this);this.rep=new aL()};bx.prototype=Object.create(cg.prototype);bx.prototype.constructor=bx;var d=function(cl){cl=cl||{};this.repInheritanceMode=cl.repInheritanceMode!==undefined?cl.repInheritanceMode:0;this.repGAS=cl.repGAS!==undefined?cl.repGAS:0;this.materialInheritance=cl.materialInheritance!==undefined?cl.materialInheritance:0;this.material=cl.material!==undefined?cl.material:{file:"",id:-1};this.noShow=cl.noShow!==undefined?cl.noShow:false;this.boundingSphere=null;this.renderType=cl.renderType!==undefined?cl.renderType:0};d.prototype.unstream=function(cr){this.namingContext=0;this.repInheritanceMode=cr.readCompressedInt();this.repGAS=cr.readGraphicAttributeSet();cr.pushGAS(this.repGAS,this.repInheritanceMode);this.material={file:"",id:-1};this.materialInheritance=0;var cl=cr.readCompressedInt();var cq=cr.readCompressedInt();var cm=cr.readFloat();var co=cr.readFloat();var ct=cr.readFloat();var cn=cr.readFloat();var cp=(co-cm)*(co-cm)+(cn-ct)*(cn-ct);cp=0.5*Math.sqrt(cp);this.boundingSphere={radius:cp,center:[0.5*(co+cm),0.5*(cn+ct),0]};if(cr.version>=1101303){var cs=cr.readFloat()}};d.prototype.childClone=function(){var cl=new Array();for(var cm in this.children){cl[cm]=typeof(this.children[cm])=="object"?this.children[cm].clone():this.children[cm]}return cl};var aL=function(cl){cl=cl||{};d.call(this,cl);this.node=cl.node!==undefined?cl.node:new be.SGRep()};aL.prototype=Object.create(d.prototype);aL.prototype.constructor=aL;aL.prototype.clone=function(){return new aL({renderType:this.renderType,node:this.node,namingContext:this.namingContext,materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var M=function(cl){cl=cl||{};d.call(this,cl);this.node=cl.node!==undefined?cl.node:new be.SGBag();this.children=cl.children!==undefined?this.childClone(cl.children):[]};M.prototype=Object.create(d.prototype);M.prototype.constructor=M;M.prototype.clone=function(){return new M({children:this.childClone(),node:this.node.clone(),materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var b8=function(cl){cl=cl||{};this.repInheritanceMode=cl.repInheritanceMode!==undefined?cl.repInheritanceMode:0;this.repGAS=cl.repGAS!==undefined?cl.repGAS:0;this.materialInheritance=cl.materialInheritance!==undefined?cl.materialInheritance:0;this.material=cl.material!==undefined?cl.material:{file:"",id:-1};this.layer=cl.layer!==undefined?cl.layer:aw.LAYER_MAX;this.noShow=cl.noShow!==undefined?cl.noShow:false;this.boundingSphere=null};b8.prototype.unstream=function(cv){this.namingContext=0;this.repInheritanceMode=cv.readCompressedUInt();this.repGAS=cv.readGraphicAttributeSet();var cq=cv.pushGAS(this.repGAS,this.repInheritanceMode);if(cq.isHidden()){this.noShow=true}if(cq.getType()==0){this.noZ=true}this.material={file:"",id:-1};this.materialInheritance=0;var cl=cv.readCompressedInt();if(cl==2){this.excludeFromBounding=true}var cs=cv.readCompressedInt();var cp=cv.readFloat();var cA=cv.readFloat();var cx=cv.readFloat();var cw=cv.readFloat();var cu=cv.readFloat();this.boundingSphere={radius:cp,center:[cx,cw,cu]};if(cv.version>1100800){this.node.cgmId=cv.readUncompressedInt();cv.readUnsignedShort();if(cv.version>1101020){this.namingContext=cv.readUnsignedChar();this.node.namingContext=this.namingContext}}var cr=cv.readUnsignedChar();if(cr){var cB=this.materialApplicationUnstream(cv,aw.STREAM_MATERIAL|aw.STREAM_INHERIT_INT);this.material=cB.material;this.materialInheritance=cB.inheritanceMaterial}if(cv.version>=210041800){var cm=cv.readUnsignedChar();if(cm){var cB=this.materialApplicationUnstream(cv,aw.STREAM_LAYER_ULONG|aw.STREAM_UVTRANSFO|aw.STREAM_MAPPING_INFO);if(cB.mapping){var cz=cv.materials.get([this.material.id]);cz.mapping=cB.mapping}this.layer=cB.layer;var cn=cv.readCompressedUInt();if(cn>0){for(var co=0;co<cn;++co){var cB=this.materialApplicationUnstream(cv,aw.STREAM_ALL_ULONG);if(cB.mapping){var cz=cv.materials.get([cB.material.id]);cz.mapping=cB.mapping}if(cB.layer<this.layer||(cB.layer==this.layer&&cB.inheritanceMaterial>=this.materialInheritance)){this.layer=cB.layer;this.material=cB.material;this.materialInheritance=cB.inheritanceMaterial}}}}}cv.pushMatId(this.material,this.materialInheritance,this.layer);if(cv.version>=210041910){var cy=cv.readUnsignedChar();if(cy){var ct=[];cv.readBytes(6,ct)}}};b8.prototype.materialApplicationUnstream=function(cp,cm){var cl={material:null,inheritanceMaterial:1,layer:0};if(cm&aw.STREAM_MATERIAL){cl.material=this.unstreamMaterial(cp)}if(cp.version>=1100500){if(cm&aw.STREAM_INHERIT_INT){cl.inheritanceMaterial=cp.readCompressedInt()}else{if(cm&aw.STREAM_INHERIT_UINT){cl.inheritanceMaterial=cp.readCompressedInt()}else{if(cm&aw.STREAM_INHERIT_ULONG){cl.inheritanceMaterial=cp.readUncompressedInt()}}}}else{if(cm&(aw.STREAM_INHERIT_INT|aw.STREAM_INHERIT_UINT|aw.STREAM_INHERIT_ULONG)){cl.inheritanceMaterial=1}}if(cm&aw.STREAM_LAYER_INT){cl.layer=cp.readUncompressedInt()}else{if(cm&aw.STREAM_LAYER_UINT){cl.layer=cp.readUncompressedInt()}else{if(cm&aw.STREAM_LAYER_ULONG){cl.layer=cp.readUncompressedUInt()}}}if(cm&aw.STREAM_UVTRANSFO){var cr=false;if(cp.version>=210041900){var cr=cp.readBoolean();if(cr){cp.readFloat();cp.readFloat();cp.readFloat();cp.readFloat()}}}if(cm&aw.STREAM_MAPPING_INFO){if(cp.version>=210042100){var cs=cp.readBoolean();if(!cs){var cn=cp.readStringWithLength();cn=JSON.parse(cn);cn=cn.mappings[cn.uvSlots.Default];cl.mapping={type:0,ObjectTransformation:null,UvTransformation:null};if(cn.uvTransform){cl.mapping.UvTransformation=cp.createMatrix3(cn.uvTransform)}if(cn.operator){var co=cn.operator.type;if(co=="PLANAR"){cl.mapping.type=1}else{if(co=="SPHERICAL"){cl.mapping.type=2}else{if(co=="SPHERICAL_NORMALIZED"){cl.mapping.type=3}else{if(co=="CUBIC"){cl.mapping.type=4}else{if(co=="CYLINDRICAL"||co=="FINITE_CYLINDRICAL"){cl.mapping.type=5}else{if(co=="INFINITE_CYLINDRICAL"){cl.mapping.type=6}else{if(co=="INFINITE_CYLINDRICAL_NORMALIZED"){cl.mapping.type=7}}}}}}}if(cn.operator.transform){var cq=cn.operator.transform;cl.mapping.ObjectTransformation=cq}}}}}return cl};b8.prototype.unstreamMaterial=function(cu){var ct={file:"",id:-1};var cv=0;var cm=cu.readUnsignedChar();var cn=0;var cs=null;var cq=null;if(cm){cn=cu.readCompressedInt();if(cu.materials.isValidMultiRefIndexWithName(cn,cu.name)){var cr=cu.materials.getIndexWithName(cn,cu.name);ct={file:"",id:cr};return ct}}if(cu.version>=210021320){var cw=cu.readCompressedInt();if(cw===1){cq=new av()}else{if(cw===4){cq=new aC()}else{if(cw===9&&cu.version>=210042100){cq=new aK()}else{cq=new u()}}}}else{cq=new u()}cs=cq.unstream(cu);var cl=cu.getCurrentPosition();var co=cu.getBytesRemain();if(co>32){co=32}var cp=cu.readString(co);cu.setCurrentPosition(cl);if(cp.indexOf('{\n"Version" : ')!==-1){fakeUnstreamer=new aC();fakeUnstreamer.skip(cu)}if(cw===1){var cr=cs}else{var cr=cu.materials.add(cs)}ct={file:"",id:cr};if(cm){cu.materials.addMultiRefIndexWithName(cn,cr,cu.name)}return ct};b8.prototype.childClone=function(){var cl=new Array();for(var cm in this.children){cl[cm]=typeof(this.children[cm])=="object"?this.children[cm].clone():this.children[cm]}return cl};var D=function(cl){cl=cl||{};b8.call(this,cl);this.node=cl.node!==undefined?cl.node:new be.SGRep();this.namingContext=cl.namingContext!==undefined?cl.namingContext:0;this.repIndice=cl.repIndice!==undefined?cl.repIndice:-1;this.renderType=cl.renderType!==undefined?cl.renderType:0};D.prototype=Object.create(b8.prototype);D.prototype.constructor=D;D.prototype.clone=function(){return new D({renderType:this.renderType,repIndice:this.repIndice,node:this.node,namingContext:this.namingContext,materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var aW=function(cl){cl=cl||{};b8.call(this,cl);this.node=cl.node!==undefined?cl.node:new be.SGBag();this.children=cl.children!==undefined?cl.children:[]};aW.prototype=Object.create(b8.prototype);aW.prototype.constructor=aW;aW.prototype.clone=function(){return new aW({children:this.childClone(),node:this.node.clone(),materialInheritance:this.materialInheritance,currentMatId:this.currentMatId,material:this.material,repGAS:this.repGAS,repInheritanceMode:this.repInheritanceMode,noShow:this.noShow})};var e=function(){aH.call(this);this.primitiveSets=[];this.vertexBuffer=null;this.primitiveAxis=[];this.axisSystems=[];this.refPlane=[];this.useTexture=false;this.hasTangentsBinormals=false;this.gpList=[]};e.prototype=Object.create(aH.prototype);e.prototype.constructor=e;e.prototype.checkGP=function(cr,cl){for(var cq=0;cq<this.gpList.length;cq++){this.mergeGP(this.gpList[cq].gp,this.gpList[cq].att)}if(this.primitiveAxis.length){if(cl&&cl.isMonoPlane){var cm=this.primitiveAxis[0].gp.primitive;var co=this.primitiveAxis[0].att.fill.color;var cn=[co.r,co.g,co.b,co.a];if(this.primitiveAxis[0].gp instanceof aA){var cs=this.getCompressedRep(cr);this.refPlane.push({rep:cs,origin:cm.origin,xAxis:cm.direction1,yAxis:cm.direction2,color:cn,length:cm.length,mode:cm.mode,zoomable:cl.mode===1});this.primitiveAxis=[]}}for(var cq=0;cq<this.primitiveAxis.length;cq++){if(this.primitiveAxis[cq].gp instanceof ch||this.primitiveAxis[cq].gp instanceof K){this.primitiveAxis[cq].gp.noRender=false;var cp=this.primitiveAxis[cq].gp.vertexBuffer;if(cp){this.useTexture=cp.hasTextures?cp.hasTextures:false;this.hasTangentsBinormals=cp.hasTangentsBinormals?cp.hasTangentsBinormals:false}this.mergeGP(this.primitiveAxis[cq].gp,this.primitiveAxis[cq].att)}}}};e.prototype.addGP=function(cn,cs,cq,cm){if(cn.noRender){this.primitiveAxis.push({gp:cn,att:cs});if(this.rep.namingContext==2&&this.primitiveAxis.length==7&&this.primitiveAxis[0].gp instanceof ch&&this.primitiveAxis[1].gp instanceof L&&this.primitiveAxis[2].gp instanceof L&&this.primitiveAxis[3].gp instanceof L&&this.primitiveAxis[4].gp instanceof aA&&this.primitiveAxis[5].gp instanceof aA&&this.primitiveAxis[6].gp instanceof aA){var cl=this.primitiveAxis[0].att.fill.color;var co=[cl.r*255,cl.g*255,cl.b*255,cl.a*255];var cr=this.primitiveAxis[0].gp.vertexBuffer.posBuffer;var cv=this.primitiveAxis[0].gp.primitive.indices;var cu=[cr[cv[0]],cr[cv[0]+1],cr[cv[0]+2]];var ct=this.getCompressedRep(cq);this.axisSystems.push({rep:ct,origin:cu,xAxis:this.primitiveAxis[1].gp.primitive.direction,yAxis:this.primitiveAxis[2].gp.primitive.direction,zAxis:this.primitiveAxis[3].gp.primitive.direction,refPlanes:[this.primitiveAxis[4].gp.primitive,this.primitiveAxis[5].gp.primitive,this.primitiveAxis[6].gp.primitive],color:co,zoomable:false});this.primitiveAxis=[]}if(this.rep.namingContext==2&&this.primitiveAxis.length==7&&this.primitiveAxis[0].gp instanceof ch&&this.primitiveAxis[1].gp instanceof R&&this.primitiveAxis[2].gp instanceof R&&this.primitiveAxis[3].gp instanceof R&&this.primitiveAxis[4].gp instanceof K&&this.primitiveAxis[5].gp instanceof K&&this.primitiveAxis[6].gp instanceof K){var cl=this.primitiveAxis[0].att.fill.color;var co=[cl.r*255,cl.g*255,cl.b*255,cl.a*255];var cr=this.primitiveAxis[0].gp.vertexBuffer.posBuffer;var cv=this.primitiveAxis[0].gp.primitive.indices;var cu=[cr[cv[0]],cr[cv[0]+1],cr[cv[0]+2]];var ct=this.getCompressedRep(cq);this.axisSystems.push({rep:ct,origin:cu,xAxis:this.primitiveAxis[1].gp.primitive.direction,yAxis:this.primitiveAxis[2].gp.primitive.direction,zAxis:this.primitiveAxis[3].gp.primitive.direction,refPlanes:[this.primitiveAxis[4].gp.vertexBuffer.posBuffer,this.primitiveAxis[5].gp.vertexBuffer.posBuffer,this.primitiveAxis[6].gp.vertexBuffer.posBuffer],color:co,zoomable:true,length:cm.axisLength});this.primitiveAxis=[]}return}var cp=cn.vertexBuffer;if(cp){this.useTexture=cp.hasTextures?cp.hasTextures:false;this.hasTangentsBinormals=cp.hasTangentsBinormals?cp.hasTangentsBinormals:false}this.gpList.push({gp:cn,att:cs})};e.prototype.mergeGP=function(cm,cu){var cq=cm.primitive;var cv=undefined;if(this.rep.namingContext==2&&cm instanceof ch){cv="FREE_POINT"}var ct=this.primitiveSets.length;for(var cn=0;cn<ct;cn++){var cl=this.primitiveSets[cn];if((cl.connectivity==cq.connectivity)&&be.isEqualGAS(cl.gas,cu)&&((cl.material==null&&cq.material==null)||(cl.material.id==cq.material.id&&cl.material.file==cq.material.file))&&(typeof cv==="undefined"||cl.geomType===cv)){cl.set.push(cq);cl.nbIndices+=cq.indices.length;break}}if(cn==this.primitiveSets.length){var cw={};cw.connectivity=cq.connectivity;cw.gas=cu;cw.material=cq.material;cw.nbIndices=cq.indices.length;cw.more_indices=0;cw.set=[];if(cv){cw.geomType=cv}cw.set.push(cq);this.primitiveSets.push(cw)}if(this.vertexBuffer==null){this.vertexBuffer=new l();this.vertexBuffer.hasTextures=this.useTexture;this.vertexBuffer.hasUVs=false;this.vertexBuffer.hasTangentsBinormals=this.hasTangentsBinormals}var cs=cm.vertexBuffer;var cr=cq.indices;var co=this.vertexBuffer.posBuffer.length/3;for(var cp=0;cp<cr.length;cp++){cr[cp]=cr[cp]+co}for(var cp=0;cp<cs.posBuffer.length;cp++){this.vertexBuffer.posBuffer.push(cs.posBuffer[cp]);if(cs.normalBuffer.length){this.vertexBuffer.normalBuffer.push(cs.normalBuffer[cp])}else{this.vertexBuffer.normalBuffer.push(0)}if(this.useTexture){if(cs.textureBuffer.length){this.vertexBuffer.textureBuffer.push(cs.textureBuffer[cp])}else{this.vertexBuffer.textureBuffer.push(0)}}if(this.hasTangentsBinormals){if(cs.tangentsBuffer.length){this.vertexBuffer.tangentsBuffer.push(cs.tangentsBuffer[cp])}else{this.vertexBuffer.tangentsBuffer.push(0)}if(cs.binormalsBuffer.length){this.vertexBuffer.binormalsBuffer.push(cs.binormalsBuffer[cp])}else{this.vertexBuffer.binormalsBuffer.push(0)}}}};e.prototype.build=function(cl){if(this.axisSystems.length>0){return{axis:this.axisSystems[0]}}if(this.primitiveSets.length==0){if(this.refPlane&&this.refPlane.length>0){return{refPlanes:this.refPlane}}return null}var cm=this.buildRep(this.vertexBuffer,this.primitiveSets,cl);if(this.refPlane.length>0){cm.refPlanes=this.refPlane}return cm};var P=function(){aH.call(this);this.vertexBuffer=null;this.nbLODFaces=0;this.lods=[];this.lodsAttributes=[];this.sag=0;this.sags=[];this.nbSets=0;this.sets=[];this.posInNextStreamer=0};P.prototype=Object.create(aH.prototype);P.prototype.constructor=P;P.prototype.getSet=function(co){var cl=[];for(var cn=0;cn<this.sets.length;cn++){if(this.sets[cn].geomType==co){var cp=this.sets[cn].primitives;for(var cm=0;cm<cp.length;cm++){cl.push(cp[cm])}}}return cl};P.prototype.unStreamFaces=function(cm){var cn=cm.readUnsignedChar();if(cn){if(cm.version>=2100180){var cl=cm.readUnsignedChar();switch(cl){case 2:this.sets[0]=new n();break;case 3:this.sets[0]=new aJ();break;default:this.sets[0]=null;break}}else{this.sets[0]=new n()}if(this.sets[0]){this.sets[0].unstream(cm)}}};P.prototype.build=function(cM){var cG,cF,cC,cz,cN,cD=0,cs=0,cr=0,cB,cx,cm,cE=false,cu,cA,cI,cy,cH,co,cx=null,cp=0;var cn=this.vertexBuffer!==null?true:false;var cq=this.rep.repGAS.getType();var cJ=this.rep.repGAS.isSolid();var cL=[];if(this.nbSets==0){return null}for(cG=0;cG<this.nbSets;cG++){if(this.sets[cG].primitive){cN=1;cH=[this.sets[cG].primitive]}else{cN=this.sets[cG].primitives.length;cH=this.sets[cG].primitives}for(cF=0;cF<cN;cF++){cz=cH[cF];if(!cz){continue}if(cz.posBuffer){if(!this.vertexBuffer){this.vertexBuffer=new l()}var cl=cz.indices;var ct=this.vertexBuffer.posBuffer.length/3;for(var cC=0;cC<cl.length;cC++){cl[cC]=cl[cC]+ct}for(var cC=0;cC<cz.posBuffer.length;cC++){this.vertexBuffer.posBuffer.push(cz.posBuffer[cC]);if(cz.normalBuffer&&cz.normalBuffer.length){this.vertexBuffer.normalBuffer.push(cz.normalBuffer[cC])}else{this.vertexBuffer.normalBuffer.push(0)}}}else{if(!cn){continue}}cp+=cz.indices.length;if(cz.planarNormals&&cz.planarNormals.length>0){cs+=cz.indices.length}var cv=cL.length;for(cC=0;cC<cv;cC++){var cK=cL[cC];if((cK.connectivity==cz.connectivity)&&(cK.geomType==this.sets[cG].geomType)&&be.isEqualGAS(cK.gas,cz.gas)&&be.isEqualMaterial(cK.material,cz.material)){cK.set.push(cz);cK.nbIndices+=cz.indices.length;break}}if(cC==cL.length){var cw={};cw.connectivity=cz.connectivity;cw.gas=cz.gas;cw.geomType=this.sets[cG].geomType;cw.material=cz.material;cw.nbIndices=cz.indices.length;cw.more_indices=0;cw.set=[];cw.set.push(cz);cL.push(cw)}}}if(!this.vertexBuffer){return this.buildRep(vertexBuffer,cL,cM)}else{return this.buildRep(this.vertexBuffer,cL,cM)}};var bw=function(){P.call(this)};bw.prototype=Object.create(P.prototype);bw.prototype.constructor=bw;var cj=function(){aH.call(this);this.gp=[]};cj.prototype=Object.create(aH.prototype);cj.prototype.constructor=cj;cj.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var S=function(){aH.call(this);this.gp=[]};S.prototype=Object.create(aH.prototype);S.prototype.constructor=S;S.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var Z=function(){aH.call(this);this.refPlane=[]};Z.prototype=Object.create(aH.prototype);Z.prototype.constructor=Z;Z.prototype.build=function(cl){if(this.refPlane){return{refPlanes:this.refPlane}}};var am=function(){aH.call(this);this.vertexBuffer=null;this.sets=[]};am.prototype=Object.create(aH.prototype);am.prototype.constructor=am;am.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cm=ct.getDisplayedColor();var co=new ap.Color;co.setRGB(cm[0]/255,cm[1]/255,cm[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cs={color:co,opacity:cm[3]/255,solid:cu};var cq=new be.DrawingGroup(cs,cv,4,0,this.sets[0].indices.length);var cn=new be.MeshPrimitive(this.sets[0].node.cgmId,cq,0,this.sets[0].indices.length);if(this.sets[0].decoration){cn.decoration=this.sets[0].decoration}if(this.sets[0].boundingSphere){cn.boundingSphere=this.sets[0].boundingSphere}cq.primitives.push(cn);cz.drawingGroups.push(cq);cz.vertexIndexArray=this.sets[0].indices;cz.vertexPositionArray=this.vertexBuffer.posBuffer;cz.vertexNormalArray=this.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cl=this.sets[0].boundingBoxCenter;var cr=this.sets[0].boundingBoxDim;var cp=[cl[0]-cr[0],cl[1]-cr[1],cl[2]-cr[2]];var cy=[cl[0]+cr[0],cl[1]+cr[1],cl[2]+cr[2]];cz.AABB={min:cp,max:cy};return cz};var al=function(){aH.call(this);this.sets=[]};al.prototype=Object.create(aH.prototype);al.prototype.constructor=al;al.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cm=ct.getDisplayedColor();var co=new ap.Color;co.setRGB(cm[0]/255,cm[1]/255,cm[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cs={color:co,opacity:cm[3]/255,solid:cu};var cq=new be.DrawingGroup(cs,cv,4,0,this.sets[0].indices.length);var cn=new be.MeshPrimitive(this.sets[0].node.cgmId,cq,0,this.sets[0].indices.length);if(this.sets[0].decoration){cn.decoration=this.sets[0].decoration}if(this.sets[0].boundingSphere){cn.boundingSphere=this.sets[0].boundingSphere}cq.primitives.push(cn);cz.drawingGroups.push(cq);cz.vertexIndexArray=this.sets[0].indices;cz.vertexPositionArray=this.vertexBuffer.posBuffer;cz.vertexNormalArray=this.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cl=this.sets[0].boundingBoxCenter;var cr=this.sets[0].boundingBoxDim;var cp=[cl[0]-cr[0],cl[1]-cr[1],cl[2]-cr[2]];var cy=[cl[0]+cr[0],cl[1]+cr[1],cl[2]+cr[2]];cz.AABB={min:cp,max:cy};return cz};var bz=function(){aH.call(this);this.pointPrimimitivesSets=[];this.edgePrimitivesSets=[];this.vertexBuffer=null;this.indexBuffer=[];this.nbElEdge=0;this.nbElPoints=0;this.nbIndicesTotal=0};bz.prototype=Object.create(aH.prototype);bz.prototype.constructor=bz;bz.prototype.build=function(ct){var cs=ct.getCurrentMatId();if(this.pointPrimimitivesSets.length||this.edgePrimitivesSets.length){var cw=new be.Mesh();var cm=this.vertexBuffer.posBuffer.length;cw.vertexPositionArray=new Float32Array(cm);for(var cq=0;cq<cm;cq++){cw.vertexPositionArray[cq]=this.vertexBuffer.posBuffer[cq]}cw.vertexNormalArray=new Float32Array(cm);for(var cq=0;cq<cm;cq++){cw.vertexNormalArray[cq]=0}cw.vertexIndexArray=new Uint32Array(this.nbIndicesTotal);var cl=0;if(this.nbElEdge>0){for(var cq=0;cq<this.edgePrimitivesSets.length;cq++){var cv=this.edgePrimitivesSets[cq];var cp=new be.DrawingGroup(be.convertToMaterial3js(cv.attr,1),cs,1,cl,cv.nbIndices,undefined,undefined,ap.GeomTypeEnum.WIRE_EDGE);cw.drawingGroups.push(cp);var cu=cv.set;for(var co=0;co<cu.length;co++){var cr=cu[co];cp.primitives.push(cr);for(var cn=0;cn<cr.count;cn++){cw.vertexIndexArray[cl++]=this.indexBuffer[cr.start+cn]}}}}if(this.nbElPoints){for(var cq=0;cq<this.pointPrimimitivesSets.length;cq++){var cv=this.pointPrimimitivesSets[cq];var cp=new be.DrawingGroup(be.convertToMaterial3js(cv.attr,0),cs,0,cl,cv.nbIndices,undefined,undefined,ap.GeomTypeEnum.BOUNDARY_POINT);cw.drawingGroups.push(cp);var cu=cv.set;for(var co=0;co<cu.length;co++){var cr=cu[co];cr.attr=cv.attr;cp.primitives.push(cr);for(var cn=0;cn<cr.count;cn++){cw.vertexIndexArray[cl++]=this.indexBuffer[cr.start+cn]}}}}return cw}return null};var z=function(){};z.prototype.unstream=function(cm){var cl=cm.readCompressedInt();if(cl<0){cl=-cl-2}cm.skip(cl-4)};var w={LOD0:0,LOD1:1,LOD2:2,LOD3:3,FACES:4,LSG:5};var b5=["BOUNDARY_EDGE","SHARP_EDGE","SMOOTH_EDGE","BOUNDARY_POINT","SHARP_POINT","SMOOTH_POINT","SURFACIC_POINT","FREE_POINT","WIRE_EDGE","INFINITE_FACE","FACE","EDGE","UNKNOWN"];var bv=function(){this.indices=[];this.cgmId=-1;this.count=0;this.start=0;this.connectivity=be.ConnectivityTypeEnum.TRIANGLES;this.gas=null;this.decoration=0;this.boundingSphere=null};var Y=function(){bv.call(this);this.planarNormals=null};Y.prototype=Object.create(bv.prototype);Y.prototype.constructor=Y;var bh=[];var a4=[];var m=[];Y.prototype.unstream=function(cJ){var cD=cJ.readUnsignedChar();var cF=cD&1;var cG=cD&2;var cx=cD&4;var cB=cD&8;var cH=cJ.isLightScenegraph();if(cH){}else{}var ct=0;if(cF){ct=cJ.readCompressedInt()}var cI=3*ct;var cu=0;if(cG){cu=cJ.readCompressedInt()}var cn=0;if(cx){cn=cJ.readCompressedInt()}var co=cJ.readCompressedInt();var cr=0;var cq=0;if(cB){this.planarNormals=new Array(3);cJ.readFloatArray(0,3,this.planarNormals)}var cv=ct;var cm=cJ.version>=2100170||(cJ.version>=1101910&&cJ.version<2100000);var cs=0;var cE=0;if(cm){for(var cC=0;cC<cu;++cC){var cw=cJ.readCompressedInt();bh[cC]=cw;cE+=cw;cv+=cw-2}for(var cC=0;cC<cn;++cC){var cl=cJ.readCompressedInt();a4[cC]=cl;cs+=cl;cv+=cl-2}}else{for(var cC=0;cC<cu;++cC){var cw=cJ.unpackc();bh[cC]=cw;cE+=cw;cv+=cw-2}for(var cC=0;cC<cn;++cC){var cl=cJ.unpackc();a4[cC]=cl;cs+=cl;cv+=cl-2}}if(cv<=0){return}this.indices=new Array(3*cv);var cy=3*ct;cJ.unpackcArray(cy,this.indices,0);cJ.unpackcArray(cE+cs,m,0);var cz=0;for(var cC=0;cC<cu;++cC){var cw=bh[cC];cz+=2;for(var cA=2;cA<cw;++cA){if(cA%2){this.indices[cy++]=m[cz];this.indices[cy++]=m[cz-1];this.indices[cy++]=m[cz-2]}else{this.indices[cy++]=m[cz-1];this.indices[cy++]=m[cz];this.indices[cy++]=m[cz-2]}cz++}}for(var cC=0;cC<cn;++cC){var cp=cz;var cl=a4[cC];cz+=2;for(var cA=2;cA<cl;++cA){this.indices[cy++]=m[cp];this.indices[cy++]=m[cz-1];this.indices[cy++]=m[cz];cz++}}};var aB=function(){};aB.prototype.unstream=function(cp){var cn=cp.getNumberOfVertices();var cl=cp.unpackc();cp.setNumberOfVertices(cl);var co=new Y();var cm=co.unstream(cp);cp.setNumberOfVertices(cn);return cm};var J=function(){bv.call(this);this.connectivity=be.ConnectivityTypeEnum.LINES};J.prototype=Object.create(bv.prototype);J.prototype.constructor=J;var bg=[];J.prototype.unstream=function(cp){var co=cp.readCompressedInt();if(co>0){cp.unpackcArray(co,bg,0);var cq=1;if(co>1){this.indices=new Array(2*(co-1));var cl=0;this.indices[0]=bg[0];for(var cn=2;cn<co;++cn){var cm=bg[cn-1];this.indices[cq++]=cm;this.indices[cq++]=cm}this.indices[cq++]=bg[co-1]}else{this.indices=[]}}if(cp.version>=210021300){cp.readBoolean()}};var bb=function(){bv.call(this);this.connectivity=be.ConnectivityTypeEnum.LINES;this.posBuffer=[]};bb.prototype=Object.create(bv.prototype);bb.prototype.constructor=bb;bb.prototype.unstream=function(co){var cn=co.readCompressedInt();var cl=co.readCompressedInt();var cp=0;if(cn){switch(cl){case 0:for(var cm=0;cm<cn;++cm){this.indices.push(cp++);this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat())}break;case 1:this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat());for(var cm=1;cm<cn;++cm){this.indices.push(cp++);this.indices.push(cp);this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat())}break;case 2:for(var cm=0;cm<cn;++cm){this.indices.push(cp++);this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat());this.posBuffer.push(co.readFloat())}this.indices.push(0);break}}};var bP=function(){bv.call(this);this.connectivity=be.ConnectivityTypeEnum.POINTS;this.posBuffer=null;this.symbol=0};bP.prototype=Object.create(bv.prototype);bP.prototype.constructor=bP;bP.prototype.unstream=function(cm){this.symbol=cm.readCompressedInt();this.start=this.indices.length;this.connectivity=be.ConnectivityTypeEnum.POINTS;var cn=cm.readCompressedInt();this.posBuffer=new Array(3*cn);cm.readFloatArray(0,3*cn,this.posBuffer);for(var cl=0;cl<cn;++cl){this.indices.push(cl)}};var at=function(){bv.call(this);this.connectivity=be.ConnectivityTypeEnum.TRIANGLES;this.posBuffer=[]};at.prototype=Object.create(bv.prototype);at.prototype.constructor=at;at.prototype.unstream=function(cw){var cu=cw.readFloat();var cs=cw.readFloat();var cq=cw.readFloat();var ct=cw.readFloat();var cr=cw.readFloat();var cp=cw.readFloat();var cn=cw.readFloat();var cm=cw.readFloat();var cl=cw.readFloat();var co=cw.readFloat();var cv=cw.readUnsignedChar()};var j=function(cl){cg.call(this);this.rep=new aW(cl)};j.prototype=Object.create(cg.prototype);j.prototype.constructor=j;j.prototype.unstream=function(cu){this.rep.unstream(cu);if(cu.version>=1000800){var cv=cu.readUnsignedChar();if(cv){this.rep.node.matrix=cu.readMatrix()}}cu.pushMatrix(this.rep.node.matrix);var cs=cu.readCompressedInt();for(var cp=0;cp<cs;++cp){var cx=cu.readUnsignedChar();if(cx==aG){var cm=-1;var cn=cu.readCompressedInt();if(cu.multiRefNode.isValidIndex(cn)){cw=cu.multiRefNode.get(cn);if(cw){if(!cu.expandCGR&&!this.rep.noShow){var ct=cw.clone();this.addMesh(ct,false,cu);this.rep.children.push(ct);continue}this.rep.children.push(cw)}}else{var cr=cu.readClassName();var co=cu.getUnstreamer(cr);if(cu.error){return false}var cw=co.unstream(cu,this.rep.noShow);if(cu.error){return false}cu.multiRefNode.addAt(cw,cn);if(cw){this.rep.children.push(cw)}}}else{var cr=cu.readClassName();var co=cu.getUnstreamer(cr);if(cu.error){return false}var cl=co.unstream(cu,this.rep.noShow);if(cu.error){return false}if(cl){this.rep.children.push(cl)}}}if(cu.version>=210021330){var cq=cu.readUnsignedChar();if(cq){cu.skip(16)}}cu.popMatId();cu.popGAS();cu.popMatrix();return this.rep};j.prototype.getCompressedRep=function(cl){var cn=cl.sgRep;var cm=cl.nbRep++;cn.push(this.rep.node.cgmId+1);cn.push(this.rep.node.solid);cn.push(this.rep.node.namingContext);if(aM){cn.push(this.rep.node.sag)}if(g){cn.push(this.rep.boundingSphere.radius);cn.push(this.rep.boundingSphere.center[0]);cn.push(this.rep.boundingSphere.center[1]);cn.push(this.rep.boundingSphere.center[2])}return cm};j.prototype.getCompressedRepMulti=function(cn,cr){var cq=cn.sgRep;var co=cn.nbRep++;var cl=3;if(g){cl+=4}if(aM){cl+=1}var cp=cr*cl;for(var cm=0;cm<cl;cm++){cq.push(cq[cp++])}return co};j.prototype.addMesh=function(cl,co,cr){var cv=!co;if(cl){if(cl.noShow){return}if(cv){cr.pushGAS(cl.repGAS,cl.repInheritanceMode);cr.pushMatrix(cl.node.matrix);cr.pushMatId(cl.material,cl.materialInheritance,cl.layer)}if(cl instanceof D){var ct=null;if(cl.repIndice!==-1){var cu=cr.getReps(cl.repIndice,cl.renderType);if(cu.noZ){var cq=cr.popGAS();cq.inherited.setType(0);cr.pushGAS(cq.inherited,cq.inh_mode)}ct=cu.clone();ct.rep=this.getCompressedRepMulti(cr,cl.node);for(var cn=0;cn<ct.drawingGroups.length;++cn){var cs=ct.drawingGroups;if(!(cs[cn].material&&cs[cn].material.primWithMaterials)){cs[cn].material=cr.getCurrentMatId()}}}if(cl.axisSystems){var cu=cr.axisSystems.get(cl.axisSystems);var cm=cu.axis;ct={axis:{origin:[cm.origin[0],cm.origin[1],cm.origin[2]],xAxis:[cm.xAxis[0],cm.xAxis[1],cm.xAxis[2]],yAxis:[cm.yAxis[0],cm.yAxis[1],cm.yAxis[2]],zAxis:[cm.zAxis[0],cm.zAxis[1],cm.zAxis[2]],color:cm.color},globalMatrix:cr.getCurrentMatrix()};ct.rep=cl.node}if(ct==null){cr.popMatId();cr.popMatrix();cr.popGAS();return null}this.resolvedInheritance(cr,ct);if(cv){cr.popGAS();cr.popMatrix();cr.popMatId()}return}}var cp=cl.children.length;for(var cn=0;cn<cp;cn++){this.addMesh(cl.children[cn],false,cr)}if(cv){cr.popGAS();cr.popMatrix();cr.popMatId()}};var bU=function(cl){j.call(this);this.rep=new aW(cl)};bU.prototype=Object.create(j.prototype);bU.prototype.constructor=bU;bU.prototype.unstream=function(cq){var cm=cq.getAllReps();cq.initReps();j.prototype.unstream.call(this,cq);if(cq.version<210021340){var cl=cq.readFloat()}else{var co=cq.readFloat();var cs=cq.readFloat()}var cn=cq.readUnsignedChar();if(cn==1){var ct=cq.readFloat();var cr=cq.readFloat();var cp=cq.readFloat()}cq.setReps(cm);return this.rep};var v=function(cl){j.call(this);this.rep=new aW(cl)};v.prototype=Object.create(j.prototype);v.prototype.constructor=O;v.prototype.unstream=function(cr){j.prototype.unstream.call(this,cr);var cq=cr.readCompressedInt();if(cq>0){var cn=cr.getAllReps();cr.initReps();for(var cm=0;cm<cq;cm++){var cl=cr.readFloat();var cp=cr.readClassName();var co=cr.getUnstreamer(cp);var cs=co.unstream(cr,this.rep.noShow);if(cr.error){return false}if(cs){this.rep.children.push(cs)}}cr.setReps(cn)}return this.rep};var O=function(cl){j.call(this);this.rep=new aW(cl)};O.prototype=Object.create(j.prototype);O.prototype.constructor=O;O.prototype.unstream=function(cr){this.rep.unstream(cr);var cl=cr.getLightDataStreaming();cr.setLightDataStreaming(false);var cq=cr.readCompressedInt();if(cq>0){var cp=cr.readClassName();var co=cr.getUnstreamer(cp);var cs=co.unstream(cr,this.rep.noShow);if(cr.error){return false}if(cs){this.rep.children.push(cs)}var cn=cr.readFloat()}if(cq>1){var cm=cr.getAllReps();cr.initReps();for(i=1;i<cq;i++){var cp=cr.readClassName();var co=cr.getUnstreamer(cp);var cs=co.unstream(cr,this.rep.noShow);if(cr.error){return false}if(cs){this.rep.children.push(cs)}var cn=cr.readFloat()}cr.setReps(cm)}cr.popMatId();cr.popGAS();cr.popMatrix();cr.setLightDataStreaming(cl);return this.rep};var bN=function(cl){this.rep=new aW(cl)};bN.prototype=Object.create(j.prototype);bN.prototype.constructor=bN;bN.prototype.readStaticMode=function(ct){var cr=ct.readCompressedInt();for(var co=0;co<cr;++co){var cw=ct.readUnsignedChar();if(cw){var cp=ct.readCompressedInt();if(!ct.fakeMultiRep.isValidIndex(cp)||!ct.multiRefNode.isValidIndex(cp)){ct.fakeMultiRep.addAt(true,cp);var cs=ct.readClassName();if(cs==112){var cn=ct.getUnstreamer(cs);var cx=cn.unstream(ct,true)}else{var cv=new z();cv.unstream(ct)}}}else{var cs=ct.readClassName();if(cs==112){var cn=ct.getUnstreamer(cs);var cx=cn.unstream(ct,true)}else{var cv=new z();cv.unstream(ct)}}}var cm=ct.readCompressedInt();var cl=[];ct.readFloatArray(0,3,cl);if(cm==1){ct.pushStaticMode(ct.popMatrix());ct.currentMatrix.push(new ap.Matrix4())}if(ct.version>=1101500){var cq=ct.readCompressedInt();var cy=ct.readCompressedInt();var cu=ct.readCompressedInt()}};bN.prototype.unstream=function(cC){this.rep.unstream(cC);if(cC.version>=1000800){var cr=cC.readUnsignedChar();if(cr){this.rep.node.matrix=cC.readMatrix()}}cC.pushMatrix(this.rep.node.matrix);var ct=cC.getCurrentPosition();this.readStaticMode(cC,[]);cC.setCurrentPosition(ct);var cu=cC.readCompressedInt();for(var cz=0;cz<cu;++cz){var cB=cC.readUnsignedChar();if(cB){var cn=-1;var cm=cC.readCompressedInt();if(cC.multiRefNode.isValidIndex(cm)){cp=cC.multiRefNode.get(cm);if(cp){if(!cC.expandCGR){var cA=cp.clone();this.addMesh(cA,false,cC)}this.rep.children.push(cp)}}else{var co=cC.readClassName();var cs=cC.getUnstreamer(co);var cp=cs.unstream(cC);cC.multiRefNode.addAt(cp,cm);if(cp){this.rep.children.push(cp)}}}else{var co=cC.readClassName();var cs=cC.getUnstreamer(co);var cv=cs.unstream(cC);if(cv){this.rep.children.push(cv)}}}cC.popMatId();cC.popGAS();cC.popMatrix();var cl=cC.readCompressedInt();var cq=[];cC.readFloatArray(0,3,cq);if(cl){cC.popStaticMode()}if(cC.version>=1101500){var cw=cC.readCompressedInt();var cy=cC.readCompressedInt();var cx=cC.readCompressedInt()}return this.rep};var ci=function(cl){this.rep=new M(cl)};ci.prototype=Object.create(j.prototype);ci.prototype.constructor=ci;ci.prototype.unstream=function(ct,cx){this.rep.unstream(ct);if(ct.version>=1000800){var cv=ct.readUnsignedChar();if(cv){this.rep.node.matrix=ct.read2DMatrix()}}ct.pushMatrix(this.rep.node.matrix);var cr=ct.readCompressedInt();for(var cp=0;cp<cr;++cp){var cy=ct.readUnsignedChar();if(cy==aG){var cm=-1;var cn=ct.readCompressedInt();if(ct.multiRefNode.isValidIndex(cn)){if(cx){continue}cw=ct.multiRefNode.get(cn);if(cw){if(!ct.expandCGR){var cs=cw.clone();this.addMesh(cs,false,ct)}this.rep.children.push(cw)}}else{var cq=ct.readClassName();if(cx){if(ct.fakeMultiRep.isValidIndex(cn)){continue}if(cq==112){var co=ct.getUnstreamer(cq);co.unstream(ct,true);ct.fakeMultiRep.addAt(true,cn);continue}var cu=new z();cu.unstream(ct);continue}var co=ct.getUnstreamer(cq);var cw=co.unstream(ct);ct.multiRefNode.addAt(cw,cn);if(cw){this.rep.children.push(cw)}}}else{var cq=ct.readClassName();if(cx){if(cq==112){var co=ct.getUnstreamer(cq);co.unstream(ct,true);continue}var cu=new z();cu.unstream(ct);continue}var co=ct.getUnstreamer(cq);var cl=co.unstream(ct);if(cl){this.rep.children.push(cl)}}}ct.popMatId();ct.popGAS();ct.popMatrix();return this.rep};var bD=function(){bx.call(this);this.gp=[]};bD.prototype=Object.create(bx.prototype);bD.prototype.constructor=bD;bD.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu,basic:true};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var bp=function(){bx.call(this);this.gp=[]};bp.prototype=Object.create(bx.prototype);bp.prototype.constructor=bp;bp.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var aa=function(){bx.call(this);this.gp=[]};aa.prototype=Object.create(bx.prototype);aa.prototype.constructor=aa;aa.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu,basic:true};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var cf=function(){bx.call(this);this.gp=null};cf.prototype=Object.create(bx.prototype);cf.prototype.constructor=cf;cf.prototype.unstream=function(cp){var cn=false;if(cp.readBoolean()){var cm=null;if((cp.version>=1101860&&cp.version<2100000)||(cp.version>=2100170)){cm=new ce();cn=cm.unstream(cp)}else{cm=new bB();cn=cm.unstream(cp)}if(cn){this.gp=cm}}if(cp.readBoolean()){var cl=new u();var co=cl.unstream(cp)}};var bK=function(){bx.call(this);this.gp=[]};bK.prototype=Object.create(bx.prototype);bK.prototype.constructor=bK;bK.prototype.unstreamPerforatedPolygon=function(cm){if(cm.readBoolean()){var cl=new cf();cl.unstream(cm);if(cl.gp){this.gp.push(cl.gp)}}};bK.prototype.build=function(cx){var cA=new be.Mesh();var cw=cx.getCurrentMatId();var cu=cx.getGAS();var cl=cu.getDisplayedColor();var cq=new ap.Color;cq.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cy=this.rep.repGAS.getType();var cv=this.rep.repGAS.isSolid();var cp=false;if(cu.isNoZ()){cp=true}var cs=null;if(this.gp[0].primitive.connectivity==be.ConnectivityTypeEnum.LINES){var ct={color:cq,opacity:cl[3]/255,lineWidth:cu.getLineThickness(),pattern:cu.getLinetype()};var cs=new be.DrawingGroup(ct,cw,1,0,this.gp[0].primitive.indices.length)}else{var ct={color:cq,opacity:cl[3]/255,solid:cv};if(cp){ct.basic=true}var cs=new be.DrawingGroup(ct,cw,4,0,this.gp[0].primitive.indices.length)}var co=new be.MeshPrimitive(this.gp[0].node.cgmId,cs,0,this.gp[0].primitive.indices.length);if(this.gp[0].decoration){co.decoration=this.gp.decoration}if(this.gp[0].boundingSphere){co.boundingSphere=this.gp[0].boundingSphere}cs.primitives.push(co);cA.drawingGroups.push(cs);cA.vertexIndexArray=this.gp[0].primitive.indices;cA.vertexPositionArray=this.gp[0].vertexBuffer.posBuffer;cA.vertexNormalArray=this.gp[0].vertexBuffer.normalBuffer;cA.gas.fill=ct;cA.gas.line=ct;var cr=[0,0,0];var cz=[0,0,0];if(true){var cr=[0,0,0];var cz=[0,0,0];var cn=cA.vertexPositionArray.length;if(cn>=3){cr=[cA.vertexPositionArray[0],cA.vertexPositionArray[1],cA.vertexPositionArray[2]];cz=[cA.vertexPositionArray[0],cA.vertexPositionArray[1],cA.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cA.vertexPositionArray[cm]<cr[0]){cr[0]=cA.vertexPositionArray[cm]}if(cA.vertexPositionArray[cm+1]<cr[1]){cr[1]=cA.vertexPositionArray[cm+1]}if(cA.vertexPositionArray[cm+2]<cr[2]){cr[2]=cA.vertexPositionArray[cm+2]}if(cA.vertexPositionArray[cm]>cz[0]){cz[0]=cA.vertexPositionArray[cm]}if(cA.vertexPositionArray[cm+1]>cz[1]){cz[1]=cA.vertexPositionArray[cm+1]}if(cA.vertexPositionArray[cm+2]>cz[2]){cz[2]=cA.vertexPositionArray[cm+2]}}}cr[2]=-0.01;cz[2]=0.01;cA.AABB={min:cr,max:cz}}return cA};var T=function(){bx.call(this);this.gp=[]};T.prototype=Object.create(bx.prototype);T.prototype.constructor=T;T.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var bW=function(){bx.call(this);this.gp=[]};bW.prototype=Object.create(bx.prototype);bW.prototype.constructor=bW;bW.prototype.build=function(cw){var cz=new be.Mesh();var ct=cw.getGAS();var cv=cw.getCurrentMatId();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;var cs={color:cp,opacity:cl[3]/255,symbol:this.gp.symbol};var cr=new be.DrawingGroup(cs,cv,0,0,this.gp.primitive.indices.length);var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var b0=function(){bx.call(this);this.gp=[]};b0.prototype=Object.create(bx.prototype);b0.prototype.constructor=b0;b0.prototype.build=function(cw){var cz=new be.Mesh();var cv=cw.getCurrentMatId();var ct=cw.getGAS();var cl=ct.getDisplayedColor();var cp=new ap.Color;cp.setRGB(cl[0]/255,cl[1]/255,cl[2]/255);var cx=this.rep.repGAS.getType();var cu=this.rep.repGAS.isSolid();var cr=null;if(this.gp.primitive.connectivity==be.ConnectivityTypeEnum.LINES){var cs={color:cp,opacity:cl[3]/255,lineWidth:ct.getLineThickness(),pattern:ct.getLinetype()};var cr=new be.DrawingGroup(cs,cv,1,0,this.gp.primitive.indices.length)}else{var cs={color:cp,opacity:cl[3]/255,solid:cu,basic:true};var cr=new be.DrawingGroup(cs,cv,4,0,this.gp.primitive.indices.length)}var co=new be.MeshPrimitive(this.gp.node.cgmId,cr,0,this.gp.primitive.indices.length);if(this.gp.decoration){co.decoration=this.gp.decoration}if(this.gp.boundingSphere){co.boundingSphere=this.gp.boundingSphere}cr.primitives.push(co);cz.drawingGroups.push(cr);cz.vertexIndexArray=this.gp.primitive.indices;cz.vertexPositionArray=this.gp.vertexBuffer.posBuffer;cz.vertexNormalArray=this.gp.vertexBuffer.normalBuffer;cz.gas.fill=cs;cz.gas.line=cs;var cq=[0,0,0];var cy=[0,0,0];if(true){var cq=[0,0,0];var cy=[0,0,0];var cn=cz.vertexPositionArray.length;if(cn>=3){cq=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];cy=[cz.vertexPositionArray[0],cz.vertexPositionArray[1],cz.vertexPositionArray[2]];for(var cm=0;cm<cn;cm+=3){if(cz.vertexPositionArray[cm]<cq[0]){cq[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]<cq[1]){cq[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]<cq[2]){cq[2]=cz.vertexPositionArray[cm+2]}if(cz.vertexPositionArray[cm]>cy[0]){cy[0]=cz.vertexPositionArray[cm]}if(cz.vertexPositionArray[cm+1]>cy[1]){cy[1]=cz.vertexPositionArray[cm+1]}if(cz.vertexPositionArray[cm+2]>cy[2]){cy[2]=cz.vertexPositionArray[cm+2]}}}cq[2]=-0.01;cy[2]=0.01;cz.AABB={min:cq,max:cy}}return cz};var b6=function(){bx.call(this);this.primitiveSets=[];this.vertexBuffer=null};b6.prototype=Object.create(bx.prototype);b6.prototype.constructor=b6;b6.prototype.addGP=function(cm,cu){if(this.vertexBuffer==null){this.vertexBuffer=new l()}var co=this.vertexBuffer.posBuffer.length/3;var ct=cm.vertexBuffer;for(var cp=0;cp<ct.posBuffer.length;cp++){this.vertexBuffer.posBuffer.push(ct.posBuffer[cp]);if(ct.normalBuffer.length){this.vertexBuffer.normalBuffer.push(ct.normalBuffer[cp])}else{this.vertexBuffer.normalBuffer.push(undefined)}}var cw=[];if((cm.primitives)&&(cm.primitives.length)){cw=cm.primitives}else{cw.push(cm.primitive)}for(var cp=0;cp<cw.length;cp++){var cq=cw[cp];var cs=this.primitiveSets.length;for(cn=0;cn<cs;cn++){var cl=this.primitiveSets[cn];if((cl.connectivity==cq.connectivity)&&be.isEqualGAS(cl.gas,cu)&&be.isEqualMaterial(cl.material,cq.material)){cl.set.push(cq);cl.nbIndices+=cq.indices.length;break}}if(cn==this.primitiveSets.length){var cv={};cv.connectivity=cq.connectivity;cv.gas=cu;cv.material=cq.material;cv.nbIndices=cq.indices.length;cv.more_indices=0;cv.set=[];cv.set.push(cq);this.primitiveSets.push(cv)}var cr=cq.indices;for(var cn=0;cn<cr.length;cn++){cr[cn]=cr[cn]+co}}};b6.prototype.build=function(cl){if(this.primitiveSets.length==0){return null}return this.buildRep(this.vertexBuffer,this.primitiveSets,cl)};var bS=function(){j.call(this)};bS.prototype=Object.create(j.prototype);bS.prototype.constructor=bS;bS.prototype.unstream=function(cm){var cl=cm.readCompressedInt();var cn=j.prototype.unstream.call(this,cm);var co=cm.readFloat();return cn};var bd=function(){j.call(this)};bd.prototype=Object.create(j.prototype);bd.prototype.constructor=bd;bd.prototype.unstream=function(cn){var cm=cn.readCompressedInt();var co=j.prototype.unstream.call(this,cn);var cl=cn.readUnsignedChar();return co};var ca=function(){ci.call(this)};ca.prototype=Object.create(ci.prototype);ca.prototype.constructor=ca;ca.prototype.unstream=function(cm){var cl=cm.readCompressedInt();var cn=ci.prototype.unstream.call(this,cm);var co=cm.readCompressedInt();cl=cm.readCompressedInt();cl=Math.abs(cl);if(cl>0){cm.readFloat()}return cn};var ao=function(){j.call(this)};ao.prototype=Object.create(j.prototype);ao.prototype.constructor=ao;ao.prototype.unstream=function(co){var cn=co.getCurrentPosition();var cm=co.readCompressedInt();var cl=cn+cm+1;var cp=j.prototype.unstream.call(this,co);co.setCurrentPosition(cl);return cp};var bt=function(){j.call(this)};bt.prototype=Object.create(j.prototype);bt.prototype.constructor=bt;bt.prototype.applyTextureMatrix=function(cr,cn,cs){if(!(cn.node instanceof be.SGBag)){var ct=cr.getReps(cn.repIndice,cn.renderType);var co=ct.vertexUvArray;var cl=co?co.length/3:0;if(cl>0){var cq=0,cp=0;var cm=new ap.Vector4();for(var cq=0;cq<cl;cq++,cp+=3){cm.set(co[cp],co[cp+1],co[cp+2],1);cm.applyMatrix4(cs);co[cp]=cm.x/cm.w;co[cp+1]=cm.y/cm.w;co[cp+2]=cm.z/cm.w}}}else{for(var cq=0;cq<cn.children.length;cq++){this.applyTextureMatrix(cr,cn.children[cq],cs)}}};bt.prototype.unstream=function(co,cn){var cp=j.prototype.unstream.call(this,co,cn);var cm=co.readBoolean();if(cm){var cl=b7.prototype.unstream.call(this,co);if(cl.textureMatrix!==undefined){this.applyTextureMatrix(co,this.rep,cl.textureMatrix)}}return this.rep};var ag=function(cl){cg.call(this);this.rep=new D(cl)};ag.prototype=Object.create(cg.prototype);ag.prototype.constructor=ag;ag.prototype.convertConnectivity=function(cl){switch(cl){case 0:return be.ConnectivityTypeEnum.POINTS;case 1:return be.ConnectivityTypeEnum.LINES;case 2:return be.ConnectivityTypeEnum.LINE_STRIP;case 3:return be.ConnectivityTypeEnum.LINE_LOOP;case 4:return be.ConnectivityTypeEnum.TRIANGLES;case 5:return be.ConnectivityTypeEnum.TRIANGLE_STRIP;case 6:return be.ConnectivityTypeEnum.TRIANGLE_FAN;default:return be.ConnectivityTypeEnum.TRIANGLES}};ag.prototype.getByteSize=function(cl){switch(cl){case be.DataTypeEnum.CHAR:case be.DataTypeEnum.UCHAR:return 1;case be.DataTypeEnum.SHORT:case be.DataTypeEnum.USHORT:return 2;case be.DataTypeEnum.INT:case be.DataTypeEnum.UINT:case be.DataTypeEnum.FLOAT:return 4;case be.DataTypeEnum.DOUBLE:return 8;default:return 1}};ag.prototype.addSet=function(cl){};ag.prototype.unstream=function(cL){cL.setNumberOfVertices(16777216);var cq=cL.readCompressedInt();if(cq<=0){return null}var cJ=[];var cr=new be.PrimitiveGroup();cr.fillAttr=new be.FillAttributes();cr.lineAttr=new be.LineAttributes();for(var cD=0;cD<cq;cD++){var cA=new be.Buffer;var cp=0;cA.indexBuffer=cL.readBoolean();cp=cL.readCompressedInt();cA.format=cL.readUnsignedChar();cA.dimension=cL.readUnsignedChar();cA.size=cp*cA.dimension;var cK=cL.readBoolean();cr.addBuffer(cD,cA);switch(cK){case q.CGR_STREAM_COMPRESS_POSITION_1:cA.data=new Float32Array(cA.size);cL.readPositionsArrayBuffer(cp,cA.data,0);break;case q.CGR_STREAM_COMPRESS_NORMAL_1:cA.data=new Float32Array(cA.size);cL.readNormalsArrayBuffer(cp,cA.data,0);break;case q.CGR_STREAM_NO_COMPRESSION:switch(cA.format){case be.DataTypeEnum.FLOAT:cA.data=new Float32Array(cA.size);cL.readFloatArray(0,cA.size,cA.data);break;case be.DataTypeEnum.INT:cA.data=new Int32Array(cA.size);cL.readUncompressedIntArray(cA.size,cA.data);break;case be.DataTypeEnum.UINT:cA.data=new Uint32Array(cA.size);cL.readUncompressedIntArray(cA.size,cA.data);break;default:cA.data=new Uint8Array(cA.size);cL.readBytes(cA.size,cA.data);break}break;default:break}}var cM=cL.readCompressedInt();if(cM<=0){return null}for(var cD=0;cD<cM;cD++){var cv=new be.Primitive();cv.nbIndices=cL.readCompressedInt();cv.connectivity=this.convertConnectivity(cL.readUnsignedChar());var cG=cL.readCompressedInt();for(var cC=0;cC<cG;cC++){var cz=new be.VertexComponent();cz.component=cL.readUnsignedChar();cz.cardinality=cL.readUnsignedChar();cz.bufferId=cL.readCompressedInt();cz.offset=cL.readCompressedInt();cz.indices=null;var cA=cr.getBufferFromId(cz.bufferId);if(cA!==null){var cu=this.getByteSize(cA.format);if(cA.oldDimension){cz.offset/=(cu*cA.oldDimension)}else{cz.offset/=(cu*cA.dimension)}cA.component=cz.component;if(cA.component===be.VertexComponentEnum.TEX_COORD_0||cA.component===be.VertexComponentEnum.TEX_COORD_1||cA.component===be.VertexComponentEnum.TEX_COORD_2||cA.component===be.VertexComponentEnum.TEX_COORD_3){if(cA.dimension<3){var cp=cA.size/cA.dimension;var cH=new Float32Array(3*cp);for(var cB=0;cB<cp;cB++){cH[3*cB]=cA.data[cA.dimension*cB];if(cA.dimension>1){cH[3*cB+1]=cA.data[2*cB+1]}else{cH[3*cB+1]=0}cH[3*cB+2]=0}cA.data=cH;cA.size=3*cp;cA.oldDimension=cA.dimension;cA.dimension=3}}cz.nbValuesPerVertex=cA.dimension;cz.format=cA.format}var cx=cL.readBoolean();if(cx){cz.indices=new be.IndexArray;cz.indices.bufferId=cL.readCompressedInt();cz.indices.offset=cL.readCompressedInt();cA=cr.getBufferFromId(cz.indices.bufferId);if(cA!==null){var cu=this.getByteSize(cA.format);cz.indices.offset/=cu;cz.indices.format=cA.format}}cv.addVertexComponent(cz)}var ct=cL.readBoolean();var cE=null;if(ct){var cy=b7.prototype.unstream.call(this,cL);if(cy.gas){cE=cy.gas}}cJ.push({prim:cv,gas:cE})}this.rep.unstream(cL);var cm=false;for(var cD=0;cD<cJ.length;cD++){if(cJ[cD].gas){var cs=cL.pushGAS(cJ[cD].gas,0);var co=cs.getDisplayedColor();var cI=cs.isTransparent();var cn=cs.isSolid();var cF=cs.getType();if(cs.isNoZ()){cm=true}var cy={fill:new be.FillAttributes(new be.Color(co[0]/255,co[1]/255,co[2]/255,co[3]/255)),line:new be.LineAttributes(new be.Color(co[0]/255,co[1]/255,co[2]/255,1),cs.getLineThickness(),be.LinePatternEnum.SOLID),point:new be.PointAttributes()};if(cF>1&&((cJ[cD].prim.connectivity>=3)&&(cJ[cD].prim.connectivity<6))){cy.line.forceMaterial=true}if(cF>1&&(cJ[cD].prim.connectivity==6)){cy.point.forceMaterial=true}cJ[cD].prim.attr=cy;cL.popGAS()}cr.addPrimitive(cJ[cD].prim)}if(!cm){var cs=cL.getGAS();var cn=cs.getType();if(cn==0){var cw=cL.popGAS();cw.inherited.setType(2);cL.pushGAS(cw.inherited,cw.inh_mode)}}cr.material=cL.getCurrentMatId();var cl=be.convertToGeometry3js(cr,undefined,undefined);cl.rep=this.rep.node;this.resolvedInheritance(cL,cl);cl.rep=this.getCompressedRep(cL);cL.popMatId();cL.popGAS();return this.rep};var b7=function(){};b7.prototype.constructor=b7;b7.prototype.getNbAttributes=function(cl){var cm=0;while(cl){if(cl&1){cm++}cl=cl>>1}return cm};b7.prototype.getAttributeType=function(cl,cm){var co=1;for(var cn=0;cn<cm+1;cn++){while(!(cl&1)){cl=cl>>1;co=co<<1}cl=cl>>1;if(cn!==cm){co=co<<1}}return co};b7.prototype.unstream=function(ct){var cr={};var cl=ct.readCompressedInt();var cq=ct.getCurrentPosition();var cz=ct.readCompressedInt();var cw=b7.prototype.getNbAttributes(cl);for(var co=0;co<cw;co++){var cu=b7.prototype.getAttributeType(cl,co);switch(cu){case bO.SGV6_ATTRIBUTE_GAS:cr.gas=ct.readGraphicAttributeSet();break;case bO.SGV6_ATTRIBUTE_TEXTURE_MATRIX:var cn=[];if(ct.version>=210021610){var cy=ct.readCompressedUInt();var cm=ct.readUnsignedChar();var cx=[];ct.readDoubles(cx,cm);var cp=0;for(var co=0,cp=0;co<16;co++){var cs=(cy&(3<<2*co))>>>2*co;switch(cs){case 0:cn.push(cx[cp++]);break;case 1:cn.push(0);break;case 2:cn.push(1);break;case 3:cn.push(-1);break;default:break}}}else{cn=new Float32Array(16);ct.readFloatArray(0,16,cn)}var cv=new ap.Matrix4();cv.set(cn[0],cn[4],cn[8],cn[12],cn[1],cn[5],cn[9],cn[13],cn[2],cn[6],cn[10],cn[14],cn[3],cn[7],cn[11],cn[15]);cr.textureMatrix=cv;break;case bO.SGV6_ATTRIBUTE_RENDERING_MODE:case bO.SGV6_ATTRIBUTE_POINT_TYPE:case bO.SGV6_ATTRIBUTE_POINT_SIZE:ct.readCompressedInt();break;default:break}}ct.setCurrentPosition(cq+cz);return cr};var aV=function(cn){this.fatherId=cn.readUncompressedInt(false);var cm=new a(cn);var cl=cn.readUncompressedInt(false);this.name=cn.readUnicodeString(cl/2);this.blocReader=new s(cn,0);this.getId=function(){return this.blocReader.id}};var bE=function(cm,co){this.tocEntry=co;var cn=cm;this.name=co.name;var cl=[];var cp=[];this.header=null;this.getChild=function(cq){};this.getStreamerByName=function(cq){for(var cr=0;cr<cp.length;++cr){if(cp[cr].name==cq){return cp[cr]}}var cs=cn.getStreamer(co,cq);if(cs!=null){if(this.header!=null){cs.version=this.header.version;cs.conversion=this.header.conversion}cs.setContainer(this);cp.push(cs)}return cs};this.getStreamer=function(){return this.getStreamerByName(this.name)};this.getChildContainer=function(cq){for(var cr=0;cr<cl.length;++cr){if(cl[cr].name==cq){return cl[cr]}}var cs=cm.getChildContainer(this.tocEntry,cq);if(cs){cl.push(cs)}return cs};this.unstreamHeaderCGR=function(){this.header=this.getStreamer();var cq=this.header.readUnsignedChar();this.header.conversion=!cq;this.header.version=this.header.readUncompressedInt();if(this.header.version>b3){console.log("warning cgr version not supported "+this.header.version+">"+b3);return{error:"warning cgr version not supported"}}};this.unstreamHeaderUVR=function(cq){this.header=cq;var cr=this.header.readUnsignedChar();this.header.conversion=!cr;this.header.version=this.header.readUncompressedInt();if(this.header.version>b3){console.log("warning ugr version not supported");return{error:"warning ugr version not supported"}}};this.getResourceCGRContainer=function(){var cq=cn.getRootContainer();if(cq){return cq.getChildContainer("Resources")}else{return null}};this.getResource=function(cC){var cA;var cB=null;var ct=null;var cz=cC.readUnsignedChar();var cy=cC.readCompressedInt();if(cC.textures.isValidMultiRefIndex(cy)){cA=cC.textures.getIndex(cy);return cA}var cu=this.getStreamerByName("MainCGRResourceStreamer");cu.setCurrentPosition(cy);cC.copyStreamerInheritance(cu);var cE=null;var cx=cu.readUnsignedChar();if(!cx){if(!cz){var cw=cu.readUnsignedChar();switch(cw){case bQ.TEXTURE_SIMPLE:break;case bQ.TEXTURE_SIMPLE_WITH_MIPMAP:cE=new bX();break;case bQ.TEXTURE_VOLUME:break;case bQ.TEXTURE_VOLUME_WITH_MIPMAP:break;case bQ.TEXTURE_CUBIC_ENV_MAP:break;case bQ.TEXTURE_CUBIC_ENV_MAP_WITH_MIPMAP:break}var cv=cu.readStringWithLength();var cs=cv.split("\\");var cr=cs[cs.length-1];if(cE!=null){cB=cE.unstream(cu,cr)}}else{var cE=new k();cB=cE.unstream(cu)}}else{var cD=cu.readStringWithLength();var cq=cu.readStringWithLength();console.log(" providerName = "+cD+"resourceUUID = "+cq+"not loaded")}if(cB!=null){cA=cC.textures.add(cB);cC.textures.addMultiRefIndex(cy,cA);return cA}else{return null}};this.getImage=function(cs,cw,cq){var ct=null;var cu=this.getStreamerByName("MainCGRResourceStreamer");cs.copyStreamerInheritance(cu);cu.setCurrentPosition(cw);var cv=cu.readUnsignedChar();if(cv){var cr=new bH();ct=cr.unstream(cu)}return ct};this.getResourceShader=function(ct){var cq=ct.readUnsignedChar();var cv=0;if(cq){cv=ct.readCompressedInt()}var cu=this.getStreamerByName("MainCGRResourceStreamer");cu.conversion=ct.conversion;cu.setCurrentPosition(cv);cu.version=ct.version;var cr=cu.readUnsignedChar();if(!cr){var cs=new x();cs.unstream(cu)}else{}return cs}};var bc={file:"",id:-1};var bZ=null;var ad=[];var cb=1;var an=function(cl,cx,cu,cv,cq,co,cw){var cz=false;this.isV5=true;this.FTA=false;this.expand=cx;this.withSceneGraph=cv;a2=cv;bI=co;aM=cw;this.uint32Index=cq;g=cu;var ct=null;var cm=cl;var cp=null;var cn=null;var cs=null;this.setFileBuffer=function(cA){cm=new byteArrayReader(cA);bc={file:"",id:-1};bZ=null;ad=[];cb=1;cz=false;this.isV5=true;ct=null;cp=null;cn=null;cs=null};var cy=0;this.addChild=function(cE){var cD=cE.node;if(cE.children){var cA=cE.children.length;for(var cC=0;cC<cA;cC++){cy++;var cB=cE.children[cC].node;cD.children.push(cB);if(cB.type){cB.parent=cD;this.addChild(cE.children[cC])}}}};var cr=function(cC,cA,cB){this.cgmId=cC?cC:0;this.matrix=cA?cA:null;this.boundingSphere=cB?cB:null};this.addChildExpand=function(cE){var cD=new cr(cE.node.cgmId,cE.node.matrix,cE.node.boundingSphere);if(cE.node.rep!==undefined){cD.rep=cE.node.rep}else{cD.children=[]}if(cE.children){var cA=cE.children.length;for(var cC=0;cC<cA;cC++){var cB=this.addChildExpand(cE.children[cC]);cD.children.push(cB)}}return cD};this.compressedChildren=function(cN,cI){var cE=cN.node;if(cI.offset>cI.size){var cH;cI.size*=2;cH=new ArrayBuffer(cI.size);cI.result.push(cH);cI.view32F=new Float32Array(cH);cI.view32UInt=new Uint32Array(cH);cI.view8UInt=new Uint8Array(cH)}cI.view32UInt[cI.offset++]=cE.cgmId;cI.view8UInt[cI.offset*4]=cE.type;cI.view8UInt[cI.offset*4+1]=cE.solid;cI.offset++;if(cN.children){var cM=cN.children.length,cJ,cA;cI.view32UInt[cI.offset++]=cM;for(cJ=0;cJ<cM;cJ++){cy++;cA=cN.children[cJ].node;cE.children.push(cA);cA.parent=cE;this.compressedChildren(cN.children[cJ],cI)}}if(cE.primitives){var cM=cE.primitives.length,cJ,cL,cD,cB,cK;cI.view32UInt[cI.offset++]=cM;for(cJ=0;cJ<cM;cJ++){cy++;cL=cE.primitives[cJ];cB=cL.boundingSphere?true:false;cK=cL.decoration?cL.decoration[0]:false;cI.view32UInt[cI.offset++]=cL.cgmId;cI.view8UInt[cI.offset*4]=cL.type;cI.view8UInt[cI.offset*4+1]=cB;cI.view8UInt[cI.offset*4+2]=cK;cI.offset++;cI.view32UInt[cI.offset++]=cL.count;cI.view32UInt[cI.offset++]=cL.start;if(cL.group.primitives instanceof Array){cD=cI.idGroup++;cL.group.primitives=cD}else{cD=cL.group.primitives}cI.view32UInt[cI.offset++]=cD;if(cK){var cG,cC=cL.decoration.length,cF=cI.offset*4;for(cG=0;cG<cC;cG++){cI.view8UInt[cF+cG]=cL.decoration[cG]}cI.offset+=(cC/4>>0)+1}if(cB){cI.view32F[cI.offset++]=cL.boundingSphere.center[0];cI.view32F[cI.offset++]=cL.boundingSphere.center[1];cI.view32F[cI.offset++]=cL.boundingSphere.center[2];cI.view32F[cI.offset++]=cL.boundingSphere.radius}}}};this.applyGlobalMatrix=function(cA,cB){for(var cC=0;cC<cA.length;cC++){var cD=cA[cC].globalMatrix?!cA[cC].globalMatrix.isIdentity():false;if(cD){be.applyMat(cA[cC],cA[cC].globalMatrix,cB)}be.computeBB(cA[cC])}};this.applyGlobalMatrixStatic=function(cA,cB){for(var cC=0;cC<cA.length;cC++){var cD=cA[cC].globalMatrix?!cA[cC].globalMatrix.isIdentity():false;if(cD){be.applyMat(cA[cC],cA[cC].globalMatrix,cB)}be.computeBB(cA[cC])}};this.applyGlobalMatrixAxis=function(cE){var cC=null;var cH=new ap.Matrix4();var cG=new ap.Vector3();var cB=new ap.Vector3();var cA=new ap.Vector3();var cI=new ap.Vector3();for(var cD=0;cD<cE.length;cD++){cC=cE[cD].axis;var cF=cE[cD].globalMatrix?!cE[cD].globalMatrix.isIdentity():false;if(cF){cG.set(cC.origin[0],cC.origin[1],cC.origin[2]);cB.set(cC.xAxis[0],cC.xAxis[1],cC.xAxis[2]);cA.set(cC.yAxis[0],cC.yAxis[1],cC.yAxis[2]);cI.set(cC.zAxis[0],cC.zAxis[1],cC.zAxis[2]);cH.makeBasis(cB,cA,cI);cH.setPosition(cG);cH.multiply(cE[cD].globalMatrix);cC.origin=[cH.elements[12],cH.elements[13],cH.elements[14]];cC.xAxis=[cH.elements[0],cH.elements[1],cH.elements[2]];cC.yAxis=[cH.elements[4],cH.elements[5],cH.elements[6]];cC.zAxis=[cH.elements[8],cH.elements[9],cH.elements[10]]}cE[cD]=cC}};this.applyGlobalMatrixRefPlanes=function(cB){var cE=null;var cL=new ap.Matrix4();var cJ=new ap.Vector3();var cD=new ap.Vector3();var cA=new ap.Vector3();var cM=new ap.Vector3();for(var cH=0;cH<cB.length;cH++){var cF=[];var cC=cB[cH].refPlanes;for(var cG=0;cG<cC.length;cG++){var cK=cC[cG];var cI=cB[cH].globalMatrix?!cB[cH].globalMatrix.isIdentity():false;if(cI){cJ.set(cK.origin[0],cK.origin[1],cK.origin[2]);cD.set(cK.xAxis[0],cK.xAxis[1],cK.xAxis[2]);cA.set(cK.yAxis[0],cK.yAxis[1],cK.yAxis[2]);cM.crossVectors(cD,cA);cL.makeBasis(cD,cA,cM);cL.setPosition(cJ);cL.multiply(cB[cH].globalMatrix);cK.origin=[cL.elements[12],cL.elements[13],cL.elements[14]];cK.xAxis=[cL.elements[0],cL.elements[1],cL.elements[2]];cK.yAxis=[cL.elements[4],cL.elements[5],cL.elements[6]]}cF.push(cK)}cB[cH]=cF}};this.computePrimBS=function(cP){if(g&&b9){for(var cI=0;cI<cP.length;cI++){var cA=cP[cI];var cD=cA.vertexPositionArray;var cG=cA.vertexIndexArray;for(var cN=0;cN<cA.drawingGroups.length;cN++){var cR=cA.drawingGroups[cN];if(cR.glType===0){continue}for(var cM=0;cM<cR.primitives.length;cM++){var cB=cR.primitives[cM];if(cB.boundingSphere){continue}var cL=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE];var cO=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];var cQ=[cB];if(C&&cB.rep){if(cB.rep.boundingSphere){continue}cQ=cB.rep.primitives}for(var cK=0;cK<cQ.length;cK++){var cH=cQ[cK];for(var cJ=cH.start;cJ<cH.start+cH.count;cJ++){var cF=cG[cJ];if(cD[3*cF]<cL[0]){cL[0]=cD[3*cF]}if(cD[3*cF+1]<cL[1]){cL[1]=cD[3*cF+1]}if(cD[3*cF+2]<cL[2]){cL[2]=cD[3*cF+2]}if(cD[3*cF]>cO[0]){cO[0]=cD[3*cF]}if(cD[3*cF+1]>cO[1]){cO[1]=cD[3*cF+1]}if(cD[3*cF+2]>cO[2]){cO[2]=cD[3*cF+2]}}}var cC=(cL[0]-cO[0])*(cL[0]-cO[0]);cC+=(cL[1]-cO[1])*(cL[1]-cO[1]);cC+=(cL[2]-cO[2])*(cL[2]-cO[2]);cC=0.5*Math.sqrt(cC);cL[0]=0.5*(cL[0]+cO[0]);cL[1]=0.5*(cL[1]+cO[1]);cL[2]=0.5*(cL[2]+cO[2]);var cE={center:cL,radius:cC};if(C&&cB.rep){cB.rep.boundingSphere=cE}else{cB.boundingSphere=cE}}}}}};this.processAllReps=function(cB,cM,cL){var cA=[];var cK=cB.length;var cF=new ap.Vector3();var cG=3;if(g){cG+=4}if(aM){cG+=1}for(var cE=0;cE<cK;cE++){var cN=[];var cJ=cB[cE].getArray();if(cE&1){this.applyGlobalMatrixStatic(cJ,cM);this.batch_static(cJ,cN,cM)}else{this.applyGlobalMatrix(cJ,cM);for(var cD=0;cD<cJ.length;cD++){var cI=cJ[cD];var cC=cI.AABB.min;var cH=cI.AABB.max;cF.x=cH[0]-cC[0];cF.y=cH[1]-cC[1];cF.z=cH[2]-cC[2];if(g){cL[cG*cI.rep+cG-4]=0.5*cF.length();cL[cG*cI.rep+cG-3]=0.5*cC[0]+0.5*cH[0];cL[cG*cI.rep+cG-2]=0.5*cC[1]+0.5*cH[1];cL[cG*cI.rep+cG-1]=0.5*cC[2]+0.5*cH[2]}if(bI){cJ[cD]._radius=0.5*cF.length()}}this.batch(cJ,cN,cM)}cA.push(cN)}return cA};this.batch=function(cJ,cF,cM){var cI=function(cQ,cP){if(cQ.min[0]>cP.min[0]){cQ.min[0]=cP.min[0]}if(cQ.min[1]>cP.min[1]){cQ.min[1]=cP.min[1]}if(cQ.min[2]>cP.min[2]){cQ.min[2]=cP.min[2]}if(cQ.max[0]<cP.max[0]){cQ.max[0]=cP.max[0]}if(cQ.max[1]<cP.max[1]){cQ.max[1]=cP.max[1]}if(cQ.max[2]<cP.max[2]){cQ.max[2]=cP.max[2]}};var cN=function(cR){var cS=cR.primitives;var cQ=cS.length-1;var cP=[];for(var cQ=0;cQ<cS.length;cQ++){if(cS[cQ].rep&&cS[cQ].rep.noShow){cP.push(cS[cQ])}}return cP};var cK=function(cQ){if(cQ&&cQ.drawingGroups&&cQ.drawingGroups.length){var cR=cQ.drawingGroups;for(var cP=0;cP<cR.length;cP++){if(cR[cP].primitives&&cR[cP].primitives.length){var cS=cN(cR[cP]);if(!cQ.noShowPrim){cQ.noShowPrim=[]}cQ.noShowPrim=cQ.noShowPrim.concat(cS)}}}};var cO={containNoShow:false,withSAG:aM,withBoundingElement:g};var cG=[];var cH=null;var cA=0;var cL=65535;if(this.uint32Index){cL=524287}for(var cC=0;cC<cJ.length;cC++){if(!cJ[cC].vertexPositionArray){continue}if(!this.FTA&&cJ[cC].noShow){continue}if(!cH){cH=cJ[cC].AABB}else{cI(cH,cJ[cC].AABB)}if(cA+cJ[cC].vertexPositionArray.length/3>=cL){if(cA==0){var cE=be.divideRep(cJ[cC],true,cO);for(var cD=0;cD<cE.length;cD++){cF.push(cE[cD])}cH=null;continue}var cB=be.processRepsCGR(cG,true,bI,cO,cM);cB.AABB={min:cH.min,max:cH.max};cH=null;cF.push(cB);cA=0;cG=[]}if((cJ[cC].vertexPositionArray.length/3)>=cL){var cE=be.divideRep(cJ[cC],true,cO);for(var cD=0;cD<cE.length;cD++){cF.push(cE[cD])}cH=null;continue}cG.push(cJ[cC]);cA+=cJ[cC].vertexPositionArray.length/3}for(var cC=0;cC<cJ.length;cC++){if(!cJ[cC].vertexPositionArray){continue}if(this.FTA||!cJ[cC].noShow||!this.withSceneGraph){continue}cO.containNoShow=true;if(cA+cJ[cC].vertexPositionArray.length/3>=cL){if(cA==0){var cE=be.divideRep(cJ[cC],true,cO);for(var cD=0;cD<cE.length;cD++){cF.push(cE[cD])}cH=null;continue}var cB=be.processRepsCGR(cG,true,bI,cO,cM);if(!cH){cH={min:[0,0,0],max:[0,0,0]}}cB.AABB={min:cH.min,max:cH.max};cH=null;cF.push(cB);cA=0;cG=[]}if((cJ[cC].vertexPositionArray.length/3)>=cL){var cE=be.divideRep(cJ[cC],true,cO);for(var cD=0;cD<cE.length;cD++){cF.push(cE[cD])}cH=null;continue}cG.push(cJ[cC]);cA+=cJ[cC].vertexPositionArray.length/3}if(cG.length>0){var cB=be.processRepsCGR(cG,true,bI,cO,cM);if(!cH){cH={min:[0,0,0],max:[0,0,0]}}cB.AABB={min:cH.min,max:cH.max};if(cB.AABB.min[0]==cB.AABB.max[0]&&cB.AABB.min[1]==cB.AABB.max[1]&&cB.AABB.min[2]==cB.AABB.max[2]){cB.AABB.min[0]-=0.1;cB.AABB.min[1]-=0.1;cB.AABB.max[0]+=0.1;cB.AABB.max[1]+=0.1}cF.push(cB)}};this.batch_static=function(cG,cD,cL){var cH=function(cO,cN){for(var cM=0;cM<16;cM++){if(!cO.elements[cM]==cN.elements[cM]){return false}}return true};var cK=[];for(var cF=0;cF<cG.length;cF++){var cJ=false;var cI=cG[cF];for(var cE=0;cK.length;cE++){if(cH(cI.globalMatrix,cK[cE].globalMatrix)){cK[cE].reps.push(cI);cJ=true;break}}if(!cJ){var cC=[cI];cK.push({globalMatrix:cI.globalMatrix,reps:cC})}}for(var cF=0;cF<cK.length;cF++){var cB=be.processRepsCGR(cK[cF].reps,false,false,{containNoShow:false,withSAG:aM,withBoundingElement:g},cL);var cA=[];if(cB.AABB.min[0]==cB.AABB.max[0]&&cB.AABB.min[1]==cB.AABB.max[1]&&cB.AABB.min[2]==cB.AABB.max[2]){cB.AABB.min[0]-=0.1;cB.AABB.min[1]-=0.1;cB.AABB.max[0]+=0.1;cB.AABB.max[1]+=0.1}cA.push(cB);cD.push({tab:cA,globalMatrix:cK[cF].reps[0].attachedPoint})}};this.buildSceneGraph=function(cK){var cQ=[];var cB=cK.axisSystems;var cM=cK.refPlanes;var cA=cK.texts;if(!this.expand){this.applyGlobalMatrixAxis(cB);this.applyGlobalMatrixRefPlanes(cM);var cD=this.processAllReps(cK.reps,cK.materials,cK.sgRep);var cS=null;if(this.withSceneGraph&&cK.rep){this.addChild(cK.rep);cS=cK.rep.node}if(this.withSceneGraph&&cK.rep&&false){var cL=new ArrayBuffer(65536*128);var cF=[cL];var cG=new Float32Array(cL);var cR=new Uint32Array(cL);var cE=new Uint8Array(cL);this.compressedChildren(cK.rep,{offset:0,result:cF,size:65536*128,view32F:cG,view32UInt:cR,view8UInt:cE,idGroup:0});cS=cF}return{reps:cD,sceneGraph:cS,resource:cK.resource,material:cK.materials,sgRep:cK.sgRep,decorations:cK.decorations,axisSystems:cB,refPlanes:cM,texts:cA}}var cP=ct.reps[aX.NORMAL].getArray();var cH=[];var cC=[];var cS=null;if(rep){cS=this.addChildExpand(rep)}for(var cI=0;cI<cP.length;cI++){if(!cP[cI].vertexPositionArray){continue}if((cP[cI].vertexPositionArray.length/3)>=65535){var cO=be.divideRep(cP[cI],true);var cQ=[];for(var cJ=0;cJ<cO.length;cJ++){cQ.push(cO[cJ])}cC.push(cQ);continue}var cQ=[];cH.push(cP[cI]);var cN=be.processRepsCGR(cH);cQ.push(cN);cC.push(cQ);cH=[]}cP=[];ct.all_reps=[];return{mesh:cC,resource:ct.textures.getArray(),material:ct.materials.getArray(),rep:cS}};this.init=function(){ct=new W(cm.clone());var cK=ct.readString(6);var cA=ct.readString(2);cp=cA[0];if(cK!="V5_CFV"){this.isV5=false;return{mesh:[],resource:[],material:[],excludeReps:[]}}if(cp==3){cb=0}else{cb=1}ct.conversion=true;var cL=ct.readUncompressedInt(true);var cG=ct.readUncompressedInt(true);ct.skip(8);ct.skip(32);var cN=ct.readUncompressedInt(true);ct.skip(4);if(cb){ct.setCurrentPosition(cL)}var cA=ct.readString(16);var cC=ct.readUnsignedChar();var cO=ct.readUnsignedShort(true);var cJ=ct.readUnsignedShort(true);var cB=ct.readUnsignedShort(true);var cD=ct.readUnsignedShort(true);var cI=ct.readUnsignedShort(true);var cH=ct.readUncompressedInt(true);ct.skip(64-31);if(!cb){var cM=new Uint8Array(384+cG);ct.readBytes(384,cM);var cE=new Uint8Array(cG);ct.setCurrentPosition(cL);ct.readBytes(cG,cE);cM.set(cE,384);var cF=new W(new byteArrayReader(cM));cF.conversion=true;cn=new s(cF,cD)}else{cn=new s(ct,cD)}ct.conversion=false};this.getApplicativeContainer=function(c0,cM){var cF=0;var cP=0;var cD={};if(!cM){this.init();var cG=new Date().getTime();var cA=null;var cU=this.getRootContainer();if(!cb){var cW=this.getEntryStreamer(cU.tocEntry);var cO=cW.readUncompressedInt(false);var cE=cW.readUncompressedInt(false);var cZ=cW.readUncompressedInt(false);for(var cS=0;cS<cZ;cS++){var cO=cW.readUncompressedInt(false);var cR=cW.readUncompressedInt(false);var cE=cW.readUnsignedShort(false);var cL=cW.readUncompressedInt(false);this.name=cW.readUnicodeString(cL/2)}var cJ=cU.getChildContainer("MAIN");var cI=this.getEntryStreamer(cJ.tocEntry);cJ.unstreamHeaderUVR(cI);cF=cJ.header.version;cP=cJ.header.conversion}else{var cT=cU.getChildContainer("SceneGraph");cT.unstreamHeaderCGR();cF=cT.header.version;cP=cT.header.conversion}}else{var cU=this.getRootContainer();if(!cb){var cJ=cU.getChildContainer("MAIN");cF=cJ.header.version;cP=cJ.header.conversion}else{var cT=cU.getChildContainer("SceneGraph");cF=cT.header.version;cP=cT.header.conversion}}var cC=cU.getChildContainer("Applicative Containers");if(!cC){return null}var cN=cC.getChildContainer(c0);if(!cN){return null}var cY=cN.getChildContainer("MainDataStream");if(!cY){return null}var cV=this.getBufferFromEntry(cY.tocEntry);if(cV.length==0){return null}switch(c0){case"V4V5_FDT":var cH=this.getEntryStreamer(cY.tocEntry);if(!cb){cH.bitBoolean=1;cH.bitPacking=1;cH.gasPacking=1}cH.expandCGR=this.expand;cH.version=cF;cH.conversion=cP;var cQ=cH.readCompressedInt();var cK=cH.readCompressedInt();cD.oldSize=cQ;cD.compressed=cK;cD.offset=cH.getCurrentPosition();cH.skip(cK);if(cH.getBytesRemain()){var cX=cH.readCompressedInt();cD.oldSize=cH.readCompressedInt();cD.compressed=cH.readCompressedInt();cD.offset=cH.getCurrentPosition()}break;default:break}var cB=new Date().getTime();return{buffer:cV,options:cD}};this.getApplicativeContainerOld=function(c0){this.init();var cF=new Date().getTime();var cT=this.getRootContainer();var cA=null;var cE=0;var cO=0;if(!cb){var cV=this.getEntryStreamer(cT.tocEntry);cV.conversion=true;var cN=cV.readUncompressedInt(false);var cD=cV.readUncompressedInt(false);var cZ=cV.readUncompressedInt(false);for(var cR=0;cR<cZ;cR++){var cN=cV.readUncompressedInt(false);var cQ=cV.readUncompressedInt(false);var cD=cV.readUnsignedShort(false);var cL=cV.readUncompressedInt(false);this.name=cV.readUnicodeString(cL/2)}cV.conversion=false;var cJ=cT.getChildContainer("MAIN");var cH=this.getEntryStreamer(cJ.tocEntry);cJ.unstreamHeaderUVR(cH);cE=cJ.header.version;cO=cJ.header.conversion}else{var cS=cT.getChildContainer("SceneGraph");cS.unstreamHeaderCGR();cE=cS.header.version;cO=cS.header.conversion}var cT=this.getRootContainer();var cC=cT.getChildContainer("Applicative Containers");if(!cC){return null}var cM=cC.getChildContainer(c0);if(!cM){return null}var cY=cM.getChildContainer("MainDataStream");if(!cY){return null}var cU=this.getBufferFromEntry(cY.tocEntry);var cG=this.getEntryStreamer(cY.tocEntry);if(!cb){cG.bitBoolean=1;cG.bitPacking=1;cG.gasPacking=1}cG.expandCGR=this.expand;cG.version=cE;cG.conversion=cO;var cP=cG.readCompressedInt();var cK=cG.readCompressedInt();cG.skip(cK);var cX=cG.readCompressedInt();cP=cG.readCompressedInt();cK=cG.readCompressedInt();var cB=new Date().getTime();var cI=cG.getCurrentPosition();var cW=cU.subarray(cG.getCurrentPosition(),cK+cI);return{buffer:cW,oldSize:cP,compressed:cK}};this.open=function(cN){var cM=this.init();if(cN){cb=0}if(!this.isV5){if(true){console.log("warning cgr version not supported or corrupted file");return{error:"cgr version not supported or corrupted file"}}else{return oldCGR}}h=false;var cF=new Date().getTime();var cU=this.getRootContainer();var cA=null;var cQ=null;if(!cb){var cW=this.getEntryStreamer(cU.tocEntry);cW.conversion=true;var cP=cW.readUncompressedInt(false);var cD=cW.readUncompressedInt(false);var cX=cW.readUncompressedInt(false);for(var cS=0;cS<cX;cS++){var cP=cW.readUncompressedInt(false);var cR=cW.readUncompressedInt(false);var cD=cW.readUnsignedShort(false);var cO=cW.readUncompressedInt(false);this.name=cW.readUnicodeString(cO/2)}cW.conversion=false;var cH=cU.getChildContainer("MAIN");var cG=this.getEntryStreamer(cH.tocEntry);var cK=cH.unstreamHeaderUVR(cG);if(cK){return cK}var cJ=cU.getChildContainer("Options");var cL=this.getEntryStreamer(cJ.tocEntry);cL.setContainer(cU);var cI=cL.readUnsignedChar();if(cI>=5){var cV=cL.readUnsignedChar()}else{}var cC=cU.getChildContainer("Skeleton");if(!cC){return null}var cQ=this.getEntryStreamer(cC.tocEntry);cQ.setContainer(cU);cQ.version=cH.header.version;cQ.conversion=cH.header.conversion;cQ.bitBoolean=1;cQ.bitPacking=1;cQ.gasPacking=1;cQ.expandCGR=this.expand;var cB=cQ.readClassName();var cE=cQ.getUnstreamer(cB);cA=cE.unstream(cQ)}else{var cT=cU.getChildContainer("SceneGraph");var cK=cT.unstreamHeaderCGR();if(cK){return cK}var cQ=cT.getStreamerByName("MainDataStream");cQ.expandCGR=this.expand;var cB=cQ.readClassName();var cE=cQ.getUnstreamer(cB);cA=cE.unstream(cQ)}cQ.check();return this.buildSceneGraph({axisSystems:cQ.axisSystems.getArray(),refPlanes:cQ.refPlanes.getArray(),texts:cQ.texts.getArray(),resource:cQ.textures.getArray(),materials:cQ.materials.getArray(),sgRep:cQ.sgRep,decorations:cQ.decorations.getConcatenatedBlocks(),reps:cQ.reps,rep:cA})};this.openSceneGraph=function(cB,cD){this.FTA=true;h=true;var cF=new aF();cF.setFromBuffer(cB);var cH=new W(cF);cH.version=1101410;var cJ=[];cH.readBytes(12,cJ);var cA=cH.readUnsignedChar();cH.conversion=!cA;cH.version=cH.readCompressedInt();var cG=cH.readClassName();var cE=cH.getUnstreamer(cG);var cC=cE.unstream(cH);if(cH.error&&cD){cD(cH.error);return{reps:[],sceneGraph:null,resource:[],material:[],axisSystems:[],refPlanes:[],texts:[]}}cH.check();var cI=this.buildSceneGraph({axisSystems:cH.axisSystems.getArray(),refPlanes:cH.refPlanes.getArray(),texts:cH.texts.getArray(),resource:cH.textures.getArray(),materials:cH.materials.getArray(),sgRep:cH.sgRep,decorations:cH.decorations.getConcatenatedBlocks(),reps:cH.reps,rep:cC});if(cC.noShow&&this.withSceneGraph){cI.sceneGraph.noShow=true}if(this.withSceneGraph){return cI}else{return{mesh:cI.reps[0],resource:cI.resource,material:cI.material,axisSystems:cI.axisSystems,refPlanes:cI.refPlanes,texts:cI.texts,excludeReps:cI.reps[2]}}};this.setThicknessTable=function(cA){ak=cA};this.getBufferFromEntry=function(cG){var cF=0;var cC=cG.blocReader.blocs;for(var cE=0;cE<cC.length;++cE){cF+=cC[cE].length}var cB=new Uint8Array(cF);var cH=0;for(var cE=0;cE<cC.length;++cE){var cA=cC[cE];for(var cD=0;cD<cA.length;++cD){cB[cH]=cm.buffer[cA.offset+cD];cH++}}return cB};this.getRootContainer=function(){if(cs){return cs}else{cs=new bE(this,cn.getRootTocEntry());cs.name="MAIN";return cs}};this.getStreamer=function(cF,cC){var cA=cn.getChildEntry(cF,cC);if(cA==null){return null}var cG=0;var cB=new aF(cm.clone());for(var cD=0;cD<cA.blocReader.blocs.length;++cD){cB.addBloc(cA.blocReader.blocs[cD])}var cE=new W(cB);cE.name=cC;return cE};this.getEntryStreamer=function(cD){var cA=new aF(cm.clone());for(var cB=0;cB<cD.blocReader.blocs.length;++cB){cA.addBloc(cD.blocReader.blocs[cB])}var cC=new W(cA);return cC};this.getChildContainer=function(cC,cB){var cA=cn.getChildEntry(cC,cB);if(cA){return new bE(this,cA)}}};var H=function(){var cl=100000;var cn=new ap.Vector3();var cm=new ap.Vector3();this.computeBoundingVolume=function(cs){var cr={min:new ap.Vector3(Infinity,Infinity,Infinity),max:new ap.Vector3(-Infinity,-Infinity,-Infinity)};for(var co=0;co<cs.length;co++){var cp=cs[co];var cq=cp.AABB;if(cq.min[0]<cr.min.x){cr.min.x=cq.min[0]}if(cq.min[1]<cr.min.y){cr.min.y=cq.min[1]}if(cq.min[2]<cr.min.z){cr.min.z=cq.min[2]}if(cq.max[0]>cr.max.x){cr.max.x=cq.max[0]}if(cq.max[1]>cr.max.y){cr.max.y=cq.max[1]}if(cq.max[2]>cr.max.z){cr.max.z=cq.max[2]}}return cr};this.partitionObjects=function(cs,cq){var cp=cn;cp.subVectors(cq.max,cq.min);var co=0;var cr=cp.x;if(cp.y>cp.x){co=1;cr=cp.y}if(cp.z>cr){co=2;cr=cp.z}cs.sort(function(cv,cu){var ct=cv.AABB.max[co];var cw=cu.AABB.max[co];if(ct===cw){ct=cv.AABB.max[(co+1)%3];cw=cu.AABB.max[(co+1)%3];if(ct===cw){ct=cv.AABB.max[(co+2)%3];cw=cu.AABB.max[(co+2)%3];return cw-ct}return cw-ct}return cw-ct});return Math.floor(0.5*cs.length)};this.countTriangles=function(cu){var ct=0;for(var cp=0;cp<cu.length;cp++){var cr=cu[cp];var cs=cr.drawingGroups;for(var co=0;co<cs.length;co++){var cq=cs[co];if(cq.glType>=4){ct+=cq.count/3}}}return ct};this.buildBVH=function(cu,ct,co){var cq={type:0,objects:null,bbox:null,leftRightNode:[]};cq.bbox=this.computeBoundingVolume(cu);if(ct){ct.leftRightNode[co]=cq}if((cu.length===1)||(this.countTriangles(cu)<=cl)){cq.type=1;cq.objects=cu}else{var cs=this.partitionObjects(cu,cq.bbox);var cp=cu.slice(0,cs);var cr=cu.slice(cs,cu.length);if(cp.length){this.buildBVH(cp,cq,0)}if(cr.length){this.buildBVH(cr,cq,1)}}return cq};this.cullingBVH=function(cs,ct){var cq=ct.planes;var cu;var cp=cn;cp.addVectors(cs.min,cs.max).multiplyScalar(0.5);cm.subVectors(cs.max,cs.min);var co=0.5*cm.length();for(var cr=0;cr<6;cr++){cu=cq[cr].distanceToPoint(cp);if(cu<=-co){return false}}return true};this.getRenderListFromBVH=function(co,cq,cp){if(cp&&!this.cullingBVH(co.bbox,cp)){return}if(co.type===1){cq.push(co.objects.slice())}else{co.leftRightNode[0]&&this.getRenderListFromBVH(co.leftRightNode[0],cq,cp);co.leftRightNode[1]&&this.getRenderListFromBVH(co.leftRightNode[1],cq,cp)}}};var aU=function(){this.tabBuffer=[];this.size=0;this.chunkSize=1048576;this.currentBuffer=0;this.currentPositionInBuffer=0;this.add=function(cm,cn){this.tabBuffer[cn]=cm;this.size+=cm.length};this.push=function(cm){this.tabBuffer.push(cm);this.size+=cm.length};this.read=function(){if(this.currentPositionInBuffer>=this.chunkSize){this.currentBuffer++;this.currentPositionInBuffer=0}return this.tabBuffer[this.currentBuffer][this.currentPositionInBuffer++]};this.setPosition=function(cm){this.currentBuffer=Math.floor(cm/this.chunkSize);this.currentPositionInBuffer=cm%this.chunkSize};this.readAt=function(cm){return this.tabBuffer[Math.floor(cm/this.chunkSize)][cm%this.chunkSize]};this.length=function(){return this.size};var cl=function(cn,cm){if(((position%this.chunkSize)+cm)<this.chunkSize){return this.tabBuffer[Math.floor(position/this.chunkSize)]}else{return null}};this.readDouble=function(co){var cm=new DataView(this.tabBuffer[this.currentBuffer].buffer);var cn=cm.getFloat64(this.currentPositionInBuffer,true);this.currentPositionInBuffer+=8;return cn};this.clone=function(){var cn=new aU();for(var cm=0;cm<this.tabBuffer.length;++cm){cn.tabBuffer.push(this.tabBuffer[cm])}cn.chunkSize=this.chunkSize;return cn};this.arrayCopy=function(cr,cp,cm){var cq=0;nbBytesToCopy=cp;while(nbBytesToCopy>0){if(nbBytesToCopy==this.chunkSize-this.currentPositionInBuffer){this.currentBuffer++;this.currentPositionInBuffer=0}else{if(nbBytesToCopy>=this.chunkSize-this.currentPositionInBuffer){var co=new Uint8Array(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,this.chunkSize-this.currentPositionInBuffer);var cn=new Uint8Array(cm,cr+cq,this.chunkSize-this.currentPositionInBuffer);cn.set(co);cq+=this.chunkSize-this.currentPositionInBuffer;nbBytesToCopy-=this.chunkSize-this.currentPositionInBuffer;this.currentBuffer++;this.currentPositionInBuffer=0}else{var co=new Uint8Array(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,nbBytesToCopy);var cn=new Uint8Array(cm,cr+cq,nbBytesToCopy);cn.set(co);this.currentPositionInBuffer+=nbBytesToCopy;return}}}};this.getDataViews=function(co,cn){views=[];this.setPosition(co);var cm=cn;while(cm>0){if(cm<=this.chunkSize-this.currentPositionInBuffer){views.push({dataView:new DataView(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,cm),buffer:this.tabBuffer[this.currentBuffer],offset:this.currentPositionInBuffer});cm=0}else{views.push({dataView:new DataView(this.tabBuffer[this.currentBuffer].buffer,this.currentPositionInBuffer,this.chunkSize-this.currentPositionInBuffer),buffer:this.tabBuffer[this.currentBuffer],offset:this.currentPositionInBuffer});cm-=this.chunkSize-this.currentPositionInBuffer;this.currentBuffer++;this.currentPositionInBuffer=0}}return views}};var aF=function(cl){this.multiPartReader=cl;this.currentPositionInView=0;this.position=0;this.offsetsInStream=[];this.dataViews=[];this.currentView=null;this.currentBuffer=null;this.offsetInBuffer=0,this.currentViewIndex=0;this.intMaxOffset=0;this.shortMaxOffset=0;this.doubleMaxOffset=0};aF.prototype.addBloc=function(cl){var cn=this.multiPartReader.getDataViews(cl.offset,cl.length);var cm=this.dataViews.length;var co=this.offsetsInStream.length?this.offsetsInStream[this.offsetsInStream.length-1]:0;this.dataViews=this.dataViews.concat(cn);for(var cp=cm;cp<this.dataViews.length;++cp){if(cp==0){this.offsetsInStream.push(0)}else{this.offsetsInStream.push(this.offsetsInStream[cp-1]+this.dataViews[cp-1].dataView.byteLength)}}if(this.currentView===null){this.currentView=this.dataViews[0].dataView;this.currentBuffer=this.dataViews[0].buffer;this.offsetInBuffer=this.dataViews[0].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8}};aF.prototype.setFromBuffer=function(cl){this.dataViews.push({dataView:new DataView(cl.buffer,0,cl.length),buffer:cl,offset:0});this.offsetsInStream.push(0);this.currentView=this.dataViews[0].dataView;this.currentBuffer=this.dataViews[0].buffer;this.offsetInBuffer=this.dataViews[0].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8};aF.prototype.getBytesRemain=function(){var cl=this.currentView.byteLength-this.currentPositionInView;for(var cm=this.currentViewIndex+1;cm<this.dataViews.length;cm++){if(this.dataViews[cm]){var cn=this.dataViews[cm].dataView;cl+=cn.byteLength}}return cl};aF.prototype.read=function(){if(this.currentPositionInView<this.currentView.byteLength){return this.currentBuffer[this.offsetInBuffer+this.currentPositionInView++]}else{this.currentViewIndex++;this.currentView=this.dataViews[this.currentViewIndex].dataView;this.currentBuffer=this.dataViews[this.currentViewIndex].buffer;this.offsetInBuffer=this.dataViews[this.currentViewIndex].offset;this.currentPositionInView=0;this.intMaxOffset=this.currentView.byteLength-4;this.shortMaxOffset=this.currentView.byteLength-2;this.doubleMaxOffset=this.currentView.byteLength-8;return this.currentBuffer[this.offsetInBuffer+this.currentPositionInView++]}};aF.prototype.getCurrentPosition=function(){return this.offsetsInStream[this.currentViewIndex]+this.currentPositionInView};aF.prototype.setPosition=function(cl){var cn=0;var cm=0;while(cl>cn+this.dataViews[cm].dataView.byteLength){cn+=this.dataViews[cm].dataView.byteLength;cm++}this.currentViewIndex=cm;this.currentView=this.dataViews[this.currentViewIndex].dataView;this.currentBuffer=this.dataViews[this.currentViewIndex].buffer;this.offsetInBuffer=this.dataViews[this.currentViewIndex].offset;this.currentPositionInView=cl-cn};var b1=new Uint8Array(8);var aj=new Int32Array(b1.buffer);var bT=new Uint32Array(b1.buffer);var aT=new Int16Array(b1.buffer);var bs=new Uint16Array(b1.buffer);var aE=new Float32Array(b1.buffer);var az=new Float64Array(b1.buffer);aF.prototype.readDouble=function(cl){if(cl){b1[7]=this.read();b1[6]=this.read();b1[5]=this.read();b1[4]=this.read();b1[3]=this.read();b1[2]=this.read();b1[1]=this.read();b1[0]=this.read()}else{b1[0]=this.read();b1[1]=this.read();b1[2]=this.read();b1[3]=this.read();b1[4]=this.read();b1[5]=this.read();b1[6]=this.read();b1[7]=this.read()}return az[0]};aF.prototype.readFloatBorder=function(cl){if(cl){b1[3]=this.read();b1[2]=this.read();b1[1]=this.read();b1[0]=this.read()}else{b1[0]=this.read();b1[1]=this.read();b1[2]=this.read();b1[3]=this.read()}return aE[0]};var V=new Float32Array(1);var aI=new Uint8Array(V.buffer);aF.prototype.readFloat=function(cl){if(this.currentPositionInView<this.intMaxOffset){var cm=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=4;if(cl){aI[3]=this.currentBuffer[cm],aI[2]=this.currentBuffer[cm+1],aI[1]=this.currentBuffer[cm+2],aI[0]=this.currentBuffer[cm+3]}else{aI[0]=this.currentBuffer[cm],aI[1]=this.currentBuffer[cm+1],aI[2]=this.currentBuffer[cm+2],aI[3]=this.currentBuffer[cm+3]}return V[0]}else{return this.readFloatBorder(cl)}};aF.prototype.readIntBorder=function(cl){if(cl){b1[3]=this.read();b1[2]=this.read();b1[1]=this.read();b1[0]=this.read()}else{b1[0]=this.read();b1[1]=this.read();b1[2]=this.read();b1[3]=this.read()}return aj[0]};aF.prototype.readUIntBorder=function(cl){if(cl){b1[3]=this.read();b1[2]=this.read();b1[1]=this.read();b1[0]=this.read()}else{b1[0]=this.read();b1[1]=this.read();b1[2]=this.read();b1[3]=this.read()}return bT[0]};aF.prototype.readInt=function(co){if(this.currentPositionInView<this.intMaxOffset){var cq=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=4;var cn=this.currentBuffer[cq],cm=this.currentBuffer[cq+1],cl=this.currentBuffer[cq+2],cp=this.currentBuffer[cq+3];if(co){return((cn<<24))+(cm<<16)+(cl<<8)+(cp)}else{return((cp<<24))+(cl<<16)+(cm<<8)+(cn)}}else{return this.readIntBorder(co)}};aF.prototype.readUncompressedInt=function(cm){if(this.currentPositionInView<this.intMaxOffset){var cl=this.currentView.getUint32(this.currentPositionInView,cm);this.currentPositionInView+=4;return cl}else{return this.readUIntBorder(cm)}};aF.prototype.readUnsignedShortBorder=function(cl){if(cl){b1[0]=this.read();b1[1]=this.read()}else{b1[1]=this.read();b1[0]=this.read()}return bs[0]};aF.prototype.readShortBorder=function(cl){if(cl){b1[0]=this.read();b1[1]=this.read()}else{b1[1]=this.read();b1[0]=this.read()}return aT[0]};aF.prototype.readUnsignedShort=function(cn){if(this.currentPositionInView<this.shortMaxOffset){var co=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=2;var cm=this.currentBuffer[co],cl=this.currentBuffer[co+1];return(cm<<8&65280)|(cl&255)}else{return this.readUnsignedShortBorder(cn)}};aF.prototype.readShort=function(co){if(this.currentPositionInView<this.shortMaxOffset){var cp=this.offsetInBuffer+this.currentPositionInView;this.currentPositionInView+=2;var cm=this.currentBuffer[cp],cl=this.currentBuffer[cp+1];if(co){var cn=(cm&127)<<8|cl;cn=cn-((cm&128)<<8);return cn}else{var cn=(cl&127)<<8|cm;cn=cn-((cl&128)<<8);return cn}}else{return this.readShortBorder(co)}};aF.prototype.readShortArrayBuffer=function(cq,cl,cr){var cm=2*cq;if(this.currentPositionInView+2*cq<this.currentView.byteLength){var co=new Uint8Array(cl.buffer);var cp=this.offsetInBuffer+this.currentPositionInView;if(cr){for(var cn=0;cn<cq;++cn){co[2*cn+1]=this.currentBuffer[cp+2*cn];co[2*cn]=this.currentBuffer[cp+2*cn+1]}}else{for(var cn=0;cn<cm;++cn){co[cn]=this.currentBuffer[cp+cn]}}this.currentPositionInView+=cm}else{for(var cn=0;cn<cq;++cn){cl[offset+cn]=this.readShort(cr)}}};aF.prototype.unpackc24=function(cp,cn,cl){if(this.currentPositionInView+3*cn<this.currentView.byteLength){for(var cm=0;cm<cn;++cm){var co=this.offsetInBuffer+this.currentPositionInView;cl[cm+cp]=(this.currentBuffer[co+3*cm]<<16&16711680)|(this.currentBuffer[co+3*cm+1]<<8&65280)|(this.currentBuffer[co+3*cm+2]&255)}this.currentPositionInView+=3*cn}else{for(var cm=0;cm<cn;++cm){cl[cm+cp]=(this.read()<<16&16711680)|(this.read()<<8&65280)|(this.read()&255)}}};aF.prototype.readShortArray=function(cs,cq,cm,cr){if(this.currentPositionInView+2*cq<this.currentView.byteLength){if(this.conversion){for(var co=0;co<cq;++co){var cn=this.currentBuffer[2*co];var cl=this.currentBuffer[2*co+1];var cp=(cn&127)<<8|cl;cm[cs+co]=cp-((cn&128)<<8)}}else{for(var co=0;co<cq;++co){var cn=this.currentBuffer[2*co];var cl=this.currentBuffer[2*co+1];var cp=(cn&127)<<8|cl;cm[cs+co]=cp-((cn&128)<<8)}}this.currentPositionInView+=2*cq}else{for(var co=0;co<cq;++co){cm[cs+co]=this.readShort(cr)}}};aF.prototype.readBytesArrayBuffer=function(cp,co,cl){if(this.currentPositionInView+co<this.currentView.byteLength){var cn=this.offsetInBuffer+this.currentPositionInView;for(var cm=0;cm<co;++cm){cl[cp+cm]=this.currentBuffer[cn+cm]}this.currentPositionInView+=co}else{for(var cm=0;cm<co;++cm){cl[cp+cm]=this.read()}}};aF.prototype.readBytes=function(cp,co,cl){if(this.currentPositionInView+co<this.currentView.byteLength){var cn=this.offsetInBuffer+this.currentPositionInView;for(var cm=0;cm<co;++cm){cl[cp+cm]=this.currentBuffer[cn+cm]}this.currentPositionInView+=co}else{for(var cm=0;cm<co;++cm){cl[cp+cm]=this.read()}}};aF.prototype.getByteView=function(co,cl){if(this.currentPositionInView+co<this.currentView.byteLength){var cn=new Uint8Array(this.currentBuffer.buffer,this.offsetInBuffer+this.currentPositionInView,co);this.currentPositionInView+=co;return cn}else{for(var cm=0;cm<co;++cm){cl[cm]=this.read()}return cl}};aF.prototype.readUnsignedShortArray=function(cq,co,cl,cp){if(this.currentPositionInView+2*co<this.currentView.byteLength){var cn=this.offsetInBuffer+this.currentPositionInView;if(!cp){for(var cm=0;cm<co;++cm){b1[1]=this.currentBuffer[cn+2*cm];b1[0]=this.currentBuffer[cn+2*cm+1];cl[cq+cm]=bs[0]}}else{for(var cm=0;cm<co;++cm){b1[0]=this.currentBuffer[cn+2*cm];b1[1]=this.currentBuffer[cn+2*cm+1];cl[cq+cm]=bs[0]}}this.currentPositionInView+=2*co}else{for(var cm=0;cm<co;++cm){cl[cq+cm]=this.readUnsignedShort(cp)}}};aF.prototype.readFloatArrayBuffer=function(cp,cl,cq){if(this.currentPositionInView+4*cp<this.currentView.byteLength){if(cq){var co=new Uint8Array(cl.buffer);var cm=4*cp;var cr=this.offsetInBuffer+this.currentPositionInView;for(var cn=0;cn<cp;++cn){co[4*cn+3]=this.currentBuffer[cr+4*cn];co[4*cn+2]=this.currentBuffer[cr+4*cn+1];co[4*cn+1]=this.currentBuffer[cr+4*cn+2];co[4*cn]=this.currentBuffer[cr+4*cn+3]}this.currentPositionInView+=4*cp}else{var co=new Uint8Array(cl.buffer);var cm=4*cp;var cr=this.offsetInBuffer+this.currentPositionInView;for(var cn=0;cn<cm;++cn){co[cn]=this.currentBuffer[cr+cn]}this.currentPositionInView+=cm}}else{for(var cn=0;cn<cp;++cn){cl[cn]=this.readFloat(cq)}}};aF.prototype.readFloatArray=function(cr,cp,cl,cq){if(this.currentPositionInView+4*cp<this.currentView.byteLength){var cm=this.currentPositionInView+4*cp;var co=cr;while(this.currentPositionInView<cm){cl[co++]=this.readFloat(cq)}}else{for(var cn=0;cn<cp;++cn){cl[cr+cn]=this.readFloat(cq)}}};var X=function(){var cm=[];var cl=[];this.remove=function(cn){cm.splice(cn,1)};this.add=function(co){var cn=cm.length;cm[cn]=co;return cn};this.addAt=function(co,cn){cm[cn]=co};this.isValidIndex=function(cn){return cn<cm.length};this.get=function(cn){return cm[cn]};this.getArray=function(){return cm};this.isValidMultiRefIndex=function(cn){if(cl[cn]!==undefined){return true}else{return false}};this.isValidMultiRefIndexWithName=function(co,cn){if(cl[co]!==undefined){for(var cp=0;cp<cl[co].length;cp++){if(cl[co][cp].streamerName===cn){return true}}return false}else{return false}};this.addMultiRefIndex=function(cn,co){cl[cn]=co};this.addMultiRefIndexWithName=function(cn,cp,co){if(cl[cn]!==undefined){cl[cn].push({index:cp,streamerName:co})}else{cl[cn]=[{index:cp,streamerName:co}]}};this.getIndex=function(cn){return cl[cn]};this.getIndexWithName=function(co,cp){var cn=cl[co];for(var cq=0;cq<cn.length;cq++){if(cn[cq].streamerName===cp){return cn[cq].index}}return null}};return an});define("Formats/CGRFile",["DS/Formats/CGRFile","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Formats/CGRFile");return b});