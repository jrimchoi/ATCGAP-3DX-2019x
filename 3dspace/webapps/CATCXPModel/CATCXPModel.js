define("DS/CATCXPModel/interfaces/CATICXPEnvironment",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPEnvironment",required:{},optional:{}});return a});define("DS/CATCXPModel/interfaces/CATICXPMaterialApplication",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPMaterialApplication",required:{SetMaterialLink:function(){},GetMaterialLink:function(){return undefined}},optional:{}});return a});define("DS/CATCXPModel/extensions/CATE3DActorMovable",["UWA/Core","MathematicsES/MathsDef","DS/CAT3DExpModel/CAT3DXInterfaceImpl","UWA/Class/Events","UWA/Class/Listener"],function(f,d,c,a,e){var b=f.Class.extend(c,a,e,{destroy:function(){this._parent();this.stopListening()},Build:function(){var g=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"_varposition.CHANGED",function(h){g.dispatchEvent("TRANSFORM_CHANGED",[h])})},GetLocalPosition:function(h){if(!(h instanceof d.Transformation)){throw new TypeError("iTransform argument is not a DSMath.Transformation")}var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition");h.setFromArray(g)},SetLocalPosition:function(h,g){if(!(g instanceof d.Transformation)){throw new TypeError("iTransform argument is not a DSMath.Transformation")}this.QueryInterface("CATI3DExperienceObject").SetValueByName("_varposition",g.getArray())},GetAbsPosition:function(j){var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition");j.setFromArray(h);var k,i;k=this.QueryInterface("CATICXPObject").GetFatherObject();if(k){i=k.QueryInterface("CATIMovable")}if(i){var g=new d.Transformation();i.GetAbsPosition(g);j.setFromArray(d.Transformation.multiply(g,j).getArray())}},SetAbsPosition:function(h){var k,j;k=this.QueryInterface("CATICXPObject").GetFatherObject();if(k){j=k.QueryInterface("CATIMovable")}if(j){var g=new d.Transformation();j.GetAbsPosition(g);var i=d.Transformation.multiply(g.getInverse(),h);this.QueryInterface("CATI3DExperienceObject").SetValueByName("_varposition",i.getArray())}else{this.QueryInterface("CATI3DExperienceObject").SetValueByName("_varposition",h.getArray())}}});return b});define("DS/CATCXPModel/extensions/CATE3DXExperienceUIRep",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","UWA/Class/Listener","DS/Core/Events"],function(e,b,d,a){var c=b.extend(d,{init:function(){this._parent();this._experienceUIRep=null;this.frameUIChanges=[]},destroy:function(){this._parent();this.stopListening();this._experienceUIRep=null;this.frameUIChanges=[]},_Create:function(){var f=this;var g=e.createElement("div");g.style.position="absolute";g.style.left="0px";g.style.right="0px";g.style.top="0px";g.style.bottom="0px";g.style.pointerEvents="none";this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"actors.CHANGED",function(){f.frameUIChanges.push(f._addUIChildren);f.RequestUIRefresh()});this.frameUIChanges.push(this._addUIChildren);this.RequestUIRefresh();return g},Refresh:function(){for(var f=0;f<this.frameUIChanges.length;++f){this.frameUIChanges[f].call(this)}this.frameUIChanges.length=0},RequestUIRefresh:function(){var f=this.GetObject().QueryInterface("CATI3DXUIRep");if(e.is(f)){a.publish({event:"STU_UI_CHANGED",data:{CATI3DXUIRep:f}})}},_addUIChildren:function(){while(this._experienceUIRep.firstChild){this._experienceUIRep.firstChild.remove()}var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("actors");for(var f=0;f<g.length;f++){var h=g[f].QueryInterface("CATI3DXUIRep");if(e.is(h)){var j=h.Get();j.inject(this._experienceUIRep)}}},Get:function(){if(this._experienceUIRep===null){this._experienceUIRep=this._Create()}return this._experienceUIRep},Show:function(){this.Get().show();var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("actors");for(var f=0;f<g.length;f++){var h=g[f].QueryInterface("CATI3DXUIRep");if(e.is(h)){h.Show()}}},Hide:function(){this.Get().hide();var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("actors");for(var f=0;f<g.length;f++){var h=g[f].QueryInterface("CATI3DXUIRep");if(e.is(h)){h.Hide()}}}});return c});define("DS/CATCXPModel/interfaces/CATICXPScenariosMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPScenariosMgr",required:{CreateAndAddScenario:function(){return undefined},AddScenario:function(){},RemoveScenario:function(){},ListScenarios:function(){return undefined},SetStartupScenario:function(){},GetStartupScenario:function(){return undefined},IsStartupScenario:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/extensions/VIAEIxpWizardedScenarioDescriptor",["UWA/Core","MathematicsES/MathsDef","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CAT3DExpModel/CAT3DXModel","UWA/Class/Events","UWA/Class/Listener"],function(g,c,b,d,a,e){var f=g.Class.extend(b,a,e,{init:function(){this._parent()},destroy:function(){this._parent();this.stopListening()},Build:function(){var h=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"acts.CHANGED",function(i){h.dispatchEvent("ACTS.CHANGED",[i])});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"startupAct.CHANGED",function(i){h.dispatchEvent("STARTUPACT.CHANGED",[i])})},Clear:function(){var h=this.QueryInterface("CATI3DExperienceObject");h.SetValueByName("acts",[])},NewAct:function(h){return d.CreateAct(h,this.GetObject())},AddAct:function(i){var j=this.QueryInterface("CATI3DExperienceObject");if(!g.is(j)){g.log("ERROR on AddAct, unable to retrieve CATI3DExperienceObject !");return}var h=j.GetValueByName("acts");h.push(i);j.SetValueByName("acts",h);if(h.length===1){this.SetStartupAct(i)}},RemoveAct:function(k){if(!g.is(k)){g.log("ERROR RemoveAct : invalid parameter !");return}var j=this.GetActs();var i=j.indexOf(k);if(i>=0){j.splice(i,1);var h=this.QueryInterface("CATI3DExperienceObject");h.SetValueByName("acts",j);if(this.GetStartupAct()===k){if(j.length>0){this.SetStartupAct(j[0])}else{this.SetStartupAct(undefined)}}}else{var m=k.QueryInterface("CATI3DExperienceObject");var l=m.GetValueByName("_varName");g.log("ERROR RemoveAct : unable to find act named : "+l)}},GetActs:function(){var i=this.QueryInterface("CATI3DExperienceObject");if(!g.is(i)){g.log("ERROR on GetActs, unable to retrieve CATI3DExperienceObject !");return undefined}var h=i.GetValueByName("acts");if(!g.is(h)){g.log("ERROR on GetActs, unable to get acts !");return undefined}return h},GetActCount:function(){var h=this.GetActs();if(!g.is(h)){g.log("ERROR on GetActCount, unable to get acts !");return null}return h.length},SetStartupAct:function(h){var i=this.QueryInterface("CATI3DExperienceObject");if(!g.is(i)){g.log("ERROR on SetStartupAct, unable to retrieve CATI3DExperienceObject !");return}i.SetValueByName("startupAct",h)},GetStartupAct:function(){var i=this.QueryInterface("CATI3DExperienceObject");if(!g.is(i)){g.log("ERROR on GetStartupAct, unable to retrieve CATI3DExperienceObject !");return undefined}var h=i.GetValueByName("startupAct");if(!g.is(h)){g.log("WARNING on GetStartupAct, startup act not set !");return undefined}return h},GetActByIndex:function(i){var h=this.GetActs();if(i<0||i>=h.length){return undefined}return h[i]},GetActIndex:function(i){var h=this.GetActs();return h.indexOf(i)},MoveActToPosition:function(j,l){var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("acts");var h=this.GetActIndex(j);if(h>=0){i.splice(h,1)}if(l<0||l>i.length){return}i.splice(l,0,j);k.SetValueByName("acts",i)},MoveActBeforeOtherAct:function(k,j){var m=this.QueryInterface("CATI3DExperienceObject");var i=m.GetValueByName("acts");var h=this.GetActIndex(k);if(h>=0){i.splice(h,1)}var l=this.GetActIndex(j);if(l<0){return}i.splice(l,0,k);m.SetValueByName("acts",i)},MoveActAfterOtherAct:function(k,j){var m=this.QueryInterface("CATI3DExperienceObject");var i=m.GetValueByName("acts");var h=this.GetActIndex(k);if(h>=0){i.splice(h,1)}var l=this.GetActIndex(j);if(l<0){return}i.splice(l+1,0,k);m.SetValueByName("acts",i)},MoveUpAct:function(i){var j=this.QueryInterface("CATI3DExperienceObject");var h=j.GetValueByName("acts");var k=this.GetActIndex(i);k--;if(k<0){return}h.splice(k+1,1);h.splice(k,0,i);j.SetValueByName("acts",h)},MoveDownAct:function(i){var j=this.QueryInterface("CATI3DExperienceObject");var h=j.GetValueByName("acts");var k=this.GetActIndex(i);if(k<0||k===h.length-1){return}k++;h.splice(k-1,1);h.splice(k,0,i);j.SetValueByName("acts",h)}});return f});define("DS/CATCXPModel/extensions/CATECXPActorsMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CAT3DExpModel/CAT3DXModel","UWA/Class/Events","UWA/Class/Listener"],function(f,b,c,a,e){var d=f.Class.extend(b,a,e,{init:function(){this._parent()},destroy:function(){this._parent();this.stopListening()},Build:function(){var g=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"actors.CHANGED",function(h){g.dispatchEvent("ACTORS.CHANGED",[h])})},CreateAndAddActor:function(g,h){return c.CreateActor(h,g,this.GetObject())},ListActors:function(k){var g=this.QueryInterface("CATI3DExperienceObject");var j=g.GetValueByName("actors");if(!(k instanceof Array)){f.log("StuInstanceExperienceObject.ListActors ERROR : unable to fill parameters, not an array !");return}k.splice(0,k.length);k.length=j.length;var h=j.length;while(h--){k[h]=j[h]}},RemoveActor:function(g){return c.DeleteActor(g)},AddActor:function(i){var g=this.QueryInterface("CATI3DExperienceObject");var h=g.GetValueByName("actors");h.push(i);g.SetValueByName("actors",h)},Count:function(){var g=this.QueryInterface("CATI3DExperienceObject");var h=g.GetValueByName("actors");return h.length}});return d});define("DS/CATCXPModel/extensions/CATECXPEnvironment",["UWA/Core"],function(b){var a=b.Class.extend({});return a});define("DS/CATCXPModel/extensions/CATE3DGeoVisu",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/Visualization/Node3D","UWA/Class/Events","UWA/Class/Listener"],function(f,b,c,a,e){var d=f.Class.extend(b,a,e,{init:function(){this._parent();this._node3D=null;this._pathElement=null;this._override=null;this.frameVisuChanges=[]},Build:function(){this.setReady(false)},destroy:function(){if(this._node3D){this._node3D.removeChildren();var g=this._node3D.parents;for(var h=g.length-1;h>=0;--h){g[h].remove(this._node3D)}this._node3D=null}this.frameVisuChanges=[];this._ready=false;this.stopListening()},Get:function(){console.warn("CATI3DGeoVisu.GET() DEPRECATED use GetNode() instead");return this.GetNode()},_Create:function(){console.warn("CATI3DGeoVisu._Create() DEPRECATED use _CreateNode() instead");return this._CreateNode()},GetNode:function(){return this._node3D?this._node3D:this._CreateNode()},GetPathElement:function(){return this._pathElement?this._pathElement:this._CreatePathElement()},GetOverride:function(){return this._override?this._override:this._CreateOverride()},GetLocalNodes:function(){return null},_CreateNode:function(){this._node3D=new c();this._Fill(this._node3D);return this._node3D},_CreateOverride:function(){var g=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager");var i=g.getOverrideSet();var h=this.GetPathElement();this._override=i.createOverride(h);return this._override},_Fill:function(h){var g=this.GetObject();if(h._components){h._components.push(g);h.name=h.name+" ; "+g.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")}else{h._components=[g];h.name=g.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")}this.RequestVisuRefresh()},RequestVisuRefresh:function(){var g=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager");g.refreshGeoVisu(this)},Refresh:function(){for(var g=0;g<this.frameVisuChanges.length;++g){this.frameVisuChanges[g].call(this)}this.frameVisuChanges.length=0},isReady:function(){return this._ready}});return d});define("DS/CATCXPModel/extensions/CATE3DActorPreviewable",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","UWA/Class/Events"],function(d,b,a){var c=d.Class.extend(b,a,{init:function(){this._parent();this._dirty=true;this._PreviewSrc=undefined;this._callbackStack=[]},destroy:function(){this._parent();this._dirty=false;this._PreviewSrc=null;this._callbackStack=null},GetPreview:function(h,g,f){var e=this;g=g?g:null;f=Boolean(f);if(f){this._updatePreview(h,g);return}if(this._dirty){this._callbackStack.push(h);if(!this._updatingPreview){this._updatingPreview=true;this._updatePreview(function(i){e._PreviewSrc=i;e._executeCallback();e._updatingPreview=false;e._dirty=false},g)}}else{h(this._PreviewSrc)}},_updatePreview:function(g,f){var e=this.GetObject()._experienceBase.getManager("CAT3DXPreviewManager");e.getPreview(this.QueryInterface("CATI3DGeoVisu"),g,f)},DirtyPreview:function(){this._dirty=true;this.dispatchEvent("PreviewDirty")},_executeCallback:function(){while(this._callbackStack.length>0){this._callbackStack[0](this._PreviewSrc);this._callbackStack.splice(0,1)}}});return c});define("DS/CATCXPModel/extensions/CATECXPAmbienceEnvironmentActivate",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","UWA/Class/Listener","DS/Visualization/ThreeJS_DS"],function(e,a,d,c){var b=a.extend(d,{init:function(){this._parent();this._initialAmbience=null;this._ambience=null;this._frameVisuChanges={}},Activate:function(){var f=this;var g=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();this._initialAmbience=g.ambience;this.QueryInterface("CATI3DXAssetHolder").resolveAsset().done(function(h){f._ambience=h;g.setVisuEnv("CleanSpace");g.displayInfinitePlane(false,false);g.setAmbience(h);f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Exposure.CHANGED",function(){f._addFrameVisuChanges("exposure",f._refreshExposure,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Radius.CHANGED",function(){f._addFrameVisuChanges("domeRadius",f._refreshDomeRadius,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Origin X.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Origin Y.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Origin Z.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Rotation X.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Rotation Y.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Dome Rotation Z.CHANGED",function(){f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Ground Scale Ratio.CHANGED",function(){f._addFrameVisuChanges("groundScale",f._refreshGroundScaleRatio,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Ground Offset.CHANGED",function(){f._addFrameVisuChanges("groundOffset",f._refreshGroundOffset,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Ground Reflectivity.CHANGED",function(){f._addFrameVisuChanges("groundReflectivity",f._refreshGroundReflectivity,true)});f.listenTo(f.QueryInterface("CATI3DExperienceObject"),"Ground Glossiness.CHANGED",function(){f._addFrameVisuChanges("groundGlossiness",f._refreshGroundGlossiness,true)});f._addFrameVisuChanges("exposure",f._refreshExposure);f._addFrameVisuChanges("domeRadius",f._refreshDomeRadius);f._addFrameVisuChanges("domeTransform",f._refreshDomeTransform);f._addFrameVisuChanges("groundScale",f._refreshGroundScaleRatio);f._addFrameVisuChanges("groundOffset",f._refreshGroundOffset);f._addFrameVisuChanges("groundReflectivity",f._refreshGroundReflectivity);f._addFrameVisuChanges("groundGlossiness",f._refreshGroundGlossiness,true)})},_refreshExposure:function(){},_refreshDomeRadius:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Radius");if(f===0){this._ambience.setFiniteMode(false)}else{this._ambience.setGroundRadius(f);this._ambience.setFiniteMode(true)}},_refreshDomeTransform:function(){var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Origin X");var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Origin Y");var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Origin Z");var l=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Rotation X");var k=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Rotation Y");var j=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Dome Rotation Z");var i=new c.Matrix4();i.setRotationFromEuler(new c.Vector3(l*Math.PI/180,k*Math.PI/180,j*Math.PI/180));i.setPosition(new c.Vector3(h,g,f));this._ambience.setTransform(i)},_refreshGroundScaleRatio:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Ground Scale Ratio");this._ambience.setGroundHeight(new c.Vector3(0,0,f/6))},_refreshGroundOffset:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Ground Offset");this._ambience.setGroundOffset(f)},_refreshGroundReflectivity:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Ground Reflectivity");this._ambience.setGroundReflectivitiy(f)},_refreshGroundGlossiness:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("Ground Glossiness");this._ambience.setGroundGlossiness(f)},Deactivate:function(){this.stopListening();var f=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();if(this._initialAmbience){f.setAmbience(this._initialAmbience)}else{f.removeAmbience()}this._initialAmbience=null;this._ambience=null;this._frameVisuChanges={};this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").forceViewerRefresh()},_addFrameVisuChanges:function(h,g,f){this._frameVisuChanges[h]=g;if(f){this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").refreshGeoVisu(this)}},Refresh:function(){for(var f in this._frameVisuChanges){this._frameVisuChanges[f].call(this)}this._frameVisuChanges={}}});return b});define("DS/CATCXPModel/extensions/CATECXPBehaviorsMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CAT3DExpModel/CAT3DXModel","UWA/Class/Events","UWA/Class/Listener"],function(f,b,d,a,e){var c=f.Class.extend(b,a,e,{init:function(){this._parent()},destroy:function(){this._parent();this.stopListening()},Build:function(){var g=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"behaviors.CHANGED",function(h){g.dispatchEvent("BEHAVIORS.CHANGED",[h])})},ListBehaviors:function(k){if(!(k instanceof Array)){console.log("CATECXPBehaviorsMgr.ListBehaviors ERROR : unable to fill parameters, not an array !");return}k.length=0;var h=this.QueryInterface("CATI3DExperienceObject");var g=h.GetValueByName("behaviors");for(var j=0;j<g.length;j++){k.push(g[j])}},RemoveBehavior:function(g){return d.DeleteBehavior(g)},CreateAndAddBehavior:function(g,h){return d.CreateBehavior(h,g,this.GetObject())},AddBehavior:function(i){var h=this.QueryInterface("CATI3DExperienceObject");var g=h.GetValueByName("behaviors");g.push(i);h.SetValueByName("behaviors",g)}});return c});define("DS/CATCXPModel/extensions/CATECXP3DActorModifiable",["UWA/Core","DS/CAT3DExpModel/extensions/CATEModifiable"],function(c,a){var b=a.extend({init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}if(d==="_varposition"){return this._toVCXLocation(d)}return undefined},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}if(f==="_varposition"){return this._fromVCXLocation(d)}return undefined}});return b});define("DS/CATCXPModel/interfaces/CATICXPActorsMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPActorsMgr",required:{CreateAndAddActor:function(){return undefined},ListActors:function(){},RemoveActor:function(){},AddActor:function(){},Count:function(){return undefined}},optional:{}});return a});define("DS/CATCXPModel/extensions/CATECXP3DActorMaterialsMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,b){var a=b.extend({CreateAndAddMaterialFromAsset:function(){},ListMaterials:function(f){var e=[];this.ListMaterialApplications(e);f.splice(0,f.length);f.length=e.length;var d=e.length;while(d--){f[d]=e[d].QueryInterface("CATICXPMaterialApplication").GetMaterialLink()}return f},ListMaterialApplications:function(f){if(!Array.isArray(f)){console.error("oMaterialsList must be an array!");return undefined}var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("materials");f.splice(0,f.length);f.length=e.length;var d=e.length;while(d--){f[d]=e[d]}return e},RemoveMaterial:function(f){var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("materials");var d=e.map(function(g){return g.QueryInterface("CATICXPMaterialApplication").GetMaterialLink()}).indexOf(f);e.splice(d,1);this.QueryInterface("CATI3DExperienceObject").SetValueByName("materials",e)},ApplyMaterial:function(){},GetActiveMaterialApplicationForVisualization:function(){var d=this.QueryInterface("CATI3DExperienceObject").GetValueByName("materials");if(d.length!==1){return undefined}return d[0]}});return a});define("DS/CATCXPModel/interfaces/CATICXPVariablesInit",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPvariablesInit",required:{Init:function(){}},optional:{},init:function(){this._specNLXML={}},AddNLXMLNodeBySpec:function(d,e){this._specNLXML[d]=e},GetNLXMLNodeBySpec:function(d){return this._specNLXML[d]},ClearNLXML:function(){this._specNLXML={}}});return b});define("DS/CATCXPModel/extensions/CATECXPExperienceScenariosMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXModel","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(d,c,b){var a=b.extend({init:function(){this._parent()},destroy:function(){this._parent()},CreateAndAddScenario:function(e){return c.CreateScenario(e).done(function(f){return d.Promise.resolve(f)})},AddScenario:function(g){var f=this.QueryInterface("CATI3DExperienceObject");var h=f.GetValueByName("scenarios");var e=h.indexOf(g);if(e<0){h.push(g);f.SetValueByName("scenarios",h)}},RemoveScenario:function(g){var f=this.QueryInterface("CATI3DExperienceObject");var h=f.GetValueByName("scenarios");var e=h.indexOf(g);if(e>=0){h.splice(e,1);f.SetValueByName("scenarios",h)}},ListScenarios:function(){var e=this.QueryInterface("CATI3DExperienceObject");return e.GetValueByName("scenarios")},SetStartupScenario:function(f){var e=this.QueryInterface("CATI3DExperienceObject");var g=e.GetValueByName("PlaySettings");if((g)&&(g.QueryInterface("CATI3DExperienceObject"))){g.QueryInterface("CATI3DExperienceObject").SetValueByName("startupScenario",f)}},GetStartupScenario:function(){var e=this.QueryInterface("CATI3DExperienceObject");var f=e.GetValueByName("PlaySettings");if((f)&&(f.QueryInterface("CATI3DExperienceObject"))){return f.QueryInterface("CATI3DExperienceObject").GetValueByName("startupScenario")}return undefined},IsStartupScenario:function(e){if(this.GetStartupScenario()===e){return true}return false}});return a});define("DS/CATCXPModel/interfaces/CATICXPObject",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPObject",required:{GetRootFather:function(){return undefined},GetFatherObject:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/interfaces/CATICXPMaterialsVisu",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPMaterialsVisu",required:{refreshMaterials:function(){}},optional:{}});return b});define("DS/CATCXPModel/extensions/VIAEIxpCubicSubSectionPath",["UWA/Core"],function(b){var a=b.Class.extend({init:function(f,e,d,c){this._Pt1=f;this._Pt2=e;this._Tgt1=d;this._Tgt2=c;this._approximationNbSamplePt=20;this._length=0;this._l=[];this._updateData()},getLength:function(){return this._length},getValueFromLengthRatio:function(c){var d=this._getParametrizationFromLengthRatio(c);return this._Pt1.clone().multiplyScalar(1-3*Math.pow(d,2)+2*Math.pow(d,3)).addVectorToVector(this._Pt2.clone().multiplyScalar(3*Math.pow(d,2)-2*Math.pow(d,3))).addVectorToVector(this._Tgt1.clone().multiplyScalar(d-2*Math.pow(d,2)+Math.pow(d,3))).addVectorToVector(this._Tgt2.clone().multiplyScalar(Math.pow(d,3)-Math.pow(d,2)))},_getParametrizationFromLengthRatio:function(e){var h=-1;var g=e*this._length;if(this._l.length>=this._approximationNbSamplePt){var f=0;if(g>=this._l[this._approximationNbSamplePt/2]){f=this._approximationNbSamplePt/2}while(g>=this._l[f]&&f<this._approximationNbSamplePt-1){f++}f--;var d=(this._l[f+1]-this._l[f]);if(d!==0){var c=(g-this._l[f])/d;if(this._P1&&this._P2&&this._P3&&this._P4&&f>=0&&f<(this._approximationNbSamplePt-1)){h=this._P1[f]*Math.pow(c,3)+this._P2[f]*Math.pow(c,2)+this._P3[f]*c+this._P4[f]}}}return h},_updateData:function(){var y=this._approximationNbSamplePt-1;this._P1=this._initArray(y);this._P2=this._initArray(y);this._P3=this._initArray(y);this._P4=this._initArray(y);var r=2*this._Pt1.x+this._Tgt1.x-2*this._Pt2.x+this._Tgt2.x;var G=-3*this._Pt1.x-2*this._Tgt1.x+3*this._Pt2.x-this._Tgt2.x;var k=this._Tgt1.x;var q=2*this._Pt1.y+this._Tgt1.y-2*this._Pt2.y+this._Tgt2.y;var E=-3*this._Pt1.y-2*this._Tgt1.y+3*this._Pt2.y-this._Tgt2.y;var j=this._Tgt1.y;var p=2*this._Pt1.z+this._Tgt1.z-2*this._Pt2.z+this._Tgt2.z;var C=-3*this._Pt1.z-2*this._Tgt1.z+3*this._Pt2.z-this._Tgt2.z;var h=this._Tgt1.z;var I=9*(Math.pow(r,2)+Math.pow(q,2)+Math.pow(p,2));var H=12*(r*G+q*E+p*C);var F=6*(r*k+q*j+p*h)+4*(Math.pow(G,2)+Math.pow(E,2)+Math.pow(C,2));var D=4*(G*k+E*j+C*h);var A=Math.pow(k,2)+Math.pow(j,2)+Math.pow(h,2);var B=1/(this._approximationNbSamplePt-1);var o=this._initArray(this._approximationNbSamplePt);var f=this._initArray(this._approximationNbSamplePt);var g=this._initArray(this._approximationNbSamplePt);for(var x=0;x<this._approximationNbSamplePt;x++){var l=x*B;o[x]=l;f[x]=0;g[x]=0;var n=I*Math.pow(l,4)+H*Math.pow(l,3)+F*Math.pow(l,2)+D*l+A;if(n>=0){f[x]=Math.sqrt(n);if(f[x]!==0){g[x]=(4*I*Math.pow(l,3)+3*H*Math.pow(l,2)+2*F*l+D)/(2*f[x])}}if(x===0){this._l.push(0)}else{var w=B*(g[x]+g[x-1])+2*(f[x-1]-f[x]);var v=3*(f[x]-f[x-1])-B*(2*g[x-1]+g[x]);var u=g[x-1]*B;var s=f[x-1];var z=B*((w/4)+(v/3)+(u/2)+s);var m=this._l[this._l.length-1];this._l.push(m+z);if(f[x-1]!==0&&f[x]!==0){this._P1[x-1]=2*o[x-1]+(z/f[x-1])-2*o[x]+(1/f[x])*z;this._P2[x-1]=-3*o[x-1]-2*(z/f[x-1])+3*o[x]-(z/f[x]);this._P3[x-1]=(z/f[x-1]);this._P4[x-1]=o[x-1]}}}this._length=this._l[this._approximationNbSamplePt-1]},_initArray:function(d){var e=[];for(var c=0;c<d;c++){e.push(0)}return e}});return a});define("DS/CATCXPModel/interfaces/CATICXPBehaviorsMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPBehaviorsMgr",required:{ListBehaviors:function(){},RemoveBehavior:function(){},AddBehavior:function(){},CreateAndAddBehavior:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/CATCXPModelExtension",["UWA/Core","DS/CAT3DExpModel/CAT3DXModelExtensionImpl","text!DS/CATCXPModel/assets/CATCXPModel.json","text!DS/CATCXPModel/assets/CATCXPModelAddIn.json","text!DS/CATCXPModel/assets/CATCXPModelInterfaces.json","text!DS/CATCXPModel/assets/CATCXPModelExtensions.json","text!DS/CATCXPLightModel/assets/CATCXPLightModelExtensions.json","text!DS/CATCXPLightModel/assets/CATCXPLightModelInterfaces.json"],function(d,g,b,h,e,c,f,i){var a=g.extend({GetInterfaces:function(){return[JSON.parse(e),JSON.parse(i)]},GetExtensions:function(){return[JSON.parse(c),JSON.parse(f)]},GetComponents:function(){return[JSON.parse(b),JSON.parse(h)]}});return a});define("DS/CATCXPModel/interfaces/CATICXPUIActor",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPUIActor",required:{SetOffset:function(){},GetOffset:function(){return undefined},SetMinimumDimension:function(){},GetMinimumDimension:function(){return undefined},GetDimension:function(){return undefined},SetAttachment:function(){},SetEnable:function(){},GetEnable:function(){return undefined},SetOpacity:function(){},GetOpacity:function(){return undefined},SetVisible:function(){},GetVisible:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/extensions/CATECXPMaterialsVisu",["UWA/Core","UWA/Class/Listener","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/Visualization/ThreeJS_DS"],function(e,d,a,b){var c=e.Class.extend(a,d,{init:function(){this._linkedMaterialListeners={};this._materialApplicationListeners={};this._frameVisuChanges={};this._textureMapListTransform={}},refreshMaterials:function(){this._clearLinkedMaterialListeners();this._clearMaterialApplicationListeners();var f=this;this._activeMaterialApplication=this.QueryInterface("CATICXPMaterialsMgr").GetActiveMaterialApplicationForVisualization();this._linkedMaterial=null;this._materialAsset=null;this._activeMaterialApplicationEo=null;if(!this._activeMaterialApplication){this._addFrameVisuChanges("removeMaterial",function(){f.QueryInterface("CATI3DGeoVisu").GetOverride().setMaterial(null,false)},true);return}this._activeMaterialApplicationEo=this._activeMaterialApplication.QueryInterface("CATI3DExperienceObject");this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"linktomaterial",function(){f._addFrameVisuChanges("refreshLinkedMaterial",f._refreshLinkedMaterial,true)});this._addFrameVisuChanges("refreshLinkedMaterial",this._refreshLinkedMaterial,true);this._refreshMaterialApplicationVariables()},_refreshMaterialApplicationVariables:function(){var f=this;this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"Offset_U",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"Offset_V",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"Scale",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"Scale_Ratio",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addMaterialApplicationListener(this._activeMaterialApplicationEo,"Angle",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)})},_refreshLinkedMaterial:function(){this._clearLinkedMaterialListeners();this._linkedMaterial=this._activeMaterialApplication.QueryInterface("CATI3DExperienceObject").GetValueByName("linktomaterial");this._materialAsset=null;this._appearance=null;var f=this;if(!this._linkedMaterial){this._addFrameVisuChanges("removeMaterial",function(){f.QueryInterface("CATI3DGeoVisu").GetOverride().setMaterial(null,false)},true);return}this._linkedMaterial.QueryInterface("CATI3DXAssetHolder").resolveAsset().done(function(g){f._materialAsset=g.clone();setTimeout(function(){f._refreshLinkedMaterialAppearance();f.QueryInterface("CATI3DGeoVisu").GetOverride().setMaterial(f._materialAsset,false);f.GetObject()._experienceBase.getManager("CAT3DXVisuManager").refreshGeoVisu(f)},200)})},_refreshLinkedMaterialAppearance:function(){this._appearance=this._linkedMaterial.QueryInterface("CATI3DExperienceObject").GetValueByName("appearance");this._appearanceEo=this._appearance.QueryInterface("CATI3DExperienceObject");this._initTextureApplication();var f=this;this._addLinkedMaterialListener(this._appearanceEo,"angle",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"scaleU",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"scaleV",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"offsetU",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"offsetV",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"flipU",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addLinkedMaterialListener(this._appearanceEo,"flipV",function(){f._addFrameVisuChanges("textureApplication",f._refreshTextureApplication,true)});this._addFrameVisuChanges("textureApplication",f._refreshTextureApplication);this._addLinkedMaterialListener(this._appearanceEo,"type",function(){f._addFrameVisuChanges("mappingOperator",f._refreshMappingOperator,true)});this._addFrameVisuChanges("mappingOperator",f._refreshMappingOperator);this._addLinkedMaterialListener(this._appearanceEo,"repeatU",function(g){f._addFrameVisuChanges("repeatU",function(){f._refreshRepeat(g,"wrapS")},true)});this._addLinkedMaterialListener(this._appearanceEo,"repeatV",function(g){f._addFrameVisuChanges("repeatV",function(){f._refreshRepeat(g,"wrapT")},true)});this._addFrameVisuChanges("repeat",function(){f._refreshRepeat(this._appearanceEo.GetValueByName("repeatU"),"wrapS");f._refreshRepeat(this._appearanceEo.GetValueByName("repeatV"),"wrapT")})},_initTextureApplication:function(){this._textureMapListTransform={};for(var f in this._textureMapList){if(this._materialAsset[f]){this._materialAsset[f]=this._materialAsset[f].clone();this._materialAsset[f].flipY=true;this._textureMapListTransform[f]=this._materialAsset[this._textureMapList[f]].clone()}}},_refreshTextureApplication:function(){for(var f in this._textureMapList){if(this._materialAsset[f]){this._materialAsset[this._textureMapList[f]]=this._getMappingMatrix(this._textureMapListTransform[f])}}},_textureMapList:{map:"diffuseUvTransform",specularMap:"specularUvTransform",emissiveMap:"emissiveUvTransform",glossinessMap:"roughnessUvTransform",roughnessMap:"roughnessUvTransform",anisotropyMap:"anisotropyUvTransform",anisotropyAngleMap:"anisotropyAngleUvTransform",opacityMap:"opacityUvTransform",normalMap:"normalUvTransform",coatingGlossinessMap:"coatingGlossinessUvTransform",coatingBumpMap:"coatingBumpUvTransform"},_getMappingMatrix:function(i){var f=this._appearance.QueryInterface("CATI3DExperienceObject");var r=f.GetValueByName("angle");var w=f.GetValueByName("scaleU");var v=f.GetValueByName("scaleV");var u=f.GetValueByName("offsetU");var t=f.GetValueByName("offsetV");var k=f.GetValueByName("flipU");var j=f.GetValueByName("flipV");var m=Math.cos(-r);var q=Math.sin(-r);var l=-q;var p=m;var g=new b.Matrix3();g.elements[0]=m;g.elements[1]=q;g.elements[3]=l;g.elements[4]=p;v=w/v;m=w;q=0;l=0;p=v;var n=new b.Matrix3();n.elements[0]=m;n.elements[1]=q;n.elements[3]=l;n.elements[4]=p;m=k?-1:1;q=0;l=0;p=j?-1:1;var s=new b.Matrix3();s.elements[0]=m;s.elements[1]=q;s.elements[3]=l;s.elements[4]=p;var o=i.clone();o=o.multiplyMatrices(o,this._getInverseMatrix3(n));o=o.multiplyMatrices(o,this._getInverseMatrix3(s));var h=new b.Vector3(u,t,1);h.applyMatrix3(o);o.elements[6]=-1*h.x+0.5;o.elements[7]=-1*h.y+0.5;o=o.multiplyMatrices(o,this._getInverseMatrix3(g));return o},_getInverseMatrix3:function(i){var h=i.elements;var g=new b.Matrix4(h[0],h[3],h[6],0,h[1],h[4],h[7],0,h[2],h[5],h[8],0,0,0,0,1);var f=new b.Matrix3();f.getInverse(g);return f},_refreshMappingOperator:function(){var f=this._appearanceEo.GetValueByName("type");var g;switch(f){case 0:g=1;break;case 2:g=5;break;case 1:g=2;break;case 3:g=4;break;case 6:g=0;break;case 8:g=6;break;default:console.warn("unknown mapping operator")}this._materialAsset.setMappingOperator(g)},_refreshRepeat:function(h,f){for(var g in this._textureMapList){if(this._materialAsset[g]){this._materialAsset[g][f]=h?b.RepeatWrapping:b.ClampToEdgeWrapping;this._materialAsset[g].needsUpdate=true}}},_addMaterialApplicationListener:function(h,f,g){if(this._materialApplicationListeners[f]){this.stopListening(this._materialApplicationListeners[f].material,f+".CHANGED",this._materialApplicationListeners[f].callback)}this.listenTo(h,f+".CHANGED",g);this._materialApplicationListeners[f]={material:h,callback:g}},_clearMaterialApplicationListeners:function(){for(var f in this._materialApplicationListeners){this.stopListening(this._materialApplicationListeners[f].material,f+".CHANGED",this._materialApplicationListeners[f].callback)}this._materialApplicationListeners={}},_addLinkedMaterialListener:function(g,f,h){if(this._linkedMaterialListeners[f]){this.stopListening(this._linkedMaterialListeners[f].appearance,f+".CHANGED",this._linkedMaterialListeners[f].callback)}this.listenTo(g,f+".CHANGED",h);this._linkedMaterialListeners[f]={appearance:g,callback:h}},_clearLinkedMaterialListeners:function(){for(var f in this._linkedMaterialListeners){this.stopListening(this._linkedMaterialListeners[f].appearance,f+".CHANGED",this._linkedMaterialListeners[f].callback)}this._linkedMaterialListeners={}},_addFrameVisuChanges:function(h,g,f){this._frameVisuChanges[h]=g;if(f){this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").refreshGeoVisu(this)}},Refresh:function(){for(var f in this._frameVisuChanges){this._frameVisuChanges[f].call(this)}this._frameVisuChanges={}}});return c});define("DS/CATCXPModel/extensions/CATE3DXUIActorUIRep",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","UWA/Class/Listener","DS/Core/Events","DS/CATCXPCIDModel/CXPUIRepFactory","DS/CAT3DExpModel/interfaces/CATI3DXUIRep","DS/Visualization/ThreeJS_DS"],function(h,d,f,a,g,c,e){var b=d.extend(f,{init:function(){this._parent();this._UIActorRep=null;this.frameUIChanges=[]},destroy:function(){this._parent();this.stopListening();this._UIActorRep.destroy();this._UIActorRep=null;this.frameUIChanges=[]},_Create:function(){var j=this;var l=this.QueryInterface("CATI3DExperienceObject");var m=l.GetValueByName("data");if(m){var i=m.QueryInterface("CATI3DExperienceObject");var k=this.GetObject()._experienceBase.getManager("CAT3DXUIManager").getFactory().createRep(i.GetValueByName("__configurationName__"),l);this.listenTo(l,"offset.CHANGED",function(){j.frameUIChanges.push(j._refreshOffset);j.RequestUIRefresh()});this.listenTo(l,"attachment.CHANGED",function(){j.frameUIChanges.push(j._refreshAttachment);j.RequestUIRefresh()});this.frameUIChanges.push(j._refreshAttachment);this.frameUIChanges.push(j._refreshOffset);this.RequestUIRefresh();return k}else{return this.GetObject()._experienceBase.getManager("CAT3DXUIManager").getFactory().createRep("undefined",l)}},Refresh:function(){for(var j=0;j<this.frameUIChanges.length;++j){this.frameUIChanges[j].call(this)}this.frameUIChanges.length=0},RequestUIRefresh:function(){var i=this.QueryInterface("CATI3DXUIRep");if(h.is(i)){a.publish({event:"STU_UI_CHANGED",data:{CATI3DXUIRep:i}})}},_refreshAttachment:function(){var j=this.QueryInterface("CATI3DExperienceObject");var l=j.GetValueByName("attachment");var k=l.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("side");if(i===c.Attachment.ESide.e3DActor){this._UIActorRep.attachTo3D(k.GetValueByName("target"))}else{if(this._UIActorRep.isAttachTo3D()){this._UIActorRep.detachFrom3D()}}},_refreshOffset:function(){var l=this.QueryInterface("CATI3DExperienceObject");var r=l.GetValueByName("attachment");var s=r.QueryInterface("CATI3DExperienceObject");var u=s.GetValueByName("side");var n=this.QueryInterface("CATICXPUIActor").GetDimension();var j=n.width;var x=n.height;var w=this.QueryInterface("CATICXPUIActor").GetMinimumDimension();if(u!==c.Attachment.ESide.eTopLeft&&j===0&&x===0&&l.GetValueByName("visible")&&(w.width!==0||w.height!==0)){var y=this;setTimeout(function(){y.frameUIChanges.push(y._refreshOffset);y.RequestUIRefresh()},200);return}var m=l.GetValueByName("offset");var i=m.QueryInterface("CATI3DExperienceObject");var q=i.GetValueByName("x");var o=i.GetValueByName("y");var k,v;switch(u){case c.Attachment.ESide.eTopLeft:k=q+"px";v=o+"px";break;case c.Attachment.ESide.eTop:k="calc(50% + "+(q-j/2)+"px)";v=o+"px";break;case c.Attachment.ESide.eTopRight:k="calc(100% + "+(q-j)+"px)";v=o+"px";break;case c.Attachment.ESide.eLeft:k=q+"px";v="calc(50% + "+(o-x/2)+"px)";break;case c.Attachment.ESide.eCenter:k="calc(50% + "+(q-j/2)+"px)";v="calc(50% + "+(o-x/2)+"px)";break;case c.Attachment.ESide.eRight:k="calc(100% + "+(q-j)+"px)";v="calc(50% + "+(o-x/2)+"px)";break;case c.Attachment.ESide.eBottomLeft:k=q+"px";v="calc(100% + "+(o-x)+"px)";break;case c.Attachment.ESide.eBottom:k="calc(50% + "+(q-j/2)+"px)";v="calc(100% + "+(o-x)+"px)";break;case c.Attachment.ESide.eBottomRight:k="calc(100% + "+(q-j)+"px)";v="calc(100% + "+(o-x)+"px)";break;case c.Attachment.ESide.e3DActor:var t=this.QueryInterface("CATI3DXUIRep").Get().get2DNode();t.setOffset(new e.Vector2(q,o));var p=this.GetObject()._experienceBase.webApplication.frmWindow.getViewer();p.render();return;default:break}this._UIActorRep.left=k;this._UIActorRep.top=v},Show:function(){this.Get().show()},Hide:function(){this.Get().hide()},Get:function(){if(this._UIActorRep===null){this._UIActorRep=this._Create()}return this._UIActorRep}});return b});define("DS/CATCXPModel/extensions/CATECXPPictureResource",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,a){var b=a.extend({GetPictureSizeInPixel:function(){var d=this;return new c.Promise(function(e){d.QueryInterface("CATI3DXAssetHolder").resolveAsset().done(function(f){e({w:f.width,h:f.height})})})}});return b});define("DS/CATCXPModel/interfaces/CATICXPPictureResource",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPPictureResource",required:{GetPictureSizeInPixel:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/extensions/CATECXPExperienceMaterialsMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CAT3DExpModel/CAT3DXModel"],function(c,b){var a=b.extend({CreateAndAddMaterialFromAsset:function(){},ListMaterials:function(f){if(!Array.isArray(f)){console.error("oMaterialsList must be an array!");return undefined}var d=this.QueryInterface("CATI3DExperienceObject").GetValueByName("materials");f.splice(0,f.length);f.length=d.length;var e=d.length;while(e--){f[e]=d[e]}return d},ListMaterialApplications:function(){},RemoveMaterial:function(e){var d=this.QueryInterface("CATI3DExperienceObject").GetValueByName("materials");d.splice(d.indexOf(e),1);this.QueryInterface("CATI3DExperienceObject").SetValueByName("materials",d)},ApplyMaterial:function(){},GetActiveMaterialApplicationForVisualization:function(){}});return a});define("DS/CATCXPModel/extensions/CATECXPMaterialApplication",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,b){var a=c.Class.extend(b,{SetMaterialLink:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("linktomaterial",d)},GetMaterialLink:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("linktomaterial")}});return a});define("DS/CATCXPModel/interfaces/CATICXPResourcesMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPResourcesMgr",required:{CreateAndAddResourceFromAsset:function(){return undefined},AddResource:function(){},RemoveResource:function(){},ListResources:function(){return undefined},Count:function(){return undefined},GetResource:function(){return undefined}},optional:{}});return a});define("DS/CATCXPModel/extensions/CATE3DXUIActorGraphicalProperties",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,b){var a=b.extend({init:function(){this._parent()},GetShowMode:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("visible")},SetShowMode:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("visible",d)},GetOpacity:function(){var d=this.QueryInterface("CATI3DExperienceObject").GetValueByName("opacity");if(undefined===d){d=255}return d},SetOpacity:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("opacity",d)},GetRed:function(){},GetGreen:function(){},GetBlue:function(){},SetColor:function(){},GetPickMode:function(){},SetPickMode:function(){}});return a});define("DS/CATCXPModel/extensions/VIAEIxpLinearPath",["UWA/Core","DS/Visualization/ThreeJS_DS","MathematicsES/MathsDef"],function(d,c,b){var a=d.Class.extend({init:function(e){this._pathExtension=e},GetLength:function(){var e=[];this._pathExtension.GetDefinePoints(e);var g=0;if(e.length<2){return g}for(var f=0;f<e.length-1;f++){g+=this._getSubSectionLength(e[f],e[f+1])}return g},_getSubSectionLength:function(f,e){var i=f.QueryInterface("CATI3DExperienceObject").GetValueByName("position");var h=e.QueryInterface("CATI3DExperienceObject").GetValueByName("position");var g=new c.Vector3(h[0]-i[0],h[1]-i[1],h[2]-i[2]);return g.length()},GetValue:function(f,q,n){if((f>1)||(f<0)){d.log("VIAEIxpVirtualPath.GetValue ERROR : iCurvParam not in the range[0,1] !");return}var e=[];this._pathExtension.GetDefinePoints(e);if(e.length<2){return}var m=f*this._pathExtension.GetLength();var g=0;var i=0;var r=0;while(((g+r)<=m)&&(i<e.length-1)){g+=r;r=this._getSubSectionLength(e[i],e[i+1]);i++}var p=e[i-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position");var o=e[i].QueryInterface("CATI3DExperienceObject").GetValueByName("position");var l=m-g;var j=l/r;var k=new b.Vector3D(p[0]+(o[0]-p[0])*j,p[1]+(o[1]-p[1])*j,p[2]+(o[2]-p[2])*j);if(d.is(q)){console.ward("not implemented yet TODO")}else{var h=new b.Transformation();this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(h);n.x=h.vector.x+k.x;n.y=h.vector.y+k.y;n.z=h.vector.z+k.z}}});return a});define("DS/CATCXPModel/extensions/CATECXPObject",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,b){var a=b.extend({init:function(){this._parent()},destroy:function(){this._parent()},GetRootFather:function(){console.log("CATECXPObject.GetRootFather WARNING : not Implemented yet!");return undefined},GetFatherObject:function(){var e=this.QueryInterface("CATI3DExperienceObject").getXCTComponent();if(!e){return undefined}var d=e.GetParent();if(!d){return undefined}return d._omComponent}});return a});define("DS/CATCXPModel/extensions/CATECXPSampleEnvironmentActivate",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,a){var b=a.extend({init:function(){this._parent()},Activate:function(){var d=this.GetObject()._experienceBase.webApplication.frmWindow.getViewer();d.setBackgroundColor(this.QueryInterface("CATI3DExperienceObject").GetValueByName("color"))},Deactivate:function(){var d=this.GetObject()._experienceBase.webApplication.frmWindow.getViewer();d.setBackgroundColor("#ffffff")}});return b});define("DS/CATCXPModel/extensions/CATECXPEnvironmentsMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,a){var b=a.extend({init:function(){this._parent();this._activeEnvironment=null},destroy:function(){this._parent();this._activeEnvironment=null},CreateAndAddEnvironmentFromAsset:function(){},RemoveEnvironment:function(d){var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("environments");e.splice(e.indexOf(d),1);this.QueryInterface("CATI3DExperienceObject").SetValueByName("environments",e);if(d===this.GetActiveEnvironment()){this.SetActiveEnvironment()}},ListEnvironments:function(f){if(!Array.isArray(f)){console.error("ohenvs must be an array!");return undefined}var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("environments");f.splice(0,f.length);f.length=e.length;var d=e.length;while(d--){f[d]=e[d]}return e},SetStartupEnvironment:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("startupEnvironment",d)},GetStartupEnvironment:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("startupEnvironment")},SetStartupLocation:function(){console.warn("not implemented")},GetStartupLocation:function(){console.warn("not implemented")},SetAuthoringEnvironment:function(){console.warn("not implemented")},GetAuthoringEnvironment:function(){console.warn("not implemented")},SetActiveEnvironment:function(d){this._activeEnvironment=this.GetActiveEnvironment();if(this._activeEnvironment){this._activeEnvironment.QueryInterface("CATICXPEnvironmentActivate").Deactivate()}if(d){d.QueryInterface("CATICXPEnvironmentActivate").Activate();this._activeEnvironment=d}else{this._activeEnvironment=null}},GetActiveEnvironment:function(){return this._activeEnvironment},DeActivateForExit:function(){console.warn("not implemented")},SetActiveLocation:function(){console.warn("not implemented")},GetActiveLocation:function(){console.warn("not implemented")},CheckLocationPositions:function(){console.warn("not implemented")},CheckLocationPosition:function(){console.warn("not implemented")}});return b});define("DS/CATCXPModel/interfaces/VIAIIxpWizardedScenarioDescriptor",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"VIAIIxpWizardedScenarioDescriptor",required:{Clear:function(){},NewAct:function(){return undefined},AddAct:function(){},RemoveAct:function(){},GetActs:function(){return undefined},GetActCount:function(){return undefined},GetStartupAct:function(){return undefined},SetStartupAct:function(){},GetActByIndex:function(){return undefined},GetActIndex:function(){return undefined},MoveActToPosition:function(){},MoveActBeforeOtherAct:function(){},MoveActAfterOtherAct:function(){},MoveUpAct:function(){},MoveDownAct:function(){}},optional:{}});return b});define("DS/CATCXPModel/interfaces/CATICXPScenesMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPScenesMgr",required:{CreateAndAddScene:function(){return undefined},AddScene:function(){},RemoveScene:function(){},ListScenes:function(){return undefined}},optional:{}});return a});define("DS/CATCXPModel/interfaces/CATICXPEnvironmentActivate",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"CATICXPEnvironmentActivate",required:{Activate:function(){},Deactivate:function(){}},optional:{}});return a});define("DS/CATCXPModel/extensions/CATE3DX3DActorGraphicalProperties",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/VCXWebProperties/VCXColor","DS/VCXWebProperties/VCXPropertyValueColor"],function(e,b,a,c){var d=b.extend({init:function(){this._parent()},GetPickMode:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("clickable");if(undefined===f){f=true}return f},SetPickMode:function(f){this.QueryInterface("CATI3DExperienceObject").SetValueByName("clickable",f)},GetShowMode:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("visible");if(undefined===f){f=true}return f},SetShowMode:function(f){this.QueryInterface("CATI3DExperienceObject").SetValueByName("visible",f)},GetOpacity:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("opacity");if(undefined===f){f=255}return f},SetOpacity:function(f){this.QueryInterface("CATI3DExperienceObject").SetValueByName("opacity",f)},GetRed:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("color");if(!f){return undefined}f=f.GetValue();return Math.ceil(f.r*255)},GetGreen:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("color");if(!f){return undefined}f=f.GetValue();return Math.ceil(f.g*255)},GetBlue:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("color");if(!f){return undefined}f=f.GetValue();return Math.ceil(f.b*255)},GetThreeColor:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("color");if(!f){return undefined}f=f.GetValue();var g=f.GetThreeColor();return g},SetColor:function(i,j,f){var h=new a().FromRGBA(i/255,j/255,f/255,1);var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("color");if(!g){g=new c()}g.SetValue(h);this.QueryInterface("CATI3DExperienceObject").SetValueByName("color",g)}});return d});define("DS/CATCXPModel/extensions/CATECXPUIActor",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl"],function(c,b){var a=b.extend({SetOffset:function(f){var d=this.QueryInterface("CATI3DExperienceObject");var g=d.GetValueByName("offset");var e=g.QueryInterface("CATI3DExperienceObject");e.SetValueByName("x",f.x);e.SetValueByName("y",f.y);d.SetValueByName("offset",g)},GetOffset:function(){var d=this.QueryInterface("CATI3DExperienceObject");var f=d.GetValueByName("offset");var e=f.QueryInterface("CATI3DExperienceObject");return{x:e.GetValueByName("x"),y:e.GetValueByName("y")}},SetMinimumDimension:function(f,i,h){var d=this.QueryInterface("CATI3DExperienceObject");var g=d.GetValueByName("minimumDimension");var e=g.QueryInterface("CATI3DExperienceObject");e.SetValueByName("width",f);e.SetValueByName("height",i);if(h){e.SetValueByName("mode",h)}d.SetValueByName("minimumDimension",g)},GetMinimumDimension:function(){var d=this.QueryInterface("CATI3DExperienceObject");var f=d.GetValueByName("minimumDimension");var e=f.QueryInterface("CATI3DExperienceObject");return{width:e.GetValueByName("width"),height:e.GetValueByName("height"),mode:e.GetValueByName("mode")}},GetDimension:function(){var d=this.QueryInterface("CATI3DXUIRep");var e=d.Get();return{width:e.clientWidth,height:e.clientHeight}},SetAttachment:function(d,f){var e=this.QueryInterface("CATI3DExperienceObject");var g=e.GetValueByName("attachment");var h=g.QueryInterface("CATI3DExperienceObject");h.SetValueByName("side",d);h.SetValueByName("target",f);e.SetValueByName("attachment",g)},GetAttachment:function(){var d=this.QueryInterface("CATI3DExperienceObject");var f=d.GetValueByName("attachment");var e=f.QueryInterface("CATI3DExperienceObject");return{side:e.GetValueByName("side"),target:e.GetValueByName("target")}},SetEnable:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("enable",d)},GetEnable:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("enable")},SetOpacity:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("opacity",d*255)},GetOpacity:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("opacity"/255)},SetVisible:function(d){this.QueryInterface("CATI3DExperienceObject").SetValueByName("visible",d)},GetVisible:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("visible")}});return a});define("DS/CATCXPModel/CATCXPRenderUtils",["UWA/Core","MathematicsES/MathsDef"],function(c,a){var b=c.Class.singleton({getComponentsFromPathElement:function(e,d){var i=e.externalPath.slice();var h=[];while(i.length>0){var g=i[i.length-1];if(g._components){for(var f=0;f<g._components.length;f++){if(i.equals(g._components[f].QueryInterface("CATI3DGeoVisu").GetPathElement().externalPath)){h.push(g._components[f]);if(d){return h}}}}i.pop()}return h},setCameraFromViewpoint:function(i,f){var e=f.camera;var d=e.matrix.elements;var h=[d[8],d[9],d[10],d[0],d[1],d[2],d[4],d[5],d[6],d[12],d[13],d[14]];var g=new a.Transformation();g.setFromArray(h);i.QueryInterface("CATIMovable").SetLocalPosition(null,g);if(i.QueryInterface("CATI3DExperienceObject").GetValueByName("farClip")!==e.near){i.QueryInterface("CATI3DExperienceObject").SetValueByName("farClip",e.near)}if(i.QueryInterface("CATI3DExperienceObject").GetValueByName("nearClip")!==e.far){i.QueryInterface("CATI3DExperienceObject").SetValueByName("nearClip",e.far)}if(i.QueryInterface("CATI3DExperienceObject").GetValueByName("viewAngle")!==e.fov){i.QueryInterface("CATI3DExperienceObject").SetValueByName("viewAngle",f.getAngle()/2)}i.QueryInterface("CATI3DGeoVisu").Refresh(f.viewer)},setViewpointFromCamera:function(m,o,i){var h=i?i:0;var g=new a.Transformation();o.QueryInterface("CATIMovable").GetAbsPosition(g);var f=new a.Quaternion();g.matrix.getQuaternion(f);var d=new a.Point();d.set(-1,0,0);var e=d.applyQuaternion(f);var p=new a.Vector3D();p.set(e.x,e.y,e.z);p.normalize();var n=new a.Point();n.set(0,0,1);var k=n.applyQuaternion(f);var j=new a.Vector3D();j.set(k.x,k.y,k.z);j.normalize();m.moveTo({eyePosition:g.vector.clone(),upDirection:j,sightDirection:p,duration:h});var l=o.QueryInterface("CATI3DExperienceObject");m.setAngle(l.GetValueByName("viewAngle")*2);m.camera.near=l.GetValueByName("nearClip");m.camera.far=l.GetValueByName("farClip")}});return b});define("DS/CATCXPModel/extensions/CATECXP3DActorOverrideModifiable",["UWA/Core","DS/CAT3DExpModel/extensions/CATEModifiable"],function(c,a){var b=a.extend({init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"scale":return this._toVCXFloat(d);case"_varposition":return this._toVCXLocation(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"scale":return d.GetValue();case"_varposition":return this._fromVCXLocation(d);default:return undefined}}});return b});define("DS/CATCXPModel/interfaces/CATICXPEnvironmentsMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPEnvironmentsMgr",required:{CreateAndAddEnvironmentFromAsset:function(){return undefined},RemoveEnvironment:function(){},ListEnvironments:function(){return undefined},SetStartupEnvironment:function(){},GetStartupEnvironment:function(){return undefined},SetStartupLocation:function(){},GetStartupLocation:function(){return undefined},SetAuthoringEnvironment:function(){},GetAuthoringEnvironment:function(){return undefined},SetActiveEnvironment:function(){},GetActiveEnvironment:function(){return undefined},DeActivateForExit:function(){},SetActiveLocation:function(){},GetActiveLocation:function(){return undefined},CheckLocationPositions:function(){},CheckLocationPosition:function(){}},optional:{}});return b});define("DS/CATCXPModel/interfaces/CATICXPMaterialsMgr",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,a){var b=a.singleton({interfaceName:"CATICXPMaterialsMgr",required:{CreateAndAddMaterialFromAsset:function(){return undefined},ListMaterials:function(){return undefined},ListMaterialApplications:function(){return undefined},RemoveMaterial:function(){},ApplyMaterial:function(){},GetActiveMaterialApplicationForVisualization:function(){return undefined}},optional:{}});return b});define("DS/CATCXPModel/interfaces/VIAIIxpVirtualPath",["UWA/Class","DS/WebComponentModeler/CATWebInterface"],function(c,b){var a=b.singleton({interfaceName:"VIAIIxpVirtualPath",required:{AddPoint:function(){},RemovePoint:function(){},InsertPoint:function(){},GetDefinePoints:function(){},GetPointAtIndex:function(){return undefined},GetNumberOfPoint:function(){return undefined},GetLength:function(){return undefined},GetValue:function(){}},optional:{Discretize:function(){},SetInterpolationMode:function(){},GetInterpolationMode:function(){return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPExperienceResourcesMgr",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CAT3DExpModel/CAT3DXModel"],function(d,a,b){var c=a.extend({init:function(){this._parent()},destroy:function(){this._parent()},CreateAndAddResourceFromAsset:function(g){var e=this.QueryInterface("CATI3DExperienceObject");var h=e.GetValueByName("resources");for(var f=0;f<h.length;++f){if(h[f].QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")===g){console.error("a resource named "+g+" is allready registered.");return d.Promise.resolve(h[f])}}return b.CreateResource("CXPPictureResource_Spec",g)},AddResource:function(f){var e=this.QueryInterface("CATI3DExperienceObject");var h=e.GetValueByName("resources");for(var g=0;g<h.length;++g){if(h[g].QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")===f.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")){return h[g]}}h.push(f);e.SetValueByName("resources",h);return h},ListResources:function(){var e=this.QueryInterface("CATI3DExperienceObject");return e.GetValueByName("resources")},RemoveResource:function(e){var g=this.QueryInterface("CATI3DExperienceObject");var f=g.GetValueByName("resources");f.splice(f.indexOf(e),1);g.SetValueByName("resources",f)},Count:function(){var e=this.QueryInterface("CATI3DExperienceObject");return e.GetValueByName("resources").length},GetResource:function(h){var g=this.QueryInterface("CATI3DExperienceObject");var f=g.GetValueByName("resources");var e=f.map(function(i){return i.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName")}).indexOf(h);if(e===-1){return undefined}return f[e]}});return c});define("DS/CATCXPModel/extensions/CATECXPCubeModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"length":return this._toVCXFloat(d);case"width":return this._toVCXFloat(d);case"height":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"length":return d.GetValue();case"width":return d.GetValue();case"height":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPCylinderModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"radius":return this._toVCXFloat(d);case"height":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"radius":return d.GetValue();case"height":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPCameraModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"zoom":return this._toVCXFloat(d);case"viewAngle":return this._toVCXFloat(d);case"nearClip":return this._toVCXFloat(d);case"farClip":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"zoom":return d.GetValue();case"viewAngle":return d.GetValue();case"nearClip":return d.GetValue();case"farClip":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPArrowModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"length":return this._toVCXFloat(d);case"width":return this._toVCXFloat(d);case"headLength":return this._toVCXFloat(d);case"headWidth":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"length":return d.GetValue();case"width":return d.GetValue();case"headLength":return d.GetValue();case"headWidth":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATEExperience3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATE3DGeoVisu","DS/CATCXPModel/CATCXPRenderUtils","DS/Visualization/PathElement"],function(e,c,a,b){var d=c.extend({init:function(){this._parent()},_CreatePathElement:function(){this._pathElement=new b([this.GetNode()]);return this._pathElement},_Fill:function(g){this._parent(g);var f=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"actors.CHANGED",function(){f._node3D.removeChildren();f.frameVisuChanges.push(f._addChildrenNodes);f.RequestVisuRefresh();f.setReady(f._isAllChildrenReady())});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"currentCamera.CHANGED",function(){f.frameVisuChanges.push(f._refreshCurrentCamera);f.RequestVisuRefresh()});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"currentEnvironment.CHANGED",function(){f.frameVisuChanges.push(f._refreshCurrentEnvironment);f.RequestVisuRefresh()});this.frameVisuChanges.push(this._addChildrenNodes);this.frameVisuChanges.push(this._refreshCurrentCamera);this.frameVisuChanges.push(this._refreshCurrentEnvironment);this.setReady(this._isAllChildrenReady())},_addChildrenNodes:function(){var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName("actors");for(var g=0;g<h.length;g++){var j=h[g].QueryInterface("CATI3DGeoVisu");if(e.is(j)){var f=j.GetNode();this._node3D.addChild(f)}}},_refreshCurrentCamera:function(){var f=this.QueryInterface("CATI3DExperienceObject").GetValueByName("currentCamera");var g=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager");var h=g.getViewer();if(this._refreshViewpointCallback){g.removeVisuRefreshCB(this._refreshViewpointCallback);this._refreshViewpointCallback=null}if(f){h.autoUpdateFrustum=false;h.setAutomaticPlaneUpdate(false);this._refreshViewpointCallback=this._refreshViewpoint.bind(this,f);g.pushVisuRefreshCB(this._refreshViewpointCallback)}else{h.autoUpdateFrustum=true;h.setAutomaticPlaneUpdate(true)}},_refreshViewpoint:function(f){var h=this.GetObject()._experienceBase.webApplication.frmWindow.getViewer();var g=h.currentViewpoint;a.setViewpointFromCamera(g,f)},_refreshCurrentEnvironment:function(){var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("currentEnvironment");var f=this.GetObject().QueryInterface("CATICXPEnvironmentsMgr");f.SetActiveEnvironment(g)},setReady:function(f){if(f===this._ready){return}if(f&&(!this._isAllChildrenReady())){return}this._ready=f;this.dispatchEvent("readyChanged",f)},_isAllChildrenReady:function(){var j=this.QueryInterface("CATICXPActorsMgr");if(j){var h=[];j.ListActors(h);for(var f=0;f<h.length;f++){var g=h[f].QueryInterface("CATI3DGeoVisu");if(g){if(!g.isReady()){return false}}}}return true},GetBoundingBox:function(){var g=this.GetPathElement();var h=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();var f;if(this.GetOverride().getVisibility()){f=g.getBoundingBox(null,h,"visibleSpace")}else{f=g.getBoundingBox(null,h,"invisibleSpace")}return f},GetBoundingSphere:function(){var g=this.GetPathElement();var h=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();var f;if(this.GetOverride().getVisibility()){f=g.getBoundingSphere(h,"visibleSpace")}else{f=g.getBoundingSphere(h,"invisibleSpace")}return f}});return d});define("DS/CATCXPModel/extensions/CATECXPPlaneModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"length":return this._toVCXFloat(d);case"width":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"length":return d.GetValue();case"width":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPTorusModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"radius1":return this._toVCXFloat(d);case"radius2":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"radius1":return d.GetValue();case"radius2":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATEVPMOccurrenceMovable",["UWA/Core","MathematicsES/MathsDef","DS/CATCXPModel/extensions/CATE3DActorMovable"],function(d,c,b){var a=b.extend({GetAbsPosition:function(k){var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition");k.setFromArray(h);var f=this.QueryInterface("CATI3DXAssetHolder").getCache();var j=new c.Transformation().setFromArray(f.ParentPositionInAssetContext);k.copy(c.Transformation.multiply(j,k));var g=this.QueryInterface("CATI3DXVisuHierarchy").GetVisuParent();var i=g.QueryInterface("CATIMovable");if(i){var e=new c.Transformation();i.GetAbsPosition(e);k.setFromArray(c.Transformation.multiply(e,k).getArray())}},SetAbsPosition:function(f){var i=this.QueryInterface("CATI3DXVisuHierarchy").GetVisuParent();var k=i.QueryInterface("CATIMovable");if(k){var e=new c.Transformation();k.GetAbsPosition(e);var g=c.Transformation.multiply(e.getInverse(),f);var h=this.QueryInterface("CATI3DXAssetHolder").getCache();var j=new c.Transformation().setFromArray(h.ParentPositionInAssetContext);g=c.Transformation.multiply(j.getInverse(),g);this.QueryInterface("CATI3DExperienceObject").SetValueByName("_varposition",g.getArray())}else{this.QueryInterface("CATI3DExperienceObject").SetValueByName("_varposition",f.getArray())}}});return a});define("DS/CATCXPModel/extensions/CATECXPConeModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"radius":return this._toVCXFloat(d);case"height":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"radius":return d.GetValue();case"height":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPSphereModifiable",["UWA/Core","DS/CATCXPModel/extensions/CATECXP3DActorModifiable"],function(c,b){var a=c.Class.extend(b,{init:function(){this._parent()},_getVCXPropertyValue:function(d){var e=this._parent(d);if(c.is(e)){return e}switch(d){case"radius":return this._toVCXFloat(d);default:return undefined}},_getVariableValue:function(f,d){var e=this._parent(f,d);if(c.is(e)){return e}switch(f){case"radius":return d.GetValue();default:return undefined}}});return a});define("DS/CATCXPModel/extensions/CATECXPVariablesInit",["UWA/Core","DS/CAT3DExpModel/CAT3DXModel","DS/CAT3DExpModel/interfaces/CATI3DExperienceObject","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/CATCXPModel/interfaces/CATICXPVariablesInit"],function(f,b,e,a,d){var c=f.Class.extend(a,{Init:function(){return this.InitFromXML()},InitFromXML:function(){var h=b.GetPrototypalChain(this.GetObject().GetType());var l=[];if(!h){return f.Promise.reject(new Error("no PrototypalChain"))}for(var n=0;n<h.length;n++){var k=d.GetNLXMLNodeBySpec(h[n]);if(!k){continue}var g=k.getElementsByTagName("ExperienceObject");if(g.length!==1){continue}var m=k.getElementsByTagName("ExperienceObject")[0].childNodes;for(var j=0;j<m.length;j++){if(m[j].nodeType!==1){continue}if(m[j].nodeName==="CXPFunction"){l.push(this.CreateAndAddFunctionFromXMLNode(m[j]))}else{if(m[j].nodeName==="CXPService"){l.push(this.CreateAndAddServiceFromXMLNode(m[j]))}else{if(m[j].nodeName==="CXPEvent"){l.push(this.CreateAndAddEventFromXMLNode(m[j]))}else{continue}}}}}return f.Promise.all(l)},CreateAndAddFunctionFromXMLNode:function(h){var g=this;this.addCapacityVariable("_functions");return this.CreateComponent("Function_Spec","_functions").done(function(i){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_varName",h.attributes.id.textContent,e.SetValueMode.NoCheck);g.addCapacity(i,"_functions");g.ParseXMLProcessVariables(h,i);return g.ParseXMLNaturalLanguageInfo(h,i)})},CreateAndAddServiceFromXMLNode:function(h){var g=this;this.addCapacityVariable("_services");return this.CreateComponent("Service_Spec","_services").done(function(i){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_varName",h.attributes.id.textContent,e.SetValueMode.NoCheck,e.SetValueMode.NoCheck);if(h.attributes.fctStart){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctStart",h.attributes.fctStart.textContent,e.SetValueMode.NoCheck,e.SetValueMode.NoCheck)}if(h.attributes.fctExecute){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctExecute",h.attributes.fctExecute.textContent,e.SetValueMode.NoCheck)}if(h.attributes.fctEnd){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctEnd",h.attributes.fctEnd.textContent,e.SetValueMode.NoCheck)}if(h.attributes.mode){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_mode",h.attributes.mode.textContent,e.SetValueMode.NoCheck)}if(h.attributes.fctStop){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctStop",h.attributes.fctStop.textContent,e.SetValueMode.NoCheck)}if(h.attributes.fctIsPlaying){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctIsPlaying",h.attributes.fctIsPlaying.textContent,e.SetValueMode.NoCheck)}if(h.attributes.fctPause){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctPause",h.attributes.fctPause.textContent,e.SetValueMode.NoCheck)}if(h.attributes.fctResume){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_fctResume",h.attributes.fctResume.textContent,e.SetValueMode.NoCheck)}g.addCapacity(i,"_services");g.ParseXMLProcessVariables(h,i);return g.ParseXMLNaturalLanguageInfo(h,i)})},CreateAndAddEventFromXMLNode:function(h){var g=this;this.addCapacityVariable("_events");return this.CreateComponent("Event_Spec","_events").done(function(i){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_varName",h.attributes.id.textContent,e.SetValueMode.NoCheck);if(h.attributes.targetParam){i.QueryInterface("CATI3DExperienceObject").SetValueByName("_targetParam",h.attributes.targetParam.textContent,e.SetValueMode.NoCheck)}g.addCapacity(i,"_events");g.ParseXMLProcessVariables(h,i);return g.ParseXMLNaturalLanguageInfo(h,i)})},ParseXMLNaturalLanguageInfo:function(h,i){var g=h.getElementsByTagName("NaturalLanguageInfo")[0];return this.CreateComponent("NaturalLanguageInfo","_naturalLanguageInfo",i).done(function(k){for(var j=0;j<g.attributes.length;j++){var l="_"+g.attributes[j].localName;if(l==="_exposedVariable"){l+="Name"}k.QueryInterface("CATI3DExperienceObject").SetValueByName(l,g.attributes[j].textContent,e.SetValueMode.NoCheck)}i.QueryInterface("CATI3DExperienceObject").SetValueByName("_naturalLanguageInfo",k,e.SetValueMode.NoCheck)})},ParseXMLProcessVariables:function(j,k){var g=j.getElementsByTagName("Variable");for(var h=0;h<g.length;h++){var l=g[h].attributes.restrictiveTypes.textContent.split(";");this.CreateVariable(k,g[h].attributes.name.textContent,e.VarType[g[h].attributes.type.textContent],1,e.ValuationMode.AggregatingValue,l)}},addCapacity:function(i,g){var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName(g);if(Array.isArray(h)){h.push(i)}else{h=[i]}this.QueryInterface("CATI3DExperienceObject").SetValueByName(g,h,e.SetValueMode.NoCheck)},addCapacityVariable:function(g){if(!this.QueryInterface("CATI3DExperienceObject").HasVariable(g)){console.warn("variable "+g+" doesnt exist for "+this.GetObject().GetType());this.CreateVariable(null,g,e.VarType.Object,0,e.ValuationMode.AggregatingValue)}},CreateComponent:function(h,g,i){var j=i?i:this.GetObject();if(!j.QueryInterface("CATI3DExperienceObject").HasVariable(g)){console.error(g+" is not a variable of "+this.GetObject().GetType());return f.Promise.reject(new Error(g+" is not a variable of "+this.GetObject().GetType()))}var k=j.QueryInterface("CATI3DExperienceObject").GetVariableID(g)+","+f.Utils.getUUID();return b.BuildComponent(h,k).done(function(l){var m=[];l.QueryInterface("CATI3DExperienceObject").ListVariables(m);return f.Promise.resolve(l)})},CreateVariable:function(h,g,k,j,m,l){var i=h?h:this.GetObject();i.QueryInterface("CATI3DExperienceObject").AddVariable(g,k,j,m,l,g)}});return c});define("DS/CATCXPModel/extensions/CATECXPModelVariablesInit",["UWA/Core","DS/CATCXPModel/extensions/CATECXPVariablesInit","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXColor","DS/CAT3DExpModel/interfaces/CATI3DExperienceObject"],function(f,c,b,a,e){var d=c.extend({Init:function(){var g=this;var h=new b();h.SetValue(new a().FromRGBA(124/255,146/255,167/255,1));return this._parent().done(function(){g.QueryInterface("CATI3DExperienceObject").SetValueByName("color",h,e.SetValueMode.NoCheck)})}});return d});define("DS/CATCXPModel/extensions/CATECXPUIActorVariablesInit",["UWA/Core","DS/CATCXPModel/extensions/CATECXPVariablesInit","DS/CAT3DExpModel/CAT3DXModel","DS/CAT3DExpModel/interfaces/CATI3DExperienceObject","DS/CAT3DExpModel/interfaces/CATI3DXUIRep"],function(f,d,c,e,b){var a=d.extend({Init:function(){var g=this;return this._parent().done(function(){g.CreateVariable(null,"visible",e.VarType.Boolean,1,e.ValuationMode.AggregatingValue);g.QueryInterface("CATI3DExperienceObject").SetValueByName("visible",true,e.SetValueMode.NoCheck);g.CreateVariable(null,"opacity",e.VarType.Double,1,e.ValuationMode.AggregatingValue);g.QueryInterface("CATI3DExperienceObject").SetValueByName("opacity",255,e.SetValueMode.NoCheck);g.CreateVariable(null,"enable",e.VarType.Boolean,1,e.ValuationMode.AggregatingValue);g.QueryInterface("CATI3DExperienceObject").SetValueByName("enable",true,e.SetValueMode.NoCheck);g.CreateVariable(null,"offset",e.VarType.Object,1,e.ValuationMode.AggregatingValue);g.CreateVariable(null,"minimumDimension",e.VarType.Object,1,e.ValuationMode.AggregatingValue);g.CreateVariable(null,"attachment",e.VarType.Object,1,e.ValuationMode.AggregatingValue);return g.CreateComponent("Vector2D_Spec","offset")}).done(function(h){g.QueryInterface("CATI3DExperienceObject").SetValueByName("offset",h,e.SetValueMode.NoCheck);h.QueryInterface("CATI3DExperienceObject").SetValueByName("x",250,e.SetValueMode.NoCheck);h.QueryInterface("CATI3DExperienceObject").SetValueByName("y",250,e.SetValueMode.NoCheck);return g.CreateComponent("Dimension_Spec","minimumDimension")}).done(function(h){g.QueryInterface("CATI3DExperienceObject").SetValueByName("minimumDimension",h,e.SetValueMode.NoCheck);return g.CreateComponent("Attachment_Spec","attachment")}).done(function(h){h.QueryInterface("CATI3DExperienceObject").SetValueByName("side",b.Attachment.ESide.eTopLeft,e.SetValueMode.NoCheck);g.QueryInterface("CATI3DExperienceObject").SetValueByName("attachment",h,e.SetValueMode.NoCheck);return g.CreateComponent("CXPUIDataModel_Spec","data")}).done(function(h){g.QueryInterface("CATI3DExperienceObject").SetValueByName("data",h,e.SetValueMode.NoCheck);g.CreateVariable(h,"__configurationName__",e.VarType.String,1,e.ValuationMode.AggregatingValue)})}});return a});define("DS/CATCXPModel/extensions/CATECXPExperienceVariablesInit",["UWA/Core","DS/CATCXPModel/extensions/CATECXPVariablesInit","DS/CAT3DExpModel/interfaces/CATI3DExperienceObject"],function(d,a,c){var b=a.extend({Init:function(){var e=this;return this._parent().done(function(){return e.CreateComponent("CXPPlaySettings","PlaySettings")}).done(function(f){e.QueryInterface("CATI3DExperienceObject").SetValueByName("PlaySettings",f,c.SetValueMode.NoCheck)})}});return b});define("DS/CATCXPModel/extensions/CATEModel3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATE3DGeoVisu","DS/Visualization/Node3D","DS/Visualization/PathElement","DS/Visualization/ThreeJS_DS","MathematicsES/MathsDef"],function(g,e,d,c,b,a){var f=e.extend({_CreatePathElement:function(){var i=this.QueryInterface("CATICXPObject");var h=i.GetFatherObject();var j=h.QueryInterface("CATI3DGeoVisu").GetPathElement().externalPath.slice();j.push(this.GetNode());this._pathElement=new c(j);return this._pathElement},_Fill:function(i){this._parent(i);var h=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"_varposition.CHANGED",function(){h.frameVisuChanges.push(h._RefreshVarPos);h.RequestVisuRefresh()});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"visible.CHANGED",function(){h.frameVisuChanges.push(h._RefreshVisibility);h.RequestVisuRefresh()});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"clickable.CHANGED",function(){h.frameVisuChanges.push(h._RefreshPickability);h.RequestVisuRefresh()});this.frameVisuChanges.push(h._RefreshVarPos);this.frameVisuChanges.push(h._RefreshVisibility);this.frameVisuChanges.push(h._RefreshPickability)},_listenGraphicalProperties:function(){console.warn("CATEModel3DGeoVisu._listenGraphicalProperties() : Deprecated !!!")},_RefreshVarPos:function(){this._setRepPosition(this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition"))},_RefreshVisibility:function(){this.GetOverride().setVisibility(this.QueryInterface("CATI3DXGraphicalProperties").GetShowMode())},_RefreshPickability:function(){this.GetOverride().setPickability(this.QueryInterface("CATI3DXGraphicalProperties").GetPickMode()?"PICKABLE":"NOT_PICKABLE")},setReady:function(h){if(h===this._ready){return}this._ready=h;this._setParentReady(h);this.dispatchEvent("readyChanged",h)},_setParentReady:function(j){var i=this.QueryInterface("CATICXPObject");if(i){var h=i.GetFatherObject();if(h&&h.QueryInterface("CATI3DGeoVisu")){h.QueryInterface("CATI3DGeoVisu").setReady(j)}}},GetBoundingBox:function(n){var l=this.GetPathElement();var m=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();n=n?n:0;var h;if(this.GetOverride().getVisibility()){h=l.getBoundingBox(null,m,"visibleSpace")}else{h=l.getBoundingBox(null,m,"invisibleSpace")}if(n===0){var j=new a.Transformation();var o=this.QueryInterface("CATIMovable");o.GetAbsPosition(j);var i=j.getArray();var k=new b.Matrix4(i[0],i[3],i[6],i[9],i[1],i[4],i[7],i[10],i[2],i[5],i[8],i[11],0,0,0,1);h.applyMatrix4(k)}return h},GetBoundingSphere:function(){var i=this.GetPathElement();var j=this.GetObject()._experienceBase.getManager("CAT3DXVisuManager").getViewer();var h;if(this.GetOverride().getVisibility()){h=i.getBoundingSphere(j,"visibleSpace")}else{h=i.getBoundingSphere(j,"invisibleSpace")}return h}});return f});define("DS/CATCXPModel/extensions/CATEVPMOccurrence3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATEModel3DGeoVisu","DS/Visualization/PathElement","DS/Visualization/ThreeJS_DS","MathematicsES/MathsDef"],function(f,e,c,b,a){var d=f.Class.extend(e,{init:function(){this._parent()},destroy:function(){this._parent();this._modelLoaded=false;if(this._assetNode){this._assetNode.removeChildren();this._assetNode=null}},_CreatePathElement:function(){var g=this.QueryInterface("CATI3DXVisuHierarchy").GetVisuParent();var h=g.QueryInterface("CATI3DGeoVisu").GetPathElement().externalPath.slice();h.push(this.GetNode());this._pathElement=new c(h);return this._pathElement},_Fill:function(i){var g=this;this._parent(i);var h=this.QueryInterface("CATI3DXAssetHolder");h.resolveAsset().done(function(j){g._assetNode=j;i.addChild(j);g.RequestVisuRefresh();g._modelLoaded=true;g.setReady(true)});this.frameVisuChanges.push(this._addOverrideChildrenNodes);this.frameVisuChanges.push(this._RefreshMaterials)},_addOverrideChildrenNodes:function(){var g=this.QueryInterface("CATI3DXAssetHolder").getCache();if(g&&g.OverrideChildren){for(var j=0;j<g.OverrideChildren.length;j++){var k=g.OverrideChildren[j].QueryInterface("CATI3DGeoVisu");if(f.is(k)){var h=k.GetNode();this._node3D.addChild(h)}}}},_setRepPosition:function(j){var g=this.QueryInterface("CATI3DXAssetHolder").getCache();var l=new a.Transformation().setFromArray(g.ParentPositionInAssetContext);var h=new a.Transformation().setFromArray(j);h=a.Transformation.multiply(l,h);var k=h.getArray();var i=new b.Matrix4(k[0],k[3],k[6],k[9],k[1],k[4],k[7],k[10],k[2],k[5],k[8],k[11],0,0,0,1);this.GetOverride().setPosition(i)},_RefreshMaterials:function(){this.QueryInterface("CATICXPMaterialsVisu").refreshMaterials()},GetLocalNodes:function(){return this._assetNode},setReady:function(g){if(g===this._ready){return}if(g&&!this._modelLoaded){return}this._ready=g;this._setParentReady(g);this.dispatchEvent("readyChanged",g)}});return d});define("DS/CATCXPModel/extensions/CATE3DActor3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATEModel3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(d,c,a){var b=c.extend({destroy:function(){this._parent()},_Fill:function(f){this._parent(f);var e=this;this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"actors.CHANGED",function(){e._node3D.removeChildren();e.frameVisuChanges.push(e._addChildrenNodes);var g=e.GetLocalNodes();if(g){e._node3D.addChild(g)}e.RequestVisuRefresh();e.setReady(e._ready&&e._isAllChildrenReady())});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"opacity.CHANGED",function(){e.frameVisuChanges.push(e._RefreshOpacity);e.RequestVisuRefresh()});this.listenTo(this.QueryInterface("CATI3DExperienceObject"),"color.CHANGED",function(){e.frameVisuChanges.push(e._RefreshColor);e.RequestVisuRefresh()});this.frameVisuChanges.push(this._addChildrenNodes);this.frameVisuChanges.push(this._RefreshOpacity);this.frameVisuChanges.push(this._RefreshColor);this.frameVisuChanges.push(this._RefreshMaterials);if(b.prototype===this.__proto__){this.setReady(true)}},_listenGraphicalProperties:function(){this._parent()},setReady:function(e){if(e===this._ready){return}if(e&&(!this._isAllChildrenReady())){return}this._ready=e;this._setParentReady(e);this.dispatchEvent("readyChanged",e)},_isAllChildrenReady:function(){var h=this.QueryInterface("CATICXPActorsMgr");if(h){var g=[];h.ListActors(g);for(var e=0;e<g.length;e++){var f=g[e].QueryInterface("CATI3DGeoVisu");if(f){if(!g[e].QueryInterface("CATI3DGeoVisu").isReady()){return false}}}}return true},_addChildrenNodes:function(){var g=this.QueryInterface("CATI3DExperienceObject").GetValueByName("actors");if(d.is(g)){for(var f=0;f<g.length;f++){var h=g[f].QueryInterface("CATI3DGeoVisu");if(d.is(h)){var e=h.GetNode();this._node3D.addChild(e)}}}},_setRepPosition:function(f){var e=new a.Matrix4(f[0],f[3],f[6],f[9],f[1],f[4],f[7],f[10],f[2],f[5],f[8],f[11],0,0,0,1);this.GetOverride().setPosition(e)},_RefreshOpacity:function(){},_RefreshColor:function(){},_RefreshMaterials:function(){this.QueryInterface("CATICXPMaterialsVisu").refreshMaterials()}});return b});define("DS/CATCXPModel/extensions/CATEVPMReference3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATE3DActor3DGeoVisu"],function(c,b){var a=b.extend({init:function(){this._parent();this._modelLoaded=false},destroy:function(){this._parent();this._modelLoaded=false;if(this._productNode){this._productNode.removeChildren();this._productNode=null}},_Fill:function(f){var d=this;this._parent(f);var e=this.QueryInterface("CATI3DXAssetHolder");if(e===null){console.log("not an asset holder")}e.resolveAsset().then(function(g){d._productNode=g;f.addChild(g);d.RequestVisuRefresh();d._modelLoaded=true;d.setReady(true)})["catch"](function(){d._modelLoaded=true;d.setReady(true)})},_addChildrenNodes:function(){this._parent();var d=this.QueryInterface("CATI3DXAssetHolder").getCache();if(d&&d.OverrideChildren){for(var f=0;f<d.OverrideChildren.length;f++){var g=d.OverrideChildren[f].QueryInterface("CATI3DGeoVisu");if(c.is(g)){var e=g.GetNode();this._node3D.addChild(e)}}}},GetLocalNodes:function(){return this._productNode},setReady:function(d){if(d===this._ready){return}if(d&&((!this._isAllChildrenReady())||(!this._modelLoaded))){return}this._ready=d;this._setParentReady(d);this.dispatchEvent("readyChanged",d)},_isAllChildrenReady:function(){var g=this.QueryInterface("CATICXPActorsMgr");var d,e;if(g){var f=[];g.ListActors(f);for(d=0;d<f.length;d++){e=f[d].QueryInterface("CATI3DGeoVisu");if(e){if(!e.isReady()){return false}}}}var h=this.QueryInterface("CATI3DExperienceObject").GetValueByName("overrides");for(d=0;d<h.length;d++){e=h[d].QueryInterface("CATI3DGeoVisu");if(e){if(!e.isReady()){return false}}}return true}});return a});define("DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu",["UWA/Core","DS/CATCXPModel/extensions/CATE3DActor3DGeoVisu"],function(c,b){var a=b.extend({init:function(){this._parent()},_Fill:function(d){this._parent(d);this.setReady(true)},_RefreshOpacity:function(){var d=this.QueryInterface("CATI3DXGraphicalProperties").GetOpacity();this.GetOverride().setOpacity(d/255,true)},_RefreshColor:function(){var h;if(!this.QueryInterface("CATI3DExperienceObject").GetValueByName("color")){h="rgb("+124+","+146+","+167+")"}else{var e=this.QueryInterface("CATI3DXGraphicalProperties");var g=e.GetRed();var f=e.GetGreen();var d=e.GetBlue();h="rgb("+g+","+f+","+d+")"}this.GetOverride().setColor(h,true)}});return a});define("DS/CATCXPModel/extensions/CATEArrowActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,b,f,c,e,d){var a=f.extend({init:function(){this._parent();this._arrowNode=null},destroy:function(){this._parent();if(this._arrowNode){this._arrowNode.removeChildren();this._arrowNode=null}},_Fill:function(n){this._parent(n);var l=this.QueryInterface("CATI3DExperienceObject");var m=l.GetValueByName("length");var k=l.GetValueByName("width");var j=l.GetValueByName("headLength");var h=l.GetValueByName("headWidth");this._arrowNode=this._createArrow(m,k,j,h);this._arrowNode.setName(l.GetValueByName("_varName"));var i=this;this.listenTo(l,"length.CHANGED",function(){i.frameVisuChanges.push(i._refreshArrow);i.RequestVisuRefresh()});this.listenTo(l,"width.CHANGED",function(){i.frameVisuChanges.push(i._refreshArrow);i.RequestVisuRefresh()});this.listenTo(l,"headLength.CHANGED",function(){i.frameVisuChanges.push(i._refreshArrow);i.RequestVisuRefresh()});this.listenTo(l,"headWidth.CHANGED",function(){i.frameVisuChanges.push(i._refreshArrow);i.RequestVisuRefresh()});n.addChild(this._arrowNode)},GetLocalNodes:function(){return this._arrowNode},_createArrow:function(j,m,k,n){var l=new e();var h=b.createCylinderNode({bottomCenterPoint:new c.Vector3(0,0,j),topCenterPoint:new c.Vector3(0,0,k),radius:m,sag:40,color:new d.Color(0.5,0.5,0.5,1),material:new c.PhysicalMaterial({force:true})});var i=b.createConeNode({bottomCenterPoint:new c.Vector3(0,0,k),topCenterPoint:new c.Vector3(0,0,0),topRadius:0,bottomRadius:n,sag:100,color:new d.Color(0.5,0.5,0.5,1),material:new c.PhysicalMaterial({force:true})});l.addChild(h);l.addChild(i);l.pickParent=true;return l},_refreshArrow:function(){if(g.is(this._arrowNode)){this._node3D.removeChild(this._arrowNode)}var k=this.QueryInterface("CATI3DExperienceObject");var l=k.GetValueByName("length");var j=k.GetValueByName("width");var i=k.GetValueByName("headLength");var h=k.GetValueByName("headWidth");this._arrowNode=this._createArrow(l,j,i,h);this._arrowNode.setName(k.GetValueByName("_varName"));this._node3D.addChild(this._arrowNode)}});return a});define("DS/CATCXPModel/extensions/CATECapsuleTZActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,a,f,c,e,d){var b=f.extend({init:function(){this._parent();this._capsuleNode=null},destroy:function(){this._parent();if(this._capsuleNode){this._capsuleNode.removeChildren();this._capsuleNode=null}},_Fill:function(l){this._parent(l);var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("radius");var h=k.GetValueByName("height");this._capsuleNode=this._createCapsule(i,h);this._capsuleNode.setName(k.GetValueByName("_varName"));var j=this;this.listenTo(k,"radius.CHANGED",function(){j.frameVisuChanges.push(j._refreshCapsule);j.RequestVisuRefresh()});this.listenTo(k,"height.CHANGED",function(){j.frameVisuChanges.push(j._refreshCapsule);j.RequestVisuRefresh()});l.addChild(this._capsuleNode)},GetLocalNodes:function(){return this._capsuleNode},_createCapsule:function(m,l){var j=new e();var k=a.createCylinderNode({bottomCenterPoint:new c.Vector3(0,0,-l/2+m),topCenterPoint:new c.Vector3(0,0,l/2-m),radius:m,sag:40,color:new d.Color(0.5,0.5,0.5,1)});var i=a.createSphereNode({matrix:new c.Matrix4().setPosition(new c.Vector3(0,0,l/2-m)),radius:m});var h=a.createSphereNode({matrix:new c.Matrix4().setPosition(new c.Vector3(0,0,-l/2+m)),radius:m});j.addChild(k);j.addChild(i);j.addChild(h);j.pickParent=true;return j},_refreshCapsule:function(){if(g.is(this._capsuleNode)){this._node3D.removeChild(this._capsuleNode)}var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("radius");var h=j.GetValueByName("height");this._capsuleNode=this._createCapsule(i,h);this._capsuleNode.setName(j.GetValueByName("_varName"));this._node3D.addChild(this._capsuleNode)},_RefreshOpacity:function(){},_RefreshColor:function(){},_RefreshMaterials:function(){},_RefreshVisibility:function(){this.GetOverride().setVisibility(false)},_RefreshPickability:function(){this.GetOverride().setPickability("NOT_PICKABLE")}});return b});define("DS/CATCXPModel/extensions/CATECubeActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(e,b,d,c){var a=d.extend({init:function(){this._parent();this._cubeNode=null},destroy:function(){this._parent();if(this._cubeNode){this._cubeNode.removeChildren();this._cubeNode=null}},_Fill:function(k){this._parent(k);var i=this.QueryInterface("CATI3DExperienceObject");var j=i.GetValueByName("length");var f=i.GetValueByName("height");var h=i.GetValueByName("width");this._cubeNode=this._createCuboid(j,h,f);this._cubeNode.setName(i.GetValueByName("_varName"));var g=this;this.listenTo(i,"length.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});this.listenTo(i,"height.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});this.listenTo(i,"width.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});k.addChild(this._cubeNode)},GetLocalNodes:function(){return this._cubeNode},_createCuboid:function(g,j,l){var i=Math.abs(g);var h=Math.abs(j);var f=Math.abs(l);var k=b.createCuboidNode({cornerPoint:new c.Vector3(-i/2,-h/2,-f/2),firstAxis:new c.Vector3(i,0,0),secondAxis:new c.Vector3(0,h,0),thirdAxis:new c.Vector3(0,0,f),material:new c.PhysicalMaterial({force:true})});k.pickParent=true;return k},_refreshCube:function(){if(e.is(this._cubeNode)){this._node3D.removeChild(this._cubeNode);this._cubeNode.removeChildren()}var h=this.QueryInterface("CATI3DExperienceObject");var i=h.GetValueByName("length");var f=h.GetValueByName("height");var g=h.GetValueByName("width");this._cubeNode=this._createCuboid(i,g,f);this._cubeNode.setName(h.GetValueByName("_varName"));this._node3D.addChild(this._cubeNode)}});return a});define("DS/CATCXPModel/extensions/CATECapsuleActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,b,f,c,e,d){var a=f.extend({init:function(){this._parent();this._capsuleNode=null},destroy:function(){this._parent();if(this._capsuleNode){this._capsuleNode.removeChildren();this._capsuleNode=null}},_Fill:function(l){this._parent(l);var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("radius");var h=k.GetValueByName("height");this._capsuleNode=this._createCapsule(i,h);this._capsuleNode.setName(k.GetValueByName("_varName"));var j=this;this.listenTo(k,"radius.CHANGED",function(){j.frameVisuChanges.push(j._refreshCapsule);j.RequestVisuRefresh()});this.listenTo(k,"height.CHANGED",function(){j.frameVisuChanges.push(j._refreshCapsule);j.RequestVisuRefresh()});l.addChild(this._capsuleNode)},GetLocalNodes:function(){return this._capsuleNode},_createCapsule:function(m,l){var j=new e();var k=b.createCylinderNode({bottomCenterPoint:new c.Vector3(0,0,-l/2+m),topCenterPoint:new c.Vector3(0,0,l/2-m),radius:m,sag:40,color:new d.Color(0.5,0.5,0.5,1),material:new c.PhysicalMaterial({force:true})});var i=b.createSphereNode({matrix:new c.Matrix4().setPosition(new c.Vector3(0,0,l/2-m)),radius:m,material:new c.PhysicalMaterial({force:true})});var h=b.createSphereNode({matrix:new c.Matrix4().setPosition(new c.Vector3(0,0,-l/2+m)),radius:m,material:new c.PhysicalMaterial({force:true})});j.addChild(k);j.addChild(i);j.addChild(h);j.pickParent=true;return j},_refreshCapsule:function(){if(g.is(this._capsuleNode)){this._node3D.removeChild(this._capsuleNode)}var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("radius");var h=j.GetValueByName("height");this._capsuleNode=this._createCapsule(i,h);this._capsuleNode.setName(j.GetValueByName("_varName"));this._node3D.addChild(this._capsuleNode)}});return a});define("DS/CATCXPModel/extensions/CATEConeActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,a,f,b,e,d){var c=f.extend({init:function(){this._parent();this._coneNode=null},destroy:function(){this._parent();if(this._coneNode){this._coneNode.removeChildren();this._coneNode=null}},_Fill:function(l){this._parent(l);var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("radius");var h=k.GetValueByName("height");this._coneNode=this._createCone(i,h);this._coneNode.setName(k.GetValueByName("_varName"));var j=this;this.listenTo(k,"radius.CHANGED",function(){j.frameVisuChanges.push(j._refreshCone);j.RequestVisuRefresh()});this.listenTo(k,"height.CHANGED",function(){j.frameVisuChanges.push(j._refreshCone);j.RequestVisuRefresh()});l.addChild(this._coneNode)},GetLocalNodes:function(){return this._coneNode},_createCone:function(j,i){var h=a.createConeNode({bottomCenterPoint:new b.Vector3(0,0,0),topCenterPoint:new b.Vector3(0,0,i),topRadius:0,bottomRadius:j,sag:100,color:new d.Color(0.5,0.5,0.5,1),material:new b.PhysicalMaterial({force:true})});h.pickParent=true;return h},_refreshCone:function(){if(g.is(this._coneNode)){this._node3D.removeChild(this._coneNode)}var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("radius");var h=j.GetValueByName("height");this._coneNode=this._createCone(i,h);this._coneNode.setName(j.GetValueByName("_varName"));this._node3D.addChild(this._coneNode)}});return c});define("DS/CATCXPModel/extensions/CATEPlaneActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,a,f,c,e,d){var b=f.extend({init:function(){this._parent();this._planeNode=null},destroy:function(){this._parent();if(this._planeNode){this._planeNode.removeChildren();this._planeNode=null}},_Fill:function(l){this._parent(l);var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("width");var k=j.GetValueByName("length");this._planeNode=this._createPlane(i,k);this._planeNode.setName(j.GetValueByName("_varName"));var h=this;this.listenTo(j,"width.CHANGED",function(){h.frameVisuChanges.push(h._refreshPlane);h.RequestVisuRefresh()});this.listenTo(j,"length.CHANGED",function(){h.frameVisuChanges.push(h._refreshPlane);h.RequestVisuRefresh()});l.addChild(this._planeNode)},GetLocalNodes:function(){return this._planeNode},_createPlane:function(k,j){var h=a.createRectangleNode({width:k,height:j,fill:true,color:new d.Color(0.5,0.5,0.5,1),material:new c.PhysicalMaterial({force:true})});var i=h.getMatrix();i.setPosition({x:-k/2,y:-j/2,z:0});h.setMatrix(i);h.pickParent=true;return h},_refreshPlane:function(){if(g.is(this._planeNode)){this._node3D.removeChild(this._planeNode)}var i=this.QueryInterface("CATI3DExperienceObject");var h=i.GetValueByName("width");var j=i.GetValueByName("length");this._planeNode=this._createPlane(h,j);this._planeNode.setName(i.GetValueByName("_varName"));this._node3D.addChild(this._planeNode)}});return b});define("DS/CATCXPModel/extensions/CATETorusActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(e,a,c,b){var d=c.extend({init:function(){this._parent();this._torusNode=null},destroy:function(){this._parent();if(this._torusNode){this._torusNode.removeChildren();this._torusNode=null}},_Fill:function(j){this._parent(j);var i=this.QueryInterface("CATI3DExperienceObject");var h=i.GetValueByName("radius1");var g=i.GetValueByName("radius2");this._torusNode=this._createTorus(h,g);this._torusNode.setName(i.GetValueByName("_varName"));var f=this;this.listenTo(i,"radius1.CHANGED",function(){f.frameVisuChanges.push(f._refreshTorus);f.RequestVisuRefresh()});this.listenTo(i,"radius2.CHANGED",function(){f.frameVisuChanges.push(f._refreshTorus);f.RequestVisuRefresh()});j.addChild(this._torusNode)},GetLocalNodes:function(){return this._torusNode},_createTorus:function(h,g){var f=a.createTorusNode({majorRadius:h,minorRadius:g,sag:100,material:new b.PhysicalMaterial({force:true})});f.pickParent=true;return f},_refreshTorus:function(){if(e.is(this._torusNode)){this._node3D.removeChild(this._torusNode)}var h=this.QueryInterface("CATI3DExperienceObject");var g=h.GetValueByName("radius1");var f=h.GetValueByName("radius2");this._torusNode=this._createTorus(g,f);this._torusNode.setName(h.GetValueByName("_varName"));this._node3D.addChild(this._torusNode)}});return d});define("DS/CATCXPModel/extensions/CATESphereActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(e,a,d,b){var c=d.extend({init:function(){this._parent();this._sphereNode=null},destroy:function(){this._parent();if(this._sphereNode){this._sphereNode.removeChildren();this._sphereNode=null}},_Fill:function(i){this._parent(i);var h=this.QueryInterface("CATI3DExperienceObject");var f=h.GetValueByName("radius");this._sphereNode=this._createSpheroid(f);this._sphereNode.setName(h.GetValueByName("_varName"));var g=this;this.listenTo(h,"radius.CHANGED",function(){g.frameVisuChanges.push(g._refreshSphere);g.RequestVisuRefresh()});i.addChild(this._sphereNode)},GetLocalNodes:function(){return this._sphereNode},_createSpheroid:function(h){var f=new b.Matrix4();var g=a.createSphereNode({matrix:f,radius:h,material:new b.PhysicalMaterial({force:true})});g.pickParent=true;return g},_refreshSphere:function(){if(e.is(this._sphereNode)){this._node3D.removeChild(this._sphereNode)}var g=this.QueryInterface("CATI3DExperienceObject");var f=g.GetValueByName("radius");this._sphereNode=this._createSpheroid(f);this._sphereNode.setName(g.GetValueByName("_varName"));this._node3D.addChild(this._sphereNode)}});return c});define("DS/CATCXPModel/extensions/CATECubeTZActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(e,b,d,c){var a=d.extend({init:function(){this._parent();this._cubeNode=null},destroy:function(){this._parent();if(this._cubeNode){this._cubeNode.removeChildren();this._cubeNode=null}},_Fill:function(k){this._parent(k);var i=this.QueryInterface("CATI3DExperienceObject");var j=i.GetValueByName("length");var f=i.GetValueByName("height");var h=i.GetValueByName("width");this._cubeNode=this._createCuboid(j,h,f);this._cubeNode.setName(i.GetValueByName("_varName"));var g=this;this.listenTo(i,"length.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});this.listenTo(i,"height.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});this.listenTo(i,"width.CHANGED",function(){g.frameVisuChanges.push(g._refreshCube);g.RequestVisuRefresh()});k.addChild(this._cubeNode)},GetLocalNodes:function(){return this._cubeNode},_createCuboid:function(g,j,l){var i=Math.abs(g);var h=Math.abs(j);var f=Math.abs(l);var k=b.createCuboidNode({cornerPoint:new c.Vector3(-i/2,-h/2,-f/2),firstAxis:new c.Vector3(i,0,0),secondAxis:new c.Vector3(0,h,0),thirdAxis:new c.Vector3(0,0,f)});k.pickParent=true;return k},_refreshCube:function(){if(e.is(this._cubeNode)){this._node3D.removeChild(this._cubeNode);this._cubeNode.removeChildren()}var h=this.QueryInterface("CATI3DExperienceObject");var i=h.GetValueByName("length");var f=h.GetValueByName("height");var g=h.GetValueByName("width");this._cubeNode=this._createCuboid(i,g,f);this._cubeNode.setName(h.GetValueByName("_varName"));this._node3D.addChild(this._cubeNode)},_RefreshOpacity:function(){},_RefreshColor:function(){},_RefreshMaterials:function(){},_RefreshVisibility:function(){this.GetOverride().setVisibility(false)},_RefreshPickability:function(){this.GetOverride().setPickability("NOT_PICKABLE")}});return a});define("DS/CATCXPModel/extensions/CATESphereTZActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS"],function(e,a,d,b){var c=d.extend({init:function(){this._parent();this._sphereNode=null},destroy:function(){this._parent();if(this._sphereNode){this._sphereNode.removeChildren();this._sphereNode=null}},_Fill:function(i){this._parent(i);var h=this.QueryInterface("CATI3DExperienceObject");var f=h.GetValueByName("radius");this._sphereNode=this._createSpheroid(f);this._sphereNode.setName(h.GetValueByName("_varName"));var g=this;this.listenTo(h,"radius.CHANGED",function(){g.frameVisuChanges.push(g._refreshSphere);g.RequestVisuRefresh()});i.addChild(this._sphereNode)},GetLocalNodes:function(){return this._sphereNode},_createSpheroid:function(h){var f=new b.Matrix4();var g=a.createSphereNode({matrix:f,radius:h});g.pickParent=true;return g},_refreshSphere:function(){if(e.is(this._sphereNode)){this._node3D.removeChild(this._sphereNode)}var g=this.QueryInterface("CATI3DExperienceObject");var f=g.GetValueByName("radius");this._sphereNode=this._createSpheroid(f);this._sphereNode.setName(g.GetValueByName("_varName"));this._node3D.addChild(this._sphereNode)},_RefreshOpacity:function(){},_RefreshColor:function(){},_RefreshMaterials:function(){},_RefreshVisibility:function(){this.GetOverride().setVisibility(false)},_RefreshPickability:function(){this.GetOverride().setPickability("NOT_PICKABLE")}});return c});define("DS/CATCXPModel/extensions/CATECylinderActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,b,f,c,e,d){var a=f.extend({init:function(){this._parent();this._cylinderNode=null},destroy:function(){this._parent();if(this._cylinderNode){this._cylinderNode.removeChildren();this._cylinderNode=null}},_Fill:function(l){this._parent(l);var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("radius");var h=k.GetValueByName("height");this._cylinderNode=this._createCylinder(i,h);this._cylinderNode.setName(k.GetValueByName("_varName"));var j=this;this.listenTo(k,"radius.CHANGED",function(){j.frameVisuChanges.push(j._refreshCylinder);j.RequestVisuRefresh()});this.listenTo(k,"height.CHANGED",function(){j.frameVisuChanges.push(j._refreshCylinder);j.RequestVisuRefresh()});l.addChild(this._cylinderNode)},GetLocalNodes:function(){return this._cylinderNode},_createCylinder:function(j,i){var h=b.createCylinderNode({bottomCenterPoint:new c.Vector3(0,0,-i/2),topCenterPoint:new c.Vector3(0,0,i/2),radius:j,sag:40,color:new d.Color(0.5,0.5,0.5,1),material:new c.PhysicalMaterial({force:true})});h.pickParent=true;return h},_refreshCylinder:function(){if(g.is(this._cylinderNode)){this._node3D.removeChild(this._cylinderNode)}var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("radius");var h=j.GetValueByName("height");this._cylinderNode=this._createCylinder(i,h);this._cylinderNode.setName(j.GetValueByName("_varName"));this._node3D.addChild(this._cylinderNode)}});return a});define("DS/CATCXPModel/extensions/CATECylinderTZActor3DGeoVisu",["UWA/Core","DS/Visualization/SceneGraphFactory","DS/CATCXPModel/extensions/CATEPrimitiveActor3DGeoVisu","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils"],function(g,a,f,c,e,d){var b=f.extend({init:function(){this._parent();this._cylinderNode=null},destroy:function(){this._parent();if(this._cylinderNode){this._cylinderNode.removeChildren();this._cylinderNode=null}},_Fill:function(l){this._parent(l);var k=this.QueryInterface("CATI3DExperienceObject");var i=k.GetValueByName("radius");var h=k.GetValueByName("height");this._cylinderNode=this._createCylinder(i,h);this._cylinderNode.setName(k.GetValueByName("_varName"));var j=this;this.listenTo(k,"radius.CHANGED",function(){j.frameVisuChanges.push(j._refreshCylinder);j.RequestVisuRefresh()});this.listenTo(k,"height.CHANGED",function(){j.frameVisuChanges.push(j._refreshCylinder);j.RequestVisuRefresh()});l.addChild(this._cylinderNode)},GetLocalNodes:function(){return this._cylinderNode},_createCylinder:function(j,i){var h=a.createCylinderNode({bottomCenterPoint:new c.Vector3(0,0,-i/2),topCenterPoint:new c.Vector3(0,0,i/2),radius:j,sag:40,color:new d.Color(0.5,0.5,0.5,1)});h.pickParent=true;return h},_refreshCylinder:function(){if(g.is(this._cylinderNode)){this._node3D.removeChild(this._cylinderNode)}var j=this.QueryInterface("CATI3DExperienceObject");var i=j.GetValueByName("radius");var h=j.GetValueByName("height");this._cylinderNode=this._createCylinder(i,h);this._cylinderNode.setName(j.GetValueByName("_varName"));this._node3D.addChild(this._cylinderNode)},_RefreshOpacity:function(){},_RefreshColor:function(){},_RefreshMaterials:function(){},_RefreshVisibility:function(){this.GetOverride().setVisibility(false)},_RefreshPickability:function(){this.GetOverride().setPickability("NOT_PICKABLE")}});return b});define("DS/CATCXPModel/extensions/VIAEIxpCubicPath",["UWA/Core","DS/Visualization/ThreeJS_DS","MathematicsES/MathsDef","DS/CATCXPModel/extensions/VIAEIxpCubicSubSectionPath"],function(e,d,c,a){var b=e.Class.extend({init:function(f){this._pathExtension=f;this._subSections={}},GetLength:function(){var f=[];this._pathExtension.GetDefinePoints(f);var h=0;if(f.length<2){return h}for(var g=0;g<f.length-1;g++){h+=this._getSubSection(f[g],f[g+1]).getLength()}return h},_getSubSection:function(g,f){var h=g.GetID()+f.GetID();if(!this._subSections[h]){this._subSections[h]=new a(new c.Vector3D().setFromArray(g.QueryInterface("CATI3DExperienceObject").GetValueByName("position")),new c.Vector3D().setFromArray(f.QueryInterface("CATI3DExperienceObject").GetValueByName("position")),this._getTangentFromPoint("RIGHT",g),this._getTangentFromPoint("LEFT",f))}return this._subSections[h]},GetValue:function(g,l,n){if((g>1)||(g<0)){e.log("VIAEIxpVirtualPath.GetValue ERROR : iCurvParam not in the range[0,1] !");return}var f=[];this._pathExtension.GetDefinePoints(f);if(f.length<2){return}var m=g*this.GetLength();var h=0;var j=0;var o=0;var p;do{p=this._getSubSection(f[j],f[j+1]);o=p.getLength();h+=o;j++}while(h<=m&&j<f.length-1);var k=p.getValueFromLengthRatio((m-h+o)/o);if(e.is(l)){console.warn("not implemented yet TODO")}else{var i=new c.Transformation();this._pathExtension.QueryInterface("CATIMovable").GetAbsPosition(i);n.x=i.vector.x+k.x;n.y=i.vector.y+k.y;n.z=i.vector.z+k.z}},_getTangentFromPoint:function(f,h){const j=1e-10;var i=new c.Vector3D();var g=this._pathExtension.QueryInterface("CATI3DExperienceObject").GetValueByName("reversedDirection");if(!g){if(f==="RIGHT"){i.setFromArray(h.QueryInterface("CATI3DExperienceObject").GetValueByName("rightTangent"))}else{if(f==="LEFT"){i.setFromArray(h.QueryInterface("CATI3DExperienceObject").GetValueByName("leftTangent"))}}}else{if(f==="RIGHT"){i.setFromArray(h.QueryInterface("CATI3DExperienceObject").GetValueByName("leftTangent"))}else{if(f==="LEFT"){i.setFromArray(h.QueryInterface("CATI3DExperienceObject").GetValueByName("rightTangent"))}}}if(i.norm()<j){i=this._computeDefaultTangent(h)}return i},_computeDefaultTangent:function(o){const g=0.5;var q=this._pathExtension.QueryInterface("CATI3DExperienceObject").GetValueByName("reversedDirection");var h=o.QueryInterface("CATI3DExperienceObject").GetValueByName("index");var m=(!q)?h:(this._pathExtension.GetNumberOfPoint()-h+1);var k=[];this._pathExtension.GetDefinePoints(k);var j,n,f,l;if(m===1){l=2;do{if(k[l-1]!==undefined){j=new c.Vector3D().setFromArray(k[l-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));n=new c.Vector3D().setFromArray(k[m-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));f=j.subVectorFromVector(n)}l++}while(f.norm()===0&&l<=k.length())}else{if(m===k.length){l=k.length-1;do{if(k[l-1]!==undefined){j=new c.Vector3D().setFromArray(k[m-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));n=new c.Vector3D().setFromArray(k[l-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));f=j.subVectorFromVector(n)}l--}while(f.norm()===0&&l>=1)}else{var p=m-1;var i=m+1;do{if(k[i-1]!==undefined){j=new c.Vector3D().setFromArray(k[i-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));n=new c.Vector3D().setFromArray(k[p-1].QueryInterface("CATI3DExperienceObject").GetValueByName("position"));f=j.subVectorFromVector(n)}i++}while(f.norm()===0&&i<=k.length())}}return f.multiplyScalar(g)}});return b});define("DS/CATCXPModel/extensions/VIAEIxpVirtualPath",["UWA/Core","DS/CAT3DExpModel/CAT3DXInterfaceImpl","DS/Visualization/ThreeJS_DS","MathematicsES/MathsDef","DS/CATCXPModel/extensions/VIAEIxpLinearPath","DS/CATCXPModel/extensions/VIAEIxpCubicPath"],function(g,e,f,d,b,a){var c=e.extend({_getLinearImpl:function(){if(!this._linearImpl){this._linearImpl=new b(this)}return this._linearImpl},_getCubicImpl:function(){if(!this._cubicImpl){this._cubicImpl=new a(this)}return this._cubicImpl},AddPoint:function(){console.error("Not Implemented")},RemovePoint:function(){console.error("Not Implemented")},InsertPoint:function(){console.error("Not Implemented")},GetDefinePoints:function(j){if(!Array.isArray(j)){g.log("VIAEIxpVirtualPath.GetDefinePoints ERROR : unable to fill parameters, not an array !");return}j.length=0;var k=this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist");for(var h=0;h<k.length;h++){j.push(k[h])}},GetPointAtIndex:function(h){var i=this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist");return i[h]},GetNumberOfPoint:function(){return this.QueryInterface("CATI3DExperienceObject").GetValueByName("pointslist").length},GetLength:function(){if(this.QueryInterface("CATI3DExperienceObject").GetValueByName("interpolationType")===0){return this._getLinearImpl().GetLength()}else{return this._getCubicImpl().GetLength()}},GetValue:function(i,j,h){if(this.QueryInterface("CATI3DExperienceObject").GetValueByName("interpolationType")===0){return this._getLinearImpl().GetValue(i,j,h)}else{return this._getCubicImpl().GetValue(i,j,h)}}});return c});