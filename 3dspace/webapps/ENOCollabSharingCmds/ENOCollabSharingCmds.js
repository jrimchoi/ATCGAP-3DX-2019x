define("DS/ENOCollabSharingCmds/Services/CommandServices",["DS/LifecycleServices/LifecycleServices"],function(a){var b={TYPE_ROOT_FOLDER_1:"Workspace",TYPE_ROOT_FOLDER_2:"RootFolder",TYPE_FOLDER_1:"Workspace Vault",TYPE_FOLDER_2:"Folder",TYPE_FOLDER_3:"Workspace Folder",TYPE_PERSONAL_FOLDER_1:"Personal Workspace",isRootFolder:function(c){return c===this.TYPE_ROOT_FOLDER_1||c===this.TYPE_ROOT_FOLDER_2},isFolder:function(c){return(c===this.TYPE_FOLDER_1||c===this.TYPE_FOLDER_2||c===this.TYPE_FOLDER_3)},isPersonalFolder:function(c){return c===this.TYPE_PERSONAL_FOLDER_1},isWorkspaceFolder:function(c){return(c===this.TYPE_ROOT_FOLDER_1||c===this.TYPE_FOLDER_1)},inFamilyFolder:function(c){return(this.isRootFolder(c)||this.isFolder(c)||this.isPersonalFolder(c))},allAggregated3DShape:function(o,f){var c=0;var e=o.length;var m=[];for(var g=0;g<e;g++){var l=o[g];var k=l.options.type;var h=l.getID();m.push(h);if(k!="3DShape"){f(false);return}}var n=widget.getValue("x3dPlatformId");a.listAttributes(n,m,["attribute[PLMEntity.V_usage]"],function j(t){var r=true;var u=t.results.length;for(var q=0;q<u;q++){var p=t.results[q];var s=p["attribute[PLMEntity.V_usage]"];if(s!="3DPart"){r=false;break}}f(r)},function d(i){console.log(i);f(false)})}};return b});define("DS/ENOCollabSharingCmds/ENOCollabSharingCmds",[],function(){});define("DS/ENOCollabSharingCmds/BaseModels/ResultElement",["UWA/Controls/Abstract"],function(b){var a=b.extend({init:function(d){this.CategoryRelation="RelationClass";this.CategoryObj="Class";this.CategoryEBOM="EBOM";this.CategoryRelationM1="rel";this.CategoryObjM1="bus";this.MetatypeRel="relationship";this.MetatypeBus="businessobject";this.MetatypeEBOM="EBOM";this.urlIcon="";this.project="";this.org="";this.physicalId="";this.owner="";this.title="";this.name="";this.id="";this.type="";this.children=[];this.category="";this.serverUri="";this.serverHost="";this.isResultElement=true;for(var c in d){this[c]=d[c]}},getUrlIcon:function(){return this.urlIcon},getProject:function(){return this.project},getOrganization:function(){return this.org},getPhysicalId:function(){return this.physicalId},getOwner:function(){return this.owner},getTitle:function(){return this.title},getLabel:function(){return this.getTitle()},getName:function(){return this.name},getId:function(){return this.id},getID:function(){return this.getPhysicalId()},getChildren:function(){return this.children},getCategory:function(){return this.category},getCategoryM1:function(){if(this.getCategory()===this.CategoryRelation){return this.CategoryRelationM1}else{if(this.getCategory()===this.CategoryObj){return this.CategoryObjM1}else{return""}}},getMetatype:function(){if(this.getCategory()===this.CategoryRelation){return this.MetatypeRel}else{if(this.getCategory()===this.CategoryEBOM){return this.MetatypeEBOM}else{return this.MetatypeBus}}},getType:function(){return this.type},getServerHost:function(){return this.serverHost},getServerUri:function(){return this.serverUri},setUrlIcon:function(c){this.urlIcon=c},setProject:function(c){this.project=c},setOrganization:function(c){this.org=c},setPhysicalId:function(c){this.physicalId=c},setOwner:function(c){this.owner=c},setTitle:function(c){this.title=c},setName:function(c){this.name=c},setId:function(c){this.id=c},setChildren:function(c){this.children=c},setCategory:function(c){this.category=c},setType:function(c){this.type=c},setServerHost:function(c){this.serverHost=c},setServerUri:function(c){this.serverUri=c},});return a});define("DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse",["DS/PlatformAPI/PlatformAPI","UWA/Controls/Abstract","require","DS/LifecycleServices/LifecycleServicesSettings"],function(b,e,a,d){var c=e.extend({init:function(g){this.result="";this.id="";this.message="";this.physicalid="";this.relationphysicalid="";this.relationname="";this.PhysicalIDToRefresh="";this.attributes=null;if(g.hasOwnProperty("to[CAD SubComponent].physicalid")){this.relationphysicalid=g["to[CAD SubComponent].physicalid"]}else{if(g.hasOwnProperty("to[VPMInstance].physicalid")){this.relationphysicalid=g["to[VPMInstance].physicalid"]}}if(g.hasOwnProperty("instanceName")){this.relationname=g.instanceName}this.isNewCommandResponse=true;d.app_initialization(function(){});for(var f in g){this[f]=g[f]}},isSuccess:function(){return this.result=="SUCCESS"},isWarning:function(){return this.result=="WARNING"},getType:function(){var f=this.getAttributes();var h="";for(var g in this.attributes){if(this.attributes[g].hasOwnProperty("name")&&this.attributes[g]["name"]==="ds6w:type"){return this.attributes[g]["value"]}}return h},getRelationPhysicalId:function(){return this.relationphysicalid},getPhysicalId:function(){return this.physicalid},getMessage:function(){return this.message},getPhysicalIdsToRefresh:function(){return this.PhysicalIDToRefresh},getAttributes:function(){if(this.attributes==undefined){this.attributes=JSON.parse(this.rawAttr)[0].attributes;if(this.relationname&&this.relationname.length!=0){this.attributes.push({name:"instanceName",value:this.relationname})}for(var f in this.attributes){if(this.attributes[f].hasOwnProperty("name")&&((this.attributes[f]["name"]==="type_icon_url")||(this.attributes[f]["name"]==="thumbnail_2d"))){var g=d.get3DSpaceWSUrl(d.getTenant(),this.attributes[f]["value"],null);if(g==null||g==undefined){g=""}this.attributes[f]["value"]=g}}}return this.attributes},});return c});define("DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase",["UWA/Class","DS/LifecycleControls/EditPropDialog",],function(a,c){var b=c.extend({});return b});define("DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADContext"],function(e,c,b,d){var a=c.extend({init:function(g,h){this._parent(g,h);this.checking_select=false;var f=d.get();if(f){this._check_select();f.addEvent("editModeModified",this.check_select.bind(this));f.getPADTreeDocument().getXSO().onPostAdd(this.check_select.bind(this));f.getPADTreeDocument().getXSO().onPostRemove(this.check_select.bind(this))}},check_select:function(){if(this.checking_select){return}this.checking_select=true;var g=this.options.withTimeout!==false?300:0;var f=arguments;setTimeout(function(){this.checking_select=false;this._check_select()}.bind(this),g)},_check_select:function(){var f=d.get();var g=f.getPADTreeDocument().getXSO().get();var k=g.length;var i=k&&(this.options.cmd_selection_single!==true||k===1)?true:false;if(k===0&&typeof f.getFolderXSO==="function"){var h=f.getFolderXSO().getCurrentFolder();i=!!h&&!!h.id;if(i){g=[h]}}if(this.isAvailable!=null){var j=this;j.selectedObjects=g;i=this.isAvailable(g,function(m,l){if(l==j.selectedObjects){if(m){j.enable()}else{j.disable()}}})}else{if(i===true&&(!f.getEditMode||f.getEditMode()===true)){this.enable()}else{this.disable()}}}});return a});define("DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(c,b,f,a,d){var e=c.extend(b,f,{labelTopBar:UWA.i18n("Unreserve selected objects"),init:function(g){var h=false;if(typeof g!==undefined&&g!==null){if(g.hasOwnProperty("odtMode")){h=g.odtmode}}if(!h){this._setCommandEnableStatus()}this.options=g;this._parent(g,{isAsynchronous:true})},beginExecute:function(){},execute:function(){var g=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(s,i,q,m,n){var k=m.get();if(null==k){k=g.options.context}var h={_setNotification:function(v,u){if(typeof k.displayNotification==="function"){var t={eventID:u,msg:v};k.displayNotification(t)}else{alert(v)}},_setError:function(t){this._setNotification(t,"error")},_setWarning:function(t){this._setNotification(t,"warning")},_setInfo:function(t){this._setNotification(t,"info")}};var j=[];var r=k.getSelectedNodes();var p=false;if(r.length){r.forEach(function(t){if(typeof t.getID=="function"&&typeof t.getLabel=="function"){var u=t.plmType;if(i.inFamilyFolder(u)){console.log("$$$ A Folder has been selected $$$");p=true}var x=t.getID();var w=t.getLabel();if(null!=x){var B="";if(typeof t.getRelationID=="function"){B=t.getRelationID()}var z="";if(typeof t.getParent=="function"){var v=t.getParent();if(typeof v.getID=="function"){z=v.getID()}}var A=null;if(null!=t&&null!=t.options&&null!=t.options.grid){A=t.options.grid["ds6w:cadMaster"]}var y=new n({physicalId:x,name:w,relID:B,parentID:z,cadMaster:A});j.push(y)}}})}if(j.length>0){var l=j[0];l=new n(l);var o=false;if(typeof g.options!==undefined&&g.options!==null){if(g.options.hasOwnProperty("odtmode")){o=g.options.odtmode}}if(o==false){i.allAggregated3DShape(l,function(t){var u=!t;if(t){return}})}}if(p===true){h._setWarning(UWA.i18n("unreserve not available"))}else{if(j.length>0){var l=j[0];g.container=new q({readOnly:"auto",serverName:l.getServerHost(),serverUri:l.getServerUri(),operation:"unreserve",localContext:k,events:{onNotification:function(t){k.displayNotification(t)}}});console.log("calling setObjects");g.container.setObjects(j);g.container.launchCmd()}else{h._setWarning(UWA.i18n("unreserve no content"))}}});g.end()},endExecute:function(){},_setCommandEnableStatus:function(){var g=this;require(["DS/PADUtils/PADContext"],function(i){var h=i.get();if(h!=null){if(i.get().getEditMode()!==true){g.disable()}i.get().addEvent("editModeModified",function(j){if(j===true){g.enable()}else{g.disable()}})}})},});return e});define("DS/ENOCollabSharingCmds/commands/EditPropCmd/ActionBar_EditPropCmd",["UWA/Class","DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(b,a,d){var c=b.extend(a,d,{defaultIsTransient:false,extraNotif:false,init:function(e){e.withTimeout=false;this._parent(e,{isAsynchronous:true});this.editProp=null},execute:function(){var e=this;require(["DS/PADUtils/PADContext"],function(g){var f=g.get();if(null==f){f=e.options.context}e.launchProperties(f)})}});return c});define("DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(c,b,g,d,f,a){var e=c.extend(b,g,{init:function(h){this._parent(h,{isAsynchronous:true});this.accessRightPanel=null},beginExecute:function(){},execute:function(){var h=this;h.disable();require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/AccessRightPopup/AccessRightPopup","DS/Selection/CSOManager","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/PADUtils/PADContext","DS/LifecycleServices/LifecycleServices"],function(t,i,u,j,q,o,k){var n=o.get();if(null==n){n=h.options.context}var r=t.getTenantID();var p={context:n};i.getInstance(p).getSecurityContext();var l=j.get();var m=[];var s=j.get();if(s.length==0){s=n.getSelectedNodes()}if(s.length){s.forEach(function(x){if(typeof x.getID=="function"&&typeof x.getLabel=="function"){var C=x.getID();var A=x.getLabel();if(null!==C){var C=x.getID();var F=x.getLabel();var E=null;var B="";var z=null;var v=null;if(x.options){E=x.options.type;B=x.options.subLabel;z=x.options.grid["ds6wg:revision"]}else{if(x.object){B=x.object.ownerFullName;z=x.object.revision;if(null!=x.object.options&&null!=x.object.options.icons&&x.object.options.icons.length>0){var J=x.object.options.icons[0];v=J.length&&J.indexOf("http")<0?f.get3DSpaceBaseUrl(t.getTenantID())+J:J}}}var I="";if(typeof x.getRelationID=="function"){I=x.getRelationID()}var H="";var w="";if(null!==x&&null!==x.getParent&&typeof x.getParent=="function"){var y=x.getParent();if(null!==y&&null!==y.getID&&typeof y.getID=="function"){H=y.getID();w=y.options["grid"]["ds6w:cadMaster"]}}var G=null;if(null!=x&&null!=x.options&&null!=x.options.grid){G=x.options.grid["ds6w:cadMaster"]}var D=new q({urlIcon:v,physicalId:C,name:F,category:"",type:E,relID:I,parentID:H,cadMaster:G,parentCADMaster:w,responsibleName:B,Revision:z});m.push(D)}}})}h.isAllECInSelection(r,n,m)})},isAllECInSelection:function(t,j,u){var p=this;var o=JSON.parse("[]");var l=false;var k=u.length;var s=[];for(var m=0;m<k;m++){var r=u[m];var n=r.getID();s.push(n)}d.listAttributes(t,s,["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","owner","project","organization","physicalid"],function q(A,C){l=false;var y=0;var B=A.results.length;for(var x=0;x<B;x++){var v=A.results[x];var z=v["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"];if(z=="TRUE"){y++}}if(B>0){for(var x=0;x<A.results.length;x++){var v=A.results[x];for(var w=0;w<u.length;w++){if(v.physicalid===u[w]["physicalId"]){u[w]["owner"]=v.owner;u[w]["project"]=v.project;u[w]["organization"]=v.organization;u[w]["v_IsEmbeddedComponent"]=v["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]}}}}if(y==k){p._setError(j,a.selectOwning);p.enable();p.end();return}require(["DS/AccessRightPopup/AccessRightPopup",],function(D){if(!p.accessRightPanel){if(u.length>0){var E=u[0];var i=widget.body;i=i?i:UWA.extend(document.body);p.accessRightPanel=new D(widget,widget.body,{className:"accessRight_popup_fromCmd",serverName:E.getServerHost(),serverUri:E.getServerUri(),removeAtClose:true,events:{onClose:function(){p.accessRightPanel=null}}});p.accessRightPanel.show(u)}else{p._setError(localContext,UWA.i18n("no content selected"))}}else{p.accessRightPanel.show(u);p.accessRightPanel.container.centerIt()}p.end();p.enable()});return},function h(i){console.log(i);p._setError(j,a.InternalServerError);p.enable();return -1});return l},_setError:function(i,j){if(typeof i.displayNotification==="function"){var h={eventID:"error",msg:j};i.displayNotification(h)}else{alert(j)}},endExecute:function(){}});return e});define("DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(c,b,f,a,d){var e=c.extend(b,f,{labelTopBar:UWA.i18n("Reserve selected objects"),init:function(g){var h=false;this.options=g;if(typeof g!==undefined&&g!==null){if(g.hasOwnProperty("odtMode")){h=g.odtmode}}if(!h){this._setCommandEnableStatus()}this._parent(g,{isAsynchronous:true});if(typeof a.getUser()=="function"){this.currentUser=a.getUser().login}else{this.currentUser=""}},beginExecute:function(){},execute:function(){var g=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(t,j,r,n,o){var l=n.get();if(null==l){l=g.options.context}var h={_setNotification:function(w,v){if(typeof l.displayNotification==="function"){var u={eventID:v,msg:w};l.displayNotification(u)}else{alert(w)}},_setError:function(u){this._setNotification(u,"error")},_setWarning:function(u){this._setNotification(u,"warning")},_setInfo:function(u){this._setNotification(u,"info")}};var k=[];var s=l.getSelectedNodes();var q=false;if(s.length){s.forEach(function(u){if(typeof u.getID=="function"&&typeof u.getLabel=="function"){var v=u.plmType;if(j.inFamilyFolder(v)){console.log("$$$ A Folder has been selected $$$");q=true}var y=u.getID();var x=u.getLabel();if(null!=y){var C="";if(typeof u.getRelationID=="function"){C=u.getRelationID()}var A="";if(typeof u.getParent=="function"){var w=u.getParent();if(typeof w.getID=="function"){A=w.getID()}}var B=null;if(null!=u&&null!=u.options&&null!=u.options.grid){B=u.options.grid["ds6w:cadMaster"]}var z=new o({physicalId:y,name:x,relID:C,parentID:A,cadMaster:B});k.push(z)}}})}if(k.length>0){var m=k[0];m=new o(m);var p=false;if(typeof g.options!==undefined&&g.options!==null){if(g.options.hasOwnProperty("odtmode")){p=g.options.odtmode}}if(p==false){j.allAggregated3DShape(m,function(u){var v=!u;if(u){return}})}}if(q===true){h._setWarning(UWA.i18n("reserve not available"))}else{if(k.length>0){var m=k[0];var i=g.currentUser;if(i==null){i=a.getUser().login}g.container=new r({readOnly:"auto",serverName:m.getServerHost(),serverUri:m.getServerUri(),operation:"reserve",currentUser:i,localContext:l,events:{onNotification:function(u){l.displayNotification(u)}}});g.container.setObjects(k);g.container.launchCmd()}else{h._setWarning(UWA.i18n("reserve no content"))}}});g.end()},endExecute:function(){},_setCommandEnableStatus:function(){var g=this;require(["DS/PADUtils/PADContext"],function(j){var i=j.get();var h=0;if(i!=null){if(j.get().getEditMode!=undefined&&j.get().getEditMode()!==true){h=0}if(1===h){g.enable()}else{g.disable()}j.get().addEvent("editModeModified",function(k){if(k===true){g.enable()}else{g.disable()}})}})},});return e});define("DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/WAFData/WAFData","require","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/UIKIT/SuperModal","DS/ListSnapshots/SuperModalEx","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/WebappsUtils/WebappsUtils","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds",],function(d,n,e,h,m,j,g,i,c,b,l,f,k){var a=d.extend({labelTopBar:"",labelWaitingCreation:"",CurrentlabelWaitingCreation:"",isInsert:false,useSelectedNodes:true,datas:{},activeTopBar:true,ExecutedByTopBar:false,CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V6:"V6",CAD_ORIGIN_TYPE_V5:"V5",CAD_ORIGIN_TYPE_SW:"SW",CAD_ORIGIN_TYPE_CR:"CR",CAD_ORIGIN_TYPE_NX:"NX",CAD_ORIGIN_TYPE_IV:"IV",CAD_ORIGIN_TYPE_AD:"AD",init:function(o){var q=this;q._setCommandEnableStatus();this._parent(o,{isAsynchronous:true});if(this.activeTopBar===true&&this.labelTopBar!=""){try{require(["DS/TopBarProxy/TopBarProxy","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuItem"],function(r,v,u){var t=new r({id:widget.id});var s=new u({label:q.labelTopBar,onExecute:function(){q.executeTopBar()}});t.addContent({add:s})})}catch(p){console.log("can't load top bar")}}},beginExecute:function(){},executeTopBar:function(){this.ExecutedByTopBar=true;this.execute()},execute:function(){var p=this;var q=p.ExecutedByTopBar;p.ExecutedByTopBar=false;var o={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(s){if(s){try{var r=s.get();o={"DS-Change-Authoring-Context":r.AuthoringContextHeader?r.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":r.AuthoringContextHeader?r.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(t){console.log("Change action is empty");o=null}}});require(["DS/WidgetServices/WidgetServices","DS/PADUtils/PADContext"],function(E,x){var C=null;var w=x.get();if(null==w){w=p.options.context}if((w!=null)&&(typeof w.getpreferredCAD==="function")){p.datas.preferredCAD=w.getpreferredCAD()}p.datas.expectSingleCreation=false;if((w!=null)&&(typeof w.expectSingleCreation==="function")){p.datas.expectSingleCreation=w.expectSingleCreation()}if((w!=null)&&(typeof w.getpreferredTemplate==="function")){p.datas.preferredTemplate=w.getpreferredTemplate()}var t={_endCreation:function(){w.endBlockingTransaction(p.CurrentlabelWaitingCreation);if(!q){p.end()}p.enable();if(typeof widget!="undefined"){widget.dispatchEvent("CREATIONDONE")}},_setNotification:function(I,H){if(typeof w.displayNotification==="function"){var G={eventID:H,msg:I};w.displayNotification(G)}else{alert(I)}},_setError:function(G){this._setNotification(G,"error")},_setWarning:function(G){this._setNotification(G,"warning")},_setInfo:function(G){this._setNotification(G,"info")},_getCurrentFolder:function(){var I=null;if(w&&typeof w.getCurrentFolder==="function"){var H=w.getCurrentFolder();if(H){var G=JSON.parse(H);I={FolderID:G.FolderID,FolderType:G.FolderType}}}return I},_launchThroughSecurityContext:function(L,M,J){var K=this;var G=null;var I=null;var H={context:w};e.getInstance(H).getSecurityContext({onSuccess:function(N){K._onCompleteGetSecurityContext(N,L,J)},onFailure:function(N){t._endCreation();if(N!=null){t._setError(N.message)}}},{serverName:G,serverUri:I})},_onCompleteGetSecurityContext:function(J,O,M){var W=this;var G={Accept:"application/json","Content-Type":"application/json"};if(M!=undefined){if(M["DS-Change-Authoring-Context"]){G["DS-Change-Authoring-Context"]=M["DS-Change-Authoring-Context"]}if(M["DS-Configuration-Authoring-Context"]){G["DS-Configuration-Authoring-Context"]=M["DS-Configuration-Authoring-Context"]}}var Q="";if(J.SecurityContext.indexOf("ctx::")!=0){Q="ctx::"}G.SecurityContext=Q+J.SecurityContext;var U=p.datas;if(w&&typeof w.getCurrentFolder==="function"){var V=w.getCurrentFolder();for(var X in V){U[X]=V[X]}}delete U.aggregating_context;var K="?select=type&select=physicalid&select=cestamp";if(p.isInsert===true&&y!==""){K+="&aggregating_context="+y;K+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid")}else{if(p.isInsert===true&&F.length>=1){K+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid");U.aggregating_context=[];F.forEach(function(Y){U.aggregating_context.push(Y)})}}var U=UWA.Json.encode(U);var L=t._getCurrentFolder();var P=null;var H=false;if(L!=null){P=L.FolderID}try{if(g.getActiveFolder!==undefined){var N=g.getActiveFolder();var I=UWA.Json.decode(U).type;if(I!=="folder"&&N.id!==null){P=N.id;H=true;if(N.sc!==undefined&&N.sc!==""){var Q="";if(N.sc.indexOf("ctx::")!==0){Q="ctx::"}G.SecurityContext=Q+N.sc}require(["DS/PlatformAPI/PlatformAPI"],function(Y){Y.publish("FolderEditor.ActiveFolderCallBack",{id:N.id,label:N.label})})}}}catch(T){if(L!=null){P=L.FolderID;G.SecurityContext=Q+J.SecurityContext}}if(P!=null){K+="&folderID="+P;if(H){K+="&activeFolder=true"}}var I=UWA.Json.decode(U).type;if((p.options.odtmode==null||p.options.odtmode==false)&&g.getEnforceFolderLinkSetting()&&(L==undefined||P==undefined)&&(I=="component"||I=="assembly")){t._endCreation();if(window.top.location.href.indexOf("ENOPRSU_AP")>-1||window.top.location.href.indexOf("ENOPSTR_AP")>-1){t._setError(UWA.i18n("ERROR_PIN_APP"))}else{t._setError(UWA.i18n("ERROR_SELECT_FOLDER"))}}else{var R="";var S="";if(O!=null){R=O.getHost();S=O.getRootUri()}E.get3DSpaceUrlAsync({onComplete:function(aa){var Y=aa+"/resources/v1/collabServices/authoring/op/createContent"+K;G["Accept-Language"]=widget.lang;var Z=E.getTenantID();if(Z&&Z.length!=0){Y+="&tenant="+Z}else{Y+="&tenant=OnPremise"}m.authenticatedRequest(Y,{type:"json",method:"POST",proxy:"passport",headers:G,timeout:3600000,data:U,onComplete:function(ab){W._onCompleteCreation(ab)},onFailure:function(ab,ac,ad){t._endCreation();t._setError(UWA.i18n("Failure during content creation"))},onTimeout:function(){t._endCreation();t._setError(UWA.i18n("Timeout for content creation"))}})}})}},_onCompleteCreation:function(I){t._endCreation();var H=new n(I);if(typeof w.author==="function"){if(H.isSuccess()||H.isWarning()){t._setInfo(UWA.i18n("Creation successful"));if(H.isWarning()&&H.getMessage()){t._setWarning(H.getMessage())}var G=H.getPhysicalId();if(G!=""){if(w&&typeof w.insertNodes==="function"){if(p.isInsert===true&&H.hasOwnProperty("instances")){w.author(true);var J=[];H.instances.forEach(function(R){var S=R["to[VPMInstance].physicalid"];var T=H.getAttributes();T.push({name:"instanceName",value:R.instanceName});if(p.datas.type=="component"&&p.datas.cadOriginType!="undefined"&&p.datas.cadOriginType!=null&&p.datas.cadOriginType!=""){T.push({name:"relcount",value:"1"})}var Q=R.parentid;J.push({parent_id:Q,children:[{relationid:S,attributes:T}]})});w.insertNodes({inserted:J})}else{if(p.isInsert===true){var N=H.getRelationPhysicalId();w.author(true);var O=H.getAttributes();if(p.datas.type=="component"&&p.datas.cadOriginType!="undefined"&&p.datas.cadOriginType!=null&&p.datas.cadOriginType!=""){O.push({name:"relcount",value:"1"})}w.insertNodes({inserted:[{parent_id:y,children:[{relationid:N,attributes:O}]}]})}else{w.author(true);if(h.isWorkspaceFolder(H.getType())){w.author(true);w.addRoots({pids:[G]});require(["DS/PADUtils/PADCommandProxy"],function(R){var Q={paths:[[G]]};var S=R.create();S.destroy()})}else{var O=H.getAttributes();if(p.datas.type=="component"&&p.datas.cadOriginType!="undefined"&&p.datas.cadOriginType!=null&&p.datas.cadOriginType!=""){O.push({name:"relcount",value:"1"})}w.insertNodes({created:[{attributes:O}]})}}}var K=H.getPhysicalIdsToRefresh();var P=K.length;if(P>0){require(["DS/PADUtils/PADCommandProxy"],function(S){var R={authored:true};var T=[];K.forEach(function(W){var V=[W.physicalid,G];T.push(V)});var Q={authored:{connected:T}};var U=S.create();U.authored(R);U.refresh(Q);U.destroy()})}}}else{t._setError(UWA.i18n("Warning : no physical id returned"))}}else{var M=H.getMessage();if(M!=null){var L=UWA.i18n("creationfailed");if(p.isInsert===true){L=UWA.i18n("insertionfailed")}M=L+UWA.i18n(M)}else{M=UWA.i18n("Failure during content creation")}t._setError(M)}}},};var y="";var F=[];var u;if(p.useSelectedNodes){u=w.getSelectedNodes()}var D="";if((u!=null)&&u.length>0){p.isInsert=true;p.CurrentlabelWaitingCreation=UWA.i18n("Inserting "+p.labelWaitingCreation);p.disable();var r=[];u.forEach(function(G){if(r.hasOwnProperty(G.getID())){return}r[G.getID()]=true;F.push(G.getID())});if(widget.getValue("x3dAppId")=="ENOPSTR_AP"||widget.getValue("x3dAppId")=="ENXENG_AP"){var A=function(){t._endCreation()};var v=function(G){t._setError(G);t._endCreation()};var B=function(){p.chooseCadOriginTypeForNewObject(u,function G(I,K,J,H){p.datas.cadOriginType=J;p.datas.title=K;p.datas.filename=H;p.datas.specializedtype=I;w.beginBlockingTransaction(p.CurrentlabelWaitingCreation);t._launchThroughSecurityContext(C,true,o)},A,v)};if(u.length>1){p.warningMultiSelectionDialog(u,B,A,v)}else{B()}return}else{if(u!=null&&u.length>1){var D=UWA.i18n("Please select only one parent");t._endCreation();t._setError(D)}else{y=u[0].getID();if(widget.getValue("x3dAppId")!="ENOFOL3_AP"){p.datas.cadOriginType="V6";p.datas.title=""}w.beginBlockingTransaction(p.CurrentlabelWaitingCreation);t._launchThroughSecurityContext(C,true,o)}}}else{p.isInsert=false;p.CurrentlabelWaitingCreation=UWA.i18n("Creating "+p.labelWaitingCreation);p.disable();if(widget.getValue("x3dAppId")=="ENOPSTR_AP"||widget.getValue("x3dAppId")=="ENXENG_AP"){var s;p.showChooseCadOriginTypeDlg(s,function z(H,J,I,G){p.datas.cadOriginType=I;p.datas.title=J;p.datas.filename=G;p.datas.specializedtype=H;w.beginBlockingTransaction(p.CurrentlabelWaitingCreation);t._launchThroughSecurityContext(C,true,o)},function A(){t._endCreation()},function v(G){t._setError(G);t._endCreation()});return}else{if(widget.getValue("x3dAppId")!="ENOFOL3_AP"){p.datas.cadOriginType="V6";p.datas.title=""}w.beginBlockingTransaction(p.CurrentlabelWaitingCreation);t._launchThroughSecurityContext(C,true,o)}}if(D!=""){t._setError(D)}})},getCadOriginsTypes:function(r,q,s){var p=[];r.forEach(function(y){var x=y.getID();p.push({objectId:x})});var w="/resources/v1/collabServices/authoring/op/getCADOriginsTypes";var t=this;var v=widget.getValue("x3dPlatformId");t._post(v,w,{data:p},function u(x){if(x.hasOwnProperty("result")){q(x.result)}else{s(x)}},function o(x){s(x)})},getTemplateNames:function(w,q,r){var t=this;var u=w;var s=t.datas.Templates;var y=t.datas.Specializedtypes;var x=t.datas.CheckfilenameDisplay;var p=t.datas.filenameStatus;if(s==null){var A="/resources/v1/collabServices/authoring/op/getTemplatesNames";var t=this;var z=widget.getValue("x3dPlatformId");t._get(z,A,{templateType:u},function v(B){if(B.results){t.datas.Templates=B.results;t.datas.CheckfilenameDisplay=B.CheckfilenameDisplay;t.datas.Specializedtypes=B.types;t.datas.filenameStatus=B.filenameStatus;q(B.results,B.CheckfilenameDisplay,B.types,B.filenameStatus)}else{r(B.errorMessage)}},function o(B){r(B)})}else{q(s,x,y,p)}},showChooseCadOriginTypeDlg:function(p,w,v,s){var u=this;var x=new b({closable:true,className:"Lifecycle_Modals",events:{onShow:function(){this.dispatchEvent("onChooseTypeShown",x)}},renderTo:document.body});var t=u.datas;if(t.type=="drawing"||t.type=="assembly"||t.type=="component"){u.getTemplateNames(t.type,function q(z,y,B,A){var F=[];var C=u._getavailableUPSData(p,function D(H){var Y=H;var S="3DExperience";for(var V=0;V<Y.length;V++){var N=Y[V];if(N.CAD==S){var I="        ";var K="3DExperience";var Q=f.getWebappsAssetUrl("ENOCollabSharingCmds","icons/3DEXPERIENCE.png");if(t.type=="assembly"||t.type=="component"){S=UWA.i18n(K);var Z="ProductTemplate";if(t.type=="component"){Z="PartTemplate"}var G=I+S+" - "+UWA.i18n(Z);var X={Connector:S,icon:Q,label:G,value:u.CAD_ORIGIN_TYPE_V6};var aa=u._getpreferredCAD();if(aa==K){F.push(X)}else{F.push(X)}}}}for(var V=0;V<Y.length;V++){var N=Y[V];var J=u._getavailableUPSChoice(N,z);for(var T=0;T<J.length;T++){F.push(J[T])}}var M=u._getexpectSingleCreationMode();var U=u._getsilentMode();if(U&&(F.length==1)){var X=F[0];var O=X.value;var ab;var L=null;var R=null;w(L,ab,O,R)}else{var P=F.length;if(P){x.promptSelectList(UWA.i18n("Choose CAD authoring experience"),u.labelTopBar,B,F,y,A,M,function(ae,af,ac,ad){if(ac==null){v()}else{w(ae,af,ac,ad)}})}else{var W=UWA.i18n("notemplateavailable");s(W)}}},function E(G){s(G)})},function o(y){s(y)})}else{var r=[{label:UWA.i18n("3DEXPERIENCE CATIA"),value:this.CAD_ORIGIN_TYPE_V6},{label:UWA.i18n("CATIA V5"),value:this.CAD_ORIGIN_TYPE_V5}];x.promptSelectList(UWA.i18n("Choose CAD authoring experience"),u.labelTopBar,types,r,function(A,B,y,z){if(y==null){v()}else{w(B,y)}})}},warningMultiSelectionDialog:function(r,v,u,q){var s=this;var p=UWA.i18n("warningMultiSelectionDialog Title");var o=UWA.i18n("warningMultiSelectionDialog Text");if(s.datas.type=="drawing"){p=UWA.i18n("warningMultiSelectionDialog Title drawing");o=UWA.i18n("warningMultiSelectionDialog Text drawing")}else{if(s.datas.type=="component"){p=UWA.i18n("warningMultiSelectionDialog Title component");o=UWA.i18n("warningMultiSelectionDialog Text component")}else{if(s.datas.type=="assembly"){p=UWA.i18n("warningMultiSelectionDialog Title assembly");o=UWA.i18n("warningMultiSelectionDialog Text assembly")}}}var t=true;var w=new c({className:"Lifecycle_Modals",renderTo:document.body,events:{onHide:function(){if(t){u()}}}});w.dialog({title:p,body:new UWA.Element("text",{text:o}),buttons:[{className:"primary",value:k.ok,action:function(x){t=false;x.hide();v()},name:"buttonOK"},{className:"default",value:k.ko,action:function(x){t=false;x.hide();u()},name:"buttonCancel"},]})},chooseCadOriginTypeForNewObject:function(t,w,v,s){var u=this;var p=true;t.forEach(function(y){if(y.options.padgrid){var x=y.options.padgrid;if(x&&x["ds6w:globalType"]=="ds6w:Part"){return}}p=false});if(p){u.getCadOriginsTypes(t,function q(A){var x=u.datas;var B=A.cadOrigintypes;var D=A.V_usages;var z=false;D.forEach(function(E){if(E=="3DPart"){z=true}});var y="";if(B.length>0){y=B[0]}B.forEach(function(E){if(y!=E){y=u.CAD_ORIGIN_MIX}});if(y==u.CAD_ORIGIN_MIX){y=u.CAD_ORIGIN_TYPE_V5}if(!z){u.showChooseCadOriginTypeDlg(B,w,v,s)}else{var C=UWA.i18n("Error :")+UWA.i18n("Can not insert multiselection case");s(C)}},function o(x){s(x)})}else{var r=UWA.i18n("Error :")+UWA.i18n("Can not insert multiselection case");s(r)}},endExecute:function(){},_setCommandEnableStatus:function(){var o=this;require(["DS/PADUtils/PADContext"],function(q){var p=q.get();if((p!=null)&&(typeof p.getEditMode==="function")){if(q.get().getEditMode()!==true){o.disable()}q.get().addEvent("editModeModified",function(r){if(r===true){o.enable()}else{o.disable()}})}})},_getavailableUPSData:function(p,q,s){var t=this;var w=t._getpreferredCAD();var z=false;if(typeof p!=="undefined"){var u="";p.forEach(function(A){u=u+A});if(p!==""){var r=t.datas[u];if(typeof r!=="undefined"){z=true;q(r)}}}if(!z){var y="/resources/v1/collabServices/authoring/op/getInsertableCADS";var x=widget.getValue("x3dPlatformId");t._get(x,y,{parentCADOrigins:p},function v(E){if(E.results){var C="";if(typeof p!=="undefined"){p.forEach(function(G){C=C+G})}var D=E.results;var A;if(w!=null&&w.length>0){for(var B=0;B<D.length;B++){if(D[B].CAD==w){var F=new Array();F.push(D[B]);A=F}}}if(A==null){A=D}t.datas[C]=A;q(A)}else{s(E.errorMessage)}},function o(A){s(A)})}},_getavailableUPSChoice:function(z,y){var v=this;var r=[];var u="        ";var o=z.CAD;var t=z.prefix;var s="icons/"+z.icon+".png";var x=UWA.i18n(t);var q=f.getWebappsAssetUrl("ENOCollabSharingCmds",s);var w=v._getpreferredCAD();var p=v._getpreferredTemplate(t);y.forEach(function(A){var E=A.fileName;var D=E;if(E.startsWith(t)==1){E=E.substring(t.length,E.length);var B=u+x+" - "+UWA.i18n(E);var C={Connector:x,icon:q,label:B,value:D};if(p!=null){if(p==E){r.push(C)}}else{if(w!=null){if(w==o){r.push(C)}}else{r.push(C)}}}});return r},_getsilentMode:function(){var q=this;var p=false;var o=q._getpreferredCAD();if(o!=null&&o.length>0){p=true}return p},_getexpectSingleCreationMode:function(){var p=false;var o=this.datas.expectSingleCreation;if(o!=null){p=o}return p},_getpreferredCAD:function(){return this.datas.preferredCAD},_getpreferredTemplate:function(o){return this.datas.preferredTemplate},_get:function(t,q,s,r,p){var o=this;require(["DS/PADUtils/PADContext"],function(y){var x;if(y!=null){x=y.get()}if(null==x){x=o.options.context}var v=Date.now().toString();var u="timestamp"+v;s[u]=v;i.getSecurityContext(t,function w(D){if(D=="ctx::"||D==""){if(x&&typeof x.getSecurityContext==="function"){var C=x.getSecurityContext();D=C.SecurityContext}}var B=g.get3DSpaceWSUrl(t,q,null);if(B.indexOf("?")!=-1){B+="&"}else{B+="?"}for(var A in s){var E=s[A];if(E instanceof Array){E.forEach(function(F){B+=A+"="+F+"&"})}else{B+=A+"="+E+"&"}}m.authenticatedRequest(B,{method:"GET",headers:g.getHeaders(D),timeout:1000*60*60*24,type:"json",onComplete:function(F){r(F)},onFailure:function(F,G){i.onWebServiceError(p,F,G)},onTimeout:function(){i.onWebServiceError(p,null,NLS.timeout)},})},function z(A){i.onWebServiceError(p,null,A)})})},_post:function(t,r,o,s,q){var p=this;require(["DS/PADUtils/PADContext"],function(x){var w;if(x!=null){w=x.get()}if(null==w){w=p.options.context}var u=JSON.stringify(o);i.getSecurityContext(t,function v(B){if(B=="ctx::"||B==""){if(w&&typeof w.getSecurityContext==="function"){var A=w.getSecurityContext();B=A.SecurityContext}}var z=g.get3DSpaceWSUrl(t,r,null);m.authenticatedRequest(z,{method:"POST",headers:g.getHeaders(B),timeout:1000*60*60*24,data:u,type:"json",onComplete:function(C){s(C)},onFailure:function(C,D){i.onWebServiceError(q,C,D)},onTimeout:function(){i.onWebServiceError(q,null,NLS.timeout)},})},function y(z){i.onWebServiceError(q,null,z)})})},});return a});define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewProductCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(b,a){var c=a.extend({labelTopBar:UWA.i18n("New product"),labelWaitingCreation:"new product",datas:{type:"assembly"},init:function(e){var f=this;this._parent(e,{isAsynchronous:true});var d=new Date();var g=d.getTime();this.datas.PLM_ExternalID="prd"+g;f._setPrdCommandEnableStatus()},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(f){var e=f.get();if(e!=null){if(f.get().getEditMode()!==true){d.disable()}f.get().addEvent("editModeModified",function(i){if(i===true){var h=e.getSelectedNodes();var g=true;if((h!=null)&&h.length>=1){h.forEach(function(k){var j=k.options["type"];if(j&&j.contains("Drawing")){g=false}})}if(g){d.enable()}else{d.disable()}}else{d.disable()}})}})},_setPrdCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(g){var f=g.get();if(f!=null){var e=f.options.model;if(e!=null){e.getXSO().onPostAdd(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onPostRemove(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onEmpty(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}})}}})},});return c});define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewDrawingCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(b,a){var c=a.extend({labelTopBar:UWA.i18n("New drawing"),labelWaitingCreation:"new drawing",datas:{type:"drawing"},init:function(e){var f=this;this._parent(e,{isAsynchronous:true});var d=new Date();var g=d.getTime();this.datas.PLM_ExternalID="prd"+g;f._setDrwCommandEnableStatus()},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(f){var e=f.get();if(e!=null){if(f.get().getEditMode()!==true){d.disable()}f.get().addEvent("editModeModified",function(i){if(i===true){var h=e.getSelectedNodes();var g=true;if((h!=null)&&h.length>=1){h.forEach(function(k){var j=k.options["grid"]["ds6w:cadMaster"];if(j.contains("CATIAV5")){g=false}})}if(g){d.enable()}else{d.disable()}}else{d.disable()}})}})},_setDrwCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(g){var f=g.get();if(f!=null){var e=f.options.model;if(e!=null){e.getXSO().onPostAdd(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["grid"]["ds6w:cadMaster"];if(k&&(k.contains("CATIAV5")||k.contains("SOLIDWORKS"))){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onPostRemove(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["grid"]["ds6w:cadMaster"];if(k&&(k.contains("CATIAV5")||k.contains("SOLIDWORKS"))){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onEmpty(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["grid"]["ds6w:cadMaster"];if(k&&(k.contains("CATIAV5")||k.contains("SOLIDWORKS"))){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}})}}})},});return c});define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewFolderCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(b,a){var c=a.extend({labelTopBar:UWA.i18n("New folder"),labelWaitingCreation:"new folder",isInsert:true,useSelectedNodes:false,datas:{type:"folder"},init:function(d){this._parent(d,{isAsynchronous:true})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},});return c});define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewPartCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(b,a){var c=a.extend({labelTopBar:UWA.i18n("New part"),labelWaitingCreation:"new part",datas:{type:"component"},init:function(d){var e=this;this._parent(d,{isAsynchronous:true});e._setPartCommandEnableStatus()},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(f){var e=f.get();if(e!=null){if(f.get().getEditMode()!==true){d.disable()}f.get().addEvent("editModeModified",function(i){if(i===true){var h=e.getSelectedNodes();var g=true;if((h!=null)&&h.length>=1){h.forEach(function(k){var j=k.options["type"];if(j&&j.contains("Drawing")){g=false}})}if(g){d.enable()}else{d.disable()}}else{d.disable()}})}})},_setPartCommandEnableStatus:function(){var d=this;require(["DS/PADUtils/PADContext"],function(g){var f=g.get();if(f!=null){var e=f.options.model;if(e!=null){e.getXSO().onPostAdd(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onPostRemove(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}});e.getXSO().onEmpty(function(){var j=f.getEditMode();if(j!==true){d.disable();return}var i=f.getSelectedNodes();var h=true;if((i!=null)&&i.length>=1){i.forEach(function(l){var k=l.options["type"];if(k&&k.contains("Drawing")){h=false}});if(h){d.enable()}else{d.disable()}}else{d.enable()}})}}})},});return c});define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase",["UWA/Class","DS/ApplicationFrame/Command","DS/LifecycleServices/LifecycleServicesSettings","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(b,a,f,e,g,c){var d=b.extend(a,e,{transferType:"full",genericTransfer:false,init:function(h){var i=false;if(typeof h!==undefined&&h!==null){if(h.hasOwnProperty("odtMode")){i=h.odtmode}}if(!i){this._setCommandEnableStatus()}this.options=h;this._parent(h,{isAsynchronous:true});this.transferOwnershipPanel=null},beginExecute:function(){},execute:function(){var i=this;var h={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(k){if(k){try{var j=k.get();h={"DS-Change-Authoring-Context":j.AuthoringContextHeader?j.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":j.AuthoringContextHeader?j.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(l){console.log("Change action is empty");h=null}}});require(["DS/WidgetServices/WidgetServices","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/TransferOwnershipWidget/popup/TransferOwnershipPopup","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/Selection/CSOManager","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/Services/CommandServices",],function(y,x,z,u,l,s,m){var q=s.get();if(null==q){q=i.options.context}var t={context:q};var o="";if(i.transferType=="owner"){o=x.TransferPerson}else{if(i.transferType=="CS"){o=x.TransferCollabSpace}else{o=x.TransferFull}}var p=[];var n=l.get();if(n.length>0){n.forEach(function(A){if(A.hasOwnProperty("isResultElement")){A.setCategory("");p.push(A)}})}else{var k=q.getSelectedNodes();if(k.length){k.forEach(function(C){var G=C.getID();var I=C.getLabel();var H=null;var F="";var E=null;var A=null;if(C.options){H=C.options.type;F=C.options.subLabel;E=C.options.grid["ds6wg:revision"]}else{if(C.object){F=C.object.ownerFullName;E=C.object.revision;if(null!=C.object.options&&null!=C.object.options.icons&&C.object.options.icons.length>0){var N=C.object.options.icons[0];A=N.length&&N.indexOf("http")<0?f.get3DSpaceBaseUrl(y.getTenantID())+N:N}}}if(F==null||F==undefined){if(C.options){F=C.options.grid["ds6w:responsible"]}}if(null!==G){var M="";if(typeof C.getRelationID=="function"){M=C.getRelationID()}var L="";var B="";if(null!==C&&null!==C.getParent&&typeof C.getParent=="function"){var D=C.getParent();if(null!==D&&null!==D.getID&&typeof D.getID=="function"){L=D.getID();B=D.options["grid"]["ds6w:cadMaster"]}}var K=null;if(null!=C&&null!=C.options&&null!=C.options.grid){K=C.options.grid["ds6w:cadMaster"]}if(null==A&&null!=C&&null!=C.options&&null!=C.options.icons&&C.options.icons.length>0){A=C.options.icons[0]}var J=new u({urlIcon:A,physicalId:G,name:I,category:"",type:H,relID:M,parentID:L,cadMaster:K,parentCADMaster:B,responsibleName:F,Revision:E});p.push(J)}})}}if(p.length>0){var r=p[0];r=new u(r);var v=false;if(typeof i.options!==undefined&&i.options!==null){if(i.options.hasOwnProperty("odtmode")){v=i.options.odtmode}}if(v==false){f.app_initialization(function(){m.allAggregated3DShape(r,function(A){var B=!A;if(A){return}})})}}i.getSecurityContext(function w(B){if(!i.transferOwnershipPanel){if(p.length>0){var A=p[0];A=new u(A);i.transferOwnershipPanel=new z(widget.body,{className:i.className,context:q,transferType:o,serverName:A.getServerHost(),serverUri:A.getServerUri(),activeDnD:true,activeOptions:true,activeAdminCheckBox:widget.getBool("admin"),activeSummaryButton:true,genericTransfer:i.genericTransfer,securityContext:B,events:{onClose:function(){i.transferOwnershipPanel=null}}});i.transferOwnershipPanel.show(p,h)}else{i._setError(UWA.i18n("no content selected"))}}else{i.transferOwnershipPanel.setSecurityContext(B);i.transferOwnershipPanel.show(p,h);i.transferOwnershipPanel.container.centerIt()}},function j(){i._setError(UWA.i18n("Fail to get security context"))},t);i.end()})},getSecurityContext:function(j,i,h){g.getInstance(h).getSecurityContext({onSuccess:function(l){if(l!=null&&l!=""&&l.hasOwnProperty("SecurityContext")&&l.SecurityContext!=null){var m="";if(l.SecurityContext.indexOf("ctx::")!=0){m="ctx::"}var k=m+l.SecurityContext;j(k)}else{i()}},onFailure:function(k){i()}})},_setError:function(i){if(typeof this.options.context.displayNotification==="function"){var h={eventID:"error",msg:i};this.options.context.displayNotification(h)}else{alert(i)}},endExecute:function(){},_setCommandEnableStatus:function(){var h=this;require(["DS/PADUtils/PADContext"],function(k){var j=k.get();var i=0;if(j!=null){if(k.get().getEditMode!=undefined&&k.get().getEditMode()!==true){i=0}if(1===i){h.enable()}else{h.disable()}k.get().addEvent("editModeModified",function(l){if(l===true){h.enable()}else{h.disable()}})}})},});return d});define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeCSCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(b){var a=b.extend({transferType:"CS",className:"changeCollabSpace_popup_fromCmd",init:function(c){this._parent(c,{isAsynchronous:true})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}});return a});define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(b){var a=b.extend({transferType:"full",genericTransfer:true,className:"changeOwner_popup_fromCmd",init:function(c){this._parent(c,{isAsynchronous:true})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}});return a});define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(b){var a=b.extend({transferType:"full",className:"changeOwnership_popup_fromCmd",init:function(c){this._parent(c,{isAsynchronous:true})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}});return a});