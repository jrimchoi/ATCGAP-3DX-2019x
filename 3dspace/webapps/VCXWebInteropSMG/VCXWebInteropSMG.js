define("DS/VCXWebInteropSMG/VCXSmgLoaderCrypto",["UWA/Class"],function(a){var b=a.extend({init:function(){this.CRYPTO_DELTA=1754008087;this.strKEY="a??????bc??de????????fghi????jklmno????pqrstu??????vwxyzA??????BC??DE????????FGHI????JKLMNO????PQRSTU??VWXYZ0123456789";this.m_pKey=null;this.m_pKey=[0,0,0,0];for(var c=0;c<4;c++){this.m_pKey[c]=0}},SetKey:function(d){if(d.length!==4){return}for(var c=0;c<4;c++){this.m_pKey[c]=d[c]&4294967295}},TEACodelong_A:function(e){if(e.length!==2){return[]}var h=e[0];var d=e[1];var c=0;var g=Math.floor(this.CRYPTO_DELTA);var f=32;while((f-->0)){c+=g&4294967295;h=h+(((d<<4&4294967295)+this.m_pKey[0]&4294967295)^(d+c&4294967295)^((d>>5&4294967295)+this.m_pKey[1]&4294967295))&4294967295;d=d+(((h<<4&4294967295)+this.m_pKey[2]&4294967295)^(h+c&4294967295)^((h>>5&4294967295)+this.m_pKey[3]&4294967295))&4294967295}e[0]=h;e[1]=d;return e},TEACode:function(c){if(((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)){return this.TEACodelong_A(c)}else{if(((typeof c==="string")||c===null)){return this.TEACodejava_lang_String(c)}else{throw new Error("invalid overload")}}},TEADecodelong_A:function(e){if(e.length!==2){return[]}var h=32;var c;var g=e[0];var d=e[1];var f=Math.floor(this.CRYPTO_DELTA);c=f<<5&4294967295;while((h-->0)){d=d-(((g<<4&4294967295)+this.m_pKey[2]&4294967295)^(g+c&4294967295)^(((g&4294967295)>>>5)+this.m_pKey[3]&4294967295))&4294967295;g=g-(((d<<4&4294967295)+this.m_pKey[0]&4294967295)^(d+c&4294967295)^(((d&4294967295)>>>5)+this.m_pKey[1]&4294967295))&4294967295;c-=f;c&=4294967295}e[0]=g;e[1]=d;return e},TEADecode:function(c){if(((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)){return this.TEADecodelong_A(c)}else{if(((typeof c==="string")||c===null)){return this.TEADecodejava_lang_String(c)}else{throw new Error("invalid overload")}}},TEACodejava_lang_String:function(e){var h=e;h.split("-").join("");h.split("_").join("");h.split(".").join("");h.split("/").join("");if(h.length===0){return""}var d=h.length%16;if(d!==0){return""}h.toUpperCase();var f="";while((h.length>0)){var c=[0,0];var g=h.substring(0,Math.min(8,h.length));g=h.substring(0,Math.min(16,h.length));g=g.substring(h.length-8,h.length);this.TEACodelong_A(c);var i=void 0;f+=i;if(h.length<=16){h=""}else{h=g.substring(h.length-16,h.length);h+="-"}}return f},TEADecodejava_lang_String:function(f){var h=f;h.split("-").join("");h.split("_").join("");h.split(".").join("");h.split("/").join("");if(h.length===0){return""}var d=h.length%16;if(d!==0){return""}h.toUpperCase();var e="";while((h.length>0)){var c=[0,0];var g=h.substring(0,Math.min(8,h.length));g=h.substring(0,Math.min(16,h.length));g=g.substring(h.length-8,h.length);this.TEADecodelong_A(c);var i=void 0;e+=i;if(h.length<=16){h=""}else{h=g.substring(h.length-16,h.length);h+="-"}}return e},TEADecodeOption:function(h){var g=this.TEADecodejava_lang_String(h);if(g.length<=0){return[]}g.split("-").join("");g.split("_").join("");g.split(".").join("");g.split("/").join("");var f=g.length%16;g.toUpperCase();if(f!==0){return[]}var c=(g.length/8|0);var e=(function(k){var i=[];while(k-->0){i.push(0)}return i})(c);for(var d=0;d<c;d++){var j=g.substring(0,Math.min(8,g.length));g=g.substring(g.length-8,g.length)}return e},CodeUNICODE:function(l){var d=this.strKEY.length;var g=l.length;var h=(function(i){var e=[];while(i-->0){e.push(0)}return e})(g);try{h=(l).split("").map(function(e){return e.charCodeAt(0)})}catch(k){console.error(k.message,k)}var j=this.strKEY.split("").map(function(e){return e.charCodeAt(0)});for(var f=0;f<g;f++){h[f]=((h[f]+j[f%d])|0)}var c;return c},Code:function(j){var d=this.strKEY.length;var f=j.length;var g=(j).split("").map(function(i){return i.charCodeAt(0)});var h=this.strKEY.split("").map(function(i){return i.charCodeAt(0)});for(var e=0;e<f;e++){g[e]=(((g[e])+h[e%d])|0)}var c;return c},DecodeUNICODE:function(k){var e=this.strKEY.length;var j=this.strKEY.split("").map(function(i){return i.charCodeAt(0)});var h;var g=h.length;var d=new Array((g/2|0));for(var f=0;f<(g/2|0);f++){}var c=d.join("");return c},Decode:function(j){var d=this.strKEY.length;var f=j.length;var h=this.strKEY.split("").map(function(i){return i.charCodeAt(0)});var g;for(var e=0;e<f;e++){g[e]=((g[e]-h[e%d])|0)}var c=String.fromCharCode.apply(null,g);return c}});return b});define("DS/VCXWebInteropSMG/VCXSmgLoaderInflate",["UWA/Class","ZipJS/inflate"],function(c,g){var e=0;var b=0;var d=1;var a=-5;var f=c.extend({Inflate:function(m){var p=gztools.getZstream();var j=512;var q=b;var h=new Uint8Array(j);var o=false;p.inflateInit();p.next_out=h;var l,r=[],k=0,i=0,n;if(m.length===0){return}p.next_in_index=0;p.next_in=m;p.avail_in=m.length;do{p.next_out_index=0;p.avail_out=j;if((p.avail_in===0)&&(!o)){p.next_in_index=0;o=true}l=p.inflate(q);if(o&&(l===a)){return -1}if(l!==e&&l!==d){break}if(p.next_out_index){if(p.next_out_index===j){r.push(new Uint8Array(h))}else{r.push(new Uint8Array(h.subarray(0,p.next_out_index)))}i+=p.next_out_index;if((l===d)){break}}}while(p.avail_in>0||p.avail_out===0);n=new Uint8Array(i);r.forEach(function(s){n.set(s,k);k+=s.length});return n}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderTools",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueFrame","DS/VCXWebProperties/VCXPropertyValuePoint2D","DS/VCXWebProperties/VCXPropertyValuePoint","DS/VCXWebProperties/VCXPropertyValueLocation","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueVector","DS/VCXWebProperties/VCXPropertyValueAnchor","DS/VCXWebProperties/VCXPropertyValueDate","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueFont","DS/VCXWebInteropSMG/VCXSmgLoaderCrypto"],function(n,s,o,q,m,r,p,d,l,h,e,i,t,b,c,j,k,a,g){var f=n.singleton({fillMatrix:function(v,z){var B=new s.Matrix4();if(v===undefined){return B}var D=v.Origin;var u=v.VX;var C=v.VY;var A=v.VZ;if((D!==undefined)&&(u!==undefined)&&(C!==undefined)){var y=new s.Vector3(parseFloat(u["@attributes"].X.replace(",",".")),parseFloat(u["@attributes"].Y.replace(",",".")),parseFloat(u["@attributes"].Z.replace(",",".")));var x=new s.Vector3(parseFloat(C["@attributes"].X.replace(",",".")),parseFloat(C["@attributes"].Y.replace(",",".")),parseFloat(C["@attributes"].Z.replace(",",".")));var w;if(z===true||A===undefined){w=new s.Vector3();w.crossVectors(y,x);y.normalize();w.normalize();x.crossVectors(w,y)}else{w=new s.Vector3(parseFloat(A["@attributes"].X.replace(",",".")),parseFloat(A["@attributes"].Y.replace(",",".")),parseFloat(A["@attributes"].Z.replace(",",".")))}B.set(y.x,x.x,w.x,parseFloat(D["@attributes"].X.replace(",",".")),y.y,x.y,w.y,parseFloat(D["@attributes"].Y.replace(",",".")),y.z,x.z,w.z,parseFloat(D["@attributes"].Z.replace(",",".")),0,0,0,1)}return B},fillPropertyValue:function(E,D,F){var A=null;switch(D){case"VCXPropertyValueString":A=new o();var S;if(E["@attributes"]){if(E["@attributes"].Crypted==="1"){var B=F?F.getManager("VCXNLSManager"):null;var x=B?B.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]):null;S=x?x.getTitle({key:"Property.EncryptedValue"}):"Encrypted value"}else{S=E["@attributes"].Value}}if(E.Line){for(var R=0;R<E.Line.length;R++){if(S){S+="\n"}else{S=""}S+=E.Line[R]["@attributes"].Value}}var J=S;A.SetValue(J);break;case"VCXPropertyValueColor":var C=E["@attributes"];A=new i();var M=new s.Color();M.setRGB(C.R/255,C.G/255,C.B/255);A.SetValue(M);break;case"VCXPropertyValueVector":A=new t();var C=E["@attributes"];var v=new s.Vector3(parseFloat(C.X.replace(",",".")),parseFloat(C.Y.replace(",",".")),parseFloat(C.Z.replace(",",".")));A.SetValue(v);break;case"VCXPropertyValueFloat":A=new q();var P=E["@attributes"].Value;A.SetValue(parseFloat(P));break;case"VCXPropertyValueInt":A=new m();var P=E["@attributes"].Value;A.SetValue(parseInt(P));break;case"VCXPropertyValueHyperlinkId":var P=E["@attributes"].Value;A=P;break;case"VCXPropertyValueBoolean":A=new p();var P=E["@attributes"].Value;var K=false;if(P==="true"||parseInt(P)>0){K=true}A.SetValue(K);break;case"VCXPropertyValueFrame":var N=this.fillMatrix(E.Frame?E.Frame:E,false);A=new d();A.SetValue(N);break;case"VCXPropertyValuePoint2D":var L=E["@attributes"];A=new l();A.SetValue(new s.Vector2(parseFloat(L.X.replace(",",".")),parseFloat(L.Y.replace(",","."))));break;case"VCXPropertyValuePoint":var L=E["@attributes"];A=new h();A.SetValue(new s.Vector3(parseFloat(L.X.replace(",",".")),parseFloat(L.Y.replace(",",".")),parseFloat(L.Z.replace(",","."))));break;case"VCXPropertyValueLocation":var H=this.fillMatrix(E.Frame,false);var O=this.fillMatrix(E.Pivot,false);A=new e();var I=new d();I.SetValue(H);A.SetFrame(I);var u=new d();u.SetValue(O);A.SetPivot(u);break;case"VCXPropertyValueAnchor":var H=this.fillMatrix(E.Frame,true);var A=new b();var y=new d();y.SetValue(H);A.SetValueFrame(y);var C=E["@attributes"];if(C!==undefined){var G=C.AttachId;var w=F.ComponentsMap.GetComponentFromID(G);if(w){A.SetValueLinkFromComponent(w)}}break;case"VCXPropertyValueEnum":A=new r();var P=E["@attributes"].Value;A.SetValue(parseInt(P));break;case"VCXPropertyValueDate":var L=E["@attributes"];var z=new Date(L.Year,L.Month-1,L.Day,L.Hour,L.Min,L.Sec);A=new c(z);break;case"VCXPropertyValueDocId":A=new j(z);A.SetValue(-1);break;case"VCXPropertyValueMap":A=new k();break;case"VCXPropertyValueFont":A=new a();var L=E["@attributes"];if(L){if(L.FaceName){var Q=L.FaceName;if(Q==="MS Shell Dlg"){Q="Microsoft Sans Serif"}A.SetFamily(new o(Q))}if(L.Height){A.SetHeight(new q(-parseFloat(L.Height)/1.33333))}if(L.Weight){A.SetWeight(new m(parseInt(L.Weight)))}if(L.Italic){var K=false;if(L.Italic==="true"||parseInt(L.Italic)>0){K=true}A.SetItalic(new p(K))}if(L.Underline){var K=false;if(L.Underline==="true"||parseInt(L.Underline)>0){K=true}A.SetUnderline(new p(K))}if(L.StrikeOut){var K=false;if(L.StrikeOut==="true"||parseInt(L.StrikeOut)>0){K=true}A.SetCrossline(new p(K))}}break;default:break}return A},getPropertiesDicoFromWebComponent:function(u){if(!f._factory||!f._factory._mapComponentConverter){console.warn("Properties dictionary is not set")}var v=f._factory._mapComponentConverter.get(u);if(!v){console.warn("Can't find any property name translation");return null}return v.getPropertiesDescription()},getPropertiesDicoFromWebType:function(x){if(!f._factory){return null}var u=f._factory.getV1Ids();if(!u){return null}for(var v in u){if(u[v]&&u[v].classname===x){var w=new u[v].classFcntName();if(!w){console.warn("Can't find any property name translation");return null}return w.getPropertiesDescription()}}},getPropertiesDicoFromWebTypeWithInheritance:function(v){if(!f._factory||!f._factory._mapComponentConverter){return null}var u=f.getPropertiesDicoFromWebType(v);f._factory._mapComponentConverter.forEach(function(x,w){if(w&&w.IsKindOf(v)&&x){u=UWA.extend(u,x.getPropertiesDescription())}});return u},getPropertiesDicoFromV1Type:function(w){if(!f._factory){return null}var u=f._factory.getV1Ids();if(!u){return null}var v=new u[w].classFcntName();if(!v){console.warn("Can't find any property name translation");return null}return v.getPropertiesDescription()},_getAnchorIds:function(v,C){var y=[];C.forEach(function(D,E){var G=D;if(G.GetType()==="VCXPropertyValueAnchor"){var F=G.GetValue();if(F&&F[0].Value){y.push(F[0].Value)}}});var B=v.GetHashing();if(B){var A=v.ExperienceBase.getManager("VCXScenarioManager").GetNeutrals(B);if(A&&A._map){for(var z in A._map){if(A._map.hasOwnProperty(z)){var w=A.GetProperty(z);var x=w.GetPropertyValue();if(x&&x.GetType()==="VCXPropertyValueAnchor"){var u=x.GetValue();if(u&&u[0].Value){y.push(u[0].Value)}}}}}}return y},translateLinkedPropertyString:function(I,u,M,H,z,w){if(!I){return z}if(!z){return""}var v=I.ComponentsMap.GetComponentTable();if(!v){return z}var E=z;var K=this._getAnchorIds(u,w);if(K.length>0&&M&&M!=="Text String"){E="$(#"+((H)?H:"")+"#"+M+")";if(K.length){var A=v[K[0]];if(H){var y=A.QueryInterface("VCXIModelNavigable");for(var J=0;J<H;++J){if(!y){console.warn("Invalid string");break}y=y.getParent()}A=y.GetObject()}if(A){var x=f.getPropertiesDicoFromWebComponent(A);if(x&&x[M]){E=E.replace(M,x[M].name)}}}}else{if(z){E=z;var F=z.match(/([^$]|^)\$\(([0-9a-zA-Z._#-\s]*)\)+/g);if(F){for(var J=0;J<F.length;++J){var C=F[J];if(!C){continue}var B=C.substring(C.indexOf("(")+1,C.lastIndexOf("#"));var D=C.substring(C.lastIndexOf("#")+1,C.length-1);var A=v[B];var G=B!==""&&!isNaN(B);if(!A&&!G){console.log("VCXSmgLoaderTools.translateLinkedPropertyString : Regex problem");continue}var L="$(";if(A){L+=(B+"#0")}else{if(G){L+="#"+B}}L+=("#"+D+")");if(!A){A=K.length?v[K[0]]:u.GetObject()}if(A){var x=f.getPropertiesDicoFromWebComponent(A);if(x&&x[D]){L=L.replace(D,x[D].name);E=E.replace(C,L)}else{E=E.replace(C," ? ");console.log("Warning : a property referenced by collab string : "+D+" doesn't exist - Check if property is imported")}}}}}}return E},_reflectCRC:function(w,v){var x=0;for(var u=1;u<(v+1);u++){if((w&1)!==0){x|=1<<(v-u)}w>>=1;w=w&4294967295}return x},calcCRC:function(B){var J=B.length;if(B.length===0||J===0){return 0}var H=(function(L){var K=[];while(L-->0){K.push(0)}return K})(256);var G=79764919;for(var C=0;C<=255;C++){H[(C|0)]=(this._reflectCRC(C,8)<<24)&4294967295;for(var A=0;A<8;A++){H[C]=(((H[C]<<1)&4294967295)^(((H[C]&((1<<31)&4294967295))&4294967295)!==0?G:0))&4294967295}H[C]=this._reflectCRC(H[C],32)}var x=-1;var z=B;var v=x;var C=0;while((J-->0)){var y=(v|0);var F=(y>>>8);var w=(y&255);var u=z[C++];var E=(((w^u)&255)|0);var I=H[E];v=(F^I)&4294967295;if(J-->0){y=(v|0);F=(y>>>8);w=(y&255);u=0;E=(((w^u)&255)|0);I=H[E];v=(F^I)&4294967295}}x=v;var D=x^4294967295;return D<0?D>>>0:D},_ulong:function(u){return u<0?u>>>0:u},decodeOptions:function(u,B){var z=this._ulong(B);var D=[];D[0]=305419896;D[1]=591751049|z;D[2]=878082192;D[3]=247375429;var A=[];for(var x=0;x<u.length;x++){A[x]=u[x]&4294967295}var C=new g();C.SetKey(D);var w=C.TEADecode(A);var v=0;var y=w[1]&z;if(y===z||y===w[1]){v=w[0]}return this._ulong(v)}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiable",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueEnum","DS/WebRBTree/WebRBIterator"],function(e,b,h,a,g,d){var c={"Actor.Name":{name:"Actor.Name",type:"VCXPropertyValueString"},"Text.StayOnTop":{name:"Actor.IsAlwaysOnTop",type:"VCXPropertyValueBoolean"},"Actor.ToolTip":{name:"Actor.ToolTip",type:"VCXPropertyValueString"},"Actor.LinkedToolTipPropertyName":{name:null,type:"VCXPropertyValueString"},Link:{name:"Actor.Hyperlink",type:"VCXPropertyValueHyperlinkId"},"Actor.Color":{name:"Actor.Color",type:"VCXPropertyValueColor"},"Actor.Alpha":{name:"Actor.Opacity",type:"VCXPropertyValueFloat"},"Actor.Location":{name:"Actor.Position",type:"VCXPropertyValueLocation"},"Actor.Interpolator.Location":{name:"Actor.Interpolation.Type",type:"VCXPropertyValueEnum"},"Actor.BomId":{name:"Actor.BomId",type:"VCXPropertyValueString"},};var f=e.extend({getPropertiesDescription:function(){return UWA.extend({},c)},getPropertiesMap:function(Q,w,i,q,K){var P=new Map();var E=null;var t=null;for(var I in i){if(!i.hasOwnProperty(I)){continue}var m=i[I];var M=c[I];if(M){var R=b.fillPropertyValue(m,M.type,w);switch(I){case"Actor.ToolTip":E=R.Value;R=null;break;case"Actor.LinkedToolTipPropertyName":t=R.Value;break;case"Actor.Color":if(m["@attributes"]!==undefined){var T=new h();var O=m["@attributes"].Defined;T.SetValue(O==="0"?false:true);P.set("Actor.Color.Defined",T);R._bDefined=(O==="0"?false:true)}break;case"Actor.Alpha":R.Value/=255;break;case"Actor.Interpolator.Location":if(m["@attributes"]!==undefined&&m["@attributes"].Value!==undefined){var D=parseInt(m["@attributes"].Value);switch(D){case 0:R.SetValue(0);break;case 2:R.SetValue(1);break;case 4:R.SetValue(1);break;default:R.SetValue(0);break}}else{R=null}break;case"Actor.BomId":if(typeof R.Value!=="string"){R=null}break;case"Link":var J=b.fillPropertyValue(m,"VCXPropertyValueHyperlinkId",w);var G=null;if(J.indexOf("file://")>=0){var S=J.lastIndexOf("\\");var B=J.substring(S+1);var y=q[B.toLowerCase()];if(y){G=w.getManager("VCXDocManager").BuildPathFromString(y,B)}}else{if(J){if(J.indexOf("view://")>=0){var L=J.substring(7);G=w.getManager("VCXDocManager").BuildPathFromLink(L)}else{if(J.indexOf("previous://")>=0||J.indexOf("next://")>=0||J.indexOf("first://")>=0||J.indexOf("last://")>=0){var S=J.indexOf("ref:");var H=J.substring(S+4);J="scenario://"+H;G=w.getManager("VCXDocManager").BuildPathFromString(J,"")}else{if(J.indexOf("http://")>=0||J.indexOf("ftp://")>=0){G=w.getManager("VCXDocManager").BuildPathFromString(J,"")}else{var N=w.getManager("VCXSequenceManager").GetListSequencesFromType(0);var z=N[0].GetListScenariosId()[0];var F=w.ComponentsMap.GetComponentFromID(z);var p=null;var n="";if(J.indexOf("play://")>=0){p=2;n=J.substring(7)}else{if(J.indexOf("marker://")>=0){p=3;n=J.substring(9)}else{if(J.indexOf("playmarkersequence://")>=0){p=4;n=J.substring(21)}}}var j=F.GetTrackMarkers();if(j){var x=j._treekeys;var C=new d(x);var u=C.next();while(u!==null){var l=u.GetValue();var A=w.ComponentsMap.GetComponentFromID(l);if(A){var r=A.GetName();if(r===n){G=w.getManager("VCXDocManager").BuildPathFromLink(l,p);break}}u=C.next()}}if(G){}else{if(p===2||p===4){G=w.getManager("VCXDocManager").BuildPathFromLink(z,p)}}}}}}}R=w.getManager("VCXDocManager").AddOrModifyHyperlink(G);break;default:break}if(M.name&&R){P.set(M.name,R)}}else{if(I.slice(0,5)==="Meta."){var v=w.getManager("VCXMetaPropertyManager").GetMetaPropertyDef(I);if(v){var R=b.fillPropertyValue(m,v.GetType(),w);if(R){P.set(I,R)}else{console.log("smgloader : meta fillPropertyValue FAILED")}}else{console.log("smgloader : meta property def NOT FOUND")}}}}if(t||E){var k;if(t&&t!=="Label String"){var o="";if(t.startsWith("niveau ")>0){o=t.substring(7);t="Actor.Name"}else{if(t.startsWith("level ")>0){o=t.substring(6);t="Actor.Name"}}k="$(#"+o+"#"+t+")"}else{k=E}if(k){k=k.replace("Actor.Alpha","Actor.Opacity");var s=new a();s.Value=k;P.set("Actor.ToolTip",s)}}return P}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiable",],function(c,a,d){var b={};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableOccurrence",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiable",],function(c,a,d){var b={"Actor.LayerOpacity":{name:"Actor.LayerOpacity",type:"VCXPropertyValueFloat"},"Actor.Rendering":{name:"Actor.Rendering",type:"VCXPropertyValueEnum"},"Actor.Priority":{name:"Actor.Priority",type:"VCXPropertyValueEnum"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){case"Actor.LayerOpacity":j.Value/=256;break;default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrow",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(c,f,i,h,b){var g={START:0,END:1,BOTH:2,NONE:3};var a=false;var d={"Actor.Color":{name:"Arrow.Body.Color",type:"VCXPropertyValueColor"},"ActorArrow.Bg.Opacity":{name:"Arrow.Body.Color.Opacity",type:"VCXPropertyValueFloat"},"Actor.Gradient":{name:null,type:"VCXPropertyValueBoolean"},"ActorArrow.Border":{name:"Collab.Border.Show",type:"VCXPropertyValueBoolean"},"ActorArrow.Border.Type":{name:"Collab.Border.Line.Type",type:"VCXPropertyValueEnum"},"ActorArrow.Border.Width":{name:"Collab.Border.Line.Width",type:"VCXPropertyValueFloat"},"ActorArrow.Border.Color":{name:"Collab.Border.Line.Color",type:"VCXPropertyValueColor"},"ActorArrow.Border.Opacity":{name:"Collab.Border.Line.Color.Opacity",type:"VCXPropertyValueFloat"},"Actor.Thickness":{name:"Arrow.Width.1",type:"VCXPropertyValueFloat"},"Actor.Thickness2":{name:"Arrow.Width.1",type:"VCXPropertyValueFloat"},"ActorArrow.Thickness":{name:"Arrow.Width.1",type:"VCXPropertyValueFloat"},"ActorArrow.Thickness2":{name:"Arrow.Width.1",type:"VCXPropertyValueFloat"},"ActorArrow.Extremity":{name:null,type:"VCXPropertyValueInt"},"ActorArrow.Extremity.Head":{name:null,type:"VCXPropertyValueFloat"},"ActorArrow.Extremity.x":{name:null,type:"VCXPropertyValueFloat"},"ActorArrow.Extremity.y":{name:null,type:"VCXPropertyValueFloat"},};var e=i.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),d)},getPropertiesMap:function(l,y,N,M,D){var G=function(){a=false};var u=this._parent(l,y,N,M,D);var r=false;var C=false;var x=false;var B=false;var w=null;var Q=false;var n=false;var F=N["ActorArrow.OldVersion"]&&N["ActorArrow.OldVersion"]["@attributes"]&&N["ActorArrow.OldVersion"]["@attributes"].Value==="1";if(F===true&&N["Actor.Thickness"]&&!l.bIsOldVersion){u.set("Collab.Is.Paper",new b(true));l.bIsOldVersion=true;if(!a){if(!w){w=y.getManager("VCXNLSManager")}var o=w.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]);var k=o&&o.getTitle({key:"Notification.ArrowOldVersion.Title"});var I=o&&o.getTitle({key:"Notification.ArrowOldVersion.Msg"});var v={level:"warning",title:k,message:I,};y.getManager("VCXContextManager").addNotification(v);a=true}}for(var p in N){if(!N.hasOwnProperty(p)){continue}var j=d[p];if(j){var K=N[p];var t=f.fillPropertyValue(K,j.type,y);switch(p){case"Actor.Color":n=true;l.bodyColorPropVal=t.Clone();u.set("Arrow.Body.2.Color",t);break;case"ActorArrow.Bg.Opacity":n=true;t.Value/=255;l.bodyOpacity=t.Value;u.set("Arrow.Body.2.Color.Opacity",t);break;case"Actor.Gradient":n=true;l.gradient=t.Value;break;case"ActorArrow.Border.Color":l.borderColorPropVal=t.Clone();u.set("Collab.Border.Line.2.Color",t);break;case"ActorArrow.Border.Opacity":t.Value/=255;l.borderOpacity=t.Value;u.set("Collab.Border.Line.2.Color.Opacity",t);break;case"Actor.Thickness":if(!l.bIsOldVersion){t=null;break}t.SetValue(t.GetValue()*0.25);u.set("Arrow.Width.2",t);l.smgThickness=t.Value;l.smgExtremityHead=2*l.smgThickness;l.smgExtremityX=0;l.smgPreviousExtremityY=l.smgThickness;Q=true;C=true;x=true;B=true;break;case"Actor.Thickness2":if(l.bIsOldVersion){break}Q=true;l.smgThickness=t.Value;u.set("Arrow.Width.2",t);break;case"ActorArrow.Extremity":n=true;Q=true;r=true;l.smgExtremity=t.Value;break;case"ActorArrow.Extremity.Head":if(l.bIsOldVersion){break}Q=true;C=true;x=true;l.smgExtremityHead=t.Value;break;case"ActorArrow.Extremity.x":if(l.bIsOldVersion){break}Q=true;x=true;l.smgExtremityX=t.Value;break;case"ActorArrow.Extremity.y":if(l.bIsOldVersion){break}Q=true;B=true;l.smgPreviousExtremityY=t.Value;break;case"Actor.Style":break;case"ActorArrow.AspectRatio":break;case"ActorArrow.Bg.Opacity":break;case"Text.ShowAxisVertice":break;default:break}if(j.name&&t){u.set(j.name,t)}}}if(Q){var P=null;var O=null;var R=null;var E=null;var H=null;var L=null;var s=new b();var q=new b();if(typeof l.smgPreviousExtremityY==="number"&&typeof l.smgThickness==="number"){l.smgExtremityY=l.smgPreviousExtremityY-l.smgThickness*0.5}var m=l.smgExtremityHead;var z=l.smgExtremityY;var A=-l.smgExtremityHead*l.smgExtremityX;if(l.smgExtremityHead!==undefined){P=new h(m);O=new h(m)}if(l.smgExtremityY!==undefined){R=new h(z);E=new h(z)}if(l.smgExtremityX!==undefined){H=new h(A);L=new h(A)}switch(l.smgExtremity){case g.START:s.SetValue(true);q.SetValue(false);break;case g.END:s.SetValue(false);q.SetValue(true);break;case g.BOTH:s.SetValue(true);q.SetValue(true);break;case g.NONE:s.SetValue(false);q.SetValue(false);break;default:break}if(r){u.set("Arrow.Head.ShowMode",s);u.set("Arrow.Head.2.ShowMode",q)}if(C){u.set("Arrow.Head.Length",P);u.set("Arrow.Head.2.Length",O)}if(B){u.set("Arrow.Head.Size",R);u.set("Arrow.Head.2.Size",E)}if(x){u.set("Arrow.Head.Shape",H);u.set("Arrow.Head.2.Shape",L)}}if(n){if(l.gradient){var J=new h(0);switch(l.smgExtremity){case g.START:u.set("Arrow.Body.2.Color.Opacity",J);u.set("Collab.Border.Line.2.Color.Opacity",J);break;case g.END:u.set("Arrow.Body.Color.Opacity",J);u.set("Collab.Border.Line.Color.Opacity",J);break;case g.BOTH:case g.NONE:break;default:break}}}return u}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableBomManager",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebProperties/VCXPropertyValueMap"],function(c,a,e){var b={"BOM.Sort.PropertyName":{name:"BOM.Sort.PropertyName",type:"VCXPropertyValueString"},"BOM.Filter":{name:"BOM.Filter",type:"VCXPropertyValueInt"},"BOM.Sort.Ascendant":{name:"BOM.Sort.Ascendant",type:"VCXPropertyValueBoolean"},"ColumnTreeList.ColumnList":{name:"ColumnTreeList.ColumnList",type:"VCXPropertyValueMap"},};var d=c.extend({getPropertiesDescription:function(){return UWA.extend({},b)},getPropertiesMap:function(g,t,A,q,y,u){var n=new Map();var o=a.getPropertiesDicoFromWebTypeWithInheritance("VCXComponentOccurrenceComposer");for(var k in A){if(!A.hasOwnProperty(k)){continue}var f=b[k];if(f){var w=A[k];var p=a.fillPropertyValue(w,f.type,t);switch(k){case"ColumnTreeList.ColumnList":var r=w.ColumnTree;for(var x=0;x<r.length;x++){var h=r[x];var l=new e();var j=0;for(var s in h){if(!h.hasOwnProperty(s)){continue}var z=h[s];switch(s){case"ColumnTree.Name":var i=a.fillPropertyValue(z,"VCXPropertyValueString");var m=i?i.GetValue():null;if(o&&o[m]){i.SetValue(o[m].name)}l.SetValueAtIndex(j,i);l._value[j++].name=s;break;case"ColumnTree.Width":var v=a.fillPropertyValue(z,"VCXPropertyValueInt");l.SetValueAtIndex(j,v);l._value[j++].name=s;break;case"ColumnTree.CommonRoot":var v=a.fillPropertyValue(z,"VCXPropertyValueInt");l.SetValueAtIndex(j,v);l._value[j++].name=s;break;case"ColumnTree.Label":var i=a.fillPropertyValue(z,"VCXPropertyValueString");l.SetValueAtIndex(j,i);l._value[j++].name=s;break;default:break}}p.SetValueAtIndex(x,l)}break;default:break}if(f.name&&p){n.set(f.name,p)}}}return n}});return d});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableMesh",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableOccurrence","DS/VCXWebKernelTools/VCXEnums"],function(c,a,d,g,e,f){var b={"Texture.Frame.Gen":{name:"Actor.Texture.Frame.Gen",type:"VCXPropertyValueFrame"},"Texture.Map.Path":{name:"Actor.Texture.Map.Path",type:"VCXPropertyValueDocId"},"Texture.Frame.2D":{name:"Actor.Texture.Frame.2D",type:"VCXPropertyValueFrame"},"Texture.Transparency":{name:"Actor.Texture.Transparency",type:"VCXPropertyValueBoolean"},"Texture.Blending.Mode":{name:"Actor.Texture.Blending.Mode",type:"VCXPropertyValueBoolean"},"Texture.Border.Mode":{name:"Actor.Texture.Border.Mode",type:"VCXPropertyValueBoolean"},"Texture.UV.Scale":{name:"Actor.Texture.UV.Scale",type:"VCXPropertyValueInt"},"Texture.UV.Ratio":{name:"Actor.Texture.UV.Ratio",type:"VCXPropertyValueInt"},"Actor.Env.Effect":{name:"Actor.Env.Effect",type:"VCXPropertyValueEnum"},"Actor.Pulse":{name:"Actor.Pulse.Period",type:"VCXPropertyValueEnum"},"Actor.Pulse.Color":{name:"Pulse.Actor.Color",type:"VCXPropertyValueColor"},"Actor.Prop.Area":{name:"Actor.Prop.Area",type:"VCXPropertyValueFloat"},"Actor.Prop.Volume":{name:"Actor.Prop.Volume",type:"VCXPropertyValueFloat"}};var h=e.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(j,p,x,w,q){var m=this._parent(j,p,x,w,q);for(var k in x){if(!x.hasOwnProperty(k)){continue}var i=b[k];if(i){var u=x[k];var n=a.fillPropertyValue(u,i.type,p);switch(k){case"Texture.Frame.Gen":if(u["@attributes"]!==undefined&&u["@attributes"].ProjectionMode!==undefined){var l=parseInt(u["@attributes"].ProjectionMode);var s=new d();switch(l){case 1:s.SetValue(f.TextureMapping.Planar);break;case 4:s.SetValue(f.TextureMapping.None);break;default:s.SetValue(f.TextureMapping.None);break}m.set("Actor.Texture.Projection.Type",s)}break;case"Texture.Map.Path":var A=-1;if(u["@attributes"]!==undefined&&u["@attributes"].Value!==undefined){var r=u["@attributes"].Value;var z=r.split("\\").pop().split("/").pop().toLowerCase();var o=w[z];if(undefined!==o){var y=p.getManager("VCXDocManager").BuildPathFromString(o,z);var t=p.getManager("VCXDocManager").AddOrModifyDoc(y);A=t.Value}}n.SetValue(A);break;case"Actor.Pulse":var s=new d();s.SetValue(0);m.set("Actor.Pulse.Type",s);if(n.GetValue()>0){n.SetValue(n.GetValue()-1);s.SetValue(1);var v=new g();v.SetValue(true);m.set("Actor.Pulse.PauseAnim",v)}break;default:break}if(i.name&&n){m.set(i.name,n)}}}return m}});return h});define("DS/VCXWebInteropSMG/VCXSmgGeomLoader",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils","DS/VCXWebInteropSMG/VCXSmgLoaderInflate","DS/VCXWebKernelTools/VCXMeshServices","DS/VCXWebKernelTools/VCXLogServices","DS/VCXWebKernel/VCXDRMManager"],function(c,Q,U,o,n,D,W,O){var t=1;var M=1;var J=2;var z=1;var a=2;var y=4;var B=4;var f=4;var x=4;var m=4;var k=8;var g=97;var L=98;var p=99;var v=100;var w=98;var R=117;var h=118;var d=1;var u=2;var e=3;var i=4;var V={NONE:0,ENVIRONMENT:1,IMPLICIT:2};var j={DECAL:8449,REPLACE:7681,MODULATE:8448,ADD:260,BLEND:3042,COMBINE:34160,EMBM:34683};var T={REPEAT:0,CLAMP:1,CLAMP_TO_EDGE:2,CLAMP_TO_BORDER:3};var I=97;var s=98;var G=99;var F=100;var N=101;var H=102;var q=122;var S=71;var E=66;var K=83;var C=70;var A=0;var b=1;var l=2;var P={OFF:0,OVERALL:1,PER_PRIM:2,PER_VERTEX:3};var r=c.extend({init:function(X){this._geoms=new Map();this._experienceBase=X;this._materialManager=this._experienceBase?this._experienceBase.getManager("VCXMaterialManager"):null;this.resources=null;this.outlines=null;this.alwaysBuildIndexedTrianglesSets=true;this.alwaysBuildIndexedLinesSets=true;this.ignoreGeodeMatrix=true;this.mergeGeosets=true;this.positionInBuffer=0;this.bufferSize=0;this.version=0;this.strFileNameAssociate="";this.checksum=0;this.ulOptionsPro=[];this.ulWatermark=[];this.ulHasExpirationDate=[];this.ulStartDate=[];this.ulEndDate=[];this.ulIsRelativeExpirationDate=[];this.bHasNormals=false;this.cCodage=v;this.ulHasSignature=0;this.strSignaturePicturePath="";this.strAgreement="";this.ulAgreementMode=0;this.ulSignatureCRC=[];this.bHasTexture=false;this.nTriangles=0},openZStream:function(ae){if(ae.length<=10){console.log("smgGeom : Invalid bytes");return}if(ae instanceof Uint8Array){var ah=ae[0];if(ah!==31){return}var ag=ae[1];if(ag!==139){return}}else{var ah=ae.charCodeAt(0);if(ah!==31){return}var ag=ae.charCodeAt(1);if(ag!==139){return}}var X=10;var aa=new Uint8Array(ae.length-X);if(ae instanceof Uint8Array){for(var Z=0;Z<ae.length-X;Z++){aa[Z]=ae[Z+X]}}else{for(var Z=0;Z<ae.length-X;Z++){aa[Z]=ae.charCodeAt(Z+X)}}var ac=new n();var af=ac.Inflate(aa);var Y=new ArrayBuffer(af.length);var ad=new Uint8Array(Y);for(var Z=0;Z<af.length;Z++){ad[Z]=af[Z]}var ab=new DataView(Y);this.positionInBuffer=0;this.bufferSize=ab.byteLength;return ab},setIgnoreGeodeMatrix:function(X){this.ignoreGeodeMatrix=X},setResources:function(X){if(X!==undefined){this.resources=X}},setOutlines:function(X){if(X!==undefined){this.outlines=X}},getMapGeodes:function(){return this._geoms},getBool:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getInt8(this.positionInBuffer)!==0;this.positionInBuffer+=t;return X},getChar:function(X){if(this.positionInBuffer>=this.bufferSize){return undefined}var Y=X.getInt8(this.positionInBuffer);this.positionInBuffer+=t;return Y},getWChar:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getInt16(this.positionInBuffer,true);this.positionInBuffer+=J;return X},getWString:function(Y){var Z="";var X=0;var aa=this.getWChar(Y);while(aa!==0&&aa!==10&&aa!==undefined){Z+=String.fromCharCode(aa);aa=this.getWChar(Y)}X=2*Z.length;return{value:Z,byteSize:X}},getString:function(Y){var Z="";var X=0;if(this.version<6.7){var aa=this.getChar(Y);while(aa!==0&&aa!==10&&aa!==undefined){Z+=String.fromCharCode(aa);aa=this.getChar(Y)}X=Z.length}else{var aa=this.getWChar(Y);while(aa!==0&&aa!==10&&aa!==undefined){Z+=String.fromCharCode(aa);aa=this.getWChar(Y)}X=2*Z.length}return{value:Z,byteSize:X}},getUnsignedChar:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getUint8(this.positionInBuffer);this.positionInBuffer+=M;return X},getCharArray:function(aa,Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var Z=new Int8Array(Y);for(var X=0;X<Y;X++){var ab=aa.getInt8(this.positionInBuffer);this.positionInBuffer+=t;Z[X]=ab}return Z},getUnsignedInt8Array:function(aa,Z){if(this.positionInBuffer>=this.bufferSize){return undefined}var ab=new Uint8Array(Z);for(var Y=0;Y<Z;Y++){var X=aa.getUint8(this.positionInBuffer);this.positionInBuffer+=z;ab[Y]=X}return ab},getUnsignedInt16Array:function(aa,Z){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=new Uint16Array(Z);for(var Y=0;Y<Z;Y++){var ab=aa.getUint16(this.positionInBuffer,true);this.positionInBuffer+=a;X[Y]=ab}return X},getDouble:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getFloat64(this.positionInBuffer,true);this.positionInBuffer+=k;return X},getFloat:function(X){if(this.positionInBuffer>=this.bufferSize){return undefined}var Y=X.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m;return Y},getLong:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getInt32(this.positionInBuffer,true);this.positionInBuffer+=f;return X},getUnsignedInt:function(Y){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=Y.getUint32(this.positionInBuffer,true);this.positionInBuffer+=B;return X},getUnsignedLong:function(X){if(this.positionInBuffer>=this.bufferSize){return undefined}var Y=X.getUint32(this.positionInBuffer,true);this.positionInBuffer+=x;return Y},getUnsignedIntArray:function(ab,Z){if(this.positionInBuffer>=this.bufferSize){return undefined}var aa=new Uint32Array(Z);for(var Y=0;Y<Z;Y++){var X=ab.getUint32(this.positionInBuffer,true);this.positionInBuffer+=B;aa[Y]=X}return aa},getUnsignedLongArray:function(aa,Z){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=new Uint32Array(Z);for(var Y=0;Y<Z;Y++){var ab=aa.getUint32(this.positionInBuffer,true);this.positionInBuffer+=x;X[Y]=ab}return X},getFloatArray:function(aa,Z){if(this.positionInBuffer>=this.bufferSize){return undefined}var X=new Float32Array(Z);for(var Y=0;Y<Z;Y++){var ab=aa.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m;X[Y]=ab}return X},ReadMat:function(Z){var Y=this.getFloatArray(Z,16);var X=new Q.Matrix4();X.set(Y[0],Y[4],Y[8],Y[12],Y[1],Y[5],Y[9],Y[13],Y[2],Y[6],Y[10],Y[14],0,0,0,1);return X},ReadMatrix:function(aa){var Z=this.getChar(aa);if(Z===undefined||!Z){return false}var Y=this.getFloatArray(aa,16);var X=new Q.Matrix4();X.set(Y[0],Y[4],Y[8],Y[12],Y[1],Y[5],Y[9],Y[13],Y[2],Y[6],Y[10],Y[14],0,0,0,1);return{hasTransfo:Z,matrix:X}},DecodeFloat8:function(Y,aa,X){var Z=(1<<8)-1;return Y*(1-(X/Z))+(aa*(X/Z))},DecodeFloat16:function(Y,aa,X){var Z=(1<<16)-1;return Y*(1-(X/Z))+(aa*(X/Z))},ReadTabSglVec2f:function(ae,ac,Y){var ad=2;var ag=this.getChar(ae);if(ag===g){var ab=this.getFloatArray(ae,ad*ac);for(var aa=0;aa<ac;aa++){var X=aa*ad;var aj=ab[X++];var ah=ab[X++];Y[2*aa]=aj;Y[(2*aa)+1]=ah}return}var ai=this.getFloat(ae);var Z=this.getFloat(ae);var af=this.getFloat(ae);var ak=this.getFloat(ae);if(ag===L){var ab=this.getUnsignedInt16Array(ae,ac*ad);for(var aa=0;aa<ac;aa++){var X=aa*ad;var aj=this.DecodeFloat16(ai,Z,ab[X++]);var ah=this.DecodeFloat16(af,ak,ab[X++]);Y[2*aa]=aj;Y[(2*aa)+1]=ah}}else{if(ag===p){var ab=this.getUnsignedInt8Array(ae,ac*ad);for(var aa=0;aa<ac;aa++){var X=aa*ad;var aj=this.DecodeFloat8(ai,Z,ab[X++]);var ah=this.DecodeFloat8(af,ak,ab[X++]);Y[2*aa]=aj;Y[(2*aa)+1]=ah}}}},GetTabVector8Direct:function(ai,ab,ak,al,aj,ag,ac,aa,Y,X,ae,am,Z,ah,an){var af=0;if(!al&&!aj&&!ag){for(var ad=0;ad<ab;ad++){ak[af++]=this.DecodeFloat8(X,ae,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z;ak[af++]=this.DecodeFloat8(am,Z,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z;ak[af++]=this.DecodeFloat8(ah,an,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z}}else{for(var ad=0;ad<ab;ad++){if(al){ak[af++]=ac}else{ak[af++]=this.DecodeFloat8(X,ae,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z}if(aj){ak[af++]=aa}else{ak[af++]=this.DecodeFloat8(am,Z,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z}if(ag){ak[af++]=Y}else{ak[af++]=this.DecodeFloat8(ah,an,ai.getUint8(this.positionInBuffer,true));this.positionInBuffer+=z}}}},GetTabVector8:function(ak,an,ae,ag,aq,al,ac,ab,Z,ao,ap,X,Y,aa,ad){var ar=0;if(!ag){ar++}if(!aq){ar++}if(!al){ar++}for(var am=0;am<an;am++){var aj=0,ai=0,ah=0;var af=am*ar;if(ag){aj=ac}else{aj=this.DecodeFloat8(ao,ap,ak[af++])}if(aq){ai=ab}else{ai=this.DecodeFloat8(X,Y,ak[af++])}if(al){ah=Z}else{ah=this.DecodeFloat8(aa,ad,ak[af++])}ae[3*am]=aj;ae[(3*am)+1]=ai;ae[(3*am)+2]=ah}},GetTabVector16Direct:function(ai,ab,ak,al,aj,ag,ac,aa,Y,X,ae,am,Z,ah,an){var af=0;if(!al&&!aj&&!ag){for(var ad=0;ad<ab;ad++){ak[af++]=this.DecodeFloat16(X,ae,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a;ak[af++]=this.DecodeFloat16(am,Z,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a;ak[af++]=this.DecodeFloat16(ah,an,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a}}else{for(var ad=0;ad<ab;ad++){if(al){ak[af++]=ac}else{ak[af++]=this.DecodeFloat16(X,ae,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a}if(aj){ak[af++]=aa}else{ak[af++]=this.DecodeFloat16(am,Z,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a}if(ag){ak[af++]=Y}else{ak[af++]=this.DecodeFloat16(ah,an,ai.getUint16(this.positionInBuffer,true));this.positionInBuffer+=a}}}},GetTabVector16:function(ak,an,ae,ag,aq,al,ac,ab,Z,ao,ap,X,Y,aa,ad){var ar=0;if(!ag){ar++}if(!aq){ar++}if(!al){ar++}for(var am=0;am<an;am++){var aj=0,ai=0,ah=0;var af=am*ar;if(ag){aj=ac}else{aj=this.DecodeFloat16(ao,ap,ak[af++])}if(aq){ai=ab}else{ai=this.DecodeFloat16(X,Y,ak[af++])}if(al){ah=Z}else{ah=this.DecodeFloat16(aa,ad,ak[af++])}ae[3*am]=aj;ae[(3*am)+1]=ai;ae[(3*am)+2]=ah}},GetTabVector32Direct:function(ae,Z,ag,ah,af,ad,aa,Y,X){var ac=0;if(!ah&&!af&&!ad){for(var ab=0;ab<Z;ab++){ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m;ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m;ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m}}else{for(var ab=0;ab<Z;ab++){if(ah){ag[ac++]=aa}else{ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m}if(af){ag[ac++]=Y}else{ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m}if(ad){ag[ac++]=X}else{ag[ac++]=ae.getFloat32(this.positionInBuffer,true);this.positionInBuffer+=m}}}},GetTabVector32:function(ad,aa,ai,ak,ag,af,ab,Z,Y){var ae=0;if(!ak){ae++}if(!ag){ae++}if(!af){ae++}for(var ac=0;ac<aa;ac++){var al=0,aj=0,ah=0;var X=ac*ae;if(ak){al=ab}else{al=ad[X++]}if(ag){aj=Z}else{aj=ad[X++]}if(af){ah=Y}else{ah=ad[X++]}ai[3*ac]=al;ai[(3*ac)+1]=aj;ai[(3*ac)+2]=ah}},ReadIndex:function(ac,ab,Z){if(Z<(1<<8)){var Y=this.getUnsignedInt8Array(ac,ab);var aa=new Uint16Array(Y.length);for(var X=0;X<Y.length;++X){aa[X]=Y[X]}return aa}if(Z<(1<<16)){return this.getUnsignedInt16Array(ac,ab)}return this.getUnsignedIntArray(ac,ab)},ReadTabSglVec3f:function(ae,Z,ai){var ag=this.getChar(ae);var ab=3;var ak=this.getBool(ae);var af=this.getBool(ae);var ac=this.getBool(ae);var al=0,aj=0,ah=0;if(ak){ab--;al=this.getFloat(ae)}if(af){aj=this.getFloat(ae);ab--}if(ac){ah=this.getFloat(ae);ab--}if(ag===g){this.GetTabVector32Direct(ae,Z,ai,ak,af,ac,al,aj,ah);return}var X=0,aa=0,am=0,Y=0,ad=0,an=0;if(!ak){X=this.getFloat(ae);aa=this.getFloat(ae)}if(!af){am=this.getFloat(ae);Y=this.getFloat(ae)}if(!ac){ad=this.getFloat(ae);an=this.getFloat(ae)}if(ag===L){this.GetTabVector16Direct(ae,Z,ai,ak,af,ac,al,aj,ah,X,aa,am,Y,ad,an)}else{if(ag===p){this.GetTabVector8Direct(ae,Z,ai,ak,af,ac,al,aj,ah,X,aa,am,Y,ad,an)}}},ReadTriangleSet:function(ac,ag,Y,af){var ae=this.getUnsignedInt(ac);var Z=ae*3;var X=new Float32Array(Z*3);this.ReadTabSglVec3f(ac,Z,X);var aa=this.getUnsignedInt(ac);var ah=null;if(aa!==P.OFF){ah=new Float32Array(Z*3);this.ReadTabSglVec3f(ac,Z,ah)}if(this.version>=6.8){var ai=this.getUnsignedInt(ac)}var ad=D.allocIndexationArray(Z,Z);for(var ab=0;ab<Z;ab++){ad[ab]=ab}if(!ah){ah=D.computeSmoothNormalsTrianglesSet(X,ad)}this.nTriangles+=ae;return{meshType:o.ConnectivityTypeEnum.TRIANGLES,nTriangles:ae,vertexArray:X,normalsArray:ah,uvArray:null,vertexIndexArray:ad,normalsIndexArray:ad,uvIndexArray:null,uniqueIndexation:true,colorRGBA:new o.Color(ag[0],ag[1],ag[2],Y),material:this._materialManager.getMaterialPhong(new Q.Color().setRGB(ag[0],ag[1],ag[2]),Y,null)}},ReadIndexedTriangleSet:function(X,aE,ay,af){var al=this.getUnsignedInt(X);var ae=this.getUnsignedInt(X);var ac=this.getUnsignedInt(X);var ag=new Float32Array(ae*3);this.ReadTabSglVec3f(X,ae,ag);var aa=this.ReadIndex(X,ac,ae);var ak=this.getUnsignedInt(X);var ab=null;var aF=null;var aG=0;if(ak!==P.OFF){aG=this.getUnsignedInt(X);var ab=new Float32Array(aG*3);this.ReadTabSglVec3f(X,aG,ab);aF=this.ReadIndex(X,ac,aG)}else{aG=ae;ab=D.computeSmoothNormalsTrianglesSet(ag,aa);aF=aa}var ap=[];var aH=null;var aB=[];if(this.version>=6.8){var aq=this.getUnsignedInt(X);if(aq){var au=this.getUnsignedInt(X);for(var aC=0;aC<aq;++aC){var ar=this.getUnsignedInt(X);if(ar===P.PER_VERTEX){var az=new Float32Array(2*ae);this.ReadTabSglVec2f(X,ae,az);ap.push(az)}}var aH=this.ReadIndex(X,ac,au);if(ap.length){aB=af}}}if(ae!==aG){console.warn("Indexed triangles set geometry should use the same indexation buffer for vertices and normals");var ad=3*al;var am=new Float32Array(3*ad);var Y=new Float32Array(3*ad);var ax=ad<(1<<16)?new Uint16Array(ad):new Uint32Array(ad);var an=[];var aA=0;for(var Z=0;Z<ad;++Z){var aD=3*aa[Z];var aw=ag[aD];var av=ag[aD+1];var at=ag[aD+2];aD=3*aF[Z];var aj=ab[aD];var ai=ab[aD+1];var ah=ab[aD+2];am[aA]=aw;am[aA+1]=av;am[aA+2]=at;Y[aA]=aj;Y[aA+1]=ai;Y[aA+2]=ah;aA+=3;ax[Z]=Z}ag=am;ab=Y;aa=ax;aF=ax}var ao=(this.resources&&this.resources.length)?this.resources[af[0]]:null;this.nTriangles+=al;return{meshType:o.ConnectivityTypeEnum.TRIANGLES,nTriangles:al,vertexArray:ag,normalsArray:ab,uvArray:(ap.length?ap[0]:null),vertexIndexArray:aa,normalsIndexArray:aF,uvIndexArray:(ap.length?aH:null),uniqueIndexation:false,colorRGBA:new o.Color(aE[0],aE[1],aE[2],ay),material:this._materialManager.getMaterialPhong(new Q.Color().setRGB(aE[0],aE[1],aE[2]),ay,ap.length?ao:null)}},ReadIndexedTriangleStripSet:function(aA,au,ax,ac){var av=this.getUnsignedInt(aA);var Y=this.getUnsignedInt(aA);var af=this.getUnsignedInt(aA);var aa=this.getUnsignedInt(aA);var ag=new Float32Array(Y*3);this.ReadTabSglVec3f(aA,Y,ag);var ae=this.ReadIndex(aA,af,Y);var ah=null;var am=null;var ad=0;var ay=this.getUnsignedInt(aA);if(ay!==P.OFF){ad=this.getUnsignedInt(aA);var ah=new Float32Array(ad*3);this.ReadTabSglVec3f(aA,ad,ah);am=this.ReadIndex(aA,af,ad)}var Z=this.ReadIndex(aA,av,aa);var ak=0;for(var ai=0;ai<av;ai++){ak+=Z[ai]-2}if(ay!==P.OFF){}else{ad=Y;ah=D.computeSmoothNormalsStripSet(ag,ae,Z);am=ae}if(this.version>=6.8){var at=this.getUnsignedInt(aA)}console.warn("[VCXSmgGeomLoader] : Geometry read from smgGeom should use the same indexation buffer for vertices and normals, convert to mono-indexation");Y=ak*3;var ab=D.allocIndexationArray(Y,Y);for(var aq=0;aq<Y;aq++){ab[aq]=aq}var aw=new Float32Array(Y*3);var X=new Float32Array(Y*3);var aj=0;var az=0;var ar=0;for(var ap=0;ap<av;++ap){var an=Z[ap];for(var aq=0;aq<an-2;++aq){var al=3*ae[az+aq];var ao=3*am[az+aq];aw[aj]=ag[al];aw[aj+1]=ag[al+1];aw[aj+2]=ag[al+2];X[aj]=ah[ao];X[aj+1]=ah[ao+1];X[aj+2]=ah[ao+2];aj+=3;if(aq&1){al=3*ae[az+aq+2];ao=3*am[az+aq+2];aw[aj]=ag[al];aw[aj+1]=ag[al+1];aw[aj+2]=ag[al+2];X[aj]=ah[ao];X[aj+1]=ah[ao+1];X[aj+2]=ah[ao+2];aj+=3;al=3*ae[az+aq+1];ao=3*am[az+aq+1];aw[aj]=ag[al];aw[aj+1]=ag[al+1];aw[aj+2]=ag[al+2];X[aj]=ah[ao];X[aj+1]=ah[ao+1];X[aj+2]=ah[ao+2];aj+=3}else{al=3*ae[az+aq+1];ao=3*am[az+aq+1];aw[aj]=ag[al];aw[aj+1]=ag[al+1];aw[aj+2]=ag[al+2];X[aj]=ah[ao];X[aj+1]=ah[ao+1];X[aj+2]=ah[ao+2];aj+=3;al=3*ae[az+aq+2];ao=3*am[az+aq+2];aw[aj]=ag[al];aw[aj+1]=ag[al+1];aw[aj+2]=ag[al+2];X[aj]=ah[ao];X[aj+1]=ah[ao+1];X[aj+2]=ah[ao+2];aj+=3}ar++}az+=an}this.nTriangles+=ar;return{meshType:o.ConnectivityTypeEnum.TRIANGLES,nTriangles:ar,vertexArray:aw,normalsArray:X,uvArray:null,vertexIndexArray:ab,normalsIndexArray:ab,uvIndexArray:null,uniqueIndexation:true,colorRGBA:new o.Color(au[0],au[1],au[2],ax),material:this._materialManager.getMaterialPhong(new Q.Color().setRGB(au[0],au[1],au[2]),ax,null)}},ReadMonoIndexedTriangleStripSet:function(au,am,ap,ac){var an=this.getUnsignedInt(au);var X=this.getUnsignedInt(au);var ad=this.getUnsignedInt(au);var aa=this.getUnsignedInt(au);var af=new Float32Array(X*3);this.ReadTabSglVec3f(au,X,af);var aq=this.getUnsignedInt(au);var ag=null;if(aq!==P.OFF){var ag=new Float32Array(X*3);this.ReadTabSglVec3f(au,X,ag)}var ae=this.ReadIndex(au,ad,X);var Y=this.ReadIndex(au,an,aa);var ai=0;for(var ah=0;ah<an;ah++){ai+=Y[ah]-2}if(aq===P.OFF){ag=D.computeSmoothNormalsStripSet(af,ae,Y)}var ao=false;if(ao){}else{}var ak=[];var ar=[];if(this.version>=6.8){var al=this.getUnsignedInt(au);if(al&&al>=0&&al<=2){for(var at=0;at<al;++at){var ab=this.getUnsignedInt(au);if(ab===P.PER_VERTEX){var Z=new Float32Array(2*X);this.ReadTabSglVec2f(au,X,Z);ak.push(Z)}}if(ak.length){ar=ac}}}var aj=(this.resources&&this.resources.length)?this.resources[ac[0]]:null;this.nTriangles+=ai;return{meshType:o.ConnectivityTypeEnum.TRIANGLE_STRIP,nStrips:an,vertexArray:af,normalsArray:ag,uvArray:(ak.length?ak[0]:null),vertexIndexArray:ae,normalsIndexArray:ae,uvIndexArray:ak.length?ae:null,uniqueIndexation:true,lengthsArray:Y,colorRGBA:new o.Color(am[0],am[1],am[2],ap),material:this._materialManager.getMaterialPhong(new Q.Color().setRGB(am[0],am[1],am[2]),ap,ak.length?aj:null)}},ReadLineStripSet:function(af,ai,Z,aj){var ae=this.getFloat(af);var ac=this.getUnsignedInt(af);var ab=this.getUnsignedInt(af);var ad=this.getUnsignedInt(af);var Y=new Float32Array(ab*3);this.ReadTabSglVec3f(af,ab,Y);var X=this.ReadIndex(af,ac,ad);var ah=0;for(var aa=0;aa<X.length;++aa){ah+=X[aa]}var ag=D.allocIndexationArray(ah,ah);for(var aa=0;aa<ah;aa++){ag[aa]=aa}return{meshType:o.ConnectivityTypeEnum.LINE_STRIP,nStrips:X.length,vertexArray:Y,normalsArray:null,uvArray:null,lengthsArray:X,vertexIndexArray:ag,normalsIndexArray:null,uvIndexArray:null,uniqueIndexation:true,edgeType:aj,colorRGBA:new o.Color(ai[0],ai[1],ai[2],Z),thickness:1,material:null}},ReadPointSet:function(ab,ae,aa){var ad=this.getFloat(ab);var X=this.getUnsignedInt(ab);var ac=new Float32Array(X*3);this.ReadTabSglVec3f(ab,X,ac);var Z=D.allocIndexationArray(ac.size,ac.size);for(var Y=0;Y<ac.size;Y++){Z[Y]=Y}return{meshType:o.ConnectivityTypeEnum.POINTS,nStrips:X,vertexArray:ac,normalsArray:null,uvArray:null,lengthsArray:null,vertexIndexArray:Z,normalsIndexArray:null,uvIndexArray:null,uniqueIndexation:true,colorRGBA:new o.Color(ae[0],ae[1],ae[2],aa),thickness:1,material:null}},ReadGeodeUserData:function(ae){var Z={strId:"",idLayer:-1,strAssemblyName:"",strIssuedFrom:"",volume:-1,area:-1,ucGeometryType:0,fCofG:[],fInertiaAxes:[]};if(this.version<1.1){return Z}var ab=J;if(this.version<6.7){ab=t}var X=this.getUnsignedInt(ae);var aa=0;if(X>aa){var af=this.getString(ae);Z.strId=af.value;if(this.version<6.7&&af.byteSize>0){aa+=af.byteSize*ab+ab}else{aa+=Z.strId.length*ab+ab}}else{Z.strId="-1"}if(X>aa){Z.idLayer=this.getLong(ae);aa+=f}if(X>aa){var af=this.getString(ae);Z.strAssemblyName=af.value;if(this.version<6.7&&af.byteSize>0){aa+=af.byteSize*ab+ab}else{aa+=Z.strAssemblyName.length*ab+ab}}if(X>aa){Z.volume=this.getFloat(ae);aa+=m}if(X>aa){Z.area=this.getFloat(ae);aa+=m}if(X>aa){Z.fCofG=this.getFloatArray(ae,3);aa+=(3*m)}if(X>aa){Z.fInertiaAxes=this.getFloatArray(ae,9);aa+=(9*m)}if(X>aa){Z.ucGeometryType=this.getUnsignedChar(ae);aa+=M}if(X>aa){var af=this.getString(ae);Z.strIssuedFrom=af.value;if(this.version<6.7&&af.byteSize>0){aa+=af.byteSize*ab+ab}else{aa+=Z.strIssuedFrom.length*ab+ab}}var Y=1;if(X>aa){Y=this.getUnsignedInt(ae);aa+=B}var ac=X-aa;if(ac>0){var ad=this.getCharArray(ae,ac)}return{userdata:Z,nbLOD:Y}},ReadFace:function(Z,av,al){var ad=this.getString(Z).value;var aa=-1;if(this.version>=0.8&&this.version<0.9){var au=this.getLong(Z);aa=au.ToString()}else{aa=this.getString(Z).value}var X=this.getFloatArray(Z,3);var ax=this.getFloatArray(Z,3);var ay=this.getFloatArray(Z,3);var ac=this.getFloat(Z);var aB=this.getFloat(Z);var ah=0;var af=[];var aA=[];var an=[];var aq=[];var ab=[];var aG=[];var ae=[];if(this.version>=6.8){var aD=0;var ao=this.getUnsignedInt(Z);if(ao>aD){ah=this.getUnsignedInt(Z);aD+=B}if(ah<=2){for(var aC=0;aC<ah;aC++){var am;if(ao>aD){var at=this.getString(Z);am=at.value;aD+=(am.length*J)+J}af.push(am.replace(/^.*[\\\/]/,""))}for(var aC=0;aC<ah;aC++){var ap=new Q.Matrix4();if(ao>aD){ap=this.ReadMat(Z);aD+=(16*m)}aA.push(ap)}for(var aC=0;aC<ah;aC++){var aj=V.NONE;if(ao>aD){aj=this.getChar(Z);aD+=t}an.push(aj)}for(var aC=0;aC<ah;aC++){var aE=false;if(ao>aD){aE=this.getChar(Z);aD+=t}aq.push(aE!==0)}for(var aC=0;aC<ah;aC++){var ak=j.MODULATE;if(ao>aD){ak=this.getUnsignedInt(Z);aD+=B}var ar=(ak===j.DECAL);ar=ar||(ak===j.REPLACE);ar=ar||(ak===j.MODULATE);ar=ar||(ak===j.ADD);ar=ar||(ak===j.BLEND);ar=ar||(ak===j.COMBINE);ar=ar||(ak===j.EMBM);ab.push(ar?ak:j.MODULATE)}for(var aC=0;aC<ah;aC++){var aF=T.REPEAT;if(ao>aD){aF=this.getChar(Z);aD+=t}aG.push(aF)}for(var aC=0;aC<ah;aC++){var Y=false;if(ao>aD){Y=this.getChar(Z);aD+=t}ae.push(Y!==0)}if(aD>=ao){}}else{}var aw=ao-aD;if(aw>0){var az=this.getCharArray(Z,aw)}}var ai=null;var aH=this.getChar(Z);switch(aH){case I:ai=this.ReadTriangleSet(Z,X,aB,af);break;case s:ai=this.ReadIndexedTriangleSet(Z,X,aB,af);break;case G:ai=this.ReadIndexedTriangleStripSet(Z,X,aB,af);break;case F:ai=this.ReadMonoIndexedTriangleStripSet(Z,X,aB,af);break;case N:ai=this.ReadLineStripSet(Z,X,aB,"WIRE_EDGE");break;case H:ai=this.ReadPointSet(Z,X,aB);break;default:console.log("smgGeom loading : Unknown geometry type");break}if(ai){if(aH!==H){}}if(ai.meshType===o.ConnectivityTypeEnum.TRIANGLE_STRIP&&this.alwaysBuildIndexedTrianglesSets){if(ai.normalsIndexArray&&ai.normalsIndexArray.length!==ai.vertexIndexArray.length){console.error("Normals : Should be always mono - indexed")}if(ai.uvIndexArray&&ai.uvIndexArray.length!==ai.vertexIndexArray.length){console.error("(u, v) : Should be always mono - indexed")}var ag=D.buildIndexationFromStripSet(ai.meshType,ai.nStrips,ai.vertexIndexArray,ai.lengthsArray,ai.vertexArray);if(ag){ai.meshType=o.ConnectivityTypeEnum.TRIANGLES;ai.vertexIndexArray=ai.vertexIndexArray?ag:null;ai.normalsIndexArray=ai.normalsIndexArray?ag:null;ai.uvIndexArray=ai.uvIndexArray?ag:null}}else{if(ai.meshType===o.ConnectivityTypeEnum.LINE_STRIP&&this.alwaysBuildIndexedLinesSets){var ag=D.buildIndexationFromStripSet(ai.meshType,ai.nStrips,ai.vertexIndexArray,ai.lengthsArray,ai.vertexArray);if(ag){ai.meshType=o.ConnectivityTypeEnum.LINES;ai.vertexIndexArray=ai.vertexIndexArray?ag:null}}}return ai},BuildMeshNode:function(Y){var X=null;switch(Y.meshType){case o.ConnectivityTypeEnum.TRIANGLES:X=D.buildIndexedTriangleSet(Y.nbTriangles,Y.vertexArray,Y.normalsArray,Y.uvArray,Y.vertexIndexArray,Y.normalsIndexArray,Y.uvIndexArray,Y.colorRGBA,Y.material,Y.isSolid);break;case o.ConnectivityTypeEnum.TRIANGLE_STRIP:if(this.alwaysBuildIndexedTrianglesSets){console.log("Unexpected TRIANGLE_STRIP type")}X=D.buildMonoIndexedTriangleStripSet(Y.nStrips,Y.vertexArray,Y.normalsArray,Y.uvArray,Y.vertexIndexArray,Y.lengthsArray,Y.colorRGBA,Y.material,Y.isSolid);break;case o.ConnectivityTypeEnum.LINES:X=D.buildIndexedLineSet(Y.vertexArray,Y.vertexIndexArray,Y.colorRGBA,Y.thickness,Y.edgeType,Y.material);break;case o.ConnectivityTypeEnum.LINE_STRIP:if(this.alwaysBuildIndexedLinesSets){console.log("Unexpected LINE_STRIP type")}X=D.buildLineStripSet(Y.vertexArray,Y.lengthsArray,Y.vertexIndexArray,Y.colorRGBA,Y.thickness,Y.edgeType,Y.material);break;case o.ConnectivityTypeEnum.POINTS:X=D.buildPointSet(Y.vertexArray,Y.vertexIndexArray,Y.material);break;case o.ConnectivityTypeEnum.DUMMY:console.log("smgGeom loading : Mesh with 0 triangles");break;default:console.error("smgGeom loading : Unknown geometry type");break}return X},ReadGeode:function(ax){var ae=new U();var aw=this.ReadMatrix(ax);var ar=aw.hasTransfo;var X=aw.matrix;var af=this.getString(ax).value;var Y=this.ReadGeodeUserData(ax);var ai=Y.userdata;var aa=d;var ag=0;var at=Y.nbLOD;if(at>1&&aa!==d){if(aa===i){ag=0}else{if(aa===u){ag=at-1}else{ag=at/2}}}var ao=[];var aj=0;for(var ap=0;ap<at;ap++){var am=this.getUnsignedInt(ax);if(ap===0){for(var ah=0;ah<am;ah++){ao[ah]=-1}aj=am}var ab=[];for(var al=0;al<am;al++){var Z=this.getChar(ax);if(Z!==h){console.log("smgGeom loading : Unknown geometry identifier value");break}if(at>1){}else{var av=this.ReadFace(ax,0,-1);if(null===av||undefined===av){break}av.isSolid=(ai&&ai.ucGeometryType===b);var au=null;if(this.mergeGeosets===true){ab[ab.length]=av}else{au=this.BuildMeshNode(av);if(au){au.setPickParent(true);ae.add(au)}else{console.error("smgGeom loading : failed to convert geometry")}}av=null}}if(this.outlines!==null){var ak=this.outlines.get(ai.strId);if(ak!==null&&ak!==undefined){if(this.mergeGeosets===true){if(ak.broken){for(var an=0;an<ak.broken.length;++an){ab.push(ak.broken[an])}}if(ak.construction){for(var ad=0;ad<ak.construction.length;++ad){ab.push(ak.construction[ad])}}if(ak.smart){for(var ac=0;ac<ak.smart.length;++ac){ab.push(ak.smart[ac])}}}else{if(ak.broken){for(var an=0;an<ak.broken.length;++an){var aq=this.BuildMeshNode(ak.broken[an]);aq.setPickParent(true);ae.add(aq)}}if(ak.construction){for(var ad=0;ad<ak.construction.length;++ad){var aq=this.BuildMeshNode(ak.construction[ad]);aq.setPickParent(true);ae.add(aq)}}if(ak.smart){for(var ac=0;ac<ak.smart.length;++ac){var aq=this.BuildMeshNode(ak.smart[ac]);aq.setPickParent(true);ae.add(aq)}}}}}if(this.mergeGeosets===true){ae=D.mergeGeosets(ab);ab=null}}if(ar&&!this.ignoreGeodeMatrix&&ae){ae.setMatrix(X)}return{userdata:ai,matrix:X,name:af,geode:ae}},LoadGeometries:function(af){var ac=this.openZStream(af);this.version=this.getDouble(ac);this.strFileNameAssociate=this.getString(ac).value;this.checksum=this.getLong(ac);var X=this.getUnsignedInt(ac);var Y=0;if(this.version<1.2){return}var Z=J;if(this.version<6.7){Z=t}if(X>Y){this.ulOptionsPro=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.ulWatermark=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.ulHasExpirationDate=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.ulStartDate=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.ulEndDate=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.ulIsRelativeExpirationDate=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.bHasNormals=this.getChar(ac);Y+=t}else{this.bHasNormals=true}if(X>Y){this.cCodage=this.getChar(ac);Y+=t}else{this.cCodage=v}if(X>Y){this.ulHasSignature=this.getUnsignedLong(ac);Y+=x}if(X>Y){var ae=this.getString(ac);this.strSignaturePicturePath=ae.value;if(this.version<6.7&&ae.byteSize>0){Y+=ae.byteSize*Z}else{Y+=this.strSignaturePicturePath.length*Z}}if(X>Y){var ae=this.getString(ac);this.strAgreement=ae.value;if(this.version<6.7&&ae.byteSize>0){Y+=ae.byteSize*Z}else{Y+=this.strAgreement.length*Z}}if(X>Y){this.ulAgreementMode=this.getUnsignedLong(ac);Y+=x}if(X>Y){this.ulSignatureCRC=this.getUnsignedLongArray(ac,2);Y+=2*x}if(X>Y){this.bHasTexture=this.getChar(ac);Y+=t}else{this.bHasTexture=false}var aa=X-Y;if(aa>0){var ab=this.getCharArray(ac,aa)}var ad=this._experienceBase.getManager("VCXGUIManager").getGUIServices();if(this.ulHasSignature&&this.ulAgreementMode!==O.LitSignatureMode.LIT_SIGNATURE_NO_DISPLAY){ad.displaySignature(this._experienceBase,this,ac)}else{this.LoadGeometriesBody(ac)}},LoadGeometriesBody:function(Y){while(1){var X=this.getChar(Y);if(X===undefined){break}if(X===h){}if(X===R){var Z=this.ReadGeode(Y);this._geoms.set(Z.userdata.strId,Z)}}},LoadOutlines:function(ak){var ae=this.openZStream(ak);var ad=new Map();var X=this.getUnsignedInt(ae);var af=this.getDouble(ae);this.version=6.8;while(1){var ai=this.getChar(ae);if(ai===S){var Y={broken:[],construction:[],smart:[]};var ah=this.getWString(ae);var aj=this.getUnsignedInt(ae);for(var Z=0;Z<aj;++Z){var ac=this.getChar(ae);var ab=this.getChar(ae);var ag=this.ReadLineStripSet(ae,[0,0,0],1,"SHARP_EDGE");if(ag.meshType!==o.ConnectivityTypeEnum.LINE_STRIP){console.log("Unexpected type")}if(this.alwaysBuildIndexedLinesSets){var aa=D.buildIndexationFromStripSet(ag.meshType,ag.nStrips,ag.vertexIndexArray,ag.lengthsArray);if(aa){ag.meshType=o.ConnectivityTypeEnum.LINES;ag.vertexIndexArray=ag.vertexIndexArray?aa:null}}switch(ac){case E:Y.broken.push(ag);ag.edgeType="SHARP_EDGE";break;case K:Y.construction.push(ag);ag.edgeType="SMOOTH_EDGE";break;case C:Y.smart.push(ag);ag.edgeType="BOUNDARY_EDGE";break;default:break}}ad.set(ah.value,Y)}else{break}}return ad},Load:function(X){var aa=D.sharing;var Y=D.optimized;D.sharing=true;D.optimized=true;try{W.memoryLog("Loading smgGeom",true);this.LoadGeometries(X);W.memoryLog("Loading smgGeom",false)}catch(Z){if(Z instanceof RangeError){console.error("smgGeom loading : "+Z.message);return false}}D.sharing=aa;D.optimized=Y;return true},LoadAsModel:function(Y,Z,ab){var aa=this;var X=new window.FileReader();X.onloadend=function(){aa.setIgnoreGeodeMatrix(false);aa.Load(new Uint8Array(X.result));var ac=aa.getMapGeodes();if(Z){ac.forEach(function(ad,ah){var ag=ad.geode;var af=ah;var ae=new U();ae.productType="Instance3D";ae.name=af;if(ag!==null){ae.add(ag);ag.productType="InstanceRep";ag.name="rep_"+af}Z.add(ae)})}ab()};X.readAsArrayBuffer(Y)}});return r});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPolyline",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup","DS/VCXWebProperties/VCXPropertyValueString"],function(e,c,f,a){var d={"ActorCurve.Line.Color":{name:"Collab.Body.Line.Color",type:"VCXPropertyValueColor"},"ActorCurve.Line.Opacity":{name:"Collab.Body.Line.Color.Opacity",type:"VCXPropertyValueFloat"},"ActorCurve.Line.Type":{name:"Collab.Body.Line.Type",type:"VCXPropertyValueEnum"},"ActorCurve.Close":{name:"Polyline.Is.Closed",type:"VCXPropertyValueBoolean"},"Actor.CurveLine.FrontStipplingMotif":{name:"Collab.Body.Line.StipplingMotif",type:"VCXPropertyValueString"},"ActorCurve.UseHiddenStyle":{name:"Collab.Body.Line.UseHiddenStyle",type:"VCXPropertyValueBoolean"},"ActorCurve.BackLine.Color":{name:"Collab.Body.Line.Back.Color",type:"VCXPropertyValueColor"},"ActorCurve.BackLine.Opacity":{name:"Collab.Body.Line.Back.Color.Opacity",type:"VCXPropertyValueFloat"},"ActorCurve.BackLine.Type":{name:"Collab.Body.Line.Back.Type",type:"VCXPropertyValueEnum"},"ActorCurve.BackLine.Width":{name:"Collab.Body.Line.Back.Width",type:"VCXPropertyValueFloat"},"Actor.CurveLine.BackStipplingMotif":{name:"Collab.Body.Line.Back.StipplingMotif",type:"VCXPropertyValueString"},};var b=f.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),d)},getPropertiesMap:function(j,g,n,i,o){var q=this._parent(j,g,n,i,o);for(var p in n){if(!n.hasOwnProperty(p)){continue}var h=n[p];if(p.substring(0,7)==="Anchor."){var k=c.fillPropertyValue(h,"VCXPropertyValueAnchor",g);var l="Actor.Anchor."+p.substring(7);q.set(l,k)}else{var m=d[p];if(m){var k=c.fillPropertyValue(h,m.type,g);switch(p){case"ActorCurve.Line.Opacity":case"ActorCurve.BackLine.Opacity":k.Value/=255;break;default:break}if(m.name&&k){q.set(m.name,k)}}}}return q}});return b});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableBomInfo",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebProperties/VCXPropertyValueMap"],function(c,a,e){var b={GroupInfoPropSet:{name:"GroupInfoPropSet",type:"VCXPropertyValueMap"}};var d=c.extend({getPropertiesDescription:function(){return UWA.extend({},b)},getPropertiesMap:function(g,t,A,q,y,u){var n=new Map();var o=a.getPropertiesDicoFromWebTypeWithInheritance("VCXComponentOccurrenceComposer");for(var k in A){if(!A.hasOwnProperty(k)){continue}var f=b[k];if(f){var w=A[k];var p=a.fillPropertyValue(w,f.type,t);switch(k){case"GroupInfoPropSet":var r=w["GroupInfo.List"];if(!r){break}r=r.GroupInfo;if(!r){break}for(var x=0;x<r.length;x++){var h=r[x];var l=new e();var j=0;for(var s in h){if(!h.hasOwnProperty(s)){continue}var z=h[s];switch(s){case"Name":var i=a.fillPropertyValue(z,"VCXPropertyValueString");var m=i?i.GetValue():null;if(o&&o[m]){i.SetValue(o[m].name)}l.SetValueAtIndex(j,i);l._value[j++].name=s;break;case"Id":var v=a.fillPropertyValue(z,"VCXPropertyValueInt");l.SetValueAtIndex(j,v);l._value[j++].name=s;break;default:break}}p.SetValueAtIndex(x,l)}break;default:break}if(f.name&&p){n.set(f.name,p)}}}return n}});return d});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableGround",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup",],function(c,a,d){var b={"Ground.LocalLocation":{name:"Actor.Position",type:"VCXPropertyValueLocation"},"Ground.Color":{name:"Environment.Ground.Color",type:"VCXPropertyValueColor"},"Ground.FallOff":{name:"Environment.Ground.FallOff",type:"VCXPropertyValueFloat"},"Ground.Grid.Show":{name:"Environment.Ground.Grid.Show",type:"VCXPropertyValueBoolean"},"Ground.Grid.Color":{name:"Environment.Ground.Grid.Color",type:"VCXPropertyValueColor"},"Ground.Auto.Size":{name:"Environment.Ground.Diameter.Auto",type:"VCXPropertyValueBoolean"},"Ground.Diameter":{name:"Environment.Ground.Diameter",type:"VCXPropertyValueFloat"},"Ground.Border.Show":{name:"Environment.Ground.Border.Show",type:"VCXPropertyValueBoolean"},"Ground.Border.Color":{name:"Environment.Ground.Border.Color",type:"VCXPropertyValueColor"},"Viewport.Render.GroundShadows":{name:"Environment.Ground.Shadows.Show",type:"VCXPropertyValueBoolean"},"Viewport.Render.GroundReflect":{name:"Environment.Ground.Mirror.Show",type:"VCXPropertyValueBoolean"},"Viewport.Render.GroundReflect.Blur":{name:"Environment.Ground.Mirror.Blurry",type:"VCXPropertyValueBoolean"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){case"Ground.FallOff":j.Value*=0.01;break;default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupSection",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(c,a,d,e){var b={"CuttingPlane.Enable":{name:"Section.Enable",type:"VCXPropertyValueBoolean"},"CuttingPlane.AutoFlip":{name:"Section.AutoFlip",type:"VCXPropertyValueBoolean"},"CuttingPlane.Capping":{name:"Section.Capping",type:"VCXPropertyValueBoolean"},"CuttingPlane.Capping.Color":{name:"Section.Capping.Color",type:"VCXPropertyValueColor"},"CuttingPlane.Capping.ActorColor":{name:"Section.Capping.ActorColor",type:"VCXPropertyValueBoolean"},"CuttingPlane.Hatch":{name:"Section.Hatching.Frequency",type:"VCXPropertyValueInt"},"CuttingPlane.HatchAngle":{name:"Section.Hatching.Angle",type:"VCXPropertyValueFloat"},"CuttingPlane.SpaceBackAlpha":{name:"Section.SpaceBackAlpha",type:"VCXPropertyValueFloat"},"CuttingPlane.SpaceFrontAlpha":{name:"Section.SpaceFrontAlpha",type:"VCXPropertyValueFloat"}};var f=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(j,h,m,i,n){var p=this._parent(j,h,m,i,n);for(var o in m){if(!m.hasOwnProperty(o)){continue}var l=b[o];if(l){var g=m[o];var k=a.fillPropertyValue(g,l.type,h);switch(o){case"CuttingPlane.SpaceBackAlpha":k.Value/=255;break;case"CuttingPlane.SpaceFrontAlpha":k.Value/=255;break;case"CuttingPlane.Enable":p.set("Section.Plane.Enable",new e(k.Value));break;default:break}if(l.name&&k){p.set(l.name,k)}}}return p}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableCurveWire",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableOccurrence",],function(c,a,d){var b={"ActorCurve.Width":{name:"ActorCurve.Width",type:"VCXPropertyValueInt"},};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowCircular",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrow","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(e,c,b,g){var a={START:0,END:1,BOTH:2,NONE:3};var d={"Anchor.0":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Actor.Angle":{name:"Arrow.Circular.Angle",type:"VCXPropertyValueFloat"},"Actor.Flat":{name:"Arrow.Circular.Flat",type:"VCXPropertyValueEnum"},"Actor.Radius":{name:"Arrow.Circular.Radius",type:"VCXPropertyValueFloat"},"Actor.Step":{name:"Arrow.Circular.Step",type:"VCXPropertyValueInt"}};var f=b.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),d)},getPropertiesMap:function(k,i,o,j,q){var s=this._parent(k,i,o,j,q);var p=false;for(var r in o){if(!o.hasOwnProperty(r)){continue}var n=d[r];if(n){var h=o[r];var l=c.fillPropertyValue(h,n.type,i);switch(r){case"Anchor.0":p=true;break;default:break}if(n.name&&l){s.set(n.name,l)}}}if(!k.bIsOldVersion&&p){var m=new g();m.SetValue(false);s.set("Collab.Is.Paper",m)}return s}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowCorner",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrow","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(d,b,a,f){var c={"Anchor.0":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Actor.Length2":{name:"Arrow.Corner.Length.1",type:"VCXPropertyValueFloat"},Length:{name:"Arrow.Corner.Length.2",type:"VCXPropertyValueFloat"}};var e=a.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),c)},getPropertiesMap:function(j,h,n,i,p){var r=this._parent(j,h,n,i,p);var o=false;for(var q in n){if(!n.hasOwnProperty(q)){continue}var m=c[q];if(m){var g=n[q];var k=b.fillPropertyValue(g,m.type,h);switch(q){case"Anchor.0":o=true;break;default:break}if(m.name&&k){r.set(m.name,k)}}}if(!j.bIsOldVersion&&o){var l=new f();l.SetValue(false);r.set("Collab.Is.Paper",l)}return r}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableMeshPrimitive",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableMesh",],function(d,a,e){var c={"Domain1.DomainType":{name:"ActorMeshPrimitive.Domain1.DomainType",type:"VCXPropertyValueEnum"},"Domain1.Height":{name:"ActorMeshPrimitive.Domain1.Height",type:"VCXPropertyValueFloat"},"Cube.Depth":{name:"ActorMeshPrimitive.Cube.Depth",type:"VCXPropertyValueFloat"},"Cube.Width":{name:"ActorMeshPrimitive.Cube.Width",type:"VCXPropertyValueFloat"},"Domain1.OuterRadius":{name:"ActorMeshPrimitive.Domain1.OuterRadius",type:"VCXPropertyValueFloat"},"Domain1.TopRadius":{name:"ActorMeshPrimitive.Domain1.TopRadius",type:"VCXPropertyValueFloat"}};var b=e.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),c)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=c[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return b});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCompass",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgGeomLoader","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup",],function(c,a,f,g,e){var b={"Navigator.Compass.GeomPath":{name:"Compass.GeomPath",type:"VCXPropertyValueDocId"},"Navigator.Compass.AbsoluteSize":{name:"Compass.AbsoluteSize",type:"VCXPropertyValueBoolean"},"Navigator.Compass.Size":{name:"Compass.Size",type:"VCXPropertyValueFloat"},"Navigator.Compass.SizePixel":{name:"Compass.SizePixel",type:"VCXPropertyValueInt"},"Navigator.Compass.Translation":{name:"Compass.Translation",type:"VCXPropertyValuePoint"},"Navigator.Compass.Frame.Alignment":{name:"Compass.Alignment",type:"VCXPropertyValueFrame"}};var d=e.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(n,i,s,m,v){var r=n.QueryInterface("W3AISGNodeHolder");if(r&&r._sgNode){r._sgNode.setGeomConverter(function(z,y){var A=new XMLHttpRequest();A.open("GET",z,true);A.responseType="arraybuffer";A.onerror=function(){if(y&&y!==undefined){y(new Map())}};A.onload=function(C){if(this.status===200){var B=new f(i);B.setIgnoreGeodeMatrix(false);B.Load(new Uint8Array(this.response));if(y&&y!==undefined){y(B.getMapGeodes())}}else{if(y&&y!==undefined){y(new Map())}}};A.send()})}var x=this._parent(n,i,s,m);for(var w in s){if(!s.hasOwnProperty(w)){continue}var q=b[w];if(q){var h=s[w];var o=a.fillPropertyValue(h,q.type,i);switch(w){case"Navigator.Compass.Visibility":break;case"Navigator.Compass.GeomPath":var u=-1;if(h["@attributes"]&&h["@attributes"].Value){var l=h["@attributes"].Value;var p=l.split("\\").pop().split("/").pop().toLowerCase();var t=m[p];if(t){var k=i.getManager("VCXDocManager").BuildPathFromString(t,p);var j=i.getManager("VCXDocManager").AddOrModifyDoc(k);u=j.Value}o.SetValue(u)}break;default:break}if(q.name&&o){x.set(q.name,o)}}}return x}});return d});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPath",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPolyline","DS/VCXWebProperties/VCXPropertyValueString"],function(e,c,b,a){var d={"ActorCurvePath.AxeOrder":{name:"Collab.Path.AxesOrder",type:"VCXPropertyValueEnum"},"ActorCurvePath.Full":{name:"Collab.Path.IsFull",type:"VCXPropertyValueBoolean"},"ActorCurvePath.IsFromNeutral":{name:"Collab.Path.IsFromNeutral",type:"VCXPropertyValueBoolean"},"ActorCurvePath.Mode":{name:"Collab.Path.ConstructMode",type:"VCXPropertyValueEnum"},};var f=b.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),d)},getPropertiesMap:function(j,g,n,i){var p=this._parent(j,g,n,i);for(var o in n){if(!n.hasOwnProperty(o)){continue}var h=n[o];if(o.substring(0,7)==="Anchor."){var k=c.fillPropertyValue(h,"VCXPropertyValueAnchor",g);var l="Actor.Anchor."+o.substring(7);p.set(l,k)}else{var m=d[o];if(m){var k=c.fillPropertyValue(h,m.type,g);switch(o){default:break}if(m.name&&k){p.set(m.name,k)}}}}return p}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableRedLine",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup",],function(c,a,d){var b={"Anchor.0":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Line.Width":{name:"Collab.Body.Line.Width",type:"VCXPropertyValueFloat"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiablePoint",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableOccurrence",],function(c,a,d){var b={"ActorPoint.Width":{name:"ActorPoint.Width",type:"VCXPropertyValueInt"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupDigger",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebProperties/VCXPropertyValueFrame"],function(d,b,a){var c={"Inspector.Enabled":{name:"Actor.Opacity",type:"VCXPropertyValueFloat"},"Digger.Radius":{name:"Digger.Radius",type:"VCXPropertyValueFloat"},"Digger.Position":{name:"Digger.Position",type:"VCXPropertyValuePoint2D"},"Digger.Renderer":{name:"Digger.Mode",type:"VCXPropertyValueEnum"},"Digger.COIOn":{name:"Digger.Attach",type:"VCXPropertyValueBoolean"},"Digger.COIPos":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Digger.Depth":{name:null,type:"VCXPropertyValueFloat"},};var e=d.extend({getPropertiesDescription:function(){return UWA.extend({},c)},getPropertiesMap:function(i,g,m,h,n){var p=new Map();for(var o in m){if(!m.hasOwnProperty(o)){continue}var l=c[o];if(l){var f=m[o];var k=b.fillPropertyValue(f,l.type,g);switch(o){case"Digger.Renderer":switch(k.GetValue()){case 0:k.Value=1;break;case 1:k.Value=2;break;case 2:k.Value=0;break;case 3:k.Value=0;break}break;case"Digger.COIPos":var j=b.fillPropertyValue(f,"VCXPropertyValueVector",g);k.SetValueFrame(new a().SetValueFromVector(j.GetValue()));break;case"Digger.Depth":if(i.loadParentMode==="DigZoom"){p.set("Digger.ZoomFactor",k)}else{p.set("Digger.DepthFactor",k)}break;default:break}if(l.name&&k){p.set(l.name,k)}}}return p}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPanel",["UWA/Class","DS/VCXWebDressup/VCXMarkupModifiable","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueAnchor","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueFont","DS/VCXWebProperties/VCXColor"],function(d,i,f,o,b,a,l,j,k,m,h,e,n){var c={"Text.Position":{name:"Collab.3D.Paper.3D.Text.Position",type:"VCXPropertyValuePoint"},"Actor.Location":{name:"Actor.Anchor.Location",type:"vcxPropertyValueAnchor"},"Text.PreString":{name:"Collab.Measurement.PreString",type:"VCXPropertyValueString"},"Text.MiddleString":{name:"Collab.Measurement.MiddleString",type:"VCXPropertyValueString"},"Text.PostString":{name:"Collab.Measurement.PostString",type:"VCXPropertyValueString"},"Actor.PreSymbol":{name:"Collab.Measurement.PreSymbol",type:"VCXPropertyValueEnum"},"Actor.MiddleSymbol":{name:"Collab.Measurement.MiddleSymbol",type:"VCXPropertyValueEnum"},"Actor.PostSymbol":{name:"Collab.Measurement.PostSymbol",type:"VCXPropertyValueEnum"},"Actor.DisplayValue":{name:"Collab.Measurement.DisplayValue",type:"VCXPropertyValueBoolean"},"Text.Foreground.Color":{name:"Collab.Text.Color",type:"VCXPropertyValueColor"},"Text.Bk":{name:"Collab.Body.Shape",type:"VCXPropertyValueEnum"},"VectorImage.Shape":{name:"Collab.Body.Shape",type:"VCXPropertyValueEnum"},"Widget.Shape":{name:"Collab.Body.Shape",type:"VCXPropertyValueEnum"},"VectorImage.BackGround.Enable":{name:"Collab.Background.Show",type:"VCXPropertyValueBoolean"},"Widget.Background":{name:"Collab.3D.Paper.Is.Background",type:"VCXPropertyValueBoolean"},"Text.Bk.Opacity":{name:"Collab.Background.Color.Opacity",type:"VCXPropertyValueFloat"},"VectorImage.BackGround.Opacity":{name:"Collab.Background.Color.Opacity",type:"VCXPropertyValueFloat"},"ActorArrow.Bg.Opacity":{name:"Collab.Background.Color.Opacity",type:"VCXPropertyValueFloat"},"VectorImage.Scale":{name:"Collab.Image.Scale",type:"VCXPropertyValueFloat"},"Actor.Color":{name:"Collab.Background.Color",type:"VCXPropertyValueColor"},"VectorImage.BackGround.Color":{name:"Collab.Background.Color",type:"VCXPropertyValueColor"},"ActorCurve.Border":{name:"Collab.Border.Show",type:"VCXPropertyValueBoolean"},"Text.Label.Line.Show":{name:"Collab.Border.Show",type:"VCXPropertyValueBoolean"},"Text.Label.Line.Opacity":{name:"Collab.Border.Line.Color.Opacity",type:"VCXPropertyValueFloat"},"ActorCurve.Border.Opacity":{name:"Collab.Border.Line.Color.Opacity",type:"VCXPropertyValueFloat"},"Text.Label.Line.Color":{name:"Collab.Border.Line.Color",type:"VCXPropertyValueColor"},"ActorCurve.Border.Color":{name:"Collab.Border.Line.Color",type:"VCXPropertyValueColor"},"Text.LineWidth":{name:"Collab.Border.Line.Width",type:"VCXPropertyValueFloat"},"ActorCurve.Border.Width":{name:"Collab.Border.Line.Width",type:"VCXPropertyValueFloat"},"Text.Attach.Line.Color":{name:"Collab.Attach.Line.Color",type:"VCXPropertyValueColor"},"Text.Attach.Line.Width":{name:"Collab.Attach.Line.Width",type:"VCXPropertyValueFloat"},"Text.Attach.Line.Type":{name:"Collab.Attach.Line.Type",type:"VCXPropertyValueEnum"},"Text.Attach.Line.Curvature":{name:"Collab.Attach.Curvature",type:"VCXPropertyValueFloat"},"Text.String":{name:null,type:"VCXPropertyValueString"},"Text.LinkedPropertyName":{name:null,type:"VCXPropertyValueString"},"Text.LinkedParentLevel":{name:null,type:"VCXPropertyValueInt"},"Text.Font":{name:"Collab.Text.Font",type:"VCXPropertyValueFont"},"Texture.Map.Path":{name:"Collab.Image.Doc.ID",type:"VCXPropertyValueDocId"},"VectorImage.Filepath":{name:"Collab.Image.Doc.ID",type:"VCXPropertyValueDocId"},"Text.CalloutAlignment":{name:"Collab.3D.Paper.Positioning.Type",type:"VCXPropertyValueEnum"},"Text.DrawAnchor":{name:"Collab.Attach.Preset",type:"VCXPropertyValueEnum"},"Text.Attach.Type":{name:"Collab.Measurement.Attach.Type",type:"VCXPropertyValueFloat"},"Text.ShowEndPoints":{name:"Collab.Measurement.ShowEndPoints",type:"VCXPropertyValueBoolean"},"Text.ShowConstruction":{name:"Collab.Measurement.ShowConstructionLines",type:"VCXPropertyValueBoolean"},"Text.ShowRedline":{name:"Collab.Measurement.ShowRedlines",type:"VCXPropertyValueBoolean"},"Text.ShowPlanes":{name:"Collab.Measurement.ShowPlanes",type:"VCXPropertyValueBoolean"},"Text.Callout2D":{name:null,type:"VCXPropertyValuePoint"},"Widget.Arrow.Origin":{name:"Collab.Attach.Origin",type:"VCXPropertyValuePoint"},"Widget.Top":{name:null,type:"VCXPropertyValueFloat"},"Widget.Left":{name:null,type:"VCXPropertyValueFloat"},"Widget.Depth":{name:"Collab.3D.Paper.Depth",type:"VCXPropertyValueFloat"},"Widget.Width":{name:"Collab.Body.Width",type:"VCXPropertyValueFloat"},"Panel.Width":{name:"Collab.Body.Width",type:"VCXPropertyValueFloat"},"Widget.Height":{name:"Collab.Body.Height",type:"VCXPropertyValueFloat"},"Panel.Height":{name:"Collab.Body.Height",type:"VCXPropertyValueFloat"},"Widget.Autofit":{name:"Collab.Body.FitToText",type:"VCXPropertyValueBoolean"},"ActorComposite.KeepAspectRatio":{name:"Collab.Body.KeepAspectRatio",type:"VCXPropertyValueBoolean"},"Widget.KeepAspectRatio":{name:"Collab.Body.KeepAspectRatio",type:"VCXPropertyValueBoolean"},"Widget.BOM.FilterOnVisibleCallouts":{name:"Collab.BOM.FilterOnVisibleCallouts",type:"VCXPropertyValueBoolean"},"Widget.BOM.TextLabelColor":{name:"Collab.BOM.Header.Text.Color",type:"VCXPropertyValueColor"},"Widget.BOM.TextCellColor":{name:"Collab.Text.Color",type:"VCXPropertyValueColor"},"Widget.BOM.LabelCellColor":{name:"Collab.BOM.Header.Background.Color",type:"VCXPropertyValueColor"},"Widget.BOM.OddCellColor":{name:"Collab.BOM.OddRow.Background.Color",type:"VCXPropertyValueColor"},"Widget.BOM.EvenCellColor":{name:"Collab.BOM.EvenRow.Background.Color",type:"VCXPropertyValueColor"},"Widget.ShadowEnable":{name:"Collab.Body.Shadow.Show",type:"VCXPropertyValueBoolean"},"Widget.ShadowDistance":{name:"Collab.Body.Shadow.Distance",type:"VCXPropertyValueFloat"},"Widget.ShadowOrientation":{name:"Collab.Body.Shadow.Orientation",type:"VCXPropertyValueFloat"},"Widget.ShadowOpacity":{name:"Collab.Body.Shadow.Opacity",type:"VCXPropertyValueFloat"},"Widget.ShadowBlur":{name:"Collab.Body.Shadow.Blur",type:"VCXPropertyValueFloat"},"Actor.Radius":{name:"Collab.Measurement.Radius",type:"VCXPropertyValueFloat"},"Actor.Prop.Area":{name:"Collab.Measurement.Area",type:"VCXPropertyValueFloat"},"Actor.Prop.Volume":{name:"Collab.Measurement.Volume",type:"VCXPropertyValueFloat"},Length:{name:"Collab.Measurement.Length",type:"VCXPropertyValueFloat"},"Actor.Length1":{name:"Collab.Measurement.Length1",type:"VCXPropertyValueFloat"},"Actor.Length2":{name:"Collab.Measurement.Length2",type:"VCXPropertyValueFloat"},"Actor.Radius1":{name:"Collab.Measurement.Radius1",type:"VCXPropertyValueFloat"},"Actor.Radius2":{name:"Collab.Measurement.Radius2",type:"VCXPropertyValueFloat"},"Actor.Pulse":{name:"Actor.Pulse.Period",type:"VCXPropertyValueEnum"},"Actor.Pulse.Color":{name:"Pulse.Collab.Image.Color",type:"VCXPropertyValueColor"},"Widget.Freeze":{name:"Actor.Freeze",type:"VCXPropertyValueEnum"}};var g=o.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),c)},getPropertiesMap:function(V,F,p,B,O){var U=this._parent(V,F,p,B,O);var A=null;var W=null;var x=null;var M=null;var G=false;var C=null;var z=null;var T=null;for(var L in p){if(!p.hasOwnProperty(L)){continue}var w=p[L];var X;if(L.substring(0,7)==="Anchor."){X=f.fillPropertyValue(w,"VCXPropertyValueAnchor",F);if(parseInt(L.substring(7))<1000){var v="Actor.Anchor."+L.substring(7);U.set(v,X)}}else{var Q=c[L];if(Q){X=f.fillPropertyValue(w,Q.type,F);switch(L){case"Actor.Location":var N=f.fillPropertyValue(w,"VCXPropertyValueLocation",F);X=new j();X.SetValueFrame(N.GetFrame());break;case"Text.Bk":break;case"VectorImage.Shape":switch(X.GetValue()){case 0:X.SetValue(1);break;case 1:X.SetValue(1);break;case 2:X.SetValue(3);break;case 3:X.SetValue(3);break}break;case"Widget.Shape":switch(X.GetValue()){case 0:X.SetValue(1);break;case 1:X.SetValue(6);break;case 2:X.SetValue(7);break;case 3:X.SetValue(4);break;case 4:X.SetValue(5);break}break;case"Text.Bk.Opacity":case"VectorImage.BackGround.Opacity":case"ActorArrow.Bg.Opacity":X.Value/=255;break;case"VectorImage.Scale":X.Value*=0.01;break;case"Actor.Color":U.set("Collab.Image.Color",X);break;case"VectorImage.BackGround.Color":U.set("Collab.Image.Color",new m(new n().SetRGBA(1,1,1,1)));break;case"Text.Label.Line.Opacity":case"ActorCurve.Border.Opacity":X.Value/=255;break;case"Text.LineWidth":case"ActorCurve.Border.Width":X.Value*=2;break;case"Text.Attach.Line.Width":X.Value*=2;break;case"Text.String":C=X.Value;break;case"Text.LinkedPropertyName":z=X.Value;break;case"Text.LinkedParentLevel":T=X.Value;break;case"Texture.Map.Path":case"VectorImage.Filepath":var J=f.fillPropertyValue(w,"VCXPropertyValueString",F);var I=J.Value.slice(J.Value.lastIndexOf("\\")+1).toLowerCase();if(I){var s=B[I];var r=F.getManager("VCXDocManager").BuildPathFromString(s,I);if(r){X=F.getManager("VCXDocManager").AddOrModifyDoc(r)}}if(!X){X=new h()}break;case"Text.Position":if(O==="CLitText2dPaperSpace"){W=parseFloat(w["@attributes"].X);A=parseFloat(w["@attributes"].Y)}G=true;break;case"Text.Callout2D":M=parseFloat(w["@attributes"].X);x=parseFloat(w["@attributes"].Y);break;case"Widget.Arrow.Origin":U.set("Collab.Attach.CenteredOrigin",new a(false));break;case"Widget.Top":A=X.Value;break;case"Widget.Left":W=X.Value;break;case"Widget.ShadowOpacity":X.Value/=255;break;case"Text.DrawAnchor":if(!X.Value){U.set("Collab.Attach.Show",new a(false))}else{var H=i.GetAttachPresets(X.Value);var q;q=new b();q.SetValue(H["Collab.Attach.LeadType"]);U.set("Collab.Attach.LeadType",q);q=new b();q.SetValue(H["Collab.Attach.ExtremityType"]);U.set("Collab.Attach.ExtremityType",q);q=new l();q.SetValue(H["Collab.Attach.Curvature"]);U.set("Collab.Attach.Curvature",q);q=new a();q.SetValue(H["Collab.Attach.Background.Gradient"]);U.set("Collab.Attach.Background.Gradient",q);q=new a();q.SetValue(H["Collab.Attach.Border.Gradient"]);U.set("Collab.Attach.Border.Gradient",q);q=new a();q.SetValue(H["Collab.Attach.BentDot"]);U.set("Collab.Attach.BentDot",q)}break;case"Actor.Pulse":var D=new b();D.SetValue(0);if(X.GetValue()>0){X.SetValue(X.GetValue()-1);D.SetValue(1);var S=new a();S.SetValue(true);U.set("Actor.Pulse.PauseAnim",S)}U.set("Actor.Pulse.Type",D);break;case"Actor.Pulse.Color":if(!U.get("Actor.Pulse.Type")){X=null}else{U.set("Pulse.Collab.Background.Color",X)}break;case"ActorCurve.Border":case"Text.Label.Line.Show":if(O==="CLit2dWidgetImagePaperSpaceFromCropArea"){X.Value=false}break;default:break}if(Q.name&&X){U.set(Q.name,X)}}}}var P=f.translateLinkedPropertyString(F,V,z,T,C,U);if(P){var E=new k();E.Value=P;U.set("Collab.Text",E);var y=new a();y.Value=true;U.set("Collab.Text.Show",y);var K=new l();K.SetValue(1);U.set("Collab.Body.InnerMargin",K)}var Y=false;if(x){A=x*F.getManager("VCXPaperManager").Size.y;Y=true}if(M){W=M*F.getManager("VCXPaperManager").Size.x;Y=true}if(W!==null||A!==null){if(W!==null){var u=new l();u.SetValue(W);U.set("Collab.3D.Paper.Paper.Position.X",u)}if(A!==null){var t=new l();t.SetValue(A);U.set("Collab.3D.Paper.Paper.Position.Y",t)}var R=new b();if(G){R.SetValue(1)}else{if(Y){R.SetValue(2)}else{R.SetValue(0)}}U.set("Collab.Body.VAlignment",R)}return U}});return g});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCircle",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup",],function(c,a,e){var b={"Anchor.0":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Actor.Color":{name:"Collab.Background.Color",type:"VCXPropertyValueColor"},"Actor.Circle.Background":{name:"Circle.Background.Type",type:"VCXPropertyValueEnum"},"ActorCurve.Line.Color":{name:"Collab.Body.Line.Color",type:"VCXPropertyValueColor"},"ActorCurve.Line.Opacity":{name:"Collab.Body.Line.Color.Opacity",type:"VCXPropertyValueFloat"},"ActorCurve.Line.Type":{name:"Collab.Body.Line.Type",type:"VCXPropertyValueEnum"},"ActorCurve.Line.Width":{name:"Collab.Body.Line.Width",type:"VCXPropertyValueFloat"},"Actor.Radius":{name:"Circle.Radius",type:"VCXPropertyValueFloat"},"Actor.Thickness":{name:"Circle.Thickness",type:"VCXPropertyValueFloat"},};var d=e.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){case"ActorCurve.Line.Opacity":case"ActorCurve.Border.Opacity":j.Value/=255;break;default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return d});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowLinear",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrow","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(d,b,a,e){var c={"Anchor.0":{name:"Actor.Anchor.0",type:"VCXPropertyValueAnchor"},"Anchor.1":{name:"Actor.Anchor.1",type:"VCXPropertyValueAnchor"}};var f=a.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),c)},getPropertiesMap:function(j,h,n,i,q){var s=this._parent(j,h,n,i,q);var p=false;var o=false;for(var r in n){if(!n.hasOwnProperty(r)){continue}var m=c[r];if(m){var g=n[r];var k=b.fillPropertyValue(g,m.type,h);switch(r){case"Anchor.0":p=true;break;case"Anchor.1":o=true;break;default:break}if(m.name&&k){s.set(m.name,k)}}}if(p&&o){var l=new e();l.SetValue(false);s.set("Collab.Is.Paper",l)}return s}});return f});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableViewport",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools"],function(d,b){var c={"Viewport.CameraToSeeInterface":{name:"Viewport.ActiveCamera",type:"VCXPropertyValueInt"},"Navigator.Camera.Vertical":{name:"Environment.Vertical",type:"VCXPropertyValueEnum"},"Viewport.Render.BackCulling":{name:"Environment.BackFaceCulling",type:"VCXPropertyValueBoolean"},"Viewport.Render.SSAO":{name:"Environment.SSAO",type:"VCXPropertyValueEnum"},"Viewport.Render.HLGlow":{name:"Environment.Bloom",type:"VCXPropertyValueBoolean"},"Viewport.Render.Mode":{name:"Render.Mode",type:"VCXPropertyValueEnum"},"Viewport.Render.ShowSharedEdges":{name:"Render.OutlineType",type:"VCXPropertyValueEnum"},"Viewport.Bk.Color":{name:"Environment.Background.Color",type:"VCXPropertyValueColor"},"Viewport.Bk.Alpha":{name:"Environment.Background.Color.Opacity",type:"VCXPropertyValueFloat"},"Viewport.BkFoot.Color":{name:"Environment.Background.Foot.Color",type:"VCXPropertyValueColor"},"Viewport.BkGradient":{name:"Environment.Background.Gradient",type:"VCXPropertyValueBoolean"},"Viewport.Bk.Image.Path":{name:"Environment.Background.Image",type:"VCXPropertyValueDocId"},"Viewport.Render.Lighting.Mode":{name:"Render.Lighting.Mode",type:"VCXPropertyValueEnum"},};var a=d.extend({getPropertiesDescription:function(){return UWA.extend({},c)},getPropertiesMap:function(i,f,m,h,p){var r=new Map();for(var q in m){if(!m.hasOwnProperty(q)){continue}var l=c[q];if(l){var e=m[q];var j=b.fillPropertyValue(e,l.type,f);switch(q){case"Viewport.Render.SSAO":if(j.Value===1){j.Value=2}break;case"Viewport.Bk.Alpha":j.Value/=255;break;case"Viewport.Bk.Image.Path":var o=b.fillPropertyValue(e,"VCXPropertyValueString",f);var k=o.Value.slice(o.Value.lastIndexOf("\\")+1).toLowerCase();if(k){var g=h[k];var n=f.getManager("VCXDocManager").BuildPathFromString(g,k);if(n){j=f.getManager("VCXDocManager").AddOrModifyDoc(n)}}break;default:break}if(l.name&&j){r.set(l.name,j)}}}return r}});return a});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableHotSpot",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiable",],function(c,a,d){var b={"HotSpot.Show":{name:"Actor.Enable",type:"VCXPropertyValueBoolean"},"HotSpot.Color":{name:"Actor.Color",type:"VCXPropertyValueColor"},"HotSpot.Tooltip":{name:"Actor.ToolTip",type:"VCXPropertyValueString"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCamera",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressup","DS/VCXWebProperties/VCXPropertyValueAnchor",],function(e,c,f,b){var d={"Navigator.Camera.Location":{name:null,type:"VCXPropertyValueLocation"},"Anchor.1":{name:"Actor.Anchor.1",type:"VCXPropertyValueAnchor"},"Anchor.2":{name:"Actor.Anchor.2",type:"VCXPropertyValueAnchor"},"Navigator.Camera.Fov":{name:"Camera.Angle",type:"VCXPropertyValueFloat"},"Navigator.Camera.Height":{name:"Camera.Height",type:"VCXPropertyValueFloat"},"Navigator.Camera.Proj.Persp":{name:"Camera.Ortho",type:"VCXPropertyValueBoolean"},"Navigator.Camera.Arcball":{name:"Camera.Arcball",type:"VCXPropertyValueBoolean"},"Navigator.Camera.Interpolator":{name:"Actor.Interpolation.Type",type:"VCXPropertyValueEnum"},"Camera.Pitch":{name:"Camera.Pitch",type:"VCXPropertyValueBoolean"},"Camera.Roll":{name:"Camera.Roll",type:"VCXPropertyValueBoolean"},"Camera.Yaw":{name:"Camera.Yaw",type:"VCXPropertyValueBoolean"},"Camera.LockDistCOI":{name:"Camera.LockDistCOI",type:"VCXPropertyValueBoolean"},"Camera.DistCOI":{name:"Camera.DistCOI",type:"VCXPropertyValueFloat"},};var a=f.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),d)},getPropertiesMap:function(j,h,m,i,n){var r=this._parent(j,h,m,i,n);for(var o in m){if(!m.hasOwnProperty(o)){continue}var l=d[o];if(l){var g=m[o];var k=c.fillPropertyValue(g,l.type,h);switch(o){case"Navigator.Camera.Location":var q=new b();q.SetValueFrame(k.GetFrame());r.set("Actor.Anchor.1",q);var p=new b();p.SetValueFrame(k.GetPivot());r.set("Actor.Anchor.2",p);break;case"Navigator.Camera.Fov":k.Value=k.Value*180/Math.PI;break;case"Navigator.Camera.Proj.Persp":k.Value=!(k.Value);break;default:break}if(l.name&&k){r.set(l.name,k)}}}return r}});return a});define("DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiablePmi",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableOccurrence",],function(c,a,d){var b={"ActorCompositePmi.MirroringRepresentation":{name:"ActorCompositePmi.MirroringRepresentation",type:"VCXPropertyValueEnum"}};var e=d.extend({getPropertiesDescription:function(){return UWA.extend(this._parent(),b)},getPropertiesMap:function(i,g,l,h,m){var o=this._parent(i,g,l,h,m);for(var n in l){if(!l.hasOwnProperty(n)){continue}var k=b[n];if(k){var f=l[n];var j=a.fillPropertyValue(f,k.type,g);switch(n){default:break}if(k.name&&j){o.set(k.name,j)}}}return o}});return e});define("DS/VCXWebInteropSMG/VCXSmgLoaderModifiableFactory",["UWA/Class","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiable","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableViewport","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableGround","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableMesh","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableMeshPrimitive","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiablePmi","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableCurveWire","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiablePoint","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableRedLine","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCamera","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPath","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowLinear","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowCircular","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupArrowCorner","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCircle","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPolyline","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableBomManager","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableBomInfo","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupPanel","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupDigger","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableHotSpot","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupCompass","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableDressupSection","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean",],function(x,p,B,v,e,l,o,b,g,j,h,d,q,m,u,A,r,k,c,a,w,t,C,i,f,z,y){var s={CLitViewport:{classname:"VCXComponentViewport",classFcntName:v},CLitActorGround:{classname:"VCXComponentGround",classFcntName:e},CLitVectorImageBOM:{classname:"VCXComponentBOM",classFcntName:w},CLitKBOMManager:{classname:"VCXComponentBomManager",classFcntName:c},CLitBOMInfo:{classname:"VCXBOMInfoComponent",classFcntName:a},CLitActor:{classname:"VCXComponentOccurrenceComposer",classFcntName:B},CLitAssyGroup:{classname:"VCXComponentOccurrenceComposer",classFcntName:B},CLitActorMesh:{classname:"VCXComponentMesh",classFcntName:l},CLitActorPoint:{classname:"VCXComponentPoint",classFcntName:j},CLitActorCurveWire:{classname:"VCXComponentCurveWire",classFcntName:g},CLitActorCompositePmi:{classname:"VCXComponentCompositePmi",classFcntName:b},CLitCameraActor:{classname:"VCXComponentCamera",classFcntName:d},CLitRedline:{classname:"VCXComponentRedLine",classFcntName:h},CLitActorCurvePolyline:{classname:"VCXComponentPolyline",classFcntName:k},CLitQuotationArc:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(110)}},CLitQuotationAngle:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(120)}},CLitQuotationLinear:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(130)}},CLitQuotationDiameter:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(140)}},CLitQuotationBetweenAxis:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(160)}},CLitQuotationBetweenCentres:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(170)}},CLitQuotationBetweenPlanes:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(180)}},CLitQuotationPlanePoint:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(190)}},CLitQuotationBetweenPoints:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(200)}},CLitQuotationBetweenObjects:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(210)}},CLitQuotationArea:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(220)}},CLitQuotationVolume:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(230)}},CLitQuotationAreaMultiplePoints:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(250)}},CLitQuotationVolumeMultiplePoints:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(260)}},CLitQuotationBetweenLines:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(280)}},CLitQuotationLinePoint:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(290)}},CLitQuotationRadius:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(300)}},CLitQuotationCoord:{classname:"VCXComponentMeasurement",classFcntName:w,additionalProperties:{"Collab.Measurement.Type":new z(310)}},CLitRLCircle:{classname:"VCXComponentCircle",classFcntName:r,additionalProperties:{"Collab.Is.Paper":new y(false)}},CLitRLArrow:{classname:undefined,classFcntName:undefined},CLitRLArrowLinear:{classname:"VCXComponentArrowLinear",classFcntName:m},CLitRLArrowCircular:{classname:"VCXComponentArrowCircular",classFcntName:u},CLitRLArrowCorner:{classname:"VCXComponentArrowCorner",classFcntName:A},CLit2dWidgetImage:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetImagePaperSpace:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetImageFromDigger:{classname:"VCXComponentDiggerPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetImagePaperSpaceFromDigger:{classname:"VCXComponentDiggerPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetImagePaperSpaceFromCropArea:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetArea:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetText:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Background.Show":new y(true),"Collab.Text.Availability":new z(1),"Collab.Attach.3DAttach":new y(false)}},CLit2dWidgetTextPaperSpace:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Background.Show":new y(true),"Collab.Text.Availability":new z(1),"Collab.Attach.3DAttach":new y(false)}},CLitVectorImage:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLitVectorImageFromDetailView:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Attach.3DAttach":new y(false)}},CLitVectorImage3D:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.3D.Paper.Positioning.Type":new z(1001),"Collab.3D.Paper.Billboard.Type":new z(0),"Collab.3D.Paper.Size.Control.Type":new z(0),"Actor.IsAlwaysOnTop":new y(false)}},CLitPanel:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.3D.Paper.Positioning.Type":new z(1001),"Collab.3D.Paper.Billboard.Type":new z(0),"Collab.3D.Paper.Size.Control.Type":new z(0),"Actor.IsAlwaysOnTop":new y(false)}},CLitText2d:{classname:"VCXComponentLabel",classFcntName:w,additionalProperties:{"Collab.Body.HAlignment":new z(0),"Collab.Body.VAlignment":new z(0),"Collab.Text.Availability":new z(1)}},CLitText2dPaperSpace:{classname:"VCXComponentPanel",classFcntName:w,additionalProperties:{"Collab.Body.HAlignment":new z(0),"Collab.Body.VAlignment":new z(0),"Collab.Background.Show":new y(true),"Collab.Text.Availability":new z(1),"Collab.3D.Paper.Positioning.Type":new z(101)}},CLitTextMultiplePoints:{classname:"VCXComponentLabel",classFcntName:w,additionalProperties:{"Collab.Body.HAlignment":new z(0),"Collab.Body.VAlignment":new z(1),"Collab.3D.Paper.UsesBarycenter":new y(false)}},CLitCalloutMP:{classname:"VCXComponentCallout",classFcntName:w},CLitCallout:{classname:"VCXComponentCallout",classFcntName:w},CLitActorComposite:{classname:undefined,classFcntName:undefined},CLitActorCompositeIntersect:{classname:undefined,classFcntName:undefined},CLitCS:{classname:undefined,classFcntName:undefined},CLitGrid:{classname:undefined,classFcntName:undefined},CLitLight:{classname:undefined,classFcntName:undefined},CLitActorBBox:{classname:undefined,classFcntName:undefined},CLitActorPrim:{classname:"VCXComponentMeshPrimitive",classFcntName:o},CLitActorCompass:{classname:"VCXComponentCompass",classFcntName:i},CLitActorAxis:{classname:undefined,classFcntName:undefined},CLitDigger:{classname:"VCXComponentDigger",classFcntName:t},CLitActorMagnetLine:{classname:undefined,classFcntName:undefined},CLitSelectionHotSpot:{classname:"VCXComponentHotspot",classFcntName:C},CLitTargetObject:{classname:undefined,classFcntName:undefined},CLitCuttingPlane:{classname:"VCXComponentSection",classFcntName:f},CLitActorCurvePolylinePath:{classname:"VCXComponentPath",classFcntName:q},CLitActorCurvePolylinePathAssociative:{classname:"VCXComponentAssociativePath",classFcntName:q}};var n=x.extend({init:function(){this._Converters={};this._mapComponentConverter=new Map();if(p.mapConverters){console.warn("Converters map should be undefined")}p._factory=this},clear:function(){this._Converters=null;this._mapComponentConverter=null;delete p._factory},getV1Ids:function(){return s},createPropertiesMap:function(E,H,J,I,D){if(E){var G=this._mapComponentConverter.get(E.GetObject());if(!G){for(var F in s){if(s[F].classname===E.GetObject().GetType()){G=new s[F].classFcntName();this._Converters[s[F].classname]=G;this._mapComponentConverter.set(E.GetObject(),G)}}}if(G){return G.getPropertiesMap(E,H,J,I,D)}else{console.warn("Can't find properties set converter")}}console.warn("Can't create properties set");return new Map()},create:function(K,G,J,E,N){var L=s[G];if(!L||!L.classname){return null}var M=K.Factory.BuildComponent(L.classname);if(!M){console.warn("Unable to build component "+L.classname);return null}var O=M.QueryInterface("VCXIModifiable");for(var D in L.additionalProperties){if(L.additionalProperties.hasOwnProperty(D)){O.OnChangeProperty(D,L.additionalProperties[D])}}if(J){M.SetID(J);if(!M.IsDressup){if(M.QueryInterface("W3AISGNodeHolder")){if(E){M.QueryInterface("W3AISGNodeHolder").setPathElement(E)}}}else{K.getManager("VCXDressupManager").AddDressups([M])}K.ComponentsMap.AddComponent(M)}if(N&&N!==undefined){if(!M.IsDressup){var I=M.QueryInterface("VCXIModelNavigable");var H=N.QueryInterface("VCXIModelNavigable");if(I&&H){I.setParent(H)}}}var F=this._Converters[L.classname];if(!F){F=new L.classFcntName();this._Converters[L.classname]=F}this._mapComponentConverter.set(M,F);return M}});return n});var VCXStatNb3DNodes=0;define("DS/VCXWebInteropSMG/VCXSmgXmlLoader",["UWA/Class","DS/CoreEvents/Events","DS/Visualization/PathElement","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/Mesh/MeshUtils","DS/VCXKeyFramer/VCXScenario","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueVector","DS/VCXWebProperties/VCXPropertyValueBin","DS/VCXWebModifiables/VCXMetaPropertyDef","DS/VCXWebInteropSMG/VCXSmgLoaderModifiableFactory","DS/VCXWebInteropSMG/VCXSmgLoaderPropertiesModifiableBomManager","DS/VCXWebSequenceManager/VCXCmdChangeSequence","DS/VCXWebSequenceManager/VCXCmdChangeScenarioSequence","DS/VCXWebKernelCommands/VCXCmdChangeKeys","DS/VCXWebKernelCommands/VCXCmdChangeNeutralProperties","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebKernelCommands/VCXCmdGoToScenario","DS/VCXWebKernel/VCXCmdChangeMarker","DS/VCXWebKernelTools/VCXMeshServices","DS/VCXWebUnits/VCXUnitType","DS/VCXWebKernelTools/VCXLogServices"],function(w,o,t,F,k,g,c,q,v,B,s,z,y,A,x,l,D,E,h,u,j,b,a,f,m,G,C,r,n,p,e,d){var i=w.extend({init:function(){this._vcxViewport=null;this._vcxCompass=null;this._vcxBom=null;this._vcxBomInfo=null;this._vcxDigger=null;this._vcxScenarioAnimationSmg=null;this._mapGeodes=null;this._mapSequences={};this._resources=null;this._experienceBase=null;this._allPMIs=[];this._allPmisConstructionGeometries=[];this._modifiableFactory=new j();this._materialManager=null;this._documentProperties={};this._v1ComponentType={}},loadXMLDoc:function(H){var J;if(window.ActiveXObject){J=new ActiveXObject("Msxml2.XMLHTTP")}else{J=new XMLHttpRequest()}J.open("GET",H,false);try{J.responseType="msxml-document"}catch(I){}J.send("");return J.responseXML},loadXMLString:function(H){var I;if(window.DOMParser){var J=new DOMParser();I=J.parseFromString(H,"text/xml")}else{I=new ActiveXObject("Microsoft.XMLDOM");I.async=false;I.loadXML(H)}return I},xmlToJson:function(J){var N={};if(J.nodeType===1){if(J.attributes.length>0){N["@attributes"]={};for(var I=0;I<J.attributes.length;I++){var M=J.attributes.item(I);N["@attributes"][M.nodeName]=M.nodeValue}}}else{if(J.nodeType===3){N=J.nodeValue}}if(J.hasChildNodes()){for(var K=0;K<J.childNodes.length;K++){var L=J.childNodes.item(K);var O=L.nodeName;if(typeof(N[O])==="undefined"){N[O]=this.xmlToJson(L)}else{if(typeof(N[O].push)==="undefined"){var H=N[O];N[O]=[];N[O].push(H)}N[O].push(this.xmlToJson(L))}}}return N},getNodes:function(I){if(I===undefined){return[]}if(I instanceof Array){return I}var H=[];H.push(I);return H},getServerFromType:function(L,I){var K=[];for(var H=0;H<L.length;H++){var J=L[H];if(J["@attributes"].Type===I){K.push(J)}}return K},concatArray:function(J){if(J instanceof Array){var I="";for(var H=0;H<J.length;H++){I+=J[H]}J=I}return J},createGroupSelectionSet:function(R){var N=R["@attributes"];var J=N.Name;var O=N.Ident;var P=this._experienceBase.Factory.BuildComponent("VCXComponentGroupSelectionSet");P.SetID(O);this._experienceBase.ComponentsMap.AddComponent(P);var Q=[];var K=this.getNodes(R.CLitSelection);for(var L=0;L<K.length;L++){var M=this.createSelectionSet(K[L]);if(M){M.GroupID=O;Q.push(M.GetID())}}P.SetArrayActors(Q);P.SetName(J);var I=P.QueryInterface("VCXIModifiable");var H=new G(this._experienceBase.getManager("VCXScenarioManager"));H.CaptureNeutralProperties(I);this._experienceBase.getManager("VCXCommandManager").Do(H)},createSelectionSet:function(J){var N=J["@attributes"];var I=N.Name;var P=N.Ident;var L=this._experienceBase.Factory.BuildComponent("VCXComponentSelectionSet");L.SetID(P);this._experienceBase.ComponentsMap.AddComponent(L);var O=[];var K=J["#text"];if(K){O=this.concatArray(K).split("#");O.pop();var M=O.indexOf("-1");if(M!==-1){O[M]="VCX_RootSMG"}}L.SetName(I);L.SetArrayActors(O);var Q=L.QueryInterface("VCXIModifiable");var H=new G(this._experienceBase.getManager("VCXScenarioManager"));H.CaptureNeutralProperties(Q);this._experienceBase.getManager("VCXCommandManager").Do(H);return L},parseListSelection:function(J){console.log("PARSE SELECTION SETS");var L=this.getNodes(J.CLitSelection);var I=[];for(var K=0;K<L.length;K++){var H=L[K];var M=H.CLitSelection;if(M){this.createGroupSelectionSet(H)}else{this.createSelectionSet(H)}}},parseDocumentSMGXML:function(ak){var T=ak["@attributes"];var H=T.VersionSeemage;var aO=parseFloat(H);if(aO<7){var aS="";var aj=this._experienceBase.getManager("VCXNLSManager");if(aj){var aI=aj.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]);aS=aI?aI.getTitle({key:"Notification.UnsupportedVersion"}):"CATNLS error"}var aH={level:"warning",title:"Warning",message:aS,};this._experienceBase.getManager("VCXContextManager").addNotification(aH)}this._mapSequences={};this._allPMIs=[];var al=ak.Server;var ah=this.getServerFromType(al,"CLitIOManager");for(var aw in ah[0]){if(ah[0][aw]["@attributes"]){this._documentProperties[aw]=ah[0][aw]["@attributes"]}}var aD=this.getServerFromType(al,"PropertyDefinitions");for(var aM=0;aM<aD.length;aM++){var ay=aD[aM];this.parseMetaPropertyDefinitions(ay)}var af=30;var O=5;var Q=this.getServerFromType(al,"CLitKKeyframer");var ae=Q[0];if(ae&&ae.Play&&ae.Play["@attributes"]){if(ae.Play["@attributes"].FPS){af=parseFloat(ae.Play["@attributes"].FPS)}if(ae.Play["@attributes"].InterFramesMax){O=parseInt(ae.Play["@attributes"].InterFramesMax)}}var S=1000;var L=this.getServerFromType(al,"CLitViewportManager");var au=L[0];if(au&&au.CameraSmoothTime&&au.CameraSmoothTime["@attributes"]){if(au.CameraSmoothTime["@attributes"].Value){S=parseFloat(au.CameraSmoothTime["@attributes"].Value)*2}}var K=new s(O);var P=new v(new x("ScenarioManager.InterFramesMax",2),K);var aR=new B(af);var aA=new v(new x("ScenarioManager.FPS",2),aR);var ar=new B(S);var aP=new v(new x("ScenarioManager.TransitionTime",2),ar);var aQ=this._experienceBase.getManager("VCXScenarioManager");var ax=aQ.QueryInterface("VCXIModifiable");var az=new C(aQ,this._experienceBase.getManager("VCXCommandManager"),true);az.ChangeProperty(ax,aA);az.ChangeProperty(ax,P);az.ChangeProperty(ax,aP);this._experienceBase.getManager("VCXCommandManager").Do(az);aQ.SetCurrentFrame(0);this._experienceBase.getManager("VCXGUIManager").InitGUI();var Z=this._experienceBase.getManager("VCXExperience");Z.InitImagePanels();var am=this._experienceBase.Factory.BuildComponent("VCXScenarioSequence");var I=am.QueryInterface("VCXIModifiable");var ap="";var aj=this._experienceBase.getManager("VCXNLSManager");if(aj){var aI=aj.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]);ap=aI.getTitle({key:"Sequence.Animation"})}am.SetName(ap);am.SetSequenceType(0);var at=new G(this._experienceBase.getManager("VCXScenarioManager"));at.CaptureNeutralProperties(I);this._experienceBase.getManager("VCXCommandManager").Do(at);var N=this._experienceBase.getManager("VCXSequenceManager");var aL=new a(N,this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);aL.PushSequence(am);this._experienceBase.getManager("VCXCommandManager").Do(aL);var ag=this._experienceBase.Factory.BuildComponent("VCXScenario");var X=ag.QueryInterface("VCXIModifiable");ag.SetID("AnimationSmgID");ag.SetName("Animation smg");ag.SetScenarioType(c.EScenarioType.Scenario);this._vcxScenarioAnimationSmg=ag;var M="image.bmp";var ad=this._resources[M];var J=this._experienceBase.getManager("VCXDocManager").BuildPathFromString(ad,M);if(J){var ac=this._experienceBase.getManager("VCXDocManager").AddOrModifyDoc(J);X.OnChangeProperty("Actor.DocID",ac)}var aK=new f(N,this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);aK.PushScenarioInSequence(ag,am.GetID());this._experienceBase.getManager("VCXCommandManager").Do(aK);var aC=new r(aQ,this._experienceBase.getManager("VCXCommandManager"));aC.GoToScenario(ag.GetID());this._experienceBase.getManager("VCXCommandManager").Do(aC);var aa=this.getServerFromType(al,"CLitKKeyframer");this.parseMarkers(aa[0],ag);var aF=this.getServerFromType(al,"CLitServerModifiable");this._layerAnimation=aF[0].CLitViewport?aF[0].CLitViewport.CLitView:null;this.parseServerModifiable(aF[0],ag);var ao=this.getServerFromType(al,"CLitKBOMManager");if(this._experienceBase.getManager("VCXComponentBomManager")){var ab=this._experienceBase.getManager("VCXComponentBomManager").QueryInterface("VCXIModifiable");var W=this._modifiableFactory.createPropertiesMap(ab,this._experienceBase,ao[0],this._experienceBase.ComponentsMap,this._resources,"CLitKBOMManager");W.forEach(function(aU,aW){var aT=aW;var aV=aU;ab.OnChangeProperty(aT,aV)})}var aq=this.getServerFromType(al,"CLitPaperOutputManager");for(var aM=0;aM<aq.length;aM++){var V=aq[aM];var aE=this._experienceBase.getManager("VCXPaperManager");if(aE){if(V["Vectorize.Paper.Width"]){aE.SetWidth(parseFloat(V["Vectorize.Paper.Width"]["@attributes"]["Value"]))}if(V["Vectorize.Paper.Height"]){aE.SetHeight(parseFloat(V["Vectorize.Paper.Height"]["@attributes"]["Value"]))}if(V["Vectorize.Paper.Landscape"]){aE.SetOrientation(parseInt(V["Vectorize.Paper.Landscape"]["@attributes"]["Value"]))}}}var an=this._experienceBase.getManager("VCXUnitManager");if(an){var U=this.getServerFromType(al,"CLitUnitManager");for(var aM=0;aM<U.length;aM++){var R=U[aM];if(R){for(var aG in R){if(aG.substring(0,5)==="Unit."){var ai=aG.substring(5);var aB=an.getUnitType(ai);if(aB){var av=R[aG];aB.Precision=parseInt(av["@attributes"]["Precision"]);aB.SymbolDisplay=parseInt(av["@attributes"]["ShowName"]);aB.DisplayUnit=i.unitsTranslation[ai][av["@attributes"]["Range"]];aB.InternUnit=i.unitsTranslation[ai][av["@attributes"]["RangeLitToSI"]];switch(av["@attributes"]["Separator"]){case"44":aB.LanguageDisplay=e.ELanguageDisplay.fr;break;case"46":aB.LanguageDisplay=e.ELanguageDisplay.en;break;case"59":aB.LanguageDisplay=e.ELanguageDisplay.local;break}}}}}}}var aD=this.getServerFromType(al,"PropertyDefinitions");for(var aM=0;aM<aD.length;aM++){var ay=aD[aM];this.parseMetaPropertyDefinitions(ay)}var aN=this.getServerFromType(al,"CLitList");for(var aM=0;aM<aN.length;aM++){var Y=aN[aM];if(Y.CLitSelection){this.parseListSelection(Y)}else{if(Y.CLitView){this.parseViews(Y)}}}var aJ=this._documentProperties.LaunchAction;if(aJ&&aJ.Value==="1"){this._experienceBase.getManager("VCXExperience").SetViewMode(1)}if(this._experienceBase.getManager("VCXHotspotManager")){this._experienceBase.getManager("VCXHotspotManager").UpdateHotspotsHyperlinks()}if(this._experienceBase.getManager("SUIManager")){this._experienceBase.getManager("SUIManager").syncCameraSystemModifiables()}o.publish({event:"VCX_REFRESH_ICON",data:ag});o.publish({event:"VCX_KEYS_CHANGED"})},parseMarkers:function(ac,Q){if(ac===undefined||ac.Markers===undefined){return}if(ac.Markers.CLitMarker){}else{return}var I=[];if(ac.Markers.CLitMarker.length){I=ac.Markers.CLitMarker}else{I.push(ac.Markers.CLitMarker)}var V=this._experienceBase.getManager("VCXCommandManager");var W=new n(this._experienceBase.getManager("VCXScenarioManager"),V,this._experienceBase.ComponentsMap);var U=new C(this._experienceBase.getManager("VCXScenarioManager"),V,true);for(var Y=0;Y<I.length;Y++){var N=I[Y];var L=N["@attributes"].Pos;var P=N["@attributes"].Label;var aa=N["@attributes"].Milestone;var X=P+"_"+L;var K=this._experienceBase.Factory.BuildComponent("VCXComponentMarker");K.SetID(X);W.AddMarkerToScenario(K,Q,parseInt(L,10));var Z=new s();Z.FromString(L);var S=new v(new x("Actor.TimePos",2),Z);var ab=new z(P);var T=new v(new x("Actor.Name",2),ab);var R=new A();R.FromString(aa);var H=new v(new x("Actor.IsMilestone",2),R);var J=K.QueryInterface("VCXIModifiable");U.ChangeProperty(J,S);U.ChangeProperty(J,T);U.ChangeProperty(J,H)}V.Do(U);V.Do(W);var O=Q.QueryInterface("VCXIModifiable");var M=new G(this._experienceBase.getManager("VCXScenarioManager"));M.CaptureNeutralProperties(O);this._experienceBase.getManager("VCXCommandManager").Do(M)},parseMetaPropertyDefinitions:function(J){var L=J.MetaProperties;var O=this.getNodes(L.Meta);for(var M=0;M<O.length;M++){var I=O[M];var N="VCXPropertyValueString";switch(I["@attributes"].Type){case"String":N="VCXPropertyValueString";break;case"Bool":N="VCXPropertyValueBoolean";break;case"Color":N="VCXPropertyValueColor";break;case"Date":N="VCXPropertyValueDate";break;case"Float":N="VCXPropertyValueFloat";break;case"Int":N="VCXPropertyValueInt";break;default:N="VCXPropertyValueString";break}var H=new x(I["@attributes"].Name,0,true);if(I["@attributes"].Bounded==="1"){if(N="VCXPropertyValueInt"){H.SetBounds(parseInt(I["@attributes"].MinValue),parseInt(I["@attributes"].MaxValue))}else{if(N="VCXPropertyValueFloat"){H.SetBounds(parseFloat(I["@attributes"].MinValue),parseFloat(I["@attributes"].MaxValue))}}}H.SetGroupId("Group.UserProperties");H.SetNlsPathGroup("VCXWebModifiables/VCXWebModifiables");var K=new u(H,N);K.SetDefaultLabel(I["@attributes"].DefaultLabel);H.SetMetaPropertyDef(K);this._experienceBase.getManager("VCXMetaPropertyManager").AddMetaPropertyDef(K)}},parseViews:function(J){d.memoryLog("VCXSmgXmlLoader parseViews",true);var H=this.getNodes(J.CLitView);for(var I=0;I<H.length;I++){this.parseView(H[I])}d.memoryLog("VCXSmgXmlLoader parseViews",false)},parseView:function(ah){var ai=ah["@attributes"];if(ai.IsUsedByUpdatableCapture==="1"){return}var M=this._experienceBase.Factory.BuildComponent("VCXScenario");var ak=ai.Ident;if((ai.Type===i.ViewType.CadViews)||(ai.Type===i.ViewType.CadCaptures)){ak=ak+ai.Type}M.SetID(ak);if(!(ai.AppliedToObject==="1"&&ai.AppliedToProperties==="1"&&ai.AppliedToSelection==="0")){M.SetApplyNeutralAtGoToScenario(false)}var W=(ai.AppliedZoomFitAll==="1")||(ai.Type===i.ViewType.CadViews);M.SetZoomFitAll(W);var ab=(ai.Type===i.ViewType.CadViews);if(!ab){if(ah.Neutral){var V=ah.Neutral["CADView.AppliedToPMIOnly"];if(V){var U=V["@attributes"];if(U){ab=U.Value==="1"}}}}var L="view"+ai.Ident+".jpg";var ao=this._resources[L];var P=M.QueryInterface("VCXIModifiable");var I=this._experienceBase.getManager("VCXDocManager").BuildPathFromString(ao,L);if(I){var S=this._experienceBase.getManager("VCXDocManager").AddOrModifyDoc(I);P.OnChangeProperty("Actor.DocID",S)}var ae="Unknown";var ax=c.EScenarioType.Scenario;if(ai.Type===i.ViewType.Views){ae="Views"}else{if(ai.Type===i.ViewType.Layers){ae="Layers";ax=c.EScenarioType.Layer}else{if(ai.Type===i.ViewType.CadViews){ae="CADViews";ax=c.EScenarioType.CADView}else{if(ai.Type===i.ViewType.CadCaptures){ae="CADCaptures";ax=c.EScenarioType.CADCapture}}}}var Z=this._experienceBase.getManager("VCXNLSManager");if(Z){var am=Z.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]);ae=am.getTitle({key:"Sequence."+ae})}M.SetName(ai.Name);M.SetScenarioType(ax);this.parseViewVisibility(M,ah,ab);if(!ab&&ai.AppliedToObject==="1"&&ai.AppliedToVisibility==="1"&&ai.AppliedToSelection!=="1"){if(this._documentProperties["View.VisibleBehavior"]){switch(this._documentProperties["View.VisibleBehavior"].Value){case i.ViewCompressionV1.VisibleActors:case i.ViewCompressionV1.VisibleAssemblies:M.GetVisibility().SetMode(1);M.GetVisibility().AddVisibleToGroups(this._experienceBase.getManager("VCXContextManager").getRootComponent());break;case i.ViewCompressionV1.HiddenActors:case i.ViewCompressionV1.HiddenAssemblies:M.GetVisibility().SetMode(2);break;default:M.GetVisibility().SetMode(0);break}}else{M.GetVisibility().SetMode(1);M.GetVisibility().AddVisibleToGroups(this._experienceBase.getManager("VCXContextManager").getRootComponent())}}var ac=new G(this._experienceBase.getManager("VCXScenarioManager"));ac.CaptureNeutralProperties(P);this._experienceBase.getManager("VCXCommandManager").Do(ac);if(!this._vcxCamera){this._vcxCamera=this.createCamera();this._experienceBase.getManager("VCXContextManager").setActiveCamera(this._vcxCamera)}var R=ah.Camera;if(R){var af=this.getNodes(R.CLitModifiable);for(var T=0;T<af.length;T++){this.addModifiableNodeToView(M,af[T],null)}}else{var ag=ah.Navigator;if(ag!==undefined){var av=this._vcxCamera.QueryInterface("VCXIModifiable");this.addModifiableToView(M,av,ag)}}if(ah.Navigator!==undefined&&this._vcxCompass){var ad=this._vcxCompass.QueryInterface("VCXIModifiable");this.addModifiableToView(M,ad,ah.Navigator)}var aj=ah.Viewport;if(aj&&this._vcxViewport){var N=this._vcxViewport.QueryInterface("VCXIModifiable");this.addModifiableToView(M,N,aj)}var aq=ah.Configuration;if(aq){var au=this.getNodes(aq.CLitModifiable);if(au!==undefined){for(var at=0;at<au.length;at++){var K=au[at];this.addModifiableNodeToView(M,K)}}}var X=ah.BOMInfo;if(X!==undefined){var al=this._vcxBomInfo.QueryInterface("VCXIModifiable");this.addModifiableToView(M,al,X)}var J=ah.Digger;var ai=ah["@attributes"];if(J!==undefined&&ai&&ai.AppliedToDigger==="1"){var aa="VCX_Digger.-1";var ar=null;var aw=this._experienceBase.ComponentsMap.GetComponentFromID(aa);if(aw){}else{aw=this._modifiableFactory.create(this._experienceBase,"CLitDigger",aa,undefined);this._v1ComponentType[aa]="CLitDigger"}if(aw){ar=aw.QueryInterface("VCXIModifiable")}if(ar){this.addModifiableToView(M,ar,J);ar.loadParentMode="DigZoom";this.addModifiableToView(M,ar,ah.DigZoom);ar.loadParentMode="DigOnionSkin";this.addModifiableToView(M,ar,ah.DigOnionSkin);ar.loadParentMode="DigXRay";this.addModifiableToView(M,ar,ah.DigXRay);if(J["Inspector.Enabled"]){var O=J["Inspector.Enabled"]["@attributes"];if(O.Value==="1"){var Q=M.GetVisibility();Q.AddVisibleCollab(aw)}}}}var Y=this._mapSequences[ae];if(!Y){Y=this._experienceBase.Factory.BuildComponent("VCXScenarioSequence");var H=Y.QueryInterface("VCXIModifiable");Y.SetName(ae);Y.SetSequenceType(ax);var ac=new G(this._experienceBase.getManager("VCXScenarioManager"));ac.CaptureNeutralProperties(H);this._experienceBase.getManager("VCXCommandManager").Do(ac);var ap=new a(this._experienceBase.getManager("VCXSequenceManager"),this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);ap.PushSequence(Y);this._experienceBase.getManager("VCXCommandManager").Do(ap);this._mapSequences[ae]=Y}if(Y){var an=new f(this._experienceBase.getManager("VCXSequenceManager"),this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);an.PushScenarioInSequence(M,Y.GetID());this._experienceBase.getManager("VCXCommandManager").Do(an)}},parseActorList:function(N){if(N!==undefined){var J=[];var L=N["#text"];if(L!==undefined){var K=this.concatArray(L).split("#");K.pop();for(var I=0;I<K.length;I++){var H=K[I];if(H==="-1"){H="VCX_RootSMG"}var M=new y(H);J.push(M)}}if(J.length){return new l(J)}}return null},parseViewVisibility:function(ac,S,L){if(!S){return}var P=ac.GetVisibility();if(!P){return}if(L){P.SetMode(0);P.AddInvisibles(this._allPMIs.slice(0).concat(this._allPmisConstructionGeometries.slice(0)))}else{if(!ac.GetApplyNeutralAtGoToScenario()){P.SetMode(0)}else{var W=ac.QueryInterface("VCXIModifiable");var V=new D();if(this._documentProperties["View.VisibleBehavior"]){switch(this._documentProperties["View.VisibleBehavior"].Value){case i.ViewCompressionV1.VisibleActors:case i.ViewCompressionV1.VisibleAssemblies:V.SetValue(1);P.AddVisibleToGroups(this._experienceBase.getManager("VCXContextManager").getRootComponent());break;case i.ViewCompressionV1.HiddenActors:case i.ViewCompressionV1.HiddenAssemblies:V.SetValue(2);break;default:P.SetMode(0);break}}else{V.SetValue(1);P.AddVisibleToGroups(this._experienceBase.getManager("VCXContextManager").getRootComponent())}var Q=new G(this._experienceBase.getManager("VCXScenarioManager"));Q.ChangeProperty(W,"Scenario.Visibility.Mode",V);this._experienceBase.getManager("VCXCommandManager").Do(Q)}}var M=S.Living;if(M!==undefined){var I=M["#text"];if(I!==undefined){var ab=this.concatArray(I).split("#");for(var U=0;U<ab.length;U++){var T=ab[U];if(T==="-1"){T="VCX_RootSMG"}var R=this._experienceBase.ComponentsMap.GetComponentFromID(T);if(R){if(R.IsKindOf("VCXWebComponentOccurrence")&&!R.IsDressup){if(L){P.RemoveInvisible(R)}P.AddVisibleToDescendants(R)}else{P.AddVisibleCollab(R)}}}}}var aa=S.Invisible;if(aa!==undefined){var J=aa["#text"];if(J!==undefined){var X=this.concatArray(J).split("#");for(var H=0;H<X.length;H++){var O=X[H];if(O==="-1"){O="VCX_RootSMG"}var R=this._experienceBase.ComponentsMap.GetComponentFromID(O);if(R){P.AddInvisibleToDescendants(R)}}}}if(this._vcxCompass){var K=S.Navigator;if(K===undefined){K=S}if(K!==undefined){var N=K["Navigator.Compass.Visibility"];if(N!==undefined){var Y=N["@attributes"];if(Y!==undefined){if(Y.Value==="0"||Y.Value==="false"){P.AddInvisible(this._vcxCompass)}else{P.AddVisibleCollab(this._vcxCompass)}}}}}if(this._vcxDigger){var Z=S;if(Z!==undefined&&Z.Tracks&&Z.Tracks.Track){P.AddVisibleCollab(this._vcxDigger)}}},addModifiableToView:function(H,J,N){if(J){var K=J.GetObject().GetID();var I=this._v1ComponentType[K];var M=this._modifiableFactory.createPropertiesMap(J,this._experienceBase,N,this._resources,I);var L=new m(this._experienceBase.getManager("VCXScenarioManager"));L.SetLockEvents(true);L.SetLockUpdateProperties(true);L.SetCloneValues(false);M.forEach(function(P,R){var O=R;var Q=P;L.ChangeKey(H,J,O,parseFloat(0),Q)});this._experienceBase.getManager("VCXCommandManager").Do(L)}},addModifiableNodeToView:function(H,M){if(M!==undefined){var I=M["@attributes"];var L=I.Ident;var K=this._experienceBase.ComponentsMap.GetComponentFromID(L);if(K){var J=K.QueryInterface("VCXIModifiable");this.addModifiableToView(H,J,M)}else{console.log("Can't find component "+L)}}},parseServerModifiable:function(V,I){var ad=this._experienceBase.getManager("VCXContextManager").getRootNode();var L=this._experienceBase.getManager("VCXContextManager").getRootComponent();var N=V.CLitAssyRoot;if(N===undefined){N=V}var U=L.QueryInterface("W3AISGNodeHolder").getPathElement().clone();var Z="";if(N!==undefined){this._experienceBase.getManager("VCXContextManager").setActiveBOM(this._vcxBom);d.memoryLog("VCXSmgXmlLoader Build Actors",true);Z="";this.parseAssyGroup(N,Z,ad,U,true,true,L);d.memoryLog("VCXSmgXmlLoader Build Actors",false);d.memoryLog("VCXSmgXmlLoader Fill neutrals and tracks",true);Z="";this.parseAssyGroup(N,Z,ad,U,true,false,L);d.memoryLog("VCXSmgXmlLoader Fill neutrals and tracks",false)}var Y=V.CLitVectorImageBOM;if(Y!==undefined){U=new t();var X="";this._vcxBom=this.parseAnnotations("CLitVectorImageBOM",Y,X,U,true);this.parseAnnotations("CLitVectorImageBOM",Y,X,U,false);this._experienceBase.getManager("VCXContextManager").setActiveBOM(this._vcxBom)}var K=V.CLitBOMInfo;if(K!==undefined){U=null;var J="CLitBOMInfoId";this._vcxBomInfo=this.parseAnnotations("CLitBOMInfo",K,J,U,true);this.parseAnnotations("CLitBOMInfo",K,J,U,false)}var R=V.CLitActorGround;if(R!==undefined){U=new t();var W="";this._vcxGround=this.parseAnnotations("CLitActorGround",R,W,U,true);this.parseAnnotations("CLitActorGround",R,W,U,false);this._experienceBase.getManager("VCXContextManager").setActiveGround(this._vcxGround)}var ab=V.CLitViewport;if(ab!==undefined){U=new t();var T="";this._vcxViewport=this.parseAnnotations("CLitViewport",ab,T,U,true);this.parseAnnotations("CLitViewport",ab,T,U,false)}if(ab!==undefined&&ab.CLitNavigator&&ab.CLitNavigator!==undefined){U=new t();var ae="VCX_Compass";this._vcxCompass=this.parseAnnotations("CLitActorCompass",ab.CLitNavigator,ae,U,true);this.parseAnnotations("CLitActorCompass",ab.CLitNavigator,ae,U,false)}var aa=ab!==undefined?ab.CLitDigger:undefined;if(aa!==undefined&&aa.Tracks&&aa.Tracks.Track){U=new t();var P="VCX_Digger";this._vcxDigger=this.parseAnnotations("CLitDigger",aa,P,U,true);this.parseAnnotations("CLitDigger",aa,P,U,false)}var af=this.getNodes(V.CLitCameraActor);for(var H=0;H<af.length;H++){U=new t();var Q="";if(!this._vcxCamera){this._vcxCamera=this.parseAnnotations("CLitCameraActor",af[H],Q,U,true)}this.parseAnnotations("CLitCameraActor",af[H],Q,U,false);this._experienceBase.getManager("VCXContextManager").setActiveCamera(this._vcxCamera)}var ab=V.CLitViewport;if(ab!==undefined){if(!this._vcxCamera){var M=ab.CLitNavigator;if(M!==undefined){this.parseNavigator(M)}}var ac=false;var S=ab.CLitView;this.parseViewVisibility(I,S,ac);if(ab.CLitNavigator!==undefined){this.parseViewVisibility(I,ab.CLitNavigator.Neutral,ac)}this.parseViewVisibility(I,ab.CLitDigger,ac)}var O=this.getNodes(V.CLitSelectionHotSpot);this.parseHotSpots(O)},parseHotSpots:function(I){console.log("PARSE HOTSPOTS");for(var H=0;H<I.length;H++){var J=I[H]["CLitSelectionHotSpot"];if(J){this.createGroupHotspot(I[H])}else{this.createHotspot(I[H])}}},createGroupHotspot:function(K){var L=K["@attributes"];var J=L.Ident;var P=this._experienceBase.Factory.BuildComponent("VCXComponentGroupHotspot");P.SetID(J);this._experienceBase.ComponentsMap.AddComponent(P);var R=K.CLitSelectionHotSpot;if(R){var N=[];for(var M=0;M<R.length;M++){var I=R[M];var S=this.createHotspot(I);S.GroupID=J;N.push(S.GetID())}var O=L.Name;P.SetName(O);P.SetArrayActors(N);var Q=P.QueryInterface("VCXIModifiable");var H=new G(this._experienceBase.getManager("VCXScenarioManager"));H.CaptureNeutralProperties(Q);this._experienceBase.getManager("VCXCommandManager").Do(H)}},createHotspot:function(I){var L=I["@attributes"];var J=L.Ident;this.parseAnnotations("CLitSelectionHotSpot",I,"",null,true);var R=this._experienceBase.ComponentsMap.GetComponentFromID(J);if(R){var K=I.Actors;if(K){var M=K["#text"];if(M){var P=this.concatArray(M).split("#");P.pop();var N=P.indexOf("-1");if(N!==-1){P[N]="VCX_RootSMG"}}}var O=L.Name;R.SetName(O);R.SetArrayActors(P);var Q=R.QueryInterface("VCXIModifiable");var H=new G(this._experienceBase.getManager("VCXScenarioManager"));H.CaptureNeutralProperties(Q);this._experienceBase.getManager("VCXCommandManager").Do(H)}this.parseAnnotations("CLitSelectionHotSpot",I,"",null,false);return R},parseAssyGroup:function(H,aa,Z,V,ab,ae,ad){var P=H["@attributes"];if(!ab){if(aa===""){aa=P.Ident}else{aa=aa+"."+P.Ident}}var Y=null;var S=null;if(ae){VCXStatNb3DNodes++;Y=new k(P.Ident);Y.productType="Instance3D";Z.add(Y);V.addElement(Y);var M=aa;if(aa===""){M="VCX_RootSMG"}S=this._modifiableFactory.create(this._experienceBase,"CLitAssyGroup",M,V,ad);if(S&&aa===""){S.SetPersistency(1)}}else{var ac=aa;if(ac===""){ac="VCX_RootSMG"}S=this._experienceBase.ComponentsMap.GetComponentFromID(ac);if(S){var I=S.QueryInterface("VCXIModifiable");this.parseNeutrals(H,I,"CLitAssyGroup");this.parseTracks(H,I,"CLitAssyGroup");if(ab&&I){var U=I.GetProperty("Actor.Name");if(U){var J=U.GetPropertyValue();if(J.GetValue()==="-1"){var O=new z();O.SetValue("Root");I.OnChangeProperty("Actor.Name",O)}}}}var W=this.getNodes(H.CLitCADView);for(var T=0;T<W.length;T++){this.parseView(W[T])}}for(var X in this._modifiableFactory.getV1Ids()){var L=this.getNodes(H[X]);if(!L.length){continue}switch(X){case"CLitAssyGroup":for(var R=0;R<L.length;R++){this.parseAssyGroup(L[R],aa,Y,V.clone(),false,ae,S)}break;case"CLitActorMesh":case"CLitActor":case"CLitActorCurveWire":case"CLitActorPoint":case"CLitActorPrim":case"CLitActorCompositePmi":case"CLitRedline":for(var K=0;K<L.length;K++){this.parseActor(L[K],X,aa,Y,V.clone(),ae,S)}break;default:for(var K=0;K<L.length;K++){this.parseAnnotations(X,L[K],aa,V.clone(),ae)}break}}if(ae){var Q=P.NeutralVisibility;if(Q==="0"&&this._vcxScenarioAnimationSmg){if(!this._layerAnimation){var N=this._vcxScenarioAnimationSmg.GetVisibility();if(N){N.AddInvisible(S)}}}}},getActorCompositePmiArray:function(U,Y){var H=U[Y];if(!H){return null}if(H.Data===undefined){if(Y==="points"){var O=[];for(var X in H){if(X!=="@attributes"){var R=H[X]["@attributes"];if(R){O.push(parseFloat(R.X));O.push(parseFloat(R.Y));O.push(parseFloat(R.Z))}}}return O}else{var T=[];for(var X in H){if(X!=="@attributes"){var R=H[X]["@attributes"];if(R){T.push(parseFloat(R.Value))}}}return T}}else{var K=H["@attributes"];if(!K){return null}var S=parseInt(K.size);var V=H.Data["@attributes"];if(!V){return null}var W=atob(V.Value);var L=new ArrayBuffer(W.length);for(var M=0;M<W.length;M++){L[M]=W.charCodeAt(M)}var N=new DataView(L);for(var M=0;M<W.length;M++){N.setUint8(M,W.charCodeAt(M))}var Q=0;if(Y==="points"){var O=new Float32Array(S*3);for(var M=0;M<S;M++){var J=3*M;O[J]=N.getFloat32(Q++*4,true);O[J+1]=N.getFloat32(Q++*4,true);O[J+2]=N.getFloat32(Q++*4,true)}return O}else{var I=new Uint32Array(S);for(var M=0;M<S;M++){I[M]=N.getUint32(Q++*4,true)}return I}}},parseActorCompositePmiRepresentation:function(M){VCXStatNb3DNodes++;var W=new k();var I=this.parseDrawPolyline(M);if(I!==null){W.add(I);I.productType="InstanceRep";I.setPickParent(true)}var K=this.getNodes(M.CLitDrawSurface);for(var X=0;X<K.length;X++){var J=K[X];var N=this.getActorCompositePmiArray(J,"points");var R=this.getActorCompositePmiArray(J,"triangles");var P=this.getActorCompositePmiArray(J,"indices");var U=this.getActorCompositePmiArray(J,"types");var Q=new Float32Array(3*N.length);for(var H=0;H<N.length;H++){var L=H*3;Q[L]=0;Q[L+1]=0;Q[L+2]=1}var V=p.buildIndexation(N,R,U,P);if(V.length%3!==0){console.log("Invalid indexation")}var T=V.length/3;if(T){var S=null;if(this._materialManager){S=this._materialManager.getMaterialBasic(new F.Color(0,0,0),1)}var O=p.buildIndexedTriangleSet(T,N,Q,null,V,V,null,null,S,false,true);W.add(O);O.setPickParent(true);O.productType="InstanceRep"}}return W},parseDrawPolyline:function(K,I){var Z=this.getNodes(K.CLitDrawPolyline);if(I){var J=new Uint32Array(Z.length);var T=[];var Q=0;for(var M=0;M<Z.length;M++){var S=Z[M];if(S===undefined){continue}var W=this.getActorCompositePmiArray(S,"points");if(W===null){continue}var ab=new ArrayBuffer(W.length*4);var H=new Float32Array(ab);for(var X=0;X<W.length;++X){H[X]=W[X]}var P=new Uint8Array(ab);var U=P.toString();var I=window.btoa(U);T.push(I)}return T}else{var J=new Uint32Array(Z.length);var R=[];var Q=0;for(var M=0;M<Z.length;M++){var S=Z[M];if(S===undefined){continue}var aa=this.getActorCompositePmiArray(S,"points");if(aa===null){continue}for(var Y=0;Y<aa.length;Y++){R[Q++]=aa[Y]}J[M]=aa.length/3}var L=R.length/3;var N=p.allocIndexationArray(L,L);for(var V=0;V<L;V++){N[V]=V}var O=new Float32Array(R.length);for(var Y=0;Y<R.length;++Y){O[Y]=R[Y]}return p.buildLineStripSet(O,J,N,new g.Color(0,0,0,1),1,"WIRE_EDGE")}return null},parseActor:function(K,X,af,aa,W,ai,ah){var P=K["@attributes"];if(af===""){af=P.Ident}else{af=af+"."+P.Ident}var U=null;var Z=null;if(ai){VCXStatNb3DNodes++;Z=new k(P.Ident);Z.productType="Instance3D";aa.add(Z);W.addElement(Z);U=this._modifiableFactory.create(this._experienceBase,X,af,W,ah);this._v1ComponentType[af]=X;if(!U){console.error("Failed to build VCX component")}var ad=null;var R=null;if(P.IdentGeom){var ag=this._mapGeodes.get(P.IdentGeom);if(ag){ad=ag.geode;R=ag.userdata}}switch(X){case"CLitActorMesh":case"CLitActor":case"CLitActorCurveWire":if(!ad){Z.name=P.Ident+" IdentGeom:"+P.IdentGeom+" not found"}if(R&&R.ucGeometryType===6){this._allPmisConstructionGeometries.push(U.GetID())}break;case"CLitActorPoint":Z.name="VCXPoint";ad=p.buildPoint([0,0,0],new g.Color(1,0,0,1),5,null);ad.setNoZ(true);break;case"CLitActorPrim":Z.name="VCXPrimitive";break;case"CLitRedline":this.generateAnchorsIdsArray(K);Z.name="VCXRedline";var I=true;var J=this.parseDrawPolyline(K,I);var H=U?U.QueryInterface("VCXIModifiable"):null;var Q=H?H.GetPropertyValue("Collab.VertexBuffers"):[];for(var ab=0;ab<J.length;++ab){var O=new h();O.SetValue(J[ab]);Q.SetValueAtIndex(ab,O)}H.OnChangeProperty("Collab.VertexBuffers",Q);break;case"CLitActorCompositePmi":Z.name="VCXFTA";Z.setNoZ(true);if(ad){ad.setMaterial(new F.MeshBasicMaterial({color:"#FFFFFF",side:F.DoubleSide,force:true,opacity:0}));ad.setPickParent(true);var ac=W.clone();ac.addElement(ad);Z.add(ad);var S=this._experienceBase.getManager("VCXContextManager").getSharedSceneGraphOverride(ac);if(S){S.setOpacity(0,true)}}var V=this.parseActorCompositePmiRepresentation(K);if(V){Z.add(V);V.setPickParent(true);var ak=[];ak[0]=V;var Y=K.MirroringRepresentations;if(Y){var ae=this.getNodes(Y.MirroringRepresentation);for(var al=0;al<ae.length;al++){var V=this.parseActorCompositePmiRepresentation(ae[al]);if(V){Z.add(V);V.setPickParent(true);V.setVisibility(false);ak[al+1]=V}}}if(U){U._representations=ak;this._allPMIs.push(U.GetID())}}break;default:break}if(ad){ad.productType="InstanceRep";Z.add(ad)}}else{U=this._experienceBase.ComponentsMap.GetComponentFromID(af);var H=U?U.QueryInterface("VCXIModifiable"):null;if(H){this.parseNeutrals(K,H,X);this.parseTracks(K,H,X);if(H._name===null){var N=new z();var ag=null;if(P.IdentGeom){ag=this._mapGeodes.get(P.IdentGeom)}var aj=ag?ag.name:"";N.SetValue(aj);H.OnChangeProperty("Actor.Name",N)}}}for(var X in this._modifiableFactory.getV1Ids()){var M=this.getNodes(K[X]);if(!M.length){continue}switch(X){case"CLitAssyGroup":for(var T=0;T<M.length;T++){this.parseAssyGroup(M[T],af,Z,W.clone(),false,ai,U)}break;case"CLitActorMesh":case"CLitActor":case"CLitActorCurveWire":case"CLitActorPoint":case"CLitActorPrim":case"CLitActorCompositePmi":case"CLitRedline":for(var L=0;L<M.length;L++){this.parseActor(M[L],X,af,Z,W.clone(),ai,U)}break;default:for(var L=0;L<M.length;L++){this.parseAnnotations(X,M[L],af,W.clone(),ai)}break}}},parseAnnotations:function(P,O,L,H,N){var K=O["@attributes"];if(L===""){L=K.Ident}else{if(K){L=L+"."+K.Ident}else{L=L}}if(N){var M=this._modifiableFactory.create(this._experienceBase,P,L,undefined);this._v1ComponentType[L]=P;return M}else{var M=this._experienceBase.ComponentsMap.GetComponentFromID(L);var J=M?M.QueryInterface("VCXIModifiable"):null;if(J){var I=null;if(O.ListActors){I=this.parseActorList(O.ListActors)}if(O.Dynamic||O.ListIdAnchor||(O.Neutral&&O.Neutral["Actor.Location"]&&!M.IsKindOf("VCXComponentGround")&&!M.IsKindOf("VCXComponentSection"))){this.generateAnchorsIdsArray(O)}this.parseNeutrals(O,J,P,I);this.parseTracks(O,J,P);if(O.CLitDigZoom!==undefined){var Q=O.CLitDigZoom;J.loadParentMode="DigZoom";this.parseNeutrals(Q,J,P);this.parseTracks(Q,J,P)}if(O.CLitDigXRay!==undefined){var Q=O.CLitDigXRay;J.loadParentMode="DigOnionSkin";this.parseNeutrals(Q,J,P);this.parseTracks(Q,J,P)}if(O.CLitDigOnionSkin!==undefined){var Q=O.CLitDigXRay;J.loadParentMode="DigXRay";this.parseNeutrals(Q,J,P);this.parseTracks(Q,J,P)}}}},generateAnchorsIdsArray:function(L){var J=[];if(L.ListIdAnchor&&L.ListIdAnchor.AnchorId){var H=L.ListIdAnchor.AnchorId;for(var I=0;I<H.length;++I){var N=L.ListIdAnchor.AnchorId[I]["@attributes"].Id;J.push(parseInt(N))}}else{if(L.Dynamic&&L.Dynamic.Anchor&&L.Dynamic.Anchor["#text"]){var M=L.Neutral;var O=L.Dynamic.Anchor["#text"].split("#");for(var I=0;I<O.length;++I){var N=O[I];if(N.length!==0&&parseInt(N)<1000&&M&&M["Anchor."+N]){J.push(parseInt(N))}}}else{if(L.Neutral["Actor.Location"]){J.push("Location")}}}L.Neutral.ArrayAnchorsIds=J;var K=[];if(L.Dynamic&&L.Dynamic.Anchor2D&&L.Dynamic.Anchor2D["#text"]){var M=L.Neutral;var O=L.Dynamic.Anchor2D["#text"].split("#");for(var I=0;I<O.length;++I){var N=O[I];if(N.length!==0&&parseInt(N)<1000&&M&&M["Anchor."+N]){K.push(parseInt(N))}}L.Neutral.Array2DAnchorsIds=K}},createCamera:function(){var I="CameraActorId";var H=this._modifiableFactory.create(this._experienceBase,"CLitCameraActor",I,undefined);this._v1ComponentType[I]="CLitCameraActor";if(H===null){return}return H},parseNavigator:function(I){this._vcxCamera=this.createCamera();this._experienceBase.getManager("VCXContextManager").setActiveCamera(this._vcxCamera);var H=this._vcxCamera.QueryInterface("VCXIModifiable");this.parseNeutrals(I,H,"CLitNavigator");this.parseTracks(I,H,"CLitNavigator")},parseNeutrals:function(K,H,R,Q){var M=K.Neutral;if(M===undefined){return}var T=new q();var U=K.Dynamic;if(M.ArrayAnchorsIds){var I=new E(M.ArrayAnchorsIds);var L=new x("Collab.ListAnchorsIDs",0);T.AddOrModifyProperty(new v(L,I))}if(M.Array2DAnchorsIds){var I=new E(M.Array2DAnchorsIds);var L=new x("Collab.List2DAnchorsIDs",0);T.AddOrModifyProperty(new v(L,I))}var N=this._modifiableFactory.createPropertiesMap(H,this._experienceBase,M,this._resources,R);N.forEach(function(X,Z){var W=Z;var Y=X;var V=new x(W,0);T.AddOrModifyProperty(new v(V,Y))});if(Q){var L=new x("Actor.ListActors",2);T.AddOrModifyProperty(new v(L,Q))}var P=H.GetObject();if(P.IsKindOf("VCXComponentDigger")){var S=new B();S.SetValue(0);var L=new x("Actor.Opacity",0);T.AddOrModifyProperty(new v(L,S))}else{if(P.IsKindOf("VCXComponentViewport")){var O=new A();O.SetValue(true);var L=new x("Environment.BackFaceCulling",1);T.AddOrModifyProperty(new v(L,O))}}var J=this._experienceBase.getManager("VCXScenarioManager");J.AddNeutrals(H,T)},parseTracks:function(I,L,K){var J=I.Tracks;if(J===undefined){return}var H=this.getNodes(J.Track);for(var M=0;M<H.length;M++){this.parseKeys(I,L,this.getNodes(H[M].Key),K)}},parseKeys:function(T,H,O,Q){if(O.length===0){return}var S=new m(this._experienceBase.getManager("VCXScenarioManager"));S.SetLockEvents(true);S.SetLockUpdateProperties(true);S.SetCloneValues(false);var W=this._experienceBase.getManager("VCXScenarioManager").GetScenarios();var I=this._experienceBase.getManager("VCXScenarioManager").GetCurrentScenario();var X=W[I];for(var V=0;V<O.length;V++){if(T.Neutral.ArrayAnchorsIds){var Y=T.Neutral.ArrayAnchorsIds;var U=Object.keys(O[V]);for(var R=0;R<U.length;++R){var J=U[R];if(!J.startsWith("Anchor.")){continue}var K=J.replace("Anchor.","");if(!Y.includes(K)){continue}}}this.parseKey(T,H,O[V],S,X,Q)}if(H.GetObject().IsKindOf("VCXComponentDigger")){var P=new B();P.SetValue(0);var L=P;var M=S._keysForDo.length;for(var V=0;V<M;V++){var Z=S._keysForDo[V];if(Z.propertyName!=="Actor.Opacity"){continue}if(L!==null){var N=Z.frame-1;if(N>=0){S.ChangeKey(X,H,Z.propertyName,N,L)}}L=Z.value}}this._experienceBase.getManager("VCXCommandManager").Do(S)},parseKey:function(H,J,L,N,K,I){var O=L["@attributes"].Time;var M=this._modifiableFactory.createPropertiesMap(J,this._experienceBase,L,this._resources,I);M.forEach(function(Q,S){var R=Q;if(R!==undefined){var P=S;var T=parseFloat(O);N.ChangeKey(K,J,P,T,R)}})},Load:function(J,O,M,K,I,N){var L=K?this.loadXMLDoc(window.URL.createObjectURL(M)):this.loadXMLString(M);var H=this.xmlToJson(L);L=null;this._mapGeodes=I.getMapGeodes();this._resources=N;this._experienceBase=J;this._materialManager=J?J.getManager("VCXMaterialManager"):null;d.memoryLog("VCXSmgXmlLoader parseDocumentSMGXML",true);this.parseDocumentSMGXML(H.DocumentSMG);d.memoryLog("VCXSmgXmlLoader parseDocumentSMGXML",false);this._mapGeodes=null;this._resources=null;this._experienceBase=null;this._materialManager=null;this._modifiableFactory.clear();this._modifiableFactory=null}});i.ViewType={Views:"1",Layers:"2",CadViews:"3",CadCaptures:"4"};i.ViewCompressionV1={VisibleActors:"0",HiddenActors:"1",VisibleAssemblies:"2",HiddenAssemblies:"3"};i.unitsTranslation={Length:{0:"Micrometers",1:"Millimeters",2:"Centimeters",3:"Decimeters",4:"Meters",5:"Inches",6:"Feet",7:"Yards",8:"Kilometers",},Area:{0:"SquareMicrometers",1:"SquareMillimeters",2:"SquareCentimeters",3:"SquareDecimeters",4:"SquareMeters",5:"SquareInches",6:"SquareFeet",7:"SquareYards"},Volume:{0:"CubicMicrometers",1:"CubicMillimeters",2:"CubicCentimeters",3:"CubicDecimeters",4:"CubicMeters",5:"CubicInches",6:"CubicFeet",7:"CubicYards"},Angle:{0:"Degrees",1:"Radians",2:"Grades"},};return i});define("DS/VCXWebInteropSMG/VCXSmgLoader",["UWA/Class","DS/VCXWebKernelTools/VCXFileServices","DS/VCXWebInteropSMG/VCXSmgGeomLoader","DS/VCXWebInteropSMG/VCXSmgXmlLoader","DS/VCXWebInteropSMG/VCXSmgLoaderTools","DS/VCXWebKernelTools/VCXLogServices","DS/VCXWebKernel/VCXDRMManager"],function(d,b,f,a,c,g,h){var e=d.extend({init:function(){this._progressBar=null;this._experienceProgressCB=null},hasExtension:function(k,j){var i=k.toLowerCase();return i.indexOf(j,k.length-j.length)!==-1},sendErrorNotification:function(i,m,n){if(!i){return}var l=i.getManager("VCXNLSManager");if(!l){return}var j=l.GetNLS(["VCXWebInteropSMG/VCXWebInteropSMG"]);var k=j?j.getTitle({key:n}):"CATNLS error";i.getManager("VCXContextManager").addNotification({level:m,title:m,message:k,})},LoadJsonForRightManager:function(k,j){if(!k){j(null);return}var l=this;var i=new FileReader();i.onload=function(){var m=i.result;var n=JSON.parse(m);j(n)};i.readAsText(k)},LoadSmgGeomOutlines:function(k,o,j,n,l,i){if(!j){i(null);return}var m=new FileReader();m.onload=function(p){var q=new f(k);var r=q.LoadOutlines(new Uint8Array(p.target.result));i(r)};m.readAsArrayBuffer(j)},LoadSmgGeom:function(p,l,o,m,j,q,k){if(!o){k(null);return}var n=this;var i=new FileReader();i.onload=function(s){var t=new f(p);t.setResources(j);t.setOutlines(m);t.launchsmgXMLCB=k;var r=t.Load(new Uint8Array(s.target.result));if(false===r){n.sendErrorNotification(p,"error","Notification.GeomLoadingFailed")}if(n._progressBar){n._progressBar.update("50%")}else{if(n._experienceProgressCB){n._experienceProgressCB({loaded:50,total:100})}}if(t&&t.ulHasSignature&&t.ulAgreementMode!==h.LitSignatureMode.LIT_SIGNATURE_NO_DISPLAY){t._pause=true}k(t)};i.readAsArrayBuffer(o)},LoadSmgXml:function(B,l,C,v,O,m){if(!C){m(null);return}if(!v){m(null);return}var D=true;var A=c.decodeOptions(v.ulWatermark,v.nTriangles)!==0;var u=[];for(var N=0;N<v.strFileNameAssociate.length;N++){u.push(v.strFileNameAssociate.charCodeAt(N))}var M=c.calcCRC(u);var z=c.decodeOptions(v.ulHasExpirationDate,M);var w=c.decodeOptions(v.ulStartDate,M);var E=c.decodeOptions(v.ulEndDate,M);var t=Date.now()/1000;var P=true;if(z!==0){P=((t<E)&&(t>w))}var q=c.decodeOptions(v.ulSignatureCRC,M);var J=v.strAgreement;var o=v.strSignaturePicturePath;var p=v.ulAgreementMode;var x=v.ulHasSignature!==0;var s=(x?"1":"2")+": "+o+" ["+J+"]-"+(p+1);var H=[];for(var N=0;N<s.length;N++){H.push(s.charCodeAt(N))}var k=c.calcCRC(H);var Q=k&q;var F=(Q===k||Q===q);F=true;var j=1<<5;var y=c.decodeOptions(v.ulOptionsPro,v.nTriangles);var n=(y&j)!==0;var r=B.getManager("VCXDRMManager");r.SetDisplayWatermark(A);console.log("[DRM MANAGER] Display watermark ? : "+(A?"YES":"NO"));r.SetValidDate(P);console.log("[DRM MANAGER] Has expiration date ? : "+(z!==0?"YES ":"NO "));if(z!==0){var K=new Date(w*1000);var I=new Date(E*1000);console.log("[DRM MANAGER] Date is valid ? : "+(P?"YES ":"NO ")+"- Start : "+K.toUTCString()+" - End : "+I.toUTCString())}r.SetDisplayTree(n);console.log("[DRM MANAGER] Show tree allowed ? "+(n?"YES":"NO"));r.SetValidSignature(F);console.log("[DRM MANAGER] Valid signature ? : "+(F?"YES":"NO"));if(!r.GetValidDate()){this.sendErrorNotification(B,"warning","Notification.SmgExpiration");D=false}if(!r.GetValidSignature()){this.sendErrorNotification(B,"warning","Notification.SmgInvalidSignature");D=false}if(!D){m(null);return}var L=this;g.memoryLog("LoadSmgXml",true);var G=new FileReader();G.onload=function(R){var T=new a();T.Load(B,l,R.target.result,false,v,O);var i=g.memoryLog("LoadSmgXml",false);console.log("[PERFO] "+i.logName+" "+i.time);console.log("[PERFO] Heap "+i.heap);var S=B.getManager("VCXExperience");S.OnEndLoading(false);l.render({updateInfinitePlane:true});if(L._progressBar){L._progressBar.update("100%")}else{if(L._experienceProgressCB){L._experienceProgressCB({loaded:100,total:100})}}m()};G.readAsText(C)},LoadFromArrayBuffer:function(i,l,j,k){var m=this;b.ExtractFromArchiveData(j,function(t){var n=i.getManager("VCXContextManager");if(n){n.setOpenSMG()}var r=null;var o=null;var p=null;var s=null;var q=[];t.forEach(function(u,v){if(v==="product.smggeom"){o=u}else{if(m.hasExtension(v,".smgoutlines")){p=u}else{if(m.hasExtension(v,".json")){s=u}else{if(m.hasExtension(v,".smgxml")||m.hasExtension(v,".xml")){r=u}else{q[v]=URL.createObjectURL(u)}}}}});if(m._progressBar){m._progressBar.update("0%")}else{if(m._experienceProgressCB){m._experienceProgressCB({loaded:0,total:100})}}m.LoadJsonForRightManager(s,function(v){var u=true;if(v){var w=i.getManager("VCXDRMManager");w.SetDisplayTree(v.RightManagement.ShowTree==="true");w.SetDisplayWatermark(v.DisplayWatermark==="true");w.SetValidDate(v.ExpirationOk==="true");w.SetValidSignature(v.ValidSignatureCRC==="true");if(!w.GetValidDate()){m.sendErrorNotification(i,"warning","Notification.SmgExpiration");u=false}if(!w.GetValidSignature()){m.sendErrorNotification(i,"warning","Notification.SmgInvalidSignature");u=false}}if(u){m.LoadSmgGeomOutlines(i,l,p,q,v,function(x){if(!o){m.sendErrorNotification(i,"warning","Notification.SmgGeomNotFound")}m.LoadSmgGeom(i,l,o,x,q,v,function(y){if(y){if(y._pause){}else{m.LoadSmgXml(i,l,r,y,q,function(){k(i)})}}else{if(m._progressBar){m._progressBar.off()}else{if(m._experienceProgressCB){m._experienceProgressCB({loaded:100,total:100})}}k()}})})}else{k(i)}})},function(q){var n="File format is not recognized.";var o="File contains encrypted entry.";var p="File is using Zip64 (4gb+ file size).";var r=(q===o)?"Notification.SmgOpenFailedPassword":"Notification.SmgOpenFailed";m.sendErrorNotification(i,"error",r);k()})},Load:function(i,m,k,l){var n=this;g.memoryLog("VCXSmgLoader",true,true);if(this._progressBar){this._progressBar.update("0%")}else{if(n._experienceProgressCB){n._experienceProgressCB({loaded:0,total:100})}}var j=new FileReader();j.onload=function(o){n.LoadFromArrayBuffer(i,m,o.target.result,l)};j.readAsArrayBuffer(k)}});return e});