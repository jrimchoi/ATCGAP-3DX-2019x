define("DS/CollectionView/layouts/CollectionViewLayout",["DS/Core/BaseComponent"],function(a){var b=a.inherit({name:"CollectionViewLayout",publishedProperties:{cellHeight:{defaultValue:30,type:"integer"}},init:function(c){this._parent(c)},_applyProperties:function(c){this._parent(c);this.invalidate(true)},prepareLayout:function(){},postRender:function(){},_invalidate:function(c){if(c===undefined){c={freePool:true}}this._isInvalid=c;return c},_getInvalidationContext:function(){return this._isInvalid},invalidate:function(c){var d=this._invalidate(c);if(this.collectionView){this.collectionView.invalidateLayout(d)}},isValid:function(){return !this._isInvalid},isCellSyncedAt:function(c){return false},getCellType:function(d){var c="__item__";if(this.isCellSyncedAt(d)){c="__sync_item__"}return c},cellTypeCanChangeOnScroll:function(c){return false},getHeaderContainerHeight:function(){return 0},getLeftContainerWidth:function(){return 0},getRightContainerWidth:function(){return 0},getPositionForCellAt:function(c){var d={top:c*this.cellHeight,left:0};return d},getDimensionsForCellAt:function(c){return{width:this.getContentDimensions().width,height:this.cellHeight}},getBoundingBoxForCellAt:function(c){return UWA.extend(this.getPositionForCellAt(c),this.getDimensionsForCellAt(c))},getContentDimensions:function(){var c=this.collectionView.getViewportDimensions();var e=this.collectionView.model.length*this.cellHeight;var d=c.height>e?0:UWA.Utils.Client.getScrollbarWidth();return{width:c.width-d,height:e}},renderListOfVisibleCellsInViewport:function(e){var g=this.collectionView.getViewportDimensions();var h=this.collectionView.getScrollerPosition();var d=Math.floor(h.y/this.cellHeight);var c=Math.floor((h.y+g.height)/this.cellHeight);d=Math.max(0,d);c=Math.min(c,this.collectionView.model.length-1);for(var f=d;f<=c;f++){e.render(f)}},getCssClassesForCellAt:function(){return""},getLayoutStylesForCellAt:function(d){var c=this.getPositionForCellAt(d);return{transform:"translate("+c.left+"px,"+c.top+"px)"}},getLayoutAttributesForCellAt:function(c){return{"cell-id":c}},isCellLayoutValidAt:function(c){return true},computeCellRange:function(h,c){var f=[];var e=Math.min(h,c);var d=Math.max(h,c);for(var g=e;g<=d;g++){if(this.collectionView.cellShouldBeSelected(g)){f.push(g)}}return f},isCellInRange:function(g,f,c){var e=Math.min(f,c);var d=Math.max(f,c);return((g>=e)&&(g<=d))},isNodeModelInRange:function(g,f,d){var c=false;if(g){var e=g._getRowID();c=this.isCellInRange(e,f,d)}return c},getCellsFromNodeModel:function(e){var c=[];if(e){var d=e._getRowID();c.push(d)}return c}});return b});define("DS/CollectionView/CollectionViewCell",["DS/Controls/Abstract","DS/Utilities/Dom","DS/Controls/TooltipModel"],function(b,a,c){var d=b.inherit({name:"CollectionViewCell",publishedProperties:{},init:function(e){this._parent();this.__cachedAttributes={};this.__cachedStyles={};this.__cachedCssClasses=null},_preBuildView:function(){this._parent();this.elements.container.addClassName("wux-layouts-collectionview-cell")},_getContentContainer:function(){return this.getContent()},_setReusableContent:function(g){this._disposeReusableContent();this._reusableContent=g;if(this._reusableContent){var e=this._getContentContainer();var f=this._reusableContent.getContent?this._reusableContent.getContent():this._reusableContent;e.appendChild(f)}},_getReusableContent:function(e){return this._reusableContent},_disposeReusableContent:function(){if(this._reusableContent){var e=this._getContentContainer();var f=this._reusableContent.getContent?this._reusableContent.getContent():this._reusableContent;e.removeChild(f);if(this._reusableContent.__disposable__){this._reusableContent.__disposable__.dispose()}this._reusableContent=undefined}},reuseCellContent:function(f){var e=this.collectionView.reuseCellContent(f);this._setReusableContent(e)},computeContentSize:function(){var e=0;if(this._reusableContent&&this._reusableContent.computeContentSize){e+=this._reusableContent.computeContentSize()}return Math.ceil(e)},_updateTooltip:function(e){this.tooltipInfos=new c(e)}});return d});define("DS/CollectionView/CollectionViewStatusBar",["DS/Core/BaseComponent","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tweakers/GeneratedToolbar","i18n!DS/CollectionView/assets/nls/collectionviewstatusbar"],function(e,a,g,c,k){function f(m,l){var n=k.TotalRows+m;if(l){return{grid:{data:n}}}return{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:n}}}function d(m,l){var n=k.SelectedRows+m;if(l){return{grid:{data:n}}}return{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:n}}}function i(l,m){var n=k.SelectedCells+l;if(m){return{grid:{data:n}}}return{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:n}}}function b(m,l){var n=(m>-1?this.collectionView.getCellIDAsString(m):k.NoActiveCell);if(l){return{grid:{data:n}}}return{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:n,tooltip:k.ActiveCellTooltip}}}function j(l){var p={position:l.position||"near",readOnly:true};switch(l.type){case h.STATUS.NB_ITEMS:var q=this._isCollectionViewUsingATreeDocument?this.collectionView.getTreeDocument().getAllDescendants().length:this.collectionView.model.length;UWA.extend(p,f.call(this,q));this._listOfTotalRowsStatusNode.push(p.id);break;case h.STATUS.NB_SELECTED_ROWS:var n=this.collectionView.getNodesXSO();if(!n){return}UWA.extend(p,d.call(this,n.get().length));this._listOfSelectedRowsStatusNode.push(p.id);break;case h.STATUS.NB_SELECTED_CELLS:var m=this.collectionView.getCellsXSO();if(!m){return}UWA.extend(p,i.call(this,m.get().length));this._listOfSelectedCellsStatusNode.push(p.id);break;case h.STATUS.ACTIVE_CELL:var o=this.collectionView.getActiveCellID();UWA.extend(p,b.call(this,o));this._listOfActiveCellStatusNode.push(p.id);break;case h.STATUS.CUSTOM:default:UWA.extend(p,l);break}return p}var h=c.inherit({publishedProperties:{overflowManagement:{defaultValue:"dropdown",type:"string",category:"Behavior"},height:{defaultValue:"auto",type:"string"},collectionView:{defaultValue:null,type:"DS/CollectionView/CollectionView",readOnly:true,noNeedToApplyFlag:true}},updateActiveCellID:function(l){var m=b.call(this,l,true);this._listOfActiveCellStatusNode.forEach(function(n){n.updateOptions(m)})},updateTotalRows:function(l){if(this._isCollectionViewUsingATreeDocument){return}var m=f.call(this,l,true);this._listOfTotalRowsStatusNode.forEach(function(n){n.updateOptions(m)})},setModel:function(l){this._clean();var m=[];var n=this;l.forEach(function(o){var p=j.call(n,o);if(p){m.push(p)}});n.updateModel({entries:m});this._listOfTotalRowsStatusNode.forEach(function(p,o){n._listOfTotalRowsStatusNode[o]=n.getNodeModelByID(p)});this._listOfSelectedRowsStatusNode.forEach(function(p,o){n._listOfSelectedRowsStatusNode[o]=n.getNodeModelByID(p)});this._listOfSelectedCellsStatusNode.forEach(function(p,o){n._listOfSelectedCellsStatusNode[o]=n.getNodeModelByID(p)});this._listOfActiveCellStatusNode.forEach(function(p,o){n._listOfActiveCellStatusNode[o]=n.getNodeModelByID(p)})},_preBuildView:function(l){if(!l.items){l.items=new a();this._properties.items.value=l.items}this._parent(l)},buildView:function(){this._parent();this.getContent().addClassName("wux-collectionview-statusBar");this._defaultStatusCpt=0;this._listOfActiveCellStatusNode=[];this._listOfTotalRowsStatusNode=[];this._listOfSelectedRowsStatusNode=[];this._listOfSelectedCellsStatusNode=[];this._isCollectionViewUsingATreeDocument=false},_postBuildView:function(){this._parent();if(this.collectionView){var r=this;var o=this.collectionView.getNodesXSO();if(o){var p=function(s){var t=d.call(r,o.get().length,true);r._listOfSelectedRowsStatusNode.forEach(function(u){u.updateOptions(t)})};o.onPostAdd(p);o.onPostRemove(p)}var n=this.collectionView.getCellsXSO();if(n){var m=function(s){var t=i.call(this,n.get().length,true);r._listOfSelectedCellsStatusNode.forEach(function(u){u.updateOptions(t)})};n.onPostAdd(m);n.onPostRemove(m)}var q=this.collectionView.getTreeDocument();if(q){this._isCollectionViewUsingATreeDocument=true;var l=function(){var s=f.call(this,q.getAllDescendants().length,true);r._listOfTotalRowsStatusNode.forEach(function(t){t.updateOptions(s)})};q.addEventListener("addChild",l);q.addEventListener("removeChild",l)}}},_clean:function(){this._defaultStatusCpt=0;this._listOfTotalRowsStatusNode=[];this._listOfSelectedRowsStatusNode=[];this._listOfSelectedCellsStatusNode=[];this._listOfActiveCellStatusNode=[]},_applyHeight:function(l){this.getContent().setStyle("height",this.height)},_applyProperties:function(l){this._parent(l);if(this.isDirty("height")){this._applyHeight(l.height)}}});h.STATUS={CUSTOM:0,NB_ITEMS:1,NB_SELECTED_ROWS:2,NB_SELECTED_CELLS:3,ACTIVE_CELL:4};return h});define("DS/CollectionView/edition/CollectionViewEdition",["UWA/Core","DS/Core/BaseComponent","DS/Utilities/Dom"],function(d,a,b){var c=a.inherit({onCellActivate:function(e){return 0},onCellUnactivate:function(e){return 0},onCellPreselect:function(e){return 0},onCellEndPreselect:function(e){return 0},onCellPointerDown:function(e){return 0},onCellDoubleClick:function(e){return 0},onF2:function(e){return 0},onEscape:function(e){return 0},onEnter:function(e){return 0},onKeyEvent:function(f,g){if(!this.collectionView.getFocusOnCellContentFlag()&&(g.type==="keydown")&&!g.ctrlKey&&!g.shiftKey&&!g.altKey&&(g.keyCode<112||g.keyCode>123)){this.collectionView._setEditionMode(f,true);this.collectionView.setFocusOnCellContentFlag(true)}return 0},isCellAlwaysInEdition:function(e){return false},_applyProperties:function(e){this._parent(e)}});return c});define("DS/CollectionView/commands/CollectionViewCommands",[],function(){var a={copy:function(){if(this._useClipboardFlag){this._activateHiddenInput();return}var b=(this.getTreeDocument?this.getTreeDocument():undefined);if(b&&b.getXSO()){this._modelEvents.publish({event:"copy",data:b.getXSO().get()})}return{preventDefault:true}},paste:function(){if(this._useClipboardFlag){this._activateHiddenInput();return}var b=(this.getTreeDocument?this.getTreeDocument():undefined);if(b&&b.getXSO()){this._modelEvents.publish({event:"paste",data:b.getXSO().get()})}return{preventDefault:true}},cut:function(){if(this._useClipboardFlag){return}var b=(this.getTreeDocument?this.getTreeDocument():undefined);if(b&&b.getXSO()){this._modelEvents.publish({event:"cut",data:b.getXSO().get()})}return{preventDefault:true}},deleteKeyPressed:function(){var b=(this.getTreeDocument?this.getTreeDocument():undefined);if(b&&b.getXSO()){this._modelEvents.publish({event:"deleteKeyPressed",data:b.getXSO().get()})}},selectAll:function(){this.selectAllVisibleNodes();return{preventDefault:true}},escape:function(){var b=this.getEditionManager(this.getActiveCellID());if(!b||!b.onEscape(this.getActiveCellID())){this.unselectAll()}return{preventDefault:true}},enter:function(){var b=this.getEditionManager(this.getActiveCellID());if(b){b.onEnter(this.getActiveCellID())}this.selectCell(this._computeCellIDFromActiveCell("enter"),false,false);return{preventDefault:true}},shiftEnter:function(){var b=this.getEditionManager(this.getActiveCellID());if(b){b.onEnter(this.getActiveCellID())}this.selectCell(this._computeCellIDFromActiveCell("enter",false,true),false,false);return{preventDefault:true}},spaceKeyPressed:function(){this._onSpaceKeyPressed();return{preventDefault:true}},ctrlSpaceKeyPressed:function(){var b=this.getActiveCellID();if(b!==undefined){this.isCellSelected(b)?this.unselectCell(b):this.selectCell(b,true,false)}return{preventDefault:true}},upMove:function(){var b=this._computeCellIDFromActiveCell("up");if(this.selectionBehavior.toggle){this.setActiveCell(b)}else{this.selectCell(b,false,false)}return{preventDefault:true}},rightMove:function(){var b=this._computeCellIDFromActiveCell("right");if(this.selectionBehavior.toggle){this.setActiveCell(b)}else{this.selectCell(b,false,false)}return{preventDefault:true}},downMove:function(){var b=this._computeCellIDFromActiveCell("down");if(this.selectionBehavior.toggle){this.setActiveCell(b)}else{this.selectCell(b,false,false)}return{preventDefault:true}},leftMove:function(){var b=this._computeCellIDFromActiveCell("left");if(this.selectionBehavior.toggle){this.setActiveCell(b)}else{this.selectCell(b,false,false)}return{preventDefault:true}},ctrlUp:function(){this.setActiveCell(this._computeCellIDFromActiveCell("up",true));return{preventDefault:true}},ctrlRight:function(){this.setActiveCell(this._computeCellIDFromActiveCell("right",true));return{preventDefault:true}},ctrlDown:function(){this.setActiveCell(this._computeCellIDFromActiveCell("down",true));return{preventDefault:true}},ctrlLeft:function(){this.setActiveCell(this._computeCellIDFromActiveCell("left",true));return{preventDefault:true}},shiftUp:function(){this.selectCell(this._computeCellIDFromActiveCell("up",false,true),false,true);return{preventDefault:true}},shiftRight:function(){this.selectCell(this._computeCellIDFromActiveCell("right",false,true),false,true);return{preventDefault:true}},shiftDown:function(){this.selectCell(this._computeCellIDFromActiveCell("down",false,true),false,true);return{preventDefault:true}},shiftLeft:function(){this.selectCell(this._computeCellIDFromActiveCell("left",false,true),false,true);return{preventDefault:true}},tab:function(){this.selectCell(this._computeCellIDFromActiveCell("tab"),false,false);return{preventDefault:true}},shiftTab:function(){this.selectCell(this._computeCellIDFromActiveCell("tab",false,true),false,false);return{preventDefault:true}},pageup:function(){this.selectCell(this._computeCellIDFromActiveCell("pageup"),false,false);return{preventDefault:true}},pagedown:function(){this.selectCell(this._computeCellIDFromActiveCell("pagedown"),false,false);return{preventDefault:true}},shiftPageup:function(){this.selectCell(this._computeCellIDFromActiveCell("pageup",false,true),false,true);return{preventDefault:true}},shiftPagedown:function(){this.selectCell(this._computeCellIDFromActiveCell("pagedown",false,true),false,true);return{preventDefault:true}},home:function(){this.selectCell(this._computeCellIDFromActiveCell("home"),false,false);return{preventDefault:true}},end:function(){this.selectCell(this._computeCellIDFromActiveCell("end"),false,false);return{preventDefault:true}},ctrlHome:function(){this.setActiveCell(this._computeCellIDFromActiveCell("home",true),false,false);return{preventDefault:true}},ctrlEnd:function(){this.setActiveCell(this._computeCellIDFromActiveCell("end",true),false,false);return{preventDefault:true}},shiftHome:function(){this.selectCell(this._computeCellIDFromActiveCell("home",false,true),false,true);return{preventDefault:true}},shiftEnd:function(){this.selectCell(this._computeCellIDFromActiveCell("end",false,true),false,true);return{preventDefault:true}},f2:function(){var b=this.getEditionManager(this.getActiveCellID());if(b){b.onF2(this.getActiveCellID())}return{preventDefault:true}},defaultKeyEventCallback:function(d){var c=this.getActiveCellID();var b=this.getEditionManager(c);if(b){b.onKeyEvent(c,d)}else{return{stopPropagation:false}}}};return a});define("DS/CollectionView/modelProviders/CollectionViewModelProvider",["DS/Core/BaseComponent","DS/Selection/XSO"],function(a,b){var c=a.inherit({name:"CollectionViewModelProvider",publishedProperties:{},_preBuild:function(){this.modelEventsListener=[]},_applyProperties:function(d){this._parent(d)},getModelClass:function(){return""},addModelEvents:function(){},removeModelEvents:function(){},flattenApplicativeModel:function(d){throw"No implementation found for flattenApplicativeModel method."},fillApplicativeModelFromViewModel:function(e,d){throw"No implementation found for fillApplicativeModelFromArrayModel method."},getNodeModelRowID:function(e,d){return this.collectionView.model.indexOf(e)},selectNode:function(e,f){var d=this.getNodesXSO();if(!d){return}if(f){d.unique(e)}else{if(!this.isNodeSelected(e)){d.add(e)}}},unSelectNode:function(e){var d=this.getNodesXSO();if(!d){return}if(this.isNodeSelected(e)){d.remove(e)}},isNodeSelected:function(e){var d=this.getNodesXSO();if(!d){return false}return d.isIn(e)},selectAllVisibleNodes:function(){throw"No implementation found for selectAllVisibleNodes method."},unselectAll:function(){var d=this.getNodesXSO();if(!d){return}d.empty()},isNodeVisible:function(d){return true},isNodeModelInRange:function(h,g,e){var d=false;if(h){var f=this.getNodeModelRowID(h);d=this.isCellInRange(f,g,e)}return d},isCellInRange:function(h,g,d){var f=Math.min(g,d);var e=Math.max(g,d);return((h>=f)&&(h<=e))},shouldAcceptDrag:function(d){return true},dumpNodeModel:function(e,d){throw"No implementation found for dumpNodeModel method."},getNodesXSO:function(){if(!this.collectionView.supportsSelection()){return null}var d=this;if(!this.selectionModel){this.selectionModel=new b({getElementID:this.getXSOElementID,useUniqueID:true,areEquals:this.areXSONodesEquals});this.collectionView._AddModelEvents()}return this.selectionModel},getXSOElementID:function(d){throw"No implementation of getXSOElementID is found."},areXSONodesEquals:function(e,d){return e.getXSOElementID()===d.getXSOElementID()},getPropertyValue:function(e,d){return""}});return c});define("DS/CollectionView/edition/CollectionViewEditionOnClick",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(c,b){var a=b.inherit({onCellUnactivate:function(d){this.collectionView._setEditionMode(d,false)},onCellActivate:function(d){this.collectionView._setEditionMode(d,true);if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView._focusActiveCellContent()}},onCellEndPreselect:function(d){},onCellPreselect:function(d){},onCellPointerDown:function(d){this.collectionView.setFocusOnCellContentFlag(true)},onCellDoubleClick:function(d){},onF2:function(d){this.onCellPointerDown(d)},onEscape:function(d){if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView.setFocusOnCellContentFlag(false);return 1}return 0},onEnter:function(d){this.collectionView.setFocusOnCellContentFlag(false)}});return a});define("DS/CollectionView/edition/CollectionViewEditionInPlace",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(c,b){var a=b.inherit({onCellUnactivate:function(d){},onCellActivate:function(d){this.collectionView._focusActiveCellContent()},onCellEndPreselect:function(d){},onCellPreselect:function(d){},onCellPointerDown:function(d){this.collectionView.setFocusOnCellContentFlag(true)},onCellDoubleClick:function(d){},onF2:function(d){this.onCellPointerDown(d)},onEscape:function(d){if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView.setFocusOnCellContentFlag(false);return 1}return 0},isCellAlwaysInEdition:function(d){return true},onEnter:function(d){this.collectionView.setFocusOnCellContentFlag(false)}});return a});define("DS/CollectionView/modelProviders/CollectionViewUWACollectionModelProvider",["DS/CollectionView/modelProviders/CollectionViewModelProvider","UWA/Class/Collection"],function(b,c){var a=b.inherit({name:"CollectionViewUWACollectionModelProvider",publishedProperties:{},getModelClass:function(){return c},_updateModel:function(g){var d=this.collectionView;var f=this;var e=this.modelProvider;if(g==="onAdd"||g==="onRemove"||g==="onChange"||g==="onReset"||g==="onSort"){d.model=e.flattenApplicativeModel(f);d.invalidateLayout({updateCellContent:true})}},addModelEvents:function(){var e=this.collectionView.applicativeModel;var d=this.collectionView;var f=this;if(e){e.addEvent("onAnyEvent",this._updateModel);e.collectionView=this.collectionView;e.modelProvider=this}},removeModelEvents:function(){var d=this.collectionView.applicativeModel;if(d){d.removeEvent("onAnyEvent",this._updateModel,this)}},flattenApplicativeModel:function(d){return d.toArray()},fillApplicativeModelFromViewModel:function(e,d){if(e&&d){e.reset(d,{silent:true})}},selectAllVisibleNodes:function(){var e=this.collectionView.applicativeModel;if(e){var g=[];var f=this.getNodesXSO();if(!f){return}for(var d=0;d<e.size();d++){g.push(e.at(d))}f.empty();f.add(g);if(this.model&&this.model.length){this.collectionView.setActiveNode(this.collectionView.model[this.model.length-1],false)}}},getXSOElementID:function(d){return d.cid},shouldAcceptDrag:function(d){return true},dumpNodeModel:function(f,e){var d={};e=UWA.extend({properties:[function(){return{property:"label",value:f.get("label")}},function(){return{property:"icons",value:f.get("icons")}}]},e);e.properties.forEach(function(h){if(UWA.typeOf(h)==="function"){var g=h.call(f);d[g.property]=g.value}});return d},getPropertyValue:function(e,d){return e.get(d)}});return a});define("DS/CollectionView/edition/CollectionViewEditionOnOver",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(c,a){var b=a.inherit({publishedProperties:{},onCellUnactivate:function(d){var e=this.collectionView._getPreselectedCellID();if(e!==d){this.collectionView._setEditionMode(d,false)}},onCellActivate:function(d){this.collectionView._setEditionMode(d,true);if(this.collectionView.getFocusOnCellContentFlag()&&this.collectionView.PointerDownScope!==true){this.collectionView._focusActiveCellContent()}},onCellEndPreselect:function(d){var e=this.collectionView.getActiveCellID();if(e!==d){this.collectionView._setEditionMode(d,false)}},onCellPreselect:function(d){this.collectionView._setEditionMode(d,true)},onCellPointerDown:function(d){this.collectionView.setFocusOnCellContentFlag(true)},onCellDoubleClick:function(d){},onF2:function(d){this.onCellPointerDown(d)},onEscape:function(d){if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView.setFocusOnCellContentFlag(false);return 1}return 0},onEnter:function(d){this.collectionView.setFocusOnCellContentFlag(false)}});return b});define("DS/CollectionView/edition/CollectionViewEditionOnDoubleClick",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(c,b){var a=b.inherit({onCellActivate:function(d){if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView._setEditionMode(d,true);this.collectionView._focusActiveCellContent()}},onCellUnactivate:function(d){this.collectionView._setEditionMode(d,false)},onCellPreselect:function(d){},onCellEndPreselect:function(d){},onCellPointerDown:function(d){if(this.collectionView.getActiveCellID()!==d){this.collectionView.setFocusOnCellContentFlag(false)}},onCellDoubleClick:function(d){this.collectionView._setEditionMode(d,true);this.collectionView.setFocusOnCellContentFlag(true)},onF2:function(d){this.onCellDoubleClick(d)},onEscape:function(d){if(this.collectionView.getFocusOnCellContentFlag()){this.collectionView.setFocusOnCellContentFlag(false);this.collectionView._setEditionMode(d,false);return 1}return 0},onEnter:function(d){this.collectionView.setFocusOnCellContentFlag(false);this.collectionView._setEditionMode(d,false)}});return a});define("DS/CollectionView/layouts/CollectionViewGridLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewLayout"],function(a,c){function b(l,e,j){var i=l.collectionView.getViewportDimensions(true);var f;for(var h in j){if(e>=parseFloat(h)){var g=j[h];if(typeof g==="string"){var k=parseFloat(l.rowMaxHeight);g=(i.height-l.gutter)/100*k}f=g}else{break}}return f}var d=c.inherit({name:"CollectionViewGridLayout",publishedProperties:{gutter:{defaultValue:0,type:"integer"},direction:{defaultValue:"vertical",type:"string"},columnMaxWidth:{defaultValue:140,type:"integer"},rowMaxHeight:{defaultValue:140,type:"integer"},useDynamicColumnWidth:{defaultValue:true,type:"boolean"},useDynamicRowHeight:{defaultValue:false,type:"boolean"}},_postBuild:function(){this._parent()},isSectionAt:function(e){return this.collectionView.model[e].options&&this.collectionView.model[e].options.nodeCategory==="fake"},prepareLayout:function(){var g=this;var f=g.collectionView.getViewportDimensions(true);var e=g._getColumnWidthInPixel(f);var h=g._getRowHeightInPixel(f);var j=function(){var k=(f.width-g.gutter)/(e+g.gutter);g._numberOfColumns=Math.max(Math.round(k),1);var l=(f.height-g.gutter)/(h+g.gutter);g._numberOfRows=Math.max(Math.floor(l),1)};j();var i=function(){if(this.useDynamicColumnWidth){this._columnWidth=Math.floor((f.width-(this._numberOfColumns+1)*this.gutter)/this._numberOfColumns)}else{this._columnWidth=Math.floor(e)}if(this.useDynamicRowHeight){this._rowHeight=Math.floor((f.height-(this._numberOfRows+1)*this.gutter)/this._numberOfRows)}else{this._rowHeight=Math.floor(h)}var k=false;if(this._columnWidth>this.columnMaxWidth){this._numberOfColumns++;k=true}if(this._rowHeight>this.rowMaxHeight){this._numberOfRows++;k=true}if(k){i.call(this)}};i.call(this)},getCellCoordinatesAt:function(g){var h;if(this.direction==="vertical"){var f=this._numberOfColumns;h={rowID:Math.floor(g/f),columnID:(g%f)}}else{var e=this._numberOfRows;h={rowID:(g%e),columnID:Math.floor(g/e)}}return h},getCellIDFromCoordinates:function(e){var f=(this._numberOfColumns*e.rowID)+e.columnID;return f},_getPositionForCellAt:function(f){var g=this.getCellCoordinatesAt(f);var e={left:g.columnID*(this._getColumnWidth()+this.gutter)+this.gutter,top:g.rowID*(this._getRowHeight()+this.gutter)+this.gutter};return e},getPositionForCellAt:function(e){return this._getPositionForCellAt(e)},getCellIDFromPositionInView:function(e){var i=-1;if(e){var k=this.gutter;var j=Math.floor(e.top/(this._getRowHeight()+k));var h=Math.floor(e.left/(this._getColumnWidth()+k));if((j>=0)&&(h>=0)){var f=e.top-(j*(this._getRowHeight()+k));var g=e.left-(h*(this._getColumnWidth()+k));if((f>=k)&&(g>=k)){i=this.getCellIDFromCoordinates({rowID:j,columnID:h})}}}return i},getDimensionsForCellAt:function(e){return{width:this._getColumnWidth(),height:this._getRowHeight()}},_getColumnWidthInPixel:function(f){var g;var e;switch(typeof this.columnMaxWidth){case"string":var g=parseFloat(this.columnMaxWidth);e=Math.round((f.width-this.gutter)/100*g);break;case"number":e=this.columnMaxWidth;break;case"object":e=b(this,f.width,this.columnMaxWidth);break;default:}return e},_getRowHeightInPixel:function(e){var f;var g;switch(typeof this.rowMaxHeight){case"string":var f=parseFloat(this.rowMaxHeight);g=Math.round((e.height-this.gutter)/100*f);break;case"number":g=this.rowMaxHeight;break;case"object":g=b(this,e.height,this.rowMaxHeight);break;default:}return g},_getColumnWidth:function(){return this._columnWidth},_getRowHeight:function(){return this._rowHeight},_getColumnPosition:function(e){return e*(this._getColumnWidth()+this.gutter)+this.gutter},getContentDimensions:function(){var j=this.collectionView.getViewportDimensions();var f=this.collectionView.model.length-1;var h=this.getPositionForCellAt(f);var l=this.getDimensionsForCellAt(f);var m={height:h.top+this.gutter+l.height+this.gutter,width:h.left+this.gutter+l.width+this.gutter};var i=UWA.Utils.Client.getScrollbarWidth();if(this.direction==="vertical"){var e=m.height>j.height?(j.width-i):j.width;var g={width:e,height:m.height};return g}else{var k=m.width>j.width?(j.height-i):j.height;var g={width:m.width,height:k};return g}},_computeMinCellID:function(){var e=0;var f=this.collectionView.getViewportDimensions();var g=this.collectionView.getScrollerPosition();if(this.direction==="vertical"){e=Math.max((Math.floor(g.y/(this._getRowHeight()+this.gutter))),0)*Math.floor(f.width/(this._getColumnWidth()+this.gutter))}else{e=Math.max((Math.floor(g.x/(this._getColumnWidth()+this.gutter))),0)*Math.floor(f.height/(this._getRowHeight()+this.gutter))}e=Math.min(e,this.collectionView.model.length-1);return e},renderListOfVisibleCellsInViewport:function(o){var l=this.collectionView.getViewportDimensions();var n=this.collectionView.getScrollerPosition();var g=0;var k;if(this.direction==="vertical"){k={pos:"top",scrollPos:"y",size:"height"}}else{k={pos:"left",scrollPos:"x",size:"width"}}g=this._computeMinCellID();if(!isNaN(g)&&g>=0){var m=g;var j=n[k.scrollPos]+l[k.size];o.render(g);for(var e=g;e+1<this.collectionView.model.length-1;e++){var h=this.getPositionForCellAt(e+1)[k.pos];if(h<=j){m=e+1;o.render(m)}else{break}}var f=Math.min(m+1,this.collectionView.model.length-1);if(m+1<this.collectionView.model.length){o.render(m+1)}this.__currentRenderedRange={minCellID:g,maxCellID:f}}},getCssClassesForCellAt:function(){return""},getLayoutStylesForCellAt:function(h){var e=this.getPositionForCellAt(h);var g=this.getDimensionsForCellAt(h);if(e){var f=g.height+"px";return{transform:"translate3d("+Math.round(e.left)+"px,"+Math.round(e.top)+"px,0)",width:g.width+"px",height:f,lineHeight:f}}else{return{}}},getLayoutAttributesForCellAt:function(e){var f=this.getCellCoordinatesAt(e);return{"cell-id":e,"row-id":f.rowID,"column-id":f.columnID}}});return d});define("DS/CollectionView/layouts/CollectionViewListLayout",["DS/CollectionView/layouts/CollectionViewGridLayout"],function(a){var b=a.inherit({name:"CollectionViewListLayout",publishedProperties:{rowMaxHeight:{defaultValue:40,type:"integer"},columnMaxWidth:{defaultValue:"100%",type:"integer"}}});return b});define("DS/CollectionView/layouts/CollectionViewWallFlowLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewLayout","DS/Utilities/Utils"],function(b,d,e){function a(g,f){return !(f.left>g.right||f.right<g.left||f.top>g.bottom||f.bottom<g.top)}var c=d.inherit({name:"CollectionViewWallFlowLayout",publishedProperties:{cellHeight:{defaultValue:30,type:"integer"},preComputeLayout:{defaultValue:false,type:"boolean"},gutter:{defaultValue:20,type:"integer"},direction:{defaultValue:"vertical",type:"string"},aggregate:{defaultValue:false,type:"boolean"},columnMaxWidth:{defaultValue:400,type:"integer"}},_postBuild:function(){this._parent();this._listOfCellPositions={};this._listOfCellSpan={};this._listOfCellDimensions={};this._listOfColumnsProperties=[]},_applyColumns:function(){var g=this;this._listOfColumnsProperties=[];for(var f=0;f<this._numberOfColumns;f++){g._listOfColumnsProperties.push({filledHeight:0})}},_applyProperties:function(f){this._parent(f);this._applyColumns();this.invalidate(true)},prepareLayout:function(){this._mask=true;this._sizePattern=null;var h=this.collectionView.getViewportDimensions(true);var g=this.columnMaxWidth;if(typeof g==="string"){var i=parseFloat(g);g=(h.width-this.gutter)/100*i}var f=(h.width-this.gutter)/(g+this.gutter);this._numberOfColumns=Math.max(Math.ceil(f),1);this._columnWidth=Math.floor((h.width-(this._numberOfColumns+1)*this.gutter)/this._numberOfColumns);this._applyColumns();this._computePositions(0,this.collectionView.model.length-1)},isValid:function(){return this._isInvalid?false:true},isCellSyncedAt:function(f){return false},postRender:function(){for(var f in this.collectionView._visibleCellsInViewport){f=parseInt(f,10);var g=this.collectionView.getCellInfosAt(f);g.cellView=this.collectionView._getViewAt(f);this.collectionView._layoutCell(g)}},getPositionForCellAt:function(f){return this._listOfCellPositions[f]},_getColumnPrivateProperties:function(f){return this._listOfColumnsProperties[f]},_getLessFilledColumn:function(){var k=this;var l=k._getColumnPrivateProperties(0).filledHeight;var j=0;var g=false;for(var h=0;!g&&h<this._numberOfColumns;h++){var f=k._getColumnPrivateProperties(h).filledHeight;if(f<l){l=f;j=h;if(f===0){g=true}}}return j},_getMoreFilledColumn:function(){var j=this;if(j._getColumnPrivateProperties(0)){var k=j._getColumnPrivateProperties(0).filledHeight;var h=0;for(var g=0;g<this._numberOfColumns;g++){var f=j._getColumnPrivateProperties(g).filledHeight;if(f>=k){k=f;h=g}}return h}else{return -1}},_computePositions:function(o,p){if(o===undefined){o=0}if(p===undefined){p=this.collectionView.model.length-1}for(var k=o;k<=p;k++){var h=this.getDimensionsForCellAt(k);if(h&&h.width!==undefined&&h.height!==undefined){var f=this._getLessFilledColumn();var m=this._getColumnPrivateProperties(f).filledHeight;var g=f;var l=f;var n=l-g+1;if(n<this._numberOfColumns){this._listOfCellSpan[k]=n}else{this._listOfCellSpan[k]=1;l=g}var q=this._getColumnPosition(f);this._listOfCellPositions[k]={top:m+this.gutter,left:q};for(var j=g;j<=l;j++){this._getColumnPrivateProperties(j).filledHeight=m+h.height+this.gutter}}}},_getColumnWidth:function(f){return this._columnWidth},_getColumnPosition:function(f){return f*(this._getColumnWidth()+this.gutter)+this.gutter},_getCellSpan:function(f){return this._listOfCellSpan[f]!==undefined?this._listOfCellSpan[f]:1},getDimensionsForCellAt:function(g){var f=this._getColumnWidth();if(this._listOfCellDimensions[g]===undefined){this._listOfCellDimensions[g]={}}this._listOfCellDimensions[g].width=f*this._getCellSpan(g)+(this.gutter*(this._getCellSpan(g)-1));return this._listOfCellDimensions[g]},getContentDimensions:function(){var f=this.collectionView.getViewportDimensions();var g=this._getMoreFilledColumn();if(g>-1){var h=this._getColumnPrivateProperties(g);var j=h.filledHeight;var i=f.height>j?0:UWA.Utils.Client.getScrollbarWidth();return{width:f.width-i,height:j}}else{return{width:f.width,height:f.height}}},renderListOfVisibleCellsInViewport:function(s){if(s===undefined){s={}}var n=this.collectionView.getViewportDimensions();var r=this.collectionView.getScrollerPosition();var m=Math.floor(r.y/this.cellHeight);var l=Math.floor((r.y+n.height)/this.cellHeight);m=0;l=this.collectionView.model.length-1;var f=r;f.top=r.y;f.left=r.x;f.right=f.left+n.width;f.bottom=f.top+n.height;var h=0;var o=false;var k=false;for(var j=m;(!k||this.preComputeLayout)&&j<=l;j++){var g=this._listOfCellPositions[j];if(g!==undefined){var q=this.getDimensionsForCellAt(j);g.right=g.left+q.width;g.bottom=g.top+q.height;o=a(g,f)}else{o=true}if(o){h++;if(s.render){s.render(j);if(this._listOfCellDimensions[j]===undefined||this._listOfCellDimensions[j].width===undefined||this._listOfCellDimensions[j].height===undefined){var p=this.collectionView._getViewAt(j);if(p){this._listOfCellDimensions[j]=p.getContent().getDimensions()}this._computePositions(j);var g=this._listOfCellPositions[j];var q=this._listOfCellDimensions[j];g.right=g.left+q.width;g.bottom=g.top+q.height;var n=this.collectionView.getViewportDimensions(true);var r=this.collectionView.getScrollerPosition();var f={};f.top=r.y;f.left=r.x;f.right=f.left+n.width;f.bottom=f.top+n.height;if(!a(g,f)){k=true}}}}}},getCssClassesForCellAt:function(){return""},getLayoutStylesForCellAt:function(h){var f=this.getPositionForCellAt(h);var g=this.getDimensionsForCellAt(h);if(f){return{position:"absolute",transform:"translate3d("+f.left+"px,"+f.top+"px,0)",width:g.width+"px",height:g.height!==undefined?(g.height+"px"):""}}else{return{position:"absolute",width:g.width+"px",height:g.height!==undefined?(g.height+"px"):""}}},getLayoutAttributesForCellAt:function(f){return{"cell-id":f}},});return c});define("DS/CollectionView/layouts/CollectionViewListFlowLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewWallFlowLayout","DS/Utilities/Utils"],function(a,b,c){var d=b.inherit({name:"CollectionViewListFlowLayout",publishedProperties:{columnMaxWidth:{defaultValue:"100%",type:"integer"}}});return d});define("DS/CollectionView/layouts/CollectionViewSectionGridLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewGridLayout"],function(a,c){var b=c.inherit({name:"CollectionViewSectionGridLayout",publishedProperties:{sectionHeight:{defaultValue:40,type:"integer"}},isSectionAt:function(d){if(this.collectionView.model.length&&this.collectionView.model[d]){return this.collectionView.model[d].options&&this.collectionView.model[d].options.nodeCategory==="fake"}else{return false}},prepareLayout:function(){var i=this;this._listOfSectionsReverseIndexes={};this._listOfSections=[];this._listOfItemsInfos=[];this.__currentPreviousStackedSection=-1;this.__currentNextStackedSection=0;this.__currentStackedSection=0;var o=i.collectionView.getViewportDimensions();var l=UWA.Utils.Client.getScrollbarWidth();var d=o.width-l;var g=i._getColumnWidthInPixel(o);var j=(d-i.gutter)/(g+i.gutter);var p=Math.max(Math.round(j),1);var e=Math.floor((d-(p+1)*i.gutter)/p);if(e>g){p++;e=Math.floor((d-(p+1)*i.gutter)/p)}i._columnWidth=e;i._numberOfColumns=p;var m=0,f=0,k=0,n=0,h=false;this.collectionView.model.forEach(function(r,s){var q=i.isSectionAt(s);if(q){i._listOfSections.push({cellID:s});f=0;i._listOfSectionsReverseIndexes[s]=n;n++;if(!h&&(m>0)){m++}}if(!q){if(f>p-1){f=0;m++}}i._listOfItemsInfos.push({sectionsBefore:k,coordinates:{rowID:m,columnID:f}});if(!q){f++}if(q){m++;f=0;k++}h=q});this._parent()},getCellCoordinatesAt:function(d){var e;if(this._listOfSections&&(this._listOfSections.length===0)){e=this._parent(d)}else{if(this._listOfItemsInfos){e=this._listOfItemsInfos[d].coordinates}}return e},_getPositionForCellAt:function(f){var h;var g=this.getCellCoordinatesAt(f);var e=0;if(this._listOfItemsInfos){var d=this._listOfItemsInfos[f];if(d){e=d.sectionsBefore}}if(this.isSectionAt(f)){h={left:this.gutter}}else{h={left:this._parent(f).left}}h.top=(g.rowID-e)*(this._getRowHeight()+this.gutter)+(e*(this.sectionHeight+this.gutter))+this.gutter;return h},getPositionForCellAt:function(e){var f=this._parent(e);if(this.isCellSyncedAt(e)){f.top=0}else{var d=this._listOfSectionsReverseIndexes[this.__currentStackedSection]-1;if(this.__currentPreviousStackedSection===e&&this.__currentPreviousStackedSection<this.__currentStackedSection){f.top=this._getPositionForCellAt(this.__currentStackedSection).top-this.getDimensionsForCellAt(e).height}}return f},getDimensionsForCellAt:function(d){if(this.isSectionAt(d)){return{width:this._numberOfColumns*this._getColumnWidth()+(this._numberOfColumns)*this.gutter,height:this.sectionHeight}}else{return this._parent(d)}},getContentDimensions:function(){var g=this.collectionView.getViewportDimensions();var e=this.collectionView.model.length-1;var j=this.getPositionForCellAt(e);var k=this.getDimensionsForCellAt(e);var h=UWA.Utils.Client.getScrollbarWidth()>=0?UWA.Utils.Client.getScrollbarWidth():0;var i,f;if(this._listOfSections&&this._listOfSections.length>0){i={height:j.top+this.gutter+k.height+this.gutter,width:this._numberOfColumns*(this._getColumnWidth()+this.gutter)+this.gutter};f=i.height>g.height?(g.width-h):g.width;return{width:f,height:i.height}}else{i={height:j.top+this.gutter+k.height+this.gutter,width:j.left+this.gutter+k.width+this.gutter,};f=i.height>g.height?(g.width-h):g.width;if(this.direction==="vertical"){return{width:f,height:i.height}}else{var d=i.width>g.width?(g.height-h):g.height;return{width:i.width,height:d}}}},_computeMinCellID:function(){var f=this.collectionView.getViewportDimensions();var g=this.collectionView.getScrollerPosition();var e;if(this.direction==="vertical"){e={pos:"top",scrollPos:"y",size:"height"}}else{e={pos:"left",scrollPos:"x",size:"width"}}var d=0;if(this._getPositionForCellAt(d)[e.pos]<=g[e.scrollPos]){while(d<this.collectionView.model.length-1&&this._getPositionForCellAt(d)[e.pos]<g[e.scrollPos]){d++}d=Math.max(0,d-this._numberOfColumns)}else{if(this._getPositionForCellAt(d)[e.pos]>g[e.scrollPos]){while(d>0&&this._getPositionForCellAt(d)[e.pos]>g[e.scrollPos]){d--}}}return d},renderListOfVisibleCellsInViewport:function(d){var f=this;var e=f.collectionView.getScrollerDeltaPosition().y;var h={};var g=d.render;d.render=function(i){var k=f._getPositionForCellAt(i).top;var m=f.collectionView.getScrollerPosition().y;h[i]=true;if(f.isSectionAt(i)){if(e>0){if(k<m+f.getDimensionsForCellAt(f.__currentStackedSection).height){if(i>f.__currentStackedSection&&f.__currentStackedSection!==f.__currentPreviousStackedSection){f.__currentPreviousStackedSection=f.__currentStackedSection;f.__currentStackedSection=i}}}else{if(f._getPositionForCellAt(f.__currentStackedSection).top-f.getDimensionsForCellAt(f.__currentStackedSection).height>m){if(i<f.__currentStackedSection&&f.__currentStackedSection!==f.__currentPreviousStackedSection){f.__currentPreviousStackedSection=f.__currentStackedSection;f.__currentStackedSection=i}}}}else{var j=f._listOfItemsInfos[i].sectionsBefore-1;if(j>-1){var l=f._listOfSections[j].cellID;if(h[l]===undefined){d.render(l)}}}g.call(this,i)};if(f.__currentPreviousStackedSection>-1){g.call(this,f.__currentPreviousStackedSection)}if(f.__currentStackedSection!==undefined){g.call(this,f.__currentStackedSection)}this._parent(d)},_isPreviousSection:function(e){var d=this._listOfSectionsReverseIndexes[this.__currentStackedSection]-1;return d>=0&&d===e},_getPreviousSectionID:function(){var d=this._listOfSectionsReverseIndexes[this.__currentNextStackedSection]-1;if(d>-1){return this._listOfSections[d].cellID}},isCellSyncedAt:function(e){var f=false;if(this.__currentStackedSection===e){var d=this._getPositionForCellAt(this.__currentStackedSection).top>=this.collectionView.getScrollerPosition().y;if(!d){f=this.isSectionAt(e)}}return f},cellTypeCanChangeOnScroll:function(d){return this.isSectionAt(d)},getCssClassesForCellAt:function(){return""},getLayoutStylesForCellAt:function(e){var d=this._parent(e);d.zIndex=this.isSectionAt(e)?(1000000+e):"";return d},getLayoutAttributesForCellAt:function(e){var d=this._parent(e);d["is-current"]=this.__currentStackedSection===e;d["is-section"]=this.isSectionAt(e);d["is-stacked"]=this.isCellSyncedAt(e);return d}});return b});define("DS/CollectionView/layouts/CollectionViewSectionListLayout",["DS/CollectionView/layouts/CollectionViewSectionGridLayout"],function(a){var b=a.inherit({name:"CollectionViewSectionListLayout",publishedProperties:{columnMaxWidth:{defaultValue:"100%",type:"integer"}}});return b});define("DS/CollectionView/CollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewGridLayout","DS/CollectionView/CollectionViewCell","DS/CollectionView/commands/CollectionViewCommands","DS/CollectionView/CollectionViewStatusBar","DS/Selection/XSO"],function(i,b,q,g,p,k,w,s,f,t,j,y,e,d,C,c,x,A,h){var r=false;var l=false;var a=false;var D=false;var o=100;function v(F,E){return !(E.left>F.right||E.right<F.left||E.top>F.bottom||E.bottom<F.top)}var m=0;var z=0;function u(G,F){var H={};var I={};for(var J in F){if(G[J]!==F[J]){H[J]=F[J]}}for(var E in G){if(F[E]===undefined){I[E]=F[E]}}return{toAdd:H,toRemove:I}}function n(E){return E.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var B=d.inherit({name:"CollectionView",publishedProperties:{model:{defaultValue:[],type:"array"},cellClass:{defaultValue:c,type:"object"},layout:{defaultValue:new C(),type:"object"},height:{defaultValue:"inherit",type:"integer"},showScrollbarsOnHover:{defaultValue:false,type:"boolean"},rowSelection:{defaultValue:"multiple",type:"string"},cellSelection:{defaultValue:"none",type:"string"},selectionBehavior:{defaultValue:{toggle:false,unselectAllOnEmptyArea:true,selectNodeModelOnCellSelection:true},type:"object"},onDelayedModelDataRequest:{defaultValue:null,type:"function"},pageScrollValueTriggeringInfiniteScroll:{defaultValue:undefined,type:"object"},showBackgroundFlag:{defaultValue:true,type:"boolean"}},_preBuild:function(){this._uuid=i.Utils.getUUID();this._isInitialized=false;this._reusableCellContentManager=new e();this._pool=new e();this._listOfRenderedCells=new Map();this._updateCounter=0;this._updateNeeded=false;this._visibleCellsInViewport={};this._modelEvents=new p();this._buildLayout();this._manageSelection();this._manageKeyboard();this._parent()},supportsKeyboardNavigation:function(){return false},supportsSelection:function(){return false},supportsLightRendering:function(){return false},supportsCustomScrolling:function(){return false},getXSOElementID:function(E){return E},_getXSOElementFromCellID:function(E){return E},_getCellIDFromXSOElement:function(E){return E},isCellSelected:function(I){var E=false;var H=this.rowSelection;var F=this.cellSelection;if((F==="single")||(F==="multiple")){E=(this._XSO&&this._XSO.isIn(this._getXSOElementFromCellID(I)))}else{if((H==="single")||(H==="multiple")){var J=this._getNodeModelAt(I);if(J){var G=this.getNodesXSO();if(G){E=G.isIn(J)}}}}return E},isCellPreselected:function(E){return(this._getPreselectedCellID()===E)},isCellActive:function(E){return(this.getActiveCellID()===E)},setActiveCell:function(F){var G=this.getActiveCellID();if(G!==F){this._activeCellStableID=this._getXSOElementFromCellID(F);if(this.elements.statusBar){this.elements.statusBar.updateActiveCellID(F)}if(G>=0){var E=this.getEditionManager(G);if(E){s._pushUserInteractionContext();E.onCellUnactivate(G);s._popUserInteractionContext()}this._updateRenderedCellAttributes(G)}if(F>=0){var E=this.getEditionManager(F);if(E){E.onCellActivate(F)}this._updateRenderedCellAttributes(F);this.ensureCellVisible(F)}}this._setLastRangeCell(F)},getCellEditableState:function(E){return false},getEditionManager:function(E){return null},_addCellInEdition:function(E){if(this._cellInEdition===undefined){this._cellInEdition={}}this._cellInEdition[E]=true},_removeCellInEdition:function(E){if(typeof this._cellInEdition!=="undefined"){delete this._cellInEdition[E]}},_isCellInEdition:function(F){if((typeof this._cellInEdition!=="undefined")&&(this._cellInEdition[F]===true)){return true}if(!this.getCellEditableState(F)){return false}var E=this.getEditionManager(F);if(E){return E.isCellAlwaysInEdition(F)}return false},_setEditionMode:function(F,E){if(!this.getCellEditableState(F)){return false}var G=this._getViewAt(F);if(G&&G._reusableContent){if(E){this._addCellInEdition(F);G._reusableContent.getContent().setAttribute("tabindex",-1)}else{this._removeCellInEdition(F);G._reusableContent.getContent().removeAttribute("tabindex")}if(G._reusableContent.readOnly!==!E){G._reusableContent.readOnly=!E;this._onEditionModeChanged(F,E)}}return true},_onEditionModeChanged:function(F,E){},setFocusOnCellContentFlag:function(E){if(E){this._focusActiveCellContent();this._focusOnCellMode=true}else{if(this._focusOnCellMode){this.getContent().focus();this._focusOnCellMode=false}}},getFocusOnCellContentFlag:function(){return this._focusOnCellMode},_focusActiveCellContent:function(){var E=this._getViewAt(this.getActiveCellID());if(E&&E._reusableContent&&E._reusableContent._giveFocus){E._reusableContent._giveFocus();if(!s.isActiveElementInContainer(E._reusableContent.getContent())){this.getContent().focus()}}else{this.getContent().focus()}},getActiveCellID:function(){return this._getCellIDFromXSOElement(this._activeCellStableID)},_setLastRangeCell:function(E){if(this._lastRangeCellID!==E){this._lastRangeCellID=E;this.ensureCellVisible(E)}},_getLastRangeCellID:function(){return this._lastRangeCellID},_computeCellIDFromActiveCell:function(F,G,E){return -1},_applyRowSelection:function(){this.getContent().setAttribute("row-selection",this.rowSelection);this.unselectAll();if(this._isReady){this._renderViewport({updateCellContent:true,updateCellLayout:false,updateCellAttributes:true})}},_applyCellSelection:function(){this.getContent().setAttribute("cell-selection",this.cellSelection);this.unselectAll()},getNodesXSO:function(){var F=null;var E=this.getTreeDocument();if(E){F=E.getXSO()}return F},getCellsXSO:function(){return this._XSO},selectNodeModel:function(H,F,E){var P=this.rowSelection;if(H&&((P==="single")||(P==="multiple"))){var M=this.layout;if(E&&(P==="multiple")){var I=this.getActiveCellID();if(I>=0){var Q=M.getCellsFromNodeModel(H);if(Q&&(Q.length>0)){var N=M.computeCellRange(I,Q[0]);if(N){var K=this.getTreeDocument();if(K){var J=K.getXSO();if(J){if(!F){var O=[];J.get().forEach(function(R){if(!M.isNodeModelInRange(R,I,Q[0])){O.push(R)}});if(O.length>0){J.remove(O)}}var G=[];for(var L=0;L<N.length;L++){var H=this._getNodeModelAt(N[L]);if(H&&!J.isIn(H)&&K.options.shouldBeSelected.call(K,H)){G.push(H)}}if(G.length>0){J.add(G)}}}}}}}else{if(F&&(P==="multiple")){H.select()}else{H.select(true)}}}},unselectNodeModel:function(E){if(E){E.unselect()}},selectCell:function(L,E,O){var P=this.rowSelection;var G=this.cellSelection;if(this.cellShouldBeSelected(L)&&((P==="single")||(P==="multiple")||(G==="single")||(G==="multiple"))){var N=this;var K=this.layout;if((G==="single")||(G==="multiple")){if(this._XSO){if(O&&(G==="multiple")){var I=this.getActiveCellID();var M=K.computeCellRange(I,L);if(M){var H=[];this._XSO.get().forEach(function(Q){if(!K.isCellInRange(N._getCellIDFromXSOElement(Q),I,L)){H.push(Q)}});if(H.length>0){this._XSO.remove(H)}for(var J=0;J<M.length;J++){M[J]=this._getXSOElementFromCellID(M[J])}this._XSO.add(M)}}else{if(E&&(G==="multiple")){this._XSO.add(this._getXSOElementFromCellID(L))}else{this._XSO.unique(this._getXSOElementFromCellID(L))}}}}else{if(this.selectionBehavior.selectNodeModelOnCellSelection!==false){var F=this._getNodeModelAt(L);if(F){this.selectNodeModel(F,E,O)}}}if(!O){this.setActiveCell(L)}else{this._setLastRangeCell(L)}}else{this.setActiveCell(L)}},unselectCell:function(G){if(this.cellShouldBeUnselected(G)){var E=this.cellSelection;if((E==="single")||(E==="multiple")){if(this._XSO){this._XSO.remove(this._getXSOElementFromCellID(G))}}else{var F=this.rowSelection;if((F==="single")||(F==="multiple")){var H=this._getNodeModelAt(G);if(H){H.unselect()}}}}},selectAll:function(){if(this.rowSelection==="multiple"){var E=this.getTreeDocument();if(E){E.selectAll()}}},selectAllVisibleNodes:function(){if(this.rowSelection==="multiple"){var E=this.getTreeDocument();if(E){var F=[];E.withTransactionUpdate(function(){E._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(G){if(E.options.shouldBeSelected.call(E,G.nodeModel)){F.push(G.nodeModel)}}});E.getXSO().empty();E.getXSO().add(F)})}}},unselectAll:function(){if(this._XSO){this._XSO.empty()}var E=this.getTreeDocument();if(E){E.unselectAll()}},isEveryVisibleNodeSelected:function(){var E=false;var G=this.getTreeDocument();if(G){var J=G.getXSO();if(J){var H=this.model;var K=J.get();E=(H.length===K.length);if(!E&&(G.options.shouldBeSelected!==G.defaultOptions.shouldBeSelected)){E=true;for(var I=0;I<H.length;I++){var L=H[I];var F=G.options.shouldBeSelected.call(G,L);if(F&&!J.isIn(L)){E=false;break}}}}}return E},cellShouldBeSelected:function(E){return((E>=0)&&(E<this.model.length))},cellShouldBeUnselected:function(E){return((E>=0)&&(E<this.model.length))},_setPreselectedCell:function(G){var E=this._getPreselectedCellID();if(E!==G){this._preselectedCellStableID=(G!==undefined)?this._getXSOElementFromCellID(G):undefined;if(E>=0){this._updateRenderedCellAttributes(E);var F=this.getEditionManager(E);if(F){F.onCellEndPreselect(E)}}if(G>=0){this._updateRenderedCellAttributes(G);var F=this.getEditionManager(G);if(F){F.onCellPreselect(G)}}}},_getPreselectedCellID:function(){return(this._preselectedCellStableID!==undefined)?this._getCellIDFromXSOElement(this._preselectedCellStableID):undefined},_manageSelection:function(){if(this.supportsSelection()){var F=this;this._XSO=new h({useUniqueID:true,getElementID:this.getXSOElementID});this._XSO.onPostAdd(function(G){G.forEach(function(H){var I=F._getCellIDFromXSOElement(H);F._updateRenderedCellAttributes(I)})});this._XSO.onPostRemove(function(G){G.forEach(function(H){var I=F._getCellIDFromXSOElement(H);F._updateRenderedCellAttributes(I)})});var E;s.addEventOnElement(this,this,k.POINTERMOVE,function(G,H){if(k.isTouchEvent(G)){F._preventSelectionForTouchScroll=true;clearTimeout(E);E=setTimeout(function(){F._preventSelectionForTouchScroll=false},2000)}if(H){F._setPreselectedCell(H.cellID)}else{F._setPreselectedCell(undefined)}});s.addEventOnElement(this,this,"mouseleave",function(){F._setPreselectedCell(undefined)});s.addEventOnElement(this,this,k.POINTERHIT,function(H,I){if(H.multipleHitCount===2&&I){H.preventDefault();var G=F.getEditionManager(I.cellID);if(G){G.onCellDoubleClick(I.cellID)}}});document.addEventListener("copy",function(H){if(F._useClipboardFlag&&F._isFocused()){var G=F._copyToPlainText();if(H&&H.clipboardData){H.clipboardData.setData("text/plain",G)}else{var I=window.clipboardData;if(I){I.setData("Text",G)}}H.preventDefault();if(F._hiddenInput){F._hiddenInput.destroy();F._hiddenInput=null;if(F._oldActiveElement){F._oldActiveElement.focus();F._oldActiveElement=null}}}});document.addEventListener("paste",function(I){if(F._useClipboardFlag&&F._isFocused()){var J=null;if(I.clipboardData){J=I.clipboardData}else{J=window.clipboardData;if(J){F._pasteFromPlainText(J.getData("Text"))}}if(J&&J.items){for(var H=0;H<J.items.length;H++){var G=J.items[H];if(G.type==="text/plain"){G.getAsString(function(K){F._pasteFromPlainText(K)});break}}}I.preventDefault();if(F._hiddenInput){F._hiddenInput.destroy();F._hiddenInput=null;if(F._oldActiveElement){F._oldActiveElement.focus();F._oldActiveElement=null}}}})}},_activateHiddenInput:function(){if(!this._hiddenInput){this._hiddenInput=new i.Element("input",{styles:{width:"1px",height:"1px",top:"0px",left:"0px",position:"absolute",opacity:0}});this._hiddenInput.setAttribute("type","text");this._hiddenInput.inject(this.elements.container)}this._oldActiveElement=document.activeElement;this._hiddenInput.value=" ";this._hiddenInput.focus();this._hiddenInput.select()},_onSpaceKeyPressed:function(){var E=this.getActiveCellID();if(E!==undefined){this.isCellSelected(E)?this.unselectCell(E):this.selectCell(E,true,false)}},_copyToPlainText:function(){},_pasteFromPlainText:function(E){},_manageKeyboard:function(){var E=this;E.elements.container.setAttribute("tabindex","0");if(E.supportsKeyboardNavigation()){var F={"ctrl+c":"copy","ctrl+v":"paste","ctrl+x":"cut",del:"deleteKeyPressed","ctrl+a":"selectAll",esc:{keydown:"escape"},"shift+return":"shiftEnter","return":"enter",space:"spaceKeyPressed","ctrl+space":"ctrlSpaceKeyPressed",up:"upMove",right:"rightMove",down:"downMove",left:"leftMove","ctrl+up":"ctrlUp","ctrl+right":"ctrlRight","ctrl+down":"ctrlDown","ctrl+left":"ctrlLeft","shift+up":"shiftUp","shift+right":"shiftRight","shift+down":"shiftDown","shift+left":"shiftLeft","ctrl+shift+up":"shiftUp","ctrl+shift+right":"shiftRight","ctrl+shift+down":"shiftDown","ctrl+shift+left":"shiftLeft","shift+ctrl+up":"shiftUp","shift+ctrl+right":"shiftRight","shift+ctrl+down":"shiftDown","shift+ctrl+left":"shiftLeft",tab:"tab","shift+tab":"shiftTab",pageup:"pageup",pagedown:"pagedown","shift+pageup":"shiftPageup","shift+pagedown":"shiftPagedown",home:"home",end:"end","ctrl+home":"ctrlHome","ctrl+end":"ctrlEnd","shift+home":"shiftHome","shift+end":"shiftEnd",f2:"f2",defaultKey:"defaultKeyEventCallback"};E.keymaps=F;E.commands=x}},_registerPool:function(E,G,H){var F=this;this._pool.register({id:E,buildContent:function(){var I=new H();I.cellType=E;I.collectionView=F;I.getContent().setAttribute("is-visible",false);I.getContent().inject(G);return I}})},_registerPools:function(){var E=this.cellClass;this._registerPool("__item__",this.elements.poolContainer,E);this._registerPool("__sync_item__",this.elements.poolContainerSyncRel,E);this._registerPool("__top_item__",this.elements.headerPoolContainer,E);this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,E);this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,E);this._registerPool("__left_item__",this.elements.leftPoolContainer,E);this._registerPool("__right_item__",this.elements.rightPoolContainer,E)},initialize:function(){},_postBuildView:function(){var E=this;E._registerPools();this.layout.collectionView=this;this._lastModelViewport={minCellID:0,maxCellID:0};E._isReady=false;s.onNodeRendered(this._getScroller().getContent(),function(){if(l){console.time("onNodeRendered")}if(!E._isReady){E._isReady=true;E.initialize();E._initialize();E._applyVirtualViewportSize();E._updateDimensions();E.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:true});var G=f.debounce(function(){E._requestDelayedModelData()},1);s.addResizeListener(E._getScroller().elements.container,function(){E._updateDimensions();E.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false});E._onEndResizeOrOnReadyModelCompletionRequest("OnEndResize");G();E._modelEvents.publish({event:"ENDRESIZE",context:E})},100);E._onEndResizeOrOnReadyModelCompletionRequest("OnReady");E._requestDelayedModelData();E._isInitialized=true;E._onPrivateReady();E._modelEvents.publish({event:"READY",context:E})}else{E._updateDimensions();var F=E._getScroller();F._updatePosition();E.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false});E._onScrollBegin(F);E._onScroll(F);E._onScrollEnd(F)}if(l){console.timeEnd("onNodeRendered")}})},onReady:function(E){if(this._isReady){E()}return this._modelEvents.subscribe({event:"READY"},E)},getCellInfosFromHtmlElement:function(H){var E=this;var F=s.firstParentWithClass(H,"wux-layouts-collectionview-cell");if(F){var G=parseInt(F.getAttribute("cell-id"),10);var I=E.getCellInfosAt(G);I.cellView=E._getViewAt(G);I.manager=E;return I}},addEventListener:function(G,I,F){var E=this;var H=function(L){if(!E._isRequestingCell){L.dsModel=E;var J=s.firstParentWithClass(L.target,"wux-layouts-collectionview-cell");if(J){var K=parseInt(J.getAttribute("cell-id"),10);if(!isNaN(K)){var M=E.getCellInfosAt(K);M.cellView=E._getViewAt(K);I(L,M)}}else{I(L)}}};E.getContent().addEventListener(G,H,F);return H},_onEndResizeOrOnReadyModelCompletionRequest:function(F){var E=this;if(E._onEndResizeOrOnReadyModelRequestCB){if(!E._isRequestingEndResizeOrOnReadyModelUpdate){E._isRequestingEndResizeOrOnReadyModelUpdate=true;setTimeout(function(){E._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},function(){E.invalidateLayout({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});E._isRequestingEndResizeOrOnReadyModelUpdate=false});var H=E.getViewportDimensions();var I=Math.floor((H.width-E.layout.gutter)/(E.layout._getColumnWidth()+E.layout.gutter));var G=Math.ceil((H.height-E.layout.gutter)/(E.layout._getRowHeight()+E.layout.gutter));E._onEndResizeOrOnReadyModelRequestCB.call(E,{model:E.model,RowMaxNumber:G,ColumnsMaxNumber:I,viewportDimensions:H,event:F})},1)}}},_onEndResize:function(E){return this._modelEvents.subscribe({event:"ENDRESIZE"},E)},getCellIDAsString:function(E){return String(E)},getStatusBarContainerHeight:function(){if(!this.elements.statusBar){return 0}var E=this.elements.statusBar.items.getRoots();if(E.length===0){return 0}if(this._getCurrentTouchMode()){return 39}else{return 23}},buildStatusBar:function(E){var F=this.elements.statusBar;if(!F&&E.length>0){F=new A({collectionView:this});F.inject(this.getContent());this.elements.statusBar=F}if(F){var G=F.items.getRoots().length;F.setModel(E);if(G===0&&E.length>0||G>0&&E.length===0){this.invalidateLayout({updateCellContent:false,updateCellLayout:false,updateCellAttributes:false})}}},_applyHeight:function(){this.elements.container.style.height=this.height==="inherit"?"":(this.height+"px");if(this.height==="inherit"){this.elements.container.setStyles({position:"absolute",top:0,left:0,bottom:0,width:"100%"})}else{this.elements.container.setStyles({position:"",top:"",left:"",bottom:"",width:""})}},_buildLayout:function(){this.elements.container=new i.Element("div",{"class":"wux-layouts-collectionview",styles:{overflow:"hidden",width:"100%",position:"relative",height:this.height==="inherit"?"":this.height}});this.elements.container.setAttribute("platform-name",t.Platform.name);this.elements.container.setAttribute("layout",this.layout.name);if(this.height==="inherit"){s.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"})}this.elements.header=new i.Element("div",{"class":"wux-layouts-header"}).inject(this.elements.container);this.elements.leftHeaderPoolContainer=new i.Element("div",{"class":"wux-layouts-left-header-poolcontainer"}).inject(this.elements.header);this.elements.rightHeaderPoolContainer=new i.Element("div",{"class":"wux-layouts-right-header-poolcontainer"}).inject(this.elements.header);this.elements.headerScrollContainer=new i.Element("div",{"class":"wux-layouts-header-scroller-container"}).inject(this.elements.header);this.elements.headerPoolContainer=new i.Element("div",{"class":"wux-layouts-header-poolcontainer"}).inject(this.elements.headerScrollContainer);this.elements.leftScrollContainer=new i.Element("div",{"class":"wux-layouts-left-scroller-container"}).inject(this.elements.container);this.elements.leftSpacerContainer=new i.Element("div",{"class":"wux-layouts-left-spacer-container"}).inject(this.elements.container);this.elements.leftPoolContainer=new i.Element("div",{"class":"wux-layouts-left-poolcontainer"}).inject(this.elements.leftScrollContainer);this.elements.rightScrollContainer=new i.Element("div",{"class":"wux-layouts-right-scroller-container"}).inject(this.elements.container);this.elements.rightSpacerContainer=new i.Element("div",{"class":"wux-layouts-right-spacer-container"}).inject(this.elements.container);this.elements.rightPoolContainer=new i.Element("div",{"class":"wux-layouts-right-poolcontainer"});this.elements.rightScroller=new w(this.elements.rightPoolContainer,{scrollEndTimeout:o}).inject(this.elements.rightScrollContainer);this.elements.rightScroller._id="right";this.elements.body=new i.Element("div",{"class":"wux-layouts-body"}).inject(this.elements.container);this.elements.scrollContainerRel=new i.Element("div",{"class":"wux-layouts-gridengine-scroller-container","show-at-hover":this.showScrollbarsOnHover}).inject(this.elements.body);this.elements.poolContainer=new i.Element("div",{"class":"wux-layouts-gridengine-poolcontainer-rel",styles:{position:"relative",height:"100%",width:"100%"}});this.elements.scroller=new w(this.elements.poolContainer,{scrollEndTimeout:o}).inject(this.elements.scrollContainerRel);this.elements.scroller._id="center";this.elements.poolContainerSync=new i.Element("div",{"class":"wux-layouts-gridengine-poolcontainer-sync"});this.elements.poolContainerSyncRel=new i.Element("div",{"class":"wux-layouts-gridengine-poolcontainer-sync-rel"});this.elements.poolContainerSyncRel.inject(this.elements.poolContainerSync);this.elements.poolContainerSync.inject(this.elements.scrollContainerRel)},_updateDimensions:function(){this._dimensions=this.getContent().getDimensions();this._updateViewportDimensions()},getDimensions:function(){if(!this._dimensions){this._updateDimensions()}return this._dimensions},_updateViewportDimensions:function(){var E=this.elements.scrollContainerRel.getDimensions();this._viewportDimensions=(E.height>0)?E:this.getContent().getDimensions()},getViewportDimensions:function(E){if(E){var G=this.layout.getContentDimensions();var H=this._viewportDimensions.width>G.width?0:i.Utils.Client.getScrollbarWidth();var F=this._viewportDimensions.height>G.height?0:i.Utils.Client.getScrollbarWidth();return{width:this._viewportDimensions.width-F,height:this._viewportDimensions.height-H}}else{if(!this._viewportDimensions){this._viewportDimensions=this._getScroller().getContent().getDimensions()}return this._viewportDimensions}},_getScroller:function(){return this.elements.scroller},getScrollerDeltaPosition:function(){return this.__cachedDeltaScrollPos},getScrollerPosition:function(G){if(this.__cachedScrollPos&&!G){return this.__cachedScrollPos}else{var E=this._getScroller();if(E){var F=E.getPosition();return{x:-F.x,y:-F.y}}else{return{x:0,y:0}}}},setScrollerPosition:function(J){var P=this;var L=this._getScroller().elements.container;var M=P.getScrollerPosition();J=i.extend({x:M.x,y:M.y,animate:false},J);if(J.animate){var K=function(R,Q,T,S){R/=S/2;if(R<1){return T/2*R*R+Q}R--;return -T/2*(R*(R-2)-1)+Q};var I=L.scrollLeft,O=J.x-I,H=L.scrollTop,N=J.y-H,E=Date.now(),F=500;var G=function(){y.addTask({callback:function(){var Q=Date.now()-E;L.scrollLeft=K(Q,I,O,F);L.scrollTop=K(Q,H,N,F);if(Q<F){G()}else{L.scrollLeft=J.x;L.scrollTop=J.y}},taskArgs:[]})};G()}else{this._getScroller().elements.container.scrollLeft=J.x;this._getScroller().elements.container.scrollTop=J.y}},_onScrollBegin:function(E){var F=this;if(!F._activeScroller&&(E!==F._synchronizedScroller)){F._activeScroller=E;F._scrollDistanceFromBeginning=0;F.lockUI()}F._preventSelectionForTouchScroll=true},_onScroll:function(T){var O=this;if(!O._activeScroller||(O._activeScroller!==T)){if(O._synchronizedScroller===T){O._synchronizedScroller=null}return}var M=O._activeScroller.getPosition();var H=O.elements.scroller.getPosition();var R={x:-H.x,y:-M.y};O.__cachedScrollDistance=Math.sqrt((R.x-O.__cachedScrollPos.x)*(R.x-O.__cachedScrollPos.x)+(R.y-O.__cachedScrollPos.y)*(R.y-O.__cachedScrollPos.y));O._scrollDistanceFromBeginning+=O.__cachedScrollDistance;O.__cachedDeltaScrollPos={x:R.x-O.__cachedScrollPos.x,y:R.y-O.__cachedScrollPos.y};O.__cachedScrollPos=R;if((O.__cachedDeltaScrollPos.x===0)&&(O.__cachedDeltaScrollPos.y===0)){return}if(T!==O.elements.scroller){if(O.elements.scroller.elements.container.scrollTop!==R.y){O._synchronizedScroller=O.elements.scroller;O.elements.scroller.elements.container.scrollTop=R.y}}else{if(O._rightContainerWidth>0){if(O.elements.rightScroller.elements.container.scrollTop!==R.y){O._synchronizedScroller=O.elements.rightScroller;O.elements.rightScroller.elements.container.scrollTop=R.y}}}O._setPreselectedCell(undefined);O.elements.headerPoolContainer.setStyle("left",(-R.x)+"px");O.elements.leftPoolContainer.setStyle("top",(-R.y)+"px");if(O._onInfiniteScrollCB&&(O.__cachedDeltaScrollPos.x>0||O.__cachedDeltaScrollPos.y>0)){var E=O.getViewportDimensions();var W=O.__cachedContentDimensions;var F=W.height-E.height-2;if(F-O._infiniteScrollingVerticalDistance>0){F=F-O._infiniteScrollingVerticalDistance}var I=W.width-E.width-2;if(I-O._infiniteScrollingHorizontalDistance>0){I=I-O._infiniteScrollingHorizontalDistance}var V=false,U=false,K=false,J=false;var Q=O.pageScrollValueTriggeringInfiniteScroll;if(Q!=undefined){if(i.is(Q,"number")){if(Q<=0||Q>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1."}U=(Math.abs(R.y)+Q*E.height>=Q*W.height);J=(Math.abs(R.y)>=F&&F>0);V=(Math.abs(R.x)>=I&&I>0)}else{if(i.is(Q,"object")){if(Q.x!=undefined){if(Q.x<=0||Q.x>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x publish property. Please provide a value strictly between 0 and 1."}V=(Math.abs(R.x)+Q.x*E.width>=Q.x*W.width);K=(Math.abs(R.x)>=I&&I>0)}else{V=(Math.abs(R.x)>=I&&I>0)}if(Q.y!=undefined){if(Q.y<=0||Q.y>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y publish property. Please provide a value strictly between 0 and 1."}U=(Math.abs(R.y)+Q.y*E.height>=Q.y*W.height);J=(Math.abs(R.y)>=F&&F>0)}else{U=(Math.abs(R.y)>=F&&F>0)}}}}else{V=(Math.abs(R.x)>=I&&I>0);U=(Math.abs(R.y)>=F&&F>0)}if(U||V){if(!O._isRequestingModelUpdate){O._isRequestingModelUpdate=true;setTimeout(function(){O._modelEvents.subscribeOnce({event:"infiniteScrollDone"},function(){O.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false});O._isRequestingModelUpdate=false});O._onInfiniteScrollCB.call(O,{reachBottom:U,reachRight:V,isVeryCloseFromRight:K,isVeryCloseFromBottom:J})},1)}}}var N=!O.layout.isCellLayoutValidAt(0);if(l){var L=window.performance?performance.now():Date.now();if(O._scrollTimestamp){var S=L-O._scrollTimestamp;console.log("CollectionView elapsedBetweenScrolls = "+S)}O._scrollTimestamp=L}var G=80;var P=false;if(P&&(O._scrollDistanceFromBeginning>100)){if(O.supportsLightRendering()){O._renderViewport({updateCellContent:false,updateCellLayout:N,updateCellAttributes:false,lightRendering:true})}y.addTask({namespace:"wux-collectionview-"+O._uuid,callback:function(Z){var Y=O._renderViewport({updateCellContent:false,updateCellLayout:N,updateCellAttributes:false,allottedTime:G});if(Y&&(Y.taskInterrupted!==undefined)){O._renderingTaskInterrupted=Y.taskInterrupted}O._scrollDistanceFromBeginning=0},taskArgs:[O._scrollDistanceFromBeginning]},"wux-collectionview-rendering")}else{var X=O._renderViewport({updateCellContent:false,updateCellLayout:N,updateCellAttributes:false,allottedTime:G});if(X&&(X.taskInterrupted!==undefined)){O._renderingTaskInterrupted=X.taskInterrupted}}},_onPrivateScrollEnd:function(){},_onScrollEnd:function(E){var F=this;if(F._activeScroller===E){F._activeScroller=null;F.unlockUI();F._requestDelayedModelData();F._onPrivateScrollEnd();if(F._renderingTaskInterrupted){var G=!F.layout.isCellLayoutValidAt(0);F._renderViewport({updateCellContent:false,updateCellLayout:G,updateCellAttributes:false});F._renderingTaskInterrupted=false}}F._preventSelectionForTouchScroll=false},isInitialized:function(){return this._isInitialized},_initialize:function(){var H=this;H._isRendering(false);H.__cachedScrollPos={x:0,y:0};H.__cachedDeltaScrollPos={x:0,y:0};H.__cachedScrollDistance=0;H._renderingTaskInterrupted=false;var F=this.elements.scroller;H._scrollDistanceFromBeginning=0;H._activeScroller=null;H._synchronizedScroller=null;F.onScrollBegin(function(M){H._onScrollBegin(F)});F.onScroll(function(M){H._onScroll(F)});F.onScrollEnd(function(M){H._onScrollEnd(F)});var L=this.elements.rightScroller;L.onScrollBegin(function(M){H._onScrollBegin(L)});L.onScroll(function(M){H._onScroll(L)});L.onScrollEnd(function(M){H._onScrollEnd(L)});var G=function(N){var M=N.deltaY;if(N.deltaMode&&(N.deltaMode===1)){M*=H.layout.cellHeight}F.elements.container.scrollTop=F.elements.container.scrollTop+M};s.addEventOnElement(H,H.elements.leftPoolContainer,"wheel",G);s.addEventOnElement(H,H.elements.poolContainerSync,"wheel",G);s.addEventOnElement(H,H.elements.rightPoolContainer,"wheel",G);if(this.supportsCustomScrolling()){H.getContent().addClassName("supportsCustomScrolling");var J=function(M){clearInterval(H._inertiaInterval);if(M.touches.length<=1){H._infoOnTouchDown={clientX:M.touches[0].clientX,clientY:M.touches[0].clientY,scrollLeft:F.elements.container.scrollLeft,scrollTop:F.elements.container.scrollTop,firstTarget:M.currentTarget};s.addEventOnElement(H,document,"touchmove",I,{passive:false});s.addEventOnElement(H,document,"touchend",K);if(M.currentTarget===H.elements.poolContainerSync||M.currentTarget===H.elements.rightPoolContainer){s.removeEventOnElement(H,H.elements.poolContainerSync,"wheel",G);s.removeEventOnElement(H,H.elements.rightPoolContainer,"wheel",G);H._touchStartELRemoved=true}}};var I=function(M){if(!H._preventScroll&&M.touches.length<=1){M.preventDefault();if(!H._previousTouch){H._previousTouch={}}if(!H._scrollDirection){if(Math.abs(M.touches[0].clientY-H._infoOnTouchDown.clientY)>5){H._scrollDirection="y"}else{if(Math.abs(M.touches[0].clientX-H._infoOnTouchDown.clientX)>5||M.firstTarget===H.elements.headerPoolContainer){H._scrollDirection="x"}else{return}}}E(H._scrollDirection==="y"?M.touches[0].clientY:M.touches[0].clientX)}};var E=function(O){var N=new Date().getTime();if(H._infoOnTouchDown){if(H._scrollDirection==="y"&&H._infoOnTouchDown.firstTarget!==H.elements.headerPoolContainer){var M=H._infoOnTouchDown.scrollTop-(O-H._infoOnTouchDown.clientY);if(F.elements.container.scrollTop!==M){H._previousTouch.direction=F.elements.container.scrollTop<M;F.elements.container.scrollTop=M}if(H._previousTouch.timeStamp&&H._previousTouch.timeStamp!==N&&F.elements.container.scrollTop!==H._previousTouch.scroll){H._speed=(F.elements.container.scrollTop-H._previousTouch.scroll)/(N-H._previousTouch.timeStamp)}H._previousTouch.scroll=F.elements.container.scrollTop}else{if(H._infoOnTouchDown.firstTarget===F.getContent()||H._infoOnTouchDown.firstTarget===H.elements.headerPoolContainer){var M=H._infoOnTouchDown.scrollLeft-(O-H._infoOnTouchDown.clientX);if(F.elements.container.scrollLeft!==M){H._previousTouch.direction=F.elements.container.scrollLeft<M;F.elements.container.scrollLeft=M}if(H._previousTouch.timeStamp&&H._previousTouch.timeStamp!==N&&F.elements.container.scrollLeft!==H._previousTouch.scroll){H._speed=(F.elements.container.scrollLeft-H._previousTouch.scroll)/(N-H._previousTouch.timeStamp)}H._previousTouch.scroll=F.elements.container.scrollLeft}}H._previousTouch.client=O;H._previousTouch.timeStamp=N}};var K=function(S){s.removeEventOnElement(H,document,"touchmove",I);s.removeEventOnElement(H,document,"touchend",K);if(H._touchStartELRemoved){H._touchStartELRemoved=undefined;s.addEventOnElement(H,H.elements.poolContainerSync,"wheel",G);s.addEventOnElement(H,H.elements.rightPoolContainer,"wheel",G)}if(Math.abs(H._speed)>=0.6){var M=0;var Q=H._speed;var N=H._previousTouch.client;var T=H._previousTouch.direction;var U=new Date().getTime();var P=H._previousTouch.timeStamp;var O=Math.min(Math.abs(Q)*1000/2,1500);var R=function(){M++;var V=new Date().getTime();var X=T?1:-1;if(V-U>=O){H._scrollDirection=null;H._infoOnTouchDown=null;H._previousTouch=null;clearInterval(H._inertiaInterval);return}var W=N-(V-P)*Q*(1-(V-U)/O);E(W);N=W;P=V};H._inertiaInterval=setInterval(R,5);R()}else{H._scrollDirection=null;H._infoOnTouchDown=null;H._previousTouch=null}};s.addEventOnElement(H,H.elements.leftPoolContainer,"touchstart",J);s.addEventOnElement(H,F.getContent(),"touchstart",J);s.addEventOnElement(H,H.elements.rightPoolContainer,"touchstart",J);s.addEventOnElement(H,H.elements.headerPoolContainer,"touchstart",J)}},_onPrivateReady:function(){},lockUI:function(){this._getScroller().getContent().classList.add("wux-ui-locked")},unlockUI:function(){this._getScroller().getContent().classList.remove("wux-ui-locked")},onPostUpdateView:function(E){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},E)},onPostUpdateViewOnce:function(E){return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},E)},_freeUpCell:function(G,H){var F=this;var E=F._getRenderedCellAt(G);if(E){if(a){console.log("free up cellID = "+G+" mode = "+H)}switch(H){default:case 0:break;case 1:E.component.getContent().setAttribute("is-visible",false);break;case 2:E.component.getContent().remove();break}E.component.__disposable__.dispose();F._listOfRenderedCells["delete"](G);if(l){this._numberOfCellFree++}}},_freeUpPool:function(F){var E=this;if(F===undefined){F=1}E._listOfRenderedCells.forEach(function(G,H){E._freeUpCell(H,F)});E._listOfRenderedCells.clear();if(a){console.log("==> free up pool")}},_applyVirtualViewportSize:function(){var U=this.layout;if(!U.isValid()){U.prepareLayout()}var E=this.getViewportDimensions();var S=U.getContentDimensions();var G=U.getLeftContainerWidth();var F=U.getRightContainerWidth();var W=E.width<S.width;var I=E.height<S.height;var Q=I&&(F===0);var T=i.Utils.Client.getScrollbarWidth();if(I&&(F>0)){F+=T}if(!this.__cachedContentDimensions||(this.__cachedContentDimensions.width!==S.width)||(this.__cachedContentDimensions.height!==S.height)||(this._leftContainerWidth!==G)||(this._rightContainerWidth!==F)||(this._hasHorizontalOverflow!==W)){this.__cachedContentDimensions=S;this.elements.poolContainerSync.setStyle("bottom",W?T+"px":0+"px");this.elements.poolContainerSync.setStyle("right",Q?T+"px":0+"px");var V=S.width+"px";this.elements.poolContainer.setStyle("width",V);this.elements.poolContainerSyncRel.setStyle("width",V);this.elements.headerPoolContainer.setStyle("width",V);var H=(S.height+(W?0:1))+"px";this.elements.poolContainer.setStyle("height",H);this.elements.poolContainerSyncRel.setStyle("height",H);this.elements.leftPoolContainer.setStyle("height",H);this.elements.rightPoolContainer.setStyle("height",H);this.elements.scrollContainerRel.setAttribute("has-overflow-x",W?true:false);if(W&&this.showScrollbarsOnHover){this.elements.scrollContainerRel.setStyle("height","calc(100% + "+T+"px)");this.elements.scrollContainerRel.setStyle("margin-bottom","-"+T+"px)")}this.elements.scrollContainerRel.setAttribute("has-overflow-y",Q?true:false);if(Q&&this.showScrollbarsOnHover){this.elements.scrollContainerRel.setStyle("margin-right","-"+T+"px)")}}var L=U.getHeaderContainerHeight();var M=this.getStatusBarContainerHeight();if((this._headerContainerHeight!==L)||(this._statusBarContainerHeight!==M)||(this._hasHorizontalOverflow!==W)){this._headerContainerHeight=L;this._statusBarContainerHeight=M;var K=L+"px";this.elements.header.setStyle("height",K);if(this.elements.statusBar){var N=M+"px";this.elements.statusBar.height=N}var J="calc(100% - "+(L+M)+"px)";this.elements.body.setStyle("height",J);J="calc(100% - "+(L+M+(W?T:0))+"px)";this.elements.leftScrollContainer.setStyle("height",J);this.elements.rightScrollContainer.setStyle("height",J);this.elements.rightScrollContainer.setStyle("top",L);this.elements.leftSpacerContainer.setStyle("height",W?T:0)+"px";this.elements.leftSpacerContainer.setStyle("bottom",M+"px");this.elements.rightSpacerContainer.setStyle("height",W?T:0)+"px";this.elements.rightSpacerContainer.setStyle("bottom",M+"px")}if(this._leftContainerWidth!==G){this._leftContainerWidth=G;var V=G+(U.getLeftContainerWidth()>0?1:0)+"px";this.elements.leftHeaderPoolContainer.setStyle("width",V);this.elements.leftScrollContainer.setStyle("width",V);this.elements.leftSpacerContainer.setStyle("width",V);this.elements.headerScrollContainer.setStyle("margin-left",V);this.elements.body.setStyle("margin-left",V)}if(this._rightContainerWidth!==F){var R=this._rightContainerWidth;this._rightContainerWidth=F;var V=F+(U.getRightContainerWidth()>0?1:0)+"px";this.elements.rightHeaderPoolContainer.setStyle("width",V);this.elements.rightScrollContainer.setStyle("width",V);this.elements.rightSpacerContainer.setStyle("width",V);this.elements.headerScrollContainer.setStyle("margin-right",V);this.elements.body.setStyle("margin-right",V);if((R<=0)&&(this._rightContainerWidth>0)){var O=this.getScrollerPosition();this.elements.rightScroller.elements.container.scrollTop=O.y}}var P=(F>0)?"hidden":"auto";this.elements.scroller.getContent().setStyle("overflow-y",P);this._hasHorizontalOverflow=W},getCellInfosAt:function(F){var E=this.getModelAt(F);return{cellID:F,cellModel:E,nodeModel:E}},getLightCellInfosAt:function(E){return{cellID:E}},getVisibleCellsInViewport:function(){return this._visibleCellsInViewport},_getViewAt:function(F){var E=this._getRenderedCellAt(F);if(E){return E.component}else{return null}},getTreeDocument:function(){return null},_getNodeModelAt:function(E){if(E<this.model.length){return this.model[E]}else{throw"You try to access a cell outside the model bounds"}},getModelAt:function(E){return this._getNodeModelAt(E)},_getModelAt:function(E){return this.getModelAt(E)},_getRenderedCellAt:function(E){return this._listOfRenderedCells.get(E)},_setRenderedCellAt:function(F,E){this._listOfRenderedCells.set(F,E)},updateView:function(E){return this._renderViewport(E)},prepareUpdateView:function(){this._updateCounter++},pushUpdateView:function(E,F){this._updateCounter--;if((this._updateCounter===0)&&(this._updateNeeded||F)&&this._isReady){this.updateView(E)}},invalidateLayout:function(E){this.layout._invalidate(E);if(this._isReady){if(!E){E={}}this._renderViewport(E)}},updateCellView:function(F,E){if(E&&(E.updateCellContent||(E.updateCellLayout===true)||E.updateCellAttributes||E.updateCellVisiblity)){var G=this._getViewAt(F);if(G){var H;if(E.updateCellContent){H=this.getCellInfosAt(F)}else{H=this.getLightCellInfosAt(F)}H.cellView=G;if(E.updateCellContent){this._requestCellContent(H)}if(E.updateCellLayout===true){this._layoutCell(H)}if(E.updateCellAttributes){this._applyAttributesOnCell(H)}if(E.updateCellVisiblity){G.getContent().setAttribute("is-visible",true)}}}},_updateRenderedCellAttributes:function(E){this.updateCellView(E,{updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},_renderCell:function(K,I){var H=this;var J=H.layout;var G=I;H._visibleCellsInViewport[K]=K;var F=H._getRenderedCellAt(K);if(F&&(!I||(!I.updateCellContent&&!I.updateCellLayout&&!I.updateCellAttributes&&!I.updateCellVisiblity))&&!J.cellTypeCanChangeOnScroll(K)){return}var E=J.getCellType(K);if((F===undefined)||(F.component.cellType!==E)){if(F&&(F.component.cellType!==E)){H._freeUpCell(K,1)}F=H._pool.use(E);H._setRenderedCellAt(K,F);G={updateCellContent:true,updateCellLayout:(I&&(I.updateCellLayout==="ignore"))?false:true,updateCellAttributes:true,updateCellVisiblity:true}}H.updateCellView(K,G);return F},_renderViewport:function(H){var F=this;var I=F.layout;var G={taskInterrupted:false};if(F._updateCounter>0){F._updateNeeded=true;return G}if(D){performance.mark("render-begin")}if(l){F._numberOfCellContentRequests=0;F._numberOfCellLayouts=0;F._numberOfCellApplyAttributes=0;F._numberOfCellFree=0;F._numberOfCellFreeAtEnd=0}if(F._isRendering()===false){F.beginRendering();var H=i.extend({updateCellContent:false,updateCellLayout:true,updateCellAttributes:true},H);F._isRendering(true);if(l){console.time("  ## render-viewport ##");m=0;z=0}if(!I.isValid()){I.prepareLayout();H.updateCellLayout=true;if(H.freePool){F._freeUpPool(1)}}if(D){performance.mark("render-visible-cells-begin")}F._visibleCellsInViewport={};var E=i.clone(H);E.render=function(J){F._renderCell(J,H)};G=I.renderListOfVisibleCellsInViewport(E);if(G&&G.taskInterrupted){H.taskInterrupted=true}F._postRender(H);F._isRendering(false);this._updateNeeded=false;F.endRendering()}return G},_postRender:function(F){var E=this;var G=E.layout;if(D){performance.mark("render-visible-cells-end")}if(r){console.groupEnd("render-cell")}G.postRender();G._isInvalid=false;E._applyVirtualViewportSize();if(!F||(!F.lightRendering&&!F.taskInterrupted)){E._listOfRenderedCells.forEach(function(H,I){if(E._visibleCellsInViewport[I]===undefined){if(l){E._numberOfCellFreeAtEnd++}E._freeUpCell(I,1)}})}if(D){performance.mark("render-complete")}if(l){console.timeEnd("  ## render-viewport ##");console.info("        nb of rendered cells : "+this._listOfRenderedCells.size+"  content requested : "+this._numberOfCellContentRequests+"  layouted : "+this._numberOfCellLayouts+"  Apply Attributes : "+this._numberOfCellApplyAttributes);console.info("           nb of freed cells : ",this._numberOfCellFree+" at end : "+this._numberOfCellFreeAtEnd);console.info("           nbChangedPropertiesToAdd : "+m+" nbChangedPropertiesToRemove : "+z)}E._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:E,data:{hasAborted:false}})},_isRendering:function(E){if(E!==undefined){this.__isRendering=E}else{return this.__isRendering!==undefined?this.__isRendering:false}},onInfiniteScroll:function(F,E){E=i.extend({horizontalTolerance:10,verticalTolerance:10},E);this._infiniteScrollingHorizontalDistance=E.horizontalTolerance;this._infiniteScrollingVerticalDistance=E.verticalTolerance;this._onInfiniteScrollCB=F},infiniteScrollProcessDone:function(){this._modelEvents.publish({event:"infiniteScrollDone",context:this})},onEndResizeOrOnReadyModelRequest:function(E){this._onEndResizeOrOnReadyModelRequestCB=E},EndResizeOrOnReadyModelRequestDone:function(){return this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},_requestCellContent:function(E){if(this._onCellRequest){this._onCellRequest(E)}if(l){this._numberOfCellContentRequests++}},_layoutCell:function(L){var J=this.layout;var F=J.getLayoutStylesForCellAt(L.cellID);var G=F||{};var K=u(L.cellView.__cachedStyles,G);L.cellView.__cachedStyles=G;var H=L.cellView.getContent();var E;for(E in K.toAdd){H.style[E]=K.toAdd[E]}for(var E in K.toRemove){H.style[E]=""}var I=J.getCssClassesForCellAt(L.cellID);if(I&&L.cellView.__cachedCssClasses!==I){L.cellView.__cachedCssClasses=I;H.setAttribute("class","wux-layouts-collectionview-cell "+I)}if(l){this._numberOfCellLayouts++}},getCellAttributesAt:function(F){var E={};if(this.isCellPreselected(F.cellID)){E["is-preselected"]=true}if(this.isCellSelected(F.cellID)){E["is-selected"]=true}if(this.isCellActive(F.cellID)){E["is-active"]=true}return E},_applyAttributesOnCell:function(I){var F=this.getCellAttributesAt(I);var G=this.layout.getLayoutAttributesForCellAt(I.cellID);i.extend(F,G);var H=u(I.cellView.__cachedAttributes,F);I.cellView.__cachedAttributes=F;for(var E in H.toAdd){I.cellView.getContent().setAttribute(E,H.toAdd[E])}for(var E in H.toRemove){I.cellView.getContent().removeAttribute(E,H.toRemove[E])}if(l){this._numberOfCellApplyAttributes++}},registerReusableCellContent:function(E){this._reusableCellContentManager.register(E)},_reuseCellContent:function(G,E){var F=E._getReusableContent();if(F&&F.__disposable__&&(F.__disposable__.identifier===G)){}else{if(F&&F.__disposable__){}var H=this._reusableCellContentManager.use(G);F=H.component;E._setReusableContent(F)}return F},reuseCellContent:function(E){var F=this._reusableCellContentManager.use(E);return F.component},onCellRequest:function(E){this._onCellRequest=E},_applyProperties:function(E){this._parent(E);if(this.isDirty("layout")){this._applyLayout(E.layout)}if(this.isDirty("height")){this._applyHeight(E.height)}if(this.isDirty("rowSelection")){this._applyRowSelection(E.rowSelection)}if(this.isDirty("cellSelection")){this._applyCellSelection(E.cellSelection)}if(this.isDirty("showScrollbarsOnHover")){this._applyShowScrollbarsOnHover(E.showScrollbarsOnHover)}if(this.isDirty("showBackgroundFlag")){this._applyShowBackgroundFlag(E.showBackgroundFlag)}},_applyLayout:function(E){this.layout.collectionView=this;this.getContent().setAttribute("layout",this.layout.name);if(this._isReady){this.invalidateLayout({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});this.setScrollerPosition({x:0,y:0})}},_applyModel:function(E){if(this._isReady){this._isRendering(false);this.invalidateLayout({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});this._requestDelayedModelData();if(this.elements.statusBar){this.elements.statusBar.updateTotalRows(this.model.length)}}},_requestDelayedModelData:function(){},_applyShowScrollbarsOnHover:function(E){if(this.elements.scrollContainerRel){this.elements.scrollContainerRel.setAttribute("show-at-hover",this.showScrollbarsOnHover?true:false)}},_applyShowBackgroundFlag:function(E){if(this.showBackgroundFlag){this.getContent().removeAttribute("no-background")}else{this.getContent().setAttribute("no-background","")}},beginRendering:function(){},endRendering:function(){},beginTransition:function(){},endTransition:function(){},scrollToCellAt:function(G){if(typeof G==="number"){G={cellID:G}}G=i.extend({animate:false},G);var F=this.layout.getPositionForCellAt(G.cellID);var E=F.left;var H=F.top;this.setScrollerPosition({x:E,y:H,animate:G.animate})},ensureCellVisible:function(K,E){if(K===-1){return}var I=this.layout;var L=I.getPositionForCellAt(K);var H=I.getDimensionsForCellAt(K);var O=this.getScrollerPosition();var J=this._getScroller().getContent().getDimensions();var P=I.getContentDimensions();var F=(J.width<P.width)?i.Utils.Client.getScrollbarWidth():0;var Q=(J.height<P.height)?i.Utils.Client.getScrollbarWidth():0;var G=I.gutter||0;var N={x:O.x,y:O.y};if(N.y+J.height-F<L.top+H.height+G){N.y=L.top+H.height+G-J.height+F}if(N.y>L.top-G){N.y=L.top-G}var M=I.getCellType(K);if(M==="__item__"){if(N.x+J.width-Q<L.left+H.width+G){N.x=L.left+H.width+G-J.width+Q}if(N.x>L.left-G){N.x=L.left-G}}if((O.x!==N.x)||(O.y!==N.y)){this.setScrollerPosition({x:N.x,y:N.y,animate:E})}},ensureNodeModelVisible:function(H,E){var F=this.layout;var G=F.getCellsFromNodeModel(H);if(G&&(G.length>0)){this.ensureCellVisible(G[0],E)}},_processPoolCells:function(F){var E=this;this._listOfRenderedCells.forEach(function(G,H){F.call(E,{cellView:G})})},_enableAutoScroll:function(F,G){this._autoScrollDistance=F||{x:0,y:0};this._autoScrollPeriod=G||20;this._disableAutoScroll();if(this._autoScrollInterval===undefined){var E=this;this._autoScrollInterval=window.setInterval(function(){var H=E._getScroller().elements.container;var I=H.scrollTop;var J=H.scrollLeft;if(I>=0){H.scrollTop=I+E._autoScrollDistance.y}if(J>=0){H.scrollLeft=J+E._autoScrollDistance.x}},this._autoScrollPeriod)}},_setAutoScrollVelocity:function(E){this._autoScrollDistance=E||{x:0,y:0}},_disableAutoScroll:function(){if(this._autoScrollInterval!==undefined){window.clearInterval(this._autoScrollInterval);delete this._autoScrollInterval}}});return B});define("DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider",["DS/CollectionView/modelProviders/CollectionViewModelProvider","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],function(c,a,e){var b=false;var d=c.inherit({name:"CollectionViewTreeDocumentModelProvider",publishedProperties:{},getModelClass:function(){return a},addModelEvents:function(){var i=this;var h=this.collectionView.applicativeModel;if(h){var g=0;var f=h.addModelEventListener("prepareUpdate",function(j){if(b){console.log("prepareUpdate")}g++});this.modelEventsListener.push(f);f=h.addModelEventListener("pushUpdate",function(j){if(b){console.log("pushUpdate")}g--;if(g<0){console.error("You pushed too many updates")}if(g===0){if(i.collectionView.keyboardMutePoolrefresh){return}if(i.collectionView._cellUISelectionAction===true||i.collectionView.modelUISelectionAction===true){i.collectionView._updateAllPoolSelectedViews()}else{i.collectionView.model=i.flattenApplicativeModel(i.collectionView.applicativeModel);i.collectionView.invalidateLayout({updateCellContent:true})}}});this.modelEventsListener.push(f);f=h.onNodeModelUpdate(function(j){if(g===0){i.collectionView.model=i.flattenApplicativeModel(i.collectionView.applicativeModel);i.collectionView.invalidateLayout({updateCellContent:true})}});this.modelEventsListener.push(f);f=h.onPostExpand(function(){if(b){console.log("onPostExpand")}i.model=i.flattenApplicativeModel(i.collectionView.applicativeModel);i.collectionView.invalidateLayout()});this.modelEventsListener.push(f);f=h.onPostCollapse(function(){if(b){console.log("onPostCollapse")}i.collectionView.model=i.flattenApplicativeModel(i.collectionView.applicativeModel);i.collectionView.invalidateLayout()});this.modelEventsListener.push(f)}},removeModelEvents:function(){var g=this.collectionView.applicativeModel;if(g&&g.getModelEvents()){for(var f=0;f<this.modelEventsListener.length;f++){g.getModelEvents().unsubscribe(this.modelEventsListener[f])}this.modelEventsListener.splice(0,this.modelEventsListener.length)}},flattenApplicativeModel:function(f){var h;var g=this;if(f){h=f.getAllDescendants().filter(function(i){return g.isNodeVisible(i)})}return h},fillApplicativeModelFromViewModel:function(h,f){if(h&&f){for(var g=0;g<f.length;g++){var j=f[g];if(j instanceof e){h.addRoot(j)}}}},getNodeModelRowID:function(g,f){return g._getRowID(f)},selectAllVisibleNodes:function(){var f=this.collectionView.applicativeModel;if(f){var h=[];var g=this.getNodesXSO();f.withTransactionUpdate(function(){f._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(i){h.push(i.nodeModel)}});g.empty();g.add(h)});if(this.model&&this.model.length){this.collectionView.setActiveNode(this.collectionView.model[this.model.length-1],false)}}},unselectAll:function(){var f=this.collectionView.applicativeModel;if(f){f.unselectAll()}},isNodeVisible:function(f){return f.isVisible()},shouldAcceptDrag:function(f){return f.getTreeDocument().options.shouldAcceptDrag(f)},dumpNodeModel:function(g,f){return g.getTreeDocument().dump(g)},selectNode:function(h,i){var f=this.collectionView.applicativeModel;if(!f){return}var g=this.getNodesXSO();if(!g){return}if(f.getXSO()===g){h.select(i)}else{this._parent(h,i)}},unSelectNode:function(h){var f=this.collectionView.applicativeModel;if(!f){return}var g=this.getNodesXSO();if(!g){return}if(f.getXSO()===g){h.unselect()}else{this._parent(h)}},isNodeSelected:function(h){var f=this.collectionView.applicativeModel;if(!f){return}var g=this.getNodesXSO();if(!g){return}if(f.getXSO()===g){return h.isSelected()}else{return this._parent(h)}},getNodesXSO:function(){if(!this.collectionView.supportsSelection()){return null}if(this.collectionView.selectionManagedByView){this.selectionModel=this._parent()}else{var f=this.collectionView.applicativeModel;this.selectionModel=f.getXSO()}return this.selectionModel},getXSOElementID:function(f){return f._getID()},getPropertyValue:function(g,f){if(f=="badges"){return g.getBadges()}else{if(f=="icon"){return(g.options.icons&&g.options.icons.length)?g.options.icons[0]:null}else{if(f=="picture"){return g.options.thumbnail}else{if((f=="propertiesList")||(f=="statusbarIconsTooltips")||(f=="statusbarIcons")||(f=="contextualMenu")){return UWA.clone(g.options[f])}else{return g.options[f]}}}}}});return d});define("DS/CollectionView/ResponsiveCollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/CollectionView/CollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTileView","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Selection/XSO","DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider","DS/CollectionView/commands/CollectionViewCommands"],function(g,a,n,e,m,q,o,d,p,h,s,b,u,v,t,i,l,f,w,r){var j=false;var k=false;var c=u.inherit({name:"ResponsiveCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},modelProvider:{defaultValue:null,type:"object"},model:{defaultValue:[],type:"array"},selectionBehavior:{defaultValue:{unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,canInteractiveMultiselectWithCheckboxClick:true,enableShiftSelection:true,enableFeedbackForActiveCell:true},type:"object"},displayedOptionalCellProperties:{defaultValue:["All"],type:"array"},displayTitleTooltip:{defaultValue:true,type:"boolean"},displayPropertiesTooltip:{defaultValue:true,type:"boolean"},displayStatusbarTooltip:{defaultValue:true,type:"boolean"},useDragAndDrop:{defaultValue:false,type:"boolean"},onDragStartCell:{defaultValue:function(y,x){return this.onDragStartCellDefault(y,x)},type:"function"},onDragCell:{defaultValue:function(y,x){return this.onDragCellDefault(y,x)},type:"function"},onDragEndCell:{defaultValue:function(y,x){return this.onDragEndCellDefault(y,x)},type:"function"},onDragEnterBlank:{defaultValue:function(y,x){return this.onDragEnterBlankDefault(y,x)},type:"function"},onDragOverBlank:{defaultValue:function(y,x){return this.onDragOverBlankDefault(y,x)},type:"function"},onDragLeaveBlank:{defaultValue:function(y,x){return this.onDragLeaveBlankDefault(y,x)},type:"function"},onDragEnterCell:{defaultValue:function(y,x){return this.onDragEnterCellDefault(y,x)},type:"function"},onDragOverCell:{defaultValue:function(y,x){return this.onDragOverCellDefault(y,x)},type:"function"},onDragLeaveCell:{defaultValue:function(y,x){return this.onDragLeaveCellDefault(y,x)},type:"function"},onDropBlank:{defaultValue:function(y,x){return this.onDropBlankDefault(y,x)},type:"function"},onDropCell:{defaultValue:function(y,x){return this.onDropCellDefault(y,x)},type:"function"},allowUnsafeHTMLContent:{defaultValue:undefined,type:"boolean",noNeedToApplyFlag:true},shouldCellAllowUnsafeHTMLContentAt:{defaultValue:function(x){return this.allowUnsafeHTMLContent},type:"function",noNeedToApplyFlag:true}},selectionManagedByView:false,onDragStartCellDefault:function(B,x){var y=undefined;var z=x.nodeModel;var A=x.manager.getNodesXSO().isIn(z);if(x.manager.modelProvider.shouldAcceptDrag(z)&&A){B.dataTransfer.setData("Text",JSON.stringify(x.manager.modelProvider.dumpNodeModel(x.nodeModel)));B.dataTransfer.effectAllowed="move"}else{B.preventDefault()}B._webUXpreventDefault=B.defaultPrevented},onDragCellDefault:function(y,x){y._webUXpreventDefault=y.defaultPrevented},onDragEnterBlankDefault:function(y,x){x.manager._getScroller().getContent().addClassName("wux-ui-state-drag-over");y._webUXpreventDefault=y.defaultPrevented},onDragLeaveBlankDefault:function(y,x){x.manager._getScroller().getContent().removeClassName("wux-ui-state-drag-over");y._webUXpreventDefault=y.defaultPrevented},onDragEnterCellDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented},onDragOverCellDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented},onDragLeaveCellDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented},onDragOverBlankDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented},onDragEndCellDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented},onDropBlankDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented;return false},onDropCellDefault:function(y,x){y.preventDefault();y._webUXpreventDefault=y.defaultPrevented;return false},_applyProperties:function(x){this._parent(x);if(this.isDirty("displayedOptionalCellProperties")){this._applyDisplayedOptionalCellProperties(x.displayedOptionalCellProperties)}if(this.isDirty("modelProvider")){this._applyModelProvider(x.modelProvider)}this._applyModel(x.model);if(this.isDirty("displayTitleTooltip")){this._applyDisplayTitleTooltip(x.displayTitleTooltip)}if(this.isDirty("displayPropertiesTooltip")){this._applyDisplayPropertiesTooltip(x.displayPropertiesTooltip)}if(this.isDirty("displayStatusbarTooltip")){this._applyDisplayStatusbarTooltip(x.displayStatusbarTooltip)}if(this.isDirty("useDragAndDrop")){this._applyUseDragAndDrop(x.useDragAndDrop)}},_applyDisplayedOptionalCellProperties:function(x){this._displayedOptionalCellProperties=[];if(this.displayedOptionalCellProperties.length===0){this._displayedOptionalCellProperties=["All"];return}if(this.displayedOptionalCellProperties.length>=1){if(this.displayedOptionalCellProperties.indexOf("All")!==-1){this._displayedOptionalCellProperties=["All"];return}else{if(this.displayedOptionalCellProperties.indexOf("None")!==-1){this._displayedOptionalCellProperties=["None"];return}}}for(var y=0;y<this.displayedOptionalCellProperties.length;y++){if(this.displayedOptionalCellProperties[y]==="contextualMenu"||this.displayedOptionalCellProperties[y]==="description"||this.displayedOptionalCellProperties[y]==="propertiesList"||this.displayedOptionalCellProperties[y]==="statusbarIcons"||this.displayedOptionalCellProperties[y]==="activeFlag"){this._displayedOptionalCellProperties.push(this.displayedOptionalCellProperties[y])}}},_applyDisplayTitleTooltip:function(x){this.invalidateLayout()},_applyDisplayPropertiesTooltip:function(x){this.invalidateLayout()},_applyDisplayStatusbarTooltip:function(x){this.invalidateLayout()},_applyUseDragAndDrop:function(x){if(this.useDragAndDrop!==x){this._processPoolCells(function(z){var y=z.cellView.component;if(y){if(this.useDragAndDrop===true){y.elements.container.setAttribute("draggable","true")}else{y.elements.container.setAttribute("draggable","false")}}})}},getTreeDocument:function(){return this.applicativeModel},_applyModelProvider:function(x){if(!this.modelProvider){throw"modelProvider is mandatory for CollectionView model representation. Please provide a not null modelProvider."}this.modelProvider.collectionView=this},_applyModel:function(x){if(this.model!==x){if(this._applyModelPending===true){return}this._applyModelPending=true;if(!this.applicativeModel){if(this.model instanceof this.modelProvider.getModelClass()){this.loadApplicativeModel(this.model)}else{if(this.model&&this.model.length!==0){var y=new (this.modelProvider.getModelClass())();this.modelProvider.fillApplicativeModelFromViewModel(y,this.model);this.loadApplicativeModel(y)}}}else{if(this.model instanceof this.modelProvider.getModelClass()){this._RemoveModelEvents();this.activeNode=null;this.TreedocModel=null;this.applicativeModel=null;this.loadApplicativeModel(this.model);this.setScrollerPosition({x:0,y:0})}if(!this.model){this.unloadApplicativeModel();this.setScrollerPosition({x:0,y:0})}}this._parent(x);this._applyModelPending=false}},_interactiveCumulativeSelection:false,_preBuild:function(){this._xsoEventsListener=[];this._observeSelMultiSelSet=false;this.modelProvider=new w();this._observeContextualMenuSet=false;this._needToSelectAtRelease=false;this._parent();this.elements.leftScrollContainer.style.display="none";this.elements.rightScrollContainer.style.display="none"},_manageKeyboard:function(){this._parent();var A=this.commands.shiftUp;var B=this.commands.shiftRight;var x=this.commands.shiftDown;var D=this.commands.shiftLeft;var z=this.commands.shiftPageup;var y=this.commands.shiftPagedown;var E=this.commands.shiftHome;var C=this.commands.shiftEnd;g.extend(this.commands,{copy:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"copy",data:F?F.get():null})},paste:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"paste",data:F?F.get():null})},cut:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"cut",data:F?F.get():null})},deleteKeyPressed:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"deleteKeyPressed",data:F?F.get():null})},spaceKeyPressed:function(){if(this.activeNode){this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode)}},ctrlSpaceKeyPressed:function(){if(this.activeNode){this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode)}},tab:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:F?F.get():null})},shiftTab:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:F?F.get():null})},f2:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"f2",data:F?F.get():null})},enter:function(){var F=this.getNodesXSO();this._modelEvents.publish({event:"enter",data:F?F.get():null})},shiftUp:function(){if(!this._modeIsShiftSel){this.commands.upMove.call(this)}else{A.call(this)}},shiftRight:function(){if(!this._modeIsShiftSel){this.commands.rightMove.call(this)}else{B.call(this)}},shiftDown:function(){if(!this._modeIsShiftSel){this.commands.downMove.call(this)}else{x.call(this)}},shiftLeft:function(){if(!this._modeIsShiftSel){this.commands.leftMove.call(this)}else{D.call(this)}},shiftPageup:function(){if(!this._modeIsShiftSel){this.commands.pageup.call(this)}else{z.call(this)}},shiftPagedown:function(){if(!this._modeIsShiftSel){this.commands.pagedown.call(this)}else{y.call(this)}},shiftHome:function(){if(!this._modeIsShiftSel){this.commands.home.call(this)}else{E.call(this)}},shiftEnd:function(){if(!this._modeIsShiftSel){this.commands.end.call(this)}else{C.call(this)}}})},_postBuildView:function(){this._parent();var x=this;x.addEventListener(i.POINTERDOWN,x._onCellPointerDown,false);x.addEventListener("click",x._onCellClick,false);if(this._observeDragAndDropEventsFlag===undefined){this._observeDragAndDropEvents();this._observeDragAndDropEventsFlag=true}},supportsKeyboardNavigation:function(){return true},supportsSelection:function(){return true},onPostCellRequest:function(x){this._onPostRequestCellCB=x},getNodesXSO:function(){return this.modelProvider.getNodesXSO()},loadApplicativeModel:function(y){if(y){if(this.applicativeModel===y){return}var x=this;this.applicativeModel=y;this.TreedocModel=y;this.model=this.modelProvider.flattenApplicativeModel(y);if(this.model&&this.model.length){this.lastSelectedNode=this.model[0];this.activeNode=null}if(this._observeSelMultiSelSet===false){this._observeSelMultiSel();this._observeSelMultiSelSet=true}if(this._observeDoubleClickEventSet===undefined){this._observeDoubleClickEvent();this._observeDoubleClickEventSet=true}if(this._observeContextualMenuSet===false){this._observeContextualMenuEvent();this._observeContextualMenuSet=true}this._AddModelEvents()}},unloadApplicativeModel:function(){this._RemoveModelEvents();this.activeNode=null;this.applicativeModel=null;this.TreedocModel=null;this.model=[]},loadGridViewModel:function(x){this.loadApplicativeModel(x);if(x){this.TreedocModel=x}},unloadGridViewModel:function(){this.unloadApplicativeModel();this.TreedocModel=null},_requestDelayedModelData:function(){if(this.onDelayedModelDataRequest){var x=this;var D=this.layout;var C=x.getViewportDimensions();if(C.height>0){var A=D._computeMinCellID();var E=Math.floor((C.width-x.layout.gutter)/(x.layout._getColumnWidth()+x.layout.gutter));var z=Math.ceil((C.height-x.layout.gutter)/(x.layout._getRowHeight()+x.layout.gutter));var B=A+(E*z)-1;var y=x.getTreeDocument();if(y){y.prepareUpdate()}x.onDelayedModelDataRequest.call(x,{collectionView:x,startNodeIndex:A,endNodeIndex:B});if(y){y.pushUpdate()}}}},onSelectionAdd:function(x){return this._modelEvents.subscribe({event:"selectionAdded"},x)},onSelectionRemove:function(x){return this._modelEvents.subscribe({event:"selectionRemoved"},x)},onCellDoubleClick:function(x){return this._modelEvents.subscribe({event:"dblclick"},x)},onCellTitleClick:function(x){return this._modelEvents.subscribe({event:"cellTitleClick"},x)},onCellsCopy:function(x){return this._modelEvents.subscribe({event:"copy"},x)},onCellsPaste:function(x){return this._modelEvents.subscribe({event:"paste"},x)},onCellsCut:function(x){return this._modelEvents.subscribe({event:"cut"},x)},onEnterPressed:function(x){return this._modelEvents.subscribe({event:"enter"},x)},onDeleteKeyPressed:function(x){return this._modelEvents.subscribe({event:"deleteKeyPressed"},x)},onTabKeyPressed:function(x){return this._modelEvents.subscribe({event:"tab"},x)},onf2Pressed:function(x){return this._modelEvents.subscribe({event:"f2"},x)},onInteractiveCumulativeSelectionChanged:function(x){return this._modelEvents.subscribe({event:"interactiveCumulativeSelectionChanged"},x)},selectCell:function(y,x,z){this.keyboardMutePoolrefresh=true;if(z===true){this._shiftKeyboardSelection=true}this._parent(y,x,z);this.keyboardMutePoolrefresh=false;this._shiftKeyboardSelection=false;if(y>=0&&y<this.model.length){this._setActiveNode(this.model[y],true)}if(!z){this.lastSelectedNode=this.activeNode}},selectNodeModel:function(A,y,x){if(A){var G=this;var C=this.layout;if(x){var D=C.computeCellRange(this.modelProvider.getNodeModelRowID(G.lastSelectedNode,true),this.modelProvider.getNodeModelRowID(A,true));if(D){var E=this.getNodesXSO();if(E){var F=[];E.get().forEach(function(H){if(!C.isNodeModelInRange(H,G.modelProvider.getNodeModelRowID(G.lastSelectedNode),G.modelProvider.getNodeModelRowID(A))){F.push(H)}});if(F.length>0){E.remove(F)}var z=[];for(var B=0;B<D.length;B++){var A=this._getNodeModelAt(D[B]);if(A&&!E.isIn(A)){z.push(A)}}if(z.length>0){E.add(z)}}}}else{if(y){this.modelProvider.selectNode(A)}else{this.modelProvider.selectNode(A,true)}}}},selectAllVisibleNodes:function(){if(this.selectionBehavior.canMultiSelect===true){return this.modelProvider.selectAllVisibleNodes()}},unselectAll:function(){return this.modelProvider.unselectAll()},setActiveNode:function(y,x){return this._setActiveNode(y,x)},getLabel:function(x){return this.modelProvider.getPropertyValue(x,"label")},getBadges:function(x){return this.modelProvider.getPropertyValue(x,"badges")},getSubLabel:function(x){return this.modelProvider.getPropertyValue(x,"subLabel")},getDescription:function(x){return this.modelProvider.getPropertyValue(x,"description")},getCustomTooltip:function(x){return this.modelProvider.getPropertyValue(x,"customTooltip")},getMultipleTitleLineNumber:function(x){return this.modelProvider.getPropertyValue(x,"multipleTitleLineNumber")},getPropertiesList:function(x){return this.modelProvider.getPropertyValue(x,"propertiesList")},getThumbnail:function(x){return this.modelProvider.getPropertyValue(x,"picture")},getIcon:function(x){return this.modelProvider.getPropertyValue(x,"icon")},getStatusbarIconsTooltips:function(x){return this.modelProvider.getPropertyValue(x,"statusbarIconsTooltips")},getStatusbarIcons:function(x){return this.modelProvider.getPropertyValue(x,"statusbarIcons")},getActiveFlag:function(x){return this.modelProvider.getPropertyValue(x,"activeFlag")},getEmptyStatusbarVisibleFlag:function(x){return this.modelProvider.getPropertyValue(x,"emptyStatusbarVisibleFlag")},getContextualMenu:function(x){return this.modelProvider.getPropertyValue(x,"contextualMenu")},getColor:function(x){return this.modelProvider.getPropertyValue(x,"color")},getClickableTitle:function(x){return this.modelProvider.getPropertyValue(x,"clickableTitle")},_AddModelEvents:function(){var z=this;if(this._modelEventsAlreadyAdded){return}this._modelEventsAlreadyAdded=true;var y=this.getNodesXSO();if(y){var x=y.onAdd(function(B){if(k){console.log("onAdd")}z.modelUISelectionAction=true;z._modelEvents.publish({event:"selectionAdded",context:B,data:B});if((!z.activeNode||!z.modelProvider.isNodeSelected(z.activeNode))&&!z._shiftKeyboardSelection){z._setActiveNode(B)}});this._xsoEventsListener.push(x);x=y.onPostAdd(function(B){z._updatePoolSelectedViews(B);z.modelUISelectionAction=false});this._xsoEventsListener.push(x);x=y.onRemove(function(B){if(k){console.log("onRemove")}z.modelUISelectionAction=true;z._modelEvents.publish({event:"selectionRemoved",context:B,data:B})});this._xsoEventsListener.push(x);x=y.onPostRemove(function(B){z._updatePoolSelectedViews(B);z.modelUISelectionAction=false});this._xsoEventsListener.push(x);this._modelEvents.subscribe({event:"active"},function A(B){z._updateAllPoolSelectedViews()})}return this.modelProvider.addModelEvents()},_RemoveModelEvents:function(){this._modelEventsAlreadyAdded=false;var y=this.getNodesXSO();if(y){for(var x=0;x<this._xsoEventsListener.length;x++){y.unsubscribe(this._xsoEventsListener[x])}this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}return this.modelProvider.removeModelEvents()},_observeSelMultiSel:function(){var x=this;x._isInteractiveMultiSelMode=false;x._modeIsMultiSel=false;x._modeIsShiftSel=false;g.Element.addEvent.call(document,"keydown",function(z){var y=g.Event.whichKey(z);if(x.selectionBehavior.enableShiftSelection&&(y==="shift"||y==="meta+[")){x._modeIsShiftSel=true}else{if(x.selectionBehavior.canMultiSelect&&(y==="ctrl"||y==="meta+[")){x._modeIsMultiSel=true}}if(y==="ctrl+pageup"||y==="ctrl+pagedown"){z.preventDefault()}});g.Element.addEvent.call(document,"keyup",function(z){var y=g.Event.whichKey(z);if(y==="ctrl"||y==="meta+["){x._modeIsMultiSel=false}if(y==="shift"||y==="meta+["){x._modeIsShiftSel=false}})},_observeDoubleClickEvent:function(){var x=this;x.elements.container.addEventListener(i.POINTERHIT,function(z){if(z.multipleHitCount===2){var y=x._firstParentWithClass(z.target,"wux-layouts-collectionview-cell");if(z.which===1&&y){var A=x.getCellInfosFromHtmlElement(y);A.event=z;if(A.cellModel!==undefined){x._modelEvents.publish({event:"dblclick",context:A.cellModel,data:A})}}}})},_observeContextualMenuEvent:function(){var y=this;var x=y.onContextualEvent;if(x){l.addEventListener(this.elements.container,{callback:function(A){var z=y._cellCtxMenuRequired?true:false;y._cellCtxMenuRequired=false;if(!z){return x.callback.call(x["this"],{context:A.context,infos:A.info,data:A.data,cellInfos:undefined,infoContext:A.context})}else{return[]}}})}},_firstParentWithClass:function(z,y){var x=z;if(x){var A=(" "+x.className+" ").replace(/[\n\t]/g," ").indexOf(" "+y+" ")>-1;if(A){return x}else{return this._firstParentWithClass(x.parentNode,y)}}else{return}},_onCellClickForTouchOrPointerDownForMouse:function(E,J,x){E._cellUISelectionAction=true;var K=E.getNodesXSO();if(!K){return}if(J&&J.cellView){E._needToSelectAtRelease=false;E._pointerDownOnBlank=false;if(E.modelProvider.isNodeSelected(J.cellModel)&&!E._modeIsShiftSel){if(i.isTouchEvent(x)){if(E.selectionBehavior.toggle&&E._isInMultiSelection()===true){E.modelProvider.unSelectNode(J.cellModel)}}else{E._needToSelectAtRelease=true;E._cellUISelectionAction=false;return}}else{if(!E._isInMultiSelection()&&!E._modeIsShiftSel){K.empty()}E._setActiveNode(J.cellModel,false);E.modelProvider.selectNode(J.cellModel);if(!E._modeIsShiftSel){E.lastSelectedNode=J.cellModel}E._cellUISelectionAction=false}if(E._modeIsShiftSel){E._cellUISelectionAction=true;E._shiftKeyboardSelection=true;K.empty();var y=E.lastSelectedNode;var F=J.cellModel;if(y&&F){var A=E.modelProvider.getNodeModelRowID(y,true);var D=E.modelProvider.getNodeModelRowID(F,true);var B=D>A?A:D;var H=B===A?D:A;var z=E.model;var C=0;var G=[];for(C=B;C<=H;C++){var I=z[C];if(E.modelProvider.isNodeVisible(I)&&!E.modelProvider.isNodeSelected(I)){G.push(I)}}E._setActiveNode(J.cellModel,false);K.add(G)}E._shiftKeyboardSelection=false;E._cellUISelectionAction=false}}else{E._cellUISelectionAction=false;E._pointerDownOnBlank=true;if(i.isTouchEvent(x)){E._onClickOnEmptyArea(E,x)}}},_onCellPointerDown:function(z,A){var y=z.dsModel;var x=y.getNodesXSO();if(!x){return}if(i.isTouchEvent(z)){return}else{return y._onCellClickForTouchOrPointerDownForMouse(y,A,z)}},_onClickOnEmptyArea:function(D,C){var B=D.getNodesXSO();if(!B){return}if(D.selectionBehavior.unselectAllOnEmptyArea===true){D._cellUISelectionAction=true;var A=D.getViewportDimensions();var E=D.layout.getContentDimensions();var z=0;if(C.target===D.elements.scroller.getContent()){if(D.layout.direction==="vertical"){z=A.height<E.height?18:0}else{if(D.layout.direction==="horizontal"){z=A.width<E.width?18:0}}}var y=Math.max(E.width,A.width-z);var x=Math.max(E.height,A.height-z);if(C.offsetX<y&&C.offsetY<x){D._disableInteractiveMultiSelMode();B.empty();D._updatePoolSelectedViews()}D._cellUISelectionAction=false}},_onCellClick:function(z,A){var y=z.dsModel;var x=y.getNodesXSO();if(!x){return}if(i.isTouchEvent(z)){return y._onCellClickForTouchOrPointerDownForMouse(y,A,z)}else{if(A&&A.cellView){y._cellUISelectionAction=true;y._pointerDownOnBlank=false;if(y._needToSelectAtRelease===true){if(y._isInMultiSelection()===false){x.empty();y._setActiveNode(A.cellModel,false);y.modelProvider.selectNode(A.cellModel);y.lastSelectedNode=A.cellModel}else{if(y.selectionBehavior.toggle){y.modelProvider.unSelectNode(A.cellModel)}}}y._cellUISelectionAction=false;y._needToSelectAtRelease=false}else{if(y._pointerDownOnBlank){y._onClickOnEmptyArea(y,z)}y._pointerDownOnBlank=false}}},_isInMultiSelection:function(){return(this._modeIsMultiSel||this._isInteractiveMultiSelMode)},_getNewActiveNodeInfos:function(y,F){var D=this;var B=D.modelProvider.getNodeModelRowID(y,true);var C=B+F;var A=(F!==0)?undefined:y;var x=Math.ceil(D.model.length/D.layout._numberOfColumns);var E=Math.ceil((B+1)/D.layout._numberOfColumns);var z=(D.layout._numberOfColumns===F&&x===E)||(-D.layout._numberOfColumns===F&&1===E);while(F!==0){A=C<D.model.length?D.model[C]:undefined;if(z){break}if(!A){if(F>0){F--;C--}else{F++;C++}}else{break}}return{index:C,node:A}},_onCellTitleClick:function(x){this._modelEvents.publish({event:"cellTitleClick",context:x,data:x})},_computeIncrementToMove:function(L){var H=this;var z=!H.activeNode?H.lastSelectedNode:H.activeNode;if(z){var B=H.modelProvider.getNodeModelRowID(z,true);var M=H.getScrollerPosition();var F=H._getScroller();var G=F.getContent().getDimensions();var J=M.y;var E=M.x;var y,y;if(H.layout.direction==="vertical"){var y=Math.round(G.height/(H.layout._getRowHeight()+H.layout.gutter));var I=H.layout._numberOfColumns}else{if(H.layout.direction==="horizontal"){var y=H.layout._numberOfRows;var I=Math.round(G.width/(H.layout._columnWidth+H.layout.gutter))}}var N=0;var D=0;var A=0;var K=0;var C=1;var x=0;if(H.layout.direction==="vertical"){D=B-B%H.layout._numberOfColumns;A=(D*(H.layout._getRowHeight()+H.layout.gutter))/H.layout._numberOfColumns-J;K=Math.round(A/(H.layout._getRowHeight()+H.layout.gutter))}else{if(H.layout.direction==="horizontal"){D=B-B%H.layout._numberOfRows;A=(D*(H.layout._columnWidth+H.layout.gutter))/H.layout._numberOfRows-E;K=Math.round(A/(H.layout._columnWidth+H.layout.gutter))}}if(L==="up"){if(H.layout.direction==="vertical"){return -I}else{if(H.layout.direction==="horizontal"){return -1}}}else{if(L==="right"){if(H.layout.direction==="vertical"){return 1}else{if(H.layout.direction==="horizontal"){return y}}}else{if(L==="down"){if(H.layout.direction==="vertical"){return I}else{if(H.layout.direction==="horizontal"){return 1}}}else{if(L==="left"){if(H.layout.direction==="vertical"){return -1}else{if(H.layout.direction==="horizontal"){return -y}}}else{if(L==="home"){return -B}else{if(L==="end"){return H.model.length-1-B}else{if(L==="pageup"){if(H.layout.direction==="vertical"){N=-(K)*H.layout._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B-H.layout._numberOfColumns*C<0){x--;break}}N=-H.layout._numberOfColumns*x}}else{if(H.layout.direction==="horizontal"){N=-(K)*H.layout._numberOfRows;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B-H.layout._numberOfRows*C<0){x--;break}}N=-H.layout._numberOfRows*x}}}return N}else{if(L==="pagedown"){if(H.layout.direction==="vertical"){N=(y-K-1)*H.layout._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B+H.layout._numberOfColumns*C>=H.model.length){x--;break}}N=H.layout._numberOfColumns*x;if(N===0){if((H.model.length-1)%H.layout._numberOfColumns<B%H.layout._numberOfColumns){N=H.layout._numberOfColumns}}}}else{if(H.layout.direction==="horizontal"){N=(I-K-1)*y;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B+H.layout._numberOfRows*C>=H.model.length){x--;break}}N=H.layout._numberOfRows*x}}}return N}}}}}}}}}return 0},_computeCellIDFromActiveCell:function(F,x,B){var A=this;var D=-1;var z=this.modelProvider.getNodeModelRowID(this.lastSelectedNode,true);var y=!A.activeNode?A.lastSelectedNode:A.activeNode;if(y){var E=A._computeIncrementToMove(F);var C=A._getNewActiveNodeInfos(y,E);if(C.node){D=C.index}}return D},_setActiveNode:function(y,x){if(this.activeNode!==y){this.activeNode=y;var z=-1;if(y){z=this.modelProvider.getNodeModelRowID(y,true);if(z<this.model.length){this.setActiveCell(z)}else{return}}if(x===true){if(this.selectionBehavior.enableFeedbackForActiveCell){this._modelEvents.publish({event:"active",context:y,})}}}},setActiveCell:function(x){if(x!==-1){this._parent(x);var y=this._getNodeModelAt(x);this._setActiveNode(y,true)}},_updatePoolSelectedViews:function(x){this._processPoolCells(function(D){var z=D.cellView.component.collectionView;var B=D.cellView.component;if(B){var y=z.getCellInfosFromHtmlElement(B.elements.container);if(y){var A=y.cellModel;if(A!==undefined){var C=false;if(g.is(x,"array")){if(x.indexOf(A)!==-1){C=true}}else{if(A===x){C=true}}if(this.selectionBehavior.enableFeedbackForActiveCell){if(A===this.activeNode){B.contentView.activate()}else{B.contentView.deactivate()}}if(this.modelProvider.isNodeSelected(A)){B.contentView.highlight()}else{B.contentView.unhighlight()}}}}})},_updateAllPoolSelectedViews:function(){this._processPoolCells(function(B){var y=B.cellView.component.collectionView;var A=B.cellView.component;if(A){var x=y.getCellInfosFromHtmlElement(A.elements.container);if(x){var z=x.cellModel;if(z!==undefined){if(this.selectionBehavior.enableFeedbackForActiveCell){if(z===this.activeNode){A.contentView.activate()}else{A.contentView.deactivate()}}if(y.modelProvider.isNodeSelected(z)){A.contentView.highlight()}else{A.contentView.unhighlight()}}}}})},_observeDragAndDropEvents:function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},_processDragAndDropCallback:function(C){var z=this;var D=this._firstParentWithClass(C.target,"wux-layouts-collectionview-cell");var y={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var B=y[C.type];var x=D?z.getCellInfosFromHtmlElement(D):{manager:this,};function A(I,E){var H=false;var F=z[I+E];if(F){H=F.call(x.manager,C,x);if(j&&I!=="onDragOver"){console.info("[dnd]",I+E,">",H,C.target)}}else{if(j){console.warn("[dnd]","cannot find",I+E,"callback")}}var G=z[I+E+"Default"];if(G){if(F===undefined||(F&&H)){if(j){if(F&&H){console.info("\t>[dnd]","dev want to continue to the default behavior for ",I+E," callback")}else{console.info("\t>[dnd]","use the default behavior for ",I+E," callback")}}G.call(x.parent,C,x)}}}if(x.cellView){A(B,"Cell")}else{A(B,"Blank")}}});return c});define("DS/CollectionView/ResponsiveTilesCollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/CollectionView/ResponsiveCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTileView","DS/Controls/ResponsiveTextualTileView","DS/CollectionView/CollectionViewCell","DS/Core/PointerEvents"],function(h,a,n,g,m,q,o,e,p,i,r,d,f,t,s,l,b,j){var c=t.inherit({name:"ResponsiveTilesCollectionViewLayout",isNodeModelInRange:function(w,v,u){return this.collectionView.modelProvider.isNodeModelInRange(w,v,u)},_getRowHeight:function(){var u=70;if(this.collectionView._displayedOptionalCellProperties.indexOf("All")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){u+=20}return u}});var k=f.inherit({name:"ResponsiveTilesCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},displayedOptionalCellProperties:{defaultValue:["All"],type:"array"},allowLargeItems:{defaultValue:false,type:"boolean"}},_applyProperties:function(u){this._parent(u);if(this.isDirty("allowLargeItems")){this._applyAllowLargeItems(u.allowLargeItems)}},_applyAllowLargeItems:function(u){if(this.allowLargeItems){this.cellStyleOverload="wux-cell-responsivetile-large-allow";this.elements.container.addClassName("wux-layout-largetilecollectionView")}else{this.cellStyleOverload="wux-cell-responsivetile";this.elements.container.removeClassName("wux-layout-largetilecollectionView")}this.invalidateLayout()},_preBuild:function(){this._properties.layout.value=new c({columnMaxWidth:400,gutter:10,});this._parent()},_postBuildView:function(){this.cellClassForView=s;this._parent();var u=this;var v=this;u.registerReusableCellContent({id:"Tile",buildContent:function(){var w=new u.cellClassForView();w.layoutingCollection=v;v._onEndResize(function(){this._processPoolCells(function(z){var x=z.cellView.component.collectionView;var y=z.cellView.component.contentView;if(y){y._onTileResize()}})});return w}});u.onCellRequest(function(B){var z=u.reuseCellContent("Tile");B.cellView.collectionView=u;B.cellView.contentView=z;z.cellInfos=B;z.unPrehighlight();if(u.useDragAndDrop===true){B.cellView.elements.container.setAttribute("draggable","true")}else{B.cellView.elements.container.setAttribute("draggable","false")}B.cellView.elements.container.dsView=B.cellView;B.cellView.getContent().addClassName(u.cellStyleOverload);z.getContent().setStyles({width:"100%",height:"100%"});var C=B.cellModel;var x=[];var A=u.getBadges(C);if(A){if(A.topRight){x.push(A.topRight)}if(A.bottomRight){x.push(A.bottomRight)}}if(u.displayedOptionalCellProperties[0]==["All"]){z.setProperties({title:u.getLabel(C),customTooltip:u.getCustomTooltip(C),clickableTitle:u.getClickableTitle(C),multipleTitleLineNumber:u.getMultipleTitleLineNumber(C),subtitle:u.getSubLabel(C),description:u.getDescription(C),propertiesList:u.getPropertiesList(C),picture:u.getThumbnail(C),icon:u.getIcon(C),emptyStatusbarVisibleFlag:u.getEmptyStatusbarVisibleFlag(C),statusbarIconsTooltips:u.getStatusbarIconsTooltips(C),activeFlag:u.getActiveFlag(C),statusbarIcons:u.getStatusbarIcons(C),badges:x,contextualMenu:u.getContextualMenu(C),color:u.getColor(C)})}else{if(u.displayedOptionalCellProperties[0]==["None"]){z.setProperties({title:u.getLabel(C),customTooltip:u.getCustomTooltip(C),clickableTitle:u.getClickableTitle(C),multipleTitleLineNumber:u.getMultipleTitleLineNumber(C),subtitle:u.getSubLabel(C),picture:u.getThumbnail(C),icon:u.getIcon(C),emptyStatusbarVisibleFlag:false,statusbarIconsTooltips:u.getStatusbarIconsTooltips(C),color:u.getColor(C)})}else{var y=u._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1;var w={title:u.getLabel(C),customTooltip:u.getCustomTooltip(C),clickableTitle:u.getClickableTitle(C),multipleTitleLineNumber:u.getMultipleTitleLineNumber(C),subtitle:u.getSubLabel(C),picture:u.getThumbnail(C),icon:u.getIcon(C),emptyStatusbarVisibleFlag:y?u.getEmptyStatusbarVisibleFlag(C):false,statusbarIconsTooltips:u.getStatusbarIconsTooltips(C),color:u.getColor(C)};if(this._displayedOptionalCellProperties.indexOf("description")!==-1){w.description=u.getDescription(C)}if(this._displayedOptionalCellProperties.indexOf("propertiesList")!==-1){w.propertiesList=u.getPropertiesList(C)}if(this._displayedOptionalCellProperties.indexOf("activeFlag")!==-1){w.activeFlag=u.getActiveFlag(C)}if(this._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){w.statusbarIcons=u.getStatusbarIcons(C);w.badges=x}if(this._displayedOptionalCellProperties.indexOf("contextualMenu")!==-1){w.contextualMenu=u.getContextualMenu(C)}z.setProperties(w)}}B.cellView._setReusableContent(z);if(this.selectionBehavior.enableFeedbackForActiveCell){if(C===this.activeNode){z.activate()}else{z.deactivate()}}if(this.modelProvider.isNodeSelected(C)){z.highlight()}else{z.unhighlight()}if(u._onPostRequestCellCB){u._onPostRequestCellCB.call(u,B)}})},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode();this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:true}})},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode();this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:false}})},_enableInteractiveMultiSelMode:function(){if((this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-responsivetilecollectionView")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-responsivetilecollectionView")}}}});return k});define("DS/CollectionView/ResponsiveLargeTilesCollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout"],function(i,k,d,j,e,f,a,l,m,h,g,c,o,n){var b=n.inherit({name:"ResponsiveLargeTilesCollectionViewLayout",isNodeModelInRange:function(s,r,q){return this.collectionView.modelProvider.isNodeModelInRange(s,r,q)},_getRowHeight:function(){var q=70;if(this.collectionView._displayedOptionalCellProperties.indexOf("All")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){q+=20}return q}});var p=o.inherit({name:"ResponsiveLargeTilesCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"}},_preBuild:function(){this._parent();this._properties.layout.value=new b({columnMaxWidth:"100%",gutter:10,})},_postBuildView:function(){this._parent();this.cellStyleOverload="wux-cell-responsivelargetile";this.elements.container.addClassName("wux-layout-largetilecollectionView")}});return p});define("DS/CollectionView/ResponsiveLargeTextualTilesCollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTextualTileView"],function(j,m,d,k,e,g,a,n,o,i,h,c,q,p,f){var b=p.inherit({name:"ResponsiveLargeTextualTilesCollectionViewLayout",sideGutter:60,isNodeModelInRange:function(t,s,r){return this.collectionView.modelProvider.isNodeModelInRange(t,s,r)},_getRowHeight:function(){var r=130;if(this.collectionView._displayedOptionalCellProperties.indexOf("All")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){r+=16}return r},prepareLayout:function(){var s=this;var r=s.collectionView.getViewportDimensions(true);if(r.width<640){this.sideGutter=10}else{this.sideGutter=60}s._numberOfColumns=1;var t=s._getRowHeightInPixel(r);var v=(r.height-s.gutter)/(t+s.gutter);s._numberOfRows=Math.max(Math.floor(v),1);var u=function(){this._columnWidth=Math.floor(r.width-2*this.sideGutter);if(this.useDynamicRowHeight){this._rowHeight=Math.floor((r.height-(this._numberOfRows+1)*this.gutter)/this._numberOfRows)}else{this._rowHeight=Math.floor(t)}var w=false;if(this._rowHeight>this.rowMaxHeight){this._numberOfRows++;w=true}if(w){u.call(this)}};u.call(this)},_getPositionForCellAt:function(r){var t;var s=this.getCellCoordinatesAt(r);t={left:this.sideGutter,top:s.rowID*(this._getRowHeight()+this.gutter)+this.gutter};return t},_getColumnWidthInPixel:function(s){var t;var r;switch(typeof this.columnMaxWidth){case"string":var t=parseFloat(this.columnMaxWidth);r=Math.round((s.width-this.sideGutter)/100*t);break;case"number":r=this.columnMaxWidth;break;case"object":r=responsiveMap(this,s.width,this.columnMaxWidth);break;default:}return r},_getColumnPosition:function(r){return r*(this._getColumnWidth()+this.sideGutter)+this.sideGutter},getContentDimensions:function(){var w=this.collectionView.getViewportDimensions();var s=this.collectionView.model.length-1;var u=this.getPositionForCellAt(s);var y=this.getDimensionsForCellAt(s);var z={height:u.top+this.gutter+y.height+this.gutter,width:u.left+this.sideGutter+y.width+this.sideGutter};var v=j.Utils.Client.getScrollbarWidth();if(this.direction==="vertical"){var r=z.height>w.height?(w.width-v):w.width;var t={width:r,height:z.height};return t}else{var x=z.width>w.width?(w.height-v):w.height;var t={width:z.width,height:x};return t}},_computeMinCellID:function(){var r=0;var s=this.collectionView.getViewportDimensions();var t=this.collectionView.getScrollerPosition();if(this.direction==="vertical"){r=Math.max((Math.floor(t.y/(this._getRowHeight()+this.gutter))),0)*Math.floor(s.width/(this._getColumnWidth()+this.sideGutter))}else{r=Math.max((Math.floor(t.x/(this._getColumnWidth()+this.sideGutter))),0)*Math.floor(s.height/(this._getRowHeight()+this.gutter))}r=Math.min(r,this.collectionView.model.length-1);return r}});var l=q.inherit({name:"ResponsiveLargeTextualTilesCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"}},_preBuild:function(){this._parent();this._properties.layout.value=new b({columnMaxWidth:"100%",gutter:10})},_postBuildView:function(){this._parent();this.cellClassForView=f;this.cellStyleOverload="wux-cell-responsivelargetile";this.elements.container.addClassName("wux-layout-largetilecollectionView")}});return l});define("DS/CollectionView/ResponsiveThumbnailsCollectionView",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/CollectionView/ResponsiveCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveThumbnailView"],function(k,n,e,m,f,h,a,o,p,j,i,d,g,q,l){var c=q.inherit({name:"ResponsiveThumbnailsCollectionViewLayout",isNodeModelInRange:function(t,s,r){return this.collectionView.modelProvider.isNodeModelInRange(t,s,r)},_getRowHeight:function(){if(this.direction==="vertical"){var r=this._getColumnWidth()*3/4+70;if(this.collectionView._displayedOptionalCellProperties.indexOf("All")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("description")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("propertiesList")!==-1){r+=115}if(this.collectionView._displayedOptionalCellProperties.indexOf("All")!==-1||this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){r+=28}return r}else{return this.rowMaxHeight}}});var b=g.inherit({name:"ResponsiveThumbnailsCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},displayedOptionalCellProperties:{defaultValue:["All"],type:"array"}},_preBuild:function(){this._properties.layout.value=new c({columnMaxWidth:{"0":1920/6,"420":1920/8},gutter:10,});this._parent()},_postBuildView:function(){this._parent();this.cellStyleOverload="wux-cell-responsivethumbnail";var s=this;var r=this;s.registerReusableCellContent({id:"Thumbnail",buildContent:function(){var t=new (r._getResponsiveThumbnailViewClass())();t.layoutingCollection=r;r._onEndResize(function(){this._processPoolCells(function(w){var u=w.cellView.component.collectionView;var v=w.cellView.component.contentView;if(v){v._onViewResize()}})});return t}});s.onCellRequest(function(B){var t=s.reuseCellContent("Thumbnail");B.cellView.collectionView=s;B.cellView.contentView=t;t.cellInfos=B;t.unPrehighlight();if(s.useDragAndDrop===true){B.cellView.elements.container.setAttribute("draggable","true")}else{B.cellView.elements.container.setAttribute("draggable","false")}B.cellView.elements.container.dsView=B.cellView;B.cellView.getContent().addClassName(s.cellStyleOverload);t.getContent().setStyles({width:"100%",height:"100%"});var z=s._viewportDimensions;var v=s.layout._numberOfColumns;var C=(z.width-(v+1)*s.layout.gutter)/v;var w=B.cellModel;var x=[];var A=s.getBadges(w);if(A){if(A.topRight){x.push(A.topRight)}if(A.bottomRight){x.push(A.bottomRight)}}if(s.displayedOptionalCellProperties[0]==["All"]){t.setProperties({title:s.getLabel(w),customTooltip:s.getCustomTooltip(w),clickableTitle:s.getClickableTitle(w),multipleTitleLineNumber:s.getMultipleTitleLineNumber(w),subtitle:s.getSubLabel(w),description:s.getDescription(w),propertiesList:s.getPropertiesList(w),picture:s.getThumbnail(w),icon:s.getIcon(w),emptyStatusbarVisibleFlag:s.getEmptyStatusbarVisibleFlag(w),statusbarIconsTooltips:s.getStatusbarIconsTooltips(w),activeFlag:s.getActiveFlag(w),statusbarIcons:s.getStatusbarIcons(w),badges:x,contextualMenu:s.getContextualMenu(w),color:s.getColor(w)})}else{if(s.displayedOptionalCellProperties[0]==["None"]){t.setProperties({title:s.getLabel(w),customTooltip:s.getCustomTooltip(w),clickableTitle:s.getClickableTitle(w),multipleTitleLineNumber:s.getMultipleTitleLineNumber(w),subtitle:s.getSubLabel(w),picture:s.getThumbnail(w),icon:s.getIcon(w),emptyStatusbarVisibleFlag:false,statusbarIconsTooltips:s.getStatusbarIconsTooltips(w),color:s.getColor(w)})}else{var u=s._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1;var y={title:s.getLabel(w),customTooltip:s.getCustomTooltip(w),clickableTitle:s.getClickableTitle(w),multipleTitleLineNumber:s.getMultipleTitleLineNumber(w),subtitle:s.getSubLabel(w),picture:s.getThumbnail(w),icon:s.getIcon(w),emptyStatusbarVisibleFlag:u?s.getEmptyStatusbarVisibleFlag(w):false,statusbarIconsTooltips:s.getStatusbarIconsTooltips(w),color:s.getColor(w)};if(s._displayedOptionalCellProperties.indexOf("description")!==-1){y.description=s.getDescription(w)}if(s._displayedOptionalCellProperties.indexOf("propertiesList")!==-1){y.propertiesList=s.getPropertiesList(w)}if(s._displayedOptionalCellProperties.indexOf("activeFlag")!==-1){y.activeFlag=s.getActiveFlag(w)}if(s._displayedOptionalCellProperties.indexOf("statusbarIcons")!==-1){y.statusbarIcons=s.getStatusbarIcons(w);y.badges=x}if(s._displayedOptionalCellProperties.indexOf("contextualMenu")!==-1){y.contextualMenu=s.getContextualMenu(w)}t.setProperties(y)}}B.cellView._setReusableContent(t);if(this.selectionBehavior.enableFeedbackForActiveCell){if(w===this.activeNode){t.activate()}else{t.deactivate()}}if(this.modelProvider.isNodeSelected(w)){t.highlight()}else{t.unhighlight()}if(s._onPostRequestCellCB){s._onPostRequestCellCB.call(s,B)}})},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode();this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:true}})},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode();this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:false}})},_enableInteractiveMultiSelMode:function(){if((this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-responsivethumbnailcollectionView")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-responsivethumbnailcollectionView")}}},_getResponsiveThumbnailViewClass:function(){return l}});return b});define("DS/CollectionView/CarouselView",["UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/TreeModel/TreeDocument","DS/Windows/DockingElement","DS/Utilities/Css","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/Controls/ResponsiveThumbnailView","i18n!DS/CollectionView/assets/nls/carousel.json"],function(h,e,v,m,l,x,i,d,a,o,j,w,k,s,t,g){var b=t.inherit({prehighlight:function(){var y=this;if(!y.isPreHighlighted){y.elements.container.addClassName("wux-ui-state-prehighlighted");y.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted");y.isPreHighlighted=true}},unPrehighlight:function(){var y=this;if(y.isPreHighlighted){y.elements.container.removeClassName("wux-ui-state-prehighlighted");y.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted");y.isPreHighlighted=false}},highlight:function(){this.activeFlag=true},unhighlight:function(){this.activeFlag=false},});var r=s.inherit({_getResponsiveThumbnailViewClass:function(){return b}});var n=function(y){if(y.target.classList.contains("wux-layouts-carousel-main-content")){var z=h.Event.wheelDelta(y);if(z<0){p(y.currentTarget._mouseWheelArg)}if(z>0){q(y.currentTarget._mouseWheelArg)}}else{if(w.firstParentWithClass(y.target,("wux-layouts-carousel-bottom-content"))){y.stopPropagation()}}};var q=function(B){if(B.treeDocument){var y=B.treeDocument.getXSO();var C=y.get();if(C.length===0){B.treeDocument.getRoots()[0].select()}if(C.length>0){var z=C[C.length-1];var A=z.getPreviousVisibleNode();if(A){A.select(true)}}}};var p=function(B){if(B.treeDocument){var y=B.treeDocument.getXSO();var C=y.get();if(C.length===0){B.treeDocument.getRoots()[0].select()}if(C.length>0){var z=C[C.length-1];var A=z.getNextVisibleNode();if(A){A.select(true)}}}};var c=true;var f=new i();var u=v.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(y){y.nodeView.setContent(y.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(y){y.nodeView.setContent(y.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(y){f.generateView(y.nodeModel.options.grid,{typePath:"object",readOnly:true,onViewCreated:function(z){y.nodeView.setContent(z)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(y){return y.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(y){y.nodeView.setStyles({backgroundImage:"url("+y.view.bigPicturePath(y)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:true,type:"boolean",category:"behavior"}},buildView:function(){var y=this;this.elements.container=new h.Element("div",{"class":"wux-layouts-carousel",tabindex:0});this.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay");this.elements.header=new h.Element("div",{"class":"wux-layouts-carousel-header"}).inject(this.elements.container);this.elements.headerMainContainer=new h.Element("div",{"class":"wux-layouts-carousel-header-main-container"}).inject(this.elements.header);this.elements.headerTitleBar=new h.Element("ul",{"class":"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer);this.elements.headerTitle=new h.Element("span",{"class":"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar);this.elements.headerSubtitle=new h.Element("span",{"class":"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar);this.elements.headerToolbar=new h.Element("ul",{"class":"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer);this.elements.containerRel=new h.Element("div",{"class":"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent());this.elements.collectionView=new r({displayedOptionalCellProperties:["contextualMenu"],showScrollbarsOnHover:true,});this.elements.collectionView.selectionManagedByView=true;h.extend(this.elements.collectionView.selectionBehavior,{canInteractiveMultiselectWithCheckboxClick:false,canMultiSelect:false,enableShiftSelection:false});this.elements.collectionView.layout.direction="horizontal";this.elements.collectionView.layout.columnMaxWidth=175;this.elements.collectionView.layout.rowMaxHeight=210;this.elements.collectionView.layout.useDynamicRowHeight=false;this.elements.collectionView.layout.useDynamicColumnWidth=false;this.elements.collectionView.getContent().setAttribute("theme-style","dark");this.elements.collectionView.getContent().setAttribute("carouselview-status-bar","false");this.elements.collectionView.getContent().setStyles({top:6,height:"auto"});this.elements.rightViewContent=new h.Element("div",{"class":"wux-layouts-carousel-right-content"});this.elements.dockingZoneContentForBottom=new h.Element("div",{"class":"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.collectionView,styles:{height:"100%",position:"relative"}});this.elements.mainView=new h.Element("div",{"class":"wux-layouts-carousel-main"});this.elements.bottomDockingElement=new l({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:214+28,resizableFlag:false,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.rollVisibleFlag=true;this.sidePanelVisibleFlag=true;this.elements.rightDockingElement=new l({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:false,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView;this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement;this.elements.mainViewContent=new h.Element("div",{"class":"wux-layouts-carousel-main-content"}).inject(this.elements.mainView);this.elements.mainViewLeftArrow=new o({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new k({shortHelp:g.previous,mouseRelativePosition:false}),clickMode:1});this.elements.mainViewRightArrow=new o({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new k({shortHelp:g.next,mouseRelativePosition:false}),clickMode:1});if(c){this.elements.bottomViewLeftArrow=new h.Element("div",{"class":"wux-layouts-carousel-bottom-prev wux-layouts-carousel-bottom-prev-collectiondimensions  wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom);this.elements.bottomViewRightArrow=new h.Element("div",{"class":"wux-layouts-carousel-bottom-next wux-layouts-carousel-bottom-next-collectiondimensions wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom)}this._observeEvents();this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container);this.elements.collectionView._getScroller().elements.container.addEventListener("wheel",function(z){z.stopPropagation()},true)},_postBuildView:function(){var y=this;this._parent();this._isReady=false;w.onNodeRendered(this.getContent(),function(){if(y._isReady===true){return}y._isReady=true;y._updateCarouselLayout()});w.addEndResizeListener(this.elements.container,function(){y._updateCarouselLayout()},10)},_updateCarouselLayout:function(){var A=this;var z=A.elements.container.getDimensions();var B=A.elements.container.getAttribute("carousel-display-mode");if(z.width<CAROUSEL_FULL_WIDTH&&B!=="middleWidthDisplay"){A.elements.container.setAttribute("carousel-display-mode","middleWidthDisplay");A.elements.bottomDockingElement.dockingZoneContent=null;if(A.sidePanelVisibleFlag===true){A.elements.bottomDockingElement.dockingZoneContent=A.elements.rightViewContent;A.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{if(A.rollVisibleFlag===true){A.elements.bottomDockingElement.dockingZoneContent=A.elements.dockingZoneContentForBottom;A.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{A.elements.bottomDockingElement.visibleDockingZoneFlag=false}}A.elements.rightDockingElement.visibleDockingZoneFlag=false}else{if(z.width>=CAROUSEL_FULL_WIDTH&&B!=="maxWidthDisplay"){A.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay");if(A.sidePanelVisibleFlag===true){A.elements.rightDockingElement.visibleDockingZoneFlag=true}else{A.elements.rightDockingElement.visibleDockingZoneFlag=false}A.elements.rightDockingElement.dockingZoneContent=null;A.elements.bottomDockingElement.dockingZoneContent=A.elements.dockingZoneContentForBottom;A.elements.rightDockingElement.dockingZoneContent=A.elements.rightViewContent;if(A.rollVisibleFlag===true){A.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{A.elements.bottomDockingElement.visibleDockingZoneFlag=false}}}if(B==="middleWidthDisplay"){var y=0;if(A.rollVisibleFlag===true&&A.sidePanelVisibleFlag===false){y=214+28}else{if(A.sidePanelVisibleFlag===true){y=z.height-58-z.width*3/4;if(y<214+28){y=214+28}}}A.elements.bottomDockingElement.dockingZoneSize=y}A._updateToolbarLayout()},_observeEvents:function(){var D=this;var E;var F;var z=function(){if(E){clearInterval(E)}if(F){clearInterval(F)}D.getGridView()._disableAutoScroll()};var G=function(){z();q(D);F=setTimeout(function(){E=setInterval(q,D,D.intervalTimer)},500)};var C=function(){z();p(D);F=setTimeout(function(){E=setInterval(p,D,D.intervalTimer)},500)};this.elements.mainViewLeftArrow.addEventListener("buttonclick",G);this.elements.mainViewRightArrow.addEventListener("buttonclick",C);if(c){this.elements.bottomViewLeftArrow.addEvent(j.POINTERDOWN,function(H){H.preventDefault();H.stopPropagation();D.getGridView()._enableAutoScroll({x:-10,y:0},10)});this.elements.bottomViewRightArrow.addEvent(j.POINTERDOWN,function(H){H.preventDefault();H.stopPropagation();D.getGridView()._enableAutoScroll({x:10,y:0},10)})}var A=false;var y=function(J,H,I){A=true;D.getGridView().onPostUpdateViewOnce(function(){A=false;if(I){I.call(D)}});J.call(D,D)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){y(q,D)},right:function(){y(p,D)}}});var B=function(H){H.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",B,false);this.elements.container.addEventListener("contextmenu",B,false);this.elements.mainViewLeftArrow.addEvent("mouseleave",z);this.elements.mainViewRightArrow.addEvent("mouseleave",z);if(c){this.elements.bottomViewLeftArrow.addEvent("mouseleave",z);this.elements.bottomViewRightArrow.addEvent("mouseleave",z);this.elements.bottomViewLeftArrow.addEvent(j.POINTERUP,z);this.elements.bottomViewRightArrow.addEvent(j.POINTERUP,z)}document.body.addEventListener("mouseup",z);document.body.addEventListener("mouseleave",z)},_manageKeyboardNavigation:function(y){var z=this;h.Element.addEvent.call(this.getContent(),"keydown",d.throttle(function(D){var C={input:true,textarea:true};if(C[D.target.tagName.toLowerCase()]===undefined){var A=(w.hasClass(D.target,"wux-layouts-carousel"))?D.target:w.firstParentWithClass(D.target,"wux-layouts-carousel");var E=(A===z.getContent());if(E){var B=h.Event.whichKey(D);if(y.keymap[B]!==undefined){y.keymap[B].call(z)}}}},y.throttleTime))},_applyHeight:function(y){if(this.height==="auto"){this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0})}else{if(typeof this.height==="number"){this.elements.container.setStyles({position:"",height:this.height})}}this.elements.container.style.overflow="auto";this._parent(y)},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:true});console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(C){this.elements.collectionView.loadGridViewModel(this.treeDocument);if(this.treeDocument){var D=this;var z=this.treeDocument.getXSO();var B=d.debounce(function(E){D.onRightViewRequest(E)},100);var A=function(){var F=z.get();var E=F[F.length-1];D.onMainViewRequest({nodeModel:E,nodeView:D.elements.mainViewContent,view:D});B.call(D,{nodeModel:E,nodeView:D.elements.rightViewContent,view:D});D.onTitleRequest({nodeModel:E,nodeView:D.elements.headerTitle,view:D});D.onSubtitleRequest({nodeModel:E,nodeView:D.elements.headerSubtitle,view:D});D.elements.collectionView._setActiveNode(E,true)};if(z.get().length>0){A.call(z)}z.onAdd(A);var y=this.treeDocument.getRoots();if(z.get().length===0&&y.length){this.treeDocument.getRoots()[0].select()}}this._parent(C)},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}},_applyToolBar:function(){var y=this;y.elements.headerToolbar.empty();this.toolbar.forEach(function(A){A.icon.fontIconSize="2x";A.icon.fontIconFamily=WUXManagedFontIcons.Font3DS;var B=new o({type:A.type,tooltipInfos:A.tooltipInfos,icon:A.icon,value:"1",displayStyle:"lite-borders",touchMode:true,clickMode:1}).inject(y.elements.headerToolbar);B.addEventListener("click",function z(C){C.stopPropagation();if(A.callback){A.callback()}})});if(this.getRollVisibleFlag()){this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar);this.elements.mainViewRightArrow.inject(this.elements.headerToolbar)}},_applyScrollOnMainViewMouseWheel:function(y){if(this.scrollOnMainViewMouseWheel!==y){var z=this;if(this.scrollOnMainViewMouseWheel){this._mouseWheelsubscriptionDoneOneTimeAtLeast=true;h.Element.addEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=z}else{if(this._mouseWheelsubscriptionDoneOneTimeAtLeast===true){this._mouseWheelsubscriptionDoneOneTimeAtLeast=false;h.Element.removeEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=z}}}},_applyProperties:function(y){this._parent(y);this._applyHeight();this._applyTreeDocument();this._applyToolBar();this._applyScrollOnMainViewMouseWheel(y.scrollOnMainViewMouseWheel)},_updateToolbarLayout:function(){var H=this.elements.container.getDimensions().width;var K=this.elements.headerTitleBar.getDimensions().width;var C=H-K-30;if(C<CAROUSEL_TOOLBAR_MIN_WIDTH){C=CAROUSEL_TOOLBAR_MIN_WIDTH}var M=this.rollVisibleFlag===false?1:3;var A=this.toolbar?(this.toolbar.length+M)*CAROUSEL_TOOLBAR_ICON_WIDTH+30:0;var G=this.rollVisibleFlag===false?2:4;var J=[];if(this.rollVisibleFlag===true){J.push(this.elements.mainViewLeftArrow.getContent());J.push(this.elements.mainViewRightArrow.getContent())}J.push(this._closeButton.getContent());var y=0;var F=[];if(A>C){var z=Math.floor(C/CAROUSEL_TOOLBAR_ICON_WIDTH);y=z-G;F=this.buildToolbarAdditionalButtons(y);var B=[];for(var E=0;E<this.toolbar.length;E++){if(F.indexOf(this.toolbar[E])===-1){B.push(this.toolbar[E])}}this.buttonsForContextMenu=B;if(B.length>=1){if(!this._dotMenuButtonIcon){this._dotMenuButtonIcon=new o({icon:{iconName:"menu-dot",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new k({shortHelp:g.dotMenu,mouseRelativePosition:false}),clickMode:1});this._dotMenuButtonIcon.getContent().addEventListener("click",function I(O){var N=document.createEvent("HTMLEvents");N.initEvent("contextmenu",true,false);N.pageX=O.pageX;N.pageY=O.pageY;this.dispatchEvent(N);O.stopPropagation()});var L=this;ContextualMenu.addEventListener(this._dotMenuButtonIcon.getContent(),{callback:function(N){return L.getContextMenuForButtons(L.buttonsForContextMenu)}})}J.push(this._dotMenuButtonIcon.getContent())}}else{F=this.toolbar}this.elements.headerToolbar.empty();var L=this;F.forEach(function(O){O.icon.fontIconSize="2x";O.icon.fontIconFamily=WUXManagedFontIcons.Font3DS;var P=new o({type:O.type,tooltipInfos:O.tooltipInfos,icon:O.icon,value:"1",displayStyle:"lite-borders",touchMode:true,clickMode:1}).inject(L.elements.headerToolbar);P.addEventListener("click",function N(Q){Q.stopPropagation();if(O.callback){O.callback()}})});for(var D=0;D<J.length;D++){this.elements.headerToolbar.appendChild(J[D])}},buildToolbarAdditionalButtons:function(A){var z=[];if(!this.toolbar||this.toolbar.length<A){return z}for(var y=0;y<A;y++){z.push(this.toolbar[y])}return z},getContextMenuForButtons:function(A){var B=[];for(var z=0;z<A.length;z++){var y=A[z];B.push({type:"PushItem",title:y.text,fonticon:{family:y.icon.fontIconFamily,content:"wux-ui-3ds wux-ui-3ds-"+y.icon.iconName,},action:{callback:function(C){var D=C.context;D.callback.call(D)},context:y}})}return B},getGridView:function(){return this.elements.collectionView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement},getRollVisibleFlag:function(){return this.rollVisibleFlag},setRollVisibleFlag:function(z){var y=this;var A=y.elements.container.getAttribute("carousel-display-mode");if(A==="middleWidthDisplay"){if(z){y.elements.bottomDockingElement.dockingZoneContent=y.elements.dockingZoneContentForBottom;y.rollVisibleFlag=true;y.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{if(y.sidePanelVisibleFlag){y.elements.bottomDockingElement.dockingZoneContent=y.elements.rightViewContent;y.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{y.elements.bottomDockingElement.visibleDockingZoneFlag=false}y.rollVisibleFlag=false}}else{if(z){y.rollVisibleFlag=true;y.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{y.rollVisibleFlag=false;y.elements.bottomDockingElement.visibleDockingZoneFlag=false}}y._updateCarouselLayout()},getSidePanelVisibleFlag:function(){return this.sidePanelVisibleFlag},setSidePanelVisibleFlag:function(z){var y=this;var A=y.elements.container.getAttribute("carousel-display-mode");if(A==="middleWidthDisplay"){if(z){y.sidePanelVisibleFlag=true;y.elements.bottomDockingElement.dockingZoneContent=y.elements.rightViewContent;y.elements.bottomDockingElement.visibleDockingZoneFlag=true}else{y.sidePanelVisibleFlag=false;if(y.rollVisibleFlag){y.sidePanelVisibleFlag=false;y.elements.bottomDockingElement.visibleDockingZoneFlag=true;y.elements.bottomDockingElement.dockingZoneContent=y.elements.dockingZoneContentForBottom}else{y.elements.bottomDockingElement.visibleDockingZoneFlag=false}}}else{if(z){y.sidePanelVisibleFlag=true;y.elements.rightDockingElement.visibleDockingZoneFlag=true}else{y.sidePanelVisibleFlag=false;y.elements.rightDockingElement.visibleDockingZoneFlag=false}}y._updateCarouselLayout()}});return u});define("DS/CollectionView/LightBoxView",["UWA/Core","DS/Core/Core","DS/CollectionView/CarouselView","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/CollectionView/assets/nls/carousel.json"],function(g,e,b,c,a,f){var d=b.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"}},_preBuildView:function(){this._parent()},_postBuildView:function(){var h=this;window._lb=this;this._parent();this.elements.container.addClassName("wux-layouts-lightbox");this._applyVisibleFlag();var h=this},_applyVisibleFlag:function(h){if(this.visibleFlag){if(!this.elements.wrapper){this.elements.wrapper=new g.Element("div",{"class":"wux-layouts-lightbox-overlay",html:this.getContent()});this.elements.wrapper.inject(this.target)}}else{if(this.elements.wrapper){this.elements.wrapper.remove();this.elements.wrapper=undefined;this.fire("close")}}this._parent(h);var i=this},_applyToolBar:function(){this._parent();var j=this;var i=new c({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:f.close,mouseRelativePosition:false}),clickMode:1}).inject(this.elements.headerToolbar);i.addEventListener("click",function h(k){k.stopPropagation();j.visibleFlag=false});this._closeButton=i}});return d});