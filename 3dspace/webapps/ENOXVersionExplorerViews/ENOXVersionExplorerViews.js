define("DS/ENOXVersionExplorerViews/NodeDropdownMenu",["DS/UIKIT/DropdownMenu","DS/Tree/TreeNodeModel","css!DS/ENOXVersionExplorerViews/styles/NodeDropdownMenu"],function(a,c){var b=null;return{displayNodeDropdownMenu:function(u){var n=this,k=u.treeNode,j=u.target,p=u.menuList,o=u.position,d=u.dropdownContainer;if(!((k instanceof c)||Array.isArray(k))){throw Error("NodeDropdownMenu.displayNodeDropdownMenu:incorrect data to display dropdown menu")}if(!b||d.getElement(".version-node-dropdown-menu")==null){b=new a({target:j,renderTo:d,removeOnHide:true,bound:false,closeOnClick:true,scrollMode:false,offset:{x:5,y:5},items:[],events:{onClick:function(w,i){var x=i.event,v=b.data;v.menuctx=u;if(typeof x.pubfn==="function"){x.pubfn(b.data)}else{if(typeof x==="string"){n[(typeof n.publishEvent==="function"?"publishEvent":"publish")]({event:x,data:v,})}}},onClickOutside:function(v){var w=v.target,i=false;if(this.nodeView){while(w=w.parentNode,w){if(w===this.nodeView){i=true;break}}}this[(i===true?"show":"hide")]()},}});b.elements.container.addClassName("version-node-dropdown-menu")}else{b.removeItem(b.items.map(function(i){return i.id}));b.options.target=j}b.nodeView=j;b.data=k;for(var l=0;l<p.length;l++){var t=p[l];if(t.id==="divider"){b.addItem({className:"version-node-dropdown-menu-divider"})}else{b.addItem({text:t.text,fonticon:t.fonticon,icon:t.icon,event:t.event,id:t.id})}}var h=b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").getAttribute("tabindex");b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").removeAttribute("tabindex");b.show();if(o){var m=b.elements.container.clientWidth;var e=b.elements.container.clientHeight;var g=d.getBoundingClientRect();var f=g.width,s=g.height;var r=o.x-g.left,q=o.y-g.top;if(r+m>f){r=f-m-5}if(q+e>s){q=s-e-5}b.options.altPosition={x:r,y:q};b.updatePosition()}b.elements.container.getElement(".dropdown-menu-wrap.dropdown-menu-icons").setAttribute("tabindex",h)}}});define("DS/ENOXVersionExplorerViews/VersionExplorerModal",["UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","i18n!DS/UIKIT/assets/nls/UIKIT",],function(d,c,b,a){return{_dlg:undefined,_dlgDiv:undefined,footerStyle:{none:1,okCancel:2},_closeDlg:function(){if(this._dlg){var g=this._dlgDiv.getChildren();var e=g.length;for(var f=0;f<e;f++){this._dlgDiv.remove(g[f])}this._dlg.destroy();this._dlg=undefined;this._dlgDiv=undefined;(this.options&&typeof this.options.onCloseDlg==="function")&&this.options.onCloseDlg()}},displayDialog:function(e){var g=this;if(g._dlgDiv&&g._dlg){g._closeDlg()}g._dlgDiv=d.createElement("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}});var f=d.merge(e,{className:"version-explorer-modal",body:g._dlgDiv,closable:true,animate:true,resizable:true,autocenter:true,visible:true,limitParent:true,footer:(e.footerStyle===g.footerStyle.okCancel?('<button type="button" class="btn btn-primary _BTN_OK">'+a.ok+'</button> <button type="button" class="btn btn-default _BTN_CANCEL">'+a.ko+"</button>"):undefined),overlay:(e.modal===true),events:{onClose:g._closeDlg.bind(g),},onOK:function(){},onCancel:function(){},title:b.VersionExplorer});g._dlg=new c(f);g._dlg.elements.body.setStyle("padding","0");e.parentContainer=e.parentContainer||d.extendElement(document.body);g._dlg.inject(e.parentContainer);g._dlgDiv.setContent(e.globalDiv);if(g._dlg.elements.footer){g._dlg.elements.footer.getElement("button._BTN_OK").addEvent("click",function(h){e.onOK(h);g._closeDlg()});g._dlg.elements.footer.getElement("button._BTN_CANCEL").addEvent("click",function(h){g._closeDlg();e.onCancel(h)})}(e.position&&e.position.clientX&&e.position.clientY)&&(g._dlg.elements.container.setStyles({top:e.position.clientY.toString()+"px",left:e.position.clientX.toString()+"px"}),g._dlg.initialClient=g._dlg._getCurrentClientPosition(e.position));this.options=e},setTitle:function(e){if(this._dlg!==undefined){this._dlg.setTitle(b.VersionExplorer+(typeof e==="string"&&e.length?" - "+e:""))}},changeFooterStyle:function(){if(this._dlg!==undefined){that._dlg.elements.footer}}}});define("DS/ENOXVersionExplorerViews/NewRevisionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewRevisionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(c,a,b){return{displayDialog:function(d){if(!d.derivedFrom||!d.derivedFrom.name||!d.derivedFrom.id){throw Error("derived From Name or ID cannot be null")}if(typeof d.defaultName!=="string"||!d.defaultName.length){throw Error("Default Name cannot be null")}var g=[{type:"text",label:b.revTitle,required:false,value:d.defaultName||"",name:"newVersionName"},{type:"textarea",label:b.description,required:false,name:"newVersionDescription"},{type:"text",label:b.derivedFrom,required:false,disabled:true,value:d.derivedFrom.name,name:"newVersionBasedOn"}];var f=new c({fields:g,className:"newVersionDialog"});var e=new a({renderTo:d.parentContainer||document.body,className:"newVersionSuperModal"});e.dialog({title:(d.title||b.newRevision),body:f.elements.container,buttons:[{className:"primary",value:b.create,action:function(h){var j=f.getValue("newVersionName"),i=f.getValue("newVersionDescription");h.hide();d.onOK(j,i)},name:"buttonOK"},{className:"default",value:b.cancel,action:function(h){h.hide()},name:"buttonCancel"},]});f.getField("newVersionDescription").focus()}}});define("DS/ENOXVersionExplorerViews/VersionExplorerToolbar",["UWA/Core","DS/UIKIT/Iconbar","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/WebappsUtils/WebappsUtils","UWA/Element","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerToolbar","css!DS/ENOXVersionExplorerViews/styles/VersionExplorerToolbar",],function(g,d,a,e,c,h,f,b,i){return d.extend({_versionExplorerController:undefined,init:function(k){var j=this;j._versionExplorerController=k.versionExplorerController;j.versionExplorerView=k.versionExplorerView;arr=[];for(var l in a.OrientationMode){arr.splice(a.OrientationMode[l],0,l)}this._circularArray=new e.CircularArray(arr);var m=this;var n=c.UserSettings.thumbnailGraphLayout;if(isNaN(n)){for(var l in h.THUMBNAIL_GRAPH_LAYOUT){if(h.THUMBNAIL_GRAPH_LAYOUT[l]===n){n=l;break}}}g.extend(k,{className:"versionexplorer-iconbar",items:[{fonticon:"select-on",text:i.multiSelect,id:"menuMultiSelect"},{fonticon:"",text:i.multiSelect,id:"multiSelectCounter"},{fonticon:"open-down",text:"",id:"menuMultiSelectDropdown"},{fonticon:"graph-egraph-down "+n,text:i[n],id:"graphViewDropDown",content:{type:"icondropdown",options:{items:[{selected:(n==="ROOT_ON_RIGHT"),fonticon:"graph-egraph-down ROOT_ON_RIGHT",description:i.ROOT_ON_RIGHT,id:"ROOT_ON_RIGHT"},{selected:n==="ROOT_ON_LEFT",fonticon:"graph-egraph-down ROOT_ON_LEFT",description:i.ROOT_ON_LEFT,id:"ROOT_ON_LEFT"},{selected:n==="ROOT_ON_BOTTOM",fonticon:"graph-egraph-down ROOT_ON_BOTTOM",description:i.ROOT_ON_BOTTOM,id:"ROOT_ON_BOTTOM"},{selected:n==="ROOT_ON_TOP",fonticon:"graph-egraph-down",description:i.ROOT_ON_TOP,id:"ROOT_ON_TOP"}],events:{onClick:function(p,o){document.getElementById("graphViewDropDown").getChildren()[0].className=o.elements.container.getChildren()[0].className;m.versionExplorerView.setThumbnailGraphLayout(o.elements.container.id);var q=m.menu.items.find(function(r){return r.id==="graphViewDropDown"});if(q){q.text=o.description;q.tooltip.setBody(q.text)}}}}}},{fonticon:"arrow-double-combo",text:i.zoomToFit,id:"menuZoomToFit"},{fonticon:"map-navigation",text:i.toggleOverview,id:"menuToggleOverview"},{className:"divider",id:"divider"},{fonticon:"reload",text:i.refresh,id:"menuRefresh"},{fonticon:"cog",text:i.settings,id:"menuSettings"},{fonticon:"graph-egraph",text:i.displayThumbnailView,id:"menuDisplayThumbnailView",content:{type:"icondropdown",options:{items:[{selected:true,fonticon:"graph-egraph selected",id:"DisplayThumbnailView",description:i.displayThumbnailView},{fonticon:"graph-egraph-list ",id:"DisplaySubwayListView",description:i.displaySubwayListView}],events:{onClick:function(p,o){o.elements.container.className="item ";this.elements.container.getChildren()[0].className="item selected";m.setView("menu"+o.id,true)}}}}},{fonticon:"graph-egraph-list",text:i.displaySubwayListView,id:"menuDisplaySubwayListView",content:{type:"icondropdown",options:{items:[{fonticon:"graph-egraph ",id:"ThumbnailView",description:i.displayThumbnailView},{selected:true,fonticon:"graph-egraph-list selected",id:"SubwayListView",description:i.displaySubwayListView}],events:{onClick:function(p,o){o.elements.container.className="item ";this.elements.container.getChildren()[1].className="item selected";m.setView("menuDisplay"+o.id,true)}}}}}],events:{onClick:j.handleThumbnailGraphToolbar}});this._parent(k);g.createElement("span",{}).inject(this.getItem("multiSelectCounter").elements.container);this.hideMultiSelect();this.removeLegendButton()},select:function(){var j=arguments,n,l,o,k,m;if(j[0]===undefined||j[0]===null){return}l=(j[1]===undefined)?true:j[1];m=(j[2]===undefined)?false:j[2];(m&&l)&&this.elements.container.querySelectorAll(".item-active").forEach(function(p){p.removeClassName&&p.removeClassName("item-active")});(m&&l)&&this.overflowMenu.getSelectedItems().forEach(function(p){this.overflowMenu.menus[0].toggleSelection(p);p.elements.container.removeClassName("selectable")},this);n=this.getItem(j[0]);if(!n||n.elements.container.hasClassName("divider")){return}n.elements.container[l?"addClassName":"removeClassName"]("item-active");o=n.elements.container.id;k=this.overflowMenu.items.filter(function(p){return p.elements.container.hasClassName(o)});if(k.length===1){this.overflowMenu.menus[0].toggleSelection(k[0]);k[0].elements.container.addClassName("selectable")}},getItemIndex:function(p){var m,j,k,o=false,n=-1;for(m=0,j=this.menu.items.length;m<j;m+=1){o=this.menu.items[m];if(p&&p.nodeType){k=p.hasClassName("item")?p:p.getParent();if(o.id===k.id){n=m;break}}else{if(m===p||o.id===p||o.name===p){n=m;break}}o=false}return n},addLegendButton:function(j){this.showItem("menuToggleLegend");this.select("menuToggleLegend",j)},removeLegendButton:function(){this.hideItem("menuToggleLegend")},setView:function(m,l){if(this.viewTYPE!==m){this.viewTYPE=m;switch(m){case"menuDisplayThumbnailView":this.showItem("menuDisplayThumbnailView");this.showItem("menuSettings");this.showItem("menuRefresh");this.showItem("divider");this.showItem("graphViewDropDown");this.showItem("menuZoomToFit");this.showItem("menuToggleOverview");this.hideItem("menuDisplaySubwayListView");(l===true)&&this.versionExplorerView._displayThumbnailGraph(true);break;case"menuDisplaySubwayListView":this.hideItem("menuDisplayThumbnailView");this.hideItem("graphViewDropDown");this.hideItem("menuZoomToFit");this.hideItem("menuToggleOverview");this.showItem("menuDisplaySubwayListView");this.showItem("menuSettings");this.showItem("menuRefresh");if(document.getElementById("menuMultiSelect").style.display=="none"){this.hideItem("divider")}else{this.showItem("divider")}(l===true)&&this.versionExplorerView._displaySubwayGraph();break}var j=["menuToggleOverview","menuZoomToFit","graphViewDropDown"];for(var k=0;k<j.length;k++){this[(m==="menuDisplayThumbnailView"?"showItem":"hideItem")](j[k])}}},handleThumbnailGraphToolbar:function(k,l){var j=this;switch(l.id){case"menuRefresh":j._versionExplorerController.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:true});break;case"menuToggleOverview":j.select(l.id,!j.getItem(l.id).elements.container.hasClassName("item-active"));c._saveUserSettings("displayThumbnailOverview",j.getItem(l.id).elements.container.hasClassName("item-active"));j.versionExplorerView.setThumbnailOverviewVisibility();break;case"menuZoomToFit":j.versionExplorerView.reframeThumbnailGraph();break;case"menuToggleLegend":j.select(l.id,!j.getItem(l.id).elements.container.hasClassName("item-active"));j.versionExplorerView.displayLegend(j.getItem(l.id).elements.container.hasClassName("item-active"));c._saveUserSettings("displayLegend",j.getItem(l.id).elements.container.hasClassName("item-active"));break;case"menuMultiSelect":c._USER_SET_MULTI_SELECT=!j.getItem(l.id).elements.container.hasClassName("item-active");this.versionExplorerView._manageSelect({data:!c._USER_SET_MULTI_SELECT});break;case"menuMultiSelectDropdown":this.versionExplorerView.onMultiSelectDropdownClick(k);break;case"menuSettings":this.versionExplorerView._customizeColumns();break}},hideItem:function(k){var j=this.getItem(k);j&&j.elements.container.hide()},showItem:function(k){var j=this.getItem(k);j&&j.elements.container.show()},activateItem:function(j){this.select(j,true)},deactivateItem:function(j){this.select(j,false)},hideMultiSelect:function(){this.hideItem("menuMultiSelect");this.hideItem("multiSelectCounter");this.hideItem("menuMultiSelectDropdown")},showMultiSelect:function(){this.showItem("menuMultiSelect");this.showItem("divider")},activateMultiSelect:function(){if(!this._multiSelectActive){this.activateItem("menuMultiSelect");this.showItem("multiSelectCounter");this.activateItem("multiSelectCounter");this.activateItem("menuMultiSelectDropdown");this._multiSelectActive=true}},deactivateMultiSelect:function(){if(this._multiSelectActive){this.deactivateItem("menuMultiSelect");this.hideItem("multiSelectCounter");this.hideItem("menuMultiSelectDropdown");this._multiSelectActive=false}},setMultiSelectCount:function(j){this._multiSelectActive&&this.getItem("multiSelectCounter").elements.container.getElement("span").setContent(j.toString())},showMultiSelectDropdown:function(){this._multiSelectActive&&this.showItem("menuMultiSelectDropdown")},hideMultiSelectDropdown:function(){this.hideItem("menuMultiSelectDropdown")},setSubwayViewRowHeight:function(k,j){k=k||c.UserSettings.subwayViewMode;this.hideItem(k);this.showItem(k==="SUBWAY_COMFORTABLE_VIEW"?"SUBWAY_COMPACT_VIEW":"SUBWAY_COMFORTABLE_VIEW");if(j!==true){this.versionExplorerView.setSubwayRowHeight(h.SUBWAY_VIEW_MODE[k])}c._saveUserSettings("subwayViewMode",k)}})});define("DS/ENOXVersionExplorerViews/NewVersionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewVersionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],function(d,b,c,a){return{displayDialog:function(o){if(!o.derivedFrom||!o.derivedFrom.name||!o.derivedFrom.id){throw Error("derived From Name or ID cannot be null")}if(typeof o.defaultName!=="string"||!o.defaultName.length){throw Error("Default Name cannot be null")}var h=o.dataModelType;var l=o.semanticTypes;var m=false;var f=[{type:"textarea",label:a.description,required:false,name:"newVersionDescription"}];if(Array.isArray(l)&&l.length){m=true;var k=l.length;f.push({label:a.semanticRelationship,disabled:true,className:"semanticTypeText",required:true,flag:"semanticType"});for(var j=0;j<k;j++){f.push({type:"radio",label:l[j].label,required:false,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType"})}}else{switch(h){case c.DATA_MODEL_TYPES.MODEL_P_PRIME:case c.DATA_MODEL_TYPES.MODEL_RDF:m=true;f.push({label:a.semanticRelationship,disabled:true,className:"semanticTypeText",required:true,flag:"semanticType"},{type:"radio",label:a.S,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"S",checked:true},{type:"radio",label:a.F,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"F"},{type:"radio",label:a.SO,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SO"},{type:"radio",label:a.SP,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SP"});break;default:break}}f.push({type:"text",label:a.derivedFrom,required:false,disabled:true,value:o.derivedFrom.name,name:"newVersionBasedOn"});var e=new d({fields:f,className:"newVersionDialog"});var n;var n=(n=e.elements.container.getElement('input[type="text"].semanticTypeText'),n?n.getParent("div").getElement("label span"):undefined);(!!n)&&UWA.createElement("span",{"class":"fonticon fonticon-info",events:{mousedown:function(i){}}}).inject(n,"before");var g=new b({renderTo:o.parentContainer||document.body,className:"newVersionSuperModal"});g.dialog({title:o.title||a.newBranch,body:e.elements.container,buttons:[{className:"primary",value:a.create,action:function(q){var s=o.defaultName,r=e.getValue("newVersionDescription"),i=undefined;if(m===true){var p=e.elements.container.getElements('.semanticTypeRadio input[type="radio"]:checked');i=(p&&p.length==1)&&p[0].getAttribute("value")}q.hide();o.onOK(s,r,i)},name:"buttonOK"},{className:"default",value:a.cancel,action:function(i){i.hide()},name:"buttonCancel"},]})}}});define("DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","DS/UIKIT/Input/Toggle","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","css!DS/LifecycleControls/assets/styles/LifecycleModals","css!DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg"],function(b,h,a,g,f,e,c){var d=b.singleton({init:function(){this._parent({})},showDialog:function(k){var m=this;var j=k.onOk;var n=k.onShow;var l=new a({closable:true,className:"Lifecycle_Modals",events:{onShow:function(){if(n!=null){n(m)}}},renderTo:k.parent});var i=this.buildDialogBody(k);l.dialog({body:i,title:k.title,buttons:[{className:"primary",value:f.OkButton,action:function(q){var r={};var p=q.elements.body.getElement("#compact-view-toggle");if(p){r.compactView=p.checked}var o=q.elements.body.getElement("#hilite-links-toggle");if(o){r.highlightParentConnectionsOnSelect=o.checked}if(m.checkboxes!==undefined){r.attributes=m.getSelectedAttributes()}q.hide();j(r)}},{value:f.CancelButton,action:function(o){o.hide()}}]})},getSelectedAttributes:function(){var j=[];var m=this.checkboxes.length;for(var k=0;k<m;k++){var l=this.checkboxes[k];if(l.isChecked()){j.push(l.getId())}}return j},buildDialogBody:function(v){var r=this;var m=h.createElement("div",{styles:{position:"relative",height:"100%",overflow:"auto"}});if(v.showGraphListSettings||v.showGraphSettings){var u=new g({id:"hilite-links-toggle",type:"switch",label:f.highlightParentConnectionsOnSelect,checked:v.highlightParentConnectionsOnSelect,}).inject(m)}if(v.showGraphListSettings){var j=new g({id:"compact-view-toggle",type:"switch",label:f.UseCompactDisplay,checked:v.compactView}).inject(m)}if(v.showGraphListSettings){var t=h.createElement("div",{html:f.SelectColumns}).inject(m);var k=h.createElement("form",{});var o=h.createElement("fieldset",{id:"attribute-preference-content","class":"preferenceSet"});var p=v.allAttributes.length;this.checkboxes=[];for(var q=0;q<p;q++){var s=v.allAttributes[q];var l=s.isSelected;if(l){this.addAttrItem(o,s)}}for(var q=0;q<p;q++){var s=v.allAttributes[q];var l=s.isSelected;if(!l){this.addAttrItem(o,s)}}o.inject(k);k.inject(m)}return m},addAttrItem:function(j,i){var k=new g({id:i.name,type:"checkbox",className:"primary",label:i.displayName,checked:i.isSelected,disabled:(i.disabled==true)?true:false}).inject(j);this.checkboxes.push(k)}});return d});define("DS/ENOXVersionExplorerViews/VersionExplorerPrefs",["UWA/Class","DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg","DS/LifecycleServices/LifecycleServices","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg"],function(a,c,b,e){var d=a.extend({init:function(h,i,f,g){this._parent({});this.allColumns=f;this.defaultCols=g;this.hWidget=h;this.appId=i},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map(function(f){return f.dbKey})},load:function(){var f=null;if(this.hWidget){f=this.hWidget.getValue(this.appId)}else{f=JSON.parse(window.localStorage.getItem(this.appId))}if(f==null){f=this.defaultCols;this.save(f)}return f},save:function(f){if(this.hWidget){this.hWidget.setValue(this.appId,f)}else{window.localStorage.setItem(this.appId,JSON.stringify(f))}},getAttrDispName:function(f){var g=f;if(f=="newTarget"){g=e.newTarget}else{g=b.getAttributeDisplayName(f)}return g},customizations:function(j){var l=this;var m=this.load();var g=[{name:"title",displayName:this.getAttrDispName("title"),isSelected:true,disabled:true}];for(var k=0,f=m.length;k<f;k++){var h=this.allColumns.find(function(i){return m[k]===i.dbKey});if(h){g.push({name:h.dbKey,displayName:h.columnNLS,isSelected:true})}}var o=this.allColumns.length;for(var k=0;k<o;k++){if(m.indexOf(this.allColumns[k].dbKey)==-1){g.push({name:this.allColumns[k].dbKey,displayName:this.allColumns[k].columnNLS,isSelected:false})}}c.showDialog({title:e.SettingsTitle,parent:document.body,showGraphListSettings:j.showGraphListSettings,showGraphSettings:j.showGraphSettings,highlightParentConnectionsOnSelect:j.highlightParentConnectionsOnSelect,compactView:j.compactView,allAttributes:g,onShow:function(i){if((j.onShowDlg!==undefined)&&(j.onShowDlg!==null)){j.onShowDlg(i)}},onOk:function(r){var p={};if(r.compactView!==undefined){p.compactView=r.compactView}if(r.highlightParentConnectionsOnSelect!==undefined){p.highlightParentConnectionsOnSelect=r.highlightParentConnectionsOnSelect}if(r.attributes!==undefined){p.attributes=[];var s=r.attributes.length;for(var q=0;q<s;q++){if(r.attributes[q]=="title"){continue}p.attributes.push(r.attributes[q])}l.save(p.attributes)}if((j.onOk!==undefined)&&(j.onOk!==null)){j.onOk(p)}}})},setParams:function(h,g,f){if(typeof h==="string"&&h.length){this.appId=h}if(Array.isArray(g)&&g.length){this.allColumns=g}if(Array.isArray(f)&&f.length){this.defaultCols=f}}});return d});define("DS/ENOXVersionExplorerViews/VersionExplorerView",["UWA/Core","UWA/Controls/Abstract","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/WebappsUtils/WebappsUtils","DS/ENOXVersionExplorerViews/VersionExplorerToolbar","DS/Tree/TreeDocument","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerViews/NodeDropdownMenu","DS/ENOXVersionExplorerViews/VersionExplorerModal","DS/ENOXVersionExplorerThumbnailGraphView/NodeEdgeViewsTemplates/DefaultNodeEdgeViewsTemplate","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerSubwayListView/VersionExplorerSubwayListView","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleControls/DelayedMask","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","css!DS/ENOXVersionExplorerViews/styles/VersionExplorer",],function(c,k,n,b,q,g,d,p,l,e,j,i,m,o,f,a,h){var r=k.extend({_versionModel:undefined,init:function(v){r.implement({displayLegend:function(aa){y&&y.addLegendButton(aa);J.getElement(".versionexplorer-legend")[(aa===true?"addClassName":"removeClassName")]("versionexplorer-legend-expanded")},removeLegend:function(){J.getElement(".versionexplorer-legend").removeClassName("versionexplorer-legend-expanded");y&&y.removeLegendButton()},showDialog:function(aa,ac,ab){l.displayDialog({globalDiv:J,parentContainer:ac,modal:ab,footerStyle:((m._SELECTION_MODE&j.SELECTION_MODES.WITH_COMMANDS)?l.footerStyle.none:l.footerStyle.okCancel),position:aa,onCloseDlg:function(){E.cleanup()},onOK:function(ad){E.publishEvent("ENOXVersionExplorerModalOK",E.getSelectedNodes())},onCancel:function(){E.publishEvent("ENOXVersionExplorerModalCancel")}})},hideDialog:function(){l._closeDlg()},setTitle:function(aa){l.setTitle(aa)},setThumbnailGraphLayout:function(aa){X.setRootPosition(n.OrientationMode[aa]);m._saveUserSettings("thumbnailGraphLayout",aa);E.publishEvent("ENOXVersionExplorerThumbnailGraphLayoutChanged",aa)},reframeThumbnailGraph:function(){G===j.DISPLAY_MODES.THUMBNAIL_VIEW&&X&&X.reframeAll()},setThumbnailOverviewVisibility:function(){X[m.UserSettings.displayThumbnailOverview===true?"showOverview":"hideOverview"]();J.getElement(".version-thumbnail-canvas").hide();J.getElement(".version-thumbnail-canvas").show()},updateViewOptions:function(){var aa=undefined;Q();switch(w._versionModel._DATA_MODEL_TYPE){case j.DATA_MODEL_TYPES.MODEL_P:case j.DATA_MODEL_TYPES.MODEL_ER:case j.DATA_MODEL_TYPES.MODEL_REVISION:aa={displayThumbnailCollapser:(!m.X_DESIGN),displaySemantic:(!m.X_DESIGN),};break;default:aa={displayThumbnailCollapser:true,displaySemantic:true,};break}S&&S.updateViewOptions(aa)},displayView:function(aa){switch(m.UserSettings.displayMode){case j.DISPLAY_MODES.THUMBNAIL_VIEW:w._displayThumbnailGraph(aa);break;case j.DISPLAY_MODES.SUBWAY_VIEW:w._displaySubwayGraph();break;default:break}M()},setSubwayRowHeight:function(aa){V.setRowHeight(aa)},_customizeColumns:function(){w.customizeColumns.customizations({showGraphListSettings:(m.UserSettings.displayMode==j.DISPLAY_MODES.SUBWAY_VIEW),showGraphSettings:(m.UserSettings.displayMode==j.DISPLAY_MODES.THUMBNAIL_VIEW),compactView:(m.UserSettings.subwayViewMode==="SUBWAY_COMPACT_VIEW"),highlightParentConnectionsOnSelect:m.UserSettings.highlightParentConnectionsOnSelect,onOk:function(ai){if(ai.compactView!==undefined){var ad=m.UserSettings.subwayViewMode;var ab=ai.compactView?"SUBWAY_COMPACT_VIEW":"SUBWAY_COMFORTABLE_VIEW";if(ab!==ad){m._saveUserSettings("subwayViewMode",ab);w.setSubwayRowHeight(j.SUBWAY_VIEW_MODE[ab])}}if(ai.highlightParentConnectionsOnSelect!==undefined){var af=m.UserSettings.highlightParentConnectionsOnSelect;var aa=ai.highlightParentConnectionsOnSelect;if(aa!==af){w.updateParentHighlighting(aa)}}if(V){V.prepareUpdateColumns();var ac=w.customizeColumns.getAll();var ag=d.intersectionDifference(ac,ai.attributes,function(aj,ak){return aj.dbKey===ak}),ae=ag[0].difference.map(function(aj){return aj.outputKey}),ah=ac.filter(function(aj){return ai.attributes.findIndex(function(ak){return ak===aj.dbKey})>=0}).map(function(aj){return aj.outputKey});V.getColumnManager().hideColumns(ae);V.getColumnManager().showColumns(ah);V.pushUpdateColumns(false)}},onShowDlg:function(aa){}})},_displayThumbnailGraph:function(aa){if(!(w._versionModel instanceof g)){throw Error("Version Model must be an instance of TreeDocument")}H();N();(aa===true)&&X.reframeAll();m._saveUserSettings("displayMode",G);if(m.UserSettings.displayThumbnailOverview){(y&&y.select("menuToggleOverview",true))}w.setThumbnailOverviewVisibility();J.getElement(".version-thumbnail-canvas").hide();J.getElement(".version-thumbnail-canvas").show();E.publishEvent("_ENOXVersionExplorerViewChanged")},_displaySubwayGraph:function(){Y();U();m._saveUserSettings("displayMode",G);E.publishEvent("_ENOXVersionExplorerViewChanged")},_manageSelect:function(ab){var ac=ab.data;var ad=ab.notifyThumbnailUI;var aa=w._versionModel.searchByAttribute("__checked__",true);if(!(m._SELECTION_MODE&j.SELECTION_MODES.MULTI_SELECT_ONLY)){m._SELECTION_MODE&=~j.SELECTION_MODES.MULTI_SELECT_ACTIVE;m._USER_SET_MULTI_SELECT=false;y&&y.deactivateMultiSelect();T&&(w._versionModel.getModelEvents().unsubscribe(T),T=undefined);O&&(w._versionModel.getModelEvents().unsubscribe(O),O=undefined);w._versionModel.getXSO().get().length>1&&w._versionModel.unselectAll();aa.forEach(function(ae){ae.options.grid.__checked__=false});ad=true}else{if(((aa&&aa.length>0)||m._USER_SET_MULTI_SELECT)&&(!ac)&&(m._SELECTION_MODE&j.SELECTION_MODES.MULTI_SELECT_ONLY)){if(!(m._SELECTION_MODE&j.SELECTION_MODES.MULTI_SELECT_ACTIVE)){m._SELECTION_MODE|=j.SELECTION_MODES.MULTI_SELECT_ACTIVE}y&&y.activateMultiSelect();Z&&(E.unsubscribeEvent("_ENOXVersionExplorerManageMultiSelect",Z),Z=undefined);T=T||w._versionModel.getModelEvents().subscribe({event:"select"},C);O=O||w._versionModel.getModelEvents().subscribe({event:"unselect"},C);ad=true;y&&y[(aa&&aa.length>1&&(m._SELECTION_MODE&j.SELECTION_MODES.WITH_COMMANDS)?"showMultiSelectDropdown":"hideMultiSelectDropdown")]()}else{if(!m._USER_SET_MULTI_SELECT){m._SELECTION_MODE&=~j.SELECTION_MODES.MULTI_SELECT_ACTIVE;y&&y.deactivateMultiSelect();T&&(w._versionModel.getModelEvents().unsubscribe(T),T=undefined);O&&(w._versionModel.getModelEvents().unsubscribe(O),O=undefined);Z=Z||E.subscribeEvent("_ENOXVersionExplorerManageMultiSelect",w._manageSelect);(ac===true)&&(w._versionModel.unselectAll(),aa.forEach(function(ae){ae.options.grid.__checked__=false}));ad=true}}}y&&y.setMultiSelectCount(aa.length);ad&&G===j.DISPLAY_MODES.THUMBNAIL_VIEW&&X&&X.notifyUpdateNodes("_selectionMode");G===j.DISPLAY_MODES.SUBWAY_VIEW&&V&&V.updateSelectionMode()},setSelectionMode:function(aa){if(aa!==m._SELECTION_MODE){(aa>=0)&&(m._SELECTION_MODE=aa);y&&y[(!(m._SELECTION_MODE&j.SELECTION_MODES.MULTI_SELECT_ONLY)?"hideMultiSelect":"showMultiSelect")]();this._manageSelect({notifyThumbnailUI:true})}},onMultiSelectDropdownClick:function(ab){var aa=E.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(ad){E.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",aa);var ac=w._versionModel.searchByAttribute("__checked__",true);E._getMultiSelectMenuListPromise(ac).then(function(ae){p.displayNodeDropdownMenu.bind(E)({treeNode:ac,target:null,menuList:ae,position:{x:ab.clientX,y:ab.clientY},dropdownContainer:J})})});E.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:false,contextualMenu:true})},build:function(){I();R();A()},_getActiveView:function(){return G},cleanup:function(){X&&X.cleanup();V&&V.cleanup();G=null},setLoadingMask:function(){if(!F){F=new o(J,1000,a.loadingText)}},unmask:function(){if(F){F.unmask();F=null}},setFocus:function(ab){var aa=(ab instanceof f)?[ab]:w._versionModel.getXSO().get();if(Array.isArray(aa)&&aa.length>0){if(G===j.DISPLAY_MODES.THUMBNAIL_VIEW){X&&X.reframeOn(aa)}else{V&&V.setFocus(aa[aa.length-1])}}},_highlightParents:function(ab){if(m.UserSettings.highlightParentConnectionsOnSelect===true){var aa=x(ab);if(m.UserSettings.highlightParentConnectionsOnSelect===true&&aa&&aa.links){this._highlightLinks(aa.links)}}},_unhighlightParents:function(ab){var aa=x(ab);aa&&aa.nodes&&this._unhighlightNodes(aa.nodes);aa&&aa.links&&this._unhighlightLinks(aa.links)},_highlightNodes:function(aa){if(Array.isArray(aa)){aa.forEach(function(ab){if(ab instanceof f){ab.highlight()}else{if(typeof ab==="string"){ab=w._versionModel.searchByID(ab);if(ab.length===1){ab[0].highlight()}}}})}else{if(typeof aa==="function"){w._versionModel._nodeList.filter(aa).forEach(function(ab){ab.highlight()})}}},_unhighlightNodes:function(aa){if(Array.isArray(aa)){aa.forEach(function(ab){if(ab instanceof f){ab.unhighlight()}else{if(typeof ab==="string"){ab=w._versionModel.searchByID(ab);if(ab.length===1){ab[0].unhighlight()}}}})}else{if(typeof aa==="function"){w._versionModel._nodeList.filter(aa).forEach(function(ab){ab.unhighlight()})}}},_highlightLinks:function(aa){if(Array.isArray(aa)&&aa.length){aa.forEach(function(ab){w._versionModel.highlightLink(ab)})}},_unhighlightLinks:function(aa){if(Array.isArray(aa)&&aa.length){aa.forEach(function(ab){w._versionModel.unhighlightLink(ab)})}},updateParentHighlighting:function(ab){m._saveUserSettings("highlightParentConnectionsOnSelect",ab);var ac=w._versionModel.getXSO().get(),aa;ac.forEach(function(ad){aa=x(ad);if(aa&&aa.links){w[ab===true?"_highlightLinks":"_unhighlightLinks"](aa.links)}})}});function I(){var aa=w.options;L=aa.parentContainer;B=(typeof aa.showToolbar==="boolean")?aa.showToolbar:true;z=aa.mapScaleLimits||z;t=aa.iconPath||b.getWebappsBaseUrl()+"ENOXVersionExplorerViews/assets/icons/";E=aa.versionExplorerController;S=aa.nodeEdgeViewsTemplate;s=aa.customOnDrop;if(!S){S=new e()}}function R(){var aa="";J=c.createElement("div",{"class":"version-global-div",html:['<div class="versionexplorer-toolbar">',"</div>",'<div class="modal-header versionexplorer-legend">','   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="version-thumbnail-canvas">',"</div>",'<div class="version-subway-canvas">',"</div>",].join("\n")});if(L){L=c.extendElement(L);L.setContent(J)}}function Q(){if(B){J.getElement(".versionexplorer-toolbar").show();if(!y){y=new q({renderTo:J.getElement(".versionexplorer-toolbar"),versionExplorerView:w,versionExplorerController:E})}y.show()}else{J.getElement(".versionexplorer-toolbar").hide()}}function A(){var aa=J.getElement(".version-thumbnail-canvas");if(aa){aa.addEvent("resize",function(){D()})}J.getElement(".versionexplorer-legend span.close").addEvent("mousedown",function(ab){y&&y.handleThumbnailGraphToolbar(ab,y.getItem("menuToggleLegend"))})}function u(aa){var ae=aa.displayMode===j.DISPLAY_MODES.THUMBNAIL_VIEW?aa.node.data.options.id:aa.cellInfos.nodeModel.__MASTER__.options.id,ad,ac,af=w._versionModel.searchByAttribute("__checked__",true);var ab=E.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",function(ak){E.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",ab);if(aa.displayMode===j.DISPLAY_MODES.THUMBNAIL_VIEW){ac=aa.node;if(m._SELECTION_MODE&j.SELECTION_MODES.WITH_COMMANDS&&((m._FILTER_ENABLED&&ac.data.getAttribute("__filter__"))||!m._FILTER_ENABLED)){var ah=w._versionModel.searchByID(ae);ac=(ah.length===1)?ah[0].__treeGraphNode__:undefined;if(ac){var ag,am,aj;if(!m._USER_SET_MULTI_SELECT){aj=ac.grNode.views.main.display.elt.querySelector("."+S.HTMLViewsClasses.nodeClass).getBoundingClientRect()}else{aj=ac.grNode.views.main.display.elt.querySelector("."+S.HTMLViewsClasses.nodeDropdownMenuButtonClass).getBoundingClientRect()}(aj)&&(ag=(aj.left+aj.right)/2,am=(aj.top+aj.bottom)/2);ad={treeNode:ac.data,target:ac.grNode.views.main.display.elt,selectedNodes:af,position:{x:ag,y:am},dropdownContainer:J}}}}else{var al=aa.cellInfos,ai=aa.event;ac=al.nodeModel.__MASTER__;if(m._SELECTION_MODE&j.SELECTION_MODES.WITH_COMMANDS&&((m._FILTER_ENABLED&&ac.getAttribute("__filter__"))||!m._FILTER_ENABLED)){ad={treeNode:ac,target:al.view,selectedNodes:af,position:{x:ai.clientX,y:ai.clientY},dropdownContainer:J}}}(m._SELECTION_MODE&j.SELECTION_MODES.WITH_COMMANDS)&&!!ad&&E.publishEvent("ENOXVersionExplorerDropdownMenu",ad)});E.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:false,contextualMenu:true})}function P(aa){E.publishEvent("ENOXVersionExplorerDoubleClickVersion",aa)}function D(){var ab=J.getElement(".version-thumbnail-canvas");if(ab&&ab.getStyle("display")!=="none"&&X!==undefined){var aa=ab.getBoundingClientRect();X.setSize(aa.width,aa.height)}}function M(){function ab(ac){var af=undefined;if(typeof ac==="object"&&Object.keys(ac).length){af=c.createElement("ul",{"class":"iconbar-items-wrap iconbar-items-icons"});for(var ae in ac){af.addContent('<li><div class="symbol">'+ae.toString()+'</div><div class="text">'+ac[ae]+"</div></li>")}}var ad=J.getElement(".versionexplorer-legend ul");ad&&ad.destroy();af.inject(J.getElement(".versionexplorer-legend"),"top")}var aa=w._versionModel.getLegend();if(typeof aa==="object"&&Object.keys(aa).length){ab(aa);w.displayLegend(m.UserSettings.displayLegend)}else{w.removeLegend()}}function C(ab){var ad=ab.target;ad.options.grid.__checked__=ad._isSelected;var aa=w._versionModel.getXSO().get();for(var ac=0;ac<aa.length;ac++){aa[ac].options.grid.__checked__=aa[ac]._isSelected}w._manageSelect({data:false})}function H(){J.getElement(".version-subway-canvas").hide();V&&V.deactivate()}function U(){J.getElement(".version-subway-canvas").show();if(!V){I();V=new i({container:J.getElement(".version-subway-canvas"),onNodeDropdownMenu:function(aa){aa.displayMode=j.DISPLAY_MODES.SUBWAY_VIEW;u(aa)},onNodeDoubleClick:P,customOnDrop:s,model:w._versionModel,defaultCellHeight:j.SUBWAY_VIEW_MODE[m.UserSettings.subwayViewMode]});w._subwayGraphView=V;if(B){y.show();y.setView("menuDisplaySubwayListView");y.setSubwayViewRowHeight(m.UserSettings.subwayViewMode,true)}w.setSelectionMode()}if(G!==j.DISPLAY_MODES.SUBWAY_VIEW){V.activate();V.updateSelectionMode();G=j.DISPLAY_MODES.SUBWAY_VIEW}}function Y(){J.getElement(".version-thumbnail-canvas").hide();X&&X.deactivate()}function N(){J.getElement(".version-thumbnail-canvas").show();if(!X){function aa(ae){ae.displayMode=j.DISPLAY_MODES.THUMBNAIL_VIEW;u(ae)}var ab;if(isNaN(Number(m.UserSettings.thumbnailGraphLayout))){ab=n.OrientationMode[m.UserSettings.thumbnailGraphLayout]}else{ab=Number(m.UserSettings.thumbnailGraphLayout);for(var ac in j.THUMBNAIL_GRAPH_LAYOUT){if(j.THUMBNAIL_GRAPH_LAYOUT[ac]===ab){m._saveUserSettings("thumbnailGraphLayout",ac);break}}}var ad={NodeEdgeViewsTemplate:S,orientation:ab,onNodeDropdownMenu:aa,onNodeDoubleClick:P,onContextualEvent:aa};X=new n.SyncEGraphTree(J.getElement(".version-thumbnail-canvas"),ad);X.setModel(w._versionModel);X.createOverview();if(B){y.show();y.setView("menuDisplayThumbnailView")}w.setSelectionMode();w._thumbnailGraphView=X;X.setRootPosition(n.OrientationMode[m.UserSettings.thumbnailGraphLayout])}if(G!==j.DISPLAY_MODES.THUMBNAIL_VIEW){X.activate();G=j.DISPLAY_MODES.THUMBNAIL_VIEW;w.setFocus()}else{X.notifyUpdateNodes("_selectionMode")}}function x(ab){var aa;if(Array.isArray(ab.options.ancestors)&&ab.options.ancestors.length){aa=ab.options.ancestors.reduce(function(ad,ac){ad.nodes.push(ac.id);ad.links.push([ac.id,ab.options.id]);return ad},{nodes:[],links:[]})}return aa}var w=this,L=undefined,W=undefined,K=undefined,B=true,t=undefined,z={maxScale:1,minScale:0.25},E=undefined,X=undefined,V=undefined,S=undefined,G=undefined,y=undefined,J=undefined,T=undefined,O=undefined,Z=undefined,s=undefined,F=undefined;w._parent(v);w._versionModel=v.versionModel;w.customizeColumns=v.customizeColumns;if(v._isODT){r.implement({_ODTGetThumbnailView:function(){return X},_ODTGetSubwayView:function(){return V}})}}});return r});