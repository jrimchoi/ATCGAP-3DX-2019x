define("DS/3DPlayWidgetViews/W3DPlayerView",["DS/CoreEvents/Events","UWA/Class","DS/3DPlayHelper/3DPlayHelper","DS/3DPlaySupport/AssetSupport","i18n!DS/3DPlayHelper/assets/nls/SplashScreen","css!DS/3DPlayWidgetViews/W3DPlayerView","DS/WebSystem/Environment"],function(o,b,d,a,h,c,l){var n,g,f,k,e="canvas-div";var j,i=[];return b.extend({init:function(p,m){n=p;g=m;this._parent(p,m);this.setViewerCollab();this.declareAllSubscribers();j=this},declareAllSubscribers:function(){i.push(o.subscribeOnce({event:"PrefsCtrl.PreferencesReady"},function(m){j.instantiate3DPlayWebPlayer()}));i.push(o.subscribe({event:"Player.load"},function(m){if(f){f.load(m)}}));i.push(o.subscribe({event:"Model.changeCurrent"},function(m){j.refresh()}));i.push(o.subscribe({event:"Model.changeCSO"},function(m){j.incomingSelectPartHandler(m)}))},setViewerCollab:function(){window.top.document.addEventListener("3DPLAYLOADINGFINISHED",function(m){k=m.detail.helper},false)},incomingSelectPartHandler:function(q){var m;if(k.instance&&k.instance.pad3DViewer){m=k.instance.pad3DViewer._lockCSONotification;k.instance.pad3DViewer._lockCSONotification=true}k.emptySelection();k.selectNode(q);var p=function(){if(k.instance&&k.instance.pad3DViewer){k.instance.pad3DViewer._lockCSONotification=m}};p();setTimeout(p,50)},instantiate3DPlayWebPlayer:function(){this.processPlayerOptions()},refresh:function(){this.processPlayerOptions()},processPlayerOptions:function(){var p=g.getCurrentData();g.setCurrentTitle(p.displayName);var m=g.get3DPlayWebInputObject(p);m.container=e;if(m.input&&m.input.asset){m.input.asset.displayname=p.displayName}this.startPlayer(m)},dispose:function(m){if(f){f.dispose(m);f=null}n=g=k=null;for(var p=0;p<i.length;p++){o.unsubscribe(i[p])}i=[];j=null},startPlayer:function(m){if(this.applicationFrameOptions&&m.options){if(m.options.callbacks){m.options.callbacks=UWA.extend(m.options.callbacks,this.applicationFrameOptions.options.callbacks,true)}m.options=UWA.extend(m.options,this.applicationFrameOptions.options,true);if(m.input&&this.applicationFrameOptions.experience){m.input.experience=this.applicationFrameOptions.experience}}if(this.applicationFrameOptions&&this.applicationFrameOptions.options&&this.applicationFrameOptions.options.pad3DViewer){delete this.applicationFrameOptions.options.pad3DViewer}if(!f){m.options.callbacks.EXPERIENCE=m.options.callbacks.EXPERIENCE||{};m.options.callbacks.EXPERIENCE.EXPERIENCESPLASHSCREEN=function(q){if(document.activeElement.offsetWidth>780&&document.activeElement.offsetHeight>200){this.formFactor="L"}else{if(document.activeElement.offsetWidth<779&&document.activeElement.offsetWidth>581&&document.activeElement.offsetHeight>200){this.formFactor="M"}else{if(document.activeElement.offsetWidth<580&&document.activeElement.offsetWidth>280&&document.activeElement.offsetHeight>200){this.formFactor="S"}else{if(document.activeElement.offsetWidth<280||document.activeElement.offsetHeight<200){this.formFactor="XS"}else{this.formFactor="L"}}}}if(!l.isSet("3DPlay.LandingPage.disable")){q.viewLoading.addContent({tag:"div","class":"lp-txt-container",html:[{tag:"h4",id:"lp-msg","class":"lp-txt font-3dsregular",html:h.DROP_MSG_LP},{tag:"img","class":"lp-drop-img"}]});if(this.formFactor==="L"){q.viewLoading.addClassName("large-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img")}else{if(this.formFactor==="M"){q.viewLoading.addClassName("large-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img")}else{if(this.formFactor==="S"){q.viewLoading.addClassName("small-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img-small");q.viewLoading.getElementsByTagName("h4")[0].hide()}else{if(this.formFactor==="XS"){q.viewLoading.addClassName("xsmall-background");q.viewLoading.getElementsByTagName("h4")[0].hide();q.viewLoading.getElementsByTagName("img")[0].hide()}}}}}};f=new d(m)}else{if(f.isReady()){f.load(m)}else{g.isPendingLoadingCozNotReady=true}}g.setPlayerRef(f)},widgetRefreshHandler:function(){if(f){if(f.instance&&f.instance.refresh){var m=f.instance.refresh();if(m){return true}}f.dispose();f=null}g.getCanvasDiv().empty();return false},get3DPlayInstance:function(){return f}})});define("DS/3DPlayWidgetViews/W3DPlayMainView",["DS/CoreEvents/Events","DS/WebSystem/Environment","UWA/Class","css!DS/3DPlayWidget/assets/3DPlayWidget"],function(l,j,b,a){var k,e,i=[];var c=false;var h;var f,g;var d=b.extend({init:function(n,m){k=n;e=m;h=this;this.buildView();this.createBlueBackground();this.declareAllSubscribers()},buildView:function(){if(j.isBoolActive("3DPlay.SwitchApp")){}else{k.body.empty()}k.body.setStyle("height","100%");this.buildCanvas()},buildCanvas:function(){if(e.applicationFrameOptions&&e.applicationFrameOptions.options){c=e.applicationFrameOptions.options.pad3DViewer!==undefined}this.canvasDiv=document.getElementById("canvas-div");if(!this.canvasDiv){this.canvasDiv=UWA.createElement("div",{id:"canvas-div",html:""});this.canvasDiv.setAttribute("data-rec-id","canvasDivID");if(c){this.canvasDiv.inject(e.applicationFrameOptions.options.pad3DViewer.elements.container)}else{this.canvasDiv.inject(k.body)}}e.setCanvasDiv(this.canvasDiv);l.subscribeOnce({event:"Model.PreferencesReady"},function(n){if(!e.isPreferencesEmpty()){var m=e.getCurrentData();h.updateWidgetTitle(m.displayName)}});this.declareDragAndDropZone()},createBlueBackground:function(){this.backgroundContainer=document.getElementById("background_container");if(!this.backgroundContainer){this.backgroundContainer=UWA.createElement("div",{id:"background_container","class":"blue_background_container",styles:{display:"none"}});this.backgroundContainer.inject(this.canvasDiv);this.backgroundContainer.setContent({tag:"div","class":"background_container_display drop"});var m=e.getBoxMessageText("DROPIT");this.backgroundContainer.addContent({tag:"div","class":"drop_container_display",});this.backgroundContainer.addContent({tag:"div","class":"drop_container_txt",html:[{tag:"h3",id:"drop_msg","class":"drop_invite_txt font-3dsregular drop",html:m}]})}this.drop_msgDom=this.backgroundContainer.getElement("h3.drop_invite_txt")},hideBlueBackground:function(m){this.backgroundContainer.setStyle("display",m)},displayBlueBackground:function(){this.hideBlueBackground("block")},updateBlueBackgroundMessage:function(m){var n=e.getBoxMessageText(m);this.drop_msgDom.setHTML(n)},create3DPlayInviteContainer:function(){this.inviteContainer=document.getElementById("pad_invite");if(!this.inviteContainer){this.inviteContainer=UWA.createElement("div",{id:"pad_invite","class":"pad_invite_container",html:"Invite Container",styles:{display:"none"}});this.inviteContainer.inject(this.canvasDiv,"before");var m=e.getBoxMessageText("DROPIT");this.inviteContainer.setContent([{tag:"div","class":"pad_invite_display drop",html:[{tag:"span",id:"invite_img","class":"pad_invite_img fonticon fonticon-3x fonticon-down-circled"},{tag:"h5",id:"invite_msg","class":"pad_invite_txt font-3dsregular drop",html:m}]}])}this.invite_imgDom=this.inviteContainer.getElement("span.pad_invite_img");this.invite_msgDom=this.inviteContainer.getElement("h5.pad_invite_txt")},addWidgetNotification:function(m){if(!f){require(["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(o,n){f=n;g=o;f.setNotificationManager(o);h.addWidgetNotification(m)})}else{g.addNotif({level:m.level,message:m.message,title:m.title,sticky:m.sticky})}},hideLastWidgetNotification:function(){if(f){f.removeLastNotificationDisplayed()}},refresh:function(){var m=e.getCurrentData();this.updateWidgetTitle(m.displayName)},updateWidgetHeight:function(){console.log(k.getViewportDimensions().height);k.body.setStyle("height","100%")},declareAllSubscribers:function(){i.push(l.subscribe({event:"Model.changeTitle"},function(m){h.refresh()}))},dispose:function(){h=null;if(this.restoreDragAndDropZone){this.restoreDragAndDropZone()}for(var m=0;m<i.length;m++){l.unsubscribe(i[m])}i=[]},declareDragAndDropZone:function(){var o=function(p){this.removeClassName("drag_over_class");h.hideBlueBackground("none")};var m=function(p){p.preventDefault();this.removeClassName("drag_over_class");h.hideBlueBackground("none");if(j.isSet("3DPlay.DnD","true")&&event.dataTransfer.files.length&&event.dataTransfer.files[0]!==undefined){l.publish({event:"MainView.onFileDrop",data:p.dataTransfer})}else{l.publish({event:"MainView.onDrop",data:p.dataTransfer.getData("text")})}};var n=function(p){p.preventDefault();this.addClassName("drag_over_class");h.displayBlueBackground();h.updateBlueBackgroundMessage("DROPIT");if(p.dataTransfer){p.dataTransfer.dropEffect="copy"}};this.canvasDiv.addEventListener("dragenter",n);this.canvasDiv.addEventListener("dragover",n);this.canvasDiv.addEventListener("dragleave",o);this.canvasDiv.addEventListener("dragend",o);this.canvasDiv.addEventListener("drop",m);this.restoreDragAndDropZone=function(){this.canvasDiv.removeEventListener("dragenter",n);this.canvasDiv.removeEventListener("dragover",n);this.canvasDiv.removeEventListener("dragleave",o);this.canvasDiv.removeEventListener("dragend",o);this.canvasDiv.removeEventListener("drop",m)}},hideShowBoxMessage:function(m){this.inviteContainer.setStyle("display",m)},updateBoxMessage:function(n){var m=e.getBoxClassIcon(n);var o=e.getBoxMessageText(n);if(n=="DEFAULT"){this.invite_imgDom.removeClassName(m);this.invite_imgDom.addClassName("fonticon-down-circled")}else{this.hideShowBoxMessage("block");this.invite_msgDom.setHTML(o);this.invite_imgDom.removeClassName("fonticon-down-circled");this.invite_imgDom.addClassName(m)}},updateWidgetTitle:function(n){var m="3DPlay";k.setTitle("");if(n!=""&&n!==null&&typeof n!=="undefined"){m=n}k.setTitle(m);k.setValue("afrProductTitle",null)}});return d});