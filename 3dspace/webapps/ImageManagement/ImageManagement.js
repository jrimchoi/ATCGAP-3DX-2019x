define("DS/ImageManagement/ImageManagement",["UWA/Core","DS/Foundation/FoundationAjax","DS/Foundation2/IndependentServiceBase"],function(g,f,d){"use strict";var c=d.extend({SERVICE_ROOT_URL:"/resources/v1/modeler/images/",deleteImage:function(){return this._deleteRootObject.apply(this,arguments)},disconnectImage:function(n,l,j){var m=this;var i=g.clone(j||{},false);i.requestType="delete";var h=this._prepareService(this.disconnectImage.bind(this,n,l,j),i);if(h){return h}var k={id:l,updateAction:"NONE",relateddata:{parents:[{id:n}]}};return f.ajaxRequest({url:this.SERVICE_ROOT_URL,type:"delete",dataType:"json",data:JSON.stringify({csrf:this.getCsrf(i.tenantUrl),data:[k]}),callback:function(o){if(o&&o.csrf){m.setCsrf(o.csrf,i.tenantUrl)}if(o&&o.success&&g.is(j.onComplete,"function")){j.onComplete(o,j)}else{if(g.is(j.onFailure,"function")){j.onFailure(o)}}},headers:{"content-type":"application/json"}})},getImages:function(){this._getObjects.apply(this,arguments)},createImage:function e(h,n){var j=g.clone(h,false);j.fileName=j.fileName||j.primaryImage;var l;if(j&&j.file){var i=g.clone(n||{},false);var m=this;if(!i.csrf){i.csrf="notNeeded"}var k=this.SERVICE_ROOT_URL+"CheckinTicket";this._prepareService(undefined,i);var p={csrf:this.getCsrf(i.tenantUrl)};i.fileInfo=j;var o={url:k,type:"put",dataType:"json",data:JSON.stringify(p),callback:function(q){m._handleTicket(q,i)},headers:{"content-type":"application/json"}};l=f.ajaxRequest(o)}return l},_handleFCSReceipt:function a(j,q){var n=this;var l;var m=q.fileInfo;var i=m&&m.file;if(i){var o=m&&m.tempId;var k=m&&m.parentId;var h={tempId:o,dataelements:{fcsReceipt:j}};if(k){h.relateddata={parents:[{id:k}]}}var p={csrf:n.getCsrf(q&&q.tenantUrl),data:[h]};l=f.ajaxRequest({url:this.SERVICE_ROOT_URL,type:"post",dataType:"json",data:JSON.stringify(p),callback:function(r){if(r&&r.csrf){n.setCsrf(r.csrf,q&&q.tenantUrl)}if(r&&r.success&&g.is(q.onComplete,"function")){q.onComplete(r,q)}else{if(g.is(q.onFailure,"function")){q.onFailure(r)}}},headers:{"content-type":"application/json"}})}return l}});var b=new c();return b});