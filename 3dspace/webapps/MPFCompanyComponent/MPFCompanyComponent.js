define("DS/MPFCompanyComponent/CompanyPmpInformationComponent",["UWA/Class/View","DS/MPFView/FieldTextInput","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(d,c,b){var a=d.extend({tagName:"form",setup:function(){var e=this.model;this.companyNameInput=new c({className:c.prototype.className+" mpf-oneline",required:true,readOnly:!!e.getName(),model:e,fieldName:"name",fieldLabel:b.get("companyName")})},render:function(){this.container.setContent([this.companyNameInput.render()]);return this}});return a});define("DS/MPFCompanyComponent/CompanyMembersWidget",["UWA/Core","UWA/Promise","UWA/Class/View","DS/UIKIT/Alert","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFUrl/UrlUtils","DS/PlatformAPI/PlatformAPI","DS/MPFShopMembersComponent/ShopMembersComponent","DS/MPFMenuComponent/StepNavigationButtonsComponent","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(h,i,c,a,e,l,d,k,j,g,f){var b=c.extend({setup:function(m){var n=this;this.displayBack=m.displayBack;this.displayFinish=m.displayFinish;this.displayNext=m.displayNext;this.topic=m.topic;e.fetchPromise().then(this._getFactories.bind(this)).then(this._fetchMe.bind(this)).then(this._fetchCompanyAndMembers.bind(this)).then(function(){var o;n.isUserAnAdmin=n.me.isAdminOfThisEMP(n.company.getEmpProjectName());if(n.isUserAnAdmin){n.companyMembersComponent=n._getCompanyMembersComponent();n.stepNavigationComponent=n._getStepNavigationComponent();o=(new d(window.location.href)).getPath();if(o.indexOf("/my-company/members")!==-1){n.onShow()}}else{n.container.setStyle("height","5em");new a({className:"error",messageClassName:"error",messages:f.get("unauthorizedMessage"),closable:true,visible:true,autoHide:true,hideDelay:5000,closeOnClick:true}).inject(n.container,"top")}})},onShow:function(){if(this.isUserAnAdmin){k.publish(this.topic,{event:"titleSet",id:"members",title:this.company.getName()});k.publish(this.topic,{event:"activateMenuItem",id:"members"});this.container.setContent([this.companyMembersComponent.render(),this.stepNavigationComponent.render()])}},_getCompanyMembersComponent:function(){return new j({addMembersModalTitle:f.get("inviteMembers"),companyMembers:true,model:this.members,completed:this.members&&this.members.size()>1,displayBack:this.displayBack,displayFinish:this.displayFinish,displayNext:this.displayNext,mpTopic:this.topic,roles:["Buyer","Admin"],inviteFactory:this.inviteFactory,container:h.createElement("div",{"class":"mpf-members"})})},_getStepNavigationComponent:function(){return new g({checkSave:false,displayBack:this.displayBack,displayFinish:this.displayFinish,displayNext:this.displayNext,stepName:"members",topic:this.topic,container:h.createElement("div",{"class":"mpf-companyFooterContainer"})})},_getFactories:function(m){var n=this;this.factories=l.getInstance(m);return i.all([this.factories.getFactory(l.Types.PERSON),this.factories.getFactory(l.Types.COMPANY),this.factories.getFactory(l.Types.INVITE)]).then(function(o){n.personFactory=o[0];n.companyFactory=o[1];n.inviteFactory=o[2]})},_fetchCompanyAndMembers:function(){var m;m=this.me.getCompanyId();this.company=this.companyFactory.createModel("company",{id:m});this.members=this.personFactory.createCollection("company");this.members.parentResourceId=m;return i.all([this.company.fetchPromise(),this.members.fetchPromise()])},_fetchMe:function(){this.me=this.personFactory.createModel("me");return this.me.fetchPromise()},destroy:function(){this.model=null;this._parent();this.container=null}});return b});define("DS/MPFCompanyComponent/CompanyFormShell",["UWA/Core","UWA/Class/View"],function(a,c){var b=c.extend({tagName:"form",className:"mpf-form",setup:function(d){d||(d={});this.inputComponents=d.inputComponents||[];this.isReadOnly=this.setReadOnly(d.isReadOnly)},render:function(){var d;d=this.inputComponents.map(function(e){return e.render()});this.container.setContent(d);return this},setReadOnly:function(e){var d=this;this.isReadOnly=(e===true);this.inputComponents.forEach(function(f){if(typeof f.setReadOnly==="function"){f.setReadOnly(d.isReadOnly)}})}});return b});define("DS/MPFCompanyComponent/CompanyNameForm",["UWA/Core","UWA/Promise","DS/MPFView/MPFView","DS/UIKIT/Input/Text","DS/MPFView/FieldTextInput","DS/MPFError/ValidationError","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(c,e,h,a,f,b,d){var g=h.extend({tagName:"form",className:"mpf-form",domEvents:{change:"onChange"},setup:function(i){this._parent(i);this.required=i.required===true;this.readOnly=i.readOnly===true;this.dynamicValidation=i.dynamicValidation===true;this.maxlength=i.maxlength;this.input=new f({model:this.model,fieldName:"name",fieldLabel:d.get("companyName"),required:this.required,readOnly:this.readOnly,dynamicValidation:this.dynamicValidation,maxlength:this.maxlength});this.inputs=[this.input]},onChange:function(i){if(i.target.required){this._validateInput(i.target)}},render:function(){this.container.setContent(this.input.render());return this},validate:function(){var i=this;var j=true;this.container.addClassName("validated");this.container.getElements(".mpf-entry input").forEach(function(k){j=j&&i._validateInput(k)},{});return j},save:function(){var i=e.deferred();var j;if(this.model.isNew()){j=this.model.save("name",this.inputs[0].getValue(),{onComplete:function(){i.resolve()},onFailure:function(){i.reject("Unable to save company")}});if(j===false){i.reject("Unable to save company")}}else{i.resolve()}return i.promise},focus:function(){this.input.focus()},_validateInput:function(i){var m=i.getParent();var l=this.model.validate(this.model.omit());var k;var j;i.removeClassName("mpf-invalidField");k=m.getElement("p");if(k!==null){m.removeChild(k)}if(l){l.filter(function(n){if(n.field==="name"){i.addClassName("mpf-invalidField");c.createElement("p",{"class":"mpf-error",text:n.message}).inject(m)}})}j=c.is(l,"array")&&l.length>0;return !(j)},setReadOnly:function(i){this.readOnly=(i===true);this.input.setDisabled(this.readOnly)},destroy:function(){this.model=null;this._parent();this.container=null}});return g});define("DS/MPFCompanyComponent/CompanyIsDueToOnlineTaxInput",["UWA/Core","DS/MPFView/FieldToggleInput","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(a,d,c){var b=d.extend({setup:function(e){e.fieldName="isSellerDueToOnlineTax";e.fieldLabel=c.get("isDueToOnlineTax");return this._parent(e)}});return b});define("DS/MPFCompanyComponent/CompanyMenuComponent",["UWA/Core","DS/PlatformAPI/PlatformAPI","DS/UWPClientCode/Navigation","DS/MPFView/MPFView","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(d,a,f,e,b){var c=e.extend({init:function(g){var h=this;this.topic=g.topic;this.stepStatus={addresses:false,information:false,members:false};this._parent(g);this.menuItems=[{name:"information",label:b.get("information")},{name:"addresses",label:b.get("addresses")},{name:"members",label:b.get("members")}];a.subscribe(this.topic,function(i){switch(i.event){case"moduleReady":a.publish(h.topic,{event:"menuReady",id:"menu"});break;case"saveComplete":var k=h.nextComponent;if(i.next){var j=h._findMenuItem(i.id);k=h.menuItems[j+1].name}h._navigateComponent({id:h.currentComponent,next:k});case"updateMenu":var j=h._findMenuItem(i.id);h.stepStatus[i.id]=i.complete;if(i.id==="information"&&d.is(i.newModel)){h.firstViewUser=i.newModel===true}if(h.firstViewUser){if(i.id===h.currentComponent){if(j>0){h._completeIcon(h.menuItems[j-1].icon)}h._activeDiv(h.menuItems[j].div)}else{h._inactiveDiv(h.menuItems[j].div)}}else{if(i.complete||(i.status&&i.status==="complete")){h._completeIcon(h.menuItems[j].icon);a.publish(h.topic,{event:"loadWidgets",id:"menu"})}else{if(i.id===h.currentComponent){h._activeDiv(h.menuItems[j].div)}else{h._inactiveDiv(h.menuItems[j].div)}}}break;case"widgetBack":var j=h._findMenuItem(i.id);i.next=h.menuItems[j-1].name;h._navigateComponent(i);break;case"widgetNext":var j=h._findMenuItem(i.id);if(j===h.menuItems.length-1){window.location.pathname="/welcome"}else{i.next=h.menuItems[j+1].name;h._navigateComponent(i)}default:break}});a.publish(h.topic,{event:"menuReady",id:"menu"})},load:function(){var g=this._createMenuItems();var h=d.createElement("div",{"class":"mpf-companyMenuContainer",html:g});this.container.setContent(h);return this},destroy:function(){this.model=null;this._parent();this.container=null;this.menuItems=null;this.stepStatus=null},_createMenuItems:function(){this.currentComponent="information";var i=[];var k=this;for(var l=0;l<this.menuItems.length;l++){if(window.location.pathname.indexOf(this.menuItems[l].name)!==-1){this.currentComponent=this.menuItems[l].name}}for(var j=0;j<this.menuItems.length;j++){var g=this.currentComponent===this.menuItems[j].name?"mpf-companyActiveMenuIcon":"mpf-companyInactiveMenuIcon";var h=this.currentComponent===this.menuItems[j].name?"mpf-companyActiveMenuItemDiv":"mpf-companyMenuItemDiv";this.menuItems[j].icon=d.createElement("span",{"class":g+" fonticon fonticon-record unchecked"});this.menuItems[j].span=d.createElement("span",{text:this.menuItems[j].label});this.menuItems[j].div=d.createElement("div",{"class":h+" "+this.menuItems[j].name,events:{click:function(o){var n=o.currentTarget||o.target;if(n.tagName.toLowerCase()!=="div"){n=n.getParent()}for(var m=0;m<k.menuItems.length;m++){if(n.hasClassName(k.menuItems[m].name)){k.nextComponent=k.menuItems[m].name;break}}if(k.currentComponent==="information"){a.publish(k.topic,{event:"save",id:"menu",target:"information"})}else{if(k.currentComponent!==k.nextComponent){k._navigateComponent({id:k.currentComponent,next:k.nextComponent})}}}},html:[this.menuItems[j].icon,this.menuItems[j].span]});i.push(this.menuItems[j].div)}return i},_navigateComponent:function(h){var g;var j=this._findMenuItem(h.id);var i=this._findMenuItem(h.next);if(this.menuItems[j].icon.hasClassName("mpf-companyActiveMenuIcon")){this._inactiveIcon(this.menuItems[j].icon)}this._inactiveDiv(this.menuItems[j].div);g=h.next.indexOf("my-company-test")===-1?"my-company-test/"+h.next:h.next;g+=window.location.search;f.routeTo(g);a.publish(this.topic,{event:"stepSet",id:h.next,step:h.next});this.currentComponent=h.next;this._activeDiv(this.menuItems[i].div);this._activeIcon(this.menuItems[i].icon)},_activeDiv:function(g){g.removeClassName("mpf-companyMenuItemDiv");g.removeClassName("mpf-companyMenuHoverLabelDiv");g.addClassName("mpf-companyActiveMenuItemDiv")},_inactiveDiv:function(g){g.removeClassName("mpf-companyActiveMenuItemDiv");g.addClassName("mpf-companyMenuItemDiv")},_completeIcon:function(g){g.removeClassName("fonticon-record");g.addClassName("fonticon-check");g.removeClassName("mpf-companyActiveMenuIcon");g.removeClassName("mpf-companyInactiveMenuIcon");g.addClassName("mpf-companyCompletedMenuIcon")},_activeIcon:function(g){if(!g.hasClassName("mpf-companyCompletedMenuIcon")){g.removeClassName("mpf-companyInactiveMenuIcon");g.addClassName("mpf-companyActiveMenuIcon")}},_inactiveIcon:function(g){g.removeClassName("mpf-companyActiveMenuIcon");g.removeClassName("mpf-companyCompletedMenuIcon");g.addClassName("mpf-companyInactiveMenuIcon");g.removeClassName("fonticon-check");if(!g.hasClassName("fonticon-record")){g.addClassName("fonticon-record")}},_findMenuItem:function(i){var g;for(var h=0;h<this.menuItems.length;h++){if(this.menuItems[h].name===i){g=h;break}}return g}});return c});define("DS/MPFCompanyComponent/CompanyNameLabel",["UWA/Core","UWA/Class/View"],function(a,c){var b=c.extend({setup:function(d){this.listenTo(this.model,"onChange:name",this.render)},render:function(){var d;d=a.createElement("p",{"class":"mpf-label",text:this.model.getName()});this.container.setContent(d);return this}});return b});define("DS/MPFCompanyComponent/CompanyHeaderComponent",["UWA/Core","UWA/Class/View","DS/PlatformAPI/PlatformAPI","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFCompanyComponent/MPFCompanyComponent"],function(e,d,b,c){var a=d.extend({setup:function(f){f||(f={});this.topic=f.topic;this._parent(f);this.titleSpan=e.createElement("span",{text:c.get("myCompanyHeader")});this.dividerSpan=e.createElement("span",{text:" | "});this.stepSpan=e.createElement("span",{"class":"mpf-companyHeaderStepSpan"});b.subscribe(this.topic,this._onReceivedMessage.bind(this))},render:function(){var f;f=e.createElement("div",{"class":"mpf-companyHeaderContainer",html:[this.titleSpan,this.dividerSpan,this.stepSpan]});this.container.setContent(f);return this},_onReceivedMessage:function(f){if(f.event==="titleSet"&&f.title&&f.id){this.stepSpan.setContent(c.get(f.id));this.titleSpan.setContent(c.get(f.title))}else{if(f.event==="stepSet"){this.stepSpan.setContent(c.get(f.step))}}},load:function(){return this.render()},destroy:function(){this.model=null;this._parent();this.container=null;this.stepSpan=null;this.titleSpan=null;this.topic=null}});return a});define("DS/MPFCompanyComponent/CompanyAddressesComponent_New",["UWA/Core","UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Button","DS/MPFBuyerAddressComponent/BuyerAddressBook","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","DS/MPFModelFactory/AddressFactory","DS/MPFAddressModel/AddressCollection","DS/MPFModelFactory/CartFactory","DS/MPFModelFactory/CartItemFactory","DS/MPFCountryModel/CountryCollection","i18n!DS/MPFCompanyComponent/assets/nls/CompanyAddressesComponent","css!DS/MPFCompanyComponent/MPFCompanyComponent"],function(j,c,l,b,n,k,a,g,d,m,i,f,h){var e=c.extend({className:"mpf-emp-company-addresses",setup:function(o){o||(o={});this._checkPrototypes(o);this._parent(o);this.company=this.model;this.addressFactory=o.addressFactory;this.addresses=o.addresses;this.cartFactory=o.cartFactory;this.cartItemFactory=o.cartItemFactory;this.countries=o.countries;this.displayBack=o.displayBack;this.displayFinish=o.displayFinish;this.displayNext=o.displayNext;this.topic=o.topic;if(j.is(this.company.addresses)&&this.company.addresses.size()>0){l.publish(this.topic,{complete:true,event:"updateMenu",id:"addresses"})}this.addressBookBilling=this._getBillingAddressBook();this.addressBookShipping=this._getShippingAddressBook();this.billingAddressContent=this._createBillingAddressContent();this.shippingAddressContent=this._createShippingAddressContent()},render:function(){this.container.setContent([this.billingAddressContent,this.addressBookBilling.render(),this.shippingAddressContent,this.addressBookShipping.render()]);this.listenTo(this.addressBookBilling,"onSelected",this._displayBillingAddress.bind(this));this.listenTo(this.addressBookShipping,"onSelected",this._displayShippingAddress.bind(this));return this},_displayBillingAddress:function(q){var p;var o;if(q.ok){this._checkCompleted();o=this.addresses.filter(function(r){return r.isBillTo()});p=this._pickAddressString({addresses:o,type:"Billing"});this.billingAddressLabel.setContent(p);q.billingAddressSaved=true;if(!j.is(q.shippingAddressSaved)){this._displayShippingAddress(q)}}},_displayShippingAddress:function(o){var q;var p;if(o.ok){this._checkCompleted();p=this.addresses.filter(function(r){return r.isShipTo()});q=this._pickAddressString({addresses:p,type:"Shipping"});this.shippingAddressLabel.setContent(q);o.shippingAddressSaved=true;if(!j.is(!o.billingAddressSaved)){this._displayBillingAddress(o)}}},_getAddressString:function(p){var o=["addressLine0","addressLine1","addressLine2","addressLine3","addressLine4","city","state","postalCode"];var q="";o.forEach(function(r){if(p.get(r)){q+=p.get(r)+", "}});q+=p.getCountry();return q},_checkCompleted:function(){if(this.addresses.size()>0){l.publish(this.topic,{complete:true,event:"updateMenu",id:"addresses"})}},_pickAddressString:function(o){var q;var p;p=o.addresses.filter(function(r){return !r.isNew()});if(p.length===0){q=h.get("enter"+o.type+"Address")}else{if(p.length===1){q=this._getAddressString(p[0])}else{q=h.get("severalAddressesDefined")}}return q},_createShippingAddressContent:function(){var p;var s;var r;var o;var q;p=this.addresses.filter(function(t){return t.isShipTo()});s=j.createElement("div",{"class":"mpf-companyAddressesLabel",html:h.get("shippingAddress")});o=j.createElement("div",{"class":"mpf-companyAddressLink",text:h.get("manageAddresses"),events:{click:this.addressBookShipping.show.bind(this.addressBookShipping)}});this.shippingAddressLabel=j.createElement("div",{"class":"mpf-companyAddressDisplay",html:this._pickAddressString({addresses:p,type:"Shipping"})});r=j.createElement("div",{"class":"mpf-companyAddressDisplayDiv",html:[this.shippingAddressLabel,o]});q=j.createElement("div",{"class":"mpf-companyShippingAddressDiv",html:[s,r]});return q},_createBillingAddressContent:function(){var o;var s;var q;var p;var r;o=this.addresses.filter(function(t){return t.isBillTo()});s=j.createElement("div",{"class":"mpf-companyAddressesLabel",html:h.get("billingAddress")});p=j.createElement("div",{"class":"mpf-companyAddressLink",text:h.get("manageAddresses"),events:{click:this.addressBookBilling.show.bind(this.addressBookBilling)}});this.billingAddressLabel=j.createElement("div",{"class":"mpf-companyAddressDisplay",html:this._pickAddressString({addresses:o,type:"Billing"})});q=j.createElement("div",{"class":"mpf-companyAddressDisplayDiv",html:[this.billingAddressLabel,p]});r=j.createElement("div",{"class":"mpf-companyBillingAddressDiv",html:[s,q]});return r},_getBillingAddressBook:function(){return new n({addressFactory:this.addressFactory,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory,className:"mpf-billingAddressBook",companyFactory:this.companyFactory,buyer:this.company,buyerTypeLocked:true,countryReadOnly:true,showSelectButton:false,model:this.addresses,preSetCountry:this.company.getCountry(),isBillingAddress:true,countries:this.countries})},_getShippingAddressBook:function(){return new n({addressFactory:this.addressFactory,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory,className:"mpf-shippingAddressBook",companyFactory:this.companyFactory,buyer:this.company,buyerTypeLocked:true,countryReadOnly:false,showSelectButton:false,model:this.addresses,isBillingAddress:false,countries:this.countries})},_checkPrototypes:function(o){k.requiredOfPrototype(this.model,a,"this.model must be a CompanyModel");k.requiredOfPrototype(o.addressFactory,g,"options.addressFactory must be an AddressFactory");k.requiredOfPrototype(o.addresses,d,"options.addresses must be an AddressCollection");k.requiredOfPrototype(o.cartFactory,m,"options.cartFactory must be a CartFactory");k.requiredOfPrototype(o.cartItemFactory,i,"options.cartItemFactory must be a CartItemFactory");k.requiredOfPrototype(o.countries,f,"options.countries must be a CountryCollection")},destroy:function(){this.model=null;this._parent();this.container=null}});return e});define("DS/MPFCompanyComponent/CompanyTaxRegistrationIdInput",["UWA/Core","DS/MPFView/FieldTextInputV2","DS/MPFCompanyModel/CompanyModel","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(b,f,e,d,c){var a=f.extend({className:"mpf-entry-v2 mpf-tax-registration-id",setup:function(g){g.fieldName=e.Fields.TAX_REGISTRATION_ID;g.fieldLabel=c.get(e.Fields.TAX_REGISTRATION_ID);g.dynamicValidation=true;this._parent(g)},getTaxRegistrationId:function(){return this.getValue()},destroy:function(){this.model=null;this._parent();this.container=null}});return a});define("DS/MPFCompanyComponent/CompanyNameInput",["UWA/Core","DS/MPFView/FieldTextInputV2","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(f,e,a,d,b){var c=e.extend({className:"mpf-company-name-input mpf-entry-v2",setup:function(g){g||(g={});a.requiredOfPrototype(this.model,d,"this.model must be a CompanyModel");g.fieldName=d.Fields.NAME;g.fieldLabel=b.get("companyName");this._parent(g)},focus:function(){this.input.focus()}});return c});define("DS/MPFCompanyComponent/CompanyCeoInputs",["UWA/Core","UWA/Class/View","DS/MPFView/FieldTextInputV2","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(g,f,e,b,d,c){var a=f.extend({className:"mpf-ceo-entries",setup:function(h){h||(h={});b.requiredOfPrototype(this.model,d,"this.model must be a CompanyModel");this.required=h.required===true;this.readOnly=h.readOnly===true;this.dynamicValidation=h.dynamicValidation===true;this.ceoFirstName=new e({model:this.model,fieldName:d.Fields.CEO_FIRST_NAME,fieldLabel:c.get("ceoFirstName"),required:this.required,readOnly:this.readOnly,dynamicValidation:this.dynamicValidation});this.ceoLastName=new e({model:this.model,fieldName:d.Fields.CEO_LAST_NAME,fieldLabel:c.get("ceoLastName"),required:this.required,readOnly:this.readOnly,dynamicValidation:this.dynamicValidation})},render:function(){this.container.setContent([this.ceoFirstName.render(),this.ceoLastName.render()]);return this},validate:function(){var h;var i;h=this.ceoFirstName.validate().isValid;i=this.ceoLastName.validate().isValid;return h&&i}});return a});define("DS/MPFCompanyComponent/CompanyComponent",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Text"],function(b,d,a){var c=d.extend({setup:function(e){this._parent(e)},render:function(){this.container.setContent([]);return this},destroy:function(){this.model=null;this._parent();this.container=null}});return c});define("DS/MPFCompanyComponent/CompanyCeoForm",["UWA/Core","DS/MPFView/MPFView","DS/MPFView/FieldTextInput","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(a,d,c,b){var e=d.extend({tagName:"form",domEvents:{change:"onChange"},setup:function(f){this._parent(f);this.required=f.required===true;this.readOnly=f.readOnly===true;this.dynamicValidation=f.dynamicValidation===true;this.ceoFirstName=new c({model:this.model,fieldName:"ceoFirstName",fieldLabel:b.get("ceoFirstName"),required:this.required,readOnly:this.readOnly,dynamicValidation:this.dynamicValidation});this.ceoLastName=new c({model:this.model,fieldName:"ceoLastName",fieldLabel:b.get("ceoLastName"),required:this.required,readOnly:this.readOnly,dynamicValidation:this.dynamicValidation})},onChange:function(f){if(f.target.required){this._validateInput(f.target)}},render:function(){this.container.setContent([this.ceoFirstName.render(),this.ceoLastName.render()]);return this},validate:function(){var h=this;var g;var f;this.container.getElements(".mpf-entry input").forEach(function(i){h._validateInput(i)},{});g=this._getErrorMessages(this.model.omit());f=a.is(g,"array")&&g.length>0;return !(f)},_validateInput:function(f){var i=f.getParent();var h=this._getErrorMessages(this.model.omit());var g;f.removeClassName("mpf-invalidField");g=i.getElement("p");if(g!==null){i.removeChild(g)}if(h){h.filter(function(j){if(j===f.name){f.addClassName("mpf-invalidField");a.createElement("p",{"class":"mpf-inputError",text:b.get(j+"Error")}).inject(i)}})}},_getErrorMessages:function(f){var g=[];if((typeof f.ceoFirstName!=="string")||(f.ceoFirstName.length===0)){g.push("ceoFirstName")}if((typeof f.ceoLastName!=="string")||(f.ceoLastName.length===0)){g.push("ceoLastName")}if(g.length>0){return g}},destroy:function(){this.model=null;this._parent();this.container=null}});return e});define("DS/MPFCompanyComponent/CompanyRegistrationIdInput",["UWA/Core","DS/MPFView/FieldTextInputV2","DS/MPFCompanyModel/CompanyModel","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFUI/MPFUI"],function(b,f,e,d,c){var a=f.extend({className:"mpf-entry-v2 mpf-registration-id",setup:function(g){g.fieldName=e.Fields.REGISTRATION_ID;g.fieldLabel||(g.fieldLabel=c.get(e.Fields.REGISTRATION_ID));g.dynamicValidation=true;this._parent(g)},getRegistrationId:function(){return this.getValue()}});return a});define("DS/MPFCompanyComponent/CompanyPmpInformationWidget",["UWA/Class","DS/UIKIT/Spinner","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactories","DS/MPFCompanyModel/CompanyHelper","DS/MPFCompanyComponent/CompanyPmpInformationComponent"],function(b,e,a,g,d,f){var c=b.extend({init:function(h){this.widget=h;document.body.style.backgroundColor="#f9f9f9"},load:function(){var k=this;var j;var i;var h;this.widget.body.addClassName("mpf-page");new e().inject(this.widget.body).show();a.fetchPromise().then(function(l){try{g.init(l)}catch(m){console.warn(m)}j=g.getFactory(g.types.person);i=g.getFactory(g.types.company);h=j.createModel("me");return h.fetchPromise()}).then(function(m){var l;l=d.getCompanyFromPerson(m,i);if(l){return l.fetchPromise()}else{l=i.createModel("me");return l}}).then(function(m){var l;l=new f({model:m});k.widget.setBody(l.render())})["catch"](function(){k.widget.setBody("Unable to start widget. Please reload the page.")})}});return c});define("DS/MPFCompanyComponent/CompanyShopForm",["UWA/Promise","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","DS/MPFCompanyComponent/CompanyNameInput","DS/MPFCompanyComponent/CompanyCeoInputs"],function(d,g,c,f,e,a){var b=g.extend({className:"mpf-company-inputs",domEvents:{'change input[name="name"]':"_onCompanyChange",'change input[name*="ceo"]':"_onCompanyChange"},setup:function(h){h||(h={});c.requiredOfPrototype(this.model,f,"this.model must be a CompanyModel");this.readOnly=h.readOnly;this.companyNameInput=new e({model:this.model,readOnly:this.readOnly===true,required:true,maxlength:120,dynamicValidation:true});this.companyCeoInputs=new a({model:this.model,readOnly:this.readOnly===true,required:true,dynamicValidation:true});this.companyHasChanged=false},render:function(){this.container.setContent([this.companyNameInput.render(),this.companyCeoInputs.render()]);return this},validate:function(){var j;if(this.model.addresses&&this.model.addresses[0]){j=this.model.addresses[0].getCountry()}var h=this.companyNameInput.validate(j).isValid;var i=this.companyCeoInputs.validate(j);return h&&i},save:function(){var h={};if(this.validate()){if(this.model.isNew()){this.model.unset(f.Fields.TAX_REGISTRATION_ID);this.model.unset(f.Fields.REGISTRATION_ID);return this.model.savePromise()}else{if(this.companyHasChanged){h[f.Fields.NAME]=this.model.getName();h[f.Fields.CEO_FIRST_NAME]=this.model.getCeoFirstName();h[f.Fields.CEO_LAST_NAME]=this.model.getCeoLastName();return this.model.savePromise(h,{patch:true})}else{return d.resolve()}}}else{return d.reject("Company validation failed")}},focus:function(){this.companyNameInput.focus()},_onCompanyChange:function(){this.companyHasChanged=true},destroy:function(){this.model=null;this._parent();this.container=null}});return b});define("DS/MPFCompanyComponent/CompanyForm",["UWA/Core","UWA/Promise","DS/MPFView/MPFView","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","DS/MPFCountryModel/CountryCollection","DS/MPFView/FieldSelectInputV2","DS/MPFCompanyComponent/CompanyNameInput","DS/MPFCompanyComponent/CompanyRegistrationIdInput","DS/MPFCompanyComponent/CompanyTaxRegistrationIdInput","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(j,h,e,i,b,g,d,c,a,k,l){var f=e.extend({setup:function(m){m||(m={});i.requiredOfPrototype(this.model,b,"this.model must be a CompanyModel");i.requiredOfPrototype(m.countries,g,"options.countries must be a CountryCollection");this._parent(m);this.countries=m.countries;this.companyNameInput=this._createCompanyName();this.countrySelect=this._createCountrySelect();this.taxRegistrationIdInput=this._createTaxRegistrationID();this.registrationIdInput=this._createCompanyRegistrationID()},render:function(){var n;var m=[];m.push(this.companyNameInput.render());m.push(this.countrySelect.render());m.push(this.taxRegistrationIdInput.render());m.push(this.registrationIdInput.render());n=j.createElement("form",{"class":"mpf-form",html:m});this.container.setContent(n);return this},save:function(){var n={};var m=null;if(this.validate()){if(!this.model.isNew()){m=this.model.getPendingChanges();n.patch=true;if(m.taxRegistrationId){m.taxId=m.taxRegistrationId;delete m.taxRegistrationId}}if(this.model.isNew()||Object.keys(m).length!==0){return this.model.savePromise(m,n)}else{return h.resolve()}}else{return h.reject("Company validation failed")}},validate:function(){this.container.getElement("form").addClassName("validated");var p=this.companyNameInput.validate().isValid;var n=this.countrySelect.validate().isValid;var m=this.taxRegistrationIdInput.validate().isValid;var o=this.registrationIdInput.validate().isValid;return p&&n&&m&&o},_createCompanyName:function(){return new c({model:this.model,dynamicValidation:true,readOnly:!this.model.isNew(),required:true})},_createCountrySelect:function(){return new d({model:this.model,required:true,dynamicValidation:true,silent:false,fieldName:b.Fields.COUNTRY,fieldLabel:l.get("country"),readOnly:!this.model.isNew()&&j.is(this.model.getCountry()),placeholder:l.get("selectCountry"),selectableOptions:this._getCountriesOptions()})},_createTaxRegistrationID:function(){return new k({model:this.model,required:true,readOnly:false,dynamicValidation:true})},_createCompanyRegistrationID:function(){return new a({model:this.model,readOnly:false,required:false,dynamicValidation:true})},_getCountriesOptions:function(){var n=this;var m=[];this.countries.forEach(function(p){var o={value:p.getIso3(),label:p.getName()};o.selected=n.model.has(b.Fields.COUNTRY)&&n.model.getCountry()!==""&&p.getIso3()===n.model.getCountry();m.push(o)});return m},destroy:function(){this.model=null;this._parent();this.container=null}});return f});define("DS/MPFCompanyComponent/CompanyAddressesWidget",["UWA/Core","UWA/Class","UWA/Promise","DS/UIKIT/Alert","DS/MPFUrl/UrlUtils","DS/PlatformAPI/PlatformAPI","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFCompanyComponent/CompanyAddressesComponent_New","DS/MPFMenuComponent/StepNavigationButtonsComponent","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(i,b,j,a,c,k,d,l,f,h,g){var e=b.extend({init:function(m){var n=this;this.container=m.container;this.displayBack=m.displayBack;this.displayFinish=m.displayFinish;this.displayNext=m.displayNext;this.topic=m.topic;d.fetchPromise().then(this._getFactories.bind(this)).then(this._fetchMeAndCountries.bind(this)).then(this._fetchCompany.bind(this)).then(function(){var o;n.isUserAnAdmin=n.me.isAdminOfThisEMP(n.company.getEmpProjectName());if(n.isUserAnAdmin){n.companyAddressesComponent=n._getCompanyAddressesComponent();n.stepNavigationComponent=n._getStepNavigationComponent();o=(new c(window.location.href)).getPath();if(o.indexOf("/my-company/addresses")!==-1){n.onShow()}}else{n.container.setStyle("height","5em");new a({className:"error",messageClassName:"error",messages:g.get("unauthorizedMessage"),closable:true,visible:true,autoHide:true,hideDelay:5000,closeOnClick:true}).inject(n.container,"top")}})},onShow:function(){if(this.isUserAnAdmin){k.publish(this.topic,{event:"titleSet",id:"addresses",title:this.company.getName()});k.publish(this.topic,{event:"activateMenuItem",id:"addresses"});this.container.setContent([this.companyAddressesComponent.render(),this.stepNavigationComponent.render()])}},_getFactories:function(m){var n=this;this.factories=l.getInstance(m);return j.all([this.factories.getFactory(l.Types.PERSON),this.factories.getFactory(l.Types.COUNTRY),this.factories.getFactory(l.Types.ADDRESS),this.factories.getFactory(l.Types.COMPANY),this.factories.getFactory(l.Types.CART),this.factories.getFactory(l.Types.CART_ITEM)]).then(function(o){n.personFactory=o[0];n.countryFactory=o[1];n.addressFactory=o[2];n.companyFactory=o[3];n.cartFactory=o[4];n.cartItemFactory=o[5];n.companyFactory.addressFactory=n.addressFactory;return j.resolve()})},_fetchMeAndCountries:function(){this.me=this.personFactory.createModel("me");this.countries=this.countryFactory.createCollection("buyer");return j.all([this.countries.fetchPromise(),this.me.fetchPromise()])},_fetchCompany:function(){var m;m=this.me.getCompanyId();this.company=this.companyFactory.createModel("company",{id:m});return this.company.fetchPromise()},_getCompanyAddressesComponent:function(){return new f({addressFactory:this.addressFactory,addresses:this.company.addresses,cartFactory:this.cartFactory,cartItemFactory:this.cartItemFactory,countryCollection:this.countryCollection,displayBack:this.displayBack,displayFinish:this.displayFinish,displayNext:this.displayNext,model:this.company,topic:this.topic,countries:this.countries})},_getStepNavigationComponent:function(){return new h({checkSave:false,displayBack:this.displayBack,displayFinish:this.displayFinish,displayNext:this.displayNext,stepName:"addresses",topic:this.topic,container:i.createElement("div",{"class":"mpf-companyFooterContainer"})})}});return e});define("DS/MPFCompanyComponent/CompanyIdsForm",["UWA/Core","UWA/Class/View","DS/MPFCompanyComponent/CompanyRegistrationIdInput","DS/MPFCompanyComponent/CompanyTaxRegistrationIdInput","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(c,f,b,a,d){var e=f.extend({setup:function(g){this._parent(g);this.registrationId=new b({model:this.model});this.taxRegistrationId=new a({model:this.model})},render:function(){this.container.setContent([this.registrationId.render(),this.taxRegistrationId.render()]);return this},destroy:function(){this.model=null;this._parent();this.container=null},save:function(){var j=this;var g;var i;var h;g=this.container.getElements("input");i=g.reduce(function(k,l){k[l.name]=l.value.trim();return k},{});if(this.model.set(i)){h=this.model.validate(this.model.toJSON());if(h&&(h.length>0)){}else{this.model.save(null,{onComplete:function(){j.saveButton.load(false)},onFailure:function(){j._addErrorMessage(d.get("saveFailure"));j.saveButton.load(false);this._setFieldsEnabled(true)}})}}}});return e});define("DS/MPFCompanyComponent/CompanyInformationComponent_New",["UWA/Core","UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/MPFCompanyComponent/CompanyNameInput","DS/MPFCompanyComponent/CompanyTaxRegistrationIdInput","DS/MPFCompanyComponent/CompanyRegistrationIdInput","DS/MPFCountrySelectComponent/CountrySelectComponent","DS/MPFView/FieldTextInputV2","DS/MPFServices/ObjectService","DS/MPFCompanyModel/CompanyModel","DS/MPFCountryModel/CountryCollection","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent","css!DS/MPFCompanyComponent/MPFCompanyComponent"],function(j,e,k,f,l,b,m,d,i,a,g,h){var c=e.extend({className:"mpf-emp-company mpf-horizontal",setup:function(n){n||(n={});i.requiredOfPrototype(this.model,a,"this.model must be a CompanyModel");i.requiredOfPrototype(n.countryCollection,g,"options.countryCollection must be a CountryCollection");this.countryCollection=n.countryCollection;this.displayBack=n.displayBack;this.displayFinish=n.displayFinish;this.displayNext=n.displayNext;this.topic=n.topic;this._parent(n);this.companyNameInput=this._createCompanyName();this.countrySelect=this._createCountrySelect();this.taxRegistrationInput=this._createTaxRegistrationID();this.companyRegistrationInput=this._createCompanyRegistrationID();this.enterpriseMarketplaceLabelInput=this._createESName();k.subscribe(this.topic,this._handleReceivedMessage.bind(this));if(this._isCompanyComplete()){k.publish(this.topic,{complete:true,event:"updateMenu",id:"information"})}},render:function(){var n;n=j.createElement("div",{"class":"mpf-companyMessage",html:h.get("compassMessage")});this.container.setContent([this.companyNameInput.render(),this.countrySelect.render(),this.taxRegistrationInput.render(),this.companyRegistrationInput.render(),this.enterpriseMarketplaceLabelInput.render(),n]);return this},save:function(o){var n=null;if(!this.model.isNew()){n=this.model.getPendingChanges();o.patch=true;if(n.taxRegistrationId){n.taxId=n.taxRegistrationId;delete n.taxRegistrationId}}if(this.model.isNew()||Object.keys(n).length!==0){return this.model.savePromise(n,o).then(this._onCompanySaved.bind(this,n,o))["catch"](function(){k.publish("PostCompanyFailureRefreshBtn",{refreshBtnFooter:true})})}else{return this._onCompanySaved(n,o)}},validate:function(){var o=this.companyNameInput.validate();var s=this.taxRegistrationInput.validate().isValid;var q=this.companyRegistrationInput.validate().isValid;var n=true;var r=this.enterpriseMarketplaceLabelInput.validate().isValid;var p;if(this.countrySelect.select.elements.input.value===""){this.countrySelect.render({invalid:true});n=false}else{this.countrySelect.render()}p=o&&s&&q&&r&&n;return p},_onCompanySaved:function(n,o,p){this.countrySelect.readOnly=true;this.countrySelect.render();if(n.PrivateMPName){k.publish("EMNameChange",{id:this.model.getId(),name:n.PrivateMPName})}k.publish(this.topic,{event:"saveComplete",id:"information",next:o.next})},_handleReceivedMessage:function(n){if(n.event==="save"&&n.target==="information"){if(this.validate()){this.save({next:n.next})}else{k.publish(this.topic,{event:"validationFailure",id:"information"})}}},_isCompanyComplete:function(){return this.model.getId()&&this.model.getEmpName()&&this.model.getRegistrationId()&&this.model.getTaxRegistrationId()},_createCompanyName:function(){return new f({dynamicValidation:false,model:this.model,readOnly:!this.model.isNew(),required:true})},_createCountrySelect:function(){return new m({countries:this.countryCollection,model:this.model,readOnly:this.model.has("country")&&this.model.getCountry()!=="",required:true})},_createTaxRegistrationID:function(){return new l({model:this.model,readOnly:false,required:true})},_createCompanyRegistrationID:function(){return new b({model:this.model,readOnly:false,required:true})},_createESName:function(){return new d({className:"mpf-entry-v2 mpf-emp-name",fieldLabel:h.get("enterpriseMarketName"),fieldName:"PrivateMPName",fieldPrefix:false,model:this.model,required:true,readOnly:false,dynamicValidation:true})},destroy:function(){this.model=null;this._parent();this.container=null}});return c});define("DS/MPFCompanyComponent/CompanyInformationWidget",["UWA/Core","UWA/Class","UWA/Promise","DS/UIKIT/Alert","DS/PlatformAPI/PlatformAPI","DS/UWPClientCode/Navigation","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFUrl/UrlUtils","DS/MPFCompanyComponent/CompanyInformationComponent_New","DS/MPFMenuComponent/StepNavigationButtonsComponent","i18n!DS/MPFCompanyComponent/assets/nls/CompanyComponent"],function(i,d,j,b,k,a,f,m,e,c,h,g){var l=d.extend({init:function(n){var p=this;var o;var q;this.container=n.container;this.displayBack=n.displayBack;this.displayFinish=n.displayFinish;this.displayNext=n.displayNext;this.topic=n.topic;f.fetchPromise().then(this._getFactories.bind(this)).then(this._fetchUserAndCountries.bind(this)).then(this._fetchCompany.bind(this)).then(function(){p.isUserAnAdmin=p.me.isAdminOfThisEMP(p.company.getEmpProjectName());if(p.isUserAnAdmin){p.companyInfoComponent=p._createCompanyInfoComponent();p.buttonsComponent=p._createStepNavigationComponent();k.subscribe("PostCompanyFailureRefreshBtn",p._onSaveErrorCompany.bind(p));q=(new e(window.location.href)).getPath();if(q.indexOf("/my-company/information")!==-1||q.indexOf("/my-company")!==-1){p.onShow()}}else{o=(new e(window.location.href)).getValueParameter("esid");a.routeTo(i.is(o)?"/welcome?esid="+o:"/welcome")}})},onShow:function(){if(this.isUserAnAdmin){k.publish(this.topic,{event:"titleSet",id:"information",title:this.company.getName()});k.publish(this.topic,{event:"activateMenuItem",id:"information"});this.container.setContent([this.companyInfoComponent.render(),this.buttonsComponent.render()])}},_getFactories:function(n){var o=this;this.factories=m.getInstance(n);return j.all([this.factories.getFactory(m.Types.PERSON),this.factories.getFactory(m.Types.COUNTRY),this.factories.getFactory(m.Types.COMPANY)]).then(function(p){o.personFactory=p[0];o.countryFactory=p[1];o.companyFactory=p[2]})},_fetchUserAndCountries:function(){this.me=this.personFactory.createModel("me");this.countryCollection=this.countryFactory.createCollection();return j.all([this.me.fetchPromise(),this.countryCollection.fetchPromise()])},_fetchCompany:function(){var n;n=this.me.getCompanyId();this.company=this.companyFactory.createModel("company",{id:n});return this.company.fetchPromise()},_createCompanyInfoComponent:function(){return new c({countryCollection:this.countryCollection,model:this.company,topic:this.topic})},_createStepNavigationComponent:function(){return new h({checkSave:true,displayBack:this.displayBack,displayFinish:this.displayFinish,displayNext:this.displayNext,stepName:"information",topic:this.topic,container:i.createElement("div",{"class":"mpf-companyFooterContainer"})})},_onSaveErrorCompany:function(o){var n;var p;n=document.body.querySelector(".mpf-companyHeaderContainer");p=new b({closable:true,visible:true,autoHide:true,hideDelay:5000,closeOnClick:true,messageClassName:"error",messages:g.anErrorOccured});p.inject(i.is(n)?n:document.body);this.buttonsComponent.render()}});return l});