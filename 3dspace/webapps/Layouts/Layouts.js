define("DS/Layouts/GridEngineCellAbstract",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Dom","UWA/Utils"],function(e,d,a,b){var c=d.extend({defaultOptions:{gridEngine:null,parent:null,width:100,height:28,useTranslate3d:false},init:function(f){this._parent(f);this._uxid=b.getUUID();this._buildView();this._virtualRowID=-1;this._virtualColumnID=-1;this._dataToBeTransferred={};this._cachedCellInfos=null},_clean:function(){},_free:function(){},getGridEngine:function(){return this.options.gridEngine},getCellInfos:function(){if(!this._cachedCellInfos){var f=this.getVirtualCoordinates();this._cachedCellInfos={virtualRowID:f.virtualRowID,virtualColumnID:f.virtualColumnID,virtualCellID:f.virtualCellID,cellModel:this.getGridEngine().getCellModel(f.virtualRowID,f.virtualColumnID),cellView:this,manager:this.getGridEngine(),isHeader:f.virtualRowID===-1||f.virtualColumnID===-1}}return this._cachedCellInfos},isHeader:function(){var f=this.getVirtualCoordinates();return f.virtualRowID===-1||f.virtualColumnID===-1},_setReusableContent:function(f){this._disposeReusableContent();this._reusableContent=f;this.getContent().setContent((this._reusableContent.getContent&&this._reusableContent.getContent())||this._reusableContent)},_disposeReusableContent:function(){if(this._reusableContent){this._reusableContent.__disposable__.dispose();this._reusableContent=undefined}},reuseCellContent:function(f){return this.getGridEngine()._reuseCellContent(f,this)},getParent:function(){return this.options.parent},getPosition:function(){var g=this.getVirtualCoordinates();var f={top:g.virtualRowID*this.getGridEngine()._getCellHeight(),left:g.virtualColumnID*this.getGridEngine()._getCellWidth()};if(f.top<0){f.top=0}if(f.left<0){f.left=0}return f},destroy:function(){this._disposeReusableContent();this._cachedCellInfos=null;this._parent()},placeCell:function(f){if(f===undefined){f=this.getPosition()}this.elements.container.style.left=f.left+"px";this.elements.container.style.top=f.top+"px"},_setVirtualCoordinates:function(f){this._cachedCellInfos=null;this._virtualRowID=f.virtualRowID;this._virtualColumnID=f.virtualColumnID;if(f.rowID!==undefined){this.elements.container.setAttribute("row-id",f.rowID)}if(f.columnID!==undefined){this.elements.container.setAttribute("column-id",f.columnID)}this.elements.container.setAttribute("virtual-row-id",this._virtualRowID);this.elements.container.setAttribute("virtual-column-id",this._virtualColumnID);a.setStyles(this.getContent(),{width:this._virtualColumnID>-1?this.getGridEngine().options.defaultCellWidth:this.getGridEngine().getHeadersDimensions().width,height:this._virtualRowID>-1?this.getGridEngine().options.defaultCellHeight:this.getGridEngine().getHeadersDimensions().height})},_requestCell:function(){this.getGridEngine()._isRequestingCell=true;var f=this.getCellInfos();if(f.cellModel){if(!f.isHeader){if(this.getGridEngine()._onRequestCellCB){this.getGridEngine()._onRequestCellCB.call(this,f)}}else{if(f.virtualRowID===-1){if(this.getGridEngine()._onRequestColumnHeaderCB){this.getGridEngine()._onRequestColumnHeaderCB.call(this,f)}}else{if(this.getGridEngine()._onRequestRowHeaderCB){this.getGridEngine()._onRequestRowHeaderCB.call(this,f)}}}}this.getGridEngine()._isRequestingCell=false},updateInternalParameters:function(){if(this.getGridEngine().options.performances.debounceCellRequest){this._requestCell()}},isFiltered:function(){return this._isFiltered},getVirtualCoordinates:function(){return{virtualRowID:this._virtualRowID,virtualColumnID:this._virtualColumnID,virtualCellID:this._virtualRowID*this.getGridEngine()._numberOfColumns+this._virtualColumnID}},_buildView:function(){this.elements.container=e.createElement("div",{"class":"wux-datagrid-cell "+(this.options.isHeader?"wux-font-3dsregular":""),styles:{lineHeight:this.options.height+"px",width:this.options.width,height:this.options.height}});this.elements.container.dsView=this},getDimensions:function(){var f=this.getGridEngine().options.cellSpacing;return{width:this.options.width+f.horizontal,height:this.options.height+f.vertical}},hide:function(){if(!this._isHidden){this._isHidden=true;this.elements.container.style.display="none"}},show:function(f){if(this._isHidden||f){this._isHidden=false;this.elements.container.style.display="block"}},isHidden:function(){return this._isHidden}});return c});define("DS/Layouts/TreeNavigationNodeAbstract",["UWA/Core","DS/Controls/TreeNodeBase","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(d,b,a,c){});define("DS/Layouts/SlidingViews",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/UIBehaviors/Kinetic","DS/Core/PointerEvents","DS/Utilities/Dom"],function(e,l,b,j,h,d,c,f,g,a){window._flagFrameIsLoaded=[];var m=function(n){if(n.indexOf("http://")===0||n.indexOf("https://")===0){return n}else{return d.getWebappsBaseUrl()+n}};var i="CHANGE";var k=h.extend({defaultOptions:{kinetic:true,orientation:"horizontal",showPager:true,views:[],viewsBar:null,activateViewOn:null,viewsWidth:"100%",translateFactor:100,effectDuration:"0.2s",pageBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-page-content",styles:{overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}})},selectedViewsIndicatorBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-views-item-selection wux-font-arial-regular"})},viewsIndicatorBuilder:function(n){return new e.Element("div",{"class":"wux-layouts-slidingviews-views-item",html:n.label,})},pagerTarget:null,prevPage:null,nextPage:null,},init:function(n){this._parent(n);this._modelEvents=new c();this._selectedContentIndex=-1;this._views=[];this._buildLayout();this._buildviews();if(this.options.kinetic){this._bindKinetic()}var o=this;a.onNodeRendered(o.elements.selection,function(){o.goToNthView(0)})},_buildLayout:function(){this.elements.container=new e.Element("div",{"class":"wux-layouts-slidingviews"});this.elements.views=new e.Element("div",{"class":"wux-layouts-slidingviews-views",styles:{height:"auto",borderTop:"none",textAlign:"center",padding:"5px 10px",position:"relative",display:this.options.showPager?"block":"none"}}).inject(this.elements.container);this.elements.viewsContainer=new e.Element("div",{styles:{position:"relative",display:"inline-block"}}).inject(this.elements.views);this.elements.contentView=new e.Element("div",{"class":"wux-layouts-slidingviews-content-view",styles:{height:"inherit"}}).inject(this.elements.container);this.elements.contentViewContainer=new e.Element("ul",{"class":"wux-layouts-slidingviews-content-view-container wux-ui-stack-h",styles:{position:"relative",height:100+"%"}}).inject(this.elements.contentView);this.elements.contentViewContainer.setStyles({transition:"all "+this.options.effectDuration+" ease-in-out"})},_buildviews:function(){var n=this;this._lastSelectedContentIndex=null;this._selectedContentIndex=0;this.elements.selection=n.options.selectedViewsIndicatorBuilder({});if(this.options.pagerTarget){this.elements.selection.inject(n.options.pagerTarget)}else{this.elements.selection.inject(n.elements.viewsContainer)}this.elements.viewsItems=[];this.options.views.forEach(function(p,o){n.addView(p,o)})},_bindKinetic:function(){this._kin=new f({target:this.elements.contentViewContainer,scrollX:true,scrollY:false,range:{xMin:0,xMax:(this._views.length-1)*100,yMin:0,yMax:0,},duration:100,viscosity:500});var n=this;this._kin.onRelease(function(){n.goToNthView(this.getFinalPositionPercent().x/100,undefined,true)})},addView:function(y,r){var w=this;if(r===undefined){r=w.elements.viewsItems.length}var x=w.options.viewsIndicatorBuilder({index:r+1,label:y.title||r});x.addEvent(g.POINTERUP,function(z){w.elements.contentViewContainer.setStyles({transition:"all "+w.options.effectDuration+" ease-in-out"});w.goToNthView(r)});w.elements.viewsItems.splice(r,0,x);if(this.options.pagerTarget){x.inject(w.options.pagerTarget)}else{x.inject(w.elements.viewsContainer)}var t,o;var s=y.content;if(typeof s.html==="string"){if(s.iframe){o=new e.Element("iframe",{allowfullscreen:"true",src:m(s.html),frameborder:0,onload:"window._flagFrameIsLoaded["+r+"]=true",styles:{width:"100%",position:"absolute",top:0,bottom:0,height:"100%",overflow:"auto","-webkit-overflow-scrolling":"touch"}});var n=0;var q=window.setInterval(function(){n++;if(n>20){window.clearInterval(q);if(y.contentError){o.src=m(y.contentError)}}},100)}else{o=new e.Element("div",{styles:{padding:10,overflowY:"auto",overflowX:"hidden",whiteSpace:"normal"}});var p="Ajax";if(d.getWebappsBaseUrl()!=="../"){p="Data"}e[p].request(s.html,{async:true,onComplete:function(z){o.setHTML(z);if(s.onLoad){s.onLoad(z)}}})}}else{o=y.content.html}if(!y.styles){y.styles={}}y.styles.verticalAlign="top";y.styles.width=this.options.viewsWidth;t=this.options.pageBuilder.call(this,r);if(o){t.setHTML(o)}var u=(y["class"]?y["class"]:"");var v=new e.Element("li",{html:t,"class":"wux-layouts-slidingviews-page "+u,styles:y.styles,});if(v.getContent){v.getContent().setHTML(t)}else{v.setHTML(t)}v.inject(w.elements.contentViewContainer);w._views.splice(r,0,t);return t},removeView:function(n){if(this.getViews().length>1){this.elements.viewsItems[n].destroy();this.elements.viewsItems.splice(n,1);if(this._views[n].destroy){this._views[n].destroy()}if(this._views[n]&&this._views[n].remove){this._views[n].remove()}this._views.splice(n,1);if(n===this._selectedContentIndex){this.goToNthView(Math.max(0,n-1))}}},getViews:function(){return this._views},getView:function(n){return this._views[n]},getCurrentViewID:function(){return this._selectedContentIndex===-1?0:this._selectedContentIndex},getCurrentView:function(){return this.getView(this.getCurrentViewID())},goToPreviousView:function(){return this.goToNthView(this.getCurrentViewID()-1)},goToNthView:function(n,q,t){var p=this;if(q===undefined){q=true}if(n>p.elements.viewsItems.length-1){n=p.elements.viewsItems.length-1}if(n<0){n=0}p._lastSelectedContentIndex=p._selectedContentIndex;p._selectedContentIndex=n;if(p._lastSelectedContentIndex!==null&&p.elements.viewsItems[p._lastSelectedContentIndex]){p.elements.viewsItems[p._lastSelectedContentIndex].removeClassName("wux-ui-state-active")}var o=p.elements.viewsItems[n];if(o){var s=(-n*this.options.translateFactor)+"%";p.elements.contentViewContainer.setStyles({transform:"translate3d("+s+", 0px, 0)"});if(!t&&this.options.kinetic){p._kin._registerPosition(s)}var r=0;r=o.getOffsets().x-parseInt(o.getStyle("paddingLeft"),10)/2;r=o.getPosition().x;p.elements.selection.setHTML(p.elements.viewsItems[n].getHTML());p.elements.selection.setStyles({position:"absolute",top:"auto",transform:"translate3d("+r+"px, "+0+"px, 0)",height:o.getDimensions().height,width:o.getDimensions().width});o.addClassName("wux-ui-state-active");if(q){this._modelEvents.publish({event:i,data:{viewID:n}})}}else{console.warn("Something gone wrong, try to reach view with index:",n)}return this.getView(n)},onViewChange:function(n){return this._modelEvents.subscribe({event:i,},n)}});return k});define("DS/Layouts/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/TreeNavigationNodeAbstract","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom"],function(h,g,f,d,e,c,b,a){});define("DS/Layouts/GridEngine",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/ModelEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Layouts/GridEngineCellAbstract","DS/Utilities/Data","DS/Core/ActionsStack","DS/Controls/Gauge","DS/Utilities/Debug","DS/Utilities/Utils","UWA/Utils/Client","UWA/Utils","UWA/Class","DS/Utilities/Array","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager"],function(e,n,j,l,L,F,o,I,w,i,f,y,x,h,b,D,t,g,a,p,K,A){var M="COLUMN_HEADER_CLICK";var N="EVT_CELL_CREATION";var k="EVT_CELL_DESTRUCTION";var m="POOL_UPDATE";var E=false;var v=false;var G=false;var z=false;var c=false;var r=0;var u=false;var s=0;var d=t.Engine;var J=(d.ie||d.chrome);var B=21474836;function H(T,X,Z){if(Z===undefined){Z=1}var U=X?T.currentTarget:(T.target||T.srcElement),P=U.currentStyle||window.getComputedStyle(U,null),Y=parseInt(P.borderLeftWidth,10),W=parseInt(P.borderTopWidth,10),V=U.getBoundingClientRect(),Q=T.changedTouches&&T.changedTouches.length?T.changedTouches[0].clientX:T.clientX,O=T.changedTouches&&T.changedTouches.length?T.changedTouches[0].clientY:T.clientY,S=Q*Z-Y-V.left,R=O*Z-W-V.top;return{offsetX:S,offsetY:R}}function C(Q,P){var O=Q;if(O){var R=(" "+O.className+" ").replace(/[\n\t]/g," ").indexOf(" "+P+" ")>-1;if(R){return O}else{return C(O.parentNode,P)}}else{}}var q=L.extend({defaultOptions:{model:null,parent:null,defaultCellMouseWidth:null,defaultCellMouseHeight:null,defaultCellTouchWidth:null,defaultCellTouchHeight:null,defaultCellWidth:100,defaultCellHeight:28,useDynamicCellSpacing:false,allowUnsafeHTMLContent:undefined,shouldCellAllowUnsafeHTMLContentAt:function(O){return O.manager.options.allowUnsafeHTMLContent},cellClass:f,showRowsHeader:false,showColumnsHeader:false,headersDimensions:{width:undefined,height:undefined},cellSpacing:{horizontal:0,vertical:0},height:400,infiniteScrolling:false,pageScrollValueTriggeringInfiniteScroll:undefined,virtualModelSize:null,numberOfColumns:null,deferredProcessingTimeout:100,useTransparentScroller:false,showScrollbarsOnHover:false,virtualView:true,performances:{renderingMode:"standard",renderingOptimization:0,preloadPool:false,enableColumnVirtualization:true,useRequestAnimationFrameRendering:false,use2PassRendering:false,resizeDebounceTimeout:100,numberOfRowsFactor:2,numberOfColumnsFactor:2,fullUpdateFactor:0.75,modelViewportFactor:0.5,minimumScrollDistance:0},debug:{minDurationBeforeNextRendering:0}},_applyTouchMode:function(O){this._isTouch=O;if(this._isTouch){if(this.options.defaultCellTouchWidth){this.options.defaultCellWidth=this.options.defaultCellTouchWidth}if(this.options.defaultCellTouchHeight){this.options.defaultCellHeight=this.options.defaultCellTouchHeight}}else{if(this.options.defaultCellMouseWidth){this.options.defaultCellWidth=this.options.defaultCellMouseWidth}if(this.options.defaultCellMouseHeight){this.options.defaultCellHeight=this.options.defaultCellMouseHeight}}if(this._isTouch){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}this.updateView(true)},_setUpdateViewOptions:function(O){if(this._updateViewOptions===undefined){this._updateViewOptions=this._updateViewDefaultOptions}this._updateViewOptions=e.merge(e.clone(this._updateViewDefaultOptions),this._updateViewOptions,O)},destroy:function(){this._freeUpPool(3);this._modelEvents.destroy();this._updateCellsContentDebounced=null;delete this._updateCellsContentDebounced;while(this.options.model.length>0){var S=this.options.model[this.options.model.length-1];while(S&&S.length>0){var O=S[S.length-1];if(O){if(O.destroy){O.destroy()}}S.pop()}this.options.model.pop()}p.clear(this.options.model);this.options=null;for(var R=0;R<this._listOfFreeCells.length;R++){this._listOfFreeCells[R].destroy()}for(var R=0;R<this._listOfFreeRowHeaders.length;R++){this._listOfFreeRowHeaders[R].destroy()}for(var R=0;R<this._listOfFreeColumnHeaders.length;R++){this._listOfFreeColumnHeaders[R].destroy()}p.clear(this._listOfFreeCells);p.clear(this._listOfFreeRowHeaders);p.clear(this._listOfFreeColumnHeaders);if(this.elements.container){var Q=this.elements.container;if(Q.__resizeListeners__){var P=Q.__resizeListeners__.length;for(var R=P-1;R>=0;R--){w.removeResizeListener(Q,Q.__resizeListeners__[R])}}}this._reusableCellContentManager.destroy();this._scrollerDimensions=null;this.removeMe();this._parent()},init:function(P){this._parent(P);var Q=this;this._name="GRIDENGINE";this._buildLayout();this.getContent().setAttribute("platform-name",t.Platform.name);this.__gridengineUUID=e.Utils.getUUID();if(!this.options.defaultCellMouseWidth){this.options.defaultCellMouseWidth=this.options.defaultCellWidth}if(!this.options.defaultCellMouseHeight){this.options.defaultCellMouseHeight=this.options.defaultCellHeight}if(!this.options.defaultCellTouchWidth){this.options.defaultCellTouchWidth=this.options.defaultCellWidth}if(!this.options.defaultCellTouchHeight){this.options.defaultCellTouchHeight=this.options.defaultCellHeight}this._isTouch=false;Object.defineProperty(this,"touchMode",{get:function O(){return Q._isTouch},set:function O(R){Q._applyTouchMode(R)}});this._debugPerformanceIssues=false;this._modelEvents=new o();this.__preventNextUpdateViewCounter=0;this._needToApplyCellContainerSizer=false;this._reusableCellContentManager=new A();this._listOfRenderedCells={};this._listOfFreeCells=[];this._listOfRenderedRowHeaders={};this._listOfFreeRowHeaders=[];this._listOfRenderedColumnHeaders={};this._listOfFreeColumnHeaders=[];this.__lastScrollPos={x:0,y:0};this._onModelRequestCB=null;this._onInfiniteScrollCB=null;this._deltaScrollPositionFromBeginning={x:0,y:0};this._onRequestRowHeaderCB=function(T){var R=T.virtualRowID;var S=R.toString();if(T.cellView.getContent){T.cellView.getContent().innerText=S}};this._onRequestColumnHeaderCB=function(T){var R=T.virtualColumnID;var S=R.toString();if(T.cellView.getContent){T.cellView.getContent().setText(S)}};this._onInternalRequestRowHeaderCB=function(R){if(this._headersDimension.width>0){this._isRequestingCell=true;if(this._onRequestRowHeaderCB){this._onRequestRowHeaderCB.call(Q,R)}if(R.cellView){var R=R.cellView.getCellInfos();R.cellView.nodeColor.inject(R.cellView.getContent());if(R.nodeModel&&R.nodeModel.options.color&&R.nodeModel.options.color!="initial"){R.cellView.nodeColor.style.background=R.nodeModel.options.color;R.cellView.nodeColor.style.display="";R.cellView.getContent().addClassName("wux-datagrid-cell-with-color")}else{R.cellView.nodeColor.style.display="none";R.cellView.getContent().removeClassName("wux-datagrid-cell-with-color")}}this._isRequestingCell=false}};this._onInternalRequestColumnHeaderCB=function(S){if(this._headersDimension.height>0){this._isRequestingCell=true;if(Q.options.showColumnsHeader&&Q._doesColumnNeedToBeRequested(S.virtualColumnID)){var R=S.cellView.getCellInfos();if(this._onRequestColumnHeaderCB){this._onRequestColumnHeaderCB.call(Q,R)}}this._isRequestingCell=false}};this._onInternalRequestCellCB=function(T){this._isRequestingCell=true;var R=Q.getModelSize();if(T.virtualRowID>=0&&T.virtualRowID<R.numberOfRows&&T.virtualColumnID>=0&&T.virtualColumnID<R.numberOfColumns){var S=T.cellView.getCellInfos();if(Q._onRequestCellCB){if(S.cellModel!==undefined){S.rowID=T.rowID;S.columnID=T.columnID;this._onRequestCellCB.call(Q,S);T.cellView.show(true)}if(Q._toDeferredProcessing){clearTimeout(Q._toDeferredProcessing)}Q._listOfCellFilters.process({actionParamsList:[{virtualRowID:T.virtualRowID,virtualColumnID:T.virtualColumnID,cellView:T.cellView,cellModel:Q.getCellModel(T.virtualRowID,T.virtualColumnID)}],chunckProcess:false})}}this._isRequestingCell=false};this._isMonoDimension=null;this.cellInfosCB=null;this._columnHeadersPool=[];this._updateCounter=0;this._renderOrder=0;this._poolDimensions={};this._numberOfRowsToRemove=0;this._numberOfColumnsToRemove=0;this._listOfCellsToBeUpdated={};this._updateViewDefaultOptions={generatePool:false,detachAllViews:true,updateCells:true,updateColumnsHeaders:true,onPreUpdate:null,onPostUpdate:null};this._updateViewOptions=this._updateViewDefaultOptions;this._listOfCellFilters=new x();this._virtualPos={virtualRowID:-1,virtualColumnID:-1};this._viewportBbox={minRowID:-1,minColumnID:-1,maxRowID:-1,maxColumnID:-1};this._modelSize={numberOfRows:0,numberOfColumns:0};this._poolContainerSize={};this._poolSize={numberOfRows:0,numberOfColumns:0};this._listenResize=true;if(this.options.model){this.loadModel(this.options.model,true)}this._observeEvents();this.removeMe=function(){Q=null}},_observeEvents:function(){var O=false;var P=this;this.onReady(function(){if(O===false){O=true;var Q={timeStamp:0,target:null,type:null};this.elements.container.addEvent(i.POINTERUP,function(U){if(U.originalEvent){var T={timeStamp:U.originalEvent.timeStamp,target:U.originalEvent.target,type:U.originalEvent.type};if(!(T.timeStamp===Q.timeStamp&&T.target===Q.target&&T.type==="mouseup"&&Q.type==="touchend")){Q={timeStamp:U.originalEvent.timeStamp,target:U.originalEvent.target,type:U.originalEvent.type};var S=C(U.target,"wux-datagrid-cell");if(U.which===1&&S&&S.dsView){var V=S.dsView.getCellInfos();var W=V.cellView.getVirtualCoordinates();var R=P.getCellModel(W.virtualRowID,W.virtualColumnID);if(R!==undefined){P._modelEvents.publish({event:"CLICK",context:R,data:V.cellView.getCellInfos()})}}}}});this.elements.container.addEvent(i.POINTERDOWN,function(S){var R=C(S.target,"wux-datagrid-cell");if(S.which===1&&R&&R.dsView){var T=R.dsView.getCellInfos();T.event=S;if(T.cellModel!==undefined){P._modelEvents.publish({event:"pointerDown",context:T.cellModel,data:T})}}})}})},registerReusableCellContent:function(O){this._reusableCellContentManager.register(O)},_reuseCellContent:function(O,P){var Q=this._reusableCellContentManager.use(O,P);P._setReusableContent(Q.component);return Q.component},_processModelRequest:function(P){var O=this;if(!O._isRequestingModelUpdate&&O._onModelRequestCB){O._isRequestingModelUpdate=true;setTimeout(function(){if(O._onModelRequestCBisAsync){O._modelEvents.subscribe({event:"modelRequestDone"},function(){if(P){O.initialize(true);O.updateView(true)}O._isRequestingModelUpdate=false})}var Q=O.getVirtualViewport();O._modelViewPort={minRowID:Math.max(0,Q.minRowID-O.getPoolNumberOfRows()*O.options.performances.modelViewportFactor),maxRowID:Math.ceil(Q.maxRowID+O.getPoolNumberOfRows()*O.options.performances.modelViewportFactor),minColumnID:Math.max(0,Q.minColumnID-O.getPoolNumberOfColumns()*O.options.performances.modelViewportFactor),maxColumnID:Math.ceil(Q.maxColumnID+O.getPoolNumberOfColumns()*O.options.performances.modelViewportFactor)};O._onModelRequestCB.call(O,{model:O.options.model,virtualRowID:Q.maxRowID,virtualColumnID:Q.maxColumnID,modelViewPort:O._modelViewPort});if(!O._onModelRequestCBisAsync){if(P){O.initialize(true);O.updateView(true)}O._isRequestingModelUpdate=false}},1)}},_computeModelSize:function(R){var Q=this;var O;var P;Q._checkIfMonoDimension();if(!Q._isMonoDimension){O=Q.options.model.length;P=Q.options.model[this._getModelMinRowID()]?Q.options.model[this._getModelMinRowID()].length:0}else{if(Q.options.numberOfColumns){P=Q.options.numberOfColumns}else{P=Math.floor(Q.getContent().getDimensions().width/Q._getCellWidth());if(Q.options.model.length>0&&Q.options.model.length<P){P=Q.options.model.length}}}if(Q.options.model.length>0&&P===0){P=1}Q._numberOfColumns=P;Q._modelSize.numberOfColumns=Q._numberOfColumns;if(Q._isMonoDimension){O=P!==0?Math.ceil(Q.options.model.length/P):0}if(Q.options.model.length>0&&O===0){O=1}Q._modelSize.numberOfRows=O;if(v){console.warn("[ ] - compute model size",O,"x",P)}if(this.options.virtualModelSize===null||R){Q.setCellsContainerSize({width:P*Q._getCellWidth(),height:O*Q._getCellHeight()},R)}else{Q.setCellsContainerSize({width:this.options.virtualModelSize.numberOfColumns*Q._getCellWidth(),height:this.options.virtualModelSize.numberOfRows*Q._getCellHeight()},R)}return{numberOfRows:O,numberOfColumns:P}},prepareUpdateView:function(){if(this._updateCounter===0&&this.elements.container){this._willBeUpdated()}this._updateCounter++;if(u){s++;console.group("view_transaction_"+s);console.log("-- prepare --")}},_willBeUpdated:function(){},_hasBeenUpdated:function(){this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:false}})},pushUpdateView:function(O){if(u){console.log("-- push --");console.groupEnd("Transaction_"+s)}this._updateCounter--;if(this._updateCounter===0){if(this.__preventNextUpdateViewCounter===0){this.updateView(O)}else{this.__preventNextUpdateViewCounter=0;this._hasBeenUpdated()}}if(this._updateCounter<0){console.warn("[WARNING]","You pushed too many updateView")}},lockUI:function(O){O=e.extend({changeOpacity:true},O);if(!this.__preventFFLockUIWhenScrollOnDragOver){this.getScroller().getContent().addClassName("wux-ui-locked")}this.getScroller().getContent().setAttribute("wux-opacity",O.changeOpacity)},unlockUI:function(){this.getScroller().getContent().removeClassName("wux-ui-locked");this.getScroller().getContent().removeAttribute("wux-opacity")},_preventNextUpdateView:function(){if(v){console.warn("[!] - Prevent next UpdateView")}this.__preventNextUpdateViewCounter=1},_unpreventNextUpdateView:function(){if(v){console.warn("[!] - UnPrevent next UpdateView")}this.__preventNextUpdateViewCounter=0},removeRow:function(O){this.prepareUpdateView();this.options.model.splice(O,1);this.pushUpdateView(true)},loadModel:function(O,T){var S=this;if(T===undefined){T=false}if(!T){this._destroyPool();if(!O){O=this.options.model}var R=O.length;if(R>=0){for(var Q=0;Q<R;Q++){var P=O[Q].length;if(P>=0){O[Q]=[]}}}this.options.model=[]}this.options.model=O;this._gridDimension={width:"100%",height:this.options.height};this._adjustLayout();this._computeModelSize();if(T){this._adjustLayout();this._computeModelSize();this._alreadyRendered=false;w.onNodeRendered(S.elements.container,function(){if(S._alreadyRendered===false){S._alreadyRendered=true;if(S.options.model.length){if(S.options.model.length&&(S.options.model[0]===undefined||(S.options.model[0]!==undefined&&!S.options.model[0].length))){S._isMonoDimension=true;S.elements.container.setAttribute("is-mono-dimensional","true")}else{S._isMonoDimension=false;S.elements.container.setAttribute("is-mono-dimensional","false")}}S._computeModelSize();if(S.options.performances.preloadPool===true){S.__preloadPool()}S.getViewportDimensions(true);S.initialize();if(S.options.useDynamicCellSpacing){S._computeDynamicCellSpacing()}S.runEngine();if(S.getScroller()){S._scrollerDimensions=S.getScroller().getContent().getDimensions()}S._heavyDataColumnModelRequest("onReady");S._onEndResizeOrOnReadyModelCompletionRequest("onReady");S._modelEvents.publish({event:"READY",context:S});var U=document.createEvent("Event");U.initEvent("dimensionsChanged",true,false);S.getContent().dispatchEvent(U)}else{S._computeModelSize();S.__cachedScrollPos={x:0,y:0};S.updateView(true)}});if(!S.options.manageHeight){w.addEndResizeListener(this.elements.container,S._endResizeCallback.bind(this),this.options.performances.resizeDebounceTimeout)}}},_endResizeCallback:function(){var P=this;if(P.getContent()){if(this._debugPerformanceIssues){console.log("["+P._name+"]:resize")}if(P.getScroller()){P._scrollerDimensions=P.getScroller().getContent().getDimensions()}P.getViewportDimensions(true);P._gridDimension={width:"100%",height:P.elements.container.getDimensions().height};if(P.options.useDynamicCellSpacing){P._computeDynamicCellSpacing()}P._adjustLayout();P._freeUpPool(2);P._computePoolSize();P._renderViewPort(true);P._onEndResizeOrOnReadyModelCompletionRequest("onResize");P._modelEvents.publish({event:"RESIZE",context:P,data:P.getContent().getDimensions()});var O=document.createEvent("Event");O.initEvent("dimensionsChanged",true,false);P.getContent().dispatchEvent(O)}},_heavyDataColumnModelRequest:function(X,O){var T=this;if(T._onHeavyDataColumnModelRequestCB){var V=[];var S=[];T.processPoolCells(function(Y){var Z=Y.cellView.getCellInfos();if(S.indexOf(Z.virtualRowID)===-1){V.push(Z.nodeModel);S.push(Z.virtualRowID)}});var R=this.getVirtualViewport(false);var W=R.minColumnID;var Q=R.maxColumnID;var P=(X=="showColumn")&&O&&O.columnID?O.columnID:undefined;if(P&&(P<W||P>Q)){return}var U={shownColumnID:P,minVisibleColumnID:W,maxVisibleColumnID:Q};if(V.length){T._onHeavyDataColumnModelRequestCB.call(T,{displayNodesArray:V,context:X,data:U})}}},_onEndResizeOrOnReadyModelCompletionRequest:function(S){var Q=this;if(Q._onEndResizeOrOnReadyModelRequestCB&&Q.options.infiniteScrolling){var P=Q.getViewportDimensions(true);var R=Math.floor((P.width-Q.options.cellSpacing.horizontal)/(Q.options.defaultCellWidth+Q.options.cellSpacing.horizontal));var O=Math.ceil((P.height-Q.options.cellSpacing.vertical)/(Q.options.defaultCellHeight+Q.options.cellSpacing.vertical));Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=true;setTimeout(function(){if(Q._onEndResizeOrOnReadyModelRequestCBisAsync){Q._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},function(){Q.initialize(true,true);Q.updateView(true);Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=false})}Q._onEndResizeOrOnReadyModelRequestCB.call(Q,{model:Q.options.model,RowMaxNumber:O,ColumnsMaxNumber:R,viewportDimensions:P,context:S});if(!Q._onEndResizeOrOnReadyModelRequestCBisAsync){Q.initialize(true);Q.updateView(true);Q._isRequestingEndResizeOrOnReadyGridViewModelUpdate=false}},1)}},_checkIfMonoDimension:function(){var P=this;if(this._isMonoDimension===null){var O=this.getVirtualViewport();if(P.options.model.length>0){if(P.options.model.length&&(P.options.model[O.minRowID]===undefined||(P.options.model[O.minRowID]!==undefined&&!P.options.model[O.minRowID].length))){P._isMonoDimension=true;P.elements.container.setAttribute("is-mono-dimensional","true")}else{P._isMonoDimension=false;P.elements.container.setAttribute("is-mono-dimensional","false")}}else{this._isMonoDimension=null}}if(v){console.warn("model is mono dimension",P._isMonoDimension)}},_adjustLayout:function(){var O=this;if(O.options.headersDimensions.width||O.options.headersDimensions.height){O._setHeadersDimensions({width:O.options.showRowsHeader?O.options.headersDimensions.width:0,height:O.options.showColumnsHeader?O.options.headersDimensions.height:0})}else{O._setHeadersDimensions({width:O.options.showRowsHeader?O._getCellWidth():0,height:O.options.showColumnsHeader?O._getCellHeight():0})}},onGridResize:function(O){return this._modelEvents.subscribe({event:"RESIZE"},O)},onReady:function(O){if(this._alreadyRendered){return O.call(this)}else{return this._modelEvents.subscribe({event:"READY"},O)}},onPerformanceAnalysisAvailbale:function(O){return this._modelEvents.subscribe({event:"performanceAnalysisAvailable"},O)},initialize:function(S,R){var Q=this;if(!R){Q.__cachedScrollPos={x:0,y:0};Q.__cachedScrollDistance=0}var O=Q.options.model.length;var P;if(Q.options.model[0]&&Q.options.model[0].length){P=Q.options.model[0].length}else{if(Q.options.numberOfColumns){P=Q._numberOfColumns}else{P=Math.floor(Q.getContent().getDimensions().width/Q._getCellWidth())}}this.updateModelSize({numberOfRows:O,numberOfColumns:P});if(!S){Q._generatePool();Q._setVirtualPosition({virtualRowID:0,virtualColumnID:0})}},_setVirtualPosition:function(P,O){e.extend(this._virtualPos,P);this._computeVirtualViewport(O)},_computeVirtualViewportFromScrollPosition:function(){var Q=this._getVirtualPositionFromScrollPosition();var R=this.getPoolNumberOfRows();var S=this.getPoolNumberOfColumns();Q.rowID=Q.rowID+Math.floor(R/this.options.performances.numberOfRowsFactor/2);Q.columnID=Q.columnID+Math.floor(S/this.options.performances.numberOfColumnsFactor/2);var P=Math.floor(R/2);var O=Math.floor(S/2);var T={minRowID:Math.max(Q.rowID-P,0),maxRowID:Math.min(Q.rowID-P+R,this._modelSize.numberOfRows-1),minColumnID:Math.max(Q.columnID-O,0),maxColumnID:Math.min(Q.columnID-O+S,this._modelSize.numberOfColumns-1)};return T},_computeVirtualViewport:function(){var W=this.getViewportDimensions();var X=this.getScrollerPosition();var T=this.getModelSize();var U=T.numberOfRows;var O=T.numberOfColumns;var P=2;var V=Math.floor(X.y/this._getCellHeight())-P;var Q=Math.floor((X.y+W.height)/this._getCellHeight())+P;var S=Math.floor(X.x/this._getCellWidth())-P;var R=Math.floor((X.x+W.width)/this._getCellWidth())+P;V=Math.max(0,V);Q=Math.min(Q,U-1);S=Math.max(0,S);R=Math.min(R,O-1);this._viewportBbox={minRowID:V,maxRowID:Q,minColumnID:S,maxColumnID:R};this._virtualPos={virtualRowID:this._viewportBbox.minRowID,virtualColumnID:this._viewportBbox.minColumnID};return this._viewportBbox},_computeDeltaViewport:function(){var O=this._viewportBbox;var P=this._computeVirtualViewport();return{minRowID:P.minRowID-O.minRowID,maxRowID:P.maxRowID-O.maxRowID,minColumnID:P.minColumnID-O.minColumnID,maxColumnID:P.maxColumnID-O.maxColumnID}},getVirtualViewport:function(O){return this._viewportBbox},setCellsContainerSize:function(P,O){if(O===undefined){O=true}if((this._poolContainerSize.width!==P.width&&P.width>=0)||(this._poolContainerSize.height!==P.height&&P.height>=0)){e.extend(this._poolContainerSize,P);this._needToApplyCellContainerSizer=true}},getCellsContainerSize:function(){return this._poolContainerSize},updateModelSize:function(Q){var O=this.options.virtualModelSize;if(O!==null){this._modelSize.numberOfRows=O.numberOfRows;this._modelSize.numberOfColumns=O.numberOfColumns}else{if(Q){this._modelSize.numberOfRows=Q.numberOfRows;this._modelSize.numberOfColumns=Q.numberOfColumns;this._numberOfColumns=Q.numberOfColumns}else{var P=this.options.model.length;var R;if(this.options.model[0]&&this.options.model[0].length){R=this.options.model[0].length}else{if(this.options.numberOfColumns){R=this.options.numberOfColumns;this._numberOfColumns=this.options.numberOfColumns}else{R=Math.floor(this._viewportDimensions.width/this._getCellWidth());if(R===0){R=1}}}this.updateModelSize({numberOfRows:P,numberOfColumns:R})}}},getModelSize:function(O){if(O===undefined){O=true}if(O){this.updateModelSize()}return this._modelSize},updateHeight:function(O){this.elements.container.setStyle("height",O==="auto"?"100%":O)},_buildLayout:function(){this.elements.container=new e.Element("div",{"class":"wux-layouts-gridengine",styles:{overflow:"hidden",width:"100%",position:"relative",height:this.options.height==="auto"?"100%":this.options.height}});if(this.options.height==="auto"){w.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"})}this.elements.topHeaderLayout=new e.Element("ul",{"class":"wux-ui-stack-h",styles:{display:"block",position:"relative",zIndex:400002}}).inject(this.elements.container);this.elements.corner=new e.Element("li",{"class":"wux-layouts-gridengine-corner"}).inject(this.elements.topHeaderLayout);this.elements.columnsHeaderContainer=new e.Element("li",{"class":"wux-layouts-gridengine-columns-header-container",styles:{position:"absolute",top:0,bottom:0,right:0,whiteSpace:"nowrap",overflow:"hidden"}}).inject(this.elements.topHeaderLayout);this.elements.columnsHeaderContainerRel=new e.Element("div",{"class":"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.columnsHeaderContainer);this.elements.mainLayout=new e.Element("ul",{"class":"wux-ui-stack-h",styles:{display:"block",position:"relative"}}).inject(this.elements.container);this.elements.rowsHeaderContainer=new e.Element("li",{"class":"wux-layouts-gridengine-rows-header-container",styles:{position:"absolute",top:0,bottom:0,left:0,overflow:"hidden"}}).inject(this.elements.mainLayout);this.elements.rowsHeaderContainerRel=new e.Element("div",{"class":"",styles:{position:"relative",height:"100%",width:"100%"}}).inject(this.elements.rowsHeaderContainer);this.elements.gridHeaderContainer=new e.Element("li",{"class":"",styles:{position:"absolute",top:0,bottom:0,right:0}}).inject(this.elements.mainLayout);this.elements.gridHeaderContainerRel=new e.Element("div",{"class":"wux-layouts-gridengine-scroller-container","show-at-hover":this.options.showScrollbarsOnHover,styles:{position:"relative",}}).inject(this.elements.gridHeaderContainer);this.elements.poolContainerRel=new e.Element("div",{"class":"wux-layouts-gridengine-poolcontainer-rel",styles:{position:"relative",height:"100%",width:"100%"}});this.elements.poolContainerRelDettachable=new e.Element("div",{}).inject(this.elements.poolContainerRel);this.elements.poolContainerRel.inject(this.elements.container)},_beginUpdate:function(){if(E&&!this._hasBeenDetached){this._hasBeenDetached=true;if(this.elements.poolContainerRelDettachable){this.elements.poolContainerRelDettachable.hide()}}},_endUpdate:function(){if(E&&this._hasBeenDetached===true){if(this.elements.poolContainerRelDettachable){this.elements.poolContainerRelDettachable.show()}this._hasBeenDetached=false}},setHeadersDimensions:function(O){this._setHeadersDimensions(O)},_setHeadersDimensions:function(P){if(P.width!==undefined){if(P.width===0){this.elements.corner.hide();this.elements.rowsHeaderContainer.hide()}else{this.elements.corner.show();this.elements.rowsHeaderContainer.show()}}if(P.height!==undefined){if(P.height===0){this.elements.columnsHeaderContainer.hide()}else{this.elements.columnsHeaderContainer.show()}}w.setStyles(this.elements.rowsHeaderContainer,{width:P.width});w.setStyles(this.elements.gridHeaderContainer,{left:P.width});w.setStyles(this.elements.mainLayout,{position:"absolute",top:P.height,left:0,right:0,bottom:0});var Q=0;if(this.getScroller()){var O=this.getScroller().getPosition();Q=O.x}w.setStyles(this.elements.columnsHeaderContainer,{left:P.width+Q});w.setStyles(this.elements.corner,{width:P.width});w.setStyles(this.elements.topHeaderLayout,{height:P.height});this._headersDimension=P},getHeadersDimensions:function(){if(this._headersDimension.width===undefined){this._headersDimension.width=this._getCellWidth()}if(this._headersDimension.height===undefined){this._headersDimension.height=this._getCellHeight()}return this._headersDimension},getCellModel:function(Q,P){if(P===undefined){if(this._isMonoDimension){return this.options.model[Q]}else{return this.options.model[Math.floor(Q/this._numberOfColumns)][Q%this._numberOfColumns]}}else{if(this._isMonoDimension){return this.options.model[Q*this._numberOfColumns+P]}else{if(P===-1){return undefined}else{if(Q===-1){return undefined}else{var O=this.getModelSize();if(Q<O.numberOfRows&&P<O.numberOfColumns&&this.options.model[Q]){return this.options.model[Q][P]}}}}}},onModelRequest:function(O){this._onModelRequestCBisAsync=false;this._onModelRequestCB=O},onModelRequestAsync:function(O){this._onModelRequestCBisAsync=true;this._onModelRequestCB=O},modelRequestAsyncDone:function(){return this._modelEvents.publish({event:"modelRequestDone",context:this})},onEndResizeOrOnReadyModelRequest:function(O){this._onEndResizeOrOnReadyModelRequestCBisAsync=false;this._onEndResizeOrOnReadyModelRequestCB=O},onEndResizeOrOnReadyModelRequestAsync:function(O){this._onEndResizeOrOnReadyModelRequestCBisAsync=true;this._onEndResizeOrOnReadyModelRequestCB=O},EndResizeOrOnReadyModelRequestAsyncDone:function(){return this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},onInfiniteScroll:function(O){this._onInfiniteScrollCBisAsync=false;this._onInfiniteScrollCB=O},onInfiniteScrollAsync:function(O){this._onInfiniteScrollCBisAsync=true;this._onInfiniteScrollCB=O},infiniteScrollAsyncProcessDone:function(){return this._modelEvents.publish({event:"BottomReachedDone",context:this})},onHeavyDataColumnModelRequest:function(O){this._onHeavyDataColumnModelRequestCB=O},onCellRequest:function(O){this._onRequestCellCB=O},addEventListener:function(P,S,O){var Q=this;var R=function(U){if(!Q._isRequestingCell){var T=w.firstParentWithClass(U.target,"wux-datagrid-cell");if(T){var V=T.dsView.getCellInfos();S(U,V)}else{S(U)}}};Q.getContent().addEventListener(P,R,O);return R},removeEventListener:function(P,Q,O){this.getContent().removeEventListener(P,Q,O)},onCellClick:function(O){return this._modelEvents.subscribe({event:"CLICK"},O)},onCellPointerDown:function(O){return this._modelEvents.subscribe({event:"pointerDown"},O)},onRowHeaderRequest:function(O){this._onRequestRowHeaderCB=O},onColumnHeaderRequest:function(O){this._onRequestColumnHeaderCB=O},getScroller:function(){return this.elements.scroller},getScrollerPosition:function(P){if(this.__cachedScrollPos&&!P){return this.__cachedScrollPos}else{if(this.getScroller()){var O=this.getScroller()._scrollPosition;return{x:-O.x,y:-O.y}}else{return{x:0,y:0}}}},_syncScrollPositionToHeaders:function(){var O=this.getScrollerPosition(true);w.setStyles(this.elements.columnsHeaderContainer,{left:-O.x+this._headersDimension.width});w.setStyles(this.elements.rowsHeaderContainer,{top:-O.y})},setScrollerPosition:function(O,P){this._computePoolSize();if(this.getPoolNumberOfRows()===0&&this.getPoolNumberOfColumns()===0){this.onPostUpdateViewOnce(function(){this._computePoolSize();this._applyScrollerPosition(O)})}else{this._applyScrollerPosition(O,P)}},_applyScrollerPosition:function(O,P){if(this.getScroller()){if(!P){this.prepareUpdateView()}O.x=O.x||0;O.y=O.y||0;this.getScroller().elements.container.scrollLeft=O.x;this.getScroller().elements.container.scrollTop=O.y;if(!P){this.pushUpdateView(true)}}},getRowPosition:function(O){return(O)*this._getCellHeight()},getColumnPosition:function(O){return(O)*this._getCellWidth()},_doesColumnNeedToBeRequested:function(O){return true},_getVirtualPositionFromScrollPosition:function(O){if(O===undefined){if(this.getScroller()){O=this.getScrollerPosition()}else{O={x:0,y:0}}}return{rowID:parseInt(Math.abs(O.y)/this._getCellHeight(),10),columnID:parseInt(Math.abs(O.x)/this._getCellWidth(),10)}},_getCoordinatesFromEvent:function(S){var P=this.getScrollerPosition();var V=this.getHeadersDimensions();var R=this.elements.container.style.zoom?parseFloat(this.elements.container.style.zoom,10):1;var T=1+(1-R);var Q=H(S,true,T);var O=(Q.offsetX+P.x)-(V.width*R);var U=(Q.offsetY+P.y)-(V.height*R);if(Q.offsetX<V.width*R){return{rowID:this._getVirtualPositionFromScrollPosition({x:O,y:U}).rowID,columnID:-1}}else{if(Q.offsetY<V.height*R){return{columnID:this._getVirtualPositionFromScrollPosition({x:O,y:U}).columnID,rowID:-1}}else{return this._getVirtualPositionFromScrollPosition({x:O,y:U})}}},_getRowIDFromEvent:function(O){return this._getCoordinatesFromEvent(O).rowID},_getColumnIDFromEvent:function(O){return this._getCoordinatesFromEvent(O).rowID},_getCellInfosFromDom:function(O){if(O&&O.dsView){var P=O.dsView.getCellInfos();P.rowID=P.virtualRowID;P.columnID=P.virtualColumnID;return P}return{virtualRowID:undefined,virtualColumnID:undefined,cellModel:undefined,cellView:undefined,dataIndex:undefined,typeRepresentation:undefined,manager:undefined,isHeader:undefined}},_getCellInfosFromEventTarget:function(P){var O=C(P.target,"wux-datagrid-cell");return this._getCellInfosFromDom(O)},_draggable:function(Q){var P=false;var R=this;var S=function(T){if(T.type==="touchstart"){}P=true;var U=R._getCellInfosFromEventTarget(T);if(U){Q.begin(T,U)}};var O=function(T){P=false;var U=R._getCoordinatesFromEvent(T);if(U){Q.end(T,U)}};this.elements.container.addEventListener("touchstart",S);this.elements.container.addEventListener("mousedown",S);this.elements.container.addEventListener(i.POINTERMOVE,function(T){if(P){var U=R._getCoordinatesFromEvent(T);if(U){Q.drag(T,U)}}});this.elements.container.addEventListener("mouseup",O);this.elements.container.addEventListener("touchend",O)},runEngine:function(){var R=this;this.elements.scroller=new I(this.elements.poolContainerRel,{eventPeriod:0,useUWAScroller:this.options.useTransparentScroller}).inject(this.elements.gridHeaderContainerRel);w.setStyles(this.elements.scroller.getContent(),{position:"absolute",left:0,top:0,bottom:0,width:"100%",height:"100%"});R._hasBeenUpdated();var P;R.getScroller().getContent().addEventListener(i.POINTERMOVE,function(S){if(i.isTouchEvent(S)){R._preventSelectionForTouchScroll=true;clearTimeout(P);P=setTimeout(function(){R._preventSelectionForTouchScroll=false},2000)}},false);var O=0;this.elements.scroller.onScrollBegin(function(){R._beginScrollPosition=this.getPosition();R._scrollPositionFromBeginning={x:0,y:0};R.lockUI({changeOpacity:false})});this.elements.scroller.onScroll(function Q(ab){R._deltaScrollPositionFromBeginning=this.getDeltaScrollPositionFromBeginning();var ae=R.getScrollerPosition(true);R._syncScrollPositionToHeaders();R.__cachedScrollDistance=Math.sqrt((ae.x-R.__cachedScrollPos.x)*(ae.x-R.__cachedScrollPos.x)+(ae.y-R.__cachedScrollPos.y)*(ae.y-R.__cachedScrollPos.y));O+=R.__cachedScrollDistance;var X={x:ae.x-R.__cachedScrollPos.x,y:ae.y-R.__cachedScrollPos.y};R.__cachedScrollPos=ae;if(O>=R.options.performances.minimumScrollDistance){O=0;if(G){console.log("-")}var U=this.getPosition();R._scrollDirection=X;R.__lastScrollPos=U;var af=5*parseInt(R._getCellHeight(),10);var ag=5*parseInt(R._getCellWidth(),10);var ac=R.getCellsContainerSize();var Z=ac.height-R._viewportDimensions.height;if(Z-af>0){Z=Z-af}var aa=ac.width-R._viewportDimensions.width;if(aa-ag>0){aa=aa-ag}var W=false,T=false,V=false,S=false;var ad=R.options.pageScrollValueTriggeringInfiniteScroll;if(ad!=undefined){if(e.is(ad,"number")){if(ad<=0||ad>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1."}T=(Math.abs(ae.y)+ad*R._viewportDimensions.height>=ad*ac.height);S=(Math.abs(ae.y)>=Z&&Z>0);W=(Math.abs(ae.x)>=aa&&aa>0)}else{if(e.is(ad,"object")){if(ad.x!=undefined){if(ad.x<=0||ad.x>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x option. Please provide a value strictly between 0 and 1."}W=(Math.abs(ae.x)+ad.x*R._viewportDimensions.width>=ad.x*ac.width);V=(Math.abs(ae.x)>=aa&&aa>0)}else{W=(Math.abs(ae.x)>=aa&&aa>0)}if(ad.y!=undefined){if(ad.y<=0||ad.y>=1){throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y option. Please provide a value strictly between 0 and 1."}T=(Math.abs(ae.y)+ad.y*R._viewportDimensions.height>=ad.y*ac.height);S=(Math.abs(ae.y)>=Z&&Z>0)}else{T=(Math.abs(ae.y)>=Z&&Z>0)}}}}else{W=(Math.abs(ae.x)>=aa&&aa>0);T=(Math.abs(ae.y)>=Z&&Z>0)}if((X.x>0&&W)||(X.y>0&&T)){if(R._onInfiniteScrollCB&&R.options.infiniteScrolling&&(X.x>=0||X.y>=0)){if(!R._isRequestingModelUpdate){R._isRequestingModelUpdate=true;setTimeout(function(){if(R._onInfiniteScrollCBisAsync){R._modelEvents.subscribeOnce({event:"BottomReachedDone"},function(){R.prepareUpdateView();R.pushUpdateView(true);R._isRequestingModelUpdate=false})}else{R.prepareUpdateView()}var ah=R.getVirtualViewport();R._onInfiniteScrollCB.call(R,{reachBottom:T,reachRight:W,model:R.options.model,virtualRowID:ah.maxRowID,virtualColumnID:ah.maxColumnID,isVeryCloseFromRight:V,isVeryCloseFromBottom:S});if(!R._onInfiniteScrollCBisAsync){R.initialize(true);R._computeModelSize();R._isRequestingModelUpdate=false}},1)}}}var Y=function(){switch(R.options.performances.renderingMode){case"adaptive":R.updateView();break;case"standard":var aj=R.getViewportDimensions();if(Math.abs(U.y)===ac.height-R._gridDimension.height){R.updateView()}else{var ah=Math.abs(X.y)<=R.options.performances.fullUpdateFactor*aj.height;var ai=Math.abs(X.x)<=R.options.performances.fullUpdateFactor*aj.width;if(!R._isDebouncingUpdateView&&ah&&ai){R.iterativeUpdate(U,X)}else{R._freeUpPool(1);R.updateView()}}break}};if(R.options.performances.useRequestAnimationFrameRendering){K.addTask({namespace:"wux-gridengine-render"+R._uuid,callback:function(){Y()},taskArgs:[]},"wux-gridengine-render"+R._uuid)}else{Y()}}});this.elements.scroller.onScrollEnd(function(){R._preventSelectionForTouchScroll=false;if(R._deltaScrollPositionFromBeginning.x!==0||R._deltaScrollPositionFromBeginning.y!==0){if(R._deltaScrollPositionFromBeginning.y!==0||(R._deltaScrollPositionFromBeginning.x!==0&&R.options.performances.enableColumnVirtualization)){R._heavyDataColumnModelRequest("onScrollEnd")}}if(R.options.performances.renderingMode==="adaptive"){R._renderViewPort()}if(!R._preventScrollEnd){R._preventFullUpdate=false;R._requestModelIfNeeded(true)}else{R._preventScrollEnd=false}R.unlockUI()});this._modelEvents.subscribe({event:"UPDATE_VIEW"},function(){R._renderViewPort()});R._renderViewPort(true)},_applyCellsContainerSizeIfNeeded:function(){if(this._needToApplyCellContainerSizer===true){w.setStyles(this.elements.poolContainerRel,{width:this._poolContainerSize.width,height:this._poolContainerSize.height<=0?1:this._poolContainerSize.height});if((!d.chrome||window.navigator.userAgent.indexOf("Edge"))&&this._poolContainerSize.height>B){this.elements.poolContainerRel.style.height="1e+07px"}this._needToApplyCellContainerSizer=false;if(this._viewportDimensions.width<this._poolContainerSize.width){this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",true)}else{this.elements.gridHeaderContainerRel.setAttribute("has-overflow-x",false)}if(this._viewportDimensions.height<this._poolContainerSize.height){this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",true)}else{this.elements.gridHeaderContainerRel.setAttribute("has-overflow-y",false)}}},getListOfCellsInVisibleViewport:function(R){if(R===undefined){R={}}var O=this._computeVirtualViewport();var Q={};for(var S=O.minColumnID;S<=O.maxColumnID;S++){var T="-1_"+S;Q[T]=true;if(R.callback){R.callback({virtualRowID:-1,virtualColumnID:S})}}for(var S=O.minRowID;S<=O.maxRowID;S++){var T=S+"_-1";Q[T]=true;if(R.callback){R.callback({virtualRowID:S,virtualColumnID:-1})}}for(var S=O.minRowID;S<=O.maxRowID;S++){for(var P=O.minColumnID;P<=O.maxColumnID;P++){var T=S+"_"+P;Q[T]=true;if(R.callback){R.callback({virtualRowID:S,virtualColumnID:P})}}}return Q},_renderViewPort:function(W){if(this.getScroller()){switch(this.options.performances.renderingMode){case"adaptive":if(this._viewportBboxIsRendering!==true){this._listOfColumnCellPerformances={};this._beginUpdate();if(this._updateViewOptions.onPreUpdate){var R=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null;R.call(this)}this._applyCellsContainerSizeIfNeeded();if(this.options.height==="inherit"){this._applyInheritedHeight()}this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}});if(this._debugPerformanceIssues){console.time("["+this._name+"]:render viewport");window.performance.mark("gridengine_gridengine_renderviewport_begin")}this._viewportBboxIsRendering=true;var O=this.getListOfCellsInVisibleViewport({callback:(function(X){this._renderCell(X)}).bind(this)});for(var V in this._listOfRenderedCells){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}for(var V in this._listOfRenderedRowHeaders){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}for(var V in this._listOfRenderedColumnHeaders){if(O[V]===undefined){this._freeUpCellFromIdentifier(V)}}this._viewportBboxIsRendering=false;if(this._debugPerformanceIssues){console.timeEnd("["+this._name+"]:render viewport")}this._notifyUpdateViewCompleted()}else{console.log("[E]")}break;case"standard":this._listOfColumnCellPerformances={};this._beginUpdate();if(W){this._freeUpPool(0)}if(this._updateViewOptions.onPreUpdate){var R=this._updateViewOptions.onPreUpdate;this._updateViewOptions.onPreUpdate=null;R.call(this)}this._applyCellsContainerSizeIfNeeded();if(this.options.height==="inherit"){this._applyInheritedHeight()}this._modelEvents.publish({event:"preFullUpdateView",context:this,data:{}});var P=this._getVirtualPositionFromScrollPosition();var T=this.getPoolNumberOfRows();var Q=this.getPoolNumberOfColumns();var P=this._computeVirtualViewport();if(this._debugPerformanceIssues){console.time("["+this._name+"]:render viewport");window.performance.mark("gridengine_gridengine_renderviewport_begin")}this._viewportBboxIsRendering=true;if(this.options.showColumnsHeader===true){this._renderRow(-1)}var S=this.getNumberOfRows();if(this.options.showColumnsHeader===true&&S===0){this._renderRow(0)}for(var U=P.minRowID;U<=this._viewportBbox.maxRowID&&U<S;U++){this._renderRow(U)}this._viewportBboxIsRendering=false;if(this._debugPerformanceIssues){console.timeEnd("["+this._name+"]:render viewport")}this._notifyUpdateViewCompleted();break}}},_notifyUpdateViewCompleted:function(){this._endUpdate();this._validateLayout();if(this._debugPerformanceIssues){console.groupCollapsed("["+this._name+"]:Update View");for(var O in this._listOfColumnCellPerformances){var R=this._listOfColumnCellPerformances[O];var P=R.reduce(function(T,S){return T+S});var Q=P/R.length;console.info("rendering time for column",O+":",Math.round(P*100)/100,"ms . Mean time per cell:",Math.round(Q*1000)/1000,"ms","for",R.length,"cells")}window.performance.mark("gridengine_gridengine_renderviewport_end");this._modelEvents.publish({event:"performanceAnalysisAvailable",context:this,data:this._listOfColumnCellPerformances});this._listOfColumnCellPerformances={};console.groupEnd("["+this._name+"]:Update View")}this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:false}})},_renderColumn:function(T){var R=this;var Q=this.getPoolNumberOfRows();var O=this._viewportBbox;R._renderCell({virtualRowID:-1,virtualColumnID:T});var S=-1;for(var P=0;P<Q&&S<R._modelSize.numberOfRows-1;P++){S=Math.min(R._modelSize.numberOfRows-1,O.minRowID+P);R._renderCell({virtualCellID:S*R._numberOfColumns+T,virtualRowID:S,virtualColumnID:T})}},_renderRowCB:function(S){var Q=this;var O=Q.getVirtualViewport();if(S===-1&&Q.options.showColumnsHeader===true){var R=-1;for(var P=O.minColumnID;P<=O.maxColumnID;P++){Q._renderCell({virtualRowID:S,virtualColumnID:P})}}else{if(S<Q._modelSize.numberOfRows){this.elements.poolContainerRelDettachable.show();if(S>=0&&Q.options.showRowsHeader===true){Q._renderCell({virtualRowID:S,virtualColumnID:-1})}var R=-1;for(var P=O.minColumnID;P<=O.maxColumnID&&R<Q._modelSize.numberOfColumns-1;P++){R=Math.min(Q._modelSize.numberOfColumns-1,P);Q._renderCell({virtualRowID:S,virtualColumnID:P})}Q._lastRenderedRowID=S}else{this.elements.poolContainerRel.setStyle("height","1px");this.elements.poolContainerRelDettachable.hide()}}},_renderRow:function(P){switch(this.options.performances.renderingMode){case"adaptive":if(this._viewportBboxIsRendering!==true){this._renderRowCB(P)}break;case"standard":var O=this;O._renderRowCB(P);break}},_freeUpRow:function(P){for(var O=this._viewportBbox.minColumnID;O<=this._viewportBbox.maxColumnID;O++){this._freeUpCell(P,O)}if(z){console.log(this._listOfFreeCells.length)}},_freeUpPool:function(R){this._lastRenderedRowID=null;if(R===undefined){R=1}var P;for(P in this._listOfRenderedCells){var Q=this._listOfRenderedCells[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeCells.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeCells.unshift(Q)}if(R===0){this._listOfFreeCells.unshift(Q)}delete this._listOfRenderedCells[P]}for(P in this._listOfRenderedRowHeaders){var Q=this._listOfRenderedRowHeaders[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeRowHeaders.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeRowHeaders.unshift(Q)}if(R===0){this._listOfFreeRowHeaders.unshift(Q)}delete this._listOfRenderedRowHeaders[P]}for(P in this._listOfRenderedColumnHeaders){var Q=this._listOfRenderedColumnHeaders[P];Q._clean();Q._disposeReusableContent();if(R===3){Q.destroy()}if(R===2){Q.getContent().remove();this._listOfFreeColumnHeaders.unshift(Q)}if(R===1){Q.getContent().hide();this._listOfFreeColumnHeaders.unshift(Q)}if(R===0){this._listOfFreeColumnHeaders.unshift(Q)}delete this._listOfRenderedColumnHeaders[P]}var O={0:"flag cells as free",1:"hide cells + flag cells as free",2:"remove cells from dom + flag cells as free"};if(z){console.log("free up pool",O[R])}},_freeUpCellFromIdentifier:function(P){var O=P.split("_");var R=parseInt(O[0],10);var Q=parseInt(O[1],10);return this._freeUpCell(R,Q)},_freeUpCell:function(S,R){var O=S+"_"+R;var Q=this._getListOfRenderedForCellAt({virtualRowID:S,virtualColumnID:R});var T=this._getListOfFreeForCellAt({virtualRowID:S,virtualColumnID:R});if(Q[O]){var P=Q[O];P.getContent().style.display="none";P._clean();P._disposeReusableContent();T.push(P);delete Q[O];if(z){console.log("freeup",O,Q)}}},_getListOfFreeForCellAt:function(P){var O;if(P.virtualRowID!==-1&&P.virtualColumnID!==-1){O=this._listOfFreeCells}else{if(P.virtualRowID===-1){O=this._listOfFreeColumnHeaders}else{if(P.virtualColumnID===-1){O=this._listOfFreeRowHeaders}}}return O},_addToListOfRenderedForCellAt:function(Q,P){var O=Q.virtualRowID+"_"+Q.virtualColumnID;if(Q.virtualRowID!==-1&&Q.virtualColumnID!==-1){this._listOfRenderedCells[O]=P}else{if(Q.virtualRowID===-1){this._listOfRenderedColumnHeaders[O]=P}else{if(Q.virtualColumnID===-1){this._listOfRenderedRowHeaders[O]=P}}}return P},_getListOfRenderedForCellAt:function(P){var O;if(P.virtualRowID!==-1&&P.virtualColumnID!==-1){O=this._listOfRenderedCells}else{if(P.virtualRowID===-1){O=this._listOfRenderedColumnHeaders}else{if(P.virtualColumnID===-1){O=this._listOfRenderedRowHeaders}}}return O},_isCellRendered:function(Q){var P=this._getListOfRenderedForCellAt(Q);var O=Q.virtualRowID+"_"+Q.virtualColumnID;return Boolean(P[O])},_freeUpColumn:function(P){for(var O=this._viewportBbox.minRowID;O<=this._viewportBbox.maxRowID;O++){this._freeUpCell(O,P)}if(z){console.log(this._listOfFreeCells.length)}},__preloadPool:D.debounce(function(){var P=this._poolSizeMax.numberOfRows;var Q=this._poolSizeMax.numberOfColumns;var T=P*Q;var R=Object.keys(this._listOfRenderedCells).length+this._listOfFreeCells.length;var S=T-R;console.log("preload pool",T,"-",R,"=",S);if(S>0){do{if(S%P===0){var O=this.__createRowHeaderCell();O._free();this._listOfFreeRowHeaders.push(O);S--}var O=this.__createCell();O._free();this._listOfFreeCells.push(O);S--}while(S>0)}},10),__createCell:function(){var O=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:this._getCellWidth(),height:this._getCellHeight()});O.POOL_CELL_ID=r++;if(c){O.getContent().setStyles({transition:"all 1s"})}O.inject(this.elements.poolContainerRelDettachable);this._modelEvents.publish({context:O,data:{cellView:O,rowID:-1,columnID:-1},event:N});if(z){console.log("create cell")}return O},__createRowHeaderCell:function(){var P=this.getHeadersDimensions();var O=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:P.width,height:this._getCellHeight(),isHeader:true});O.getContent().addClassName("wux-datagrid-header");O.inject(this.elements.rowsHeaderContainerRel);O.nodeColor=new e.Element("div",{"class":"wux-datagrid-node-color",});this._modelEvents.publish({context:O,data:{cellView:O,rowID:-1,columnID:-1},event:N});if(z){console.log("create row header")}return O},__createColumnHeaderCell:function(){var Q=this.getHeadersDimensions();var P=new this.options.cellClass({gridEngine:this,parent:this.options.parent,width:this._getCellWidth(),height:Q.height,isHeader:true});P.getContent().addClassName("wux-datagrid-header");P.inject(this.elements.columnsHeaderContainerRel);var O=this;P.getContent().addEvent(i.POINTERUP,function(){O._modelEvents.subscribe({context:O,data:null,event:M})});this._modelEvents.publish({context:P,data:{cellView:P,rowID:-1,columnID:-1},event:N});if(z){console.log("create column header")}return P},_createCell:function(O){if(O.virtualRowID!==-1&&O.virtualColumnID!==-1){return this.__createCell()}else{if(O.virtualRowID===-1){return this.__createColumnHeaderCell()}else{return this.__createRowHeaderCell()}}},__getCellFromPool:function(R){var P;var O=R.virtualRowID+"_"+R.virtualColumnID;var Q=this._getListOfRenderedForCellAt(R);var S=this._getListOfFreeForCellAt(R);if(this._isCellRendered(R)){P=Q[O];if(z){console.log("reuse already rendered",O)}}else{if(S.length===0){P=this._createCell(R)}else{P=S.pop();if(c){P.getContent().setStyles({background:"rgb(15, 237, 197)",boxShadow:"0 0 10px silver",zIndex:10000})}P.getContent().style.display="block";if(R.virtualRowID!==-1&&R.virtualColumnID!==-1){P.inject(this.elements.poolContainerRelDettachable)}else{if(R.virtualRowID===-1){P.inject(this.elements.columnsHeaderContainerRel)}else{P.inject(this.elements.rowsHeaderContainerRel)}}if(c){setTimeout(function(){P.getContent().setStyles({background:"",boxShadow:"",zIndex:""})},1000)}if(z){console.log("reuse from free cells",O)}}this._addToListOfRenderedForCellAt(R,P)}if(!P){throw"Error cannot get a cell from pool"}return P},_isLayoutValid:function(){return !(this.__layoutIsInvalid===true)},_invalidateLayout:function(){this.__layoutIsInvalid=true},_validateLayout:function(){this.__layoutIsInvalid=false},needToRequestContentAt:function(O){return false},needToRenderCellAt:function(O){if(O.virtualColumnID===-1||O.virtualRowID===-1){return((this.options.showRowsHeader===true)&&(O.virtualColumnID===-1))||((this.options.showColumnsHeader===true)&&(O.virtualRowID===-1))}else{return true}},_renderCell:function(R){if(this.getCellModel(R.virtualRowID,R.virtualColumnID)!==undefined||(R.virtualRowID===-1)||(R.virtualColumnID===-1)){var S=this._isCellRendered(R)===false;if(S||(this.options.performances.renderingMode==="standard")){this._renderCellCB(R)}else{var O=this._isLayoutValid()===false;var P=this.needToRequestContentAt(R);var Q=this.needToRenderCellAt(R);if(this.options.performances.renderingMode==="adaptive"&&((O||P)&&Q)){this._renderCellCB(R)}}}},_renderCellCB:function(T){T.cellView=this.__getCellFromPool(T);var P=this.getPoolNumberOfRows()+1;var S=this.getPoolNumberOfColumns()+1;var O=T.virtualRowID===-1?T.virtualRowID:(T.virtualRowID%P);var Q=T.virtualColumnID===-1?T.virtualColumnID:(T.virtualColumnID%S);T.rowID=O;T.columnID=Q;T.cellID=O*this._numberOfColumns+T.virtualColumnID;var U;if(this._debugPerformanceIssues){if(this._listOfColumnCellPerformances[T.virtualColumnID]===undefined){this._listOfColumnCellPerformances[T.virtualColumnID]=[]}U=window.performance?performance.now():Date.now()}switch(this.options.performances.renderingOptimization){case 1:T.cellView.getContent().style.display="none";break;case 2:T.cellView.getContent().remove();break;default:break}if(G){console.log("c",T)}if(this.options.performances.use2PassRendering){T.cellView.updateInternalParameters()}T.cellView.getContent().style.display="none";T.cellView._setVirtualCoordinates({rowID:T.rowID,columnID:T.columnID,virtualRowID:T.virtualRowID,virtualColumnID:T.virtualColumnID});T.cellView.updateInternalParameters();this.__requestCellContent(T);T.cellView.placeCell();T.cellView.getContent().style.display="";switch(this.options.performances.renderingOptimization){case 1:T.cellView.getContent().style.display="block";break;case 2:if(T.virtualRowID===-1){this.elements.columnsHeaderContainerRel.appendChild(T.cellView.getContent())}else{if(T.virtualColumnID===-1){this.elements.rowsHeaderContainerRel.appendChild(T.cellView.getContent())}else{this.elements.poolContainerRelDettachable.appendChild(T.cellView.getContent())}}break;default:break}if(this._debugPerformanceIssues){var R=window.performance?performance.now():Date.now();this._listOfColumnCellPerformances[T.virtualColumnID].push(R-U)}},__requestCellContent:function(O){if(O.virtualColumnID===-1){if(this._onInternalRequestRowHeaderCB){this._onInternalRequestRowHeaderCB.call(this,O)}}else{if(O.virtualRowID===-1){if(this._onInternalRequestColumnHeaderCB){this._onInternalRequestColumnHeaderCB.call(this,O)}}else{if(this._onInternalRequestCellCB){this._onInternalRequestCellCB.call(this,O)}}}},_enableVisualDebug:function(){c=true},_disableVisualDebug:function(){c=false},enablePerformanceAnalysis:function(O){if(O!==undefined){this._name=O}this._debugPerformanceIssues=true&&J},disablePerformanceAnalysis:function(){this._debugPerformanceIssues=false},isPerformanceAnalysis:function(){return this._debugPerformanceIssues},iterativeUpdate:function(P,O){var Q=this;if(v){console.log(this.options.id,"------ iterative update --------")}Q._requestModelIfNeeded(true);this._deltaViewport=this._computeDeltaViewport();if(O.y>0){Q.shiftDownRecursive(P.y)}if(O.y<0){Q.shiftUpRecursive(P.y)}if(O.x>0){Q.shiftRightRecursive(P.x)}if(O.x<0){Q.shiftLeftRecursive(P.x)}},updateModel:function(O){this._internalUpdateModel(O)},_internalUpdateModel:function(O){if(O){this.options.model=O}this.initialize(true);this.prepareUpdateView();this.pushUpdateView(true)},_requestModelIfNeeded:function(S){var Q=this;var P=Q._modelViewPort&&!(Q._modelViewPort.minRowID<=Q.getVirtualViewport().minRowID&&Q._modelViewPort.maxRowID>=Q.getVirtualViewport().maxRowID);var R=Q._modelViewPort&&!(Q._modelViewPort.minColumnID<=Q.getVirtualViewport().minColumnID&&Q._modelViewPort.maxColumnID>=Q.getVirtualViewport().maxColumnID);var O=Q._modelViewPort&&(P||R);if(Q._modelViewPort===undefined||O){if(v&&(Q._modelViewPort!==undefined)){console.warn("----> request model")}Q._processModelRequest(S)}},_applyInheritedHeight:function(){var P=(this._scrollerDimensions&&(this.getCellsContainerSize().width>this._scrollerDimensions.width))?20:0;var O=(this.getCellsContainerSize().height+this.getHeadersDimensions().height+P);if(this.options.maxHeight){O=Math.min(O,this.options.maxHeight)}this.getContent().style.height=O+"px"},updateView:function(O){if(O||this._updateViewOptions.generatePool){this._generatePool()}this._modelEvents.publish({event:"UPDATE_VIEW",context:this});this._hasBeenUpdated()},onRightReached:function(O){return this._modelEvents.subscribe({event:"RIGHT_REACHED"},O)},onLeftReached:function(O){return this._modelEvents.subscribe({event:"LEFT_REACHED"},O)},onTopReached:function(O){return this._modelEvents.subscribe({event:"TOP_REACHED"},O)},onBottomReached:function(O){return this._modelEvents.subscribe({event:"BOTTOM_REACHED"},O)},shiftUpRecursive:function(O){if(this._deltaViewport.minRowID<0){for(var P=this._viewportBbox.minRowID-this._deltaViewport.minRowID;P>=this._viewportBbox.minRowID;P--){this._renderRow(P)}}if(this._deltaViewport.maxRowID<0){for(var P=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;P>=this._viewportBbox.maxRowID;P--){this._freeUpRow(P)}}},shiftLeftRecursive:function(O){if(this._deltaViewport.minColumnID<0){for(var P=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;P>=this._viewportBbox.minColumnID;P--){this._renderColumn(P)}}if(this._deltaViewport.maxColumnID<0){for(var P=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;P>=this._viewportBbox.maxColumnID;P--){this._freeUpColumn(P)}}},shiftDownRecursive:function(O){if(this._deltaViewport.minRowID>0){for(var P=this._viewportBbox.minRowID-this._deltaViewport.minRowID;P<=this._viewportBbox.minRowID;P++){this._freeUpRow(P)}}if(this._deltaViewport.maxRowID>0){for(var P=this._viewportBbox.maxRowID-this._deltaViewport.maxRowID;P<=this._viewportBbox.maxRowID;P++){this._renderRow(P)}}},shiftRightRecursive:function(O){if(this._deltaViewport.minColumnID>0){for(var P=this._viewportBbox.minColumnID-this._deltaViewport.minColumnID;P<=this._viewportBbox.minColumnID;P++){this._freeUpColumn(P)}}if(this._deltaViewport.maxColumnID>0){for(var P=this._viewportBbox.maxColumnID-this._deltaViewport.maxColumnID;P<=this._viewportBbox.maxColumnID;P++){this._renderColumn(P)}}},shiftDown:function(P,Q){var O=this._viewportBbox;var R=O.maxRowID+1;this._renderRow(R,true)},shiftRight:function(O){this._renderColumn(O)},shiftUp:function(O){this._renderRow(O,true)},shiftLeft:function(O){this._renderColumn(O)},_getModelMinRowID:function(){var P=-1;for(var O in this.options.model){P=O;break}return P},getNumberOfRows:function(){return this.options.model.length},getPoolNumberOfRows:function(){return this._poolSize.numberOfRows},getPoolNumberOfColumns:function(){return this._poolSize.numberOfColumns},_removeCellsFromPool:function(O,P){this._numberOfRowsToRemove=O;this._numberOfColumnsToRemove=P},_getEstimatedPoolSize:function(){var O=1;var R=this.elements.scroller.getDimensions();var P=O*parseInt(R.height/this._getCellHeight(),10)+2;var Q=O*parseInt(R.width/this._getCellWidth(),10)+2;return{numberOfRows:P,numberOfColumns:Q}},_destroyPool:function(){this._freeUpPool(2)},_doINeedToGeneratePool:function(){var O=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:this._computeModelSize().numberOfRows;return Math.floor(parseInt(this.getViewportDimensions().height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor)>=O},getViewportDimensions:function(O){if(this._viewportDimensions===undefined||O===true||true){this._viewportDimensions={width:this.elements.gridHeaderContainerRel.offsetWidth,height:this.elements.gridHeaderContainerRel.offsetHeight}}return this._viewportDimensions},_generatePool:function(O,P){var S=this.__computePoolSize(O,P);this._freeUpPool(1);this._poolSizeMax=S.poolSizeMax;this._poolSize=S.poolSize;var R="[GridEngine] - generate pool --";b.beginMeasure(R);var Q=this;this._needToApplyCellContainerSizer=true;this._updateViewOptions.generatePool=false;Q._modelEvents.publish({context:this,event:m});b.endMeasure(R)},_computePoolSize:function(W,P){var T=this._computeModelSize();if(W===undefined){W=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:T.numberOfRows}if(P===undefined){P=this._poolDimensions.numberOfColumns!==undefined?this._poolDimensions.numberOfColumns:T.numberOfColumns}var U=this.getViewportDimensions();var Q=1;var V,S,R,O;R=Math.ceil(Q*parseInt(U.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor);O=Math.ceil(Q*parseInt(U.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor);V=Math.ceil(Math.max(1,Math.min(Q*parseInt(U.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,W))+this._numberOfRowsToRemove);if(!this.options.performances.enableColumnVirtualization){S=P}else{S=Math.floor(Math.max(1,Math.max(Math.min(Q*parseInt(U.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,P),1))+this._numberOfColumnsToRemove)}this._poolSizeMax={numberOfRows:R,numberOfColumns:O};this._poolSize={numberOfRows:V,numberOfColumns:S};if(v){console.warn(this.options.id,"Viewport size",U.width,"x",U.height,"px");console.warn(this.options.id,"Generate a pool of ",V,"x",S,"cells")}},__computePoolSize:function(X,P){var U=this._computeModelSize();if(X===undefined){X=this._poolDimensions.numberOfRows!==undefined?this._poolDimensions.numberOfRows:U.numberOfRows}if(P===undefined){P=this._poolDimensions.numberOfColumns!==undefined?this._poolDimensions.numberOfColumns:U.numberOfColumns}var V=this.getViewportDimensions();var Q=1;var W,T,R,O;R=Math.ceil(Q*parseInt(V.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor);O=Math.ceil(Q*parseInt(V.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor);W=Math.ceil(Math.max(1,Math.min(Q*parseInt(V.height/this._getCellHeight(),10)*this.options.performances.numberOfRowsFactor,X))+this._numberOfRowsToRemove);if(!this.options.performances.enableColumnVirtualization){T=P}else{T=Math.floor(Math.max(1,Math.max(Math.min(Q*parseInt(V.width/this._getCellWidth(),10)*this.options.performances.numberOfColumnsFactor,P),1))+this._numberOfColumnsToRemove)}var Y={numberOfRows:R,numberOfColumns:O};var S={numberOfRows:W,numberOfColumns:T};if(v){console.warn(this.options.id,"Viewport size",V.width,"x",V.height,"px");console.warn(this.options.id,"Generate a pool of ",W,"x",T,"cells")}return{poolSize:S,poolSizeMax:Y}},onPreUpdateView:function(O){return this._modelEvents.subscribe({event:"preFullUpdateView"},O)},onPreUpdateViewOnce:function(O){return this._modelEvents.subscribeOnce({event:"preFullUpdateView"},O)},onPostUpdateView:function(O){if(window.__karma__!==undefined){return this.onPostUpdateViewODT(O)}else{return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},O)}},onPostUpdateViewODT:function(O){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},D.debounce(O,200))},onPostUpdateViewOnce:function(O){if(window.__karma__!==undefined){return this.onPostUpdateViewOnceODT(O)}else{return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},O)}},onPostUpdateViewOnceODT:function(O){return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},D.debounce(O,200))},onPoolUpdate:function(O){return this._modelEvents.subscribe({event:m},O)},onPoolCellCreation:function(O){this._modelEvents.subscribe({event:N},O)},onPoolCellDestruction:function(O){this._modelEvents.subscribe({event:k},O)},processPoolCells:function(Q){var O;for(O in this._listOfRenderedCells){var P=this._listOfRenderedCells[O];Q.call(this,{cellView:P})}},addCellsFilter:function(O){O=e.extend({match:function(Q){},onMatch:function(Q){},onMismatch:function(Q){}},O);var P=this;this._listOfCellFilters.pushAction({actionFunc:function(Q){if(O.match.call(P,Q)){Q.cellView._isFiltered=true;O.onMatch.call(P,Q)}else{if(Q.cellView._isFiltered){O.onMismatch.call(P,Q)}}}})},search:function(O){O=e.extend({match:function(R){},onComplete:function(R){}},O);var Q=this;var P=[];y.forEach(this.options.model,function(S,R){if(!Q._isMonoDimension){S.forEach(function(T,V){var U=Q.getCellModel(R,V);var W={cellModel:U,virtualRowID:R,virtualColumnID:V,virtualCellID:R*Q._numberOfColumns+V};if(O.match.call(Q,W)){P.push(W)}})}},100,function(){if(O.onComplete){O.onComplete.call(Q,{listOfMatchedCellModels:P})}})},removeAllCellsFilters:function(){this._listOfCellFilters.clear();this.updateView(true)},_getCellWidth:function(){return this.options.defaultCellWidth+this.options.cellSpacing.horizontal},_getCellHeight:function(){return this.options.defaultCellHeight+this.options.cellSpacing.vertical},_computeDynamicCellSpacing:function(){if(this.getScroller()){var P=this._scrollerDimensions;P.width=P.width-20;var O=(P.width%this.options.defaultCellWidth)/((Math.floor(P.width/this.options.defaultCellWidth)+1));this.options.cellSpacing={horizontal:O,vertical:O}}},_enableAutoScroll:function(P,Q){this._autoScrollDistance=P||{x:0,y:0};this._autoScrollPeriod=Q||20;this._disableAutoScroll();if(this._autoScrollInterval===undefined){var O=this;this._autoScrollInterval=window.setInterval(function(){var R=O.getScroller().elements.container;var S=R.scrollTop;var T=R.scrollLeft;if(S>=0){R.scrollTop=S+O._autoScrollDistance.y}if(T>=0){R.scrollLeft=T+O._autoScrollDistance.x}},this._autoScrollPeriod)}},_setAutoScrollVelocity:function(O){this._autoScrollDistance=O||{x:0,y:0}},_disableAutoScroll:function(){if(this._autoScrollInterval!==undefined){window.clearInterval(this._autoScrollInterval);delete this._autoScrollInterval}}});return q});define("DS/Layouts/ChannelView",["DS/Layouts/GridEngine","DS/Controls/ThumbnailCellView"],function(c,b){var a=c.extend({defaultOptions:{cellClass:b,numberOfColumns:1,defaultCellWidth:260,defaultCellHeight:170},init:function(d){d.numberOfColumns=d.model.length;this._parent(d);this.elements.container.setStyles({height:this.options.defaultCellHeight+20})}});return a});define("DS/Layouts/ListViewCellAbstract",["UWA/Core","UWA/Class","DS/Layouts/GridEngineCellAbstract"],function(d,a,c){var b=c.extend({defaultOptions:{width:"100%"},init:function(e){this._parent(e);this.elements.container.addClassName("wux-layouts-listview-cell")}});return b});define("DS/Layouts/ListView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Layouts/ListViewCellAbstract"],function(f,c,d,a,e){var b=d.extend({defaultOptions:{cellClass:a,defaultCellHeight:28,numberOfColumns:1},init:function(g){this._parent(g);var h=this;this.onPoolUpdate(function(){h.setCellsContainerSize({width:"100%"})});this.elements.container.addClassName("wux-layouts-listview")}});return b});