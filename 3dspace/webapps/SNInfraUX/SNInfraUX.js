/*!  COPYRIGHT DASSAULT SYSTEMES 2014   */
define("DS/SNInfraUX/SearchSettings",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Data","UWA/Promise","DS/WebappsUtils/WebappsUtils","text!DS/SNInfraUX/assets/SearchSettings.json","text!DS/SNInfraUX/assets/SearchSettings_Public.json","text!DS/SNInfraUX/assets/SearchSettings_IP.json","DS/WebRecordEnabler/Adapter","i18n!DS/SNInfraUX/assets/nls/SNInfraUX.json","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchControlCenterFetchService"],function(h,k,f,m,g,c,j,i,l,b,o,a,e){var n=function(p){var q=/(http|https):\/\//;return q.test(p)};var d=k.singleton(f,{options:{search_settings:{},search_settings_odt:{}},loadComplete:false,settings_loaded:[],onCompleteLoad:undefined,_tenantSettingsPC:{},_tenantSettings:{},setODToption:function(p,q){if(!UWA.is(this.options.search_settings_odt),"object"){this.options.search_settings_odt={}}this.options.search_settings_odt[p]=q;a.info("ODT option SET, "+p+" = "+this.options.search_settings_odt[p])},init:function(q){var r=this;if(location.search.indexOf("debug")!==-1||location.search.indexOf("searchLogs")!==-1){this.setDebugMode(true);window.searchLogs=true}a.info("3DSearch traces activated");try{this.options=JSON.parse(l)}catch(t){a.error("Error parsing SearchSettings_IP.json:",t)}if(!h.is(this.options)){this.options={search_settings:{}}}if(!h.is(this.options.search_settings)){this.options.search_settings={}}var p=null;try{p=JSON.parse(i)}catch(t){a.error("Error parsing SearchSettings_Public.json:",t)}if(h.is(p)){UWA.merge(this.options,p);if(h.is(p.search_settings)){UWA.merge(this.options.search_settings,p.search_settings)}}var s=null;try{s=JSON.parse(j)}catch(t){a.error("Error parsing SearchSettings.json:",t)}if(h.is(s)){UWA.merge(this.options,s);if(h.is(s.search_settings)){UWA.merge(this.options.search_settings,s.search_settings)}}this.options.url_search_settings={};this.debugMode=this.getDebugMode()},load:function(p){if(this.settings_loaded.indexOf(p.url)){this.onCompleteLoad=p.onComplete;this._loadSettings(p.url);this.settings_loaded.push(p.url)}},urlSettings:function(q){if(h.is(q.debug_me)){this.options.search_settings.debug_mode=true}if(this.options.search_settings.debug_mode===true){this.setDebugMode(true)}this.log("updateSettings from the URL done");if(!h.is(this.options.url_search_settings)){this.options.url_search_settings={}}for(var p in q){if(p==="debug_me"){this.log("Debug mode already taken into account")}else{var s=q[p];if(((typeof s!="undefined")&&(typeof s.valueOf()=="string"))&&s.length>0){if(s.toLowerCase()=="false"){s=false}else{if(s.toLowerCase()=="true"){s=true}}}if(h.is(this.options.search_settings[p],"number")){if(!isNaN(s)){s=+s}}if(h.is(s,"string")&&s.indexOf("%")>-1){s=decodeURIComponent(s);try{s=JSON.parse(s)}catch(r){a.error("Error parsing arg:",r)}}this.options.url_search_settings[p]=s}}},initialize:function(p){this.options=UWA.extend(this.options,p,true);this.debugMode=this.getDebugMode()},serialize:function(){return JSON.stringify(this.options)},getDebugMode:function(){if(UWA.is(this.options)&&UWA.is(this.options.search_settings)&&this.options.search_settings.debug_mode){return true}else{return false}},getDebug:function(){if(UWA.is(this.options)&&UWA.is(this.options.search_settings)&&UWA.is(this.options.search_settings.debug)&&this.options.search_settings.debug===true){return true}else{return false}},manageHardcodedSettings:function(u,t){if("Recent_Content_Delta_Time"===u){if(!this.getOption("deactivate_checks")){if(t>30){t=5}else{if(t<1){t=5}}}}else{if("defaultViewModeAfterCacheCleaning"===u){var w=t.toLowerCase();if(w==="table"||w==="grid"){t="table"}else{if(this.options.search_settings.simple_search_experience!==true){t="thumbnail"}}if(this.getOption("newSearch19xFD02")===true&&this.getOption("predefinedBetaUser")===true){if(this.options.search_settings.simple_search_experience===true){t="tilebig"}}if(this.getOption("OneSearch")===true&&(t==="table"||t==="tile")){var s;var p=/iPhone/.test(navigator.userAgent)&&!window.MSStream;var q=/iPad/.test(navigator.userAgent)&&!window.MSStream;var r=/Android/.test(navigator.userAgent)&&!window.MSStream;s=p?"iphone":(q?"ipad":"")||(r?"android":"");if(["iphone","ipad","android"].indexOf(s)!==-1){var v=screen.availWidth;if(h.is(v)){if(v<1023){t="tilebig"}}}}}else{if("max_selection_for_selectall"===u||"max_selection_for_actions"===u){if(!h.is(t)){t=200}if(t>1000){t=1000}else{if(t<1){t=200}}}}}return t},getOptionPerTenant:function(r,p){var q=null;if(UWA.is(r)&&UWA.is(p,"object")&&UWA.is(p.tenant,"string")&&p.tenant.length>0&&UWA.is(this._tenantSettings[p.tenant])&&UWA.is(this._tenantSettings[p.tenant].search_settings)&&UWA.is(this._tenantSettings[p.tenant].search_settings[r])){q=this._tenantSettings[p.tenant].search_settings[r]}if(!UWA.is(q)){if(UWA.is(r)&&UWA.is(p,"object")&&UWA.is(p.tenant,"string")&&p.tenant.length>0&&UWA.is(this._tenantSettings[p.tenant])&&UWA.is(this._tenantSettings[p.tenant][r])){q=this._tenantSettings[p.tenant][r]}}return q},getOption:function(r,p){var q=b.getenv(r);if(UWA.is(this.options)){var s=null;if(this.options.url_search_settings.ignoreAdminSettings!==true){s=this.getOptionPerTenant(r,p)}if(UWA.is(this.options.url_search_settings[r])){return this.options.url_search_settings[r]}else{if(p===true&&UWA.is(this.options.search_settings_odt)){return this.options.search_settings_odt[r]}else{if(UWA.is(window.dscef)&&UWA.is(window.dscef.getEnv,"function")&&h.is(window.dscef.getEnv(r),"string")&&window.dscef.getEnv(r).length>0){return window.dscef.getEnv(r)}else{if(UWA.is(this.options.search_settings)&&UWA.is(this.options.search_settings[r])){var q=this.options.search_settings[r];if(UWA.is(s)){q=s}q=this.manageHardcodedSettings(r,q);return q}else{if(UWA.is(s)){q=this.manageHardcodedSettings(r,s);return q}else{if(UWA.is(this.options[r])){return this.options[r]}}}}}}}else{return undefined}},_loadSettings:function(q){var t=this;var v={};var p={timeout:50000,method:"GET",data:v,type:"json",headers:{Accept:"application/ds-json"},onComplete:function(y){t.log("SearchSettings load settings onComplete");var w={},x={};if(h.is(y,"string")){w=JSON.parse(y)}else{w=y}if(w.error){t.log("Bad format for SearchSettings")}else{t.initialize(w)}t.loadComplete=true;if(h.is(t.onCompleteLoad,"function")){t.onCompleteLoad.call(undefined,null)}t.log("Available Search Settings:\n"+JSON.stringify(t.options))},onFailure:function(w){h.log("No settings found");if(h.is(t.onCompleteLoad,"function")){t.onCompleteLoad.call(undefined,null)}},onTimeout:function(w){t.log("No settings found timeout reach")}};try{if(!n(q)){var s="";s=c.getWebappsBaseUrl();var r=/\/$/;s=s.replace(r,"");this.log("Base URL "+s);if(!n(s)){this.log("The base URL is not a valid one (webapp context?)");s=""}q=s+q}this.log("Used URL "+q);m.request(q,p)}catch(u){this.log("Failure : "+u)}},getSettingsToDisplayInUI:function(){var t=[];if(h.is(this.options.search_settings.searchOptionsDisplayedInUI,"array")){t=this.options.search_settings.searchOptionsDisplayedInUI}for(var q=t.length-1;q>=0;q--){var r=t[q];if(h.is(r)&&h.is(r.optionID)){var w=r.optionID;var u=o.get(w);var x=o.get(w+".tooltip");r.optionLabel=u;r.optionTooltip=x;if(h.is(r.moreOptions,"array")){var v=r.moreOptions;for(var p=0;p<v.length;p++){var s=v[p];if(h.is(s)&&h.is(s.optionID)){var w=s.optionID;var u=o.get(w);var x=o.get(w+".tooltip");s.optionLabel=u;s.optionTooltip=x;s.father=w;t.push(s)}}r.moreOptions=undefined;if(this.getDebug()===false){t[q]=undefined}}}}return t},_loadTenantSettings:function(p){var q=this;if(!q._tenantSettingsPC[p]){q._tenantSettingsPC[p]=g.deferred();q._tenantSettings[p]={};e.getSearchSettings({tenantID:p}).then(function(r){if(UWA.is(r)){q._initializeIrrelevantTags(p,r);Object.keys(r).forEach(function(s){var t=r[s];if("relevant_tags"===s){if(UWA.is(t,"object")&&Object.keys(t).length>0){q._tenantSettings[p][s]=t}}else{q._tenantSettings[p][s]=t}})}q._tenantSettingsPC[p].resolve()},function(){q._tenantSettingsPC[p].resolve()})}},_initializeIrrelevantTags:function(p,v){var x=this;console.log("Initializing irrelevant_tags from SCC relevant_tags");if(UWA.is(v)&&UWA.is(v.relevant_tags)){var s=v.relevant_tags;var r=[];var w=Object.keys(s);for(var u=0;u<w.length;u++){if(UWA.is(w[u],"string")){var q=s[w[u]];if(UWA.is(q)&&UWA.is(q.weight)&&-1===q.weight){console.log("Adding key",w[u]," in irrelevant_tags setting");r.push(w[u]);console.log("Deleting key",w[u]," from relevant_tags setting");delete v.relevant_tags[w[u]]}}}x._tenantSettings[p]["irrelevant_tags"]=r}else{if(!UWA.is(v)){console.log("SCC setting is undefined")}else{if(!UWA.is(v.relevant_tags)){console.log("relevant_tags key not found in SCC settings")}}}},getTenantSettings:function(p){this._loadTenantSettings(p);return this._tenantSettingsPC[p].promise},_resolveTenantSettings:function(p){this._tenantSettingsPC[p]=g.deferred();this._tenantSettingsPC[p].resolve()},changeSettingForFD01:function(){if(this.getOption("enableNewSearchViews")!==true){if(!h.is(this.options.search_settings.keepOldSearchViews)){this.options.search_settings.keepOldSearchViews=true}if(h.is(this.options.search_settings.informationsPanel)){this.options.search_settings.informationsPanel=false}if(h.is(this.options.search_settings.propertyTabsAsAccordeon)){this.options.search_settings.propertyTabsAsAccordeon=false}}},changeSettingForBETA:function(){var p={};var q=d.getOption("results_perpage_beta");if(UWA.is(q,"number")){p.results_perpage=q}p.propertyTabsAsAccordeon=true;p.contentsLocation_FUN072059=true;p.keepOldSearchViews=false;this.log("Overridig the settings for beta "+JSON.stringify(p));this.initialize({search_settings:p})},changeSettingForBETA_deactivated:function(q){var p=q||{};this.log("Overridig the settings when beta option is available but deactivated: "+JSON.stringify(p));this.initialize({search_settings:p})},changeSettings:function(p){this.initialize({search_settings:p})},setCompactMode:function(p){if(!h.is(this.options.search_settings)){return}var q=p;if(!h.is(q)){q=true}this.options.search_settings.simple_search_experience=true;this.options.search_settings.search_compact_mode=q;this.options.search_settings.NoadvOnMenu=q;this.options.search_settings.NofavoritesOnMemu=q;this.options.search_settings.NoPQMenu=q;this.options.search_settings.show_last_indexation_time=!q}});return d});define("DS/SNInfraUX/SWFiltering",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/SNInfraUX/SearchSettings"],function(b,e,a,d){var c=e.singleton(a,{_select_predicates:null,_select_exclude_synthesis:null,_additional_criteria:null,_specificSourceParameter:null,init:function(f){},setSelectPredicates:function(f){if(UWA.is(f)){if(UWA.is(f,"string")){f=b.Json.decode(f)}if(UWA.is(f,"array")){this._select_predicates=f}}},getSelectPredicates:function(){return this._select_predicates},isAVisiblePredicate:function(f){var g=true;if(UWA.is(this._select_predicates,"array")){if(-1===this._select_predicates.indexOf(f)){g=false}}return g},setSelectExcludeSynthesis:function(f){if(UWA.is(f)){if(UWA.is(f,"string")){f=b.Json.decode(f)}if(UWA.is(f,"array")){this._select_exclude_synthesis=f}}},getSelectExcludeSynthesis:function(){return this._select_exclude_synthesis},setAdditionalQueryCriteria:function(f){if(UWA.is(f,"string")){this._additional_criteria=f}},getAdditionalQueryCriteria:function(){return this._additional_criteria},setSpecificSourceParameter:function(f){if(UWA.is(f)){this._specificSourceParameter=f}},getSpecificSourceParameter:function(){return this._specificSourceParameter},clear:function(){this._select_predicates=null;this._select_exclude_synthesis=null;this._additional_criteria=null;this._specificSourceParameter=null}});return c});define("DS/SNInfraUX/Logger",[],function(){function a(f){var e,b,g,i,d,h;if(typeof f!=="boolean"){f=false}b=f;if(window){g=window}else{if(global){g=global}else{g={}}}this.disable=function(){b=false;return this};function c(j){return function(){if(!b){return}if(g.console){if(typeof g.console[j]==="function"){if(g.searchLogs||j!=="log"){return g.console[j].apply(g.console,Array.prototype.slice.call(arguments))}}if(typeof g.console[j]!=="function"){if(typeof g.console[j]==="object"&&j!=="debug"){if(g.searchLogs){return g.console[j](Array.prototype.slice.call(arguments))}}}}else{if(g.opera&&typeof g.opera.postError==="function"){if(g.searchLogs){return g.opera.postError.apply(null,Array.prototype.slice.call(arguments))}}}}}h=["log","info","warn","error","debug","group","groupEnd"];for(i=0,d=h.length;i<d;i++){e=h[i];this[e]=c(e)}}return new a(true)});define("DS/SNInfraUX/SearchControlCenterFetchService",["UWA/Element","UWA/Core","UWA/Promise","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(f,b,d,a,e){var c={_FetchSearchSettings_promise:d.deferred(),_searchControlCenterSettingsJSONFromDB:{},_tenantObjects:{},getSearchSettings:function(g){var i=null;var h=null;if(UWA.is(g.tenantID)){i=g.tenantID}if(UWA.is(g.key)){h=g.key}this.loadSearchSettings(h,i);return this._FetchSearchSettings_promise.promise},transalateToSearchFormat:function(ab){var H={};var P=[];var R=[];var B=c._searchControlCenterSettingsJSONFromDB;if(b.is(ab,"string")){if(b.is(B)&&(ab==="SCC_UI")){H=B}}else{if(b.is(B)&&!b.is(ab)){var Y=Object.keys(B);if(Y.length>0){var h,A,M;if(B.hasOwnProperty("search_settings")){h=B.search_settings}if(B.hasOwnProperty("type_custo")){A=B.type_custo}if(B.hasOwnProperty("attribute_custo")){M=B.attribute_custo}if(b.is(h)&&b.is(A)){var u={};var x={};var p=[];if(A.hasOwnProperty("excluded_types")&&(A.type_display===true)){var aa=A.excluded_types;for(var O=0;O<aa.length;O++){var t=aa[O].source;var o=aa[O].uri;if(x.hasOwnProperty(t)){p=x[t];p.push(o)}else{p.push(o);x[t]=p}}u.types=x}if(h.hasOwnProperty("simple_search_experience")){delete h.simple_search_experience}h.topbar_search_banned_list=u;H.search_settings=h}var v={};if(b.is(A)&&b.is(M)){var E=true;if(A.hasOwnProperty("default_datasourceandtype")){var X=A.default_datasourceandtype;if(X.length>0){v.default_datasource=X[0].source}}if(M.hasOwnProperty("ds6w:type")&&M.attributes_display===true){var D={};var K=M["ds6w:type"];if(b.is(K,"array")){for(var z=0;z<K.length;z++){var y={};var t=K[z].source;if(t==="AllDataSourcesandTypes"){E=false;P=K[z].predicates;R=K[z].excluded_predicates}else{y.uri=K[z].uri;y.predicates=K[z].predicates;y.excluded_predicates=K[z].excluded_predicates;if(D.hasOwnProperty(t)){var Z=D[t];Z.push(y)}else{var F=[];F.push(y);D[t]=F}}}}v["ds6w:type"]=D}if(!M.hasOwnProperty("ds6w:type")||(E===true)){P.push({uri:"ds6w:dataSource"});P.push({uri:"ds6w:type"});P.push({uri:"ds6w:category"});P.push({uri:"ds6w:modified"});P.push({uri:"ds6w:lastModifiedBy"});P.push({uri:"ds6w:responsible"})}if(A.hasOwnProperty("easyTypeAccess")&&A.type_display===true){var L=A.easyTypeAccess;for(var W=0;W<L.length;W++){var l=L[W];var t=l.source;var o=l.uri;if(v.hasOwnProperty("ds6w:type")){var g=v["ds6w:type"];if(b.is(g)&&g.hasOwnProperty(t)){var q=g[t];if(b.is(q,"array")){var n=-1;for(var V=0;V<q.length;V++){var y=q[V];if(o===y.uri){y.easyTypeAcess=true;n=V}}if(n==-1){var s={};s.uri=o;s.easyTypeAcess=true;q.push(s)}else{q.push(q.splice(n,1)[0])}}}else{var Q={};var U=[];Q.uri=o;Q.easyTypeAcess=true;U.push(Q);g[t]=U}}else{var G={};var I={};var N=[];I.uri=o;I.easyTypeAcess=true;N.push(I);G[t]=N;v["ds6w:type"]=G}}}}H.search_settings["advanced_search"]=v}}}if(b.is(P,"array")||(b.is(R,"array"))){var r={};if(b.is(P,"array")){for(var T=0;T<P.length;T++){var w=false;if((P[T].uri==="ds6w:type")||(P[T].uri==="ds6w:dataSource")||(P[T].uri==="ds6w:project")||(P[T].uri==="ds6w:community")){w=true}var J={relevant:true,expanded:w,weight:100-T};r[P[T].uri]=J}}r["ds6w:who"]={relevant:true,expanded:true,weight:6};r["ds6w:when"]={relevant:true,expanded:true,weight:5};r["ds6w:what"]={relevant:true,expanded:true,weight:4};r["ds6w:where"]={relevant:true,expanded:true,weight:3};r["ds6w:why"]={relevant:true,expanded:true,weight:2};r["ds6w:how"]={relevant:true,expanded:true,weight:1};if(b.is(R,"array")){for(var S=0;S<R.length;S++){var C={relevant:true,expanded:false,weight:-1};r[R[S].uri]=C}}H.relevant_tags=r}return H},setResourceMgt:function(g){if(b.is(g,"object")){if(g.hasOwnProperty("available_tenants")){c._tenantObjects=g.available_tenants}}},get3DSpaceURL:function(j){var g=null;if(b.is(j)&&b.is(c._tenantObjects)){if(c._tenantObjects.hasOwnProperty(j)){var i=c._tenantObjects[j];if(b.is(i)&&i.hasOwnProperty("sources")){var h=i.sources;if(b.is(h)&&h.hasOwnProperty("cstorage")){if(b.is(h.cstorage.url,"string")){g=h.cstorage.url}}}}}return g},loadSearchSettings:function(i,h){var g=i;e.getServiceUrl({serviceName:"3DSpace",platformId:h,onComplete:function(l){if(UWA.is(l,"string")){c.getURL=l+"/resources/SNAPI/infra_services/searchsettings?tenant="+h;var k={timeout:50000,method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){var m=UWA.is(n,"string")?JSON.parse(n):n;c._searchControlCenterSettingsJSONFromDB=m;var o=c.transalateToSearchFormat(g);if(b.is(o)){c._FetchSearchSettings_promise.resolve(o)}},onFailure:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)},onTimeout:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)}};a.authenticatedRequest(c.getURL,k)}else{if(!b.is(g)){var j=c.get3DSpaceURL(h);if(b.is(j)){c.getURL=j+"/resources/SNAPI/infra_services/searchsettings?tenant="+h;var k={timeout:50000,method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){var m=UWA.is(n,"string")?JSON.parse(n):n;c._searchControlCenterSettingsJSONFromDB=m;var o=c.transalateToSearchFormat(g);if(b.is(o)){c._FetchSearchSettings_promise.resolve(o)}},onFailure:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)},onTimeout:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)}};a.authenticatedRequest(c.getURL,k)}else{console.log("getServiceUrl - By-pass URL is empty, ISSUE !!");c._FetchSearchSettings_promise.reject()}}else{console.log("getServiceUrl was success, but URL is empty, ISSUE !!");c._FetchSearchSettings_promise.reject()}}},onFailure:function(l){if(!b.is(g)){var j=c.get3DSpaceURL(h);if(b.is(j)){c.getURL=j+"/resources/SNAPI/infra_services/searchsettings?tenant="+h;var k={timeout:50000,method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){var m=UWA.is(n,"string")?JSON.parse(n):n;c._searchControlCenterSettingsJSONFromDB=m;var o=c.transalateToSearchFormat(g);if(b.is(o)){c._FetchSearchSettings_promise.resolve(o)}},onFailure:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)},onTimeout:function(m){console.log("Response from server :: "+m);c._FetchSearchSettings_promise.reject(m)}};a.authenticatedRequest(c.getURL,k)}else{console.log("URL building fails inside SearchControlCenterFetchService also By-pass URL is empty, ISSUE !!");c._FetchSearchSettings_promise.reject()}}else{console.log("URL building fails inside SearchControlCenterFetchService!!");c._FetchSearchSettings_promise.reject(l)}}})},};return c});define("DS/SNInfraUX/SearchPreferences",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/SNInfraUX/SearchSettings","DS/i3DXCompass/Data"],function(b,f,a,c,d){var e=f.singleton(a,{preferences:{},dateDisplayMode:{},init:function(){var g=this;this._restoreDataFromLocalStorage();this.getPreference({name:"dateDisplayMode",onComplete:function(h){g.dateDisplayMode=h},onFailure:function(){return null;console.log("fail to get data")}})},_restoreDataFromLocalStorage:function(){if(!b.is(localStorage)){return}var h=localStorage.getItem("searchPreferences");if(b.is(h)){try{this.preferences=JSON.parse(h)}catch(g){console.error("Error parsing searchPreferences:",g)}}if(!b.is(this.preferences)){this.preferences={}}},setItem:function(g,h){if(!b.is(localStorage)){return}this.preferences[g]=UWA.clone(h)},removeItem:function(g){if(!b.is(localStorage)){return}delete this.preferences[g]},getItem:function(k){if(!b.is(localStorage)){return}var m=localStorage.getItem("updateToDo");if(b.is(m)&&"true"===m){this._restoreDataFromLocalStorage();localStorage.removeItem("updateToDo")}var l=this.preferences[k];if(!b.is(l)){if(!b.is(this.uiSettings)){if(b.is(c)){this.uiSettings={};var j=c.getSettingsToDisplayInUI();if(b.is(j,"array")&&j.length>0){for(var h=0,g=j.length;h<g;h++){if(b.is(j[h])&&b.is(j[h].optionID)&&b.is(j[h].optionDefaultValue)){this.uiSettings[j[h].optionID]=j[h].optionDefaultValue;if(b.is(c.getOption(j[h].optionID))&&c.getOption(j[h].optionID)!=j[h].optionDefaultValue){console.log("Default value for "+j[h].optionID+" in searchOptionsDisplayedInUI overloaded with value="+c.getOption(j[h].optionID));this.uiSettings[j[h].optionID]=c.getOption(j[h].optionID)}}}}l=this.uiSettings[k]}}else{l=this.uiSettings[k]}}return l},commit:function(g){localStorage.setItem("searchPreferences",JSON.stringify(this.preferences));var h={};if(c.getOption("newSearch19xFD02")===true&&c.getOption("predefinedBetaUser")===true){if(b.is(this.preferences.simple_search_experience)){h.simple_search_experience=this.preferences.simple_search_experience}}h.revisionDisplayType=this.preferences.revisionDisplayType;h.find_in_this_tab_default=this.preferences.find_in_this_tab_default;this.setPreference({name:"3DSearchOptions",value:JSON.stringify(h),onComplete:g?g.onComplete:undefined,onFailure:g?g.onFailure:undefined})},setPreference:function(h){if(b.is(d,"object")&&!b.is(d.setPreferencesUrl,"string")){if(b.is(window.COMPASS_CONFIG,"object")){d.initialize({lang:COMPASS_CONFIG.lang,userId:COMPASS_CONFIG.userId,myAppsBaseUrl:COMPASS_CONFIG.myAppsBaseUrl,passportUrl:"",proxyTicketUrl:""})}}if(!b.is(d.setPreferencesUrl)){return}var g={url:d.setPreferencesUrl,urlParams:{name:h.name,value:h.value},onComplete:function(i){if(i&&i.code===0){if(h&&h.onComplete){h.onComplete()}}else{if(h&&h.onFailure){h.onFailure()}}},onFailure:function(j,i){if(h&&h.onFailure){h.onFailure()}}};d.request(g)},getPreference:function(i){var h=this;if(b.is(d,"object")&&!b.is(d.getPreferencesUrl,"string")){if(b.is(window.COMPASS_CONFIG,"object")){d.initialize({lang:COMPASS_CONFIG.lang,userId:COMPASS_CONFIG.userId,myAppsBaseUrl:COMPASS_CONFIG.myAppsBaseUrl,passportUrl:"",proxyTicketUrl:""})}}if(!b.is(d.getPreferencesUrl)){return}var g={url:d.getPreferencesUrl,urlParams:{name:i.name},onComplete:function(j){if(!b.is(j)){j={}}if(c.getOption("newSearch19xFD02")===true&&c.getOption("predefinedBetaUser")===true){if(b.is(j.simple_search_experience)){h.preferences.simple_search_experience=j.simple_search_experience}}if(UWA.is(j.find_in_this_tab_default)){h.preferences.find_in_this_tab_default=j.find_in_this_tab_default}if(UWA.is(j.revisionDisplayType)){h.preferences.revisionDisplayType=j.revisionDisplayType}if(i&&i.onComplete){i.onComplete(j)}},onFailure:function(k,j){if(i&&i.onFailure){i.onFailure()}}};d.request(g)}});return e});define("DS/SNInfraUX/SearchPreviewContainer",["UWA/Core","UWA/Class/Model"],function(b,a){var c=a.extend({init:function(d){},getPrimaryContent:function(d){if(!b.is(d)||!b.is(d.searchmodel)){return}if(b.is(d.onFailure,"function")){d.onFailure.call()}},getSecondaryContent:function(d){if(!b.is(d)||!b.is(d.searchmodel)){return}if(b.is(d.onFailure,"function")){d.onFailure.call()}},Open:function(e){if(!b.is(e)||!b.is(e.searchmodel)||!b.is(e.widget_id)||!b.is(this.getAppIdForOpen,"function")){return}var d={searchmodel:e.searchmodel,widget_id:e.widget_id,onComplete:function(g){var f="DS/i3DXCompassServices/i3DXCompassPubSub";require([f],function(h){h.publish("launchApp",{appId:g})})},onFailure:function(){that.log("this type is not available for Open")}};this.getAppIdForOpen(d)},dispose:function(d){}});return c});define("DS/SNInfraUX/SNPLMDictionary",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Options","DS/WAFData/WAFData","UWA/Promise"],function(c,g,b,e,a,d){var f=g.singleton(b,e,{_dictionaryPromise:null,_dimensions:{},_mksUnitName:{},_mksUnit:{},init:function(h){},_createDictionaryPromise:function(){if(this._dictionaryPromise==null){var i=this.getOption("resources");if(c.is(i)){var h=this;this._dictionaryPromise=new d(function(l,k){var j=i.getFetchOptions({service_name:"listDimensions",});j.onComplete=function(p){var n;if(c.is(p,"string")){n=JSON.parse(p)}else{n=p}var r=n.results;if(UWA.is(r)){for(var q=0;q<r.length;q++){var m=r[q];h._dimensions[m.Name]=m;var o=m.MKSUnit;h._mksUnitName[m.Name]=o;var s=m.Units.filter(function(t){return t.Name==o});if(s.length>0){h._mksUnit[m]=s[0]}}}l.call()};j.onFailure=function(n,m){console.log("FAILED to load Dimensions ");l.call()};a.authenticatedRequest(j.url,j)})}}},setResources:function(h){this.setOptions(h)},loadDictionary:function(h){this._createDictionaryPromise();if(c.is(h)){this._dictionaryPromise.then(h)}return this._dictionaryPromise},getMKSNLSForDimension:function(l){var i=this._dimensions[l];if(c.is(i)){var j=i.MKSUnit;var k=i.Units.filter(function(m){return m.Name==j});if(k.length>0){var h=k[0];return h.NLSName}}return""},getUnitNLSForDimension:function(l,i){var h=this._dimensions[l];if(c.is(h)){var k=h.Units.filter(function(m){return m.Name==i});if(k.length>0){var j=k[0];return j.NLSName}}return""},getMKSNLSLableNameForDimension:function(l){var i=this._dimensions[l];if(c.is(i)){var j=i.MKSUnit;var k=i.Units.filter(function(m){return m.Name==j});if(k.length>0){var h=k[0];return h.label}}return""},getMKSNLSNameForDimension:function(l){var i=this._dimensions[l];if(c.is(i)){var j=i.MKSUnit;var k=i.Units.filter(function(m){return m.Name==j});if(k.length>0){var h=k[0];return h.Name}}return""},loadConvertedMKSValues:function(i,k){var j=this.getOption("resources");if(!c.is(j)){throw ("INVALID STATE: loadConvertedMKSValues is called before doing setResources")}var h=j.getFetchOptions({service_name:"getConvertedMKSValues",service_data:i});h.onComplete=function(n){var m=c.is(n,"string")?JSON.parse(n):n;if(c.is(k,"function")){var l=m.Response;k.call(undefined,l)}};h.onFailure=function(m,l){console.log("Failure loaded the converted MKS values for : "+l);k.call(undefined,[])};a.authenticatedRequest(h.url,h)},getMKSUnitNameForDimensionName:function(h){return this._mksUnitName[h]}});return f});define("DS/SNInfraUX/PredefinedQueries",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Options","DS/WAFData/WAFData","UWA/Promise"],function(d,g,c,f,b,e){var a=g.singleton(c,f,{_PQDictionary:{},_pqFetchPC:e.deferred(),_PQs:null,_PQNLS:null,init:function(){},setResources:function(h){this.setOptions({resources:h})},fetchPQsFromServer:function(k){if(k){this.setResources(k)}var j=this;if(!j._pqFetchInitiated){j._pqFetchInitiated=true;var k=this.getOption("resources");if(!d.is(k)){console.error("INVALID STATE: getPQs is called before doing setResources on PredefinedQueries");return null}var i=k.get3DSpaceUrl();if(UWA.is(i,"string")&&i.length>0){var h=k.getFetchOptions({service_name:"loadPQData",});h.onComplete=function(n){var m;if(d.is(n,"string")){m=JSON.parse(n)}else{m=n}var l=m.pqlist;if(d.is(m.custom)){var s=m.custom;for(var p=0,r=s.PQ.length;p<r;p++){var q=s.PQ[p];q.custom=true}j.mergeRecursive(l,m.custom)}if(UWA.is(l)){j._PQs=l;j.loadPQDictionary(l)}var o=m.nls;if(d.is(m.customnls)){j.mergeRecursive(o,m.customnls)}j._PQNLS=m.nls;j._pqFetchPC.resolve()};h.onFailure=function(m,l){console.log("FAILED to load PQ data ");j._pqFetchPC.resolve()};b.authenticatedRequest(h.url,h)}else{console.warn("3DSpace URL not found, PQs are not fetched..");j._pqFetchPC.resolve()}}return this._pqFetchPC.promise},mergeRecursive:function(j,i){for(var h in i){if(i.hasOwnProperty(h)){if(UWA.is(j[h],"array")){j[h]=j[h].concat(i[h])}else{if(UWA.is(j[h],"object")&&UWA.is(i[h],"object")){this.mergeRecursive(j[h],i[h])}else{if(!j[h]){j[h]=i[h]}else{}}}}}},getPQFetchPromise:function(){return this._pqFetchPC.promise},loadPQDictionary:function(h){var p=undefined;if(UWA.is(h)){for(var n=0;n<h.PQ.length;n++){var m=h.PQ[n].abbreviations;if(UWA.is(m)){var k=m.split(",");for(var l=0;l<k.length;l++){var q=k[l];var o=q.toLowerCase();if(UWA.is(h.PQ[n].sort_order)){p=h.PQ[n].sort_order;if(1==p.length){p=p[0]}}var r={pqPrefix:q,value:h.PQ[n].value,pqName:k[k.length-1],pqid:h.PQ[n].pqid,appData:h.PQ[n].appData,sort_order:p};this._PQDictionary[o]=r}}}}},isAPQAbbrevation:function(j){var i=j.toString().toLowerCase();if(i=="type"){return false}var h=i in this._PQDictionary;return h},isAPQSearch:function(h){var i=null;if(UWA.is(h)){var j=h.match(/[\s\b]*\w+:/g);if(UWA.is(j)){for(var k=0;k<j.length;k++){var l=j[k].match(/\w+/g);if(this.isAPQAbbrevation(l)){i=l;break}}}}return i},isAPrefixedPQSearch:function(h){if(UWA.is(h)&&/^3dexp/.test(h)){h=h.substring(5);return this.isAPQSearch(h)}},getSortOrder:function(h){var i=h.toString().toLowerCase();return this._PQDictionary[i].sort_order},getPQPrefix:function(h){var i=h.toString().toLowerCase();return this._PQDictionary[i].pqPrefix},getPQName:function(h){var i=h.toString().toLowerCase();return this._PQDictionary[i].pqName},getPQs:function(){return this._PQs},getPQNLS:function(){return this._PQNLS},getPQObjFromPQPrefix:function(i){var j=i.toString().toLowerCase();var h=this._PQDictionary[j];return h}});return a});define("DS/SNInfraUX/SearchDebug",["UWA/Core","UWA/Class/Debug","DS/SNInfraUX/SearchSettings"],function(d,a,c){var b=a.extend({_check_activated:false,log:function(e){if(this._check_activated===false){this.setDebugMode(c.debugMode);this._check_activated=true}return this._parent(String.prototype.format.apply("{0}: {1}".format(d.is(this.uwaClassName,"string")?this.uwaClassName:"[UNKNOWN]",e),[].slice.call(arguments,1)))}});return b});define("DS/SNInfraUX/SearchLogin",["UWA/Core","UWA/Class","DS/WAFData/WAFData","UWA/Promise","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/Logger"],function(d,g,a,c,f,b){var e=g.singleton({_loginPromises:{},_cacheLoginData:{},_serviceToSourceMapping:null,login:function(h){var i=this;var k="";var j="";if(d.is(h,"object")){if(d.is(h.tenantID)){k=h.tenantID}else{if(d.is(h.resources)){k=h.resources.getActiveTenant()}}if(d.is(h.fedSearchURL)){j=h.fedSearchURL}else{if(d.is(h.resources)){j=h.resources.getFedSearchUrl(k)}}}if(d.is(k,"string")){var l=this._loginPromises[k];if(!l){this._loginPromises[k]=new c(function(o,n){i._cacheLoginData[k]=[];var m={};m.method="GET";m.headers={Accept:"application/json","Content-Type":"application/json"};m.data={tenant:k};m.url=i._buildFedSearchLoginURL(j);m.onComplete=function(q){b.log("FedSearch login succcessful with platform : "+k);var p=d.is(q,"string")?(q.length>0?JSON.parse(q):{}):q;if(d.is(p.infos)&&d.is(p.infos.sources,"array")){var r=p.infos.sources;i.updateServiceToSourceMapping(k,r);o()}else{b.error("/federated/login WS response is not in expected format");n()}};m.onFailure=function(q,p){b.error("FedSearch login FAILED with platform : "+k,q,p);if(!i._serviceToSourceMapping){i._serviceToSourceMapping={}}if(!d.is(i._serviceToSourceMapping["3dspace"])){i._serviceToSourceMapping["3dspace"]="3DSpace"}if(!d.is(i._serviceToSourceMapping.swym)){i._serviceToSourceMapping.swym="3DSwym"}if(!d.is(i._serviceToSourceMapping.drive)){i._serviceToSourceMapping.drive="3DDrive"}if(!d.is(i._serviceToSourceMapping.dropbox)){i._serviceToSourceMapping.dropbox="3DDrive"}if(!d.is(i._serviceToSourceMapping.googledrive)){i._serviceToSourceMapping.googledrive="3DDrive"}if(!d.is(i._serviceToSourceMapping.onedrive)){i._serviceToSourceMapping.onedrive="3DDrive"}if(!d.is(i._serviceToSourceMapping.dashboard)){i._serviceToSourceMapping.dashboard="3DDashboard"}if(!d.is(i._serviceToSourceMapping["3dspace"])){i._serviceToSourceMapping["3dspace"]="3DSpace"}n()};if(d.is(h.resources)&&(h.resources.is_odt_source()===true)){b.warn("No action retrieved in ODT mode");o()}else{a.authenticatedRequest(m.url,m)}})}this._loginPromises[k].then(function(){h.onComplete.call(undefined,i._cacheLoginData[k])},function(){h.onFailure.call(undefined,i._cacheLoginData[k])})}},getAvailableSources:function(h){return this._cacheLoginData[h]},getServiceFromSource:function(h){if(d.is(this._serviceToSourceMapping)){return this._serviceToSourceMapping[h]}},getDiscoveryURL:function(h,l){var i=undefined;if(d.is(this._cacheLoginData)){var j=this._cacheLoginData[h];if(d.is(j,"array")){for(var k=0;k<j.length;k++){if(l===j[k].name){i=j[k].FSearchAppDiscovery_url}}}}return i},_buildFedSearchLoginURL:function(h){var i="";if(-1===h.lastIndexOf("/federated")){h+="/federated"}i=h+"/login";return i},updateServiceToSourceMapping:function(n,l){if(!d.is(n,"string")||n.length===0||!d.is(l,"array")){b.error("Bad arguments used in updateServiceToSourceMapping:",n,l);return}if(!d.is(this._cacheLoginData[n])){this._cacheLoginData[n]=l}else{for(var h=0,k=l.length;h<k;h++){var j=false;for(var m=0,o=this._cacheLoginData[n].length;m<o;m++){if(d.is(this._cacheLoginData[n][m])&&d.is(l[h])&&this._cacheLoginData[n][m].name===l[h].name&&this._cacheLoginData[n][m].name){j=true}}if(false===j){this._cacheLoginData[n].push(l[h])}}}if(!this._serviceToSourceMapping){this._serviceToSourceMapping={}}for(var p=0;p<l.length;p++){var i=l[p];if(d.is(i,"object")&&d.is(i.name,"string")&&i.name.length>0&&d.is(i.service,"string")&&i.service.length>0){this._serviceToSourceMapping[i.name]=i.service}}if(l.length===1&&d.is(l[0],"object")&&d.is(l[0].service,"string")&&l[0].service.length>0){f.options.search_settings.service=l[0].service}}});return e});define("DS/SNInfraUX/ServiceDelegationLoader",["UWA/Core","UWA/Class","UWA/Promise","DS/WAFData/WAFData","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchLogin","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(c,h,b,a,e,d,g){var f=h.singleton({_loaderPromises:{},_cacheServiceDelegation:{},_discoverPromises:{},_cacheDiscovery:{},load:function(i){var j=this;if(UWA.is(i,"object")&&UWA.is(i.serviceID,"string")){var k=this._loaderPromises[i.serviceID];if(!k){k=new b(function(n,m){j._cacheServiceDelegation[i.serviceID]=null;var o;if(UWA.is(i.servicesData)){o=i.servicesData}else{o=e.getOption("servicesData")}var q=o[i.serviceID];var p;var l;if(UWA.is(q,"object")){p=q.module;l=q.relativePath}else{if(UWA.is(q,"string")){p=q;l="/webapps"}}if(UWA.is(p,"string")){require([p],function(r){j._cacheServiceDelegation[i.serviceID]=r;n(j._cacheServiceDelegation[i.serviceID])},function(r){console.warn("Cannot load service delegation"+r.requireModules);requirejs.undef(p);var t=p.split("/");if(UWA.is(t,"array")&&t.length>2){var s=function(w){var v=t[0]+"/"+t[1];var x=w+l;x+="/"+t[1];var u={};u[v]=x;require.config({paths:u});require([p],function(y){j._cacheServiceDelegation[i.serviceID]=y;n(j._cacheServiceDelegation[i.serviceID])},function(y){console.warn("Cannot load service delegation "+y.requireModules);m("Cannot load service delegation, error="+y.requireModules)})};if(UWA.is(i.serviceURL,"string")){s(i.serviceURL)}else{g.getServiceUrl({serviceName:i.serviceID,platformId:i.platformID,onComplete:function(u){s(u)},onFailure:function(){m("FAILED to retrieve service URL for "+i.serviceID)}})}}else{m("Service delegation not registered in good format, found "+p)}})}else{m("Service delegation not registered for "+i.serviceID)}});this._loaderPromises[i.serviceID]=k}return k}},discover:function(i){if(UWA.is(i,"object")&&UWA.is(i.platformID,"string")&&UWA.is(i.sourceID)){var k=this;var j=d.getDiscoveryURL(i.platformID,i.sourceID);if(UWA.is(j,"string")){if(!this._discoverPromises[i.platformID]){this._discoverPromises[i.platformID]={};this._cacheDiscovery[i.platformID]={}}var l=this._discoverPromises[i.platformID][i.sourceID];if(!l){l=new b(function(n,m){k._cacheDiscovery[i.platformID][i.sourceID]=null;var o={};o.method="GET";o.headers={Accept:"application/json",};o.data={tenant:i.platformID};o.url=j;o.onComplete=function(q){console.log("discovery call succcessful for "+i.sourceID+" for tenant : "+i.platformID);var p=c.is(q,"string")?(q.length>0?JSON.parse(q):{}):q;if(UWA.is(p,"object")){k._cacheDiscovery[i.platformID][i.sourceID]=p;n(k._cacheDiscovery[i.platformID][i.sourceID])}else{console.error("discovery WS response is not in expected format");m()}};o.onFailure=function(q,p){console.log("discovery call FAILED for "+i.sourceID+" for tenant : "+i.platformID);m()};a.authenticatedRequest(o.url,o)});this._discoverPromises[i.platformID][i.sourceID]=l}return l}else{console.log("discoveryURL not found for "+i.sourceID+"for tenant "+i.platfromID)}}},getRealtivePath:function(i){var j=e.getOption("servicesData");var k=j[i.serviceID];if(UWA.is(k,"object")){return k.relativePath}else{if(UWA.is(k,"string")){return"/webapps"}}}});return f});define("DS/SNInfraUX/PredicatesNLS",["DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchDebug","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Promise","DS/WAFData/WAFData","UWA/Class/Collection","UWA/Class/Model","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(e,i,j,k,b,g,h,c,a,d){var f=a.extend({idAttribute:"uri"});var l=k.singleton(b,i,{uwaClassName:"DS/SNInfraUX/PredicatesNLS",_predicatesInfo:{},_callbacksInfo:{},_6wg_predicates:{},init:function(){this.setDebugMode(e.setDebugMode())},setResources:function(m){this.setOptions(m)},isLoaded:function(n){var m=false;var o=this._predicatesInfo[n];if(UWA.is(o)){if(UWA.is(o.status)){if(o.status!=="waiting"){m=true}}}return m},loadVocabulary:function(n,r){this.log("loadVocabulary called for vocabId : "+n);var q=this.getOption("resources");if(!j.is(q)){console.error("INVALID STATE: loadVocabulary is called before doing setResources on PredicatesNLS");return}var p=this._predicatesInfo[n];if(j.is(p)){if(j.is(p.status)){if(p.status==="waiting"){this.log("Vocabulary : "+n+" is already requested to be loaded");if(j.is(r,"function")){if(!this._callbacksInfo.hasOwnProperty(n)){this._callbacksInfo[n]=[]}this._callbacksInfo[n].push(r)}}else{this.log("Vocabulary : "+n+" is already loaded");if(j.is(r,"function")){var m={id:n,status:p.status};r.call(undefined,m)}}}return}this._predicatesInfo[n]={status:"waiting",info:new c([],{model:f})};var o=this;q.PredicatesNLSNames(n,function(s){s.onComplete=function(t){var u;if(j.is(t,"string")){u=JSON.parse(t)}else{u=t}console.log("Successfully loaded the vocabulary : "+n);o._predicatesInfo[n].status="success";if(j.is(u)&&j.is(u.vocabularyElementNLSInfo)){o._predicatesInfo[n].info.add(u.vocabularyElementNLSInfo)}o._sendCallbacks(r,{id:n,status:"success"})};s.onFailure=function(u,t){console.log("FAILED to load the vocabulary : "+n);o._predicatesInfo[n].status="failed";o._sendCallbacks(r,{id:n,status:"failed"})};d.getVocabularyProperties(n,s)})},getVocabId:function(n){var m=n.match(/\/([^/]*)$/);if(m===null){m=n}else{m=m[1]}if(UWA.is(m)){var o=m.split(":");if(UWA.is(o)&&o.length==2){return o[0]}}},getNLSValueForPredicate:function(n){var m=n.match(/\/([^/]*)$/);if(m===null){m=n}else{m=m[1]}var q=null;if(UWA.is(this._predicatesInfo)){if(UWA.is(m)){var p=m.split(":");if(UWA.is(p)&&p.length==2){var o=this._predicatesInfo[p[0]];if(UWA.is(o)){q=o.info.get(m)}}}}if(j.is(q)){return q.get("nlsName")}else{return m}},_sendCallbacks:function(p,m){var o=this._callbacksInfo[m.id];if(!UWA.is(o)){o=[];if(UWA.is(p,"function")){o.push(p)}}else{if(UWA.is(p,"function")){o.unshift(p)}}var n=o.length;for(var q=0;q<o.length;q++){o[q].call(undefined,m)}this._callbacksInfo[m.id]=[]},_asyncCallToPredicatesWS:function(m,n){var p=this;var o;if(UWA.is(p.getOption("resources"))){o=p.getOption("resources").getActiveTenant()}if(!p._6wg_predicates.hasOwnProperty(o)){p._6wg_predicates[o]={classPredicates:{}}}if(m.indexOf("ds6wg:SavedSearch")>=0&&!j.is(p._6wg_predicates[o].classPredicates["ds6wg:SavedSearch"])){p._6wg_predicates[o].classPredicates={"ds6wg:SavedSearch":[{name:"Title",uri:"ds6w:label",nlsName:l.getNLSValueForPredicate("ds6w:label")},{name:"PLM_ExternalID",uri:"ds6w:identifier",nlsName:l.getNLSValueForPredicate("ds6w:identifier")},{name:"originated",uri:"ds6w:created",nlsName:l.getNLSValueForPredicate("ds6w:created")},{name:"modified",uri:"ds6w:modified",nlsName:l.getNLSValueForPredicate("ds6w:modified")},{name:"owner",uri:"ds6w:responsible",nlsName:l.getNLSValueForPredicate("ds6w:responsible")}]}}return new g(function(y,A){if(!(j.is(m,"array"))||0===m.length){A(null)}var r=[];for(var z=m.length-1;z>=0;z--){if(j.is(p._6wg_predicates[o].classPredicates[m[z]])){r.push(m.splice(z,1)[0])}}if(0===m.length){var t={classPredicates:[]};for(var z=0,s=r.length;z<s;z++){t.classPredicates.push({className:r[z],vocabularyPredicateInfo:p._6wg_predicates[o].classPredicates[r[z]]})}y(t)}else{var u=m.join(",");var v="Predicates";var q="POST";if(j.is(n)&&j.is(n.service_name)){v=n.service_name}if(j.is(n)&&j.is(n.method)){q=n.method}var x={idService:v,method:q,data:u};var w=p.getOption("resources").getServicewithRole(x,function(B){B.onComplete=function(F){p.log("GetRelevantPredicates succeeded");if(j.is(n)&&j.is(n.forcetoresolve)&&j.is(n.forcetoresolve)===true){return(y(F))}var E=null;if(j.is(F)){E=F;if(!j.is(E,"object")||!j.is(E.classPredicates,"array")){console.error("Invalid response to Predicates WS"+E);A(null)}var G=0,I=0;for(G=0,I=E.classPredicates.length;G<I;G++){var C=E.classPredicates[G].vocabularyPredicateInfo;p._6wg_predicates[o].classPredicates[E.classPredicates[G].className]=C;if(j.is(C)){if(!j.is(p._predicatesInfo.ds6wg)){p._predicatesInfo.ds6wg={status:"success",info:new c([],{model:f})}}for(var D=0,H=C.length;D<H;D++){if(C[D].uri.startsWith("ds6wg:")){p._predicatesInfo.ds6wg.info.add(C[D])}}}}}if(!j.is(E)){E={classPredicates:[]};console.warn("Strange response from _asyncCallToPredicatesWS")}for(G=0,I=r.length;G<I;G++){E.classPredicates.push({className:r[G],vocabularyPredicateInfo:p._6wg_predicates[o].classPredicates[r[G]]})}y(E)};B.onFailure=function(D,C){p.log("_asyncCallToPredicatesWS fails");A(D,C)};d.getPropertiesForClass(u,B)})}})}});return l});define("DS/SNInfraUX/SNAdvSearchCusto",["UWA/Core","UWA/Class","UWA/Class/Options","UWA/Class/Debug","UWA/Promise","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/PredicatesNLS"],function(c,h,f,b,e,d,g){var a=h.singleton(b,f,{name:"DS_SNInfraUX_ANAdvSearchCusto",_thePromisePC:e.deferred(),_custo:{},_preferredTypeList:[],_easyAccessTypeList:[],_easyAccessTypeSource:{},_vocabularyElementNLSInfo:null,init:function(i){},getCusto:function(i){return d.getTenantSettings(i)},isCustoEnabled:function(){return true},_getAdvancedSearchOptions:function(i){var j=d.getOption("advanced_search",{tenant:i});this.loadCusto(j,i);return j},getDefaultSelectedSource:function(i){var j=this._getAdvancedSearchOptions(i);if(c.is(j)){return j.default_datasource}},getExcludedDataSources:function(i){var j=this._getAdvancedSearchOptions(i);if(c.is(j)){return j.excluded_dataSource}},getExcludedTypes:function(i,k){var j=d.getOption("topbar_search_banned_list",{tenant:i});if(c.is(j)&&c.is(j.types)){return j.types[k]}},loadCusto:function(l,i){var m=this;if(this._custo[i]||!c.is(l)){return}else{this._custo[i]={}}var k=this._custo[i];if(c.is(l.default_datasource,"string")){k.default_datasource=l.default_datasource}if(c.is(l.excluded_dataSource,"array")){k.excluded_dataSource=l.excluded_dataSource}if(c.is(l.exclusive_taxonomies,"boolean")){k._exclusive_taxonomies=l.exclusive_taxonomies}var j=l["ds6w:type"];if(c.is(j)){Object.keys(j).forEach(function(n){var u=j[n];if(c.is(u,"array")){var w={selectedByDefault:[],preferredPosition:{}};k[n]=w;for(var v=0;v<u.length;v++){var s=u[v];var p=s.uri;if(c.is(p)){m._preferredTypeList.push(p);w.preferredPosition[p]=v;if(s.selectByDefault===true){w.selectedByDefault.push(p)}k[p]={};if(s.easyTypeAcess===true){m._easyAccessTypeList.push(p);m._easyAccessTypeSource[p]=n}var B=s.interfaces;if(c.is(B,"array")){var q={preferredPosition:{},selectedByDefault:[]};k[p]["interfaces"]=q;for(var t=0;t<B.length;t++){var x=B[t];if(c.is(x.name)){q.preferredPosition[x.name]=t;if(x.selectByDefault===true){q.selectedByDefault.push(x.name)}}}}var A=s.predicates;if(c.is(A,"array")){var r={preferredPosition:{}};k[p]["predicates"]=r;for(var t=0;t<A.length;t++){var y=A[t];if(y.uri){r.preferredPosition[y.uri]=t}}}var z=s.excluded_predicates;var o=[];if(c.is(z,"array")){for(var t=0;t<z.length;t++){o.push(z[t].uri)}k[p]["excluded_predicates"]=o}}}}})}},getAllPreferredTypes:function(){return null},hasPreferredTypesForSource:function(i){return null},getTypesSelectedByDefault:function(i){return null},getTypePreferredPosition:function(l,m){var n=this._getAdvancedSearchOptions(l);if(c.is(n)){var k=n["ds6w:type"];if(c.is(k)&&c.is(k[m])){var p=k[m];var j={};var o=0;for(var i=0;i<p.length;i++){if(p[i].easyTypeAcess===true){j[p[i].uri]=o++}}return j}}},getInterfacesSelectedByDefault:function(i){var j=this._custo[i];if(j&&j.interfaces){return j.interfaces.selectedByDefault}},getPredicatePreferredPosition:function(k,i){if(c.is(i)&&c.is(this._custo[i])){var j=this._custo[i][k];if(j&&j.predicates){return j.predicates.preferredPosition}}},getExcludedPredicatesForType:function(k,i){if(c.is(i)&&c.is(this._custo[i])){var j=this._custo[i][k];if(j&&j.excluded_predicates){return j.excluded_predicates}}},getInterfacePreferredPosition:function(i){return null},getEasyAccessTypeList:function(){return this._easyAccessTypeList},getSelectedTypeSource:function(i){return this._easyAccessTypeSource[i]},isExclusiveTaxonomies:function(i){if(c.is(i)&&c.is(this._custo[i])){return this._custo[i]._exclusive_taxonomies}},getCustoTypeListNLSNames:function(k){if(!c.is(k)){return}var n=this;if(this._vocabularyElementNLSInfo===null){var m={service_name:"ElementsNLSNames",method:"POST",forcetoresolve:true};var l=n.getAllPreferredTypes();var j=g._asyncCallToPredicatesWS(l,m).then(function o(q){var p=null;if(c.is(q)&&q.length>0){p=JSON.parse(q);if(c.is(p)&&c.is(p.vocabularyElementNLSInfo)){if(c.is(k)&&c.is(k.onComplete)&&c.is(k.onComplete,"function")){n._vocabularyElementNLSInfo={};p.vocabularyElementNLSInfo.forEach(function(r){var s=r.uri;n._vocabularyElementNLSInfo[s]=r});k.onComplete.call(this,n._vocabularyElementNLSInfo)}}}},function i(){if(c.is(k)&&c.is(k.onFailure)&&c.is(k.onFailure,"function")){k.onFailure.call(this)}})}else{if(c.is(k)&&c.is(k.onComplete)&&c.is(k.onComplete,"function")){k.onComplete.call(this,n._vocabularyElementNLSInfo)}}}});return a});define("DS/SNInfraUX/SearchVersioning",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/SNInfraUX/Logger"],function(d,e,c,a){var b=e.singleton(c,{_VERSION:["R2019xFD05","R2019xFD04","R2019xFD03","R2019xFD02","R2019xFD01","R2019x","R2019xBETA3","R2019xBETA2","R2019xBETA1","R2018xFD10","R2018xFD09","R2018xFD08","R2018xFD07","R2018xFD06","R2018xFD05","R2018xFD04","R2018xFD03","R2018xFD02","R2018xFD01","R2018x","R2017xFD14","R2017xFD13","R2017xFD12","R2017xFD11","R2017xFD10","R2017xFD09","R2017x","R2016xFD16","R2016xFD15","R2016xFD14","R2016x"],_SUPPORTED_LEVELS:{R2019x:["FD05","FD04","FD03","FD02","FD01","GA","BETA3","BETA2","BETA1"],R2018x:["FD10","FD09","FD08","FD07","FD06","FD05","FD04","FD03","FD02","FD01","GA"],R2017x:["FD14","FD13","FD12","FD11","FD10","FD09"],R2016x:["FD16","FD15","FD14"]},init:function(){a.group("Info from SearchVersioning");a.info("3DSearch code level:"+this.getCurrentVersion());a.groupEnd()},isVersionSupported:function(f){return this._VERSION.indexOf(f)>-1},isActiveWithCurrentVersion:function(g){if(!d.is(g,"array")){g=[g]}var l=false;var n=this.getCurrentRelease();var m=[];var j=0,f=g.length;for(j=0,f=g.length;j<f;j++){m.push(Object.keys(g[j])[0])}m.sort();var k=m[m.length-1];if(n>k){return true}for(j=0,f=g.length;j<f;j++){var h=Object.keys(g[j])[0];if(this._SUPPORTED_LEVELS[n].indexOf(g[j][n])>-1){return true}}return l},getCurrentBuildLevel:function(){var f=this._SUPPORTED_LEVELS[Object.keys(this._SUPPORTED_LEVELS)[0]];return f[0]},getCurrentVersion:function(){var f=this._SUPPORTED_LEVELS[Object.keys(this._SUPPORTED_LEVELS)[0]];return Object.keys(this._SUPPORTED_LEVELS)[0]+f[0]},getCurrentRelease:function(){return Object.keys(this._SUPPORTED_LEVELS)[0]}});return b});define("DS/SNInfraUX/SearchUtils",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Data","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchPreferences","DS/WAFData/WAFData","UWA/Promise","DS/SNInfraUX/PredefinedQueries","DS/SNInfraUX/SearchVersioning","DS/WebRecordEnabler/Adapter","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","text!DS/SNInfraUX/assets/SearchColumnCustoAdmin.json","DS/SNInfraUX/Logger","text!DS/SNInfraUX/assets/SourceToPredicateMapping.json"],function(n,p,k,o,g,j,m,l,d,i,e,b,a,c,f){var h=p.singleton(k,{_sessionUserId:null,_helper_collections:{},_searchViewPromise:null,_searchReadyPromise:null,_autocompletePromise:null,_securityContextPromise:null,_customerConfigPromise:null,SEARCH_APP_ID:"X3DSEAR_AP",TRANSIENT_WIDGET_HELPER_ID:"transient_helper_collection",TAGGERPROXY_CONTEXTID_WEB_IN_WIN:"Universal_SearchCtx",_mappingURIPredicate:{},SearchTypeEnum:{ADVANCED_SEARCH:"#advancedSearch",MY_CONTENT:"#myContent",MY_RECENT_CONTENT:"#myRecentContent",SIMILAR_SEARCH:"#similarity",SEARCH_IN:"#searchIn",SEARCH:"#search",FAVORITE_SEARCH:"#favoriteSearches"},widgetLaunchMode:{TOPBAR_SEARCH:"from_topbar_search",COMPASS_PINNED:"from_compass_pinned",COMPASS_TRANSIENT:"from_compass_transient",PINNED:"pinned_widget",INCONTEXT_TRANSIENT:"in_context_transient"},HelperCollectionStatus:{SEARCH_IN_PROGRESS:"search_in_progress",SEARCH_SUCCEEDED:"search_succeeded",SEARCH_FAILED:"search_failed"},_securityContext:null,_serverUrl:null,_searchtype:null,_mappingServices:{"3DPassport":"3DPassport","3dpassport":"3DPassport","3DCompass":"3DCompass","3dcompass":"3DCompass","3DSwym":"3DSwym",swym:"3DSwym","3DSpace":"3DSpace",space:"3DSpace",cstorage:"3DSpace","3DSearch":"3DSearch","3dsearch":"3DSearch",search:"3DSearch","3DMessaging":"3DMessaging","3DComputeOrchestration":"3DComputeOrchestration",hpc:"3DComputeOrchestration","3DDesign":"3DDesign","6WTags":"6WTags",tagger:"6WTags"},_platforms:{},_taggerOpenedByCode:false,_adminCusto:null,_isInTheSimpleSearchMode:undefined,_isInTheSimpleSearchModePromise:null,_isInTheSimpleSearchModePromiseStatus:null,_sourceToPredicateMapping:null,init:function(q){this.sessionUserId="";Object.freeze(this.SearchTypeEnum);this._searchViewPromise=l.deferred();this._searchReadyPromise=l.deferred();this._autocompletePromise=l.deferred();this.getGrantedRoles(function(){});this._securityContextPromise=l.deferred();this._sourceToPredicateMapping=JSON.parse(f)},setUserId:function(q){this._sessionUserId=q;this.setUserSpecificSettings()},getUserId:function(){return this._sessionUserId},setserverUrl:function(q){this._serverUrl=q},getserverUrl:function(){return this._serverUrl},setAutocompleteRendered:function(){this._autocompletePromise.resolve()},autocompleteRendered:function(){return this._autocompletePromise.promise},setSearchViewRendered:function(){this._searchViewPromise.resolve()},getSearchViewPromise:function(){return this._searchViewPromise.promise},onSearchReady:function(){return this._searchReadyPromise.promise},setSearchReady:function(){this._searchReadyPromise.resolve()},setsearchType:function(q){this._searchtype=q},getsearchType:function(){if(this._searchtype===null){this._searchtype="#searchIn"}return this._searchtype},result:function(q,s){var r;if(!q){return null}r=q[s];if((n.typeOf(r))==="function"){return r.call(q)}return r},replace:function(r,q){return r.replace(/\{([\w\-]+)\}/g,function(s,t){return q[t]!==undefined?q[t]:""})},getAvailableHeight:function(r){var t=450;var q=n.extendElement(document.body).getElement(".app-content>.module>.front");if(q){var s=q.getScrolls().height;if(s>t){t=s-110}}else{if(g.getOption("search_web_in_win")&&document.body.parentElement.clientHeight>70){t=document.body.parentElement.clientHeight-70}}return t+"px"},getLanguage:function(){var q;if(window&&window.dsLang){q=window.dsLang;if("devsymbol"===q){q="en"}}else{var r;if(window&&window.clntlang){r=window.clntlang}else{if(navigator&&navigator.languages&&n.is(navigator.languages,"array")&&navigator.languages.length>0){r=navigator.languages[0]}else{r=(navigator?(navigator.language||navigator.systemLanguage):DEFAULT_LANG)}}q=r.toLowerCase().split("-")[0]}return q},getRegion:function(){return j.getItem("search_date_region")},getDeviceCategory:function(){var q=/iPhone/.test(navigator.userAgent)&&!window.MSStream;var r=/iPad/.test(navigator.userAgent)&&!window.MSStream;var s=/Android/.test(navigator.userAgent)&&!window.MSStream;return q?"iphone":(r?"ipad":"")||(s?"android":"")},setHelperCollection:function(q,r){if(UWA.is(q,"string")&&q.length>0){this.deleteHelperCollection(q);this._helper_collections[q]=r}},getHelperCollection:function(q){if(UWA.is(q)){return this._helper_collections[q]}},deleteHelperCollection:function(r){var q=this._helper_collections[r];if(UWA.is(q)){q.destroy();q=null;delete this._helper_collections[r];c.info("removed helper collection for widget id = "+r)}},replacePQsWithCVPrefixes:function(x){if(UWA.is(x)){var q="3dexp";var s="";var w=0;var u=/[\s\b]*(\w+):/g;while(true){var t=u.exec(x);if(!t){break}var v=t[1];if(d.isAPQAbbrevation(v)){var r=x.substring(w,t.index);if(r.length>0){r=r+" "}s=s+r+q+d.getPQPrefix(v);s=s+":";w=u.lastIndex}}s=s+x.substring(w);s=s.replace(/3dexp(\w+):[*]+(?=($| |\)))/g,"3dexp$1:#all");return s}else{return x}},executeWithPQ:function(q){if(q.wait&&q.wait()){var r=this;d.getPQFetchPromise().then(function(){r.executeWithPQ=function(s){s.run.call()};r.executeWithPQ.call(r,q)})}else{q.run.call()}},getGrantedRoles:function(r){var q=this;if(g.getOption("search_web_in_win")){r([])}else{if(!UWA.is(this._grantedRoles)){if(UWA.is(b.getGrantedRoles,"function")){b.getGrantedRoles(function(u){if(n.is(u,"array")&&u.length){q._grantedRoles=u;var t=g.getOption("role");if(UWA.is(window.dsUserLogin,"string")&&"uxodtitp"===window.dsUserLogin&&UWA.is(t,"string")&&0<t.length){var s=false;u.some(function(v){if(v.id===t){s=true}});if(false===s){q._grantedRoles.push({id:t,name:"Dummy role from ODT",platforms:[]})}}r(q._grantedRoles)}else{r([])}})}}else{r(q._grantedRoles)}}},isRoleAvailable:function(r,q,s){this.getGrantedRoles(function(u){var v=true;if(n.is(r,"array")&&r.length>0){if(n.is(u,"array")&&0<u.length){v=false;var w=0,t=r.length;for(w=0;w<t;w++){if(u.some(function(x){if(x.id===r[w]){if(n.is(x.platforms)){return x.platforms.some(function(y){return(n.is(q)&&q.length>0)?y===q:true})}}else{if(x.id==="InternalDS"){return true}}})){v=true}}}else{if(n.is(r,"string")&&r.length>0){v=u.some(function(x){if(x.id==r){if(n.is(x.platforms)){return x.platforms.some(function(y){return(n.is(q)&&q.length>0)?y===q:true})}}else{if(x.id==="InternalDS"){return true}}})}}}s(v)})},getZIndex:function(t,r){try{var u=0;if(n.is(r)){u=r}if(n.is(t,"element")){var q=window.getComputedStyle(t).getPropertyValue("z-index");if(!(isNaN(q))){q=parseInt(q);if(q>u){u=q}}return this.getZIndex(t.parentElement,u)}return u}catch(s){console.error("Exception caught in getZIndex ! :"+s);return n.is(r)?r:1049}},getURIToUse:function(r){var q=r;if(n.is(r)&&!n.is(this._mappingURIPredicate[r])){this._mappingURIPredicate[r]=r.slice(r.lastIndexOf("/")+1,r.length)}if(n.is(this._mappingURIPredicate[r])){q=this._mappingURIPredicate[r]}return q},getServicesToUse:function(q){return n.is(this._mappingServices[q])?this._mappingServices[q]:q},getServiceUrl:function(t,s){var r=this._platforms[s];var u=null;var q=this.getServicesToUse(t);if(n.is(r,"object")&&n.is(r.services,"object")&&n.is(q,"string")&&n.is(r.services[q],"object")){u=r.services[q]["url"]}return u},setPlatforms:function(u){this._platforms={};var w=0,s=0;if(n.is(u,"array")){s=u.length;for(w=0;w<s;w++){if(n.is(u[w],"object")){var r=u[w];if(n.is(r.id,"string")&&r.id.length>0){var q={};q.name=r.name;q.services={};var v=r.services;var t=0,x=0;if(n.is(v,"array")){x=v.length;for(t=0;t<x;t++){q.services[this.getServicesToUse(v[t]["id"])]={url:v[t]["url"]}}}this._platforms[r.id]=q}}}}},getTaggerSubject:function(q){var r="";if(UWA.is(q,"object")&&UWA.is(q.id,"string")){var s="";if(q.id.indexOf(":")===-1){s="pid://";if(UWA.is(q.source,"string")&&q.source.indexOf("drive")>=0){s="driveid:"}}r=s+q.id}return r},setSecurityContext:function(q){this._securityContext=q},getSecurityContext:function(){return this._securityContext},stripHtml:function(r){var q=document.createElement("DIV");q.innerHTML=r;return q.textContent||q.innerText||""},escapeHtml:function(r){if(!n.is(r,"string")||!n.is(r.replace,"function")){c.warn("Trying to escapeHtml of a non string : ",r," !");return r}var q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return r.replace(/[&<>"']/g,function(s){return q[s]})},decodeHtml:function(r){if(!n.is(r,"string")||!n.is(r.replace,"function")){c.warn("Trying to decodeHtml of a non string : ",r," !");return r}var q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return r.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(s){return q[s]})},initSecurityContext:function(r){var t=this;var s=t.getSecurityContext();if(s&&s.trim().length>0){t._securityContextPromise.resolve()}else{var q={};q.method="GET";q.headers={"Accept-Language":h.getLanguage(),Accept:"application/json"};if(UWA.is(r.get3DSpaceUrl,"function")){q.url=r.get3DSpaceUrl()+"/resources/pno/person/getsecuritycontext";q.data={tenant:r.getActiveTenant()}}else{q.url=r.url+"/resources/pno/person/getsecuritycontext";q.data={tenant:r.tenant}}q.onComplete=function(u){var v=JSON.parse(u);t.setSecurityContext(v.SecurityContext);t._securityContextPromise.resolve()};q.onFailure=function(u){c.warn("Failed to get security context: "+u);t._securityContextPromise.resolve()};m.authenticatedRequest(q.url,q)}},getSecurityContextPromise:function(){return this._securityContextPromise.promise},isODTMode:function(){return e.isActive()},isNative:function(){return e.isNative()},isFUNActive:function(q){if(!n.is(q,"string")){throw new Error("Invalid arg in SearchUtils.isFUNActive !")}return(false===g.getOption(q))?false:true},identifyClientInfo:function(r){var q="3DDashboard";if(UWA.is(document.getElementById("searchContainer"))){q="3DSpace"}else{if(window.ds&&window.ds.env==="3DSwym"){q="3DSwym"}else{if(g.getOption("search_web_in_win")){q="3DEXPERIENCE"}}}var s={identifier:q,};if(UWA.is(r,"string")&&r.length>0){s.addinmode=r}return s},_isSearchWidgetTransientAvailable:function(s){var t=false;var r=this;if(n.Widgets){var q=n.Widgets.instances.filter(function(u){if(UWA.is(u)&&UWA.is(u.getView,"function")&&u.getView().type==="maximized"){if(n.is(u.data)&&n.is(u.data.appId)&&u.data.appId==="X3DSEAR_AP"){t=true;if(u.id===s){t=false}}}})}return(t)},instantiateAppInSearch:function(t,C,v,D){var x=this;var r=x.createContent(t);x.setContentVisibility(t);var s=require,y=s("UWA/Class/Promise"),B=s("DS/i3DXCompass/i3DXCompass"),u=null,A=null;function w(E){var F=[];if(n.is(E,"string")){F[0]=E}else{F=E}return new y(function(H,G){require(F,function(){H.call(null,Array.prototype.slice.call(arguments))},function(I){G("Error loading modules."+((I&&I.requireModules)?I:""))})})}function z(E){return new y(function(G,F){if(B){B.getAppInfo({appId:E,onComplete:function(H){if(H){G(H)}else{F("Could not locate app information.")}},onFailure:F})}else{F()}})}function q(H,E,G,F){return new y(function(K){var I;var J="";var M="";var L=G;if(n.is(L,"object")){L=JSON.stringify(G)}if(n.is(H.config)&&H.config.length>0){J=H.config;o.request(J,{method:"GET",type:"json",cache:3600,onComplete:function(N){M=JSON.stringify(N);n.merge(G,N);L=JSON.stringify(G);I={el:E,title:"",parent:false,preview:true,appId:H.id,data:L||{},header:true,config:J};if(H&&((H.checksum&&H.launchInfos)||(H.platforms&&H.platforms[0]&&H.platforms[0].checksum&&H.platforms[0].launchInfos))){I=UWA.extend(I,{widgetId:UWA.is(H.launchInfos)?H.launchInfos:H.platforms[0].launchInfos,isolationLevel:UWA.is(H.isolationLevel)?H.isolationLevel:H.platforms[0].isolationLevel,token:UWA.is(H.checksum)?H.checksum:H.platforms[0].checksum})}else{throw new Error("Could not get valid Config from MyApps for the App "+I.appId)}u.load(I,function(){if(I.widget&&I.widget.environment){I.widget.setValue("X3DContentId",I.data);if(UWA.is(F)&&UWA.is(F.historyNode)&&UWA.is(F.historyNode._options)){F.historyNode._options.contextid="RightPanelContext";I.widget.context="RightPanelContext";var P=require,R=P("DS/TagNavigator/TagNavigator");var O=R.get6WTagger(I.widget.context);if(O){O.setAsCurrent();O.focusOnCC(F.historyNode._options.widgetAppId)}if(!UWA.is(F.historyNode._options.containers,"array")){F.historyNode._options.containers=[]}if(UWA.is(F.historyNode._options.containers)){F.historyNode._options.containers.push(E)}if(!UWA.is(F.historyNode._options.widgets,"array")){F.historyNode._options.widgets=[]}if(UWA.is(F.historyNode._options.widgets)){F.historyNode._options.widgets.push(I.widget)}}var Q=P("DS/PlatformAPI/PlatformAPI");if(UWA.is(Q)){Q.subscribe("onAppReady.CATC3D_AP",function(S){I.widget.setTitle(" ")})}}K(I.widget)},A)}})}else{I={el:E,title:"",parent:false,preview:true,appId:H.id,data:G||{},header:true};if(H&&((H.checksum&&H.launchInfos)||(H.platforms&&H.platforms[0]&&H.platforms[0].checksum&&H.platforms[0].launchInfos))){I=UWA.extend(I,{widgetId:UWA.is(H.launchInfos)?H.launchInfos:H.platforms[0].launchInfos,isolationLevel:UWA.is(H.isolationLevel)?H.isolationLevel:H.platforms[0].isolationLevel,token:UWA.is(H.checksum)?H.checksum:H.platforms[0].checksum})}else{throw new Error("Could not get valid Config from MyApps for the App "+I.appId)}u.load(I,function(){if(I.widget&&I.widget.environment){I.widget.setValue("X3DContentId",JSON.stringify(I.data));if(UWA.is(F)&&UWA.is(F.historyNode)&&UWA.is(F.historyNode._options)){F.historyNode._options.contextid="RightPanelContext";F.historyNode._options.widgetAppId=I.widget.id;I.widget.context="RightPanelContext";var O=require,P=O("DS/TagNavigator/TagNavigator");var N=P.get6WTagger(I.widget.context);if(N){N.setAsCurrent();N.focusOnCC(F.historyNode._options.widgetAppId)}if(!UWA.is(F.historyNode._options.containers,"array")){F.historyNode._options.containers=[]}if(UWA.is(F.historyNode._options.containers)){F.historyNode._options.containers.push(E)}if(!UWA.is(F.historyNode._options.widgets,"array")){F.historyNode._options.widgets=[]}if(UWA.is(F.historyNode._options.widgets)){F.historyNode._options.widgets.push(I.widget)}}I.widget.addEvent("onUpdateTitle",function(S){var T=I.el.querySelector(".moduleHeader__title");if(!T){return}var R=false;var Q=T.innerHTML.split(" - ");if(UWA.is(Q)&&Q[0]!==I.name){Q[0]=I.name;R=true}else{Q[1]=S;R=true}if(R){T.innerHTML=Q.filter(function(U){return U}).join(" - ")}})}K(I.widget)},A)}})}return new y(function(E){w(["DS/UWPClientCode/WidgetFactory","DS/TopFrame/Environment"]).then(function(F){u=F[0];A=F[1];if(UWA.is(u)&&UWA.is(A)){z(C).then(function(G){return q(G,r,v,D)})}})})},setContentVisibility:function(B){var v=this;var z=v.getCurrentSearchWidget();if(z===null){return}var w=B;var t=false;var u;if(UWA.is(B)&&UWA.is(B.SNtype)){w=B.SNtype;t=true;u=B.contextid}var s=require,r=s("DS/TagNavigator/TagNavigator");var q=z.elements.body.getElement(".onesearch_skeleton");if(UWA.is(q)){q.setStyle("display","none")}var y=z.elements.body.getElement(".relational-div");if(UWA.is(y)){y.setStyle("display","none")}var x=z.elements.body.getElement(".product-div");if(UWA.is(x)){x.setStyle("display","none")}if(w==="Search"||w==="Children"){if(UWA.is(q)){q.setStyle("display","block")}}else{if(w==="Explore"||w==="ExploreList"||w==="Explore3D"){if(UWA.is(x)){x.setStyle("display","flex")}}else{if(w==="Relational"){if(UWA.is(y)){y.setStyle("display","block")}}}}if(t===true){var A=r.get6WTagger(u);if(A){A.setAsCurrent();A.focusOnCC(B.widgetAppId)}}},createContent:function(r){var v=this;var s=null;var w=v.getCurrentSearchWidget();if(w===null){return}var t=r;var u=w.elements.body.getElement(".relational-div");if(UWA.is(u)){u.setStyle("display","none")}var q=w.elements.body.getElement(".product-div");if(UWA.is(q)){q.setStyle("display","none")}if(t==="Explore"||t==="ExploreList"||t==="Explore3D"){if(UWA.is(q)){q.setStyle("display","flex");if(t==="ExploreList"){s=new UWA.Element("div",{"class":"productList-div",styles:{"float":"left"}});s.inject(q)}else{if(t==="Explore3D"){s=new UWA.Element("div",{"class":"product3D-div",styles:{"float":"right"}});s.inject(q)}}}}else{if(t==="Relational"){if(UWA.is(u)){u.setStyle("display","block");s=u}}}return(s)},pinToDashboard:function(q){var r="DS/Dashboard/Notification/Subscribe";require([r],function(s){var t=q.widgetData;if(UWA.is(q.widgetData)){t.pinToDashboard=false}s.subscribe({notification:{data:JSON.stringify({contentData:{title:q.widgetTitle},url:q.widgetIdOrUrl,appId:q.widgetAppId,widgetId:q.widgetId,data:t})},type:"widget"}).then(function(){if(UWA.is(q.success,"function")){q.success()}},function(){if(UWA.is(q.failure,"function")){q.failure()}})})},getCurrentTabId:function(){var v=null;var u,s,q,t;u=(UWA.Widgets&&UWA.Widgets.instances)||[];var r=u.length;for(s=0;s<r;s++){q=u[s];t=q.environment||{};if(q.data!==undefined){if(q.data.module!==undefined){if(q.data.module==="DS/Dashboard/Layout/Dashboard"){if((q.layout!==undefined)&&(q.layout.selectedTab!==undefined)&&(q.layout.selectedTab.options!==undefined)){v=q.layout.selectedTab.options.id;break}}}}}return v},getCurrentSearchWidget:function(){var u=this;var v=null;var s=u.getCurrentTabId();if(UWA.Widgets){var w,t,q;w=(UWA.Widgets&&UWA.Widgets.instances)||[];var r=w.length;for(t=0;t<r;t++){q=w[t];if(UWA.is(q,"object")&&q.getValue("appId")===h.SEARCH_APP_ID){if(q.getView().type==="maximized"){if(UWA.is(q.getView().previous)&&UWA.is(q.getView().previous.type)&&q.getView().previous.type==="windowed"){v=q;t=r}}}}if(v===null){for(t=0;t<r;t++){q=w[t];if(UWA.is(q,"object")&&q.context===s&&q.getValue("appId")===h.SEARCH_APP_ID){if(q.getView().type==="maximized"){v=q;t=r}}}}if(v===null){for(t=0;t<r;t++){q=w[t];if(UWA.is(q,"object")&&q.getValue("appId")===h.SEARCH_APP_ID){if(q.getView().type==="sidepanel"){v=q;t=r}}}}}return(v)},addSourceSpecificParameter:function(y,v){if(UWA.is(y)&&UWA.is(v)){var u=v.sourceIds;if(UWA.is(u,"array")){for(var x=0;x<u.length;x++){var w=u[x];if(UWA.is(y.specific_source_parameter)){var z=y.specific_source_parameter[w]}if(!UWA.is(z)){z={}}var r=v.param.id,t=v.param.value;if(UWA.is(r,"string")&&UWA.is(t)&&t.toString().length){var q=z[r];if(UWA.is(q,"string")){z[r]+=t}else{z[r]=t}if(!UWA.is(y.specific_source_parameter)){y.specific_source_parameter={}}if(!UWA.is(y.specific_source_parameter[w])){y.specific_source_parameter[w]=z}}}}}},setTaggerOpenedByCode:function(q){this._taggerOpenedByCode=q},isTaggerOpenedByCode:function(){return this._taggerOpenedByCode},getResultArgsFromSearchArgs:function(r){var t={};switch(r.to){case"onSearch":var s=r.options;t.search_criteria=s.value;t.adv_search=s.adv_search;t.search_mode=s.search_mode;t.recent_filter=s.sFilter;t.search_criteria_to_display=s.searchStringToDisplayInSearchField;t.internalSearchCriteria=s.internalSearchCriteria;t.displayValue=s.displayValue;t.source=s.source;t.viewData=s.viewData;t.in_apps_search=s.customization_options;t.tag_filter=s.tag_filter;break;case"init":var q=r.preferences_wdg;t.incontext_global_actions=q.incontext_global_actions;t.in_apps_search=q.customization_options;t.transient_context="true";t.css_view_class="maximized";t.search_options={search_criteria:q.search_criteria,adv_search:q.adv_search,search_criteria_to_display:q.search_criteria_to_display,search_mode:"index",tag_filter:q.reSearch,source:q.source};t.viewData=q.viewData;t.result_ux_customization=q.result_ux_customization;t.tagger_context_id=r.tagger_context_id}return t},getResultInitArgs:function(r){var q=h.getResultArgsFromSearchArgs({to:"init",preferences_wdg:r.preferences_wdg});return q},getResultUpdateArgs:function(r){var q=h.getResultArgsFromSearchArgs({to:"onSearch",options:r.options});return q},checkCustomerConfigs:function(q){if(!UWA.is(this._customerConfigPromise)){this._customerConfigPromise=new l(function(v,u){if(UWA.is(q,"object")&&UWA.is(q.resources)){var t=q.resources.getFedSearchUrl();if(UWA.is(t,"string")){var s={"DS/SNSearchCusto":t+"/webapps/SNSearchCusto"};require.config({paths:s});var r="text!DS/SNSearchCusto/assets/SearchCmdConfig.json";if(!g.getOption("cmd_config_cache")){r+="?app="+h.identifyClientInfo().identifier}require([r],function(w){try{var x=JSON.parse(w);if(UWA.is(x.require,"object")&&UWA.is(x.require.config,"object")){if(UWA.is(x.require.config.paths,"object")){require.config(x.require.config);v("customer config set as : "+JSON.stringify(x.require.config))}else{u("SearchCmdConfig.json is not in required format, contents = "+w)}}else{u("SearchCmdConfig.json is not in required format, contents = "+w)}}catch(y){u("Issue during parsing SearchCmdConfig.json, error = "+y+"file content = "+w)}},function(w){u("Issue during require of SearchCmdConfig.json, error = "+w.message)})}else{u("Invalid federated Service Base URL")}}else{u("Invalid Inputs")}})}return this._customerConfigPromise},isFUN072117Active:function(){return g.getOption("preferredUnit_FUN072117")||i.isActiveWithCurrentVersion({R2019x:"BETA3"})},getValidDatasources:function(A){var v={};var w=g.getOption("dataSourcesToFilterFromAdvancedSearch");if(!n.is(w)){w={}}if(UWA.is(A)){var q=A.dataSources;if(UWA.is(q,"array")){var x=[],t=[],y=[];for(var z=0;z<q.length;z++){var u=q[z];if(u.status===true){var r=u.name;if(!n.is(w[r])){x.push(u.name);if(n.is(u.service)){t.push(u.service)}else{t.push(u.name)}}}}v.dataSourceNames=x;v.dataSourceServices=t}}return v},getAdminCustoDefinition:function(){if(!n.is(this._adminCusto)){try{if(sessionStorage&&sessionStorage.getItem("SearchColumnCustoAdmin.json")){this._adminCusto=JSON.parse(sessionStorage.getItem("SearchColumnCustoAdmin.json"))}if(!n.is(this._adminCusto)){this._adminCusto=JSON.parse(a)}}catch(q){console.error("Error parsing SearchColumnCustoAdmin.json:",q)}}return this._adminCusto},_getPredicateTypeFromDataType:function(s){var r="";if(UWA.is(s)&&UWA.is(s.range)&&UWA.is(s.range.dataTypes)&&UWA.is(s.range.dataTypes.length)){r=s.range.dataTypes[0];var q="string";if(r==="http://www.w3.org/2001/XMLSchema#string"){q="string"}else{if(r==="http://www.w3.org/2001/XMLSchema#boolean"){q="boolean"}else{if(r==="http://www.w3.org/2001/XMLSchema#integer"){if(UWA.is(s.rangeValues,"object")&&Object.keys(s.rangeValues).length>0){q="string"}else{q="integer"}}else{if(r==="http://www.w3.org/2001/XMLSchema#dateTime"){q="date"}else{if(r==="http://www.w3.org/2001/XMLSchema#date"){q="date"}else{if(r==="http://www.w3.org/2001/XMLSchema#double"){q="double"}else{if(r==="http://www.w3.org/2001/XMLSchema#real"){q="double"}else{if(r==="http://www.w3.org/2001/XMLSchema#timestamp"){q="date"}else{if(r==="http://www.w3.org/2001/XMLSchema#time"){q="date"}}}}}}}}}}else{if(UWA.is(s.type)){q=s.type}}return q},ensureBetaStatus:function(){var q=this;if(!UWA.is(this._isInTheSimpleSearchModePromise)){this._isInTheSimpleSearchModePromise=new l(function(s,r){if((g.getOption("newSearch19xFD02")===true&&g.getOption("predefinedBetaUser")===true)||(true===q.isOneSearchInternalProd())){j.getPreference({name:"3DSearchOptions",onComplete:function(t){q._isInTheSimpleSearchModePromiseStatus="resolved";s(q.isInTheSimpleSearch())},onFailure:function(){q._isInTheSimpleSearchModePromiseStatus="resolved";s(q.isInTheSimpleSearch())}})}else{q._isInTheSimpleSearchModePromiseStatus="resolved";s(q.isInTheSimpleSearch())}})}return this._isInTheSimpleSearchModePromise},isOneSearchInternalProd:function(){var q=g.getOption("DoNotRestoreSearchChoice");var s=g.getOption("OneSearch");var t=h.identifyClientInfo();var r=false;if(q!==true){if(s===true&&true===g.getOption("internalProd")){if((UWA.is(t,"object")&&(t.identifier==="3DDashboard"||t.identifier==="3DSwym"))){r=true}}}return r},isInTheSimpleSearch:function(r){if(UWA.is(this._isInTheSimpleSearchMode)){return this._isInTheSimpleSearchMode}this._isInTheSimpleSearchMode=g.getOption("simple_search_experience");var w=false;if(true===g.getOption("internalProd")){var v=h.identifyClientInfo();if(UWA.is(v,"object")&&v.identifier==="3DDashboard"){w=true}}var t=g.getOption("OneSearch");if(UWA.is(g.options.url_search_settings.simple_search_experience)){this._isInTheSimpleSearchMode=g.options.url_search_settings.simple_search_experience}else{if(UWA.is(g.getOption("Odt_simple_search"))){this._isInTheSimpleSearchMode=g.getOption("Odt_simple_search")}else{if(t===true&&(g.getOption("search_web_in_win")===true||g.getOption("addinmode"))){this._isInTheSimpleSearchMode=true}else{var q=g.getOption("newSearch19xFD02");var u=g.getOption("predefinedBetaUser");if(q===true&&u===true){var s=j.getItem("simple_search_experience");if(UWA.is(s,"boolean")){this._isInTheSimpleSearchMode=s}if(true===this._isInTheSimpleSearchMode){w=false}}}}}if(this.isOneSearchInternalProd()){w=j.getItem("find_in_this_tab_default")}g.changeSettingForBETA_deactivated({find_in_this_tab_default:w});if(false===this._isInTheSimpleSearchMode){g.changeSettingForFD01()}else{g.changeSettingForBETA()}if(UWA.is(this._isInTheSimpleSearchMode)){g.options.search_settings.simple_search_experience=this._isInTheSimpleSearchMode}return this._isInTheSimpleSearchMode},isSnippetAvailable:function(q){var r=true;var s=g.getOptionPerTenant("search_snippet_admin",{tenant:q});if(s===false){r=false}if(true===g.getOption("OneSearchOFF")){r=false}if(undefined!==g.getOption("search_snippet")){r=g.getOption("search_snippet")}return r},isSuggestAvailable:function(q){var s=true;var r=g.getOptionPerTenant("suggest_admin",{tenant:q});if(r===false){s=false}if(true===g.getOption("OneSearchOFF")){s=false}if(undefined!==g.getOption("suggest")){s=g.getOption("suggest")}return s},isCompactModeEnforced:function(q){var r=true;if(true!==g.getOptionPerTenant("mobile_experience_admin",{tenant:q})){r=false}return r},isBetaEnabledForUser:function(){var s=true;var q=g.getOption("predefined_beta_users");var r=this.getUserId();if(UWA.is(r)&&UWA.is(q,"array")){s=q.indexOf(r)>=0||q.indexOf(r.toUpperCase())>=0}return s},setUserSpecificSettings:function(){g.changeSettings({predefinedBetaUser:this.isBetaEnabledForUser()})},activateCompactOrComfortMode:function(q){var r=g.getOption("OneSearch");if(n.is(r)&&r===true){var u=screen.availWidth;if(n.is(u)){var t=true;if(u>1275){t=false}else{var s=this.getDeviceCategory();if(["iphone","ipad","android"].indexOf(s)!==-1){if(u>1023){t=false}}}g.setCompactMode(t)}}},getHierarchyClass:function(q){if(!n.is(q)){return}var s={};s.method="POST";s.headers=q.headers||{};s.headers["Content-Type"]="application/xml";s.headers.Accept="application/json";s.url=q.searchmodel.getFederatedSource().get3DSpaceUrl()+"/i3dx/services/xmql?tenant="+q.searchmodel.getFederatedSource().getActiveTenant();var r='<?xml version="1.0" encoding="utf-8"?>\n';r+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';r+="\t<execute>\n";r+="\t\t<function>get_parents_bus_type</function>\n";r+="\t\t<version>1.0.0</version>\n";r+="\t\t<params>\n";r+='\t\t\t<param name="type">'+q.searchmodel.get("ds6w:type_value")+"</param>\n";r+="\t\t</params>\n";r+="\t</execute>\n";r+="</executeSequence>\n";s.data=r;s.onComplete=function(u){var w=[];try{var v=JSON.parse(u);if(n.is(v)){w=JSON.parse(v.xmql_response.body.result[2].output);if(n.is(w,"array")){w.reverse();w.push(q.searchmodel.get("ds6w:type_value"));var t=q.searchmodel.get("ds6w:kind_value");if(UWA.is(t,"array")){w=w.concat(t)}else{if(UWA.is(t,"string")){w.push(t)}}}}if(!Array.isArray(w)){w=[]}}catch(x){w=[]}if(n.is(q.onComplete,"function")){q.onComplete.call(null,w)}};s.onFailure=function(t){if(n.is(q.onFailure,"function")){q.onFailure.call(null,t)}};m.authenticatedRequest(s.url,s)},getSourceToPredicateMapping:function(){var q=[];if(UWA.is(this._sourceToPredicateMapping,"object")&&UWA.is(this._sourceToPredicateMapping.SourceToPredicate)){q=this._sourceToPredicateMapping.SourceToPredicate}return q},});return h});define("DS/SNInfraUX/SearchCom",["UWA/Core","UWA/Utils/InterCom","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils"],function(b,a,d,c){return{_searchCom_server:null,_created_special_server:[],_created_socket_global:[],_created_socket:[],in3DDashboardApp:undefined,createSocket:function(f){if(!b.is(this._searchCom_server)){this._init(f)}if(this.in3DDashboardApp===undefined){this.in3DDashboardApp=c.identifyClientInfo().identifier;if(b.is(f)&&b.is(f.clientInfo)){this.in3DDashboardApp=f.clientInfo}}if(b.is(f.socket_id)){if(this._created_socket.indexOf(f.socket_id)!==-1){throw new Error("SearchCom: socket with id "+f.socket_id+" already created")}else{if("3DDashboard"===this.in3DDashboardApp&&f.widgetId&&-1===f.widgetId.indexOf("preview")){if(-1===this._created_special_server.indexOf(f.widgetId)){this._searchCom_server=new a.Server("SearchComServer_"+f.widgetId,{isPublic:false});this._created_special_server.push(f.widgetId);this.updateGlobalSockets()}var e=new a.Socket(f.socket_id,{dispacthRetryInterval:0});(d.getOption("search_web_in_win")||d.getOption("SearchComServer_odt"))?e.subscribeServer("SearchComServer_"+f.widgetId,window):e.subscribeServer("SearchComServer_"+f.widgetId);this._created_socket.push(f.socket_id)}else{var e=new a.Socket(f.socket_id,{dispacthRetryInterval:0});(d.getOption("search_web_in_win")||d.getOption("SearchComServer_odt"))?e.subscribeServer("SearchComServer",window):e.subscribeServer("SearchComServer");this._created_socket.push(f.socket_id);this._created_socket_global.push(e);this.subscribeServer_global(e)}}return e}else{throw new Error("SearchCom: socket_id not found")}},updateGlobalSockets:function(){var e=this;this._created_socket_global.forEach(function(f){e.subscribeServer_global(f)})},subscribeServer_global:function(e){if(e.id==="searchview_socket_id"){return}this._created_special_server.forEach(function(f){var g="SearchComServer_"+f;if(!e.servers[g]&&e){(d.getOption("search_web_in_win")||d.getOption("SearchComServer_odt"))?e.subscribeServer(g,window):e.subscribeServer(g)}})},unsubscribeServer:function(e){if(!b.is(e)||this._created_special_server.length===0){return}var f=this;this._created_socket_global.forEach(function(g){f._created_special_server.forEach(function(h){var i="SearchComServer_"+h;if(e===h&&g.servers[i]){g.unsubscribeServer(i)}})})},deleteSocket:function(k){var f=this._created_socket.indexOf(k);if(f!==-1){this._created_socket.splice(f,1);var j=this;var i=this._created_socket_global.length;var h=null;for(var e=0;e<i;e++){var g=j._created_socket_global[e];if(b.is(g)&&(b.is(g.id)&&g.id===k)){h=g;break}}if(e&&h!==null){j._created_socket_global.splice(e,1);j._created_special_server.forEach(function(l){var m="SearchComServer_"+l;if(g.servers[m]){h.unsubscribeServer(m)}})}}},_init:function(e){this._searchCom_server=new a.Server("SearchComServer",{isPublic:false});if(d.getOption("debug_mode")===true){this.in3DDashboardApp=location.pathname.match(/\/3DDashboard\//)}}}});define("DS/SNInfraUX/Api/SearchApi",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Promise","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SNInfraUX/SearchLogin","DS/SNInfraUX/SearchUtils"],function(h,i,e,f,g,a,c,d){var b=i.singleton(e,{_searchRessources:null,_searchApiPromise:f.deferred(),setResourceMgt:function(j){this._searchRessources=j},load:function(j){var k=this;if(j===true&&this._searchRessources){c.login({resources:this._searchRessources,onComplete:function(){k._searchApiPromise.resolve()},onFailure:function(){k._searchApiPromise.resolve()}})}return this._searchApiPromise.promise},search:function(j){this._queryFedSearch(j)},_queryFedSearch:function(j){var k=this;a.getServiceUrl({serviceName:"3DSearch",platformId:j.tenant?j.tenant:(k._searchRessources?k._searchRessources.getActiveTenant():undefined),onComplete:function(m){console.log(m);if(h.is(m,"string")){var n={query:j.query,order_field:j.order_field?j.order_field:"relevance",order_by:j.order_by?j.order_by:"desc",select_file:h.is(j.select_file,"array")?j.select_file:[],select_synthesis:j.select_synthesis?j.select_synthesis:j.select_predicate,select_predicate:j.select_predicate?j.select_predicate:["ds6w:label"],label:"3DSearch-"+d.getUserId()+"-"+new Date().getTime(),nresults:j.nresults?j.nresults:40,next_start:j.next_start,source:j.source,tenant:j.tenant};if(!n.tenant){if(k._searchRessources){n.tenant=k._searchRessources.getActiveTenant()}}var l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify(n),onComplete:function(o){var p=JSON.parse(o);delete p.infos;delete p.facets;j.onComplete(p)},onFailure:function(o){console.log(o);j.onFailure(o)}};g.authenticatedRequest(m+"/search",l)}else{j.onFailure()}},onFailure:function(l){console.log(l);j.onFailure(l)}})}});return b});define("DS/SNInfraUX/SNSearchTypeCusto",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Options","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/PredicatesNLS"],function(b,g,a,d,c,f){var e=g.singleton(a,d,{init:function(k){var h=c.getOption("type_custo");if(h){var j=h.IncludedTypes;if(b.is(j)){if(j.length>0){this._typeCusto={};var i=this;j.forEach(function(l){i._typeCusto[l.typeURI]=l;i._typeCusto[l.typeURI].typeRef="Class"})}}}j=h.IncludedRelTypes;if(b.is(j)){if(j.length>0){this._typeCustoInst={};var i=this;j.forEach(function(l){i._typeCustoInst[l.typeURI]=l;i._typeCustoInst[l.typeURI].typeRef="Instance"})}}this._vocabularyElementNLSInfo=null},getSearchTypeCustoQuery:function(){if(this._globalSearchTypeCustoQuery){return this._globalSearchTypeCustoQuery}var l="";if(this._typeCusto){for(var n in this._typeCusto){if(this._typeCusto.hasOwnProperty(n)){var o;var k=n.split(":");if(k.length>1){if(k[0]=="ds6wg"){o='flattenedtaxonomies:"types/'+k[1]+'"'}else{o='type:"'+k[1]+'"'}}else{o='flattenedtaxonomies:"types/'+k[0]+'"'}var j=this._typeCusto[n].interfaceURIs;if(j&&j.length>0){var m="NOT listoffields:interface";for(var h=0;h<j.length;h++){m+=' OR flattenedtaxonomies:"interfaces/'+j[h]+'"'}o="("+o+" AND ("+m+"))"}if(l.length==0){l=o}else{l+=" OR "+o}}}}if(this._typeCustoInst){for(var n in this._typeCustoInst){if(this._typeCustoInst.hasOwnProperty(n)){var o;var k=n.split(":");if(k.length>1){if(k[0]=="ds6wg"){o='flattenedtaxonomies:"reltypes/'+k[1]+'"'}else{o='type:"'+k[1]+'"'}}else{o='flattenedtaxonomies:"reltypes/'+k[0]+'"'}var j=this._typeCustoInst[n].interfaceURIs;if(j&&j.length>0){var m="NOT listoffields:interface";for(var h=0;h<j.length;h++){m+=' OR flattenedtaxonomies:"interfaces/'+j[h]+'"'}o="("+o+" AND ("+m+"))"}if(l.length==0){l=o}else{l+=" OR "+o}}}}if(l.length>0){this._globalSearchTypeCustoQuery=l}return l},getTypeCusto:function(){var i=UWA.clone(this._typeCusto);if(UWA.is(this._typeCustoInst)){for(var h in this._typeCustoInst){if(this._typeCustoInst.hasOwnProperty(h)){i[h]=this._typeCustoInst[h]}}}return i},getSearchTypeCustoList:function(h){var j=[];if(this._typeCusto){for(var k in this._typeCusto){if(this._typeCusto.hasOwnProperty(k)){var l;var i=k.split(":");if(i.length>1){if(i[0]=="ds6wg"){j.push(i[1])}}else{j.push(i[0])}}}}if(this._typeCustoInst&&UWA.is(h)&&h===true){for(var k in this._typeCustoInst){if(this._typeCustoInst.hasOwnProperty(k)){var l;var i=k.split(":");if(i.length>1){if(i[0]=="ds6wg"){j.push(i[1])}}else{j.push(i[0])}}}}return j},getSearchTypeCustoListNLSNames:function(j){if(!UWA.is(j)){return}var l=this;if(this._vocabularyElementNLSInfo===null){var m=[];if(this._typeCusto){for(var n in this._typeCusto){if(this._typeCusto.hasOwnProperty(n)){m.push(n)}}}if(this._typeCustoInst){for(var n in this._typeCustoInst){if(this._typeCustoInst.hasOwnProperty(n)){m.push(n)}}}var k={service_name:"ElementsNLSNames",method:"POST",forcetoresolve:true};var i=f._asyncCallToPredicatesWS(m,k).then(function o(q){var p=null;if(b.is(q)&&q.length>0){p=JSON.parse(q);if(b.is(p)&&b.is(p.vocabularyElementNLSInfo)){if(UWA.is(j)&&UWA.is(j.onComplete)&&UWA.is(j.onComplete,"function")){l._vocabularyElementNLSInfo={};p.vocabularyElementNLSInfo.forEach(function(r){var u=r.uri;var t=u.split(":");var s;if(t.length>1){s=t[1]}else{s=t[0]}l._vocabularyElementNLSInfo[s]=r});j.onComplete.call(this,l._vocabularyElementNLSInfo)}}}},function h(){if(UWA.is(j)&&UWA.is(j.onFailure)&&UWA.is(j.onFailure,"function")){j.onFailure.call(this)}})}else{if(UWA.is(j)&&UWA.is(j.onComplete)&&UWA.is(j.onComplete,"function")){j.onComplete.call(this,l._vocabularyElementNLSInfo)}}}});return e});define("DS/SNInfraUX/SearchViewServices",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Options","DS/WAFData/WAFData","UWA/Class/Model","UWA/Class/Collection","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchUtils","text!DS/SNInfraUX/assets/SearchView.json"],function(j,k,h,c,i,a,d,f,g,b){var e=k.singleton(h,c,{_searchViewSpec:null,init:function(l){this._searchViewSpec=JSON.parse(b)},initialize:function(l){this._searchViewSpec=UWA.extend(this._searchViewSpec,l,true)},_getSourceSpecificAllPredicates:function(m){var q=this.getViewSpecs(m);var o=[];var l=Object.keys(q);if(Array.isArray(l)&&l.length>0){for(var p=0;p<l.length;p++){if(Array.isArray(q[l[p]])){o=o.concat(q[l[p]])}}}var n=o.filter(function(t,s,r){return s==r.indexOf(t)});return n},getAllSelectClause:function(r){var o=[];if(true==r){var q=Object.getOwnPropertyNames(this._searchViewSpec.SearchView);if(j.is(q,"array")&&q.length>0){var s=q.indexOf("UXSupportedFields");if(s>=0){q.splice(s,1)}}for(var p=0,l=q.length;p<l;p++){var n=this._getSourceSpecificAllPredicates(q[p]);o=o.concat(n)}}else{o=this._getSourceSpecificAllPredicates("default")}var m=[];m=o.filter(function(v,u,t){return u==t.indexOf(v)});return m},getViewSpecs:function(o,s){if(""==o){o="default"}var r=s;if(!UWA.is(r)){r=[]}var l={};if(UWA.is(this._searchViewSpec)&&this._searchViewSpec.hasOwnProperty("SearchView")){if(!this._searchViewSpec.SearchView.hasOwnProperty(o)){o="default"}var q=this._searchViewSpec.SearchView[o];if(Array.isArray(r)){if(r.length<=0){if(this._searchViewSpec.SearchView.hasOwnProperty("UXSupportedFields")){r=j.clone(this._searchViewSpec.SearchView["UXSupportedFields"])}}if(r.length>0){var m=0;for(var n=0;n<r.length;n++){if(UWA.is(q)&&q.hasOwnProperty(r[n])){l[r[m++]]=q[r[n]]}else{var p=this._searchViewSpec.SearchView["default"];if(UWA.is(p)&&p.hasOwnProperty(r[n])){l[r[m++]]=p[r[n]]}}}}}}return l}});return e});define("DS/SNInfraUX/SNVocabAccess",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Options","DS/WAFData/WAFData","UWA/Class/Model","UWA/Class/Collection","DS/SNInfraUX/SearchSettings","UWA/Promise","DS/SNInfraUX/SearchUtils","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(m,n,i,c,k,a,d,f,j,g,e){var b=a.extend({idAttribute:"name"});var l=a.extend({idAttribute:"uri"});var h=a.extend({idAttribute:"className"});var o=n.singleton(i,c,{_cacheVocabularyInfo:{},_cacheInterfacesInfo:{},_cachePredicatesInfo:{},_vocabPromises:{},_interfacePromises:{},_predicatePromises:{},init:function(p){},setResources:function(p){this.setOptions(p)},loadVocabularyClasses:function(t,v){if(!m.is(t,"object")){throw ("INVALID STATE: loadVocabularyClasses is called with incorrect arguments")}var r=t.vocabId;var p=t.tenantId;this.log("loadVocabulary called for vocabId : "+r);var s=this;if(!m.is(p)){var u=this.getOption("resources");if(m.is(u)){p=u.getActiveTenant()}else{throw ("INVALID STATE: loadVocabularyClasses is called before doing setResources")}}if(!UWA.is(this._vocabPromises[r])){this._vocabPromises[r]=new j(function(y,x){s._cacheVocabularyInfo[r]={info:new d([],{model:l})};var w={tenantId:p,lang:g.getLanguage()};w.onComplete=function(z){try{if(m.is(z,"string")&&0>=z.length){console.warn("Empty response for vocabulary : "+r);x();return}var A=null;if(m.is(z,"string")&&z.length>0){try{A=JSON.parse(z)}catch(F){console.error("Error parsing response:",F)}}else{A=z}console.log("Successfully loaded the vocabulary : "+r);var C=f.getOption("vocabToExtend_"+r,false);if(UWA.is(C)&&(C.includeCommonClasses==true)){var E=C.commonClasses;for(var B=E.length-1;B>=0;B--){A.vocabularyClassInfo.push({uri:E[B]})}}A.vocabularyClassInfo.sort(function(I,G){var J=I.nlsName;if(!UWA.is(J)){J=I.uri}J=J.toUpperCase();var H=G.nlsName;if(!UWA.is(H)){H=G.uri}H=H.toUpperCase();if(J<H){return -1}else{if(J>H){return 1}else{return 0}}});s._cacheVocabularyInfo[r].info.add(A.vocabularyClassInfo);y()}catch(D){console.error("Exception caught in SNVocabAccess.loadVocabularyClasses.onComplete ! :"+D);x()}};w.onFailure=function(A,z){console.log("FAILED to load the vocabulary : "+r);x()};e.getVocabularyClasses(r,w)})}var q=function(){if(UWA.is(v)){v.call(null,{classInfos:s._cacheVocabularyInfo[r].info.toJSON()})}};this._vocabPromises[r].then(q,q)},getVocabularyClasses:function(p){if(this._cacheVocabularyInfo[p]&&this._cacheVocabularyInfo[p].info.length>0){return this._cacheVocabularyInfo[p].info.toJSON()}},loadRelevantInterfaces:function(p,t){this.log("loadRelevantInterfaces called for "+p);var q=this;var s=this.getOption("resources");if(!m.is(s)){throw ("INVALID STATE: loadRelevantInterfaces is called before doing setResources")}p=p.replace("ds6wg:","");if(!UWA.is(this._interfacePromises[p])){this._interfacePromises[p]=new j(function(w,v){q._cacheInterfacesInfo[p]={info:new d([],{model:b})};var u=s.getFetchOptions({service_name:"getRelevantInterfaces",service_data:{classes:[p]}});u.onComplete=function(x){console.log("Successfully loaded the vocabulary : "+p);var y=null;if(m.is(x,"string")&&x.length>0){try{y=JSON.parse(x)}catch(z){console.error("Error parsing response:",z)}}else{y=x}y.results[0].interfaces.sort(function(B,A){if(B.nlsName.toUpperCase()<A.nlsName.toUpperCase()){return -1}else{if(B.nlsName.toUpperCase()>A.nlsName.toUpperCase()){return 1}else{return 0}}});q._cacheInterfacesInfo[p].info.add(y.results[0].interfaces);w()};u.onFailure=function(y,x){console.log("FAILED to load the vocabulary : "+p);v()};k.authenticatedRequest(u.url,u)})}var r=function(){if(UWA.is(t)){t.call(null,{interfaces:q._cacheInterfacesInfo[p].info.toJSON()})}};this._interfacePromises[p].then(r,r)},RemoveDuplicateJsonObj:function(t,s){if(!m.is(t)){return}var p=[];for(var r=0;r<t.length;r++){if(t[r].hasOwnProperty(s)){for(var q=0;q<p.length;q++){if(t[r][s]==p[q][s]){break}}if(q==p.length){p.push(t[r])}else{console.log(t[r].nlsName+" is ignored : DUPLICATE :"+t[r][s])}}}return p},loadRelevantPredicates:function(r,v){if(!m.is(r,"object")){throw ("INVALID STATE: loadRelevantPredicates is called with incorrect arguments")}var s=r.className;var q=r.tenantId;this.log("loadRelevantPredicates called for "+s);var t=this;if(!m.is(q)){var u=this.getOption("resources");if(m.is(u)){q=u.getActiveTenant()}else{throw ("INVALID STATE: loadRelevantPredicates is called before doing setResources")}}if(!UWA.is(this._predicatePromises[s])){this._predicatePromises[s]=new j(function(y,x){t._cachePredicatesInfo[s]={status:"waiting",info:new d([],{model:h})};var w={tenantId:q,lang:g.getLanguage()};w.onComplete=function(C){console.log("Successfully loaded the vocabulary : "+s);var B=null;if(m.is(C,"string")&&C.length>0){try{B=JSON.parse(C)}catch(E){console.error("Error parsing response:",E)}}else{B=C}if(m.is(B)){var A=[];if(m.is(B.classPredicates,"array")&&B.classPredicates.length>0){for(var D=0,z=B.classPredicates.length;D<z;D++){A.push(o.RemoveDuplicateJsonObj(B.classPredicates[D].vocabularyPredicateInfo,"uri"))}}if(m.is(A,"array")&&A.length>0){for(var D=0,z=A.length;D<z;D++){t._cachePredicatesInfo[s].info.add(A[D])}}y()}else{console.log("Response Object is EMPTY : "+s);x()}};w.onFailure=function(A,z){console.log("FAILED to load the vocabulary : "+s);x()};e.getPropertiesForClass(s,w)})}var p=function(){if(UWA.is(v)){v.call(null,{vocabularyPredicateInfo:t._cachePredicatesInfo[s].info.toJSON()})}};this._predicatePromises[s].then(p,p)},loadPLMSuggestList:function(u,w){var t=this.getOption("resources");if(!m.is(t)){throw ("INVALID STATE: loadPLMSuggestList is called before doing setResources")}var v=g.getLanguage();var p=f.getOption("PLMParamNLS");var r="plmparam.title";if(m.is(p,"object")&&m.is(p[v],"string")){r=p[v]}var q=t.getFetchOptions({service_name:"listAvailablePamameters",service_data:{query:"type:PlmParameter AND ["+r+"]:("+u+")",order_field:"plmparam.title",select_predicate:[r,"plmparam.itf","plmparam.displayunit","plmparam.title"],source:["3dspace"],nresults:101}});var s=this;q.onComplete=function(z){console.log("Successfully loaded the suggest list for : "+u);var y=null;if(m.is(z,"string")&&z.length>0){try{y=JSON.parse(z)}catch(A){console.error("Error parsing response:",A)}}else{y=z}if(m.is(w,"function")){var x={plmtitle:u,info:y.results};w.call(undefined,x)}};q.onFailure=function(y,x){console.log("Failure loaded the suggest list for : "+x)};k.authenticatedRequest(q.url,q)},loadSearchSuggestList:function(r,u,q){var t=this.getOption("resources");if(!m.is(t)){throw ("INVALID STATE: loadSearchSuggestList is called before doing setResources")}var p=t.getFetchOptions({service_name:"listSuggestPamameters",service_data:r});var s=this;p.onComplete=function(x){console.log("Successfully loaded the suggest list for : ");var w=null;if(m.is(x,"string")&&x.length>0){try{w=JSON.parse(x)}catch(y){console.error("Error parsing response:",y)}}else{w=x}if(m.is(u,"function")){var v=w;u.call(undefined,v)}};p.onFailure=function(w,v){console.log("Failure loaded the suggest list for : "+v);if(m.is(q,"function")){q.call(undefined)}};k.authenticatedRequest(p.url,p)},_sendCallbacks:function(p,r){var q=p.length;for(var s=0;s<q;s++){p[s].call(undefined,r)}},getVocabularyName:function(q){var p={"3dspace":"ds6wg"};return UWA.is(p[q])?p[q]:q},IsClassAnInstance:function(r){this.log("IsClassAnInstance called for "+r);var q=false;var p=r.split(":");if(p.length===2){if(m.is(this._cacheVocabularyInfo[p[0]])){var s=this._cacheVocabularyInfo[p[0]].info.get(r);if("Instance"===s.get("type")){q=true}}}return q}});return o});define("DS/SNInfraUX/SNUnitConversion",["UWA/Core","UWA/Class","UWA/Class/Options","UWA/Class/Debug","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SNVocabAccess","DS/SNInfraUX/SWFiltering","DS/SNInfraUX/SNPLMDictionary"],function(g,h,c,f,d,i,b,a){var e=h.singleton(f,c,{name:"DS_SNInfraUX_SNUnitConversion",_predicateDimensionName:{},_manipulationUnit:{},init:function(j){this.setDebugMode(d.getDebugMode())},setResources:function(j){i.setResources({resources:j});a.setResources({resources:j})},getPreferredUnitLabelForPredicate:function(j){var k=this;var n=j.predicates;var m=j.callback;var l={};n.forEach(function(r){if(r.startsWith("ds6wg")){var o=k._manipulationUnit[r];var p=k._predicateDimensionName[r];var q=a.getUnitNLSForDimension(p,o);l[r]=q}});m.call(undefined,l)},loadManipulationUnitForTypePredicates:function(j,l){var k=this;i.loadRelevantPredicates({className:j},function(m){var n=m.vocabularyPredicateInfo;if(n){n.forEach(function(p){var o=UWA.is(p.lineage)?p.lineage:p.uri;var q=p.manipulationUnit;if(q&&q.trim().length>0){k._manipulationUnit[o]=q.trim();k._predicateDimensionName[o]=p.dimension}})}l.call(undefined,j)})},getManipulationUnitForPredicateURI:function(j){return this._manipulationUnit[j]},getDimensionNameForPredicateURI:function(j){return this._predicateDimensionName[j]},convertValues:function(s){var k=s.data;var p=s.callback;var n=s.toPreferredUnit;var m=s.predicate2Type;var l=this;var q=function(){var t={};var v={};var w={Data:[]};Object.keys(k).forEach(function(A){var E=l.getManipulationUnitForPredicateURI(A);if(E){var B=k[A];var y=B.join(";");var x=l.getDimensionNameForPredicateURI(A);var z=a.getMKSUnitNameForDimensionName(x);var C,D;if(n){C=z;D=E}else{C=E;D=z}if(C!=D){w.Data.push({UnitFrom:C,UnitTo:D,Dimension:x,Values:y})}}});var u=function(){var x=d.getOption("preferredUnit_decimals");Object.keys(k).forEach(function(C){var E=k[C];t[C]={};var F=l.getManipulationUnitForPredicateURI(C);var y=l.getDimensionNameForPredicateURI(C);var A;var B="";if(y){A=a.getMKSUnitNameForDimensionName(y)}if(F){var D=n?A:F;var z=n?F:A;if(n){B=a.getUnitNLSForDimension(y,z)}E.forEach(function(G){var J;if(v[D]){J=v[D][z]}var I=J&&J[G]?J[G]*1:G;if(n&&g.is(x,"number")){I=(Math.round(I+"e"+x)+"e-"+x)*1}var H=I;if(B.length>0){H=H+" "+B}t[C][G]=H})}else{if(n&&A){B=a.getUnitNLSForDimension(y,A)}k[C].forEach(function(G){var H=G;if(B.length>0){H=H+" "+B}t[C][G]=H})}})};if(w.Data.length>0){a.loadConvertedMKSValues(w,function(x){x.forEach(function(A){var C=A.UnitFrom;var E=A.UnitTo;var y=A.ValuesToConvert.split(";");var B=A.ConvertedValues.split(";");if(!v[C]){v[C]={}}if(!v[C][E]){v[C][E]={}}var D=v[C][E];for(var z=0;z<y.length;z++){D[y[z]]=B[z]}});u.call();p.call(undefined,t)})}else{u.call();p.call(undefined,t)}};var r={};var o=function(){var t=Object.keys(r).every(function(u){return r[u]});if(t){a.loadDictionary().then(q)}};var j=function(t){if(t){r[t]=true}o()};if(Object.keys(k).length>0){Object.keys(k).forEach(function(u){var t=m[u];if(t&&t.startsWith("ds6wg:")){if(!g.is(r[t])){r[t]=false;l.loadManipulationUnitForTypePredicates(t,j)}}else{j()}})}else{p.call(undefined,{})}}});return e});define("DS/SNInfraUX/SearchRessources",["UWA/Core","UWA/Class","UWA/Class/Options","DS/WAFData/WAFData","DS/SNInfraUX/SearchSettings","DS/SNInfraUX/SearchPreferences","DS/SNInfraUX/SearchDebug","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/SWFiltering","DS/WebappsUtils/WebappsUtils","DS/SNInfraUX/SNSearchTypeCusto","DS/SNInfraUX/SearchViewServices","DS/SNInfraUX/SearchVersioning","DS/SNInfraUX/SearchLogin"],function(n,o,f,l,h,k,m,i,d,b,c,g,j,e){var a=o.extend(m,f,{uwaClassName:"DS/SNInfraUX/SearchRessources",source_names:["cstorage","hpc","search","swym","tagger"],valid:false,active_tenant:"",available_tenants:{},active_role:null,_fedSearchLabel:"",available_services:{fed_search:function(R){var aj=R.original_options||{};var O=h.getOption("fedSearchTimeout");if(n.is(O)){console.log("fedSearchTimeout found, value=",O);if(!isNaN(O)){var J=+O;if(J>0){aj.timeout=J*1000}}}var T=i.SearchTypeEnum.MY_RECENT_CONTENT===R.service_data.query?true:false;aj.method="POST";aj.headers={Accept:"application/json","Content-Type":"application/json"};var ao=R.original_options.data||{};if(R.service_data.specific_source_parameter){ao.specific_source_parameter=R.service_data.specific_source_parameter}if(T){aj.url=this.getFedSearchUrl()+"/recent";var L=h.getOption("Recent_Content_Delta_Time",{tenant:this.getActiveTenant()});ao.delta_time_interval=L*60;ao.version=2;if(R.service_data.recent_search&&R.service_data.recent_search.types){ao.select_type=R.service_data.recent_search.types}}else{aj.url=this.getFedSearchUrl()+"/search";ao.with_indexing_date=true}ao.with_nls=true;if(h.getOption("activate_dictionary_NLS_computation")){ao.with_nls=false}var v=new Date();this._fedSearchLabel="3DSearch-"+i.getUserId()+"-"+v.getTime();ao.label=this._fedSearchLabel;ao.locale=i.getLanguage();aj.ajax=l.authenticatedRequest;var ai=[];if(R.context_options&&R.context_options.columns){ai=UWA.clone(R.context_options.columns)}if(R.attributesToRetrieve){Array.prototype.push.apply(ai,R.attributesToRetrieve)}var ac=true;ai=ai.concat(g.getAllSelectClause(ac));if(h.getOption("SEARCH_INSTANCES")===true){ai=ai.concat("ds6wg:isAnInstance")}var K=ai.filter(function(at,ar,u){return ar==u.indexOf(at)});var w=d.getSelectPredicates();if(UWA.is(w,"array")){K=w}if(K.length>0){ao.select_predicate=K}if(R.context_options){if(R.context_options.resourceid_in){ao.resourceid_in=UWA.clone(R.context_options.resourceid_in)}if(R.context_options.resourceid_not_in){ao.resourceid_not_in=UWA.clone(R.context_options.resourceid_not_in)}}ao.select_file=["icon","thumbnail_2d"];if(!T){ao.query=R.service_data.query;if(ao.query=="*"){ao.query="#all"}if(0===R.service_data.query.indexOf(i.SearchTypeEnum.MY_CONTENT)||R.service_data.queryType===i.SearchTypeEnum.MY_CONTENT){var Q=i.getUserId();ao.query=R.service_data.query.replace(i.SearchTypeEnum.MY_CONTENT,"(owner:"+Q+" OR username:"+Q+")");var am=c.getSearchTypeCustoQuery();if(am.length>0){i.addSourceSpecificParameter(ao,{sourceIds:["3dspace"],param:{id:"additional_query",value:" AND ("+am+")"}})}if(n.is(R.context_options)&&n.is(R.context_options.precond,"string")&&0<R.context_options.precond.length){ao.query=ao.query+" AND ("+R.context_options.precond+")"}}if(R.service_data.queryType===i.SearchTypeEnum.FAVORITE_SEARCH){ao.query="((owner:"+i.getUserId()+" AND flattenedtaxonomies:types/PLMWspFavoriteSearch) OR flattenedtaxonomies:types/SavedSearch)"}if(n.is(R.service_data.searchInCriteria,"string")&&0<=R.service_data.searchInCriteria.length){ao.query+=" AND ("+R.service_data.searchInCriteria+")"}var an={};if(UWA.is(R.service_data.refine,"object")&&UWA.is(R.service_data.refine.allfilters,"object")){var F={};for(var ag in R.service_data.refine.allfilters){if(ag.indexOf("sixw:")!==0){F[ag]=R.service_data.refine.allfilters[ag]}}an=this.treatMyContentRefine(F);if(UWA.is(an,"object")){if(UWA.is(an.additionalQuery,"string")&&an.additionalQuery.length>0){i.addSourceSpecificParameter(ao,{sourceIds:["3dspace"],param:{id:"additional_query",value:an.additionalQuery}})}}ao.refine=F}var af=d.getAdditionalQueryCriteria();if(UWA.is(af)){i.addSourceSpecificParameter(ao,{sourceIds:["3dspace"],param:{id:"additional_query",value:" "+af}})}var t=d.getSpecificSourceParameter();if(UWA.is(t)){i.addSourceSpecificParameter(ao,{sourceIds:[t.source],param:{id:t.parameter,value:t.value}})}var C=R.context_options?true:false,H=(R.service_data&&R.service_data.isAPQSearch)?true:false,Z=(R.service_data.adv_search&&UWA.is(R.service_data.advanced_criteria,"string")&&(R.service_data.advanced_criteria.indexOf("flattenedtaxonomies")>=0||R.service_data.advanced_criteria.indexOf("[ds6w:type]")>=0))?true:false,G=(ao.query.indexOf("flattenedtaxonomies")>=0||ao.query.indexOf("[ds6w:type]")>=0)?true:false,ad=(UWA.is(R.service_data.refine,"object")&&UWA.is(R.service_data.refine.allfilters,"object")&&R.service_data.refine.allfilters.hasOwnProperty("ds6w:what/ds6w:type")),U=(R.service_data.query.indexOf("#similarity")>=0)?true:false;var s=true;if(R.context_options&&UWA.is(R.context_options.show_banned_types)){s=R.context_options.show_banned_types}if(!(C&&s)&&!H&&!U){var ap="";var V=h.getOption("topbar_search_banned_list");if((!Z&&!G&&!ad)||(C&&!s)){var ae=UWA.is(V)?V.types:[];if(i.isBetaEnabledForUser()){var Y=h.getOption("topbar_search_banned_list_beta");var X=UWA.is(Y)?Y.types:[];if(X.length>0){ae=ae.concat(X)}}ap=this._createBannedTypeQuery(ae)}if(this.active_tenant!=="OnPremise"){var x=UWA.is(V)?V.users:[];if(UWA.is(x,"array")&&x.length>0){ap+=" AND NOT (";for(var aa=0;aa<x.length;aa++){ap+='owner:"'+x[aa]+'"';if(aa<x.length-1){ap+=" OR "}}ap+=")"}}if(ap.length>0){i.addSourceSpecificParameter(ao,{sourceIds:["3dspace"],param:{id:"additional_query",value:ap}})}}if(R.service_data.incontext_precond_2){ao.query="("+ao.query+")AND("+R.service_data.incontext_precond_2+")"}var M=h.getOption("irrelevant_tags",{tenant:this.getActiveTenant()});if(UWA.is(M,"array")&&M.length>0){if(!UWA.is(ao.select_exclude_synthesis,"array")){ao.select_exclude_synthesis=[]}for(var al=0;al<M.length;al++){var E=M[al];if(-1===ao.select_exclude_synthesis.indexOf(E)){ao.select_exclude_synthesis.push(E)}}}if(UWA.is(R.select_exclude_synthesis,"array")&&R.select_exclude_synthesis.length>0){if(!UWA.is(ao.select_exclude_synthesis,"array")){ao.select_exclude_synthesis=R.select_exclude_synthesis}else{ao.select_exclude_synthesis=ao.select_exclude_synthesis.concat(R.select_exclude_synthesis)}}if(UWA.is(R.select_exclude_synthesis,"array")&&R.select_exclude_synthesis.length>0&&R.select_exclude_synthesis.indexOf("ds6w:dataSource")>=0){if(UWA.is(M,"array")&&!(M.indexOf("ds6w:dataSource")>=0)){ao.select_exclude_synthesis.push("ds6w:dataSource")}}else{if(UWA.is(M,"array")&&!(-1===M.indexOf("ds6w:dataSource"))){var q=i.getSourceToPredicateMapping();if(UWA.is(q,"array")){for(var al=0;al<q.length;al++){var B=q[al];if(UWA.is(B,"object")&&UWA.is(B.predicate,"string")){if(-1===ao.select_exclude_synthesis.indexOf(B.predicate)){ao.select_exclude_synthesis.push(B.predicate)}}}}}}this._addOrderInfo(R,ao);if(UWA.is(ao.specific_source_parameter)&&UWA.is(R.service_data.context)){this.mergeRecursive(ao.specific_source_parameter,R.service_data.context.specific_source_parameter)}else{UWA.merge(ao,R.service_data.context)}var aq="";var y=k.getItem("revisionDisplayType");var N=h.getOption("defaultRevision",{tenant:this.active_tenant});var D=h.getOption("show_search_results_revision_array");var p=D[0];if(!n.is(y)){y=(N)?N:p}if(UWA.is(y)){aq=y.exprn;i.addSourceSpecificParameter(ao,{sourceIds:["3dspace"],param:{id:"additional_query",value:aq}})}if(h.getOption("add_taxonomies_in_select_clause")===true){if(UWA.is(ao.select_predicate,"array")){ao.select_predicate.push("taxonomies")}}if(i.isSnippetAvailable(this.getActiveTenant())===true){var S=h.getOption("select_snippets");if(UWA.is(S)&&UWA.is(S,"object")){var ak=Object.keys(S).map(function(u){return S[u]});if(n.is(ak,"array")){ao.select_snippets=ak}}}ao.nresults=""+R.state.pageSize;if(R.state.next_start===undefined){ao.start="0"}else{ao.next_start=R.state.next_start}if(UWA.is(R.service_data.in_ctx_role)&&h.getOption("activate_default_role")){ao.user_ctx=R.service_data.in_ctx_role}else{if(h.getOption("activate_default_role")){ao.user_ctx=h.getOption("default_user_ctx")}}}if(R.service_data.query.indexOf("#similarity")>=0){ao.source=["onepart"]}else{if(UWA.is(R.service_data.isAPQSearch)){ao.source=["3dspace"]}else{if(R.service_data.queryType===i.SearchTypeEnum.FAVORITE_SEARCH){ao.source=["3dspace"]}else{if(UWA.is(R.service_data.source)){ao.source=R.service_data.source}else{if(UWA.is(R.source)){ao.source=R.source}else{if(!n.is(ao.source)){ao.source=[]}}}}}}if(UWA.is(an,"object")&&true===an.isRefineOnlyFavorite){ao.source=["3dspace"]}if(ao.source.length==0){var P=e.getAvailableSources(this.active_tenant);if(UWA.is(P)&&(0<P.length)){if(!i.isInTheSimpleSearch({tenant:this.active_tenant})){var z=h.getOption("exclusiveDataSourcesForSSE",{tenant:this.active_tenant});if(UWA.is(z)&&(0<z.length)){P=P.filter(function(u){return(-1===z.indexOf(u.name))});P.forEach(function(u){ao.source.push(u.name)})}}}}if(UWA.is(ao.source,"array")&&(ao.source.length==0||ao.source.indexOf("drive")>=0)){var ah=' AND NOT ([flattenedtaxonomies]:"types/DriveNode" AND [current]:"Trashed")';if(UWA.is(ah)){i.addSourceSpecificParameter(ao,{sourceIds:["drive"],param:{id:"additional_query",value:ah}})}}if(h.getOption("enablePLM",{tenant:this.getActiveTenant()})&&(R.service_data.adv_search===true)){if(UWA.is(R.service_data)&&UWA.is(R.service_data.refine)&&UWA.is(R.service_data.refine.PLMParameters)){if(UWA.is(R.service_data.refine.PLMParameters.plmparam)){if(Object.keys(R.service_data.refine.PLMParameters.plmparam).length!==0){var A={"3dspace":R.service_data.refine.PLMParameters};ao.specific_source_parameter=A}}}}ao.tenant=this.active_tenant;if(UWA.is(this.active_role)){var W={SecurityContext:this.active_role};var r={"3dspace":W};ao.login=r}aj.data=ao;if(this.is_odt_source()){var I=aj.onComplete,ab=aj.onFailure;aj={};aj.method="GET";aj.headers={Accept:"application/json"};aj.auth={};aj.proxy="";aj.url=R.service_data.query;if(UWA.is(I,"function")){aj.onComplete=I}if(UWA.is(ab,"function")){aj.onFailure=ab}}return aj},logOut:function(p){var q=p.original_options||{};q.method="POST";q.headers={Accept:"application/json","Content-Type":"application/json"};q.url=this.getFedSearchUrl()+"/logout";return q},getSavedSearches:function(p){var r=p.original_options||{};r.method="GET";r.headers={Accept:"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/savedSearches";var q=p.service_data||{};r.data={page:1,pageSize:"all"};return r},saveSearch:function(p){var s=p.original_options||{};s.method="POST";s.headers={Accept:"application/json","Content-Type":"application/json"};var q=i.getSecurityContext();if(q&&q.trim().length>0){s.headers.SecurityContext=q}s.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/saveSearch";var r=p.service_data||{};s.data=JSON.stringify(r);return s},renameSavedSearch:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Content-Type":"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/updateSearch";var q=p.service_data||{};r.data=JSON.stringify(q);return r},runSavedSearch:function(p){var q=p.original_options||{};q.method="GET";q.headers={Accept:"application/json","Content-Type":"application/json"};q.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/savedSearch";q.data="id="+p.service_data.id;return q},deleteSearch:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json, application/xml","Content-Type":"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/deleteSearch";var q=p.service_data||{};r.data=JSON.stringify(q);return r},shareSearch:function(p){var s=p.original_options||{};s.method="POST";s.headers={Accept:"application/json, application/xml","Content-Type":"application/json"};var q=i.getSecurityContext();if(q&&q.trim().length>0){s.headers.SecurityContext=q}s.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/savedSearch/lifecycle/share";var r=p.service_data||{};s.data=JSON.stringify(r);return s},unshareSearch:function(p){var s=p.original_options||{};s.method="POST";s.headers={Accept:"application/json, application/xml","Content-Type":"application/json"};var q=i.getSecurityContext();if(q&&q.trim().length>0){s.headers.SecurityContext=q}s.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_services/savedSearch/lifecycle/unshare";var r=p.service_data||{};s.data=JSON.stringify(r);return s},lastObjects:function(p){var q=p.original_options||{};q.method="GET";q.headers={Accept:"application/json","Content-Type":"application/json"};q.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/AppsMngt/user/objects";return q},actions_for_results:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Content-Type":"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/search_delegation/actions";var q=p.service_data||{};r.data=JSON.stringify(q);return r},fed_search_odt:function(p){var q=p.original_options||{};q.method="GET";q.headers={Accept:"application/json"};q.auth={};q.proxy="";q.url=p.service_data.url;return q},loginToSources:function(p){var q=p.original_options||{};q.method="GET";q.headers={Accept:"application/json","Content-Type":"application/json"};q.data={tenant:this.active_tenant};q.url=this.getFedSearchUrl()+"/login";return q},listAvailablePamameters:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Content-Type":"application/json"};r.url=this.getFedSearchUrl()+"/search/suggestresult";var q=p.service_data||{};q.tenant=this.active_tenant;r.data=JSON.stringify(q);return r},listSuggestPamameters:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Content-Type":"application/json"};r.url=this.getFedSearchUrl()+"/search";var q=p.service_data||{};q.tenant=this.active_tenant;r.data=JSON.stringify(q);return r},getConvertedMKSValues:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Content-Type":"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/dictionary/dimensions/convertValues";var q=p.service_data||{};q.tenant=this.active_tenant;r.data=JSON.stringify(q);return r},getRelevantInterfaces:function(p){var r=p.original_options||{};r.method="POST";r.headers={Accept:"application/json","Accept-Language":i.getLanguage(),"Content-Type":"application/json"};r.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/dictionary/class/interfaces";var q=p.service_data||{};r.data=JSON.stringify(q);return r},listDimensions:function(p){var q=p.original_options||{};q.method="GET";q.headers={"Accept-Language":i.getLanguage(),Accept:"application/json"};q.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/dictionary/dimensions";return q},getSecurityContext:function(p){var q=p.original_options||{};q.method="GET";q.headers={"Accept-Language":i.getLanguage(),Accept:"application/json"};q.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/pno/person/getsecuritycontext";return q},loadPQData:function(p){var q=p.original_options||{};q.method="GET";q.headers={"Accept-Language":i.getLanguage(),Accept:"application/json"};q.data={tenant:this.active_tenant};q.url=this.available_tenants[this.active_tenant].sources.cstorage.url+"/resources/SNAPI/pq_services/pqs?lang="+i.getLanguage();return q}},_createBannedTypeQuery:function(p){var r="";if(UWA.is(p,"array")&&p.length>0){r+=" AND NOT (flattenedtaxonomies:(";for(var q=0;q<p.length;q++){r+='"types/'+p[q]+'"';if(q<p.length-1){r+=" OR "}}r+="))"}return r},init:function(x,w){this.setDebugMode(h.getOption("debug_mode"));this._reset_internals();if(!n.is(x)){throw new Error("SearchRessources:init called without valid options!")}if(n.is(x.platforms)){i.setPlatforms(x.platforms)}if(UWA.is(x.available_tenants)&&UWA.is(x.active_tenant)){this.active_tenant=x.active_tenant;this.available_tenants=x.available_tenants}else{var t="";for(var q=0;q<this.source_names.length;q++){var v=this.source_names[q];if(UWA.is(x[v])){for(var u=0;u<x[v].length;u++){var r=x[v][u];if(!UWA.is(this.available_tenants[r.id])){this.available_tenants[r.id]={sources:{},displayName:r.displayName}}this.available_tenants[r.id].sources[v]={displayName:r.displayName,url:r.url};if(UWA.is(r.odt)){this.available_tenants[r.id].sources[v].odt=r.odt}if((q===0&&u===0)||t.length===0){var p=this.available_tenants[r.id];if(UWA.is(p)&&UWA.is(p.sources)&&UWA.is(p.sources.search)){t=r.id}}}}}var s=k.getItem("defaultTenantId");if(n.is(s,"string")&&s.length>0){if(n.is(this.available_tenants[s])){t=s}}if(n.is(this.available_tenants)&&this.available_tenants!=={}){if(n.is(this.available_tenants[t])){this.setActiveTenant(t)}this.valid=true}}if(UWA.is(w,"function")){w.call(this,{})}},_addOrderInfo:function(p,q){if(n.is(p.service_data.order_field)&&(p.service_data.order_field.length>0)&&n.is(p.service_data.order_by)&&(p.service_data.order_by.length>0)){q.order_by=p.service_data.order_by;q.order_field=p.service_data.order_field}else{q.order_by="desc";q.order_field="relevance"}},mergeRecursive:function(s,r){for(var q in r){if(r.hasOwnProperty(q)){if(UWA.is(s[q],"array")){s[q]=s[q].concat(r[q])}else{if(UWA.is(s[q],"object")&&UWA.is(r[q],"object")){this.mergeRecursive(s[q],r[q])}else{if(!s[q]){s[q]=r[q]}else{}}}}}},treatMyContentRefine:function(q){var p={};if(q.hasOwnProperty("ds6w:what/ds6w:category")){var u=UWA.clone(q["ds6w:what/ds6w:category"]);var v=false,r=false,t=false;for(var w=u.length-1;w>=0;w--){if(u[w].object==="#myFavoriteSearches"){v=true;u.splice(w,1)}else{if(u[w].object==="#myFavoriteContent"){r=true;u.splice(w,1)}else{if(u[w].object==="#myOtherContent"){t=true;u.splice(w,1)}}}}var s="";if(v||r||t){if(v&&!r&&!t){s+=" AND ([ds6w:type]:PLMWspFavoriteSearch OR [ds6w:type]:SavedSearch)"}else{if(r&&!v&&!t){s+=" AND ([ds6w:type]:PLMWspFavoriteAuthoring OR [ds6w:type]:PLMWspFavoriteNavigation)"}else{if(t&&!v&&!r){s+=" AND NOT ([ds6w:type]:PLMWspFavoriteSearch OR [ds6w:type]:SavedSearch OR [ds6w:type]:PLMWspFavoriteAuthoring OR [ds6w:type]:PLMWspFavoriteNavigation)"}else{if(r&&v&&!t){s+=" AND ([ds6w:type]:PLMWspFavoriteSearch OR [ds6w:type]:SavedSearch OR [ds6w:type]:PLMWspFavoriteAuthoring OR [ds6w:type]:PLMWspFavoriteNavigation)"}else{if(r&&t&&!v){s+=" AND NOT [ds6w:type]:PLMWspFavoriteSearch AND NOT [ds6w:type]:SavedSearch"}else{if(v&&t&&!r){s+=" AND NOT ([ds6w:type]:PLMWspFavoriteAuthoring OR [ds6w:type]:PLMWspFavoriteNavigation)"}}}}}}}if(u.length===0){delete q["ds6w:what/ds6w:category"]}p.additionalQuery=s;if((false===t)&&(true===v||true===r)){p.isRefineOnlyFavorite=true}else{p.isRefineOnlyFavorite=false}}return p},PredicatesNLSNames:function(p,s){var q=this;var r=function(u){if(UWA.is(u,"array")){var t=q.getActiveTenant();var w=i.getLanguage();var v={tenantId:t,lang:w};s.call(undefined,v)}};r.call(undefined,[])},getFetchOptions:function(p){var r=p.original_options||{},q=p.service_name;if(q in this.available_services){this.log("getFetchOptions for service "+q);r=this.available_services[q].call(this,p)}else{throw new Error("Unknown federated service "+q)}return r},setActiveTenant:function(p){if(UWA.is(this.available_tenants[p])||p==="3DDashboard"){this.active_tenant=p}else{console.warn("Unknown tenant "+p);throw new Error("Unknown tenant "+p)}},getActiveTenant:function(){return this.active_tenant},toJSON:function(){return{active_tenant:this.active_tenant,available_tenants:this.available_tenants}},getAvailableTenants:function(){var q=[];for(var p in this.available_tenants){if(this.available_tenants.hasOwnProperty(p)){var r=this.available_tenants[p];if(UWA.is(r)&&UWA.is(r.sources)&&UWA.is(r.sources.search)){q.push({tenantId:p,displayName:this.available_tenants[p].displayName})}else{console.warn("tenant "+p+" does not have search service available, so not listed in UI")}}}return q},getTenantDisplayName:function(q){if(UWA.is(this.available_tenants,"object")){var p=this.available_tenants[q];if(UWA.is(p,"object")){return p.displayName}}},getTenantInfo:function(p){return this.available_tenants[p]},get3DSpaceUrl:function(){var q="";var p=this.available_tenants[this.active_tenant];if(UWA.is(p)&&UWA.is(p.sources)&&UWA.is(p.sources.cstorage)){q=p.sources.cstorage.url}return q},getFedSearchUrl:function(r){var q="";var p;if(n.is(r,"string")){p=this.available_tenants[r]}else{p=this.available_tenants[this.active_tenant]}if(UWA.is(p)&&UWA.is(p.sources)&&UWA.is(p.sources.search)){q=p.sources.search.url;if(UWA.is(q)){if(-1===q.lastIndexOf("/federated")){q+="/federated"}}}return q},getVocabularyUrl:function(){var p="";var q=this.available_tenants[this.active_tenant];if(UWA.is(q)&&UWA.is(q.sources)&&UWA.is(q.sources.cstorage)){p=q.sources.cstorage.url}else{if(UWA.is(q)&&UWA.is(q.sources)&&UWA.is(q.sources.tagger)){p=q.sources.tagger.url}}return p},is_odt_source:function(p){if(h.getOption("odt_active",true)===true){return true}else{var q=false;if(n.is(this.active_tenant,"string")&&this.active_tenant.length>0&&n.is(this.available_tenants)&&n.is(this.available_tenants[this.active_tenant])&&n.is(this.available_tenants[this.active_tenant].sources)){q=(n.is(p)&&n.is(this.available_tenants[this.active_tenant].sources[p]))?this.available_tenants[this.active_tenant].sources[p].odt:(n.is(this.available_tenants[this.active_tenant].sources.search)?this.available_tenants[this.active_tenant].sources.search.odt:false)}return UWA.is(q)?q:false}},_reset_internals:function(){this.available_tenants={};this.valid=false;this.active_tenant=""},getFedSearchLabel:function(){return this._fedSearchLabel},getServicewithRole:function(p,s){var q=this;var r=function(u){if(UWA.is(u,"array")){var t=p.tenantId;if(!n.is(t)){t=q.getActiveTenant()}var w=i.getLanguage();if("zh"==w){w+="_CN"}var v={tenantId:t,lang:w};s.call(undefined,v)}};r.call(undefined,[])},getSuggestions:function(r,u){var t=this;if(!n.is(r,"object")||!n.is(r.query,"string")){return}else{if(n.is(r.input,"array")&&r.input.length>0){r.input.pop()}}var q=this.getFedSearchUrl()+"/suggest",s=i.getSecurityContext();var p={method:"GET",data:{query:r.query,SecurityContext:(s&&s.trim().length>0)?s:undefined,tenant:this.active_tenant,field:"ds6w:label"},headers:{"Accept-Language":i.getLanguage(),Accept:"application/json"},onComplete:function(v){if(v){v=JSON.parse(v)}if(UWA.is(v,"object")){return u(t._prioritizeSuggestions(v,r.query))}else{return u([])}},onFailure:function(v){console.error(v);return u([])}};if(true===i.isSuggestAvailable(this.getActiveTenant())){l.authenticatedRequest(q,p)}else{p.onComplete()}},_prioritizeSuggestions:function(q,u){var v=q;var s=["swym","drive","3dspace","dashboard"];var w=[];var r=7;var y=false;var p=i.getDeviceCategory();if(n.is(h.getOption("search_compact_mode"))&&h.getOption("search_compact_mode")===true){r=3}for(var x=0;x<r;x++){s.forEach(function(t){y=false;if(UWA.is(v[t])&&UWA.is(v[t].entries)){if(x<v[t].entries.length){if(w.length<r){var B=v[t].entries[x];var A=B.entry;if(w.length==0){w.push(B)}else{for(var z=0;z<w.length;z++){if(w[z].entry===A){y=true;break}}if(y==false){w.push(B)}}}}}})}return w},setSecurityContext:function(p){this.active_role=p},getUserPicture:function(q){if(!n.is(q.login,"string")||!n.is(q.format,"string")){}if(!n.is(this.available_tenants)||!n.is(this.active_tenant)){return}var s=this.available_tenants[this.active_tenant];if(!n.is(s)||!n.is(s.sources)){return}var r=s.sources.swym;if(!n.is(r)){return[b.getWebappsAssetUrl("SNResultUX","images/anonymized_34x34.png")]}var p=r.url;if(!n.is(p)){return}return("{0}/api/user/getpicture/login/{1}/format/{2}".format(p,q.login,q.format))}});return a});define("DS/SNInfraUX/SearchRealTimeRessources",["UWA/Class","UWA/Class/Options","DS/SNInfraUX/SearchRessources","DS/SNInfraUX/SearchDebug"],function(e,c,a,b){var d=e.extend(a,b,c,{uwaClassName:"DS/SNInfraUX/SearchRealTimeRessources",source_names:["cstorage","hpc","search","swym"],valid:false,active_tenant:"",available_tenants:{},init:function(f,g){this.noTag=true;this._parent(f,g)}});return d});