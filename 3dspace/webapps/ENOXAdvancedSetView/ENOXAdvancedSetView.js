define("DS/ENOXAdvancedSetView/js/ENOXAdvancedSetView",["DS/W3DXComponents/Views/Item/SetView"],function(a){var b=a.extend({name:"advanced-set-view",init:function(c){this._parent.call(this,c)},setup:function(c){var e=this;e.currentFilters=null;e.currentFilters=null;e.customFilters={};e.customSorters={};var f=[];for(var d=0;d<e.collection._models.length;d++){f.push(UWA.clone(e.collection._models[d]._attributes))}e.collection=new UWA.Class.Collection(f);e._referenceCollection=e.collection;e.filteredCollection=e._referenceCollection._models;e.sortedCollection=e.filteredCollection;if(c.filters){c.filters.forEach(function(g){e.addCustomFilter(g.id,g.callback)})}if(c.sorters){c.sorters.forEach(function(g){e.addCustomSorter(g.id,g.callback)})}c.modelEvents.subscribe({event:"advanced-set-view-switch"},function(g){console.log("### - ENOXAdvancedSetView - Switch view to : "+g.id);e.dispatchEvent("onSwitch",[e,g.id])});c.modelEvents.subscribe({event:"advanced-set-view-filter"},function(g){if(g!==undefined&&g!==null){console.log("### - ENOXAdvancedSetView - Apply "+g.length+" filter(s)")}e.filter(g)});c.modelEvents.subscribe({event:"advanced-set-view-sort"},function(g){if(g!==undefined&&g!==null){console.log("### - ENOXAdvancedSetView - Sort collection : "+g.id);if(g[0].id==="name"){g[0].id="title"}}e.sort(g)});c.modelEvents.subscribe({event:"advanced-set-view-add-filter"},function(g){console.log("### - ENOXAdvancedSetView - Adding new filter");e.addCustomFilter(g.id,g.callback)});c.modelEvents.subscribe({event:"advanced-set-view-add-sorter"},function(g){console.log("### - ENOXAdvancedSetView - Adding new sorter");e.addCustomSorter(g.id,g.callback)});this._parent.apply(this,arguments)},filter:function(e){var d=this,f=d._referenceCollection._models;var c=[];e.forEach(function(h,g){if(d.customFilters[h.id]!==undefined){c.push({id:h.id,exclude:h.exclude})}else{f=f.filter(function(i){if(h.exclude){return !(i.get(h.id)===h.value)}else{return i.get(h.id)===h.value}})}});c.forEach(function(h){var g=d.customFilters[h.id];if(h.exclude){f=f.filter(function(j,i){return !g(j,i)})}else{f=f.filter(g)}});d.filteredCollection=f;d.sort(d.currentSorters);d.options.modelEvents.publish({event:"advanced-set-view-filtered"})},filterByCallBack:function(d){var c=this,e=c._referenceCollection._models;d.forEach(function(g,f){e=e.filter(function(h){return g.cb(h)})});c.filteredCollection=e;c.sort(c.currentSorters);c.options.modelEvents.publish({event:"advanced-set-view-filtered"})},sort:function(h){var g=this,j=[],c=[];if(h===undefined||h===null||h.length<=0){g.currentSorters=null;g.sortedCollection=g.filteredCollection}else{g.currentSorters=h;var d=h.length-1;for(var f=d;f>=0;f--){var e=(function(){var i=f;var m=h[i].id;var l=h[i].desc;var k=g.customSorters[m];return function(p,n){if(l){var o;o=p;p=n;n=o}if(k!==undefined){var q=k(p,n);if(q!==0){return q}}else{if(p._attributes[m]>n._attributes[m]){return 1}else{if(p._attributes[m]<n._attributes[m]){return -1}}}if(i===d){return 0}else{if(l){return c[i+1](n,p)}else{return c[i+1](p,n)}}}})();c.unshift(e)}g.sortedCollection=g.filteredCollection.sort(c[0])}g.collection.reset(g.sortedCollection);g.options.modelEvents.publish({event:"advanced-set-view-sortered"})},refreshCollection:function(d){console.log("item added"+d);var e=this,f;e._referenceCollection.add(d.model);if(e.filters){for(var c in e.filters){var g=e.filters[c];if(g.indexOf("all")<0&&g.indexOf(d.model.get(c))<0){e._actualCollection.remove(d.model)}}}},addCustomFilter:function(c,d){this.customFilters[c]=d},addCustomSorter:function(d,c){this.customSorters[d]=c}});return b});define("DS/ENOXAdvancedSetView/js/GridScrollView",["DS/W3DXComponents/Views/Layout/GridView","DS/W3DXComponents/Views/Layout/NestedScrollView","css!DS/W3DXComponents/W3DXComponents"],function(d,b){var a="grid-scroll";var c=b.extend({name:a,nested:d,setup:function(e){this._parent.call(this,e);this.nestedView.listenTo(this.nestedView,"onAfterItemAdded",function(f){this.collection.dispatchEvent("onAfterItemAdded",f)})}});return c});define("DS/ENOXAdvancedSetView/js/BaseCustomView",["UWA/Class/View"],function(b){var a=b.extend({tagName:"div",setup:function(c){if(this.model){this.container.id=this.id=this.model.cid;var d=this.model.toJSON();d.withMultisel=this.options.withMultisel;d.cid=this.cid;this.container.setHTML(c(d))}},persistCheckbox:function(){var c=this.container.getElement("."+this.name+"-check");c.addClassName("persist")},unPersistCheckbox:function(){var c=this.container.getElement("."+this.name+"-check");c.removeClassName("persist")},setShading:function(d){for(var c=0;c<d.length;c++){if(d[c].criteria(this.model)){this.container.setStyle("background-color",d[c].color);this.container.addClassName("shaded");this.container.getElement(".tile-header").setStyle("outline-color",d[c].color)}}},resetShading:function(){this.container.style.backgroundColor="";this.container.removeClassName("shaded")},select:function(c){c||(c={});this.container.addClassName("selected");if(this.container.getElement("."+this.name+"-check input")){this.container.getElement("."+this.name+"-check input").checked=true}if(!c.silent){this.dispatchEvent("onSelect")}},unSelect:function(c){this.container.removeClassName("selected");if(this.container.getElement("."+this.name+"-check input")){this.container.getElement("."+this.name+"-check input").checked=false}if(c&&!c.silent){this.dispatchEvent("onUnSelect")}},isSelected:function(){return this.container.hasClassName("selected")}});return a});define("DS/ENOXAdvancedSetView/js/SampleModel",["UWA/Class/Model"],function(b){var a=b.extend({name:"SampleModel",idAttribute:"id",parse:function(j){var f={};f.canEdit=false;f.alert=f.warning=0;if(UWA.is(j,"string")){f.idAttr=f.id=j}else{f.idAttr=f.id=j["@ref"];if(j.representations&&j.representations.member){var c=j.representations.member[0];var h=(c.thumbnails)?c.thumbnails:null;f.image=(h&&h.imageURL&&h.imageURL.member)?h.imageURL.member[0]:null}if(j.versionLabel){f.version=(j.versionLabel)?j.versionLabel:""}if(j.relatedItemType){f.parentType=j.relatedItemType["@ref"]}if(j.relatedItem){f.parent=j.relatedItem["@ref"]}var i=(j.AttributeContent)?((j.AttributeContent.member)?(j.AttributeContent.member):[]):[];i.forEach(function(m){var k="";for(k in m){if(m.hasOwnProperty(k)){if(typeof(m[k])=="object"){if(m[k].member){var l="";m[k].member.forEach(function(n){l=(l=="")?(n):(l+","+n)});f[k]=l}}else{f[k]=m[k]}}}})}if(!f.Description){f.Description=f.Description?f.Description:""}if(!f.fulltitle){f.title=f.name?f.name:f.Name;f.fulltitle=(f.title)?(f.title)+" "+f.version:f.version}f.id=f.id.substring(f.id.indexOf(":")+1,f.id.length);f.id=f.id.replace(".","");var e=[{value:f.description}];f.basics=e;if(f.name){var d=f.name.split("_")[1];if(d%2===0){f.type="Part"}else{f.type="Model"}}var g;for(g in f){if(UWA.owns(f,g)&&!UWA.is(f[g])){delete f[g]}}return f}});return a});define("DS/ENOXAdvancedSetView/js/ActionsToolbar",["UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Tooltip","DS/UIKIT/Input/Button","DS/UIKIT/DropdownMenu","DS/Handlebars/Handlebars","text!DS/ENOXAdvancedSetView/html/ActionsToolbar.html","css!DS/ENOXAdvancedSetView/css/ActionsToolbar.css"],function(b,e,h,g,a,c,j){c.registerHelper("ifActionType",function(m,n,l){if(m===n){return l.fn(this)}return l.inverse(this)});var f=c.compile(j);var i="actions-toolbar";var d=false;var k=b.extend({name:i,tagName:"div",filters:{},sorter:"",currentSorterId:null,descSort:false,domEvents:function(){var l=this;return{"click .action-button":function(m){l.dispatchEvent("onActionClick",[m]);if(l.options.modelEvents){l.options.modelEvents.publish({event:"atb-action-click",data:{id:this.id}})}}}},setup:function(l){var n=this,m="";n.container.addClassName(this.getClassNames("-container"));if(l.listTile){this.setTitle(l.listTile)}if(n.collection){n.collection.forEach(function o(q,p,r){if(q&&UWA.is(q,"object")){n.elements[q.id]=n.getActionElement(q)}})}n.container.getElement("#order-by").addEvent("click",function(p){p.preventDefault();p.stopImmediatePropagation();var q=this.getElement(".fonticon");if(q.hasClassName("fonticon-down")){q.classList.remove("fonticon-down");q.classList.add("fonticon-up");this.set("name","Ascending");n.descSort=true}else{q.classList.remove("fonticon-up");q.classList.add("fonticon-down");this.set("name","Descending");n.descSort=false}n.options.modelEvents.publish({event:"advanced-set-view-sort",data:[{id:n.currentSorterId,desc:n.descSort}]})})},setTitle:function(m){var l=UWA.extendElement(this.container);new UWA.Element("div",{"class":"xEng-list-title pull-left",html:m,}).inject(l,"top")},getActionElement:function(l){var q=this,o=l.type,m,s,n=false;s=UWA.extendElement(q.container).getElement(".manage-actions");switch(o){case"dropdown":l.items=q.getDropdownOptions(l);m=q.createDropdownElement(l);m.inject(q.container);break;case"filter":case"sort":var p,r;if(!n){n=true}if(!s){s=new UWA.Element("div",{"class":"manage-actions"}).inject(q.container);p=new g({id:"order-by",className:"order-action",icon:"down",name:"Descending"}).inject(s);r=new h({position:"bottom",target:p.getContent(),body:"",events:{onShow:function(t){this.setBody(this.options.target.name)},onHide:function(t){this.setBody("")}}})}l.items=q.getDropdownOptions(l);if(o==="filter"){m=q.createDropdownMenuElement(l)}else{m=q.createDropdownElement(l)}s.insertBefore(m,s.lastChild);break;default:m=q.createButtonElement(l);break}return m},createButtonElement:function(l){var m=this;var n=new g({className:"action-button",icon:l.icon}).inject(m.container);new h({position:"bottom",target:n.getContent(),body:l.title})},_maskAndFilter:function(o,p){var l=UWA.extendElement(widget.body);var m=l.getElement(".set-contents");var n=l.getElement('[name="Filter By"]');e.mask(m,"Filtering...");this.options.modelEvents.subscribeOnce({event:"advanced-set-view-filtered"},function(){e.unmask(m)});if(p===undefined){this.options.modelEvents.publish({event:"advanced-set-view-filter",data:[]});n.textContent="All"}else{this.options.modelEvents.publish({event:"advanced-set-view-filter",data:[{id:o,value:p}]});n.textContent=p}},createDropdownMenuElement:function(l){var n=this;var m=new UWA.Element("div",{"class":"action-dropdown"});new UWA.Element("div",{"class":"selectLabel",text:l.title+":"}).inject(m);var o=new g({className:"selectOptions",id:l.key,name:l.title,value:l.defaultValue,}).inject(m);new a({target:o.getContent(),items:[{text:"Maturity",position:"bottom left",items:[{text:"All",handler:function(){n._maskAndFilter("status")}},{text:"In work",handler:function(){n._maskAndFilter("status","In Work")}},{text:"Released",handler:function(){n._maskAndFilter("status","Released")}},{text:"Frozen",handler:function(){n._maskAndFilter("status","Frozen")}},{text:"Obsolete",handler:function(){n._maskAndFilter("status","Obsolete")}}]}]});return m},createDropdownElement:function(l){var o=this,n;var m=new UWA.Element("div");if(l.type==="filter"||l.type==="sort"){n="selectOptions";new UWA.Element("div",{"class":"selectLabel",html:l.title+": "}).inject(m);m.addClassName("action-dropdown")}else{n="action-button"}var p=new g({className:n,id:l.key,name:l.title,icon:l.icon?l.icon:null,value:l.defaultValue?l.defaultValue:"",dropdownCaret:false,dropdown:{closeOnClick:l.closeOnClick?l.closeOnClick:false,multiSelect:l.multiSelect?l.multiSelect:false,items:l.items},events:{onDropdownClick:function(t){var r=false,q=this.dropdown.getSelectedItems();var v=[];q.forEach(function(x,w){if(x.name==="all"){r=true}v.push({id:x.name,text:x.text,value:x.value})});if(l.type==="filter"){if(v.length>1&&r){r=false;this.dropdown.getItem("all").toggleSelection();v.splice(0,1)}if(v.length===0){r=true}else{if(v.length===1){this.setValue(v[0].text)}else{this.setValue("Multiple");this.textContent=v.join("|")}}if(r){var s=this.dropdown.getItem("all");if(!s.selected){this.dropdown.getItem("all").toggleSelection();v.push("all")}this.setValue("All");this.dropdown.items.forEach(function(x,w){if(x.text!=="All"&&x.selected){x.toggleSelection()}})}}else{if(l.type==="sort"){this.setValue(q[0].text);if(q[0].text!=="None"){o.currentSorterId=q[0].name;o.options.modelEvents.publish({event:"advanced-set-view-sort",data:[{id:q[0].name,desc:o.descSort}]})}}else{var u=t.target;if(!t.target.classList.contains("item")){u=t.target.parentElement}if(o.options.modelEvents){o.options.modelEvents.publish({event:"atb-action-click",data:{id:u.getAttribute("name")}})}}}},onDropdownClickOutside:function(s){var u=this.dropdown.getSelectedItems(),r=UWA.extendElement(widget.body).getElement(".set-contents");var q=[];u.forEach(function(w,v){if(w.name!=="all"&&w.name!=="none"){q.push({id:w.name,value:w.value})}});if(l.type==="filter"){e.mask(r,"Filtering...");o.options.modelEvents.subscribeOnce({event:"advanced-set-view-filtered"},function(){e.unmask(r)});o.options.modelEvents.publish({event:"advanced-set-view-filter",data:q})}else{if(l.type==="sort"){e.mask(r,"Sorting...");if(d){console.log("Actions Toolbar - sort selected")}var t=null;if(q!==undefined&&q[0]!==undefined){t=q[0].id}o.options.modelEvents.subscribeOnce({event:"advanced-set-view-sortered"},function(){e.unmask(r)});o.currentSorterId=t;o.options.modelEvents.publish({event:"advanced-set-view-sort",data:[{id:t,desc:o.descSort}]})}}}}}).inject(m);if(l.type==="filter"){o.filterBtnElt=p}else{if(l.type==="sort"){o.sorterBtnElt=p}}new h({position:"bottom",target:p.getContent(),body:l.title});return m},getDropdownOptions:function(r){if(d){console.log("get options and show dropdown"+q)}var p=this,s=[],v,u=r.type,q=r.key,n=true;if(u==="sort"){var o,m,l,w;v={name:"none",text:"None",selectable:true};if(!r.defaultValue){r.defaultValue=v.text;v.selected=true;n=false}s.push(v);if(q&&q.length>0){m=q.length;for(o=0;o<m;o++){l=q[o].name?q[o].name:q[o].label;w=q[o].label;v={name:l,text:w,selectable:true};if(n&&r.defaultValue===l){v.selected=true}s.push(v)}}}else{if(u==="filter"){var x,t=[];v={name:"all",text:"All",selectable:true};if(!r.defaultValue){r.defaultValue=v.text;v.selected=true;n=false}s.push(v);if(q&&q.length>0){q.forEach(function(y){v={name:y.name,value:y.value,text:y.label,selectable:true};if(n&&r.defaultValue===l){v.selected=true}s.push(v)})}}else{if(u==="dropdown"){var x,t=[];if(q&&q.length>0){q.forEach(function(y){v={name:y.name,value:y.value,text:y.label,fonticon:y.icon,selectable:y.selectable};s.push(v)})}}}}return s},addCustomFilter:function(l,m){var n=this;if(n.customFilters===undefined){n.customFilters={}}n.customFilters[m]=l;var p=n.filterBtnElt;if(p){var o=p.dropdown;o.items.push({name:l,text:m,selectable:true,});p.setDropdown({closeOnClick:o.options.closeOnClick,multiSelect:o.options.multiSelect,items:o.items})}},addCustomSorter:function(o,n){var m=this;if(m.customSorters===undefined){m.customSorters={}}m.customSorters[n]=o;var p=m.sorterBtnElt;var l=p.dropdown;l.items.push({name:o,text:n,selectable:true});p.setDropdown({closeOnClick:l.options.closeOnClick,multiSelect:l.options.multiSelect,items:l.items})}});return k});define("DS/ENOXAdvancedSetView/js/SampleCircleView",["DS/Handlebars/Handlebars","DS/ENOXAdvancedSetView/js/BaseCustomView","text!DS/ENOXAdvancedSetView/html/SampleCircleView.html","css!DS/ENOXAdvancedSetView/css/SampleCircleView.css"],function(f,a,e){var d=f.compile(e);var b="circle";var c=a.extend({name:b,tagName:"div",domEvents:function(){return{"click .circle-sub-container":function(g){this.dispatchEvent("onClick",[g])},"change .circle-check input":this.dispatchAsEventListener("onCheck")}},setup:function(){this.container.addClassName(this.getClassNames("-container"));this._parent.call(this,d)}});return c});define("DS/ENOXAdvancedSetView/js/SampleCollection",["DS/WebAppsFoundations/Collections/PageableCollection","DS/ENOXAdvancedSetView/js/SampleModel"],function(c,a){var b=c.extend({model:a,defaultOptions:{mode:"data",state:{firstPage:0,currentPage:0,pageSize:20},queryParams:{currentPage:"page",pageSize:"limit",totalRecords:"member"}},parseResponseForStateUpdate:function(g,e,f,d){return{totalRecords:g.totalItems}},parseRecords:function(e,d){return(e.member?e.member:e.value)},fetch:function(d){var f=d.to?(d.to*this.defaultOptions.state.pageSize)+1:this.defaultOptions.state.currentPage;var e="http://ruu1w764blr:9090/3DRDF/v0/";this.url=e+"classes/dslc:ItemVersion?$mask=dsmveng:EngItemVersionMask.Common&$skip="+f+"&$top="+this.defaultOptions.state.pageSize+"&$where=?res WHERE {?item a dseng:EngItem . ?item dslc:hasItemVersion ?res . FILTER NOT EXISTS {?descendant  dslc:isVersionEvolution ?res}}";return this._parent.call(this,d)}});return b});