define("DS/MaskCustomization/ajaxRequests/ServicesAjaxRequests",["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WAFData/WAFData"],function(d,c,a){var b={getTenantFromModel:function(f){var e=f?f.get("tenant"):null;e=e?e:widget.getValue("x3dPlatformId");return e},_formatUrl:function(f,g){var e=this.getTenantFromModel(f);return this._formatUrl2(e,g)},_formatUrl2:function(f,g){if(f){var e=g.indexOf("?");if(e<0){g+="?"}if(e<g.length-1){g+="&"}g=g+="tenant="+f}return g},securityContextDispatcher:function(f,e){var h=this;var g=f.securityContext;if(g){e.call(this,f)}else{var i=c.getInstance({tenant:f.tenant}).getSecurityContext({context:f.context,onSuccess:function(j){f.securityContext=j.SecurityContext;e.call(h,f)},onFailure:function(j){h._onFailure(null,{error:j},null,f)}});if(f.handleRequest){f.handleRequest.handle=i}}},_onCompleteAttributes:function(f,e){e.onComplete.call(null,f)},_onCompleteCommit:function(f,e){e.onComplete.call(null,f)},_onFailure:function(e,g,j,f){var h=this;var i={};if(g!=null&&g.hasOwnProperty("error")){i=[g.error]}else{i=[{msg:UWA.i18n("Error Server"),eventID:"error"}]}f.onComplete.call(null,{success:false,errors:i})},_onTimeout:function(e){var f=[{msg:UWA.i18n("ErrorTimeOut"),eventID:"error"}];e.onComplete.call(null,{success:false,errors:f})}};return b});define("DS/MaskCustomization/models/MaskAttribute",["DS/DataGridWidget/models/SheetLine"],function(b){var a=["nameNls"];var c=b.extend({_startWithPosition:null,_initDefined:false,init:function(i){var j={};var k=null;var d=i.init;this._initDefined=d!==undefined;if(d){for(var h in d){if(h==="status"){j.readonly=d.status==="RW"?false:true}else{j[h]=d[h]!==undefined?d[h]:""}}}var g={};for(var h in i){if(h==="status"){g.readonly=i.status==="RW"?false:true}else{if(h==="name"){k=i[h]}if(h!=="init"&&this.getAvailableOptions().indexOf(h)<0){g[h]=i[h]!==undefined?i[h]:""}}}var f=i.name;var e=i.nameNls;if(e){f=e+" ("+f+")"}g._displayName=f;this._parent(k,j,i);this.setValues(g)},hasStartWithPosition:function(){return this._startWithPosition},setPositionRule:function(e,d,f){if(f===true&&d!==undefined&&d!==null){this._startWithPosition=true}this.removePositionRules();this.setValue(e,d);this.addChangedValue(e)},removePositionRules:function(){this.removeValue("after");this.removeValue("position");this.removeValue("after_soft")},getPositionRule:function(){var d={rule:"after",value:null};d.rule="after";d.value=this.getValue(d.rule);if(d.value!==null&&d.value!==undefined){return d}d.rule="position";d.value=this.getValue(d.rule);if(d.value!==null&&d.value!==undefined){return d}d.rule="after_soft";d.value=this.getValue(d.rule);if(d.value!==null&&d.value!==undefined){return d}return null},_propertyCanChange:function(d){return d!=="name"&&d!=="_displayName"&&d!=="nameNls"},hasChanged:function(d){return this._initDefined===false||this._parent(d)},build:function(d,g){var i=null;var f=this.getProperties();for(var e in f){if(!e.startsWith("_")&&(!d||this.hasChanged(e))&&a.indexOf(e)<0){var h=f[e];if(e==="readonly"){e="status";h=h===true?"RO":"RW"}else{if(g!==undefined&&e==="position"){h=g}}if(i==null){i={}}i[e]=UWA.clone(h)}}if(i!=null){i.name=UWA.clone(f.name)}return i}});return c});define("DS/MaskCustomization/common/Constants",[],function(){var a={VIEWS:{TYPE_LIST:"typeListView",MASK_EDITOR:"maskEditor",MANAGED_TYPES:"managedTypes"},MERGE_OPTIONS:{MERGE:"merge",REPLACE:"replace"}};return a});define("DS/MaskCustomization/views/ViewBase",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Mask"],function(c,d,b){var a=d.extend({onRefresh:function(){},onResize:function(){},launch:function(e){},maskView:function(e){b.mask(this.getUI(),e)},unMaskView:function(){b.unmask(this.getUI())},getUI:function(){return this.elements.container},_dispatchNotifications:function(f){var e=this;f.forEach(function(g){e._dispatchNotification(g)})},_dispatchNotification:function(e){this.dispatchEvent("onNotification",e)},_changeView:function(e){this.dispatchEvent("onChangeView",e)}});return a});define("DS/MaskCustomization/popups/ChangePosition",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/SuperModal","DS/UIKIT/Autocomplete","DS/UIKIT/Form","i18n!DS/MaskCustomization/assets/nls/maskCustomization","css!DS/MaskCustomization/MaskCustomization.css"],function(e,f,a,d,b){var c=f.extend({init:function(g){var h=this;this._parent(g);this.currentRequest={handle:null};this.modal=new a({renderTo:widget.body})},_dispatchNotification:function(g){this.dispatchEvent("onNotification",g)},displayModal:function(g){var i=this;var h=g?UWA.clone(g):{};var j=new b({className:"horizontal mev_positionChoser",grid:"2 10",fields:[{id:"mev_positionNumber",type:"number",placeholder:"Select an option",min:-1,max:g.attributes.length-1,step:1,label:UWA.i18n("mev_position"),helperText:UWA.i18n("positionInTheList")},{type:"html",html:"<div class='mev_changePosHTML'>"+UWA.i18n("OR")+"</div>"},{type:"autocomplete",label:UWA.i18n("mev_after"),helperText:UWA.i18n("afterInTheList"),showSuggestsOnFocus:true,datasets:[{items:g.attributes}]}]});h.body=j;h.title=UWA.i18n("Change the position");h.buttons=[{className:"primary",value:UWA.i18n("Select"),action:function(m){var l=j.autocompletes[0].getValue();var n=j.numbers[0].getValue();var k=n&&n.length>0?n[0]:"";k=k!==""?parseInt(k):undefined;i.dispatchEvent("onComplete",{after:l!==""?l:undefined,position:k,info:h.info});m.hide()}}];if(g.info.withRemove){h.buttons.push({value:UWA.i18n("Remove"),action:function(k){i.dispatchEvent("onComplete",{remove:true,info:h.info});k.hide()}})}h.buttons.push({value:UWA.i18n("Cancel"),action:function(k){k.hide()}});this.modal.dialog(h)}});return c});define("DS/MaskCustomization/UI/MaskSkeleton",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Mask","i18n!MaskCustomization/assets/nls/maskCustomization"],function(d,e,c,b){var a=e.extend({views:{},currentFacet:null,init:function(f){var h=this;this._parent(f);this.elements.container=UWA.createElement("div",{"class":"MaskCustomization_Skeleton "+(this.options.className?this.options.className:"")});this.views={};this.currentFacet=null;var g=null;f.views.forEach(function(i){if(i.id){if(!g){g=i.id}h.views[i.id]=i}})},_hideAllView:function(){for(var g in this.views){var f=this.views[g];if(f.content){f.content.getUI().hide()}}},_getCurrentSelectedView:function(){return this.currentFacet},_setCurrentSelectedView:function(f){this.currentFacet=f},_launchView:function(f,h){c.unmask(this.elements.container);var g=this.views[f];if(g.content){g.content.launch(h);g.content.getUI().show();this._setCurrentSelectedView(g)}},onRefresh:function(){var f=this._getCurrentSelectedView();if(f.content){f.content.onRefresh()}},onResize:function(){var f=this._getCurrentSelectedView();if(f&&f.content){f.content.onResize()}},renderView:function(f,h){var k=this;var g=this.views[f];if(g){this._hideAllView();var j=g.content;c.mask(this.elements.container,b["msk_Loading view"]);if(!j){var i=g.require;if(i){require([i],function(n){var m=k._getCurrentSelectedView();if(m==null||m.id!=f){if(!g||!g.content){var l=g.options;l=l?l:{};var o=l.events;o=o?o:{};o.onChangeView=function(q){k.renderView(q)};l.events=o;g.content=new n(l);var p=g.content.getUI();p.addClassName("mev_view view_"+g.id);p.inject(k.elements.container)}k._launchView(f,h)}})}}else{this._launchView(f,h)}}}});return a});define("DS/MaskCustomization/ajaxRequests/AjaxRequests",["DS/WidgetServices/WidgetServices","DS/MaskCustomization/ajaxRequests/ServicesAjaxRequests","DS/WAFData/WAFData","i18n!DS/MaskCustomization/assets/nls/maskCustomization"],function(e,b,a){var d={createRequest:function(f,i,h,g){if(!f.handleRequest){f.handleRequest={}}f.handleRequest.handle=e.get3DSpaceUrlAsync({onComplete:function(o){var j="passport";var n=o+h;var m={Accept:"application/json","content-type":"application/json"};m["Accept-Language"]=widget.lang;var k=f.securityContext;k?m.SecurityContext=encodeURIComponent(k):null;var l={type:"json",method:i,timeout:3600000,proxy:j,headers:m,onComplete:function(p){f.onComplete(p)},onFailure:function(p,q,r){b._onFailure(p,q,r,f)},onTimeout:function(p){b._onTimeout(f)}};if(!widget.getValue("isStandalone")){l.authentication="passport"}if(g){l.data=UWA.Json.encode(g)}f.handleRequest.handle=a.handleRequest(b._formatUrl(null,n),l)}})},getListOfCustomizedTypes:function(h){var g="GET";var f="/resources/v1/collabServices/masks/op/list";d.createRequest(h,g,f,null)},getMaskElement:function(h){var g="GET";var f="/resources/v1/collabServices/masks/op/getMaskForProperties?type="+h.type+"&elementType="+h.category;d.createRequest(h,g,f,null)},createNewMask:function(h){var i={masks:[{type:h.type,content:h.content?h.content:{}}]};var g="POST";var f="/resources/v1/collabServices/masks/op/create?elementType="+h.category;d.createRequest(h,g,f,i)},getTypes:function(h){var g="GET";var f="/resources/v1/collabServices/masks/op/types?type="+h.type+"&category="+h.category+"&maxNumber=5";d.createRequest(h,g,f,null)},getAttributes:function(h){var g="GET";var f="/resources/v1/collabServices/masks/op/attributes?type="+h.type+"&elementType="+h.category;d.createRequest(h,g,f,null)},removeCustomizedType:function(h){var g="DELETE";var f="/resources/v1/collabServices/masks/op/remove?type="+h.type+"&elementType="+h.category;d.createRequest(h,g,f,null)},getManagedTypes:function(h){var g="GET";var f="/resources/v1/collabServices/masks/op/managedTypes";d.createRequest(h,g,f,null)},updateManagedTypes:function(h){var g="POST";var i=h.type?"?type="+h.type:"";var f="/resources/v1/collabServices/masks/op/recomputeDSMask"+i;d.createRequest(h,g,f,null)}};var c={getListOfCustomizedTypes:function(f){b.securityContextDispatcher(f,d.getListOfCustomizedTypes)},getMaskElement:function(f){b.securityContextDispatcher(f,d.getMaskElement)},createNewMask:function(f){b.securityContextDispatcher(f,d.createNewMask)},getTypes:function(f){b.securityContextDispatcher(f,d.getTypes)},getAttributes:function(f){b.securityContextDispatcher(f,d.getAttributes)},removeCustomizedType:function(f){b.securityContextDispatcher(f,d.removeCustomizedType)},getManagedTypes:function(f){b.securityContextDispatcher(f,d.getManagedTypes)},updateManagedTypes:function(f){b.securityContextDispatcher(f,d.updateManagedTypes)}};return c});define("DS/MaskCustomization/views/ManagedTypesView",["UWA/Core","DS/MaskCustomization/views/ViewBase","DS/MaskCustomization/ajaxRequests/AjaxRequests","DS/MaskCustomization/ajaxRequests/ServicesAjaxRequests","DS/MaskCustomization/common/Constants","DS/WidgetServicesUI/helpers/Constants","DS/DataGridWidget/Datasheet","DS/UIKIT/Mask","DS/Controls/Button","DS/DataGridWidget/models/SheetLine","i18n!MaskCustomization/assets/nls/maskCustomization"],function(h,i,g,l,a,j,d,e,f,c,k){var b=i.extend({init:function(m){this._parent(m);this.initUI()},initUI:function(){var m=this;this.elements.container=UWA.createElement("div");this.elements.buttons={};var n=UWA.createElement("div",{"class":"mev_buttonContainer"}).inject(this.elements.container);this.elements.buttons.back=new f({icon:"arrow-circle-left",displayStyle:"lite",iconSize:"2x",label:UWA.i18n("mev_back"),onClick:function(){m._goBack()}}).inject(n);this.elements.grid=this._createTable();this.elements.grid.inject(this.elements.container)},_createLinesFromAnswer:function(m){var o=m.types;var u=[];if(o){for(var s in o){if(s.startsWith("__")){continue}var q=o[s];var r=q.reference;var t=q.compiled;var n={name:s,computation:{parameters:{type:s}},compilation:{parameters:{type:s}}};if(r){n.computationDate=new Date(r)}if(t){n.compilationDate=new Date(t)}var p=new c(s,n);p.addEvent("onPropChanged:computation",function(v){this.changeValue("computationDate",new Date())});p.addEvent("onPropChanged:compilation",function(v){this.changeValue("compilationDate",new Date())});u.push(p)}}this.elements.grid.addLinesSheet(u)},_launchSearch:function(){var m=this;e.mask(this.elements.container);g.getManagedTypes({onComplete:function(n){m.elements.grid.removeAll();e.unmask(m.elements.container);if(n.success===true){m._createLinesFromAnswer(n)}else{var o=n.errors;if(o){o.forEach(function(p){m._dispatchNotification(p)})}}}})},onRefresh:function(){this._launchSearch()},launch:function(m){this._launchSearch()},_goBack:function(){this._changeView(a.VIEWS.TYPE_LIST)},_createTable:function(){var o=this;var m={name:"managedTypesTable",className:"managedTypesTable",setHeaderColumn:true,setScroller:true,restrict:true,rollback:false,useNativeScroller:false,activeSelection:false,events:{onNotification:function(p){o._dispatchNotification(p)}}};var n=[{text:UWA.i18n("name"),dataIndex:"name",sortable:true,sortKey:function(p){return p}},{text:UWA.i18n("mtv_computation"),type:j.TYPES.BUTTONWEB,dataIndex:"computation",editable:true,inputOptions:{data:{url:"/resources/v1/collabServices/masks/op/recomputeDSMask",method:"POST"}}},{text:UWA.i18n("mtv_computation_date"),type:j.TYPES.DATETIME,dataIndex:"computationDate",editable:false},{text:UWA.i18n("mtv_compilation"),type:j.TYPES.BUTTONWEB,dataIndex:"compilation",editable:true,inputOptions:{data:{url:"/resources/v1/collabServices/masks/op/recomputeCompiledMask",method:"POST"}}},{text:UWA.i18n("mtv_compilation_date"),type:j.TYPES.DATETIME,dataIndex:"compilationDate",editable:false}];return new d(n,m)}});return b});define("DS/MaskCustomization/models/MaskOptions",["DS/MaskCustomization/common/Constants"],function(a){var b=function(d){for(var c in d){this[c]=d[c]}this.getMergeOption=function(){return this.mergeOption};this.isMerge=function(){return this.getMergeOption()===a.MERGE_OPTIONS.MERGE};this.isForceReplace=function(){return this.getMergeOption()===a.MERGE_OPTIONS.REPLACE};this.setMergeOption=function(e){this.mergeOption=e};this.removeMergeOption=function(){delete this.mergeOption};this.build=function(){var f=this.getMergeOption();var e=null;if(f){e={mergeOption:f}}return e}};return b});define("DS/MaskCustomization/models/MaskElementBase",["UWA/Class","DS/MaskCustomization/models/MaskAttribute","DS/MaskCustomization/models/MaskOptions"],function(a,c,b){var d=a.extend({init:function(h,f){var e=this;this._parent(f);this.options=undefined;this._events={};for(var g in h){if(g==="options"){this.__setOptions(new b(h[g]))}else{if(g==="attributes"){e._initializeAttr(h[g])}else{this[g]=h[g]}}}},_initializeAttr:function(e){},getAttributes:function(){},getAttribute:function(e){},getAttributesIds:function(){},getAttributesWithProperty:function(f,e){},addNewAttribute:function(e){},build:function(f,e){},saveValues:function(){},onAttributeAdd:function(e){this.__addEvent("addAttribute",e)},onAttributesMove:function(e){this.__addEvent("moveAttributes",e)},dispatchEvent:function(e,h){var g=this;var f=this._events[e];if(f!==undefined){f.forEach(function(i){i.call(g,h)})}},__getOptions:function(){return this.options},__setOptions:function(e){this.options=e},__addEvent:function(e,g){var f=this._events[e];if(f===undefined){f=[];this._events[e]=f}f.push(g)},getMergeOption:function(){var e=this.__getOptions();var f=null;if(e){f=e.getMergeOption()}return f},setMergeOption:function(f){var e=this.__getOptions();if(!e){e=new b()}this.__setOptions(e);if(!f&&e.getMergeOption()){e.removeMergeOption()}else{e.setMergeOption(f)}}});return d});define("DS/MaskCustomization/facets/CommonFacet",["DS/EditPropWidget/facets/Common/FacetsCore","DS/MaskCustomization/models/MaskElementBase","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip","DS/Controls/Button","DS/DataGridWidget/Datasheet","DS/MaskCustomization/common/Constants"],function(i,f,h,g,d,c,b){var a="mev_positionColumn fonticon";var e=i.extend({init:function(j){this._parent(j);this.elements.datagrid=null;this.elements.container=UWA.createElement("div",{"class":"containerMask"})},updateFacet:function(){var u=this;var l=this.getContext();this.elements.container.empty();if(l&&l.models){var w=l.view;var y=this.getTabId();models=l.models;var m=models.getCompiledMask();var n=models.getCustomizedMask();var q=m.getElement(y);if(q&&q instanceof f){var j=[];var s=UWA.createElement("div",{"class":"mev_grid mev_grid_"+y.replace(/" "/g,"-")}).inject(this.elements.container);var t=UWA.createElement("div",{"class":"mev_optionsLine"}).inject(s);var v=n.getElement(y);var r=false;if(v){r=v.getMergeOption()!==b.MERGE_OPTIONS.MERGE}q.setMergeOption(!r?b.MERGE_OPTIONS.MERGE:b.MERGE_OPTIONS.REPLACE);var k=new h({type:"switch",label:UWA.i18n("mev_replaceMask"),className:"mev_replaceToggle",checked:r,events:{onChange:function(){var z=this.isChecked();q.setMergeOption(!z?b.MERGE_OPTIONS.MERGE:b.MERGE_OPTIONS.REPLACE)}}});new g({target:k.getContent(),body:UWA.i18n("replaceHelper"),});var o=UWA.createElement("div",{"class":"mev_addAttributes"}).inject(t);(new d({icon:"plus",displayStyle:"lite-borders",iconSize:"2x",label:UWA.i18n("addAttribute"),onClick:function(){var z=q.getAttributesIds();w.elements.attributesPopup.displayModal({type:l.type.type,category:l.type.category,except:z,info:{grid:y}})}})).inject(o);k.inject(t);var x=u.elements.datagrid=u._createTable({elementName:y,rollback:!r,events:{onPointingEvent:function(B){if(B.cellPosition.headerIndex==="_position"){var D=B.cellPosition.line;if(typeof D.getData==="function"){var C=D.getData();console.log(C.getID());var z=[];var A=this.getAllLines();A.forEach(function(E){z.push({label:E.getData().getValue("_displayName"),value:E.getID()})});w.elements.positionPopup.displayModal({attributes:z,info:{line:C,lineId:C.getID(),withRemove:!!C.getPositionRule(),grid:y}})}}}}});x.inject(s);q.onAttributeAdd(function(z){u._managePositionOnAttribute(x,z);x.addLinesSheet([z])});q.onAttributesMove(function(){var z=q.getAttributesIds();x.sortFromList(z)});var p=q.getAttributes();if(p){p.forEach(function(C){u._managePositionOnAttribute(x,C);if(v){var z=v.getAttribute(C.getID());if(z){var A=z.getValue("after");var B=z.getValue("position");if(A!==undefined){C.setPositionRule("after",A,true)}else{if(B!==undefined){C.setPositionRule("position",B,true)}}C.addChangedValues(Object.keys(z.getProperties()))}}C.setColor(C._initDefined!==true);C.setRollbackOnCells(C._initDefined===true);C.setInitializationAuthorization(true);j.push(C)})}x.addLinesSheet(j)}}},_managePositionOnAttribute:function(j,l){var k=UWA.createElement("div",{"class":a,title:""});l.setValue("_position",k);l.addEvent("onChange",function(p){var o=null;var r="";switch(p){case"after":o="fonticon-expand-up";r=UWA.i18n("hardLockAfter");break;case"position":o="fonticon-arrow-combo-horizontal";r=UWA.i18n("positionLocked");break;case"after_soft":o="fonticon-chevron-up";r=UWA.i18n("softLockAfter");break}if(o!==null){var n=!(this.getValue(p)!==null&&this.getValue(p)!==undefined);if(n&&this.hasStartWithPosition()===true){o="fonticon-attention";r=UWA.i18n("warningPositionRefresh");n=false}var m=!n?" "+o:"";var q=a+m;k.className=q;j.getTweaker(this,"_position",function(s){if(s){s.setTooltip(!n?r:"")}})}})},_createTable:function(n){var m=this;var j={name:"maskTable",className:"maskTable",setHeaderColumn:true,setScroller:true,restrict:true,colorization:true,useNativeScroller:false,activeSelection:false};if(n){for(var k in n){j[k]=n[k]}}var l=null;if(n.elementName==="details"){l=[{text:UWA.i18n("name"),sortable:true,defaultSort:true,sortKey:function(o){return o},dataIndex:"_displayName"},{text:UWA.i18n("forbidden char"),type:"string",dataIndex:"forbiddenChar",defaultValue:"",editable:true},{text:UWA.i18n("mandatory"),type:"boolean",dataIndex:"mandatory",defaultValue:false,editable:true},{text:UWA.i18n("remove"),dataIndex:"remove",type:"boolean",defaultValue:false,editable:true}]}else{l=[{html:"<span class='fonticon fonticon-target'></span>",type:"html",defaultValue:"",dataIndex:"_position"},{text:UWA.i18n("name"),dataIndex:"_displayName"},{text:UWA.i18n("readonly"),dataIndex:"readonly",type:"boolean",defaultValue:true,editable:true},{text:UWA.i18n("remove"),dataIndex:"remove",type:"boolean",defaultValue:false,editable:true}]}return new c(l,j)},onResize:function(){if(this.elements.datagrid){this.elements.datagrid.resizeTable()}}});return e});define("DS/MaskCustomization/popups/SearchTypes",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/SuperModal","DS/UIKIT/Autocomplete","DS/MaskCustomization/ajaxRequests/AjaxRequests","DS/WidgetServices/WidgetServices","i18n!DS/MaskCustomization/assets/nls/maskCustomization"],function(f,c,a,g,e,i){var d=function(k,l){var j=[];k.forEach(function(n){if(n.nameNls){var m={};m.label=n.nameNls;m.value={type:n.name,category:l};m.subLabel=n.name;j.push(m)}});return j};var h=function(l,j){var m=this;this.type=l;var k={dataParser:function(p,q){var o=q[m.type];var n=d(o,m.type);return n},onError:function(n,o){var p=n.errors;if(p){p.forEach(function(r){var q=r;if(r.message){q={msg:r.message,eventID:r.type.toLowerCase()}}j._dispatchNotification(q)})}},remoteSearchEngine:function(n,o){return new Promise(function(q,p){e.getTypes({type:o,category:m.type,onComplete:function(s){var r={};if(s.success==false){r.type="error";r.errors=s.errors;r.dataset=n;p(r)}else{r.dataset=n;r.matchingItems=k.dataParser(n,s.data);q(r)}}})})}};this.getConfig=function(){return k}};var b=c.extend({configuration:null,init:function(j){var k=this;this._parent(j);this.modal=new a({renderTo:widget.body})},_dispatchNotification:function(j){this.dispatchEvent("onNotification",j)},displayModal:function(k){var l=this;k=k?k:{};var m=new g({});var j=new h("BUS",this);m.addDataset({name:UWA.i18n("st_type"),displayName:true,items:[]},j.getConfig());if(!i.isReplayedODT()){var j=new h("ITF",this);m.addDataset({name:UWA.i18n("st_interface"),displayName:true,items:[]},j.getConfig());var j=new h("REL",this);m.addDataset({name:UWA.i18n("st_relationship"),displayName:true,items:[]},j.getConfig())}k.body=m;k.title=UWA.i18n("Choose a type");k.buttons=[{className:"primary",value:UWA.i18n("Create"),action:function(n){var p=m.selectedItems;if(p.length>0){var o=p[0];l.dispatchEvent("onComplete",{type:o.value.type,category:o.value.category})}n.hide()}},{value:UWA.i18n("Cancel"),action:function(n){n.hide()}}];this.modal.dialog(k)}});return b});define("DS/MaskCustomization/views/TypesListView",["UWA/Core","DS/MaskCustomization/views/ViewBase","DS/MaskCustomization/ajaxRequests/AjaxRequests","DS/MaskCustomization/popups/SearchTypes","DS/MaskCustomization/common/Constants","DS/UIKIT/SuperModal","DS/UIKIT/Tooltip","DS/UIKIT/Input/Button","DS/Controls/Button","DS/Tree/ThumbnailGridView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!MaskCustomization/assets/nls/maskCustomization"],function(l,m,j,e,b,c,n,i,h,k,a,g,f,o){var d=m.extend({init:function(p){this._parent(p);this.variables=this.variables?this.variables:{};this.variables.removeMode=false;this.initUI()},initUI:function(){var q=this;this.elements.container=UWA.createElement("div");this.elements.typesPopup=new e({events:{onNotification:function(u){q._dispatchNotification(u)},onComplete:function(u){q.maskView(UWA.i18n("mev_creatingMask"));j.createNewMask({type:u.type,category:u.category,onComplete:function(w){q.unMaskView();if(w.success===false){var v=w.errors?w.errors:w.error?[{msg:w.error,eventID:"error"}]:null;if(v){q._dispatchNotifications(v)}}else{q.onRefresh();q._dispatchNotification({msg:UWA.i18n("Creation succeeded"),eventID:"success"})}}})}}});this.elements.validationRemoveButton=new c({renderTo:widget.body});this.elements.grid=new k({model:[],checkboxVisibleFlag:false,selection:{canMultiSelect:false,enableListSelection:false},enableActiveUI:true,enableKeyboardNavigation:true,performances:{preloadPool:true,useRequestAnimationFrameRendering:false},onContextualEvent:{callback:function(v){var u=[];if(v&&v.cellInfos){if(v.cellInfos.nodeModel){var w=v.cellInfos.nodeModel;u.push({type:"PushItem",title:UWA.i18n("mev_openMask"),icon:f.getWebappsAssetUrl("MaskCustomization","icons/iconActionOpen.png"),action:{callback:function(x){if(w!==undefined){q.dispatchEvent("onSelection",w.options.data)}}}});u.push({type:"SeparatorItem"});u.push({type:"PushItem",title:UWA.i18n("mev_removeMask"),icon:f.getWebappsAssetUrl("MaskCustomization","icons/I_PLMDelete.png"),action:{callback:function(x){if(w!==undefined){q._removeType(w.options.data)}}}})}}return u}},height:"auto"});var t=UWA.createElement("div",{"class":"mev_buttonContainer"}).inject(this.elements.container);var s=UWA.createElement("div",{"class":"mev_gridContainer"}).inject(this.elements.container);var p=UWA.createElement("div",{"class":"fonticon fonticon-plus  fonticon-2x",events:{click:function(){q.elements.typesPopup.displayModal()}}}).inject(t);new n({delay:{show:400},position:"bottom left",target:p,body:UWA.i18n("mev_addMask")});var r=UWA.createElement("div",{"class":"fonticon fonticon-list  fonticon-2x",events:{click:function(){q._changeView(b.VIEWS.MANAGED_TYPES)}}}).inject(t);new n({delay:{show:400},position:"bottom left",target:r,body:UWA.i18n("mev_managedTypes")});this.elements.treeDocument=new a({});this.elements.grid.loadGridViewModel(this.elements.treeDocument);this.elements.grid.inject(s)},_removeType:function(s){var r=this;var p=s.type;var q=s.category;this.elements.validationRemoveButton.confirm(UWA.i18n("msgRemoveConfirmation"),UWA.i18n("titleRemoveConfirmation"),function(t){if(t===true){j.removeCustomizedType({type:p,category:q,onComplete:function(u){if(u.success!==true){r._manageErrors(u)}else{r.onRefresh();r._dispatchNotification({msg:UWA.i18n("removal succeeded"),eventID:"success"})}}})}})},launch:function(){this.onRefresh()},onRefresh:function(){if(this.elements.treeDocument){this.elements.treeDocument.removeRoots()}this._loadTypes()},_manageErrors:function(p){var q=this;var r=p.errors;if(r){r.forEach(function(s){q._dispatchNotification(s)})}},_loadTypes:function(){var p=this;this.maskView(UWA.i18n("mev_loadingMasks"));j.getListOfCustomizedTypes({onComplete:function(q){p.unMaskView();if(p.elements.treeDocument){p.elements.treeDocument.removeRoots()}if(q.success!==true){p._manageErrors(q)}else{var r=q.data;if(r){r.forEach(function(t){var s=new g({label:t.nlsName,subLabel:t.name,thumbnail:t.icon,vpm_editedDataIndex:{},data:{type:t.name,typenls:t.nlsName,category:t.elementType},grid:{rand:Math.ceil(Math.random()*10),},useAsyncPreExpand:true,asyncChildren:[]});p.elements.treeDocument.addRoot(s)})}}}})}});return d});define("DS/MaskCustomization/models/MaskDetails",["DS/MaskCustomization/models/MaskElementBase","DS/MaskCustomization/models/MaskAttribute","DS/MaskCustomization/models/MaskOptions"],function(c,b,a){var d=c.extend({init:function(f,e){this.attributes={};this._parent(f,e)},_initializeAttr:function(e){for(var g in e){var f=e[g];f.name=g;this.attributes[g]=new b(f)}},getAttribute:function(e){return this.attributes[e]},getAttributes:function(){var f=[];for(var g in this.attributes){var e=this.attributes[g];f.push(e)}return f},getAttributesIds:function(){return Object.keys(this.attributes)},getAttributesWithProperty:function(i,h){var f=[];for(var g in this.attributes){var e=this.attributes[g];if(e.getValue(i)===h){f.push(e)}}return f},addNewAttribute:function(e){if(e instanceof b){this.attributes[e.getID()]=e;this.dispatchEvent("addAttribute",e)}},build:function(k,j){var i={};var r=this.__getOptions();var g=[];var e=r!==undefined&&r.isMerge();var p=r!==undefined&&r.isForceReplace();var h=e||(!p&&j);var m=this.attributes;for(var o in m){var l=m[o];var n=l.build(k||e);if(n!==null){delete n.name;i[l.getID()]=n}}var q={attributes:i,};var f=r?r.build():null;if(f){q.options=f}return q},saveValues:function(){for(var f in this.attributes){var e=this.attributes[f];e.saveValues()}},});return d});define("DS/MaskCustomization/popups/SearchAttributes",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/SuperModal","DS/UIKIT/Autocomplete","DS/MaskCustomization/ajaxRequests/AjaxRequests","i18n!DS/MaskCustomization/assets/nls/maskCustomization"],function(e,f,a,d,b){var c=f.extend({init:function(g){var h=this;this._parent(g);this.currentRequest={handle:null};this.modal=new a({renderTo:widget.body})},_dispatchNotification:function(g){this.dispatchEvent("onNotification",g)},displayModal:function(g){var i=this;var h=g?UWA.clone(g):{};var j=new d({showSuggestsOnFocus:true,allowFreeInput:true});if(this.currentRequest.handle){this.currentRequest.handle.cancel();this.currentRequest.handle=null}b.getAttributes({type:h.type,category:h.category,handleRequest:this.currentRequest,onComplete:function(m){i.currentRequest.handle=null;if(m.success==false){var n=m.errors;n.forEach(function(p){var o={msg:p.message,eventID:p.type.toLowerCase()};i._dispatchNotification(o)})}else{var k=[];var l=h.except?h.except:[];m.data.forEach(function(o){var p=false;l.every(function(q){p=o.name===q;return !p});if(!p){k.push({value:o.name,label:o.nameNls,subLabel:o.name})}});j.addDataset({name:"Attributes",items:k})}}});h.body=j;h.title=UWA.i18n("Choose an attribute");h.buttons=[{className:"primary",value:UWA.i18n("Select"),action:function(m){var k=j.selectedItems;var l=k&&k.length>0?k[0]:null;l=l?l:j.elements.input.value;i.dispatchEvent("onComplete",{attribute:{value:typeof l==="object"?l.value:l,label:l.label},info:h.info});m.hide()}},{value:UWA.i18n("Cancel"),action:function(k){k.hide()}}];this.modal.dialog(h)}});return c});define("DS/MaskCustomization/models/MaskElement",["DS/MaskCustomization/models/MaskElementBase","DS/MaskCustomization/models/MaskAttribute","DS/MaskCustomization/models/MaskOptions"],function(d,b,a){var c=d.extend({_moveHistory:[],_initialIdList:null,init:function(f,e){this.attributes=[];this._moveHistory=[];this._initialIdList=null;this._parent(f,e)},_initializeAttr:function(f){var e=this;f.forEach(function(g){e.attributes.push(new b(g))})},getAttribute:function(f){var e=null;this.attributes.every(function(g){if(g.getID()===f){e=g}return e===null});return e},getAttributes:function(){return this.attributes},getAttributesIds:function(){var e=[];this.attributes.forEach(function(f){e.push(f.getID())});return e},getAttributesWithProperty:function(g,f){var e=[];this.attributes.forEach(function(h){if(h.getValue(g)===f){e.push(h)}});return e},addNewAttribute:function(e){if(e instanceof b){this.attributes.push(e);this.dispatchEvent("addAttribute",e)}},getAttributePosition:function(h){var e=null;var g=this.attributes.length;for(var f=0;f<g;f++){if(this.attributes[f].getID()===h){e=f;break}}return e},moveAttributesLinkedTo:function(u,m,A,y){var p=this;var j=null;if(u===A){j=UWA.i18n("mev_afterSameAttribute")}if(!j){if(this._initialIdList==null){this._initialIdList=this.getAttributesIds()}var l=this.getAttributePosition(u);var f=this.getAttributesLinkedTo(l,false);var t=f.length;var o=this.attributes.splice(l,t);if(t>0){if(A!==undefined){o.every(function(i){if(i.getID()===A){j=UWA.i18n("mev_attributeInAfter")}return j===null})}if(!j){var C=f[0];if(A!==undefined){var n=this.getAttributesWithProperty("after",A);n.forEach(function(i){i.removePositionRules()});C.setPositionRule("after",A);var B=this.getAttributePosition(A);m=B!==null?B+1:m}else{C.setPositionRule("position",m);for(var x=m;x<p.attributes.length;x++){var k=p.attributes[x];var w=p.attributes[x].getPositionRule();if(w==null||(w.rule==="position")){m=x;if(w==null||x===m){break}else{k.setPositionRule("position",x)}}}}if(m<0){m=this.attributes.length}var s=Math.min(m,this.attributes.length);this._addInArray(p.attributes,o,s);var e=[];var v=null;var q=null;var g=0;var r=0;var z=0;var h=p.attributes.length;p.attributes.forEach(function(i){var I=false;var H=i.getPositionRule();var K=H?H.rule==="after":false;var G=H?H.rule==="after_soft":false;var J=H?H.rule==="position":false;var F=K||G;var E=H===null;if(v!=null&&F){v.push(i)}else{if(v!=null&&E){I=true}else{if(v==null&&F){r=0}else{if(!K){if(J){if(v!=null){I=true}if(H.value<g&&r>0){z=Math.min(g-H.value,r);q=[];q.push(i)}}}}}}if(E){r++}if(v!=null&&(I||h==g+1)){var D=e.length;p._addInArray(e,v,D-z);v=null}if(q!=null){v=q;q=null}if(v==null){e.push(i)}if(v!=null&&h==g+1){var D=e.length;p._addInArray(e,v,D-z);v=null}g++});p.attributes=e;this._moveHistory.push({key:u,value:{previousAttributeId:A,newPosition:m}});if(y===true){this.dispatchEvent("moveAttributes")}}}}if(j){return{eventID:"error",msg:j}}},_addInArray:function(g,f,e){var h=e;f.forEach(function(i){g.splice(h,0,i);h++})},getAttributesLinkedTo:function(h,m){var f=this.attributes.length;var e=[];var l=[];if(h<f){var j=this.attributes[h];e.push(j);l.push(j.getID());h++}for(var g=h;g<f;g++){var j=this.attributes[g];var k=j.getValue("after");var n=j.getValue("soft_after");if((k&&l.indexOf(k)>=0)||(n&&l.indexOf(n)>=0)){e.push(j);l.push(j.getID())}else{break}}return m===true?l:e},_resetPositions:function(){if(this._initialIdList!=null){var f={};this.attributes.forEach(function(g){f[g.getID()]=g});var e=[];this._initialIdList.forEach(function(h){var g=f[h];if(g){e.push(g)}});this.attributes=e}},forgetMove:function(h){var g=this;this._resetPositions();var e=[];this._moveHistory.forEach(function(i){if(i.key!=h){var j=i.value;g.moveAttributesLinkedTo(i.key,j.newPosition,j.previousAttributeId,false)}else{e.push(i)}});this._moveHistory=e;var f=this.getAttribute(h);f.removePositionRules();this.dispatchEvent("moveAttributes")},moveAttributeAfter:function(e,f){return this.moveAttributesLinkedTo(e,null,f,true)},moveAttributeAt:function(f,e){return this.moveAttributesLinkedTo(f,e,undefined,true)},build:function(m,k){var j=[];var t=this.__getOptions();var g=[];var e=t!==undefined&&t.isMerge();var r=t!==undefined&&t.isForceReplace();var h=e||(!r&&k);var p=this.attributes;var o=p.length;for(var l=0;l<o;l++){var n=p[l];var q=n.build(m||e,l);if(q!==null){if(h&&n.getPositionRule()!==null){g.push(q)}else{j.push(q)}}}j=j.concat(g);var s={attributes:j,};var f=t?t.build():null;if(f){s.options=f}return s},saveValues:function(){this.attributes.forEach(function(e){e.saveValues()})}});return c});define("DS/MaskCustomization/models/MaskModel",["DS/MaskCustomization/models/MaskElement","DS/MaskCustomization/models/MaskDetails","DS/MaskCustomization/models/MaskOptions"],function(c,d,b){var a=function(i){var e=this;this._elements={};for(var h in i){if(h==="options"){this[h]=new b(i[h])}if(h==="details"){this._elements[h]=new d(i[h])}else{this._elements[h]=new c(i[h])}}this.getElements=function(){return this._elements};this.getElement=function(j){return this._elements[j]};var g=function(){return e.options};var f=function(j){e.options=j};this.getMergeOption=function(){var j=g();var k=null;if(j){k=j.getMergeOption()}return k};this.setMergeOption=function(k){var j=g();if(!j){j=new b()}f(j);if(!k&&j.getMergeOption()){delete j.removeMergeOption()}else{j.setMergeOption(k)}};this.build=function(j){var q={};var l=g();var p=this.getElements();for(var m in p){var o=p[m];var k=l!==undefined&&l.isMerge();q[m]=o.build(j||k,k)}var n=l?l.build():null;if(n){q.options=n}return q};this.saveValues=function(){var l=this.getElements();for(var j in l){var k=l[j];k.saveValues()}}};return a});define("DS/MaskCustomization/MaskCustomization",["UWA/Core","UWA/Controls/Abstract","UWA/Json","DS/MaskCustomization/UI/MaskSkeleton","DS/MaskCustomization/common/Constants","css!DS/MaskCustomization/MaskCustomization.css"],function(e,f,a,d,b){var c=f.extend({errorOverlay:null,defaultOptions:{className:""},init:function(g){this._parent(g);this.errorOverlay=null;this.initUI()},initUI:function(){var j=this;var h={onNotification:function(l){j._addNotif(l)}};var g=[{id:b.VIEWS.TYPE_LIST,require:"DS/MaskCustomization/views/TypesListView",options:{events:UWA.merge({onSelection:function(l){k.renderView(b.VIEWS.MASK_EDITOR,l)}},h)}},{id:b.VIEWS.MASK_EDITOR,require:"DS/MaskCustomization/views/MaskEditorView",options:{events:h}},{id:b.VIEWS.MANAGED_TYPES,require:"DS/MaskCustomization/views/ManagedTypesView",options:{events:h}}];var i={views:g};if(this.options.className){i.className=this.options.className}var k=this.elements.skeleton=this.elements.container=new d(i);k.renderView(b.VIEWS.TYPE_LIST)},onRefresh:function(){if(this.elements.skeleton){this.elements.skeleton.onRefresh()}},onResize:function(){if(this.elements.skeleton){this.elements.skeleton.onResize()}},_getErrorManager:function(g){var h=this;if(this.errorOverlay){g.call(null,this.errorOverlay)}else{require(["DS/ErrorWidget/ErrorWidget"],function(i){if(!h.errorOverlay){h.errorOverlay=new i(widget,h.elements.container.getContent(),{className:"maskCustomization_errorManager"})}g.call(null,h.errorOverlay)})}},_addNotif:function(g){var j=g.msg?g.msg:g.message;var h=g.eventID;var i=g.customClass;switch(h){case"error":j=j?j:g.json;this._addError(j,i);break;case"warning":this._addWarning(j,i);break;case"success":this._addSuccess(j,i);break;default:this._addInfo(j,i)}},_addInfo:function(i,h){var g=this;this._getErrorManager(function(j){var k=j.addInfo(i,h);g.dispatchEvent("onNotification",k)})},_addWarning:function(g,i){var h=this;this._getErrorManager(function(j){var k=j.addWarning(g,i);h.dispatchEvent("onNotification",k)})},_addSuccess:function(i,h){var g=this;this._getErrorManager(function(j){var k=j.addSuccess(i,h);g.dispatchEvent("onNotification",k)})},_addError:function(g,i){var h=this;this._getErrorManager(function(j){var k=j.displayJSONError(a.encode(g),i);h.dispatchEvent("onNotification",k)})}});return c});define("DS/MaskCustomization/MaskCustomizationHTML",["DS/MaskCustomization/MaskCustomization","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WidgetServices/WidgetServices","i18n!MaskCustomization/assets/nls/maskCustomization"],function(a,d,c,b){return{launch:function(){c.getTenants(function(g){widget.addPreference({name:"mc_tenant",type:"list",label:b.mc_tenant,defaultValue:c.getTenantID(),options:g});var e=null;var f={onLoad:function(){e=new a();widget.body.setContent(e)},onRefresh:function(){if(e){e.onRefresh()}},onResize:function(h){if(e){e.onResize()}}};widget.addEvent("onLoad",f.onLoad);widget.addEvent("onRefresh",f.onRefresh);widget.addEvent("onResize",f.onResize);widget.setAutoRefresh(6048000)})}}});define("DS/MaskCustomization/models/MaskModels",["DS/MaskCustomization/models/MaskModel"],function(a){var b=function(c){var e=new a(c.compiled);var d=new a(c.customized);this.getCompiledMask=function(){return e};this.getCustomizedMask=function(){return d}};return b});define("DS/MaskCustomization/views/MaskEditorView",["UWA/Core","DS/Core/ModelEvents","DS/MaskCustomization/views/ViewBase","DS/MaskCustomization/ajaxRequests/AjaxRequests","DS/MaskCustomization/popups/SearchTypes","DS/MaskCustomization/common/Constants","DS/MaskCustomization/models/MaskModel","DS/MaskCustomization/models/MaskModels","DS/MaskCustomization/models/MaskAttribute","DS/MaskCustomization/popups/SearchAttributes","DS/MaskCustomization/popups/ChangePosition","DS/Tree/ThumbnailGridView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/Button","DS/UIKIT/Input/Button","DS/UIKIT/Mask","DS/UIKIT/Scroller","DS/WidgetServicesUI/helpers/Constants","DS/EditPropWidget/UI/IDCardSkeleton"],function(b,n,r,p,o,d,f,m,i,s,e,g,j,l,t,k,u,q,a,c){var h=r.extend({init:function(v){var w=this;this._currentType=null;this._parent(v);this.elements.container=UWA.createElement("div");this.elements.buttons={};var y=UWA.createElement("div",{"class":"mev_buttonContainer"}).inject(this.elements.container);this.elements.buttons.back=new t({icon:"arrow-circle-left",displayStyle:"lite",iconSize:"2x",label:UWA.i18n("mev_back"),onClick:function(){w._goBack()}}).inject(y);this.elements.middleContainer=UWA.createElement("div",{"class":"mev_middleDiv"}).inject(this.elements.container);this.elements.idCard=new c([],{className:"maskIdCard",closeButton:false,sharedContext:{models:null,view:this,type:this._currentType}});this.elements.idCard.inject(this.elements.middleContainer);this.elements.positionPopup=new e({events:{onNotification:function(z){w._dispatchNotification(z)},onComplete:function(B){var F=B.info;if(F&&F.grid){var A=F.lineId;var E=w.elements.maskModel.getCompiledMask();var D=E.getElement(F.grid);if(B.remove===true){D.forgetMove(A)}else{var G=B.after;var z=B.position;if(G!==undefined){var C=D.moveAttributeAfter(A,G);if(C){w._dispatchNotification(C)}}else{if(z!==undefined){D.moveAttributeAt(A,z)}}}}}}});this.elements.attributesPopup=new s({events:{onNotification:function(z){w._dispatchNotification(z)},onComplete:function(A){var B=A.info;if(B&&B.grid){var C=new i({name:A.attribute.value,nameNls:A.attribute.label,created:true,authorizedInitialization:true,rollbackOnCell:false});C.addChangedValue("name",true);C.setColor(true);if(w.elements.maskModel){var z=w.elements.maskModel.getCompiledMask();var A=z.getElement(B.grid);A.addNewAttribute(C)}}console.log(A.attribute)}}});var x=UWA.createElement("div",{"class":"mev_bottomButtons"}).inject(this.elements.container);this.elements.buttons.valid=new k({className:"primary",value:UWA.i18n("mev_valid")}).inject(x);this.elements.buttons.valid.addEvent("onClick",function(){w._modifyCusto()})},onRefresh:function(){this._launch()},_goBack:function(){this._changeView(d.VIEWS.TYPE_LIST)},_modifyCusto:function(){u.mask(this.elements.container);var x={};var w=this;if(this.elements.maskModel){var v=this.elements.maskModel.getCompiledMask();x=v.build(false)}p.createNewMask({type:this._currentType.type,category:this._currentType.category,content:x,onComplete:function(y){u.unmask(w.elements.container);if(y.success===true){w._onCompleteSave(y);w._dispatchNotification({eventID:"success",msg:UWA.i18n("mev_updated")})}else{var z=y.errors;if(z){z.forEach(function(A){w._dispatchNotification(A)})}}}})},_clearDatagrid:function(){},launch:function(v){this._currentType={type:v.type,category:v.category,typenls:v.typenls};this._launch()},_launch:function(){var v=this;this.maskView(UWA.i18n("mev_loadingMask"));p.getMaskElement({type:this._currentType.type,category:this._currentType.category,onComplete:function(w){v.unMaskView();if(w.success===true){var x=w.data;if(x){v._onComplete(x)}}else{var y=w.errors;if(y){y.forEach(function(z){v._dispatchNotification(z)})}}}})},_onCompleteSave:function(v){if(v.results&&this._currentType&&this._currentType.type){this._onComplete(v.results[this._currentType.type])}},onResize:function(){},_clearAll:function(){if(this.elements.idCard){this.elements.idCard.clearPanel()}},_onComplete:function(C){var D=this;var v=new m(C);var z=v.getCompiledMask();var A=v.getCustomizedMask();this.elements.maskModel=v;this._clearAll();var x=[];var y=this.elements.idCard.getIdentityCard();y.injectValue(this._currentType.typenls+" ("+this._currentType.type+")",a.TYPES.STRING,"title");var E=[];for(var F in z.getElements()){var B=null;switch(F){case"Write":B="pencil";break;case"Create":B="plus";break;case"details":B="info";break;default:B="i-question"}E.push({alwaysCalled:true,require:"DS/MaskCustomization/facets/CommonFacet",facet:{name:F,text:F,icon:B}})}this.elements.idCard.getOrAddFacets(E);var w=this.elements.idCard.getSharedContext();w.models=v;w.type=this._currentType;this.elements.idCard.setSharedContext(w);this.elements.idCard._launchFacet()}});return h});