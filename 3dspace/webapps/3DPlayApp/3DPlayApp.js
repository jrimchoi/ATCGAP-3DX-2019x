/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/3DPlaySupport/SupportList",["DS/WebSystem/Environment","UWA/Core"],function(j,d){var e={preview:0,collaborate:1,NR:2,SimReview:3};var a={"2D":"3DPlayDocumentViewer","3D":"3DPlayCollaborativeExperience"};var k={"2D":["3DPlayDocumentViewerPreview",a["2D"],"",""],"3D":["3DPlayModelViewer",a["3D"],"3DPlayNRExperience",""]};var b=navigator.userAgent.match(/(Android|iPhone|iPad)/i)?true:false;var h={FILE:{"3dxml":k["3D"],"3dxm":k["3D"],"3dxc":k["3D"],asat:k["3D"],asab:k["3D"],catpart:k["3D"],catproduct:k["3D"],cgr:k["3D"],dae:k["3D"],dtm:["GEOswaExperience","GEOswaExperience","",""],exp:k["3D"],gml:k["3D"],ifc:k["3D"],ifczip:k["3D"],iges:k["3D"],igs:k["3D"],ipt:k["3D"],jt:k["3D"],model:k["3D"],p_b:k["3D"],p_t:k["3D"],obj:k["3D"],par:k["3D"],prt:k["3D"],rfa:k["3D"],rvt:k["3D"],sab:k["3D"],sat:k["3D"],sdm:["GEOswaExperience","GEOswaExperience","",""],sldasm:k["3D"],sldprt:k["3D"],smg:["VCXWebPlayerIn3DPlayExperience","VCXWebPlayerIn3DPlayExperience"],stp:k["3D"],step:k["3D"],stl:k["3D"],str:["GEOswaExperience","GEOswaExperience","",""],swa:["GEOswaExperience","GEOswaExperience","",""],vda:k["3D"],x_b:k["3D"],x_t:k["3D"],xcgm:k["3D"],xmp_bin:k["3D"],xmp_txt:k["3D"],xmt_bin:k["3D"],xmt_txt:k["3D"],xmlv43:k["3D"],catdrawing:k["2D"],cgm:k["2D"],slddrw:k["2D"],bmp:k["2D"],dwg:k["2D"],dxf:k["2D"],jpg:k["2D"],jpeg:k["2D"],png:k["2D"],svg:{connector:"DS/3DPlayConnectors/SVGConnector",DefaultExperiencesList:k["2D"]},tif:k["2D"],tiff:k["2D"],pdf:(b)?["3DPlay2DExperience","3DPlay2DExperience","",""]:k["2D"]},"3DSPACE":{"3DShape":k["3D"],BioBiologicsSafetyStudy:["BIOBioBiologicsSafetyStudy3DplayExperience","BIOBioBiologicsSafetyStudy3DplayExperience","",""],BioDigitalClinicStudy:["BIODigitalClinicStudy3DPlayExperience","BIODigitalClinicStudy3DPlayExperience","",""],CATDrawing:k["2D"],CATPart:k["3D"],CATProduct:k["3D"],"ds6w:Product":k["3D"],"ds6w:Part":k["3D"],"ds6w:Occurrence":k["3D"],"ds6w:Document":k["3D"],"ds6w:ProdConf":k["3D"],DesignSight:["3DPlayBasicSimulation","3DPlayBasicSimulation","3DPlayBasicSimulationNR","3DPlayFullSimulation"],DeFaUltDtYpE:k["3D"],DOCUMENTS:{connector:"DS/3DSpaceDocumentConnector/3DSpaceDocumentConnector"},"Earth Resource":k["3D"],ENOStrRefinementSpecification:{connector:"DS/3DPlayConnectors/FilterConnector"},FEM:[a["3D"],"3DPlayCollaborativeExperience","","3DPlayFullFEM"],"Geological Feature":k["3D"],"Geological Unit":k["3D"],Markup:["3DPlayDMUExperience","3DPlayDMUExperience","",""],MediaVideo3DExp:["XCT3DPlayIntegratability","XCT3DPlayIntegratability","XCT3DPlayIntegratability","XCT3DPlayIntegratability"],PLMPIMMetricReference:["PIMwebItf3DPlayExperience","PIMwebItf3DPlayExperience","","PIMwebItf3DPlayExperience"],SIMItfSimulation:["PIMwebIsr3DPlayExperience","PIMwebIsr3DPlayExperience","","PIMwebIsr3DPlayExperience"],"SW Assembly Family":k["3D"],"SW Assembly Instance":k["3D"],"SW Component Family":k["3D"],"SW Component Instance":k["3D"],VPMReference:k["3D"],VPMRepReference:k["3D"],},"3DDRIVE":{DOCUMENT:{connector:"DS/3DPlayConnectors/3DDriveConnector"},Document:{connector:"DS/3DPlayConnectors/3DDriveConnector"},DriveFile:{connector:"DS/3DPlayConnectors/3DDriveConnector"}},ONEDRIVE:{DOCUMENT:{connector:"DS/3DPlayConnectors/OneDriveConnector"},Document:{connector:"DS/3DPlayConnectors/OneDriveConnector"}},"3DSWYM":{media:{connector:"DS/3DPlayConnectors/3DSwymConnector"}},BUFFER:{"3dxml":k["3D"],svg:k["2D"]},CROSSHIGHLIGHT:{VPMReference:1,VPMInstance:1,VPMRepInstance:1,VPMRepReference:1,"3DShape":1,CATProduct:1,CATPart:1,Viewable:1,CgrViewable:1,Reference3D:1,Instance3D:1}};var c=function(l){return l.toLowerCase()};h.FILE.reformatTypeID=c;h.BUFFER.reformatTypeID=c;var i=[];var g=[];h.setPLatformServices=function(l){g=l};h.addPlatformData=function(l){g.push({platformId:l});return this.getPlatformData(l)};h.getPlatformData=function(m){for(var l=g.length;l--;){if(g[l].platformId===m){return g[l]}}return null};var f=function(m,r,q,o,p){try{var l=["DS/VisuDataAccess/Ox4TypeHelper"];require(l,function(s){s.InitWithUrl(m,q.tenant,q.requiredAuth,q.proxyurl);if(s.IsInit()){s.GetParentsBusType(r,function(u){var x=[r];x=x.concat(u);var w=undefined;for(var t=0;t<x.length;t++){var v=x[t];if(v&&h[o][v]){w=v;break}}p(w)})}else{p(undefined)}})}catch(n){p(undefined)}};h["3DSPACE"].resolveParenting=function(q,p){var l=q.type;if(l===undefined||l===null){l="VPMReference"}if(h.EV6[l]){p(l);return}if(q.tenant===undefined||q.tenant===null||typeof(q.tenant)!=="string"){p(undefined);return}var n=h.getPlatformData(q.tenant);var m=n?n["3DSpace"]:null;if(m===undefined||m===null){var o=["DS/3DPlayUtils/ServiceURL"];require(o,function(r){r({myAppsUrl:q.myAppsUrl,serviceName:"3DSpace",platformId:q.tenant,onSuccess:function(s){var t=s;if(t){if(Array.isArray(t)){t=t[0]}if(t.url){t=t.url}}h.addPlatformData(q.tenant)["3DSpace"]=t;f(t,l,q,"3DSPACE",p)},onError:function(){p(undefined)}})})}else{f(m,l,q,"3DSPACE",p)}};h.CROSSHIGHLIGHT.resolveParenting=function(q,p){var l=q.type;if(h.CROSSHIGHLIGHT[l]===1){p(l);return}if(q.tenant===undefined||q.tenant===null||typeof(q.tenant)!=="string"){p(undefined);return}var n=h.getPlatformData(q.tenant);var m=n?n["3DSpace"]:null;if(m===undefined||m===null){var o=["DS/3DPlayUtils/ServiceURL"];require(o,function(r){r({serviceName:"3DSpace",platformId:q.tenant,onSuccess:function(s){var t=s;if(t){if(Array.isArray(t)){t=t[0]}if(t.url){t=t.url}}h.addPlatformData(q.tenant)["3DSpace"]=t;f(t,l,q,"CROSSHIGHLIGHT",p)},onError:function(){p(undefined)}})})}else{f(m,l,q,"CROSSHIGHLIGHT",p)}};d.extend(h,{"3DSPACE":{Drawing:{connector:"DS/3DPlayConnectors/DrawingConnector"},V6Drawing:["3DPlayDrawingPreview","3DPlayDrawingExperience",""]}},true);h.EV6=h["3DSPACE"];if(j.isSet("3DPlay.UDLExperience")){d.extend(h,{FILE:{udl:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","",""]},BUFFER:{udl:["3DPlayUDLExperiencePreview","3DPlayUDLExperience","",""]}},true)}if(j.isSet("3DPlay.OfficeDocuments")){d.extend(h,{FILE:{doc:k["2D"],docx:k["2D"],ppt:k["2D"],pptx:k["2D"]}},true)}if(j.isSet("3DPlay.ProtoSMM")){d.extend(h,{FILE:{xls:k["2D"],xlsx:k["2D"],cgr:k["3D"],txt:k["2D"],fmu:k["2D"],mdl:k["2D"],html:k["2D"],trapatterns:k["2D"],catpart:k["2D"]}},true)}if(j.isSet("3DPlay.GEOVIA")){d.extend(h,{FILE:{mineschedanimation:["GEOMineSchedExperience","GEOMineSchedExperience","",""]}},true)}if(j.isSet("3DPlay.Allow_simxml")){d.extend(h,{FILE:{simxml:["3DPlayBasicSimulation","3DPlayBasicSimulation","3DPlayBasicSimulationNR"]}},true)}if(j.isSet("3DPlay.ProtoHTMLViewer")){d.extend(h,{FILE:{html:["3DPlayHtmlViewer","3DPlayHtmlViewer","",""]}},true)}if(j.isSet("3DPlay.Video.Enabled")){d.extend(h,{FILE:{mp4:k["2D"],webm:k["2D"],ogv:k["2D"],ogg:k["2D"]}},true)}if(j.isSet("3DPlay.ProtoConvertSpatial")){d.extend(h,{FILE:{asm:k["3D"],cgm3d:k["3D"],iam:k["3D"],session:k["3D"]}},true)}if(j.isSet("3DPlay.eDrawingSupport")){d.extend(h,{FILE:{sldasm:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],sldprt:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],slddrw:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],dxf:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],dwg:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],easm:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],eprt:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],edrw:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],easmx:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],eprtx:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],edrwx:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],hwf:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""]}},true)}if(j.isSet("ODT_MODE")){d.extend(h,{FILE:{sldprt:["3DPlayeDrawingsExperience","3DPlayeDrawingsExperience","",""],tst_frommimetype:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_badreturnfile:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_failopen:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_failrequire:{connector:"DS/ODT_3DPlayInfra/WrongModuleID"},opened:k["2D"]},"3DSPACE":{resolveParenting:function(l,m){m(l.type)},tst_chainedopen:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector",DefaultExperiencesList:k["3D"]},tst_fromdtype:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"},tst_badreturnev6:{connector:"DS/ODT_3DPlayInfra/3DPlayTstConnector"}},STREAM:{svg:k["2D"]}},true)}if(j.isSet("3DPlay.PersistedAnnotationsEnabled")){d.extend(h,{FILE:{svg:{connector:"DS/3DPlayConnectors/SVGConnector"}}},true)}if(window.localStorage["3DPlayHybridApp"]){d.extend(h,{FILE:{dwg:undefined,dxf:undefined,catdrawing:undefined,cgm:undefined,slddrw:undefined,edrw:undefined,edrwx:undefined,bmp:undefined,jpg:undefined,jpeg:undefined,png:undefined,svg:undefined,tif:undefined,tiff:undefined,doc:undefined,docx:undefined,ppt:undefined,pptx:undefined,pdf:undefined}},true)}h.getDefaultExperienceID=function(m){var l=m||{};l.format=l.format||"3D";return a[l.format]};h.getDefaultExperiencesIDList=function(m){var l=m||{};l.format=l.format||"3D";return k[l.format]};h.computeUsage=function(l){var m=e[l];if(m===null||m===undefined){m=e.collaborate}return m};h.openAsset=function(m,n,p,o){var l=h[m.provider][m.type].connector;if((typeof l)==="string"){require([l],function(q){var r=new q();h[m.provider][m.type].connector=r;r.open(n,p,o)},function(){o()})}else{l.open(n,p,o)}};return h});define("DS/3DPlayWidgetControllers/W3DPlayModelFilteringCtrl",["UWA/Class","DS/CoreEvents/Events"],function(b,d){var h,f=[],g,c,e=-1,a=[];return b.extend({init:function(i){this.wiew=i},filter:function(j){var i=this.wiew.get3DPlayInstance();if(i){i.seach(j)}},dispose:function(){this.wiew=null}})});define("DS/3DPlaySupport/AssetSupport",["UWA/Class","DS/WebSystem/Environment","DS/3DPlaySupport/SupportList"],function(a,b,d){var c={getDefaultExperienceID:function(e){return d.getDefaultExperienceID(e)},getDefaultExperiencesIDList:function(e){return d.getDefaultExperiencesIDList(e)},checkSupport:function(i,h,k){h=h||{};var f=window.localStorage["3DPlay.OverrideSettings"];if(f!==undefined){console.warn("!! 3DPlay OverrideSetting variable environment Active");try{f=JSON.parse(f);if(f&&f.input&&f.input.experience){k(true)}}catch(j){console.error("Override failed : JSON.parse error"+j)}}var g=function(e){k(e!==null)};h.isCheckSupport=true;this.getExperienceID(i,h,g)},getExperienceID:function(h,f,i){f=f||{};var g=d.computeUsage(f.usage);var e=function(j){var k=j[g];if(k===undefined||k===null||typeof(k)!=="string"||k===""){k=null}i(k)};this.getExperiencesIDList(h,f,e)},getExperiencesIDList:function(g,f,j){var e=[];g=g||{};f=f||{};if(g.provider&&typeof(g.provider)==="string"&&g.type&&typeof(g.type)==="string"){g.provider=g.provider.toUpperCase()}else{j(e);return}if(d[g.provider]===null||d[g.provider]===undefined){j(e)}else{var h=d[g.provider];if(h.reformatTypeID){g.type=h.reformatTypeID(g.type)}var i=function(l){var k=d[g.provider][l];if(k===null||k===undefined){j(e)}else{if(Array.isArray(k)===true){j(k)}else{if(k.connector){if(f.doOpen&&g.isOpenned!==true&&f.lastUsedConnector!==g.provider+"-"+l){d.openAsset({provider:g.provider,type:l},g,function(m){f.lastUsedConnector=g.provider+"-"+l;c.getExperiencesIDList(m,f,j)},function(){j(e)})}else{if(k.DefaultExperiencesList){j(k.DefaultExperiencesList)}else{if(f.isCheckSupport){j(["Connector","Connector","Connector","Connector"])}else{j(e)}}}}else{j(e)}}}};if(h.resolveParenting===undefined||h.resolveParenting===null){i(g.type)}else{h.resolveParenting(g,function(k){i(k)})}}}};return c});define("DS/3DPlayWidgetControllers/W3DPlayDDCtrl",["UWA/Class","DS/CoreEvents/Events"],function(e,f){var b,d,a,h,g;var c=e.extend({init:function(j,i){b=j;d=i;a=this;h=f.subscribe({event:"MainView.onDrop"},function(k){a._dragAndDropParsing(k)});g=f.subscribe({event:"MainView.onFileDrop"},function(k){a._directDragAndDropParsing(k)})},dispose:function(){f.unsubscribe(h);f.unsubscribe(g);b=d=a=null},_dragAndDropParsing:function(l){var j=JSON.parse(l);var i=b.getCurrentData();var p=j.data["items"][0]["objectId"];var m=i.objectId;d.hideLastWidgetNotification();if(p===m){var o=b.getWidgetMessage("SAME_MODEL");var n=b.getWidgetMessage("SAME_MODEL_TITLE");var k={level:"info",title:n,message:o,sticky:false};d.addWidgetNotification(k);f.publish({event:"Controler.SameModel",data:k})}else{b.drag=true;b.setCurrentContent(j)}},_directDragAndDropParsing:function(j){var i=window.URL.createObjectURL(j.files[0]);var k=function(s){var p=s.replace(/\.\./g,"");p=p.split(".");if(p.length===1||(p[0]===""&&p.length===2)){return""}var r=p.pop();var o=r.indexOf("?")+1;if(o){p=r.substring(0,o-1)}else{p=r}var q=new RegExp(/^[a-zA-Z0-9_]+$/);var n=q.exec(p);if(n!==null){return p}return""};var l=k(j.files[0].name);var m={asset:{format:l,filename:i,provider:"FILE",proxyurl:"none",requiredAuth:null,serverurl:""}};f.publish({event:"Player.load",data:{input:m}})}});return c});var id="3DPlay";if(typeof widget!=="undefined"){id=widget.id}window["3DPlay.ProbesManager.clapDone"]=true;window.performance.mark(id+"clap");try{window.top.performance.mark(id+"clap")}catch(err){window["3DPlay.ProbesManager.TopWindowNotAvailable"]=true}var mark=id+"_3DPlayApp";window.performance.mark(mark);var emptyfunction=function(){console.error("Empty Function")};function Player3DShare(e,d,b,c,f){var a;if(arguments.length===1){console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (same signature)");a=arguments[0]}else{console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (with {container:{}, input:{}, options:{}, widget:{} [,application:]})");a={};a.container=arguments[0];a.input=arguments[1];a.options=arguments[2];a.widget=arguments[3];a.application=arguments[4]}return Player3DPlayWeb(a)}var EnvironmentIsSet=function(a){return window&&window.localStorage&&window.localStorage[a]!==undefined};function Player3DPlayWeb(g){var b=function(e){return window&&window.localStorage&&window.localStorage[e]!==undefined};var j=function(e){return window.localStorage[e]};var a=function(){var k=["DS/3DPlayHelper/SplashScreen","i18n!DS/3DPlayHelper/assets/nls/3DPlayHelper","DS/WebUtils/StringUtils"];var n=["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Utils/InterCom"];var l=g;var m;var e={addScriptingFunction:emptyfunction,execute:emptyfunction,getFunctions:emptyfunction,isReady:function(){return true},load:function(p){if(m){var o;try{o=p.options.splashscreen}catch(q){o=null}m.refreshOptions(o)}l=p},loadAsset:function(o,p){this.load({input:o,options:p})}};require(k,function(s,q,r){var p={};p=l.options.splashScreen||p;m=new s(p);m.showView(m.views.logo);var o=l.container;if((typeof o)==="string"){o=document.getElementById(o)}m.inject(o);require(n,function(w,u){console.log("Player3DPlayWeb: Trying to Launch 3DPlay Native");var t=function(){m.showView(m.views.loading);var E="itms://itunes.apple.com/us/app/3dplay/id825988585?ls=1&mt=8";var D={appId:"X3DPLAY_AP"};var z=function(F){if(b("ODT_3DPLAYHELPER_IOS_EVENT")){require(["DS/Core/Events"],function(I){I.publish({event:j("ODT_3DPLAYHELPER_IOS_EVENT")})});return}var H=StringUtils.parseUrl(F.tenantURL);var G=H.hostname;G=G.toLowerCase();w.getPlatformServices({onComplete:function(M){var J=F.modelID,L=null;for(var P=0;P<M.length;P++){var I=M[P];for(var O in I){if(I.hasOwnProperty(O)&&typeof I[O]==="string"){var K=I[O].toLowerCase();if(K.contains(G)){L=I.platformId;break}}}if(L){break}}if(J&&L){var N=new u.Socket("compassPageSocket");N.subscribeServer("com.ds.compass",window.parent);N.dispatchEvent("onSetObject",{objectId:J,envId:L},"compassPageSocket");N.addListener("launchApp",function(R){console.log("Response = "+JSON.stringify(R));this.response=R.response;if(this.response!="COMPLETE"){var Q=confirm("To experience this content you need to install 3DPlay");if(Q===true){window.location=E}}});N.dispatchEvent("onLaunchApp",D,"compassPageSocket")}else{m.showFatal(q.TenantError,false);m.showView(m.views.logo)}m.showView(m.views.logo)},onFailure:function(){m.showFatal(q.PlatformNotFound,false);m.showView(m.views.logo)}})};var y=function(F){if((F.indexOf("proxy/passport?")>-1)&&(F.indexOf("url=")>-1)){F=F.substr(F.indexOf("url=")+4,F.length);if(F.indexOf("&")>-1){F=F.substr(0,F.indexOf("&"))}F=decodeURIComponent(F)}return{modelID:F.substr(F.lastIndexOf("/")+1,F.length),tenantURL:F.substr(0,F.lastIndexOf("/")+1)}};var A={},C;if(l.input){if((typeof l.input)==="string"){C=l.input}else{if(typeof l.input.asset==="string"){C=l.input.asset}else{if(l.input.asset.provider&&(typeof l.input.asset.provider)==="string"){if(l.input.asset.provider.toUpperCase()==="FILE"){C="";if(l.input.asset.serverurl){C+=l.input.asset.serverurl}if(l.input.asset.filename){C+=l.input.asset.filename}}else{if(l.input.asset.provider.toUpperCase()==="EV6"){A.modelID=l.input.asset.physicalid;A.tenantURL=l.input.asset.serverurl}}}}}if(C){var B=y(C);z(B)}else{z(A)}}};var x=[];var v=document.createElement("a");v.setAttribute("href","#");v.innerHTML="<U>"+q.LaunchNativeApp+"</U>";v.setAttribute("title",q.LaunchNativeApp);v.addEventListener("click",t,false);m.showFatal(q.DeviceNotFullySupported,true,v);m.setOnClick(t);m.showView(m.views.logo);if(b("ODT_3DPLAYHELPER_IOS")){t()}},function(u){if(u.requireType=="scripterror"){var t=u.requireModules.join(",");console.error("3DPlay ScripNotFoundError: ",t);m.showFatal(q.ScripNotFoundError+t,false)}else{console.error(u)}})},function(o){console.error("Player3DPlayWeb: 3DPlayRequire failed: "+o)});return e};try{var c=UWA.Utils.Client.Platform.ios;if(b("ODT_3DPLAYHELPER_IOS")){c=true}var h;if(c){var i=navigator.userAgent;var d=i.indexOf("OS ");if(d>-1){h=i.substr(d+3,3).replace("_",".")}if(b("ODT_3DPLAYHELPER_IOS")){h=j("ODT_3DPLAYHELPER_IOS")}}if(c&&h<8){console.log("Player3DPlayWeb: Redirecting to the native app");return a()}else{return Launch3DPlayWeb(g)}}catch(f){return Launch3DPlayWeb(g)}}function Launch3DPlayWeb(c){if(typeof c!="object"){console.error('Player3DPlayWeb:R418 => This call is deprecated! Please use a JSON object in Player3DPlayWeb({container:"", input:{}; options:{}}');switch(arguments.length){case 1:return new Player3DShare(c);case 2:return new Player3DShare(arguments[0],arguments[1]);case 3:return new Player3DShare(arguments[0],arguments[1],arguments[2]);case 4:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}}var d={addScriptingFunction:emptyfunction,executeScriptingFunction:emptyfunction,getScriptingFunctions:emptyfunction,hasScriptingFunction:emptyfunction,removeScriptingFunction:emptyfunction,disposeAllScriptingFunctions:emptyfunction,notifyScriptingFunction:emptyfunction,subscribeScriptingFunction:emptyfunction,unsubscribeScriptingFunction:emptyfunction,subscribeAllScriptingFunctions:emptyfunction,unsubscribeAllScriptingFunctions:emptyfunction,instance:undefined,loaded:false,_check:function(){if(!this.isReady()){console.error("Experience is not ready");return false}if(!this.instance){console.error("Experience is not created");return false}return true},getCtx:function(){if(this._check()){return this.instance.args.ctx}return undefined},isReady:function(){return(this.ctx!==null&&this.ctx!==undefined)||this.loaded},load:function(g,f){_check()},loadAsset:function(f,g){_check()},loadAnnotations:function(h,g){var i=(h&&h.annotation)?h.annotation:null;var f=(g&&g.clean)?true:false;if(this.instance&&i){this.instance.loadAnnotations(i,f);return true}else{return false}}};var e=undefined;var b=false,a=false;c=c||{};c.options=c.options||{};if(c.options.widget3DPlay){a=true}if(!a){a=true;e="Splashscreen";window.performance.mark(e)}require(["DS/3DPlayHelper/3DPlayWebPlayer","DS/WebUtils/ProbesManager","DS/3DPlaySupport/SupportList","css!DS/3DPlayHelper/SplashScreen"],function(h,g,i,f){if(c.options.platformServices){i.setPLatformServices(c.options.platformServices)}if(e){g.createProbe("Splashscreen",e)}h(d,c)});return d}define("DS/3DPlayHelper/3DPlayHelper",["UWA/Core"],function(a){return Player3DPlayWeb});define("DS/3DPlayHelper/3DPlayNativePlayer",[],function(){return{}});define("DS/3DPlayWidgetControllers/W3DPlayIncomingMsgCtrl",["UWA/Class","DS/PlatformAPI/PlatformAPI"],function(e,d){var a;var c;var b="DS/PADUtils/PADCommandProxy/select";return e.extend({init:function(g,f){this.m=g;this.v=f;this.setUpSubscribers()},setUpSubscribers:function(){var f=this;this.token=d.subscribe(b,function(g){if(widget&&g&&g.metadata&&widget.id!==g.metadata.originWidgetId){f.enoPadSelectHandler(g)}})},dispose:function(){d.unsubscribe(this.token)},enoPadSelectHandler:function(k){var j=k.data.paths;var h=j.length;var f=[];for(var g=0;g<h;g++){f.push(j[g].join("/"))}this.m.setCurrentCSO(f)}})});define("DS/3DPlayHelper/SplashScreen",["DS/WebappsUtils/WebappsUtils","UWA/Core","DS/WebSystem/Environment","UWA/Controls/Abstract","DS/WebUtils/ProbesManager","css!DS/3DPlayHelper/SplashScreen","i18n!DS/3DPlayHelper/assets/nls/SplashScreen"],function(e,g,d,f,c,b,a){return f.extend({defaultOptions:{},views:{},init:function(h){this._parent(h);this._buildView(h);if(h){if(h.autoplay===true){this.showView(this.views.loading);if(h.onClick){h.onClick(this)}}else{var i=function(){this.showView(this.views.loading);this.removeOnClick();if(h.onClick){h.onClick(this)}i=null}.bind(this);this.setOnClick(i)}if(h.container){if(h.containerOptions){if(h.containerOptions.insertBefore){h.container.insertBefore(this.elements.container,h.container.firstElementChild)}}else{this.inject(h.container)}}if(h.callback){h.callback(this)}}},_buildView:function(p){var i=document.createDocumentFragment();this.formFactor="";if(i.ownerDocument.documentElement.offsetWidth>780&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="L"}else{if(i.ownerDocument.documentElement.offsetWidth<779&&i.ownerDocument.documentElement.offsetWidth>581&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="M"}else{if(i.ownerDocument.documentElement.offsetWidth<580&&i.ownerDocument.documentElement.offsetWidth>280&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="S"}else{if(i.ownerDocument.documentElement.offsetWidth<280||i.ownerDocument.documentElement.offsetHeight<200){this.formFactor="XS"}else{this.formFactor="L"}}}}this.custoContainer=new g.Element("div",{"class":"PlayWeb-bgd-custo"}).inject(i);var l=this;if(p&&p.custom!==undefined&&p.custom!==null){if((typeof p.custom)==="string"){this.custoContainer.innerHTML=p.custom;var o=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall_button_withHalo-03.svg";l.clickLogoImg=new g.Element("div",{"class":"click-logo-img",display:"block",styles:{"background-image":"url('"+o+"')"}}).inject(this.custoContainer)}else{try{this.custoContainer.appendChild(p.custom)}catch(m){}}}var k=new g.Element("div",{styles:{width:"100%",height:"100%"}});var j=(p)?p.logoDisplay:undefined;var n=(p&&(typeof p.customLogoSrc)==="string")?p.customLogoSrc:undefined;var h=(p&&(typeof p.customAppName)==="string")?p.customAppName:undefined;this._add3DPlayLogoView(k,j,n,h);this._addLoadingView(k);this._addNotificationView(k);this._addErrorView(k);this.showView=function(q){for(var r in this.views){if(this.views.hasOwnProperty(r)){this.views[r].style.display="none"}}q.style.display="block"};i.appendChild(k);if(j==="onHover"){var l=this;k.addEvents({mouseenter:function(){if(l.clickLogoImg){l.clickLogoImg.style.opacity=1}if(l.options.custom===undefined||l.options.custom===null){l.viewLogo.style.opacity=1}},mouseleave:function(){if(l.clickLogoImg){l.clickLogoImg.style.opacity=0}if(l.options.custom===undefined||l.options.custom===null){l.viewLogo.style.opacity=0}}})}this.elements.container=new g.Element("div",{"class":"SHAREPluginless_background"});if(p&&(typeof p.customBgColor)==="string"){this.elements.container.style.backgroundColor=p.customBgColor}this.elements.container.appendChild(i)},_add3DPlayLogoView:function(h,o,k,j){var l=k?k:e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayOnclickPage.svg";var n=this;var i=new Image();i.onload=function(){n.viewLogo.style.backgroundImage="url("+i.src+")";c.end("Splashscreen");n=null};i.src=l;var m={display:"block","background-image":"url('"+l+"')"};if(o==="onHover"){g.extend(m,{opacity:0,transition:"opacity 0.5s ease-in-out"})}this.viewLogo=new g.Element("div",{"class":"PlayWeb-splash-view",styles:m}).inject(h);this.views.logo=this.viewLogo},_addLoadingView:function(h){var j=this;var i=new Image();i.onload=function(){j.viewLoading.style.backgroundImage="url("+i.src+")";j=null};this.viewLoading=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none",cursor:"progress",}}).inject(h);if(this.formFactor==="L"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg"}else{if(this.formFactor==="M"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg"}else{if(this.formFactor==="S"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Small-02.svg"}else{if(this.formFactor==="XS"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall-03.svg"}}}}this.views.loading=this.viewLoading},_addNotificationView:function(h){this.notificationView=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(h);this.notificationContainer=document.createElement("p");this.notificationContainer.setAttribute("class","SHAREPluginless_notif");this.notificationView.appendChild(this.notificationContainer);this.views.notification=this.notificationView},_addErrorView:function(h){this.viewError=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(h);this.fatalContainer=document.createElement("p");this.fatalContainer.setAttribute("class","SHAREPluginless_notif_fatal");this.promptedContainer=document.createElement("p");this.promptedContainer.setAttribute("class","PlayWeb-notif-prompted");this.viewError.appendChild(this.fatalContainer);this.viewError.appendChild(this.promptedContainer);this.views.error=this.viewError},refreshOptions:function(h){while(this.custoContainer.firstChild){this.custoContainer.removeChild(this.custoContainer.firstChild)}if(h&&h.custom!==undefined&&h.custom!==null){if((typeof h.custom)==="string"){this.custoContainer.innerHTML=h.custom}else{try{this.custoContainer.appendChild(h.custom)}catch(i){console.error(i)}}}},setOnClick:function(h){if(this.clickCB){this.removeOnClick()}this.clickCB=h;this.elements.container.style.cursor="pointer";this.elements.container.addEventListener("click",this.clickCB,false)},removeOnClick:function(){if(this.clickCB!==undefined){this.elements.container.style.cursor="";this.elements.container.removeEventListener("click",this.clickCB,false);this.clickCB=undefined}},showFatal:function(h,i,j,k){this.fatalContainer.innerHTML="";if(k&&k.name&&a.get(k.name)){this.fatalContainer.appendChild(document.createTextNode(a.get(k.name)))}else{this.fatalContainer.appendChild(document.createTextNode(a.TextFatal))}if(i){this.promptedContainer.innerText="";this.promptedContainer.appendChild(document.createTextNode(h))}console.error("3DPlay Fatal : "+h);if(j){this.fatalContainer.appendChild(j)}this.showView(this.views.error);this.elements.container.style.display="block"},showNotification:function(h){this.notificationContainer.textContent=h;this.showView(this.views.notification);this.elements.container.style.display="block"}})});define("DS/3DPlaySupport/ExperiencesList",["DS/WebSystem/Environment","UWA/Core"],function(b,d){var c={"3DPlayModelViewer":{name:"ModelViewer Simple Experience",description:"Display 3DXML & CRG files in the web browser",module:"DS/3DPlayModelViewer/3DPlayModelViewer"},"3DPlayCollaborativeExperience":{name:"3DPlay Collaborative Experience",description:"Display 3DXML & CRG files in the web browser",module:"DS/3DPlayDefaultExperience/3DPlayDefaultExperience"},"3DPlayDocumentViewer":{name:"DocumentViewer Experience",description:"Display image files & document files in the web browser",module:"DS/3DPlayDocumentViewer/3DPlayDocumentViewer"},"3DPlayDocumentViewerPreview":{name:"DocumentViewerPreview Experience",description:"Display image files & document files in the web browser",module:"DS/3DPlayDocumentViewer/3DPlayDocumentViewerPreview"},"3DPlayDrawingExperience":{name:"3DPlay Drawing Experience",description:"Experience for Drawings",module:"DS/3DPlayDrawingExperience/3DPlayDrawingExperience"},"3DPlayDrawingPreview":{name:"3DPlay Drawing Preview",description:"Preview Experience for Drawings",module:"DS/3DPlayDrawingExperience/3DPlayDrawingPreview"},"3DPlayNRExperience":{name:"NR Default Experience",description:"NR Experience for CAD data",module:"DS/3DPlayNRExperience/3DPlayNRExperience"},"3DPlay3DSwYmExperience":{name:"SwYm Simple Experience",description:"Display 3DXML & CRG files in 3DSwYm context",module:"DS/3DPlaySwymExperiences/3DPlaySwymExperience"},"3DPlay3DSwYm2DExperience":{name:"SwYm 2D Experience",description:"Display documents in 3DSwYm context",module:"DS/3DPlaySwymExperiences/3DPlaySwym2DExperience"},"3DPlayBasicSimulation":{name:"Simulation Player Experience",description:"Display Simulation light weight data in the web browser",module:"DS/3DPlayBasicSimulation/3DPlayBasicSimulation"},"3DPlayBasicSimulationNR":{name:"NR Simulation Experience",description:"NR Experience for Physics Simulations",module:"DS/3DPlayAppNR_Web/3DPlayBasicSimulationNR"},"3DPlayFullSimulation":{name:"Simulation Player Experience",description:"Display and animate Simulation light weight data in the web browser",module:"DS/3DPlayFullSimulation/3DPlayFullSimulation"},"3DPlayFullFEM":{name:"Meshing Review Experience",description:"Display mesh light weight data in the web browser",module:"DS/3DPlayMesh/3DPlayFullFEM"},"3DPlayeDrawingsExperience":{name:"eDrawings Experience",description:"eDrawings Experience for XDesign",module:"DS/SWXeDrawingsAnd3DPlay/3DPlayeDrawingsExperience"},"3DPlayDMUExperience":{name:"3DReview experience",description:"Play Review",module:"DS/3DPlayDMUExperience/3DPlayDMUExperience"},BIOBioBiologicsSafetyStudy3DplayExperience:{name:"Biologics Safety Study Experience",description:"Display Biologics Safety Study Experience",module:"DS/BIOBioBiologicsSafetyStudy3DplayExperience/BIOBioBiologicsSafetyStudy3DplayExperience"},BIODigitalClinicStudy3DPlayExperience:{name:"Digital Clinic Study Experience",description:"Display Digital Clinic Study Preview",module:"DS/BIODigitalClinicStudy3DPlayExperience/BIODigitalClinicStudy3DPlayExperience"},ENOSHOExp3DPlayMobile:{name:"3DMerchandising Experience",description:"Review 3D Merchandising experiences.",module:"ENOSHOExp3DPlayMobile/ENOSHOExp3DPlayMobile"},GEOswaExperience:{name:"swa Player Experience",description:"Display a swa file in a 3dViewer in the web browser",module:"DS/GEOswaExperience/GEOswaExperience"},PIMwebIsr3DPlayExperience:{name:"Interference Simulation",description:"",module:"DS/PIMweb3DPlayExperience/PIMwebIsr3DPlayExperience"},PIMwebItf3DPlayExperience:{name:"Interference Metric",description:"",module:"DS/PIMweb3DPlayExperience/PIMwebItf3DPlayExperience"},VCXWebPlayerIn3DPlayExperience:{name:"Composer smg files Experience",description:"Play Composer smg files in the web browser",module:"DS/VCXWebComposer3DPlayExperience/VCXWebPlayerIn3DPlayExperience"},XCT3DPlayIntegratability:{name:"XCT3DPlayIntegratability Experience loader",description:"XCT3DPlayIntegratability experience",module:"DS/XCT3DPlayIntegratability/XCT3DPlayIntegratability"}};if(b.isSet("3DPlay.UDLExperience")){d.extend(c,{"3DPlayUDLExperience":{name:"3DPlay UDL Experience",description:"Experience for UDL",module:"DS/3DPlayUDLExperience/3DPlayUDLExperience"},"3DPlayUDLExperiencePreview":{name:"3DPlay UDL Preview Experience",description:"Preview Experience for UDL",module:"DS/3DPlayUDLExperience/3DPlayUDLExperiencePreview"}},true)}if(b.isSet("3DPlay.GEOVIA")){d.extend(c,{GEOMineSchedExperience:{name:"MineSched Player Experience",description:"Display a minesched viewer animation format in a 3dViewer in the webbrowser",module:"DS/GEOMineSchedExperience/GEOMineSchedExperience"}},true)}if(b.isSet("3DPlay.ProtoHTMLViewer")){d.extend(c,{"3DPlayHtmlViewer":{name:"HtmlViewer Experience",description:"Display web pages & text content in the web browser",module:"DS/3DPlayHtmlViewer/3DPlayHtmlViewer"}},true)}var a=navigator.userAgent.match(/(Android|iPhone|iPad)/i)?true:false;if(a){d.extend(c,{"3DPlay2DExperience":{name:"3DPlay 2D Experience",description:"Experience for PDF documents",module:"DS/3DPlay2DExperience/3DPlay2DExperience"}},true)}return c});define("DS/3DPlayWidgetViews/W3DPlayMainView",["DS/CoreEvents/Events","DS/WebSystem/Environment","UWA/Class","css!DS/3DPlayWidget/assets/3DPlayWidget"],function(l,j,b,a){var k,e,i=[];var c=false;var h;var f,g;var d=b.extend({init:function(n,m){k=n;e=m;h=this;this.buildView();this.createBlueBackground();this.declareAllSubscribers()},buildView:function(){if(j.isBoolActive("3DPlay.SwitchApp")){}else{k.body.empty()}k.body.setStyle("height","100%");this.buildCanvas()},buildCanvas:function(){if(e.applicationFrameOptions&&e.applicationFrameOptions.options){c=e.applicationFrameOptions.options.pad3DViewer!==undefined}this.canvasDiv=document.getElementById("canvas-div");if(!this.canvasDiv){this.canvasDiv=UWA.createElement("div",{id:"canvas-div",html:""});this.canvasDiv.setAttribute("data-rec-id","canvasDivID");if(c){this.canvasDiv.inject(e.applicationFrameOptions.options.pad3DViewer.elements.container)}else{this.canvasDiv.inject(k.body)}}e.setCanvasDiv(this.canvasDiv);l.subscribeOnce({event:"Model.PreferencesReady"},function(n){if(!e.isPreferencesEmpty()){var m=e.getCurrentData();h.updateWidgetTitle(m.displayName)}});this.declareDragAndDropZone()},createBlueBackground:function(){this.backgroundContainer=document.getElementById("background_container");if(!this.backgroundContainer){this.backgroundContainer=UWA.createElement("div",{id:"background_container","class":"blue_background_container",styles:{display:"none"}});this.backgroundContainer.inject(this.canvasDiv);this.backgroundContainer.setContent({tag:"div","class":"background_container_display drop"});var m=e.getBoxMessageText("DROPIT");this.backgroundContainer.addContent({tag:"div","class":"drop_container_display",});this.backgroundContainer.addContent({tag:"div","class":"drop_container_txt",html:[{tag:"h3",id:"drop_msg","class":"drop_invite_txt font-3dsregular drop",html:m}]})}this.drop_msgDom=this.backgroundContainer.getElement("h3.drop_invite_txt")},hideBlueBackground:function(m){this.backgroundContainer.setStyle("display",m)},displayBlueBackground:function(){this.hideBlueBackground("block")},updateBlueBackgroundMessage:function(m){var n=e.getBoxMessageText(m);this.drop_msgDom.setHTML(n)},create3DPlayInviteContainer:function(){this.inviteContainer=document.getElementById("pad_invite");if(!this.inviteContainer){this.inviteContainer=UWA.createElement("div",{id:"pad_invite","class":"pad_invite_container",html:"Invite Container",styles:{display:"none"}});this.inviteContainer.inject(this.canvasDiv,"before");var m=e.getBoxMessageText("DROPIT");this.inviteContainer.setContent([{tag:"div","class":"pad_invite_display drop",html:[{tag:"span",id:"invite_img","class":"pad_invite_img fonticon fonticon-3x fonticon-down-circled"},{tag:"h5",id:"invite_msg","class":"pad_invite_txt font-3dsregular drop",html:m}]}])}this.invite_imgDom=this.inviteContainer.getElement("span.pad_invite_img");this.invite_msgDom=this.inviteContainer.getElement("h5.pad_invite_txt")},addWidgetNotification:function(m){if(!f){require(["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(o,n){f=n;g=o;f.setNotificationManager(o);h.addWidgetNotification(m)})}else{g.addNotif({level:m.level,message:m.message,title:m.title,sticky:m.sticky})}},hideLastWidgetNotification:function(){if(f){f.removeLastNotificationDisplayed()}},refresh:function(){var m=e.getCurrentData();this.updateWidgetTitle(m.displayName)},updateWidgetHeight:function(){console.log(k.getViewportDimensions().height);k.body.setStyle("height","100%")},declareAllSubscribers:function(){i.push(l.subscribe({event:"Model.changeTitle"},function(m){h.refresh()}))},dispose:function(){h=null;if(this.restoreDragAndDropZone){this.restoreDragAndDropZone()}for(var m=0;m<i.length;m++){l.unsubscribe(i[m])}i=[]},declareDragAndDropZone:function(){var o=function(p){this.removeClassName("drag_over_class");h.hideBlueBackground("none")};var m=function(p){p.preventDefault();this.removeClassName("drag_over_class");h.hideBlueBackground("none");if(j.isSet("3DPlay.DnD","true")&&event.dataTransfer.files.length&&event.dataTransfer.files[0]!==undefined){l.publish({event:"MainView.onFileDrop",data:p.dataTransfer})}else{l.publish({event:"MainView.onDrop",data:p.dataTransfer.getData("text")})}};var n=function(p){p.preventDefault();this.addClassName("drag_over_class");h.displayBlueBackground();h.updateBlueBackgroundMessage("DROPIT");if(p.dataTransfer){p.dataTransfer.dropEffect="copy"}};this.canvasDiv.addEventListener("dragenter",n);this.canvasDiv.addEventListener("dragover",n);this.canvasDiv.addEventListener("dragleave",o);this.canvasDiv.addEventListener("dragend",o);this.canvasDiv.addEventListener("drop",m);this.restoreDragAndDropZone=function(){this.canvasDiv.removeEventListener("dragenter",n);this.canvasDiv.removeEventListener("dragover",n);this.canvasDiv.removeEventListener("dragleave",o);this.canvasDiv.removeEventListener("dragend",o);this.canvasDiv.removeEventListener("drop",m)}},hideShowBoxMessage:function(m){this.inviteContainer.setStyle("display",m)},updateBoxMessage:function(n){var m=e.getBoxClassIcon(n);var o=e.getBoxMessageText(n);if(n=="DEFAULT"){this.invite_imgDom.removeClassName(m);this.invite_imgDom.addClassName("fonticon-down-circled")}else{this.hideShowBoxMessage("block");this.invite_msgDom.setHTML(o);this.invite_imgDom.removeClassName("fonticon-down-circled");this.invite_imgDom.addClassName(m)}},updateWidgetTitle:function(n){var m="3DPlay";k.setTitle("");if(n!=""&&n!==null&&typeof n!=="undefined"){m=n}k.setTitle(m);k.setValue("afrProductTitle",null)}});return d});define("DS/3DPlayWidgetModel/W3DPlayModel",["UWA/Class","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CoreEvents/Events","DS/WebSystem/Environment","i18n!DS/3DPlayWidget/assets/nls/3DPlayWidget"],function(b,f,c,e,g){var a;var d=b.extend({init:function(i){var h=this;a=i;this.allWidgetMessage=g;this.boxMessage=this.constructBoxMessageData();this.setBoxMessageText();this.objIdx=0;this.availableExperiences=[];this.availableServices=[];this.currentContent;this.emptyOrDefaultModel=true;this.curAsset;this.curProvider;this.canvasDivRef;this.x3d;this.currentCSO;this.plateformPromise=this.getAllPlatformServices();this.plateformPromise.then(function(j){h.availableServices=j},function(j){console.error("getAllPlatformServices Error!");console.dir(j)})},dispose:function(){},getPreferencesFromSwitchApp:function(){var l=a.getValue("afrExecutionContexts");var h=a.getValue("pad_tenant");var k=a.getValue("pad_security_ctx");var i=a.getValue("PAD3DViewerPathsInSession");var j={afrExecutionContexts:l,pad_tenant:h,pad_security_ctx:k,PAD3DViewerPathsInSession:i};return j},getCollabSpacePref:function(){var h=a.getValue("CollabSpacePref");return h},getX3dContentPref:function(){var h=a.getValue("X3DContentId");return h},getSelectedExperiencePref:function(){var j=a.getValue("selectedExperience");var i=e.get("3DPlay.OverrideSettings");if(i){var h=JSON.parse(i);if(h.hasOwnProperty("input")){if(h.input.hasOwnProperty("experience")){console.log("-----  OverrideSettings ---- ",h.input["experience"]["filename"])}j=h.input["experience"]["filename"];return j}}if(j==undefined){return false}return j},getCurrentExperience:function(){return this.getCurrentData(0).selectedExperience},getSwymModelIdPref:function(){var h=a.getValue("MODELID");return h},getSwymTenantIdPref:function(){var h=a.getValue("swymTenantId");return h},getW3DPlayContentPref:function(){var h=a.getValue("W3DPlayContent");return h},getCurrentContent:function(){return this.currentContent},getCurrentData:function(h){if(this.currentContent===undefined){return false}else{if(!UWA.is(h)){h=0}return this.currentContent.data["items"][h]}},getCurrentProvider:function(){if(this.currentContent){return this.currentContent.data["items"][0]["serviceId"]}return""},getWidgetMessage:function(h){if(UWA.is(h,"string")){if(this.allWidgetMessage[h]){return this.allWidgetMessage[h]}else{console.error("Unable to find Nls key for :",h)}}else{console.error("Invalid nls key > ",h)}},getAllPlatformServices:function(){return new Promise(function(i,h){f.getServiceUrl({serviceName:"3DSpace",onComplete:function(j){i(j)},onFailure:function(j){h(j);console.error("Error in i3DXCompassServices.getPlatformServices :",j)}})})},get3DSpaceServiceUrl:function(i){var h=false;if(i&&UWA.is(i,"string")){this.availableServices.forEach(function(j){if(j.platformId===i){h=j.url}})}return h},constructBoxMessageData:function(){return{invite_msgDom:"",invite_imgDom:"",DEFAULT:{classIcon:"fonticon-block",msg:""},REPLACE:{classIcon:"fonticon-down-circled",msg:""},DROPIT:{classIcon:"fonticon-down-circled",msg:""},ERROR:{classIcon:"fonticon-block",msg:""}}},getBoxMessageData:function(){return this.boxMessage},getBoxClassIcon:function(h){return this.boxMessage[h].classIcon},getBoxMessageText:function(h){return this.boxMessage[h].msg},getCanvasDiv:function(){return this.canvasDivRef},getDefaultModelIsRunning:function(){return this.emptyOrDefaultModel},getCurrentCSO:function(){return this.currentCSO},setDefaultModelIsRunning:function(h){this.emptyOrDefaultModel=h},setInitialContent:function(h){this.currentContent=h},setCurrentContent:function(i){this.currentContent=i;this.update("Model.changeCurrent");var j=this.getCurrentContent();this.setW3DPlayContent(j);var h=this.getCurrentData();a.setValue("afrProductTitle",h.displayName)},setCurrentAsset:function(h){this.curAsset=h},setAvailableServices:function(h){this.availableServices=h},setCurrentProvider:function(h){this.curProvider=h},setCurrentExperience:function(h){var i=this.getCurrentContent();i.data["items"][0]["selectedExperience"]=h;a.setValue("W3DPlayContent",JSON.stringify(i))},setCurrentTitle:function(h){if(h!==""&&(typeof h!=="undefined")){this.currentContent.data["items"][0]["displayName"]=h;this.update("Model.changeTitle")}},setCanvasDiv:function(h){this.canvasDivRef=h},setW3DPlayContent:function(h){a.setValue("W3DPlayContent",JSON.stringify(h))},saveSwitchAppPreferences:function(k){var h=k.data["items"][0];var l=h.contextId;var i=h.envId;var j=JSON.stringify([[h.objectId]]);a.setValue("pad_tenant",i);a.setValue("pad_security_ctx",l);a.setValue("PAD3DViewerPathsInSession",j)},setCurrentCSO:function(h){this.currentCSO=h;this.update("Model.changeCSO",this.currentCSO)},setPlayerRef:function(h){this.playerRef=h},getPlayerRef:function(){return this.playerRef},setBoxMessageText:function(){this.boxMessage.REPLACE.msg=this.getWidgetMessage("REPLACE_IT_MSG");this.boxMessage.DROPIT.msg=this.getWidgetMessage("DROP_IT_MSG");this.boxMessage.ERROR.msg=this.getWidgetMessage("DROP_ERROR_MSG")},isSwymIdValid:function(h){if(UWA.is(h)&&h!=""&&h!="false"&&typeof h!="undefined"){this.emptyOrDefaultModel=false;return h}else{return false}},isX3DContentIdValid:function(i){if(i&&i!=="undefined"){var h=JSON.parse(i);if(UWA.is(h,"object")){if(h.hasOwnProperty("data")){this.emptyOrDefaultModel=false;return true}return false}}else{return false}},get3DPlayWebInputObject:function(i){var k=this;var j={input:{},options:{loading:"autoplay",callbacks:{experience:{dispose:function(){k=null}},asset:{LoadingFinished:function(){if(k){k.LoadingFinishedCB.apply(k,arguments)}}}}}};if(i){var n=this.getCurrentContent();this.setW3DPlayContent(n);var h=this.getCurrentData();a.setValue("afrProductTitle",h.displayName);var m=this.getAssetFromProvider(i);if(this.drag&&n.source){m.asset.source=n.source}this.drag=false;if(m!==undefined){this.setCurrentAsset(m);j.input=m}}return j},getAssetFromProvider:function(h){var j=h.serviceId.toUpperCase();var i;switch(j){case"3DSWYM":i=this.get3DSwymInput(h);break;case"3DSPACE":i=this.get3DSpaceInput(h);break;case"3DDRIVE":i=this.get3DDriveInput(h);break;case"2DLAYOUT":i=this.get2DLayoutInput(h);break;case"DROPBOX":i=this.getDropboxInput(h);break;case"ONEDRIVE":i=this.getOneDriveInput(h);break;case"FILE":i=h;break;default:console.warn("Missing provider, this must be set! ",j)}return i},getCurrentAsset:function(){return this.curAsset},isLoadingFInished:function(){var h=this.getPlayerRef();if(h&&h.instance&&h.instance.modelLoadComplete){return true}return false},LoadingFinishedCB:function(i){if(this.isPendingLoadingCozNotReady){this.isPendingLoadingCozNotReady=false;this.update("Model.changeCurrent");return}if(i.model!=="3DS_emblem.cgr"){var k=this.getCurrentContent();this.setW3DPlayContent(k);var h=this.getCurrentData();a.setValue("afrProductTitle",h.displayName);var j=this.getCurrentProvider().toUpperCase();if(j==="3DSWYM"){this.get3DSwymTitle(k)}else{if(j==="3DSPACE"){this.saveSwitchAppPreferences(k)}}}},get3DSwymTitle:function(h){var j=this;if(this.x3d){this.x3d.get3DSwymMetaData(h,function(k){j.setCurrentTitle(k.title);j=null},function(k){console.error(k)})}else{var i="DS/3DPlayConnectors/3DSwymConnector";require([i],function(k){j.x3d=new k();j.get3DSwymTitle(h)})}},get2DLayoutInput:function(i){var h={asset:i.asset};h.asset.originalAsset={provider:"3DSPACE",type:"2DLayout"};return h},get3DSwymInput:function(h){var i={asset:{objectId:h.objectId,provider:"3DSwym",envId:h.envId,type:"media",}};return i},get3DDriveInput:function(h){return{asset:{objectId:h.objectId,provider:h.serviceId.toUpperCase(),physicalid:h.objectId,type:h.objectType,dtype:h.objectType,tenant:h.envId}}},get3DSpaceInput:function(h){var i=this.get3DSpaceServiceUrl(h.envId);if(i){return{asset:{provider:"EV6",physicalid:h.objectId,serverurl:i,type:h.objectType,dtype:h.objectType,requiredAuth:"passport",tenant:h.envId,contextid:h.contextId}}}else{console.warn("3DPlay WIDGET : Unable to find 3DSpace Service for Tenant > ",h.envId);return false}},getDropboxInput:function(h){return{asset:{objectId:h.objectId,provider:h.serviceId.toUpperCase(),physicalid:h.objectId,requiredAuth:"passport",type:h.objectType,dtype:h.objectType,tenant:h.envId}}},getOneDriveInput:function(h){return{asset:{objectId:h.objectId,provider:h.serviceId.toUpperCase(),physicalid:h.objectId,requiredAuth:"passport",type:h.objectType,dtype:h.objectType,tenant:h.envId}}},update:function(i,h){c.publish({event:i,data:h})}});return d});define("DS/3DPlayWidgetControllers/W3DPlayPrefsCtrl",["UWA/Class","DS/CoreEvents/Events","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(c,i,b){var d,h,f,e;var g={protocol:"3DXContent",version:"1.0",source:"X3DCSMA_AP",data:{items:[{envId:"defaultString",serviceId:"defaultString",contextId:"defaultString",objectId:"defaultString",objectType:"defaultString",displayName:"",displayType:"defaultString",displayIcon:"defaultStringUri",displayPreview:"defaultStringUri",selectedExperience:"defaultString"}]}};var a=c.extend({init:function(l,k,j){f=l;d=k;e=this;d.plateformPromise.then(function(m){e.readAllPreferences();e=null},function(m){console.error("getAllPlatformServices Error!");console.dir(m)})},dispose:function(){d=h=f=e=null},readAllPreferences:function(){var j=d.getSwymModelIdPref();var l=d.getSwymTenantIdPref();var k=d.getCollabSpacePref();var o=d.getX3dContentPref();var m;var r=d.getW3DPlayContentPref();if(d.applicationFrameOptions&&d.applicationFrameOptions.options&&d.applicationFrameOptions.options.pad3DViewer&&this.isAnySwitchAppPreferences()){var q=d.getPreferencesFromSwitchApp();var p=this.switchAppDataPreparation(q);d.setW3DPlayContent(p)}if(this.isSwymIdValid(j)&&this.isW3DPlayContentEmpty()){m=this.newSwymDataPreparation(j,l);d.setW3DPlayContent(m)}else{if(this.isCollabSpaceValid(k)&&this.isW3DPlayContentEmpty()){m=this.newSpaceDataPreparation(k);d.setW3DPlayContent(m)}else{if(this.isX3DContentIdValid(o)){m=JSON.parse(o);d.setW3DPlayContent(m)}}}if(!this.isW3DPlayContentEmpty()){r=d.getW3DPlayContentPref();d.setInitialContent(JSON.parse(r))}else{}i.publish({event:"PrefsCtrl.PreferencesReady"})},isAnySwitchAppPreferences:function(){var j=false;var l=d.getPreferencesFromSwitchApp();var k=l.afrExecutionContexts;if(k&&k!==null&&typeof k!=="undefined"&&l.PAD3DViewerPathsInSession&&l.pad_security_ctx&&l.pad_tenant){j=true}return j},isPreferencesEmpty:function(){var j=true;var k=d.getW3DPlayContentPref();if(k&&k!==null&&typeof k!=="undefined"){j=false}return j},isW3DPlayContentEmpty:function(){var j=true;var k=d.getW3DPlayContentPref();if(k&&k!==null&&typeof k!=="undefined"){j=false}return j},switchAppDataPreparation:function(l){var j=l.PAD3DViewerPathsInSession;if(j){j=this.getPhyIdFromPad3DViewer(JSON.parse(j))}var k=g.data["items"][0];k.envId=l.pad_tenant;k.serviceId="3DSpace";k.contextId=l.pad_security_ctx;k.objectType="VPMReference";k.objectId=j;return g},getPhyIdFromPad3DViewer:function(j){var k=j.length;if(k>0){return j[0][0]}else{console.error("Invalid Paths In Sessions",j)}},isSwymIdValid:function(j){if(UWA.is(j)&&j!=""&&j!="false"&&typeof j!="undefined"){d.setDefaultModelIsRunning(false);return j}else{return false}},newSwymDataPreparation:function(m,j,l){var k=g.data["items"][0];k.envId=j;k.objectId=m;k.serviceId="3DSWYM";k.objectType="3DShape";if(l){console.warn("wow very old ( <R416 ?) 3DPlay Widget Preferences!")}return g},newSpaceDataPreparation:function(j){return JSON.parse(j)},isCollabSpaceValid:function(k){var l=false;if(k&&k!=="undefined"){var j=JSON.parse(k);if(UWA.is(j,"object")){if(j.hasOwnProperty("data")){d.setDefaultModelIsRunning(false);l=true}}}return l},isX3DContentIdValid:function(k){var m=false;if(k&&k!=="undefined"){var j=JSON.parse(k);if(UWA.is(j,"object")){if(j.hasOwnProperty("data")){d.setDefaultModelIsRunning(false);m=true}}}var l=d.getW3DPlayContentPref();if(l&&l!==null&&typeof l!=="undefined"){m=false}return m},deleteLegacyModelIdPref:function(j){f.setValue("MODELID","");if(j){f.deleteValue("MODELID")}},deleteLegacyPlatformdPref:function(j){f.setValue("PLATFORM","");if(j){f.deleteValue("PLATFORM")}},deleteAllLegacyPrefs:function(){this.deleteLegacyModelIdPref();this.deleteLegacyPlatformdPref()},cleanCollabSpacePref:function(j){f.setValue("CollabSpacePref","");if(j){f.deleteValue("CollabSpacePref")}},getAllPlatformServices:function(){return new Promise(function(k,j){b.getServiceUrl({serviceName:"3DSpace",onComplete:function(l){k(l)},onFailure:function(l){j(l);console.error("Error in i3DXCompassServices.getPlatformServices :",l)}})})}});return a});define("DS/3DPlayHelper/3DPlayWebPlayer",["DS/3DPlay/3DPlay","DS/3DPlayHelper/SplashScreen","DS/3DPlayConnectors/3DPlayInputPreProcessor","DS/WebSystem/Environment","DS/CoreEvents/Events","DS/WebSystem/Context","DS/WebUtils/ContextedSingleton","DS/WebUtils/ProbesManager","UWA/Core","DS/3DPlaySupport/ExperiencesList","DS/3DPlaySupport/AssetSupport","DS/3DPlaySupport/SupportList","DS/WebappsUtils/WebappsUtils"],function(k,g,n,m,c,h,d,i,f,b,a,j,e){var l=function(p,q){if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer",q)}function B(J){var H=window.localStorage["3DPlay.OverrideSettings"];if(H!==undefined){console.warn("!! 3DPlay OverrideSetting variable environment Active");console.warn("Current options :"+J.options);try{H=JSON.parse(H);if(H&&H.options){console.warn("Found options :"+H.options);J.options=f.extend(J.options,H.options,true)}}catch(I){console.error("Override failed : JSON.parse error"+I)}}console.warn("Resulting options :"+J.options);return J}var D=function(H){return function(K){try{var J=window.top.document.createEvent("CustomEvent");J.initCustomEvent("3DPLAYLOADINGFINISHED",true,false,{helper:H});window.top.document.dispatchEvent(J)}catch(I){}}};var A=function(H){return function(L){var I=window.document.getElementById("landing-page_container");if(I){I.remove()}H.loaded=true;try{var K=window.top.document.createEvent("CustomEvent");K.initCustomEvent("3DPLAYERROR",true,false,{helper:H});window.top.document.dispatchEvent(K)}catch(J){}}};var r=function(H){return function(I){if(I){H.addScriptingFunction=I.addScriptingFunction;H.getScriptingFunctions=I.getScriptingFunctions;H.executeScriptingFunction=I.executeScriptingFunction;H.hasScriptingFunction=I.addScriptingFunction;H.removeScriptingFunction=I.getScriptingFunctions;H.disposeAllScriptingFunctions=I.executeScriptingFunction;H.subscribeScriptingFunction=I.executeScriptingFunction;H.unsubscribeScriptingFunction=I.addScriptingFunction;H.subscribeAllScriptingFunctions=I.getScriptingFunctions;H.unsubscribeAllScriptingFunctions=I.executeScriptingFunction;H.instance=I;H.loaded=true}try{var K=window.top.document.createEvent("CustomEvent");K.initCustomEvent("3DPLAYREADY",true,false,{helper:H});window.top.document.dispatchEvent(K)}catch(J){}}};if(q===null||q===undefined||q.input===null||q.input===undefined){q.input={}}if(q.options===undefined||q.options===null){q.options={}}if(m.isSet("3DPlay.OverrideSettings")){q=B(q)}p.lastOptions=f.extend({},q);var y=q.options;if(y.callbacks===undefined||y.callbacks===null){y.callbacks={}}var C=true;if(y.callbacks.experience){for(var E in y.callbacks.experience){if(C&&E.toUpperCase().indexOf("EXPERIENCEREADY")>-1){C=false}}}if(C){console.warn("In 420/18x the old way :  var p3Dplay = new Player3DPlayWeb is deprecated, please give a callback");console.warn("with the object options: {callback:{experience:ExperienceReady:{function(e)}}}")}y.callbacks.eXPEriENcE={eRRoR:A(p),eXPEriENceReADy:r(p)};y.callbacks.aSSeT={lOADinGfINIsheD:D(p)};var z=q.ctx?q.ctx:q.options.ctx?q.options.ctx:h.createContext("Default");q.ctx=z;if(q.options!==undefined&&q.options.callbacks!==undefined){k.addCallbacks(q.ctx,q.options.callbacks)}p.inputPreProcessor=new n();p.endAllCommands=function(H){k.endAllCommands(H)};if((typeof q.container)==="string"){q.container=document.getElementById(q.container)}d.add(z,"helper",p);q.options.splashscreen=q.options.splashscreen||{};p.addScriptingFunction=function(){console.error("Empty Function")};p.execute=function(){console.error("Empty Function")};p.getFunctions=function(){console.error("Empty Function")};p.instance=undefined;p.loaded=false;p._check=function(){if(!this.isReady()){console.error("Experience is not ready");return false}if(!this.instance){console.error("Experience is not created");return false}return true};p.isReady=function(){return(this.ctx!==null&&this.ctx!==undefined)||this.loaded};p.options=q;if(q.input&&q.input.usage==="3DSwYm"){delete q.input.usage;var x=q.container;window.mycontainertoUse=q.container;window.swyWidgettoUse=q.widget;delete q.container;delete q.widget;var s=q.options.splashscreen;if(s&&s.custom){s.custom=s.custom.id}var o=q.options.fullscreen;if(o&&o.mode==="CUSTOM"){window.mySwymCallBack={onActivate:o.onActivate,onDeactivate:o.onDeactivate}}var t=document.createElement("iframe");t.style.position="relative";t.style.width="100%";t.style.height="100%";t.style.border="0px";t.style.top="0px";t.style.left="0px";t.allowFullScreen=t.mozAllowFullScreen=t.webkitAllowFullScreen=true;t.setAttribute("allowFullScreen","");var F=e.getProxifiedWebappsBaseUrl();try{if(window.location.origin.indexOf("3dswym")>-1||F===null){F=e.getWebappsBaseUrl()}}catch(G){F=e.getWebappsBaseUrl()}t.src=F+"3DPlayHelper/3DPlaySyndication.html?params="+encodeURIComponent(JSON.stringify(q));if(typeof q.container==="string"){x=document.getElementById(x)}x.appendChild(t);try{window.top.document.addEventListener("3DPLAYERROR",function(H){return function(J){var I=J.detail.helper;if(H.ctx===I.getCtx()){if(H.options.callbacks&&H.options.callbacks.experience&&H.options.callbacks.experience.error){H.options.callbacks.experience.error(p.getCtx())}}}}(q),false);window.top.document.addEventListener("3DPLAYREADY",function(H){return function(J){var I=J.detail.helper;if(H.ctx===I.getCtx()){p=f.extend(p,I,true);if(H.options.callback&&H.options.callback.onAnnotationShared){var K=I.getExperience();if(K&&K.setOnAnnotationShared){K.setOnAnnotationShared(H.options.callback.onAnnotationShared)}}if(H.options.callbacks){I.getExperience().addCallbacks(H.options.callbacks);if(H.options.callbacks.experience&&H.options.callbacks.experience.ExperienceReady){H.options.callbacks.experience.ExperienceReady(p.getExperience())}}}}}(q),false)}catch(G){}}else{var v=function(){i.createProbe("ExperienceReady").begin();p.inputPreProcessor.run(p.options.input,function(H){p.options.input=H;if(typeof H==="object"){H.tenantID=H.tenantID||H.tenant||q.options.tenant||q.options.tenantID}if(!H.tenantID){H.tenantID=(H.asset&&H.asset.tenant)?H.asset.tenant:undefined}window.extensionDictionaryApp=window.extensionDictionaryApp||{};window.interfaceDictionaryApp=window.interfaceDictionaryApp||{};window.componentDictionaryApp=window.componentDictionaryApp||{};k.createExperience(q)})};var u=q.options.pad3DViewer!==undefined||q.container===undefined;if(u===false){if(q.options.splashscreen.custom&&typeof q.options.splashscreen.cutom==="string"){try{q.options.splashscreen.custom=window.top.getElementById(q.options.splashscreen.custom)}catch(G){}}var w=q.options.loading==="autoplay";p.playerSplashScreen=new g({custom:q.options.splashscreen.custom,customBgColor:q.options.splashscreen.customBgColor,customLogoSrc:q.options.splashscreen.customLogoSrc,customAppName:q.options.splashscreen.customAppName,logoDisplay:q.options.splashscreen.logoDisplay,autoplay:w,container:q.container,callback:function(H){c.publish({event:"/"+z+"/EXPERIENCE/EXPERIENCESPLASHSCREEN",data:H})},onClick:v});if(q.options.loading=="preload"){v()}}else{v()}}p.load=function(I){if(m.isSet("3DPlay.OverrideSettings")){I=B(I)}if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer.Load",I)}if(this.instance){this.instance.totalLoadingAssetProfiler=i.createProbe("_Load_");this.instance.totalLoadingAssetProfiler.begin()}else{if(!this.loaded){p.options.input=I.input;return}}var J=true;if(I){I.options=I.options||{};I.options.splashscreen=I.options.splashscreen||{};if(I.options.splashscreen&&I.options.splashscreen.custom&&typeof I.options.splashscreen.cutom==="string"){try{I.options.splashscreen.custom=window.top.getElementById(I.options.splashscreen.custom)}catch(L){}}if(I.options.loading==="onclick"){J=false;I.options.loading="autoplay"}}var M=this;var K=function(){if(M.playerSplashScreen){M.playerSplashScreen.hide()}if(M.instance&&M.instance.clearView){M.instance.clearView()}M.inputPreProcessor.run(I.input,function(R){I.input=R;if(!I.options){I.options={}}I.options.newAsset=false;if(M.isReady()){var P=function(T){var S=(M.instance!==undefined&&M.instance!==null)?M.instance.args:M.lastOptions;var U=S.input.experience!==undefined?S.input.experience.filename:"";if(T===U||U.indexOf(T)>-1||(T==="3DPlayCollaborativeExperience"&&U==="DS/3DPlayDefaultExperience/3DPlayDefaultExperience")){if((typeof I.input)==="string"){I.input={asset:I.input}}I.options.newAsset=true;I.input.experience={filename:U};M.loadAsset(I.input,I.options);return}if(M.lastOptions.options&&M.lastOptions.options.splashscreen){M.lastOptions.options.splashscreen.custom=null}M.dispose();if(M.lastOptions.options){delete M.lastOptions.options.pad3DViewer}M.loaded=false;M.lastOptions.input=undefined;M.lastOptions.ctx=S.ctx;k.subscribe(M.lastOptions.ctx,"EXPERIENCE/ERROR",A(M));var V=f.extend(M.lastOptions,I,true);l(M,V)};if(I.input.experience===""){I.input.experience=undefined}var N=I.input.experience;if(N===undefined||N===null||N===""){var O=I.input.asset;N=undefined;var Q=O.provider;if(O.type||O.dtype||O.mimetype){a.getExperienceID(O,{usage:R.usage},function(S){P(S);return});return}if(N!==undefined){N=N.module}}else{if((typeof N)==="string"){N=b[N];if(N){N=N.module}}else{if(N.filename!==undefined){N=N.filename}}}P(N)}})};if(J){K()}else{try{var H=this.playerSplashScreen.elements.container.parentElement;if(this.playerSplashScreen){this.playerSplashScreen.remove();this.playerSplashScreen=null}this.playerSplashScreen=new g({custom:I.options.splashscreen.custom,customBgColor:I.options.splashscreen.customBgColor,customLogoSrc:I.options.splashscreen.customLogoSrc,customAppName:I.options.splashscreen.customAppName,logoDisplay:I.options.splashscreen.logoDisplay,container:H,containerOptions:{insertBefore:true},onClick:K});if(this.instance){this.instance.playerSplashScreen=this.playerSplashScreen}}catch(L){K()}}};p.loadAsset=function(H,I){if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer.loadAsset",H,I)}if(H===undefined||H===null){I=true}if(I===true||I===false){console.warn('3DPLAYWEB - DEPRECATED CALL - second argment is now an object for options. If you want to clear the scene graph, add to this object the property "clearSceneGraph" with the value "true"');I={clearSceneGraph:I}}if(this.instance){this.inputPreProcessor.run(H,function(J){this.instance.load(J,I)}.bind(this))}};p.removeAsset=function(H){if(this._check()){this.instance.remove(H)}};p.sendEvent=function(H,I){if(this._check()){}};p.dispose=function(H){if(this._check()){this.loaded=this.ctx=undefined;d.removeCtx(this.getCtx());this.instance.dispose(H);this.instance=null}if(this.playerSplashScreen){this.playerSplashScreen.remove();this.playerSplashScreen=null}if(this.ctx){this.ctx=null}};p.informActiveState=function(H){if(this._check()){return this.instance.informActiveState(H)}};p.getExperience=function(){return this.instance}};return l});define("DS/3DPlayWidgetViews/W3DPlayerView",["DS/CoreEvents/Events","UWA/Class","DS/3DPlayHelper/3DPlayHelper","DS/3DPlaySupport/AssetSupport","i18n!DS/3DPlayHelper/assets/nls/SplashScreen","css!DS/3DPlayWidgetViews/W3DPlayerView","DS/WebSystem/Environment"],function(o,b,d,a,h,c,l){var n,g,f,k,e="canvas-div";var j,i=[];return b.extend({init:function(p,m){n=p;g=m;this._parent(p,m);this.setViewerCollab();this.declareAllSubscribers();j=this},declareAllSubscribers:function(){i.push(o.subscribeOnce({event:"PrefsCtrl.PreferencesReady"},function(m){j.instantiate3DPlayWebPlayer()}));i.push(o.subscribe({event:"Player.load"},function(m){if(f){f.load(m)}}));i.push(o.subscribe({event:"Model.changeCurrent"},function(m){j.refresh()}));i.push(o.subscribe({event:"Model.changeCSO"},function(m){j.incomingSelectPartHandler(m)}))},setViewerCollab:function(){window.top.document.addEventListener("3DPLAYLOADINGFINISHED",function(m){k=m.detail.helper},false)},incomingSelectPartHandler:function(q){var m;if(k.instance&&k.instance.pad3DViewer){m=k.instance.pad3DViewer._lockCSONotification;k.instance.pad3DViewer._lockCSONotification=true}k.emptySelection();k.selectNode(q);var p=function(){if(k.instance&&k.instance.pad3DViewer){k.instance.pad3DViewer._lockCSONotification=m}};p();setTimeout(p,50)},instantiate3DPlayWebPlayer:function(){this.processPlayerOptions()},refresh:function(){this.processPlayerOptions()},processPlayerOptions:function(){var p=g.getCurrentData();g.setCurrentTitle(p.displayName);var m=g.get3DPlayWebInputObject(p);m.container=e;if(m.input&&m.input.asset){m.input.asset.displayname=p.displayName}this.startPlayer(m)},dispose:function(m){if(f){f.dispose(m);f=null}n=g=k=null;for(var p=0;p<i.length;p++){o.unsubscribe(i[p])}i=[];j=null},startPlayer:function(m){if(this.applicationFrameOptions&&m.options){if(m.options.callbacks){m.options.callbacks=UWA.extend(m.options.callbacks,this.applicationFrameOptions.options.callbacks,true)}m.options=UWA.extend(m.options,this.applicationFrameOptions.options,true);if(m.input&&this.applicationFrameOptions.experience){m.input.experience=this.applicationFrameOptions.experience}}if(this.applicationFrameOptions&&this.applicationFrameOptions.options&&this.applicationFrameOptions.options.pad3DViewer){delete this.applicationFrameOptions.options.pad3DViewer}if(!f){m.options.callbacks.EXPERIENCE=m.options.callbacks.EXPERIENCE||{};m.options.callbacks.EXPERIENCE.EXPERIENCESPLASHSCREEN=function(q){if(document.activeElement.offsetWidth>780&&document.activeElement.offsetHeight>200){this.formFactor="L"}else{if(document.activeElement.offsetWidth<779&&document.activeElement.offsetWidth>581&&document.activeElement.offsetHeight>200){this.formFactor="M"}else{if(document.activeElement.offsetWidth<580&&document.activeElement.offsetWidth>280&&document.activeElement.offsetHeight>200){this.formFactor="S"}else{if(document.activeElement.offsetWidth<280||document.activeElement.offsetHeight<200){this.formFactor="XS"}else{this.formFactor="L"}}}}if(!l.isSet("3DPlay.LandingPage.disable")){q.viewLoading.addContent({tag:"div","class":"lp-txt-container",html:[{tag:"h4",id:"lp-msg","class":"lp-txt font-3dsregular",html:h.DROP_MSG_LP},{tag:"img","class":"lp-drop-img"}]});if(this.formFactor==="L"){q.viewLoading.addClassName("large-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img")}else{if(this.formFactor==="M"){q.viewLoading.addClassName("large-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img")}else{if(this.formFactor==="S"){q.viewLoading.addClassName("small-background");q.viewLoading.getElementsByTagName("img")[0].addClassName("lp-drop-img-small");q.viewLoading.getElementsByTagName("h4")[0].hide()}else{if(this.formFactor==="XS"){q.viewLoading.addClassName("xsmall-background");q.viewLoading.getElementsByTagName("h4")[0].hide();q.viewLoading.getElementsByTagName("img")[0].hide()}}}}}};f=new d(m)}else{if(f.isReady()){f.load(m)}else{g.isPendingLoadingCozNotReady=true}}g.setPlayerRef(f)},widgetRefreshHandler:function(){if(f){if(f.instance&&f.instance.refresh){var m=f.instance.refresh();if(m){return true}}f.dispose();f=null}g.getCanvasDiv().empty();return false},get3DPlayInstance:function(){return f}})});
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/3DPlayWidget/Widget3DPlay",["DS/3DPlayWidgetModel/W3DPlayModel","DS/3DPlayWidgetViews/W3DPlayMainView","DS/3DPlayWidgetViews/W3DPlayerView","DS/3DPlayWidgetControllers/W3DPlayDDCtrl","DS/3DPlayWidgetControllers/W3DPlayPrefsCtrl","DS/3DPlayWidgetControllers/W3DPlayModelFilteringCtrl","DS/3DPlayWidgetControllers/W3DPlayIncomingMsgCtrl","css!DS/3DPlayWidget/assets/3DPlayWidget","DS/CoreEvents/Events"],function(s,a,d,r,c,q,i,h,n){var k;var o={};var f;var b=function(){o.wModel=new s(k);o.wModel.applicationFrameOptions=f;o.wView=new a(k,o.wModel);o.wPlayer=new d(k,o.wModel);o.wPlayer.applicationFrameOptions=f;o.wPCtrl=new c(k,o.wModel,o.wView);o.wDDCtrl=new r(o.wModel,o.wView);o.wFilteringCtrl=new q(o.wPlayer);o.wIncMsgCtrl=new i(o.wModel,o.wView);f&&f.widgetCB&&f.widgetCB(o);o.dispose=function(t){k.removeEvent("onRefresh",j);k.removeEvent("onLoad",b);k.removeEvent("onHide",g);k.removeEvent("onShow",l);k.removeEvent("onViewChange",p);k=null;f=null;e(t)}};var e=function(t){n.publish({event:"3DPLAY/PLAYFROMCOMPASS/DISABLE",data:{}});if(o.wModel){o.wModel.dispose(t)}o.wModel=null;if(o.wView){o.wView.dispose(t)}o.wView=null;if(o.wPlayer){o.wPlayer.dispose(t)}o.wPlayer=null;if(o.wPCtrl){o.wPCtrl.dispose(t)}o.wPCtrl=null;if(o.wDDCtrl){o.wDDCtrl.dispose(t)}o.wDDCtrl=null};var j=function(){if(!o.wPlayer.widgetRefreshHandler()){o.wView.buildCanvas();o.wView.restoreDragAndDropZone();o.wView.createBlueBackground();o.wPlayer.instantiate3DPlayWebPlayer()}};var m=function(){return navigator.userAgent.match(/(Android|iPhone|iPad)/i)?true:false};var g=function(t){if(this.fullscreen){n.publish({event:"3DPLAY/PLAYFROMCOMPASS/DISABLE",data:{}})}if(m()&&o.wModel.isLoadingFInished()){e()}};var l=function(t){if(m()){if(!o.wModel){b()}}if(this.fullscreen){setTimeout(function(){n.publish({event:"3DPLAY/PLAYFROMCOMPASS/ENABLE",data:{}})},500)}};var p=function(t){if(t.type==="maximized"||t.type==="fullscreen"){console.log("fullscreen");n.publish({event:"3DPLAY/FULLSCREEN/ENABLE",data:{}})}else{if(t.type==="windowed"){this.fullscreen=false;n.publish({event:"3DPLAY/FULLSCREEN/DISABLE",data:{}})}}};return function(t){k=t.widget;f=t.applicationFrameOptions;k.setMetas({helpPath:"3DPlayWidget/assets/help"});k.addEvent("onLoad",b);k.addEvent("onRefresh",j);k.addEvent("onHide",g);k.addEvent("onShow",l);k.addEvent("onViewChange",p);k.fullscreen=false}});var id="";if(typeof widget!=="undefined"){id=widget.id}window["3DPlay.ProbesManager.clapDone"]=true;window.performance.mark(id+"clap");try{window.top.performance.mark(id+"clap")}catch(err){window["3DPlay.ProbesManager.TopWindowNotAvailable"]=true}var mark=id+"_3DPlayApp";window.performance.mark(mark);define("DS/3DPlayApp/3DPlayApp",["DS/WAfrContainer/App","DS/3DPlayWidget/Widget3DPlay","DS/WebSystem/Environment","DS/WebSystem/Settings","UWA/Promise","i18n!DS/3DPlayApp/assets/nls/3DPlayApp","DS/WebUtils/ProbesManager","DS/WebUtils/Tracker","DS/3DPlaySupport/ExperiencesList","DS/3DPlaySupport/SupportList"],function(j,a,h,o,b,f,c,l,m,n){h.set("3DPlay.SwitchApp",true);c.createProbe("Require 3DPlayAPP",mark).end();c.createProbe("Splashscreen",mark);var g,k,r=false,e=false,d=false;var i=function(){require(["DS/ApplicationFrame/CommandsManager"],function(t){t._reset()})};var q=[m.PIMwebIsr3DPlayExperience.module,m.PIMwebItf3DPlayExperience.module],s=[m["3DPlayModelViewer"].module,m["3DPlayCollaborativeExperience"].module],p=["3DSPACE","EV6"];return j.extend({init:function(t){k=this;this._parent(t)},onWillLeave:function(w){var u=false;if(this.experience&&this.experience.args&&this.experience.args.input){var t=this.experience.args.input;var x=t.experience;if(x){if(q.indexOf(x.filename)>-1){u=true}else{if(s.indexOf(x.filename)>-1){var v=t.asset;if(Array.isArray(v)){v=v[0]}if(v===null||v===undefined){u=true}else{if(v.provider){u=v.provider!=="FILE"}}}}}}if(u){e=true;l.trackPageEvent("transition-to",w?w.options.title:"");return b.resolve()}else{return b.reject(new Error(f.SpecificData_NoTransition))}},dispose:function(){if(d){return}d=true;var t={disposeFrameWindow:!e};if(r===true){if(k.pad3DViewer){var u=k.pad3DViewer.getFrameWindow();if(k.experience){k.experience.clearView();u.getViewer().render()}}}g.dispose(t);this._parent(t);g=null;k.experience=null;k=null;e=false},setUp:function(A){d=false;var y,B={},v;var z=false;if(A){y=A.sourceApp}if(y){if(y.options.id===this.options.id){A.done();this.pad3DViewer=y.pad3DViewer;return}var t=y.getId();l.trackPageEvent("transition-from",y.options.title);k.pad3DViewer=y.pad3DViewer;z=k.pad3DViewer!==undefined;if(z){if(!y.isDisposeCalled()){var u={disposeFrameWindow:false};y.dispose(u);if(u.preferredType){v=u.preferredType}}i();B={ctx:k.pad3DViewer.getCommandContext(),pad3DViewer:k.pad3DViewer}}}B.callbacks={ASSET:{LOADINGFINISHED:function(D){var C=D.loadAssetInfo;if(typeof C==="string"){r=true;return}if(C&&p.indexOf(C.provider)>-1){r=false}else{r=true}}},experience:{experienceready:[function(C){k.pad3DViewer=C.pad3DViewer;k.experience=C;A.done();widget.dispatchEvent("onWidgetAndAppReady",undefined)}]}};B.callbacks.enopad={onReady:function(C){k.pad3DViewer=C}};var x={options:B,widgetCB:function(C){g=C;if(!z){A.done(C.wModel.getCanvasDiv())}}};if(v){var w=n["3DSPACE"][v];if(w){x.experience=w[0]}}a({widget:widget,applicationFrameOptions:x})}})});