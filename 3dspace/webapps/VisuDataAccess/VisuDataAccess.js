define("DS/VisuDataAccess/Ox4TreeTarget",[],function(){var a=function(e,h){var f={};var b={};var d=e;var c=h;f[d.physicalid]=c("Node");f[d.physicalid].id=d.physicalid;var g=f[d.physicalid];g.ident=d.physicalid;g.isrel=false;if(d.dtype!=null){g.plmtype=d.dtype}this.FindRootNodeWorkType=function(){if(d.typeHelper.IsBusA(g.plmtype,d.shapeType)){g.worktype=d.shapeType}else{if(d.typeHelper.IsBusA(g.plmtype,"VPMReference")){g.worktype="VPMReference"}}b[g.plmtype]=[g];if(g.worktype!==g.plmtype){b[g.worktype]=[g]}};this.rootNode=function(){return g};this.registerRelationship=function(k){var j=this.findNodeByPhysicalId(k.phyid);j.boid=k.ident;j.id=k.phyid;j.plmtype=k.plmtype;j.worktype=k.plmtype;j.title=k.title;j.plmexternalId=k.realName;j.owner=k.owner;j.isrel=true;var i=this.findNodeByPhysicalId(k.to.phyid);i.boid=k.to.ident;i.id=k.to.phyid;i.plmtype=k.to.plmtype;i.worktype=i.plmtype;i.title=k.to.title;i.plmexternalId=k.to.realName;i.owner=k.to.owner;i.isrel=false;k.from.add(j);j.add(i)};this.countObjects=function(){var j=0;for(var i in f){if(f.hasOwnProperty(i)){j++}}return j};this.dumpObjects=function(){var j=0;for(var i in f){if(f.hasOwnProperty(i)){console.log(f[i])}}return j};this.FindWorkTypes=function(i,j){d.typeHelper.RegisterParentsTypes(i,function(){for(var m in f){if(f[m].isrel){if(d.typeHelper.IsRelA(f[m].plmtype,d.instanceType)){f[m].worktype=d.instanceType}}else{if(d.referenceType&&d.typeHelper.IsBusA(f[m].plmtype,d.referenceType)){f[m].worktype=d.referenceType}else{if(d.typeHelper.IsBusA(f[m].plmtype,d.shapeType)){f[m].worktype=d.shapeType}}}var k=f[m].plmtype;var l=f[m].worktype;if(!b.hasOwnProperty(k)){b[k]=[]}b[k].push(f[m]);if(l!==k){if(!b.hasOwnProperty(l)){b[l]=[]}b[l].push(f[m])}}j()})};this.findNodeByPhysicalId=function(i){var j=f[i];if(j===undefined){f[i]=c("Node");f[i].id=i}return f[i]};this.findNodeByType=function(i){var j=[];if(b.hasOwnProperty(i)){j=b[i]}return j};this.findNodeByPLMTypeExpressedAsPhyIdSeparatedByComma=function(i){var j=[];if(b.hasOwnProperty(i)){j=b[i]}var k="";j.forEach(function(m,l){k+=m.id;if(l<j.length-1){k+=","}});return k};this.findNodeByPLMTypeExpressedAsPhyIdAsJSON=function(j){var k=this.findNodeByType(j);var i=[];if(k.length>0){k.forEach(function(m,l){i.push(m.id)});return JSON.stringify(i)}else{return[]}}};return a});define("VisuDataAccess/Ox4TreeTarget",["DS/VisuDataAccess/Ox4TreeTarget","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4TreeTarget");return b});define("DS/VisuDataAccess/Ox4TaskPlanner",[],function(){var a=function(){var c=new Array();var b=0;var d=null;this.addSequentialTask=function(f){var e=new Array();e.push(f);c.push(e)};this.addEndingTask=function(e){d=e};this.endingTask=function(){return d};this.next=function(){if(b<c.length){b=b+1;return c[b-1]}return null};this.resetIterator=function(){b=0};this.tasksCount=function(){return c.length};this.currentTaskIndex=function(){return b}};return a});define("VisuDataAccess/Ox4TaskPlanner",["DS/VisuDataAccess/Ox4TaskPlanner","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4TaskPlanner");return b});define("DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition",[],function(){var a=function(e,b,h,c){var d=e;var g=b;this.boOrRel=c;this.injectRowInto=h;var f=function(j){var l="";for(var k=0;k<j.length;k++){l=l+" "+j[k]}return l};this.typeRequested=function(){return d};this.attributes=function(){return listOfAttributes};this.marshallAsMQLListOfFetchAttributes=function(){if(g.Fetch===null){throw"no fetch attributes selected"}return f(g.Fetch)};this.marshallAsMQLListOfFetchAttributesAsJSON=function(){if(g.Fetch===null){throw"no fetch attributes selected"}return JSON.stringify(g.Fetch)};this.hasPathAttrs=function(){return(typeof(g.Path)!=="undefined"&&g.Path!==null)};this.marshallAsMQLListOfPathAttributes=function(){if(g.Path===null){throw"no path attributes selected"}return f(g.Path)};this.marshallAsMQLListOfPathAttributesAsJSON=function(){if(g.Fetch===null){throw"no fetch attributes selected"}return JSON.stringify(g.Path)}};return a});define("VisuDataAccess/Ox4xMQLSelectTaskDefinition",["DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4xMQLSelectTaskDefinition");return b});define("DS/VisuDataAccess/Ox4TicketGeneratorTask",[],function(){var a=function(e,b){var d=e;var c=b;this.generateRequest=function(){var f={url:c.xmqlServiceUri(),data:d};return f}};return a});define("VisuDataAccess/Ox4TicketGeneratorTask",["DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4TicketGeneratorTask");return b});define("DS/VisuDataAccess/Ox4FeatureModeler",["DS/ZipJS/zip"],function(c){var a={rootFeature:new (function(){this.startupFacade=function d(){this.attributes={}};this.featureFacade=new this.startupFacade()})(),fmZipReader:function(e){var d=this;d.archive=new c.BlobReader(e);d.entries=null;d.entriesCount=0;d.entriesRead=0;d.readNextEntry=function(f,g){var h=d.entries[d.entriesRead];(function(i){h.getData(new c.TextWriter(),function(j){f(i,j.target.result);if(++d.entriesRead==d.entriesCount){g()}else{d.readNextEntry(f,g)}})})(h.filename)};d.read=function(f,g){c.createReader(d.archive,function(h){h.getEntries(function(i){d.entries=i;d.entriesCount=i.length;d.readNextEntry(f,g)})})}},unstreamDocument:function(d,g){var f={containers:{},links:{},features:{}};if(a.representations.hasOwnProperty(d.representationId)){console.log("[E] FM: representation already loaded");return}a.representations[d.representationId]={uuid:{},component:{},specobject:{}};var e=new a.fmZipReader(d.stream);e.read(function(i,l){var p=/91ACA40B\\0\.8\\(data.json)/g;var n=/D182A118\\0\.8\\(data.json)/g;var h=/BFC0DC13\\0\.8\\(data.json)/g;var j,m,o;var k=(j=p.exec(i))!==null?"containers":(m=n.exec(i))!==null?"links":(o=h.exec(i))!==null?"features":null;if(k){a.unstreamDomain[k]({domainDependencyTable:f[k],externalDependencies:function(q,r){return f[q][r]},representationId:d.representationId,repRef:d.repRef,stream:l})}},g)},unstreamDomain:{containers:function(e){var f=(undefined!==e.resourceName)?a.resources[e.resourceName]:a.representations[e.representationId];f.containers=e.stream?JSON.parse(e.stream):undefined;var d;for(d in f.containers){e.domainDependencyTable[d]=f.containers[d]}},links:function(d){var e=(undefined!==d.resourceName)?a.resources[d.resourceName]:a.representations[d.representationId];e.links=d.stream?JSON.parse(d.stream):undefined;var g;for(g in e.links){var f=e.links[g];f.relationTarget=d.repRef.SemanticRelations[f.RelationId];d.domainDependencyTable[g]=f}},features:function(e){var d=null;try{d=JSON.parse(e.stream)}catch(f){throw ("[F] FM: JSON error)")}var i={};var h;for(h in d){var g=d[h];i[h]=new a.Feature(g,i,e)}for(h in d){a.unstreamFeature2(i[h],i,e)}}},unstreamFeature2:function(n,m,g){var j=(undefined!=g.resourceName)?a.resources[g.resourceName]:a.representations[g.representationId];var l;var h;for(l in n.data.attributes){var e=n.data.attributes[l];var f=(e.value instanceof Array)?e.value:[e.value];switch(e.type){case"external":if(undefined!==g.representationId){for(h=0;h<f.length;h++){f[h]=(null!==f[h])?g.externalDependencies("links",f[h].id):undefined}}break;case"component":case"specobject":for(h=0;h<f.length;h++){var k=(null!==f[h])?m[f[h].id]:undefined;if(k){f[h]=k.featureFacade;var d=k.data.uuid;if("component"===e.type&&j[e.type][d]){throw"[F] FM: AGG error"}if(!j[e.type][d]){j[e.type][d]=[]}j[e.type][d].push({source:n,attrName:l})}}break;default:}if(e.value instanceof Array){Object.freeze(e.value)}else{e.value=f[0]}}},Feature:function(h,i,e){var g=this;g.data={properties:h.properties,attributes:h.values,startupProperties:h.startup,name:h.system.name,diezele:h.readonly.diezele,uuid:h.readonly.uuid};if(h.hasOwnProperty("ancestor")){if(h.ancestor.hasOwnProperty("resource")){g.data.ancestor=a.rootFeature}else{g.data.ancestor=i[h.ancestor.id]}}else{g.data.ancestor=a.rootFeature}g.featureFacade=new g.data.ancestor.featureFacade.constructor();g.featureFacade.name=g.data.name;g.featureFacade.attributes=Object.create(g.data.ancestor.featureFacade.attributes);var d=function(k){var j={get:function(){return a.getValue(g.data.attributes[k])},enumerable:true};return j};Object.defineProperty(g.featureFacade,"name",{get:function(){return g.data.name},enumerable:true});var f;for(f in g.data.attributes){Object.defineProperty(g.featureFacade.attributes,f,(function(j){return{get:function(){return a.getValue(g.data.attributes[j])},enumerable:true}})(f))}if(g.data.uuid in a.representations[e.representationId].uuid){throw"[F] FM: uuid already defined in same scope"}a.representations[e.representationId].uuid[g.data.uuid]=g},getValue:function(f){var e=f.value;var d;switch(f.type){case"external":var g=(e instanceof Array)?e:[e];for(d=0;d<g.length;d++){g[d]=g[d].relationTarget}if(!e instanceof Array){e=g[0]}break;default:}return e},};var b={init:function(){a.representations={}},loadRepresentation:function(d,e,f,g){a.unstreamDocument({stream:f,representationId:e,repRef:d},g)},loadResource:function(d,e){a.unstreamDocument({stream:e,resourceName:d})},listRootFeatures:function(f){var g=[],e;for(e in a.representations[f].uuid){if(undefined===a.representations[f].component[e]){var d=a.representations[f].uuid[e];g.push(d.featureFacade)}}return g},containFeatures:function(d){return a.representations.hasOwnProperty(d)}};return b});define("DS/VisuDataAccess/Ox4ExpandTask",[],function(){var a=function(g,e,i){this.oid=g;this.serverdefinition=e;this.relationship=i;var h=null;this.generateMQL=function(){return this.serverdefinition.rawmode?this.generateRawMQL():this.generateProcMQL()};this.generateRawMQL=function(){var j="start transaction ;\n";j+="expand businessobject  %oid% from relationship "+this.relationship+"  recurse to all size 1000 terse select bus physicalid type select relationship id physicalid dump | tcl;\n";j+="abort transaction ;\n";return j};this.generateProcMQL=function(){var j='<?xml version="1.0" encoding="utf-8"?>\n';j+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';j+="\t<execute>\n";j+="\t\t<function>expand_bus</function>\n";j+="\t\t<version>2.0.0</version>\n";j+="\t\t<params>\n";j+='\t\t\t<param name="label">expand</param>\n';j+='\t\t\t<param name="rootid">%oid%</param>\n';j+='\t\t\t<param name="from">true</param>\n';j+='\t\t\t<param name="to"></param>\n';j+='\t\t\t<param name="typepattern">*</param>\n';j+='\t\t\t<param name="relpattern">'+this.relationship+"</param>\n";j+='\t\t\t<param name="fixedpointskw"/>\n';j+='\t\t\t<param name="fixedpointsids">[]</param>\n';j+='\t\t\t<param name="withroots">true</param>\n';j+='\t\t\t<param name="preventduplicates">false</param>\n';j+='\t\t\t<param name="recurselevel">all</param>\n';j+='\t\t\t<param name="size">1000</param>\n';j+='\t\t\t<param name="terse">true</param>\n';j+='\t\t\t<param name="selectbo"> ["physicalid", "type", "attribute[PLMEntity.V_Name]", "attribute[PLMEntity.PLM_ExternalID]", "owner"]</param>\n';j+='\t\t\t<param name="wherebokw"/>\n';j+='\t\t\t<param name="wherebo"/>\n';j+='\t\t\t<param name="selectrel">["id","physicalid", "attribute[PLMInstance.V_Name]", "attribute[PLMInstance.PLM_ExternalID]", "owner"]</param>\n';j+='\t\t\t<param name="whererel"/>\n';j+='\t\t\t<param name="dump">|</param>\n';j+='\t\t\t<param name="notsubstitute">true</param>\n';j+="\t\t</params>\n";j+="\t</execute>\n";j+="</executeSequence>\n";return j};var f=this.generateMQL();this.run=function(l,m,o,j,p){h=l;console.log("running Ox4xMQLExpandTask");var k=e.xmqlServiceUri();var n=f.replace("%oid%",this.oid);m.executePostHttpRequest(k,e.rawmode,n,function(r){console.log("callback has been called");var q=new d(g,l,r,function(){j(this)})})};this.dataSet=function(){return h};var c={bus:[],rel:[]};var b=function(l,n){var m=n;var k=l;var j=new Array();this.setFatherLevel=function(q){var p=(j.length-1);if(q>p){}else{if(q<=p){var o=p;while(o!=q){j.pop();o=o-1}j.pop()}}};this.lastNode=function(){return j[j.length-1]};this.pushNode=function(o){j.push(o)};this.getRootNode=function(){return m.rootNode()};this.pushNode(m.rootNode());this.registerRelationship=function(q,p){m.registerRelationship(p);var o=m.findNodeByPhysicalId(p.to.phyid);this.pushNode(o)}};var d=function(j,m,p,o){var n=new b(j,m);var k=function(t){var u=/[^\r\n]+/g;var s=-1;var q=false;var r;while(((r=u.exec(p))!==null)&&(!q)){l(r[0]);if(u.lastIndex===s){q=true}s=u.lastIndex}m.FindWorkTypes(c,function(){o()})};var l=function(x){var u=/\{([^\{\}]*)}/g;var r=-1;var t=false;var z;var v=0;var w=new Object();w.to=new Object();var q=-1;while(((z=u.exec(x))!==null)&&(!t)){var s=z[1];if(q==="0"){if(v===6){n.getRootNode().title=s}else{if(v===7){n.getRootNode().plmexternalId=s}else{if(v===8){n.getRootNode().owner=s}}}}else{if(v===0){q=s;if(q==="0"){v=v+1;continue}n.setFatherLevel(q)}else{if(v===1){w.plmtype=s;if(c.rel.indexOf(s)===-1){c.rel.push(s)}}else{if(v===2){}else{if(v===3){w.to.ident=s}else{if(v===4){w.to.phyid=s}else{if(v===5){w.to.plmtype=s;if(c.bus.indexOf(s)===-1){c.bus.push(s)}}else{if(v===6){w.to.title=s}else{if(v===7){w.to.realName=s}else{if(v===8){w.to.owner=s}else{if(v===9){w.ident=s}else{if(v===10){w.phyid=s}else{if(v===11){w.title=s}else{if(v===12){w.realName=s}else{if(v===13){w.owner=s}}}}}}}}}}}}}}}v=v+1;if(u.lastIndex===r){isILinenfiniteLoop=true}r=u.lastIndex}if(q!=="0"){if(w.phyid!==undefined){var y=n.lastNode();w.from=y;n.registerRelationship(q,w)}}};k(p)}};return a});define("VisuDataAccess/Ox4ExpandTask",["DS/VisuDataAccess/Ox4ExpandTask","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4ExpandTask");return b});define("DS/VisuDataAccess/Ox4PLMDataHelper",[],function(){var a=function(l){var b=l;var c=b.threedexpServiceUri();var h=function(){return b.rawmode?j():q()};var j=function(){var r="start transaction ;\n";r+="get checkout ticket nozip mcsurl %1 \n";r+=" store %2 \n";r+="businessobjectproxy physicalid %3 format %4 filename %5 tcl;\n";r+="abort transaction ;\n";return r};var q=function(){var r='<?xml version="1.0" encoding="utf-8"?>\n';r+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';r+="\t<execute>\n";r+="\t\t<function>get_checkout_ticket</function>\n";r+="\t\t<version>2.0.0</version>\n";r+="\t\t<params>\n";r+='\t\t\t<param name="label">checkout</param>\n';r+='\t\t\t<param name="zipkw">nozip</param>\n';r+='\t\t\t<param name="mcsurl">%1</param>\n';r+='\t\t\t<param name="bops">[{"store": "%2", "bops": [{"physicalid": "%3", "format": "%4", "filename": "%5"}]}]</param>\n';r+="\t\t</params>\n";r+="\t</execute>\n";r+="</executeSequence>\n";return r};var o=h();this.transformSelectedFileIntoTicketRequest=function(t,r,s,u){return g(t,s,r,u)};this.transformSelectedSDByRoleAndFormatIntoTicketRequest=function(v,w,u,s,r,t){if(w.indexOf("SDv2")==0){return this.transformSelectedSDv2ByRoleAndFormatIntoTicketRequest(v,w,u,s,r,t)}if(w.indexOf("SDV0")==0){return this.transformSelectedSDv0ByRoleAndFormatIntoTicketRequest(v,w,u,s,r,t)}return"E_NOTIMPLEMENTED"};this.transformSelectedSDv0ByRoleAndFormatIntoTicketRequest=function(w,r,x,t,s,y){var v=e(r);var u=d(v,x,t,s);var z=null;if(u!==null){z=m(w,u,y)}return z};this.transformSelectedSDv2ByRoleAndFormatIntoTicketRequest=function(w,r,x,t,s,y){var v=i(r);var u=d(v,x,t,s);var z=null;if(u!==null){z=m(w,u,y)}return z};var m=function(t,u,s){var v=""+t+"_"+u.role+"."+u.format;if(u.persistancyname!==undefined&&u.persistancyname.length>0){v+="="+u.persistancyname}v+="";var r=o.replace("%1",c);var r=r.replace("%2",s);var r=r.replace("%3",t);var r=r.replace("%4",u.format);var r=r.replace("%5",v);return r};var g=function(t,s,u,v){var r=o.replace("%1",c);var r=r.replace("%2",s);var r=r.replace("%3",t);var r=r.replace("%4",u);var r=r.replace("%5",v);return r};var d=function(v,u,y,r){for(var s=0;s<r.length;s++){var x=r[s];for(var t=0;t<v.length;t++){var w=v[t];if((w.role==y)&&(w.format==x)&&(w.latetype==u)){return w}}}return null};var e=function(s){var w=/[^:]+/g;var t=-1;var r=false;var v;var u=0;var x=[];while(((v=w.exec(s))!==null)&&(!r)){var y=p(v[0]);x.push(y);u=u+1;if(w.lastIndex===t){isILinenfiniteLoop=true}t=w.lastIndex}return x};var p=function(r){var s=r.slice(3,4);var t=r.slice(5,r.length-1);return k(s,t)};function k(w,s){var x=/[^,]+/g;var t=-1;var r=false;var v;var u=0;var y=new Object();y.sdtype=w;while(((v=x.exec(s))!==null)&&(!r)){if(u===0){y.format=v[0]}else{if(u===1){y.role=v[0]}else{if(u===2){y.latetype=v[0]}else{if(u===3){y.watermarkstamp=v[0]}}}}u=u+1;if(x.lastIndex===t){isILinenfiniteLoop=true}t=x.lastIndex}return y}var i=function(s){var w=/[^:]+/g;var t=-1;var r=false;var v;var u=0;var x=[];while(((v=w.exec(s))!==null)&&(!r)){var y=n(v[0]);x.push(y);u=u+1;if(w.lastIndex===t){isILinenfiniteLoop=true}t=w.lastIndex}return x};var n=function(r){var s=r.slice(3,4);var t=r.slice(5,r.length-1);return f(s,t)};function f(w,s){var x=/[^,]+/g;var t=-1;var r=false;var v;var u=0;var y=new Object();y.sdtype=w;while(((v=x.exec(s))!==null)&&(!r)){if(u===0){y.format=v[0]}else{if(u===1){y.role=v[0]}else{if(u===2){y.latetype=v[0]}else{if(u===3){y.watermarkstamp=v[0]}else{if(u===4){y.synchrostamp=v[0]}else{if(u===5){y.persistancytype=v[0].replace(/[']+/g,"")}else{if(u===6){y.persistancyname=v[0].replace(/[']+/g,"")}}}}}}}u=u+1;if(x.lastIndex===t){isILinenfiniteLoop=true}t=x.lastIndex}return y}};return a});define("VisuDataAccess/Ox4PLMDataHelper",["DS/VisuDataAccess/Ox4PLMDataHelper","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4PLMDataHelper");return b});define("DS/VisuDataAccess/Ox4StreamUnStreamerTaskDefinition",[],function(){var a=function(c,d,e){var b=c;this.streamReceived=d;this.streamsNumber=e;this.responseType=null;this.typeRequested=function(){return b}};return a});define("DS/VisuDataAccess/ProxyAbstraction",["DS/Visualization/ProxyAbstraction"],function(a){return a});define("VisuDataAccess/ProxyAbstraction",["DS/VisuDataAccess/ProxyAbstraction","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/ProxyAbstraction");return b});define("DS/VisuDataAccess/Ox4DECSelectTask",[],function(){var a=function(c,i,j){var k=c;var e=null;var b=i;var g=function(p,q,u,t){var s=p;var r=q;var n=function(y){var z=/[^\r\n]+/g;var x=-1;var v=false;var w;while(((w=z.exec(u))!==null)&&(!v)){o(s,w[0]);if(z.lastIndex===x){v=true}x=z.lastIndex}t()};var o=function(C,w){var B=/\{([^\}]*)}/g;w=w.substring(1,(w.length-1));var y=-1;var v=false;var A;var z=0;var x=new Array();while(((A=B.exec(w))!==null)&&(!v)){if(A[0].indexOf("{{")==0){A[0]=A[0].substring(2,A[0].length)}if(A[0].indexOf("{")==0){A[0]=A[0].substring(1,A[0].length)}if(A[0].indexOf("}")==(A[0].length-1)){A[0]=A[0].substring(0,A[0].length-1)}x.push(A[0]);z=z+1;if(B.lastIndex===y){isILinenfiniteLoop=true}y=B.lastIndex}s.injectRowInto(x,r)};n(u)};var d=function(){return b.rawmode?f():m()};var f=function(){var n="start transaction ;\n";if(k.boOrRel==0){n+="query connection type '%1'  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n"}else{if(k.boOrRel==1){n+="temporary query businessobject  '%1' * *  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n"}else{if(k.boOrRel==2){n+="temporary query businessobject  * * *  where \"physicalid matchlist '"+j+"'','\"  select %3 dump | tcl;\n"}else{n+=" expand businessobject "+j+' from relationship "CAD SubComponent" recurse to all size 1000 terse select bus physicalid name dump | tcl;\n'}}}n+="abort transaction ;\n";return n};var m=function(){var n='<?xml version="1.0" encoding="utf-8"?>\n';n+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';n+="\t<execute>\n";if(k.boOrRel>=0&&k.boOrRel<=2){if(k.boOrRel==0){n+="\t\t<function>query_connection</function>\n"}else{n+="\t\t<function>query_bus</function>\n"}n+="\t\t<version>2.2.1</version>\n";n+="\t\t<params>\n";n+='\t\t\t<param name="label">select</param>\n';if(k.boOrRel!=0){n+='\t\t\t<param name="name">*</param>\n';n+='\t\t\t<param name="revision">*</param>\n'}n+='\t\t\t<param name="vault">*</param>\n';n+='\t\t\t<param name="orderbykw"/>\n';n+='\t\t\t<param name="orderby"/>\n';n+='\t\t\t<param name="limitkw"/>\n';n+='\t\t\t<param name="limit"/>\n';n+='\t\t\t<param name="where">where</param>\n';n+='\t\t\t<param name="select">%3</param>\n';if(k.boOrRel==2){n+='\t\t\t<param name="type">*</param>\n';n+='\t\t\t<param name="where">physicalid matchlist \''+j+"'','</param>\n"}else{n+='\t\t\t<param name="type">%1</param>\n';n+="\t\t\t<param name=\"where\">physicalid matchlist '%2'','</param>\n"}n+='\t\t\t<param name="notsubstitute">true</param>\n';n+='\t\t\t<param name="dump">|</param>\n';n+="\t\t</params>\n"}else{n+="\t\t<function>expand_bus</function>\n";n+="\t\t<version>2.0.0</version>\n";n+="\t\t<params>\n";n+='\t\t\t<param name="label">expand</param>\n';n+='\t\t\t<param name="rootid">'+j+"</param>\n";n+='\t\t\t<param name="from">true</param>\n';n+='\t\t\t<param name="to"/>\n';n+='\t\t\t<param name="typepattern">*</param>\n';n+='\t\t\t<param name="relpattern">"CAD SubComponent"</param>\n';n+='\t\t\t<param name="fixedpointskw"/>\n';n+='\t\t\t<param name="fixedpointsids">[]</param>\n';n+='\t\t\t<param name="withroots">false</param>\n';n+='\t\t\t<param name="preventduplicates">false</param>\n';n+='\t\t\t<param name="recurselevel">all</param>\n';n+='\t\t\t<param name="selectbo"> ["physicalid", "name"]</param>\n';n+='\t\t\t<param name="wherebo"/>\n';n+='\t\t\t<param name="selectrel"/>\n';n+='\t\t\t<param name="whererelkw"/>\n';n+='\t\t\t<param name="whererel"/>\n';n+='\t\t\t<param name="dump">|</param>\n';n+="\t\t</params>\n"}n+="\t</execute>\n";n+="</executeSequence>\n";return n};var h=d();this.run=function(t,q,s,v,u){e=t;console.log("running Ox4xMQLSelectTask");var o=b.xmqlServiceUri();var n=k.typeRequested();var p=t.findNodeByPLMTypeExpressedAsPhyIdSeparatedByComma(n);if(p.length>0){var r=h.replace("%1",n);r=r.replace("%3",k.marshallAsMQLListOfFetchAttributesAsJSON());r=r.replace("%2",p);q.executePostHttpRequest(o,b.rawmode,r,function(w){l(w,t,v)})}else{v(this)}};var l=function(p,q,o){var n=new g(k,q,p,function(){o(this)})}};return a});define("VisuDataAccess/Ox4DECSelectTask",["DS/VisuDataAccess/Ox4DECSelectTask","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4DECSelectTask");return b});define("DS/VisuDataAccess/Ox4SelectTask",[],function(){var a=function(c,i){var j=c;var e=null;var b=i;var g=function(n,o,s,r){var q=n;var p=o;var l=function(y){var z=/[^\r\n]+/g;var t=/^paths:.*/g;var x=-1;var v=false;var u="fetch";var w;while(((w=z.exec(s))!==null)&&(!v)){if(q.hasPathAttrs()&&u==="fetch"&&t.exec(w[0])!==null){u="path"}m(q,u,w[0]);if(z.lastIndex===x){v=true}x=z.lastIndex}r()};var m=function(x,A,z){var w=/\{(.*?)\}[\s\}]/g;z=z.substring(1,(z.length-1));var u=-1;var v=false;var B;var y=0;var t=new Array();while(((B=w.exec(z))!==null)&&(!v)){B[0]=B[0].trim();if(B[0].indexOf("{{")==0){B[0]=B[0].substring(2,B[0].length)}if(B[0].indexOf("{")==0){B[0]=B[0].substring(1,B[0].length)}if(B[0].indexOf("}")==(B[0].length-1)){B[0]=B[0].substring(0,B[0].length-1)}while(B[0].startsWith("{")||B[0].endsWith("}")){if(B[0].startsWith("{")){B[0]=B[0].substring(1,B[0].length)}if(B[0].endsWith("}")){B[0]=B[0].substring(0,B[0].length-1)}}t.push(B[0]);y=y+1;if(w.lastIndex===u){isILinenfiniteLoop=true}u=w.lastIndex}q.injectRowInto(A,t,p)};l(s)};var d=function(){return b.rawmode?f():k()};var f=function(){var l="start transaction ;\n";if(j.boOrRel==0){l+="query connection type %1  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n"}else{l+="temporary query businessobject  %1 * *  where \"physicalid matchlist '%2'','\"  select %3 dump | tcl;\n"}l+="abort transaction ;\n";return l};var k=function(){var l='<?xml version="1.0" encoding="utf-8"?>\n';l+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';l+="\t<execute>\n";if(j.boOrRel==0){l+="\t\t<function>query_connection_set"}else{l+="\t\t<function>query_bus_set"}if(j.hasPathAttrs()){l+="_sr"}l+="</function>\n";l+="\t\t<version>2.0.0</version>\n";l+="\t\t<params>\n";l+='\t\t\t<param name="label">fetch</param>\n';l+='\t\t\t<param name="setname">%s</param>\n';if(j.boOrRel!=0){l+='\t\t\t<param name="name">*</param>\n';l+='\t\t\t<param name="revision">*</param>\n'}l+='\t\t\t<param name="vault">*</param>\n';l+='\t\t\t<param name="orderbykw"/>\n';l+='\t\t\t<param name="orderby"/>\n';l+='\t\t\t<param name="limitkw"/>\n';l+='\t\t\t<param name="limit"/>\n';l+='\t\t\t<param name="rootids">%2</param>\n';l+='\t\t\t<param name="select">%3</param>\n';l+='\t\t\t<param name="type">%1</param>\n';if(j.hasPathAttrs()){l+='\t\t\t<param name="labelSR">paths</param>\n';l+='\t\t\t<param name="selectpath">%4</param>\n'}l+='\t\t\t<param name="notsubstitute">true</param>\n';l+='\t\t\t<param name="dump">|</param>\n';l+="\t\t</params>\n";l+="\t</execute>\n";l+="</executeSequence>\n";return l};var h=d();this.run=function(r,o,q,t,s){e=r;console.log("running Ox4xMQLSelectTask");var m=b.xmqlServiceUri();var l=j.typeRequested();var n=r.findNodeByPLMTypeExpressedAsPhyIdAsJSON(l);if(n.length>0){var p=h.replace("%s",o.SetName);p=p.replace("%1",l);p=p.replace("%2",n);p=p.replace("%3",j.marshallAsMQLListOfFetchAttributesAsJSON());if(j.hasPathAttrs()){p=p.replace("%4",j.marshallAsMQLListOfPathAttributesAsJSON())}o.executePostHttpRequest(m,b.rawmode,p,function(v){var u=new g(j,r,v,function(){t(this)})})}else{t(this)}}};return a});define("VisuDataAccess/Ox4SelectTask",["DS/VisuDataAccess/Ox4SelectTask","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4SelectTask");return b});define("DS/VisuDataAccess/Ox4XHRWithProxyAbstraction",["UWA/Class","UWA/Data","UWA/Utils","UWA/Utils/Client","UWA/Ajax","UWA/Json","DS/WAFData/WAFData"],function(d,f,g,h,e,c,a){var b=function(){this.executeGetHttpRequest=function(k,p,m,o){if(b.proxyUsage===2){console.log("gestion WAFData");var j=new Object();j.headers=new Object();j.data=new Object();j.data.GET=m;j.method="GET";j.async=true;j.proxy=b.proxymode;j.authentication=b.authentication;j.onComplete=o;j.type=p;var l=a.handleRequest(k,j)}else{if(b.proxyUsage===1){k=i(k,b.server,b.sport)}var n=new XMLHttpRequest();n.open("GET",k,true);n.onload=function(q){o(this.response)};n.setRequestHeader("X-Requested-With","XMLHttpRequest");if(p==="arraybuffer"){n.responseType=p}n.send(m)}};this.executePostHttpRequest=function(k,p,o,n){if(b.proxyUsage==2){console.log("gestion WAFData");var j={timeout:300000,method:"POST",data:o,type:"text",proxy:b.proxymode,authentication:b.authentication,headers:{"Content-type":p,Accept:"text/plain",},onComplete:n,onFailure:function(q){UWA.log("arguments onFailure");UWA.log(arguments)}};if(b.securityToken){j.headers.SecurityToken=b.securityToken}var l=a.handleRequest(k,j)}else{if(b.proxyUsage==1){k=i(k,b.server,b.sport)}var m=new XMLHttpRequest();m.open("POST",k);m.onload=function(q){n(this.response)};m.setRequestHeader("Content-type",p);m.setRequestHeader("Accept","text/plain");m.send(o)}};this.executePostHttpRequestWithOptions=function(k,j){if(b.proxyUsage==2){j.timeout=300000;j.method="POST";j.type=j.type?j.type:"text";j.proxy=b.proxymode;j.authentication=b.authentication;j.onFailure=j.onFailure?j.onFailure:function(n){UWA.log("arguments onFailure");UWA.log(arguments)};j.headers?j.headers:{};j.headers.Accept?j.headers.Accept:"text/plain";var l=a.handleRequest(k,j)}else{if(b.proxyUsage==1){k=i(k,b.server,b.sport)}var m=new XMLHttpRequest();m.open("POST",k);m.onload=function(n){callback(this.response)};m.setRequestHeader("Content-type",j.headers.Content-type);m.setRequestHeader("Accept",j.headers.Accept?j.headers.Accept:"text/plain");m.send(postParams)}};this.executePostHttpRequest2=function(l,q,p,o,k){if(b.proxyUsage==2){console.log("gestion WAFData");var j={timeout:300000,method:"POST",data:p,type:"text",proxy:b.proxymode,authentication:b.authentication,headers:{"Content-type":q,Accept:"text/plain",},onComplete:o,onFailure:function(r){UWA.log("arguments onFailure");UWA.log(arguments)}};if(k.responseType!=null){j.type=k.responseType}var m=a.handleRequest(l,j)}else{if(b.proxyUsage==1){l=i(l,b.server,b.sport)}var n=new XMLHttpRequest();n.open("POST",l);n.onload=function(r){o(this.response)};n.setRequestHeader("Content-type",q);n.setRequestHeader("Accept","application/octet-stream");if(k.responseType!=null){n.responseType=k.responseType}n.send(p)}};this.executeSyncPostHttpRequest=function(l,p,o){if(b.proxyUsage==2){console.log("gestion WAFData");var j;var k={timeout:300000,method:"POST",data:o,type:"text",proxy:b.proxymode,authentication:b.authentication,async:false,headers:{"Content-type":p,Accept:"text/plain",},onComplete:function(q){console.warn("retour >data",q);j=q},onFailure:function(q){console.log("arguments onFailure");console.log(arguments)}};if(b.securityToken){k.headers.SecurityToken=b.securityToken}var m=a.handleRequest(l,k);return j}else{if(b.proxyUsage==1){l=i(l,b.server,b.sport)}var n=new XMLHttpRequest();n.open("POST",l,false);n.setRequestHeader("Content-type",p);n.setRequestHeader("Accept","text/plain");n.send(o);return n.responseText}return""};this.transformUrlIntoRealUrl=function(k){if(b.proxyUsage==2){console.log("WAFData No Proxyfication");var j=new Object();return k}else{if(b.proxyUsage==1){k=i(k,b.server,b.sport);return k}}return k};this.asyncTransformFCSUrlIntoRealUrl=function(k,j,o){var l=k.url;var m=k.data;var n="application/xml";if(typeof(j)==="boolean"&&j){n="application/xmql"}this.executePostHttpRequest(l,n,m,function(r){var v=/\{\{([^\}]*)\}\{([^\}]*)\}\}/;var t=v.exec(r);var s=t[1];var u=t[2];var p=u;var q="posthttp:"+p+":postparams:__fcs__jobTicket="+encodeURIComponent(s);o(k,q)})};var i=function(l,m,k){var j=l.indexOf("/");var o=l.indexOf("/",j+2);var n=l.slice(0,j)+"//"+m+":"+k+l.slice(o,l.length);return n}};b.useNoProxy=function(){b.proxyUsage=0;b.server=null;b.sport=null};b.useProxyDefinedBy=function(j,i){b.proxyUsage=1;b.server=j;b.sport=i};b.useUWAProxy=function(i){b.proxyUsage=2;b.server=null;b.sport=null;b.proxymode=i.proxymode;b.authentication=i.proxymode;if(i.contextid&&i.login){b.securityToken=i.login+"|"+i.contextid}};return b});define("VisuDataAccess/Ox4XHRWithProxyAbstraction",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4XHRWithProxyAbstraction");return b});define("DS/VisuDataAccess/Ox4DataAccessObjectFactory",[],function(){var a=function(){};a.createServerDefinition2=function(f,b,e,d){var c=new Object();if(typeof(f)==="undefined"){console.log("No Hostname in CreateServerDefinition");return null}c.hostname=f;if(typeof(b)==="undefined"){console.log("No RootUri in CreateServerDefinition");return null}c.rooturi=b;c.isSecure=false;if(typeof(e)!="undefined"){if(e){c.isSecure=true}}c.port=-1;if(typeof(d)!="undefined"){c.port=d}c.xmqlServiceUri=function(h){var i="http://";if(this.isSecure){i="https://"}var g=i+this.hostname;if(this.port!=-1){g+=":"+this.port}g+="/"+this.rooturi+"/i3dx/services/xmql";if(typeof(h)==="boolean"&&h){g+="?raw=true"}return g};return c};a.createServerDefinition=function(e,d,b){var c=new Object();c.hostname=e;c.port=d;c.rooturi=b;c.xmqlServiceUri=function(){return"http://"+this.hostname+":"+this.port+"/"+this.rooturi+"/i3dx/services/xmql?raw=true"};return c};a.createDisplayObjectSpecification=function(c,d){var b=new Object();b.physicalid=c;b.serverdefinition=d;return b};return a});define("VisuDataAccess/Ox4DataAccessObjectFactory",["DS/VisuDataAccess/Ox4DataAccessObjectFactory","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4DataAccessObjectFactory");return b});define("DS/VisuDataAccess/Ox4SetTask",[],function(){var a=function(g,i){var h=this;var b=g;var c=i;var d=function(){return c.rawmode?e():j()};var e=function(){var k="start transaction ;\n";if(b){k+="label deleteset delete set %1"}else{k+="label addset add set %1 type temporary hidden;"}k+="commit transaction;";return k};var j=function(){var k='<?xml version="1.0" encoding="utf-8"?>\n';k+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';k+="\t<execute>\n";if(b){k+="\t\t<function>delete_set</function>\n"}else{k+="\t\t<function>add_set</function>\n"}k+="\t\t<version>2.0.0</version>\n";k+="\t\t<params>\n";if(b){k+='\t\t\t<param name="label">deleteset</param>\n'}else{k+='\t\t\t<param name="label">addset</param>\n'}k+='\t\t\t<param name="setname">%1</param>\n';k+="\t\t</params>\n";k+="\t</execute>\n";k+="</executeSequence>\n";return k};var f=d();this.run=function(m,n,p,k,q){console.log("running Ox4MQLSetTask");var l=c.xmqlServiceUri();var o=f.replace("%1",n.SetName);n.executePostHttpRequest(l,c.rawmode,o,function(r){console.log((b?"Delete":"Add")+" Set: OK!");k(this)})}};return a});define("DS/VisuDataAccess/Ox4StreamLoader",["DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/WAFData/WAFData"],function(a,d,k,i){var c=null;var h=null;var n=function(p){var o=p.url;p.xmqlServiceUri=function(){return o+"/i3dx/services/xmql"};p.threedexpServiceUri=function(){return o};k.useUWAProxy({proxymode:"passport"})};var f=function(p,q,o){var r='<?xml version="1.0" encoding="utf-8"?>\n';r+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';r+="\t<execute>\n";r+="\t\t<function>query_bus</function>\n";r+="\t\t<version>2.0.0</version>\n";r+="\t\t<params>\n";r+='\t\t\t<param name="type">'+q+"</param>\n";r+='\t\t\t<param name="name">*</param>\n';r+='\t\t\t<param name="revision">*</param>\n';r+='\t\t\t<param name="vault">*</param>\n';r+='\t\t\t<param name="where">physicalid=='+p+"</param>\n";r+='\t\t\t<param name="select">'+JSON.stringify(o)+"</param>\n";r+='\t\t\t<param name="dump">,</param>\n';r+="\t\t</params>\n";r+="\t</execute>\n";r+="</executeSequence>\n";return r};var e=function(q,p,t,u,s,r,o){return{mqlCmd:f(q,p,["attribute[StreamDescriptors]","format.file.name","format.file.store"]),parseTCLRow:function(L){var F=/{{.*} {.*} {.*} {{([^{}]*)}} {({.*})} {({.*})}}/;var J=F.exec(L);var A=J[1];var G=J[2];var w=J[3];var I=A.split(":");var B=[];for(var C=0;C<I.length;C++){var z=/SDv2\((.*),'(.*)',(.*),.*,.*,'(.*)','(.*)'\)/;var K=z.exec(I[C]);B.push({format:K[1],role:K[2],lateType:K[3],persistancyType:K[4],persistancyName:K[5]})}var E=/{([^{}]*)}/g;var y=null;var D=[];while((y=E.exec(G))!==null){D.push(y[1])}var H=[];while((y=E.exec(w))!==null){H.push(y[1])}var x={name:"",store:""};for(var C=0;C<B.length;C++){var v=B[C];if((t===undefined||t===v.format)&&(u===undefined||u===v.role)&&(s===undefined||s===v.lateType)&&(r===undefined||r===v.persistancyType)&&(o===undefined||o===v.persistancyName)){if(x.name===""){x.name=q+"_'"+v.role+"'."+v.format;if(v.persistancyName){x.name+="="+v.persistancyName}x.format=v.format}else{x.tooManyFilesError=true;x.name=""}}}if(x.name!==""){for(var C=0;x.store===""&&C<D.length;C++){if(x.name===D[C]){x.store=H[C]}}}if(x.name===""||x.store===""){x.noStreamRetrieved=true;x.name="";x.store=""}return x}}};var l=function(o,p,q){return{mqlCmd:f(o,p,["format["+q+"].file.name","format["+q+"].file.store"]),parseTCLRow:function(t){var s=/{{.*} {.*} {.*} {{([^{}]*)}} {{([^{}]*)}}}/;var r=s.exec(t);if(r===null){return{tooManyFilesError:true}}else{return{name:r[1],store:r[2]}}}}};var g=function(s,r,q){var p=null;if(s.IRPC){p=e(s.physicalid,s.boType,s.format,s.role,s.lateType,s.persistancyType,s.persistancyName)}else{p=l(s.physicalid,s.boType,s.format)}var t="application/xml";var o=new k();o.executePostHttpRequest(h.xmqlServiceUri(),t,p.mqlCmd,function(v){var u=p.parseTCLRow(v);if(u.tooManyFilesError){q("Too many streams retrieved")}else{if(u.noStreamRetrieved){q("No stream retrieved")}else{u.physicalid=s.physicalid;if(u.format===undefined&&s.format!==undefined){u.format=s.format}if(u.format!==undefined){r(u)}else{q("Stream format has to be specified")}}}})};var j=function(q,s,r){var t=c.transformSelectedFileIntoTicketRequest(q.physicalid,q.format,q.store,q.name);var o=new d(t,h);var p=new k();p.asyncTransformFCSUrlIntoRealUrl(o.generateRequest(),false,function(u,v){s(v)})};var m=function(t,o,v,s){if(t.slice(0,8)=="posthttp"){var p=t.indexOf(":postparams:");var u=t.slice(9,p);var q=t.slice(p+12,t.length);var w={cors:true,timeout:100000,method:"POST",data:q,responseType:o,async:true,headers:{Accept:"text/plain",},onComplete:v,onFailure:s};var r=i.authenticatedRequest(u,w)}};var b={Load:function(o){if(c===null||h===null||h.url!==o.serverUrl){h={rawmode:false,url:o.serverUrl};n(h);c=new a(h)}g(o,function(p){j(p,function(q){m(q,o.streamType,o.onStreamLoaded,o.onError)},o.onError)},o.onError)}};return b});define("DS/VisuDataAccess/Ox4TypeHelper",["DS/Visualization/Utils","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(c,k){var b=function(p){if(typeof(p.hostname)==="undefined"){console.log("Ox4TypeHelper:No Hostname in ServerDefinition");return null}var n=p.hostname;if(typeof(p.rooturi)==="undefined"){console.log("Ox4TypeHelper:No RootUri in ServerDefinition");return null}var r=p.rooturi;var q="http://";if(typeof(p.protocol)!="undefined"){if(p.protocol==="https"){q="https://"}}var m=-1;if(typeof(p.port)!="undefined"){m=p.port}var o=q+n;if(m!=-1){o+=":"+m}o+="/"+r+"/i3dx/services/xmql";return o};var f=function(m){var n='<?xml version="1.0" encoding="utf-8"?>\n';n+='<executeSequence xmlns="http://www.3ds.com/xmql/query">\n';n+="\t<execute>\n";if(m){n+="\t\t<function>get_parents_rel_type</function>\n"}else{n+="\t\t<function>get_parents_bus_type</function>\n"}n+="\t\t<version>1.0.0</version>\n";n+="\t\t<params>\n";n+='\t\t\t<param name="type">%1</param>\n';n+="\t\t</params>\n";n+="\t</execute>\n";n+="</executeSequence>\n";return n};var g=null;var d=f(false);var h=f(true);var e=function(p,n,t){var q=new k();var s=n?h:d;s=s.replace("%1",p);if(t!==null){var m={data:s,type:"json",headers:{"Content-type":"application/xml",Accept:"application/json"},onComplete:function(v){var u=[];try{u=JSON.parse(v.xmql_response.body.result[2].output);if(!Array.isArray(u)){u=[]}}catch(w){u=[]}t(u)}};q.executePostHttpRequestWithOptions(g,m)}else{var o=[];try{o=JSON.parse(q.executeSyncPostHttpRequest(g,"application/xml",s));if(!Array.isArray(o)){o=[]}}catch(r){o=[]}return o}};var l=function(p,o,q){var m=q;if(m===undefined){m=null}if(typeof p!=="string"){if(m!==null){m([])}else{return[]}}else{if(a[o].hasOwnProperty(p)){if(null!==m){m(a[o][p])}else{return a[o][p]}}else{if(null!==m){e(p,o==="rel",function(r){a[o][p]=r;while(r.length>0){r=r.slice(0);a[o][r.shift()]=r}m(a[o][p])})}else{var n=e(p,o==="rel",null);a[o][p]=n;while(n.length>0){n=n.slice(0);a[o][n.shift()]=n}console.warn("[Ox4TypeHelper]: Synchronous server call is deprecated, switch to asynchronous version");return a[o][p]}}}};var i=function(n,m){return a[n].hasOwnProperty(m)};var a={bus:{},rel:{}};var j={IsInit:function(){return g!=null},Init:function(o,p,n){var m={requiredAuth:p,proxyurl:n};if(m.requiredAuth===undefined){m.requiredAuth=null}if(m.proxyurl===undefined){m.proxyurl=null}c.setProxyFromSpec(m,k);g=b(o)},InitWithUrl:function(n,q,p,o){var m={requiredAuth:p,proxyurl:o};if(m.requiredAuth===undefined){m.requiredAuth=null}if(m.proxyurl===undefined){m.proxyurl=null}c.setProxyFromSpec(m,k);g=n+"/i3dx/services/xmql";if(typeof q==="string"){g+="?tenant="+q}},RegisterParentsTypes:function(o,r){var n=o;var p=function(t,v,s){var u=t.pop();while(u&&i(v,u)){u=t.pop()}if(u){l(u,v,function(){p(t,v,s)})}else{s()}};var q=0;var m=function(){if(++q==2){r()}};p(o.bus,"bus",m);p(o.rel,"rel",m)},GetParentsBusType:function(m,n){return l(m,"bus",n)},GetParentsRelType:function(m,n){return l(m,"rel",n)},IsBusA:function(o,q,p){var m=p;if(m===undefined){m=null}if(typeof o!=="string"||typeof q!=="string"){if(m!==null){m(false)}else{return false}}else{if(o===q){if(m!==null){m(true)}else{return true}}else{if(m!==null){this.GetParentsBusType(o,function(r){m(r.indexOf(q)>=0)})}else{var n=this.GetParentsBusType(o);return n.indexOf(q)>=0}}}},IsRelA:function(o,q,p){var m=p;if(m===undefined){m=null}if(typeof o!=="string"||typeof q!=="string"){if(m!==null){m(false)}else{return false}}else{if(o===q){if(m!==null){m(true)}else{return true}}else{if(m!==null){this.GetParentsRelType(o,function(r){m(r.indexOf(q)>=0)})}else{var n=this.GetParentsRelType(o);return n.indexOf(q)>=0}}}}};return j});define("VisuDataAccess/Ox4TypeHelper",["DS/VisuDataAccess/Ox4TypeHelper","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4TypeHelper");return b});define("DS/VisuDataAccess/Ox4DECPlanRunner",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(a){var b=function(h,d,g,o,m){var k=function(){this.executePostHttpRequest=function(r,p,u,t){var q=new a();var s="application/xml";if(typeof(p)==="boolean"&&p){s="application/xmql"}q.executePostHttpRequest(r,s,u,t)};this.executeSyncPostHttpRequest=function(r,p,t){var q=new a();var s="application/xml";if(typeof(p)==="boolean"&&p){s="application/xmql"}return q.executeSyncPostHttpRequest(r,s,t)}};var f=d;var l=h;var j=new k();var i=o;var n=m;var c=function(p){console.log("onNextTask");var q=h.next();if(q==null){e()}else{q[0].run(f,j,g,c,m)}};var e=function(){console.log("----------------Finished-------->");var p=(h.endingTask())(f);if(p.geometryNodes.length>0){i(p)}else{n({type:"NO_GEOMETRY",msg:"No 3D geometry on this product"})}};this.executePlan=function(){console.log("Beginning Ox4PlanRunner runPlan");var p=l.next();p[0].run(f,j,null,c,null);console.log("Ending Ox4PlanRunner runPlan")}};return b});define("VisuDataAccess/Ox4DECPlanRunner",["DS/VisuDataAccess/Ox4DECPlanRunner","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4DECPlanRunner");return b});define("DS/VisuDataAccess/Ox4PlanRunner",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(a){var b=function(i,d,g,h,p,n){var l=function(){this.SetName=g;this.executePostHttpRequest=function(s,q,v,u){var r=new a();var t="application/xml";if(typeof(q)==="boolean"&&q){t="application/xmql"}r.executePostHttpRequest(s,t,v,u)}};var f=d;var m=i;var k=new l(g);var j=p;var o=n;var c=function(q){if(h!==null){var r=(i.currentTaskIndex()/i.tasksCount())*100;h(r)}console.log("onNextTask");var s=i.next();if(s==null){e()}else{s[0].run(f,k,h,c,n)}};var e=function(){console.log("----------------Finished-------->");var q=(i.endingTask())(f);if(q.geometryNodes.length>0){j(q)}else{o({type:"NO_GEOMETRY",msg:"No 3D geometry on this product"})}};this.executePlan=function(){console.log("Beginning Ox4PlanRunner runPlan");var q=m.next();q[0].run(f,k,null,c,null);console.log("Ending Ox4PlanRunner runPlan")}};return b});define("VisuDataAccess/Ox4PlanRunner",["DS/VisuDataAccess/Ox4PlanRunner","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4PlanRunner");return b});define("DS/VisuDataAccess/Ox4DECRunner",["DS/VisuDataAccess/Ox4TreeTarget","DS/VisuDataAccess/Ox4DECPlanRunner","DS/VisuDataAccess/Ox4TaskPlanner","DS/VisuDataAccess/Ox4ExpandTask","DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/VisuDataAccess/Ox4DECSelectTask","DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4TypeHelper"],function(g,a,c,j,d,b,e,h,k){function f(m){var l=new Object();if(typeof(m.serverdefinition.hostname)==="undefined"){console.log("checkAndEnrichSpecification:No Hostname in CreateServerDefinition");return null}l.hostname=m.serverdefinition.hostname;if(typeof(m.serverdefinition.rooturi)==="undefined"){console.log("checkAndEnrichSpecification:No RootUri in CreateServerDefinition");return null}l.rooturi=m.serverdefinition.rooturi;l.isSecure=false;if(typeof(m.serverdefinition.protocol)!="undefined"){if(m.serverdefinition.protocol==="https"){l.isSecure=true}}l.port=-1;if(typeof(m.serverdefinition.port)!="undefined"){l.port=m.serverdefinition.port}l.rawmode=m.rawmode;l.xmqlServiceUri=function(){var o="http://";if(this.isSecure){o="https://"}var n=o+this.hostname;if(this.port!=-1){n+=":"+this.port}n+="/"+this.rooturi+"/i3dx/services/xmql";if(typeof(l.rawmode)==="boolean"&&l.rawmode){n+="?raw=true"}return n};l.threedexpServiceUri=function(){var o="http://";if(this.isSecure){o="https://"}var n=o+this.hostname;if(this.port!=-1){n+=":"+this.port}n+="/"+this.rooturi;return n};m.serverdefinition=l;m.typeHelper=k;m.shapeType="CgrViewable";m.instanceType=m.dtype;return m}var i=function(l,m){var n=f(l);var o=new g(n,m);var q=null;var r=null;var u=null;var t=m;this.run=function(B,G,D){console.log("---> Entering Ox4DECRunner");q=B;r=G;u=D;console.log("---> Building a plan for");var C=n.expand;var x=new Array();if(C==="true"){var v=new p();var A=v.buildPlan(n,x);var F=new a(A,o,q,r,u);F.executePlan()}else{x[0]=n.physicalid}if(x.length==0){x[0]=n.physicalid}for(var z=0;z<x.length;z++){n.physicalid=x[z];var w=new s();var y=w.buildPlan(n);console.log("---> Plan Constructed ");var E=new a(y,o,q,r,u);E.executePlan()}};var p=function(){this.buildPlan=function(z,x){var C=new c();var A=z.physicalid;var y=z.dtype;var w=0;var G=new Array();G.push("physicalid");var E=function(I,J){for(var H=0;H<I.length;H++){x[w]=I[4]}w++};var B=new d(z.instanceType,G,E,3);var D=new b(B,z.serverdefinition,A);C.addSequentialTask(D);var v=function(H,I){console.log("Ox4DOSTaskPlannerForPhyIds::injectRowInto3")};var F=function(J){var H=J.rootNode();var I=J.findNodeByType(y);return{rootNode:H,geometryNodes:I}};C.addEndingTask(F);return C}};var s=function(){this.buildPlan=function(M){console.log("--->Ox4DOSPlanifier:Beginning BuildPlan");console.log(M);console.log("specification.physicalid"+M.physicalid);console.log("dtype:  "+M.dtype);var y=new c();var A=M.physicalid;var H="CGR";var D=M.dtype;var v="Viewable";var C=new j(M.physicalid,M.serverdefinition,v);y.addSequentialTask(C);var z={Fetch:new Array()};z.Fetch.push("physicalid");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_1]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_2]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_3]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_4]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_5]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_6]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_7]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_8]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_9]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_10]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_11]");z.Fetch.push("attribute[LPAbstractInstance.V_matrix_12]");var I=function(P,Q){var O=Q.findNodeByPhysicalId(P[1]);var N=t("Matrix");N.set(P[2],P[5],P[8],P[11]*1000,P[3],P[6],P[9],P[12]*1000,P[4],P[7],P[10],P[13]*1000,0,0,0,1);O.setMatrix(N)};var x=new d(M.instanceType,z,I,0);var w=new b(x,M.serverdefinition,A);y.addSequentialTask(w);var B={Fetch:new Array()};B.Fetch.push("physicalid");B.Fetch.push("attribute[StreamDescriptors]");B.Fetch.push("format.file.store");B.Fetch.push("format["+H+"].file");var L=new e(M.serverdefinition);var K=function(S,T){var Q=T.findNodeByPhysicalId(S[3]);var R=S[6];var P=6;var O=R.split(":");var U="";if(O.length==1){U=O[0]}else{U=O[1]}if(U.search(" ")>=0){U='"'+U+'"'}var N=L.transformSelectedFileIntoTicketRequest(S[3],H,S[5],U);Q.ticketRequest=new h(N,M.serverdefinition)};var F=new d(M.shapeType,B,K,1);var E=new b(F,M.serverdefinition,A);y.addSequentialTask(E);var J=function(N,O){console.log("injectRowInto3")};var G=function(P){var N=P.rootNode();var O=P.findNodeByType(M.shapeType);return{rootNode:N,geometryNodes:O}};y.addEndingTask(G);console.log("--->Ox4DOSPlanifier:Beginning BuildPlan Done");return y}}};return i});define("VisuDataAccess/Ox4DECRunner",["DS/VisuDataAccess/Ox4DECRunner","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4DECRunner");return b});define("DS/VisuDataAccess/Ox4StreamUnStreamerTask",["DS/VisuDataAccess/Ox4XHRWithProxyAbstraction"],function(a){var b=function(f,c){var e=f;var d=c;this.run=function(n,g,k,p,o){var m=new a();var l=n.findNodeByType(e.typeRequested());var j=0;for(var h=0;h<l.length;h++){(function(u){var t=new Array();if(u.ticketRequest!=null){t.push(u.ticketRequest);delete u.ticketRequest}else{if(u.ticketRequests!=null){var q=u.ticketRequests;for(var s=0;s<q.length;s++){t.push(q[s])}}}e.streamsNumber(t.length);j+=t.length;for(var i=0;i<t.length;i++){if(!window.hasOwnProperty("ODTNoFCSCalls")||!window.ODTNoFCSCalls){var r=t[i].generateRequest();m.asyncTransformFCSUrlIntoRealUrl(r,d.rawmode,function(x,y){if(y.slice(0,8)=="posthttp"){var v=y.indexOf(":postparams:");var A=y.slice(9,v);var z=y.slice(v+12,y.length);var w=new Object();if(e.responseType!=null){console.log("registering otherParams reponsetype "+e.responseType);w.responseType=e.responseType}m.executePostHttpRequest2(A,"application/x-www-form-urlencoded",z,function(B){e.streamReceived(u,B,n);if(--j==0){p(this)}},w)}})}else{j--;e.streamReceived(u,null,n)}}})(l[h])}if(j==0){p(this)}}};return b});define("DS/VisuDataAccess/Ox4DOSRunner",["DS/VisuDataAccess/Ox4TreeTarget","DS/VisuDataAccess/Ox4PlanRunner","DS/VisuDataAccess/Ox4TaskPlanner","DS/VisuDataAccess/Ox4SetTask","DS/VisuDataAccess/Ox4ExpandTask","DS/VisuDataAccess/Ox4xMQLSelectTaskDefinition","DS/VisuDataAccess/Ox4SelectTask","DS/VisuDataAccess/Ox4PLMDataHelper","DS/VisuDataAccess/Ox4TicketGeneratorTask","DS/VisuDataAccess/Ox4FeatureModeler","DS/VisuDataAccess/Ox4StreamUnStreamerTaskDefinition","DS/VisuDataAccess/Ox4StreamUnStreamerTask","DS/VisuDataAccess/Ox4TypeHelper","DS/Visualization/PathElement"],function(k,a,c,l,m,d,b,e,i,h,p,n,o,j){function g(r){var q=new Object();if(typeof(r.serverdefinition.hostname)==="undefined"){console.log("checkAndEnrichSpecification:No Hostname in CreateServerDefinition");return null}q.hostname=r.serverdefinition.hostname;if(typeof(r.serverdefinition.rooturi)==="undefined"){console.log("checkAndEnrichSpecification:No RootUri in CreateServerDefinition");return null}q.rooturi=r.serverdefinition.rooturi;q.isSecure=false;if(typeof(r.serverdefinition.protocol)!="undefined"){if(r.serverdefinition.protocol==="https"){q.isSecure=true}}q.port=-1;if(typeof(r.serverdefinition.port)!="undefined"){q.port=r.serverdefinition.port}q.rawmode=r.rawmode;q.xmqlServiceUri=function(){var t="http://";if(this.isSecure){t="https://"}var s=t+this.hostname;if(this.port!=-1){s+=":"+this.port}s+="/"+this.rooturi+"/i3dx/services/xmql";if(typeof r.tenant==="string"){s+="?tenant="+r.tenant}console.log("[DOS]test rawmode type: "+typeof(q.rawmode)+"and value: "+q.rawmode);if(typeof(q.rawmode)==="boolean"&&q.rawmode){s+="?raw=true"}return s};q.threedexpServiceUri=function(){var t="http://";if(this.isSecure){t="https://"}var s=t+this.hostname;if(this.port!=-1){s+=":"+this.port}s+="/"+this.rooturi;return s};r.serverdefinition=q;r.typeHelper=o;r.referenceType="VPMReference";r.shapeType="VPMRepReference";r.instanceType="VPMInstance";return r}var f=function(q,r){if(!o.IsInit()){o.Init(q.serverdefinition,q.requiredAuth,q.proxyurl)}var s=g(q);var u=new k(s,r);var v=null;var w=null;var y=null;var x=r;this.run=function(B,z,C){console.log("---> Entering Ox4DOSRunner");v=B;w=z;y=C;console.log("---> Init Feature Modeler session");h.init();console.log("---> Building a plan for");var A=new t();A.buildPlan(s,function(E){console.log("---> Plan Constructed");u.FindRootNodeWorkType();var D=new a(E,u,s.physicalid+"_set",v,w,y);D.executePlan()})};var t=function(){this.buildPlan=function(z,B){console.log("--->Ox4DOSPlanifier:Beginning BuildPlan");console.log(z);console.log(z.physicalid);var A=false;if(z.dtype!=null){o.IsBusA(z.dtype,z.shapeType,function(M){var C=new c();var R=new l(false,z.serverdefinition);C.addSequentialTask(R);if(!M){var K=new m(z.physicalid,z.serverdefinition,"PLMInstance");C.addSequentialTask(K);var D={Fetch:new Array()};D.Fetch.push("physicalid");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_1]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_2]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_3]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_4]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_5]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_6]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_7]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_8]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_9]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_10]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_11]");D.Fetch.push("attribute[LPAbstractInstance.V_matrix_12]");var S=function(X,Z,aa){var Y=aa.findNodeByPhysicalId(Z[1]);var W=x("Matrix");W.set(Z[2],Z[5],Z[8],Z[11]*1000,Z[3],Z[6],Z[9],Z[12]*1000,Z[4],Z[7],Z[10],Z[13]*1000,0,0,0,1);Y.setMatrix(W)};var I=new d(z.instanceType,D,S,0);var P=new b(I,z.serverdefinition);C.addSequentialTask(P)}else{}var J={Fetch:new Array()};J.Fetch.push("physicalid");J.Fetch.push("attribute[StreamDescriptors]");J.Fetch.push("format.file.store");var V=new e(z.serverdefinition);var U=function(X,Z,aa){var Y=aa.findNodeByPhysicalId(Z[3]);var W=V.transformSelectedSDByRoleAndFormatIntoTicketRequest(Z[3],Z[4],"cgr","''",["2","1"],Z[5]);if(W!==null){Y.ticketRequest=new i(W,z.serverdefinition)}};var O=new d(z.shapeType,J,U,1);var N=new b(O,z.serverdefinition);C.addSequentialTask(N);z.kinematics=true;if(z.kinematics){var E=function(Y,Z){var W=h.listRootFeatures(Y.id);Y.AnimFeatures=W;var X=Z.rootNode();if(!X.hasOwnProperty("AnimFeaturesList")){X.AnimFeaturesList=[]}Array.prototype.push.apply(X.AnimFeaturesList,Y.AnimFeatures)};var H={Fetch:new Array(),Path:new Array()};H.Fetch.push("physicalid");H.Fetch.push("attribute[StreamDescriptors]");H.Fetch.push("format.file.store");H.Path.push("owner.physicalid");H.Path.push("element.order");H.Path.push("element");H.Path.push("attribute[IDRel]");var T=function(ad,ab,X){if("fetch"===ad){var Y=X.findNodeByPhysicalId(ab[3]);if(h.containFeatures(Y.id)){E(Y,X)}else{var Z=V.transformSelectedSDByRoleAndFormatIntoTicketRequest(ab[3],ab[4],"CATNonCATIADocument","'WebFormat'",["1","7"],ab[5]);if(Z!==null){Y.ticketRequest=new i(Z,z.serverdefinition)}}}else{if("path"===ad){var af=(ab.length-3)/2;var Y=X.findNodeByPhysicalId(ab[1]);if(!Y.hasOwnProperty("SemanticRelations")){Y.SemanticRelations={}}var W=new j();W.addElement(X.rootNode());var ac=[];var aa;for(aa=0;aa<af;aa++){ac.push({order:ab[2+aa],instance:ab[2+af+aa].split(",")[2]})}ac.sort(function(ag,ah){return ag.order-ah.order});for(aa=0;aa<ac.length;aa++){var ae=X.findNodeByPhysicalId(ac[aa].instance);W.addElement(ae);if(aa<ac.length-1&&ae.children.length==1){W.addElement(ae.children[0])}}Y.SemanticRelations[ab[2+2*af]]=W}}};var O=new d("CATANIMDISCIPLINE",H,T,1);var N=new b(O,z.serverdefinition);C.addSequentialTask(N);var G=new p("CATANIMDISCIPLINE",function(X,Z,Y){if(Z!==null){h.loadRepresentation(X,X.id,Z,function(){E(X,Y)})}else{var W=Y.rootNode();if(!W.hasOwnProperty("AnimFeaturesList")){W.AnimFeaturesList=[]}W.AnimFeaturesList.push("feature")}},function(){});G.responseType="blob";var L=new n(G,z.serverdefinition);C.addSequentialTask(L)}var F=new l(true,z.serverdefinition);C.addSequentialTask(F);var Q=function(aa){var X=aa.rootNode();var W=aa.findNodeByType(z.shapeType);var Z=[];for(var Y in W){if(W[Y].ticketRequest!==undefined){Z.push(W[Y])}}return{rootNode:X,geometryNodes:Z}};C.addEndingTask(Q);console.log("--->Ox4DOSPlanifier:Beginning BuildPlan Done");B(C)})}}}};return f});define("VisuDataAccess/Ox4DOSRunner",["DS/VisuDataAccess/Ox4DOSRunner","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("VisuDataAccess/Ox4DOSRunner");return b});define("DS/VisuDataAccess/Ox4MQLV6Loader",["DS/Visualization/ThreeJS_DS","WebappsUtils/WebappsUtils","UWA/Utils","DS/Visualization/Utils","DS/Visualization/Node3D","DS/Visualization/Mesh3D","DS/Visualization/MaterialManager","DS/VisuDataAccess/Ox4DOSRunner","DS/VisuDataAccess/Ox4DECRunner","DS/VisuDataAccess/Ox4XHRWithProxyAbstraction","DS/VisuDataAccess/Ox4TypeHelper","DS/WAFData/WAFData","DS/Visualization/LoaderUtils","DS/VisuDataAccess/Ox4TreeTarget"],function(k,d,h,a,f,m,q,b,e,l,g,j,c,p){var n=function(s){var r=document.getElementsByTagName("script");for(var u=0;u<r.length;u++){var t=r.item(u);var v=t.getAttribute("src");if(v&&v.match(s)){return v.substring(0,v.lastIndexOf("/")+1)}}return"scripts/ThreeDS/Visualization/"};var i="scripts/ThreeDS/Visualization/";var o=function(K,z,F,t){var y=K;var G=(typeof F=="undefined")?false:F;var ab=(z!==undefined)?z:null;var ac=null;var ae=null;var Y=null;var v;var E=null;var r=false;var A=0;var W=0;var O=0;var Z=[];var B=[];var X=[];var x=[];var Q=[];var V=[];var ag=[];var U=[];var T={};var I;var N=null;var C=[];var M;var u=null;var ad=t;this.setGeometryMode=function(ai){ad=ai};function L(){if(E!=null){E.terminate();E=null;r=false}ac=null;ae=null;Y=null;v="";A=0;W=0;O=0;Z=[];B=[];X=[];x=[];Q=[];V=[];ag=[];U=[];I="";N=null;C=[];M=null;u=null;T={}}this.load=function(am,ao,ak,aj,an,aq){T=aq?aq:{};u={value:false};ac=ao;Y=ak;ae=function(){L();if(aj){aj()}};console.log("Ox4 Version V");console.log("Ox4 ObjectDisplaySpecification");console.log(am.physicalid);console.log(am.dtype);var ai=function(ar){if(ar==="Node"){var at=new f();at.isPLMInstance=p.isPLMInstance;at.isPLMReference=p.isPLMReference;at.isPLMRepReference=p.isPLMRepReference;return at}if(ar==="Matrix"){return new k.Matrix4()}};if(am.dtype==null){am.dtype="VPMReference"}var al=am.dtype;var ap=null;g.InitWithUrl(am.serverurl,am.tenant,am.requiredAuth,am.proxyurl);P(al,function(au){if(au){ap=new b(am,ai)}else{if(H(al)){ap=new e(am,ai)}else{an({type:"LOAD",url:"type "+al})}}if(ap==null){return}var at=null;var ar=an;var av=u;var aw=function(ay){if(!av.value){console.log("success........");M=ay.rootNode;var ax=ay.geometryNodes;O=ax.length;A=O;W=O;for(var aA=0;aA<ax.length;aA++){var az=ax[aA].ticketRequest.generateRequest();B[az.data]=ax[aA];x.push(az)}if(!window.hasOwnProperty("ODTNoFCSCalls")||!window.ODTNoFCSCalls){S(av)}else{if(ac){ac(M)}if(ae){ae()}}console.log("Ox4 Plan runned")}};ap.run(at,aw,ar)})};this.abort=function(){if(u!==null){u.value=true;L()}};function P(ai,aj){g.IsBusA(ai,"VPMReference",function(ak){if(!ak){g.IsBusA(ai,"VPMRepReference",aj)}else{aj(true)}})}function H(ai){if(ai==="SW Assembly Family"){return true}if(ai==="SW Component Family"){return true}if(ai==="SW Assembly Instance"){return true}if(ai==="SW Component Instance"){return true}if(ai==="CATPart"){return true}if(ai==="CATProduct"){return true}if(g.IsBusA(ai,"MCAD Model")){console.log("Ox4MQLV6Loader: Either customized or other than considered DEC Type provided : "+ai);return true}return false}function w(ai){ad=ai}function S(an){if(E===null){var al=!h.matchUrl(d.getWebappsBaseUrl(),window.location)?"Passport":null;var aj={provider:"FILE",filename:"AmdLoader.js",serverurl:d.getWebappsBaseUrl()+"AmdLoader/",requiredAuth:al};var ap={provider:"FILE",filename:"ThreeJS_Base.js",serverurl:d.getWebappsBaseUrl()+"Mesh/",requiredAuth:al};var ak={provider:"FILE",filename:"Mesh.js",serverurl:d.getWebappsBaseUrl()+"Mesh/",requiredAuth:al};var ao={provider:"FILE",filename:"CGRFile.js",serverurl:d.getWebappsBaseUrl()+"Formats/",requiredAuth:al};var ai={provider:"FILE",filename:"CGRWorkerNewInfra.js",serverurl:d.getWebappsBaseUrl()+"Workers/",requiredAuth:al};var am=[aj,ap,ak,ao,ai];a.getWorkerFromSpecs(am,function(aq){if(an.value){aq.terminate()}else{E=aq;E.onmessage=function(au){var at=au.data;if(at.loaded){if(!r){r=true;J(an)}}else{var ar=B[at.node.data];A--;W--;if(ar){c.processData([ar],at,undefined,T.withSceneGraph,T)}if(Y!==null){Y({loaded:O-W,total:O})}if(ab!==null){ab({hack:true,updateInfinitePlane:true})}if(!W&&(ae!==null)){ae()}}}}})}else{if(r){J(an)}}}function af(ai,am,an,ao){if(ai.slice(0,8)=="posthttp"){var aj=ai.indexOf(":postparams:");var ap=ai.slice(9,aj);var ak=ai.slice(aj+12,ai.length);var aq={cors:true,timeout:100000,method:"POST",data:ak,type:"arraybuffer",async:true,headers:{Accept:"text/plain",},onComplete:am,onFailure:an};var al=j.authenticatedRequest(ap,aq)}}function J(am){A+=x.length;var an=new l();var ai=0;var al=function(){var ao=x[ai++];if(ao!==undefined){an.asyncTransformFCSUrlIntoRealUrl(ao,false,function(ap,aq){if(!am.value){if(ap!==""){(function(ar){af(aq,function(at){if(!am.value){E.postMessage({inputFile:at,node:ar,withSceneGraph:T.withSceneGraph?T.withSceneGraph:false},[at]);al()}})})(ap)}}})}};if(!window.hasOwnProperty("ODTNoFCSCalls")&&Y!==null){Y({loaded:0,total:x.length})}var ak=x.length>8?8:x.length;for(var aj=0;aj<ak;aj++){al()}if(ac){ac(M)}if(x.length===0){ae()}}function aa(ai,aj){if(ai.color==null||aj.color==null){return false}if((ai.color.r!=aj.color.r)||(ai.color.g!=aj.color.g)||(ai.color.b!=aj.color.b)){return false}if(ai.thickness&&aj.thickness&&(ai.thickness!=aj.thickness)){return false}if(ai.opacity!=aj.opacity){return false}return true}function R(am){var aj=ah(am);var al=[];for(var ak=0,ai=aj.length;ak<ai;ak++){al.push(parseFloat(aj[ak]))}return al}function ah(ai){return(ai.length>0)?D(ai).split(/\s+/):[]}function D(ai){return ai.replace(/^\s+/,"").replace(/\s+$/,"")}function s(ai){var al=new k.BufferGeometryDS();var am=new Float32Array(72);var at=new Float32Array(72);var ak=new Uint16Array(36);var ay=0;var aw=0;var av=0;for(var az=0;az<6;az++){ak[aw++]=av;ak[aw++]=av+1;ak[aw++]=av+2;ak[aw++]=av;ak[aw++]=av+2;ak[aw++]=av+3;av+=4}for(var ap=0;ap<12;ap+=3){at[ay+ap]=0;at[ay+ap+1]=-1;at[ay+ap+2]=0}am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];for(var ap=0;ap<12;ap+=3){at[ay+ap]=0;at[ay+ap+1]=1;at[ay+ap+2]=0}am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];for(var ap=0;ap<12;ap+=3){at[ay+ap]=0;at[ay+ap+1]=0;at[ay+ap+2]=1}am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];for(var ap=0;ap<12;ap+=3){at[ay+ap]=0;at[ay+ap+1]=0;at[ay+ap+2]=-1}am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];for(var ap=0;ap<12;ap+=3){at[ay+ap]=1;at[ay+ap+1]=0;at[ay+ap+2]=0}am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];am[ay++]=ai.max[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.max[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];for(var ap=0;ap<12;ap+=3){at[ay+ap]=-1;at[ay+ap+1]=0;at[ay+ap+2]=0}am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.max[2];am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.max[2];am[ay++]=ai.min[0];am[ay++]=ai.max[1];am[ay++]=ai.min[2];am[ay++]=ai.min[0];am[ay++]=ai.min[1];am[ay++]=ai.min[2];var ao=new q();var an=ao.getMaterialFromGAS({color:new k.Color(16729156),opacity:0.2});al.drawingGroups=[];al.drawingGroups.push({start:0,count:36,glType:y.TRIANGLES,gas:an});var au=new k.Vector3(ai.min[0],ai.min[1],ai.min[2]);var ax=new k.Vector3(ai.max[0],ai.max[1],ai.max[2]);var aj=ax.clone().sub(au).multiplyScalar(0.5).length();var aA=ax.clone().add(au).multiplyScalar(0.5);al.boundingSphere=new k.Sphere(aA,aj);al.boundingBox=new k.Box3(au,ax);al.vertexPositionArray=am;al.vertexNormalArray=at;al.vertexIndexArray=ak;var aq=new k.Mesh(al,an);aq.matrixAutoUpdate=false;var ar=new m(aq,"BBox");if(!G){ar.setVisibility(false)}return ar}};return o});