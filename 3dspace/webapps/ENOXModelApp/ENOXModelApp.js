define("DS/ENOXModelApp/RuleDefinition/RuleExpressionPresenter",["DS/CfgLanguageInformationComponent/Model/CfgLanguageInformationModelXModel","DS/CfgRuleExpressionComponent/Presenter/CfgRuleExpressionPresenter","DS/CoreEvents/ModelEvents","DS/CfgVCSComponent/Presenter/CfgVCSMainContainer","DS/CfgDictionary/CfgDictionaryV3Utils","DS/UIKIT/Mask","DS/ResizeSensor/js/ResizeSensor","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/UIKIT/SuperModal","i18n!DS/ENOXModelApp/assets/nls/RuleDefinition/RuleExpressionPresenter","css!DS/ENOXModelApp/RuleDefinition/RuleExpressionPresenter.css"],function(l,d,f,n,j,i,c,g,m,b,e,k){var h=true;var a=function(q,p,o){this._privateChannel=o.privateChannel||new f();this._applicationChannel=p;this._ruleId=q.ruleId;this._model=q;this._model.languageInformation=l;this._ruleName=o.ruleName?o.ruleName:e._Rule;this._model.fullDictionary=j.getSubDictionary(this._model.dictionaryJSON,j.WITH_REFERENCES_ONLY);this._editable=(o.editable===false)?false:true;this._workaroundCheckAndWakeUpResizeSensor=o.resizeSensorEnablerFun?o.resizeSensorEnablerFun:function(){};this._cfgRuleExpressionPresenter=new d(this._model,{localModelEvents:this._privateChannel,ruleName:this._ruleName,editable:this._editable});this._initPlusAction();this._initDom();this._subscribeToEvents();this._initVCS();this._toggleSelectionOfPlus(false)};a.prototype._subscribeToEvents=function(){var o=this;this._listSubscription=[];this._privateChannelSubTokens=[];this._privateChannelSubTokens.push(this._privateChannel.subscribe({event:"onSave"},function(s){var r=false;i.mask(o._container);var p={id:o._ruleId,modelId:o._model.modelId,ruleDefinition:{type:"expression",definition:s},attributes:{}};var q=function(t){if(t===true){m.updateRuleVersion(p).then(function v(){if(h){console.log("Rule saved..")}o._privateChannel.publish({event:"onDone",data:true});i.unmask(o._container)},function u(){if(h){console.log("Rule save failed..")}o._privateChannel.publish({event:"onFailSave",data:false});i.unmask(o._container);g.showError(e._error_expression_rule_save+" "+o._ruleName)})}else{o._privateChannel.publish({event:"onFailSave",data:false});i.unmask(o._container)}};if(h){console.log("saving the rule")}q(true)}));this._privateChannelSubTokens.push(this._privateChannel.subscribe({event:"triptych-hide-panel-if-opened-from-rule"},function(){if(o._isRightPanelOpenFromPlus){o._toggleSelectionOfPlus(false)}}));this._listSubscription.push(this._applicationChannel.subscribe({event:"triptych-panel-hidden"},function(p){if(p==="right"){o._toggleSelectionOfPlus(false)}}));this._listSubscription.push(this._applicationChannel.subscribe({event:"information-panel-open"},function(){o._toggleSelectionOfPlus(false)}))};a.prototype.destroy=function(){var p=0;var o=this._listSubscription.length;for(p=0;p<o;p++){this._applicationChannel.unsubscribe(this._listSubscription[p])}for(var p=0;p<this._privateChannelSubTokens.length;p++){this._privateChannel.unsubscribe(this._privateChannelSubTokens[p])}};a.prototype._initPlusAction=function(){var o=this;var p={icon:"fonticon fonticon-chevron-left custom-plus",selected:false,handler:function(q){if(o._isRightPanelOpenFromPlus){o._toggleSelectionOfPlus(false);o._applicationChannel.publish({event:"triptych-hide-panel",data:null})}else{o._applicationChannel.publish({event:"information-panel-hidden",data:"right"});o._toggleSelectionOfPlus(true);o._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}});o._applicationChannel.publish({event:"triptych-show-panel",data:"right"});o._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:o._criteriaSelector.container}});o._workaroundCheckAndWakeUpResizeSensor(o._criteriaSelector.container)}if(h){console.log("opening triptych right and putting the dico of MV in there")}}};this._cfgRuleExpressionPresenter.addToolBarAction(p)};a.prototype._initVCS=function(){this._criteriaSelector=new n({title:"<B>"+e.VARIABILITY_SECTION_TITLE+"</B>",dictionaryJSON:this._model.dictionaryJSON,getAllChildrenOnParentSelection:false,getParentOnChildSelection:false,itemActions:[{title:"Add",text:"add",fonticon:"plus",event:"onAddAction"}],contentFilter:function(p){var q=true;if(p.kind=="instance"){q=false}return q}});this._criteriaSelector.render();var o=this;this._criteriaSelector.subscribe("onAddAction",function(p){if(h){console.log('clicked on "+" against Right panel')}var q=null;if(p.item.attributes._type==="Variant"){if(p.item.kind==="instance"){q=p.item.idref}else{if(p.item.kind==="reference"){q=p.item.lid}}}else{if(p.item.attributes._type==="Variant Value"){q=p.item.rel_lid}else{if(p.item.attributes._type==="Variability Group"){q=p.item.lid}else{if(p.item.attributes._type==="Variability Option"){q=p.item.rel_lid}}}}if(q!=null&&q!=undefined){o._privateChannel.publish({event:"onPlus",data:{clickedId:q}})}})};a.prototype._initDom=function(){this._container=document.createElement("div");this._container.classList.add("xmodel-rule-expression-container");this._cfgRuleExpressionPresenter.inject(this._container);this._plusActionInDom=this._container.querySelector(".custom-plus")};a.prototype.inject=function(o){o.appendChild(this._container)};a.prototype._triggerResize=function(){this._cfgRuleExpressionPresenter._triggerResizeInit()};a.prototype._toggleSelectionOfPlus=function(o){this._plusActionInDom.classList.remove("fonticon-chevron-left");this._plusActionInDom.classList.remove("fonticon-chevron-right");if(o===true){this._isRightPanelOpenFromPlus=true;this._plusActionInDom.classList.add("selected");this._plusActionInDom.classList.add("fonticon-chevron-right");this._plusActionInDom.setAttribute("title",e._close_variability)}else{this._isRightPanelOpenFromPlus=false;this._plusActionInDom.classList.remove("selected");this._plusActionInDom.classList.add("fonticon-chevron-left");this._plusActionInDom.setAttribute("title",e._open_variability)}};a.prototype.attachResizeSensor=function(){var q=this;if(h){console.log("attaching ResizeSensor")}function p(s,u,r){var t;return function(){var y=this,x=arguments;var w=function(){t=null;if(!r){s.apply(y,x)}};var v=r&&!t;clearTimeout(t);t=setTimeout(w,u);if(v){s.apply(y,x)}}}var o=p(this._triggerResize.bind(this),250);this.resizeSensor=new c(this._container,function(){o()})};return a});define("DS/ENOXModelApp/PCDefinition/NewPCSummaryPresenterStaticContent",["DS/UIKIT/Popover","DS/UIKIT/Tooltip","i18n!DS/ENOXModelApp/assets/nls/PCDefinition/PCDefinition","css!DS/ENOXModelApp/PCDefinition/NewPCSummaryPresenterStaticContent.css","css!DS/UIKIT/UIKIT.css"],function(c,b,g,a,f){var d={};var e=function(j,i){var h=document.createElement("div");h.classList.add("pc-status-span-container");j.forEach(function(k,l){var m=document.createElement("span");if(l%2===1){m.classList.add("wux-ui-3ds");m.classList.add("wux-ui-3ds-1x");m.classList.add(k);m.classList.add("icon-container-setting")}else{m.classList.add("wux-ui-3ds");m.classList.add("wux-ui-3ds-1x");m.classList.add(k)}h.appendChild(m)});new b({target:h,body:i});return h};d.getContentForDEFAULT=function(){return e(["wux-ui-3ds-check","wux-ui-3ds-favorite-on"],g.STATUS_DEFAULT)};d.getContentForINCOMPATIBLE=function(){return e(["wux-ui-3ds-block"],g.STATUS_INCOMPATIBLE)};d.getContentForREQUIRED=function(){return e(["wux-ui-3ds-check","wux-ui-3ds-lock"],g.STATUS_REQUIRED)};d.getContentForDISMISSED=function(){return e(["wux-ui-3ds-user-delete"],g.STATUS_DISMISSED)};d.getContentForCHOSEN=function(){return e(["wux-ui-3ds-user-ok"],g.STATUS_CHOSEN)};d.getContentForSELECTED=function(){return e(["wux-ui-3ds-check"],g.STATUS_SELECTED)};d.getContentForUNSELECTED=function(){return e(["wux-ui-3ds-close"],g.STATUS_UNSELECTED)};return d});define("DS/ENOXModelApp/Utils/xModelPreferencesConstant",[],function(){var a={};a._KEY="xmodel-app";a._SMALL="small";a._MEDIUM="medium";a._LARGE="large";a._VIEWS_PREFERENCES="xmodel-views-preferences";a._MY_MODEL_VERSIONS="xmodel-my-model-versions";a._MODEL_VERSIONS="xmodel-model-versions";a._MODEL_VERSIONS_DETAILS="xmodel-model-versions-details";a._RULES="rules";a._PRODUCT_CONFIGURATIONS="product-configurations";a._ENTREPRISE_VARIANTS_OPTIONS="xmodel-entreprise-variants-options";a._PARAMETERS="parameters";a._VARIANTS="variants";a._OPTIONS="options";a._GROUP_OPTIONS="group-options";a._VARIANTS_DETAILS="variants-details";a._OPTION_GROUP_DETAILS="optiongroup-details";a._RULES_DETAILS="rules-details";a._PRODUCT_CONFIGURATIONS_DETAILS="product-configurations-details";a._LIST_VIEW="xmodel-list-view";a._VIEW="view";a._SORT="sort";a._GROUP="group";a._TAB="tab";a._SEARCH="search";a._ID_CARD="id-card";a._COLLAPSE="collapse";a._LAST_ROUTE="last-route";return a});define("DS/ENOXModelApp/ModelDefinition/js/DuplicateModelPresenter",["DS/UIKIT/Mask","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/UIKIT/SuperModal","DS/CoreEvents/ModelEvents","UWA/Class/View","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/DuplicateModelPresenter","css!DS/ENOXModelApp/ModelDefinition/css/DuplicateModel.css"],function(g,c,h,a,e,f,b,d){return{duplicateView:f.extend({className:"duplicate-model-presenter",setup:function(i){this.objectType="Model Version";this.parentName=i.name||"";this.prefix="";this.includeVariability=true;this.includeRule=true;this.includePC=true},render:function(){var j=this;this.prefixInput=new c({className:"xmodel-suffix",placeholder:"Copy of",type:"text",label:"Prefix",value:this.prefix,styles:{flex:1}});this.copyItems=[];this.copyItems.push(new h({type:"checkbox",name:"isCloneVariability",className:"primary",label:b._copyVariabilityLabel,checked:this.includeVariability,events:{onChange:function(k){console.log(j);if(k.target){var l=k.target.checked;[1,2].forEach(function(m){if(j.copyItems[m]){j.copyItems[m].setDisabled(!l);if(!l){j.copyItems[m].uncheck()}}})}}}}));this.copyItems.push(new h({type:"checkbox",name:"isCloneRules",className:"primary",label:b._copyRulesLabel,checked:this.includeRule}));this.copyItems.push(new h({type:"checkbox",name:"isCloneProductConfigurations",className:"primary",label:b._copyPCsLabel,checked:this.includePC}));this.copyItems.push(new h({type:"checkbox",name:"isCloneDocuments",className:"primary",label:b._copyDocsLabel,checked:this.includePC}));var i=UWA.createElement("div");UWA.createElement("label",{html:b._refModelTitle+this.parentName,}).inject(i);UWA.createElement("div",{html:b._prefixLabelInfo}).inject(i);UWA.createElement("div",{html:[{tag:"label",html:b._prefixLabel,styles:{alignSelf:"center"}},{tag:"div",html:this.prefixInput}],styles:{display:"flex"}}).inject(i);this.copyItems.forEach(function(k){k.inject(i)});this.container.setContent(i);return this._parent.apply(this,arguments)},getOptions:function(){var i={prefix:this.prefixInput.getValue()||"Copy of",isCloneVariability:true,isCloneRules:true,isCloneProductConfigurations:true,isCloneDocuments:false,};this.copyItems.forEach(function(j){i[j.getName()]=j.isChecked()});return i}}),show:function(j,l){var k=new a({renderTo:document.body});var i=new this.duplicateView(j);k.dialog({body:i.render(),title:b._panelTitle,buttons:[{className:"primary",value:b._okAction,action:function(n){n.hide();var m=i.getOptions();console.log(m);if(UWA.is(l,"function")){l(m)}}},{className:"default",value:b._cancelAction,action:function(m){m.hide()}}]})},}});define("DS/ENOXModelApp/Utils/xModelIDCardAttributeEditor",["DS/LifecycleCmd/MaturityCmd","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/ImageManager/ImageManager","DS/PlatformAPI/PlatformAPI"],function(d,a,c,b){var e=function(){};e.prototype.init=function(f,g){this._idCardModelEvents=f;this._maturityInEdit=false;this._initModelContextForLifeCycleCollabObj();this._subscribeToEvents()};e.prototype._initModelContextForLifeCycleCollabObj=function(){this._modelContextForLifeCycleCollabCmds={_selectedItems:[],_isMultiSelectMode:false,name:"pad_component",initialize:function(f){},init:function(f){this._parent(f)},getContext:function(){return this},author:function(f){return true},getSelectedNodes:function(){return this._selectedItems},resetSelection:function(){this._selectedItems=[]},addSelection:function(f,h){(true)?this._selectedItems=[]:null;var g=this;if(UWA.is(f,"array")){f.forEach(function(i){g._selectedItems.push(i)})}else{g._selectedItems.push(f)}},getReference:function(f){return f.getID()},getParent:function(f){return f.getParent()},getType:function(f){return f.getType()},getName:function(f){return f.getLabel()}}};e.prototype.setModelAndInitCollabObj=function(f){this._modelForIdCard=f;this._setModelInLifeCycleAndCollabObject()};e.prototype._setModelInLifeCycleAndCollabObject=function(){var g=this;var f=UWA.extend(this._modelForIdCard,{getID:function(){return this.get("id")},getLabel:function(){return this.get("name")},getOwner:function(){return this.get("owner")},getType:function(){return this.get("type")},getDisplayName:function(){return this.get("name")},object:{revision:this._modelForIdCard.get("version")}});this._modelContextForLifeCycleCollabCmds.addSelection(f)};e.prototype._subscribeToEvents=function(){var f=this;b.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(i){var g=f._modelForIdCard.get("id");var h=i?(i.data?(i.data.authored?(i.data.authored.modified?i.data.authored.modified:[]):[]):[]):[];h.forEach(function(k,j){if(k&&g&&g===k){f._idCardModelEvents.publish({event:"idcard-model-refresh",data:k});console.log("OBJECT MODIFIED !!! ")}else{console.log("Model Id for ID card instance is different, so refresh is not for ID Card!!!")}})});this._idCardModelEvents.subscribe({event:"idcard-thumbnail-clicked"},function(){var g=new c({modelId:f._modelForIdCard._attributes.id,tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",events:{onPrimaryChange:function(h){f._idCardModelEvents.publish({event:"idcard-change-thumbnail",data:h.url})}}});g.execute()});this._idCardModelEvents.subscribe({event:"idcard-attributes-clicked"},function(i){console.log("attribute clicked..");if(UWA.is(i.index,"number")){var j=f._modelForIdCard.get("attributes")[i.index].command;if(j==="MATURITY"){console.log("attribute clicked..maturity");f.maturityCmd=new d({context:f._modelContextForLifeCycleCollabCmds,ID:"MaturityHdr"});f.maturityCmd.executeAsync({physicalid:f._modelForIdCard.id}).then(function h(){console.log("Maturity Updated!!!")},function g(){console.log("Maturity Update failed!!!")})}else{if(j==="OWNER"){console.log("attribute clicked..owner");f.changeOwnerCmd=new a({context:f._modelContextForLifeCycleCollabCmds,ID:"ActionBar_ChangeOwner"});f.changeOwnerCmd.begin()}}}})};return e});define("DS/ENOXModelApp/components/DialogDeletion/DialogDeletion",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Expander","DS/CoreEvents/ModelEvents","i18n!DS/ENOXModelApp/assets/nls/components/DialogDeletion/DialogDeletion"],function(b,e,d,a,g,f){var c=function(h){if(h){this._options=h;this._listItems=this._options.listItems;this._type=this._options.type?this._options.type.toLowerCase():f.TXT_DELETE;this._single=this._options.single?this._options.single:f.item;this._multiple=this._options.multiple?this._options.multiple:f.items;if(this._listItems){this._listId=this._listItems.map(function(i){return i.id})}this._immersiveFrame=this._options.immersiveFrame;this._modelEvent=this._options.modelEvent}this._init()};c.prototype._init=function(){this._mapValue(this._listItems,this._type,this._single,this._multiple)};c.prototype._mapValue=function(h,l,n,q){if(Array.isArray(h)){switch(l){case"delete":this._type=f.TXT_DELETE;break;case"destroy":this._type=f.destroy;break;case"remove":this._type=f.remove;break;default:this._type=f.TXT_DELETE}var m;var o;var j;switch(h.length){case 0:m=this._type+" "+n;this._createEmptyDialog(m,this._single.toLowerCase());break;case 1:m=this._type+" "+n;o=this._type.toLowerCase()+" "+h[0].title;this._createDialog(m,o,this._modelEvent);break;default:m=this._type+" "+q;o=this._type.toLowerCase()+" "+h.length+" "+q;var j=new UWA.Element("div",{"class":"wux-control-inline-container"});for(var k=0;k<h.length;k++){var p=new UWA.Element("div",{style:{"vertical-align":"top"},html:"<p>"+h[k].title+"</p>"});p.inject(j)}this._createDialog(m,o,this._modelEvent,j)}}else{console.log("Error option input DialogDeletion")}};c.prototype._createDialog=function(n,m,i,h){var l=this;var k=new UWA.Element("div",{"class":"wux-control-inline-container",style:{"vertical-align":"top"},html:"<p>"+f.templateSentence+m+" ?</p>"});if(h){var o=new a({header:"More information",body:h,allowUnsafeHTMLHeader:false});o.inject(k)}var j=new e({immersiveFrame:this._immersiveFrame,title:n,content:k,activeFlag:false,modalFlag:true,buttons:{Ok:new d({touchMode:true,allowUnsafeHTMLLabel:false,onClick:function(p){console.log("enox-dialog-delete");console.log(l._listId);if(Array.isArray(l._modelEvent)){l._modelEvent.forEach(function(q){q.publish({event:"enox-dialog-delete",data:l._listId,context:this})})}else{l._modelEvent.publish({event:"enox-dialog-delete",data:l._listId,context:this})}j.close()}}),Cancel:new d({touchMode:true,allowUnsafeHTMLLabel:false,onClick:function(p){j.close()}}),}})};c.prototype._createEmptyDialog=function(l,k){var j=this;var i=new UWA.Element("div",{"class":"wux-control-inline-container",style:{"vertical-align":"top"},html:"<p>"+f.no+" "+k+" "+f.selected+"</p>"});var h=new e({immersiveFrame:this._immersiveFrame,title:l,content:i,activeFlag:false,modalFlag:true,height:"500px",width:"500px",buttons:{Ok:new d({touchMode:true,allowUnsafeHTMLLabel:false,onClick:function(m){h.close()}})}})};return c});define("DS/ENOXModelApp/InformationPanels/CommonInfoPresenter",["UWA/Class/View","DS/ENOXTabs/js/ENOXTabs","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/CoreEvents/ModelEvents","DS/UIKIT/Mask","UWA/Element","css!DS/ENOXModelApp/InformationPanels/CommonInfoPresenter.css"],function(a,g,d,h,c,b,e,f,i){var j=a.extend({className:"model-info-presenter",init:function(k){this._localChannel=k&&k.modelEvents?k.modelEvents:new b();var l={multiselection:true,readOnly:false,editMode:true,context:"",displayType:h.STANDARD,typeOfDisplay:h.ALL,selectionType:h.RESTRICTED_SELECTION,extraNotif:false,facets:[h.FACET_PROPERTIES]};this.panelOptions=k.panelOptions||{};UWA.merge(this.panelOptions,l);this._parent()},render:function(){this.editPropertyPanel=new d(this.panelOptions);this.container.setContent(this.editPropertyPanel.getContent())},setModels:function(k){var l=this;var m=[];k.forEach(function(n){var o=new c({metatype:"businessobject",objectId:n,source:"3DSpace"});m.push(o)});this.editPropertyPanel.initDatas(m)},updateOptions:function(){}});return j});define("DS/ENOXModelApp/Utils/xModelAppGlobalConfig",[],function(){var a={};a.LEFT_PANEL_SIZE_EXPANDED=300;a.LEFT_PANEL_SIZE_COLLAPSED=40;a.MOBILE_BREAKPOINT=550;a.SOLVER_DEBUG_MODE=false;a.SOLVER_DEBUG_PATH="/home/data/solverlogs";a.SOLVER_DEBUG_LEVEL="messagesAndSolver";a.PATH_HOME="/home";a.PATH_LANDING_PAGE="LandingPage";a.PATH_DICTIONARY="EnterpriseDictionary";a.PATH_DICTIONARY_VARIANTS_OPTIONS="VariantsNOptions";a.PATH_DICTIONARY_VARIANT_DETAILS="VariantDetails";a.PATH_DICTIONARY_VARIANTVALUE_DETAILS="VariantValueDetails";a.PATH_DICTIONARY_OPTION_GROUP_DETAILS="OptionGroupDetails";a.PATH_MODEL_DEFINITION="ModelDefinition";a.PATH_MODELS="Models";a.PATH_MODEL_INFO="ModelInfo";a.PATH_MODEL_DETAILS="ModelDetails";a.PATH_MODEL_PC_DETAILS="PCDetails";a.PATH_MODEL_RULE_DETAILS="RuleDetails";a.PATH_MODEL_DOC_DETAILS="DOCDetails";a.ROUTE_HOME="home";a.ROUTE_LANDING_PAGE="home.LandingPage";a.ROUTE_DICTIONARY="home.EnterpriseDictionary";a.ROUTE_DICTIONARY_VARIANTS_OPTIONS="home.EnterpriseDictionary.VariantsNOptions";a.ROUTE_DICTIONARY_VARIANT_DETAILS="home.EnterpriseDictionary.VariantDetails";a.ROUTE_DICTIONARY_VARIANTVALUE_DETAILS="home.EnterpriseDictionary.VariantDetails.VariantValueDetails";a.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS="home.EnterpriseDictionary.OptionGroupDetails";a.ROUTE_MODEL_DEFINITION="home.ModelDefinition";a.ROUTE_MODELS="home.ModelDefinition.Models";a.ROUTE_MODEL_INFO="home.ModelDefinition.ModelInfo";a.ROUTE_MODEL_DETAILS="home.ModelDefinition.ModelInfo.ModelDetails";a.ROUTE_MODEL_PC_DETAILS="home.ModelDefinition.ModelInfo.PCDetails";a.ROUTE_MODEL_RULE_DETAILS="home.ModelDefinition.ModelInfo.RuleDetails";a.ROUTE_MODEL_DOC_DETAILS="home.ModelDefinition.ModelInfo.DOCDetails";a.WITH_OPTIM=false;a.WITH_GRAPH=false;a.WITH_3D=false;return a});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Form","DS/CoreEvents/ModelEvents","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreation"],function(c,f,e,a,g,d){var b=function(h){if(h){this._options=h;this._context=h.context?h.context:undefined;this._title=this._options.title;this._type=this._options.type?this._options.type:d.create;this._form=this._options.form;this._withMore=this._options.withMore?this._options.withMore:false;this._immersiveFrame=this._options.immersiveFrame;this._modelEvent=this._options.modelEvent}this._init()};b.prototype._init=function(){this._mapValue(this._type.toLowerCase());this._createDialog(this._title,this._type,this._form)};b.prototype._mapValue=function(h){switch(h){case"create":this._type=d.create;break;case"add":this._type=d.add;break;case"new":this._type=d.TXT_NEW;break;default:this._type=d.create}};b.prototype._createDialog=function(l,h,k){var j=this;this.formContent=new a(k);var i=new f({immersiveFrame:this._immersiveFrame,title:h+" "+l,content:this.formContent,activeFlag:false,modalFlag:true,buttons:{Ok:new e({touchMode:true,allowUnsafeHTMLLabel:false,onClick:function(m){if(j.formContent.validate()){if(Array.isArray(j._modelEvent)){j._modelEvent.forEach(function(n){n.publish({event:"enox-dialog-creation",data:{content:j.formContent.getValues(),context:j._context},context:this})})}else{j._modelEvent.publish({event:"enox-dialog-creation",data:{content:j.formContent.getValues(),context:j._context},context:this})}console.log("enox-dialog-creation");console.log("data : ");console.log(j.formContent.getValues())}i.close()}}),Cancel:new e({touchMode:true,allowUnsafeHTMLLabel:false,onClick:function(m){i.close()}}),}})};return b});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/CreateParameterPresenter",["DS/UIKIT/Mask","DS/UIKIT/SuperModal","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Toggle","DS/CoreEvents/ModelEvents","UWA/Class/View","DS/xDimensionManager/xUnitConverter","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","i18n!DS/xDimensionManager/assets/nls/xDimentions","i18n!DS/xDimensionManager/assets/nls/xUnitLabelLong","i18n!DS/xDimensionManager/assets/nls/xUnitLabelShort","i18n!DS/ENOXModelApp/assets/nls/EnterpriseVariabilityDictionary/CreateParameterPresenter","css!DS/ENOXModelApp/EnterpriseVariabilityDictionary/css/CreateParameterPresenter.css"],function(e,c,f,k,n,d,b,g,m,i,l,j,a,h){return{createView:b.extend({className:"create-parameter-presenter",intPattern:"[0-9]+",realPattern:"[0-9]+[.]?[0-9]*",domEvents:{},setup:function(p){this.createOptions={title:undefined,dimension:undefined,kind:"integer",minValue:undefined,minUnit:undefined,maxValue:undefined,maxUnit:undefined};this.dimensions=p.dimensions||{};this._dimensionList=[];for(var o in this.dimensions){if(this.dimensions.hasOwnProperty(o)){this._dimensionList.push({valueItem:o,labelItem:i.get(o)})}}this.xUnitConverterInstance=g.getInstance("PARAMETER_UNIT");this._errorMessage=""},render:function(){var s=this;this._titleInput=new f({});var r=[{valueItem:"",labelItem:a._noDimensionLabel}].concat(this._dimensionList);this._dimensionInput=new k({elementsList:r,enableSearchFlag:false,});this._intKindInput=new n({type:"radio",name:"kind",label:a._integerKindLabel,value:"integer",checkFlag:true,allowUnsafeHTMLLabel:false});this._realKindInput=new n({type:"radio",name:"kind",label:a._realKindLable,value:"real",allowUnsafeHTMLLabel:false});this._minValueInput=new f({label:"Meter",sizeInCharNumber:10,autoCorrectFlag:true,pattern:this.intPattern});this._maxValueInput=new f({sizeInCharNumber:10,autoCorrectFlag:true,pattern:this.intPattern});var t=[{valueItem:"",labelItem:""}];this._minUnitInput=new k({placeholder:"",elementsList:t,enableSearchFlag:false,visibleFlag:false,className:"unit-input-select"});this._maxUnitInput=new k({placeholder:"",elementsList:[{valueItem:"",labelItem:""},{valueItem:"METER",labelItem:"Meter"},{valueItem:"CM",labelItem:"Centimeter"},{valueItem:"MM",labelItem:"Milimeter"}],enableSearchFlag:false,visibleFlag:false,});this._titleInput.addEventListener("change",function(x){var w=x.dsModel;s.createOptions.title=w.value});this._dimensionInput.addEventListener("change",function(z){var y=z.dsModel;s.createOptions.dimension=y.value;if(!y.value||y.value==""){s._minUnitInput.value="";s._maxUnitInput.value="";s._minUnitInput.elementsList=[];s._maxUnitInput.elementsList=[];s._minUnitInput.hide();s._maxUnitInput.hide();if(s._intKindInput.disabled){s._intKindInput.disabled=false}}else{s._minUnitInput.show();s._maxUnitInput.show();var x=[];if(s.dimensions.hasOwnProperty(y.value)){var w=s.dimensions[y.value];if(w){for(var A in w){if(w.hasOwnProperty(A)){x.push({valueItem:A,labelItem:l.get(A)})}}}}s._minUnitInput.elementsList=x;s._maxUnitInput.elementsList=x;s._realKindInput.checkFlag=true;s._minValueInput.pattern=s.realPattern;s._maxValueInput.pattern=s.realPattern;s._intKindInput.disabled=true}});this._intKindInput.addEventListener("change",function(x){var w=x.dsModel;if(w.checkFlag){s.createOptions.kind=w.value;s._minValueInput.pattern=s.intPattern;s._maxValueInput.pattern=s.intPattern;if(s._minValueInput.value&&!isNaN(s._minValueInput.value)){s._minValueInput.value=parseInt(s._minValueInput.value)}else{s._minValueInput.value=""}if(s._maxValueInput.value&&!isNaN(s._maxValueInput.value)){s._maxValueInput.value=parseInt(s._maxValueInput.value)}else{s._maxValueInput.value=""}}});this._realKindInput.addEventListener("change",function(x){var w=x.dsModel;if(w.checkFlag){s.createOptions.kind=w.value;s._minValueInput.pattern=s.realPattern;s._maxValueInput.pattern=s.realPattern;if(s._minValueInput.value&&!isNaN(s._minValueInput.value)){var y=s._minValueInput.value.toString();if(y.indexOf(".")==-1){var y=parseFloat(s._minValueInput.value).toFixed(1)}else{var y=parseFloat(s._minValueInput.value)}s._minValueInput.value=y}else{s._minValueInput.value=""}if(s._maxValueInput.value&&!isNaN(s._maxValueInput.value)){var z=s._maxValueInput.value.toString();if(z.indexOf(".")==-1){var z=parseFloat(s._maxValueInput.value).toFixed(1)}else{var z=parseFloat(s._maxValueInput.value)}s._maxValueInput.value=z}else{s._maxValueInput.value=""}}});this._minValueInput.addEventListener("change",function(x){var w=x.dsModel;s.createOptions.minValue=w.value});this._maxValueInput.addEventListener("change",function(x){var w=x.dsModel;s.createOptions.maxValue=w.value});this._minUnitInput.addEventListener("change",function(x){var w=x.dsModel;s.createOptions.minUnit=w.value});this._maxUnitInput.addEventListener("change",function(x){var w=x.dsModel;s.createOptions.maxUnit=w.value});var v=UWA.createElement("div",{"class":"unit-range",html:[{tag:"label","class":"unit-label",html:a._minValueLabel},this._minValueInput,{tag:"div","class":"unit-input",html:this._minUnitInput}]});var o=UWA.createElement("div",{"class":"unit-range",html:[{tag:"label","class":"unit-label",html:a._maxValueLabel},this._maxValueInput,{tag:"div","class":"unit-input",html:this._maxUnitInput}]});var p={title:{label:a._titleLabel,content:this._titleInput},dimension:{label:a._dimensionLabel,content:this._dimensionInput},kind:{label:a._kindLabel,content:{tag:"div","class":"kind-field",html:[this._intKindInput,this._realKindInput]}},range:{label:a._rangeLabel,content:[v,o]},};var q=UWA.createElement("div",{styles:{width:"100%"}});for(var u in p){if(p.hasOwnProperty(u)){UWA.createElement("div",{"class":"form-content",html:[UWA.createElement("label",{"class":"form-label",html:p[u].label,}),UWA.createElement("div",{"class":"form-input",html:p[u].content})]}).inject(q)}}this.container.setContent(q);return this._parent.apply(this,arguments)},getOptions:function(){var o=UWA.clone(this.createOptions);return o},validate:function(){this._errorMessage=a._mandatoryFieldError;if(!this.createOptions.title||this.createOptions.title==""){return UWA.Promise.reject()}if(!this.createOptions.minValue||this.createOptions.minValue==""){return UWA.Promise.reject()}if(!this.createOptions.maxValue||this.createOptions.maxValue==""){return UWA.Promise.reject()}if(!this.createOptions.kind){return UWA.Promise.reject()}if(this.createOptions.dimension){if(!this.createOptions.minUnit||this.createOptions.minUnit==""){return UWA.Promise.reject()}if(!this.createOptions.maxUnit||this.createOptions.maxUnit==""){return UWA.Promise.reject()}var p=this.xUnitConverterInstance.compare({unit:this.createOptions.minUnit,value:parseFloat(this.createOptions.minValue)},{unit:this.createOptions.maxUnit,value:parseFloat(this.createOptions.maxValue)});if(p>=0){this._errorMessage=a._incorrectRangeError;return UWA.Promise.reject()}}else{var p=parseFloat(this.createOptions.minValue)-parseFloat(this.createOptions.maxValue);if(p>=0){this._errorMessage=a._incorrectRangeError;return UWA.Promise.reject()}}this._errorMessage=undefined;var o=this;return this._isNameUnique(this.createOptions.title).then(function(){return UWA.Promise.resolve()},function(){o._errorMessage=a._uniqueNameError;return UWA.Promise.reject()})},_isNameUnique:function(o){return m.isNameUnique({type:"Variant Parameter",name:o}).then(function(p){if(p.status==true){return UWA.Promise.resolve()}else{return UWA.Promise.reject()}})},getMessage:function(){if(this._errorMessage){return this._errorMessage}}}),show:function(q,s,p){var r=new c({className:"create-parameter-modal",renderTo:document.body});var o=new this.createView(q);r.dialog({body:o.render(),title:a._panelTitle,buttons:[{className:"primary",value:a._okAction,action:function(u){var t=o.getOptions();e.mask(u.getFooter());o.validate().then(function(){u.hide();if(UWA.is(s,"function")){s(t)}},function(){if(UWA.is(p,"function")){e.unmask(u.getFooter());var v=o.getMessage();if(v){p({message:v},t)}}})}},{className:"default",value:a._cancelAction,action:function(t){t.hide()}}]});return r}}});define("DS/ENOXModelApp/Utils/xModelCommonUtils",["UWA/Class","UWA/Class/Model","DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common"],function(e,b,c,f){var a=function(){var g;if(typeof(Event)==="function"){g=new Event("scroll")}else{g=document.createEvent("Event");g.initEvent("scroll",true,true)}return g}();var d=e.singleton({getObjectFromDetails:function(l,p,j){var q;if(l&&UWA.is(l.member,"array")){var i=l.member["0"];var n=i.description;var h=i.id;var m=(i.image?i.image:i.thumbnail);var g=i.name;var t=i.title;var o=i.version;var r=i.type;var k=i.ruleType;var s={"@id":h,name:g,title:t,image:m,description:n,ruleType:k};if(p===undefined||p===true){s.version=o}if(j&&j===true){s.type=r}q=new c(s)}else{console.log("[xModelCommonUtils:getObjectFromDetails] Error: Atrribute information is not available in input object!")}console.log("[xModelCommonUtils:getObjectFromDetails] Returning: "+q);return q},getRuleObjectFromDetails:function(g){return this.getObjectFromDetails(g,false,true)},prepareIdCardData:function(k,i){this._modelEvent=i;var n=this;var r,j,q;if(k===undefined||k===null||k.member["0"]===undefined){console.log("[xModelCommonUtils:prepareIdCardData] Error!!! Incorrect/null data!!!");return}var o=k.member["0"];var l=o["@id"]?o["@id"]:(o.id?o.id:"");var g=[{name:f.OWNER,value:o.owner?o.owner:"",type:"type-hyperlink",displayWhenMinified:true,editable:true,command:"OWNER"},{name:f.MATURITY,value:o.state?o.state:"",type:"type-hyperlink",displayWhenMinified:true,editable:true,command:"MATURITY"},{name:f.TYPE,value:o.type?o.type:""},{name:f.CREATION_DATE,value:o.created?o.created:""},{name:f.MODIFICATION_DATE,value:o.modified?o.modified:"",displayWhenMinified:true}];var p=[{id:"information",text:f.INFORMATION,fonticon:"fonticon fonticon-info"},{id:"delete",text:f.DELETE,fonticon:"fonticon fonticon-trash "}];if(o.owner){p.push({id:"owner",text:f.CHANGE_OWNERSHIP,fonticon:"fonticon fonticon-user-change"})}if(o.state){p.push({id:"state",text:f.MATURITY,fonticon:"fonticon fonticon-promote"})}if(o.revision&&o.revision!="-"){p.push({id:"revision",text:f.REVISION_EXPLORER,fonticon:"fonticon fonticon-flow-tree-ordered"})}var h={items:p,events:{onClick:function(t,s){console.log("Publish idcard-dropdown-menu-action : "+s.id);n._modelEvent.publish({event:"idcard-dropdown-menu-action",data:s.id})}}};var m={id:l,withToggleMinifiedButton:true,withActionsButton:true,name:o.title,version:o.revision?o.revision!="-"?o.revision:"":"",thumbnail:o.image?o.image:"",modelEvents:i,dropdown:h,freezones:[o.description?o.description:""],attributes:g};return new b(m)},setModelEventForIdCard:function(g){this._modelEvent=g},workaroundCheckAndWakeUpResizeSensor:function(l){if(l){var i=l.getElementsByClassName("resize-sensor");if(i&&i.length>0){for(var h=0,g=i.length;h<g;h++){var j=i[h];var k=(j&&j.children&&j.children[0])?j.children[0].dispatchEvent(a):false}}}}});d.init();return d});define("DS/ENOXModelApp/ModelDefinition/js/VersionExplorerPresenter",["UWA/Class","DS/UIKIT/Dropdown","DS/CoreEvents/ModelEvents","DS/ApplicationFrame/ActionBar","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra","css!DS/ENOXModelApp/ModelDefinition/css/VersionExplorerPresenter.css"],function(c,b,g,h,d,a,e,f){return c.extend({init:function(i){this.target=i.target;this.renderTo=i.renderTo||document.body;this.id=i.id;this.name=i.name;this.dataModelType=i.dataModelType||a.DATA_MODEL_TYPES.MODEL_P;this.modelEvents=i.modelEvents||new g();this.initVersionExplorer()},initVersionExplorer:function(){var i=this;this._versionExplorerContainer=UWA.createElement("div",{styles:{height:"100%",width:"100%"}});this.versionExplorer=new d({versionGraphContainer:this._versionExplorerContainer,selectionMode:a.SELECTION_MODES.SINGLE_SELECT_ONLY|a.SELECTION_MODES.WITH_COMMANDS,autoUpdate:true,displayMode:a.DISPLAY_MODES.SUBWAY_VIEW,widget:widget});this.versionExplorer.setCheckVersionExternalFunction("ENOXVersionExplorerCreateNewRevision",function(j){return j.isLeaf()},false);this.versionExplorer.subscribeEvent("preENOXVersionExplorerCreateNewVersion",function(k){if(k&&k.isLeaf()){var j=k.getLabel();var l=k._getID();i.modelEvents.publish({event:"model-version-action-create-new-revision",data:{id:l,name:i.id===l?i.name:j,title:j}})}},true);this.versionExplorer.subscribeEvent("ENOXVersionExplorerNewVersionCreated",function(j){i.modelEvents.publish({event:"version-explorer-new-version-created",data:j.options})},false);this.versionExplorer.subscribeEvent("ENOXVersionExplorerOpenVersion",function(j){var l=j.data||j;var k=l.options.id;i.modelEvents.publish({event:"model-version-action-open",data:{id:k}});i.versionExplorer.hideDialog()});this.versionExplorer.subscribeEvent("ENOXVersionExplorerLoadCompleted",function(j){i.versionExplorer.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:i.id})});this.modelEvents.subscribe({event:"refresh-version-explorer-on-create-revision"},function(j){i.versionExplorer.publishEvent("ENOXVersionExplorerRefresh");console.log("Version Explorer Refreshed!!!!")})},showVersionExplorer:function(l){var k=this;if(!l){l=this.id}var i=true;if(i){var k=this;var j={};j.displayMode=a.DISPLAY_MODES.SUBWAY_VIEW;e.loadUserSettingsPromise(j).then(function(){k.versionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:l,tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",type:"Products",securityContext:f._securityContext,dataModelType:a.DATA_MODEL_TYPES.MODEL_ER})});this.versionExplorer.showDialog(undefined,widget.body,true)}},})});define("DS/ENOXModelApp/xModelApp/xParameter",["DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xDimensionManager/xUnitConverter"],function(b,a){var d="PARAMETER_UNIT";var c={_dimensions:{},initialize:function(){var f=this;var e={name:d,units:{}};b.getAllDimension().then(function(h){for(var g in h){if(h.hasOwnProperty(g)){f._dimensions[g]={};h[g].forEach(function(i){var j=i.multiplier;if(UWA.is(j,"string")){j=parseFloat(j)}f._dimensions[g][i.name]=j;e.units[i.name]=j})}}a.initialize(e)},function(){console.log("unable to load dimensions..")})},getDimensions:function(){return this._dimensions}};return c});define("DS/ENOXModelApp/Utils/xModelAppGlobalVariable",["UWA/Class","DS/Windows/ImmersiveFrame","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common"],function(d,c,b){var e;var a=d.singleton({getImmersiveFrame:function(){return e},createImmersiveFrame:function(){if(e){console.log("[xModelAppGlobalVariable:createImmersiveFrame] Info: Destroying old Immersive Frame and creating a new one!!!");if(UWA.is(e.destroy,"function")){e.destroy();e=undefined}}e=new c({})},getCreateModelForm:function(){var f={fields:[{type:"text",label:b.TITLE,placeholder:b.TITLE,name:"title"}]};return f}});return a});define("DS/ENOXModelApp/RuleDefinition/RulePresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/CfgSolver/CfgSolverServices","DS/ConfiguratorPanel/scripts/ConfiguratorSolverFunctions","DS/CfgRuleMatrixComponent/GlobalPresenter/GlobalPresenter","DS/CfgRuleMatrixComponent/Utils/MatruiTablePersistanceUtils","DS/ENOXModelApp/RuleDefinition/RuleExpressionPresenter","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/xModelEventManager/xModelEventManager","i18n!DS/ENOXModelApp/assets/nls/RuleDefinition/RulePresenter","css!DS/ENOXModelApp/RuleDefinition/RulePresenter.css"],function(g,d,j,k,o,n,i,p,b,a,c,f,h,l){var e=function(w){if(w){var s=w.getElementsByClassName("resize-sensor");if(s&&s.length>0){var v;if(typeof(Event)==="function"){v=new Event("scroll")}else{v=document.createEvent("Event");v.initEvent("scroll",true,true)}for(var r=0,q=s.length;r<q;r++){var t=s[r];var u=(t&&t.children&&t.children[0])?t.children[0].dispatchEvent(v):false}}}};var m=function(){};m.prototype.init=function(s,u,r,t,q){this._options=q||{};this._ruleId=t;this._solverKey=q.solverKey?q.solverKey:null;this._context=s;this._contextDictionary=q.contextDictionary?q.contextDictionary:null;this._variabilityDictionary=q.dictionary;this._privateChannel=u;this._applicationChannel=r;this._isEditable=q.editable;this._ruleName=null;if(!this._options.solverModelEvent){this._options.solverModelEvent=new d()}this._privateChannelForExpRule=new d();this._myEventManager=new f(this._applicationChannel,this._privateChannel,this._privateChannelForExpRule);this._subscribeToEvents();this._initDivs();this._beforeLoadData()};m.prototype.clear=function(){if(this._container){this._container.innerHTML=""}if(this._myEventManager){this._myEventManager.cleanup("RulePresenter");this._myEventManager=null}if(this._mGlobalPresenter){this._mGlobalPresenter.destroy();this._mGlobalPresenter=null}if(this._RuleExpressionPresenter){this._RuleExpressionPresenter.destroy();this._RuleExpressionPresenter=null}};m.prototype._beforeLoadData=function(){var r=this;g.mask(this._container);this._fetchAndLoadContextData();var s=function(t){r._rule=t.configurationRule;r._ruleName=r._rule.name;r._ruleType=r._rule.attributes.ExpressionType;r._layoutData=r._rule.attributes["Layout Data"]?r._rule.attributes["Layout Data"]:"";r._isEditable=t.configurationRule.isModifiable==="FALSE"?false:true;r.loadData()};var q=function(t){console.log(t)};o.getRuleDefinition({id:this._ruleId,contextId:this._context.modelId}).then(s,q);g.unmask(this._container)};m.prototype._fetchAndLoadContextData=function(){if(this._contextDictionary){return 0}else{this._contextDictionary={_version:"3.0",portfolioClasses:{totalItems:1,member:[{id:"a random ID for now, representing the enterprise or the future PLE",attributes:{_type:{name:"Models",value:"Models"}},portfolioComponents:{totalItems:1,member:[{id:"model1_id",pid:"model1_pid",lid:"model1_lid",attributes:{_name:"My Super Model"},variabilityGroups:{totalItems:1,member:[{id:"VG pid",lid:"VG lid",isInherited:false,attributes:{_sequenceNumber:1,_name:"VG1 Name",_description:"a cool description for a var group"},options:{totalItems:2,member:[{kind:"reference",id:"pid O1",rel_id:"pid VG1/O1",rel_lid:"lid VG1/O1",isInherited:false,attributes:{_name:"Option1 Name"}},{kind:"instance",id:"<pidMV1|pid VG1/O",idref:"pid O1",isInherited:false,attributes:{_name:"Option1 Name [rewritten on Instance]"}}]}}]},variants:{totalItems:2,member:[{kind:"instance",isInherited:false,idref:"pid V1",id:"pid MV1/V1",attributes:{_name:"V1 name [inst]",_type:"Variant",_image:"",_description:"",_mandatory:true,_sequenceNumber:13},values:{totalItems:2,member:[{isInherited:false,constraint:"available",id:"<pid MV1|pid V1/Vv11>",idref:"pid Vv11",attributes:{_name:"Vv11 name",_type:"value",_image:"",_description:""}},{isInherited:false,constraint:"available",id:"<pid MV1|pid V1/Vv12>",idref:"pid Vv12",attributes:{_name:"Vv12 name",_type:"value",_image:"",_description:""}}]}},{kind:"reference",isInherited:false,id:"pid V1",lid:"lid V1",attributes:{_name:"V1 name",_type:"Variant",_image:"",_description:""},values:{totalItems:2,member:[{isInherited:false,constraint:"available",id:"pid Vv11",lid:"lid Vv11",rel_id:"pid V1/Vv11",rel_lid:"lid V1/Vv11",attributes:{_name:"Vv11 name",_type:"value",_image:"",_description:"",_default:false,_sequenceNumber:3}},{isInherited:false,constraint:"available",id:"pid Vv12",lid:"lid Vv12",rel_id:"pid V1/Vv12",rel_lid:"lid V1/Vv12",idref:"id_usb_value1_ref",attributes:{_name:"Vv12 name",_type:"value",_image:"",_description:"",_default:false,_sequenceNumber:71}}]}}]},rules:{totalItems:1,member:[{id:"rule_id",compiledExpression:"value of the compiled expression",attributes:{_name:"A Super Cool Rule Name",_type:"Matrix Rule",_description:"Reduce product complexity by defining target product baselines for the target markets",_originator:"VPLMAdminUser"}}]}}]}}]}}}};m.prototype.loadData=function(){var q=this;g.mask(this._container);if(this._ruleType.toUpperCase()==="EXPRESSION"||this._ruleType.toUpperCase()==="BOOLEAN"||this._ruleType.toUpperCase()==="EXPRESSION RULE"){this._contextDictionary=null;this._fetchAndLoadContextData();this._loadExpressionRule()}else{if(this._ruleType.toUpperCase()==="MATRIX"||this._ruleType.toUpperCase()==="MATRIX RULE"){this._loadMatrixRule()}else{console.warn("error loading rule "+q._ruleId)}}g.unmask(this._container)};m.prototype._loadExpressionRule=function(){var s=this;var r=this._layoutData!==""?JSON.parse(this._layoutData):null;var q={dictionaryJSON:this._variabilityDictionary,autoCompleteRuleModel:r,ruleId:this._ruleId,modelId:this._context.modelId,solverKey:this._solverKey,};var t={ruleName:this._ruleName,editable:this._isEditable,privateChannel:this._privateChannelForExpRule,resizeSensorEnablerFun:e};n.setRuleActivation(this._ruleId,"false",this._options.solverKey).then(function(u){s._RuleExpressionPresenter=new a(q,s._applicationChannel,t);s._RuleExpressionPresenter.inject(s._container);s._RuleExpressionPresenter._triggerResize();s._RuleExpressionPresenter.attachResizeSensor()},function(u){console.error("fail to de-activate current expression rule");s._RuleExpressionPresenter=new a(q,s._applicationChannel,t);s._RuleExpressionPresenter.inject(s._container);s._RuleExpressionPresenter._triggerResize();s._RuleExpressionPresenter.attachResizeSensor()})};m.prototype._loadMatrixRule=function(){g.mask(this._container);var q=this._layoutData!=""?JSON.parse(this._layoutData):null;var t=new d();this._mGlobalPresenter=new p();var r={solverKey:this._options.solverKey,solverModelEvent:this._options.solverModelEvent,contextDico:this._contextDictionary,editable:this._isEditable,resizeSensorEnablerFun:e};var s=this;n.setRuleActivation(this._ruleId,"false",this._options.solverKey).then(function(u){s._mGlobalPresenter.init(s._context,s._variabilityDictionary,q,s._applicationChannel,s._privateChannel,r);s._mGlobalPresenter.inject(s._container);s._mGlobalPresenter.attachResizeSensor();if(s._mGlobalPresenter._msgError!==""){s._mGlobalPresenter._privateChannel.publish({event:"set-notification-message",data:{className:"error",message:s._mGlobalPresenter._msgError}})}g.unmask(s._container)},function(u){console.error("Error!!! Failed to de-activate current Matrix rule")})};m.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("xmodel-rule-details")};m.prototype.inject=function(q){q.appendChild(this._container)};m.prototype._subscribeToEvents=function(){var q=this;this._myEventManager.subscribe(this._privateChannel,{event:"mr-onsave"},function(t){g.mask(q._container);console.log("saving MR from RulePresenter");if(t){var s={id:q._ruleId,modelId:q._context.modelId,attributes:{description:" "},ruleDefinition:{type:"table",definition:t}};o.updateRuleVersion(s).then(function u(){g.unmask(q._container);console.log("Rule saved..");c.showSuccess(h.UPDATE_RULE_SUCCESSFUL);q._privateChannel.publish({event:"update-json-model-on-mr-save",data:{}})},function r(){g.unmask(q._container);console.log("Rule save failed..");c.showError(h.UPDATE_RULE_FAILED)})}q._privateChannel.publish({event:"mr-onsavedone",data:{id:q._ruleId}})});this._myEventManager.subscribe(this._privateChannelForExpRule,{event:"onDone"},function(r){q._privateChannel.publish({event:"expr-rule-onsavedone",data:{id:q._ruleId}})});this._myEventManager.subscribe(this._privateChannel,{event:"triptych-hide-panel-if-opened-from-rule"},function(){var r=q._ruleType?q._ruleType.toUpperCase():"";if(r==="EXPRESSION"||r==="BOOLEAN"||r==="EXPRESSION RULE"){q._privateChannelForExpRule.publish({event:"triptych-hide-panel-if-opened-from-rule",data:{}})}})};return m});define("DS/ENOXModelApp/InformationPanels/InformationPanelManager",["DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/CoreEvents/ModelEvents","DS/UIKIT/Mask","UWA/Class"],function(e,c,d,a){var b=a.singleton({init:function(f){this.editMode=false;this._currInfoId="";this._currentSelectedId="";this._selectedObjectIds=[];this.selection={};this.tempInfoId="";this._readOnly=false;this.applicationChannelTokens=[];var g=this;if(!this._informationPanelPresenterForEdit){this._informationPanelPresenterForEdit=new e({panelOptions:{editMode:false,readOnly:false,events:{onPrimaryChange:function(h){g._applicationChannel.publish({event:"xmodel-list-data-item-need-refresh",data:h.id})}}}})}if(!this._infoPresenter){this._infoPresenter=new e({panelOptions:{editMode:this.editMode,readOnly:true}})}},initialize:function(f){if(this._applicationChannel!==f.applicationChannel){console.log("InfoManager: Different app channel!!");this.unSubscribeEvents();this._applicationChannel=null}if(!this._applicationChannel){this._applicationChannel=f.applicationChannel?f.applicationChannel:undefined;this.subscribeToEvents()}this._currInfoId=f.id;this.editMode=f.editMode||false;this._selectedObjectIds=f.selectedIds||[];this.context=f.context||"default";this.selection[this.context]=f.selectedIds||[];this.updateInfoPanel(f.readOnly)},showPropertyPanel:function(h){var f=this.selection[this.context]||[];var i=h||this._readOnly;if(this.tempInfoId||this._currInfoId||f.length>0){var g=this.tempInfoId?[this.tempInfoId]:f.length>0?f:[this._currInfoId];if(i){this._infoPresenter.render();this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:this._infoPresenter.getContent()}});this._infoPresenter.setModels(g)}else{this._informationPanelPresenterForEdit.render();this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:this._informationPanelPresenterForEdit.getContent()}});this._informationPanelPresenterForEdit.setModels(g)}this.tempInfoId=""}else{this.showNoInformationPanel()}},subscribeToEvents:function(){var f=this;this.applicationChannelTokens.push(this._applicationChannel.subscribe({event:"information-panel-open"},function(h,g){if(!h||h.silent!=true){f.showPropertyPanel()}}));this.applicationChannelTokens.push(this._applicationChannel.subscribe({event:"breadcrumb-reset"},function(){f.resetPropertyPanel()}))},unSubscribeEvents:function(){var f=this;if(this._applicationChannel){this.applicationChannelTokens.forEach(function(g){f._applicationChannel.unsubscribe(g)});this.applicationChannelTokens=[]}},resetPropertyPanel:function(){this._currInfoId="";this._currentSelectedId="";this._selectedObjectIds=[];this.selection={};this.tempInfoId="";this.showNoInformationPanel()},showNoInformationPanel:function(){if(!this.noInfoPanel){this.noInfoPanel=UWA.createElement("div",{styles:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})}this.noInfoPanel.setContent("");d.mask(this.noInfoPanel);this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:this.noInfoPanel}});var f=this;setTimeout(function(){d.unmask(f.noInfoPanel);f.noInfoPanel.setContent("No Information Available")},500)},setSelectedItemId:function(f){this._currentSelectedId=f},showInformation:function(g,h){var f=this;this.tempInfoId=g;this._applicationChannel.publish({event:"information-panel-open",data:{silent:true}});this._applicationChannel.publish({event:"triptych-fetch-panel-visibility-status",data:function(i){if(i&&i.right==true){if(h){f.showPropertyPanel(true)}else{f.showPropertyPanel(false)}}}})},editInformation:function(i,h){this._applicationChannel.publish({event:"information-panel-open",data:{silent:true}});if(h){this.context=h}var f=this.selection[this.context]||[];var g=f.indexOf(i);if(g!=-1){f.splice(g,1)}f.push(i);this.selection[this.context]=f;this._informationPanelPresenterForEdit.render();this._informationPanelPresenterForEdit.setModels([i]);this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:this._informationPanelPresenterForEdit.getContent()}})},addSelection:function(i,h,j){if(h){this.context=h}var f=this.selection[this.context]||[];if(f.length===1&&i===f[0]){return}var g=f.indexOf(i);if(g!=-1){f.splice(g,1)}f.push(i);this.selection[this.context]=f;this.updateInfoPanel(j)},removeSelection:function(i,h){if(h){this.context=h}var f=this.selection[this.context]||[];var g=f.indexOf(i);if(g!=-1){f.splice(g,1);this.selection[this.context]=f;this.updateInfoPanel(this._readOnly)}},removeAllSelection:function(f){if(f){this.context=f}this.selection[this.context]=[];this.updateInfoPanel()},setContext:function(g,f){if(!this.selection[g]){this.selection[g]=[]}if(f){if(f.id){this._currInfoId=f.id}if(f.selectedIds&&UWA.is(f.selectedIds,"array")){this.selection[g]=f.selectedIds}}this.context=g;this.updateInfoPanel()},updateInfoPanel:function(g){var f=this;this._readOnly=g||false;this._applicationChannel.publish({event:"triptych-fetch-panel-visibility-status",data:function(h){if(h&&h.right==true){f.showPropertyPanel(g)}}})}});b.init();return b});define("DS/ENOXModelApp/Utils/xModelCommand",["DS/CoreEvents/ModelEvents","DS/xModelEventManager/xModelEventManager","DS/LifecycleCmd/MaturityCmd","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/ENOXModelApp/ModelDefinition/js/VersionExplorerPresenter"],function(c,f,b,a,d){var e=function(h,g){if(h){this._modelEvent=h;this._maturityCmd=undefined;this._ownerCmd=undefined;this._myEventManager=new f(this._modelEvent)}else{throw new Error("xModelCommand did not received Model Event Object!!")}if(g){this._container=g}this._subscribeToEvents()};e.prototype._subscribeToEvents=function(){var g=this;if(this._modelEvent){this._myEventManager.subscribe(this._modelEvent,{event:"xmodel-execute-command"},function(h){if(h){var i=h.model;var j=h.linkId?h.linkId:undefined;switch(j){case"state":g._handleMaurityCommand(i);break;case"maturity":g._handleMaurityCommand(i);break;case"owner":g._handleChangeOwnerCommand(i);break;case"revision":g._handelRevisionCommand(i);break;default:console.log("Wrong Command: "+j)}}})}};e.prototype._handleMaurityCommand=function(g){if(g){this._maturityCmd=new b({context:g,ID:"MaturityHdr"});this._maturityCmd.executeAsync({physicalid:g["@id"]||g.id,})}else{console.log("_handleMaurityCommand : Invalid model...")}};e.prototype._handleChangeOwnerCommand=function(g){if(g){g=UWA.extend(g,{getID:function(){if(g.id){g["@id"]=g.id}return g["@id"]},getLabel:function(){return g.name},getOwner:function(){return g.owner},getType:function(){return g.type},getDisplayName:function(){return g.name},getSelectedNodes:function(){return[this]},object:{revision:g.version}});if(!g.grid){g.grid=""}this._ownerCmd=new a({context:g,ID:"ActionBar_ChangeOwner"});this._ownerCmd.begin()}else{console.log("_handelChangeOwner : Invalid model...")}};e.prototype._handelRevisionCommand=function(g){if(g){this.versionExplorer=new d({id:g["@id"]||g.id,renderTo:this._container,modelEvents:this._modelEvent});this.versionExplorer.showVersionExplorer()}else{console.log("xModelCommand Version Explorer : Invalid model...")}};e.prototype._destroy=function(){if(this._myEventManager){this._myEventManager.cleanup("xModelCommand");this._myEventManager=null}};return e});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_VariantValue",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationVariantValue"],function(d,c,a){var b=d.singleton({createDialogCreationVariantValue:function(i,h,g){var f={fields:[{type:"text",label:a.TITLE,placeholder:a.TITLE,name:"title"}]};var e={title:a.VARIANT_VALUE,type:"new",context:g,modelEvent:h,form:f,immersiveFrame:i};return new c(e)}});return b});define("DS/ENOXModelApp/components/WelcomePanel/WelcomePanelWrapper",["DS/ENOXWelcomePanel/js/ENOXWelcomePanel","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/xPflRouter5/xPflRouter","i18n!DS/ENOXModelApp/assets/nls/components/WelcomePanel/WelcomePanel"],function(c,d,b,e){var a=function(){};a.prototype.init=function(h,g,k){this._applicationChannel=h;var j=[{id:"activities",title:e.activities,actions:[{id:"home",text:e._home,fonticon:"home",className:"action-new"},{id:d.PATH_MODELS,text:e.model_definition,fonticon:"3d-object",className:"action-new"},{id:d.PATH_DICTIONARY,text:e.enterprise_variability_dictionary,fonticon:"book-open",className:"action-new"}]}];var f={collapsed:false,title:"xModel",notifications:[],activities:j,parentContainer:k,modelEvents:h};var i=new c(f);i.render();this._subscribeToEvents()};a.prototype._subscribeToEvents=function(){var f=this;this._applicationChannel.subscribe({event:"welcome-panel-action-selected"},function(g){if(g&&g.id==="home"){b.navigate(d.ROUTE_LANDING_PAGE)}else{if(g&&g.id===d.PATH_DICTIONARY){b.navigate(d.ROUTE_DICTIONARY_VARIANTS_OPTIONS)}else{if(g&&g.id===d.PATH_MODELS){b.navigate(d.ROUTE_MODELS,{data:"from welcomepanel"})}else{}}}})};return a});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_Option",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationOption"],function(c,a,b){var d=c.singleton({createDialogCreationOption:function(i,h,g){var f={fields:[{type:"text",label:b.TITLE,placeholder:b.TITLE,name:"title"}]};var e={title:b.OPTION,type:"new",context:g,modelEvent:h,form:f,immersiveFrame:i};return new a(e)}});return d});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_ModelVersion",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationModelVersion"],function(d,b,a){var c=d.singleton({createDialogCreationModelVersion:function(h,g){var f={fields:[{type:"text",label:a.TITLE,placeholder:a.TITLE,name:"title"}]};var e={title:a.MODEL,type:"new",modelEvent:g,form:f,immersiveFrame:h};return new b(e)}});return c});define("DS/ENOXModelApp/components/ApplicationTopBar/ApplicationTopBarWrapper",["DS/ENOXPageToolBar/js/PageToolBar","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXBreadcrumb/js/Breadcrumb","i18n!DS/ENOXModelApp/assets/nls/components/ApplicationTopBar/ApplicationTopBar"],function(b,e,c,a){var d=function(){};d.prototype.init=function(i,g,h){this.xModelRouter=g;this._applicationChannel=i;var l={withInformationButton:true,withWelcomePanelButton:true,modelEvents:this._applicationChannel,parentContainer:h};var k=new b(l);k.render().inject(h);var f=k.getBodyContent();var j=this;this._breadcrumb=new c({rootID:"home",rootText:a.home,rootIcon:"home",modelEvents:this._applicationChannel});this._breadcrumb.render().inject(f);this._subscribeToEvents()};d.prototype._subscribeToEvents=function(){var f=this;this._applicationChannel.subscribe({event:"welcome-panel-collapse"},function(){f._applicationChannel.publish({event:"triptych-set-size",data:{size:e.LEFT_PANEL_SIZE_COLLAPSED,side:"left"}});f._applicationChannel.publish({event:"triptych-show-panel",data:"left"})});this._applicationChannel.subscribe({event:"welcome-panel-expand"},function(){f._applicationChannel.publish({event:"triptych-set-size",data:{size:e.LEFT_PANEL_SIZE_EXPANDED,side:"left"}});f._applicationChannel.publish({event:"triptych-show-panel",data:"left"})});this._applicationChannel.subscribe({event:"information-panel-close"},function(){f._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})});this._applicationChannel.subscribe({event:"information-panel-open"},function(){f._applicationChannel.publish({event:"triptych-show-panel",data:"right"});f._applicationChannel.publish({event:"information-panel-visible",data:null})});this._applicationChannel.subscribe({event:"triptych-panel-hidden"},function(g){if(g==="right"){f._applicationChannel.publish({event:"information-panel-hidden",data:null})}});this._applicationChannel.subscribe({event:"breadcrumb-link-clicked"},function(k){var l=k.linkID.replace(/-/g,".");if(l==="home"){f.xModelRouter.navigate(e.ROUTE_LANDING_PAGE)}else{if(l===e.ROUTE_MODELS){f.xModelRouter.navigate(e.ROUTE_MODELS,{data:"from breadcrumb"})}else{if(l===e.ROUTE_DICTIONARY){f.xModelRouter.navigate(e.ROUTE_DICTIONARY)}else{var j=null;var h=0;for(h=0;h<f._breadcrumb.collection.length;h+=1){if(f._breadcrumb.collection.at(h).id===k.linkID){j=f._breadcrumb.collection.at(h).get("additionalData");break}}var g=false;if(g){console.log(j)}j?f.xModelRouter.navigate(l,j):f.xModelRouter.navigate(l)}}}})};return d});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_Variant",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationVariant"],function(d,c,b){var a=d.singleton({createDialogCreationVariant:function(h,g){var f={fields:[{type:"text",label:b.TITLE,placeholder:b.TITLE,name:"title"}]};var e={title:b.VARIANT,type:"new",modelEvent:g,form:f,immersiveFrame:h};return new c(e)}});return a});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_Rule",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationRule"],function(d,b,a){var c=d.singleton({createDialogCreationRule:function(i,h,g){var f={fields:[{type:"text",label:a.TITLE,placeholder:a.TITLE,name:"title"}]};var e={title:g==="table"?a.MATRIX_RULE:a.EXPRESSION_RULE,type:"new",modelEvent:h,form:f,immersiveFrame:i};return new b(e)}});return c});define("DS/ENOXModelApp/ModelDefinition/js/VariabilityPresenter",["UWA/Class/View","DS/UIKIT/Input/Button","DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","DS/CfgVCSComponent/Presenter/DgvCfgVCSMainContainer","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/TaggerOnIndexComponent/TaggerOnIndexComponent","DS/WildcardSearchComponent/WildcardSearchComponent","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/VariabilityPresenter","css!DS/ENOXModelApp/ModelDefinition/css/VariabilityPresenter.css"],function(a,h,f,d,o,n,g,l,k,j,m,c,b,i,e){return a.extend({_TaggerOnIndexComponent:k,className:"variability-presenter",init:function(p){this.tagFriends=p.tagFriends;this.WildcardSearch=new j();this.dictionaryJSON=p.dictionaryJSON?p.dictionaryJSON:{};this._applicationChannel=p.applicationChannel?p.applicationChannel:new d();this._localChannel=p.localChannel?p.localChannel:new d();this._isModelVariabilityEditable=(p&&p.editable!=undefined&&((typeof p.editable)==="boolean"))?p.editable:true;this.modelId=p.modelId;this._mEvtForTablePresententer=new d();this._mEvtForCriteriaPresententer=new d();g.initialize({applicationChannel:this._applicationChannel,id:this.modelId,context:"Variability",readonly:true});this._parent(p)},_initTagger:function(r){var q=this;var s=function(t){if(q.tablePresenter){q.tablePresenter.publishViewEvent("onContentFilterCriteriaChange",{filterData:{TaggerValues:t.filteredSubjectList},depth:1})}};var p={onTagFilterChange:s,MyFriends:q.tagFriends};q._TaggerOnIndexComponent.setTagProxy("VariabilityPresenter",p,r)},publishTags:function(){var q=this;var p=[];if(this.dictionaryJSON.portfolioClasses){this.dictionaryJSON.portfolioClasses.member.forEach(function(r){r.portfolioComponents.member.forEach(function(s){s.variabilityGroups.member.forEach(function(t){if(t.idref){p.push(t.idref)}else{if(t.id){p.push(t.id)}}});s.variants.member.forEach(function(t){if(t.idref){p.push(t.idref)}});if(s.parameters){s.parameters.member.forEach(function(t){if(t.idref){p.push(t.idref)}else{if(t.id){p.push(t.id)}}})}})})}q._initTagger(p)},clearTags:function(){this._TaggerOnIndexComponent.killTagProxy("VariabilityPresenter")},destroy:function(){this.clearTags()},setup:function(){this._parent.apply(this,arguments)},render:function(){var u=this;var p=[{title:"Information",text:e.information,fonticon:"info",event:"onInfoAction"}];if(this._isModelVariabilityEditable){p.push({title:"Remove",text:e.remove,fonticon:"trash",event:"onRemoveAction"})}this.tablePresenter=new o({modelEvents:this._mEvtForTablePresententer,identifier:"model_variability_presenter",dictionaryJSON:this.dictionaryJSON,kind:"instance",showSwitchViewAction:false,actions:[{id:"create",text:e.add,fonticon:"book-add",disabled:!this._isModelVariabilityEditable,handler:function(y,A){if(!A.isPanelVisible){A.isPanelVisible=false}if(!this.criteriaSelector){var x=UWA.createElement("div",{styles:{height:"inherit",width:"inherit"}});f.mask(x);u._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:x}});this.criteriaSelector=new o({identifier:"model_variability_vcs_presenter",title:"<B>"+e.ENTERPRISE_DICTIONARY+"</B>",parentContainer:u.container,dictionaryJSON:{_version:3},kind:"reference",actionView:this,showSwitchViewAction:true,itemActions:[{title:"Add",text:e.add,fonticon:"plus",event:"onAddAction"}]});this.criteriaSelector.render();var w=this.criteriaSelector;f.mask(w.container);n.getVariabilityDefinition({componentId:"",content:{attributes:3,parameters:(i.PARAMETERS_ENABLED!=undefined)?i.PARAMETERS_ENABLED:false,attributeList:["_image"]}}).then(function(B){console.log();w.loadDictionary(B);f.unmask(w.container)},function z(B){f.unmask(w.container);c.showError(e.ERROR_GET_ENT_VARIABILITY_DEFINTION)});this.criteriaSelector.subscribe("onAddAction",function(B){console.log("add action");u.addDictionaryCriteria(B)});u._applicationChannel.subscribe({event:"information-panel-open"},function(){A.isPanelVisible=false;A.elements.container.removeClassName("selected")})}var w=this.criteriaSelector;if(A.isPanelVisible){u._applicationChannel.publish({event:"triptych-hide-panel",data:"right"});A.isPanelVisible=false;A.elements.container.removeClassName("selected");return}else{u._applicationChannel.subscribeOnce({event:"triptych-panel-visible"},function(B){if(B==="right"){u._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:w.container}});b.workaroundCheckAndWakeUpResizeSensor(w.container)}});u._applicationChannel.publish({event:"triptych-show-panel",data:"right"});u._applicationChannel.subscribe({event:"triptych-hide-panel"},function(B){if(B==="right"){A.isPanelVisible=false;A.elements.container.removeClassName("selected")}});A.isPanelVisible=true;A.elements.container.addClassName("selected");u._applicationChannel.publish({event:"information-panel-hidden",data:null})}}}],itemActions:p,contentFilter:function(w){var x=true;if(w.kind=="reference"){x=false}return x}});this.tablePresenter.render();this._emptyContainer=UWA.createElement("div",{styles:{position:"absolute",top:"60px",width:"100%",height:"calc( 100% - 60px)"}});if(this.tablePresenter.getCount()>0){this._emptyContainer.addClassName("displaynone")}this._mEvtForTablePresententer.subscribe({event:"enox-collection-toolbar-items-count-update"},function(w){if(w==0){u._emptyContainer.removeClassName("displaynone")}else{u._emptyContainer.addClassName("displaynone")}});this._mEvtForTablePresententer.publish({event:"enox-collection-toolbar-disable-action",data:"delete"});this.tablePresenter.subscribe("onRemoveAction",function(w){console.log("remove action");u.removeDictionaryCriteria(w)});this.tablePresenter.subscribe("onInfoAction",function(w){console.log("information action");if(w.item){if(w.item.idref){u.showInformation(w.item.idref,true)}else{u.showInformation(w.item.id,true)}}});this.tablePresenter.subscribe("dgv-item-on-add-selection",function(w){if(w&&w.model){var x=w.model.idref?w.model.idref:(w.model.id?w.model.id:undefined);if(x){g.addSelection(x,undefined,true)}}});this.tablePresenter.subscribe("dgv-item-on-remove-selection",function(w){if(w&&w.model&&w.model){var x=w.model.idref?w.model.idref:(w.model.id?w.model.id:undefined);if(x){g.removeSelection(x)}}});this.tablePresenter.subscribe("dgv-item-on-empty-selection",function(w){g.removeAllSelection()});this.tablePresenter.subscribe("onChangeAttribute",function(y){var A;if(y.type=="variant"){A=y.changedObject.id}else{if(y.type=="variabilityGroup"){A=u.modelId+"@"+y.changedObject.id}else{A=y.changedObject.rel_id}}var x={id:A,parentId:u.modelId,attributes:{}};x.attributes[y.name]=y.value;console.log(x);n.updateVariabilityInstanceDetails(x).then(function z(){console.log("attribute updated");u._localChannel.publish({event:"model-version-variability-updated",data:{}})},function w(){console.log("attribute updatation failed");c.showError(e.ERROR_UPDATE_VAR_INSTANCE_ATTRIBUTES)})});var r=function(w){var y=[];for(var x=0;x<w.length;x++){y.push(w[x].id)}if(u.tablePresenter){u.tablePresenter.publishViewEvent("onContentFilterCriteriaChange",{filterData:{ContextSearchValues:y},depth:1})}u._TaggerOnIndexComponent.filterTags("VariabilityPresenter",y)};var t=function(w){var y=[];for(var x=0;x<w.length;x++){y.push(w[x].id)}if(u.tablePresenter){u.tablePresenter.publishViewEvent("onContentFilterCriteriaChange",{filterData:{GlobalSearchValues:y},depth:1})}u._TaggerOnIndexComponent.filterTags("VariabilityPresenter",y)};var v=function(x){var w=[];var y=function(z,C){var B={};B.id=C.idref?C.idref:C.id;for(var D in C.attributes){if(D=="_name"){B[D]=C.attributes[D]}}if(C.values&&C.values.member){var A=0;C.values.member.forEach(function(F){for(var E in F.attributes){if(E=="_name"){B[E+"_"+A]=F.attributes[E]}}A++})}z.push(B)};x.member.forEach(function(z){z.portfolioComponents.member.forEach(function(A){A.variabilityGroups.member.forEach(function(B){if(B.idref||B.id){y(w,B)}});A.variants.member.forEach(function(B){if(B.idref){y(w,B)}});if(A.parameters){A.parameters.member.forEach(function(B){if(B.idref||B.id){y(w,B)}})}})});return w};this._mEvtForTablePresententer.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(x){if(u.dictionaryJSON&&u.dictionaryJSON.portfolioClasses){var w=v(u.dictionaryJSON.portfolioClasses);if(w.length>0){u.WildcardSearch.search(x.searchValue[0],w,r)}}});this._applicationChannel.subscribe({event:"search-in-current-dashboard"},function(x){if(u.dictionaryJSON&&u.dictionaryJSON.portfolioClasses){var w=v(u.dictionaryJSON.portfolioClasses);if(w.length>0){u.WildcardSearch.search(x,w,t)}}});var s=UWA.createElement("div",{styles:{width:"100%",height:"100%",position:"relative"}});this.tablePresenter.inject(s);var q=new m({sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:e.EMPTY_CONTENT_MESSAGE}]});q.inject(this._emptyContainer);s.addContent(this._emptyContainer);this.container.setContent(s);this.container.setStyle("height","100%");f.mask(this.container);this._parent();setTimeout(function(){u.onRender()},100);return this},onRender:function(){this.initializeVariabilityView()},initializeVariabilityView:function(p){f.unmask(this.container);return this},showInformation:function(q,p){g.showInformation(q,p)},addDicoCriteriaRejectHandler:function(p){f.unmask(this.tablePresenter.container);console.log("Add Variability Criteria Failed: "+p);c.showError(e.ERROR_VARIABILITY_ALLOCATION);return UWA.Promise.reject()},remDicoCriteriaRejectHandler:function(p){f.unmask(this.tablePresenter.container);console.log("Remove Variability Criteria Failed: "+p);c.showError(e.ERROR_VARIABILITY_DEALLOCATION);return UWA.Promise.reject()},addDictionaryCriteria:function(r){var q=this;var p=function(y){if(y.type){if(y.type=="Variant"){var s={parentID:q.modelId,instances:[{referencedID:y.data.id,attributes:{name:"",description:"",constraint:"Must"},}]};return n.createVariantClassVariabilityInstances(s).then(function(z){if(UWA.is(z.member,"array")){var A=z.member;if(UWA.is(A,"array")&&A.length>0){q._localChannel.publish({event:"model-version-variability-updated",data:{}});return UWA.Promise.resolve(A[0])}}return UWA.Promise.reject()},function w(z){return q.addDicoCriteriaRejectHandler(z)})}else{if(y.type=="Value"){var u=[];if(UWA.is(y.data.items,"array")){y.data.items.forEach(function(z){u.push({referencedID:z.id,attributes:{name:"",description:"",constraint:"May"}})})}var t={parentID:q.modelId,instances:u};return n.createVariantVariabilityInstances(t).then(function(z){if(UWA.is(z.member,"array")){var A=z.member;if(UWA.is(A,"array")){q._localChannel.publish({event:"model-version-variability-updated",data:{}});return UWA.Promise.resolve(A)}else{return UWA.Promise.reject()}}},function w(z){return q.addDicoCriteriaRejectHandler(z)})}else{if(y.type=="Option"){var u=[];if(UWA.is(y.data.items,"array")){y.data.items.forEach(function(z){u.push({referencedID:z.id,attributes:{name:"",description:"",constraint:"May"}})})}var x={parentID:q.modelId,instances:u};return n.createOptionVariabilityInstances(x).then(function(z){if(UWA.is(z.member,"array")){var A=z.member;if(UWA.is(A,"array")&&A.length>0){q._localChannel.publish({event:"model-version-variability-updated",data:{}});return UWA.Promise.resolve(A)}}return UWA.Promise.reject()},function w(z){return q.addDicoCriteriaRejectHandler(z)})}else{if(y.type=="Parameter"){var v={parentID:q.modelId,instances:[{referencedID:y.data.id,attributes:{name:"",description:"",constraint:"May"},}]};console.log(v);return n.createParameterVariabilityInstances(v).then(function(z){q._localChannel.publish({event:"model-version-variability-updated",data:{}});return UWA.Promise.resolve(y.data.id)},function w(z){return q.addDicoCriteriaRejectHandler(z)})}}}}}};if(r&&r.item&&((r.item.options&&r.item.options.totalItems<=0)||(r.item.values&&r.item.values.totalItems<=0))){console.log("Error: Option Group without Options can not be added to model version variability!!");c.showError(e.ERROR_ALLOCATING_VARIABILITY_WITHOUT_CONTENTS);return}this.tablePresenter.addDictionaryCriteria(r,p)},removeDictionaryCriteria:function(r){var p=this;var q=function(u){if(u.type){if(UWA.is(u.data.items,"array")&&u.data.items.length>0){var v={parentId:p.modelId,instanceIds:u.data.items};var s=function(){p._localChannel.publish({event:"model-version-variability-updated",data:{}});return UWA.Promise.resolve(u.data.items)};if(u.type=="Variant"){return n.deleteVariantClassVariabilityInstances(v).then(s,function t(w){return p.remDicoCriteriaRejectHandler(w)})}else{if(u.type=="Value"){return n.deleteVariantVariabilityInstances(v).then(s,function t(w){return p.remDicoCriteriaRejectHandler(w)})}else{if(u.type=="Option"){return n.deleteOptionVariabilityInstances(v).then(s,function t(w){return p.remDicoCriteriaRejectHandler(w)})}else{if(u.type=="Parameter"){v={parentID:p.modelId,instances:u.data.items};return n.deleteParameterInstances(v).then(s,function t(w){return p.remDicoCriteriaRejectHandler(w)})}}}}}}};this.tablePresenter.removeDictionaryCriteria(r,q)}})});define("DS/ENOXModelApp/PCDefinition/NewPCSummaryPresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/Tree/TreeNodeModel","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/ENOXTabs/js/ENOXTabs","DS/ENOXModelApp/PCDefinition/NewPCSummaryPresenterStaticContent","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","i18n!DS/CfgVCSComponent/assets/nls/VariabilityCriteriaSelector","css!DS/ENOXModelApp/PCDefinition/NewPCSummary.css"],function(d,b,g,i,n,e,f,a,k,c,j,m){var l=["CHOSEN","DEFAULT","DISMISSED","SELECTED","UNSELECTED","REQUIRED","INCOMPATIBLE"];var h=function(){};h.prototype.init=function(q,p,o){this._privateChannel=q;this._applicationChannel=p;this._modelId=this._id=o.id;this._modeExpandAll=(o.expandAll&&(typeof(o.expandAll)==="boolean"||o.expandAll==="true"))?o.expandAll:false;this._modelVariabilityDico={};this._pcList=(o.pcList&&Array.isArray(option.pcList))?option.pcList.slice():[];this.options={_columns:[{text:"Variability",dataIndex:"tree",width:"auto",valueAttribute:"_name",type:"text"}]};this._currentlyLoadedPCs={};this._initDivs();this._initTabbedObject();this._initializeTreeListView()};h.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("pc-summary");this._contentDiv=UWA.createElement("div");this._contentDiv.classList.add("contentDiv");this._contentDiv.innerHTML="";this._container.appendChild(this._contentDiv)};h.prototype._initTabbedObject=function(){var p=this;var q={text:"Content",fonticon:"fonticon fonticon-attributes",content:function(r){r.appendChild(p._container)}};var o={text:"",fonticon:"",content:function(r){}};this._tabsOptions={withCloseButton:false,tabs:[q,o],modelEvents:p._privateChannel,lazyRendering:false,initialSelectedIndex:0};this._tabbedObj=new k(this._tabsOptions)};h.prototype._initializeTreeListView=function(){var o=this;this._treeListView=new f({columns:o.options._columns,allowUnsafeHTMLContent:false,resize:{rows:false,columns:true,},enableDragAndDrop:false,selection:{unselectAllOnEmptyArea:false,toggle:true,canMultiSelect:true,enableListSelection:true}}).inject(this._contentDiv);this._treeListView.elements.container.style.height="100%";this._treeListView.elements.container.querySelector(".wux-datagrid").style.height="100%";this._treeListView.elements.container.querySelector(".wux-layouts-gridengine").style.height="100%";this._treeDocument=this._treeListView.getDocument();this._treeManager=this._treeListView.getManager();this._registerReusableCellContentForStates();if(this._modeExpandAll){this._treeManager.onReady(function(){o._treeDocument.expandAll()})}};h.prototype.inject=function(o){this._tabbedObj.render().inject(o)};h.prototype.clear=function(){this._container.innerHTML=""};h.prototype.destroy=function(){this._container.innerHTML=""};h.prototype.loadModelVariabilityInformation=function(p){var o=this;if(p==undefined||p==null){i.getVariabilityDefinition({componentId:o._modelId,content:{attributes:3,parameters:(j.PARAMETERS_ENABLED!=undefined?j.PARAMETERS_ENABLED:false),attributeList:["_image"]}}).then(function(q){o._modelVariabilityDico=q;o._transformVariabilityIntoTreeModel()},function(q){console.log("getVariabilityDefinition: Service Call Failed !!!")})}else{o._modelVariabilityDico=p;o._transformVariabilityIntoTreeModel()}};h.prototype._transformVariabilityIntoTreeModel=function(){console.log("Model variability: "+this._modelVariabilityDico);var o=this;if(this._modelVariabilityDico){this._loadDictionaryJsonUpdated(this._modelVariabilityDico)}};h.prototype._loadDictionaryJsonUpdated=function(r){console.log("Loading dictionary");var p=this;if(r){this.options.dictionaryJSON=r;if(this.options.dictionaryJSON){if(this.options.dictionaryJSON._version=="3.0"){this.dicoVersion="3.0"}else{if(this.options.dictionaryJSON._version==undefined||this.options.dictionaryJSON._version=="1.0"||this.options.dictionaryJSON._version=="v1"||this.options.dictionaryJSON._version=="V1"){this.dicoVersion="1.0"}else{if(this.options.dictionaryJSON._version=="2.0"||this.options.dictionaryJSON._version=="v2"||this.options.dictionaryJSON._version=="V2"){this.dicoVersion="2.0"}}}}}if(this.dicoVersion){this._treeDocument.prepareUpdate();if(this.options.actionsTreeListView){this.options.actionsTreeListView.options._treeDocument.prepareUpdate()}switch(this.dicoVersion){case"v1":case"V1":case"1.0":break;case"v2":case"V2":case"2.0":console.log("Dico Format 2.0");break;case"3.0":var o=this._treeDocument._getTrueRoot();this._treeDocument.empty();var q=this._getDictionaryItemFromDictionary(this._modelVariabilityDico);this._getTreeNodeModelFromDicoObject_v04(o,undefined,q);break;default:console.log("Incorrect dictionary version/format: "+this.options.dictionaryJSON._version);break}this._treeDocument.pushUpdate()}};h.prototype._getDictionaryItemsFromPortoflioComps=function(z,t){var q=[];if(z&&z.length>0){for(var p=0;p<z.length;p++){var u=z[p]["id"];var v=z[p]["attributes"];var r=z[p]["variabilityGroups"]?z[p]["variabilityGroups"]["member"]:undefined;var s=z[p]["variants"]?z[p]["variants"]["member"]:undefined;var x=z[p]["parameters"]?z[p]["parameters"]["member"]:undefined;var y=z[p]["options"]?z[p]["options"]["member"]:undefined;var w=z[p]["portfolioClass"]?{portfolioClass:z[p]["portfolioClass"]}:undefined;var o={className:t,componentId:u,componentAttributes:v};if(r){q.push({type:"VariabilityGroups",text:m.VariabilityGroupType,item:r,data:o})}if(s){q.push({type:"Variants",text:m.VariantType,item:s,data:o})}if(y){q.push({type:"Options",text:m.OptionType,item:y,data:o})}if(w){q.push({type:"PortfolioClass",text:"PortfolioClass",item:w,data:o})}if(x){q.push({type:"parameters",text:"Parameters",item:x,data:o})}}}return q};h.prototype._getDictionaryItemFromDictionary=function(v,q){var u=[];var t=this;if(v.portfolioClasses){if(v.portfolioClasses.member&&v.portfolioClasses.member.length>0){v.portfolioClasses.member.forEach(function(w){var y=w["class"];if(w.portfolioComponents){var x=UWA.is(w.portfolioComponents.member,"array")?w.portfolioComponents.member:false;u=t._getDictionaryItemsFromPortoflioComps(x,y)}})}}if(v.portfolioClass){var s=v.portfolioClass["class"];if(v.portfolioClass.portfolioComponents){var r=UWA.is(v.portfolioClass.portfolioComponents.member,"array")?v.portfolioClass.portfolioComponents.member:false;u=t._getDictionaryItemsFromPortoflioComps(r,s)}}if(v.variabilityGroups){if(v.variabilityGroups.member&&v.variabilityGroups.member.length>0){v.variabilityGroups.member.forEach(function(y){var w=y.variants?y.variants["member"]:undefined;var x=y.options?y.options["member"]:undefined;var z=y.variabilityGroups?y.variabilityGroups["member"]:undefined;if(w){u.push({type:"Variants",text:m.VariantType,item:w,data:q})}if(x){u.push({type:"Options",text:m.OptionType,item:x,data:q})}if(z){u.push({type:"VariabilityGroups",text:m.VariabilityGroupType,item:z,data:q})}})}}if(v.variants){if(v.variants.member&&v.variants.member.length>0){v.variants.member.forEach(function(x){var w=x.options?x.options["member"]:undefined;if(w){u.push({type:"Options",text:m.OptionType,item:w,data:q})}})}}if(v.options){var p=v.options?v.options["member"]:undefined;if(p){u.push({type:"Options",text:m.OptionType,item:p,data:q})}}if(v.values){var o=v.values?v.values["member"]:undefined;if(o){u.push({type:"Values",text:m.ValueType,item:o,data:q})}}return u},h.prototype._getTreeNodeModelFromDicoObject_v04=function(p,r,o){var q=this;if(o&&UWA.is(o,"array")){var s=[];o.forEach(function(u){var v=u.item;if(u.type=="PortfolioClass"){var t=q._getDictionaryItemFromDictionary(v);q._getTreeNodeModelFromDicoObject_v04(p,r,t)}else{v.forEach(function(y){var z=true;if(UWA.is(q.contentFilter,"function")){z=q.contentFilter(y)}if(y.kind=="reference"){z=false}if(z){var w=q._createTreeNodeFromDicoItem_v04(u.type,u.text,y,u.data);if(w){p.addChild(w);if(r&&w.options.actionNode){r.addChild(w.options.actionNode)}var x=q._getDictionaryItemFromDictionary(y,u.data);q._getTreeNodeModelFromDicoObject_v04(w,w.options.actionNode,x)}}})}})}};h.prototype._createTreeNodeFromDicoItem_v04=function(y,z,u,r){var t=this;var o=this.options._columns;var v=this.options.actionsTreeListView?true:false;var x="";var q={};var B="_defaultValue";var w="dbunit";var A=u;o.forEach(function(D){var C=D.valueAttribute;if(D&&D.dataIndex=="tree"){x=A[C]?A[C]:(A.attributes?(UWA.is(A.attributes[C],"object")?A.attributes[C].value:A.attributes[C]):(UWA.is(A.get,"function")?A.get(C):""));if(A.attributes&&A.attributes._type==="Variant Parameter"&&A.attributes._dimension){x+=" ("+A.attributes._dimension+")"}}else{if(C&&(C.toLowerCase()==="type"||C.toLowerCase()==="_type")){q[C]=z}else{q[C]=A[C]?A[C]:(A.attributes?(UWA.is(A.attributes[C],"object")?A.attributes[C].value:A.attributes[C]):(UWA.is(A.get,"function")?A.get(C):""))}}});var p="";if(A.attributes&&A.attributes._image){p=A.attributes._image.value}var s=new e({id:A.id,label:x,icons:p?[p]:[],criteriaType:y,dictionaryItem:UWA.clone(A),children:null,grid:q,data:r,actionNode:v?new e({id:A.id,label:"",children:[],grid:{actionCol:"",}}):undefined,});return s};h.prototype.loadConfigurationInfo=function(p){var q=this;if(p!=undefined){var o=p;if(UWA.is(p,"array")==false){o=[p]}o.forEach(function(s){var t=s.id;var u=s;n.getCriteriaConfigurationInstances({id:t}).then(function v(y){if(y.member&&UWA.is(y.member,"array")){var w={};var x=y.member;if(x&&x.length>0){x.forEach(function(z){if(z&&z.id&&w[z.id]===undefined){w[z.id]=(z.status!=undefined?z.status:(z.value!=undefined?z.value:""))}})}q._loadColumnForPC(u,w)}},function r(w){console.log("Failed to retrieve PC Details : "+w)})})}};h.prototype.loadedPCsCount=function(){var o=0;if(this._currentlyLoadedPCs!=undefined){var p=Object.keys(this._currentlyLoadedPCs);o=UWA.is(p,"array")?p.length:0}return o};h.prototype.unloadConfigurationInfo=function(p){var r=this;if(p!=undefined){var o=p;if(UWA.is(p,"array")==false){o=[p]}var q=[];o.forEach(function(s){var t=s.id;if(r._currentlyLoadedPCs.hasOwnProperty(t)){r._unloadColumnForPC(t);delete r._currentlyLoadedPCs[t]}})}};h.prototype._loadColumnForPC=function(p,o){var q=this;if(p&&o){if(this._currentlyLoadedPCs[p.id]==undefined){this._createColumnForPC(p,o)}else{console.log("PC with id : "+p.id+" is already loaded in the view...")}}};h.prototype._unloadColumnForPC=function(q){var p=this;if(q!=undefined){var o=this._treeManager.getColumnIDFromDataIndex(q);p._treeManager.unselectAll();this._treeManager.removeColumn(o)}};h.prototype._createColumnForPC=function(p,o){var q=this;this._currentlyLoadedPCs[p.id]=o;var r={dataIndex:p.id,text:p.title,width:"auto",type:"text",onCellRequest:function(t){if(!t.isHeader){if(t.nodeModel._options.criteriaType==="Values"||t.nodeModel._options.criteriaType==="Options"||t.nodeModel._options.criteriaType==="parameters"){var u=t.nodeModel.options.dictionaryItem.idref?t.nodeModel.options.dictionaryItem.idref:t.nodeModel.options.dictionaryItem.id;var s=q._currentlyLoadedPCs[t.dataIndex][u];if(s!=undefined&&s!=""){if(t.nodeModel._options.criteriaType==="parameters"){t.cellView.getContent().setContent(s)}else{t.cellView.reuseCellContent(s.toUpperCase())}}}}},setValue:function(s){},getValue:function(s){}};q._treeManager.prepareUpdateView();q._treeManager.addColumn({column:r});q._treeManager.pushUpdateView()};h.prototype.removeAllPCColumns=function(p,o){var s=this;if(this.loadedPCsCount()>0){s._treeManager.prepareUpdateView();for(var r in this._currentlyLoadedPCs){if(r!=undefined){var q=s._treeManager.getColumnIDFromDataIndex(r);s._treeManager.unselectAll();s._treeManager.removeColumn(q);delete s._currentlyLoadedPCs[r]}}s._treeManager.pushUpdateView()}};h.prototype._registerReusableCellContentForStates=function(){var o=this;l.forEach(function(p,q){o._treeManager.registerReusableCellContent({id:p,buildContent:c["getContentFor"+p]})})};return h});define("DS/ENOXModelApp/components/Triptych/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","css!DS/ENOXModelApp/components/Triptych/TriptychWrapper.css"],function(d,b,a){var c=function(){};c.prototype.init=function(f,k,h,e,g){this._left=document.createElement("div");this._left.classList.add("xmodel-triptych-wrapper");this._main=document.createElement("div");this._main.classList.add("xmodel-triptych-wrapper");this._right=document.createElement("div");this._right.classList.add("xmodel-triptych-wrapper");this._applicationChannel=f;this._triptych=new d();var j=widget.body.offsetWidth<b.MOBILE_BREAKPOINT?"close":"open";var i={left:{resizable:false,originalSize:b.LEFT_PANEL_SIZE_EXPANDED,originalState:j,overMobile:true,withClose:false,},right:{resizable:true,minWidth:250,originalSize:400,originalState:"close",overMobile:true},borderLeft:true,container:k,withtransition:true,modelEvents:this._applicationChannel};this._triptych.init(i,this._left,this._main,this._right)};c.prototype.inject=function(e){this._triptych.inject(e)};c.prototype._getTriptych=function(){return this._triptych};c.prototype.getLeftPanelContainer=function(){return this._left};c.prototype.getLeftPanelContainerTriptych=function(){return this._triptych._leftPanelContent};c.prototype.getRightPanelContainer=function(){return this._right};c.prototype.getMainPanelContainer=function(){return this._main};return c});define("DS/ENOXModelApp/Utils/xModelLocalStorage",["DS/ENOXModelApp/Utils/xModelPreferencesConstant"],function(b){var c="xmodel-app-last-route";var a={init:function(f){a._LOCALSTORAGE_USER_ID=f;if(!window.localStorage.getItem(a._LOCALSTORAGE_KEY)){var e={};e[a._LOCALSTORAGE_KEY]={};e[a._LOCALSTORAGE_KEY][a._LOCALSTORAGE_USER_ID]=d;window.localStorage.setItem(a._LOCALSTORAGE_KEY,JSON.stringify(e))}else{var e=JSON.parse(window.localStorage.getItem(a._LOCALSTORAGE_KEY));if(!e[a._LOCALSTORAGE_KEY].hasOwnProperty(a._LOCALSTORAGE_USER_ID)){e[a._LOCALSTORAGE_KEY][a._LOCALSTORAGE_USER_ID]=d;window.localStorage.setItem(a._LOCALSTORAGE_KEY,JSON.stringify(e))}}},destroy:function(){window.localStorage.removeItem(a._LOCALSTORAGE_KEY)},isPath:function(j,f){try{if(window.localStorage.getItem(a._LOCALSTORAGE_KEY)){if(Array.isArray(j)){var h=JSON.parse(window.localStorage.getItem(a._LOCALSTORAGE_KEY));for(var g=0;g<j.length;g++){if(h[j[g]]||h[j[g]]==""){h=h[j[g]]}else{console.log("XmodelAppLocalStorage getItem() path doesn't exist");if(f){return undefined}else{return false}}}if(f){return h}else{return true}}else{console.log("XmodelAppLocalStorage getItem() argument is not a Array");if(f){return undefined}else{return false}}}else{console.log("XmodelAppLocalStorage getItem() LocalStorage not initialize");if(f){return undefined}else{return false}}}catch(e){console.error(e);if(f){return undefined}else{return false}}},getValue:function(e){return this.isPath(e,true)},setValue:function(h,f){if(this.isPath(h,false)){var g=JSON.parse(window.localStorage.getItem(a._LOCALSTORAGE_KEY));var e=JSON.parse(JSON.stringify(h));window.localStorage.setItem(a._LOCALSTORAGE_KEY,JSON.stringify(this.recursiveSearch(g,e,f,true)))}},recursiveSearch:function(g,f,e,h){if(f.length==2){g[f[1]]=e}else{if(h){this.recursiveSearch(g[f[0]],f,e,false)}else{f.shift();this.recursiveSearch(g[f[0]],f,e,false)}}return g},};a._LOCALSTORAGE_KEY=b._KEY;a._LOCALSTORAGE_SMALL=b._SMALL;a._LOCALSTORAGE_MEDIUM=b._MEDIUM;a._LOCALSTORAGE_LARGE=b._LARGE;a._LOCALSTORAGE_VIEWS_PREFERENCES=b._VIEWS_PREFERENCES;a._LOCALSTORAGE_MY_MODEL_VERSIONS=b._MY_MODEL_VERSIONS;a._LOCALSTORAGE_MODEL_VERSIONS=b._MODEL_VERSIONS;a._LOCALSTORAGE_MODEL_VERSIONS_DETAILS=b._MODEL_VERSIONS_DETAILS;a._LOCALSTORAGE_RULES=b._RULES;a._LOCALSTORAGE_PRODUCT_CONFIGURATIONS=b._PRODUCT_CONFIGURATIONS;a._LOCALSTORAGE_ENTREPRISE_VARIANTS_OPTIONS=b._ENTREPRISE_VARIANTS_OPTIONS;a._LOCALSTORAGE_VARIANTS=b._VARIANTS;a._LOCALSTORAGE_OPTIONS=b._OPTIONS;a._LOCALSTORAGE_PARAMETERS=b._PARAMETERS;a._LOCALSTORAGE_GROUP_OPTIONS=b._GROUP_OPTIONS;a._LOCALSTORAGE_VARIANTS_DETAILS=b._VARIANTS_DETAILS;a._LOCALSTORAGE_RULES_DETAILS=b._RULES_DETAILS;a._LOCALSTORAGE_PRODUCT_CONFIGURATIONS_DETAILS=b._PRODUCT_CONFIGURATIONS_DETAILS;a._LOCALSTORAGE_LIST_VIEW=b._LIST_VIEW;a._LOCALSTORAGE_VIEW=b._VIEW;a._LOCALSTORAGE_SORT=b._SORT;a._LOCALSTORAGE_GROUP=b._GROUP;a._LOCALSTORAGE_SEARCH=b._SEARCH;a._LOCALSTORAGE_ID_CARD=b._ID_CARD;a._LOCALSTORAGE_COLLAPSE=b._COLLAPSE;var d={"xmodel-views-preferences":{"xmodel-my-model-versions":{"xmodel-list-view":{view:"",sort:{},search:""}},"xmodel-model-versions":{"xmodel-list-view":{view:"",sort:{},group:"",search:""}},"xmodel-model-versions-details":{tab:"",rules:{"xmodel-list-view":{view:"",sort:{}}},"product-configurations":{"xmodel-list-view":{view:"",sort:{}}},"id-card":{collapse:""}},"xmodel-entreprise-variants-options":{tab:"",variants:{"xmodel-list-view":{view:"",sort:{},}},"group-options":{"xmodel-list-view":{view:"",sort:{}}},options:{"xmodel-list-view":{view:"",sort:{}}},parameters:{"xmodel-list-view":{view:"",sort:{}}}},"variants-details":{"xmodel-list-view":{view:"",sort:{}},"id-card":{collapse:""}},"rules-details":{"id-card":{collapse:""}},"product-configurations-details":{"id-card":{collapse:""}}}};return a});define("DS/ENOXModelApp/ModelDefinition/js/LocalDocumentsPresenter",["DS/ENOXDocumentPresenter/js/DocumentPresenter","DS/CoreEvents/ModelEvents","DS/ENOXModelApp/InformationPanels/InformationPanelManager","i18n!DS/ENOXDocumentPresenter/assets/nls/DocumentsPresenter"],function(b,d,c,e){var a=function(){};a.prototype.init=function(i,h,g){if(!g.id){console.log("Missing id in options")}this._isDestroyed=false;this._privateChannel=i||new d();this._internalChannel=new d();this._applicationChannel=h||new d();this._id=g.id;var f={parentId:this._id,actions:{"enable-add":true,"enable-create":true,"enable-remove":true,"enable-reserve":true,"enable-unreserve":true,"enable-update":true},"data-model":{documentTypes:[{type:"Document",Policy:"Document Release",relationship:"Reference Document",text:e.DOC_Type_Document},{type:"Product Specification",Policy:"Specification",relationship:"Product Specification",text:e.DOC_Type_Specification}]},"table-data":{allowUnsafeHTMLContent:false,columns:[{text:e.DOC_Document_Table_Title,dataIndex:"tree",width:"auto",isEditable:true,valueAttribute:"title"},{text:e.DOC_Document_Table_Status,dataIndex:"reservedby",valueAttribute:"reservedby",isEditable:false,width:"65",isSortable:true},{text:e.DOC_Document_Table_Type,dataIndex:"type",valueAttribute:"type",isEditable:false,width:"auto",isSortable:true},{text:e.DOC_Document_Table_Revision,dataIndex:"revision",valueAttribute:"revision",isEditable:false,width:"65",isSortable:true},{text:e.DOC_Document_Table_Version,dataIndex:"version",valueAttribute:"version",isEditable:false,width:"65",isSortable:true},{text:e.DOC_Document_Table_Owner,dataIndex:"owner",valueAttribute:"owner",isEditable:false,width:"auto",isSortable:true},{text:e.DOC_Document_Table_Maturity,dataIndex:"state",valueAttribute:"state",isEditable:false,width:"150",isSortable:true},{text:e.DOC_Document_Table_Description,dataIndex:"description",valueAttribute:"description",isEditable:false,width:"auto",isSortable:true}]},searchQueryType:"Document",modelEvents:this._internalChannel,applicationChannel:this._applicationChannel};this._myDocPresenter=new b(f);this._subscribeToEvents()};a.prototype.inject=function(f){if(this._myDocPresenter){this._myDocPresenter.render().inject(f)}};a.prototype.destroy=function(){if(this._myDocPresenter){this._myDocPresenter.destroy()}};a.prototype._subscribeToEvents=function(){this._internalChannel.subscribe({event:"enoxdoc-open-properties"},this._onOpenInformation.bind(this));this._internalChannel.subscribe({event:"enoxdoc-selection_changed"},this._onSelectionChanged.bind(this));this._internalChannel.subscribe({event:"enoxdoc-double-click"},this._onDoubleClick.bind(this))};a.prototype._onOpenInformation=function(f){c.showInformation(f.id)};a.prototype._onSelectionChanged=function(f){c.selection.Documents=f;c.updateInfoPanel()};a.prototype._onDoubleClick=function(f){this._privateChannel.publish({event:this._myDocPresenter.EVENTINOUT_DOUBLECLICK,data:f})};a.prototype.publishTags=function(){var f=this;f._myDocPresenter.publishTags()};a.prototype.clearTags=function(){this._myDocPresenter.clearTags()};return a});define("DS/ENOXModelApp/components/zApplicationFrame/zApplicationFrame",["DS/CoreEvents/ModelEvents","DS/Core/Core","DS/ENOXModelApp/components/Triptych/TriptychWrapper","DS/ENOXModelApp/components/ApplicationTopBar/ApplicationTopBarWrapper","DS/ENOXModelApp/components/WelcomePanel/WelcomePanelWrapper","css!DS/UIKIT/UIKIT.css","css!DS/ENOXModelApp/components/zApplicationFrame/zApplicationFrame.css"],function(d,f,e,c,a){var b=function(){};b.prototype._init=function(g,h,j,i){this._applicationChannel=g;this._router=h;this._leftContent=j;this._middleContent=i;this._initDom()};b.prototype._initDom=function(){this._content=document.createElement("div");this._content.classList.add("z-panel");this._topbar=document.createElement("div");this._topbar.classList.add("z-topbar");this._mainContainer=document.createElement("div");this._mainContainer.classList.add("z-content");this._content.appendChild(this._topbar);this._content.appendChild(this._mainContainer);this._pageToolBarComponent=new c();this._pageToolBarComponent.init(this._applicationChannel,this._router,this._topbar);this._triptychWrapper=new e();this._triptychWrapper.init(this._applicationChannel,this._mainContainer);if(this._middleContent&&this._middleContent._container){this._applicationChannel.publish({event:"triptych-set-content",data:{side:"middle",content:this._middleContent._container}})}this._subscribeEvents();this.__mobileBreakpoint=this._triptychWrapper._triptych.__mobileBreakpoint};b.prototype._subscribeEvents=function(){this._listSubscription=[];var g=this;g._listSubscription.push(g._applicationChannel.subscribe({event:"triptych-show-panel"},function(h){if(g._content.clientWidth<g.__mobileBreakpoint){g._topbar.classList.add("hide");g._mainContainer.classList.add("full-height")}}));g._listSubscription.push(g._applicationChannel.subscribe({event:"triptych-panel-hide-started"},function(h){if(g._content.clientWidth<g.__mobileBreakpoint){g._topbar.classList.remove("hide");g._mainContainer.classList.remove("full-height")}}));g._listSubscription.push(g._applicationChannel.subscribe({event:"triptych-entering-mobile"},function(){g._topbar.classList.remove("hide");g._mainContainer.classList.remove("full-height");g._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})}));g._listSubscription.push(g._applicationChannel.subscribe({event:"triptych-leaving-mobile"},function(){g._topbar.classList.remove("hide");g._mainContainer.classList.remove("full-height")}))};b.prototype.inject=function(g){g.appendChild(this._content)};b.prototype.destroy=function(){this._content=null};return b});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_GroupOption",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationGroupOption"],function(d,b,a){var c=d.singleton({createDialogCreationGroupOption:function(h,g){var f={fields:[{type:"text",label:a.TITLE,placeholder:a.TITLE,name:"title"}]};var e={title:a.GROUP_OPTION,type:"new",modelEvent:g,form:f,immersiveFrame:h};return new b(e)}});return c});define("DS/ENOXModelApp/components/DialogCreation/DialogCreation_PC",["UWA/Class","DS/ENOXModelApp/components/DialogCreation/DialogCreation","i18n!DS/ENOXModelApp/assets/nls/components/DialogCreation/DialogCreationPC"],function(d,c,a){var b=d.singleton({createDialogCreationPC:function(h,g){var f={fields:[{type:"text",label:a.TITLE,placeholder:a.TITLE,name:"title"}]};var e={title:a.PRODUCT_CONFIGURATION,type:"new",modelEvent:g,form:f,immersiveFrame:h};return new c(e)}});return b});define("DS/ENOXModelApp/Utils/xModelWidgetPreferencesManager",["DS/ENOXModelApp/Utils/xModelPreferencesConstant"],function(a){var b=function(){};b._KEY=a._KEY;b._LAST_ROUTE=a._LAST_ROUTE;b._SMALL=a._SMALL;b._MEDIUM=a._MEDIUM;b._LARGE=a._LARGE;b._VIEWS_PREFERENCES=a._VIEWS_PREFERENCES;b._MY_MODEL_VERSIONS=a._MY_MODEL_VERSIONS;b._MODEL_VERSIONS=a._MODEL_VERSIONS;b._MODEL_VERSIONS_DETAILS=a._MODEL_VERSIONS_DETAILS;b._RULES=a._RULES;b._PRODUCT_CONFIGURATIONS=a._PRODUCT_CONFIGURATIONS;b._ENTREPRISE_VARIANTS_OPTIONS=a._ENTREPRISE_VARIANTS_OPTIONS;b._VARIANTS=a._VARIANTS;b._OPTIONS=a._OPTIONS;b._PARAMETERS=a._PARAMETERS;b._GROUP_OPTIONS=a._GROUP_OPTIONS;b._VARIANTS_DETAILS=a._VARIANTS_DETAILS;b._RULES_DETAILS=a._RULES_DETAILS;b._PRODUCT_CONFIGURATIONS_DETAILS=a._PRODUCT_CONFIGURATIONS_DETAILS;b._LIST_VIEW=a._LIST_VIEW;b._VIEW=a._VIEW;b._SORT=a._SORT;b._GROUP=a._GROUP;b._SEARCH=a._SEARCH;b._ID_CARD=a._ID_CARD;b._COLLAPSE=a._COLLAPSE;b.prototype.initWidgetViewPreferences=function(){if(!widget.getValue(b._KEY)){var c={"xmodel-app":{"last-route":{},"xmodel-views-preferences":{"xmodel-my-model-versions":{"xmodel-list-view":{view:"",sort:{},search:""}},"xmodel-model-versions":{"xmodel-list-view":{view:"",sort:{},group:"",search:""}},"xmodel-model-versions-details":{tab:"",rules:{"xmodel-list-view":{view:"",sort:{}}},"product-configurations":{"xmodel-list-view":{view:"",sort:{}}},"id-card":{collapse:""}},"xmodel-entreprise-variants-options":{tab:"",variants:{"xmodel-list-view":{view:"",sort:{},}},"group-options":{"xmodel-list-view":{view:"",sort:{}}},options:{"xmodel-list-view":{view:"",sort:{}}},parameters:{"xmodel-list-view":{view:"",sort:{}}}},"variants-details":{"xmodel-list-view":{view:"",sort:{}},"id-card":{collapse:""}},"optiongroup-details":{"xmodel-list-view":{view:"",sort:{}},"id-card":{collapse:""}},"rules-details":{"id-card":{collapse:""}},"product-configurations-details":{"id-card":{collapse:""}}}}};widget.setValue(b._KEY,JSON.stringify(c))}};b.prototype.updateWidgetViewPreferences=function(f,d){if(this.isPath(f,false)){var e=JSON.parse(widget.getValue(b._KEY));var c=JSON.parse(JSON.stringify(f));widget.setValue(b._KEY,JSON.stringify(this.recursiveSearch(e,c,d,true)))}};b.prototype.recursiveSearch=function(e,d,c,f){if(f&&d.length==2){e[d[0]][d[1]]=c}else{if(d.length==2){e[d[1]]=c}else{if(f){this.recursiveSearch(e[d[0]],d,c,false)}else{d.shift();this.recursiveSearch(e[d[0]],d,c,false)}}}return e};b.prototype.isPath=function(h,d){try{var f=widget.getValue(b._KEY);if(f){if(Array.isArray(h)){var g=JSON.parse(f);for(var e=0;e<h.length;e++){if(g[h[e]]||g[h[e]]==""){g=g[h[e]]}else{console.log("xModelWidgetPreferencesManager isPath() path doesn't exist");if(d){return undefined}else{return false}}}if(d){return g}else{return true}}else{console.log("xModelWidgetPreferencesManager isPath() parameter 1 is not a Array");if(d){return undefined}else{return false}}}else{console.log("xModelWidgetPreferencesManager isPath() widgetPreferences not initialize");if(d){return undefined}else{return false}}}catch(c){console.error(c);if(d){return undefined}else{return false}}};b.prototype.getValue=function(c){return this.isPath(c,true)};return b});define("DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager",["UWA/Class","DS/ENOXModelApp/Utils/xModelLocalStorage","DS/ENOXModelApp/Utils/xModelWidgetPreferencesManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant"],function(c,e,d,a){var b=c.singleton({initialize:function(h,f,g){this._withLocalStorage=h;this._withWidgetPreferences=f;this._withUserPreferences=g;if(h){e.init(this.userID)}if(f){d.prototype.initWidgetViewPreferences()}if(g){}},setUserId:function(f){this.userID=f},updatePreference:function(g,f){if(this._withWidgetPreferences){d.prototype.updateWidgetViewPreferences(g,f)}if(this._withLocalStorage){g.splice(1,0,this.userID);e.setValue(g,f)}if(this._withUserPreferences){}},updateView:function(g,f){this.updatePreference(g.concat([a._LIST_VIEW,a._VIEW]),f)},updateGroup:function(g,f){this.updatePreference(g.concat([a._LIST_VIEW,a._GROUP]),f)},updateSort:function(g,f){this.updatePreference(g.concat([a._LIST_VIEW,a._SORT]),f)},updateTab:function(g,f){this.updatePreference(g.concat([a._TAB]),f)},updateCollapse:function(g,f){this.updatePreference(g.concat([a._ID_CARD,a._COLLAPSE]),f)},getPreference:function(f){console.log("XmodelApplicationPreferencesLanager -getPreference : "+f);if(this._withWidgetPreferences&&this.getWidgetPreferenceValue(f)!=undefined){return this.getWidgetPreferenceValue(f)}else{if(this._withLocalStorage){f.splice(1,0,this.userID);return this.getLocalStorageValue(f)}return undefined}},getView:function(f){return this.getPreference((f.concat([a._LIST_VIEW,a._VIEW])))},getSort:function(f){return this.getPreference((f.concat([a._LIST_VIEW,a._SORT])))},getGroup:function(f){return this.getPreference((f.concat([a._LIST_VIEW,a._GROUP])))},getTab:function(f){return this.getPreference((f.concat([a._TAB])))},getCollapse:function(f){return this.getPreference((f.concat([a._ID_CARD,a._COLLAPSE])))},setRouteInfo:function(g){if(this._withWidgetPreferences){var h=[a._KEY,a._LAST_ROUTE];var f={name:g&&g.name?g.name:undefined,params:g&&g.params?g.params:undefined};d.prototype.updateWidgetViewPreferences(h,f);console.log(JSON.parse(widget.getValue("xmodel-app")));console.log("")}},getRouteInfo:function(){if(this._withWidgetPreferences){var f=[a._KEY,a._LAST_ROUTE];return this.getWidgetPreferenceValue(f)}return{name:undefined,params:{}}},getLocalStorageValue:function(f){return e.getValue(f)},getWidgetPreferenceValue:function(f){return d.prototype.getValue(f)},});return b});define("DS/ENOXModelApp/ModelDocument/js/ModelDocumentDetailsPresenter",["DS/ENOXDocumentCockpit/js/DocumentDetailsPresenter","DS/CoreEvents/ModelEvents","DS/ENOXModelApp/ModelDefinition/js/VersionExplorerPresenter","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/LifecycleCmd/MaturityCmd","DS/ENOXModelApp/InformationPanels/InformationPanelManager"],function(f,e,g,a,b,d,c){var h=function(){this._genericComponentPresenter=new f()};h.prototype.init=function(j,i){this._id=i.id;i.installVersionExplorer=this._initVersionGraphComponent.bind(this);this._applicationChannel=j;this._privateChannel=new e();this._versionExplorerEvents=new e();this._initPropertyPanel();this._genericComponentPresenter.init(j,i);this._registerToEvent()};h.prototype.destroy=function(){if(this._genericComponentPresenter){this._genericComponentPresenter.destroy()}c.removeAllSelection("File")};h.prototype.inject=function(i){this._genericComponentPresenter.inject(i)};h.prototype.fetchData=function(){this._genericComponentPresenter.fetchData()};h.prototype._openVersionExplorerPresenter=function(i){var j=i.id;if(this._versionExplorer){this._versionExplorer.showVersionExplorer(j)}};h.prototype._openDocument=function(i){this._genericComponentPresenter.openDocument(i.id)};h.prototype._openChangeOwner=function(j){var i=new b({context:j.id,ID:"ActionBar_ChangeOwner"});i.begin()};h.prototype._openChangeChangeMaturity=function(j){var i=new d({context:j.id,ID:"MaturityHdr"});i.begin()};h.prototype._openPropertyPanel=function(i){c.showInformation(this._id)};h.prototype._registerToEvent=function(){this._genericComponentPresenter.registerToOpenVersionManager(this._openVersionExplorerPresenter.bind(this));this._genericComponentPresenter.registerToOpenOwnerManager(this._openChangeOwner.bind(this));this._genericComponentPresenter.registerToOpenMaturityManager(this._openChangeChangeMaturity.bind(this));this._genericComponentPresenter.registerToOpenPropertyManager(this._openPropertyPanel.bind(this));this._versionExplorerEvents.subscribe({event:"model-version-action-open"},this._openDocument.bind(this))};h.prototype._initPropertyPanel=function(){c.initialize({applicationChannel:this._applicationChannel,context:"File",id:this._id})};h.prototype._initVersionGraphComponent=function(i){this._versionExplorer=new g({id:this._id,dataModelType:a.DATA_MODEL_TYPES.MODEL_ER,renderTo:i.container,modelEvents:this.versionExplorerEvents})};return h});define("DS/ENOXModelApp/ModelDefinition/js/PCListPresenter",["DS/ENOXSplitView/js/ENOXSplitView","DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Core","UWA/Element","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelCommand","DS/WebappsUtils/WebappsUtils","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/components/DialogCreation/DialogCreation_PC","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/PCListPresenter","css!DS/ENOXModelApp/ModelDefinition/css/PCList.css"],function(h,z,r,i,t,a,m,w,y,l,q,c,g,p,b,d,f,j,o,n,x,u,v,s,k){var e=function(){};e.prototype.init=function(D,C,B){this._isDestroyed=false;this._pathPC=[j._KEY,j._VIEWS_PREFERENCES,j._MODEL_VERSIONS_DETAILS,j._PRODUCT_CONFIGURATIONS];this._privateChannel=D?D:new r();this._applicationChannel=C;this._updateChannelLocal=new r();this._myEventManager=new f(this._applicationChannel,this._updateChannelLocal,this._privateChannel);this._id=B.id;this._disable=!B.editable;this._namePage="ProductConfigurations";q.initialize({applicationChannel:this._applicationChannel,id:this._id,context:this._namePage});this._listPresenter=null;this._initializeListView();var A={modelEvents:this._privateChannel,withtransition:true,withoverflowhidden:false,params:{leftWidth:40,leftVisible:true,rightVisible:false,rightMaximizer:true,leftMaximizer:true}};this._splitView=new h();this._splitView.init(A);this._initDivs();this._initCommand();this._subscribeToEvents()};e.prototype._initCommand=function(){this._command=new c(this._privateChannel,this._container)};e.prototype._initializeListView=function(){var C=this;var D=o.getSort(this._pathPC);if(D&&D.sortAttribute&&D.sortOrder){var A={id:D.sortAttribute,order:D.sortOrder}}var B={id:"productConfigurations",modelEvents:this._privateChannel,useDragAndDrop:true,viewOptions:{identifier:"productConfigurations",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],currentView:o.getView(this._pathPC)||"DataGridView",currentSort:A||undefined,grid:{columns:[{text:s.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true},{text:s.NAME,dataIndex:"name",},{text:s.DESCRIPTION,dataIndex:"description",editableFlag:true,},{text:s.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(E){return{label:E.nodeModel.options.grid.state,url:"#Maturity"}}},{text:s.OWNER,dataIndex:"owner",visibleFlag:true,getCellValue:function(E){return{label:E.nodeModel.options.grid.owner?E.nodeModel.options.grid.owner:E.nodeModel.options.grid.responsible,url:"#Owner"}},typeRepresentation:"url",hyperlinkTarget:"_self"},{text:s.CREATION_DATE,dataIndex:"created",},{text:s.MODIFICATION_DATE,dataIndex:"modified",},{text:s.ORGANIZATION,dataIndex:"organization",},]},editable:true,itemViewMapping:{label:"title",subLabel:"state",description:"description"},contextualActions:[{id:"open",title:k._open,text:k._open,fonticon:"export",handler:function(E){console.log("item clicked");p.navigate(b.ROUTE_MODEL_PC_DETAILS,{id:E.id,name:E.title})}},{id:"information",title:k._information,text:k._information,fonticon:"info",handler:function(E){q.showInformation(E.id)}},{id:"delete",title:k._delete,text:k._delete,fonticon:"trash",handler:function(E){if(E){var F=[{id:E.id,title:E.title}];C.createDeleteModelDialog(F,C._privateChannel)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:s.EMPTY_CONTENT_MESSAGE}]},toolbarOptions:{itemsName:k._configurationMultiple,itemName:k._configurationSingle,actions:[{id:"preview",text:k._preview,fonticon:"eye",allowSelectRetain:true,handler:function(E){C._privateChannel.publish({event:"on-preview",data:{activated:E}})}},{id:"create",text:k._create,fonticon:"plus",disabled:this._disable,handler:function(){console.log("Create Action handler.");C.createCreationModelDialog(u.getImmersiveFrame(),C._privateChannel)}},{id:"delete",text:k._delete,fonticon:"trash",disabled:this._disable,enableOnSelection:!this._disable,handler:function(E,F){console.log("delete action..");var G=E.map(function(H){return{id:H.id,title:H.label}});C.createDeleteModelDialog(G,C._privateChannel)}}]},extensions:[m,w]};this._listPresenter=new a(B)};e.prototype._subscribeToEvents=function(){var A=this;this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-link-click"},function(B){A._privateChannel.publish({event:"xmodel-execute-command",data:B})});this._myEventManager.subscribe(this._privateChannel,{event:"enox-dialog-delete"},function(B){A.deletePC(B)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-dialog-creation"},function(B){A.createPC(B.content)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-add-selection"},function(B){var C=B.model;q.addSelection(C.id)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-remove-selection"},function(B){var C=B.model;q.removeSelection(C.id)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-empty-selection"},function(B){q.removeAllSelection()});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-data-item-need-refresh"},function(B){A._refreshListView(A._privateChannel,B,this)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-collection-toolbar-switch-view-activated"},function(B){o.updateView(A._pathPC,B)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-collection-toolbar-sort-activated"},function(B){o.updateSort(A._pathPC,B)});this._myEventManager.subscribe(this._privateChannel,{event:"list-view-update-inline-action"},function(B){if(B&&B.model&&B.name&&B.value!=undefined){var D=B.model[0];var E=B.cell.nodeModel;var C={icons:[g.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};E.updateOptions(C);A._editionPCs(D,B.name,B.value.trim())}})};e.prototype._editionPCs=function(F,B,E){var C=this;if(F&&B&&E){var D={};D[B]=E;y.patchProductConfiguration(F.id,D).then(function G(H){console.log("PCListPresenter _editionPCs : Service Call Success !!!");C._privateChannel.publish({event:"xmodel-list-data-item-update-action",data:H.member[0]});if(C._listPresenter._getSelectedItem()[0]){var I=C._listPresenter._getSelectedItem()[0].id}var J=H.member[0].id;q.removeSelection(J);q.addSelection(I)},function A(H){console.log("PCListPresenter _editionPCs : Service Call Failed !!!");C._privateChannel.publish({event:"xmodel-list-data-item-update-action",data:F});v.showError(k.ERROR_PATCH_PC_DETAILS)})}};e.prototype._refreshListView=function(C,D,A){if(D!=undefined){var B=this;y.getConfigurationDetails({id:D}).then(function(F){console.log("getConfigurationDetails: Service Call Successful !!!");if(F&&F.member[0]){var E=F.member[0];E.context=A;C.publish({event:"xmodel-list-data-item-update-action",data:E})}q.removeSelection(E.id,B._namePage);q.addSelection(E.id,B._namePage)},function(){console.log("getRuleDetails: Service Call Failed !!!");v.showError(k.ERROR_GET_PC_DETAILS)})}};e.prototype._initDivs=function(){var A=this;this._container=i.createElement("div");this._container.classList.add("PCList-presenter");this._splitView.inject(this._container);this._leftPanel=this._splitView.getLeft();this._rightPanel=this._splitView.getRight();i.extendElement(this._leftPanel);i.extendElement(this._rightPanel);this._listPresenter.inject(this._leftPanel)};e.prototype.inject=function(A){A.appendChild(this._container)};e.prototype.loadData=function(){var B=this;B._privateChannel.publish({event:"xmodel-list-data-on-load-start"});y.getConfigurationVersions({parentId:this._id}).then(function C(E){var D=[];if(E.member[0].hasOwnProperty("productConfigurations")){D=E.member["0"].productConfigurations}B._privateChannel.publish({event:"xmodel-list-data-load-action",data:D});B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"});B._privateChannel.publish({event:"enox-collection-toolbar-sort-activated",data:o.getSort(B._pathPC)})},function A(D){v.showError(k.ERROR_GET_PCs);B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})})},e.prototype.createPC=function(A){var B=this;B._privateChannel.publish({event:"xmodel-list-data-on-load-start"});i.merge(A,{name:"",description:"",purpose:"Evaluation"});y.createConfiguration({parentID:this._id,items:[{type:"",versionName:"",attributes:A}]}).then(function C(D){valueId=D.member[0]["id"];console.log("Created PC Id is: "+valueId);y.getConfigurationDetails({id:valueId}).then(function(F){var E=F.member[0];B._privateChannel.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(G){G.select()});B._privateChannel.publish({event:"xmodel-list-data-item-add-action",data:E});B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})},function(){console.log("getConfigurationDetails: Service Call Failed !!!");v.showError(k.ERROR_GET_PC_DETAILS);B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})})},function(){console.log("Product Configuration creation failed");v.showError(k.ERROR_CREATE_PC);B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})})};e.prototype.createDeleteModelDialog=function(C,D){var A={listItems:C,type:"delete",single:k._configurationSingle,multiple:k._configurationMultiple,modelEvent:D,immersiveFrame:u.getImmersiveFrame()};var B=new n(A)};e.prototype.createCreationModelDialog=function(B,A){x.createDialogCreationPC(B,A)};e.prototype.deletePC=function(A){var B=this;y.deleteConfigurationVersions({parentId:this._id,ids:A}).then(function D(){console.log("Product Configuration/s deleted successfully.");B._privateChannel.publish({event:"xmodel-list-data-item-remove-action",data:A})},function C(){console.log("Error! Product Configuration deletion failed!!");v.showError(k.ERROR_DELETE_PC)})};e.prototype.destroy=function(){this._container=null;this._isDestroyed=true;this.clearTags();if(this._myEventManager){this._myEventManager.cleanup("PCListPresenter");this._myEventManager=null}};e.prototype.publishTags=function(){this._privateChannel.publish({event:"xmodel-list-tagger-activate-action"})};e.prototype.clearTags=function(){this._privateChannel.publish({event:"xmodel-list-tagger-deactivate-action"})};return e});define("DS/ENOXModelApp/xModelRouter/xModelRouterConfig",["DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/PlatformAPI/PlatformAPI","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","i18n!DS/ENOXModelApp/assets/nls/xModelApp",],function(d,f,b,g,e,a){var c={initialize:function(){d.initialize(f.ROUTE_HOME,f.PATH_HOME);var i=[{name:f.ROUTE_LANDING_PAGE,path:"/"+f.PATH_LANDING_PAGE},{name:f.ROUTE_DICTIONARY,path:"/"+f.PATH_DICTIONARY},{name:f.ROUTE_DICTIONARY_VARIANTS_OPTIONS,path:"/"+f.PATH_DICTIONARY_VARIANTS_OPTIONS},{name:f.ROUTE_DICTIONARY_VARIANT_DETAILS,path:"/"+f.PATH_DICTIONARY_VARIANT_DETAILS},{name:f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS,path:"/"+f.PATH_DICTIONARY_OPTION_GROUP_DETAILS},{name:f.ROUTE_MODEL_DEFINITION,path:"/"+f.PATH_MODEL_DEFINITION},{name:f.ROUTE_MODELS,path:"/"+f.PATH_MODELS},{name:f.ROUTE_MODEL_INFO,path:"/"+f.PATH_MODEL_INFO},{name:f.ROUTE_MODEL_DETAILS,path:"/"+f.PATH_MODEL_DETAILS},{name:f.ROUTE_MODEL_RULE_DETAILS,path:"/"+f.PATH_MODEL_RULE_DETAILS},{name:f.ROUTE_MODEL_PC_DETAILS,path:"/"+f.PATH_MODEL_PC_DETAILS,canDeactivate:false,canActivate:false},{name:f.ROUTE_MODEL_DOC_DETAILS,path:"/"+f.PATH_MODEL_DOC_DETAILS,canDeactivate:false,canActivate:false}];i.forEach(function(l){d.addRoute(l)});var j={};j[f.ROUTE_HOME]={activate:function(){console.log();var l=d.getDependency("xModelApp");l.clearContent()},deactivate:function(){}};j[f.ROUTE_LANDING_PAGE]={activate:function(n){var m=d.getDependency("xModelApp");var l=d.getDependency("applicationChannel");m.clearContent();m._initContent()},deactivate:function(n){var m=d.getDependency("xModelApp");var l=d.getDependency("landingPage");if(l){l.destroy()}m.clearContent();if(!n.params.isRefresh){e.setRouteInfo({name:null})}}};j[f.ROUTE_DICTIONARY]={activate:function(p){var o=d.getDependency("xModelApp");var l=d.getDependency("applicationChannel");o.deactivateWP();o.clearContent();o._initEnterpriseDico(p);var n={linkID:f.ROUTE_DICTIONARY,linkText:a.enterprise_dictionary_breadcrumb};l.publish({event:"breadcrumb-reset",data:null});l.publish({event:"breadcrumb-add-link",data:n});var m=d.getDependency("InformationPanelManager");m.resetPropertyPanel();m.setContext(f.ROUTE_DICTIONARY)},deactivate:function(n){var m=d.getDependency("xModelApp");var l=d.getDependency("applicationChannel");var o=d.getDependency("enterpriseDictionaryPresenter");m.reactivateWP();o.destroy();m.clearContent();d.setDependency("enterpriseDictionaryPresenter",null);l.publish({event:"breadcrumb-reset",data:null});if(!n.params.isRefresh){e.setRouteInfo({name:null})}}};j[f.ROUTE_DICTIONARY_VARIANTS_OPTIONS]={activate:function(p){p.params=p.params||{};if(!p.params.isRefresh){var l={name:f.ROUTE_DICTIONARY_VARIANTS_OPTIONS,params:{}};e.setRouteInfo(l)}var q=d.getDependency("enterpriseDictionaryPresenter");if(p.params.reload===true||p.params.reload===undefined){q.loadData(true)}else{var m=d.getDependency("applicationChannel");var o={linkID:f.ROUTE_DICTIONARY,linkText:a.enterprise_dictionary_breadcrumb};m.publish({event:"breadcrumb-reset",data:null});m.publish({event:"breadcrumb-add-link",data:o})}var n=d.getDependency("InformationPanelManager");n.setContext(f.ROUTE_DICTIONARY_VARIANTS_OPTIONS)},deactivate:function(){var m=d.getDependency("xModelApp");m.clearContent();m._initEnterpriseDico();var l=d.getDependency("InformationPanelManager");l.resetPropertyPanel();l.setContext(f.ROUTE_DICTIONARY)}};j[f.ROUTE_DICTIONARY_VARIANT_DETAILS]={activate:function(q){console.log("activating VC Details");q.params=q.params||{};if(q.params.isRefresh){var l=e.getRouteInfo();if(l&&l.params.variantId){UWA.merge(q.params,{id:l.params.variantId,name:l.params.variantName,version:null})}}else{if(q.params&&q.params.id){var l={name:f.ROUTE_DICTIONARY_VARIANT_DETAILS,params:{variantId:q.params.id,variantName:q.params.name}};e.setRouteInfo(l)}}var p=d.getDependency("xModelApp");var m=d.getDependency("applicationChannel");var r=d.getDependency("enterpriseDictionaryPresenter");r._initAndLoadDataVariantClassDetails(q.params);var o={linkID:f.ROUTE_DICTIONARY_VARIANT_DETAILS,linkText:q.params.name,additionalData:q.params.id};m.publish({event:"breadcrumb-add-link",data:o});var n=d.getDependency("InformationPanelManager");n.setContext(f.ROUTE_DICTIONARY_VARIANT_DETAILS,{id:q.params.id})},deactivate:function(p){var o=d.getDependency("xModelApp");var m=d.getDependency("variantDetailsStatePresenter");if(m){d.setDependency("variantDetailsStatePresenter",null);m.destroy()}o.clearContent();o._initEnterpriseDico();var q=d.getDependency("enterpriseDictionaryPresenter");q.loadData();var n=d.getDependency("InformationPanelManager");n.resetPropertyPanel();n.setContext(f.ROUTE_DICTIONARY_VARIANTS_OPTIONS);if(!p.params.isRefresh){var l={name:f.ROUTE_DICTIONARY_VARIANTS_OPTIONS,params:{}};e.setRouteInfo(l)}}};j[f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS]={activate:function(q){console.log("activating OG Details");q.params=q.params||{};if(q.params.isRefresh){var l=e.getRouteInfo();if(l&&l.params.id){UWA.merge(q.params,{id:l.params.id,name:l.params.name,version:null})}}else{if(q.params&&q.params.id){var l={name:f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS,params:{id:q.params.id,name:q.params.name}};e.setRouteInfo(l)}}var p=d.getDependency("xModelApp");var m=d.getDependency("applicationChannel");var r=d.getDependency("enterpriseDictionaryPresenter");r._initAndLoadDataOptionGroupDetails(q.params);var o={linkID:f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS,linkText:q.params.name,additionalData:q.params.id};m.publish({event:"breadcrumb-add-link",data:o});var n=d.getDependency("InformationPanelManager");n.setContext(f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS,{id:q.params.id})},deactivate:function(p){var o=d.getDependency("xModelApp");var m=d.getDependency("optionGroupDetailsStatePresenter");if(m){d.setDependency("optionGroupDetailsStatePresenter",null);m.destroy()}o.clearContent();o._initEnterpriseDico();var q=d.getDependency("enterpriseDictionaryPresenter");q.loadData();var n=d.getDependency("InformationPanelManager");n.resetPropertyPanel();n.setContext(f.ROUTE_DICTIONARY_VARIANTS_OPTIONS);if(!p.params.isRefresh){var l={name:f.ROUTE_DICTIONARY_VARIANTS_OPTIONS,params:{}};e.setRouteInfo(l)}}};var k=function(m){console.log("Events from PlatformAPI");var l=m?(m.data?(m.data.authored?(m.data.authored.modified?m.data.authored.modified:[]):[]):[]):[];l.forEach(function(o,n){if(o){g.getModelDetails({id:o}).then(function(p){var q=p.member[0];if(q.type==="Model Version"&&(q.isRoot==="True"||q.isRoot||q.isRoot==="true")){var r=q.modelID;g.patchModel(r,{title:q.title,description:q.description}).then(function(){console.log("model updated")},function(){console.log("failed")})}},function(p){console.log("fail to retrieve mv "+o)})}})};j[f.ROUTE_MODEL_DEFINITION]={activate:function(o){var n=d.getDependency("xModelApp");var l=d.getDependency("applicationChannel");n.deactivateWP();n.clearContent();n._initModels(o);var m={linkID:f.ROUTE_MODEL_DEFINITION,linkText:a.model_definition_breadcrumb};l.publish({event:"breadcrumb-reset",data:null});l.publish({event:"breadcrumb-add-link",data:m});b.subscribe("DS/PADUtils/PADCommandProxy/refresh",k)},deactivate:function(o){b.unsubscribe("DS/PADUtils/PADCommandProxy/refresh");var n=d.getDependency("xModelApp");var l=d.getDependency("applicationChannel");n.clearContent();n.reactivateWP();l.publish({event:"breadcrumb-reset",data:null});var m=d.getDependency("modelsStatePresenter");m.destroy();d.setDependency("modelsStatePresenter",null);if(!o.params.isRefresh){e.setRouteInfo({name:null})}}};j[f.ROUTE_MODELS]={activate:function(o){o.params=o.params||{};if(!o.params.isRefresh){var l={name:f.ROUTE_MODELS,params:{}};e.setRouteInfo(l)}var n=d.getDependency("xModelApp");n.clearContent();n._initModels();var m=d.getDependency("modelsStatePresenter");m.loadData(true)},deactivate:function(){}};j[f.ROUTE_MODEL_INFO]={activate:function(q){console.log("activating ModelInfo");q.params=q.params||{};if(q.params.isRefresh){var l=e.getRouteInfo();if(l&&l.params.modelId){UWA.merge(q.params,{id:l.params.modelId,name:l.params.modelName,version:l.params.modelVersion})}}else{if(q.params&&q.params.id){var l={name:f.ROUTE_MODEL_INFO,params:{modelId:q.params.id,modelName:q.params.name,modelVersion:q.params.version,}};e.setRouteInfo(l)}}var p=d.getDependency("xModelApp");var m=d.getDependency("applicationChannel");p.clearContent();var o={linkID:f.ROUTE_MODEL_DETAILS,linkText:q.params.name+" "+q.params.version,additionalData:q.params};m.publish({event:"breadcrumb-add-link",data:o});widget.setTitle(q.params.name+" "+q.params.version);var n=d.getDependency("modelsStatePresenter");d.setDependency("modelDetailsStatePresenter",undefined);n._initModelDetails(q.params,false);n.clearTags()},deactivate:function(r){var q=d.getDependency("xModelApp");var p=d.getDependency("InformationPanelManager");var n=d.getDependency("applicationChannel");q.clearContent();var m=d.getDependency("modelDetailsStatePresenter");d.setDependency("modelDetailsStatePresenter",undefined);m.destroy();q._initModels();widget.setTitle("");p.resetPropertyPanel();p.setContext(f.ROUTE_MODELS);var o=d.getDependency("modelsStatePresenter");if(!r.params.isRefresh){o.loadData();var l={name:f.ROUTE_MODELS,params:{}};e.setRouteInfo(l)}}};j[f.ROUTE_MODEL_DETAILS]={activate:function(r){console.log("activating ModelDetails");r.params=r.params||{};if(r.params.isRefresh){var m=e.getRouteInfo();if(m&&m.params.modelId){UWA.merge(r.params,{id:m.params.modelId,name:m.params.modelName,version:m.params.modelVersion})}}else{if(r.params&&r.params.id){var m={name:f.ROUTE_MODEL_DETAILS,params:{modelId:r.params.id,modelName:r.params.name,modelVersion:r.params.version,}};e.setRouteInfo(m)}}var q=d.getDependency("modelsStatePresenter");var n=d.getDependency("applicationChannel");var p=d.getDependency("InformationPanelManager");var l=d.getDependency("modelDetailsStatePresenter");l._fetchData();var o={linkID:f.ROUTE_MODEL_INFO,linkText:r.params.name+" "+r.params.version,additionalData:r.params};n.publish({event:"breadcrumb-remove-link",data:f.ROUTE_MODEL_DETAILS});n.publish({event:"breadcrumb-add-link",data:o});p.setContext(f.ROUTE_MODEL_DETAILS,{id:r.params.id})},deactivate:function(l){}};j[f.ROUTE_MODEL_RULE_DETAILS]={activate:function(n){console.log("activating RuleDetails");n.params=n.params||{};if(false||n.params.isRefresh){var l=e.getRouteInfo();if(l&&l.params.ruleId){UWA.extend(n.params,{id:l.params.ruleId,name:l.params.ruleName,version:null})}}else{if(n.params&&n.params.id){var l=e.getRouteInfo();l.name=f.ROUTE_MODEL_RULE_DETAILS;l.params.ruleId=n.params.id;l.params.ruleName=n.params.name;e.setRouteInfo(l)}}var t=d.getDependency("applicationChannel");var r=d.getDependency("modelDetailsStatePresenter");var m=d.getDependency("InformationPanelManager");n.params.parentID=r._id;var p=widget.getTitle();widget.setTitle(n.params.name);var o={linkID:f.ROUTE_MODEL_RULE_DETAILS,linkText:n.params.name,additionalData:{id:n.params.id,name:n.params.name,parentID:r._id}};t.publish({event:"breadcrumb-add-link",data:o});m.setContext(f.ROUTE_MODEL_RULE_DETAILS,{id:n.params.id});r._initRuleDetails(n.params).then(function q(){var u=d.getDependency("RuleDetailsStatePresenter");u.fetchData()},function s(){console.log("[xModelRouterConfig:ROUTE_MODEL_RULE_DETAILS] Activation failed!!!")})},deactivate:function(r){console.log("de-activating RuleDetails");var q=d.getDependency("xModelApp");var p=d.getDependency("modelsStatePresenter");q.clearContent();p._initModelDetails();var o=d.getDependency("InformationPanelManager");o.setContext(r.name,{id:r.params.id});if(r.params.name){if(r.params.isRefresh){var n=e.getRouteInfo();if(n&&n.params.modelId){UWA.extend(r.params,{id:n.params.modelId,name:n.params.modelName,version:n.params.modelVersion})}}else{var n={name:f.ROUTE_MODEL_DETAILS,params:{modelId:r.params.id,modelName:r.params.name,modelVersion:r.params.version,}};e.setRouteInfo(n)}widget.setTitle(r.params.name)}var l=d.getDependency("RuleDetailsStatePresenter");if(l){l.destroy();d.setDependency("RuleDetailsPresenter",null)}if(r.params.refreshPCList){var m=d.getDependency("modelDetailsStatePresenter");m._localRulesPresenter.loadData()}}};j[f.ROUTE_MODEL_PC_DETAILS]={activate:function(s){console.log("activating PCDetails");s.params=s.params||{};if(s.params.isRefresh){var m=e.getRouteInfo();if(m&&m.params.pcId){UWA.extend(s.params,{id:m.params.pcId,name:m.params.pcName,version:null})}}else{if(s.params&&s.params.id){var m=e.getRouteInfo();m.name=f.ROUTE_MODEL_PC_DETAILS;m.params.pcId=s.params.id;m.params.pcName=s.params.name;e.setRouteInfo(m)}}var n=d.getDependency("applicationChannel");var l=d.getDependency("modelDetailsStatePresenter");var p=d.getDependency("InformationPanelManager");s.params.parentID=l._id;var r=widget.getTitle();widget.setTitle(s.params.name);l._initPCDetails(s.params);var q=d.getDependency("PCDetailsStatePresenter");q.fetchData();var o={linkID:f.ROUTE_MODEL_PC_DETAILS,linkText:s.params.name,additionalData:{id:s.params.id,name:s.params.name,parentID:l._id}};n.publish({event:"breadcrumb-add-link",data:o});p.setContext(f.ROUTE_MODEL_PC_DETAILS,{id:s.params.id})},deactivate:function(r){console.log("de-activating PCDetails");var q=d.getDependency("xModelApp");var o=d.getDependency("modelsStatePresenter");q._applicationChannel.publish({event:"triptych-hide-panel",data:"left"});q.clearContent();o._initModelDetails();var n=d.getDependency("InformationPanelManager");n.setContext(r.name,{id:r.params.id});if(r.params.name){if(r.params.isRefresh){var m=e.getRouteInfo();if(m&&m.params.modelId){UWA.extend(r.params,{id:m.params.modelId,name:m.params.modelName,version:m.params.modelVersion})}}else{var m={name:f.ROUTE_MODEL_DETAILS,params:{modelId:r.params.id,modelName:r.params.name,modelVersion:r.params.version,}};e.setRouteInfo(m)}widget.setTitle(r.params.name)}var p=d.getDependency("PCDetailsStatePresenter");p.destroy();d.setDependency("PCDetailsStatePresenter",null);if(r.params.refreshPCList){var l=d.getDependency("modelDetailsStatePresenter");l._PCListPresenter.loadData()}}};j[f.ROUTE_MODEL_DOC_DETAILS]={activate:function(r){console.log("activating docDetails");r.params=r.params||{};if(r.params.isRefresh){var m=e.getRouteInfo();if(m&&m.params.docId){UWA.extend(r.params,{id:m.params.docId,name:m.params.docName,version:m.params.docVersion})}}else{if(r.params&&r.params.id){var m=e.getRouteInfo();m.name=f.ROUTE_MODEL_DOC_DETAILS;m.params.docId=r.params.id;m.params.docName=r.params.name;m.params.docVersion=r.params.version;e.setRouteInfo(m)}}var n=d.getDependency("applicationChannel");var l=d.getDependency("modelDetailsStatePresenter");var p=d.getDependency("InformationPanelManager");r.params.parentID=l._id;currentTitle=widget.getTitle();widget.setTitle(r.params.name);l._initDocDetails(r.params);var q=d.getDependency("DocDetailsPresenter");q.fetchData();var o={linkID:f.ROUTE_MODEL_DOC_DETAILS,linkText:r.params.name,additionalData:{id:l._id}};n.publish({event:"breadcrumb-add-link",data:o});p.setContext(f.ROUTE_MODEL_DOC_DETAILS,{id:r.params.id})},deactivate:function(q){console.log("de-activating DOCDetails");var p=d.getDependency("xModelApp");var n=d.getDependency("modelsStatePresenter");p.clearContent();n._initModelDetails();var m=d.getDependency("InformationPanelManager");m.setContext(q.name,{id:q.params.id});if(q.params.name){if(q.params.isRefresh){var l=e.getRouteInfo();if(l&&l.params.modelId){UWA.extend(q.params,{id:l.params.modelId,name:l.params.modelName,version:l.params.modelVersion})}}else{var l={name:f.ROUTE_MODEL_DETAILS,params:{modelId:q.params.id,modelName:q.params.name,modelVersion:q.params.version,}};e.setRouteInfo(l)}widget.setTitle(q.params.name)}var o=d.getDependency("DocDetailsPresenter");o.destroy();d.setDependency("docDetailsPresenter",null);var r=d.getDependency("DocPresenter");if(r){r.publishTags();r._myDocPresenter.render()}}};for(var h in j){if(j.hasOwnProperty(h)){d.addRouteMethods(h,j[h])}}}};return c});define("DS/ENOXModelApp/LandingPage/LandingPageStatePresenter",["DS/Handlebars/Handlebars","DS/CoreEvents/ModelEvents","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/Controls/Accordeon","DS/Controls/Expander","DS/UIKIT/Mask","DS/CollectionView/ResponsiveTilesCollectionView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/TreeModel/DataModelSet","UWA/Element","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/ModelDefinition/js/DuplicateModelPresenter","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/components/DialogCreation/DialogCreation_ModelVersion","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra","DS/WebappsUtils/WebappsUtils","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelCommand","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/ModelsStatePresenter","i18n!DS/ENOXModelApp/assets/nls/LandingPage/LandingPageStatePresenter","css!DS/ENOXModelApp/LandingPage/LandingPage.css"],function(Handlebars,ModelEvents,ENOXDataDragAndDrop,CommonInfoPresenter,WebUXAccordeon,WUXExpander,Mask,ResponsiveTilesCollectionView,TreeDocument,TreeNodeModel,DataModelSet,_uwa_element,XModelListView,XModelListViewDataExtension,XModelListViewTaggerExtension,xNotificationsUtil,xPortfolioModel,xEnterpriseDictionary,xPflRouter,xModelAppGlobalConfig,InformationPanelManager,DuplicateModelPresenter,DialogDeletion,DialogCreation_ModelVersion,xPortfolioInfra,WebappsUtils,xModelPreferencesConstant,xModelPreferences,xModelAppGlobalVariable,xModelCommonUtils,xModelCommand,nls_xModelCommon,nls_Models,nls_LP,_css_LandingPAge){var LandingPageStatePresenter=function(appChannel,options){this.init(appChannel,options)};LandingPageStatePresenter.prototype.init=function(applicationChannel,options){var that=this;this._pathMyModel=[xModelPreferencesConstant._KEY,xModelPreferencesConstant._VIEWS_PREFERENCES,xModelPreferencesConstant._MY_MODEL_VERSIONS];this._namePage="home";this._tagActivated=true;this._applicationChannel=applicationChannel;this._privateChannel=new ModelEvents();this._updateChannelLocal=new ModelEvents();this._updateChannelLocal_recent=new ModelEvents();this._dataDragAndDropModelevent=new ModelEvents();this._initView(this._applicationChannel);this._subscribeToEvents()};LandingPageStatePresenter.prototype._initView=function(applicationChannel){var infoPanelOptions={applicationChannel:applicationChannel,context:this._namePage};InformationPanelManager.initialize(infoPanelOptions);this.itemSelected=undefined;this._initDivs();this._initCommand();this._initExpander();this._initRecentListView();this._initMyModelListView();this._initDragDropSupport()};LandingPageStatePresenter.prototype._getDNDDetails=function(type,id,displayType){var serviceId=this.dnd_map[type]?this.dnd_map[type].serviceId:"";var path=this.dnd_map[type]?this.dnd_map[type].path:"";if(serviceId&&path){xNotificationsUtil.showSuccess(nls_LP._opening+" "+displayType);serviceId({id:id}).then(function success(data){xPflRouter.navigate(path,{id:data.member[0].id,name:data.member[0].title,version:data.member[0].revision})},function fail(data){console.error(nls_LP._service_failure)})}else{xNotificationsUtil.showError("'"+displayType+"' "+nls_LP._type_not_supported)}};LandingPageStatePresenter.prototype._setDNDMap=function(type,id){this.dnd_map={Products:{serviceId:xPortfolioModel.getModelDetails,path:xModelAppGlobalConfig.ROUTE_MODEL_DETAILS},Variant:{serviceId:xEnterpriseDictionary.getVariantClassDetails,path:xModelAppGlobalConfig.ROUTE_DICTIONARY_VARIANT_DETAILS}}};LandingPageStatePresenter.prototype._initDragDropSupport=function(){var that=this;this._setDNDMap();this._dragdropInstance=new ENOXDataDragAndDrop({droppableAreas:[this._container],modelEvents:this._dataDragAndDropModelevent})};LandingPageStatePresenter.prototype._subscribeToEvents=function(){var that=this;this._dataDragAndDropModelevent.subscribe({event:"onDrop"},function(droppedData){var evtData=droppedData.data;if(evtData&&evtData.data&&evtData.data.items){if(evtData.data.items.length>1){xNotificationsUtil.showError(nls_LP._multi_object_not_supported)}else{var model=evtData.data.items[0];if(model){var displayType=model.displayType||model.objectType||"";var type=model.objectType||"";that._getDNDDetails(type.trim(),model.objectId,displayType)}else{xNotificationsUtil.showError(nls_LP._no_drag_data)}}}else{xNotificationsUtil.showError(nls_LP._type_not_supported)}});this._updateChannelLocal.subscribe({event:"xmodel-list-item-on-dblclick"},function(evtData){var model=evtData.model;console.log("Double click event item id: "+model);xPflRouter.navigate(xModelAppGlobalConfig.ROUTE_MODEL_DETAILS,{id:model.id,name:model.title,version:model.version?model.version:model.revision?model.revision:"",state:model.maturity})});this._updateChannelLocal_recent.subscribe({event:"xmodel-list-item-on-dblclick"},function(evtData){var model=evtData.model;console.log("Double click event item id: "+model);xPflRouter.navigate(xModelAppGlobalConfig.ROUTE_MODEL_DETAILS,{id:model.id,name:model.title,version:model.version?model.version:model.revision?model.revision:"",state:model.state})});[this._updateChannelLocal,this._updateChannelLocal_recent].forEach(function(_localChannel){_localChannel.subscribe({event:"xmodel-list-data-item-need-refresh"},function(itemId){console.log("----- Refresh ListView LandingPage from Channels -----");that._refreshListView(_localChannel,itemId,this)})});this._applicationChannel.subscribe({event:"xmodel-list-data-item-need-refresh"},function(itemId){console.log("----- Refresh ListView LandingPage ChannelLocalRecent and ChannelLocal -----");that._refreshListView(that._updateChannelLocal,itemId);that._refreshListView(that._updateChannelLocal_recent,itemId)});[this._updateChannelLocal,this._updateChannelLocal_recent].forEach(function(_localChannel){_localChannel.subscribe({event:"xmodel-list-item-on-add-selection"},function(evtData){console.log("----- Add Item InformationPanel from Channels -----");var model=evtData.model;that._addSelectionModels(model.id,_localChannel);that.itemSelected=model})});this._updateChannelLocal.subscribe({event:"list-view-update-inline-action"},function(evtData){if(evtData&&evtData.model&&evtData.name&&evtData.value!=undefined){var modelVersion=evtData.model[0];var nodeModel=evtData.cell.nodeModel;var icon={icons:[WebappsUtils.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};nodeModel.updateOptions(icon);that._editionModel(modelVersion,evtData.name,evtData.value.trim());if(modelVersion.isRoot){that._editionModelRoot(modelVersion,evtData.name,evtData.value.trim())}}});this._updateChannelLocal.subscribe({event:"xmodel-list-item-on-link-click"},function(evtData){that._updateChannelLocal.publish({event:"xmodel-execute-command",data:evtData})});this._updateChannelLocal.subscribe({event:"model-version-action-open"},function(item){that.navigateToModel(item.id)});this._updateChannelLocal.subscribe({event:"version-explorer-new-version-created"},function(item){var id=item.id;xPortfolioModel.getModelDetails({id:id}).then(function(data){console.log("getModelDetails: Service Call Successful !!!");var dataItem=data.member[0];if(dataItem&&dataItem.maturity==undefined&&dataItem.state!=undefined){dataItem.maturity=dataItem.state}that._updateChannelLocal.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(createdNode){createdNode.select()});that._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:dataItem});that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});console.log("getModelDetails: Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.GET_MODEL_DETAILS_ERROR)})});this._updateChannelLocal.subscribe({event:"enox-dialog-creation"},function(data){that._createModel(data.content)});[this._updateChannelLocal,this._updateChannelLocal_recent].forEach(function(_localChannel){_localChannel.subscribe({event:"enox-dialog-delete"},function(evtData){console.log("----- Delete Model from Channels -----");var listChannel=[that._updateChannelLocal,that._updateChannelLocal_recent];that._listDeleteModels(evtData,listChannel)})});[this._updateChannelLocal,this._updateChannelLocal_recent].forEach(function(_localChannel){_localChannel.subscribe({event:"xmodel-list-item-on-remove-selection"},function(evtData){console.log("----- Remove Item InformationPanel from Channels -----");var model=evtData.model;InformationPanelManager.removeSelection(model.id,that._namePage)});_localChannel.subscribe({event:"xmodel-list-tagger-on-setup"},function(){if(!that._tagActivated){_localChannel.publish({event:"xmodel-list-tagger-deactivate-action"})}})});this._updateChannelLocal_recent.subscribe({event:"xmodel-list-item-on-empty-selection"},function(evtData){InformationPanelManager.removeAllSelection("recentModelVersions")});this._updateChannelLocal.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(evtData){xModelPreferences.updateView(that._pathMyModel,evtData)});this._updateChannelLocal.subscribe({event:"enox-collection-toolbar-sort-activated"},function(evtData){xModelPreferences.updateSort(that._pathMyModel,evtData)})};LandingPageStatePresenter.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("xmodel-landingpage")};LandingPageStatePresenter.prototype._initCommand=function(){this._command=new xModelCommand(this._updateChannelLocal,this._container);var that=this;this._updateChannelLocal.subscribe({event:"model-version-action-create-new-revision"},function(evtData){if(evtData){xPortfolioModel.createModelVersion({sourceObjectID:evtData.id,intent:"Evolution",attributes:{name:evtData.name,revision:"",description:"",title:evtData.title}}).then(function(data){that._updateChannelLocal.publish({event:"refresh-version-explorer-on-create-revision"});that._updateChannelLocal.publish({event:"version-explorer-new-version-created",data:{id:data.value}})},function(data){console.log("CreateModelVersion for revise: Service Call Failed !!!");xNotificationsUtil.showError("Create Model Revision Service call failed")})}})};LandingPageStatePresenter.prototype._initExpander=function(){this._recentMVsContainer=UWA.createElement("div");this._recentMVsContainer.classList.add("recent-mvs");this._myMVsContainer=UWA.createElement("div");this._myMVsContainer.classList.add("my-mvs");var headerRecentMVs=nls_LP._recent_mvs;var headerMyMVs=nls_LP._my_mvs;this._expander1=new WUXExpander({style:"simple",header:headerRecentMVs,body:this._recentMVsContainer,allowUnsafeHTMLHeader:false,expandedFlag:true});this._expander1.inject(this._container);this._container.appendChild(this._myMVsContainer);var that=this;this._expander1.getContent().addEventListener("collapse",function(){that._myMVsContainer.classList.add("expanded")});this._expander1.getContent().addEventListener("expand",function(){that._myMVsContainer.classList.remove("expanded")})};LandingPageStatePresenter.prototype.inject=function(container){container.appendChild(this._container)};LandingPageStatePresenter.prototype.navigateToModel=function(id){if(id){var that=this;Mask.mask(this._container);xPortfolioModel.getModelDetails({id:id}).then(function(data){console.log("getModelDetails: Service Call Successful");var name=data.member[0].name;var version=data.member[0].revision;Mask.unmask(that._container);xPflRouter.navigate(xModelAppGlobalConfig.ROUTE_MODEL_DETAILS,{id:id,name:name,version:version},{reload:true})},function(data){Mask.unmask(that._container);console.log("getModelDetails: Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.GET_MODEL_DETAILS_ERROR)})}};LandingPageStatePresenter.prototype.loadData=function(){var that=this;that._updateChannelLocal_recent.publish({event:"xmodel-list-data-on-load-start"});var succ=function(data){var data=decodeURIComponent(data);console.log("--- list of recent ids ---");console.log(data);console.log("--------------------------");console.log(data.length);data=data?eval(data):[];for(var i=0,length=data.length;i<length;i++){if(data[i]==null){data.splice(i,1)}}if(data.length>0){xPortfolioInfra.getModelVersionsFromIds(data,function(output){if(output&&output.member){that._updateChannelLocal_recent.publish({event:"xmodel-list-data-load-action",data:output})}that._updateChannelLocal_recent.publish({event:"xmodel-list-data-on-load-complete"})},function(err_){console.log("bouuuug");that._updateChannelLocal_recent.publish({event:"xmodel-list-data-on-load-complete"})})}else{that._updateChannelLocal_recent.publish({event:"xmodel-list-data-on-load-complete"})}};var fail=function(){console.log("meeh")};xPortfolioInfra.recentItemsIds(succ,fail);that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});xPortfolioModel.getMyModelVersions().then(function success(data){var dataForModel={member:[]};for(var i=0;i<data.items.member.length;i++){var temp={};for(var key in data.items.member[i]["@attributes"]){if(data.items.member[i]["@attributes"].hasOwnProperty(key)){temp[key.substring("attr_".length)]=data.items.member[i]["@attributes"][key]}}dataForModel.member.push(temp);dataForModel.member[i]["@id"]=data.items.member[i]["@id"];dataForModel.member[i]["revision"]=data.items.member[i]["@attributes"]["attr_version"]}that._updateChannelLocal.publish({event:"xmodel-list-data-load-action",data:dataForModel});that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});that._updateChannelLocal.publish({event:"enox-collection-toolbar-sort-activated",data:xModelPreferences.getSort(that._pathMyModel)})},function fail(data){console.log(" : On Failure: "+data);xNotificationsUtil.showError(nls_Models.GET_MODELS_ERROR);that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})};LandingPageStatePresenter.prototype.createDeleteModelDialog=function(listModel,channel){var options={listItems:listModel,type:"delete",single:nls_Models.MODEL,multiple:nls_Models.MODELS,modelEvent:channel,immersiveFrame:xModelAppGlobalVariable.getImmersiveFrame()};var dialog=new DialogDeletion(options)};LandingPageStatePresenter.prototype.createCreationModelDialog=function(immersiveFrame,channel){DialogCreation_ModelVersion.createDialogCreationModelVersion(immersiveFrame,channel)};LandingPageStatePresenter.prototype.duplicateModelAction=function(model){console.log("duplicateModelAction");var name=model.revision?model.title+" ("+model.revision+")":model.title;var that=this;DuplicateModelPresenter.show({name:name},function(duplicateOptions){UWA.merge(duplicateOptions,{parentID:model.id});that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});xPortfolioModel.duplicateModelVersion(duplicateOptions).then(function(data){var valueId=data.value;if(!valueId){if(data.member&&data.member.length>0){valueId=data.member[0]["id"]}}xPortfolioModel.getModelDetails({id:valueId}).then(function(data){console.log("getModelDetails: Service Call Successful !!!");var attributes={};for(var key in data.member[0]){if(data.member[0].hasOwnProperty(key)){attributes[key]=data.member[0][key]}}var dataItem=attributes;if(dataItem&&dataItem.maturity==undefined&&dataItem.state!=undefined){dataItem.maturity=dataItem.state}that._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:dataItem});that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){console.log("getModelDetails: Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.GET_MODEL_DETAILS_ERROR);that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})},function(){xNotificationsUtil.showError(nls_Models.DUPLICATE_MODEL_ERROR);that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})})};LandingPageStatePresenter.prototype.destroy=function(){if(this._container&&this._container.parentElement){this._container.parentElement.removeChild(this._container)}this._tilesView.destroy();this._xModelListView.destroy();this._tagActivated=false};LandingPageStatePresenter.prototype._initRecentListView=function(){var that=this;var dataModelSet=new DataModelSet();this._model_recentmvs=new TreeDocument({dataModelSet:dataModelSet});var listViewOptions_recent={id:"recentModelVersions",model:this._model_recentmvs,useDragAndDrop:true,modelEvents:this._updateChannelLocal_recent,viewOptions:{views:["TileView"],currentView:"TileView",itemViewMapping:{label:function(nodeModel){return nodeModel.options.grid.title+" "+nodeModel.options.grid.revision},subLabel:"state",description:"description"},contextualActions:[{id:"open",title:nls_LP._open,text:nls_LP._open,fonticon:"export",handler:function(model){console.log("item clicked");xPflRouter.navigate(xModelAppGlobalConfig.ROUTE_MODEL_DETAILS,{id:model.id,name:model.title,version:model.version?model.version:model.revision?model.revision:"",state:model.state})}},{id:"information",title:nls_LP._information,text:nls_LP._information,fonticon:"info",handler:function(model){InformationPanelManager.showInformation(model.id)}},{id:"delete",title:nls_LP._delete,text:nls_LP._delete,fonticon:"trash",handler:function(model){if(model){var mapForDialog=[{id:model.id,title:model.title}];that.createDeleteModelDialog(mapForDialog,that._updateChannelLocal_recent)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:nls_LP._no_recent_items}]},withToolBar:false,extensions:[XModelListViewDataExtension,XModelListViewTaggerExtension]};this._tilesView=new XModelListView(listViewOptions_recent);this._tilesView.inject(this._recentMVsContainer);this._updateChannelLocal_recent.publish({event:"xmodel-list-tagger-update-friend-tags-action",data:["myModelVersions"]})};LandingPageStatePresenter.prototype._initMyModelListView=function(){var that=this;var dataModelSet=new DataModelSet();var model=new TreeDocument({dataModelSet:dataModelSet});var sortPreference=xModelPreferences.getSort(this._pathMyModel);if(sortPreference&&sortPreference.sortAttribute&&sortPreference.sortOrder){var reformateCurrentSort={id:sortPreference.sortAttribute,order:sortPreference.sortOrder}}var listViewOptions_my={id:"myModelVersions",model:model,modelEvents:this._updateChannelLocal,useDragAndDrop:true,dropableAreas:that._container,dataDragAndDropModelevent:that._dataDragAndDropModelevent,viewOptions:{identifier:"my_modelversions",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],currentView:xModelPreferences.getView(this._pathMyModel)||"DataGridView",currentSort:reformateCurrentSort||undefined,grid:{columns:[{text:nls_xModelCommon.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true},{text:nls_xModelCommon.NAME,dataIndex:"name",},{text:nls_xModelCommon.VERSION,dataIndex:"revision",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(cellInfos){return{label:cellInfos.nodeModel.options.grid.revision,url:"#Revision"}}},{text:nls_xModelCommon.DESCRIPTION,dataIndex:"description",editableFlag:true},{text:nls_xModelCommon.MATURITY,dataIndex:"maturity",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(cellInfos){return{label:cellInfos.nodeModel.options.grid.maturity,url:"#Maturity"}}},{text:nls_xModelCommon.OWNER,dataIndex:"owner",getCellValue:function(cellInfos){return{label:cellInfos.nodeModel.options.grid.owner?cellInfos.nodeModel.options.grid.owner:cellInfos.nodeModel.options.grid.responsible,url:"#Owner"}},visibleFlag:true,typeRepresentation:"url",hyperlinkTarget:"_self"},{text:nls_xModelCommon.CREATION_DATE,dataIndex:"created",},],defaultColumnDef:{width:"auto",typeRepresentation:"string"}},itemViewMapping:{label:"title",subLabel:"maturity",description:"description"},contextualActions:[{id:"open",title:nls_LP._open,text:nls_LP._open,fonticon:"export",handler:function(model){console.log("item clicked");xPflRouter.navigate(xModelAppGlobalConfig.ROUTE_MODEL_DETAILS,{id:model.id,name:model.title,version:model.version?model.version:model.revision?model.revision:"",state:model.maturity})}},{id:"information",title:nls_LP._information,text:nls_LP._information,fonticon:"info",handler:function(model){InformationPanelManager.showInformation(model.id)}},{id:"delete",title:nls_LP._delete,text:nls_LP._delete,fonticon:"trash",handler:function(model){if(model){var mapForDialog=[{id:model.id,title:model.title}];that.createDeleteModelDialog(mapForDialog,that._updateChannelLocal)}}}],editable:true},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:nls_xModelCommon.EMPTY_CONTENT_MESSAGE}]},toolbarOptions:{itemsName:nls_LP._myModelVersions,itemName:nls_LP._myModelVersion,actions:[{id:"create",text:nls_LP._create,fonticon:"plus",handler:function(e,i){console.log(that);that.createCreationModelDialog(xModelAppGlobalVariable.getImmersiveFrame(),that._updateChannelLocal)}},{id:"delete",text:nls_LP._delete,fonticon:"trash",enableOnSelection:true,handler:function(dataItems,i){console.log("Delete from toolbar trash action..");var mapForDialog=dataItems.map(function(dataItem){return{id:dataItem.id,title:dataItem.label}});that.createDeleteModelDialog(mapForDialog,that._updateChannelLocal)}}]},extensions:[XModelListViewDataExtension,XModelListViewTaggerExtension]};this._xModelListView=new XModelListView(listViewOptions_my);this._xModelListView.inject(this._myMVsContainer);this._updateChannelLocal.publish({event:"xmodel-list-tagger-update-friend-tags-action",data:["recentModelVersions"]})};LandingPageStatePresenter.prototype._addSelectionModels=function(selectedItems,channel){var that=this;if(selectedItems){if(channel===this._updateChannelLocal){that._updateChannelLocal_recent.publish({event:"xmodel-list-item-on-unselect-all"})}else{that._updateChannelLocal.publish({event:"xmodel-list-item-on-unselect-all"})}InformationPanelManager.addSelection(selectedItems,that._namePage)}};LandingPageStatePresenter.prototype._listDeleteModels=function(selectedItems,channel){var that=this;var itemsToBeDeleted=selectedItems;console.log("---------- Call Method listDeleteModels ---------------");if(itemsToBeDeleted){xPortfolioModel.deleteModelVersions({ids:itemsToBeDeleted}).then(function success(data){for(var i=0,len=channel.length;i<len;i++){channel[i].publish({event:"xmodel-list-data-item-remove-action",data:itemsToBeDeleted})}console.log("---------- End Method listDeleteModels Success ---------------")},function fail(data){xNotificationsUtil.showError(nls_Models.DELETE_MODELS_ERROR);console.log("---------- End Method listDeleteModels Fail ---------------")})}};LandingPageStatePresenter.prototype._refreshListView=function(channel,itemId,context){if(itemId!=undefined){var that=this;xPortfolioModel.getModelDetails({id:itemId}).then(function(data){var dataItem=data.member[0]?data.member[0]:{};dataItem.context=context;dataItem.maturity=dataItem.state;channel.publish({event:"xmodel-list-data-item-update-action",data:dataItem});InformationPanelManager.removeSelection(dataItem.id,that._namePage);InformationPanelManager.addSelection(dataItem.id,that._namePage)},function(){})}};LandingPageStatePresenter.prototype._createModel=function(data){var valueId;var that=this;if(data){var name=data.title?data.title:""}var parameters={items:[{type:"",versionName:"",attributes:{name:"",description:"",title:name}}]};that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});xPortfolioModel.createModel(parameters).then(function success(data){valueId=data.value;if(!valueId){if(data.member&&data.member.length>0){valueId=data.member[0]["id"]}}console.log("Created model Id is: "+valueId);xPortfolioModel.getModelDetails({id:valueId}).then(function(data){console.log("getModelDetails: Service Call Successful !!!");var dataItem=data.member[0];if(dataItem&&dataItem.maturity==undefined&&dataItem.state!=undefined){dataItem.maturity=dataItem.state}that._updateChannelLocal.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(createdNode){createdNode.select()});that._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:dataItem});that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});console.log("getModelDetails: Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.GET_MODEL_DETAILS_ERROR)})},function fail(data){that._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});console.log("createModel: Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.CREATE_MODEL_ERROR)})};LandingPageStatePresenter.prototype._editionModelRoot=function(model,name,value){var that=this;if(model&&name&&value){var valueToChange={};valueToChange[name]=value;xPortfolioModel.getModelDetails({id:model.id}).then(function(data){var modelId=data.member[0].modelID;xPortfolioModel.patchModel(modelId,valueToChange).then(function success(dataItem){console.log("LandingPage _editionModelRoot : Service Call Success !!!")},function fail(data){console.log("LandingPage _editionModelRoot : Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.PATCH_MODEL_ERROR)})},function(){console.log("getModelDetails _editionModelRoot : Service Call Failed !!!");xNotificationsUtil.showError(nls_Models.GET_MODEL_DETAILS_ERROR)})}};LandingPageStatePresenter.prototype._editionModel=function(model,name,value){var that=this;if(model&&name&&value){var data={};data[name]=value;xPortfolioModel.patchModelVersion(model.id,data).then(function success(dataItem){console.log("LandingPage editionModel : Service Call Success !!!");that._updateChannelLocal.publish({event:"xmodel-list-data-item-update-action",data:dataItem.member[0]});that._updateChannelLocal_recent.publish({event:"xmodel-list-data-item-update-action",data:dataItem.member[0]});if(that._xModelListView._getSelectedItem()[0]){var selectedItem=that._xModelListView._getSelectedItem()[0].id}var model=dataItem.member[0].id;InformationPanelManager.removeSelection(model);InformationPanelManager.addSelection(selectedItem)},function fail(data){console.log("LandingPage editionTitle : Service Call Failed !!!");that._updateChannelLocal.publish({event:"xmodel-list-data-item-update-action",data:model});xNotificationsUtil.showError(nls_Models.PATCH_MODEL_ERROR)})}};LandingPageStatePresenter.prototype.clearTags=function(){this._updateChannelLocal.publish({event:"xmodel-list-tagger-deactivate-action"});this._updateChannelLocal_recent.publish({event:"xmodel-list-tagger-deactivate-action"});this._tagActivated=false};return LandingPageStatePresenter});define("DS/ENOXModelApp/ModelDefinition/js/LocalRulesPresenter",["DS/ENOXSplitView/js/ENOXSplitView","DS/UIKIT/Mask","DS/UIKIT/DropdownMenu","DS/CoreEvents/ModelEvents","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/xPflRouter5/xPflRouter","DS/WebappsUtils/WebappsUtils","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/components/DialogCreation/DialogCreation_Rule","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/LocalRulesPresenter","css!DS/ENOXModelApp/ModelDefinition/css/LocalRules.css"],function(g,x,p,q,a,k,v,w,o,c,b,y,f,d,e,h,n,m,j,s,u,r,t,l){var i=function(){};i.prototype.init=function(D,B,C,A){this._pathRules=[h._KEY,h._VIEWS_PREFERENCES,h._MODEL_VERSIONS_DETAILS,h._RULES];this._isDestroyed=false;this._privateChannel=D?D:new q();this._applicationChannel=B;this._splitViewChannel=C;this._updateChannelLocal=new q();this._myEventManager=new e(this._updateChannelLocal,this._splitViewChannel,this._applicationChannel,this._privateChannel);this._id=A.id;this._editable=A.editable;this._disable=!A.editable;this._namePage="Rules";o.initialize({applicationChannel:this._applicationChannel,id:this._id,context:this._namePage});this._listPresenter=null;this._initializeListView();var z={modelEvents:this._privateChannel,withtransition:true,noPublishOnCreate:true,withoverflowhidden:false,params:{leftWidth:40,leftVisible:true,rightVisible:false,rightMaximizer:true,leftMaximizer:true}};this._splitView=new g();this._splitView.init(z);this._initDivs();this._initCommand();this._subscribeToEvents()};i.prototype._initCommand=function(){this._command=new c(this._privateChannel,this._container)};i.prototype._initializeListView=function(){var B=this;var C=n.getSort(this._pathRules);if(C&&C.sortAttribute&&C.sortOrder){var z={id:C.sortAttribute,order:C.sortOrder}}var A={id:"localRules",modelEvents:this._privateChannel,useDragAndDrop:true,viewOptions:{identifier:"local_rules",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],currentView:n.getView(this._pathRules)||"DataGridView",currentSort:z||undefined,grid:{columns:[{text:r.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true,},{text:r.NAME,dataIndex:"name",},{text:r.DESCRIPTION,dataIndex:"description",editableFlag:true,},{text:r.TYPE,dataIndex:"ruleType",},{text:r.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(D){return{label:D.nodeModel.options.grid.state,url:"#Maturity"}}},{text:r.OWNER,dataIndex:"owner",visibleFlag:true,getCellValue:function(D){return{label:D.nodeModel.options.grid.owner?D.nodeModel.options.grid.owner:D.nodeModel.options.grid.responsible,url:"#Owner"}},typeRepresentation:"url",hyperlinkTarget:"_self"},{text:r.CREATION_DATE,dataIndex:"created",},{text:r.MODIFICATION_DATE,dataIndex:"modified",},{text:r.ORGANIZATION,dataIndex:"organization",}]},editable:true,itemViewMapping:{label:function(D){return D.options.grid.title},subLabel:"ruleType",description:"description"},contextualActions:[{id:"open",title:t._open,text:t._open,fonticon:"export",handler:function(D){console.log("item clicked");y.navigate(b.ROUTE_MODEL_RULE_DETAILS,{id:D.id,name:D.name})}},{id:"information",title:t._information,text:t._information,fonticon:"info",handler:function(D){o.showInformation(D.id)}},{id:"delete",title:t._delete,text:t._delete,fonticon:"trash",state:this._disable?"disabled":"enabled",handler:function(D){if(D){var E=[{id:D.id,title:D.title}];B.createDeleteModelDialog(E,B._privateChannel)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:r.EMPTY_CONTENT_MESSAGE}]},toolbarOptions:{itemsName:t._ruleMultiple,itemName:t._ruleSingle,actions:[{id:"preview",text:t._preview,fonticon:"eye",allowSelectRetain:true,handler:function(D){B._privateChannel.publish({event:"on-preview",data:{activated:D}})}},{id:"create",text:t._create,fonticon:"plus",disabled:this._disable,content:[{id:"MatrixRule",text:t._matrix_rule,selectable:false,handler:function(){B.typeRuleCreation="table";B.createCreationModelDialog(s.getImmersiveFrame(),B._privateChannel,"table")}},{id:"ExpressionRule",text:t._expression_rule,selectable:false,handler:function(){B.typeRuleCreation="expression";B.createCreationModelDialog(s.getImmersiveFrame(),B._privateChannel,"expression")}}],handler:function(){console.log("clicked on plus")}},{id:"delete",text:t._delete,fonticon:"trash",disabled:this._disable,enableOnSelection:!this._disable,handler:function(D,E){console.log("delete action..");var F=D.map(function(G){return{id:G.id,title:G.label}});B.createDeleteModelDialog(F,B._privateChannel)}}]},extensions:[k,v]};this._listPresenter=new a(A)};i.prototype._subscribeToEvents=function(){var z=this;this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-link-click"},function(A){z._privateChannel.publish({event:"xmodel-execute-command",data:A})});this._myEventManager.subscribe(this._privateChannel,{event:"enox-dialog-delete"},function(A){z.deleteRules(A)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-dialog-creation"},function(A){z.createRule(A.content,z.typeRuleCreation)});this._myEventManager.subscribe(this._privateChannel,{event:"set-rule-editable"},function(A){if(A){z._privateChannel.publish({event:"enox-collection-toolbar-enable-action",data:"create"})}else{z._privateChannel.publish({event:"enox-collection-toolbar-disable-action",data:"create"})}z._editable=A;z._disable=!z._editable});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-add-selection"},function(A){var B=A.model;o.addSelection(B.id)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-remove-selection"},function(A){var B=A.model;o.removeSelection(B.id)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-item-on-empty-selection"},function(A){o.removeAllSelection()});this._myEventManager.subscribe(this._applicationChannel,{event:"xmodel-list-data-item-need-refresh"},function(A){z._refreshListView(z._privateChannel,A)});this._myEventManager.subscribe(this._privateChannel,{event:"xmodel-list-data-item-need-refresh"},function(A){z._refreshListView(z._privateChannel,A,this)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-collection-toolbar-switch-view-activated"},function(A){n.updateView(z._pathRules,A)});this._myEventManager.subscribe(this._privateChannel,{event:"enox-collection-toolbar-sort-activated"},function(A){n.updateSort(z._pathRules,A)});this._myEventManager.subscribe(this._privateChannel,{event:"list-view-update-inline-action"},function(A){if(A&&A.model&&A.name&&A.value!=undefined){var C=A.model[0];var D=A.cell.nodeModel;var B={icons:[f.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};D.updateOptions(B);z._editionRule(C,A.name,A.value.trim())}})};i.prototype._editionRule=function(E,A,D){var B=this;if(E&&A&&D){var C={};C[A]=D;w.patchRule(E.id,C).then(function F(G){console.log("LocalRulesPresenter editionRule : Service Call Success !!!");B._privateChannel.publish({event:"xmodel-list-data-item-update-action",data:G.member[0]});if(B._listPresenter._getSelectedItem()[0]){var I=B._listPresenter._getSelectedItem()[0].id}var H=G.member[0].id;o.removeSelection(H);o.addSelection(I)},function z(G){console.log("LocalRulesPresenter editionRule : Service Call Failed !!!");B._privateChannel.publish({event:"xmodel-list-data-item-update-action",data:E});u.showError(t.ERROR_PATCH_RULES)})}};i.prototype._refreshListView=function(B,C,z){if(C!=undefined){var A=this;w.getRuleDetails({id:C}).then(function(E){console.log("getRuleDetails: Service Call Successful !!!");if(E&&E.member[0]){var D=E.member[0];D.context=z;B.publish({event:"xmodel-list-data-item-update-action",data:D})}o.removeSelection(D.id,A._namePage);o.addSelection(D.id,A._namePage)},function(){console.log("getRuleDetails: Service Call Failed !!!");u.showError(t.ERROR_GET_RULE_DETAILS)})}};i.prototype._initDivs=function(){var z=this;this._container=UWA.createElement("div");this._container.classList.add("rules-presenter");this._splitView.inject(this._container);this._leftPanel=this._splitView.getLeft();this._rightPanel=this._splitView.getRight();UWA.extendElement(this._leftPanel);UWA.extendElement(this._rightPanel);this._listPresenter.inject(this._leftPanel);this._updateChannelLocal.publish({event:"enox-collection-toolbar-disable-action",data:"delete"})};i.prototype.createRule=function(z,A){console.log();A=A||"table";var B=this;B._privateChannel.publish({event:"xmodel-list-data-on-load-start"});UWA.merge(z,{name:"",description:"",ruleType:A});w.createLocalRule({parentID:this._id,items:[{type:"",versionName:"",attributes:z}]}).then(function(D){var C=D.value;if(!C){if(D.member&&D.member.length>0){C=D.member[0]["id"]}}console.log("rule created "+C);w.getRuleDetails({id:C}).then(function(F){console.log("getRuleDetails: Service Call Successful !!!");var E=F.member[0];B._privateChannel.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(G){G.select()});B._privateChannel.publish({event:"xmodel-list-data-item-add-action",data:E});B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})},function(){console.log("getRuleDetails: Service Call Failed !!!");B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"})})},function(){console.log("rule creation failed");B._privateChannel.publish({event:"xmodel-list-data-on-load-complete"});u.showError(t.ERROR_CREATE_RULE)})};i.prototype.createDeleteModelDialog=function(B,C){var z={listItems:B,type:"delete",single:t._ruleSingle,multiple:t._ruleMultiple,modelEvent:C,immersiveFrame:s.getImmersiveFrame()};var A=new m(z)};i.prototype.createCreationModelDialog=function(B,A,z){j.createDialogCreationRule(B,A,z)};i.prototype.deleteRules=function(z){var A=this;w.deleteRuleVersions({ids:z,modelId:A._id}).then(function(){console.log("rule deleted");A._privateChannel.publish({event:"xmodel-list-data-item-remove-action",data:z})},function(){console.log("rule deletion failed");u.showError(t.ERROR_DELETE_RULE)})};i.prototype.inject=function(z){z.appendChild(this._container)};i.prototype.publishTags=function(){var z=this;z._privateChannel.publish({event:"xmodel-list-tagger-activate-action"})};i.prototype.loadData=function(){var z=this;z._privateChannel.publish({event:"xmodel-list-data-on-load-start"});w.getLocalRuleVersions({id:z._id}).then(function(A){x.unmask(z._container);var B=[];if(UWA.is(A,"array")){B=A}else{if(A.member[0].hasOwnProperty("rules")){B=A.member["0"].rules}}z._privateChannel.publish({event:"xmodel-list-data-load-action",data:B});z._privateChannel.publish({event:"xmodel-list-data-on-load-complete"});z._privateChannel.publish({event:"enox-collection-toolbar-sort-activated",data:n.getSort(z._pathRules)})},function(A){z._privateChannel.publish({event:"xmodel-list-data-on-load-complete"});u.showError(t.ERROR_GET_RULES)})};i.prototype.destroy=function(){this._container=null;this._isDestroyed=true;this.clearTags();if(this._myEventManager){this._myEventManager.cleanup("LocalRulesPresenter");this._myEventManager=null}};i.prototype.clearTags=function(){this._privateChannel.publish({event:"xmodel-list-tagger-deactivate-action"})};return i});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoSubItemsPresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/WebappsUtils/WebappsUtils","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/ENOXTabs/js/ENOXTabs","DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/components/DialogCreation/DialogCreation_Option","DS/ENOXModelApp/components/DialogCreation/DialogCreation_VariantValue","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common"],function(x,n,p,f,m,b,h,u,s,w,k,d,e,c,g,j,v,a,i,q,t,o){var l=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var r=function(){};r.prototype.init=function(C,A,z){var B=this;this.mySettings=UWA.clone(z.settings);this._pathItemsDetail=this.mySettings.appPreferencePath;this._isDestroyed=false;this._options=z;this._currVariantClassId="";this._privateChannel=C?C:new n();this._applicationChannel=A;this._localChannelForListView=new n();this._myEventManager=new e(this._applicationChannel,this._privateChannel,this._localChannelForListView);var y={applicationChannel:this._applicationChannel,context:this.mySettings.infoContext};k.initialize(y);this._listPresenter=null;this._initListView();this._updateChannelLocal=new n();this.tagFriends=this._options.tagFriends;this.tagProxyName=this.mySettings.tagProxyName;this._subscribeToEvents();this._initDOM();this._initCommand();this._privateChannel.publish({event:"enox-collection-toolbar-disable-action",data:"delete"})};r.prototype._initCommand=function(){this._command=new c(this._localChannelForListView,this._container)};r.prototype._initListView=function(){var A=this;var B=j.getSort(this._pathItemsDetail);if(B&&B.sortAttribute&&B.sortOrder){var y={id:B.sortAttribute,order:B.sortOrder}}var z={id:this.mySettings.listViewId||"dicoSubItemPrsntr",modelEvents:this._localChannelForListView,useDragAndDrop:true,viewOptions:{views:this.mySettings.views,currentView:j.getView(this._pathItemsDetail)||"DataGridView",currentSort:y||undefined,grid:{columns:[{text:o.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true,},{text:o.NAME,dataIndex:"name",},{text:o.DESCRIPTION,dataIndex:"description",editableFlag:true},{text:o.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(C){return{label:C.nodeModel.options.grid.state,url:"#Maturity"}}},{text:o.OWNER,dataIndex:"owner",visibleFlag:true,getCellValue:function(C){return{label:C.nodeModel.options.grid.owner?C.nodeModel.options.grid.owner:C.nodeModel.options.grid.responsible,url:"#Owner"}},typeRepresentation:"url",hyperlinkTarget:"_self"},{text:o.CREATION_DATE,dataIndex:"created",},{text:o.MODIFICATION_DATE,dataIndex:"modified",},{text:o.ORGANIZATION,dataIndex:"organization",},]},editable:true,itemViewMapping:{label:"title",subLabel:"state",description:"description"},contextualActions:[{id:"information",title:this.mySettings.NLS.infoCmdTitle,text:this.mySettings.NLS.infoCmdText,fonticon:"info",handler:function(C){k.showInformation(C.id)}},{id:"delete",title:this.mySettings.NLS.deleteCmdTitle,text:this.mySettings.NLS.deleteCmdText,fonticon:"trash",handler:function(C){if(C){var D=[{id:C.id,title:C.title}];A.createDeleteModelDialog(D,A._localChannelForListView)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:this.mySettings.emptyContent.icon,sizeicon:"40px",text:this.mySettings.emptyContent.message,}]},toolbarOptions:{itemsName:this.mySettings.NLS.itemsName,itemName:this.mySettings.NLS.itemName,actions:[{id:"create",text:this.mySettings.NLS.createItemText,fonticon:"plus",handler:function(){console.log("create action");A.createCreationDialog(q.getImmersiveFrame(),A._localChannelForListView,A.mySettings.settingsFor)}},{id:"delete",text:this.mySettings.NLS.deleteCmdText,fonticon:"trash",enableOnSelection:true,handler:function(C){console.log("delete action..");var D=C.map(function(E){return{id:E.id,title:E.label}});A.createDeleteModelDialog(D,A._localChannelForListView)}}]},extensions:[h,u]};this._listPresenter=new b(z)};r.prototype._initDOM=function(){this._container=UWA.createElement("div");this._container.style.width="100%";this._container.style.height="100%";this._titleContainer=UWA.createElement("div");this._titleSpan=UWA.createElement("span");this._titleSpan.innerHTML=this.mySettings.NLS.tabTitle;this._titleContainer.appendChild(this._titleSpan);var A=this;var y={withCloseButton:false,tabs:[{id:"variants",text:this.mySettings.NLS.tabTitle,fonticon:"fonticon fonticon-attributes",allowUnsafeHTMLOnTabButton:false,content:function(B){A._listPresenter.inject(B)}},{text:"",fonticon:"",content:function(B){}}],modelEvents:this._updateChannelLocal,lazyRendering:true,initialSelectedIndex:0};var z=new s(y);z.render().inject(this._container)};r.prototype.loadData=function(C,A){if(!C||C==""||this._currVariantClassId===C){return}this._currVariantClassName=A?A:"";var z=this;z._localChannelForListView.publish({event:"xmodel-list-data-on-load-start"});return m[this.mySettings.serviceHandlers.getSubItems]({id:C}).then(function B(E){var D=[];if(E.member["0"].hasOwnProperty("values")){D=E.member["0"].values}else{if(E.member["0"].hasOwnProperty("options")){D=E.member["0"].options}}z._localChannelForListView.publish({event:"xmodel-list-data-load-action",data:D});z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});z._localChannelForListView.publish({event:"enox-collection-toolbar-sort-activated",data:j.getSort(z._pathItemsDetail)});z._currVariantClassId=C;z.publishTags()},function y(D){z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});z._currVariantClassId="";t.showError(this.mySettings.NLS.getSubItemsError);z.clearTags()})};r.prototype.clearData=function(z,y){this.clearTags()};r.prototype.getContent=function(){return this._container};r.prototype.inject=function(y){y.appendChild(this._container)};r.prototype.destroy=function(){this._container=null;this._isDestroyed=true;this.clearTags();if(this._myEventManager){this._myEventManager.cleanup("EntDicoSubItemsPresenter_"+this.mySettings.settingsFor);this._myEventManager=null}};r.prototype.createCreationDialog=function(A,y,z){switch(z){case"Options":v.createDialogCreationOption(A,y);break;case"VariantValues":a.createDialogCreationVariantValue(A,y);break;default:this._createSubItem()}};r.prototype._createSubItem=function(y){var A;var z=this;z._localChannelForListView.publish({event:"xmodel-list-data-on-load-start"});UWA.merge(y,{name:"",description:""});m[this.mySettings.serviceHandlers.createSubItem]({parentID:z._currVariantClassId,items:[{type:"",versionName:"",attributes:y}]}).then(function(B){A=B.member[0]["id"];m[z.mySettings.serviceHandlers.getSubItemDetails]({id:A}).then(function(D){var C=D.member[0];z._localChannelForListView.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(E){E.select()});z._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:C});z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})},function(C){z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});t.showError(z.mySettings.NLS.getSubItemDetailsError)})},function(B){z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});t.showError(z.mySettings.NLS.createSubItemError)})};r.prototype._subscribeToEvents=function(){var y=this;this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-dialog-creation"},function(z){y._createSubItem(z.content)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-dialog-delete"},function(z){y._deleteSubItem(z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"list-view-update-inline-action"},function(z){if(z&&z.model&&z.name&&z.value!=undefined){var B=z.model[0];var C=z.cell.nodeModel;var A={icons:[f.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};C.updateOptions(A);y._editionHandler(B,z.name,z.value.trim())}});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-link-click"},function(z){y._localChannelForListView.publish({event:"xmodel-execute-command",data:z})});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-add-selection"},function(z){var A=z.model;k.addSelection(A.id,y.mySettings.infoContext)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-remove-selection"},function(z){var A=z.model;k.removeSelection(A.id,y.mySettings.infoContext)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-empty-selection"},function(z){k.removeAllSelection(y.mySettings.infoContext)});this._myEventManager.subscribe(this._applicationChannel,{event:"xmodel-list-data-item-need-refresh"},function(z){y._refreshListView(y._localChannelForListView,z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-data-item-need-refresh"},function(z){y._refreshListView(y._localChannelForListView,z,this)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-switch-view-activated"},function(z){j.updateView(y._pathItemsDetail,z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-sort-activated"},function(z){j.updateSort(y._pathItemsDetail,z)})};r.prototype._editionHandler=function(E,z,C){var A=this;if(E&&z&&C.length>0){var B={};B[z]=C;m[this.mySettings.serviceHandlers.patchSubItem](E.id,B).then(function D(F){console.log("Patch: Service Call Success !!!");A._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:F.member[0]});var G=F.member[0].id;k.removeSelection(G);k.addSelection(G)},function y(F){console.log("Patch: Service Call Failed !!!");A._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:E});t.showError(patchError)})}};r.prototype._refreshListView=function(A,B,y){var z=this;if(B!=undefined){m[this.mySettings.serviceHandlers.getSubItemDetails]({id:B}).then(function(D){console.log("getSubItemDetails: Service Call Successful !!!");var C=D.member[0];C.context=y;A.publish({event:"xmodel-list-data-item-update-action",data:C})},function(){t.showError(z.mySettings.NLS.getSubItemDetailsError)})}};r.prototype.createDeleteModelDialog=function(A,B){var y={listItems:A,type:"delete",single:this.mySettings.NLS.itemName,multiple:this.mySettings.NLS.itemsName,modelEvent:B,immersiveFrame:q.getImmersiveFrame()};var z=new i(y)};r.prototype._deleteSubItem=function(C){var A=this;var z=C;x.mask(A._container);m[this.mySettings.serviceHandlers.deleteSubItems]({ids:z,variantId:A._currVariantClassId}).then(function B(D){A._localChannelForListView.publish({event:"xmodel-list-data-item-remove-action",data:z});x.unmask(A._container)},function y(D){t.showError(A.mySettings.NLS.deleteSubItemError);x.unmask(A._container)})};r.prototype.publishTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-activate-action"})};r.prototype.clearTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-deactivate-action"})};return r});define("DS/ENOXModelApp/PCDefinition/PCDetailsStatePresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","UWA/Class/Model","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/ENOXSplitView/js/ENOXSplitView","DS/ConfiguratorPanel/scripts/Presenters/ConfigEditorPresenter","DS/ConfiguratorPanel/scripts/Models/ConfiguratorModel","DS/ConfiguratorPanel/scripts/Utilities","DS/ConfiguratorPanel/scripts/ConfiguratorSolverFunctions","DS/ConfiguratorPanel/scripts/Presenters/PCPanel","DS/CfgSolver/CfgSolverDebug","DS/ENOXTabs/js/ENOXTabs","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelIDCardAttributeEditor","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/TaggerOnIndexComponent/TaggerOnIndexComponent","DS/WildcardSearchComponent/WildcardSearchComponent","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/UIKIT/Input/Button","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","i18n!DS/ENOXModelApp/assets/nls/PCDefinition/PCDefinition","css!DS/ENOXModelApp/PCDefinition/PCDetails.css"],function(F,u,w,B,n,E,h,q,g,A,l,v,f,z,s,k,d,c,a,e,i,o,m,y,r,C,p,b,j,D){var t=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var x=function(){};_tempPersistCriteria=[];x.prototype.init=function(I,K,H){var J=this;var G=H||{};this.tagProxyName=(G.tagProxyName==undefined)?"PCDetailsStatePresenter":G.tagProxyName;this._pathPCDetail=[i._KEY,i._VIEWS_PREFERENCES,i._PRODUCT_CONFIGURATIONS_DETAILS];this._isDestroyed=false;this.options=UWA.merge(this,G);this._applicationChannel=I;this._updateChannel=K;this._privateModelEvents=new u();this._privateModelEventsForSplitView=new u();this._modelEventsForConfigPanel=new u();this._myEventManager=new e(this._applicationChannel,this._updateChannel,this._privateModelEvents,this._privateModelEventsForSplitView,this._modelEventsForConfigPanel);this._subscribeToEvents();this._initDivs();this._initCommand();this._TaggerOnIndexComponent=m;this.WildcardSearch=new y();this._enoxIDCardContainer=new n();this._idCardAttrbEditorUtil=new k();this._idCardAttrbEditorUtil.init(this._privateModelEvents);this._initPropertyPanel()};x.prototype._initCommand=function(){this._command=new c(this._privateModelEvents,this._container)};x.prototype._initPropertyPanel=function(){r.initialize({applicationChannel:this._applicationChannel,context:"ProductConfiguration",id:this.id})};x.prototype._initDivs=function(){var G=this;this._container=UWA.createElement("div");this._container.classList.add("PC-details");this._contentBottom=UWA.createElement("div");this._contentBottom.classList.add("configPanel-content");this._parentConfPanel=UWA.createElement("div");this._parentConfPanel.classList.add("parentConfPanel");this._confPanelContainer=UWA.createElement("div");this._confPanelContainer.classList.add("confPanelContainer");this._parentConfPanel.appendChild(this._confPanelContainer);this._persistencyContainer=UWA.createElement("div");this._persistencyContainer.classList.add("config-editor-persistency-container");this._savePCContainer=UWA.createElement("div");this._savePCContainer.classList.add("config-editor-save-configuration");this._persistencyContainer.appendChild(this._savePCContainer);this._cancelPCContainer=UWA.createElement("div");this._cancelPCContainer.classList.add("config-editor-cancel-configuration");this._persistencyContainer.appendChild(this._cancelPCContainer);this._parent3DContent=UWA.createElement("div");this._parent3DContent.classList.add("parent3DContent")};x.prototype.inject=function(G){G.appendChild(this._container)};x.prototype._subscribeToEvents=function(){var G=this;this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-model-refresh"},function(H){G._refreshIdCardModel()});this._myEventManager.subscribe(this._modelEventsForConfigPanel,{event:"pc-loaded"},function(){G.PCPanel1.inject(G._confPanelContainer);G._parentConfPanel.appendChild(G._persistencyContainer);m.killAllTagProxy();G.publishTags();F.unmask(G._parentConfPanel)});this._myEventManager.subscribe(this._modelEventsForConfigPanel,{event:"OnSearchResult"},function(I){var H=G.convertToSearch(G.PCPanel1.getConfigmodel().getDictionary().features);G.WildcardSearch.search(I.searchValue[0],H,function(J){G._modelEventsForConfigPanel.publish({event:"applyVariantListFilters",data:{filterType:"CSearchFilter",filterValues:G.getFilterData(J)}})})});this._myEventManager.subscribe(this._applicationChannel,{event:"search-in-current-dashboard"},function(I){var H=G.convertToSearch(G.PCPanel1.getConfigmodel().getDictionary().features);G.WildcardSearch.search(I,H,function(J){G._modelEventsForConfigPanel.publish({event:"applyVariantListFilters",data:{filterType:"GSearchFilter",filterValues:G.getFilterData(J)}})})});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-dropdown-menu-action"},function(H){G.actionDropDownMenuIdCard(H)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-minified"},function(H){o.updateCollapse(G._pathPCDetail,true)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-maximized"},function(H){o.updateCollapse(G._pathPCDetail,false)})};x.prototype.actionDropDownMenuIdCard=function(H){var G=this;switch(H){case"information":r.removeAllSelection();r.showInformation(G._id);break;case"delete":G.deletePC(G.options.parentID,[G.options.id]);break;case"owner":G._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:G.options,linkId:"owner"}});break;case"state":G._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:G.options,linkId:"state"}});break;default:}};x.prototype.deletePC=function(K,G){var H=this;E.deleteConfigurationVersions({parentId:K,ids:G}).then(function J(){console.log("Product Configuration/s deleted successfully.");s.navigate(a.ROUTE_MODEL_INFO,{id:H.options.parentID,name:H.options.modelVersionName,version:H.options.modelVersionVersion,refreshPCList:true});H._applicationChannel.publish({event:"breadcrumb-remove-link",data:a.ROUTE_MODEL_PC_DETAILS})},function I(){console.log("Error! Product Configuration deletion failed!!");C.showError(j.ERROR_DELETE_PC)})};x.prototype._loadData=function(H){var G=this;if(H===undefined||H===null){return}this._loadIDCard(H);this._loadSplitView(H);this._loadConfigurator(H)};x.prototype._loadIDCard=function(H){this._modelForIdCard=d.prepareIdCardData(H,this._privateModelEvents);this._idCardAttrbEditorUtil.setModelAndInitCollabObj(this._modelForIdCard);this._enoxIDCardContainer.init({},this._modelForIdCard);this._enoxIDCardContainer.inject(this._container);var G=this._enoxIDCardContainer.getMainContent();G.appendChild(this._contentBottom);if(o.getCollapse(this._pathPCDetail)){this._privateModelEvents.publish({event:"idcard-toggle-minified-view"})}else{}};x.prototype._refreshIdCardModel=function(){var G=this;E.getConfigurationDetails({id:G.id}).then(function(H){if(G._isDestroyed){if(t){console.log("Configuration Details destroyed before being loaded")}return}var I=d.prepareIdCardData(H,G._privateModelEvents);G._modelForIdCard.set("attributes",I.get("attributes"));G._modelForIdCard.set("name",I.get("name"));G._modelForIdCard.set("freezones",I.get("freezones"))},function(H){console.log("getConfigurationDetails: Service Call Failed !!!")})};x.prototype._loadSplitView=function(J){var H=this;var G={modelEvents:this._privateModelEventsForSplitView,withtransition:true,withoverflowhidden:false,rightMaximizer:true,leftMaximizer:false,params:{leftWidth:27,leftVisible:true,rightVisible:false}};var I=new h();I.init(G);this._contentBottom.appendChild(I.getContent());this._privateModelEventsForSplitView.publish({event:"splitview-set-content-panel",data:{side:"left",content:H._parentConfPanel}});this._privateModelEventsForSplitView.publish({event:"splitview-set-content-panel",data:{side:"right",content:H._parent3DContent}})};x.prototype._loadConfigurator=function(H){F.mask(this._parentConfPanel);var G=this;this.configuratorVersion="V4";this._saveBtn=new p({value:"save",className:"primary"}).inject(this._savePCContainer);this._CancelBtn=new p({value:"Reset"}).inject(this._cancelPCContainer);this._saveBtn.addEvent("onClick",function(){this.setFocus(false);G.saveConfigurations(G.PCPanel1.getConfigmodel())});this._CancelBtn.addEvent("onClick",function(){F.mask(G._parentConfPanel);G.fetchData({reset:true});this.setFocus(false);C.showSuccess(j._pc_restore_success_message);F.unmask(G._parentConfPanel)});if(this.configuratorVersion==="V4"&&this.reloadVariability){b.getVariabilityDefinition({componentId:G.options.parentID,content:{attributes:3,parameters:(a.PARAMETERS_ENABLED!=undefined?a.PARAMETERS_ENABLED:false),attributeList:["_image"]}}).then(function(I){G.variabilityDictionary=I;G._initConfigurator()})}else{this._initConfigurator()}};x.prototype.fetchData=function(H){var I=this;F.mask(this._container);E.getConfigurationDetails({id:this.id}).then(function J(K){I.PCContent=K;I.PCContent.name=K.member[0]["name"];I.PCContent.image=K.member[0]["image"];I.PCContent.completenessStatus=K.member[0]["completenessStatus"];I.PCContent.rulesActivation=(K.member[0]["evalRules"]==="TRUE")?"true":"false";var L=K.member[0]["evalMode"];I.PCContent.rulesMode=(L==="CompleteConfiguration")?"RulesMode_SelectCompleteConfiguration":((L==="Dependencies")?"RulesMode_EnforceRequiredOptions":"RulesMode_DisableIncompatibleOptions");I.PCContent.selectionMode=(K.member[0]["selectMode"]==="Build")?"selectionMode_Build":"selectionMode_Refine";E.getCriteriaConfigurationInstances({id:I.id}).then(function(P){var M=[];if(P.member&&UWA.is(P.member,"array")){var O=P.member;P.member=_tempPersistCriteria;for(var N=0;N<O.length;N++){if(Object.keys(O[N])[0]==="id"){if(O[N].status){M.push({Id:O[N].id,State:O[N].status})}else{if(O[N].value){M.push({Id:O[N].id,Value:O[N].value})}}}else{M.push({Id:Object.keys(O[N])[0],State:O[N][Object.keys(O[N])[0]]})}}}I.PCContent.configurationCriteria=M;if(H&&H.reset){I.PCPanel1.resetProductConfiguration(I.PCContent)}else{I._loadData(I.PCContent)}F.unmask(I._container)},function(M){console.log("Failed to retrieve PC selections : "+M)})},function G(K){F.unmask(I._container);console.log("Failed to retrieve PC Details : "+K)})};x.prototype._initConfigurator=function(){if(this.variabilityDictionary&&this.variabilityDictionary.portfolioClasses){this.variabilityDictionary.portfolioClasses.member[0].attributes._mandatory=true;this.variabilityDictionary.portfolioClasses.member[0].portfolioComponents.member[0].attributes._mandatory=true}var G={version:this.configuratorVersion,mvId:this.options.parentID,pCId:this.id,realistic:true,initalOptions:{initialRuleLevel:this.PCContent.rulesMode,initialMode:this.PCContent.selectionMode,completenessStatus:this.PCContent.completenessStatus},rulesActivation:this.PCContent.rulesActivation,ruleLevels:{RulesMode_ProposeOptimizedConfiguration:false,RulesMode_SelectCompleteConfiguration:false,RulesMode_EnforceRequiredOptions:true,RulesMode_DisableIncompatibleOptions:true,},enableValidation:true,tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",enableTableView:true};this.PCPanel1=new v(this.PCContent.configurationCriteria,this.variabilityDictionary,this._modelEventsForConfigPanel,G)};x.prototype.saveConfigurations=function(P){var K=this;K._parentConfPanel.style.opacity="0.5";F.mask(K._contentBottom);var L=P.getAppRulesParam();if(L.rulesMode==="No rule applied"){L.rulesMode="RulesMode_EnforceRequiredOptions"}var H=[];var I={name:this.name,description:this.PCContent.member[0].description,purpose:"Evaluation",listPrice:P._totalPrice};UWA.merge(I,L);for(var J=0;J<P.getConfigurationCriteria().length;J++){H.push({id:P.getConfigurationCriteria()[J].Id,status:P.getConfigurationCriteria()[J].State})}for(var J=0;J<P.getParameterCriteria().length;J++){if(P.getParameterCriteria()[J].Value){H.push({id:P.getParameterCriteria()[J].Id,value:P.getParameterCriteria()[J].Value.toString()})}}var N=(P.getAppRulesParam().rulesMode==="RulesMode_SelectCompleteConfiguration")?"CompleteConfiguration":(P.getAppRulesParam().rulesMode==="RulesMode_EnforceRequiredOptions")?"Dependencies":"Incompatibilities";var M={parentID:K.options.parentID,objectID:K.id,instances:H,attributes:I};E.updateProductConfiguration(M).then(function O(Q){C.showSuccess(j._pc_save_success_message);K._parentConfPanel.style.opacity="1";F.unmask(K._contentBottom)},function G(Q){C.showError(j._pc_save_failure_message);K._parentConfPanel.style.opacity="1";F.unmask(K._contentBottom)})};x.prototype.destroy=function(){this._container=null;this._isDestroyed=true;this._TaggerOnIndexComponent.killTagProxy(this.tagProxyName);if(this._myEventManager){this._myEventManager.cleanup("ProductConfiguration");this._myEventManager=null}if(this.PCPanel1){this.PCPanel1.destroy()}r.removeAllSelection("ProductConfiguration")};x.prototype.convertToSearch=function(I){var G=[],H=this;I.forEach(function(L){var K={};K.id=L.ruleId;if(H.configuratorVersion==="V4"){K["Display Name"]=L.displayName}else{K["Display Name"]=L.attributes["Display Name"]}G.push(K);if(L.options&&L.options.length>0){for(var J=0;J<L.options.length;J++){var M={};M.id=L.options[J].ruleId;M["Display Name"]=L.options[J].displayName;G.push(M)}}});return G};x.prototype.getFilterData=function(G){var H=[],J=this;for(var I=0;I<G.length;I++){if(G[I].id){H.push(G[I].id)}}return H};x.prototype._initTagger=function(I){var H=this;var J=function(K){H.applyTagsFilter(K.filteredSubjectList)};var G={onTagFilterChange:J,MyFriends:this.tagFriends};this._TaggerOnIndexComponent.setTagProxy(this.tagProxyName,G,I)};x.prototype.publishTags=function(){var G=[];this.PCPanel1.getConfigmodel().getDictionary().features.forEach(function(H){G.push(H.ruleId)});this._initTagger(G)};x.prototype.applyTagsFilter=function(G){var H={filterType:"TaggerFilter",filterValues:G};this._modelEventsForConfigPanel.publish({event:"applyVariantListFilters",data:H})};return x});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/ParametersPresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/WebappsUtils/WebappsUtils","DS/ENOXModelApp/Utils/xModelCommand","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/CreateParameterPresenter","DS/ENOXModelApp/xModelApp/xParameter","DS/xDimensionManager/xUnitConverter","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/xDimensionManager/assets/nls/xDimentions","i18n!DS/xDimensionManager/assets/nls/xUnitLabelLong","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common","i18n!DS/ENOXModelApp/assets/nls/EnterpriseVariabilityDictionary/ParametersPresenter","css!DS/ENOXModelApp/EnterpriseVariabilityDictionary/css/ParametersPresenter.css"],function(x,o,n,a,i,u,l,e,b,d,f,k,j,r,h,v,g,t,q,c,p,w){var m=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var s=function(){};s.prototype.init=function(B,z){var A=this;this._pathParameter=[f._KEY,f._VIEWS_PREFERENCES,f._ENTREPRISE_VARIANTS_OPTIONS,f._PARAMETERS];this._isDestroyed=false;this._options=z;this._applicationChannel=z.applicationChannel?z.applicationChannel:null;this._localChannelForListView=new o();this._myEventManager=new d(this._applicationChannel,this._localChannelForListView);this.xUnitConverterInstance=g.getInstance("PARAMETER_UNIT");A._tagActivated=false;this._namePage="Parameters";var y={applicationChannel:this._applicationChannel,context:this._namePage};l.initialize(y);this._xModelListView=null;this._dimensions=v.getDimensions();this._initListView();this._initDOM();this._initCommand();this._subscribeToEvents()};s.prototype._initCommand=function(){this._command=new b(this._localChannelForListView,this._container)};s.prototype._initListView=function(){var C=this;var D=k.getSort(this._pathParameter);if(D&&D.sortAttribute&&D.sortOrder){var z={id:D.sortAttribute,order:D.sortOrder}}var y=function(G,F){var I=(G&&G.inputvalue)?G.inputvalue:undefined;var H=(F&&F.inputvalue)?F.inputvalue:undefined;if(I===H){return 0}else{if(I>H){return 1}else{if(I<H){return -1}else{if((I===undefined)&&(H!==undefined)){return 2}else{return -2}}}}};var E=function(F){return function(J,I,H,G){J=H.options.grid[F];I=G.options.grid[F];var L=(J&&J.inputunit)?J.inputunit:undefined;var K=(I&&I.inputunit)?I.inputunit:undefined;if(L===K){return 0}else{if(L>K){return 1}else{if(L<K){return -1}else{if((L===undefined)&&(K!==undefined)){return 2}else{return -2}}}}}};var A={id:"parameters",modelEvents:this._localChannelForListView,useDragAndDrop:true,viewOptions:{views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],currentView:k.getView(this._pathParameter)||"DataGridView",currentSort:z||undefined,grid:{columns:[{text:p.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true,},{text:w._dimension,dataIndex:"dimension",getCellValue:function(G){var F=G.nodeModel.options.grid.dimension;return q.get(F)}},{text:w._minValue,dataIndex:"minValue",editableFlag:true,typeRepresentation:"paramValue",editionPolicy:"EditionOnOver",compareFunction:y,getCellValue:function(F){return F.nodeModel.options.grid.minValue["inputvalue"]},setCellValue:function(G,F){C._updateParameter({name:"minValue",value:F},G.nodeModel.options.grid).then(function(){G.nodeModel.options.grid.minValue["inputvalue"]=F},function(){G.nodeModel.updateOptions({})})}},{text:w._minUnit,dataIndex:"minUnit",editableFlag:true,compareFunction:E("minValue"),getCellEditableState:function(F){if(F.rowID>=0){if(F.nodeModel.options.grid.dimension){return true}}return false},editionPolicy:"EditionInPlace",typeRepresentation:"ParamUnits",getCellValue:function(F){var G=F.nodeModel.options.grid.minValue["inputunit"];return G},setCellValue:function(G,F){C._updateParameter({name:"minUnit",value:F},G.nodeModel.options.grid).then(function(){G.nodeModel.options.grid.minValue["inputunit"]=F},function(){G.nodeModel.updateOptions({})})}},{text:w._maxValue,dataIndex:"maxValue",editableFlag:true,compareFunction:y,getCellValue:function(F){return F.nodeModel.options.grid.maxValue["inputvalue"]},setCellValue:function(G,F){C._updateParameter({name:"maxValue",value:F},G.nodeModel.options.grid).then(function(){G.nodeModel.options.grid.maxValue["inputvalue"]=F},function(){console.log("error while updating..");G.nodeModel.updateOptions({})})},typeRepresentation:"paramValue",editionPolicy:"EditionOnOver",},{text:w._maxUnit,dataIndex:"maxUnit",compareFunction:E("maxValue"),getCellEditableState:function(F){if(F.rowID>=0){if(F.nodeModel.options.grid.dimension){return true}}return false},getCellValue:function(G){var F=G.nodeModel.options.grid.maxValue["inputunit"];return F},setCellValue:function(G,F){C._updateParameter({name:"maxUnit",value:F},G.nodeModel.options.grid).then(function(){G.nodeModel.options.grid.maxValue["inputunit"]=F},function(){console.log("error while updating..");G.nodeModel.updateOptions({})})},typeRepresentation:"ParamUnits",editionPolicy:"EditionInPlace"},{text:p.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(F){return{label:F.nodeModel.options.grid.state,url:"#Maturity"}}},{text:p.OWNER,dataIndex:"owner",visibleFlag:true,getCellValue:function(F){return{label:F.nodeModel.options.grid.owner?F.nodeModel.options.grid.owner:F.nodeModel.options.grid.responsible,url:"#Owner"}},typeRepresentation:"url",hyperlinkTarget:"_self"},{text:p.DESCRIPTION,dataIndex:"description",editableFlag:true},{text:p.CREATION_DATE,dataIndex:"created",visibleFlag:false},{text:p.MODIFICATION_DATE,dataIndex:"modified",visibleFlag:false}],typeRepresentations:{paramValue:{stdTemplate:"spinEdit",semantics:{valueType:"float",stepValue:1}}}},editable:true,itemViewMapping:{label:"title",subLabel:function(J){var F="";var H=J.options.grid.minValue;var I=J.options.grid.maxValue;if(H&&I){if(H.inputunit&&I.inputunit){F=H.inputvalue+" "+c.get(H.inputunit)+w._rangeValueDelimiter+I.inputvalue+" "+c.get(I.inputunit)}else{F=H.inputvalue+w._rangeValueDelimiter+I.inputvalue}}var G="("+p.MATURITY+": "+J.options.grid.state+", "+w._rangeLabel+": "+F+" )";return G},description:"description"},contextualActions:[{id:"information",title:w._information,text:w._information,fonticon:"info",handler:function(F){l.showInformation(F.id)}},{id:"delete",title:w._delete,text:w._delete,fonticon:"trash",handler:function(F){if(F){var G=[{id:F.id,title:F.title}];C.createDeleteModelDialog(G,C._localChannelForListView)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:p.EMPTY_CONTENT_MESSAGE}]},toolbarOptions:{itemsName:w._parameterMultiple,itemName:w._parameterSingle,actions:[{id:"create",text:w._create,fonticon:"plus",handler:function(){console.log("create action");C._createParameter()}},{id:"delete",text:w._delete,fonticon:"trash",enableOnSelection:true,handler:function(F){console.log("delete action..");var G=F.map(function(H){return{id:H.id,title:H.label}});C.createDeleteModelDialog(G,C._localChannelForListView)}}]},extensions:[i,u]};this._xModelListView=new a(A);var B=this._xModelListView.getTypeRepresentationFactory();if(B){B.registerEnum("ParamUnits",function(){var F=this.context.nodeModel.options.grid.dimension;return units=C._getDimentionUnits(F)})}};s.prototype._getDimentionUnits=function(y){var B=this;if(!B._dimensionUnits){B._dimensionUnits={}}if(B._dimensionUnits.hasOwnProperty(y)){return B._dimensionUnits[y]}else{var z=v.getDimensions();if(z.hasOwnProperty(y)){var A=Object.keys(z[y]);var C=A.map(function(D){return{valueItem:D,labelItem:c.get(D)}});B._dimensionUnits[y]=C;return C}else{return[]}}};s.prototype._createParameter=function(y){console.log("create parameter ... ");var A=this;h.show({name:"Create Paramters",dimensions:this._dimensions},function(B){var C={items:[{versionName:"1.0",type:"",kind:B.kind,dimension:B.dimension,attributes:{name:B.title,description:"",minValue:B.minUnit?B.minValue+" "+B.minUnit:B.minValue,maxValue:B.maxUnit?B.maxValue+" "+B.maxUnit:B.maxValue}}]};n.createParameter(C).then(function(G){console.log("Create Parameter : On Complete: "+G);var D={};for(var F in G.member[0]){if(G.member[0].hasOwnProperty(F)){D[F]=G.member[0][F]}}var E=D;A._localChannelForListView.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(H){H.select()});A._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:E});A._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})},function(D){console.log("create Parameter : Service Call Failed !!!");t.showError(w._ERROR_CREATE_PARAMETER);A._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})})},function z(B){t.showError(B.message)})};s.prototype._updateParameter=function(A,z){z=UWA.clone(z);var B=z.minValue.inputunit?z.minValue.inputvalue+" "+z.minValue.inputunit:z.minValue.inputvalue+"";var D=z.maxValue.inputunit?z.maxValue.inputvalue+" "+z.maxValue.inputunit:z.maxValue.inputvalue+"";if(A.name=="minValue"){B=z.minValue.inputunit?A.value+" "+z.minValue.inputunit:A.value+"";z.minValue.inputvalue=A.value}else{if(A.name=="maxValue"){D=z.maxValue.inputunit?A.value+" "+z.maxValue.inputunit:A.value+"";z.maxValue.inputvalue=A.value}else{if(A.name=="minUnit"){B=z.minValue.inputvalue+" "+A.value;z.minValue.inputunit=A.value}else{if(A.name=="maxUnit"){D=z.maxValue.inputvalue+" "+A.value;z.maxValue.inputunit=A.value}}}}var C=0;if(z.dimension){if(!this.xUnitConverterInstance){this.xUnitConverterInstance=g.getInstance("PARAMETER_UNIT")}C=this.xUnitConverterInstance.compare({unit:z.minValue.inputunit,value:z.minValue.inputvalue},{unit:z.maxValue.inputunit,value:z.maxValue.inputvalue})}else{if(z.kind&&z.kind.toLowerCase()=="integer"){var C=parseInt(z.minValue.inputvalue)-parseInt(z.maxValue.inputvalue)}else{if(z.kind&&z.kind.toLowerCase()=="real"){var C=parseFloat(z.minValue.inputvalue)-parseFloat(z.maxValue.inputvalue)}}}if(C>=0){t.showError(w._ERROR_INCORRECT_VALUE_RANGE);return UWA.Promise.reject()}var y={items:[{objectID:z.id,kind:z.kind,dimension:z.dimension,attributes:{minValue:B,maxValue:D}}]};return n.updateParameter(y)};s.prototype._initDOM=function(){this._container=UWA.createElement("div",{"class":"parameters-peresenter-container"});this._xModelListView.inject(this._container)};s.prototype.loadData=function(){var z=this;z._localChannelForListView.publish({event:"xmodel-list-data-on-load-start"});n.getParameters().then(function A(B){console.log("On Complete: "+B);z._localChannelForListView.publish({event:"xmodel-list-data-load-action",data:B});z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});z._localChannelForListView.publish({event:"enox-collection-toolbar-sort-activated",data:k.getSort(z._pathParameter)})},function y(B){console.log(" : On Failure: "+B);t.showError(w._ERROR_GET_PARAMETERS);z._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})})};s.prototype.getContent=function(){return this._container};s.prototype._subscribeToEvents=function(){var y=this;this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-link-click"},function(z){y._localChannelForListView.publish({event:"xmodel-execute-command",data:z})});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-add-selection"},function(z){var A=z.model;l.addSelection(A.id,"Parameters")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-remove-selection"},function(z){var A=z.model;l.removeSelection(A.id,"Parameters")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-empty-selection"},function(z){l.removeAllSelection("Parameters")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-tagger-on-setup"},function(z){if(!y._tagActivated){y._localChannelForListView.publish({event:"xmodel-list-tagger-deactivate-action"})}});this._myEventManager.subscribe(this._applicationChannel,{event:"xmodel-list-data-item-need-refresh"},function(z){y._refreshListView(y._localChannelForListView,z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-data-item-need-refresh"},function(z){y._refreshListView(y._localChannelForListView,z,this)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-switch-view-activated"},function(z){k.updateView(y._pathParameter,z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-sort-activated"},function(z){k.updateSort(y._pathParameter,z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-dialog-delete"},function(z){y._deleteParameters(z)});this._myEventManager.subscribe(this._localChannelForListView,{event:"list-view-update-inline-action"},function(z){if(z&&z.model&&z.name&&z.value!=undefined){var B=z.model[0];var C=z.cell.nodeModel;var A={icons:[e.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};C.updateOptions(A);y._editionParameter(B,z.name,z.value.trim())}})};s.prototype._refreshListView=function(A,B,y){if(B!=undefined){var z=this;n.getParameterDetails({id:B}).then(function(D){console.log("getParameterDetails: Service Call Successful !!!");var C=D.member[0];C.context=y;A.publish({event:"xmodel-list-data-item-update-action",data:C});l.removeSelection(C.id,z._namePage);l.addSelection(C.id,z._namePage)},function(){console.log("Error!!! getParameterDetails Call failed while handling the refresh event from the properties panel.")})}};s.prototype._editionParameter=function(E,z,C){var A=this;if(E&&z&&C){var B={};B[z]=C;n.patchParameter(E.id,B).then(function D(F){console.log("ParametersPresenter _editionParameter : Service Call Success !!!");A._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:F.member[0]});var H=A._xModelListView._getSelectedItem()[0].id;var G=F.member[0].id;l.removeSelection(G);l.addSelection(H)},function y(F){console.log("ParametersPresenter _editionParameter : Service Call Failed !!!");A._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:E});t.showError(w._ERROR_PATCH_PARAMETER)})}};s.prototype.inject=function(y){y.appendChild(this._container)};s.prototype.destroy=function(){this._container.destroy();this._container=null;this._isDestroyed=true;this._xModelListView.destroy();if(this._myEventManager){this._myEventManager.cleanup("ParametersPresenter");this._myEventManager=null}};s.prototype.createDeleteModelDialog=function(B,A){var y={listItems:B,type:"delete",single:w._parameterSingle,multiple:w._parameterMultiple,modelEvent:A,immersiveFrame:r.getImmersiveFrame()};var z=new j(y)};s.prototype._deleteParameters=function(C){var A=this;var z=C;n.deleteParameters({ids:z}).then(function B(D){A._localChannelForListView.publish({event:"xmodel-list-data-item-remove-action",data:z});console.log("Delete Parameter Successful!!!")},function y(D){console.log("Failure while deleting parameter !!!");t.showError(w._ERROR_DELETE_PARAMETER)})};s.prototype.publishTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-activate-action"});this._tagActivated=true};s.prototype.clearTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-deactivate-action"});this._tagActivated=false};return s});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoItemDetailsPresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","UWA/Class/Model","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoSubItemsPresenter","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/ENOXModelApp/Utils/xModelIDCardAttributeEditor","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/EnterpriseVariabilityDictionary/EnterpriseVariabilityDictionaryStatePresenter","css!DS/ENOXModelApp/EnterpriseVariabilityDictionary/css/EntDicoItemDetailsPresenter.css"],function(u,n,p,r,h,j,q,b,g,c,d,a,e,f,i,k,s,l,o){var m=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var t=function(){};t.prototype.init=function(w,x,v){this._isDestroyed=false;this.mySettings=UWA.clone(v.settings);this._pathItemsDetail=this.mySettings.appPreferencePath;this._applicationChannel=w;this._updateChannel=x;this._options=v;this._id=v.id;this._variantClassName=v.name?v.name:"";this._modelForIdCard={};this._updateChannelLocal=new n();this._privateModelEvents=new n();this._myEventManager=new e(this._applicationChannel,this._updateChannel,this._updateChannelLocal,this._privateModelEvents);this._idCardAttrbEditorUtil=new g();this._idCardAttrbEditorUtil.init(this._privateModelEvents);this._subItemsPresenter=new q();this._subItemsPresenter.init(this._privateModelEvents,w,{someOtherOptions:"cool option for Variants",settings:v.settingsForSubItems});this._initDivs();this._initCommand();this._subscribeToEvents();this._fetchData()};t.prototype._initCommand=function(){this._command=new c(this._privateModelEvents,this._container)};t.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("item-details");this._enoxIDCardContainer=new h();this._contentBottom=UWA.createElement("div");this._contentBottom.classList.add("bot-content")};t.prototype.inject=function(v){v.appendChild(this._container)};t.prototype._loadDataInIDCard=function(x){var w=this;this._modelForIdCard=d.prepareIdCardData(x,this._privateModelEvents);this._idCardAttrbEditorUtil.setModelAndInitCollabObj(this._modelForIdCard);w._enoxIDCardContainer.init({},this._modelForIdCard);w._enoxIDCardContainer.inject(w._container);var v=w._enoxIDCardContainer.getMainContent();v.appendChild(w._contentBottom);if(i.getCollapse(this._pathItemsDetail)){this._privateModelEvents.publish({event:"idcard-container-minimize-idcard"})}else{this._privateModelEvents.publish({event:"idcard-container-maximize-idcard"})}};t.prototype._fetchData=function(){var v=this;u.mask(this._container);UWA.extendElement(this._contentBottom);b[this.mySettings.serviceHandlers.getItemDetails]({id:v._id}).then(function(w){if(v._isDestroyed){if(m){console.log("GetItemDetails: destroyed before being loaded")}return}v._loadDataInIDCard(w);u.unmask(v._container)},function(w){u.unmask(v._container);console.log("getItemDetails: Service Call Failed !!!");s.showError(v.mySettings.NLS.getItemDetailsError)});this._contentBottom.innerHTML="";this._subItemsPresenter.inject(this._contentBottom);this._subItemsPresenter.loadData(this._id,"").then(function(){d.workaroundCheckAndWakeUpResizeSensor(v._contentBottom)},function(){console.log()})};t.prototype.destroy=function(){this._container=null;this._isDestroyed=true;if(this._subItemsPresenter){this._subItemsPresenter.destroy()}if(this._myEventManager){this._myEventManager.cleanup("EntDicoItemDetailsPresenter_"+this.mySettings.settingsFor);this._myEventManager=null}};t.prototype._subscribeToEvents=function(){var v=this;this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-model-refresh"},function(w){v._refreshIdCardModel()});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-minified"},function(w){i.updateCollapse(v._pathItemsDetail,true)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-maximized"},function(w){i.updateCollapse(v._pathItemsDetail,false)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-dropdown-menu-action"},function(w){v.actionDropDownMenuIdCard(w)})};t.prototype._refreshIdCardModel=function(){var v=this;b[this.mySettings.serviceHandlers.getItemDetails]({id:v._id}).then(function(w){if(v._isDestroyed){if(m){console.log("Variant Details Presenter destroyed before being loaded")}return}var x=d.prepareIdCardData(w,v._privateModelEvents);v._modelForIdCard.set("attributes",x.get("attributes"));v._modelForIdCard.set("name",x.get("name"));v._modelForIdCard.set("freezones",x.get("freezones"))},function(w){console.log("getItemDetails: Service Call Failed !!!");s.showError(v.mySettings.NLS.getItemDetailsError)})};t.prototype._deleteItems=function(z){var x=this;var w=z;b[this.mySettings.serviceHandlers.deleteItems]({ids:w}).then(function y(A){j.navigate(a.ROUTE_DICTIONARY_VARIANTS_OPTIONS,{reload:false});x._updateChannel.publish({event:"xmodel-list-data-item-remove-action",data:w})},function v(A){console.log("Failure while deleting item!!!"+A);s.showError(x.mySettings.NLS.deleteItemError)})};t.prototype.actionDropDownMenuIdCard=function(w){var v=this;switch(w){case"information":k.removeAllSelection();k.showInformation(v._id);break;case"delete":v._deleteItems([v._id]);break;case"owner":v._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"owner"}});break;case"state":v._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"state"}});break;case"revision":v._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"revision"}});break;default:}};return t});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoPresenterSettingsProvider",["UWA/Class","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","i18n!DS/ENOXModelApp/assets/nls/EnterpriseVariabilityDictionary/EnterpriseVariabilityDictionaryStatePresenter"],function(c,b,f,d){var g=function(h){return{icon:h?h:"product",message:d.EMPTY_CONTENT_MESSAGE}};var a=function(){return{openItemCmdTitle:d._open,openItemCmdText:d._open,infoCmdTitle:d._information,infoCmdText:d._information,deleteCmdTitle:d._delete,deleteCmdText:d._delete,deleteItemTitle:d._delete}};var e=c.singleton({getVariantsPresenterSettings:function(){var h={settingsFor:"VariantsPresenter",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._ENTREPRISE_VARIANTS_OPTIONS,b._VARIANTS],infoContext:"VariantClasses",tagProxyName:"VariantClassesTagProxy",listViewId:"variant",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],NLS:UWA.extend(a(),{createItemTitle:d._createVariant,createItemText:d._createVariant,createChildItemTitle:d._createValue,createChildItemText:d._createValue,itemName:d._variantSingle,itemsName:d._variantMultiple,createItemError:d.ERROR_CREATE_VARIANT,getItemDetailsError:d.ERROR_GET_VARIANT_DETAILS,getSubItemDetailsError:d.ERROR_GET_VARIANT_DETAILS,getItemsError:d.ERROR_GET_VARIANTS,deleteItemError:d.ERROR_DELETE_VARIANT,createSubItemError:d.ERROR_CREATE_VARIANT,getSubItemsError:d.ERROR_GET_VARIANT_VALUES,deleteSubItemError:d.ERROR_DELETE_VARIANT,patchSubItemError:d.ERROR_PATCH_VARIANT_VALUE,patchItemError:d.ERROR_PATCH_VARIANT}),routes:{DetailsPageRoute:f.ROUTE_DICTIONARY_VARIANT_DETAILS},emptyContent:g(),types:{item:"Variant",subItem:"Variant Value"},serviceHandlers:{createItem:"createVariantClass",getItemDetails:"getVariantClassDetails",getSubItemDetails:"getVariantDetails",createSubItem:"createVariant",getItems:"get_Variants",getSubItems:"getVariantValues",patchItem:"patchVariant",patchSubItem:"patchVariantValue",deleteItems:"deleteVariantClasses",deleteSubItems:"deleteVariants",}};return h},getOptionGroupsPresenterSettings:function(){var h={settingsFor:"OptionGroupPresenter",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._ENTREPRISE_VARIANTS_OPTIONS,b._GROUP_OPTIONS],infoContext:"OptionGroup",tagProxyName:"OptionGroupPresenterTagProxy",listViewId:"optionGroup",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],NLS:UWA.extend(a(),{createItemTitle:d._createOptionGroup,createItemText:d._createOptionGroup,createChildItemTitle:d._createOption,createChildItemText:d._createOption,itemName:d._optionGroupSingle,itemsName:d._optionGroupMultiple,subItemName:d._optionSingle,subItemsName:d._optionMultiple,createItemError:d.ERROR_CREATE_VAR_GROUP,getItemDetailsError:d.ERROR_GET_VAR_GROUP_DETAILS,getSubItemDetailsError:d.ERROR_GET_OPTION_DETAILS,getItemsError:d.ERROR_GET_VAR_GROUPS,deleteItemError:d.ERROR_DELETE_VAR_GROUPS,createSubItemError:d.ERROR_CREATE_OPTION,getSubItemsError:d.ERROR_GET_OPTIONS,deleteSubItemError:d.ERROR_DELETE_OPTIONS,patchSubItemError:d.ERROR_PATCH_VARIANT_VALUE,patchItemError:d.ERROR_PATCH_GROUP}),routes:{DetailsPageRoute:f.ROUTE_DICTIONARY_OPTION_GROUP_DETAILS},emptyContent:g(),types:{item:"Option Group",subItem:"Option"},serviceHandlers:{createItem:"createVariabilityGroup",getItemDetails:"getVariantClassDetails",getSubItemDetails:"getOptionDetails",createSubItem:"createOption",getItems:"getVariabilityGroups",getSubItems:"getVariabilityGroupOptions",patchItem:"patchVariabilityGroup",patchSubItem:"patchOption",deleteItems:"deleteVariabilityGroups",deleteSubItems:"deleteOptions"}};return h},getVariantDetailsPresenterSettings:function(){var h={settingsFor:"VariantDetails",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._VARIANTS_DETAILS],NLS:UWA.extend(a(),{getItemDetailsError:d.ERROR_GET_VARIANT_DETAILS,deleteItemError:d.ERROR_DELETE_VARIANT}),serviceHandlers:{getItemDetails:"getVariantClassDetails",deleteItems:"deleteVariantClasses"}};return h},getOptionGroupDetailsPresenterSettings:function(){var h={settingsFor:"OptionGroupDetails",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._OPTION_GROUP_DETAILS],NLS:UWA.extend(a(),{getItemDetailsError:d.ERROR_GET_VAR_GROUP_DETAILS,deleteItemError:d.ERROR_DELETE_OPTION_GROUPS}),serviceHandlers:{getItemDetails:"getVariantClassDetails",deleteItems:"deleteVariabilityGroups"}};return h},getVariantValuesPresenterSettings:function(){var h={settingsFor:"VariantValues",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._VARIANTS_DETAILS],infoContext:"Variant",tagProxyName:"VariantsTagProxy",listViewId:"variantValue",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],tabId:"VariantValue",NLS:UWA.extend(a(),{createItemTitle:d._createValue,createItemText:d._createValue,itemName:d._valueSingle,itemsName:d._valueMultiple,tabTitle:d._valueMultiple,getSubItemDetailsError:d.ERROR_GET_VAR_GROUP_DETAILS,getSubItemsError:d.ERROR_GET_VARIANT_VALUES,createSubItemError:d.ERROR_CREATE_VARIANT,patchSubItemError:d.ERROR_PATCH_VARIANT_VALUE,deleteSubItemError:d.ERROR_DELETE_VARIANT,}),emptyContent:g(),serviceHandlers:{createSubItem:"createVariant",getSubItemDetails:"getVariantDetails",getSubItems:"getVariantValues",patchSubItem:"patchVariantValue",deleteSubItems:"deleteVariants"}};return h},getOptionsPresenterSettings:function(){var h={settingsFor:"Options",appPreferencePath:[b._KEY,b._VIEWS_PREFERENCES,b._OPTION_GROUP_DETAILS],infoContext:"Options",tagProxyName:"OptionsTagProxy",listViewId:"options",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],tabId:"Options",NLS:UWA.extend(a(),{createItemTitle:d._createOption,createItemText:d._createOption,itemName:d._optionSingle,itemsName:d._optionMultiple,tabTitle:d._optionMultiple,getSubItemDetailsError:d.ERROR_GET_VAR_GROUP_DETAILS,getSubItemsError:d.ERROR_GET_OPTIONS,createSubItemError:d.ERROR_CREATE_OPTION,patchSubItemError:d.ERROR_PATCH_OPTION,deleteSubItemError:d.ERROR_DELETE_OPTIONS,}),emptyContent:g(),serviceHandlers:{createSubItem:"createOption",getSubItemDetails:"getOptionDetails",getSubItems:"getVariabilityGroupOptions",patchSubItem:"patchOption",deleteSubItems:"deleteOptions"}};return h}});e.init();return e});define("DS/ENOXModelApp/RuleDefinition/RuleDetailsStatePresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/xPflRouter5/xPflRouter","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/CfgSolver/CfgSolverServices","DS/ENOXModelApp/RuleDefinition/RulePresenter","DS/ENOXModelApp/Utils/xModelIDCardAttributeEditor","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/xModelEventManager/xModelEventManager","DS/CfgSolver/CfgSolverDebug","i18n!DS/ENOXModelApp/assets/nls/RuleDefinition/RulePresenter","css!DS/ENOXModelApp/RuleDefinition/RuleDetailsStatePresenter.css"],function(u,q,r,o,t,k,p,i,n,j,d,c,a,s,g,m,f,e,l,h){var b=function(){};b.prototype.init=function(y,z,x,w){this._options=w||{};this._ruleId=y.ruleId;this._solverKey=w.solverKey?w.solverKey:null;this._context=y;this._contextDictionary=w.contextDictionary?w.contextDictionary:null;this._variabilityDictionary=w.dictionary;this._privateChannel=z;this._applicationChannel=x;this._subscribedEventTokens=[];this._isEditable=(y&&y.editable&&((typeof y.editable)==="boolean"))?y.editable:true;this._ruleName=null;this._modelId=y.modelId;this._pathRulesDetail=[g._KEY,g._VIEWS_PREFERENCES,g._RULES_DETAILS];this._privateRuleEvents=new q();this._myEventManager=new f(this._applicationChannel,this._privateChannel,this._privateRuleEvents);this._enoxIDCardContainer=new k();this._idCardAttrbEditorUtil=new j();this._idCardAttrbEditorUtil.init(this._privateRuleEvents);this._rulePresenter=new n();this._subscribeToEvents();this._initDivs();this._initCommand();var v=window.sessionStorage["solver-activate-traces"];if(v){this._CfgSolverDebug=new e();this._CfgSolverDebug.init2("rule-details",this._solverKey);this._CfgSolverDebug.injectIn(this._container)}};b.prototype._initCommand=function(){this._command=new c(this._privateRuleEvents,this._container)};b.prototype.clear=function(){if(this._container){this._container.innerHTML=""}if(this._privateChannel){var w=UWA.clone(this._subscribedEventTokens);for(var v=0;v<w.length;v++){this._privateChannel.unsubscribe(w[v])}}};b.prototype.deleteRule=function(x,v){var w=this;t.deleteRuleVersions({ids:v,modelId:x}).then(function(){console.log("Product Rule/s deleted successfully.");o.navigate(a.ROUTE_MODEL_INFO,{id:w._options.parentID,name:w._options.modelVersionName,version:w._options.modelVersionVersion,refreshPCList:true});w._applicationChannel.publish({event:"breadcrumb-remove-link",data:a.ROUTE_MODEL_RULE_DETAILS})},function(){console.log("rule deletion failed");s.showError(l.ERROR_DELETE_RULE)})};b.prototype.fetchData=function(){var v=this;u.mask(this._container);t.getRuleDetails({id:v._ruleId}).then(function(w){console.log("getRuleDetails: Service Call Successful !!!");if(v._isDestroyed){if(debug){console.log("rule details destroyed before being loaded")}u.unmask(v._container);return}v._loadData(w);u.unmask(v._container)},function(w){console.log("getRuleDetails: Service Call Failed !!!");u.unmask(v._container);s.showError(l.GET_RULE_DETAILS_ERROR)});u.unmask(this._container)};b.prototype._loadData=function(z){var y=this;u.mask(this._container);this._modelForIdCard=d.prepareIdCardData(z,this._privateRuleEvents);this._idCardAttrbEditorUtil.setModelAndInitCollabObj(this._modelForIdCard);this._enoxIDCardContainer.init({modelEvents:this._privateRuleEvents},this._modelForIdCard);this._enoxIDCardContainer.inject(this._container);var w=this._enoxIDCardContainer.getMainContent();w.appendChild(this._ruleContent);if(m.getCollapse(this._pathRulesDetail)){this._privateRuleEvents.publish({event:"idcard-toggle-minified-view"})}else{}u.mask(this._ruleContent);var v={solverKey:y._solverKey,contextDictionary:y._variabilityDictionary,dictionary:y._variabilityDictionary,editable:y._isEditable};var x={ruleId:y._ruleId,modelId:y._modelId,ruleName:y._ruleName};y._rulePresenter.init(x,y._privateRuleEvents,y._applicationChannel,y._ruleId,v);y._rulePresenter.inject(y._ruleContent);u.unmask(y._container);u.unmask(y._ruleContent)};b.prototype.updateView=function(){var v=this;if(v._container){u.mask(UWA.extendElement(v._container));i.setRuleActivation(this._ruleId,"false",this._solverKey).then(function(){v._privateRuleEvents.publish({event:"mr-reload-table"});u.unmask(v._container)})}};b.prototype.unmaskRuleContent=function(v){if(this._ruleContent){u.unmask(this._ruleContent)}};b.prototype.maskRuleContent=function(x){var w=this;if(!u.isMasked(w._ruleContent)){u.mask(w._ruleContent);if(x){var v=w._ruleContent.querySelector(".mask");v.innerText=x;v.style.textAlign="center";v.style.lineHeight=w._ruleContent.offsetHeight+"px";v.style.verticalAlign="middle"}}};b.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container=UWA.createElement("div");this._container.classList.add("rule-idcard-content");this._ruleContent=UWA.createElement("div");this._ruleContent.classList.add("rule-definition-content")};b.prototype.inject=function(v){v.appendChild(this._container)};b.prototype._subscribeToEvents=function(){var v=this;this._myEventManager.subscribe(this._privateRuleEvents,{event:"mr-onsavedone"},function(w){v._privateChannel.publish({event:"mr-onsavedone",data:w})});this._myEventManager.subscribe(this._privateRuleEvents,{event:"expr-rule-onsavedone"},function(w){v._privateChannel.publish({event:"mr-onsavedone",data:w})});this._myEventManager.subscribe(this._privateRuleEvents,{event:"local-rule-deleted"},function(w){v._privateChannel.publish({event:"local-rule-deleted",data:w})});this._myEventManager.subscribe(this._privateRuleEvents,{event:"idcard-model-refresh"},function(w){v._privateChannel.publish({event:"mr-onsavedone",data:w});v._refreshIdCardModel()});this._myEventManager.subscribe(this._privateRuleEvents,{event:"idcard-dropdown-menu-action"},function(w){v.actionDropDownMenuIdCard(w)});this._myEventManager.subscribe(this._privateRuleEvents,{event:"idcard-container-minified"},function(w){m.updateCollapse(v._pathRulesDetail,true)});this._myEventManager.subscribe(this._privateRuleEvents,{event:"idcard-container-maximized"},function(w){m.updateCollapse(v._pathRulesDetail,false)})};b.prototype.actionDropDownMenuIdCard=function(w){var v=this;switch(w){case"information":p.removeAllSelection();p.showInformation(v._id);break;case"delete":v.deleteRule(v._modelId,[v._ruleId]);break;case"owner":v._privateRuleEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"owner"}});break;case"state":v._privateRuleEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"state"}});break;case"revision":v._privateRuleEvents.publish({event:"xmodel-execute-command",data:{model:v._options,linkId:"revision"}});break;default:}};b.prototype._refreshIdCardModel=function(){var v=this;t.getRuleDetails({id:v._ruleId}).then(function(w){var x=d.prepareIdCardData(w,v._privateRuleEvents);v._modelForIdCard.set("attributes",x.get("attributes"));v._modelForIdCard.set("name",x.get("name"));v._modelForIdCard.set("freezones",x.get("freezones"))},function(w){console.log("getRuleDetails: Service Call Failed !!!");s.showError(l.GET_RULE_DETAILS_ERROR)})};b.prototype.destroy=function(){if(this._rulePresenter){this._rulePresenter.clear()}this._container=null;if(this._myEventManager){this._myEventManager.cleanup("RuleDetailsStatePresenter");this._myEventManager=null}};return b});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoItemsPresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/WebappsUtils/WebappsUtils","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/Tree/TreeDocument","DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelCommand","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/components/DialogCreation/DialogCreation_Variant","DS/ENOXModelApp/components/DialogCreation/DialogCreation_GroupOption","DS/ENOXModelApp/components/DialogCreation/DialogCreation_Option","DS/ENOXModelApp/components/DialogCreation/DialogCreation_VariantValue","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common"],function(B,r,t,h,q,b,j,x,k,A,o,n,d,c,e,g,i,f,v,y,a,l,u,m,w,s){var p=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var z=function(){};z.prototype.init=function(G,E,D){var F=this;this.mySettings=UWA.clone(D.settings);this.mySettings.appPreferencePath=this.mySettings.appPreferencePath||"";this._isDestroyed=false;this._applicationChannel=E;this._localChannelForListView=G?G:new r();this._updateChannelLocal=new r();this._vcInfoPresenterModelEvents=new r();this._myEventManager=new g(this._applicationChannel,this._localChannelForListView,this._updateChannelLocal,this._vcInfoPresenterModelEvents);F._tagActivated=false;var C={applicationChannel:this._applicationChannel,context:this.mySettings.infoContext,};o.initialize(C);this._xModelListView=null;this._initListView();this.tagFriends=this.mySettings.tagFriends||undefined;this.tagProxyName=(this.mySettings.tagProxyName==undefined)?"ItemsTagProxy":this.mySettings.tagProxyName;this._initDOM();this._initCommand();this._subscribeToEvents();this._updateChannelLocal.publish({event:"enox-collection-toolbar-disable-action",data:"delete"})};z.prototype._initCommand=function(){this._command=new d(this._localChannelForListView,this._container)};z.prototype._initListView=function(){var F=this;var D=new k({});var G=m.getSort(this.mySettings.appPreferencePath);if(G&&G.sortAttribute&&G.sortOrder){var C={id:G.sortAttribute,order:G.sortOrder}}var E={id:this.mySettings.listViewId,model:D,modelEvents:this._localChannelForListView,useAsyncExpand:true,useDragAndDrop:true,viewOptions:{views:this.mySettings.views,currentView:m.getView(this.mySettings.appPreferencePath)||"DataGridView",currentSort:C||undefined,grid:{columns:[{text:s.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true},{text:s.NAME,dataIndex:"name",},{text:s.DESCRIPTION,dataIndex:"description",editableFlag:true},{text:s.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(H){return{label:H.nodeModel.options.grid.state,url:"#Maturity"}}},{text:s.OWNER,dataIndex:"owner",visibleFlag:true,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(H){return{label:H.nodeModel.options.grid.owner?H.nodeModel.options.grid.owner:H.nodeModel.options.grid.responsible,url:"#Owner"}}},{text:s.CREATION_DATE,dataIndex:"created",},{text:s.MODIFICATION_DATE,dataIndex:"modified",},{text:s.ORGANIZATION,dataIndex:"organization",},]},editable:true,itemViewMapping:{label:"title",subLabel:"state",description:"description"},contextualActions:function(){var H=[];if(this.getNodeDepth()==0){H.push({id:"open",title:F.mySettings.NLS.openItemCmdTitle,text:F.mySettings.NLS.openItemCmdText,fonticon:"export",handler:function(I){console.log("item clicked");n.navigate(F.mySettings.routes.DetailsPageRoute,{id:I.id,name:I.title,version:I.version})}});H.push({id:"createValue",title:F.mySettings.NLS.createChildItemTitle,text:F.mySettings.NLS.createChildItemText,fonticon:"plus",handler:function(I){console.log("item clicked");var J=this;switch(F.mySettings.settingsFor){case"VariantsPresenter":a.createDialogCreationVariantValue(u.getImmersiveFrame(),F._localChannelForListView,{nodeModel:J,model:I});break;case"OptionGroupPresenter":y.createDialogCreationOption(u.getImmersiveFrame(),F._localChannelForListView,{nodeModel:J,model:I});break;default:F._createSubItem({id:I.id}).then(function(K){if(K){if(J.isExpanded()){F._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:K,context:J})}else{J.expand()}}})}}})}return H.concat([{id:"information",title:F.mySettings.NLS.infoCmdTitle,text:F.mySettings.NLS.infoCmdText,fonticon:"info",handler:function(I){o.showInformation(I.id)}},{id:"delete",title:F.mySettings.NLS.deleteCmdTitle,text:F.mySettings.NLS.deleteCmdText,fonticon:"trash",handler:function(I){if(I){var J=[{id:I.id,title:I.title}];F.createDeleteModelDialog(J,F._localChannelForListView)}}}])}},emptyContentOptions:{sentences:[{type:"icon",fonticon:this.mySettings.emptyContent.icon,sizeicon:"40px",text:this.mySettings.emptyContent.message}]},toolbarOptions:{itemsName:this.mySettings.NLS.itemsName,itemName:this.mySettings.NLS.itemName,actions:[{id:"create",text:this.mySettings.NLS.createItemTitle,fonticon:"plus",handler:function(){console.log("create action");F.createCreationDialog(u.getImmersiveFrame(),F._localChannelForListView,F.mySettings.settingsFor)}},{id:"delete",text:this.mySettings.NLS.deleteItemTitle,fonticon:"trash",enableOnSelection:true,handler:function(H){console.log("delete action..");var I=H.map(function(J){return{id:J.id,title:J.label}});F.createDeleteModelDialog(I,F._localChannelForListView)}}]},extensions:[j,x]};this._xModelListView=new b(E)};z.prototype.createCreationDialog=function(E,C,D){switch(D){case"VariantsPresenter":f.createDialogCreationVariant(E,C);break;case"OptionGroupPresenter":v.createDialogCreationGroupOption(E,C);break;default:this._createItem()}};z.prototype._createItem=function(C){var F;var E=this;E._localChannelForListView.publish({event:"xmodel-list-data-on-load-start"});if(!UWA.is(C,"object")){C={}}UWA.merge(C,{name:"",description:""});var D={items:[{type:"",versionName:"",attributes:C}]};q[this.mySettings.serviceHandlers.createItem](D).then(function(G){console.log("Create Item : On Complete: "+G);F=G.member[0]["id"];q[E.mySettings.serviceHandlers.getItemDetails]({id:F}).then(function(K){console.log("getItemDetails: Service Call Successful !!!");var H={};for(var J in K.member[0]){if(K.member[0].hasOwnProperty(J)){H[J]=K.member[0][J]}}var I=H;E._localChannelForListView.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(L){L.select()});E._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:I});E._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})},function(H){console.log("getItemDetails: Service Call Failed !!!");w.showError(E.mySettings.NLS.getItemDetailsError);E._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})})},function(G){E._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});console.log("Create Item : Service Call Failed !!!");w.showError(E.mySettings.NLS.createItemError)})};z.prototype._createSubItem=function(H,E){var D=UWA.merge(E,{name:"",description:""});var F=this;return q[this.mySettings.serviceHandlers.createSubItem]({parentID:H,items:[{type:"",versionName:"",attributes:D}]}).then(function G(I){var J=I.member[0]["id"];return q[F.mySettings.serviceHandlers.getSubItemDetails]({id:J}).then(function(N){var K={};for(var M in N.member[0]){if(N.member[0].hasOwnProperty(M)){K[M]=N.member[0][M]}}var L=K;return L},function(K){w.showError(F.mySettings.NLS.getSubItemDetailsError);return})},function C(){w.showError(F.mySettings.NLS.createSubItemError);return})};z.prototype._initDOM=function(){this._container=UWA.createElement("div");this._container.style.width=this._container.style.height="100%";this._xModelListView.inject(this._container)};z.prototype.loadData=function(){var D=this;D._localChannelForListView.publish({event:"xmodel-list-data-on-load-start"});q[this.mySettings.serviceHandlers.getItems]().then(function E(F){console.log("On Complete: "+F);D._localChannelForListView.publish({event:"xmodel-list-data-load-action",data:F});D._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"});D._localChannelForListView.publish({event:"enox-collection-toolbar-sort-activated",data:m.getSort(D.mySettings.appPreferencePath)})},function C(F){console.log(" : On Failure: "+F);w.showError(D.mySettings.NLS.getItemsError);D._localChannelForListView.publish({event:"xmodel-list-data-on-load-complete"})})};z.prototype.getContent=function(){return this._container};z.prototype._subscribeToEvents=function(){var C=this;this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-dialog-creation"},function(D){if(D.context){switch(D.context.model.type){case"Option Group":C._createSubItem(D.context.model.id,D.content).then(function(E){if(E){if(D.context.nodeModel.isExpanded()){C._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:E,context:D.context.nodeModel})}else{D.context.nodeModel.expand()}}});break;case"Variant":C._createSubItem(D.context.model.id,D.content).then(function(E){if(E){if(D.context.nodeModel.isExpanded()){C._localChannelForListView.publish({event:"xmodel-list-data-item-add-action",data:E,context:D.context.nodeModel})}else{D.context.nodeModel.expand()}}});break;default:C._createItem(D.content)}}else{C._createItem(D.content)}});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-dialog-delete"},function(D){C._deleteItems(D)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-link-click"},function(D){C._localChannelForListView.publish({event:"xmodel-execute-command",data:D})});this._myEventManager.subscribe(this._localChannelForListView,{event:"list-view-update-inline-action"},function(D){if(D&&D.model&&D.name&&D.value!=undefined){var F=D.model[0];var G=D.cell.nodeModel;var E={icons:[h.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};G.updateOptions(E);C._editionHandler(F,D.name,D.value.trim(),F.type)}});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-add-selection"},function(D){var E=D.model;o.addSelection(E.id,"VariantClasses")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-remove-selection"},function(D){var E=D.model;o.removeSelection(E.id,"VariantClasses")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-empty-selection"},function(D){o.removeAllSelection("VariantClasses")});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-item-on-dblclick"},function(D){var E=D.model;if(this.getNodeDepth()==0){C._needRefresh=true;n.navigate(C.mySettings.routes.DetailsPageRoute,{id:E.id,name:E.title})}});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-view-on-expand"},function(F){console.log(C);var D=F.model;var E=F.nodeInfo;var G=this;C.getSubItems(D.id).then(function(H){if(H.member[0].hasOwnProperty("values")){H=H.member[0].values}else{if(H.member[0].hasOwnProperty("options")){H=H.member[0].options}else{H.member=[]}}C._localChannelForListView.publish({event:"xmodel-list-data-load-action",data:H,context:G});G.preExpandDone()},function(){G.preExpandDone()})});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-tagger-on-setup"},function(D){if(!C._tagActivated){C._localChannelForListView.publish({event:"xmodel-list-tagger-deactivate-action"})}});this._myEventManager.subscribe(this._applicationChannel,{event:"xmodel-list-data-item-need-refresh"},function(D){C._refreshListView(C._localChannelForListView,D)});this._myEventManager.subscribe(this._localChannelForListView,{event:"xmodel-list-data-item-need-refresh"},function(D){C._refreshListView(C._localChannelForListView,D,this)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-switch-view-activated"},function(D){m.updateView(C.mySettings.appPreferencePath,D)});this._myEventManager.subscribe(this._localChannelForListView,{event:"enox-collection-toolbar-sort-activated"},function(D){m.updateSort(C.mySettings.appPreferencePath,D)})};z.prototype._editionHandler=function(H,C,D,L){var K=this;if(L&&H&&D.length>0){var J={};J[C]=D;var I=L.trim();var F=(I===this.mySettings.types.item)?this.mySettings.serviceHandlers.patchItem:(I===this.mySettings.types.subItem)?this.mySettings.serviceHandlers.patchSubItem:undefined;var E=(I===this.mySettings.types.item)?this.mySettings.NLS.patchItemError:(I===this.mySettings.types.subItem)?this.mySettings.NLS.patchSubItemError:"Patch Service Handler failed...";if(F!==undefined){q[F](H.id,J).then(function M(N){console.log("Patch: Service Call Success !!!");K._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:N.member[0]});var O=N.member[0].id;o.removeSelection(O);o.addSelection(O)},function G(N){console.log("Patch: Service Call Failed !!!");K._localChannelForListView.publish({event:"xmodel-list-data-item-update-action",data:H});w.showError(E)})}}};z.prototype._refreshListView=function(D,E,C){if(E!=undefined){q[this.mySettings.serviceHandlers.getItemDetails]({id:E}).then(function(G){console.log("getItemDetails: Service Call Successful !!!");var F=G.member[0];F.context=C;D.publish({event:"xmodel-list-data-item-update-action",data:F})},function(){console.log("Error!!! getItemDetails Call failed while handling the refresh event from the properties panel.")})}};z.prototype.getSubItems=function(C){var E=this;return q[this.mySettings.serviceHandlers.getSubItems]({id:C}).then(function F(G){return G},function D(G){w.showError(E.mySettings.NLS.getSubItemsError);return[]})};z.prototype.inject=function(C){C.appendChild(this._container)};z.prototype.destroy=function(){this._container=null;this._isDestroyed=true;this._xModelListView.destroy();if(this._myEventManager){this._myEventManager.cleanup("EntDicoItemsPresenter For"+this.mySettings.settingsFor);this._myEventManager=null}};z.prototype.createDeleteModelDialog=function(E,F){var C={listItems:E,type:"delete",single:this.mySettings.NLS.itemName,multiple:this.mySettings.NLS.itemsName,modelEvent:F,immersiveFrame:u.getImmersiveFrame()};var D=new l(C)};z.prototype._deleteItems=function(G){var E=this;var D=G;q[this.mySettings.serviceHandlers.deleteItems]({ids:D}).then(function F(H){E._localChannelForListView.publish({event:"xmodel-list-data-item-remove-action",data:D});console.log("Delete Items Successful!!!")},function C(H){console.log("Failure while deleting items!!!");w.showError(E.mySettings.NLS.deleteItemError)})};z.prototype.publishTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-activate-action"});this._tagActivated=true};z.prototype.clearTags=function(){this._localChannelForListView.publish({event:"xmodel-list-tagger-deactivate-action"});this._tagActivated=false};return z});define("DS/ENOXModelApp/ModelDefinition/js/ModelDetailsStatePresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","UWA/Class/Model","DS/ENOXTabs/js/ENOXTabs","DS/Controls/Tab","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/ENOXModelApp/ModelDefinition/js/VariabilityPresenter","DS/ENOXModelApp/ModelDefinition/js/LocalRulesPresenter","DS/ENOXModelApp/ModelDefinition/js/LocalDocumentsPresenter","DS/ENOXModelApp/ModelDocument/js/ModelDocumentDetailsPresenter","DS/ENOXModelApp/ModelDefinition/js/PCListPresenter","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/PCDefinition/PCDetailsStatePresenter","DS/ENOXModelApp/RuleDefinition/RuleDetailsStatePresenter","DS/ENOXSplitView/js/ENOXSplitView","DS/ENOXModelApp/RuleDefinition/RulePresenter","DS/ENOXModelApp/PCDefinition/NewPCSummaryPresenter","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","DS/ENOXModelApp/ModelDefinition/js/VersionExplorerPresenter","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelIDCardAttributeEditor","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/CfgSolver/CfgSolverServices","DS/ConfiguratorPanel/scripts/ConfiguratorSolverFunctions","DS/TaggerOnIndexComponent/TaggerOnIndexComponent","DS/CfgDictionary/CfgDictionaryV3Utils","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/Utils/xModelCommand","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/ModelDetailsStatePresenter","css!DS/ENOXModelApp/ModelDefinition/css/ModelDetails.css"],function(C,q,b,L,p,d,E,s,n,r,g,u,x,D,m,I,h,f,H,j,o,k,G,F,M,i,A,B,e,w,z,J,t,l,K,c,a){var v=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var y=function(){};y.prototype.init=function(Q,S,P){this._isDestroyed=false;this._pathModelDetail=[t._KEY,t._VIEWS_PREFERENCES,t._MODEL_VERSIONS_DETAILS];this._options=P;this._id=P.id;this._applicationChannel=Q;this._updateChannel=S;this._privateChannelForRules=new q();this._privateChannelForPCs=new q();this._privateChannelForDocs=new q();this._updateChannelLocal=new q();this._privateChannelForSplitView=new q();this._bridgeModelEvent=new q();this._privateModelEvents=new q();this._solverModelEvent=new q();this._myEventManager=new J(this._applicationChannel,this._updateChannel,this._privateChannelForRules,this._privateChannelForPCs,this._privateChannelForDocs,this._updateChannelLocal,this._privateChannelForSplitView,this._bridgeModelEvent,this._privateModelEvents);this._idCardData={};this._addRouterPath();this._modelName="";this._modelPhysId="";this._modelVersionName="";this._modelVersionVersion="";this._modelMaturity="";this._modelVersionVariabilityUpdated=false;this._modelVersionRuleUpdated=false;if(P&&(P.state=="Review"||P.state=="Release"||P.state=="Obsolete")){this._allowEdit=false}else{this._allowEdit=true}this._enoxIDCardContainer=new E();this._localRulesPresenter=new n();var O={id:this._id,editable:this._allowEdit};this._rulePresenter=new h();this._newPCSummaryPresenter=new f();this._newPCSummaryPresenter.init(this._privateChannelForPCs,this._applicationChannel,{id:this._id,expandAll:true});var T={id:this._id,editable:true};var R=this;this._solverKeyForKPIGlobal=null;this._solverKeyForRules=null;console.log("that._solverKeyGlobal = "+R._solverKeyGlobal);console.log("that._solverKeyForRules = "+R._solverKeyForRules);this._variabilityDictionary;this._privateChannelForSplitView=new q();this._localRulesPresenter.init(this._privateChannelForRules,this._applicationChannel,this._privateChannelForSplitView,O);var N={modelEvents:this._privateChannelForSplitView,withtransition:true,withoverflowhidden:false,params:{leftWidth:40,leftVisible:true,rightVisible:false,rightMaximizer:true,leftMaximizer:false}};this._splitView=new I();this._splitView.init(N);this._PCListPresenter=new u();this._PCListPresenter.init(this._privateChannelForPCs,this._applicationChannel,T);this._idCardAttrbEditorUtil=new F();this._idCardAttrbEditorUtil.init(this._privateModelEvents);this._initCommand();this._subscribeToEvents();this._initDivs();this._initWebUXTabs();var R=this};y.prototype._subscribeToEvents=function(){var N=this;this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-minified"},function(O){l.updateCollapse(N._pathModelDetail,true)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-container-maximized"},function(O){l.updateCollapse(N._pathModelDetail,false)});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-dropdown-menu-action"},function(O){N.actionDropDownMenuIdCard(O)});this._myEventManager.subscribe(this._privateChannelForDocs,{event:"enoxdoc-double-click"},function(O){x.navigate(M.ROUTE_MODEL_DOC_DETAILS,O)});this._myEventManager.subscribe(this._privateChannelForRules,{event:"splitview-restore-panel"},function(){console.log("receiving restore");N._bridgeModelEvent.publish({event:"right-side-show-header"})});this._myEventManager.subscribe(this._privateChannelForRules,{event:"splitview-maximize-panel"},function(){console.log("receiving maximize");N._bridgeModelEvent.publish({event:"right-side-hide-header"})});N._rulesSolver=false;this._myEventManager.subscribe(this._privateChannelForRules,{event:"rule_init_complete"},function(O){N._rulesSolver=true});this._myEventManager.subscribe(this._privateChannelForRules,{event:"on-preview"},function(O){N.selectedRule=N.selectedRule?N.selectedRule:{};N.RulesPreviewActivated=O.activated;N.onRulesPreview(N.selectedRule,O.activated)});this._myEventManager.subscribe(this._privateChannelForRules,{event:"mr-onsavedone"},function(O){N._privateModelEvents.publish({event:"model-version-rule-updated",data:O})});this._myEventManager.subscribe(this._privateChannelForRules,{event:"expr-rule-onsavedone"},function(O){N._privateModelEvents.publish({event:"model-version-rule-updated",data:O})});this._myEventManager.subscribe(this._privateChannelForRules,{event:"local-rule-deleted"},function(O){N._privateModelEvents.publish({event:"model-version-rule-updated",data:O})});this._myEventManager.subscribe(this._privateModelEvents,{event:"model-version-rule-updated"},function(O){console.log("Model Version Rule is updated!!!");N._modelVersionRuleUpdated=true});this._myEventManager.subscribe(this._privateChannelForRules,{event:"xmodel-list-item-on-add-selection"},function(O){if(O.items.length==1){N.selectedRule=O.model}else{N.selectedRule=null}N.onRulesPreview(N.selectedRule,N.RulesPreviewActivated)});this._myEventManager.subscribe(this._privateChannelForRules,{event:"xmodel-list-item-on-remove-selection"},function(O){if(O.items.length==1){N.selectedRule=O.items[0].options.grid}else{N.selectedRule=null}N.onRulesPreview(N.selectedRule,N.RulesPreviewActivated)});this._myEventManager.subscribe(this._privateChannelForRules,{event:"xmodel-list-item-on-dblclick"},function(O){var P=O.model;C.mask(N._container);N._checkForSolverUpdates().then(function(){function R(){N.previouslySelectedRule=P.id;x.navigate(M.ROUTE_MODEL_RULE_DETAILS,{id:P.id,name:P.title,image:P.image,version:null});C.unmask(N._container);if(N._ruleDetailsStatePresenter){N._ruleDetailsStatePresenter.unmaskRuleContent()}}function Q(){if(N._rulesSolver){N._rulesSolverInit=true;if(S){clearTimeout(S)}if(N._ruleDetailsStatePresenter){N._ruleDetailsStatePresenter.updateView();N._ruleDetailsStatePresenter.unmaskRuleContent()}}else{if(N._ruleDetailsStatePresenter){N._ruleDetailsStatePresenter.maskRuleContent()}var S=setTimeout(function(){Q()},1000)}}if(P.id){if(N.previouslySelectedRule&&P.id!=N.previouslySelectedRule){i.setRuleActivation(N.previouslySelectedRule,"true",N._solverKeyForRules).then(function(){R()},function(){C.unmask(N._container)})}else{R()}}Q()})});this._myEventManager.subscribe(this._privateChannelForPCs,{event:"on-preview"},function(O){console.log("PC selected (Single click)");N._privateChannelForPCs.publish({event:"xmodel-list-item-get-selection",data:function(P){console.log("PC unselected (Single click)");N.PCPreviewActivated=O.activated;N.onPCPreview_NEW(P,O.activated,"added")}})});this._myEventManager.subscribe(this._privateChannelForPCs,{event:"xmodel-list-item-on-dblclick"},function(O){var P=O.model;x.navigate(M.ROUTE_MODEL_PC_DETAILS,{id:P.id,name:P.name,image:P.image,version:null})});this._myEventManager.subscribe(this._privateChannelForPCs,{event:"xmodel-list-item-on-add-selection"},function(O){var P=O.model;N.onPCPreview_NEW(P,N.PCPreviewActivated,"added")});this._myEventManager.subscribe(this._privateChannelForPCs,{event:"xmodel-list-item-on-remove-selection"},function(O){console.log("PC unselected (Single click)");var P=O.model;N.onPCPreview_NEW(P,N.PCPreviewActivated,"removed")});this._myEventManager.subscribe(this._privateChannelForPCs,{event:"xmodel-list-item-on-empty-selection"},function(O){console.log("PC unselected(remove all)");N._newPCSummaryPresenter.removeAllPCColumns()});this._myEventManager.subscribe(this._bridgeModelEvent,{event:"right-side-bar-tab-changed"},function(O){N._privateChannelForSplitView.publish({event:"splitview-hide-panel",data:"right"});N._privateChannelForRules.publish({event:"wrapped-adv-set-view-resize",data:function(){N._privateChannelForSplitView.publish({event:"splitview-hide-panel",data:"right"})}});N._privateChannelForPCs.publish({event:"wrapped-adv-set-view-resize",data:function(){N._privateChannelForSplitView.publish({event:"splitview-hide-panel",data:"right"})}});if(O.idx=="_0"){G.setContext("Variability")}else{if(O.idx=="_1"){G.setContext("Rules");N.onRulesPreview(N.selectedRule,N.RulesPreviewActivated)}else{if(O.idx=="_2"){G.setContext("ProductConfigurations");N._privateChannelForPCs.publish({event:"xmodel-list-item-get-selection",data:function(P){console.log("PC unselected (Single click)");N.onPCPreview_NEW(P,N.PCPreviewActivated,"added")}})}else{if(O.idx=="_3"){G.setContext("Documents")}}}}});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-open-version-explorer"},function(O){if(N.versionExplorer){N.versionExplorer.showVersionExplorer()}});this._myEventManager.subscribe(this._privateModelEvents,{event:"idcard-model-refresh"},function(O){N._refreshIdCardModel()});this._myEventManager.subscribe(this._privateModelEvents,{event:"model-version-action-open"},function(O){N.navigateToModel(O.id)});this._myEventManager.subscribe(this._privateModelEvents,{event:"model-version-variability-updated"},function(O){console.log("Model Version Variability is updated!!!");N._modelVersionVariabilityUpdated=true})};y.prototype._deleteModels=function(R){var P=this;var O=R;H.deleteModelVersions({ids:O}).then(function Q(S){x.navigate(M.ROUTE_MODELS,{});P._applicationChannel.publish({event:"breadcrumb-remove-link",data:M.ROUTE_MODEL_INFO})},function N(S){console.log("Failure while deleting model versions!!!");K.showError(c.DELETE_MODELS_ERROR)})};y.prototype.actionDropDownMenuIdCard=function(O){var N=this;switch(O){case"information":G.removeAllSelection();G.showInformation(N._id);break;case"delete":N._deleteModels([N._id]);break;case"owner":N._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:N._options,linkId:"owner"}});break;case"state":N._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:N._options,linkId:"state"}});break;case"revision":N._privateModelEvents.publish({event:"xmodel-execute-command",data:{model:N._options,linkId:"revision"}});break;default:}};y.prototype._initCommand=function(){this._command=new z(this._privateModelEvents,this._container)};y.prototype.navigateToModel=function(O){if(O){var N=this;C.mask(this._container);H.getModelDetails({id:O}).then(function(R){console.log("getModelDetails: Service Call Successful");var Q=R.member[0].name;var P=R.member[0].revision;C.unmask(N._container);x.navigate(M.ROUTE_MODEL_DETAILS,{id:O,name:Q,version:P},{reload:true})},function(P){C.unmask(N._container);console.log("getModelDetails: Service Call Failed !!!");K.showError(c.GET_MODEL_DETAILS_ERROR)})}};y.prototype._initDivs=function(){var N=this;this._container=UWA.createElement("div");this._container.classList.add("model-details");this._contentBottom=UWA.createElement("div");this._contentBottom.classList.add("bot-content");this._splitView.inject(this._contentBottom);this._leftPanelBottom=this._splitView.getLeft();this._rightPanelBottom=UWA.extendElement(this._splitView.getRight());this._variabilityContainer=UWA.createElement("div");this._variabilityContainer.classList.add("model-variability-container");this._rulesContainer=UWA.createElement("div");this._rulesContainer.classList.add("model-rules-container");this._localRulesPresenter.inject(this._rulesContainer);this._productConfigurationContainer=UWA.createElement("div");this._productConfigurationContainer.classList.add("model-PC-container");this._PCListPresenter.inject(this._productConfigurationContainer);this._specsContainer=document.createElement("div");this._specsContainer.classList.add("model-doc-container")};y.prototype._initWebUXTabs=function(){var T=l.getTab(this._pathModelDetail)||"_0";var S={label:c._variability,isSelected:T=="_0"?true:false,index:0,value:"_0",allowUnsafeHTMLOnTabButton:false,content:this._variabilityContainer};var P={label:c._rules,isSelected:T=="_1"?true:false,index:1,value:"_1",allowUnsafeHTMLOnTabButton:false,content:this._rulesContainer};var O={label:c._product_configurations,isSelected:T=="_2"?true:false,content:this._productConfigurationContainer,allowUnsafeHTMLOnTabButton:false,index:2,value:"_2"};var Q={label:c._documents,isSelected:T=="_3"?true:false,content:this._specsContainer,index:3,value:"_3",allowUnsafeHTMLOnTabButton:false};var N=true;this._webUXTabs=new d({showComboBoxFlag:true,touchMode:N,allowUnsafeHTMLOnTabButton:false,displayStyle:["strip"]});this._webUXTabs.tabBar.centeredFlag=false;this._webUXTabs.add(S);this._webUXTabs.add(P);this._webUXTabs.add(O);this._webUXTabs.add(Q);this._webUXTabs.getContent().classList.add("height100");this._webUXTabs.tabPanelContainer.classList.add("tab-content");if(N){this._webUXTabs.tabPanelContainer.classList.add("tab-in-mobile")}this._webUXTabs.inject(this._leftPanelBottom);var R=this;this._webUXTabs.addEventListener("change",function(V){if(V.dsModel==undefined||V.dsModel.value==undefined){return}l.updateTab(R._pathModelDetail,V.dsModel.value[0]);var U=(V.dsModel&&V.dsModel.value)?V.dsModel.value[0]:undefined;if(!R._previousTabIndex){R._previousTabIndex="_0"}switch(R._previousTabIndex){case"_0":R._variabilityPresenter&&R._variabilityPresenter.clearTags();break;case"_1":R._localRulesPresenter&&R._localRulesPresenter.clearTags();break;case"_2":R._PCListPresenter&&R._PCListPresenter.clearTags();break;case"_3":R._docsPresenter&&R._docsPresenter.clearTags();break}R._previousTabIndex=U;switch(U){case"_0":R._variabilityPresenter&&R._variabilityPresenter.publishTags();w.workaroundCheckAndWakeUpResizeSensor(R._variabilityContainer);break;case"_1":R._localRulesPresenter&&R._localRulesPresenter.publishTags();w.workaroundCheckAndWakeUpResizeSensor(R._rulesContainer);break;case"_2":R._PCListPresenter&&R._PCListPresenter.publishTags();w.workaroundCheckAndWakeUpResizeSensor(R._productConfigurationContainer);break;case"_3":R._docsPresenter&&R._docsPresenter.publishTags();w.workaroundCheckAndWakeUpResizeSensor(R._specsContainer);break;default:break}R._bridgeModelEvent.publish({event:"right-side-bar-tab-changed",data:{idx:U}})})};y.prototype.inject=function(N){N.appendChild(this._container);if(this._privateModelEvents){w.setModelEventForIdCard(this._privateModelEvents)}};y.prototype._loadData=function(Q){var P=this;if(Q===undefined||Q===null){return}this._modelForIdCard=w.prepareIdCardData(Q,this._privateModelEvents);this._idCardAttrbEditorUtil.setModelAndInitCollabObj(this._modelForIdCard);this._enoxIDCardContainer.init({modelEvents:this._privateModelEvents},this._modelForIdCard);P._container.empty();P._enoxIDCardContainer.inject(P._container);var O=P._enoxIDCardContainer.getMainContent();O.appendChild(P._contentBottom);if(l.getCollapse(this._pathModelDetail)){this._privateModelEvents.publish({event:"idcard-toggle-minified-view"})}else{}var N=P._enoxIDCardContainer.getIDCard();if(N){var R=N.getElement(".version");if(R){this.versionExplorer=new k({id:this._id,name:this._modelVersionName,target:R,renderTo:this._container,modelEvents:this._privateModelEvents});this._privateModelEvents.subscribe({event:"model-version-action-create-new-revision"},function(S){P.createModelRevision(S).then(function U(){P._privateModelEvents.publish({event:"refresh-version-explorer-on-create-revision"})},function T(){console.log("Failed!!!")})})}}};y.prototype._loadVariabilityData=function(P){try{var O=UWA.clone(P);if(O&&!O._version){O._version="2.0"}this._variabilityPresenter=new s({editable:this._allowEdit,modelId:this._id,model:this._modelForIdCard,dictionaryJSON:O,applicationChannel:this._applicationChannel,localChannel:this._privateModelEvents});this._variabilityPresenter.render().inject(this._variabilityContainer);w.workaroundCheckAndWakeUpResizeSensor(this._variabilityContainer);this._variabilityPresenter.publishTags()}catch(N){console.log("[ModelDetailsStatePresenter:_loadVariabilityData] Exception occured!!!"+N.message)}};y.prototype.initiateDocumentPresenter=function(){this._docsPresenter=new r();this._docsPresenter.init(this._privateChannelForDocs,this._applicationChannel,{id:this._id});this._docsPresenter.inject(this._specsContainer)};y.prototype._fetchData=function(){var O=this;C.mask(this._container);C.mask(this._variabilityContainer);H.getModelDetails({id:O._id}).then(function(S){console.log("getModelDetails: Service Call Successful !!!");O._modelName=S["@modelName"];O._modelPhysId=S["@modelPhysId"];O._modelVersionName=S.member["0"].title;O._modelVersionVersion=S.member["0"].revision;var R=S.member["0"].state;O._modelMaturity=R;if(R&&(R==="Review"||R==="Release"||R==="Obsolete")){O._allowEdit=false}else{O._allowEdit=true}if(O._isDestroyed){if(v){console.log("model details destroyed before being loaded")}C.unmask(O._container);return}O._loadData(S);j.addRecentItemsIds(function(){},function(){},O._id);C.unmask(O._container)},function(R){console.log("getModelDetails: Service Call Failed !!!");C.unmask(O._container);K.showError(c.GET_MODEL_DETAILS_ERROR)});var Q=function(R){};var P=function(R){};var N=function(R){console.log("failing on solver initialization")};o.getVariabilityDefinition({componentId:O._id,content:{attributes:3,parameters:(M.PARAMETERS_ENABLED!=undefined)?M.PARAMETERS_ENABLED:false,attributeList:["_image"]}}).then(function(U){console.log("getVariabilityDefinition: Service Call Successful !!!");if(O._isDestroyed){if(v){console.log("model details destroyed before being loaded")}return}O._loadVariabilityData(U);O._variabilityDictionary=U;O._dictionaryForRule=O._filterDictionary(UWA.clone(O._variabilityDictionary));O._removeParametersFromDico(O._dictionaryForRule);O._newPCSummaryPresenter.loadModelVariabilityInformation((M.PARAMETERS_ENABLED?U:UWA.clone(O._dictionaryForRule)));C.unmask(O._variabilityContainer);var W=function(Y){console.log("success");O._solverKeyForRules=Y.solverKey;var Z={solverKey:O._solverKeyForRules,jsonData:O._dictionaryForRule};if(M.SOLVER_DEBUG_MODE){var X={_from:"ruleEditor",_to:"solver",_request:"tracesActivation",_data:{activation:"yes",path:M.SOLVER_DEBUG_PATH,level:M.SOLVER_DEBUG_LEVEL}};i.computeAnswer(X,O._solverKeyForRules).then(function(){console.log()})}return i.initialize(Z)};var T=function(X){console.log("failure")};var S=function(X){console.log("success 1");O._privateChannelForRules.publish({event:"rule_init_complete"})};var V=function(X){console.log("failure 1")};var R=i.create().then(W,T).then(S,V)},function(R){console.log("getVariabilityDefinition: Service Call Failed !!!");C.unmask(O._variabilityContainer);K.showError(c.GET_MODEL_VARIABILITY_ERROR)});O.initiateDocumentPresenter();O._localRulesPresenter.loadData();O._PCListPresenter.loadData()};y.prototype.getVariabilityDefinitionPromise=function(){};y.prototype._removeParametersFromDico=function(N){try{if(N&&N.portfolioClasses.member[0].portfolioComponents.member[0].parameters){delete N.portfolioClasses.member[0].portfolioComponents.member[0].parameters}}catch(O){console.log("Warning! Either dico is not in proper format or it does not have parameters.")}};y.prototype.destroy=function(){this._container=null;this._isDestroyed=true;A.releaseSolver();x.setDependency("modelDetailsStatePresenter",null);if(this._myEventManager){this._myEventManager.cleanup("ModelDetailsStatePresenter");this._myEventManager=null}};y.prototype._addRouterPath=function(){var N=this;var P=null;var O=""};y.prototype._initPCDetails=function(N){this._PCDetailsStatePresenter=new D();N.modelName=this._modelName;N.modelPhysId=this._modelPhysId;N.modelVersionName=this._modelVersionName;N.modelVersionVersion=this._modelVersionVersion;N.variabilityDictionary=this._variabilityDictionary;if(!(this._variabilityDictionary&&this._variabilityDictionary.portfolioClasses)||this._modelVersionVariabilityUpdated||this._modelVersionRuleUpdated){N.reloadVariability=true}else{N.reloadVariability=false}this._PCDetailsStatePresenter.init(this._applicationChannel,this._updateChannelLocal,N);x.setDependency("PCDetailsStatePresenter",this._PCDetailsStatePresenter);var O=this._container.parentElement;this._container.parentElement.removeChild(this._container);this._PCDetailsStatePresenter.inject(O)};y.prototype._initRuleDetails=function(O){var P=this;C.mask(P._container);return this._checkForSolverUpdates().then(function N(){P._ruleDetailsStatePresenter=new m();O.solverKey=P._solverKeyForRules;O.dictionary=P._dictionaryForRule;O.modelVersionName=P._modelVersionName;O.modelVersionVersion=P._modelVersionVersion;var R={ruleId:O.id,modelId:P._id,ruleName:O.name,editable:P._allowEdit};P._ruleDetailsStatePresenter.init(R,P._privateChannelForRules,P._applicationChannel,O);x.setDependency("RuleDetailsStatePresenter",P._ruleDetailsStatePresenter);var S=P._container.parentElement;P._container.parentElement.removeChild(P._container);P._ruleDetailsStatePresenter.inject(S);if(P._localRulesPresenter){P._localRulesPresenter.clearTags()}C.unmask(P._container);return UWA.Promise.resolve()},function Q(){console.log("[ModelDetailsPresenter: _initRuleDetails] Check for Solver Updates failed.");C.unmask(P._container);return UWA.Promise.reject()})};y.prototype._initDocDetails=function(N){this._DocDetailsPresenter=new g();this._DocDetailsPresenter.init(this._applicationChannel,N);x.setDependency("DocDetailsPresenter",this._DocDetailsPresenter);var O=this._container.parentElement;this._container.parentElement.removeChild(this._container);this._DocDetailsPresenter.inject(O);if(this._docsPresenter){this._docsPresenter.clearTags()}x.setDependency("DocPresenter",this._docsPresenter)};y.prototype.onRuleSelect=function(P){var O={ruleId:P.id,modelId:this._id,ruleName:P.title};var N={};N.solverKey=this._solverKeyForRules;N.solverModelEvent=this._solverModelEvent;N.editable=this._allowEdit;if(this._solverKeyForRules&&this._dictionaryForRule){N.contextDictionary=this._dictionaryForRule;N.dictionary=this._dictionaryForRule;this._privateChannelForSplitView.publish({event:"splitview-show-panel",data:"right"});this._rulePresenter.clear();this._rightPanelBottom.innerHTML="";this._rulePresenter.init(O,this._privateChannelForRules,this._applicationChannel,P.id,N);this._rulePresenter.inject(this._rightPanelBottom)}else{}};y.prototype.onRulesPreview=function(Q,N){if(N){this._rightPanelBottom.innerHTML="";this._privateChannelForSplitView.publish({event:"splitview-show-panel",data:"right"});if(Q){C.mask(this._rightPanelBottom);var O=this;O._checkForSolverUpdates().then(function(){if(O.selectedRule){if(O.previouslySelectedRule){i.setRuleActivation(O.previouslySelectedRule,"true",O._solverKeyForRules).then(function(){O.onRuleSelect(O.selectedRule);O.previouslySelectedRule=O.selectedRule.id;C.unmask(O._rightPanelBottom)},function R(){C.unmask(O._rightPanelBottom)})}else{C.unmask(O._rightPanelBottom);O.onRuleSelect(O.selectedRule);O.previouslySelectedRule=O.selectedRule.id}}else{C.unmask(O._rightPanelBottom);O.setRightPanelMessage()}},function P(){C.unmask(O._rightPanelBottom);console.log("Error: reloading variability dico and/or initialization of solver!!!");K.showError("Error while reloading Variability and/or initializing solver!!")})}else{this.setRightPanelMessage()}}else{this._rightPanelBottom.innerHTML="";this._privateChannelForSplitView.publish({event:"splitview-hide-panel",data:"right"});this._privateChannelForRules.publish({event:"triptych-hide-panel-if-opened-from-rule",data:{}})}};y.prototype.onPCPreview_NEW=function(P,N,O){if(N===true){this._privateChannelForSplitView.publish({event:"splitview-show-panel",data:"right"});if(P==undefined||(Array.isArray(P)&&P.length<=0)){this.setRightPanelMessage(c._PCPreviewMessage)}else{if(this._rightPanelBottom.getElementsByClassName("pc-summary").length<=0){this.resetRightPanelMessage()}C.mask(this._rightPanelBottom);this._newPCSummaryPresenter.inject(this._rightPanelBottom);if(O==="added"){this._newPCSummaryPresenter.loadConfigurationInfo(P)}else{if(O==="removed"){this._newPCSummaryPresenter.unloadConfigurationInfo(P);if(this._newPCSummaryPresenter.loadedPCsCount()<=0){this.setRightPanelMessage(c._PCPreviewMessage)}}}C.unmask(this._rightPanelBottom)}}else{if(N===false){this._rightPanelBottom.innerHTML="";this._privateChannelForSplitView.publish({event:"splitview-hide-panel",data:"right"})}}};y.prototype.setRightPanelMessage=function(N){this._rightPanelBottom.innerHTML=N?N:c._no_data_in_preview;this._rightPanelBottom.classList.add("noContentTitle")};y.prototype.resetRightPanelMessage=function(N){this._rightPanelBottom.innerHTML="";this._rightPanelBottom.classList.remove("noContentTitle")};y.prototype._refreshIdCardModel=function(){var N=this;H.getModelDetails({id:N._id}).then(function(Q){var P=Q.member[0];N._modelName=P.modelName;N._modelPhysId=P.modelID;N._modelVersionName=P.title;N._modelVersionVersion=P.revision;var O=P.state;N._modelMaturity=O;if(O&&(O==="Review"||O==="Release"||O==="Obsolete")){N._allowEdit=false}else{N._allowEdit=true}N._privateChannelForRules.publish({event:"set-rule-editable",data:N._allowEdit});if(N._isDestroyed){if(v){console.log("model details destroyed before being loaded")}return}var R=w.prepareIdCardData(Q,N._privateModelEvents);N._modelForIdCard.set("attributes",R.get("attributes"));N._modelForIdCard.set("name",R.get("name"));N._modelForIdCard.set("freezones",R.get("freezones"))},function(O){console.log("getModelDetails: Service Call Failed !!!");K.showError(c.GET_MODEL_DETAILS_ERROR)})};y.prototype.createModelRevision=function(O){if(O){var N=this;return H.createModelVersion({sourceObjectID:O.id,intent:"Evolution",attributes:{name:O.name,revision:"",description:"",title:O.title}}).then(function(P){console.log("createModelVersion: For Revision Service Call Successful")},function(P){console.log("CreateModelVersion for revise: Service Call Failed !!!");K.showError("Create Model Revision Service call failed")})}else{console.log("[createModelRevision] Error: Invalid Inputs!!!");return UWA.Promise.reject()}};y.prototype._filterDictionary=function(O){var N=function(R){if(UWA.is(R,"array")){for(var Q=R.length-1;Q>=0;Q--){if(N(R[Q])){R.splice(Q,1)}}}else{if(UWA.is(R,"object")){if(R.attributes&&R.attributes._maturity){if(R.attributes._maturity=="Obsolete"){return true}}else{for(var P in R){if(R.hasOwnProperty(P)){N(R[P])}}}}}return false};N(O);return O};y.prototype._reloadVariabilityAndSolverKeys=function(){var N=this;console.log(">>> Model Version Variability has been updated, reloading variability & initializing solver keys!!! <<<");this._modelVersionVariabilityUpdated=false;this._modelVersionRuleUpdated=false;return o.getVariabilityDefinition({componentId:N._id,content:{parameters:(M.PARAMETERS_ENABLED!=undefined)?M.PARAMETERS_ENABLED:false,attributes:3,attributeList:["_image"]}}).then(function(O){console.log("getVariabilityDefinition: Service Call Successful !!!");if(N._isDestroyed){if(v){console.log("model details destroyed before being loaded")}return}N._variabilityDictionary=O;N._dictionaryForRule=N._filterDictionary(UWA.clone(N._variabilityDictionary));N._removeParametersFromDico(N._dictionaryForRule)},function(O){console.log("getVariabilityDefinition: Service Call Failed !!!");K.showError(c.GET_MODEL_VARIABILITY_ERROR);return UWA.Promise.reject(" getVariabilityDefinition Failed!!!")}).then(function(){return new UWA.Promise(function(R,Q){var T=function(V){console.log("success");N._solverKeyForRules=V.solverKey;var W={solverKey:N._solverKeyForRules,jsonData:N._dictionaryForRule};if(M.SOLVER_DEBUG_MODE){var U={_from:"ruleEditor",_to:"solver",_request:"tracesActivation",_data:{activation:"yes",path:M.SOLVER_DEBUG_PATH,level:M.SOLVER_DEBUG_LEVEL}};i.computeAnswer(U,N._solverKeyForRules).then(function(){console.log()})}return i.initialize(W)};var P=function(U){console.log("Error: create rule solver failure");Q()};var O=function(U){R();console.log("success 1")};var S=function(U){Q();console.log("Error: initialize rule solver failure")};if(N._solverKeyForRules){return i.clearSolver(N._solverKeyForRules).then(function(){return T({solverKey:N._solverKeyForRules})},P).then(O,S)}else{return i.create().then(T,P).then(O,S)}})},function(){console.log("failed!!!");return UWA.Promise.reject()})};y.prototype._checkForSolverUpdates=function(){if(!this._variabilityDictionary||this._modelVersionVariabilityUpdated||this._modelVersionRuleUpdated){return this._reloadVariabilityAndSolverKeys()}else{return UWA.Promise.resolve()}};return y});define("DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EnterpriseVariabilityDictionaryStatePresenter",["DS/Controls/Tab","DS/CoreEvents/ModelEvents","DS/xModelEventManager/xModelEventManager","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoItemDetailsPresenter","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoItemsPresenter","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/ParametersPresenter","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EntDicoPresenterSettingsProvider","i18n!DS/ENOXModelApp/assets/nls/EnterpriseVariabilityDictionary/EnterpriseVariabilityDictionaryStatePresenter","css!DS/ENOXModelApp/EnterpriseVariabilityDictionary/css/EnterpriseVariabilityDictionary.css"],function(f,n,d,j,w,x,t,e,i,k,a,c,p,m,b){var q=function(){};var o=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var v=false;var s=0;var l="_0";var h=1;var g="_1";var u=2;var r="_2";q.prototype.init=function(z,A,y){this._pathEntrepriseVariability=[e._KEY,e._VIEWS_PREFERENCES,e._ENTREPRISE_VARIANTS_OPTIONS];this._needRefresh=false;this._isDestroyed=false;this._options=y?y:{};this._currentTab=i.getTab(this._pathEntrepriseVariability)||l;this._applicationChannel=z;this._updateChannel=A;this._privateChannelForTabs=new n();this._updateChannelLocal=new n();this._privateChannelForVariants=new n();this._privateChannelForParameters=new n();this._privateChannelForVg=new n();this._privateChannelForOptions=new n();this._myEventManager=new d(this._applicationChannel,this._privateChannelForTabs,this._updateChannelLocal,this._privateChannelForVariants,this._privateChannelForVg,this._privateChannelForOptions);this._addRouterPath();this._isParametersEnabled=(a.PARAMETERS_ENABLED!=undefined)?a.PARAMETERS_ENABLED:false;this._variantsPresenter=new x();this._variantsPresenter.init(this._privateChannelForVariants,z,{someOptions:"cool option for VariantClass",tagFriends:"VariantsTagProxy",settings:p.getVariantsPresenterSettings()});this._VariabilityGroupPresenter=new x();this._VariabilityGroupPresenter.init(this._privateChannelForVg,z,{tagFriends:"VGOptionsPresenter",noPublishOnCreate:true,settings:p.getOptionGroupsPresenterSettings()});if(this._isParametersEnabled){this._parametersPresenter=new t();this._parametersPresenter.init(this._privateChannelForParameters,{applicationChannel:z})}this._loaded={};this._loaded.variantClasses=false;this._loaded.options=false;this._loaded.parameters=false;this._initDiv();this._subscribeToEvents();this._variantsPreviewActivated=false;k.setContext("EnterpriseDico")};q.prototype._subscribeToEvents=function(){var y=this};q.prototype._initDiv=function(){var y=this;this._container=document.createElement("div");this._container.classList.add("enterprise-variability-dictionary");this._variantsContainer=document.createElement("div");this._variantsContainer.classList.add("variants-container");this._optionsContainer=document.createElement("div");this._optionsContainer.classList.add("options-container");this._parametersContainer=document.createElement("div");this._parametersContainer.classList.add("parameters-container");[this._variantsContainer,this._optionsContainer,this._parametersContainer].forEach(function(A,z){A.classList.add("width100");A.classList.add("height100")});this._variantsPresenter.inject(this._variantsContainer);this._VariabilityGroupPresenter.inject(this._optionsContainer);if(this._isParametersEnabled){this._parametersPresenter.inject(this._parametersContainer)}this._initWebUXTabs()};q.prototype._initWebUXTabs=function(){var y=true;this._webUXTabs=new f({showComboBoxFlag:true,touchMode:y,displayStyle:["strip"],allowUnsafeHTMLOnTabButton:false});this._webUXTabs.tabBar.centeredFlag=false;this._webUXTabs.add({label:m.VARIANTS,isSelected:this._currentTab==l?true:false,index:s,value:l,content:this._variantsContainer,allowUnsafeHTMLOnTabButton:false});this._webUXTabs.add({label:m.OPTIONS,isSelected:this._currentTab==g?true:false,index:h,value:g,content:this._optionsContainer,allowUnsafeHTMLOnTabButton:false});if(this._isParametersEnabled){this._webUXTabs.add({label:m.PARAMETERS,isSelected:this._currentTab==r?true:false,index:u,value:r,content:this._parametersContainer,allowUnsafeHTMLOnTabButton:false})}this._webUXTabs.getContent().classList.add("height100");this._webUXTabs.tabPanelContainer.classList.add("tab-content");if(y){this._webUXTabs.tabPanelContainer.classList.add("tab-in-mobile")}this._webUXTabs.inject(this._container);var z=this;this._webUXTabs.addEventListener("change",function(A){if(A.dsModel===undefined||(A.dsModel&&!A.dsModel.value)){return}i.updateTab(z._pathEntrepriseVariability,A.dsModel.value[0]);console.log("changing tab to - "+A.dsModel.value[0]);z._currentTab=A.dsModel.value[0];if(l===z._currentTab){z._privateChannelForVg.publish({event:"onTabChange",data:{}});c.workaroundCheckAndWakeUpResizeSensor(z._variantsContainer);k.setContext("VariantClasses");z._VariabilityGroupPresenter.clearTags();z._variantsPresenter.publishTags()}else{if(g===z._currentTab){k.setContext("VariablityGroup");z._privateChannelForVg.publish({event:"onTabChange",data:{}});c.workaroundCheckAndWakeUpResizeSensor(z._optionsContainer);z._variantsPresenter.clearTags();z._VariabilityGroupPresenter.publishTags()}else{if(r===z._currentTab){c.workaroundCheckAndWakeUpResizeSensor(z._parametersContainer)}}}})};q.prototype.inject=function(y){y.appendChild(this._container)};q.prototype.destroy=function(){if(this._container&&this._container.parentElement){this._container.parentElement.removeChild(this._container)}if(this._variantsPresenter){this._variantsPresenter.destroy()}if(this._VariabilityGroupPresenter){this._VariabilityGroupPresenter.destroy()}if(this._myEventManager){this._myEventManager.cleanup("EnterpriseVariabilityDictionaryStatePresenter");this._myEventManager=null}};q.prototype.loadData=function(y){if(y||this._loaded.variantClasses===false){this._variantsPresenter.loadData();this._loaded.variantClasses=true;c.workaroundCheckAndWakeUpResizeSensor(this._variantsContainer)}if(y||this._loaded.options===false){this._VariabilityGroupPresenter.loadData();this._loaded.options=true}if(this._isParametersEnabled&&(y||this._loaded.parameters===false)){this._parametersPresenter.loadData();this._loaded.parameters=true}if(l===this._currentTab){this._variantsPresenter.publishTags()}};q.prototype._addRouterPath=function(){var y=this;var z=null};q.prototype._initAndLoadDataVariantClassDetails=function(y){this._variantDetailsStatePresenter=new w();j.setDependency("variantDetailsStatePresenter",this._variantDetailsStatePresenter);y.settings=p.getVariantDetailsPresenterSettings();y.settingsForSubItems=p.getVariantValuesPresenterSettings();this._variantDetailsStatePresenter.init(this._applicationChannel,this._privateChannelForVariants,y);var z=this._container.parentElement;this._container.parentElement.removeChild(this._container);this._variantDetailsStatePresenter.inject(z)};q.prototype._initAndLoadDataOptionGroupDetails=function(y){this._optionGroupDetailsStatePresenter=new w();j.setDependency("optionGroupDetailsStatePresenter",this._optionGroupDetailsStatePresenter);y.settings=p.getOptionGroupDetailsPresenterSettings();y.settingsForSubItems=p.getOptionsPresenterSettings();this._optionGroupDetailsStatePresenter.init(this._applicationChannel,this._privateChannelForVg,y);var z=this._container.parentElement;this._container.parentElement.removeChild(this._container);this._optionGroupDetailsStatePresenter.inject(z)};return q});define("DS/ENOXModelApp/ModelDefinition/js/ModelsStatePresenter",["DS/UIKIT/Mask","DS/CoreEvents/ModelEvents","UWA/Element","DS/ENOXModelApp/ModelDefinition/js/ModelDetailsStatePresenter","DS/ENOXModelApp/InformationPanels/CommonInfoPresenter","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelCommand","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","DS/Tree/TreeDocument","DS/WebappsUtils/WebappsUtils","DS/TreeModel/DataModelSet","DS/ENOXModelApp/ModelDefinition/js/DuplicateModelPresenter","DS/xPortfolioQueryServices/js/xPortfolioModel","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/ENOXModelApp/Utils/xModelCommonUtils","DS/ENOXModelApp/components/DialogDeletion/DialogDeletion","DS/ENOXModelApp/components/DialogCreation/DialogCreation_ModelVersion","DS/xModelEventManager/xModelEventManager","DS/ENOXModelApp/Utils/xModelPreferencesConstant","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","i18n!DS/ENOXModelApp/assets/nls/xModelApp_Common","i18n!DS/ENOXModelApp/assets/nls/ModelDefinition/ModelsStatePresenter","css!DS/ENOXModelApp/ModelDefinition/css/ModelsStatePresenter.css"],function(C,p,t,g,B,o,c,a,k,y,l,h,z,A,v,n,b,e,m,s,f,i,w,x,u,r,d,j){var q=function(){};q.prototype.init=function(E,G,D){var F=this;this._pathModel=[i._KEY,i._VIEWS_PREFERENCES,i._MODEL_VERSIONS];this._isDestroyed=false;this._needRefresh=true;this._options={};this._applicationChannel=E;this._updateChannel=G;this._addRouterPath();this._uniqueId=new Date();this._modelInfoPresenter=null;this._modelInfoPresenterModelEvents=new p();this._currentSelectionDetails={};this._currInfoId="";o.initialize({applicationChannel:E});n.setDependency("InformationPanelManager",o);this._updateChannelLocal=new p();this._privateChannel=new p();this._myEventManager=new f(this._applicationChannel,this._modelInfoPresenterModelEvents,this._updateChannelLocal,this._privateChannel);this._subscribeEvent();this._xModelListView=null;this._initializeListView();this.summaryData=[];this._initDivs();this._initCommand()};q.prototype._initCommand=function(){this._command=new c(this._updateChannelLocal,this._container);var D=this;this._myEventManager.subscribe(this._updateChannelLocal,{event:"model-version-action-create-new-revision"},function(E){if(E){v.createModelVersion({sourceObjectID:E.id,intent:"Evolution",attributes:{name:E.name,revision:"",description:"",title:E.title}}).then(function(F){D._updateChannelLocal.publish({event:"refresh-version-explorer-on-create-revision"});D._updateChannelLocal.publish({event:"version-explorer-new-version-created",data:{id:F.value}})},function(F){console.log("CreateModelVersion for revise: Service Call Failed !!!");x.showError("Create Model Revision Service call failed")})}});this._myEventManager.subscribe(this._updateChannelLocal,{event:"model-version-action-open"},function(E){var F=E.id;if(F){v.getModelDetails({id:F}).then(function(I){var H=I.member[0].name;var G=I.member[0].revision;n.navigate(b.ROUTE_MODEL_DETAILS,{id:F,name:H,version:G},{reload:true})},function(G){console.log("getModelDetails: Service Call Failed !!!");x.showError(d.GET_MODEL_DETAILS_ERROR)})}})};q.prototype._initializeListView=function(){var H=this;var G=new z();var E=new l({dataModelSet:G});var I=w.getSort(this._pathModel);if(I&&I.sortAttribute&&I.sortOrder){var D={id:I.sortAttribute,order:I.sortOrder}}var F={id:"modelVersions",model:E,useDragAndDrop:true,modelEvents:this._updateChannelLocal,viewOptions:{identifier:"model_versions",views:["DataGridView","TileView","ThumbnailView","LargeThumbnailView"],currentView:w.getView(this._pathModel)||"DataGridView",currentSort:D||undefined,grid:{columns:[{text:r.TITLE,dataIndex:"tree",pinned:"left",editableFlag:true,},{text:r.NAME,dataIndex:"name",},{text:r.VERSION,dataIndex:"revision",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(J){return{label:J.nodeModel.options.grid.revision,url:"#Revision"}}},{text:d.MODEL,dataIndex:"modelName",visibleFlag:false,groupableFlag:true,},{text:r.DESCRIPTION,dataIndex:"description",editableFlag:true},{text:r.MATURITY,dataIndex:"state",groupableFlag:true,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(J){return{label:J.nodeModel.options.grid.state,url:"#Maturity"}}},{text:r.OWNER,dataIndex:"owner",visibleFlag:true,groupableFlag:true,getCellValue:function(J){return{label:J.nodeModel.options.grid.owner?J.nodeModel.options.grid.owner:J.nodeModel.options.grid.responsible,url:"#Owner"}},typeRepresentation:"url",hyperlinkTarget:"_self"},{text:r.CREATION_DATE,dataIndex:"created",},{text:r.MODIFICATION_DATE,dataIndex:"modified",},{text:r.ORGANIZATION,dataIndex:"organization",},{text:r.COLLABSPACE,dataIndex:"collabspace",}]},editable:true,itemViewMapping:{label:"title",subLabel:"state",description:"description"},contextualActions:[{id:"open",title:d.get("open"),text:d.get("open"),fonticon:"export",handler:function(J){console.log("item clicked");n.navigate(b.ROUTE_MODEL_DETAILS,{id:J.id,name:J.title,version:J.revision,state:J.state})}},{id:"information",title:d.get("information"),text:d.get("information"),fonticon:"info",handler:function(J){o.showInformation(J.id)}},{id:"delete",title:d.get("delete"),text:d.get("delete"),fonticon:"trash",handler:function(J){if(J){var K=[{id:J.id,title:J.title}];H.createDeleteModelDialog(K,H._updateChannelLocal)}}}]},emptyContentOptions:{sentences:[{type:"icon",fonticon:"product",sizeicon:"40px",text:r.EMPTY_CONTENT_MESSAGE}]},toolbarOptions:{itemsName:d.get("modelVersionMultiple"),itemName:d.get("modelVersionSingle"),actions:[{id:"create",text:r.CREATE,fonticon:"plus",handler:function(K,J){console.log(H);H.createCreationModelDialog(u.getImmersiveFrame(),H._updateChannelLocal)}},{id:"delete",text:r.DELETE,fonticon:"trash",enableOnSelection:true,handler:function(J,K){console.log("delete action..");var L=J.map(function(M){return{id:M.id,title:M.label}});H.createDeleteModelDialog(L,H._updateChannelLocal)}}]},extensions:[k,y]};this._xModelListView=new a(F)};q.prototype.duplicateModelAction=function(E){console.log("duplicateModelAction");var D=E.revision?E.title+" ("+E.revision+")":E.title;var F=this;A.show({name:D},function(G){UWA.merge(G,{parentID:E.id});F._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});v.duplicateModelVersion(G).then(function(I){var H=I.value;if(!H){if(I.member&&I.member.length>0){H=I.member[0]["id"]}}v.getModelDetails({id:H}).then(function(M){console.log("getModelDetails: Service Call Successful !!!");var J={};for(var L in M.member[0]){if(M.member[0].hasOwnProperty(L)){J[L]=M.member[0][L]}}var K=J;F._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:K});F._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){console.log("getModelDetails: Service Call Failed !!!");x.showError(d.GET_MODEL_DETAILS_ERROR);F._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})},function(){x.showError(d.DUPLICATE_MODEL_ERROR);F._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})})};q.prototype.showSingleInformation=function(D){console.log(D);o.showInformation(D.model.id)};q.prototype._initDivs=function(){var D=this;this._container=UWA.createElement("div");this._container.classList.add("xmodel-models");this._xModelListView.inject(this._container);this._privateChannel.publish({event:"enox-collection-toolbar-disable-action",data:"delete"})};q.prototype._createModel=function(I){var E;var H=this;if(I){var F=I.title?I.title:""}var G={items:[{type:"",versionName:"",attributes:{name:"",description:"",title:F}}]};H._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});v.createModel(G).then(function J(K){E=K.value;if(!E){if(K.member&&K.member.length>0){E=K.member[0]["id"]}}console.log("Created model Id is: "+E);v.getModelDetails({id:E}).then(function(O){console.log("getModelDetails: Service Call Successful !!!");var L={};for(var N in O.member[0]){if(O.member[0].hasOwnProperty(N)){L[N]=O.member[0][N]}}var M=L;H._updateChannelLocal.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(P){P.select()});H._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:M});H._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){console.log("getModelDetails: Service Call Failed !!!");x.showError(d.GET_MODEL_DETAILS_ERROR);H._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})},function D(K){console.log("createModel: Service Call Failed !!!");x.showError(d.CREATE_MODEL_ERROR);H._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})};q.prototype.loadData=function(F){var E=this;if(F||E._needRefresh){E._updateChannelLocal.publish({event:"xmodel-list-data-on-load-start"});v.getModelVersions().then(function G(H){E._updateChannelLocal.publish({event:"xmodel-list-data-load-action",data:H});E._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});E._updateChannelLocal.publish({event:"xmodel-list-view-group-by-action",data:w.getGroup(E._pathModel)});E._updateChannelLocal.publish({event:"enox-collection-toolbar-sort-activated",data:w.getSort(E._pathModel)})},function D(H){console.log(" : On Failure: "+H);x.showError(d.GET_MODELS_ERROR);E._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})})}};q.prototype.inject=function(D){D.appendChild(this._container);e.workaroundCheckAndWakeUpResizeSensor(this._container)};q.prototype.destroy=function(){this._isDestroyed=true;this.clearTags();if(this._myEventManager){this._myEventManager.cleanup("ModelsStatePresenter");this._myEventManager=null}if(this._modelPreference){this._modelPreference.destroy()}};q.prototype.clearTags=function(){this._updateChannelLocal.publish({event:"xmodel-list-tagger-deactivate-action"})};q.prototype.activateTags=function(){this._updateChannelLocal.publish({event:"xmodel-list-tagger-activate-action"})};q.prototype.deactivateTags=function(){this._updateChannelLocal.publish({event:"xmodel-list-tagger-deactivate-action"})};q.prototype._subscribeEvent=function(){var D=this;this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-item-on-link-click"},function(E){D._updateChannelLocal.publish({event:"xmodel-execute-command",data:E})});this._myEventManager.subscribe(this._updateChannelLocal,{event:"enox-dialog-creation"},function(E){D._createModel(E.content)});this._myEventManager.subscribe(this._updateChannelLocal,{event:"version-explorer-new-version-created"},function(E){var F=E.id;v.getModelDetails({id:F}).then(function(H){console.log("getModelDetails: Service Call Successful !!!");var G=H.member[0];if(G&&G.maturity==undefined&&G.state!=undefined){G.maturity=G.state}D._updateChannelLocal.subscribeOnce({event:"xmodel-list-data-item-on-add-complete"},function(I){I.select()});D._updateChannelLocal.publish({event:"xmodel-list-data-item-add-action",data:G});D._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"})},function(){D._updateChannelLocal.publish({event:"xmodel-list-data-on-load-complete"});console.log("getModelDetails: Service Call Failed !!!");x.showError(d.GET_MODEL_DETAILS_ERROR)})});this._myEventManager.subscribe(this._updateChannelLocal,{event:"enox-dialog-delete"},function(E){D._deleteModels(E)});this._myEventManager.subscribe(this._updateChannelLocal,{event:"list-view-update-inline-action"},function(E){if(E&&E.model&&E.name&&E.value!=undefined){var G=E.model[0];var H=E.cell.nodeModel;var F={icons:[h.getWebappsAssetUrl("ENOXModelApp","icon/loading-animation.gif")]};H.updateOptions(F);D._editionModel(G,E.name,E.value.trim());if(G.isRoot){D._editionModelRoot(G,E.name,E.value.trim())}}});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-item-on-add-selection"},function(E){var F=E.model;o.addSelection(F.id,"model")});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-item-on-remove-selection"},function(E){var F=E.model;o.removeSelection(F.id,"model")});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-item-on-empty-selection"},function(E){o.removeAllSelection("model")});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-item-on-dblclick"},function(E){var F=E.model;console.log("Double click event item id: "+F);D._needRefresh=true;n.navigate(b.ROUTE_MODEL_DETAILS,{id:F.id,name:F.title,version:F.revision,state:F.state})});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-data-item-need-refresh"},function(E){D._refreshListView(D._updateChannelLocal,E,this)});this._myEventManager.subscribe(this._applicationChannel,{event:"xmodel-list-data-item-need-refresh"},function(E){D._refreshListView(D._updateChannelLocal,E)});this._myEventManager.subscribe(this._updateChannelLocal,{event:"enox-collection-toolbar-switch-view-activated"},function(E){w.updateView(D._pathModel,E)});this._myEventManager.subscribe(this._updateChannelLocal,{event:"enox-collection-toolbar-sort-activated"},function(E){w.updateSort(D._pathModel,E)});this._myEventManager.subscribe(this._updateChannelLocal,{event:"xmodel-list-view-group-by-action"},function(E){w.updateGroup(D._pathModel,E)})};q.prototype._addRouterPath=function(){var D=this;var E=null};q.prototype._initModelDetails=function(E){this._parentContainer=(this._container.parentElement!==null)?this._container.parentElement:widget.getElement(".triptych-main").getElement(".xmodel-triptych-wrapper");var D=n.getDependency("modelDetailsStatePresenter");if(!D){this._modelDetailsStatePresenter=new g();this._modelDetailsStatePresenter.init(this._applicationChannel,this._updateChannelLocal,E);n.setDependency("modelDetailsStatePresenter",this._modelDetailsStatePresenter)}this._modelDetailsStatePresenter.inject(this._parentContainer)};q.prototype._resetPropertyPanel=function(){this._currInfoId="";this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}})};q.prototype.createDeleteModelDialog=function(G,F){var D={listItems:G,type:"delete",single:d.MODEL,multiple:d.MODELS,modelEvent:F,immersiveFrame:u.getImmersiveFrame()};var E=new m(D)};q.prototype.createCreationModelDialog=function(E,D){s.createDialogCreationModelVersion(E,D)};q.prototype._deleteModels=function(H){var F=this;var E=H;v.deleteModelVersions({ids:E}).then(function G(I){F._updateChannelLocal.publish({event:"xmodel-list-data-item-remove-action",data:E})},function D(I){console.log("Failure while deleting model versions!!!");x.showError(d.DELETE_MODELS_ERROR)})};q.prototype._refreshListView=function(E,F,D){if(F!=undefined){v.getModelDetails({id:F}).then(function(H){var G=H.member[0]?H.member[0]:{};G.context=D;E.publish({event:"xmodel-list-data-item-update-action",data:G});o.removeSelection(G.id);o.addSelection(G.id)},function(){})}};q.prototype._editionModelRoot=function(E,D,G){var F=this;if(E&&D&&G){var H={};H[D]=G;v.getModelDetails({id:E.id}).then(function(J){var L=J.member[0].modelID;v.patchModel(L,H).then(function K(M){console.log("ModelsStatePresenter _editionModelRoot : Service Call Success !!!")},function I(M){console.log("ModelsStatePresenter _editionModelRoot : Service Call Failed !!!");x.showError(d.PATCH_MODEL_ERROR)})},function(){console.log("ModelsStatePresenter _editionModelRoot : Service Call Failed !!!");x.showError(d.GET_MODEL_DETAILS_ERROR)})}};q.prototype._editionModel=function(F,E,I){var G=this;if(F&&E&&I){var H={};H[E]=I;v.patchModelVersion(F.id,H).then(function J(L){console.log("ModelsStatePresenter editionTitle : Service Call Success !!!");G._updateChannelLocal.publish({event:"xmodel-list-data-item-update-action",data:L.member[0]});if(G._xModelListView._getSelectedItem()[0]){var M=G._xModelListView._getSelectedItem()[0].id}var K=L.member[0].id;o.removeSelection(K);o.addSelection(M)},function D(K){console.log("ModelVersion editionTitle : Service Call Failed !!!");G._updateChannelLocal.publish({event:"xmodel-list-data-item-update-action",data:F});x.showError(d.PATCH_MODEL_ERROR)})}};return q});define("DS/ENOXModelApp/xModelApp/xModelApp",["UWA/Core","UWA/Element","DS/Handlebars/Handlebars","DS/ENOXModelApp/Utils/xModelAppGlobalConfig","DS/CoreEvents/ModelEvents","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOXModelApp/components/WelcomePanel/WelcomePanelWrapper","DS/ENOXModelApp/components/ApplicationTopBar/ApplicationTopBarWrapper","DS/ENOXModelApp/LandingPage/LandingPageStatePresenter","DS/ENOXModelApp/EnterpriseVariabilityDictionary/js/EnterpriseVariabilityDictionaryStatePresenter","DS/ENOXModelApp/ModelDefinition/js/ModelsStatePresenter","DS/xPflRouter5/xPflRouter","DS/ENOXModelApp/xModelRouter/xModelRouterConfig","DS/TaggerOnIndexComponent/TaggerOnIndexComponent","DS/ENOXModelApp/components/zApplicationFrame/zApplicationFrame","DS/ENOXWidgetPreferenceManager/js/ENOXWidgetPreferenceConstants","DS/ENOXModelApp/xModelApp/xParameter","DS/ENOXModelApp/InformationPanels/InformationPanelManager","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/ENOXModelApp/Utils/xModelAppGlobalVariable","DS/xPortfolioQueryServices/js/xPortfolioModel","i18n!DS/ENOXModelApp/assets/nls/xModelApp","css!DS/ENOXModelApp/xModelApp/xModelApp.css"],function(q,n,d,a,k,f,b,p,g,s,m,y,u,h,l,o,v,j,i,r,x,t,c){var w=window.localStorage.XMODEL_BROWSER_LOG_DEBUG;var e=function(){};e.prototype.init=function(){var D=this;u.initialize();v.initialize();this._applicationChannel=new k();this._subscribeToEvents();this._initDivs();this._IsParametersEnabled=false;y.setDependency("applicationChannel",this._applicationChannel);y.setDependency("xModelApp",this);y.setDependency("InformationPanelManager",j);var z=function(F){if(F<a.MOBILE_BREAKPOINT){D._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})}else{D._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}};var B=null;var E=function(){if(widget.body.offsetWidth>a.MOBILE_BREAKPOINT){D._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}D._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}});D._applicationChannel.publish({event:"show-welcomepanel-icon"});D._applicationChannel.publish({event:"welcome-panel-unselect-action",data:null});B=D._applicationChannel.subscribe({event:"resizing-triptych-container"},z)};var C=function(){D._applicationChannel.publish({event:"triptych-hide-panel",data:"left"});D._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}});D._applicationChannel.publish({event:"hide-welcomepanel-icon"});if(B){D._applicationChannel.unsubscribe(B)}};this.getParametersEnabledStatus().then(function(){console.log("xModelAppGlobalConfig.PARAMETERS_ENABLED : "+a.PARAMETERS_ENABLED);y.start();var F=i.getRouteInfo();if(F&&F.name){y.navigate(F.name,{isRefresh:true},{reload:true})}else{y.navigate(a.ROUTE_LANDING_PAGE)}});var A=widget&&widget.hasPreference(o.xWDGT_PREF_SHOW_WORK_UNDER)?widget.getBool(o.xWDGT_PREF_SHOW_WORK_UNDER):false;if(typeof A==="boolean"&&A===true){D._initWorkUnder()}};e.prototype.getParametersEnabledStatus=function(){return x.isParametersEnabled().then(function(z){if(z&&(z.status===true||z.isParameterEnabled===true)){this._IsParametersEnabled=true;a.PARAMETERS_ENABLED=true}else{a.PARAMETERS_ENABLED=false}},function(){console.log("Warning! Error while fetching Parameters Enabled Status. isParametersEnabled would be considered as false.");a.PARAMETERS_ENABLED=false})};e.prototype.reactivateWP=function(){if(widget.body.offsetWidth>a.MOBILE_BREAKPOINT){this._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}});this._applicationChannel.publish({event:"show-welcomepanel-icon"});this._applicationChannel.publish({event:"welcome-panel-unselect-action",data:null});var z=this;this._tokenSub=this._applicationChannel.subscribe({event:"resizing-triptych-container"},function(A){if(A<a.MOBILE_BREAKPOINT){z._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})}else{z._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}})};e.prototype.deactivateWP=function(){this._applicationChannel.publish({event:"triptych-hide-panel",data:"left"});this._applicationChannel.publish({event:"triptych-set-content",data:{side:"right",content:null}});this._applicationChannel.publish({event:"hide-welcomepanel-icon"});if(this._tokenSub){this._applicationChannel.unsubscribe(this._tokenSub)}if(this._LandingPage){this._LandingPage.clearTags()}};e.prototype.clearContent=function(){var z=this._mainPanelApplicationContent.firstChild;if(z){this._mainPanelApplicationContent.removeChild(z)}};e.prototype._initEnterpriseDico=function(z){var B=this;var A=y.getDependency("enterpriseDictionaryPresenter");if(!A){this._enterpriseDico=new s();var C={};C=z&&z.params&&z.params.data?z.params.data:null;this._enterpriseDico.init(this._applicationChannel,null,C);y.setDependency("enterpriseDictionaryPresenter",this._enterpriseDico)}this._enterpriseDico.inject(this._mainPanelApplicationContent);if(this._modelsStatePresenter){this._modelsStatePresenter.deactivateTags()}};e.prototype._initModels=function(z){var B=this;var A=y.getDependency("modelsStatePresenter");if(!A){this._modelsStatePresenter=new m();var C={};C=z&&z.params&&z.params.data?z.params.data:null;this._modelsStatePresenter.init(B._applicationChannel,null,C);y.setDependency("modelsStatePresenter",this._modelsStatePresenter)}this._modelsStatePresenter.inject(this._mainPanelApplicationContent);if(this._modelsStatePresenter){this._modelsStatePresenter.activateTags()}};e.prototype._initWelcomePanel=function(){this._welcomePanelComponent.init(this._applicationChannel,y,this._zApplicationFrame._triptychWrapper.getLeftPanelContainer())};e.prototype._initWelcomePanelDeactivate=function(){this._welcomePanelComponent.init(this._applicationChannel,y,this._zApplicationFrame._triptychWrapper.getLeftPanelContainerTriptych())};e.prototype._initDivs=function(){this._applicationContainer=document.createElement("div");UWA.extendElement(this._applicationContainer);this._applicationContainer.classList.add("xmodel-application");widget.body.setContent(this._applicationContainer);r.createImmersiveFrame();r.getImmersiveFrame().inject(this._applicationContainer);this._welcomePanelComponent=new b();this._zApplicationFrame=new l();this._zApplicationFrame._init(this._applicationChannel,y,this._welcomePanelComponent);r.getImmersiveFrame().setContentInBackgroundLayer(this._zApplicationFrame);this._applicationChannel.publish({event:"triptych-set-size",data:{side:"left",size:a.LEFT_PANEL_SIZE_EXPANDED}});this._mainPanelApplicationContent=this._applicationContainer.querySelector(".triptych-main").querySelector(".xmodel-triptych-wrapper");this._initWelcomePanel();var z=document.getElementsByClassName("wux-windows-docking-element-free-zone");if(z&&z.length>0){z[0].remove()}};e.prototype._initContent=function(){this._applicationChannel.publish({event:"welcome-panel-select-action",data:{id:"home"}});this._LandingPage=new g(this._applicationChannel,{});y.setDependency("landingPage",this._LandingPage);this._LandingPage.inject(this._mainPanelApplicationContent);this._LandingPage.loadData()};e.prototype._subscribeToEvents=function(){};e.prototype._initWorkUnder=function(){f.initialize2(this._applicationContainer,widget.id,"show","bottom-right",function(z){if(f.work_under.Message_SUCCESS!=z){if(w){console.error("Failed to initialized work under!")}}},{isEditable:true,isChange:true,isEvolution:false})};e.prototype.onSearch=function(A){var z="";if(A&&A.length>0){z=A}this._applicationChannel.publish({event:"search-in-current-dashboard",data:z})};e.prototype.onRefresh=function(){var z=i.getRouteInfo();if(z&&z.name){y.navigate(a.ROUTE_HOME,{isRefresh:true},{reload:true});y.navigate(z.name,{isRefresh:true},{reload:true})}else{y.navigate(a.ROUTE_LANDING_PAGE,{},{reload:true})}};return e});define("DS/ENOXModelApp/xModelApp/xModelAppWidgetManager",["DS/ENOXModelApp/xModelApp/xModelApp","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Mask","DS/ENOXWidgetPreferenceManager/js/ENOXWidgetPreferenceManager","DS/ENOXModelApp/Utils/xModelApplicationPreferencesManager","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra"],function(b,d,f,g,c,a){var e=function(){};e.prototype.initPreference=function(){var k=true;var h=true;var j=false;var i=this;if(k){a.getUserId().then(function(l){c.setUserId(l);c.initialize(k,h,j);i.initAndSetupWidget()},function(l){c.initialize(false,h,j);i.initAndSetupWidget()})}else{c.initialize(k,h,j);this.initAndSetupWidget()}};e.prototype.initAndSetupWidget=function(){var m=new b();if(widget===undefined||widget===null){throw new Error("Error!!! Widget is undefined or null, it may not be instantiated yet!!!")}var l=g.getCredentialPreferenceKey();var k=g.getShowPreferencesAtStartPreferenceKey();var h=g.getShowWorkUnderPreferenceKey();widget.setIcon(d.getWebappsAssetUrl("ENOXModelApp","icon/iconENOVIA.png"));widget.setAutoRefresh(10080);var j=widget.getBool(k);var i=false;f.mask(widget.body);g.addCredentialPreferenceToWidget({usePreferredCredentials:true}).then(function(){if(false===widget.hasPreference(h)){g.addShowWorkUnderPreferenceToWidget({prefDefValue:false})}if(false===widget.hasPreference(k)){g.addShowPreferencesAtStartPreferenceToWidget({prefDefValue:false})}var q=widget.getValue(l);if(q!=undefined&&q!=""){var o=widget.getPreference(l);if(o&&o.options){var r=false;var p=o.options;for(var n=0;n<p.length;n++){if(p[n]&&p[n].value&&p[n].value===q){r=true;break}}if(false===r){widget.setValue(l,undefined)}}}widget.addEvents({onLoad:function(){var s=widget.hasPreference(l);var t=widget.getValue(l);if((s&&(t===undefined||t===""))||j===true){widget.toggleEdit()}else{a.setServiceUrlAndSecurityContext(g.getServiceUrl(),widget.getValue(l));m.init();i=true}},onRefresh:function(){m.onRefresh()},onEdit:function(){console.log("onEdit");this._securityCntxtPrefValueBeforeEdit=widget.getValue(l)},endEdit:function(){console.log("endEdit: widget.isEdit:  "+widget.isEdit);console.log("arguments[0].submitted : "+arguments);var s=widget.getValue(l);console.log("endEdit : securityCntxtPrefValue: "+s);console.log("xModelApp: onPrefEdit: args len "+arguments.length);if((arguments.length>=1&&(arguments&&arguments[0].submitted===false))){var s=widget.getValue(l);if(s==undefined||s==""){widget.toggleEdit()}else{if((this._securityCntxtPrefValueBeforeEdit===undefined||this._securityCntxtPrefValueBeforeEdit==="")&&(s!=undefined&&s!="")){widget.setValue(l,undefined);widget.toggleEdit()}else{if(s!=undefined&&s!=""&&this._securityCntxtPrefValueBeforeEdit!=undefined&&this._securityCntxtPrefValueBeforeEdit!=""&&s!=this._securityCntxtPrefValueBeforeEdit){widget.setValue(l,this._securityCntxtPrefValueBeforeEdit);j=false;if(i==false){widget.launch()}}else{if(s!=undefined&&s!=""&&this._securityCntxtPrefValueBeforeEdit!=undefined&&this._securityCntxtPrefValueBeforeEdit!=""&&s===this._securityCntxtPrefValueBeforeEdit){j=false;if(i==false){widget.launch()}}}}}}else{if((arguments.length>=1&&(arguments&&arguments[0].submitted===true))){j=false;widget.launch()}}},onSearch:function(s){m.onSearch(s)},onResetSearch:function(){m.onSearch()}});f.unmask(widget.body)},function(){f.unmask(widget.body);console.log("Error!!! Unable to get the assigned security contexts for the user.")})};e.destroy=function(){};return e});