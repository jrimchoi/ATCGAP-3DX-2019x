define("DS/ENOChgOSLCConsumer/scripts/ENOECMOSLCConsumer",["UWA/Class","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleCmd/OSLCConsumerCmd","UWA/Drivers/Alone","UWA/Widget","i18n!DS/ENOChgOSLCConsumer/assets/nls/ECMOSLC"],function(UWAClass,LifecycleServicesSettings,OSLCConsumerCmd,Alone,Widget,NLS){var ENOECMOSLCConsumer=UWAClass.extend({targetWindow:null,setup:function(){console.log("inside ENOECMOSLCConsumer.init() ...");window.widget=new Widget();top.COMPASS_CONFIG={};top.COMPASS_CONFIG.userId=top.curUserId;top.COMPASS_CONFIG.lang=top.emxUIConstants.BROWSER_LANGUAGE;top.COMPASS_CONFIG.myAppsBaseUrl=top.myAppsURL+"/resources/AppsMngt"},setupWithExternalSetting:function(data){externalSettings=data;window.widget=new Widget()},loadDelegatedUICreate:function(callback,parentWindow){that=this;LifecycleServicesSettings.app_initialization(function(){var oslcConsumerCmd=new OSLCConsumerCmd();oslcConsumerCmd.setup({title:NLS.ECM_OSLC_Select_Reported_Against,resourceType:"http://open-services.net/ns/rm#Requirement",operation:"selectionDialog",proxyType:"Requirement Proxy",providerFilter:"RM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:true,notification:callback});oslcConsumerCmd.execute()})},loadDelegatedUIForCreateExternalChangeAction:function(callback){that=this;LifecycleServicesSettings.app_initialization(function(){var oslcConsumerCmd=new OSLCConsumerCmd();oslcConsumerCmd.setup({title:NLS.ECM_OSLC_Create_External_Change,resourceType:"http://open-services.net/ns/cm#ChangeRequest",operation:"creationDialog",proxyType:"Change Proxy",providerFilter:"CM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:true,notification:callback});oslcConsumerCmd.execute()})},loadDelegatedUIForAddExistExternalChangeAction:function(callback){that=this;LifecycleServicesSettings.app_initialization(function(){var oslcConsumerCmd=new OSLCConsumerCmd();oslcConsumerCmd.setup({title:NLS.ECM_OSLC_Select_External_Change,resourceType:"http://open-services.net/ns/cm#ChangeRequest",operation:"selectionDialog",proxyType:"Change Proxy",providerFilter:"CM",securityContext:top.curSecCtx||"",tenantId:top.curTenant||"OnPremise",singleObject:false,notification:callback});oslcConsumerCmd.execute()})},launchDelegatedUIWithExternalSetting:function(callback){that=this;LifecycleServicesSettings.app_initialization(function(){var oslcConsumerCmd=new OSLCConsumerCmd();oslcConsumerCmd.setup({title:NLS.ECM_OSLC_Select_Reported_Against,resourceType:"http://open-services.net/ns/rm#Requirement",operation:"selectionDialog",proxyType:"Requirement Proxy",providerFilter:"RM",securityContext:externalSettings.curSecCtx||"",tenantId:externalSettings.platformId||"OnPremise",singleObject:true,notification:callback});oslcConsumerCmd.execute()},externalSettings)},createChangeActionPostProcess:function(result){console.log("inside ENOECMOSLCConsumer.createChangeActionPostProcess() ...");if(result&&result.objects&&result.objects.length>0){var submitForm=document.createElement("FORM");submitForm.target="listHidden";submitForm.action="../enterprisechangemgtapp/ECMFullSearchPostProcess.jsp";submitForm.method="post";var sbFrame=emxUICore.findFrame(top,"detailsDisplay");if(sbFrame){var objectId=getParamValuesByName(sbFrame.location.href,"objectId");if(objectId){var arr=result.objects;for(var i=0;i<arr.length;i++){var obj=arr[i];if(obj&&obj.proxy&&obj.proxy.id){var value="|"+obj.proxy.id+"|"+objectId+"|";var hiddenField=document.createElement("INPUT");hiddenField.value=value;hiddenField.type="hidden";hiddenField.name="emxTableRowId";submitForm.appendChild(hiddenField)}}hiddenField=document.createElement("INPUT");hiddenField.value=objectId;hiddenField.type="hidden";hiddenField.name="parentOID";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value=objectId;hiddenField.type="hidden";hiddenField.name="objectId";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="EnterpriseChangeMgt";hiddenField.type="hidden";hiddenField.name="suiteKey";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="enterprisechangemgt";hiddenField.type="hidden";hiddenField.name="SuiteDirectory";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="emxEnterpriseChangeMgtStringResource";hiddenField.type="hidden";hiddenField.name="StringResourceFileId";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="relationship_ChangeAction";hiddenField.type="hidden";hiddenField.name="targetRelName";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="CreateExternalChangeAction";hiddenField.type="hidden";hiddenField.name="functionality";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="Create";hiddenField.type="hidden";hiddenField.name="mode";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="true";hiddenField.type="hidden";hiddenField.name="isTo";submitForm.appendChild(hiddenField);hiddenField=document.createElement("INPUT");hiddenField.value="TRUE";hiddenField.type="hidden";hiddenField.name="oslcCreateUI";submitForm.appendChild(hiddenField);document.body.appendChild(submitForm);addSecureToken(submitForm);submitForm.submit();removeSecureToken(submitForm);document.body.removeChild(submitForm)}}}},createChangePostProcessCommon:function(result){if(result&&result.objects&&result.objects.length>0){var localDoc=document;if(that.targetWindow!=undefined&&that.targetWindow!=null){var windowPath=that.targetWindow;try{var windowActual=eval(windowPath)}catch(error){console.error(error)}localDoc=windowActual.document}var domFieldNameActual=localDoc.getElementsByName("ReportedAgainstDisplay")[0];var domFieldNameDisplay=localDoc.getElementsByName("ReportedAgainst")[0];var domFieldNameOID=localDoc.getElementsByName("ReportedAgainstOID")[0];var varFieldNameActual="",varFieldNameDisplay="",varFieldNameOID="";var isfirstId=true;if(domFieldNameActual&&domFieldNameDisplay&&domFieldNameOID){var arr=result.objects;for(var i=0;i<arr.length;i++){var obj=arr[i];var proxyObj=obj.proxy;if(proxyObj&&proxyObj.id&&proxyObj.dataelements&&proxyObj.dataelements.name){if(isfirstId){varFieldNameOID=proxyObj.id;varFieldNameDisplay=proxyObj.dataelements.name;isfirstId=false}else{varFieldNameOID=varFieldNameOID+"|"+proxyObj.id;varFieldNameDisplay=varFieldNameDisplay+"|"+proxyObj.dataelements.name}}}domFieldNameDisplay.value=varFieldNameDisplay;domFieldNameOID.value=varFieldNameOID;domFieldNameActual.value=varFieldNameDisplay}}},createReportedAgainstPostProcessCommon:function(result){if(result&&result.objects&&result.objects.length>0){var domFieldNameDisplay=document.getElementsByName("txtIssueAffectedItem")[0];var domFieldNameOID=document.getElementsByName("txtActualAffectedItem")[0];var varFieldNameDisplay="",varFieldNameOID="";var isfirstId=true;if(domFieldNameDisplay&&domFieldNameOID){var arr=result.objects;for(var i=0;i<arr.length;i++){var obj=arr[i];var proxyObj=obj.proxy;if(proxyObj&&proxyObj.id&&proxyObj.dataelements&&proxyObj.dataelements.name){if(isfirstId){varFieldNameOID=proxyObj.id;varFieldNameDisplay=proxyObj.dataelements.name;isfirstId=false}else{varFieldNameOID=varFieldNameOID+"|"+proxyObj.id;varFieldNameDisplay=varFieldNameDisplay+"|"+proxyObj.dataelements.name}}}domFieldNameDisplay.value=varFieldNameDisplay;domFieldNameOID.value=varFieldNameOID}}}});return ENOECMOSLCConsumer});