define("DS/Mesh/ThreeJS_Base",function(){var b=b||{REVISION:"57"};b.extend=function(h,g){if(Object.keys){var f=Object.keys(g);for(var e=0,d=f.length;e<d;e++){var j=f[e];Object.defineProperty(h,j,Object.getOwnPropertyDescriptor(g,j))}}else{var c={}.hasOwnProperty;for(var j in g){if(c.call(g,j)){h[j]=g[j]}}}return h};b._jsLevel_do_not_use_you_are_dead_if_you_use_it_out_of_techno=421;b.getWebVisualizationLevel=function(){return b._jsLevel_do_not_use_you_are_dead_if_you_use_it_out_of_techno};b.GeomTypeEnum={EDGE:1,WIRE_EDGE:1<<1,BOUNDARY_EDGE:1<<2,SHARP_EDGE:1<<3,SMOOTH_EDGE:1<<4,HIDDEN_SEAM_EDGE:1<<5,BOUNDARY_POINT:1<<6,SHARP_POINT:1<<7,SMOOTH_POINT:1<<8,SURFACIC_POINT:1<<9,FREE_POINT:1<<10,HIDDEN_SEAM_POINT:1<<11,INFINITE_FACE:1<<12,FACE:1<<13,UNKNOWN:1<<14,_OUTLINE:1<<15,_SECTION_LINE:1<<16,AXIS_SYSTEM:1<<17};b.FixedSizeFiltering={Include:0,Exclude:1,CenterOnly:2};b.PolygonOffsetForceStatus={DEFAULT:0,ENABLED:1,DISABLED:2,};b.ProgramIDs={LARGE_SCALE:1,OIT:1<<1,OIT_ACCUM:1<<2,OIT_REVEAL:1<<3,COMPRESSED_VERTICES:1<<4,COMPRESSED_NORMALS:1<<5,FIXED_SIZE:1<<6,FIXED_SIZE_CENTER:1<<7,};b.AssetSource={MANUAL:0,MATERIAL_MANAGER:1,};b.Quaternion=function(c,f,e,d){this.x=c||0;this.y=f||0;this.z=e||0;this.w=(d!==undefined)?d:1};b.Quaternion.prototype={constructor:b.Quaternion,set:function(c,f,e,d){this.x=c;this.y=f;this.z=e;this.w=d;return this},copy:function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w;return this},createJSON:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},setFromJSON:function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w},setFromEuler:function(e,c){var j=Math.cos(e.x/2);var i=Math.cos(e.y/2);var g=Math.cos(e.z/2);var h=Math.sin(e.x/2);var f=Math.sin(e.y/2);var d=Math.sin(e.z/2);if(c===undefined||c==="XYZ"){this.x=h*i*g+j*f*d;this.y=j*f*g-h*i*d;this.z=j*i*d+h*f*g;this.w=j*i*g-h*f*d}else{if(c==="YXZ"){this.x=h*i*g+j*f*d;this.y=j*f*g-h*i*d;this.z=j*i*d-h*f*g;this.w=j*i*g+h*f*d}else{if(c==="ZXY"){this.x=h*i*g-j*f*d;this.y=j*f*g+h*i*d;this.z=j*i*d+h*f*g;this.w=j*i*g-h*f*d}else{if(c==="ZYX"){this.x=h*i*g-j*f*d;this.y=j*f*g+h*i*d;this.z=j*i*d-h*f*g;this.w=j*i*g+h*f*d}else{if(c==="YZX"){this.x=h*i*g+j*f*d;this.y=j*f*g+h*i*d;this.z=j*i*d-h*f*g;this.w=j*i*g-h*f*d}else{if(c==="XZY"){this.x=h*i*g-j*f*d;this.y=j*f*g-h*i*d;this.z=j*i*d+h*f*g;this.w=j*i*g+h*f*d}}}}}}return this},setFromAxisAngle:function(e,f){var c=f/2,d=Math.sin(c);this.x=e.x*d;this.y=e.y*d;this.z=e.z*d;this.w=Math.cos(c);return this},setFromRotationMatrix:function(g){var f=g.elements,k=f[0],j=f[4],i=f[8],e=f[1],d=f[5],c=f[9],o=f[2],n=f[6],l=f[10],h=k+d+l,p;if(h>0){p=0.5/Math.sqrt(h+1);this.w=0.25/p;this.x=(n-c)*p;this.y=(i-o)*p;this.z=(e-j)*p}else{if(k>d&&k>l){p=2*Math.sqrt(1+k-d-l);this.w=(n-c)/p;this.x=0.25*p;this.y=(j+e)/p;this.z=(i+o)/p}else{if(d>l){p=2*Math.sqrt(1+d-k-l);this.w=(i-o)/p;this.x=(j+e)/p;this.y=0.25*p;this.z=(c+n)/p}else{p=2*Math.sqrt(1+l-k-d);this.w=(e-j)/p;this.x=(i+o)/p;this.y=(c+n)/p;this.z=0.25*p}}}return this},toRotationMatrix:function(){var i=2*this.x;var h=2*this.y;var g=2*this.z;var m=i*this.w;var l=h*this.w;var k=g*this.w;var e=i*this.x;var d=h*this.x;var c=g*this.x;var p=h*this.y;var o=g*this.y;var j=g*this.z;var n=new b.Matrix3();var f=n.elements;return new b.Vector3(c-l,o+m,1-(e+p))},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var c=this.length();if(c===0){this.x=0;this.y=0;this.z=0;this.w=1}else{c=1/c;this.x=this.x*c;this.y=this.y*c;this.z=this.z*c;this.w=this.w*c}return this},add:function(c){this.x+=c.x;this.y+=c.y;this.z+=c.z;this.w+=c.w;return this},sub:function(c){this.x-=c.x;this.y-=c.y;this.z-=c.z;this.w-=c.w;return this},multiply:function(c,d){if(d!==undefined){console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(c,d)}return this.multiplyQuaternions(this,c)},multiplyQuaternions:function(l,k){var i=l.x,h=l.y,g=l.z,j=l.w;var e=k.x,d=k.y,c=k.z,f=k.w;this.x=i*f+j*e+h*c-g*d;this.y=h*f+j*d+g*e-i*c;this.z=g*f+j*c+i*d-h*e;this.w=j*f-i*e-h*d-g*c;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;this.z*=c;this.w*=c;return this},multiplyVector3:function(c){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return c.applyQuaternion(this)},log:function(){if(Math.abs(this.w)>=1){this.w=0;return this}var e=Math.acos(this.w);var c=Math.sin(e);this.w=0;if(Math.abs(c)<0.001){return this}var d=e/c;this.x*=d;this.y*=d;this.z*=d;return this},exp:function(){var e=this.length();this.w=Math.cos(e);var c=Math.sin(e);if(Math.abs(e)<0.001){return this}var d=c/e;this.x*=d;this.y*=d;this.z*=d;return this},slerp:function(e,m){var k=this.x,j=this.y,i=this.z,l=this.w;var d=l*e.w+k*e.x+j*e.y+i*e.z;if(d<0){this.w=-e.w;this.x=-e.x;this.y=-e.y;this.z=-e.z;d=-d}else{this.copy(e)}if(d>=1){this.w=l;this.x=k;this.y=j;this.z=i;return this}var f=Math.acos(d);var c=Math.sqrt(1-d*d);if(Math.abs(c)<0.001){this.w=0.5*(l+this.w);this.x=0.5*(k+this.x);this.y=0.5*(j+this.y);this.z=0.5*(i+this.z);return this}var h=Math.sin((1-m)*f)/c,g=Math.sin(m*f)/c;this.w=(l*h+this.w*g);this.x=(k*h+this.x*g);this.y=(j*h+this.y*g);this.z=(i*h+this.z*g);return this},intermediatePoint:function(){var d,c;return function(f,e,g){if(!d){d=new b.Quaternion()}if(!c){c=new b.Quaternion()}d.copy(e).inverse().multiply(f).log();c.copy(e).inverse().multiply(g).log();d.add(c).multiplyScalar(-0.25);this.copy(e).multiply(d.exp());this.normalize();return this}}(),squad:function(d,e,c,i,g){this.copy(d).slerp(i,g,false);this.normalize();var f=new b.Quaternion().copy(e).slerp(c,g);f.normalize();return this.slerp(f,2*g*(1-g)).normalize()},equals:function(c){return((c.x===this.x)&&(c.y===this.y)&&(c.z===this.z)&&(c.w===this.w))},clone:function(){return new b.Quaternion(this.x,this.y,this.z,this.w)}};b.Quaternion.slerp=function(f,e,d,c){return d.copy(f).slerp(e,c)};b.Curve=function(){};b.Curve.prototype.getPoint=function(c){console.log("Warning, getPoint() not implemented!");return null};b.Curve.prototype.getPointAt=function(c,e){var d=this.getUtoTmapping(c,e);return this.getPoint(d)};b.Curve.prototype.getPoints=function(c){if(!c){c=5}var f,e=[];for(f=0;f<=c;f++){e.push(this.getPoint(f/c))}return e};b.Curve.prototype.getSpacedPoints=function(c){if(!c){c=5}var f,e=[];for(f=0;f<=c;f++){e.push(this.getPointAt(f/c))}return e};b.Curve.prototype.getLength=function(e){var g=this.getLengths();if(e!==undefined){var f=e*(g.length-1);var d=Math.floor(f);var c=f-d;if(d+1>=g.length){return g[d]}else{return(1-c)*g[d]+c*g[d+1]}}else{return g[g.length-1]}};b.Curve.prototype.getLengths=function(d){if(!d){d=(this.__arcLengthDivisions)?(this.__arcLengthDivisions):200}if(this.cacheArcLengths&&(this.cacheArcLengths.length==d+1)&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;var c=[];var h,f=this.getPoint(0);var g,e=0;c.push(0);for(g=1;g<=d;g++){h=this.getPoint(g/d);e+=h.distanceTo(f);c.push(e);f=h}this.cacheArcLengths=c;return c};b.Curve.prototype.updateArcLengths=function(){this.needsUpdate=true;this.getLengths()};b.Curve.prototype.getUtoTmapping=function(o,c){var d=this.getLengths();var g=0,l=d.length;var m;if(c){m=c}else{m=o*d[l-1]}var k=0,f=l-1,n;while(k<=f){g=Math.floor(k+(f-k)/2);n=d[g]-m;if(n<0){k=g+1;continue}else{if(n>0){f=g-1;continue}else{f=g;break}}}g=f;if(d[g]==m){var q=g/(l-1);return q}var h=d[g];var p=d[g+1];var e=p-h;var j=(m-h)/e;var q=(g+j)/(l-1);return q};b.Curve.prototype.getTangent=function(d){var i=0.0001;var f=d-i;var e=d+i;if(f<0){f=0}if(e>1){e=1}var h=this.getPoint(f);var g=this.getPoint(e);var c=g.clone().sub(h);return c.normalize()};b.Curve.prototype.getTangentAt=function(c){var d=this.getUtoTmapping(c);return this.getTangent(d)};b.QuaternionSpline=function(c){this.controlPts=[];this.tangentPts=[];this.setPoints(c)};b.QuaternionSpline.prototype={constructor:b.QuaternionSpline,setPoints:function(c){this.controlPts=c;if(c){this._updateTangents()}},clear:function(){this.controlPts=[];this.tangentPts=[]},getNbPoints:function(){return this.controlPts.length},addPoint:function(c){this.controlPts.push(c);this._updateTangents()},insertPoint:function(c,d){if(c<0||c>this.controlPts.length){return false}this.controlPts.splice(c,0,d);this._updateTangents();return true},updatePoint:function(c,d){if(c<0||c>=this.controlPts.length){return false}this.controlPts[c]=d;this._updateTangents();return true},removePoint:function(c){if(c<0||c>=this.controlPts.length){return false}this.controlPts.splice(c,1);this._updateTangents();return true},interpolate:function(d){var e=d*(this.controlPts.length-1);var c=Math.floor(e);return this._interpolate(c,e-c)},_interpolate:function(c,d){if(c===this.controlPts.length-1){return this.controlPts[c]}if(d===0){return this.controlPts[c]}else{if(d===1){return this.controlPts[c+1]}}return new b.Quaternion().squad(this.controlPts[c],this.tangentPts[c],this.tangentPts[c+1],this.controlPts[c+1],d)},_updateTangents:function(){var f=this.controlPts.length;if(f<2){return}this.controlPts[f-1].normalize();for(var e=f-1;e>0;e--){this.controlPts[e-1].normalize();if(this.controlPts[e-1].dot(this.controlPts[e])<=0){this.controlPts[e-1].multiplyScalar(-1)}}var h=this.controlPts[0].equals(this.controlPts[f-1]);for(var e=0;e<f;++e){var d,g;var c=this.controlPts[e];if(!e){g=this.controlPts[1];if(h){d=this.controlPts[f-2]}else{d=c}}else{if(e===f-1){d=this.controlPts[e-1];if(h){g=this.controlPts[1]}else{g=c}}else{d=this.controlPts[e-1];g=this.controlPts[e+1]}}if(!this.tangentPts[e]){this.tangentPts[e]=new b.Quaternion()}this.tangentPts[e].intermediatePoint(d,c,g)}}};b.PositionSpline=function(c){this.controlPts=[];if(c){this.setPoints(c)}};b.PositionSpline.prototype={constructor:b.PositionSpline,getPointAt:b.Curve.prototype.getPointAt,getLength:b.Curve.prototype.getLength,getLengths:b.Curve.prototype.getLengths,updateArcLengths:b.Curve.prototype.updateArcLengths,getUtoTmapping:b.Curve.prototype.getUtoTmapping,getPoint:function(d){var e=d*(this.controlPts.length-1);var c=Math.floor(e);return this._interpolate(c,e-c)},getNbPoints:function(){return this.controlPts.length},setPoints:function(c){this.controlPts=c;this._updateCurve()},clear:function(){this.controlPts=[];this._updateCurve()},addPoint:function(c){this.controlPts.push(c);this._updateCurve()},insertPoint:function(c,d){if(c<0||c>this.controlPts.length){return false}this.controlPts.splice(c,0,d);this._updateCurve();return true},updatePoint:function(c,d){if(c<0||c>=this.controlPts.length){return false}this.controlPts[c]=d;this._updateCurve();return true},removePoint:function(c){if(c<0||c>=this.controlPts.length){return false}this.controlPts.splice(c,1);this._updateCurve();return true},_updateCurve:function(){this.updateArcLengths()},_interpolate:function(f,l){var d=this.controlPts.length;if(d<2){return null}if(f===d-1){return this.controlPts[f]}if(l===0){return this.controlPts[f]}else{if(l===1){return this.controlPts[f+1]}}var c=this.controlPts[0].equals(this.controlPts[d-1]);var k,i,h;var j=this.controlPts[f];if(c){k=!f?this.controlPts[d-2]:this.controlPts[f-1];i=(f>d-2)?this.controlPts[1]:this.controlPts[f+1];h=(f===d-1)?this.controlPts[2]:((f===d-2)?this.controlPts[1]:this.controlPts[f+2])}else{k=!f?j:this.controlPts[f-1];i=(f>d-2)?j:this.controlPts[f+1];h=(f>d-3)?i:this.controlPts[f+2]}var e=(this.controlPts[0].w!==undefined);var g=e?new b.Vector4():new b.Vector3();g.x=this._CatmullInterpolate(k.x,j.x,i.x,h.x,l);g.y=this._CatmullInterpolate(k.y,j.y,i.y,h.y,l);g.z=this._CatmullInterpolate(k.z,j.z,i.z,h.z,l);if(e){g.w=this._CatmullInterpolate(k.w,j.w,i.w,h.w,l)}return g},_CatmullInterpolate:function(j,i,g,f,k){var h=(g-j)*0.5;var e=(f-i)*0.5;var d=k*k;var c=k*d;return(2*i-2*g+h+e)*c+(-3*i+3*g-2*h-e)*d+h*k+i}};b.Vector2=function(c,d){this.x=c||0;this.y=d||0};b.Vector2.prototype={constructor:b.Vector2,set:function(c,d){this.x=c;this.y=d;return this},setX:function(c){this.x=c;return this},setY:function(c){this.y=c;return this},setComponent:function(c,d){switch(c){case 0:this.x=d;break;case 1:this.y=d;break;default:throw new Error("index is out of range: "+c)}},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+c)}},copy:function(c){this.x=c.x;this.y=c.y;return this},add:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScalar:function(c){this.x+=c;this.y+=c;return this},sub:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;return this},divideScalar:function(c){if(c!==0){this.x/=c;this.y/=c}else{this.set(0,0)}return this},min:function(c){if(this.x>c.x){this.x=c.x}if(this.y>c.y){this.y=c.y}return this},max:function(c){if(this.x<c.x){this.x=c.x}if(this.y<c.y){this.y=c.y}return this},clamp:function(d,c){if(this.x<d.x){this.x=d.x}else{if(this.x>c.x){this.x=c.x}}if(this.y<d.y){this.y=d.y}else{if(this.y>c.y){this.y=c.y}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(e){var d=this.x-e.x,c=this.y-e.y;return d*d+c*c},setLength:function(c){var d=this.length();if(d!==0&&c!==d){this.multiplyScalar(c/d)}return this},lerp:function(c,d){this.x+=(c.x-this.x)*d;this.y+=(c.y-this.y)*d;return this},equals:function(c){return((c.x===this.x)&&(c.y===this.y))},toArray:function(){return[this.x,this.y]},clone:function(){return new b.Vector2(this.x,this.y)}};b.Vector3=function(c,e,d){this.x=c||0;this.y=e||0;this.z=d||0};b.Vector3.prototype={constructor:b.Vector3,set:function(c,e,d){this.x=c;this.y=e;this.z=d;return this},setX:function(c){this.x=c;return this},setY:function(c){this.y=c;return this},setZ:function(c){this.z=c;return this},barycentricCoordinates:function(j,i,h){var g=new b.Vector3().subVectors(j,this);var f=new b.Vector3().subVectors(i,this);var e=new b.Vector3().subVectors(h,this);var d=new b.Vector3().subVectors(j,i);var n=new b.Vector3().subVectors(j,h);var l=1/new b.Vector3().crossVectors(d,n).length();var o=new b.Vector3().crossVectors(f,e).length();var m=new b.Vector3().crossVectors(e,g).length();var k=new b.Vector3().crossVectors(g,f).length();return{alpha:o,beta:m,gamma:k,normalisationFactor:l}},setFromJSON:function(c){this.x=c.x;this.y=c.y;this.z=c.z},createJSON:function(){return{x:this.x,y:this.y,z:this.z}},setComponent:function(c,d){switch(c){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;default:throw new Error("index is out of range: "+c)}},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+c)}},copy:function(c){this.x=c.x;this.y=c.y;this.z=c.z;return this},add:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;return this},addScalar:function(c){this.x+=c;this.y+=c;this.z+=c;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;return this},sub:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;return this},multiply:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(d,c)}this.x*=d.x;this.y*=d.y;this.z*=d.z;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;this.z*=c;return this},multiplyVectors:function(d,c){this.x=d.x*c.x;this.y=d.y*c.y;this.z=d.z*c.z;return this},applyMatrix3:function(d){var c=this.x;var h=this.y;var g=this.z;var f=d.elements;this.x=f[0]*c+f[3]*h+f[6]*g;this.y=f[1]*c+f[4]*h+f[7]*g;this.z=f[2]*c+f[5]*h+f[8]*g;return this},applyMatrix4:function(d){if(!d){return this}var c=this.x,h=this.y,g=this.z;var f=d.elements;this.x=f[0]*c+f[4]*h+f[8]*g+f[12];this.y=f[1]*c+f[5]*h+f[9]*g+f[13];this.z=f[2]*c+f[6]*h+f[10]*g+f[14];return this},applyProjection:function(f){var c=this.x,j=this.y,i=this.z;var g=f.elements;var h=1/(g[3]*c+g[7]*j+g[11]*i+g[15]);this.x=(g[0]*c+g[4]*j+g[8]*i+g[12])*h;this.y=(g[1]*c+g[5]*j+g[9]*i+g[13])*h;this.z=(g[2]*c+g[6]*j+g[10]*i+g[14])*h;return this},applyQuaternion:function(c){var n=this.x;var m=this.y;var l=this.z;var j=c.x;var i=c.y;var h=c.z;var k=c.w;var f=k*n+i*l-h*m;var e=k*m+h*n-j*l;var d=k*l+j*m-i*n;var g=-j*n-i*m-h*l;this.x=f*k+g*-j+e*-h-d*-i;this.y=e*k+g*-i+d*-j-f*-h;this.z=d*k+g*-h+f*-i-e*-j;return this},transformDirection:function(d){var c=this.x,h=this.y,g=this.z;var f=d.elements;this.x=f[0]*c+f[4]*h+f[8]*g;this.y=f[1]*c+f[5]*h+f[9]*g;this.z=f[2]*c+f[6]*h+f[10]*g;this.normalize();return this},divide:function(c){this.x/=c.x;this.y/=c.y;this.z/=c.z;return this},divideScalar:function(c){if(c!==0){this.x/=c;this.y/=c;this.z/=c}else{this.x=0;this.y=0;this.z=0}return this},min:function(c){if(this.x>c.x){this.x=c.x}if(this.y>c.y){this.y=c.y}if(this.z>c.z){this.z=c.z}return this},max:function(c){if(this.x<c.x){this.x=c.x}if(this.y<c.y){this.y=c.y}if(this.z<c.z){this.z=c.z}return this},clamp:function(d,c){if(this.x<d.x){this.x=d.x}else{if(this.x>c.x){this.x=c.x}}if(this.y<d.y){this.y=d.y}else{if(this.y>c.y){this.y=c.y}}if(this.z<d.z){this.z=d.z}else{if(this.z>c.z){this.z=c.z}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(c){var d=this.length();if(d!==0&&c!==d){this.multiplyScalar(c/d)}return this},lerp:function(c,d){this.x+=(c.x-this.x)*d;this.y+=(c.y-this.y)*d;this.z+=(c.z-this.z)*d;return this},cross:function(e,d){if(d!==undefined){console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(e,d)}var c=this.x,g=this.y,f=this.z;this.x=g*e.z-f*e.y;this.y=f*e.x-c*e.z;this.z=c*e.y-g*e.x;return this},crossVectors:function(d,c){this.x=d.y*c.z-d.z*c.y;this.y=d.z*c.x-d.x*c.z;this.z=d.x*c.y-d.y*c.x;return this},applyAxisAngle:function(){var c;return function(d,e){if(c===undefined){c=new b.Quaternion()}this.applyQuaternion(c.setFromAxisAngle(d,e));return this}}(),projectOnVector:function(){var d,c;return function(e){if(d===undefined){d=new b.Vector3()}d.copy(e).normalize();c=this.dot(d);return this.copy(d).multiplyScalar(c)}}(),projectOnPlane:function(){var c;return function(d){if(c===undefined){c=new b.Vector3()}c.copy(this).projectOnVector(d);return this.sub(c)}}(),reflect:function(){var c;return function(d){if(c===undefined){c=new b.Vector3()}return this.sub(c.copy(d).multiplyScalar(2*this.dot(d)))}}(),angleTo:function(c){var d=this.dot(c)/(this.length()*c.length());return Math.acos(b.Math.clamp(d,-1,1))},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(f){var e=this.x-f.x;var d=this.y-f.y;var c=this.z-f.z;return e*e+d*d+c*c},getPositionFromMatrix:function(c){this.x=c.elements[12];this.y=c.elements[13];this.z=c.elements[14];return this},getColumnFromMatrix:function(d,c){var f=d*4;var e=c.elements;this.x=e[f];this.y=e[f+1];this.z=e[f+2];return this},setEulerFromRotationMatrix:function(g,h){function k(m){return Math.min(Math.max(m,-1),1)}var f=g.elements;var l=f[0],j=f[4],i=f[8];var e=f[1],d=f[5],c=f[9];var p=f[2],o=f[6],n=f[10];if(h===undefined||h==="XYZ"){this.y=Math.asin(k(i));if(Math.abs(i)<0.99999){this.x=Math.atan2(-c,n);this.z=Math.atan2(-j,l)}else{this.x=Math.atan2(o,d);this.z=0}}else{if(h==="YXZ"){this.x=Math.asin(-k(c));if(Math.abs(c)<0.99999){this.y=Math.atan2(i,n);this.z=Math.atan2(e,d)}else{this.y=Math.atan2(-p,l);this.z=0}}else{if(h==="ZXY"){this.x=Math.asin(k(o));if(Math.abs(o)<0.99999){this.y=Math.atan2(-p,n);this.z=Math.atan2(-j,d)}else{this.y=0;this.z=Math.atan2(e,l)}}else{if(h==="ZYX"){this.y=Math.asin(-k(p));if(Math.abs(p)<0.99999){this.x=Math.atan2(o,n);this.z=Math.atan2(e,l)}else{this.x=0;this.z=Math.atan2(-j,d)}}else{if(h==="YZX"){this.z=Math.asin(k(e));if(Math.abs(e)<0.99999){this.x=Math.atan2(-c,d);this.y=Math.atan2(-p,l)}else{this.x=0;this.y=Math.atan2(i,n)}}else{if(h==="XZY"){this.z=Math.asin(-k(j));if(Math.abs(j)<0.99999){this.x=Math.atan2(o,d);this.y=Math.atan2(i,l)}else{this.x=Math.atan2(-c,n);this.y=0}}}}}}}return this},setEulerFromQuaternion:function(f,c){function i(j){return Math.min(Math.max(j,-1),1)}var g=f.x*f.x;var e=f.y*f.y;var d=f.z*f.z;var h=f.w*f.w;if(c===undefined||c==="XYZ"){this.x=Math.atan2(2*(f.x*f.w-f.y*f.z),(h-g-e+d));this.y=Math.asin(i(2*(f.x*f.z+f.y*f.w)));this.z=Math.atan2(2*(f.z*f.w-f.x*f.y),(h+g-e-d))}else{if(c==="YXZ"){this.x=Math.asin(i(2*(f.x*f.w-f.y*f.z)));this.y=Math.atan2(2*(f.x*f.z+f.y*f.w),(h-g-e+d));this.z=Math.atan2(2*(f.x*f.y+f.z*f.w),(h-g+e-d))}else{if(c==="ZXY"){this.x=Math.asin(i(2*(f.x*f.w+f.y*f.z)));this.y=Math.atan2(2*(f.y*f.w-f.z*f.x),(h-g-e+d));this.z=Math.atan2(2*(f.z*f.w-f.x*f.y),(h-g+e-d))}else{if(c==="ZYX"){this.x=Math.atan2(2*(f.x*f.w+f.z*f.y),(h-g-e+d));this.y=Math.asin(i(2*(f.y*f.w-f.x*f.z)));this.z=Math.atan2(2*(f.x*f.y+f.z*f.w),(h+g-e-d))}else{if(c==="YZX"){this.x=Math.atan2(2*(f.x*f.w-f.z*f.y),(h-g+e-d));this.y=Math.atan2(2*(f.y*f.w-f.x*f.z),(h+g-e-d));this.z=Math.asin(i(2*(f.x*f.y+f.z*f.w)))}else{if(c==="XZY"){this.x=Math.atan2(2*(f.x*f.w+f.y*f.z),(h-g+e-d));this.y=Math.atan2(2*(f.x*f.z+f.y*f.w),(h+g-e-d));this.z=Math.asin(i(2*(f.z*f.w-f.x*f.y)))}}}}}}return this},getScaleFromMatrix:function(c){var f=this.set(c.elements[0],c.elements[1],c.elements[2]).length();var e=this.set(c.elements[4],c.elements[5],c.elements[6]).length();var d=this.set(c.elements[8],c.elements[9],c.elements[10]).length();this.x=f;this.y=e;this.z=d;return this},equals:function(c){return((c.x===this.x)&&(c.y===this.y)&&(c.z===this.z))},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new b.Vector3(this.x,this.y,this.z)},isNaN:function(){if(!isFinite(this.x)||!isFinite(this.y)||!isFinite(this.z)){return true}else{return false}}};b.Vector4=function(c,f,e,d){this.x=c||0;this.y=f||0;this.z=e||0;this.w=(d!==undefined)?d:1};b.Vector4.prototype={constructor:b.Vector4,set:function(c,f,e,d){this.x=c;this.y=f;this.z=e;this.w=d;return this},setX:function(c){this.x=c;return this},setY:function(c){this.y=c;return this},setZ:function(c){this.z=c;return this},setW:function(c){this.w=c;return this},setComponent:function(c,d){switch(c){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;case 3:this.w=d;break;default:throw new Error("index is out of range: "+c)}},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+c)}},copy:function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=(c.w!==undefined)?c.w:1;return this},add:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(d,c)}this.x+=d.x;this.y+=d.y;this.z+=d.z;this.w+=d.w;return this},addScalar:function(c){this.x+=c;this.y+=c;this.z+=c;this.w+=c;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;this.w=d.w+c.w;return this},sub:function(d,c){if(c!==undefined){console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(d,c)}this.x-=d.x;this.y-=d.y;this.z-=d.z;this.w-=d.w;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;this.w=d.w-c.w;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;this.z*=c;this.w*=c;return this},applyMatrix4:function(d){if(!d){return this}var c=this.x;var i=this.y;var h=this.z;var f=this.w;var g=d.elements;this.x=g[0]*c+g[4]*i+g[8]*h+g[12]*f;this.y=g[1]*c+g[5]*i+g[9]*h+g[13]*f;this.z=g[2]*c+g[6]*i+g[10]*h+g[14]*f;this.w=g[3]*c+g[7]*i+g[11]*h+g[15]*f;return this},divideScalar:function(c){if(c!==0){this.x/=c;this.y/=c;this.z/=c;this.w/=c}else{this.x=0;this.y=0;this.z=0;this.w=1}return this},setAxisAngleFromQuaternion:function(d){this.w=2*Math.acos(d.w);var c=Math.sqrt(1-d.w*d.w);if(c<0.0001){this.x=1;this.y=0;this.z=0}else{this.x=d.x/c;this.y=d.y/c;this.z=d.z/c}return this},setAxisAngleFromRotationMatrix:function(v){var w,l,k,j,E=0.01,n=0.1,i=v.elements,D=i[0],B=i[4],A=i[8],g=i[1],e=i[5],c=i[9],u=i[2],r=i[6],p=i[10];if((Math.abs(B-g)<E)&&(Math.abs(A-u)<E)&&(Math.abs(c-r)<E)){if((Math.abs(B+g)<n)&&(Math.abs(A+u)<n)&&(Math.abs(c+r)<n)&&(Math.abs(D+e+p-3)<n)){this.set(1,0,0,0);return this}w=Math.PI;var h=(D+1)/2;var t=(e+1)/2;var C=(p+1)/2;var f=(B+g)/4;var d=(A+u)/4;var q=(c+r)/4;if((h>t)&&(h>C)){if(h<E){l=0;k=0.707106781;j=0.707106781}else{l=Math.sqrt(h);k=f/l;j=d/l}}else{if(t>C){if(t<E){l=0.707106781;k=0;j=0.707106781}else{k=Math.sqrt(t);l=f/k;j=q/k}}else{if(C<E){l=0.707106781;k=0.707106781;j=0}else{j=Math.sqrt(C);l=d/j;k=q/j}}}this.set(l,k,j,w);return this}var o=Math.sqrt((r-c)*(r-c)+(A-u)*(A-u)+(g-B)*(g-B));if(Math.abs(o)<0.001){o=1}this.x=(r-c)/o;this.y=(A-u)/o;this.z=(g-B)/o;this.w=Math.acos((D+e+p-1)/2);return this},getColumnFromMatrix:function(d,c){var f=d*4;var e=c.elements;this.x=e[f];this.y=e[f+1];this.z=e[f+2];this.w=1;return this},min:function(c){if(this.x>c.x){this.x=c.x}if(this.y>c.y){this.y=c.y}if(this.z>c.z){this.z=c.z}if(this.w>c.w){this.w=c.w}return this},max:function(c){if(this.x<c.x){this.x=c.x}if(this.y<c.y){this.y=c.y}if(this.z<c.z){this.z=c.z}if(this.w<c.w){this.w=c.w}return this},clamp:function(d,c){if(this.x<d.x){this.x=d.x}else{if(this.x>c.x){this.x=c.x}}if(this.y<d.y){this.y=d.y}else{if(this.y>c.y){this.y=c.y}}if(this.z<d.z){this.z=d.z}else{if(this.z>c.z){this.z=c.z}}if(this.w<d.w){this.w=d.w}else{if(this.w>c.w){this.w=c.w}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c,d){return Math.sqrt(this.distanceToSquared(c,d))},distanceToSquared:function(g,h){var f=this.x-g.x;var e=this.y-g.y;var d=this.z-g.z;var c=f*f+e*e+d*d;if(h){c+=this.w-g.w}return c},setLength:function(c){var d=this.length();if(d!==0&&c!==d){this.multiplyScalar(c/d)}return this},lerp:function(c,d){this.x+=(c.x-this.x)*d;this.y+=(c.y-this.y)*d;this.z+=(c.z-this.z)*d;this.w+=(c.w-this.w)*d;return this},equals:function(c){return((c.x===this.x)&&(c.y===this.y)&&(c.z===this.z)&&(c.w===this.w))},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new b.Vector4(this.x,this.y,this.z,this.w)}};b.Matrix3=function(i,h,g,f,e,d,c,k,j){this.elements=new Float32Array(9);this.set((i!==undefined)?i:1,h||0,g||0,f||0,(e!==undefined)?e:1,d||0,c||0,k||0,(j!==undefined)?j:1)};b.Matrix3.prototype={constructor:b.Matrix3,set:function(j,i,h,g,f,e,c,l,k){var d=this.elements;d[0]=j;d[3]=i;d[6]=h;d[1]=g;d[4]=f;d[7]=e;d[2]=c;d[5]=l;d[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(c){var d=c.elements;this.set(d[0],d[3],d[6],d[1],d[4],d[7],d[2],d[5],d[8]);return this},multiplyVector3:function(c){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return c.applyMatrix3(this)},multiplyVector3Array:function(){var c=new b.Vector3();return function(d){for(var f=0,e=d.length;f<e;f+=3){c.x=d[f];c.y=d[f+1];c.z=d[f+2];c.applyMatrix3(this);d[f]=c.x;d[f+1]=c.y;d[f+2]=c.z}return d}}(),multiplyScalar:function(c){var d=this.elements;d[0]*=c;d[3]*=c;d[6]*=c;d[1]*=c;d[4]*=c;d[7]*=c;d[2]*=c;d[5]*=c;d[8]*=c;return this},multiplyMatrices:function(v,u){if(!u){this.copy(v);return this}var t=v.elements;var f=u.elements;var j=this.elements;var i=t[0],h=t[3],g=t[6];var p=t[1],o=t[4],n=t[7];var y=t[2],x=t[5],w=t[8];var s=f[0],r=f[3],q=f[6];var e=f[1],d=f[4],c=f[7];var m=f[2],l=f[5],k=f[8];j[0]=i*s+h*e+g*m;j[3]=i*r+h*d+g*l;j[6]=i*q+h*c+g*k;j[1]=p*s+o*e+n*m;j[4]=p*r+o*d+n*l;j[7]=p*q+o*c+n*k;j[2]=y*s+x*e+w*m;j[5]=y*r+x*d+w*l;j[8]=y*q+x*c+w*k;return this},determinant:function(){var j=this.elements;var s=j[0],r=j[1],q=j[2],p=j[3],o=j[4],n=j[5],m=j[6],l=j[7],k=j[8];return s*o*k-s*n*l-r*p*k+r*n*m+q*p*l-q*o*m},getInverse:function(d,c){var f=d.elements;var h=this.elements;h[0]=f[10]*f[5]-f[6]*f[9];h[1]=-f[10]*f[1]+f[2]*f[9];h[2]=f[6]*f[1]-f[2]*f[5];h[3]=-f[10]*f[4]+f[6]*f[8];h[4]=f[10]*f[0]-f[2]*f[8];h[5]=-f[6]*f[0]+f[2]*f[4];h[6]=f[9]*f[4]-f[5]*f[8];h[7]=-f[9]*f[0]+f[1]*f[8];h[8]=f[5]*f[0]-f[1]*f[4];var e=f[0]*h[0]+f[1]*h[3]+f[2]*h[6];if(e===0){var g="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(c||false){throw new Error(g)}else{console.warn(g)}this.identity();return this}this.multiplyScalar(1/e);return this},transpose:function(){var d,c=this.elements;d=c[1];c[1]=c[3];c[3]=d;d=c[2];c[2]=c[6];c[6]=d;d=c[5];c[5]=c[7];c[7]=d;return this},getNormalMatrix:function(c){this.getInverse(c).transpose();return this},transposeIntoArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[3];d[2]=c[6];d[3]=c[1];d[4]=c[4];d[5]=c[7];d[6]=c[2];d[7]=c[5];d[8]=c[8];return this},clone:function(){var c=this.elements;return new b.Matrix3(c[0],c[3],c[6],c[1],c[4],c[7],c[2],c[5],c[8])},flattenToArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];return d},scale:function(d){var e=this.elements;var c=d.x,f=d.y;e[0]*=c;e[3]*=f;e[1]*=c;e[4]*=f;e[2]*=c;e[5]*=f;return this},getMatrix4:function(){var c=this.elements;return new Matrix4(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1)}};b._Float32Matrix4=function(p,o,m,k,h,g,f,e,c,s,r,q,n,l,j,i){var d=this.elements=new Float32Array(16)};b._Float32Matrix4.prototype={constructor:b._Float32Matrix4,set:function(p,o,m,k,h,g,f,e,c,s,r,q,n,l,j,i){var d=this.elements;d[0]=p;d[4]=o;d[8]=m;d[12]=k;d[1]=h;d[5]=g;d[9]=f;d[13]=e;d[2]=c;d[6]=s;d[10]=r;d[14]=q;d[3]=n;d[7]=l;d[11]=j;d[15]=i;return this},_multiplyDoubleMatricesMV:function(B,z){var y=B.elements;var g=z.elements;var l=this.elements;var k=y[0],j=y[4],i=y[8],h=y[12];var t=y[1],s=y[5],r=y[9],q=y[13];var E=y[2],D=y[6],C=y[10],A=y[14];var x=g[0],w=g[4],v=g[8],u=g[12];var f=g[1],e=g[5],d=g[9],c=g[13];var p=g[2],o=g[6],n=g[10],m=g[14];l[0]=k*x+j*f+i*p;l[4]=k*w+j*e+i*o;l[8]=k*v+j*d+i*n;l[12]=k*u+j*c+i*m+h;l[1]=t*x+s*f+r*p;l[5]=t*w+s*e+r*o;l[9]=t*v+s*d+r*n;l[13]=t*u+s*c+r*m+q;l[2]=E*x+D*f+C*p;l[6]=E*w+D*e+C*o;l[10]=E*v+D*d+C*n;l[14]=E*u+D*c+C*m+A;l[3]=0;l[7]=0;l[11]=0;l[15]=1;return this},multiplyDoubleMatricesAndInverse:function(d,c){var e=new b.Matrix4().multiplyMatrices(d,c);return this.getInverseOfDoubleMatrix(e)},transpose:function(){var d=this.elements;var c;c=d[1];d[1]=d[4];d[4]=c;c=d[2];d[2]=d[8];d[8]=c;c=d[6];d[6]=d[9];d[9]=c;c=d[3];d[3]=d[12];d[12]=c;c=d[7];d[7]=d[13];d[13]=c;c=d[11];d[11]=d[14];d[14]=c;return this},getInverseOfDoubleMatrix:function(t,j){var i=this.elements;var y=t.elements;var r=y[0],p=y[4],n=y[8],k=y[12];var x=y[1],w=y[5],v=y[9],u=y[13];var f=y[2],e=y[6],d=y[10],c=y[14];var s=y[3],q=y[7],o=y[11],l=y[15];i[0]=v*c*q-u*d*q+u*e*o-w*c*o-v*e*l+w*d*l;i[4]=k*d*q-n*c*q-k*e*o+p*c*o+n*e*l-p*d*l;i[8]=n*u*q-k*v*q+k*w*o-p*u*o-n*w*l+p*v*l;i[12]=k*v*e-n*u*e-k*w*d+p*u*d+n*w*c-p*v*c;i[1]=u*d*s-v*c*s-u*f*o+x*c*o+v*f*l-x*d*l;i[5]=n*c*s-k*d*s+k*f*o-r*c*o-n*f*l+r*d*l;i[9]=k*v*s-n*u*s-k*x*o+r*u*o+n*x*l-r*v*l;i[13]=n*u*f-k*v*f+k*x*d-r*u*d-n*x*c+r*v*c;i[2]=w*c*s-u*e*s+u*f*q-x*c*q-w*f*l+x*e*l;i[6]=k*e*s-p*c*s-k*f*q+r*c*q+p*f*l-r*e*l;i[10]=p*u*s-k*w*s+k*x*q-r*u*q-p*x*l+r*w*l;i[14]=k*w*f-p*u*f-k*x*e+r*u*e+p*x*c-r*w*c;i[3]=v*e*s-w*d*s-v*f*q+x*d*q+w*f*o-x*e*o;i[7]=p*d*s-n*e*s+n*f*q-r*d*q-p*f*o+r*e*o;i[11]=n*w*s-p*v*s-n*x*q+r*v*q+p*x*o-r*w*o;i[15]=p*v*f-n*w*f+n*x*e-r*v*e-p*x*d+r*w*d;var g=y[0]*i[0]+y[1]*i[4]+y[2]*i[8]+y[3]*i[12];if(g==0){var h="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(j||false){throw new Error(h)}else{console.warn(h)}this.identity();return this}this.multiplyScalar(1/g);return this},multiplyScalar:function(c){var d=this.elements;d[0]*=c;d[4]*=c;d[8]*=c;d[12]*=c;d[1]*=c;d[5]*=c;d[9]*=c;d[13]*=c;d[2]*=c;d[6]*=c;d[10]*=c;d[14]*=c;d[3]*=c;d[7]*=c;d[11]*=c;d[15]*=c;return this},};var a=false;b.Matrix4=function(o,n,l,j,g,f,e,d,c,r,q,p,m,k,i,h){if(o!==undefined){this.elements=[o,g,c,m,n,f,r,k,l,e,q,i,j,d,p,h]}else{this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};b.Matrix4.prototype={constructor:b.Matrix4,set:function(p,o,m,k,h,g,f,e,c,s,r,q,n,l,j,i){var d=this.elements;d[0]=p;d[4]=o;d[8]=m;d[12]=k;d[1]=h;d[5]=g;d[9]=f;d[13]=e;d[2]=c;d[6]=s;d[10]=r;d[14]=q;d[3]=n;d[7]=l;d[11]=j;d[15]=i;return this},getValue:function(c,d){return this.elements[(d-1)*4+c-1]},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},isIdentity:function(){var c=this.elements;return(c[0]===1&&c[1]===0&&c[2]===0&&c[3]===0&&c[4]===0&&c[5]===1&&c[6]===0&&c[7]===0&&c[8]===0&&c[9]===0&&c[10]===1&&c[11]===0&&c[12]===0&&c[13]===0&&c[14]===0&&c[15]===1)},copy:function(c){var d=c.elements;this.set(d[0],d[4],d[8],d[12],d[1],d[5],d[9],d[13],d[2],d[6],d[10],d[14],d[3],d[7],d[11],d[15]);return this},createJSON:function(){if(this.isIdentity()){return"identity"}var d=[];var c,e=this.elements;if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[7]===0&&e[8]===0&&e[9]===0&&e[10]===1&&e[11]===0&&e[15]===1){d.push(e[12]);d.push(e[13]);d.push(e[14])}else{for(c=0;c<16;c++){d.push(this.elements[c])}}return d},setFromJSON:function(d){if(d==="identity"){this.identity()}else{if(d.length===3){this.identity();this.elements[12]=d[0];this.elements[13]=d[1];this.elements[14]=d[2]}else{var c;for(c=0;c<16;c++){this.elements[c]=d[c]}}}},setRotationFromEuler:function(o,r){var k=this.elements;var n=o.x,m=o.y,l=o.z;var H=Math.cos(n),G=Math.sin(n);var E=Math.cos(m),B=Math.sin(m);var u=Math.cos(l),s=Math.sin(l);if(r===undefined||r==="XYZ"){var A=H*u,t=H*s,h=G*u,g=G*s;k[0]=E*u;k[4]=-E*s;k[8]=B;k[1]=t+h*B;k[5]=A-g*B;k[9]=-G*E;k[2]=g-A*B;k[6]=h+t*B;k[10]=H*E}else{if(r==="YXZ"){var q=E*u,p=E*s,D=B*u,w=B*s;k[0]=q+w*G;k[4]=D*G-p;k[8]=H*B;k[1]=H*s;k[5]=H*u;k[9]=-G;k[2]=p*G-D;k[6]=w+q*G;k[10]=H*E}else{if(r==="ZXY"){var q=E*u,p=E*s,D=B*u,w=B*s;k[0]=q-w*G;k[4]=-H*s;k[8]=D+p*G;k[1]=p+D*G;k[5]=H*u;k[9]=w-q*G;k[2]=-H*B;k[6]=G;k[10]=H*E}else{if(r==="ZYX"){var A=H*u,t=H*s,h=G*u,g=G*s;k[0]=E*u;k[4]=h*B-t;k[8]=A*B+g;k[1]=E*s;k[5]=g*B+A;k[9]=t*B-h;k[2]=-B;k[6]=G*E;k[10]=H*E}else{if(r==="YZX"){var F=H*E,C=H*B,j=G*E,i=G*B;k[0]=E*u;k[4]=i-F*s;k[8]=j*s+C;k[1]=s;k[5]=H*u;k[9]=-G*u;k[2]=-B*u;k[6]=C*s+j;k[10]=F-i*s}else{if(r==="XZY"){var F=H*E,C=H*B,j=G*E,i=G*B;k[0]=E*u;k[4]=-s;k[8]=B*u;k[1]=F*s+i;k[5]=H*u;k[9]=C*s-j;k[2]=j*s-C;k[6]=G*u;k[10]=i*s+F}}}}}}return this},setRotationFromQuaternion:function(n){var g=this.elements;var j=n.x,i=n.y,h=n.z,k=n.w;var p=j+j,c=i+i,l=h+h;var f=j*p,e=j*c,d=j*l;var o=i*c,m=i*l,t=h*l;var u=k*p,s=k*c,r=k*l;g[0]=1-(o+t);g[4]=e-r;g[8]=d+s;g[1]=e+r;g[5]=1-(f+t);g[9]=m-u;g[2]=d-s;g[6]=m+u;g[10]=1-(f+o);return this},makeRotationFromQuaternion:function(n){var g=this.elements;var j=n.x,i=n.y,h=n.z,k=n.w;var p=j+j,c=i+i,l=h+h;var f=j*p,e=j*c,d=j*l;var o=i*c,m=i*l,t=h*l;var u=k*p,s=k*c,r=k*l;g[0]=1-(o+t);g[4]=e-r;g[8]=d+s;g[1]=e+r;g[5]=1-(f+t);g[9]=m-u;g[2]=d-s;g[6]=m+u;g[10]=1-(f+o);g[3]=0;g[7]=0;g[11]=0;g[12]=0;g[13]=0;g[14]=0;g[15]=1;return this},lookAt:function(){var c=new b.Vector3();var e=new b.Vector3();var d=new b.Vector3();return function(g,h,f){var i=this.elements;d.subVectors(g,h).normalize();if(d.length()===0){d.z=1}c.crossVectors(f,d).normalize();if(c.length()===0){d.x+=0.0001;c.crossVectors(f,d).normalize()}e.crossVectors(d,c);i[0]=c.x;i[4]=e.x;i[8]=d.x;i[1]=c.y;i[5]=e.y;i[9]=d.y;i[2]=c.z;i[6]=e.z;i[10]=d.z;return this}}(),multiply:function(c,d){if(d!==undefined){console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(c,d)}return this.multiplyMatrices(this,c)},multiplyMatrices:function(M,L){if(!L){this.copy(M);return this}var s=M.elements;var K=L.elements;var c=this.elements;var p=s[0],n=s[4],m=s[8],l=s[12];var J=s[1],I=s[5],H=s[9],G=s[13];var B=s[2],A=s[6],z=s[10],y=s[14];var t=s[3],r=s[7],q=s[11],o=s[15];var i=K[0],g=K[4],e=K[8],d=K[12];var F=K[1],E=K[5],D=K[9],C=K[13];var x=K[2],w=K[6],v=K[10],u=K[14];var k=K[3],j=K[7],h=K[11],f=K[15];c[0]=p*i+n*F+m*x+l*k;c[4]=p*g+n*E+m*w+l*j;c[8]=p*e+n*D+m*v+l*h;c[12]=p*d+n*C+m*u+l*f;c[1]=J*i+I*F+H*x+G*k;c[5]=J*g+I*E+H*w+G*j;c[9]=J*e+I*D+H*v+G*h;c[13]=J*d+I*C+H*u+G*f;c[2]=B*i+A*F+z*x+y*k;c[6]=B*g+A*E+z*w+y*j;c[10]=B*e+A*D+z*v+y*h;c[14]=B*d+A*C+z*u+y*f;c[3]=t*i+r*F+q*x+o*k;c[7]=t*g+r*E+q*w+o*j;c[11]=t*e+r*D+q*v+o*h;c[15]=t*d+r*C+q*u+o*f;return this},multiplyToArray:function(d,c,e){var f=this.elements;this.multiplyMatrices(d,c);e[0]=f[0];e[1]=f[1];e[2]=f[2];e[3]=f[3];e[4]=f[4];e[5]=f[5];e[6]=f[6];e[7]=f[7];e[8]=f[8];e[9]=f[9];e[10]=f[10];e[11]=f[11];e[12]=f[12];e[13]=f[13];e[14]=f[14];e[15]=f[15];return this},multiplyScalar:function(c){var d=this.elements;d[0]*=c;d[4]*=c;d[8]*=c;d[12]*=c;d[1]*=c;d[5]*=c;d[9]*=c;d[13]*=c;d[2]*=c;d[6]*=c;d[10]*=c;d[14]*=c;d[3]*=c;d[7]*=c;d[11]*=c;d[15]*=c;return this},multiplyVector3:function(c){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return c.applyProjection(this)},multiplyVector4:function(c){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return c.applyMatrix4(this)},multiplyVector3Array:function(){var c=new b.Vector3();return function(d){for(var f=0,e=d.length;f<e;f+=3){c.x=d[f];c.y=d[f+1];c.z=d[f+2];c.applyProjection(this);d[f]=c.x;d[f+1]=c.y;d[f+2]=c.z}return d}}(),rotateAxis:function(c){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");c.transformDirection(this)},crossVector:function(c){var e=this.elements;var d=new b.Vector4();d.x=e[0]*c.x+e[4]*c.y+e[8]*c.z+e[12]*c.w;d.y=e[1]*c.x+e[5]*c.y+e[9]*c.z+e[13]*c.w;d.z=e[2]*c.x+e[6]*c.y+e[10]*c.z+e[14]*c.w;d.w=(c.w)?e[3]*c.x+e[7]*c.y+e[11]*c.z+e[15]*c.w:1;return d},determinant:function(){var e=this.elements;var p=e[0],o=e[4],m=e[8],k=e[12];var h=e[1],g=e[5],f=e[9],d=e[13];var c=e[2],s=e[6],r=e[10],q=e[14];var n=e[3],l=e[7],j=e[11],i=e[15];return(n*(+k*f*s-m*d*s-k*g*r+o*d*r+m*g*q-o*f*q)+l*(+p*f*q-p*d*r+k*h*r-m*h*q+m*d*c-k*f*c)+j*(+p*d*s-p*g*q-k*h*s+o*h*q+k*g*c-o*d*c)+i*(-m*g*c-p*f*s+p*g*r+m*h*s-o*h*r+o*f*c))},transpose:function(){var d=this.elements;var c;c=d[1];d[1]=d[4];d[4]=c;c=d[2];d[2]=d[8];d[8]=c;c=d[6];d[6]=d[9];d[9]=c;c=d[3];d[3]=d[12];d[12]=c;c=d[7];d[7]=d[13];d[13]=c;c=d[11];d[11]=d[14];d[14]=c;return this},flattenToArray:function(d){var c=this.elements;d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d},setFromArray:function(d){var c=this.elements;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},flattenToArrayOffset:function(e,d){var c=this.elements;e[d]=c[0];e[d+1]=c[1];e[d+2]=c[2];e[d+3]=c[3];e[d+4]=c[4];e[d+5]=c[5];e[d+6]=c[6];e[d+7]=c[7];e[d+8]=c[8];e[d+9]=c[9];e[d+10]=c[10];e[d+11]=c[11];e[d+12]=c[12];e[d+13]=c[13];e[d+14]=c[14];e[d+15]=c[15];return e},getPosition:function(){var c=new b.Vector3();return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var d=this.elements;return c.set(d[12],d[13],d[14])}}(),setPosition:function(c){var d=this.elements;d[12]=c.x;d[13]=c.y;d[14]=c.z;return this},getInverse:function(t,j){var i=this.elements;var y=t.elements;var r=y[0],p=y[4],n=y[8],k=y[12];var x=y[1],w=y[5],v=y[9],u=y[13];var f=y[2],e=y[6],d=y[10],c=y[14];var s=y[3],q=y[7],o=y[11],l=y[15];i[0]=v*c*q-u*d*q+u*e*o-w*c*o-v*e*l+w*d*l;i[4]=k*d*q-n*c*q-k*e*o+p*c*o+n*e*l-p*d*l;i[8]=n*u*q-k*v*q+k*w*o-p*u*o-n*w*l+p*v*l;i[12]=k*v*e-n*u*e-k*w*d+p*u*d+n*w*c-p*v*c;i[1]=u*d*s-v*c*s-u*f*o+x*c*o+v*f*l-x*d*l;i[5]=n*c*s-k*d*s+k*f*o-r*c*o-n*f*l+r*d*l;i[9]=k*v*s-n*u*s-k*x*o+r*u*o+n*x*l-r*v*l;i[13]=n*u*f-k*v*f+k*x*d-r*u*d-n*x*c+r*v*c;i[2]=w*c*s-u*e*s+u*f*q-x*c*q-w*f*l+x*e*l;i[6]=k*e*s-p*c*s-k*f*q+r*c*q+p*f*l-r*e*l;i[10]=p*u*s-k*w*s+k*x*q-r*u*q-p*x*l+r*w*l;i[14]=k*w*f-p*u*f-k*x*e+r*u*e+p*x*c-r*w*c;i[3]=v*e*s-w*d*s-v*f*q+x*d*q+w*f*o-x*e*o;i[7]=p*d*s-n*e*s+n*f*q-r*d*q-p*f*o+r*e*o;i[11]=n*w*s-p*v*s-n*x*q+r*v*q+p*x*o-r*w*o;i[15]=p*v*f-n*w*f+n*x*e-r*v*e-p*x*d+r*w*d;var g=y[0]*i[0]+y[1]*i[4]+y[2]*i[8]+y[3]*i[12];if(g==0){var h="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(j||false){throw new Error(h)}else{console.warn(h)}this.identity();return this}this.multiplyScalar(1/g);return this},extractBasis:function(d,c,e){var f=this.elements;d.set(f[0],f[1],f[2]);c.set(f[4],f[5],f[6]);e.set(f[8],f[9],f[10]);return this},makeBasis:function(d,c,e){this.set(d.x,c.x,e.x,0,d.y,c.y,e.y,0,d.z,c.z,e.z,0,0,0,0,1);return this},extractPosition:function(c){var e=this.elements;var d=c.elements;e[12]=d[12];e[13]=d[13];e[14]=d[14];return this},extractRotation:function(c){var d=new b.Vector3();return function(e){var j=this.elements;var i=e.elements;var h=1/d.set(i[0],i[1],i[2]).length();var g=1/d.set(i[4],i[5],i[6]).length();var f=1/d.set(i[8],i[9],i[10]).length();j[0]=i[0]*h;j[1]=i[1]*h;j[2]=i[2]*h;j[4]=i[4]*g;j[5]=i[5]*g;j[6]=i[6]*g;j[8]=i[8]*f;j[9]=i[9]*f;j[10]=i[10]*f;return this}}(),translate:function(d){var f=this.elements;var c=d.x,g=d.y,e=d.z;f[12]=f[0]*c+f[4]*g+f[8]*e+f[12];f[13]=f[1]*c+f[5]*g+f[9]*e+f[13];f[14]=f[2]*c+f[6]*g+f[10]*e+f[14];f[15]=f[3]*c+f[7]*g+f[11]*e+f[15];return this},rotateX:function(g){var f=this.elements;var k=f[4];var e=f[5];var n=f[6];var j=f[7];var i=f[8];var d=f[9];var m=f[10];var h=f[11];var l=Math.cos(g);var o=Math.sin(g);f[4]=l*k+o*i;f[5]=l*e+o*d;f[6]=l*n+o*m;f[7]=l*j+o*h;f[8]=l*i-o*k;f[9]=l*d-o*e;f[10]=l*m-o*n;f[11]=l*h-o*j;return this},rotateY:function(g){var f=this.elements;var k=f[0];var e=f[1];var n=f[2];var j=f[3];var i=f[8];var d=f[9];var m=f[10];var h=f[11];var l=Math.cos(g);var o=Math.sin(g);f[0]=l*k-o*i;f[1]=l*e-o*d;f[2]=l*n-o*m;f[3]=l*j-o*h;f[8]=l*i+o*k;f[9]=l*d+o*e;f[10]=l*m+o*n;f[11]=l*h+o*j;return this},rotateZ:function(g){var f=this.elements;var k=f[0];var e=f[1];var n=f[2];var j=f[3];var i=f[4];var d=f[5];var m=f[6];var h=f[7];var l=Math.cos(g);var o=Math.sin(g);f[0]=l*k+o*i;f[1]=l*e+o*d;f[2]=l*n+o*m;f[3]=l*j+o*h;f[4]=l*i-o*k;f[5]=l*d-o*e;f[6]=l*m-o*n;f[7]=l*h-o*j;return this},rotateByAxis:function(p,o){var d=this.elements;if(p.x===1&&p.y===0&&p.z===0){return this.rotateX(o)}else{if(p.x===0&&p.y===1&&p.z===0){return this.rotateY(o)}else{if(p.x===0&&p.y===0&&p.z===1){return this.rotateZ(o)}}}var H=p.x,G=p.y,F=p.z;var J=Math.sqrt(H*H+G*G+F*F);H/=J;G/=J;F/=J;var A=H*H,i=G*G,Q=F*F;var S=Math.cos(o);var I=Math.sin(o);var q=1-S;var w=H*G*q;var v=H*F*q;var h=G*F*q;var C=H*I;var m=G*I;var V=F*I;var l=A+(1-A)*S;var U=w+V;var E=v-m;var k=w-V;var T=i+(1-i)*S;var D=h+C;var j=v+m;var R=h-C;var B=Q+(1-Q)*S;var N=d[0],u=d[1],g=d[2],P=d[3];var L=d[4],t=d[5],f=d[6],O=d[7];var K=d[8],r=d[9],e=d[10],M=d[11];d[0]=l*N+U*L+E*K;d[1]=l*u+U*t+E*r;d[2]=l*g+U*f+E*e;d[3]=l*P+U*O+E*M;d[4]=k*N+T*L+D*K;d[5]=k*u+T*t+D*r;d[6]=k*g+T*f+D*e;d[7]=k*P+T*O+D*M;d[8]=j*N+R*L+B*K;d[9]=j*u+R*t+B*r;d[10]=j*g+R*f+B*e;d[11]=j*P+R*O+B*M;return this},scale:function(d){var f=this.elements;var c=d.x,g=d.y,e=d.z;f[0]*=c;f[4]*=g;f[8]*=e;f[1]*=c;f[5]*=g;f[9]*=e;f[2]*=c;f[6]*=g;f[10]*=e;f[3]*=c;f[7]*=g;f[11]*=e;return this},getMaxScaleOnAxis:function(){var e=this.elements;var f=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];var d=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];var c=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(f,Math.max(d,c)))},makeTranslation:function(c,e,d){this.set(1,0,0,c,0,1,0,e,0,0,1,d,0,0,0,1);return this},makeRotationX:function(d){var f=Math.cos(d),e=Math.sin(d);this.set(1,0,0,0,0,f,-e,0,0,e,f,0,0,0,0,1);return this},makeRotationY:function(d){var f=Math.cos(d),e=Math.sin(d);this.set(f,0,e,0,0,1,0,0,-e,0,f,0,0,0,0,1);return this},makeRotationZ:function(d){var f=Math.cos(d),e=Math.sin(d);this.set(f,-e,0,0,e,f,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(d,e){var h=Math.cos(e);var m=Math.sin(e);var l=1-h;var k=d.x,j=d.y,i=d.z;var g=l*k,f=l*j;this.set(g*k+h,g*j-m*i,g*i+m*j,0,g*j+m*i,f*j+h,f*i-m*k,0,g*i-m*j,f*i+m*k,l*i*i+h,0,0,0,0,1);return this},makeScale:function(c,e,d){this.set(c,0,0,0,0,e,0,0,0,0,d,0,0,0,0,1);return this},makeFrustum:function(g,q,e,n,i,h){var f=this.elements;var p=2*i/(q-g);var m=2*i/(n-e);var o=(q+g)/(q-g);var l=(n+e)/(n-e);var k=-(h+i)/(h-i);var j=-2*h*i/(h-i);f[0]=p;f[4]=0;f[8]=o;f[12]=0;f[1]=0;f[5]=m;f[9]=l;f[13]=0;f[2]=0;f[6]=0;f[10]=k;f[14]=j;f[3]=0;f[7]=0;f[11]=-1;f[15]=0;return this},makePerspective:function(g,c,i,h,l,k){var e=i*Math.tan(b.Math.degToRad(g*0.5));var j=-e;var d=j*c;var f=e*c;if(l){l*=Math.abs(f-d);d+=l;f+=l}if(k){k*=Math.abs(e-j);j+=k;e+=k}return this.makeFrustum(d,f,j,e,i,h)},makeOrthographic:function(f,q,m,c,j,i){var e=this.elements;var o=q-f;var g=m-c;var d=i-j;var n=(q+f)/o;var l=(m+c)/g;var k=(i+j)/d;e[0]=2/o;e[4]=0;e[8]=0;e[12]=-n;e[1]=0;e[5]=2/g;e[9]=0;e[13]=-l;e[2]=0;e[6]=0;e[10]=-2/d;e[14]=-k;e[3]=0;e[7]=0;e[11]=0;e[15]=1;return this},clone:function(){var c=this.elements;return new b.Matrix4(c[0],c[4],c[8],c[12],c[1],c[5],c[9],c[13],c[2],c[6],c[10],c[14],c[3],c[7],c[11],c[15])}};b.extend(b.Matrix4.prototype,{compose:function(){var d=new b.Matrix4();var c=new b.Matrix4();return function(e,f,h){var g=this.elements;d.identity();d.setRotationFromQuaternion(f);c.makeScale(h.x,h.y,h.z);this.multiplyMatrices(d,c);g[12]=e.x;g[13]=e.y;g[14]=e.z;return this}}(),decompose:function(){var c=new b.Vector3();var f=new b.Vector3();var e=new b.Vector3();var d=new b.Matrix4();return function(g,h,j){var i=this.elements;c.set(i[0],i[1],i[2]);f.set(i[4],i[5],i[6]);e.set(i[8],i[9],i[10]);g=(g instanceof b.Vector3)?g:new b.Vector3();h=(h instanceof b.Quaternion)?h:new b.Quaternion();j=(j instanceof b.Vector3)?j:new b.Vector3();j.x=c.length();j.y=f.length();j.z=e.length();g.x=i[12];g.y=i[13];g.z=i[14];d.copy(this);d.elements[0]/=j.x;d.elements[1]/=j.x;d.elements[2]/=j.x;d.elements[4]/=j.y;d.elements[5]/=j.y;d.elements[6]/=j.y;d.elements[8]/=j.z;d.elements[9]/=j.z;d.elements[10]/=j.z;h.setFromRotationMatrix(d);return[g,h,j]}}()});b.Color=function(c){if(c!==undefined){this.set(c)}return this};b.Color.prototype={constructor:b.Color,r:1,g:1,b:1,set:function(c){switch(typeof c){case"number":this.setHex(c);break;case"string":this.setStyle(c);break;case"object":this.copy(c);break}},setHex:function(c){c=Math.floor(c);this.r=(c>>16&255)/255;this.g=(c>>8&255)/255;this.b=(c&255)/255;return this},setRGB:function(e,d,c){this.r=e;this.g=d;this.b=c;return this},setHSV:function(e,d,c){console.log("DEPRECATED: Color's .setHSV() will be removed. Use .setHSL( h, s, l ) instead.");return this.setHSL(e,d*c/((e=(2-d)*c)<1?e:2-e),e/2)},setHSL:function(f,e,d){if(e===0){this.r=this.g=this.b=d}else{var c=function(k,j,h){if(h<0){h+=1}if(h>1){h-=1}if(h<1/6){return k+(j-k)*6*h}if(h<1/2){return j}if(h<2/3){return k+(j-k)*6*(2/3-h)}return k};var i=d<=0.5?d*(1+e):d+e-(d*e);var g=(2*d)-i;this.r=c(g,i,f+1/3);this.g=c(g,i,f);this.b=c(g,i,f-1/3)}return this},setStyle:function(d){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(d)){var c=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(d);this.r=Math.min(255,parseInt(c[1],10))/255;this.g=Math.min(255,parseInt(c[2],10))/255;this.b=Math.min(255,parseInt(c[3],10))/255;return this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(d)){var c=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(d);this.r=Math.min(100,parseInt(c[1],10))/100;this.g=Math.min(100,parseInt(c[2],10))/100;this.b=Math.min(100,parseInt(c[3],10))/100;return this}if(/^\#([0-9a-f]{6})$/i.test(d)){var c=/^\#([0-9a-f]{6})$/i.exec(d);this.setHex(parseInt(c[1],16));return this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(d)){var c=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(d);this.setHex(parseInt(c[1]+c[1]+c[2]+c[2]+c[3]+c[3],16));return this}if(/^(\w+)$/i.test(d)){this.setHex(b.ColorKeywords[d]);return this}},copy:function(c){this.r=c.r;this.g=c.g;this.b=c.b;return this},copyGammaToLinearNRECompatible:function(c){this.r=(c.r<0.04045)?(c.r/12.92):Math.pow((c.r+0.055)/1.055,2.4);this.g=(c.g<0.04045)?(c.g/12.92):Math.pow((c.g+0.055)/1.055,2.4);this.b=(c.b<0.04045)?(c.b/12.92):Math.pow((c.b+0.055)/1.055,2.4);return this},copyGammaToLinear:function(c){this.r=c.r*c.r;this.g=c.g*c.g;this.b=c.b*c.b;return this},copyLinearToGamma:function(c){this.r=Math.sqrt(c.r);this.g=Math.sqrt(c.g);this.b=Math.sqrt(c.b);return this},convertGammaToLinear:function(){var e=this.r,d=this.g,c=this.b;this.r=e*e;this.g=d*d;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return(this.r*255)<<16^(this.g*255)<<8^(this.b*255)<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var c={h:0,s:0,l:0};return function(){var d=this.r,h=this.g,j=this.b;var k=Math.max(d,h,j);var e=Math.min(d,h,j);var i,f;var m=(e+k)/2;if(e===k){i=0;f=0}else{var l=k-e;f=m<=0.5?l/(k+e):l/(2-k-e);switch(k){case d:i=(h-j)/l+(h<j?6:0);break;case h:i=(j-d)/l+2;break;case j:i=(d-h)/l+4;break}i/=6}c.h=i;c.s=f;c.l=m;return c}}(),getStyle:function(){return"rgb("+((this.r*255)|0)+","+((this.g*255)|0)+","+((this.b*255)|0)+")"},offsetHSL:function(f,e,c){var d=this.getHSL();d.h+=f;d.s+=e;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(c){this.r+=c.r;this.g+=c.g;this.b+=c.b;return this},addColors:function(d,c){this.r=d.r+c.r;this.g=d.g+c.g;this.b=d.b+c.b;return this},addScalar:function(c){this.r+=c;this.g+=c;this.b+=c;return this},multiply:function(c){this.r*=c.r;this.g*=c.g;this.b*=c.b;return this},multiplyScalar:function(c){this.r*=c;this.g*=c;this.b*=c;return this},desaturate:function(d){var c=0.587*this.g+0.299*this.r+0.114*this.b;var e=Math.min(Math.max(1-d,0.00001),1);this.r=this.r*e+d*c;this.g=this.g*e+d*c;this.b=this.b*e+d*c;return this},saturate:function(d){var c=0.587*this.g+0.299*this.r+0.114*this.b;var e=1/Math.min(Math.max(1-d,0.00001),1);this.r=(this.r-d*c)*e;this.g=(this.g-d*c)*e;this.b=(this.b-d*c)*e;return this},alphaBlend:function(c,d){d=Math.min(Math.max(d,0),0.99999);var e=1-d;this.r=c.r*d+this.r*e;this.g=c.g*d+this.g*e;this.b=c.b*d+this.b*e;return this},negative:function(){this.r=1-this.r;this.g=1-this.g;this.b=1-this.b;return this},lerp:function(c,d){this.r+=(c.r-this.r)*d;this.g+=(c.g-this.g)*d;this.b+=(c.b-this.b)*d;return this},equals:function(d){return(d.r===this.r)&&(d.g===this.g)&&(d.b===this.b)},clone:function(){return new b.Color().setRGB(this.r,this.g,this.b)},toArray:function(){return[this.r,this.g,this.b]}};b.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};return b});define("Mesh/ThreeJS_Base",["DS/Mesh/ThreeJS_Base","DS/DSMigration/DSMigration"],function(b,a){a.deprecateModule("Mesh/ThreeJS_Base");return b});