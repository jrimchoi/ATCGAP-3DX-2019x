(function(a){a.onmessage=function(b){require(["DS/GEO7zip/GEO7zip"],function(h){var g=b.data.meshName;var f=b.data.arraybuffer;var j=b.data.id;var i=b.data.ply;var e=b.data.parameters;if(i){var d=a._parsePLY(i,e);postMessage({meshInputs:d,id:j})}else{if(f){if(!a.geo7Zip){a.geo7Zip=new h(f);var c=a.geo7Zip.listEntries.length;postMessage({zipSize:c,id:j})}}else{a.geo7Zip.unzipEntry(g,f).then(function(l){var k=a.geo7Zip.listEntries.length;postMessage({data:l,zipSize:k,id:j})})}}})};a._parsePLY=function(G,o){var d=o.color.r;var p=o.color.g;var v=o.color.b;var w=o.color.a;var H=o.Scale;if(H===undefined){H=1}var b=G.split("\n");var y=/(element)(\s+)(vertex)(\s+)(\d+)/;var F=/(element)(\s+)(face)(\s+)(\d+)/;var z=/([+-]?\d*\.\d+)(?![-+0-9.])(\s+)+([+-]?\d*\.\d+)(?![-+0-9.])(\s+)+([+-]?\d*\.\d+)(?![-+0-9.])/;var E=/(3)(\s+)(\d+)(\s+)(\d+)(\s+)(\d+)/;var u;var l;var c;if((u=y.exec(G))!==null){l=parseInt(u[5])}if((u=F.exec(G))!==null){c=parseInt(u[5])}var m=-1;for(var D=0;D<b.length&&m===-1;D++){var t=b[D];t=t.trim();if(t.search("end_header")!==-1){m=D+1}}var I=new Float32Array(l*3);var h=new Float32Array(c*3);for(var C=m;C<m+l;C++){var s=b[C];s=s.trim();if((u=z.exec(s))!==null){I[3*(C-m)]=parseFloat(u[1]);I[3*(C-m)+1]=parseFloat(u[3]);I[3*(C-m)+2]=parseFloat(u[5])}}var B=c;var n=new Float32Array(B*3*3);var x=new Float32Array(B*3*3);var r=new Float32Array(B*4*3);for(var A=m+l;A<m+l+c;A++){var q=b[A];q=q.trim();if((u=E.exec(q))!==null){var g=parseFloat(u[3]);var f=parseFloat(u[5]);var e=parseFloat(u[7]);h[3*(A-m-l)]=parseFloat(u[3]);h[3*(A-m-l)+1]=parseFloat(u[5]);h[3*(A-m-l)+2]=parseFloat(u[7]);n[(A-m-l)*9]=1000*H*I[g*3];n[(A-m-l)*9+1]=1000*H*I[g*3+1];n[(A-m-l)*9+2]=1000*H*I[g*3+2];n[(A-m-l)*9+3]=1000*H*I[f*3];n[(A-m-l)*9+4]=1000*H*I[f*3+1];n[(A-m-l)*9+5]=1000*H*I[f*3+2];n[(A-m-l)*9+6]=1000*H*I[e*3];n[(A-m-l)*9+7]=1000*H*I[e*3+1];n[(A-m-l)*9+8]=1000*H*I[e*3+2];x[(A-m-l)*9]=-(I[f*3+1]-I[g*3+1])*(I[e*3+2]-I[g*3+2])+(I[f*3+2]-I[g*3+2])*(I[e*3+1]-I[g*3+1]);x[(A-m-l)*9+1]=(I[f*3+2]-I[g*3+2])*(I[e*3]-I[g*3])-(I[f*3]-I[g*3])*(I[e*3+2]-I[g*3+2]);x[(A-m-l)*9+2]=(I[f*3]-I[g*3])*(I[e*3+1]-I[g*3+1])-(I[f*3+1]-I[g*3+1])*(I[e*3]-I[g*3]);x[(A-m-l)*9+3]=x[(A-m-l)*9];x[(A-m-l)*9+4]=x[(A-m-l)*9+1];x[(A-m-l)*9+5]=x[(A-m-l)*9+2];x[(A-m-l)*9+6]=x[(A-m-l)*9];x[(A-m-l)*9+7]=x[(A-m-l)*9+1];x[(A-m-l)*9+8]=x[(A-m-l)*9+2];r[(A-m-l)*12]=d;r[(A-m-l)*12+1]=p;r[(A-m-l)*12+2]=v;r[(A-m-l)*12+3]=w;r[(A-m-l)*12+4]=d;r[(A-m-l)*12+5]=p;r[(A-m-l)*12+6]=v;r[(A-m-l)*12+7]=w;r[(A-m-l)*12+8]=d;r[(A-m-l)*12+9]=p;r[(A-m-l)*12+10]=v;r[(A-m-l)*12+11]=w}}return{nbFaces:B,vertices:n,normals:x,colors:r}}})(this);