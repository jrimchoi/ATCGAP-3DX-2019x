define("DS/SwymUICore/script/lib/pub-sub",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener"],function(f,e,b,d){var c=d.extend(b,{});var a=e.extend({_persistedEvents:null,init:function(){this._persistedEvents={};this._eventMgr=new c();return this._parent.apply(this,arguments)},_addEvent:function(h,l,j,g,i,k){var m=this._persistedEvents[h];if(k!==true){this._eventMgr.addEvent(h,l,j,i)}if((g!==false)&&m){l.apply(j,f.is(m,"array")?m:[m]);return l}else{if(k===true){this._eventMgr.addEventOnce(h,l,j,i)}}return true},_listenTo:function(k,g,j,h,i){if(i===true){this._eventMgr.listenToOnce(k,g,j,h)}else{this._eventMgr.listenTo(k,g,j,h)}return true},addEvent:function(h,k,j,g,i){return this._addEvent(h,k,j,g,i,false)},addEvents:function(k,j,h,i){for(var g in k){if(k.hasOwnProperty(g)){this.addEvent(g,k[g],j,h,i)}}},addEventOnce:function(h,k,j,g,i){return this._addEvent(h,k,j,g,i,true)},listenTo:function(j,g,i,h){return this._listenTo(j,g,i,h,false)},listenToOnce:function(j,g,i,h){return this._listenTo(j,g,i,h,true)},removeEvent:function(g,i,h){return this._eventMgr.removeEvent(g,i,h)},removeEvents:function(g){return this._eventMgr.removeEvents(g)},stopListening:function(h,g,i){return this._eventMgr.stopListening(h,g,i)},dispatchEvent:function(i,h,j){var g=this._eventMgr.dispatchEvent(i,h);if(j){h=h||[];this._persistedEvents[i]=h}return g},removePersisted:function(g){delete this._persistedEvents[g]}});return a});define("DS/SwymUICore/script/feature/core/mobile/utils",[],function(){function b(c){return c.format==="3dxml"}var a=["3d_model","sound","video","document"];return{shouldBePlayedInLightbox:function(c){if(c==="animatedPicture"){return false}else{return !this.isFormatNativelyPlayable(c)}},isFormatNativelyPlayable:function(c){return(a.indexOf(c)>=0)},getTransientUrlAndExtensionForAV:function(e){var d=e.get("play->av_streams"),c=d&&d[0]||{};return[c.transient_url,c.format]},getTransientUrlAndExtensionFor3DModel:function(e){var d=e.get("play->3d_streams"),c=d&&d.filter(b)[0]||{};return[c.transient_url,c.format]},getTransientUrlAndExtensionForDocument:function(c){return this.getTransientUrlAndExtensionForDownload(c)},getTransientUrlAndExtensionForDownload:function(c){return[c.get("play->download_original_url->transient_url",{escapeHTML:false}),c.get("play->download_original_url->format")]},getTransientUrlAndExtension:function(g,d){var f,h,c,e;if(d){e=this.getTransientUrlAndExtensionForDownload(g);f=e[0];h=e[1]}else{c=g.get("media_type");switch(c){case"sound":case"video":e=this.getTransientUrlAndExtensionForAV(g);break;case"document":e=this.getTransientUrlAndExtensionForDocument(g);break;case"3d_model":e=this.getTransientUrlAndExtensionFor3DModel(g);break;default:return[null,null]}f=e[0];h=e[1]}return[f,h]},openMediaInNativeMobileDevice:function(e,c){var d=this;require(["UWA/Promise","DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(g,f){var i,j,h;h=d.getTransientUrlAndExtension(e,c);i=h[0];j=h[1];((!i&&new g(function(l,k){e.fetch({onComplete:function(){h=d.getTransientUrlAndExtension(e);i=h[0];j=h[1];l()},onFailure:k})}))||g.resolve()).then(function(){f.sendOpenMediaRequest({transientURL:i,extension:j})})})}}});define("DS/SwymUICore/script/feature/community/media/editor/model/operation-model",["UWA/Core","UWA/Class/Model","DS/WebappsUtils/Console"],function(d,c,b){var a=c.extend({_modelName:"operation",_canvas:null,params:null,setup:function(e){this._canvas=e.canvas;this.params=e.params},setCanvas:function(e){this._canvas=e},getCanvas:function(){return this._canvas}});return a});define("DS/SwymUICore/script/utils/i18n",function(){var a={replace:function(c,b){return c.replace(/\{([\w\-]+)\}/g,function(d,e){return b[e]!==undefined?b[e]:""})}};return a});define("DS/SwymUICore/script/utils/utils",["UWA/Core","UWA/Utils","UWA/Array","DS/WebappsUtils/WebappsUtils","DS/UWPClientCode/PublicAPI","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI"],function(a,f,m,e,h,b,c){var p=null,q={activateMediaEdit:false,activateBookmarks:true,activateMassiveImportExportByOwner:true,activateMoveStatusAndNewPipeline:true,activateAccount:false,activateAutoSavedAsDraft:true,activateNewWiki:true,activateInline6WTagging:true,activateEnhancedSummary:true,activateSimplifiedMediaCreation:true,activateCommunityRequestsHistory:true,activateContentHighlight:true,activateUsersGroup:true,activateSubscribe:true,activateUrlPreview:false,activateCommentNotificationRedirection:true,activateSurveyImprovements:true,activateSpriteRemoval:true,activateGIF:true,noHomePage:false,activateCommentsLike:true,activateSendToKindle:false,activateNewFavoriteCommunities:true,enableBrowserNotifications:false,activateBots:false,activateSwymBot:false,activateConversationTopic:false};var s="preview-",k="/",n=":",o=new RegExp("\\"+n+"([%A-Za-z0-9-_$.+!*'()~]+)?","g"),d="WHATSNEW_MODE",j="TIMELINE_MODE";var l=function(t){if(require&&require.defined){return require.defined(t)}try{require(t);return true}catch(u){return false}};function g(u,v,x){x||(x=1);var w=[];var t;while(t=v.exec(u)){w.push(t[x])}return w}var r={TRANSIENT_WIDGET_ID_PREFIX:s,WHATSNEW_MODE:d,TIMELINE_MODE:j,SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_COMMUNITY:d,SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_CONVERSATION:j,debounce:function i(u,t){if(typeof u==="function"){return(function(){var x=null,y=null,z=t||50,A=null,w=function(){u.apply(y,x)},v=function(){y=this;x=arguments;if(A){clearTimeout(A)}A=setTimeout(w,z)};return v})()}else{throw new Error("First argument is supposed to be a function")}},setWidgetTitle:function(t,u){if(t.elements&&t.elements.header&&t.elements.header.getElement("span.title")&&u){t.elements.header.getElement("span.title").setHTML(u)}},getTopBarMainId:function(){return"topBarProxyDefault"},get:function(u,w,v,t){if(typeof u[w]==="function"){return u[w].apply(v,t)}else{return u[w]}},getMediaDefaultThumbnail:function(v){var u,x="xl_thumb_default_",t="media-default-thumb/",w=".png";if(typeof v==="string"){u=v}else{u=v.get("media_type")||v.getChanges("media_type")}switch(u){case"picture":x+="pic";break;case"sound":x+="sound";break;case"video":x+="vid";break;case"3d_model":x+="3D";break;case"drawing":x+="drawing";break;case"document":default:x+="doc"}return e.getWebappsAssetUrl("SwymUIComponents",t+x+w)},getMediaIconName:function(u){var t="",v;if(typeof u==="string"){t=u}else{t=u.get("media_type")||u.getChanges("media_type")}switch(t){case"sound":v="sound";break;case"video":v="video";break;case"3d_model":v="cube";break;case"document":v="doc";break;case"animatedPicture":v="picture-animated";break;default:v="picture"}return v},getIconFromModel:function(u){var t="";if(typeof u==="string"){t=u}else{t=u.getModelName()}switch(t){case"post":return"newspaper";case"media":return this.getMediaIconName(u);case"question":case"iquestion":return"help";case"idea":return"lamp";case"wiki":return"book-open";case"survey":return"clipboard";default:return""}},getContentIconUrl:function(w){var v,u,y="",t="/webapps/SwymUIComponents/assets/content-icon/",x=".png";if(typeof w==="string"){v=w}else{v=w.getModelName()}switch(v){case"post":case"idea":case"wiki":y=v;break;case"iquestion":y="iq";break;case"media":y="picture";if(typeof w!=="string"){u=w.get("media_type");switch(u){case"sound":case"video":case"document":y=u;break;case"3d_model":y="threed-file";break;default:break}}break;default:break}return y?(this.getBaseUrl()+t+y+x):""},removeForFutureReinsertion:function(t){var u=t.getParent(),v=t.nextSibling;if(v||u){t.remove();return function(w){if(v){(w||t).inject(v,"before")}else{(w||t).inject(u,"bottom")}}}else{return function(){}}},validateURL:function(t){var u=/^(ht|f)tps?:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/;return u.test(t)},getMyCommunitiesAppKey:function(){return"X3DMCTY_AP"},getProfileAppKey:function(){return"X3DPRFL_AP"},getContentReaderAppKey:function(){return"X3DVIEW_AP"},getControlCenterAppKey:function(){return"X3DOPSW_AP"},getAnalyticsAppKey:function(){return"X3DSTAT_AP"},pinToDashboard:function(t){if(!a.is(t.failure)){t.failure=function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/utils"],function(u,v){u.error(v.UnableToPinToTab)})}}top.require(["DS/Dashboard/PublicAPI"],function(u){t.tabId=u.getActiveTab().id;u.addModule(t)})},get3DDTransientAppUrl:function(v){if(v.contentType==="instantmessage"){v.contentType="message"}var x=a.clone(v),u=["url="+f.encodeUrl(r.getBaseUrl())],t=top.window.location,w=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")+(t.pathname?t.pathname:""),z=(v.origin||w)+"/#app:"+v.appId;delete x.url;delete x.appId;delete x.origin;for(var y in x){if(x.hasOwnProperty(y)&&x[y]){u.push(y+"="+x[y])}}z+=("/content:"+u.join("&"));return z},getMyCommunitiesAppUrl:function(t){t=t||{};t.appId=r.getMyCommunitiesAppKey();return r.get3DDTransientAppUrl(t)},getProfileAppUrl:function(t){t=t||{};t.appId=r.getProfileAppKey();return r.get3DDTransientAppUrl(t)},getLabelOfWidgetListPreference:function(y,v,w){var u=null,x=null,t=y.getPreference(v);if(t&&t.options){u=t.options.filter(function(z){if(z.value===(w||t.value)){return true}else{return false}});if(u&&(u.length>0)){x=u[0].label}}else{if(t&&t.label){x=t.label}}return x},getTenantIdFromUrlPreference:function(w){var u=w&&w.getPreference("url"),v=null,t=null;if(u&&u.options){v=u.options.filter(function(x){return(x.value===u.value)});t=v[0].id}else{t=u?u.id:""}return t},setWidgetListPreferenceWithId:function(w,v,y){var u=null,x=null,t=w.getPreference(v);if(t&&t.options){u=t.options.filter(function(z){if(z.id===y){return true}else{return false}});if(u&&(u.length>0)){x=u[0].value;w.setValue(v,x)}}return x},initBaseUrl:function(v){var t=null,u=null,w=null;if(window.widget&&widget.getValue("v2BaseUrl")){p=widget.getValue("v2BaseUrl");console.info("v2BaseUrl used /!\\:",p)}else{t=f.getQueryString(window.location.href,"v2BaseUrl");if(t){p=t;console.info("v2BaseUrl used /!\\:",p)}else{if(v){p=v}else{u=window.location;w=u.pathname;p=u.protocol+"//"+u.host;if(w!=="/"){p+=w}}}}if(p.endsWith("/")){p=p.substring(0,p.length-1)}},getBaseUrl:function(){return p},getCsrfToken:function(w,v,t){var u="x-ds-swym-csrftoken";if(window.ds&&(window.ds.env==="MOBILE")){return v["x-ds-swym-csrftoken"]}else{return w.getResponseHeader(t||u)}},get3DDriveURL:function(v,u,t){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(w,x){w.getServiceUrl({serviceName:"3DDrive",platformId:v,onComplete:function(y){u(y)},onFailure:t})})},get3DDriveCSRFToken:function(w,v,t){var u=this;u.get3DDriveURL(w,function(x){b.authenticatedRequest(x+"/resources/3ddrive/v1/bos/DSROOT?tenant="+w,{method:"GET",type:"json",headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8"},onComplete:function(y,A,z){v(r.getCsrfToken(z,A,"X-DS-CSRFTOKEN"))},onFailure:t})})},get3DPassportCSRFToken:function(v,t){var u=this,w=c.getApplicationConfiguration("app.urls.passport");b.authenticatedRequest(w+"/api/authenticated/user/fields",{method:"GET",timeout:60000,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(x,z,y){v(r.getCsrfToken(y,z,"X-DS-IAM-CSRFTOKEN"))},onFailure:t})},isUsersGroupFeatureAvailable:function(t){if(this.isFeatureActivated("activateUsersGroup")===false){return t(false)}require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(u,v){u.getServiceUrl({serviceName:"usersgroup",platformId:v.getInstance().get("config").tenant.online_instance_id,onComplete:function(w){t((typeof(w)==="string")&&(w!==""))},onFailure:function(){t(false)}})})},_setFeaturesActivated:function(w,z){var x=Object.keys(q),u,y={};for(var v=0,t=x.length;v<t;v++){u=x[v];if(typeof w.getApplicationConfiguration("app.swymfeature."+u)!=="undefined"){y[u]=w.getApplicationConfiguration("app.swymfeature."+u)==="enabled"}else{y[u]=q[u]}}q=y;if(y.activateUsersGroup===true){this.isUsersGroupFeatureAvailable(function(A){q.activateUsersGroup=A})}if(z){z()}},initFeaturesActivated:function(t){if(window.ds&&window.ds.env==="3DD"){window.top.require(["DS/UWPClientCode/PublicAPI"],function(u){this._setFeaturesActivated(u,t)}.bind(this))}else{this._setFeaturesActivated(h,t)}},isFeatureActivated:function(t){return q[t]},getDelayedSyncTask:function(v,u,t){if(typeof v==="function"){return(function(){var y=null,B=null,A=false,D=true,C=u||30,z=t?a.extend({},t):{},x=function(){while(D===true){D=false;v.apply(B,y)}if(typeof(z.after)==="function"){z.after.apply(B,y)}A=false},w=function(){D=true;B=this;y=arguments;if(A===false){A=true;if(typeof(z.before)==="function"){z.before.apply(B,y)}setTimeout(x,C)}};return w})()}else{throw new Error("Invalid parameter")}},isCORSActivated:function(){var u="DS/PlatformAPI/PlatformAPI",t="com.3ds.wp.passport.cors",v=!(l(u)&&"disabled"===String(require(u).getApplicationConfiguration(t)));return v},getClientInformation:function(){var u=f.Client,t=u.Platform,v=u.Engine;return{isIpad:(t.ipad===true),isIphone:(v.name==="safari")&&t.ios&&(t.ipad===false),isIos:(v.name==="safari")&&t.ios,isSafari:(v.name==="safari")}},getContainedMediaIds:function(t){var v=/<img\s[^>]*data-media-id="([A-Za-z0-9-_]*)"\s[^>]*>/g;var u=g(t,v,1);return u},hasMediaBeenDeleted:function(x,v,w){var u,t=false;if(v){u=m.detect(v,function(y){return(y.media_id===x)});if(!u||(u.hasOwnProperty("width")&&(parseInt(u.width,10)<0))){if(r.getContainedMediaIds((typeof w==="string")?w:w.outerHTML).indexOf(x)>=0){t=true}}}return t},isCloud:function(){return c.getApplicationConfiguration("app.build.isCloud")==="true"},extractDataFromSubject6wURI:function(v,w){var z,x,y=null,t=v.split(":"),u=t[3];if(u){z=t[4]}else{u=t[0];z=t[1]}switch(u){case"idea":case"ideation":u="idea";x="Idea";break;case"people":case"iam":u="user";y="/feature/core/";case"media":case"survey":case"community":x=u.ucfirst();break;case"communitypost":case"post":u="post";x="Posts";break;case"qnaquestion":case"question":u="iquestion";x="iQuestion";break;case"wikitree":case"wiki":u="wiki";x="Wikitree";break;case"dm":u="dm";x="Conversation";default:x=u=null;break}return{tenantId:t[2],modelName:u,extraAttrs:((u==="user")?{login:z}:{mid:z}),exaleadType:x,modelAMDModuleRoot:y}},compareObjects:function(v,u){var t;if(typeof v!=="object"||typeof u!=="object"){return false}for(t in v){if(v.hasOwnProperty(t)&&u.hasOwnProperty(t)){if(v[t]&&u[t]&&typeof v[t]==="object"&&typeof u[t]==="object"){return this.compareObjects(v[t],u[t])}else{if(v[t]!==u[t]){return false}}}else{return false}}return true},cloneNode:function(w,t){var x=w.cloneNode(t?t:true),u,v;for(u in w._events){if(w._events.hasOwnProperty(u)){w._events[u].dispatcher.bindings.forEach(function(y){if(y.delegates.length>0){x=a.extendElement(x);x.addEvent(u+" "+y.delegates[0],y.listener)}else{x.addEventListener(u,y.listener)}})}}return x},getContextFromRoute:function(u){var t=[],v=u||"";if(a.is(u,"string")){t=u.match(o);if(t){v=u.replace(o,"");if(v.endsWith(k)){v=v.slice(0,v.length-1)}}else{t=[]}}return v},prettySize:function(w){w=parseInt(w,10);if(a.is(w,"number")){var u=w;var v=0;var t=[];t[0]="b";t[1]="Kb";t[2]="Mb";t[3]="Gb";t[4]="Tb";t[5]="Pb";t[6]="Eb";t[7]="Zb";t[7]="Yb";while(u>1){w=u;u=u/1024;v++}if(w!==u){v=v-1}return Math.round(w)+" "+t[v]}else{return""}},getNbLayoutColumns:function(){var u=document.querySelector(".app-content"),t=u&&u.getBoundingClientRect();if(t&&t.width){if(t.width<800){return 1}else{if(t.width<1140){return 2}}}return 3}};return r});define("DS/SwymUICore/script/feature/core/6wtag/model/6wtag-model",["UWA/Core","UWA/Class/Model","DS/WebappsUtils/Console"],function(d,c,b){var a=c.extend({});return a});define("DS/SwymUICore/script/feature/community/member/collection/member-collection-v2",["DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection"],function(b){var a=b.extend({_collectionName:"member-collection-v2",_actionsCollectionClass:null,_addActionsOnModel:false,init:function(d,c){if(c){if(c.hasOwnProperty("actionsCollectionClass")){this._actionsCollectionClass=c.actionsCollectionClass}if(c.hasOwnProperty("addActionsOnModel")){this._addActionsOnModel=c.addActionsOnModel}}return this._parent.apply(this,arguments)},onAdd:function(c,d){if(this._addActionsOnModel&&(d===this)&&c){c.setActionsCollectionClass(this._actionsCollectionClass);c.addActions()}return this._parent.apply(this,arguments)},onReset:function(d){var c=this;if(this._addActionsOnModel&&(d===this)){d.forEach(function(e){e.setActionsCollectionClass(c._actionsCollectionClass);e.addActions()})}return this._parent.apply(this,arguments)}});return a});define("DS/SwymUICore/script/feature/core/mobile/communication-manager",["UWA/Class","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(c,i,f){var h=window.ds&&(window.ds.env==="MOBILE"),e="wap.mobile.swym",j="notificationReceived",d="onAppForeground",b=[j,d],g=false,a=c.singleton({_subscriptionTopics:b,_subscriptionListeners:{},setup:function(){var k=this;this._subscriptionTopics.forEach(function(l){k._subscriptionListeners[l]=[]});this._subscribeToTopic()},_subscribeToTopic:function(){i.subscribe(e,function(m){var l;if(m&&m.action&&this._subscriptionListeners[m.action]){l=this._subscriptionListeners[m.action];for(var k=0;k<l.length;k++){l[k](m.data)}}}.bind(this))},listenToNotification:function(k){this._subscriptionListeners&&this._subscriptionListeners[j]&&this._subscriptionListeners[j].push(k)},listenToOnAppForeground:function(k){this._subscriptionListeners&&this._subscriptionListeners[d]&&this._subscriptionListeners[d].push(k)},stopListeningToOnAppForeground:function(m){var l=this._subscriptionListeners&&this._subscriptionListeners[d],k=l&&l.indexOf(m);l&&(k>=0)&&l.splice(k,1)},_publishToTopic:function(k){f.log("Publishing to topic",k);i.publish(e,k)},sendOpenMediaRequest:function(k){var l="openMedia";this._publishToTopic({action:l,data:k})},sendOpenAppRequest:function(k){var l="openApp";this._publishToTopic({action:l,data:k})}});a.NOTIFICATION_RECEIVED=j;if(h&&!g){a.setup();g=true}return a});define("DS/SwymUICore/script/feature/core/error/error",["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/error"],function(a,c){var b={displayError:function(d){if(d&&(d.length>0)&&c.hasOwnProperty(d)){a.info(c[d])}else{a.info(c.Anerrorhasoccured)}}};return b});define("DS/SwymUICore/script/lib/model/generic/subscribable",[],function(){var a={_subjectURI:null,_subServiceUrl:null,_services:{hasCurrentUserSubscribed:{method:"GET",parse:function(){return{}}},subscribe:{method:"POST"},unsubscribe:{method:"DELETE"}},getSubjectURI:function(){throw new Error("This function must be implemented!")},_buildUrl:function(b){this._subServiceUrl="api/user/subscriptions/"+b},hasCurrentUserSubscribed:function(b){var c=this;this._buildUrl(this.getSubjectURI());this.action("hasCurrentUserSubscribed",{url:this._subServiceUrl,onComplete:function(d,e){c.setCustomProperty("currentUserSubscribed",e.result!=null);b.onComplete(c.getCustomProperty("currentUserSubscribed"))},onFailure:function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/subscribable"],function(d,e){d.error(e.ServiceNotAvailable)});b.onFailure(c.getCustomProperty("currentUserSubscribed"))}})},subscribe:function(){var b=this;this._buildUrl(this.getSubjectURI());this.action("subscribe",{url:this._subServiceUrl,onComplete:function(){b.setCustomProperty("currentUserSubscribed",true)},onFailure:function(){b.setCustomProperty("currentUserSubscribed",false)}})},unsubscribe:function(b){var c=this;this._buildUrl(this.getSubjectURI());this.action("unsubscribe",{url:this._subServiceUrl,onComplete:function(){c.setCustomProperty("currentUserSubscribed",false)},onFailure:function(){c.setCustomProperty("currentUserSubscribed",true)}})}};return a});define("DS/SwymUICore/script/lib/6wpanel/6wtaggable",["UWA/Core","UWA/Class","DS/WebappsUtils/Console"],function(d,c,b){var a=c.extend({is6wTaggable:true,resetTaggingSession:function(){},_recomputeTags:function(){},getTags:function(){},onTagCreation:function(f,e){},onTagDeletion:function(f,e){},getSixwURIs:function(){}});return a});define("DS/SwymUICore/script/utils/date",["DS/UWPClientCode/I18n","UWA/Core","i18n!DS/SwymUICore/assets/nls/utils/date"],function(c,e,d){var f=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.(\d{3})Z/;function b(){var g;try{g=window.dsLang||window.top.dsLang}catch(h){g=c.getCurrentLanguage()}return g}var a={simpleDate:function(h,j){var g;if(!e.is(h,"number")){if(!(e.is(h,"string")&&h.endsWith("Z"))){g=new Date(this.getDateInMilliSec(h));g=new Date(g.getTime()-new Date().getTimezoneOffset()*60000)}else{g=new Date(h)}}else{g=new Date(h+new Date().getTimezoneOffset()*60000)}var i=j?j:b();if(!i){i="en"}return g.toLocaleDateString(i,{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"-")+" "+g.toLocaleTimeString(i,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:false})},convertDate:function(g,h){return new Date(this.getDateInMilliSec(g)-new Date().getTimezoneOffset()*60000)},convertDateAndKeepSwymFormat:function(g){var h=this.convertDate(g).toISOString();return this.convertISODateIntoUsualDate(h)},simpleDay:function(h){var j=b(),g=new Date(h).toLocaleDateString(j,{day:"numeric",month:"long"}).replace(/\//g,"-");var i=new Date().toLocaleDateString(j,{day:"numeric",month:"long"}).replace(/\//g,"-");return(i===g)?d.Today:g},conciseDay:function(g){var l=new Date(g),h=l.toLocaleString("UTC",{year:"numeric"}),k=l.toLocaleString("UTC",{month:"2-digit"}),j=l.toLocaleString("UTC",{day:"2-digit"}),i=h+"-"+k+"-"+j;return i},prettyDay:function(h){var l=b(),k=new Date(h),m=k.getFullYear(),j=(new Date()).getFullYear(),g=(m===j)?{weekday:"long",month:"long",day:"numeric"}:{weekday:"long",year:"numeric",month:"long",day:"numeric"},i=k.toLocaleDateString(l,g);return i},prettyHour:function(h){var k=b(),j=new Date(h),g={hour:"numeric",minute:"numeric"},i=new Intl.DateTimeFormat(k,g).format(j);return i},simpleHour:function(h){var g=new Date(this.getDateInMilliSec(h)-new Date().getTimezoneOffset()*60000);return g.toLocaleTimeString(b(),{hour:"2-digit",minute:"2-digit"})},textDate:function(g){var h,j=new Array(12);j[0]=d.Jan;j[1]=d.Feb;j[2]=d.Mar;j[3]=d.Apr;j[4]=d.May;j[5]=d.Jun;j[6]=d.Jul;j[7]=d.Aug;j[8]=d.Sep;j[9]=d.Oct;j[10]=d.Nov;j[11]=d.Dec;if(typeof(g)!=="object"){if((String(g)).indexOf("-")>=0){h=g.replace(/-/gi,"/")}h=new Date((h||"").replace(/-/g,"/").replace(/[TZ]/g," "))}else{h=g}var i=h.getFullYear();i=i.toString();return[j[h.getMonth()]," ",i].join("")},convertISODateIntoUsualDate:function(g){if(typeof(g)==="string"&&g.match(/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/)){var h=new Date(new Date(g).getTime());if(h&&h.toISOString()){g=h.toISOString().split("T")[0]+" "+h.toISOString().split("T")[1].split(".")[0]}}return g},prettyDate:function(k){if(k){if(typeof(k)==="string"&&k.match(/(\/|&#x2F;)/g)){k=k.replace("-"," ").replace(/(\/|&#x2F;)/g,"-")}if(typeof(k)==="string"&&k.match(/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/)){var i=new Date(new Date(k).getTime());if(i&&i.toISOString()){k=i.toISOString().split("T")[0]+" "+i.toISOString().split("T")[1].split(".")[0]}}var g=this.getDateInMilliSec(k+":00");var h=new Date(new Date().valueOf()+new Date().getTimezoneOffset()*60000);var o=(g>h);var p=((h.getTime()-g)/1000),j;if(o){p=-p}j=Math.floor(p/86400);if(isNaN(j)||j<0){return d.justnow}if(j>=31){var q=new Date(g);var n=q.getDate();var l=(q.getMonth()+1);var m=q.getFullYear();n=n<10?"0"+n:n;l=l<10?"0"+l:l;return[m,"-",l,"-",n].join("")}if(!o){return j===0&&(p<60&&d.justnow||p<120&&d.oneminago||p<3600&&c.replace(d.minutesCountminsago,{minutesCount:Math.floor(p/60)})||p<7200&&d.onehrago||p<86400&&Math.floor(p/3600)===1&&d.onehrago||p<86400&&c.replace(d.hoursCounthrsago,{hoursCount:Math.floor(p/3600)}))||j==1&&d.yesterday||j<7&&c.replace(d.daysCountdaysago,{daysCount:j})||j<31&&Math.ceil(j/7)==1&&c.replace(d.weekCountweekago,{weeksCount:Math.ceil(j/7)})||j<31&&Math.ceil(j/7)>1&&c.replace(d.weeksCountweekago,{weeksCount:Math.ceil(j/7)})}else{if(j===0){if(p<60){return d.justnow}if(p<120){return d.in1min}if(p<3600){return c.replace(d.inminutesCountmins,{minutesCount:Math.floor(p/60)})}if(p<86400){return c.replace(d.inhoursCounthrs,{hoursCount:Math.floor(p/3600)})}}if(j==1){return d.tomorrow}if(j<7){return c.replace(d.daysCountdays,{daysCount:j})}if(j<31){if(Math.ceil(j/7)==1){return c.replace(d.weeksCountweek,{weeksCount:Math.ceil(j/7)})}if(Math.ceil(j/7)>1){return c.replace(d.weeksCountweeks,{weeksCount:Math.ceil(j/7)})}}}}else{return d.justnow}},getCurrentDate:function(){var g=new Date(new Date().valueOf()+new Date().getTimezoneOffset()*60000);g=[g.getFullYear(),((g.getMonth()+1)<10?("0"+(g.getMonth()+1)):(g.getMonth()+1)),(g.getDate()<10?"0"+g.getDate():g.getDate())].join("-")+" "+[(g.getHours()<10?"0"+g.getHours():g.getHours()),(g.getMinutes()<10?"0"+g.getMinutes():g.getMinutes()),(g.getSeconds()<10?"0"+g.getSeconds():g.getSeconds())].join(":");return g},getDateInMilliSec:function(l){var i,m=0;if(!l){return null}if(typeof(l)==="string"&&l.match(/(\/|&#x2F;)/g)){l=l.replace("-"," ").replace(/(\/|&#x2F;)/g,"-")}i=l.match(f);if(i){l=l.replace("T"," ").replace(/.\d{3}Z$/,"");m=parseInt(i[i.length-1],10)}if(l.substring(4,5)!="-"||l.substring(7,8)!="-"||l.substring(10,11)!=" "||l.substring(13,14)!=":"||l.substring(16,17)!=":"){return null}var k=l.split(" ");var j=k[0].split("-");var g=k[1].split(":");var h=new Date();h.setFullYear(j[0]);h.setMonth(j[1]-1);h.setDate(j[2]);h.setHours(g[0]);h.setMinutes(g[1]);h.setSeconds(g[2]);h.setMilliseconds(m);return h.getTime()},getAverageElapsedTime:function(o){var k="-";if(o>0){var h=parseInt(Math.round(o/(365.25*86400)),10);var g=parseInt(Math.round(o/(30*86400)-h*12),10);var m=parseInt(Math.round(o/(7*86400)-g*4),10);var l=parseInt(Math.round(o/86400-m*7),10);var n=parseInt(Math.round(((o)/3600)-l*24),10);var i=parseInt(Math.round(((o)/60)-n*60),10);var j=parseInt(Math.round(o-i*60),10);if(h<1){if(g<1){if(m<1){if(l<1){if(n<1){if(i<1){if(j<1){k="-"}else{k=j+" "+((j>1)?d.seconds:d.second)}}else{if(j>30){i++}k=i+" "+((i>1)?d.minutes:d.minute)}}else{if(i>30){n++}k=n+" "+((n>1)?d.hours:d.hour)}}else{if(n>12){l++}k=l+" "+((l>1)?d.days:d.day)}}else{if(l>3){m++}k=m+" "+((m>1)?d.weeks:d.week)}}else{if(m>2){g++}k=g+" "+((g>1)?d.months:d.month)}}else{if(g>6){h++}k=h+" "+((h>1)?d.years:d.year)}}return k}};return a});define("DS/SwymUICore/script/feature/core/mobile/app-foreground-subscriber-mixin",["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(a){return{init:function(){if(this.onAppBroughtToForeground){this.onAppBroughtToForegroundBound=this.onAppBroughtToForeground.bind(this);a.listenToOnAppForeground(this.onAppBroughtToForegroundBound)}return this._previous.apply(this,arguments)},destroy:function(){if(this.onAppBroughtToForegroundBound){a.stopListeningToOnAppForeground(this.onAppBroughtToForegroundBound)}return this._previous.apply(this,arguments)}}});define("DS/SwymUICore/script/feature/community/media/editor/collection/operation-collection",["UWA/Core","UWA/Class/Collection","DS/SwymUICore/script/feature/community/media/editor/model/operation-model","DS/WebappsUtils/Console"],function(e,d,c,b){var a=d.extend({model:c,resetCollection:function(g){if(g===0){g++}var f=this.slice(0,g);this.reset(f)},getOperationsAfterBrightness:function(g){var f=this.slice(g,this.length);this.remove(f);return f}});return a});define("DS/SwymUICore/script/lib/6wpanel/utils",["UWA/Core","UWA/String","DS/Logger/Logger","DS/SwymUICore/script/utils/date"],function(i,c,a,h){var j="xsd:",f=/^xsd:/,b="ds6w",n="ds6w:what",k="&#47;";function e(s,o,y,p){var q,r,t,x,w,u,v;p=(p==="array")?"array":"object";if(s){if(p==="array"){y=y||[]}else{y=y||{};y[s]=y[s]||[]}for(q=0,r=o.length;q<r;q++){u=o[q];if(u.predicate){w=u.predicate}else{w=n}t=typeof(u.type)==="string"?u.type.replace(f,""):null;if(t==="date"){x=new Date(h.getDateInMilliSec(u.tag));x=[x.getFullYear(),x.getMonth()+1,x.getDate()].join("/");t="string"}else{if(Array.isArray(u.tag)){x=u.tag}else{x=String(u.tag).split("/")}x.forEach(function(A,z){x[z]=A.replace(/&#47;/g,"/")});if(x.length===1){x=x[0]}}if(x.length!==0){v={object:x,sixw:w,type:t,subjectURI:s};if(p==="array"){y.push(v)}else{y[s].push(v)}}}}return y}function m(o){return o.replace(/:/g,"_58_").replace(/\//g,"_47_")}function l(x){var u,t,p,q,r,o,y,v="",w=undefined,s=[];if(x){for(w in x){if(x.hasOwnProperty(w)){r=x[w].length;for(q=0;q<r;q++){o=x[w][q];t=o.type;p=o.object;u=j+t;if(t!=="date"){if(Array.isArray(p)){p.forEach(function(A,z){p[z]=A.replace(/\//g,k)});p=p.join("/")}else{p=p.replace(/\//g,k)}}else{if((w.indexOf("sixw:ds6w:when/")===0)&&i.typeOf(p)==="object"){if(p.from){v+=(v!==""?" AND ":"")+"("+m(w.replace("sixw:ds6w:when/",""))+">="+p.from+")"}if(p.to){v+=(v!==""?" AND ":"")+"("+m(w.replace("sixw:ds6w:when/",""))+"<="+p.to+")"}continue}}s.push("f/"+b+m("/"+w)+"/"+u+"/"+p)}}}}y={queryPart:v,refineParam:s};return y}function g(x,s,A,p){var y,z,t,v,w,o,u,B,r,q=s.categories;if(q&&q.length>0){for(t=0,v=q.length;t<v;t++){x=g(x,q[t],A,p)}}else{r=[];B=s.fullPath.split("/");w=-1;for(t=2,v=B.length;t<v;t++){u=B[t];switch(u){case"implicit":case"explicit":w=t;break;default:r.push(u);break}if(w>0){break}}z=r.join("/");y=B[w+1];if(p>w+1){o=s.fullPath.replace(A+"/","").split("/")}else{o=B.splice(w+2)}if(typeof(y)==="string"){y=y.replace(f,"");if(y==="date"){o=o.join("/")}else{o.forEach(function(D,C){o[C]=D.replace(/&#47;/g,"/")});if(o.length===1){o=o[0]}}}x.push({sixw:z,object:o,type:y,count:parseInt(s.count,10)})}return x}var d={reformatFilters:function(p){var r,q=undefined,o=true;if(i.is(p,"object")&&i.is(p.allfilters,"object")){for(q in p.allfilters){if(p.allfilters.hasOwnProperty(q)){o=false;break}}}else{o=true}if(o===false){r=l(p.allfilters)}else{r={queryPart:"",refineParam:[]}}return r},extractTagsFromExaleadResponse:function(s){var t,r,p,q,o;if(s&&typeof s.groups!=="undefined"){q=[];o=s.groups;for(t=0,r=o.length;t<r;t++){p=o[t];if(p.id.substring(0,4)===b){q=g(q,p,p.root,p.root.split("/").length)}}return q}else{a.error("Invalid arguments")}return[]},extractTagsFromExaleadSingleResult:function(o){return this.extractTagsFromExaleadResponse(o)},getExaleadFiltersFromTagger:function(o){if(o&&typeof o.getFilters==="function"){return l(o.getFilters())}else{throw new Error("Invalid arguments")}return[]},processTagAttribute:e,requestLegacyFormatForExaleadSearches:function(){return false},parseSearchResult:function(r){var v,t,p,s,o,u,x,w,y=[],q=r.hits;if(Array.isArray(q)){for(v=0,p=q.length;v<p;v++){o=q[v];w=o.metas,u={source:o.source};for(t=0,s=w.length;t<s;t++){x=w[t];u[x.name]=x.value}y.push(u)}}return y},get6WTagsFromHTML:function(r){var q,s,p,o={};switch(i.typeOf(r)){case"string":r=i.createElement("div",{html:r});break;case"element":i.extendElement(r);break;case false:default:throw new Error("The HTML content is invalid!")}r.getElements("a.s6m-tag-link[data-predicate]").forEach(function(t){q=t.dataset.predicate;s=t.getText();p=q+"/"+s;o[p]={predicate:q,object:s}});return o},getTagNavigatorFiltersForModel:function(o,r){var q=null,p={};switch(o){case"post":case"idea":case"survey":q=[c.ucfirst(o)];break;case"iquestion":q=["Question"];break;case"media":q=["Picture","AnimatedPicture","Document","Sound","Video","3dModel","Drawing"];break;case"wiki":q=["WikitreePage"];break;default:return result}p["ds6w:what/"+(r===true?"swym:eventSubjectType":"ds6w:type")]=q.map(function(s){return{object:"swym:"+s,type:"string",disptext:s}});return p},getTagFilterForMedia:function(o){return"f/ds6w_47_ds6w_58_what_47_ds6w_58_type/xsd:string/swym:"+o}};return d});define("DS/SwymUICore/script/lib/event-manager",["UWA/Core","UWA/Class","DS/SwymUICore/script/lib/pub-sub"],function(c,b,a){return a.singleton({eventsWhitelist:["requestContentListUpdate","onBeforeCKEditorLoad","onAfterCKEditorLoad","onTaggerFilteringRequest","onSidePanelExpand","onSidePanelCollapse","onCommunityMembersUpdate","onCreateProxyManager","onThreadUnreadStatusChange","onAccordionClick","onEventReply"],isEventWhitelisted:function(d){if(this.eventsWhitelist.indexOf(d)<0){throw new Error("The event "+d+" is not supported by this event manager. Please add it to the events whitelist.")}else{return true}},_addEvent:function(d){if(this.isEventWhitelisted(d)){return this._parent.apply(this,arguments)}},dispatchEvent:function(d){if(this.isEventWhitelisted(d)){return this._parent.apply(this,arguments)}}})});define("DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager",["UWA/Promise","DS/SwymUICore/script/lib/pub-sub"],function(b,a){var c=a.extend({_collection:null,_modelClass:null,getFavorites:function(f,d){var e=this;return new b(function(h,g){if(!f||!d){if(e._collection){h(e._collection)}else{e.addEventOnce("onCollectionFetched",function(){h(e._collection)})}}else{e._collection.fetch({data:{page:f,limit:d},onComplete:function(i){e.dispatchEvent("onCollectionFetched");h(i)},onFailure:function(){g(false)}})}})},onRemove:function(f,e){var d=this;return new b(function(h,g){new d._modelClass({mid:f,external_id:f}).remove({data:{mid:f,external_id:f},onComplete:function(i){console.log(i);d._collection.remove(i.get("id"));d.dispatchEvent("onFavoriteRemoved",f);!e&&d.dispatchEvent("onFavoriteRemovedExternalView",f);h(i)},onFailure:function(){g(false)}})})},onChange:function(h,d,f,g){var e=this;return new b(function(j,i){new e._modelClass({mid:h}).save({external_id:h,position:d>=0?d+1:null,title:f?f:""},{onComplete:function(k){e._collection.add(k);e.dispatchEvent("onFavoriteAdded",h);!g&&e.dispatchEvent("onFavoriteAddedExternalView",h);j(k)},onFailure:function(){i(false)}})})},isFavorite:function(d){},isFavoriteSync:function(d){if(this._collection.findWhere({mid:d})){return true}return false}});return c});define("DS/SwymUICore/script/lib/request/lost-session-manager",["UWA/Class","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/utils/utils","UWA/Class/Promise","DS/WAFData/WAFData","DS/WebappsUtils/Console"],function(b,a,h,i,j,c){var l,f,e,g="access_token",k="x3ds_service_url";require(["DS/SwymUICore/script/lib/request/data"],function(m){l=m});require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(m){f=m});var d=b.singleton({_sessionReestablishmentSequenceOngoing:false,_pendingCalls:[],_fetchServiceTicket:function(){var n=a.getApplicationConfiguration("app.urls.passport")+"/login?service="+h.getBaseUrl()+"/api/index/tk&gateway=true",m=i.deferred();j.authenticatedRequest(n,{onComplete:function(p){var q=JSON.parse(p);if(q&&q[g]&&q[k]){m.resolve(q[g])}else{c.error("Passport error, no service ticket fetched",arguments)}}});return m.promise},_authAndFetchToken:function(n){var o=i.deferred(),p=f.getInstance(),m=p.get("config").tenant.online_instance_id;j.authenticatedRequest(h.getBaseUrl()+"/api/index/tk?ticket="+n,{onComplete:function(q){var r=JSON.parse(q);if(r&&r.result&&r.result.ServerToken){p.setCSRFToken(r.result.ServerToken,m);o.resolve()}else{c.error("Passport error, no service ticket fetched",arguments)}}});return o.promise},_reestablishSession:function(){var m=i.deferred(),n=this;this._sessionReestablishmentSequenceOngoing=true;this._fetchServiceTicket().then(this._authAndFetchToken,c.error).then(function(){n._sessionReestablishmentSequenceOngoing=false;m.resolve()});return m.promise},_reExecuteCalls:function(){var m;while(this._pendingCalls.length>0){m=this._pendingCalls.shift();l.request(m)}},reExecuteCall:function(m){if(!this._sessionReestablishmentSequenceOngoing){i.resolve().then(this._reestablishSession.bind(this),c.error).then(this._reExecuteCalls.bind(this),c.error)}this._pendingCalls.push(m)}});return{getInstance:function(){if(!e){e=d.init()}return e}}});define("DS/SwymUICore/script/lib/request/data",["UWA/Core","UWA/Class/Events","UWA/Json","UWA/Utils","UWA/Data","DS/WAFData/WAFData","DS/SwymUICore/script/utils/utils","DS/UWPClientCode/PublicAPI","UWA/Class/Promise","DS/SwymUICore/script/lib/request/lost-session-manager","DS/WebappsUtils/Console","i18n!DS/SwymUICore/assets/nls/utils/error"],function(a,r,c,l,w,b,d,p,e,h,x,o){var i,g=null;require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(z){g=z});var s=function(z){var A=z||{};if(!A.variableName){throw new Error("Variable name is missing")}if(!A.callback){throw new Error("Callback is missing")}if(!p.getApplicationConfiguration(A.variableName)){if(a.is(A.retries,"number")){A.retries=A.retries-1}else{A.retries=0}if(A.retries>=0){setTimeout(function(){s.call(this,A)}.bind(this),A.delay||200)}}else{z.callback()}};var n=function(z){m(z);j(z)};var j=function(z){if(z&&z.new_cas_session){x.log("SEND CAS SESSION REFRESH");x.error("CASSessionRefresh event fired, to be migrated!!!!!!")}else{if(!z){x.error("handleNewCASSession : bad data ")}}};var m=function(z){if(z&&z.logout){s({variableName:"app.urls.passport",callback:function(){var A=p.getApplicationConfiguration("app.urls.passport")+"/cas/logout";if(A!==""){x.log("RECEIVED LOGOUT NOTIFICATION "+A);window.location=A}else{x.log("no passport logout url")}},retries:3})}};var y=function(z){if(z.url.contains("api/index/options")){s({variableName:"app.urls.passport",callback:function(){var A=p.getApplicationConfiguration("app.urls.passport")+"/login?service="+d.getBaseUrl()+"/api/index/options&gateway=true";t(A,{onComplete:function(B){var C=JSON.parse(B);var D=C.access_token;g.getInstance().initialize(D)},onFailure:function(){x.error("Error while fetching a ticket for the index/options call",arguments)}})},retries:3})}else{h.getInstance().reExecuteCall(z)}};var f=function(){var C,A,B=window.location.host.split("-")[0].toUpperCase(),z=l.base64Encode(window.location).replace(/\+/g,"-").replace(/\//g,"-").replace(/=+$/,"");require(["DS/PlatformAPI/PlatformAPI"],function(D){C=D.getApplicationConfiguration("app.urls.myapps");A=C+"/resources/AppsMngtSynchro/api/v1/?service=3DSwym&url="+z+"&platform="+B;x.log("handleInactiveUser, redirectUrl:"+A);window.location=A})};var v=function(B,E,D,A){var z;if(B&&typeof(B.message)==="string"){z=B.message.replace(/.*(\d{3}).*/g,"$1")}z=parseInt(z,10);switch(z){case 403:var C=["ERROR_ACCESS_FORBIDDEN_LICENSE_EXPIRED","ERROR_ACCESS_FORBIDDEN_LICENSE_FULLY_CONSUMED","ERROR_LICENSING_EXTENSION_KO","ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE","ERROR_ACCESS_FORBIDDEN_CSRF_KO","ERROR_ACCESS_NO_LICENSE"];if(E&&E.errorcode&&C.indexOf(E.errorcode)>-1){if(E.errorcode==="ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE"){f()}else{if(E.errorcode==="ERROR_ACCESS_FORBIDDEN_CSRF_KO"){h.getInstance().reExecuteCall(A)}else{require(["DS/SwymUICore/script/feature/core/error/view/error-view"],function(G){var F=new G({error:E,errorCode:z});a.extendElement(document.body).empty();F.inject(document.body)})}}}else{q(this,E,D,A,z)}return false;break;case 404:if(window.ds&&(window.ds.env==="3DSwym"||window.ds.env==="catia")){x.error("404 error",arguments);if(A.onFailure){A.onFailure(E)}}else{if(window.ds&&window.ds.env==="3DD"){q(this,E,D,A,z)}}break;default:q(this,E,D,A,z);break}};var q=function(B,D,C,A,z){x.error("HTTP error",z);if(A.onFailure){A.onFailure.call(B,D,C,A)}};var u=function(F,E,z,A){try{if(F&&(F.errorcode||F.errorid)){k.call(this,new Error(F.errorcode||F.errorid),F,E,z)}else{n(F);if(z.onComplete){var D=function(G){g=G;C()},C=function(){z.onComplete.call(this,F,E,z,A)};if(g){D(g)}else{require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],D)}}}}catch(B){x.error("Exception caught",B)}};var k=function(A,C,B,z){n(C);v(A,C,B,z)};var t=function(z,A){if(A.proxifiedRequest===true){return b.proxifiedRequest(z,A)}return b.authenticatedRequest(z,A)};i=r.singleton({executeWhenPublicApiInfoIsAvailable:s,request:function(I){var D=false,A=I.url,E=this,F=d.getBaseUrl(),B=a.merge({onComplete:function(M,L,J){if(typeof(M)==="string"&&L&&L["Content-Type"]&&L["Content-Type"].contains("application/json")){try{M=c.decode(M)}catch(K){M={};x.warn("The result of the request is not in a JSON format")}}u.call(this,M,L,I,J)},onFailure:function(J,L,K){k.call(this,J,L,K,I)}},I);if(!A.contains("://")&&(A.indexOf(F)!==0)){A=F+((A[0]==="/")?"":"/")+A}a.merge(B,{headers:{},method:"POST",type:"json"});if(B.data&&(B.method.toLowerCase()==="get")){B.data=l.toQueryString(B.data)}else{if((B.dataType==="json")||(B.dataType===undefined)){if(B.data){if(B.wrapData!==false){B.data=c.encode({params:B.data})}else{B.data=c.encode(B.data)}}if(!B.headers["Content-Type"]){B.headers["Content-Type"]="application/json;charset=utf-8"}}}if(g){var C=g.getInstance();if(C&&C.getCSRFToken()&&(B.noCsrfToken!==true)){B.headers["X-DS-SWYM-CSRFTOKEN"]=C.getCSRFToken()}else{x.log("No token yet")}}else{x.log("No bootstrap yet")}if(window.ds&&window.ds.env==="3DSwym"){var z,G={cancel:function(){D=true;if(z&&z.cancel){z.cancel()}}},H=function(J){if(!D){if(B.bypassConfigLoadCheck===true||(B.noCsrfToken===true)){z=t(A,B);E.dispatchEvent("onRequest",[z.xhr])}else{J.getInstance().executeWhenReady(function(){if(!D){var K=this.getCSRFToken();if(K){B.headers["X-DS-SWYM-CSRFTOKEN"]=K}z=t(A,B);E.dispatchEvent("onRequest",[z.xhr])}})}}return z};if(g){H(g)}else{require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],H)}return z||G}return t(A,B)}}).init();return i});define("DS/SwymUICore/script/feature/core/config/bootstrap-model",["UWA/Core","UWA/Class/Events","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(h,a,d,e,b){var g=a.extend({loaded:false,envList:null,attributes:null,bootstrapConditions:null,init:function(){this.attributes={csrfTokens:{}};this.bootstrapConditions={};this._parent.apply(this,arguments)},initialize:function(o,k){b.log("init");var n=(k?k.baseUrl:null)||e.getBaseUrl(),j=n+(n.endsWith("/")?"":"/")+"api/index/options"+(o?("?ticket="+o):""),i=this.attributes,m=this,l=null,p={bypassConfigLoadCheck:true,method:"GET",type:"json",onComplete:function(s,t,q,r){if(!(s&&s.errorcode)){if(s&&s.result&&s.result.options){i=h.extend(i,s.result.options)}if(s&&s.result&&s.result.LicenseNearlyConsumed){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/feature/core/config/bootstrap-model"],function(u,v){u.warn(v.YourLicenseIsNearlyConsumed)})}l=e.getCsrfToken(r,t);if(l){i.csrfToken=l;if(i.config&&i.config.tenant&&i.config.tenant.online_instance_id){i.csrfTokens[i.config.tenant.online_instance_id]=l}}else{b.error("Missing mandatory csrf token!")}this.loaded=true;this.dispatchEvent("onSync",[this])}}.bind(this),onFailure:function(){if(!window.ds||window.ds.env!=="3DSwym"){this.dispatchEvent("onFailure")}}.bind(this),url:j};if((!window.ds||window.ds.env!=="3DSwym")||!this.loaded){d.request(p)}return this},get:function(i){return h.clone(this.attributes[i],false)||null},getAttributes:function(){return this.attributes},setAttributes:function(i){this.attributes=i},updateTenantAttributes:function(i){for(var j in i){if(i.hasOwnProperty(j)&&this.attributes.config&&this.attributes.config.tenant&&this.attributes.config.tenant.hasOwnProperty(j)){this.attributes.config.tenant[j]=i[j]}}},getCSRFToken:function(i){if(i){return this.attributes.csrfTokens[i]}return this.attributes.csrfToken},setCSRFToken:function(j,i){if(i){this.attributes.csrfTokens[i]=j}this.attributes.csrfToken=j},executeWhenReady:function(i){if(this.loaded===true){i.apply(this)}else{this.addEventOnce("onSync",i)}},fullfillBootstrapCondition:function(i){if(this.bootstrapConditions[i]!==true){this.bootstrapConditions[i]=true;this.dispatchEvent("_onConditionMet:"+i)}},isBootstrapConditionMet:function(i){return(this.bootstrapConditions[i]===true)},executeWhenBootstrapConditionIsMet:function(j,i){if(this.isBootstrapConditionMet(j)){i.apply(this)}else{this.addEventOnce("_onConditionMet:"+j,i)}},isFeatureActivated:function(i){if(this.attributes&&this.attributes["X-DS-SWYM-VERSION"]==="2"&&h.is(this.attributes[i])){return this.attributes[i]}return true},isRealtimeFeatureActivated:function(i){return(this.get("config").realtime[i]&&this.get("config").realtime[i].activate===true)},getBackendVersion:function(){if(this.attributes&&this.attributes["X-DS-SWYM-VERSION"]){return parseInt(this.attributes["X-DS-SWYM-VERSION"])}throw"No backend version returned by the service"},getStartupTenantsInfo:function(l,j,i){var k=this,m=k.envList;if(m){if(i&&typeof(i.callbackJustAfterCallHasBeenSent)==="function"){i.callbackJustAfterCallHasBeenSent()}if(l){l.call(this,m)}}else{this.executeWhenReady(function(){require(["DS/WAFData/WAFData","DS/UWPClientCode/PublicAPI"],function(o,n){d.executeWhenPublicApiInfoIsAvailable({variableName:"app.urls.myapps",callback:function(){var p=(n.getApplicationConfiguration("app.urls.myapps")+"/resources/AppsMngt/user/startup"+("?platform="+k.get("config").tenant.online_instance_id));o.authenticatedRequest(p,{method:"GET",type:"json",headers:{"Accept-Language":window.dsLang,Accept:"application/json","Content-Type":"application/json"},onComplete:function(q){var r=this;if(q&&q.logout!==true){m=k.envList=q;if(l){k.executeWhenReady(function(){l.call(r,m)})}}},onFailure:function(){if(j){j.apply(this,arguments)}}});if(i&&typeof(i.callbackJustAfterCallHasBeenSent)==="function"){i.callbackJustAfterCallHasBeenSent()}},retries:10,delay:200})})})}}});var c=g.singleton();var f=false;g.getInstance=function(){if(f===false){c.init();f=true}return c};return g});define("DS/SwymUICore/sharefromcatia-init",["UWA/Class/Promise","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(d,c){var b={};var a=function(){var e=d.deferred(),f=c.getInstance();f.initialize();f.addEventOnce("onSync",function(){e.resolve()});return e.promise};b.start=function(){var e=d.deferred();d.resolve().then(a).then(e.resolve);return e.promise};return b});define("DS/SwymUICore/script/feature/core/realtime/realtime-updates-manager",["DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/PlatformAPI/PlatformAPI","DS/WebappsUtils/Console"],function(n,g,i,b){var k,e="intf-ws-topic",a="ready",f="pushto3dnotification",j="Create",h="Post",m="Ideation",l="Media",d="Question",c=n.singleton({tenantOID:null,setup:function(){var o=g.getInstance();this.tenantOID=o&&o.get("config")&&o.get("config").tenant&&o.get("config").tenant.online_instance_id;k="tenant_"+this.tenantOID+"_new_message";if(c.topics){c.topics.REALTIME_NEW_CONTENT_UPDATE_TOPIC=k}this.setupSecurityTokenExchange();this.subscribeToRealtimeContentUpdates()},setupSecurityTokenExchange:function(){var o=this;i.publish(f,{method:"pushplatformid",data:{provider:"3dswym",data:o.tenantOID}});i.subscribe(e,function(p){b.log("instantMessagingData",p);if(p&&p.event===a){i.publish(f,{method:"pushplatformid",data:{provider:"3dswym",data:o.tenantOID}})}})},subscribeToRealtimeContentUpdates:function(){var o=this;i.subscribe(k,function(p){b.log("newContentUpdateData",p);if(p.message_type==="INTERNAL_CONTENT"){o.dispatchEvent("contentPublished",p)}})}});c.topics={GENERIC_NOTIF_TOPIC:e,PUSH_3DNOTIFICATION_TOPIC:f};return c});define("DS/SwymUICore/script/feature/community/member/model/mixin/community-member",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/user/collection/member-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(f,b,e){var c={contributor:"1",author:"2",owner:"3"};var a={contributor:"ds6w:role.swym_contributor",author:"ds6w:role.swym_author",owner:"ds6w:role.swym_owner",mainOwner:"ds6w:role.swym_mainowner"};var d={_associations:{community:{}},_actionsCollectionClass:null,actions:null,collection:null,setActionsCollectionClass:function(g){this._actionsCollectionClass=g},getCommunityRoleFromExaleadRole:function(g){switch(g){case a.contributor:return c.contributor;case a.author:return c.author;case a.mainOwner:case a.owner:return c.owner;default:break}return""},getInlineActionsUpdate:function(j,h){var i=null,g=this._actionsCollectionClass;switch(j){case"1":i=[{id:"author",title:b.Setasauthor,icon:"user"},{id:"owner",title:b.Setasowner,icon:"user"},{id:"delete",title:b.Delete,icon:"trash"}];break;case"2":i=[{id:"contributor",title:b.Setascontributor,icon:"user"},{id:"owner",title:b.Setasowner,icon:"user"},{id:"delete",title:b.Delete,icon:"trash"}];break;case"3":i=[{id:"contributor",title:b.Setascontributor,icon:"user"},{id:"author",title:b.Setasauthor,icon:"user"},{id:"delete",title:b.Delete,icon:"trash"}];break;default:Logger.log("Member's role is not defined");break}if(h!=="array"){i=new g(i)}return i},updateActions:function(g){var h;if(h=this.get("relation")||g){this.actions.reset(this.getInlineActionsUpdate(h,"array"))}},addActions:function(){if(this.collection){var i=this,k=this.collection,g,j,h=e.getInstance().get("user").hash_key;if(k&&(g=k.getAssociated("owned"))&&g.get("mid")){if(g.has("this")&&(parseInt(g.get("this").getCurrentUserRights,10)>=3)||this.collection.as_admin===true){j=g.getAssociated("owner").get("hash_key");if((i.get("hash_key")!==h)&&(i.get("hash_key")!==j)){if(i.actions){i.actions.reset(i.getInlineActionsUpdate(i.get("relation"),"array"))}else{i.actions=i.getInlineActionsUpdate(i.get("relation"))}}}}}}};return d});define("DS/SwymUICore/script/utils/localstorage-utils",["DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/Logger/Logger"],function(d,a){var c="3DSWYM",b="-";return{setItem:function(f,g){try{window.localStorage.setItem(f,JSON.stringify(g))}catch(h){console.error(h)}},getItem:function(e){return JSON.parse(window.localStorage.getItem(e))},removeItem:function(e){window.localStorage.removeItem(e)},setPrefixedItem:function(f,g,e){this.setItem(this.buildPrefixedKey(f,e),g)},getPrefixedItem:function(f,e){return this.getItem(this.buildPrefixedKey(f,e))},removePrefixedItem:function(f,e){this.removeItem(this.buildPrefixedKey(f,e))},buildPrefixedKey:function(g,f){var e,i=c,j=false,h=d.getInstance();if(f){if(f.tenant===true){if(h.get("config")&&h.get("config").hasOwnProperty("tenant")&&h.get("config").tenant.hasOwnProperty("id")){i+=b+h.get("config").tenant.id;j=true}}if(f.widget&&f.widget.id){i+=b+f.widget.id;j=true}if(j===true){e=i+b+g}else{a.error("Either the tenant or the widget should be specified in the options object")}}else{throw new Error("The options object is not defined")}return e}}});define("DS/SwymUICore/script/utils/usage-tracker",["UWA/Core","DS/Usage/TrackerAPI","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/Logger/Logger"],function(g,e,j,h,c){var d="swym",a=".",i={FavoriteCommunities:["createFavorite","reorderFavorite","deleteFavorite"],FavoriteConversations:["createFavorite","reorderFavorite","deleteFavorite"],ThreadTabs:["showCommunities","showConversations"],ThreadToolbar:["searchCommunity","searchConversation","filterActiveCommunities","filterActiveConversations","navigateToAllMyCommunities","createConversation"],ThreadPage:["openContextualMenu","clickItemInContextualMenu"],MyCommunities:["navigateToCommunity","navigateToActiveCommunity","navigateToActiveFavoriteCommunity","navigateToFavoriteCommunity","navigateToWhatsNew","loadNextCommunitiesPage"],MyConversations:["navigateToConversation","navigateToActiveFavoriteConversation","navigateToFavoriteConversation","navigateToActiveConversation","hideAConversation","loadNextConversationsPage"],SwitchWhatsNewTimeline:["switchToWhatsNew","switchToTimeline"],Communication:["startAudioCall","startVideoCall"],UnreadMessageAlert:["goToFirstUnreadMessage","closeFirstUnreadMessageAlert","FirstUnreadMessageDisplayed"],NewMessageAlert:["goToNewlyReceivedMessage","closeNewlyReceivedMessageAlert","NewlyReceivedMessageDisplayed"],SocialToolbar:["like","unlike","share","reply","comment"],ContentCreation:["cancelCreation","switchToAdvancedCreation","automaticSwitchToAdvancedCreation","saveAsDraft","publishContent","publishFailed","openMediaLibrary","uploadMedia","openParagraphFormatter","closeParagraphFormatter"],AutoSave:["contentSaved","contentDestroyed","contentRestored"],Bookmark:["createBookmark","deleteBookmark","navigateToBookmark","navigateToMyBookmarks"],NetworkActivity:["navigateToMyNetworkActivity"],Accordion:["open","close"],NavigationMenu:["navigateToWhatsNew","navigateToMyNetworkActivity","navigateToMyBookmarks","navigateToManagement"],PlusMenu:["addMessage","addPost","addMedia","addQuestion","addIdea","addWikiPage","addSurvey","createCommunity","createConversation"],DesktopNotification:["displayDesktopNotification","clickDesktopNotification"]},k=["drag","drop","play","hover","pause","click","input","scroll","cut","copy","paste","upload"];function n(p,o){if(i.hasOwnProperty(p)){if(i[p].indexOf(o)>=0){return true}else{c.error("Label: "+o+" does not exist for following category: "+p)}}else{c.error("Category: "+p+" is not declared as a tracker category")}return false}function m(o){if(k.indexOf(o)>=0){return true}else{if(o&&o!==""){c.error("Event: "+o+" is not a valid event for a tracker.")}}return false}function b(q){var o={},p=1;q.forEach(function(r){o["pd"+p]=r;p+=1});return o}function f(){return window.ds&&window.ds.env==="3DD"&&window.widget?widget.getAppName():"3DSwym"}var l={trackPageView:function(t,q){var o=h.getNbLayoutColumns(),r=null;if(o===1){r="1ColumnLayout"}else{r=o+"ColumnsLayout"}try{var p=j.getInstance();p.executeWhenReady(function(){e.trackPageView(t,q,b([p.get("config").tenant.id,f(),r]))})}catch(s){c.error("UsageTracker@trackPageView error: "+error)}},trackPageEvent:function(x){try{var q=x.hasOwnProperty("category")&&x.hasOwnProperty("label")&&n(x.category,x.label),p=q?d+a+x.category:null,u=q?x.label:null,o=x.hasOwnProperty("event")&&m(x.event)?x.event:"",v=x.hasOwnProperty("value")&&Number.isInteger(x.value)?x.value:1,s=x.hasOwnProperty("view")?{pd1:x.view}:{},w=j.getInstance(),r={};s=x.hasOwnProperty("contentType")?g.extend(s,{pd2:x.contentType}):s;w.executeWhenReady(function(){r.tenant=w.get("config").tenant.id;r.appID=f();p&&u&&e.trackPageEvent(p,o,u,v,s,r)})}catch(t){c.error("UsageTracker@trackPageEvent error: "+t)}}};return l});define("DS/SwymUICore/script/feature/core/stats-manager/stats-manager",["UWA/Core","DS/SwymUICore/script/lib/request/data","UWA/Json","UWA/Element","UWA/Class","UWA/Utils/Client","DS/WebappsUtils/Utils"],function(g,f,a,d,c,e,b){return c.singleton({defaultOptions:{serviceUrl:null,sessionUid:null,delay:60},_stats:[],setup:function(h){this.options=g.extend(this.defaultOptions,h);window.setInterval(this.save.bind(this,false),this.options.delay*1000);d.addEvent.call(window,"beforeunload",this.save.bind(this,true))},push:function(h){this._stats.push(g.clone(h))},save:function(j){var h=this.options,i=this._stats,k="application/json",m={"Content-Type":k,"X-DS-SWYM-CSRFTOKEN":h.csrfToken},l;if(i.length>0){l={session_uid:h.sessionUid,history:g.clone(this._stats)};i.length=0;if((j===true)&&g.is(window.fetch,"function")&&(!e.Engine.firefox||(window.ds&&ds.env==="3DSwym"))){window.fetch(h.serviceUrl,{method:"POST",cache:"no-cache",credentials:"include",headers:m,body:a.encode({params:l})})}else{f.request({url:h.serviceUrl,timeout:15000,method:"POST",async:!j,headers:m,data:l})}}}})});define("DS/SwymUICore/script/feature/core/command/commands-controller",["UWA/Core","UWA/Utils","UWA/Data","UWA/String","UWA/Promise","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","UWA/Class/Events"],function(e,c,k,a,f,h,j,i,d,l){var g=null,b=l.extend({_commandsConfInitialized:false,_commandsConf:{},_botsConf:[],_appsParameters:{},_swymServiceUrl:null,_nlsIsLoaded:false,_nlsArrayModule:[],_nls:[],_activate3DSwymBot:d.isFeatureActivated("activateSwymBot"),executeWhenNlsIsReady:function(m){if(this._nlsIsLoaded){m.apply(this)}else{this.addEventOnce("onNlsSync",m)}},_getPromiseRetrieveAllApps:function(){var m=[];return new f(function(o,n){j.getAppsInfo({onComplete:function(p){p.forEach(function(q){if(q.swymIntegration&&q.id!=="X3DMCTY_AP"||(q.id==="X3DMCTY_AP"&&this._activate3DSwymBot===true)){this._appsParameters[q.id]=q;m.push(this._getPromiseForAnApp(q))}}.bind(this));f.all(m).then(function(){this._initRetrieveNlsFiles();o()}.bind(this),n)}.bind(this),onFailure:n})}.bind(this))},_getPromiseGettingSwymURLService:function(){var m=i.getInstance();return new f(function(o,n){j.getServiceUrl({platformId:m.get("config").tenant.online_instance_id,serviceName:"3DSwym",onComplete:function(p){this._commandsConfInitialized=true;this._swymServiceUrl=p;o()}.bind(this),onFailure:function(){console.error("3DCompass call failed");n()}})}.bind(this))},_getPromiseForAnApp:function(n){var m;return new f(function(p,o){this._getServiceUrl(n.serviceId,function(q){k.request(q+"/"+n.swymIntegration,{type:"json",onFailure:function(){console.error("Failed retrieving swymIntegration conf for app app.id");p()},onComplete:function(r){if(r.nlsModulePath){this._nlsArrayModule.push({moduleName:r.nlsModulePath,appId:n.id})}this._botsConf.push({desc:r.desc,botUsername:r.botUsername.toLowerCase(),appName:n.title,appId:n.id,appIconURL:n.icon});m=r.commands;if(m){m.forEach(function(s){if(!this._commandsConf[s.name]){this._commandsConf[s.name]=[]}this._commandsConf[s.name].push({appId:n.id,botUsername:r.botUsername.toLowerCase(),serviceName:n.serviceId,desc:s.desc,appName:n.title,appIconURL:n.icon,uri:s.uri})}.bind(this))}else{console.error("no commands defined for app",n.id)}p()}.bind(this)})}.bind(this))}.bind(this))},_getCommands:function(m){if(this._commandsConfInitialized===true){m(this._commandsConf,this._botsConf)}else{f.all([this._getPromiseGettingSwymURLService(),this._getPromiseRetrieveAllApps()]).then(function(){m(this._commandsConf,this._botsConf)}.bind(this),function(){console.error("At least one call failed to retrieve all confs for the bots")})}},_getServiceUrl:function(m,o){var n=i.getInstance();j.getPlatformServices({platformId:n.get("config").tenant.online_instance_id,onComplete:function(p){var q=Object.keys(p).length,r=false;Object.keys(p).forEach(function(t,s){if(t.toLowerCase()===m.toLowerCase()){r=true;o(p[t])}});if(r===false){o(null)}}.bind(this),onFailure:function(){console.error("3DCompass call failed")}})},_getNlsCallPromise:function(m){return new f(function(o,n){require([m.moduleName],function(p){if(p){this._nls[m.appId]=p}o()}.bind(this),function(){console.error("Failed retrieving the following NLs Json Module for Bots",m.moduleName);o()})}.bind(this))},getNlsValue:function(p,o){var n="",m=this._nls[p];if(typeof o==="string"){n=o}else{if(o.nlsKey&&m){if(o.data){n=m.replace(o.nlsKey,o.data)}else{n=m.get(o.nlsKey)}}}return n},getFastNlsForOneApp:function(o,m){var n=this._nls[o];if(n){m(n)}else{j.getAppsInfo({data:[o],onComplete:function(p){var q=p&&p[0];if(q){this._getServiceUrl(q.serviceId,function(r){k.request(r+"/"+q.swymIntegration,{type:"json",onFailure:function(){console.error("Failed retrieving swymIntegration conf for app app.id");m()},onComplete:function(s){if(s.nlsModulePath){require([s.nlsModulePath],function(t){if(t){this._nls[s.appId]=t;m(t)}}.bind(this),function(){console.error("Failed retrieving the following NLs Json Module for Bots",s.nlsModulePath);m()})}else{console.error("No nls module Path defined");m()}}.bind(this)})}.bind(this))}}.bind(this),onFailure:function(){console.error("failed retrieving app info through my apps service");m()}})}},_initRetrieveNlsFiles:function(){var m=[];this._nlsArrayModule.forEach(function(n){m.push(this._getNlsCallPromise(n))}.bind(this));f.all(m).then(function(){this._nlsIsLoaded=true;this.dispatchEvent("onNlsSync",[this])}.bind(this))},_getCommandFromHtmlStringIfExist:function(m,n){this._getCommands(function(){var o=null,q=new RegExp("/(.*?) "),r=a.unescapeHTML(m),p=r.match(q);if(p&&p[0]&&p[1]){o=this._commandsConf[p[1]]&&this._commandsConf[p[1]][0];if(o){o.command_input=r.replace(p[0],"");o.commandName=p[1]}}n(o)}.bind(this))},executePrimaryCommandIfInputMatched:function(m){this._getCommandFromHtmlStringIfExist(m.content,function(n){if(n){this._getServiceUrl(n.serviceName,function(o){this._callCommand(o+n.uri,{app_id:n.appId,channel_id:m.community_id,channel_name:m.channel_name,channel_type:m.isDMContext?"dm":"community",command:n.commandName,command_input:n.command_input,"3dswym_service":this._swymServiceUrl})}.bind(this))}}.bind(this))},executeSecondaryCommand:function(m){this._getCommands(function(){this._getServiceUrl(this._appsParameters[m.app_id].serviceId,function(n){this._callCommand(n+m.uri,{app_id:m.app_id,channel_id:m.channel_id,channel_type:m.channel_type,channel_name:m.channel_name,command:m.command,command_params:m.options,command_input:"",message_id:m.message_id,"3dswym_service":this._swymServiceUrl})}.bind(this))}.bind(this))},_callCommand:function(m,n){h.authenticatedRequest(m,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},data:JSON.stringify(n),onFailure:function(o){console.log("External command has failed : ",o)},onComplete:function(o){console.log("External command has succeeded: ",o)}})}});return b.singleton()});define("DS/SwymUICore/script/feature/core/last-thread-access/last-thread-access-manager",["UWA/Class","DS/SwymUICore/script/utils/localstorage-utils"],function(b,a){return b.singleton({_lastAccess:null,getLastCommunity:function(){return this._lastAccess.hasOwnProperty("community")?this._lastAccess.community:null},getLastDM:function(){return this._lastAccess.hasOwnProperty("dm")?this._lastAccess.dm:null},setLastCommunity:function(c){this._lastAccess.community=c||"home";a.setPrefixedItem("lastThreadAccess",this._lastAccess,{tenant:true})},setLastDM:function(c){this._lastAccess.dm=c;a.setPrefixedItem("lastThreadAccess",this._lastAccess,{tenant:true})},removeLastDM:function(){this._lastAccess.dm=null;a.setPrefixedItem("lastThreadAccess",this._lastAccess,{tenant:true})},init:function(){var c=a.getPrefixedItem("lastThreadAccess",{tenant:true});this._lastAccess=c?c:{}}})});define("DS/SwymUICore/script/feature/core/realtime/model/realtime-connection-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/WebappsUtils/Console"],function(a,g,f,e){var d={},b=null;var c=a.extend({_modelName:"realtime-connection",connected:false,addListener:function(i,j){var k=this;if(k.connected===false){k.addEventOnce("onConnection",function(){k._addListener(i,j)})}else{k._addListener(i,j)}},_addListener:function(i,j){if(b){b.on(i,function(k){e.log("RealtimeConnection - Event received: "+i);j(k)})}else{e.log('RealtimeConnection - Add "'+i+'" event listener error, the realtime connection is not ready yet.')}},_performPTAUTH:function(){var i=this;g.request({url:"/api/node/ptauth",method:"GET",proxy:"passport",onComplete:function(n){e.log("RealtimeConnection - PTAUTH success");if(typeof n==="string"){n=JSON.parse(n)}if(n.result){n=n.result}var k,m="",l=f.getInstance(),j=l.get("config").realtime;if(j&&n.pt){if(j.node_wsserver_url){k=j.node_wsserver_url.split("://");if(k.length===2){m=k[1]}}if(m.indexOf(":")>=0){k=m.split(":");m=k[0]}require(["DS/DSNodeSocketioClient/DSNodeSocketioClient"],function(o){if(o){b=o.connect(j.node_wsserver_url,{query:"node_proxy_ticket="+n.pt,secure:true,path:j.node_wsserver_socket_resource});b.on("connect",function(){this.onSocketConnection()}.bind(i));b.on("connect_failed",function(){e.log("RealtimeConnection - connect_failed")});b.on("error",function(p){e.log("RealtimeConnection - connect error")})}e.log("RealtimeConnection - END PTAUTH success")})}}.bind(this),onFailure:function(){e.log("RealtimeConnection - PTAUTH error")}})},onSocketConnection:function(){this.connected=true;this.dispatchEvent("onConnection")},init:function(i,j){var k=this;require(["DS/SwymUICore/script/utils/call-scheduler"],function(l){l.executeAfterPageLoad(function(){k._performPTAUTH()},(window.ds&&window.ds.env==="3DSwym")?null:2000,200)});this._parent(i,j)}});var h=null;d.getInstance=function(){if(h===null){h=new c()}return h};return d});define("DS/SwymUICore/script/feature/core/notification/notification-manager",["UWA/Core","UWA/Class","UWA/String","DS/SwymUICore/script/utils/utils","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/utils/navigation"],function(g,b,f,e,a,d){var c=window.ds&&(window.ds.env==="MOBILE");return b.singleton({setup:function(h){var i=this,j=i.listenToNotifications.bind(i);a.subscribe("common.3DNotification.topic",j);if(c){require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(k){k.listenToNotification(j)})}},listenToNotifications:function(i){var h;if(c){h=i}else{h=this._extractNotifData(i.data.url)}switch(h.appName){case"X3DMCTY_AP":if(h.contentId){if(h.modelName==="instantmessage"){if(h.communityType==="dm"){d.goToDM(h.communityId,undefined,undefined,{messageUuid:h.messageId})}else{d.goToCommunity(h.communityId,undefined,undefined,false,{messageUuid:h.messageId})}}else{d.goToContent(h.contentId,h.modelName,h.communityId,false,h.commentUri,h.replyUri,undefined,h.answerUri?{answerUri:h.answerUri}:undefined)}}else{require(["DS/SwymUICore/script/feature/community/community/model/community-model"],function(k){var j=new k({mid:h.communityId});if(!j.hasCurrentUserAccess()){j.fetch({onComplete:function(){j.setUserAccess(j.get("hasUserAccess"));if(j.get("community_type")==="dm"){d.goToDM(h.communityId)}else{d.goToCommunity(h.communityId)}},onFailure:function(){d.goToCommunity(h.communityId)}})}else{if(j.get("community_type")==="dm"){d.goToDM(h.communityId)}else{d.goToCommunity(h.communityId)}}})}break;case"X3DPRFL_AP":if(!h.login){console.error("A notification to a User Profile does not contain any login.",i.data.url)}d.goToProfile({login:h.login});break;case"X3DOPSW_AP":if(h.tab){switch(h.tab){case 1:d.goToUrl("admin-tenant/whatsnew");break;case 0:default:d.goToUrl("admin-tenant/communities");break}}else{d.goToUrl("admin-tenant")}break;default:break}},_extractNotifData:function(j){var h=j.split("#app:")[1].split("/")[0],m=j.split("content:")[1].split("&"),k={appName:h},l=m.reduce(function(n,p){var o=p.split("=");n[f.camelCase(o[0])]=o[1];return n},{});if(h!=="X3DMCTY_AP"&&h!=="X3DPRFL_AP"&&h!=="X3DOPSW_AP"){console.error("The notification points to a non supported Swym app:",h)}for(var i in l){if(l.hasOwnProperty(i)){switch(i){case"community":k.communityId=l[i];break;case"communityType":k.communityType=l[i];break;case"contentType":k.modelName=l[i];break;case"messageId":k.messageId=l[i];break;case"contentId":case"login":case"tab":k[i]=l[i];break;case"commentUri":if(e.isFeatureActivated("activateCommentNotificationRedirection")){if(l.parentCommentUri){k.replyUri=decodeURIComponent(l[i])}else{k.commentUri=decodeURIComponent(l[i])}}break;case"parentCommentUri":if(e.isFeatureActivated("activateCommentNotificationRedirection")){k.commentUri=decodeURIComponent(l[i])}break;case"replyUri":if(e.isFeatureActivated("activateCommentNotificationRedirection")){if(l.commentUri){k.replyUri=decodeURIComponent(l[i])}}break;case"answerUri":if(e.isFeatureActivated("activateCommentNotificationRedirection")){k.answerUri=decodeURIComponent(l[i])}default:break}}}return k}})});define("DS/SwymUICore/script/feature/community/media/model/media-file-extension-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(f,a,c){c.log("DS/SwymUICore/script/feature/community/media/model/media-file-extension-model");var d=a.extend({_modelName:"media-files-extension",_services:{read:{url:"api/media/getsupportedfileextensionspertype"}},loadingStatus:a.STATUS.notRequested,"onRequest:read":function(){this.loadingStatus=a.STATUS.pending},"onSync:read":function(){this.loadingStatus=a.STATUS.valid;this._createDocumentedFileExtensions()},"onError:read":function(){this.loadingStatus=a.STATUS.invalid;c.log("Get supported types -> Call error.")},_attributesMapping:{_authorizedFileFormats:"authorizedFormats",_documentedFileFormats:"documentedFormats",_maxSizeForFiles:"maxSizes"},_createDocumentedFileExtensions:function(){var o=this.getAttributes();var m={skipusage:o.skipusage,image:o.picture,picture:o.picture,video:o.video,audio:o.sound,sound:o.sound,"3dmodel":o["3d_model"],"3d_model":o["3d_model"],document:o.document,drawing:o.drawing};var l=f.clone(m);for(var j=0,g=m.skipusage.length;j<g;j++){var n=m.skipusage[j];for(var k in l){if("skipusage"!==k){var h=l[k].indexOf(n);if(-1!==h){l[k].splice(h,1)}}}}this.set("authorizedFormats",m);this.set("documentedFormats",l);this.set("maxSizes",o.maxsize);this.dispatchEvent("onDocumentedFileExtensionsCreated")}});var e=null;var b={getInstance:function(g){if(null===e){e=d.singleton();e.fetch({onComplete:function(h){if(g){h.addEvent("onSync:read",g)}}})}else{if(g){g()}}return e}};b.__testonly__={Class:d};return b});define("DS/SwymUICore/script/feature/core/tenant/model/tenant-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){console.log("DS/SwymUICore/script/feature/core/tenant/model/tenant-model");var b=a.extend({_modelName:"tenant",stats:null,footer:null,tenantContextId:null,_attributesMapping:{id:"mid"},_services:{read:{url:"admin/api/tenant/get",dataFn:function(){return{id:this.get("mid")}}},update:{url:"admin/api/tenant/edit",paramsMapping:{mid:"id"}},listOptions:{url:"admin/api/tenant/listoption"},editOptions:{url:"admin/api/tenant/editoption"},editLogo:{url:"admin/api/tenant/setlogo"},getTenantInfo:{url:"api/analytics/infotenant",dataFn:function(){var c=new Date();return{date00:"2008-01-01",date01:(function(){var e=c.getFullYear();var f=c.getMonth()+1;var d=c.getDate();if(10>d){d="0"+d}if(10>f){f="0"+f}return e+"-"+f+"-"+d})(),tenant_uuid:this.get("mid")}},parse:function(c){this.stats=c[0];return c}}},listOptions:function(c){return this.action("listOptions",c)},editOptions:function(c){return this.action("editOptions",c)},editLogo:function(c){return this.action("editLogo",c)},getTenantInfo:function(c){return this.action("getTenantInfo",c)}});return b});define("DS/SwymUICore/script/lib/view/generic/img-view",["DS/SwymUICore/script/lib/view/generic/swym-model-view"],function(b){var a=b.extend({_imageRenderingOptions:null,name:"img-view",setup:function(c){if(c&&c.imageRenderingOptions){this._imageRenderingOptions=c.imageRenderingOptions}return this._parent.apply(this,arguments)},setWidget:function(c){if(!c){return this}return this._parent.apply(this,arguments)}});return a});define("DS/SwymUICore/script/utils/call-scheduler",["UWA/Core","UWA/Class","UWA/Array","UWA/Class/Events","DS/SwymUICore/script/feature/core/context/context-model"],function(g,b,d,k,i){var e=3000,a=0,h=1000,j=false,c=i.getInstance();var f=b.singleton({_activated:true,delayLoadingOfLowPriorityModules:function(){if(this._activated&&!j){j=true;var q=window.require,n={},l=["DS/InstantMessaging","DS/NotificationManager","DS/DSNodeSocketioClient"],m={"DS/InstantMessaging":h+e,"DS/NotificationManager":h+e,"DS/DSNodeSocketioClient":h+e},o=function(){var w=this,v,u=undefined,s,y=null,r=false,t=arguments,x=t[0];if(Array.isArray(x)&&(x.length===1)){v=x[0];if(v){d.detect(l,function(z){if(v.startsWith(z)){u=z;return true}})}}if(u){if(!n[u]){n[u]=[{scope:w,args:t}]}else{n[u].push({scope:w,args:t})}if(n[u].length===1){s=function(){var z=l.indexOf(u);if(z>=0){l.splice(z,1);if(l.length===0){window.require=q}n[u].forEach(function(A){q.apply(A.scope,A.args)});n[u]=[]}};r=(typeof(c.addOnce("onPageLoad",function(){if(y){clearTimeout(y)}setTimeout(function(){s()},h)},null,true))==="function");if(!r){y=setTimeout(s,m[u])}}}else{return q.apply(w,t)}};for(var p in q){if(q.hasOwnProperty(p)){o[p]=q[p]}}window.require=o}},executeAfterPageLoad:function(q,m,n){var o=null,l=false,p=function(){if(l===false){l=true;q()}};if(!q){throw new Error("The callback is missing")}if(this._activated===true){if(!(m>0)){m=e}if(!(n>=0)){n=a}o=setTimeout(p,m);c.addOnce("onPageLoad",function(){clearTimeout(o);setTimeout(p,n)},null,true)}else{q()}},activate:function(){this._activated=true},deactivate:function(){this._activated=false}});return f});define("DS/SwymUICore/script/feature/core/error/view/error-view",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/error/view/error-view","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/WebappsUtils"],function(f,e,b,d,c){var a=b.extend({name:"error-view",_error:null,_errorCode:403,_createContent:function(){var g=c.getWebappsBaseUrl()+"SwymUICore/assets/";return{styles:{"padding-top":"30px",width:"100%","min-height":"calc(100vh)",background:'no-repeat center center fixed url("'+g+'bg.jpg")',"background-size":"cover"},html:{styles:{position:"relative","margin-left":"auto","margin-right":"auto",padding:"10px",border:"1px solid white","box-shadow":"1px 1px 3px 0 #424242","border-radius":"10px",width:"952px","line-height":"normal",height:"497px",background:'no-repeat url("'+g+'ifweswymoverview.jpg")'},html:[{styles:{"background-color":"white",padding:"10px","border-radius":"5px","margin-bottom":"87px",color:"#1A79B1","font-weight":"bold",overflow:"auto"},html:[{styles:{"float":"left"},tag:"span",html:e.Error+" "+this._errorCode+" - "+(this._errorCode===403?e.Forbidden:e.NotFound)},{styles:{"float":"right"},tag:"span",html:e.Swym}]},{styles:{"padding-left":"165px"},html:[{styles:{color:"white","font-size":"22px"},html:e.SocialInnovationApplication},{styles:{"font-size":"22px",color:"#305164","margin-top":"60px"},html:e.Sorry},{styles:{"font-size":"110px",color:"#305164"},html:this._errorCode+"!"},{styles:{"font-size":"22px",color:"#305164","margin-top":"10px"},html:(function(){switch(this._error&&this._error.errorcode){case"ERROR_ACCESS_FORBIDDEN_LICENSE_EXPIRED":return e.YourLicenceIsExpiredOrUnavailable;case"ERROR_ACCESS_FORBIDDEN_LICENSE_FULLY_CONSUMED":return e.YourLicenceIsFullyConsumed;case"ERROR_LICENSING_EXTENSION_KO":return e.LicensingPHPExtensionIsNotProperlyInstalled;case"ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE":return e.YourAccountIsNotActive;case"ERROR_ACCESS_FORBIDDEN_CSRF_KO":return e.AnErrorHasOccurred;case"ERROR_ACCESS_NO_LICENSE":return e.YouDontHaveAnyLicense;default:if(this._errorCode===403){return e.ThePageRequestedIsForbidden}else{return e.TheRequestedPageDoesNotExist}}}.bind(this))()}]}]}}},setup:function(g){if(g){if(g.hasOwnProperty("error")){this._error=g.error}if(g.hasOwnProperty("errorCode")){this._errorCode=g.errorCode}}return this._parent.apply(this,arguments)}});return a});define("DS/SwymUICore/script/feature/community/community/model/community-type-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(d,a,c){var b=a.extend({_modelName:"community-type",_attributesMapping:{},_services:{create:{url:"api/type/add"},"delete":{url:"api/type/delete",dataFn:function(){return{id:this.get("mid")}}},update:{url:"api/type/update",dataFn:function(){return{id:this.get("mid"),title:this.get("title"),description:this.get("description")}}}}});return b});define("DS/SwymUICore/script/feature/core/tenant/collection/users-processes-collection",["DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/tenant/model/users-process-model"],function(b,c){var a=b.extend({model:c,mode:"processes",modes:["processes"],_communityId:null,_asAdmin:false,_services:{read:{processes:{url:"api/member/getbatchlist",dataFn:function(d){return{start:(this._currentPage-1)*this._limit,limit:this._limit,community_id:this._communityId,user_type:4,as_admin:this._asAdmin}},parse:function(d){d.forEach(function(f,e){f.real_id=f.id;f.mid=e});return d}}}},setup:function(e,d){this._parent.apply(this,arguments);if(d&&d.community_id){this._communityId=d.community_id}if(d&&d.asAdmin){this._asAdmin=d.asAdmin}}});return a});define("DS/SwymUICore/script/feature/core/user/collection/member-collection",["UWA/Core","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/W3DXComponents/Collections/ActionsCollection","DS/WebappsUtils/Console"],function(g,b,d,h,a,f,c){var i=d.extend(a,{_actionsCollectionClass:f,init:function(){this._parent.apply(this,arguments);this.addActions()}});var e=b.extend({model:i});return e});define("DS/SwymUICore/script/feature/core/network/collection/activity-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/network/model/activity-model","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(f,c,d,e,b){var a=c.extend({_services:{read:{activity:{url:"api/network/getnetworkactivity",dataFn:function(g){return{only_main_activity:true,only_raw_data:true,hash_key:this.hash_key,page:this._currentPage,limit:this._limit}}}}},paginationMode:"PREV_NEXT",model:d,modes:["activity"],setup:function(h,g){if(g.hash_key){this.hash_key=g.hash_key}}});return a});define("DS/SwymUICore/script/feature/core/favorite/favorite-dm-manager",["DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager","DS/SwymUICore/script/feature/core/favorite/collection/favorite-dm-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model"],function(e,a,d){var c,b=e.extend({_modelClass:d,init:function(){this._parent.apply(this,arguments);this._collection=new a([],{mode:"my-favorites-dm"});return this}});return{getInstance:function(){if(!c){c=new b()}return c},resetInstance:function(){if(c){c=null}}}});define("DS/SwymUICore/script/feature/core/search/collection/search-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(f,e,a,c){var d=a.extend({_modelName:"search-model"});var b=e.extend({_services:{read:{suggestterms:{url:"api/exalead/suggestterms",dataFn:function(g){return{query:g.query,term_type:g.term_type}},parse:function(g){return g.hits}}}},model:d,modes:["suggestterms"],setup:function(h,g){}});return b});define("DS/SwymUICore/script/feature/community/iquestion/collection/iquestion-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/WebappsUtils/Console"],function(f,c,e,d,b){var a=e.extend({_collectionName:"iquestion-collection",_services:{read:{all:{url:"api/IquestionsQuestions/list",dataFn:function(){return{page:this._currentPage,limit:this._limit}}},communityPublished:{url:"api/IquestionsQuestions/list",dataFn:function(){return{published:1,page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityAll:{url:"api/IquestionsQuestions/list",dataFn:function(){return{limit:this._limit,page:this._currentPage,community_id:this.communityId}}},published:{url:"api/IquestionsQuestions/list",dataFn:function(){return{published:1,page:this._currentPage,limit:this._limit}}},validated:{url:"api/IquestionsQuestions/list",dataFn:function(){return{validated:1,page:this._currentPage,limit:this._limit}}},communityWhatsnewQuestions:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({query:"type:"+this.exaleadContentType,legacyFormat:false,community_id:this.communityId,with_synthesis:false},g||{})},parse:c.parseSearchResult}},filter:{published:{url:"api/exalead/search",tagsWithoutSubjectURI:true},communityPublished:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null})},tagsWithoutSubjectURI:true},communityQuestionsPublishedNotValidated:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{query:"#all",contentType:this.exaleadContentType,limit:this._limit,legacyFormat:false,refineUsingQuery:'community_id:"'+this.communityId+'" -categories:"ds6w/ds6w:what/ds6w:status/implicit/xsd:string/ds6w:status.swym_validated"'})}},communityWhatsnewQuestions:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({contentType:this.exaleadContentType,legacyFormat:false,community_id:this.communityId,refineUsingQuery:"type:"+this.exaleadContentType,with_synthesis:true},g||{})},tagsWithoutSubjectURI:true}}},model:d,modes:["all","published","validated","communityPublished","communityWhatsnewQuestions","communityAll","communityQuestionsPublishedNotValidated"],exaleadContentType:"iquestion",setup:function(h,g){if(g.communityId){this.communityId=g.communityId}}});return a});define("DS/SwymUICore/script/feature/community/report-abuse/collection/report-abuse-collection-v2",["UWA/Core","UWA/Array","UWA/Json","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2","DS/Logger/Logger"],function(g,b,c,f,a,e){var d=f.extend({_collectionName:"report-abuse-collection",_services:{read:{all:{url:"commentproxy/reportabuses",method:"GET",paramsMapping:{page:"page_number",limit:"page_size"},dataFn:function(h){return h}}}},defaultOptions:{state:{firstPage:0,currentPage:0},queryParams:{currentPage:"page_number",pageSize:"page_size"}},model:a,mode:"all",modes:["all"],parse:function(j,h){var i=(!g.is(j,"string"))?j:c.decode(j);if(i&&i.hasOwnProperty("totalRecords")){if(typeof(i.totalRecords)==="undefined"&&b.isArray(i.result)){this.setTotalItems(i.result.length)}else{this.setTotalItems(i.totalRecords)}}return this._parent(j,h)}});return d});define("DS/SwymUICore/script/feature/community/community/collection/community-request-count-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model"],function(c,b,a){return b.extend({_collectionName:"community-request-count",_services:{read:{count:{url:"api/communityRequest/totalRequestPerStatus"}}},modes:["count"],model:a.extend({_modelName:"community-request-count"})})});define("DS/SwymUICore/script/feature/community/community/collection/community-request-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/community/community/model/community-request-model","DS/WebappsUtils/Console"],function(e,c,d,b){var a=c.extend({_collectionName:"community-request-collection",_status:[2],_services:{read:{all:{url:"api/communityRequest/listbystatus",dataFn:function(){return{page:this._currentPage,limit:10,status:this._status}}},user:{url:"api/communityRequest/listbyuser",dataFn:function(){return{page:this._currentPage,limit:10}}}}},model:d,modes:["all","user"],init:function(g,f){if(e.is(f.status)){this._status=f.status}return this._parent(g,f)}});return a});define("DS/SwymUICore/script/feature/community/idea/collection/idea-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/WebappsUtils/Console"],function(e,d,a,c){var b=d.extend({_collectionName:"idea-collection",_services:{read:{community:{url:"api/Ideation/list",dataFn:function(){return{community_id:this.communityId,limit:this._limit,page:this._currentPage}}},"community-full-list":{url:"api/Ideation/getfullpipeline",dataFn:function(){return{community_id:this.communityId,limit:this._limit,order:"DESC"}},parse:function(f){this.statusInfos=f.status;return f.ideas}}},filter:{community:{url:"api/exalead/search",dataFn:function(f){return e.extend(f||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null,order_field:"update",order_by:"desc"})},tagsWithoutSubjectURI:true},"community-full-list":{url:"api/exalead/search",dataFn:function(f){return e.extend(f||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null,order_field:"update",order_by:"asc"})},tagsWithoutSubjectURI:true}}},model:a,modes:["community","community-full-list"],exaleadContentType:"idea",setup:function(g,f){if(f.communityId){this.communityId=f.communityId}this.addEvent("onSync:remove",this.refresh,this)},collectionPostProcess:function(f){this.forEach(function(h){var g=f.find(function(i){return(i.get("mid")===h.get("status_id"))});if(g){h.set({status_title:g.get("title"),color:g.get("color")})}})}});return b});define("DS/SwymUICore/script/feature/core/bookmark/collection/bookmark-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/mixed-collection","DS/SwymUICore/script/feature/core/bookmark/model/bookmark-model","DS/WebappsUtils/Console"],function(c,b,d){var a=b.extend({_collectionName:"bookmark-collection",_services:{read:{bookmark:{url:"api/exalead/search",dataFn:function(e){return c.extend(e||{},{refineUsingQuery:null})},tagsWithoutSubjectURI:true}}},model:d,modes:["bookmark"],parse:function(h,e){var g=new d({uri:"hello1"}),f=new d({uri:"hello2"});return[g,f]}});return a});define("DS/SwymUICore/script/feature/core/user/collection/users-group-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/user/model/users-group-model"],function(c,d,b){var a=d.extend({_collectionName:"users-group-collection",model:b});return a});define("DS/SwymUICore/script/feature/core/direct-message/collection/direct-message-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(d,c,a,b){return c.extend({modes:["my-dm-communities"],_collectionName:"direct-message-collection",_updatableOptions:{listeners:["threadCreation"],add:{append:false}},model:a})});define("DS/SwymUICore/script/feature/core/favorite/favorite-communities-manager",["DS/SwymUICore/script/feature/core/favorite/abstract-favorite-manager","DS/SwymUICore/script/feature/core/favorite/collection/favorite-communities-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model"],function(e,a,d){var b,c=e.extend({_modelClass:d,init:function(){this._parent.apply(this,arguments);this._collection=new a([],{mode:"my-favorites-communities",page:1,limit:999});return this}});return{getInstance:function(){if(!b){b=new c()}return b},resetInstance:function(){if(b){b=null}}}});define("DS/SwymUICore/script/feature/core/notification/collection/notification-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(e,d,b,c){var a=b.extend({_modelName:"notification"});return d.extend({model:a,_services:{sendInvitations:{sendInvitations:{url:"api/notification/send/",dataFn:function(f){return{type:"Network","do":"invite",recipient_hash:f.hash_keys,message:f.message,related_model_id:f.groupIdProfessionnal}}}}},sendInvitations:function(f){return this.action("sendInvitations",f)},modes:["sendInvitations"],setup:function(g,f){}})});define("DS/SwymUICore/script/feature/thread/collection/thread-lite-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(g,e,f,b){var d=10,a=function(h){return h.result.map(function(i){i.hasUserAccess=true;i.user_access=1;return i})},c=e.extend({_collectionName:"thread-lite-collection",_services:{read:{community:{url:"api/communities/lite",method:"GET",postProcess:a,dataFn:function(){return{}}},conversation:{url:"api/directmessages/lite",method:"GET",postProcess:a,dataFn:function(){return{}}}},lastMessage:{community:{method:"GET",dataFn:function(){return{}},postProcess:function(h){if(g.is(h,"object")&&g.is(h.result,"array")){h.result.forEach(function(i){var j=this.mode==="conversation"?b:f;new j({mid:i.community_id}).set("last_message",i)},this)}}},conversation:{method:"GET",dataFn:function(){return{}},postProcess:function(h){if(g.is(h,"object")&&g.is(h.result,"array")){h.result.forEach(function(i){var j=this.mode==="conversation"?b:f;new j({mid:i.community_id}).set("last_message",i)},this)}}}},filter:{community:{url:"api/exalead/search",method:"POST",dataFn:function(h){return g.extend(h||{},{contentType:"community",limit:15,with_synthesis:false})},tagsWithoutSubjectURI:true},conversation:{url:"api/exalead/search",method:"POST",dataFn:function(h){return g.extend(h||{},{contentType:"directmessage",limit:15,with_synthesis:false})},tagsWithoutSubjectURI:true}}},modes:["community","conversation"],getLastMessage:function(){var k={},j,o,h,m,n;n=this.length&&this.slice((this.getCurrentPage()-1)*this.getLimit(),this.length).map(function(p){var i=p.get("last_message")&&p.get("last_message").message_id,r=p.get("mark")&&p.get("mark").message_id,q=false;if(i&&(!r||r!==i)){q=true}return q&&i}).filter(Boolean);if(n.length>0){m=Math.ceil(n.length/d);for(var l=0;l<m;l++){o=l*d;h=Math.min((l+1)*d,n.length);j=n.slice(o,h);k.url="api/community/timeline/messages/"+j.join(",");k.remove=false;this.action("lastMessage",k)}}},init:function(i,h){this.model=h.mode&&h.mode==="conversation"?b:f;h.limit=10;this._parent.apply(this,arguments)}});return c});define("DS/SwymUICore/script/feature/community/survey/collection/survey-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/WebappsUtils/Console"],function(g,d,f,e,a,c){var b=f.extend({_collectionName:"survey-collection",model:e,modes:["community-surveys","community-stats-surveys","open-community-surveys"],exaleadContentType:"survey",_asAdmin:false,_associations:{community:{Class:a}},_services:{read:{"community-surveys":{url:"api/exalead/whatsnew",dataFn:function(h){return g.merge({query:"type:"+this.exaleadContentType,legacyFormat:false,community_id:this.communityId,with_synthesis:false},h||{})},parse:d.parseSearchResult},"community-stats-surveys":{url:"api/analytics/infosurvey",dataFn:function(h){if(h&&h.page){delete h.page}if(h&&h.limit){delete h.limit}return g.extend(h||{},{community_id:this.getAssociated("community").get("mid"),page_size:this._limit,page_number:(this._currentPage-1),as_admin:this._asAdmin})}}},filter:{"community-surveys":{url:"api/exalead/search",dataFn:function(i){var h=this.communityId||this.getAssociated("community").get("mid");return g.extend(i||{},{refineUsingQuery:h?('community_id:"'+h+'"'):null,contentType:this.exaleadContentType})},tagsWithoutSubjectURI:true},"open-community-surveys":{url:"api/exalead/search",dataFn:function(i){var h=this.communityId||this.getAssociated("community").get("mid");return g.extend(i||{},{refineUsingQuery:(h?('community_id:"'+h+'"'):"")+' -categories:"ds6w/ds6w:what/ds6w:status/implicit/xsd:string/ds6w:status.swym_survey_closed"',contentType:this.exaleadContentType})},tagsWithoutSubjectURI:true}}},setup:function(i,h){if(h.communityId){this.communityId=h.communityId}if(h.only_not_answered_by_me){this.only_not_answered_by_me=h.only_not_answered_by_me}if(g.is(h.asAdmin)){this._asAdmin=h.asAdmin}this.addEvent("onSync:remove",this.refresh,this);return this._parent(i,h)}});return b});define("DS/SwymUICore/script/feature/core/network/collection/request-collection",["UWA/Core","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/network/model/request-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/WebappsUtils/Console"],function(f,e,c,g,d,b){var a=e.extend({Hashkey:null,_associations:{groups:{Class:g},users:{Class:d}},_services:{read:{sentRequests:{url:"api/network/getsentrequests",dataFn:function(){return{hash_key:this.Hashkey,start:(this._currentPage-1)*this._limit,limit:this._limit}}},receivedRequests:{url:"api/network/getpendingrequests",dataFn:function(){return{hash_key:this.Hashkey}}}}},model:c,modes:["sentRequests","receivedRequests"],init:function(j,h){try{if(h){if(h.Hashkey){this.setHashkey(h.Hashkey)}}return this._parent(j,h)}catch(i){b.error("Error initializing collection: "+i.message);return}},getHashkey:function(){return this.Hashkey},setHashkey:function(h){this.Hashkey=h}});return a});define("DS/SwymUICore/script/lib/model/generic/swym-model",["UWA/Core","UWA/Json","UWA/Utils","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","UWA/Class/Model","UWA/Class/Collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console","DS/SwymUICore/script/utils/utils"],function(b,c,k,j,i,l,s,h,g,r,d){r.log("DS/SwymUICore/script/lib/model/generic/swym-model");function m(t,v){var u=undefined;if(t){u=t[v];if(b.is(u,"function")){u=u.call(t)}}return u}function p(){throw new Error('A "url" property or function must be specified')}var o={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"},n=function(u){var v,t=this,x,w;if(typeof u!=="undefined"){v=u.serviceName;x=u.onFailure;w=function(y){switch(v){case"create":case"update":case"patch":if(!u.wait&&t instanceof l){t.set(t._previousAttributes)}break;case null:case undefined:r.warn("Called service has no name");break;default:break}r.error("Call failed: ",u,y);if(x){x.apply(this,arguments)}};u.onFailure=w;return u}else{throw new Error("Invalid service !")}},f=function(A,t,z,v){var u=this._associations[A],y=u.Class||this.constructor.prototype._associations[A].Class;if(y&&u.associated){if((b.is(z,"object")&&(y.prototype instanceof l))||(b.is(z,"array")&&(y.prototype instanceof s))){var x,w=u.options;if(!w){w={}}if(v.areModelDataFromServer!==false){w.areModelDataFromServer=true}if(y.prototype instanceof l){x=new y(z,w);if(!u.associated.equals(x)){t.setAssociated(A,x)}}else{u.associated.set(z,w)}}else{throw new Error("The attribute is supposed to be an object or an array")}}},e=function(){var t;if(!this.hasOwnProperty("_associations")){if(b.is(this._associations,"object")){this._associations=b.extend({},this._associations||{});t=Object.keys(this._associations||{});t.forEach(function(v){this._associations[v]=b.extend({},this._associations[v]||{});if(b.owns(this._associations,v)){var u=this._associations[v];if(u&&typeof u.onSourceAttributeChange!=="function"){u.onSourceAttributeChange=function(w,y,x){return f.call(this,v,w,y,x)};this.addEvent("onChange:"+(u.sourceAttribute||v),u.onSourceAttributeChange,this)}}},this)}else{this._associations={}}}},a=function(w,v,y){var t,u,x;switch(w){case"onRequest":u=v[2];if(u&&u.serviceName){this._parent.call(this,w+":"+u.serviceName,v,y)}break;case"onSync":x=v[0];t=v[1];u=v[2];if(typeof t==="undefined"||(t&&typeof t.errorcode!=="undefined")){return this.dispatchEvent("onError",v,y)}else{if(u&&u.serviceName&&x instanceof this.constructor){this._parent.call(this,"onSync:"+u.serviceName,v,y)}}break;case"onError":x=v[0];u=v[2];if(u&&u.serviceName&&x instanceof this.constructor){this._parent.call(this,"onError:"+u.serviceName,v,y)}break;default:}return this._parent.apply(this,arguments)};var q=null;q=l.extend({_modelName:null,_tableName:null,_customProperties:null,_services:null,_changes:null,_previousChanges:null,_modelIdAttribute:"mid",_attributesMapping:{id:"mid"},_associations:null,_provokeCacheUpdates:true,_cacheKey:"",HTML_ATTRIBUTES:null,defaults:{},lastCallsParams:null,lastCalledService:null,_updateIdAttribute:function(t){if(t[this._modelIdAttribute]){var u=String(t[this._modelIdAttribute]),v=u.split(":");u=v[v.length-1];t[this.idAttribute]=[this._modelName,":",u].join("");t[this._modelIdAttribute]=u}return t},_callService:function(y,v,u){var w=undefined,x=undefined;var t=this._services?b.extend({},((y==="patch")?this._services.update:this._services[y])):{};if(u){u=b.merge(u,t)}if(u.parse===true&&typeof t.parse==="function"){u.parse=t.parse}if(!u.postProcess&&typeof t.postProcess==="function"){u.postProcess=t.postProcess}u.serviceName=y;this.adaptService(u);this.lastCalledService=y;this.lastCallsParams[y]=u.data;if(y==="read"){if((i.isPendingCall({url:u.url,data:u.data,instance:this},true)!==true)||(!i.isModelInCache(this))){return q.parentSync.call(this,y,v,u)}else{if(typeof u.originalOnComplete==="function"){w=function(z,B){var A=u.originalOnComplete;if(x){this.removeEvent("onError:read",x)}this.removeEvent("onSync:read",w);delete u.originalOnComplete;delete u.originalOnFailure;return A(z,B,u)};this.addEventOnce("onSync:read",w,this,10)}if(typeof u.originalOnFailure==="function"){x=function(z,B){var A=u.originalOnFailure;if(w){this.removeEvent("onSync:read",w)}this.removeEvent("onError:read",x);delete u.originalOnComplete;delete u.originalOnFailure;return A(z,B,u)};this.addEventOnce("onError:read",x,this,10)}}}else{return q.parentSync.call(this,y,v,u)}return false},_breakLineAttributeIfNeeded:function(t,v,u){if(typeof(v)==="string"){switch(u&&u.breakline){case true:v=v.replace(/(?:\n)/g,"<br>");break;case false:break;default:break}}return v},_escapeAttributeIfNeeded:function(t,v,u){if(typeof(v)==="string"){switch(u&&u.escapeHTML){case true:v=v.escapeHTML();break;case false:break;default:if(!this.HTML_ATTRIBUTES||this.HTML_ATTRIBUTES.indexOf(t)===-1){v=v.escapeHTML()}break}}return v},_treatAttributeIfNeeded:function(t,v,u){v=this._escapeAttributeIfNeeded(t,v,u);if(u&&u.breakline){v=this._breakLineAttributeIfNeeded(t,v,u)}return v},_doPreSaveOperations:function(u,w,t){var v={};if(!u||b.is(u,"object")){v=u||{};t=w||{}}else{v[u]=w;t=t||{}}v.update=g.getCurrentDate();this.addChanges(v,t);t.data={};t.data=b.extend({},this._changes);if(this.has(this._modelIdAttribute)){t.data.mid=this.get(this._modelIdAttribute)}return t},_doPostSaveOperations:function(){var t=undefined;for(t in this._previousChanges){if(this._previousChanges.hasOwnProperty(t)){delete this._previousChanges[t]}}for(t in this._changes){if(this._changes.hasOwnProperty(t)){this._previousChanges[t]=this._changes[t]}}},_defineOwnAssociations:e,init:function(w,t){try{var v,y,A=w,x=d.getBaseUrl(),C=b.merge({},t),u=this._attributesMapping,B=function(){var D=[];y.forEach(function(E){if(!A.hasOwnProperty(E)){D.push(E)}});return D};this.urlRoot=(C.urlRoot||x);A=A?this.applyAttributesMapping(A):{};this.defaults=v=this.applyAttributesMapping(this.defaults);y=Object.keys(this.defaults);y.forEach(function(D){if(u.hasOwnProperty(D)){delete v[D]}});this._dispatchers={};this._attributes={};if(A.hasOwnProperty(this._modelIdAttribute)){this._attributes[this._modelIdAttribute]=A[this._modelIdAttribute];this._attributes.id=A.id}if(C.hasOwnProperty("cacheKey")){this._cacheKey=t.cacheKey}if(C.provokeCacheUpdates===false){this._provokeCacheUpdates=false}this._changes={};this.lastCallsParams={};this._previousChanges={};this._customProperties={};this._parent(A,C);if(!i.isModelInCache(this)||(this._provokeCacheUpdates===false)){this._defineOwnAssociations();this.addEvents({onSync:function(){this._customProperties.beingFetched=false},onError:function(){this._customProperties.beingFetched=false}},this,10000)}if(this.getCacheId()&&this.getCacheKey()&&(this._provokeCacheUpdates!==false)){C.cachePrioritaryFields=B();i.followUpForCacheUpdates(this);i.populate(this,C)}if(this._customProperties.fetched!==true){this.addEventOnce("onSync:read",function(){this._customProperties.fetched=true},this,10000)}return this}catch(z){console.error(z)}},isNew:function(){if(!this._parent.apply(this,arguments)){return this.get("mid")==="0"}else{return true}},shouldProvokeCacheUpdates:function(){return this._provokeCacheUpdates},hasBeenFetched:function(){return(this._customProperties.fetched===true)},isBeingFetched:function(){return(this._customProperties.beingFetched===true)},extractValue:function(){return q.extractValue.apply(this,arguments)},applyMapping:function(){return q.applyMapping.apply(this,arguments)},applyAttributesMapping:function(){return q.applyAttributesMapping.apply(this,arguments)},applyServiceParamsMapping:function(){return q.applyServiceParamsMapping.apply(this,arguments)},adaptService:function(){return q.adaptService.apply(this,arguments)},getAttributes:function(w,v){var u={},x;if(w&&(w.length>0)&&Array.isArray(w)){w.forEach(function(y){u[y]=this.get(y,v)},this)}else{x=this._attributes;for(var t in x){if(x.hasOwnProperty(t)){u[t]=this.get(t,v)}}}return u},getCustomProperty:function(t){return this._customProperties[t]},setCustomProperty:function(t,u){this._customProperties[t]=u},deleteCustomProperty:function(t){delete this._customProperties[t]},getModelName:function(){return this._modelName},getModelIdAttribute:function(){return this._modelIdAttribute},getTableName:function(){return this._tableName},addChanges:function(y,v,B){var x=null,z={},u,t=false,w=[],A=b.extend({},this._changes);switch(b.typeOf(y)){case"string":z={};z[y]=v;break;case"object":z=y;case false:B=v;break;default:break}if(!B){B={}}if(!this._validate(z,B)){return false}u=b.extend({},z);if(!B.hasOwnProperty("force")||(B.force!==true)){for(x in u){if(u.hasOwnProperty(x)&&u[x]===this.get(x)){delete u[x];if(this._changes[x]!==undefined){w.push(x)}}}this.removeChanges(w)}this._changes=b.extend(this._changes,u);if(!B||B&&B.silent!==true){for(x in z){if(z.hasOwnProperty(x)&&(A[x]!==z[x])){t=true;this.dispatchEvent("onVirtualChange:"+x,[this,this._changes.hasOwnProperty(x)?z[x]:this.get(x),B])}}if(t===true){this.dispatchEvent("onVirtualChange",[this,B])}}return true},removeChanges:function(w){var v=undefined,t,x=null,u=false;switch(b.typeOf(w)){case"string":x=[];x.push(w);break;case"array":x=w;break;default:break}if(!x){for(v in this._changes){if(this._changes.hasOwnProperty(v)){u=true;delete this._changes[v]}}}else{for(v=0,t=x.length;v<t;v++){u=true;delete this._changes[x[v]]}}if(u===true){this.dispatchEvent("onVirtualChange",[this])}return true},getChanges:function(u){var t=null;if(!u){t=b.extend({},this._changes)}else{if(typeof u==="string"){t=b.clone(this._changes[u],false)}else{if(Array.isArray(u)){t={};u.forEach(function(v){if(typeof v==="string"&&typeof this._changes[v]!=="undefined"){t[v]=b.clone(this._changes[v],false)}},this)}}}return t},hasVirtuallyChanged:function(t){if(t){return Boolean(this._changes[t])}for(var u in this._changes){if(this._changes.hasOwnProperty(u)){return true}}return false},get:function(v,w){var y,x,u,t=void 0;if(typeof v==="string"){y=v.split("->");t=this._parent(y[0]);u=y.length;if(u>1){x=1;while((x<u)&&t&&typeof(t)==="object"){t=t[y[x]];++x}}}return this._treatAttributeIfNeeded(v,t,w)},validate:function(u){var t,v=null;if(typeof this.validateField==="function"){if(b.is(u,"object")){for(v in u){if(u.hasOwnProperty(v)){t=this.validateField(v,u[v]);if(t){return v+":"+t}}}}}return false},set:function(u,w,t){var v;if(!u){return this}v=this.applyAttributesMapping(u,w);return this._parent(v,w||t)},sync:function(){this._customProperties.beingFetched=true;return q.sync.apply(this,arguments)},parse:function(w,u){var v=(b.is(w,"object")||!b.is(w,"string"))?w:c.decode(w),t=v&&v.result?v.result:v;switch(u.serviceName){case"update":case"create":case"patch":if(b.is(t,"object")){t=b.merge(t,this._previousChanges)}else{t=b.merge({},this._previousChanges)}break;default:break}if(typeof u.parse==="function"){t=u.parse.call(this,t,u)}else{t=this._parent(t,u)}if(typeof u.postProcess==="function"){u.postProcess.call(this,w,u,t)}return t},fetch:function(t){if(t){if(typeof t.onComplete==="function"){t.originalOnComplete=t.onComplete}if(typeof t.onFailure==="function"){t.originalOnFailure=t.onFailure}}if(t&&t.fromCache===true){var u=b.extend({},t);u.autoPopulate=true;if(typeof u.onComplete==="function"){u.onPopulate=u.onComplete}delete u.fromCache;return i.populate(this,u)}return this._parent.apply(this,arguments)},save:function(u,y,t){var x,v=false,w=undefined;if(this.isNew()){t=t||{};w=t.onComplete;t.onComplete=function(){if(!i.isModelInCache(this)){i.followUpForCacheUpdates(this);i.populate(this)}if(typeof(w)==="function"){return w.apply(this,arguments)}}.bind(this)}x=this._doPreSaveOperations(u,y,t);v=this._parent(x.data,x);this._doPostSaveOperations();return v},destroy:function(t){if(!this.isNew()){t=t||{};if(t.wait===undefined){t.wait=true}return this._parent.call(this,t)}else{throw new Error("Model id is not available")}},dispatchEvent:a,equals:function(t){if(this===t){return true}else{var u;if(t instanceof q){u=this.get(this.idAttribute);if(u){return(u===t.get(this.idAttribute))}}}return false},action:function(w,t){var x,u,y,v=this;t=t||{};if(t.parse===undefined){t.parse=true}x=t.onComplete;t.onComplete=function(A){var z;z=v.parse(A,t);if(z!==null&&typeof z==="object"){if((t.set!==false)&&!(v.set(z,t))){return false}}if(x){x(v,A,t)}return v.dispatchEvent("onSync",[v,A,t])};u=t.onFailure;t.onFailure=function(z){if(u){u(v,z,t)}v.dispatchEvent("onError",[v,z,t])};y=this.sync(w,this,t);return y},hasAssociation:function(t){return b.owns(this._associations,t)},getAssociated:function(){return q.getAssociated.apply(this,arguments)},hasAssociated:function(){return q.hasAssociated.apply(this,arguments)},setAssociated:function(){return q.setAssociated.apply(this,arguments)},getDelayedSyncTask:d.getDelayedSyncTask,getId:function(){return(this.get("id")||this.cid)},getCacheKey:function(){return this._cacheKey||this._modelName},getCacheId:function(){return this.get(this._modelIdAttribute)},"onSync:update":function(){this.removeChanges()},"onSync:patch":function(){this.removeChanges()},"onSync:create":function(){this.removeChanges()}});q.extractValue=function(v,u,t){var x=undefined;if(b.is(v,"stringad")&&b.is(u,"object")){x=u[v];if(b.is(t,"object")){if(!x){for(var w in u){if(u.hasOwnProperty(w)&&t[w]===v){x=u[w]}}}}}return x};q.applyMapping=function(x,w){var v=undefined,z=undefined,y,u,t={};if((typeof(w)==="object")&&(typeof(x)==="object")&&(w!==null)&&(x!==null)){for(v in x){if(x.hasOwnProperty(v)){u=x[v];if((typeof(u)==="object")&&(u!==null)){for(z in u){if(w.hasOwnProperty(v+"->"+z)){t[w[v+"->"+z]]=u[z]}}}if(!w.hasOwnProperty(v)){t[v]=x[v]}else{u=t[w[v]];if((typeof(u)==="object")&&(u!==null)&&(typeof(x[v])==="object")){b.extend(u,x[v])}else{t[w[v]]=x[v]}}}}for(v in t){if(t.hasOwnProperty(v)){y=v.split("->",2);if(y.length===2){t[y[0]]=t[y[0]]||{};t[y[0]][y[1]]=t[v];delete t[v]}}}}return t};q.applyAttributesMapping=function(w,y){var u=undefined,t,v={},x={};switch(typeof(w)){case"object":if(w!==null){v=b.extend({},w)}break;case"string":v[w]=y;break;default:break}if(this._attributesMapping){x=q.applyMapping(v,this._attributesMapping);if(this._attributes){for(u in x){if(x.hasOwnProperty(u)&&b.is(x[u],"object")){t=this.get(u);if(b.is(t,"object")){x[u]=b.extend(b.merge({},t),x[u])}}}}}else{x=v}this._updateIdAttribute(x);return x};q.applyServiceParamsMapping=function(u,t){if(b.is(u,"object")&&b.is(t,"object")&&b.is(t.paramsMapping,"object")){u=q.applyMapping(u,t.paramsMapping)}return u};q.adaptService=function(t){if(b.is(t,"object")){if(!b.is(t.method,"string")){t.method="POST"}var w,u=b.is(t.dataType)?t.dataType:(t.method.toLowerCase()==="post"?"json":null),v=t.url;t.dataType=u;w=this.urlRoot||d.getBaseUrl();if(typeof(v)==="string"&&!v.contains("://")&&(v.indexOf(w)!==0)){t.url=w+((v[0]==="/"||w[w.length-1]==="/")?"":"/")+v}if(t.noParam===true){t.data=null}else{if(!b.is(t.data,"object")){t.data={}}if(typeof t.dataFn==="function"){t.data=t.dataFn.call(this,t.data)}if(t.data){t.data=q.applyServiceParamsMapping(t.data,t)}}n.call(this,t)}return t};q.sync=function(z,w,v){var x=false;if(window.ds){var u=h.getInstance();if(!u.getCSRFToken()&&(ds&&ds.env==="3DSwym")){var t=false;x={cancel:function(){t=true}};var y=this;u.addEventOnce("onSync",function(){if(!t){var A=this._callService(z,w,v);if(A&&A.cancel){x.cancel=A.cancel.bind(A)}}},y)}}if(!x){return this._callService(z,w,v)}return x};q.STATUS={notRequested:0,pending:1,valid:2,invalid:3};q.getModuleNameFromModelName=function(u,t){var v={question:"iquestion",ideation:"idea",wikipage:"wiki",wikiroot:"wiki",instantmessage:"instant-message",message:"instant-message",comment:"instant-comment",dm:"direct-message"};if(typeof(t)!=="string"){t="/feature/community/"}if(v[u]){u=v[u]}if(u==="direct-message"){t="/feature/core/"}return"DS/SwymUICore/script"+t+u+"/model/"+u+"-model"};q.saveModelWithDefaultParams=function(t,v,u){require([q.getModuleNameFromModelName(t),"DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(y,B){var x=u?b.clone(u,false):{},A=x.onComplete,z={published:0,author:B.getInstance().get("user")},w=new y();x.onComplete=function(){if(w.getCacheId()&&w.getCacheKey()&&(w.shouldProvokeCacheUpdates()!==false)){i.populate(w,{areModelDataFromServer:true})}return A.apply(this,arguments)};w.save(b.extend(z,v),x)})};q.defineOwnAssociations=e;q.hasAssociated=function(t){if(this.hasOwnProperty("_associations")&&this._associations[t]&&this._associations[t].associated){return this._associations[t].associated}else{return false}};q.getAssociated=function(y){if(!this.hasOwnProperty("_associations")){this._defineOwnAssociations()}if(!this.hasOwnProperty("_associations")){throw new Error("Instance own associations are not available")}var w,u,v,x=null,t=this._associations[y];if(t){w=t.Class||this.constructor.prototype._associations[y].Class;v=t.associated;if(!v){if(!w){throw new Error("No class has been declared for the associated instance. Please establish an association using setAssociated() method before calling getAssociated().")}u=b.merge({urlRoot:this.urlRoot},t.options);if(this instanceof l){x=this.get(t.sourceAttribute||y)}if(w.prototype instanceof l){if(!b.is(x,"object")){x={}}if(!b.is(u.provokeCacheUpdates,"boolean")){u.provokeCacheUpdates=this._provokeCacheUpdates}}else{if(!b.is(x,"array")){x=[]}if(u.mode===undefined){u.mode=y}}if(u.areModelDataFromServer!==false){u.areModelDataFromServer=true}v=new w(x,u);this.setAssociated(y,v);if(t.oppositeRole){v.setAssociated(t.oppositeRole,this)}if(t.autoFetch===true){v.fetch({fromCache:true})}}return v}else{throw new Error("The requested association is missing from associations declaration")}return null};q.setAssociated=function(x,v){if(!this.hasOwnProperty("_associations")){this._defineOwnAssociations()}if(!this.hasOwnProperty("_associations")){throw new Error("Instance own associations are not available")}if(x&&v){var w,t=this._associations[x],u=t.Class||this.constructor.prototype._associations[x].Class;if(t){if(!(u&&!(v instanceof u))){w=t.associated;t.associated=v;if(w&&!v.equals(w)){w.dispatchEvent("onReplace:"+x,[w,v,this])}this.dispatchEvent("onSetAssociated:"+x,[this,w,v]);return v}else{throw new Error("Provided argument is not an instance of expected class")}}else{throw new Error("Provided role is missing from associations declaration")}}else{throw new Error("Invalid arguments")}return null};q.parentSync=function(A,w,v){var x,t,z,u,y;if(!b.is(v)){v={}}t=o[A];b.merge(v,{emulateHTTP:false,emulateJSON:false});z={method:t};if(!v.url){z.url=(m(w,"url"))||p()}if((!b.is(v.data))&&w&&(A==="create"||A==="update"||A==="patch")){z.type="json";z.data=v.attrs||(w.toJSON(v))}if(v.emulateJSON){z.type="application/x-www-form-urlencoded";z.data=z.data?{model:z.data}:{}}if(v.emulateHTTP&&(t==="PUT"||t==="DELETE"||t==="PATCH")){z.method="POST";if(v.emulateJSON){z.data._method=t}x=v.beforeSend;v.beforeSend=function(B){B.setRequestHeader("X-HTTP-Method-Override",t);if(x){return x.apply(this,arguments)}}}if(z.method!=="GET"&&!v.emulateJSON){z.processData=false}u=b.extend(z,v);y=v.request=j.request(u);w.dispatchEvent("onRequest",[w,y,v]);return y};q.dispatchEvent=a;return q});define("DS/SwymUICore/script/lib/collection/generic/swym-collection",["UWA/Core","UWA/Json","UWA/Class/Collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console","DS/SwymUICore/script/utils/utils"],function(f,b,d,a,c,e){var g=d.extend({_collectionName:null,_services:null,_associations:null,_fetched:false,_beingFetched:false,lastCallsParams:null,lastCalledService:null,model:a,mode:null,modes:null,communityId:null,_callService:function(l,k,i){var h,j=this._services;if(!i){i={}}i.areModelDataFromServer=true;if(!l){throw new Error("Method is required")}h=j&&j[l]&&j[l][this.mode];if(!f.is(h,"object")){throw new Error('No service has been declared for method "'+l+'" and mode "'+this.mode+'"')}if(this.mode){i=f.merge(i,f.extend({},h))}else{throw {name:"Mode not provided",message:"This call cannot be done without specifying the mode."}}if(i.parse===true&&h&&typeof h.parse==="function"){i.parse=h.parse}if(!i.postProcess&&h&&typeof h.postProcess==="function"){i.postProcess=h.postProcess}i.serviceName=l;a.adaptService.call(this,i);this.lastCalledService=l;this.lastCallsParams[l][this.mode]=i.data;return a.parentSync.call(this,l,k,i)},_defineOwnAssociations:a.defineOwnAssociations,init:function(n,i){var k,h=undefined,l=this,j=this._services;i=i||{};this._checkModel(i);this.modes=this.modes||[];this.setMode(i.mode);this.lastCallsParams={};this.urlRoot=i.urlRoot||e.getBaseUrl();if(j){for(h in j){if(j.hasOwnProperty(h)){this.lastCallsParams[h]={}}}}if(f.is(this._associations,"object")){this._associations=f.extend({},this._associations||{});k=Object.keys(this._associations||{});k.forEach(function(o){this._associations[o]=f.extend({},this._associations[o]||{})},this)}else{this._associations={}}this.addEvents({onSync:function(o){if(o===this){this._beingFetched=false}},onError:function(o){if(o===this){this._beingFetched=false}}},this,10000);this.addEventOnce("onSync:read",function(o){if(o===this){this._fetched=true}},this,10000);var m=e.getDelayedSyncTask(function(){var o=[];if(arguments.length>=1){o=Array.prototype.slice.call(arguments,arguments.length-1)}l.dispatchEvent("onCollectionChange",o)});this.addEventOnce("onSync",function(){this._fetched=true});this.addEvents({onAdd:m,onRemove:m,onSort:m,onReset:m});return this._parent(n,i)},_getRefreshParams:function(h){var i;h=h||this.lastCalledService||"read";i=(this.lastCallsParams[h]&&this.mode&&this.lastCallsParams[h][this.mode]);i=(f.is(i,"object")?f.clone(i):(b.isJson(i)?b.decode(i):{}));if(i.params){i=i.params}return f.is(i,"object")?i:{}},_checkModel:function(j){var i=this.model,h;if(f.is(j,"object")&&j.model instanceof a&&this.model instanceof a){if(j.model.prototype instanceof this.model){i=j.model}else{if(h=this.model.prototype.getModelName()){throw new Error("Provided model Class is not and does not derive from "+h.ucfirst()+" Class")}else{throw new Error("Provided model Class is not and does not derive from expected Class")}}}return i},setMode:function(i){var h=this.mode;if(i){if(this.modes.indexOf(i)>=0){this.mode=i;this.dispatchEvent("onModeChange",[this,i])}else{throw {name:"Unknown mode provided",message:"The mode provided is not present in this collection's 'modes' parameter"}}}return h},getCollectionName:function(){return this._collectionName},indexOf:function(h,k){var i,j=this._parent(h,k);if(j>=0){return j}else{i=this.get(h);return i?this._parent(i,k):-1}},lastIndexOf:function(h,j){var i=this.get(h);return i?this._parent(i,j):-1},set:function(i,h){if(!h){h={parse:true}}else{if(typeof h.parse==="undefined"){h.parse=true}}return this._parent.call(this,i,h)},sync:function(){this._beingFetched=true;return a.sync.apply(this,arguments)},parse:function(j,p){var o=(!f.is(j,"string"))?j:f.Json.decode(j),m=(o&&o.result)?o.result:o;if(typeof p.parse==="function"){m=p.parse.call(this,m,p);p.parse=true}else{m=this._parent(m,p)}if(typeof p.postProcess==="function"){p.postProcess.call(this,j,p,m);delete p.postProcess}if(this.model&&(this.model.prototype instanceof a)&&f.is(m,"array")){var h,q=[],n=this.model.prototype;for(var k=0,l=m.length;k<l;k++){h=m[k];if(h instanceof a){q.push(h)}else{q.push(n.applyAttributesMapping(h))}}return q}return m},create:function(i,h){h=h||{};if(h.wait===undefined){h.wait=true}this._parent.call(this,i,h)},dispatchEvent:a.dispatchEvent,_onModelEvent:function(j,i,k,h){switch(j){case"onDestroy":return this.dispatchEvent(j,[i,k,h]);case"onSync:delete":this.remove(i,h);default:return this._parent.apply(this,arguments)}},action:function(k,h){var l,i,m,j=this;h=h||{};if(h.parse===undefined){h.parse=true}l=h.onComplete;h.onComplete=function(n){if(h.reevaluateOptions){h.reevaluateOptions(j,n,h)}j[h.reset?"reset":"set"](n,h);if(l){l(j,n,h)}return j.dispatchEvent("onSync",[j,n,h])};i=h.onFailure;h.onFailure=function(n){if(i){i(j,n,h)}j.dispatchEvent("onError",[j,n,h])};m=this.sync(k,this,h);return m},refresh:function(i,h){h=h||{};h.data=h.data||{};i=i||this.lastCalledService||"read";f.merge(h.data,this._getRefreshParams(i)||{});return this.action(i,h)},equals:function(h){return(this===h)},hasAssociation:function(h){return f.owns(this._associations,h)},getAssociated:a.getAssociated,setAssociated:a.setAssociated,getDelayedSyncTask:e.getDelayedSyncTask,hasBeenFetched:function(){return this._fetched},isBeingFetched:function(){if((this._beingFetched===true)&&this.mode&&this.lastCalledService&&this.lastCallsParams[this.lastCalledService][this.mode]){return true}return false},getId:function(){if(typeof this.id==="function"){return this.id()}else{return(this.id||this.cid)}}});return g});define("DS/SwymUICore/script/feature/core/language/collection/language-list-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console","DS/WAFData/WAFData","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/UWPClientCode/I18n"],function(e,d,h,c,f,g,i){var a=d,b=a.extend({_services:{read:{getlanglist:{url:"api/SpokenLanguage/getlanglist"}}},_collectionName:"language-list-collection",model:h.extend({_modelName:"list-language-model"}),comparator:function(j){return(j.get("translated")||j.get("lang_english"))},_callNlsTranslationToTagger:function(m){var o=g.getInstance().get("config").tenant.tag_server_url,p=b.getCollection(),k=[],q;for(var n=0,j=p.length;n<j;n++){q=p.at(n);k.push(q.get("iso_code"))}f.authenticatedRequest(o+"/resources/6WVocab/access/PredicateValue",{data:JSON.stringify({"ds6w:language":k}),type:"json",method:"POST",timeout:60000,headers:{"Accept-Language":i.getCurrentLanguage(),Accept:"application/json","Content-Type":"application/json"},onComplete:function(r){var t=r["ds6w:language"];for(var u=0,s=p.length;u<s;u++){q=p.at(u);q.set("translated",t[q.get("iso_code")])}m.onComplete(p);b.prototype.dispatchEvent("globalSync",p)},onFailure:function(r,l){console.log(r);console.log(l);m.onComplete(p);b.prototype.dispatchEvent("globalSync",p)}})},fetchOnce:function(j){var k=b.getCollection();if(k===null){if(b.isBeingFetched===false){b.isBeingFetched=true;this.fetch({onComplete:function(l){b.setCollection(l);this._callNlsTranslationToTagger(j)}.bind(this)})}else{b.prototype.addEvent("globalSync",function(l){j.onComplete(l)}.bind(this))}}else{j.onComplete(k)}},modes:["getlanglist"]});b.isBeingFetched=false;b.collection=null;b.setCollection=function(j){b.collection=j};b.getCollection=function(j){return b.collection};return b});define("DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection"],function(a,c){var b=c.extend({_pages:null,_currentPage:null,_previousPage:null,_pageMode:"page",_limit:10,_previousTotalItems:null,_totalItems:null,_infiniteScroll:false,_reachedLastPage:null,paginationMode:"NORMAL",paginationModes:["NORMAL","PREV_NEXT"],_setCurrentPage:function(e,d){e=parseInt(e,10);if(a.is(e,"number")&&(e!==this._currentPage)){this._currentPage=e;if(d===true){this.resetCollection()}}},_addPage:function(f,d,e){this._pages[d]={models:f,totalItems:e}},_removePage:function(d){delete this._pages[d]},_removePages:function(g,f){g=parseInt(g,10);if(f){var e=this._pages;for(var d in e){if(e.hasOwnProperty(d)&&(d>=g)){delete e[d]}}}else{this._removePage(g)}},_removeAllModels:function(d){var e=this.slice();this.remove(e,d);return e},_rollbackPageChange:function(){this._currentPage=this._previousPage;this._previousPage=null},_isNewPage:function(d){var e=null,f=this._pageMode;if((typeof d==="number"||typeof d==="string")){e=parseInt(d,10)}else{if(typeof d==="object"){if(d[f]){e=parseInt(d[f],10)}else{throw {name:"No parameter "+f+" set",message:"A parameter "+f+" needs to be set for a fetch to be done"}}}else{throw new Error("Invalid arguments")}}if(e===this._currentPage){return false}return e},_setPage:function(e,d){if(d!==false){e=this._isNewPage(e)}if(e!==false){this._previousPage=this._currentPage;this._setCurrentPage(e)}return e},_containsNbResultsProperty:function(e){var d=false;if(e){if(e.hasOwnProperty("nb_result")){d="nb_result"}else{if(e.hasOwnProperty("nhits")){d="nhits"}}}return d},init:function(e,d){if(!d){d={}}this.setPageMode(d.pageMode);if(d.limit>0){this.setLimit(d.limit)}else{throw {name:"No limit specified",message:"In a paginated collection, a limit must be defined on init"}}this._pages={};if(d.paginationMode){this.paginationMode=d.paginationMode}if(typeof(d.currentPage)==="number"){this._setPage(d.currentPage)}if(d.hasOwnProperty("infiniteScroll")){this._infiniteScroll=(d.infiniteScroll===true)}return this._parent(e,d)},getPageMode:function(){return this._pageMode},setPageMode:function(e){var d=this._pageMode;if(e==="page"||e==="start"||e==="pageStartAtZero"){this._pageMode=e}return d},getCurrentPage:function(){return this._currentPage},getLimit:function(){return this._limit},setLimit:function(d,e){d=parseInt(d,10);if((d>0)&&(d!==this._limit)){this._limit=d;if(e===true){this.resetCollection()}}},getTotalItems:function(){return this._totalItems},setTotalItems:function(d){this._previousTotalItems=this._totalItems;this._totalItems=parseInt(d,10)},set:function(h,f){var g,e,d;if((this.hasBeenFetched()===true)&&(this._containsNbResultsProperty(h)===false)&&!(f&&f.silent===true)){g=this.length;e=this.getTotalItems();d=this._parent.apply(this,arguments);if((this.length-g)!==(this.getTotalItems()-e)){this.setTotalItems(e+(this.length-g))}}else{d=this._parent.apply(this,arguments)}return d},remove:function(){var f=this.length,e=this.getTotalItems(),d=this._parent.apply(this,arguments);if((this.hasBeenFetched()===true)&&((this.length-f)!==(this.getTotalItems()-e))){this.setTotalItems(e+(this.length-f))}return d},getLastPageNum:function(){var e,d=this.getLimit(),g=this.getTotalItems(),f=this.getCurrentPage();if(f&&(g||(this._reachedLastPage!==true))){if(this.paginationMode==="PREV_NEXT"){if(this.length>=d||g===d){if(g===d){e=f+1}else{if(g>d){e=parseInt(g/d,10);if((g%d)>0){e++}}else{e=f}}}else{e=f}}else{e=parseInt(g/d,10);if((g%d)>0){e++}}return e}else{return(this.currentPage||1)}},hasPrevious:function(){return(this._currentPage>1)},hasNext:function(){var d=this.getLastPageNum();if(d>1){if(this.paginationMode!=="PREV_NEXT"){return(d>this._currentPage)}return(d!==this._currentPage)}return !this.hasBeenFetched()&&!this.isBeingFetched()},resetCollection:function(e,d){this._pages={};this._previousPage=null;if(e){this._setCurrentPage(e)}this.fetchPage(this._currentPage,d);this.dispatchEvent("onReset",[this,d])},goToPage:function(e,f){var h,g,d;g=this._isNewPage(e);if(!f){f={}}if(a.is(g,"number")){if(this._pages.hasOwnProperty(g)){this.dispatchEvent("onBeforePageChange",[this,this._currentPage,this._previousPage]);g=this._setPage(g,false);h=this.toArray();if(h.length>0&&this._previousPage){d=this._previousPage;this._addPage(h,d,this.getTotalItems())}h=this._pages[g].models;this.setTotalItems(this._pages[g].totalItems);this.reset(h,f);this._removePage(g);this.dispatchEvent("onAfterPageChange",[this,this._currentPage])}else{return this.fetchPage(e,f)}}},fetchPage:function(j,l){var g,d,h,f,e,k=j,i=this.lastCalledService;g=this._isNewPage(j);if(!l){l={}}if((i!==l.serviceName)||l.ignoreCache===true){this.dispatchEvent("onBeforePageChange",[this,this._currentPage,this._previousPage]);g=this._setPage(g,false);d=this.toArray();h=l.onComplete;l.onComplete=function(p,o,m){if(p._currentPage>1&&(p.length===0)&&!p._emptyCalls){p._removePages(1,true);p.goToPage(parseInt(p._currentPage)-1)}else{if(((m.ignoreCache!==true)&&(p._infiniteScroll!==true))&&(i===p.lastCalledService)&&(d.length>0)&&p._previousPage){var n;if(m.parse){n=p._previousTotalItems}else{n=p.getTotalItems()}if(p._currentPage===k){p._removePages(k,true)}else{p._addPage(d,String(p._previousPage),n)}}if(h){h.call(p,p,o,m)}p.dispatchEvent("onAfterPageChange",[p,p._currentPage])}};f=l.onFailure;l.onFailure=function(o,n,m){o._rollbackPageChange();if(f){f.call(o,o,n,m)}}}if(!l.data){l.data={}}e=this._getRefreshParams(l.serviceName);if(e){a.merge(l.data,e)}if(g&&(l.reset!==false)){l.reset=true}return this.action(l.serviceName||this.lastCalledService||"read",l)},sync:function(h,e,f){if(this._currentPage===null){this._currentPage=1}var d={limit:this._limit},g=f||{};if(!g){g={}}if(g.data){if(this.getPageMode()==="page"){d.page=this._currentPage;delete g.data.start}else{if(this.getPageMode()==="pageStartAtZero"){d.page=this._currentPage-1;delete g.data.start}else{d.start=(this._currentPage-1)*this._limit;delete g.data.page}}}g.data=a.extend(g.data||{},d);if(this.lastCalledService&&this.lastCalledService!==h){this._removePages(1,true)}return this._parent(h,e,g)},parse:function(j,f){var d,h,i=false,e=null,g=(!a.is(j,"string"))?j:a.Json.decode(j);if(g){e=this._containsNbResultsProperty(g)}if(e){this._reachedLastPage=null;if(Array.isArray(g.result)&&((typeof(g[e])==="undefined")||(g.result.length>g[e]))){d=g.result.length}else{d=g[e];i=true}this.setTotalItems(d)}h=this._parent(j,f);if(i){if(Array.isArray(h)&&h.length<this._limit){this._reachedLastPage=true}}return h},setMode:function(e){var d=this._parent(e);if(d!==this._mode){this._removePages(1,true)}return d},"onSync:delete":function(){},getNbLoadedModels:function(){var e=this._models.length;for(var d in this._pages){if(this._pages.hasOwnProperty(d)){e+=this._pages[d].models.length}}return e}});return b});define("DS/SwymUICore/script/feature/core/user/model/users-group-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/Logger/Logger"],function(e,a,d,b){var c=a.extend(d,{_modelName:"users-group",_modelIdAttribute:"subject6wuri",_attributesMapping:{id:"id",resourceid:"subject6wuri",uri:"subject6wuri"},defaults:{subject6wuri:undefined,name:"",nb_members:-1},_updateIdAttribute:function(f){return f}});return c});define("DS/SwymUICore/script/feature/community/idea/model/status-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){var b=a.extend({_modelName:"status",_attributesMapping:{id:"mid"}});return b});define("DS/SwymUICore/script/feature/community/survey/model/answer-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){var b=a.extend({_modelName:"survey-answer",HTML_ATTRIBUTES:["description","custom_text"],getPercentage:function(){var c;if(parseInt(this.get("nbVotes"),10)===0){c="0"}else{if(this.collection){c=parseFloat(this.get("nbVotes")/this.collection.getTotalVotes()*100,10).toFixed(1)}else{console.warn("Something is trying to access the collection but it is not defined and maybe not used at all ?");c=0}}return c},getRoundedPercentage:function(){var e=this,d,h=this.collection;if(h&&h.indexOf(e)===(h.length-1)){var g=0;for(var f=0,c=h.length;f<(c-1);f++){g+=parseFloat(h.at(f).getPercentage())}if(parseInt(e.get("nbVoters"),10)!==0){d=parseFloat(100-g).toFixed(1)}else{d="0"}}else{d=e.getPercentage()}return d}});return b});define("DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection",["UWA/Core","UWA/Json","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/6wtag/model/6wtag-model","DS/SwymUICore/script/lib/6wpanel/utils","DS/WebappsUtils/Console"],function(g,f,d,e,c,b){var a=d.extend({_collectionName:"6wtag-collection",_associations:{tagged:{}},_defaultParsingFn:function(h,j){var i=[];if(g.is(h,"array")){if(h.length>0&&h[0].sixw&&h[0].object){i=h}}else{if(j.tagsWithoutSubjectURI===true){i=c.extractTagsFromExaleadResponse(h)}}return i},_defaultPostProcessFn:function(l,r,q){var m,n,s,k={},p=[],j,h;try{j=this._associations.tagged.associated;if(j){h=j.getSixwURIs();n=h&&h.length;if(n>0){for(m=0;m<n;m++){k[h[m]]=[]}}}}catch(o){}if(l&&l.tags&&Array.isArray(l.tags)&&(l.tags.length>0)){p=l.tags}else{if(g.is(q,"array")&&q.length>0){for(m=0,n=q.length;m<n;m++){s=q[m];if(s&&(typeof s==="object")){if(s.subjectURI){k[s.subjectURI]=k[s.subjectURI]||[];k[s.subjectURI].push(s)}else{p.push(s)}}}}}this._tagsWithSubjectURIData=k;this._tagsWithoutSubjectURIData=p},_services:{read:{"mixed-collection:whats-new":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:true},"mixed-collection:community":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:true},"post-collection:all":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"post-collection:community":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"media-collection:all":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"media-collection:communityMedia":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"media-collection:mediaByTenant":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"media-collection:communityHighSemanticMedia":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"iquestion-collection:published":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"iquestion-collection:communityPublished":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"iquestion-collection:communityQuestionsPublishedNotValidated":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"idea-collection:community":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"idea-collection:community-full-list":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"survey-collection:community-surveys":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"wiki-collection:community":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"wiki-collection:communityLastUpdatedWiki":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"mixed-collection:search":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"mixed-collection:customlist":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"community-collection:my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true},"community-collection:all-my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true},"community-collection:discover-communities":{url:"api/exalead/searchdiscovercommunities",tagsWithoutSubjectURI:true},"community-collection:tenant-communities":{url:"api/exalead/search",tagsWithoutSubjectURI:true},"community-collection:my-communities-detailed":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true},"community-collection:my-non-dm-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true},"user-collection:listmembers":{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:true},"member-collection-v2:listmembers":{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:true},"community-tl-collection:community":{method:"GET",url:"api/community/timeline",tagsWithoutSubjectURI:true,data:{limit:0}}}},model:e,mode:null,modes:["mixed-collection:whats-new","mixed-collection:community","post-collection:all","post-collection:community","media-collection:all","media-collection:communityMedia","media-collection:mediaByTenant","media-collection:communityHighSemanticMedia","iquestion-collection:published","iquestion-collection:communityPublished","iquestion-collection:communityQuestionsPublishedNotValidated","idea-collection:community","idea-collection:community-full-list","survey-collection:community-surveys","wiki-collection:community","wiki-collection:communityLastUpdatedWiki","mixed-collection:search","mixed-collection:customlist","community-collection:my-communities","community-collection:all-my-communities","community-collection:discover-communities","community-collection:tenant-communities","community-collection:my-communities-detailed","community-collection:my-non-dm-communities","user-collection:listmembers","member-collection-v2:listmembers","community-tl-collection:community"],_tagsWithoutSubjectURIData:null,_tagsWithSubjectURIData:null,init:function(i,h){this._tagsWithoutSubjectURIData=[];this._tagsWithSubjectURIData={};return this._parent(i,h)},parse:function(l,i){try{var j=(!g.is(l,"string"))?l:f.decode(l),h=j&&(j.tags||j.result)||j;i=i||{};if(i.parse===true&&(this.mode?(typeof this._services.read[this.mode].parse!=="function"):(typeof this._services.read.parse!=="function"))){i.parse=this._defaultParsingFn}if(typeof i.postProcess!=="function"&&(this.mode?(typeof this._services.read[this.mode].postProcess!=="function"):(typeof this._services.read.postProcess!=="function"))){i.postProcess=this._defaultPostProcessFn}return this._parent.call(this,h,i)}catch(k){b.error("Error parsing result: "+k.message);return false}},sync:function(k,h,i){try{i=i||{};i.reset=i.reset!==false;i.data=i.data||{};i.data.legacyFormat=c.requestLegacyFormatForExaleadSearches();return this._parent(k,h,i)}catch(j){b.error("Error syncing tag collection: "+j.message)}},create:function(){},getTagsWithoutSubjectURIData:function(){return this._tagsWithoutSubjectURIData},getTagsWithSubjectURIData:function(){return this._tagsWithSubjectURIData},getTagged:function(){return this.getAssociated("tagged")},onTaggedModeChange:function(h,i){try{this.setMode(h.getCollectionName()+":"+i)}catch(j){b.warn(j.message)}},"onSetAssociated:tagged":function(i,k,h){if(h instanceof d){try{this.setMode(h.getCollectionName()+":"+h.mode)}catch(j){b.warn(j.message)}h.addEvent("onModeChange",this.onTaggedModeChange,this)}if(k instanceof d){k.removeEvent("onModeChange",this.onTaggedModeChange,this)}}});return a});define("DS/SwymUICore/script/lib/model/generic/6wtaggable-model",["UWA/Core","UWA/Class","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/6wpanel/6wtaggable","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection"],function(f,a,i,h,d,g,c){var b=function(){var k,j=this.get("subject6wuri");if(j){k=this._getTagSet(this.get("tags6w")||this.get("tags"),this.get("tags6w_implicit"));this.resetTaggingSession();this.getTags().reset(k,{parse:true});return true}return false},e=i.extend(h,{_tagsToSendArray:null,_reformattedTaggingActions6w:null,_associations:{"6wtags":{Class:c,oppositeRole:"tagged",options:{mode:""}}},_attributesMapping:{resourceid:"subject6wuri"},getTags:function(k,j){return this.getAssociated("6wtags")},resetTaggingSession:function(){if(!this._tagsToSendArray||!this._reformattedTaggingActions6w){this._tagsToSendArray={add:[],remove:[]};this._reformattedTaggingActions6w={add:{},remove:{}}}else{this._tagsToSendArray.add=[];this._tagsToSendArray.remove=[];this._reformattedTaggingActions6w.add={};this._reformattedTaggingActions6w.remove={}}this.removeChanges(["tags6w","taggingActions6w"]);return this},_updateTaggingActionsList:function(r,m){if(this.has("subject6wuri")){var n,p,l,q=false,u,j,o={},v=this.get("subject6wuri"),s=this._tagsToSendArray,t=this._reformattedTaggingActions6w,k=(this.getChanges("taggingActions6w")||{add:[{subject:v,tag:[]}],remove:[{subject:v,tag:[]}]});m=(m==="remove")?"remove":"add";u=(m==="remove")?"add":"remove";if(t&&r&&r.object){o.predicate=r.predicate;l=r.predicate+"/"+r.object;o.object={};o.object.literal=r.object;if(t[u][l]){delete t[u][l];j=s[u];for(n=0,p=j.length;n<p;n++){if(j[n].predicate+"/"+j[n].object.literal===l){j.splice(n,1);break}}k[u][0].tag=j;q=true}else{if(!t[m][l]){t[m][l]=o;s[m].push(o);k[m][0].tag=s[m];q=true}}if(q===true){this.addChanges("taggingActions6w",k)}return q}}return false},_getTagSet:function(j,n){var m=[],l,k=this.get("subject6wuri");if(k){m=j||[];m=m.concat(n||[]);l=d.processTagAttribute(k,m,[],"array")}else{l=[]}return l},_recomputeTags:b,init:function(){this._parent.apply(this,arguments);if(!this._recomputeTags){this._recomputeTags=g.getDelayedSyncTask(e.recomputeTags)}if(!this._tagsToSendArray){this._tagsToSendArray={add:{},remove:{}}}if(!this._reformattedTaggingActions6w){this._reformattedTaggingActions6w={add:{},remove:{}}}},getTagsToBeShown:function(){var j,k=new c();k.setAssociated("tagged",this);if(!this.hasVirtuallyChanged("tags6w")){j=f.clone(this.get("tags6w"),false)}else{j=this.getChanges("tags6w")}k.reset(this._getTagSet(j,this.get("tags6w_implicit")));return k},save:function(l,m,k){var j=this._parent(l,m,k);this.resetTaggingSession();return j},onTagCreation:function(o,n){var l,j,m,k;if(n!==true){if(!this.hasVirtuallyChanged("tags6w")){m=f.clone(this.get("tags6w"),false)}else{m=this.getChanges("tags6w")}}else{m=f.clone(this.get("tags6w"),false)}m=m||[];for(l=0,j=m.length;l<j;l++){if(m[l].predicate===o.predicate&&m[l].tag===o.object){k=l;break}}if(typeof(k)!=="undefined"){return null}m.push({predicate:o.predicate,tag:o.object.replace(/\//g,"&#47;")});if(n!==true){this.addChanges("tags6w",m);this._updateTaggingActionsList(o,"add")}else{this.set("tags6w",m)}return this},onTagDeletion:function(o,n){var l,j,m,k;if(n!==true){if(!this.hasVirtuallyChanged("tags6w")){m=f.clone(this.get("tags6w"),false)}else{m=this.getChanges("tags6w")}}else{m=f.clone(this.get("tags6w"),false)}if(f.is(m,"array")){for(l=0,j=m.length;l<j;l++){if(m[l].predicate===o.predicate&&m[l].tag===o.object){k=l;break}}if(typeof k==="undefined"){return null}m.splice(k,1);if(n!==true){this.addChanges("tags6w",m);this._updateTaggingActionsList(o,"remove")}else{this.set("tags6w",m)}}return this},getSixwURIs:function(){var j=[];if(this.has("subject6wuri")){j.push(this.get("subject6wuri"))}return j},deriveTagActionsFromContentChanges:function(o,n,l){var j=undefined,m,k,p;if(f.is(n)){m=f.is(o)?d.get6WTagsFromHTML(o):[];k=d.get6WTagsFromHTML(n);p=(this.get("tags6w")||[]).reduce(function(r,q){r[q.predicate+"/"+q.tag]={predicate:q.predicate,object:q.tag};return r},{});for(j in m){if(m.hasOwnProperty(j)){if(!k.hasOwnProperty(j)){this.onTagDeletion(m[j],false,l&&l.onTagDeletionOptions)}}}for(j in k){if(k.hasOwnProperty(j)){if(!m.hasOwnProperty(j)||!p.hasOwnProperty(j)){this.onTagCreation(k[j],false,l&&l.onTagCreationOptions)}}}}},"onChange:tags6w":function(j,l,k){this._recomputeTags()},"onChange:tags6w_implicit":function(j,l,k){this._recomputeTags()},"onChange:tags":function(j,l,k){this._recomputeTags()},"onChange:subject6wuri":function(j,l,k){this._recomputeTags()}});e.recomputeTags=b;return e});define("DS/SwymUICore/script/feature/core/language/model/language-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(d,a,b){var c=a.extend({_modelName:"language",_services:{create:{url:"api/SpokenLanguage/create",dataFn:function(){return d.merge(this.getChanges(),this._attributes)}},update:{url:"api/SpokenLanguage/update",dataFn:function(){return d.merge(this.getChanges(),this.getAttributes(["mid","language_id","description","level"],{escapeHTML:false}))},paramsMapping:{mid:"id"}},"delete":{url:"api/SpokenLanguage/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{language_id:"af",description:"",level:"1",lang_english:"Afrikaans",lang_native:"Afrikaans",iso_code:"af"},getLevelFromDBToJS:function(){var e=parseInt(this.get("level"));if(e===3||e===4){e--}return e},getStarsHtml:function(){var l='<span class="fonticon fonticon-2x active-blue fonticon-star"></span>',g='<span class="fonticon fonticon-2x unactive-blue fonticon-star"></span>',m="",f=this.getLevelFromDBToJS();for(var h=0;h<f;h++){m+=l}for(var k=0,e=3-f;k<e;k++){m+=g}return m}});return c});define("DS/SwymUICore/script/feature/core/stats/model/pie-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(d,a,c){var b=a.extend({_modelName:"pie",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:false,_attributesMapping:{},_servicesMode:{totalinteractions:{read:{url:"api/analytics/infocommunity",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){var f={nb_ideas:e.nb_ideas,nb_media:e.nb_media,nb_messages:e.nb_messages,nb_posts:e.nb_posts,nb_questions:e.nb_questions,nb_surveys:e.nb_surveys,nb_wikipages:e.nb_wikipages};return this._format(f)}}},totalmediapertype:{read:{url:"api/analytics/totalmediapertype",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalusersperrole:{read:{url:"api/analytics/totalusersperrole",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalquestionsperstatus:{read:{url:"api/analytics/totalquestionsperstatus",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalcommunitiespertype:{read:{url:"api/analytics/totalcommunitiespertype",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalcommunitiespervisibility:{read:{url:"api/analytics/totalcommunitiespervisibility",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}},totalpollsperstatus:{read:{url:"api/analytics/totalpollsperstatus",dataFn:function(){return{tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(e){return this._format(e)}}}},defaults:{},init:function(e,f){var g=f.pieType;switch(g){case"totalinteractions":case"totalmediapertype":case"totalusersperrole":case"totalquestionsperstatus":case"totalcommunitiespertype":case"totalcommunitiespervisibility":case"totalpollsperstatus":this._services=this._servicesMode[g];break}this._communityId=f.communityId;this._tenantId=f.tenantId;this._fromDate=f.fromDate;this._toDate=f.toDate;this._title=f.title;if(d.is(f.asAdmin)){this._asAdmin=f.asAdmin}return this._parent(e,f)},_format:function(f){var g={};for(var e in f){g[e]=parseInt(f[e])}return g},getTitle:function(){return this._title}});return b});define("DS/SwymUICore/script/feature/core/bookmark/model/bookmark-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/6wtaggable-model"],function(c,b){var a=b.extend({_modelName:"bookmark",_attributesMapping:{id:"mid",uri:"community_id"},defaults:{},setup:function(){},destroy:function(d){return this.action("delete",d)}});return a});define("DS/SwymUICore/script/feature/core/skill/model/skill-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(d,a,b){var c=a.extend({_modelName:"skill",_services:{create:{url:"api/skill/create",dataFn:function(){return d.merge(this.getChanges(),this._attributes)}},update:{url:"api/skill/update",dataFn:function(e){return d.merge(this.getChanges(),this.getAttributes(["mid","title","description","level",{escapeHTML:false}]))},paramsMapping:{mid:"id"}},"delete":{url:"api/skill/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{title:"",description:"",level:"1"},getLevelFromDBToJS:function(){var e=parseInt(this.get("level"));if(e===3||e===4){e--}return e},getStarsHtml:function(){var l='<span class="fonticon fonticon-2x active-blue fonticon-star"></span>',g='<span class="fonticon fonticon-2x unactive-blue fonticon-star"></span>',m="",f=this.getLevelFromDBToJS();for(var h=0;h<f;h++){m+=l}for(var k=0,e=3-f;k<e;k++){m+=g}return m}});return c});define("DS/SwymUICore/script/feature/core/interest/model/interest-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(c,a,b){var d=a.extend({_modelName:"interest",_services:{create:{url:"api/interest/create",dataFn:function(){return c.merge(this.getChanges(),this._attributes)}},update:{url:"api/interest/update",dataFn:function(){return c.merge(this.getChanges(),this.getAttributes(["mid","title","description"],{escapeHTML:false}))},paramsMapping:{mid:"id"}},"delete":{url:"api/interest/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{title:"",description:""}});return d});define("DS/SwymUICore/script/feature/core/education/model/education-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/generic-errors","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify","DS/WebappsUtils/Console"],function(e,d,a,b,c){var f=a.extend({_modelName:"education",_attributesMapping:{},defaults:{description:"",date_end:"",date_begin:"",degree:"",field_of_study:"",not_finished:"0",place:"",school_name:""},_services:{create:{url:"api/Education/create",dataFn:function(){return this.getChanges()}},update:{url:"api/Education/update",dataFn:function(){var g=e.clone(e.merge(this.getChanges(),this.toJSON()));g.id=g.mid;return g},paramsMapping:{mid:"id"}},"delete":{url:"api/Education/delete",dataFn:function(){return{id:this.get("mid")}}}},validate:function(i,h){i=e.merge(this.getChanges(),this.toJSON());var k=[];if(!this.hasVirtuallyChanged()){k.push(d.Nothingchanged)}if(!i.school_name||!/\S/.test(i.school_name)){k.push(d.schoolError)}if(!i.field_of_study||!/\S/.test(i.field_of_study)){k.push(d.fieldError)}var g=new Date(i.date_begin),j=new Date(i.date_end);if(g.getTime()>j.getTime()&&i.not_finished==="0"){k.push(d.dateError)}if(k.length>0){b.error(k.join(", "));return k}}});return f});define("DS/SwymUICore/script/feature/core/skill/collection/skill-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/skill/model/skill-model","DS/WebappsUtils/Console"],function(d,b,c,a){var e=b.extend({_collectionName:"skill-collection",model:c,_associations:{user:{}}});return e});define("DS/SwymUICore/script/feature/core/interest/collection/interest-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/interest/model/interest-model","DS/WebappsUtils/Console"],function(c,a,b){var d=c.extend({_collectionName:"interest-collection",model:a,_associations:{user:{}}});return d});define("DS/SwymUICore/script/feature/core/user/model/bot-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/Logger/Logger"],function(d,a,c,b){return a.extend(c,{_modelName:"bot",getModelIdAttribute:function(){return"uri"}})});define("DS/SwymUICore/script/feature/core/favorite-communities/model/favorite-communities-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){var b={},d=a.extend({_modelName:"favorite-communities",_services:{create:{url:"api/user/favorites",wrapData:false,method:"POST",dataFn:function(e){return{blob:JSON.stringify({favoriteCommunities:this.get("favoriteCommunities")})}},parse:function(e){return e}},read:{url:"api/user/favorites",method:"GET",parse:function(e){try{return JSON.parse(e.blob)}catch(f){return{}}}},update:{url:"api/user/favorites",wrapData:false,dataType:"json",method:"POST",dataFn:function(e){return this},parse:function(e){return this}},"delete":{url:"api/user/favorites",method:"POST"}},defaults:{favoriteCommunities:{list:[]}},get:function(e,f){return this._parent.apply(this,[e,f])}});var c=null;b.getInstance=function(){if(c===null){c=new d()}return c};b.resetInstance=function(){if(c){c=null}};return b});define("DS/SwymUICore/script/feature/core/experience/model/experience-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/generic-errors","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify","DS/WebappsUtils/Console"],function(f,e,a,c,d){var b=a.extend({_modelName:"experience",_attributesMapping:{},defaults:{description:"",date_end:"",date_begin:"",industry:"",place:"",not_finished:"0",title:"",work_name:""},_services:{create:{url:"api/Work/create"},update:{url:"api/Work/update",dataFn:function(){var g=f.clone(f.merge(this.getChanges(),this.toJSON()));g.id=g.mid;return g},paramsMapping:{mid:"id"}},"delete":{url:"api/Work/delete",dataFn:function(){return{id:this.get("mid")}}}},validate:function(i,h){i=f.merge(this.getChanges(),this.toJSON());var k=[];if(!this.hasVirtuallyChanged()){k.push(e.Nothingchanged)}if(!i.title||!/\S/.test(i.title)){k.push(e.titleError)}if(!i.work_name||!/\S/.test(i.work_name)){k.push(e.workError)}var g=new Date(i.date_begin),j=new Date(i.date_end);if(g.getTime()>j.getTime()&&i.not_finished==="0"){k.push(e.dateError)}if(k.length>0){c.error(k.join(", "));return k}}});return b});define("DS/SwymUICore/script/feature/community/idea/collection/status-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/status-model"],function(c,b){var a=c.extend({_services:{read:{community:{url:"api/Ideation/liststatus",dataFn:function(e){var d=this.getCommunity();return{community_id:d.get("mid")}}}}},_associations:{community:{}},mode:null,modes:["community"],model:b,getCommunity:function(){return this.getAssociated("community")},hasBeenFetched:function(){if(this.getCommunity().hasBeenFetched()){return true}return this._parent.apply(this,arguments)},ideaIsMature:function(d){var e=this,f,g;if(e.length>0){e.forEach(function(h,i){if(h.get("is_mature")){f=i+1}if(d.get("status_id")==h.get("mid")){g=parseInt(h.get("status_nb"),10)}});if(!f){f=e.length}return(g>=f)}return false}});return a});define("DS/SwymUICore/script/feature/core/group/model/group-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(c,a){var b=a.extend({_modelName:"group",_attributesMapping:{},_services:{create:{url:"api/networkgroup/creategroup"},update:{url:"api/networkgroup/editgroup"},"delete":{url:"api/networkgroup/deletegroup"}}});return b});define("DS/SwymUICore/script/feature/core/group/collection/group-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/group/model/group-model","DS/WebappsUtils/Console"],function(c,b,a){var d=c.extend({_associations:{currentUser:{oppositeRole:"groups",options:{mode:""}}},_services:{read:{getnetworkgroupsbyuser:{url:"api/networkgroup/getnetworkgroupsbyuser",dataFn:function(e){return{hash_key:this.getAssociated("currentUser").get("hash_key")}}}}},_collectionName:"group-collection",model:b,modes:["getnetworkgroupsbyuser"],init:function(h,f){try{return this._parent(h,f)}catch(g){a.error("Error initializing collection: "+g.message);return}},getIdGroupProfessional:function(){var e=this.findWhere({name:"connections"});if(e){return e.get("mid")}else{return null}}});return d});define("DS/SwymUICore/script/feature/core/experience/collection/experience-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/experience/model/experience-model"],function(e,c,a){var d=c,b=d.extend({_services:{read:{experience:{url:"api/user/getworksbyhashkey",dataFn:function(f){return{hash_key:f.hash_key}}}}},_collectionName:"experience-collection",comparator:function(k,j){var g=0,l=(new Date(k.get("date_begin"))).getTime(),i=(new Date(k.get("date_end"))).getTime(),f=(new Date(j.get("date_begin"))).getTime(),h=(new Date(j.get("date_end"))).getTime();if(l>f){g=-1}else{if(l<f){g=1}else{if(l===f){if(i>h){g=-1}else{if(i<h){g=1}else{if(i===h){g=0}}}}}}if(!l&&!i){g=-1}if(!f&&!h){g=1}return g},model:a,modes:["experience"],_associations:{user:{}},onSync:function(){this.sort()},onAdd:function(){this.sort()}});return b});define("DS/SwymUICore/script/feature/community/survey/collection/answer-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/survey/model/answer-model"],function(c,b){var a=c.extend({_associations:{question:{}},model:b,modes:["answers"],getTotalVotes:function(){var f=0;for(var e=0,d=this._models.length;e<d;e++){f+=parseInt(this._models[e].get("nbVotes"),10)}return f}});return a});define("DS/SwymUICore/script/feature/community/survey/model/question-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/survey/collection/answer-collection","DS/SwymUICore/script/feature/community/survey/model/answer-model","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(a,d,b,c){exports=a.extend({_modelName:"question-survey",_hasAnOpenAnswerAdded:false,_associations:{survey:{},answers:{Class:d,oppositeRole:"question"}},HTML_ATTRIBUTES:["description"],addAnswer:function(g){var f=new b(g),e=this.getAssociated("answers").length;if(this._hasAnOpenAnswerAdded){this.getAssociated("answers").add(f,{at:e-1})}else{this.getAssociated("answers").add(f)}return f},hasAnOpenAnswerAdded:function(){return this._hasAnOpenAnswerAdded},addAnswerIsOpen:function(){var e=new b({is_open:"1",description:c.Other,position:"1"});this._hasAnOpenAnswerAdded=true;this.getAssociated("answers").push(e);return e},removeAnswerIsOpen:function(){this._hasAnOpenAnswerAdded=false;this.getAssociated("answers").pop()}});return exports});define("DS/SwymUICore/script/feature/community/idea/model/license-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){var b=a.extend({_modelName:"license",_attributesMapping:{id:"mid"}});return b});define("DS/SwymUICore/script/feature/community/survey/collection/question-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/survey/model/question-model","DS/WebappsUtils/Console"],function(e,d,a,c){var b=d.extend({model:a,modes:["questions"],_associations:{survey:{}},setup:function(g,f){if(f.questions){this.questions=f.questions}},moveUp:function(g){var f=this.indexOf(g);if(f>0){this.remove(g,{silent:true});this.add(g,{at:f-1});this.forEach(function(h,i){h.set("position",i+1)})}},moveDown:function(g){var f=this.indexOf(g);if(f<this.length){this.remove(g,{silent:true});this.add(g,{at:f+1});this.forEach(function(h,i){h.set("position",i+1)})}}});return b});define("DS/SwymUICore/script/feature/core/tenant/model/users-process-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model"],function(c,a){var b=a.extend({_modelName:"users-process",_asAdmin:false,_services:{getResults:{url:"api/member/getprocessresults",dataFn:function(e){var d;if(e&&c.is(e.asAdmin)){d=e.asAdmin}else{d=this._asAdmin}return{id:this.get("real_id"),start:0,limit:this._limit||999,as_admin:d}}},deleteProcess:{url:"api/member/deleteprocess",dataFn:function(e){var d;if(e&&c.is(e.asAdmin)){d=e.asAdmin}else{d=this._asAdmin}return{process_id:this.get("real_id"),process_type:e.processType,as_admin:d}}}},defaults:{processName:"",type:"",userStatus:"",details:[0,0]},getResults:function(d){return this.action("getResults",d)},deleteProcess:function(d){return this.action("deleteProcess",d)},setup:function(e,d){this._parent.apply(this,arguments);if(d&&d.asAdmin){this._asAdmin=d.asAdmin}}});return b});define("DS/SwymUICore/script/feature/core/stats/model/column-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date","DS/WebappsUtils/Console"],function(e,a,d,c){var b=a.extend({_modelName:"column",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:false,_attributesMapping:{},_servicesMode:{rangeuservisits:{read:{url:"api/analytics/rangeuservisits",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_users"])}}},rangeposts:{read:{url:"api/analytics/rangeposts",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_posts"])}}},rangemessages:{read:{url:"api/analytics/rangemessages",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_messages"])}}},rangecontents:{read:{url:"api/analytics/rangemetrics",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,metrics:["posts","media","questions","answers","ideations","wikipages"],merge:true,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_posts","nb_media","nb_questions","nb_answers","nb_ideas","nb_wikipages"])}}},rangecomments:{read:{url:"api/analytics/rangemetrics",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,metrics:["postcomments","mediacomments","answercomments","ideationcomments","wikipagecomments"],merge:true,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_post_comments","nb_media_comments","nb_answer_comments","nb_idea_comments","nb_wikipage_comments"])}}},rangecontent:{read:{url:"api/analytics/rangecontent",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_content"])}}},rangereportabuses:{read:{url:"api/analytics/rangereportabuses",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_report_abuses"])}}},rangecommunities:{read:{url:"api/analytics/rangecommunities",dataFn:function(){return{community_id:this._communityId?this._communityId:null,tenant_id:this._tenantId?this._tenantId:null,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(f){return this._format(f,["nb_communities","nb_directmessages"])}}}},defaults:{},init:function(f,g){var h=g.columnType;switch(h){case"rangeuservisits":case"rangeposts":case"rangemessages":case"rangecontents":case"rangecomments":case"rangecontent":case"rangereportabuses":case"rangecommunities":case"rangeconversations":this._services=this._servicesMode[h];break}this._communityId=g.communityId;this._tenantId=g.tenantId;this._fromDate=g.fromDate;this._toDate=g.toDate;this._title=g.title;if(e.is(g.asAdmin)){this._asAdmin=g.asAdmin}return this._parent(f,g)},_format:function(j,h){var k={},f,g;if(j.length!==0){for(f in j){for(g=0;g<h.length;g++){if(e.is(j[f][h[g]])){if(!e.is(k[h[g]])){k[h[g]]={}}k[h[g]][f]=j[f][h[g]]}}}}else{f=d.getCurrentDate().split(" ")[0];for(g=0;g<h.length;g++){k[h[g]]={};k[h[g]][f]=0}}return k},getTitle:function(){return this._title}});return b});define("DS/SwymUICore/script/feature/core/stats/model/table-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/stats/model/table-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/WebappsUtils/Console"],function(g,d,a,f,e,c){var b=a.extend({_modelName:"table",_communityId:null,_tenantId:null,_fromDate:null,_toDate:null,_title:null,_asAdmin:false,_attributesMapping:{},_servicesMode:{communityinfo:{read:{url:"api/analytics/infocommunity",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,as_admin:this._asAdmin}},parse:function(h){return this.format(h)}}},mostviewedposts:{read:{url:"api/analytics/mostviewedposts",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(h){return this.formatTitle(h,"Read")}}},mostendorsedposts:{read:{url:"api/analytics/mostendorsedposts",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(h){return this.formatTitle(h,"Endorsed")}}},mostreadcontributors:{read:{url:"api/analytics/mostreadcontributors",dataFn:function(){return{community_id:this._communityId,tenant_id:this._tenantId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(h){return this.formatNickname(h,"Visited")}}},mostcommentedposts:{read:{url:"api/analytics/mostcommentedposts",dataFn:function(){return{community_id:this._communityId,date00:this._fromDate,date01:this._toDate,max_items:5,as_admin:this._asAdmin}},parse:function(h){return this.formatTitle(h,"Commented")}}}},defaults:{},init:function(h,i){var j=i.tableType;switch(j){case"communityinfo":case"mostviewedposts":case"mostendorsedposts":case"mostreadcontributors":case"mostcommentedposts":this._services=this._servicesMode[j];break}this._communityId=i.communityId;this._tenantId=i.tenantId;this._fromDate=i.fromDate;this._toDate=i.toDate;this._title=i.title;if(g.is(i.asAdmin)){this._asAdmin=i.asAdmin}return this._parent(h,i)},format:function(i){var j={};if(Object.keys(i).length>0){i.avgPostEndorsements=(Math.round((i.nb_post_endorsements/i.nb_posts)*100)/100).toString();i.avgPostComments=(Math.round((i.nb_post_comments/i.nb_posts)*100)/100).toString();for(var h in i){if(["nb_messages","nb_posts","nb_endorsed_posts","nb_commented_posts","nb_questions","avgPostComments","avgPostEndorsements"].indexOf(h)>-1){j[d[h]]=i[h]&&i[h]!=="NaN"?i[h].toString():"-"}else{if(h==="avg_time_answer_question"){j[d[h]]=i[h]?f.getAverageElapsedTime(i[h]):"-"}}}}else{j[d.nb_posts]="-";j[d.nb_commented_posts]="-";j[d.nb_endorsed_posts]="-";j[d.avgPostEndorsements]="-";j[d.avgPostComments]="-";j[d.nb_questions]="-";j[d.avg_time_answer_question]="-"}return j},formatTitle:function(k,j){var l={};if(k.length>0){for(var h=0;h<k.length;h++){l[k[h].title]=d[j]+" "+k[h].counter+" "+d.Times}}else{l[""]="-"}return l},formatNickname:function(k,j){var m={},l;if(k.length>0){for(var h=0;h<k.length;h++){nickname=k[h].first_name+" "+k[h].last_name;m[nickname]={login:k[h].login,counter:d[j]+" "+k[h].counter+" "+d.Times}}}else{m[""]="-"}return m},getTitle:function(){return this._title}});return b});define("DS/SwymUICore/script/feature/core/link/model/link-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/core/link/model/link-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/UWPClientControls/PlatformNotify","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(g,f,a,b,e,c){var d=a.extend({_modelName:"link",defaults:{description:"",title:"",type:"",url:""},_services:{create:{url:"api/Link/add"},update:{url:"api/Link/update",dataFn:function(){var h=g.clone(g.merge(this.getChanges(),this.toJSON()));h.id=h.mid;return h},paramsMapping:{mid:"id"}},"delete":{url:"api/Link/delete",dataFn:function(){return{id:this.get("mid")}}}},_socialDomains:["facebook.com","plus.google.com","twitter.com","linkedin.com"],_socialMappingFonticons:{"youtube.com":"video","facebook.com":"facebook","plus.google.com":"gplus","twitter.com":"twitter","pinterest.com":"pinterest","linkedin.com":"linkedin","github.com":"github","vimeo.com":"vimeo","flickr.com":"flickr","tumblr.com":"tumblr"},_typeMapping:{"facebook.com":"1","linkedin.com":"2","youtube.com":"4","flickr.com":"6","plus.google.com":"7","twitter.com":"8"},getTypeFromUrl:function(){var m=null,j=(this.getChanges("url")||this.get("url")),n;for(var h=this._socialDomains.length,k=0;k<h;k++){n=this._socialDomains[k];if(j.indexOf(n)>-1){m=this._typeMapping[n];break}}return m},getIconName:function(){var h=null,n=null;if(this.isSocialLink()===true){if(["1","2","4","6","7","8"].indexOf(this.getChanges("type")||this.get("type"))>-1){n=this.getChanges("type")||this.get("type");switch(n){case"1":h="facebook";break;case"2":h="linkedin";break;case"4":h="video";break;case"6":h="flickr";break;case"7":h="gplus";break;case"8":h="twitter";break}}else{var k=(this.getChanges("url")||this.get("url")),o;for(var j=this._socialDomains.length,m=0;m<j;m++){o=this._socialDomains[m];if(k.indexOf(o)>-1){h=this._socialMappingFonticons[o];break}}}}return h},isSocialUrl:function(){var h=false;var n,k=(this.getChanges("url")||this.get("url"));for(var j=this._socialDomains.length,m=0;m<j;m++){n=this._socialDomains[m];if(k.indexOf(n)>-1){h=true;break}}return h},isSocialLink:function(){var h=false;if(["1","2","6","7","8"].indexOf(this.getChanges("type")||this.get("type"))>-1){h=true}else{h=this.isSocialUrl()}return h},validate:function(i,h){i=g.merge(this.getChanges(),this.toJSON());var j=[];if(!this.hasVirtuallyChanged()){j.push(f.nothinghaschanged)}if(!i.url||!/\S/.test(i.url)){j.push(f.titleNotSpecified)}if(!e.isFeatureActivated("activateAccount")){if(!i.type||!/\S/.test(i.type)){j.push(f.pleaseSelect)}}if(j.length>0){b.error(j.join(", "));return j}}});return d});define("DS/SwymUICore/script/feature/core/language/collection/language-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/language/model/language-model","DS/WebappsUtils/Console"],function(c,a,b){return c.extend({_collectionName:"language-collection",model:a,modes:["getlanglist"],_associations:{user:{}}})});define("DS/SwymUICore/script/feature/community/idea/model/collab-space-model",["DS/SwymUICore/script/lib/model/generic/swym-model"],function(a){var b=a.extend({_modelName:"collab-space",_attributesMapping:{id:"mid"}});return b});define("DS/SwymUICore/script/feature/community/idea/collection/collab-space-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/feature/community/idea/model/collab-space-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI"],function(e,h,d,g,f,c){var b,a=e.extend({_collectionName:"collab-space-collection",_services:{read:{tenant:{parse:function(j){var i=[];if(j.cspaces&&j.cspaces.length>0){j.cspaces.forEach(function(k){if(k.csName!=="Default"){i.push({name:"cspace",selected:(b.length===0),label:k.csName,value:k.name})}})}return i}}}},model:d,mode:null,modes:["tenant"]});a.spaceServerUrl=null;a.getSpaceServerUrl=function(i){if(!a.spaceServerUrl){f.getPlatformServices({config:{myAppsBaseUrl:c.getApplicationConfiguration("app.urls.myapps"),userId:g.getInstance().get("user").login},onComplete:function(l){var k,j=g.getInstance().get("config").tenant.online_instance_id;if(l.length>0){l.forEach(function(m){if(m.platformId&&j.toLowerCase()===m.platformId.toLowerCase()){a.spaceServerUrl=m["3DSpace"]}});if(a.spaceServerUrl){i(a.spaceServerUrl)}}}})}else{i(a.spaceServerUrl)}};a.getCollabSpaceCollection=function(i){if(!b){b=new a([],{mode:"tenant"});var j=g.getInstance().get("config").tenant;a.getSpaceServerUrl(function(k){b.fetch({url:k+"/resources/bps/cspaces?excludeOwner=true&tenant="+j.online_instance_id,method:"GET",proxy:"passport",proxifiedRequest:true,type:"json",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},onComplete:i.onComplete,onFailure:i.onFailure})})}return b};return a});define("DS/SwymUICore/script/feature/core/link/collection/link-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/link/model/link-model"],function(e,b,a){var c=b,d=c.extend({_services:{read:{link:{url:"api/user/getlinksbyhashkey",dataFn:function(f){return{hash_key:f.hash_key}}}}},comparator:function(h,g){var j=h.isSocialLink(),i=g.isSocialLink(),f;if(j===i){f=0}else{if(j===true){f=-1}else{f=1}}return f},_collectionName:"link-collection",model:a,modes:["link"],_associations:{user:{}},onSync:function(){this.sort()}});return d});define("DS/SwymUICore/script/feature/core/education/collection/education-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/education/model/education-model"],function(e,b,d){var c=b,a=c.extend({_services:{read:{education:{url:"api/user/getschoolsbyhashkey",dataFn:function(f){return{hash_key:f.hash_key}}}}},_collectionName:"education-collection",comparator:function(l,k){var j=0,h=(new Date(l.get("date_begin"))).getTime(),g=(new Date(l.get("date_end"))).getTime(),i=(new Date(k.get("date_begin"))).getTime(),f=(new Date(k.get("date_end"))).getTime();if(h>i){j=-1}else{if(h<i){j=1}else{if(h===i){if(g>f){j=-1}else{if(g<f){j=1}else{if(g===f){j=0}}}}}}if(!h&&!h){j=-1}if(!i&&!f){j=1}return j},model:d,modes:["education"],_associations:{user:{}},onSync:function(){this.sort()},onAdd:function(){this.sort()}});return a});define("DS/SwymUICore/script/feature/core/stats/collection/stats-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/stats/model/pie-model","DS/SwymUICore/script/feature/core/stats/model/column-model","DS/SwymUICore/script/feature/core/stats/model/table-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/WebappsUtils/Console"],function(h,e,a,g,d,f,c){var b=e.extend({init:function(m,k){if((m===null||m.length===0)&&typeof k!=="undefined"){var j=new Date();var l=(j.getFullYear()-1)+"-"+((j.getMonth()+1)<10?("0"+(j.getMonth()+1)):(j.getMonth()+1))+"-"+((j.getDate())<10?("0"+(j.getDate())):(j.getDate())),i=j.getFullYear()+"-"+((j.getMonth()+1)<10?("0"+(j.getMonth()+1)):(j.getMonth()+1))+"-"+((j.getDate())<10?("0"+(j.getDate())):(j.getDate()));m=[new a(null,{pieType:"totalinteractions",communityId:k.community.get("mid"),title:"NumberOfContents",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}),new a(null,{pieType:"totalusersperrole",communityId:k.community.get("mid"),title:"NumberOfUsersPerRole",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}),new a(null,{pieType:"totalmediapertype",communityId:k.community.get("mid"),title:"MediaPerType",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}),new g(null,{columnType:"rangeuservisits",communityId:k.community.get("mid"),title:"NumberOfVisits",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}),new g(null,{columnType:"rangeposts",communityId:k.community.get("mid"),title:"NumberOfPosts",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}),new g(null,{columnType:"rangemessages",communityId:k.community.get("mid"),title:"NumberOfMessages",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin})];m.push(new g(null,{columnType:"rangecontent",communityId:k.community.get("mid"),title:"NumberOfContentsPerDay",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}));m.push(new d(null,{tableType:"communityinfo",communityId:k.community.get("mid"),title:"CommunityInfo",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}));m.push(new d(null,{tableType:"mostviewedposts",communityId:k.community.get("mid"),title:"MostReadPosts",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}));m.push(new d(null,{tableType:"mostreadcontributors",communityId:k.community.get("mid"),title:"MostReadContributors",fromDate:l,toDate:i,tenantId:k.community.get("tenant_id"),asAdmin:k.asAdmin}));m.push(new f({id:k.community.get("mid"),asAdmin:k.asAdmin}))}return this._parent(m,k)},fetch:function(){this._models.forEach(function(i){if(i.getModelName()!=="community"){i.fetch({},{as_admin:i._asAdmin})}})},updateModels:function(i,k){var j;this._models.forEach(function(l){j=l.getModelName();if(i!==null){if(j==="community"){l.set("fromDate",i)}l._fromDate=i}else{if(k!==null){if(j==="community"){l.set("toDate",k)}l._toDate=k}}});this.fetch()}});return b});define("DS/SwymUICore/script/lib/view/generic/swym-collection-view",["UWA/Core","UWA/Object","UWA/Utils","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/sprite/sprite","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(f,h,b,e,j,d,k,g,a){var c=e.extend({_collectionClass:null,_collectionEventsForAutoRefresh:["onCollectionChange"],_collectionEvents:{},_notifyOfItemViewSelection:true,_modelViewsKeys:null,_body:null,_modeSwitch:null,_delegateSpriteReloadToParentView:false,_onlyBodyUpdateOnIncrementalRefresh:false,_addEmptyView:false,collection:null,MODEL_VIEWS_INDEX_PREFIX:"MODEL_VIEW_",name:null,modelViewClass:null,modelViewsCfg:null,bodyAttributes:null,_setupBody:function(){var l=this.bodyAttributes.tag||"div";delete this.bodyAttributes.tag;this._body=f.createElement(l,this.bodyAttributes);this.bodyAttributes.tag=l;return this._body},_beforeRefresh:function(){},_afterRefresh:function(){},_isCollectionEmpty:function(l){var m=l||this.collection;return !(m&&m.length>0)},_createEmptyContent:function(){return null},_createModelView:function(m){var p,n,o=this,l=null;switch(f.typeOf(this.modelViewsCfg)){case"object":n=f.clone(this.modelViewsCfg);break;case"function":n=this.modelViewsCfg.call(this,m);break;default:n={};break}n.widget=this._widget;n.model=m;if(this.modelViewClass.prototype instanceof e){p=this.modelViewClass}else{if(f.typeOf(this.modelViewClass)==="function"){p=this.modelViewClass.call(this,m)}else{p=this.modelViewClass[m.getModelName()]}}if(p){l=new p(n);if(this._notifyOfItemViewSelection===true){l.container.addEvent("click",function(){o.dispatchEvent("onItemViewSelect",[l,o])})}if(!l.select){l.select=function(){}}if(!l.unSelect){l.unSelect=function(){}}}return l},_createAndAddModelView:function(l){var m=this._createModelView(l);if(m){this.addChildView(this.MODEL_VIEWS_INDEX_PREFIX+m.cid,m)}return m},_updateBodyCompletelyWithModelViews:function(l){this._body.setContent(l)},_refreshBodyCompletely:function(u){var n,q=this._body,p=this._setupBody(),m=(u&&u.modelArray)||this.collection.toArray(),t=[],s=[],l=this._modelViewsKeys,r=this._childViews,o=this.MODEL_VIEWS_INDEX_PREFIX;m.forEach(function(v){n=this._createModelView(v);if(n){t.push(n);s.push(o+n.cid);this.addChildView(o+n.cid,n)}},this);this._modelViewsKeys=s;this._updateBodyCompletelyWithModelViews(t);if((l.length>0)||q){if(q){q.hide()}b.setImmediate(function(){for(var w=0,x,v=l.length;w<v;w++){x=r[l[w]];if(x){x.destroy()}}if(q){q.empty();q.destroy()}})}return p},_getIncrementallyCreatedModelViewContainer:function(){return this._body},_updateBodyIncrementalyWithModelViews:function(n){var m,o=n.modelViewList,l=n.newModelViewList;l.forEach(function(r,q){var p;if(r!==o[q]){if(o[q]){if(!o[q].container.isInjected()){a.error("Model view has not been injected because it was not found. Do not destroy the modelView by yourself.")}r.inject(o[q].container,"before");p=o.indexOf(r);if(p!==-1){o.splice(p,1)}o.splice(q,0,r)}else{m=this._getIncrementallyCreatedModelViewContainer(r,q);if(m){r.inject(m,"bottom");o.splice(q,0,r)}}}},this)},_refreshBodyIncrementally:function(B){var q,v,n=f.clone(B,false)||{},p=null,A,u=this._body||this._setupBody(),m=(B&&B.modelArray)||this.collection.toArray(),t=this.collection,w=[],z=[],y=[],o={},l=this._modelViewsKeys,s=[],x=this._childViews,r=this.MODEL_VIEWS_INDEX_PREFIX;for(q=0,p,v=l.length;q<v;q++){p=x[l[q]];A=p.model.id||p.model.cid;w.push(p);if(!t.get(A)){p.hide();s.push(p)}else{o[A]=p}}m.forEach(function(C){A=C.id||C.cid;p=o[A];if(!p){p=this._createModelView(C)}if(p){z.push(p);y.push(r+p.cid);this.addChildView(r+p.cid,p)}},this);n.modelViewList=w;n.newModelViewList=z;this._modelViewsKeys=y;this._updateBodyIncrementalyWithModelViews(n);if(s.length>0){b.setImmediate(function(){for(var D=0,C=s.length;D<C;D++){s[D].destroy()}})}return u},_getEmptyContentContainer:function(){if(!this._body){this._setupBody()}return this._body},_checkEmptyness:function(m){var l,n;if(this.elements._emptyContent){this.elements._emptyContent.destroy();delete this.elements._emptyContent}if(this._isCollectionEmpty(m&&m.modelArray)){l=this._createEmptyContent();n=this._getEmptyContentContainer();if(f.is(l)){this.elements._emptyContent=l;if(this._addEmptyView!==true){n.setContent(l);return this._body}else{this.addEventOnce("onRedraw",function(){if(this.elements._emptyContent===l){l.inject(n)}})}}}},_createContent:function(l){if(l&&this.collection&&(l.showSubsetOfModelViews===true)&&(parseInt(l.modelViewsToDisplay,10)>0)&&!l.modelArray){l.modelArray=this.collection.slice(-(parseInt(l.modelViewsToDisplay,10)))}this._checkEmptyness(l);if(!l||(l._incrementalRefresh!==true)){return this._refreshBodyCompletely(l)}else{return this._refreshBodyIncrementally(l)}},_updateContainer:function(){var n,m,o=this.collection,l=f.clone(this._lastRefreshOptions,false);if(l&&(l.showSubsetOfModelViews===true)&&(parseInt(l.modelViewsToDisplay,10)>0)){l.modelArray=o.slice(-(parseInt(l.modelViewsToDisplay,10)))}if((this._body&&this.container.contains(this._body))&&(!l||l.reset!==true)){if(this._onlyBodyUpdateOnIncrementalRefresh===true){this._refreshBodyIncrementally(l);return}else{if(!l){l={}}l._incrementalRefresh=true}}m=this._createContent.call(this,l);if(this._toBeTemporarilyRemovedFromDomOnRefresh!==false){n=this.removeForFutureReinsertion(this.container)}this.container.setContent(m);if(this._toBeTemporarilyRemovedFromDomOnRefresh!==false){n()}},_checkCollection:function(m,l){return this._checkInstance(m,l||this._collectionClass)},init:function(l){if(l instanceof d){l={collection:l}}else{if(!l){l={}}}this._modelViewsKeys=[];["modelViewsCfg","bodyAttributes","_collectionEvents"].forEach(function(m){if(f.is(this[m])){this[m]=f.clone(this[m],false)}else{this[m]={}}},this);if(f.is(this._collectionEventsForAutoRefresh,"array")){this._collectionEventsForAutoRefresh=[].concat(this._collectionEventsForAutoRefresh)}else{this._collectionEventsForAutoRefresh=[]}this.addEvent("onRedraw",function(){if(this._modeSwitch){this._modeSwitch.applyMode()}});return this._parent.call(this,l)},getBody:function(){return this._body},getModelViews:function(){var l=this._childViews;return this._modelViewsKeys?this._modelViewsKeys.map(function(m){return l[m]}):[]},addCollectionEventsForAutoRefresh:function(l){if(l){if(f.is(l,"array")===true){var m=[].concat(l);m.forEach(function(p,o,n){if(this._collectionEventsForAutoRefresh.indexOf(p)>=0){n.splice(o,1)}},this);this._collectionEventsForAutoRefresh=this._collectionEventsForAutoRefresh.concat(m)}else{if(f.is(l,"string")===true&&(this._collectionEventsForAutoRefresh.indexOf(l)<0)){this._collectionEventsForAutoRefresh.push(l)}}this.reactTo(this.collection,l,this.refresh)}},setCollection:function(r,v){var m,o;if(f.is(v,"object")){m=f.extend({},v)}else{m={}}if(m._initializing&&this.collection){if(!r){r=this.collection}this.collection=null}var n,q=m.roleToTrack,p=this._collectionEvents,s=m.refresh!==false,t=[].concat(this._collectionEventsForAutoRefresh),u=t.indexOf("onReset");if(m.checkCollection!==false){r=this._checkCollection(r)}if(this.collection){if(this.collection.equals(r)===true){return this}else{this.stopReactingTo(this.collection)}}else{if(!(r instanceof d)){throw new Error("Provided collection is invalid!")}}o=this.collection;this.collection=r;if(u>-1){this.reactTo(this.collection,"onReset",i);t.splice(u,1)}this.reactTo(this.collection,t,this.refresh);if(q&&q.name&&q.associated){this.reactTo(this.collection,"onReplace:"+q.name,{listener:function(y,w,x){if(this.collection.equals(y)&&x.equals(q.associated)){this.setCollection(w)}},initialEmitterOwnEvents:true})}if(p){for(var l in p){if(p.hasOwnProperty(l)){n=p[l];if(typeof n==="string"&&typeof this[n]==="function"){n=this[n]}if(typeof n!=="function"){a.error("Specified listener is not valid");break}this.reactTo(this.collection,l,n)}}}if(s!==false&&this._rendered){this.refresh({reset:true})}this.dispatchEvent("onSetCollection",[this,o,this.collection]);return this},setup:function(m){this._parent.apply(this,arguments);if(m){if(m.hasOwnProperty("modelViewsCfg")){this.modelViewsCfg=m.modelViewsCfg}if(m.hasOwnProperty("modeSwitch")){this.setModeSwitch(m.modeSwitch)}if(m.hasOwnProperty("bodyAttributes")){this.bodyAttributes=m.bodyAttributes}if(m.hasOwnProperty("modelViewClass")){this.modelViewClass=m.modelViewClass}if(m.hasOwnProperty("collectionEvents")){this._collectionEvents=f.extend(this._collectionEvents?f.clone(this._collectionEvents,false):{},m.collectionEvents)}if(m.hasOwnProperty("collectionEventsForAutoRefresh")){this._collectionEventsForAutoRefresh=m.collectionEventsForAutoRefresh}else{this._collectionEventsForAutoRefresh=f.clone(this._collectionEventsForAutoRefresh,false)}}var l=this.options.className;this.options.className=this.bodyAttributes["class"]||"";this.bodyAttributes["class"]=this.getClassNames("-body");this.options.className=l;if(this.bodyAttributes["class"]===""){delete this.bodyAttributes["class"]}if(m.collection||(this.collection&&m._initializing===true)){this.setCollection(m.collection,{refresh:(m.hasOwnProperty("refresh")?m.refresh:!m._initializing),_initializing:m._initializing})}return this},setModeSwitch:function(l){this._modeSwitch=l;l.setTarget(this);return this},destroy:function(){this.collection=null;this._modelViewsKeys=null;this._modeSwitch=null;this.bodyAttributes=null;this.modelViewsCfg=null;this._collectionEventsForAutoRefresh=null;this._collectionEvents=null;this._refresh=null;if(this._body){this._body.destroy();this._body=null}return this._parent.apply(this,arguments)}}),i=function(){return this.refresh({reset:true})};return c});define("DS/SwymUICore/script/feature/community/post/collection/post-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/post/model/post-model","DS/WebappsUtils/Console"],function(f,d,e,c,b){var a=e.extend({_collectionName:"post-collection",_services:{read:{all:{url:"api/filter/post",dataFn:function(){return{page:this._currentPage,limit:this._limit}}},community:{url:"api/filter/post",dataFn:function(){return{community_id:this.communityId,page:this._currentPage,limit:this._limit}}},communityWhatsnewPosts:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({query:"type:"+this.exaleadContentType,legacyFormat:false,community_id:this.communityId,with_synthesis:false},g||{})},parse:d.parseSearchResult}},filter:{all:{url:"api/exalead/search",tagsWithoutSubjectURI:true},community:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null})},tagsWithoutSubjectURI:true},communityWhatsnewPosts:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({contentType:this.exaleadContentType,legacyFormat:false,community_id:this.communityId,refineUsingQuery:"type:"+this.exaleadContentType,with_synthesis:true},g||{})},tagsWithoutSubjectURI:true}}},model:c,modes:["all","community","communityWhatsnewPosts"],exaleadContentType:"posts",setup:function(h,g){if(g.communityId){this.communityId=g.communityId}this.addEvent("onSync:remove",this.refresh,this)}});return a});define("DS/SwymUICore/script/feature/core/user/collection/user-and-users-group-collection",["UWA/Core","UWA/Json","UWA/Array","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/users-group-model","DS/SwymUICore/script/feature/core/user/model/bot-model"],function(f,e,a,j,b,i,d,h){var k=j.getInstance(),g=function(m,l){var o,n=f.clone(m,false);switch(m.member_type){case"users_group":o=d;break;case"tenant_user":o=i;break;case"external_application_bot":o=h;break;default:switch(m["ds6w:what/ds6w:type"]){case"Group":o=d;break;case"pno:Person":default:o=i;break}}f.extend(n,n.details);delete n.member_type;delete n.details;return new o(n,l)};var c=b.extend({_collectionName:"user-and-users-group-collection",model:g,_services:{read:{searchbyname:{method:"POST",url:"search",noCsrfToken:true,wrapData:false,dataFn:function(l){return{source:["usersgroup","swym"],specific_source_parameter:{usersgroup:{additional_query:" AND [ds6w:label]:("+l.query.trim()+"*)"},swym:{additional_query:" AND personOrGroup:("+l.query+")"}},tenant:k.get("config").tenant.online_instance_id,start:0,nresults:this._limit||10,select_predicate:["ds6w:label","ds6w:type"],label:"3DSwym-"+k.get("user").login+"-"+(new Date()).getTime(),query:'[ds6w:type]:("foaf:Group" OR "pno:Person")',with_synthesis_attribute:false,with_synthesis:false}},parse:function(l){if(a.isArray(l&&l.results)){return l.results.reduce(function(n,m){var p={},q=null,o=a.detect(m.attributes,function(r){if(r.name==="ds6w:label"){q=r;if(!r.value){return true}p.ds6w_58_label=r.value}p[r.name]=r.value});if(q&&!o){n.push(p)}return n},[])}return[]}}}},modes:["searchbyname","listmembers"],sync:function(){var n=this,m=arguments,l=this._parent;if(n.mode==="searchbyname"){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(o){o.getServiceUrl({serviceName:"3DSearch",platformId:k.get("config").tenant.online_instance_id,onComplete:function(p){if(p&&typeof(p)==="string"){n.urlRoot=p;return l.apply(n,m)}throw new Error("Fedsearch server could not be found!")},onFailure:function(){throw new Error("Fedsearch server could not be found!")}})});return}this.urlRoot="";return l.apply(n,m)}});g.prototype.idAttribute="id";return c});define("DS/SwymUICore/script/feature/core/favorite-communities/favorite-communities-manager",["UWA/Promise","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/favorite-communities/model/favorite-communities-model","DS/SwymUICore/script/feature/core/favorite-communities/collection/favorite-communities-collection","DS/SwymUICore/script/feature/community/community/model/community-model","i18n!DS/SwymUICore/assets/nls/feature/core/favorite-communities/favorite-communities-manager"],function(c,b,h,a,g,f){var d,e=b.extend({_isReady:false,_model:null,_collection:null,_serviceAvailable:false,_executeOnReady:function(j){var i=this;return new c(function(l,k){if(i._isReady){j(l,k)}else{i.addEventOnce("onFavoriteCommunitiesModelIsReady",j.bind(i,l,k))}})},getFavorites:function(){var i=this;return this._executeOnReady(function(m,l){if(!i._serviceAvailable){l("service unavailable")}else{var j,k=i._model.get("favoriteCommunities").list,n=[];if(i._collection&&i._collection.hasBeenFetched()){m(i._collection)}else{for(j in k){if(k.hasOwnProperty(j)&&k[j].hasOwnProperty("id")){n.push(k[j].id)}}i._collection=new a([],{mode:"all",limit:999,listIds:n});if(n.length>0){i._collection.fetch({onComplete:function(o){i._collection=o;m(i._collection)}})}else{m(i._collection)}}}})},onRemove:function(l){var k=this._model.get("favoriteCommunities").list,j=[];for(var i in k){if(k.hasOwnProperty(i)&&k[i].id!==l){j.push(k[i])}}return this._storeFavorites(j,"removed",l)},onChange:function(n,i){var m=this._model.get("favoriteCommunities").list,k,j=true,l="added";if(!i&&i!==0||(!m.hasOwnProperty(i)&&i===m.length)){m.push({id:n});return this._storeFavorites(m,l,n)}else{if(m.hasOwnProperty(i)&&m[i].hasOwnProperty("id")&&m[i].id!==n){k=this._getFavoritePosition(n);if(k){if(k<i){j=false}l="ordered"}else{m.push({id:n})}m=this._ordering(j,i,n,m);return this._storeFavorites(m,l,n)}}},_ordering:function(l,j,o,n){var i=n[j].id,m=n,k=j;m[j]={id:o};if(l){k+=1}else{k-=1}return this._recursiveOrdering(l,k,o,m,i)},_recursiveOrdering:function(l,j,p,n,i){var k=j,m=n,o=m[k].id;if(o!==p){m[k]={id:i};if(l){k+=1}else{k-=1}return this._recursiveOrdering(l,k,p,m,o)}else{m[k]={id:i};return m}},_getFavoritePosition:function(k){var j=this._model.get("favoriteCommunities").list,i;for(i in j){if(j.hasOwnProperty(i)&&j[i].hasOwnProperty("id")&&j[i].id===k){return i}}return false},isFavorite:function(k){var i=this,j;return this._executeOnReady(function(n,m){if(!i._serviceAvailable){n(false)}else{j=i._model.get("favoriteCommunities").list;for(var l in j){if(j.hasOwnProperty(l)&&j[l].id===k){n(true)}}n(false)}})},isFavoriteSync:function(k){if(!this._serviceAvailable||!this._isReady){return false}var j=this._model&&this._model.get("favoriteCommunities").list;for(var i in j){if(j.hasOwnProperty(i)&&j[i].id===k){return true}}return false},_storeFavorites:function(l,k,n){var i=this,m=this._model&&this._model.get("favoriteCommunities").list,j=[];this._model.get("favoriteCommunities").list=l;return new c(function(p,o){i._model.save({},{onComplete:function(){var s=[],r;for(var q in l){if(l.hasOwnProperty(q)&&l[q].hasOwnProperty("id")){r=new g({id:l[q].id});j.push(l[q].id);s.push(r)}}i._collection.listIds=j;i._collection.reset(s);switch(k){case"added":i.dispatchEvent("onFavoriteAdded",n);break;case"removed":i.dispatchEvent("onFavoriteRemoved",n);break;case"ordered":i.dispatchEvent("onFavoriteOrdered");break;default:break}p()},onFailure:function(){i._model.favoriteCommunities.list=m;require(["DS/UWPClientControls/PlatformNotify"],function(q){q.error(f.WeWereNotAbleToSaveYourFavorites)});o()}})})},init:function(){var i=this;this._parent.apply(this,arguments);this.favoritesCommunities=h.getInstance();this.favoritesCommunities.fetch({onComplete:function(j){i._model=j;i._isReady=true;i._serviceAvailable=true;i.dispatchEvent("onFavoriteCommunitiesModelIsReady")},onFailure:function(){i._model={};i._isReady=true;i._serviceAvailable=false;i.dispatchEvent("onFavoriteCommunitiesModelIsReady")}});return this}});return{getInstance:function(){if(!d){d=new e()}return d},resetInstance:function(){if(d){d=null;h.resetInstance()}}}});define("DS/SwymUICore/script/feature/community/idea/collection/license-collection",["DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/license-model","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/SwymUICore/script/feature/community/idea/model/requirement-model","DS/SwymUICore/script/feature/community/idea/model/project-model"],function(g,c,j,b,a,f){var i,d=c.extend({_collectionName:"license-collection",_services:{read:{}},model:j}),h=[{type:"requirement",licenses:["TRM","UXG"],Model:a,label:"Requirement"},{type:"project",licenses:["SPM","SPV"],Model:f,label:"Project",errors:{"FinancialServices.ENOProjectService.noContentOrTitle":"TitleOrContentError","FinancialServices.ENOProjectService.noBusinessUnit":"BUError","FinancialServices.ENOProjectService.cannotCreateTemplate":"cannotCreateTemplate","FinancialServices.ENOProjectService.cannotCreateBusinessGoal":"cannotCreateBusinessGoal","FinancialServices.ENOProjectService.cannotCreateProject":"cannotCreateProject"}}];d.getCompliantObjects=function(){return h};d.getCompliantObjectData=function(l){var k;h.forEach(function(m){if(m.type===l){k=m}});return k};var e=function(m,l){var k=m.length;while(k--){if(m[k]===l){return true}}return false};d.getInstance=function(l){if(!i){i=new d();var k=g.getInstance().get("config").tenant.online_instance_id;b.getGrantedRoles(function(m){if(m.length>0){m.forEach(function(n){h.forEach(function(o){if(e(o.licenses,n.id)&&!i.findWhere({mid:n.id})&&e(n.platforms,k)){i.add({id:n.id,type:o.type,label:o.label})}})})}l(i)})}else{l(i)}};return d});define("DS/SwymUICore/script/feature/community/wiki/model/wikitree-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/wiki/collection/wiki-collection","DS/WebappsUtils/Console"],function(g,a,h,f,e,c){var d=3;var b=a.extend({_modelName:"wikitree",_attributesMapping:{community_id:"community->mid"},currentPage:null,_associations:{community:{Class:f}},_services:{read:{url:"api/WikiTree/getfulltree",dataFn:function(){return{community_id:this.getCommunity().get("mid")}},parse:function(i){if(Array.isArray(i)&&(i.length>0)){if(this.getAssociated("community")){this.getAssociated("community").setAssociated("wiki",new e(i,{autoPopulate:false,limit:9999}))}return{tree:i}}else{throw new Error("Problem with the result tree received")}}},move:{url:"api/WikiTree/move",dataFn:function(i){return{id:(i.id||this.currentPage.get("mid")),relation:i.relation,targetid:(i.targetId||i.targetid)}}}},init:function(i,k){if(i&&i.community_id){i.mid=i.community_id}var j=this._parent.call(this,i,k);return j},updateTreeNodeVisibility:function(k,j){var i=this.get("tree");i.forEach(function(l){var m=l.id;if((Array.isArray(k)&&(k.indexOf(m)>=0))||(!Array.isArray(k)&&(k===m))){l.visibility=j}})},onCurrentPageDeleted:function(){this.currentPage.removeEvent("onDestroy",this.onCurrentPageDeleted,this);this.fetch()},onCurrentPageUpdated:function(k,j,l){var i=this.get("tree");i.forEach(function(m){if(m.id===k.get("mid")){m.title=k.get("title");m.visibility=k.get("visibility")}});this.dispatchEvent("onModelUpdated",[k,j,l])},setCurrentPage:function(p,n){var m=this.currentPage;var q;if(p instanceof a){this.currentPage=p;q=p.get("mid")}else{if((typeof p==="string")&&(p)){q=p;this.currentPage=new h({id:q})}else{if(typeof p==="number"){q=p;this.currentPage=new h({id:q})}else{throw new Error("Current Page is not specified in the correct format")}}}if(m){m.removeEvent("onDestroy",this.onCurrentPageDeleted,this);m.removeEvent("onSync:update",this.onCurrentPageUpdated,this)}this.currentPage.addEvent("onDestroy",this.onCurrentPageDeleted,this,-10);this.currentPage.addEvent("onSync:update",this.onCurrentPageUpdated,this);var o=0,k,l,j=this.get("tree");if(j&&(k=j.length)){for(o=0;o<k;o++){p=j[o];l=p.id;if(l===q){this.currentPage.set(p);break}}}this.dispatchEvent("onCurrentPageChange",{id:q});if(n===true){require(["DS/SwymUICore/script/utils/navigation"],function(i){i.goToContent(q,"wiki",this.get("community->mid"))}.bind(this))}},move:function(i){i.set=i.set||false;return this.action("move",i)},"onSync:move":function(){this.fetch()},setCurrentPageOnSync:function(){if(this.currentPage){this.setCurrentPage(this.currentPage)}},getCommunity:function(){return this.getAssociated("community")}});return b});define("DS/SwymUICore/script/utils/navigation",["UWA/Core","UWA/Json","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/error/error","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/lib/event-manager","DS/Logger/Logger"],function(v,aS,aj,L,M,t,N){function aI(){return(window.ds&&window.ds.env==="3DSwym")}function i(){return(window.ds&&window.ds.env==="3DD")}function aE(){return(window.ds&&window.ds.env==="MOBILE")}function x(a2,a1,a0){var aZ=window.ds&&(window.ds.env==="MOBILE");if(aZ){require(["DS/SwymUICore/script/feature/core/mobile/communication-manager"],function(a3){a3.sendOpenAppRequest({appKey:a2,appTitle:a1,appData:a0})})}else{require(["DS/TransientWidget/TransientWidget"],function(a3){a3.showWidget(a2,a1,a0)})}}function az(a5,a4,a2,aZ,a3){var a1,a0="";if(a2){switch(a4){case"post":a1=J;break;case"iquestion":a1=u;break;case"idea":a1=w;break;case"media":a1=aq;break;case"survey":a1=ah;break;case"wiki":a1=f;break;case"instantmessage":a1=aV;break;default:throw new Error("Content Type has not been specified")}if(a3===aK){a0=k+a2+a1+a5}else{a0=aL+a2+a1+a5}}else{switch(a4){case"post":a1=at;break;case"iquestion":a1=e;break;case"idea":a1=T;break;case"media":a1=ab;break;case"survey":a1=aU;break;case"wiki":a1=P;break;default:throw new Error("Content Type has not been specified")}a0=a1+a5}return a0+(aZ?"/edit":"")}function ad(a0,a8,a3,a5,a4,a9,aZ,a2){var a1=M.getInstance(),bb="",a7,a6=a2&&a2.answerUri,ba=aI()||(window.widget&&window.widget.getAppName&&(window.widget.getAppName()===aH||window.widget.getAppName()===D));if(aZ){a7=a3}if(ba||!a3){if(a3){bb=a1.getRoute({contentId:a0,contentType:a8,communityId:a3,dmId:a7,editionMode:a5?a5:false,commentUri:a4,replyUri:a9,answerUri:a6})}require(["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/history/history-model"],function(bc,bd){require([bc.getModuleNameFromModelName(a8)],function(bg){var be,bf;be=function(bj,bi){var bh;if(a1.path===bb){if(bi){if(bi.errorcode==="SocialSecurityException"||bi.errorcode==="ContainerNotFoundException"||bi.errorcode==="ERROR_NO_RIGHTS_TO_EDIT_THIS_CONTENT"){L.displayError(bi.errorcode)}bh=bj.getCommunity();if(bh){aN(bh.get("mid"),null,true,aZ);return}}bd.back()}else{if(!a1.path){a1.reset({path:"home"})}}};if(bb&&(aZ!==null)){a1.reset({path:bb})}bf=new bg({mid:a0,community_id:a3},{autoPopulate:true,onPopulate:function(bi){var bl=bi.get("mid"),bk=bi.get("_acl"),bh=bi.getCommunity(),bj=bh.get("mid")||bh.id;if((aZ===null)||(a1.path===bb)){if(bi.get("users")&&(bi.get("community_type")==="dm")){aZ=true}if(bi.get("published")==="0"){a5=true}if(a5&&(!bk||!bk.update||!bk.update.access)){a5=false;be(bi,{errorcode:"ERROR_NO_RIGHTS_TO_EDIT_THIS_CONTENT"})}if(ba){a1.reset({contentId:bl,contentType:a8,communityId:bj,dmId:((aZ===true)?bj:undefined),editionMode:a5?a5:false,commentUri:a4||null,replyUri:a9||null,answerUri:a6})}else{x(aH,"",{contentId:bl,contentType:a8,community:bj,dm:((aZ===true)?bj:undefined),editionMode:a5?a5:false,commentURI:a4,replyURI:a9,url:aj.getBaseUrl(),answerURI:a6})}}},onFailure:be})})})}else{x(aH,"",{contentId:a0,contentType:a8,community:a3,dm:((aZ===true)?a3:undefined),editionMode:a5?a5:false,url:aj.getBaseUrl()})}}function aN(a6,a2,a7,a0,a3){var aZ=aI(),a1=M.getInstance(),a8=a3&&a3.messageUuid,a9=(a0===true?"dm":"community")+":"+a6+(a2?("/"+a2):(a8?("/message:"+a8):"")),a5=[af,ap,al,K],a4=(v.is(a3&&a3.tagNavigatorFilteringOptions,"object")?a3.tagNavigatorFilteringOptions:undefined);if(aI()||(window.widget&&window.widget.getAppName&&window.widget.getAppName()===aH)){require(["DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/feature/core/history/history-model","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model"],function(ba,bf,bj,bb,bc){var bl=(a0===true?bf:ba),bg,bi=function(){if(a4){if(aZ){a1.dispatchEvent("onTaggerShowRequest")}else{if(window.widget){window.widget.requestView({type:"maximized"})}}t.dispatchEvent("onTaggerFilteringRequest",[a0===true?aK:r,a4],true)}},bd=function(bn,bp){bn.setUserAccess(false);if(bp&&bp.hasOwnProperty("result")&&bp.result.hasOwnProperty("title")){bn.set("title",bp.result.title)}if(bj.getInstance().isFeatureActivated("activate_community_join_request")&&(bn.getVisibility()===bc.Private||(bp&&bp.result))){var bo="DS/SwymUIComponents/script/feature/community/community/view/community-signup-request-launcher";require([bo],function(bq){bq.show(bn)})}else{if(!a7&&bp){L.displayError(bp.errorcode)}}if(a6===a1.communityId){var bm=bb.getState();if(a9!=="community:"+a6||(bm&&bm.hasOwnProperty("previousContext")&&bm.previousContext.hasOwnProperty("communityId")&&bm.previousContext.communityId!==a6)){bb.back()}else{a1.reset({path:"home"})}}},be=function(bm){if(a0||bm.hasCurrentUserAccess()){var bn=false;if(a2){var bo=bm.getCommunityFeaturesAccess();switch(a2){case af:case ap:case al:case K:case I:bn=true;break;case aa:bn=bo.ideation_feature;break;case b:bn=bo.qna_feature;break;case am:case ag:bn=bo.wiki_feature;break;case O:bn=bo.survey_feature;break;case d:bn=bo.stats_feature;break;case h:bn=bo.settings_feature;break;default:N.error("Unknown Community Page");return}}else{bn=true}if(bn!==true){aN(bm.get("mid"),undefined,undefined,a0)}else{if(a9===a1.path){bg={communityId:a6,dmId:(a0===true?a6:undefined),messageUuid:a8,path:a9};if(a8){bg.feedMode=M.TIMELINE_MODE}a1.reset(bg);bi()}}}else{bd(bm)}},bk=new bl({mid:a6}),bh=bk.hasCurrentUserAccess();switch(bh){case false:if(bk.hasBeenFetched()){bd(bk)}else{bk.fetch({fromCache:true,onFailure:bd,onComplete:be})}break;case true:case null:default:bg={communityId:a6,dmId:(a0===true?a6:undefined),messageUuid:a8,path:a9};if(a8){bg.feedMode=M.TIMELINE_MODE}a1.reset(bg);if((bh!==true)||(a2&&(a5.indexOf(a2)<0))){bk.fetch({fromCache:true,onComplete:be,onFailure:bd})}else{bi()}break}})}else{x(aH,"",{community:a6,dm:(a0===true?a6:undefined),route:a9,url:aj.getBaseUrl(),tagNavigatorFilteringOptions:aS.encode(a4)})}}function R(aZ,a2,a1,a0){return aN(aZ,a2,a1,true,a0)}function W(a2){var a4,a3=a2.hash_key||a2.hashKey||a2.userHashKey,a0=a2.login,a1=a3||a0;if(!a1){N.log("Please use a hash key or login in order to have a working link")}else{if(aI()){M.getInstance().reset({path:aQ+":"+a1+(a2.facet?au[a2.facet]:s),userHashKey:a3||a0})}else{if(i()){a4=aj.getBaseUrl();var aZ=window.widget&&window.widget.getAppName&&window.widget.getAppName()===G;if(!aZ||(aZ&&a3!==window.widget.getValue("hash_key"))){var a5=a2.login?{login:a0,url:a4,facet:a2.facet}:{hash_key:a3,url:a4,facet:a2.facet};x(G,"",a5)}}}}}function o(a0,a1){var aZ,a2;switch(a0){case"hash_key":a2=a1.match(l);break;case"login":a2=a1.match(ak);break;default:break}if(a2&&(a2.length>=3)){aZ=a2[2]}else{aZ=null}return aZ}var ae="home",r="community",aK="dm",I=M.COMMUNITY_BLOG,al=M.COMMUNITY_MEDIA,K=M.COMMUNITY_GALLERY,aa=M.COMMUNITY_IDEAS,b=M.COMMUNITY_QUESTIONS,am=M.COMMUNITY_WIKI,ag=M.COMMUNITY_WIKI_ROOT,af=M.COMMUNITY_MEMBERS,h=M.COMMUNITY_SETTINGS,d=M.COMMUNITY_STATS,ap=M.COMMUNITY_MY_CONTRIBUTIONS,O=M.COMMUNITY_SURVEYS,an=M.MY_COMMUNITIES,aB=M.DISCOVER_COMMUNITIES,y=M.MY_BOOKMARKS,C=M.MY_NETWORK_ACTIVITY,ar="iquestion",aC="post",m="ideation",aX="media",S="wiki",ay="survey",aw="message",aM="search",aQ="people",aJ="admin-tenant",ax="communities",aF="whatsnew",F="media",z="activities",aR="connections",Z="aboutme",ao="settings",E="#app:"+aj.getProfileAppKey(),Q="#app:"+aj.getMyCommunitiesAppKey(),aL="#"+r+":",k="#"+aK+":",g="#"+aQ+":",e="#"+ar+":",at="#"+aC+":",T="#"+m+":",ab="#"+aX+":",P="#"+S+":",aU="#"+ay+":",Y="#"+aJ,X="#"+aM+":",aP="/"+ap,aD="/"+aa,aA="/"+I,c="/"+d,aG="/"+h,ai="/"+al,ac="/"+b,aY="/"+am,a="/"+O,q="/"+af,aO="/"+aM,u="/"+ar+":",J="/"+aC+":",w="/"+m+":",aq="/"+aX+":",f="/"+S+":",ah="/"+ay+":",aV="/"+aw+":",s="/"+z,U="/"+aR,n="/"+Z,p="/"+ao,aT="/type:",H="/"+ax,av="/"+aF,aW="/"+F,l=new RegExp(".*("+E+"/.+hash_key=)(\\w+)?(&)?"),j=new RegExp(".*("+E+"/.+facet=)([0-3]{1})?(&)?"),ak=new RegExp(".*("+E+"/.+login=)([A-Za-z0-9-_.]{2,64})?(&)?"),au={0:s,1:n,2:U,3:p},aH=aj.getMyCommunitiesAppKey(),G=aj.getProfileAppKey(),D=aj.getContentReaderAppKey(),B=aj.getAnalyticsAppKey(),A=aj.getControlCenterAppKey();var V={HOME:ae,COMMUNITY:r,COMMUNITY_BLOG:I,COMMUNITY_MEDIA:al,COMMUNITY_IDEAS:aa,COMMUNITY_QUESTIONS:b,COMMUNITY_WIKI:am,COMMUNITY_MEMBERS:af,COMMUNITY_SETTINGS:h,COMMUNITY_STATS:d,COMMUNITY_MY_CONTRIBUTIONS:ap,COMMUNITY_SURVEYS:O,IQUESTION:ar,POST:aC,IDEATION:m,MEDIA:aX,WIKI:S,SURVEY:ay,MESSAGE:aw,MY_COMMUNITIES:an,DISCOVER_COMMUNITIES:aB,MY_BOOKMARKS:y,MY_NETWORK_ACTIVITY:C,SEARCH:aM,USER_PROFILE:aQ,ADMIN_TENANT:aJ,ADMIN_COMMUNITIES:ax,ADMIN_WHATSNEW:aF,PEOPLE_ABOUTME:z,PEOPLE_CONNECTIONS:aR,PEOPLE_ACTIVITIES:Z,PEOPLE_SETTINGS:ao,PROFILE_FACET_MAPPING:au,URLPART_COMMUNITY:aL,URLPART_DM:k,URLPART_PEOPLE:g,URLPART_CONTENT_IQUESTION:e,URLPART_CONTENT_POST:at,URLPART_CONTENT_IDEATION:T,URLPART_CONTENT_MEDIA:ab,URLPART_CONTENT_WIKI:P,URLPART_CONTENT_SURVEY:aU,URLPART_PEOPLE_IN_3DD:E,URLPART_CONTENT_IN_3DD:Q,URLPART_ADMIN:Y,URLPART_SEARCH:X,URLTAB_CONTRIBUTIONS:aP,URLTAB_IDEATION:aD,URLTAB_BLOG:aA,URLTAB_STATS:c,URLTAB_SETTINGS:aG,URLTAB_MEDIA:ai,URLTAB_IQUESTIONS:ac,URLTAB_WIKI:aY,URLTAB_SURVEYS:a,URLTAB_MEMBERS:q,URLTAB_SEARCHINCOMMUNITY:aO,URLCONTENT_IQUESTION:u,URLCONTENT_POST:J,URLCONTENT_IDEATION:w,URLCONTENT_MEDIA:aq,URLCONTENT_WIKI:f,URLCONTENT_SURVEY:ah,URLCONTENT_MESSAGE:aV,URLPEOPLE_ABOUTME:s,URLPEOPLE_CONNECTIONS:U,URLPEOPLE_ACTIVITIES:n,URLPEOPLE_SETTINGS:p,URLTYPE_SEARCH:aT,URLADMIN_COMMUNITIES:H,URLADMIN_WHATSNEW:av,URLADMIN_PROCESSING:aW,REGEXP_3DD_URLPART_PEOPLE_HASHKEY:l,REGEXP_3DD_URLPART_PEOPLE_FACET:j,REGEXP_3DD_URLPART_PEOPLE_LOGIN:ak,_currentUrl:null,getCurrentUrl:function(){return this._currentUrl},setCurrentUrl:function(aZ){this._currentUrl=aZ},getUrlFromContentType:function(a0,a2,a1){var aZ="";switch(a1.toLowerCase()){case"post":case"communitypost":case"comment":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_POST+a2;break;case"media":case"mediacomment":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_MEDIA+a2;break;case"qnaquestion":case"qnacomment":case"qnaanswer":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_IQUESTION+a2;break;case"dsi_ideation_ideation":case"ideation":case"ideationcomment":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_IDEATION+a2;break;case"dsi_dfstree_wikitree":case"wikitree":case"wikiTreecomment":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_WIKI+a2;break;case"poll":aZ=this.URLPART_COMMUNITY+a0+this.URLCONTENT_SURVEY+a2;break}return aZ},extractUserHashkeyFromAppUrl:function(aZ){return o("hash_key",aZ)},extractUserLoginFromAppUrl:function(aZ){return o("login",aZ)},extractProfileFacetFromUrl:function(aZ){var a1,a0;if(aZ.indexOf(G)>=0){a0=aZ.match(j);if(a0&&a0.length>=3){a1=au[a0[2]]}}else{if(aZ.indexOf(z)>0){a1=z}else{if(aZ.indexOf(Z)>0){a1=Z}else{if(aZ.indexOf(aR)>0){a1=aR}else{if(aZ.indexOf(ao)>0){a1=ao}}}}}return a1},extractProfileFacetNumberFromUrl:function(a0){var a3,a2,a1;if(a0.indexOf(G)>=0){a2=a0.match(j);if(a2&&a2.length>=3){a3=a2[2]}}else{a1={};for(var aZ in au){if(au.hasOwnProperty(aZ)){a1[au[aZ]]=aZ}}if(a0.indexOf(s)>0){a3=a1[s]}else{if(a0.indexOf(n)>0){a3=a1[n]}else{if(a0.indexOf(U)>0){a3=a1[U]}else{if(a0.indexOf(p)>0){a3=a1[p]}}}}}return a3},goToUrl:function(aZ){var a3=aZ;aZ=(aZ.indexOf("#")>=0)?(aZ.substring(aZ.indexOf("#")+1)):aZ;this.setCurrentUrl(aZ);var a0=M.getInstance(),a5=aj.getBaseUrl(),a6=a0.extractContextInfoFromRoute(a3),a4=null;if(a6.contentId&&a6.contentType){if(a6.contentType==="message"||a6.contentType==="instantmessage"){this.goToCommunity(a6.communityId,undefined,undefined,false,{messageUuid:contentId})}if(a6.communityId&&a6.dmId){a4=true}else{if(a6.communityId&&!a6.dmId){a4=false}else{a4=null}}this.goToContent(a6.contentId,a6.contentType,a6.dmId||a6.communityId,a6.editionMode,a6.commentUri,a6.replyUri,a4,a6.answerUri?{answerUri:a6.answerUri}:undefined)}else{if(a6.dmId){if(a0.isDMTimelineMessageContext(aZ)){this.goToDM(a6.dmId,undefined,undefined,{messageUuid:a6.messageUuid})}else{var a2=a0.getCommunityPageContext(aZ);this.goToDM(a6.dmId,(a2?a2:undefined))}}else{if(a6.communityId&&!a6.contentId&&aZ.indexOf(aJ)===-1){if(a0.isCommunityTimelineMessageContext(aZ)){this.goToCommunity(a6.communityId,undefined,undefined,false,{messageUuid:a6.messageUuid})}else{var a2=a0.getCommunityPageContext(aZ);this.goToCommunity(a6.communityId,(a2?a2:undefined))}}else{if(a6.userHashKey){var a1=V.extractProfileFacetNumberFromUrl(aZ);this.goToProfile({hash_key:a6.userHashKey,facet:a1})}else{if((aZ.indexOf(aM)===0)||(aZ.indexOf(aJ)===0)||(aZ.indexOf(an)===0)||(aZ.indexOf(aB)===0)||(aZ.indexOf(ae)===0)||(aZ.indexOf(y)===0)||(aZ.indexOf(C)===0)||(aZ==="")){if(aZ===""){aZ=ae}if(aZ.indexOf(aM)===0){a0.reset({path:aZ,query:aZ.split(":")[1],x3dsearchOptions:a0.x3dsearchOptions})}else{if((aZ.indexOf(an)===0)||(aZ.indexOf(aB)===0)||(aZ.indexOf(y)===0)||(aZ.indexOf(C)===0)||(aZ.indexOf(ae)===0)){if(aI()||(window.widget&&window.widget.getAppName&&window.widget.getAppName()===aH)){a0.reset(a6)}else{x(aH,"",{route:aZ,url:a5})}}else{if(aZ.indexOf(aJ)===0){if(aI()||(window.widget&&window.widget.getAppName&&window.widget.getAppName()===A)){a0.reset(a6)}else{x(A,"",{url:a5})}}}}}else{if(aZ.indexOf(aH)>-1){x(aH,"",{route:aZ,url:a5})}else{if(aZ.indexOf(G)>-1){var a7;if(a7=V.extractUserLoginFromAppUrl(aZ)){x(G,"",{login:a7,url:a5})}else{if(a7=V.extractUserHashkeyFromAppUrl(aZ)){x(G,"",{hash_key:a7,url:a5})}}}else{if(aZ.indexOf(A)>-1){x(A,"",{url:a5})}else{if(aZ.indexOf(D)>-1){x(D,"",{url:a5})}else{if(aZ.indexOf(B)>-1){x(B,"",{url:a5})}else{throw new Error("Unknown URL")}}}}}}}}}}},goTo3DSwymHomePage:function(aZ){var a2=aI(),a1=M.getInstance(),a0=v.is(aZ&&aZ.tagNavigatorFilteringOptions,"object")?aZ.tagNavigatorFilteringOptions:undefined;if(a2||(window.widget&&window.widget.getAppName&&window.widget.getAppName()===aH)){this.goToUrl(ae);if(a0){if(a2){a1.dispatchEvent("onTaggerShowRequest")}else{if(window.widget){window.widget.requestView({type:"maximized"})}}t.dispatchEvent("onTaggerFilteringRequest",[ae,a0],true)}}else{x(aH,"",{route:ae,url:aj.getBaseUrl(),tagNavigatorFilteringOptions:aS.encode(a0)})}},goToAdminPlatformCommunities:function(){this.goToUrl(this.URLPART_ADMIN+this.URLADMIN_COMMUNITIES)},goToAdminPlatformWhatsNew:function(){this.goToUrl(this.URLPART_ADMIN+this.URLADMIN_WHATSNEW)},in3DSwym:aI,in3DD:i,inMobile:aE,getContentURLForSwym:az,goToCommunity:aN,goToDM:R,goToContent:ad,goToProfile:W,showTransientWidget:x};return V});define("DS/SwymUICore/script/feature/core/user/model/user-model",["UWA/Core","UWA/Data","i18n!DS/SwymUICore/assets/nls/feature/core/user/model/user-model","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/core/skill/collection/skill-collection","DS/SwymUICore/script/feature/core/language/collection/language-collection","DS/SwymUICore/script/feature/core/interest/collection/interest-collection","DS/SwymUICore/script/feature/core/experience/collection/experience-collection","DS/SwymUICore/script/feature/core/education/collection/education-collection","DS/SwymUICore/script/feature/core/link/collection/link-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/community/member/model/mixin/community-member","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/WebappsUtils/Console"],function(b,g,j,v,k,m,n,p,t,h,r,e,l,a,o,d,c,s){var q="";var u=window.ds&&(window.ds.env==="MOBILE"),i=function(w,x,y,A){var z=e.getBaseUrl()+"/api/user/getpicture/"+(w?"login/"+w:(y?"hash_key/"+y:""))+(x?"/update/"+x:"")+(A?"/format/"+A:"");if(u){z=g.proxifyUrl(z,{proxy:"passport"})}return z},f=v.extend(o,{_modelName:"user",_attributesMapping:{user_id:"id",user_picture_update:"picture_update",name:"nickname",firstName:"first_name",lastName:"last_name",updated:"update",displayName:"nickname","image->updated":"picture_update",user_picture_fingerprint:"user_picture_fingerprint",user_statistics_comments:"nb_comment",user_statistics_posts:"nb_post",user_statistics_media:"nb_media",user_statistics_questions:"nb_question",user_statistics_ideas:"nb_ideation",user_statistics_answers:"nb_answer"},_attributesMappingForPassport:{firstName:"first_name",lastName:"last_name",telephone:"tel",address:"address",city:"city",country:"country_code",zip:"zip",email:"email",company:"company",language:"language"},_passportAttributesConstraints:{},_attributesEditableByPassport:{},_services:{read:{url:"api/user/find",dataFn:function(){return{hash_key:this.has("hash_key")?this.get("hash_key"):"",login:this.has("login")?this.get("login"):""}},parse:function(x){var w=new RegExp(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d$/),z=x.schools,y=x.works;if(z&&Array.isArray(z)){z.forEach(function(A){if(A.date_begin&&A.date_begin.match&&A.date_begin.match(w)){A.date_begin=a.convertDate(A.date_begin);A.date_end=a.convertDate(A.date_end)}})}if(y&&Array.isArray(y)){y.forEach(function(A){if(A.date_begin&&A.date_begin.match&&A.date_begin.match(w)){A.date_begin=a.convertDate(A.date_begin);A.date_end=a.convertDate(A.date_end)}})}x.ID=x.id;return x}},readwithoutcache:{url:"api/user/find",dataFn:function(){return{detailedInfos:true,hash_key:this.get("hash_key"),login:this.get("login"),disablecache:true}}},saveuserinfos:{url:"api/user/saveuserinfos"},uploadpreviewpicture:{url:"api/user/uploadpreviewpicture/"},uploadpicture:{url:"api/user/uploadpicture"},sendInvitation:{url:"api/notification/send/",dataFn:function(w){return{type:"Network","do":"invite",recipient_hash:this.get("hash_key"),message:w.message,related_model_id:w.groupIdProfessionnal}}},deleteuserfromnetwork:{url:"api/networkgroup/deleteuserfromnetwork",dataFn:function(){return{hash_key:this.get("hash_key"),login:this.get("login")}}},getInvitationStatus:{url:"api/network/getinvitationstatus",dataFn:function(){return{hash_key:this.get("hash_key"),login:this.get("login")}}},setvisibility:{url:"api/user/setvisibility",dataFn:function(w){return{visibility:w.visibility}}},removeSuggestion:{url:"api/Recommendation/blacklistitem",dataFn:function(){return{itemToBlacklistId:this.get("ID"),mode:"offline",limit:6,itemType:"User",maxNbOfCommonElements:"5"}}}},_associations:{skills:{Class:k,oppositeRole:"user",options:{mode:null}},interests:{Class:n,oppositeRole:"user",options:{mode:null}},languages:{Class:m,oppositeRole:"user",options:{mode:null}},works:{Class:p,oppositeRole:"user",options:{mode:null}},schools:{Class:t,oppositeRole:"user",options:{mode:null}},links:{Class:h,oppositeRole:"user",options:{mode:null}},contactsSharedWithCurrentUSer:{oppositeRole:"networkGroupOwner",options:{mode:"getmysharedcontacts",limit:10}},community:{}},_modelIdAttribute:"hash_key",defaults:{},init:function(){this._parent.apply(this,arguments);if(this.get("user_community_role")&&!this.get("relation")){var w=this.getCommunityRoleFromExaleadRole(this.get("user_community_role"));if(w){this.set("relation",w)}}},isCurrentUser:function(){var w=this.get("login"),x=this.get("hash_key");return(w&&w===this.getCurrentLogin())||(x&&x===this.getCurrentHashKey())},getCurrentHashKey:function(){return r.getInstance().get("user").hash_key},getCurrentLogin:function(){return r.getInstance().get("user").login},readwithoutcache:function(w){return this.action("readwithoutcache",w)},uploadpreviewpicture:function(w){return this.action("uploadpreviewpicture",w)},uploadpicture:function(w){return this.action("uploadpicture",w)},sendInvitation:function(w){return this.action("sendInvitation",w)},saveuserinfos:function(w){return this.action("saveuserinfos",w)},deleteuserfromnetwork:function(w){return this.action("deleteuserfromnetwork",w)},removeSuggestion:function(w){return this.action("removeSuggestion",w)},setvisibility:function(w){return this.action("setvisibility",w)},getInvitationStatus:function(w){var x=this.get("ut_state");if((x!=2)&&(x!=3)){return this.action("getInvitationStatus",w)}},updatePassportFields:function(x){if(this.isCurrentUser()===true){var w=x.data;w.username=this.get("username");var y=d.getApplicationConfiguration("app.urls.passport");if(y){c.authenticatedRequest(y+"/api/authenticated/user/fields",{data:JSON.stringify({fields:w}),type:"json",method:"POST",timeout:60000,headers:{"X-DS-IAM-CSRFTOKEN":q,Accept:"application/json","Content-Type":"application/json"},onComplete:x.onComplete,onFailure:function(A,z){s.log(A);s.log(z);s.log("3dpassport server error");require(["DS/UWPClientControls/PlatformNotify"],function(B){B.error("There is an issue with 3DPassport server. Please try again later.")})}})}}},_CSRFPASSPORTATTRIBUTE:"X-DS-IAM-CSRFTOKEN",passwordEditUrl:null,twoFAURL:null,adminURL:null,emailValidationURL:null,dppConsent:false,syncPassportInformationIfNeeded:function(){var w=this;if(this.isCurrentUser()===true){var x=d.getApplicationConfiguration("app.urls.passport");if(x){c.authenticatedRequest(x+"/api/authenticated/user/fields",{method:"GET",timeout:60000,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(F,z,G){q=e.getCsrfToken(G,z,w._CSRFPASSPORTATTRIBUTE);var B=JSON.parse(F),E=B.fields,y,A,D,C;for(y in this._attributesMappingForPassport){if(this._attributesMappingForPassport.hasOwnProperty(y)&&E.hasOwnProperty(y)){A=E[y].value;C=!E[y].readOnly;D=this._attributesMappingForPassport[y];this._passportAttributesConstraints[D]=E[y].fieldConstraint;if(D){this.set(D,A);this._attributesEditableByPassport[D]=C}}}this.emailValidationURL=B.emailValidationURL;this.passwordEditUrl=B.pwdUpURL;this.twoFAURL=B.twoFAURL;this.adminURL=B.adminToolsURL;if(E.dpp_consent){this.dppConsent=E.dpp_consent}if(E.marketing_consent){this.marketing_consent=E.marketing_consent.value}this.dispatchEvent("onPassportSynced")}.bind(this),onFailure:function(){s.warn("Call to passport failed !!! This is a serious problem");this.dispatchEvent("onPassportFailed")}.bind(this)})}}},getPassportAttributeConstraints:function(y){var B=this._passportAttributesConstraints[y],w,E="stringLength",C="mandatory",x="string-pattern",D={};if(B){for(var A=0,z=B.length;A<z;A++){w=B[A];switch(w.nameConstraint){case E:D.maxlength=w.maximumLength;break;case C:D.required=true;break;case x:D.pattern=w.pattern;break}}}return D},fetchCountries:function(w){if(this.isCurrentUser()===true){var x=d.getApplicationConfiguration("app.urls.passport");if(x){c.authenticatedRequest(x+"/api/public/countries/?languages="+this.get("language"),{method:"GET",timeout:60000,cache:false,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(D){var y=JSON.parse(D),A,C=[];for(var B=0,z=y.length;B<z;B++){A=y[B];C.push({value:A.iso3,label:A.label})}w.onComplete(C)}})}}},isEditableByPassport:function(x){var w=this._attributesEditableByPassport[x];if(w===undefined){w=false}return w},getRelativePath:function(){var w;w=l.URLPART_PEOPLE+(this.get("hash_key")?this.get("hash_key"):this.get("login"))+l.URLPEOPLE_ABOUTME;return w},getRelativePathToConnections:function(){return l.URLPART_PEOPLE+this.get("hash_key")+l.URLPEOPLE_CONNECTIONS},getRelativePathToActivities:function(){return l.URLPART_PEOPLE+this.get("hash_key")+l.URLPEOPLE_ACTIVITIES},getRelativePathToSettings:function(){return l.URLPART_PEOPLE+this.get("hash_key")+l.URLPEOPLE_SETTINGS},isPendingUser:function(){if((this.get("ut_state")==="0")&&(b.is(this.get("nickname"))&&this.get("nickname").trim()==="")||this.get("ds_user")==="5"){return true}return false},getNickname:function(){if(this.isPendingUser()){return this.get("ut_invitation_email")||this.get("email")}else{if(this.get("first_name")&&this.get("last_name")){return this.get("first_name")+" "+this.get("last_name")}else{if(this.get("nickname")){return this.get("nickname")}}}return""},isAnonymized:function(){var w;if(this.get("ut_state")===9){return true}w=this.get("login");if(w){return(w.indexOf("_ANONYMISED_")===0)}return null},getCacheId:function(){var w={};if(this.has("login")){return this.get("login")}return this._parent.apply(this,arguments)},isNew:function(){if(this.get("hash_key")||this.get("login")){return false}return this._parent.apply(this,arguments)},"onChange:user_community_role":function(x,y){var w=this.getCommunityRoleFromExaleadRole(y);if(w){this.set("relation",w)}return this._previous.apply(this,arguments)}});require(["DS/SwymUICore/script/feature/core/user/collection/user-collection"],function(w){f.prototype._associations.contactsSharedWithCurrentUSer.Class=w});f.constructUserPictureUrl=i;return f});define("DS/SwymUICore/script/feature/core/user/collection/commenters-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/WebappsUtils/Console"],function(e,d,c,b){var a=d.extend({model:c,mode:null,modes:["comment","answer","edit"],_associations:{commented:{}},_services:{read:{comment:{url:"api/comment/listcommenters",dataFn:function(){var f=this.getAssociated("commented");this.parentId=f&&f.get("mid");if(f.getModelName()==="iq-answer"){var g=f.getAssociated("answeredFor");return{model:g.getTableName(),model_id:g.get("mid"),answer_id:f.get("mid"),limit:9999}}else{return{model:f.getTableName(),model_id:f.get("mid"),limit:9999}}}},answer:{url:"api/iquestionsAnswer/getwhoanswered",dataFn:function(){var f=this.getAssociated("commented");this.parentId=f&&f.get("mid");return{qna_id:f.get("mid"),limit:9999}}},edit:{url:"api/WikiTree/getwhoedited",dataFn:function(){var f=this.getAssociated("commented");this.parentId=f&&f.get("mid");return{id:f.get("mid"),limit:9999}}}}}});return a});define("DS/SwymUICore/script/feature/core/user/model/currentuser-model",["UWA/Core","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils"],function(f,a,g,e,c){var d=a.extend({_modelName:"current-user",_attributesMapping:{user_id:"mid"},_associations:{groups:{Class:g,options:{mode:"getnetworkgroupsbyuser"}},_communities:{Class:null,options:{mode:"my-communities",limit:10}}},_services:{read:{CurrentUser:{url:"api/user/getcurrent",dataFn:function(){return{detailedView:false,get_autosaved_content:true}}}},setAccess:{url:"api/tenantAcl/setaccess",dataFn:function(h){return{hash_key:this.get("hash_key"),access:"4"}}},unsetAccess:{url:"api/tenantAcl/unsetaccess",dataFn:function(h){return{hash_key:this.get("hash_key"),access:"4"}}}},mode:null,defaultMode:"CurrentUser",modes:["CurrentUser"],defaults:{},init:function(h,i){try{this.setMode(i)}catch(j){return}this._parent(h,i)},setMode:function(h){try{if(h){var j=h.mode;if(!j){this.mode=this.defaultMode}if(j&&(this.modes.indexOf(j)>=0)){this.mode=j}else{delete h.url}}}catch(i){return}},setAccess:function(h){return this.action("setAccess",h)},unsetAccess:function(h){return this.action("unsetAccess",h)},sync:function(l,i,h){try{var j={};if(l==="read"){if(this.mode){j=this._services?this._services.read[this.mode]:{}}else{j=this._services?this._services.read[this.defaultMode]:{}}}f.merge(h||{},j);return this._parent(l,i,h)}catch(k){return false}},getLastVisitedCommunities:function(h,k,i){var j=this;require(["DS/SwymUICore/script/feature/community/community/collection/community-collection","DS/SwymUICore/script/lib/model/generic/swym-model"],function(o,l){j.constructor.prototype._associations._communities.Class=o;var m=j.getAssociated("_communities");if(m.getLimit()<h){m.setLimit(h);m.loadingStatus=l.STATUS.notRequested}function n(){switch(m.loadingStatus){default:case l.STATUS.notRequested:m.fetchPage(1,{data:{order:"users_community_stats.last_connection DESC"},onComplete:function(){k.call(null,m.toJSON().slice(0,h))},onFailure:i});break;case l.STATUS.valid:k.call(null,m.toJSON().slice(0,h));break;case l.STATUS.invalid:i.call(null);break;case l.STATUS.pending:m.addEventOnce("onLoadingStatusChange",n);break}}n()})},isAllowedToCreateCommunity:function(){var j=e.getInstance().get("config").tenant,m=(this.get("canCreateCommunity")==="1"),l=(this.get("canCreateCommunity")===true),k=(!l&&j.plan_a_community!==false),i=(j.allow_add_community_for_everyone!==false),h=(this.get("tenant_user_status")==="0");if((m||l||k||i)&&h){return true}else{return false}}});var b=null;d.getInstance=function(){if(b===null){b=new d({id:1})}return b};d.getInstanceFetched=function(k){var i=e.getInstance(),j=c.getBaseUrl(),h=b&&b.urlRoot;if(h&&(j.toLowerCase()!==h.toLowerCase())){this.reinitializeInstance()}if(b===null||!b.hasBeenFetched()){i.executeWhenReady(function(){if(b===null){b=new d(i.get("user"))}b.addEventOnce("onSync",function(l){if(k){k(l)}});if(b.isBeingFetched()===false){b.fetch({fromCache:true})}})}else{if(k){k(b)}}return b};d.reinitializeInstance=function(){if(b!==null){b=null}return this.getInstance()};return d});define("DS/SwymUICore/script/feature/community/comment/model/comment-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date"],function(e,a,f,d,c){var b=a.extend({_modelName:"comment",_tableName:"Comment",_attributesMapping:{id:"mid",emplid:"author->empl_id","user_id.emplid":"author->emplid",hash_key:"author->hash_key","user_id.hash_key":"author->hash_key",first_name:"author->first_name",last_name:"author->last_name",nickname:"author->nickname","user_id.nickname":"author->nickname",user_id:"author->mid","user_id.accept_share_info":"author->accept_share_info","user_id.email":"author->email","user_id.first_name":"author->first_name","user_id.last_name":"author->last_name","user_id.login":"author->login",picture_update:"author->picture_update","user_id.picture_update":"author->picture_update"},_associations:{author:{Class:f},commented:{},contentMedia:{}},_servicesMode:{post:{create:{url:"api/comment/add",dataFn:function(){return{comment:this.get("comment"),community_post_id:this.get("parentId")}}},update:{url:"api/comment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/comment/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/comment/delete",dataFn:function(){return{id:this.get("mid")}}}},idea:{create:{url:"api/IdeationComment/add",dataFn:function(){return{comment:this.get("comment"),id:this.get("parentId")}}},update:{url:"api/IdeationComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/IdeationComment/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/IdeationComment/delete",dataFn:function(){return{id:this.get("mid")}}}},wiki:{create:{url:"api/WikiTreeComment/add",dataFn:function(){return{comment:this.get("comment"),wikitree_id:this.get("parentId")}}},update:{url:"api/WikiTreeComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/WikiTreeComment/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/WikiTreeComment/delete",dataFn:function(){return{id:this.get("mid")}}}},media:{create:{url:"api/MediaComment/add",dataFn:function(){return{comment:this.get("comment"),media_id:this.get("parentId")}}},update:{url:"api/MediaComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/MediaComment/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/MediaComment/delete",dataFn:function(){return{id:this.get("mid")}}}}},HTML_ATTRIBUTES:["comment"],defaults:{_acl:{update:{privilege:null,access:false},"delete":{privilege:null,access:false}}},init:function(i,j){var g=d.getInstance().get("user"),h=g.first_name+" "+g.last_name,l=g.hash_key,m=g.picture_update;this.defaults=e.extend({},this.defaults||{});if(!this.defaults.author){this.defaults.author={nickname:h,hash_key:l,picture_update:m}}var k=j.commentType?j.commentType:j.collection.mode;switch(k){case"post":case"media":case"wiki":case"idea":this._services=this._servicesMode[k];break;case"iquestion":break;default:}return this._parent(i,j)},remove:function(g){return this.action("remove",g)},getAuthor:function(){return this.getAssociated("author")},"onSync:remove":function(){var g=d.getInstance().get("user");if(this.getAssociated("author").get("hash_key")===g.hash_key){this.set("moderation_status","deleted_by_author")}else{this.set("moderation_status","deleted")}this.set("update",c.getCurrentDate());this._parent.apply(this,arguments)},"onSync:update":function(){var g=d.getInstance().get("user");if(this.getAssociated("author").get("hash_key")===g.hash_key){this.set("moderation_status","updated_by_author")}else{this.set("moderation_status","updated")}this._parent.apply(this,arguments)}});require(["DS/SwymUICore/script/feature/community/media/collection/media-collection"],function(g){b.prototype._associations.contentMedia.Class=g;b.prototype._associations.contentMedia.oppositeRole="usedIn"});return b});define("DS/SwymUICore/script/feature/community/comment/collection/comment-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/WebappsUtils/Console"],function(j,g,k,c){var n=function(o){if(o&&o.status_id){return false}else{return true}},a=function(o){if(o&&o.moderation_status&&((o.moderation_status==="deleted")||(o.moderation_status==="deleted_by_author"))){return false}else{return true}},h=function(o){if(window.ds&&window.ds.swymVersion==="v3"){if(j.is(o,"array")){o=o.filter(a)}}return o},m=k.extend({_modelName:"post-comment-model"}),e=k.extend({_modelName:"media-comment-model"}),b=k.extend({_modelName:"idea-comment-model"}),d=k.extend({_modelName:"answer-comment-model"}),i=k.extend({_modelName:"wiki-comment-model"}),l=function(p,o){var q=null;switch(o.collection.mode){case"post":q=m;break;case"iq-answer":q=d;break;case"idea":q=b;break;case"media":q=e;break;case"wiki":q=i;break}return new q(p,o)},f=g.extend({model:l,mode:null,modes:["iq-answer","post","media","idea","wiki"],parentId:null,_associations:{commented:{}},_services:{read:{"iq-answer":{url:"api/IquestionsComment/list",dataFn:function(){if(!this.parentId){var o=this.getAssociated("commented");this.parentId=o&&o.get("mid")}return{answer_id:this.parentId,limit:9999}},parse:h,postProcess:function(o){if(j.is(o,"object")&&j.is(o.result,"array")){o.result.forEach(function(p){if(p&&p.qna_id){p.id=p.qna_id}})}}},post:{url:"api/comment/list",dataFn:function(){if(!this.parentId){var o=this.getAssociated("commented");this.parentId=o&&o.get("mid")}return{community_post_id:this.parentId,limit:9999}},parse:h},media:{url:"api/MediaComment/list",dataFn:function(){if(!this.parentId){var o=this.getAssociated("commented");this.parentId=o&&o.get("mid")}return{media_id:this.parentId,limit:9999,order:"asc"}},parse:h},idea:{url:"api/IdeationComment/list",dataFn:function(){if(!this.parentId){var o=this.getAssociated("commented");this.parentId=o&&o.get("mid")}return{id:this.parentId,limit:9999}},parse:h},wiki:{url:"api/WikiTreeComment/list",dataFn:function(){if(!this.parentId){var o=this.getAssociated("commented");this.parentId=o&&o.get("mid")}return{wikitree_id:this.parentId,limit:9999}},parse:h}}},setup:function(p,o){if(o.parentId){this.parentId=o.parentId}},_addAssociationFromCollectionToModels:function(s,t){var r,q,p,t=t||this._models,o=t?t.length:0;if(p=this.getAssociated(s)){for(r=0;r<o;r++){q=t[r];q.setAssociated(s,p)}}},_updateCommentCounter:function(){var o;if(o=this.getAssociated("commented")){o.set("nb_comments",this.length)}},"onSetAssociated:commented":function(p,q,o){if(this===p){this.stopListening(q,"onSync");this._addAssociationFromCollectionToModels("commented")}},onAdd:function(o){this._addAssociationFromCollectionToModels("commented",[o])},addComment:function(p){if(p instanceof k){var o=this;p.save({},{onComplete:function(q){o.add(q)}})}else{throw {name:"Incorrect comment type",message:"The comment you are trying to add is not for an IQuestion."}}},editComment:function(p){try{if(p instanceof k){p.save({})}else{throw {name:"Incorrect model type",message:"The model you are trying to edit is not a comment."}}}catch(o){c.error("Error in saving changes to comment: "+o.message);return}},filterDeletedAndStatusRelatedComments:function(o){if(!j.is(o,"array")){o=this.toJSON()}return o.filter(a).filter(n)}});return f});define("DS/SwymUICore/script/feature/core/network/model/request-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model"],function(c,a,b){var d=a.extend({_modelName:"request",_attributesMapping:{first_name:"user->first_name",hash_key:"user->hash_key",last_name:"user->last_name",nickname:"user->nickname",user_id:"user->mid"},_associations:{user:{Class:b}},_services:{moderate:{url:"api/network/updaterequestsnetwork",dataFn:function(e){return{notification_id:this.get("mid"),group_id:e.group_id,accept_status:e.accept_status}}}},moderate:function(e){return this.action("moderate",e)},defaults:{}});return d});define("DS/SwymUICore/script/feature/core/network/model/activity-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","i18n!DS/SwymUICore/assets/nls/feature/core/timeline/model/activity-model"],function(g,a,d,f,h,b,e){var c=a.extend({_modelName:"activity",HTML_ATTRIBUTES:["img","text"],attr:"",_errorMessage:"error: message not found",_attributesMapping:{feed_time:"date",user_name:"url",feed_text:"text"},parse:function(j,i){this.attr=this._parent.apply(this,arguments);this.attr.img=h.constructUserPictureUrl(this.attr.user.login,this.attr.user.user_picture_fingerprint);this.attr.text=this._buildcontent();this.attr.date=this.attr.date.replace(" ","T")+"Z";this.attr.text=this.attr.text!==this._errorMessage?this.attr.text:"";return this.attr},_getContentType:function(i){switch(i){case"question":return"iquestion";case"ideation":return"idea";case"wikipage":return"wiki";default:return i}},_getCommunityId:function(i){var j=i||this.attr;return((j.community&&j.community.id)||j.community_id)},_buildcontent:function(o){var i=this._getMessage(),n='<a class="link" data-content-type="person" data-login="'+this.attr.user.login+'">'+this.attr.user.first_name+" "+this.attr.user.last_name+"</a>",p='<a class="link" data-content-type="person" data-login="'+this.attr.target_id+'">'+this.attr.target_label+"</a>",j=this.attr.target_label,l='<a class="link" data-facet="1" data-content-type="person" data-login="'+this.attr.user.login+'">'+this.attr.user.first_name+" "+this.attr.user.last_name+"</a>",k='<a class="link" data-content-type="community" data-content-id="'+this._getCommunityId()+'">'+this.attr.community.title+"</a>",q='<a data-type="internal" data-content-type="'+this._getContentType((this.attr.type==="endorse")?this.attr.subtype:this.attr.type)+'" data-community-id="'+this._getCommunityId()+'" data-content-id="'+this.attr.target_id+'" data-source="swym">'+this.attr.target_label+"</a>",m=this._getRole();i=i&&i!==this._errorMessage?e.replace(i,{http_user_link:n,http_community_link:k,http_post_link:q,http_media_link:q,http_document_link:q,http_wikipage_link:q,http_iquestion_link:q,http_ideation_link:q,http_target_user_link:p,item_title:q,http_content_link:q,http_profile_update:j,http_profile_link:l,user_role:m}):this._errorMessage;return i},_getRole:function(){var i="";if(this.attr&&this.attr.action&&this.attr.type&&this.attr.action==="update"&&this.attr.type==="community"&&this.attr.subtype){switch(this.attr.subtype){case"1":i=e.Contributor;break;case"2":i=e.Author;break;case"3":i=e.Owner;break;default:console.log("community role not found");break}}return i},_getMessage:function(){var j=this._errorMessage,k;if(g.is(this.attr.type)&&g.is(this.attr.action)){k=this.attr.action;switch(this.attr.type){case"post":if(g.is(this.attr.subtype)&&this.attr.subtype==="comment"){j=e[k+"PostCommentText"]}else{j=e[k+"PostText"]}break;case"question":case"iquestion":if(g.is(this.attr.subtype)){if(this.attr.subtype==="comment"){j=e[k+"AnswerCommentText"]}else{if(this.attr.subtype==="answer"){j=e[k+"AnswerText"]}}}else{j=e[k+"QuestionText"]}break;case"media":if(g.is(this.attr.subtype)&&this.attr.subtype==="comment"){j=e[k+"MediaCommentText"]}else{j=e[k+"MediaText"]}break;case"idea":case"ideation":if(g.is(this.attr.subtype)&&this.attr.subtype==="comment"){j=e[k+"IdeationCommentText"]}else{j=e[k+"IdeationText"]}break;case"wiki":case"wikipage":if(g.is(this.attr.subtype)&&this.attr.subtype==="comment"){j=e[k+"WikiPageCommentText"]}else{j=e[k+"WikiPageText"]}break;case"community":j=e[k+"CommunityMembershipText"];break;case"endorse":switch(this.attr.subtype){case"post":j=e[k+"PostEndorseText"];break;case"media":j=e[k+"MediaEndorseText"];break;case"question":case"iquestion":j=e[k+"QuestionEndorseText"];break;case"idea":case"ideation":j=e[k+"IdeationEndorseText"];break;case"wiki":case"wikipage":j=e[k+"WikiPageEndorseText"];break}break;case"skill":j=e[k+"ProfileSkillText"];break;case"interest":j=e[k+"ProfileInterestText"];break;case"education":j=e[k+"ProfileEducationText"];break;case"work":j=e[k+"ProfileWorkText"];break;case"spokenlanguage":j=e[k+"ProfileSpokenLanguageText"];break;case"link":j=e[k+"ProfileLinkText"];break;case"profile":j=e[k+"ProfileText"];break;case"network":var i=b.getInstanceFetched();if(i&&i.get("login")===this.attr.target_id){j=e.addSelfUserNetworkText}else{j=e[k+"NetworkMembershipText"]}break}}return j}});return c});define("DS/SwymUICore/script/feature/community/report-abuse/model/report-abuse-model-v2",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/user/model/user-model","DS/Logger/Logger"],function(f,a,e,g,c){var d=g.extend({_provokeCacheUpdates:false,_attributesMapping:{firstName:"first_name",lastName:"last_name"}});var b=a.extend({_modelName:"report-abuse",_modelIdAttribute:"reportAbuseUri",_attributesMapping:{id:"id"},_services:{create:{url:"",wrapData:false,dataFn:function(h){return{subjectUri:h.subjectUri||"",parentCommentUri:h.parentCommentUri,subjectUrl:h.subjectUrl||"",subjectType:h.subjectType||"",subjectTitle:h.subjectTitle||"",contextUri:h.contextUri||"",description:h.description||"",reasons:h.reasons||[]}}}},_associations:{author:{Class:d}},defaults:{reportAbuseUri:undefined,parentCommentUri:undefined,linkServiceName:"",linkUri:"",subjectUri:"",subjectUrl:"",subjectType:"",subjectTitle:"",contextUri:"",description:"",reasons:null,serviceName:"3DSwym",author:null,creationDate:""},_computeUrlRoot:function(){var h=this.get("subjectUri");if(h){return e.getBaseUrl()+"/commentproxy/subjects/"+h+"/reportabuses"}throw new Error("No subject URI found on Report Abuse model")},sync:function(){this.urlRoot=this._computeUrlRoot();return this._parent.apply(this,arguments)}});return b});define("DS/SwymUICore/script/feature/core/auto-save/model/auto-save-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model"],function(a,d){var b={},f=false,c=a.extend({_modelName:"auto-save",_modelIdAttribute:"autosave_id",_services:{create:{url:"api/autosaves",wrapData:false,method:"POST"},read:{url:"api/autosaves",method:"GET"},update:{url:"api/autosaves",wrapData:false,dataType:"json",method:"PUT",dataFn:function(){return{content_type:this.get("content_type"),community_id:this.get("community_id"),content_id:this.get("content_id"),content_title:this.get("content_title"),content_message:this.get("content_message"),content_options:this.get("content_options")}}},"delete":{url:"api/autosaves",method:"DELETE"}},defaults:{community_id:"",content_id:null,content_message:"",content_options:"",content_title:"",content_type:"",autosave_id:null,autosave_date:""},get:function(g,h){h={escapeHTML:false};return this._parent.apply(this,[g,h])}});var e=null;b.getInstance=function(){if(e===null){e=new c()}return e};b.deleteInstance=function(){if(e&&e.get("autosave_id")){e.destroy()}f=true;e=null};return b});define("DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model",["UWA/Core","DS/SwymUICore/script/feature/community/comment/model/comment-model","DS/SwymUICore/script/utils/date"],function(d,b,c){var a=b.extend({_modelName:"iqa-comment",_tableName:"QnaComment",_attributesMapping:{qna_id:"mid",qna_update:"update",qna_answer_id:"answer_id","user_id.nickname":"nickname","user_id.hash_key":"hash_key"},_services:{create:{url:"api/IquestionsComment/add",dataFn:function(e){e=e||{};e.qna_answer_id=this.get("answer_id")||this.get("parentId");e.comment=e.comment||this.get("comment");return e}},update:{url:"api/IquestionsComment/edit",paramsMapping:{mid:"id"}},remove:{url:"api/IquestionsComment/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/IquestionsComment/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{},"onSync:update":function(){this.set("update",c.getCurrentDate())},"onSync:remove":function(){this.set("update",c.getCurrentDate())},remove:function(e){return this.action("remove",e)}});return a});define("DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/iquestion/model/iqa-comment-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(i,n,c,m,h,j,k,f,a,b){var d=((window.widget&&window.widget.id)?(window.widget.id+"-"):"")+"answerSortField",e="update",l="rate",g=n.extend({_modelName:"iq-answer",_tableName:"QnaAnswer",_attributesMapping:{qna_id:"mid",answer_id:"mid",nickname:"author->nickname",hash_key:"author->hash_key","user_id.nickname":"author->nickname","user_id.hash_key":"author->hash_key",question_id:"iquestion_id",qna_question_id:"question_id",comment_count:"nb_comments",count_comment:"nb_comments",stats_comments:"nb_comments"},_associations:{author:{Class:j},comments:{Class:c,oppositeRole:"commented",options:{mode:"iq-answer",model:h}},commenters:{Class:m,oppositeRole:"commented",options:{mode:"comment"}},answeredFor:{}},_services:{create:{url:"api/IquestionsAnswer/add",dataFn:function(o){o=o||{};o.answer=o.answer||this.get("answer");o.qna_question_id=this.get("iquestion_id")||this.get("parentId");return o}},update:{url:"api/IquestionsAnswer/edit",paramsMapping:{mid:"id"},parse:function(o){if(o&&o.moderation_date){o.update=o.moderation_date}return o}},validateAnswer:{url:"api/IquestionsAnswer/validanswer",dataFn:function(){return{answer_id:this.get("mid")}}},positiveRate:{url:"api/IquestionsAnswer/addrate",dataFn:function(){return{qna_answer_id:this.get("mid"),ratevalue:1}},parse:function(o){o.my_rate="1";return o}},negativeRate:{url:"api/IquestionsAnswer/addrate",dataFn:function(){return{qna_answer_id:this.get("mid"),ratevalue:0}},parse:function(o){o.my_rate="0";return o}},remove:{url:"api/IquestionsAnswer/delete",dataFn:function(){return{id:this.get("mid")}}},"delete":{url:"api/IquestionsAnswer/delete",dataFn:function(){return{id:this.get("mid")}}}},defaults:{title:"",rate:0,nb_comments:0,has_rated:0,can_vote:0,validate:"0",_acl:{update:{groupIdentifier:"CONTENT_OWNER",access:true},"delete":{groupIdentifier:"CONTENT_OWNER",access:true}},moderation_status:"no_moderation"},HTML_ATTRIBUTES:["answer"],_getNbCommentsFromCommentCollection:function(){var o=this._associations&&this._associations.comments.associated;if(o&&o.hasBeenFetched()){return o.filterDeletedAndStatusRelatedComments().length}else{return false}},_recomputeNbCommentsIfNeeded:function(){var o=this._getNbCommentsFromCommentCollection();if(o!==false){return this.set("nb_comments",o)}},init:function(q,r){var o=k.getInstance().get("user"),s=o.first_name+" "+o.last_name,p=o.hash_key;this.defaults.nickname=s;this.defaults.hash_key=p;return this._parent(q,r)},getCommenters:function(){return this.getAssociated("commenters")},getCommentCollection:function(){return this.getAssociated("comments")},fetchComments:function(o){this.getCommentCollection().fetch(o)},addComment:function(p){try{this.getCommentCollection().addComment(p);this.getCommentCollection().addEventOnce("onAdd",function(){this.dispatchEvent("commentCreated")}.bind(this))}catch(o){b.error("Error adding new answer to collection: "+o.message)}},getNbComments:function(){var o=this._getNbCommentsFromCommentCollection();if(o!==false){return o}else{return this.get("nb_comments")}},"onSetAssociated:comments":function(q,p,o){this.listenTo(o,"onCollectionChange",this._recomputeNbCommentsIfNeeded);return this._parent.apply(this,arguments)},"onChange:nb_comments":function(){this._recomputeNbCommentsIfNeeded()},"onSync:positiveRate":function(){this.set("has_rated",1)},"onSync:negativeRate":function(){this.set("has_rated",1)},"onSync:update":function(){this.set("update",f.getCurrentDate())},"onSync:remove":function(){this.set("update",f.getCurrentDate())},positiveRate:function(o){return this.action("positiveRate",o)},negativeRate:function(o){return this.action("negativeRate",o)},validateAnswer:function(o){return this.action("validateAnswer",o)},remove:function(o){return this.action("remove",o)},getAuthor:function(){return this.getAssociated("author")},getCommunity:function(){var o=this.getAssociated("answeredFor");if(i.is(o.getCommunity,"function")){return o.getCommunity()}else{throw new Error("This was not supposed to happen!")}},getRelativePath:function(){if(!this.get("community_id")){b.log("exception : there is no community defined !!!")}return a.URLPART_COMMUNITY+this.get("community_id")+a.URLCONTENT_IQUESTION+this.get("iquestion_id")}});g.LocalStorageKeyForSort=d;g.DateField=e;g.VoteField=l;return g});define("DS/SwymUICore/script/feature/core/network/model/network-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/group/collection/group-collection","DS/WebappsUtils/Console"],function(f,a,d,c,g,b){var e=a.extend({_modelName:"network",_attributesMapping:{},_services:{read:{url:"api/network/getnetworkbyuser",dataFn:function(){return{hash_key:this.get("hash_key")}}}},defaults:{},_associations:{users:{Class:d,options:{mode:null,limit:10}},groups:{Class:g,options:{mode:null}},user:{Class:c}}});return e});define("DS/SwymUICore/script/feature/core/context/context-change-actions",["UWA/Core","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/history/history-model","DS/Logger/Logger"],function(f,a,e){function b(){var i,j,g=false,h=a.getInstance();if(h&&h.isPreviousPathAListing(h)){i=[a.COMMUNITY_BLOG,a.COMMUNITY_MEDIA,a.COMMUNITY_IDEAS,a.COMMUNITY_SURVEYS];j=h.getCommunityPageContext(h.path);if(i.indexOf(j)<0){g=true}}if(g){require(["DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model"],function(k){window.localStorage.removeItem(k.LocalStorageKeyForSort)})}}var c=[b],d=function(){for(var h=0,g=c.length;h<g;h++){c[h]()}};e.addEvent("onHistoryStateChange",d)});define("DS/SwymUICore/script/utils/im-core-utils",["UWA/Core","DS/SwymUICore/script/feature/community/timeline/model/community-event-model","DS/SwymUICore/script/feature/community/timeline/model/community-content-event-model","DS/SwymUICore/script/feature/community/timeline/model/im-event-model","DS/SwymUICore/script/feature/community/timeline/model/external-event-model"],function(g,d,a,b,c){function f(l){var m;switch(l.message_type){case h:m=a;break;case k:m=d;break;case i:m=b;break;case j:m=c;break;default:throw new Error("Unknown type of message found")}return m}var h="INTERNAL_CONTENT",k="INTERNAL_EVENT",i="INSTANT_MESSAGE",j="EXTERNAL_EVENT",e={TYPES:{COMMENT_TYPE:"comment",ANSWER_TYPE:"answer",POST_MODEL_TYPE_TABLE:"CommunityPost",IDEA_MODEL_TYPE_TABLE:"Dsi_Ideation_Ideation",QUESTION_MODEL_TYPE_TABLE:"QnaQuestion",MEDIA_MODEL_TYPE_TABLE:"Media",WIKI_MODEL_TYPE_TABLE:"Dsi_DFSTree_WikiTree",SURVEY_MODEL_TYPE_TABLE:"poll",POST_MODEL_TYPE:"post",IDEA_MODEL_TYPE:"ideation",QUESTION_MODEL_TYPE:"question",MEDIA_MODEL_TYPE:"Media",WIKI_MODEL_TYPE:"wikipage",SURVEY_MODEL_TYPE:"Survey",COMMUNITY_MODEL_TYPE:"community"},getEventModel:f,getEventModelInstance:function(m,l){var p=this.getEventModel||f,o=p(m),n=l?g.clone(l,false):{};if(!n.hasOwnProperty("areModelDataFromServer")){n.areModelDataFromServer=true}return new o(m,n)}};return e});define("DS/SwymUICore/script/feature/community/community/model/community-model",["UWA/Core","UWA/Promise","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/community/idea/collection/status-collection","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/lib/event-manager","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","i18n!DS/SwymUICore/assets/nls/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/subscribable","DS/WebappsUtils/Console"],function(a,f,y,i,b,k,n,e,v,c,q,p,l,w){var m="DM-",u="dm",t="community",d=4,h=3,s=2,r=1,o=1,g=1,j=4;var x=y.extend(l,{_modelName:"community",_asAdmin:false,_attributesMapping:{community_id:"mid",creationDate:"creation_date",owner_hash_key:"owner->hash_key",user_id_hash_key:"owner->hash_key","user_id.hash_key":"owner->hash_key",hash_key:"owner->hash_key",name:"owner->nickname",nickname:"owner->nickname",user_name:"owner->nickname","user_id.nickname":"owner->nickname",owner_display_name:"owner->nickname",user_id_emplid:"owner->empl_id","user_id.email":"owner->email","user_id.first_name":"owner->first_name","user_id.last_name":"owner->last_name","user_id.login":"owner->login",user_picture_fingerprint:"owner->user_picture_fingerprint",userPictureUpdate:"owner->picture_update","user_id.picture_update":"owner->picture_update",user_picture_update:"owner->picture_update",owner_picture_update:"owner->picture_update",media_id:"thumbnail->mid",thumbnail_id:"thumbnail->mid",logo_media_id:"thumbnail->mid",uri:"subject6wuri",id:"mid",published:"crdate",updated:"update",displayName:"title",summary:"description",community_description:"description",username:"owner->login"},_services:{create:{url:"api/community/add",parse:function(z){var B={"this->getCurrentUserRights":h,qna_is_enabled:true,qna_min_acl:s,ideation_is_enabled:true,ideation_min_acl:s,survey_is_enabled:true,survey_min_acl:s,wiki_is_enabled:true,wiki_min_acl:s};for(var A in B){if(B.hasOwnProperty(A)&&!z[A]){z[A]=B[A]}}return z}},read:{url:"api/community/get",dataFn:function(z){return{id:this.get("mid"),return_6wtags:false,as_admin:(z.as_admin?z.as_admin:false)||this._asAdmin}}},update:{url:"api/community/edit",paramsMapping:{mid:"community_id"},parse:function(z){z.as_admin=null;return z}},"delete":{url:"api/community/disablecommunities",dataFn:function(){return{list_communities:this.get("mid")+":1"}}},"read-tags":{url:"api/community/get",dataFn:function(){return{id:this.get("mid"),return_6wtags:true}},parse:function(z){return{tags6w:z.tags6w,tags6w_implicit:z.tags6w_implicit}}},follow:{url:"api/userPreferences/follow",dataFn:function(){return{id:this.get("mid"),model:"Community"}}},unfollow:{url:"api/userPreferences/unfollow",dataFn:function(){return{id:this.get("mid"),model:"Community"}}},contentHighlightMask:{},deletecurrentuserfromcommunity:{url:"api/community/deletercurrentuserfromcommunity",dataFn:function(){return{community_id:this.get("mid")}}},checktitleuniqueness:{url:"api/community/checktitleuniqueness",dataFn:function(){return{title:this.getChanges("title")}}},getidcardstats:{url:"api/community/idcardstats",dataFn:function(){return{id:this.get("mid")}}},setlogo:{url:"api/community/edit",dataFn:function(A){var z;if(A&&A.reset_to_default){z={logo_media_uri:"",community_id:this.get("mid"),as_admin:(A.as_admin?A.as_admin:false)||this._asAdmin}}else{z={logo_type:A.logo_type||2,community_id:this.get("mid"),logo_media_uri:A.logo_media_uri,as_admin:(A.as_admin?A.as_admin:false)||this._asAdmin}}return z}},editmembers:{url:"api/community/editmembers",dataFn:function(z){return{community_id:this.get("mid"),settings_members:z.settings_members,as_admin:(z.as_admin?z.as_admin:false)}}},changerolerequest:{url:"api/notification/changerolerequest",dataFn:function(z){return{community_id:this.get("mid"),message:z.message}}},addFavorite:{url:"api/favorites/communities",wrapData:false,dataType:"json",method:"PATCH",dataFn:function(){return{external_id:this.get("mid"),position:this.get("position")}}},removeFavorite:{url:"api/favorites/communities",method:"DELETE",dataType:"json",wrapData:false,dataFn:function(){return{external_id:this.get("mid")}}},nbIdeasPerStatus:{url:"api/Ideation/getnbideaperstatus",dataFn:function(z){return{community_id:this.get("mid")}},parse:function(A){var z=this.getStatus();A.forEach(function(B){z.findWhere({mid:B.status_id}).set("nb_ideas",B.nb_ideas)});return A}}},_associations:{owner:{Class:i},thumbnail:{Class:null},owners:{Class:k,oppositeRole:"owned",options:{mode:"listmembers",limit:9999,filters:[{type:"team_role_filter",values:h}]}},"possible-main-owners":{Class:k,oppositeRole:"owned",options:{mode:"listmembers",limit:9999,usersOnly:true,filters:[{type:"team_role_filter",values:h}]}},bots:{Class:k,options:{mode:"listbots",limit:999}},members:{Class:k,options:{mode:"listmembers",limit:9999}},status:{Class:n,oppositeRole:"community",sourceAttribute:"ideation_status",options:{mode:"community",comparator:"status_nb"}},wiki:{Class:null}},HTML_ATTRIBUTES:["description"],defaults:{_containsContentUnreadByCurrentUser:undefined,isBlacklisted:false,title:"",description:"",popup_members:"",mark:undefined,last_message:undefined},isDirectMessage:function(){switch(this.get("community_type")){case u:return true;case t:return false;default:return null}},getMainOwner:function(){return this.getAssociated("owner")},getOwners:function(){return this.getAssociated("owners")},getPossibleMainOwners:function(){return this.getAssociated("possible-main-owners")},getMembers:function(){return this.getAssociated("members")},getStatus:function(){var A=this,z=this.getAssociated("status");if(!z.hasBeenFetched()&&!z.isBeingFetched()){z.fetch({onComplete:function(B){A.set("ideation_status",B.toJSON())}})}return z},getNbIdeasPerStatus:function(z){return this.action("nbIdeasPerStatus",z)},_buildContentHighlightMaskUrl:function(){return"api/community/"+this.get("mid")+"/user/hiddenHlContent"},_resultIsMaskHighlighted:"",isContentHighlightHidden:c.debounce(function(A){var z;if(this._resultIsMaskHighlighted===""){z=this.action("contentHighlightMask",{wrapdData:false,method:"GET",url:this._buildContentHighlightMaskUrl(),onComplete:function(C,B){this._resultIsMaskHighlighted=B;A.onComplete.apply(this,arguments)}.bind(this),onFailure:function(){console.log("Content highlight mask has failed")}})}else{A.onComplete(this,this._resultIsMaskHighlighted)}return z},300),hideContentHighlight:function(z){return this.action("contentHighlightMask",{wrapdData:false,method:"POST",url:this._buildContentHighlightMaskUrl(),onComplete:z.onComplete,onFailure:z.onFailure})},updateFavorite:function(A,z){if(A){this.set({is_favorite:true,position:z?z:null});return this.action("addFavorite")}else{this.set("is_favorite",false);return this.action("removeFavorite")}},destroy:function(z){return this.action("delete",z)},checktitleuniqueness:function(z){return this.action("checktitleuniqueness",z)},getidcardstats:function(z){return this.action("getidcardstats",z)},follow:function(z){return this.action("follow",z)},unfollow:function(z){return this.action("unfollow",z)},deletecurrentuserfromcommunity:function(z){return this.action("deletecurrentuserfromcommunity",z)},changerolerequest:function(z){return this.action("changerolerequest",z)},getCommunityType:function(z){return this.action("getCommunityType",z)},fetchTags:function(z){return this.action("read-tags",z)},validateField:function(A,z){switch(A){case"title":if(!z||z.trim()===""){return"err-empty"}else{if(z.length>255){return"err-length"}}return false;case"description":if(!z||z.trim()===""){return"err-empty"}return false;default:return false}},getUserRole:function(){if(this.has("this")&&this.get("this").getCurrentUserRights){return parseInt((this.get("this").getCurrentUserRights),10)}else{if(this.get("user_access")){return parseInt((this.get("user_access")),10)}}},getCommunityLogoUrl:function(z){var B="thumb",A="m_thumb";if(z){if(z.type){B=z.type}if(z.key){A=z.key}}return c.getBaseUrl()+"/api/media/getcommunitylogo/community_id/"+this.get("mid")+"/type/"+B+"/key/"+A+"/"+new Date(this.get("update")).getTime()},hasDefaultLogo:function(){var z=this.get("thumbnail->mid");return(parseInt(this.get("logo"),10)!==2&&(!z||z==="0"))},creationRightsAvailable:function(){var z=this,A=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("qna_is_enabled")&&z.has("qna_min_acl")&&z.has("ideation_is_enabled")&&z.has("ideation_min_acl")&&z.has("wiki_is_enabled")&&z.has("wiki_min_acl")&&z.has("survey_is_enabled")&&z.has("survey_min_acl")){A=true}return A},canCreateMessages:function(){return this.get("instant_message_is_enabled")},canCreatePosts:function(){var A,z=this,B=false;if(z.has("this")&&z.get("this").getCurrentUserRights){A=parseInt((z.get("this").getCurrentUserRights),10);if(A>=s){B=true}}return B},canCreateMedia:function(){var A,z=this,B=false;if(z.has("this")&&z.get("this").getCurrentUserRights){A=parseInt(z.get("this").getCurrentUserRights,10)}else{if(z.has("user_access")){A=parseInt(z.get("user_access"))}}if(A&&A>=s){B=true}return B},canCreateQuestions:function(){var A,z=this,B=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("qna_is_enabled")&&z.has("qna_min_acl")){A=parseInt((z.get("this").getCurrentUserRights),10);if((z.get("qna_is_enabled")===true)&&(A>=parseInt(z.get("qna_min_acl"),10))){B=true}}return B},canCreateIdeas:function(){var A,z=this,B=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("ideation_is_enabled")&&z.has("ideation_min_acl")){A=parseInt((z.get("this").getCurrentUserRights),10);if((z.get("ideation_is_enabled")===true)&&(A>=parseInt(z.get("ideation_min_acl"),10))){B=true}}return B},canCreateWikiPages:function(){var B,z=this,A=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("wiki_is_enabled")&&z.has("wiki_min_acl")){B=parseInt((z.get("this").getCurrentUserRights),10);if((z.get("wiki_is_enabled")===true)&&(B>=parseInt(z.get("wiki_min_acl"),10))){A=true}}return A},canReorganizeWikiPages:function(){var B,z=this,A=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("wiki_is_enabled")&&z.has("wiki_min_acl")){B=parseInt((z.get("this").getCurrentUserRights),10);if((z.get("wiki_is_enabled")===true)&&(B>=parseInt(z.get("wiki_min_acl"),10))&&(B>=h)){A=true}}return A},canCreateSurveys:function(){var B,A=this,z=false;if(A.has("this")&&A.get("this").getCurrentUserRights&&A.has("survey_is_enabled")&&A.has("survey_min_acl")){B=parseInt((A.get("this").getCurrentUserRights),10);if((A.get("survey_is_enabled")===true)&&(B>=parseInt(A.get("survey_min_acl"),10))){z=true}}return z},isCommunityFeaturesAccessAvailable:function(){var z=this,A=false;if(z.has("this")&&z.get("this").getCurrentUserRights&&z.has("wiki_is_enabled")&&z.has("wiki_min_acl")&&z.has("ideation_is_enabled")&&z.has("ideation_min_acl")&&z.has("survey_is_enabled")&&z.has("survey_min_acl")&&z.has("qna_is_enabled")&&z.has("qna_min_acl")){A=true}return A},getCommunityFeaturesAccess:function(){var M=this,K=false,D=false,C=false,I=false,L=false,E=false,P,N,B,A,z,O,F,H,G,J;if(M.has("this")&&M.get("this").getCurrentUserRights&&M.has("wiki_is_enabled")&&M.has("wiki_min_acl")&&M.has("ideation_is_enabled")&&M.has("ideation_min_acl")&&M.has("survey_is_enabled")&&M.has("survey_min_acl")&&M.has("qna_is_enabled")&&M.has("qna_min_acl")){P=parseInt((M.get("this").getCurrentUserRights),10);N=M.get("wiki_is_enabled");B=parseInt(M.get("wiki_min_acl"),10);A=M.get("ideation_is_enabled");z=parseInt(M.get("ideation_min_acl"),10);O=M.get("survey_is_enabled");F=parseInt(M.get("survey_min_acl"),10);H=M.get("qna_is_enabled");G=parseInt(M.get("qna_min_acl"),10);J=parseInt(M.get("stats_min_acl"),10);if(H===true){K=true}if(N===true){D=true}if(A===true){C=true}if(O===true){I=true}if((J!==j)&&(J<=P)){L=true}if(P>=h){E=true}}return{qna_feature:K,wiki_feature:D,ideation_feature:C,survey_feature:I,stats_feature:L,settings_feature:E}},isContributorCreationEnabledInSettings:function(B,A){var z=false;if((B===true)&&(A===g)){z=true}return z},isIdeationContributorCreationEnabledInSettings:function(A,z){return this.isContributorCreationEnabledInSettings(A,z)},isSurveyContributorCreationEnabledInSettings:function(A,z){return this.isContributorCreationEnabledInSettings(A,z)},getRelativePath:function(){var A,z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}A=q.URLPART_COMMUNITY+z;return A},getRelativePathToStats:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_STATS},getRelativePathToSettings:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_SETTINGS},getRelativePathToMedia:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_MEDIA},getRelativePathToIdeations:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_IDEATION},getRelativePathToIquestions:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_IQUESTIONS},getRelativePathToWiki:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_WIKI},getRelativePathToSurveys:function(){var z=this.get("mid");if(!z){w.log("exception : there is no ID community defined !!!")}return q.URLPART_COMMUNITY+z+q.URLTAB_SURVEYS},getTranslatedRole:function(){var B=this.get("role")?this.get("role"):this.getUserRole();if(B===3||B==="Owner"||B=="Co-Owner"){var A=this.getMainOwner();var z=b.getInstance().get("login");if(A.get("login")===z){B="MainOwner"}}switch(B){case"Super Admin":case 4:B=p.SuperAdmin;break;case"MainOwner":B=p.Mainowner;break;case"Co-Owner":case"Owner":case 3:B=p.Owner;break;case"Author":case 2:B=p.Author;break;case"Contributor":case 1:B=p.Contributor;break;default:B=p.None;break}return B},getDeleteRight:function(){var z=null,B=b.getInstance().get("tenant_user_status"),C=b.getInstance().get("login"),A=true;if(B=="0"){z=this.get("access")}else{z=this.get("extranet_access")}if(this.get("role")=="None"||C==this.get("UserLogin")||z==1||C==this.getMainOwner().get("login")){A=false}return A},getVisibility:function(){var z;if(parseInt(b.getInstance().get("tenant_user_status"),10)===1){z=this.get("extranet_access");if(!a.is(z)){z=this.get("community_extranet_access")}}else{z=this.get("access");if(!a.is(z)){z=this.get("community_intranet_access")}}switch(z){case 0:case"0":case"Private":return p.Private;case 1:case"1":case"Public":return p.Public;case 4:case"4":case"Secret":return p.Secret;default:return"Unknown"}},hasCurrentUserAccess:function(){var A,z=this.get("user_access");if(a.is(z)){A=(parseInt(z,10)!==0)}else{A=this.get("hasUserAccess");if(!a.is(A,"boolean")){A=null}}return A},setUserAccess:function(z){z=z===true?1:0;this.set("user_access",z)},setup:function(z){if(a.is(z.asAdmin)){this._asAdmin=z.asAdmin}return this._parent.apply(this,z)},getSubjectURI:function(){var z=this.getSixwURIs();if(z.length<1){throw new Error("The object does not have any subjecturi!")}else{return z[0]}},getMark:function(){return this.get("mark")},hasUnreadContent:function(){return this.get("_containsContentUnreadByCurrentUser")},getLastUnreadContentSummary:function(){return this.get("last_message")&&this.get("last_message").message_details&&(this.get("last_message").message_details.content||this.get("last_message").message_details.title||this.get("last_message").message_details.model_content)},updateUnreadContentStatus:function(){var C=this.get("mark"),B=undefined,z=this.get("_containsContentUnreadByCurrentUser"),A=this.get("last_message");if(A&&A.message_id&&(!C||!C.message_id||(C.message_id!==A.message_id))){B=true}else{B=false}if(z!==B){this.set("_containsContentUnreadByCurrentUser",B);v.dispatchEvent("onThreadUnreadStatusChange",[this,B,A])}},"onSync:read":function(){var z=this;if(window.ds&&(window.ds.swymIM===true)){require(["DS/SwymUICore/script/feature/core/context/context-model"],function(B){var C=B.getInstance(),A=C.isCommunityContext();if(A===z.get("mid")){}else{}})}},"onSync:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(z){z.success(p.SubscribeSuccess)})},"onError:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(z){z.error(p.SubscribeFailure)})},"onSync:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(z){z.success(p.UnsubscribeSuccess)})},"onError:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify"],function(z){z.error(p.UnsubscribeFailure)})},"onChange:mark":function(){this.updateUnreadContentStatus()},"onChange:last_message":function(){this.updateUnreadContentStatus()}});x.COMMUNITY_SUPERUSER_ROLE=d;x.COMMUNITY_OWNER_ROLE=h;x.COMMUNITY_AUTHOR_ROLE=s;x.COMMUNITY_CONTRIBUTOR_ROLE=r;x.FEATURE_ENABLED=o;x.FEATURE_CREATION_CONTRIBUTORS_ENABLED=g;x.DIRECT_MESSAGE_PREFIX=m;require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(z){x.prototype._associations.thumbnail.Class=z});return x});define("DS/SwymUICore/script/feature/community/timeline/model/event-model",["DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/utils/date"],function(c,g,j,h){var a="ACTIVE",e="DELETED",d="NOT_AVAILABLE",f="group-head",b="group-body",i=j.extend({_modelName:"event",_attributesMapping:{message_id:"mid",community_id:"community->mid",community_type:"community->community_type"},getAuthorModelAttributes:function(){},init:function(){this._parent.apply(this,arguments);this.setAssociated("author",new c(this.getAuthorModelAttributes()))},_associations:{author:{Class:c},community:{Class:g}},getAuthor:function(){return this.getAssociated("author")},getCommunity:function(){return this.getAssociated("community")},getReferenceTimestamp:function(){return h.getDateInMilliSec(this.getReferenceDateValue())},getReferenceDate:function(){return h.convertISODateIntoUsualDate(this.getReferenceDateValue())},getReferenceDateValue:function(){return this.get("creation_date")},getReferenceDay:function(){return h.conciseDay(this.getReferenceDateValue())},getPrettyDate:function(){return h.prettyHour(this.getReferenceDateValue())},getGroupStatus:function(){return this.getCustomProperty("groupStatus")},setGroupStatus:function(l){var k=this.getGroupStatus();if((l===b)||(l===f)){if(k!==l){this.setCustomProperty("groupStatus",l);if(k){this.dispatchEvent("onChangeCustomProperty: groupStatus",[l])}}}else{throw new Error("Unknown group status received")}}});i.ACTIVE_STATE=a;i.DELETED_STATE=e;i.NOT_AVAILABLE=d;i.GROUP_HEAD=f;i.GROUP_BODY=b;return i});define("DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model",["DS/SwymUICore/script/feature/community/community/model/community-model"],function(b){var a=b.extend({_modelName:"community",_attributesMapping:{external_id:"mid"},defaults:{isFavorite:true},_services:{read:{url:"api/favorites/communities",method:"GET",dataFn:function(c){return{external_id:c.external_id,position:c.position}}},update:{url:"api/favorites/communities",wrapData:false,dataType:"json",method:"PATCH",dataFn:function(c){return{external_id:c.external_id,position:c.position}}},remove:{url:"api/favorites/communities",method:"DELETE",dataType:"json",wrapData:false,dataFn:function(c){return{external_id:c.external_id}}}},remove:function(c){return this.action("remove",c)},validateField:function(d,c){return false},getModelName:function(){return"community"},get:function(c,d){d={escapeHTML:false};return this._parent.apply(this,[c,d])}});return a});define("DS/SwymUICore/script/feature/community/idea/model/link-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/community/model/community-model"],function(a,c){var b=a.extend({_modelName:"link",_attributesMapping:{id:"mid",community_id:"community->mid",community_title:"community->title"},_associations:{community:{Class:c},linkedModel:{}},_services:{create:{url:"api/IdeationLink/add",paramsMapping:{content_title:"title"}},"delete":{url:"api/IdeationLink/delete",dataFn:function(){return{ideation_link_id:this.get("mid")}}}}});return b});define("DS/SwymUICore/script/feature/community/timeline/model/external-event-model",["DS/SwymUICore/script/feature/community/timeline/model/event-model"],function(a){return a.extend({_modelName:"external-event",getAuthorModelAttributes:function(){return this.get("author")}})});define("DS/SwymUICore/script/feature/community/community/model/community-request-model",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/date"],function(d,c,b){var a=c.extend({_modelName:"community-request",_attributesMapping:{id:"mid",community_id:"community_id"},_services:{create:{url:"api/communityRequest/create"},read:{url:"api/communityRequest/get",dataFn:function(){return{id:this.get("mid")}}},decline:{url:"api/communityRequest/sendback",dataFn:function(){return{id:this.get("mid"),status:"decline",additional_comment:this.get("additional_comment",{escapeHTML:false})}}},sendback:{url:"api/communityRequest/sendback",dataFn:function(){return{id:this.get("mid"),status:"sendback",additional_comment:this.get("additional_comment",{escapeHTML:false})}}},accept:{url:"api/communityRequest/accept",dataFn:function(){return{id:this.get("mid")}}},update:{url:"api/communityRequest/update",dataFn:function(){return{id:this.get("mid"),benefits:this.get("benefits",{escapeHTML:false}),description:this.get("description",{escapeHTML:false}),primary_community_owner_hash_key:this.get("primary_community_owner_hash_key"),intranet_access:this.get("intranet_access"),title:this.get("title",{escapeHTML:false}),type_id:this.get("type_id"),lifespan:this.get("lifespan"),go_live_date:this.get("go_live_date"),tags:this.get("tags")}}}},defaults:{tags:"",lifespan:1,go_live_date:b.getCurrentDate()}});return a});define("DS/SwymUICore/script/feature/community/idea/collection/link-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/community/idea/model/link-model"],function(d,c,b){var a=c.extend({_services:{read:{community:{url:"api/IdeationLink/list",dataFn:function(){if(!this.parentId){var e=this.getAssociated("linked");this.parentId=e&&e.get("mid")}return{ideation_id:this.parentId}}}}},_associations:{linked:{}},mode:null,modes:["community"],model:b,parentId:null,setup:function(f,e){if(e.parentId){this.parentId=e.parentId}},onAdd:function(f){var e,g,h;if(f.get("type")==="internal"){switch(f.get("model")){case"CommunityPost":g="post";e="DS/SwymUICore/script/feature/community/post/model/post-model";break;case"Media":g="media";e="DS/SwymUICore/script/feature/community/media/model/media-model";break;case"QnaQuestion":g="iquestion";e="DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model";break;case"Dsi_Ideation_Ideation":g="idea";e="DS/SwymUICore/script/feature/community/idea/model/idea-model";break;case"Dsi_DFSTree_WikiTree":g="wiki";e="DS/SwymUICore/script/feature/community/wiki/model/wiki-model";break;case"Survey":g="survey";e="DS/SwymUICore/script/feature/community/survey/model/survey-model";break}require([e],function(i){h=new i({id:f.get("model_id")});f.setAssociated("linkedModel",h);h.addEvent("onDestroy",function(){if(this.collection){this.collection.remove(this)}},f);this.dispatchEvent("onAddIdeaLink",f)}.bind(this));f.set("contentTypeUrlPart",g)}return f}});return a});define("DS/SwymUICore/script/feature/core/context/context-model",["UWA/Core","UWA/Class","UWA/Class/Events","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/history/history-model","DS/SwymUICore/script/feature/core/stats-manager/stats-manager","DS/SwymUICore/script/feature/core/last-thread-access/last-thread-access-manager","DS/SwymUICore/script/utils/localstorage-utils","DS/SwymUICore/script/utils/usage-tracker"],function(z,aL,I,ah,R,b,d,aC,v){var T={};function ag(aY){var aR,aT,aU=T.getInstance(),aX=aU.getRoute(),aZ=window.ds&&ds.env==="3DSwym",aV=aU.getPreviousPath(),aW=aZ&&aV&&(aU.getPathFromUrl()===aX),aS=aZ?aU.getPathFromUrl(aV):((aU.previousAttributes&&aU.previousAttributes.path)||"");if(aX!==aS){if(!aW){if(aX.match("#content:")){aR=ah.getBaseUrl()+"/#"+aX}else{aR=aU.getPathPrefixFromCurrentPageUrl()+"#"+aX}aT={url:aX,previousContext:aU.previousAttributes};if(!aY||aY&&!aY.appLeftPanelTabChange){R.pushState(aT,G,aR,aU)}}if(aU.isDirectMessageContext()){d.setLastDM(aU.isDirectMessageContext())}else{if(aU.isCommunityContext()||aU.isHomePageContext()){d.setLastCommunity(aU.isCommunityContext())}}v.trackPageView(aX,window.document.title)}else{console.debug("No url change detected!!")}}var az=null,S=null,a=true,w={},i="communityFeedMode",q="dmFeedMode",G="3DEXPERIENCE Platform",V=" - ",P="default",k=/communities\/community:\d+\/?/,ae=/communities\/community:\d+\/(\w+)\/?/,aP=/community:[A-Za-z0-9-_]+\/(\w+)\/?/,aG=/dm:[A-Za-z0-9-_]+\/(\w+)\/?/,ar="/edit$",Z="[A-Za-z0-9-_]+",y="[A-Za-z0-9-_.]+",C="[A-Za-z0-9]{8}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{12}",U="community:("+Z+")",f="dm:("+Z+")",aB="people:("+y+")",D="comment:([%A-Za-z0-9-_]+)",l="answer:([%A-Za-z0-9-_]+)",N="reply:([%A-Za-z0-9-_]+)",aI=new RegExp(aB+"?"),aQ=new RegExp(U+"?"),ao=new RegExp(f+"?"),at=new RegExp(D+"?"),r=new RegExp(N+"?"),ay=new RegExp(l+"?"),X="(post|media|iquestion|question|idea|ideation|survey|wiki|wikiroot):("+Z+")",Q="message:("+C+")",af=new RegExp(ar),an=new RegExp(X+"?"),u=new RegExp(U+"/"+X+"?"),aF=new RegExp(f+"/"+X+"?"),av=new RegExp(U+"/"+Q+"?"),H=new RegExp(f+"/"+Q+"?"),W="DM-",aH="message",F="blog",aj="media",J="gallery",aa="ideas",c="questions",ak="wiki",ac="members",g="settings",e="stats",am="mycontributions",M="surveys",ad="wikiroot",al="mycommunities",au="allcommunities",B="mybookmarks",E="mynetworkactivity",aD="search",j=ah.WHATSNEW_MODE,aM=ah.TIMELINE_MODE,aO="("+aj+")/?$",o=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/"+aO),aN="("+ak+")/?$",aA="("+ad+")/?$",x=new RegExp(U+"/"+aN),n=new RegExp(U+"/"+aA),ax=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/("+F+"|"+aj+"|"+J+"|"+aa+"|"+c+"|"+M+")/?$"),ab=new RegExp("community=("+Z+")?"),m=new RegExp("dm=("+Z+")?"),A=new RegExp("communityType=dm"),t=new RegExp("message=("+C+")?"),aE=new RegExp("contentType=("+Z+")?"),ai=new RegExp("contentId=("+Z+")?"),t=new RegExp("messageId=("+Z+")?"),O=new RegExp("commentUri=("+Z+")?","i"),ap=new RegExp("answerUri=("+Z+")?","i"),h=new RegExp("replyUri=("+Z+")?","i"),aJ=new RegExp("parentCommentUri=("+Z+")?"),Y="admin-tenant",p=new RegExp(Y+"/community:("+Z+")/(members|stats|settings)"),aq=new RegExp(aD+":(.*)"),s=aL.extend(I,{}),aK=new s();var L=aL.extend({_attributeList:["communityId","dmId","feedMode","contentType","contentId","commentUri","replyUri","answerUri","messageUuid","pageName","userHashKey","query","x3dsearchOptions","contextId","tenantId","tenantLabel","communityFacet","communityFacetName","path","editionMode","tenantAdminCommunityFacetName"],_handledAppsIds:[],_currentAppName:null,_currentAppReference:null,previousAttributes:{},_addListener:function(aS,aW,aU,aR,aT,aV){var aX=w[aS];if(aV!==true){aK.addEvent(aS,aW,aU,aT,aV)}if(aR&&aX){aW.apply(aU,z.is(aX,"array")?aX:[aX]);return aW}else{if(aV===true){aK.addEventOnce(aS,aW,aU,aT,aV)}}return true},_onSkeletonRouteChange:function(){var aR,aS,aV=this,aU=T.getInstance(),aT=aV.getModelAt(aV.getCurrentPanelIndex());if(typeof(aT.getModelName)==="function"){aS=aU.getCurrentCommunityFacetFromSkeleton(aV);switch(aT.getModelName()){case"community":aU.reset({communityId:aT.get("mid"),communityFacet:aS});break;case"post":case"media":case"survey":case"idea":case"iquestion":case"wiki":aR=aT.getCommunity();aU.reset({contentId:aT.get("mid"),contentType:aT.getModelName(),communityId:aR.get("mid"),communityFacet:aS});break;default:break}}else{aU.reset()}},getCurrentCommunityFacetFromSkeleton:function(aS){var aR=null;if(z.is(aS.currentRoute,"string")){if(aS.currentRoute.match(k)){aR=aS.currentRoute.match(ae);if(aR&&aR.length===2){aR=aR[1]}else{aR=aS.getActiveIdCard().getSelectedFacet()}}}return aR},getAppTitle:function(aR){var aS=[];if(aR.rootPanelTitlePart){aS.push(aR.rootPanelTitlePart)}return aS.join(V).unescapeHTML()},getAppName:function(){var aR="";if(this._currentAppName){aR=this._currentAppName}return aR},setAppName:function(aR){this._currentAppName=aR;return this},getAppReference:function(){return this._currentAppReference},getFeedModeFromLocalStorage:function(aR){var aS;if(aR==="dm"){if(window.widget&&window.widget.id){aS=aC.getPrefixedItem(q,{widget:window.widget})}else{aS=aC.getItem(q)}}else{if(window.widget&&window.widget.id){aS=aC.getPrefixedItem(i,{widget:window.widget})}else{aS=aC.getItem(i)}}return aS},setFeedModeInLocalStorage:function(aS,aR){if(aR==="dm"){if(window.widget&&window.widget.id){aC.setPrefixedItem(q,aS,{widget:window.widget})}else{aC.setItem(q,aS)}}else{if(window.widget&&window.widget.id){aC.setPrefixedItem(i,aS,{widget:window.widget})}else{aC.setItem(i,aS)}}},setDefaultValues:function(){this.communityId=null;this.dmId=null;this.feedMode=this.feedMode||null;this.contentId=null;this.commentUri=null;this.replyUri=null;this.answerUri=null;this.messageUuid=null;this.contentType="";this.pageName="";this.userHashKey=null;this.path="";this.editionMode=false;this.communityFacet=null;this.communityFacetName=null;this.x3dsearchOptions={};this.previousAttributes={}},initializeAttributes:function(){a=true;this.tenantId=null;this.tenantLabel=null;this._handledAppsIds=[];this._currentAppName=null;this._currentAppReference=null;this.temporaryState=false;this.contextId=null;this.setDefaultValues()},init:function(){this.initializeAttributes();this._parent.apply(this,arguments)},_getURLForStatsManager:function(){var aT=document.location.href,aU=window.ds&&ds.env==="3DSwym",aR,aS;if(!aU){aR=window.widget?widget.getValue("appId"):"";aS=ah.getBaseUrl()+"?app="+aR+"/";aT=aS+this.path}return aT},set:function(aS){var aR={};aR.doNotReset=true;this.reset(aS,aR)},reset:function(bd,aV){var aR,aX=false,a5=false,aY=false,a3=false,a6=false,a4=false,bc=false,a1=false,a9=false,a0=false,a8=false,a2=null,aZ=this._attributeList,aW,bb,aS,ba,aT=this,a7={};if(!z.is(bd,"object")){bd={}}if(bd.contentId&&!(bd.contentType||bd.communityId)){throw new Error("Trying to reset the context with a contentId without a contentType or a communityId")}if(bd.commentUri&&!bd.contentId){throw new Error("Trying to reset the context with a commentUri without a contentId")}if(bd.replyUri&&!bd.commentUri){throw new Error("Trying to reset the context with a replyUri without a commentUri")}if(bd.answerUri&&!(bd.contentId&&bd.contentType==="iquestion")){throw new Error("Trying to reset the answer's URI without providing the related question")}if(bd.messageUuid&&!bd.communityId){throw new Error("Trying to reset the context with a messageUuid without a communityId")}if(!bd.communityId&&bd.dmId){bd.communityId=bd.dmId}if(aV&&aV.previousAttributes){bb=aV.previousAttributes;a3=true}else{bb=this.getData()}if(!(aV&&aV.doNotReset)){this.setDefaultValues()}if(!bd.hasOwnProperty("contextId")&&!bd.hasOwnProperty("tenantId")){if(!bd.path){aW=z.extend(this.getData(),bd);bd.path=this.computeRoute(aW)}else{z.extend(bd,this.extractContextInfoFromRoute(bd.path))}}if(bd.x3dsearchOptions){this.x3dsearchOptions=z.extend(bb.x3dsearchOptions,bd.x3dsearchOptions);aY=true;delete bd.x3dsearchOptions}for(var aU in bd){if(bd.hasOwnProperty(aU)){if(aZ.indexOf(aU)!==-1){this[aU]=bd[aU];if(bb[aU]!==bd[aU]){switch(aU){case"communityId":bc=true;break;case"dmId":a9=true;break;case"feedMode":a1=true;break;case"contentId":a4=true;break;case"userHashKey":aX=true;break;case"path":if(bd.userHashKey){a5=true}break;case"query":aY=true;break;case"contextId":this[aU]=this[aU]||P;a6=true;break;case"contentType":a0=true;break;case"tenantId":case"tenantLabel":a8=true;break;case"tenantAdminCommunityFacetName":a2=this[aU];break;default:break}a3=true;a7[aU]=bd[aU]}}else{throw new Error("The attribute "+aU+" does not exist in the Context object")}}}if(a3){z.extend(this.previousAttributes,bb);if(bc&&!a1){if((this.dmId&&((this.isPreviousContextACommunity())||(this.isPreviousContextNotACommunityOrDM(this.previousAttributes))))){this.feedMode=(this.getFeedModeFromLocalStorage("dm"))||ah.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_CONVERSATION;a7.feedMode=this.feedMode;S=this.feedMode}else{if((!this.dmId&&this.communityId&&((this.isPreviousContextADM())||(this.isPreviousContextNotACommunityOrDM(this.previousAttributes))))){this.feedMode=(this.getFeedModeFromLocalStorage("community"))||ah.SWYM_IM_CENTRAL_COLUMN_DEFAULT_MODE_COMMUNITY;a7.feedMode=this.feedMode;az=this.feedMode}else{if(this.dmId){this.feedMode=S}else{this.feedMode=az}}}}if(!aV||!aV.avoidContextChange){ag(aV&&aV.contextChangeEventData);this.dispatchEvent("onContextChange",z.merge(z.merge({path:this.path},a7),aV&&aV.contextChangeEventData),true)}if((this.path!==bb.path)||a){a=false;aR=this._getURLForStatsManager();if(a4){b.push({model:this.contentType,model_id:this.contentId,community_id:this.communityId,type:"api",url:aR})}else{if(this.communityId!==null&&(this.contentId===null)){b.push({model:"community",model_id:this.communityId,community_id:this.communityId,type:"api",url:aR})}else{if(aX){b.push({model:"user",model_id:this.userHashKey,type:"api",url:aR})}else{if(aY&&aT.query&&window.ds&&ds.env==="3DSwym"){require(["DS/SwymUICore/script/utils/navigation"],function(be){b.push({type:"api",url:ah.getBaseUrl()+"/"+be.URLPART_SEARCH+encodeURIComponent(aT.query)+(aT.searchType?(be.URLTYPE_SEARCH+aT.searchType):"")})})}else{if(a8&&window.ds&&ds.env==="3DSwym"){require(["DS/SwymUICore/script/utils/navigation"],function(be){b.push({type:"api",url:ah.getBaseUrl()+"/"+be.URLPART_ADMIN})})}else{if(!a6&&!this.contentId){b.push({model:this.communityId?"community":null,model_id:this.communityId,community_id:this.communityId,type:"api",url:aR})}}}}}}}}if(a6){this.dispatchEvent("onContextIdChange",{contextId:this.contextId},true)}if(bc){if(!this.isAdminContext()){this.dispatchEvent("onCommunityChange",{communityId:this.communityId},true)}if(a9){this.dispatchEvent("onDirectMessageChange",{dmId:this.dmId},true)}}if(a1){if(this.dmId){this.setFeedModeInLocalStorage(this.feedMode,"dm");S=this.feedMode}else{this.setFeedModeInLocalStorage(this.feedMode,"community");az=this.feedMode}this.dispatchEvent("onFeedModeChange",{feedMode:this.feedMode},true)}if(bc||a9){this.dispatchEvent("onThreadChange",{dmId:this.dmId,communityId:this.communityId},true)}if(a4||a0){switch(this.contentType){case"idea":this.dispatchEvent("onIdeaChange",{contentId:this.contentId},true);break;case"media":this.dispatchEvent("onMediaChange",{contentId:this.contentId},true);break;case"iquestion":this.dispatchEvent("onIQuestionChange",{contentId:this.contentId},true);break;case"post":this.dispatchEvent("onPostChange",{contentId:this.contentId},true);break;case"survey":this.dispatchEvent("onSurveyChange",{contentId:this.contentId},true);break;case"wiki":this.dispatchEvent("onWikiChange",{contentId:this.contentId,communityId:this.communityId},true);break;default:break}}if(a5||aX){aS=this.path.split("/")[1];ba="0";if(aS){switch(aS){case"activities":ba="0";break;case"aboutme":ba="1";break;case"connections":ba="2";break;case"settings":ba="3";break}}if(aX){this.dispatchEvent("onPeopleChange",{userHashKey:this.userHashKey,tabNumber:ba},true)}if(a5){this.dispatchEvent("onPeopleTabChange",{userHashKey:this.userHashKey,tabNumber:ba},true)}}if(aY){this.dispatchEvent("onSearchChange",{query:this.query,x3dsearchOptions:this.x3dsearchOptions},true)}if(a8){this.dispatchEvent("onTenantChange",{tenantId:this.tenantId,tenantLabel:this.tenantLabel},true)}this.dispatchEvent("onContextChangeAttempt",{success:a3})},addListener:function(aS,aV,aU,aR,aT){return this._addListener(aS,aV,aU,aR,aT,false)},addOnce:function(aS,aV,aU,aR,aT){return this._addListener(aS,aV,aU,aR,aT,true)},_remove:function(aR,aT,aS){aK.removeEvent(aR,aT,aS)},removeListener:function(aR,aT,aS){if(z.is(aT,"function")){return this._remove.call(this,aR,aT,aS)}else{throw new Error("The listener to be removed is not a function")}},dispatchEvent:function(aS,aR,aT){aK.dispatchEvent(aS,aR);if(aT){aR=aR||[];w[aS]=aR}},removePersisted:function(aR){delete w[aR]},hasEvent:function(aR){return aK.hasEvent(aR)},handleAppTitle:function(aS){var aU=this,aT=z.extend({},aS),aW=aT.app,aR=aT.appName,aV=aT.skeleton;if(!aW){throw new Error("Widget instance is missing")}if(this._handledAppsIds.indexOf(aW.id)<0){this._handledAppsIds.push(aW.id);aW.setTitle(this.getAppTitle(aT));if(aR){this._currentAppName=aR}this._currentAppReference=aW;this.addListener("onContextChange",function(){aW.setTitle(aU.getAppTitle(aT))})}if(aV){aV.addEvent("onRouteChange",this._onSkeletonRouteChange)}return this},computeRoute:function(aS){var aR="";if(aS.userHashKey){aR="people:"+aS.userHashKey+"/activities"}else{if(aS.dmId){aR="dm:"+aS.dmId;if(aS.messageUuid){aR+="/message:"+aS.messageUuid}}else{if(aS.communityId){if(!(window.widget&&window.widget.getAppName&&window.widget.getAppName()===ah.getContentReaderAppKey())){aR="community:"+aS.communityId;if(aS.messageUuid){aR+="/message:"+aS.messageUuid}}}else{if(aS.query){aR="search:"+encodeURIComponent(aS.query)}}}if(aS.dmId||aS.communityId||(window.widget&&window.widget.getAppName&&window.widget.getAppName()===ah.getContentReaderAppKey())){if(aS.contentType&&this.isContentContext(aS)){aR+=((aR?"/":"")+(aS.contentType+(aS.contentId?(":"+aS.contentId+(ah.isFeatureActivated("activateCommentNotificationRedirection")&&aS.answerUri?("/answer:"+encodeURIComponent(aS.answerUri)):"")+(ah.isFeatureActivated("activateCommentNotificationRedirection")&&aS.commentUri?("/comment:"+encodeURIComponent(aS.commentUri)+(aS.replyUri?("/reply:"+encodeURIComponent(aS.replyUri)):"")):"")):"")))}if(aS.editionMode===true){aR+="/edit"}}if(!aR){aR=aS.path||"home"}}return aR},getRoute:function(aS){var aR,aT=aS||this;if(aT.path){aR=aT.path}else{aR=this.computeRoute(aT)}return aR},getLayoutPath:function(){var aR=undefined,aT=this.getRoute(),aS=(aT.match(o));if(aS&&(aS.length===2)&&(aS[1]===aj)){aR=aT.replace(new RegExp(aO),"gallery")}return aR||aT},isPreviousContextACommunity:function(){var aR=this.previousAttributes;return(aR.communityId&&!aR.dmId)},isPreviousContextADM:function(){var aR=this.previousAttributes;return(aR.dmId)},isPreviousContextNotACommunityOrDM:function(aR){return(!aR.dmId&&!aR.communityId)},isPreviousPathAListing:function(aR){var aS=aR||this.previousAttributes,aX=aS.path,aY=aS.userHashKey,aT=aS.communityId,aW=aS.contentId,aV=[am,F,aj,J,aa,c,M],aZ=this.getCommunityPageContext(aX),aU=false;if(aX===""||aX==="home"||aX===B||(aT&&!aZ)||(aV.indexOf(aZ)>-1&&!aW)||aY||(z.is(aX,"string")&&((aX.contains("search")&&aS.query)))||aX==="admin-tenant/whatsnew"||aX==="admin-tenant/media"){aU=true}return aU},getLastAccessedContentListContext:function(){var aT,aS=this.previousAttributes||{},aR=aS&&aS.path;if(!aR&&this.isCommunityContext()&&(this.path!==("community:"+this.communityId))){aR="community:"+this.communityId;aS={communityId:this.communityId,path:aR}}if(aR&&aR.startsWith("community")){if(!(aS&&this.isContentContext(aS))){aT=aS}else{aT={communityId:aS.communityId,path:"community:"+aS.communityId}}}else{aT={communityId:null,path:"home"}}return aT},extractContextInfoFromRoute:function(aT){var aS,aV={};if(aT){aV={communityId:null,dmId:null,contentType:null,contentId:null,commentUri:null,replyUri:null,answerUri:null,messageUuid:null,path:aT,userHashKey:null,query:null,tenantAdminCommunityFacetName:null};if(aT.match("app:")){if(aS=aT.match(ab)){aV.communityId=aS[1];if(aS=aT.match(t)){aV.messageUuid=aS[1]}}if(aS=aT.match(m)){aV.dmId=aS[1];aV.communityId=aS[1];if(aS=aT.match(t)){aV.messageUuid=aS[1]}}else{if(aT.match(A)){aV.dmId=aV.communityId}}if(aS=aT.match(aE)){aV.contentType=aS[1]}if(aS=aT.match(ai)){aV.contentId=aS[1]}if(aS=aT.match(t)){aV.contentId=aS[1]}if(ah.isFeatureActivated("activateCommentNotificationRedirection")){if(aS=aT.match(ap)){aV.answerUri=decodeURIComponent(aS[1])}if(aS=aT.match(O)){aV.commentUri=decodeURIComponent(aS[1]);if(aS=aT.match(aJ)){aV.replyUri=aV.commentUri;aV.commentUri=decodeURIComponent(aS[1])}else{if(aS=aT.match(h)){aV.replyUri=decodeURIComponent(aS[1])}}}}}else{if(aT.match("#content:")){var aR=unescape(decodeURI(aT));var aW=JSON.parse(aR.substring(aR.indexOf("{"),aR.lastIndexOf("}")+1));var aX=aW.data.items[0].objectId;var aU=ah.extractDataFromSubject6wURI(aX);switch(aU.modelName){case"community":aV.communityId=aU.extraAttrs.mid;if(aW.data.items[0].objectType==="swym:DirectMessage"){aV.dmId=aU.extraAttrs.mid}break;case"user":aV.userHashKey=aU.extraAttrs.login;break;default:aV.contentId=aU.extraAttrs.mid;break}aV.contentType=aW.data.items[0].objectType==="swym:DirectMessage"?null:aU.modelName;console.log("#content: detected, objectData:",aU,aV)}else{aV.editionMode=Boolean(aV.path.match(af));if(aS=(aV.path.match(u)||aV.path.match(x)||aV.path.match(n)||aV.path.match(aF))){z.extend(aV,{communityId:aS[1],dmId:(aV.path.match(aF)?aS[1]:undefined),contentType:((aS[2]==="question")?"iquestion":(aS[2]==="ideation")?"idea":aS[2]),contentId:aS[3]});if(ah.isFeatureActivated("activateCommentNotificationRedirection")){if(aS=aV.path.match(ay)){aV.answerUri=decodeURIComponent(aS[1])}if(aS=aV.path.match(at)){aV.commentUri=decodeURIComponent(aS[1]);if(aS=aV.path.match(r)){aV.replyUri=decodeURIComponent(aS[1])}}}}else{if(aS=(aV.path.match(av)||aV.path.match(H))){z.extend(aV,{communityId:aS[1],dmId:(aV.path.match(H)?aS[1]:undefined),messageUuid:aS[2]})}else{if(aS=aV.path.match(an)){z.extend(aV,{contentType:((aS[1]==="question")?"iquestion":(aS[1]==="ideation")?"idea":aS[1]),contentId:aS[2]})}else{if(aS=aV.path.match(p)){z.extend(aV,{communityId:aS[1],tenantAdminCommunityFacetName:aS[2]})}else{if(aS=aV.path.match(aQ)){z.extend(aV,{communityId:aS[1]})}else{if(aS=aV.path.match(ao)){z.extend(aV,{dmId:aS[1],communityId:aS[1]})}else{if(aS=aV.path.match(aI)){z.extend(aV,{userHashKey:aS[1]})}else{if(aS=aV.path.match(aq)){z.extend(aV,{query:decodeURIComponent(aS[1])})}}}}}}}}}}}return aV},isContentContext:function(aR){if(!aR){aR=this}return aR.contentId||(aR.path&&aR.path.match(x))},isCommunityContext:function(){return this.communityId},isDirectMessageContext:function(){return this.dmId},isUserProfileContext:function(){return this.userHashKey},isSearchContext:function(){return this.path.contains(aD)&&this.query},setTemporaryState:function(aR){if(this.temporaryState!==aR){this.temporaryState=(aR===true);this.dispatchEvent("onTemporaryStateChange",[aR])}},isInTemporaryState:function(){return(this.temporaryState===true)},getCommunityPageContext:function(aU){var aR=false,aS=aU||this.path,aT=(aS.match(aP));if(aT&&(aT.length===2)&&(aT[1]!==aH)){aR=aT[1];return aR}else{return this.getDirectMessagePageContext(aU)}},getDirectMessagePageContext:function(aT){var aU=false,aR=aT||this.path,aS=(aR.match(aG));if(aS&&(aS.length===2)){aU=aS[1]}return aU},getCommunityContentListContext:function(aS){var aR=((typeof(aS)==="string"?aS:this.path).match(T.COMMUNITY_CONTENT_LIST_REGEXP));if(aR&&(aR.length===2)){return aR[1]}},isHomePageContext:function(){return(this.path===""||this.path==="home")&&!this.query},isCommunityHomePageContext:function(){return((this.isCommunityContext())&&(!this.getCommunityPageContext()))},isCommunityTimelineMessageContext:function(aS){var aT=false,aR=aS||this.path,aU=(aR.match(aP));if(aU&&(aU.length===2)){aT=aU[1]===aH}return aT},isDMTimelineMessageContext:function(aS){var aT=false,aR=aS||this.path,aU=(aR.match(aG));if(aU&&(aU.length===2)){aT=aU[1]===aH}return aT},isCommunityContentListContext:function(){return z.is(this.getCommunityContentListContext())},isAdminContext:function(){return(z.is(this.path,"string")&&this.path.startsWith("admin-tenant"))},isBookmarkContext:function(){return(z.is(this.path,"string")&&this.path.startsWith("mybookmarks"))},isMyCommunitiesContext:function(){return(this.path===al)},isDiscoverCommunitiesContext:function(){return(this.path===au)},isMyNetworkActivityContext:function(){return(this.path===E)},isCommunityListsContext:function(){return(this.isMyCommunitiesContext()||this.isDiscoverCommunitiesContext())},isFilterableContentListsContext:function(){var aR=[F,aj,aa,c,M,aH];return(this.isHomePageContext()||this.isCommunityHomePageContext()||((aR.indexOf(this.getCommunityPageContext())>=0)&&!this.isContentContext()))},isContentEditionContext:function(){return(this.editionMode===true)},getPathPrefixFromCurrentPageUrl:function(){var aR=(document.location.href.split("#")[0]);return aR},getPathFromUrl:function(aT){var aR=document.location.href,aS=aT||(aR.split("#")[1]||"");var aU=aR.search("#content:");if(aU!==-1){return aR.substring(aU,aR.length)}else{if((aS.lastIndexOf("/")!==-1)&&(aS.lastIndexOf("/")===(aS.length-1))){aS=aS.substring(0,(aS.length-1))}return aS}},getPreviousPath:function(){return this.previousAttributes.path},getData:function(){var aR={};this._attributeList.forEach(function(aS){aR[aS]=this[aS]},this);return aR}});var K=null;T.getInstance=function(){if(K===null){K=new L();require(["DS/SwymUICore/script/feature/core/context/context-change-actions"],function(){})}return K};T.resetInstance=function(){K=null;return T.getInstance()};T.BASE64_REGEXP=Z;T.SWYM_STANDALONE_TITLE=G;T.UNKNOWN_CONTEXT_ID=P;T.COMMUNITY_BLOG=F;T.COMMUNITY_MEDIA=aj;T.COMMUNITY_GALLERY=J;T.COMMUNITY_IDEAS=aa;T.COMMUNITY_QUESTIONS=c;T.COMMUNITY_WIKI=ak;T.COMMUNITY_MEMBERS=ac;T.COMMUNITY_SETTINGS=g;T.COMMUNITY_STATS=e;T.COMMUNITY_MY_CONTRIBUTIONS=am;T.COMMUNITY_SURVEYS=M;T.COMMUNITY_WIKI_ROOT=ad;T.COMMUNITY_CONTENT_LIST_REGEXP=ax;T.MY_COMMUNITIES=al;T.DISCOVER_COMMUNITIES=au;T.MY_BOOKMARKS=B;T.MY_NETWORK_ACTIVITY=E;T.TIMELINE_MODE=aM;T.WHATSNEW_MODE=j;T.__class=L;var aw=function(aU){var aV="("+aU.COMMUNITY_WIKI+")/?$",aW="("+aU.COMMUNITY_MEDIA+")/?$",aY=new RegExp("community:[A-Za-z0-9-_]+/"+aV),aS=new RegExp("community:[A-Za-z0-9-_]+/"+aU.COMMUNITY_WIKI_ROOT),aR=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/"+aW),aT={addIMSpecificOverrides:function(){var aZ=aU.__class;aZ.implement({_realTimeEventManager:null,getLayoutPath:function(){var a0=undefined,a2=this.getRoute(),a1=(a2.match(aY)||a2.match(aR));if(a1&&(a1.length===2)){if((a1[1]===aU.COMMUNITY_WIKI)){a0=a2.replace(new RegExp(aV),"communitywiki")}else{if((a1[1]===aU.COMMUNITY_MEDIA)){a0=a2.replace(new RegExp(aW),"mediaFiltered");console.log("the old path and the new path",a2,a0)}}}return a0||a2},isFilterableContentListsContext:function(){var a0=this._previous();if(a0!==true){if((this.getCommunityPageContext()===aU.COMMUNITY_WIKI)&&!this.isContentContext()){a0=true}}return a0},isContentContext:function(a0){if(!a0){a0=this}return a0.contentId||(a0.path&&a0.path.match(aS))},isPreviousPathAListing:function(a3){var a2=this._previous(a3),a4=a3||this.previousAttributes,a1=a4.path,a5=this.getCommunityPageContext(a1),a0=a2;if((a2===false)&&((a5===aU.COMMUNITY_WIKI)&&!this.isContentContext(a4))){a0=true}return a0},setRealTimeEventManager:function(a0){this._realTimeEventManager=a0},getRealTimeEventManager:function(){return this._realTimeEventManager}})}};aU.COMMUNITY_CONTENT_LIST_REGEXP=new RegExp("(?:community|dm):[A-Za-z0-9-_]+/("+aU.COMMUNITY_BLOG+"|"+aU.COMMUNITY_MEDIA+"|"+aU.COMMUNITY_GALLERY+"|"+aU.COMMUNITY_IDEAS+"|"+aU.COMMUNITY_QUESTIONS+"|"+aU.COMMUNITY_WIKI+"|"+aU.COMMUNITY_SURVEYS+")/?$");aU.CONTENTTYPE_TO_COMMUNITYPAGE={post:aU.COMMUNITY_BLOG,media:aU.COMMUNITY_MEDIA,idea:aU.COMMUNITY_IDEAS,iquestion:aU.COMMUNITY_QUESTIONS,wiki:aU.COMMUNITY_WIKI,survey:aU.COMMUNITY_SURVEYS};aU.COMMUNITYPAGE_TO_CONTENTTYPE={};for(var aX in aU.CONTENTTYPE_TO_COMMUNITYPAGE){if(aU.CONTENTTYPE_TO_COMMUNITYPAGE.hasOwnProperty(aX)){aU.COMMUNITYPAGE_TO_CONTENTTYPE[aU.CONTENTTYPE_TO_COMMUNITYPAGE[aX]]=aX}}return aT};aw(T).addIMSpecificOverrides();return T});define("DS/SwymUICore/script/utils/link-builder-utils",["UWA/Core","UWA/Class/Events","UWA/Event","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/WebappsUtils/Console"],function(c,p,f,e,m,u,d,A){var r="generated",s="a.s6m-tag-link[data-predicate]",n="a[data-users-group-uri]",o="a[data-login]",i="drives";function v(C,D){C.setAttribute("href",D);C.dataset.link=r}function z(C){var D=C.srcElement||C.target,E=(D&&D.getAttribute("data-content-id"));if(m.in3DSwym()){v(D,m.URLPART_COMMUNITY+E)}else{v(D,e.getMyCommunitiesAppUrl({community:E,url:e.getBaseUrl()}))}}function B(C){var E=C.srcElement||C.target,D=(E&&E.getAttribute("data-content-id"));if(m.in3DSwym()){v(E,m.URLPART_DM+D)}else{v(E,e.getMyCommunitiesAppUrl({dm:D,url:e.getBaseUrl()}))}}function l(D){var F=D.srcElement||D.target,J=(F&&F.getAttribute("data-content-id")),I=(F&&F.getAttribute("data-content-type")),G=(F&&(F.getAttribute("data-community-id"))),E=(F&&(F.getAttribute("data-dm-id"))),C=new d({mid:(G||E)}),H=(E||C.isDirectMessage())?"dm":null;if(I){if(m.in3DSwym()){v(F,m.getContentURLForSwym(J,I,E||G,false,H))}else{v(F,e.getMyCommunitiesAppUrl({appId:e.getMyCommunitiesAppKey(),community:G,contentType:I,contentId:J}))}}}function y(C){var D=x(C),E=C.srcElement||C.target;if(!D.anonymous){if(m.in3DSwym()){v(E,m.URLPART_PEOPLE+(D.hash_key||D.login)+m.PROFILE_FACET_MAPPING[D.facet])}else{v(E,e.getProfileAppUrl({login:D.login||"",hash_key:D.hash_key||"",facet:D.facet||"0"}))}}}function x(D){var E={anonymous:false},F=D.srcElement||D.target,C=f.getElement(D);if(F&&F.dataset){E.hash_key=F.dataset.hashKey;E.login=F.dataset.login;E.facet=F.dataset.facet}if(!E.hash_key&&!E.login&&C.dataset){E.hash_key=C.dataset.hashKey;E.login=C.dataset.login;E.facet=C.dataset.facet}if(!E.facet){E.facet="0"}if(E.login){if((E.login==="anonymous")||(E.login.indexOf("_ANONYMISED_")===0)){E.anonymous=true}}else{if(!E.hash_key){A.error("no login nor hash_key defined, please provide at least one to get a working navigation system")}}return E}function k(C){if(C.ctrlKey!==true){A.log("click on link user model");t(C);var D=x(C);if(!D.anonymous){m.goToProfile(D)}}}function j(C){if(C.ctrlKey!==true){var D=f.getElement(C);t(C);if(D){m.goToCommunity(D.getAttribute("data-content-id"))}}}function q(C){if(C.ctrlKey!==true){var D=f.getElement(C);t(C);if(D){m.goToDM(D.getAttribute("data-content-id"))}}}function a(L){var M,G,K,J,C,D=false,F=L.target&&L.target.getParents(),I;if(L.ctrlKey!==true){for(I in F){if(F.hasOwnProperty(I)&&F[I].hasClassName&&F[I].hasClassName("content-edition")){D=true}}if(!D){var E=f.getElement(L),H=E.getAttribute("data-edition-mode")==="true";t(L);if(E&&!L.target.match(s)&&!L.target.match(o)&&!L.target.match(n)){if(E.getAttribute("data-content-type")==="wiki"){require(["DS/SwymUICore/script/feature/core/config/bootstrap-model"],function(N){if(N.getInstance().isFeatureActivated("active_wiki")===false){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/utils/link-builder-utils"],function(O,P){O.warn(P.Sorrythewikifeatureisnotcurrentlyavailable)})}else{G=E.getAttribute("data-community-id");K=E.getAttribute("data-dm-id");M=new d({mid:K||G});m.goToContent(E.getAttribute("data-content-id"),E.getAttribute("data-content-type"),G||K,H,undefined,undefined,Boolean(K)||M.isDirectMessage())}})}else{G=E.getAttribute("data-community-id");K=E.getAttribute("data-dm-id");M=new d({mid:K||G}),J=E.getAttribute("data-content-type"),C=E.getAttribute("data-content-id");if(J==="instantmessage"){if(K){m.goToDM(K,undefined,undefined,{messageUuid:C})}else{m.goToCommunity(G,undefined,undefined,false,{messageUuid:C})}}else{m.goToContent(C,J,G||K,H,undefined,undefined,Boolean(K)||M.isDirectMessage())}}}}}}function b(C){require(["DS/SwymUICore/script/feature/core/history/history-model"],function(H){var G={},I=f.getElement(C),E=u.getInstance(),D=H.getStateListing(),F=(E.isInTemporaryState()?E.getData():(D&&D.previousContext))||{};G[I.dataset.predicate]=[{object:I.getText(),type:"string"}];if(E.isCommunityContext()&&!(E.isContentContext()&&F.contentId)&&!(E.contentId&&((F.path==="home")||!F.path))){m.goToCommunity(E.communityId,undefined,undefined,c.is(E.dmId),{tagNavigatorFilteringOptions:{filter:G,replace:true}})}else{m.goTo3DSwymHomePage({tagNavigatorFilteringOptions:{filter:G,replace:true}})}})}function h(C){if((m.in3DD()||m.inMobile())&&C.ctrlKey!==true){var D=f.getElement(C);if(D&&c.is(D.href,"string")&&D.href.startsWith("blob:")){return undefined}else{if((c.is(D.dataset.type,"string")&&D.dataset.type==="internal")||c.is(D.dataset.contentType,"string")){t(C)}else{if(c.is(D.href,"string")&&(D.href.startsWith("http://")||D.href.startsWith("https://"))&&!D.href.contains(document.URL)){if(D.href.indexOf(i)===-1){window.open(D.href,"_blank");t(C)}}}}}}function t(C){C.preventDefault();C.stopPropagation()}function g(D){var C={};C["click a"]=h;C['click *[data-content-type="person"]:not([data-is-link="false"])']=k;C['mouseover a[data-content-type="person"]:not([data-is-link="false"])']=y;C['click *[data-content-type="community"][data-content-id]:not([data-is-link="false"])']=j;C['mouseover a[data-content-type="community"][data-content-id]:not([data-is-link="false"])']=z;C['click *[data-content-type="direct-message"][data-content-id]:not([data-is-link="false"])']=q;C['mouseover a[data-content-type="direct-message"][data-content-id]:not([data-is-link="false"])']=B;C['click *[data-content-id]:not([data-content-type="community"]):not([data-content-type="direct-message"]):not([data-is-link="false"])']=a;C['mouseover a[data-content-id]:not([data-content-type="community"]):not([data-content-type="direct-message"]):not([data-is-link="false"])']=l;C["click "+s]=b;c.extendElement(D).addEvents(C,false,1)}var w=p.singleton({activateLink:function(C){return g(C)},displayProfile:k,addHREFToLinks:function(F){var E,C,G,D;if(e.getClientInformation().isIos===true){G=F.getElements('a[data-content-id]:not([data-content-type="community"]):not([data-is-link="false"])');D=F.getElements('a[data-content-type="community"][data-content-id]:not([data-is-link="false"])');for(E=0,C=G.length;E<C;E++){l({target:G[E]})}for(E=0,C=D.length;E<C;E++){z({target:G[E]})}}}}).init();return w});define("DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection",["UWA/Core","UWA/Json","UWA/Array","DS/SwymUICore/script/feature/core/pagination/collection/paginated-collection","DS/SwymUICore/script/feature/core/6wtag/collection/6wtag-collection","DS/SwymUICore/script/lib/6wpanel/6wtaggable","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console"],function(h,b,c,f,d,l,e,j,g,a){function k(m,n,o){if(m instanceof i){m.removeEvent("onSync:read",k);if((m.fetchTagsSeparatelyOnRefresh===true)&&((o&&o.data&&parseInt(o.data.page,10)===1)||(m.getCurrentPage()===1))){if((m._tagFetchDelay>0)&&(m.tagsFetchedAtleastOnce===false)){setTimeout(function(){m.tagsFetchedAtleastOnce=true;m.fetchTagsSeparately()},m._tagFetchDelay)}else{m.fetchTagsSeparately()}}}}var i=f.extend(l,{_associations:{"6wtags":{Class:d,oppositeRole:"tagged",options:{mode:""}}},_defaultSearchOptions:{},_tagFetchDelay:1500,tagsFetchedAtleastOnce:false,taggerFilters:null,exaleadFilters:null,exaleadQuery:"#all",exaleadContentType:null,fetchTagsSeparatelyOnRefresh:false,_getRemoteFilteringParams:function(m,n){return h.merge({refine:n},h.merge(this._getRefreshParams()||{},this.getDefaultSearchOptions()||{}))},_defaultParamsMappingForSearch:{page:"start",limit:"nresults"},_defaultParsingFn:e.parseSearchResult,_updateTagsMode:function(){this.getTags().setMode(this._collectionName+":"+this.mode)},init:function(o,m){this._parent.apply(this,arguments);m=m||{};if(m.hasOwnProperty("is6wTaggable")){this.is6wTaggable=m.is6wTaggable}if(m.hasOwnProperty("fetchTagsSeparatelyOnRefresh")){this.fetchTagsSeparatelyOnRefresh=(m.fetchTagsSeparatelyOnRefresh===true)}if(m.hasOwnProperty("defaultSearchOptions")){this.setDefaultSearchOptions(m.defaultSearchOptions)}if(m.hasOwnProperty("exaleadContentType")){this.exaleadContentType=m.exaleadContentType}if(this.fetchTagsSeparatelyOnRefresh===true){try{this.checkIfModeAllowsFiltering();this.addEvent("onSync:read",k)}catch(n){a.warn(n.message)}}return this},setDefaultSearchOptions:function(m){this._defaultSearchOptions=m},getDefaultSearchOptions:function(){return this._defaultSearchOptions},resetCollection:function(o,n){var m=(n&&n.serviceName)||this.lastCalledService||"read";if(m==="read"&&this.fetchTagsSeparatelyOnRefresh===true){this.addEvent("onSync:read",k)}return this._parent(o,n)},fetchTagsSeparately:function(){var m={},n=this._getRefreshParams()||{};m={data:n,paramsMapping:this._defaultParamsMappingForSearch};n.nresults=1;n.limit=0;n.start=0;if(this.exaleadContentType){n.contentType=this.exaleadContentType}n.query=n.query||this.exaleadQuery||"#all";if(this.mode){if(typeof this._services.filter[this.mode].dataFn==="function"){m.data=this._services.filter[this.mode].dataFn.call(this,n)}}else{a.warn("The current 6W filterable has no mode!")}this.getTags().fetch(m)},checkIfModeAllowsFiltering:function(){if(this._services&&this.mode&&this._services.filter&&this._services.filter[this.mode]){return true}throw new Error('The current mode is invalid and does not support 6w filtering.Please define a "filter" service for "'+this.mode+'" mode.')},parse:function(n,m){if(m&&m.serviceName==="filter"&&this.mode){if(m.parse===true&&typeof this._services[m.serviceName][this.mode].parse!=="function"){m.parse=this._defaultParsingFn}}return this._parent.call(this,n,m)},sync:function(r,n,p){if(!p){p={}}var m,o,q=h.merge({},p.data);if(r==="filter"){this.checkIfModeAllowsFiltering();o=this.setPageMode("start");delete q.start;delete q.nresults;if(this.exaleadContentType){q.contentType=this.exaleadContentType}q.query=q.query||this.exaleadQuery||"#all";q.legacyFormat=e.requestLegacyFormatForExaleadSearches();if(!h.is(p.paramsMapping,"object")&&!h.is(this._services[r][this.mode].paramsMapping,"object")){p.paramsMapping=this._defaultParamsMappingForSearch}p.data=q;m=this._parent(r,n,p);this.setPageMode(o)}else{m=this._parent(r,n,p)}return m},getTags:function(){return this.getAssociated("6wtags")},"onSync:filter":function(q,p,n){n=n||{};var m=this.getTags(),o={parse:true,tagsWithSubjectURI:n.tagsWithSubjectURI,tagsWithoutSubjectURI:n.tagsWithoutSubjectURI};m.reset((n&&n.data&&n.data.with_synthesis===false)?m.toJSON():p,o);return this._parent(q,p,n)},"onError:filter":function(o,n,m){return this._parent(o,n,m)},"onSetAssociated:tags":function(){if(this.mode){this._updateTagsMode(this,this.mode)}this.addEvent("onModeChange",this._updateTagsMode)},onBrowserFilteringRequest:function(n){this.checkIfModeAllowsFiltering();var m;this.taggerFilters=n;this.exaleadFilters=null;if(h.is(n,"object")&&h.is(n.filteredSubjectList,"array")){return this.filter(function(o){m=o.get("subject6wuri");return m&&(n.filteredSubjectList.indexOf(m)>=0)})}return this.toArray()},getFilteringOptions:function(r,o,m){var s,p,u,t,n=j.getInstance();function q(){var v;r=({allfilters:t.getValue("tags")});m=m||{data:{}};if(t.getValue("query")){m.data.query=t.getValue("query")}else{if(!m.data.query){m.data.query="#all"}}v=e.reformatFilters(r);m.data.query+=v.queryPart;o=v.refineParam}if(h.is(window.widget)&&(!o)){t=window.widget;if(h.is(t.getAppName,"function")&&t.getAppName()===g.getMyCommunitiesAppKey()){if((t.getValue("persistNav")==="false")){if((t.getValue("tags")!==""||t.getValue("query")!=="")){if(n.isFilterableContentListsContext()&&this.getCollectionName()!=="community-collection"){if(t.getValue("route")===n.getRoute()){q()}}else{if(n.isCommunityListsContext()&&(this.getCollectionName()==="community-collection")){if(t.getValue("route")===n.getRoute()){q()}}}}}}}u=h.merge({},m);s=u.data||{};this.taggerFilters=r||null;this.exaleadFilters=o||null;this.exaleadQuery=(!s.query||s.query==="*")?"#all":s.query;u.reset=true;if((h.is(o,"array")&&o.length>0)||s.query){s.query=this.exaleadQuery;p=this._getRemoteFilteringParams(r,o);h.merge(s,p||{});this._removePages(1,true);u.serviceName="filter"}else{if(this.fetchTagsSeparatelyOnRefresh===true){this.addEvent("onSync:read",k)}s=this._getRefreshParams("read")||{};u.serviceName="read"}u.data=s;u.ignoreCache=true;return u},onServerFilteringRequest:function(o,p,n){var m=this.getFilteringOptions(o,p,n);m.data.with_synthesis=true;return this.fetchPage(1,m)}});return i});define("DS/SwymUICore/script/feature/core/user/collection/user-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/user/model/user-model","DS/WebappsUtils/Console"],function(d,c,e,b){var a=c.extend({_communityId:null,_tenantId:null,_filters:null,_usersOnly:null,_collectionName:"user-collection",_hasAPageBeenFetched:false,_associations:{owned:{},authorized:{},networkGroupOwner:{Class:e}},_services:{read:{similaruserusingskill:{url:"api/skill/search",dataFn:function(f){return{keyword:f.keyword,exclude:f.exclude,page:this._currentPage,limit:this._limit}}},similaruserusinglanguage:{url:"api/SpokenLanguage/search",dataFn:function(f){return{keyword:f.keyword,exclude:f.exclude,page:this._currentPage,limit:this._limit}}},getpeoplefamiliartocurrentuser:{url:"api/Recommendation/getpeoplefamiliartocurrentuser",dataFn:function(f){return{idsToFilterArr:(f&&f.idsToFilterArr)?f.idsToFilterArr:[],mode:"offline",limit:this._limit,itemType:"User",maxNbOfCommonElements:"5"}},parse:function(g){var f=g&&g.hits;if(f){for(var j=0,h=f.length;j<h;j++){f[j].ID=f[j].id}}else{f=[]}return f}},similaruserusinginterest:{url:"api/interest/search",dataFn:function(f){return{keyword:f.keyword,exclude:f.exclude,page:this._currentPage,limit:this._limit}}},getnetworkbyuser:{url:"api/network/getnetworkbyuser",dataFn:function(f){return{hash_key:f.hash_key,page:this._currentPage}},parse:function(f){return f.users},postProcess:function(f){this.groups=f.result.groups}},listbots:{url:"api/community/listmembers",dataFn:function(f){return{community_id:this._communityId,limit:this._limit,member_type:"external_application_bot"}}},listmembers:{url:"api/community/listmembers",dataFn:function(i){var h,g,f;if(!this._communityId&&(h=this.getAssociated("owned"))){this._communityId=h&&h.get("mid")}if(i&&d.is(i.displayTotalCount)){g=i.displayTotalCount}else{if(d.is(this._displayTotalCount)){g=this._displayTotalCount}else{g=!this._hasAPageBeenFetched}}if(i&&i.hasOwnProperty("usersOnly")){f=i.usersOnly}else{f=this._usersOnly}return{community_id:this._communityId,page:this._currentPage,limit:this._limit,filters:this._filters,member_type:(f===true?"tenant_user":undefined),displayTotalCount:g,as_admin:(this.as_admin?true:false),order_by_last_member:(this._orderByLastMember?this._orderByLastMember:false)}},postProcess:function(){if(this._hasAPageBeenFetched===false){this._hasAPageBeenFetched=true}}},getmysharedcontacts:{url:"api/network/getmysharedcontacts",dataFn:function(h){var f=null,g=null;if(h){g=h.hash_key||this.getNetworkGroupOwner().get("hash_key");f=h.login||this.getNetworkGroupOwner().get("login")}if(!g&&!f){throw new Error("User hashkey and user login are missing!")}return{hash_key:g,login:f}},parse:function(f){if(f){return f.users}}},listtenantmoderators:{url:"api/user/listTenantModerators",dataFn:function(){return{acl:5,newcommunity:true}}},getpathrelationshipfull:{url:"api/network/getpathrelationshipfull",dataFn:function(f){return{hash_key:f.hash_key}},parse:function(f){if(f&&f[0]){return f[0]}}},getauthorizedusers:{url:"api/WikiTree/getauthorizedusers",dataFn:function(g){var f=this.getAssociated("authorized");return{id:f.get("mid"),community_id:(g&&g.community_id?g.community_id:null),page:1,limit:999,start:0}},parse:function(f){if(Array.isArray(f)){f.forEach(function(g){if(!g.login&&g.username){g.login=g.username}})}return f}},searchbyname:{url:"api/user/search",dataFn:function(f){return d.extend({limit:this._limit||10,start:0,community_id:this._communityId,locale:undefined,as_admin:false},f)}}},filter:{listmembers:{url:"api/exalead/searchcommunitymembers",tagsWithoutSubjectURI:true,dataFn:function(g){var f;if(!this._communityId&&(f=this.getAssociated("owned"))){this._communityId=f&&f.get("mid")}return d.extend(g||{},{idForCommunityMembers:this._communityId})}}}},groups:null,model:e,modes:["listbots","getpathrelationshipfull","getnetworkbyuser","listmembers","getmysharedcontacts","similaruserusingskill","similaruserusinglanguage","similaruserusinginterest","listtenantmoderators","getpeoplefamiliartocurrentuser","getauthorizedusers","searchbyname"],exaleadContentType:"user",init:function(g,f){if(f){if(f.communityId){this._communityId=f.communityId}if(f.hasOwnProperty("usersOnly")){this._usersOnly=f.usersOnly}if(f.filters){this.setFilters(f.filters)}if(f.communityModel){this.setAssociated("owned",f.communityModel)}if(f.tenantId){this._tenantId=f.tenantId}if(d.is(f.displayTotalCount)){this._displayTotalCount=f.displayTotalCount}if(d.is(f.orderByLastMember)){this._orderByLastMember=f.orderByLastMember}}return this._parent(g,f)},getFilters:function(){return this._filters},setFilters:function(g,f){this._filters=g;if(f===true){this.resetCollection(1)}},getNetworkGroupOwner:function(){return this.getAssociated("networkGroupOwner")},parse:function(g,f){if(this.mode==="listmembers"&&g.nb_result===null){delete g.nb_result}return this._parent.call(this,g,f)}});return a});define("DS/SwymUICore/script/lib/model/model-manager",["UWA/Core","UWA/Object","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/SwymUICore/script/feature/core/context/context-model","DS/WebappsUtils/Console"],function(c,v,w,m,h,p,x){var o=false,t=true,i={onDestroy:true,onPrePublishing:true,onPublishing:true,onDraftCreation:true,onCreate:true,onCommentCreation:true},n=m.singleton(h).init(),j={},l={};function s(y){var B=y.getCacheId(),A=y.getCacheKey(),C,z=false;if(A&&y&&B){if(!Array.isArray(B)){B=[B]}B.forEach(function(D){if(D&&j[A]&&j[A][D]){z=j[A][D]}})}return z}function e(R){var E,A,K,J,z,C,I,D,F,y,B,P,M,O,L,Q,N={},H,G;if(!c.is(R,"object")){throw new Error("Invalid arguments")}if(c.is(R.instance,"object")){y=R.instance;D=R.isComplete;Q=R.areModelDataFromServer;P=R.cachePrioritaryFields}else{y=R}if(!y||y.isNew()){return false}H=y.cid;z=y.getCacheId();C=y.getCacheKey();D=(D===true)?true:false;Q=(Q===true)?true:false;P=P||[];I=s(y);if(I){B=I.instance;if(B!==y){c.merge(B,y);for(E in B){if(E!=="_attributes"&&E!=="_dispatchers"&&E!=="collection"&&B.hasOwnProperty(E)&&(typeof B[E]==="object")&&(typeof y[E]==="object")){c.merge(B[E]||{},y[E]||{})}}K=y._dispatchers;J=B._dispatchers;if(K!==J){for(A in K){if(K.hasOwnProperty(A)&&(K[A].bindings.length>0)){if(J.hasOwnProperty(A)){for(M=0,O=K[A].bindings.length;M<O;M++){L=K[A].bindings[M];if(L.isOnce===true){B.addEventOnce(A,L.listener,L.context,L.priority)}else{B.addEvent(A,L.listener,L.context,L.priority)}}}else{J[A]=K[A]}}}}if(Q===true||I.areModelDataFromServer!==true){if(P.length>0){N=B.getAttributes(P,{escapeHTML:false});for(E in N){if(N.hasOwnProperty(E)&&typeof N[E]==="undefined"){delete N[E]}}}B.set(c.extend(y.toJSON(),N))}else{B.set(c.extend(y.toJSON(),B.toJSON()))}F=y.collection||B.collection;c.extend(y,B);y.cid=H;y.collection=F;if(((D===false&&I.isComplete===true)||(Q===false&&I.areModelDataFromServer===true))){return true}if(I.isComplete!==true){I.isComplete=D;I.areModelDataFromServer=Q}}}else{if(C&&z){if(!Array.isArray(z)){z=[z]}I=j[C]=j[C]||{};z.forEach(function(S){I[S]={instance:y};if(I[S].isComplete!==true){I[S].isComplete=D;I[S].areModelDataFromServer=Q}})}}return true}function u(z){try{var y=false,C=z.getCacheId(),B=z.getCacheKey();if(z&&B&&C){if(!Array.isArray(C)){C=[C]}C.forEach(function(D){if(D&&j[B]&&j[B][D]){delete j[B][D];y=true}})}return y}catch(A){x.error("Error uncaching instance:"+A.message)}}function k(y,z,A){if(A&&typeof A==="object"){d({url:A.url,data:A.data})}}function q(y,z,A){y.removeEvent("onError:read",b);return k(y,z,A)}function b(y,z,A){y.removeEvent("onSync:read",q);return k(y,z,A)}function r(y,z,A){if(A){switch(A.serviceName){case"read":case"update":case"patch":e({instance:y,isComplete:(A.serviceName==="read"),areModelDataFromServer:true});break;case"delete":n.stopListening(y);if(s(y)){u(y)}break;default:}}}function a(D){var B,y,z,C,A;if(D&&D.url&&D.data){z=D.url;C=D.data;l[z]=l[z]||[];A=l[z];for(B=0,y=A.length;B<y;B++){if(c.equals(A[B],C)){return B}}}return false}function g(y){if(!y.instance){throw new Error("Provided instance is invalid!")}if(a(y)===false){l[y.url]=l[y.url]||[];l[y.url].push(y.data);y.instance.addEventOnce("onSync:read",q);y.instance.addEventOnce("onError:read",b);return true}return false}function d(z){var y=a(z);if(y!==false){delete l[z.url][y];l[z.url].length--;return true}return false}var f=w.singleton({init:function(){if(o===true){throw new Error("Singleton has already been created")}o=true;p.getInstance().addListener("onTenantChange",function(){n.stopListening();j={}});return this},followUpForCacheUpdates:function(y){if(t===true){n.listenTo(y,"onSync",r)}},ignoreForCacheUpdates:function(y){if(y){n.stopListening(y,"onSync",r)}},isPendingCall:function(z,y){if(y!==true){return Boolean(a(z))}else{return !g(z)}},populate:function(z,y){if(t===true){if(z){var A=null;y=y||{};y.autoPopulate=(y.autoPopulate===true)?true:false;y.areModelDataFromServer=(y.areModelDataFromServer===true)?true:false;if(!z.getModelName()){throw new Error("Instance model name is missing")}if(z.isNew()){y.provokeCacheUpdates=false}else{A=s(z);y.provokeCacheUpdates=(y.provokeCacheUpdates===false)?false:true}if(!A){if(y.provokeCacheUpdates===true){e({instance:z,isComplete:false,areModelDataFromServer:y.areModelDataFromServer})}if(y.autoPopulate===true){if(typeof y.onPopulate==="function"){y.onComplete=y.onPopulate.bind(z)}z.fetch(y)}else{z.dispatchEvent("onLoaded",[z])}}else{if(y.provokeCacheUpdates!==true){if(y.areModelDataFromServer===true){z.set(c.merge(z.toJSON(),A.instance.toJSON()))}else{z.set(A.instance.toJSON())}}else{e({instance:z,isComplete:false,areModelDataFromServer:y.areModelDataFromServer,cachePrioritaryFields:y.cachePrioritaryFields})}if(A.isComplete!==true&&y.autoPopulate===true){if(typeof y.onPopulate==="function"){y.onComplete=y.onPopulate}z.fetch(y)}else{if(typeof y.onPopulate==="function"){y.onPopulate.call(z,z,{},y)}}}return z}else{throw new Error("Instance id and model name are required")}}},isModelInCache:function(y){return(s(y))?true:false},getInstance:function(){return this},addListener:function(y,B,C,A,z){if(i.hasOwnProperty(y)){if(A===true){return n.addEventOnce(y,B,C,z)}else{return n.addEvent(y,B,C,z)}}},removeListener:function(y,z){return n.removeEvent(y,z)},notify:function(y,z,A){if(i.hasOwnProperty(y)){return n.dispatchEvent(y,z,A)}},addListenerOnDestroy:function(A,B,z,y){return this.addListener("onDestroy",A,B,z,y)},addListenerOnCreation:function(A,B,z,y){return this.addListener("onCreate",A,B,z,y)},addListenerOnPublishing:function(A,B,z,y){return this.addListener("onPublishing",A,B,z,y)},addListenerOnPrePublishing:function(A,B,z,y){return this.addListener("onPrePublishing",A,B,z,y)},addListenerOnCommentCreation:function(A,B,z,y){return this.addListener("onCommentCreation",A,B,z,y)},addListenerOnDraftCreation:function(A,B,z,y){return this.addListener("onDraftCreation",A,B,z,y)},removeListenerOnCommentCreation:function(y){return this.removeListener("onCommentCreation",y)},removeListenerOnPrePublishing:function(y){return this.removeListener("onPrePublishing",y)},removeListenerOnDestroy:function(y){return this.removeListener("onDestroy",y)},removeListenerOnCreation:function(y){return this.removeListener("onCreate",y)},removeListenerOnPublishing:function(y){return this.removeListener("onPublishing",y)},removeListenerOnDraftCreation:function(y){return this.removeListener("onDraftCreation",y)},getAttributesFromCache:function(A,y){var z=j[A]||{};z=z[y];if(z){z=z.instance.toJSON()}return z},cleanCache:function(){j={};l={}}}).init();return f});define("DS/SwymUICore/script/lib/model/generic/community-content",["UWA/Core","UWA/Array","DS/Logger/Logger","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/model/generic/6wtaggable-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/model/generic/subscribable"],function(k,b,c,n,i,g,d,h,f,j,a,e,m){function o(p){var q=p.get("update");if(q){p.getCommunity().set("update",q)}}var l=i.extend(m,{_attributesMapping:{model_id:"mid",hash_key:"author->hash_key",user_hash_key:"author->hash_key",user_id_hash_key:"author->hash_key","user_id.hash_key":"author->hash_key",user_id_emplid:"author->empl_id",owner_hashkey:"author->hash_key","user.hash_key":"author->hash_key",emplid:"author->empl_id","user_id.emplid":"author->emplid",user_id:"author->mid","user_id.accept_share_info":"author->accept_share_info","user_id.email":"author->email",username:"author->login",first_namdatee:"author->first_name",last_name:"author->last_name","user_id.first_name":"author->first_name","user_id.last_name":"author->last_name",user_first_name:"author->first_name",user_last_name:"author->last_name",nickname:"author->nickname",user_name:"author->nickname","user_id.nickname":"author->nickname",name:"author->nickname",user_nickname:"author->nickname",owner_nickname:"author->nickname",owner_name:"author->nickname","user.nickname":"author->nickname","user_id.address":"author->address","user_id.city":"author->city","user_id.company":"author->company","user_id.country":"author->country","user_id.job_title":"author->job_title",user_picture_update:"author->picture_update",userPictureUpdate:"author->picture_update","user_id.picture_update":"author->picture_update","user.picture_update":"author->picture_update",user_picture_fingerprint:"author->user_picture_fingerprint",stats_nb_endorse:"nb_endorse",nb_endorsements:"nb_endorse",comment_count:"nb_comments",count_comment:"nb_comments",stats_comments:"nb_comments",stats_viewed:"nb_views",stats_nb_rates:"nb_rates",published_date:"publish_date",community_id:"community->mid",community_title:"community->title",communityTitle:"community->title",ds6w_58_community:"community->title",text:"summary",ds6w_58_description:"summary","this->getSummary":"summary",media_id:"thumbnail->mid",thumbnail_id:"thumbnail->mid",first_media_id:"thumbnail->mid","this->getFirstMediaId":"thumbnail->mid",preview_fingerprint:"thumbnail->preview_fingerprint",preview_media_type:"thumbnail->media_type",preview_media_file_ext:"thumbnail->media_file_ext",preview_original_width:"thumbnail->width",preview_original_height:"thumbnail->height",preview_media_id:"thumbnail->mid",preview_media_processing_version:"thumbnail->processing_version",preview_media_processing_status:"thumbnail->status",_community:"community",actor:"author",target:"community",id:"mid",objectType:"type",updated:"update",displayName:"title"},_prevNextId:null,_associations:{author:{Class:d},community:{Class:g},thumbnail:{}},_services:{getpreviousandnextcontent:{url:"api/community/getpreviousandnextcontent",dataFn:function(){return{model:(this.getModelName()==="idea")?"ideation":this.getModelName(),model_id:this.get("mid"),community_id:this.get("community->mid")}}}},HTML_ATTRIBUTES:["content"],defaults:{title:"",description:"",content:"",summary:"",stats_rating:0,nb_rates:0,nb_endorse:0,nb_comments:0,nb_views:0,crdate:"",update:"",_acl:{update:{privilege:null,access:false},"delete":{privilege:null,access:false}}},_getNbCommentsFromCommentCollection:function(){var p=this._associations&&this._associations.comments&&this._associations.comments.associated;if(p&&p.hasBeenFetched()){return p.filterDeletedAndStatusRelatedComments().length}else{return false}},_recomputeNbCommentsIfNeeded:function(){var p=this._getNbCommentsFromCommentCollection();if(p!==false){return this.set("nb_comments",p)}},init:function(p,q){this._prevNextId={status:n.STATUS.notRequested};return this._parent(p,q)},hasFirstMedia:function(){var p=this.getThumbnail().get("mid");if((p!==null)&&(p!==undefined)){return true}else{return false}},getNbComments:function(){var p=this._getNbCommentsFromCommentCollection();if(p!==false){return p}else{return this.get("nb_comments")}},create:function(p){if(this.get("community->mid")){return this._parent(p)}else{throw new Error("Community id is not available. Please populate this instance first.")}},validateField:function(q,p){switch(q){case"title":if(!p||p.trim()===""){return"err-empty"}else{if(p.length>255){return"err-length"}}return false;case"content":if(!p||p.trim()===""){return"err-empty"}return false;default:return false}},getRelativePath:function(p,r,q){if(!p){p=this.get("community->mid");if(!p&&this.get("community")){p=this.get("community").mid||this.get("community").id}}if(!r){r=this.get("mid")}if(typeof q!=="string"){q="/"+this._modelName+":";if(this._modelName==="idea"){q=a.URLCONTENT_IDEATION}}return a.URLPART_COMMUNITY+p+q+r},save:function(u,p,x){var r=undefined,q,v,s=this,t={},w=false;if(!u||k.is(u,"object")){t=u||{};x=p||{}}else{t[u]=p;x=x||{}}k.merge(t,this._changes);if(this.isNew()&&(typeof this.get("published")==="undefined")){this.set("published",0)}if(!((t.published===1)||(parseInt(this.get("published"),10)===1))){x.validate=false}switch(x.notify){case"draft":if(this.isNew()||(this.has("published")&&(parseInt(this.get("published"),10)===0))){r="onDraftCreation"}break;case"publish":if(parseInt(this.get("published"),10)===0){r="onPublishing"}break;default:}if(r){if(window.ds&&window.ds.swymIM===true&&r==="onPublishing"){s.set(u);s.set("enhanced_summary",u.content);s.addChanges(u,{force:true});x.force=true;h.notify("onPrePublishing",[s])}}q=x.onComplete;x.onComplete=function(y,A,z){var B;if(typeof q==="function"){q(y,A,z)}if(r){h.notify(r,[s]);y.dispatchEvent(r)}if((w===true)&&A&&Array.isArray(A.sourceInfos)){B=b.detect(A.sourceInfos,function(C){if(C.name==="6WTags"){return true}});if(B&&B.status===false){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(C,D){C.warn(D.get("TheListOfTagsOnThisContentCouldNotBeUpdated"))})}}};x.data=x.data||{};v=this.getCommunity();if(v.has("mid")){this.addChanges("community_id",v.get("mid"))}this.deriveTagActionsFromContentChanges(this.get("content"),t.content,{onTagDeletionOptions:{showAlertIfTagAlsoPresentInBody:false}});w=this.hasVirtuallyChanged("tags6w");return this._parent(u,p,x)},onTagDeletion:function(u,t,q){var s,r,p=this._parent.apply(this,arguments);if((t!==true)&&p&&!(q&&q.showAlertIfTagAlsoPresentInBody===true)){if(this.hasVirtuallyChanged("content")){s=this.getChanges("content")}else{s=this.get("content")}r=e.get6WTagsFromHTML(s);if(r[u.predicate+"/"+u.object]){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(v,w){v.warn(w.get("TheRemovedTagIsAlsoPresentInTheContentBody"))})}}return p},destroy:function(p){var q=this,r=p&&p.onComplete;if(!p){p={}}p.onComplete=function(s,u,t){if(typeof r==="function"){r(s,u,t)}h.notify("onDestroy",[q]);s.dispatchEvent("onDestroy")};return this._parent(p)},getCommunity:function(){return this.getAssociated("community")},getAuthor:function(){return this.getAssociated("author")},getThumbnail:function(){return this.getAssociated("thumbnail")},getPreviousAndNextContent:function(p){return this.action("getpreviousandnextcontent",p)},"onSync:create":function(){o(this);this.populateEmbeddedMediaAssociation();return this._parent.apply(this,arguments)},"onSync:update":function(){o(this);this.updateContainedMedia();this.setCustomProperty("edited",true);this.populateEmbeddedMediaAssociation();return this._parent.apply(this,arguments)},populateEmbeddedMediaAssociation:function(){var p=this.get("thumbnails_infos");if(Array.isArray(p)&&(p.length>0)){this.getAssociated("embeddedMedia")}},"onSync:read":function(){if(k.is(this.model)){var p=this.model.getAssociated("comments");if(p.hasBeenFetched()){this.set("nb_comments",p.filterDeletedAndStatusRelatedComments(p.toJSON()).length)}}this.populateEmbeddedMediaAssociation();return this._parent.apply(this,arguments)},getContainedMediaIds:function(){return j.getContainedMediaIds(this.has("content")?this.get("content"):"")},getDeletedContainedMediaIds:function(){var p=this;return this.getContainedMediaIds().reduce(function(q,r){if(j.hasMediaBeenDeleted(r,p.get("thumbnails_infos"),p.get("content")||"")){q.push(r)}return q},[])},updateContainedMedia:function(){if(parseInt(this.get("published"))===1){var q,p=this.getContainedMediaIds();require(["DS/SwymUICore/script/feature/community/media/model/media-model"],function(r){p.forEach(function(s){q=new r({id:s});q.set("published","1")})})}},"onSetAssociated:comments":function(r,q,p){this.listenTo(p,"onCollectionChange",this._recomputeNbCommentsIfNeeded);return this._parent.apply(this,arguments)},"onChange:nb_comments":function(){this._recomputeNbCommentsIfNeeded()},onDestroy:function(){this.set("_deleted",true);return this._parent.apply(this,arguments)},getPublishingDate:function(){return this.get("pubdate")||this.get("publish_date")},getSubjectURI:function(){var p=this.getSixwURIs();if(p.length<1){throw new Error("The object does not have any subjecturi!")}else{return p[0]}},"onSync:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(p,q){p.success(q.SubscribeSuccess)})},"onError:subscribe":function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(p,q){p.error(q.SubscribeFailure)})},"onSync:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(p,q){p.success(q.UnsubscribeSuccess)})},"onError:unsubscribe":function(){require(["DS/UWPClientControls/PlatformNotify","i18n!DS/SwymUICore/assets/nls/lib/model/generic/community-content"],function(p,q){p.error(q.UnsubscribeFailure)})}});return l});define("DS/SwymUICore/script/feature/community/media/model/media-model",["UWA/Core","UWA/Data","UWA/Json","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/utils/utils","DS/Logger/Logger","DS/WAFData/WAFData","DS/SwymUICore/script/lib/model/model-manager","i18n!DS/SwymUICore/assets/nls/feature/community/media/model/media-model"],function(b,i,e,r,y,m,A,f,x,d,h){var B=window.ds&&(window.ds.env==="MOBILE"),w={DIMENSIONS:{SMALL:{WIDTH:320,HEIGHT:240},MEDIUM:{WIDTH:640,HEIGHT:480},LARGE:{WIDTH:960,HEIGHT:800}},KEY:{SMALL:17,MEDIUM:18,LARGE:19},TYPE:9},u={DIMENSIONS:{M1:520,L1:960,XL1:1920},KEY:{M1:"m1",L1:"l1",XL1:"xl1",O1:"o1"},TYPE:1},t={DIMENSIONS:{SMALL:{WIDTH:66,HEIGHT:50},MEDIUM:{WIDTH:200,HEIGHT:150},LARGE:{WIDTH:320,HEIGHT:240},XLARGE:{WIDTH:520,HEIGHT:390}},KEY:{SMALL:13,MEDIUM:1,LARGE:2,XLARGE:16},TYPE:0},C={OK:"processed",KO:"error",NOT_PROCESSED:"non-processed",READY:"ready-to-process"},q=function(D){if(B){D=i.proxifyUrl(D,{proxy:"passport"})}return D},c=function(D,H,F,E){var G=f.getBaseUrl()+"/api/media/streammedia/"+((D==="media")?"id/":("model/"+D+"/model_id/"))+H+"/type/thumb/key/"+F;if(E){G+="/update/"+E}else{x.warn("No fingerprint provided for thumbnail url")}if(B){G=i.proxifyUrl(G,{proxy:"passport"})}return G},p=function(G,F,E){var D=f.getBaseUrl()+"/api/media/streammedia/id/"+G+"/type/picture/key/"+F;if(E){D+="/update/"+E}else{x.warn("No fingerprint provided for picture view url")}if(B){D=i.proxifyUrl(D,{proxy:"passport"})}return D},k=43200000,s=["onTimeOut","onUploadProgress"],o=["create","update","patch"],g="userFile",v={mid:"id_media",content:"description"},j={content:"description","community->mid":"community_id"},a=function(E,G,D){var F=D[G];D[G]=function(){if(typeof F==="function"){F.apply(E,arguments)}E.dispatchEvent(G,arguments);if(o.indexOf(D.serviceName)>=0){E.dispatchEvent(G+":"+D.serviceName,arguments)}}},l=function(J,E,D){var F={},H=E.getCustomProperty("uploadRequest"),I=D.onComplete,G=D.onFailure;if(!H||(H&&(H.status!==r.STATUS.pending))){F.status=r.STATUS.pending;E.setCustomProperty("uploadRequest",F);D.onComplete=function(){E.getCustomProperty("uploadRequest").status=r.STATUS.valid;if(typeof I==="function"){I.apply(E,arguments)}};D.onFailure=function(){E.getCustomProperty("uploadRequest").status=r.STATUS.invalid;if(typeof G==="function"){G.apply(E,arguments)}}}else{x.log("An upload is already in progress")}},n=function(Q,S){var F,M="image/png";var R,L,H,J,D,K=[],G=0,P=Q.toDataURL(),I=P.split(",")[1],O=(window.atob)?window.atob(I):I,N=O.length,E=512;for(G=0;G<N;G+=E){R=O.slice(G,G+E);J=R.length;L=new Array(J);for(H=0;H<J;H++){L[H]=R.charCodeAt(H)}D=new Uint8Array(L);K.push(D)}F=new Blob(K,{type:M,"Content-Transfer-Encoding":"base64"});S(F)};var z=y.extend({_modelName:"media",_tableName:"Media",_uploadRequest:{status:r.STATUS.notRequested,file:null},mediaFileAttribute:g,_attributesMapping:{id_media:"mid",media_id:"mid",model_id:"mid",description:"content",MediaType:"media_type",preview_fingerprint:"preview_fingerprint",preview_media_type:"media_type",preview_media_file_ext:"media_file_ext",preview_original_width:"width",preview_original_height:"height",preview_media_id:"mid",preview_media_processing_version:"processing_version",preview_media_processing_status:"status"},_associations:{comments:{Class:m,oppositeRole:"commented",options:{mode:"media"}},commenters:{Class:A,oppositeRole:"commented",options:{mode:"comment"}}},_services:{create:{url:"api/media/addmedia",dataType:"formData",timeout:k,dataFn:function(H){var R,I,L,Q,N,M,K,P,G,J=this,D=["fileName",g,"community_id","title"],O=this.getChanges()||{},F=new FormData();if(!H){H={}}R=Object.keys(O);for(I=0,L=R.length;I<L;I++){Q=R[I];if(!H.hasOwnProperty(Q)){H[Q]=O[Q]}}for(I=0,L=D.length;I<L;I++){var E=D[I];if(!O.hasOwnProperty(E)&&!H.hasOwnProperty(E)){if(J.has(E)){H[E]=J.get(E).trim?J.get(E).trim():J.get(E)}else{if(E==="community_id"&&J.has("community->mid")){H.community_id=J.get("community->mid")}else{throw new Error("The "+E+" is necessary to create a media")}}}}if(!H.hasOwnProperty("is_illustration")){H.is_illustration=true}if(!H.hasOwnProperty("published")){H.published=0}R=Object.keys(H);N=Object.keys(j);for(I=0,L=R.length;I<L;I++){Q=R[I];if(Q===g){K=H[g];if(K instanceof File){F.append(Q,H[Q])}else{if(b.is(K,"string")&&(P=K.split(","))){G=null;if(P[0]==="data:image/png;base64"){G=H.fileName.split(".")[0]+".png"}else{if(P[0]==="data:image/jpeg;base64"){G=H.fileName.split(".")[0]+".jpeg"}}if(G){K=new Blob([P[1]],{type:P[0],"Content-Transfer-Encoding":"base64"});F.append("userFile",K,G);F.append("base64_encoded",1)}}else{if(K instanceof Blob){F.append("userFile",K,K.fileName)}}}}else{M=H[Q];if(b.is(M,"object")||b.is(M,"array")){M=e.encode(M)}if(N.indexOf(Q)>=0){F.append(j[Q],M)}else{F.append(Q,M)}}}return F},parse:function(E){var D,F;if(E&&E.mediaUploaded){F=E.mediaUploaded;for(D in F){if(F.hasOwnProperty(D)){E[D]=F[D]}}delete E.mediaUploaded}return E}},read:{url:"api/media/getmedia",dataFn:function(){return{id_media:this.get("mid"),detailedInfos:true}}},update:{url:"api/media/editmedia",dataType:"formData",timeout:k,dataFn:function(G){var Q,H,K,P,M,L,J,O,F,I=this,D=[],N=this.getChanges()||{},E=new FormData();if(!G){G={}}Q=Object.keys(N);for(H=0,K=Q.length;H<K;H++){P=Q[H];if(!G.hasOwnProperty(P)){G[P]=N[P]}}Q=Object.keys(G);M=Object.keys(v);for(H=0,K=Q.length;H<K;H++){P=Q[H];if(P===g){J=G[g];if(J instanceof File){E.append(P,G[P])}else{if(b.is(J,"string")&&(O=J.split(","))){F=null;if(O[0]==="data:image/png;base64"){F=this.get("orig_name").split(".")[0]+".png"}else{if(O[0]==="data:image/jpeg;base64"){F=this.get("orig_name").split(".")[0]+".jpeg"}}if(F){J=new Blob([O[1]],{type:O[0],"Content-Transfer-Encoding":"base64"});E.append("userFile",J,F);E.append("base64_encoded",1)}}}}else{L=G[P];if(b.is(L,"object")||b.is(L,"array")){L=e.encode(L)}if(M.indexOf(P)>=0){E.append(v[P],L)}else{E.append(P,L)}}}return E}},"delete":{url:"api/media/deletemedia",dataFn:function(){return{id:this.get("community->mid"),com_id:this.get("community->mid"),id_media:this.get("mid"),med_type:this.get("media_type")}}},deleteContribution:{url:"api/community/deletecontribution",dataFn:function(){return{mediaIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}},remove:{url:"api/community/deletecontribution",dataFn:function(){return{ids:[this.get("mid")],community_id:this.get("community->mid")}}},reprocess:{url:"/api/media/restartprocessing",dataFn:function(){return{id_media:this.get("mid")}}}},defaults:{published:0,category_id:0,download_original_file:0,processing_version:0},init:function(){this._parent.apply(this,arguments);this._whiteListPDFFiles();this.setupPictureviewConfig()},_whiteListPDFFiles:function(){if(this.get("media_type")==="document"&&this.get("status")==="error"&&(this.get("media_file_ext")==="pdf"||this.get("fileName")&&this.get("fileName").endsWith(".pdf"))){this.set("height",240);this.set("width",320);this.set("status","processed")}},hasFirstMedia:function(){return false},onSync:function(){this._parent.apply(this,arguments);this.setupPictureviewConfig()},setupPictureviewConfig:function(){if((parseInt(this.get("processing_version"),10)===1)&&(!this.get("pictureviewConfig"))){var K,E,L={},I=u,M=I.DIMENSIONS.M1,F=I.DIMENSIONS.L1,G=I.DIMENSIONS.XL1,H=parseInt(this.get("preview_original_height"),10)||parseInt(this.get("height"),10),D=parseInt(this.get("preview_original_width"),10)||parseInt(this.get("width"),10),J=D/H;E=(D>=H)?"landscape":"portrait";K=(E==="landscape")?D:H;if(K<=G){L.o1={width:D,height:H}}if(K>M){if(E==="landscape"){L.m1={width:M,height:M/J}}else{L.m1={width:M*J,height:M}}}if(K>F){if(E==="landscape"){L.l1={width:F,height:F/J}}else{L.l1={width:F*J,height:F}}}if(K>G){if(E==="landscape"){L.xl1={width:G,height:G/J}}else{L.xl1={width:G*J,height:G}}}this.set("pictureviewConfig",L)}},sync:function(F,E,D){if(o.indexOf(F)>=0){s.forEach(function(G){a(E,G,D)});l(F,E,D)}this._parent.apply(this,arguments)},get:function(){var E=arguments[0],D=this._parent.apply(this,arguments);if(E==="media_type"&&D==="animatedPicture"&&f.isFeatureActivated("activateGIF")===false){D="picture"}return D},isMediaAPlayableGIF:function(){var D=this.get("media_type"),E=this.get("play");return(D==="animatedPicture")&&E&&E.av_streams&&E.av_streams.length>0},validateField:function(E,D){switch(E){case"title":return false;case"content":return false;default:return this._parent(E,D)}},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(E){try{this.getAssociated("comments").addComment(E)}catch(D){x.log("exception:",D)}},remove:function(D){return this.action("remove",D)},reprocess:function(D){var E=this;return this.action("reprocess",{onComplete:function(){E.set("status",C.READY);E.set("update",new Date().toString());require(["DS/UWPClientControls/PlatformNotify"],function(F){F.success(Nls.get("Themediaisbeingprocessed"))});if(D.onComplete){D.onComplete()}},onFailure:function(F){require(["DS/UWPClientControls/PlatformNotify"],function(G){var H=Nls.SorryAnerroroccuredwhileperformingthisaction;if(F&&F.errorcode==="ERROR_ACCESS_DENIED"){H=Nls.Onlysuperusersareauthorizedtoperformthisaction}G.error(H)});if(D.onFailure){D.onFailure()}}})},deleteContribution:function(D){return this.action("deleteContribution",D)},getRssLink:function(D){if(!D){D=10}return"/rss/filter/feed/model/media/limit/"+D+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},isConsideredAsA360MediaModel:function(){var D=this.get("media_file_ext"),E=(D==="jpg"||D==="jpeg")||(this.get("play")&&this.get("play").download_original_url&&(this.get("play").download_original_url.format==="jpg"||this.get("play").download_original_url.format==="jpeg"));return(this.get("media_type")==="picture"&&parseInt(this.get("width"),10)>500&&E===true)},isUploading:function(){var D=this.getCustomProperty("uploadRequest");if(D&&(D.status===r.STATUS.pending)){return true}else{return false}},publishFrom3DDriveToSwym:function(D){f.get3DDriveURL(this.get("envId"),function(E){if(E){f.get3DDriveCSRFToken(this.get("envId"),function(F){l("create",this,D);d.authenticatedRequest(E+"/resources/3ddrive/v1/bos/"+this.get("objectId")+"/publish?tenant="+this.get("envId"),{data:JSON.stringify({platformid:f.getBaseUrl(),communityid:this.getChanges("community_id")||this.getAssociated("community").get("mid"),isillustration:b.is(this.getChanges("is_illustration"))?this.getChanges("is_illustration"):true,ispublished:(D.notify==="publish")}),headers:{"X-DS-CSRFTOKEN":F,Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8"},type:"json",method:"POST",timeout:60000,onComplete:function(H,J){var G,I,H=H.result;if(H&&H.mediaUploaded){I=H.mediaUploaded;for(G in I){if(I.hasOwnProperty(G)){H[G]=I[G]}}delete H.mediaUploaded}this.set(H);D.onComplete();this.dispatchEvent("onSync:create",[this,H]);if(D.notify==="publish"){h.notify("onPublishing",[this])}}.bind(this),onFailure:D.onFailure})}.bind(this),function(){x.error("3DDrive CSRF token not found")})}else{x.error("envid or 3ddrive url is undefined")}}.bind(this),function(){x.error("3DDRIVE url is undefined")})},updateContainedMedia:function(){},get3DFileURL:function(){var H=this.get("play")["3d_streams"],G,E="";for(var F=0,D=H.length;F<D;F++){G=H[F];if(G.format==="3dxml"||G.format==="sdm"||G.format==="str"){E=G.transient_url;break}}return E},get3DFileFormat:function(){var H=this.get("play")["3d_streams"],G,F="";for(var E=0,D=H.length;E<D;E++){G=H[E];if(G.format==="3dxml"||G.format==="sdm"||G.format==="str"){F=G.format;break}}return F}});require(["DS/SwymUICore/script/feature/community/community/model/community-model"],function(D){z.prototype._associations.community.Class=D});z.convertCanvasElementToBlob=n;z.MEDIA_THUMBNAIL=t;z.PICTUREVIEW_V0=w;z.PICTUREVIEW_V1=u;z.MEDIA_PROCESSING_STATUS=C;z.constructThumbnailUrl=c;z.constructPictureViewUrl=p;z.constructSpriteUrl=q;return z});define("DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model",["UWA/Core","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/WebappsUtils/Console"],function(h,g,b,c,f,a){var e=9,d=g.extend({_modelName:"dm",defaults:{"this":{getCurrentUserRights:2}},_associations:{users:{Class:b,options:{mode:"listmembers",limit:20}},community:{Class:g}},_services:{create:{url:"api/directmessages",method:"POST",wrapData:false,dataFn:function(){return{users:h.merge(this.getChanges("users"),this.get("users"))}}},addFavorite:{url:"api/favorites/directmessages",wrapData:false,dataType:"json",method:"PATCH",dataFn:function(){return{external_id:this.get("mid"),position:this.get("position")}}},removeFavorite:{url:"api/favorites/directmessages",method:"DELETE",dataType:"json",wrapData:false,dataFn:function(){return{external_id:this.get("mid")}}},"delete":{method:"PATCH",dataType:"json",wrapData:false,dataFn:function(){return{hide:true}}},hide:{method:"PATCH",dataType:"json",wrapData:false,dataFn:function(){return{hide:true}}},setTopic:{}},setTopic:function(i){return this.action("setTopic",{url:"api/directmessages/settopic/"+this.get("mid"),wrapData:false,dataType:"json",method:"PATCH",dataFn:function(){return{topic:i.topic}},onComplete:i.onComplete,onFailure:i.onFailure})},"onChange:mid":function(){this.setAssociated("community",new g({mid:this.get("mid")}))},"onSetAssociated:community":function(j,k,i){this.listenTo(i,"onSync:read",function(){this.set(h.merge(this.toJSON(),i.toJSON()))})},"onSync:read":function(){var i=this.getAssociated("community");i.set(h.merge(i.toJSON(),this.toJSON()));this._parent.apply(this,arguments)},destroy:function(i){i.url="api/directmessages/"+this.get("mid");return this._parent.call(this,i)},hide:function(i){this.set("is_hidden",true);this.set("is_favorite",false);i.url="api/directmessages/"+this.get("mid");return this.action("hide",i)},validateField:function(){return false},getRelativePath:function(){var j,i=this.get("mid");if(!i){a.log("exception : there is no ID DM defined !!!")}j=c.URLPART_DM+i;return j},getMembersTitle:function(s){var r="",k=this.getAssociated("users"),n=k.filter(function(i){return i.get("login")!==s}),j=n.length,o,q;if(j===1){r=n[0].getNickname()}else{for(var p=0,m=Math.min(3,j);p<m;p++){o=n[p];q=(p!==m-1)?", ":"";r+=(o.getNickname()+q)}}return r}});d.MAX_NB_USERS_IN_DM=e;return d});define("DS/SwymUICore/script/feature/community/media/collection/media-collection",["UWA/Core","DS/SwymUICore/script/lib/6wpanel/utils","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/Logger/Logger"],function(f,d,e,a,c){var b=e.extend({_asAdmin:false,_collectionName:"media-collection",_services:{read:{all:{url:"api/media/listallmedia",dataFn:function(g){return{page:this._currentPage,limit:this._limit}}},communityMedia:{url:"api/media/listallmedia",dataFn:function(g){return{as_admin:this._asAdmin,page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityLatestMedia:{url:"api/media/listallmedia",dataFn:function(g){return{page:this._currentPage,limit:this._limit,community_id:this.communityId}}},communityHighSemanticMedia:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({query:"type:"+this.exaleadContentType,legacyFormat:false,community_id:this.communityId,with_synthesis:false},g||{})},parse:d.parseSearchResult},mediaByTenant:{url:"api/media/listallmediasbytenant",dataFn:function(g){return{page:this._currentPage,start:(this._currentPage-1)*this._limit,limit:this._limit,sort:"id_media",dir:"DESC"}}},listallmediafrommypublicprivatecommunities:{url:"api/media/listallmediafrommypublicprivatecommunities",dataFn:function(g){return{as_admin:this._asAdmin,page:this._currentPage,limit:this._limit}}}},filter:{all:{url:"api/exalead/search",tagsWithoutSubjectURI:true},tenantMedia:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{as_admin:this._asAdmin,order_field:"pubdate",order_by:"desc"})},tagsWithoutSubjectURI:true},communityMedia:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null,as_admin:this._asAdmin,order_field:"pubdate",order_by:"desc"})},tagsWithoutSubjectURI:true},communityLatestMedia:{url:"api/exalead/search",dataFn:function(g){return f.extend(g||{},{refineUsingQuery:this.communityId?('community_id:"'+this.communityId+'"'):null,order_field:"pubdate",order_by:"desc",as_admin:this._asAdmin})},tagsWithoutSubjectURI:true},communityHighSemanticMedia:{url:"api/exalead/whatsnew",dataFn:function(g){return f.merge({contentType:this.exaleadContentType,legacyFormat:false,community_id:this.communityId,refineUsingQuery:"type:media",with_synthesis:true},g||{})},tagsWithoutSubjectURI:true},mediaByTenant:{url:"api/exalead/search",tagsWithoutSubjectURI:true,dataFn:function(g){var h=f.extend(g||{},{contentType:"media",legacyFormat:false,as_admin:true});if(!h.query){h.query="#all"}delete h.dir;delete h.sort;return h}}}},model:a,modes:["all","communityMedia","tenantMedia","communityLatestMedia","communityHighSemanticMedia","filteredMedia","mediaByTenant","listallmediafrommypublicprivatecommunities"],exaleadContentType:"media",setup:function(h,g){if(g.communityId){this.communityId=g.communityId}if(g.filters){this.filters=g.filters}if(f.is(g.asAdmin)){this._asAdmin=g.asAdmin}this._parent.apply(this,arguments);if(this.mode==="communityHighSemanticMedia"){this.setPageMode("start")}},setFilters:function(h,g){this.filters=h;if(g===true){this.resetCollection(1)}},parse:function(){var h,g=this._parent.apply(this,arguments);if(Array.isArray(g)){g.forEach(function(i){if(i){switch(i.ds6w_58_jobStatus){case"ds6w:jobStatus.swym_media_processed":h=a.MEDIA_PROCESSING_STATUS.OK;break;case"ds6w:jobStatus.swym_media_error":h=a.MEDIA_PROCESSING_STATUS.KO;break;case"ds6w:jobStatus.swym_media_non_processed":h=a.MEDIA_PROCESSING_STATUS.NOT_PROCESSED;break;case"ds6w:jobStatus.swym_media_ready_to_process":h=a.MEDIA_PROCESSING_STATUS.READY;break;default:return}i.status=h}})}return g}});return b});define("DS/SwymUICore/script/feature/community/idea/model/idea-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/idea/model/link-model","DS/SwymUICore/script/feature/community/idea/collection/link-collection","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/idea/model/status-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(g,h,j,i,d,k,l,b,e,a,c){var f=h.extend({_modelName:"idea",_tableName:"Dsi_Ideation_Ideation",linkCollection:null,_attributesMapping:{id:"mid",crdate:"crdate",update:"update",message:"content"},_associations:{status:{Class:b},thumbnail:{Class:l},comments:{Class:d,oppositeRole:"commented",options:{mode:"idea"}},links:{Class:i,oppositeRole:"linked",options:{mode:"community"}},commenters:{Class:k,oppositeRole:"commented",options:{mode:"comment"}},embeddedMedia:{Class:e,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/Ideation/add",paramsMapping:{content:"message"},dataFn:function(m){m=m||{};m.withThumbnailsInfo=true;return m}},read:{url:"api/Ideation/get",dataFn:function(){return{id:this.get("mid"),withThumbnailsInfo:true}}},update:{url:"api/Ideation/update",paramsMapping:{mid:"id",content:"message"},dataFn:function(m){m=m||{};m.withThumbnailsInfo=true;return m}},updateideationstatus:{url:"api/Ideation/updateideationstatus",dataFn:function(m){c.log(m);return{id:this.get("mid"),status_id:m.status_id,out:m.out,status_comment:m.status_comment}}},"delete":{url:"api/community/deletecontribution",dataFn:function(){return{ideationIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community->id")}}}},defaults:{message:"",title:""},deleteContribution:function(m){return this.destroy(m)},getRelativePath:function(m,o,n){if(typeof n!=="string"){n=a.URLCONTENT_IDEATION}return this._parent.call(this,m,o,n)},editStatus:function(m){return this.action("updateideationstatus",m)},getStatus:function(){var m;if(this.hasAssociation("status")&&!this.getAssociated("status").get("mid")){m={mid:this.get("status_id"),title:this.get("status_title"),color:this.get("status_color")};if(!g.is(m.color)){delete m.color}if(!g.is(m.status_title)){delete m.status_title}this.setAssociated("status",new b(m))}return this.getAssociated("status")},getLinks:function(){return this.getAssociated("links")},addLink:function(o,p){var n=new j();var m=this;o.ideation_id=this.get("mid");n.save(o,{onComplete:function(q){if(m.getAssociated("links")){m.getAssociated("links").unshift(q)}if(p&&p.onComplete){p.onComplete(q)}},onFailure:function(r,q){if(p&&p.onFailure){p.onFailure(r,q)}}});return n},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(p){try{var o=this.getComments();var m=o.filterDeletedAndStatusRelatedComments(o.toJSON()).length;o.addEventOnce("onAdd",function(){this.set("nb_comments",(m+1))}.bind(this));o.addComment(p)}catch(n){c.log("exception:",n)}},getRssLink:function(m){if(!m){m=10}return"/rss/filter/feed/model/idea/limit/"+m+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")}});return f});define("DS/SwymUICore/script/feature/community/wiki/model/wiki-model",["UWA/Core","i18n!DS/SwymUICore/assets/nls/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/utils","DS/WebappsUtils/Console","DS/WebappsUtils/WebappsUtils"],function(i,g,j,c,k,l,b,e,h,a,d){var f=j.extend({_modelName:"wiki",_tableName:"Dsi_DFSTree_WikiTree",_attributesMapping:{message:"content",id:"mid",crdate:"crdate",update:"update"},_associations:{thumbnail:{Class:l},comments:{Class:c,oppositeRole:"commented",options:{mode:"wiki"}},commenters:{Class:k,oppositeRole:"commented",options:{mode:"comment"}},contributors:{Class:k,oppositeRole:"commented",options:{mode:"edit"}},authorizedusers:{Class:b,oppositeRole:"authorized",options:{mode:"getauthorizedusers",limit:999}},embeddedMedia:{Class:e,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/WikiTree/addChild",dataFn:function(m){if(!m){m={}}m.parent_id=this.get("parent_id");this.unset("minor_edition");this.removeChanges("minor_edition");return m},paramsMapping:{content:"message"},parse:function(m){if(m){m.published="1"}return m}},"delete":{url:"api/WikiTree/delete",dataFn:function(m){return{id:this.get("mid"),mustDeleteSubpages:m.mustDeleteSubpages}}},read:{url:"api/WikiTree/get_instance",dataFn:function(p){var n=this.get("mid"),m=this.get("is_root"),o=(this.get("community")?this.get("community").mid:null);if(!n){m=true}return{id:(m?null:(n||(p?p.id:null))),community_id:o,diff:(p&&p.diff?p.diff:false),revision:(i.is(p.revision)?p.revision.toString():null),withThumbnailsInfo:true}},parse:function(n){if(n.is_root===true&&n.message===""){n.message="<p><b>"+g.Wiki_Welcome+"</b></p><h1>"+g.Wiki_h1_Usage+"</h1><p>"+g.Wiki_Usage_contents_p1+".</p><p>"+g.Wiki_Usage_contents_p2+"</p><p>"+g.Wiki_Usage_contents_p3+"</p><p><ul><li>"+g.Wiki_Usage_contents_p4+"</li><li>"+g.Wiki_Usage_contents_p5+"</li><li>"+g.Wiki_Usage_contents_p6+"</li><li>"+g.Wiki_Usage_contents_p7+"</li></ul></p><h1>"+g.Wiki_h1_Structure+"</h1><p>"+g.Wiki_Structure_contents_p1+"</p><p>"+g.Wiki_Structure_contents_p2+"</p><h1>"+g.Wiki_h1_Edition+"</h1><p>"+g.Wiki_Edition_contents_p1+"</p><p>"+g.Wiki_Edition_contents_p2+"</p><h1>"+g.Wiki_h1_Started+"</h1><p><ol><li>"+g.Wiki_GetStart_contents_p1+"</li><li>"+g.Wiki_GetStart_contents_p2+"</li></ol></p>"}if(n){n.published="1"}var q=i.clone(n);var r,m;if(q){r=parseInt(q.revision_index,10);if(q.diff===true){m="_revisionsWithDiff"}else{m="_revisions"}var p=(r<0)?"Current":r;var o=this.get(m);o["revision"+p]=q;this.set(m,o);if((q.diff===true)||((p!=="Current")&&(this.get("_revisionToDisplay")===r))){this.dispatchEvent("onRevisionReceived",{id:r,attributes:q});a.log("onRevisionReceived: id",r,"attributes",q)}if((r>=0)||(q.diff===true)){n={}}return n}}},getNbOfRevisions:{url:"api/WikiTree/infosrevision",dataFn:function(){return{modelId:this.get("mid"),modelType:"WikiTree"}}},toggleLockPage:{url:"api/WikiTree/lock",dataFn:function(){return{id:this.get("mid")}}},toggleLockPageAndChildren:{url:"api/WikiTree/lockall",dataFn:function(){return{id:this.get("mid")}}},update:{url:"api/WikiTree/update",paramsMapping:{mid:"id",content:"message"},dataFn:function(m){m=m||{};if(!this.getChanges("revision_description")){m.revision_description=this._previousAttributes.revision_description}if(!m.minor_edition){m.is_minor_edit="1"}else{m.is_minor_edit=m.minor_edition}if(m.is_minor_edit!=="1"){this.set("nb_revisions",parseInt(this.get("nb_revisions"),10)+1)}this.unset("minor_edition");this.removeChanges("minor_edition");m.withThumbnailsInfo=true;return m}},revert:{url:"api/WikiTree/reverttorevision",dataFn:function(){return{modelId:this.get("mid"),revision:this.getCurrentRevision()}},parse:function(){this.set("nb_revisions",parseInt(this.get("nb_revisions"),10)+1);this.get("_revisionsWithDiff").revisionCurrent=null;this.get("_revisions").revisionCurrent=null}}},defaults:{_revisions:{},_revisionsWithDiff:{},_revisionToDisplay:-1,title:"",author:{},visibility:"1"},getCurrentRevision:function(){var m=this.get("_revisionToDisplay");return m},getCommenters:function(){return this.getAssociated("commenters")},getContributors:function(){return this.getAssociated("contributors")},getComments:function(){return this.getAssociated("comments")},addComment:function(n){try{this.getAssociated("comments").addComment(n)}catch(m){a.log("exception:",m)}},toggleLockPage:function(m){return this.action("toggleLockPage",m)},toggleLockPageAndChildren:function(m){return this.action("toggleLockPageAndChildren",m)},revert:function(m){return this.action("revert",m)},setup:function(m,n){this._parent(m,n)},"onSync:create":function(){var m=this;require(["DS/SwymUICore/script/feature/community/wiki/model/wikitree-model"],function(n){if(m.has("community")){var o=new n({mid:m.get("community").mid,community_id:m.get("community").mid});o.fetch();if(m.get("mid")){o.setCurrentPage(m.get("mid"))}}})},"onSync:update":function(){var m=this.get("nb_revisions"),n=this.get("_revisions");if(n&&n.revisionCurrent&&this.get("is_minor_edit")!=="1"){n["revision"+(parseInt(m,10)-1)]=i.clone(n.revisionCurrent);this.get("_revisionsWithDiff")["revision"+m]=i.clone(this.get("_revisionsWithDiff").revisionCurrent);this.get("_revisionsWithDiff").revisionCurrent=undefined;delete this.get("_revisionsWithDiff").revisionCurrent;this.set("revision_index",-1);n.revisionCurrent=i.clone(this._attributes);this.set("_revisions",n)}return this._parent.apply(this,arguments)},_fetchNthRevision:function(o,m){if(o>=-1){m=m||{};m.revision=o;this.fetch({data:m})}else{throw new Error("Unknown revision n: "+o)}},_setNthRevision:function(q,o){var p,m;if(o&&(o.diff===true)){p=true}else{p=false}m=this.getRevisionData(q,p);if(m){this.dispatchEvent("onRevisionReceived",{id:q,attributes:m});a.log("onRevisionReceived (from cache "+p+"): id",q,"attributes",m)}else{throw new Error("No cache exists for revision "+q)}},_getNthRevision:function(q,o){var m,p;if(o&&(o.diff===true)){p=true}else{p=false}m=this.getRevisionData(q,p);this.dispatchEvent("onRevisionRequested");a.log("onRevisionRequested");if(m){this._setNthRevision(q,o)}else{this._fetchNthRevision(q,o)}},goToPrevRevision:function(p){var o=this.get("_revisionToDisplay"),m=this.get("nb_revisions"),n;if((m!==undefined)&&(m!==0)&&(m!=="0")){if((o>0)||(o===-1)){if(o>0){n=o-1}else{if(o===-1){n=m-2}}this._getNthRevision(n,p);this.set("_revisionToDisplay",n)}else{if(o===0){throw new Error("This wiki page is already on the first revision")}else{throw new Error("The wiki is in an unknown revision "+o)}}}else{throw new Error("This wiki page has not been modified yet")}},goToNextRevision:function(p){var o=this.get("_revisionToDisplay"),m=this.get("nb_revisions"),n;if((m!==undefined)&&(m!==0)&&(m!=="0")){if(o>=0){if(o===m-2){n=-1}else{if(o<m-2){n=o+1}else{throw new Error("The wiki is in an unknown revision "+o)}}this._getNthRevision(n,p);this.set("_revisionToDisplay",n)}else{if(o===-1){throw new Error("This wiki page is already on the latest revision")}else{throw new Error("The wiki is in an unknown revision "+o)}}}else{throw new Error("This wiki page has not been modified yet")}},goToNthRevision:function(p,o){var m=this.get("nb_revisions");if((m!==undefined)&&(m!==0)&&(m!=="0")){if((p>=-1)&&(p<=m)){if(p===m){p=-1}this._getNthRevision(p,o);this.set("_revisionToDisplay",p)}else{throw new Error("The revision "+p+" asked for, does not exist yet")}}else{throw new Error("This wiki page has not been modified yet")}},goToFirstRevision:function(m){this.goToNthRevision(0,m)},goToLastRevision:function(n){var m=this.get("nb_revisions");this.goToNthRevision((m),n)},_replaceStreammediaUrl:function(m){var n=/src="([^"]*)\/streammedia\/.+?"/gi;return m.replace(n,['src="',d.getWebappsBaseUrl(),'SwymUIComponents/assets/thumb.png"'].join(""))},getRevisionData:function(q,o){var n,p,m;if(o===true){if((q===-1)||(q==="Current")){n=parseInt(this.get("nb_revisions")-1);p="_revisionsWithDiff"}else{if(q===0){n=0;p="_revisions"}else{n=q;p="_revisionsWithDiff"}}}else{if((q===-1)||(q==="Current")){n="Current"}else{n=q}p="_revisions"}m=this.get(p)&&this.get(p)["revision"+n];return m},getToc:function(){var q=this,r=[],p=q.get("content"),o=i.createElement("div",{html:p?q._replaceStreammediaUrl(p):""}).querySelectorAll("h1, h2, h3"),n=[];for(var m=o.length;m--;n.unshift(o[m])){}if(n){n.forEach(function(s){if(s.innerText.trim()!==""){r.push({name:s.innerText,id:s.getAttribute("id"),level:s.tagName})}})}return r},generateToc:function(u){var p,r,n,m,t=i.createElement("div",{html:u?this._replaceStreammediaUrl(u):""}),s=t.querySelectorAll("h1, h2, h3"),o=[];for(var q=s.length;q--;o.unshift(s[q])){}if(o){o.forEach(function(v){p=v.attributes;n=p.getNamedItem("id");m=Math.floor(Math.random()*99999);if(n){n.value="content-"+v.tagName+"-"+m}else{r=document.createAttribute("id");r.value="content-"+v.tagName+"-"+m;p.setNamedItem(r)}})}return t.getHTML()},getRssLink:function(m){if(!m){m=10}return"/rss/filter/feed/model/wiki/limit/"+m+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")}});return f});define("DS/SwymUICore/script/feature/community/post/model/post-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/comment/collection/comment-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/WebappsUtils/Console"],function(h,e,g,a,d,f,c){var b=e.extend({_modelName:"post",_tableName:"CommunityPost",_attributesMapping:{id:"mid",model_id:"mid",community_post_id:"mid",message:"content"},_associations:{thumbnail:{Class:d},comments:{Class:g,oppositeRole:"commented",options:{mode:"post"}},commenters:{Class:a,oppositeRole:"commented",options:{mode:"comment"}},embeddedMedia:{Class:f,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/post/addpost",paramsMapping:{mid:"community_post_id",content:"message"},dataFn:function(i){i=i||{};i.withThumbnailsInfo=true;return i}},read:{url:"api/post/get_instance",dataFn:function(){return{community_post_id:this.get("mid"),withThumbnailsInfo:true}}},update:{url:"api/post/updatepost",paramsMapping:{mid:"community_post_id",content:"message"},dataFn:function(i){i=i||{};i.withThumbnailsInfo=true;return i}},"delete":{url:"api/community/deletecontribution",dataFn:function(){return{ids:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}}},defaults:{},getCommenters:function(){return this.getAssociated("commenters")},getComments:function(){return this.getAssociated("comments")},addComment:function(j){try{this.getAssociated("comments").addComment(j)}catch(i){c.log("exception:",i)}},deleteContribution:function(i){return this.destroy(i)},getRssLink:function(i){if(!i){i=10}return"/rss/filter/feed/model/post/limit/"+i+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")}});return b});define("DS/SwymUICore/script/feature/community/survey/model/survey-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/survey/collection/question-collection","DS/SwymUICore/script/feature/community/survey/model/question-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils"],function(a,r,o,h,k,l,c,b){var d=new Date(),n=new Date(),m=d.getHours(),g=((parseInt(m,10))<=9?"0"+parseInt(m,10):parseInt(m,10))+":00",j=d.getFullYear(),q=parseInt(d.getMonth(),10),p=parseInt(d.getDate(),10),f=j+"-"+((q<9?"0"+(q+1):(q+1))+"-"+(p<9?"0"+p:p));n.setMonth(n.getMonth()+1);j=n.getFullYear();endMonth=parseInt(n.getMonth(),10);n=parseInt(n.getDate(),10);var i=j+"-"+((endMonth<9?"0"+(endMonth+1):(endMonth+1))+"-"+(n<9?"0"+n:n));var s=r.extend({_modelName:"survey",_tableName:"Poll",_associations:{questions:{Class:o,oppositeRole:"survey"},thumbnail:{Class:k},embeddedMedia:{Class:l,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_attributesMapping:(b.isFeatureActivated("activateSurveyImprovements")?{model_id:"mid"}:{model_id:"community_id"}),_convertDateAndHoursIntoGMT:function(z){var u=z.date,y=z.hour,t=y.split(":"),x=parseInt(t[0],10),v=parseInt(t[1],10),A=new Date(u),w={};if(x){A.setHours(x)}if(b.isFeatureActivated("activateSurveyImprovements")&&typeof v==="number"){A.setMinutes(v)}w.date=A.getUTCFullYear()+"-"+("0"+(A.getUTCMonth()+1)).slice(-2)+"-"+("0"+A.getUTCDate()).slice(-2);if(b.isFeatureActivated("activateSurveyImprovements")){w.hour=("0"+A.getUTCHours()).slice(-2)+":"+A.getUTCMinutes()}else{w.hour=("0"+A.getUTCHours()).slice(-2)+":00"}return w},_convertDateAndHoursIntoLocal:function(z){var v=z.date,u=z.hour,x=u.split(":"),A=parseInt(x[0],10),y=parseInt(x[1],10),t=new Date(v),w={};if(A){t.setUTCHours(A)}if(b.isFeatureActivated("activateSurveyImprovements")&&y){t.setUTCMinutes(y)}w.date=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2);if(b.isFeatureActivated("activateSurveyImprovements")){w.hour=("0"+t.getHours()).slice(-2)+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()}else{w.hour=("0"+t.getHours()).slice(-2)+":00"}return w},init:function(t,w){var v=this._parent(t,w);if(w&&w.autoPopulate!==true){var u=this._convertDateAndHoursIntoLocal({date:this.get("startDate"),hour:this.get("startHour")}),x=this._convertDateAndHoursIntoLocal({date:this.get("endDate"),hour:this.get("endHour")});this.set({startDate:u.date,startHour:u.hour,endDate:x.date,endHour:x.hour})}return v},_services:{create:{url:"api/poll/createpoll",dataFn:function(){var w=a.merge(this.getChanges(),this.getAttributes()),u=new Date(),x=new Date();x.setMonth(x.getMonth()+1);var y={endDate:x.getFullYear()+"-"+((parseInt(x.getMonth(),10)+1)<=9?"0"+(parseInt(x.getMonth(),10)+1):(parseInt(x.getMonth(),10)+1))+"-"+((parseInt(x.getDate(),10))<=9?"0"+parseInt(x.getDate(),10):parseInt(x.getDate(),10)),endHour:(b.isFeatureActivated("activateSurveyImprovements")?((parseInt(x.getHours(),10))<=9?"0"+parseInt(x.getHours(),10):parseInt(x.getHours(),10))+":"+((parseInt(x.getMinutes(),10))<=9?"0"+parseInt(x.getMinutes(),10):parseInt(x.getMinutes(),10)):((parseInt(x.getHours(),10))<=9?"0"+parseInt(x.getHours(),10):parseInt(x.getHours(),10))+":00"),model:"Community",modelId:w.community.mid,published:0,showResultsAfterVote:false,startDate:u.getFullYear()+"-"+((parseInt(u.getMonth(),10)+1)<=9?"0"+(parseInt(u.getMonth(),10)+1):(parseInt(u.getMonth(),10)+1))+"-"+((parseInt(u.getDate(),10))<=9?"0"+parseInt(u.getDate(),10):parseInt(u.getDate(),10)),startHour:(b.isFeatureActivated("activateSurveyImprovements")?((parseInt(u.getHours(),10))<=9?"0"+parseInt(u.getHours(),10):parseInt(u.getHours(),10))+":"+((parseInt(u.getMinutes(),10))<=9?"0"+parseInt(u.getMinutes(),10):parseInt(u.getMinutes(),10)):((parseInt(u.getHours(),10))<=9?"0"+parseInt(u.getHours(),10):parseInt(u.getHours(),10))+":00"),title:""};a.merge(w,y);w.questions=[];this.getAssociated("questions").forEach(function(A){var B=A.toJSON();a.extend(B,A.getChanges());B.answers=[];if(A.get("type")==="Single"||A.get("type")==="Multiple"){A.getAssociated("answers").forEach(function(C){B.answers.push(C.toJSON())})}else{if(A.get("type")==="Open"){B.answers.push({is_open:"1",description:"Open"})}else{if(A.get("type")==="Scale"){B.answers.push({is_open:"0",description:"Scale"})}}}w.questions.push(B)});var v=this._convertDateAndHoursIntoGMT({date:w.startDate,hour:w.startHour}),z=this._convertDateAndHoursIntoGMT({date:w.endDate,hour:w.endHour});w.startDate=v.date;w.startHour=v.hour;w.endDate=z.date;w.endHour=z.hour;if(w.startDate=="0000-00-00"){var t=new Date();w.startDate=t.toLocaleFormat("%Y-%m-%d");w.startHour=(t.getHours()<=9?"0":"")+t.getHours()+":"+(t.getMinutes()<=9?"0":"")+t.getMinutes()}return w},postProcess:function(w){if(w&&w.result){this.set("mid",(w.result.id||w.result))}if(w&&w.result){var t=w.result,u=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),v=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});t.startDate=u.date;t.startHour=u.hour;t.endDate=v.date;t.endHour=v.hour;return t}}},read:{url:"api/poll/getpoll",dataFn:function(){return{pollId:this.get("mid")}},postProcess:function(w){if(w&&w.result){var t=w.result,u=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),v=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});t.startDate=u.date;t.startHour=u.hour;t.endDate=v.date;t.endHour=v.hour;return t}}},update:{url:"api/poll/updatepoll",dataFn:function(){var v=a.merge(this.getChanges(),this.toJSON());v.id=this.get("mid");v.questions=[];this.getAssociated("questions").forEach(function(x){var y=x.toJSON();a.extend(y,x.getChanges());y.answers=[];if(x.get("type")!=="Open"||(x.get("type")==="Open"&&x.getAssociated("answers").length===1)){x.getAssociated("answers").forEach(function(B,z){var A=B.toJSON();A.id=A.mid;A.position=z+1;this.answers.push(A)}.bind(y))}else{if(x.get("type")==="Open"&&x.getAssociated("answers").length>1){y.answers.push({is_open:"1",description:"Open",position:"1"})}}y.id=y.mid;this.questions.push(y)}.bind(v));var u=this._convertDateAndHoursIntoGMT({date:v.startDate,hour:v.startHour}),w=this._convertDateAndHoursIntoGMT({date:v.endDate,hour:v.endHour});v.startDate=u.date;v.startHour=u.hour;v.endDate=w.date;v.endHour=w.hour;if(v.startDate=="0000-00-00"){var t=new Date();v.startDate=t.toLocaleFormat("%Y-%m-%d");v.startHour=(t.getHours()<=9?"0":"")+t.getHours()+":"+(t.getMinutes()<=9?"0":"")+t.getMinutes()}return v},postProcess:function(w){if(w&&w.result){var t=w.result,u=this._convertDateAndHoursIntoLocal({date:t.startDate,hour:t.startHour}),v=this._convertDateAndHoursIntoLocal({date:t.endDate,hour:t.endHour});t.startDate=u.date;t.startHour=u.hour;t.endDate=v.date;t.endHour=v.hour;return t}}},saveuseranswers:{url:"api/poll/saveuseranswers"},isansweredbyme:{url:"api/poll/isansweredbyme",dataFn:function(){return{pollId:this.get("mid")}},parse:function(t){t=(t.result===false)?t.result:t;console.log("mid user ",this.get("title"),"the value of has answered",t);this.set("userHasAlreadyAnswered",t)}},canseeresults:{url:"api/poll/canseeresults",dataFn:function(){return{pollId:this.get("mid")}},parse:function(t){t=(t.result===false)?t.result:t;this.set("canSeeResults",t)}},"delete":{url:"api/community/deletecontribution",dataFn:function(){return{pollIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}},getResults:{url:"api/poll/exportresults",dataFn:function(){return{pollId:this.get("mid")}}}},defaults:{title:"",endHour:g,startHour:g,endDate:i,startDate:f,published:0,showResultsAfterVote:false},isansweredbyme:function(t){return this.action("isansweredbyme",t)},canSeeResults:function(t){return this.action("canseeresults",t)},validateField:function(u,t){switch(u){case"content":return false;default:return this._parent(u,t)}},addQuestion:function(v){var u=this.getAssociated("questions");v.position=u.length+1;var t=new h(v);u.add(t);return t},deleteContribution:function(t){return this.destroy(t)},saveAnswers:function(u,t){return this.action("saveuseranswers",a.merge({data:{answers:u}},t||{}))},getStartDate:function(){var t=this.get("start")||(this.get("startDate")+" "+this.get("startHour")+":00");return new Date(c.getDateInMilliSec(t))},getEndDate:function(){var t=this.get("end")||(this.get("endDate")+" "+this.get("endHour")+":00");return new Date(c.getDateInMilliSec(t))},hasEnded:function(){return((new Date()).getTime()>this.getEndDate().getTime())},isOpen:function(){var u=new Date(),v=this.getEndDate(),t=this.getStartDate();return((v.getTime()-u.getTime()>0)&&(u.getTime()-t.getTime()>0))},hasStarted:function(){var u=new Date(),t=this.getStartDate();return(u.getTime()-t.getTime()>0)},_convertMS:function e(C){var B=30*24*60*60*1000,v=24*60*60*1000,u=60*60*1000,x=Math.floor(C/B),A=Math.floor((C-x*B)/v),z=Math.floor((C-x*B-A*v)/u),y=Math.round((C-x*B-A*v-z*u)/60000),w=function(t){return t<10?"0"+t:t};if(y===60){z++;y=0}if(z===24){A++;z=0}if(A===30){x++;A=0}return{months:parseInt(x,10),days:parseInt(A,10),hours:parseInt(z,10),minutes:parseInt(y,10)}},getSurveyOpeningTimeRemaining:function(){var w=this.hasStarted(),u=new Date(),t=this.getStartDate(),v=w?0:(t.getTime()-u.getTime());return this._convertMS(v)},removeChanges:function(){var w=this.get("questions")||[],x=[],v;for(var u=0,t=w.length;u<t;u++){v=new h(w[u]);x.push(v)}if(x.length!==0){this.getAssociated("questions").reset(x)}return this._parent.apply(this,arguments)},updateContainedMedia:function(){},getResults:function(t){return this.action("getResults",t)}});return s});define("DS/SwymUICore/script/feature/core/sprite/sprite",["UWA/Core","UWA/Utils","UWA/Class","DS/SwymUICore/script/utils/date","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/Logger/Logger","DS/WebappsUtils/WebappsUtils"],function(a,i,q,l,d,h,c,b,u,g){var p,r=new n(),m=(window.ds&&window.ds.env==="3DSwym");function k(y){var z=y&&y.target,w=((z&&z.dataset&&z.dataset.stylesToRemoveAfterLoad&&z.dataset.stylesToRemoveAfterLoad.split(","))||[]);if(z.dataset.backupImage!=="true"){for(var x=0,v=w.length;x<v;x++){z.setStyle(w[x].trim(),"")}w&&z.removeAttribute("data-styles-to-remove-after-load")}}function s(x){var y=x&&x.target,w=y.dataset.mediaWidth,v=y.dataset.mediaHeight;if(w&&v&&(window.__testmode__!==true)){y.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+w+" "+v+'"%3E%3C/svg%3E';y.dataset.backupImage="true"}y.onerror=null}function n(){var v={};return{add:function(w){v[w]=true},alreadyRequested:function(w){return v[w]},clean:function(){v={}}}}function o(w,z){var D,x,v,F,A,E,y="123456",C="no-sprite-reload-delegation",B="#id"+y+" ."+C;w=a.extendElement(w);E=w.getElements(z);v=w.getAttribute("id")||"";w.setAttribute("id","id"+y);F=z.split(",");F=F.map(function(G){return B+" "+G});A=F.join(",");x=w.getElements(A);if(x.length>0){D=E.filter(function(G){return(x.indexOf(G)<0)})}else{D=E}if(v){w.setAttribute("id",v)}else{w.removeAttribute("id")}return D}function f(w,v){if(v&&w){w.addEvent("mouseover",function(){if(!this.hasClassName(v)){this.addClassName(v)}});w.addEvent("mouseout",function(){if(this.hasClassName(v)){this.removeClassName(v)}})}}var e=function(w){if(!w){w={}}var v=w.el||document.body,y=w.imageKind||"thumb",J=w.size||"m",z=w.selector||this._thumbnailSelector,G=o(v,z),C=G.length,x,I,E,B,F,H,A,D=d.getBaseUrl();if(C>0){if(y==="thumb"){J+="_thumb"}for(B=0;B<C;B++){x=G[B];I=x.dataset.contentId;E=x.dataset.contentType;if(I){F=x.dataset.type||"MediaNoPicture";H=w.clsOver||x.dataset.clsOver;A=x.dataset.fingerprint;if(y==="thumb"&&x.dataset.size){J=x.dataset.size+"_thumb"}if(H){f(a.extendElement(x),H)}x.onload="";x.setAttribute("data-status","Reloaded");if(x.dataset&&x.dataset.stylesToRemoveAfterLoad){x.onload=k}if(y==="thumb"){x.src=b.constructThumbnailUrl(E,I,J,A)}else{x.src=b.constructPictureViewUrl(I,J,A)}}}}},j=function(X){if(!X){X={}}var Y,J=null,M=null,U=0,A=0,R=1,C,V,T,x,K,B,W,y=X.el||document.body,F=X.modifiedId||false,O=X.selector||this._thumbnailSelector,E=o(y,O+(X.deletedMediaSelector?(":not("+X.deletedMediaSelector+")"):"")),Q,D,I,G,L,H,P,N,z=[],w=d.getBaseUrl();if(E.length>0){if(X.spritesMaxLength){while(Q=E.length){z.push(E.splice(0,X.spritesMaxLength))}}else{z.push(E)}for(N=0,D=z.length;N<D;N++){E=z[N];Y=0;U=0;A=0;T="";x="";K=false;B=0;W="";for(P=0,Q=E.length;P<Q;P++){I=E[P];G=I.dataset.mediaId;L=I.dataset.spriteKey||1;H=I.dataset.spriteType||0;J=parseInt(X.height||I.dataset.toHeight||240,10);M=parseInt(X.width||I.dataset.toWidth||320,10);if(G){x=I.dataset.fingerprint||"";U+=parseInt(J,10);A=Math.max(A,M);if(P===0){T=[w+"/api/media/streammediasprite/idList/"+G,L,H].join(":")}else{T=[T,[G,L,H].join(":")].join("=")}if(F&&(G===F)){K=true}}if(x){W+=x}}if(W){T+="/update/"+i.getCheckSum(W)}if(K){var S=new Date();T+="_updateforcing_"+S.getTime()}for(P=0;P<Q;P++){I=E[P];G=I.dataset.mediaId;L=I.dataset.spriteKey||1;Y+=B;if(G){J=parseInt(X.height||I.dataset.toHeight||240,10);M=parseInt(X.width||I.dataset.toWidth||320,10);V=parseInt(X.widthToDisplay||I.dataset.widthToDisplay||0,10);I.set({onload:"","data-status":"Reloaded",styles:a.merge({"background-image":'url("'+b.constructSpriteUrl(T)+'")',"background-position":"0px "+Y/(U-(J))*100+"%","background-repeat":"no-repeat","background-size":(A/(M-R)*100)+"%"+(U/(J-R)*100)+"%"},a.merge({height:0,"padding-top":(J/M*100)+"%"},V?{width:V+"px"}:{}))})}B=parseInt(J||0,10)}}}if(X.deletedMediaSelector&&X.nonDeletedMedia!==false){var v=a.clone(X,false);v.selector+=(X.deletedMediaSelector?X.deletedMediaSelector:"");e(v)}},t=function(U){if(!U){U={}}var V,z=null,S,w,L,A,T,J=U.size||"l",x=U.el||document.body,G=U.modifiedId||false,O=U.selector||this._thumbnailSelector,H=U.isAdmin,F=o(x,O),Q,E,K,I,C,M,P,N,B,D,y=[],v=d.getBaseUrl();if(F.length===1&&U.useSprite!==true){return e.call(this,U)}if(F.length>0){if(U.spritesMaxLength){while(Q=F.length){y.push(F.splice(0,U.spritesMaxLength))}}else{y.push(F)}for(N=0,E=y.length;N<E;N++){F=y[N];V=0;S="";w="";L=false;A=0,T="";for(P=0,Q=F.length;P<Q;P++){K=F[P];C=K.dataset.contentId;I=K.dataset.contentType;M=K.dataset.spriteKey||7;if(C){B=U.clsOver||K.dataset.clsOver;w=K.dataset.fingerprint||"";if(B){f(a.extendElement(K),B)}if(P===0){S=[v+"/api/media/streammediasprite/idList/"+C,I,M].join(":")}else{S=[S,[C,I,M].join(":")].join("=")}if(G&&C===G){L=true}}if(w){T+=w}}S+="/size/"+J;if(H){S+="/admin/true"}if(T){S+="/update/"+i.getCheckSum(T)}if(L){var R=new Date();S+="_updateforcing_"+R.getTime()}D="100% "+(Q*100)+"%";for(P=0;P<Q;P++){K=F[P];C=K.dataset.contentId;V+=A;if(C){z=U.height||K.dataset.toHeight||240;K.set({onload:"","data-status":"Reloaded",styles:{"background-image":'url("'+b.constructSpriteUrl(S)+'")',"background-size":D,"background-position":"0px "+(V*100)/((Q-1)*z)+"%"}})}A=parseInt(z||0,10)}}}};p=q.singleton({_normalPictureSelector:'img[data-type="ENoPicture"]',_miniPictureSelector:'img[data-type="EMiPicture"]',_uminiPictureSelector:'img[data-type="EUmPicture"]',_thumbnailSelector:'img[data-type="MediaNoPicture"]',_communityLogoSelector:'img[data-type="CommunityNoPicture"]',_nonReloadedImagesSelector:'[data-status="NonReloaded"]',_deletedMediaSelector:'[data-deleted-media="true"]',_reloadAllMediaThumbnails:function(v){if(!v){v={}}if(v.useVariableSizeSprite!==true){if(v.nonReloadedImagesOnly===true){v.selector=this._communityLogoSelector+this._nonReloadedImagesSelector+", "+this._thumbnailSelector+this._nonReloadedImagesSelector}else{v.selector=this._communityLogoSelector+", "+this._thumbnailSelector}}else{v.deletedMediaSelector=this._deletedMediaSelector;if(v.nonReloadedImagesOnly===true){v.selector=v.selector+this._nonReloadedImagesSelector}}return e.call(this,v)},getUserPictureAttributes:function(x){if(x){var y,v;if(typeof x.format!=="string"){x.format="normal"}x.format=x.format.toLowerCase();switch(x.format){default:case"normal":y="ENoPicture";v="e-nopicture";break;case"mini":y="EMiPicture";v="e-mipicture";break;case"umini":y="EUmPicture";v="e-umpicture";break}var w="",z={"class":[v," ",x.cls||""].join(""),"data-status":"Reloaded","data-type":y,"data-content-type":"person","data-is-link":"true"};if(x.title){z.title=x.title}if(x.imageFingerprint){w=x.imageFingerprint}else{if(x.imageUpdateTime){w=l.getDateInMilliSec(x.imageUpdateTime)}}z["data-fingerprint"]=w;if(x.login){z["data-login"]=x.login;z.src=h.constructUserPictureUrl(x.login,w)}if(x.hash_key){z["data-hash-key"]=x.hash_key;z.src=h.constructUserPictureUrl(x.login,w,x.hash_key)}if(x.clsOver){z["data-cls-over"]=x.clsOver}if(x.dataIsLink!==undefined){z["data-is-link"]=String(x.dataIsLink)}return z}else{return{}}},renderUserPicture:function(v){return a.createElement("img",this.getUserPictureAttributes(v))},getMediaThumbnailAttributes:function(v){if(v){v.width=v.width||320;v.height=v.height||240;var y,x=v.imageKind||"thumb",w=v.size||"m",z="",A={src:[g.getWebappsBaseUrl(),"SwymUIComponents/assets/thumb.png"].join(""),"data-status":"Reloaded","data-to-width":v.width,"data-crop":v.crop!==false?1:0,"data-type":v.useVariableSizeSprite===true?"VariableSizeMediaThumbnail":(v.communityLogo===true?"CommunityNoPicture":"MediaNoPicture"),"data-is-link":"false"};if(v.as_admin){A["data-as-admin"]=v.as_admin}if(v.community_id){A["data-community-id"]=v.community_id}if(v.mediaType){A["data-media-type"]=v.mediaType}if(v.title){A.title=v.title}if(v.modelName){A["data-content-type"]=v.modelName;if(v.modelId){A["data-content-id"]=v.modelId}}if(v.mediaId){A["data-media-id"]=v.mediaId}if(v.height){A["data-to-height"]=v.height}if(v.heightToDisplay){A["data-height-to-display"]=v.heightToDisplay}if(v.widthToDisplay){A["data-width-to-display"]=v.widthToDisplay}if(v.spriteURL){y=["-",(v.yPosition||0),"px"].join("");A.styles={};A.styles.background=['url("',v.spriteURL,'")'," 0px ",y].join("")}if(v.cls){A["class"]=v.cls}if(v.spriteKey){A["data-sprite-key"]=v.spriteKey}if(v.spriteType){A["data-sprite-type"]=v.spriteType}if(v.isLink){A["data-is-link"]=v.isLink}if(v.clsOver){A["data-cls-over"]=v.clsOver}if(v.size){A["data-size"]=v.size}if(v.imageFingerprint){A["data-fingerprint"]=v.imageFingerprint}else{if(v.imageUpdateTime){A["data-fingerprint"]=l.getDateInMilliSec(v.imageUpdateTime)}else{u.warn("The update time of the media is missing.");A["data-fingerprint"]=""}}if(v.deletedMedia===true){A["data-deleted-media"]="true"}if(v.extraAttributes){A=a.extend(A,v.extraAttributes)}if(x==="thumb"){w=w+"_thumb"}if(x==="thumb"){z=b.constructThumbnailUrl(v.modelName,v.modelId,w,A["data-fingerprint"])}else{z=b.constructPictureViewUrl(v.modelId||v.mediaId,w,A["data-fingerprint"])}if(v.isAdmin===true){z+="/admin/true"}A.src=z;return A}return{}},renderMediaThumbnail:function(v){var w=a.createElement("img",this.getMediaThumbnailAttributes(v));if(w.dataset&&w.dataset.stylesToRemoveAfterLoad){w.onload=k;w.onerror=s}return w}}).init();p.__testonly__={cleanUserPicturesRequestedList:r.clean};return p});define("DS/SwymUICore/script/lib/view/generic/swym-view",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/UIKIT/Spinner","DS/UIKIT/Scroller","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/core/sprite/sprite","DS/WebappsUtils/Console"],function(k,a,d,g,e,l,q,b){var n="scroller_for_view_",c=function(){if(!this._destroyed&&(this._onPage!==true)){this._onPage=true;if(!this._hidden){this.dispatchEvent("onShow",[this])}}},m=function(){if(!this._destroyed&&(this._onPage!==false)){this._onPage=false;if(!this._hidden){this.dispatchEvent("onHide",[this])}}},o=function(s,w,v){var x,t=0,u=s._managedListeners[v],r=u.length;while(t<r){x=u[t];if((x.initialEmitter===w)||(typeof x.initialEmitter.equals==="function"&&x.initialEmitter.equals(w))){x.initialEmitter.removeEvent(v,x.listener,s);u.splice(t,1);r--}else{t++}}},p=function(r){var t,s;if(h.call(this)){f.call(this)}this.addClassName("masked");if(this.getStyle("position")==="static"){this.addClassName("relative-if-masked")}else{this.removeClassName("relative-if-masked")}t=k.createElement("div",{"class":"loading-mask"});if(d.Engine.ie){s=this.getSize();t.setStyles({height:s.height+"px",width:s.width+"px"})}k.createElement("div",{"class":"msg-wrap",html:{tag:"div","class":"msg-ctn",html:{tag:"p",html:[new g({className:"msg-animation",visible:true,animate:true,spin:true}),(k.is(r,"string")&&r)?{tag:"span","class":"msg-text",text:r}:null]}}}).inject(t);t.inject(this)},f=function(){var r=this.getElement("> .loading-mask");if(r){r.destroy()}this.removeClassName("masked")},h=function(){return this.hasClassName("masked")},i=a.extend({_widget:null,_skeleton:null,_onPage:null,_hidden:null,_rendered:null,_destroyed:null,_childViews:null,_parentView:null,_controls:null,_addScroller:null,_scrollerContentSelector:null,_managedListeners:null,_lastRefreshOptions:null,_pendingImageReloadOptions:null,_displayRichTooltips:true,_delegateSpriteReloadToParentView:true,_bufferImagesReload:true,_linkGeneration:false,_renderAfterInjection:true,_displayPropertyBeforeHide:"",_toBeTemporarilyRemovedFromDomOnRefresh:true,name:null,renderTo:null,container:null,imageReloadOptions:{nonReloadedImagesOnly:true},_createContent:function(){return k.createElement("div")},_updateContainer:function(){var s,r=this._createContent.call(this,this._lastRefreshOptions);if(this._toBeTemporarilyRemovedFromDomOnRefresh!==false){s=this.removeForFutureReinsertion(this.container)}this.container.setContent(r);if(this._toBeTemporarilyRemovedFromDomOnRefresh!==false){s()}},_refresh:function(){if(this.container){if(this._rendered){this._updateContainer();this.generateLinks();this.bindEvents();this.dispatchEvent("onRefresh",[this]);this.dispatchEvent("onRedraw",[this])}else{b.warn("Tried to refresh a non-rendered view !")}}return this},_checkInstance:function(s,u){var v;if(!s){throw new Error("Provided instance is not valid")}if(!u){v=true;b.warn("Missing Class in view definition",this.name)}else{if(!k.is(u,"array")){v=(s instanceof u)}else{v=false;for(var t=0,r=u.length;t<r;t++){if(s instanceof u[t]){v=true;break}}}if(!v){throw new Error("Provided instance is not an instance of expected Class(es)")}}return s},_createOrUpdateChildView:function(t,v,s,r){var u=null;if(!s||(v.forceCreation===true)||(s.constructor!==v.Class)){u=this._childViews[t]=new v.Class(v);u.setParentView(t,this);if(s){s.replaceWith(u)}}else{s.setup(v)}return u},getClassNames:function(){var r=this._parent.apply(this,arguments).trim().split(" ");r=r.filter(function(u,t,s){return(s.indexOf(u)===t)});return r.join(" ")},inject:function(){if(this._renderAfterInjection===null){this.render()}var r=this._parent.apply(this,arguments);if(this._renderAfterInjection===true){this.render()}return r},reactTo:function(w,u,s){var t,v=[],r=[];if(k.is(u,"object")){Object.keys(u).forEach(function(x){this.reactTo(w,x,k.merge({listener:u[x]},s))},this)}else{switch(typeof(s)){case"function":t={listener:s};break;case"string":if(typeof this[s]==="function"){t={listener:this[s]}}else{throw new Error("Invalid listener")}break;case"object":t=k.extend({},s);if(typeof s.listener==="string"&&typeof this[s.listener]==="function"){t.listener=this[s.listener]}if(typeof(t.listener)!=="function"){throw new Error("Missing listener")}break;default:throw new Error("Invalid options")}if(w&&u){if(k.is(w,"array")){r=w}else{if(w){r.push(w)}}if(typeof u==="string"){v.push(u)}else{if(k.is(u,"array")){v=u}}this._managedListeners=this._managedListeners||{};r.forEach(function(x){v.forEach(function(y){this._managedListeners[y]=this._managedListeners[y]||[];this._managedListeners[y].push({initialEmitter:x,listener:t.listener});x.addEvent(y,t.listener,t.scope||this,t.priority||0)},this)},this)}}return this},stopReactingTo:function(z,y){var t,v,r,u,w=[],s=[],x=this._managedListeners;if(k.is(z,"array")){s=z}else{if(z){s.push(z)}}if(k.is(y,"array")){w=y}else{if(typeof y==="string"){w.push(y)}}if(s.length>0){if(w.length>0){s.forEach(function(A){w.forEach(function(B){if(x.hasOwnProperty(B)){o(this,A,B)}},this)},this)}else{for(t=0,v=s.length;t<v;t++){for(r in x){if(x.hasOwnProperty(r)){o(this,s[t],r)}}}}}else{for(r in x){if(x.hasOwnProperty(r)){u=x[r];for(t=0,v=u.length;t<v;t++){u[t].initialEmitter.removeEvent(r,u[t].listener,this)}u.splice(0)}}}return this},init:function(s){var r=k.extend({},k.is(s,"object")?s:{});this._rendered=false;this._destroyed=false;this._hidden=false;this._onPage=true;this._controls={};this._childViews={};this._managedListeners={};this._bufferImagesReload=r.bufferImagesReload===false?r.bufferImagesReload:true;if(!this.tagName){this.tagName="div"}["attributes","imageReloadOptions"].forEach(function(t){if(k.is(this[t],"object")){this[t]=k.extend({},this[t])}else{this[t]={}}},this);r._initializing=true;if(r.hasOwnProperty("displayRichTooltips")){this._displayRichTooltips=r.displayRichTooltips}this._parent.call(this,r);if(this._displayRichTooltips===false){this.container.addClassName("no-rich-tooltip")}if(this._delegateSpriteReloadToParentView===false){this.container.addClassName("no-sprite-reload-delegation")}this.dispatchEvent("onInit",[this]);this.removeEvent("onInit");return this},refresh:function(r){this._lastRefreshOptions=(r&&r.constructor===Object)?r:null;if(this.isVisible()){this._refresh()}else{this.addEventOnce("onShow",this._refresh,this)}},bindEvents:function(){},isRendered:function(){return this._rendered},render:function(t){var u=this;try{if(!k.is(t,"object")){t={target:t}}if(this.isRendered()!==true){var v,r="bottom";if(t.position==="top"){r="top"}else{if(t.position==="before"){r="before"}else{if(t.position==="after"){r="after"}}}if(t.target){v=t.target}else{v=t}v=v||this.renderTo;switch(k.typeOf(v)){case"string":v=window.document.getElementById(v);case"element":v=k.extendElement(v);break;default:v=null;break}this.renderTo=v;this.container.setContent(this._createContent.apply(this));if((t.emptyTarget===true)&&((r==="top")||(r==="bottom"))){v.empty()}this._rendered=true;if(this.renderTo){this.inject(this.renderTo,r)}if((t.emptyTarget===true)&&((r==="before")||(r==="after"))){v.remove();if(typeof v.destroy==="function"){v.destroy()}}this.generateLinks();this.bindEvents(t);this.dispatchEvent("onRender",[this]);this.dispatchEvent("onRedraw",[this])}return this}catch(s){u.alert("warn","An error has been detected. Sorry for the inconvenience.");console.error(s)}},setWidget:function(s){var t=this._childViews;if(!s){return this}if(!this._widget){if(!this._parentView){this.reactTo(s,"onDestroy",this.destroy);this.reactTo(s,"onShow",c);this.reactTo(s,"onHide",m)}this._widget=s;for(var r in t){if(t.hasOwnProperty(r)){t[r].setWidget(this._widget)}}}return this},setSkeleton:function(t){var s=this._childViews;if(!this._skeleton){this._skeleton=t;for(var r in s){if(s.hasOwnProperty(r)){s[r].setSkeleton(this._skeleton)}}}return this},createDummyView:function(r){return new j(r)},setParentView:function(r,s){if(typeof r==="string"&&s instanceof i){if(!this._parentView){this._parentView=s;this.reactTo(s,{onShow:c,onHide:m});if(this._widget){this.stopReactingTo(this._widget,["onDestroy","onShow","onHide"])}s.addChildView(r,this)}}return this},addChildView:function(y,x,A){var u,r,v,t,w=this,s=null,z=A&&A.callback;if(typeof y!=="string"){throw new Error("The child view index is missing")}if(this.isDestroyed()){return null}t=this._childViews[y];if(x instanceof i){if(x!==t){s=x;this._childViews[y]=x;x.setWidget(this._widget);x.setSkeleton(this._skeleton);x.setParentView(y,this);if(t){t.replaceWith(x)}if(z){z.call(this,x)}this.dispatchEvent("onChildViewAdd:"+y,[x])}}else{if(k.is(x,"object")){u=x.Class;if(!u){throw new Error("The child view class is missing")}if(typeof(u)==="string"){if(!t){v=this.addChildView(y,this.createDummyView())}else{v=t}require([u],function(B){w.addChildView(y,k.merge({Class:B},x),k.merge({importChildViews:true},A))});return v}else{r=k.extend({},x);r.widget=this._widget;r.skeleton=this._skeleton;s=this._createOrUpdateChildView(y,r,t,A);if(z){z.call(this,s||t)}this.dispatchEvent("onChildViewAdd:"+y,[s])}}else{throw new Error("Passed argument is neither a view nor a view configuration object")}}if(s){this.listenTo(s,"onDestroy",function(B){if(this._childViews[y]===B){delete this._childViews[y]}})}return this._childViews[y]},addChildViews:function(t,s){var r=[];if(k.is(t,"object")){r=Object.keys(t).map(function(u){return this.addChildView(u,t[u],s)},this)}return r},removeChildView:function(r){if(typeof r==="string"){if(this._childViews[r]){this._childViews[r].destroy();delete this._childViews[r]}}else{throw new Error("Invalid arguments")}return this},getChildView:function(r){return this._childViews[r]},getChildViews:function(s){var r;if(!s){r=k.extend({},this._childViews)}else{r={};s.forEach(function(t){r[t]=this.getChildView(t)})}return r},addControl:function(r,t){if(t&&(typeof r==="string")){if(this._controls[r]){try{this._controls[r].destroy()}catch(s){}}this._controls[r]=t;return t}throw new Error("Invalid arguments")},removeControl:function(r){if(typeof r==="string"){if(this._controls[r]){try{this._controls[r].destroy()}catch(s){}delete this._controls[r]}return this}throw new Error("Invalid arguments")},getControl:function(r){return this._controls[r]},setOptions:function(s){this._parent.call(this,s);var u=false,r=false,t=k.extend({},s);if(!t){t={}}else{if(t.hasOwnProperty("tagName")){if(!t.hasOwnProperty("attributes")){t.attributes={tag:t.tagName}}else{t.attributes.tag=t.tagName}}}if(t.hasOwnProperty("id")){this.id=t.id}if(t.hasOwnProperty("domEvents")){this.domEvents=t.domEvents}if(t.hasOwnProperty("className")){if(t.hasOwnProperty("attributes")){t.attributes["class"]=t.className}else{t.attributes={"class":t.className}}}else{if(typeof this.className!=="undefined"){t.className=this.className}else{if(this.attributes.hasOwnProperty("class")){t.className=this.attributes["class"]}else{t.className=this.options.className||""}}}this.options.className=t.className;if(t.hasOwnProperty("container")){u=true}if(t.hasOwnProperty("attributes")){r=true;this.attributes=k.extend(this.attributes,t.attributes)}this.tagName=(this.attributes.tag||t.tagName||this.tagName);delete this.attributes.tag;this.className=this.attributes["class"]=this.getClassNames("-container");if(this.attributes["class"]===""){delete this.attributes["class"]}["container","id","attributes","className","tagName","domEvents"].forEach(function(v){if(typeof(this[v])!=="undefined"){t[v]=this[v]}},this);if(!t||t._initializing!==true){if(u){this.setContainer(t.container)}else{if(r){this.container.set(this.attributes)}}}return this._parent.call(this,t)},setup:function(s){var t=this;try{if(!s){s={}}if(s.hasOwnProperty("renderTo")){this.renderTo=s.renderTo}if(s.hasOwnProperty("imageReloadOptions")){this.imageReloadOptions=k.extend(this.imageReloadOptions,s.imageReloadOptions)}if(s.hasOwnProperty("addScroller")){this._addScroller=s.addScroller}if(this._addScroller===true){this.addScroller();this.addEvent("onRedraw",this.insertScroller)}else{this.removeScroller();this.removeEvent("onRedraw",this.insertScroller)}this.setWidget(s.widget);this.setSkeleton(l.get(s,"skeleton"));if(s._initializing!==true){this.setOptions(s)}return this}catch(r){console.error(r);t.alert("warn","An error has been detected. Sorry for the inconvenience.")}},generateLinks:function(){if((this._linkGeneration===true)&&this.isVisible()&&!this._destroyed){var r=this.container;require(["DS/SwymUICore/script/utils/link-builder-utils"],function(s){s.addHREFToLinks(r)})}},mask:function(r,s){if(k.typeOf(s)!=="element"){s=this.container}if(s){if(s.mask){return s.mask(r)}else{return p.call(s,r)}}},unmask:function(r){if(k.typeOf(r)!=="element"){r=this.container}if(r){if(r.unmask){return r.unmask()}else{return f.apply(r)}}},isMasked:function(r){if(k.typeOf(r)!=="element"){r=this.container}if(r){if(r.isMasked){return r.isMasked()}else{return h.apply(r)}}},show:function(){var r=this.isVisible();if(this.container){this.container.setStyle("display",this._displayPropertyBeforeHide);this._hidden=false;if(this._onPage&&!r){this.dispatchEvent("onShow",[this])}return this.container}},hide:function(){var r=this.isVisible();if(this.container&&!this._hidden){var s=this.container.getAttribute("display");if(s!=="none"){this._displayPropertyBeforeHide=s||"";this.container.setStyle("display","none");this._hidden=true;if(r){this.dispatchEvent("onHide",[this])}return this.container}}},isVisible:function(){if(!this._onPage||this._hidden){return false}return true},getDelayedSyncTask:l.getDelayedSyncTask,replaceWith:function(r,s){if(this.container.getParent()){r.inject(this.container,"before")}if(this._hidden===true){r.hide()}if(s!==false){this.destroy()}else{this.container.remove()}return r},getScroller:function(){return this.getControl(n+this.cid)},insertScroller:function(){var s,t=this._scrollerContentSelector;if(typeof t==="string"){s=this.container.getElement(t)}else{s=this.container}if(s){var r=k.createElement("div",{html:s.getChildren(),styles:{height:"100%"}});s.setContent(r);this.addControl(n+this.cid,new e({element:s.firstElementChild})).inject(s)}},addScroller:function(){var r=this.getScroller();if(!r){this.insertScroller()}return this},removeScroller:function(){var r=this.getScroller();if(r){var s=r.elements.content.getChildren();this.container.setContent(s);this.removeControl(n+this.cid);delete r.elements.container}return this},alert:function(r,s){require(["DS/UWPClientControls/PlatformNotify"],function(t){switch(r){case"error":t.error(s);break;case"success":t.success(s);break;case"warn":t.warn(s);break;case"info":t.info(s);break;default:throw new Error("Invalid alert options"+r+"does not exist")}})},removeForFutureReinsertion:l.removeForFutureReinsertion,destroy:function(){if(this._destroyed!==true){var s,r,t=this._controls,u=this._childViews;this._destroyed=true;for(s in t){if(t.hasOwnProperty(s)){if(t[s].container||t[s].elements&&t[s].elements.container){t[s].destroy()}delete t[s]}}for(s in u){if(u.hasOwnProperty(s)){u[s].destroy()}}this.dispatchEvent("onDestroy",[this]);this.stopReactingTo();this.stopListening();this._parentView=null;this._widget=null;this._skeleton=null;this._renderTo=null;this._managedListeners=null;this._lastRefreshOptions=null;this._rendered=false;r=this._parent();this.container=null;this.tagName=null;this.className=null;this.attributes=null;this.domEvents=null;return r}},isDestroyed:function(){return this._destroyed}});var j=i.extend({name:"dummy-view"});return i});define("DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model",["DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/collection/user-collection","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model"],function(a,d,b){var c=b.extend({_modelName:"dm",_cacheKey:"dm",_attributesMapping:{external_id:"mid"},_associations:{users:{Class:d,options:{mode:"listmembers",limit:20}}},_services:{read:{url:"api/favorites/directmessages",method:"GET",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},update:{url:"api/favorites/directmessages",wrapData:false,dataType:"json",method:"PATCH",dataFn:function(e){return{external_id:e.external_id,position:e.position}}},remove:{url:"api/favorites/directmessages",method:"DELETE",dataType:"json",wrapData:false,dataFn:function(e){return{external_id:e.external_id}}}},remove:function(e){return this.action("remove",e)},get:function(e,f){f={escapeHTML:false};return this._parent.apply(this,[e,f])}});return c});define("DS/SwymUICore/script/feature/core/history/history-model",["UWA/Core","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/context/context-model","DS/WebappsUtils/Console"],function(d,j,h,c){function i(){return(window.ds&&window.ds.env==="3DSwym")}var e=window.history,a=null,f=null,k=null,g=null,b=j.singleton({getStateListing:function(){return(f)?d.clone(f.stateObject):null},getState:function(){if(i()){return e.state}else{return(a)?d.clone(a.stateObject):null}},pushState:function(p,q,n,o){var m,l=o.isPreviousPathAListing();if(p&&p.previousContext){m=d.clone(p);if(i()){e.pushState(m,q,n)}else{a={stateObject:m,title:q,url:n}}if(!g&&n.match("#search:")){g=d.clone(p.previousContext)}if(l){k=d.clone(f);f={stateObject:m,title:q,url:n}}this.dispatchEvent("onHistoryStateChange",[m,q,n],true)}else{throw new Error("A state object needs to be provided and should contain a previousContext")}},backToListing:function(){require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model"],function(n,l){var o,m;if(f){o=f&&f.stateObject&&f.stateObject.previousContext;m=l.getInstance();if(m.path!==o.path){m.reset(o,{})}else{n.goToUrl(n.HOME)}}else{n.goToUrl(n.HOME)}})},back:function(){var l=this;require(["DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/feature/core/context/context-model"],function(q,n){var r,p,m,o=n.getInstance();if(i()){m=b.getState();if(m&&m.previousContext){e.back()}else{q.goToUrl(q.HOME)}}else{if(a){r=a&&a.stateObject&&a.stateObject.previousContext;p=k&&k.stateObject&&k.stateObject.previousContext;if(!r.path){r.path="home"}if(r.contentId&&o.contentId&&o.contentId!==r.contentId){p=f&&f.stateObject&&f.stateObject.previousContext}o.reset(r,{previousAttributes:p})}else{q.goToUrl(q.HOME)}}})},getContextBeforeSearch:function(){return g},goToContextBeforeSearch:function(){require(["DS/SwymUICore/script/feature/core/context/context-model"],function(l){l.getInstance().reset(g,{});g=null})}});return b});define("DS/SwymUICore/script/feature/community/instant-comment/model/instant-comment-model",["UWA/Core","UWA/String","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","DS/SocialToolbar/Models/Subject","DS/SocialToolbar/Utils/SocialToolbarSharedOptions","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(j,e,l,b,f,m,k,o,n,h,c,i,a,d){var g=l.extend({_modelName:"instant-comment",_attributesMapping:{id:"mid",richMessage:"content",parentCommentUri:"parent_uri"},_associations:{community:{}},_customProperties:{subject:null,sharedOptions:null,commentModel:null},getCommunity:function(){return this.community},init:function(t,s){var q,v=this._parent.apply(this,arguments);if(!this.getCommentModel()){q=s&&s.commentInstance;if(!q&&t&&t.community){this.community=t.community.community_type==="dm"?new f({community_id:t.community.mid}):new b({community_id:t.community.mid});var p={richMessage:t.richMessage,parentCommentUri:t.parentCommentUri,commentUri:t.model_uri,author:t.author};var u=this._getSubject(t.subject6wuri).getComments(),r=u.model;q=new r(p,{subject:this._getSubject(t.subject6wuri)});q.collection=u}if(q){this.setCommentModel(q)}}return v},setCommentModel:function(p){if(p){var q=this.getCommentModel();if(q){return q}this._customProperties.commentModel=p;this.listenTo(p,{"onChange:accessState":function(){if(p.get("accessState")===p.ACCESS_STATE.DELETED){this.dispatchEvent("onStateChange",["DELETED_STATE"])}}})}},getCommentModel:function(){return this._customProperties.commentModel},_getSubject:function(p){if(!this._customProperties.subject){var r=m.getInstance(),q=r.get("user");this._customProperties.sharedOptions=new i({"3DSwymUrl":k.getBaseUrl(),"3DSwymServerToken":r.getCSRFToken(),tenantId:r.get("config").tenant.online_instance_id,userLogin:q.login,userName:(q.first_name+" "+q.last_name),serviceUrl:r.get("3dcommentUrl")||k.getBaseUrl()});this._customProperties.subject=new c({subjectUri:p},{sharedOptions:this._customProperties.sharedOptions})}return this._customProperties.subject},save:function(q,p){this.community=q.isDMContext?new f({community_id:q.community_id}):new b({community_id:q.community_id});this._saveOperations(q,p)},_saveOperations:function(q,y){var u=this,p=m.getInstance(),r=p.get("user"),t,w=this._getSubject(q.subject6wuri),v,x,s={author:{login:r.login,displayName:r.first_name+" "+r.last_name},parentCommentUri:q.parentCommentUri,richMessage:q.content,taggingActions6w:q.taggingActions6w,subject_model:q.subject_model,model:"comment",model_content:q.content,subject_id:q.subject_id};t=w.getComments();x=t.create(s,{subject:w,onComplete:function(z){u.set("mid",z.get("commentUri"));u.set("subject6wuri",z.get("commentUri"));x.set(z.toJSON());h.populate(u,{areModelDataFromServer:true});h.notify("onPublishing",[u]);if(typeof(y.onComplete)==="function"){y.onComplete()}},onFailure:function(){y.onFailure();console.log("call has failed")}});x.collection=t;u.setCommentModel(x);u.parentMessageUUID=q.parentMessageUUID;u.set(s);u.set(q);h.notify("onPrePublishing",[u])},defaults:{},set:function(r,t,q){var p,s;if(!r){return this}p=this.applyAttributesMapping(r,t);if(p.hasOwnProperty("commentUri")){if(!p.mid){s=p.commentUri.split(":");p.mid=s[s.length-1]}p.subject6wuri=p.commentUri}return this._parent.call(this,p,q)}});return g});define("DS/SwymUICore/script/feature/community/wiki/collection/wiki-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/lib/6wpanel/utils"],function(d,c,e,b){var a=c.extend({_collectionName:"wiki-collection",_services:{read:{community:{url:"api/exalead/whatsnew",dataFn:function(f){return d.merge({query:"type:"+this.exaleadContentType,legacyFormat:false,community_id:this.communityId,with_synthesis:false},f||{})},parse:b.parseSearchResult}},filter:{community:{url:"api/exalead/whatsnew",dataFn:function(f){return d.merge({legacyFormat:false,community_id:this.communityId,refineUsingQuery:"type:"+this.exaleadContentType,with_synthesis:true},f||{})},tagsWithoutSubjectURI:true},communityLastUpdatedWiki:{url:"api/exalead/search",dataFn:function(f){return d.extend(f||{},{query:"#all",contentType:this.exaleadContentType,limit:this._limit,legacyFormat:false,order_field:"update",order_by:"desc",refineUsingQuery:'community_id:"'+this.communityId+'"'})}}}},model:e,modes:["community","communityLastUpdatedWiki"],exaleadContentType:"wikitree",setup:function(g,f){if(f.communityId){this.communityId=f.communityId}}});return a});define("DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/feature/community/iquestion/model/iq-answer-model","DS/WebappsUtils/Console"],function(h,e,b,i,c){var f=i.DateField,j=i.VoteField;var a=function(k){if(k&&k.moderation_status&&((k.moderation_status==="deleted")||(k.moderation_status==="deleted_by_author"))){return false}else{return true}},g=function(k){if(k&&k.id){delete k.id}if(h.is(k,"array")){k=k.filter(a)}return k},d=e.extend({_services:{read:{"iq-answers":{url:"api/IquestionsAnswer/list",dataFn:function(k){return{iQuestions_id:this.getIquestionId(),limit:k.limit||"1000",orderBy:this.sortAttribute,page:1}},parse:g},"iq-answers-validated":{url:"api/IquestionsAnswer/list",dataFn:function(k){return{iQuestions_id:this.getIquestionIdForValidAnswers(),limit:k.limit||"1000",orderBy:this.sortAttribute,page:1,validate:1}},parse:g}}},_associations:{answeredFor:{}},_communityId:null,_iquestionId:null,mode:null,modes:["iq-answers-validated","iq-answers"],model:i,sortAttribute:f,setup:function(l,k){if(k.communityId){this._communityId=k.communityId}if(k.iquestionId){this._iquestionId=k.iquestionId}},_addAssociationFromCollectionToModels:function(p,q){var o,n,m,q=q||this._models,k=q?q.length:0;if(m=this.getAssociated(p)){for(o=0;o<k;o++){n=q[o];n.setAssociated(p,m)}}},_updateAnswerCounter:function(){var k;if(k=this.getAssociated("answeredFor")){k.set("nb_answers",this.length)}},"onSetAssociated:answeredFor":function(k){if(this===k){this._addAssociationFromCollectionToModels("answeredFor")}},onAdd:function(k){this._addAssociationFromCollectionToModels("answeredFor",[k])},getIquestionId:function(){return this.getAssociated("answeredFor").get("mid")},getIquestionIdForValidAnswers:function(){return this.getAssociated("answeredFor").get("mid")},getCommunityId:function(){return this._communityId},setCommunityId:function(k){this._communityId=k},getSortAttribute:function(){return this.sortAttribute},setSortAttribute:function(k){if((k===j)||(k===f)){this.sortAttribute=k;return true}else{return false}},comparator:function(k){if(this.sortAttribute===j){return -(k.get(j))}else{return k.get(f)}},addAnswer:function(l){try{var k=this;if(l instanceof i){l.save({},{onComplete:function(p){var n,o,r;if((n=k.getAssociated("answeredFor"))&&(o=n.get("author"))&&(r=o.mid)){p.set("target_user",r)}var q=n.get("answers")||[];q.push(p.toJSON());n.set("answers",q)}})}else{throw {name:"Incorrect answer type",message:"The answer you are trying to add is not an IQuestion."}}}catch(m){c.error("Error adding new answer to collection: "+m.message)}},"onSync:positiveRate":function(){this.sort()},"onSync:negativeRate":function(){this.sort()}});return d});define("DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/iquestion/collection/iq-answer-collection","DS/SwymUICore/script/feature/core/user/collection/commenters-collection","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/media/collection/media-collection","DS/WebappsUtils/Console"],function(f,g,k,h,i,j,c,b){var a=function(l){if(l&&l.moderation_status&&((l.moderation_status==="deleted")||(l.moderation_status==="deleted_by_author"))){return false}else{return true}},e=function(l){var m={};if(l&&l.id){delete l.id}if(f.is(l,"array")){l=l.filter(a);if(l[0]&&(parseInt(l[0].validate,10)===1)){m.validatedAnswers=[l.shift()]}m.answers=l}return m},d=g.extend({_modelName:"iquestion",_tableName:"QnaQuestion",_attributesMapping:{qna_id:"mid",model_id:"mid",question:"content",qna_crdate:"crdate",qna_update:"update",count_answer:"nb_answers",qna_answer_count:"nb_answers",validate_lists:"validatedAnswers",validatedAnswers:"validatedAnswers",answers:"answers"},_associations:{thumbnail:{Class:j},validatedAnswers:{Class:h,oppositeRole:"answeredFor",options:{mode:"iq-answers-validated"}},answers:{Class:h,oppositeRole:"answeredFor",options:{mode:"iq-answers"}},commenters:{Class:i,oppositeRole:"commented",options:{mode:"comment"}},whoanswered:{Class:i,oppositeRole:"commented",options:{mode:"answer"}},embeddedMedia:{Class:c,sourceAttribute:"thumbnails_infos",options:{limit:2,mode:"communityMedia"}}},_services:{create:{url:"api/IquestionsQuestions/add",paramsMapping:{content:"question"},dataFn:function(l){l=l||{};l.withThumbnailsInfo=true;return l}},read:{url:"api/IquestionsQuestions/getquestioninfos",dataFn:function(){return{iQuestions_id:this.get("mid"),withThumbnailsInfo:true}},parse:function(l){if(l&&l.qna_id){l.id=l.qna_id}return l}},fetchAllAnswers:{url:"api/IquestionsAnswer/list",dataFn:function(l){return{iQuestions_id:this.get("mid"),limit:l.limit||"1000",page:1,returnAll:true,orderBy:"rate",detailedInfos:false}},parse:e},fetchAllDetailedAnswers:{url:"api/IquestionsAnswer/list",dataFn:function(l){return{iQuestions_id:this.get("mid"),limit:l.limit||"1000",page:1,orderBy:"rate",returnAll:true}},parse:e},update:{url:"api/IquestionsQuestions/update",paramsMapping:{mid:"qna_id",content:"question"},dataFn:function(l){l=l||{};l.withThumbnailsInfo=true;return l}},"delete":{url:"api/community/deletecontribution",dataFn:function(){return{iquestionIds:[this.get("mid")],community_id:this.get("community->mid")||this.get("community").mid||this.get("community").id}}}},defaults:{nb_answers:0,categories:null,mainCategorie:null,question:"",relatedDocuments:null,title:""},"onSetAssociated:answers":function(m,n,l){if(n){this.stopListening(n,"onAdd");this.stopListening(n,"commentCreated")}this.listenTo(l,"onAdd",function(){this.set("nb_answers",(this.getAnswerCollection().length+this.getValidatedAnswerCollection().length))});this.listenTo(l,"commentCreated",function(){this.set("nb_comments",parseInt(this.get("nb_comments"),10)+1)})},"onSetAssociated:validatedAnswers":function(m,n,l){if(n){this.stopListening(n,"commentCreated")}this.listenTo(l,"commentCreated",function(){this.set("nb_comments",parseInt(this.get("nb_comments"),10)+1)})},init:function(){var l=this._parent.apply(this,arguments);if(this._customProperties){this.addEventOnce("onRequest:fetchAllAnswers",function(){this._customProperties.answersBeingFetched=true});this.addEventOnce("onSync:fetchAllAnswers",function(){this._customProperties.answersFetched=true;this._customProperties.answersBeingFetched=false});this.addEventOnce("onRequest:fetchAllDetailedAnswers",function(){this._customProperties.detailedAnswersBeingFetched=true});this.addEventOnce("onSync:fetchAllDetailedAnswers",function(){this._customProperties.detailedAnswersFetched=true;this._customProperties.detailedAnswersBeingFetched=false})}return l},haveAnswersBeenFetched:function(){return(this._customProperties.answersFetched===true)},areAnswersBeingFetched:function(){return(this._customProperties.answersBeingFetched===true)},haveDetailedAnswersBeenFetched:function(){return(this._customProperties.detailedAnswersFetched===true)},areDetailedAnswersBeingFetched:function(){return(this._customProperties.detailedAnswersBeingFetched===true)},setup:function(){this._fetchStatus={modelFetchStatus:k.STATUS.notRequested,validatedAnswersFetchStatus:k.STATUS.notRequested,answersFetchStatus:k.STATUS.notRequested}},getCommenters:function(){return this.getAssociated("commenters")},getWhoAnswered:function(){return this.getAssociated("whoanswered")},getAnswerCollection:function(){return this.getAssociated("answers")},getValidatedAnswerCollection:function(){return this.getAssociated("validatedAnswers")},fetchAllAnswers:function(l){return this.action("fetchAllAnswers",l)},fetchAllDetailedAnswers:function(l){return this.action("fetchAllDetailedAnswers",l)},overrideFetchOptions:function(m,l){var n=this,o=f.merge({},m);this._fetchStatus[l]=k.STATUS.pending;o.onComplete=function(){var p=null;n._fetchStatus[l]=k.STATUS.valid;if(m&&f.typeOf(m.onComplete)==="function"){p=m.onComplete.apply(this,arguments)}return p};o.onFailure=function(){var p=null;n._fetchStatus[l]=k.STATUS.invalid;if(m&&f.typeOf(m.onFailure)==="function"){p=m.onFailure.apply(this,arguments)}return p};return o},overrideAnswerFetchOptions:function(m){var o=f.merge({},m),l=this.getValidatedAnswerCollection(),n=this;o.onComplete=function(){var p=null;if(l&&l.length>0){n.set("nb_validate",1)}else{n.set("nb_validate",0)}if(m&&f.typeOf(m.onComplete)==="function"){p=m.onComplete.apply(this,arguments)}return p};return o},fetch:function(l){var m=this.overrideFetchOptions(l,"modelFetchStatus");return this._parent.apply(this,[m])},fetchAnswers:function(l){if(!this.isNew()){var m=this.overrideFetchOptions(l,"answersFetchStatus");this.getAnswerCollection().fetch(m)}},fetchValidatedAnswers:function(m){var l=this.getValidatedAnswerCollection();if(!this.isNew()){var o=this.overrideFetchOptions(m,"validatedAnswersFetchStatus");var n=this.overrideAnswerFetchOptions(o);l.setSortAttribute("rate");l.fetch(n)}},isValidated:function(){var l=this.get("nb_validate");if(l===undefined){return l}else{return l===1?true:false}},addAnswer:function(l){try{this.getAnswerCollection().addAnswer(l)}catch(m){b.error("Error adding new answer to collection: "+m.message);return}},deleteContribution:function(l){return this.destroy(l)},getRssLink:function(l){if(!l){l=10}return"/rss/filter/feed/model/iquestion/limit/"+l+"/community_id/"+this.getCommunity().get("mid")+"/model_id/"+this.get("mid")},"onChange:validate_lists":function(){var l=this.get("validate_lists");if(l&&l.length){this.getValidatedAnswerCollection().add(l[0])}}});return d});define("DS/SwymUICore/script/feature/core/auto-save/auto-save-manager",["UWA/Core","UWA/Class","DS/SwymUICore/script/feature/core/context/context-model","DS/SwymUICore/script/feature/core/auto-save/model/auto-save-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/utils/navigation","DS/SwymUICore/script/lib/pub-sub","DS/SwymUICore/script/feature/core/user/model/currentuser-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/utils/usage-tracker","i18n!DS/SwymUICore/assets/nls/feature/core/auto-save/auto-save-manager"],function(a,p,k,o,e,n,f,b,r,l,h,c,d,i,m,g){var j,q=c.extend({_wasOnHomePage:false,_wasOnCommunityHomePage:false,_askForRestoration:false,_isReady:false,hasBeenRestored:false,setup:function(){},ignore:function(){o.deleteInstance();m.trackPageEvent({category:"AutoSave",label:"contentDestroyed",view:"auto-save-manager",event:"click"})},restoreContent:function(){var u=k.getInstance(),t=o.getInstance(),s;this._askForRestoration=true;this._wasOnHomePage=u.isHomePageContext()?true:false;this._wasOnCommunityHomePage=u.isCommunityHomePageContext()?true:false;m.trackPageEvent({category:"AutoSave",label:"contentRestored",view:"auto-save-manager",event:"click"});s=t.get("community_id")?new i({mid:t.get("community_id")}):null;if(s){s.fetch({onComplete:function(v){this._performNavigation(v)}.bind(this)})}else{this._performNavigation()}},_performNavigation:function(s){var v=k.getInstance(),u=o.getInstance(),t=v.isContentEditionContext();if(u.get("content_id")&&u.get("community_id")){if(t&&u.get("content_id")===v.contentId){this.dispatchEvent("onContentRecoveryRequest")}else{v.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,false,-1);h.goToContent(u.get("content_id"),u.get("content_type"),u.get("community_id"),true)}}else{if(v.communityId===u.get("community_id")&&v.isCommunityHomePageContext()){this.dispatchEvent("onContentRecoveryRequest")}else{if(s&&s.get("community_type")==="dm"){v.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,false,-1);h.goToDM(u.get("community_id"))}else{if(v.isHomePageContext()){this.dispatchEvent("onContentRecoveryRequest")}else{v.addOnce("onContextChange",function(){this.dispatchEvent("onContentRecoveryRequest")},this,false,-1);h.goToUrl(h.HOME)}}}}},getAutoSaveModel:function(){if(this._askForRestoration){var x=k.getInstance(),s=o.getInstance(),w=s.get("content_type"),t,v,z,y={post:n,iquestion:f,idea:r,survey:b,wiki:l};v={content:s.get("content_message"),title:s.get("content_title"),community_id:s.get("community_id")};if(s.get("content_message")){var u=s.get("content_message").match(/<img.*?>/g);if(u){require(["DS/UWPClientControls/PlatformNotify"],function(A){A.warn(g.replace(g.YouHadMediaNotRecovered,{number:u.length}))})}}if(w==="survey"){z={options:s.get("content_options"),endDate:s.get("content_options").endDate,startDate:s.get("content_options").startDate,endHour:s.get("content_options").endHour,startHour:s.get("content_options").startHour,showResultsAfterVote:s.get("content_options").showResultsAfterVote};a.extend(v,z)}if(w==="wiki"){z={options:s.get("content_options"),revision_description:s.get("content_options").revision_description,locked:s.get("content_options").locked};a.extend(v,z)}if(s.get("content_id")){t=new y[w]({id:s.get("content_id")});t.addChanges(v)}else{t=y.hasOwnProperty(w)&&new y[w](v)}return t}},isAvailable:function(u){var t=this,s=o.getInstance();if(this._isReady){if(!s.isNew()&&(!a.is(window.widget)||(a.is(window.widget)&&window.widget.getAppName()===e.getMyCommunitiesAppKey()))){u(true)}else{u(false)}}else{this.addEventOnce("onAutoSaveModelIsReady",this.isAvailable.bind(this,u))}},init:function(){var s=this;this._parent.apply(this,arguments);d.getInstanceFetched(function(t){var v=t.get("autosaved_content"),u=o.getInstance();if(v){u.set("id",v.autosave_id);u.set("community_id",v.community_id);u.set("content_id",v.content_id);u.set("content_message",v.content_message);u.set("content_options",JSON.parse(v.content_options));u.set("content_title",v.content_title);u.set("content_type",v.content_type);u.set("autosave_id",v.autosave_id);u.set("autosave_date",v.autosave_date)}s._isReady=true;s.dispatchEvent("onAutoSaveModelIsReady")});return this}});return{getInstance:function(){if(!j){j=new q()}return j}}});define("DS/SwymUICore/script/feature/core/favorite/collection/favorite-dm-collection",["DS/SwymUICore/script/lib/collection/generic/swym-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-dm-model"],function(c,b){var a=c.extend({_asAdmin:false,_collectionName:"favorite-dm-collection",_services:{read:{"my-favorites-dm":{url:"api/favorites/directmessages",method:"GET",dataFn:function(d){return{page:d.page,limit:d.limit}}}}},model:b,modes:["my-favorites-dm"]});return a});define("DS/SwymUICore/script/lib/collection/mixed-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/lib/6wpanel/utils"],function(a,c,g,n,q,b,m,h,p,e,d,k){function j(w,z){var v=w.length;z=(z>v)?v:z;var u=new Array(z),y=new Array(v);while(z--){var t=Math.floor(Math.random()*v);u[z]=w[t in y?y[t]:t];y[t]=--v}return u}var r=function(t){if(a.is(t,"object")&&a.is(t.result,"array")){t.result.forEach(function(u){if(typeof u.author==="object"){a.merge(u,u.author);if(!u.nickname&&u.first_name&&u.last_name){u.nickname=u.first_name+" "+u.last_name}}})}},i=function(t){var v,u,w;for(v=0,u=t.length;v<u;v++){w=t[v];switch(w.ds6w_58_type.split(":").pop()||w.source){case"Posts":w.type="post";break;case"Wikitree":w.type="wiki";break;default:break}}return t},f={post:"post",posts:"post",communitypost:"post",iquestion:"iquestion",question:"iquestion",iquestions:"iquestion",qnaquestion:"iquestion",wiki:"wiki",dsi_dfstree_wikitree:"wiki",wikitree:"wiki",idea:"idea",ideation:"idea",dsi_ideation_ideation:"idea",media:"media",community:"community",user:"user",survey:"survey","quick survey":"survey"},l=function(u){var t=null;if(u.type){u.model=u.type}u.model=u.model||u.source;if(u.model){t=u.model.toLowerCase();if(f.hasOwnProperty(t)){t=f[t];switch(t){case"post":t=n;break;case"iquestion":t=g;break;case"idea":t=q;break;case"media":t=b;break;case"community":t=h;break;case"wiki":t=m;break;case"user":t=e;break;case"survey":t=d;break;default:throw new Error("No class found for model:"+t)}return t}throw {name:"Invalid model",message:"There is no class attached to the model specified"}}throw {name:"No model provided",message:"An attribute model should be present in each item of the result returned from the server"}},o=function(u,t){return new (l(u))(u,t)},s=c.extend({_collectionName:"mixed-collection",_services:{read:{"whats-new":{url:"api/feed/whatsnew",dataFn:function(t){return a.extend({page:this._currentPage,limit:this._limit,community_id:this.communityId,hash_key:this.hash_key},t||{})},postProcess:r},community:{url:"api/feed/whatsnew",dataFn:function(u){var t=a.extend({page:this._currentPage,limit:this._limit,community_id:this.communityId},u||{});return t},postProcess:r},mycontributions:{url:"api/community/listcontribution",dataFn:function(t){t=t||{};return a.extend({start:(this._currentPage-1)*this._limit,limit:this._limit,id:this.communityId,hash_key:this.hash_key},t||{})},parse:function(w){var u,t,v;if(Array.isArray(w)){u=0;t=w.length;for(u=0;u<t;u++){v=w[u];v.id=v.contribution_id;v.update=v.time;v.summary=v.description}}return w}},search:{url:"api/exalead/search/",paramsMapping:{limit:"nresults"},dataFn:function(t){return a.extend(t||{},{legacyFormat:k.requestLegacyFormatForExaleadSearches(),query:this.exaleadQuery,contentType:this.exaleadContentType,refineUsingQuery:this.refineUsingQuery})},parse:function(){var t=this._defaultParsingFn.apply(this,arguments);return i.call(this,t)}},customlist:{url:"api/exalead/search/",paramsMapping:{limit:"nresults"},dataFn:function(t){return a.extend({legacyFormat:k.requestLegacyFormatForExaleadSearches(),query:this.exaleadQuery,contentType:this.exaleadContentType,refineUsingQuery:this.refineUsingQuery},t||{})},parse:function(u,v){var x,w,t=this._defaultParsingFn.apply(this,arguments);if((w=v.additionalParsingFunction)&&(typeof w==="function")){x=w(i.call(this,t))}else{x=i.call(this,t)}return x}},recentpublications:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(t){return t||{}},parse:function(){var t=j(this._defaultParsingFn.apply(this,arguments),5);return i.call(this,t)}}},filter:{"whats-new":{url:"api/exalead/whatsnew",tagsWithoutSubjectURI:true},community:{url:"api/exalead/whatsnew",dataFn:function(t){return a.extend(t||{},{community_id:this.communityId})},tagsWithoutSubjectURI:true},search:{url:"api/exalead/search",tagsWithoutSubjectURI:true,dataFn:function(t){return a.extend(t||{},{refineUsingQuery:this.refineUsingQuery})},parse:function(){var t=this._defaultParsingFn.apply(this,arguments);return i.call(this,t)}},customlist:{url:"api/exalead/search",tagsWithoutSubjectURI:true,dataFn:function(t){return a.extend({refineUsingQuery:this.refineUsingQuery},t||{})},parse:function(){var t=this._defaultParsingFn.apply(this,arguments);return i.call(this,t)}},recentpublications:{url:"api/exalead/whatsnew",paramsMapping:{limit:"nresults",startFrom:"start"},dataFn:function(t){return t||{}},parse:function(){var t=this._defaultParsingFn.apply(this,arguments);return i.call(this,t)}}}},hash_key:null,communityId:null,refineUsingQuery:null,model:o,mode:null,modes:["whats-new","mycontributions","community","search","customlist","recentpublications","bookmarks"],init:function(u,t){if(t){if(t.model){delete t.model;throw {name:"Model provided",message:"No model should be provided for a mixed collection"}}if(t.communityId){this.communityId=t.communityId}if(t.hash_key){this.hash_key=t.hash_key}if(t.refineUsingQuery){this.refineUsingQuery=t.refineUsingQuery}}this._parent(u,t);if((this.mode==="whats-new"||this.mode==="community")&&!t.paginationMode){this.paginationMode="PREV_NEXT"}if(t.removeMediaIfNotHighSemanticAnymore===true){this.addEvent("onChange:is_illustration",function(v){if(a.is(v.getModelName,"function")&&v.getModelName()==="media"){if(v.get("is_illustration")===true||v.get("is_illustration")==="1"){this.remove(v)}}})}return this},parse:function(A,x){var w,u,z,v=this._parent(A,x);if(a.is(v,"array")){u=[];for(var y=0,t=v.length;y<t;y++){z=v[y];if(z instanceof p){u.push(z)}else{w=l(z);u.push(w.prototype.applyAttributesMapping(z))}}}else{u=v}return u}});o.prototype.idAttribute="id";return s});define("DS/SwymUICore/script/lib/view/generic/swym-model-view",["UWA/Core","UWA/Class","UWA/Object","DS/SwymUICore/script/lib/view/generic/swym-view","DS/SwymUICore/script/lib/model/generic/swym-model","DS/WebappsUtils/Console"],function(g,d,c,e,a,b){b.log("DS/SwymUICore/script/lib/view/generic/swym-model-view");var f=e.extend({_modelEvents:null,_modelClass:null,model:null,name:null,_checkModel:function(h,i){return this._checkInstance(h,i||this._modelClass)},init:function(h){if(h instanceof a){h={model:h}}else{if(!h){h={}}}if(!this._modelEvents){this._modelEvents={}}if(!this._modelEventsForAutoRefresh){this._modelEventsForAutoRefresh=[]}return this._parent.call(this,h)},addModelEventsForAutoRefresh:function(h){if(h){if(g.is(h,"array")===true){var i=[].concat(h);i.forEach(function(l,k,j){if(this._modelEventsForAutoRefresh.indexOf(l)>=0){j.splice(k,1)}},this);this._modelEventsForAutoRefresh=this._modelEventsForAutoRefresh.concat(h)}else{if(g.is(h,"string")===true&&(this._modelEventsForAutoRefresh.indexOf(h)<0)){this._modelEventsForAutoRefresh.push(h)}}this.reactTo(this.model,h,"refresh")}return this},reactToModelEvents:function(i){var j;if(i){for(var h in i){if(i.hasOwnProperty(h)){j=i[h];if(typeof j==="string"&&typeof this[j]==="function"){j=this[j]}if(typeof j!=="function"){b.error("Specified listener is not valid");break}this.reactTo(this.model,h,j)}}}},setModel:function(i,h){var j,n;if(g.is(h,"object")){j=g.extend({},h)}else{j={}}if(j._initializing&&this.model){if(!i){i=this.model}this.model=null}var m,o=j.roleToTrack,l=this._modelEvents,k=j.refresh!==false;if(j.checkModel!==false){i=this._checkModel(i)}if(this.model){if(this.model.equals(i)===true){return this}else{this.stopReactingTo(this.model)}}else{if(!(i instanceof a)){throw new Error("Provided model is invalid!")}}n=this.model;this.model=i;this.reactTo(this.model,this._modelEventsForAutoRefresh,"refresh");if(o&&o.name&&o.associated){this.reactTo(this.model,"onReplace:"+o.name,function(r,p,q){if(this.model.equals(r)&&q.equals(o.associated)){this.setModel(p)}})}this.reactToModelEvents(l);this.dispatchEvent("onSetModel",[this,n,this.model]);if((k!==false)&&this._rendered){this.refresh()}return this},setup:function(h){this._parent.apply(this,arguments);if(!h){h={}}if(h.hasOwnProperty("modelEvents")){this._modelEvents=h.modelEvents}if(h.hasOwnProperty("modelEventsForAutoRefresh")){this._modelEventsForAutoRefresh=h.modelEventsForAutoRefresh}else{this._modelEventsForAutoRefresh=g.clone(this._modelEventsForAutoRefresh,false)}if(h.model||(this.model&&h._initializing===true)){this.setModel(h.model,{refresh:(h.hasOwnProperty("refresh")?h.refresh:!h._initializing),_initializing:h._initializing})}return this},createAttributeView:function(k,i,h){var j;if(g.is(k,"string")&&g.is(i,"string")){if(typeof h==="function"){j=f.extend({_modelClass:this._modelClass,_createContent:h})}else{if(g.is(h,"object")){j=f.extend(g.merge({_modelClass:this._modelClass},h))}else{if(h instanceof f){j=h}else{throw new Error("Error creating attribute view: Invalid arguments")}}}return this.addChildView(k,{Class:j,widget:this._widget,model:this.model}).addModelEventsForAutoRefresh("onChange:"+i)}throw new Error("Error creating attribute view: Either the view name or the name of concerned attribute is not available")},destroy:function(){this.model=null;this._modelEventsForAutoRefresh=null;this._modelEvents=null;this.refresh=null;return this._parent.apply(this,arguments)}});return f});define("DS/SwymUICore/script/feature/community/idea/model/project-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/PlatformAPI/PlatformAPI","DS/SwymUICore/script/feature/community/idea/collection/collab-space-collection"],function(h,a,c,g,f,e,b){var d=a.extend({_modelName:"project",_attributesMapping:{id:"mid"},_associations:{idea:{Class:c}},_services:{create:{},read:{parse:function(i){if(i&&i[0]&&i[0]!==""){return{deleted:false,response:i}}return{deleted:true,response:i}}}},saveObject:function(i){var j=this;b.getSpaceServerUrl(function(n){var k=j.getAssociated("idea"),o=g.getInstance().get("config").tenant,p=encodeURI(n+"/resources/FBSTeamService/ENOProjectService/createProject?SecurityContext="+i.collabSpace+"&tenant="+o.online_instance_id),m=h.clone(i.onComplete),l=h.merge({url:p,dataType:"text",proxy:"passport",method:"POST",proxifiedRequest:true,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8",Accept:"application/json, text/javascript, */*"},responseType:"json",onComplete:function(v,t){if(h.Array.isArray(t)){var q=t[0];var r=j.getAssociated("idea"),w=q.projectId,x=q.projectName,s=h.clone(r.get("_acl"));s.update.access=false;s["delete"].access=false;r.set("_acl",s);r.set("acl_status",false);var u=r.addLink({type:"enovia_"+j._modelName,content_key:w,content_title:x});m({success:true,response:q,linkModel:u})}else{m(t)}}},i);j.save({Title:k.get("title"),Content:encodeURIComponent(UWA.Utils.base64Encode(l.processedContent.getHTML()))},l)})},fetchObject:function(i){this.fetch(h.merge(i,{url:e.getApplicationConfiguration("app.urls.myapps")+"/resources/bps/physicalids?oid_list="+this.get("mid"),type:"json",proxy:"passport",proxifiedRequest:true,method:"GET"}))}});return d});define("DS/SwymUICore/script/feature/core/favorite/collection/favorite-communities-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/core/favorite/model/favorite-communities-model"],function(f,e,d){var c=function(k){var g=[],j,h={},i,l;for(i in k.hits){if(k.hits.hasOwnProperty(i)){h={};j=k.hits[i].metas;for(l in j){if(j.hasOwnProperty(l)){h[j[l].name]=j[l].value}}g.push(h)}}return g},b={},a=e.extend({_asAdmin:false,_tempCollection:null,_collectionName:"favorite-communities-collection",_services:{read:{"my-favorites-communities":{url:"api/favorites/communities",method:"GET",dataFn:function(g){return{page:g.page,limit:g.limit}}}},filter:{"my-favorites-communities":{url:"api/exalead/search",method:"POST",dataFn:function(g){return f.extend(g||{},{favorite_communities:"only",contentType:"community",with_synthesis:false})},parse:c,tagsWithoutSubjectURI:true}}},model:d,modes:["my-favorites-communities"],comparator:function(h,g){return h.get("position")>g.get("position")?1:-1}});return a});define("DS/SwymUICore/script/feature/community/timeline/model/community-content-event-model",["DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/community/iquestion/model/iquestion-model","DS/SwymUICore/script/feature/community/post/model/post-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/community/media/model/media-model","DS/SwymUICore/script/feature/community/wiki/model/wiki-model","DS/SwymUICore/script/feature/community/survey/model/survey-model","DS/SwymUICore/script/feature/community/timeline/model/event-model"],function(k,i,o,p,a,n,d,j){var f="CommunityPost",g="post",m="Dsi_Ideation_Ideation",e="idea",q="iquestion",l="QnaQuestion",b="Media",h="Dsi_DFSTree_WikiTree",c="Survey",r=j.extend({_modelName:"community-content-event",getAuthorModelAttributes:function(){return this.get("message_details->author")},getSharedContentClass:function(){var s,t=this.get("message_details->model")||this.get("message_details->contentType");switch(t){case g:case f:s=o;break;case e:case m:s=p;break;case q:case l:s=i;break;case b:s=a;break;case c:s=d;break;case h:s=n;break;default:break}return s},getSharedContentModelAttributes:function(){return this.get("message_details")},init:function(u,t){var w=t&&t.sharedContent;this._parent.apply(this,arguments);if(!w){var v=this.getSharedContentClass(),s=this.getSharedContentModelAttributes();if(v&&s){w=new v(s)}}this.setAssociated("sharedContent",w)},_associations:{sharedContent:{sourceAttribute:"message_details"}},_flagSubjectAsDeleted:function(){this.set("subject_state",j.DELETED_STATE)},getMessageTitle:function(){return this.get("message_details->title")},"onSetAssociated:sharedContent":function(u,s,t){this.listenTo(t,"onDestroy",this._flagSubjectAsDeleted);return this._parent.apply(this,arguments)}});return r});define("DS/SwymUICore/script/feature/community/idea/model/requirement-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/feature/community/idea/model/idea-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/feature/community/idea/collection/collab-space-collection"],function(g,a,c,f,e,b){var d=a.extend({_modelName:"requirement",_attributesMapping:{id:"mid"},_associations:{idea:{Class:c}},_services:{create:{},read:{parse:function(h){if(h.operation&&h.operation[0]!==null){return{deleted:false,response:h}}return{deleted:true,response:h}}}},_utf8ToB64:function(h){return btoa(encodeURIComponent(h).replace(/%([0-9A-F]{2})/g,function(i,j){return String.fromCharCode("0x"+j)}))},saveObject:function(h){var i=this;b.getSpaceServerUrl(function(m){var j=i.getAssociated("idea"),n=f.getInstance().get("config").tenant,o=encodeURI(m+"/resources/rmt/util/authoring?SecurityContext="+h.collabSpace+"&tenant="+n.online_instance_id),l=g.clone(h.onComplete),k=g.merge({url:o,type:"json",proxy:"passport",method:"POST",proxifiedRequest:true,headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},wrapData:false,onComplete:function(s){var v=false,p=s.getAttributes(),t;if(p.status&&p.status=="successful"){var q=i.getAssociated("idea"),u=p.operation[0].objects[0].physicalId||p.operation[0].objects[0].physicalid,w=p.operation[0].objects[0].TNR||p.operation[0].objects[0].tnr,r=g.clone(q.get("_acl"));r.update.access=false;r["delete"].access=false;q.set("_acl",r);q.set("acl_status",false);t=q.addLink({type:"enovia_"+i._modelName,content_key:u,content_title:w});v=true}l({success:v,response:p,linkModel:t})}},h);i.save({operation:[{markup:"createStandalone",object:[{objectParent:null,tempId:"tmpObj1",objectBasics:{type:"Requirement",id:null},objectAttribute:[{attributeName:"Content Type",attributeValue:"base64"},{attributeName:"Content Data",attributeValue:i._utf8ToB64(k.processedContent.getHTML())},{attributeName:"Title",attributeValue:j.get("title")}],relationship:null}]}]},k)})},fetchObject:function(h){var i=this;b.getSpaceServerUrl(function(j){i.fetch(g.merge(h,{url:j+"/resources/rmt/get/browsing",type:"json",headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/javascript, */*"},proxy:"passport",method:"POST",proxifiedRequest:true,wrapData:false,data:{operation:[{markup:"getAllStructure",object:[{objectId:i.get("mid")}]}]}}))})}});return d});define("DS/SwymUICore/script/feature/community/instant-message/model/instant-message-model",["UWA/Core","UWA/String","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/direct-message/model/direct-message-model","DS/SwymUICore/script/feature/core/config/bootstrap-model","DS/SwymUICore/script/utils/utils","DS/SwymUICore/script/lib/model/generic/swym-model","DS/SwymUICore/script/lib/request/data","DS/SwymUICore/script/lib/model/model-manager","DS/SwymUICore/script/feature/core/command/commands-controller","DS/SocialToolbar/Models/Subject","DS/SocialToolbar/Utils/SocialToolbarSharedOptions","DS/SwymUICore/script/utils/navigation","DS/WebappsUtils/Console"],function(k,e,m,b,g,n,l,p,o,i,f,c,j,a,d){var h=m.extend({_modelName:"instant-message",_attributesMapping:{id:"mid",content:"richMessage"},HTML_ATTRIBUTES:["content","richMessage"],_associations:{community:{}},_customProperties:{subject:null,sharedOptions:null,commentModel:null},getCommunity:function(){return this.community},init:function(u,t){var r,w=this._parent.apply(this,arguments);if(!this.getCommentModel()){r=t&&t.commentInstance;if(!r&&u&&u.community){this.community=u.community.community_type==="dm"?new g({community_id:u.community.mid}):new b({community_id:u.community.mid});var q={richMessage:u.richMessage,commentUri:u.subject6wuri,author:u.author};var v=this._getSubject(this.community.get("subject6wuri")).getComments(),s=v.model;r=new s(q,{subject:this._getSubject(this.community.get("subject6wuri"))});r.collection=v}if(r){this.setCommentModel(r)}}return w},setCommentModel:function(q){if(q){var r=this.getCommentModel();if(r){return r}this._customProperties.commentModel=q;this.listenTo(q,{"onChange:accessState":function(){if(q.get("accessState")===q.ACCESS_STATE.DELETED){this.dispatchEvent("onStateChange",["DELETED_STATE"])}}})}},getCommentModel:function(){return this._customProperties.commentModel},_getSubject:function(q){if(!this._customProperties.subject){var s=n.getInstance(),r=s.get("user");this._customProperties.sharedOptions=new j({"3DSwymUrl":l.getBaseUrl(),"3DSwymServerToken":s.getCSRFToken(),tenantId:s.get("config").tenant.online_instance_id,userLogin:r.login,userName:(r.first_name+" "+r.last_name),serviceUrl:s.get("3dcommentUrl")||l.getBaseUrl()});this._customProperties.subject=new c({subjectUri:q},{sharedOptions:this._customProperties.sharedOptions})}return this._customProperties.subject},getRelativePath:function(q,s,r){if(!q){q=this.get("community->mid");if(!q&&this.get("community")){q=this.get("community").mid||this.get("community").id}}if(!s){s=this.get("mid")}if(typeof r!=="string"){r="/message:"}return a.URLPART_COMMUNITY+q+r+s},save:function(r,q){this.community=r.isDMContext?new g({community_id:r.community_id}):new b({community_id:r.community_id});if(e.unescapeHTML(r.content).indexOf("/")===0&&!r.isDMContext){f._getCommandFromHtmlStringIfExist(r.content,function(s){if(s){var t=this.community.getAssociated("bots");t._communityId=r.community_id;if(t.hasBeenFetched()){this._checkBotActivationInCommunity(t,s,r,q)}else{t.goToPage(1,{onComplete:function(u){this._checkBotActivationInCommunity(t,s,r,q)}.bind(this),onFailure:function(){console.error("Call to retrieve bots has failed")}})}}else{this._saveOperations(r,q)}}.bind(this))}else{if(e.unescapeHTML(r.content)){this._saveOperations(r,q)}}},_buildUrl:function(){return"api/community/"+this.community.get("mid")+"/instantmessages"},_checkBotActivationInCommunity:function(r,s,u,q){var t=r.findWhere({"details->uri":s.botUsername});if(t){u.channel_name=this.community.get("title")||"";u.community_id=this.community.get("subject6wuri");f.executePrimaryCommandIfInputMatched(u)}else{this._saveOperations(u,q)}},_saveOperations:function(r,y){var v=this,q=n.getInstance(),s=q.get("user"),u,w,x=this.getCommentModel(),t={author:{login:s.login,displayName:s.first_name+" "+s.last_name},accessState:null,commentUri:null,comments:null,endorsements:null,moderationState:null,parentCommentUri:null,richMessage:r.content,taggingActions6w:r.taggingActions6w};if(r.parentMessageUri){t.parentCommentUri=r.parentMessageUri}this.action("create",{wrapData:false,data:t,url:this._buildUrl(),onComplete:function(z,A){x.set(z.toJSON());i.populate(v,{areModelDataFromServer:true});i.notify("onPublishing",[v]);if(typeof(y.onComplete)==="function"){y.onComplete()}},onFailure:function(){if(typeof(y.onFailure)==="function"){y.onFailure()}console.log("call has failed")}});x=this.getCommentModel();if(!x){u=this._getSubject(this.community.get("subject6wuri")).getComments();w=u.model;x=new w({author:{login:s.login,displayName:s.first_name+" "+s.last_name},accessState:null,commentUri:null,comments:null,endorsements:null,moderationState:null,parentCommentUri:null,richMessage:r.content,taggingActions6w:r.taggingActions6w},{subject:this._getSubject(this.community.get("subject6wuri"))});x.collection=u;v.setCommentModel(x)}v.parentMessageUUID=r.parentMessageUUID;v.set(r);i.notify("onPrePublishing",[v])},_services:{create:{method:"POST"}},defaults:{},set:function(s,u,r){var q,t;if(!s){return this}q=this.applyAttributesMapping(s,u);if(q.hasOwnProperty("commentUri")){if(!q.mid){t=q.commentUri.split(":");q.mid=t[t.length-1]}q.subject6wuri=q.commentUri}return this._parent.call(this,q,r)}});return h});define("DS/SwymUICore/script/feature/community/timeline/model/community-event-model",["UWA/Core","DS/SwymUICore/script/lib/model/generic/community-content","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/feature/core/user/model/user-model","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/community/instant-comment/model/instant-comment-model"],function(g,e,f,c,a,b){var d=a.extend({_modelName:"community-event",_attributesMapping:{"message_details->richMessage":"message_details->model_content"},HTML_ATTRIBUTES:["message_details->model_content"],init:function(i,h){var j=this._parent.apply(this,arguments);if(h&&h.instantCommentInstance){this.setInstantComment(h.instantCommentInstance)}return j},getAuthorModelAttributes:function(){return this.get("author")},_associations:{sharedContent:{},instantComment:{Class:b},community:{Class:f}},_flagSubjectAsDeleted:function(){this.set("subject_state",a.DELETED_STATE)},getMessageTitle:function(){var h=this.get("message_details->model_content",{escapeHTML:false});if(h){h=g.createElement("div",{html:h}).getText()}return h},setInstantComment:function(k){var n,o={},i,p,l=this.get("message_details->model_uri"),m=this.get("message_details->parent_uri")||this.get("message_details->model_uri")||null,h=this.get("message_details->commentable_uri"),j;if(k){n=k.get("mid");p=k.get("community");o=k.toJSON()}else{j=l?l.split(":"):[];n=j.length>0?j[j.length-1]:null;p=this.get("community");o={mid:n,parentCommentUri:m,model_uri:l,subject6wuri:h,community:p,richMessage:this.get("message_details->model_content"),author:this.get("author")}}if(!p){}i=this.hasAssociated("instantComment");if(i){i.set(k?o:g.extend(o,i.toJSON()));return i}if(!k){k=new b(o)}this.setAssociated("instantComment",k);this.listenTo(k,{onStateChange:function(q){switch(q){case"ACTIVE_STATE":case"NOT_AVAILABLE":case"DELETED_STATE":this.set("subject_state",a[q]);break;default:Logger.warn("Unknown state: ",q);break}}});if(!h){if(k.get("subject6wuri")){this.set(k.get("subject6wuri"))}else{this.listenToOnce(k,{"onChange:subject6wuri":function(){this.set(k.get("subject6wuri"))}})}}return k},getInstantComment:function(){if(!this.hasAssociated("instantComment")){this.setInstantComment()}return this.getAssociated("instantComment")},"onSetAssociated:sharedContent":function(j,h,i){this.listenTo(i,"onDestroy",this._flagSubjectAsDeleted);return this._parent.apply(this,arguments)}});return d});define("DS/SwymUICore/script/feature/community/timeline/model/im-event-model",["UWA/Core","DS/SwymUICore/script/feature/community/timeline/model/event-model","DS/SwymUICore/script/feature/community/instant-message/model/instant-message-model","DS/Logger/Logger"],function(e,b,a,c){var d=b.extend({_modelName:"im-event",HTML_ATTRIBUTES:["message_details->content"],_attributesMapping:{subject_uri:"subject6wuri"},init:function(g,f){var h=this._parent.apply(this,arguments);if(f&&f.instantMessageInstance){this.setInstantMessage(f.instantMessageInstance)}return h},_associations:{instantMessage:{Class:a}},setInstantMessage:function(l){var h,g={},i,f,k=this.get("subject6wuri")||null,j;if(l){h=l.get("mid");f=l.get("community");g=l.toJSON()}else{j=k?k.split(":"):[];h=j.length>0?j[j.length-1]:null;f=this.get("community");g={mid:h,subject6wuri:k,community:f,richMessage:this.get("message_details->content"),author:this.get("author")}}if(!f){throw new Error("Community info is required")}i=this.hasAssociated("instantMessage");if(i){i.set(g);return i}if(!l){l=new a(g)}this.setAssociated("instantMessage",l);this.listenTo(l,{onStateChange:function(m){switch(m){case"ACTIVE_STATE":case"NOT_AVAILABLE":case"DELETED_STATE":this.set("subject_state",b[m]);break;default:c.warn("Unknown state: ",m);break}}});if(!k){if(l.get("subject6wuri")){this.set(l.get("subject6wuri"))}else{this.listenToOnce(l,{"onChange:subject6wuri":function(){this.set(l.get("subject6wuri"))}})}}return l},getInstantMessage:function(){if(!this.hasAssociated("instantMessage")){this.setInstantMessage()}return this.getAssociated("instantMessage")},getAuthorModelAttributes:function(){return this.get("author")},getMessageTitle:function(){var f=this.get("message_details->richMessage",{escapeHTML:false});if(f){f=e.createElement("div",{html:f}).getText()}return f},getParentIMEvent:function(){var f=this.getAssociated("parentIMEventModel");if(!f.get("community")){f.set("community",this.get("community"))}return f},setParentIMEvent:function(f){return this.setAssociated("parentIMEventModel",f)},"onChange:community":function(f,g,h){if(!h||!h.instantMessageInstance){this.setInstantMessage()}},"onChange:subject6wuri":function(f,h,g){if(!g||!g.instantMessageInstance){if(this.get("community")){this.setInstantMessage()}}}});d.prototype._associations.parentIMEventModel={Class:d,sourceAttribute:"message_details->parent_message"};return d});define("DS/SwymUICore/script/feature/community/community/collection/community-collection",["UWA/Core","DS/SwymUICore/script/lib/collection/generic/6wfilterable-collection","DS/SwymUICore/script/feature/community/community/model/community-model","DS/SwymUICore/script/lib/model/generic/swym-model"],function(h,g,f,a){var c=null,e=function(i){return i.title.indexOf(f.DIRECT_MESSAGE_PREFIX)===0},d=function(i){return i.title.indexOf(f.DIRECT_MESSAGE_PREFIX)!==0},b=g.extend({_hashKey:null,_onlyWithStatsAccess:false,_filters:null,_collectionName:"community-collection",_updatableOptions:{listeners:["threadCreation"],add:{append:true}},_services:{getmyblacklist:{"my-communities-detailed":{url:"api/userPreferences/getmyblacklist",dataFn:function(){return{model:"Community"}}}},read:{"my-communities-people":{url:"/api/community/getsharednonpubliccommunities",dataFn:function(){return{limit:this._limit,page:this._currentPage,hash_key:this._hashKey}}},"my-communities":{url:"api/community/listmycommunities",dataFn:function(i){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:i&&i.order?i.order:undefined,without_favorites:i&&i.without_favorites?i.without_favorites:undefined}}},"my-dm-communities":{url:"api/community/listmycommunities",dataFn:function(i){return{limit:999,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:i&&i.order?i.order:undefined,without_favorites:i&&i.without_favorites?i.without_favorites:undefined}},parse:function(i){i=i.filter(e);return i}},"my-non-dm-communities":{url:"api/community/listmycommunities",dataFn:function(i){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:i&&i.order?i.order:undefined,without_favorites:i&&i.without_favorites?i.without_favorites:undefined}},parse:function(i){i=i.filter(d);return i}},"my-favorites-communities":{url:"api/community/listmycommunities",dataFn:function(i){return{limit:5,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess,order:(i&&i.order)?i.order:undefined}},parse:function(i){return h.is(i.values,"array")?i.values:i}},"all-my-communities":{url:"api/community/listmycommunities",dataFn:function(){return{limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-iquestion-enabled":{url:"api/community/listmycommunities",dataFn:function(i){return{feature_enabled_for:"iquestion",with_pagination:i.with_pagination!==undefined?i.with_pagination:this._currentPage>0?true:false,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-idea-enabled":{url:"api/community/listmycommunities",dataFn:function(i){return{feature_enabled_for:"ideation",with_pagination:i.with_pagination!==undefined?i.with_pagination:this._currentPage>0?true:false,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-wiki-enabled":{url:"api/community/listmycommunities",dataFn:function(i){return{feature_enabled_for:"wikitree",with_pagination:i.with_pagination!==undefined?i.with_pagination:this._currentPage>0?true:false,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"my-communities-with-survey-enabled":{url:"api/community/listmycommunities",dataFn:function(i){return{feature_enabled_for:"survey",with_pagination:i.with_pagination!==undefined?i.with_pagination:this._currentPage>0?true:false,limit:this._limit,page:this._currentPage,only_with_stats_access:this._onlyWithStatsAccess}}},"discover-communities":{url:"api/community/discovercommunities",parse:function(i){if((h.is(i),"array")){i.forEach(function(j){j.hasUserAccess=false})}return i}},"my-communities-detailed":{url:"api/community/listmycommunities",dataFn:function(){return{limit:this._limit,filters:this._filters,page:this._currentPage}}},"discover-communities-detailed":{url:"api/community/discovercommunities",parse:function(i){if((h.is(i),"array")){i.forEach(function(j){j.hasUserAccess=false})}return i}},"communities-with-rights":{url:"api/community/listmycommunities",dataFn:function(i){return{limit:this._limit,creation_granted_for:(i&&i.model)||this.getModel()}}},"tenant-communities":{url:"admin/api/member/gettenantcommunities",dataFn:function(i){return h.merge(i,{context:"tenant",query:i.query||null,limit:this._limit,page:this._currentPage,start:(parseInt(this._currentPage,10)-1)*this._limit})}},listmypublicprivatecommunities:{url:"api/community/listmycommunities",dataFn:function(){return{without_secret_communities:true,limit:this._limit,page:this._currentPage}}}},filter:{"my-communities":{url:"api/exalead/search",dataFn:function(i){return h.extend(i||{},{myCommunitiesOnly:true,withNoTags:true})},tagsWithoutSubjectURI:true},"all-my-communities":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true},"tenant-communities":{url:"api/exalead/search",dataFn:function(i){return h.extend(i||{},{as_admin:true})},tagsWithoutSubjectURI:true},"discover-communities":{url:"api/exalead/searchdiscovercommunities",tagsWithoutSubjectURI:true},"my-non-dm-communities":{url:"api/exalead/search",dataFn:function(i){return h.extend(i||{},{myCommunitiesOnly:true,withNoTags:(this.fetchTagsSeparatelyOnRefresh===true?false:true)})},tagsWithoutSubjectURI:true},"my-communities-detailed":{url:"api/exalead/searchmycommunities",tagsWithoutSubjectURI:true}}},model:f,modes:["my-communities-people","my-communities","all-my-communities","my-communities-with-iquestion-enabled","my-communities-with-idea-enabled","my-communities-with-wiki-enabled","my-communities-with-survey-enabled","discover-communities","my-communities-detailed","discover-communities-detailed","communities-with-rights","tenant-communities","listmypublicprivatecommunities","my-favorites-communities","my-dm-communities","my-non-dm-communities"],exaleadContentType:"community",loadingStatus:a.STATUS.notRequested,init:function(j,i){if(i&&i.filters){this.setFilters(i.filters)}if(i&&i.hash_key){this.setHashKey(i.hash_key)}if(i&&i.only_with_stats_access){this.setOnlyWithStatsAccess(i.only_with_stats_access)}if(i&&i.modelParam){this.setModel(i.modelParam)}if(i&&i.directMessage!==undefined){this._directMessage=i.directMessage}return this._parent(j,i)},getHashKey:function(){return this._hashKey},setHashKey:function(i){this._hashKey=i},setOnlyWithStatsAccess:function(i){this._onlyWithStatsAccess=i},setModel:function(i){this.modelParam=i},getModel:function(){return this.modelParam},getFilters:function(){return this._filters},isDMCommunityList:function(){return this._directMessage},setFilters:function(j,i){this._filters=j;if(i===true){this.resetCollection()}},_setIsBlacklistedAttribute:function(){if(c&&c.length>0){c.forEach(function(i){i.set("isBlacklisted",true)})}},getBlacklistedCommunitiesCollection:function(j){var i=this;if(!c){c=new b([],{mode:"my-communities-detailed",limit:99999});c.getmyblacklist({onComplete:function(k){c=k;i._setIsBlacklistedAttribute();j&&j()}})}return c},getmyblacklist:function(i){return this.action("getmyblacklist",i)},"onRequest:read":function(){this.loadingStatus=a.STATUS.pending;this.dispatchEvent("onLoadingStatusChange",[this])},"onSync:read":function(){this.loadingStatus=a.STATUS.valid;this.dispatchEvent("onLoadingStatusChange",[this])},"onError:read":function(){this.loadingStatus=a.STATUS.invalid;this.dispatchEvent("onLoadingStatusChange",[this])}});return b});define("DS/SwymUICore/script/feature/core/favorite-communities/collection/favorite-communities-collection",["UWA/Core","DS/SwymUICore/script/feature/community/community/collection/community-collection"],function(c,d){var b=function(i){var e=[],h,f={},g,j;for(g in i.hits){if(i.hits.hasOwnProperty(g)){f={};h=i.hits[g].metas;for(j in h){if(h.hasOwnProperty(j)){f[h[j].name]=h[j].value}}e.push(f)}}return e},a=d.extend({_collectionName:"favorite-communities-collection",comparator:function(f,e){return this.listIds.indexOf(f.get("mid"))>this.listIds.indexOf(e.get("mid"))?1:-1},_services:{read:{all:{url:"api/exalead/searchmycommunities",method:"POST",dataFn:function(){var e=this._buildIdQuery();return{nresults:999,legacyFormat:false,start:0,only_with_stats_access:false,contentType:"community",query:e}},parse:b,tagsWithoutSubjectURI:true}},filter:{all:{url:"api/exalead/searchmycommunities",method:"POST",dataFn:function(f){var e=this._buildIdQuery();return c.extend(f||{},{refineUsingQuery:e})},parse:b,tagsWithoutSubjectURI:true}}},modes:["all"],setup:function(f,e){this.listIds=e.listIds},_buildIdQuery:function(){var f="",e;for(e in this.listIds){if(this.listIds.hasOwnProperty(e)){f+=(f!==""?" OR ":"")+'id:"'+this.listIds[e]+'"'}}return f}});return a});