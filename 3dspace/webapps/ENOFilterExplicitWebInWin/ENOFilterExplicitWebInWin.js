define("DS/ENOFilterExplicitWebInWin/views/filterRepairUI",["UWA/Core","UWA/Element","UWA/Promise","DS/Core/Core","UWA/Class/View","DS/Tree/TreeListView","DS/Tree/TreeNodeModel","DS/Handlebars/Handlebars","DS/UIKIT/Input/Button","DS/UIKIT/SuperModal","DS/UIKIT/Mask","DS/WAFData/WAFData","DS/Controls/Accordeon","DS/CollectionView/ResponsiveLargeTilesCollectionView","i18n!DS/ENOFilterExplicitWebInWin/assets/nls/ENOStrRefinementUX.json","text!DS/ENOFilterExplicitWebInWin/template/filterRepairUITemplate.html","css!DS/ENOFilterExplicitWebInWin/ENOFilterExplicitWebInWin.css"],function(n,l,c,b,p,f,j,d,h,m,r,a,i,k,o,q,g){var e=p.extend({setup:function(s){this.IsRepairFilterLaunchedInWidget=false;this.securityCtx=s.ctx;this.serverUrl=s.url;if(UWA.is(s.brokenPaths,"object")){this._brokenPathObj=s.brokenPaths}else{this._brokenPathObj=JSON.parse(s.brokenPaths)}this._template=d.compile(q);this.container.addEvent("click",function(t){t.stopPropagation();return false})},RepairFilterInWidget:function(){this.IsRepairFilterLaunchedInWidget=true},fetchData:function(){var s=this;return new c(function(u){var t={headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:s.securityCtx},method:"POST",data:JSON.stringify(s._brokenPathObj),onComplete:function(v){s.responseJsonObj={paths:[]};var w=JSON.parse(v);if(UWA.is(w,"object")&&UWA.is(w.paths,"array")){s.responseJsonObj=w}if(s.responseJsonObj){s._getThumbnailAndTypeInfo().then(function(){u("RepairFilterFetchData_SUCCESS")})}else{u("RepairFilterFetchData_SUCCESS")}},onFailure:function(x){console.log(" WebService Failure");var v=JSON.stringify(x);var w=o.get("ServerError");alert(w);r.unmask(s.container);u("RepairFilterFetchData_FAILURE")}};a.authenticatedRequest(s.serverUrl+"/resources/FilterBIAPI/ExplicitMgt/getGoodVersionsIds",t)})},render:function(){var y=this;if(this.IsRepairFilterLaunchedInWidget){this.container.setContent(this._template({AppType:"widget",filterNameToRepair:o.get("RepairPanelHeader"),}))}else{this.container.setContent(this._template({AppType:"webInWin",filterNameToRepair:o.get("RepairPanelHeader"),}))}this.ListOfTileViewCollection=[];this.myAccordeon=new i({style:"filled-separate"});this.myAccordeon.addEventListener("expand",s.bind(this),false);this.myAccordeon.addEventListener("collapse",s.bind(this),false);function s(P){var O=this;if(this.ignore){P.stopImmediatePropagation();var N=P.options.expanderIndex;this.ListOfTileViewCollection[N].modelProvider.unselectAll();this.ignore=false;this.getElement(".statusNum-"+P.options.expanderIndex).setText(o.get("IgnoreCellName"));this.getElement(".statusNum-"+P.options.expanderIndex).setStyle("background-color","darkorange")}else{if(this.reactivate){P.stopImmediatePropagation();var N=P.options.expanderIndex;this.ListOfTileViewCollection[N].modelProvider.selectNode(this.ListOfTileViewCollection[N].model[0]);this.reactivate=false;this.getElement(".statusNum-"+P.options.expanderIndex).setText(o.get("SolvedCellName"));this.getElement(".statusNum-"+P.options.expanderIndex).setStyle("background-color","limegreen")}}}this.myAccordeon.inject(this.getElement(".repairFilter-list-accordeons"));for(var E=0;E<y.responseJsonObj.paths.length;E++){var K=new k({height:"inherit",displayTitleTooltip:true,displayPropertiesTooltip:true,useDragAndDrop:false,toggle:true,});K.selectionBehavior={unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:false,enableShiftSelection:false,enableListSelection:false,enableFeedbackForActiveCell:true};var H=[];for(var D=0;D<y.responseJsonObj.paths[E].length;D++){var M=y.responseJsonObj.paths[E][D];var u=y._checkForDeletedPathCase(M);if(M.length>0&&M[M.length-2].name&&u){var F=this._buildNodeFromData(M);if(F.label){var A=new j({label:F.label,subLabel:M[M.length-1].trueType,thumbnail:M[M.length-1].preview_url,data:F.data,});H.push(A)}}}if(H.length>0){K.model=H;this.ListOfTileViewCollection.push(K);K.modelProvider.selectNode(H[0]);var w=n.createElement("div",{"class":"tile1 accordeon-node"});w.inject(this.getElement(".repairFilterTiles-test"));K.inject(w);var v=(K.model.length>1)?K.model.length*125+"px":K.model.length*125+"px";w.setStyle("height",v);var I={header:y._brokenPathObj.paths[E][y._brokenPathObj.paths[E].length-1].name,content:w};this.myAccordeon.addItem(I);var z=n.createElement("span",{"class":"ignore-span accordeon-"+E,text:o.get("IgnoreTitle")});var J=n.createElement("div",{"class":"statusOfRepair statusNum-"+E,text:o.get("SolvedCellName")});var t=this.getElements(".wux-controls-expander-header-container");for(var B=0;B<t.length;B++){z.inject(t[B]);J.inject(t[B])}z.addEventListener("click",G.bind(this),false);function G(N){if(o.get("IgnoreTitle")==N.target.textContent){this.ignore=true;N.target.textContent=o.get("ReactivateTitle")}else{if(o.get("ReactivateTitle")==N.target.textContent){this.reactivate=true;N.target.textContent=o.get("IgnoreTitle")}}}}else{this.ListOfTileViewCollection.push(K);var L=new UWA.Element("div",{text:o.get("ObjectDeleted")});var I={header:y._brokenPathObj.paths[E][y._brokenPathObj.paths[E].length-1].name,content:L};this.myAccordeon.addItem(I);var x=n.createElement("span",{"class":"ignore-span deletedPath-span accordeon-"+E,text:o.get("Deleted")});var t=this.getElements(".wux-controls-expander-header-container");for(var B=0;B<t.length;B++){x.inject(t[B])}}K.onSelectionAdd(function(P){var N=P.getLabel();var O="";for(var R=0;R<this.ListOfTileViewCollection.length;R++){if(this.ListOfTileViewCollection[R].model.length){for(var Q=0;Q<this.ListOfTileViewCollection[R].model.length;Q++){if(this.ListOfTileViewCollection[R].model[Q].getLabel()==N){O=R;this.myAccordeon.getExpanderFromIndex(R).expand();break}}}}if(O>=0){this.getElement(".statusNum-"+O).setText(o.get("SolvedCellName"));this.getElement(".statusNum-"+O).setStyle("background-color","limegreen");this.getElement(".accordeon-"+O).setText(o.get("IgnoreTitle"))}}.bind(this));K.onSelectionRemove(function(P){var N=P.getLabel();var O="";for(var R=0;R<this.ListOfTileViewCollection.length;R++){if(this.ListOfTileViewCollection[R].model.length){for(var Q=0;Q<this.ListOfTileViewCollection[R].model.length;Q++){if(this.ListOfTileViewCollection[R].model[Q].getLabel()==N){O=R;this.myAccordeon.getExpanderFromIndex(R).expand();break}}}}if(O>=0){this.getElement(".statusNum-"+O).setText(o.get("IgnoreCellName"));this.getElement(".statusNum-"+O).setStyle("background-color","darkorange");this.getElement(".accordeon-"+O).setText(o.get("ReactivateTitle"))}}.bind(this))}var C=this.getElement(".buttonDiv");this.applyButton=new h({value:o.get("TitleApply"),className:"default RtMargin",id:"applyButton"}).inject(C);this.saveButton=new h({value:o.get("TitleSave"),className:"default RtMargin",id:"saveButton"}).inject(C);this.cancelButton=new h({value:o.get("TitleCancel"),className:"default RtMargin",id:"cancelButton"}).inject(C);if(y.IsRepairFilterLaunchedInWidget){this.saveButton.getContent().addClassName("hidden");this.applyButton.getContent().setText("OK")}y.cancelButton.addEvent("onClick",function(){if(y.IsRepairFilterLaunchedInWidget){var N={listOfList:"CancelRepair"};y.dispatchEvent("NGF_CancelRepairFilter",N)}else{y._webInWinNotif("CancelButton")}});y.saveButton.addEvent("onClick",function(){var N=new m({closable:true,renderTo:document.body,id:"superModaldialog"});N.confirm(o.get("SaveWarning"),o.get("SaveWarningTitle"),function(O){console.log("Confirm result: "+O);if(O){y._operateModel();y._webInWinNotif("SaveButton",y.obj.listOfList)}})});y.applyButton.addEvent("onClick",function(){if(y.IsRepairFilterLaunchedInWidget){y._operateModel();y.dispatchEvent("NGF_RepairFilter",y.obj)}else{y._operateModel();y._webInWinNotif("ApplyButton",y.obj.listOfList)}});return this},_checkForDeletedPathCase:function(t){for(var s=0;s<t.length;s++){if(!t[s].name){return false}}return true},_buildNodeFromData:function(s){var t=s[s.length-2].name+" "+s[s.length-1].revision;var w=s[s.length-2].coretype;var y=[];var v=[];for(var u=0;u<s.length;u++){y.push(s[u].physicalid);v.push(s[u].logicalid)}var x={label:t,subLabel:w,data:{pathOfPhysicalID:y,pathOfLogicalID:v}};return x},_webInWinNotif:function(s,u){var t=JSON.stringify(u);console.log(t);if(typeof CATCefSendString!=="undefined"){dscef.sendString(s+"="+t)}},_operateModel:function(){var w=[];var s=[];for(var u=0;u<this.ListOfTileViewCollection.length;u++){var t=this.ListOfTileViewCollection[u].getActiveCellID();if(t!="undefined"){if(this.ListOfTileViewCollection[u].modelProvider.isNodeSelected(this.ListOfTileViewCollection[u].model[t])){var x=this.ListOfTileViewCollection[u].getModelAt(t).options.data.pathOfPhysicalID;var v=this.ListOfTileViewCollection[u].getModelAt(t).options.data.pathOfLogicalID;w.push(x);s.push(v)}}}this.obj={listOfList:w}},_getThumbnailAndTypeInfo:function(){var s=this;return new c(function(z){var t=[];var A=s.responseJsonObj.paths;var y=A.length;for(var w=0;w<y;w++){var v=A[w].length;if(v==1){var x=A[w][0].length;if(x>0){t.push(A[w][0][x-1].physicalid)}}else{for(var u=0;u<v;u++){var x=A[w][u].length;if(x>0){t.push(A[w][u][x-1].physicalid)}}}}if(t.length>0){s._fetchTypeUrlInfo(t).then(function(B){var F=[];if(B.results.length<=t.length){for(var M=0;M<B.results.length;M++){var C=B.results[M];for(var L=0;L<C.attributes.length;L++){var K=C.attributes[L];if(K.name=="resourceid"){var R=K.value}if(K.name=="preview_url"){var I=K.value}if(K.name=="type"){var E=K.value}}var H={physicalid:R,url:I,type:E};F.push(H)}var Q=s.responseJsonObj.paths;var G=Q.length;for(var P=0;P<G;P++){var D=Q[P].length;if(D==1){var J=Q[P][0].length;if(J>0){var S=Q[P][0][J-1].physicalid;for(var O=0;O<F.length;O++){if(F[O].physicalid==S){Q[P][0][J-1].preview_url=F[O].url;Q[P][0][J-1].trueType=F[O].type}}}}else{for(var O=0;O<D;O++){var J=Q[P][O].length;if(J>0){var S=Q[P][O][J-1].physicalid;for(var N=0;N<F.length;N++){if(F[N].physicalid==S){Q[P][O][J-1].preview_url=F[N].url;Q[P][O][J-1].trueType=F[N].type}}}}}}z()}})}else{z()}})},_fetchTypeUrlInfo:function(s){var t=this;return new c(function(w,v){var u={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",type:"json",proxy:"passport",data:JSON.stringify({label:"NGF_ExecuteFetch",physicalid:s,select_file:["icon","thumbnail_2d"],select_predicate:["type"]}),onComplete:function(x){w(x)},onFailure:function(x){v(x)}};a.authenticatedRequest(t.serverUrl+"/cvservlet/fetch/v2",u)})}});return e});define("DS/ENOFilterExplicitWebInWin/filterModeler",["UWA/Core","UWA/Element","UWA/Class/View","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","UWA/Class","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/WAFData/WAFData","i18n!DS/ENOFilterExplicitWebInWin/assets/nls/ENOStrRefinementUX.json","css!DS/ENOFilterExplicitWebInWin/ENOFilterExplicitWebInWin.css"],function(l,e,c,h,b,g,d,i,a,k,f,j){var m=d.extend({_badPathObj:null,badObjs:[],resolvedPathIndex:[],areAllNodesExpanded:false,areAllNodesCollapsed:true,init:function(s,o,t){this.badObjs.splice();this.filterModelUI=t;this.serverUrl=o;if(UWA.is(s,"object")){this._badPathObj=s}else{this._badPathObj=JSON.parse(s)}for(var q=0;q<this._badPathObj.paths.length;q++){this._initResolvedIndex(q,(-1))}if(UWA.is(this._badPathObj,"object")&&UWA.is(this._badPathObj.paths,"array")){for(var q=0;q<this._badPathObj.paths.length;q++){var n="";var p=this._badPathObj.paths[q].length;if(p>0){var r=this._badPathObj.paths[q][p-1].coretype;if("PLMCoreRepReference"==r){n=this._badPathObj.paths[q][p-1].name}else{n=this._badPathObj.paths[q][p-2].name}if(n===""){n=this._badPathObj.paths[q][p-1].name}this.badObjs.push(n)}}}},createModel:function(){var o=this;this.model=new b({useAsyncPreExpand:true,nodesAreDraggable:false});var n={selection:{toggle:false},show:{columnHeaders:true},columns:[{text:f.get("SolutionsProposedHeader"),dataIndex:"solutions",width:100,minWidth:100},{text:"",dataIndex:"crossHighlight",width:23,minWidth:23,onCellRequest:function(r){if(!r.isHeader){if(!r.nodeModel.isRoot()){var p=new i({value:"",className:"fonticon fonticon-location default highlight-buton "});var q=p.getContent();r.cellView.getContent().setHTML(q)}}}},{text:f.get("StatusHeader"),dataIndex:"status",width:55,minWidth:55,onCellRequest:function(v){if(!v.isHeader){if(!v.nodeModel.isRoot()){var t=v.nodeModel.options.optionID;var r=v.nodeModel.options.parentID;var s=o._getIndexOfSelectedOption(r);if(s==t){v.cellView.getContent().setHTML("<img src="+o.icon_Solved+" class='img-responsive img-thumbnail img-SolveIcon'/> <span>"+f.get("AppliedSolutionCellText")+"</span>")}else{var p=new i({value:f.get("ApplySolutionButton"),className:"default selection-button "});var u=p.getContent();v.cellView.getContent().setHTML(u)}}else{if(v.nodeModel.options.label=="(Path has been Deleted)"){v.cellView.getContent().setHTML(f.get("IgnoreCellName"))}else{var q=v.nodeModel.options.rootID;var s=o._getIndexOfSelectedOption(q);if(s==-1){v.cellView.getContent().setHTML(f.get("PendingMSolve"))}else{if(s==-2){v.cellView.getContent().setHTML(f.get("IgnoreCellName"))}else{v.cellView.getContent().setHTML(f.get("SolvedCellName"))}}}}}}},{text:"",dataIndex:"ignore",width:95,minWidth:95,onCellRequest:function(t){if(!t.isHeader){if(t.nodeModel.isRoot()){if(t.nodeModel.options.label!="(Path has been Deleted)"){var s=t.virtualRowID;var q=t.cellView.options.gridEngine.getTreeNodeModelFromRowID(s).options.rootID;if(o.manager.getNthRoot(q).options.grid.ignore==f.get("IgnoreButtonHelp")){var v=new i({value:f.get("IgnoreTitle"),className:"default ignore-button"});var u=v.getContent();t.cellView.getContent().setHTML(u)}else{if(o.manager.getNthRoot(q).options.grid.ignore==f.get("ReactivateButtonHelp")){var p=new i({value:f.get("ReactivateTitle"),className:"default ignore-button"});var r=p.getContent();t.cellView.getContent().setHTML(r)}}}}}}}],isSortable:false,draggable:false,resize:{columns:true,rows:true},height:"auto",useAsyncPreExpand:true,apiVersion:2,infiniteScrolling:true,enableActiveUI:true,performances:{preloadPool:true,useRequestAnimationFrameRendering:false},headersDimensions:{width:undefined,height:undefined},onDragStart:function(q,p){},onDragEnter:function(p,s,r,q){},onDragLeave:function(p,s,r,q){},onDragOver:function(p,s,r,q){},onDrop:function(p,s,r,q){},onDragEnterRowHeaderDefault:function(q,p){},onDragLeaveRowHeaderDefault:function(q,p){},onDragStartColumnHeader:function(q,p){},onDragEnterColumnHeaderDefault:function(q,p){},onDragLeaveColumnHeaderDefault:function(q,p){},onDragEnterCellDefault:function(q,p){},onDragOverCellDefault:function(q,p){},onDragLeaveCellDefault:function(q,p){},onDragEndCellDefault:function(q,p){},onDragStartCell:function(q,p){},onDropCellDefault:function(q,p){},onDragEnterBlankDefault:function(q,p){},onDragLeaveBlankDefault:function(q,p){},onDropBlankDefault:function(q,p){},treeDocument:this.model};var o=this;o.tree=new h(n);o.tree.options.columns[0].text=f.get("ProblemsToRepair");o.manager=o.tree.getManager();o.tree.onPostCollapse(function(s,t){var u=true;var q=o.manager.getRoots();for(var p=0;p<q.length;p++){var r=q[p].isExpanded();if(r==true){u=false}}o._setCollapseStatus(u)});o.tree.onPostExpand(function(t,u){var r=true;var q=o.manager.getRoots();for(var p=0;p<q.length;p++){var s=q[p].isExpanded();if(s==false){r=false}}o._setExpandStatus(r)});this._buildAndUpdateRoot()},_setExpandStatus:function(n){this.areAllNodesExpanded=n;if(this.areAllNodesExpanded==true){this.filterModelUI.expandButton.setValue(f.get("CollapseAllButtonTitle"))}},_setCollapseStatus:function(n){this.areAllNodesCollapsed=n;if(this.areAllNodesCollapsed==true){this.filterModelUI.expandButton.setValue(f.get("ExpandAllButtonTitle"))}},_webInWinNotification:function(n,p){var o=JSON.stringify(p);console.log(o);if(typeof CATCefSendString!=="undefined"){CATCefSendString(n+"="+o)}},getTreeManager:function(){return this.tree.getManager()},_buildAndUpdateRoot:function(){this.icon_Broken=(this.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Broken.png");this.icon_Valid=(this.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Valid.png");this.icon_Solved=(this.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Solved.png");for(var p=0;p<this.badObjs.length;p++){var o=this.badObjs[p].italics();var n=new g({label:o,icons:[this.icon_Broken],rootID:p,grid:{solutions:"",status:"",ignore:f.get("IgnoreButtonHelp")},isEditable:false});this.model.addRoot(n);this.tree.elements.container.addClassName("wux-datagrid-cell-even")}},_buildAndUpdateSubRoot:function(s){if(UWA.is(this.responseJson,"object")){if(this.responseJson.paths[s].length==1){var u="";var t=this.responseJson.paths[s][0].length;if(t>0){var o=this.responseJson.paths[s][0][t-1].coretype;if("PLMCoreRepReference"==o){var q=this.responseJson.paths[s][0][t-1].v_name;var r=this.responseJson.paths[s][0][t-1].revision;u=q+" "+r}else{var q=this.responseJson.paths[s][0][t-2].name;var r=this.responseJson.paths[s][0][t-1].revision;u=q+" "+r}}var v=new g({optionID:0,parentID:s,grid:{solutions:u,crossHighlight:f.get("CrossHighlightCellTitle"),status:f.get("ApplySolutionCellTitle")}});this.model.getNthRoot(s).addChild(v)}else{var w=this.responseJson.paths[s].length;for(var p=0;p<w;p++){var n=this.responseJson.paths[s][p].length;var o=this.responseJson.paths[s][0][n-1].coretype;var u="";if("PLMCoreRepReference"==o){var q=this.responseJson.paths[s][p][n-1].v_name;var r=this.responseJson.paths[s][p][n-1].revision;u=q+" "+r}else{var q=this.responseJson.paths[s][p][n-2].name;var r=this.responseJson.paths[s][p][n-1].revision;u=q+" "+r}var v=new g({optionID:p,parentID:s,grid:{solutions:u,crossHighlight:f.get("CrossHighlightCellTitle"),status:f.get("ApplySolutionCellTitle")}});this.model.getNthRoot(s).addChild(v)}}}},_addChildToRoots:function(){for(var n=0;n<this.responseJson.paths.length;n++){this._buildAndUpdateSubRoot(n)}},_updateAttribute:function(o,n){this.model.getNthRoot(o).options.icons=[n];this.badObjs.splice(0,1)},_removeSubRoot:function(o){if(UWA.is(this.responseJson,"object")){if((this.responseJson.paths[o][0].length)<(this._badPathObj.paths[o].length)){this.model.getNthRoot(o).removeChildren();var r=f.get("PathDeleted");this.model.getNthRoot(o).setLabel(r);return true}if(this.responseJson.paths[o].length==1){this.model.getNthRoot(o).removeChildren();var q=this.responseJson.paths[o][0].length;var s=this.responseJson.paths[o][0][q-1].coretype;if("PLMCoreRepReference"==s){var n=this.responseJson.paths[o][0][q-1].v_name;var p=this.responseJson.paths[o][0][q-1].revision}else{var n=this.responseJson.paths[o][0][q-2].name;var p=this.responseJson.paths[o][0][q-1].revision}if(n!=""&&p!=undefined){this.model.getNthRoot(o).setAttribute("solutions",n+" "+p)}else{r=f.get("PathDeleted");this.model.getNthRoot(o).setLabel(r)}return true}else{return false}}},_modifyTreeListModel:function(){if(this.responseJson.paths.length>0){for(var o=0;o<this.responseJson.paths.length;o++){var r=this.responseJson.paths[o].length;if(r>=1){var p=this._getIndexOfSelectedOption(o);if(p>=0){var q=0;for(var n=0;n<=r;n++){if(n!=p){this.responseJson.paths[o].splice(q,1)}else{q++}}}else{if(p==-2){var q=0;for(var n=0;n<=r;n++){this.responseJson.paths[o].splice(q,1)}}}}}}},_operateFilter:function(r){var u=[];if(UWA.is(this.responseJson,"object")&&UWA.is(this.responseJson.paths,"array")){for(var q=0;q<this.responseJson.paths.length;q++){var n=[];if(this.responseJson.paths[q].length>0){var s=this.responseJson.paths[q][0].length;for(var o=0;o<s;o++){var t=this.responseJson.paths[q][0][o].physicalid;var p=this.responseJson.paths[q][0][o].name;if(p!=""){n[o]=t}else{n[o]="null"}}}else{n[0]="null"}u[q]=n}if(this.filterModelUI.IsRepairFilterLaunchedInWidget){this.listOfListOfRepairedPathsPLMIDs=[];for(var q=0;q<u.length;q++){if(!(u[q]=="null")){this.listOfListOfRepairedPathsPLMIDs.push(u[q])}}this.obj={listOfList:this.listOfListOfRepairedPathsPLMIDs};this.filterModelUI.dispatchEvent("NGF_RepairFilter",this.obj)}else{this._webInWinNotification(r,u)}}},_crossHighlight:function(s,q){if(UWA.is(this.responseJson,"object")&&UWA.is(this.responseJson.paths,"array")){var n=[];if(this.responseJson.paths[s].length>0){var r=this.responseJson.paths[s][0].length;var o=this.responseJson.paths[s][q][0].name;if(o!=""){n[0]=this.responseJson.paths[s][q][0].physicalid}else{n[0]="null"}var p=count=1;while(p<r){var o=this.responseJson.paths[s][q][p].name;if(o!=""){n[count]=this.responseJson.paths[s][q][p].physicalid}else{n[count]="null"}p=p+2;count++}}this._webInWinNotification("CrossHighlight",n)}},_openPropertiesPanel:function(q,o){if(UWA.is(this.responseJson,"object")&&UWA.is(this.responseJson.paths,"array")){var n=[];if(this.responseJson.paths[q].length>0){var p=this.responseJson.paths[q][0].length;n[0]=this.responseJson.paths[q][o][0].physicalid;n[1]=this.responseJson.paths[q][o][p-2].physicalid}this._webInWinNotification("Properties",n)}},_updateResolvedIndex:function(n,p){this.resolvedPathIndex.splice(n,1,p);var o=1},_initResolvedIndex:function(n,o){this.resolvedPathIndex.push(o)},_getIndexOfSelectedOption:function(n){if(n>=0){var o=this.resolvedPathIndex[n];return o}},_checkIfAllPathsResolved:function(){var n=this.resolvedPathIndex.indexOf(-1,0);if(n==-1){return true}else{return false}},_actionOnComplete:function(p){this.responseJson=p;if(this.responseJson.paths.length===this._badPathObj.paths.length){this._addChildToRoots();var q=true;for(var o=0;o<this.responseJson.paths.length;o++){var n=this._removeSubRoot(o);if(n){this._updateAttribute(o,this.icon_Solved);this._updateResolvedIndex(o,0)}else{q=false}}return q}}});return m});define("DS/ENOFilterExplicitWebInWin/filterUI",["UWA/Core","UWA/Element","DS/Core/Core","UWA/Class/View","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/Toggle","UWA/Class","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/SuperModal","DS/UIKIT/Mask","DS/WAFData/WAFData","DS/ENOFilterExplicitWebInWin/filterModeler","i18n!DS/ENOFilterExplicitWebInWin/assets/nls/ENOStrRefinementUX.json","css!DS/ENOFilterExplicitWebInWin/ENOFilterExplicitWebInWin.css"],function(n,l,b,p,d,g,j,c,q,i,k,m,r,a,e,o,f){var h=p.extend({badObjs:[],init:function(t,s,u){this.IsRepairFilterLaunchedInWidget=false;this.securityCtx=u;this.serverUrl=s;this.filterModelerObj=new e(t,s,this)},_getGlobalEditContainer:function(){if(document.querySelector(".f-globalFilter-container")!=null){var t=document.querySelector(".f-globalFilter-container");var s=t.querySelector(".globalEdit-container");return s}},RepairFilterInWidget:function(){this.IsRepairFilterLaunchedInWidget=true},fetchData:function(){var t=this;var s={headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:t.securityCtx},method:"POST",data:JSON.stringify(t.filterModelerObj._badPathObj),onComplete:function(v){t.responseJsonObj={paths:[]};var w=JSON.parse(v);if(UWA.is(w,"object")&&UWA.is(w.paths,"array")){t.responseJsonObj=w}var u=t.filterModelerObj._actionOnComplete(t.responseJsonObj);if(u){t.applyButton.getContent().removeClassName("disabled");t.saveButton.getContent().removeClassName("disabled");t.expandButton.getContent().addClassName("disabled")}t.manager.updateView();r.unmask(t.container)},onFailure:function(w){console.log(" WebService Failure");var u=JSON.stringify(w);var v=o.get("ServerError");alert(v);r.unmask(t.container)}};r.mask(t.container);a.authenticatedRequest(t.serverUrl+"/resources/FilterBIAPI/ExplicitMgt/getGoodVersionsIds",s)},buildUI:function(){var z=window.document.getElementById("temp-filter-msg-div");if(n.is(z)){var x=n.extendElement(z);if(UWA.is(x)){z.destroy()}}var t=this;if(t.IsRepairFilterLaunchedInWidget){t._getGlobalEditContainer().empty();t.container=new UWA.Element("div",{id:"filter-container","class":"filter-container-widget-div"});t.container.inject(t._getGlobalEditContainer())}else{t.container=new UWA.Element("div",{id:"filter-container","class":"filter-container-div"});t.container.inject(document.body)}var F=new UWA.Element("div",{id:"filter-legend","class":"filter-legend-div"});F.inject(t.container);var u=new UWA.Element("div",{id:"filter-numberOfWarnings","class":"filter-numberOfWarnings-div"});u.inject(F);var v=(t.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Broken.png");var E=0;var A=0;document.getElementById("filter-numberOfWarnings").innerHTML="<img src="+v+" class='img-responsive img-thumbnail'/> <span>"+o.get("RepairPathLegend")+"</span>";var B=new UWA.Element("div",{id:"filter-numberOfSolved","class":"filter-numberOfSolved-div"});B.inject(F);var C=(t.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Solved.png");document.getElementById("filter-numberOfSolved").innerHTML="<img src="+C+" class='img-responsive img-thumbnail'/> <span>"+o.get("SolvedPathLegend")+"</span>";var D=new UWA.Element("div",{id:"filter-expandAll","class":"filter-expandAll-div"});D.inject(F);var s=(t.serverUrl+"/webapps/ENOFilterExplicitWebInWin/assets/icons/Icon_Solved.png");t.expandButton=new i({value:o.get("ExpandAllButtonTitle"),className:"default expand-button",icon:"flow-cascade",id:"expandButton"}).inject(D);t.expandButton.addEvent("onClick",function(){if(t.expandButton.getValue()==o.get("ExpandAllButtonTitle")){var H=t.filterModelerObj.getTreeManager().getRoots();for(var G=0;G<H.length;G++){H[G].expandAll()}t.expandButton.setValue(o.get("CollapseAllButtonTitle"))}else{if(t.expandButton.getValue()==o.get("CollapseAllButtonTitle")){var H=t.filterModelerObj.getTreeManager().getRoots();for(var G=0;G<H.length;G++){H[G].collapseAll()}t.expandButton.setValue(o.get("ExpandAllButtonTitle"))}}});var w=new UWA.Element("div",{id:"filter-treeList","class":"filter-TreeList-div"});w.inject(t.container);var y=new UWA.Element("div",{id:"filter-button","class":"filter-button-div"});y.inject(t.container);this.filterModelerObj.createModel();this.filterModelerObj.tree.inject(w);t.manager=this.filterModelerObj.getTreeManager();t.applyButton=new i({value:o.get("TitleApply"),className:"default RtMargin",id:"applyButton"}).inject(y);t.applyButton.getContent().addClassName("disabled");t.saveButton=new i({value:o.get("TitleSave"),className:"default RtMargin",id:"saveButton"}).inject(y);t.saveButton.getContent().addClassName("disabled");t.cancelButton=new i({value:o.get("TitleCancel"),className:"default RtMargin",id:"cancelButton"}).inject(y);if(t.IsRepairFilterLaunchedInWidget){document.querySelector(".wux-datagrid").addClassName("wux-datagrid-filterwidget");t.saveButton.getContent().addClassName("hidden");t.applyButton.getContent().setText("OK")}t.manager.onNodeClick(function(H,M){if(H.virtualColumnID==3){if(H.model.getCellContent()==o.get("ApplySolutionCellTitle")){var N=H.virtualRowID;var J=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.parentID;var K=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.optionID;t.filterModelerObj._updateResolvedIndex(J,K);var I=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.grid.solutions;H.cellView.options.gridEngine.getNthRoot(J).setAttribute("solutions",I.bold());t.manager.updateView();t.filterModelerObj._updateAttribute(J,t.filterModelerObj.icon_Solved);var Q=t.filterModelerObj._checkIfAllPathsResolved();if(Q){t.applyButton.getContent().removeClassName("disabled");t.saveButton.getContent().removeClassName("disabled")}}}else{if(H.virtualColumnID==2){if(H.model.getCellContent()==o.get("CrossHighlightCellTitle")){var N=H.virtualRowID;var J=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.parentID;var K=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.optionID;t.filterModelerObj._crossHighlight(J,K)}}else{if(H.virtualColumnID==4){var N=H.virtualRowID;var J=H.cellView.options.gridEngine.getTreeNodeModelFromRowID(N).options.rootID;var O=H.cellView.options.gridEngine.getNthRoot(J);if(H.model.getCellContent()==o.get("IgnoreButtonHelp")){var L=-2;t.filterModelerObj._updateResolvedIndex(J,L);t.filterModelerObj._updateAttribute(J,t.filterModelerObj.icon_Solved);H.cellView.options.gridEngine.getNthRoot(J).setAttribute("solutions","");O.collapse();if(t.filterModelerObj.getTreeManager().getNthRoot(J).options.grid.ignore==o.get("IgnoreButtonHelp")){t.filterModelerObj.getTreeManager().getNthRoot(J).setAttribute("ignore",o.get("ReactivateButtonHelp"))}t.manager.updateView();var Q=t.filterModelerObj._checkIfAllPathsResolved();if(Q){t.applyButton.getContent().removeClassName("disabled");t.saveButton.getContent().removeClassName("disabled")}}else{if(H.model.getCellContent()==o.get("ReactivateButtonHelp")){if(O.getNumberOfChildren()==0){t.filterModelerObj._buildAndUpdateSubRoot(J);var G=t.filterModelerObj._removeSubRoot(J);if(G){t.filterModelerObj._updateAttribute(J,t.filterModelerObj.icon_Solved);t.filterModelerObj._updateResolvedIndex(J,0)}}else{var P=-1;t.filterModelerObj._updateResolvedIndex(J,P);t.filterModelerObj._updateAttribute(J,t.filterModelerObj.icon_Broken);O.expand();var Q=t.filterModelerObj._checkIfAllPathsResolved();if(!Q){t.applyButton.getContent().addClassName("disabled");t.saveButton.getContent().addClassName("disabled")}}if(t.filterModelerObj.getTreeManager().getNthRoot(J).options.grid.ignore==o.get("ReactivateButtonHelp")){t.filterModelerObj.getTreeManager().getNthRoot(J).setAttribute("ignore",o.get("IgnoreButtonHelp"))}t.manager.updateView()}}}}}t.manager.updateView()});t.cancelButton.addEvent("onClick",function(){if(t.IsRepairFilterLaunchedInWidget){t.obj={listOfList:"CancelRepair"};t.dispatchEvent("NGF_CancelRepairFilter",t.obj)}else{t.filterModelerObj._webInWinNotification("CancelButton")}});t.saveButton.addEvent("onClick",function(){var G=new m({closable:true,renderTo:document.body,id:"superModaldialog"});G.confirm(o.get("SaveWarning"),o.get("SaveWarningTitle"),function(H){console.log("Confirm result: "+H);if(H){t.filterModelerObj._modifyTreeListModel();t.filterModelerObj._operateFilter("SaveButton")}})});t.applyButton.addEvent("onClick",function(){t.filterModelerObj._modifyTreeListModel();if(t.cancelButton.getValue()==o.get("TitleCancel")){t.cancelButton.setValue(o.get("LabelClose"))}t.filterModelerObj._operateFilter("ApplyButton");t.applyButton.getContent().addClassName("disabled")})}});return h});