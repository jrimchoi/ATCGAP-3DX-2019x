define("DS/i3DXCompass/Tools",["UWA/Core","UWA/Element","UWA/Utils"],function(d,a,b){var c={os:null,browser:null,detectOs:function(){var e=c.getUserAgent().toLowerCase();if(e.indexOf("windows")>-1){c.os=(e.indexOf("windows nt 10")>-1)?"windows10":"windows";return}if(e.match(/(ipad|iphone|ipod)/g)){c.os="ios";return}if(e.indexOf("mac")>-1){c.os="macos";return}if(e.indexOf("android")>-1){c.os="android";return}if(e.indexOf("linux")>-1){c.os="linux";return}c.os="unknown"},isIphone:function(){var e=c.getUserAgent().toLowerCase();return/iphone/i.test(e)},_detectBrowser:function(){var e=b.Client.Engine;if(window.navigator.userAgent.indexOf("Edge")>-1){c.browser="edge"}else{if(e.ie){c.browser="internet explorer"}else{c.browser=e.name}}},getOs:function(){if(!c.os){c.detectOs()}return c.os},getBrowser:function(){if(!c.browser){c._detectBrowser()}return c.browser},getMajorIosVersion:function(){if(!c.iosVersion){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);c.iosVersion=[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)];d.log("iOS version = "+c.iosVersion[0]+"."+c.iosVersion[1]+"."+c.iosVersion[2])}}return c.iosVersion&&c.iosVersion[0]},getUserAgent:function(){return navigator.userAgent},arrayFind:function(f,h,g){var e;f.some(function(i){if(h.call(g,i)){e=i;return true}});return e},forEachOwnProperty:function(h,g,e){var f=Object.keys(h);f.forEach(function(i){g.call(e,h[i],i)})},pushUnique:function(e,f){if(e.indexOf(f)===-1){e.push(f)}},unshiftUnique:function(e,f){if(e.indexOf(f)===-1){e.unshift(f)}},moveToFirst:function(f,g){var e=f.indexOf(g);if(e!==-1){f.unshift(f.splice(e,1)[0])}},includes:function(f,e){return e.every(function(g){return f.indexOf(g)!==-1})},removeDoublons:function(f){var e=[];f.forEach(function(g){c.pushUnique(e,g)});return e},customLaunchWebApp:function(){return false},enableWidgetDrag:function(){},instanciateWidget:function(){},onRoleChange:function(){},setCustomFunction:function(e,f){if(["customLaunchWebApp","enableWidgetDrag","instanciateWidget","onRoleChange"].indexOf(e)>-1){c[e]=f}},disableSelect:function(){a.setStyles.call(document.body,{"-webkit-touch-callout":"none","-webkit-tap-highlight-color":"rgba(0, 0, 0, 0)","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},enableSelect:function(){a.setStyles.call(document.body,{"-webkit-touch-callout":"","-webkit-tap-highlight-color":"","-webkit-user-select":"","-moz-user-select":"","-ms-user-select":"","user-select":""})},isOverElement:function(f,g,e){return f.x>g.x&&f.x<g.x+e.width&&f.y>g.y&&f.y<g.y+e.height},isSameApp:function(f,e){if(b.matchUrl(f,e)){return(b.parseUrl(f).directoryPath||"/").split("/")[1]===(b.parseUrl(e).directoryPath||"/").split("/")[1]}return false},isBase64:function(f){var e=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$");return e.test(f)},isBase64Image:function(e){if(e.indexOf("data:image")>-1&&e.indexOf(";base64,")>-1){e=e.split(";base64,")[1]}return this.isBase64(e)},htmlEntityDecode:function(e){return d.createElement("div",{html:e}).getText()},now:Date.now||function(){return new Date().getTime()},debounce:function(g,i,f){var l,k,e,j,m;var h=function(){var n=c.now()-j;if(n<i&&n>=0){l=setTimeout(h,i-n)}else{l=null;if(!f){m=g.apply(e,k);if(!l){e=k=null}}}};return function(){e=this;k=arguments;j=c.now();var n=f&&!l;if(!l){l=setTimeout(h,i)}if(n){m=g.apply(e,k);e=k=null}return m}},compareVersion:function(g,e){var h,f,j;g=g.split(".");e=e.split(".");f=Math.min(g.length,e.length);for(h=0;h<f;h++){j=parseInt(g[h],10)-parseInt(e[h],10);if(j!==0){return j}}return g.length-e.length},i18n:function(e){var f=d.i18n(e);if(f){f=f.replace("3DEXPERIENCE","<b>3D</b>EXPERIENCE")}return f},isSmartphone:function(){return b.Client.getSize().width<959&&b.Client.getSize().height<570},isValidMarketAppUrl:function(e){return/^[a-z]*:\/\/\?-.*/.test(e)},isOpenFullSize:function(){return b.Client.getSize().width<641}};return c});define("DS/i3DXCompass/Model/Install",["UWA/Core","UWA/Class/Model","UWA/Class/Collection"],function(f,e,c){var a=e.extend({idAttribute:"appsId"}),d=c.extend({model:a}),b=e.extend({isCompatible:function(g){return true},isAvailableForInstallation:function(){return this.get("status")!==5},setup:function(){this._apps=new d(this.get("apps"));this.addEvent("onChange:apps",function(h,g){this._apps.set(g)})},_extractVersion:function(h){var g=h?h.split("."):[];return{release:g.length>0?parseInt(g[0],10):0,fd:g.length>1?parseInt(g[1],10):0,pinpoint:g.length>2?parseInt(g[2],10):0}},_containsPinpoint:function(){var g=this._extractVersion(this.get("SPlevel")),h=this._extractVersion(this.get("targetSPLevel"));return g.pinpoint>0||h.pinpoint>0},_isSameFD:function(){var g=this._extractVersion(this.get("SPlevel")),h=this._extractVersion(this.get("targetSPLevel"));return g.fd===h.fd},_isSameRelease:function(){var g=this._extractVersion(this.get("SPlevel")),h=this._extractVersion(this.get("targetSPLevel"));return g.release===h.release},getInstallationMode:function(){var h="Maintenance",g=this._extractVersion(this.get("SPlevel")),i=this._extractVersion(this.get("targetSPLevel"));if(g&&i&&this._isSameRelease()&&!this._isSameFD()&&this._containsPinpoint()){h="Both"}return h}});return b});define("DS/i3DXCompass/Controls/Search",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip"],function(f,e,c,b){var d=f.i18n,a=e.extend({className:"compass-search",defaultOptions:{typeDelay:500},isActive:false,currentText:"",typeTimeout:null,init:function(g){this._parent(g);this.buildSkeleton()},buildSkeleton:function(){var h=this,g=this.container=f.createElement("div",{"class":this.className}),i=this.elements={};i.button=f.createElement("div",{"class":this.className+"-button fonticon fonticon-search",events:{click:function(){h.dispatchEvent("onToggle")}}}).inject(g);new b({position:"left",target:i.button,body:d("Search")});i.reset=f.createElement("button",{"class":this.className+"-text-reset close fonticon fonticon-clear",styles:{"font-size":"18px"},attributes:{type:"button","aria-hidden":true},events:{click:function(){h.dispatchEvent("onReset")}}});new b({position:"right",target:i.reset,body:d("Clear search")});i.text=new c({className:this.className+"-text",placeholder:d("searchapps"),attributes:{events:{keyup:function(){h.dispatchEvent("onKeyUp")}}}});i.textWrapper=f.createElement("div",{"class":this.className+"-text-wrapper",html:[i.reset,i.text]}).inject(g);g.addClassName(this.className)},onToggle:function(){var g=!this.isActive;this.container.toggleClassName("active",g);if(g){this.elements.text.setFocus()}else{this.dispatchEvent("onReset")}this.isActive=g},onReset:function(){var g=this.elements.text;if(this.currentText!==""){window.clearTimeout(this.typeTimeout);g.setValue("");this.currentText="";this.dispatchEvent("onSearch","")}g.setFocus()},onKeyUp:function(){var g=this;var h=this.elements.text.getValue().toLowerCase();if(h!==this.currentText){this.currentText=h;window.clearTimeout(this.typeTimeout);this.typeTimeout=window.setTimeout(function(){g.dispatchEvent("onSearch",h)},this.options.typeDelay)}},hide:function(){this.container.addClassName("transparent")},show:function(){this.container.removeClassName("transparent")},blur:function(){this.elements.text.setFocus(false)}});return a});define("DS/i3DXCompass/Types",["UWA/Core"],function(c){var a={},b=null;a.get=function(){c.log("get Types");c.log("Types = "+JSON.stringify(b));return b};a.set=function(d){c.log("Set Types");b=d};a.reset=function(){b=null};return a});define("DS/i3DXCompass/Model/Product",["UWA/Core","UWA/Class/Model"],function(c,b){var a=b.extend({});return a});define("DS/i3DXCompass/UsageTracker",["UWA/Core","DS/Usage/TrackerAPI"],function(d,c){function b(g,f,h,e){if(!e&&!h){return g+":"+f}else{if(!e){h=h.replace(/ /g,"");return g+":"+h+":"+f}else{h=h.replace(/ /g,"");return g+":"+h+":"+f+":"+e}}}var a={_IDS:{compass:{quadrant:{north:"compass.quadrant.north",east:"compass.quadrant.east",south:"compass.quadrant.south",west:"compass.quadrant.west",play:"compass.quadrant.play"},cross:"compass.cross",role:"compass.role",roleFavorite:"compass.role.favorite",app:"compass.app",appFavorite:"compass.app.favorite",section:"compass.section"}},inc:function(g,f,h,e){c.getCounter(b(g,f,h,e)).inc()}};return a});define("DS/i3DXCompass/Controls/IframeLoader",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Mask"],function(e,d,b){var c="compass-iframe-loader-failed";var a=d.extend({defaultOptions:{src:"",text:"",timeout:15000,frameId:"3DCommerceRoleDescription"},className:"compass-iframe-loader",init:function(f){this._parent(f);this.buildSkeleton()},buildSkeleton:function(){var f=this.options,g=this.elements=[];g.container=e.createElement("div",{"class":this.className});if(f.src&&f.src!==""&&!this._isUrl(f.src)){this.buildText(f.src)}else{if(f.src&&f.src!==""&&this._isUrl(f.src)&&!this.getFailed()){b.mask(g.container);this.launchTimeout();g.iframe=e.createElement("iframe",{src:f.src,allowfullscreen:true}).inject(g.container)}else{if(f.src&&f.src!==""&&this._isUrl(f.src)&&this.getFailed()){this.buildText();this.launchTimeout();g.iframe=e.createElement("iframe",{src:f.src,"class":"hidden",allowfullscreen:true}).inject(g.container)}else{this.buildText()}}}},buildText:function(f){this.elements.container.setContent(e.createElement("div",{"class":f?this.className+"-text-description":this.className+"-text",html:f||this.options.text}))},_isUrl:function(g){var f=new RegExp("^(https?:\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[\\(\\)-a-z\\d%_.~+]*)*(\\?[\\(\\);&a-z,\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return(f.test(g))},launchTimeout:function(){var h=this,i=this.elements,f=function(){removeEventListener("message",g);clearTimeout(j)},g=function(l){var k=l.data;if(k.id===h.options.frameId){f();if(k.code===0){i.iframe.addClassName("visible");i.iframe.removeClassName("hidden");if(e.typeOf(k.height)==="number"){i.iframe.setStyle("height",k.height)}if(i.container.getElement("."+h.className+"-text")){i.container.getElement("."+h.className+"-text").addClassName("hidden")}}else{h.buildText()}b.unmask(i.container);h.setFailed(false)}},j=setTimeout(function(){f();b.unmask(i.container);h.buildText();h.setFailed(true)},this.options.timeout);addEventListener("message",g)},getFailed:function(){var g;try{g=sessionStorage.getItem(c);return g==="true"}catch(f){e.log(f);return false}},setFailed:function(f){var h=f?"true":"false";try{sessionStorage.setItem(c,h)}catch(g){e.log(g)}}});return a});define("DS/i3DXCompass/Controls/Message",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Spinner"],function(d,c,b){var a=c.extend({options:{className:"compass-overlay"},init:function(){var e=this.elements={text:d.createElement("div",{"class":this.options.className+"-text"}),spinner:new b({className:this.options.className+"-spinner compass-spinner",animate:false})};e.container=d.createElement("div",{"class":this.options.className,styles:{display:"none"},html:[e.text,e.spinner]})},show:function(g,f){var e=this.elements;window.clearTimeout(this.timeoutVar);e.text.setContent(g||"");if(f){e.spinner.show()}else{e.spinner.hide()}e.container.show()},hide:function(e){if(!e){this.elements.container.hide()}else{this.timeoutVar=window.setTimeout(this.hide.bind(this),e)}}});return a});define("DS/i3DXCompass/EventManager",["UWA/Core","UWA/Class","UWA/Class/Events"],function(d,b,a){var c=b.extend(a);return new c()});define("DS/i3DXCompass/Model/Suggestion",["UWA/Core","UWA/Utils","UWA/Class/Model"],function(d,a,c){var b={idAttribute:"productId",setup:function(){}};return c.extend(b)});define("DS/i3DXCompass/X3DContent",["UWA/Core"],function(c){var a={},b={};a.getX3DContent=function(){c.log("get X3DContent");c.log("Content = "+JSON.stringify(b));return b};a.setX3DContent=function(d){c.log("set X3DContent");b=d};return a});define("i3DXCompass/X3DContent",["DS/i3DXCompass/X3DContent"],function(a){return a});define("DS/i3DXCompass/CacheManager",["UWA/Core","UWA/Class","UWA/Utils","UWA/Storage","UWA/Storage/Adapter/Dom"],function(c,b,g,i){var d,a,h="420.1.0",f=24*3600000,e=new i({adapter:"Dom",database:"3DCompass"});return b.singleton({setup:function(j,k){d=j;if(!j){e=null}a=k},setRequestCache:function(k,j){this.setCache(k.url+JSON.stringify(k.data),j)},getRequestCache:function(j){return this.getCache(j.url+JSON.stringify(j.data))},setCache:function(j,k){if(e){try{e.set(this._getKeyUID(j),k)}catch(l){e=null}}},getCache:function(k,m){var j=null;if(!m){m=f}if(e){try{j=e.get(this._getKeyUID(k),m)}catch(l){e=null}}return j},_getKeyUID:function(j){return g.getCheckSum(j+a+d+h)},_getUser:function(){return d}})});define("DS/i3DXCompass/TopBarManager",["UWA/Core"],function(c){var b=c.i18n,a={topBarProxy:null,menu:null,events:{},initialized:false,MenuItem:null,_roles:null,init:function(d){require(["DS/TopBarProxy/TopBarProxy","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuItem"],function(e,g,f){a.menu=new g();a.topBarProxy=new e({id:d.topBarId});a.initialized=true;a.topBarProxy.addContent({profile:[new f({label:b("myroles"),submenu:a.menu,multiSelect:true})]});a.events.onRoleChange=d.onRoleChange;a.MenuItem=f;if(a._roles){a.setRoles(a._roles)}})},setRoles:function(e){var f=a.MenuItem,d;if(!a.initialized){a._roles=e}else{if(a._roles){a._roles=null}d=e.map(function(g){return new f({roleId:g.get("id"),label:g.get("title"),selected:g.get("active"),selectable:true,onExecute:function(h){a.events.onRoleChange(h.get("roleId"),!h.get("selected"))}})});if(e.length>1){a.topBarProxy.setContent({profile:[new f({label:b("myroles"),submenu:a.menu,multiSelect:true})]});a.menu.reset();a.menu.add(d)}else{a.topBarProxy.empty();a.menu.reset()}}},removeRole:function(e){var d=a.getRoleItem(e);if(d){a.menu.remove(d);if(a.menu.length<=1){a.topBarProxy.empty()}}},setChecked:function(e){var d=a.getRoleItem(e);if(d){d.set("selected",e.get("active"))}},containsRole:function(d){return !!a.getRoleItem(d)},getRoleItem:function(d){return a.menu.findWhere({roleId:d.id})}};return a});define("DS/i3DXCompass/View/SuggestionListView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner"],function(d,c,b){var a={className:"suggestion-section",suggestionsRendered:false,attachEvents:function(){var e=this.collection;e.addEvent("onRemove",this.removeSug.bind(this));e.addEvent("onMultipleAdd",this.renderSuggestions.bind(this))},render:function(){var e=this.elements.loader=d.createElement("div",{"class":"compass-loading",html:new b({visible:true,className:"compass-spinner"})});if(this.suggestionsRendered){e.hide()}this.container.addContent(e);return this},renderSuggestions:function(){var f=this.elements,g=this.collection.map(function(h){return{tag:"li","class":"suggestion-item",html:[{tag:"img","class":"suggestion-item-icon",src:h.get("thumbnailUrl")},{"class":"suggestion-item-description",html:[{"class":"suggestion-item-title",text:h.get("title")},{"class":"suggestion-item-baseline",text:h.get("baseline")}]}],"data-id":h.get("productId")}}),e=f.list;if(!e){e=f.list=d.createElement("ul",{"class":"suggestion-list"}).inject(this.container)}e.setContent(g);this.unmask();this.attachEvents();this.suggestionsRendered=true;return this},refresh:function(){var e=this;if(this.suggestionsRendered){this.mask();this.collection.fetch({onComplete:function(){e.unmask()},onFailure:function(){e.unmask()}})}},removeSug:function(e){var f=this.getSugElmt(e);if(f){f.destroy()}},getSugElmt:function(e){return this.getElement(d.String.format('[data-id="{0}"]',e.id))},mask:function(){var e=this.elements.loader;if(e){e.show()}},unmask:function(){var e=this.elements.loader;if(e){e.hide()}}};return c.extend(a)});define("DS/i3DXCompass/InterCom",["UWA/Utils/InterCom","DS/i3DXCompass/Tools"],function(c,b){var a={initialize:function(d,e){var f=a.eventServer=new c.Server(d,{isPublic:true});b.forEachOwnProperty(e,function(h,g){f.addListener(g,h)})},fireEvent:function(d,e){if(a.eventServer){a.eventServer.dispatchEvent(d,e)}}};return a});define("DS/i3DXCompass/View/AppListView",["UWA/Core","UWA/Class/View","DS/i3DXCompass/Tools","DS/UIKIT/Tooltip","DS/i3DXCompass/CacheManager"],function(f,e,c,d,a){var b=e.extend({tagName:"ul",className:"experience-list",setup:function(g){var h=this,i=this.collection;this.tooltips=[];this.customClass=g.customClass;this.favorite=g.favorite;this.draggable=g.draggable;this.customFilters=g.customFilters||{};i.addEvent("onMultipleAdd",this.addMultipleApp.bind(this));i.addEvent("onRemove",this.removeApp.bind(this));i.addEvent("onReorderApp",h.reorderApp.bind(h));i.addEvent("onChange",h.updateItem.bind(h))},render:function(){var g=this.collection.filterApps(this.getFilters());this.cleanTooltips();this.container.setContent(this.buildAppSkeleton(g));if(this.customClass){this.container.addClassName(this.customClass)}this.updateEmptyClass();return this},cleanTooltips:function(){if(this.tooltips.length>0){this.tooltips.invoke("destroy");this.tooltips=[]}},search:function(g){this.setCustomFilter("searched",g);this.render()},filterApps:function(g){this.setCustomFilter("appIds",g);this.render()},setCustomFilter:function(g,h){if(h){this.customFilters[g]=h}else{this.customFilters[g]=null}},buildAppSkeleton:function(h){var g=this,i=[];h.forEach(function(j){i.push(g.buildApp(j))});i.push(f.createElement("li",{"class":"clearfix"}));return i},buildApp:function(n){var h=f.Utils.Client.Features.touchEvents,k,j=n.get("icon"),i=f.createElement("img",{"class":"icon",id:"icon-"+n.get("id"),src:j,events:{error:function(){this.removeEvent("error");this.src=this.src.substring(0,this.src.lastIndexOf("/"))+"/Default_App_Icon.png"},dragstart:function(o){if(this.draggable){o.preventDefault()}}}}),m=f.createElement("div",{text:n.get("title"),"class":"title"}),g=f.createElement("li",{"class":"exp-item"+(this.draggable?" drag-app":"")+(n.isRole()?" role"+(n.get("active")?" active":"")+(n.get("requested")?" requested":""):""),"data-id":n.id,"data-favorite-order":n.get("favoriteOrder"),html:[i,m]}),l=n.get("tooltip")||n.escape("title");if(!h&&l){k=new d({position:"bottom",target:g,delay:{show:1000},body:l});this.tooltips.push(k)}if(n.needSettingsMenu()){this.buildSettingsElmt().inject(g)}if(n.isWidget()){c.enableWidgetDrag(g,n.toJSON());g.addClassName("widget-item")}if(n.isRole()&&n.get("granted")){f.createElement("div",{"class":"expand-img fonticon fonticon-right-open"}).inject(g)}return g},buildSettingsElmt:function(){return f.createElement("div",{"class":"settings-img fonticon fonticon-right-open"})},getFilters:function(){var h=[],g=this.customFilters;if(g.searched){h.push({key:"searched",value:g.searched})}if(g.appIds){h.push({key:"appIds",value:g.appIds})}return h},changeApp:function(g){if(g.matchesFilters(this.getFilters())){this.addAppElmt(g)}else{this.removeAppElmt(g)}},addApp:function(g){if(g.matchesFilters(this.getFilters())){this.addAppElmt(g)}},addMultipleApp:function(g){if(g.length<5){g.forEach(this.addApp,this)}else{this.render()}},reorderApp:function(h){var g;if(h.matchesFilters(this.getFilters())){g=this.addAppElmt(h);if(this.favorite){g.setData("favorite-order",h.get("favoriteOrder"))}}},removeApp:function(g){if(g.matchesFilters(this.getFilters())){this.removeAppElmt(g)}},addAppElmt:function(k){var j=false,h=this.getAppElmt(k)||this.buildApp(k),g=this.collection.getPrevious(k),i;while(!j){if(!g){h.inject(this.container,"top");j=true}else{i=this.getAppElmt(g);if(i){h.inject(i,"after");j=true}else{g=this.collection.getPrevious(g)}}}this.updateEmptyClass();return h},removeAppElmt:function(h){var g=this.getAppElmt(h);if(g){g.destroy()}this.updateEmptyClass()},getAppElmt:function(g){return this.getElement(f.String.format('[data-id="{0}"]',g.get("id")))},updateEmptyClass:function(){if(!this.customFilters.searched&&this.collection.count(this.getFilters())===0){this.container.addClassName("empty")}else{this.container.removeClassName("empty")}},addSettingsElmt:function(h,g){if(g&&!g.getElement(".settings-img")){this.buildSettingsElmt().inject(g)}},removeSettingsElmt:function(i,g){var h=g&&g.getElement(".settings-img");if(h){h.destroy()}},changePlatforms:function(h,g){if(h.needSettingsMenu()){this.addSettingsElmt(h,g)}else{this.removeSettingsElmt(h,g)}},updateItem:function(i){var g=this.getAppElmt(i),h=i._changed;if(g){if(f.is(h.active)){g.toggleClassName("active",h.active)}if(f.is(h.requested)){g.toggleClassName("requested",h.requested)}if(f.is(h.title)){g.getElement(".title").setText(h.title)}if(f.is(h.icon)){g.getElement(".icon").setAttribute("src",h.icon)}if(f.is(h.platforms)){this.changePlatforms(i,g)}if(i.isWidget()&&(f.is(h.title)||f.is(h.icon)||f.is(h.launchInfos)||f.is(h.config))){c.enableWidgetDrag(g,i.toJSON())}}}});return b});define("DS/i3DXCompass/Csrf",["UWA/Core","UWA/Class","DS/WAFData/WAFData","DS/i3DXCompass/Tools"],function(h,b,a,e){var g=null,d=null,c="",f=null;return{initialize:function(i,j){g=i;d=j},request:function(i,p,l){var o={Accept:"application/json","Accept-Language":d},n,m,j="passport",k=function(q){if(typeof l.onFailure==="function"){l.onFailure.apply(this,arguments)}else{h.log("ERROR");h.log(q)}};p={os:e.detectOs()};n=p;m={timeout:15000,method:"GET",type:"json",headers:o,proxy:j,data:n,cache:-1,onComplete:function(r){var q;if((r.code&&r.code!=="0")||r.error){if(r.message&&r.message!==""){q=r.message}else{if(r.error&&r.error.type){q=r.error.type}else{if(r.error){q=r.error}else{q=r}}}if(r.error&&r.error.status==="java.net.SocketTimeoutException: Read timed out"){h.log(h.i18n.get("Action is still pending... Please wait a few seconds and refresh your widget"))}if(typeof l.onFailure==="function"){l.onFailure(r)}else{h.log(q)}}else{if(typeof l.onComplete==="function"){l.onComplete(r)}}},onFailure:k,onTimeout:function(q){h.log(h.i18n.get("Action is still pending... Please wait a few seconds and refresh your widget"));k(q)}};return a.authenticatedRequest(i,m)},formatUrl:function(i){return i.indexOf("http")===0?i:g+c+i},getTokenCSRF:function(){return f},getOrGenerateTokenCSRF:function(k){var j=function(l){h.log(l);f=l["X-DS-CSRFTOKEN"];if(k&&k.context.request){k.context.request(k.options)}},i=function(l){h.log(l);f=null;if(k&&k.callbacks&&typeof k.callbacks.onFailure==="function"){k.callbacks.onFailure(l)}};f="Pending";this.request(this.formatUrl("security/csrf"),{},{onComplete:j,onFailure:i})}}});define("DS/i3DXCompass/Data",["UWA/Core","UWA/Utils","UWA/Ajax","UWA/Data","DS/i3DXCompass/InterCom","DS/i3DXCompass/EventManager","DS/WebappsUtils/WebappsUtils","DS/WAFData/WAFData","DS/i3DXCompass/CacheManager","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompass/Tools","UWA/Storage","DS/i3DXCompass/Csrf","UWA/Storage/Adapter/Object"],function(i,c,n,f,r,o,g,a,s,j,b,q,h){var e,p,k=i.i18n,d,m=function(){if(typeof d==="undefined"){if(window.location.search.indexOf("debug")!==-1){d=true}else{d=false}}return d===false?null:true},l={root:null,saveSectionTimeout:0,initialize:function(w,t){w.myAppsBaseUrl=w.myAppsBaseUrl.replace("/resources/AppsMngt","");var u=w.myAppsBaseUrl.replace(/\/$/,"")+"/resources/AppsMngt/";h.initialize(u,w.lang);this.myAppsBaseUrl=u;this.getAppsUrl=u+"apps/compass";if(w.userId){if(typeof compassRichWithCef!=="undefined"){this.getAppsUrl=u+"apps/compass"}else{this.getAppsUrl=u+"apps/compass"}}else{this.getAppsUrl=u+"apps/public/compass"}if(w.addinMode){this.addinMode=w.addinMode;try{localStorage.setItem("3DCompass-addinMode",JSON.stringify(w.addinMode))}catch(x){}}else{try{var v=localStorage.getItem("3DCompass-addinMode");if(v){this.addinMode=JSON.parse(v)}}catch(x){}}s.setup(w.userId,w.lang);this.setPreferencesUrl=u+"user/setPreferences";this.getPreferencesUrl=u+"user/getPreferences";this.setFavoriteUrl=u+"user/setFavorite";this.setSectionUrl=u+"apps/compass/section";this.getProcessDetailsUrl=u+"apps/licenses";this.requestRoleUrl=u+"role/request";this.tryRoleUrl=u+"role/try";this.encryptUrl=u+"security/encrypt";this.decryptUrl=u+"security/decrypt";this.getSuggestionsUrl=u+"role/suggestions";this.getAppInfoUrl=u+"apps";if(w.passportUrl){this.passportUrl=w.passportUrl}this.onlineInstallUrl=null;this.buildTransactionId=null;e=i.extend({},w);this.root=t;this.lang=w.lang;o.dispatchEvent("onInitialized")},request:function(t){var x=this,z={Accept:t.Accept||"application/json","Accept-Language":e?e.lang:null},y,u,w,v=t.proxy;if((t.method==="POST"||t.method==="PUT")&&t.contentType){z["Content-Type"]=t.contentType;z["X-DS-CSRFTOKEN"]=h.getTokenCSRF()}if(t.headers){z=i.merge(z,t.headers)}w=function(B,A){if((B&&((B.code&&B.code.indexOf&&B.code.indexOf("CSRF")!==-1)||(B.indexOf&&B.indexOf("CSRF")!==-1)))||(A&&((A.code&&A.code.indexOf&&A.code.indexOf("CSRF")!==-1)||(A.indexOf&&A.indexOf("CSRF")!==-1)))){h.getOrGenerateTokenCSRF({context:x,options:t})}else{if(t.onFailure){if(A){t.onFailure(A)}else{t.onFailure(B)}}}};y={timeout:t.timeout!==undefined?t.timeout:15000,cache:l._getCacheLevel(t),method:t.method||"GET",type:t.type||"json",headers:z,proxy:(v==="none"||!s._getUser())?null:(v||"passport"),data:t.postData,onComplete:t.onComplete,onFailure:w};if(t.urlParams){t.urlParams.debug=m()}u=t.url+(t.urlParams?"?"+c.toQueryString(t.urlParams):"");if(l._isCorsAvailable(t)||(t.urlParams&&t.urlParams.cors)){return y.proxy==="passport"?a.authenticatedRequest(u,y):a.request(u,y)}else{return f.request(u,y)}},_getCacheLevel:function(u){var v=b.getBrowser(),t=0;if(v==="internet explorer"||v==="edge"){t=-1}return u.cache!==undefined?u.cache:t},get3DDashboardUrl:function(t){var u=this;if(this.dashboardUrl){if(t){t(this.dashboardUrl)}}else{j.getServiceUrl({serviceName:"3DDashboard",onComplete:function(w){var v;if(w.length>0){v=w.detect(function(x){return x.url});if(v){u.dashboardUrl=v.url}}if(t){t(u.dashboardUrl)}}})}},setPreferences:function(u){var t={url:l.setPreferencesUrl,urlParams:u,onComplete:function(v){if(v.code===0){o.dispatchEvent("onShowMessage",[v.message,5000])}else{o.dispatchEvent("onShowMessage",[v.message||k("errorsavingpreferences"),5000])}},onFailure:function(v){o.dispatchEvent("onShowMessage",[(v&&v.message)||k("errorsavingpreferences"),5000])}};l.request(t)},saveSectionStatus:function(t){var u=this;clearTimeout(l.saveSectionTimeout);l.saveSectionTimeout=setTimeout(function(){l.request({method:"PUT",url:l.setSectionUrl,contentType:"application/x-www-form-urlencoded",postData:{name:"value",value:t},cache:null})},1100)},setPreference:function(u){var t={url:l.setPreferencesUrl,urlParams:{name:u.name,value:u.value},cache:null,onComplete:function(v){if(v&&v.code===0){if(u&&u.onComplete){u.onComplete()}}else{if(u&&u.onFailure){u.onFailure()}}},onFailure:function(w,v){if(u&&u.onFailure){u.onFailure()}}};l.request(t)},getCasTgc:function(t){var x=this,A=(b.getOs()==="ios"),u={timeout:15000,method:"GET",type:"json",onFailure:function(){t.onComplete()}},v,C=null,y=5000,B=function(J){var I=c.encodeUrl(c.buildUrl(window.location,g.getWebappsBaseUrl()+"i3DXCompass/gettgc.html")),D=e.passportUrl.replace(/\/$/,"")+"/",G=c.buildUrl(D,"cas/getcastgc?userid="+e.userId+"&service=V6&ticket="+J+"&callback="+I),F,E=new RegExp("castgc=(.*-cas)");u.type="text";u.onComplete=function(L){if(L.data){L=JSON.parse(L.data);if(L.target==="com.ds.compass"){v.destroy();window.removeEventListener("message",u.onComplete);if(L.castgc==="notgc"){t.onComplete()}else{if(A){p=L.castgc}else{x.storage.set("casTGC",L.castgc)}t.onComplete(L.castgc)}}}else{if(E.test(L)){i.log("CORS request succeeded");var K=E.exec(L);if(A){p=K[1]}else{x.storage.set("casTGC",K[1])}t.onComplete(K[1])}else{t.onComplete()}}};u.onFailure=function(K){t.onComplete()};try{a.request(G,u)}catch(H){i.log("CORS request failed");window.addEventListener("message",function(K){x.storage.set("casTGC",K);u.onComplete(K)});v=i.createElement("iframe",{src:G,"class":"tgc-frame",styles:{border:"none",width:"0px",height:"0px"}}).inject(l.root)}},w=function(){u.onComplete=function(D){if(D.result){B(D.result)}else{t.onComplete()}};a.request(e.proxyTicketUrl+(new Date().getTime()),u)};if(!this.storage){this.storage=new q({adapter:"Object",database:"compass"})}if(A){if(p){t.onComplete(p)}else{try{p=x.storage.get("casTGC",y)}catch(z){}w()}}else{try{C=x.storage.get("casTGC",y)}catch(z){}if(C){t.onComplete(C)}else{w()}}},getCasTransientUrl:function(v){var y={timeout:15000,method:"GET",type:"json",onFailure:function(){v.onComplete()}},u,t=e.passportUrl.replace(/\/$/,"")+"/",w=c.buildUrl(t,"api/authenticated/cas/transient");y.type="json";y.onComplete=function(B){var A;if(B){try{B=JSON.parse(B);if(B.x3ds_reauth_url){A=B.x3ds_reauth_url}}catch(z){i.log("Authentication issue");i.log(z)}}v.onComplete(A)};y.onFailure=function(){v.onComplete()};try{u=n.getRequest(w,y);u.withCredentials=true;u.send()}catch(x){i.log("CORS FAIL: getTransientUrl");v.onComplete("")}},getCasTgcAndCasTransientUrl:function(u){var x,v,t=2,w=function(){t--;if(t===0){if(!i.is(x)||!i.is(v)){o.dispatchEvent("onShowMessage",k("sessionExpirationTitle"));j.getPlatformServices({onComplete:function(y){i.log(y)}})}else{u.onComplete(x,v)}}};this.getCasTgc({onComplete:function(y){x=y;w()}});this.getCasTransientUrl({onComplete:function(y){v=y;w()}})},_isCorsAvailable:function(t){return t.url.indexOf(l.myAppsBaseUrl)>-1}};return l});define("DS/i3DXCompass/ServiceApi/UserStartupApi",["UWA/Core","DS/i3DXCompass/Data","DS/i3DXCompass/CacheManager"],function(g,n,z){var i=20000,d=4*3600000,b,j="user/startup",f,c=false,m=false,k,e,x=[],p,q=function(){var A=a();return A?(A+j):null},a=function(){return n.myAppsBaseUrl||p},h=function(A){A=A||"";return q()+e+A},y=function(A){if(!b){b=z.getCache(h(A),d)}return b},t=function(){var A=y();return A?A.split("@@@")[0]:null},l=function(A){var B=y(A);return B?JSON.parse(B.split("@@@")[1]):null},w=function(B,C,A){z.setCache(h(A),B+"@@@"+JSON.stringify(C))},r=function(A){x.forEach(function(B){if(B[A]){setTimeout(B[A],0,f)}});x.length=0},o=function(B){if(!q()&&((B.config&&B.config.myAppsBaseUrl)||(typeof COMPASS_CONFIG!=="undefined"&&COMPASS_CONFIG.myAppsBaseUrl))){if(B.config&&B.config.myAppsBaseUrl){p=B.config.myAppsBaseUrl}else{p=COMPASS_CONFIG.myAppsBaseUrl}p=p.replace("/resources/AppsMngt","");p=p.replace(/\/$/,"")+"/resources/AppsMngt/"}if(B.config&&B.config.userId&&B.config.lang){z.setup(B.config.userId,B.config.lang)}if(!q()){throw new Exception("No url found for myAppsBaseUrl")}m=true;f=l(B.platform);var A={cors:true,platform:B.platform};if(!g.is(B.platform)){A.roles=true}n.request({url:q(),urlParams:A,headers:{"Accept-Language":B&&B.config?B.config.lang:null,"Last-Modified":t()},onComplete:function(D,E){var C=E&&(E["Last-Modified"]||E["Last-Modified".toLowerCase()]);c=true;if(D){if(E&&C&&D.code===0&&D.pending===false){w(C,D,B.platform)}f=D}r("onComplete");m=false},onFailure:function(){if(f){r("onComplete")}else{r("onFailure")}m=false}})},s=function(B){var A=Date.now();if(c&&(!k||(A-k<i))){B.onComplete(f)}else{k=A;x.push({onComplete:B.onComplete,onFailure:B.onFailure});if(!m){o(B)}}},u=function(){f=undefined;c=false;m=false};var v={fetch:function(A){if(!A||g.typeOf(A.onComplete)!=="function"){return}if(A.config&&A.config.userId){e=A.config.userId}s({platform:A.platform,config:A.config,onComplete:A.onComplete,onFailure:A.onFailure})}};return v});define("DS/i3DXCompass/DaemonManager",["UWA/Core","UWA/Utils","UWA/Json","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data","DS/i3DXCompass/Tools","DS/UIKIT/Alert","DS/UIKIT/Modal","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Spinner","DS/UIKIT/Popover"],function(k,f,d,A,s,e,o,c,w,r,n,y){var l=103,m=104,u="3DEXPERIENCELauncher.msi",a="isDaemonBusy",g="discoverAllInstall",j="startV6install",i="createShortcutFromV6Install",b="installMedia",x="uninstall",h="selfUpdate",q="installCnt",C=[g,j,i,b,h,x],p=e.i18n,B=null,v="-file",z=null,t={version:"1.0",msi:"0",frameId:"16086506-8109-4ac5-82d6-3e2f550fd401",ports:{local:[20300,33200,40600,20300,33200,40600],myApps:undefined},daemonBase:"https://dslauncher.3ds.com",defaultFramePort:4444,framePort:null,framePath:"{0}:{1}/iframe?version={2}&id={3}#origin:{4}",frameOrigin:"{0}:{1}",frame:null,catEnvConfig:null,functionPath:"{0}:{1}/{2}?version={3}&castgc={4}&cryptws={5}&arg={6}&x3ds_transient_auth_url={7}",functionPathNoCrypt:"{0}:{1}/{2}?version={3}&arg={4}",requestPath:"{0}:{1}/{2}",origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+(window.location.pathname?"/"+window.location.pathname:""),timeout:2500,storageId:"compass-daemon-port",dpInfo:null,installing:false,installed:false,init:function(E,F){var D=parseInt(localStorage.getItem(t.storageId),10),G=t.ports.local;if(k.is(D,"number")){if(G.indexOf(D)===-1){e.unshiftUnique(G,D)}else{e.moveToFirst(G,D)}}t.root=E;t.cloud=F},getFramePath:function(D){return k.String.format(t.framePath,t.daemonBase,D,t.version,t.frameId,encodeURIComponent(t.origin))},getFrameOrigin:function(){return k.String.format(t.frameOrigin,t.daemonBase,t.framePort)},parseMessage:function(D){return D},cryptArg:function(D){s.request({url:s.encryptUrl,method:"POST",type:"text",Accept:"text/plain",contentType:"application/x-www-form-urlencoded",postData:{value:D.arg},timeout:600000,onComplete:function(E){s.getCasTgcAndCasTransientUrl({onComplete:function(G,F){D.onComplete({encrypted:E,tgc:G||"",x3dAuthUrl:F||""})}})},onFailure:function(E){k.log(E);D.onFailure()}})},buildMessage:function(F){var E,H=F.data,G=H.arg.functionName,D;if(G===a){E=k.String.format(t.requestPath,t.daemonBase,t.framePort,H.arg.functionName);F.onComplete({id:H.id,data:E})}else{D=d.encode(H.arg);if(C.indexOf(G)===-1){E=k.String.format(t.functionPathNoCrypt,t.daemonBase,t.framePort,"function",t.version,encodeURIComponent(D));F.onComplete({id:H.id,data:E})}else{t.cryptArg({arg:D,onComplete:function(I){E=k.String.format(t.functionPath,t.daemonBase,t.framePort,"function",t.version,encodeURIComponent(I.tgc),encodeURIComponent(s.decryptUrl),encodeURIComponent(I.encrypted),encodeURIComponent(I.x3dAuthUrl));F.onComplete({id:H.id,data:E})},onFailure:F.onFailure})}}},request:function(E){var I,J,H,F=E.onFailure||function(){},D=function(){if(J){window.removeEventListener("message",J)}},G=function(){H=f.getUUID();J=function(L){var K=t.parseMessage(L.data),N=K.id,M=K.data;if(N===H){D();if(M.returnCode===0){E.onComplete(M.content)}else{if(M.returnCode===l||M.returnCode===m){t.showUpgradeModal({onComplete:function(){t.request(E)},onFailure:F})}else{F({returnCode:M.returnCode,commentary:M.commentary})}}}};window.addEventListener("message",J);I={id:H,arg:{functionName:E.functionName,params:E.params||{}}};t.buildMessage({data:I,onComplete:function(K){k.log(K);t.frame.contentWindow.postMessage(K,t.getFrameOrigin())},onFailure:F});k.log(I)};if(!t.installing){if(t.installed){G()}else{t.installDaemon({onComplete:function(){G()},onFailure:F,silent:E.silent})}}},installDaemon:function(F){k.log("install daemon");var D=0,H=t.ports.local,E=H[D],G=function(){if(F.silent!==true){t.getDpInfo({onComplete:function(J){t.showModal(F,J.url)}})}else{k.log("launchApp event: silent mode is activated");t.installing=false;F.onFailure({})}},I={silent:F.silent,onComplete:F.onComplete,onFailure:F.onFailure,onPortFailure:function(){var J=t.ports.myApps;D++;if(D<H.length){E=H[D];t.installDaemonOnPort(I,E)}else{if(D===H.length){if(k.is(J,"number")){t.installDaemonOnPort(I,J)}else{if(J===null){G()}else{s.request({url:s.getPreferencesUrl,type:"text",urlParams:{name:t.storageId},onComplete:function(L){var K=parseInt(L,10);if(k.is(K,"number")&&H.indexOf(K)===-1){J=t.ports.myApps=K;t.installDaemonOnPort(I,J)}else{t.ports.myApps=null;G()}},onFailure:function(){G()}})}}}else{G()}}}};t.installDaemonOnPort(I,E)},installDaemonOnPort:function(F,E,D){var I,H,G;t.installing=true;G=function(K){var L=t.parseMessage(K.data),M,J;if(L.id===t.frameId){k.log("iframe loaded");window.removeEventListener("message",G);window.clearTimeout(H);if(K.origin){M=K.origin.split(":");if(M.length>=2){J=parseInt(M[2],10)}if(J!==E){t.frame.src=t.getFramePath(J);E=J}}t.framePort=E;localStorage.setItem(t.storageId,t.framePort);if(D){s.request({url:s.setPreferencesUrl,urlParams:{name:t.storageId,value:t.framePort}})}t.installing=false;t.installed=true;k.log("Daemon MSI version: "+L.data.msi);k.log("Daemon version: "+L.data.daemon);t.msi=L.data.msi||t.msi;t.version=L.data.daemon||t.version;if(F.silent!==true){t.getDpInfo({onComplete:function(O){var N=O.version,P=O.options?(O.options&&O.options.forceUpdate!==true):true;if(N===null||e.compareVersion(t.msi,N)>=0){F.onComplete()}else{if(F.onOutdated){F.onOutdated();F.onOutdated=undefined}if(L.data.daemon&&e.compareVersion(t.version,"2.0")>=0){t.showSelfUpdateModal(F,P)}else{t.showUpgradeModal(F,true)}}k.log("DP version: "+N)}})}else{if(F.onComplete){F.onComplete()}}}};window.addEventListener("message",G);H=window.setTimeout(function(){k.log("frame not loaded:"+t.getFramePath(E));window.removeEventListener("message",G);I.destroy();F.onPortFailure()},t.timeout);I=t.frame=k.createElement("iframe",{src:t.getFramePath(E),"class":"daemon-frame",styles:{border:"none",width:"0px",height:"0px"}}).inject(t.root)},uninstallDaemon:function(){t.frame.destroy();t.installed=false},showModal:function(F,H){var P=F.onComplete,Q=F.onFailure,L=new r({value:p("continue"),disabled:true,events:{onClick:function(){var V=parseInt(U.getValue(),10);if(k.is(V,"number")){M.show();F.onComplete=function(){N.hide();P()};F.onPortFailure=function(){N.getContent().getElement(".modal-content").addClassName("failure");G.setStyle("height",O.getSize().height+16);M.hide()};F.onOutdated=function(){N.hide()};t.installDaemonOnPort(F,V,true)}else{F.onComplete=P;F.onFailure=Q;F.onOutdated=undefined;A.dispatchEvent("onShowMessage",["",30000,true]);N.hide();t.installDaemon(F)}}}}),U=new w({value:t.framePort,className:"daemon-port-input",events:{onChange:function(){L.enable();L.setClassName("primary")},onClick:function(){L.enable();L.setClassName("primary")},onKeyDown:function(){L.enable();L.setClassName("primary")}}}),M=k.createElement("div",{"class":"compass-loading",styles:{display:"none"},html:new n({visible:true,className:"compass-spinner"})}),K=k.createElement("div",{tag:"span","class":"fonticon fonticon-info-circled"}),D,S=k.createElement("div",{tag:"span","class":"fonticon fonticon-info-circled"}),I,R="large block download-daemon-btn",J=H?k.createElement("div",{"class":"download-wrapper",html:[{tag:"div","class":"compass-java-desc",html:p("launcherfirstvisit")},{tag:"ul",html:[{tag:"li","class":"compass-java-desc",text:p("downloadlauncherclicking")},new r({value:e.htmlEntityDecode(p("downloadlauncher")),className:"primary "+R,events:{onClick:function(){window.open(H);this.disable();this.setClassName("default "+R);L.enable();L.setClassName("primary")}}}),{tag:"li","class":"compass-java-desc",text:k.String.format(p("installlauncherrunning"),u)},{tag:"li","class":"compass-java-desc",html:[k.String.format(p("clickcontinue"),"<b>","</b>"),{text:p("youcaninstallrun")}]}]}]}):k.createElement("div",{"class":"compass-java-desc",html:p("downloadlauncheradmin")}),T=k.createElement("div",{"class":"more-wrapper",html:[{tag:"div","class":"compass-java-desc",html:p("alreadyinstalledlauncher")},{tag:"ul",html:[{tag:"li","class":"compass-java-desc",html:[p("launcherdiagnostics"),K]},{tag:"li","class":"compass-java-desc",html:[p("portchanged"),{"class":"change-port",html:[{tag:"span",text:p("changeport")},U,S]}]}]}]}),E=k.createElement("div",{"class":"more-container",styles:{height:0},html:T}),O=k.createElement("div",{"class":"compass-java-desc alert-message alert-error",html:[p("portunreachable")]}),G=k.createElement("div",{"class":"alert-wrapper",html:O}),N=new c({className:"compass-modal daemon-wrapper-modal",closable:true,visible:true,events:{onHide:function(){t.installing=false;N.destroy()}},header:"<h4>"+p("welcomelauncher")+"</h4>",body:k.createElement("div",{"class":"daemon-modal",html:[G,J,{"class":"divider"},new r({value:p("troubleshootbtn"),icon:"right-dir",className:"link",events:{onClick:function(){this.setFocus(false);E.toggleClassName("open");if(E.hasClassName("open")){this.setIcon("down-dir");E.setStyle("height",T.getSize().height+16)}else{this.setIcon("right-dir");E.setStyle("height","")}}}}),E,M]}),footer:[L,{tag:"button","class":"btn btn-default",text:p("cancel"),events:{click:function(){N.hide()}}}]}).inject(document.body);D=new y({target:K,className:"compass-popover list-style-type-disc",position:"right",trigger:"hover",body:[{tag:"li",html:k.String.format(p("checksystrayicon"),'<span class="compass-systray"></span>')},{tag:"li",html:p("dontseelaunchermenu")}]});I=new y({target:S,className:"compass-popover list-style-type-decimal",position:"right",trigger:"hover",body:{tag:"ul",html:[{tag:"li",html:k.String.format(p("clicksystrayicon"),'<span class="compass-systray"></span>')},{tag:"li",text:p("copyportnumber")},{tag:"li",text:p("pasteportnumber")},{tag:"li",html:k.String.format(p("clickcontinue"),"<b>","</b>")}]}});A.dispatchEvent("onHideMessage")},showUpgradeModal:function(H,I){var F=false,J=false,E=t.dpInfo?t.dpInfo.url:null,G="large block download-daemon-btn",D=new r({value:p("continue"),disabled:true,events:{onClick:function(){F=true;A.dispatchEvent("onShowMessage",["",30000,true]);K.hide()}}}),K=new c({className:"compass-modal",closable:true,visible:true,events:{onHide:function(){K.destroy();if(F){if(J){H.onComplete()}else{t.uninstallDaemon();t.installDaemon(H)}}else{t.uninstallDaemon()}}},header:"<h4>"+p("launcherupdate")+"</h4>",body:k.createElement("div",{"class":"daemon-modal",html:E?[{tag:"div","class":"compass-java-desc",html:k.String.format(p("updateinfos"),"","",t.dpInfo.version,(t.dpInfo.size/1000000).toFixed(2))},{tag:"div","class":"compass-java-desc",text:"1. "+p("downloadupdateclicking")},new r({value:e.htmlEntityDecode(p("downloadlauncher")),className:"primary "+G,events:{onClick:function(){window.open(E);this.disable();this.setClassName("default "+G);D.enable();D.setClassName("primary")}}}),{tag:"div","class":"compass-java-desc",text:k.String.format("2. "+p("installupdaterunning"),u)},{tag:"div","class":"compass-java-desc",html:k.String.format("3. "+p("clickcontinue"),"<b>","</b>")}]:{tag:"div","class":"compass-java-desc",text:p("updatelauncheradmin")}}),footer:E?[D,I?new r({value:p("proceedanyway"),events:{onClick:function(){F=true;J=true;A.dispatchEvent("onShowMessage",["",30000,true]);K.hide()}}}):null]:null}).inject(document.body);A.dispatchEvent("onHideMessage")},showSelfUpdateModal:function(L,E){var D=false,I=false,J=t.dpInfo?t.dpInfo.url:null,G="large block download-daemon-btn",H=new r({value:p("continue"),disabled:true,events:{onClick:function(){D=true;A.dispatchEvent("onShowMessage",["",30000,true]);K.hide()}}}),F=new r({value:p("proceedanyway"),events:{onClick:function(){D=true;I=true;A.dispatchEvent("onShowMessage",["",30000,true]);K.hide()}}}),K=new c({className:"compass-modal",closable:true,visible:true,events:{onHide:function(){K.destroy();if(D){if(I){L.onComplete()}else{t.uninstallDaemon();t.installDaemon(L)}}else{t.uninstallDaemon()}}},header:"<h4>"+p("launcherupdate")+"</h4>",body:k.createElement("div",{"class":"daemon-modal",html:J?[{tag:"div","class":"compass-java-desc",html:k.String.format(p("updateinfos"),'<a href="'+t.dpInfo.url+'">',"</a>",t.dpInfo.version,(t.dpInfo.size/1000000).toFixed(2))},{tag:"div","class":"compass-java-desc",text:"1. "+p("startselfupdateclicking")},new r({value:p("startselfupdate"),className:"primary "+G,events:{onClick:function(){var M=this;F.disable();t.selfUpdate({onComplete:function(){H.enable();H.setClassName("primary")},onFailure:function(N){k.log("Self update failed with code "+N.returnCode+" ("+N.commentary+")");new o({visible:true}).inject(K.getBody(),"top").add({className:"error",message:p("selfupdateerror")});M.enable();M.setClassName("primary "+G)}});this.disable();this.setClassName("default "+G)}}}),{tag:"div","class":"compass-java-desc",text:"2. "+p("selfupdaterunning")},{tag:"div","class":"compass-java-desc",html:k.String.format("3. "+p("clickcontinue"),"<b>","</b>")}]:{tag:"div","class":"compass-java-desc",text:p("updatelauncheradmin")}}),footer:J?[H,E?F:null]:null}).inject(document.body);A.dispatchEvent("onHideMessage")},selfUpdate:function(D){D.functionName=h;if(!D.params){D.params={}}D.params.url=t.dpInfo.url;D.params.hash=t.dpInfo.md5;D.params.size=t.dpInfo.size;t.request(D)},discoverAllInstall:function(D){D.functionName=g;t.request(D)},startV6install:function(D){D.functionName=j;if(!D.params){D.params={}}D.params.fileArgStrings=[];if(B){D.params.fileArgStrings.push({name:v,content:B});this._addOpenFromWebArg(D);this._removeObjectFromLaunchInfos(D)}if(D.file&&D.file.name&&D.file.content){D.params.fileArgStrings.push({name:D.file.name,content:D.file.content});this._addOpenFromWebArg(D);this._removeObjectFromLaunchInfos(D)}k.log(D.params.fileArgStrings);k.merge(D.params,t._getCatEnvInformation(D.params));t.request(D)},_getCatEnvInformation:function(G){var D={};if(t.catEnvConfig){var E=G.argString.match(/-tenant=([^ ]+)/),F=null;if(E&&E.length>1){F=E[1];D=t.catEnvConfig.detect(function(H){return H.id===F})}else{if(t.catEnvConfig.length>0){D=t.catEnvConfig[0]}}if(D){D={dirEnv:D.direnv,catEnvFileName:D.env}}}return D},_addOpenFromWebArg:function(D){if(D&&D.params&&D.params.argString){D.params.argString+=" -e CATUNILoadFromWebCmdHdr Open"}},_removeObjectFromLaunchInfos:function(D){if(D&&D.params&&D.params.argString&&D.params.argString.indexOf("-object")>-1){D.params.argString=D.params.argString.replace(/ -object ([^ ]+)/,"")}},createV6Shortcut:function(H,J){var F=J.get("icon"),K=e.isBase64Image(F)?F:F.substring(F.lastIndexOf("/")+1,F.lastIndexOf(".")),E=" - "+H.get("name"),D,I=e.htmlEntityDecode(J.get("title")),G=J.get("tooltip")?e.htmlEntityDecode(J.get("tooltip")):I;A.dispatchEvent("onShowMessage",k.String.format(p("creatingshortcut"),G));D={functionName:i,params:{instID:H.get("daemonId"),exeName:J.get("exeName"),argString:J.getShortcutLaunchInfos(),scName:I+E,iconRelPath:K,scDesc:G+E,nativeLauncherName:J.get("launcher")},onComplete:function(){A.dispatchEvent("onShowMessage",p("shortcutcreated"));A.dispatchEvent("onHideMessage",5000)},onFailure:function(L){k.log(L);A.dispatchEvent("onShowMessage",p("shortcutcreatingerror"));A.dispatchEvent("onHideMessage",5000)}};k.merge(D.params,t._getCatEnvInformation(D.params));t.request(D)},uninstallMedia:function(D){D.functionName=x;t.request(D)},installMedia:function(D){D.functionName=b;t.request(D)},isDaemonBusy:function(D){D.functionName=a;t.request(D)},getDpInfo:function(D){if(!t.cloud){D.onComplete({version:null})}else{if(t.dpInfo){D.onComplete(t.dpInfo)}else{s.request({url:s.onlineInstallUrl,proxy:"ajax",method:"POST",contentType:"application/json",postData:JSON.stringify({id:(new Date().getTime()),method:"ResourcesV2::check",params:{type:u,refine:s.buildTransactionId}}),onComplete:function(E){t.dpInfo=E.result;D.onComplete(t.dpInfo)},onFailure:function(){D.onComplete({version:null})}})}}},setStructure:function(D){B=D},resetStructure:function(){B=null},setLauncherConfig:function(E){var F=E.split(":"),D=parseInt(F[F.length-1],10);if(D){localStorage.setItem(t.storageId,D);E=E.replace(":"+D,"")}t.daemonBase=E},setCatEnvConfig:function(D){t.catEnvConfig=D}};return t});define("DS/i3DXCompass/Controls/Compass",["UWA/Core","UWA/Event","UWA/Utils/Client","UWA/Controls/Abstract","DS/i3DXCompass/Tools","DS/UIKIT/Tooltip","DS/i3DXCompass/UsageTracker","DS/i3DXCompass/Data","DS/i3DXCompassServices/i3DXCompassPubSub"],function(c,i,a,d,b,e,h,f,j){var g={defaultOptions:{defaultQuadrant:"north",useQuadrantsOnTouch:true},slideTimeout:0,quadrantNames:{north:"",east:"",south:"",west:"",play:""},offsets:{north:{x:32,y:20},east:{x:64,y:32},south:{x:32,y:64},west:{x:20,y:32},play:{x:40,y:40}},tooltipsOffsets:{north:[{x:14,y:-23},{x:-12,y:-20}],east:[{x:30,y:0},{x:15,y:15}],south:[{x:14,y:23},{x:-12,y:32}],west:[{x:-20,y:0},{x:-37,y:17}],play:[{x:14,y:0},{x:0,y:5}]},quadrantAction:"Click",currentQuadrant:null,highlightedQuadrant:null,open:false,closable:true,typeCompassView:"compassBase",activePlay:false,playParam:false,init:function(k){this._parent(k);if(c.is(k.closable)){this.closable=k.closable}this.buildSkeleton()},buildSkeleton:function(){var l=this.elements={},k=this;l.compassSmallOver=c.createElement("div",{"class":"compass-small-over"});l.compassQuadrantPlay=c.createElement("div",{"class":"quadrant-play"});l.compassQuadrantPlaySmall=c.createElement("div",{"class":"quadrant-play-small"});l.compassSmall=c.createElement("div",{"class":"compass-small",html:[l.compassSmallOver,l.compassQuadrantPlaySmall],events:{click:function(m){k.dispatchEvent("onCompassSmallClick",[m,a.Features.touchEvents])},mousemove:function(m){k.dispatchEvent("onCompassSmallOver",[m])},mouseout:function(){k.dispatchEvent("onCompassSmallOut")}}});l.compassOver=c.createElement("div",{"class":"compass-over"});l.compassOn=c.createElement("div",{"class":"compass-on"});l.compassBase=c.createElement("div",{"class":"compass-base",html:[l.compassOver,l.compassOn,l.compassQuadrantPlay],events:{click:function(m){k.dispatchEvent("onCompassBaseClick",[m])},mousemove:function(m){k.dispatchEvent("onCompassBaseOver",[m])},mouseout:function(){k.dispatchEvent("onCompassBaseOut")},transitionEnd:k.updateOpenState.bind(k)}});l.tooltip=new e({target:l.compassSmall,position:"right",className:"compass-small-tooltip"});this.container=l.container=c.createElement("div",{"class":"compass-ct",html:[l.compassSmall,l.compassBase]})},getQuadrant:function(s,r,l,k,o,t){var p=s-r>0,n=s+r-t>0,m=t/2,q=(s-m)*(s-m)+(r-m)*(r-m);if(q<k){if(q<l){return"play"}return null}if(q>o){return null}if(p){if(n){return"east"}return"north"}if(n){return"south"}return"west"},onCompassSmallClick:function(o,p){var k,n,l,m=this;if(b.isSmartphone()){this.switchCompassView(false)}else{if(p&&!this.options.useQuadrantsOnTouch){this.clickQuadrant(this.currentQuadrant||this.options.defaultQuadrant)}else{c.log("click compass: clientX "+o.clientX+"; clientY "+o.clientY);k=i.getPosition(o);n=this.elements.compassSmall.getOffsets();l=this.getQuadrant(k.x-n.x,k.y-n.y,256,256,1024,64);if(l){this.quadrantAction="Open";if(l==="play"&&!this.isPlayEvent(l)){if(this.currentQuadrant==="play"){this.currentQuadrant=this.options.defaultQuadrant}this.clickQuadrant(this.currentQuadrant||this.options.defaultQuadrant)}else{if(l==="play"){j.publish("activatePlayCallback",m.playParam);this.onActivePlay(false);this.closeCompassOnActivePlay()}else{this.clickQuadrant(l)}}}}}},onCompassBaseClick:function(n){var k,m,l;k=i.getPosition(n);m=this.elements.compassBase.getOffsets();l=l=this.getQuadrant(k.x-m.x,k.y-m.y,1378,1378,3844,124);if(this.isPlayEvent(l)){j.publish("activatePlayCallback",this.playParam);this.onActivePlay(false);this.closeCompassOnActivePlay()}else{if(l!=="play"){this.quadrantAction="Click";this.clickQuadrant(l)}}},onCompassSmallOver:function(r){if(!b.isSmartphone()&&!(a.Features.touchEvents&&b.getOs()==="ios")){var q,o,p,k=this.elements,t=this.elements.tooltip,n=k.compassSmallOver,m=k.compassSmall,s=k.compassQuadrantPlay,l=k.compassQuadrantPlaySmall;q=i.getPosition(r);o=this.elements.compassSmall.getOffsets();p=p=this.getQuadrant(q.x-o.x,q.y-o.y,256,256,1024,64);if(this.isPlayEvent(p)){s.addClassName("over");l.addClassName("over");t.hide();this.showTooltip(p);m.setStyle("cursor","pointer")}else{if(p!==this.highlightedQuadrant){this.highlightedQuadrant=p;n.className="compass-small-over";if(p){t.hide();this.showTooltip(p);n.addClassName(p);m.setStyle("cursor","")}else{m.setStyle("cursor","default")}}}}},closeCompassOnActivePlay:function(){if(b.isOpenFullSize()){this.dispatchEvent("onClose");this.quadrantAction="Close"}},onActivePlay:function(o,q,r){var l=this,m=this.elements,n=m.compassQuadrantPlay,k=m.compassQuadrantPlaySmall,p=document.body.getElement(".topbar-logo");if(p){p.toggleClassName("play",o)}if(o&&q){l.playParam=q}if(o!==this.activePlay){this.activePlay=o;if(o){n.addClassName("play-activated");k.addClassName("play-activated")}else{n.setStyle("opacity",0);k.setStyle("opacity",0);setTimeout(function(){n.removeClassName("play-activated");k.removeClassName("play-activated");n.setStyle("opacity",1);k.setStyle("opacity",1)},301);if(q){j.publish("resetPlayCallback",q)}}}},onCompassSmallOut:function(){if(!b.isSmartphone()){this.elements.compassSmallOver.className="compass-small-over";this.highlightedQuadrant=null;this.elements.compassQuadrantPlay.removeClassName("over");this.elements.compassQuadrantPlaySmall.removeClassName("over")}},onCompassBaseOver:function(q){var k,o,l,p=this.elements,n=p.compassOver,m=p.compassBase;k=i.getPosition(q);o=this.elements.compassBase.getOffsets();l=l=this.getQuadrant(k.x-o.x,k.y-o.y,1378,1378,3844,124);if(this.isPlayEvent(l)){this.elements.compassQuadrantPlay.addClassName("over");this.elements.compassQuadrantPlaySmall.addClassName("over");this.elements.compassBase.setStyle("cursor","pointer")}else{if(l!==this.highlightedQuadrant){this.highlightedQuadrant=l;n.className="compass-over";if(l!=="play"){n.addClassName(l);m.setStyle("cursor","")}else{m.setStyle("cursor","default")}}}},onCompassBaseOut:function(){this.elements.compassOver.className="compass-over";this.highlightedQuadrant=null;this.elements.compassQuadrantPlay.removeClassName("over");this.elements.compassQuadrantPlaySmall.removeClassName("over")},clickQuadrant:function(k){if(k===this.currentQuadrant&&this.open&&this.closable&&!this.isPlayEvent(k)){if(c.is(f.addinMode)===false){this.dispatchEvent("onClose");this.quadrantAction="Close"}}else{this.currentQuadrant=k;this.dispatchEvent("onOpenQuadrant",k)}h.inc(h._IDS.compass["quadrant"][k],this.quadrantAction)},onClose:function(){this.open=false;this.elements.compassBase.removeClassName("animate");if((b.isSmartphone()&&document.body.getElement(".my-apps-panel").hasClassName("onSmartphone"))){this.typeCompassView="compassSmall"}else{this.typeCompassView="compassBase"}},isPlayEvent:function(k){return this.activePlay&&k==="play"},onOpenQuadrant:function(k){var l=this;if(!this.isPlayEvent(k)){if(!this.open){this.open=true;if(b.isSmartphone()){if(this.typeCompassView==="compassSmall"){setTimeout(function(){l.switchCompassView(true)},300)}else{setTimeout(function(){l.switchCompassView(false)},300)}}else{this.container.addClassName("open");window.setTimeout(function(){l.elements.compassBase.addClassName("animate")},50)}}this.elements.compassOn.className="compass-on "+k}},updateOpenState:function(){if(!this.open){this.container.removeClassName("open")}},setQuadrantNames:function(k){var l=this.quadrantNames;l.north=k.north;l.east=k.east;l.south=k.south;l.west=k.west;l.play=k.play},_getQuadrantRelatedOffset:function(n,o,m,l){var k=this.tooltipsOffsets&&this.tooltipsOffsets[n][l];if(k){return{x:k.x+o,y:k.y+m}}},showTooltip:function(k){var s,r,q,m,p,n,l,o;if(this.quadrantNames[k]){r=this.elements.compassSmall.getSize();l=r.height/2;s=this.elements.tooltip;s.setBody(this.quadrantNames[k]);o=s.elements.container.getSize().height/25;q=o>1&&((k!=="east"&&k!=="west")||o>=2)?1:0;m=q===1?"bottom bottom-left":"right";p=q===1?l:-l;n=q===1?-l:0;s.options.offset=this._getQuadrantRelatedOffset(k,p,n,q);if(this.quadrantNames[k]!==""){s.show();s.updatePosition(m)}}},switchCompassView:function(k){var n=this,l=document.body.getElement(".my-apps-panel"),m=this.getContent();clearTimeout(n.slideTimeout);if(k){l.removeClassName("onSmartphoneCompassOpen");l.addClassName("onSmartphone");n.elements.compassSmallOver.className="compass-small-over "+(n.currentQuadrant||n.defaultOptions.defaultQuadrant);n.slideTimeout=setTimeout(function(){m.removeClassName("open");if(l.style.display!=="none"){m.addClassName("openOnSmartphone")}},150);l.removeEvent("click",n.switchCompassView)}else{l.addEvent("click",n.switchCompassView.bind(n));l.removeClassName("onSmartphone");l.addClassName("onSmartphoneCompassOpen");n.slideTimeout=setTimeout(function(){m.removeClassName("openOnSmartphone");if(!n.elements.compassBase.hasClassName("animate")){n.elements.compassBase.addClassName("animate")}m.addClassName("open")},150);this.dispatchEvent("onUnScroll")}}};return d.extend(g)});define("DS/i3DXCompass/Collection/SuggestionList",["UWA/Core","UWA/Class/Collection","DS/i3DXCompass/Data","DS/i3DXCompass/Model/Suggestion"],function(e,a,c,d){var b={model:d,setup:function(){this.added=[]},sync:function(i,h,f){var g;switch(i){case"read":g=c.request({url:c.getSuggestionsUrl,onComplete:function(j){if(j&&j.code===0){if(f&&f.onComplete){f.onComplete(j)}}else{if(f&&f.onFailure){f.onFailure(j)}}},onFailure:function(j){if(f&&f.onFailure){f.onFailure(j)}}});break}return g},parse:function(f){return f.suggestions},set:function(){this.added.length=0;this._parent.apply(this,arguments);if(this.added.length>0){this.dispatchEvent("onMultipleAdd",[this.added])}},onAdd:function(f){this.added.push(f)}};return a.extend(b)});define("DS/i3DXCompass/ServiceApi/UserServiceApi",["UWA/Core","UWA/Utils","DS/i3DXCompass/Data"],function(e,a,i){var c=3600000,f="api/pull/self",d,b=false,h=false,g,p,r=[],k=function(){return i.myAppsBaseUrl?i.myAppsBaseUrl+f:null},l=function(s){r.forEach(function(t){if(t[s]){setTimeout(t[s],0,d)}});r.length=0},j=function(){h=true;i.request({url:k(),headers:{"Last-Modified":p},onComplete:function(s,t){d=s;b=true;if(t["Last-Modified"]){}l("onComplete");h=false},onFailure:function(){if(d){l("onComplete")}else{l("onFailure")}h=false}})},o=function(){var s;if(!h){if(k()){j()}else{s=setInterval(function(){if(k()){clearInterval(s);j()}else{e.log("wait for myapps url")}},100)}}},m=function(t){var s=Date.now();if(b&&(!g||(s-g<c))){t.onComplete(d)}else{g=s;r.push({onComplete:t.onComplete,onFailure:t.onFailure});o()}},n=function(){d=undefined;b=false;h=false};var q={getUser:function(s){if(!s||e.typeOf(s.onComplete)!=="function"){return}m({onComplete:function(t){var u=s.platformId;t=e.clone(t);if(s.platformId){t.platform=e.Array.detect(t.platforms,function(v){return v.id===u});delete t.platforms;if(t.platform){t.admin=t.platform.role==="admin"}else{t.admin=false;if(s.onFailure){return s.onFailure()}}}s.onComplete(t)},onFailure:s.onFailure})},_private:{callbacks:r,fireCallbacks:l,reset:n}};return q});define("DS/i3DXCompass/View/ServicesView",["UWA/Core","UWA/Utils","UWA/Class/View","DS/UIKIT/Tooltip","DS/i3DXCompass/Tools","DS/i3DXCompass/Data","DS/i3DXCompass/X3DContent"],function(e,f,b,g,d,h,c){var a="service";var i={className:a+"-section",_onClick:function(k){var j=k.get("url");if(k.get("id")==="X3DPSLY_AP"&&e.is(h.addinMode)===true){j=this._manageAddinUrl(j)}if(d.isSameApp(j,window.location)||j.indexOf("embeddedProfileId=CATIAV5")!==-1){window.open(j,"_self")}else{window.open(j,"_blank")}},_manageAddinUrl:function(j){var k=h.addinMode&&h.addinMode.value;if(!h.cloud){j=this._addQueryParams(j,"lockedapp",true)}if(k){j=this._addQueryParams(j,"addinmode",k)}if(k&&k.toLowerCase()==="catiav5"){j=this._addQueryParams(j,"embeddedProfileId","CATIAV5")}return j},_addQueryParams:function(k,j,m){var l=k.indexOf("?")===-1?"?":"&";return k+l+j+"="+m},render:function(){this.container.setContent(this._renderServices());return this},_renderServices:function(){var l=this.elements,j=this,m=this.collection.map(function(n){var o=e.createElement("li",{"class":a+"-item",html:[{tag:"img","class":a+"-item-icon",src:n.get("icon"),events:{dragstart:function(p){p.preventDefault()}}},{tag:"div","class":a+"-item-title",text:n.get("title")}],"data-id":n.get("id"),events:{click:function(){j._onClick(n)}}});new g({position:"bottom",target:o,delay:{show:1000},body:n.get("description")||n.get("title")});return o}),k=l.list;if(!k){k=l.list=e.createElement("ul",{"class":a+"-list"})}k.setContent(m);return k}};return b.extend(i)});define("DS/i3DXCompass/i3DXCompassServices",["UWA/Core","UWA/Utils","DS/i3DXCompass/Data","DS/i3DXCompass/EventManager","DS/i3DXCompass/ServiceApi/UserServiceApi","DS/i3DXCompass/CacheManager"],function(j,e,p,A,D,H){var f,q,d,i="api/v1/public/services",m="api/v1/services";var k,g=false,o=false,l,F=[],s,u=function(){var I=C();return I?I+(h()?m:i):null},C=function(){return p.myAppsBaseUrl||s},h=function(){return H._getUser()},x=function(I){F.forEach(function(J){if(J[I]){setTimeout(J[I],0,k)}});F.length=0},z=function(){return G()?G().split("@@@")[0]:null},n=function(){return G()?JSON.parse(G().split("@@@")[1]):null},c=function(I,J){H.setCache(u(),I+"@@@"+JSON.stringify(J))},G=function(){if(!d){d=H.getCache(u())}return d},r=function(){o=true;p.request({cache:null,urlParams:{cors:true},url:u(),headers:{"Last-Modified":z()},onComplete:function(J,K){if(J&&J.code===0){f=null;q=null;k=J.platforms;g=true;var I=K&&(K["Last-Modified"]||K["Last-Modified".toLowerCase()]);if(K&&I&&k&&k.length>0){c(I,k)}x("onComplete")}else{k=n();if(k){g=true;x("onComplete")}else{x("onFailure")}}o=false},onFailure:function(){k=n();if(k){g=true;x("onComplete")}else{x("onFailure")}o=false}})},t=function(J){var I=Date.now();if(!u()&&((J.config&&J.config.myAppsBaseUrl)||(typeof COMPASS_CONFIG!=="undefined"&&COMPASS_CONFIG.myAppsBaseUrl))){if(J.config&&J.config.myAppsBaseUrl){s=J.config.myAppsBaseUrl}else{s=COMPASS_CONFIG.myAppsBaseUrl}s=s.replace("/resources/AppsMngt","");s=s.replace(/\/$/,"")+"/resources/AppsMngt/"}if(!h()&&((J.config&&J.config.userId)||(typeof COMPASS_CONFIG!=="undefined"&&COMPASS_CONFIG.userId))){if(J.config&&J.config.userId){H.setup(J.config.userId,J.config.lang)}else{H.setup(COMPASS_CONFIG.userId,COMPASS_CONFIG.lang)}}if(g&&k&&(!l||(I-l<10000))){J.onComplete(j.clone(k))}else{l=I;F.push({onComplete:J.onComplete,onFailure:J.onFailure});if(!o){if(u()){r()}else{A.addEventOnce("onInitialized",b)}}}},b=function(){if(u()){r()}A.removeEvent("onInitialized",b)},y=function(I){return e.composeUrl(e.parseUrl(I))},v=function(J,K){var I={};if(K&&K.services){K.services.forEach(function(L){if(!J||J&&L["public"]===true){I[L.name]=y(L.url)}});return j.merge({platformId:K.id,displayName:K.name},I)}},w=function(I,K){var J;if(K){J=K[I];return J?{platformId:K.platformId,url:J}:{platformId:K.platformId}}},B=function(){k=undefined;f=undefined;q=undefined;g=false;o=false},a=function(J,I){if(J){if(!I&&!f){f=J.map(v.bind(null,I))}else{q=J.map(v.bind(null,I))}}return I?j.clone(q):j.clone(f)};A.addEvent("onMyAppsDataChange",function(){B()});var E={getUser:D.getUser,getPlatformServices:function(I){if(!I||j.typeOf(I.onComplete)!=="function"){return}t({config:I.config,onComplete:function(M){var N=I.platformId,J,L=I["public"],K=a(M,L);J=N?j.Array.detect(K,function(O){return O.platformId===N}):K;I.onComplete(J)},onFailure:I.onFailure})},getPlatformConfig:function(I){if(!I||j.typeOf(I.onComplete)!=="function"){return}t({config:I.config,onComplete:function(M){var N=I.platformId,L=I.key,K,J=j.clone(M);K=N?j.Array.detect(J,function(O){return O.id===N}):J.map(function(P){var O=P.config;if(L&&j.is(O[L])){var Q=O[L];O={};O[L]=Q}return j.merge({platformId:P.id,displayName:P.name},O)});if(N&&K){if(L&&j.is(K.config[L])){K=K.config[L]}else{if(L){K=undefined}else{K=K.config}}}I.onComplete(K)},onFailure:I.onFailure})},getServiceUrl:function(I){if(!I||!I.serviceName||j.typeOf(I.onComplete)!=="function"){return}t({config:I.config,onComplete:function(O){var P=I.platformId,J,K,L,N=I["public"],M=a(O,N);if(P){J=j.Array.detect(M,function(Q){return Q.platformId===P});K=w(I.serviceName,J);if(K){L=K.url}}else{L=M.map(w.bind(null,I.serviceName))}I.onComplete(L)},onFailure:I.onFailure})},_private:{callbacks:F,fireCallbacks:x,fetchEnvironmentList:r,getEnvironmentList:t,normalizeUrl:y,extractUrls:v,extractUrl:w,reset:B}};return E});define("DS/i3DXCompass/Controls/ScrollAccordion",["UWA/Core","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Controls/Abstract","DS/i3DXCompass/Tools","DS/i3DXCompass/UsageTracker","DS/UIKIT/Tooltip","DS/UIKIT/SuperModal"],function(f,c,j,b,g,e,i,h,a){var k=e.i18n,d={defaultOptions:{className:"",sections:1,scrollable:false,scrollSize:40},className:"compass-scroll-accordion",scrolled:0,sumHeight:0,containerHeight:0,scrollbarHeight:0,scrollMove:0,moved:false,scrolling:false,titleHeight:52,adjustDelay:300,adjustTimeoutId:null,fromAdjusScrolls:0,init:function(l){this._parent(l);if(!l.data){var m=l.sections-1,n=[];for(;m>=0;m--){n.push({title:"",html:null,open:true,visible:true})}this.options.data=n}else{if(l.sections!==l.data.length){this.options.sections=this.options.data.length}}this.sectionsByName={};this.buildSkeleton()},buildSkeleton:function(){var w=this,m=this.elements={container:f.createElement("div",{"class":this.className+" smooth-scroll "+this.options.className}),wrapper:f.createElement("div",{"class":this.className+"-wrapper"+(e.getOs()==="ios"?" iosVersion":"")}),sections:[],sectionTitles:[],sectionContents:[],sectionContentWrappers:[]},s=0,n=this.options.sections,r,B,p,y,C,v,t,x,u,q,z,o,A=this.styles=[];z=f.createElement("div",{"class":"delete-favorite",html:{tag:"span","class":"fonticon fonticon-trash"},events:{click:function(l){f.Event.stop(l);w._confirmModal()}}});new h({position:"right",target:z,body:k("clickRemoveFavorite")});for(;s<n;s++){r=this.options.data[s];o=r.parent?this.getParentElm(r.parent).elm:null;y=f.createElement("span",{"class":this.className+"-section-title-icon "+("fonticon fonticon-"+r.icon||"")});C=f.createElement("span",{"class":this.className+"-section-title-text",text:r.title});p=f.createElement("div",{"class":this.className+"-section-title-wrapper"+(r.parent?" child":""),html:[y,C,{tag:"span","class":this.className+"-section-title-arrow fonticon fonticon-right-dir"},{tag:"span","class":this.className+"-section-title-arrow fonticon fonticon-down-dir"},(r.id==="favorite")?(r.html[0].collection.length>0?z:z.addClassName("hide")):""]});u=m.sectionTitles.length;q=r.open?0:this.marginTopClosedSection(r);B=f.createElement("div",{"class":this.className+"-section-title"+(r.icon?" has-icon":""),html:p,"data-sectionnum":u});if(r.parent){B.setAttribute("data-parent",r.parent)}v=f.createElement("div",{"class":this.className+"-section-content","data-sectionnum":u,html:r.html});t=f.createElement("div",{"class":this.className+"-section-content-wrapper",html:v,styles:{"margin-top":q}});m.sectionTitles.push({container:B,icon:y,text:C});m.sectionContents.push(v);m.sectionContentWrappers.push(t);x=f.createElement("div",{"class":this.className+"-section"+(r.open?"":" closed")+((o&&!o.open)?" hidden":"")+(r.name?(" "+r.name):"")+(r.visible===false?" not-visible":""),attributes:{"data-id":r.id},html:[B,{"class":this.className+"-section-content-container",html:t}]});m.sections.push(x);x.inject(m.wrapper);A.push({margin:q,height:0,closed:!r.open,scrollable:!!r.open,visible:r.visible!==false});if(r.name){this.sectionsByName[r.name]=u}}m.wrapper.inject(m.container);if(this.options.scroller){m.scrollbar=f.createElement("div",{"class":this.className+"-scrollbar"});m.scrollbarWrapper=f.createElement("div",{"class":this.className+"-scrollbar-wrapper",html:m.scrollbar}).inject(m.container)}this.initEvents()},marginTopClosedSection:function(o){var l=e.isSmartphone()?2:4,n=-10000,p=53;for(var m=0;m<o.html.length;m++){if(o.html[m].collection){n=Math.min(-(o.html[m].collection.length*(88+p)/l),n)}}return n},setContent:function(n,l){var o=this.getSectionNum(n),m=this.elements.sectionContents[o];if(m){m.setContent(l)}},setTitle:function(p,s,o){var r=this.getSectionNum(p),n,l,m,q;if(r){n=this.elements.sectionTitles[r];if(n){l=n.container;m=n.text;q=n.icon;m.setText(s);if(o){l.addClassName("has-icon");q.className=this.className+"-section-title-icon";q.addClassName(o)}else{l.removeClassName("has-icon")}}}},initEvents:function(){var n=this.eventHandler=this.handleEvent.bind(this),l=this.scrollbarEventHandler=this.handleScrollbarEvent.bind(this),m=this.titleEventHandler=this.handleTitleEvent.bind(this),o=this.eventNames={start:"touchstart",move:"touchmove",stop:"touchend",cancel:"touchcancel"};if(!c.Features.touchEvents){if(window.PointerEvent){o=this.eventNames={start:"pointerdown",move:"pointermove",stop:"pointerup",cancel:"pointerup"};this.elements.wrapper.setStyle("touch-action","none")}else{if(window.MSPointerEvent){o=this.eventNames={start:"MSPointerDown",move:"MSPointerMove",stop:"MSPointerUp",cancel:"MSPointerUp"};this.elements.wrapper.setStyle("touch-action","none")}}}if(this.options.scroller){this.elements.container.addEvent("mousewheel",n);this.elements.sectionContents.invoke("addEvent","transitionEnd",n);this.elements.container.addEvent(o.start,n);this.elements.container.addEvent("click",n,false,0,true);this.elements.scrollbar.addEvent("mousedown",l);this.elements.scrollbarWrapper.addEvent("transitionEnd",l)}this.elements.sectionContents.invoke("addEvent","resize",n);this.elements.container.addEvent("resize",n);this.elements.sectionTitles.forEach(function(p){p.container.addEvent("click",m)})},handleEvent:function(m){var l,n=this.eventNames;f.log("event:"+m.type);if(m.pointerType===undefined||m.pointerType!=="mouse"){switch(m.type){case n.start:l=this.dispatchEvent("onScrollInit",[m]);break;case n.move:l=this.dispatchEvent("onScrollMove",[m]);break;case n.cancel:case n.stop:l=this.dispatchEvent("onScrollStop",[m]);break;case"DOMMouseScroll":case"onmousewheel":case"mousewheel":l=this.dispatchEvent("onMouseWheel",[m]);break;case"onclick":case"click":l=this.dispatchEvent("onClick",[m]);break;case"transitionEnd":case"otransitionend":case"MSTransitionEnd":case"transitionend":case"webkitTransitionEnd":l=this.dispatchEvent("onScrollEnd",[m]);break;case"resize":if(m.target===this.elements.container){l=this.dispatchEvent("onContainerResize",[m])}else{l=this.dispatchEvent("onContentResize",[m])}break}}return l},handleScrollbarEvent:function(m){var l;switch(m.type){case"mousedown":l=this.dispatchEvent("onScrollbarInit",[m]);break;case"mousemove":l=this.dispatchEvent("onScrollbarMove",[m]);break;case"mouseup":l=this.dispatchEvent("onScrollbarStop",[m]);break;case"transitionEnd":case"otransitionend":case"MSTransitionEnd":case"transitionend":case"webkitTransitionEnd":l=this.dispatchEvent("onScrollbarToggle",[m]);break}return l},handleTitleEvent:function(m){var l;switch(m.type){case"onclick":case"click":l=this.dispatchEvent("onTitleClick",[m]);break}return l},onTitleClick:function(m){var l=this,o=m.currentTarget.getData("sectionnum"),n=this.elements.container.getElements("[data-parent="+m.currentTarget.getParent().getAttribute("data-id")+"]");this.toggleSection(o);n.forEach(function(q){var p=l.elements.sections[o];if(p.hasClassName("closed")){l.closeSection(q.getData("sectionnum"));if(!p.hasClassName("hidden")){q.addClassName("hidden")}}else{l.openSection(q.getData("sectionnum"));q.removeClassName("hidden");if(q.getParent().hasClassName("hidden")){q.getParent().removeClassName("hidden")}}});if(n.length){setTimeout(function(){l.dispatchEvent("onToggleSection")},800)}},onClick:function(l){if(this.moved){l.stopPropagation()}},onMouseWheel:function(l){var m=j.wheelDelta(l)*this.options.scrollSize;f.log(j.wheelDelta(l));f.log(j.wheelDelta(this.options.scrollSize));f.log(m);this.scrolling=true;this.scroll(m);l.preventDefault()},onScrollInit:function(n){var m=j.getPosition(n).y,o=this.eventNames,l=this.eventHandler;this.scrollMove=m;this.refMove=m;this.refTime=Date.now();this.firstMove=m;this.moved=false;b.addEvent.call(window,o.move,l);b.addEvent.call(window,o.stop,l);b.addEvent.call(window,o.cancel,l);this.elements.container.removeClassName("smooth-scroll");this.scrolling=true},onScrollMove:function(m){var l=j.getPosition(m).y,o=l-this.scrollMove,n=Date.now();this.scrollMove=l;this.scroll(o);if(n-this.refTime>300){this.refMove=l;this.refTime=n}if(!this.moved&&Math.abs(l-this.firstMove)>10){this.moved=true}m.preventDefault()},onScrollStop:function(p){var r=this.eventNames,m=this.eventHandler,o,q,l,n;b.removeEvent.call(window,r.move,m);b.removeEvent.call(window,r.stop,m);b.removeEvent.call(window,r.cancel,m);this.elements.container.addClassName("smooth-scroll");if(p){o=j.getPosition(p).y;q=Date.now()-this.refTime;l=o-this.refMove;n=(l/q)*300;if(Math.abs(l)>10&&q<=300){this.scroll(n)}else{this.scrolling=false}}},onScrollbarInit:function(n){var m=j.getPosition(n).y,l=this.scrollbarEventHandler;if(j.whichButton(n)===0){this.scrollMove=m;b.addEvent.call(window,"mousemove",l);b.addEvent.call(window,"mouseup",l);this.elements.container.removeClassName("smooth-scroll");this.elements.scrollbar.addClassName("grabbing")}n.stopPropagation()},onScrollbarMove:function(n){var m=j.getPosition(n).y,l=this.scrollableHeight,o=(m-this.scrollMove)*(l-this.sumHeight)/(this.scrollbarWrapperHeight-this.scrollbarHeight);this.scrollMove=m;this.scroll(o);n.preventDefault()},onScrollbarStop:function(){var l=this.scrollbarEventHandler;b.removeEvent.call(window,"mousemove",l);b.removeEvent.call(window,"mouseup",l);this.elements.container.addClassName("smooth-scroll");this.elements.scrollbar.removeClassName("grabbing");this.scrolling=false},onScrollbarToggle:function(){var m=this.elements.scrollbarWrapper,l=m.getStyle("opacity");if(l===0){m.hide()}},onScrollEnd:function(){this.scrolling=false},onContainerResize:function(){var o=parseInt(this.elements.wrapper.getStyle("height"),10),n=this.styles,l=0,m;if(o!==this.containerHeight&&this.options.scroller){this.containerHeight=o;this.scrollbarWrapperHeight=o-12;for(m=this.styles.length-1;m>=0;m--){if(n[m].visible){l++}}f.log("containerHeight:"+o);f.log("visibleSections"+l);f.log("this.titleHeight"+this.titleHeight);this.scrollableHeight=o-l*this.titleHeight;this.dispatchEvent("onAdjustScrolls")}},onContentResize:function(q){var n=q.target,p=n.getData("sectionnum"),m=this.elements.sectionContentWrappers[p],o=this.styles[p],r=o.margin,s,l=parseInt(n.getStyle("height"),10);if(l.toString()==="NaN"){l=o.height}if(l!==o.height){o.height=l;m.setStyle("height",l);if(!o.scrollable||r<-l){m.setStyle("margin-top",-l);s=o.margin=-l}if(this.options.scroller){this.sumHeight=this.styles.reduce(function(t,u){return t+((u.closed&&!u.scrollable&&u.visible)?0:u.height)},0);if(r<-l&&o.scrollable){this.scrolled+=r-o.margin}this.dispatchEvent("onAdjustScrolls")}}},scroll:function(w){var t=w>0,q=this.elements.sectionContentWrappers,v,u=this.scrollableHeight,z=this.sumHeight,l=this.scrolled,n,x,p,y,s,r,o=t?q.length-1:0,m=t?-1:q.length;if(typeof u==="undefined"){this.onContainerResize();u=this.scrollableHeight}for(;o!==m;t?o--:o++){y=this.styles[o];v=q[o];s=u-(z-l);if(w===0||(w<0&&s>=0)){break}if(y.scrollable&&y.visible){n=y.margin;x=y.height;s=w<0?Math.max(w,s):w;p=Math.max(Math.min(n+s,0),-x);v.setStyle("margin-top",p);y.margin=p;r=(p-n);w=w-r;l-=r}}if(this.scrolled!==l){this.dispatchEvent("onScroll",l-this.scrolled)}this.scrolled=l;if(this.fromAdjusScrolls!==1){if(w>=0&&l<1){this.dispatchEvent("onScrollTop")}else{this.dispatchEvent("onScrollDown")}}if(this.fromAdjusScrolls===1){this.fromAdjusScrolls=0}this.updateScrollbarPosition();this.updateSectionStyles()},onAdjustScrolls:function(){if(!this.adjustTimeoutId){this.adjustTimeoutId=setTimeout(this.adjustScrolls.bind(this),this.adjustDelay)}},adjustScrolls:function(){var l=this.scrollableHeight-(this.sumHeight-this.scrolled);this.adjustTimeoutId=null;if(l>0){this.fromAdjusScrolls=1;this.scroll(l)}this.updateScrollbar();this.updateScrollbarPosition();this.updateSectionStyles()},unScroll:function(p){var o=this.styles,n,l=o.length-1,m=0;for(;l>=p;l--){n=o[l];if(n.scrollable&&n.visible){m-=n.margin}}this.scroll(m)},updateScrollbar:function(){var m=this.scrollableHeight,o=this.sumHeight,p,n=this.elements,l=n.scrollbarWrapper,q=n.scrollbar;if(m>=o){l.setStyle("opacity",0);n.container.removeClassName("has-scroller")}else{p=m*this.scrollbarWrapperHeight/o;q.setStyle("height",p);l.show();l.setStyle("opacity",1);this.scrollbarHeight=p;n.container.addClassName("has-scroller")}},updateScrollbarPosition:function(){var l=this.scrollableHeight,n=this.scrollbarHeight,m=(n-this.scrollbarWrapperHeight)*(this.scrolled)/(l-this.sumHeight);this.elements.scrollbar.setStyle("top",m)},updateSectionStyles:function(){var z=this.styles,m,v,n,y=this.elements.sections,x,p=z.length,s=p-1,q,u,r,o,w;for(;s>=0;s--){m=z[s];v=null;x=y[s];n=m.height+m.margin<1;w=!(this.options.data&&!this.options.data[s].parent);r=(this.options.data&&!this.options.data[s].parent&&!w)?this.getChildrenIndex(s):((this.options.data&&this.options.data[s].parent)?this.getChildrenIndex(this.getParentElm(this.options.data[s].parent).index):[]);u=true;o=true;for(var t=0;t<r.length;t++){if((z[r[t]].height+z[r[t]].margin<1)===false){if(w){o=false}else{u=false}}}if(m.scrollable){if(n&&u){x.addClassName("closed");m.closed=true}else{x.removeClassName("closed");m.closed=false}}if(n){for(q=s+1;q<p;q++){if(z[q].scrollable){v=z[q];break}}if((x.getChildren().length&&x.getChildren()[0].getAttribute("data-parent")&&x.hasClassName("closed"))||(w&&o)){if(x.getChildren().length){x.getChildren()[0].addClassName("hidden")}}if(v&&v.margin<=-1){if(x.getAttribute("data-parent")){x.addClassName("scrolled")}}else{if(x.getAttribute("data-parent")){x.removeClassName("scrolled")}if(x.getChildren().length&&x.getChildren()[0].getAttribute("data-parent")&&!this.elements.container.getElement("[data-id="+x.getChildren()[0].getAttribute("data-parent")+"]").hasClassName("closed")){x.getChildren()[0].removeClassName("hidden")}}}else{if(x.getAttribute("data-parent")){x.removeClassName("scrolled")}if(x.getChildren().length&&x.getChildren()[0].getAttribute("data-parent")&&!this.elements.container.getElement("[data-id="+x.getChildren()[0].getAttribute("data-parent")+"]").hasClassName("closed")){x.getChildren()[0].removeClassName("hidden")}}}},toggleSection:function(s){var q=this.elements.sectionContentWrappers[s],u=this.elements.sections[s],o=this.styles[s],n=o.closed,v=o.scrollable,r=this.options.scroller,p=n?0:-o.height;o.closed=!n;o.scrollable=n;if(r&&n){if(!v){this.sumHeight+=o.height;this.scrolled-=o.margin}this.updateScrollbar();this.unScroll(s)}else{u.toggleClassName("closed");q.setStyle("margin-top",p);if(r){if(n){this.sumHeight+=o.height}else{this.sumHeight-=o.height;this.scrolled+=o.margin}o.margin=p}this.dispatchEvent("onAdjustScrolls")}var m=u.getAttribute("data-id"),t=i._IDS.compass["section"];if(n){var l="Open"}else{var l="Close"}i.inc(t,l,m);this.dispatchEvent("onToggleSection")},showSection:function(m){var o=this.getSectionNum(m),n=this.elements.sections[o],l=this.styles[o];f.log("show section: "+m);if(!l.visible){l.visible=true;this.scrollableHeight-=this.titleHeight;if(l.scrollable){this.sumHeight+=l.height;this.scrolled-=l.margin}n.removeClassName("not-visible");this.dispatchEvent("onAdjustScrolls")}},hideSection:function(m){var o=this.getSectionNum(m),n=this.elements.sections[o],l=this.styles[o];f.log("hide section: "+m);if(l.visible){l.visible=false;this.scrollableHeight+=this.titleHeight;if(l.scrollable){this.sumHeight-=l.height;this.scrolled+=l.margin}n.addClassName("not-visible");this.dispatchEvent("onAdjustScrolls")}},getSectionNum:function(l){if(f.typeOf(l)==="string"){return this.sectionsByName[l]}return l},closeSection:function(l){var m=this.getSectionNum(l);if(!this.styles[m].closed){this.toggleSection(m)}},openSection:function(l){var m=this.getSectionNum(l);if(this.styles[m].closed){this.toggleSection(m)}},getVisibleHeight:function(m){var n=this.getSectionNum(m),l;if(n>=this.options.sections){return}l=this.styles[n];return l.height+l.margin},showTempHeight:function(n,l){var p=this.getSectionNum(n),o=this.getVisibleHeight(p),m=this.styles[p];if(l>o){this.elements.sectionContentWrappers[p].setStyle("margin-top",(l-m.height))}},hideTempHeight:function(m){var n=this.getSectionNum(m),l=this.styles[n];this.elements.sectionContentWrappers[n].setStyle("margin-top",l.margin)},isScrolling:function(){return this.scrolling},_confirmModal:function(){var m=this,l=new a({closable:false});l.confirm(k("confirmRemoveFavorite"),k("confirmation"),function(n){if(n){m.dispatchEvent("onRemoveAllFavoriteApp")}})},hideDeleteZone:function(){f.log("hideDeleteZone");this.deleteZone.hide()},hideDeleteZone1:function(){f.log("hideDeleteZone1");this.deleteZone.hide()},getPositionSection:function(m){var l;this.options.data.forEach(function(n,o){if(n.id===m){l=o}});return l},getParentElm:function(m){var n=this.options.data;for(var l=0;l<n.length;l++){if(n[l].id===m){return{index:l,elm:n[l]}}}return null},getChildrenIndex:function(m){var o=this.options.data,l=[],p=m;for(var n=m+1;n<o.length;n++){if(o[m].id===o[n].parent){l.push(n)}else{return l}}return l}};return g.extend(d)});define("DS/i3DXCompass/Collection/InstallList",["UWA/Core","UWA/Class/Collection","DS/i3DXCompass/Model/Install","DS/i3DXCompass/DaemonManager","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data"],function(h,d,c,a,b,g){var f=h.i18n,e=d.extend({model:c,parse:function(k){var j=this,i=[];k.forEach(function(l){var m;if(l.lastBuildId&&l.type==="CODE"&&j.isAvailableForCurrentEnvironment(l)){l.processes=(l.installedProcesses||[]).map(function(n){return n.split(".")[0]});m=l.processes[0];l.dpId=l.lastBuildId+"+"+m;l.dpIdObj={ID:l.lastBuildId,process:m,golden:(l.SPlevel||"").indexOf(".")===-1,release:"R"+l.level,SPLevel:l.SPlevel};l.name=(l.longName||l.GAlevel)+(l.registry_Identifier&&(l.registry_Identifier!=="!")?" - "+l.registry_Identifier:"");l.daemonId=l.id;l.id=l.GAlevel+l.installationType+(l.registry_Identifier||"");i.push(l)}});return i},isAvailableForCurrentEnvironment:function(l){var k=true,i=g.buildTransactionId&&g.buildTransactionId.split("-")[0],j=l.installationType.indexOf("_Cloud")>-1;if((i>="R421"||i==="")&&l.installationType.toLowerCase().indexOf("desktop")>-1){k=g.cloud?j:!j}return k},sync:function(k,j,i){switch(k){case"read":a.discoverAllInstall({onComplete:function(l){if(i&&i.onComplete){i.onComplete(l)}},onFailure:function(){b.dispatchEvent("onShowMessage",[f("unableinstalldata"),5000]);if(i&&i.onFailure){i.onFailure()}},silent:i._silent});break}}});return e});define("DS/i3DXCompass/Collection/ProductList",["UWA/Core","UWA/Class/Collection","DS/i3DXCompass/Data","DS/i3DXCompass/Tools","DS/i3DXCompass/Model/Product"],function(f,d,e,b,c){var a=d.extend({model:c,installList:null,validData:false,data:null,setup:function(g){this.installList=g.installList},sync:function(m,l,g){var i,j=this,h=false;switch(m){case"read":i=this.data={};this.isValid=true;e.request({url:e.getProcessDetailsUrl,onComplete:function(o){var n=[],q=[],p;i.myapps=o;if(o.about){o.about.forEach(function(r){if(r.key==="BuildTransactionID"){p=r.value;i.transactionId=p}})}if(o.cloud){if(o.env){o.env.forEach(function(r){r.licenses.forEach(function(s){b.pushUnique(n,s.id)})});j.installList.forEach(function(r){q.push(r.get("dpIdObj"));r.get("processes").forEach(function(s){b.pushUnique(n,s)})});e.request({url:e.onlineInstallUrl,proxy:"ajax",method:"POST",contentType:"application/json",postData:JSON.stringify({id:(new Date().getTime()),method:"CodeLevelV2::status",params:{podID:p,clusterID:e.clusterId,processes:n,installs:q}}),onComplete:function(r){i.downloadplatform=r;k()},onFailure:function(){k()}})}}else{if(g&&g.onComplete){k()}}},onFailure:function(){k()}});break}function k(){if(!h&&g&&g.onComplete){h=true;g.onComplete(i)}}},parse:function(j){var k=[],i={},g=j.myapps,h=j.downloadplatform;this.installList.forEach(function(l){l.get("processes").forEach(function(n){var m=i[n];if(!f.is(m)){k.push({id:n,env:[]});i[n]=k.length-1}})});if(g&&g.env){g.env.forEach(function(l){l.licenses.forEach(function(n){var o=n.id,m=i[o];if(!f.is(m)){k.push(f.merge(n,{env:[l.id],granted:true}));i[o]=k.length-1}else{k[m].env.push(l.id);if(!k[m].granted){k[m].granted=true;k[m].title=n.title;k[m].apps=n.apps}}})});if(h&&h.result){h.result.stacks.forEach(function(l){l.processes.forEach(function(n){var m=i[n];if(k[m]){k[m].installType=l.installType;k[m].online=true}})})}}return k},update:function(g){var h=this;if(this.isValid){if(g&&g.onComplete){this.data.change=false;g.onComplete(this,this.data,g)}}else{this.fetch({onComplete:function(k,j,i){h.data=j;h.isValid=true;j.change=true;if(g&&g.onComplete){g.onComplete(k,j,i)}}})}},invalidate:function(){this.isValid=false}});return a});define("DS/i3DXCompass/InstallManager",["UWA/Core","UWA/Controls/Abstract","UWA/Controls/Input","UWA/Class/Model","UWA/Class/Collection","DS/i3DXCompass/Tools","DS/i3DXCompass/Data","DS/i3DXCompass/EventManager","DS/i3DXCompass/DaemonManager","DS/i3DXCompass/Collection/InstallList","DS/i3DXCompass/Collection/ProductList","DS/UIKIT/Modal","DS/UIKIT/Input/Select"],function(e,r,t,j,x,b,m,v,s,h,u,a,n){var k=b.i18n,d=function(){return{tag:"div",styles:{padding:"20px",margin:"20px 0",border:"1px solid #eee","border-left-width":"5px","border-radius":"3px","text-align":"justify","border-left-color":"#E87B00"},html:[{tag:"p",text:k("outdated_installation_uninstall")},{tag:"p",html:k("outdated_installation_uninstall_warning")}]}},l=r.extend({defaultOptions:{},name:"compass-process-descriptor",buildSkeleton:function(){var y=this,z=this.elements,A=this.options.products.title;z.title=e.createElement("button",{"class":"btn btn-primary btn-lg btn-block",html:A,events:{click:function(){y.dispatchEvent("onClick")}}});z.container=e.createElement("div",{"class":this.getClassNames(),html:[z.title]})},getContent:function(){if(!this.elements.container){this.buildSkeleton()}return this.elements.container}}),g=j.extend({idAttribute:"codeLevel"}),i=x.extend({model:g,comparator:"place"}),o=j.extend({idAttribute:"installType",setup:function(){this._levels=new i(this.get("levels"));this.addEvent("onChange:levels",function(y,z){this._levels.set(z)})}}),f=x.extend({model:o}),q=j.extend({setup:function(){this._levels=new i(this.get("levels"));this.addEvent("onChange:levels",function(y,z){this._levels.set(z)})}}),w=x.extend({model:q}),c=null,p={INSTALL_NOTHING_TO_DO:0,INSTALL_PROPOSE_UPDATE:1,INSTALL_GA_ON_GA:2,INSTALL_FORCE_UPDATE:3,NEW_INSTALL_NOTHING_TO_DO:0,NEW_INSTALL_PROPOSE_UPDATE:1,NEW_INSTALL_PROPOSE_UPDATE_UNINSTALL:2,NEW_INSTALL_FORCE_UPDATE:3,NEW_INSTALL_FORCE_UPDATE_UNINSTALL:4,NEW_INSTALL_ADDITIONAL:5,NEW_INSTALL_ERROR:6,releases:[],installList:new h(),productList:null,stackList:new f(),installLevelList:new w(),init:function(y){p.cloud=y;p.installList.addEvents({"onChange:lastBuildId":p.invalidateProductList,"onChange:processes":p.invalidateProductList,onAdd:p.invalidateProductList,onRemove:p.invalidateProductList})},invalidateProductList:function(){if(p.productList){p.productList.invalidate()}},onlineInstallation:function(D,z,E,C,y,B,A){s.isDaemonBusy({onComplete:function(F){if(F){v.dispatchEvent("onShowMessage",k("launcherbusyretry"));v.dispatchEvent("onHideMessage",5000)}else{p.onlineInstallationMenu(D,z,E,C,y,B,null,A)}},onFailure:function(F){e.log(F);v.dispatchEvent("onShowMessage",k("launcherunavailable"));v.dispatchEvent("onHideMessage",5000)}})},onlineInstallationMenu:function(J,A,X,G,W,Q,L,Y){var I=[],C=[],Z,D,K,U,O,B,N,M,H,z,T=b.removeDoublons(p.installationPaths),P,F,E,R,y=function(ab,aa){return((ab.length===aa.length)&&ab.every(function(ac){return e.Array.detect(aa,function(ad){return ac.get("id")===ad.get("id")})}))};if(!c){c=J.extractMyAppsUrlFromLaunchInfo()}function S(ad,aa,ac){var ab=A?A.getInstallationMode():"Both";if(!P&&E){if(E.getValue()[0]!=="cloud"){P=E.getValue()[0]}}p.launchInstallation(ad,N,z,ab,P,aa,ac)}if(A){A.get("processes").some(function(aa){var ab=p.productList.get(aa);if(ab.get("online")&&ab.get("env").length>0){C.push(ab);return true}});if(C.length===0){Z=A.get("installType");C.push(p.productList.findWhere({granted:true,installType:Z}))}D={title:G?e.String.format(k("update"),J.get("title")):k("updateallprocesses"),id:"update",products:C}}else{if(e.is(L)){I.push(p.productList.get(L))}else{J.get("licenses").forEach(function(aa){I.push(p.productList.get(aa.id))})}Z=I[0].get("installType");C=p.productList.where({installType:Z,granted:true});if(!y(C,I)&&!G){K={title:k("installallgranted"),id:"allgrantedprocesses",products:C}}U={title:G?e.String.format(k("install"),J.get("title")):e.String.format(k("installallcontaining"),J.get("title")),id:K?"allcontainingprocesses":"allgrantedprocesses",products:I};if(!X){X=p.installList.find(function(aa){return aa.get("online")===true&&aa.get("installType")===Z&&aa.isCompatible(p.releases)&&aa.isAvailableForInstallation()})}}N=A||X;if(N){M=p.installLevelList.get(N.get("dpId"));z=M._levels.last()}else{H=p.stackList.get(Z);z=H._levels.last()}B=e.createElement("div",{"class":"compass-install-desc compass-install-intro",html:A?e.String.format(k("readyupdate"),z.get("commercialName")):e.String.format(k("readyinstallation"),Q?N.get("name"):z.get("commercialName"))});if(T.length===0){P=null}else{T.push({label:k("DefaultInstallationLocation"),value:"cloud"});R=T.map(function(ab,aa){return{label:ab.label||ab,value:typeof ab.value!=="undefined"?ab.value:ab,selected:aa===0}});E=new n({placeholder:false,options:R});F=e.createElement("div",{"class":"compass-install-path",html:[{tag:"div","class":"compass-install-desc",text:k("instfilelocation")},E]})}var V=J.get("powerBy")&&J.get("powerBy").extendedApp&&J.get("powerBy").baseApp.extraInstall&&J.get("powerBy").baseApp.extraInstall!==L?function(){J.set("licenses",[{id:J.get("powerBy").baseApp.extraInstall}]);J.set("powerByBase",true);require(["DS/i3DXCompassServices/i3DXCompassPubSub"],function(aa){aa.publish("installApp",{appId:J.get("id")},function(){J.set("licenses",[{id:J.get("powerBy").extendedApp.extraInstall}]);J.set("powerByBase",false);J.unset("install")})})}:function(){e.log("Nothing to do for ExtraDriveInstall")};if(!W||(A&&A.get("uninstall")===true)||F){O=e.createElement("div",{html:[B,A&&A.get("uninstall")===true?d():"",(X&&!Q&&!z.get("selectedInstall")?{tag:"div","class":"compass-install-desc",html:e.String.format(k("nbcompleteupdgraded"),z.get("commercialName"))}:null),(Q?new l({products:{title:e.String.format(k("installallcontentavailable"))},events:{onClick:S.bind(p,K,V,Q)}}):null),(D&&!Q?new l({products:D,events:{onClick:S.bind(p,D,V)}}):null),(!W&&K&&!Q?[new l({products:K,events:{onClick:S.bind(p,K,V)}}),{tag:"div","class":"compass-install-desc",html:e.String.format(k("orinstallrelated"),J.get("title"))}]:null),(U&&!Q?new l({products:U,events:{onClick:S.bind(p,U,V)}}):null),F]});p.modal=new a({className:"compass-modal",closable:true,visible:true,events:{onHide:function(){p.modal.destroy()}},header:"<h4>"+k("3dexperienceinstallation")+"</h4>",body:O,footer:{tag:"button","class":"btn btn-default",text:k("cancel"),events:{click:function(){p.modal.hide()}}}}).inject(document.body)}else{if(U){S.call(p,U,Y)}else{if(D){S.call(p,D,Y)}}}},_getExtraInstall:function(D,z,E,B,y,A,C){p.onlineInstallationMenu(D,z,E,B,y,A,C)},launchInstallation:function(F,E,y,A,I,B,z){var C,D={},G=[],H=E?E.get("daemonId"):null;F.products.forEach(function(K){var J=K.get("env")[0];if(!D[J]){D[J]=[]}if(!z||(z&&E&&E.get("processes").indexOf(K.get("id")))>-1){D[J].push(K.get("id"))}});Object.keys(D).forEach(function(J){G.push({oiid:J,process:D[J]})});C={clusterID:m.clusterId,processToInstallForOid:G,osds:"win_b64",release:p.releaseForInstall,webServiceURL:m.onlineInstallUrl,codeType:y.get("codeType"),levelType:A,codeLevel:z?E.get("lastBuildId"):y.get("codeLevel"),instVarData:{MyAppsURL:c||m.myAppsBaseUrl,Cas:null,PassportUrl:m.passportUrl},dataStoragePath:I||null,baseInstallIdForHF:H};if(z){C.installCnt=true}if(p.modal){p.modal.hide()}m.getCasTgcAndCasTransientUrl({onComplete:function(L,K){e.log(C);C.instVarData.Cas=L;C.instVarData.x3ds_transient_auth_url=K;if(E&&E.get("uninstall")){var J=e.merge({release:E.get("level"),codeLevel:E.get("lastBuildId"),installId:H,uninstVarData:{uninstallType:"upgrade"}},C);s.uninstallMedia({params:J,onComplete:function(){C.baseInstallIdForHF=null;C.levelType="Both";s.installMedia({params:C,onComplete:function(){v.dispatchEvent("onShowMessage",k("installationsuccess"));v.dispatchEvent("onHideMessage",5000);if(B){if(typeof B==="function"){B()}else{if(B.onComplete){B.onComplete()}}}},onFailure:function(M){e.log(M);switch(M.returnCode){case 100:v.dispatchEvent("onShowMessage",k("launcherbusyretry"));break;case 152:v.dispatchEvent("onShowMessage",k("installationerroraccess"));break;case 155:v.dispatchEvent("onShowMessage",k("installationerrordiskspace"));break;case 157:v.dispatchEvent("onShowMessage",k("installationcancelled"));break;default:v.dispatchEvent("onShowMessage",k("installationerror"))}v.dispatchEvent("onHideMessage",5000);if(B){if(typeof B==="function"){B()}else{if(B.onFailure){B.onFailure()}}}}});v.dispatchEvent("onShowMessage",k("launchinginstallation"));v.dispatchEvent("onHideMessage",5000)},onFailure:function(M){e.log("onFailure");e.log(M)}})}else{s.installMedia({params:C,onComplete:function(){v.dispatchEvent("onShowMessage",k("installationsuccess"));v.dispatchEvent("onHideMessage",5000);if(B){if(typeof B==="function"){B()}else{if(B.onComplete){B.onComplete()}}}},onFailure:function(M){e.log(M);switch(M.returnCode){case 100:v.dispatchEvent("onShowMessage",k("launcherbusyretry"));break;case 152:v.dispatchEvent("onShowMessage",k("installationerroraccess"));break;case 155:v.dispatchEvent("onShowMessage",k("installationerrordiskspace"));break;case 157:v.dispatchEvent("onShowMessage",k("installationcancelled"));break;default:v.dispatchEvent("onShowMessage",k("installationerror"))}v.dispatchEvent("onHideMessage",5000);if(B){if(typeof B==="function"){B()}else{if(B.onFailure){B.onFailure()}}}}});v.dispatchEvent("onShowMessage",k("launchinginstallation"));v.dispatchEvent("onHideMessage",5000)}}})},getCompatibleInstalls:function(C,D,B,y){var z=p.installList,E=p.productList;function A(G){var H=G.get("id"),F=G.get("thirdParty");if(G.get("powerBy")){H=G.get("powerBy").extendedApp?G.get("powerBy").extendedApp.id:G.get("powerBy").baseApp.id;if(G.object&&G.object.serviceId==="3DDrive"||G.get("powerByBase")){H=G.get("powerBy").baseApp.id}}return z.filter(function(I){return I.isCompatible(p.releases)&&(F||I._apps.get(H))})}if(!E){E=p.productList=new u({installList:z})}z.fetch({_silent:y,onComplete:function(){E.update({onComplete:function(H,G){var F;if(G.change){p.extractDpData(G)}if(e.is(C,"array")){F=C.map(A)}else{F=A(C)}D(F)}})},onFailure:function(){if(B){B()}}})},extractDpData:function(A){var y=p.releases=[],z=function(B){var C=B;if(B===p.NEW_INSTALL_FORCE_UPDATE_UNINSTALL){C=p.INSTALL_FORCE_UPDATE}else{if(B===p.NEW_INSTALL_ADDITIONAL){}else{if(B===p.NEW_INSTALL_PROPOSE_UPDATE_UNINSTALL){C=p.INSTALL_PROPOSE_UPDATE}else{if(B===p.NEW_INSTALL_ERROR){C=p.INSTALL_NOTHING_TO_DO}}}}return C};if(A.myapps){p.cloud=A.myapps.cloud;p.installationPaths=A.myapps.installationPaths||[]}if(A.downloadplatform&&A.downloadplatform.result&&A.downloadplatform.result.stacks){A.downloadplatform.result.stacks.forEach(function(B){B.levels.forEach(function(C){b.pushUnique(y,C.release.substr(1,3))})});p.stackList.set(A.downloadplatform.result.stacks);p.installLevelList.set(A.downloadplatform.result.installs);p.installList.forEach(function(E){var C=p.installLevelList.get(E.get("dpId")),B=C?z(C.get("instruction")):0,D=E.get("processes").every(function(G){return p.productList.get(G).get("online")}),F=D&&C&&C._levels.length>0&&B!==p.INSTALL_NOTHING_TO_DO&&B!==p.INSTALL_GA_ON_GA;E.set({online:D,update:F,status:B,uninstall:C.get("instruction")===p.NEW_INSTALL_PROPOSE_UPDATE_UNINSTALL||C.get("instruction")===p.NEW_INSTALL_FORCE_UPDATE_UNINSTALL,installType:C?C.get("stack"):null,targetSPLevel:C&&C._levels&&C._levels.length>0?C._levels.last().get("targetSPLevel"):null})})}if(A.transactionId){p.releaseForInstall=A.transactionId.split("-")[0]}if(y.length===0&&p.releaseForInstall){p.releases.push(p.releaseForInstall.substr(1,3))}},getInstall:function(y){return p.installList.get(y)}};return p});define("DS/i3DXCompass/Model/App",["UWA/Core","UWA/Utils","UWA/Class/Model","DS/i3DXCompass/Tools","DS/i3DXCompass/Data","DS/i3DXCompass/DaemonManager","DS/i3DXCompass/InstallManager","DS/i3DXCompass/EventManager","DS/i3DXCompass/X3DContent","UWA/Utils/Cookie","DS/i3DXCompass/Types"],function(i,k,d,f,n,m,o,g,c,b,h){var j="Native",a="Web",l="Widget",p="Role",e={setup:function(){this.set("lowerCaseTitle",(this.get("title")||"").toLowerCase())},isNative:function(){return this.get("type")===j},isNativeMarketApp:function(){return this.isNative()&&(f.isValidMarketAppUrl(this.get("launchInfos"))||(this.get("platforms")&&this.get("platforms").length>0&&f.isValidMarketAppUrl(this.get("platforms")[0].launchInfos)))},isWeb:function(){return this.get("type")===a},isWidget:function(){return this.get("type")===l},isAggregate:function(){return this.get("apps")&&this.get("apps").length>1},isRole:function(){return this.get("type")===p},isServiceSwym:function(){return this.get("service")===2},isServiceSpace:function(){return this.get("service")===1},matchesFilters:function(r){var q=this;return r.every(function(t){var s=t.key,u=t.value;if(s==="searched"){return !u||q.get("lowerCaseTitle").indexOf(u)!==-1||(q.get("tooltip")&&q.get("tooltip").toLowerCase().indexOf(u)!==-1||(q.id&&(q.id.toLowerCase().indexOf("_ap")!==-1&&u.indexOf("_ap")!==-1&&q.id.toLowerCase().indexOf(u)!==-1||(q.id.toLowerCase().indexOf("_ap")===-1&&q.id.toLowerCase().indexOf(u)!==-1))))}if(s==="appIds"){return !u||u.indexOf(q.id)!==-1}if(s==="visibleQuadrant"){return !u||["north","west","south","east"].indexOf(q.get("quadrant"))!==-1}if(i.typeOf(q[s])==="function"){return(q[s]()===u)}return(q.get(s)===u)})},_isRemoteDisabled:function(){return b.get("3dremotevm")==="true"},getInstallList:function(v,u,r,q){var s=this,t=[this];if(v){t.push(v)}o.getCompatibleInstalls(t,function(w){var z=w[0],A=w[1]||[],y=s.get("install"),x;w[0]=z.filter(function(B){return B.get("status")!==o.NEW_INSTALL_ADDITIONAL});z=w[0];if(s._isRemoteDisabled()){A=[];if(y==="remote"){y=null}}if(y==="remote"&&A.length>0){x=A[0]}else{x=o.getInstall(y);if(z.indexOf(x)===-1){x=null;y=null}if(!x&&z.length===1&&A.length===0){x=z[0];y=x.get("id");s.set("install",y)}}if(!x&&z.length===0){if(A.length>0){y="remote";x=A[0]}else{y=null}}u(w,x,y)},function(){if(r){r()}},q)},isOnlineInstallable:function(){var q=this.get("licenses"),r=o.productList;return o.cloud&&this.isNative()&&!this.isNativeMarketApp()&&(q.length>0)&&q.every(function(s){var t=r.get(s.id);if(!t){g.dispatchEvent("onMissingProcess");return false}return t.get("online")})},canAdditionalContent:function(q){var r=this,s=q.find(function(t){return t.get("appList").indexOf(r.get("id"))>-1});return o.cloud&&s&&s.get("additionalContent")===true},getLaunchInfos:function(q,t,s){var u=this.get("launchInfos"),w,y=function(z){return !z||typeof z!=="string"||!z.trim()};if(this.object!==undefined&&this.object.envId){w=this.get("platforms")&&this.get("platforms").detect(function(z){return z.id===this.object.envId}.bind(this));if(w&&(w.launchUrl||w.launchInfos)){u=this.isWidget()?w.launchUrl:w.launchInfos}}if((this.object!==undefined||h.get())&&this.isNative()){var r=this.object,x=c.getX3DContent();if(r===undefined&&x){r=x.data.items[0]}if(u){u=u.replace("-workbench ","--AppName=");if(r!==undefined){if(!y(r.contextId)){u+=t+"-Ctx"+t+'"'+r.contextId+'"';if(u.search("-Prfctx")!==-1){u=u.replace(t+"-Prfctx","")}}if(!y(r.objectId)){u+=t+"-object"+t+r.objectId;if(!y(r.serviceId)){u+=t+"-serviceId"+t+r.serviceId}if(!y(r.objectType)){u+=t+"-objectType"+t+'"'+r.objectType+'"'}}u+=t+"-e"+t+"CATUNILoadFromWebCmdHdr"+t+"Open"}}}if(u&&this.get("powerBy")){var v=this.get("powerBy").extendedApp?this.get("powerBy").extendedApp.id:this.get("powerBy").baseApp.id;if(this.object&&this.object.serviceId==="3DDrive"){v=this.get("powerBy").baseApp.id}u=u.replace(this.get("id"),v)}if(q){u+=t+'-Cas="CASTGC='+q+'"'}if(s){u+=t+'-x3ds_transient_auth_url="'+s+'"'}i.log(u);return u},getShortcutLaunchInfos:function(){var r,q=this.get("shortcutLaunchInfos");if(this.get("powerBy")){r=this.get("powerBy").extendedApp?this.get("powerBy").extendedApp.id:this.get("powerBy").baseApp.id;q=q.replace(this.get("id"),r)}return q},install:function(q){var r=this,s=this.getRemoteApp();this.getInstallList(s,function(t,v,u){var w=u==="remote",x=w?s:r;if(v){if(v.get("update")&&v.get("status")===o.INSTALL_FORCE_UPDATE||(q.forceUpdate&&v.get("update")&&v.get("status")===o.INSTALL_PROPOSE_UPDATE)){if(q&&!q.eventDetection){q.onFailure({error:"mandatory_update",install:v,app:x,remote:w})}else{q.onFailure({error:"recommended_update",install:v,app:x,remote:w})}}else{q.onComplete({success:true})}}else{if(t[0].length===0&&(t[1]||[]).length===0){q.onFailure({error:"no_install_compatible",remoteAvailable:!!s})}else{q.onFailure({error:"no_install_selected"})}}},function(){q.onFailure({error:"unable_install_data"})},q.silent)},_launchTransient:function(s,r){var t=this,u,q;if(this.object!==undefined){if(this.isWeb()){if(this.isServiceSwym()){if(this.object.hasOwnProperty("contextId")&&this.object.contextId==="Swym"){s=this.object.objectId}}else{if(this.isServiceSpace()){if(this.object.hasOwnProperty("contextId")){if(s){s+=((s.search("[?&]")!==-1)?"&":"?");s+="SecurityContext="+k.encodeUrl(this.object.contextId)+"&objectId="+this.object.objectId}}}}}}if(s&&i.is(n.addinMode)&&t._isCompatibleAddin(t)){if(n.addinMode&&n.addinMode.value){s=this._addQueryParams(s,"addinmode",n.addinMode&&n.addinMode.value)}}u=c.getX3DContent();n.get3DDashboardUrl(function(v){q=s.indexOf(v)>-1;if(t.isWidget()&&(q||t.isServiceSwym())&&i.typeOf(u)==="object"&&!(Object.keys(u).length===0)){s+=(s.endsWith("/")?"":"/")+(s.contains("#")?"":"#")+"content:X3DContentId="+encodeURIComponent(JSON.stringify(u))}if(t.isWidget()&&q&&v&&window.location.href.toLowerCase().indexOf(v.replace("https://","").toLowerCase())>-1){var w=i.Utils.parseUrl(s).anchor;if(window.location.hash===w){w+="/"}if((t._supportBigUrl(s)&&i.is(n.addinMode)===false)||t._isCompatibleAddin(t)){window.location.hash=w}else{window.open(s,"_blank")}}else{if(f.isSameApp(s,window.location)){if(!f.customLaunchWebApp(s)){if(i.is(n.addinMode)===false){window.open(s,"_self")}else{window.open(s,"_blank")}}}else{if(t._isCompatibleAddin(t)){window.open(s,"_self")}else{window.open(s,"_blank")}}}r.onComplete({success:true})})},_supportBigUrl:function(s){var r=f.getBrowser(),q=(r==="internet explorer"||r==="edge")&&s.length>2045;return !q},_addQueryParams:function(r,q,v){var u,s=r,t="";if(r.indexOf("#")>-1){s=r.split("#")[0];t=r.split("#")[1]}u=s.indexOf("?")===-1?"?":"&";return s+u+q+"="+v+(t?"#"+t:"")},_isCompatibleAddin:function(r){var q=this;if(i.is(n.addinMode)&&r.get("apps")&&r.get("apps").length>1){return r.get("apps").detect(function(s){return q._isCompatibleAddin(new d(s))})}else{return i.is(n.addinMode)&&i.is(n.addinMode.value)&&r.get("addin")&&r.get("addin").detect(function(s){return s.toLowerCase()===n.addinMode.value.toLowerCase()})}},_launchTransition:function(r,q){var t=this,s={id:this.get("id"),launchInfos:this.get("launchInfos"),title:this.get("title"),brand:this.get("brand"),config:this.get("config"),success:function(){i.log("Success in transition")},failure:function(){t._launchTransient.call(t,r,q)}};require(["DS/AppFrameGlobal/AppFrame3DD"],function(u){u.loadAppInfoAndDoTransition(s)})},launch:function(r){var t=this,q=this.isWidget()?this.get("launchUrl"):this.get("launchInfos"),w,u,v,s=c.getX3DContent();if(this.isWidget()){q=this.isAggregate()&&!this.get("platformId")?false:this.get("launchUrl")}else{q=this.get("launchInfos")}if(this.object!==undefined&&this.object.envId){w=this.get("platforms").detect(function(x){return x.id===this.object.envId}.bind(this));if(w&&(w.launchUrl||w.launchInfos)){q=this.isWidget()?w.launchUrl:w.launchInfos}if(!q&&this.isAggregate()&&this.isWidget()){q=this.get("launchUrl")}}else{if(s&&s.data&&s.data.items.length>0){w=this.get("platforms").detect(function(x){return x.id===s.data.items[0].envId});if(w&&(w.launchUrl||w.launchInfos)){q=this.isWidget()?w.launchUrl:w.launchInfos}}}if(!q){r.onFailure({error:"no_launch_infos"})}else{if(typeof compassRichWithCef!=="undefined"){i3DXCompassPubSub.publish("launchAppCallback",this.toJSON())}else{switch(this.get("type")){case a:case l:if(this.get("transition")&&i.is(n.addinMode)===false){this._launchTransition(q,r)}else{this._launchTransient(q,r)}break;case j:if(f.getOs()==="ios"||f.getOs()==="android"){n.getCasTgcAndCasTransientUrl({onComplete:function(z,x){var A=t.getLaunchInfos(z,"&",x);i.log("open "+A);if(f.getMajorIosVersion()!==8){i.log("ios version != 8");u=new Date();window.setTimeout(function(){i.log("setTimeout");if(new Date()-u<1200){i.log("onFailure");if(f.getOs()==="ios"){r.onFailure({error:"ios_app_not_installed"})}else{r.onFailure({error:"android_app_not_installed"})}}else{i.log("onComplete");r.onComplete({success:true})}},1000);window.location=A}else{i.log("ios version = 8");var y=i.createElement("iframe",{styles:{border:"none",width:1,height:1},src:A});i.log("inject iframe");y.inject(document.body);u=new Date();setTimeout(function(){i.log("setTimeout");if(new Date()-u<1200){i.log("onFailure");if(f.getOs()==="ios"){r.onFailure({error:"ios_app_not_installed"})}else{r.onFailure({error:"android_app_not_installed"})}}else{i.log("onComplete");r.onComplete({success:true})}i.log("destroy iframe");y.destroy()},1000)}}})}else{if(this.isNativeMarketApp()){n.getCasTgcAndCasTransientUrl({onComplete:function(A,y){var C=t.getLaunchInfos(A,"&",y),E,D,x=f.getBrowser();if(x==="internet explorer"||x==="edge"){navigator.msLaunchUri(C,function(){console.log("success")},function(){i.log("onFailure");r.onFailure({error:"windows10_app_not_installed"})})}else{if(x==="firefox"){var z=document.querySelector("#hiddenIframe")?document.querySelector("#hiddenIframe"):document.createElement("iframe");if(!document.querySelector("#hiddenIframe")){z.src="about:blank";z.id="hiddenIframe";z.style.display="none";document.body.appendChild(z)}try{z.contentWindow.location.href=C;console.log("success")}catch(B){i.log("onFailure");r.onFailure({error:"windows10_app_not_installed"})}}else{D=function(F){window.clearTimeout(E);i.log("onComplete");r.onComplete({success:true});window.removeEventListener("blur",D)};window.focus();i.log("open "+C);u=new Date();window.addEventListener("blur",D);E=window.setTimeout(function(){i.log("onFailure");r.onFailure({error:"windows10_app_not_installed"});window.removeEventListener("blur",D)},1500);if(i.is(n.addinMode)===false){window.location=C}else{window.open(q,"_blank")}}}}})}else{v=this.getRemoteApp();this.getInstallList(v,function(x,z,y){var A=y==="remote",B=A?v:t;if(z){if(z.get("update")&&z.get("status")===o.INSTALL_FORCE_UPDATE&&!B.isCustom()){r.onFailure({error:"mandatory_update",install:z,app:B,remote:A})}else{n.getCasTgcAndCasTransientUrl({onComplete:function(E,D){console.log(arguments);var C={instID:z.get("daemonId"),exeName:r.support?B.get("supportModeExeName"):B.get("exeName"),envString:B.get("envInfos"),argString:B.getLaunchInfos(E," ",D),nativeLauncherName:B.get("launcher")};if(B.get("powerBy")&&t.object&&t.object.serviceId==="3DDrive"){C.exeName=B.get("powerBy").baseApp.exe}m.startV6install({file:r.file,params:C,onComplete:function(F){r.onComplete({success:true,remote:A});i.log(F)},onFailure:function(F){r.onFailure({error:"applet_error",returnCode:F.returnCode,remote:A});i.log(F)}})}})}}else{if(x[0].length===0&&(x[1]||[]).length===0){r.onFailure({error:"no_install_compatible",remoteAvailable:!!v})}else{r.onFailure({error:"no_install_selected"})}}},function(){r.onFailure({error:"unable_install_data"})},r.silent)}}break}}}},needSettingsMenu:function(){return !this.isRole()&&((this.isNative()&&!this.isNativeMarketApp())||this.get("platforms").length>1)},getRemoteApp:function(){var r,q=this.get("remoteInfos");if(!q){return}r=this.clone();r.set({launcher:q.launcher,exeName:q.exeName,launchInfos:q.remoteLaunchInfos,id:q.remoteAppId,licenses:q.licenses,title:q.title,install:"remote"});return r},addObjectToLaunchInfos:function(){},setObject:function(q){this.object=q},resetObject:function(){if(this.object){delete this.object}},isCustom:function(){return this.get("thirdParty")},extractMyAppsUrlFromLaunchInfo:function(){var r=null,q=this.getLaunchInfos();if(!q){if(this.get("platforms")&&this.get("platforms").length>0){q=this.get("platforms")[0].launchInfos}}if(q&&q.indexOf("-MyAppsURL=")>-1){var s=q.split("-MyAppsURL=");if(s.length>1){s=s[1];if(s&&s.length>0){r=s.split(" ")[0]}}}return r}};return d.extend(e)});define("DS/i3DXCompass/Collection/AppList",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/i3DXCompass/Tools","DS/i3DXCompass/Data","DS/i3DXCompass/Model/App","DS/i3DXCompass/CacheManager"],function(h,g,e,c,f,d,a){var b={model:d,lastResponseId:null,request:null,filterKeys:[],fetch:function(i){var j=this.request;if(j){j.cancel()}return this.request=this._parent(i)},onSync:function(){this.request=null},onError:function(){this.request=null},setup:function(j,i){this.myappsObject={};this.added=[];if(i&&i.master){this.setupSlave(i)}},setupSlave:function(i){this.master=i.master;this.filters=i.filters;this.comparator=i.comparator;this.initFetch();this.filterKeys=this.filters.map(function(j){return j.key});this.master.addEvent("onChange",this.changeApp.bind(this));this.master.addEvent("onMultipleAdd",this.filterAndAdd.bind(this));this.master.addEvent("onRemove",this.removeApp.bind(this))},_getCacheKey:function(){var i=f.getAppsUrl;return i.slice(0,i.indexOf("?"))},_isNotEmptyResponse:function(i){return i.north&&i.west&&i.south&&i.east&&i.north.length>0&&i.west.length>0&&i.south.length>0&&i.east.length>0},sync:function(o,n,i){var l=this,j=this.myappsObject,k,m=null;switch(o){case"read":m=a.getCache(l._getCacheKey());if(!m){this.lastId=null}k=f.request({url:f.getAppsUrl,urlParams:{os:c.getOs(),envid:j.envId,objid:j.hasOwnProperty("objectId")&&(j.hasOwnProperty("envId")||j.hasOwnProperty("contextId"))?j.objectId:null,objtype:j.objectType||null,contextid:j.contextId||null,id:this.lastId||m&&m.id},onComplete:function(p){if(p&&p.code===0){if(l._isNotEmptyResponse(p)){if((!p.id||p.id!==l.lastId)){if(!l.myappsObjectSet){a.setCache(l._getCacheKey(),p)}}if(i&&i.onComplete){if((!p.id||p.id!==l.lastId||l.myappsObjectSet)){i.onComplete(p)}}}}else{if(i&&i.onFailure){i.onFailure(p)}}},onFailure:function(p){if(i&&i.onFailure){i.onFailure(p)}}});if(m){if(m&&m.code===0){if(i&&i.onComplete){setTimeout(function(){i.onComplete(m)},5)}}else{if(i&&i.onFailure){i.onFailure(m)}}}break}return k},parse:function(m,k){var j=["north","west","south","east","other"],i=[],l=[];h.log("Compass refresh: parsing apps");if((!m.id||m.id!==this.lastId)){if(!this.myappsObjectSet){this.lastId=m.id}if(m.favorite&&m.favorite.apps){i=m.favorite.apps.split(",")}j.forEach(function(n){var o=m[n];if(o){o.forEach(function(p,q){var r=(q===1);p.apps.forEach(function(s){s.favoriteOrder=i.indexOf(s.id);s.isFavorite=s.favoriteOrder!==-1;s.lma=r;s.quadrant=n;if(s.remoteInfos===undefined){s.remoteInfos=undefined}l.push(s)})})}});if(m.roles){m.roles.role.forEach(function(n){n.favoriteOrder=-1;n.isFavorite=false;n.lma=false;l.push(n)})}m.changed=true}else{k.remove=false;m.changed=false}return l},set:function(){this.added.length=0;this._parent.apply(this,arguments);if(this.added.length>0){this.dispatchEvent("onMultipleAdd",[this.added])}},onAdd:function(i){this.added.push(i)},initFetch:function(){if(this.master){this.filterAndAdd(this.master)}},removeApp:function(i){if(this.get(i)){this.remove(i)}},filterAndAdd:function(j){var i=j.filter(function(k){return k.matchesFilters(this.filters)},this);if(i.length>0){this.add(i)}},changeApp:function(k){var j=k._changed,i=this.filterKeys.some(function(l){return h.is(j[l])});if(i){if(k.matchesFilters(this.filters)){this.add(k);this.dispatchEvent("onMultipleAdd",[[k]])}else{this.removeApp(k)}}if(this.get(k)&&h.is(j[this.comparator])){this.sort();this.dispatchEvent("onReorderApp",k)}},filterApps:function(i){return this.filter(function(j){return j.matchesFilters(i)})},getPrevious:function(j){var i=this.indexOf(j)-1;if(i<0){return null}return this.at(i)},count:function(i){return this.reduce(function(j,k){return k.matchesFilters(i)?j+1:j},0)},setObject:function(i){this.myappsObjectSet=i.hasOwnProperty("objectId");if(this.myappsObjectSet){this.forEach(function(j){j.setObject(i)})}else{h.log("Object is not valid for setObject")}},resetObject:function(){this.forEach(function(i){i.resetObject()})},saveFavorites:function(){var i=this.pluck("id").join(",");f.request({url:f.setFavoriteUrl,method:"POST",contentType:"application/x-www-form-urlencoded",postData:{value:i},onComplete:function(){},onFailure:function(){}})},saveRoles:function(j){var i=this.where({active:true}),k=i.map(function(l){return l.get("process")}).join(",");f.setPreference({name:"active_roles",value:k,onComplete:function(){if(j&&j.onComplete){j.onComplete()}}})},getSelectedRoleApps:function(){var i=[],j=this.where({active:true});if(this.length===j.length){return null}j.forEach(function(k){k.get("appList").forEach(function(l){c.pushUnique(i,l)})});return(i)}};return e.extend(b)});define("DS/i3DXCompass/Controls/Settings",["UWA/Core","DS/i3DXCompass/Tools","DS/i3DXCompass/InstallManager","DS/UIKIT/DropdownMenu"],function(f,c,b,a){var e=f.i18n,d=a.extend({customClass:"compass-app-settings",iconClass:"fonticon fonticon-check",clickInstallId:"clickinstall",clickInstallRemoteId:"clickremote",init:function(t){this.app=t.app;var m=this,k=t.data,q=k.installs,s=k.remoteInstall,l=k.platforms,r=t.preferredInstallId,o=t.processes,p=t.onlineInstallable,h=q?q.map(function(u){return this.getInstallItem(u,r,o,p,false,t.shortcutEnabled,t.additionalContent)},this):null,g=h&&h.length===0,j=(l&&(!g||s))?l.map(this.getPlatformItem,this):null,n=j||[],i;if(g){h.push({className:"header no-install",html:k.error?k.error:f.String.format(e("noinstall"),t.appTitle)});if(p){h.push({className:"download-link",name:this.clickInstallId,text:e("clickinstall")})}}if(h&&t.remoteEnabled){h.push({className:"divider"});if(s){h.push(this.getInstallItem(s,r,[],p,true,false))}else{if(p){h.push({className:"download-link",name:this.clickInstallRemoteId,text:f.String.format(e("install"),t.remoteAppTitle)})}}}if(j&&h){n.push({className:"divider"})}n=n.concat(h||[]);i={items:n,altPosition:function(){var C=m.elements,A=C.container.offsetWidth,v=C.container.offsetHeight,z=window.innerWidth,w=window.innerHeight,B=20,u=t.position.x,D=t.position.y;if(u+A+B>z){u=z-A-B}if(D+v+B>w){D=w-v-B}return{x:u,y:D}},renderTo:document.body,target:t.target,events:t.events,shortcutEnabled:t.shortcutEnabled};this._parent(i);this.trigger=t.trigger},buildSkeleton:function(){var g;this._parent();if(this.menus){g=this.menus[0];this.items=g.items;this.items.forEach(this.editItem,this)}this.elements.container.addClassName(this.customClass)},editItem:function(i){var h=this,g=i.elements.container;if(i.html){g.setContent(i.html)}if(i.type==="install"){if(i.shortcut){g.addClassName("has-shortcut");f.createElement("div",{"class":"action shortcut",title:e("createshortcut"),events:{click:function(){h.dispatchEvent("onClickShortcut",i.name)}}}).inject(g)}if(i.update||i.newProc){g.addClassName("has-update");f.createElement("div",{"class":"action update"+(i.update?(i.mand?" mand":""):(i.newProc?" new":"")),title:i.update?(i.mand?e("updateneeded"):e("updateavailable")):(i.newProc?e("newprocessesavailable"):""),events:{click:function(){h.dispatchEvent("onClickUpdate",[i.name,i.update]);h.hideSettings()}}}).inject(g)}if(i.additionalContent&&!i.mand){g.addClassName("has-additional");f.createElement("div",{"class":"fonticon fonticon-install",title:e("additionalcontentavailable"),events:{click:function(){h.dispatchEvent("onClickAdditional",i.name);h.hideSettings()}}}).inject(g)}}},getPlatformItem:function(g){return{text:g.name,name:g.id,type:"platform",className:"platform-item",icon:g.preferred?this.iconClass:null,preferred:g.preferred}},getInstallItem:function(l,g,i,h,k,n,j){var m=k?g==="remote":l.get("id")===g;return{text:k?e("remoteit"):l.get("name"),name:k?"remote":l.get("id"),type:"install",className:"install-item",icon:m?this.iconClass:null,additionalContent:j&&l.get("isContentInstalled")!==true,preferred:m,mand:(l.get("status")===b.INSTALL_FORCE_UPDATE)&&!this.app.isCustom(),update:l.get("update")&&!this.app.isCustom(),shortcut:n,newProc:h&&l.get("online")&&l.get("status")!==b.INSTALL_GA_ON_GA&&!c.includes(l.get("processes"),i)&&!this.app.isCustom()}},onClick:function(k,i){var h=this,g=i.type,j={};if(i.name===this.clickInstallId){this.dispatchEvent("onClickInstall");this.hideSettings();return}if(i.name===this.clickInstallRemoteId){this.dispatchEvent("onClickInstallRemote");this.hideSettings();return}this.items.forEach(function(l){if(l.type===g&&l!==i&&l.preferred){l.icon=null;l.preferred=false;h.updateItem(l)}});i.icon=this.iconClass;i.preferred=true;h.updateItem(i);j[i.type]=i.name;this.dispatchEvent("onPlatformChange",j)},onClickOutside:function(h){var g=h.target;if(g&&g===this.trigger){h.stopPropagation()}this.hideSettings()},hideSettings:function(){var g={};this.items.forEach(function(h){if(h.preferred){g[h.type]=h.name}});this.dispatchEvent("onHideSettings",g);this.hide();this.destroy()},updateItem:function(g){if(g.icon){if(g.elements.icon){g.elements.icon.className=g.icon}else{g.elements.icon=f.createElement("span",{"class":g.icon}).inject(g.elements.container,"top")}}else{if(g.elements.icon){g.elements.icon.destroy();delete g.elements.icon}}}});return d});define("DS/i3DXCompass/View/MyApps",["UWA/Core","UWA/Utils/Client","UWA/Class/View","UWA/Controls/Accordion","UWA/Controls/Scroller","UWA/Class/Collection","DS/i3DXCompass/Tools","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data","DS/i3DXCompass/DaemonManager","DS/i3DXCompass/InstallManager","DS/i3DXCompass/TopBarManager","DS/i3DXCompass/Collection/AppList","DS/i3DXCompass/View/AppListView","DS/i3DXCompass/View/SuggestionListView","DS/i3DXCompass/Controls/Message","DS/i3DXCompass/Controls/Settings","DS/i3DXCompass/Controls/ScrollAccordion","DS/i3DXCompass/Controls/Search","DS/i3DXCompass/Controls/IframeLoader","DS/UIKIT/Modal","DS/UIKIT/Spinner","DS/UIKIT/Input/Button","DS/i3DXCompass/View/ServicesView","DS/i3DXCompass/CacheManager","DS/i3DXCompassServices/i3DXCompassPubSub","DS/i3DXCompass/Types","UWA/Utils/Cookie","DS/i3DXCompass/Controls/Compass","DS/i3DXCompass/UsageTracker","DS/UIKIT/Tooltip"],function(j,t,y,f,B,F,c,D,r,x,z,d,h,v,g,a,C,o,m,E,b,n,q,k,G,e,w,l,s,u,A){var p=j.i18n,i={tagName:"div",className:c.getOs()==="windows10"?"wind10 my-apps-panel":"my-apps-panel",domEvents:{"click .compass-close":"close","click .exp-item":"clickApp","click .suggestion-item":"clickSuggestion","click .settings-img":"clickSettings","click .expand-img":"clickExpand","click .all-roles-btn":"toggleAllRoles","click .expanded-role-close, .expanded-role-title":"hideRoleDetail","click .expanded-role-info":"clickRoleInfo"},currentQuadrant:"",itemsPerLine:0,setup:function(H){this.options=H;D.addEvents({onShowMessage:this.showMessage.bind(this),onHideMessage:this.hideMessage.bind(this)});this.collections={grantedRoles:new h(null,{master:this.collection,comparator:"title",filters:[{key:"isRole",value:true},{key:"granted",value:true}]}),visibleRoles:new h(null,{master:this.collection,comparator:"title",filters:[{key:"isRole",value:true},{key:"granted",value:true},{key:"visible",value:true}]})};this.views={};this.sugCollection=H.sugCollection},render:function(){var I=this.container,H=this.maskElmt=j.createElement("div",{"class":"compass-loading",html:new n({visible:true,className:"compass-spinner"})}),J;H.inject(I);if(this.options.closable){J=j.createElement("button",{"class":"close compass-close fonticon fonticon-cancel",attributes:{type:"button","aria-hidden":true}});I.appendChild(J);new A({position:"left",target:J,body:p("Close")})}I.hide();return this},renderAppsView:function(M){var K=this,H=this.elements,I=this.container,Q,L,P=new a(),J=this.collections,O,N=this.views;J.favorite=new h(null,{master:this.collection,comparator:"favoriteOrder",filters:[{key:"isFavorite",value:true},{key:"visibleQuadrant",value:true}]});J.platformRoles=new h(null,{master:this.collection,comparator:"title",filters:[{key:"isRole",value:true},{key:"granted",value:false},{key:"visible",value:true}]});J.expandedRole=new h(null,{master:this.collection,comparator:"title",filters:[{key:"isRole",value:false},{key:"lma",value:false},{key:"visibleQuadrant",value:true}]});J.apps={};J.lma={};O=J.grantedRoles.getSelectedRoleApps();N.favorite=new v({collection:J.favorite,customFilters:{appIds:O},customClass:"favorite",favorite:true,draggable:true});N.visibleRoles=new v({collection:J.visibleRoles,customClass:"roles",draggable:true});N.platformRoles=new v({collection:J.platformRoles,customClass:"roles not-available-roles",draggable:false});N.expandedRole=new v({collection:J.expandedRole,customFilters:{appIds:[]},draggable:true});N.apps={};N.lma={};this.options.sectionData=M;if(H.error){H.error.destroy();delete H.error}this.forEachQuadrant(function(R){J.apps[R]=new h(null,{master:K.collection,comparator:"title",filters:[{key:"quadrant",value:R},{key:"lma",value:false}]});J.lma[R]=new h(null,{master:K.collection,comparator:"title",filters:[{key:"quadrant",value:R},{key:"lma",value:true}]});N.apps[R]=new v({collection:J.apps[R],customFilters:{appIds:O},customClass:R,draggable:true});N.lma[R]=new v({collection:J.lma[R],customClass:R})});if(M.eservices&&M.eservices.data&&M.eservices.data.length>0){J.eservices=new F(M.eservices.data);N.eservices=new k({collection:J.eservices})}I.addEvent("resize",function(R){K.resizeAccordionData(R)});Q=new m({events:{onSearch:function(R){K.searchInViews(R)}}});if(!j.is(G._getUser())){Q.container.setStyle("visibility","hidden")}Q.inject(I);H.search=Q;L=this.buildAccordion();j.createElement("div",{"class":"compass-accordion-wrapper",html:L}).inject(I);P.inject(I);this.appsAccordion=L;this.message=P;this.resizeAccordionData();J.grantedRoles.addEvent("onChange:active",this.changeRoles.bind(this));J.grantedRoles.addEvent("onChange:appList",this.changeRoles.bind(this));J.grantedRoles.addEvent("onRemove",this.changeRoles.bind(this));J.grantedRoles.addEvent("onMultipleAdd",this.changeRoles.bind(this))},renderSuggestionsView:function(){this.getSuggestionsView().renderSuggestions();if(this.appsAccordion&&this.getSuggestionsView().collection.length>0){this.appsAccordion.showSection("suggestions-section")}},getSuggestionsView:function(){var H=this.views;if(!H.suggestions){H.suggestions=new g({collection:this.sugCollection})}return H.suggestions},renderErrorView:function(H){var I=this.elements;if(!I.error){I.error=j.createElement("div",{"class":"compass-error",text:H}).inject(this.container)}},_needToShowMyRoles:function(){return this.collections.visibleRoles.length>1||this.collections.platformRoles.length>0},buildAccordion:function(){var M,L=this,O=this.options.sectionData,Q=false,R=[],S=this.views,H=this.elements,I=[],P=[],K=H.expandedRole=j.createElement("div",{tag:"div","class":"expanded-role",html:[{"class":"expanded-role-title"},{tag:"span","class":"fonticon fonticon-left-open expanded-role-close"},{tag:"span","class":"fonticon fonticon-info-circled expanded-role-info"},this.views.expandedRole.render()]}),N=H.allRolesBtn=j.createElement("span",{"class":"fonticon fonticon-down-dir fonticon-interact all-roles-btn"}),J=this.getSuggestionsView(),T=S.eservices,U=j.Utils.Client.Features.touchEvents;if(!U){new A({position:"left",target:N,body:p("Show more roles")})}this.forEachQuadrant(function(V){I.push(S.apps[V].render());if(Q===false&&S.apps[V].collection.size()>0){Q=true}I.push(j.createElement("div",{"class":"alert-message alert-default noapps "+V,text:O[V].noapps}));P.push(S.lma[V].render())});if(O.services&&O.services.data&&O.services.data.length>0||T){R.push({id:"wrapperMP",title:p("3DEXPERIENCEMarketplace")||O.wrapperMP&&O.wrapperMP.title,html:T?j.createElement("div",{styles:{height:10}}):new k({collection:new F(O.services&&O.services.data||[])}).render(),open:!O.wrapperMP.closed,visible:true,name:T?"learn-more-about-section":"services-section"})}if(T){R.push({id:"eservices",parent:"wrapperMP",icon:"component",title:O.eservices&&O.eservices.title,html:S.eservices.render(),open:!O.eservices.closed,visible:true,name:"services-section"})}if(T&&O.services&&O.services.data&&O.services.data.length>0){R.push({id:"services",parent:"wrapperMP",icon:"globe",title:O.services&&O.services.title||p("MyCommunityServices"),html:new k({collection:new F(O.services&&O.services.data||[])}).render(),open:!O.services.closed,visible:true,name:"services-section"})}R.push({id:"wrapperRole",title:O.wrapperRole.title||p("wrapperRole"),html:j.createElement("div",{styles:{height:10}}),open:!O.wrapperRole.closed,visible:j.is(G._getUser()),name:"learn-more-about-section"});R.push({id:"roles",parent:"wrapperRole",title:O.roles.title,icon:"role roles",html:[S.visibleRoles.render(),j.createElement("div",{"class":"alert-message alert-default noapps roles",text:O.roles.noapps}),S.platformRoles.render(),N,K],open:!O.roles.closed,visible:this._needToShowMyRoles(),name:"my-roles-section"});if(j.is(G._getUser())){R.push({id:"favorite",parent:"wrapperRole",title:O.favorite.title,icon:"star-empty favorite",html:[S.favorite.render(),j.createElement("div",{"class":"alert-message alert-default noapps favorite",text:p("dropfavoriteappshere")})],open:!O.favorite.closed,visible:true,name:"my-favorite-apps-section"})}if(Q){R.push({id:"apps",parent:"wrapperRole",title:"",html:I,open:!O.north.closed,visible:true,name:"my-apps-section"})}if(j.is(j.Array.detect(P,function(V){return !V.getContent().hasClassName("empty")}))){R.push({id:"lma",title:O.lma.title,html:P,open:!O.lma.closed,visible:true,name:"learn-more-about-section"})}R.push({id:"suggestions",title:O.suggestions.title,html:J.render(),open:!O.suggestions.closed,visible:J.suggestionsRendered,name:"suggestions-section"});M=new o({className:"apps-accordion",sections:4,scroller:true,data:R,events:{onToggleSection:this.saveSections.bind(this),onScrollTop:function(){L.dispatchEvent("onScrollTop")},onScrollDown:function(){L.dispatchEvent("onScrollDown")},onRemoveAllFavoriteApp:function(){L.removeAllFavoriteApp()}}});return M},resizeAccordionData:function(){var H=this.container.getSize().width+1-34,I,J=this.itemsPerLine;I=Math.floor(H/88);if(I!==J){this.container.removeClassName("items-per-line-"+J);this.container.addClassName("items-per-line-"+I);this.itemsPerLine=I}},saveSections:function(){var H={};this.container.getElements(".compass-accordion-wrapper .compass-scroll-accordion-section").forEach(function(I){H[I.getAttribute("data-id")]=I.hasClassName("closed")});if(j.is(G._getUser())){r.saveSectionStatus(JSON.stringify(H))}},manageRoleSectionDisplay:function(){if(this.appsAccordion){if(this._needToShowMyRoles()){this.appsAccordion.showSection("my-roles-section")}else{this.appsAccordion.hideSection("my-roles-section");this.collections.visibleRoles.forEach(function(H){this.toggleRole(H,true)},this)}}},initTopBar:function(){var H=this.collections.visibleRoles;d.setRoles(H);H.addEvent("onChange:active",function(I){d.setChecked(I)});H.addEvent("onMultipleAdd",function(){d.setRoles(H)});H.addEvent("onRemove",function(I){if(I.get("granted")===true){d.removeRole(I)}})},searchInViews:function(H){this.filterViews("search",H)},filterAppsInViews:function(H){this.filterViews("filterApps",H)},filterViews:function(M,K){var I=this.views,L=(j.is(K,"string")&&K.match(/^\s*role(s|)\s*:/g)),H=L?K.replace(/^\s*role(s|)\s*:/g,"").trim():"",J=L?"":K;I.favorite[M](J);I.platformRoles[M](H);I.visibleRoles[M](H);this.forEachQuadrant(function(N){I.apps[N][M](J)})},clickApp:function(J){var I=J.target,H,K;if(!this._handleAppClick){this._handleAppClick=c.debounce(this.handleAppClick,500,true).bind(this)}if(I.hasClassName("exp-item")){H=I}else{if(I.hasClassName("icon")||I.hasClassName("title")){H=I.getParent()}}if(H){K=this.collection.get(H.getAttribute("data-id"));this._handleAppClick(K,H)}},handleAppClick:function(J,Q){var L=this,O=J.get("tooltip")||J.get("title"),I=J.isNative(),N=u._IDS.compass["app"],M=J.isRole()?J.get("process"):J.get("id"),K="Click",H={onComplete:function(R){if(L.options.closeOnLaunch){L.dispatchEvent("onClose")}if(I){if(H.support){L.showMessage(p("supportactivated"),5000)}else{if(R.remote){L.showMessage(j.String.format(p("remoting"),O),5000)}else{L.showMessage(j.String.format(p("launching"),O),5000)}}if(w.get()){e.publish("setTypesCallback",j.merge({appId:J.get("id")},w.get()))}}},onFailure:function(S){var R=S.error;switch(R){case"no_launch_infos":case"no_install_selected":L.hideMessage();L.openSettings(J,Q.getElement(".settings-img"));break;case"no_install_compatible":L.hideMessage();if(J.isOnlineInstallable()&&!S.remoteAvailable){z.onlineInstallation(J,null,null)}else{L.openSettings(J,Q.getElement(".settings-img"))}break;case"mandatory_update":L.hideMessage();z.onlineInstallation(S.app,S.install,null,S.remote);break;case"windows10_app_not_installed":L.hideMessage();window.location="https://www.microsoft.com/store/apps/9wzdncrdjzv3";break;case"ios_app_not_installed":L.hideMessage();if(c.isIphone()){window.location="https://itunes.apple.com/fr/app/3dplay-ar/id1455204301"}else{window.location="https://itunes.apple.com/us/app/3dplay/id825988585?mt=8"}break;case"android_app_not_installed":L.hideMessage();window.location="https://play.google.com/store/apps/details?id=com.dsy.threedplayar";break;case"applet_error":if(S.returnCode===100){L.showMessage(p("launcherbusyretry"),5000)}else{if(S.remote){L.showMessage(j.String.format(p("remotingerror"),O),5000)}else{L.showMessage(j.String.format(p("launchingerror"),O),5000)}}break}}};if(I){if(J.get("supportModeExeName")){var P=new b({className:"compass-modal compass-modal-support",closable:true,visible:true,events:{onHide:function(){P.destroy()}},header:"<h4>"+p("supportmode")+"</h4>",body:p("supportactivated")+"<br>"+p("wantsupport"),footer:[j.createElement("button",{"class":"btn btn-primary",text:p("yes"),events:{click:function(){H.support=true;L.showMessage("",20000,true);J.launch(H);P.hide()}}}),j.createElement("button",{"class":"btn btn-default",text:p("no"),events:{click:function(){L.showMessage("",20000,true);J.launch(H);P.hide()}}}),j.createElement("button",{"class":"btn btn-default",text:p("cancel"),events:{click:function(){P.hide()}}})]}).inject(document.body);u.inc(N,K,M);return}this.showMessage("",20000,true)}else{if(J.isRole()){N=u._IDS.compass["role"];if(J.get("granted")){if(J.get("active")){K="Deactive"}else{K="Active"}this.toggleRole(J)}else{K="OpenRequestModal";this.showRequestModal(J)}u.inc(N,K,M);return}}u.inc(N,K,M);if(I&&w.get()){H.onComplete({})}else{J.launch(H)}},handleInstallDetectionEvent:function(K,I,H){if(K.appId){var J=this.collection.get(K.appId);if(J.isNative()){J.install({forceUpdate:true,eventDetection:true,silent:!!H,onComplete:function(){I.onComplete()},onFailure:function(L){I.onFailure(L)}})}else{I.onFailure({error:"not_native_app"})}}else{I.onFailure({error:"no_app_id"})}},handleInstallAppEvent:function(I,J){var L,K=I.appId,H;if(K){L=this.collection.get(K);H=L.get("tooltip")||L.get("title");if(L.isNative()){L.install({forceUpdate:true,onComplete:function(){J.onComplete()},onFailure:function(N){var M=N.error;switch(M){case"no_install_compatible":if(L.isOnlineInstallable()&&!N.remoteAvailable){z.onlineInstallation(L,null,null,null,true,null,J)}else{J.onFailure({error:"no_install_compatible_no_online_installation"})}break;case"mandatory_update":z.onlineInstallation(N.app,N.install,null,N.remote,true);break;case"applet_error":if(N.returnCode===100){J.onFailure({error:M,message:p("launcherbusyretry")})}else{if(N.remote){J.onFailure({error:M,message:p("launcherbusyretry")})}else{J.onFailure({error:M,message:j.String.format(p("launchingerror"),H)})}}break}}})}else{J.onFailure({error:"not_native_app"})}}else{J.onFailure({error:"no_app_id"})}},handleLaunchAppEvent:function(K,I){if(j.is(K.appId)&&K.appId!==""){var J=this.collection.get(K.appId);if(J){j.log(J);var L=J.isNative(),H={silent:K.silent,onComplete:function(){I.onComplete({success:true})},onFailure:function(N){var M=N.error;switch(M){case"no_launch_infos":I.onFailure({error:"no_launch_infos"});break;case"no_install_selected":I.onFailure({error:"no_install_selected"});break;case"no_install_compatible":if(J.isOnlineInstallable()&&!N.remoteAvailable){I.onFailure({error:"no_install_compatible_online_installation"})}else{I.onFailure({error:"no_install_compatible_no_online_installation"})}break;case"mandatory_update":I.onFailure({error:"mandatory_update_online_installation"});break;case"ios_app_not_installed":I.onFailure({error:"ios_app_not_installed"});break;case"android_app_not_installed":I.onFailure({error:"android_app_not_installed"});break;case"applet_error":I.onFailure({error:"applet_error"});break;case"unable_install_data":I.onFailure({error:"unable_install_data"});break}}};if(K.fileName&&K.fileContent){H.file={name:K.fileName,content:K.fileContent}}if(L){if(J.get("supportModeExeName")){I.onFailure({error:"no_mode_selected"});return}}else{if(J.isRole()){I.onFailure({error:"app_is_a_role"});return}}J.launch(H)}else{I.onFailure({error:"no_app"})}}else{I.onFailure({error:"no_app_id"})}},clickSuggestion:function(K){var J=K.target,I,H;if(J.hasClassName("suggestion-item")){I=J}else{I=J.getParent(".suggestion-item")}if(I){H=this.sugCollection.get(I.getAttribute("data-id"));this.handleSuggestionClick(H,I)}},handleSuggestionClick:function(H){this.showTryModal(H)},showRequestModal:function(K){var I={description:K.get("description"),platforms:[],buttonDisabled:false,buttonText:p("request"),action:"sendRoleRequest"},H=K.get("platforms"),J=true;if(H.length>0){I.platforms=H.reduce(function(M,L){if(!L.requested){M.push({name:L.id,text:j.String.format(p("requeston"),L.name)});J=false}return M},[]);if(J){I.buttonDisabled=true}}else{if(K.get("requested")||K.get("granted")){I.buttonDisabled=true}}this.showRoleModal(K,I)},showTryModal:function(J){var I={description:J.get("productUrl"),platforms:null,buttonDisabled:false,buttonText:p("tryit"),action:"sendTryRequest"},H=J.get("checkResultsByPlatformId");if(H.length>1){I.platforms=H.reduce(function(L,K){if(K.checkResult){L.push({name:K.platformId,text:j.String.format(p("tryiton"),K.displayName)})}return L},[])}else{I.platforms=[]}if(I.platforms.length===0&&!H[0].checkResult){I.buttonDisabled=true}this.showRoleModal(J,I)},showRoleModal:function(O,I){var L=this,K=I.description,H=I.platforms,N,J,M;if(H.length>1){N={className:"compass-modal-dropdown",items:H,events:{onClick:function(Q,P){L[I.action](O,P.name);J.hide()}}}}else{if(H.length===1){M=H[0].name}}J=new b({className:"compass-modal compass-request-modal",closable:true,visible:true,events:{onHide:function(){J.destroy()}},header:"<h4>"+O.get("title")+"</h4>",body:new E({src:K,text:p("noadditionalinfo")}),footer:[new q({value:I.buttonText,className:I.buttonDisabled?"default":"primary",disabled:I.buttonDisabled,events:{onClick:function(){if(!N){L[I.action](O,M);J.hide()}}},dropdown:N}),new q({value:p("cancel"),events:{onClick:function(){J.hide()}}})]}).inject(document.body)},clickRoleInfo:function(){var H=this.elements.expandedRole.getAttribute("data-id");this.showRequestModal(this.collection.get(H))},sendRoleRequest:function(L,K){var J=this,H=L.get("platforms"),I=function(){J.showMessage(p("requestfailure"),5000)};J.showMessage("",20000,true);r.request({url:r.requestRoleUrl,method:"POST",contentType:"application/x-www-form-urlencoded",postData:{process:L.get("process"),platform:K},onComplete:function(M){if(M&&M.code===0){L.set("requested",true);if(K){H.some(function(N){if(N.id===K){N.requested=true;return true}})}J.showMessage(M.message,5000)}else{I(M)}},onFailure:I});j.log("requested "+L.get("process")+":"+K)},sendTryRequest:function(L,K){var J=this,H=L.get("checkResultsByPlatformId"),I=function(){J.showMessage(p("trialrequestfailure"),5000)};J.showMessage("",20000,true);if(!K){K=H[0].platformId}r.request({url:r.tryRoleUrl,method:"POST",contentType:"application/x-www-form-urlencoded",postData:{process:L.get("productId"),platform:K},onComplete:function(M){if(M&&M.code===0){J.showMessage(M.message,5000);J.refreshSuggestions()}else{I(M)}},onFailure:I});j.log("try "+L.get("productId")+":"+K)},refreshSuggestions:function(){this.views.suggestions.refresh()},_isRemoteDisabled:function(){if(typeof this._removeDisabled==="undefined"){this._removeDisabled=l.get("3dremotevm")==="true"}return this._removeDisabled},openSettings:function(J,I){var M=this,Q=this._isRemoteDisabled(),H=J.getRemoteApp(),K=J.get("platforms"),O,L=I.getOffsets(),N=t.getScrolls(),P=function(V,U,X){var Y,Z,W=c.arrayFind(K,function(aa){return aa.preferred}),S=W?W.id:null,R=S,T=function(){O.hideSettings()};if(document.body.getElement(".my-apps-panel").getStyle("display")!=="none"){if(V){Y=V[0];Z=V[1]&&V[1].length>0?V[1][0]:null}I.addClassName("active");M.appsAccordion.addEvent("onScroll",T);O=new C({data:{platforms:K.length>1?K:null,installs:Y,remoteInstall:Z,error:J.get("error")},preferredInstallId:X,processes:J.get("licenses").map(function(aa){return aa.id}),app:J,container:M.container,appTitle:J.get("tooltip")||J.get("title"),remoteAppTitle:H?H.get("title"):null,onlineInstallable:J.isOnlineInstallable(),trigger:I,target:I,position:{x:L.x-N.x+12,y:L.y-N.y},shortcutEnabled:!!S||K.length===1,remoteEnabled:!Q&&!!(J.get("remoteInfos")),additionalContent:J.canAdditionalContent(M.collections.grantedRoles),events:{onShow:function(){M.hideMessage()},onPlatformChange:function(ac){var aa=ac.platform&&S!==ac.platform,ab=ac.install&&X!==ac.install;if(aa){K.forEach(function(ad){var ae=ad.preferred=(ad.id===ac.platform);if(ae){S=ad.id;J.set("launchInfos",ad.launchInfos);if(J.isWidget()){J.set("launchUrl",ad.launchUrl||J.get("launchUrl"));J.set("config",ad.config||J.get("config"));J.set("checksum",ad.checksum||J.get("checksum"));J.set("platformId",ad.id);M.container.getElements(j.String.format('[data-id="{0}"]',J.get("id"))).forEach(function(af){c.enableWidgetDrag(af,J.toJSON())})}if(J.isNative()){J.set("envInfos",ad.envInfos);J.set("shortcutLaunchInfos",ad.shortcutLaunchInfos);if(ad.remoteLaunchInfos&&J.get("remoteInfos")){J.get("remoteInfos").remoteLaunchInfos=ad.remoteLaunchInfos}}}})}if(ab){J.set("install",ac.install)}},onHideSettings:function(ac){var aa=ac.platform&&R!==ac.platform,ab=ac.install&&X!==ac.install;I.removeClassName("active");M.appsAccordion.removeEvent("onScroll",T);if(aa||ab){r.setPreferences({appid:J.id,preferredPlatform:ac.platform,preferredInstall:ac.install});R=ac.platform}},onClickShortcut:function(aa){x.createV6Shortcut(z.getInstall(aa),J)},onClickUpdate:function(aa,ad){var ac=aa==="remote",ab=ac?Z:z.getInstall(aa);if(ad){z.onlineInstallation(ac?H:J,ab,null,ac)}else{z.onlineInstallation(J,null,ab)}},onClickInstall:function(){z.onlineInstallation(J,null,null)},onClickInstallRemote:function(){z.onlineInstallation(H,null,null,true)},onClickAdditional:function(aa){var ab=z.getInstall(aa);z.onlineInstallation(J,null,ab,null,null,true)}}});O.show()}else{M.hideMessage()}};this.elements.search.blur();this.showMessage("",30000,true);if((J.isNative())&&!J.isNativeMarketApp()&&c.getOs()!=="ios"){J.getInstallList(H,P)}else{P()}},clickSettings:function(J){var I=J.target,H=I.getParent(".exp-item"),L=H.getAttribute("data-id"),K=this.collection.get(L);this.openSettings(K,I)},longClickApp:function(H){var I=this.collection.get(H.getAttribute("data-id"));if(I.isRole()){this.expandRoleDetail(I)}else{if(I.needSettingsMenu()){this.openSettings(I,H.getElement(".settings-img"))}}},clickExpand:function(J){var I=J.target,H=I.getParent(".exp-item"),L=H.getAttribute("data-id"),K=this.collection.get(L);this.expandRoleDetail(K)},expandRoleDetail:function(J){var I=this.elements.expandedRole,H=this.views.expandedRole;H.filterApps(J.get("appList"));I.getElement(".expanded-role-title").setText(J.get("title"));I.setAttribute("data-id",J.id);this.container.addClassName("roles-expanded")},hideRoleDetail:function(){this.container.removeClassName("roles-expanded")},toggleAllRoles:function(){this.container.toggleClassName("all-roles");this.elements.allRolesBtn.toggleClassName("fonticon-down-dir");this.elements.allRolesBtn.toggleClassName("fonticon-up-dir")},close:function(){var I=u._IDS.compass["cross"],J=null,H="Click";u.inc(I,H,J);this.dispatchEvent("onClose")},onClose:function(){if(typeof compassRichWithCef==="undefined"){this.container.hide()}else{e.publish("compassPanelOnHide",{})}},open:function(){this.dispatchEvent("onOpen")},onOpen:function(){this.container.show();r.get3DDashboardUrl()},displayQuadrant:function(H){var I=this.currentQuadrant;this.appsAccordion.setTitle("my-apps-section",this.options.sectionData[H].title,this._getClassForQuadrant(H));if(I!==H){this.container.removeClassName(I);this.container.addClassName(H);this.currentQuadrant=H}},_getClassForQuadrant:function(H){var I={north:"social",west:"3d",east:"intelligence",south:"simulation"},J="";if(I[H]){J=" fonticon fonticon-compass-"+I[H]}return H+J},forEachQuadrant:function(H){var I=["north","west","south","east"],J=I.length-1;for(;J>=0;J--){H(I[J])}},showMessage:function(K,H,J){var I=this.message;if(I){I.show(K,J);if(H){I.hide(H)}}},hideMessage:function(H){var I=this.message;if(I){I.hide(H)}},mask:function(){this.maskElmt.show()},unmask:function(){this.maskElmt.hide()},setFavoriteApps:function(I,H){var J=H+I.length,M=this.collections.favorite,K=this.collection.filterApps([{key:"isRole",value:false},{key:"lma",value:false},{key:"appIds",value:I}]),L=M.filter(function(N){return N.get("favoriteOrder")>=H});L.forEach(function(O,N){if(K.indexOf(O)===-1){O.set("favoriteOrder",J+N)}});K.forEach(function(N){N.set("favoriteOrder",H);N.set("isFavorite",true);H++});if(this.getContent().getElement(".delete-favorite").hasClassName("hide")){this.getContent().getElement(".delete-favorite").removeClassName("hide")}if(this.getContent().getElement(".my-favorite-apps-section").hasClassName("closed")){this.getContent().getElement(".my-favorite-apps-section").removeClassName("closed")}M.saveFavorites()},reorderFavoriteApp:function(H){var I=this.collections.favorite.get(H);if(I){this.views.favorite.reorderApp(I)}},removeFavoriteApp:function(H){var J=this.collections.favorite,I=J.get(H);if(I){I.set("isFavorite",false);I.set("favoriteOrder",-1)}if(J.length<1&&!this.getContent().getElement(".delete-favorite").hasClassName("hide")){this.getContent().getElement(".delete-favorite").addClassName("hide")}J.saveFavorites()},removeAllFavoriteApp:function(){var I=this.collections.favorite,H=this.collection.filterApps([{key:"isRole",value:false},{key:"lma",value:false},{key:"isFavorite",value:true}]);H.forEach(function(J){J.set("isFavorite",false);J.set("favoriteOrder",-1)});if(!this.getContent().getElement(".delete-favorite").hasClassName("hide")){this.getContent().getElement(".delete-favorite").addClassName("hide")}I.saveFavorites()},toggleRole:function(I,H){if(H===true||H===false){I.set("active",H)}else{I.set("active",!I.get("active"))}if(I.hasChanged("active")){this.collections.grantedRoles.saveRoles({onComplete:function(){c.onRoleChange(I.get("process"),I.get("active"))}})}},getVisibleHeight:function(H){return this.appsAccordion.getVisibleHeight(H)},showTempHeight:function(I,H){this.appsAccordion.showTempHeight(I,H)},hideTempHeight:function(H){this.appsAccordion.hideTempHeight(H)},closeSection:function(H){this.appsAccordion.closeSection(H)},isScrolling:function(){return this.appsAccordion.isScrolling()},stopScrolling:function(){this.appsAccordion.onScrollStop()},showDeleteZone:function(){var H;H=this.getContent().getElement(".delete-favorite");H.addClassName("show");H.removeClassName("hide")},hideDeleteZone:function(){var H;H=this.getContent().getElement(".delete-favorite");H.removeClassName("active");H.removeClassName("show")},changeRoles:function(){var H=this.collections.grantedRoles.getSelectedRoleApps();this.filterAppsInViews(H)}};return y.extend(i)});define("DS/i3DXCompass/i3DXCompass",["UWA/Core","UWA/Controls/Abstract","UWA/Controls/Accordion","UWA/Controls/Scroller","UWA/Controls/ToolTip","UWA/Ajax","UWA/Data","UWA/Utils/InterCom","UWA/Event","UWA/Utils","UWA/Utils/Client","UWA/Json","UWA/Fx","UWA/Controls/Drag","UWA/Controls/Input","DS/i3DXCompass/Data","DS/i3DXCompass/Tools","DS/i3DXCompass/Collection/AppList","DS/i3DXCompass/Collection/SuggestionList","DS/i3DXCompass/View/MyApps","DS/i3DXCompass/DaemonManager","DS/i3DXCompass/EventManager","DS/i3DXCompass/InstallManager","DS/i3DXCompass/TopBarManager","DS/i3DXCompass/InterCom","DS/i3DXCompass/Controls/Compass","DS/UIKIT/Modal","DS/WebappsUtils/WebappsUtils","DS/i3DXCompass/X3DContent","DS/i3DXCompassServices/i3DXCompassPubSub","DS/i3DXCompass/CacheManager","DS/i3DXCompass/Types","DS/i3DXCompass/UsageTracker","DS/i3DXCompass/i3DXCompassServices"],function(b,ah,p,ad,o,H,ab,af,T,U,n,R,ag,aj,aa,x,m,L,Z,i,B,G,y,w,Q,u,f,W,D,C,e,J,I,V){var E={closable:false,closeOnLaunch:false,lang:"en",myAppsBaseUrl:"",proxyTicketUrl:U.buildUrl(U.composeUrl(b.extend(U.parseUrl(window.location),{anchor:""})),"api/passport/ticket?url=V6")},q="north",t="",ae={},ai=[],Y,v,P,g,K,j,M=function(al){return j.getElement(al)},r,S={},ak=b.i18n,N={},ac={},X=false,a=false,l=false,k=false,d=false,F=false,h,s=[],A=[],O,c=function(al){var am=t||q;if(!d){d=true;Y.onOpen();r.onOpenQuadrant(am);N.loadQuadrant(am)}if(al){N.dispatchOpen()}},z=function(al){return b.is(x.addinMode)&&b.is(x.addinMode.value)&&al.addin&&al.addin.detect(function(am){return am.toLowerCase()===x.addinMode.value.toLowerCase()})};ac.intercom={serverId:"com.ds.compass"};N.initDrag=function(){var aw=this,ap="drag-app",aQ,ay=true,aG=false,aK=".experience-list.favorite",aO,aC=null,aq,aR,at=false,am,aH,aS,au=false,az=false,ar=false,av=false,aB=false,aN=true,al=false,ao,an=null,aA,aJ,aM,ax,aI,aP,aL=function(aT){var aU=aT.currentDelta;if(!aU||(Math.abs(aU.x)<20&&Math.abs(aU.y)<20)){aF.stop();Y.longClickApp(aQ)}},aD=function(){clearTimeout(aP);aJ=aA.getData("favorite-order");aC=b.createElement("li",{"class":"exp-item drop-favorite",html:{tag:"div",html:[{tag:"div","class":"fonticon fonticon-plus-circled add"},{tag:"div",text:ak("dropapphere"),"class":"text"}]},"data-favorite-order":b.is(aJ,"number")?aJ:'"none"'});aC.inject(aA,"before");if(aB){aO.removeClassName("empty")}ao=window.setTimeout(function(){Y.showTempHeight("my-favorite-apps-section",99);window.setTimeout(aF.refreshCache,350)},700);if(aI){Y.closeSection("my-roles-section")}al=true},aE=function(){av=false;az=false;ar=false;at=false;aq=false;aR=false;aB=false;aN=true;al=false;ay=true},aF=new aj.Move({centerHandles:true,snap:20,delegate:"."+ap+", ."+ap+" > *",zones:aK,handles:function(aT){var aU=aT.target,aV;aE();aQ=aU.hasClassName(ap)?aU:aU.getParent();aG=aU.hasClassName("widget-item");aO=M(aK);am=aQ.getAttribute("data-id");aB=aO.hasClassName("empty");if(aQ.isInjected(aO)){aH=aO.getChildren().indexOf(aQ);aS=aQ.getData("favorite-order");an=b.createElement("div",{styles:{display:"none"}}).inject(document.body);aQ.inject(an);aA=aO.getChildren()[aH];Y.showDeleteZone();au=true}else{aH=-1;if(aO.getElement(b.String.format('[data-id="{0}"]',am))){aN=false}else{aA=aO.getElement(".clearfix");aV=j.getOffsets();aI=aQ.getParent(".compass-scroll-accordion-section").hasClassName("my-roles-section");if(aI){aM={x:aV.x,y:aQ.getOffsets().y+3*aQ.getSize().height/2};ax={width:j.getSize().width,height:1000}}else{aM={x:aV.x,y:aV.y};ax={width:j.getSize().width,height:aQ.getOffsets().y-aV.y-aQ.getSize().height/2}}}au=false}if(aN&&aH>=0){aD()}if(Y.isScrolling()){Y.stopScrolling()}m.disableSelect();window.setTimeout(aF.refreshCache,1000);aP=setTimeout(aL.bind(null,aT),1000);return b.createElement("img",{"class":"compass-drag-icon",src:aQ.getElement(".icon").src}).inject(aT.root)},cancel:function(){return true},stop:function(aT){if(!ar){aT.handles.destroy();if(aC){aC.destroy()}if(!az&&au){if(aR){aQ.remove();Y.removeFavoriteApp(am);I.inc(I._IDS.compass["appFavorite"],"Remove",am)}else{Y.reorderFavoriteApp(am);av=true}}if(!av&&aB){M(aK).addClassName("empty")}aC=null;window.clearTimeout(ao);window.setTimeout(function(){Y.hideTempHeight(1)},500);if(an){an.destroy();an=null}Y.hideDeleteZone();m.enableSelect();clearTimeout(aP);ar=true}},enter:function(){at=true},leave:function(){if(aC){aC.removeClassName("active")}aq=false;at=false},drop:function(){var aV;if(!az){var aU=aC?aC.getData("favorite-order"):null,aT=b.is(aU,"number")?aU:P.max("favoriteOrder").get("favoriteOrder")+1,aW;if(!aR){if(aH>=0){aQ.inject(aC,"before");if(aq){Y.setFavoriteApps([am],aT)}av=true}else{if(aq){if(aQ.hasClassName("role")){aW=P.get(aQ.getAttribute("data-id"));Y.setFavoriteApps(aW.get("appList"),aT);Y.toggleRole(aW,true)}else{Y.setFavoriteApps([am],aT)}av=true}}az=true}if(aQ.getAttribute("data-favorite-order")==="-1"){if(b.is(aW)){aV=I._IDS.compass["roleFavorite"]}else{aV=I._IDS.compass["appFavorite"]}I.inc(aV,"Add",am)}return false}},move:function(aV){var a1={x:aV.startOrigin.x+aV.currentDelta.x,y:aV.startOrigin.y+aV.currentDelta.y};if((U.Client.getSize().width>640||ay)&&aN&&!al&&m.isOverElement(a1,aM,ax)){aD()}if(au){var a7=Y.getContent().getElement(".delete-favorite"),a3=a7.getOffsets(),a4=a7.getSize();if(m.isOverElement(a1,a3,a4)){a7.addClassName("active");aR=true}else{a7.removeClassName("active");aR=false}}if(at){var aW=aV.placeholderCache,aY=aW.length,aZ,a6,a8,aU,a2,a0,aX;if(aC){var a5=aC.getOffsets(),aT=aC.getSize();if(m.isOverElement(a1,a5,aT)){aC.addClassName("active");aq=true}else{aC.removeClassName("active");aq=false}}for(aZ=0;aZ<aY;aZ++){a6=aV.placeholderCache[aZ];aU=a6.element;if(!(aU.hasClassName("drop-favorite")||aU.hasClassName("clearfix"))&&aC){a8=aU.getSize();a2=a6.position;if(m.isOverElement(a1,a2,a8)){if(a1.x>a2.x+a8.width/2){a0=aU.nextSibling;aX=a0?a0.getData("favorite-order"):null;aC.inject(aU,"after")}else{aX=aU.getData("favorite-order");aC.inject(aU,"before")}aC.setAttribute("data-favorite-order",b.is(aX,"number")?R.encode(aX):'"none"');aF.refreshPlaceholderCache();break}}}}}})};N.manageNewGrantedRole=function(){var al=[];if(O){O.forEach(function(an){var am=Y.container.getElement(".exp-item[data-id="+an+"true]");if(am){al.push(am);am.addClassName("grow");am.setStyles("opacity","0")}});setTimeout(function(){al.forEach(function(am){am.setStyle("opacity",1).setStyle("transition","all .5s ease-in-out").removeClassName("grow")})},100);setTimeout(function(){al.forEach(function(am){am.setStyle("transition",null)});O=null},500)}};N.initTranslate=function(an){var ao=E.lang,al=W.getWebappsAssetUrl("i3DXCompass",b.String.format("lang/{0}.json",ao)),am={timeout:15000,method:"GET",type:"json",onComplete:function(ap){b.log("loaded "+ao+" translations");ak(ap);an()},onFailure:function(ap){if(!(ap instanceof TypeError)){b.log("Failed to load "+ao+" translations");if(ao!=="en"){ao="en";al=W.getWebappsAssetUrl("i3DXCompass",b.String.format("lang/{0}.json",ao));ab.request(al,am)}else{an()}}else{throw ap}}};if(ao==="#_key"){ao="en";ak=function(){}}ak({unableinstalldata:"Unable to retrieve install data",erroroccurred:"An error occurred",noinstall:"{0} is not installed.",createshortcut:"Create Desktop Shortcut",launching:"Launching {0}",remoting:"Remoting {0}",errorsavingpreferences:"An error occurred while saving the preferences",creatingshortcut:"Creating Desktop Shortcut for {0}",selectionupdated:"Your selection has been updated",shortcutcreated:"Shortcut Created",install:"Install {0}",shortcutcreatingerror:"Shortcut Creating Error",launchingerror:"{0} Launching Error",remotingerror:"{0} Remoting Error",installprocess:"Install {0}",installallgranted:"Install All Granted Roles",installallcontaining:"Install All Roles Containing {0}",updateallprocesses:"Update All Roles",update:"Update {0}","3dexperienceinstallation":"3DEXPERIENCE Installation",installationerror:"Installation Error",sessionExpirationTitle:"Your session has expired. A new login is required.",installationerrordiskspace:"Installation Error: Not enough disk space for download",installationcancelled:"Installation Cancelled",installationsuccess:"Installation Success",launchinginstallation:"Launching Installation",clickinstall:"Install Now",remoteit:"Remote Mode",ok:"OK",readyinstallation:"{0} is ready to be installed",readyupdate:"{0} is ready to update your installation",updateavailable:"Update available",updateneeded:"Update needed",newprocessesavailable:"New roles available",orinstallrelated:"Or",nbcompleteupdgraded:"NB: the complete installation will be upgraded to {0}",instfilelocation:"Installation File Location",javainstallation:"Java Installation",javanotinstalled:"The required Java Runtime Environment is not installed on this computer.",pleaseinstalljava:"Please install it now, both 32bit and 64bit versions.",dropapphere:"Drop your app here",dropfavoriteappshere:"Drop your favorite apps here",missingprocesses:"Missing Roles",missingprocessesreloaded:"Some roles are missing. The Compass has been reloaded.",searchapps:"Search Apps",supportmode:"Support Mode",supportactivated:"Support Mode is activated for recording system traces.",wantsupport:"Do you want to start the app with support mode?",yes:"Yes",no:"No",cancel:"Cancel",removeapp:"Remove App",Close:"Close","continue":"Continue",proceedanyway:"Update later",welcomelauncher:"Welcome to the 3DEXPERIENCE Launcher",launcherfirstvisit:"If this is your first visit to the 3DEXPERIENCE platform, please download and install the 3DEXPERIENCE Launcher.",downloadlauncherclicking:"Click the button below:",downloadlauncher:"Download 3DEXPERIENCE Launcher",startselfupdate:"Start update now",installlauncherrunning:"Run the downloaded file ({0}) to start install.",youcaninstallrun:"You can now install new apps or run those already installed.",clickcontinue:"Click {0}Continue{1}.",downloadlauncheradmin:"If the 3DEXPERIENCE Launcher is not installed on your machine, please contact your administrator to install it.",updatelauncheradmin:"Please contact your administrator to install the update.",alreadyinstalledlauncher:"If you have already installed the 3DEXPERIENCE Launcher, one of the following issues may be preventing it from working:",launchernotstarted:"The 3DEXPERIENCE Launcher is not started.",portchanged:"The port number used by the 3DEXPERIENCE Launcher may have changed or a firewall or anti-virus software may be blocking the port.",changeport:"If required, enter the new one:",portunreachable:"The provided port is unreachable.",launcherupdate:"Update 3DEXPERIENCE Launcher",downloadupdateclicking:"Click the button bellow:",updateinfos:"A new update of 3DEXPERIENCE Launcher is available ({0}version {2} / {3}MB{1}).",startselfupdateclicking:"Start launcher update by clicking here:",installupdaterunning:"Install the update by running the downloaded file: {0}",selfupdaterunning:"Wait for the update to finish.",selfupdateerror:"Unable to update 3DEXPERIENCE Launcher. Please try again or download and install manually.",checksystrayicon:"Check that the 3DEXPERIENCE Launcher icon {0} is available in the Windows system tray.",dontseelaunchermenu:"If you do not see 3DEXPERIENCE Launcher on the menu, please contact your administrator.",clicksystrayicon:"In the system tray, right-click the 3DEXPERIENCE Launcher {0}",copyportnumber:"Copy the port number.",pasteportnumber:"Paste it in the field.",troubleshootbtn:"Troubleshooting",launcherbusyretry:"The 3DEXPERIENCE Launcher is currently performing an action. Please retry later.",launcherunavailable:"The 3DEXPERIENCE Launcher is currently unavailable. Please try again later.",canrequest:"You can request this role from your Administrator.",requeston:"Request on {0}",alreadyrequestedplatforms:"{0} has already been requested on all platforms.",alreadyrequested:"{0} has already been requested.",noadditionalinfo:"No additional information for this role",request:"Request",requestfailure:"Request Failure",trialrequestfailure:"Trial Request Failure",tryit:"Try it",tryiton:"Try it on {0}",myroles:"My Roles",installationerroraccess:"Installation Error: Unable to access the Installation File Location",youcaninstallandlaunch:"You can now install new apps or run those already installed.",installallcontentavailable:"Install all additional content",additionalcontentavailable:"Additional content available",clickRemoveFavorite:"Click to remove all your favorite apps. </br> Or drag & drop any favorite app to remove it.",confirmRemoveFavorite:"Are you sure you want to remove all your favorite apps?",confirmation:"Confirmation","3DEXPERIENCEMarketplace":"3DEXPERIENCE Marketplace",wrapperRole:"3DEXPERIENCE Roles & Apps",DassaultSystemesCommunities:"Dassault Systemes Communities",MyCommunityServices:"My Community Services",MyEnterpriseServices:"My Enterprise Services",DefaultInstallationLocation:"Default",outdated_installation_uninstall:"An outdated installation has been detected on your computer.",outdated_installation_uninstall_warning:"To install the new version, <b>the outdated installation will be uninstalled automatically.</b>",launcherdiagnostics:"You can also run diagnostic tests from the 3DEXPERIENCE Launcher Options"});ab.request(al,am)};N.handleQuadrantClick=function(al){Q.fireEvent("compassEvent",{quadrant:al});C.publish("compassEvent",{quadrant:al});if(al!=="play"){if(!d){d=true;Y.onOpen();N.dispatchOpen()}N.loadQuadrant(al)}};N.loadQuadrant=function(al){var am=function(an,ao){if(d&&!h){h=window.setTimeout(N.loadQuadrant.bind(null,t),300000)}if(an){y.invalidateProductList()}if(ao){Y.refreshSuggestions()}Y.manageRoleSectionDisplay();N.manageNewGrantedRole()};t=al;h=window.clearTimeout(h);if(!l){P.fetch({onComplete:function(ao,an){if(!v){v={north:{title:an.north[0].title,closed:an.north[0].closed,noapps:an.north[0].noapps,icon:true},west:{title:an.west[0].title,closed:an.west[0].closed,noapps:an.west[0].noapps,icon:true},south:{title:an.south[0].title,closed:an.south[0].closed,noapps:an.south[0].noapps,icon:true},east:{title:an.east[0].title,closed:an.east[0].closed,noapps:an.east[0].noapps,icon:true},lma:an.north&&an.north[1]?{title:an.north[1].title,closed:an.north[1].closed,noapps:"",icon:false}:null,favorite:{title:an.favorite.title,closed:an.favorite.closed,noapps:"",icon:true},roles:{title:an.roles.title,closed:an.roles.closed,noapps:an.roles.noroles,icon:true},suggestions:{title:an.suggestions.title,closed:an.suggestions.closed,icon:false},services:an.services,eservices:an.eservices,wrapperMP:{title:an.wrapperMP.title,closed:an.wrapperMP.closed,icon:false},wrapperRole:{title:an.wrapperRole.title,closed:an.wrapperRole.closed,icon:false}};b.log("onCompassLoaded");G.dispatchEvent("onCompassLoaded")}else{v.north.closed=an.north[0].closed;v.west.closed=an.west[0].closed;v.south.closed=an.south[0].closed;v.east.closed=an.east[0].closed;if(an.north&&an.north[1]){v.lma.closed=an.north[1].closed}v.favorite.closed=an.favorite.closed;v.roles.closed=an.roles.closed;v.suggestions.closed=an.suggestions.closed;if(an.services){v.services.closed=an.services.closed}if(an.eservices){v.eservices.closed=an.eservices.closed}v.wrapperMP.closed=an.wrapperMP.closed;v.wrapperRole.closed=an.wrapperRole.closed}if(an.config&&an.config.launcherUrl&&an.config.launcherUrl[0]&&an.config.launcherUrl[0].url!==""){B.setLauncherConfig(an.config.launcherUrl[0].url)}if(an.config&&an.config.catEnv&&an.config.catEnv[0]&&an.config.catEnv[0].dir!==""){B.setCatEnvConfig(an.config.catEnv)}if(d){if(!l){Y.renderAppsView(v)}l=true;k=true;Y.displayQuadrant(t);Y.unmask()}if(!a){a=true;r.setQuadrantNames({north:an.north[0].title,west:an.west[0].title,south:an.south[0].title,east:an.east[0].title,play:an.play[0].title});x.onlineInstallUrl=an.install;x.clusterId=an.clusterId;x.buildTransactionId=an.build;y.init(an.cloud);x.cloud=an.cloud;B.init(K,an.cloud);s.forEach(function(ap){setTimeout(ap,0)});s.length=0;A.forEach(function(ap){setTimeout(ap,0)});A.length=0;if(E.topBarId){Y.initTopBar()}}am(an.changed,false)},onFailure:function(){Y.renderErrorView(ak("erroroccurred"));Y.unmask();am(false,false)}})}else{if(!k){Y.mask();P.fetch({onComplete:function(ao,an){k=true;Y.displayQuadrant(t);Y.unmask();am(an.changed,an.changed)},onFailure:function(){Y.showMessage(ak("erroroccurred"),5000);Y.unmask();am(false,false)}})}else{Y.displayQuadrant(t);P.fetch({onComplete:function(ao,an){if(an.eservices&&Y.views.eservices){Y.views.eservices.collection.set(an.eservices.data);Y.views.eservices.render()}am(an.changed,an.changed)},onFailure:function(){Y.showMessage(ak("erroroccurred"),5000);Y.unmask();am(false,false)}})}}};ac.initialize=function(al){b.log("initializing Compass");E=b.merge(al,E);e.setup(E.userId,E.lang);Q.initialize(ac.intercom.serverId,{onSetObject:ac.setObject,onResetObject:ac.resetObject,onLaunchApp:ac.launchApp,onSetStructure:ac.setStructure,onResetStructure:ac.resetStructure,onShowAccordion:ac.showAccordion,onHideAccordion:ac.hideAccordion,onSetX3DContent:ac.setX3DContent,onResetX3DContent:ac.resetX3DContent});C.subscribe("setObject",ac.setObject);C.subscribe("resetObject",ac.resetObject);C.subscribe("launchApp",ac.launchApp);C.subscribe("installApp",ac.installApp);C.subscribe("detectInstallApp",ac.detectInstallApp);C.subscribe("resetPlay",ac.resetPlay);C.subscribe("activatePlay",ac.activatePlay);C.subscribe("setStructure",ac.setStructure);C.subscribe("resetStructure",ac.resetStructure);C.subscribe("setTypes",ac.setTypes);C.subscribe("resetTypes",ac.resetTypes);C.subscribe("setX3DContent",ac.setX3DContent);C.subscribe("resetX3DContent",ac.resetX3DContent);if(b.typeOf(E.launchOnSameDomain)==="function"){m.setCustomFunction("customLaunchWebApp",E.launchOnSameDomain);delete E.launchOnSameDomain}if(b.typeOf(E.enableWidgetDrag)==="function"){m.setCustomFunction("enableWidgetDrag",E.enableWidgetDrag);delete E.enableWidgetDrag}if(b.typeOf(E.instanciateWidget)==="function"){m.setCustomFunction("instanciateWidget",E.instanciateWidget);delete E.instanciateWidget}if(b.typeOf(E.onRoleChange)==="function"){m.setCustomFunction("onRoleChange",E.onRoleChange);delete E.onRoleChange}if(b.typeOf(E.onOpen)==="function"){N.onOpen=E.onOpen;delete E.onOpen}if(b.typeOf(E.onClose)==="function"){N.onClose=E.onClose;delete E.onClose}if(E.proxyTicketUrl.indexOf("?")===-1){E.proxyTicketUrl+="?t="}else{E.proxyTicketUrl+="&t="}if(E.myAppsBaseURL){E.myAppsBaseUrl=E.myAppsBaseURL;delete E.myAppsBaseURL;b.log("Compass: myAppsBaseURL init option is deprecated. Please use myAppsBaseUrl instead.")}d=false;if(E.compassTarget){K=b.extendElement(document.getElementById(E.compassTarget));if(!K){b.log("Compass: this compass target markup is not available!")}}else{b.log("Compass: you must provide a target for Compass (compassTarget)!")}r=new u({closable:E.closable,defaultQuadrant:q,events:{onOpenQuadrant:N.handleQuadrantClick,onClose:function(){if(typeof compassRichWithCef==="undefined"){Y.onClose();N.dispatchClose();h=window.clearTimeout(h);d=false}}}}).inject(K);x.initialize(E,K);N.initTranslate(function(){if(E.topBarId){w.init({topBarId:E.topBarId,onRoleChange:function(an,ao){var ap=P.get(an);if(ap){Y.toggleRole(ap,ao)}}})}P=new L(null,{comparator:"title"});g=new Z();Y=new i({closable:E.closable,collection:P,sugCollection:g,closeOnLaunch:E.closeOnLaunch});Y.addEvent("onClose",function(){if(typeof compassRichWithCef==="undefined"){r.onClose();N.dispatchClose();h=window.clearTimeout(h);d=false}});if(m.isSmartphone()){Y.addEvent("onScrollTop",function(){r.switchCompassView(false)});Y.addEvent("onScrollDown",function(){r.switchCompassView(true)});r.addEvent("onUnScroll",function(an){if(Y.appsAccordion.scrolled!==0){Y.appsAccordion.unScroll(0)}})}j=b.extendElement(document.getElementById(E.appsTarget));if(j){Y.render().inject(j)}G.addEvent("onMissingProcess",function(){if(!F){k=false;N.loadQuadrant(t);F=true;var an=new f({className:"compass-modal compass-modal-missing",closable:true,visible:true,events:{onHide:function(){F=false;an.destroy()}},header:"<h4>"+ak("missingprocesses")+"</h4>",body:ak("missingprocessesreloaded")}).inject(document.body)}});N.initDrag();N.loadQuadrant(t!=""?t:q);if(!E.closable||(typeof compassRichWithCef!=="undefined")){c(t!=""?t:q)}var am="DS/PlatformAPI/PlatformAPI";require([am],function(an){an.subscribe("com.ds.compass:onGrantedRole",function(ao){P.lastId=undefined;k=false;V._private.reset();N.loadQuadrant(t)})});X=true;x.get3DDashboardUrl()})};ac.showAccordion=c;N.dispatchOpen=function(){Q.fireEvent("compassPanelOnShow",{});C.publish("compassPanelOnShow",{});if(N.onOpen){N.onOpen()}};ac.hideAccordion=function(al){if(d){r.onClose();Y.onClose();h=window.clearTimeout(h);d=false}if(al){N.dispatchClose()}};ac.resetPlay=function(al){var am={onComplete:function(){b.log("onComplete");C.publish("resetPlayCallback",al)}};b.log("Compass: resetPlay play quadrant");b.log("appId = "+al.appId);b.log("widgetId = "+al.widgetId);r.onActivePlay(false,al,am)};ac.activatePlay=function(al){var am={onComplete:function(){b.log("onComplete");C.publish("activatePlayCallback",al)}};b.log("Compass: active play quadrant");b.log("appId = "+al.appId);b.log("widgetId = "+al.widgetId);r.onActivePlay(true,al,am)};N.dispatchClose=function(){Q.fireEvent("compassPanelOnHide",{});C.publish("compassPanelOnHide",{});if(N.onClose){N.onClose()}};ac.isInitialized=function(){return X};ac.setObject=function(am){var al=function(an){return !an||typeof an!=="string"||!an.trim()};b.log("Compass: set object");b.log(am);if(b.typeOf(am)==="object"){if(JSON.stringify(am)!==JSON.stringify(S)){Y.showMessage(ak("selectionupdated"),5000)}S=am;if(S.hasOwnProperty("cstorage")&&!S.hasOwnProperty("envId")){S.envId=S.cstorage}if(S.hasOwnProperty("cspace")&&!S.hasOwnProperty("contextId")){S.contextId=S.cspace}if(al(S.serviceId)){console.warn("setObject without key: serviceId is deprecated, please provide the source id of the object")}}else{S={}}ac.resetStructure();ac.resetTypes();P.setObject(S)};ac.resetObject=function(){b.log("Compass: reset object");S={};P.resetObject()};ac.setX3DContent=function(al){b.log("Compass: set content");b.log(al);if(b.typeOf(al)==="object"&&!(Object.keys(al).length===0)){D.setX3DContent(al);C.publish("setX3DContentCallback",al)}};ac.resetX3DContent=function(){b.log("Compass: reset content");var al={};D.setX3DContent(al)};ac.installApp=function(al){var am={onComplete:function(){C.publish("installAppCallback",al)},onFailure:function(an){al=b.merge(al,an);C.publish("installAppCallback",al)}};b.log("Compass: install App");b.log("appId = "+al.appId);b.log("widgetId = "+al.widgetId);Y.handleInstallAppEvent(al,am)};ac.detectInstallApp=function(am){var an={onComplete:function(){C.publish("detectInstallAppCallback",am)},onFailure:function(ao){am=b.merge(am,ao);C.publish("detectInstallAppCallback",am)}},al=true;b.log("Compass: detect install App");b.log("appId = "+am.appId);b.log("widgetId = "+am.widgetId);Y.handleInstallDetectionEvent(am,an,al)};ac.launchApp=function(an){b.log("Compass: launch App");b.log("appId = "+an.appId);b.log("widgetId = "+an.widgetId);b.log("silent = "+an.silent);b.log("fileName = "+an.fileName);b.log("fileContent = "+an.fileContent);var al={widgetId:an.widgetId,appId:an.appId,response:""},am={onComplete:function(){b.log("COMPLETE");al.response="COMPLETE";Q.fireEvent("launchApp",al);if(an._PUB_SUB_ID){al._PUB_SUB_ID=an._PUB_SUB_ID}C.publish("launchAppCallback",al)},onFailure:function(ap){var ao=ap.error;b.log(ao);al.response=ao;Q.fireEvent("launchApp",al);if(an._PUB_SUB_ID){al._PUB_SUB_ID=an._PUB_SUB_ID}C.publish("launchAppCallback",al)}};Y.handleLaunchAppEvent(an,am)};ac.setStructure=function(al){b.log("Compass set structure");b.log(al);if(b.typeOf(al)==="object"&&b.typeOf(al.structure)==="string"){ac.resetObject();ac.resetTypes();B.setStructure(al.structure)}else{B.resetStructure()}};ac.resetStructure=function(){b.log("reset structure");B.resetStructure()};ac.setTypes=function(al){b.log("Compass set Types");b.log(al);if(b.typeOf(al)==="object"){J.set(al);ac.resetStructure();P.resetObject()}else{J.reset()}};ac.resetTypes=function(){b.log("reset Types");J.reset()};ac.getAppInfo=function(am){var al;if(am&&am.appId&&b.typeOf(am.onComplete)==="function"){al=function(){var ap=ac._private._getAppList().get(am.appId),an=ap?ap.toJSON():undefined;if(b.is(x.addinMode)===true&&an&&an.apps.length>1){var ao=[];an.apps.forEach(function(aq){if(z(aq)){ao.push(aq)}});an.apps=ao}if(!an&&ae[am.appId]){an=ae[am.appId]}if(an){am.onComplete(an)}else{if(!ai[am.appId]){ai[am.appId]=[]}ai[am.appId].push(am);if(ai[am.appId].length===1){x.request({url:x.getAppInfoUrl,urlParams:{id:am.appId},onComplete:function(aq){if(aq){ae[am.appId]=aq}ai[am.appId].forEach(function(ar){ar.onComplete(aq)});ai[am.appId]=null},onFailure:function(){ai[am.appId].forEach(function(aq){aq.onComplete(an)});ai[am.appId]=null;throw new Error("No config found for App:"+am.appId)}})}}};if(ac._private._isAppsDataInitialized()){al()}else{s.push(al)}}else{if(am&&b.typeOf(am.onComplete)==="function"){am.onComplete(new Error("Mandatory params are missing"))}}};ac.getAppsInfo=function(am){var al;if(am&&b.typeOf(am.onComplete)==="function"){al=function(){var an=[];if(am.data&&b.typeOf(am.data)==="array"){am.data.forEach(function(ar){var aq=ac._private._getAppList().get(ar),ao=aq?aq.toJSON():undefined;if(b.is(x.addinMode)===true&&ao&&ao.apps.length>1){var ap=[];ao.apps.forEach(function(at){if(z(at)){ap.push(at)}});ao.apps=ap}if(ao){an.push(ao)}})}else{an=ac._private._getAppList().toJSON()}am.onComplete(an)};if(ac._private._isAppsDataInitialized()){al()}else{A.push(al)}}else{if(am&&b.typeOf(am.onComplete)==="function"){am.onComplete(new Error("Mandatory params are missing"))}}};ac.onRoleChange=function(al,am){var an;if(al){an=P.findWhere({process:al},{granted:true});if(an){Y.toggleRole(an,am)}}else{k=false;if(d){N.loadQuadrant(t)}}};ac._private={_setQuadrant:function(al){t=al;if(r){r.currentQuadrant=al}},_getMyAppsView:function(){return Y},_getAppList:function(){return P},_isAppsDataInitialized:function(){return a},_loadQuadrant:N.loadQuadrant};return ac});define("i3DXCompass/i3DXCompass",["DS/i3DXCompass/i3DXCompass"],function(a){return a});define("DS/i3DXCompass/ServiceApi/GrantedRolesApi",["UWA/Core","DS/i3DXCompass/i3DXCompass","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data","DS/i3DXCompass/Collection/AppList","DS/i3DXCompass/CacheManager"],function(g,m,e,l,n,h){var k=[],i,j=function(o){k.forEach(function(p){setTimeout(p,0,o)});k.length=0},d=function(o){return o.isRole()&&o.get("granted")===true&&o.get("id")!=="CUSTOM"},b=function(){var p=[],o=i||m._private._getAppList();if(o){o.forEach(function(q){if(d(q)){p.push({id:q.get("process"),name:q.get("title"),platforms:q.get("grantedPlatforms")})}})}return p},a=function(){j(b());e.removeEvent(a)},c=function(p){var o=b();if(o.length>0){p(o)}else{k.push(p);e.addEventOnce("onCompassLoaded",a);if(typeof COMPASS_CONFIG!=="undefined"&&COMPASS_CONFIG.myAppsBaseUrl&&!i){l.initialize(COMPASS_CONFIG);h.setup(COMPASS_CONFIG.userId,COMPASS_CONFIG.lang);i=new n();i.fetch({onComplete:function(){e.dispatchEvent("onCompassLoaded",a)},onFailure:function(){g.log("AppList: onFailure")}})}}};var f={getGrantedRoles:function(o){if(!o||g.typeOf(o)!=="function"){return}c(o)},_private:{callbacks:k,fireCallbacks:j}};return f});