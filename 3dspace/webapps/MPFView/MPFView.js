define("DS/MPFView/FieldTextInput",["UWA/Core","UWA/Promise","UWA/String","UWA/Class/View","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","i18n!DS/MPFView/assets/nls/FieldTextInput"],function(h,e,a,g,c,b,d){var f=g.extend({className:"mpf-entry",setup:function(i){this._parent(i);this.fieldName=i.fieldName;this.fieldLabel=i.fieldLabel;this.fieldPrefix=i.fieldPrefix;this.required=i.required===true;this.readOnly=i.readOnly===true;this.dynamicValidation=i.dynamicValidation===true;this.saveOnChange=i.saveOnChange===true;this.tooltip=i.tooltip;this.maxlength=i.maxlength;this.silent=h.is(i.silent)?i.silent:true;this.input=this._createInput();this.entry=this._createEntry(this.fieldLabel);this.force=i.force===true;this.horizontalLayout=i.horizontalLayout===true},domEvents:{change:"onChange"},onChange:function(i){i||(i={});this._synchronizeModel(i);if(this.saveOnChange){this.model.savePromise(this.model.pick(this.fieldName),{patch:true})}this.dispatchEvent("update",this.model)},_synchronizeModel:function(i){var l;var j={};var k;k=i.force===true||this.force===true;l=this.dynamicValidation?this.validate()===undefined:true;if(l||k){j[this.fieldName]=this.input.getValue();this.model.set(j,{silent:this.silent})}},getValue:function(){var i;if(this.fieldPrefix){i=this.fieldPrefix+this.input.getValue()}else{i=this.input.getValue()}return i},setValue:function(i){this.input.setValue(i);this.onChange()},resetValue:function(){this.input.setValue("");this.onChange({force:true})},getInput:function(){return this.input},render:function(){this._removeErrorMsg();this.container.setContent(this.entry);if(this.horizontalLayout&&!this.container.hasClassName("mpf-oneline")){this.container.addClassName("mpf-oneline")}return this},validate:function(){var n=this;var o=false;var i;var j=this.entry.getElement("input");var k=j.name;var p=this.entry;var m={};var l;m[k]=this.getValue();l=this.model.validate(m);this._removeErrorMsg();if(h.is(l)&&l.length>0){l.forEach(function(q){if(h.is(q.field)&&q.field===k){o=true}})}if(!o&&this.required&&!(this.input.getValue()&&(this.input.getValue().trim().length>0))){l||(l=[]);l.push({field:k,errorType:"ErrorRequired"})}if(l){i=l.filter(function(q){if(q.field===k){j.addClassName("mpf-invalidField mpf-inputError");h.createElement("p",{"class":"mpf-error",text:h.is(q.message)?q.message:n._getMsgError(q)}).inject(p);return q}});if(i.length>0){return i}}},focus:function(){this.input.focus()},_removeErrorMsg:function(){var j;var i=this.entry.getElement("input");var k=this.entry;i.removeClassName("mpf-invalidField mpf-inputError");j=k.getElement("p");if(j!==null){k.removeChild(j)}},_getMsgError:function(i){var l=["A","E","I","O","U","Y"];var k;var j=false;if(h.is(this.fieldLabel)&&h.is(this.fieldLabel[0])){k=a.capitalize(this.fieldLabel[0]);l.forEach(function(m){if(k===m){j=true}});if(j){return a.format(d.get(i.errorType+"Vowel"),a.unCamelCase(this.fieldLabel," "))}else{return a.format(d.get(i.errorType),a.unCamelCase(this.fieldLabel," "))}}},save:function(){var j;var i={};j=e.deferred();i[this.fieldName]=this.getValue();if(this.model.set(i)){this.validate();j.resolve(this.model)}else{j.reject("Unable to save model")}return j.promise},setDisabled:function(i){this.input.setDisabled(i!==false)},destroy:function(){this.input=null;this.stopListening(this.model);this.model=null;this._parent()},_createInput:function(){var j;j=this.model.get(this.fieldName)||"";if(this.fieldPrefix){j=j.replace(this.fieldPrefix,"")}var i=new c({name:this.fieldName,value:j,disabled:this.readOnly,required:this.required,maxlength:this.maxlength});return i},_createEntry:function(l){var i;var k;var j;i=[];i.push(l);if(this.required&&l!==""){i.push('&nbsp;<em class="mpf-required">*</em>')}if(this.tooltip){i.push(this._createTooltip())}j=[{tag:"span","class":"mpf-label",html:i}];if(this.fieldPrefix){j.push({tag:"span","class":"mpf-prefix",text:this.fieldPrefix})}j.push(this.input);k=h.createElement("label",{html:j});return k},_createTooltip:function(){var i;i=h.createElement("span",{"class":"fonticon fonticon-info mpf-entry-tooltip"});new b({target:i,body:this.tooltip});return i}});return f});define("DS/MPFView/FieldButtonInput",["UWA/Core","UWA/Promise","UWA/String","UWA/Class/View","DS/UIKIT/Input/Button"],function(f,c,a,e,d){var b=e.extend({className:"mpf-button",setup:function(g){this._parent(g);this.buttonName=g.buttonName;this.buttonLabel=g.buttonLabel;this.events=g.events||{};this.className=g.className||"default";this.icon=g.icon||"";this.input=this._createInput(this.buttonName,this.buttonLabel,this.className,this.icon,this.events);this.entry=this._createEntry()},render:function(){this.container.setContent(this.entry);return this},_createInput:function(g,k,j,i,h){return new d({name:g,value:k,className:j,icon:i,events:h})},_createEntry:function(){return f.createElement("label",{html:[this.input]})}});return b});define("DS/MPFView/FieldToggleInput",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Toggle"],function(a,c,d){var b=c.extend({className:"mpf-entry",domEvents:{change:"onChange"},setup:function(e){e||(e={});this.fieldName=e.fieldName;this.fieldLabel=e.fieldLabel;this.required=e.required===true;this.readOnly=e.readOnly===true;this.saveOnChange=e.saveOnChange===true;this.useStringValue=e.useStringValue===true;this.type=e.type||"checkbox";this.input=new d({className:"mpf-toggle primary",type:this.type,name:this.fieldName,label:this.fieldLabel,required:this.required,disabled:this.readOnly})},render:function(e){var f;var g;f=this.model.get(this.fieldName);g=f===true||f==="true"||f==="TRUE";this.input.setCheck(g);this.container.setContent(this.input);return this},isChecked:function(){return this.input.isChecked()},setReadOnly:function(e){this.readOnly=e===true;this.input.setDisabled(this.readOnly)},onChange:function(){if(this.saveOnChange){this.save()}else{this.model.set(this.fieldName,this.getValue())}},save:function(){this.model.save(this.fieldName,this.getValue(),{patch:true})},getValue:function(){var e;if(this.useStringValue){e=this.input.isChecked()?"TRUE":"FALSE"}else{e=this.input.isChecked()}return e}});return b});define("DS/MPFView/GuidanceHelper",["UWA/Core","UWA/Class/View","DS/UIKIT/Popover"],function(d,c,b){var a=c.extend({tagName:"span",className:"mpf-guidance-helper",setup:function(e){this._parent(e);this.popover=null;this.title=e.title||"";this.content=e.content||"";this.position=e.position||"bottom";this.styles=e.styles||{};this.target=e.target;this.severity=e.severity||2;this._buildSkeleton()},_buildSkeleton:function(){var f=null;if(this.target){f=this.target}else{f=d.createElement("span",{"class":"fonticon fonticon-"+(this.severity===1?"help":"info"),styles:d.merge(this.styles,{fontSize:"14px",color:"#b4b6ba"})})}var e={target:f,trigger:"hover touch",position:this.position,body:this.content};if(this.title){e.title=this.title}this.popover=new b(e);this.container.setContent(f)},setContent:function(e){if(this.popover){this.popover.setBody(e)}},render:function(){}});return a});define("DS/MPFView/FieldSelectInput",["UWA/Core","UWA/String","UWA/Promise","UWA/Class/View","DS/UIKIT/Input/Select","i18n!DS/MPFView/assets/nls/FieldTextInput"],function(g,e,c,f,a,b){var d=f.extend({className:"mpf-select",domEvents:{change:"onChange"},setup:function(h){this._parent(h);this.fieldName=h.fieldName;this.fieldLabel=h.fieldLabel;this.required=h.required===true;this.readOnly=h.readOnly===true;this.selectableOptions=h.selectableOptions||[];this.placeholder=h.placeholder;this.select=this._createSelect();this.entry=this._createEntry(this.fieldLabel)},getValue:function(){return this.select.getValue()},setReadOnly:function(h){this.readOnly=h===true;if(this.readOnly){this.select.disable()}else{this.select.enable()}},isDisabled:function(){return this.select.isDisabled()},render:function(){if(this.model.get(this.fieldName)){this.select.select(this.model.get(this.fieldName))}this.container.setContent([this.entry,this.select]);return this},onChange:function(){var h;h=this.getValue();if(h){this.model.set(this.fieldName,h[0]);this.validate()}},validate:function(){var k=this;var j=this.container.getElement(".select");var m=j.getParent();var i=this.model.validate(this.model.omit());var h;var l;j.removeClassName("mpf-invalidField");h=m.getElement("p");if(h!==null){m.removeChild(h)}if(this.required){l=this.getValue().shift();if(l.length===0){i||(i=[]);i.push({field:this.fieldName,message:e.format(b.get("ErrorRequired"),this.fieldLabel.toLowerCase())})}}if(i){i.filter(function(n){if(n.field===k.fieldName){j.addClassName("mpf-invalidField");g.createElement("p",{"class":"mpf-inputError",text:n.message}).inject(m)}})}},save:function(){var i;var h={};i=c.deferred();h[this.fieldName]=this.getValue();if(this.model.set(h)){this.validate()}else{i.reject("Unable to save model")}return i.promise},add:function(h){return this.select.add(h)},remove:function(h){return this.select.remove(h)},_createSelect:function(){var h=new a({name:this.fieldName,placeholder:this.placeholder,disabled:this.readOnly,required:this.required,options:this.selectableOptions});return h},_createEntry:function(i){var h;if(this.required){i+='&nbsp;<em class="mpf-required">*</em>'}h=g.createElement("label",{html:{tag:"span","class":"mpf-label",html:i}});return h}});return d});define("DS/MPFView/InitialsDot",["UWA/Controls/Abstract","UWA/Core","css!DS/MPFUI/MPFUI"],function(d,c,a){var b=d.extend({init:function(e){e=e||{};this._parent(e);this._title="";this._image=null;if(typeof e.title==="string"){this._title=e.title}if(typeof e.image==="string"){this._image=e.image}this._buildSkeleton()},_buildSkeleton:function(){this.elements.container=c.createElement("div",{"class":"mpf-initial-dot"+(this._image?" mpf-initial-dot-image":"")});if(this._image){this._renderImage()}else{this._renderInitials()}},_renderImage:function(){this.elements.container.style.backgroundImage="url("+this._image+")"},_renderInitials:function(){if(this._title){var e=["#078BFA","#F95753","#6FBC4B","#9E846A","#AA4BB2","#1A997B","#F564A3","#FF8A2E"];if(this._title&&this._title!==""){var f=this._title.split(" ");var g=f[0].charAt(0).toUpperCase();var h=0;if(f[1]){g=g+f[1].charAt(0).toUpperCase();h=(g.charCodeAt(0)+g.charCodeAt(1))%e.length}else{h=g.charCodeAt(0)%e.length}if(h<0){h*=-1}this.elements.container.style.backgroundColor=e[h];this.elements.container.setText(g)}else{this.elements.container.style.backgroundColor="grey";this.elements.container.setText("--")}}}});return b});define("DS/MPFView/ValidationResultBuilder",["UWA/Class"],function(a){var b=a.extend({init:function(c){c||(c={});this.isValid=c.isValid!==false;this.errors=(c.errors&&c.errors.slice())||[]},addError:function(d,c){this.isValid=false;this.errors.push({field:d,message:c});return this},build:function(){return{isValid:this.isValid,errors:this.errors}}});return b});define("DS/MPFView/RatingStarsTile",["UWA/Core","UWA/Class/View","DS/MPFError/BadArgumentError","css!DS/MPFView/MPFView"],function(f,b,i){var d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z";var c=24;var h="#b4b6ba";var g="#FEE000";var a="disabled";var e;e=b.extend({className:"mpf-rating-stars-tile",setup:function(j){j=j||{};this.max=f.is(j.max)?Math.round(j.max):5;if(f.is(j.rating,"number")){this.rating=j.rating}this.starSize=j.starSize||26;this.colors=this._initColors(j.colors);this.starPoints=this._createPointsString(d)},render:function(){if(!f.is(this.rating,"number")){this._setDefaultState()}else{this._unsetDefaultState()}var k=[];for(var l=0;l<this.max;l++){var j=this._calcYellowFraction(l);k.push(this._createStar(j))}this.container.setContent(k);return this},setRating:function(j){if(f.is(j,"number")&&j>=0&&j<=this.max){this.rating=j;this.render()}else{throw new i("rating must be between 0 and the defined maximum of "+this.max+" (both inclusively)")}},unsetRating:function(){this.rating=null;this.render()},destroy:function(){this._parent();this.container=null},_initColors:function(k){k=k||{};var j={};j.rating=k.rating||g;j.max=k.max||h;return j},_setDefaultState:function(){this._renderedRating=this.max/2;if(!this.container.hasClassName(a)){this.container.addClassName(a)}},_unsetDefaultState:function(){this._renderedRating=this.rating;if(this.container.hasClassName(a)){this.container.removeClassName(a)}},_createPointsString:function(j){return d},_calcYellowFraction:function(k){var j=this._renderedRating-k;j=j<1?(j<0?0:j):1;return j},_createStar:function(j){var k=[];var l=j*c;if(j>0){k.push(this._createStarPart(this.colors.rating,0,l))}if(j<1){var m=(1-j)*c;k.push(this._createStarPart(this.colors.max,l,m))}var n=f.createElement("div",{"class":"mpf-star",html:k,styles:{width:this.starSize,height:this.starSize}});return n},_createStarPart:function(k,n,l){l=l||c;var j=document.createElementNS("http://www.w3.org/2000/svg","svg");j.setAttributeNS(null,"viewBox",""+n+" 0 "+l+" "+c);var m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d",this.starPoints);m.setAttributeNS(null,"fill",k);j.appendChild(m);return j}});return e});define("DS/MPFView/EmptyView",["UWA/Class/View","DS/MPFUtils/MPFUtils"],function(d,c){var b;var a;b=d.extend({className:"mpf-hidden",setup:c.doNothing,render:function(){return this},setDisabled:c.doNothing});b.getInstance=function(){a||(a=new b());return a};Object.freeze(b);return b});define("DS/MPFView/FieldNumberInput",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Number"],function(d,c,b){var a=c.extend({className:"mpf-entry",domEvents:{change:"onChange"},setup:function(e){this.fieldName=e.fieldName;this.fieldLabel=e.fieldLabel;this.required=e.required===true;this.readOnly=e.readOnly===true;this.min=e.min||0;this.max=e.max||10;this.step=e.step||1;this.tooltip=e.tooltip;this.wrapper=this._createWrapper()},onChange:function(){this.model.set(this.fieldName,this.input.getValue())},render:function(){this.container.setContent(this.wrapper);return this},_createWrapper:function(){var g;var e;var f;e=d.createElement("span",{"class":"mpf-label",text:this.fieldLabel});if(this.required){f=d.createElement("em",{"class":"mpf-required",text:"*"});e.addContent(["&nbsp;",f])}this.input=this._createInput();g=d.createElement("label",{html:[e,this.input]});return g},_createInput:function(){return new b({value:this.model.get(this.fieldName)||this.min,min:this.min,max:this.max,step:this.step,events:{onChange:this._forceValidRange.bind(this)}})},_forceValidRange:function(){var e;if(this.input){e=this.input.getValue();if(this.min&&e<this.min){this.input.setValue(this.min)}else{if(this.max&&e>this.max){this.input.setValue(this.max)}}}}});return a});define("DS/MPFView/FieldFileInput",["UWA/Core","UWA/Class/View","UWA/String","DS/UIKIT/Input/File","DS/UIKIT/Tooltip","UWA/Promise","UWA/Class/Model","DS/MPFServices/ObjectService","i18n!DS/MPFView/assets/nls/FieldFileInput","css!DS/MPFView/MPFView"],function(c,a,h,d,e,f,b,g,j){var i;i=a.extend({className:"mpf-file-entry mpf-entry-v2",domEvents:{change:"_onChange"},setup:function(k){this._parent(k);this.fileModel=k.fileModel;this.fieldName=k.fieldName;this.fieldLabel=k.fieldLabel;this.buttonText=k.buttonText;this.acceptedFileTypes=k.acceptedFileTypes;this.wrongFileTypeMessage=k.wrongFileTypeMessage;this.maxFileSize=k.maxFileSize;this.tooltip=k.tooltip;this.placeholder=k.placeholder||j.get("noFileSelected");this.showTextInput=k.showTextInput!==false;this.required=k.required===true;this.readOnly=k.readOnly===true;this.saveOnChange=k.saveOnChange===true;if(this.saveOnChange){g.requiredOfPrototype(this.fileModel,b,"options.fileModel must be a UWA/Class/Model if saveOnChange is set to true")}this.input=this._createInput();this.entry=this._createEntry()},render:function(){this.container.setContent(this.entry);return this},destroy:function(){this.fileModel=null;this._parent();this.container=null},getFile:function(){return this.file},save:function(l){if(this.fileModel&&this.file){return this._saveFile(this.file,l)}else{var k=f.deferred();k.reject(j.get("noValidFileSelected"));return k.promise}},_saveFile:function(m,l){m=m||this.file;var k=f.deferred();var n;n=new FormData();n.append("file",m);if(!(l)){l={}}l.method="POST";l.data=n;l.onComplete=k.resolve;l.onFailure=function(q,o,p){k.reject({model:q,response:o,options:p})};this.fileModel.save(null,l);return k.promise},_onChange:function(m){var l=this;this._removeErrorMessage();if(c.is(m.target)&&c.is(m.target.files)&&m.target.files.length>0){var k=m.target.files[0];if(this.validate(k)){this.file=k;this.dispatchEvent("newFileSelected",this.file);if(this.saveOnChange){this._saveFile(this.file).then(function(n){l.dispatchEvent("onSave",n)})["catch"](function(n){l.showErrorMessage(j.get("fileUploadFailed"));l.dispatchEvent("onError",n)})}}}},validate:function(k){k=k||this.file;if(c.is(k)){if(this.maxFileSize&&this.maxFileSize<k.size){this.showErrorMessage(h.format(j.get("fileTooBig"),this.maxFileSize/1000000,j.get("megaByte")));return false}else{if(this.acceptedFileTypes&&this.acceptedFileTypes.indexOf(k.type)<0){this.showErrorMessage(this.wrongFileTypeMessage||j.get("wrongFileType"));return false}else{this._removeErrorMessage();return true}}}else{if(this.required){this.showErrorMessage(h.format(j.get("isRequired"),this.fieldLabel))}return false}},_createInput:function(){var k=new d({name:this.fieldName,disabled:this.readOnly,input:this.showTextInput,buttonText:this.buttonText,buttonClassName:this.buttonClassName,multiple:this.allowMultipleFiles,placeholder:this.placeholder,required:this.required});return k},_createEntry:function(){var k=[];var m;var l=[];if(this.fieldLabel){k.push(this.fieldLabel);if(this.required&&this.fieldLabel!==""){k.push('&nbsp;<em class="mpf-required">*</em>')}}if(this.tooltip){k.push(this._createTooltip())}l.push(c.createElement("span",{"class":"mpf-label",html:k}));if(this.fieldPrefix){c.createElement("span",{"class":"mpf-prefix",html:this.fieldPrefix})}l.push(this.input);m=c.createElement("label",{html:l});return m},_createTooltip:function(){var k;k=c.createElement("span",{"class":"fonticon fonticon-info mpf-entry-tooltip"});new e({target:k,body:this.tooltip});return k},showErrorMessage:function(k){if(c.is(k,"string")){this._removeErrorMessage();this.entry.getElement(".input-file.input-group").addClassName("mpf-invalid");c.createElement("p",{"class":"mpf-error",text:c.is(k)?k:""}).inject(this.container)}},_removeErrorMessage:function(){var l;var k=this.entry.getElement(".input-file.input-group");k.removeClassName("mpf-invalid");l=this.container.getElement("p.mpf-error");if(c.is(l)){this.container.removeChild(l)}}});return i});define("DS/MPFView/FieldReplaceImage",["UWA/Core","UWA/Class/View","UWA/Promise","UWA/String","DS/UIKIT/Input/File","DS/MPFServices/ObjectService","DS/MPFError/BadArgumentError","DS/MPFModel/MPFModel","i18n!DS/MPFView/assets/nls/FieldFileInput","css!DS/MPFView/MPFView"],function(f,b,g,i,e,h,j,c,d){var a;a=b.extend({domEvents:{change:"_onChange",click:"_onClick"},className:"mpf-entry-v2 mpf-field-replace-image",setup:function(k){this.imageModel=k.imageModel;h.requiredOfPrototype(this.model,c,"options.model must be a MPFModel");h.requiredOfPrototype(this.imageModel,c,"options.imageModel must be a MPFModel");if(!f.is(k.fieldName,"string")){throw new j("options.fieldName must be string")}this.fieldName=k.fieldName;this.fieldLabel=k.fieldLabel;this.actionName=k.actionName||d.get("replaceImage");this.imageShape=k.imageShape||"rectangle";this.saveOnChange=k.saveOnChange===true;this.unsetFallback=k.unsetFallback;this.acceptedFileTypes=k.acceptedFileTypes||["image/jpeg","image/png","image/bmp","image/gif"];this.maxFileSize=k.maxFileSize;this.iconName=k.iconName||"retweet";this.entry=this._createEntry();this.imageModel.setParentResourceId(this.model.get("id"));this.listenTo(this.model,"onChange",this._onModelChange.bind(this))},render:function(){this.container.setContent(this.entry);return this},destroy:function(){this.stopListening();this.model=null;this.imageModel=null;this.invisibleInput.destroy();this._parent();this.container=null},showLoading:function(){this.setActionName(d.get("loading"));this.icon.addClassName("spinning");return this},hideLoading:function(){this.setActionName(this.actionName);this.icon.removeClassName("spinning");return this},setActionName:function(k){if(f.is(k,"string")){this.actionLabel.setText(k)}return this},save:function(l){l=l||this.file;if(f.is(l)){this.showLoading();var m=this;var k=g.deferred();this._uploadImage(this.file).then(function(n){m.model.set(m.fieldName,n.get(m.fieldName));m.reset();m.hideLoading();m.dispatchEvent("update");k.resolve(m.model)})["catch"](function(n){if(m.saveOnChange){m.reset()}m.hideLoading();m.dispatchEvent("error",{message:d.get("fileUploadFailed")});k.reject(n)});return k.promise}},reset:function(){this._updateImagePreview();this._resetHiddenFileInput();this.file=null;return this},_displayNewImage:function(l){var m=this;var k=new window.FileReader();k.onload=function(){m.file=l;m.hideLoading();m._updateImagePreview(k.result);m.dispatchEvent("update")};k.onerror=function(n){m.hideLoading();console.error(n);m.dispatchEvent("error",{message:d.get("fileCouldNotBeLoaded")})};this.showLoading();k.readAsDataURL(l)},_onModelChange:function(){if(this.model.hasChanged(this.fieldName)){this._updateImagePreview()}},_onChange:function(l){if(f.is(l.target)&&f.is(l.target.files)&&l.target.files.length>0){var k=l.target.files[0];if(this._validateNewFile(k)){if(this.saveOnChange){this.save(k)}else{this._displayNewImage(k)}}else{this._resetHiddenFileInput()}}},_onClick:function(){this.invisibleInput.focus();this.invisibleInput.click()},_uploadImage:function(m){var k=g.deferred();var n=new FormData();n.append("file",m);var l={};l.method="POST";l.data=n;l.onComplete=k.resolve;l.onFailure=function(q,o,p){k.reject({model:q,response:o,options:p})};this.imageModel.clear();this.imageModel.save(null,l);return k.promise},_validateNewFile:function(k){if(this.acceptedFileTypes.indexOf(k.type)<0){this.dispatchEvent("error",{message:d.get("wrongFileType")});return false}if(f.is(this.maxFileSize,"number")&&k.size>this.maxFileSize){this.dispatchEvent("error",{message:i.format(d.get("fileTooBig"),this.maxFileSize/1000000,d.get("megaByte"))});return false}var m={};m[this.fieldName]=k;var l=this;var n=this.model.validate(m);if(f.is(n)&&n.length>0){n=n.filter(function(o){return(o.field===l.fieldName||o.fieldName===l.fieldName)})}return !f.is(n)||n.length===0},_resetHiddenFileInput:function(){this.invisibleInput.value=""},_createEntry:function(){var k;var l;l=this._createControl();this.label=this._createLabel();this.invisibleInput=this._createInput();k=f.createElement("div",{html:[{tag:"label",html:this.label},l,this.invisibleInput]});return k},_createLabel:function(){return f.createElement("span",{"class":"mpf-label",text:this.fieldLabel})},_createControl:function(){var l=this.acceptedFileTypes[0];for(var k=1;k<this.acceptedFileTypes.length;k++){l.concat(l,",",this.acceptedFileTypes[k])}this.icon=this._createIcon();this.image=this._createImage();this.actionLabel=this._createActionName();return f.createElement("label",{"class":"mpf-control",type:"file",accepts:l,"for":this.fieldName,html:[this.image,this.icon,this.actionLabel]})},_createImage:function(){var l;var k=this.model.get(this.fieldName);if(k){l=f.createElement("div",{"class":this.imageShape==="round"?"mpf-image round":"mpf-image",styles:{"background-image":"url("+k+")"}})}else{if(this.unsetFallback){l=this.unsetFallback}else{l=f.createElement("div",{"class":this.imageShape==="round"?"mpf-image mpf-empty round":"mpf-image mpf-empty"})}}return l},_updateImagePreview:function(k){k=k||this.model.get(this.fieldName);if(f.is(k)&&k.length>0){this.image.removeClassName("mpf-empty");this.image.setStyle("background-image","url("+k+")")}else{this.image.addClassName("mpf-empty");this.image.setStyle("background-image","none")}},_createIcon:function(){return f.createElement("span",{"class":"fonticon fonticon-2x fonticon-"+this.iconName})},_createActionName:function(){return f.createElement("span",{"class":"mpf-action-name",text:this.actionName})},_createInput:function(){var l=this.acceptedFileTypes[0];for(var k=1;k<this.acceptedFileTypes.length;k++){l=l+","+this.acceptedFileTypes[k]}return f.createElement("input",{"class":"invisible-input",name:this.fieldName,type:"file",accepts:l})}});return a});define("DS/MPFView/InformationTooltip",["UWA/Class/View","DS/UIKIT/Tooltip"],function(c,b){var a=c.extend({className:"mpf-info fonticon fonticon-info",setup:function(d){this.text=d.text},render:function(){new b({position:"bottom",trigger:"touch",body:this.text,target:this.container});return this}});return a});define("DS/MPFView/DropZone",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Alert","DS/UIKIT/Input/Button","i18n!DS/MPFView/assets/nls/DropZone"],function(g,d,e,b,a,c){var f;f=e.extend({className:"mpf-dropzone",setup:function(h){this.acceptedFileTypes=h.acceptedFileTypes;if(g.is(h.className,"string")){this.container.addClassName(h.className)}this.dropZone=this._createDropZone();this.mask=this._createMask();this.alert=this._createAlert()},render:function(){this.container.setContent([this.alert,this.dropZone,this.mask]);this.mask.addEvents({click:this._onClick.bind(this),dragenter:this._onDragEnter.bind(this),dragover:this._onDragOver.bind(this),dragleave:this._onDragLeave.bind(this),drop:this._onDrop.bind(this)});return this},destroy:function(){this.mask.removeEvents();this.uploadButton.destroy();this._parent();this.container=null},showLoading:function(){this.uploadButton.load(true)},hideLoading:function(){this.uploadButton.load(false)},showAlert:function(h){var k=this.alert.getMessages();for(var j=0;j<k.length;j++){this.alert.remove(k[j])}this.alert.add(h)},_onClick:function(){this.dispatchEvent("onClick")},_onDragEnter:function(i){i.stopPropagation();i.preventDefault();var h=this._filterAcceptedFilesFromEvent(i);if(h.length>0){this.container.addClassName("hovered")}},_onDragOver:function(h){h.stopPropagation();h.preventDefault()},_onDragLeave:function(h){h.stopPropagation();h.preventDefault();this.container.removeClassName("hovered")},_onDrop:function(i){i.stopPropagation();i.preventDefault();var h=this._filterAcceptedFilesFromEvent(i);this.container.removeClassName("hovered");if(h.length>0){this.dispatchEvent("onDrop",{files:h})}},_filterAcceptedFilesFromEvent:function(m){var l=[];if(g.is(m.dataTransfer)&&g.is(m.dataTransfer.items)&&m.dataTransfer.items.length>0){for(var k=0;k<m.dataTransfer.items.length;k++){if(!this.acceptedFileTypes||this.acceptedFileTypes.indexOf(m.dataTransfer.items[k].type)>-1){l.push(m.dataTransfer.items[k])}}}else{if(g.is(m.dataTransfer)&&g.is(m.dataTransfer.files)){if(m.dataTransfer.files.length>0){for(var h=0;h<m.dataTransfer.files.length;h++){if(!this.acceptedFileTypes||this.acceptedFileTypes.indexOf(m.dataTransfer.files[h].type)>-1){l.push(m.dataTransfer.files[h])}}}}}return l},_createDropZone:function(){var h=g.createElement("span",{"class":"fonticon fonticon-2x fonticon-popup"});var j=g.createElement("div",{html:c.get("dropFileMessage")});var i=g.createElement("div",{html:[{tag:"div","class":"mpf-dropzone-orline"},{tag:"div","class":"mpf-dropzone-ortext",html:c.get("orMessage")}]});this.uploadButton=new a({className:"primary",value:c.get("upContent")});return g.createElement("div",{"class":"mpf-dropzone-visible-elements",html:[h,j,i,this.uploadButton]})},_createMask:function(){return g.createElement("div",{"class":"mpf-dropzone-mask"})},_createAlert:function(){return new b({visible:true,autoHide:true,hideDelay:3000,closeOnClick:true})}});return f});define("DS/MPFView/MPFView",["UWA/Core","UWA/Promise","UWA/Class/View"],function(a,c,d){var b=d.extend({setup:function(e){this.messages=null;this.readOnly=e.readOnly===true;this.required=e.required===true;this.lockSave=e.lockSave===true;this._resetMessages()},save:function(){var h=c.deferred();var e;var g;var f;if(this.lockSave){h.resolve()}else{this._resetMessages();e=this.container.getElements("input");g=e.reduce(function(i,j){i[j.name]=j.value.trim();return i},{});if(this.model.set(g)){this.inputs.forEach(function(i){i.setDisabled()});f=this.model.validate(this.model.toJSON());if(f&&(f.length>0)){Array.apply.push(this.messages.error,f);h.reject("Validation failed")}else{this.model.save(null,{onComplete:function(){h.resolve()},onFailure:function(){h.reject("Unable to save model")}})}}else{h.reject("Unable to update model")}}return h.promise},setReadOnly:function(e){this.readOnly=e===true;this.inputs.forEach(function(f){f.setDisabled(false)})},addErrorMessage:function(f,e){if(f){this.container.getElement('[name="'+f+'"]').addClassName("mpf-error")}this.messages.error.push(e)},_resetMessages:function(){this.messages={info:[],warning:[],error:[]}}});return b});define("DS/MPFView/FieldSelectInputV2",["UWA/Core","UWA/String","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/MPFView/ValidationResultBuilder","DS/UIKIT/Input/Select","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],function(e,g,b,f,c,h,a,i){var d=b.extend({className:"mpf-select-v2",domEvents:{change:"onChange"},setup:function(j){j||(j={});this._parent(j);f.requiredOfPrototype(this.model,c,"this.model must be a MPFModel");this.fieldName=j.fieldName;this.fieldLabel=j.fieldLabel;this.required=j.required===true;this.readOnly=j.readOnly===true;this.dynamicValidation=j.dynamicValidation===true;this.saveOnChange=j.saveOnChange===true;this.silent=e.is(j.silent)?j.silent:true;this.selectableOptions=j.selectableOptions||[];this.multipleOptionsSelectable=j.multipleOptionsSelectable===true;this.placeholder=j.placeholder;this.select=this._createSelect();this.entry=this._createEntry(this.fieldLabel)},render:function(){this.container.setContent(this.entry);return this},destroy:function(){this.entry.destroy();this.select=null;this.selectableOptions=null;this.model=null;this._parent();this.container=null},validate:function(m){m||(m={});var o=this;var l=new h();var k;var n={};var j;this._removeErrorMessage();if(this.required&&this.getValue().trim()===""){l.addError(this.fieldName,g.format(i.get("requiredField"),this.fieldLabel))}if(l.isValid&&(this.required||this.getValue().trim()!=="")){n[this.fieldName]=this.getValue();if(this.model.get(this.fieldName)!==this.getValue()){this.model.set(n,{silent:this.silent})}k=this.model.validate(this.model.pick(this.fieldName));if(e.is(k)){k.filter(function(p){return p.fieldName===o.fieldName}).forEach(function(p){l.addError(o.fieldName,p.message)})}}j=l.build();if(!j.isValid){this._displayErrorMessage(j)}return j},save:function(){return this.model.savePromise(this.model.pick(this.fieldName),{patch:true})},_displayErrorMessage:function(j){var k;k=j.errors[0];this.container.addClassName("mpf-invalid");e.createElement("p",{"class":"mpf-error",text:e.is(k.message)?k.message:""}).inject(this.container)},_removeErrorMessage:function(){var j;this.container.removeClassName("mpf-invalid");j=this.container.getElement("p");if(e.is(j)){this.container.removeChild(j)}},onChange:function(j){j||(j={});if(this.dynamicValidation){this.validate()}if(this.saveOnChange){this.save()}this.dispatchEvent("update",this.model)},getValue:function(){if(this.multipleOptionsSelectable){return this.select.getValue()}else{return this.select.getValue()[0]}},setValue:function(j,k){k||(k={});this.select.select(j);if(k.silent!==true){this.onChange()}},resetValue:function(j){j||(j={});this.select.clear();if(j.silent!==true){this.onChange()}this._removeErrorMessage()},setReadOnly:function(j){this.readOnly=j!==false;if(this.readOnly){this.select.disable()}else{this.select.enable()}},isDisabled:function(){return this.select.isDisabled()},add:function(j){return this.select.add(j)},remove:function(j){return this.select.remove(j)},_createSelect:function(){return new a({name:this.fieldName,placeholder:this.placeholder,disabled:this.readOnly,required:this.required,options:this.selectableOptions,multiple:this.multipleOptionsSelectable})},_createEntry:function(k){var j=[];j.push(k);if(this.required&&k!==""){j.push('&nbsp;<em class="mpf-required">*</em>')}return e.createElement("span",{"class":"mpf-label",html:[e.createElement("label",{html:j}),this.select]})}});return d});define("DS/MPFView/FieldTextInputV2",["UWA/Core","UWA/String","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],function(f,h,a,g,b,c,d,j,i){var e=a.extend({className:"mpf-entry-v2",domEvents:{change:"onChange"},setup:function(k){k||(k={});this._parent(k);g.requiredOfPrototype(this.model,b,"this.model must be a MPFModel");this.fieldName=k.fieldName;this.fieldLabel=k.fieldLabel;this.fieldPrefix=k.fieldPrefix;this.required=k.required===true;this.readOnly=k.readOnly===true;this.dynamicValidation=k.dynamicValidation===true;this.saveOnChange=k.saveOnChange===true;this.tooltip=k.tooltip;this.maxlength=k.maxlength;this.silent=f.is(k.silent)?k.silent:true;this.multiline=k.multiline===true;this.multilineRows=k.multilineRows||1;this.input=this._createInput();this.entry=this._createEntry(this.fieldLabel)},render:function(){this.container.setContent(this.entry);return this},validate:function(n){n||(n={});var p=this;var m=new j();var l;var o={};var k;this._removeErrorMessage();if(this.required&&this.getValue().trim()===""){m.addError(this.fieldName,h.format(i.get("requiredField"),this.fieldLabel))}if(f.is(n.pattern)&&this.getValue().search(n.pattern)===-1){m.addError(this.fieldName,h.format(i.get("invalidField"),this.fieldLabel))}if(m.isValid&&(this.required||this.getValue().trim()!=="")){if(this.model.get(this.fieldName)!==this.getValue()){o[this.fieldName]=this.getValue();this.model.set(o,{silent:this.silent})}l=this.model.validate(this.fieldName);if(f.is(l)){l.forEach(function(q){m.addError(p.fieldName,q.message)})}}k=m.build();if(!k.isValid){this._displayErrorMessage(k)}return k},save:function(){return this.model.savePromise(this.model.pick(this.fieldName),{patch:true})},_displayErrorMessage:function(k){var l;l=k.errors[0];this.container.addClassName("mpf-invalid");f.createElement("p",{"class":"mpf-error",text:f.is(l.message)?l.message:""}).inject(this.container)},_removeErrorMessage:function(){var k;this.container.removeClassName("mpf-invalid");k=this.container.getElement("p");if(f.is(k)){this.container.removeChild(k)}},onChange:function(k){k||(k={});if(this.dynamicValidation){this.validate()}if(this.saveOnChange){this.save()}this.dispatchEvent("update",this.model)},getValue:function(){var k;if(this.fieldPrefix){k=this.fieldPrefix+this.input.getValue()}else{k=this.input.getValue()}return k},setValue:function(l,k){k||(k={});this.input.setValue(l);if(k.silent!==true){this.onChange()}},resetValue:function(k){k||(k={});this.input.setValue("");if(k.silent!==true){this.onChange()}this._removeErrorMessage()},getInput:function(){return this.input},setDisabled:function(k){this.readOnly=k!==false;this.input.setDisabled(this.readOnly)},_createInput:function(){var k;var l;l=this.model.get(this.fieldName)||"";if(this.fieldPrefix){l=l.replace(this.fieldPrefix,"")}k=new c({name:this.fieldName,value:l,disabled:this.readOnly,required:this.required,maxlength:this.maxlength,multiline:this.multiline,rows:this.multilineRows});return k},_createEntry:function(n){var k=[];var m;var l=[];k.push(n);if(this.required&&n!==""){k.push('&nbsp;<em class="mpf-required">*</em>')}if(this.tooltip){k.push(this._createTooltip())}l.push(f.createElement("span",{"class":"mpf-label",html:k}));if(this.fieldPrefix){f.createElement("span",{"class":"mpf-prefix",html:this.fieldPrefix})}l.push(this.input);m=f.createElement("label",{html:l});return m},_createTooltip:function(){var k;k=f.createElement("span",{"class":"fonticon fonticon-info mpf-entry-tooltip"});new d({target:k,body:this.tooltip});return k},destroy:function(){this.input=null;this.stopListening(this.model);this.model=null;this._parent()}});return e});define("DS/MPFView/FieldDateInput",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Input/Date","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],function(g,e,f,c,d,b){var a=f.extend({className:"mpf-entry",domEvents:{change:"onChange"},setup:function(h){h||(h={});this.fieldName=h.fieldName;this.fieldLabel=h.fieldLabel;this.required=h.required===true;this.readOnly=h.readOnly===true;this.saveOnChange=h.saveOnChange===true;this.tooltip=h.tooltip;this.min=h.min;this.max=h.max;this.wrapper=this._createWrapper()},render:function(){this.container.setContent(this.wrapper);return this},onChange:function(){var h;var l;var k;var j;var i;h=this.input.getDate();if(h){l=h.getDate();k=h.getMonth()+1;j=h.getFullYear();i=k+"/"+l+"/"+j;if(this.validate().isValid){this.model.set(this.fieldName,i);if(this.saveOnChange){this.model.savePromise(this.model.pick(this.fieldName),{patch:true})}this.dispatchEvent("update",this.model)}}},setReadOnly:function(h){this.input.setDisabled(h)},getValue:function(){return this.input.getValue().trim()},validate:function(){var j=new d();var k;var h;var l;var i;this._clearValidationErrors();l=this.getValue()==="";if(this.required&&l){j.addError(this.fieldName,e.format(b.get("requiredField"),this.fieldLabel))}if(j.isValid){i={};i[this.fieldName]=this.getValue();k=this.model.validate(i);if(k){k.filter(this._resultByFieldName.bind(this)).forEach(function(m){j.addError(this.fieldName,m.message)},this)}}h=j.build();this._showValidationErrors(h);return h},_showValidationErrors:function(h){if(!(h.isValid)){this.container.addClassName("mpf-invalid");h.errors.forEach(function(i){return g.createElement("p",{"class":"mpf-error",text:i.message}).inject(this.container)},this)}},_clearValidationErrors:function(){this.container.removeClassName("mpf-invalid");this.container.getElements(".mpf-error").forEach(function(h){h.remove()})},_resultByFieldName:function(h){return((h.fieldName===this.fieldName)||(h.field===this.fieldName))},_createWrapper:function(){var j;var h;var i;h=g.createElement("span",{"class":"mpf-label",text:this.fieldLabel});if(this.required){i=g.createElement("em",{"class":"mpf-required",text:"*"});h.addContent(["&nbsp;",i])}this.input=this._createInput();j=g.createElement("label",{html:[h,this.input]});return j},_createInput:function(){return new c({value:this.model.get(this.fieldName)||"",name:this.fieldName||"",min:this.min,max:this.max,disabled:this.readOnly})}});return a});