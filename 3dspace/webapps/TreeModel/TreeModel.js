define("DS/TreeModel/DataModelSet",["DS/CoreEvents/ModelEvents"],function(d){var c=-1;function a(e){this._id=c++;this._setData(e);this._modelEvents=new d({target:this})}a.prototype._getData=function(e){return this._data};a.prototype._setData=function(e){this._data=e};a.prototype._getID=function(){return this._id};a.prototype._getDataModelSet=function(){return this._dataModelSet};a.prototype._getModelEvents=function(){return this._modelEvents};a.prototype._setDataModelSet=function(e){this._dataModelSet=e};a.prototype._getInfos=function(){return{}};a.prototype.update=function(e){if(e!==undefined){UWA.extend(this._data,e,true)}this._modelEvents.publish({event:"DataModel:update",data:e,context:this})};function b(){this._listOfDataModels={}}b.prototype.getDataModel=function(e){return this._listOfDataModels[e]};b.prototype.createDataModel=function(e){var f=new a(e);f._setDataModelSet(this);this._listOfDataModels[f._getID()]=f;return f};return b});var TreeNodeModelChangeStates={Unchanged:0,AttributesChanged:1<<0,NodeAdded:1<<1,NodeToBeRemoved:1<<2};define("DS/TreeModel/TreeNodeModel",["UWA/Core","UWA/Class","DS/CoreEvents/ModelEvents","DS/Utilities/Debug","DS/Utilities/Array","DS/Utilities/Data","DS/Utilities/RAFDispatcher"],function(f,a,b,i,j,c,d){var h=-1;function e(l){var n=this;this.defaultOptions={label:"",badges:{topLeft:null,topRight:null,bottomLeft:null,bottomRight:null},icons:[],grid:{},children:null,data:{},useAsyncPreExpand:undefined,getAttributeValueForFiltering:function(o){return n.getAttributeValue(o)},getAttributeValueForGrouping:function(o){return n.getAttributeValue(o)}};this._options=f.extend(f.clone(this.defaultOptions),l);var n=this;Object.defineProperty(this,"options",{get:function k(){if(n._isUsingDataModel()){var o={getAttributeValueForFiltering:function(p){return n.getAttributeValue(p)},getAttributeValueForGrouping:function(p){return n.getAttributeValue(p)}};n._getDataModel()._data=f.extend(o,n._getDataModel()._data);return n._getDataModel()._data}else{return n._options}},set:function k(o){if(n._isUsingDataModel()){n._getDataModel()._setData(o)}else{n._options=o}}});n._listOfChildren=null;Object.defineProperty(this,"__children",{get:function k(){if(n._isUsingDataModel()){return n._listOfChildren}else{return n.options.children}},set:function k(o){if(n._isUsingDataModel()){n._listOfChildren=o}else{n.options.children=o}}});this._modelEvents=new b({target:this});this._id=h++;this._nodeIsAsync=false;this._isHighlighted=false;this._isHidden=false;this.__expandAllCounter=0;this._nodeDepth=-1;this._rowID=null;this._parentNode=null;this._expandState="noExpandState";this.__dataModelID=null;if(this.options.children){this._preventResetChildren=(this.options.children.length===0);this._expandState="expandState";var m=this.options.children;this.__children=[];this.options.children=[];this.addChild(m)}this._changeStates=TreeNodeModelChangeStates.Unchanged;if(this.options._isTrueRoot){e.prototype.addRoot=function(o,p){return this.addChild(o,p)}}var n=this;this._modelEvents.subscribe({event:"DataModel:update"},function(o){o.stopPropagation();n.withTransactionUpdate(function(){n.notifyModelUpdate(o.data.grid)})})}e.prototype._setDataModel=function(k){this.__dataModelSet=k._getDataModelSet();this.__dataModelID=k._getID();k._getModelEvents()._addParent(this.getModelEvents());this.notifyModelUpdate()};e.prototype._removeDataModel=function(k){if(this.__dataModelID!==undefined&&this.__dataModelSet){k._getModelEvents()._unsetParent(this.getModelEvents());this.__dataModelID=null;this.__dataModelSet=null}this.notifyModelUpdate()};e.prototype._getDataModel=function(){return this.__dataModelSet.getDataModel(this.__dataModelID)};e.prototype._isUsingDataModel=function(){return this.__dataModelID!==null&&this.__dataModelID!==undefined};e.prototype.getModelEvents=function(){return this._modelEvents};e.prototype.addEventListener=function(k,l){return this.getModelEvents().addEventListener(k,l)};e.prototype.removeEventListener=function(k){this.getModelEvents().unsubscribe(k)};e.prototype._getRowID=function(k){if(k){this._rowID=this._computeRowID()}return this._rowID};e.prototype._getID=function(){return this._id};e.prototype.addChild=function(m,o){var n="[TreeNodeModel] -- Add child --";i.beginMeasure(n);var l;if(m instanceof Array){l=this._loadModel(m,this)}else{if(m instanceof e){if(m.isAscendantOf(this)){console.warn("TreeNodeModel: Cannot add a parent node as a child");return}else{var k=m.getParent();if(k){k.removeChild(m,true)}}}l=this._loadModel([m],this,o)}i.endMeasure(n);return l};e.prototype.moveChild=function(k,l){k.__keepSelection=true;this.addChild(k,l);delete k.__keepSelection},e.prototype.notifyModelUpdate=function(k){var l=this._getNodeInfos();if(k){l.attributes=k}this._modelEvents.publish({event:"nodeModelUpdate",data:l,context:this})};e.prototype.setAttribute=function(m,o){if((!this._referenceValues||!this._referenceValues.hasOwnProperty(m))&&this.options.grid.hasOwnProperty(m)&&!f.equals(this.options.grid[m],o)){var l=this.getTreeDocument();if(l&&l.getUseChangeTransactionMode()){this.setReferenceValue(m,this.options.grid[m]);this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}}this.options.grid[m]=o;var n=this._getNodeInfos();n.changedAttribute=m;n.changedAttributeValue=o;this._modelEvents.publish({event:"attributeChanged",data:n,context:this});var k={};k[m]=o;this.notifyModelUpdate(k)};e.prototype.updateOptions=function(n){var l={};if(n&&n.grid){var k=this.getTreeDocument();for(var m in n.grid){if(this.options.grid[m]!==n.grid[m]){l[m]=n.grid[m];if((!this._referenceValues||!this._referenceValues.hasOwnProperty(m))&&this.options.grid.hasOwnProperty(m)&&k&&k.getUseChangeTransactionMode()){this.setReferenceValue(m,this.options.grid[m]);this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}}}}if(this._isUsingDataModel()){this._getDataModel().update(n)}else{f.extend(this.options,n,true);this.withTransactionUpdate(function(){this.notifyModelUpdate(l)})}};e.prototype.onAttributeChange=function(k){return this._modelEvents.subscribe({event:"attributeChanged"},k)};e.prototype.getReferenceValue=function(k){var l;if(this._referenceValues&&this._referenceValues.hasOwnProperty(k)){l=this._referenceValues[k]}else{l=this.options.grid[k]}return l};e.prototype.setReferenceValue=function(k,l){if(!this._referenceValues){this._referenceValues={}}this._referenceValues[k]=f.clone(l,false);if(!f.equals(this.options.grid[k],l)){this._changeStates|=TreeNodeModelChangeStates.AttributesChanged}else{this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged}};e.prototype.resetToReferenceValues=function(){if(this._referenceValues){var k=this;var l={};Object.keys(this._referenceValues).forEach(function(m){if(k.options.grid.hasOwnProperty(m)&&!f.equals(k.options.grid[m],k._referenceValues[m])){l[m]=f.clone(k._referenceValues[m],false)}});this.updateOptions({grid:l});this._referenceValues=null}this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged};e.prototype.setValuesAsReference=function(){if(this._referenceValues){this._referenceValues=null;this.notifyModelUpdate()}this._changeStates&=~TreeNodeModelChangeStates.AttributesChanged};e.prototype.getChangeStates=function(){return this._changeStates};e.prototype.cancelChanges=function(l){if(l){var n=this.getChildren();if(n){for(var m=n.length;m>=0;m--){var o=n[m];if(o){o.cancelChanges(true)}}}}if(this._changeStates&TreeNodeModelChangeStates.NodeAdded){var k=this.getParent();if(k){k.removeChild(this,true)}}else{if(this._changeStates&TreeNodeModelChangeStates.AttributesChanged){this.resetToReferenceValues()}if(this._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved){this._changeStates&=~TreeNodeModelChangeStates.NodeToBeRemoved;this.notifyModelUpdate()}}this._changeStates=TreeNodeModelChangeStates.Unchanged};e.prototype.acceptChanges=function(l){if(l){var n=this.getChildren();if(n){for(var m=n.length;m>=0;m--){var o=n[m];if(o){o.acceptChanges(true)}}}}if(this._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved){var k=this.getParent();if(k){k.removeChild(this,true)}}else{if(this._changeStates&TreeNodeModelChangeStates.AttributesChanged){this.setValuesAsReference()}if(this._changeStates&TreeNodeModelChangeStates.NodeAdded){this._changeStates&=~TreeNodeModelChangeStates.NodeAdded;this.notifyModelUpdate()}}this._changeStates=TreeNodeModelChangeStates.Unchanged};e.prototype.prepareUpdate=function(){this._modelEvents.publish({event:"prepareUpdate",data:this._getNodeInfos(),context:this})};e.prototype.pushUpdate=function(){this._modelEvents.publish({event:"pushUpdatePrivate",data:this._getNodeInfos(),context:this});this._modelEvents.publish({event:"pushUpdate",data:this._getNodeInfos(),context:this})};e.prototype.insertBefore=function(m,k){this.prepareUpdate();if(k){if(m.getParent()){m.remove()}var l=k._getLocalID();this.addChild(m,l)}else{this.addChild(m)}this.pushUpdate()};e.prototype._setParent=function(k){this._parentNode=k;this._nodeDepth=k.getNodeDepth()+1};e.prototype._unsetParent=function(){this._parentNode=null;this._nodeDepth=-1};e.prototype.highlight=function(){this._isHighlighted=true;this._modelEvents.publish({event:"highlight",data:this._getNodeInfos(),context:this})};e.prototype.unhighlight=function(){this._isHighlighted=false;this._modelEvents.publish({event:"unhighlight",data:this._getNodeInfos(),context:this})};e.prototype.onHighlight=function(k){return this._modelEvents.subscribe({event:"highlight"},k)};e.prototype.onUnhighlight=function(k){return this._modelEvents.subscribe({event:"unhighlight"},k)};e.prototype.isHighlighted=function(){return this._isHighlighted};e.prototype.preSelect=function(m){var l=this.getTreeDocument();if(l){if(!this.isPreSelected()){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(m){l.getPXSO().unique(this)}else{l.getPXSO().add(this)}this._isPreSelected=true;this.pushUpdate()}}else{if(l.getXSO().get().length>1){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(m){l.getPXSO().unique(this)}this._isPreSelected=true;this.pushUpdate()}}}}else{console.warn("You tried to pre-select a treeNode which is not attached to a tree document")}};e.prototype.unPreSelect=function(){if(this.isPreSelected()){var k=this.getTreeDocument();if(k){this.prepareUpdate();k.getPXSO().remove(this);this._isPreSelected=false;this.pushUpdate()}else{console.warn("You tried to pre-select a treeNode which is not attached to a tree document")}}};e.prototype.isPreSelected=function(){var k=this.getTreeDocument();if(k){return k.getPXSO().isIn(this)}else{return this._isPreSelected}};e.prototype.select=function(n){var l=this.getTreeDocument();if(l){if(!this.isSelected()){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(n){var m=l.getXSO().get();l.getXSO().unique(this);m.forEach(function(o){o.selectionChangeIsNotFromUI()})}else{l.getXSO().add(this)}this._isSelected=true;this.selectionChangeIsNotFromUI();this.pushUpdate()}}else{if(l.getXSO().get().length>1){var k=l.options.shouldBeSelected.call(l,this);if(k){this.prepareUpdate();if(n){var m=l.getXSO().get();l.getXSO().unique(this);m.forEach(function(o){o.selectionChangeIsNotFromUI()})}this._isSelected=true;this.selectionChangeIsNotFromUI();this.pushUpdate()}}}}else{console.warn("You tried to select a treeNode which is not attached to a tree document")}};e.prototype.isSelectionChangeFromUI=function(){return Boolean(this.__selectionChangeisFromUI)};e.prototype.selectionChangeIsFromUI=function(){this.__selectionChangeisFromUI=true};e.prototype.selectionChangeIsNotFromUI=function(){this.__selectionChangeisFromUI=false};e.prototype.unselect=function(){if(this.isSelected()){var k=this.getTreeDocument();if(k){this.prepareUpdate();k.getXSO().remove(this);this._isSelected=false;this.pushUpdate()}else{console.warn("You tried to select a treeNode which is not attached to a tree document")}}};e.prototype.onSelect=function(k){return this._modelEvents.subscribe({event:"select"},k)};e.prototype.onUnselect=function(k){return this._modelEvents.subscribe({event:"unselect"},k)};e.prototype.isSelected=function(){var k=this.getTreeDocument();if(k){return k.getXSO().isIn(this)}else{return this._isSelected}};e.prototype.hide=function(k){this.withTransactionUpdate(function(){this._isHidden=true;if(!k){this.unhighlight();this.unselect()}this._modelEvents.publish({event:"hide",data:this._getNodeInfos(),context:this});var l=this.getFirstVisibleParent();if(l){l._updateExpanderState()}})};e.prototype.show=function(){this.withTransactionUpdate(function(){this._isHidden=false;this._modelEvents.publish({event:"show",data:this._getNodeInfos(),context:this});var k=this.getFirstVisibleParent();if(k){k._updateExpanderState()}})};e.prototype.isHidden=function(){return this._isHidden};e.prototype.hideChildNodes=function(){this.withTransactionUpdate(function(){if(this.hasChildren()){this.getChildren().forEach(function(k){k.hide()});this._updateExpanderState()}})};e.prototype.showChildNodes=function(){this.withTransactionUpdate(function(){if(this.hasChildren()){this.getChildren().forEach(function(k){k.show()});this._updateExpanderState()}})};e.prototype._loadModel=function(p,t,m){this.prepareUpdate();var s=this;var n=[];var l,r;var q=p.length;for(var o=0;o<q;o++){var u=p[o];var k;if(u instanceof e){k=u}else{k={};k=f.extend({label:"",icons:[],grid:null,badges:null,data:null,manager:null},u);k.children=undefined;k.manager=l}if(t){r=t._addChild(k,m)}if(u instanceof e){n.push({tree:r})}else{if(u.children&&u.children.length){n.push({tree:r});n=n.concat(s._loadModel(u.children,r))}else{if(u.children){r.__children=[];r._expandState="expandState"}n.push({tree:r})}}}this.pushUpdate();return r};e.prototype.destroy=function(){if(this.hasChildren()){var k=this;this.getChildren().forEach(function(m){m.destroy()})}this._modelEvents.unsubscribeAll();this._modelEvents=null;delete this._modelEvents;this.defaultOptions=null;for(var l in this){if(this.hasOwnProperty(l)&&typeof this[l]!=="function"){this[l]=null}}},e.prototype._propagateDepth=function(){if(this.hasChildren()){var k=this;this.getChildren().forEach(function(l){l._nodeDepth=k.getNodeDepth()+1;l._propagateDepth()})}};e.prototype._addChild=function(n,m){var k=this._addChildNode(n,m);k._nodeDepth=this.getNodeDepth()+1;k._propagateDepth();var l=k._getNodeInfos();l.nodeIndex=k._getLocalID();this._modelEvents.publish({event:"addChild",data:l,context:this});return k};e.prototype.getNthChild=function(k){if(this.getChildren()){return this.getChildren()[k]}};e.prototype.getLastChild=function(){return this.getChildren()[this.getChildren().length-1]};e.prototype._dump=function(l,k){if(!k){k={}}l=f.extend({properties:[function(){return{property:"label",value:this.options.label}},function(){return{property:"grid",value:this.options.grid}},function(){return{property:"icons",value:this.options.icons}}]},l);var n=this;l.properties.forEach(function(p){if(f.typeOf(p)==="function"){var o=p.call(n);k[o.property]=o.value}});var m=this.getChildren();if(m){k.children=[];m.forEach(function(o){k.children.push(o._dump(l))});return k}return k};e.prototype.dump=function(l,k){return this._dump(l,k)};e.prototype.isAscendantOf=function(l){var k=l;while(k&&!k.options.isRoot){if(k===this){return true}k=k.getParent()}return false};e.prototype.isVisible=function(){return this._isVisible()};e.prototype._getLocalID=function(){var k=this.getParent();if(k){var l=k.getChildren();if(l){return l.indexOf(this)}}return 0};e.prototype._isTrueRoot=function(){return this.options?this.options._isTrueRoot:false};e.prototype.acceptNodeDropAt=function(m,k){if(!m){return false}var l=!m.isAscendantOf(this);if(l&&this.options.acceptNodeDropAt){l=this.options.acceptNodeDropAt.call(this,m,k)}return l};e.prototype.remove=function(l){var k=this.getParent();if(k){return k.removeChild(this,l)}else{console.warn("Cannot remove this node because its father is undefined")}};e.prototype.removeChild=function(r,p){if(r!==undefined){this.prepareUpdate();var q;var n=this.getChildren();var m;if(typeof r==="number"){m=r;r=n[m]}else{m=n.indexOf(r)}var k=this.getTreeDocument();if(k&&k.getUseChangeTransactionMode()&&!p){if(r&&!(r._changeStates&TreeNodeModelChangeStates.NodeToBeRemoved)){r._changeStates|=TreeNodeModelChangeStates.NodeToBeRemoved;r.notifyModelUpdate()}}else{this._modelEvents.publish({event:"preRemoveChild",data:r._getNodeInfos(),context:this});r._unsetParent();r._detach(null);if(m!==-1){q=n.splice(m,1)[0]}if(n.length===0&&!this._preventResetChildren){this.__children=null}var o=true;for(var l=0;l<n.length;l++){if(n[l].isHidden()===false){o=false;break}}if(o){this._updateExpanderState()}this._modelEvents.publish({event:"removeChild",data:r._getNodeInfos(),context:this})}this.pushUpdate();return q}else{console.warn("Cannot remove an undefined child")}};e.prototype.removeChildren=function(){this.prepareUpdate();var n=[];var l=this.getChildren();var m=this;if(l){for(var k=l.length-1;k>=0;k--){n.push(m.removeChild(l[0]))}}this.pushUpdate();return n};e.prototype._addChildNode=function(o,n){var m;if(o instanceof e){m=o;var k=m.getParent();if(k){k.removeChild(m,true)}}else{m=new e(o)}var l=this.getTreeDocument();if(l){m._modelEvents._setParent(l._getTrueRoot()._modelEvents)}else{m._modelEvents._setParent(this._modelEvents)}if(!this.__children){this.__children=[]}if(n===undefined){n=this.__children.push(m)-1}else{this.__children.splice(n,0,m)}m._localID=n;m._parentNode=this;this._updateExpanderState();if(l&&l.getUseChangeTransactionMode()){m._changeStates|=TreeNodeModelChangeStates.NodeAdded}return m};e.prototype._detach=function(){this._rowID=null;if(this.hasChildren()){j.optimizedForEach(this.getChildren(),function(l,k){l._detach()})}};e.prototype.isExpanded=function(){if(this._depth===0){return true}var k=this.getState();return k==="expanded"||k==="partiallyExpanded"};e.prototype.onPreExpand=function(k){return this._modelEvents.subscribe({event:"preExpand"},k)};e.prototype.onPreExpandAll=function(k){return this._modelEvents.subscribe({event:"preExpandAll"},k)};e.prototype.onPostExpand=function(k){return this._modelEvents.subscribe({event:"postExpand"},k)};e.prototype.onPreCollapse=function(k){return this._modelEvents.subscribe({event:"preCollapse"},k)};e.prototype.onPostCollapse=function(k){return this._modelEvents.subscribe({event:"postCollapse"},k)};e.prototype.preExpandDone=function(l){l=f.extend({preventExpandAll:false,state:"expanded"},l);var k=this.getTree();if(k){k._syncRowIndexes()}this._modelEvents.publish({event:"PRE_EXPAND_DONE",context:this,data:l})};e.prototype._getNodeInfos=function(){return{nodeModel:this,virtualRowID:this._rowID,nodeLocalID:this._localID}};e.prototype.setState=function(k){k=f.extend({state:null},k);if(k.state!==null){var l={noChildren:"noExpandState",expanding:"expandingState",partiallyExpanded:"partiallyExpandedState",expanded:"collapseState",collapsed:"expandState"};if(!(this.getState()==="noChildren"&&k.state==="expanding")){this._expandState=l[k.state];this._modelEvents.publish({event:"expandStateChange",context:this,data:k})}}};e.prototype.getState=function(){var k={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};return k[this._expandState]};e.prototype.expand=function(k){return this._privateExpand(k)};e.prototype.expandNLevels=function(k){k=f.extend({expandAll:false,numberOfLevelsToExpand:1},k);return this._privateExpand(k)};e.prototype._privateExpand=function(u,n,l){var r=this;u=f.extend({expandAll:false,interactiveExpandAll:false,numberOfLevelsToExpand:1,onExpandComplete:function(v){}},u);this._modelEvents.publish({event:"preExpandPrivateAsync",data:s,context:this});if(n===undefined){n=0}n++;if(l===undefined){l=this;this.__expandAllCounter=0}l._beginOfSubExpand(u);var q=this.getTreeDocument();var m=r.options.useAsyncPreExpand!==undefined?r.options.useAsyncPreExpand:(q?q.options.useAsyncPreExpand:false);var k=r.getChildren();var t=true;if(k&&k.length===0){t=false}if(k){for(var o=0;o<k.length;o++){if(k[o].isHidden()===false){t=false;break}}}if(!t||r._expandState==="expandState"){r.setState({state:"expanding"});var s=f.extend(r._getNodeInfos(),u);var p=function(y,w){if(w===undefined){w="expanded"}var x={noChildren:"noExpandState",expanding:"expandingState",partiallyExpanded:"partiallyExpandedState",expanded:"collapseState",collapsed:"expandState"};r._expandState=x[w];r._isExpanded=true;r._modelEvents.publish({event:"expand",data:s,context:r});i.log("3) expand ",r.options.label);if((u.expandAll)||(n<u.numberOfLevelsToExpand)){var v=r.getVisibleChildren();if(v&&!y){j.optimizedForEach(v,function(A,z){A._privateExpand(u,n,l)})}else{if(u.onExpandComplete){u.onExpandComplete.call(r,u)}}}l._endOfSubExpand(u,y);r._modelEvents.publish({event:"postExpand",data:s,context:r});i.log("4) post expand on ",r.options.label);r._modelEvents.publish({event:"postExpandPrivate",data:s,context:r})};if(m){i.log("watching pre expand on ",r.options.label);r._modelEvents.subscribeOnce({event:"PRE_EXPAND_DONE"},function(v){i.log("2) async pre expand done! ",r.options.label);p.call(this,v.data.preventExpandAll,v.data.state)})}i.log("1) pre expand ",r.options.label);r._modelEvents.publish({event:"preExpandPrivate",data:s,context:r});r._modelEvents.publish({event:"preExpand",data:s,context:r});if(!m){i.log("2) sync pre expand done! ",r.options.label);p()}}else{if(u.onExpandComplete){u.onExpandComplete.call(r,u)}l._endOfSubExpand(u,false)}};e.prototype._beginOfSubExpand=function(k){this.prepareUpdate();this.__expandAllCounter++};e.prototype._endOfSubExpand=function(k,l){this.__expandAllCounter--;this.pushUpdate();if(this.__expandAllCounter===0){if((k&&k.expandAll)){this._modelEvents.publish({event:"postExpandAll",data:this._getNodeInfos(),context:this})}}if(this.__expandAllCounter<0){console.error("too many calls of _endOfSubExpand")}};e.prototype.withTransactionUpdate=function(k){if(k){this.prepareUpdate();try{k.call(this,this._getNodeInfos())}finally{this.pushUpdate()}}};e.prototype.expandAll=function(k){this._modelEvents.publish({event:"preExpandAll",data:this._getNodeInfos(),context:this});if(!this.options._isTrueRoot){this.expand({expandAll:true,onExpandComplete:k&&k.onExpandComplete})}};e.prototype.processDescendants=function(l){var k={async:false,onlyVisibleNodes:false,processNode:function(m){},treeTraversalOrder:"preOrder",onComplete:function(){}};l=f.extend(k,l);return this._getDescendantAndProcess(undefined,l)};e.prototype._getDescendantAndProcess=function(n,l){var k={async:false,onlyVisibleNodes:false,treeTraversalOrder:"preOrder"};l=f.extend(k,l);if(n===undefined){n=[]}else{n.push(this)}var m=this.getChildren();if(m){if(l.onCompleteCB===undefined){j.optimizedForEach(m,function(o){if(!o){return}if(l.onlyVisibleNodes){if(o.isVisible()){if(l.treeTraversalOrder==="postOrder"){if(o.hasChildren()&&o.isExpanded()){o._getDescendantAndProcess(n,l)}}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}n.push(o);if(l.treeTraversalOrder==="preOrder"){if(o.hasChildren()&&o.isExpanded()){o._getDescendantAndProcess(n,l)}}}}else{if(l.treeTraversalOrder==="postOrder"){o._getDescendantAndProcess(n,l)}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}if(l.treeTraversalOrder==="preOrder"){o._getDescendantAndProcess(n,l)}}})}else{c.forEach(m,function(o){if(l.treeTraversalOrder==="postOrder"){o._getDescendantAndProcess(n,l)}if(l.processNode!==undefined){l.processNode.call(o,o._getNodeInfos())}if(l.treeTraversalOrder==="preOrder"){o._getDescendantAndProcess(n,l)}},50,l.onCompleteCB)}}return n};e.prototype.getAllDescendants=function(k){return this._getDescendantAndProcess(k)};e.prototype.collapseAll=function(){this.prepareUpdate();this._modelEvents.publish({event:"preCollapseAll",data:this._getNodeInfos(),context:this});if(!this.options._isTrueRoot){this.collapse()}this.processDescendants({processNode:function(){this.collapse()}});this._modelEvents.publish({event:"postCollapseAll",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.matchSearch=function(){this._isMatchingSearch=true;this.prepareUpdate();this._modelEvents.publish({event:"matchSearch",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.unmatchSearch=function(){this._isMatchingSearch=false;this.prepareUpdate();this._modelEvents.publish({event:"unmatchSearch",data:this._getNodeInfos(),context:this});this.pushUpdate()};e.prototype.isMatchingSearch=function(){return this._isMatchingSearch};e.prototype.collapse=function(k){if(k===undefined){k={notify:true}}if(this.getChildren()||this.getState()==="expanded"){this._expandState="expandState";this._isExpanded=false}if(k.notify){this.prepareUpdate();this._modelEvents.publish({event:"preCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this._modelEvents.publish({event:"collapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this._modelEvents.publish({event:"postCollapse",data:{nodeModel:this,virtualRowID:this._rowID},context:this});this.pushUpdate()}};e.prototype.search=function(k,m){k=f.extend({match:function(p){},shouldStop:function(p){return false},useTransaction:true},k);var n={nodeModel:this};if(k.shouldStop(this)){return}if(k.useTransaction){this.prepareUpdate()}if(m===undefined){m=[]}else{var o=k.match(n);if(o){m.push(this)}}var l=this.getChildren();if(l){l.forEach(function(p){p.search(k,m)})}this._modelEvents.publish({event:"search",data:this._getNodeInfos(),context:this});if(k.useTransaction){this.pushUpdate()}return m};e.prototype.getNumberOfDescendants=function(l){if(l===undefined){l=0}var k=this.getChildren();if(k){l=l+k.length;k.forEach(function(m){l=m.getNumberOfDescendants(l)})}return l};e.prototype.getNumberOfVisibleDescendants=function(l){if(l===undefined){l=0}var k=this.getVisibleChildren();if(k){l=l+k.length;k.forEach(function(m){l=m.getNumberOfVisibleDescendants(l)})}return l};e.prototype.getTree=function(){if(this.options._isTrueRoot){return this.options.tree}else{var k=this.getRoot();if(k){return k._tree}}};e.prototype.getRoot=function(){var k=this;while(k&&!k.isRoot()){k=k.getParent()}return k};e.prototype.getPath=function(){var k=[];k.push(this);this._getAndProcessParents(function(l){k.push(l.nodeModel)});return k.reverse()};e.prototype.buildPath=function(l){var k={path:"",buildPath:function(o,n,m){return o+n.options.label+"/"}};l=f.extend(k,l);this.getPath().forEach(function(n,m){l.path=l.buildPath.call(n,l.path,n,m)});return l.path};e.prototype._getAndProcessParents=function(m){var k=this;var l=0;while(k&&!k.isRoot()){k=k.getParent();if(k&&m!==undefined){m.call(k,k._getNodeInfos())}l++}return k};e.prototype._getTrueRoot=function(){var k=this.getRoot();if(k){return k.getParent()}else{if(this._isTrueRoot()){return this}}};e.prototype.getTreeDocument=function(){var k=this._getTrueRoot();if(k){return k._treeDocument}};e.prototype.reverseExpand=function(){var k=this;while(k&&!k.isRoot()){k=k.getParent();if(!k.isExpanded()){k.expand()}}};e.prototype.getParents=function(m){var k=this;var l=[];while(k){k=k.getParent();if(k&&(m||!k.options._isTrueRoot)){l.push(k)}}return l};e.prototype.getFirstVisibleParent=function(l){var k=this;while(k&&!k.isVisible()){k=k.getParent()}return k};e.prototype.getBrothers=function(){var k=this.getParent();var l=this;if(k){return k.getChildren().filter(function(m){return m!==l})}};e.prototype.getNextBrother=function(){var l=this.getParent();if(l){var k=l.getChildren();if(k){var m=k.indexOf(this);if(m>-1){if(m+1<k.length){return k[m+1]}else{l.getNextBrother()}}}}};e.prototype.getPreviousBrother=function(){var l=this.getParent();if(l){var k=l.getChildren();if(k){var m=k.indexOf(this);if(m>0){return k[m-1]}}}};e.prototype._getLastVisibleNode=function(){if(this.hasChildren()===false||(this.hasChildren()===true&&this.isExpanded()===false)){return this}else{var k=this.getChildren();return k[k.length-1]._getLastVisibleNode()}};e.prototype.getPreviousNode=function(){var l;var m=this.getPreviousBrother();if(m){if(m.hasChildren()===false||(m.hasChildren()===true&&m.isExpanded()===false)){l=m}else{l=m._getLastVisibleNode()}}else{var k=this.getParent();l=k}if(l._isTrueRoot()){}else{return l}};e.prototype.getNextNode=function(l){if(this.hasChildren()&&!l){return this.getChildren()[0]}else{var m=this.getNextBrother();if(m){return m}else{var k=this.getParent();if(k){return k.getNextNode(true)}else{}}}};e.prototype.getNextVisibleNode=function(){var k=this.getNextNode((this.hasChildren()&&!this.isExpanded()));if(k&&k.isVisible()===false){return k.getNextVisibleNode()}else{return k}};e.prototype.getPreviousVisibleNode=function(){var k=this.getPreviousNode();if(k&&k.isVisible()===false){return k.getPreviousVisibleNode()}else{return k}};e.prototype._getPreviousBrothers=function(){var k=[];var o=this.getParent();if(o){var n=o.getChildren();var l=n.indexOf(this);for(var m=0;m<l;m++){k.push(n[m])}}return k};e.prototype._computeRowID=function(){if(this.isVisible()){var o=0;var k=function(p){p._getPreviousBrothers().filter(function(q){return q.isVisible()}).forEach(function(q){o=o+q.getNumberOfVisibleDescendants()+1})};k(this);var n=this.getParents(true).filter(function(p){return p.isVisible()||p._isTrueRoot()});if(n.length>1){for(var m=0;m<n.length;m++){var l=n[m];if(!l.options._isTrueRoot){o++}k(l)}}return o}else{return null}};e.prototype.hasChildren=function(){var k=this.getChildren();if(k&&k.length>0){return true}else{return false}};e.prototype.getParent=function(){return this._parentNode};e.prototype.isLastChild=function(){if(!this.getParent()){return false}var l=this.getParent().getChildren();var n=l.indexOf(this);for(var k=n+1;k<l.length;k++){var m=l[k];if(m.isHidden()===false&&m.isFiltered()===false){return false}}return true};e.prototype.getNthParent=function(m){var k=this;var l=0;while(k&&l<m){k=k.getParent();l++}return k};e.prototype.getNodeDepth=function(){if(this._nodeDepth===null&&this._nodeDepth===undefined){this._nodeDepth=this.getParents().length}return this._nodeDepth};e.prototype.isRoot=function(){var k=this.getParent();if(this.getNodeDepth()===0&&k&&k._isTrueRoot()){return true}else{return false}};e.prototype._isVisible=function(){if(this.isHidden()||this.isFiltered()){return false}if(this.isRoot()){return true}var k=this.getParent();if(k&&k.isExpanded()){return k.isVisible()}return false};e.prototype._updateExpanderState=function(){var l=this.getChildren();switch(f.typeOf(l)){case"string":this._expandState="asyncState";this._nodeIsAsync=true;break;case"array":var m=true;if(l.length===0){m=false}for(var k=0;k<l.length;k++){if(l[k].isHidden()===false){m=false;break}}if(m){this._expandState="noExpandState"}else{if(!this.isExpanded()){this._expandState="expandState"}else{this._expandState="collapseState"}}this._nodeIsAsync=false;break;default:this._expandState="noExpandState";break}};e.prototype.getChildren=function(){return this.__children};e.prototype.getNumberOfChildren=function(){var k=this.getChildren();if(k){return k.length}else{return 0}};e.prototype.getVisibleChildren=function(k){var l=this.getChildren();if(l instanceof Array&&l.length>0){if(k){return l.filter(function(m){return !m.isHidden()})}else{return l.filter(function(m){return m.isVisible()})}}};e.prototype.getNumberOfVisibleChildren=function(k){var m=0;var l=this.getChildren();if(l instanceof Array&&l.length>0){if(k){l.forEach(function(n){if(!n.isHidden()){m++}})}else{l.forEach(function(n){if(n.isVisible()){m++}})}}return m};e.prototype.getLabel=function(){return this.options.label};e.prototype.getIcons=function(){return this.options.icons};e.prototype.getIcons=function(){return this.options.icons};e.prototype.setLabel=function(k){this.updateOptions({label:k})};e.prototype.setBadges=function(k){if(k!==null){if(!this.options.badges){this.options.badges={}}var l=f.extend(this.options.badges,k);this.updateOptions({badges:l})}else{this.options.badges=null;this.updateOptions({badges:null})}};e.prototype.getBadges=function(){return this.options.badges};e.prototype.sortChildren=function(m){m=f.extend({isRecursive:false,sortFunction:function(p,l){return p.options.label<l.options.label?-1:1}},m);if(this.hasChildren()){this.prepareUpdate();var o=this.getChildren();o.sort(m.sortFunction);if(m.isRecursive){for(var n=0,k=o.length;n<k;n++){if(o[n].hasChildren()){o[n].sortChildren(m)}}}this._modelEvents.publish({event:"sortChildren",data:this._getNodeInfos(),context:this});this.pushUpdate()}};function g(k){e.call(this,k)}g.prototype=Object.create(e.prototype);g.prototype.constructor=g;g.prototype.getIdentifier=function(){return this._options.identifier};g.prototype.getFakeNodesTable=function(){return this._options.fakeNodesTable};e.prototype.getFakeNodesTable=function(){return this._fakeNodesTable};g.prototype.getProperty=function(){return this._options.property};g.prototype.getNumberOfOriginalChildren=function(){return Object.assign({},this._options.numberOfOriginalChildren)};g.prototype.setNumberOfOriginalChildren=function(k){if(k.total!==this._options.numberOfOriginalChildren.total||k.notHidden!==this._options.numberOfOriginalChildren.notHidden){this._options.numberOfOriginalChildren=Object.assign({},k);this.updateOptions({label:this.getProperty()+": "+this.getIdentifier()+" ("+k.notHidden+")"})}if(k.notHidden>0){if(this.isHidden()){this.show()}if(!this.isExpanded()){this.expand()}}else{if(!this.isHidden()){this.hide()}}if(k.total===0){this.remove()}};e.prototype._addCallbacksForGrouping=function(){var l=this._getTrueRoot();if(!l.__groupingCallbackSet){l.__groupingCallbackSet=true;var k=function(t){var s=t.data.nodeModel;var n=s.getParent();if(!s||s._haveToRecomputeLabelAutomatically()||!n||!n._haveToRecomputeLabelAutomatically()){return}l.prepareUpdate();var m=n.getNumberOfOriginalChildren().notHidden;var r=n._getAndUpdateNumberOfDirectOriginalChildren().notHidden;var p=r-m;for(var q=n.getParent();q._haveToRecomputeLabelAutomatically();q=q.getParent()){var o=q.getNumberOfOriginalChildren();o.notHidden+=p;q.setNumberOfOriginalChildren(o)}l.pushUpdate()};l.addEventListener("show",k);l.addEventListener("hide",k)}};g.prototype._getAndUpdateNumberOfDirectOriginalChildren=function(){var o=0,n=0;var m=this.getChildren();if(m){for(var k=m.length;k>0;k--){var p=m[k-1];var l=p._getAndUpdateNumberOfDirectOriginalChildren();o+=l.total;n+=l.notHidden;if(l.total===0){delete this.getFakeNodesTable()[p.getIdentifier()]}}}this.setNumberOfOriginalChildren({total:o,notHidden:n});return this.getNumberOfOriginalChildren()};e.prototype._getAndUpdateNumberOfDirectOriginalChildren=function(){return{total:1,notHidden:this.isHidden()?0:1}};g.prototype._haveToRecomputeLabelAutomatically=function(){return true};e.prototype._haveToRecomputeLabelAutomatically=function(){return false};g.prototype._updateLabelAutomatically=function(){var k=this.getParent();if(k&&k._haveToRecomputeLabelAutomatically()){k._updateLabelAutomatically();return}this._getAndUpdateNumberOfDirectOriginalChildren()};e.prototype._updateLabelAutomatically=function(){var k=this.getChildren();if(k&&k.length>0&&k[0]._haveToRecomputeLabelAutomatically()){k.forEach(function(l){l._updateLabelAutomatically()})}};g.prototype._canBeGrouped=function(){return false};e.prototype._canBeGrouped=function(){return true};e.prototype._groupChild=function(l,o){if(!o||o.length===0){if(l.getParent()!==this){this.moveChild(l)}return}var m=l.options.getAttributeValueForGrouping(o[0]);if(m===undefined||m===""){m="NA"}var k=this.getFakeNodesTable();var n=k[m];if(!n){n=new g({property:o[0],identifier:m,fakeNodesTable:{},numberOfOriginalChildren:{total:0,notHidden:0}});k[m]=n;this.addChild(n)}if(n.isHidden()){n.show()}o.shift();n._groupChild(l,o)};g.prototype._groupChildren=function(k){return};e.prototype._groupChildren=function(p){var n=this.getChildren();if(!n){return}var l=0;for(var k=0;k<n.length;){var o=n[k];if(o._canBeGrouped()){o.__initialIdxInParentChildren=l++;var m=p.slice();this._groupChild(o,m)}else{k++}}};g.prototype.groupChildren=function(k){return};e.prototype.groupChildren=function(l){this.prepareUpdate();var k=this.getTreeDocument();var m=k.getUseChangeTransactionMode();k.setUseChangeTransactionMode(false);this.ungroupChildren(l&&l.propertiesToGroup);if(l&&l.propertiesToGroup&&l.propertiesToGroup.length>0){if(!this._fakeNodesTable){this._fakeNodesTable={}}this._addCallbacksForGrouping();this._groupChildren(l.propertiesToGroup);this._updateLabelAutomatically()}this._modelEvents.publish({event:"groupChildren",data:this._getNodeInfos(),context:this});k.setUseChangeTransactionMode(m);this.pushUpdate()};g.prototype._removeGrouping=function(m,s,n,q){var l=this.getChildren();if(l&&l.length>0){var p=q||!s||s.length<=n||s[n]!==this.getProperty();for(var r=l.length;r>0;r--){var k=l[r-1];var o=k._removeGrouping(m,s,n+1,p);if(o){delete this.getFakeNodesTable()[k.getIdentifier()]}}if(p){this.remove(true)}else{this.hide()}return p}};e.prototype._removeGrouping=function(k,l,n,m){if(k!==this.getParent()){this.__keepSelection=true;k.addChild(this);delete this.__keepSelection}return false};g.prototype.ungroupChildren=function(k){return};e.prototype.ungroupChildren=function(n){var l=this.getChildren();if(!l||l.length===0||!this.getFakeNodesTable()){return}for(var k=l.length;k>0;k--){var o=l[k-1];var m=o._removeGrouping(this,n,0,false);if(m){delete this.getFakeNodesTable()[o.getIdentifier()]}}if(Object.keys(this.getFakeNodesTable()).length===0){this._fakeNodesTable=undefined;delete this._fakeNodesTable}l.sort(function(q,p){if(q.__initialIdxInParentChildren===undefined){return p.__initialIdxInParentChildren===undefined?0:1}if(p.__initialIdxInParentChildren===undefined){return q.__initialIdxInParentChildren===undefined?0:-1}return q.__initialIdxInParentChildren<p.__initialIdxInParentChildren?-1:1})};e.prototype.getAttributeValue=function(k){if(k==="label"){return this.getLabel()}return this.options.grid[k]};e.prototype.isFiltered=function(){return this.__filterCpt!==undefined&&this.__filterCpt>0};g.prototype.canBeFiltered=function(){return false};e.prototype.canBeFiltered=function(k){return true};e.prototype.hasNoRepresentation=function(){return false};e.prototype.incrementFilteredCount=function(){if(!this.__filterCpt){this.__filterCpt=0}this.__filterCpt++};e.prototype.decrementFilteredCount=function(){this.__filterCpt--};e.extendNode=function(k){var o=function(p){if(k.defaultOptions){this.defaultOptions=f.extend(f.clone(e.prototype.defaultOptions),k.defaultOptions)}if(this.defaultOptions===undefined){this.defaultOptions={}}this.options=f.extend(this.defaultOptions,p);e.call(this,p)};o.prototype=Object.create(this.prototype);o.prototype.constructor=o;o.extendNode=this.extendNode;for(var n in k){var m=k[n];if(n!=="defaultOptions"){if(typeof m==="function"){o.prototype[n]=(function l(r,q,p){return function(){if(r.prototype[q]){this._parent=r.prototype[q]}return p.apply(this,arguments)}})(e,n,m)}else{o.prototype[n]=m}}}return o};e.prototype.selectAll=function(l){var k=this.getTreeDocument();if(k){var m=this;this.withTransactionUpdate(function(){var n=[];m.processDescendants({processNode:function(o){if(k.options.shouldBeSelected.call(k,o.nodeModel)){n.push(o.nodeModel)}}});k.getXSO().add(n)})}};e.prototype.areAllChildrenSelected=function(){var m=true;if(this.hasChildren()){var l=this.getChildren();for(var k=0;k<l.length&&m;k++){if(l[k].isSelected()===false){m=false}}}return m};e.prototype.areAllChildrenUnselected=function(){var m=true;if(this.hasChildren()){var l=this.getChildren();for(var k=0;k<l.length&&m;k++){if(l[k].isSelected()===true){m=false}}}return m};e.prototype.unselectAll=function(k){this.withTransactionUpdate(function(){this.processDescendants({processNode:function(l){l.nodeModel.unselect()}})})};e.createTreeNodeDataModel=function(l,n){var m=new e();var k=l.createDataModel(n);m._setDataModel(k);return m};e.prototype.getStructurePath=function(){return this.buildPath({buildPath:function(m,l,k){return m+l._getLocalID()+"/"}})};return e});define("DS/TreeModel/BaseFilter",["DS/Core/BaseComponent"],function(b){var a=b.inherit({name:"filter",publishedProperties:{filterManager:{defaultValue:null,type:"object",readOnly:true},filterId:{defaultValue:"",type:"string",readOnly:true},propertyId:{defaultValue:"",type:"string",readOnly:true},filterModel:{defaultValue:undefined,type:"object"}},isDataFiltered:function(c){return false},isEmpty:function(){return false},_build:function(){this._listOfFilteredData=[]},destroy:function(){this._listOfFilteredData.forEach(function(c){c.decrementFilteredCount()});this._parent()},_applyFilterModel:function(c){if(!this.filterManager){return}this.filterManager.model.prepareUpdate();this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()});this._listOfFilteredData=[];if(!this.filterModel){this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this});if(this.filterManager.filterModel[this.propertyId]){delete this.filterManager.filterModel[this.propertyId].filterModel}this.filterManager.model.pushUpdate();return}this.filterManager.filterModel[this.propertyId].filterModel=this.filterModel;var d=this;this.filterManager.model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(f){if(this._preventFiltering===true){delete this._preventFiltering;return}if(f.nodeModel.canBeFiltered()&&d.isDataFiltered(f.nodeModel)){this.incrementFilteredCount();d._listOfFilteredData.push(this)}else{var e=this.getParents();e.forEach(function(g){g._preventFiltering=true})}}});this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this});this.filterManager.model.pushUpdate()},_applyProperties:function(c){this._parent(c);if(this.isDirty("filterModel")){this._applyFilterModel(c.filterModel)}}});return a});define("DS/TreeModel/StringRegExpFilter",["DS/TreeModel/BaseFilter"],function(a){var b=a.inherit({name:"stringregexpfilter",publishedProperties:{},isDataFiltered:function(g){var h=(g.options&&g.options.getAttributeValueForFiltering)?g.options.getAttributeValueForFiltering(this.propertyId):g.getAttributeValue(this.propertyId);var e=this.filterModel;if(!e||!e.condition1){return false}var c=function(j){if(!j||j.filter===""){return true}var i=undefined;switch(j.type){case"startsWith":i=new RegExp("^"+j.filter,"i");break;case"endsWith":i=new RegExp(j.filter+"$","i");break;case"contains":i=new RegExp(j.filter,"i");break}if(!i){return true}return i.test(h)};var d=c(e.condition1);if(!e.operator){return !d}else{if(e.operator==="or"&&d){return false}else{if(e.operator==="and"&&!d){return true}}}var f=c(e.condition2);return !f},isEmpty:function(){return !this.filterModel||!this.filterModel.condition1||this.filterModel.condition1.filter===""}});return b});define("DS/TreeModel/SetFilter",["DS/TreeModel/BaseFilter"],function(a){var b=a.inherit({name:"setfilter",publishedProperties:{},isDataFiltered:function(c){if(!this.filterModel){return false}var d=c.getAttributeValue(this.propertyId);if(this.filterModel.length===0){return false}return this.filterModel.indexOf(d)===-1},isEmpty:function(){if(!this.filterManager||!this.filterManager.model){return true}if(!this.filterModel||this.filterModel.length===0){return true}var d=this.filterManager.model;var c=false;var e=this;d.search({shouldStop:function(){return c},match:function(f){if(e.filterModel.indexOf(f.nodeModel.getAttributeValue(e.propertyId))===-1){c=true}}});return !c}});return b});define("DS/TreeModel/TreeNodeModelProxy",["DS/TreeModel/TreeNodeModel","DS/Utilities/Array"],function(f,d){function e(g){f.call(this,g)}e.prototype=Object.create(f.prototype);e.prototype.constructor=e;var a;e.setCurrentContext=function(g){if(g){a=g.document}};function c(j){var m=this.getTreeDocument();var l;if(m&&m.options){l=m.options.proxy}if(l!==undefined){var h=l.options;var g=l.type;var k=e[g];if(k){var i=k[j];if(i){return i.call(this)}}}return f.prototype[j].call(this)}function b(j){var m=this.getTreeDocument();var l;if(m&&m.options){l=m.options.proxy}if(l!==undefined){var h=l.options;var g=l.type;var k=e[g];if(k){var i=k[j];if(i){return i.call(this,h)}}}return f.prototype[j].call(this)}e.prototype.isRoot=function(){return c.call(this,"isRoot")};e.prototype._isTrueRoot=function(){return b.call(this,"_isTrueRoot")};e.prototype.getTreeDocument=function(){if(a){return a}if(this._treeDocument){return this._treeDocument}else{var g=this.getParent();if(g!==undefined){return g.getTreeDocument()}}};e.prototype.addChild=function(i,j){var h;if(i instanceof Array){h=this._loadModel(i,this)}else{if(i instanceof f){var g=i.getParent();if(g){g.removeChild(i)}}h=this._loadModel([i],this,j)}return h};e.prototype.getNodeDepth=function(){return c.call(this,"getNodeDepth")};e.prototype.getParents=function(i){var g=this;var h=[];while(g){g=g.getParent();if(g&&(i||!g._isTrueRoot())){h.push(g)}if(g&&g._isTrueRoot()){g=undefined}}return h};e.SUBSET={isRoot:function(){return this.getParent()._isTrueRoot()},_isTrueRoot:function(g){return(this===g.target)},getNodeDepth:function(){return this.getParents().length}};e.FLATTEN={getNodeDepth:function(){return 0},getChildren:function(){if(this._isTrueRoot()){return this.getAllDescendants()}else{return[]}}};return e});define("DS/TreeModel/FilterManager",["DS/Core/BaseComponent","DS/CoreEvents/ModelEvents","DS/TreeModel/StringRegExpFilter","DS/TreeModel/SetFilter"],function(a,e,f,d){var c=function(k,g){var i=0;var h=this._listOfFilters[k];if(h!==undefined){if(h.filterId===g.filterId){h.filterModel=g.filterModel;return 3}h.destroy();this._listOfFilters[k]=undefined;delete this._listOfFilters[k];i=1}this.filterModel[k]=g;var j=this.FILTERS_MAP[g.filterId];if(!j){console.log("No filter has been registered for id ",g.filterId);return 0}this._listOfFilters[k]=new j({filterManager:this,propertyId:k,filterModel:g.filterModel,filterId:g.filterId});return 1+i};var b=a.inherit({name:"filtermanager",publishedProperties:{model:{defaultValue:undefined,type:"object",readOnly:true},filterModel:{defaultValue:{},type:"object"}},registerFilter:function(h,g){this.FILTERS_MAP[h]=g},setPropertyFilterModel:function(i,g){var h=c.call(this,i,g);if(h===0){this.filterModel[i]=undefined;delete this.filterModel[i];this.publish("filterModelChange")}},subscribe:function(h,g){return this._modelEvents.subscribe({event:h},g)},unsubscribe:function(g){return this._modelEvents.unsubscribe(g)},publish:function(h,g){if(this._preventPublishEvent===0){this._modelEvents.publish({event:h,data:g,context:this})}},isDataFiltered:function(h){for(var g in this._listOfFilters){if(this._listOfFilters[g].isDataFiltered(h)){return true}}return false},getFilters:function(){return this._listOfFilters},_build:function(){this.FILTERS_MAP={stringRegexp:f,set:d,numberComparator:null};this._listOfFilters={};this._modelEvents=new e();this._preventPublishEvent=0},_applyFilterModel:function(h){var i=this;var g=Object.keys(this._listOfFilters);var j=Object.keys(this.filterModel);i._preventPublishEvent++;j.forEach(function(l){var k=c.call(i,l,i.filterModel[l]);if(k===0){i.filterModel[l]=undefined;delete i.filterModel[l]}var m=g.indexOf(l);if(m!==-1){g.splice(m,1)}});g.forEach(function(k){i._listOfFilters[k].destroy();delete i._listOfFilters[k]});i._preventPublishEvent--;this.publish("filterModelChange")},_applyProperties:function(g){this._parent(g);if(this.isDirty("filterModel")){this._applyFilterModel(g.filterModel)}}});return b});define("DS/TreeModel/TreeDocument",["UWA/Core","UWA/Class","DS/Core/Core","DS/TreeModel/TreeNodeModel","DS/Selection/XSO","DS/CoreEvents/ModelEvents","DS/Utilities/Array","DS/Utilities/Data","DS/TreeModel/FilterManager"],function(d,a,h,e,j,b,k,c,g){var f=a.extend({defaultOptions:{dataModelSet:null,useAsyncPreExpand:false,shouldBeSelected:function(l){return true},shouldBeEditable:function(l){return true},shouldAcceptDrag:function(l){return true},shouldAcceptDrop:function(l){return true},insert:function i(n,m,l){this.withTransactionUpdate(function o(){m.insertBefore(n,l)},this)},nodeModelClass:e},init:function(m){this._parent(m);this._isExpandingCounter=0;this.options=d.extend(d.clone(this.defaultOptions),m);this._modelEvents=new b();var l=function(p,o){return p._getID()===o._getID()};var n=function(o){return o._getID()};this._xso=new j({getElementID:n,useUniqueID:true,areEquals:l});this._pxso=new j({getElementID:n,useUniqueID:true,areEquals:l});this._listeners=[];this._XSOEventListeners=[];this._numberOfNodesInDocument=0;this._useChangeTransactionMode=false;this._createTrueRoot();if(this.options.useAsyncPreExpand===true){this.onPreExpand(function(o){o.target.preExpandDone()})}},getModelEvents:function(){return this._trueRoot?this._trueRoot._modelEvents:null},_bindEventOnDocument:function(l,m){this._listeners.push(this._trueRoot._modelEvents.subscribe({event:l},m))},_bindEventOnXSO:function(l,m){this._XSOEventListeners.push(this.getXSO()[l](m))},_cleanBindings:function(){var m=this;this._listeners.forEach(function(n){m._trueRoot._modelEvents.unsubscribe(n)});this._listeners=[];var l=this.getXSO();this._XSOEventListeners.forEach(function(n){l.unsubscribe(n)});this._XSOEventListeners=[]},destroy:function(){this._getTrueRoot()._modelEvents.publish({event:"preDestroyDocument"});this._cleanBindings();this._getTrueRoot()._treeDocument=null;this._getTrueRoot().destroy();this._trueRoot=null;this._xso=null;this._pxso=null},isInTransaction:function(){return this._updateCnt>0},_observeEvents:function(o){var p=this;this._cleanBindings();this._updateCnt=0;this._bindEventOnDocument("active",function(r){if(p._activeNode){p._activeNode.inactive()}p._activeNode=r.target});this._bindEventOnDocument("addChild",function(r){p._requireRowsIndexing();p._numberOfNodesInDocument++});this._bindEventOnDocument("removeChild",function(r){p._requireRowsIndexing();p._numberOfNodesInDocument--});this._bindEventOnDocument("hide",function(r){p._requireRowsIndexing()});this._bindEventOnDocument("show",function(r){p._requireRowsIndexing()});this._bindEventOnDocument("preRemoveChild",function(r){var s=r.data.nodeModel;if(!s.__keepSelection){s.unselect();s.unselectAll()}});this._bindEventOnDocument("preExpandAll",function(){p._isExpandingCounter++});this._bindEventOnDocument("documentPreExpandAll",function(){p._isExpandingCounter++});this._bindEventOnDocument("preExpandPrivate",function(){p._isExpandingCounter++});function n(){p._isExpandingCounter--;if(p._isExpandingCounter===0){p._requireRowsIndexing();p._getTrueRoot()._modelEvents.publish({event:"_expandOperationComplete"})}}this._bindEventOnDocument("postExpandAll",n);this._bindEventOnDocument("documentPostExpandAll",n);this._bindEventOnDocument("postExpandPrivate",n);this._bindEventOnDocument("postExpand",function(){p._requireRowsIndexing()});this._bindEventOnDocument("postCollapse",function(){p._requireRowsIndexing()});this._bindEventOnDocument("postCollapseAll",function(){p._requireRowsIndexing()});this._bindEventOnDocument("sortChildren",function(){p._requireRowsIndexing()});this._bindEventOnDocument("filter",function(){p._requireRowsIndexing()});this._bindEventOnDocument("prepareUpdate",function(){p._updateCnt++});this._bindEventOnDocument("pushUpdatePrivate",function(){if(p._updateCnt-1===0){if(p.__requireRowsIndexing===true){p._indexRowIndexes()}}});this._bindEventOnDocument("pushUpdate",function(r){p._updateCnt--;if(p._updateCnt<0){console.warn("A call has been made on pushUpdate without a previous call to prepareUpdate")}if(p._updateCnt===0){if(p.__requireRowsIndexing===true){p._indexRowIndexes()}var s=p._getTrueRoot();s._modelEvents.publish({event:"modelUpdate",context:p})}});function q(r){r.forEach(function(s){if(s.isSelectionChangeFromUI()){s.selectionChangeIsNotFromUI()}})}var m=function(r,s){p.prepareUpdate();r.forEach(function(t){t._isSelected=s;t._modelEvents.publish({event:s?"select":"unselect",data:t._getNodeInfos(),context:t});if(t.isSelectionChangeFromUI()){t.selectionChangeIsNotFromUI()}});p.pushUpdate()};this._bindEventOnXSO("onPostAdd",function l(r){m(r,true)});this._bindEventOnXSO("onPostRemove",function l(r){m(r,false)});this._bindEventOnXSO("onPreEmpty",function(r){p.prepareUpdate();r.forEach(function(s){s._isSelected=false})});this._bindEventOnXSO("onEmpty",function(r){p.pushUpdate()})},_requireRowsIndexing:function(){this.__requireRowsIndexing=true},_indexRowIndexes:function(){var l=-1;this._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(n){var m=n.nodeModel;if(!m.hasNoRepresentation()){l++;m._rowID=l}}});this.__requireRowsIndexing=false},getXSO:function(){return this._xso},getPXSO:function(){return this._pxso},_createTrueRoot:function(m){if(m===undefined){var l=this.options.nodeModelClass||e;this._trueRoot=new l({_isTrueRoot:true,label:"",useAsyncPreExpand:this.options.useAsyncPreExpand})}else{this._trueRoot=m;this._trueRoot.options.label="trueroot";this._trueRoot.options._isTrueRoot=true;this._trueRoot.options.useAsyncPreExpand=m.options.useAsyncPreExpand;this._trueRoot._rowID=-1}this._trueRoot._treeDocument=this;this.getModelEvents()._addParent(this._modelEvents);this._observeEvents()},_shouldAcceptDrop:function(l){return this.options.shouldAcceptDrop.call(l.target,l.target._getNodeInfos())},subscribe:function(l,m){return this.getModelEvents().subscribe(l,m)},unsubscribe:function(l){return this.getModelEvents().unsubscribe(l)},addEventListener:function(l,m){return this.getModelEvents().addEventListener(l,m)},removeEventListener:function(l){this.getModelEvents().unsubscribe(l)},addModelEventListener:function(l,m){return this.getModelEvents().addEventListener(l,m)},loadModel:function(l,m,n){if(m===undefined){m=this._trueRoot}this._trueRoot._treeDocument=this;return this._trueRoot._loadModel(l,m,n)},_getTrueRoot:function(){return this._trueRoot},_getRealTrueRoot:function(){return this._trueRoot},addRoot:function(l,m){return this._getTrueRoot().addChild(l,m)},addChild:function(m,l){return this._getTrueRoot().addChild(m,l)},insertBefore:function(m,l){return this._getTrueRoot().insertBefore(m,l)},removeRoot:function(l){return this._getTrueRoot().removeChild(l)},removeRoots:function(){var m=[];var l=this;this.withTransactionUpdate(function(){var o=l.getRoots();for(var n=o.length-1;n>=0;n--){m.unshift(o[n]);o[n].remove()}});return m},expandNLevels:function(l){var m=this._getTrueRoot().getChildren();if(m){this.prepareUpdate();k.optimizedForEach(m,function(o,n){o.expandNLevels(l)});this.pushUpdate()}},expandAll:function(){var p=this._getTrueRoot();var m=p.getChildren();if(m){p._modelEvents.publish({event:"documentPreExpandAll",data:p._getNodeInfos(),context:p});var l=0;this._onExpandOperationsComplete(function(){l--;if(l===0){p._modelEvents.publish({event:"_expandAllOperationComplete"})}});var n=0;var o=p._endOfSubExpand;p._endOfSubExpand=function(){o.call(p);if(this.__expandAllCounter===0){n++;p._modelEvents.publish({event:"documentPostExpandAll",data:p._getNodeInfos(),context:p})}};k.optimizedForEach(m,function(r,q){l++;r._privateExpand({expandAll:true,onExpandComplete:function(){}},undefined,p)})}},collapseAll:function(){var m=this._getTrueRoot();var l=this._getTrueRoot().getChildren();if(l){this.prepareUpdate();m._modelEvents.publish({event:"documentPreCollapseAll",data:m._getNodeInfos(),context:m});k.optimizedForEach(l,function(o,n){o.collapseAll()});m._modelEvents.publish({event:"documentPostCollapseAll",data:m._getNodeInfos(),context:m});this.pushUpdate()}},getAllDescendants:function(){var l=this._getTrueRoot();if(l){return l.getAllDescendants()}},_dump:function(l){return this._getTrueRoot()._dump(l)},dump:function(l){return this._dump(l)},getNthRoot:function(l){if(this._getTrueRoot().getChildren()){return this._getTrueRoot().getChildren()[l]}},getRoots:function(){return this.getChildren()},buildPath:function(l){return this._getTrueRoot().buildPath(l)},getChildren:function(){return this._getTrueRoot().getChildren()||[]},prepareUpdate:function(){return this._getRealTrueRoot().prepareUpdate()},pushUpdate:function(){return this._getRealTrueRoot().pushUpdate()},withTransactionUpdate:function(l){return this._getRealTrueRoot().withTransactionUpdate(l)},getSelectedNodes:function(){return this._xso.get()},processSelectedNodes:function(m){var l={processNode:function(n){},onComplete:function(){}};m=d.extend(l,m);this.prepareUpdate();c.forEach(this.getXSO().get(),function(n){if(m.processNode!==undefined){m.processNode.call(n,n._getNodeInfos())}},50,function(){m.onComplete()})},processDescendants:function(l){this._getTrueRoot().processDescendants(l)},selectAll:function(){this._getTrueRoot().selectAll()},unselectAll:function(){this.getXSO().empty()},isEveryNodeSelected:function(){return this.getXSO().get().length&&this._numberOfNodesInDocument===this.getXSO().get().length},isExpanding:function(){return this._isExpandingCounter>0},empty:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot()._modelEvents.publish({event:"empty"});var n=l.getRoots();for(var m=n.length-1;m>=0;m--){n[m].remove()}})},setUseChangeTransactionMode:function(l){this._useChangeTransactionMode=l},getUseChangeTransactionMode:function(){return this._useChangeTransactionMode},cancelChanges:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot().cancelChanges(true)})},acceptChanges:function(){var l=this;this.withTransactionUpdate(function(){l._getTrueRoot().acceptChanges(true)})},resetToReferenceValues:function(){var l=this;this.withTransactionUpdate(function(){l.processDescendants({treeTraversalOrder:"postOrder",processNode:function(n){var m=n.nodeModel;m.resetToReferenceValues()}})})},setValuesAsReference:function(){var l=this;this.withTransactionUpdate(function(){l.processDescendants({treeTraversalOrder:"postOrder",processNode:function(n){var m=n.nodeModel;m.setValuesAsReference()}})})},onNodeModelUpdate:function(l){return this.getModelEvents().subscribe({event:"nodeModelUpdate"},l)},onPreExpand:function(l){this.getModelEvents().unsubscribeAll({event:"preExpand"});return this.getModelEvents().subscribe({event:"preExpand"},l)},onUpdate:function(l){return this.getModelEvents().subscribe({event:"modelUpdate"},l)},_onExpandOperationsComplete:function(l){return this.getModelEvents().subscribe({event:"_expandOperationComplete"},l)},_onExpandAllOperationsComplete:function(l){return this.getModelEvents().subscribe({event:"_expandAllOperationComplete"},l)},onPreExpandAll:function(l){return this.getModelEvents().subscribe({event:"preExpandAll"},l)},onPostExpand:function(l){return this.getModelEvents().subscribe({event:"postExpand"},l)},onPreCollapse:function(l){return this.getModelEvents().subscribe({event:"preCollapse"},l)},onPostCollapse:function(l){return this.getModelEvents().subscribe({event:"postCollapse"},l)},search:function(l){return this._getTrueRoot().search(l)},groupRoots:function(l){this._getTrueRoot().groupChildren(l)},ungroupRoots:function(){this._getTrueRoot().ungroupChildren()},_createFilterManager:function(l){if(!this._filterManager){this._filterManager=new g({model:this,filterModel:l||{}});var m=this._getTrueRoot();this._filterManager.subscribe("filterModelChange",function(n){m._modelEvents.publish({event:"filter",data:m._getNodeInfos(),context:m})});m._modelEvents.publish({event:"filter",data:m._getNodeInfos(),context:m})}},setFilterModel:function(l){this.prepareUpdate();if(!this._filterManager){this._createFilterManager(l)}else{this._filterManager.filterModel=l}this.pushUpdate()},getFilterManager:function(){if(!this._filterManager){this._createFilterManager()}return this._filterManager},flattenTreeDocument:function(n){var o=[];var m=this;var p=false;var l=0;setTimeout(function(){var r=function(t,s){if(s===undefined){s=[]}if(t.isVisible()||t._isTrueRoot()){if(!t._isTrueRoot()){s.push(t)}if(t.hasChildren()){t.getChildren().forEach(function(u){r(u,s)})}}return s};var q=function(){if(l===0){if(p){o.length=0;r(m._getTrueRoot(),o);p=false}if(n&&n.onUpdate){n.onUpdate({flattenedTreeDocument:o})}}};p=true;q();m.addEventListener("prepareUpdate",function(){l++;q()});m.addEventListener("pushUpdate",function(){if(l>0){l--;q()}});["addChild","removeChild","hide","show","expand","collapse"].forEach(function(s){m.addEventListener(s,function(){p=true;q()})})});return o},getNodeFromStructurePath:function(l){var n=this._getTrueRoot();var m=l.split("/");m.pop();m.forEach(function(p,o){n=n.getChildren()[p]});return n}});return f});define("DS/TreeModel/TreeDocumentProxy",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModelProxy"],function(a,c){var b=a.extend({defaultOptions:{proxy:undefined,nodeModelClass:c,baseDocument:undefined},init:function(d){this._parent(d);if(d&&d.baseDocument){this._createTrueRoot(d.baseDocument._trueRoot)}},_getTrueRoot:function(){if(this.options.proxy!==undefined){var g=this.options.proxy;var e=g.options;var d=g.type;var f=b[d];if(f&&f._getTrueRoot){return f._getTrueRoot.call(this,e)}}return a.prototype._getTrueRoot.call(this)}});b.SUBSET={_getTrueRoot:function(d){return d.target}};return b});