/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/WebInfraUI/Notification",[],function(){var a={info:"info",fatal:"fatal",error:"error",warning:"warning",success:"success",assistance:"assistance"};return a});define("DS/WebInfraUI/ConfirmBox",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle"],function(e,c,a,b,d){return function(p){var f=new a({renderTo:p.container});var n=f.modalFactory({visible:false,closable:p.closable!==undefined?p.closable:false});n.setHeader({tag:"h4",text:p.caption});var k,h=function(i){if(i){if(k.isChecked()){p.checkBox.callback()}p.confirm.callback()}else{p.cancel.callback()}n.hide();f=n=k=null};var g=e.createElement("div");var l=e.createElement("div",{styles:{"float":"left"}});l.addClassName("fonticon fonticon-attention");var o=e.createElement("div",{styles:{"margin-left":"2em"}});if(Array.isArray(p.info)){for(var j=0;j<p.info.length;j++){o.appendChild(document.createTextNode(p.info[j])),o.appendChild(e.createElement("br"))}}else{o.appendChild(document.createTextNode(p.info))}if(p.checkBox){k=new d({type:"checkbox",label:p.checkBox.text,value:p.checkBox.text,checked:false});o.appendChild(k.elements.container)}g.appendChild(l);g.appendChild(o);n.elements.body.addContent(g);var m=[];m.push(new b({value:p.confirm.text,label:p.confirm.text,className:"primary"}));m[0].addEvent("onClick",function(){h(true)});m.push(new b({value:p.cancel.text,label:p.cancel.text}));m[1].addEvent("onClick",function(){h(false)});n.setFooter(m);n.dispatchEvent("onShowModal")};return function(g){if(g){if(!g.container){console.error("No Conatainer")}if(g.confirm&&g.confirm.callback){}else{console.error("3DPlay : ConfirmBox :> Assign a callback for Confirm Action.")}if(g.cancel&&g.cancel.callback){}else{console.error("3DPlay : ConfirmBox :> Assign a callback for Cancel Action.")}}var f=g.container;var k=function(){f.removeChild(j);j=null};var j=e.createElement("div",{styles:{"border-radius":"5px",top:0,left:0,position:"absolute",width:"100%",padding:"4px",border:"thin solid #727476","background-color":"white"}});e.createElement("img",{styles:{display:"inline","vertical-align":"middle","margin-left":"5px"},src:c.getWebappsBaseUrl()+"WebInfraUI/assets/icons/20/I_3DPlayWarning.png"}).inject(j);e.createElement("div",{styles:{"margin-left":"10px",display:"inline","vertical-align":"middle"},html:g.caption}).inject(j);var i=e.createElement("div",{"class":"moduleEdit__footer",styles:{"margin-left":"10px","vertical-align":"middle"}}).inject(j);var h={"margin-left":"10px",padding:" 2px 10px",border:" thin solid 727476","background-color":" transparent",display:" inline","vertical-align":"middle","border-radius":"3px",};e.createElement("button",{id:"ConfirmBox_Button_1",styles:{"margin-left":"10px"},"class":"btn-primary btn btn-root",html:g.confirm.text,events:{click:function(){k();g.confirm.callback()}}}).inject(i);bt=e.createElement("button",{id:"ConfirmBox_Button_2",styles:{"margin-left":"10px"},"class":"btn-default btn btn-root",html:g.cancel.text,events:{click:function(){k();g.cancel.callback()}}}).inject(i);j.inject(f)}});define("DS/WebInfraUI/MobileActionBar",["css!DS/WebInfraUI/MobileActionBar.css","UWA/Class","DS/VisuEvents/EventsManager","DS/CoreEvents/Events","DS/WebappsUtils/WebappsUtils","DS/WebSystem/Nls","DS/WebSystem/Rsc","DS/ApplicationFrame/CommandsManager"],function(e,c,a,f,g,h,b,d){return c.extend({init:function(H){this.state={visible:false,open:false,mode:"hidden",flyout:0,menuOpen:false,toolMenuOpen:false,alwaysOn:H.alwaysOn,pdf:H.pdf};var j=H.frameWnd.getUIFrame();var B=H.frameWnd.getViewerFrame();var i=H.actionBar;var L={panelManager:H.panelManager};var I=i.elements.container.parentElement;var x=H.ctx;var k=H.model;var N=null;var T=H.exp;this.backCB=null;this.backOldCB=null;var G=this;var z=document.createElement("div");z.className="PlayWeb-MAB-container font-3dsregular";if(H.ios){I.addClassName("iOS")}var D=document.createElement("div");D.className="PlayWeb-MAB-section-container";var Q=document.createElement("div");Q.className="PlayWeb-MAB-tool-menu";z.appendChild(Q);var F=document.createElement("div");F.className="PlayWeb-MAB-cmd-container";z.appendChild(F);var R=document.createElement("div");R.className="trigger-bckgd";F.appendChild(R);var A=document.createElement("div");A.className="PlayWeb-MAB-speed-dial";F.appendChild(A);var S=document.createElement("div");S.className="PlayWeb-center_container";A.appendChild(S);var m=document.createElement("div");m.className="PlayWeb-MAB-flyout";m.style.display="none";F.appendChild(m);var K=document.createElement("div");K.className="PlayWeb-center_container";m.appendChild(K);var l=document.createElement("div");l.className="PlayWeb-MAB-flyout";l.style.display="none";F.appendChild(l);var o=document.createElement("div");o.className="PlayWeb-center_container";l.appendChild(o);var v=document.createElement("div");v.className="PlayWeb-MAB-flyout-custom";v.style.display="none";F.appendChild(v);var t=document.createElement("div");t.className="PlayWeb-MAB-flyout-custom";t.style.display="none";F.appendChild(t);var n=document.createElement("div");n.className="PlayWeb-MAB-trigger fonticon fonticon-plus ";var J=document.createElement("div");J.className="PlayWeb-MAB-burger fonticon fonticon-menu-dot";var q=[];var P=[];var u=function(ac,ab,ae,W,V,aa,Z){var X=document.createElement("div");X.className=W;if(ae.title){X.appendChild(document.createTextNode(ae.title))}else{if(ae.nls){h.nls(ae.nls,ae.id,function(af){var ag=(af&&af.Title)?af.Title:"Title not found";X.appendChild(document.createTextNode(ag))})}}if(ae.rsc){var ad=ae.iconSize||"Normal";b.rsc(ae.rsc,{iconName:ae.id,iconSize:ad},function(af){X.style.backgroundImage="url("+af+")"})}else{X.style.backgroundImage="url("+g.getWebappsBaseUrl()+ae.icon+")"}var Y;if(ae.flyout){Y=function(){D.className="PlayWeb-MAB-section-container";G.showFlyout(aa,ae.flyout)}}else{Y=function(){if(ae.hideAB){G.toggleMainView()}else{D.className="PlayWeb-MAB-section-container";G.state.menuOpen=false}if(ae.isAction===true){if(ae.keepFlyout!==true){G.showFlyout(0)}if(ae.tool&&ae.func){L[ae.tool][ae.func]()}else{ae.cb()}}else{d.getCommands(x)[ae.id].begin();if(ae.showBack){n.className="PlayWeb-MAB-trigger fonticon fonticon-reply";G.backCB=function(){var af=d.getCommand(d.getCurrentCmdId(x),x);if(af&&af.cancel){af.cancel()}if(G.state.open===false){G.toggleMainView()}else{if(G.state.flyout>0){G.showFlyout(0)}}}}}}}a.addEvent(X,"onTap",Y);a.addEvent(X,"onLeftMouseDown",Y);ab.appendChild(X);ac.push({container:X,event:V,cb:Y,isScenario:Z})};var r=function(V){if(V.container.parentElement){V.container.parentElement.removeChild(V.container)}a.removeEvent("onTap",V.cb);a.removeEvent("onLeftMouseDown",V.cb)};var s=function(X,W){if(X.monoCmd){n.className="PlayWeb-MAB-trigger cmd";var V=X.monoCmd.iconSize||"Normal";b.rsc(X.monoCmd.rsc,{iconName:X.monoCmd.id,iconSize:V},function(Y){n.style.backgroundImage="url("+Y+")"});q.triggerClick=function(){d.getCommands(x)[X.monoCmd.id].begin()}}else{a.removeEvent(n,"onTap",q.triggerClick);a.removeEvent(n,"onLeftMouseDown",q.triggerClick);q.triggerClick=function(){if(G.backCB){G.backCB();G.backCB=null}else{if(G.state.flyout!==0){if(G.state.flyout-1===0){var Y=d.getCommand(d.getCurrentCmdId(x),x);if(Y&&Y.cancel){Y.cancel()}}if(G.state.flyout!==0){G.showFlyout(G.state.flyout-1)}}else{G.toggleMainView()}}};if(X&&X.sections){J.style.display="";X.sections.forEach(function(Y){u(q,D,Y,"PlayWeb-MAB-cmd","onLeftClick",1,W)})}else{J.style.display="none"}if(X&&X.speeddial){S.style.setProperty("--nbCmdMab",X.speeddial.length+1);X.speeddial.forEach(function(Y){u(q,S,Y,"PlayWeb-MAB-cmd","onLeftClick",1)})}}a.addEvent(n,"onTap",q.triggerClick);a.addEvent(n,"onLeftMouseDown",q.triggerClick);S.appendChild(J)};s(k);q.burgerClick=function(){if(G.state.menuOpen===true){D.className="PlayWeb-MAB-section-container";G.state.menuOpen=false}else{for(var V=0;V<D.children.length;V++){if(k&&k.sections&&k.sections[V]&&!k.sections[V].flyout){if(d.getCommands(x)[k.sections[V].id]&&d.getCommands(x)[k.sections[V].id].isEnabled()){D.children[V].setAttribute("class","PlayWeb-MAB-cmd")}else{D.children[V].setAttribute("class","PlayWeb-MAB-cmd disabled")}}}if(D.scrollTo){D.scrollTo(0,0)}D.className="PlayWeb-MAB-section-container active";G.state.menuOpen=true}};a.addEvent(J,"onTap",q.burgerClick);a.addEvent(J,"onLeftMouseDown",q.burgerClick);if(!k.sections){J.style.display="none"}q.documentClick=function(Y){if(G&&G.state.menuOpen&&Y&&Y.from&&Y.from[0]&&Y.from[0].event&&Y.from[0].event.path){var W=true;var X=Y.from[0].event.path;for(var V=0;V<X.length;V++){if(X[V]&&(X[V]===D||X[V]===J)){W=false;break}}if(W){D.className="PlayWeb-MAB-section-container";G.state.menuOpen=false}}};a.addEvent(window.document,"onTap",q.documentClick);a.addEvent(window.document,"onLeftMouseDown",q.documentClick);q.onPinch=function(V){var X=V.gesture.getEvents();for(var W=0;W<X.length;W++){X[W].event.preventDefault()}};q.onSwipe=function(V){if(V&&V.gesture){if(V.from&&Array.isArray(V.from)&&V.from[0]&&V.from[0].view){if(V.from[0].view.parentNode===D||V.from[0].view.parentNode===m||V.from[0].view.parentNode===l){}else{if(V.from[0].view!==D&&V.from[0].view!==m&&V.from[0].view!==l){var X=V.gesture.getEvents();for(var W=0;W<X.length;W++){if(X[W]&&X[W].event&&typeof(X[W].event.preventDefault)==="function"){X[W].event.preventDefault()}}}}}}};a.addEvent(I,"onPinch",q.onPinch);a.addEvent(n,"onSwipe",q.onSwipe);I.appendChild(D);I.appendChild(z);I.appendChild(n);this.toggleMainView=function(){if(G.state.open===false){F.style.transform="translate(0em,0em)";n.className="PlayWeb-MAB-trigger fonticon fonticon-plus active";G.state.open=true}else{G.showFlyout(0);F.style.transform="";n.className="PlayWeb-MAB-trigger fonticon fonticon-plus";G.state.open=false}};var p={};this.onVisibilityChangeSubscribe=function(V,W){p[V]=W;p[V](G.state.mode)};this.onVisibilityChangeUnsubscribe=function(V){delete p[V]};var w=function(V){this.state.mode=V;for(var W in p){p[W](V)}}.bind(this);this.hide=function(){D.className="PlayWeb-MAB-section-container";G.state.menuOpen=false;I.removeClassName("PlayWebMobile");I.removeClassName("PlayWebMobileForced");j.removeClassName("PlayWebMobile");I.removeClassName("PlayWebStamp");j.removeClassName("PlayWebStamp");w("hidden");G.state.visible=false;if(T&&T.showRefAxis){T.showRefAxis()}f.publish({event:"3DPLAY/MOBILEACTIONBAR/ENABLE",data:{}})};this.show=function(){j.addClassName("PlayWebMobile");I.addClassName("PlayWebMobile");I.removeClassName("PlayWebMobileForced");I.removeClassName("PlayWebStamp");j.removeClassName("PlayWebStamp");w("mobile");if(G.state.visible!==true&&T&&T.hideRefAxis){T.hideRefAxis()}G.state.visible=true;f.publish({event:"3DPLAY/MOBILEACTIONBAR/DISABLE",data:{}})};this.showNone=function(){j.addClassName("PlayWebStamp");I.addClassName("PlayWebStamp");I.removeClassName("PlayWebMobileForced");I.removeClassName("PlayWebMobile");j.removeClassName("PlayWebMobile");w("stamp");if(G.state.visible!==true&&T&&T.hideRefAxis){T.hideRefAxis()}G.state.visible=true};this.showFlyout=function(V,X,W){if(true!==G.state.pdf){D.className="PlayWeb-MAB-section-container";G.state.menuOpen=false;G.hideToolMenu();if(this.state.open===false){this.toggleMainView()}if(V===0){G.backCB=null;G.backOldCB=null;n.className="PlayWeb-MAB-trigger fonticon fonticon-plus active";m.style.transform="";l.style.transform="";A.style.transform="";m.style.display="none";l.style.display="none";if(z.offsetWidth-124<=S.children.length*42){F.classList.add("PlayWeb-MAB-overflow")}else{F.classList.remove("PlayWeb-MAB-overflow")}A.style.display="";v.style.display="none";t.style.display="none";while(P.length>0){r(P.pop())}}else{if(V===1){G.backCB=(X&&X.backCB)?X.backCB:G.backOldCB;G.backOldCB=null;A.style.transform="translate(0em,4em)";if(X){if(z.offsetWidth-124<=X.length*42){F.classList.add("PlayWeb-MAB-overflow")}else{F.classList.remove("PlayWeb-MAB-overflow")}K.innerHTML="";K.style.setProperty("--nbCmdMab",X.length);X.forEach(function(Y){if(Y.uxElt){K.appendChild(Y.uxElt)}else{u(P,K,Y,"PlayWeb-MAB-cmd","onLeftClick",2)}})}if(W){v.style.display="";m.style.transform="";m.style.display="none"}else{m.style.transform="translate(0em,0em)";m.style.display="";v.style.display="none"}t.style.display="none";l.style.transform="";l.style.display="none";n.className="PlayWeb-MAB-trigger fonticon fonticon-reply";A.style.display="none"}else{if(V===2){G.backOldCB=G.backCB;G.backCB=(X&&X.backCB)?X.backCB:null;while(P.length>3){r(P.pop())}if(X){o.innerHTML="";if(z.offsetWidth-124<=X.length*42){F.classList.add("PlayWeb-MAB-overflow")}else{F.classList.remove("PlayWeb-MAB-overflow")}o.style.setProperty("--nbCmdMab",X.length);X.forEach(function(Y){if(Y.uxElt){o.appendChild(Y.uxElt)}else{u(P,o,Y,"PlayWeb-MAB-cmd","onLeftClick",3)}})}m.style.transform="";l.style.transform="translate(0em,0em)";l.style.display="";A.style.display="none";m.style.display="none"}}}G.state.flyout=V;G.state.flyoutcustom=W}};this.showCustomFlyout=function(V,W){if(V===1){v.innerHTML="";v.appendChild(W)}else{t.innerHTML="";t.appendChild(W)}this.showFlyout(V,null,true)};this.showToolMenu=function(W){G.state.toolMenuOpen=true;W=W||[];Q.innerHTML="";for(var V=0;V<W.length;V++){Q.appendChild(W[V].btnMAB)}Q.style.transform="translate(0em,0em)"};this.hideToolMenu=function(){G.state.toolMenuOpen=false;Q.innerHTML="";Q.style.transform=""};var y=function(){if((!G.state.alwaysOn||!G.state.pdf)&&i&&I&&B){if(G.state.flyoutcustom!==true){var V=S;if(G.state.flyout===1){V=K}else{if(G.state.flyout>=2){V=o}}if(z.offsetWidth-124<=V.children.length*42){F.classList.add("PlayWeb-MAB-overflow")}else{F.classList.remove("PlayWeb-MAB-overflow")}}if(B.offsetHeight<=270){D.style.maxHeight="calc("+B.offsetHeight+"px - 52px)"}else{D.style.maxHeight=""}if(B.offsetWidth<=240||B.offsetHeight<=240){G.showNone()}else{if(B.offsetWidth<=480||B.offsetHeight<=290){G.show()}else{if(!G.state.alwaysOn){G.hide()}else{G.show();I.addClassName("PlayWebMobileForced")}}}}};y();if(i){if(I){B.addEvent("resize",y)}}var C=function(aa){var Y=[];Y.backCB=aa.backCB;for(var Z=0;Z<aa["@children"].length;Z++){var ac=aa["@children"][Z];for(var X=0;X<ac["@children"].length;X++){var W=ac["@children"][X];if(W["@tag"]==="CATCmdStarter"&&W["@viewMAB"]){if(W["@viewMAB"].elements.container){Y.push({uxElt:W["@viewMAB"].elements.container})}else{Y.push({uxElt:W["@viewMAB"]})}}else{if(W["@tag"]==="CATCmdContainer"){for(var V=0;V<W["@children"].length;V++){var ab=W["@children"][V];if(ab["@viewMAB"]){if(ab["@viewMAB"].elements.container){Y.push({uxElt:ab["@viewMAB"].elements.container})}else{Y.push({uxElt:ab["@viewMAB"]})}}}}}}}G.showFlyout(1,Y)};var U=function(){G.showFlyout(0)};var E=f.subscribe({event:"/"+x+"/WUX/ContextualBar/Show/"},C);var O=f.subscribe({event:"/"+x+"/WUX/ContextualBar/Hide/"},U);var M=function(){n.className="PlayWeb-MAB-trigger fonticon fonticon-plus ";n.style.backgroundImage="";a.removeEvent(n,"onTap",q.triggerClick);a.removeEvent(n,"onLeftMouseDown",q.triggerClick);if(this.state.open===true){G.toggleMainView()}while(q.length>0){r(q.pop())}while(P.length>0){r(P.pop())}}.bind(this);this.update=function(V){M();s(V)};this.resetScenario=function(){if(G.state.open===false){G.toggleMainView()}else{if(G.state.flyout>0){G.showFlyout(0)}}if(N){if(N.isMerged===false){M();s(k)}else{var V=0;while(V<q.length){if(q[V].isScenario){r(q[V]);q.splice(V,1)}else{V++}}}}};this.loadScenarioWb=function(W,V){if(V!==true){M()}else{if(N){G.resetScenario()}}N=W;N.isMerged=V===true;s(N,true)};this.dispose=function(){I.removeClassName("PlayWebMobile");j.removeClassName("PlayWebMobile");I.removeClassName("PlayWebStamp");j.removeClassName("PlayWebStamp");while(q.length>0){r(q.pop())}while(P.length>0){r(P.pop())}a.removeEvent("onTap",q.triggerClick);a.removeEvent("onLeftMouseDown",q.triggerClick);a.removeEvent("onTap",q.burgerClick);a.removeEvent("onLeftMouseDown",q.burgerClick);a.removeEvent("onTap",q.documentClick);a.removeEvent("onLeftMouseDown",q.documentClick);B.removeEvent("resize",y);a.removeEvent("onPinch",q.onPinch);a.removeEvent("onSwipe",q.onSwipe);f.unsubscribe(E);f.unsubscribe(O);try{I.removeChild(D);I.removeChild(z);I.removeChild(n);D=null;z=null;n=null}catch(V){console.error("Unable to remove MAB from DOM")}this.backCB=null;this.backOldCB=null;I=null;i.MAB=null;i=null;x=null;k=null;N=null;T=null;G=null};if(this.state.alwaysOn){this.show()}}})});define("DS/WebInfraUI/Progress",["css!DS/WebInfraUI/Progress.css","UWA/Core","UWA/Class"],function(b,c,a){return a.extend({init:function(){this.state={visible:false,indeterminate:true,disposed:false,value:-1};this.spinnerContainer=new c.Element("div",{"class":"PlayWeb-Progress-Container"});this.progressBar=new c.Element("div",{"class":"PlayWeb-Progress"}).inject(this.spinnerContainer);new c.Element("span",{}).inject(this.progressBar)},dispose:function(){this.state.disposed=true;try{this.spinnerContainer.getParent().removeChild(this.spinnerContainer)}catch(d){}this.spinnerContainer=null;this.progressBar=null},getContent:function(){return this.spinnerContainer},hide:function(){if(this.state.disposed===false){this.state.visible=false;this.spinnerContainer.style.transition="height 1s linear 0.5s";this.spinnerContainer.style.height=0;var d=this;this.hidingTimoutID=setTimeout(function(){if(d.spinnerContainer){d.spinnerContainer.style.transition="";d.spinnerContainer.style.display="none";d.spinnerContainer.style.height=""}d.hidingTimoutID=null;d=null},2000)}},visible:function(){if(this.state.disposed===false){if(this.hidingTimoutID){clearTimeout(this.hidingTimoutID)}this.spinnerContainer.style.transition="";this.spinnerContainer.style.height="";if(this.state.value!==undefined){this.progressBar.style.transitionDuration="0s";this.updateProgression(this.state.value);this.progressBar.style.transitionDuration=""}this.state.visible=true;this.spinnerContainer.style.display="block"}},updateProgression:function(d){if(this.state.disposed===false){this.state.value=d;if(this.state.value===-1){this.state.indeterminate=true;this.spinnerContainer.addClassName("indeterminate")}else{if(this.state.indeterminate){this.state.indeterminate=false;this.spinnerContainer.removeClassName("indeterminate")}this.progressBar.style.width=Math.max(this.state.value,1)+"%"}}},getProgressBarState:function(){return this.state.visible}})});define("DS/WebInfraUI/DOMGraph",["UWA/Class"],function(d){function c(f){var g=document.createElement("span");g.style.cssText="width:1px;height:30px;float:left;background-color:#"+f;return g}function e(k,i,g,j,f,l){j=j||l;f=f||30;var h=document.createElement("div");h.id=k;h.style.cssText="position:relative;height:"+f+"px;background-color:#"+i+" ;width:"+j+"px";while(h.children.length<l){h.appendChild(c(g))}return h}function a(h,g,f){var i=document.createElement("div");i.id=h;i.style.cssText="font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:#"+g+";background-color:#"+f;return i}var b="131";return d.extend({init:function(g){this.maxValue=0;this.max=100;this.name=g.name;this.caption=g.caption!==undefined?g.caption:true;this.updateSize=g.updateSize;this.updateLegend=g.updateLegend||"";var h=g.length?g.length:100;var f=g.color?g.color:"200";this.container=document.createElement("div");this.container.id=this.name||"none";this.container.style.cssText="z-index:1234;width:"+h+"px;top:0px;left:10px;opacity:0.6;position:relative;";if(this.caption){this.tittle=a("Tittle",f,b);this.container.appendChild(this.tittle)}this.dom=e("Graph",f,b,undefined,undefined,h);this.container.appendChild(this.dom);if(g.container){g.container.appendChild(this.container)}},refresh:function(k){var l=this.max;this.max=k;var n=[];for(var h=0,g=this.dom.children.length;h<g;h++){var f=this.dom.children[h].clientHeight;var m=30-f;n.push(Math.floor(m*l/30))}for(var h=0,g=n.length;h<g;h++){this.update(n[h])}},getContainer:function(){return this.container},dispose:function(){this.container.parentNode.removeChild(this.container);this.container=null;this.dom=null;this.tittle=null},update:function(g){if(this.minValue===undefined){this.minValue=g}if(this.updateSize&&!this.isrefreshing&&this.maxValue<g){this.isrefreshing=true;this.refresh(g);this.maxValue=g;this.isrefreshing=false}if(this.dom.firstChild){var f=Math.min(30,30-(g/this.max)*30);var h=this.dom.appendChild(this.dom.firstChild);h.style.height=f+"px";if(this.caption){if(typeof this.caption==="function"){this.tittle.textContent=this.caption()}else{this.tittle.textContent=this.name+" "+g+" "+this.updateLegend+" ("+this.minValue+" - "+this.maxValue+")"}}}},})});
/*! Copyright 2014 Dassault Syst�mes */
define("DS/WebInfraUI/Touch",["DS/UIKIT/Touch","DS/WebSystem/Environment"],function(c,a){if(a.isSet("3DPlay.Hammer.1010")){var b;!function(P,O){function N(){M.READY||(x.determineEventTypes(),B.each(M.gestures,function(d){v.register(d)}),x.onTouch(M.DOCUMENT,D,v.detect),x.onTouch(M.DOCUMENT,C,v.detect),M.READY=!0)}var M=function(e,d){return new M.Instance(e,d||{})};M.VERSION="1.0.10",M.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},M.HAS_POINTEREVENTS=P.navigator.pointerEnabled||P.navigator.msPointerEnabled,M.HAS_TOUCHEVENTS="ontouchstart" in P,M.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,M.NO_MOUSEEVENTS=M.HAS_TOUCHEVENTS&&P.navigator.userAgent.match(M.MOBILE_REGEX),M.EVENT_TYPES={},M.UPDATE_VELOCITY_INTERVAL=16,M.DOCUMENT=P.document;var L=M.DIRECTION_DOWN="down",K=M.DIRECTION_LEFT="left",J=M.DIRECTION_UP="up",I=M.DIRECTION_RIGHT="right",H=M.POINTER_MOUSE="mouse",G=M.POINTER_TOUCH="touch",F=M.POINTER_PEN="pen",E=M.EVENT_START="start",D=M.EVENT_MOVE="move",C=M.EVENT_END="end";M.plugins=M.plugins||{},M.gestures=M.gestures||{},M.READY=!1;var B=M.utils={extend:function(f,i,h){for(var g in i){f[g]!==O&&h||(f[g]=i[g])}return f},each:function(g,k,j){var i,h;if("forEach" in g){g.forEach(k,j)}else{if(g.length!==O){for(i=-1;h=g[++i];){if(k.call(j,h,i,g)===!1){return}}}else{for(i in g){if(g.hasOwnProperty(i)&&k.call(j,g[i],i,g)===!1){return}}}}},inStr:function(e,d){return e.indexOf(d)>-1},hasParent:function(e,d){for(;e;){if(e==d){return !0}e=e.parentNode}return !1},getCenter:function(i){var h=[],n=[],m=[],l=[],k=Math.min,j=Math.max;return 1===i.length?{pageX:i[0].pageX,pageY:i[0].pageY,clientX:i[0].clientX,clientY:i[0].clientY}:(B.each(i,function(d){h.push(d.pageX),n.push(d.pageY),m.push(d.clientX),l.push(d.clientY)}),{pageX:(k.apply(Math,h)+j.apply(Math,h))/2,pageY:(k.apply(Math,n)+j.apply(Math,n))/2,clientX:(k.apply(Math,m)+j.apply(Math,m))/2,clientY:(k.apply(Math,l)+j.apply(Math,l))/2})},getVelocity:function(e,d,f){return{x:Math.abs(d/e)||0,y:Math.abs(f/e)||0}},getAngle:function(f,e){var h=e.clientX-f.clientX,g=e.clientY-f.clientY;return 180*Math.atan2(g,h)/Math.PI},getDirection:function(f,e){var h=Math.abs(f.clientX-e.clientX),g=Math.abs(f.clientY-e.clientY);return h>=g?f.clientX-e.clientX>0?K:I:f.clientY-e.clientY>0?J:L},getDistance:function(f,e){var h=e.clientX-f.clientX,g=e.clientY-f.clientY;return Math.sqrt(h*h+g*g)},getScale:function(e,d){return e.length>=2&&d.length>=2?this.getDistance(d[0],d[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,d){return e.length>=2&&d.length>=2?this.getAngle(d[1],d[0])-this.getAngle(e[1],e[0]):0},isVertical:function(d){return d==J||d==L},toggleDefaultBehavior:function(f,e,h){if(e&&f&&f.style){B.each(["webkit","moz","Moz","ms","o",""],function(i){B.each(e,function(d,j){i&&(j=i+j.substring(0,1).toUpperCase()+j.substring(1)),j in f.style&&(f.style[j]=!h&&d)})});var g=function(){return !1};"none"==e.userSelect&&(f.onselectstart=!h&&g),"none"==e.userDrag&&(f.ondragstart=!h&&g)}}};M.Instance=function(f,d){var g=this;return N(),this.element=f,this.enabled=!0,this.options=B.extend(B.extend({},M.defaults),d||{}),this.options.stop_browser_behavior&&B.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=x.onTouch(f,E,function(e){g.enabled&&v.startDetect(g,e)}),this.eventHandlers=[],this},M.Instance.prototype={on:function(e,d){var f=e.split(" ");return B.each(f,function(g){this.element.addEventListener(g,d,!1),this.eventHandlers.push({gesture:g,handler:d})},this),this},off:function(g,f){var j,i,h=g.split(" ");return B.each(h,function(d){for(this.element.removeEventListener(d,f,!1),j=-1;i=this.eventHandlers[++j];){i.gesture===d&&i.handler===f&&this.eventHandlers.splice(j,1)}},this),this},trigger:function(f,d){d||(d={});var h=M.DOCUMENT.createEvent("Event");h.initEvent(f,!0,!0),h.gesture=d;var g=this.element;return B.hasParent(d.target,g)&&(g=d.target),g.dispatchEvent(h),this},enable:function(d){return this.enabled=d,this},dispose:function(){var e,d;for(this.options.stop_browser_behavior&&B.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),e=-1;d=this.eventHandlers[++e];){this.element.removeEventListener(d.gesture,d.handler,!1)}return this.eventHandlers=[],x.unbindDom(this.element,M.EVENT_TYPES[E],this.eventStartHandler),null}};var A=null,z=!1,y=!1,x=M.event={bindDom:function(f,e,h){var g=e.split(" ");B.each(g,function(d){f.addEventListener(d,h,!1)})},unbindDom:function(f,e,h){var g=e.split(" ");B.each(g,function(d){f.removeEventListener(d,h,!1)})},onTouch:function(g,d,j){var i=this,h=function(l){var k=l.type.toLowerCase();if(!B.inStr(k,"mouse")||!y){B.inStr(k,"touch")||B.inStr(k,"pointerdown")||B.inStr(k,"mouse")&&1===l.which?z=!0:B.inStr(k,"mouse")&&!l.which&&(z=!1),(B.inStr(k,"touch")||B.inStr(k,"pointer"))&&(y=!0);var e=0;z&&(M.HAS_POINTEREVENTS&&d!=C?e=w.updatePointer(d,l):B.inStr(k,"touch")?e=l.touches.length:y||(e=B.inStr(k,"up")?0:1),e>0&&d==C?d=D:e||(d=C),(e||null===A)&&(A=l),j.call(v,i.collectEventData(g,d,i.getTouchList(A,d),l)),M.HAS_POINTEREVENTS&&d==C&&(e=w.updatePointer(d,l))),e||(A=null,z=!1,y=!1,w.reset())}};return this.bindDom(g,M.EVENT_TYPES[d],h),h},determineEventTypes:function(){var d;d=M.HAS_POINTEREVENTS?w.getEvents():M.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],M.EVENT_TYPES[E]=d[0],M.EVENT_TYPES[D]=d[1],M.EVENT_TYPES[C]=d[2]},getTouchList:function(d){return M.HAS_POINTEREVENTS?w.getTouchList():d.touches?d.touches:(d.identifier=1,[d])},collectEventData:function(g,f,j,i){var h=G;return(B.inStr(i.type,"mouse")||w.matchType(H,i))&&(h=H),{center:B.getCenter(j),timeStamp:Date.now(),target:i.target,touches:j,eventType:f,pointerType:h,srcEvent:i,preventDefault:function(){var d=this.srcEvent;d.preventManipulation&&d.preventManipulation(),d.preventDefault&&d.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return v.stopDetect()}}}},w=M.PointerEvent={pointers:{},getTouchList:function(){var d=[];return B.each(this.pointers,function(e){d.push(e)}),d},updatePointer:function(e,d){return e==C?delete this.pointers[d.pointerId]:(d.identifier=d.pointerId,this.pointers[d.pointerId]=d),Object.keys(this.pointers).length},matchType:function(f,e){if(!e.pointerType){return !1}var h=e.pointerType,g={};return g[H]=h===H,g[G]=h===G,g[F]=h===F,g[f]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},v=M.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,d){this.current||(this.stopped=!1,this.current={inst:e,startEvent:B.extend({},d),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(d))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var d=this.current.inst,f=d.options;return B.each(this.gestures,function(g){return this.stopped||f[g.name]===!1||d.enabled===!1||g.handler.call(g,e,d)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=e),e.eventType==C&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=B.extend({},this.current),this.current=null,this.stopped=!0},getVelocityData:function(i,d,n,m){var l=this.current,k=l.lastVelocityEvent,j=l.velocity;k&&i.timeStamp-k.timeStamp>M.UPDATE_VELOCITY_INTERVAL?(j=B.getVelocity(i.timeStamp-k.timeStamp,i.center.clientX-k.center.clientX,i.center.clientY-k.center.clientY),l.lastVelocityEvent=i):l.velocity||(j=B.getVelocity(d,n,m),l.lastVelocityEvent=i),l.velocity=j,i.velocityX=j.x,i.velocityY=j.y},getInterimData:function(f){var e,h,g=this.current.lastEvent;f.eventType==C?(e=g&&g.interimAngle,h=g&&g.interimDirection):(e=g&&B.getAngle(g.center,f.center),h=g&&B.getDirection(g.center,f.center)),f.interimAngle=e,f.interimDirection=h},extendEventData:function(h){var g=this.current,l=g.startEvent;(h.touches.length!=l.touches.length||h.touches===l.touches)&&(l.touches=[],B.each(h.touches,function(d){l.touches.push(B.extend({},d))}));var k=h.timeStamp-l.timeStamp,j=h.center.clientX-l.center.clientX,i=h.center.clientY-l.center.clientY;return this.getVelocityData(h,k,j,i),this.getInterimData(h),B.extend(h,{startEvent:l,deltaTime:k,deltaX:j,deltaY:i,distance:B.getDistance(l.center,h.center),angle:B.getAngle(l.center,h.center),direction:B.getDirection(l.center,h.center),scale:B.getScale(l.touches,h.touches),rotation:B.getRotation(l.touches,h.touches)}),h},register:function(d){var e=d.defaults||{};return e[d.name]===O&&(e[d.name]=!0),B.extend(M.defaults,e,!0),d.index=d.index||1000,this.gestures.push(d),this.gestures.sort(function(g,f){return g.index<f.index?-1:g.index>f.index?1:0}),this.gestures}};M.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(f,e){var n=v.current;if(n.name!=this.name&&this.triggered){return e.trigger(this.name+"end",f),void (this.triggered=!1)}if(!(e.options.drag_max_touches>0&&f.touches.length>e.options.drag_max_touches)){switch(f.eventType){case E:this.triggered=!1;break;case D:if(f.distance<e.options.drag_min_distance&&n.name!=this.name){return}var m=n.startEvent.center;if(n.name!=this.name&&(n.name=this.name,e.options.correct_for_drag_min_distance&&f.distance>0)){var l=Math.abs(e.options.drag_min_distance/f.distance);m.pageX+=f.deltaX*l,m.pageY+=f.deltaY*l,m.clientX+=f.deltaX*l,m.clientY+=f.deltaY*l,f=v.extendEventData(f)}(n.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=f.distance)&&(f.drag_locked_to_axis=!0);var h=n.lastEvent.direction;f.drag_locked_to_axis&&h!==f.direction&&(f.direction=B.isVertical(h)?f.deltaY<0?J:L:f.deltaX<0?K:I),this.triggered||(e.trigger(this.name+"start",f),this.triggered=!0),e.trigger(this.name,f),e.trigger(this.name+f.direction,f);var g=B.isVertical(f.direction);(e.options.drag_block_vertical&&g||e.options.drag_block_horizontal&&!g)&&f.preventDefault();break;case C:this.triggered&&e.trigger(this.name+"end",f),this.triggered=!1}}}},M.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:2},timer:null,handler:function(e,d){switch(e.eventType){case E:clearTimeout(this.timer),v.current.name=this.name,this.timer=setTimeout(function(){"hold"==v.current.name&&d.trigger("hold",e)},d.options.hold_timeout);break;case D:e.distance>d.options.hold_threshold&&clearTimeout(this.timer);break;case C:clearTimeout(this.timer)}}},M.gestures.Release={name:"release",index:1/0,handler:function(e,d){e.eventType==C&&d.trigger(this.name,e)}},M.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:0.7},handler:function(e,d){if(e.eventType==C){if(e.touches.length<d.options.swipe_min_touches||e.touches.length>d.options.swipe_max_touches){return}(e.velocityX>d.options.swipe_velocity||e.velocityY>d.options.swipe_velocity)&&(d.trigger(this.name,e),d.trigger(this.name+e.direction,e))}}},M.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(g,f){var j,i,h;g.eventType==E?this.has_moved=!1:g.eventType!=D||this.moved?g.eventType==C&&"touchcancel"!=g.srcEvent.type&&g.deltaTime<f.options.tap_max_touchtime&&!this.has_moved&&(j=v.previous,i=j&&j.lastEvent&&g.timeStamp-j.lastEvent.timeStamp,h=!1,j&&"tap"==j.name&&i&&i<f.options.doubletap_interval&&g.distance<f.options.doubletap_distance&&(f.trigger("doubletap",g),h=!0),(!h||f.options.tap_always)&&(v.current.name="tap",f.trigger(v.current.name,g))):this.has_moved=g.distance>f.options.tap_max_distance}},M.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,d){return d.options.prevent_mouseevents&&e.pointerType==H?void e.stopDetect():(d.options.prevent_default&&e.preventDefault(),void (e.eventType==E&&d.trigger(this.name,e)))}},M.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(g,f){if(v.current.name!=this.name&&this.triggered){return f.trigger(this.name+"end",g),void (this.triggered=!1)}if(!(g.touches.length<2)){if(f.options.transform_always_block&&g.preventDefault(),f.options.transform_within_instance){for(var j=-1;g.touches[++j];){if(!B.hasParent(g.touches[j].target,f.element)){return}}}switch(g.eventType){case E:this.triggered=!1;break;case D:var i=Math.abs(1-g.scale),h=Math.abs(g.rotation);if(i<f.options.transform_min_scale&&h<f.options.transform_min_rotation){return}v.current.name=this.name,this.triggered||(f.trigger(this.name+"start",g),this.triggered=!0),f.trigger(this.name,g),h>f.options.transform_min_rotation&&f.trigger("rotate",g),i>f.options.transform_min_scale&&(f.trigger("pinch",g),f.trigger("pinch"+(g.scale<1?"in":"out"),g));break;case C:this.triggered&&f.trigger(this.name+"end",g),this.triggered=!1}}}},b=M}(window);b.defaults.stop_browser_behavior.touchAction="pan-y";return b}else{return c}});define("DS/WebInfraUI/NotificationScreen",["DS/WebappsUtils/WebappsUtils","UWA/Core","UWA/Controls/Abstract","DS/WebInfraUI/Notification"],function(a,d,c,b){return c.extend({defaultOptions:{},init:function(e){this._parent(e);this._buildView(e)},_buildView:function(e){this.posRight=0;this.notifScreen=new d.Element("ul",{});var f="position:absolute;";f+="z-index:10;";f+="right:"+this.posRight+";";f+=(e.marginTop)?"top:"+e.marginTop+";":"top:0;";f+="margin:1em 1em 0;";f+="padding:0;";f+="overflow: hidden;";f+="max-width: 205px;";this.notifScreen.setAttribute("style",f);this.notifScreen.setAttribute("class","PlayWeb-notif-screen");this.elements.container=this.notifScreen},clearAll:function(){while(this.notifScreen.childNodes.length>0){this.notifScreen.removeChild(this.notifScreen.firstChild)}},addNew:function(h){var g=document.createDocumentFragment();var e=document.createElement("div");e.addEventListener("contextmenu",function(l){l.preventDefault()},false);var i=document.createElement("span");i.setAttribute("class","icon fonticon");e.appendChild(i);var k=document.createElement("button");k.setAttribute("class","close");k.setAttribute("type","button");k.appendChild(document.createTextNode("x"));e.appendChild(k);var j=(h.eventID==="info"||h.eventID==="assistance")?"primary":h.eventID;e.setAttribute("class","alert-message alert-"+j+" alert-has-icon alert-closable");e.appendChild(document.createTextNode(h.msg));var f=function(){e.style.opacity="0";setTimeout(function(){e.style.height="0px";e.style.padding="0px";e.style.margin="0px"},500);setTimeout(function(){if(null!==e&&null!==e.parentNode){e.parentNode.removeChild(e)}},1000)};e.onclick=f;e.ontouchstart=f;g.appendChild(e);if(h.eventID===b.error||h.eventID===b.assistance){this.notifScreen.insertBefore(g,this.notifScreen.firstChild)}else{this.notifScreen.appendChild(g)}if(h.eventID===b.info||h.eventID===b.success){setTimeout(function(){if(null!=e&&null!=e.parentNode){e.style.opacity="0"}},5000);setTimeout(function(){if(null!=e&&null!=e.parentNode){e.style.height="0px";e.style.padding="0px";e.style.margin="0px"}},5500);setTimeout(function(){if(null!=e&&null!=e.parentNode){e.parentNode.removeChild(e)}},6000)}else{if(h.eventID===b.warning){setTimeout(function(){if(null!=e&&null!=e.parentNode){e.setAttribute("class",e.getAttribute("class")+" SHAREPluginless_ghost")}},5000)}}},slide:function(e){if(e.right){this.posRight-=e.right;this.notifScreen.style.right=this.posRight+"px"}if(e.left){this.posRight+=e.left;this.notifScreen.style.right=this.posRight+"px"}},restorePosition:function(){this.posRight=0;this.notifScreen.style.right="0px"}})});define("DS/WebInfraUI/NavigationArrows",["UWA/Class","UWA/Core","DS/WebInfraUI/Touch","css!WebInfraUI/NavigationArrows.css","DS/WebappsUtils/WebappsUtils"],function(b,f,d,g,e){var c=e.getWebappsBaseUrl()+"WebInfraUI/assets/icons/128/";var i=function(o,j,n){this.id=o;var m;var l;var k="navigate3DPlay-arrow";if(o==="clockwise"||o==="counterClockwise"){m=c+"I_3DPlay_Rotate_CW_Disabled.png";l=c+"I_3DPlay_Rotate_CW.png"}else{m=c+"I_3DPlay_FlickArrow_Disabled.png";l=c+"I_3DPlay_FlickArrow.png"}this.arrowContainer=new f.Element("div",{id:k+"-"+this.id,"class":"navigate3DPlay-arrow",styles:{position:"absolute","background-image":"url("+m+")",opacity:1},events:{onclick:function(p){p.preventDefault();return false},mousemove:function(p){this.arrowContainer.style.transition="background-image 0s linear .2s";this.arrowContainer.style.backgroundImage="url("+l+")"}.bind(this),mouseleave:function(p){this.arrowContainer.style.backgroundImage="url("+m+")"}.bind(this),touchstart:function(p){this.arrowContainer.style.transition="background-image 0s linear";this.arrowContainer.style.backgroundImage="url("+l+")";p.preventDefault()}.bind(this),touchend:function(q){var p=this;this.arrowContainer.style.transition="background-image 0s linear";this.arrowContainer.style.backgroundImage="url("+m+")";q.preventDefault()}.bind(this)}}).inject(j);this.arrowContainer.style.backgroundImage="url("+l+")";setTimeout(function(){this.arrowContainer.style.transition="background-image .2s linear .2s";this.arrowContainer.style.backgroundImage="url("+m+")"}.bind(this),200);this.onclickCB=function(p){n(p);if(p&&p.preventDefault){p.preventDefault()}if(p&&p.srcEvent&&p.srcEvent.stopPropagation){p.srcEvent.stopPropagation()}};d(this.arrowContainer).on("tap",this.onclickCB);if(window.__karma__){this.arrowContainer.onclick=this.onclickCB}this.dispose=function(){d(this.arrowContainer).off("tap",this.onclickCB);this.arrowContainer.remove();this.arrowContainer=null;this.onclickCB=null;this.id=null}};var h;var a=b.extend({init:function(o,l){this._parent(l);h=this;this._arrowsList={};this._container=l.container;this._frmWindow=l.frmWindow;var j=this._frmWindow.getUIFrame();this._gestureList=o.gestureCB;for(var n in o.arrowCB){var p=new i(n,this._container,o.arrowCB[n]);this._arrowsList[n]=p}d.defaults.touchAction="none";this.uiFrameTouch=d(j);this.uiFrameTouch.get("swipe").set({direction:Hammer.DIRECTION_ALL,threshold:1,velocity:0.1});for(var m in this._gestureList){if(m==="rotate"){this.uiFrameTouch.get("rotate").set({enable:true});this.uiFrameTouch.on("rotate",this._gestureList[m])}else{this.uiFrameTouch.on(m,this._gestureList[m])}}this._checkKeyCB=function(q){return h._checkKey(q)};document.addEventListener("keydown",h._checkKeyCB);var k=this._frmWindow.getViewerFrame();this._resizeCB=function(q){return h._onViewerResize(q)};k.addEvent("resize",h._resizeCB);this._onViewerResize()},_checkKey:function(k){var j=k;if((j.keyCode===37||j.keyCode===100)&&j.ctrlKey===false&&this._arrowsList.left&&this._arrowsList.left.onclickCB){this._arrowsList.left.onclickCB(j)}else{if((j.keyCode===39||j.keyCode===102)&&j.ctrlKey===false&&this._arrowsList.right&&this._arrowsList.right.onclickCB){this._arrowsList.right.onclickCB(j)}else{if((j.keyCode===38||j.keyCode===104)&&j.ctrlKey===false&&this._arrowsList.up&&this._arrowsList.up.onclickCB){this._arrowsList.up.onclickCB(j)}else{if((j.keyCode===40||j.keyCode===98)&&j.ctrlKey===false&&this._arrowsList.down&&this._arrowsList.down.onclickCB){this._arrowsList.down.onclickCB(j)}else{if(((j.keyCode===39&&j.ctrlKey===true)||j.keyCode===99)&&this._arrowsList.down&&this._arrowsList.down.onclickCB){this._arrowsList.clockwise.onclickCB(j)}else{if(((j.keyCode===37&&j.ctrlKey===true)||j.keyCode===97)&&this._arrowsList.down&&this._arrowsList.down.onclickCB){this._arrowsList.counterClockwise.onclickCB(j)}}}}}}},_onViewerResize:function(){var m=this._frmWindow.getViewer();var l=this._frmWindow.getViewerFrame();var n=l.getDimensions();var v=m.SCREEN_HEIGHT||n.height;var q=m.SCREEN_WIDTH||n.width;var o=this._frmWindow&&this._frmWindow.getActionBar()?this._frmWindow.getActionBar().MAB:null;if(o){var t=o.state.visible}if(m.getCurrentSheet){var s=m.getCurrentSheet();v=s.currentHeight;q=s.currentWidth}var r=Math.max(64,Math.min(128,v*0.08));var k=r*0.5;var j=(v/2)-(r);var p=(q/2)-(r);for(var u in this._arrowsList){this._arrowsList[u].arrowContainer.setStyles({height:2*r,width:2*r});switch(this._arrowsList[u].id){case"left":this._arrowsList[u].arrowContainer.setStyles({top:j,left:"-35px"});break;case"right":this._arrowsList[u].arrowContainer.setStyles({top:j,right:"-35px"});break;case"up":this._arrowsList[u].arrowContainer.setStyles({left:p,top:"-35px"});break;case"down":this._arrowsList[u].arrowContainer.setStyles({left:p,bottom:"-80px"});break;case"clockwise":if(t){this._arrowsList[u].arrowContainer.setStyles({left:"-15px",bottom:"-15px"});break}else{this._arrowsList[u].arrowContainer.setStyles({left:"5px",bottom:"-80px"});break}case"counterClockwise":if(t){this._arrowsList[u].arrowContainer.setStyles({right:"-15px",bottom:"-15px"});break}else{this._arrowsList[u].arrowContainer.setStyles({right:"5px",bottom:"-80px"});break}default:}}},dispose:function(){d.defaults.touchAction="pan-y";var j=this._frmWindow.getViewerFrame();j.removeEvent("resize",h._resizeCB);document.removeEventListener("keydown",h._checkKeyCB);for(var l in this._arrowsList){this._arrowsList[l].dispose()}for(var k in this._gestureList){this.uiFrameTouch.off(k,this._gestureList[k])}this.uiFrameTouch=null;this._gestureList=null;this._arrowsList=null;this._container=null;this._frmWindow=null;h=null}});return a});define("DS/WebInfraUI/ContextualBar",["UWA/Core","UWA/Class","DS/WebSystem/Nls","DS/WebSystem/Rsc","DS/WebInfraUI/Touch","css!WebInfraUI/ContextualBar.css"],function(e,c,n,b,l,h){var f;var g=function(r){var s=this;var q=r.content;this.id=q.id;this.token=r.token;this.visible=true;this.btnSelectedStyle=q.btnSelectedStyleSquare?"ContextualBar_IconDiv_On_Square":"ContextualBar_IconDiv_On_Side";this.customSelectorCB=q.customSelectorCB;this.buttonDiv=new e.Element("div",{id:q.id,"class":"ContextualBar_Button"});this.buttonDivMAB=new e.Element("div",{id:q.id,"class":"PlayWeb-MAB-cmd",styles:{"z-index":0}});this.toggleSelected=function(){if(s.buttonDiv.selected===true){s.setSelected(false)}else{if(s.buttonDiv.selected===false){s.setSelected(true)}}};this.disable=function(t){this.visible=t;if(this.visible){s.buttonDivMAB.style.opacity=0.5}else{s.buttonDivMAB.style.opacity=1}};this.setSelected=function(t){if(t===true){s.buttonDiv.addClassName(s.btnSelectedStyle);s.buttonDivMAB.addClassName("PlayWeb-MAB-cmd-selected");s.buttonDiv.selected=true}else{s.buttonDiv.removeClassName(s.btnSelectedStyle);s.buttonDivMAB.removeClassName("PlayWeb-MAB-cmd-selected");s.buttonDiv.selected=false}if(f){f({id:s.id,token:s.token,state:s.buttonDiv.selected})}};this.onClick=function(u){var t,v;if(u){t=u.target.offsetTop+u.target.offsetParent.offsetTop+u.target.offsetParent.offsetParent.offsetTop;v=u.target.offsetLeft+u.target.offsetParent.offsetLeft+u.target.offsetParent.offsetParent.offsetLeft}r.onClickCB({event:u,id:s.id,token:s.token,position:{top:t,left:v}});if(u&&u.preventDefault){u.preventDefault()}if(u&&u.stopPropagation){u.stopPropagation()}};l(this.buttonDiv).on("tap",s.onClick);l(this.buttonDivMAB).on("tap",s.onClick);if(window.__karma__){this.buttonDiv.onclick=this.onClick}this.dispose=function(){l(s.buttonDiv).off("tap",s.onClick);l(this.buttonDivMAB).off("tap",s.onClick);s.buttonDiv.remove();s.buttonDivMAB.remove();s.buttonDiv=undefined;s.buttonDivMAB=undefined;s=undefined};this.getSelected=function(){if(s.buttonDiv){return s.buttonDiv.selected}return null};this.updateButton=function(t){if(t&&typeof t==="function"){if(s.buttonDiv&&s.buttonDiv.btnCustomContent){s.buttonDiv.btnCustomContent.remove();s.buttonDiv.btnCustomContent=undefined;s.buttonDivMAB.btnCustomContent.remove();s.buttonDivMAB.btnCustomContent=undefined}s.buttonDiv.btnCustomContent=t();s.buttonDivMAB.btnCustomContent=t();if(s.buttonDiv.btnCustomContent){s.buttonDiv.btnCustomContent.inject(s.buttonDiv);s.buttonDivMAB.btnCustomContent.inject(s.buttonDivMAB)}}};var p=q.iconSize||"Normal";b.rsc(q.rsc,{iconName:q.id,iconSize:p},function(u){if(s&&s.buttonDiv){var t=new e.Element("div",{id:"icon_"+q.id,"class":r.buttonStyle||"ContextualBar_IconDiv",styles:{backgroundImage:"url("+u+")"}}).inject(s.buttonDiv);var v=new e.Element("div",{"class":r.buttonStyle||"ContextualBar_IconDiv",styles:{backgroundImage:"url("+u+")"}}).inject(s.buttonDivMAB);if(q.selected===undefined||q.selected===false){s.setSelected(false)}else{s.setSelected(true)}n.nls(q.nls,q.id,function(w){if(w!==undefined){t.setAttribute("title",w.Title);v.setAttribute("title",w.Title)}else{t.setAttribute("title","undefined");v.setAttribute("title","undefined")}})}})};var i=function(q){var s=this;var p;var r=q.onclickCB;this.button=new g({content:q,token:q.token,buttonStyle:"ContextualBar_MasterIconDiv",onClickCB:function(t){s.onClick(t)}});this.onClick=function(t){p=setTimeout(function(){if(r){r({id:t.id,token:t.token})}},100)};this.dispose=function(){if(p){clearTimeout(p);p=undefined}s.button.dispose();s=undefined}};var o=function(q){var s=this;var p;var r=q.onclickCB;this.button=new g({content:q,token:q.token,buttonStyle:"ContextualBar_MasterIconDiv",onClickCB:function(t){s.onClick(t)}});this.onClick=function(t){s.button.toggleSelected();p=setTimeout(function(){if(r){r({id:t.id,token:t.token,state:s.button.getSelected(),position:t.position,uncheck:s.button.toggleSelected})}},100)};this.dispose=function(){if(p){clearTimeout(p);p=undefined}s.button.dispose();s=undefined}};var j=function(q){var s=this;var p;var r=q.onclickCB;this.button=new g({content:q,token:q.token,onClickCB:function(t){s.onClick(t)}});this.onClick=function(t){s.button.toggleSelected();p=setTimeout(function(){if(r){r({id:t.id,token:t.token,state:s.button.getSelected(),position:t.position,uncheck:s.button.toggleSelected})}},100)};this.setSelected=function(t){s.button.setSelected(t.state)};this.dispose=function(){if(p){clearTimeout(p);p=undefined}s.button.dispose();s=undefined}};var m=function(s){var v=this;var r;var u=s.onclickCB;this.buttons=[];this.buttonGroup=new e.Element("div",{id:s.groupName+"_group","class":"ContextualBar_ButtonGroup"});this.onClick=function(x){var A=x.id;var w;for(var z=0;z<v.buttons.length;++z){var y=v.buttons[z];if(A===y.id){if(y.getSelected()===false){y.setSelected(true);w=y.getSelected()}}else{y.setSelected(false)}}if(w!==null){r=setTimeout(function(){if(u){u({id:x.id,token:x.token,state:true,position:x.position})}},100)}};this.setSelected=function(w){for(var x=0;x<v.buttons.length;++x){if(w.id===v.buttons[x].id){v.buttons[x].setSelected(true)}else{v.buttons[x].setSelected(false)}}};var q;for(var t=0;t<s.content.length;++t){var p=new g({content:s.content[t],token:s.token,onClickCB:function(w){v.onClick(w)}});if(p.getSelected()===true){q=this.buttons.length}this.buttons.push(p);this.buttonGroup.appendChild(p.buttonDiv)}if(q===undefined){this.buttons[0].setSelected(true)}v.dispose=function(){if(r){clearTimeout(r);r=undefined}for(var w=0;w<v.buttons.length;w++){v.buttons[w].dispose()}v.buttonGroup.remove();v.buttonGroup=undefined;v=undefined}};var d=function(s,r){var u=this;var q;var p;var t=s.onclickCB;this._frmWindow=r.frmWindow;this.button=new g({content:s,token:s.token,onClickCB:function(v){u.onClick(v)}});this.deleteExpandedPanel=function(){if(p){clearTimeout(p);p=undefined}if(u.container){Touch(document).off("tap",u.checkOnClickExpandedPanel);document.removeEventListener("onMouseOut",u.onEventCloseExpandedPanel);document.removeEventListener("onKeyDown",u.onEventCloseExpandedPanel);if(u.container.buttons){for(var v=0;v<u.container.buttons.length;v++){u.container.buttons[v].dispose()}}u.container.remove();u.container=undefined}};this.createExpandedPanel=function(v,w){this.container=new e.Element("div",{"class":"ContextualBar_ExpandedContainer ContextualBar_Background"}).inject(u._frmWindow.getUIFrame());var x=document.getElementsByClassName("ContextualBar_MainContainer").item(0);u.container.style.top=2+x.offsetTop+w.offsetTop+"px";u.container.buttons=[];a(v.content,u.container,u._frmWindow);u.checkOnClickExpandedPanel=function(z){var y="ContextualBar_ExpandedContainer ContextualBar_Background";if(z.target.className!==y&&z.target.parentNode&&z.target.parentNode.parentNode&&z.target.parentNode.parentNode.className!==y&&z.target.parentNode.parentNode.parentNode&&z.target.parentNode.parentNode.parentNode.className!==y){u.closePanel()}};u.onEventCloseExpandedPanel=function(y){var z=y.from[0].event;if(z.target.tagName==="BODY"||z.target.activeElement&&z.target.activeElement.tagName==="BODY"){u.closePanel()}};p=setTimeout(function(){Touch(document).on("tap",u.checkOnClickExpandedPanel);document.addEventListener("onMouseOut",u.onEventCloseExpandedPanel);document.addEventListener("onKeyDown",u.onEventCloseExpandedPanel)},100)};this.closePanel=function(){this.button.setSelected(false);this.deleteExpandedPanel()};this.onClick=function(v){if(this.button.getSelected()===true){this.closePanel()}else{this.button.setSelected(true);q=setTimeout(function(){if(t){var w=t({id:v.id,token:v.token,state:this.button.getSelected(),position:v.position});if(w&&v.event){this.createExpandedPanel(w,v.event.target.parentNode)}}},100)}};this.setSelected=function(){};this.dispose=function(){if(q){clearTimeout(q);q=undefined}u.deleteExpandedPanel();u.button.dispose();u=undefined}};function a(t,q,A){for(var y=0;y<t.length;y++){var w=t[y];var v;if(w.type===1){v=new m(w);q.buttons.push(v);q.appendChild(v.buttonGroup)}else{if(w.type===3){v=new i(w);q.masterButton=v;var x=q.querySelector("#ContextualBar_MasterButtonContainer");x.style.display="block";x.appendChild(v.button.buttonDiv);var r=q.querySelector("#ContextualBar_MasterButtonSeparator");r.style.display="inline-block"}else{if(w.type===4){v=new o(w);var p=q.querySelector("#ContextualBar_MasterButtonContainer");p.style.display="block";p.appendChild(v.button.buttonDiv);var u=q.querySelector("#ContextualBar_MasterButtonSeparator");u.style.display="inline-block"}else{if(w.type===0){v=new j(w)}else{if(w.type===2){var s=document.getElementsByClassName("ContextualBar_ExpandedContainer");if(s.length===0){var z={frmWindow:A};v=new d(w,z)}}}if(v){q.buttons.push(v);q.appendChild(v.button.buttonDiv)}}}}}}var k=c.extend({init:function(q,p){this.frmWindow=p.frameWindow;this.panel=this._createPanel(q,p);this.flyoutMAB=this._createFlyoutMAB(this.container.buttons,this.container.masterButton,p.mab||{});f=p.updateSelectedCB;return this.panel},_createFlyoutMAB:function(v,q,r){var w=this.frmWindow.getActionBar();if(w&&w.MAB){var u=w.MAB;if(r.isDispose===true){u.showFlyout(0)}else{var s=[],t,p;for(t=0;t<v.length;t++){if(v[t].buttons){for(p=0;p<v[t].buttons.length;p++){s.push({uxElt:v[t].buttons[p].buttonDivMAB})}}else{if(v[t].button){s.push({uxElt:v[t].button.buttonDivMAB})}}}s.backCB=r.backCB||(q&&q.button)?q.button.onClick:undefined;u.showFlyout(r.flyoutLevel||1,s)}}},_createPanel:function(t,q){var s=this.frmWindow.getUIFrame();var p=new e.Element("div",{"class":"ContextualBar_Panel"});this.container=new e.Element("div",{"class":"ContextualBar_MainContainer"}).inject(p);this.masterButtonContainer=new e.Element("div",{id:"ContextualBar_MasterButtonContainer",styles:{display:"none"}}).inject(this.container);var r=new e.Element("div",{id:"ContextualBar_MasterButtonSeparator",styles:{display:"none"}}).inject(this.container);new e.Element("span",{"class":"fonticon fonticon-menu-dot",styles:{transform:"rotate(90deg)",opacity:"0.4"}}).inject(r);if(q.showContextBarBackground){this.addDefaultBackground()}this.container.buttons=[];this.container.masterButton=null;a(t,this.container,this.frmWindow,p);var u=this.frmWindow.getActionBar();if(u&&u.MAB){if(u.MAB.state.visible){p.style.display="none"}u.MAB.onVisibilityChangeSubscribe("PlayWeb-ContextualBar",function(v){if(v!=="hidden"){p.style.display="none"}else{p.style.display=""}})}p.inject(s);this.viewerFrame=this.frmWindow.getViewerFrame();this._setContexualBarMidframe=function(){this.container.style.top=this.viewerFrame.offsetHeight/2-this.container.clientHeight/2+"px";this.container.style.transition="top .2s ease-in"}.bind(this);this._setContexualBarMidframe();this.viewerFrame.addEvent("resize",this._setContexualBarMidframe);return p},remove:function(){if(this.container&&this.container.buttons){for(var p=0;p<this.container.buttons.length;p++){this.container.buttons[p].dispose()}this.container.buttons=undefined;this.container.masterButton=null;this.container.remove();this.container=undefined}f=undefined;this.panel.remove();this.panel=undefined;var q=this.frmWindow.getActionBar();if(q&&q.MAB){q.MAB.onVisibilityChangeUnsubscribe("PlayWeb-ContextualBar")}this.frmWindow=undefined;this.viewerFrame.removeEvent("resize",this._setContexualBarMidframe);this.viewerFrame=undefined},setSelected:function(r){if(this.container&&this.container.buttons){for(var q=0;q<this.container.buttons.length;++q){var p=this.container.buttons[q];if(p.buttons){for(var s=0;s<p.buttons.length;++s){if(p.buttons[s].id===r.id){p.setSelected(r)}}}else{if(p.button){if(p.button.id===r.id){p.setSelected(r)}}}}}},updateButton:function(r){if(this.container&&this.container.buttons){for(var q=0;q<this.container.buttons.length;++q){var p=this.container.buttons[q];if(p.buttons){for(var s=0;s<p.buttons.length;++s){if(p.buttons[s].id===r.id){p.buttons[s].updateButton(r.getButtonContent)}}}else{if(p.button){if(p.button.id===r.id){p.button.updateButton(r.getButtonContent)}}}}}},addDefaultBackground:function(){this.container.addClassName("ContextualBar_Background")},removeBackground:function(){this.container.removeClassName("ContextualBar_Background")}});return k});define("DS/WebInfraUI/ContextualBarManager",["DS/WebInfraUI/ContextualBar","UWA/Class"],function(a,b){var c=b.extend({Toolbar:{New:0,Append:1},Button:{Check:0,Radio:1,Expander:2,Master:3,MasterCheck:4},init:function(d){this.panelJSON=[];this.token=0;this.panel=null;this.frmWindow=d.frameWindow},addButtons:function(e,d){this.token++;if(this.panelJSON.length===0){this.panelJSON[0]={}}else{if(d.barType===0){this.panelJSON[this.panelJSON.length]={}}}this.panelJSON[this.panelJSON.length-1][this.token]={token:this.token,content:e};this._deletePanel();this._rebuildPanel(d);return this.token},setSelected:function(d){this.panel.setSelected(d)},updateButton:function(d){this.panel.updateButton(d)},_rebuildPanel:function(f){var k=this;if(this.panelJSON&&this.panelJSON.length!==0){var i=this.panelJSON.length;var j=[];for(var e in this.panelJSON[i-1]){var h=this.panelJSON[i-1][e].content;var d=this.panelJSON[i-1][e].token;for(var g=0;g<h.length;g++){h[g].token=d;j.push(h[g])}}this.panel=new a(j,{frameWindow:this.frmWindow,updateSelectedCB:function(l){k._updateSelected(l)},showContextBarBackground:f.showContextBarBackground,mab:f.mab})}},_deletePanel:function(){if(this.panel){this.panel.remove();this.panel=undefined}},_deleteToken:function(g){var h=false;for(var e=this.panelJSON.length-1;e>=0;e--){for(var f in this.panelJSON[e]){var d=parseInt(f);if(d===g&&this.panelJSON[e][g]){this.panelJSON[e][g]=null;delete this.panelJSON[e][g];if(Object.keys(this.panelJSON[e]).length===0){this.panelJSON.splice(e,1)}h=true;break}}if(h===true){break}}},_updateSelected:function(m){for(var l=this.panelJSON.length-1;l>=0;l--){for(var i in this.panelJSON[l]){var f=parseInt(i);if(f===m.token){var g=this.panelJSON[l][m.token];if(g){var e=g.content;if(e){for(var d=0;d<e.length;++d){var j=e[d];if(j&&j.type===this.Button.Check&&j.id===m.id){j.selected=m.state;return}else{if(j&&j.type===this.Button.Radio&&j.content){for(var k=0;k<j.content.length;++k){var h=j.content[k];if(h&&h.id===m.id){h.selected=m.state;return}}}}}}}}}}},removeButtons:function(e,d){this._deletePanel();this._deleteToken(e);this._rebuildPanel({showContextBarBackground:true,mab:{isDispose:d}})},dispose:function(){this._deletePanel();this.panelJSON=undefined;this.token=undefined;this.frmWindow=undefined}});return c});