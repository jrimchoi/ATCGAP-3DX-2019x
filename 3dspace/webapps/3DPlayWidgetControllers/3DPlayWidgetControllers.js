define("DS/3DPlayWidgetControllers/W3DPlayModelFilteringCtrl",["UWA/Class","DS/CoreEvents/Events"],function(b,d){var h,f=[],g,c,e=-1,a=[];return b.extend({init:function(i){this.wiew=i},filter:function(j){var i=this.wiew.get3DPlayInstance();if(i){i.seach(j)}},dispose:function(){this.wiew=null}})});define("DS/3DPlayWidgetControllers/W3DPlayDDCtrl",["UWA/Class","DS/CoreEvents/Events"],function(e,f){var b,d,a,h,g;var c=e.extend({init:function(j,i){b=j;d=i;a=this;h=f.subscribe({event:"MainView.onDrop"},function(k){a._dragAndDropParsing(k)});g=f.subscribe({event:"MainView.onFileDrop"},function(k){a._directDragAndDropParsing(k)})},dispose:function(){f.unsubscribe(h);f.unsubscribe(g);b=d=a=null},_dragAndDropParsing:function(l){var j=JSON.parse(l);var i=b.getCurrentData();var p=j.data["items"][0]["objectId"];var m=i.objectId;d.hideLastWidgetNotification();if(p===m){var o=b.getWidgetMessage("SAME_MODEL");var n=b.getWidgetMessage("SAME_MODEL_TITLE");var k={level:"info",title:n,message:o,sticky:false};d.addWidgetNotification(k);f.publish({event:"Controler.SameModel",data:k})}else{b.drag=true;b.setCurrentContent(j)}},_directDragAndDropParsing:function(j){var i=window.URL.createObjectURL(j.files[0]);var k=function(s){var p=s.replace(/\.\./g,"");p=p.split(".");if(p.length===1||(p[0]===""&&p.length===2)){return""}var r=p.pop();var o=r.indexOf("?")+1;if(o){p=r.substring(0,o-1)}else{p=r}var q=new RegExp(/^[a-zA-Z0-9_]+$/);var n=q.exec(p);if(n!==null){return p}return""};var l=k(j.files[0].name);var m={asset:{format:l,filename:i,provider:"FILE",proxyurl:"none",requiredAuth:null,serverurl:""}};f.publish({event:"Player.load",data:{input:m}})}});return c});define("DS/3DPlayWidgetControllers/W3DPlayIncomingMsgCtrl",["UWA/Class","DS/PlatformAPI/PlatformAPI"],function(e,d){var a;var c;var b="DS/PADUtils/PADCommandProxy/select";return e.extend({init:function(g,f){this.m=g;this.v=f;this.setUpSubscribers()},setUpSubscribers:function(){var f=this;this.token=d.subscribe(b,function(g){if(widget&&g&&g.metadata&&widget.id!==g.metadata.originWidgetId){f.enoPadSelectHandler(g)}})},dispose:function(){d.unsubscribe(this.token)},enoPadSelectHandler:function(k){var j=k.data.paths;var h=j.length;var f=[];for(var g=0;g<h;g++){f.push(j[g].join("/"))}this.m.setCurrentCSO(f)}})});define("DS/3DPlayWidgetControllers/W3DPlayPrefsCtrl",["UWA/Class","DS/CoreEvents/Events","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(c,i,b){var d,h,f,e;var g={protocol:"3DXContent",version:"1.0",source:"X3DCSMA_AP",data:{items:[{envId:"defaultString",serviceId:"defaultString",contextId:"defaultString",objectId:"defaultString",objectType:"defaultString",displayName:"",displayType:"defaultString",displayIcon:"defaultStringUri",displayPreview:"defaultStringUri",selectedExperience:"defaultString"}]}};var a=c.extend({init:function(l,k,j){f=l;d=k;e=this;d.plateformPromise.then(function(m){e.readAllPreferences();e=null},function(m){console.error("getAllPlatformServices Error!");console.dir(m)})},dispose:function(){d=h=f=e=null},readAllPreferences:function(){var j=d.getSwymModelIdPref();var l=d.getSwymTenantIdPref();var k=d.getCollabSpacePref();var o=d.getX3dContentPref();var m;var r=d.getW3DPlayContentPref();if(d.applicationFrameOptions&&d.applicationFrameOptions.options&&d.applicationFrameOptions.options.pad3DViewer&&this.isAnySwitchAppPreferences()){var q=d.getPreferencesFromSwitchApp();var p=this.switchAppDataPreparation(q);d.setW3DPlayContent(p)}if(this.isSwymIdValid(j)&&this.isW3DPlayContentEmpty()){m=this.newSwymDataPreparation(j,l);d.setW3DPlayContent(m)}else{if(this.isCollabSpaceValid(k)&&this.isW3DPlayContentEmpty()){m=this.newSpaceDataPreparation(k);d.setW3DPlayContent(m)}else{if(this.isX3DContentIdValid(o)){m=JSON.parse(o);d.setW3DPlayContent(m)}}}if(!this.isW3DPlayContentEmpty()){r=d.getW3DPlayContentPref();d.setInitialContent(JSON.parse(r))}else{}i.publish({event:"PrefsCtrl.PreferencesReady"})},isAnySwitchAppPreferences:function(){var j=false;var l=d.getPreferencesFromSwitchApp();var k=l.afrExecutionContexts;if(k&&k!==null&&typeof k!=="undefined"&&l.PAD3DViewerPathsInSession&&l.pad_security_ctx&&l.pad_tenant){j=true}return j},isPreferencesEmpty:function(){var j=true;var k=d.getW3DPlayContentPref();if(k&&k!==null&&typeof k!=="undefined"){j=false}return j},isW3DPlayContentEmpty:function(){var j=true;var k=d.getW3DPlayContentPref();if(k&&k!==null&&typeof k!=="undefined"){j=false}return j},switchAppDataPreparation:function(l){var j=l.PAD3DViewerPathsInSession;if(j){j=this.getPhyIdFromPad3DViewer(JSON.parse(j))}var k=g.data["items"][0];k.envId=l.pad_tenant;k.serviceId="3DSpace";k.contextId=l.pad_security_ctx;k.objectType="VPMReference";k.objectId=j;return g},getPhyIdFromPad3DViewer:function(j){var k=j.length;if(k>0){return j[0][0]}else{console.error("Invalid Paths In Sessions",j)}},isSwymIdValid:function(j){if(UWA.is(j)&&j!=""&&j!="false"&&typeof j!="undefined"){d.setDefaultModelIsRunning(false);return j}else{return false}},newSwymDataPreparation:function(m,j,l){var k=g.data["items"][0];k.envId=j;k.objectId=m;k.serviceId="3DSWYM";k.objectType="3DShape";if(l){console.warn("wow very old ( <R416 ?) 3DPlay Widget Preferences!")}return g},newSpaceDataPreparation:function(j){return JSON.parse(j)},isCollabSpaceValid:function(k){var l=false;if(k&&k!=="undefined"){var j=JSON.parse(k);if(UWA.is(j,"object")){if(j.hasOwnProperty("data")){d.setDefaultModelIsRunning(false);l=true}}}return l},isX3DContentIdValid:function(k){var m=false;if(k&&k!=="undefined"){var j=JSON.parse(k);if(UWA.is(j,"object")){if(j.hasOwnProperty("data")){d.setDefaultModelIsRunning(false);m=true}}}var l=d.getW3DPlayContentPref();if(l&&l!==null&&typeof l!=="undefined"){m=false}return m},deleteLegacyModelIdPref:function(j){f.setValue("MODELID","");if(j){f.deleteValue("MODELID")}},deleteLegacyPlatformdPref:function(j){f.setValue("PLATFORM","");if(j){f.deleteValue("PLATFORM")}},deleteAllLegacyPrefs:function(){this.deleteLegacyModelIdPref();this.deleteLegacyPlatformdPref()},cleanCollabSpacePref:function(j){f.setValue("CollabSpacePref","");if(j){f.deleteValue("CollabSpacePref")}},getAllPlatformServices:function(){return new Promise(function(k,j){b.getServiceUrl({serviceName:"3DSpace",onComplete:function(l){k(l)},onFailure:function(l){j(l);console.error("Error in i3DXCompassServices.getPlatformServices :",l)}})})}});return a});