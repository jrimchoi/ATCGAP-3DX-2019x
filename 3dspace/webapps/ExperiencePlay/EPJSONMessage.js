define("DS/ExperiencePlay/EPJSONMessage",["DS/ExperienceKernel/ExperienceKernel","DS/EP/EP"],function(c,a){var b=function(h,f,e){this.command=h;this.sender=f;this.dataStr="";this.valueType=b.EValueType.eString;this.parameters=[];this.result=this.defaultNumberType=0;var g=e;if(g!==undefined){if(g.constructor===String){this.dataStr=g}else{if(g.constructor===Number){if(g===b.EValueType.eDouble||g===b.EValueType.eInt||g===b.EValueType.eBool){this.defaultNumberType=g}}}}};b.EResult={eNone:0,eCommandOK:1,eCommandFail:2,eCommandInvalidParameters:3,eEventOK:4,eEventFail:5,};b.EValueType={eString:0,eInt:1,eBool:2,eDouble:3,eStoreKey:4,eObject:5,eObjectArray:6,eIntArray:7,eDoubleArray:8,eStringArray:9,eBoolArray:10,eBuffer:11,};b.prototype.SetParameters=function(){this.parameters=[];var e=arguments.length;for(var f=0;f<e;f++){var g=b.EValueType.eString;if(arguments[f].constructor===String){g=b.EValueType.eString}else{if(arguments[f].constructor===Boolean){g=b.EValueType.eBool}else{if(arguments[f].constructor===Number){if(this.defaultNumberType!==0){g=this.defaultNumberType}else{if(arguments[f]===Math.floor(arguments[f])){g=b.EValueType.eInt}else{g=b.EValueType.eDouble}}}else{if(arguments[f].constructor===Array){if(arguments[f].length===0){g=b.EValueType.eObjectArray}else{if(arguments[f][0].constructor===Boolean){g=b.EValueType.eBool}else{if(arguments[f][0].constructor===String){g=b.EValueType.eStringArray}else{if(arguments[f][0].constructor===Number){if(this.defaultNumberType!==0){g=this.defaultNumberType}else{if(arguments[f][0]===Math.floor(arguments[f][0])){g=b.EValueType.eIntArray}else{g=b.EValueType.eDoubleArray}}}}}}}else{if(arguments[f] instanceof Object){g=b.EValueType.eObject}}}}}this.parameters.push({name:"",valueType:g,value:arguments[f]})}};b.prototype.SetTypedParameters=function(){this.parameters=[];var e=arguments.length;var g=b.EValueType.eString;for(var f=0;f<e;f++){if(f%2===0){g=arguments[f]}else{if(arguments[f].constructor===String){if(arguments[f-1]===b.EValueType.eInt||arguments[f-1]===b.EValueType.eBool){this.parameters.push({name:"",valueType:g,value:parseInt(arguments[f])})}else{if(arguments[f-1]===b.EValueType.eDouble){this.parameters.push({name:"",valueType:g,value:parseFloat(arguments[f])})}else{this.parameters.push({name:"",valueType:g,value:arguments[f]})}}}else{this.parameters.push({name:"",valueType:g,value:arguments[f]})}}}};b.prototype.SetTypedNamedParameters=function(){this.parameters=[];var e=arguments.length;var g=b.EValueType.eString;for(var f=0;f<e;f++){if(f%3===0){g=arguments[f]}else{if(f%3===1){if(arguments[f].constructor===String&&arguments[f+1].constructor===String){if(arguments[f-1]===b.EValueType.eInt||arguments[f-1]===b.EValueType.eBool){this.parameters.push({name:arguments[f],valueType:g,value:parseInt(arguments[f+1])})}else{if(arguments[f-1]===b.EValueType.eDouble){this.parameters.push({name:arguments[f],valueType:g,value:parseFloat(arguments[f+1])})}else{this.parameters.push({name:arguments[f],valueType:g,value:arguments[f+1]})}}}else{if(arguments[f].constructor===String){this.parameters.push({name:arguments[f],valueType:g,value:arguments[f+1]})}}}}}};b.prototype.SetNamedParameters=function(){this.parameters=[];var e=arguments.length;for(var f=0;f<e;f++){if(f%2!==0||arguments[f].constructor!==String){continue}var g=b.EValueType.eString;if(arguments[f+1].constructor===String){g=b.EValueType.eString}else{if(arguments[f+1].constructor===Boolean){g=b.EValueType.eBool}else{if(arguments[f+1].constructor===Number){if(this.defaultNumberType!==0){g=this.defaultNumberType}else{if(arguments[f]===Math.floor(arguments[f])){g=b.EValueType.eInt}else{g=b.EValueType.eDouble}}}else{if(arguments[f+1].constructor===Array){if(arguments[f+1].length===0){g=b.EValueType.eObjectArray}else{if(arguments[f+1][0].constructor===Boolean){g=b.EValueType.eBool}else{if(arguments[f+1][0].constructor===String){g=b.EValueType.eStringArray}else{if(arguments[f+1][0].constructor===Number){if(this.defaultNumberType!==0){g=this.defaultNumberType}else{if(arguments[f+1][0]===Math.floor(arguments[f+1][0])){g=b.EValueType.eIntArray}else{g=b.EValueType.eDoubleArray}}}}}}}else{if(arguments[f+1] instanceof Object){g=b.EValueType.eObject}}}}}this.parameters.push({name:arguments[f],valueType:g,value:arguments[f+1]})}};var d=function(e,f){if(e==="EValueType"){return undefined}return f};b.prototype.ToJSON=function(){return JSON.stringify(this,d)};b.prototype.FromJSON=function(g){var e=JSON.parse(g);for(var f in e){if(f!=="prototype"&&this.hasOwnProperty(f)){this[f]=e[f]}}};b.prototype.FromBinary=function(k){var e=new c.BinaryReader(k);this.command=e.readString();this.sender=e.readString();this.dataStr=e.readString();this.result=e.readUint8();var g=e.readInt32();for(var f=0;f<g;f++){this.parameters[f]={name:"unknown"};this.parameters[f].name=e.readString();this.parameters[f].valueType=e.readInt32();if(this.parameters[f].valueType===b.EValueType.eString){this.parameters[f].value=e.readString()}else{if(this.parameters[f].valueType===b.EValueType.eInt){this.parameters[f].value=e.readInt32()}else{if(this.parameters[f].valueType===b.EValueType.eDouble){this.parameters[f].value=e.readDouble()}else{if(this.parameters[f].valueType===b.EValueType.eBool){this.parameters[f].value=e.readBool()}}}}var h=e.readInt32();if(h>0){this.parameters[f].buffer=e.readArrayBuffer(h)}}var j=e.readInt32();if(j>0){this.buffer=e.readArrayBuffer(j)}return 0};b.prototype.ToBinary=function(){var g=new c.BinaryWriter();g.writeString(this.command);g.writeString(this.sender);g.writeString(this.dataStr);g.writeUint8(this.result);var f=this.parameters.length;g.writeInt32(f);for(var e=0;e<f;e++){g.writeString(this.parameters[e].name);g.writeInt32(this.parameters[e].valueType);if(this.parameters[e].valueType===b.EValueType.eString){g.writeString(this.parameters[e].value)}else{if(this.parameters[e].valueType===b.EValueType.eInt){g.writeInt32(this.parameters[e].value)}else{if(this.parameters[e].valueType===b.EValueType.eDouble){g.writeDouble(this.parameters[e].value)}else{if(this.parameters[e].valueType===b.EValueType.eBool){g.writeBool(this.parameters[e].value)}}}}var h=0;if((this.parameters[e].buffer!==undefined)&&(this.parameters[e].buffer.constructor===ArrayBuffer)){h=this.parameters[e].buffer.byteLength}g.writeInt32(h);if(h>0){g.writeArrayBuffer(this.parameters[e].buffer)}}var j=0;if((this.buffer!==undefined)&&(this.buffer.constructor===ArrayBuffer)){j=this.buffer.byteLength}g.writeInt32(j);if(j>0){g.writeArrayBuffer(this.buffer)}return g.createArrayBuffer()};a.JSONMessage=b;return b});