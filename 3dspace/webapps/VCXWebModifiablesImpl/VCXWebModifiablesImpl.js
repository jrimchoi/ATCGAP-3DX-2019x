define("DS/VCXWebModifiablesImpl/VCXModifiableOccurrence",["DS/Visualization/PathElement","DS/Visualization/ThreeJS_DS","DS/Visualization/SceneGraphUtils","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/VCXWebProperties/VCXColor","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueFrame","DS/VCXWebProperties/VCXPropertyValueLocation","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXInterpolatorConstant","DS/VCXWebTracks/VCXInterpolatorLinear","DS/VCXWebTracks/VCXInterpolatorCubic",],function(l,t,j,b,k,n,m,o,c,d,e,i,r,s,q,p,a,u,f,h){var g=b.extend({init:function(){this._parent();this._interpolationType=0;if(g.prototype._interpolatorConstant){}else{g.prototype._interpolatorConstant=new u();g.prototype._interpolatorLinear=new f();g.prototype._interpolatorCubic=new h()}},OnChangeProperty:function(z,w,y){if(y){}else{y={}}if(y.fromChildClass){}else{if(this.OnChangePropertyBegin(z,w)){return true}}switch(z){case"Actor.Name":var B=this.GetObject();B.name=w.Value;return true;case"Actor.Position":var B=this.GetObject();B.matrix=w.GetValue()[0].GetValue();var v=null;B.pivot=w.GetValue()[1].GetValue();return true;case"Actor.Color.Defined":var B=this.GetObject();B.localColorIsDefined=w.GetValue();return true;case"Actor.Color":var B=this.GetObject();var x=w.GetValue();if(x===null){console.log("occurrence color problem")}B.localColor=x.Clone();return true;case"Actor.Opacity":var B=this.GetObject();B.alpha=w.GetValue();return true;case"Actor.Visibility.Opacity":var B=this.GetObject();B.visibilityAlpha=w.GetValue();return true;case"Actor.Interpolation.Type":var A=w.GetValue();if(typeof A!=="undefined"){this._interpolationType=A}return true;default:y.fromChildClass=true;return this._parent(z,w,y)}return false},OnChangePropertiesEnd:function(){var y=this.GetObject();if(y.getDirtyFlag(k.FDirty.Color)){if(!y._localColor){var x=this.GetOriginalMaterial();var w=new n();if(x){w.SetRGB(x.color.r,x.color.g,x.color.b);y._localColor=w}else{w.SetRGB(1,1,1);y._localColor=w}}}if(y.getDirtyFlag(k.FDirty.Alpha)){if(y._alpha!==null){y._localAlpha=y._visibilityAlpha*y._alpha}else{y._localAlpha=y._visibilityAlpha*1}}if(y._dirtyMask&&!y.IsDressup){var v=y._experienceBase.getManager("VCXContextManager");if(v){if(v.useTraverseGraph){v.traverseGraphMustBePerformed=true}else{if(y.getDirtyFlag(k.FDirty.Position)){y.setPosition(y.matrix);y.setDirtyFlag(k.FDirty.Position,false)}}}}},GetInterpolator:function(v){if(v==="Actor.Position"&&this._interpolationType===1){return this._interpolatorCubic}return null},GetProperty:function(V){var Q=null;if(V==="Actor.Name"){var x="";var M=this.GetObject();var H=(M.GetName&&M.GetName())?M.GetName():M.name;if(typeof H==="string"&&H!==""){x=H}var F=new p();F.SetValue(x);Q=new m(new o("Actor.Name",1,true,"VCXWebModifiables/VCXWebModifiables"),F)}else{if(V==="Actor.Position"){var M=this.GetObject();if(true){var T=null;T=M.matrix;if(!T){var N=this.QueryInterface("W3AISGNodeHolder").getPathElement();if(N){var J=M._experienceBase.getManager("VCXContextManager");T=M.getPosition()}}if(!T){console.log("[VCXModifiableOccurence::GetProperty] Error matrix null")}else{var y=new e();var P=new d();P.SetValue(T);y.SetFrame(P);var A=new d();if(M.pivot){A.SetValue(M.pivot)}else{A.SetValue(T)}y.SetPivot(A);Q=new m(new o(V,0,true,"VCXWebModifiables/VCXWebModifiables"),y);Q.GetPropertyInfo().SetVisible(false)}}}else{if(V==="Actor.Color"){var S=this.GetObject().localColor;if(S===null){S=new t.Color();var L=this.GetOriginalMaterial();if(L!==null&&L!==undefined){S.setRGB(L.color.r,L.color.g,L.color.b)}else{S.setRGB(1,1,1)}}var U=new i();U.SetValue(S);if(this.GetObject().localColorIsDefined!==null){U._bDefined=this.GetObject().localColorIsDefined}var G=new o(V,0,true,"VCXWebModifiables/VCXWebModifiables");Q=new m(G,U)}else{if(V==="Actor.Color.Defined"){var E=new q();var w=this.GetObject().localColorIsDefined;if(w!==null){E.SetValue(w)}else{E.SetValue(false)}var G=new o(V,0,true,"VCXWebModifiables/VCXWebModifiables");G.SetVisible(true);Q=new m(G,E)}else{if(V==="Actor.Opacity"){var C=this.GetObject().alpha;if(C===null){C=1}var O=new r();O.SetValue(C);var G=new o(V,0,true,"VCXWebModifiables/VCXWebModifiables");G.SetBounds(0,1,0.1);Q=new m(G,O)}else{if(V==="Actor.Interpolation.Type"){var R=new s();R.SetValue(this._interpolationType);var D=new c(V,1,true,"VCXWebModifiables/VCXWebModifiables");var K=this._generateMapChoiceFromEnumAndId(a.EInterpolationType,"Interpolation",["Custom","Smooth"]);D.SetMapChoiceEnum(K);Q=new m(D,R)}else{if(V==="Actor.Visibility.Opacity"){var C=1;var Y=this.GetObject().visibilityAlpha;if(Y!==null){C=Y}var O=new r();O.SetValue(C);var G=new o(V,0,false,"VCXWebModifiables/VCXWebModifiables");G.SetBounds(0,1,0.1);G.SetVisible(false);Q=new m(G,O)}else{if(V==="Actor.3DReference"){var X="";var N=this.QueryInterface("W3AISGNodeHolder").getPathElement();var z=N.getLastElement();if(z){var B=z.getChildren();if(B.length>0){var I=B[0].productType;if(I==="Reference3D"){X=B[0].name}}}if(!X){var v=this.GetProperty("Modifiable.HasChildren");if(v){if(!v.GetPropertyValue().GetValue()){var W=this.GetProperty("Meta.ReferenceName");if(W){X=W.GetPropertyValue().GetValue()}}}}var F=new p();F.SetValue(X);var G=new o(V,1,false,"VCXWebModifiables/VCXWebModifiables");G.SetGroupId("Group.Introspection");Q=new m(G,F)}else{Q=this._parent(V)}}}}}}}}return Q},GetProperties:function(){var v=this._parent();v.AddOrModifyProperty(this.GetProperty("Actor.Name"));v.AddOrModifyProperty(this.GetProperty("Actor.Position"));v.AddOrModifyProperty(this.GetProperty("Actor.Color"));v.AddOrModifyProperty(this.GetProperty("Actor.Color.Defined"));v.AddOrModifyProperty(this.GetProperty("Actor.Opacity"));v.AddOrModifyProperty(this.GetProperty("Actor.Visibility.Opacity"));v.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink"));v.AddOrModifyProperty(this.GetProperty("Actor.Interpolation.Type"));if(this.GetObject()._experienceBase.ModifiablesAdvancedProperties){v.AddOrModifyProperty(this.GetProperty("Actor.3DReference"))}return v},GetOriginalMaterial:function(){var y=this.QueryInterface("W3AISGNodeHolder").getPathElement();if(!y||y===undefined||!y.externalPath.length){return null}var A=new l();for(var x=0;x<y.externalPath.length;++x){A.addElement(y.externalPath[x])}var w=A.getLastElement();while(w){w=w.children.length?w.children[0]:null;if(w){A.addElement(w);if("Mesh3D"===w.getNodeType()){break}}}var z=this.GetObject()._experienceBase.getManager("VCXContextManager").getMainViewer();var v=j.getMaterialsFromPath(z,A);return v&&v.materials&&v.materials.length?v.materials[0]:null}});return g});define("DS/VCXWebModifiablesImpl/VCXModifiableCommandManager",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueInt"],function(b,f,c,d,e){var a=b.extend({init:function(){this._parent()},GetStackSize:function(){return this.GetObject().GetStackMaxSize()},OnChangeProperty:function(h,g){if(h==="CommandManager.maxSize"){this.GetObject().SetStackMaxSize(g.GetValue())}else{console.log("property not found!");return false}return true},GetProperty:function(h){var g=null;if(h==="CommandManager.maxSize"){var i=new e();i.SetValue(this.GetStackSize());g=new c(new d(h,2),i)}return g},GetProperties:function(){var g=new f();g.AddOrModifyProperty(this.GetProperty("CommandManager.maxSize"));return g}});return a});define("DS/VCXWebModifiablesImpl/VCXModifiableScenario",["DS/CoreEvents/Events","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueInt","DS/WebRBTree/WebRBIterator"],function(d,e,g,o,b,l,h,c,k,a,f,i,m,j){var n=e.extend({init:function(){this._parent()},OnChangeProperty:function(q,p){if(q==="Actor.Name"){this.GetObject().SetName(p.GetValue())}else{if(q==="Actor.DocID"){this.GetObject().SetDocId(p.GetValue())}else{if(q==="Scenario.Partial"){this.GetObject().SetApplyNeutralAtGoToScenario(!p.GetValue())}else{if(q==="Scenario.ZoomFitAll"){this.GetObject().SetZoomFitAll(p.GetValue())}else{if(q==="Actor.Scenario.Type"){this.GetObject().SetScenarioType(p.GetValue())}else{if(q==="Actor.Scenario.Markers"){}else{if(q==="Scenario.bIsLoop"){this.GetObject().SetIsLoop(p.GetValue())}else{if(q==="Scenario.bIsBounce"){this.GetObject().SetIsBounce(p.GetValue())}else{if(q==="Scenario.bIsReverse"){this.GetObject().SetIsReverse(p.GetValue())}else{if(q==="Scenario.Speed"){this.GetObject().SetSpeed(p.GetValue())}else{if(q==="Scenario.Visibility.Mode"){this.GetObject().GetVisibility().SetMode(p.GetValue())}else{var r=this._parent(q,p);if(!r){console.log("property not found : '"+q+"'")}return r}}}}}}}}}}}return true},GetProperty:function(u){var v=null;if(u==="Actor.Name"){var C=new o();C.SetValue(this.GetObject().GetName());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),C)}else{if(u==="Actor.DocID"){var B=new k();B.SetValue(this.GetObject().GetDocId());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),B);v.GetPropertyInfo().SetVisible(false)}else{if(u==="Scenario.Partial"){var A=new a();A.SetValue(!this.GetObject().GetApplyNeutralAtGoToScenario());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Scenario.ZoomFitAll"){var A=new a();A.SetValue(this.GetObject().GetZoomFitAll());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Scenario.bIsLoop"){var A=new a();A.SetValue(this.GetObject().GetIsLoop());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Scenario.bIsBounce"){var A=new a();A.SetValue(this.GetObject().GetIsBounce());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Scenario.bIsReverse"){var A=new a();A.SetValue(this.GetObject().GetIsReverse());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Scenario.Speed"){var A=new m();A.SetValue(this.GetObject().GetSpeed());v=new l(new h(u,2,true,"VCXWebModifiables/VCXWebModifiables"),A)}else{if(u==="Actor.Scenario.Type"){var x=new b();x.SetValue(this.GetObject().GetScenarioType());var r=new c(u,2,true,"VCXWebModifiables/VCXWebModifiables");var s={0:"scenario.type.scenario",1:"scenario.type.layer",2:"scenario.type.CADViews",3:"scenario.type.CADCaptures"};r.SetMapChoiceEnum(s);r.SetVisible(false);v=new l(r,x)}else{if(u==="Actor.Scenario.Markers"){var t=new f();var q=this.GetObject().GetTrackMarkers();if(q){var w=0;var F=q._treekeys;var z=new j(F);var D=z.next();while(D!==null){var E=D.GetValue();var p=new i();p.SetValue(E);t.SetValueAtIndex(w,p);w++;D=z.next()}}var y=new h(u,2,true,"VCXWebModifiables/VCXWebModifiables");y.SetVisible(false);v=new l(y,t)}else{if(u==="Scenario.Visibility.Mode"){var x=new b();x.SetValue(this.GetObject().GetVisibility().GetMode());var r=new c(u,2,true,"VCXWebModifiables/VCXWebModifiables");var s={0:"scenario.mode.setboth",1:"scenario.mode.setvisible",2:"scenario.mode.setinvisible",};r.SetMapChoiceEnum(s);v=new l(r,x)}else{v=this._parent(u)}}}}}}}}}}}return v},GetProperties:function(){var p=new g();p.AddOrModifyProperty(this.GetProperty("Actor.Name"));p.AddOrModifyProperty(this.GetProperty("Actor.DocID"));p.AddOrModifyProperty(this.GetProperty("Scenario.Partial"));p.AddOrModifyProperty(this.GetProperty("Scenario.ZoomFitAll"));p.AddOrModifyProperty(this.GetProperty("Actor.Scenario.Type"));p.AddOrModifyProperty(this.GetProperty("Actor.Scenario.Markers"));p.AddOrModifyProperty(this.GetProperty("Scenario.bIsLoop"));p.AddOrModifyProperty(this.GetProperty("Scenario.bIsBounce"));p.AddOrModifyProperty(this.GetProperty("Scenario.bIsReverse"));p.AddOrModifyProperty(this.GetProperty("Scenario.Speed"));p.AddOrModifyProperty(this.GetProperty("Scenario.Speed"));p.AddOrModifyProperty(this.GetProperty("Scenario.Visibility.Mode"));return p}});return n});define("DS/VCXWebModifiablesImpl/VCXModifiableDocManager",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueInt"],function(a,f,b,d,e){var c=a.extend({init:function(){this._parent()},GetDefaultImageIdx:function(){return this.GetObject().GetDefaultImageIndex()},OnChangeProperty:function(h,g){if(h==="DocManager.defaultIndex"){this.GetObject().SetDefaultImageIndex(g.GetValue())}else{console.log("property not found!");return false}return true},GetProperty:function(h){var g=null;if(h==="DocManager.defaultIndex"){var i=new e();i.SetValue(this.GetDefaultImageIdx());g=new b(new d(h,2),i)}return g},GetProperties:function(){var g=new f();g.AddOrModifyProperty(this.GetProperty("DocManager.defaultIndex"));return g}});return c});define("DS/VCXWebModifiablesImpl/VCXModifiableCamera",["DS/VCXWebModifiables/VCXModifiable","DS/Visualization/ThreeJS_DS","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueFrame","DS/VCXWebTracks/VCXInterpolator","DS/VCXWebTracks/VCXInterpolatorCubic"],function(c,h,i,g,b,f,a,j,e,d){var k=c.extend({init:function(){this._parent();this._interpolationType=e.EInterpolationType.Linear;this._interpolatorCubic=new d()},OnChangeProperty:function(o,m){var u=this._parent(o,m);if((o==="Viewpoint.Position")){var t=m.Clone();var s=t.GetValue();if((typeof s!=="undefined")&&(s!==null)){this._currentMatrix=s;var p=s.decompose();var r=p[0];var q=p[1];var n=this.GetObject()._experienceBase.getManager("VCXContextManager").getMainViewer().getViewpoints()[0];n.moveTo({eyePosition:r,upDirection:new h.Vector3(0,1,0).applyQuaternion(q),sightDirection:new h.Vector3(0,0,-1).applyQuaternion(q),duration:0})}u=true}else{if(o==="Viewpoint.InterpolationType"){var l=m.GetValue();if(typeof bInter!=="undefined"){this._interpolationType=l}u=true}}return u},GetInterpolator:function(l){if(l==="Viewpoint.Position"&&this._interpolationType===e.EInterpolationType.Cubic){return this._interpolatorCubic}return null},GetProperty:function(p){var n=this.GetObject()._experienceBase.getManager("VCXContextManager").getMainViewer().getViewpoints()[0];var r=null;if(p==="Viewpoint.Position"){var o=n.getControl();var m=new h.Vector3(0,0,1);m.applyQuaternion(o.orientation);m.setLength(o.distanceToTarget);var q=new h.Vector3().addVectors(o.target,m);var l=new h.Vector3(1,1,1);var t=new h.Matrix4();t.compose(q,o.orientation,l);var s=new j();s.SetValue(t);r=new i(new g(p,0,true,"VCXWebModifiables/VCXWebModifiables"),s)}else{if(p==="Viewpoint.InterpolationType"){var u=new a();u.SetValue(this._interpolationType);r=new i(new b(p,0,true,"VCXWebModifiables/VCXWebModifiables"),u)}}return r},GetProperties:function(){var l=new f();l.AddOrModifyProperty(this.GetProperty("Viewpoint.Position"));l.AddOrModifyProperty(this.GetProperty("Viewpoint.InterpolationType"));return l}});return k});