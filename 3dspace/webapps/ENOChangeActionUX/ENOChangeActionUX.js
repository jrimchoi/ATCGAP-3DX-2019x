define("DS/ENOChangeActionUX/scripts/Models/CAMemberModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(c,a){var b=c.extend({idAttribute:"id",setup:function(){var d=this;this.addEvent("onChange:role",function(f){var e=d.convertRoleToNlsRole(f.get("role"));f.set("rolesToDisplay",e)})},fetch:function(d){console.log("fetch called")},parse:function(h){var e={};var g=this;e.rolesToDisplay="";e.userName=h.name;var i=this.get("role");if(i===undefined){e.role=h.role}else{if(i!=""){e.role=i+", "+h.role}}e.rolesToDisplay=this.convertRoleToNlsRole(h.role);e.fullName=h.fullName;e.id=h.id;e.type=h.type;var f=e.role.split(", ");var d=f.indexOf("reviewer");if(d>=0){enoviaServerCAWidget.reviewerType.typeOfReviewer=e.type}return e},convertRoleToNlsRole:function(h){var g="";var f="";var e=this.get("rolesToDisplay");if(e===undefined){e=""}if(h.indexOf("owner")>=0){g=a.ECM_CA_Team_Owner;if(e!=""){var d=e.indexOf(g);if(d<0){e=f=e+", "+g}else{f=e}}else{e=f=g}}if(h.indexOf("contributor")>=0){g=a.ECM_CA_Team_AddMembers_Assignee;if(e!=""){var d=e.indexOf(g);if(d<0){e=f=e+", "+g}else{f=e}}else{e=f=g}}if(h.indexOf("reviewer")>=0){g=a.ECM_CA_Team_AddMembers_Reviewer;if(e!=""){var d=e.indexOf(g);if(d<0){e=f=e+", "+g}else{f=e}}else{e=f=g}}if(h.indexOf("follower")>=0){g=a.ECM_CA_Team_AddMembers_Follower;if(e!=""){var d=e.indexOf(g);if(d<0){e=f=e+", "+g}else{f=e}}else{e=f=g}}return f},});return b});define("DS/ENOChangeActionUX/scripts/Views/CATempAutocomplete",["UWA/Core","UWA/Event","UWA/String","DS/W3DXComponents/Views/Temp/DeprecatedAutocomplete","DS/UIKIT/Spinner","WebappsUtils/WebappsUtils","i18n!DS/W3DXComponents/assets/nls/Views/Temp/TempAutocomplete","css!DS/W3DXComponents/W3DXComponents"],function(j,f,b,h,d,c,k){var i=h.extend({_prevText:"",_suggestsIndex:0,defaultOptions:{attributes:{type:"autocomplete"},className:"temp-autocomplete"},resizeSuggests:function(){return},init:function(l){this._parent(l);l=l||{};this.collection=(l.collection)?l.collection:null;this.getSuggestions=l.getSuggestions||this.getSuggestions;this.suggestDistinction=l.suggestDistinction||this.suggestDistinction},attachEvents:function(){this._parent.apply(this,arguments);var l=this.elements;l.input.addEvent("keydown",this.onKeyDown.bind(this))},getId:function(){return this.elements.input.id},getName:function(){return this.elements.input.name},getFormattedLabel:function(l){return this.options.labelFormat.replace(/\{(\w+)\}/g,function(o,p){var n=UWA.is(l,"string")?l:l[p];return n})},suggestDistinction:function(l){return false},successProcess:function(m,n){m=UWA.is(m,"string")?this.dataParse(m):m;if(m.length===0&&this.options.onEmailAddress){if(b.isEmail(n)){var l=this.options.onEmailAddress(n);if(l){m=[l]}}}if(m.length>0){this.dataCache[n]=m}this.dispatchEvent("onUpdateSuggests",[m]);this.elements.spin.hide();this.typeTimeout=null},onUpdateSuggests:function(q){var s=this,r,y,x,w=this.elements,l;w.suggests.empty();if(Array.isArray(q)&&q.length>0){var o=function(){var C=function(D){var E=s.options.suggestKey?D[s.options.suggestKey]:b.stripTags(s.getFormattedSuggest(D));s.elements.input.set({"data-key":E});s.dispatchEvent("onSelect",[E,D,l])}.bind(this,A);var B=navigator.userAgent.match(/(iPhone|iPad|iPod)/g)?true:false;if(B){y.addEvent("touchstart",C)}else{y.addEvent("click",C);y.addEvent("mouseover",function(E){var D=f.getElement(E);if(w.suggests.getElement(".selected")){w.suggests.getElement(".selected").removeClassName("selected")}if(D&&D.parentNode){D.parentNode.addClassName("selected")}})}};var v=Math.min(q.length,8);for(var p=0;p<v;p++){var A=q[p];var t=this.getFormattedSuggest(A);l=this.suggestDistinction(A);t=l?t+" ("+l+")":t;if(this.options.suggestKey){this.itemCache[A[this.options.suggestKey].toLowerCase()]=A}r=UWA.createElement("li");y=UWA.createElement("a").inject(r);var n,u;n=u="";if(A.type==="Person"){n=c.getWebappsAssetUrl("ENOChangeActionUX","images/Default_People.png");u="/snresources/images/icons/small/I_ENOVIA_RscPerson.bmp"}else{if(A.type==="Route Template"){n=c.getWebappsAssetUrl("ENOChangeActionUX","images/Default_People.png");u="/snresources/images/icons/small/iconSmallRouteTemplate.gif"}}var m=enoviaServerCAWidget.computeUrl(u);var z="<img src= "+m+">";y.setHTML('<div class = "suggest-img-label">'+z+'<div class="item-label">'+t+"</div></div>");r.inject(w.suggests);if(l){r.addClassName("distinct");if(this.options.unlockDistinctClick){o()}else{r.addClassName("locked")}}else{o()}}x=this.elements.suggests.getElement("li:not(.locked)");if(x){x.addClassName("selected")}s._suggestsIndex=0;this.resizeSuggests()}else{r=UWA.createElement("li");y=UWA.createElement("a").inject(r);y.setHTML(k.NoResults);r.inject(w.suggests);r.addClassName("error-suggest")}this.dispatchEvent("onShowSuggests")},getFocus:function(m,l){this.elements.input.focus();if(m.categoryId==="reviewer"&&m.type==="Route Template"&&l===true){this.elements.input.readOnly=true}else{this.elements.input.readOnly=false}},onSelect:function(l,m){if(m){this.elements.input.value=this.getFormattedLabel(m);this.resetInput();this.onHideSuggests();setTimeout(function(){this.getFocus(m,true)}.bind(this),100)}},onBlur:function(l){setTimeout(function(){this.dispatchEvent("onHideSuggests")}.bind(this),200)},onFocus:function(m){var o=this,n=this.elements,l=f.getElement(m);if(n.input.value===this.options.placeholder){n.input.value=""}this.getSuggestions(l.value,this.dataCache,function(p){o.successProcess(p,l.value)});this.dispatchEvent("onFocused",m)},onShowSuggests:function(){var l=this.elements;if(l.input.value.length>0){l.container.addClassName(this.options.className+"-suggestsDisplayed")}},onKeyDown:function(p){var o=this;var n=o.elements.suggests.getElements("li:not(.locked)");var m=n[o._suggestsIndex];function l(r){var q=o._suggestsIndex+r;if(n[q]){m.removeClassName("selected");o._suggestsIndex=q;n[q].addClassName("selected")}}if(o.elements.container.hasClassName(this.options.className+"-suggestsDisplayed")){switch(p.code){case"Escape":o.onHideSuggests();break;case"ArrowDown":l(1);break;case"ArrowUp":l(-1);break;case"Enter":case"NumpadEnter":if(m&&m.getElement("a")){m.getElement("a").triggerEvent("click")}break;default:return}f.stop(p)}else{if(p.code==="ArrowDown"){o.onShowSuggests()}}},onKeyUp:function(m){var o=this;var l=this.elements.input;var n=l.value;if(n===this._prevText){return}else{if(n.trim().length===0){this.resetInput();this.onHideSuggests();this.typeTimeout=null;return}else{this._prevText=n;l.removeAttribute("data-key");if(n.length>=this.options.minLength){clearTimeout(this.typeTimeout);this.showSpin();this.typeTimeout=setTimeout(function(){this.getSuggestions(n,this.dataCache,function(p){o.successProcess(p,n)})}.bind(this),this.options.typeDelay)}}}},resetInput:function(m){this.elements.input.value="";this._prevText="";var l=document.createEvent("HTMLEvents");l.initEvent("change",false,true);this.elements.input.dispatchEvent(l);if(m){this.resetCache()}},showSpin:function(){var m,l=this.elements;l.suggests.empty();this.elements.spin.show();m=UWA.createElement("li");m.addClassName("li-spinner");this.elements.spin.inject(m);m.inject(l.suggests);this.dispatchEvent("onShowSuggests")},buildSkeleton:function(){this._parent.apply(this,arguments);if(this.options.id){this.elements.input.id=this.options.id}if(this.options.name){this.elements.input.name=this.options.name}if(this.options.attributes){this.elements.input.set(this.options.attributes)}this.elements.spin=new d({className:"small"});new a(this.elements.input,this.options.container)}});var g,e;g=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"];e=20;function a(m,l){var r;function n(){if(window.getComputedStyle){return window.getComputedStyle(m)}return m.currentStyle}function p(){return l}function t(){var w,v,u;w=n();for(u=0;u<g.length;u++){v=w[g[u]];if(v!==undefined&&v!==null){r.style[g[u]]=v}}r.disabled="disabled";r.style.whiteSpace="pre";r.style.position="absolute";r.style.top=r.style.left="-9999em"}function q(){var v,u;v=m.value||"";if(v===r.value){return}r.setText(v);u=r.offsetWidth+e;if(l&&l.offsetWidth){u=(l.offsetWidth>r.offsetWidth)?r.offsetWidth:l.offsetWidth-4}m.style.width=u+"px"}function o(u){var v;v=u?"remove":"add";m[v+"Event"]("keydown",q);m[v+"Event"]("keyup",q);m[v+"Event"]("input",q);m[v+"Event"]("paste",q);m[v+"Event"]("change",q)}function s(){o(true);r.destroy();m.style.width=""}r=j.createElement("span");document.body.appendChild(r);t();o();q();return{remap:t,refresh:q,destroy:s}}return i});define("DS/ENOChangeActionUX/scripts/Models/CAContextModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/WebappsUtils/WebappsUtils"],function(d,b,c){var a=d.extend({idAttribute:"id",parse:function(g){var e="Cannot be found";var h="Access denied";var f={};f.Access=true;f.namePref=(enoviaServerCAWidget.NamePref=="Name")?true:false;f.titlePref=(enoviaServerCAWidget.NamePref=="Name")?false:true;f.maturityField=b.ECM_CA_Table_Header_Maturity+":";f.ownerField=b.ECM_CA_Table_Header_Owner+":";f.current=UWA.is(g.info.currentNLS)?g.info.currentNLS:g.info.current;f.type=UWA.is(g.info.typeNLS)?g.info.typeNLS:g.info.type;f.objectType=g.info.type;f.revision=g.info.revision;f.image=c.getWebappsAssetUrl(enoviaServerCAWidget.frameWorkName,"images/iconLargeDefault.png");f.id=g.id;f.objectName=g.info["display name"];f.objectTitle=g.info["display name"];if(f.current==""||f.current==e||f.current==h||f.current==undefined){f.Access=false}return f}});return a});define("DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(g,a,b,e,f,d){var c=a.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSwitchView_"+this.cid},setup:function(h){this._parent.apply(this,arguments)},render:function(){this.container.empty(true);var l=this;if(this.toggleDiv){this.toggleDiv.destroy()}this.toggleDiv=g.createElement("div",{"class":"proposed-toggle",html:[{tag:"h5",html:d.ECM_CA_Proposed_Object_Add,styles:{"margin-right":"10px",}}]});if(this.existingBtn||this.newBtn){if(this.existingBtn){this.existingBtn.destroy()}if(this.newBtn){this.newBtn.destroy()}}var k=this.existingBtn=new b({value:d.ECM_CA_Proposed_Object_Add_Existing,id:"Existing",active:true});var m=this.newBtn=new b({value:d.ECM_CA_Proposed_Object_Add_New,id:"New"});if(l.model.get("createNewToggle")==="TRUE"){k.setClassName("small");m.setClassName("primary small")}else{k.setClassName("primary small");m.setClassName("small")}var j=[k,m];var i=new e({type:"radio",name:"toggle-proposed",id:"toggle-proposed",buttons:j,events:{onClick:function(o,n){this.dispatchEvent("onButtonClick",n)}}});var h=this.ButtonEvents={onButtonClick:function(n){if(n.getId()==="Existing"){l.model.set("createNewToggle","FALSE")}else{l.model.set("createNewToggle","TRUE")}}};this.listenTo(i,h);i.inject(this.toggleDiv);this.toggleDiv.inject(this.container);return this},destroy:function(){this._parent.apply(this,arguments)}});return c});define("DS/ENOChangeActionUX/scripts/Views/CACustomContextTileView",["UWA/Core","UWA/Utils","DS/Handlebars/Handlebars","DS/W3DXComponents/Views/Item/TileView",],function(e,c,d,b){var a=b.extend({name:"CACustomContextTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-Context-{{id}}">                                    <label class="control-label" for="checkbox-Context-{{id}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" {{#if Access}} draggable="true"{{/if}}>                                  <div class="'+this.getClassNames("-header")+'">                                    {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                  </div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      {{#if namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectName}}}&nbsp;{{{revision}}}">{{{objectName}}}&nbsp;{{{revision}}}</div>{{/if}}									  {{#unless namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectTitle}}}&nbsp;{{{revision}}}">{{{objectTitle}}}&nbsp;{{{revision}}}</div>{{/unless}}                                      {{#if titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectName}}}">{{{objectName}}}</div>{{/if}}									  {{#unless titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectTitle}}}">{{{objectTitle}}}</div>{{/unless}}                                     <div class="'+this.getClassNames("-content")+'">										{{#if current}}<div class="'+this.getClassNames("-Maturity")+'" title="{{{maturityName}}}">											<table>												<tr>													<td class="'+this.getClassNames("-maturityField")+'">{{{maturityField}}}</td>													<td class="'+this.getClassNames("-maturityValue")+'">&nbsp;{{{current}}}</td>												</tr>											</table>										</div>{{/if}}										{{#if ownerFullname}}<div class="'+this.getClassNames("-Owner")+'" title="{{{ownerFullname}}}">										<table>												<tr>													<td class="'+this.getClassNames("-ownerField")+'">{{{ownerField}}}</td>													<td class="'+this.getClassNames("-onwerValue")+'">&nbsp;{{{ownerFullname}}}</td>												</tr>											</table>										</div>{{/if}}									</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                      </div>                                    </div>                                </div>                            </div>                      '}});return a});define("DS/ENOChangeActionUX/scripts/CAWebInWinTaggerProxy",["DS/SNResultUX/webinwin/WebInWinTaggerProxy","UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/SNInfraUX/SearchCom"],function(d,g,b,f,a,e){var c=d.extend(f,a,{_proxyId:"ChangeAction_Facet_",init:function(h){this._parent.call(this,h)},_dispatchEvent:function(i){if(!g.is(i,"object")||!g.is(i.notif_name)||undefined===i.notif_parameters){console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!");throw ("No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !")}console.log("ResultWebInWin._dispathTowin for "+i.notif_name);var h=g.is(i.notif_parameters,"string")?i.notif_parameters:JSON.stringify(i.notif_parameters);if(typeof dscef!=="undefined"){dscef.sendString(i.notif_name+"="+h)}else{if(typeof CATCefSendString!=="undefined"){CATCefSendString(i.notif_name+"="+h)}}},});return c});define("DS/ENOChangeActionUX/scripts/Search",["DS/ENO6WPlugins/jQuery","UWA/Core","UWA/Utils/InterCom","UWA/Class/Model"],function(c,e,b,d){var a=function(h,g){if(h&&h.precond){this.precond=h.precond}if(h&&h.excludeList){this.excludeList=h.excludeList}if(h&&h.from==="realized"){this.fromRealized=true}this.socketName="search_socket_"+(new Date()).getTime();this.socket=new b.Socket(this.socketName,{dispatchRetryInterval:5});this.socket.subscribeServer("SearchComServer");this.listener=this.objectsSelected.bind(this);this.socket.addListener("Selected_Objects_search",this.listener);var f=this.options(h);if(g){f.idcard_activated=true}this.socket.dispatchEvent("RegisterContext",f)};a.prototype.destroy=function(){var f={};f.widget_id=enoviaServer.widgetId;this.socket.dispatchEvent("unregisterSearchContext",f);this.socket.unsubscribeServer("SearchComServer");this.socket.removeListener("Selected_Objects_search",this.listener);this.socket.disconnect()};a.prototype.options=function(h,k,g,l,f,i){var j={};j.multiSel=false;j.title=h.title;j.mode="furtive";j.app_socket_id=this.socketName;j.widget_id=enoviaServer.widgetId;j.default_with_precond=true;j.show_precond=false;j.idcard_activated=false;j.select_result_max_idcard=false;j.source=["3dspace"];j.tenant=enoviaServer.tenant;j.role=enoviaServer.role;if(h.types){j.precond="(";g=h.types.split(",");c.each(g,function(m,n){if(m!==0){j.precond+=" OR "}j.precond+='flattenedtaxonomies:"types/'+n.trim()+'"'});j.precond+=")"}if(h.default_search_criteria){j.default_search_criteria=h.default_search_criteria}return(j)};a.prototype.activate=function(m,n,i,g,o,k,j){var h=this;if(enoviaServerCAWidget.isNative){if(this.fromRealized===true){require(["DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/CAUtility"],function(r,s){r._tempReferenceToWinSearchCallback=m.callback;var q="SearchCA";s.DispatchEventToWin(q,h.precond)})}else{require(["DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/CAUtility"],function(r,s){if(m&&m.callback){r._tempReferenceToWinSearchCallback=m.callback}var q="Add_Proposed";s.DispatchEventToWin(q,"NewProposedChange")})}}else{if(enoviaServerCAWidget.is3DSpace){window.addEventListener("storage",function(q){if(q.storageArea===sessionStorage){if(sessionStorage.searchList!=undefined&&sessionStorage.searchList!=""){var r=sessionStorage.searchList.split(",");a._tempReferenceTo3DSpaceSearchCallback(r);sessionStorage.removeItem("searchList")}else{console.log("inside EVENT ******************************************")}}});var l="../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction:ECM_CHANGE_ONHOLD!=True:CURRENT=policy_ChangeAction.state_Prepare,policy_ChangeAction.state_InWork&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency";showChooser(l,850,630);a._tempReferenceTo3DSpaceSearchCallback=m.callback}else{var p=this.options(m);if(!e.is(m.callback,"function")){p.mode="default"}if(m&&m.callback){this.callback=m.callback}var f={};f.widget_id=enoviaServer.widgetId;this.socket.dispatchEvent("unregisterSearchContext",f);this.socket.dispatchEvent("RegisterContext",p);this.socket.dispatchEvent("InContextSearch",p)}}};a.prototype.isAvailable=function(){return(e.is(this.socket))};a.prototype.objectsSelected=function(k){var f=[];if(this.callback){for(var j=0;j<k.length;j++){var h=[];var g=new d(k[j]);f.push(g.get("id"))}this.callback(f)}};return(a)});define("DS/ENOChangeActionUX/scripts/Models/CAReferentialModel",["UWA/Class/Model","DS/WebappsUtils/WebappsUtils"],function(c,b){var a=c.extend({idAttribute:"id",parse:function(f){var d="Cannot be found";var g="Access denied";var e={};e.Access=true;e.namePref=(enoviaServerCAWidget.NamePref=="Name")?true:false;e.titlePref=(enoviaServerCAWidget.NamePref=="Name")?false:true;e.type=UWA.is(f.info.typeNLS)?f.info.typeNLS:f.info.type;e.objectType=f.info.type;e.revision=f.info.revision;e.image=b.getWebappsAssetUrl(enoviaServerCAWidget.frameWorkName,"images/iconLargeDefault.png");e.id=f.id;e.current=UWA.is(f.info.currentNLS)?f.info.currentNLS:f.info.currentNLS;e.objectName=f.info["display name"];e.objectTitle=f.info["display name"];if(e.current==""||e.current==d||e.current==g||e.current==undefined){e.Access=false}return e}});return a});define("DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Input/Button","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel"],function(a,i,d,g,f,c,h,b){var e=a.extend({slideinContainer:"",skeletonContainer:"",setup:function(){this.slideinContainer=g.extendElement(document.body).getElement("#slidein-container");this.skeletonContainer=g.extendElement(document.body).getElement("#skeleton-container");this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(l){if(UWA.is(this.slideinContainer)&&UWA.is(l)){this.form=l;var j=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});j.setAttribute("data-rec-id","slideInContentCA");this.getHeader().inject(j);this.getBody().inject(j);this.getFooter().inject(j);l.slideInReference=this;j.inject(this.slideinContainer);var k=this;widget.addEvent("onResize",function(){setTimeout(function(){if(k.slideinContainer.clientWidth>0){var m=window.matchMedia("(max-width: 768px)");if(m.matches){k.slideinContainer.style.width="100%"}else{k.slideinContainer.style.width="300px"}}},100)})}},getHeader:function(){var k=this.form.getHeading();var j=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%",marginRight:"50px"},html:{tag:"h5",html:k}}]});j.setAttribute("data-rec-id","slideInHeaderCA");return j},getFooter:function(){var k=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:{tag:"div",html:this.form.getFooter()}});k.setAttribute("data-rec-id","slideInFooterRowCA");var j=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:k});j.setAttribute("data-rec-id","slideInFooterCA");return j},getBody:function(){var j=UWA.createElement("div",{id:"slideInBody"});j.setAttribute("data-rec-id","slideInBodyCA");this.form.getBody().inject(j);return j},showSlideIn:function(){if(UWA.is(this.slideinContainer)){var j=window.matchMedia("(max-width: 768px)");if(j.matches){this.slideinContainer.style.width="100%"}else{this.slideinContainer.style.width="300px"}this.slideinContainer.style.borderLeftWidth="1px";this.skeletonContainer.style.opacity=".5";this.skeletonContainer.style.pointerEvents="none"}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){this.slideinContainer.innerHTML="";this.slideinContainer.style.width="0";this.slideinContainer.style.borderLeftWidth="0";this.skeletonContainer.style.opacity="1";this.skeletonContainer.style.pointerEvents="inherit"}}});return e});define("DS/ENOChangeActionUX/scripts/Views/CATeamFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/Handlebars/Handlebars",],function(d,a,c,b){var e=d.extend({name:"teamfilter",tagName:"div",className:"teamview",setup:function(){this.template='                                                <div class="'+this.getClassNames("-role-filter")+'">                                                    <table class="filter-table table">                                                        <tr >                                                            <td class="font-3dsregular">'+a.ECM_CA_Team_Filter_byName+'</td>                                                            <td>                                                                <div class="filter-input">                                                                    <input type="text" placeholder="'+a.ECM_CA_Team_SearchTeamMembers_PlaceHolder+'" class="form-control form-control-root filtertext">                                                                    <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                                </div>                                                            </td>                                                        </tr>                                                        <tr >                                                            <td class="font-3dsregular">'+a.ECM_CA_Team_Filter_byRoles+'</td>                                                            <td class="teamview-filter toggle-primary font-3dsregular">                                                                <div class="toggle-container toggle-filter-view">                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="assigneeToggle" class="roleFilter">                                                                        <label class="control-label" for="assigneeToggle">'+a.ECM_CA_Team_Filter_Assignees+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="revMemToggle" class="roleFilter">                                                                        <label class="control-label" for="revMemToggle">'+a.ECM_CA_Team_Filter_Reviewers+'</label>                                                                    </div>                                                                    <div class="toggle toggle-root">                                                                        <input type="checkbox" value="option1" id="followMemToggle" class="roleFilter">                                                                        <label class="control-label" for="followMemToggle">'+a.ECM_CA_Team_Filter_Followers+"</label>                                                                    </div>                                                                </div>                                                            </td>                                                        </tr>                                                    </table>                                                </div>";this.renderer=this.getTemplate(this.template)},init:function(f){f=c.clone(f||{},false);this._parent.call(this,f)},render:function(){var h=this.name;var i=this.cid;this.container.empty();containerReference=this.container;var g=UWA.createElement("div",{"class":"teamview-role-filter",styles:{height:"10%","padding-bottom":"10px",}});var f=this.renderer();g.addContent(f);g.inject(containerReference);return this},injectSubView:function(h,f){var g=this.container.getElement(f);if(h&&g){g.grab(h.render().getContent())}},getTemplate:function(g){var f=b.compile(g);var h=this;h.data={placeholder:h.options.placeholder};return function(){return f(h.data)}},domEvents:{"keyup .filtertext":function(g){var f=g.target.value;var h=this.container.getElement(".clear-filter");if(f.length>0){h.setStyle("visibility","visible")}else{h.setStyle("visibility","hidden")}this.dispatchEvent("memberFilterKeyUp",arguments)},"click .clear-filter":function(i){var j=this.container.getElement(".clear-filter");j.setStyle("visibility","hidden");var h=this.container.getElement(".filtertext");if(h){h.value="";var g=""}var f={target:{value:"",}};this.dispatchEvent("memberFilterKeyUp",f)},"focus .filtertext":function(){var f=document.getElementsByClassName("searchfiler-input-container");f.addClassName("highlighted-border");f.removeClassName("border-without-focus")},"click .roleFilter":function(){this.dispatchEvent("memberRoleFilter",arguments)}},});return e});define("DS/ENOChangeActionUX/scripts/Views/CASlideInPropertiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Input/Button","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel"],function(b,i,e,g,f,d,h,c){var a=b.extend({slideinContainer:"",skeletonContainer:"",setup:function(){this.slideinContainer=g.extendElement(document.body).getElement("#slidein-container");this.skeletonContainer=g.extendElement(document.body).getElement("#skeleton-container");this.resizerContainer=g.extendElement(document.body).getElement("#layout-resizer-div");this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(p){var o=[h.FACET_PROPERTIES,h.FACET_ACTIVITY];var m=this;var n=m.editPropertiesView=new d({typeOfDisplay:h.ALL,selectionType:h.NO_SELECTION,setCloseButton:true,readOnly:true,extraNotif:true,collapseTabs:true,editMode:true,actions:[{name:"action_close_panel",text:i.ECM_CA_Close,icon:"close",handler:function(){m.hideSlideIn(false)}}]});var k=p;var q=[];var l=new c({tenant:enoviaServerCAWidget.tenant,objectId:k});q.push(l);var m=this;setTimeout(function(){n.initDatas(q);n.centerIt();widget.addEvent("onResize",function(){setTimeout(function(){if(m.slideinContainer.clientWidth>0){var r=window.matchMedia("(max-width: 768px)");if(r.matches){m.slideinContainer.style.width="100%";m.resizerContainer.style.right="100%"}else{m.slideinContainer.style.width="545px";m.resizerContainer.style.right="540px"}}n.onResize()},100)})},500);var j=UWA.createElement("div",{id:"slideInPropertiesContent",styles:{height:"100%",width:"100%"}});n.inject(j);j.inject(this.slideinContainer)},getBody:function(){},showSlideIn:function(){if(UWA.is(this.slideinContainer)){var j=window.matchMedia("(max-width: 768px)");if(j.matches){this.slideinContainer.style.width="100%";this.resizerContainer.style.right="100%"}else{this.slideinContainer.style.width="545px";this.resizerContainer.style.right="540px"}this.slideinContainer.addClassName("add-width");this.slideinContainer.style.borderLeftWidth="1px";this.skeletonContainer.style.opacity=".5";this.skeletonContainer.style.pointerEvents="none"}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){this.slideinContainer.innerHTML="";this.slideinContainer.style.width="0";this.resizerContainer.style.right="0px";this.slideinContainer.style.borderLeftWidth="0";this.skeletonContainer.style.opacity="1";var j="calc( 100% - 0px )";this.skeletonContainer.setStyle("width",j);this.skeletonContainer.style.pointerEvents="inherit"}}});return a});define("DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars",],function(e,a,f,d,c){var b=e.extend({name:"searchfilter",tagName:"div",className:"operations-filter",setup:function(){this.template='                                                <div class="'+this.getClassNames("-container")+'">                                                  <div class="'+this.getClassNames("-sub-container")+'">                                                    <div class="'+this.getClassNames("-input-container")+' border-without-focus">                                                      <input type="text" class="form-control form-control-root filtertext" placeholder="{{placeholder}}">                                                      <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                      <span class="search-span"><i id="filtersearch" class="fonticon fonticon-search"></i></span>                                                    </div>                                                  </div>                                                </div>';this.renderer=this.getTemplate(this.template)},init:function(g){g=d.clone(g||{},false);this._parent.call(this,g)},render:function(){var i=this.name;var k=this.cid;this.container.empty();var j=this.container;var h=UWA.createElement("div",{"class":"search-main-container hidden",styles:{width:"99.5%",height:"10%",}});h.setAttribute("data-rec-id","search-main-container-CA");var g=this.renderer();h.addContent(g);h.inject(j);return this},injectSubView:function(i,g){var h=this.container.getElement(g);if(i&&h){h.grab(i.render().getContent())}},getTemplate:function(h){var g=c.compile(h);var i=this;i.data={placeholder:i.options.placeholder};return function(){return g(i.data)}},domEvents:{"keyup .filtertext":function(h){var g=h.target.value;var i=this.container.getElement(".clear-filter");if(g.length>0){i.setStyle("visibility","visible")}else{i.setStyle("visibility","hidden")}this.dispatchEvent("keyup",arguments)},"click .clear-filter":function(j){var k=this.container.getElement(".clear-filter");k.setStyle("visibility","hidden");var i=this.container.getElement(".filtertext");if(i){i.value="";var h=""}var g={target:{value:"",}};this.dispatchEvent("keyup",g)},"focus .filtertext":function(){var g=document.getElementsByClassName("searchfiler-input-container");g.addClassName("highlighted-border");g.removeClassName("border-without-focus")},},});return b});define("DS/ENOChangeActionUX/scripts/Views/CACustomizedRefActionsView",["UWA/Class/View","DS/UIKIT/Iconbar","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(d,a,b){var c=d.extend({name:"refActionsView",tagName:"div",className:"actionsDiv",init:function(e){this._parent.call(this,e)},setup:function(){},render:function(){var f=this.name;this.container.empty();this.containerReference=this.container;var e=new UWA.Element("div");e.setAttributes({id:"DivForRefActionsView"});e.setStyle("height","100%");this.buildIconBar(e);e.inject(this.containerReference);return this},buildIconBar:function(e){var g=this;var f=this.iconbar=new a({renderTo:e,items:[{id:"add",text:b.ECM_CA_Add_Referential,fonticon:"plus",overflow:false,selectable:false,handler:function(){var h=g.collection.findWhere({id:"add"});g.dispatchEvent("onActionClick",{model:h})}},{id:"upload",text:b.ECM_CA_Upload_Referential,fonticon:"upload",overflow:false,selectable:false,handler:function(){var h=g.collection.findWhere({id:"upload"});g.dispatchEvent("onActionClick",{model:h})}},]})}});return c});define("DS/ENOChangeActionUX/scripts/CASpinner",["DS/UIKIT/Mask"],function(b){var a={wait:false,keepActive:false,doWait:function(c,d){if((a.keepActive===false)&&(a.isWaiting())){a.endWait(c)}else{if(a.isWaiting()){return}}b.mask(c,d);a.wait=true},endWait:function(c){if(a.isWaiting()){b.unmask(c);a.wait=false;a.keepActive=false}},isWaiting:function(){return a.wait}};return a});define("DS/ENOChangeActionUX/scripts/Views/CAProcessStepsView",["UWA/Class/View","UWA/Core","DS/ENOProcessStepsUX/scripts/ProcessStepsView",],function(d,c,a){var b={_createView_ProcessSteps:function(e){return d.extend({tagName:"div",className:"generic-detail6",render:function(){var m=this.model.id;var h="<div><h1>Process Steps</h1></div>";h+="id is:"+m.replace("pid:","");var l=enoviaServerCAWidget.get3DSpaceURL();var j=enoviaServerCAWidget.tenant;var k=enoviaServerCAWidget.mySecurityContext;var i=enoviaServerCAWidget.proxy;console.log("myAppsURL:"+l);var f=new a();var n={};n.renderTo=this.container;n.page="policy_ChangeAction_ECM";var g={};g.id=m.replace("pid:","");n.data=g;f._createView_ProcessSteps(n)}})}};return b});define("DS/ENOChangeActionUX/scripts/Views/CASlideInFormView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Form","UWA/Class/Model","DS/UIKIT/Scroller"],function(a,j,d,h,i,g,f,c,b){var e=a.extend({slideinContainer:"",skeletonContainer:"",form:"",setup:function(){this.slideinContainer=h.extendElement(document.body).getElement("#slidein-container");this.skeletonContainer=h.extendElement(document.body).getElement("#skeleton-container");this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(m){if(UWA.is(this.slideinContainer)){this.form=m;var k=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});k.setAttribute("data-rec-id","slideInContentCA");this.getHeader().inject(k);this.getBody().inject(k);this.getFooter().inject(k);m.slideInReference=this;k.inject(this.slideinContainer);var l=this;widget.addEvent("onResize",function(){setTimeout(function(){if(l.slideinContainer.clientWidth>0){var n=window.matchMedia("(max-width: 768px)");if(n.matches){l.slideinContainer.style.width="100%";l.skeletonContainer.style.marginRight="100%"}else{l.slideinContainer.style.width="300px";l.skeletonContainer.style.marginRight="300px"}}},100)})}},getHeader:function(){var l=this.form.getHeading();var k=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%"},html:{tag:"h5",html:l}},{tag:"div",styles:{top:"0",right:"0",height:"35px",width:"50px",position:"fixed"}}]});k.setAttribute("data-rec-id","slideInHeaderCA");return k},getFooter:function(){var m=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:{tag:"div",html:this.form.getFooter()}});m.setAttribute("data-rec-id","slideInFooterRowCA");var k=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:m});k.setAttribute("data-rec-id","slideInFooterCA");var l=new g({value:j.ECM_CA_Cancel,className:"proposedButtons"}).inject(m);l.addEvent("onClick",this.onCancelButtonClick.bind(this));return k},onCancelButtonClick:function(){this.hideSlideIn()},getBody:function(){var k=UWA.createElement("div",{id:"slideInBody"});this.form.getBody().inject(k);return k},showSlideIn:function(){if(UWA.is(this.slideinContainer)){var k=window.matchMedia("(max-width: 768px)");if(k.matches){this.slideinContainer.style.width="100%";this.skeletonContainer.style.marginRight="100%"}else{this.slideinContainer.style.width="300px";this.skeletonContainer.style.marginRight="300px"}this.slideinContainer.style.borderLeftWidth="1px";this.skeletonContainer.style.opacity=".5";this.skeletonContainer.style.pointerEvents="none"}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){this.slideinContainer.innerHTML="";this.slideinContainer.style.width="0";this.slideinContainer.style.borderLeftWidth="0";this.skeletonContainer.style.marginRight="0";this.skeletonContainer.style.opacity="1";this.skeletonContainer.style.pointerEvents="inherit";var k="calc( 100% - 0px )";this.skeletonContainer.setStyle("width",k)}}});return e});define("DS/ENOChangeActionUX/scripts/SearchConfiguration",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENO6WPlugins/jQuery"],function(e,b,d,c){var a=function(f){this.multiSelectVal=f;this.socketName="search_socket_"+(new Date()).getTime();this.socket=new b.Socket(this.socketName,{dispatchRetryInterval:5});this.socket.subscribeServer("SearchComServer");this.listener=this.objectsSelected.bind(this);this.socket.addListener("Selected_Objects_search",this.listener);var g=this.options();this.socket.dispatchEvent("RegisterContext",g)};a.prototype.destroy=function(){var f={};f.widget_id=(widget)?widget.id:null;this.socket.dispatchEvent("unregisterSearchContext",f);this.socket.unsubscribeServer("SearchComServer");this.socket.removeListener("Selected_Objects_search",this.listener);this.socket.disconnect()};a.prototype.options=function(j,h,k,g,f){var i={};i.title=j;i.multiSel=this.multiSelectVal;i.mode="furtive";i.app_socket_id=this.socketName;i.widget_id=(widget)?widget.id:null;i.default_with_precond=true;i.show_precond=false;i.idcard_activated=false;i.role=k;i.tenant=enoviaServerCAWidget.tenant;if(h){i.precond="(";h=h.split(",");c.each(h,function(l,m){if(l!==0){i.precond+=" OR "}i.precond+='flattenedtaxonomies:"types/'+m.trim()+'"'});i.precond+=")";if(f!=""){i.precond+=f}if(j==="Depend"){i.precond+=' AND (NOT flattenedtaxonomies:"interfaces/Change On Hold") AND (NOT current:"On Hold" AND NOT current:"Cancelled")'}if(enoviaServerCAWidget.project_space!=""&&!("Transferee"==j||"Contributors"==j||"Reviewers"==j||"Followers"==j||"Assignees"==j)){i.precond+=' AND (project:"'+enoviaServerCAWidget.project_space+'")'}}if(g){i.default_search_criteria=g}return(i)};a.prototype.activate=function(j,i,l,k,h,f){var g=this.options(j,i,l,h,f);this.callback=k;this.socket.dispatchEvent("InContextSearch",g)};a.prototype.isAvailable=function(){return(e.is(this.socket))};a.prototype.objectsSelected=function(k){var f=[];if(this.callback){for(var j=0;j<k.length;j++){var h=[];var g=new d(k[j]);h.push(g.get("id"));h.push(g.get("ds6w:identifier"));h.push(g.get("ds6w:type"));h.push(g.get("ds6w:policy"));h.push(g.get("type_icon_url"));f.push(h)}this.callback(f)}};return(a)});define("DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(c,b){var a=c.extend({idAttribute:"id",setup:function(){var d=this},fetch:function(d){console.log("fetch called")},parse:function(i){var d="Cannot be found";var j="Access denied";var f={};f.id=i.id;f.activityName=[];f.activityName=i.operation[0].split(" ");f.status=i.status;var e={};var g={};if(UWA.is(i.after)){e.id=i.after.id;if(UWA.is(i.after.owner)){e.owner=i.after.owner}var h=i.after.info;if(!UWA.is(h)){h=i.after["instanceof"].info;e.id=i.after["instanceof"].id;e.Instanceid=i.after.id}e.Access=true;if(UWA.is(i.after.name)){e.instanceName=i.after.name}e.type=h.typeNLS;e.name=h["display name"];e.title=h["display name"];e.revision=h.revision;if(e.revision==""||e.revision==d||e.revision==j||e.revision==undefined){e.revision=""}e.maturity=h.currentNLS;e.NameRevison=e.name+"  "+e.revision;if(e.maturity==""||e.maturity==d||e.maturity==j||e.maturity==undefined){e.Access=false}f.Afterobject=e}if(UWA.is(i.before)){g.id=i.before.id;if(UWA.is(i.before.owner)){g.owner=i.before.owner}g.type=i.before.typeNLS;var h=i.before.info;if(!UWA.is(h)){h=i.before["instanceof"].info;g.id=i.before["instanceof"].id;g.Instanceid=i.before.id}g.Access=true;if(UWA.is(i.before.name)){g.instanceName=i.before.name}g.type=h.typeNLS;g.name=h["display name"];g.title=h["display name"];g.revision=h.revision;if(g.revision==""||g.revision==d||g.revision==j||g.revision==undefined){g.revision=""}g.maturity=h.currentNLS;g.NameRevison=g.name+"  "+g.revision;if(g.maturity==""||g.maturity==d||g.maturity==j||g.maturity==undefined){g.Access=false}f.Beforeobject=g}if(UWA.is(i.receivingChangeAction)){f.receivingChangeAction=i.receivingChangeAction}f.transferReason=UWA.is(i.transferReason)?i.transferReason:"";f.transferReasonNLS="";if(UWA.is(i.transferReason)){f.transferReasonNLS=(f.transferReason=="early")?b.ECM_CA_Realized_Transfer_EarlyCompl:b.ECM_CA_Realized_Transfer_DelayedCompl}this.UpdateGrammar(f);return f},UpdateGrammar:function(f){var g=f.activityName;var h=f.status;var i=f.receivingChangeAction;var j=f.transferReason;var d=f.transferReasonNLS;var e=f.id;f.ActivityDetails=[];f.OriginalActivityDetails=[];if(UWA.is(g)){if(Array.isArray(g)){g.forEach(function(m){if(m!=""){var k={id:e,NLSName:m,BeforeExists:false,AfterExists:false,BeforeGrammar:"",AfterGrammar:"",status:h,receivingChangeAction:i,transferReason:j,transferReasonNLS:d,sameAsWhere:false,};if(m=="Add"){k.NLSName=b.ECM_CA_NewRealized_Add_Operation;k.AfterExists=true}else{if(m=="Cut"){k.NLSName=b.ECM_CA_NewRealized_Cut_Operation;k.BeforeExists=true}else{if(m=="Replace"){k.NLSName=b.ECM_CA_NewRealized_Replace_Operation;k.BeforeExists=true;k.AfterExists=true;k.BeforeGrammar=b.ECM_CA_Replace_Before;k.AfterGrammar=b.ECM_CA_Replace_After}else{if(m=="Modify"){k.NLSName=b.ECM_CA_NewRealized_Modified;if(f.Afterobject&&f.Afterobject.owner&&f.Afterobject.id!=f.Afterobject.owner.id){k.NLSName=b.ECM_CA_NewRealized_ModifiedUsage;k.AfterExists=true}else{k.sameAsWhere=true}}else{if(m=="Move"){k.NLSName=b.ECM_CA_NewRealized_Moved;if(f.Afterobject&&f.Afterobject.owner&&f.Afterobject.id!=f.Afterobject.owner.id){k.AfterExists=true}}else{if(m.contains("ChangeStatus")){var l=m.substring(13);k.NLSName=b.ECM_CA_NewRealized_ChangedStatus;if(m.contains("#")&&l&&l!="unknown"){l=l.replace("_"," ");k.AfterGrammar=b.ECM_CA_NewRealized_Current_Maturity;k.AfterMaturity=l;k.AfterExists=true;k.sameAsWhere=true}}else{if(m=="TransferOwnership"||m=="ChangeResponsible"){k.NLSName=b.ECM_CA_NewRealized_transferownership;k.sameAsWhere=true}else{if(m=="ConfiguredDelete"){k.NLSName=b.ECM_CA_NewRealized_ConfiguredDelete;k.BeforeExists=true}else{if(m=="ConfiguredReplace"){k.NLSName=b.ECM_CA_NewRealized_ConfiguredReplace;k.BeforeExists=true;k.AfterExists=true;k.BeforeGrammar=b.ECM_CA_Replace_Before;k.AfterGrammar=b.ECM_CA_Replace_After}else{if(m=="EvolveInstance"){k.NLSName=b.ECM_CA_NewRealized_EvolveInstance;k.BeforeExists=true}else{if(m=="ConfiguredMove"){k.NLSName=b.ECM_CA_NewRealized_ConfiguredMove;k.BeforeExists=true}else{if(m=="NewMinorVersion"){k.NLSName=b.ECM_CA_NewRealized_NewMinorVersion_OperationSuffix;k.BeforeExists=true;k.BeforeGrammar=b.ECM_CA_Previous_Revision;k.sameAsWhere=true}else{if(m=="NewVersion"){k.NLSName=b.ECM_CA_NewRealized_NewVersion_OperationSuffix;k.BeforeExists=true;k.BeforeGrammar=b.ECM_CA_Previous_Revision;k.sameAsWhere=true}else{if(m=="Clone"){k.NLSName=b.ECM_CA_NewRealized_Clone_OperationSuffix;k.BeforeExists=true;k.BeforeGrammar=b.ECM_CA_Original_Object;k.sameAsWhere=true}else{if(m=="Evolve"){k.NLSName=b.ECM_CA_NewRealized_Evolve_OperationSuffix;k.BeforeExists=true;k.BeforeGrammar=b.ECM_CA_Original_Object;k.sameAsWhere=true}else{if(m=="NewEvolution"){k.NLSName=b.ECM_CA_NewRealized_NewEvolution_OperationSuffix;k.BeforeExists=true;k.BeforeGrammar=b.ECM_CA_Original_Object;k.sameAsWhere=true}else{if(m=="Create"){k.NLSName=b.ECM_CA_NewRealized_Create_Operation}else{if(m=="Delete"){k.sameAsWhere=true;k.NLSName=b.ECM_CA_NewRealized_Delete_Operation}else{k.NLSName=m}}}}}}}}}}}}}}}}}}k.taggerId=k.NLSName+k.id;f.ActivityDetails.push(k)}})}}f.OriginalActivityDetails=f.ActivityDetails},});return a});define("DS/ENOChangeActionUX/scripts/Views/CADependencyCounterView",["UWA/Class","UWA/Class/View","UWA/Core","WebappsUtils/WebappsUtils","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/Handlebars/Handlebars",],function(a,h,g,c,b,f){function e(){}e();var d=h.extend({name:"set-detail-view",tagName:"div",className:"counterDiv",init:function(i){var j=this;this.title=i.title;this.counter=i.counter;this._parent.call(this,i)},setup:function(){this.template='<div class="'+this.getClassNames("-container")+'">                                        <span class="'+this.getClassNames("-title")+'">'+this.title+'</span>                                        <span class="'+this.getClassNames("-count")+'">'+this.counter+"</span>                                     </div>";this.renderer=this.getTemplate(this.template)},render:function(){var k=this.name;this.container.empty();this.containerReference=this.container;var j=new UWA.Element("div");j.setAttributes({id:"DivForDependenciesCounter"});j.setStyle("height","100%");var i=this.renderer();j.addContent(i);j.inject(this.containerReference);return this},injectSubView:function(k,i){var j=this.container.getElement(i);if(k&&j){j.grab(k.render().getContent())}},getTemplate:function(j){var i=f.compile(j);var k=this;return function(){return i()}},});return d});define("DS/ENOChangeActionUX/scripts/Views/CACustomReferentialTileView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/TileView",],function(d,c,b){var a=b.extend({name:"CACustomReferentialTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-Referential-{{id}}">                                    <label class="control-label" for="checkbox-Referential-{{id}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" {{#if Access}} draggable="true"{{/if}}>                                  <div class="'+this.getClassNames("-header")+'">                                    {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                  </div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      {{#if namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectName}}}&nbsp;{{{revision}}}">{{{objectName}}}&nbsp;{{{revision}}}</div>{{/if}}									  {{#unless namePref}}<div class="'+this.getClassNames("-title")+'" title="{{{objectTitle}}}&nbsp;{{{revision}}}">{{{objectTitle}}}&nbsp;{{{revision}}}</div>{{/unless}}                                      {{#if titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectName}}}">{{{objectName}}}</div>{{/if}}									  {{#unless titlePref}}<div class="'+this.getClassNames("-subtitle")+'" title="{{{objectTitle}}}">{{{objectTitle}}}</div>{{/unless}}                                     <div class="'+this.getClassNames("-content")+'">										{{#if current}}<div class="'+this.getClassNames("-Maturity")+'" title="{{{maturityName}}}">											<table>												<tr>													<td class="'+this.getClassNames("-maturityField")+'">{{{maturityField}}}</td>													<td class="'+this.getClassNames("-maturityValue")+'">&nbsp;{{{current}}}</td>												</tr>											</table>										</div>{{/if}}										{{#if ownerFullname}}<div class="'+this.getClassNames("-Owner")+'" title="{{{ownerFullname}}}">										<table>												<tr>													<td class="'+this.getClassNames("-ownerField")+'">{{{ownerField}}}</td>													<td class="'+this.getClassNames("-onwerValue")+'">&nbsp;{{{ownerFullname}}}</td>												</tr>											</table>										</div>									</div>{{/if}}                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                           <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                      </div>                                    </div>                                </div>                            </div>                      '}});return a});define("DS/ENOChangeActionUX/scripts/Views/CACustomTeamTileView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/TileView",],function(d,c,b){var a=b.extend({name:"CACustomTeamTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                    <label class="control-label" for="checkbox-{{cid}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'">                                  <div class="'+this.getClassNames("-header")+'">                                    {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                  </div>                                  <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}                                      <div class="'+this.getClassNames("-title")+'">{{{title}}}</div>                                      <div class="'+this.getClassNames("-subtitle")+'">{{{subtitle}}}</div>                                      <div class="'+this.getClassNames("-content")+'" title="{{{rolesToDisplay}}}">{{{rolesToDisplay}}}</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                                <div class="'+this.getClassNames("-actions")+'">                                    <div class="actions-inline-container">                                      <div class="action-container single-action hidden">                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                      </div>                                      <div class="action-container actions-inline-dotted hidden">                                        <div class="action-icon-wrapper">                                          <span class="fonticon fonticon-down-open-big"></span>                                        </div>                                      </div>                                    </div>                                </div>                            </div>                      '}});return a});define("DS/ENOChangeActionUX/scripts/Views/CACustomTileView",["DS/W3DXComponents/Views/Item/TileView","css!DS/ENOChangeActionUX/ENOChangeActionUX"],function(b,c){var a=b.extend({name:"CACustomTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                <div class="toggle toggle-primary">                                    <input type="checkbox" name="radios" value="" id="SummaryView-{{{title}}}">                                    <label class="control-label" for="SummaryView-{{{title}}}"></label>                                </div>                            </div>                              <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                  <div class="'+this.getClassNames("-header")+'">                                      <div>{{#if image}}<img title={{{severityDisplay}}} src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}</div>									                    {{#if holdStatus}}<div class="state" title="{{{holdValue}}}[{{{currentDisplay}}}]">{{{holdValue}}}</div>{{/if}}														{{#unless holdStatus}}<div class="state" title="{{{currentDisplay}}}">{{{currentDisplay}}}</div>{{/unless}}								              </div>                                <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}	                                <div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>	                                <div class="'+this.getClassNames("-subtitle")+'" title="{{{subtitle}}}">{{{subtitle}}}</div>									<div class="'+this.getClassNames("-content")+'">                                        <div class="'+this.getClassNames("-content-left")+'">										<div class="'+this.getClassNames("-CAowner")+'" title="{{{ownerDisplayName}}}">{{{ownerField}}}&nbsp;{{{ownerDisplayName}}}</div>										<div class="'+this.getClassNames("-Role")+'" title="{{{contextUserRole}}}">{{{roleField}}}&nbsp;{{{contextUserRole}}}</div>										{{#if due}}<div class="'+this.getClassNames("-DueDate")+'">{{{dueDateField}}}&nbsp;{{{due}}}</div>{{/if}}									</div>                                        {{#if newlyAssign}}<div class="'+this.getClassNames("-content-right")+' fonticon fonticon-notification"title="{{{newlyAssignTitle}}}">                                        </div>{{/if}}									</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                            </div>                                    '},updateOrder:function(){var d=this.model.collection.indexOf(this.model)+1;this.container.setStyle("order",d)},setup:function(){this._parent.apply(this,arguments);this.listenTo(this.model,"updateOrder",this.updateOrder)},onRender:function(){this._parent.apply(this,arguments);var e=this.model.collection.size()+1;var d=this;setTimeout(function(){if(d.container.getParent()){var f=d.container.getParent().getElements(".by-pass-flex");if(f){f.forEach(function(g){g.setStyle("order",e)})}}},500)}});return a});define("DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(g,a,b,d,f,c){var e=a.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(h){this._parent.apply(this,arguments)},render:function(){this.container.empty(true);var j=this;j.model.set("severity","Low");this.SevButtonGroupDiv=g.createElement("div",{"class":"form-group",html:[{tag:"h5",html:c.ECM_CA_Severity,styles:{"margin-bottom":"3px"}}]});var i=new d({type:"radio",name:"Severity",id:"Severity",buttons:[new b({value:"Low",id:"Low",className:"success small",active:true}),new b({value:"Medium",id:"Medium",className:"warning small"}),new b({value:"High",id:"High",className:"error small"})],events:{onClick:function(l,k){this.dispatchEvent("onButtonClick",k);console.log(k)}}});i.inject(this.SevButtonGroupDiv);var h=this.ButtonEvents={onButtonClick:function(k){j.model.set("severity",k.getValue())}};this.listenTo(i,h);this.SevButtonGroupDiv.inject(this.container);return this},destroy:function(){this._parent.apply(this,arguments)}});return e});define("DS/ENOChangeActionUX/scripts/Views/CACustomTitleView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Text","UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(f,a,d,e,b){var c=a.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(g){this._parent.apply(this,arguments)},render:function(){this.container.empty(true);var h=this;this.TitleDiv=f.createElement("div",{"class":"form-group",html:[{tag:"label",html:[{tag:"span",html:b.ECM_CA_Abstract},{tag:"sup",html:"*","class":"required-field"}]}]});var g=new d({name:"CA_Title",id:"CA_Title",className:"mandatory_input",value:"",multiline:false,rows:1,required:true,placeholder:b.ECM_CA_Abstract_PlaceHolder});g.elements.input.onkeyup=function(){var i=g.elements.input.value;h.model.set("createObjectTitle",i)};g.elements.input.onblur=function(){var i=g.elements.input;if(""==i.value){i.style.borderColor="red"}else{i.style.borderColor=""}};g.inject(this.TitleDiv);this.TitleDiv.inject(this.container);return this},destroy:function(){this._parent.apply(this,arguments)}});return c});define("DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(c,a){var b=c.extend({idAttribute:"id",setup:function(){var d=this},fetch:function(d){console.log("fetch called")},parse:function(e){var d={};d.id=e.id;d.operationId="";d.operationIdx="";d.status=e.status;d.activityActual=e.what.operation;d.activityName=this.getOperationNameOnUI(e.what.operation);d.objectId=e.objectId;if(e.what["target state"]){d.targetState=e.what["target state"]}if(e.why.comment&&e.why.comment.text){d.activityDesc=e.why.comment.text}else{d.activityDesc=""}return d},getOperationNameOnUI:function(d){var e="";switch(d){case"None":e=a.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":e=a.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":e=a.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":e=a.ECM_CA_Proposed_Operation_Evolution;break;case"Create":e=a.ECM_CA_Proposed_Operation_Create;break;case"Modify":e=a.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":e=a.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":e=a.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":e=a.ECM_CA_Proposed_Activity_State_Obsolete;break;default:e="??Something went wrong??"}return e},});return b});define("DS/ENOChangeActionUX/scripts/Views/CAApplicabilityView",["UWA/Class/View","UWA/Core",],function(c,b){var a={_createView_Applicability:function(d){return c.extend({tagName:"div",className:"generic-detail6",render:function(){var h=this.container;var e=new UWA.Element("div");e.setAttributes({id:"FacetDivForApplicabilityContext"});e.setStyles({height:"100%"});h.addContent(e);var f=this.model.id;var g=(enoviaServerCAWidget.isNative)?"Native":"Dashboard";require(["DS/CfgEvolutionUX/CfgEvolutionLayoutFactory"],function(i){var j={mode:"Applicability",objectid:f.replace("pid:",""),parent:e,environment:g};j.tenant=enoviaServerCAWidget.tenant;var k=i.create(j)})}})}};return a});define("DS/ENOChangeActionUX/scripts/Collection/CAMembersCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAMemberModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,e,b,c,a){var d=b.extend({model:c,setup:function(){var g=this},fetch:function(g){var h=null;h=g.data=this.membersArr=g.membersArr;g.ajax=function(j,i){i.onComplete(h)};this.url="dummyURL";return this._parent(g)},});return d});define("DS/ENOChangeActionUX/scripts/Collection/CAReferentialCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAReferentialModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,e,d,c,b){var a=d.extend({model:c,setup:function(){var g=this},fetch:function(g){var h=null;h=g.data=this.referentialsArr=g.referentialsArr;g.ajax=function(j,i){i.onComplete(h)};this.url="dummyURL";return this._parent(g)},});return a});define("DS/ENOChangeActionUX/scripts/Views/CALabelManagerView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/LabelManagerView","DS/ENOChangeActionUX/scripts/Views/CATempAutocomplete"],function(e,d,f,b){var c=function(j,h,i){var g;j.forEach(function(k){if(k[h]===i){g=k}});return g};var a=f.extend({init:function(g){this._parent(g);this.autoCompleteArr=[]},addObject:function(l,i,n,m,g){var o=this.options.multipleRoles;n.categoryId=i;if(o===false){this.removeObject(l)}var h=this.autocomplete.getFormattedLabel(n);this.renderOneLabel(l,h,g);var k={selection:l,categoryId:i,prevDistinction:m,item:n};this.newObjects.push(k);var j=this;this.dispatchEvent("onUpdate",[this.newObjects,i])},removeObject:function(l){var h=this.container.getElement('[data-id="'+l+'"]');if(h){var j=c(this.newObjects,"selection",l);var i="";var g=this.newObjects.indexOf(j);j.item?i=j.item.categoryId:"";var k=null;this.autoCompleteArr.forEach(function(m){if(i===m.category){k=m.autocomplete}});if(k){k.getFocus(j.item,false)}this.newObjects.splice(this.newObjects.indexOf(j),1);h.remove();this.dispatchEvent("onUpdate",[this.newObjects,i])}},attachAutocomplete:function(i,g){var h=this;e.extend(this.options,{collection:this.collection,container:g,events:{onSelect:function(l,m,k){if(m){h.addObject(l,i,m,k,this.getContent())}},onFocused:function(k){h.onFocus(k)}},attributes:{"data-category":i}});var j=null;if(this.options.autocompleteExtension){j=this.autocomplete=new this.options.autocompleteExtension(this.options)}else{j=this.autocomplete=new PatchedAutocomplete(this.options)}if(j){this.autoCompleteArr.push({autocomplete:j,category:i})}return this.autocomplete.inject(g)},});return a});define("DS/ENOChangeActionUX/scripts/Collection/CAContextCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAContextModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,e,d,b,a){var c=d.extend({model:b,setup:function(){var g=this},fetch:function(g){var h=null;h=g.data=this.contextArr=g.contextArr;g.ajax=function(j,i){i.onComplete(h)};this.url="dummyURL";return this._parent(g)},});return c});define("DS/ENOChangeActionUX/scripts/Views/CAPanelAddMemberView",["UWA/Core","UWA/Utils","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/ENOChangeActionUX/scripts/Views/CALabelManagerView",],function(e,c,d,b){var a="paneladdmember-item-view";var f=d.extend({name:"CAPanelAddMemberView",buildBody:function(){var h=this;var g=e.extend({spreadClick:true,events:{onUpdate:function(j,i){h.elements.buttons.save.setDisabled(j.length<1);h.labels=j;h.dispatchEvent("onUpdateLabels",[h.labels,i])}}},this.options);this.addMemberBody=new b(g);this.elements.labelmanager=e.createElement("div",{"class":a+"-body",html:this.addMemberBody.render()})}});return f});define("DS/ENOChangeActionUX/scripts/Views/CATeamSetView",["UWA/Class/View","DS/W3DXComponents/Views/Item/SetView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/Handlebars/Handlebars","DS/ENOChangeActionUX/scripts/Views/CAPanelAddMemberView","DS/ENOChangeActionUX/scripts/Views/CATeamFilterView",],function(f,b,a,e,d,h,g){var c=b.extend({name:"teamViewSet",setup:function(){var i={};this._initAddMembersPanelView();this._initFilterMembersPanelView();this._parent.call(this,i)},template:function(){return'                        <div class="'+this.getClassNames("-header")+'">                            <div class="'+this.getClassNames("-detail")+'"></div>                            <div class="'+this.getClassNames("-actions")+'"></div>                            <div class="'+this.getClassNames("-multiselHeader")+'"></div>                            <div class="'+this.getClassNames("-switcher")+'"></div>                        </div>                        <div class="'+this.getClassNames("-addMembers")+'"></div>                        <div class="'+this.getClassNames("-filterMembers")+'"></div>                        <div class="'+this.getClassNames("-contents")+'"></div>                    '},_initAddMembersPanelView:function(){var j,i;var k=this;j=this.addMebersView=new h(this.getAddMebersOptions());i=this._addMemberViewEvents={onUpdateLabels:function(){if(arguments&&arguments[0]){var m=arguments[0];if(m&&Array.isArray(m)&&m.length>0){var l=false;m.forEach(function(n){var o=n&&n.item?n.item.type:"";if("reviewer"===n.item.categoryId){l=true}if((n&&n.item.categoryId==="reviewer")&&(enoviaServerCAWidget.reviewerType.typeOfReviewer===""||o==="")){enoviaServerCAWidget.reviewerType={typeOfReviewer:o,labelSelected:true}}});if(!l){enoviaServerCAWidget.reviewerType={typeOfReviewer:"",labelSelected:false}}}else{if(arguments[1]==="reviewer"){enoviaServerCAWidget.reviewerType={typeOfReviewer:"",labelSelected:false}}}}}};this.listenTo(j,i);return j},getAddMebersOptions:function(){return this.getOption("addMembers")},_initFilterMembersPanelView:function(){var i,j;j=this._filterMembersEvent={memberFilterKeyUp:function(){this.dispatchEvent("memberFilterKeyUp",arguments)}};i=this.filterMebersView=new g(this.getFilterMebersOptions());this.listenTo(i,j);return i},getFilterMebersOptions:function(){return this.getOption("filterMembers")},onRender:function(){this.injectSubView(this.addMebersView,"."+this.name+"-addMembers");this.addMebersView.show();this.injectSubView(this.filterMebersView,"."+this.name+"-filterMembers");var i={};this._parent.call(this,i)},});return c});define("DS/ENOChangeActionUX/scripts/CAUtility",["DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/SearchConfiguration","DS/ENOChangeActionUX/scripts/Models/CAMemberModel","DS/ENOChangeActionUX/scripts/Collection/CAMembersCollection","DS/ENOChangeActionUX/scripts/Collection/CAReferentialCollection","DS/ENOChangeActionUX/scripts/Collection/CAContextCollection","DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection","DS/ENOChangeActionUX/scripts/Models/CAProposedModel","DS/ENOChangeActionUX/scripts/Collection/CACollection","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","DS/UIKIT/Alert","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/WAFData/WAFData","UWA/Core","DS/ENOChangeActionUX/scripts/Views/CASlideInPropertiesView","UWA/Class/Promise","DS/UIKIT/Native/Dropdown","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Button","DS/ENO6WPlugins/jQuery","UWA/String","DS/LifecycleCmd/MaturityCmd","UWA/Utils/InterCom"],function(n,o,v,i,r,w,f,u,d,h,j,b,c,a,t,e,s,p,m,l,x,q,k){var g={CurrModel:null,CAUtility_CAModel:null,collectionToFilter:null,summaryCloned:null,dependencyElem:{},taggerObject:{},maturityCmd:null,addSearchExcludesPids:function(B,y){var A=[];if("referentials"==B||"context"==B||"contributor"==B||"reviewer"==B||"follower"==B||"TransferOwnership"==B||"proposed"==B){for(var z=0;z<y.length;z++){A.push(y[z].id)}}return A},search:function(E,C,I,D,G){var J="";if("referentials"==D||"context"==D||"Contributors"==D||"Reviewers"==D||"Followers"==D||"proposed"==D||"Depend"==D){var K=D+"ExcludeList";var z=(this.CurrModel!=null&&this.CurrModel!=undefined)?this.CurrModel.get(K):null;for(var B=0;(z!=undefined&&z!=null&&B<z.length);B++){if(z[B]){var H=z[B].toString();H=H.replace("pid","physicalid");J=J+"NOT ("+H+")"}}}else{if("ChangeOrder"==D||"TransferOwnership"==D){var y=("ChangeOrder"==D)?this.CurrModel.get("changeOrderId"):this.CurrModel.get("ownerId");if(UWA.is(y)&&y!=""){J="NOT ("+y.replace("pid","physicalid")+")"}}}var A=enoviaServerCAWidget.getRole();var F=null;G.activate(E,C,A,I,F,J)},activateSearch:function(B,z){var y=true;y=(B!=undefined&&B!=null&&((B=="Change Order")||(B==="Person"&&z==="TransferOwnership")||("proposed"==z)||(z==="Depend")))?false:true;var A=new o(y);return A},populateCOSearchResults:function(y,N,L){if(enoviaServerCAWidget.isNative){var B=N.split("~");var F=[];for(var E=0;E<B.length;E++){F.push(B[E])}var z=[];for(var D=0;D<B.length;D++){z.push(F[D].split(","))}N=z}var J=l(".modal-footer")[0];if(J){J.childNodes[0].disabled=false}var M=y.substr(0,y.indexOf("_"));var I=document.getElementById(M);var K=document.getElementById(M+"_hidden");var G="";var C="";var H=I.value.split(",");if(!L&&N.length>1){N=N.slice(0,1)}for(var E=0;E<N.length;E++){var A=N[E];if((L&&H.indexOf(A[1])==-1)||!L){if(G!=""){G=G+","}G=G+A[1];if(C!=""){C=C+","}C=C+A[0]}}if(L){if(G!=""){if(I.value!=""){I.value=I.value+","+G}else{I.value=G}}if(C!=""){if(K.value!=""){K.value=K.value+","+C}else{K.value=C}}}else{I.value=G;K.value=C}},populateSearchResults:function(y,H,Q){if(enoviaServerCAWidget.isNative){var M=H.split("~");var E=[];for(var N=0;N<M.length;N++){E.push(M[N])}var G=[];for(var L=0;L<M.length;L++){G.push(E[L].split(","))}H=G}var D=y.substr(0,y.indexOf("_"));var S=document.getElementById(D);var A=document.getElementById(D+"_hidden");var R="";var B="";var K=[];for(var N=0;N<H.length;N++){var z=H[N];K.push(z[1])}var J=g.getUserDisplayName(K);var T=A.value;var F=[];if(typeof T!="undefined"){F=T.split(",")}if(!Q&&H.length>1){H=H.slice(0,1)}var P=[];var I="";("Assignee_Edit"==y)?I="ContributorsExcludeList":(("Followers_Edit"==y)?I="FollowersExcludeList":(("Reviewers_Edit"==y)?I="ReviewersExcludeList":""));P=(this.CAUtility_CAModel!=undefined&&this.CAUtility_CAModel!=""&&this.CAUtility_CAModel.get(I)!=undefined)?this.CAUtility_CAModel.get(I):[];for(var N=0;N<H.length;N++){var z=H[N];var C="";var O=null;if(typeof J.userInfo!="undefined"){O=J.userInfo[z[1]].userDisplayName;P.push(J.userInfo[z[1]].id)}if(O!=null&&O!=undefined&&O!=""){C=O}else{C=z[1]}if((Q&&F.indexOf(z[1])==-1)||!Q){if(R!=""){R=R+","}R=R+C;if(B!=""){B=B+","}B=B+z[1]}}(this.CAUtility_CAModel==undefined||this.CAUtility_CAModel==null)?this.CAUtility_CAModel=this.CurrModel:this.CAUtility_CAModel=this.CAUtility_CAModel;(this.CAUtility_CAModel!=null&&this.CAUtility_CAModel!=undefined)?this.CAUtility_CAModel.set(I,P):console.log("this.CAUtility_CAModel is null");if(Q){if(R!=""){if(S.value!=""){S.value=S.value+","+R}else{S.value=R}}if(B!=""){if(A.value!=""){A.value=A.value+","+B}else{A.value=B}}}else{S.value=R;A.value=B}},createCAAndTransferRealized:function(C,z,B,D){var A="/resources/modeler/change/transfer";z.originChangeActionId=g.CurrModel.id;z.receivingChangeAction=C;z=JSON.stringify(z);var y=function(F){if(F&&F.status==="success"&&g.CurrModel){var E={};n.doWait(widget.body);E.onComplete=function(G){enoviaServerCAWidget.arrOid=[];n.endWait(widget.body);B(F)};g.CurrModel.fetch(E)}};g.makeWSCall(A,"PUT","enovia","application/json",z,y,D)},flowDownToNewChangeAction:function(B,A,z,D){var y="";y="/resources/modeler/change/flowdown";A.originChangeActionId=(g.CurrModel&&g.CurrModel.id)?g.CurrModel.id:"";A.receivingChangeAction=B;A=JSON.stringify(A);n.doWait(widget.body);var C=function(F){if(F&&F.status==="success"){var G="";if(F.receivingChangeAction&&F.receivingChangeAction.changeaction){G=F.receivingChangeAction.changeaction.name}if(g.CurrModel){var E={};E.onComplete=function(H){enoviaServerCAWidget.arrOid=[];n.endWait(widget.body);F.caName=G;z(F)};g.CurrModel.fetch(E)}}};g.makeWSCall(y,"PUT","enovia","application/json",A,C,D)},transferRealized:function(A,z,C,D){var B="/resources/modeler/change/transfer";z.originChangeActionId=g.CurrModel.id;z.receivingChangeActionId=A.changeaction.id;z=JSON.stringify(z);var y=function(F){if(g.CurrModel){var E={};n.doWait(widget.body);E.onComplete=function(G){enoviaServerCAWidget.arrOid=[];n.endWait(widget.body);C(F)};g.CurrModel.fetch(E)}};g.makeWSCall(B,"PUT","enovia","application/json",z,y,D)},flowDownToExistingChangeAction:function(y,B,A,D){var z="";z="/resources/modeler/change/flowdown";B.originChangeActionId=(g.CurrModel&&g.CurrModel.id)?g.CurrModel.id:"";B.receivingChangeActionId=y.id;B=JSON.stringify(B);n.doWait(widget.body);var C=function(F){if(g.CurrModel){var E={};E.onComplete=function(G){enoviaServerCAWidget.arrOid=[];n.endWait(widget.body);F.caName=y.name;A(F)};g.CurrModel.fetch(E)}};g.makeWSCall(z,"PUT","enovia","application/json",B,C,D)},createCA:function(A,z,B){var y="/resources/modeler/change/changeaction";g.makeWSCall(y,"POST","enovia","application/json",A,z,B)},editCA:function(B,z,A,C){var y="/resources/modeler/change/changeaction/"+z;g.makeWSCall(y,"PUT","enovia","application/json",B,A,null)},addReferentialToCA:function(B,z,A,C){var y="/resources/modeler/change/changeaction/"+z;g.makeWSCall(y,"PUT","enovia","application/json",B,A,C)},removeReferentialFromCA:function(B,z,A,C){var y="/resources/modeler/change/changeaction/"+z;g.makeWSCall(y,"PUT","enovia","application/json",B,A,C)},addPersonToCA:function(B,z,A,C){var y="";if(z){y="/resources/modeler/change/changeaction/"+z}if(y!=""){g.makeWSCall(y,"PUT","enovia","application/json",B,A,C)}},removePersonFromCA:function(B,z,A,C){var y="";if(z!=undefined){y="/resources/modeler/change/changeaction/"+z}if(y!=""){g.makeWSCall(y,"PUT","enovia","application/json",B,A,C)}},DispatchEventToWin:function(A,C){if(enoviaServerCAWidget.isNative||(A=="Work_Under"&&enoviaServerCAWidget.isPoweredBy)){var z=window.dscef;if(z!==undefined){if(typeof z.sendString==="function"){z.sendString(A+"="+C)}}else{if(typeof CATCefSendString!=="undefined"){CATCefSendString(A+"="+C)}else{var y=document.createElement("textarea");y.setAttribute("name",A);y.appendChild(document.createTextNode(C));var B=document.createElement("form");B.setAttribute("method","POST");B.setAttribute("action","jsnotif://");B.appendChild(y);document.documentElement.appendChild(B);B.submit();B.parentNode.removeChild(B);B=null}}}},addContextToCA:function(B,z,A,C){var y="/resources/modeler/change/changeaction/"+z;g.makeWSCall(y,"PUT","enovia","application/json",B,A,C,true)},removeContextFromCA:function(B,z,A,C){var y="/resources/modeler/change/changeaction/"+z;g.makeWSCall(y,"PUT","enovia","application/json",B,A,C,true)},getUserDisplayNameByPromise:function(y){var z=new e(function(G,F){var E="";var H="";if(Array.isArray(y)){for(var B=0;B<y.length;B++){if(H!=""){H=H+"%7C"+y[B]}else{H=y[B]}}}else{H=y}var C=function(J){var I={};I.userDisplayName=J;G(I)};var A="/resources/modeler/change/userdisplayname";var D=enoviaServerCAWidget.getSecurityContext();g.makeWSCall(A,"GET","enovia","application/json","userNames="+H,C,null,false)});return z},getUserDisplayName:function(D){var C="";var E="";if(Array.isArray(D)){for(var z=0;z<D.length;z++){if(E!=""){E=E+"%7C"+D[z]}else{E=D[z]}}}else{E=D}var A=function(G){C=G};var F=function(H,G){console.log("Failed getUserDisplayName")};this.getUserDisplayName.onCompleteCallback=A;this.getUserDisplayName.onFailureCallback=F;var y="/resources/modeler/change/userdisplayname";var B=enoviaServerCAWidget.getSecurityContext();g.makeWSCall(y,"GET","enovia","application/json","userNames="+E,A,F,false);return C},makeWSCall:function(H,z,F,B,D,I,C,K){var K=K||null;var y="";if(K!=null&&K.isfederated!=undefined&&K.isfederated==true){y=enoviaServerCAWidget.federatedURL+H}else{y=enoviaServerCAWidget.computeUrl(H)}var E=new Date().getTime();if(y.indexOf("?")==-1){y=y+"?tenant="+enoviaServerCAWidget.tenant+"&timestamp="+E}else{y=y+"&tenant="+enoviaServerCAWidget.tenant+"&timestamp="+E}var J=enoviaServerCAWidget.getSecurityContext();I=I||function(){};C=C||function(){};var A=widget.getValue("lang");if(widget.lang){A=widget.lang}var G={};G.method=z;G.timeout=enoviaServerCAWidget.wsCallTimeout;G.type="json";if(enoviaServerCAWidget.isNative){if(J){G.headers={Accept:"application/json","Content-Type":B,SecurityContext:J,"Accept-Language":A}}else{G.headers={Accept:"application/json","Content-Type":B,"Accept-Language":A}}}else{if(F){G.auth={passport_target:F}}G.proxy=enoviaServerCAWidget.proxy;if(J){G.headers={Accept:"application/json","Content-Type":B,SecurityContext:J,"Accept-Language":A}}else{G.headers={Accept:"application/json","Content-Type":B,"Accept-Language":A}}}if(D){G.data=D}G.onComplete=function(L){console.log("Success calling url: "+y);console.log("Success data: "+JSON.stringify(L));I(L)};G.onFailure=function(M,L){console.log("Error in calling url: "+y);console.log("Additional Details:: httpMethod: "+z+" authentication: "+F+" securityContext: "+J+" ContentType: "+B);console.log("Error Detail: "+M);console.log("Error Data: "+JSON.stringify(L));if(L&&L.errorMessage){g.error(L.errorMessage)}else{if(M&&M.message){g.error(M.message)}else{g.error("Something went wrong, please check logs for more details")}}C(M,L);n.endWait(widget.body)};G.onTimeout=function(){console.log("Timedout for url: "+y);g.error("Webservice Timedout, please refresh and try again.");n.endWait(widget.body)};c.authenticatedRequest(y,G)},getHtmlForTNRPanel:function(A,z,B){var y=[];y.push({tag:"div","class":"font-3dslight",html:A},{tag:"div","class":"font-3dslight",html:z},{tag:"div","class":"font-3dslight",html:B});return y},message:function(A,z){if(this.alertCA!=null){this.alertCA.hide()}var y=true;if(z=="error"){y=false}this.alertCA=new j({closable:true,visible:true,autoHide:y,hideDelay:5000,className:"wp-alert"}).inject(document.body,"top");this.alertCA.add({className:z,message:A})},error:function(y){this.message(y,"error")},success:function(y){this.message(y,"success")},warn:function(y){this.message(y,"warning")},info:function(y){this.message(y,"primary")},getLifecycleInfo:function(y){if((y!=undefined)&&(y.indexOf("pid:")>=0)){y=y.replace("pid:","")}var z=new e(function(E,D){var A="/resources/lifecycle/maturity/state";var F='{ "data" : [{ "physicalid":"" }]}';var B=JSON.parse(F);B.data[0].physicalid=y;B=JSON.stringify(B);var C=function(L){var J=[];var K={};var G=L.data[0].maturityGraph.states;G.forEach(function(M){J.push(M.stateSysName);K[M.stateSysName]=M.stateUserName});K.Cancelled=b.ECM_CA_State_Cancelled;var H={};H.current=L.data[0].current;H.allStates=J;H.stateNameNLS=K;var I={};I.lifecycleInfo=H;E(I)};g.makeWSCall(A,"POST","enovia","application/json",B,C,D,false)});return z},getUserAccess:function(y){var z=new e(function(E,D){var A="/resources/modeler/change/access/"+y;var B="";var C=function(G){var F={};F.userAccess=G;E(F)};g.makeWSCall(A,"GET","enovia","application/json",B,C,D,false)});return z},getDependUserAccess:function(y){var z=new e(function(E,D){var A="/resources/changedependencies/services/graph/access/"+y;var B="";var C=function(G){var F={};F.dependUserAccess=G;E(F)};g.makeWSCall(A,"GET","enovia","application/json",B,C,D,false)});return z},getCADetails:function(y){var z=new e(function(E,D){var A="/resources/modeler/change/changeaction/"+y+"?people=1&referentials=1&proposed=1&realized=1&dependency=1&attributes=1&context=1&changeOrder=1";var B="";var C=function(F){E(F)};g.makeWSCall(A,"GET","enovia","application/json",B,C,D,false)});return z},getCADependencies:function(y){var z=new e(function(E,D){var A="/resources/changedependencies/services/graph/"+y+"?depth=1";var B="";var C=function(F){E(F)};g.makeWSCall(A,"GET","enovia","application/json",B,C,D,false)});return z},getCompletedTaskDetails:function(y){var z=new e(function(E,D){var A="/resources/modeler/change/inboxtask/"+y;var B="";var C=function(G){var F={};F.completedTaskDetail=G;E(F)};g.makeWSCall(A,"GET","enovia","application/json",B,C,null,false)});return z},createLifecycleSpanContent:function(D){var K=a.extendElement(document.body).getElement("#lifecycleSpan");if(!K){return}else{if(window.enoviaServerCAWidget.CHG_CHANGE_MATURITY_HEADER=="true"){K.empty();var y=D.get("current");var C=D.get("stateNameNLS");C.Cancelled=b.ECM_CA_State_Cancelled;var L=C[y];var B=D.get("holdStatus");var A="cursorPointer";var G="a";if(B==="true"){L=L+" ["+b.ECM_CA_State_On_Hold+"] ";A="cursorDefault";G="text"}var F=[];D.set("objectId",D.get("id"));F.push(D);K.addContent({tag:"span",html:[{tag:"label",text:b.ECM_CA_Maturity+" : "},{tag:"span",html:"&nbsp;&nbsp;"},{tag:G,text:L,id:"ca_header_maturity","class":A,events:{click:function(){g.changeMaturity(F,D,B)}}}]});n.endWait(widget.body);return}else{if(K){K.empty()}var y=D.get("current");var J=D.get("allStates");var I=[];if(J!=null&&J.length>0){for(var z=0;z<J.length;z++){if(J[z]==y){if(z!=0&&z!==J.length-1){I.push(J[z-1]);I.push(J[z]);I.push(J[z+1])}else{if(z==0){I.push(J[z]);I.push(J[z+1])}else{if(z===J.length-1){I.push(J[z-1]);I.push(J[z])}}}break}}}var H=a.extendElement(document.body).getElementsByClassName("description-section");if(H!=undefined&&H[0]!=undefined){H[0].setStyles({"max-height":"none"})}for(var E=0;E<I.length;E++){if(I[E]==undefined){I=I.splice(E,1)}if(I[E]==y){var L=D.get("stateNameNLS")[y];var B=D.get("holdStatus");if(B=="true"){E++;L=L+" ["+b.ECM_CA_State_On_Hold+"] "}K.addContent({tag:"span",html:[{tag:"span",html:"&nbsp;&nbsp;"},{tag:"span",html:g.createCurrentStateButton(L)}]})}else{if(I.length==2&&I[E]!=y){if(E==1){K.addContent({tag:"span",html:[{tag:"span",html:"&nbsp;&nbsp;"},{tag:"span",html:g.createPromoteButton(D,I[E])}]})}else{K.addContent({tag:"span",html:[{tag:"span",html:"&nbsp;&nbsp;"},{tag:"span",html:g.createDemoteButton(D,I[E])}]})}}else{if(I.length==3&&I[E]!=y){if(E==0){K.addContent({tag:"span",html:[{tag:"span",html:"&nbsp;&nbsp;"},{tag:"span",html:g.createDemoteButton(D,I[E])}]})}else{K.addContent({tag:"span",html:[{tag:"span",html:"&nbsp;&nbsp;"},{tag:"span",html:g.createPromoteButton(D,I[E])}]})}}}}}if(l("#currentState_btn")[0]!=undefined){l("#currentState_btn")[0].removeClassName("btn-primary");l("#currentState_btn")[0].addClassName("currentStateButtonCSS")}if(l("#promote_btn")[0]!=undefined){l("#promote_btn")[0].removeClassName("btn-success");l("#promote_btn")[0].addClassName("promoteDemoteButtonCSS");l("#promote_btn")[0].setStyle("background-image","linear-gradient(to bottom, #F5F6F7, #E2E4E3)");l("#promote_btn")[0].setStyle("border-color","#B4B6BA");l("#promote_btn")[0].setStyle("border","solid 1px");l("#promote_btn")[0].setStyle("border-radius","3px")}if(l("#demote_btn")[0]!=undefined){l("#demote_btn")[0].removeClassName("btn-error");l("#demote_btn")[0].addClassName("promoteDemoteButtonCSS");l("#demote_btn")[0].setStyle("background-image","linear-gradient(to bottom, #F5F6F7, #E2E4E3)");l("#demote_btn")[0].setStyle("border-color","#B4B6BA");l("#demote_btn")[0].setStyle("border","solid 1px");l("#demote_btn")[0].setStyle("border-radius","3px")}n.endWait(widget.body)}}},createCurrentStateButton:function(y){return new m({value:y,className:"primary small califecycle",active:true,id:"currentState_btn"})},createPromoteButton:function(z,A){var y=z.get("stateNameNLS")[A];return new m({value:y,className:"success small califecycle",icon:"fonticon-right left",id:"promote_btn",attributes:{title:b.ECM_CA_Action_Promote},events:{onClick:function(){g.promoteCA(z,A)}}})},createDemoteButton:function(z,A){var y=z.get("stateNameNLS")[A];return new m({value:y,className:"error small califecycle",icon:"fonticon-left right",id:"demote_btn",attributes:{title:b.ECM_CA_Action_Demote},events:{onClick:function(){g.demoteCA(z)}}})},promoteCA:function(C,D){var A=C.id;A=(A!=undefined&&A!=null)?A.replace("pid:",""):"";var z="/resources/lifecycle/maturity/promote";var E='{ "data" : [{ "physicalid":"","tostate":""}]}';var y=JSON.parse(E);y.data[0].physicalid=A;y.data[0].tostate=D;y=JSON.stringify(y);n.doWait(widget.body);var B=function(H){if(H.status!=undefined&&H.status!=""&&H.status=="failure"){g.error(H.report[0].error)}else{if(H.status!=undefined&&H.status!=""&&H.status=="success"){var G={};C.fetch(G)}}n.endWait(widget.body)};var F=function(H,G){g.error(H);n.endWait(widget.body)};g.makeWSCall(z,"POST","enovia","application/json",y,B,F,false)},demoteCA:function(C,D){var A=C.id;A=(A!=undefined&&A!=null)?A.replace("pid:",""):"";var z="/resources/lifecycle/maturity/demote";var E='{ "data" : [{ "physicalid":""}]}';var y=JSON.parse(E);y.data[0].physicalid=A;y=JSON.stringify(y);n.doWait(widget.body);var B=function(G){if(G.status!=undefined&&G.status!=""&&G.status=="failure"){g.error(G.report[0].error)}else{if(G.status!=undefined&&G.status!=""&&G.status=="success"){C.set("current",G.results[0].current);C.set("TableStateVal",b.get("ECM_CA_State_"+C.get("current")))}}n.endWait(widget.body)};var F=function(H,G){g.error(H);n.endWait(widget.body)};g.makeWSCall(z,"POST","enovia","application/json",y,B,F,false)},onItemViewDrag:function(B,D){var F,J,I,z,y,C,H;F=B[2];var A=B[2];var M=Object.keys(A);var E=[];for(var K in M){var L=A[M[K]];if(UWA.is(L)){y=L.model.get("name");C=L.model.get("id");I=C.lastIndexOf(":");if(I>0){I=I+1;C=C.substring(I)}H=(D=="Change Action")?"Change Action":F.model.get("type");var G={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:"",objectId:C,objectType:H,displayName:y,displayType:H};E.push(G)}}var z={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:E}};J=B[3];J.dataTransfer.setData("Text",JSON.stringify(z))},onItemViewDragForContents:function(C,B){var F,K,J,z,y,D,H,I;var M=B.caId.substr(4);F=C[1];var E=[];var N=Object.keys(F);for(var L in N){var A=F[N[L]];if(A){y=A.get("objectName");if(B.typeOfDrag&&(B.typeOfDrag==="Proposed")){D=A.get("objectId")}else{D=A.get("id")}J=D.lastIndexOf(":");if(J>0){J=J+1;D=D.substring(J)}H=A.get("objectType");if(!H){H=A.get("type")}I=A.get("revision");var G={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",objectId:D,objectType:H,displayName:y,Revision:I,ChangeActionID:M,displayType:H};G.caContextIds="";if(B.caContextIds&&B.caContextIds.length!=0){G.caContextIds=B.caContextIds}E.push(G)}}K=C[2];var z={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:E}};g.DispatchEventToWin("DragStart",JSON.stringify(z));K.dataTransfer.setData("Text",JSON.stringify(z))},updateExcludeList:function(B,z){var A=[];if(z=="referentials"){var y=B.get(z);y.forEach(function(E,D){A.push(E.get("id"))})}else{if(z=="context"){var C=B.get(z);C.forEach(function(E,D){A.push(E.get("id"))})}else{if(z=="Depend"){A.push(B.get("id"))}}}B.set(z+"ExcludeList",A)},getSuggestionsForRoutesAndMembers:function(B){var D=[];var y=(B.members)?B.members:null;if(y){var C=false;y.forEach(function(F){var E=F.get("role");if(E.indexOf("reviewer")>=0){C=true;enoviaServerCAWidget.reviewerType.typeOfReviewer=F.get("type")}});if(!C&&enoviaServerCAWidget.reviewerType.labelSelected===false){enoviaServerCAWidget.reviewerType.typeOfReviewer=""}}var z,A;z=A=null;g.getSuggestions(B).then(function(E){B.onComplete(E)},function(E){console.log("Issue in retrieving members");return e.reject(E)})},getSuggestions:function(y){var D=y.text;var A=y.categoryId;var C=y.contextUser;var z=this;var B=new e(function(K,M){var F="/search?xrequestedwith=xmlhttprequest";var J=function(O){var N=[];if(O&&O.results&&Array.isArray(O.results)){var P=O.results;P.forEach(function(S){var Q={};var R=S.attributes;R.forEach(function(T){if(T.name==="ds6w:what/ds6w:type"){Q.type=T.value}if(T.name==="resourceid"){Q.id=T.value}if(T.name==="ds6w:identifier"){Q.identifier=T.value}if(Q.type==="Person"){if(T.name==="ds6wg:fullname"){Q.name=T.value}}else{if(T.name==="ds6w:identifier"){Q.name=T.value}}});N.push(Q)})}K(N)};var H=function(N){M(N)};if(!D.contains("*")){D=D+"*"}var E="";var I=z.CurrModel;if(!(A==="reviewer")||(A==="reviewer"&&(enoviaServerCAWidget.reviewerType.typeOfReviewer==="Person"))){E='(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:'+D+")"}else{if(A==="reviewer"&&(enoviaServerCAWidget.reviewerType.typeOfReviewer==="Route Template")){E='(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+C+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE" AND name:'+D+")"}else{E='(flattenedtaxonomies:"types/Route Template" AND route_95_base_95_purpose:"Approval" AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+C+'" ) AND policycurrent:"Route Template.Active" AND latestrevision:"TRUE" AND name:'+D+') OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:'+D+")"}}var G={with_indexing_date:true,with_nls:false,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:E,order_by:"desc",order_field:"relevance",nresults:1000,start:"0",source:[],tenant:enoviaServerCAWidget.tenant};var G=JSON.stringify(G);var L={};L.isfederated=true;g.makeWSCall(F,"POST","enovia","application/json",G,J,H,L)});return B},_addFullNameToPersonObject:function(A,z){var y=A.changeaction.people;if(Array.isArray(y)){y.forEach(function(D){var B=D.name;if(z&&z.userDisplayName.userInfo&&z.userDisplayName.userInfo[B]){var C=z.userDisplayName.userInfo[B].userDisplayName;D.fullName=C;D.id=z.userDisplayName.userInfo[B].id}})}},rearrangeMembersByRole:function(y,B,z){if(Array.isArray(B)){B.forEach(function(C){var D=C.name;var E=y.findWhere({userName:D});if(E){E.set("role","")}})}if(Array.isArray(B)){B.forEach(function(H){var I=H.name;var G=y.findWhere({userName:I});if(G){var E=G.get("role");var L=H.role;var D=[];if(E.length){D=E.split(",")}var J="";var K=D.indexOf(L);if(K===-1){if(D.length===0){D.push(L)}else{L=" "+L;D.push(L)}G.set("role",D.toString())}}else{for(var K=0;K<z.length;K++){var C=false;var F=z[K];if(F.name===H.name){C=true;H.id="pid:"+F.id;H.fullName=F.fullName;var L=H.role;if(L.indexOf("contributor")>=0){}H.role=L;if(F.type!="Route Template"){H.type="Person"}break}}if(C){y.add(new v(H,{parse:true}))}}})}function A(F){var E=false;for(var C=0;C<B.length;C++){var D=B[C].name;if(F===D){E=true}}return E}z.forEach(function(C){var E=C.name;var D=false;D=A(E);if(D===false){var F=y.findWhere({userName:E});if(F){y.remove(F)}}})},getCASummary:function(){var y=new e(function(D,C){var z="/resources/modeler/change/changeactions?contributor=1&reviewer=1&follower=1&states=Prepare%7CInWork%7CInApproval%7CApproved";var A="";var B=function(E){D(E)};g.makeWSCall(z,"GET","enovia","application/json",A,B,C,false)});return y},SetSpinnerWait:function(y,z){if(y=="true"){widget.body.style.pointerEvents="none"}else{widget.body.style.pointerEvents="auto"}},updateWidgetTitle:function(y){var z=b.ECM_CA_Widget_Title;if(UWA.is(y)){z=y.get("title")}return widget.setTitle(z)},createProposedCollection_native:function(z){var A=new UWA.Class.Collection();var y=z;if(Array.isArray(y)){y.forEach(function(C){var B=A.get(C.id);if(B!=undefined){}else{A.add(new u(C,{parse:true}))}})}return A},createProposedCollection:function(A,B){var z={proposedArr:A,};var y=null;if(B&&B.get("proposed")){y=B.get("proposed")}else{y=new f()}y.fetch(z);return y},getOperationNameOnUI:function(y){var z="";switch(y){case"None":z=b.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":z=b.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":z=b.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":z=b.ECM_CA_Proposed_Operation_Evolution;break;case"Create":z=b.ECM_CA_Proposed_Operation_Operation_Create;break;case"Modify":z=b.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":z=b.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":z=b.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":z=b.ECM_CA_Proposed_Activity_State_Obsolete;break;default:z=b.ECM_CA_Proposed_Activity_NoActivity}return z},removeDuplicatesToBeDroppedObjects:function(A){for(var z=0;z<A.data.items.length;z++){for(var y=z+1;y<A.data.items.length;y++){if(A.data.items[z].objectId==A.data.items[y].objectId){A.data.items.splice(y,1);y=y-1}}}return A},getAdditionObjectInfo:function(y){var z=new e(function(E,D){if(y&&y.length>0){y=y.toString();var B="$ids="+y;var A="/resources/v2/e6w/service/ObjectInfo?$fields=ownerFullname,collabSpace,policy,icon,synopsis,functionalname";var C=function(I){var H;var G=new Object();if(UWA.is(I)&&UWA.is(I.data)){I.data.forEach(function(J){H=new Object();H.pid=J.id;H.type=J.type;H.objectName=J.dataelements.name;H.revision=J.dataelements.revision;H.objectTitle=J.dataelements.title;H.icon=J.dataelements.icon;H.policy=J.dataelements.policy;H.collabSpace=J.dataelements.collabSpace;H.ownerFullname=J.dataelements.ownerFullname;H.synopsis=J.dataelements.synopsis;G[J.id]=H})}var F={};F.additionObjectInfo=G;E(F)};g.makeWSCall(A,"POST","enovia","application/x-www-form-urlencoded",B,C,D,false)}else{E(true)}});return z},enrichCollection:function(A,y){g.UpdateUnAccessibleObject(A);var z=new e(function(E,D){var C=[];var B={};if(UWA.is(y)){A.forEach(function(F){if(UWA.is(F.get(y))&&F.get(y)!=""&&F.get(y)!=F.get("id")){if(F.get("Access")==true){B[F.get(y).replace("pid:","")]=F.id;C.push(F.get(y).replace("pid:",""))}}})}else{A.forEach(function(F){if(F.get("Access")==true){C.push(F.id.replace("pid:",""))}})}if(C.length>0){g.getAdditionObjectInfo(C).then(function(G){if(UWA.is(G)&&UWA.is(G.additionObjectInfo)){var F;var H;C.forEach(function(I){if(UWA.is(y)){H=B[I]}else{H="pid:"+I}if(UWA.is(G.additionObjectInfo[I])){F=A.get(H);F.set("objectName",G.additionObjectInfo[I].objectName);F.set("objectTitle",G.additionObjectInfo[I].objectTitle);if(F.get("revision")){if(enoviaServerCAWidget.NamePref=="Title"){F.set("IdentifierWithRevision",F.get("objectTitle")+F.get("revision"))}else{F.set("IdentifierWithRevision",F.get("objectName")+F.get("revision"))}}F.set("icon",G.additionObjectInfo[I].icon);F.set("policy",G.additionObjectInfo[I].policy);F.set("collabSpace",G.additionObjectInfo[I].collabSpace);F.set("ownerFullname",G.additionObjectInfo[I].ownerFullname)}})}E(A)},function(F){console.log("failed from getting additional info");return e.reject(F)})}else{E(true)}});return z},UpdateUnAccessibleObject:function(A,z){var y="Cannot be found";var B="Access denied";if(!UWA.is(z)){var z=(enoviaServerCAWidget.NamePref=="Name")?"objectName":"objectTitle"}A.forEach(function(C){if(C.get("Access")==false){var E=C.pairs();for(var D=0;D<E.length;D++){if(typeof(E[D][1])=="string"&&(E[D][1]==y||E[D][1]==B)){if(E[D][0]!=z){C.set(E[D][0],"",{silent:true})}}}}})},filterSummaryCollection:function(z){var C=z.filteredSubjectList;var y=enoviaServerCAWidget.mySkeleton;var D=y.getCollectionAt(0);if(D===null){return}if(g.collectionToFilter===null){var A=D.toArray();g.collectionToFilter=new UWA.Class.Collection(A)}if(D.length!=g.collectionToFilter.length){D.reset();var A=g.collectionToFilter.toArray();D.add(A)}var E=g.filterbasedonIds(C,g.collectionToFilter);var B=g.collectionToFilter.without(E);D.remove(B)},filterbasedonIds:function(B,z){var A=[];var D=null;for(var y=0;y<B.length;y++){var C=B[y];var E=z.findWhere({id:C});if(E){A.push(E)}}return A},updateClonedCollection:function(y){if(y===undefined||y===null){return}y.forEach(function(z){var A=g.collectionToFilter.findWhere({id:z.get("id")});if(A){A.set("severity",z.get("severity"));A.set("severityDisplay",z.get("severityDisplay"));A.set("type",z.get("type"));A.set("name",z.get("name"));A.set("current",z.get("current"));A.set("currentDisplay",z.get("currentDisplay"));A.set("due",z.get("due"));A.set("contextUserRole",z.get("contextUserRole"))}})},createMembersCollection:function(A){var y={membersArr:A,};var z=new i();z.fetch(y);return z},createReferentialCollection:function(A){var z={referentialsArr:A,};var y=new r();y.fetch(z);return y},createContextCollection:function(y){var A={contextArr:y,};var z=new w();z.fetch(A);return z},activateDeactiveTaggerProxies:function(z,B){var y=g.getTaggerObject(z);if(y){y.activateTaggerProxy()}var A=g.getTaggerObject(B);if(A){A.deactivateTaggerProxy()}},killTaggerProxies:function(B){var A=[];if(B===-1){A=[0,1,2,3,4,6]}else{A=[B]}for(var y=0;y<A.length;y++){var z=A[y];var C=g.getTaggerObject(z);if(C){C.taggerProxy.die();var D=C.viewName;delete g.taggerObject[D]}}},setTaggerObject:function(z,y){g.taggerObject[z]=y;y.activateTaggerProxy()},getTaggerObject:function(y){var A="";var z=null;switch(y){case 0:A="Properties";break;case 1:A="Team";break;case 2:A="Proposed";break;case 3:A="Realized";break;case 4:A="Referential";break;case 6:A="Context";break;default:console.log("incorrect view selected");break}if(A!=""&&g.taggerObject){z=g.taggerObject[A]}return z},activateSummaryViewTagger:function(){g.killTaggerProxies(-1);var y=enoviaServerCAWidget.mySkeleton;if(y){var z=y.getCollectionAt(0);z.activateTaggerProxy()}},refreshTaggerProxies:function(){g.activateSummaryViewTagger();var y=enoviaServerCAWidget.mySkeleton;if(y){var z=y.getCollectionAt(0);z.taggerProxy.die()}widget.dispatchEvent("onLoad")},filterInCurrentDashboard:function(G){var y=enoviaServerCAWidget.mySkeleton;var B=[];if(y){var D=y.getCollectionAt(0);if(g.summaryCloned===null){g.summaryCloned=new UWA.Class.Collection(D.toArray())}if(G===""){D.reset();D.add(g.summaryCloned.toArray())}var A=D.toArray();var H=new UWA.Class.Collection(A);for(var F=0;F<H.length;F++){var E=H.at(F);if(E){var z="";if(enoviaServerCAWidget.NamePref==="Name"){z=E.get("name")}else{if(enoviaServerCAWidget.NamePref==="Title"){z=E.get("synopsis")}}if(z.indexOf(G)>=0){B.push(E)}}}var C=H.without(B);D.remove(C)}},createPropertiesComponent:function(z){var y=new t();y.buildSlideIn(z);y.showSlideIn()},_initDropDown:function(y,C){var B;var z=this;if(this.dropDown){this.dropDown.destroy();this.dropDown=null}if(y.length===0){y.push({text:b.ECM_CA_Command_NO_Action})}var A={items:y,target:C,className:"CA_ConnectedObj_DropDown",};if(enoviaServerCAWidget.isNative){B=this.dropDown=new s(A)}else{B=this.dropDown=new p(A)}if(this.dropDown){this.dropDown.show()}},checkTenantInforamation:function(D){var B=[];if(D){var z=D.data.items;var C=[];var y=[];for(var A=0;A<z.length;A++){if(z[A].envId===""||z[A].envId===undefined||z[A].envId===null){C.push(z[A].displayName)}else{if(z[A].envId!=enoviaServerCAWidget.tenant){y.push(z[A].displayName)}}}B.TenantInfoMissing=C;B.DiffTenantData=y}return B},buildDependencyModel:function(z,B,A,y){if(z){z.forEach(function(D){if(D&&(D.id===B)){var C={};C.id=D.id;C.state=D.current;C.stateNLS=D.currentNLS;C.dueDate=D.duedate;C.responsible=D.owner;C.name=D.name;C.title=D.title;C.type=D.type;C.dependencyLinks=[];C.chgDecompose=[];C.codependencyLinks=[];C.stacking=[];if(Array.isArray(D.prereq)&&D.prereq.length>0){D.prereq.forEach(function(F){var E={};E.linkId=F.id;E.toID=F.toId;E.consumed=F.consumed;z.forEach(function(G){if(G.id===F.toId){E.id=G.id;E.state=G.current;E.stateNLS=G.currentNLS;E.dueDate=G.duedate;E.responsible=G.owner;E.name=G.name;E.title=G.title;E.type=G.type;E.dependencyType=b.ECM_CA_Depend_Label_New}});if(A&&A.length){if(A.indexOf(E.toID)===-1){C.dependencyLinks.push(E)}}else{C.dependencyLinks.push(E)}})}if(Array.isArray(D.coreq)&&D.coreq.length>0){D.coreq.forEach(function(F){var E={};E.linkId=F.id;E.toID=F.toId;E.consumed=F.consumed;z.forEach(function(H){if(H.id===F.toId){E.id=H.id;E.state=H.current;E.stateNLS=H.currentNLS;E.dueDate=H.duedate;E.responsible=H.owner;E.name=H.name;E.title=H.title;E.type=H.type;E.dependencyType=b.ECM_CA_CO_Depend_Label}});var G="";if(g.CurrModel){G=g.CurrModel.get("id")}if(G!==E.id&&(E.id!=y)){if(A&&A.length){if(A.indexOf(E.toID)===-1){C.dependencyLinks.push(E)}}else{C.dependencyLinks.push(E)}}})}if(Array.isArray(D.flowdownFrom)&&D.flowdownFrom.length>0){D.flowdownFrom.forEach(function(F){var E={};E.linkId=F.id;E.toID=F.toId;E.consumed=F.consumed;z.forEach(function(H){if(H.id===F.toId){E.id=H.id;E.state=H.current;E.stateNLS=H.currentNLS;E.dueDate=H.duedate;E.responsible=H.owner;E.name=H.name;E.title=H.title;E.type=H.type;E.dependencyType="Flowdown"}});var G="";if(g.CurrModel){G=g.CurrModel.get("id")}if(G!==E.id&&(E.id!=y)){if(A&&A.length){if(A.indexOf(E.toID)===-1){C.dependencyLinks.push(E)}}else{C.dependencyLinks.push(E)}}})}g.dependencyElem=C}})}return g.dependencyElem},getAllowedOperationActivity:function(y){var z=new e(function(E,D){if(y&&y.length>0){var B={getOperationForPhysicalIds:y};B=JSON.stringify(B);var A="/resources/modeler/change/operation/fromIds";var C=function(I){var H;var G=new Object();if(UWA.is(I)&&UWA.is(I.listOfOperationPerObject)){I.listOfOperationPerObject.forEach(function(J){H=new Object();H.allowedOperation=[];H.allowedActivity=[];H.defaultOperation="None";H.defaultActivity=undefined;J.allowedOperation.forEach(function(K){if(enoviaServerCAWidget.supportedOperations.indexOf(K)!=-1){H.allowedOperation.push(K)}else{if(enoviaServerCAWidget.supportedActivities.indexOf(K)!=-1){H.allowedActivity.push(K)}}});if(UWA.is(J.defaultOperation)&&enoviaServerCAWidget.supportedOperations.indexOf(J.defaultOperation)!=-1){H.defaultOperation=J.defaultOperation}else{if(UWA.is(J.defaultOperation)&&enoviaServerCAWidget.supportedActivities.indexOf(J.defaultOperation)!=-1){H.defaultActivity=J.defaultOperation}}G[J.id.replace("pid:","")]=H})}var F={};F.allowedOperationActivity=G;E(F)};g.makeWSCall(A,"POST","enovia","application/json",B,C,D,false)}else{E(true)}});return z},refreshApplicabilityView:function(y){require(["DS/CfgEvolutionUX/CfgEvolutionLayoutFactory"],function(z){var C=document.querySelector("#FacetDivForApplicabilityContext");while(C&&C.hasChildNodes()){C.removeChild(C.lastChild)}var B=(enoviaServerCAWidget.isNative)?"Native":"Dashboard";var A={mode:"Applicability",objectid:y.replace("pid:",""),parent:C,environment:B};A.tenant=enoviaServerCAWidget.tenant;if(A.parent){z.create(A)}})},getFlowdownCandidatesAndTheirStatus:function(B,z,y){var A=new e(function(F,E){if(B.length>0&&z.length>0){var C="";C="/resources/modeler/change/flowdown";var D={};D.originChangeActionId=B;D.receivingChangeActionId=z;D=JSON.stringify(D);n.doWait(widget.body);var G=function(I){F(I);n.endWait(widget.body)};var H=function(I){alert("flowdown status failed")};g.makeWSCall(C,"POST","enovia","application/json",D,G,H)}});return A},sanitizeText:function(y){y=y.trim();if(UWA.is(y,"string")&&y.length>0){if(!isNaN(parseFloat(y))){return y}else{y=x.stripTags(y);y=x.stripScripts(y);y=x.escapeHTML(y);return y}}else{if(UWA.is(y,"number")){return y}}return""},changeMaturity:function(D,B,C){if(C=="true"){return}var A=[];var y=[];D.forEach(function(F){var E=F.get("objectId");if(E==undefined||E==null||E==""){E=F.get("id")}y.push(E);A.push({physicalid:E.substring(4)})});var z=g.maturityCmd=g.maturityCmd!=null?g.maturityCmd:new q();z.executeAsync(A).then(function(){var E={};n.doWait(widget.body);E.onComplete=function(){n.endWait(widget.body)};B.fetch(E);console.log("Maturity  updated")})},getBlobObject:function(y,A){var z=c.authenticatedRequest;z(y,{method:"GET",responseType:"blob",onload:A,onFailure:function(){},onComplete:function(){}})},openRelationalExplorer:function(z){var B=enoviaServerCAWidget.getSecurityContext();var D=[];z.forEach(function(E){var F={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:B,objectId:E.replace("pid:","")};D.push(F)});var y={protocol:"3DXContent",version:"1.1",source:widget.getValue("x3dAppId"),widgetId:widget.id,data:{items:D}};var A=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";if(!this._compass_socket){this._compass_socket=new k.Socket(A);this._compass_socket.subscribeServer("com.ds.compass",window.parent)}this._compass_socket.dispatchEvent("onSetX3DContent",y,A);var C={appId:"ENORIPE_AP"};this._compass_socket.dispatchEvent("onLaunchApp",C,A)}};return g});define("DS/ENOChangeActionUX/scripts/CATagNavigatorProxy",["DS/ENOChangeActionUX/scripts/CAUtility","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/TagNavigatorProxy/TagNavigatorProxy",],function(g,c,f,b,e,a,h){var d=b.extend(e,a,{bExecuteTagger:false,ExecuteTagger:function(){if(enoviaServerCAWidget.isNative){if(window.enoviaServerCAWidget.TaggerInNative||window.enoviaServerCAWidget.CHG_NATIVE_TAGGER==="true"){return true}else{return false}}else{return true}},_initTaggerProxy:function(k){var i=this;var j=new Promise(function(o,n){i.bExecuteTagger=i.ExecuteTagger();if(!i.bExecuteTagger){return j}var l,p,m,q;if(i.taggerProxy){return j}l=i.taggerProxyOptions={filteringMode:"FilteringOnServer",events:{}};filterTagObj:null;isNewFilter:false;i.allSubjects=[];i.allActivitySubjects=[];i.subjectsMapByPredValue={};i.filters={};q=i._taggerProxyEvents={onFilterChange:i.onFilterChange,onFilterSubjectsChange:i.onFilterChange,addUnfocusSubjectsListener:i.onUnfocusSubjects,addFilterChangeListener:i.onFilterChange,addCriteriaChangeListener:i.onFilterChange,};if(widget&&(!enoviaServerCAWidget.is3DSpace)){l=f.extend({widgetId:widget.id,tenant:enoviaServerCAWidget.tenant,},l,true)}else{if(enoviaServerCAWidget.is3DSpace){l=f.extend({contextId:"context1"},l,true)}}i.widget=widget;if(enoviaServerCAWidget.isNative){require(["DS/ENOChangeActionUX/scripts/CAWebInWinTaggerProxy"],function(r){l.events=q;if(!window.enoviaServerCAWidget.widgetId){var s=Math.random();s.toString(36);var t=s.toString(36).substr(2,9);window.enoviaServerCAWidget.widgetId="ChangeMgt"+t}l.widgetId=window.enoviaServerCAWidget.widgetId;l.proxyId=window.enoviaServerCAWidget.widgetId+"ChangeAction_Facet_"+k;m=i.taggerProxy=new r(l);widget=i.widget;o(m)})}else{m=i.taggerProxy=h.createProxy(l,q);i.taggerProxy.addFilterChangeListener(i.onFilterChange,i);o(m)}});return j},_setSubjectTags:function(k,l){if(!this.bExecuteTagger){return}var j=this;this.viewName=l;var i={};switch(l){case"Properties":i=this._setSubjectTagsForProperties(k);case"Team":i=this._setSubjectTagsForTeam(k);break;case"Proposed":i=this._setSubjectTagsForProposed(k);break;case"Realized":i=this._setSubjectTagsForRealized(k);break;case"Referential":i=this._setSubjectTagsForReferentials(k);break;case"Context":i=this._setSubjectTagsForContext(k);break;default:console.log("incorrect view selected");break}if(j.taggerProxy){}},_setSubjectTagsForProperties:function(k){if(!this.bExecuteTagger){return}var j=this;var i={};this._setTagsForInternal("Properties",i);return i},_setSubjectTagsForTeam:function(o){if(!this.bExecuteTagger){return}var n=this;var r={};var k=o;var p=[];for(var q=0;q<k.length;q++){var l=k.at(q);var m=[];if(l){p.push(l.cid);var s={};var i=l.get("fullName");s.sixw="ds6w:who/"+c.ECM_CA_MEMBER_TAG;s.type="xsd:string";s.dispValue=i;s.object=i;m.push(s);var j=l.get("rolesToDisplay");var t=j.split(", ");t.forEach(function(u){var v={};v.sixw="ds6w:who/"+c.ECM_CA_Summary_Table_Label_Role;v.type="xsd:string";v.dispValue=u;v.object=u;m.push(v)})}if(m.length){r[l.get("id")]=m}}this._setTagsForInternal("Team",r);return r},_setSubjectTagsForProposed:function(l){if(!this.bExecuteTagger){return}var n=this;var u={};var A=l;for(var r=0;r<A.length;r++){var q=A.at(r);var k=[];if(q){var y={};var m=q.get("operationActual")=="Create"?"UnAssigned":q.get("maturity");y.sixw="ds6w:what/"+c.ECM_CA_Table_Header_Maturity;y.type="xsd:string";y.dispValue=m;y.object=m;k.push(y);var j={};var z=q.get("operationActual")=="Create"?"UnAssigned":q.get("revision");j.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Revision;j.type="xsd:string";j.dispValue=z;j.object=z;k.push(j);var o={};var w=q.get("type");o.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;o.type="xsd:string";o.dispValue=w;o.object=w;k.push(o);var v={};var s=q.get("operationActual")=="Create"?"UnAssigned":q.get("collabSpace");v.sixw="ds6w:where/"+c.ECM_CA_COLLABSPACE_TAG;v.type="xsd:string";v.dispValue=s;v.object=s;k.push(v);var i={};var x=q.get("operationActual")=="Create"?"UnAssigned":q.get("ownerFullname");i.sixw="ds6w:who/"+c.ECM_CA_RESPONSIBLE_TAG;i.type="xsd:string";i.dispValue=x;i.object=x;k.push(i);var p={};var t=q.get("operationDisplay");p.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Operation;p.type="xsd:string";p.dispValue=t;p.object=t;k.push(p)}if(k.length){u[q.get("id")]=k}}this._setTagsForInternal("Proposed",u);return u},_setSubjectTagsForRealized:function(l){if(!this.bExecuteTagger){return}var n=this;var t={};var A=l;if(!A){return t}for(var p=0;p<A.length;p++){var r=A.at(p);var k=[];if(r){var w=r.get("id");var y={};var m=r.get("maturity");y.sixw="ds6w:what/"+c.ECM_CA_Table_Header_Maturity;y.type="xsd:string";y.dispValue=m;y.object=m;k.push(y);var j={};var z=r.get("revision");j.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Revision;j.type="xsd:string";j.dispValue=z;j.object=z;k.push(j);var o={};var x=r.get("type");o.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;o.type="xsd:string";o.dispValue=x;o.object=x;k.push(o);var u={};var q=r.get("collabSpace");u.sixw="ds6w:where/"+c.ECM_CA_COLLABSPACE_TAG;u.type="xsd:string";u.dispValue=q;u.object=q;k.push(u);var i={};var v=r.get("ownerFullname");i.sixw="ds6w:who/"+c.ECM_CA_RESPONSIBLE_TAG;i.type="xsd:string";i.dispValue=v;i.object=v;k.push(i);var s=r.get("activities");s.forEach(function(C){var B=C.get("ActivityDetails");B.forEach(function(I){var H=[];var J={};J.sixw="ds6w:what/"+c.ECM_CA_Realized_Tagger_Activity_Change;J.type="xsd:string";J.dispValue=I.NLSName;J.object=I.NLSName;J.activityDetails="activity-"+I.taggerId;k.push(J);if(!I.sameAsWhere){if(I.AfterExists){var F=I.After;var E={};var D=F.type;E.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;E.type="xsd:string";E.dispValue=D;E.object=D;E.activityDetails="activityAfter-"+I.taggerId;k.push(E)}if(I.BeforeExists){var G=I.Before;var E={};var D=G.type;E.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;E.type="xsd:string";E.dispValue=D;E.object=D;E.activityDetails="activityBefore-"+I.taggerId;k.push(E)}}})})}if(k.length){t[r.get("id")]=k}}this._setTagsForInternal("Realized",t);return t},_setSubjectTagsForReferentials:function(n){if(!this.bExecuteTagger){return}var p=this;var s={};var z=n;for(var r=0;r<z.length;r++){var i=z.at(r);var m=[];if(i){var k={};var t=(enoviaServerCAWidget.NamePref=="Name")?"Name":"Title";var v=(t=="Name")?i.get("objectName"):i.get("objectTitle");k.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Name;k.type="xsd:string";k.dispValue=v;k.object=v;m.push(k);var q={};var w=i.get("type");q.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;q.type="xsd:string";q.dispValue=w;q.object=w;m.push(q);var l={};var y=i.get("revision");l.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Revision;l.type="xsd:string";l.dispValue=y;l.object=y;m.push(l);var x={};var o=i.get("current");x.sixw="ds6w:what/"+c.ECM_CA_Table_Header_Maturity;x.type="xsd:string";x.dispValue=o;x.object=o;m.push(x);var j={};var u=i.get("ownerFullname");j.sixw="ds6w:who/"+c.ECM_CA_RESPONSIBLE_TAG;j.type="xsd:string";j.dispValue=u;j.object=u;m.push(j)}if(m.length){s[i.get("id")]=m}}this._setTagsForInternal("Referential",s);return s},_setSubjectTagsForContext:function(m){if(!this.bExecuteTagger){return}var o=this;var s={};var z=m;for(var r=0;r<z.length;r++){var q=z.at(r);var l=[];if(q){var j={};var t=(enoviaServerCAWidget.NamePref=="Name")?"Name":"Title";var v=(t=="Name")?q.get("objectName"):q.get("objectTitle");j.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Name;j.type="xsd:string";j.dispValue=v;j.object=v;l.push(j);var p={};var w=q.get("type");p.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Type;p.type="xsd:string";p.dispValue=w;p.object=w;l.push(p);var k={};var y=q.get("revision");k.sixw="ds6w:what/"+c.ECM_CA_Proposed_Operation_Revision;k.type="xsd:string";k.dispValue=y;k.object=y;l.push(k);var x={};var n=q.get("current");x.sixw="ds6w:what/"+c.ECM_CA_Table_Header_Maturity;x.type="xsd:string";x.dispValue=n;x.object=n;l.push(x);var i={};var u=q.get("ownerFullname");i.sixw="ds6w:who/"+c.ECM_CA_RESPONSIBLE_TAG;i.type="xsd:string";i.dispValue=u;i.object=u;l.push(i)}if(l.length){s[q.get("id")]=l}}this._setTagsForInternal("Context",s);return s},activateTaggerProxy:function(){var i=this.taggerProxy;if(!this.taggerProxy){return}i.activate();i.toggleProxyFocus(true)},deactivateTaggerProxy:function(){var i=this.taggerProxy;if(!this.taggerProxy){return}i.deactivate()},_indexTagForFiltering:function(i,n){var m,l,j,k;if(!this.subjectsMapByPredValue[j=i.sixw]){this.subjectsMapByPredValue[j]={}}if(!this.subjectsMapByPredValue[i.sixw][typeof i.object]){this.subjectsMapByPredValue[i.sixw][typeof i.object]={}}if(!(l=this.subjectsMapByPredValue[i.sixw][typeof i.object])[k=i.object]){l[k]={}}m=i.type;if((m!=="string")&&(m!=="integer")&&(m!=="date")&&(m!=="tree")){m="string"}if(!this.subjectsMapByPredValue[i.sixw][typeof i.object][k][n]){this.subjectsMapByPredValue[i.sixw][typeof i.object][k][n]={field:i.field,dispValue:i.dispValue,type:m,uri:i.object,activityDetails:[]}}if(i.activityDetails){this.subjectsMapByPredValue[i.sixw][typeof i.object][k][n].activityDetails.push(i.activityDetails)}return this},unloadAllTags:function(){this.allTags={};this.allSubjects=[];this.allActivitySubjects=[];this.subjectsMapByPredValue={};return this},_setTagsForInternal:function(p,o){var i,k,l,q,m,j,n;this.unloadAllTags();if(this.filters&&this.filters.allfilters){k=Object.keys(this.filters.allfilters).length===0}this.allTags=o;for(l in o){m=o[l];this.allSubjects.push(l);for(j=0,n=m.length;j<n;j++){q=m[j];this._indexTagForFiltering(q,l);if(q.activityDetails){if(q.activityDetails.indexOf("activity-")>=0){this.allActivitySubjects.push(q.activityDetails.replace("activity-",""))}if(q.activityDetails.indexOf("activityAfter-")>=0){this.allActivitySubjects.push(q.activityDetails.replace("activityAfter-",""))}if(q.activityDetails.indexOf("activityBefore-")>=0){this.allActivitySubjects.push(q.activityDetails.replace("activityBefore-",""))}}}}this.onFilterChange(this.filters);return this},onFilterChange:function(H){if(!H){return}var M,X,p,B,G,t,W,D,u,T,Q,I,m,Y,L,o,N,Z,C,i,k,j,V,aa,K,U,S,R,A,v,s,y,J,E,r,P,l;this.filters=H;X=H.allfilters;B=[];P=[];l=[];Q=0;L={};m={};r={};var x=0;var O=false;u={};for(t in X){I=X[t];if(!u[t]){u[t]={}}for(U=0,A=I.length;U<A;U++){Z=I[U];i=Z.object;i=Z.object;if(this.subjectsMapByPredValue[t]){if(Z.type==="date"||Z.type==="tree"||Array.isArray(i)){y=this.subjectsMapByPredValue[t][typeof i];for(K in y){V=y[K];E=Z.object.toString();if(K.substring(0,E.length)===E){f.extend(L,V)}}}else{L=this.subjectsMapByPredValue[t][typeof Z.object][i]||{}}for(Y in L){u[t][Y]=1;if(!m[Y]){m[Y]=0}m[Y]+=1;if(L[Y].activityDetails){var n=L[Y].activityDetails;if(n.length){O=true;var F={};for(var w=0;w<n.length;w++){if(n[w].indexOf("activity-")>=0){if(!r[n[w]]){r[n[w]]=0}r[n[w]]+=1}else{if(n[w].indexOf("activityAfter-")>=0){var z=n[w].replace("After","");if(!r[z]){r[z]=0}r[z]+=1;if(!F[z]){F[z]=1}}else{if(n[w].indexOf("activityBefore-")>=0){var z=n[w].replace("Before","");if(!F[z]){if(!r[z]){r[z]=0}r[z]+=1}}}}}}}}L={}}}if(t.indexOf(c.ECM_CA_Proposed_Operation_Type)>=0||t.indexOf(c.ECM_CA_Realized_Tagger_Activity_Change)>=0){x++}Q++}if(Q===0){B=this.allSubjects;P=this.allActivitySubjects}else{for(Y in m){M=m[Y];if(M>=Q){B.push(Y)}}if(!O){P=this.allActivitySubjects}else{for(Y in r){M=r[Y];if(M>=x){P.push(Y.replace("activity-",""))}}}}T={};G={};for(S=0,v=B.length;S<v;S++){Y=B[S];k=this.allTags[Y];G[Y]=k;for(R=0,s=k.length;R<s;R++){Z=k[R];D=Z.sixw+Z.field+Z.object+typeof Z.object;aa=Z.type;if((aa!=="string")&&(aa!=="integer")&&(aa!=="date")&&(aa!=="tree")){aa="string"}if(!T[D]){T[D]={object:Z.object,sixw:Z.sixw,field:Z.field,dispValue:Z.dispValue,count:0,type:aa}}T[D].count+=1}}J=function(ab){return ab.object===K};for(t in X){I=X[t];if(I[0].type!=="date"){for(aa in this.subjectsMapByPredValue[t]){for(K in this.subjectsMapByPredValue[t][aa]){L=this.subjectsMapByPredValue[t][aa][K];if(!(I.detect(J))){for(Y in L){if((B.indexOf(Y))===-1){j=!Object.keys(X).some(function(ab){return(ab!==t)&&!u[ab][Y]});if(j){C=L[Y].uri;p=L[Y].field;D=t+p+C;if(!T[D]){T[D]={object:C,sixw:t,field:p,dispValue:L[Y].dispValue,count:0,type:L[Y].type}}T[D].count+=1;if(!G[Y]){G[Y]=[]}G[Y].push(T[D])}}}}}}}}o=[];for(D in T){N=T[D];o.push(N)}if(this.taggerProxy){this.taggerProxy.setTags(G,o)}var q=this.viewName;switch(q){case"Team":this.dispatchEvent("onMembersTaggerProxyFilterChange",[B]);break;case"Proposed":this.dispatchEvent("onProposedTaggerProxyFilterChange",[B]);break;case"Realized":this.dispatchEvent("onRealizedTaggerProxyFilterChange",[B,P]);break;case"Referential":this.dispatchEvent("onReferentalTaggerFilterChange",[B]);break;case"Context":this.dispatchEvent("onContextTaggerFilterChange",[B]);break;default:console.log("incorrect view selected");break}return false},});return d});define("DS/ENOChangeActionUX/scripts/CAWidgetConfiguration",["DS/ENOChangeActionUX/scripts/CAUtility","DS/ENO6WPlugins/jQuery"],function(c,b){var a={setupIntercomConnections:function(e,f,d){f.compassSocketName=d+"EventSocket";f.compassSocket=new f.InterCom.Socket(f.compassSocketName);f.compassSocket.subscribeServer("com.ds.compass",window.parent);f.prefIntercomServer=new f.InterCom.Server("changeaction.intercom.server");f.prefIntercomServer.addListener("onAddPref",function(g,i){if(g.name=="RefreshMe"){f.onRefresh();return}if(g.value){e.setValue(g.name,g.value)}else{e.deleteValue(g.name)}var h=g.name.split("changeaction-preference_")});f.prefIntercomServer.addListener("onSetTitle",function(g,h){e.setTitle(g.title);e.setValue("title",g.title)})},onClickItem:function(l,j){var o,m,f,e,g;var d=enoviaServerCAWidget.collabspace;g=b(this);e=g.hasClass("selected");m=g.attr("data-pid");f=g.attr("data-type");if(e){var n=enoviaServerCAWidget.arrOid.indexOf(m);if(n===-1){enoviaServerCAWidget.arrOid.push(m)}m=enoviaServerCAWidget.arrOid[enoviaServerCAWidget.arrOid.length-1]}else{for(var h in enoviaServerCAWidget.arrOid){if(enoviaServerCAWidget.arrOid[h]===m){enoviaServerCAWidget.arrOid.splice(h,1);break}}if(enoviaServerCAWidget.arrOid.length==0){m=null;c.DispatchEventToWin("Add_to_CSO",enoviaServerCAWidget.arrOid.toString());if(enoviaServerCAWidget.is3DSpace){var k=window.top;if(k){var p=k.findFrame(window.top,"detailsDisplay");if(p){p.ids=""}emxUICore.setIdtoCompass()}}}else{m=enoviaServerCAWidget.arrOid[enoviaServerCAWidget.arrOid.length-1]}}if(m){if(enoviaServerCAWidget.is3DSpace){var k=window.top;if(k){var p=k.findFrame(window.top,"detailsDisplay");if(p){p.ids="";p.ids="~|"+m+"~"}emxUICore.setIdtoCompass()}}o={objectId:m,envId:enoviaServerCAWidget.tenant,contextId:d!=null?d.replace("ctx::",""):""};j.compassSocket.dispatchEvent("onSetObject",o,j.compassSocketName);c.DispatchEventToWin("Add_to_CSO",enoviaServerCAWidget.arrOid.toString())}else{j.compassSocket.dispatchEvent("onResetObject",{},j.compassSocketName);c.DispatchEventToWin("Remove_From_CSO",m)}}};window.CAWidgetConfiguration=a;return a});define("DS/ENOChangeActionUX/scripts/CAFlowDownStatusContainer",["DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/CAUtility","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(c,e,b,a){var d={flowdownStatus:{},setFlowDownStatus:function(f){if(f&&f.flowdownCandidatesAndStatuses&&Array.isArray(f.flowdownCandidatesAndStatuses)){f.flowdownCandidatesAndStatuses.forEach(function(h){if(h.candidate&&h.candidatestatus){var i=h.candidate.id;var g=h.candidatestatus;d.flowdownStatus[i]=g}})}},getFlowDownStatus:function(){return d.flowdownStatus}};return d});define("DS/ENOChangeActionUX/scripts/Models/CAProposedModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/CAUtility","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(e,b,d,a){var c=e.extend({idAttribute:"id",setup:function(){var f=this},fetch:function(g){var f=g.proposedArr;g.ajax=function(i,h){myoptions.onComplete(f)};g.url="dummyURL";return this._parent(g)},parse:function(l){var g="Cannot be found";var m="Access denied";var h={};h.id=l.id;h.Access=true;var k=l.where.info;h.operationActual=l.operation.name;h.operationDisplay=this.getOperationNameOnUI(l.operation.name);if(UWA.is(l.operation.name)&&l.operation.name=="Create"){h.maturity="";h.policy="";h.revision="";h.type=l.operation.type;h.name=l.operation["display name"];h.objectName=l.operation["display name"];h.objectTitle=l.operation["display name"];h.objectId=l.id}else{h.maturity=k.currentNLS;h.policy=k.policy;h.revision=k.revision;h.type=k.typeNLS;h.name=k["display name"];h.objectName=k["display name"];h.objectTitle=k["display name"];h.objectType=k.type;h.objectId=l.where.id;h.evolutionName=l.operation["evolution name"];if(h.maturity==""||h.maturity==m||h.maturity==g||h.maturity==undefined){h.Access=false}}if(l.why.comment&&l.why.comment.text){h.changeReason=l.why.comment.text}else{h.changeReason=""}if(Array.isArray(l.operation.amo)&&l.operation.amo.length>0){var i=l.operation.amo[0];if(i&&i.originChangeAction){h.flowDownFromName=i.originChangeAction.name;h.flowDownFromId=i.originChangeAction.id;h.flowDownFromTitle=i.originChangeAction.synopsis}}if(UWA.is(l.activities)){var f=new UWA.Class.Collection();var j=l.activities;if(Array.isArray(j)){j.forEach(function(o){o.objectId=l.where.id;var n=f.get(o.id);if(n!=undefined){}else{f.add(new b(o,{parse:true}))}});this.set("activities",f)}}return h},getOperationNameOnUI:function(f){var g="";switch(f){case"None":g=a.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":g=a.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":g=a.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":g=a.ECM_CA_Proposed_Operation_Evolution;break;case"Create":g=a.ECM_CA_Proposed_Operation_Create;break;case"Modify":g=a.ECM_CA_Proposed_Activity_Modify;break;case"ChangeStatus":g=a.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":g=a.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":g=a.ECM_CA_Proposed_Activity_State_Obsolete;break;case"Flowdown":g=a.ECM_CA_Proposed_Operation_Flowdown;break;default:g="??Something went wrong??"}return g},});return c});define("DS/ENOChangeActionUX/scripts/Views/CAIDCardView",["UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","WebappsUtils/WebappsUtils","UWA/Date","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","UWA/Class/Collection","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChangeActionUX/assets/ChangeActionMapping.json"],function(b,i,l,a,d,k,c,e,j,n,g,m,f){var h={referentialCollection:null,containerReference:null,refObject:null,Currmodel:null,caPhysicalId:null,_createView_IdCard:function(o,p,r,q){return b.extend({tagName:o,className:p,model:q,setup:function(t){var u=this;u.listenTo(u.model,"onChange:people",h.renderPropertiesComponent);u.listenTo(u.model,"onChange:userAccess",h.renderPropertiesComponent);var s=h.caTagNavigatorProxy=this.caTagNavigatorProxy=new n();var v="Properties";s._initTaggerProxy(v).then(function(y){var x="Properties";var w=new g();s._setSubjectTags(w,x);a.setTaggerObject(x,s)},function(w){console.log("Tagger initilization failed")})},render:function(){h.referentialCollection=null;h.refObject=this;h.Currmodel=this.model;h.caPhysicalId=this.model.id;console.log(this.model._attributes);var t="";h.containerReference=this.container;var s=new UWA.Element("div");s.setAttributes({id:"DivForEditProp"});s.setStyle("height","100%");h.containerReference.addContent(s);h.createPropertiesComponent().inject(s)}})},createPropertiesComponent:function(){var t=true;var r=false;var o=this.Currmodel.get("userAccess");if(o&&o.Edit==="true"){t=false;r=true}var s=new d({typeOfDisplay:k.ONLY_EDIT_PROPERTIES,selectionType:k.NO_SELECTION,extraNotif:true,editMode:false,setEditButton:r,readOnly:t,events:{onNotification:function(v){a.message(v.msg,v.eventID)}}});var p=h.refObject.model.id.substr(4);var u=[];var q=new c({metatype:"businessobject",tenant:enoviaServerCAWidget.tenant,objectId:p});q.addEvent("onSave",function(w){var v=this;h.updateCAModelOnSave(v)});u.push(q);setTimeout(function(){s.initDatas(u);widget.addEvent("onResize",function(){setTimeout(function(){s.onResize()},100)})},500);enoviaServerCAWidget.PropWidget=s;return s},renderPropertiesComponent:function(){var p=h.refObject.model;var o=document.getElementById("DivForEditProp");if(o){o.empty();h.createPropertiesComponent().inject(o)}},updateCAModelOnSave:function(o){if(o.get("Synopsis")){var q=o.get("Synopsis").value;h.Currmodel.set("subtitle",q);h.Currmodel.set("synopsis",q)}if(o.get("description")){var w=o.get("description").value;h.Currmodel.set("description",w)}if(o.get("Severity")){var u=o.get("Severity").value;h.Currmodel.set("severity",u);var s=JSON.parse(f);var v=s[h.Currmodel.get("severity")];if(UWA.is(v)&&v!=""){v="images/"+v}else{v=s._default;v="images/"+v}h.Currmodel.set("image",e.getWebappsAssetUrl(enoviaServerCAWidget.frameWorkName,v))}if(o.get("Estimated Start Date")){var r="%Y-%m-%d";var t=o.get("Estimated Start Date").value;t=t?j.strftime(h.formatDateObj(t),r):"";h.Currmodel.set("created",t)}if(o.get("Estimated Completion Date")){var r="%Y-%m-%d";var p=o.get("Estimated Completion Date").value;p=p?j.strftime(h.formatDateObj(p),r):"";if(p===""){p=m.ECM_CA_DUEDATE_UNASSIGNED}h.Currmodel.set("due",p)}},formatDateObj:function(q){var p=q.split("@");var r=null;if(p.length>1){var w=p[0].split("/");var s=w[0];var o=w[1];var v=o-1;var y=w[2];var x=p[1].split(":");var z=x[0];var t=x[1];var u=x[2];r=new Date();r.setUTCFullYear(s);r.setUTCDate(1);r.setUTCMonth(v);r.setUTCDate(y);r.setUTCHours(z);r.setUTCMinutes(t);r.setUTCSeconds(u)}return r}};return h});define("DS/ENOChangeActionUX/scripts/Views/CAReferentialView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAReferentialModel","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Item/TileView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/Item/SetView","DS/DataDragAndDrop/DataDragAndDrop","DS/DocumentManagement/DocumentManagement","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENOChangeActionUX/scripts/CASpinner","DS/W3DXComponents/Views/EmptyView","DS/ENOChangeActionUX/scripts/Views/CACustomReferentialTileView","DS/ENOChangeActionUX/scripts/Views/CACustomizedRefActionsView","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","UWA/Controls/Input",],function(r,a,e,t,n,c,i,u,h,j,g,d,s,p,l,m,b,o,f,q){var k={_model:null,caTagNavigatorProxy:null,selectedModelsForDrag:{},isCheckSelected:false,multiSelOn:false,_createView_Referential:function(w,v){return r.extend({model:v,setup:function(){var z=this;if(z.model){k.SearchObj=e.activateSearch(enoviaServerCAWidget.referentialsSearchType,"referentials");var y=this.model.get("referentials");k.originalReferentialsCollection=new UWA.Class.Collection(y.toArray());var x=k.caTagNavigatorProxy=this.caTagNavigatorProxy=new f();var A="Referential";x._initTaggerProxy(A).then(function(D){var C="Referential";x._setSubjectTags(y,C);var B=z._externalEvents={onReferentalTaggerFilterChange:function(E){k.filterTaggerChange(E)}};z.listenTo(x,B);e.setTaggerObject(C,x)},function(B){console.log("Tagger initilization failed");return Promise.reject(B)})}},render:function(){e.CurrModel=this.model;k._model=this.model;var z=k.refrerentialView=k.getReferentialListView(this.model.get("referentials"));var x={onMultiselOff:function(){k.isCheckSelected=false;k.multiSelOn=false;var B=Object.keys(k.selectedModelsForDrag);for(var A in B){delete k.selectedModelsForDrag[B[A]]}},onMultiselOn:function(){k.isCheckSelected=true;k.multiSelOn=true}};this.listenTo(z,x);this.listenTo(this.model,"onChange:referentials",k.updateUIOnRefresh);this.listenTo(this.model,"onChange:userAccess",k.updateHeaderOnAccessUpdate);var y=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}});y.setAttributes({id:"divForReferentialContent"});y.inject(this.container);z.render().inject(y);setTimeout(function(){var A=document.querySelector("#divForReferentialContent");if(A){k.makeDroppable(A)}},1000)}})},getReferentialListView:function(v){var z=(enoviaServerCAWidget.NamePref=="Name")?a.ECM_CA_Table_Header_Name:a.ECM_CA_Table_Header_Title;var x=(enoviaServerCAWidget.NamePref=="Name")?a.ECM_CA_Table_Header_Title:a.ECM_CA_Table_Header_Name;var w=(enoviaServerCAWidget.NamePref=="Name")?"objectName":"objectTitle";var y=(enoviaServerCAWidget.NamePref=="Name")?"objectTitle":"objectName";var A=new g({collection:v,detail:{title:a.ECM_CA_CounterView_Title},actions:{collection:k.getTopActions(),events:{onActionClick:function(C){var B=C.model.get("id");switch(B){case"add":k.searchReferential();break;case"upload":k.uploadReferential();break;default:console.log(B+" is not permitted.");break}}},view:o},buildMultiselActions:function(G){var F=[];var D=true;if(UWA.is(e.CurrModel.get("userAccess"))){var C=e.CurrModel.get("userAccess");if((C.DeleteReferential&&C.DeleteReferential==="false")||(!C.DeleteReferential)){D=false}}var B={id:"download",text:a.ECM_CA_Download,fonticon:"download",icon:"download",multisel:true,handler:function(J){var H=[];var I="false";J.forEach(function(K){if("Document"==K.get("type")){H.push(K.get("id").slice(4))}else{I="true"}});if(I=="true"){e.info(a.ECM_CA_Download_Skipped)}k.downloadDocuments(H)}};if(window.enoviaServerCAWidget.CHG_DOWNLOAD_REFERENTIAL=="true"){F.push(B)}if(D===false){return F}var E={id:"delete",text:a.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(I){var H=[];I.forEach(function(J){H.push(J.get("id"))});k.removeReferential(H,true)}};if(enoviaServerCAWidget.isNative){E.icon="I_ChangeCnxObjTrash"}F.push(E);return F},contents:{views:[{id:"tile",title:a.ECM_CA_Switch_TileView,view:c,itemView:b,"default":true},{id:"table",title:a.ECM_CA_Switch_TableView,view:h,itemView:j}],selectionMode:"nullToMany",useInfiniteScroll:false,usePullToRefresh:false,emptyView:m.extend({defaultOptions:{icon:"drag-drop",title:a.ECM_CA_Referential_Drop_Here}}),events:{onItemViewClick:function(){var D=document.createElement("input");D.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:",""));D.setAttribute("data-type",arguments[1].model.get("type"));var C=k.selectedModelsForDrag[arguments[1].model.get("id")];if(C){if(k.isCheckSelected===true){delete k.selectedModelsForDrag[arguments[1].model.get("id")]}var E=Object.keys(k.selectedModelsForDrag);if(E.length===0&&k.multiSelOn===false){k.isCheckSelected=false}}else{if(!k.isCheckSelected){var E=Object.keys(k.selectedModelsForDrag);for(var B in E){delete k.selectedModelsForDrag[E[B]]}if(enoviaServerCAWidget.arrOid&&enoviaServerCAWidget.arrOid.length){enoviaServerCAWidget.arrOid.splice(0,enoviaServerCAWidget.arrOid.length)}}D.setAttribute("class","selected");k.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model}p.onClickItem.call(D,widget,enoviaServerCAWidget)},onItemViewCheck:function(){var C=document.createElement("input");C.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:",""));C.setAttribute("data-type",arguments[1].model.get("type"));if(arguments[2].target.checked){k.caTagNavigatorProxy.deactivateTaggerProxy();k.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model;C.setAttribute("class","selected");k.isCheckSelected=true}else{k.caTagNavigatorProxy.activateTaggerProxy();var B=k.selectedModelsForDrag[arguments[1].model.get("id")];if(B){delete k.selectedModelsForDrag[arguments[1].model.get("id")];var D=Object.keys(k.selectedModelsForDrag);if(D.length===0&&k.multiSelOn===false){k.isCheckSelected=false}}}p.onClickItem.call(C,widget,enoviaServerCAWidget)},onItemViewDrag:function(){var H=Object.keys(k.selectedModelsForDrag);if(H.length&&k.isCheckSelected){var E=false;var D=arguments[1].model.get("id");var H=Object.keys(k.selectedModelsForDrag);for(var G in H){var F=k.selectedModelsForDrag[H[G]];if(F.id===D){E=true;break}}if(E){arguments[1]=k.selectedModelsForDrag}else{var C={};C[arguments[1].model.get("id")]=arguments[1].model;arguments[1]=C}}else{var C={};C[arguments[1].model.get("id")]=arguments[1].model;arguments[1]=C}var B={caId:k._model.get("id"),};e.onItemViewDragForContents(arguments,B)},},headers:[{property:w,sortable:true,label:z},{property:y,sortable:true,label:x},{property:"current",sortable:true,label:a.ECM_CA_Table_Header_Maturity},{property:"ownerFullname",sortable:true,label:a.ECM_CA_Table_Header_Owner},{label:a.ECM_CA_Table_Header_Action,actions:true}],itemViewOptions:k.getitemViewOptions(),}});return A},getRefItemActions:function(){var z=this;var y=[];if(z.itemView&&z.itemView.model&&z.itemView.model.get("Access")){if(!enoviaServerCAWidget.isNative){y.push({id:"Details",text:a.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:true,handler:function(B){var F=z.itemView.model.get("id").replace("pid:","");var C="/common/emxTree.jsp?mode=insert&objectId="+F;var E=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var D=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+E+"&forwardUrl="+C);var A=window.open();A.opener=null;A.location.href=D}})}}if(z.itemView&&z.itemView.model&&z.itemView.model.get("Access")){y.push({id:"Properties",text:a.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:true,handler:function(A){var B=z.itemView.model.get("id").replace("pid:","");e.createPropertiesComponent(B)}})}var v={id:"download",text:a.ECM_CA_Download,fonticon:"download",icon:"fonticon-download",multisel:true,handler:function(A){var C=z.itemView.model.get("id").slice("4");var B=[];B.push(C);k.downloadDocuments(B)}};if(window.enoviaServerCAWidget.CHG_DOWNLOAD_REFERENTIAL=="true"){if(z.itemView&&z.itemView.model&&"Document"==z.itemView.model.get("type")){y.push(v)}}var x=true;if(UWA.is(e.CurrModel.get("userAccess"))){var w=e.CurrModel.get("userAccess");if((w.DeleteReferential&&w.DeleteReferential==="false")||(!w.DeleteReferential)){x=false}}if(x===false){return y}y.push({id:"remove",text:a.ECM_CA_Remove_Referential,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(A){var C=z.itemView.model.get("id");var B=[];B.push(C);k.removeReferential(B,false)}});return y},getitemViewOptions:function(){var v={mapping:{title:(enoviaServerCAWidget.NamePref=="Name")?"objectName":"objectTitle",subtitle:(enoviaServerCAWidget.NamePref=="Name")?"objectTitle":"objectName",content:"content"},actionButtonBinding:function(w){w.container.getElement(".actions-inline-dotted").removeClassName("hidden");w.container.getElement(".actions-inline-dotted").addEvent("click",function(x){w.dispatchEvent("onActionClickDotted",w)})},contextualActions:k.getRefItemActions(),events:{onActionClickDotted:function(w){k.itemView=w;if(w.model.get("Access")&&enoviaServerCAWidget.isNative){e.DispatchEventToWin("Referential_ContextMenu",w.model.get("id").replace("pid:",""))}else{k.DisplayContextMenu([])}}}};return v},DisplayContextMenu:function(w){var v=k.getRefItemActions();w.push.apply(w,v);k.itemView.updateContextualActions(w);var x=k.itemView.container.getElement(".actions-inline-dotted .action-icon-wrapper");e._initDropDown(w,x)},getTopActions:function(){var v=true;if(UWA.is(e.CurrModel)&&UWA.is(e.CurrModel.get("userAccess"))){var x=e.CurrModel.get("userAccess");if((x.AddReferential&&x.AddReferential==="false")||(!x.AddReferential)){v=false}}var w=[];if(v){w.push({id:"add",title:a.ECM_CA_Add_Referential,icon:"plus",overflow:false});w.push({id:"upload",title:a.ECM_CA_Upload_Referential,icon:"upload",overflow:false})}var y=new u(w);return y},makeDroppable:function(v){d.droppable(v,{drop:function(A,y,w){if(w.stopPropagation){w.stopPropagation()}if(w.preventDefault){w.preventDefault()}if(w.dataTransfer&&w.dataTransfer.dropEffect){w.dataTransfer.dropEffect="copy"}if(UWA.is(w)&&UWA.is(w.dataTransfer.files)&&w.dataTransfer.files.length!=0){var z=w.dataTransfer.files;k.createDocument(z);k.AfterDrop()}else{if(UWA.is(A)&&A!=""){var B=JSON.parse(A);var x=e.checkTenantInforamation(B);if(x.TenantInfoMissing.length!=0){e.error(a.ECM_CA_Pref_PlatformMissing_Error)}else{if(x.DiffTenantData.length!=0){e.error(a.ECM_CA_Pref_PlatformDoesNotMatch_Error)}else{B=e.removeDuplicatesToBeDroppedObjects(B);k.ExecuteDrop(B)}}}else{l.endWait(widget.body);e.error(a.ECM_CA_Drop_Not_Supported)}}},over:function(){var w=arguments[0];w.setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){var w=arguments[0];w.setStyle("borderWidth","0px")}})},ExecuteDrop:function(A){if(A){var v=A.data.items;if(UWA.is(v)&&UWA.is(v.length)&&v.length>0){var y=[];var z=0;for(var x=0;x<v.length;x++){var w=[];if(k._model.get("referentialsExcludeList").indexOf("pid:"+v[x].objectId)!=-1){z++}else{w.push(v[x].objectId);y.push(w)}}if(z!=0){e.warn(a.ECM_CA_Referential_Already_Added)}if(y.length!=0){k.addReferential(y)}}else{l.endWait(widget.body);e.error(a.ECM_CA_Drop_Not_Supported)}}k.AfterDrop()},AfterDrop:function(){var v=document.querySelector("#divForReferentialContent");v.setStyle("borderWidth","0px")},searchReferential:function(){if(enoviaServerCAWidget.isNative){var v="Add_Referentials";e.DispatchEventToWin(v,"Referential")}else{e.search("referentials",enoviaServerCAWidget.referentialsSearchType,k.OnSearchComplete,"referentials",k.SearchObj)}},uploadReferential:function(w){var v=new q.File("Input.File",{visibility:"hidden",styles:{display:"none"}});v.elements.container.setStyle("display","none");v.elements.input.accept="all";v.elements.input.multiple=true;v.elements.input.addEventListener("change",function(y){v.destroy();v=null;var x=y.target.files;k.createDocument(x)},false);v.elements.input.addEventListener("click",function(x){x.stopPropagation()});v.inject(document.body);v.elements.input.click()},createDocument:function(A){l.doWait(widget.body);var B="";for(var z=0,y;y=A[z];z++){B=y.name;var x={};x.onFailure=function(C){l.endWait(widget.body);if(UWA.is(C)&&UWA.is(C.error)&&C.error!=""){e.error(C.error)}else{e.error(a.ECM_CA_Drop_Not_Supported)}};x.onComplete=function(C){e.getCADetails(k._model.get("id")).then(function(E){var D=E.changeaction.referentials;k.updateUIOnReferentialAdd(D);l.endWait(widget.body)},function(D){console.log("failed");l.endWait(widget.body);return Promise.reject(D)})};x.onTimeout=function(){l.endWait(widget.body);console.log("timed out, try again!")};x.tenantUrl=enoviaServerCAWidget.baseURL;x.tenant=enoviaServerCAWidget.tenant;x.securityContext=enoviaServerCAWidget.getSecurityContext();var v={parentDirection:"from",parentRelName:"Related Item",parentId:k._model.get("id").replace("pid:","")};var w={title:B?B.slice(0,B.lastIndexOf(".")):"",fileInfo:{file:y},relInfo:v};s.createDocument(w,x)}},downloadDocuments:function(w){var v={tenant:enoviaServerCAWidget.tenant,securityContext:enoviaServerCAWidget.getSecurityContext(),tenantUrl:enoviaServerCAWidget.baseURL,autoDownload:true,onFailure:function(x){console.log("download failed :"+x);e.error(a.ECM_CA_Download_Error)},onComplete:function(x){if(UWA.is(x,"array")){x.forEach(function(y){if(y.downloadUrl){e.getBlobObject(y.downloadUrl,function(){var A=this.response;if(window.navigator.msSaveOrOpenBlob){var B=this.getResponseHeader("content-type");window.navigator.msSaveOrOpenBlob(new Blob([A],{type:B}),y.fileName)}else{var z=UWA.createElement("a",{href:window.URL.createObjectURL(A),download:y.fileName,type:"application/octet-stream"});z.dispatchEvent(new MouseEvent("click",{bubbles:true,cancelable:true,view:window}))}console.log("download docuemnt sucess...!")})}else{}})}}};s.downloadDocuments(w,v)},addReferential:function(v){var x=k.addToReferentialJSON(v);var w=function(z){var y=z.changeaction.referentials;k.updateUIOnReferentialAdd(y)};e.addReferentialToCA(x,k._model.get("id"),w,null)},updateUIOnReferentialAdd:function(v){var w=k._model.get("referentials");for(var x=0;x<v.length;x++){w.unshift(new n(v[x],{parse:true}))}e.enrichCollection(w).then(function(z){e.updateExcludeList(k._model,"referentials");k.originalReferentialsCollection=new UWA.Class.Collection(w.toArray());k.refrerentialView.collection.reset();k.refrerentialView.collection.push(k.originalReferentialsCollection.toArray());var y="Referential";k.caTagNavigatorProxy._setSubjectTags(w,y)});k._model.set("referentials",w)},updateUIOnRefresh:function(v){var w=this.model.get("referentials");var x=new UWA.Class.Collection(w.toArray());k.originalReferentialsCollection=x;w.reset();k.refrerentialView.collection.reset();k.refrerentialView.collection.push(x.toArray());w.push(k.originalReferentialsCollection.toArray());var y="Referential";this.caTagNavigatorProxy._setSubjectTags(k.originalReferentialsCollection,y)},removeReferential:function(w,z){var x=k.removeReferentialJSON(w);var A=JSON.parse(x);var y=A.changeaction["delete"].referentials;var v=function(D){var B=k._model.get("referentials");B.reset();B.add(k.originalReferentialsCollection.toArray());B.remove(y);e.updateExcludeList(k._model,"referentials");k.originalReferentialsCollection=new UWA.Class.Collection(B.toArray());k._model.set("referentials",B);k.refrerentialView.collection.reset();k.refrerentialView.collection.push(k.originalReferentialsCollection.toArray());var C="Referential";k.caTagNavigatorProxy._setSubjectTags(B,C)};e.removeReferentialFromCA(x,k._model.get("id"),v,null)},OnSearchComplete:function(v){if(enoviaServerCAWidget.isNative){var A=v.split("~");var z=[];for(var y=0;y<A.length;y++){z.push(A[y])}var x=[];for(var w=0;w<A.length;w++){x.push(z[w].split(","))}k.addReferential(x)}else{k.addReferential(v)}},addToReferentialJSON:function(v){var w=JSON.stringify({version:"v0",changeaction:{add:{referentials:k.jsonReferential(v)}}});return w},jsonReferential:function(v){var z=[];var x="";for(var w=0;w<v.length;w++){var y=v[w];z.push("pid:"+y[0])}return z},jsonRemoveReferential:function(v){var y=[];var x="";for(var w=0;w<v.length;w++){y.push(v[w])}return y},removeReferentialJSON:function(v){var w=JSON.stringify({version:"v0",changeaction:{"delete":{referentials:k.jsonRemoveReferential(v)}}});return w},filterTaggerChange:function(w){var y=k.refrerentialView.collection;var A=[];for(var C in w){var D=w[C];var v=k.originalReferentialsCollection.toArray();var z=k.originalReferentialsCollection.findWhere({id:D});var x=[];if(z){A.push(z)}}if(y.length!=k.originalReferentialsCollection.length){y.reset();var v=k.originalReferentialsCollection.toArray();y.add(v)}var B=y.without(A);y.remove(B)},updateHeaderOnAccessUpdate:function(){k.refrerentialView.actionsView.collection.reset();k.refrerentialView.actionsView.collection.push(k.getTopActions().toArray());k.refrerentialView.actionsView.show()}};return k});define("DS/ENOChangeActionUX/scripts/Views/CAContextView",["DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENOChangeActionUX/scripts/Models/CAContextModel","DS/ENOChangeActionUX/scripts/CASpinner","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/DataDragAndDrop/DataDragAndDrop","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/SetView","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Item/TileView","DS/ENOChangeActionUX/scripts/Views/CACustomContextTileView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/EmptyView","UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy",],function(f,n,p,l,b,d,r,g,c,j,q,i,k,m,o,a,h){var e={_model:null,caTagNavigatorProxy:null,selectedModelsForDrag:{},isCheckSelected:false,multiSelOn:false,_createView_Context:function(t,s){return o.extend({model:s,setup:function(){var v=this;if(v.model){e.SearchObj=f.activateSearch(enoviaServerCAWidget.contextSearchType,"context");var w=this.model.get("context");e.originalContextCollection=new UWA.Class.Collection(w.toArray());var u=e.caTagNavigatorProxy=this.caTagNavigatorProxy=new h();var x="Context";u._initTaggerProxy(x).then(function(A){var z="Context";u._setSubjectTags(w,z);var y=v._externalEvents={onContextTaggerFilterChange:function(B){e.filterTaggerChange(B)}};v.listenTo(u,y);f.setTaggerObject(z,u)},function(y){console.log("Tagger initilization failed")})}},render:function(){f.CurrModel=this.model;e._model=this.model;var v=e.contextualView=e.getContextListView(this.model.get("context"));var u={onMultiselOff:function(){e.isCheckSelected=false;e.multiSelOn=false;var y=Object.keys(e.selectedModelsForDrag);for(var x in y){delete e.selectedModelsForDrag[y[x]]}if(enoviaServerCAWidget.arrOid&&enoviaServerCAWidget.arrOid.length){enoviaServerCAWidget.arrOid.splice(0,enoviaServerCAWidget.arrOid.length)}},onMultiselOn:function(){e.isCheckSelected=true;e.multiSelOn=true}};this.listenTo(v,u);this.listenTo(this.model,"onChange:context",e.updateUIOnRefresh);this.listenTo(this.model,"onChange:userAccess",e.updateHeaderOnAccessUpdate);var w=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}});w.setAttributes({id:"divForContextContent"});w.inject(this.container);v.render().inject(w);setTimeout(function(){var x=document.querySelector("#divForContextContent");if(x){e.makeDroppable(x)}},1000)}})},getContextListView:function(v){var x=(enoviaServerCAWidget.NamePref=="Name")?b.ECM_CA_Table_Header_Name:b.ECM_CA_Table_Header_Title;var u=(enoviaServerCAWidget.NamePref=="Name")?b.ECM_CA_Table_Header_Title:b.ECM_CA_Table_Header_Name;var t=(enoviaServerCAWidget.NamePref=="Name")?"objectName":"objectTitle";var w=(enoviaServerCAWidget.NamePref=="Name")?"objectTitle":"objectName";var s=new g({collection:v,detail:{title:b.ECM_CA_Context_Counter_Title},actions:{collection:e.getcontextTopActions(),events:{onActionClick:function(y,B,z){var A=B.model.get("id");switch(A){case"add":e.searchContext();break;default:console.log(A+" is not permitted.");break}}}},buildMultiselActions:function(C){var B=[];var z=true;if(UWA.is(f.CurrModel.get("userAccess"))){var y=f.CurrModel.get("userAccess");if((y&&y.DeleteContext&&y.DeleteContext==="false")||(!y.DeleteContext)){z=false}}if(z===false){return B}var A={id:"remove",text:b.ECM_CA_Remove_context,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(E){var D=[];E.forEach(function(F){D.push(F.get("id"))});e.removeContext(D,true)}};if(enoviaServerCAWidget.isNative){A.icon="I_ChangeCnxObjTrash"}B.push(A);return B},contents:{views:[{id:"tile",title:b.ECM_CA_Switch_TileView,view:c,itemView:q},{id:"table",title:b.ECM_CA_Switch_TableView,view:i,itemView:k}],selectionMode:"nullToMany",useInfiniteScroll:false,usePullToRefresh:false,emptyView:m.extend({defaultOptions:{icon:"drag-drop",title:b.ECM_CA_Context_Drop_Here}}),events:{onItemViewClick:function(){var A=document.createElement("input");A.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:",""));A.setAttribute("data-type",arguments[1].model.get("type"));var z=e.selectedModelsForDrag[arguments[1].model.get("id")];if(z){if(e.isCheckSelected===true){delete e.selectedModelsForDrag[arguments[1].model.get("id")]}else{A.setAttribute("class","selected")}var B=Object.keys(e.selectedModelsForDrag);if(B.length===0&&e.multiSelOn===false){e.isCheckSelected=false}}else{if(e.isCheckSelected===false){var B=Object.keys(e.selectedModelsForDrag);for(var y in B){delete e.selectedModelsForDrag[B[y]]}if(enoviaServerCAWidget.arrOid&&enoviaServerCAWidget.arrOid.length){enoviaServerCAWidget.arrOid.splice(0,enoviaServerCAWidget.arrOid.length)}}A.setAttribute("class","selected");e.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model}n.onClickItem.call(A,widget,enoviaServerCAWidget)},onItemViewCheck:function(){var z=document.createElement("input");z.setAttribute("data-pid",arguments[1].model.get("id").replace("pid:",""));z.setAttribute("data-type",arguments[1].model.get("type"));if(arguments[2].target.checked){e.caTagNavigatorProxy.deactivateTaggerProxy();e.selectedModelsForDrag[arguments[1].model.get("id")]=arguments[1].model;z.setAttribute("class","selected");e.isCheckSelected=true}else{e.caTagNavigatorProxy.activateTaggerProxy();var y=e.selectedModelsForDrag[arguments[1].model.get("id")];if(y){delete e.selectedModelsForDrag[arguments[1].model.get("id")];var A=Object.keys(e.selectedModelsForDrag);if(A.length===0&&e.multiSelOn===false){e.isCheckSelected=false}}}n.onClickItem.call(z,widget,enoviaServerCAWidget)},onItemViewDrag:function(){var E=Object.keys(e.selectedModelsForDrag);if(E.length&&e.isCheckSelected){var B=false;var A=arguments[1].model.get("id");var E=Object.keys(e.selectedModelsForDrag);for(var D in E){var C=e.selectedModelsForDrag[E[D]];if(C.id===A){B=true;break}}if(B){arguments[1]=e.selectedModelsForDrag}else{var z={};z[arguments[1].model.get("id")]=arguments[1].model;arguments[1]=z}}else{var z={};z[arguments[1].model.get("id")]=arguments[1].model;arguments[1]=z}var y={caId:e._model.get("id"),};f.onItemViewDragForContents(arguments,y)},},headers:[{property:t,sortable:true,label:x},{property:w,sortable:true,label:u},{property:"current",sortable:true,label:b.ECM_CA_Table_Header_Maturity},{property:"ownerFullname",sortable:true,label:b.ECM_CA_Table_Header_Owner},{label:b.ECM_CA_Table_Header_Action,actions:true}],itemViewOptions:e.getitemViewOptions(),}});return s},getcontextTopActions:function(){var v=true;if(UWA.is(f.CurrModel)&&UWA.is(f.CurrModel.get("userAccess"))){var s=f.CurrModel.get("userAccess");if((s.AddContext&&s.AddContext==="false")||(!s.AddContext)){v=false}}var u=[];if(v){u.push({id:"add",title:b.ECM_CA_Add_Context,icon:"plus",overflow:false})}var t=new r(u);return t},getcontextItemActions:function(){var v=this;var u=[];if(v.itemView&&v.itemView.model&&v.itemView.model.get("Access")){if(!enoviaServerCAWidget.isNative){u.push({id:"Details",text:b.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:true,handler:function(x){var B=v.itemView.model.get("id").replace("pid:","");var y="/common/emxTree.jsp?mode=insert&objectId="+B;var A=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var z=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+A+"&forwardUrl="+y);var w=window.open();w.opener=null;w.location.href=z}})}}if(v.itemView&&v.itemView.model&&v.itemView.model.get("Access")){u.push({id:"Properties",text:b.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:true,handler:function(w){var x=v.itemView.model.get("id").replace("pid:","");f.createPropertiesComponent(x)}})}var t=true;if(UWA.is(f.CurrModel.get("userAccess"))){var s=f.CurrModel.get("userAccess");if((s.DeleteContext&&s.DeleteContext==="false")||(!s.DeleteContext)){t=false}}if(t===false){return u}u.push({id:"remove",text:b.ECM_CA_Remove_context,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(w){var x=v.itemView.model.get("id");var y=[];y.push(x);e.removeContext(y,false)}});return u},getitemViewOptions:function(){var s={actionButtonBinding:function(t){t.container.getElement(".actions-inline-dotted").removeClassName("hidden");t.container.getElement(".actions-inline-dotted").addEvent("click",function(u){t.dispatchEvent("onActionClickDotted",t)})},contextualActions:e.getcontextItemActions(),events:{onActionClickDotted:function(t){e.itemView=t;if(t.model.get("Access")&&enoviaServerCAWidget.isNative){f.DispatchEventToWin("Context_ContextMenu",t.model.get("id").replace("pid:",""))}else{e.DisplayContextMenu([])}}}};return s},makeDroppable:function(s){d.droppable(s,{drop:function(w,v,t){if(t.stopPropagation){t.stopPropagation()}if(t.preventDefault){t.preventDefault()}if(t.dataTransfer&&t.dataTransfer.dropEffect){t.dataTransfer.dropEffect="copy"}if(UWA.is(w)&&w!=""){var x=JSON.parse(w);var u=f.checkTenantInforamation(x);if(u.TenantInfoMissing.length!=0){f.error(b.ECM_CA_Pref_PlatformMissing_Error)}else{if(u.DiffTenantData.length!=0){f.error(b.ECM_CA_Pref_PlatformDoesNotMatch_Error)}else{x=f.removeDuplicatesToBeDroppedObjects(x);e.ExecuteDrop(x)}}}else{l.endWait(widget.body);f.error(b.ECM_CA_Drop_Not_Supported)}},over:function(){var t=arguments[0];t.setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){var t=arguments[0];t.setStyle("borderWidth","0px")}})},ExecuteDrop:function(w){if(w){var t=w.data.items;if(UWA.is(t)&&UWA.is(t.length)&&t.length>0){var s=[];var x=0;for(var y=0;y<t.length;y++){var u=[];if(e._model.get("contextExcludeList").indexOf("pid:"+t[y].objectId)!=-1){x++}else{u.push(t[y].objectId);s.push(u)}}if(x!=0){f.warn(b.ECM_CA_Context_Already_Added)}if(s.length!=0){e.addContext(s)}}}else{l.endWait(widget.body);f.error(b.ECM_CA_Drop_Not_Supported)}var v=document.querySelector("#divForContextContent");v.setStyle("borderWidth","0px")},DisplayContextMenu:function(t){var s=e.getcontextItemActions();t.push.apply(t,s);e.itemView.updateContextualActions(t);var u=e.itemView.container.getElement(".actions-inline-dotted .action-icon-wrapper");f._initDropDown(t,u)},searchContext:function(){if(enoviaServerCAWidget.isNative){var s="Add_Context";f.DispatchEventToWin(s,"Context")}else{f.search("context",enoviaServerCAWidget.contextSearchType,e.OnSearchComplete,"context",e.SearchObj)}},OnSearchComplete:function(s){if(enoviaServerCAWidget.isNative){var x=s.split("~");var w=[];for(var v=0;v<x.length;v++){w.push(x[v])}var u=[];for(var t=0;t<x.length;t++){u.push(w[t].split(","))}e.addContext(u)}else{e.addContext(s)}},updateUIOnRefresh:function(s){var u=this.model.get("context");var t=new UWA.Class.Collection(u.toArray());e.originalContextCollection=t;u.reset();e.contextualView.collection.reset();e.contextualView.collection.push(t.toArray());u.push(e.originalContextCollection.toArray());var v="Context";this.caTagNavigatorProxy._setSubjectTags(e.originalContextCollection,v)},addContext:function(s){var v=e.addToContextJSON(s);var t=JSON.parse(v);var u=function(y){var x=e._model.get("context");var w=y.changeaction.context;for(var z=0;z<w.length;z++){x.unshift(new p(w[z],{parse:true}))}f.enrichCollection(x).then(function(B){f.updateExcludeList(e._model,"context");e.originalContextCollection=new UWA.Class.Collection(x.toArray());e.contextualView.collection.reset();e.contextualView.collection.push(e.originalContextCollection.toArray());var A="Context";e.caTagNavigatorProxy._setSubjectTags(x,A);l.endWait(widget.body)});e._model.set("context",x)};f.editCA(v,e._model.get("id"),u,null)},addToContextJSON:function(s){var t=JSON.stringify({version:"v0",changeaction:{add:{context:e.jsonContext(s)}}});return t},jsonContext:function(s){var v=[];for(var t=0;t<s.length;t++){var u=s[t];v.push("pid:"+u[0])}return v},removeContext:function(t,x){var s=e.removeContextJSON(t);var u=JSON.parse(s);var w=u.changeaction["delete"].context;var v=function(A){var y=e._model.get("context");y.reset();y.add(e.originalContextCollection.toArray());y.remove(w);f.updateExcludeList(e._model,"context");e.originalContextCollection=new UWA.Class.Collection(y.toArray());e.contextualView.collection.reset();e.contextualView.collection.push(e.originalContextCollection.toArray());var z="Context";e.caTagNavigatorProxy._setSubjectTags(y,z);l.endWait(widget.body)};f.editCA(s,e._model.get("id"),v,null)},removeContextJSON:function(s){var t=JSON.stringify({version:"v0",changeaction:{"delete":{context:e.jsonRemoveContext(s)}}});return t},jsonRemoveContext:function(s){var u=[];for(var t=0;t<s.length;t++){u.push(s[t])}return u},filterTaggerChange:function(u){var s=e.contextualView.collection;if(s===null||s===undefined){return}var x=[];for(var z in u){var A=u[z];var t=e.originalContextCollection.toArray();var w=e.originalContextCollection.findWhere({id:A});var v=[];if(w){x.push(w)}}if(s.length!=e.originalContextCollection.length){s.reset();var t=e.originalContextCollection.toArray();s.add(t)}var y=s.without(x);s.remove(y)},updateHeaderOnAccessUpdate:function(){e.contextualView.actionsView.collection.reset();e.contextualView.actionsView.collection.push(e.getcontextTopActions().toArray());e.contextualView.actionsView.show()}};return e});define("DS/ENOChangeActionUX/scripts/Controller/CADependencyController",["UWA/Core","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","WebappsUtils/WebappsUtils","UWA/Date","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChangeActionUX/assets/ChangeActionMapping.json","DS/Core/Core","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/UIKIT/SuperModal","UWA/Class",],function(j,l,b,f,k,m,h,i,a,g,d,c){var e={selectedIDs:[],treeObj:null,dependencyType:"",buildSearch:function(){e.SearchObj=b.activateSearch("Change Action, Change Order","Depend")},setContextCAModel:function(n){e.contextCAModel=n},setCurrentTreeObj:function(n){e.treeObj=n},getCurrentTreeObj:function(){return e.treeObj},getModelForTreeListView:function(){var o=this;var n=e.sharedModel=new a({useAsyncPreExpand:true,});n.onPreExpand(function(p){e.onPreExpandTreeNode(p)});e.buildTreeNodes();g.prototype.getID=function(){return this._options.resourceid};g.prototype.getLinkID=function(){return this._options.linkid};g.prototype.getCurrentMaturityState=function(){return this._options.grid.maturity};g.prototype.getObjectType=function(){return this._options.data.objectType};g.prototype.getDependencyType=function(){return this._options.data.dependencyType};return n},syncChangeDependency:function(){var s=e.sharedModel.getSelectedNodes();var p=[];if(s&&Array.isArray(s)){s.forEach(function(u){var t="";if(u){t=u.getID()}if(t!=""){p.push(t)}})}var o="/resources/modeler/change/utils/synchronizeChanges";var n={changeToSynchronize:p};var r=function(u,t){b.error(m.ECM_CA_Action_EBOMSync_Failed)};var q=function(x){var u=new d({closable:true,renderTo:widget.body});var w="";var t="";var v="";v=m.ECM_CA_EBOMSync_Successful;w="<p>                                <!--h6>"+t+"</h6-->                                <ul>                                    <li>"+v+"</li>                                </ul>                            </p>";u.dialog({body:w,title:m.ECM_CA_Action_EBOMSync_CollabStatus,buttons:[{className:"primary",value:m.ECM_CA_Collab_Dialog_Done,action:function(y){y.hide()}}]})};b.makeWSCall(o,"POST","enovia","application/json",JSON.stringify(n),q,null)},addDependency:function(){window.addEventListener("storage",function(s){if(s.storageArea===sessionStorage){if(sessionStorage.searchList!=undefined&&sessionStorage.searchList!=""){var t=sessionStorage.searchList.split(",");for(var q=0;q<t.length;q++){var r={};r.value=t[q];r.label="";var p={"0":[r.value]};e.OnSearchComplete(p)}sessionStorage.removeItem("searchList")}else{console.log("inside EVENT ******************************************")}}});e.dependencyType="Dependency";if(enoviaServerCAWidget.isNative){var n="Add_Dependency";b.DispatchEventToWin(n,"Add_Dependency")}else{if(enoviaServerCAWidget.is3DSpace){var o="../common/emxFullSearch.jsp?field=TYPES=type_ChangeOrder,type_ChangeAction:ECM_CHANGE_ONHOLD!=True:CURRENT!=policy_FormalChange.state_Cancelled:CURRENT!=policy_FormalChange.state_OnHold&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency";showChooser(o,850,630)}else{b.search("Depend","Change Action, Change Order",e.OnSearchComplete,"Depend",e.SearchObj)}}},addCoDependency:function(){window.addEventListener("storage",function(s){if(s.storageArea===sessionStorage){if(sessionStorage.searchList!=undefined&&sessionStorage.searchList!=""){var t=sessionStorage.searchList.split(",");for(var q=0;q<t.length;q++){var r={};r.value=t[q];r.label="";var p={"0":[r.value]};e.OnSearchComplete(p)}sessionStorage.removeItem("searchList")}else{console.log("inside EVENT ******************************************")}}});e.dependencyType="CoDependency";if(enoviaServerCAWidget.isNative){var n="Add_CoDependency";b.DispatchEventToWin(n,"Add_Dependency")}else{if(enoviaServerCAWidget.is3DSpace){var o="../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction,type_ChangeOrder:ECM_CHANGE_ONHOLD!=True:CURRENT!=policy_FormalChange.state_Cancelled:CURRENT!=policy_FormalChange.state_OnHold&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency";showChooser(o,850,630)}else{b.search("Depend","Change Action, Change Order",e.OnSearchComplete,"Depend",e.SearchObj)}}},remove:function(n){var q=function(){var w={};var x=function(C){var D=e.sharedModel.getSelectedNodes();var A=D[D.length-1];if(A){if(A.isRoot()){e.sharedModel.removeRoot(A)}else{if(A.options.data.dependencyType==="Co-Dependency"){var y=A.getParent();var z=e.contextCAModel.get("id");var B=y.getID();if(z===B||A.getID()===z){y.remove()}}var y=A.getParent();y.removeChild(A)}}};w.onComplete=x;if(e.contextCAModel.get("type")==="Change Action"){e.contextCAModel.fetch(w)}else{x({})}};var r=function(){console.log("Remove link failed")};var s="";var t="";var v=null;var u=e.sharedModel.getSelectedNodes();u.forEach(function(w){if(w){t=w.getID();s=w.getLinkID();v=w.getBadges()}});if(v&&v.bottomRight&&v.bottomRight!=""){b.error(m.ECM_ALREADY_CONSUMED_LINK);s=""}else{if(s===""){b.error(m.ECM_NO_NODE_SELECTED)}else{var o="/resources/changedependencies/services/remove/"+s;var p="";b.makeWSCall(o,"PUT","enovia","application/json",p,q,r)}}},OnSearchComplete:function(x){var v=e.sharedModel.getSelectedNodes();var s=v[v.length-1];var o="";if(s&&(s!=null)){o=s.getID()}if(s===null||!o){o=e.contextCAModel.get("id")}var t,w="";if(window.enoviaServerCAWidget.isNative){x=x.split(",");t=x[0]}else{t=x[0][0]}w=o.slice(4,o.length);var u=(e.dependencyType==="Dependency")?"prerequisite":"corequisite";var q={version:"v0",type:u,to:"pid:"+t,from:"pid:"+w,};var p=function(A){console.log("add Dependency successful");l.doWait(widget.body);var B=null;if(s&&(s!=null)){B=s.getChildren()}var y=[];if(Array.isArray(B)&&B.length){y=B.map(function(C){return C.getID()})}var z=b.buildDependencyModel(A.elements,A.originid,y);if(!s){e.contextCAModel.set("dependencyObjects",z)}e.buildTreeNodes(s,z);if(s){s.expand()}l.endWait(widget.body)};var r=function(){console.log("Add Dependency failed")};var n="/resources/changedependencies/services/create";b.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(q),p,r)},openIn3DSpace:function(){var s=e.sharedModel.getSelectedNodes()[0];var p=s.getID();p=p.slice(4,p.length);if(enoviaServerCAWidget.isNative){b.DispatchEventToWin("ExploreInCollabNApproval",p)}else{var o="/common/emxTree.jsp?mode=insert&objectId="+p;var r=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var q=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+r+"&forwardUrl="+o);var n=window.open();n.opener=null;n.location.href=q}},showPropertyPanel:function(){var o=e.sharedModel.getSelectedNodes()[0];var n=o.getID();n=n.slice(4,n.length);b.createPropertiesComponent(n)},onDragStartCell:function(q,p){var o=p.nodeModel.options.data;var n={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:[{envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:"",objectId:o.objectId.slice(4,o.objectId.length),objectType:o.objectType,displayName:o.displayName,displayType:o.displayType}]}};q.dataTransfer.setData("Text",JSON.stringify(n))},createTreeNodeModel:function(q){var o=enoviaServerCAWidget.NamePref;var r=function(t){var s=[];if(t.type==="Change Action"){s.push(enoviaServerCAWidget.baseURL+"/common/images/iconSmallChangeAction.png")}else{if(t.type==="Change Order"){s.push(enoviaServerCAWidget.baseURL+"/common/images/iconSmallChangeOrder.png")}}return s};var n=function(t){var s={};if(t.consumed===true){s.bottomRight="http://upload.wikimedia.org/wikipedia/commons/0/00/Lock_icon_blue.gif"}else{s.bottomRight=""}return s};var p=new g({label:o==="Name"?q.name:q.title,children:[],icons:r(q),badges:n(q),grid:{name:o==="Name"?q.title:q.name,maturity:q.stateNLS,owner:q.responsible,"due date":q.dueDate=="Unknown"?m.ECM_CA_DUEDATE_UNASSIGNED:q.dueDate,dependency:q.dependencyType},data:{modelID:q.id,objectId:q.id,objectType:q.type,displayName:o==="Name"?q.title:q.name,displayType:q.type,dependencyType:q.dependencyType,},resourceid:q.id,linkid:q.linkId,useAsyncPreExpand:true,});return p},buildTreeNodes:function(r,p){var o=null;if(p){o=p}else{o=e.contextCAModel.get("dependencyObjects")}if(o&&o.dependencyLinks&&o.dependencyLinks.length===0){}else{if(o&&o.dependencyLinks){var s=null;var q=null;var n=[];if(r){s=r.getChildren()}else{s=e.sharedModel.getChildren()}if(Array.isArray(s)&&s.length){n=s.map(function(u){return u.getID()})}var t=[];o.dependencyLinks.forEach(function(u){if(n.indexOf(u.id)===-1){q=e.createTreeNodeModel(u);if(r){r.addChild([q])}t.push(q)}});if(r===undefined){e.sharedModel.loadModel(t)}}}},onPreExpandTreeNode:function(v){var t=v.data;var p,s;p=s=t.nodeModel;var n=p.getID();if(!n){return}var u=null;if(s){u=s.getChildren()}var q=[];if(Array.isArray(u)&&u.length){q=u.map(function(w){return w.getID()})}var r=null;var o="";if(s){r=s.getParent()}if(r){o=r.getID()}b.getCADependencies(n).then(function(x){var w=b.buildDependencyModel(x.elements,x.originid,q,o);e.buildTreeNodes(p,w)});v.target.preExpandDone()},};return e});define("DS/ENOChangeActionUX/scripts/Views/CAModals",["DS/UIKIT/Form","DS/UIKIT/Modal","UWA/Core","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility"],function(e,c,g,b,d,f){var a={modalHeader:null,modalFooterButtons:null,modalBody:null,modalObject:null,_createModal:function(){var h=a.createFooterButtons();this.modalObject=new c({closable:true,header:"<h4>"+a.modalHeader+"</h4>",body:a.createModalBody(),footer:h,events:{onHide:function(){a.modalObject.destroy()}.bind(a.modalObject)}});return this.modalObject},createFooterButtons:function(){var h=a.modalFooterButtons;var k=[];for(var j=0;j<h.buttons.length;j++){if(h.buttons[j].buttonValue=="Cancel"){k[j]=new b({value:d.ECM_CA_Cancel,events:{onClick:function(){a.modalObject.hide()}}})}else{k[j]=new b({value:h.buttons[j].buttonValue,className:"primary",})}}return k},createModalBody:function(){var m="";var h=a.modalBody.mBody;var l=[];for(var j=0;j<h.length;j++){var k=false;var n=h[j].fieldType;if(n==="textarea"){k=true}l[j]={type:h[j].fieldType,value:h[j].fieldValue,label:h[j].fieldLabel,placeholder:h[j].fieldPlaceHolder,className:h[j].fieldClassName,rows:h[j].fieldRows,html:h[j].html,required:k,}}m=new e({fields:l,events:{onInvalid:function(){var i=this;f.error(d.ECM_CA_MandFieldMissing_error)},}});return m},clearModalValues:function(){this.modalHeader=null;this.modalFooterButtons=null;this.modalBody=null;this.modalObject=null}};return a});define("DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/UIKIT/DropdownMenu","DS/ENOChangeActionUX/scripts/CAUtility",],function(d,l,f,j,e,g,i,h,c,b){function k(){e.registerHelper("getChangeMaturity",function(p,m){if(!p){return}var o="";if(p===l.ECM_CA_Proposed_Activity_ChangeStatus){var n="";if(m==="Release"){n=l.ECM_CA_Proposed_Activity_State_Release}else{if(m==="Obsolete"){n=l.ECM_CA_Proposed_Activity_State_Obsolete}}o='<span style="color:#B4B6BA;">'+l.ECM_CA_Proposed_ChangeMaturityTo+" </span>"+n}return o});e.registerHelper("getActivityName",function(m){if(!m){return}if(m===l.ECM_CA_Proposed_Activity_ChangeStatus){m=l.ECM_CA_Proposed_ActivityName_ChangeMaturity}return m});e.registerHelper("getReasonForChange",function(m){if(m){m='<span style="color:#B4B6BA;">'+l.ECM_CA_Proposed_Activity_Description+' :</span> <span title="'+m+'">'+m+"</span>"}else{m='<span style="color:#B4B6BA;">'+l.ECM_CA_Proposed_Activity_Description+" : </span>"}return m})}k();var a={selUnselAllContainer:null,selUnselMultisel:null,_createView_TestProposed:function(o,n,m){return d.extend({name:"proposedActivities",className:"proposed-activities-activities-holder",activityModel:n,activityIdx:m,setup:function(){this.template='                                            <div class="proposed-activities-container">                                                <div class="proposed-activities">                                                    <div class="activitues-header">                                                        <div class="activities-chevron icon-class" id="chevron-'+this.activityIdx+'">                                                            <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                        </div>                                                        <div class="'+this.getClassNames("-activities-counter")+'">                                                            <span class="'+this.getClassNames("-activities-title")+'">{{title}}</span>                                                            <span class="'+this.getClassNames("-activities-count")+'">{{activityNum}}</span>                                                        </div>                                                        <div class="'+this.getClassNames("-actions")+'"></div>                                                        <div class="'+this.getClassNames("-activitiesMultisel")+'"></div>                                                    </div>                                                    <div class="activity-content">                                                        {{#each activities}}                                                            <div class="activity-indivisual-container" id="act-indi-cont-{{@index}}">                                                            <div class="activity-indivisual" id="act-indi-{{@index}}">                                                                <div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{@index}}"></div>                                                                <div class="activity-name" id="act-name-{{@index}}"> {{#getActivityName activityName}}{{/getActivityName}}</div>                                                                <div class="activity-change-status" id="act-change-status-{{@index}}">{{#getChangeMaturity activityName activityTargetState}}{{/getChangeMaturity}}</div>                                                                <div class="activity-desc activity-ellipsis-info-1" id="act-desc-{{@index}}">{{#getReasonForChange activityDesc}}{{/getReasonForChange}}</div>                                                              </div>                                                                <div class="activity-actions">                                                                    <div class="activity-action-container" id="activity-action-container-{{@index}}">                                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                                    </div>                                                                </div>                                                            </div>                                                        {{/each}}                                                    <\div>                                                </div>                                                </div>';this._initActionsView();this._initMultiSelView();this.renderer=this.getTemplate(this.template,this.activityModel)},render:function(){this.container.empty();var v=(o)?widget.body:this.container;var r=UWA.createElement("div",{"class":"main-proposed-activities-container"});r.setAttribute("data-rec-id","main-proposed-activities-container-CA");var q=this.renderer();r.addContent(q);r.inject(v);this.injectSubView(this.actionsView,"."+this.name+"-actions");this.injectSubView(this.proposedMultiSelView,"."+this.name+"-activitiesMultisel");var w=this.data.activityNum;var u=this;for(var p=0;p<w;p++){var t=this.container.getElement("#activity-action-container-"+p);if(t){var s=p;t.addEvent("click",function(y){var x=y.currentTarget.id.split("-")[3];x=parseInt(x);u._initDropDown(this,u.data.activities[x])})}}a.container=u;this.activitiesToRemove=[];this.selectedActivityItems=[];return this},_initActionsView:function(){var v=[];var t={id:"add",title:l.ECM_CA_Proposed_Add_Activity,icon:"plus",overflow:false,};var u={id:"selectAll",title:l.SelectAll,icon:"select-all",overflow:false};var p={id:"unSelectAll",title:l.UnSelectAll,icon:"select-none",overflow:false};var q=true;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){var x=b.CurrModel.get("userAccess");if((x&&x.AddProposed&&x.AddProposed==="false")||(!x.AddProposed)){q=false}}v.push(u);v.push(p);if(q){v.unshift(t)}var w=new i(v);this.actionsView=new g({collection:w});var s=this;var r=this._actionsViewEvents={onActionClick:function(){a.selUnselAllContainer=this.container;a.selUnselMultisel=this.proposedMultiSelView;s.dispatchEvent("onActionClickActivities",arguments)}};this.listenTo(this.actionsView,r)},_initMultiSelView:function(){var p=this;var q={collection:new i(),withMultisel:true,useInfiniteScroll:false,usePullToRefresh:false,buildMultiselActions:function(v){var s=true;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){var r=b.CurrModel.get("userAccess");if((r&&r.DeleteProposed&&r.DeleteProposed==="false")||(!r.DeleteProposed)){s=false}}var u=[];var t={id:"remove",text:l.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(w){p.dispatchEvent("removeMultiSelActvities",[w])}};if(s){u.push(t)}return u},events:{onMultiselOff:function(){a.container=p.container;var s=p.container.getElements(".activity-indivisual-container");for(var r=0;r<s.length;r++){s[r].removeClassName("selected-border")}p.selectedActivityItems.length=0;p.activitiesToRemove.length=0;a.deactivateMultisel(p.container)},onMultiselOn:function(){a.container=p.container;a.activateMultisel(p.container)}}};a.multiSelView=this.proposedMultiSelView=new h(q)},_initDropDown:function(v,x){var s;var u=this;var t=[];var r={text:l.ECM_CA_Action_Edit,icon:"fonticon fonticon-pencil",handler:function(z){z.preventDefault();u.dispatchEvent("editActivity",[v,x,arguments[0]])}};var p={text:l.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(z){z.preventDefault();u.dispatchEvent("deleteActivity",[v,x,arguments[0]])}};var w=true;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){var y=b.CurrModel.get("userAccess");if((y&&y.DeleteProposed&&y.DeleteProposed==="false")||(!y.DeleteProposed)){w=false}}var q=true;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){var y=b.CurrModel.get("userAccess");if((y&&y.AddProposed&&y.AddProposed==="false")||(!y.AddProposed)){q=false}}if(w||q){t.push(r);t.push(p)}if(this.dropDown){this.dropDown.destroy();this.dropDown=null}else{s=this.dropDown=new c({target:v,items:t});this.dropDown.show()}},injectSubView:function(r,p){var q=this.container.getElement(p);if(r&&q){q.grab(r.render().getContent())}},getTemplate:function(s,p){var r=e.compile(s);var q=[];p.forEach(function(v){var u={};u.activityName=v.get("activityName");u.activityDesc=v.get("activityDesc");u.activityTargetState=v.get("targetState");u.objectId=v.get("objectId");u.id=v.get("id");u.activityActual=v.get("activityActual");q.push(u)});this.data={activityNum:q.length,title:l.ECM_CA_Proposed_Change_Activities_Label,activities:q,};var t=this;return function(){return r(t.data)}},domEvents:{"click .activities-chevron":function(p){var r=p.target.id;var q=p.target.className;if(q.indexOf("expand-right")>0){p.target.className=q.replace("right","down").trim()}else{if(q.indexOf("expand-down")>0){p.target.className=q.replace("down","right").trim()}}var s=this.container.getElement(".activity-content");if(s.hasClassName("hidden")){s.removeClassName("hidden")}else{s.addClassName("hidden")}},"click .activity-indivisual":function(p){},"click .chkbox-act":function(p){var u=p.target;var q=p.target.id;var t=q.split("-");var y=t[t.length-1];var s=parseInt(y);var w=this.activityModel.at(s);var r=this.container.getElement("#act-indi-cont-"+y);if(r.hasClassName("selected-border")){r.removeClassName("selected-border")}else{r.addClassName("selected-border")}var x=this.selectedActivityItems.indexOf(w.cid);if(x===-1){this.selectedActivityItems.push(w.cid);this.activitiesToRemove.push(w);a.activateMultisel(this.container)}else{this.selectedActivityItems.splice(x,1);this.activitiesToRemove.splice(x,1);if(this.activitiesToRemove.length===0){a.deactivateMultisel(this.container)}}if(this.proposedMultiSelView){var v={};v.isActive=true;v.selectedObjects=this.activitiesToRemove;this.proposedMultiSelView.buildMultisel(v)}}}})},deactivateMultisel:function(m){var o=m.getElements(".activity-action-container");o.forEach(function(p){p.removeClassName("hidden")});var n=m.getElements(".chkbox-act");n.forEach(function(p){if(p.checked){p.checked=false}p.addClassName("hidden")})},activateMultisel:function(m){var o=m.getElements(".activity-action-container");o.forEach(function(p){p.addClassName("hidden")});var n=m.getElements(".chkbox-act");n.forEach(function(p){p.removeClassName("hidden")})},selectAll:function(){var o=a.selUnselAllContainer;if(o){a.activateMultisel(o);var p=o.getElements(".chkbox-act");for(var n=0;n<p.length;n++){var m=p[n];if(!m.checked){m.click()}}}},unselectAll:function(){if(a.selUnselMultisel){a.selUnselMultisel.exitMultisel();a.selUnselMultisel.dispatchEvent("onMultiselOff",[a.selUnselMultisel,false])}},resizeActivites:function(m){}};return a});define("DS/ENOChangeActionUX/scripts/Models/CARealizedModel",["UWA/Class/Model","DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel","DS/ENOChangeActionUX/scripts/CAUtility","UWA/Date","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChangeActionUX/assets/ChangeActionMapping.json"],function(b,c,d,a,i,g,j,e){var f="Cannot be found";var h=b.extend({idAttribute:"id",fetch:function(s){var k="Cannot be found";var n="Access denied";var p=this;this.set("Access",true);this.id=this.get("where").id;var l=this.get("where").info;this.set("id",this.get("where").id);this.set("operation","Modified");if(l.currentNLS!=f){this.set("maturity",l.currentNLS)}if(l["display name"]!=f){this.set("name",l["display name"]);this.set("objectName",l["display name"]);this.set("objectTitle",l["display name"])}else{this.set("name",l.typeNLS);this.set("objectName",l.typeNLS);this.set("objectTitle",l.typeNLS)}if(l.revision!=f){this.set("revision",l.revision)}else{this.set("revision","")}this.set("type",l.typeNLS);this.set("objectType",l.type);if(this.get("maturity")==""||this.get("maturity")==n||this.get("maturity")==k||this.get("maturity")==undefined){this.set("Access",false)}var r=UWA.is(l.isConfigured)?l.isConfigured:"false";this.set("isConfigured",r);if(UWA.is(this.get("amo"))){var o=new UWA.Class.Collection();var m=this.get("amo");var q=this.get("id");if(Array.isArray(m)){m.forEach(function(v){var t=o.get(v.id);if(t!=undefined){}else{var w=new d(v,{parse:true});var u=[];if(UWA.is(w.get("Afterobject"))&&w.get("Afterobject").id!=q){w.get("ActivityDetails")[0].AfterExists=true}if(UWA.is(w.get("Beforeobject"))&&w.get("Beforeobject").id!=q){if(!UWA.is(w.get("Afterobject"))){w.get("ActivityDetails")[0].BeforeExists=true}else{if(UWA.is(w.get("Afterobject"))&&w.get("Afterobject").id!=w.get("Beforeobject").id){w.get("ActivityDetails")[0].BeforeExists=true}}}if(!w.get("ActivityDetails")[0].AfterExists&&!w.get("ActivityDetails")[0].BeforeExists){w.get("ActivityDetails")[0].sameAsWhere=true}if(p.get("isConfigured")=="false"){p.set("status",w.get("status"),{silent:true});p.set("receivingChangeAction",w.get("receivingChangeAction"),{silent:true});p.set("transferReason",w.get("transferReason"),{silent:true});p.set("transferReasonNLS",w.get("transferReasonNLS"),{silent:true})}else{w.get("ActivityDetails").forEach(function(x){x.TransferExists=true})}o.add(w)}});this.set("activities",o,{silent:true})}}s.ajax=function(u,t){p.enrichActivities(p).then(function(v){t.onComplete(v)},function(v){return g.reject(v)})};s.url="dummyURL";return this._parent(s)},parse:function(o){var m=this;var l=[];var n=this.get("activities");if(UWA.is(n)){n.forEach(function(q,p){if(UWA.is(q.get("Afterobject"))){l.push(q.get("Afterobject").id.replace("pid:",""))}if(UWA.is(q.get("Beforeobject"))){l.push(q.get("Beforeobject").id.replace("pid:",""))}});if(UWA.is(o)&&UWA.is(o.additionObjectInfo)){var k;l.forEach(function(p){n.forEach(function(r,q){if(UWA.is(r.get("Afterobject"))){if(p==(r.get("Afterobject").id.replace("pid:",""))&&UWA.is(o.additionObjectInfo[p])){r.get("Afterobject").name=o.additionObjectInfo[p].objectName;r.get("Afterobject").title=o.additionObjectInfo[p].objectTitle;r.get("Afterobject").icon=o.additionObjectInfo[p].icon;r.get("Afterobject").collabSpace=o.additionObjectInfo[p].collabSpace;r.get("Afterobject").ownerFullname=o.additionObjectInfo[p].ownerFullname}}if(UWA.is(r.get("Beforeobject"))){if(p==(r.get("Beforeobject").id.replace("pid:",""))&&UWA.is(o.additionObjectInfo[p])){r.get("Beforeobject").name=o.additionObjectInfo[p].objectName;r.get("Beforeobject").title=o.additionObjectInfo[p].objectTitle;r.get("Beforeobject").icon=o.additionObjectInfo[p].icon;r.get("Beforeobject").collabSpace=o.additionObjectInfo[p].collabSpace;r.get("Beforeobject").ownerFullname=o.additionObjectInfo[p].ownerFullname}}})});m.unset("activities",{silent:true});m.set("activities",n)}}else{this.set("amo",o.amo);this.set("where",o.where)}return this},enrichActivities:function(k){var l=new g(function(o,n){var m=[];var p=k.get("activities");p.forEach(function(r,q){if(UWA.is(r.get("Afterobject"))&&(r.get("Afterobject").Access==true)){m.push(r.get("Afterobject").id.replace("pid:",""))}if(UWA.is(r.get("Beforeobject"))&&(r.get("Beforeobject").Access==true)){m.push(r.get("Beforeobject").id.replace("pid:",""))}});if(m.length>0){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(q){q.getAdditionObjectInfo(m).then(function(r){o(r)},function(r){console.log("failed from getting additional info");return g.reject(r)})})}});return l},});return h});define("DS/ENOChangeActionUX/scripts/Views/CANewTeamView",["UWA/Class/View","UWA/Core","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Collections/ActionsCollection","DS/ENOChangeActionUX/scripts/Views/CATeamSetView","DS/ENOChangeActionUX/scripts/Views/CACustomTeamTileView","DS/ENOChangeActionUX/scripts/Views/CATempAutocomplete","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","WebappsUtils/WebappsUtils","DS/UIKIT/DropdownMenu","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction",],function(d,j,f,q,p,g,i,c,h,l,b,k,o,e,a,n){var m=d.extend({init:function(r){if(r){this.model=r.model}this._parent.call(this,r)},setup:function(){if(this.model){var r=this.model.get("people");var t=this;var s=this.caTagNavigatorProxy=new o();var u="Team";s._initTaggerProxy(u).then(function(x){var w="Team";s._setSubjectTags(r,w);var v=t._externalEvents={onMembersTaggerProxyFilterChange:function(y){t.filterTaggerChange(y)}};t.listenTo(s,v);b.setTaggerObject(w,s)},function(v){console.log("Tagger initilization failed");return Promise.reject(v)})}},render:function(){if(!b.CurrModel){b.CurrModel=this.model}var t=m.originalCollection=new UWA.Class.Collection(this.model.get("people").toArray());var u=m.teamSetView=this.buildTeamSetView(this.model.get("people"));var w=this.container.getElement("#divForTeamViewContent");if(w){w.empty()}else{w=new UWA.Element("div",{styles:{height:"100%",width:"99.9%"}});w.setAttributes({id:"divForTeamViewContent"})}w.inject(this.container);u.render().inject(w);var v=this.container.getElement(".teamViewSet-filterMembers");v.setStyle("display","none");var y=this.container.getElement(".teamViewSet-addMembers");y.setStyle("display","none");this.listenTo(this.model,"onChange:people",this.updateUIOnRefresh);this.listenTo(this.model,"onChange:userAccess",this.updateHeaderOnAccessUpdate);var s=enoviaServerCAWidget.contextUser+"_comments";this.listenTo(this.model,"onChange:"+s,this.refreshUIOnCommentChange);var r=enoviaServerCAWidget.contextUser+"_approvalStatus";this.listenTo(this.model,"onChange:"+r,this.refreshUIOnCommentChange);var x=this;t.forEach(function(B){if(B){if(B.get("role").indexOf("reviewer")>=0){var A=B.get("userName")+"_comments";var z=B.get("userName")+"_approvalStatus";x.listenTo(x.model,"onChange:"+A,x.refreshUIOnCommentChange);x.listenTo(x.model,"onChange:"+z,x.refreshUIOnCommentChange)}}})},buildTeamSetView:function(r){var u=this;var t=u;var s=new c({collection:r,detail:{title:n.ECM_CA_Team_Counter_Members},actions:{collection:this.getTopActions(),events:{onActionClick:function(v,y,w){var x=y.model.get("id");switch(x){case"add":u.launchAddMembersView();break;case"filter":u.launchFilterMembersViews();break;default:console.log(x+" is not permitted.");break}}}},buildMultiselActions:function(z){var y=[];var x=false;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){var v=b.CurrModel.get("userAccess");if(v&&((v.RemoveContributor&&v.RemoveContributor==="true")||(v.RemoveReviewer&&v.RemoveReviewer==="true")||(v.RemoveFollower&&v.RemoveFollower==="true"))){x=true}}var w={id:"delete",text:n.ECM_CA_Team_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(A){t.onRemoveSelectedMembers(A)}};if(enoviaServerCAWidget.isNative){w.icon="I_ChangeCnxObjTrash"}if(x){y.push(w)}return y},addMembers:{collection:u.collection,placeholder:n.ECM_CA_Team_AddMembers_PlaceHolder,categories:[{id:"assignee",name:n.ECM_CA_Team_AddMembers_Assignee,isDefault:"true"},{id:"reviewer",name:n.ECM_CA_Team_AddMembers_Reviewer},{id:"follower",name:n.ECM_CA_Team_AddMembers_Follower}],unlockDistinctClick:true,getSuggestions:function(C,B,v){var D,x;if(!C){return}if(x){x.cancel()}var y=this;D={text:C,onComplete:function(F){console.log("onComplete getSuggestions");var E=y.options.attributes["data-category"];F.forEach(function(G){G.categoryId=E+G.identifier});v(F)},onFailure:function(){b.error(n.ECM_CA_Team_SearchTeamMembers_Failure,"error")}};var w=y.options.attributes["data-category"];var A=t.model.get("people");var z=t.model.get("owner");j.extend(D,{categoryId:w,members:A,contextUser:z});x=b.getSuggestionsForRoutesAndMembers(D)},suggestDistinction:function(y){console.log("in suggestDistinction");var v=u.model.get("people");var x=v.findWhere({userName:y.identifier});if(!x){return false}var w="";if(x.get("type")==="Person"){w=x.get("rolesToDisplay")}else{if(x.get("type")==="Route Template"){w=x.get("rolesToDisplay")}}return w},suggestFormat:"{name}",labelFormat:"{name}",suggestKey:"categoryId",typeDelay:1000,minLength:3,multipleRoles:true,autocompleteExtension:l,saveProcess:function(x){if(Array.isArray(x)&&x.length>0){var v=true;x.forEach(function(z){var y=z.item;if((y.categoryId==="reviewer")&&(enoviaServerCAWidget.reviewerType.typeOfReviewer!=y.type)){v=false}})}if(v){u.onSaveHandler(x,u)}else{var w=n.ECM_CA_ROUTE_TEMPLATE;if(enoviaServerCAWidget.reviewerType.typeOfReviewer==="Person"){w=n.ECM_CA_PERSON}b.error(w+" "+n.ECM_CA_PERSON_ROUTE_MIXED_ERROR)}},onClose:function(){var v=u.container.getElement(".teamViewSet-addMembers");v.setStyle("display","none")}},filterMembers:{fromIDCard:false,collection:u.collection,placeholder:n.ECM_CA_Searchby_NameTitle,events:{memberFilterKeyUp:function(w){u.enteredText=w.target.value;var v={filteringMode:"name",text:u.enteredText};u.filterCollectionAndUpdateUI(v)},memberRoleFilter:function(){var v={filteringMode:"role",text:(u.enteredText)?u.enteredText:""};var w=u.filterCollectionAndUpdateUI(v)}}},contents:{views:[{id:"tile",title:n.ECM_CA_Team_Switch_TileView,view:q,itemView:h,"default":true},{id:"table",title:n.ECM_CA_Switch_TableView,view:p,itemView:g}],selectionMode:"nullToMany",useInfiniteScroll:false,usePullToRefresh:false,emptyView:f.extend({defaultOptions:{icon:"members",title:n.ECM_CA_Team_EmptyView_Title}}),events:{onItemViewClick:function(){},onItemViewCheck:function(){if(arguments[2].target.checked){t.caTagNavigatorProxy.deactivateTaggerProxy()}else{t.caTagNavigatorProxy.activateTaggerProxy()}}},headers:[{property:"fullName",sortable:true,label:n.ECM_CA_Summary_Table_Label_Name},{property:"rolesToDisplay",sortable:true,label:n.ECM_CA_Summary_Table_Label_Role},{label:"Action",actions:true}],itemViewOptions:{templateHelpers:{imgAttrs:function(){var v={"data-1":"data-1","data-2":"data-2","class":"tile-image landscape"};v["model-title"]=u.model.get("title");return v}},mapping:{title:function(){var v="";if(this.model.get("type")==="Person"){v=n.ECM_CA_PERSON}else{if(this.model.get("type")==="Route Template"){v=n.ECM_CA_ROUTE_TEMPLATE}}return"<div class='removeMargin'><div class='div-title-teamview'>"+this.model.get("fullName")+"</div><div class='div-type-teamview' style='color:gray;font-size:12px;' >"+v+" </div></div>"},subtitle:function(){var z=u.model.get("owner");var A=this.model.get("userName");var x=A+"_comments";var C="";(u.model.get(x)!=null&&u.model.get(x)!="")?C=u.model.get(x):C="";var w=false;var y=this.model.get("role");if(y&&!(Array.isArray(y))){y=y.split(", ")}if(y){y.forEach(function(D){if(D==="reviewer"||D==="contributor"){w=true}})}var x=A+"_approvalStatus";var v="";(u.model.get(x)!=null&&u.model.get(x)!="")?v=u.model.get(x):v="";var B=n.get("ECM_CA_"+v+"_label");if((w===true)&&(v!="")&&(C!="")){return"<div class='removeMargin'><div class='signOff'><b>"+n.ECM_CA_TeamView_Reviewer_SignOff+"</b>"+B+"</div><div class='comment' title='"+C+"'>"+C+"</div></div>"}},image:function(){var v="";if(this.model.get("type")==="Person"){v=e.getWebappsAssetUrl("ENOChangeActionUX","images/Default_People.png")}else{if(this.model.get("type")==="Route Template"){v=e.getWebappsAssetUrl("ENOChangeActionUX","images/iconRouteTemplate108x144.png")}}return v},},actionButtonBinding:function(v){v.container.getElement(".actions-inline-dotted").removeClassName("hidden");v.container.getElement(".actions-inline-dotted").addEvent("click",function(w){v.dispatchEvent("onActionClickDotted",v)})},contextualActions:function(){var y=[];var B=this;var H={id:B.get("id"),name:B.get("userName"),type:B.get("type")};var w=[];var D=null;var v=null;var E=null;w.push(H);var x=false;if(UWA.is(t.model)&&UWA.is(t.model.get("userAccess"))){var F=t.model.get("userAccess");if(F&&((F.AddContributor&&F.AddContributor==="true")||(F.AddReviewer&&F.AddReviewer==="true")||(F.AddFollower&&F.AddFollower==="true"))){x=true}}var C=false;if(UWA.is(t.model)&&UWA.is(t.model.get("userAccess"))){var F=t.model.get("userAccess");if(F&&((F.RemoveContributor&&F.RemoveContributor==="true")||(F.RemoveReviewer&&F.RemoveReviewer==="true")||(F.RemoveFollower&&F.RemoveFollower==="true"))){C=true}}if(H.type==="Person"){D={text:n.ECM_CA_Team_AddMembers_Assignee,};E={text:n.ECM_CA_Team_AddMembers_Follower,};v={text:n.ECM_CA_Team_AddMembers_Reviewer,};if(x||C){y.push(D);if(enoviaServerCAWidget.reviewerType.typeOfReviewer!="Route Template"){y.push(v)}y.push(E)}}else{if(H.type==="Route Template"){y.push({id:"Details",text:n.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:true,handler:function(J){var N=B.get("id").replace("pid:","");if(enoviaServerCAWidget.isNative){b.DispatchEventToWin("ExploreInCollabNApproval",N)}else{var K="/common/emxTree.jsp?mode=insert&objectId="+N;var M=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var L=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+M+"&forwardUrl="+K);var I=window.open();I.opener=null;I.location.href=L}}})}}var z=this.get("role");var A=[];if(z){A=z.split(", ")}if(Array.isArray(A)){var G=A.indexOf("owner");if(G===-1&&(x||C)){y.push({text:n.ECM_CA_Team_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(){var I=B.get("role");I=I.split(", ");var J=[];I.forEach(function(K){K=K.charAt(0).toLowerCase()+K.slice(1);J.push(K)});H.roles=J;t.removePersonAs(w)}})}G=A.indexOf("contributor");if(G>=0&&D){D.icon="fonticon fonticon-role-delete";D.handler=function(){H.roles="contributor";t.removePersonAs(w)}}else{if(D){D.icon="fonticon fonticon-role-add";D.handler=function(){H.roles="contributor";t.addPersonAs(w)}}}G=A.indexOf("reviewer");if(G>=0&&v&&enoviaServerCAWidget.reviewerType.typeOfReviewer!="Route Template"){v.icon="fonticon fonticon-role-delete";v.handler=function(){H.roles="reviewer";t.removePersonAs(w)}}else{if(v&&enoviaServerCAWidget.reviewerType.typeOfReviewer!="Route Template"){v.icon="fonticon fonticon-role-add";v.handler=function(){H.roles="reviewer";t.addPersonAs(w)}}}G=A.indexOf("follower");if(G>=0&&E){E.icon="fonticon fonticon-role-delete";E.handler=function(){H.roles="follower";t.removePersonAs(w)}}else{if(E){E.icon="fonticon fonticon-role-add";E.handler=function(){H.roles="follower";t.addPersonAs(w)}}}}return y},events:{onActionClickDotted:function(w){var z;var x=this;if(this.dropDown){this.dropDown.destroy();this.dropDown=null}w._updateContextualActions();var v=w.contextualActions;var A=w.container.getElement(".actions-inline-dotted .action-icon-wrapper");if(v.length===0){v.push({text:n.ECM_CA_Command_NO_Action})}var y={items:v,target:A,className:"CA_ConnectedObj_DropDown",};z=this.dropDown=new a(y);if(this.dropDown){this.dropDown.show()}}}}}});return s},getTopActions:function(r){var t=[{id:"filter",title:n.ECM_CA_Team_Actions_FilterMembers,icon:"filter",overflow:false}];var v={id:"add",title:n.ECM_CA_Team_Actions_AddMembers,icon:"plus",overflow:false};var w=false;var s=null;if(UWA.is(b.CurrModel)&&UWA.is(b.CurrModel.get("userAccess"))){s=b.CurrModel.get("userAccess")}else{if(r){s=r}}if(s&&((s.AddContributor&&s.AddContributor==="true")||(s.AddReviewer&&s.AddReviewer==="true")||(s.AddFollower&&s.AddFollower==="true"))){w=true}if(w){t.unshift(v)}var u=new i(t);return u},launchAddMembersView:function(){var u=this.container.getElement(".teamViewSet-addMembers");if(u.getStyle("display")==="none"){u.setStyle("display","block");var s=u.getElement(".paneladdmember-item-view-container");if(s){s.addClassName("expanded")}var t=u.getElement("tr:not(.hidden) input");t.focus();var r=this.container.getElement(".teamViewSet-filterMembers");r.setStyle("display","none")}else{u.setStyle("display","none")}},onSaveHandler:function(r,t){var u=t.container.getElement(".teamViewSet-addMembers");if(u){u.setStyle("display","none")}var s=[];r.forEach(function(A){var x=A.categoryId==="assignee";var y=A.categoryId==="reviewer";var w=A.categoryId==="follower";var z="";if(x){z="contributor"}if(y){z="reviewer"}if(w){z="follower"}var v={};v.id=A.item.id;v.name=A.item.identifier;v.roles=z;v.fullName=A.item.name;v.type=A.item.type;s.push(v)});t.addPersonAs(s)},launchFilterMembersViews:function(){var r=this.container.getElement(".teamViewSet-filterMembers");var u=this.container.getElement(".teamfilter-role-filter");if(r.getStyle("display")==="none"){r.setStyle("display","block");u.addClassName("highlighted-border");var s=u.getElement("tr:not(.hidden) input");s.focus();var t=this.container.getElement(".teamViewSet-addMembers");t.setStyle("display","none")}else{r.setStyle("display","none")}},filterCollectionAndUpdateUI:function(r){var t=[];var u=r.text;var s=this.isForbiddenChar(u);if(s===true){return}t=this.filterMembersCollection(u);t=this.filterByRoles(t);m.teamSetView.collection.reset();m.teamSetView.collection.push(t)},isForbiddenChar:function(s){var v=false;var u='"#$@%*,?\\<>[]|:/';for(var r=0;r<u.length;r++){var t=u[r];if(s.indexOf(t)!=-1){v=true;break}}if(true===v){u=u.split("").join(" ");b.error(n.ECM_CA_Team_SearchTeamMembers_ForbiddenChars+u)}return v},filterMembersCollection:function(u){var s=m.originalCollection;var r=new UWA.Class.Collection(s.toArray());function v(A){var x=false;var z=A.get("fullName");var y=u;if(z&&y&&y.length){z=z.toLowerCase();y=y.toLowerCase();var w=z.indexOf(y);x=(w>=0)?true:false}if((y===undefined)||(y.length===0)){x=true}if(x==true){return A}}k.endWait(widget.body);var t=r.filter(v);return t},filterByRoles:function(u){var s=new UWA.Class.Collection(u);var r=new UWA.Class.Collection(s.toArray());function v(C){var E=false;var B=C.get("role").split(", ");var A=document.getElementById("assigneeToggle");var x=false;if(A&&A.checked){x=true}var y=document.getElementById("revMemToggle");var z=false;if(y&&y.checked){z=true}var D=document.getElementById("followMemToggle");var w=false;if(D&&D.checked){w=true}if((x==false)&&(z==false)&&(w==false)){E=true}switch(true){case (x||z||w):B.forEach(function(F){if((F=="contributor"&&x)||(F=="reviewer"&&z)||(F=="follower"&&w)){E=true}});break}if(E==true){return C}}var t=r.filter(v);return t},getPeopleJSON:function(t,r){var s=[];if(Array.isArray(r)){r.forEach(function(u){s.push({name:t,role:u})})}else{s.push({name:t,role:r})}return s},createRemovePeopleJSON:function(t,s){var r=JSON.stringify({version:"v0",changeaction:{"delete":{people:t,routeTemplates:s}}});return r},jsonPeople:function(t,r,s){if(Array.isArray(r)){r.forEach(function(u){s.push({name:t[1],role:u})})}else{s.push({name:t[1],role:r})}},addPersonAs:function(r){k.doWait(widget.body);var t=[];var w=[];var u;var x=this;r.forEach(function(C){var E=C.id;var A=C.name;var B=C.type;u=C.roles;var D=[];D.push(E);D.push(A);if(B==="Person"){D.push("Person");D.push("Person");x.jsonPeople(D,u,t)}else{if(B==="Route Template"){w.push("pid:"+E)}}});var y=JSON.stringify({version:"v0",changeaction:{add:{routeTemplates:w,people:t}}});var s=function(F){var H=F.changeaction.people;var E=F.changeaction.routeTemplates;if(Array.isArray(E)&&E.length>0){enoviaServerCAWidget.reviewerType.typeOfReviewer="Route Template";E.forEach(function(I){H.push({name:I.name,role:"reviewer",type:"Route Template"})})}else{enoviaServerCAWidget.reviewerType.typeOfReviewer="Person"}var D=b.rearrangeMembersByRole(m.originalCollection,H,r);var B=[];var C=x.model.get("owner");r.forEach(function(N){if(C===N.name){var K=[];var J=x.model.get("contextUserRole");J=J.split(", ");var I=N.roles;var M=I.charAt(0).toUpperCase()+I.slice(1);M=n.get("ECM_CA_Summary_"+M);J.forEach(function(O){K.push(O)});if(-1===K.indexOf(M.trim())){K.push(M)}var L="";if(K.length){L=K.join(", ")}x.model.set("contextUserRole",L)}});var A=x.model.get("people");A.reset();A.push(m.originalCollection.toArray());m.teamSetView.collection.reset();m.teamSetView.collection.push(m.originalCollection.toArray());var G="Team";x.caTagNavigatorProxy._setSubjectTags(m.originalCollection,G);k.endWait(widget.body)};var v=function(B,A){if(A){b.error(A.errorMessage)}k.endWait(widget.body)};var z=x.model.get("id");b.addPersonToCA(y,z,s,v)},onRemoveSelectedMembers:function(s){var r=[];s.forEach(function(u){var y=u.get("role");if(y.indexOf("Assignee")>=0){y=y.replace("Assignee","contributor")}var v=y.split(", ");var w=[];v.forEach(function(z){z=z.charAt(0).toLowerCase()+z.slice(1);w.push(z)});var x={};x.id=u.get("id");x.name=u.get("userName");x.type=u.get("type");x.roles=w;var t=v.indexOf("owner");if(t===-1){r.push(x)}else{b.warn(n.ECM_CA_TeamView_Owner_Remove_Forbidden)}});if(r.length){this.removePersonAs(r)}},removePersonAs:function(r){k.doWait(widget.body);var v=this;var y=[];var w=[];r.forEach(function(C){if(C.type==="Person"){var D=(C.id).substr(4);var A=C.name;var B=C.roles;var z=v.getPeopleJSON(A,B);y=y.concat(z)}else{if(C.type==="Route Template"){w.push(C.id)}}});var u=v.createRemovePeopleJSON(y,w);var t=function(C){var E=C.changeaction.people;b.rearrangeMembersByRole(m.originalCollection,E,r);var A=v.model.get("owner");r.forEach(function(J){var G=J.roles;if(A===J.name){var I=[];var F=v.model.get("contextUserRole");F=F.split(", ");if(Array.isArray(G)){G.forEach(function(L){var K=L.charAt(0).toUpperCase()+L.slice(1);K=n.get("ECM_CA_Summary_"+K);F.forEach(function(M){if(M!=K){I.push(M)}})})}else{var H=G.charAt(0).toUpperCase()+G.slice(1);H=n.get("ECM_CA_Summary_"+H);F.forEach(function(K){if(K!=H){if(I.length===0){I.push(K)}else{K=" "+K;I.push(K)}}})}v.model.set("contextUserRole",I.toString())}});var B=false;var z=m.originalCollection;if(z){z.forEach(function(I){var H=I.get("role");var G=[];if(H.length){G=H.split(", ")}var F=G.indexOf("reviewer");if(F>=0){enoviaServerCAWidget.reviewerType.typeOfReviewer=I.get("type");B=true}})}if(!B){enoviaServerCAWidget.reviewerType={typeOfReviewer:"",labelSelected:false}}var z=v.model.get("people");z.reset();z.push(m.originalCollection.toArray());m.teamSetView.collection.reset();m.teamSetView.collection.push(m.originalCollection.toArray());var D="Team";v.caTagNavigatorProxy._setSubjectTags(m.originalCollection,D);v.caTagNavigatorProxy.activateTaggerProxy();k.endWait(widget.body)};var x=function(A,z){k.endWait(widget.body);b.error(z.errorMessage)};var s=v.model.get("id");b.removePersonFromCA(u,s,t,x)},filterTaggerChange:function(s){var v=m.teamSetView.collection;var w=[];for(var y in s){var z=s[y];var r=m.originalCollection.toArray();var u=m.originalCollection.findWhere({id:z});var t=[];if(u){w.push(u)}}if(v.length!=m.originalCollection.length){v.reset();var r=m.originalCollection.toArray();v.add(r)}var x=v.without(w);v.remove(x)},refreshUIOnCommentChange:function(){var r=arguments[0].get("people");var s=m.teamSetView.collection;s.reset();s.add(r.toArray())},updateUIOnRefresh:function(){var r=this.model.get("people");var t=new UWA.Class.Collection(r.toArray());m.originalCollection=t;r.reset();m.teamSetView.collection.reset();m.teamSetView.collection.push(t.toArray());r.push(m.originalCollection.toArray());var s=this;m.originalCollection.forEach(function(x){if(x){if(x.get("role").indexOf("reviewer")>=0){var w=x.get("userName")+"_comments";var v=x.get("userName")+"_approvalStatus";s.listenTo(s.model,"onChange:"+w,s.refreshUIOnCommentChange);s.listenTo(s.model,"onChange:"+v,s.refreshUIOnCommentChange)}}});var u="Team";this.caTagNavigatorProxy._setSubjectTags(m.originalCollection,u)},updateHeaderOnAccessUpdate:function(){m.teamSetView.actionsView.collection.reset();m.teamSetView.actionsView.collection.push(this.getTopActions(arguments[1]).toArray());m.teamSetView.actionsView.show()}});return m});define("DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Core"],function(g,c,b,f,a,e){var d=g.extend({idAttribute:"id",setup:function(){},parse:function(h){var j=h.model;this.set("canEdit",true);this.set("mode",h.mode);if(UWA.is(j.id)){var i={};this.set("id",j.id);j.set("objectId",j.id);i.objectType=j.get("objectType")?j.get("objectType"):"";i.objectActualName=(enoviaServerCAWidget.NamePref=="Name")?j.get("objectName"):j.get("synopsis");if(i.objectActualName===undefined||i.objectActualName===""){i.objectActualName=j.get("objectName")}i.objectRev=j.get("revision")?j.get("revision"):"";i.objectName=i.objectActualName+" "+i.objectRev;i.objectID=j.get("objectId")?j.get("objectId").replace("pid:",""):"";i.maturity=j.get("maturity")?j.get("maturity"):"";i.policy=j.get("policy")?j.get("policy"):"";i.image={imageValue:j.get("icon")?j.get("icon"):""};this.set("objectName",i.objectName);this.set("proposedObject",i)}},add:function(n,l,i){var m={};var j=this;var h=l;var k=[h];f.getAdditionObjectInfo(k).then(function(p){m.objectType=p.additionObjectInfo[h].type;m.objectActualName=(enoviaServerCAWidget.NamePref=="Name")?p.additionObjectInfo[h].objectName:p.additionObjectInfo[h].synopsis;if(m.objectActualName===undefined||m.objectActualName===""){m.objectActualName=p.additionObjectInfo[h].objectName}m.objectRev=p.additionObjectInfo[h].revision;m.objectName=m.objectActualName+" "+m.objectRev;m.objectID=p.additionObjectInfo[h].pid;m.policy=p.additionObjectInfo[h].policy;m.image={imageValue:p.additionObjectInfo[h].icon};var o=j.get(n);if(UWA.is(o,"object")){j.unset(n)}j.set(n,m)},function(o){console.log("Populate Security Context failed");return Promise.reject(o)})},remove:function(k,i,h){var j=this.get(k);if(UWA.is(j,"object")){this.unset("operationActual",{silent:true});this.unset(k)}},proposedTypeAheadCallback:function(m,l,o){var n="searchStr="+encodeURIComponent(l)+"*";var h;if(m&&m.searchTypes){h=encodeURIComponent(m.searchTypes)}else{h="*"}n+="&typeStr="+h;var j="/resources/v2/e6w/service/ObjectSearch?"+n;var k=null;var i=function(s){if(s.success&&s.data){var y=s.data.length;var r=[];for(var u=0;u<y;u++){var z=s.data[u];if(z.dataelements){var w=z.type;var p=z.dataelements.name||"";var q=z.dataelements.image||"";var x=z.dataelements.synopsis||"";var v=z.dataelements.revision||"";var t=(enoviaServerCAWidget.NamePref=="Name")?p:x;if(t===undefined||t===""){t=p}r.push({value:z.id,label:t+" "+v,image:q})}}o(r)}};return f.makeWSCall(j,"GET","enovia","application/json",k,i,null)}});return d});define("DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm",["DS/E6WCommonUI/Views/DetailsDisplayView","UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Input/Text","UWA/Class/Model","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel","DS/ENOChangeActionUX/scripts/CAUtility","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView","DS/ENOChangeActionUX/scripts/CASpinner",],function(n,p,c,m,a,o,i,l,q,h,g,f,e,r,d,k,j){var b=o.extend({displayViewModel:null,proposedCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,init:function(s){this.proposedCallback=s.callback;this.displayViewModel=new f(s,{parse:true});this.detailsView=new n();this.options=s},getHeading:function(){if(this.displayViewModel.get("mode")==="Existing"){return c.ECM_CA_FLOWDOWN_TO_EXISTING}else{if(this.displayViewModel.get("mode")==="NewCA"){return c.ECM_CA_FLOWDOWN_TO_NEW}}},getBody:function(){var t=this;var s=UWA.createElement("div",{id:"formBody"});var v=UWA.Class.View.extend({setup:function(){if(t.options.mode==="Existing"){this.listenTo(this.model,"onChange",this.render)}this.listenTo(this.model,"onChange:createObjectTitle",t.updateBtnState);this.listenTo(this.model,"onChange:descriptionOfObj",t.updateBtnState)},render:function(){s.setContent("");t.detailsView.setConfig(t.getConfig());t.detailsView.model=t.displayViewModel;t.detailsView.tenant=enoviaServerCAWidget.tenant;t.detailsView.context=enoviaServer.context;t.detailsView.render().inject(s);if(arguments&&arguments.length>0){t.updateBtnState(arguments[0])}}});var u=new v({model:t.displayViewModel}).render();return s},getConfig:function(){var y=[];var s;var u=this;s=new Date();var x="";var z="";var w=u.options.contextCAId.replace("pid","physicalid");x=x+"NOT ("+w+")";z='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")';var t={title:"Change Action",precond:z,excludeList:x,from:"realized"};var v=new g(t,false);if(this.displayViewModel.get("mode")==="Existing"){y.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:c.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:true,searchTitle:c.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",search:v})}if(this.displayViewModel.get("mode")==="NewCA"){y.push({required:true,label:c.ECM_CA_Pref_Title_Label,name:"createObjectTitle",customView:d});y.push({required:true,readWrite:"true",name:"descriptionOfObj",label:c.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3});y.push({label:c.ECM_CA_Realized_Transfer_Severity,name:"dependencies",customView:k});y.push({label:c.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:s})}return y},getFooter:function(){var u=this;var v=b.footer=UWA.Element("div",{});var s=new i({value:c.ECM_CA_Realized_Flowdown_OK,className:"primary proposedButtons",disabled:true}).inject(v);s.elements.input.onclick=function(){u.onSaveButtonClick()};var t=new i({value:c.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(v);t.addEvent("onClick",this.onCancelButtonClick.bind(this));return v},onCancelButtonClick:function(){this.slideInReference.hideSlideIn()},onSaveButtonClick:function(){var v=this;var x=function(z,y){j.endWait(widget.body);if(data.status!="success"){e.error(c.ECM_CA_FLOWDOWN_ERR_MSG)}v.slideInReference.hideSlideIn()};var s=function(y){v.slideInReference.hideSlideIn();if(y.status==="success"){e.success(c.ECM_CA_FLOWDOWN_SUCCESS_MSG+" "+y.caName)}j.endWait(widget.body)};if(this.detailsView.isModelValid()){if(this.displayViewModel.get("mode")==="NewCA"){var w=this.getCreateEditData(this.displayViewModel);var u=this.getFlowDownData(this.displayViewModel);e.flowDownToNewChangeAction(w,u,s)}else{if(this.displayViewModel.get("mode")==="Existing"){var u=this.getFlowDownData(this.displayViewModel);var t={id:"pid:"+this.displayViewModel.get("proposedObject").objectID,name:this.displayViewModel.get("proposedObject").objectActualName,};e.flowDownToExistingChangeAction(t,u,s)}}j.doWait(widget.body)}else{e.error(c.ECM_CA_Realized_Transfer_MandAttrErr)}},getCreateEditData:function(u){var B="";if(UWA.is(u)){var w=u.get("createObjectTitle");var s=u.get("descriptionOfObj");var v=u.get("severity");var z="";if(UWA.is(u.get("dueDate"))){var C="";C=u.get("dueDate").actualValue;var t;t=new Date(C);var x=t.getMonth()+1;var A=t.getDate();var y=t.getFullYear();z=x+"/"+A+"/"+y}B={description:s,synopsis:w,severity:v,scheduledCompletionDate:z}}return B},getFlowDownData:function(s){var t="";t={idsToFlowdown:this.options.ids,};return t},updateBtnState:function(){var w=this;var s=arguments[0];if(s){var v=s.get("createObjectTitle");var t=s.get("descriptionOfObj");var x=s.get("proposedObject");if(((v&&v!="")&&(t&&t!=""))||(x&&x.objectID!="")){if(b.footer){var u=b.footer;u.firstChild.disabled=false;u.firstChild.removeClassName("disabled")}}else{if(b.footer){var u=b.footer;u.firstChild.disabled=true;u.firstChild.addClassName("disabled")}}}}});return b});define("DS/ENOChangeActionUX/scripts/Views/CADependenciesActionsView",["UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","WebappsUtils/WebappsUtils","UWA/Date","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChangeActionUX/assets/ChangeActionMapping.json","DS/Core/Core","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Views/CADependencyCounterView","DS/Handlebars/Handlebars","UWA/Class",],function(c,l,n,a,f,m,p,i,k,h,j,g,o,d,b){var e=c.extend({name:"dependenciesActionsView",tagName:"div",className:"actionsDiv",init:function(q){if(q){this.model=q.model}this._parent.call(this,q)},setup:function(){this.template='                                        <div class="'+this.getClassNames("-header")+'">                                            <div class="'+this.getClassNames("-dependTitle")+'"></div>                                            <div class="'+this.getClassNames("-dependActions")+'"></div>                                            <!--div class="'+this.getClassNames("-dependMultiSelActions")+'"></div-->                                        <\div>';this.listenTo(this.model,"onChange:dependencyObjects",this.updateCounterView);this.listenTo(this.model,"onChange:dependUserAccess",this.render);var q=this;widget.addEvent("onResize",function(){setTimeout(function(){if(UWA.is(q.actionsView)){q.actionsView.destroy();var r=q.container.getElement(".dependenciesActionsView-dependActions");q._initActionsView();if(q.actionsView&&r){r.empty();r.grab(q.actionsView.render().getContent());q.actionsView&&q.actionsView.dispatchEvent("onShow")}}},100)})},render:function(){var t=this.name;this.container.empty();var s=document.getElementsByClassName("tooltip")[0];if(s){s.destroy()}this.containerReference=this.container;var r=new UWA.Element("div");r.setAttributes({id:"DivForDependenciesHeader"});r.setStyle("height","100%");var u=this.model.get("dependencyObjects").dependencyLinks.length;this._initTitleView(u);this._initActionsView();this.renderer=this.getTemplate(this.template);var q=this.renderer();r.addContent(q);r.inject(this.containerReference);this.injectSubView(this.titleView,"."+t+"-dependTitle");this.injectSubView(this.actionsView,"."+t+"-dependActions");this.actionsView&&this.actionsView.dispatchEvent("onShow");return this},injectSubView:function(s,q){var r=this.container.getElement(q);if(s&&r){r.grab(s.render().getContent())}},getTemplate:function(r){var q=d.compile(r);var s=this;return function(){return q()}},_initTitleView:function(q){this.titleView=new o({title:p.ECM_CA_DEPENDENCY_TITLE,counter:q})},updateCounterView:function(){if(this.model.get("dependencyObjects").id!=this.model.get("id")){return}var r=this.model.get("dependencyObjects").dependencyLinks.length;var q=this.container.getElement(".dependenciesActionsView-dependTitle");if(q){q.empty()}this._initTitleView(r);this.injectSubView(this.titleView,".dependenciesActionsView-dependTitle")},_initActionsView:function(){var x={id:"collab-dep",title:p.ECM_COLLABORATE_CHG_DEPENDENCY,icon:"change-action-sync",overflow:false,};var u={id:"add-dep",title:p.ECM_CA_ADD_DEPENDENCY,icon:"dependency",overflow:false,};var y={id:"add-co-dep",title:p.ECM_CA_ADD_CO_DEPENDENCY,icon:"codependency",overflow:false};var r={id:"remove",title:p.ECM_CA_Referential_MultiSelActions_Remove,icon:"trash",overflow:false};var v=[];var t=true;var s=this.model.get("dependUserAccess");if(s&&(s.edit==="false")){t=false}v.push(x);if(t){v.push(u);v.push(y);v.push(r)}var w=new j(v);this.actionsView=new h({collection:w});var q=this._actionsViewEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onActionClick",arguments)},};this.listenTo(this.actionsView,q)},_initMultiSelActionsView:function(){var q=this;var r={collection:new j(),withMultisel:true,useInfiniteScroll:false,usePullToRefresh:false,buildMultiselActions:function(t){var s=[{id:"remove",text:p.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(u){Array.prototype.unshift.call(arguments,u);q.dispatchEvent("removeMultiSel",arguments)}},];return s},events:{onMultiselOff:function(){},onMultiselOn:function(){}}};this.multiSelView=new g(r)},});return e});define("DS/ENOChangeActionUX/scripts/Views/CADependeciesView",["UWA/Class/View","UWA/Core","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/Views/CADependenciesActionsView","DS/ENOChangeActionUX/scripts/Controller/CADependencyController","WebappsUtils/WebappsUtils","UWA/Date","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/Core/Core","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tweakers/TypeRepresentationFactory","DS/ENOChangeActionUX/scripts/Views/CAModals","DS/ENOFloatingPanel/ENOFloatingPanel","UWA/Class",],function(o,a,k,f,d,j,e,q,b,c,h,i,l,n,r,m,p){var g=o.extend({name:"dependView",tag:"div",className:"dependenciesView",init:function(s){if(s){this.model=s.model}j.setContextCAModel(this.model);this._parent.call(this,s)},setup:function(){this.template='                                        <div class="'+this.getClassNames("-container")+'">                                                <div class="'+this.getClassNames("-header-container")+'"></div>                                                <div class="'+this.getClassNames("-content-container")+'"></div>                                        </div>';this._initHeaderView();this.renderer=this.getTemplate(this.template);j.buildSearch();this.listenTo(this.model,"onChange:dependencyObjects",this.render)},render:function(){f.CurrModel=this.model;this.container.empty();var u="";this.containerReference=this.container;var t=new UWA.Element("div");t.setAttributes({id:"DivForDependencies"});t.setStyle("height","100%");var s=this.renderer();t.addContent(s);t.inject(this.containerReference);this.injectSubView(this.dependHeaderView,"."+this.name+"-header-container");this._initContentsView()},injectSubView:function(u,s){var t=this.container.getElement(s);if(u&&t){t.grab(u.render().getContent())}},getTemplate:function(t){var s=Handlebars.compile(t);return function(){return s()}},_initHeaderView:function(){var u=this;var t=this.dependHeaderView=new d({model:this.model});var s=this._actionsEvents={onActionClick:function(v,z,w,x){var y=w.model.get("id");switch(y){case"collab-dep":j.syncChangeDependency();break;case"add-dep":j.addDependency();break;case"add-co-dep":j.addCoDependency();break;case"remove":j.remove();break;default:console.log(y+" is not permitted.");break}},removeMultiSel:function(){}};this.listenTo(t,s)},_initContentsView:function(){var v=this.container.getElement(".dependView-content-container");var u=j.getModelForTreeListView();var t=this.buildOptionsForTreeListView(u);var s=this.tree=new h(t);s.inject(v);var w=this;s.getManager().addEventListener("click",function(y,x){w.setVisibilityofActions(x)});s.getManager().getDocument().addModelEventListener("addChild",function(x){x.target.select(true);s.getManager().setActiveNode(x.target)});j.setCurrentTreeObj(s)},buildOptionsForTreeListView:function(u){var t=enoviaServerCAWidget.NamePref;var s=h.SETTINGS.STANDARD_CHECKBOXES;var w=this;s={columns:[{text:t==="Name"?b.ECM_CA_Pref_Name_Label:b.ECM_CA_Table_Header_Title,dataIndex:"tree",enableDragAndDrop:false,isSortable:false,isDraggable:false,width:275,},{text:t==="Name"?b.ECM_CA_Table_Header_Title:b.ECM_CA_Pref_Name_Label,dataIndex:"name",isEditable:false,width:200,},{text:b.ECM_CA_Table_Header_Maturity,dataIndex:"maturity"},{text:b.ECM_CA_RESPONSIBLE_TAG,dataIndex:"owner"},{text:b.ECM_CA_DueDate,dataIndex:"due date"},{text:b.ECM_CA_Depend_Label,dataIndex:"dependency",width:151,}],treeDocument:u,isEditable:false,enableKeyboardNavigation:false,enableExpandOnDoubleClick:false,defaultCellHeight:38,height:"100%",headersDimensions:{height:29},selection:{canMultiSelect:true,isDraggable:false,unselectAllOnEmptyArea:true,preSelection:true,},enableActiveUI:true,resize:{rows:false,columns:true},onDragStartCell:function(y,x){j.onDragStartCell(y,x)}.bind(this),onContextualEvent:{callback:function v(y){var x=[];if(y&&y.treeview&&y.treeview.virtualRowID!=-1){if(y.treeview.nodeModel){var A=y.treeview.nodeModel;if(A){if(A.isSelected()===false){A.select(true)}var z=j.sharedModel.getSelectedNodes();if(z.length===1){x=w.getContextualMenu(A)}}}}return x}}};return s},getContextualMenu:function(s){var t=this;var u=[];if(s){u.push({type:"PushItem",title:b.ECM_CA_Explore_With_Central,icon:e.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInCentral_normal.png"),action:{callback:function(v){j.openIn3DSpace()}}});u.push({type:"PushItem",title:b.ECM_CA_Properties,icon:e.getWebappsAssetUrl("ENOChangeActionUX","images/I_ChangeCnxObjProps.png"),action:{callback:function(v){j.showPropertyPanel()}}});u.push({type:"PushItem",title:b.ECM_CA_Remove_Referential,icon:e.getWebappsAssetUrl("ENOChangeActionUX","images/I_ChangeCnxObjTrash.png"),action:{callback:function(v){j.remove()}}})}return u},setVisibilityofActions:function(v){var y=j.sharedModel.getSelectedNodes();var t=this.container.getElements(".dependenciesActionsView-dependActions .action-container");var u,A,x,z,w;t.forEach(function(B){if(B.getElements(".fonticon-change-action-sync").length>=1){u=B}if(B.getElements(".fonticon-right").length>=1){A=B}if(B.getElements(".fonticon-sync").length>=1){x=B}if(B.getElements(".fonticon-trash").length>=1){z=B}if(B.getElements(".fonticon-mail").length>=1){w=B}});if(y.length===0){if(A){A.removeClassName("display-hidden")}if(x){x.removeClassName("display-hidden")}if(u){u.removeClassName("display-hidden")}if(z){z.removeClassName("display-hidden")}if(w){w.removeClassName("display-hidden")}}if(y.length>1){if(A){A.addClassName("display-hidden")}if(x){x.addClassName("display-hidden")}if(z){z.addClassName("display-hidden")}if(w){w.addClassName("display-hidden")}}else{if(A){A.removeClassName("display-hidden")}if(x){x.removeClassName("display-hidden")}if(u){u.removeClassName("display-hidden")}if(z){z.removeClassName("display-hidden")}if(w){w.removeClassName("display-hidden")}}var s=0;y.forEach(function(C,B){if(C.getObjectType()==="Change Order"){s++;if(u&&!u.hasClassName("display-hidden")){u.addClassName("display-hidden")}}else{if(u&&!s){u.removeClassName("display-hidden")}}if((C.getDependencyType()==="Flowdown")&&(y.length===1)){if(w){w.removeClassName("display-hidden")}}else{if(w&&y.length===1){w.addClassName("display-hidden")}}})},});return g});define("DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAProposedModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(e,d,b,c,a){var f=b.extend({model:c,setup:function(){},fetch:function(g){var h=null;h=g.data=this.proposedArr=g.proposedArr;g.ajax=function(j,i){i.onComplete(h)};this.url="dummyURL";return this._parent(g)},});return f});define("DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility","UWA/Core"],function(e,b,d,c){var a=e.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:activityDisplaySelect",function(f){this.updateActivityDisplayInfo(f)});this.addEvent("onChange:activityActual",function(f){this.updateActivityDisplaySelectInfo(f)})},parse:function(f){var h=f.model;this.set("canEdit",true);this.set("operationId",h.get("operationId"));this.set("operationIdx",h.get("operationIdx"));var g={};g.objectID=h.get("objectId").replace("pid:","");this.set("proposedObject",g);this.updateAllowedActivityInfo(this);if(UWA.is(h.id)){this.set("id",h.id);this.set("isEdit",true);this.set("activityActual",(h.get("activityActual")=="ChangeStatus")?h.get("targetState"):h.get("activityActual"));this.updateActivityDisplaySelectInfo(this);this.set("reasonForChange",h.get("activityDesc"))}},updateAllowedActivityInfo:function(f){if(UWA.is(f.get("proposedObject"))&&UWA.is(f.get("proposedObject").objectID)){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(h){var i=f.get("proposedObject").objectID;var g=[];g.push("pid:"+i);h.getAllowedOperationActivity(g).then(function(l){var k=[];l.allowedOperationActivity[i].allowedActivity.forEach(function(n){var m=h.getOperationNameOnUI(n);if(n=="Release"||n=="Obsolete"){m=b.ECM_CA_Proposed_Activity_ChangeMaturity+": "+m}k.push({displayValue:m,actualValue:n})});f.set("activityDisplayOptions",k);if(!f.get("isEdit")){var j=l.allowedOperationActivity[i].defaultActivity;j=UWA.is(j)?j:"Modify";f.set("activityActual",j)}},function(j){console.log("Get allowed operation/activity failed");return Promise.reject(j)})})}else{f.unset("activityDisplayOptions");f.unset("activityActual")}},updateActivityDisplaySelectInfo:function(f){var g=f.get("activityActual");require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(i){var h=i.getOperationNameOnUI(g);if(g=="Release"||g=="Obsolete"){h=b.ECM_CA_Proposed_Activity_ChangeMaturity+": "+h}f.set("activityDisplaySelect",{displayValue:h,actualValue:g},{silent:true});f.set("activityDisplay",h)})},updateActivityDisplayInfo:function(f){var h=f.get("activityDisplaySelect");if(UWA.is(h)&&UWA.is(h.actualValue)){var g=h.actualValue;f.set("activityActual",h.actualValue,{silent:true});f.set("activityDisplay",h.displayValue)}}});return a});define("DS/ENOChangeActionUX/scripts/CAPreferences",["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOChangeActionUX/scripts/CAUtility","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(b,c,a){var d={URL:null,_SCPreferred:null,_theListSC:null,_SCPreferredDB:null,PopulatePreferences:function(){var e=new Promise(function(k,j){var i=widget.getValue("x3dPlatformId")==""?false:widget.getValue("x3dPlatformId")!="OnPremise"?true:false;var l=[];var f=d.PopulateNamePreferences();var h=d.PopulateSCPreferences();if(i){var g=d.populateTenantPreferences();l.push(f,h,g)}else{l.push(f,h)}Promise.all(l).then(function(m){widget.addPreference(m[0].NamePreference);d.ComputeList(m[1].collabspacesDetails);if(i){widget.addPreference(m[2].TenantPreference)}k("success")})});return e},PopulateNamePreferences:function(){var i=a.ECM_CA_Pref_Name_Title_Label;var f=a.ECM_CA_Pref_Name_Label;var h=a.ECM_CA_Pref_Title_Label;var e={name:"NameOrTitle",type:"list",label:i,options:[]};var g=new Promise(function(l,k){e.options.push({value:"Title",label:h});e.options.push({value:"Name",label:f});var j={};j.NamePreference=e;l(j)});return g},PopulateSCPreferences:function(){d._SCPreferredDB="";d._SCPreferred="";var e=new Promise(function(j,i){var h="/resources/modeler/pno/person?current=true";h+="&select=collabspaces&select=preferredcredentials";var f="";var g=function(l){var k={};k.collabspacesDetails=l;j(k)};c.makeWSCall(h,"GET","enovia","application/json",f,g,i)});return e},onPnORetrieve:function(e){if(e){var i=a.ECM_CA_SC_Label;"Select a Security Context";var f=d.getSCPreference(i);widget.addPreference(f);var h=widget.getValue("SC");var g=d.getSCPreferred(h);widget.setValue("SC",h)}},onRefresh:function(){var e=widget.getValue("SC");prefix="ctx::";response=prefix+e;console.log("Setting security Context: "+response);enoviaServerCAWidget.mySecurityContext=response;response=response.replace("ctx::","");enoviaServerCAWidget.myRole=response.substring(0,response.indexOf("."));enoviaServerCAWidget.collabspace=response.substring(response.lastIndexOf(".")+1,response.length)},checkValiditySC:function(f){var g=false;var e=0;if(d._theListSC){while((!g)&&(e<d._theListSC.length)){if(f===d._theListSC[e]){g=true}e++}}return g},ComputeList:function(l){var f=false;var g=[];var w,A,v;var s=l.preferredcredentials;if(s&&s.collabspace&&s.role&&s.organization){var q=s.collabspace;var n=s.role;var z=s.organization;w=q.name;A=n.name;v=z.name;d._SCPreferredDB=A+"."+v+"."+w}var B=l.collabspaces;if(B&&B.length>0){for(var y=0;y<B.length;y++){var h=B[y];var e=h.name;var m=h.couples;for(var x=0;x<m.length;x++){var r=m[x];var k=r.organization;var p=r.role;var o=k.name;var u=p.name;var t=u+"."+o+"."+e;g.push(t);if(d._SCPreferredDB!=""){if((v===o)&&(A===u)&&(w===e)){f=true}}else{f=true}}}d._theListSC=g}d.onPnORetrieve(f)},getSCPreference:function(f){var e={name:"SC",type:"list",label:f,options:[]};if(d._theListSC){for(var g=0;g<d._theListSC.length;g++){e.options.push({value:d._theListSC[g],label:d._theListSC[g]})}}return e},getSCPreferred:function(e){var f;if(d._SCPreferredDB!=""){f=d._SCPreferredDB}else{if(d.checkValiditySC(e)){f=e}else{f=undefined}}return f},populateTenantPreferences:function(){var f=a.ECM_CA_Pref_3DEXPERIENCE_Platform;var e={name:"x3dPlatformId",type:"list",label:f,options:[]};var g=new Promise(function(i,h){b.getPlatformServices({onComplete:function(k){k.forEach(function(l){var n=l.platformId;e.options.push({value:n,label:n});var m=widget.getValue("x3dPlatformId");if(m===n){d.populate3DspaceURL(l)}});var j={};j.TenantPreference=e;i(j)},onFailure:function(){console.log("Error getting Tenant details")}})});return g},populate3DspaceURL:function(e){enoviaServerCAWidget.baseURL=e["3DSpace"];enoviaServerCAWidget.federatedURL=e["3DSearch"];enoviaServerCAWidget.tenant=e.platformId}};return d});define("DS/ENOChangeActionUX/scripts/Views/ActivityForm",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Input/Text","UWA/Class/Model","DS/ENOChangeActionUX/scripts/CAUtility","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView"],function(c,m,h,k,i,j,b,e,d,a,l,g){var f=i.extend({cloneModel:null,activityCallback:null,slideInReference:null,detailsView:null,init:function(n){if(UWA.is(n)){this.activityCallback=n.callback;this.cloneModel=new g(n,{parse:true})}},getHeading:function(){if(this.cloneModel.id){return m.ECM_CA_Proposed_Activity_Heading_Edit}else{return m.ECM_CA_Proposed_Activity_Heading_Add}},getBody:function(){var o=this;var n=UWA.createElement("div",{id:"formBody"});n.setAttribute("data-rec-id","formBodyCA");var q=UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){if(!(UWA.is(arguments[0])&&arguments[0].hasChanged("reasonForChange"))){n.setContent("");o.detailsView=new l();o.detailsView.setConfig(o.getConfig());o.detailsView.model=o.cloneModel;o.detailsView.tenant=enoviaServerCAWidget.tenant;o.detailsView.context=enoviaServer.context;o.detailsView.render().inject(n)}}});var p=new q({model:o.cloneModel}).render();return n},getConfig:function(){var n=[];n.push({readWrite:true,name:"activityDisplaySelect",label:m.ECM_CA_Proposed_Change_Activity,type:"select",required:true,values:this.cloneModel.get("activityDisplayOptions")});n.push({readWrite:"true",name:"reasonForChange",label:m.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3});return n},getFooter:function(){var q=UWA.Element("div",{});if(!UWA.is(this.cloneModel.id)){var o=new j({value:m.ECM_CA_Button_Label_Add,className:"primary proposedButtons"}).inject(q);o.addEvent("onClick",this.onAddButtonClick.bind(this));var p=new j({value:m.ECM_CA_Button_Label_AddAnother,className:"proposedButtons"}).inject(q);p.addEvent("onClick",this.onAddAnotherButtonClick.bind(this))}else{if(UWA.is(this.cloneModel.id)){var n=new j({value:m.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(q);n.addEvent("onClick",this.onSaveButtonClick.bind(this))}}return q},onAddButtonClick:function(){if(this.detailsView.isModelValid()){this.activityCallback(this.cloneModel);this.slideInReference.hideSlideIn()}else{a.error(m.ECM_CA_MandFieldMissing_error)}},onAddAnotherButtonClick:function(){if(this.detailsView.isModelValid()){this.activityCallback(this.cloneModel);this.cloneModel.set("reasonForChange","");this.cloneModel.set("canEdit",true)}else{a.error(m.ECM_CA_MandFieldMissing_error)}},onSaveButtonClick:function(){if(this.detailsView.isModelValid()){this.activityCallback(this.cloneModel);this.slideInReference.hideSlideIn()}else{a.error(m.ECM_CA_MandFieldMissing_error)}}});return f});define("DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Core"],function(g,c,b,f,a,e){var d=g.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:operationDisplaySelect",function(h){this.updateOperationDisplayInfo(h)});this.addEvent("onChange:operationActual",function(h){this.updateOperationDisplaySelectInfo(h)});this.addEvent("onChange:activityDisplaySelect",function(h){this.updateActivityDisplayInfo(h)});this.addEvent("onChange:activityActual",function(h){this.updateActivityDisplaySelectInfo(h)});this.addEvent("onChange:proposedObject",function(h){this.updateAllowedOperationInfo(h)});this.addEvent("onChange:createNewToggle",function(h){if(UWA.is(h.get("createNewToggle"))&&h.get("createNewToggle")=="TRUE"){h.set("isCreateOperation",true)}else{h.set("isCreateOperation",false)}})},parse:function(h){var l=h.model;this.set("canEdit",true);if(UWA.is(h.selectedOperation)){var j=[{displayValue:"",actualValue:"NoSelection"},{displayValue:f.getOperationNameOnUI("None"),actualValue:"None"},{displayValue:f.getOperationNameOnUI("NewEvolution"),actualValue:"NewEvolution"},{displayValue:f.getOperationNameOnUI("NewMinorVersion"),actualValue:"NewMinorVersion"},{displayValue:f.getOperationNameOnUI("NewVersion"),actualValue:"NewVersion"}];this.set("operationDisplayOptions",j);var i={displayValue:"",actualValue:"NoSelection"};this.set("operationDisplaySelect",i);this.set("operationDisplay",i.displayValue);this.set("operationActual",i.actualValue)}else{if(UWA.is(l.id)){var k={};this.set("isEdit",true);this.set("id",l.id);k.objectType=l.get("objectType");k.objectName=(enoviaServerCAWidget.NamePref=="Name")?l.get("objectName"):l.get("objectTitle");k.objectRev=l.get("revision");k.objectName=k.objectName+" "+k.objectRev;k.objectID=l.get("objectId").replace("pid:","");k.maturity=l.get("maturity");k.policy=l.get("policy");k.image={imageValue:l.get("icon")};this.set("createObjectTitle",l.get("name"));this.set("createObjectType",l.get("type"));this.set("proposedObject",k);this.set("evolutionName",UWA.is(l.get("evolutionName"))?l.get("evolutionName"):"");this.set("operationActual",l.get("operationActual"));if(l.get("operationActual")=="Create"){this.set("isCreateOperation",true)}else{this.set("isCreateOperation",false)}if(l.get("operationActual")=="NewEvolution"){this.set("isEvolutionOperation",true)}else{this.set("isEvolutionOperation",false)}this.updateOperationDisplaySelectInfo(this);this.updateAllowedOperationInfo(this);this.set("reasonForChange",l.get("changeReason"))}}},add:function(n,l,i){var m={};var j=this;var h=l;var k=[h];f.getAdditionObjectInfo(k).then(function(p){m.objectType=p.additionObjectInfo[h].type;m.objectName=(enoviaServerCAWidget.NamePref=="Name")?p.additionObjectInfo[h].objectName:p.additionObjectInfo[h].objectTitle;m.objectRev=p.additionObjectInfo[h].revision;m.objectName=m.objectName+" "+m.objectRev;m.objectID=p.additionObjectInfo[h].pid;m.policy=p.additionObjectInfo[h].policy;m.image={imageValue:p.additionObjectInfo[h].icon};var o=j.get(n);if(UWA.is(o,"object")){j.unset(n)}j.set(n,m)},function(o){console.log("Populate Security Context failed");return Promise.reject(o)})},remove:function(k,i,h){var j=this.get(k);if(UWA.is(j,"object")){this.unset("operationActual",{silent:true});this.unset(k)}},updateOperationDisplaySelectInfo:function(h){var i=h.get("operationActual");require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(k){var j=k.getOperationNameOnUI(i);h.set("operationDisplaySelect",{displayValue:j,actualValue:i},{silent:true});h.set("operationDisplay",j)})},updateActivityDisplaySelectInfo:function(h){var i=h.get("activityActual");require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(k){var j=k.getOperationNameOnUI(i);if(i=="Release"||i=="Obsolete"){j=b.ECM_CA_Proposed_Activity_ChangeMaturity+": "+j}h.set("activityDisplaySelect",{displayValue:j,actualValue:i},{silent:true});h.set("activityDisplay",j)})},updateActivityDisplayInfo:function(h){var j=h.get("activityDisplaySelect");if(UWA.is(j)&&UWA.is(j.actualValue)){var i=j.actualValue;h.set("activityActual",j.actualValue,{silent:true});h.set("activityDisplay",j.displayValue)}},updateOperationDisplayInfo:function(h){var i=h.get("operationDisplaySelect");if(UWA.is(i)&&UWA.is(i.actualValue)){var j=i.actualValue;if(UWA.is(j)&&j=="Create"){h.set("isCreateOperation",true)}else{h.set("isCreateOperation",false)}if(UWA.is(j)&&j=="NewEvolution"){h.set("isEvolutionOperation",true)}else{h.set("isEvolutionOperation",false)}h.set("operationActual",i.actualValue,{silent:true});h.set("operationDisplay",i.displayValue);h.set("activityActual","NoSelection")}},updateAllowedOperationInfo:function(h){if(UWA.is(h.get("proposedObject"))&&UWA.is(h.get("proposedObject").objectID)){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(j){var k=h.get("proposedObject").objectID;var i=[];i.push("pid:"+k);j.getAllowedOperationActivity(i).then(function(o){var l=[];o.allowedOperationActivity[k].allowedOperation.forEach(function(p){l.push({displayValue:j.getOperationNameOnUI(p),actualValue:p})});h.set("operationDisplayOptions",l);if(!h.get("isEdit")){h.set("operationActual",o.allowedOperationActivity[k].defaultOperation);var n=o.allowedOperationActivity[k].defaultActivity;n=UWA.is(n)?n:"NoSelection";h.set("activityActual",n);var m=[];m.push({displayValue:j.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"});o.allowedOperationActivity[k].allowedActivity.forEach(function(q){var p=j.getOperationNameOnUI(q);if(q=="Release"||q=="Obsolete"){p=b.ECM_CA_Proposed_Activity_ChangeMaturity+": "+p}m.push({displayValue:p,actualValue:q})});h.set("activityDisplayOptions",m)}},function(l){console.log("Get allowed operation/activity failed");return Promise.reject(l)})})}else{h.unset("operationDisplayOptions");h.unset("operationActual");h.unset("activityActual")}},proposedTypeAheadCallback:function(m,l,o){var n="searchStr="+encodeURIComponent(l)+"*";var h;if(m&&m.searchTypes){h=encodeURIComponent(m.searchTypes)}else{h="*"}n+="&typeStr="+h;var j="/resources/v2/e6w/service/ObjectSearch?"+n;var k=null;var i=function(s){if(s.success&&s.data){var x=s.data.length;var r=[];for(var t=0;t<x;t++){var y=s.data[t];if(y.dataelements){var v=y.type;var p=y.dataelements.name||"";var q=y.dataelements.image||"";var w=y.dataelements.title||"";var u=y.dataelements.revision||"";r.push({value:y.id,label:(w||p)+" "+u,image:q})}}o(r)}};return f.makeWSCall(j,"GET","enovia","application/json",k,i,null)}});return d});define("DS/ENOChangeActionUX/scripts/Views/OperationForm",["DS/E6WCommonUI/Views/DetailsDisplayView","UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Input/Text","UWA/Class/Model","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView","DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView","DS/ENOChangeActionUX/scripts/CAUtility","DS/UIKIT/Scroller"],function(o,c,p,h,m,j,k,b,g,f,e,n,i,a,d){var l=j.extend({displayViewModel:null,proposedCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,init:function(q){this.proposedCallback=q.callback;this.displayViewModel=new n(q,{parse:true});this.detailsView=new o();if(UWA.is(q.selectedOperation)){this.selectedOperation=q.selectedOperation;this.isMassUpdate=true}},getHeading:function(){if(this.isMassUpdate){return p.ECM_CA_Proposed_Operation_Heading_MassUpdate}else{if(this.displayViewModel.get("isEdit")){return p.ECM_CA_Proposed_Operation_Heading_Edit}else{return p.ECM_CA_Add_Proposed_Change}}},getBody:function(){var r=this;var q=UWA.createElement("div",{id:"formBody"});q.setAttribute("data-rec-id","formBodyCA");var t=UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){if(!(UWA.is(arguments[0])&&(arguments[0].hasChanged("reasonForChange")||arguments[0].hasChanged("evolutionName")||arguments[0].hasChanged("createObjectType")||arguments[0].hasChanged("createObjectTitle")||arguments[0].hasChanged("reasonForChangeForActivity")))){q.setContent("");r.detailsView.setConfig(r.getConfig());r.detailsView.model=r.displayViewModel;r.detailsView.tenant=enoviaServerCAWidget.tenant;r.detailsView.context=enoviaServer.context;r.detailsView.render().inject(q)}}});var s=new t({model:r.displayViewModel}).render();return q},getConfig:function(){var r=[];var q=new e({},false);if(!UWA.is(this.selectedOperation)){if(!this.isMassUpdate&&!this.displayViewModel.get("isEdit")){r.push({name:"createNewToggle",label:p.ECM_CA_Proposed_Operation_Operation_Create,customView:i})}if(!this.isMassUpdate&&!this.displayViewModel.get("isCreateOperation")){r.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:p.ECM_CA_Proposed_Operation_ProposedObject,attributeToDisplay:"objectName",singleObjectOnly:true,searchTitle:p.ECM_CA_Proposed_Change_label,searchTypes:enoviaServerCAWidget.proposedSearchType,required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",search:q})}}if(!this.displayViewModel.get("isCreateOperation")){r.push({readWrite:"true",name:"operationDisplaySelect",label:p.ECM_CA_Proposed_Operation_Operation,type:"select",required:true,values:this.displayViewModel.get("operationDisplayOptions")})}if(this.displayViewModel.get("isEvolutionOperation")&&!this.displayViewModel.get("isCreateOperation")){r.push({readWrite:"true",name:"evolutionName",label:p.ECM_CA_Operation_Evolution_Name,type:"text",required:true,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"evolutionName"})}if(this.displayViewModel.get("isCreateOperation")){r.push({readWrite:"true",name:"createObjectType",label:p.ECM_CA_Operation_Create_ObjectType,type:"text",required:true,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectType"})}if(this.displayViewModel.get("isCreateOperation")){r.push({readWrite:"true",name:"createObjectTitle",label:p.ECM_CA_Operation_Create_ObjectTitle,type:"text",required:true,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectTitle"})}r.push({readWrite:"true",name:"reasonForChange",label:p.ECM_CA_Proposed_Activity_ReasonForChange,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3});if(!this.isMassUpdate&&UWA.is(this.displayViewModel.get("operationActual"))&&!this.displayViewModel.get("isCreateOperation")&&!this.displayViewModel.get("isEdit")){r.push({readWrite:true,name:"activityDisplaySelect",label:p.ECM_CA_Proposed_Change_Activity,type:"select",values:this.displayViewModel.get("activityDisplayOptions")})}if(UWA.is(this.displayViewModel.get("activityActual"))&&this.displayViewModel.get("activityActual")!="NoSelection"&&!this.displayViewModel.get("isCreateOperation")){r.push({readWrite:"true",name:"reasonForChangeForActivity",label:p.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3})}return r},getFooter:function(){var t=UWA.Element("div",{"class":"slideinFooterBtns"});t.setAttribute("data-rec-id","slideinFooterBtnsCA");if(UWA.is(this.selectedOperation)){var q=new k({value:p.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(t);q.addEvent("onClick",this.onMassUpdateButtonClick.bind(this))}else{if(!UWA.is(this.displayViewModel.id)){var r=new k({value:p.ECM_CA_Button_Label_Add,className:"primary proposedButtons add"}).inject(t);r.addEvent("onClick",this.onAddButtonClick.bind(this));var s=new k({value:p.ECM_CA_Button_Label_AddAnother,className:"proposedButtons add-another"}).inject(t);s.addEvent("onClick",this.onAddAnotherButtonClick.bind(this))}else{if(UWA.is(this.displayViewModel.id)){var q=new k({value:p.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(t);q.addEvent("onClick",this.onSaveButtonClick.bind(this))}}}return t},onAddButtonClick:function(){if(this.detailsView.isModelValid()){this.proposedCallback(this.displayViewModel);this.slideInReference.hideSlideIn()}else{a.error(p.ECM_CA_MandFieldMissing_error)}},onAddAnotherButtonClick:function(){if(this.detailsView.isModelValid()){this.proposedCallback(this.displayViewModel);this.displayViewModel.clear();this.displayViewModel.set("canEdit",true)}else{a.error(p.ECM_CA_MandFieldMissing_error)}},onSaveButtonClick:function(){if(this.detailsView.isModelValid()){this.proposedCallback(this.displayViewModel);this.slideInReference.hideSlideIn()}else{a.error(p.ECM_CA_MandFieldMissing_error)}},onMassUpdateButtonClick:function(){if(this.detailsView.isModelValid()){this.proposedCallback(this.displayViewModel,this.selectedOperation);this.slideInReference.hideSlideIn()}else{a.error(p.ECM_CA_MandFieldMissing_error)}}});return l});define("DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/UIKIT/DropdownMenu","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/ENOChangeActionUX/scripts/Views/CASlideInFormView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENO6WPlugins/jQuery","DS/TransientWidget/TransientWidget",],function(d,p,h,l,e,b,g,c,j,k,o,a,n,q,f){function m(){e.registerHelper("getMoreText",function(){return p.ECM_CA_Proposed_More_Reason});e.registerHelper("ifNotCreate",function(r,t){var s="";if(r===p.ECM_CA_Proposed_Operation_Create){s='<span style="visibility:hidden">'+t+"</span>"}else{s="<span>"+t+"</span>"}return s});e.registerHelper("ifDraggable",function(s,r){if((s===p.ECM_CA_Proposed_Operation_Create)||(r===false)){return"draggable='false'"}else{return"draggable='true'"}});e.registerHelper("ifNotflowdown",function(s,u,t){var r="";if(s!="Flowdown"){r='<div class="proposedOperation-sub-container-second">                                         <div class="proposedOperation-reason-container" title="'+u+'">'+u+' </div>                                         <div class="proposedOperation-more-container" id="more-container-'+t+'">'+p.ECM_CA_Proposed_More_Reason+"</div>                                     </div>"}return r});e.registerHelper("ifflowdown",function(s,u,v,t){var r="";if(s==="Flowdown"){r='<div class="proposedOperation-sub-container-second">                                        <div class="proposedOperation-flowdown-from">                                            <span class="proposedOperation-flowdownfrom-text">'+p.ECM_CA_FLOWDOWN_FROM_LABEL+' </span>                                            <span class="proposedOperation-flowdownfrom-name" title="'+u+'" id= "'+v+'" objname = "'+t+'" >'+u+"</span>                                        </div>                                     </div>"}return r})}m();var i={activitiesToRemove:[],selectedActivityItems:[],proOpnView:null,_createView_TestProposed:function(t,u,v,s,r){return d.extend({name:"proposedOperation",tagName:t,className:u,proposedModel:s,contextCAId:r.id,contextCAName:r.caName,setup:function(){this.template='                                            <div class="'+this.getClassNames("-main-main-container")+'">                                            {{#each changes}}                                                <div class="'+this.getClassNames("-main-container")+'" id="main-container-{{@index}}">                                                    <div class="'+this.getClassNames("-collpased-container")+'" id="collapsed-{{@index}}" {{#ifDraggable operation access}}{{/ifDraggable}}>                                                        <div class="'+this.getClassNames("-accordion-container icon-class expander")+' accordion-div" id="accordion-div-{{@index}}">                                                          <div>                                                              <div class="action-icon-wrapper accordion-div-inner"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                              <div class="checked-action"><input type="checkbox" class="checkbox-accord hidden" id="checkbox-accord-{{@index}}"></div>                                                          </div>                                                        </div>                                                        <!--div>                                                                <div class="checked-action"><input type="checkbox" class="checkbox-accord hidden" id="checkbox-accord-{{@index}}"></div>                                                        </div-->                                                        <div class="'+this.getClassNames("-container")+'" id="proposedOp-container-{{@index}}">                                                            <div class="'+this.getClassNames("-sub-container-first")+'">                                                                <div class="'+this.getClassNames("-name-revision-container")+' ellipsis-info">                                                                    {{#if icon}}<div class="'+this.getClassNames("-icon-container")+'"><img class="Realized-change-info-icon" id="info-icon-{{@index}}" src ={{icon}}></img></div>{{/if}}                                                                    <div class="'+this.getClassNames("-name-container")+'">{{name}}</div>                                                                    <div class="'+this.getClassNames("-revision-container")+'">{{revision}}</div>                                                        </div>                                                                <div class="'+this.getClassNames("-more-info-container")+'">                                                                    <div class="'+this.getClassNames("-desc-op-container")+'">                                                                        <div class="'+this.getClassNames("-desc-container")+' ellipsis-info-1" title="{{desc}}">{{desc}}</div>                                                                        <div class="'+this.getClassNames("-op-container")+'">{{operation}}</div>                                                        </div>                                                                    <div class="'+this.getClassNames("-mat-collab-container")+'">                                                                        <div class="'+this.getClassNames("-mat-container")+'">{{#ifNotCreate operation maturity}}{{/ifNotCreate}}</div>                                                                        <div class="'+this.getClassNames("-collab-container")+' ellipsis-info-1">{{collabspace}}</div>                                                    </div>                                                </div>                                                </div>                                                            {{#ifNotflowdown operationActual changeReason @index}}{{/ifNotflowdown}}                                                            {{#ifflowdown operationActual flowDownFromName flowDownFromID name}}{{/ifflowdown}}                                                            <!--div class="'+this.getClassNames("-sub-container-second")+'">                                                                <div class="'+this.getClassNames("-reason-container")+'" title="{{changeReason}}">{{changeReason}}</div>                                                                <div class="'+this.getClassNames("-more-container")+'" id="more-container-{{@index}}">{{#getMoreText }}{{/getMoreText}}</div>                                                            </div-->                                                        </div>                                                        <div class="'+this.getClassNames("-actions-container icon-class-1")+'" id="operation-action-container-{{@index}}">                                                            <div class="context-actions-container">                                                            <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                        </div>                                                    </div>                                                </div>                                            <div class="proposed-tile-expanded hidden" id="expanded-{{@index}}"></div>                                            </div>                                            {{/each}}                                        </div>';this.myProposedModel=s;var w=this;widget.addEvent("onResize",function(){setTimeout(function(){i.onResize()},100)});i.selectedTilesMap={forEach:function(y){for(var x=0;x<w.proposedModel.length;x++){if(!UWA.is(this[x])){continue}y(this[x],x,this)}},set:function(x,y){this[x]=y}};i.selectedTilesIDMap={forEach:function(y){for(var x=0;x<w.proposedModel.length;x++){if(!UWA.is(this[x])){continue}y(this[x],x,this)}},set:function(x,y){this[x]=y}}},render:function(){this.container.empty();a.CurrModel=this.model;this.renderer=this.getTemplate(this.template,this.myProposedModel);var C=(v)?widget.body:this.container;var z=UWA.createElement("div",{"class":"operations-main-container",});z.setAttribute("data-rec-id","operations-main-container-CA");z.setStyle("height","calc(100% - 50px)");z.setStyle("overflow","auto");var y=null;y=this.renderer();z.addContent(y);new g({element:z}).inject(this.container);var B=i.proOpnView=this;for(var x=0;x<B.data.changes.length;x++){var w=this.container.getElement("#operation-action-container-"+x);if(w){var A=x;w.addEvent("click",function(F){var E=F.currentTarget.id.split("-")[3];E=parseInt(E);var G=B.data.changes[E].id;var D=B.proposedModel.findWhere({id:G});if(UWA.is(D)){this.model=D}i.itemView=this;if(D.get("operationActual")!="Create"&&D.get("Access")&&enoviaServerCAWidget.isNative){a.DispatchEventToWin("Proposed_ContextMenu",D.get("objectId").replace("pid:",""))}else{i.DisplayContextMenu([])}})}}i.container=B;this.activitiesViewArr.forEach(function(E,D){B.injectSubView(E,"#expanded-"+E.activityIdx)});return this},injectSubView:function(y,w){var x=this.container.getElement(w);if(y&&x){x.grab(y.render().getContent())}},_initActivitiesView:function(z,w){var y=this.activitiesView=new (c._createView_TestProposed(false,z,w));var x=this._actvitiesEvents={deleteActivity:function(){var A={};A.operationIdx=w;this.dispatchEvent("deleteActivity",[arguments[1],A])},editActivity:function(){var A={};A.operationIdx=w;this.dispatchEvent("editActivity",[arguments[1],A])},onActionClickActivities:function(){var A=this;var D=this.myProposedModel.at(w);var C=arguments[1].model.get("id");var B={};B.operationIdx=w;B.idOfAction=C;this.dispatchEvent("onActionClickActivities",[D,B])},removeMultiSelActvities:function(){var A={};A.operationIdx=w;this.dispatchEvent("removeMultiSelActvities",[arguments[0],A])}};this.listenTo(this.activitiesView,this._actvitiesEvents);this.activitiesViewArr.push(this.activitiesView)},getTemplate:function(A,x){var z=e.compile(A);var B=this;var y=[];this.activitiesViewArr=[];var w=i.proposedModel;x.forEach(function(D,C){if((D.get("operationActual")!="Create")&&(D.get("operationActual")!="Flowdown")){B._initActivitiesView(D.get("activities"),C)}var E={operation:D.get("operationDisplay"),operationActual:D.get("operationActual"),maturity:D.get("maturity"),name:UWA.is(D.get("objectName"))?D.get("objectName"):D.get("name"),icon:D.get("icon"),revision:D.get("revision"),changeReason:D.get("changeReason"),id:D.get("id"),objectId:D.get("objectId"),desc:D.get("objectTitle"),access:D.get("Access"),collabspace:D.get("collabSpace"),flowDownFromName:(enoviaServerCAWidget.NamePref==="Title")?D.get("flowDownFromTitle"):D.get("flowDownFromName"),flowDownFromID:D.get("flowDownFromId"),};if(enoviaServerCAWidget.NamePref=="Title"){E.name=D.get("objectTitle");E.desc=UWA.is(D.get("objectName"))?D.get("objectName"):D.get("name")}y.push(E)});this.data={changes:y};return function(){return z(B.data)}},domEvents:{"click .accordion-div-inner":function(x){var z=x.target.id;var w=this.container.getElement("#proposedOp-container-"+z);var y=x.target.className;if(y.indexOf("expand-right")>0){x.target.className=y.replace("right","down").trim()}else{if(y.indexOf("expand-down")>0){x.target.className=y.replace("down","right").trim()}}i.accordionClassName=x.target.className;i.expandTile(z,y)},"click .proposedOperation-collpased-container":function(z){if(z.target.className.indexOf("down")>=0){return}if(z.target.className.indexOf("right")>=0){return}if(z.target.className.indexOf("checkbox")>=0){return}if(z.target.className.indexOf("more-container")>=0){return}var C=z.target;function x(E){while((E=E.parentNode)&&!E.classList.contains("proposedOperation-collpased-container")){}return E}var A=null;if(C.className.indexOf("proposedOperation-collpased-container")>=0){A=C}else{A=x(C)}var D=A.id;var y=D.split("-");var B=y[y.length-1];var w=this.container.getElement("#checkbox-accord-"+B);if(w&&(!w.hasClassName("hidden"))){return}i.changeAccordIconAndExpandTile(B)},"click .checkbox-accord":function(w){var D=this.myProposedModel;var C=w.target;var x=w.target.id;var A=x.split("-");var E=A[A.length-1];var z=parseInt(E);var B=D.at(z);var y=this.container.getElement("#main-container-"+E);if(y.hasClassName("selected-border")){y.removeClassName("selected-border")}else{y.addClassName("selected-border")}var y=document.createElement("input");y.setAttribute("data-pid",B.get("objectId").replace("pid:",""));y.setAttribute("data-type",B.get("type"));if(w.target.checked){y.setAttribute("class","selected");n.onClickItem.call(y,widget,enoviaServerCAWidget)}else{n.onClickItem.call(y,widget,enoviaServerCAWidget)}Array.prototype.unshift.call(arguments,B);this.dispatchEvent("onCheckboxClick",arguments)},"click .proposedOperation-more-container":function(x){var C=x.target.id;var A=C.split("-");var F=A[A.length-1];var z=this.container.getElement("#collapsed-"+F);var D="";if(z){D=z.id}var B=q("#"+D).find(".proposedOperation-reason-container");if(B){var E=B.css("max-height");if(E==="none"){B.css("max-height","3.6em")}else{B.css("max-height","none")}}var y=q("#"+D).find(".proposedOperation-more-container");if(y){var w=y.text();if(w===p.ECM_CA_Proposed_Less_Reason){y.text(p.ECM_CA_Proposed_More_Reason)}else{y.text(p.ECM_CA_Proposed_Less_Reason)}}},dragstart:function(A){var x=this.myProposedModel;var C=A.target;var D=A.target.id;var w=D.split("-");var z=w[w.length-1];var y=parseInt(z);var B=x.at(y);Array.prototype.unshift.call(arguments,B);Array.prototype.unshift.call(arguments,{});this.dispatchEvent("onItemViewDrag",arguments)},"click .proposedOperation-flowdownfrom-name":function(A){var C=A.target.id;var B=A.target.attributes.objname.value;C=C.replace("pid:","");var x=(enoviaServerCAWidget.NamePref==="Title")?"Title":"Name";var z={TransientCAPid:C,originatingPid:this.contextCAId,originatingcaName:this.contextCAName,objName:B,status:true,nameTitlePref:x};if(enoviaServerCAWidget.isNative){var w={TransientCAPid:C};var w={flowdown:z};var y=JSON.stringify(w);a.DispatchEventToWin("OpenCAAdvanced",y)}else{f.showWidget("ENOWCHA_AP","",z,{mode:"panel",height:800,width:650})}}},destroy:function(){if(this.activitiesView){this.stopListening(this.activitiesView,this._actvitiesEvents)}this.stopListening(this.myProposedModel);this.myProposedModel=null;return this._parent.apply(this,arguments)}})},DisplayContextMenu:function(t){var s=i.getcontextItemActions();var r=i.getcontextItemActionsBottom();s.push.apply(s,t);s.push.apply(s,r);a._initDropDown(s,i.itemView)},getcontextItemActions:function(){var s=this;var w=[];var t={text:p.ECM_CA_Edit_Proposed_Changs,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",handler:function(){var y=[];var A=s.itemView.model.id;var z=s.itemView.model;if(z){y.push(z)}s.proOpnView.dispatchEvent("editProposed",[s.itemView,y,arguments[0]])}};var u={text:p.ECM_CA_Explore_With_Central,icon:"fonticon fonticon-window",handler:function(){if(enoviaServerCAWidget.is3DSpace){var C=s.itemView.model.id.replace("pid:","");var D=widget.getUrl();D=D.substring(0,D.indexOf("/enterprisechangemgt"));var z=D+"/common/emxTree.jsp?mode=insert&objectId="+C;getTopWindow().showModalDialog(z,"500","500","true","popup")}else{var C=s.itemView.model.get("objectId").replace("pid:","");var z="/common/emxTree.jsp?mode=insert&objectId="+C;var B=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var A=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+B+"&forwardUrl="+z);var y=window.open();y.opener=null;y.location.href=A}}};var v=s.itemView.model;var x=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var r=a.CurrModel.get("userAccess");if((r&&r.AddProposed&&r.AddProposed==="false")||(!r.AddProposed)){x=false}}if(v.get("Access")==true&&x){w.push(t)}var v=s.itemView.model;if(v.get("Access")==true){if(!enoviaServerCAWidget.isNative){if(v.get("operationActual")!="Create"){w.push(u)}}}return w},getcontextItemActionsBottom:function(){var v=this;var s=[];var r=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var z=a.CurrModel.get("userAccess");if((z&&z.AddProposed&&z.AddProposed==="false")||(!z.AddProposed)){r=false}}var w=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var z=a.CurrModel.get("userAccess");if((z&&z.DeleteProposed&&z.DeleteProposed==="false")||(!z.DeleteProposed)){w=false}}var y={text:p.ECM_CA_Remove_Proposed_Changes,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(B){var A=[];var D=v.itemView.model.id;var C=v.itemView.model;if(C){A.push(C)}v.proOpnView.dispatchEvent("deleteProposed",[v.itemView,A,arguments[0]])}};var u={id:"Properties",text:p.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:true,handler:function(A){var B=v.itemView.model.get("objectId").replace("pid:","");a.createPropertiesComponent(B)}};var x=v.itemView.model;if(x.get("Access")==true){if(x.get("operationActual")!="Create"){s.push(u)}}if(x.get("operationActual")!="Flowdown"){s.push(y)}var t={id:"ChangeAssessment",text:p.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjProps",multisel:true,handler:function(A){var C=v.itemView.model.get("objectId");var B=[C];a.openRelationalExplorer(B)}};if(r&&enoviaServerCAWidget.CHG_CHANGE_ASSESSMENT=="true"&&!enoviaServerCAWidget.isNative){s.push(t)}return s},changeAccordIconAndExpandTile:function(t){var r=this.container.getElement("#accordion-div-"+t);var s=r.getElementsByTagName("span")[0].className;if(s.indexOf("expand-right")>0){r.getElementsByTagName("span")[0].className=s.replace("right","down").trim()}else{if(s.indexOf("expand-down")>0){r.getElementsByTagName("span")[0].className=s.replace("down","right").trim()}}i.accordionClassName=r.getElementsByTagName("span")[0].className;i.expandTile(t)},expandTile:function(u){var r=document.getElementById("expanded-"+u);if(r){var s=r.className;if(s.indexOf("hidden")>0){r.className=s.replace("hidden","").trim()}else{r.className=s+" hidden"}}var t=document.getElementById("collapsed-"+u);if(t){if(t.style.borderBottom.indexOf("hidden")>=0){t.style.borderBottom=""}else{t.style.borderBottom="hidden"}}i.selectedTilesIDMap.set(u,u);i.selectedTilesMap.set(u,t);i.onResize(u)},deactivateMultisel:function(){var r=i.container.container;var x=r.getElements(".proposedOperation-actions-container");for(var w=0;w<x.length;w++){var z=x[w];z.removeClassName("no-actions")}var y=r.getElements(".accordion-div-inner");var s=r.getElements(".checkbox-accord");for(var w=0;w<y.length;w++){var t=y[w];t.removeClassName("hidden");var v=t.getElementsByTagName("span")[0].className;if(v.indexOf("expand-down")>0){t.getElementsByTagName("span")[0].className=v.replace("down","right").trim()}var u=s[w];if(u.checked){u.checked=false}u.addClassName("hidden")}var B=r.getElements(".proposedOperation-main-container");for(var w=0;w<B.length;w++){var A=B[w];A.removeClassName("selected-border")}i.onResize()},activateMultisel:function(){var r=i.container.container;var x=r.getElements(".proposedOperation-actions-container");for(var w=0;w<x.length;w++){var A=x[w];A.addClassName("no-actions")}var y=r.getElements(".accordion-div-inner");var t=r.getElements(".checkbox-accord");for(var w=0;w<y.length;w++){var u=y[w];var v=t[w];v.removeClassName("hidden");u.addClassName("hidden")}var s=r.getElements(".proposed-tile-expanded");for(var w=0;w<s.length;w++){var D=s[w];var z=D.hasClassName("hidden");if(z===false){D.addClassName("hidden")}}var C=r.getElements(".proposed-tile-collapsed");for(var w=0;w<C.length;w++){var B=C[w];B.style.borderBottom=""}i.onResize()},resizeForTabletView:function(r,s){if(r.reasonElem!=null){if(s.indexOf("expand-right")>=0){r.reasonElem.css("display","none");if(r.flowDownElem){r.flowDownElem.css("display","none")}if(r.moreElem){r.moreElem.css("display","none")}}else{if(s.indexOf("expand-down")>=0){r.reasonElem.css("display","-webkit-box");r.reasonElem.css("display","flex");r.reasonElem.css("display","-moz-box");r.reasonElem.css("display","-webkit-flexbox");r.reasonElem.css("display","-ms-flexbox");r.reasonElem.css("display","-webkit-flex");r.reasonElem.css("display","flex");r.reasonElem.css("margin-top","10px");if(r.flowDownElem){r.flowDownElem.css("display","-webkit-box");r.flowDownElem.css("display","flex");r.flowDownElem.css("display","-moz-box");r.flowDownElem.css("display","-webkit-flexbox");r.flowDownElem.css("display","-ms-flexbox");r.flowDownElem.css("display","-webkit-flex");r.flowDownElem.css("display","flex");r.flowDownElem.css("margin-top","10px")}if(r.moreElem&&(r.reasonElem[0]&&r.reasonElem[0].innerHTML!="")){r.moreElem.css("display","-webkit-box");r.moreElem.css("display","-moz-box");r.moreElem.css("display","-webkit-flexbox");r.moreElem.css("display","-ms-flexbox");r.moreElem.css("display","-webkit-flex");r.moreElem.css("display","flex")}}}}if(r.secondSubContainer){r.secondSubContainer.css("flex-basis","auto")}if(r.matCollabContainerElem!=null){r.matCollabContainerElem.css("display","block")}if(r.matContainerElem!=null){r.matContainerElem.css("margin-right","0px")}if(r.collabContainerElem!=null){r.collabContainerElem.css("margin-left","0px")}if(r.moreInfoContainerElem!=null){r.moreInfoContainerElem.css("flex-direction","row");r.moreInfoContainerElem.css("-webkit-flex-direction","row");r.moreInfoContainerElem.css("-ms-flex-direction","row");if(s.indexOf("expand-down")>=0){r.moreInfoContainerElem.css("border-bottom","1px solid #d1d4d4");r.moreInfoContainerElem.css("padding-bottom","10px")}else{if(s.indexOf("expand-right")>=0){r.moreInfoContainerElem.css("border-bottom","none");r.moreInfoContainerElem.css("padding-bottom","0px")}}}},resizeForMobileView:function(r,s){if(r.matCollabContainerElem){if(s.indexOf("expand-down")>=0){r.matCollabContainerElem.css("display","-webkit-box");r.matCollabContainerElem.css("display","-moz-box");r.matCollabContainerElem.css("display","-webkit-flexbox");r.matCollabContainerElem.css("display","-ms-flexbox");r.matCollabContainerElem.css("display","-webkit-flex");r.matCollabContainerElem.css("display","flex")}else{if(s.indexOf("expand-right")>=0){r.matCollabContainerElem.css("display","none")}}}if(r.collabContainerElem){}if(r.secondSubContainer){r.secondSubContainer.css("flex-basis","auto")}if(r.moreInfoContainerElem){r.moreInfoContainerElem.css("flex-direction","column");r.moreInfoContainerElem.css("-webkit-flex-direction","column");r.moreInfoContainerElem.css("-ms-flex-direction","column");if(s.indexOf("expand-down")>=0){r.moreInfoContainerElem.css("border-bottom","1px solid #d1d4d4");r.moreInfoContainerElem.css("padding-bottom","10px")}else{if(s.indexOf("expand-right")>=0){r.moreInfoContainerElem.css("border-bottom","none");r.moreInfoContainerElem.css("padding-bottom","0px")}}}if(r.reasonElem){if(s.indexOf("expand-right")>=0){r.reasonElem.css("display","none");if(r.flowDownElem){r.flowDownElem.css("display","none")}if(r.moreElem){r.moreElem.css("display","none")}}else{if(s.indexOf("expand-down")>=0){r.reasonElem.css("display","-webkit-box");r.reasonElem.css("display","-moz-box");r.reasonElem.css("display","-webkit-flexbox");r.reasonElem.css("display","-ms-flexbox");r.reasonElem.css("display","-webkit-flex");r.reasonElem.css("display","flex");r.reasonElem.css("margin-top","5px");if(r.flowDownElem){r.flowDownElem.css("display","-webkit-box");r.flowDownElem.css("display","-moz-box");r.flowDownElem.css("display","-webkit-flexbox");r.flowDownElem.css("display","-ms-flexbox");r.flowDownElem.css("display","-webkit-flex");r.flowDownElem.css("display","flex");r.flowDownElem.css("margin-top","5px")}if(r.moreElem&&(r.reasonElem[0]&&r.reasonElem[0].innerHTML!="")){r.moreElem.css("display","-webkit-box");r.moreElem.css("display","-moz-box");r.moreElem.css("display","-webkit-flexbox");r.moreElem.css("display","-ms-flexbox");r.moreElem.css("display","-webkit-flex");r.moreElem.css("display","flex");r.moreElem.css("margin-top","5px")}}else{if(s===""){r.reasonElem.css("display","none")}}}}},resizeForOthers:function(r,s){if(r.secondSubContainer){r.secondSubContainer.css("-webkit-box-flex","1");r.secondSubContainer.css("-moz-box-flex","1");r.secondSubContainer.css("-ms-flex","1");r.secondSubContainer.css("-webkit-flex","1");r.secondSubContainer.css("flex","1")}if(r.reasonElem){r.reasonElem.css("margin-top","0px");r.reasonElem.css("display","-webkit-box");r.reasonElem.css("max-height","3.6em");r.reasonElem.css("display","-ms-flexbox");r.reasonElem.css("display","-moz-box");r.reasonElem.css("display","-webkit-flexbox");r.reasonElem.css("display","-ms-flexbox");r.reasonElem.css("display","-webkit-flex");r.reasonElem.css("display","flex")}if(r.flowDownElem){r.flowDownElem.css("margin-top","0px");r.flowDownElem.css("display","-webkit-box");r.flowDownElem.css("max-height","3.6em");r.flowDownElem.css("display","-ms-flexbox");r.flowDownElem.css("display","-moz-box");r.flowDownElem.css("display","-webkit-flexbox");r.flowDownElem.css("display","-ms-flexbox");r.flowDownElem.css("display","-webkit-flex");r.flowDownElem.css("display","flex")}if(r.moreElem){r.moreElem.css("display","none")}if(r.firstSubContainer){r.firstSubContainer.css("border-bottom","none");r.firstSubContainer.css("padding-bottom","0px")}if(r.secondSubContainer){r.secondSubContainer.css("margin-right","30px");r.secondSubContainer.css("padding-left","10px")}if(r.matCollabContainerElem){r.matCollabContainerElem.css("display","block")}if(r.matContainerElem){r.matContainerElem.css("margin-right","0px")}if(r.collabContainerElem){r.collabContainerElem.css("margin-left","0px")}if(r.moreInfoContainerElem){r.moreInfoContainerElem.css("flex-direction","row");r.moreInfoContainerElem.css("-webkit-flex-direction","row");r.moreInfoContainerElem.css("-ms-flex-direction","row");r.moreInfoContainerElem.css("border-bottom","none");r.moreInfoContainerElem.css("padding-bottom","0px")}},resizeProposedOperations:function(A,y){if(A===undefined){A=i.collapsedTile}var x=null;var D=null;var B=null;var s=null;var t=null;var w=null;var C={};if(A){var v=A.id.trim();C.reasonElem=q("#"+v).find(".proposedOperation-reason-container");C.flowDownElem=q("#"+v).find(".proposedOperation-flowdown-from");C.moreElem=q("#"+v).find(".proposedOperation-more-container");C.firstSubContainer=q("#"+v).find(".proposedOperation-sub-container-first");C.secondSubContainer=q("#"+v).find(".proposedOperation-sub-container-second");C.matCollabContainerElem=q("#"+v).find(".proposedOperation-mat-collab-container");C.matContainerElem=q("#"+v).find(".proposedOperation-mat-container");C.collabContainerElem=q("#"+v).find(".proposedOperation-collab-container");C.moreInfoContainerElem=q("#"+v).find(".proposedOperation-more-info-container");C.proposedOpActionsContainerElem=q(".proposedview-proposedActions")}var z="laptop";var u=window.matchMedia("(max-width: 992px) and (min-width: 768px)");var r=window.matchMedia("(max-width: 768px)");if(u.matches){z="tablet"}if(r.matches){z="mobile"}switch(z){case"tablet":i.resizeForTabletView(C,y);break;case"mobile":i.resizeForMobileView(C,y);break;case"laptop":i.resizeForOthers(C,y);break;default:console.log("invalid viewport selected")}},onResize:function(r){i.selectedTilesMap.forEach(function(v,t){var u="";var w="";if(v){w=v.id}var s=q("#"+w).find(".fonticon");if(s){u=s[0].className}i.resizeProposedOperations(v,u)})},getJSONForModifyOperation:function(t){var x=i.getJSONForModifyProposed();var s=t.operation;var y=t.operationWHY;var v="";if(s=="Create"){v={id:t.pid,operation:{name:s,type:t.objectType,"display name":t.objectName},why:{comment:{text:y}}};x.changeaction.modify.proposed.push(v)}else{var w=t.proposedIDArr;for(var u=0;u<w.length;u++){var r=w[u];if(s=="NoSelection"){v={id:r,why:{comment:{text:y}}}}else{v={id:r,operation:{name:s},why:{comment:{text:y}}};v.operation["evolution name"]=t.evolutionName}x.changeaction.modify.proposed.push(v)}}return x},getJSONForModifyProposed:function(){var r=i.getCABaseJSONForOperations();r.changeaction.modify={proposed:[]};return r},getCABaseJSONForOperations:function(){var s={version:"v0",changeaction:{cestamp:"0000",add:{},"delete":{},modify:{}}};var r=JSON.parse(JSON.stringify(s));return r}};return i});define("DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/CAUtility",],function(b,g,j,d,i,c,k,f,h,e,a){var l={_createView_TestHeader:function(n,o,p,m){return b.extend({name:"proposedview",tagName:n,className:o,currModel:null,proposedModel:m,setup:function(){this.template='                                            <div class="'+this.getClassNames("-header")+'">                                                    <div class="'+this.getClassNames("-proposedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-proposedActions")+'"></div>                                                    <div class="'+this.getClassNames("-proposedMultisel")+'"></div>                                            <\div>';this.myProposedModel=m;this._initCounterView();this._initActionsView();this._initMultiSelView();this.renderer=this.getTemplate(this.template);var q=this;widget.addEvent("onResize",function(){setTimeout(function(){if(UWA.is(q.actionsView)){q.actionsView.destroy();var r=q.container.getElement(".proposedview-proposedActions");q._initActionsView();if(q.actionsView&&r){r.empty();r.grab(q.actionsView.render().getContent());q.actionsView&&q.actionsView.dispatchEvent("onShow")}}},100)})},render:function(){var s=this.name;a.CurrModel=this.model;var u=this.cid;this.container.empty();var t=this.container;var r=UWA.createElement("div",{"class":"proposedview-counter-details",styles:{width:"99.5%",height:"10%",}});r.setAttribute("data-rec-id","proposedview-counter-details-CA");var q=this.renderer();r.addContent(q);r.inject(t);this.injectSubView(this.counterView,"."+s+"-proposedCounter");this.injectSubView(this.actionsView,"."+s+"-proposedActions");this.injectSubView(this.proposedMultiSelView,"."+s+"-proposedMultisel");this.actionsView&&this.actionsView.dispatchEvent("onShow");this.counterView&&this.counterView.dispatchEvent("onShow");this.proposedMultiSelView&&this.proposedMultiSelView.dispatchEvent("onShow");return this},_initCounterView:function(){this.counterView=new k({title:j.ECM_CA_ProposedChanges,collection:this.myProposedModel})},_initActionsView:function(){var u=j.ECM_CA_Sort_ProposedChanges_Name;if(enoviaServerCAWidget.NamePref=="Title"){u=j.ECM_CA_Sort_ProposedChanges_Title}var w=[{id:"sort",title:u,icon:"sort-alpha-asc",overflow:false,},{id:"search",title:j.ECM_CA_Search_ProposedChanges,icon:"search",overflow:false},];var r={id:"add",title:j.ECM_CA_Add_ProposedChanges,icon:"plus",overflow:false};var v={id:"selectAll",title:j.SelectAll,icon:"select-all",overflow:false};var q={id:"unSelectAll",title:j.UnSelectAll,icon:"select-none",overflow:false};var s=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var y=a.CurrModel.get("userAccess");if((y&&y.AddProposed&&y.AddProposed==="false")||(!y.AddProposed)){s=false}}w.push(v);w.push(q);if(s){w.unshift(r)}var x=new h(w);this.actionsView=new f({collection:x});var t=this._actionsViewEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView);this.dispatchEvent("onActionClick",arguments)},};this.listenTo(this.actionsView,t)},_initMultiSelView:function(){var q=this;var r={collection:new h(),withMultisel:true,useInfiniteScroll:false,usePullToRefresh:false,buildMultiselActions:function(z){var x=[];var u=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var t=a.CurrModel.get("userAccess");if((t&&t.DeleteProposed&&t.DeleteProposed==="false")||(!t.DeleteProposed)){u=false}}if(UWA.is(z)){if(z.result!=undefined&&z.result!=null&&enoviaServerCAWidget.isNative&&UWA.is(z.result.refPid)){q.exploreRefIds=z.result.refPid;if(z.result.refPid!=null){x.push({accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:true,text:j.ECM_CA_Command_ExploreContext,handler:function(C){var A=[];var B=[];B=q.exploreRefIds;Array.prototype.unshift.call(arguments,C);q.dispatchEvent("exploreInContext",arguments)}})}}}if(u){x.push({id:"remove",text:j.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:true,handler:function(A){Array.prototype.unshift.call(arguments,A);q.dispatchEvent("removeMultiSel",arguments)}})}var v={id:"mass-update",text:j.ECM_CA_Proposed_Mass_Update,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",multisel:true,handler:function(A){Array.prototype.unshift.call(arguments,A);q.dispatchEvent("massUpdateMultiSel",arguments)}};var w={id:"changematurity",text:j.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:true,handler:function(A){Array.prototype.unshift.call(arguments,A);q.dispatchEvent("changematurityMultiSel",arguments)}};var y=true;if(UWA.is(a.CurrModel)&&UWA.is(a.CurrModel.get("userAccess"))){var t=a.CurrModel.get("userAccess");if((t&&t.AddProposed&&t.AddProposed==="false")||(!t.AddProposed)){y=false}}if(y){x.push(v)}if(window.enoviaServerCAWidget.CHG_CHANGE_MATURITY!="false"){x.push(w)}var s={id:"ChangeAssessment",text:j.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjEdit",multisel:true,handler:function(B){var A=[];B.forEach(function(D){var C=D.get("objectId");if(C==undefined||C==null||C==""){C=D.get("id")}A.push(C)});a.openRelationalExplorer(A)}};if(y&&enoviaServerCAWidget.CHG_CHANGE_ASSESSMENT=="true"&&!enoviaServerCAWidget.isNative){x.push(s)}return x},events:{onMultiselOff:function(){var s=q;g.deactivateMultisel();if(enoviaServerCAWidget.arrOid&&enoviaServerCAWidget.arrOid.length){enoviaServerCAWidget.arrOid.splice(0,enoviaServerCAWidget.arrOid.length)}q.dispatchEvent("emptySelectedModels",arguments)},onMultiselOn:function(){g.activateMultisel()}}};l.multiSelView=this.proposedMultiSelView=new e(r)},injectSubView:function(s,q){var r=this.container.getElement(q);if(s&&r){r.grab(s.render().getContent())}},getTemplate:function(r){var q=c.compile(r);var s=this;return function(){return q()}},domEvents:{"click .accordion-div":function(q){}},destroy:function(){this.stopListening();this.myProposedModel=null;this.counterView.destroy();this.actionsView.destroy();this.proposedMultiSelView.destroy();return this._parent.apply(this,arguments)}})}};return l});define("DS/ENOChangeActionUX/scripts/Views/CANewProposedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/W3DXComponents/Views/EmptyView","DS/ENOChangeActionUX/scripts/CAUtility","DS/DataDragAndDrop/DataDragAndDrop","UWA/Class/Collection","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/ENOChangeActionUX/scripts/CASpinner","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/Models/CAProposedModel","DS/ENOChangeActionUX/scripts/Views/CASlideInFormView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/ActivityForm","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy",],function(p,c,k,n,l,g,d,u,b,o,a,f,j,r,s,m,t,q,v,i,h){var e={modelsToRemove:[],selectedOperationItems:[],itemsToSort:{},sortingFirstTime:true,caTagNavigatorProxy:null,_tempReferenceToWinSearchCallback:null,_createView_TestProposed:function(w,x,z,y){return p.extend({name:"changeView",tagName:w,className:x,currModel:null,model:y,ChangeView:null,proposedModel:null,setup:function(){this.template='<div class="'+this.getClassNames("-container")+'">                                            <div class="'+this.getClassNames("-header-container")+'"></div>                                            <div class="'+this.getClassNames("-searchfilter-container")+'"></div>                                            <div class="'+this.getClassNames("-opdetails-container")+'"></div>                                          </div>';var C=this;widget.addEvent("onResize",function(){if(c.multiSelView){var E={};E.isActive=true;E.selectedObjects=[];c.multiSelView.buildMultisel(E);E.selectedObjects=e.modelsToRemove;c.multiSelView.buildMultisel(E)}});if(this.model){var B=this.model.get("proposed");var A=e.caTagNavigatorProxy=this.caTagNavigatorProxy=new h();var D="Proposed";A._initTaggerProxy(D).then(function(F){var E="Proposed";A._setSubjectTags(B,E);g.setTaggerObject(E,A)},function(E){console.log("Tagger initilization failed")})}},initSubViews:function(){var C=this.model.get("proposed");e.proposedModel=e.currModel.get("proposed");if(!UWA.is(e.originalProposedCollection)){e.originalProposedCollection=e.proposedModel}var B=this;var A=this._externalEvents={onProposedTaggerProxyFilterChange:function(E){var F=e.originalProposedCollection.slice(0,C.length);if(e.filteredbyTaggerCollection&&e.filteredbyTaggerCollection.length){e.filteredbyTaggerCollection.reset()}var D=new UWA.Class.Collection(F);e.filterProposedCollection(E,D,B.model)}};this.listenTo(e.caTagNavigatorProxy,A);this._initHeaderView(e.proposedModel);this._initSearchFilterView(e.proposedModel);this._initOperationView(e.proposedModel)},render:function(){j.doWait(widget.body);e.currModel=this.model;e.ChangeView=this;g.CurrModel=this.model;var D=this.model.get("proposed");var E=this;this.listenTo(e.currModel,"onChange:proposed",this.render);e.originalProposedCollection=D;this.containerReference=this.container;this.initSubViews();this.renderer=this.getTemplate(this.template);var C=this.name;var B=null;if(UWA.is(this.containerReference)){B=this.containerReference.getElement(".main-proposed-change-container");if(UWA.is(B)){B.empty();B.destroy();B=null}}if(!UWA.is(B)){B=this.mainContainerDiv=UWA.createElement("div",{"class":"main-proposed-change-container",styles:{width:"99.9%",height:"100%",}});B.setAttribute("data-rec-id","main-proposed-change-container-CA")}var A=this.renderer();B.addContent(A);B.inject(this.containerReference);this.injectSubView(this.proposedHeaderView,"."+C+"-header-container");this.injectSubView(this.searchFilterView,"."+C+"-searchfilter-container");this.injectSubView(this.operationView,"."+C+"-opdetails-container");var F=enoviaServerCAWidget.isNative?1000:0;setTimeout(function(){var G="Proposed";if(e.caTagNavigatorProxy){e.caTagNavigatorProxy._setSubjectTags(D,G)}},F);var E=this;j.endWait(widget.body);setTimeout(function(){var G=document.querySelector(".main-proposed-change-container");if(G){e.makeDroppable(G)}},1000)},injectSubView:function(C,A){var B=this.containerReference.getElement(A);if(C&&B){B.grab(C.render().getContent())}},getTemplate:function(B){var A=f.compile(B);this.data={changes:e.proposedModel};var C=this;return function(){return A()}},_initHeaderView:function(B){var C=this.proposedHeaderView=new (c._createView_TestHeader("div","operations-header",false,e.proposedModel));var D=this;var A=this._actionsEvents={removeMultiSel:function(E){e.removeSelectedProposed(E)},exploreInContext:function(G){var E=[];var F=[];if(UWA.is(G)&&UWA.is(G.selectedObjs)){G.selectedObjs.forEach(function(I,H){if(UWA.is(I.get("objectId"))){E.push(I.get("objectId").replace("pid:",""))}});if(E.length>0&&UWA.is(e.modelsToRemove)&&E.length!=e.modelsToRemove.length){g.warn(b.ECM_CA_Warn_Multisel_ExpInCtx)}g.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",E)}},massUpdateMultiSel:function(F){var E=[];F.forEach(function(G){if(G.get("operationActual")=="Create"||G.get("operationActual")=="Flowdown"){g.warn(b.ECM_CA_Proposed_Operation_Create_Massupdate_Forbid)}else{if(!G.get("Access")){g.warn(b.ECM_CA_Proposed_Operation_NoAccess_Massupdate_Forbid)}else{if(G.id){E.push(G.id)}else{if(G.get("id")){E.push(G.get("id"))}}}}});if(E.length>0){e.massUpdateMultiSelectedOperations(E)}},changematurityMultiSel:function(E){g.changeMaturity(E,this.model,this.massPromoteProposedCallBack)},emptySelectedModels:function(){e.emptySelectedModels()},onActionClick:function(E,I,F,G){var H=F.model.get("id");switch(H){case"sort":e.sortProposed();break;case"search":e.searchProposed(D);break;case"add":e.addProposed();break;case"selectAll":e.selectAll();break;case"unSelectAll":e.unselectAll();break;default:console.log(H+" is not permitted.");break}},};this.listenTo(C,A);return C},_initSearchFilterView:function(){var A=this.searchFilterView=new k({fromIDCard:false,collection:e.proposedModel,placeholder:b.ECM_CA_Searchby_NameTitle});var B=this;var C=this._operationsEvents={keyup:function(D){e.refineProposed(D,this.model)}};this.listenTo(A,C)},_initOperationView:function(){var A={id:this.model.get("id"),caName:(enoviaServerCAWidget.NamePref==="Name")?this.model.get("name"):this.model.get("synopsis"),};var D=this.operationView=e.createOperationView(A);var C=this;var B=this._operationsEvents={onCheckboxClick:function(E){e.operationSelected(E)},onItemViewDrag:function(){console.log("in drag of New Proposed");var K={};var F={};if(e.modelsToRemove.length){for(var E in e.modelsToRemove){var I=e.modelsToRemove[E];var L=null;if(I){K[I.get("id")]=I}}}else{K[arguments[1].get("id")]=arguments[1]}arguments[1]=K;var J=C.model.get("context");var H=[];J.forEach(function(N){var M=N.get("id");if(M){H.push(M.substr(4))}});var G={caId:C.model.get("id"),caContextIds:H,typeOfDrag:"Proposed",};g.onItemViewDragForContents(arguments,G)},deleteActivity:function(F,E){var G=[F];e.removeSelectedActivities(G,E)},editActivity:function(I,H){var G={};G.model=new v({id:I.id,what:{operation:I.activityActual,"target state":I.activityTargetState},why:{comment:{text:I.activityDesc}},objectId:I.objectId},{parse:true});G.model.set("operationIdx",H.operationIdx);G.callback=e.editActivityCallback;var F=new q(G);var E=new m();E.buildSlideIn(F);E.showSlideIn()},removeMultiSelActvities:function(F,E){e.removeSelectedActivities(F,E)},editProposed:function(E,G,F){e.editSelectedProposed(G)},deleteProposed:function(E,G,F){e.removeSelectedProposed(G)},onActionClickActivities:function(E,J){switch(J.idOfAction){case"add":if(!E.get("Access")){g.warn(b.ECM_CA_Proposed_Operation_NoAccess_AddActivity_Forbid)}else{var G=new v();G.set("operationId",E.get("id"));G.set("operationIdx",J.operationIdx);G.set("objectId",E.get("objectId"));var I={};I.model=G;I.callback=e.addActivityCallback;var H=new q(I);var F=new m();F.buildSlideIn(H);F.showSlideIn()}break;case"selectAll":i.selectAll();break;case"unSelectAll":i.unselectAll();break}}};this.listenTo(D,B);return D},domEvents:{},destroy:function(){e.modelsToRemove.splice(0,e.modelsToRemove.length);e.selectedOperationItems.splice(0,e.selectedOperationItems.length)}})},createOperationView:function(w){var x=null;if(e.proposedModel.length===0){x=new l({icon:"drag-drop",title:b.ECM_CA_Drop_EmptyView})}else{x=new (n._createView_TestProposed("div","operations-details",false,e.proposedModel,w))}return x},getSortedItems:function(B){var x=[];var z=Object.keys(e.itemsToSort);for(var w=0;w<z.length;w++){var A=e.itemsToSort[z[w]];for(var y=0;y<B.length;y++){if(B[y].id===A){x.push(B[y]);break}}}return x},operationSelected:function(B){var A=e.selectedOperationItems.indexOf(B.cid);if(A===-1){e.selectedOperationItems.push(B.cid);e.modelsToRemove.push(B);n.activateMultisel();e.caTagNavigatorProxy.deactivateTaggerProxy()}else{e.selectedOperationItems.splice(A,1);e.modelsToRemove.splice(A,1);if(e.modelsToRemove.length===0){n.deactivateMultisel();e.caTagNavigatorProxy.activateTaggerProxy()}}if(c.multiSelView){var y={};y.isActive=true;y.selectedObjects=e.modelsToRemove;var w=[];if(enoviaServerCAWidget.isNative&&UWA.is(y.selectedObjects)){for(var x=0;x<y.selectedObjects.length;x++){if(UWA.is(y.selectedObjects[x])&&UWA.is(y.selectedObjects[x].get("objectId"))){var z;z=y.selectedObjects[x].get("objectId");w.push(z.replace("pid:",""))}}e.operationsToExplore=this.modelsToRemove;g.DispatchEventToWin("MultiSel_ExpInCtx_ProposedOperation_CmdChk",w)}else{c.multiSelView.buildMultisel(y)}}},editActivityCallback:function(B){var A=n.getJSONForModifyProposed();var w="";if(B.get("activityActual")=="Modify"){w={id:B.get("id"),what:{operation:"Modify"},why:{comment:{text:B.get("reasonForChange")}}}}else{if(B.get("activityActual")=="Release"){w={id:B.get("id"),what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:B.get("reasonForChange")}}}}else{if(B.get("activityActual")=="Obsolete"){w={id:B.get("id"),what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:B.get("reasonForChange")}}}}}}var z=function(D){var C=g.createProposedCollection(D.changeaction.proposed,e.currModel);e.originalProposedCollection=C;g.enrichCollection(C,"objectId").then(function(F){if(!enoviaServerCAWidget.isNative){var E="Proposed";e.caTagNavigatorProxy._setSubjectTags(C,E)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",C);n.changeAccordIconAndExpandTile(B.get("operationIdx"));j.endWait(widget.body)})};A.changeaction.modify.proposed.push(w);var y=e.currModel.get("id");var x="";if(y!=undefined){x="/resources/modeler/change/changeaction/"+y+"?proposed=1"}if(x!=""){g.makeWSCall(x,"PUT","enovia","application/json",JSON.stringify(A),z,null)}},addActivityCallback:function(x){var C=[];C.push(x.get("operationId"));var w="";if(x.get("activityActual")=="Modify"){w={what:{operation:"Modify"},why:{comment:{text:x.get("reasonForChange")}}}}else{if(x.get("activityActual")=="Release"){w={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:x.get("reasonForChange")}}}}else{if(x.get("activityActual")=="Obsolete"){w={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:x.get("reasonForChange")}}}}}}var B=function(E){var D=g.createProposedCollection(E.changeaction.proposed,e.currModel);e.originalProposedCollection=D;g.enrichCollection(D,"objectId").then(function(G){if(!enoviaServerCAWidget.isNative){var F="Proposed";e.caTagNavigatorProxy._setSubjectTags(D,F)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",D);n.changeAccordIconAndExpandTile(x.get("operationIdx"));j.endWait(widget.body)})};var A=e.getJSONForAddActivity(C,w);var z=e.currModel.get("id");var y="";if(z!=undefined){y="/resources/modeler/change/changeaction/"+z+"?proposed=1"}if(y!=""){g.makeWSCall(y,"PUT","enovia","application/json",JSON.stringify(A),B,null)}},removeSelectedActivities:function(C,y){j.doWait(widget.body);var z=function(G){var D=[];var F=Object.keys(e.itemsToSort);if(F.length){D=e.getSortedItems(G.changeaction.proposed)}D=(D.length)?D:G.changeaction.proposed;var E=g.createProposedCollection(D,e.currModel);e.originalProposedCollection=E;g.enrichCollection(E,"objectId").then(function(I){if(!enoviaServerCAWidget.isNative){var H="Proposed";e.caTagNavigatorProxy._setSubjectTags(E,H)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",E);n.changeAccordIconAndExpandTile(y.operationIdx);j.endWait(widget.body)})};var B=[];C.forEach(function(D){if(D.id){B.push(D.id)}else{if(D.get("id")){B.push(D.get("id"))}}});var w=e.getJSONForDeleteOperation(B);var A=e.currModel.get("id");var x="/resources/modeler/change/changeaction/"+A+"?proposed=1";g.makeWSCall(x,"PUT","enovia","application/json",JSON.stringify(w),z,null)},editSelectedProposed:function(z){var y={};y.model=z[0];y.callback=e.editProposedCallback;var x=new t(y);var w=new m();w.buildSlideIn(x);w.showSlideIn()},editProposedCallback:function(C){j.doWait(widget.body);var A=function(G){var D=[];var F=Object.keys(e.itemsToSort);if(F.length){D=e.getSortedItems(G.changeaction.proposed)}D=(D.length)?D:G.changeaction.proposed;var E=g.createProposedCollection(D,e.currModel);e.originalProposedCollection=E;g.enrichCollection(E,"objectId").then(function(I){if(!enoviaServerCAWidget.isNative){var H="Proposed";e.caTagNavigatorProxy._setSubjectTags(E,H)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",E);j.endWait(widget.body)})};var z=e.currModel.get("id");var y="";if(z){y="/resources/modeler/change/changeaction/"+z+"?proposed=1"}var x={};if(C.get("isCreateOperation")){x.pid=C.id;x.operation="Create";x.objectType=C.get("createObjectType");x.objectName=C.get("createObjectTitle");x.operationWHY=C.get("reasonForChange")}else{var w=[];w.push(C.id);x.proposedIDArr=w;x.operation=C.get("operationActual");x.evolutionName=C.get("evolutionName");x.operationWHY=C.get("reasonForChange")}var B=n.getJSONForModifyOperation(x);if(y!=""){g.makeWSCall(y,"PUT","enovia","application/json",JSON.stringify(B),A,null)}},removeSelectedProposed:function(B){j.doWait(widget.body);var y=function(G){var D=[];var F=Object.keys(e.itemsToSort);if(F.length){D=e.getSortedItems(G.changeaction.proposed)}D=(D.length)?D:G.changeaction.proposed;var E=g.createProposedCollection(D,e.currModel);e.originalProposedCollection=E;g.enrichCollection(E,"objectId").then(function(J){if(!enoviaServerCAWidget.isNative){var I="Proposed";e.caTagNavigatorProxy.activateTaggerProxy();e.caTagNavigatorProxy._setSubjectTags(E,I)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",E);j.endWait(widget.body)});for(var C=0;C<B.length;C++){var H=e.modelsToRemove.indexOf(B[C]);if(H>=0){e.modelsToRemove.splice(H,1);C--}}};var A=[];B.forEach(function(C){A.push(C.get("id"))});var w=e.getJSONForDeleteOperation(A);var z=e.currModel.get("id");var x="/resources/modeler/change/changeaction/"+z+"?proposed=1";g.makeWSCall(x,"PUT","enovia","application/json",JSON.stringify(w),y,null)},getJSONForAddOperation:function(z){var y=e.getJSONForAddProposed();var x=z.operation;var D=z.operationWHY;if(x=="Create"){var C={operation:{name:x,type:z.objectType,"display name":z.objectName},why:{comment:{text:D}},activities:[]};y.changeaction.add.proposed.push(C)}else{var B=z.proposedIDArr;for(var A=0;A<B.length;A++){var w=B[A];var C={where:{id:w},operation:{name:x},why:{comment:{text:D}},activities:[]};if(x=="NewEvolution"){C.operation["evolution name"]=z.evolutionName}y.changeaction.add.proposed.push(C)}}return y},getJSONForAddProposed:function(){var w=e.getCABaseJSONForOperations();w.changeaction.add={proposed:[]};return w},getJSONForDeleteOperation:function(x){var w=e.getJSONForDeleteProposed();w.changeaction["delete"].proposed=x;return w},getJSONForDeleteProposed:function(){var w=e.getCABaseJSONForOperations();w.changeaction["delete"]={proposed:[]};return w},getCABaseJSONForOperations:function(){var x={version:"v0",changeaction:{cestamp:"0000",add:{},"delete":{},modify:{}}};var w=JSON.parse(JSON.stringify(x));return w},sortProposed:function(){var y=new UWA.Class.Collection();var I=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc");var B=true;if(I.length!=0){B=false}else{I=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc")}var G=[];var H=[];var C={};function x(J,L,K){var N="";if(enoviaServerCAWidget.NamePref=="Title"){N=J.get("objectTitle")}else{N=J.get("objectName")}var M=N.toLowerCase();C[M]=N;H.push(M);H.sort();if(K.length-1===L){H.forEach(function(Q){var O=C[Q];var P=null;if(enoviaServerCAWidget.NamePref=="Title"){P=e.proposedModel.findWhere({objectTitle:O})}else{P=e.proposedModel.findWhere({objectName:O})}if(P){G.push(P)}})}}if(e.proposedModel.length>0){var F=[];e.proposedModel.sortBy(x);F=G;if(!B&&e.sortingFirstTime!=true){F.reverse()}var y=new UWA.Class.Collection(F);e.proposedModel=y;var E=e.ChangeView;var z=E.containerReference.getElement(".changeView-opdetails-container");z.empty();if(E.operationView){E.operationView.destroy()}var D=E.operationView=E._initOperationView(y);if(D&&z){z.grab(D.render().getContent())}var w=E.containerReference.getElement(".changeView-header-container");w.empty();var A=E.proposedHeaderView=E._initHeaderView(y);if(A&&w){w.grab(A.render().getContent())}e.modelsToRemove.splice(0,e.modelsToRemove.length);e.selectedOperationItems.splice(0,e.selectedOperationItems.length);if(e.caTagNavigatorProxy){e.caTagNavigatorProxy.activateTaggerProxy()}if(e.sortingFirstTime===false){e.changeSortIcon(I,B)}e.sortingFirstTime=false}},changeSortIcon:function(w,x){if(w.length>0){if(x){w[0].className="fonticon fonticon-sort-alpha-asc"}else{w[0].className="fonticon fonticon-sort-alpha-desc"}}},searchProposed:function(A){document.getElementsByClassName("search-main-container");var B=A.containerReference.getElement(".search-main-container");if(B&&B.hasClassName("hidden")){B.removeClassName("hidden");var x=B.getElement(".searchfilter-input-container");x.addClassName("highlighted-border");x.removeClassName("border-without-focus");var z=B.getElement("input");z.focus()}else{B.addClassName("hidden")}var y=B.hasClassName("hidden");var w=A.containerReference.getElement(".operations-main-container");if(!y){w.setStyle("height","calc(100% - 100px)")}else{w.setStyle("height","calc(100% - 50px)")}},selectAll:function(){n.activateMultisel();if(!n&&!n.container){return}var y=n.container.container;if(y){var z=y.getElements(".checkbox-accord");for(var x=0;x<z.length;x++){var w=z[x];if(!w.checked){w.click()}}}},unselectAll:function(){if(c.multiSelView){c.multiSelView.exitMultisel();c.multiSelView.dispatchEvent("onMultiselOff",[c.multiSelView,false])}},addProposed:function(){var z=new s();var y={};y.model=z;y.callback=this.addProposedbySearch;var x=new t(y);var w=new m();w.buildSlideIn(x);w.showSlideIn()},addProposedbySearch:function(x){j.doWait(widget.body);var z=[];var D=function(I){var J=I.changeaction.proposed;var H=[];var G=0;for(var E=0;E<J.length;E++){if(z.indexOf(J[E].where.id)!=-1){H.push(J[E]);e.itemsToSort[G++]=J[E].id}}for(var E=0;E<J.length;E++){if(z.indexOf(J[E].where.id)==-1){H.push(J[E]);e.itemsToSort[G++]=J[E].id}}var F=g.createProposedCollection(H,e.currModel);g.enrichCollection(F,"objectId").then(function(L){if(!enoviaServerCAWidget.isNative){var K="Proposed";e.caTagNavigatorProxy._setSubjectTags(F,K)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",F);e.originalProposedCollection=F;j.endWait(widget.body)})};var C=e.currModel.get("id");var B="";var A={};if(C){B="/resources/modeler/change/changeaction/"+C+"?proposed=1"}if(x.get("isCreateOperation")){A.operation="Create";A.objectType=x.get("createObjectType");A.objectName=x.get("createObjectTitle");A.operationWHY=x.get("reasonForChange")}else{z.push("pid:"+x.get("proposedObject").objectID);A.proposedIDArr=z;A.operation=x.get("operationActual");A.operationWHY=x.get("reasonForChange");A.evolutionName=x.get("evolutionName")}var y=e.getJSONForAddOperation(A);if(UWA.is(x.get("activityActual"))&&x.get("activityActual")!="NoSelection"){var w="";if(x.get("activityActual")=="Modify"){w={what:{operation:"Modify"},why:{comment:{text:x.get("reasonForChangeForActivity")}}}}else{if(x.get("activityActual")=="Release"){w={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:x.get("reasonForChangeForActivity")}}}}else{if(x.get("activityActual")=="Obsolete"){w={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:x.get("reasonForChangeForActivity")}}}}}}y.changeaction.add.proposed[0].activities.push(w)}if(B!=""){g.makeWSCall(B,"PUT","enovia","application/json",JSON.stringify(y),D,null)}},refineProposed:function(w,y){var x=w.target.value;e.enteredText=x;e.filterProposed(y)},filterProposed:function(D){var x=[];e.bComingFromSearchFilter=true;if((e.filteredbyTaggerCollection)&&(e.filteredbyTaggerCollection.length)){x=e.filteredbyTaggerCollection.filter(e.filterNameBased)}else{x=e.originalProposedCollection.filter(e.filterNameBased)}var A=e.ChangeView;var y=new UWA.Class.Collection(x);e.proposedCollection=e.proposedModel=y;var w=A.containerReference.getElement(".changeView-opdetails-container");w.empty();var C=A.operationView=A._initOperationView(y);if(C&&w){w.grab(C.render().getContent())}var z=A.containerReference.getElement(".changeView-header-container");z.empty();var B=A.proposedHeaderView=A._initHeaderView(y);if(B&&z){z.grab(B.render().getContent())}e.modelsToRemove.splice(0,e.modelsToRemove.length);e.selectedOperationItems.splice(0,e.selectedOperationItems.length);if(e.caTagNavigatorProxy){e.caTagNavigatorProxy.activateTaggerProxy()}},filterNameBased:function(w){var z=false;var B=w.get("objectName");var y=w.get("objectTitle");var A=e.enteredText;if(A&&A.length){if(B){B=B.toLowerCase()}if(y){y=y.toLowerCase()}A=A.toLowerCase();var x=B?B.indexOf(A):-1;if(x<0){x=B?y.indexOf(A):-1}z=(x>=0)?true:false}if((A===undefined)||(A.length===0)){z=true}if(z==true){return w}},makeDroppable:function(w){d.droppable(w,{drop:function(A,z,x){if(x.stopPropagation){x.stopPropagation()}if(x.preventDefault){x.preventDefault()}if(x.dataTransfer&&x.dataTransfer.dropEffect){x.dataTransfer.dropEffect="copy"}if(UWA.is(A)&&A!=""){var B=JSON.parse(A);var y=g.checkTenantInforamation(B);if(y.TenantInfoMissing.length!=0){g.error(b.ECM_CA_Pref_PlatformMissing_Error)}else{if(y.DiffTenantData.length!=0){g.error(b.ECM_CA_Pref_PlatformDoesNotMatch_Error)}else{B=g.removeDuplicatesToBeDroppedObjects(B);e.ExecuteDrop(B)}}}else{j.endWait(widget.body);g.error(b.ECM_CA_Drop_Not_Supported)}var C=document.querySelector(".main-proposed-change-container");C.setStyle("borderWidth","0px")},over:function(){var x=arguments[0];x.setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){var x=arguments[0];x.setStyle("borderWidth","0px")}})},ExecuteDrop:function(B){if(B){var w=B.data.items;if(UWA.is(w)&&UWA.is(w.length)&&w.length>0){var y=[];for(var A=0;A<w.length;A++){var z=[];var x="pid:"+w[A].objectId;y.push(x)}if(y.length!=0){e.addProposedbyDrop(y)}}}else{j.endWait(widget.body);g.error(b.ECM_CA_Drop_Not_Supported)}var C=document.querySelector(".main-proposed-change-container");C.setStyle("borderWidth","0px")},addProposedbyDrop:function(w){j.doWait(widget.body);g.getAllowedOperationActivity(w).then(function(B){var x=e.getJSONForAddProposed();var A=function(F){var G=F.changeaction.proposed;var E=[];for(var C=0;C<G.length;C++){if(w.indexOf(G[C].where.id)!=-1){E.push(G[C])}}for(var C=0;C<G.length;C++){if(w.indexOf(G[C].where.id)==-1){E.push(G[C])}}var D=g.createProposedCollection(E,e.currModel);g.enrichCollection(D,"objectId").then(function(I){if(!enoviaServerCAWidget.isNative){var H="Proposed";e.caTagNavigatorProxy._setSubjectTags(D,H)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",D);e.originalProposedCollection=D;j.endWait(widget.body)})};w.forEach(function(D){var G=B.allowedOperationActivity[D.replace("pid:","")].defaultOperation;var F=B.allowedOperationActivity[D.replace("pid:","")].defaultActivity;var E={where:{id:D},operation:{name:G},activities:[]};if(F){var C="";switch(F){case"Release":C={what:{operation:"ChangeStatus","target state":"Release"}};break;case"Obsolete":C={what:{operation:"ChangeStatus","target state":"Obsolete"}};break;case"Modify":default:C={what:{operation:"Modify"}}}E.activities.push(C)}x.changeaction.add.proposed.push(E)});var z=e.currModel.get("id");var y="";if(z){y="/resources/modeler/change/changeaction/"+z+"?proposed=1"}if(y!=""){g.makeWSCall(y,"PUT","enovia","application/json",JSON.stringify(x),A,null)}},function(x){console.log("Get allowed operation/activity failed");return Promise.reject(x)})},getJSONForAddActivity:function(A,B){var z=e.getJSONForAddProposed();for(var y=0;y<A.length;y++){var w=A[y];var x={id:w,activities:[B]};z.changeaction.add.proposed.push(x)}return z},filterProposedCollection:function(C,H,G){var I=[];for(var J in C){var K=C[J];var A=H.toArray();var F=H.findWhere({id:K});var B=[];if(F){I.push(F)}}if(I&&I.length){var y=new UWA.Class.Collection(I);e.filteredbyTaggerCollection=e.proposedModel=y;if(e.ChangeView){var E=e.ChangeView;var x=E.containerReference.getElement(".changeView-opdetails-container");if(x){x.empty()}var D=E.operationView=E._initOperationView(y);if(D&&x){x.grab(D.render().getContent())}var w=E.containerReference.getElement(".changeView-header-container");if(w){w.empty()}e.selectedOperationItems.splice(0,e.selectedOperationItems.length);e.modelsToRemove.splice(0,e.modelsToRemove.length);var z=E.proposedHeaderView=E._initHeaderView(y);if(z&&w){w.grab(z.render().getContent())}}}},massUpdateMultiSelectedOperations:function(A){var z=new s();var y={};y.model=z;y.callback=this.massUpdateProposedCallback;y.selectedOperation=A;var x=new t(y);var w=new m();w.buildSlideIn(x);w.showSlideIn()},emptySelectedModels:function(){e.modelsToRemove.splice(0,e.modelsToRemove.length);e.selectedOperationItems.splice(0,e.selectedOperationItems.length)},massUpdateProposedCallback:function(C,B){j.doWait(widget.body);e.emptySelectedModels();var z=function(G){var D=[];var F=Object.keys(e.itemsToSort);if(F.length){D=e.getSortedItems(G.changeaction.proposed)}D=(D.length)?D:G.changeaction.proposed;var E=g.createProposedCollection(D,e.currModel);e.originalProposedCollection=E;g.enrichCollection(E,"objectId").then(function(I){if(!enoviaServerCAWidget.isNative){var H="Proposed";e.caTagNavigatorProxy.activateTaggerProxy();e.caTagNavigatorProxy._setSubjectTags(E,H)}e.currModel.set("proposed",new UWA.Class.Collection(),{silent:true});e.currModel.set("proposed",E);j.endWait(widget.body)})};var y=e.currModel.get("id");var x="";if(y){x="/resources/modeler/change/changeaction/"+y+"?proposed=1"}var w={};w.proposedIDArr=B;w.operation=C.get("operationActual");w.operationWHY=C.get("reasonForChange");w.evolutionName=C.get("evolutionName");var A=n.getJSONForModifyOperation(w);if(x!=""){g.makeWSCall(x,"PUT","enovia","application/json",JSON.stringify(A),z,null)}},calledFromNativeInterop:function(w){var x={};x.isActive=true;x.selectedObjects={selectedObjs:e.operationsToExplore,result:w,length:e.operationsToExplore.length};c.multiSelView.buildMultisel(x)},OnSearchComplete:function(w){var y=w.replace(",","");var x=[];x.push(y);e._tempReferenceToWinSearchCallback(x)},massPromoteProposedCallBack:function(){console.log("massPromoteProposedCallBack")}};return e});define("DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENOChangeActionUX/scripts/CAUtility","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,e,b,d,c,a){var g=b.extend({model:d,setup:function(){},fetch:function(h){var i=null;i=h.data=this.operations=h.RealizedArr;h.ajax=function(k,j){j.onComplete(i)};this.url="dummyURL";return this._parent(h)},});return g});define("DS/ENOChangeActionUX/scripts/Models/CAModel",["UWA/Class/Model","DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/Models/CAReferentialModel","DS/ENOChangeActionUX/scripts/Models/CAMemberModel","DS/ENOChangeActionUX/scripts/Models/CAContextModel","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Date","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChangeActionUX/assets/ChangeActionMapping.json"],function(c,d,n,b,g,l,e,a,k,j,i,m,f){var h=c.extend({idAttribute:"id",setup:function(){var p=JSON.parse(f);var o=p.Show_Accept_Task;if(o&&o==="true"){this.set("showAcceptTask",true)}else{this.set("showAcceptTask",false)}this.addEvent("onChange:severity",function(r){var q=JSON.parse(f);var s=q[r.get("severity")];if(UWA.is(s)&&s!=""){s="images/"+s}else{s=q._default;s="images/"+s}r.set("image",d.getWebappsAssetUrl(enoviaServerCAWidget.frameWorkName,s));r.set("severityDisplay",m.get("ECM_CA_Severity_"+r.get("severity")))});this.addEvent("onChange:current",function(r){this.refreshCAHeader(r);var q=r.get("current");require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(u){if(enoviaServerCAWidget.isNative){var v=["Approved","Complete","Prepare","Cancelled","In Approval"];if(q!=""&&v.indexOf(q)>0){var s="Work_Under";var t="FALSE";u.DispatchEventToWin(s,t)}}})});this.addEvent("onChange:holdValue",function(q){this.refreshCAHeader(q)});this.addEvent("onChange:owner",function(q){if(UWA.is(q.get("changeOrderId"))&&q.get("changeOrderId")!=""){q.set("ownerName",m.ECM_CA_TitleSection_OwnedBy+" "+q.get("ownerDisplayName")+" "+m.ECM_CA_TitleSection_in+" "+q.get("project_space")+" "+m.ECM_CA_TitleSection_of+" "+q.get("organization")+" "+m.ECM_CA_TitleSection_ForGoverning+" "+q.get("changeOrderName"))}else{q.set("ownerName",m.ECM_CA_TitleSection_OwnedBy+" "+q.get("ownerDisplayName")+" "+m.ECM_CA_TitleSection_in+" "+q.get("project_space")+" "+m.ECM_CA_TitleSection_of+" "+q.get("organization"))}this.refreshCAHeader(q)});this.addEvent("onChange:changeOrderName",function(q){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(r){q.set("ownerName",m.ECM_CA_TitleSection_OwnedBy+" "+q.get("ownerDisplayName")+" "+m.ECM_CA_TitleSection_in+" "+q.get("project_space")+" "+m.ECM_CA_TitleSection_of+" "+q.get("organization")+" "+m.ECM_CA_TitleSection_ForGoverning+" "+q.get("changeOrderName"));r.createLifecycleSpanContent(q)})})},refreshCAHeader:function(o){require(["DS/ENOChangeActionUX/scripts/CAUtility","UWA/Class/Promise"],function(u,s){var t=[];var v=u.getUserAccess(o.get("id"));var r=u.getDependUserAccess(o.get("id"));var p=u.getLifecycleInfo(o.get("id"));var q=u.getCompletedTaskDetails(o.get("id"));t.push(v,r,p,q);s.all(t).then(function(w){w.forEach(function(z){if((z)&&UWA.is(z.userAccess)){o.set("userAccess",z.userAccess)}else{if((z)&&UWA.is(z.dependUserAccess)){o.set("dependUserAccess",z.dependUserAccess)}else{if((z)&&UWA.is(z.lifecycleInfo)){if(z.lifecycleInfo.allStates.length>0){o.set("allStates",z.lifecycleInfo.allStates);o.set("stateNameNLS",z.lifecycleInfo.stateNameNLS);o.set("current",z.lifecycleInfo.current);o.set("currentDisplay",m.get("ECM_CA_State_"+o.get("current")))}else{var y=[];y.push(o.get("current"));o.set("allStates",y);var C={};C[o.get("current")]=o.get("current");o.set("stateNameNLS",C);o.set("currentDisplay",m.get("ECM_CA_State_"+o.get("current")))}}else{if((z)&&UWA.is(z.completedTaskDetail)){var D=z.completedTaskDetail.route;var B=(UWA.is(D)&&UWA.is(D.routeStatus))?D.routeStatus:"";var x=z.completedTaskDetail.inboxTasks;o.set("approveOrRejectIcon",false);for(var A=0;A<x.length;A++){if(UWA.is(x[A].owner)&&x[A].owner!=""&&enoviaServerCAWidget.contextUser==x[A].owner&&x[A].approvalStatus=="None"&&o.get("current")=="In Approval"&&B=="Started"){o.set("approveOrRejectIcon",true);o.set("inboxTaskId",x[A].id);o.set(x[A].owner+"_comments","");o.set(x[A].owner+"_approvalStatus","")}else{if(UWA.is(x[A].owner)&&x[A].owner!=""&&x[A].approvalStatus!="None"){o.unset(x[A].owner+"_approvalStatus");o.set(x[A].owner+"_approvalStatus",x[A].approvalStatus);if(UWA.is(x[A].comments)&&x[A].comments!=""){o.unset(x[A].owner+"_comments");o.set(x[A].owner+"_comments",x[A].comments)}else{(o.set(x[A].owner+"_comments",""))}}else{o.set(x[A].owner+"_comments","");o.set(x[A].owner+"_approvalStatus","")}}}}}}}});u.createLifecycleSpanContent(o);u.refreshApplicabilityView(o.get("id"))},function(w){console.log("failed");return s.reject(w)})})},fetch:function(p){var q=this;p.method="GET";var o="";p.ajax=function(s,r){require(["DS/ENOChangeActionUX/scripts/CAUtility","UWA/Class/Promise"],function(w,u){var v=[];var t=w.getCADetails(q.id);v.push(t);u.all(v).then(function(y){var x=[];y.forEach(function(A){if(A&&A.changeaction){var z=A.changeaction.people;if(z.length){z.forEach(function(B){x.push(B.name)})}if(x.length){w.getUserDisplayNameByPromise(x).then(function(B){w._addFullNameToPersonObject(A,B);w.getCADependencies(q.id).then(function(D){if(D&&D.elements){w.CurrModel=q;var C=w.buildDependencyModel(D.elements,D.originid);q.set("dependencyObjects",C);w.updateExcludeList(q,"Depend");r.onComplete(A)}},function(C){return u.reject(C)})},function(B){return u.reject(B)})}}})},function(x){console.log("failed");return u.reject(x)})})};p.url="dummyURL";return this._parent(p)},parse:function(r){var u=this;var y="%Y-%m-%d";var w={};if(!UWA.is(r)){k.endWait(widget.body);return}else{if(UWA.is(r.changeaction)){u.set("id",r.changeaction.id);var z=r.changeaction.attributes;if(UWA.is(z)){z.forEach(function(C){if(C.name==="attribute_ActualCompletionDate"){u.set("actualDue",(UWA.is(C.value)&&C.value!=="")?j.strftime(new Date(C.value),y):"")}else{if(C.name==="attribute_ActualStartDate"){u.set("actualCreated",(UWA.is(C.value)&&C.value!=="")?j.strftime(new Date(C.value),y):"")}else{if(C.name==="attribute_BypassPlants"){u.set("bypassPlants",C.value)}else{if(C.name==="attribute_CategoryofChange"){u.set("categoryofChange",C.value)}else{if(C.name==="attribute_EstimatedCompletionDate"){u.set("due",(UWA.is(C.value)&&C.value!=="")?j.strftime(new Date(C.value),y):"");if(u.get("due")===""){u.set("due",m.ECM_CA_DUEDATE_UNASSIGNED)}}else{if(C.name==="attribute_EstimatedStartDate"){u.set("created",(UWA.is(C.value)&&C.value!=="")?j.strftime(new Date(C.value),y):"")}else{if(C.name==="attribute_Originator"){u.set("originator",C.value)}else{if(C.name==="attribute_ReasonForCancel"){u.set("reasonForCancel",C.value)}else{if(C.name==="attribute_ResponsibleManufacturingEngineer"){u.set("responsibleManufacturingEngineer",C.value)}else{if(C.name==="attribute_Severity"){u.set("severity","",{silent:true});u.set("severity",C.value)}else{if(C.name==="attribute_Synopsis"){u.set("synopsis",C.value);var D="";if(enoviaServerCAWidget.NamePref=="Name"){D=r.changeaction.name;if(enoviaServerCAWidget.flowdownOptions&&enoviaServerCAWidget.flowdownOptions.isFromFlowDown===true){D=D+" "+m.ECM_CA_Flowdown_From_Title+" "+enoviaServerCAWidget.flowdownOptions.originatingCAName}u.set("title",D);u.set("subtitle",C.value)}else{D=C.value;if(enoviaServerCAWidget.flowdownOptions&&enoviaServerCAWidget.flowdownOptions.isFromFlowDown===true){D=D+" "+m.ECM_CA_Flowdown_From_Title+" "+enoviaServerCAWidget.flowdownOptions.originatingCAName}u.set("title",D);u.set("subtitle",r.changeaction.name)}}else{if(C.name==="project"){enoviaServerCAWidget.project_space=C.value;u.set("project_space",C.value)}else{if(C.name==="current"){u.set("current","",{silent:true});u.set("current",C.value);u.set("currentDisplay",m.get("ECM_CA_State_"+u.get("current")))}else{if(C.name==="organization"){enoviaServerCAWidget.organization=C.value;u.set("organization",C.value)}else{if(C.name==="modified"){u.set("modified",(UWA.is(C.value)&&C.value!=="")?j.strftime(new Date(C.value),y):"")}else{if(C.name==="interface[Change On Hold]"){if(C.value=="TRUE"){u.set("holdStatus","true");u.set("holdValue",m.ECM_CA_State_On_Hold,{silent:true})}else{u.set("holdStatus",null);u.set("holdValue","",{silent:true})}u.get("holdStatus")?u.set("TableStateVal",m.ECM_CA_State_On_Hold):u.set("TableStateVal",m.get("ECM_CA_State_"+u.get("current")))}}}}}}}}}}}}}}}}})}if(UWA.is(r.changeaction.people)){u.set("owner",r.changeaction.people[0].name,{silent:true});u.set("ownerDisplayName",r.changeaction.people[0].fullName);u.set("ownerId",r.changeaction.people[0].id)}u.set("name",r.changeaction.name);if(r.changeaction.type==="type_ChangeAction"){u.set("type","Change Action")}u.set("lifecycleHTML","<span id ='lifecycleSpan'></span>");if(UWA.is(r.changeaction.changeorder)&&UWA.is(r.changeaction.changeorder.id)){u.set("changeOrderName",r.changeaction.changeorder.info["display name"]);u.set("changeOrderId",r.changeaction.changeorder.id);u.set("ownerName",m.ECM_CA_TitleSection_OwnedBy+" "+u.get("ownerDisplayName")+" "+m.ECM_CA_TitleSection_in+" "+u.get("project_space")+" "+m.ECM_CA_TitleSection_of+" "+u.get("organization")+" "+m.ECM_CA_TitleSection_ForGoverning+" "+u.get("changeOrderName"))}else{u.set("ownerName",m.ECM_CA_TitleSection_OwnedBy+" "+u.get("ownerDisplayName")+" "+m.ECM_CA_TitleSection_in+" "+u.get("project_space")+" "+m.ECM_CA_TitleSection_of+" "+u.get("organization"))}if(UWA.is(r.changeaction.referentials)){var q=r.changeaction.referentials;require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(D){var C=D.createReferentialCollection(q);D.enrichCollection(C).then(function(E){u.set("referentials",C);D.updateExcludeList(u,"referentials")})})}if(UWA.is(r.changeaction.context)){var p=r.changeaction.context;require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(D){var C=D.createContextCollection(p);D.enrichCollection(C).then(function(E){u.set("context",C);D.updateExcludeList(u,"context")})})}u.set("roleField",m.ECM_CA_Summary_Role);u.set("ownerField",m.ECM_CA_Summary_Owner);u.set("dueDateField",m.ECM_CA_Summary_DueDate);if(!UWA.is(u.get("contextUserRole"))){u.set("contextUserRole",m.ECM_CA_Team_Owner)}if(UWA.is(r.changeaction.people)){var u=this;var s=[];var v=[];var t=r.changeaction.people;t.forEach(function(E){if(E.role!="templateReviewer"){if(s.indexOf(E.id)>=0){var C=u.isInArray(E,v);var D=null;if(C>=0){D=v[C]}if(D){D.role+=", "+E.role}}else{s.push(E.id);E.type="Person";v.push(E)}}});if(UWA.is(r.changeaction.routeTemplates)){var o=r.changeaction.routeTemplates;o.forEach(function(C){if(!C){return}s.push(C.id);C.type="Route Template";C.role="reviewer";C.fullName=C.name;v.push(C)})}require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(D){var C=D.createMembersCollection(v);u.set("people",C);var E=C.findWhere({userName:enoviaServerCAWidget.contextUser});if(UWA.is(E)){u.set("contextUserRole",E.get("rolesToDisplay"))}else{u.set("contextUserRole","other")}})}if(UWA.is(r.changeaction.proposed)){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(D){var C=D.createProposedCollection(r.changeaction.proposed);D.enrichCollection(C,"objectId").then(function(E){u.set("proposed",C)})})}if(UWA.is(r.changeaction.realized)){var A=this.createRealizedCollection(r.changeaction.realized,u);require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(C){C.enrichCollection(A).then(function(D){u.set("realized",A)})})}require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(C){C.updateWidgetTitle(u)})}else{this.set("id",r.id);this.set("name",r.name);if(enoviaServerCAWidget.NamePref=="Name"){this.set("title",r.name)}else{this.set("title",r.attributes.Synopsis)}this.set("type",r.type);this.set("current",r.state);this.set("currentDisplay",m.get("ECM_CA_State_"+this.get("current")));this.set("synopsis",r.attributes.Synopsis);if(enoviaServerCAWidget.NamePref=="Name"){this.set("subtitle",r.attributes.Synopsis)}else{this.set("subtitle",r.name)}this.set("created",(UWA.is(r.attributes.EstimatedStartDate)&&r.attributes.EstimatedStartDate!=="")?j.strftime(new Date(r.attributes.EstimatedStartDate),y):"");this.set("due",(UWA.is(r.attributes.EstimatedCompletionDate)&&r.attributes.EstimatedCompletionDate!=="")?j.strftime(new Date(r.attributes.EstimatedCompletionDate),y):"");this.set("severity",r.attributes.Severity);this.set("severityDisplay",m.get("ECM_CA_Severity_"+this.get("severity")));this.set("owner",r.owner);this.set("ownerDisplayName",r.ownerDisplayName);this.set("contextUserRole",r.contextUserRole);if(enoviaServerCAWidget.newlyAssignCAIds!=null&&enoviaServerCAWidget.newlyAssignCAIds!=""&&enoviaServerCAWidget.newlyAssignCAIds.indexOf(r.id)!=-1){this.set("newlyAssign","yes");this.set("newlyAssignTitle",m.ECM_CA_Notification_Newly_Assigned_CA);this.set("isNewlyAssign",m.ECM_CA_isNewlyAssigned_Yes)}else{this.set("newlyAssign",null);this.set("isNewlyAssign",m.ECM_CA_isNewlyAssigned_No)}this.set("roleField",m.ECM_CA_Summary_Role);this.set("ownerField",m.ECM_CA_Summary_Owner);this.set("dueDateField",m.ECM_CA_Summary_DueDate);var x=JSON.parse(f);var B=x[this.get("severity")];if(UWA.is(B)&&B!=""){B="images/"+B}else{B=x._default;B="images/"+B}this.set("image",d.getWebappsAssetUrl(enoviaServerCAWidget.frameWorkName,B));this.set("holdStatus",(r["Change On Hold"]=="True")?"true":null);this.set("holdValue",(UWA.is(this.get("holdStatus"))&&this.get("holdStatus")=="true")?m.ECM_CA_State_On_Hold:"");this.get("holdStatus")?this.set("TableStateVal",m.ECM_CA_State_On_Hold):this.set("TableStateVal",m.get("ECM_CA_State_"+this.get("current")));if(this.get("due")===""){this.set("due",m.ECM_CA_DUEDATE_UNASSIGNED)}}}},isInArray:function(q,p){var o=-1;p.forEach(function(s,r){if(q.id===s.id){o=r}});return o},createRealizedCollection_space:function(q,o){var p=new UWA.Class.Collection();if(Array.isArray(q)){q.forEach(function(r){var s=p.get(r.where.id);if(s!=undefined){}else{var t=new l(r);var u={};t.fetch(u);p.add(t)}})}return p},createRealizedCollection_native:function(p){var o=new UWA.Class.Collection();if(Array.isArray(p)){p.forEach(function(q){var r=o.get(q.where.id);if(r!=undefined){}else{var s=new l(q);var t={};s.fetch(t);o.add(s)}})}return o},createRealizedCollection:function(p,o){if(enoviaServerCAWidget.is3DSpace){var s=this.createRealizedCollection_space(p,o);return s}else{var r={RealizedArr:p,};var q=new e();q.fetch(r);q.forEach(function(t){t.fetch(r)});return q}},});return h});define("DS/ENOChangeActionUX/scripts/Collection/CACollection",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Date","DS/ENOChangeActionUX/scripts/Models/CAModel","DS/ENOChangeActionUX/scripts/CAUtility","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOChangeActionUX/scripts/CASpinner","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,b,c,g,d,a,j,h,i){var e=c.extend({model:d,taggerProxy:{filteringMode:"WithFilteringServices",events:{}},_initTaggerProxy:function(m){var n=this,k,o,l,p;k=this.taggerProxy;p=this._taggerProxyEvents={onFilterChange:n.onFilterChange,onFilterSubjectsChange:n.onFilterChange,addUnfocusSubjectsListener:n.onUnfocusSubjects};if(widget){k=f.extend({widgetId:widget.id},k,true)}else{k=f.extend({contextId:"context1",filteringMode:"WithFilteringServices",},k,true)}l=this.taggerProxy=j.createProxy(k,p);this.taggerProxy.addFilterSubjectsListener(n.onFilterChange,n);return l},setup:function(){this._initTaggerProxy();var k=this;this.addEvent("onChange",function(){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(l){if(l.collectionToFilter!=null){l.updateClonedCollection(k)}})})},activateTaggerProxy:function(){var k=this.taggerProxy;if(!this.taggerProxy){return}k.activate()},deactivateTaggerProxy:function(){var k=this.taggerProxy;if(!this.taggerProxy){return}k.deactivate()},onFilterChange:function(k){console.log("In onFilterChange");require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(l){l.filterSummaryCollection(k)})},setSubjectTags:function(p){var u=this.taggerProxy;var r={};for(var t in p){var x=p[t].attributes;var l=p[t];var z={};for(var w in x){z[w]=x[w]}for(var w in l){z[w]=l[w]}var o=[];for(var w in z){var m={};if(w==="contextUserRole"){m.sixw="ds6w:who/"+i.ECM_CA_Summary_Table_Label_Role;m.type="xsd:string"}if(w==="Severity"){m.sixw="ds6w:what/"+i.ECM_CA_Severity;m.type="xsd:string"}else{if(w==="state"){m.sixw="ds6w:what/"+i.ECM_CA_Table_Header_Maturity;m.type="xsd:string"}else{if(w==="EstimatedCompletionDate"){m.sixw="ds6w:when/"+i.ECM_CA_Summary_Table_Label_DueDate;m.type="date"}}}if(m){if(Object.keys(m).length>0){if(w==="EstimatedCompletionDate"){var v=z[w];var q="";if(v!=""){var n=v.split(" ")[0];var k=n.split("/");if(k.length===3){q=k[2]+"/"+k[0]+"/"+k[1]}else{q=v}}else{q=i.ECM_CA_DUEDATE_UNASSIGNED}m.dispValue=q;m.object=q}else{m.dispValue=z[w];m.object=z[w]}if(w==="state"){if(z["Change On Hold"]==="True"||z["Change On Hold"]==="true"){m.dispValue=i.ECM_CA_State_On_Hold;m.object=i.ECM_CA_State_On_Hold}else{m.dispValue=i.get("ECM_CA_State_"+z[w]);m.object=i.get("ECM_CA_State_"+z[w])}}if(w==="Severity"){m.dispValue=i.get("ECM_CA_Severity_"+z[w]);m.object=i.get("ECM_CA_Severity_"+z[w])}if(w==="contextUserRole"){var s=z[w];var y=s.split(", ");y.forEach(function(A){var B={};B.sixw="ds6w:who/"+i.ECM_CA_Summary_Table_Label_Role;B.type="xsd:string";B.dispValue=A;B.object=A;o.push(B)})}if(w!="contextUserRole"){o.push(m)}}}}if(o.length){r[p[t].id]=o}}u.setSubjectsTags(r)},fetch:function(l){var m=this;l.method="GET";var k="";l.ajax=function(o,n){require(["DS/ENOChangeActionUX/scripts/CAUtility"],function(p){p.getCASummary().then(function(w){var x=[];var v={};var t=[];var s=w.details.owner;if(s!=null&&s!=undefined){s.forEach(function(y){y.contextUserRole=i.ECM_CA_Team_Owner;x.push(y.id);t.push(y.owner);v[y.id]=y})}var r=w.details.contributor;if(r!=null&&r!=undefined){r.forEach(function(y){if(x.indexOf(y.id)==-1){y.contextUserRole=i.ECM_CA_Summary_Contributor;x.push(y.id);t.push(y.owner);v[y.id]=y}else{v[y.id].contextUserRole+=", "+i.ECM_CA_Summary_Contributor}})}var q=w.details.reviewer;if(q!=null&&q!=undefined){q.forEach(function(y){if(x.indexOf(y.id)==-1){y.contextUserRole=i.ECM_CA_Summary_Reviewer;x.push(y.id);t.push(y.owner);v[y.id]=y}else{v[y.id].contextUserRole+=", "+i.ECM_CA_Summary_Reviewer}})}var u=w.details.follower;if(u!=null&&u!=undefined){u.forEach(function(y){if(x.indexOf(y.id)==-1){y.contextUserRole=i.ECM_CA_Summary_Follower;x.push(y.id);t.push(y.owner);v[y.id]=y}else{v[y.id].contextUserRole+=", "+i.ECM_CA_Summary_Follower}})}p.getUserDisplayNameByPromise(t).then(function(z){var y=[];x.forEach(function(A){if(v[A]){var B=v[A];var C=B.owner;if(z&&z.userDisplayName.userInfo&&z.userDisplayName.userInfo[C]){var D=z.userDisplayName.userInfo[C].userDisplayName;B.ownerDisplayName=D;B.ownerId=z.userDisplayName.userInfo[C].id}else{B.ownerDisplayName=B.owner}y.push(B)}});if(enoviaServerCAWidget.existingCAIds===null){enoviaServerCAWidget.existingCAIds=x;enoviaServerCAWidget.newlyAssignCAIds=""}else{if(enoviaServerCAWidget.existingCAIds==""){enoviaServerCAWidget.newlyAssignCAIds=enoviaServerCAWidget.existingCAIds=x}else{if(enoviaServerCAWidget.existingCAIds!=null&&enoviaServerCAWidget.existingCAIds!=null){enoviaServerCAWidget.newlyAssignCAIds=x.filter(function(A){return enoviaServerCAWidget.existingCAIds.indexOf(A)==-1});enoviaServerCAWidget.existingCAIds=x}}}y.sort(function(B,A){B=new Date(B.ModifiedDate);A=new Date(A.ModifiedDate);return B>A?-1:B<A?1:0});p.activateSummaryViewTagger();m.setSubjectTags(y);n.onComplete(y);h.endWait(widget.body)},function(y){return n.onFailure(y)})},function(q){console.log("failed");return n.onFailure(q)})})};l.url="dummyURL";return this._parent(l)}});return e});define("DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Core",],function(f,b,e,a,d){var c=f.extend({idAttribute:"id",setup:function(){},parse:function(h){this.set("canEdit",true);this.set("reasonForChangeForActivity",{displayValue:"Early Completion",actualValue:"early"});var i=h;this.set("canEdit",true);this.set("mode",h.mode);if(UWA.is(i.id)){var g={};this.set("id",i.id);i.set("objectId",i.id);g.objectType=i.get("objectType")?i.get("objectType"):"";g.objectName=(enoviaServerCAWidget.NamePref=="Name")?i.get("objectName"):i.get("objectTitle");g.objectRev=i.get("revision")?i.get("revision"):"";g.objectName=g.objectName+" "+g.objectRev;g.objectID=i.get("objectId")?i.get("objectId").replace("pid:",""):"";g.id="pid:"+g.objectID;g.maturity=i.get("maturity")?i.get("maturity"):"";g.policy=i.get("policy")?i.get("policy"):"";g.image={imageValue:i.get("icon")?i.get("icon"):""};this.set("objectName",g.objectName);this.set("changeaction",g)}},add:function(m,l,i){var g={id:"pid:"+l};var j=this;var h=l;var k=[h];e.getAdditionObjectInfo(k).then(function(o){g.objectType=o.additionObjectInfo[h].type;g.objectName=(enoviaServerCAWidget.NamePref=="Name")?o.additionObjectInfo[h].objectName:o.additionObjectInfo[h].objectTitle;g.objectRev=o.additionObjectInfo[h].revision;g.objectName=g.objectName+" "+g.objectRev;g.objectID=o.additionObjectInfo[h].pid;g.id="pid:"+g.objectID;g.policy=o.additionObjectInfo[h].policy;g.image={imageValue:o.additionObjectInfo[h].icon};var n=j.get(m);if(UWA.is(n,"object")){j.unset(m)}j.set(m,g)},function(n){console.log("Populate Security Context failed");return Promise.reject(n)})},remove:function(k,h,g){var i=this.get(k);var j=this.get("reasonForChangeForActivity");if(UWA.is(i,"object")){this.unset("reasonForChangeForActivity",{silent:true});this.unset(k)}this.set("reasonForChangeForActivity",j)},proposedTypeAheadCallback:function(l,k,n){var m="searchStr="+encodeURIComponent(k)+"*";var g;if(l&&l.searchTypes){g=encodeURIComponent(l.searchTypes)}else{g="*"}m+="&typeStr="+g;var i="/resources/v2/e6w/service/ObjectSearch?"+m;var j=null;var h=function(r){if(r.success&&r.data){var w=r.data.length;var q=[];for(var s=0;s<w;s++){var x=r.data[s];if(x.dataelements){var u=x.type;var o=x.dataelements.name||"";var p=x.dataelements.image||"";var v=x.dataelements.title||"";var t=x.dataelements.revision||"";q.push({value:x.id,label:(v||o)+" "+t,image:p})}}n(q)}};return e.makeWSCall(i,"GET","enovia","application/json",j,h,null)}});return c});define("DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm",["UWA/Controls/Abstract","DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel","DS/E6WCommonUI/Views/DetailsDisplayView","DS/UIKIT/Input/Button","DS/ENOChangeActionUX/scripts/CAUtility","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView"],function(d,j,g,e,a,h,f,k,c,i){var b=d.extend({displayViewModel:null,SaveTransRealCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,that:this,options:null,init:function(l){if(UWA.is(l)){this.SaveTransRealCallback=l.callback;this.displayViewModel=new j(l,{parse:true});this.detailsView=new g();this.options=l}},getHeading:function(){if(this.options.Mode==="Existing"){return h.ECM_CA_Realized_Transfer_Heading_ExistingCA}else{if(this.options.Mode==="New"){return h.ECM_CA_Realized_Transfer_NewCA}}},getBody:function(){var m=this;var l=UWA.createElement("div",{id:"formBody"});l.setAttribute("data-rec-id","formBodyCA");var o=UWA.Class.View.extend({setup:function(){if(m.options.Mode==="Existing"){this.listenTo(this.model,"onChange",this.render)}this.listenTo(this.model,"onChange:createObjectTitle",m.updateBtnState);this.listenTo(this.model,"onChange:descriptionOfObj",m.updateBtnState)},render:function(){l.setContent("");m.detailsView.setConfig(m.getConfig());m.detailsView.model=m.displayViewModel;m.detailsView.tenant=enoviaServerCAWidget.tenant;m.detailsView.context=enoviaServer.context;m.detailsView.render().inject(l);if(arguments&&arguments.length>0){m.updateBtnState(arguments[0])}}});var n=new o({model:m.displayViewModel}).render();return l},getFooter:function(){var n=this;var o=b.footer=UWA.Element("div",{});if(true){var l=new e({value:h.ECM_CA_Realized_Transfer_Save,className:"primary proposedButtons",disabled:true,}).inject(o);l.elements.input.onclick=function(){n.onSaveButtonClick()}}var m=new e({value:h.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(o);m.addEvent("onClick",this.onCancelButtonClick.bind(this));return o},getCreateEditData:function(n){var u="";if(UWA.is(n)){var p=n.get("createObjectTitle");var l=n.get("descriptionOfObj");var o=n.get("severity");var s="";if(UWA.is(n.get("dueDate"))){var v="";v=n.get("dueDate").actualValue;var m;m=new Date(v);var q=m.getMonth()+1;var t=m.getDate();var r=m.getFullYear();s=q+"/"+t+"/"+r}u={description:l,synopsis:p,severity:o,scheduledCompletionDate:s}}return u},getTransferRealizedData:function(m){var l="";l={transferPurpose:m.get("reasonForChangeForActivity").actualValue,transferComment:"textofTransfer",idsToTransfer:this.options.ids};return l},onSaveButtonClick:function(){var n=this;var p=function(q){f.endWait(widget.body);n.slideInReference.hideSlideIn()};var m=function(q){n.slideInReference.hideSlideIn();f.endWait(widget.body);a.success(h.ECM_CA_Realized_Transfer_Success);n.SaveTransRealCallback(q)};if(this.detailsView.isModelValid()){if(this.options.Mode==="New"){var o=this.getCreateEditData(this.displayViewModel);var l=this.getTransferRealizedData(this.displayViewModel);f.doWait(widget.body);a.createCAAndTransferRealized(o,l,m,p)}else{if(this.options.Mode==="Existing"){var o=this.getTransferData(this.displayViewModel);var l=this.getTransferRealizedData(this.displayViewModel);f.doWait(widget.body);a.transferRealized(o,l,m)}}}else{a.error(h.ECM_CA_Realized_Transfer_MandAttrErr)}},onCancelButtonClick:function(){this.slideInReference.hideSlideIn()},getConfig:function(){var m=[];var l;var n=this;l=new Date();if(this.options.Mode==="New"){m.push({required:true,label:"Title",name:"createObjectTitle",customView:k});m.push({required:true,readWrite:"true",name:"descriptionOfObj",label:h.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3});m.push({label:"Severity",name:"dependencies",customView:i});m.push({label:h.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:l});m.push({readWrite:"true",name:"reasonForChangeForActivity",label:h.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:[{displayValue:h.ECM_CA_Realized_Transfer_EarlyCompl,actualValue:"early"},{displayValue:h.ECM_CA_Realized_Transfer_DelayedCompl,actualValue:"late"}]})}if(this.options.Mode==="Existing"){var q="";var s="";var p=n.options.contextCAId.replace("pid","physicalid");q=q+"NOT ("+p+")";s='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")';var r={title:"Change Action",precond:s,excludeList:q,from:"realized"};var o=new c(r,false);m.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"changeaction",label:h.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:true,searchTitle:h.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"changeaction",search:o});m.push({readWrite:"true",name:"reasonForChangeForActivity",label:h.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:[{displayValue:h.ECM_CA_Realized_Transfer_EarlyCompl,actualValue:"early"},{displayValue:h.ECM_CA_Realized_Transfer_DelayedCompl,actualValue:"late"}]})}return m},getTransferData:function(l){var m={version:"v0",changeaction:l.get("changeaction"),};return m},updateBtnState:function(){var q=this;var m=arguments[0];if(m){var p=m.get("createObjectTitle");var n=m.get("descriptionOfObj");var l=m.get("changeaction");if(((p&&p!="")&&(n&&n!=""))||(l&&l.objectID!="")){if(b.footer){var o=b.footer;o.firstChild.disabled=false;o.firstChild.removeClassName("disabled")}}else{if(b.footer){var o=b.footer;o.firstChild.disabled=true;o.firstChild.addClassName("disabled")}}}}});return b});define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/UIKIT/DropdownMenu","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/EditPropWidget/EditPropComponent","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView","DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CASpinner","DS/TransientWidget/TransientWidget","DS/ENOChangeActionUX/scripts/CAFlowDownStatusContainer"],function(r,e,n,c,g,o,q,a,m,d,k,v,u,b,p,f,i,l,t,s){function j(){g.registerHelper("getActivityDetails",function(w,F){var x="";var G=enoviaServerCAWidget.is3DSpace===true?true:false;if(UWA.is(w)){if(w.BeforeExists&&w.AfterExists){x=x+'<div class="Realized-activity-tile-newline">'}else{x=x+'<div class="Realized-activity-tile-inline">'}x=x+'<div class="Realized-activity-tile">';if(w.BeforeExists){x=x+'<div class="Realized-activity-Before">';if(UWA.is(w.BeforeGrammar)&&w.BeforeGrammar!=""){x=x+'<div class="Realized-activity-Before-Grammar">'+w.BeforeGrammar+"</div>"}if(UWA.is(w.Before)){var B=w.Before.id.substr(4);var A=UWA.is(w.Before.Instanceid)?w.Before.Instanceid.substr(4):B;var C=(enoviaServerCAWidget.NamePref=="Title")?w.Before.title.replace("<","&lt;"):w.Before.name.replace("<","&lt;");if(!UWA.is(C)||C==""){C=w.Before.name.replace("<","&lt;")}var D=(UWA.is(w.Before.instanceName)&&w.Before.instanceName!="")?"("+w.Before.instanceName.replace("<","&lt;")+")":"";x=x+'<div class="Activity-box Access'+w.Before.Access+'" id="drag-'+w.Before.id+'"  draggable="true">';x=x+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+w.Before.id+'"></div>';x=x+'<div class="Realized-activity-Before-icon-div">';x=x+'<img class="Realized-activity-Before-icon" id="Realized-activity-Before-icon-'+w.Before.id+'" src ='+w.Before.icon+"></img></div>";x=x+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}">'+C+"</div>";x=x+'<div class="Realized-activity-revision-Before" id="Realized-activity-revision-Before-{{@index}}">'+w.Before.revision+"</div>";x=x+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}">'+D+"</div>";x=x+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+B+'"Instanceid='+A+"></div>";x=x+"</div>"}x=x+"</div>"}if(w.AfterExists){x=x+'<div class="Realized-activity-After">';if(UWA.is(w.AfterGrammar)&&w.AfterGrammar!=""){x=x+'<div class="Realized-activity-After-Grammar">'+w.AfterGrammar+"</div>"}if(UWA.is(w.AfterMaturity)&&w.AfterMaturity!=""){x=x+'<div class="Realized-activity-After-Maturity">'+w.AfterMaturity+"</div>"}else{if(UWA.is(w.After)){var B=w.After.id.substr(4);var A=UWA.is(w.After.Instanceid)?w.After.Instanceid.substr(4):B;var C=(enoviaServerCAWidget.NamePref=="Title")?w.After.title.replace("<","&lt;"):w.After.name.replace("<","&lt;");if(!UWA.is(C)||C==""){C=w.After.name.replace("<","&lt;")}var D=(UWA.is(w.After.instanceName)&&w.After.instanceName!="")?"("+w.After.instanceName.replace("<","&lt;")+")":"";x=x+'<div class="Activity-box Access'+w.After.Access+' id="drag-'+w.After.id+'" draggable="true" >';x=x+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+w.After.id+'"></div>';x=x+'<div class="Realized-activity-After-icon-div">';x=x+'<img class="Realized-activity-After-icon" id="Realized-activity-After-icon-'+w.After.id+'" src ='+w.After.icon+"></img></div>";x=x+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}">'+C+"</div>";x=x+'<div class="Realized-activity-revision-After" id="Realized-activity-revision-After-{{@index}}">'+w.After.revision+"</div>";x=x+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}">'+D+"</div>";x=x+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+B+'"Instanceid='+A+"></div>";x=x+"</div>"}}x=x+"</div>"}x=x+"</div>";var y=s.getFlowDownStatus();var z="";if(w.After&&w.After.Instanceid){z=y[w.After.Instanceid]}if(w.TransferExists&&w.status=="Transferred"&&UWA.is(w.receivingChangeAction)){var C=(enoviaServerCAWidget.NamePref=="Title")?w.receivingChangeAction.synopsis.replace("<","&lt;"):w.receivingChangeAction.name.replace("<","&lt;");if(w.BeforeExists&&w.AfterExists){}else{}x=x+'<div class="Realized-activity-individual-transfer" id="Realized-activity-individual-transfer-{{@index}}">';x=x+'<div class="Realized-activity-transfer-tile">                                         <div class="Realized-activity-transferTo">'+e.ECM_CA_Realized_TransferTo+':</div>                                         <div class="Realized-activity-transferToCAName" id="'+w.receivingChangeAction.id+'">'+C+'</div></div>                                         <div class="Realized-activity-transfer-Reason-tile">                                         <div class="Realized-activity-transferReasonText">'+e.ECM_CA_Realized_Transfer_Reason+': </div>                                         <div class="Realized-activity-transferReasonNLS">'+w.transferReasonNLS+"</div></div>";x=x+"</div>"}if(z!=undefined&&z!=""){var E="";if(z==="Flowdowned"){E=e.ECM_CA_Realized_Flowdown_Flowdown}else{if(z==="Pending"){E=e.ECM_CA_Realized_Flowdown_Pending}else{if(z==="Ignored"){E=e.ECM_CA_Realized_Flowdown_Ignored}else{if(z==="Partial"){E=e.ECM_CA_Realized_Flowdown_Partial}}}}x=x+'<div class="Realized-transfer-info-text-3" id="info-text-3-'+F+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                        <p class="Realized-change-targetCA" id="targetCA-'+F+'">                                        <span class="Realized-change-targetCA-span" id="targetCA-span-'+F+'"> '+e.ECM_CA_Realized_FlowDown_Status+'</span>                                        <span class="Realized-change-flowdownCA-value-span" id="'+z+'">'+E+"</span>                                  </p> </div>"}x=x+"</div>"}return x});g.registerHelper("isValidForSelection",function(y){var w="";var y=this.id;var x="act-chk-"+y;if(!this.Details.sameAsWhere){w+='<input type="checkbox" class="chkbox-act hidden" id="'+x+'"}}">'}return w})}j();var h={activitiesToExplore:[],actions:[],validateModelSelection:function(z){var x=false;var y,w,A;if(y=z.get("ActivityDetails")){x=true;if(w=y[0].After){if(!w.Access){x=false}}else{if(A=y[0].Before){if(!A.Access){x=false}}else{x=false}}}return x},_createView_NewRealizedActivity:function(w){return r.extend({tagName:"div",className:"realized-activity-details",name:"RealizedActivities",activityModel:w.activityModels,idcardView:w.idcardView,activityIdx:w.activityIdx,caModel:w.caModel,isFromFlowDown:w.flowdownOptions.isFromFlowDown,flowdownOptions:w.flowdownOptions,selectedModelsForDrag:{},selectedActivityItems:[],activitiesToRemove:[],setup:function(){this.template='<div class="Realized-activities-container">                                                    <div class="Realized-activities">                                                        <div class="Realized-activitues-header">                                                        <div class="Realized-activities-chevron Realized-icon-class" id="activities-chevron-'+this.activityIdx+'">                                                                <div>                                                            <div class="Realized-action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                        </div>                                                    </div>                                                    <div class="Real-activities-counter"><span class="realized-counter"> {{RealizedactivityNls}}</span> <span class="realized-counter-num"> {{activityNum}} </span></div>                                                    <div class="'+this.getClassNames("-actions")+'"></div>                                                    <div class="'+this.getClassNames("-activitiesMultisel")+'"></div>                                                    </div>                                                    <div class="Realized-activity-content">                                                        {{#each activities}}                                                            <div class="Realized-activity-individual" id="Realized-activity-individual-{{id}}">                                                                <!--div class="Realized-activity-name-container"><div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{id}}"></div-->                                                                <div class="Realized-activity-name-container"><div class="act-chk-container">{{#isValidForSelection id}} {{/isValidForSelection}}</div>                                                                <div class="Realized-activity-name"> {{activityDesc}}</div></div>                                                                <div class="Realized-activity-individual-details"> {{#getActivityDetails Details}}{{/getActivityDetails}}</div>                                                            </div>                                                        {{/each}}                                                    <\div>                                                    </div>                                             </div>';this._initActionsView();this._initMultiSelView();this.renderer=this.getTemplate(this.template,this.activityModel);var x=this.activityModel.get("activities");this.listenTo(this.activityModel,"onChange:activities",this.render)},render:function(){this.container.empty();l.doWait(widget.body);var y=(this.idcarView)?widget.body:this.container;var z=UWA.createElement("div",{"class":"main-Realized-activities-container"});var F=this.renderer();z.addContent(F);z.inject(y);if(this.activityModel.get("isConfigured")=="true"||enoviaServerCAWidget.isNative){this.injectSubView(this.actionsView,"."+this.name+"-actions");this.injectSubView(this.realizedMultiSelView,"."+this.name+"-activitiesMultisel");this.actionsView&&this.actionsView.dispatchEvent("onShow");this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow")}var D=this.data.activityNum;var A=this;for(var E=0;E<D;E++){var B=this.container.getElement("#activity-action-container-"+E);if(B){var C=E;B.addEvent("click",function(H){var G=H.currentTarget.id.split("-")[3]})}}var x=this.container.getElements(".checkbox-Before");for(var E=0;E<x.length;E++){if(x[E]){var C=E;x[E].addEvent("click",function(G){var K=G.target.checked;var J=document.createElement("input");var I=G.target.id.replace("checkbox-Before-","");if(K){var M=A.getModelFromSelectedID(I);A.selectedModelsForDrag[M.get("id")]=M}else{var O=Object.keys(A.selectedModelsForDrag);for(var N in O){if(O[N]===I){delete A.selectedModelsForDrag[O[N]]}}}J.setAttribute("data-pid",G.target.id.replace("checkbox-Before-pid:",""));if(K){J.setAttribute("class","selected")}q.onClickItem.call(J,widget,enoviaServerCAWidget);var L="Activity-box";var H=this;while(H&&H.parentNode){H=H.parentElement;if(H&&H.className&&H.className.contains(L)){if(K){if(H.addClassName){H.addClassName("selected-border")}}else{if(H.removeClassName){H.removeClassName("selected-border")}}break}}})}}l.endWait(widget.body);return this},TransferRealized:function(B){var z=this;if(this.activitiesToRemove.length){var x=[];var y=[];this.activitiesToRemove.forEach(function(D,C){if(z.validateSelection(D)&&D.get("status")!="Transferred"){var E;if(UWA.is(D.get("Afterobject"))){E=UWA.is(D.get("Afterobject").Instanceid)?D.get("Afterobject").Instanceid:D.get("Afterobject").id}else{if(UWA.is(D.get("Beforeobject"))){E=UWA.is(D.get("Beforeobject").Instanceid)?D.get("Beforeobject").Instanceid:D.get("Beforeobject").id}else{E=D.get("id")}}x.push(E)}else{y.push(D.get("id"))}});if(x.length>0){var A={selectedIDs:x,transferMode:B};z.dispatchEvent("transferSelectedItems",[A])}if(y.length>0){if(y.length==z.activitiesToRemove.length){i.error(e.ECM_CA_Invalid_Selection_Error)}else{i.warn(e.ECM_CA_Invalid_Selection_Warning)}}}},AfterSaveTransReal:function(x){},flowDownSelectedItems:function(C,x){var A=this;if(this.activitiesToRemove.length){var y=[];var z=[];this.activitiesToRemove.forEach(function(E,D){var F;if(UWA.is(E.get("Afterobject"))){F=UWA.is(E.get("Afterobject").Instanceid)?E.get("Afterobject").Instanceid:E.get("Afterobject").id}else{if(UWA.is(E.get("Beforeobject"))){F=UWA.is(E.get("Beforeobject").Instanceid)?E.get("Beforeobject").Instanceid:E.get("Beforeobject").id}else{F=E.get("id")}}y.push(F)});var B={selectedIDs:y,flowdownMode:x!=""?x:"",};A.dispatchEvent("flowDownActivityObjects",[B])}},_initMultiSelView:function(){var x=this;var y={collection:new v(),withMultisel:true,useInfiniteScroll:false,usePullToRefresh:false,buildMultiselActions:function(z){return x.getMultiselActions(z)},events:{onMultiselOff:function(){var z=x;x.selectedActivityItems.length=0;x.activitiesToRemove.length=0;x.deactivateMultisel()},onMultiselOn:function(){x.activateMultisel()}}};if(this.multiSelView){this.multiSelView.destroy()}h.multiSelView=this.realizedMultiSelView=new u(y)},validateSelection:function(A){var y=false;var z,x,B;if(z=A.get("ActivityDetails")){y=true;if(x=z[0].After){if(!x.Access){y=false}}else{if(B=z[0].Before){if(!B.Access){y=false}}else{y=false}}}return y},getMultiselActions:function(A){var y=this;var z=[];if(UWA.is(A)){if(A.result&&enoviaServerCAWidget.isNative){y.exploreRefIds=A.result.refPid;if(A.result.refPid!=null){z.push({accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:true,text:e.ECM_CA_Command_ExploreContext,handler:function(B){var C=[];if(UWA.is(h.activitiesToExplore)){h.activitiesToExplore.forEach(function(E,D){if(h.validateModelSelection(E)){var H;var G=[];G=y.exploreRefIds;if(UWA.is(E.get("Afterobject"))){var F=E.get("Afterobject").id;if(F){F=F.replace("pid:","")}if(G.indexOf(F)>=0){H=UWA.is(E.get("Afterobject").Instanceid)?E.get("Afterobject").Instanceid:E.get("Afterobject").id;C.push(H.replace("pid:",""))}}if(UWA.is(E.get("Beforeobject"))){var F=E.get("Beforeobject").id;if(F){F=F.replace("pid:","")}if(G.indexOf(F)>=0){H=UWA.is(E.get("Beforeobject").Instanceid)?E.get("Beforeobject").Instanceid:E.get("Beforeobject").id;C.push(H.replace("pid:",""))}}}})}if(C.length>0&&C.length!=h.activitiesToExplore.length){i.error(e.ECM_CA_Warn_Multisel_ExpInCtx)}i.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",C)}})}}}if(this.activityModel.get("isConfigured")=="true"){z.push({id:"transfer",text:e.ECM_CA_Realized_Transfer,fonticon:"sync",icon:"transfer_realized_new",multisel:true,items:[{id:"Transfer_NewCA",text:e.ECM_CA_Realized_Transfer_NewCA,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:true,handler:function(C){var B=y;y.TransferRealized("New")}},{id:"Transfer_existingca",text:e.ECM_CA_Realized_Transfer_ExistingCA,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:true,handler:function(B){y.TransferRealized("Existing")}},],});var x=y.caModel.get("userAccess");if(x&&x.FlowdownFrom==="true"&&enoviaServerCAWidget.CHG_FLOWDOWN!="false"){z.push({id:"flowdown",text:e.ECM_CA_FLOWDOWN_ACTIONS,fonticon:"flow-down",icon:"I_InitiateFlowDown",multisel:true,items:[{id:"newca",text:e.ECM_CA_FLOWDOWN_ACTIONS_NEW_CHANGE_ACTION,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:true,handler:function(B){y.flowDownSelectedItems(B,"NewCA")}},{id:"existingca",text:e.ECM_CA_FLOWDOWN_ACTIONS_EXISTING_CHANGE_ACTION,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:true,handler:function(B){y.flowDownSelectedItems(B,"Existing")}},],})}}return z},_initActionsView:function(){var A=this;var z=[{id:"SelectAll",title:e.SelectAll,icon:"select-all",overflow:false},{id:"UnSelectAll",title:e.UnSelectAll,icon:"select-none",overflow:false},];var y=new v(z);if(this.actionsView){this.actionsView.destroy()}this.actionsView=new k({collection:y});var x=this._actionsViewEvents={onActionClick:function(){var B=arguments[1].model.get("id");switch(B){case"SelectAll":if(this.realizedMultiSelView){A.selectAll()}break;case"UnSelectAll":if(this.realizedMultiSelView){this.realizedMultiSelView.exitMultisel();this.realizedMultiSelView.dispatchEvent("onMultiselOff",[this.multiSelView,false])}break}},};this.listenTo(this.actionsView,x)},injectSubView:function(z,x){var y=this.container.getElement(x);if(z&&y){y.grab(z.render().getContent())}},getTemplate:function(A,x){var z=g.compile(A);var y=[];var C=x.get("activities");C.forEach(function(D){D.get("ActivityDetails").forEach(function(E){if(UWA.is(E)&&E!=""){var G={};G.activityDesc=E.NLSName;G.id=D.id.replace("pid:","");var F=E;if(UWA.is(D.get("Afterobject"))&&E.AfterExists){F.After=D.get("Afterobject")}if(UWA.is(D.get("Beforeobject"))&&(E.BeforeExists)){F.Before={};F.Before=D.get("Beforeobject")}G.Details=F;y.push(G)}})});this.data={RealizedactivityNls:e.ECM_CA_RealizedActivities,activityNum:y.length,activities:y,};var B=this;return function(){return z(B.data)}},domEvents:{"click .Realized-activities-chevron":function(x){var z=x.target.id;var y=x.target.className;if(y.indexOf("expand-right")>0){x.target.className=y.replace("right","down").trim()}else{if(y.indexOf("expand-down")>0){x.target.className=y.replace("down","right").trim()}}var A=this.container.getElement(".Realized-activity-content");if(A.hasClassName("hidden")){A.removeClassName("hidden")}else{A.addClassName("hidden")}},"click .activity-individual":function(x){},"click .Realized-activity-action-open":function(y){var z=y.target.id;var x=y.target;var A="Realized-activity-action-open-";z=z.replace(A,"");if(x){if(x.getParent().hasClassName("Accessfalse")){x.Access=false}else{x.Access=true}x.modelid=z;x.Instanceid=x.getAttribute("Instanceid");this.itemView=x;this.dispatchEvent("onContextMenu",x)}},"click .chkbox-act":function(x){var J=x.target;var z=x.target.id;var F=z.split("-");var N=F[F.length-1];var B=parseInt(N);var y=this.container.getElements("#Realized-activity-individual-"+N);var G=this.container.getElements("#act-chk-"+N);for(var C=0;C<y.length;C++){var A=y[C];var I=G[C];if(A.hasClassName("selected-border")){A.removeClassName("selected-border");I.checked=false}else{A.addClassName("selected-border");I.checked=true}}var L=this.activityModel.get("activities").findWhere({id:"pid:"+N});var M=this.selectedActivityItems.indexOf(L.cid);if(M===-1){this.selectedActivityItems.push(L.cid);this.activitiesToRemove.push(L);this.activateMultisel(this.container)}else{this.selectedActivityItems.splice(M,1);this.activitiesToRemove.splice(M,1);if(this.activitiesToRemove.length===0){this.deactivateMultisel(this.container)}}if(this.realizedMultiSelView){var K={};K.isActive=true;K.selectedObjects=this.activitiesToRemove;this.realizedMultiSelView.destroyDropDown();var H=this;var D=[];var E=[];if(enoviaServerCAWidget.isNative){H.activitiesToRemove.forEach(function(P,O){if(H.validateSelection(P)){var Q;if(UWA.is(P.get("Afterobject"))){Q=P.get("Afterobject").id;E.push(Q.replace("pid:",""))}if(UWA.is(P.get("Beforeobject"))){Q=P.get("Beforeobject").id;E.push(Q.replace("pid:",""))}}});h.activitiesToExplore=H.activitiesToRemove;i.DispatchEventToWin("MultiSel_ExpInCtx_RealizedActivity_CmdChk",E)}else{this.realizedMultiSelView.buildMultisel(K)}}},"click .Realized-activity-transferToCAName":function(z){var A=z.target.id;A=A.replace("pid:","");if(enoviaServerCAWidget.is3DSpace){var B=widget.getUrl();B=B.substring(0,B.indexOf("/enterprisechangemgt"));var y=B+"/common/emxTree.jsp?mode=insert&objectId="+A;window.open(y)}else{if(enoviaServerCAWidget.isNative){var x={TransientCAPid:A};i.DispatchEventToWin("OpenCA",A)}else{var x={TransientCAPid:A};t.showWidget("ENOWCHA_AP","",x,{mode:"panel",height:800,width:650})}}},"dragstart .Activity-box":function(B){var A=B.target.id.substr(5);var x=false;var C=Object.keys(this.selectedModelsForDrag);for(key in C){if(C[key]===A){x=true;break}}var z={};if(x===false){var y=this.getModelFromSelectedID(A);z[y.get("id")]=y}else{z=this.selectedModelsForDrag}Array.prototype.unshift.call(arguments,z);Array.prototype.unshift.call(arguments,{});this.dispatchEvent("onItemViewDrag",arguments)},},getModelFromSelectedID:function(D){var E=null;var y=this.activityModel.get("activities");for(var x=0;x<y.length;x++){var A=y.at(x);if(A){var B=A.get("Beforeobject");if(B&&B.id===D){E=B;break}var z=A.get("Afterobject");if(z&&z.id===D){E=z;break}}}var C=new UWA.Class.Model();C.set("id",E.id);C.set("objectName",E.name);C.set("type",E.type);C.set("title",E.title);C.set("revision",E.revision);return C},deactivateMultisel:function(){var y=this.container;var F=y.getElements(".Realized-actions-container");for(var E=0;E<F.length;E++){var G=F[E];G.removeClassName("no-actions")}var x=y.getElements(".checkbox-Before");var A=y.getElements(".chkbox-act");for(var E=0;E<x.length;E++){var C=x[E];C.removeClassName("hidden")}for(var E=0;E<A.length;E++){var D=A[E];if(D.checked){D.checked=false}D.addClassName("hidden")}var B=y.getElements(".Realized-activity-individual");for(var E=0;E<B.length;E++){var z=B[E];z.removeClassName("selected-border")}},activateMultisel:function(){var A=this.container;var D=A.getElements(".Realized-actions-container");for(var z=0;z<D.length;z++){var C=D[z];C.addClassName("no-actions")}var y=A.getElements(".checkbox-Before");var B=A.getElements(".chkbox-act");for(var z=0;z<y.length;z++){var E=y[z];if(E.checked){E.click()}E.addClassName("hidden")}for(var z=0;z<B.length;z++){var x=B[z];x.removeClassName("hidden")}},selectAll:function(){this.activateMultisel();var z=this.container;var A=z.getElements(".chkbox-act");for(var y=0;y<A.length;y++){var x=A[y];if(!x.checked){x.click()}}},})},calledFromNativeInterop:function(w){var x={};x.isActive=true;x.selectedObjects={selectedObjs:h.activitiesToExplore,result:w,length:h.activitiesToExplore.length};h.multiSelView.buildMultisel(x)},};return h});define("DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","DS/UIKIT/Scroller","DS/UIKIT/DropdownMenu","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/ENOChangeActionUX/scripts/CAUtility","DS/TransientWidget/TransientWidget","DS/ENOChangeActionUX/scripts/CAFlowDownStatusContainer"],function(c,p,k,m,f,d,j,b,i,o,e,a,h,g){function n(){f.registerHelper("isContextualMenuAvailable",function(r){var q="";var s=r.displayId;q='<div class="context-actions-container">                                            <div class="action-icon-wrapper"><span class="Realized-operation-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-Op-Clicked-'+s+'"></span></div>                                    </div>';return q});f.registerHelper("getWhereDetails",function(v,s){var u=window.matchMedia("(max-width: 768px)");var w=v.id.substr(4);var q='<div class="Realized-change-info-text" id="info-text-'+s+'">';if(UWA.is(v)){q=q+'<div class="Realized-change-TNR-text" id="TNR-text-'+s+'">                                                    <div class="Realized-change-TNR-Preference" id="TNR-Preference-'+s+'">';if(UWA.is(v.icon)&&v.icon!=""){q=q+'<img class="Realized-change-info-icon" id="info-icon-'+s+'" src ='+v.icon+"></img>"}if(UWA.is(v.name)&&v.name!=""){q=q+'<div class="Realized-name-title" id="Realized-name-title-'+s+'">                                                       <span class="Realized-name-span" id="Realized-name-span-'+s+'">'+v.name+'</span>                                                        <span class="Realized-revision-span" id="Realized-revision-span-'+s+'">'+v.revision+"</span>                                                       </div>"}q=q+"</div>";if(!u.matches){q=q+'<div class="Realized-title-name" id="Realized-title-name-'+s+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+s+'">'+v.title+"</span>                                                       </div>";q=q+'<div class="Realized-Mobile-Maturity hidden" id="Realized-Mobile-Maturity-'+s+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+s+'">'+v.maturity+"</span>                                                       </div>"}if(u.matches){q=q+'<div class="Realized-title-name hidden" id="Realized-title-name-'+s+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+s+'">'+v.title+"</span>                                                       </div>";q=q+'<div class="Realized-Mobile-Maturity" id="Realized-Mobile-Maturity-'+s+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+s+'">'+v.maturity+"</span>                                                       </div>"}q=q+"</div>";if(u.matches){q=q+'<div class="Realized-change-info-text-1 hidden" id="Realized-change-info-text-1-'+s+'">'}else{q=q+'<div class="Realized-change-info-text-1 " id="Realized-change-info-text-1-'+s+'">'}if(UWA.is(v.maturity)){q=q+'<div class="Realized-change-info-text-2 " id="Realized-change-info-text-2-'+s+'>"';q=q+'<p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-maturity" id="Realized-change-maturity-'+s+'">                                                        <span class="Realized-change-maturity-span" id="mat-span-'+s+'">'+v.maturityNLS+' :</span>                                                        <span class="Realized-change-maturityValue-span" id="matval-span-'+s+'">'+v.maturity+"</span>                                                    </p>                                                   </div>"}if(UWA.is(v.collabspace)){q=q+'<div class="Realized-change-info-text-3" id="info-text-3-'+s+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-collabspace" id="collabspace-'+s+'">                                                        <span class="Realized-change-collabspace-span" id="collab-span-'+s+'">'+v.collabspaceNLS+' :</span>                                                        <span class="Realized-change-collabspace-value-span" id="collab-span-value-'+s+'">'+v.collabspace+"</span>                                                    </p> </div>"}q=q+"</div>";var t=g.getFlowDownStatus();var x=t[v.id];q=q+'<div class="Realized-transfer-info-text-1 " id="Realized-transfer-info-text-1-'+s+'">';if(UWA.is(v.status)&&(v.status=="Transferred")){if(UWA.is(v.targetCA)){q=q+'<div class="Realized-transfer-info-text-3" id="info-text-3-'+s+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                        <p class="Realized-change-targetCA" id="targetCA-'+s+'">                                        <span class="Realized-change-targetCA-span" id="targetCA-span-'+s+'">'+p.ECM_CA_Realized_TransferTo+' :</span>                                        <span class="Realized-change-targetCA-value-span" id="'+v.targetCAID+'">'+v.targetCA+"</span>                                  </p> </div>"}if(UWA.is(v.transferReasonNLS)){q=q+'<div class="Realized-transfer-info-text-4" id="info-text-4-'+s+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                        <p class="Realized-change-transferComment" id="transferComment-'+s+'">                                                        <span class="Realized-change-transferComment-span" id="transferComment-span-'+s+'">'+p.ECM_CA_Realized_Transfer_Reason+' :</span>                                                        <span class="Realized-change-transferComment-value-span" id="transferComment-value-'+s+'">'+v.transferReasonNLS+"</span>                                                    </p> </div>"}}if(x!=undefined){var r="";if(x==="Flowdowned"){r=p.ECM_CA_Realized_Flowdown_Flowdown}else{if(x==="Pending"){r=p.ECM_CA_Realized_Flowdown_Pending}else{if(x==="Ignored"){r=p.ECM_CA_Realized_Flowdown_Ignored}else{if(x==="Partial"){r=p.ECM_CA_Realized_Flowdown_Partial}}}}q=q+'<div class="Realized-transfer-info-text-3" id="info-text-3-'+s+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                        <p class="Realized-change-targetCA" id="targetCA-'+s+'">                                        <span class="Realized-change-targetCA-span" id="targetCA-span-'+s+'"> '+p.ECM_CA_Realized_FlowDown_Status+'</span>                                        <span class="Realized-change-flowdownCA-value-span" id="'+x+'">'+r+"</span>                                  </p> </div>"}q=q+"</div>"}return q=q+"</div>"});f.registerHelper("ifDraggableRealized",function(q){if(q===false){return"draggable='false'"}else{return"draggable='true'"}})}n();var l={_createView_NewRealized:function(q){return c.extend({tagName:q.viewTagName,className:q.className,idcardView:q.idcardView,name:"RealizedOperation",RealizedModel:q.realizedModel,caModel:q.caModel,isFromFlowDown:q.flowdownOptions.isFromFlowDown,flowdownOptions:q.flowdownOptions,container:null,selectedTilesIDs:[],setup:function(){var r=this.RealizedModel.get("id");this.template='<div class="'+this.getClassNames("-container")+'">                                            {{#each changes}}                                            <div class="'+this.getClassNames("-sub-container")+'">                                                <div class="Realized-tile-collapsed" id="Realized-collapsed-{{@index}}" 												{{#ifDraggableRealized Details.access}}{{/ifDraggableRealized}}>                                                    <div class="Realized-accordion-div Realized-icon-class" id="Realized-accordion-div-{{@index}}"><div>                                                    <div class="Realized-action-icon-wrapper Realized-accordion-div-inner" id="Realized-accordion-div-inner-{{@index}}"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                    <div class="Realized-checked-action"><input type="checkbox" class="Realized-checkbox-accord hidden" id="Realized-checkbox-accord-{{Details.id}}"></div>                                                </div>                                            </div>                                            <div class="Realized-tile-inner" id="inner-{{@index}}">{{#getWhereDetails Details @index}}{{/getWhereDetails}}</div>                                                <div class="Realized-actions-container Realized-icon-class-1" id="Realized-operation-action-container-{{Details.displayId}}">{{#isContextualMenuAvailable Details}}{{/isContextualMenuAvailable}}</div>                                            </div>                                            <div class="Realized-tile-expanded hidden" id="Realized-expanded-{{@index}}"></div>                                            </div>                                            {{/each}}                                        </div>';l.selectedTilesIDs=[]},render:function(){this.container.empty();this.renderer=this.getTemplate(this.template,this.RealizedModel);var v=(this.idcardView)?widget.body:this.container;var t=UWA.createElement("div",{"class":"main-Realized-operation-container"});var s=UWA.createElement("div",{"class":"ChangeComponent",});var r=this.renderer();s.setContent(r);t.addContent(s);t.setStyle("height","calc(100% - 50px)");new j({element:t}).inject(v);var u=this;l.container=u;this.activitiesViewArr.forEach(function(x,w){u.injectSubView(x,"#Realized-expanded-"+w)});setTimeout(function(){l.onResize()},0);return this},injectSubView:function(t,r){var s=this.container.getElement(r);if(t&&s){s.grab(t.render().getContent())}},_initActivitiesView:function(w,r){var v=this;var s={idcardView:false,activityModels:w,activityIdx:r,caModel:this.caModel,flowdownOptions:this.flowdownOptions};var t=new (d._createView_NewRealizedActivity(s));var u=this.ActivityEvents={onContextMenu:function(x){l.itemView=x;if(l.itemView.Access&&enoviaServerCAWidget.isNative){a.DispatchEventToWin("Realized_ContextMenu",l.itemView.modelid)}else{l.DisplayContextMenu([])}},onItemViewDrag:function(){v.dispatchEvent("onItemViewDrag",arguments)},activityCheckBoxClicked:function(){v.dispatchEvent("activityCheckBoxClicked",arguments)},flowDownActivityObjects:function(){v.dispatchEvent("flowDownActivityObjects",arguments)},transferSelectedItems:function(){v.dispatchEvent("transferSelectedItems",arguments)}};this.listenTo(t,u);this.activitiesViewArr.push(t)},getTemplate:function(u,t){var s=f.compile(u);var v=this;var r=[];this.activitiesViewArr=[];if(UWA.is(t)){t.forEach(function(z,w){v._initActivitiesView(z);var C={};var x={maturityNLS:p.ECM_CA_Maturity,collabspaceNLS:p.ECM_CA_CollabSpace,statusNLS:p.ECM_CA_Realized_statusNLS,TransferNLS:p.ECM_CA_Realized_TransferNLS,maturity:z.get("maturity"),collabspace:z.get("collabSpace"),name:UWA.is(z.get("objectName"))?z.get("objectName"):z.get("name"),revision:z.get("revision"),title:UWA.is(z.get("objectTitle"))?z.get("objectTitle"):z.get("name"),icon:z.get("icon"),id:z.get("id"),access:z.get("Access"),displayId:z.get("id").substr(4),changeReason:z.get("changeReason"),status:z.get("status"),isConfigured:z.get("isConfigured"),transferReasonNLS:UWA.is(z.get("transferReasonNLS"))?z.get("transferReasonNLS"):"",targetCAID:UWA.is(z.get("receivingChangeAction"))?z.get("receivingChangeAction").id:"",targetCA:UWA.is(z.get("receivingChangeAction"))?z.get("receivingChangeAction").name:"",};if(enoviaServerCAWidget.NamePref=="Title"){var A=UWA.is(z.get("objectTitle"))?z.get("objectTitle"):z.get("name");var B=UWA.is(z.get("objectName"))?z.get("objectName"):z.get("name");var y=UWA.is(z.get("receivingChangeAction"))?z.get("receivingChangeAction").synopsis:"";x.name=A.replace("<","&lt;");x.title=B.replace("<","&lt;");x.targetCA=y.replace("<","&lt;")}C.Details=x;r.push(C)})}this.data={RealizedNls:p.ECM_CA_RealizedChanges,RealizedNum:r.length,changes:r};var v=this;return function(){return s(v.data)}},domEvents:{"click .Realized-accordion-div-inner":function(r){var t=r.target.id;var s=r.target.className;if(s.indexOf("expand-right")>0){r.target.className=s.replace("right","down").trim()}else{if(s.indexOf("expand-down")>0){r.target.className=s.replace("down","right").trim()}}l.expandTile(t,s)},"click .Realized-tile-inner":function(v){if(v.target.className.indexOf("down-open")>0){return}if(v.target.className.indexOf("Realized-change-targetCA-value-span")==0){return}var y=v.target.id;var u=y.split("-");var x=u[u.length-1];var r=this.container;var t=r.getElement("#Realized-accordion-div-inner-"+x);if(t){var s=t.className;if(s.indexOf("hidden")>0){return}}var w=t.getElementsByTagName("span")[0].className;if(w.indexOf("expand-right")>0){t.getElementsByTagName("span")[0].className=w.replace("right","down").trim()}else{if(w.indexOf("expand-down")>0){t.getElementsByTagName("span")[0].className=w.replace("down","right").trim()}}l.expandTile(x)},"click .Realized-checkbox-accord":function(t){var x=t.target.checked;var w=document.createElement("input");w.setAttribute("data-pid",t.target.id.replace("Realized-checkbox-accord-pid:",""));if(x){w.setAttribute("class","selected")}CAWidgetConfiguration.onClickItem.call(w,widget,enoviaServerCAWidget);var A="Realized-tile-collapsed";var u=t.target;var z=0;while(u&&u.parentNode){u=u.parentElement;if(u&&u.className&&u.className.contains(A)){z=u.id;if(x){u.addClassName("selected-border")}else{u.removeClassName("selected-border")}}}var y=z.split("-");var B=y[y.length-1];var v=parseInt(B);var r=this.RealizedModel;var s=r.at(v);Array.prototype.unshift.call(arguments,s);this.dispatchEvent("onCheckboxClick",arguments)},"click .Realized-operation-action-open":function(t){var u=t.target.id;var r=this.container.getElement("#"+u);var v="Realized-Op-Clicked-";u=u.replace(v,"");var s=this.RealizedModel.findWhere({id:"pid:"+u});if(UWA.is(s)){r.model=s}r.modelid=u;l.itemView=r;if(l.itemView.model.get("Access")&&enoviaServerCAWidget.isNative){a.DispatchEventToWin("Realized_ContextMenu",u)}else{l.DisplayContextMenu([])}},"dragstart .Realized-tile-collapsed":function(s){var z=this.RealizedModel;var x=s.target;var t=s.target.id;var w=t.split("-");var y=w[w.length-1];var v=parseInt(y);var u=z.at(v);var r={};r[u.get("id")]=u;Array.prototype.unshift.call(arguments,r);Array.prototype.unshift.call(arguments,{});this.dispatchEvent("onItemViewDrag",arguments)},"click .Realized-change-targetCA-value-span":function(t){var u=t.target.id;u=u.replace("pid:","");if(enoviaServerCAWidget.is3DSpace){var v=widget.getUrl();v=v.substring(0,v.indexOf("/enterprisechangemgt"));var s=v+"/common/emxTree.jsp?mode=insert&objectId="+u;window.open(s)}else{if(enoviaServerCAWidget.isNative){var r={TransientCAPid:u};a.DispatchEventToWin("OpenCA",u)}else{var r={TransientCAPid:u};h.showWidget("ENOWCHA_AP","",r,{mode:"panel",height:800,width:650})}}},},})},getcontextItemActions:function(){var r=this;var q=[];var t=true;var u=r.itemView.model;if(u){t=u.get("Access")}else{t=r.itemView.Access}if(t==true){var s={text:p.ECM_CA_Explore_With_Central,icon:"fonticon fonticon-window",handler:function(){if(enoviaServerCAWidget.is3DSpace){var z=r.itemView.modelid;var A=widget.getUrl();A=A.substring(0,A.indexOf("/enterprisechangemgt"));var w=A+"/common/emxTree.jsp?mode=insert&objectId="+z;window.open(w)}else{var z=r.itemView.modelid;var w="/common/emxTree.jsp?mode=insert&objectId="+z;var y=enoviaServerCAWidget.getSecurityContext().replace("ctx::","");var x=enoviaServerCAWidget.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+y+"&forwardUrl="+w);var v=window.open();v.opener=null;v.location.href=x}}};if(!enoviaServerCAWidget.isNative){q.push(s)}q.push({id:"Properties",text:p.ECM_CA_Properties,fonticon:"attributes",icon:"I_ChangeCnxObjProps",multisel:true,handler:function(v){var w=UWA.is(r.itemView.Instanceid)?r.itemView.Instanceid:r.itemView.modelid;a.createPropertiesComponent(w)},})}return q},DisplayContextMenu:function(r){if(UWA.is(l.itemView)){var q=l.getcontextItemActions();r.push.apply(r,q);a._initDropDown(r,l.itemView)}},expandTile:function(w){var q=this.container.getElement("#Realized-expanded-"+w);if(q){var r=q.className;if(r.indexOf("hidden")>0){q.className=r.replace("hidden","").trim();this.selectedTilesIDs.push(w);var x=q.getElement(".Realized-title-name");if(UWA.is(x)){x.className=x.className.replace("hidden","").trim()}}else{q.className=r+" hidden";if(UWA.is(this.selectedTilesIDs)){for(var t=this.selectedTilesIDs.length-1;t>=0;t--){if(this.selectedTilesIDs[t]===w){this.selectedTilesIDs.splice(t,1);break}}}}}var s=this.container.getElement("#Realized-collapsed-"+w);if(s){if(s.style.borderBottom.indexOf("hidden")>=0){s.style.borderBottom=""}else{s.style.borderBottom="hidden"}}var v=window.matchMedia("(max-width: 768px)");var u=(this.container.container.offsetWidth<=768)?true:false;if(v.matches){l.resizeForMobile(w)}},resizeForMobile:function(s){var q=this.container.getElement("#info-text-"+s);if(q){q.setStyles({"flex-direction":"column"})}q=this.container.getElement("#Realized-change-info-text-1-"+s);if(q){var r=q.className;if(r.indexOf("hidden")>0){q.className=r.replace("hidden","").trim()}else{q.className=r+" hidden"}}q=this.container.getElement("#Realized-transfer-info-text-1-"+s);if(q){var r=q.className;if(r.indexOf("hidden")>0){q.className=r.replace("hidden","").trim()}else{q.className=r+" hidden"}}q=this.container.getElement("#Realized-title-name-"+s);if(q){var r=q.className;if(r.indexOf("hidden")>0){q.className=r.replace("hidden","").trim()}else{q.className=r+" hidden"}}q=this.container.getElement("#Realized-Mobile-Maturity-"+s);if(q){var r=q.className;if(r.indexOf("hidden")>0){q.className=r.replace("hidden","").trim()}else{q.className=r+" hidden"}}},collapseTiles:function(){var v=this.container.getElements(".Realized-tile-expanded");for(var q=0;q<v.length;q++){var u=v[q];var s=u.className;if(s.indexOf("hidden")>0){}else{u.className=s+" hidden"}}if(UWA.is(this.selectedTilesIDs)){this.selectedTilesIDs=[]}var t=window.matchMedia("(max-width: 768px)");var r=t.matches?true:false;var v=this.container.getElements(".Realized-change-info-text");for(var q=0;q<v.length;q++){var u=v[q];if(r){u.setStyles({"flex-direction":"column"})}else{u.setStyles({"flex-direction":"row"})}}v=this.container.getElements(".Realized-change-info-text-1");for(var q=0;q<v.length;q++){var u=v[q];var s=u.className;if(s.indexOf("hidden")>0&&(!r)){u.className=s.replace("hidden","").trim()}else{if(s.indexOf("hidden")<=0&&(r)){u.className=s+" hidden"}else{}}}v=this.container.getElements(".Realized-transfer-info-text-1");for(var q=0;q<v.length;q++){var u=v[q];var s=u.className;if(s.indexOf("hidden")>0&&(!r)){u.className=s.replace("hidden","").trim()}else{if(s.indexOf("hidden")<=0&&(r)){u.className=s+" hidden"}else{}}}var v=this.container.getElements(".Realized-title-name");for(var q=0;q<v.length;q++){var u=v[q];var s=u.className;if(s.indexOf("hidden")>0&&(!r)){u.className=s.replace("hidden","").trim()}else{if(s.indexOf("hidden")<=0&&(r)){u.className=s+" hidden"}else{}}}var v=this.container.getElements(".Realized-Mobile-Maturity");for(var q=0;q<v.length;q++){var u=v[q];var s=u.className;if(s.indexOf("hidden")>0&&(r)){u.className=s.replace("hidden","").trim()}else{if(s.indexOf("hidden")<=0&&(!r)){u.className=s+" hidden"}}}},deactivateMultisel:function(){var q=l.container.container;var y=q.getElements(".Realized-actions-container");for(var x=0;x<y.length;x++){var A=y[x];A.removeClassName("no-actions")}var z=q.getElements(".Realized-accordion-div-inner");var s=q.getElements(".Realized-checkbox-accord");for(var x=0;x<z.length;x++){var u=z[x];u.removeClassName("hidden");var w=u.getElementsByTagName("span")[0].className;if(w.indexOf("expand-down")>0){u.getElementsByTagName("span")[0].className=w.replace("down","right").trim()}var v=s[x];if(v.checked){v.checked=false}v.addClassName("hidden")}var t=q.getElements(".Realized-tile-collapsed");for(var x=0;x<t.length;x++){var r=t[x];r.removeClassName("selected-border")}},activateMultisel:function(){var q=l.container.container;var y=q.getElements(".Realized-actions-container");for(var x=0;x<y.length;x++){var B=y[x];B.addClassName("no-actions")}var z=q.getElements(".Realized-accordion-div-inner");var t=q.getElements(".Realized-checkbox-accord");for(var x=0;x<z.length;x++){var v=z[x];var w=t[x];w.removeClassName("hidden");v.addClassName("hidden")}var r=q.getElements(".Realized-tile-expanded");for(var x=0;x<r.length;x++){var C=r[x];var A=C.hasClassName("hidden");if(A===false){C.addClassName("hidden")}}var u=q.getElements(".Realized-tile-collapsed");for(var x=0;x<u.length;x++){var s=u[x];s.style.borderBottom=""}this.selectedTilesIDs=[]},selectAll:function(){this.activateMultisel();var s=l.container.container;var t=s.getElements(".Realized-checkbox-accord");for(var r=0;r<t.length;r++){var q=t[r];if(!q.checked){q.click()}}},UnselectAll:function(){this.activateMultisel();var s=l.container.container;var t=s.getElements(".Realized-checkbox-accord");for(var r=0;r<t.length;r++){var q=t[r];if(q.checked){q.click()}}},onResize:function(){var q=this.selectedTilesIDs;l.collapseTiles();if(UWA.is(q)){q.forEach(function(s,r){l.expandTile(s)})}}};return l});define("DS/ENOChangeActionUX/scripts/Views/CANewRealizedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Utils/Client","DS/Handlebars/Handlebars","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView","DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChangeActionUX/scripts/CASpinner","DS/DataDragAndDrop/DataDragAndDrop","DS/ENOChangeActionUX/scripts/CAFlowDownStatusContainer",],function(p,i,d,m,b,r,f,s,j,v,u,l,t,h,g,a,o,c,k,e,q){var n={caTagNavigatorProxy:null,sortingFirstTime:true,filteredText:"",_tempReferenceToWinSearchCallback:null,_createView_NewRealized:function(x,y,A,z,w){return p.extend({name:"changeView",tagName:x,className:y,currModel:null,model:z,flowdownOptions:w,filteredText:w.objNametoFilterforFlowDown,RealizedModel:null,modelsToRemove:[],selectedOperationItems:[],setup:function(){this.template='                                            <div class="'+this.getClassNames("-container")+'">                                            <div class="Realized-Operations-header">                                                     <div class="'+this.getClassNames("-RealizedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-RealizedActions")+'"></div>                                                    <div class="'+this.getClassNames("-realizedMultisel")+'"></div>                                               </div>                                               <div class="'+this.getClassNames("-Search-container")+'"></div>                                              <div class="'+this.getClassNames("-Realizedoperation-container")+'"></div>                                            <\div>';if(this.model){var C=this.model.get("realized");var B=n.caTagNavigatorProxy=this.caTagNavigatorProxy=new h();var D="Realized";B._initTaggerProxy(D).then(function(F){var E="Realized";g.setTaggerObject(E,B)},function(E){console.log("Tagger initilization failed")})}},initSubViews:function(){this.RealizedModel=this.model.get("realized");var C=this;if(!this._externalEvents){var B=this._externalEvents={onRealizedTaggerProxyFilterChange:function(G,H){if(C.filteredbyTaggerCollection&&C.filteredbyTaggerCollection.length){C.filteredbyTaggerCollection.reset()}var F=C.filteredRealizedCollection?this.filteredRealizedCollection:C.originalRealizedCollection;var E=F.slice(0,F.length);var D=new UWA.Class.Collection(E);C.filterRealizedCollection(G,H,D,C.model)}};if(n.caTagNavigatorProxy){this.listenTo(n.caTagNavigatorProxy,B)}}if(this.originalRealizedCollection){this._initActionsView();this._initCounterView();this._initMultiSelView();this._initSearchFilterView(this.originalRealizedCollection);this._initOperationView(this.originalRealizedCollection)}},render:function(){this.currModel=this.model;g.CurrModel=this.model;var F=this.model.get("realized");var G=this;var E=this.caTagNavigatorProxy;this.listenTo(this.currModel,"onChange:realized",this.render);setTimeout(function(){if(E){E._setSubjectTags(F,"Realized")}},1000);this.originalRealizedCollection=F;this.initSubViews();this.renderer=this.getTemplate(this.template);var D=this.name;var H=this.cid;var C=null;if(UWA.is(this.containerReference)){C=this.containerReference.getElement(".main-Realized-change-container");if(UWA.is(C)){C.empty();C.destroy();C=null}}this.containerReference=this.container;if(!UWA.is(C)){C=this.mainContainerDiv=UWA.createElement("div",{"class":"main-Realized-change-container",styles:{width:"100%",height:"100%",}})}C.addEvent("resize",function(){setTimeout(function(){i.onResize()},50)});var B=this.renderer();C.addContent(B);C.inject(this.containerReference);this.injectSubView(this.counterView,"."+D+"-RealizedCounter");this.injectSubView(this.actionsView,"."+D+"-RealizedActions");this.injectSubView(this.realizedMultiSelView,"."+D+"-realizedMultisel");this.injectSubView(this.searchFilterView,"."+D+"-Search-container");this.injectSubView(this.operationView,"."+D+"-Realizedoperation-container");this.actionsView&&this.actionsView.dispatchEvent("onShow");this.counterView&&this.counterView.dispatchEvent("onShow");this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow");var G=this;setTimeout(function(){if(G.filteredText){n.filteredText=G.filteredText;var I=G.container.getElement(".fonticon-search");if(I){g.getFlowdownCandidatesAndTheirStatus(w.transientCAPid,w.originatingCAPid).then(function(K){q.setFlowDownStatus(K);var M=G.container.getElement(".fonticon-search");if(M){M.click()}var L=G.container.getElement(".filtertext");if(L){L.value=G.filteredText}var J=document.createEvent("Event");J.initEvent("keyup",true,false);if(L){L.dispatchEvent(J)}},function(J){return Promise.reject(J)})}}},200)},injectSubView:function(D,B){var C=this.containerReference.getElement(B);if(D&&C){C.grab(D.render().getContent())}},getTemplate:function(D){var C=f.compile(D);var E=this;var B=[];this.activitiesViewArr=[];if(UWA.is(this.originalRealizedCollection)){this.originalRealizedCollection.forEach(function(G,F){var H={};B.push(H)})}this.data={RealizedNls:d.ECM_CA_RealizedChanges,RealizedNum:B.length,changes:B};var E=this;return function(){return C(E.data)}},_initCounterView:function(B){var C=this;if(this.counterView){this.counterView.destroy()}this.counterView=new s({title:d.ECM_CA_RealizedChanges,collection:UWA.is(B)?B:C.originalRealizedCollection})},_initscroller:function(){this.scrollerContainer=document.getElementById("RealizedView-scroll");if(!this.scrollerContainer){this.scrollerContainer=UWA.createElement("div",{id:"RealizedView-scroll",styles:{height:"100%",}})}this.scrollerContainer.empty()},_initActionsView:function(){var C=d.ECM_CA_Sort_ProposedChanges_Name;if(enoviaServerCAWidget.NamePref=="Title"){C=d.ECM_CA_Sort_ProposedChanges_Title}var E=[{id:"sort",title:C,icon:"sort-alpha-asc",overflow:false,},{id:"search",title:d.ECM_CA_Search_RealizedChanges,icon:"search",overflow:false},{id:"SelectAll",title:d.SelectAll,icon:"select-all",overflow:false},{id:"UnSelectAll",title:d.UnSelectAll,icon:"select-none",overflow:false},];if(window.enoviaServerCAWidget.CHG_TRANSFER_REALIZED!="false"){E.push({id:"SelectAll",title:d.SelectAll,icon:"select-all",overflow:false},{id:"UnSelectAll",title:d.UnSelectAll,icon:"select-none",overflow:false})}var D=new v(E);if(this.actionsView){this.actionsView.destroy()}this.actionsView=new j({collection:D});var B=this._actionsViewEvents={onActionClick:function(){var F=arguments[1].model.get("id");switch(F){case"sort":this.sortRealized();break;case"search":this.searchRealized(this);break;case"SelectAll":if(this.multiSelView){i.selectAll()}break;case"UnSelectAll":if(this.multiSelView){this.multiSelView.exitMultisel();this.multiSelView.dispatchEvent("onMultiselOff",[this.multiSelView,false])}break}},};this.listenTo(this.actionsView,B)},TransferRealized:function(E){var F=this;if(E&&E.ids.length>0){var B={ids:E.ids,contextCAId:F.model.get("id"),Mode:E.mode,Entity:"ChangeAction",};B.callback=F.AfterSaveTransReal;var D=new o(B);var C=new a();C.buildSlideIn(D);C.showSlideIn()}if(E&&E.incorrectSelectedIds&&E.incorrectSelectedIds.length>0){if(E.incorrectSelectedIds.length==F.modelsToRemove.length){g.error(d.ECM_CA_Invalid_Selection_Error)}else{g.warn(d.ECM_CA_Invalid_Selection_Warning)}}},sortRealized:function(){var C=new UWA.Class.Collection();var N=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc");var D=true;if(N.length!=0){D=false}else{N=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc")}var I=[];var J=[];var L=[];var E={};var G=this;var M;M=G.filteredbyTaggerCollection?G.filteredbyTaggerCollection:G.originalRealizedCollection;function B(O,Q,P){var T="";if(enoviaServerCAWidget.NamePref=="Title"){T=O.get("objectTitle")}else{T=O.get("objectName")}var S=O.get("revision").toLowerCase();var R=T.toLowerCase()+S;E[R]=T;J.push(R);J.sort();if(P.length-1===Q){J.forEach(function(W){var U=E[W];var V=null;if(enoviaServerCAWidget.NamePref=="Title"){L=M.where({objectTitle:U})}else{L=M.where({objectName:U})}if(Array.isArray(L)){L.forEach(function(X){if(X&&(X.get("IdentifierWithRevision").toLowerCase()===W)){I.push(X)}})}})}}if(M.length>0){var H=[];M.sortBy(B);H=I;if(!D&&n.sortingFirstTime!=true){H.reverse()}var C=new UWA.Class.Collection(H);if(this.filteredbyTaggerCollection){this.filteredbyTaggerCollection=C}else{this.originalRealizedCollection=C}var K=document.querySelector(".Realized-operations-details");K.innerHTML="";this.RealizedModel=C;this.operationView.destroy();var F=this.operationView=this._initOperationView(C);this.injectSubView(this.operationView,"."+this.name+"-Realizedoperation-container");this.realizedMultiSelView.destroy();this._initMultiSelView();this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel");this.selectedOperationItems.splice(0,this.selectedOperationItems.length);this.modelsToRemove.splice(0,this.modelsToRemove.length);if(n.sortingFirstTime===false){this.changeSortIcon(N,D)}n.sortingFirstTime=false}},changeSortIcon:function(B,C){if(B.length>0){if(C){B[0].className="fonticon fonticon-sort-alpha-asc"}else{B[0].className="fonticon fonticon-sort-alpha-desc"}}},searchRealized:function(F){document.getElementsByClassName("search-main-container");var G=F.containerReference.getElement(".search-main-container");if(G.hasClassName("hidden")){G.removeClassName("hidden");var C=G.getElement(".searchfilter-input-container");C.addClassName("highlighted-border");C.removeClassName("border-without-focus");var E=G.getElement("input");E.focus()}else{G.addClassName("hidden")}var D=G.hasClassName("hidden");var B=F.containerReference.getElement(".main-Realized-operation-container");if(!D){B.setStyle("height","calc(100% - 100px)")}else{B.setStyle("height","calc(100% - 50px)")}},_initOperationView:function(D){if(this.operationView){this.operationView.destroy()}var B={tagName:"div",className:"Realized-operations-details",idcarView:false,caModel:this.model,realizedModel:D,flowdownOptions:this.flowdownOptions};var F=this.operationView=new (i._createView_NewRealized(B));var E=this;var C=this._operationsEvents={onCheckboxClick:function(L){var K=this.selectedOperationItems.indexOf(L.cid);if(K===-1){this.selectedOperationItems.push(L.cid);this.modelsToRemove.push(L);i.activateMultisel();if(n.caTagNavigatorProxy){n.caTagNavigatorProxy.deactivateTaggerProxy()}}else{this.selectedOperationItems.splice(K,1);this.modelsToRemove.splice(K,1);if(this.modelsToRemove.length===0){i.deactivateMultisel();if(n.caTagNavigatorProxy){n.caTagNavigatorProxy.activateTaggerProxy()}}}if(this.multiSelView){var I={};I.isActive=true;I.selectedObjects=this.modelsToRemove;this.multiSelView.destroyDropDown();var G=[];if(enoviaServerCAWidget.isNative){for(var H=0;H<I.selectedObjects.length;H++){var J;J=I.selectedObjects[H].id;G.push(J.replace("pid:",""))}n.operationsToExplore=this.modelsToRemove;g.DispatchEventToWin("MultiSel_ExpInCtx_RealizedOperation_CmdChk",G)}else{this.multiSelView.buildMultisel(I)}}},onItemViewDrag:function(){var J={};J=this.buildStructureToDragForOperation(arguments);arguments[1]=J;var I=E.model.get("context");var H=[];I.forEach(function(L){var K=L.get("id");if(K){H.push(K.substr(4))}});var G={caId:E.model.get("id"),caContextIds:H,typeOfDrag:"Realized",};g.onItemViewDragForContents(arguments,G)},flowDownActivityObjects:function(){var H=arguments[0];if(H&&H.selectedIDs.length>0){var G={ids:H.selectedIDs,mode:H.flowdownMode,};E.flowDownSelectedItems(G)}},transferSelectedItems:function(){var H=arguments[0];if(H&&H.selectedIDs.length>0){var G={ids:H.selectedIDs,mode:H.transferMode,};E.TransferRealized(G)}}};this.listenTo(F,C);return F},buildStructureToDragForOperation:function(E){var D={};if(this.modelsToRemove.length){for(var B in this.modelsToRemove){var C=this.modelsToRemove[B];var F=null;if(C){D[C.get("id")]=C}}}else{D=E[1]}return D},AfterSaveTransReal:function(B){},_initSearchFilterView:function(){if(this.searchFilterView){this.searchFilterView.destroy()}var C=this.searchFilterView=new l({fromIDCard:false,collection:this.originalRealizedCollection,placeholder:d.ECM_CA_Searchby_NameTitle});var B=this._operationsEvents={keyup:function(D){this.refineRealized(D)}};this.listenTo(C,B)},refineRealized:function(B){var C=B.target.value;n.enteredText=C;this.filterRealized()},filterRealized:function(){if(this.filteredRealizedCollection&&this.filteredRealizedCollection.length){this.filteredRealizedCollection.reset()}var B=this.originalRealizedCollection.filter(this.filterNameBased);this.filteredRealizedCollection=new UWA.Class.Collection(B);var D=this.filteredRealizedCollection;var C=this.caTagNavigatorProxy;setTimeout(function(){if(C){C._setSubjectTags(D,"Realized")}},1000)},filterNameBased:function(B){var E=false;var H=B.get("objectName");var D=B.get("objectTitle");var F=n.enteredText;if(F&&F.length){if(H){H=H.toLowerCase()}if(D){D=D.toLowerCase()}F=F.toLowerCase();var C=H.indexOf(F);if(C<0){C=D.indexOf(F)}E=(C>=0)?true:false;if(n.filteredText===""){var G=B.get("activities");G.forEach(function(J){var I=J.get("OriginalActivityDetails");var K=[];I.forEach(function(P){if(E==true&&P.sameAsWhere){K.push(P)}else{var N=-1;if(P.AfterExists){var L=P.After;var Q=L.name;var M=L.title;if(Q){Q=Q.toLowerCase()}if(M){M=M.toLowerCase()}N=Q.indexOf(F);if(N<0){N=M.indexOf(F)}}if(N<0&&P.BeforeExists){var O=P.Before;var Q=O.name;var M=O.title;if(Q){Q=Q.toLowerCase()}if(M){M=M.toLowerCase()}N=Q.indexOf(F);if(N<0){N=M.indexOf(F)}}if(N>=0){K.push(P)}}});if(K.length>0){E=true}J.set("ActivityDetails",K,{silent:true})})}}if((F===undefined)||(F.length===0)){var G=B.get("activities");G.forEach(function(J){var I=J.get("OriginalActivityDetails");J.set("ActivityDetails",I,{silent:true})});E=true}if(E==true){return B}},filterActivityNameBased:function(C){var B=-1;return B},_initMultiSelView:function(){var B=this;var C={collection:new v(),withMultisel:true,useInfiniteScroll:false,usePullToRefresh:false,buildMultiselActions:function(D){return B.getMultiselActions(D)},events:{onMultiselOff:function(){var D=B;i.deactivateMultisel();B.modelsToRemove.splice(0,B.modelsToRemove.length);B.selectedOperationItems.splice(0,B.selectedOperationItems.length)},onMultiselOn:function(){i.activateMultisel()}}};if(this.multiSelView){this.multiSelView.destroy()}this.modelsToRemove.splice(0,this.modelsToRemove.length);this.selectedOperationItems.splice(0,this.selectedOperationItems.length);this.multiSelView=this.realizedMultiSelView=new u(C);n.multiSelView=this.multiSelView},getMultiselActions:function(G){var E=this;var F=[];if(UWA.is(G)){if(G.result!=""&&enoviaServerCAWidget.isNative){E.exploreRefIds=G.result.refPid;if(G.result.refPid!=null){F.push({accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:true,text:d.ECM_CA_Command_ExploreContext,handler:function(H){var I=[];var J=[];J=E.exploreRefIds;E.modelsToRemove.forEach(function(L,K){var M=L.get("id");if(M){M=M.replace("pid:","")}if(J.indexOf(M)>=0){I.push(L.get("id").replace("pid:",""))}});if(I.length>0&&I.length!=E.modelsToRemove.length){g.warn(d.ECM_CA_Warn_Multisel_ExpInCtx)}g.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",I)}})}}}F.push({id:"transfer",text:d.ECM_CA_Realized_Transfer,fonticon:"sync",icon:"transfer_realized_new",multisel:true,items:[{id:"Transfer_NewCA",text:d.ECM_CA_Realized_Transfer_NewCA,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:true,handler:function(K){if(E.modelsToRemove.length){var H=[];var J=[];E.modelsToRemove.forEach(function(M,L){if(M.get("Access")&&M.get("status")!="Transferred"){H.push(M.get("id"))}else{J.push(M.get("id"))}})}var I={ids:H,mode:"New",incorrectSelectedIds:J};E.TransferRealized(I)}},{id:"Transfer_existingca",text:d.ECM_CA_Realized_Transfer_ExistingCA,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:true,handler:function(K){if(E.modelsToRemove.length){var H=[];var J=[];E.modelsToRemove.forEach(function(M,L){if(M.get("Access")&&M.get("status")!="Transferred"){H.push(M.get("id"))}else{J.push(M.get("id"))}})}var I={ids:H,mode:"Existing",incorrectSelectedIds:J};E.TransferRealized(I)}},],});var C=E.model.get("userAccess");if(C&&C.FlowdownFrom==="true"&&enoviaServerCAWidget.CHG_FLOWDOWN!="false"){var B=[];B.push({id:"newca",text:d.ECM_CA_FLOWDOWN_ACTIONS_NEW_CHANGE_ACTION,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:true,handler:function(J){var H=[];if(E.modelsToRemove.length){E.modelsToRemove.forEach(function(L,K){H.push(L.get("id"))})}var I={ids:H,mode:"NewCA",};E.flowDownSelectedItems(I)}});B.push({id:"existingca",text:d.ECM_CA_FLOWDOWN_ACTIONS_EXISTING_CHANGE_ACTION,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:true,handler:function(J){var H=[];if(E.modelsToRemove.length){E.modelsToRemove.forEach(function(L,K){H.push(L.get("id"))})}var I={ids:H,mode:"Existing",};E.flowDownSelectedItems(I)}});F.push({id:"flowdown",text:d.ECM_CA_FLOWDOWN_ACTIONS,fonticon:"flow-down",icon:"I_InitiateFlowDown",multisel:true,items:B})}var D={id:"changematurity",text:d.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:true,handler:function(H){g.changeMaturity(H,E.model)}};if(window.enoviaServerCAWidget.CHG_CHANGE_MATURITY!="false"){F.push(D)}return F},domEvents:{"click .Realized-accordion-div":function(B){}},destroy:function(){this.modelsToRemove.splice(0,this.modelsToRemove.length);this.selectedOperationItems.splice(0,this.selectedOperationItems.length);this.stopListening();this.model=null;this._parent()},filterRealizedCollection:function(D,G,M,I){var K=[];var C=M.toArray();C.forEach(function(O){var N=false;if(D.indexOf(O.get("id"))>=0){N=true;var P=O.get("activities");P.forEach(function(R){var Q=R.get("OriginalActivityDetails");var S=[];Q.forEach(function(T){if(N&&T.sameAsWhere){S.push(T)}else{if(G.indexOf(T.taggerId)>=0){S.push(T)}}});if(S.length>0){N=true}R.set("ActivityDetails",S,{silent:true})})}if(O&&N){K.push(O)}});var J=this.filteredbyTaggerCollection=new UWA.Class.Collection(K);var L=document.querySelector(".Realized-operations-details");L.innerHTML="";this.operationView.destroy();var E=this.operationView=this._initOperationView(J);this.injectSubView(this.operationView,"."+this.name+"-Realizedoperation-container");if(this.filteredText){if(J){var F=this;J.forEach(function(P,N){var O=F.container.getElement("#Realized-accordion-div-inner-"+N);if(O){var Q=O.getElementsByTagName("span")[0].className;if(Q.indexOf("expand-right")>0){O.getElementsByTagName("span")[0].className=Q.replace("right","down").trim()}}i.expandTile(N)});var H=this.container.getElements(".fonticon-expand-right")}}var B=this.containerReference.getElement(".realized-counter-num");this.counterView.destroy();this._initCounterView(J);this.injectSubView(this.counterView,"."+this.name+"-RealizedCounter");this.realizedMultiSelView.destroy();this._initMultiSelView();this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel");this.selectedOperationItems.splice(0,this.selectedOperationItems.length);this.modelsToRemove.splice(0,this.modelsToRemove.length)},flowDownSelectedItems:function(D){var E=this;if(D&&D.ids.length>0){var F={ids:D.ids,contextCAId:E.model.get("id"),mode:D.mode,Entity:"ChangeAction",model:new UWA.Class.Model()};F.callback=E.AfterSaveTransReal;var C=new c(F);var B=new a();B.buildSlideIn(C);B.showSlideIn()}},})},OnSearchComplete:function(w){var y=w.replace(",","");var x=[];x.push(y);n._tempReferenceToWinSearchCallback(x)},calledFromNativeInterop:function(w){var x={};x.isActive=true;x.selectedObjects={selectedObjs:n.operationsToExplore,result:w,length:n.operationsToExplore.length};n.multiSelView.buildMultisel(x)},};return n});define("DS/ENOChangeActionUX/scripts/Views/CAViewCommon",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Views/CAModals","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/ENOChangeActionUX/scripts/CAUtility","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/SuperModal","DS/ENOChangeActionUX/scripts/CASpinner","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/CreateCAForm","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/ENO6WPlugins/jQuery"],function(m,j,f,i,a,h,e,b,l,k,d,g,n){var c={model:null,handleContextMenuClickRefresh:function(o){var p={};l.doWait(widget.body);p.onComplete=function(q){enoviaServerCAWidget.arrOid=[];l.endWait(widget.body)};o.fetch(p)},Refresh_Native:function(){var o=enoviaServerCAWidget.IDCard.model;c.handleContextMenuClickRefresh(o)},handleContextMenuClickCancel:function(o){c.model=o;j.clearModalValues();j.modalHeader=m.ECM_CA_Cancel;j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"html",fieldLabel:m.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:m.ECM_CA_Reason_placeholder_cancel,fieldClassName:"Cancel",fieldID:"Cancel",html:"<div id='CancelFormDiv'></div>"},]};var s="Cancel";var q=c.createReasonInputElem(s);var p=j._createModal();p.inject(widget.body).show();p.elements.footer.childNodes[0].addEventListener("click",function(){c.SetOnCancel(p)});var t=i.extendElement(document.body).getElement("#CancelFormDiv");if(t!=null){t.innerHTML="";q.inject(t)}var r=document.getElementById("Cancel_Reason");if(r){r.focus()}},SetOnCancel:function(s){var r=i.extendElement(document.body).getElements(".reason_input");if(r[0].value==""){r[0].getParent(".form-group").addClassName("has-error");a.warn(m.ECM_CA_ReasonMissing_error)}else{var q=c.model.id;var t=a.sanitizeText(r[0].value);var p="/resources/modeler/change/changeaction/"+q+"/cancel?reason="+t;var o="";var u=function(w,v){a.error(m.ECM_CA_Action_Cancel_Failed)};a.makeWSCall(p,"PUT","enovia","application/json",o,c.onCancelCompleteCallback,null);s.destroy()}},onCancelCompleteCallback:function(p){var o="Cancelled";c.model.set("current",o)},handleContextMenuClickCOEdit:function(p){c.model=p;a.CurrModel=p;var r=null;j.clearModalValues();j.modalHeader=m.ECM_CA_Action_ChangeOrder_Edit;j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"html",fieldLabel:"Change Order",fieldValue:"",fieldPlaceHolder:m.ECM_CA_Action_ChangeOrder_Edit_placeholder_comment,fieldClassName:"ChangeOrder",fieldID:"ChangeOrder",html:"<div id='COEditFormDiv'></div>"}]};r=j._createModal();var q=c.createSearchInputElem("ChangeOrder",r);r.inject(widget.body).show();r.elements.footer.childNodes[0].addEventListener("click",function(){c.AssignCO(r)});r.elements.footer.childNodes[0].disabled=true;var o=i.extendElement(document.body).getElement("#COEditFormDiv");if(o!=null){o.innerHTML="";q.inject(o)}if(UWA.is(c.model.get("changeOrderId"))&&c.model.get("changeOrderId")!=""){i.extendElement(document.body).getElement("#ChangeOrder").value=c.model.get("changeOrderName")}},AssignCO:function(u){var t="";var r=i.extendElement(document.body).getElement("#ChangeOrder_hidden");if(r.value==""){j.message("No Change Order selected","error")}else{t=r.value}var s=JSON.stringify({version:"v0",changeaction:{modify:{},add:{}}});if(t!=""){t="pid:"+t;var w=JSON.parse(s);var o=false;if(UWA.is(c.model.get("changeOrderId"))&&c.model.get("changeOrderId")!=""){o=true}if(o){w.changeaction.modify.changeorder=t}else{w.changeaction.add.changeorder=t}s=JSON.stringify(w)}var v=c.model.id;var p=function(x){c.onCompleteAssignCO(x);l.endWait(widget.body)};var q=function(x){l.endWait(widget.body);a.error(m.ECM_CA_Action_ChangeOrder_Edit_Failure)};this.AssignCO.onCompleteCallback=p;this.AssignCO.onFailureCallback=q;l.doWait(widget.body);a.editCA(s,v,p,q);if(u){u.destroy()}},onCompleteAssignCO:function(p){var o=p.changeaction;c.model.set("changeOrderName",o.changeorder.info["display name"]);c.model.set("changeOrderId",o.changeorder.id)},handleContextMenuClickTransfer:function(q){c.model=q;a.CurrModel=q;j.clearModalValues();j.modalHeader=m.ECM_CA_TransferOwnership_label;j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"html",fieldLabel:m.ECM_CA_NewOwner_label,fieldValue:"",fieldPlaceHolder:m.ECM_CA_NewOwner_placeholder,fieldClassName:"Transferee",fieldID:"Transferee",html:"<div id='TransferFormDiv'></div>"},]};var p="Transferee";var u="Transfer";var s=c.createSearchAndReasonInputElem(p,u);var r=j._createModal();r.inject(widget.body).show();r.elements.footer.childNodes[0].addEventListener("click",function(){c.SetOnTransfer(r)});var o=i.extendElement(document.body).getElement("#TransferFormDiv");if(o!=null){o.innerHTML="";s.inject(o)}var t=document.getElementById("Transfer_Reason");if(t){t.focus()}},createSearchAndReasonInputElem:function(o,r){var p=c.createSearchInputElem(o);var s=c.createReasonInputElem(r);var q=UWA.createElement("div",{});if(p){p.inject(q)}if(s){s.inject(q)}return q},createSearchInputElem:function(o,q){var r,s="";if(o==="ChangeOrder"){s=m.ECM_CA_ChangeOrder;r=m.ECM_CA_Action_ChangeOrder_Edit_placeholder_comment}else{if(o==="Transferee"){s=m.ECM_CA_NewOwner_label;r=m.ECM_CA_NewOwner_placeholder}}var p=UWA.createElement("div",{id:"NewOwnerDiv",html:[{tag:"div","class":"label-container",html:[{tag:"h5",html:s},{tag:"span","class":"mand-asterisk fonticon fonticon-asterisk-alt",}]},{tag:"span","class":"flexAlignField",html:{tag:"div","class":"searchfilter-input-container",html:[{tag:"input","class":"form-control form-control-root filtertext",id:o,placeholder:r,readonly:"true"},{tag:"span","class":"cancel-span",html:c.createCancelBtnSpan(o)},{tag:"span","class":"search-span",html:c.createSearchBtnSpan(o,q)},{tag:"input",type:"hidden",name:o+"_hidden",id:o+"_hidden",value:"",}]},}]});return p},createReasonInputElem:function(q){var p="";if(q==="Transfer"){p=m.ECM_CA_Reason_placeholder_transfer}else{if(q==="Cancel"){p=m.ECM_CA_Reason_placeholder_cancel}else{if(q==="Hold"){p=m.ECM_CA_Reason_placeholder_hold}else{if(q==="Resume"){p=m.ECM_CA_Reason_placeholder_resume}}}}var o=UWA.createElement("div",{id:"ReasonDiv",html:[{tag:"div","class":"label-container",html:[{tag:"h5",html:m.ECM_CA_Reason_label,},{tag:"span","class":"mand-asterisk fonticon fonticon-asterisk-alt",}]},(new e({label:"Reason",id:q+"_Reason",className:"reason_input form-control",value:"",required:true,multiline:true,rows:3,placeholder:p,events:{onChange:c.reasonChange}}))]});return o},createSearchBtnSpan:function(p,s){var r,q,u="";var o=null;if(p==="ChangeOrder"){r="Add_CO",q="Change Order",u="ChangeOrder";o=a.activateSearch(q,u)}else{if(p==="Transferee"){r="Add_Member",q="Person",u="TransferOwnership";o=a.activateSearch(q,u)}}var t=UWA.createElement("span",{"class":"default fonticon fonticon-search",id:"Search_"+p+"_btn",});t.set({events:{click:function(v){if(enoviaServerCAWidget.isNative){a.DispatchEventToWin(r,p+"_Edit")}else{a.search(p,q,function(w){if(p==="ChangeOrder"){s.elements.footer.childNodes[0].disabled=false;a.populateCOSearchResults(p+"_Edit",w,false)}else{if(p==="Transferee"){a.populateSearchResults(p+"_Edit",w,false)}}var x=n("#transfercancel");var y=n("#Search_"+p+"_btn");if(x){x.css("visibility","visible");x.css("display","block")}if(y){y.css("display","none")}},u,o)}}}});return[{html:t}]},createCancelBtnSpan:function(o){var p=UWA.createElement("span",{"class":"clear-filter fonticon fonticon-cancel-circled",id:"transfercancel",});p.set({events:{click:function(t){var s=n("#"+o);if(s){s.val("")}var q=n("#transfercancel");var r=n("#Search_"+o+"_btn");if(q){q.css("visibility","hidden");q.css("display","none")}if(r){r.css("display","block")}if(o==="ChangeOrder"){modalObject.elements.footer.childNodes[0].disabled=true}}}});return[{html:p}]},reasonChange:function(){var o=i.extendElement(document.body).getElement("#Reason");if(o&&o.value){o.style.borderColor="#0099cc"}else{if(o){o.style.borderColor="#d0432b"}}},SetOnTransfer:function(x){var p=x.elements.body.childNodes[0];var s=i.extendElement(document.body).getElements(".reason_input");if(s[0].value==""){s[0].getParent(".form-group").addClassName("has-error");a.warn(m.ECM_CA_ReasonMissing_error)}else{var o=i.extendElement(document.body).getElements("#Transferee_hidden");if(o[0].value==""){a.warn(m.ECM_CA_OwnerMissing_error)}else{var v=o[0].value;var r=a.sanitizeText(s[0].value);var y=c.model.id;var w="/resources/modeler/change/changeaction/"+y+"/transferownership?newOwner="+v+"&reason="+r;var u="";var q=function(z){c.onTransferCompleteCallback(v)};var t=function(A,z){a.error(m.ECM_CA_Action_Transfer_Failed)};a.makeWSCall(w,"PUT","enovia","application/json",u,q,null);x.destroy()}}},onTransferCompleteCallback:function(p){var o=[];o.push(p);a.getUserDisplayNameByPromise(o).then(function(r){var q={};c.model.fetch(q);return Promise.resolve(true)},function(q){return Promise.reject(q)})},handleContextMenuClickHold:function(o){c.model=o;j.clearModalValues();j.modalHeader=m.ECM_CA_Hold_label;j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"html",fieldLabel:m.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:m.ECM_CA_Reason_placeholder_hold,fieldClassName:"Hold",fieldID:"Hold",html:"<div id='HoldFormDiv'></div>"},]};var s="Hold";var q=c.createReasonInputElem(s);var p=j._createModal();p.inject(widget.body).show();p.elements.footer.childNodes[0].addEventListener("click",function(){c.SetOnHold(p)});var t=i.extendElement(document.body).getElement("#HoldFormDiv");if(t!=null){t.innerHTML="";q.inject(t)}var r=document.getElementById("Hold_Reason");if(r){r.focus()}},SetOnHold:function(s){var r=i.extendElement(document.body).getElements(".reason_input");if(r[0].value==""){r[0].getParent(".form-group").addClassName("has-error");a.warn(m.ECM_CA_ReasonMissing_error)}else{var q=c.model.id;var t=a.sanitizeText(r[0].value);var p="/resources/modeler/change/changeaction/"+q+"/setOnHold?reason="+t;var o="";var u=function(w,v){a.error(m.ECM_CA_Action_SetOnHold_Failed)};a.makeWSCall(p,"PUT","enovia","application/json",o,c.onHoldCompleteCallback,null);s.destroy()}},onHoldCompleteCallback:function(p){var o="true";c.model.set("holdValue",m.ECM_CA_State_On_Hold);c.model.set("holdStatus",o);c.model.set("TableStateVal",m.ECM_CA_State_On_Hold)},handleContextMenuClickResume:function(o){c.model=o;j.clearModalValues();j.modalHeader=m.ECM_CA_Resume_label;j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"html",fieldLabel:m.ECM_CA_Reason_label,fieldValue:"",fieldPlaceHolder:m.ECM_CA_Reason_placeholder_resume,fieldClassName:"Resume",fieldID:"Resume",html:"<div id='ResumeFormDiv'></div>"},]};var s="Resume";var q=c.createReasonInputElem(s);var p=j._createModal();p.inject(widget.body).show();p.elements.footer.childNodes[0].addEventListener("click",function(){c.SetResume(p)});var t=i.extendElement(document.body).getElement("#ResumeFormDiv");if(t!=null){t.innerHTML="";q.inject(t)}var r=document.getElementById("Resume_Reason");if(r){r.focus()}},SetResume:function(s){var r=i.extendElement(document.body).getElements(".reason_input");if(r[0].value==""){r[0].getParent(".form-group").addClassName("has-error");a.warn(m.ECM_CA_ReasonMissing_error)}else{var q=c.model.id;var t=a.sanitizeText(r[0].value);var p="/resources/modeler/change/changeaction/"+q+"/resume?reason="+t;var o="";var u=function(w,v){a.error(m.ECM_CA_Action_Resume_Failed)};a.makeWSCall(p,"PUT","enovia","application/json",o,c.onResumeCompleteCallback,null);s.destroy()}},onResumeCompleteCallback:function(p){var o=null;c.model.set("holdValue","");c.model.set("holdStatus",o);c.model.set("TableStateVal",m.get("ECM_CA_State_"+c.model.get("current")))},handleContextMenuClickWorkUnder:function(p){c.model=p;var r=c.model.id;var o="/resources/modeler/change/changeaction/"+r+"?editability=1";var t=function(v,u){a.error(m.ECM_CA_Action_WorkUnder_Forbidden)};var s=function(y){var u=y.changeaction;if(u.editability){c.model._attributes.editability=u.editability;if(u.editability.work_under=="allowed"){var v="Work_Under";var x="TRUE";if(enoviaServerCAWidget.isPoweredBy){var w={operation:"Work_Under",operationVersion:"1.0",content:{id:r.replace("pid:","")}};k.publish("webinwin:web:notification",JSON.stringify(w))}else{a.DispatchEventToWin(v,x)}}else{a.error(m.ECM_CA_Action_WorkUnder_Forbidden)}}};this.handleContextMenuClickWorkUnder.onCompleteCallback=s;this.handleContextMenuClickWorkUnder.onFailureCallback=t;var q="";a.makeWSCall(o,"GET","enovia","application/json",q,s,t,false)},handleContextMenuClickApproveOrReject:function(o,r){c.model=o;var q="";j.clearModalValues();if("Approve"==r){j.modalHeader=m.ECM_CA_Approve_label;q=m.ECM_CA_Approval_placeholder_comment}else{j.modalHeader=m.ECM_CA_Reject_label;q=m.ECM_CA_Rejection_placeholder_comment}j.modalFooterButtons={buttons:[{buttonValue:m.ECM_CA_Button_Done,buttonEvent:""},{buttonValue:"Cancel",buttonEvent:""}]};j.modalBody={mBody:[{fieldType:"textarea",fieldLabel:m.ECM_CA_Comment_label,fieldValue:"",fieldPlaceHolder:q,fieldClassName:"reason_input",fieldRows:"3"}]};var p=j._createModal();p.inject(widget.body).show();n(".reason_input")[0].focus();p.elements.footer.childNodes[0].addEventListener("click",function(){c.SetApproveOrReject(p,o,r)})},handleContextMenuClickAcceptTask:function(r){var p=r.get("inboxTaskId");var q="/resources/modeler/change/inboxtask/accept/"+p;var o="";var s=function(u){var t={};r.fetch(t);a.success(m.ECM_CA_Task_Accept_Success);l.endWait(widget.body)};l.doWait(widget.body);a.makeWSCall(q,"PUT","enovia","*/*",o,s,null)},handleOpenCurrentCA:function(o){c.model=o;var q=c.model.id;q=q.replace("pid:","");var p="ExploreInCollabNApproval";var r="TRUE";a.DispatchEventToWin(p,q)},SetApproveOrReject:function(v,x,t){var p=i.extendElement(document.body).getElements(".reason_input");var o=x.get("inboxTaskId");if(p[0].value==""){p[0].getParent(".form-group").addClassName("has-error");a.warn(m.ECM_CA_CommentsMissing_error)}else{var w=c.model.id;var s="/resources/modeler/change/inboxtask/pid="+o;var r=JSON.stringify({action:t,comments:a.sanitizeText(p[0].value)});var q=function(z,y){("Approve"==t)?a.error(m.ECM_CA_Action_Approve_Failed):a.error(m.ECM_CA_Action_Reject_Failed)};var u=function(z){l.endWait(widget.body);var y={};x.fetch(y)};this.SetApproveOrReject.onSuccessfullCallback=u;l.doWait(widget.body);a.makeWSCall(s,"PUT","enovia","application/json",r,u,null);v.destroy()}},handleContexualMenuClickEBOMSync:function(r){c.model=r;var q=c.model.id;var p="/resources/modeler/change/changeaction/"+q+"/synchronize";var o="";var s=function(u,t){a.error(m.ECM_CA_Action_EBOMSync_Failed)};a.makeWSCall(p,"PUT","enovia","application/json",o,c.onEBOMSyncCompleteCallback,null)},onEBOMSyncCompleteCallback:function(s){var p=new b({closable:true,renderTo:widget.body});var r="";var o="";var q="";if(s&&s.OPERATION_STATUS==="true"){q=m.ECM_CA_EBOMSync_Successful}else{if(s&&s.OPERATION_STATUS==="false"){q=m.ECM_CA_EBOMSync_Failure}}r="<p>                                <!--h6>"+o+"</h6-->                                <ul>                                    <li>"+q+"</li>                                </ul>                            </p>";p.dialog({body:r,title:m.ECM_CA_Action_EBOMSync_CollabStatus,buttons:[{className:"primary",value:m.ECM_CA_Collab_Dialog_Done,action:function(t){t.hide()}}]})},getUserActions:function(q){var p=[];if(q.get("current")!="Cancelled"){var o=q.get("userAccess");var r=q.get("holdStatus");p.push({text:m.ECM_CA_Action_Refresh,icon:"arrows-ccw",handler:function(s){c.handleContextMenuClickRefresh(this.model)}});if(UWA.is(r)&&r=="true"){if(o.Resume==="true"){p.push({text:m.ECM_CA_Action_Resume,icon:"play",handler:function(s){c.handleContextMenuClickResume(this.model)}})}}else{if(o.Edit==="true"){p.push({text:m.ECM_CA_Action_ChangeOrder_Edit,icon:"link",handler:function(s){c.handleContextMenuClickCOEdit(this.model)}})}if(o.Hold==="true"){p.push({text:m.ECM_CA_Action_Hold,icon:"pause",handler:function(s){c.handleContextMenuClickHold(this.model)}})}if(o.Cancel==="true"){p.push({text:m.ECM_CA_Action_Cancel,icon:"cancel",handler:function(s){c.handleContextMenuClickCancel(this.model)}})}if(o.Transfer==="true"&&window.enoviaServerCAWidget.CHG_TRANSFER_OWNERSHIP!="true"){p.push({text:m.ECM_CA_Action_Transfer,icon:"user-change",handler:function(s){c.handleContextMenuClickTransfer(this.model)}})}if(o.Transfer==="true"&&window.enoviaServerCAWidget.CHG_TRANSFER_OWNERSHIP=="true"){p.push({text:m.ECM_CA_Action_Transfer,icon:"user-change",handler:function(s){c.handleContextMenuClickTransferOwnership(this.model)}})}if(o.Approve==="true"&&q.get("approveOrRejectIcon")){p.push({text:m.ECM_CA_Approve_label,icon:"thumbs-up",handler:function(s){c.handleContextMenuClickApproveOrReject(this.model,"Approve")}})}if(o.Reject==="true"&&q.get("approveOrRejectIcon")){p.push({text:m.ECM_CA_Reject_label,icon:"thumbs-down",handler:function(s){c.handleContextMenuClickApproveOrReject(this.model,"Reject")}})}if(o.Approve==="true"&&q.get("acceptTaskIcon")&&q.get("showAcceptTask")){p.push({text:m.ECM_CA_Accept_label,icon:"check",handler:function(s){c.handleContextMenuClickAcceptTask(this.model)}})}if(o.WorkUnder=="true"&&(enoviaServerCAWidget.isNative||enoviaServerCAWidget.isPoweredBy)){p.push({text:m.ECM_CA_Action_WorkUnder,icon:"hardhat",handler:function(s){c.handleContextMenuClickWorkUnder(this.model)}})}if(o.Synchronization=="true"){p.push({text:m.ECM_CA_EBOM_Sync_Action,icon:"change-action-sync",handler:function(s){c.handleContexualMenuClickEBOMSync(this.model)}})}if(enoviaServerCAWidget.isNative){p.push({text:m.ECM_CA_Action_OpenCurrentCA,icon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-in-a-new-window",handler:function(s){c.handleOpenCurrentCA(this.model)}})}}}return p},getattributesMapping:function(){return{title:"title",ownerName:"ownerName",description:"lifecycleHTML",}},handleContextMenuClickTransferOwnership:function(p){var o={_selectedItems:[],getSelectedNodes:function(){return this._selectedItems},addSelection:function(s,u){(true)?this._selectedItems=[]:null;var t=this;if(UWA.is(s,"array")){s.forEach(function(v){t._selectedItems.push(v)})}else{t._selectedItems.push(s)}},getReference:function(s){return getID()},getParent:function(s){return s.getParent()},getType:function(s){return getType()},getName:function(s){return getLabel()}};var q=UWA.extend(p,{getID:function(){return p.get("id").substring(4)},getLabel:function(){return p.get("Name")},getOwner:function(){return p.get("owner")},getType:function(){return p.get("type")},getDisplayName:function(){return p.get("name")},object:{revision:p.get("version")}});o.addSelection(q);var r=new g({context:o,ID:"ActionBar_ChangeOwner"});r.begin()}};return c});define("DS/ENOChangeActionUX/scripts/CANativeInterop",["DS/ENOChangeActionUX/scripts/Views/CAViewCommon","DS/ENOChangeActionUX/scripts/Views/CAContextView","DS/ENOChangeActionUX/scripts/Views/CAReferentialView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Controller/CADependencyController","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/ENOChangeActionUX/scripts/Views/CASlideInPropertiesView","DS/ENOChangeActionUX/scripts/CATagNavigatorProxy","DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(f,l,e,k,m,b,i,g,j,h,a,o,p,d,n){var c={CurrModel:null,ContextMenu:{},Refresh_Native:function(){f.handleContextMenuClickRefresh(enoviaServerCAWidget.IDCard.model)},OnSearchComplete:function(q,r){var s="";switch(r){case"Context":s=l;break;case"Referential":s=e;break;case"ProposedChange":s=m;break;case"Add_Dependency":s=g;break;case"SearchCA":s=i;break}if(s!=""){s.OnSearchComplete(q)}},drop_Native:function(q){if(UWA.is(q)&&UWA.is(q.where)){var r=""}switch(q.where){case"Context":r=l;break;case"Referential":r=e;break;case"Proposed":r=m;break}if(r!=""){r.ExecuteDrop(q)}},GetMultiselContextMenu:function(q){if(UWA.is(q)){if(q!=""&&UWA.is(q.MultiselectOwnerComp)){if(q.MultiselectOwnerComp=="RealizedActivity_CmdChk"){d.calledFromNativeInterop(q)}else{if(q.MultiselectOwnerComp=="RealizedOperation_CmdChk"){i.calledFromNativeInterop(q)}else{if(q.MultiselectOwnerComp=="ProposedOperation_CmdChk"){m.calledFromNativeInterop(q)}}}}}},GetContextMenu:function(q){if(UWA.is(q)&&UWA.is(q.where)){var u=""}switch(q.where){case"Context":u=l;break;case"Referential":u=e;break;case"Proposed":u=h;break;case"Realized":u=j;break}if(u!=""){c.ContextMenu.pid=q.pid;var s=[];if(!UWA.is(c.ContextMenu.explore)){c.ContextMenu.explore={accelerator:"Ctrl+E",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmSendToNewVPMCmdRoot",icon:"I_SendToVPMNavigator",multisel:true,text:n.ECM_CA_Command_Explore,handler:function(v){b.DispatchEventToWin("Explore",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.exploreInPPR)){c.ContextMenu.exploreInPPR={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:true,text:n.ECM_CA_Command_ExploreMfg,handler:function(v){b.DispatchEventToWin("ExploreInPPR",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.exploreInRFLP)){c.ContextMenu.exploreInRFLP={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:true,text:n.ECM_CA_Command_ExploreSys,handler:function(v){b.DispatchEventToWin("ExploreInRFLP",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.exploreInCentral)){c.ContextMenu.exploreInCentral={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:true,text:n.ECM_CA_Command_Explore3DSpace,handler:function(v){b.DispatchEventToWin("ExploreInCollabNApproval",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.exploreParents)){c.ContextMenu.exploreParents={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:true,text:n.ECM_CA_Command_ExploreParents,handler:function(v){b.DispatchEventToWin("ExploreParents",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.exploreinContext)){c.ContextMenu.exploreinContext={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:true,text:n.ECM_CA_Command_ExploreContext,handler:function(v){if(j.itemView.Instanceid){b.DispatchEventToWin("ExploreinContext",j.itemView.Instanceid)}else{b.DispatchEventToWin("ExploreinContext",c.ContextMenu.pid)}}}}if(!UWA.is(c.ContextMenu.Open)){c.ContextMenu.Open={accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:true,text:n.ECM_CA_Command_Open,handler:function(v){b.DispatchEventToWin("Open",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.OpenCA)){c.ContextMenu.OpenCA={accelerator:"Ctrl+I",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenCAFromCA",icon:"I_OpenDB",multisel:true,text:n.ECM_CA_Command_Open,handler:function(v){b.DispatchEventToWin("OpenCA",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.openAdv)){c.ContextMenu.openAdv={accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:true,text:n.ECM_CA_Command_OpenAdv,handler:function(v){b.DispatchEventToWin("OpenAdv",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.openRO)){c.ContextMenu.openRO={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenInSideWaySession",icon:"I_OpenInReadOnly",multisel:true,text:n.ECM_CA_Command_OpenRO,handler:function(v){b.DispatchEventToWin("OpenReadOnly",c.ContextMenu.pid)}}}if(!UWA.is(c.ContextMenu.Properties)){c.ContextMenu.Properties={accelerator:"Alt+Enter",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ImmSearchProperty",icon:"I_Properties",multisel:true,text:"Native_Properties",handler:function(v){b.DispatchEventToWin("Properties",c.ContextMenu.pid)}}}var r={accelerator:"",availabilityMode:null,id:null,icon:null,items:c.GetSupportedExploreCommands(q),multisel:true,text:n.ECM_CA_Command_ExploreWith};var t={accelerator:"",availabilityMode:null,id:null,icon:null,items:c.GetSupportedOpenCommands(q),multisel:true,text:n.ECM_CA_Command_OpenWith};if(q.hasOwnProperty("explore")){s.push(c.ContextMenu.explore)}if(r.items.length>0){s.push(r)}if(q.hasOwnProperty("open")){s.push(c.ContextMenu.Open)}if(q.hasOwnProperty("openCA")){s.push(c.ContextMenu.OpenCA)}if(t.items.length>0){s.push(t)}u.DisplayContextMenu(s)}},GetSupportedExploreCommands:function(r){var q=[];["exploreInRFLP","exploreInPPR","exploreParents","exploreinContext"].forEach(function(s){if(r.hasOwnProperty(s)&&c.ContextMenu.hasOwnProperty(s)){q.push(c.ContextMenu[s])}});return q},GetSupportedOpenCommands:function(r){var q=[];["exploreInCentral","openAdv","openRO"].forEach(function(s){if(r.hasOwnProperty(s)&&c.ContextMenu.hasOwnProperty(s)){q.push(c.ContextMenu[s])}});return q},onFilterChange:function(s){var r=Number(window.enoviaServerCAWidget.IDCard.getSelectedFacet());var q=b.getTaggerObject(r);if(q){q.onFilterChange(s.data)}},onFocus:function(){var r=Number(window.enoviaServerCAWidget.IDCard.getSelectedFacet());var q=b.getTaggerObject(r);if(q){q.activateTaggerProxy()}},onUnFocus:function(s){var r=Number(window.enoviaServerCAWidget.IDCard.getSelectedFacet());var q=b.getTaggerObject(r);if(q){q.deactivateTaggerProxy()}},KillProxies:function(r){var q=Number(window.enoviaServerCAWidget.IDCard.getSelectedFacet());b.killTaggerProxies(-1)}};return c});define("DS/ENOChangeActionUX/scripts/CAIDCard",["DS/W3DXComponents/IdCard","DS/ENOChangeActionUX/scripts/Views/CAIDCardView","DS/ENOChangeActionUX/scripts/Views/CANewTeamView","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Views/CAReferentialView","DS/ENOChangeActionUX/scripts/Views/CAApplicabilityView","DS/ENOChangeActionUX/scripts/Views/CAContextView","DS/ENOChangeActionUX/scripts/Views/CADependeciesView","DS/ENOChangeActionUX/scripts/Views/CAProcessStepsView","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/Views/CAViewCommon","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Models/CAModel","DS/ENOChangeActionUX/scripts/CreateCAForm","DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Core"],function(p,h,r,e,o,m,f,g,j,s,i,l,b,k,q,d,n,a){var c={CurrModel:null,FacetViews:[],getRendererMap:function(v,u){c.Flush();c.skeletonContainer=a.extendElement(document.body).getElement("#skeleton-container");var y="title";var w=[];var x=0;if(enoviaServerCAWidget.CHG_CA_PROCESS_STEPS==="true"){w.push({name:x.toString(),text:b.ECM_CA_Process_Step_Facet_Name,icon:"step-0",handler:function(){var z=s._createView_ProcessSteps(false);c.BuildView(this.getSelectedFacet(),"ProcessStepView",z)}});x++}w.push({name:x.toString(),text:b.ECM_CA_Properties,icon:"newspaper",handler:function(){var z=h._createView_IdCard("div","generic-detail",true,this.model);c.BuildView(this.getSelectedFacet(),"IDCardView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_Team,icon:"users",handler:function(){c.BuildView(this.getSelectedFacet(),"TeamView",r)}});x++;w.push({name:x.toString(),text:b.ECM_CA_ProposedChanges,icon:"change-action-proposed",handler:function(){var z=e._createView_TestProposed("div","test-proposed-facet",true,this.model);c.BuildView(this.getSelectedFacet(),"ProposedView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_RealizedChanges,icon:"change-action-realized",handler:function(){var z=o._createView_NewRealized("div","test-realized-facet",true,this.model,u);c.BuildView(this.getSelectedFacet(),"RealizedView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_Referential_label,icon:"link",handler:function(){var z=m._createView_Referential(true,this.model);c.BuildView(this.getSelectedFacet(),"ReferentialView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_App_Context_label,icon:"evolution-effectivity",handler:function(){var z=f._createView_Applicability(true,this.model);c.BuildView(this.getSelectedFacet(),"ApplicabilityView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_Proposed_Change_Context,icon:"3d-object",handler:function(){var z=g._createView_Context(true,this.model);c.BuildView(this.getSelectedFacet(),"ContextView",z)}});x++;w.push({name:x.toString(),text:b.ECM_CA_DEPENDENCY_TITLE,icon:"dependencies",handler:function(){c.BuildView(this.getSelectedFacet(),"DependencyView",j)},});var t={model:c.CreateModel(v,u.transientCAPid),thumbnailUrl:function(){return this.get("image")},attributesMapping:{title:y,ownerName:"ownerName",description:"lifecycleHTML",},actions:function(){if(this.get("userAccess")!=null){return l.getUserActions(this)}},facets:w,events:{onRender:function(){console.info("<--- onRender --->")},onFacetSelect:function(z,A){if(z==="0"){if(enoviaServerCAWidget.PropWidget){setTimeout(function(){enoviaServerCAWidget.PropWidget.onResize()},100)}}z=parseInt(z);A=parseInt(A);i.activateDeactiveTaggerProxies(z,A)},}};return t},CreateModel:function(u,w){var v=new k({id:w,lifecycleHTML:"<span id ='lifecycleSpan'></span>"});var t={};v.fetch(t);c.CurrModel=v;return v},BuildView:function(w,y,u){w=parseInt(w);c.HideAllViews();if(c.FacetViews&&c.FacetViews[w]==null){var t=new UWA.Element("div");t.setAttributes({id:y});t.setStyle("height","calc(100% - 150px)");var x=null;if(y==="TeamView"||y==="DependencyView"){var v={model:c.CurrModel};var x=new u(v)}else{var x=new (u);x.model=c.CurrModel}x.container=t;t.addContent(x.render());c.FacetViews[w]=t;c.skeletonContainer.addContent(c.FacetViews[w])}else{if(c.FacetViews&&c.FacetViews[w]!=null){c.FacetViews[w].show()}}},HideAllViews:function(){c.FacetViews.forEach(function(t){if(UWA.is(t)){t.hide()}})},Flush:function(){c.FacetViews=[null,null,null,null,null,null,null,null]}};return c});define("DS/ENOChangeActionUX/scripts/CreateCAForm",["DS/UIKIT/Input/Text","UWA/Core","UWA/Date","DS/UIKIT/Form","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/UIKIT/Modal","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Date","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/Models/CAModel","DS/ENOChangeActionUX/scripts/CAIDCard","DS/ENOChangeActionUX/scripts/Views/CAIDCardView","DS/W3DXComponents/IdCard","DS/ENO6WPlugins/jQuery"],function(c,k,o,h,i,p,m,l,f,n,a,g,d,j,e,q){var b={CACreateModal:undefined,severityButtonGroup:null,currentModelObjectForRefresh:undefined,createOrEditFlag:true,calendarOnClickDueDate:function(s){var r=k.extendElement(document.body).getElement("#DueDate");r.click()},pushFormContentOnHide:function(){b.formFieldContent.reset();b.formFieldContent.unvalidate()},dueDateOnChange:function(){var t=k.extendElement(document.body).getElement("#DueDate");var s=k.extendElement(document.body).getElement("#DueDate_hidden");if(t.value){var u="%m/%d/%Y";s.value=o.strftime(this.getDate(),u);u="%Y-%m-%d";t.value=o.strftime(this.getDate(),u)}else{t.value="";s.value=""}var r=q("#duedatecancel");var v=q("#calenderspan");if(r){r.css("display","block");r.css("visibility","visible")}if(v){v.css("display","none")}},createBody:function(){var r=UWA.createElement("div",{html:[{tag:"div",id:"AbstractDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div","class":"label-container",html:[{tag:"h5",html:p.ECM_CA_Abstract},{tag:"span","class":"mand-asterisk fonticon fonticon-asterisk-alt",}]},{tag:"div",html:UWA.createElement("div",{"class":"form-group",html:b.createTextField("Abstract")})}]},{tag:"div",id:"DescriptionDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div","class":"label-container",html:[{tag:"h5",html:p.ECM_CA_Description},{tag:"span","class":"mand-asterisk fonticon fonticon-asterisk-alt",}]},{tag:"div",html:UWA.createElement("div",{"class":"form-group",html:b.createTextField("Description")})}]},{tag:"div",id:"SeverityDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"h5",html:p.ECM_CA_Severity},{tag:"div",html:UWA.createElement("div",{"class":"form-group",html:(b.severityButtonGroup=new l({type:"radio",name:"Severity",id:"Severity",buttons:[new i({value:p.ECM_CA_Severity_Low,id:"Low",className:"success small",active:true}),new i({value:p.ECM_CA_Severity_Medium,id:"Medium",className:"warning small"}),new i({value:p.ECM_CA_Severity_High,id:"High",className:"error small"})]}))})}]},{tag:"div",id:"DueDateDiv",html:[{tag:"h5",html:p.ECM_CA_DueDate},{tag:"span","class":"due-date-span",html:b.createDueDateElem()},{tag:"input",type:"hidden",name:"DueDate_hidden",id:"DueDate_hidden",value:"",}]}]});return r},createTextField:function(r){var s=new c({name:r,id:r,className:"mandatory_input",value:"",multiline:r==="Abstract"?false:true,rows:r==="Abstract"?1:2,required:true,placeholder:r==="Abstract"?p.ECM_CA_Abstract_PlaceHolder:p.ECM_CA_Description_PlaceHolder,});s.elements.input.onkeyup=function(){var t=b.formFieldContent.getValue("Abstract");var u=b.formFieldContent.getValue("Description");if(t!=""&&u!=""){b.doneBtn.elements.input.disabled=false;b.doneBtn.elements.input.removeClassName("disabled")}else{b.doneBtn.elements.input.disabled=true;b.doneBtn.elements.input.addClassName("disabled")}};return s},createDueDateElem:function(){var r=UWA.createElement("span",{"class":"date-input-container",html:[(new f({name:"DueDate",id:"DueDate",required:false,min:new Date(),value:"",placeholder:p.ECM_CA_Date_PlaceHolder,events:{onChange:b.dueDateOnChange}})),{tag:"span","class":"cancel-span",html:b.createCancelBtnSpan()},{tag:"span","class":"calendar-span",html:b.createCalenderSpan()},]});return[{styles:{border:"1px solid #b4b6ba","border-radius":"5px",display:"flex","background-color":"#f4f5f6",},html:r}]},createCalenderSpan:function(){var r=UWA.createElement("span",{"class":"fonticon fonticon-calendar",id:"calenderspan",});r.set({events:{click:function(t){var s=k.extendElement(document.body).getElement("#DueDate");s.click()}}});return[{html:r}]},createCancelBtnSpan:function(){var r=UWA.createElement("span",{"class":"clear-filter fonticon fonticon-cancel-circled",id:"duedatecancel",});r.set({events:{click:function(u){var t=q("#DueDate");var w=q("#DueDate_Hidden");if(t){t.val("")}if(w){w.val("")}var s=q("#duedatecancel");var v=q("#calenderspan");if(s){s.css("display","none")}if(v){v.css("display","block")}}}});return[{html:r}]},formFieldContent:new h({fields:[{type:"html",name:"CAFormBody",id:"CAFormBody",html:"<div id='CAFormDiv'></div>"}],events:{onInvalid:function(){a.error(p.ECM_CA_MandFieldMissing_error)}}}),physicalIDContainer:new c({name:"PhysicalID",id:"PhysicalID",required:false,value:"",hide:true}),CANameContainer:new c({name:"CAName",id:"CAName",required:false,value:"",hide:true}),createButton:function(){b.doneBtn=new i({value:p.ECM_CA_Create,className:"primary",disabled:true,onCompleteCallback:function(v){n.endWait(b.CACreateModal.getBody());b.CACreateModal.hide();enoviaServerCAWidget.existingCAIds.push(v.changeaction.id);var t=new g(v,{parse:true});var s={};t.fetch(s);var r=enoviaServerCAWidget.mySkeleton;var u=r.getCollectionAt(0);u.add(t,{at:0});u.invoke("dispatchEvent","updateOrder");if(a.collectionToFilter){a.collectionToFilter.add(t)}if(a.summaryCloned){a.summaryCloned.add(t)}r.selectItem(t);u.deactivateTaggerProxy()},onFailureCallback:function(s,r){n.endWait(b.CACreateModal.getBody())},});b.doneBtn.elements.input.onclick=function(){var s=b.formFieldContent.validate(false,false);if(s){n.doWait(b.CACreateModal.getBody());var r=b.getCreateEditData("create");a.createCA(JSON.stringify(r),b.doneBtn.options.onCompleteCallback,b.doneBtn.options.onFailureCallback)}};return b.doneBtn},cancelButton:new i({value:p.ECM_CA_Cancel,events:{onClick:function(){b.CACreateModal.hide();var r=b.physicalIDContainer.getValue();if((""!=r)&&(b.createOrEditFlag)){b.createIDCardEdit(r);b.physicalIDContainer.setValue("")}}}}),pushFormContent:function(u){this.CACreateModal=null;this.CACreateModal=new m({closable:true,header:"<h4>"+p.ECM_CA_ChangeAction_Definition+"</h4>",body:b.formFieldContent,footer:[b.createButton(),b.cancelButton],events:{onHide:(b.pushFormContentOnHide).bind(b.CACreateModal)}});this.CACreateModal.inject(widget.body).show();var t=k.extendElement(document.body).getElement("#CAFormDiv");t.innerHTML="";this.createBody().inject(t);var r=document.getElementById("Abstract");if(r){r.focus()}var s=k.extendElement(document.body).getElement("#EditCADiv");if(s){s.hide()}b.doneBtn.show()},createCAFromActionBar:function(t,u,s){this.CACreateModal=null;this.CACreateModal=new m({closable:true,header:"<h4>"+p.ECM_CA_ChangeAction_Definition+"</h4>",body:b.formFieldContent,footer:[b.createAndAddButton(t,u,s),b.cancelButton],events:{onHide:(b.pushFormContentOnHide).bind(b.CACreateModal)}});this.CACreateModal.inject(widget.body).show();var w=k.extendElement(document.body).getElement("#CAFormDiv");w.innerHTML="";this.createBody().inject(w);var r=document.getElementById("Abstract");if(r){r.focus()}var v=k.extendElement(document.body).getElement("#EditCADiv");if(v){v.hide()}b.doneBtn.show()},createAndAddButton:function(s,t,r){b.doneBtn=new i({value:p.ECM_CA_Create,className:"primary",disabled:true,onCompleteCallback:function(u){n.endWait(b.CACreateModal.getBody());b.CACreateModal.hide();r(u)},onFailureCallback:function(v,u){n.endWait(b.CACreateModal.getBody())},});b.doneBtn.elements.input.onclick=function(){var v=b.formFieldContent.validate(false,false);if(v){n.doWait(b.CACreateModal.getBody());var u=b.getCreateEditData("create");u.changeaction.proposed=s.changeaction.add.proposed;t(JSON.stringify(u),b.doneBtn.options.onCompleteCallback,b.doneBtn.options.onFailureCallback)}};return b.doneBtn},getCreateEditData:function(s){var z=b.formFieldContent.getValues();var u=a.sanitizeText(b.formFieldContent.getValue("Abstract"));var r=a.sanitizeText(b.formFieldContent.getValue("Description"));var t=b.severityButtonGroup.getActive()[0].getId();var x=b.formFieldContent.getValue("DueDate_hidden");var v=b.formFieldContent.getValue("EstimatedStartDate_hidden");var w=b.formFieldContent.getValue("ChangeOrder_hidden");var y="";if(s=="create"){y={version:"v0",changeaction:{name:"",revision:"-",type:"type_ChangeAction",description:r,attributes:[{name:"Synopsis",value:u},{name:"Estimated Completion Date",value:x},{name:"Severity",value:t}]}}}return y},};return b});define("DS/ENOChangeActionUX/scripts/Skeleton/CASkeleton",["DS/W3DXComponents/Skeleton","DS/ENOChangeActionUX/scripts/Views/CAIDCardView","DS/ENOChangeActionUX/scripts/Views/CANewTeamView","DS/ENOChangeActionUX/scripts/Views/CAReferentialView","DS/ENOChangeActionUX/scripts/Views/CAApplicabilityView","DS/ENOChangeActionUX/scripts/Views/CAContextView","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/Views/CADependeciesView","DS/ENOChangeActionUX/scripts/Views/CAProcessStepsView","DS/ENOChangeActionUX/scripts/CreateCAForm","DS/ENOChangeActionUX/scripts/Views/CAViewCommon","DS/ENOChangeActionUX/scripts/CAUtility","DS/W3DXComponents/ContentSet","DS/ENOChangeActionUX/scripts/Collection/CACollection","DS/W3DXComponents/Views/Layout/GridScrollView","DS/W3DXComponents/Views/Layout/TableScrollView","DS/W3DXComponents/Views/Item/RowView","DS/W3DXComponents/Views/Layout/ListView","DS/W3DXComponents/Views/EmptyView","DS/W3DXComponents/Collections/ActionsCollection","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/Views/CACustomTileView","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Core","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/DataDragAndDrop/DataDragAndDrop",],function(h,m,z,t,k,l,w,j,o,A,y,s,n,b,d,f,p,r,e,v,B,c,i,u,a,x,g){var q={multiSelectionActivated:false,multiSelArr:{},contentViews:[{id:"tile",title:c.ECM_CA_Switch_TileView,view:f,itemView:i,"default":true},{id:"table",title:c.ECM_CA_Switch_TableView,view:p,itemView:r},{id:"list",view:e,itemView:i,selectionMode:"oneToOne",events:{onItemViewSelect:function(){},onItemViewUnSelect:function(){}}}],getRendererMap:function(C){return{content:{collection:d,autoFetch:false,view:b,viewOptions:q.getComponentSetOptions(C),idCardOptions:q.getIdCardOptions(C),idKey:"id",swipe:false,}}},getComponentSetOptions:function(C){var D=[{property:"title",sortable:true,label:c.ECM_CA_Summary_Table_Label_Name},{property:"synopsis",sortable:true,label:c.ECM_CA_Summary_Table_Label_Title},{property:"owner",sortable:true,label:c.ECM_CA_Summary_Table_Label_Owner},{property:"contextUserRole",sortable:true,label:c.ECM_CA_Summary_Table_Label_Role},{property:"due",sortable:true,label:c.ECM_CA_Summary_Table_Label_DueDate},{property:"TableStateVal",sortable:true,label:c.ECM_CA_Summary_Table_Label_State},{property:"severityDisplay",sortable:true,label:c.ECM_CA_Summary_Table_Label_Severity},{property:"isNewlyAssign",sortable:true,label:c.ECM_CA_Summary_Table_Label_NewlyAssigned}];return{actions:{collection:new B([{id:"refresh",title:c.ECM_CA_Action_Refresh,icon:"refresh",overflow:false},{id:"create",title:c.ECM_CA_Summary_Create,icon:"plus",overflow:false}]),events:{onActionClick:function(I,F,G){var H=F.model.get("id");switch(H){case"refresh":var E=document.getElementsByClassName("tooltip")[0];if(E){E.destroy()}q.loadContent();break;case"create":y.pushFormContent();break}}}},contents:{selectionMode:"nullToMany",useInfiniteScroll:false,usePullToRefresh:false,headerOnEmpty:true,views:q.contentViews,headers:D,emptyView:v,events:{}},events:{onMultiselOff:function(){var G=Object.keys(q.multiSelArr);for(var E in G){var H=q.multiSelArr[G[E]];var F=document.createElement("input");F.setAttribute("data-pid",H.model.get("id").replace("pid:",""));F.setAttribute("data-type",H.model.get("type"));delete q.multiSelArr[G[E]];x.onClickItem.call(F,widget,enoviaServerCAWidget)}q.multiSelectionActivated=false},onMultiselOn:function(){q.multiSelectionActivated=true},onItemViewSelect:function(){u.doWait(widget.body);var E=enoviaServerCAWidget.mySkeleton;var I=E.getCollectionAt(0);I.deactivateTaggerProxy();var H=Object.keys(q.multiSelArr);for(var G in H){delete q.multiSelArr[H[G]]}q.multiSelectionActivated=false;var F={};arguments[2].model.fetch(F)},onItemViewCheck:function(){q.multiSelectionActivated=true;var I=arguments[2];var H=I.model.get("id");var E=arguments[3];var F=document.createElement("input");F.setAttribute("data-pid",I.model.get("id").replace("pid:",""));F.setAttribute("data-type",I.model.get("type"));if(E.target.checked){q.multiSelArr[H]=I;F.setAttribute("class","selected")}else{if(E.target.checked===false){delete q.multiSelArr[H];var G=Object.keys(q.multiSelArr);if(G.length===0){q.multiSelectionActivated=false}}}x.onClickItem.call(F,widget,enoviaServerCAWidget)},onItemViewClick:function(){if(q.multiSelectionActivated===true){var K=arguments[2];var J=K.model.get("id");var I=Object.keys(q.multiSelArr);var H=document.createElement("input");H.setAttribute("data-pid",K.model.get("id").replace("pid:",""));H.setAttribute("data-type",K.model.get("type"));var E=false;for(var G in I){var F=q.multiSelArr[I[G]];if(F.model.id===J){E=true;break}}if(E){delete q.multiSelArr[J]}else{H.setAttribute("class","selected");q.multiSelArr[J]=K}x.onClickItem.call(H,widget,enoviaServerCAWidget)}},onItemViewDrag:function(){if(Object.keys(q.multiSelArr).length&&q.multiSelectionActivated){var F=false;var E=arguments[2].model.get("id");var I=Object.keys(q.multiSelArr);for(var H in I){var G=q.multiSelArr[I[H]];if(G.model.id===E){F=true;break}}if(F){arguments[2]=q.multiSelArr}else{var J={};J[arguments[2].model.get("id")]=arguments[2];arguments[2]=J}}else{var J={};J[arguments[2].model.get("id")]=arguments[2];arguments[2]=J}n.onItemViewDrag(arguments,"Change Action")},onUnSelectAll:function(){n.updateWidgetTitle();n.activateSummaryViewTagger();var F=enoviaServerCAWidget.mySkeleton;var J=F.getCollectionAt(0);var L=[];if(n.collectionToFilter!=null){L=n.collectionToFilter}else{L=J}var I=[];I=L.toArray();var G=[];for(var E in I){var K=I[E]._attributes;var H={};H.id=K.id;H.attributes={};H.attributes.EstimatedCompletionDate=K.due;H.attributes.EstimatedStartDate="";H.attributes.Severity=K.severity;H.attributes.Synopsis=K.synopsis;H.attributes.type=K.type;H.attributes.name=K.name;H.attributes.contextUserRole=K.contextUserRole;H.attributes.state=K.current;H.attributes["Change On Hold"]=K.holdStatus;G.push(H)}J.setSubjectTags(G)}}}},_resizeEventRegister:function(){var G=this;q._currentRight="540";var J=false;var K=null;var E=null;var D=null;var C=function(L){if(L.stopPropagation){L.stopPropagation()}if(L.preventDefault){L.preventDefault()}L.cancelBubble=true;L.returnValue=false;return false};var H=function(L){K=q._currentRight;E=L.clientX?L.clientX:(L.touches&&L.touches[0])?L.touches[0].clientX:0;J=true;if(L.type==="touchstart"){document.addEventListener("touchmove",F);document.addEventListener("touchend",I)}else{if(L.type==="mousedown"){document.addEventListener("mousemove",F);document.addEventListener("mouseup",I)}}};var F=function(M){var L=M.clientX?M.clientX:(M.touches&&M.touches[0])?M.touches[0].clientX:0;if(J){G._currentRight=+K+ +(E-L);q._resizePanels()}};var I=function(L){J=false;K=G._currentRight;if(L.type==="touchend"){document.removeEventListener("touchmove",F);document.removeEventListener("touchend",I)}else{if(L.type==="mouseup"){document.removeEventListener("mousemove",F);document.removeEventListener("mouseup",I)}}};q._rightResizer.addEventListener("mousedown",H);q._rightResizer.addEventListener("touchstart",H)},_resizePanels:function(){q._rightResizer.setStyle("right",this._currentRight);q._rightPanel.setStyle("width",this._currentRight);var C="calc( 100% - "+this._currentRight+"px )";q._leftPanel.setStyle("width",C)},loadContent:function(){widget.body.empty();var H=q._leftPanel=new UWA.createElement("div",{id:"skeleton-container",styles:{height:"100%",width:"100%"},});var G=new UWA.createElement("div",{id:"layout-resizer-div","class":"layout-resizer",styles:{right:"540px",position:"absolute",height:"100%",width:"5px","z-index":"9999",cursor:"w-resize"}});q._rightResizer=G;q._resizeEventRegister();var D=q._rightPanel=new UWA.createElement("div",{id:"slidein-container","class":"slide-cotain"});var E=new UWA.createElement("div",{id:"main-container",styles:{height:"100%",width:"100%",display:"flex"},});H.inject(E);G.inject(E);D.inject(E);E.inject(widget.body);var H=a.extendElement(document.body).getElement("#skeleton-container");var F=this;setTimeout(function(){if(H){F.makeDroppable(H)}},1000);var C=new h(q.getRendererMap({}));enoviaServerCAWidget.mySkeleton=C;C.render().inject(H);n.updateWidgetTitle()},getIdCardOptions:function(D){u.doWait(widget.body);var G=this;var I=j._createView_TestProposed("div","test-proposed-facet",false);var C=w._createView_NewRealized("div","test-realized-facet",false,{},{});var E=[];var H=0;if(enoviaServerCAWidget.CHG_CA_PROCESS_STEPS==="true"){E.push({name:H.toString(),text:c.ECM_CA_Process_Step_Facet_Name,icon:"step-0",handler:h.getRendererHandler(A._createView_ProcessSteps(false))});H++}E.push({name:H.toString(),text:c.ECM_CA_Properties,icon:"newspaper",handler:h.getRendererHandler(m._createView_IdCard("div","generic-detail1",false,y))});H++;E.push({name:H.toString(),text:c.ECM_CA_Team,icon:"users",handler:h.getRendererHandler(z)});H++;E.push({name:H.toString(),text:c.ECM_CA_ProposedChanges,icon:"change-action-proposed",handler:h.getRendererHandler(I)});H++;E.push({name:H.toString(),text:c.ECM_CA_RealizedChanges,icon:"change-action-realized",handler:h.getRendererHandler(C)});H++;E.push({name:H.toString(),text:c.ECM_CA_Referential_label,icon:"link",handler:h.getRendererHandler(t._createView_Referential(false))});H++;E.push({name:H.toString(),text:c.ECM_CA_App_Context_label,icon:"evolution-effectivity",handler:h.getRendererHandler(k._createView_Applicability(false))});H++;E.push({name:H.toString(),text:c.ECM_CA_Proposed_Change_Context,icon:"3d-object",handler:h.getRendererHandler(l._createView_Context(false))});H++;E.push({name:H.toString(),text:c.ECM_CA_DEPENDENCY_TITLE,icon:"dependencies",handler:h.getRendererHandler(o)});var F={thumbnailUrl:function(){return this.get("image")},attributesMapping:s.getattributesMapping(),actions:function(){if(UWA.is(this.get("userAccess"))){return s.getUserActions(this)}},facets:E,events:{onFacetSelect:function(J,K){if(J==="0"){if(enoviaServerCAWidget.PropWidget){setTimeout(function(){enoviaServerCAWidget.PropWidget.onResize()},100)}}J=parseInt(J);K=parseInt(K);n.activateDeactiveTaggerProxies(J,K)},}};return F},makeDroppable:function(C){g.droppable(C,{drop:function(F,E,D){n.error(c.ECM_CA_DROP_NOT_ALLOWED)},over:function(){}})},};return q});define("DS/ENOChangeActionUX/scripts/ChangeAction",["DS/ENOChangeActionUX/scripts/CAIDCard","DS/W3DXComponents/IdCard","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/ENOChangeActionUX/scripts/CAUtility","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/CAPreferences","UWA/Class/Promise","DS/i3DXCompassServices/i3DXCompassServices","DS/W3DXComponents/Skeleton","DS/ENOChangeActionUX/scripts/Skeleton/CASkeleton","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOChangeActionUX/scripts/Views/CASlideInFormView","DS/ENOChangeActionUX/scripts/CAFlowDownStatusContainer","DS/Foundation/WidgetUwaUtils","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],function(g,p,m,a,f,o,c,i,d,k,e,h,j,l,q,n,b){var r={init:function(){n.setupEnoviaServer();window.enoviaServer.widgetName="ChangeActionManagement";window.enoviaServer.widgetId=window.widget.id;window.enoviaServer.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",window.enoviaServerCAWidget={serviceName:"3DSpace",baseURL:"",InterCom:UWA.Utils.InterCom,compassSocket:null,prefIntercomServer:null,compassSocketName:"",prefSocketName:"",arrOid:[],timezone:new Date().getTimezoneOffset(),wsCallTimeout:180000,mySecurityContext:"",proxy:window.UWA.Data.proxies.passport?"passport":"ajax",myRole:"",contextUser:"",isNative:false,isPoweredBy:r.IsPoweredBy(),is3DSpace:false,fromIDCard:false,referentialsSearchType:"",contextSearchType:"",proposedSearchType:"",datamodel:"new",project_space:"",organization:"",mySkeleton:null,PropWidget:null,NamePref:"Title",UXPref:"New",reviewerType:{typeOfReviewer:"",labelSelected:false},frameWorkName:"ENOChangeActionUX",TaggerInNative:false,CHG_OPEN_FROM_NATIVE:"false",CHG_TRANSFER_REALIZED:"false",CHG_FLOWDOWN:"false",CHG_CA_PROCESS_STEPS:"false",CHG_NATIVE_TAGGER:"true",CHG_CHANGE_MATURITY:"false",CHG_CHANGE_MATURITY_HEADER:"true",CHG_DOWNLOAD_REFERENTIAL:"false",CHG_CHANGE_ASSESSMENT:"false",CHG_TRANSFER_OWNERSHIP:"false",isChangeAvailable:false,supportedOperations:"None,NewVersion,NewMinorVersion,NewEvolution,Create",supportedActivities:"Modify,Release,Obsolete",supportedOperationMap:new Object(),get3DSpaceURL:function(){return this.baseURL},computeUrl:function(u){return this.get3DSpaceURL()+u},getSecurityContext:function(){return this.mySecurityContext},getRole:function(){return this.myRole},collabspace:"",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",tenantnls:"",existingCAIds:null,newlyAssignCAIds:null};var s="wdg_"+new Date().getTime();o.setupIntercomConnections.call(this,widget,enoviaServerCAWidget,s);widget.body.empty();if(location.href.search("IDCard")>=0){enoviaServerCAWidget.isNative=true;f.DispatchEventToWin("Native_Init","done")}else{var t=c.getUser();if(t){enoviaServerCAWidget.contextUser=t.login}r.populate3DSpaceURL().then(function(u){i.PopulatePreferences().then(function(w){var v=widget.getPreference("NameOrTitle").value;if(UWA.is(v)){enoviaServerCAWidget.NamePref=v}r.populateRoles().then(function(x){if(enoviaServerCAWidget.isChangeAvailable==true){r.populateSecurityContext().then(function(y){r.getSearchTypes().then(function(A){var z=[];r.getExpressionValue().then(function(K){widget.body.empty();var J=null;var G=(widget.getValue("X3DContentId"))?JSON.parse(widget.getValue("X3DContentId")):null;var I=widget.getValue("TransientCAPid");var L=widget.getValue("originatingPid");var H=widget.getValue("objName");var B=widget.getValue("originatingcaName");var D=widget.getValue("status");var C=widget.getValue("nameTitlePref");if(G!==null&&widget.getValue("lastRootNodeID")===undefined&&!widget.getValue("clearInPreview")){var F=G.data;if(F!==null&&F.items.length>0){var E=F.items[F.items.length-1];J=E.objectId;if(UWA.is(J)){r.IsChangeAction(J).then(function(N){if(N.isChangeAction==="TRUE"){var O="pid:"+J;var M={transientCAPid:O,originatingCAPid:L,originatingCAName:B,objNametoFilterforFlowDown:H,isFromFlowDown:D,nameTitlePref:C,};r.getCAIDCard(M)}else{if(enoviaServerCAWidget.mySecurityContext!=""){h.loadContent()}}},function(M){console.log("widget initilization failed");return d.reject(M)})}}}else{if(I){if(UWA.is(I)){r.IsChangeAction(I).then(function(N){if(N.isChangeAction==="TRUE"){var O="pid:"+I;var M={transientCAPid:O,originatingCAPid:L,originatingCAName:B,objNametoFilterforFlowDown:H,isFromFlowDown:D,nameTitlePref:C,};r.getCAIDCard(M)}else{if(enoviaServerCAWidget.mySecurityContext!=""){h.loadContent()}}})}}else{if(enoviaServerCAWidget.mySecurityContext!=""){h.loadContent()}}}},function(B){console.log("dependency key is not found");return d.reject(B)})},function(z){console.log("Search Types failed");return d.reject(z)})},function(y){console.log("Populate Security Context failed");return d.reject(y)})}else{f.error(b.ECM_CA_NO_CHG_ROLE)}})})},function(u){console.log("widget initilization failed");return d.reject(u)})}},init_Native:function(s){if(UWA.is(s.DisplayPref)){enoviaServerCAWidget.NamePref=s.DisplayPref}if(UWA.is(s.TaggerInNative)){if(s.TaggerInNative=="1"){enoviaServerCAWidget.TaggerInNative=true}}enoviaServerCAWidget.isNative=true;enoviaServerCAWidget.contextUser=s.userid;enoviaServerCAWidget.tenant=s.active_tenant;enoviaServerCAWidget.tenantnls=s.tenantDisplayName;widget.body.setStyle("height",document.body.parentElement.clientHeight+"px");widget.addEvent("onResize",function(){widget.body.setStyle("height",document.body.parentElement.clientHeight+"px")});var t={};r.getWebInWinParameters(function(u){t=u?u:null;r.populate3DSpaceURL(t).then(function(v){r.populateSecurityContext().then(function(w){r.getSearchTypes().then(function(x){r.getExpressionValue().then(function(D){widget.body.empty();var y="";var C="";var B="";var z=false;if(s.options&&s.options.flowdown){y=s.options.flowdown.originatingPid;C=s.options.flowdown.objName;z=s.options.flowdown.status;B=s.options.flowdown.originatingcaName;nameTitlePref:s.options.flowdown.nameTitlePref}var E="pid:"+s.pid;var A={transientCAPid:E,originatingCAPid:y,originatingCAName:B,objNametoFilterforFlowDown:C,isFromFlowDown:z,nameTitlePref:enoviaServerCAWidget.NamePref,};return(r.getCAIDCard(A))},function(y){console.log("expressions keys not found");return d.reject(y)})},function(x){console.log("Search Types failed");return d.reject(x)})},function(w){console.log("Populate Security Context failed");return d.reject(w)})},function(v){console.log("Populate 3DSpace URL failed");return d.reject(v)})})},getWebInWinParameters:function(t){var s=this;if(!window.COMPASS_CONFIG||!window.COMPASS_CONFIG.myAppsBaseUrl){r._getMyappsUrl(function(u){if(!window.COMPASS_CONFIG){window.COMPASS_CONFIG={}}if(u){window.COMPASS_CONFIG.myAppsBaseUrl=u;if(!window.COMPASS_CONFIG.userId){window.COMPASS_CONFIG.userId=enoviaServerCAWidget.contextUser}if(!window.COMPASS_CONFIG.lang){window.COMPASS_CONFIG.lang=widget.lang}}t(window.COMPASS_CONFIG)})}else{t(window.COMPASS_CONFIG)}},_getMyappsUrl:function(s){if(r.isNatifEnvironnement()&&typeof dscef.getMyAppsURL==="function"){dscef.getMyAppsURL().then(function(t){console.log("MyApps URL",t);s.call(null,t)})["catch"](function(t){console.error("Failed to fetch MyApps URL: "+t);s.call(null,null)})}else{s.call(null,null)}},isNatifEnvironnement:function(){return typeof(dscef)!=="undefined"},populate3DSpaceURL:function(s){var t=new d(function(w,v){var u=null;if(s){u={};u.myAppsBaseUrl=s.myAppsBaseUrl,u.userId=s.userId,u.lang=s.lang}j.getPlatformServices({config:u,onComplete:function(y){for(var x=0;x<y.length;x++){if(enoviaServerCAWidget.tenant==y[x]["platformId"]){enoviaServerCAWidget.baseURL=y[x]["3DSpace"];enoviaServerCAWidget.federatedURL=y[x]["3DSearch"]}}w()},onFailure:v})});return t},_resizeEventRegister:function(){var w=this;r._currentRight="540";var z=false;var A=null;var u=null;var t=null;var s=function(B){if(B.stopPropagation){B.stopPropagation()}if(B.preventDefault){B.preventDefault()}B.cancelBubble=true;B.returnValue=false;return false};var x=function(B){A=r._currentRight;u=B.clientX?B.clientX:(B.touches&&B.touches[0])?B.touches[0].clientX:0;z=true;if(B.type==="touchstart"){document.addEventListener("touchmove",v);document.addEventListener("touchend",y)}else{if(B.type==="mousedown"){document.addEventListener("mousemove",v);document.addEventListener("mouseup",y)}}};var v=function(C){var B=C.clientX?C.clientX:(C.touches&&C.touches[0])?C.touches[0].clientX:0;if(z){w._currentRight=+A+ +(u-B);r._resizePanels()}};var y=function(B){z=false;A=w._currentRight;if(B.type==="touchend"){document.removeEventListener("touchmove",v);document.removeEventListener("touchend",y)}else{if(B.type==="mouseup"){document.removeEventListener("mousemove",v);document.removeEventListener("mouseup",y)}}};r._rightResizer.addEventListener("mousedown",x);r._rightResizer.addEventListener("touchstart",x)},_resizePanels:function(){r._rightResizer.setStyle("right",this._currentRight);r._rightPanel.setStyle("width",this._currentRight);var s="calc( 100% - "+this._currentRight+"px )";r._leftPanel.setStyle("width",s)},getCAIDCard:function(v){var x=r._leftPanel=new UWA.createElement("div",{id:"skeleton-container",styles:{height:"100%",width:"100%"},});var w=new UWA.createElement("div",{id:"layout-resizer-div","class":"layout-resizer",styles:{right:"540px",position:"absolute",height:"100%",width:"5px","z-index":"9999",cursor:"w-resize"}});r._rightResizer=w;r._resizeEventRegister();var s=r._rightPanel=new UWA.createElement("div",{id:"slidein-container",styles:{height:"100%",width:"0",position:"fixed",zIndex:"1",top:"0",right:"0",overflowX:"hidden",transition:".5s",borderLeft:"0 solid #d1d4d4",background:"white"}});var u=new UWA.createElement("div",{id:"main-container",styles:{height:"100%",width:"100%",display:"flex"},});x.inject(u);w.inject(u);s.inject(u);u.inject(widget.body);var x=a.extendElement(document.body).getElement("#skeleton-container");enoviaServerCAWidget.flowdownOptions=v;if(enoviaServerCAWidget.flowdownOptions.isFromFlowDown===true){enoviaServerCAWidget.NamePref=enoviaServerCAWidget.flowdownOptions.nameTitlePref}var t=new p(g.getRendererMap({},v));t.render().inject(x);if(v.isFromFlowDown&&enoviaServerCAWidget.CHG_CA_PROCESS_STEPS!=="true"){t.selectFacet(3)}else{if(v.isFromFlowDown&&enoviaServerCAWidget.CHG_CA_PROCESS_STEPS==="true"){t.selectFacet(4)}else{t.selectFacet(0)}}enoviaServerCAWidget.IDCard=t;enoviaServerCAWidget.IDCard.addEvent("onRefresh",function(){g.HideAllViews();g.Flush()})},getResultStringFromJSONArrayObj:function(s){var u="";if(s!=undefined&&s!=""&&s.length>0){for(var t=0;t<s.length;t++){if(u==""){u=s[t]}else{u=u+","+s[t]}}}return u},getSearchTypes:function(){var s=new d(function(x,w){var t="/resources/modeler/change/typeeallowed";var u="";var v=function(y){enoviaServerCAWidget.referentialsSearchType=r.getResultStringFromJSONArrayObj(y.referentials);enoviaServerCAWidget.contextSearchType=r.getResultStringFromJSONArrayObj(y.context);enoviaServerCAWidget.proposedSearchType=r.getResultStringFromJSONArrayObj(y.proposed);x(y)};f.makeWSCall(t,"GET","enovia","application/json",u,v,w,true)});return s},populateSecurityContext:function(){var s=new d(function(y,x){var v="/resources/pno/person/getsecuritycontext";var w="";var u=function(A){t=A.SecurityContext;if(!t||t==null){f.error(b.ECM_CA_Use_Preferences)}else{if(A!=null&&A!=""&&A.hasOwnProperty("SecurityContext")){var B="";if(A.SecurityContext.indexOf("ctx::")!=0){B="ctx::"}t=B+A.SecurityContext}console.log("Setting security Context: "+t);enoviaServerCAWidget.mySecurityContext=t;t=t.replace("ctx::","");if(UWA.is(window.enoviaServer)){window.enoviaServer.context=t}enoviaServerCAWidget.myRole=t.substring(0,t.indexOf("."));window.enoviaServer.myRole=t.substring(0,t.indexOf("."));enoviaServerCAWidget.collabspace=t.substring(t.lastIndexOf(".")+1,t.length);y(A)}};var z=widget.getValue("SC");if((z!=null)&&(z!=undefined)&&(z!="")){var t="ctx::"+z;enoviaServerCAWidget.mySecurityContext=t;t=t.replace("ctx::","");enoviaServerCAWidget.myRole=t.substring(0,t.indexOf("."));window.enoviaServer.myRole=t.substring(0,t.indexOf("."));enoviaServerCAWidget.collabspace=t.substring(t.lastIndexOf(".")+1,t.length);y(t)}else{f.makeWSCall(v,"GET","enovia","application/json",w,u,x,true)}});return s},IsChangeAction:function(s){var t=new d(function(z,y){var v="/resources/modeler/change/changeaction/pid:"+s;var w="";var u=function(B){var A={isChangeAction:"TRUE"};z(A)};var x=function(){var A={isChangeAction:"FALSE"};z(A)};f.makeWSCall(v,"GET","enovia","application/json",w,u,x,true)});return t},getExpressionValue:function(){var s=new d(function(x,w){var u="/resources/v2/e6w/service/ExpresssionSearch/CHG*";var v="";var t=function(z){var y=["CHG_DEPENDENCY_LEGACY","CHG_NATIVE_TAGGER","CHG_TRANSFER_REALIZED","CHG_FLOWDOWN","CHG_REALIZED_INSTANCE_NAME","CHG_OPEN_FROM_NATIVE","CHG_CA_PROCESS_STEPS","CHG_CHANGE_MATURITY_HEADER","CHG_CHANGE_MATURITY","CHG_DOWNLOAD_REFERENTIAL","CHG_CHANGE_ASSESSMENT","CHG_TRANSFER_OWNERSHIP"];if(z&&z.data){z.data.forEach(function(A){if(A.dataelements){var C=Object.keys(A.dataelements);for(var B in C){if(y.indexOf(C[B])>=0){if(A.dataelements){enoviaServerCAWidget[C[B]]=A.dataelements[C[B]]}}}}})}x()};f.makeWSCall(u,"GET","enovia","application/json",v,t,w,true)});return s},populateRoles:function(){var s=new d(function(u,t){j.getGrantedRoles(function(w){var v=["CAP","CHG","COR","DAR","FCD","FME","FRA","FTM","GLS","PDA","PDE","PDM","PPE","QUC","SPM","TRM","UWE","UXG","ENO_ECM_TP"];w.forEach(function(x){if(((v.indexOf(x.id)>=0)&&x.platforms.indexOf(enoviaServerCAWidget.tenant)>=0)||(x.id==="InternalDS")){enoviaServerCAWidget.isChangeAvailable=true}});u(true)})});return s},IsPoweredBy:function(){var w={};var x=document.createElement("a");x.href=location.href;var t=x.search.substring(1);var u=t.split("&");for(var s=0;s<u.length;s++){var v=u[s].split("=");w[v[0]]=decodeURIComponent(v[1])}if(w.widgetDomain&&(w.widgetDomain.search("catiav5")>=0||w.widgetDomain.search("solidworks")>=0)){return true}else{return false}},};return r});