define("DS/WebUtils/ProbesManager",["UWA/Class","DS/WebSystem/Environment","DS/WebSystem/Downloader"],function(d,g,i){var h=2;var e=true,c=true;var f=[],b=0,a={createProbe:function(j,l){if(!e){return{begin:function(){},end:function(){},getTime:function(){}}}var k={probeName:j,id:(typeof widget==="undefined"?"":widget.id+"_"+widget.title+"_")+j,strMarkBegin:l?l:j+"_Begin_"+b,strMarkEnd:j+"_End_"+b,begin:function(){window.performance.mark(this.strMarkBegin)},end:function(){window.performance.mark(this.strMarkEnd);window.performance.measure(this.id,this.strMarkBegin,this.strMarkEnd)},getTime:function(){return window.performance.getEntriesByName(this.id)[0].duration}};b++;f.push(k);return k},_parse:function(j){var k=0;for(;k<f.length;k++){if(f[k].probeName===j){return f[k]}}if(k===f.length){console.error("Probe not found : ",j)}return undefined},end:function(j){var k=this._parse(j);if(k){k.end()}},getTime:function(j){var k=this._parse(j);if(k){return k.getTime()}return 0},GetProcessedData:function(p,k){p=p!==undefined?p:true;var s="Pre-iframe delay";var r=0,q,m,t=[];if(!window["3DPlay.ProbesManager.TopWindowNotAvailable"]){var l="";if(typeof widget!=="undefined"){l=widget.id}q=window.top.performance.getEntriesByName(l+"clap");if(Array.isArray(q)){q=q[0]}m=window.performance.getEntriesByName(l+"clap");if(Array.isArray(m)){m=m[0]}if(q&&m){r=Math.floor(q.startTime-m.startTime);t.unshift({name:s,startTime:r,duration:0})}if(p){window.top.performance.getEntriesByType("measure").forEach(function(u){if(u.duration>h){t.push({name:u.name,startTime:Math.floor(u.startTime-r+0.5),duration:Math.floor(u.duration+0.5)})}})}}window.performance.getEntriesByType("measure").forEach(function(u){if(u.duration>2){t.push({name:u.name,startTime:Math.floor(u.startTime+0.5),duration:Math.floor(u.duration+0.5)})}});if(k){for(var n=t.length;n--;){var j=t[n];var o=j.name.split("_");if(o.length>2){o=o.slice(1)}j.name=o.join("_")}}return t},GetSubProbesFrom:function(l,k){k=k!==undefined?k:true;var n=[];if(l){var m=window.performance.getEntriesByName(l.id).pop();var o=m.startTime,j=o+m.duration;this.GetProcessedData(k).forEach(function(p){if(l.id!==p.name&&p.duration>h&&p.startTime>=o&&(p.startTime+p.duration)<=j){n.push({name:p.name,duration:Math.floor(p.duration)})}})}return n},dump:function(m){m=m?m+"_":"";var j=new Date();var k=j.getFullYear()+"-"+(j.getMonth()+1)+"-"+j.getDate()+"-"+j.getHours()+":"+j.getMinutes();var l=window.performance.getEntriesByType("measure");l=l.concat(window.performance.getEntriesByType("mark"));i("3DPlay.PCS_"+m+k+".json",new Blob([JSON.stringify(l)],{type:"text/plain"}))},cleanProbes:function(){f=[];window.performance.clearMeasures();window.performance.clearMarks()}};return a});define("DS/WebUtils/StringUtils",["UWA/Class"],function(a){var b={};b.fileExtension=/(?:\.([^./]+)(?:\.\d)?)?$/;b.urlprotocol=/(^[A-Za-z]+)\:\/\//;b.urlhostname=/(?:\:\/\/)(?=(.+)\:|\/)/;b.urlhostport=/(?:\:)(?=([0-9]+))/;b.rooturi=/(?:\:\/\/[^\/]+\/)(?=(.+))/;b.isInt=/^(\-|\+)?([0-9]+|Infinity)$/;var d=a.singleton({init:function(c){},sprintf:function(){var f=arguments[0];for(var e=0,c=arguments.length-1;e<c;e++){f=f.replace("{"+e+"}",arguments[e+1])}return f},parseUrl:function(f){var h={http:80,https:443};var g={};var e=f.match(/^(^[A-Za-z]+)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(e){g={protocol:e[1],host:e[2],hostname:e[3],port:e[4]?parseInt(e[4]):h[e[1]],pathname:e[5].substring(1),search:e[6],hash:e[7]}}else{g.protocol=b.urlprotocol.exec(f);if(g.protocol!==null&&g.protocol!==undefined){g.protocol=g.protocol[1];g.hostname=b.urlhostname.exec(f);if(g.hostname!==null&&g.hostname!==undefined){g.hostname=g.hostname[1]}g.port=b.urlhostport.exec(f);if(g.port!==null&&g.port!==undefined){g.port=g.port[1]}g.pathname=b.rooturi.exec(f);if(g.pathname!==null&&g.pathname!==undefined){g.pathname=g.pathname[1]}}else{return null}}if(g.pathname){var c=g.pathname.indexOf("/");g.rooturi=g.pathname.substring(0,c>-1?c:g.pathname.length)}return g},getExtension:function(h){if(h===undefined||h===null||h===""){return""}var g;var f=h.indexOf("?")+1;var e=h;if(f){e=h.substring(0,h.indexOf("?"))}var c=b.rooturi.exec(e);if(c!==null&&c!==undefined){c=c[1]}else{c=h}g=b.fileExtension.exec(c);if(g!==null&&g!==undefined){g=g[1]}return(g!==undefined&&g!==null)?g:""},filterInt:function(c){if(b.isInt.test(c)){return Number(c)}return NaN}});return d});define("DS/WebUtils/Tracker",["UWA/Class","DS/WebSystem/Environment","DS/Usage/TrackerAPI"],function(a,k,g){var c="1";var j={X3DPLAW_AP:"3DPlay Widget",X3DCSMA_AP:"3DSpace Widget",X3DDRIV_AP:"3DDrive Widget",X3DWNEW_AP:"3DSWYM Community",X3DMCTY:"3DSWYM Widget","3dswym":"3DSWYM Application",X3DSEAR_AP:"3DSearch",X3DPLAI_AP:"3DPlay IOS",X3DPLAO_AP:"3DPlay WIN10",X3DPLAA_AP:"3DPlay Android",X3DPLAY_AP:"3DPlay Win Rich Client",};var d=null;var b="Syndication";try{if(window.WinJS){b=j.X3DPLAO_AP}else{if(window.HybridApp){if(window.HybridApp.isIOS()){b=j.X3DPLAI_AP}else{if(window.HybridApp.isAndroid()){b=j.X3DPLAA_AP}}}else{if(typeof widget!==undefined&&widget.id===null&&widget.body===window.document.body){b=j.X3DSEAR_AP}else{for(var f in j){if(j.hasOwnProperty(f)&&window.location.href.indexOf(f)>-1){b=j[f];break}}}}}}catch(h){}return{setTenant:function(e){d=e},inc:function(e){var i=e.split("-");if(i){this.trackPageEvent(i[0],i[1],i[2])}},trackPageEvent:function(t,q,m,p,u,l){var n;if(u&&l){n={pd1:c};for(var r in u){if(u.hasOwnProperty(r)){for(var e in l){if(l.hasOwnProperty(e)&&r.indexOf(e)>-1){n[l[e]]=u[r].toString();break}}}}}var s={appID:"X3DPLAW_AP"};if(d){s.tenant=d}if(k.isSet("3DPlay.Tracker.log")){console.log("Tracker:event","3DPlay-"+t,q,m,p,n,s)}g.trackPageEvent("3DPlay-"+t,q,m,p,n,s)},getEmbederName:function(){return b}}});define("DS/WebUtils/ContextedSingleton",["UWA/Class"],function(a){return a.singleton({data:{},init:function(){},add:function(b,d,e){var c=this.data[b];if(c===undefined){c=this.data[b]={}}c[d]=e},get:function(b,d){var c=this.data[b];return c!==undefined?c[d]:c},remove:function(b,d){var c=this.data[b];if(c!==undefined){if(c[d]!==undefined){if(c[d].dispose){c[d].dispose()}c[d]=null;delete c[d]}}return this},removeCtx:function(b){if(this.data[b]){for(var c in this.data[b]){this.remove(b,c)}delete this.data[b]}return this}})});define("DS/WebUtils/EventDisposer",["DS/CoreEvents/Events","UWA/Class"],function(b,a){return a.extend({init:function(c){this._parent();this.arr=[]},add:function(c){this.arr.push(c);return this},dispose:function(){for(var c=this.arr.length;c--;){b.unsubscribe(this.arr[c]);this.arr[c]=null}this.arr=null}})});define("DS/WebUtils/MemoryProfiler",["DS/WebSystem/DetectBrowser","DS/WebInfraUI/DOMGraph"],function(i,b){var d={update:console.log};var c=1000;var h={chrome:true};var a=1024*1024*1024;var g=function(){return Math.floor(window.performance.memory.usedJSHeapSize/a)};var e=function(){setTimeout(e,c);d.update(g())};return function(f){var j=i();if(!h[j.browser.name]||!window.performance.memory){console.warn('Memory Profiling is only supported by chrome whith " --enable-precise-memory-info" option')}else{c=f.updateTime||c;a=f.size||a;d=f.output?f.output:new b({updateLegend:f.updateLegend||"Ko",name:f.name||"Memory",container:f.container?f.container:document.body,color:f.color||"f00",length:f.length||200,updateSize:true});e()}}});define("DS/WebUtils/State",["UWA/Class"],function(c){var b=0;var d=c.extend({init:function(a){this.name=a.name||"undefined"+b++;this._restore=a.restore;this.getValue=a.getValue;this.initValue=a.getValue()},getValue:function(){},restore:function(){this._restore(this.initValue)},getInitialValue:function(){return this.initValue}});return d});define("DS/WebUtils/FunctionDisposer",["UWA/Class"],function(a){return a.extend({init:function(b){this._parent();this.disposeFunctions=[]},add:function(b){this.disposeFunctions.push(b)},dispose:function(){for(var b=this.disposeFunctions.length;b--;){if(this.disposeFunctions[b]){this.disposeFunctions[b]();this.disposeFunctions[b]=null}delete this.disposeFunctions[b]}}})});define("DS/WebUtils/3DPlayState",["DS/CefCommunication/CefCommunication"],function(a){var b={isWebinWin:function(){return a.isAvailable()},};return b});define("DS/WebUtils/Clock",[],function(){function a(b){this.autoStart=(b!==undefined)?b:true;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false}a.prototype={constructor:a,start:function(){this.startTime=(performance||Date).now();this.oldTime=this.startTime;this.elapsedTime=0;this.running=true},stop:function(){this.getElapsedTime();this.running=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var c=0;if(this.autoStart&&!this.running){this.start()}if(this.running){var b=(performance||Date).now();c=(b-this.oldTime)/1000;this.oldTime=b;this.elapsedTime+=c}return c}};return a});define("DS/WebUtils/GraphicOption",["UWA/Class"],function(b){var a=b.extend({init:function(c){this.name=c.name;this.settingName=c.settingName;this.defaultValue=c.defaultValue;this.nlsTitle=c.nlsTitle;this.enabled=true;this.available=true;this.viewer=c.viewer},enable:function(){this.enabled=true;this.activateFunc(true)},disable:function(){this.enabled=false;this.activateFunc(false)},refreshAvailability:function(){this.available=this.getCurrentState();this.enabled=this.available},activateFunc:function(c){},getCurrentState:function(){return true}});return a});define("DS/WebUtils/Profiler",["UWA/Class"],function(a){var c=function(){return new Date().getTime()};function e(f,g,h){this.father=g;this.name=f;this.startTime=this.stopTime=0;this.path=g?g.path:"";this.path+=f+"/";this.addProfile=function(i,k){this.children=this.children||{};var j=this.children[i];if(!j){j=new e(i,this);this.children[i]=j}return j.start()};this.addProfileFromObject=function(j){var i=this.addProfile(j.name);i.startTime=j.startTime;return i};this.stop=function(i){if(this.stopTime===0){this.stopTime=c()}var j=this.stopTime-this.startTime;if(i&&this.father){this.father.stop(true)}return j};this.start=function(){this.stopTime=0;this.startTime=c();return this};this.getTime=function(){return(this.stopTime===0?c():this.stopTime)-this.startTime};this.isStopped=function(){return this.stopTime!==0};this.dumpAsJSON=function(){var k=this.isStopped()?this.getTime():-1;if(this.children){k={time:k};var l=this.children;for(var j in l){k[j]=l[j].dumpAsJSON()}}return k};this.getPath=function(){return this.path};this.dispose=function(){this.name=null;this.path=null;this.father=null;if(Array.isArray(this.children)){for(var j=0;j<this.children.length;j++){this.children[j].dispose()}}this.children=null}}var d="/";var b=a.singleton({Profiles:{},_searchNode:function(j,i,g){var k=undefined;if(j.indexOf(d)!=-1){var f=j.split(d);var h=f.shift();if(i&&i.children){k=i.children[h]}else{k=this.Profiles[h]}if(!k){if(i){k=i.addProfile(h)}else{if(g){k=new e(h);if(this.Profiles){this.Profiles[h]=k}}}}if(k&&f.length>0){k=this._searchNode(f.join(d),k,g)}}else{if(i){if(i.children){k=i.children[j]}if(!k&&g){k=i.addProfile(j)}}else{k=this.Profiles[j]}}return k},init:function(f){},start:function(h,f){var g=this._searchNode(h,undefined,true);if(!g){g=new e(h);this.Profiles[h]=g}return g.start()},stop:function(h,g){var f=this._searchNode(h,undefined,false);if(f!==undefined){return f.stop(g)}console.warn("[PROFILER] unknown profile :",h);return -1},getTime:function(g){var f=this._searchNode(g,undefined,false);if(f!==undefined){return f.getTime()}console.warn("[PROFILER] unknown profile :",g);return -1},dumpAsJSON:function(){var g={};var h=this.Profiles;for(var f in h){g[f]=h[f].dumpAsJSON()}return g}});return b});define("DS/WebUtils/PhaseProgress",["UWA/Class","DS/WebInfraUI/Progress"],function(a,c){var b=a.extend({init:function(){this.progressBarDivision=0;this.subProgressArray=[0];this._MaxValue=100;this.progress=new c()},registerSubProgress:function(){this.progressBarDivision++;this.subProgressArray[this.progressBarDivision]=0;return this.progressBarDivision},registerMultipleSubProgress:function(e){var f=[];for(var d=0;d<e;++d){f.push(this.registerSubProgress())}return f},getSubProgressDivisions:function(){return this.progressBarDivision},resetProgress:function(){this._OldValue=0;this._CurrentValue=0;this.progressBarDivision=0;this.subProgressArray=[0]},dispose:function(){this.resetProgress();this.progressBarDivision=undefined;this.subProgressArray=[];this._MaxValue=undefined;this.progress.dispose()},advanceToMax:function(d){if(d){this.setAbsoluteProgress(d,this._MaxValue)}},setAbsoluteProgress:function(d,e){if(d&&d<=this.progressBarDivision){if(e<=100){this.subProgressArray[d]=e}this._advance()}},setIncrementalProgress:function(d,e){if(d&&d<=this.progressBarDivision){if((this.subProgressArray[d]+e)<=100){this.subProgressArray[d]+=e}this._advance()}},setIndeterminateState:function(){this.progress.updateProgression(-1)},showProgressBar:function(){this.progress.visible()},hideProgressBar:function(){this.progress.hide()},getProgressBarState:function(){return this.progress.getProgressBarState()},addProgressBarIntoUI:function(d){d.appendChild(this.progress.getContent())},_getProgress:function(){return{loaded:this._CurrentValue,total:this._MaxValue}},_advance:function(){var d=0;this.subProgressArray.forEach(function(e){if(e!==0){d=d+e}});d=d/(this.progressBarDivision);this._CurrentValue=d;if((this._CurrentValue-this._OldValue)>=0){this._OldValue=this._CurrentValue;this._updateProgressBar();if(this.onAdvance){this.onAdvance(this._getProgress())}}else{if((this._CurrentValue-this._MaxValue)>0.001){console.error("[3DPlay/PhaseProgress] _CurrentValue > _MaxValue ("+this._CurrentValue+" > "+this._MaxValue+")")}}},_updateProgressBar:function(){this.progress.updateProgression(this._CurrentValue)},_CurrentValue:0,_OldValue:0,});return b});define("DS/WebUtils/Vector2",["UWA/Class"],function(a){return(a.extend({init:function(b,c){this.x=b||0;this.y=c||0},set:function(b,c){this.x=b;this.y=c;return this},setScalar:function(b){this.x=b;this.y=b;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setComponent:function(b,c){switch(b){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+b)}return this},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+b)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(b){this.x=b.x;this.y=b.y;return this},add:function(c,b){if(b!==undefined){return this.addVectors(c,b)}this.x+=c.x;this.y+=c.y;return this},addScalar:function(b){this.x+=b;this.y+=b;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScaledVector:function(b,c){this.x+=b.x*c;this.y+=b.y*c;return this},sub:function(c,b){if(b!==undefined){return this.subVectors(c,b)}this.x-=c.x;this.y-=c.y;return this},subScalar:function(b){this.x-=b;this.y-=b;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiply:function(b){this.x*=b.x;this.y*=b.y;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;return this},divide:function(b){this.x/=b.x;this.y/=b.y;return this},divideScalar:function(b){return this.multiplyScalar(1/b)},min:function(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);return this},max:function(b){this.x=Math.max(this.x,b.x);this.y=Math.max(this.y,b.y);return this},clamp:function(c,b){this.x=Math.max(c.x,Math.min(b.x,this.x));this.y=Math.max(c.y,Math.min(b.y,this.y));return this},clampLength:function(c,b){var d=this.length();return this.multiplyScalar(Math.max(c,Math.min(b,d))/d)},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=(this.x<0)?Math.ceil(this.x):Math.floor(this.x);this.y=(this.y<0)?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var b=Math.atan2(this.y,this.x);if(b<0){b+=2*Math.PI}return b},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(d){var c=this.x-d.x,b=this.y-d.y;return c*c+b*b},distanceToManhattan:function(b){return Math.abs(this.x-b.x)+Math.abs(this.y-b.y)},setLength:function(b){return this.multiplyScalar(b/this.length())},lerp:function(b,c){this.x+=(b.x-this.x)*c;this.y+=(b.y-this.y)*c;return this},lerpVectors:function(d,c,b){return this.subVectors(c,d).multiplyScalar(b).add(d)},equals:function(b){return((b.x===this.x)&&(b.y===this.y))},fromArray:function(c,b){if(b===undefined){b=0}this.x=c[b];this.y=c[b+1];return this},toArray:function(c,b){if(c===undefined){c=[]}if(b===undefined){b=0}c[b]=this.x;c[b+1]=this.y;return c},fromBufferAttribute:function(c,b){this.x=c.getX(b);this.y=c.getY(b);return this},rotateAround:function(d,f){var h=Math.cos(f),e=Math.sin(f);var b=this.x-d.x;var g=this.y-d.y;this.x=b*h-g*e+d.x;this.y=b*e+g*h+d.y;return this}}))});
/*! Copyright 2014 Dassault SystÃ¨mes */
if(typeof nipplejs==="object"){define("DS/VENNippleJS",nipplejs)}else{if(require.toUrl("DS/VENNippleJS").indexOf("0.6.8/nipplejs.min")===-1){NIPPLEJS_BASEPATH=require.toUrl("DS/VENNippleJS/0.6.8/");if(NIPPLEJS_BASEPATH.indexOf("?")>-1){NIPPLEJS_BASEPATH=NIPPLEJS_BASEPATH.substring(0,NIPPLEJS_BASEPATH.indexOf("?"))}require.config({paths:{"DS/VENNippleJS":NIPPLEJS_BASEPATH+"nipplejs.min"},shim:{"DS/VENNippleJS":{exports:"nipplejs"}}})}}define("DS/WebUtils/Joystick",["DS/VENNippleJS"],function(a){return a});define("DS/WebUtils/GeometryUtils",["DS/WebUtils/Vector2"],function(a){return{convexHullCompute:function(e){var d=e.slice().sort(function(h,g){return h.x==g.x?h.y-g.y:h.x-g.x});var f=[];for(var b=0;b<d.length;b++){while(f.length>=2&&this._leftTurn(f[f.length-2],f[f.length-1],d[b])){f.pop()}f.push(d[b])}f.pop();var c=f.length+2;for(var b=d.length-1;b>=0;b--){while(f.length>=c&&this._leftTurn(f[f.length-2],f[f.length-1],d[b])){f.pop()}f.push(d[b])}f.pop();return f},boundingBoxCompute:function(o){var c=Number.MAX_VALUE;var f=[];var g=[];var j=0;var n=0;var l=0;var r=0;for(var h=0;h<o.length;h++){g.push(o[(h+1)%o.length].clone().sub(o[h]).normalize());if(o[h].x<o[j].x){j=h}if(o[h].x>o[n].x){n=h}if(o[h].y<o[r].y){r=h}if(o[h].y>o[l].y){l=h}}var s=new a(-1,0);var q=new a(0,-1);for(var h=0;h<o.length;h++){var b=[q.dot(g[j]),-q.dot(g[n]),s.dot(g[l]),-s.dot(g[r]),];switch(b.indexOf(Math.max.apply(Math,b))){case 0:s=g[j].clone();s.set(s.y,-s.x);j=(j+1)%o.length;break;case 1:s=g[n].clone().negate();s.set(s.y,-s.x);n=(n+1)%o.length;break;case 2:s=g[l].clone();l=(l+1)%o.length;break;case 3:s=g[r].clone().negate();r=(r+1)%o.length;break}q=s.clone().negate();q.set(q.y,-q.x);var p=this._intersection(o[j],q,o[l]);var e=this._intersection(o[n],q,o[l]);var m=this._intersection(o[r],s,o[j]);var k=this._intersection(o[r],s,o[n]);var d=p.distanceTo(e)*p.distanceTo(m);if(d<c){f=[p,m,k,e];c=d}}return f},isIntersect:function(c,b){for(var e=0;e<c.length;e++){for(var d=0;d<b.length;d++){if(this._intersect(c[e],c[(e+1)%c.length],b[d],b[(d+1)%b.length])){return true}}}return false},isOverlap:function(c,b){var d=this.isIntersect(c,b);if(d===false){if(this._isInsidePolygon(c[0],b)){d=true}if(this._isInsidePolygon(b[0],c)){d=true}}return d},getCurveLength:function(d){var c=0;for(var b=0;b<d.length-1;b++){c+=d[b+1].clone().sub(d[b]).length()}return c},getTopLeftPoint:function(e){var f=new a(9999,9999);var c=9999,b=9999;for(var d=0;d<e.length;d++){if(e[d].x<c){c=e[d].x}if(e[d].y<b){b=e[d].y}}return new a(c,b)},getBarycenter2D:function(d){var c=new a();for(var b=0;b<d.length;b++){c.x+=d[b].x;c.y+=d[b].y}c.x/=d.length;c.y/=d.length;return c},getBarycenter:function(d){var c={x:0,y:0,z:0};for(var b=0;b<d.length;b++){c.x+=d[b].x;c.y+=d[b].y;c.z+=d[b].z}c.x/=b;c.y/=b;c.z/=b;return c},_isInsidePolygon:function(b,d){var e=0;for(var c=0;c<d.length;c++){if(d[c].y<=b.y){if(d[(c+1)%d.length].y>b.y){if(this._isLeft(d[c],d[(c+1)%d.length],b)){e++}}}else{if(d[(c+1)%d.length].y<=b.y){if(!this._isLeft(d[c],d[(c+1)%d.length],b)){e--}}}}return !(e==0)},_leftTurn:function(e,d,f){return((d.x-e.x)*(f.y-d.y)-(d.y-e.y)*(f.x-d.x))<=0},_isLeft:function(e,d,f){return((d.x-e.x)*(f.y-e.y)-(f.x-e.x)*(d.y-e.y))>=0},_intersect:function(f,e,h,g){return((this._isLeft(f,h,g)?1:0)^(this._isLeft(e,h,g)?1:0))&&((this._isLeft(h,f,e)?1:0)^(this._isLeft(g,f,e)?1:0))},_intersection:function(e,d,c){var b=((e.x-c.x)*d.x-(c.y-e.y)*d.y)/(-d.x*d.x-d.y*d.y);return new a(e.x+b*d.x,e.y+b*d.y)},wrapText:function(e){var o=e.canvasCtx;var l=e.text;var b=e.width;var m=e.height;var h=[];var t=0;if(!o){var g=document.createElement("canvas");g.width=b;g.height=m;o=g.getContext("2d");o.font=e.font}var c=l.split("\n");for(var r=0;r<c.length;r++){var v="";var f="";var n=c[r].split(" ");for(var q=0;q<n.length;q++){var s=(q<n.length-1)?(n[q]+" "):n[q];var u=o.measureText(n[q]).width;if(u<b){f+=s;var d=o.measureText(f).width;if(d<b){v=f}else{h.push(v);t=o.measureText(v).width>t?o.measureText(v).width:t;f=f.substring(v.length);v=f}}else{if(v.length>0){h.push(v);t=o.measureText(v).width>t?o.measureText(v).width:t;f=f.substring(v.length);v=""}for(var p=0;p<s.length;p++){f+=s[p];var d=o.measureText(f).width;if(d<b){v=f}else{h.push(v);t=o.measureText(v).width>t?o.measureText(v).width:t;f=f.substring(v.length);v=f}}}}h.push(v);t=o.measureText(v).width>t?o.measureText(v).width:t}return{wrappedLines:h,width:t}},}});define("DS/WebUtils/Statistics",["UWA/Class","DS/WebUtils/Profiler","DS/WebSystem/Environment","UWA/Class","DS/WebSystem/FpsInfo","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/WebInfraUI/DOMGraph","DS/WebUtils/MemoryProfiler","DS/WebUtils/ProbesManager"],function(a,h,j,i,l,e,c,k,g,f){var d=false;var b="";return i.extend({updateProfile:function(m){var o=function(F,E){if(F._children){for(var D=0;D<F._children.length;D++){var G=F._children[D];if(G.options.link===E){return G}if(G._children){var C=o(G,E);if(C){return C}}}}return null};var w=this.tree.getNthRoot(0);w.expand();var s=false,B=f.GetProcessedData(true,true);var x=0,p=[];var z="Pre-iframe delay";var q;if(B.length){if(z===B[0].name){q=B[0].startTime;B=B.splice(1)}}for(var t=0;t<B.length;t++){var n=B[t];var v,y=n.name.split("_");v=y[0];if((typeof widget!=="undefined")&&widget.id===v){y[0]="3DPlay"}if(!p[v]){p[v]=x++}n.group=p[v];n.name=y.join("_");if(n.name.indexOf("Load_")!==-1){s=true}}if(s){B.sort(function(E,C){var F=E.startTime;var D=C.startTime;if(F<D){return -1}if(F>D){return 1}return 0});var u=function(G){var I,C;var F;for(var D=B.length-1;D>=0;D--){F=B[D];if(D===t){continue}if(F){if(G.startTime>=F.startTime&&(G.startTime+G.duration)<=(F.startTime+F.duration)&&G.group>=F.group){I=o(w,F.name);if(I){D=-1}}}}var H=G.name+": "+Math.floor(G.startTime+0.5)+" | "+Math.floor(G.duration+0.5);if(!I){I=o(w,G.name);if(!I){I=new c({label:H,link:G.name});w.addChild(I)}else{I.expand()}}else{H=G.name+": "+Math.floor(G.startTime+0.5)+" | "+Math.floor(G.duration+0.5)+" ("+Math.floor(0.5+100*G.duration/F.duration)+"%) ";var E=o(I,G.name);if(!E){var E=new c({label:H,link:G.name});I.addChild(E)}else{I.expand()}}};if(!d){for(var t=0;t<B.length;t++){u(B[t])}var r=document.getElementById("iframedelay");if(!r){var A=document.createElement("div");A.id="iframedelay";A.innerText=z+":"+q}this.tree.getContent().insertBefore(A,this.tree.getContent().firstChild);d=true;w.expandAll()}}},preProcess:function(){},postProcess:function(){var q=new Date().getTime();this.frames++;this.totalFrames++;if(q>(this.prevTime+this.updatetime)){var p=Math.round((this.frames*1000)/(q-this.prevTime));if(this.fpsInfo.min>p){this.fpsInfo.min=p}else{if(this.fpsInfo.max<p){this.fpsInfo.max=p}}this.fpsInfo.avg=this.totalFrames*1000/(q-this.first);if(this.fpsHistory.length>this.history-1){this.fpsHistory.shift()}this.fpsHistory.push(p);var m=Math.min(this.fpsHistory.length,this.history);this.fpsInfoHistory.clear();for(var n=0;n<m;n++){var o=this.fpsHistory[n];this.fpsInfoHistory.avg+=o;if(this.fpsInfoHistory.min>o){this.fpsInfoHistory.min=o}else{if(this.fpsInfoHistory.max<o){this.fpsInfoHistory.max=o}}}this.fpsInfoHistory.avg=Math.round(this.fpsInfoHistory.avg/m);this.fpsGraph.update(p);this.frames=0;this.prevTime=q;if(!this.hidden()){b="FPS:"+p+" ("+this.fpsInfo.toString()+") history ("+this.fpsInfoHistory.toString()+")";this.tree.getNthRoot(0).elements.label.innerText="CAPTION => Task : Start time from 3DPlay's frame | duration time";this.updateProfile()}}},clearHistory:function(){this.fpsInfo=new l();this.fpsInfoHistory=new l();for(var m=history;m--;){this.fpsGraph.update(fps)}this.fpsHistory=[];this.totalFrames=0;this.frames=0;this.startTime=new Date().getTime();this.prevTime=this.startTime;this.first=this.startTime;this.frameduration=this.startTime;this.frames=0;this.totalFrames=0},visibility:function(m){this.stats.style.display=m?"block":"none"},show:function(){this.visibility(true)},hide:function(){this.visibility(false)},hidden:function(){return this.stats.style.display=="none"},dispose:function(){this.hide();this.fpsGraph.dispose();this.fpsGraph=null;this.cleanDiv();this.container=null;if(this.stats.empty){this.stats.empty()}this.stats=null},cleanDiv:function(){try{this.container.removeChild(this.stats)}catch(m){}},set:function(m){if(this.container!=m.container){this.container=m.container;this.cleanDiv();this.container.appendChild(this.stats)}},init:function(o){o=o||{};this.clearHistory();this.updatetime=o.updatetime!==undefined?o.updatetime:200;var m=j.get("Statistics.updateTime");if(m){this.updatetime=parseInt(m)}this.historySecond=o.historySecond!==undefined?o.historySecond:50;this.history=o.history!==undefined?o.history:this.historySecond*1000/this.updatetime;m=j.get("Statistics.history");if(m){this.history=parseInt(m)}var n="020";this.stats=document.createElement("div");this.stats.id="statistics";this.stats.style.cssText="top:25px;left:25px;position:absolute;height:100%";var q=document.getElementById("Memory");if(!q){g({container:this.stats,length:this.history,updateTime:this.updatetime,size:1024*1024,updateLegend:"Mo"})}this.fpsGraph=new k({name:"FrameRate",container:this.stats,color:"0b5",length:this.history,caption:function(){return b}});this.stats.appendChild(this.fpsGraph.getContainer());this.tree=new e();this.tree.getContent().setStyles({minHeight:400,top:0,left:0,position:"relative",opacity:0.8});this.tree.addRoot({label:"Root"});this.tree.inject(this.stats);this.hide();if(j.isSet("3DPlay.Statistics")){var p=this;document.addEventListener("keydown",function(r){if(r.keyCode==222){p.hidden()?p.show():p.hide()}},false);setTimeout(function(){p.show()},10)}this._parent({name:"Statistics"})}})});