define("DS/MPFOrderListComponent/NoStatusSelectorTileElement",["UWA/Class/View","DS/MPFUtils/MPFUtils","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(d,b){var c;var a;c=d.extend({className:"mpf-hidden",render:function(){return this},setIsSelected:b.doNothing,updateCount:b.doNothing});c.getInstance=function(){a||(a=new c());return a};return c});define("DS/MPFOrderListComponent/OrderListEvents",[],function(){var a=Object.freeze({FILTER_BY_STATE:"filterByState",FILTER_BY_DATE:"filterByDate",SORT:"sort",CLEAR_DATE_FILTER:"clearFilter"});return a});define("DS/MPFOrderListComponent/PriceTile",["UWA/Core","UWA/Event","UWA/Class/View","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFModelFactory/InvoiceFactory","DS/MPFInvoiceModel/InvoiceModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(i,l,a,d,g,j,k,h,c,b){var e;var f={};f.MAKE="MAKE";f.STORE_3DEXP="STORE_3DEXP";e=a.extend({className:"mpf-price-tile",setup:function(m){j.requiredOfPrototype(m.cart,d,"options.cartItem must be a CartModel");this.cart=m.cart;this.isSellerView=m.isSellerView;this.invoiceFactory=m.invoiceFactory;this.locale=m.locale||"fr-FR";this.service=i.is(m.service)?m.service:k.MAKE;this.price=this._createPrice();this.taxComment=this._createTaxComment();this.invoiceLink=this._createInvoiceLink()},render:function(){this.container.setContent([this.price,this.taxComment,this.invoiceLink]);return this},destroy:function(){this.cart=null;this._parent();this.container=null},_createPrice:function(){var p;var o=this.cart.get(d.Fields.PRICE_MINIMUM);var m=this.cart.get(d.Fields.PRICE_MAXIMUM);var r=(o<0)&&(m>=0);var n=(o>=0)&&(m>=0);var q=(o>=0)&&(m<0);if(this.service===k.STORE){p=this._formatPrice(this.cart.getNetAmountTotal())}else{if(r){p=this._formatPrice(m)}else{if(n){p=this._formatPrice(o,{noSymbol:true})+"-\u00A0"+this._formatPrice(m,{noSymbol:true})+g.getCurrencySymbol(this.cart)}else{if(q){p=this._formatPrice(o,{noSymbol:true})+"+\u00A0"+g.getCurrencySymbol(this.cart)}else{p="--\u00A0"+g.getCurrencySymbol(this.cart)}}}}return i.createElement("div",{"class":"mpf-price-tile-price",text:p})},_formatPrice:function(n,m){m||(m={});m.locale=this.locale;return g.formatPrice(this.cart,n,m)},_createTaxComment:function(){return i.createElement("div",{"class":"mpf-price-tile-tax-comment",text:b.get("taxExcludedAbbreviation")})},_createInvoiceLink:function(){var m;var n;if(this.isSellerView&&(this.cart.getGlobalState()===d.States.DELIVERED)){m=i.createElement("a",{href:"#",events:{click:function(o){l.stopPropagation(o)}}});n=this.invoiceFactory.createCollection(h.Types.CART_INVOICE);n.setParentResourceId(this.cart.id);n.fetchPromise().then(function(){var o;o=n.find(function(p){return p.getType()===c.Types.INVOICE});if(o){m.setAttributes({href:o.getInvoice(),download:o.getName()});m.setText(b.get("commissionInvoice"))}})}return m}});return e});define("DS/MPFOrderListComponent/StatusProgressTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,a,g,c,d,i){var f={};f.CANCELLED="CANCELLED";f.SUBMITTED="SUBMITTED";f.WAITING_PAYMENT="WAITING_PAYMENT";f.PAID="PAID";f.PROCESSING="PROCESSING";f.READY="READY";f.SHIPPED="SHIPPED";f.DELIVERED="DELIVERED";var h={};h.CANCELLED="0";h.SUBMITTED="17";h.WAITING_PAYMENT="33";h.PAID="50";h.PROCESSING="66";h.READY="83";h.SHIPPED="83";h.DELIVERED="100";var b=a.extend({className:"mpf-status-progress",setup:function(j){j||(j={});this._parent(j);this._checkPrototypes(j);this.cart=j.cart;this.orderStatusContainer=this._getOrderStatusContainer();this.progressBarContainer=this._getProgressBarContainer()},render:function(){this.container.setContent([this.progressBarContainer,this.orderStatusContainer]);return this},_getProgressBarContainer:function(){var o;var n;var l;l=this.cart.getGlobalState();n=h[l];o=e.createElement("div",{"class":"mpf-progress-bar",html:e.createElement("div",{"class":"mpf-step-bar",styles:{width:n+"%"}})});if(l===f.DELIVERED){o.addClassName("complete")}if(l===f.SHIPPED){var k;var j=new Date();var m=new Date(j.getUTCFullYear(),j.getUTCMonth(),j.getUTCDate(),j.getUTCHours(),j.getUTCMinutes(),j.getUTCSeconds());k=m-new Date(this.cart.getDeliveryDate());if(k>0){o.addClassName("late")}}return o},_getOrderStatusContainer:function(){return e.createElement("div",{"class":"mpf-status",html:[this._getIconContainer(),e.createElement("span",{"class":"mpf-status-label",text:i.get(this.cart.getGlobalState().toLowerCase())})]})},_getIconContainer:function(){var j;var k;k=this.cart.getGlobalState();if(k===f.SUBMITTED){j="fonticon fonticon-right"}else{if(k===f.WAITING_PAYMENT){j="fonticon fonticon-survey"}else{if(k===f.PAID){j="fonticon fonticon-check"}else{if(k===f.PROCESSING){j="fonticon fonticon-clock"}else{if(k===f.READY){j="fonticon fonticon-parcel-ok"}else{if(k===f.DELIVERED){j="fonticon fonticon-status-ok"}else{if(k===f.CANCELLED){j="fonticon fonticon-wrong"}else{if(k===f.SHIPPED){j="fonticon fonticon-truck-delivery"}}}}}}}}return e.createElement("span",{"class":j})},_checkPrototypes:function(j){g.requiredOfPrototype(j.cart,c,"options.cart must be a CartModel")}});return b});define("DS/MPFOrderListComponent/LegalEntityTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFError/BadArgumentError","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(h,b,i,j,e,f,g,d){var a={};a.BUYER="buyer";a.SELLER="seller";a.EMP="emp";var c;c=b.extend({className:"mpf-legal-entity-tile",setup:function(k){i.requiredOfPrototype(this.model,f,"this.model must be a CartModel");this.isSeller=k.isSeller===true;this.stateMachine=this._createStateMachine(k.state);this.logo=this._createLogo();this.title=this._createTitle();this.subtitle=this._createSubtitle()},render:function(){if(this.isSeller){this.container.addClassName("seller")}else{this.container.addClassName("buyer")}this.container.setContent([h.createElement("div",{"class":"first-column",html:this.logo}),h.createElement("div",{"class":"second-column",html:[this.title,this.subtitle]})]);return this},destroy:function(){this.model=null;this._parent();this.container=null},_createLogo:function(){var k=this.stateMachine.getState();if(this.isSeller&&k===a.SELLER){return h.createElement("span",{"class":"fonticon"})}else{return h.createElement("span",{"class":this.isSeller?"fonticon fonticon-factory":"fonticon fonticon-user"})}},_createTitle:function(){var k;var l;l=this.stateMachine.getState();if(this.isSeller&&l!==a.SELLER){k=this.model.getShopName()}else{if(this.isSeller){k=""}else{k=this.model.getOwnerData().FirstName+" "+this.model.getOwnerData().LastName.toUpperCase()}}return h.createElement("div",{"class":"mpf-legal-entity-name",text:k})},_createSubtitle:function(){var l="";if(!this.isSeller){l+=this.model.getOwnerData().Company}else{if(this.isSeller&&h.is(this.model.getContractDocuments())&&this.model.getContractDocuments().length>0){var n=this.model.getContractDocuments().filter(function(o){return o.documentType===g.DOCUMENT_TYPES.NDA&&o.currentState!==g.STATUS.archived});if(n.length>0){var k=n[0];var m=k.currentState;if(m===g.STATUS.draft){l+=d.get("NDA")+" - "+d.get("notSigned")}else{if(m===g.STATUS.inEffect){l+=d.get("NDA")+" - "+d.get("signed")}}}}}return h.createElement("div",{"class":"mpf-legal-entity-subtitle",text:l})},_createStateMachine:function(k){return new e({state:k,states:[a.BUYER,a.SELLER,a.EMP],transitions:[]})}});c.States=Object.freeze(a);return c});define("DS/MPFOrderListComponent/3DExperienceServiceTile",["UWA/Core","UWA/Class/View","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(d,c,b){var a=c.extend({className:"mpf-3dexp-tile",setup:function(e){e||(e={});this._parent(e)},render:function(){this.container.setContent([b.get("type")+" ",d.createElement("span",{"class":"mpf-cart-type",text:b.get("renewal")})]);return this}});return a});define("DS/MPFOrderListComponent/DetailItemsTile",["UWA/Core","UWA/Event","UWA/Class/View","DS/UIKIT/Input/Button","DS/MPFServices/ObjectService","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemCollection","DS/MPFDataProxy/NoDataProxy","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(h,k,b,j,i,f,g,d,e,l){var a={};a.DETAILS_DISPLAYED="DETAILS_DISPLAYED";a.DETAILS_NOT_DISPLAYED="DETAILS_NOT_DISPLAYED";var c=b.extend({className:"mpf-detail-items",setup:function(m){m||(m={});this._parent(m);this._checkPrototypes(m);this.locale=m.locale||"fr-FR";this.cart=m.cart;this.cartItems=this.cart.getItems();this.stateMachine=this._createStateMachine();this.detailsButton=this._createDetailsButton();this.table=this._createTable()},render:function(){this.container.setContent([this.detailsButton,this.table]);this.table.hide();return this},_createItemRow:function(o){var m;var q;var n;var p;m=this.cart.getCurrency();q=o.getUnitNetAmount().toLocaleString(this.locale,{style:"currency",currency:m,currencyDisplay:"code"}).replace(m,"").trim();n=o.getUnitTaxesAmount().toLocaleString(this.locale,{style:"currency",currency:m,currencyDisplay:"code"}).replace(m,"").trim();p=o.getTotalGrossAmount().toLocaleString(this.locale,{style:"currency",currency:m});return h.createElement("tr",{html:[h.createElement("td",{text:o.getProductDisplayName()}),h.createElement("td",{text:parseInt(o.getQuantity())}),h.createElement("td",{text:q}),h.createElement("td",{text:n}),h.createElement("td",{text:p})]})},_createTable:function(){return h.createElement("div",{"class":"table-responsive",html:this._createTableContent()})},_createTableFooter:function(){return h.createElement("tfoot",{html:h.createElement("tr",{html:[h.createElement("td"),h.createElement("td"),h.createElement("td"),h.createElement("td",{text:l.get("total")}),h.createElement("td",{text:this.cart.getNetAmountTotal().toLocaleString(this.locale,{style:"currency",currency:this.cart.getCurrency()})})]})})},_createTableBody:function(){return h.createElement("tbody",{html:this.cartItems.map(function(m){return this._createItemRow(m)},this)})},_createTableHeader:function(){return h.createElement("thead",{html:h.createElement("tr",{html:[h.createElement("th",{text:l.get("item")}),h.createElement("th",{text:l.get("quantity")}),h.createElement("th",{text:l.get("unitPrice")}),h.createElement("th",{text:l.get("taxes")}),h.createElement("th",{text:l.get("totalAmountWithTaxes")})]})})},_createTableContent:function(){return h.createElement("table",{"class":"table table-hover",html:[this._createTableHeader(),this._createTableBody(),this._createTableFooter()]})},_onClickHandler:function(m){var n;k.stopPropagation(m);n=this.stateMachine.getState();if(n===a.DETAILS_NOT_DISPLAYED){this.table.show();this.detailsButton.setIcon("eye-off");this.detailsButton.setValue(l.get("hideDetails"));this.stateMachine.changeState(a.DETAILS_DISPLAYED)}if(n===a.DETAILS_DISPLAYED){this.table.hide();this.detailsButton.setIcon("eye");this.detailsButton.setValue(l.get("details"));this.stateMachine.changeState(a.DETAILS_NOT_DISPLAYED)}this.detailsButton.setFocus(false)},_createDetailsButton:function(){return new j({className:"link",icon:"eye",value:l.get("details"),events:{onClick:this._onClickHandler.bind(this)}})},_createStateMachine:function(){return new f({state:a.DETAILS_NOT_DISPLAYED,states:[a.DETAILS_DISPLAYED,a.DETAILS_NOT_DISPLAYED],transitions:[{from:a.DETAILS_DISPLAYED,to:a.DETAILS_NOT_DISPLAYED},{from:a.DETAILS_NOT_DISPLAYED,to:a.DETAILS_DISPLAYED}]})},_checkPrototypes:function(m){i.requiredOfPrototype(m.cart,g,"options.cart must be a CartModel")}});return c});define("DS/MPFOrderListComponent/LastUpdateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(h,g,f,c,d,b,e){var a=g.extend({className:"mpf-order-last-update",setup:function(i){i||(i={});this._parent(i);this._checkPrototypes(i);this.cart=i.cart;this.lastUpdateTime=this._getLastUpdateTime()},render:function(){var i;var j;i=h.createElement("span",{"class":"mpf-last-update-label",text:e.get("lastUpdate")});j=h.createElement("span",{"class":"mpf-last-update-value",text:this.lastUpdateTime});this.container.setContent([i,j]);return this},_getLastUpdateTime:function(){return f.format(e.get("timeAgo"),b.getElapsedTime(this.cart.getLastUpdate()||this.cart.getCreated()))},_checkPrototypes:function(i){c.requiredOfPrototype(i.cart,d,"options.cart must be a CartModel")}});return a});define("DS/MPFOrderListComponent/StatusDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(h,b,j,i,d,e,c,k){var a={};a.CREATION="creation";a.DELIVERY="delivery";var g={};g.DELIVERED="DELIVERED";var f=b.extend({className:"mpf-status-date",setup:function(l){l||(l={});this._parent(l);this._checkPrototypes(l);this.cart=l.cart;this.stateMachine=this._createStateMachine(l.state)},render:function(){if(this.stateMachine.getState()===a.CREATION){this.container.setContent(this._getCreationContent())}else{if(this.stateMachine.getState()===a.DELIVERY){this.container.setContent(this._getDeliveryContent())}}return this},_getCreationContent:function(){var m;var l;var n;n=this.cart.getCreated();m=h.createElement("div",{"class":"mpf-time",html:[k.get("created")+" ",h.createElement("span",{text:j.format(k.get("timeAgo"),e.getElapsedTime(n))})]});l=h.createElement("div",{"class":"mpf-date",text:"("+this._getDateString(n)+")"});this.container.addClassName("creation");return[m,l]},_getDeliveryContent:function(){var m;var l;var q;var r=this.cart.getDeliveryDate();var o;if(r===""){l=h.createElement("span",{text:k.get("notSet")});m=h.createElement("div",{"class":"mpf-time",html:k.get("deliveryNotSet",{notSet:l.outerHTML})});q=h.createElement("div",{"class":"mpf-date",html:"&nbsp;"})}else{var n=new Date();var p=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());o=p-new Date(r);if(o<0){l=h.createElement("span",{text:e.getRemainingTime(r)});m=h.createElement("div",{"class":"mpf-time",html:k.get("deliveryIn",{time:l.outerHTML})})}else{l=h.createElement("span",{text:j.format(k.get("timeAgo"),e.getElapsedTime(r))});if(this.cart.getGlobalState()===g.DELIVERED){m=h.createElement("div",{"class":"mpf-time",html:k.get("deliveryExpected",{timeAgo:l.outerHTML})})}else{this.container.addClassName("attention");m=h.createElement("div",{"class":"mpf-time",html:[h.createElement("span",{"class":"fonticon fonticon-attention"}),k.get("deliveryExpected",{timeAgo:l.outerHTML})]})}}q=h.createElement("div",{"class":"mpf-date",text:"("+this._getDateString(r)+")"})}this.container.addClassName("delivery");return[m,q]},_getDateString:function(n){var m;var l={};m=new Date(n);l.year="numeric";l.month="long";l.day="numeric";return m.toLocaleDateString("en-EN",l)},_createStateMachine:function(l){return new c({state:l,states:[a.CREATION,a.DELIVERY],transitions:[]})},_checkPrototypes:function(l){i.requiredOfPrototype(l.cart,d,"options.cart must be a CartModel")}});f.States=Object.freeze(a);return f});define("DS/MPFOrderListComponent/StatusSelectorTileElement",["UWA/Core","UWA/Class/View"],function(c,b){var a;a=b.extend({className:"mpf-status-selector-tile-element",domEvents:{click:"onClick"},setup:function(d){this.title=d.title;this.count=d.count||0;this.setIsSelected(d.isSelected);this.titleElement=this._createTitleElement();this.countElement=this._createCountElement();this.container.addClassName(d.cssClass)},render:function(){this.container.setContent([this.titleElement,this.countElement]);return this},setIsSelected:function(d){this.isSelected=d===true;if(this.isSelected){this.container.addClassName("mpf-selected")}else{this.container.removeClassName("mpf-selected")}},onClick:function(){this.dispatchEvent("selected");this.setIsSelected(true)},destroy:function(){this._parent()},updateCount:function(d){this.countElement.setText(d)},_createTitleElement:function(){return c.createElement("p",{"class":"mpf-title",text:this.title})},_createCountElement:function(){return c.createElement("p",{"class":"mpf-count",text:"("+this.count+")"})}});return a});define("DS/MPFOrderListComponent/PaymentDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(g,b,i,h,d,f,c,j){var a={};a.PAID="PAID";a.DUE_DATE="DUE_DATE";var e=b.extend({className:"mpf-payment-date",setup:function(k){k||(k={});this._parent(k);this._checkPrototypes(k);this.cart=k.cart;this.stateMachine=this._createStateMachine(k.state)},render:function(){if(this.stateMachine.getState()===a.PAID){this.container.setContent(this._getPaidContent())}else{if(this.stateMachine.getState()===a.DUE_DATE){this.container.setContent(this._getDueDateContent())}}return this},_getPaidContent:function(){var k;var m;var l;l=this.cart.getCreated();k=g.createElement("div",{"class":"mpf-time",html:[j.get("paidLabel")+" ",g.createElement("span",{text:i.format(j.get("timeAgo"),f.getElapsedTime(l))})]});m=g.createElement("div",{"class":"mpf-date",text:"("+this._getDateString(l)+")"});this.container.addClassName("paid");return[k,m]},_getDueDateContent:function(){var k;var m;var l;if(this.cart.getGlobalState()!==d.States.DELIVERED&&this.cart.getGlobalState()!==d.States.CANCELLED){l=this.cart.get("dueDate");k=g.createElement("div",{"class":"mpf-time",html:j.get("dueDateIn",{time:g.createElement("span",{text:f.getRemainingTime(l)}).outerHTML})});m=g.createElement("div",{"class":"mpf-date",text:"("+this._getDateString(l)+")"});this.container.addClassName("due-date");return[k,m]}},_getDateString:function(m){var l;var k={};l=new Date(m);k.year="numeric";k.month="long";k.day="numeric";return l.toLocaleDateString("en-EN",k)},_createStateMachine:function(k){return new c({state:k,states:[a.PAID,a.DUE_DATE],transitions:[]})},_checkPrototypes:function(k){h.requiredOfPrototype(k.cart,d,"options.cart must be a CartModel")}});e.States=Object.freeze(a);return e});define("DS/MPFOrderListComponent/OrderIdTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(f,e,b,c,d){var a=e.extend({className:"mpf-order-id",setup:function(g){g||(g={});this._parent(g);this._checkPrototypes(g);this.cart=g.cart},render:function(){this.container.setContent(this.cart.getName());return this},_checkPrototypes:function(g){b.requiredOfPrototype(g.cart,c,"options.cart must be a CartModel")}});return a});define("DS/MPFOrderListComponent/StatusSelectorTile",["UWA/Class/View","DS/MPFOrderListComponent/StatusSelectorTileElement","DS/MPFOrderListComponent/NoStatusSelectorTileElement","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFOrderListComponent/OrderListEvents","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFView/EmptyView","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(a,i,e,k,f,c,g,h,b,d){var j;j=a.extend({className:"mpf-status-selector-tile",setup:function(l){g.requiredOfPrototype(l.carts,k,"options.carts must be a CartCollection");this.carts=l.carts;this.statusSelectorInitValue=l.statusSelectorInitValue;this.service=l.service;this.pendingSelector=this._createPendingSelector();this.deliveredSelector=this._createDeliveredSelector();this.canceledSelector=this._createCanceledSelector();this.allSelector=this._createAllSelector();this.listenTo(this.pendingSelector,"selected",this._onPendingSelected.bind(this));this.listenTo(this.deliveredSelector,"selected",this._onDeliveredSelected.bind(this));this.listenTo(this.canceledSelector,"selected",this._onCanceledSelected.bind(this));this.listenTo(this.allSelector,"selected",this._onAllSelected.bind(this));this.listenTo(this.carts,"onReset",this._updateSelectorCounts.bind(this))},render:function(){this.container.setContent([this.pendingSelector.render(),this.deliveredSelector.render(),this.canceledSelector.render(),this.allSelector.render()]);return this},destroy:function(){this.stopListening(this.pendingSelector);this.stopListening(this.deliveredSelector);this.stopListening(this.canceledSelector);this.stopListening(this.allSelector);this.stopListening(this.carts);this._parent()},_updateSelectorCounts:function(){this.pendingSelector.updateCount(this.carts.pending);this.deliveredSelector.updateCount(this.carts.delivered);this.canceledSelector.updateCount(this.carts.cancelled);this.allSelector.updateCount(this.carts.all);this.render()},_createPendingSelector:function(){return new i({title:d.get("pending"),isSelected:this.statusSelectorInitValue===f.STATE_PENDING_FILTER,cssClass:"pending",count:this.carts.pending})},_createDeliveredSelector:function(){var l;if(this.service===h.ENGINEERING){l=e.getInstance()}else{l=new i({title:d.get("delivered"),isSelected:this.statusSelectorInitValue===f.STATE_DELIVERED_FILTER,cssClass:"delivered",count:this.carts.delivered})}return l},_createCanceledSelector:function(){return new i({title:d.get("canceled"),isSelected:this.statusSelectorInitValue===f.STATE_CANCELED_FILTER,cssClass:"canceled",count:this.carts.cancelled})},_createAllSelector:function(){return new i({title:d.get("all"),isSelected:this.statusSelectorInitValue===f.STATE_ALL_FILTER,cssClass:"all",count:this.carts.all})},_onPendingSelected:function(){var l={};this.deliveredSelector.setIsSelected(false);this.canceledSelector.setIsSelected(false);this.allSelector.setIsSelected(false);l[f.FILTER_BY_STATE]=f.STATE_PENDING_FILTER;this.dispatchEvent(c.FILTER_BY_STATE,l)},_onDeliveredSelected:function(){var l={};this.pendingSelector.setIsSelected(false);this.canceledSelector.setIsSelected(false);this.allSelector.setIsSelected(false);l[f.FILTER_BY_STATE]=f.STATE_DELIVERED_FILTER;this.dispatchEvent(c.FILTER_BY_STATE,l)},_onCanceledSelected:function(){var l={};this.pendingSelector.setIsSelected(false);this.deliveredSelector.setIsSelected(false);this.allSelector.setIsSelected(false);l[f.FILTER_BY_STATE]=f.STATE_CANCELED_FILTER;this.dispatchEvent(c.FILTER_BY_STATE,l)},_onAllSelected:function(){var l={};this.pendingSelector.setIsSelected(false);this.deliveredSelector.setIsSelected(false);this.canceledSelector.setIsSelected(false);l[f.FILTER_BY_STATE]=f.STATE_ALL_FILTER;this.dispatchEvent(c.FILTER_BY_STATE,l)}});return j});define("DS/MPFOrderListComponent/OrderListCommandFilter",["UWA/Core","UWA/Class/View","DS/UIKIT/DropdownMenu","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartFilters","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(h,f,d,g,e,c){var a;var b={};b.CLEAR="clearFilter";b.CREATION_DATE_TODAY="creationDateToday";b.CREATION_DATE_LAST_7_DAYS="creationDateLast7Days";b.CREATION_DATE_LAST_30_DAYS="creationDateLast30Days";b.CREATION_DATE_LAST_6_MONTHS="creationDateLast6Monthss";b.MODIFICATION_DATE_TODAY="modificationDateToday";b.MODIFICATION_DATE_LAST_7_DAYS="modificationDateLast7Days";b.MODIFICATION_DATE_LAST_30_DAYS="modificationDateLast30Days";b.MODIFICATION_DATE_LAST_6_MONTHS="modificationDateLast6Monthss";a=f.extend({className:"mpf-order-list-command-filter",setup:function(i){this.filterIcon=this._createFilterIcon();this.filterMenu=this._createFilterMenu()},render:function(){this.container.setContent([this.filterIcon]);return this},destroy:function(){this._parent()},setActive:function(i){if(i===true){this.filterIcon.addClassName("mpf-active")}else{this.filterIcon.removeClassName("mpf-active")}},_createFilterIcon:function(){return h.createElement("div",{"class":"fonticon fonticon-filter"})},_createFilterMenu:function(){return new d({target:this.container,renderTo:this.container,multiSelect:false,items:[{text:c.get("creationDate"),items:[{text:c.get("today"),name:b.CREATION_DATE_TODAY,selectable:true},{text:c.get("lastXDays",{number:7}),name:b.CREATION_DATE_LAST_7_DAYS,selectable:true},{text:c.get("lastXDays",{number:30}),name:b.CREATION_DATE_LAST_30_DAYS,selectable:true},{text:c.get("lastXMonths",{number:6}),name:b.CREATION_DATE_LAST_6_MONTHS,selectable:true}]},{text:c.get("modificationDate"),items:[{text:c.get("today"),name:b.MODIFICATION_DATE_TODAY,selectable:true},{text:c.get("lastXDays",{number:7}),name:b.MODIFICATION_DATE_LAST_7_DAYS,selectable:true},{text:c.get("lastXDays",{number:30}),name:b.MODIFICATION_DATE_LAST_30_DAYS,selectable:true},{text:c.get("lastXMonths",{number:6}),name:b.MODIFICATION_DATE_LAST_6_MONTHS,selectable:true}]},{text:c.get("clearFilter"),name:b.CLEAR,selectable:true,fonticon:"trash"}],events:{onClick:this._onFilterSelected.bind(this)}})},_onFilterSelected:function(j,i){this._updateMenuSelection(i);switch(i.name){case b.CREATION_DATE_TODAY:this._dispatchFilterCreationDateDays(0);break;case b.CREATION_DATE_LAST_7_DAYS:this._dispatchFilterCreationDateDays(7);break;case b.CREATION_DATE_LAST_30_DAYS:this._dispatchFilterCreationDateDays(30);break;case b.CREATION_DATE_LAST_6_MONTHS:this._dispatchFilterCreationDateMonths(6);break;case b.MODIFICATION_DATE_TODAY:this._dispatchFilterModificationDateDays(0);break;case b.MODIFICATION_DATE_LAST_7_DAYS:this._dispatchFilterModificationDateDays(7);break;case b.MODIFICATION_DATE_LAST_30_DAYS:this._dispatchFilterModificationDateDays(30);break;case b.MODIFICATION_DATE_LAST_6_MONTHS:this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.FILTER_BY_MODIFICATION_DATE_MONTHS,months:6});break;case b.CLEAR:this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.CLEAR});break}},_updateMenuSelection:function(i){this.filterMenu.getSelectedItems().forEach(function(j){if(j!==i){j.elements.container.removeClassName("selected");j.selected=false}})},_dispatchFilterCreationDateDays:function(i){this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.FILTER_BY_CREATION_DATE_DAYS,days:i})},_dispatchFilterCreationDateMonths:function(i){this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.FILTER_BY_CREATION_DATE_MONTHS,months:i})},_dispatchFilterModificationDateDays:function(i){this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.FILTER_BY_MODIFICATION_DATE_DAYS,days:i})},_dispatchFilterModificationDateMonths:function(i){this.dispatchEvent(g.FILTER_BY_DATE,{filter:e.FILTER_BY_MODIFICATION_DATE_MONTHS,months:i})}});return a});define("DS/MPFOrderListComponent/OrderCardBody",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/LegalEntityTile","DS/MPFOrderListComponent/StatusDateTile","DS/MPFOrderListComponent/PaymentDateTile","DS/MPFOrderListComponent/PriceTile","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(k,b,l,m,e,f,g,d,j,i,h,n){var a={};a.BUYER="buyer";a.SELLER="seller";a.EMP="emp";var c=b.extend({className:"mpf-order-card-body",setup:function(o){o||(o={});this._parent(o);this._checkPrototypes(o);this.isSellerView=o.isSellerView===true;this.serviceView=o.serviceView;this.cart=o.cart;this.invoiceFactory=o.invoiceFactory;this.service=k.is(o.service)?o.service:m.MAKE;this.stateMachine=this._createStateMachine(this.isSellerView);this.actorEntitiesTiles=this._createAppropriateActorEntitiesTiles();this.statusDateTiles=this._createStatusDateTiles();this.priceTile=this._createPriceTile()},render:function(){var o;var q;var p;p=k.createElement("div",{"class":"mpf-actors-container",html:this.actorEntitiesTiles.map(function(r){return r.render()})});q=k.createElement("div",{"class":"mpf-time-container",html:this.statusDateTiles.map(function(r){return r.render()})});o=[this.serviceView.render(),p,q,this.priceTile.render()];this.container.setContent(o);return this},_createStatusDateTiles:function(){var o;if(this.service===m.ENGINEERING){o=[new j({state:j.States.CREATION,cart:this.cart})]}else{if(this.service===m.STORE){o=[new i({state:i.States.PAID,cart:this.cart}),new i({state:i.States.DUE_DATE,cart:this.cart})]}else{o=[new j({state:j.States.DELIVERY,cart:this.cart}),new j({state:j.States.CREATION,cart:this.cart})]}}return o},_createPriceTile:function(){return new h({service:this.service,cart:this.cart,isSellerView:this.isSellerView,invoiceFactory:this.invoiceFactory})},_createAppropriateActorEntitiesTiles:function(){var q=this.stateMachine.getState();var o=[];var p;var r;if(q===a.BUYER){r=new d({isSeller:true,model:this.cart,state:q});o.push(r)}else{if(q===a.SELLER){p=new d({isSeller:false,model:this.cart,state:q});o.push(p);r=new d({isSeller:true,model:this.cart,state:q});o.push(r)}else{if(q===a.EMP){p=new d({isSeller:false,model:this.cart,state:q});o.push(p);r=new d({isSeller:true,model:this.cart,state:q});o.push(r)}}}return o},_createStateMachine:function(o){var r;var p;var q;r=window.location.search;p=r.match(/esid=/)!==null;if(p){q=a.EMP}else{q=this.isSellerView?a.SELLER:a.BUYER}return new e({state:q,states:[a.BUYER,a.SELLER,a.EMP],transitions:[]})},_checkPrototypes:function(o){l.requiredOfPrototype(o.cart,f,"options.cart must be a CartModel")}});c.States=Object.freeze(a);return c});define("DS/MPFOrderListComponent/OrderCardHeader",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFOrderListComponent/OrderIdTile","DS/MPFOrderListComponent/LastUpdateTile","DS/MPFOrderListComponent/StatusProgressTile","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(e,b,f,g,d,h,j,c,i){var a=b.extend({className:"mpf-order-card-header",setup:function(k){k||(k={});this._parent(k);this._checkPrototypes(k);this.cart=k.cart;this.service=e.is(k.service)?k.service:g.MAKE;this.orderIdTile=new h({cart:this.cart});this.lastUpdateTile=new j({cart:this.cart});this.statusProgressTile=new c({cart:this.cart})},render:function(){var l=[];var k;l.push(this.orderIdTile.render());if(this.service!==g.STORE){l.push(this.lastUpdateTile.render())}l.push(this.statusProgressTile.render());k=e.createElement("div",{"class":"mpf-order-card-header-content",html:l});this.container.setContent(k);return this},_checkPrototypes:function(k){f.requiredOfPrototype(k.cart,d,"options.cart must be a CartModel")}});return a});define("DS/MPFOrderListComponent/OrderListCommandSort",["UWA/Class/View","DS/UIKIT/Input/Select","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartSorts","DS/MPFSort/SortOrder","DS/MPFSort/SortDirection","DS/MPFSortSelector/SortSelector","DS/MPFServices/MarketplaceServices","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(a,e,b,f,d,i,g,j,c){var h;h=a.extend({className:"mpf-order-list-command-sort",setup:function(k){k||(k={});this.company=k.company;this.me=k.me;this.isSellerView=k.isSellerView;this.service=k.service;this.sortSelector=this._createSortSelector();this.listenTo(this.sortSelector,g.Events.SORT,this._onSortSelected.bind(this))},render:function(){this.container.setContent([this.sortSelector.render()]);return this},destroy:function(){this.company=null;this.me=null;this.stopListening(this.sortSelector);this.sortSelector.destroy();this.sortSelector=null;this._parent();this.container=null},_createSortSelector:function(){return new g({entries:this._createSortOptions()})},_createSortOptions:function(){var k;if(this.isSellerView){k=this._createSortOptionForSeller()}else{if(this.company&&this.me.isAdminOfThisEMP(this.company.getEmpProjectName())){k=this._createSortOptionsForEmpAdmin()}else{k=this._createSortOptionForBuyer()}}return k},_onSortSelected:function(k){var l;if(k.direction===i.DESCENDING){l=f.desc(k.sort)}else{l=k.sort}this.dispatchEvent(b.SORT,{sort:l})},_createSortOptionForBuyer:function(){var k;k=[{label:c.get("modificationDate"),name:f.MODIFICATION_DATE,order:d.NUMERICAL,selected:i.DESCENDING},{label:c.get("creationDate"),name:f.CREATION_DATE,order:d.NUMERICAL},{label:c.get("serviceProvider"),name:f.SERVICE_PROVIDER}];if(this.service!==j.ENGINEERING){k.splice(2,0,{label:c.get("deliveryDate"),name:f.DELIVERY_DATE,order:d.NUMERICAL})}return k},_createSortOptionForSeller:function(){var k;k=[{label:c.get("modificationDate"),name:f.MODIFICATION_DATE,order:d.NUMERICAL,selected:i.DESCENDING},{label:c.get("creationDate"),name:f.CREATION_DATE,order:d.NUMERICAL},{label:c.get("customer"),name:f.CUSTOMER}];if(this.service!==j.ENGINEERING){k.splice(2,0,{label:c.get("deliveryDate"),name:f.DELIVERY_DATE,order:d.NUMERICAL})}return k},_createSortOptionsForEmpAdmin:function(){var k;k=[{label:c.get("modificationDate"),name:f.MODIFICATION_DATE,order:d.NUMERICAL,selected:i.DESCENDING},{label:c.get("creationDate"),name:f.CREATION_DATE,order:d.NUMERICAL},{label:c.get("customer"),name:f.CUSTOMER},{label:c.get("serviceProvider"),name:f.SERVICE_PROVIDER}];if(this.service!==j.ENGINEERING){k.splice(2,0,{label:c.get("deliveryDate"),name:f.DELIVERY_DATE,order:d.NUMERICAL})}return k}});return h});define("DS/MPFOrderListComponent/OrderCard",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/OrderCardHeader","DS/MPFOrderListComponent/OrderCardBody","DS/MPFOrderListComponent/DetailItemsTile","DS/PlatformAPI/PlatformAPI","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],function(h,b,i,k,e,f,a,d,c,j,l){var g=b.extend({className:"mpf-order-card",domEvents:{click:"_goToOrder"},setup:function(m){m||(m={});this._parent(m);this._checkPrototypes(m);this.isSellerView=m.isSellerView===true;this.cart=m.cart;this.serviceView=m.serviceView;this.invoiceFactory=m.invoiceFactory;this.service=h.is(m.service)?m.service:k.MAKE;this.orderCardHeader=new a({service:this.service,cart:this.cart});this.orderCardBody=new d({isSellerView:this.isSellerView,serviceView:this.serviceView,cart:this.cart,invoiceFactory:this.invoiceFactory,service:this.service});if(this.service===k.STORE){this.orderDetailItemsTile=new c({cart:this.cart})}},render:function(){var m;m=[this.orderCardHeader.render(),this.orderCardBody.render()];if(this.service===k.STORE){m.push(this.orderDetailItemsTile.render())}this.container.setContent(m);return this},destroy:function(){if(this.serviceView&&h.is(this.serviceView.destroy,"function")){this.serviceView.destroy()}this.serviceView=null;this.cart=null;this.nda=null;this._parent();this.container=null},_goToOrder:function(){j.publish("changePage",{name:"order",attributes:{id:this.cart.id}})},_checkPrototypes:function(m){i.requiredOfPrototype(m.cart,e,"options.cart must be a CartModel")}});return g});define("DS/MPFOrderListComponent/OrderListCommands",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModelFactory/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFExportOrdersComponent/ExportOrdersComponent","DS/MPFView/EmptyView","DS/MPFOrderListComponent/OrderListCommandFilter","DS/MPFOrderListComponent/OrderListCommandSort","DS/MPFOrderListComponent/OrderListEvents"],function(a,j,h,c,f,b,e,k,i,d){var g;g=a.extend({className:"mpf-order-list-commands",setup:function(l){j.requiredOfPrototype(l.buyerType,c,"options.buyerType must be a BuyerType");j.requiredOfPrototype(l.me,f,"options.me must be a PersonModel");j.requiredOfPrototype(l.exportOrderFactory,h,"options.exportOrderFactory must be an ExportOrderFactory");this.buyerType=l.buyerType;this.me=l.me;this.company=l.company;this.exportOrderFactory=l.exportOrderFactory;this.isSellerView=l.isSellerView===true;this.service=l.service;this.exportCommand=this._createExportCommand();this.filterCommand=this._createFilterCommand();this.sortCommand=this._createSortCommand();this.listenTo(this.filterCommand,d.FILTER_BY_DATE,this._onFilterByDate.bind(this));this.listenTo(this.sortCommand,d.SORT,this._onSort.bind(this))},render:function(){this.container.setContent([this.exportCommand.render(),this.filterCommand.render(),this.sortCommand.render()]);return this},destroy:function(){this.stopListening(this.filterCommand);this.stopListening(this.sortCommand);this.filterCommand.destroy();this.filterCommand=null;this.sortCommand.destroy();this.sortCommand=null;this._parent()},setFilterActive:function(l){this.filterCommand.setActive(l)},_createExportCommand:function(){return this.isSellerView?new e():new b({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory})},_createFilterCommand:function(){return new k()},_createSortCommand:function(){return new i({company:this.company,me:this.me,isSellerView:this.isSellerView,service:this.service})},_onFilterByDate:function(l){this.dispatchEvent(d.FILTER_BY_DATE,l)},_onSort:function(l){this.dispatchEvent(d.SORT,l)}});return g});define("DS/MPFOrderListComponent/OrderListHeader",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartCollection","DS/MPFModelFactory/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/StatusSelectorTile","DS/MPFOrderListComponent/OrderListCommands","DS/MPFOrderListComponent/OrderListEvents"],function(a,g,j,f,b,d,i,e,c){var h;h=a.extend({className:"mpf-order-list-header",setup:function(k){k||(k={});g.requiredOfPrototype(k.carts,j,"options.carts must be a CartCollection");g.requiredOfPrototype(k.buyerType,b,"options.buyerType must be a BuyerType");g.requiredOfPrototype(k.me,d,"options.me must be a PersonModel");g.requiredOfPrototype(k.exportOrderFactory,f,"options.exportOrderFactory must be an ExportOrderFactory");this.carts=k.carts;this.buyerType=k.buyerType;this.me=k.me;this.company=k.company;this.exportOrderFactory=k.exportOrderFactory;this.isSellerView=k.isSellerView===true;this.service=k.service;this.statusSelectorTile=this._createStatusSelectorTile(k.statusSelectorInitValue);this.commands=this._createCommands();this.stateFilter="all";this.listenTo(this.statusSelectorTile,c.FILTER_BY_STATE,this._onFilterByState.bind(this));this.listenTo(this.commands,c.FILTER_BY_DATE,this._onFilterByDate.bind(this));this.listenTo(this.commands,c.SORT,this._onSort.bind(this))},render:function(){this.container.setContent([this.statusSelectorTile.render(),this.commands.render()]);return this},destroy:function(){this.stopListening(this.statusSelectorTile);this.stopListening(this.commands);this.statusSelectorTile.destroy();this.statusSelectorTile=null;this.commands.destroy();this.commands=null;this._parent()},setFilterActive:function(k){this.commands.setFilterActive(k)},_createStatusSelectorTile:function(k){return new i({carts:this.carts,statusSelectorInitValue:k,service:this.service})},_createCommands:function(){return new e({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,service:this.service})},_onFilterByState:function(k){this.dispatchEvent(c.FILTER_BY_STATE,k)},_onFilterByDate:function(k){this.dispatchEvent(c.FILTER_BY_DATE,k)},_onSort:function(k){this.dispatchEvent(c.SORT,k)}});return h});define("DS/MPFOrderListComponent/OrderListPage",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFCartModel/CartSorts","DS/MPFModelFactory/ExportOrderFactory","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFServices/ObjectService","DS/MPFOrderListComponent/OrderListHeader","DS/MPFOrderListComponent/OrderCard","DS/MPFPaginationComponent/PaginationComponent","DS/MPFOrderListComponent/OrderListEvents","DS/MPFView/EmptyView","DS/MPFUtils/MPFUtils","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],function(l,q,g,d,e,c,o,f,m,b,i,v,n,k,h,r,t,j,s,p){var a=10;var u;u=q.extend({className:"mpf-order-list-page",setup:function(w){n.requiredOfPrototype(w.carts,c,"options.carts must be a CartCollection");n.requiredOfPrototype(w.me,v,"options.me must be a PersonModel");n.requiredOfPrototype(w.exportOrderFactory,m,"options.exportOrderFactory must be an ExportOrderFactory");this.isSellerView=w.isSellerView===true;this.carts=w.carts;this.buyerType=w.buyerType;this.me=w.me;this.company=w.company;this.invoiceFactory=w.invoiceFactory;this.exportOrderFactory=w.exportOrderFactory;this.serviceViewFactory=typeof w.serviceViewFactory==="function"?w.serviceViewFactory:s.doNothing;this.service=l.is(w.service)?w.service:e.MAKE;this.statusSelectorInitValue=l.is(w.statusSelectorInitValue)?w.statusSelectorInitValue:o.STATE_PENDING_FILTER;this.header=this._createHeader();this.pagination=this._createPagination();this.fetchOptions={reset:true,start:0,size:a};this.fetchOptions[o.FILTER_BY_STATE]=this.statusSelectorInitValue;this.listenTo(this.header,t.FILTER_BY_STATE,this._onFilterByState.bind(this));this.listenTo(this.header,t.FILTER_BY_DATE,this._onFilterByDate.bind(this));this.listenTo(this.header,t.SORT,this._onSort.bind(this));this.listenTo(this.pagination,r.Events.CHANGE_PAGE,this._onChangePage.bind(this));d.subscribe("SearchBar/search",this._onTopBarSearch.bind(this));d.subscribe("SearchBar/clear",this._onTopBarClear.bind(this))},render:function(){var w;if(this.carts.isEmpty()){w=[this._createEmptyListMessage()]}else{w=this._createOrderCards().map(function(x){return x.render()});w.push(this.pagination.render())}w.unshift(this.header.render());this.container.setContent(w);return this},destroy:function(){this.stopListening(this.header);this.stopListening(this.pagination);d.unsubscribe("SearchBar/search");d.unsubscribe("SearchBar/clear");this.header.destroy();this.header=null;this.pagination.destroy();this.pagination=null;this.carts=null;this.me=null;this._parent();this.container=null},refresh:function(){return this._refreshCarts()},_createHeader:function(){return new k({carts:this.carts,buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,statusSelectorInitValue:this.statusSelectorInitValue,service:this.service})},_createEmptyListMessage:function(){return l.createElement("div",{"class":"mpf-message",html:[{tag:"i","class":"fonticon fonticon-doc-log"},{tag:"h4",text:p.get("orderListEmpty")},{tag:"p",text:p.get("noOrdersMatchingSearchCriteria")}]})},_createOrderCards:function(){return this.carts.map(function(x){var w;w=this.serviceViewFactory({cart:x});return new h({isSellerView:this.isSellerView,cart:x,serviceView:w||j.getInstance(),invoiceFactory:this.invoiceFactory,service:this.service})},this)},_createPagination:function(){return new r({collection:this.carts,pageSize:a})},_refreshCarts:function(){g.mask(this.container);return this.carts.fetchPromise(l.clone(this.fetchOptions)).then(this.render.bind(this))["finally"](g.unmask.bind(null,this.container))},_onFilterByState:function(w){this._resetPage();this.fetchOptions[o.FILTER_BY_STATE]=w[o.FILTER_BY_STATE];this._refreshCarts()},_onFilterByDate:function(w){this._resetPage();switch(w.filter){case o.FILTER_BY_CREATION_DATE_DAYS:this._resetDateFilter();this.fetchOptions[o.FILTER_BY_CREATION_DATE_DAYS]=w.days;this.header.setFilterActive(true);break;case o.FILTER_BY_CREATION_DATE_MONTHS:this._resetDateFilter();this.fetchOptions[o.FILTER_BY_CREATION_DATE_MONTHS]=w.months;this.header.setFilterActive(true);break;case o.FILTER_BY_MODIFICATION_DATE_DAYS:this._resetDateFilter();this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_DAYS]=w.days;this.header.setFilterActive(true);break;case o.FILTER_BY_MODIFICATION_DATE_MONTHS:this._resetDateFilter();this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_MONTHS]=w.months;this.header.setFilterActive(true);break;case o.CLEAR:this._resetDateFilter();this.header.setFilterActive(false);break}this._refreshCarts()},_resetDateFilter:function(){this.header.setFilterActive(false);this.fetchOptions[o.FILTER_BY_CREATION_DATE_MONTHS]=null;this.fetchOptions[o.FILTER_BY_CREATION_DATE_DAYS]=null;this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_DAYS]=null;this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_MONTHS]=null},_onSort:function(w){this._resetPage();if(w&&w.sort){this.fetchOptions[f.SORT]=w.sort}else{this.fetchOptions[f.SORT]=null}this._refreshCarts()},_onChangePage:function(w){var x;w||(w={});x=w.page||1;this.fetchOptions.start=(x-1)*a;this.header.container.scrollIntoView(false);this._refreshCarts()},_resetPage:function(){this.pagination.changePage(1,{silent:true});this.fetchOptions.start=0},_onTopBarSearch:function(w){this._resetPage();this.fetchOptions.search=w;this._refreshCarts()},_onTopBarClear:function(){this._resetPage();this.fetchOptions.search="";this._refreshCarts()}});u.ORDER_PER_PAGE=a;return u});define("DS/MPFOrderListComponent/OrderListPageFactory",["UWA/Promise","DS/MPFOrderListComponent/OrderListPage","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFModelFactory/CartFactory","DS/MPFModelFactory/PersonFactory","DS/MPFModelFactory/CompanyFactory","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartFilters","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType"],function(c,p,q,j,h,d,e,s,l,a,g){function k(t){var u;u=j.getInstance(t);return c.all([u.getFactory(j.Types.CART),u.getFactory(j.Types.PERSON),u.getFactory(j.Types.EXPORT_ORDER)])}function b(t){var u;u=j.getInstance(t);return c.all([u.getFactory(j.Types.CART),u.getFactory(j.Types.PERSON),u.getFactory(j.Types.EXPORT_ORDER),u.getFactory(j.Types.INVOICE)])}function i(w){var t=w[0];var v=w[1];var x=w[2];var u=false;return c.all([r(t),o(v),x]).then(function(B){var A=B[0];var y=B[1];var z=B[2];return c.all([A,y,z,a.fromPerson(y),u])})}function m(x,w){var t=w[0];var v=w[1];var z=w[2];var y=w[3];var u=true;return c.all([f(x,t),o(v),z]).then(function(C){var B=C[0];var A=C[1];var D=C[2];return c.all([B,A,D,a.fromPerson(A),u,y])})}function o(u){var t=u.createModel(d.Types.ME);return t.fetchPromise()}function r(t){var v=t.createCollection(h.Types.ME_V2);var u;u={expand:[s.Expands.CART_ITEMS],start:0,size:p.ORDER_PER_PAGE};u[l.FILTER_BY_STATE]=l.STATE_PENDING_FILTER;return v.fetchPromise(u)}function f(v,t){var w=t.createCollection(h.Types.SELLER_CARTV2);var u;w.setParentResourceId(v);u={expand:[s.Expands.CART_ITEMS],start:0,size:p.ORDER_PER_PAGE};u[l.FILTER_BY_STATE]=l.STATE_PENDING_FILTER;return w.fetchPromise(u)}function n(y,w){var z=w[0];var B=w[1];var x=w[2];var v=w[3];var u=w[4];var A=w[5];var t;var C;t=v.getBuyerType();C={service:y.service,carts:z,me:B,buyerType:t,exportOrderFactory:x,serviceViewFactory:y.serviceViewFactory,isSellerView:u,invoiceFactory:A};if(t===g.COMPANY){C.company=v.getModel()}return new p(C)}return{fromMeBuyer:function(u){var t;u||(u={});t={service:u.service,serviceViewFactory:u.serviceViewFactory};return q.fetchPromise(u).then(k).then(i).then(n.bind(null,t))},fromSeller:function(u){var v;var t;t={service:u.service,serviceViewFactory:u.serviceViewFactory};u||(u={});v=u.shopId;return q.fetchPromise(u).then(b).then(m.bind(null,v)).then(n.bind(null,t))}}});