define("DS/VCXWebStyles/VCXModifiableStyle",["DS/CoreEvents/Events","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo",],function(b,g,c,a,d,f){var e=c.extend({init:function(){this._parent()},OnChangeProperty:function(j,h,i){if(i){}else{i={}}if(i.fromChildClass){}else{if(this.OnChangePropertyBegin(j,h)){return true}}if(j==="Actor.Name"){this.GetObject().SetName(h.Value)}else{var k=this.GetObject().GetPropertySet().GetProperty(j);if(k){k.SetPropertyValue(h.Clone());this.GetObject().GetPropertySet().AddOrModifyProperty(k)}else{i.fromChildClass=true;return this._parent(j,h,i)}}return true},OnChangePropertiesEnd:function(){},GetProperty:function(l){var i;if(l==="Actor.Name"){var k=new a();var j=this.GetObject().GetName();k.SetValue(j);var h=new f(l,f.EBehaviorType.Singleton,true,"VCXWebModifiables/VCXWebModifiables");i=new d(h,k)}else{i=this.GetObject().GetPropertySet().GetProperty(l);if(i){i=i.Clone()}else{i=this._parent(l)}}return i},GetProperties:function(){var h=this._parent();h.AddOrModifyProperty(this.GetProperty("Actor.Name"));h.Merge(this.GetObject().GetPropertySet());return h}});return e});define("DS/VCXWebStyles/VCXComponentStyle",["UWA/Class","DS/VCXWebProperties/VCXPropertySet"],function(a,c){var b=a.extend({init:function(){this.propSet=new c();this.name="Style Name"},GetType:function(){return this.componentType},GetName:function(){return this.name},SetName:function(d){this.name=d},SetPropertySet:function(d){this.propSet=d.Clone()},GetPropertySet:function(){return this.propSet}});Object.defineProperty(b.prototype,"componentType",{enumerable:true,get:function(){return"VCXComponentStyle"}});return b});define("DS/VCXWebStyles/VCXStylesManager",["DS/WebApplicationBase/W3AAManager","DS/WebappsUtils/WebappsUtils","DS/VCXWebKernelTools/VCXFileServices","DS/VCXWebExperienceLoader/VCXExperienceLoaderBase","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebKernelCommands/VCXCmdChangeLinkedProperties","DS/VCXWebProperties/VCXPropertySet","DS/CoreEvents/Events"],function(g,c,a,i,j,f,h,e,b){var d=g.extend({initialize:function(){this.deferredinit=UWA.Promise.deferred();this.stylesForType={};this._stylesID={};this._stylesfiles={};this._styles={};this._stylesIntegerID={};this._stylesNextIntegerID=1;this._isInitialized=true;this._numberOfFilesToLoad=0;this._numberOfFilesLoaded=0;this._masterfilevar=null;this.LoadStyles(this._moduleName);if(this.deferredinit){return this.deferredinit.promise}},unInitialize:function(){this.deferredinit=null;this._isInitialized=false;this._styles=null},postInitialize:function(){},SetModuleName:function(k){this._moduleName=k},GetModuleName:function(){return this._moduleName},ParseMasterFiles:function(r){this._masterfilevar=r;for(var q=0;q<r.styles.length;q++){var s=r.styles[q];var o=s.type;if(s.x){for(var p=0;p<s.x.length;p++){var m=s.x[p];this._numberOfFilesToLoad++;this.LoadStyle(this._moduleName,"styles/"+m+".json",m)}for(var n=0;n<s.y.length;n++){var l=s.y[n];this._numberOfFilesToLoad++;this.LoadStyle(this._moduleName,"styles/"+l+".json",l)}}if(s.list){for(var t=0;t<s.list.length;t++){var k=s.list[t];this._numberOfFilesToLoad++;this.LoadStyle(this._moduleName,"styles/"+k+".json",k)}}}},LoadStyles:function(l){if(!this._moduleName){if(this.deferredinit){this.deferredinit.resolve();this.deferredinit=null}return}var k=c.getWebappsAssetUrl(l,"styles/styles_list.json");a.BlobURLToJSONText(k,this.ParseMasterFiles,this)},LoadStyle:function(n,k,l){var m=c.getWebappsAssetUrl(n,k);this.LoadStyleURL(m,l)},LoadStyleURL:function(m,k){var p=this;var l=k;var o=function(B){var q=l;if(!p._isInitialized){return}p._stylesID[q]=B.objectID;p._stylesfiles[q]=p.BuildStyle(B);p._numberOfFilesLoaded++;if(p._numberOfFilesLoaded===p._numberOfFilesToLoad){console.log("Generating MetaStyles");console.log(p._numberOfFilesLoaded);console.log("\n");p.stylesForType={};var B=p._masterfilevar;for(var A=0;A<B.styles.length;A++){var C=B.styles[A];var x=C.type;p.stylesForType[x]=[];if(C.x){for(var y=0;y<C.x.length;y++){var t=C.x[y];for(var v=0;v<C.y.length;v++){var s=C.y[v];var w=p._stylesfiles[t];var u=p._stylesfiles[s];var z=w.Clone(w);z.Merge(u);var r=p._stylesID[t]+"."+p._stylesID[s];p.BuildStyleFromPropertySet(z,r,t+" "+s);p.stylesForType[x].push(r)}}}if(C.list){for(var D=0;D<C.list.length;D++){var q=C.list[D];var w=p._stylesfiles[q];var z=w.Clone(w);var r=p._stylesID[q];p.BuildStyleFromPropertySet(z,r,q);p.stylesForType[x].push(r)}}}if(p.deferredinit){p.deferredinit.resolve();p.deferredinit=null}}};var n=function(q){a.BlobToFileVar(q,o)};a.BlobURLToBlob(m,"",n)},BuildStyle:function(m){var k=new i();k.InitLoader(this._experienceBase);var l=k.LoadPropSet(m.properties);return l},BuildStyleFromPropertySet:function(k,q,m){k.onEachProperty(function(s,r){var t=r.GetPropertyInfo();t.SetBehaviorType(f.EBehaviorType.Singleton)});var o=this._experienceBase.Factory.BuildComponent("VCXComponentStyle");if(o){o.SetPersistency(2);o.SetID(q);o.SetName(m);this._experienceBase.ComponentsMap.AddComponent(o);this._styles[this._stylesNextIntegerID]=o;this._stylesIntegerID[o.GetID()]=this._stylesNextIntegerID;this._stylesNextIntegerID++}o.SetPropertySet(k);var l=o.QueryInterface("VCXIModifiable");var n=this._experienceBase.getManager("VCXScenarioManager");var p=new j(n,this._experienceBase.getManager("VCXCommandManager"));k.onEachProperty(function(s,r){p.ChangeProperty(l,r)});this._experienceBase.getManager("VCXCommandManager").Do(p);return o},CreateStyle:function(m,l){var k=new e();for(var o=0;o<m.length;o++){k.AddOrModifyProperty(l.GetProperty(m[o]))}var p=this.BuildStyleFromPropertySet(k,"","New Style");var n=[];n.push(p);b.publish({event:"VCX_STYLE_ADDED",data:n})},Subscribe:function(s,t){var q=this._stylesIntegerID[t];var n=this._styles[q];if(n){var p=this._experienceBase.getManager("VCXLinkedPropertyManager");var m=this._experienceBase.getManager("VCXScenarioManager");var r=this._experienceBase.getManager("VCXCommandManager");var o=new h(p,m,r);var l=n.GetPropertySet();var k=this._experienceBase.getManager("VCXScenarioManager");l.onEachProperty(function(v,u){o.AddLink(t,v,s.GetObject().GetID(),v,null)});this._experienceBase.getManager("VCXCommandManager").Do(o)}},UnSubscribe:function(s,t){var q=this._stylesIntegerID[t];var n=this._styles[q];if(n){var p=this._experienceBase.getManager("VCXLinkedPropertyManager");var m=this._experienceBase.getManager("VCXScenarioManager");var r=this._experienceBase.getManager("VCXCommandManager");var o=new h(p,m,r);var l=n.GetPropertySet();var k=this._experienceBase.getManager("VCXScenarioManager");l.onEachProperty(function(v,u){o.RemoveLink(t,v,s.GetObject().GetID(),v)});this._experienceBase.getManager("VCXCommandManager").Do(o)}}});Object.defineProperty(d.prototype,"componentType",{enumerable:true,get:function(){return"VCXStylesManager"}});return d});