define("DS/etree/tree",["DS/egraph/utils","DS/egraph/core"],function(aH,g){var ao={};var M=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame;var am=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame;var v=g.PathCmd.M;var w=g.PathCmd.L;var G=g.PathCmd.C;function ap(bv){bv=bv||{};this.offset=bv.offset!==undefined?bv.offset:0;this.anormx=bv.anormx!==undefined?bv.anormx:0;this.anormy=bv.anormy!==undefined?bv.anormy:-1}ap.prototype.onupdate=function at(bx){var bw,bv;bw=Math.round(bx.node.actualLeft+bx.node.actualWidth*0.5);bv=bx.node.actualTop+this.offset;bx.multiset("left",bw,"top",bv,"aleft",bw,"atop",bv,"anormx",this.anormx,"anormy",this.anormy)};function bs(bv){bv=bv||{};this.offset=bv.offset!==undefined?bv.offset:0;this.anormx=bv.anormx!==undefined?bv.anormx:0;this.anormy=bv.anormy!==undefined?bv.anormy:1}bs.prototype.onupdate=function at(bx){var bw,bv;bw=Math.round(bx.node.actualLeft+bx.node.actualWidth*0.5);bv=bx.node.actualTop+bx.node.actualHeight+this.offset;bx.multiset("left",bw,"top",bv,"aleft",bw,"atop",bv,"anormx",this.anormx,"anormy",this.anormy)};function a0(bv){bv=bv||{};this.offset=bv.offset!==undefined?bv.offset:0;this.anormx=bv.anormx!==undefined?bv.anormx:-1;this.anormy=bv.anormy!==undefined?bv.anormy:0}a0.prototype.onupdate=function at(bx){var bw,bv;bw=bx.node.actualLeft+this.offset;bv=Math.round(bx.node.actualTop+bx.node.actualHeight*0.5);bx.multiset("left",bw,"top",bv,"aleft",bw,"atop",bv,"anormx",this.anormx,"anormy",this.anormy)};function be(bv){bv=bv||{};this.offset=bv.offset!==undefined?bv.offset:0;this.anormx=bv.anormx!==undefined?bv.anormx:1;this.anormy=bv.anormy!==undefined?bv.anormy:0}be.prototype.onupdate=function at(bx){var bw,bv;bw=bx.node.actualLeft+bx.node.actualWidth+this.offset;bv=Math.round(bx.node.actualTop+bx.node.actualHeight*0.5);bx.multiset("left",bw,"top",bv,"aleft",bw,"atop",bv,"anormx",this.anormx,"anormy",this.anormy)};var u=[v,0,0];ao.AutoBezierGeometry=function ad(bw,bv){this.offset1=bw|0;this.offset2=bv|0};ao.AutoBezierGeometry.prototype.onupdate=function(bQ){var bL,bK,bN,bM,bC,bA,bD,bB,bS,bR;var bJ,bI;var bx,bw,bF,bE;var bP,bz,bO,by,bH,bG,bv;bL=bQ.cl1.c;bK=bQ.cl2.c;bN=bL.anormx;bM=bL.anormy;bC=bK.anormx;bA=bK.anormy;bD=bL.aleft;bB=bL.atop;bS=bK.aleft;bR=bK.atop;bJ=this.offset1;bI=this.offset2;if(bJ<0){bJ+=((bS-bD)*bN+(bR-bB)*bM)}if(bI<0){bI+=((bD-bS)*bC+(bB-bR)*bA)}if(bJ<0||bI<0){bQ.set("path",u);return}bx=bD+bJ*bN;bw=bB+bJ*bM;bF=bS+bI*bC;bE=bR+bI*bA;if(bN&&bN*bF<=bN*bx||bM&&bM*bE<=bM*bw||bC&&bC*bx<=bC*bF||bA&&bA*bw<=bA*bE){bQ.set("path",u);return}bH=Math.max(1,Math.abs(bF-bx));bG=Math.max(1,Math.abs(bE-bw));bP=bx+bH*bN*0.5;bz=bw+bG*bM*0.5;bO=bF+bH*bC*0.5;by=bE+bG*bA*0.5;if(bJ&&bI){bv=[v,bD,bB,w,bx,bw,G,bF,bE,bP,bz,bO,by,w,bS,bR]}else{if(bJ){bv=[v,bD,bB,w,bx,bw,G,bF,bE,bP,bz,bO,by]}else{if(bI){bv=[v,bx,bw,G,bF,bE,bP,bz,bO,by,w,bS,bR]}else{bv=[v,bx,bw,G,bF,bE,bP,bz,bO,by]}}}bQ.set("path",bv)};function aq(bx,bw,bv){if(typeof bw!=="undefined"){if(typeof bw!=="number"||!isFinite(bw)||bw<0){throw new Error(bx+" must be either undefined or a finite positive number")}this[bx]=bw}else{this[bx]=bv}}function aa(bx,bw,bv){if(typeof bw!=="undefined"){if(typeof bw!=="number"||!isFinite(bw)){throw new Error(bx+" must be either undefined or a finite number")}this[bx]=bw}else{this[bx]=bv}}function bn(by,bw){function bA(bC,bD){var bB=(bC&&bC.parent)?bC.parent.parent:null;if(!bB){return false}if(bB===bD){return true}else{if(bB.parent){return bA(bB,bD)}else{return false}}}var bx=bA(by,bw);if(!bx){var bv=bA(bw,by);if(!bv){return false}}var bz=ao.DrawingModifiers.HORIZONTAL;if(by.document.drawingModifiers&bz){if(by.top===bw.top){return true}}else{if(by.left===bw.left){return true}}return false}function an(bw){if(bw.data.first){for(var bv=bw.data.first.grNode.next;bv;bv=bv.next){if(bw===bv){break}else{if(bn(bw.data,bv.data)){return true}}}}return false}function ba(bw,bx,bz){var bv=ao.DrawingModifiers.HORIZONTAL;var by=ao.DrawingModifiers.MIRROR_DEPTH;switch(bz&(bv|by)){case 0:bw.anormx=0;bw.anormy=1;bx.anormx=0;bx.anormy=-1;break;case by:bw.anormx=0;bw.anormy=-1;bx.anormx=0;bx.anormy=1;break;case bv:bw.anormx=1;bw.anormy=0;bx.anormx=-1;bx.anormy=0;break;default:bw.anormx=-1;bw.anormy=0;bx.anormx=1;bx.anormy=0;break}}ao.RoundedSquareGeometry=function a8(bv,by,bw,bx){aq.call(this,"radius",bv,4);aq.call(this,"minRadius",bx,1.5);aa.call(this,"offset",by,this.radius);aa.call(this,"auxOffset",bw,this.offset);if(Math.abs(this.offset)<this.radius){throw new Error("offset must be >= radius")}if(Math.abs(this.auxOffset)<this.radius){throw new Error("auxOffset must be >= radius")}};var ai=4*(Math.SQRT2-1)/3;var k=1-ai;ao.RoundedSquareGeometry.prototype.onupdate=function(bL){function bP(bR,bQ){return(bR===bR.node.data.grMergeParentC||bR===bR.node.data.grMergeChildrenC)&&(bQ===bQ.node.data.grMergeParentC||bQ===bQ.node.data.grMergeChildrenC)}function bB(bT,bS,bQ,b1,bU,bW,bR,b0,bZ,bY,bX){var bV=bW*ai;if(bU==="firstPoint"){bX.x=bQ+bT*bW;bX.y=b1+bS*bW;b0.x=bQ;b0.y=b1;if(bR==="y"){bZ.x=b0.x;bZ.y=b0.y+bS*bV;bY.x=bX.x-bT*bV;bY.y=bX.y}else{bZ.x=bX.x-bT*bV;bZ.y=b0.y;bY.x=bX.x;bY.y=bX.y-bS*bV}}else{if(bR==="y"){bX.x=bQ+bT*bW;bX.y=b1;b0.x=bQ;b0.y=b1-bS*bW;bZ.x=bQ;bZ.y=b0.y+bS*bV;bY.x=bX.x-bT*bV;bY.y=b1}else{bX.x=bQ;bX.y=b1+bS*bW;b0.x=bQ-bT*bW;b0.y=b1;bZ.x=b0.x+bT*bV;bZ.y=b1;bY.x=bQ;bY.y=bX.y-bS*bV}}}function bO(){var bV;var bT={},bS={},bR={},bQ={},cg={},cf={},ce={},cd={},cc={},b5={},b3={},b2={},b1={},bZ={},bY={},bX={};bV=this.radius;var b8=bL.cl1.c;var b7=bL.cl2.c;if(bH*bw===-1){var bU=b8.node.actualWidth;var b6=1;var ca=(bx>bM)?-1:1;bB(b6,bH,bA,bx,"firstPoint",bV,"y",bT,bS,bR,bQ);bB(b6,ca,bA+b6*(bU/2),bQ.y,"firstPoint",bV,"x",cg,cf,ce,cd);bB(b6,bw,bN,bM,"firstPoint",bV,"y",bX,bY,bZ,b1);bB(-b6,ca,cd.x,b1.y,"corner",bV,"y",cc,b5,b3,b2)}else{if(bK*by===-1){var bW=b8.node.actualHeight;var b6=1;var cb=(bA>bN)?-1:1;bB(bK,b6,bA,bx,"firstPoint",bV,"x",bT,bS,bR,bQ);bB(cb,b6,bQ.x,bx+b6*(bW/2),"firstPoint",bV,"y",cg,cf,ce,cd);bB(by,b6,bN,bM,"firstPoint",bV,"x",bX,bY,bZ,b1);bB(cb,-b6,b1.x,cd.y,"corner",bV,"x",cc,b5,b3,b2)}}var b4=[];if(bP(b8,b7)){var b0=(b8.node.data.grMergeChildrenC===b8)?b8.node.data.grChildrenC:b8.node.data.grParentC;b4=b4.concat([v,b0.aleft,b0.atop])}else{b4=b4.concat([v,bA,bx,])}b4=b4.concat([w,bT.x,bT.y,G,bQ.x,bQ.y,bS.x,bS.y,bR.x,bR.y,w,cg.x,cg.y,G,cd.x,cd.y,cf.x,cf.y,ce.x,ce.y,w,cc.x,cc.y,G,b2.x,b2.y,b5.x,b5.y,b3.x,b3.y,w,b1.x,b1.y,G,bX.x,bX.y,bZ.x,bZ.y,bY.x,bY.y,w,bN,bM]);if(bP(b8,b7)){var b9=(b7.node.data.grMergeChildrenC===b7)?b7.node.data.grChildrenC:b7.node.data.grParentC;b4=b4.concat([w,b9.aleft,b9.atop])}bL.set("path",b4)}function bC(){var bQ;var bU={},bT={},bS={},bR={};bQ=Math.min(this.radius,Math.abs(bN-bA),Math.abs(bM-bx));if(bK!==0){bB(bK,-bw,bN,bx,"corner",bQ,"x",bU,bT,bS,bR)}else{bB(-by,bH,bA,bM,"corner",bQ,"y",bU,bT,bS,bR)}bL.set("path",[v,bA,bx,w,bU.x,bU.y,G,bR.x,bR.y,bT.x,bT.y,bS.x,bS.y,w,bN,bM])}function bz(){var bT={},bS={},bR={},bQ={},cb={},ca={},b8={},b7={};var bV,bZ,bX,bY,bU,bW,b5,b4,b9,b3,b1;bV=this.radius;bZ=this.minRadius;bY=bG.node.data.grAuxChildrenC===bG?this.auxOffset:this.offset;bU=bv===bE.first;bW=bv===bE.last;if(bW&&!bL.cl1.next&&!bL.cl1.prev){bU=true}if(bK===0){if(bY<0){bY+=bH*(bM-bx)}if(Math.abs(bM-bx)<2*bV){bL.set("path",u);return}if(Math.abs(bA-bN)<=bZ){if(bU||bL.data.temporary){bL.set("path",[v,bA,bx,w,bA,bM])}else{bL.set("path",[v,bA,bx+bH*(bY-bV),w,bA,bM])}return}b4=bN>=bA?1:-1;bX=0.5*Math.abs(bN-bA);if(bX<bV){bV=bX;b5=true;b3=bA;b1=bx+bH*(bY-bV)}else{b5=false}bB(-b4,bw,bN,bM,"firstPoint",bV,"y",b7,b8,ca,cb);bB(b4,bH,bA,cb.y,"corner",bV,"y",bT,bS,bR,bQ)}else{if(bY<0){bY+=bK*(bN-bA)}if(Math.abs(bN-bA)<2*bV){bL.set("path",u);return}if(Math.abs(bx-bM)<=bZ){if(bU||bL.data.temporary){bL.set("path",[v,bA,bx,w,bN,bx])}else{bL.set("path",[v,bA+bK*(bY-bV),bx,w,bN,bx])}return}b4=bM>=bx?1:-1;bX=0.5*Math.abs(bM-bx);if(bX<bV){bV=bX;b5=true;b3=bA+bK*(bY-this.radius);b1=bx}else{b5=false}bB(by,-b4,bN,bM,"firstPoint",bV,"x",b7,b8,ca,cb);bB(bK,b4,cb.x,bx,"corner",bV,"x",bT,bS,bR,bQ)}if(bU||bL.data.temporary||bG===bG.node.data.grMergeChildrenC&&bP(bG,bF)){var b2=[];if(bP(bG,bF)){var b0=(bG.node.data.grMergeChildrenC===bG)?bG.node.data.grChildrenC:bG.node.data.grParentC;b2=b2.concat([v,b0.aleft,b0.atop])}else{b2=b2.concat([v,bA,bx,])}b2=b2.concat([w,bT.x,bT.y,G,bQ.x,bQ.y,bS.x,bS.y,bR.x,bR.y,w,cb.x,cb.y,G,b7.x,b7.y,ca.x,ca.y,b8.x,b8.y,w,bN,bM]);if(bP(bG,bF)){var b6=(bF.node.data.grMergeChildrenC===bF)?bF.node.data.grChildrenC:bF.node.data.grParentC;b2=b2.concat([w,b6.aleft,b6.atop])}bL.set("path",b2)}else{if(b5){bL.set("path",[v,b3,b1,w,bT.x,bT.y,G,bQ.x,bQ.y,bS.x,bS.y,bR.x,bR.y,w,cb.x,cb.y,G,b7.x,b7.y,ca.x,ca.y,b8.x,b8.y,w,bN,bM])}else{if(bW){bL.set("path",[v,bT.x,bT.y,G,bQ.x,bQ.y,bS.x,bS.y,bR.x,bR.y,w,cb.x,cb.y,G,b7.x,b7.y,ca.x,ca.y,b8.x,b8.y,w,bN,bM])}else{bL.set("path",[v,cb.x,cb.y,G,b7.x,b7.y,ca.x,ca.y,b8.x,b8.y,w,bN,bM])}}}}function bJ(){var bT={},bS={},bR={},bQ={},cd={},cc={},cb={},ca={},b9={},b6={},b4={},b3={},b2={},b0={},bZ={},bY={};var bV=this.radius;if(bK===0&&by===0){var bU=bG.node.actualWidth;var b7=bN>=bA?1:-1;var bW=Math.abs(bN-bA)/4;if(bW<bV){bV=bW}bB(b7,bH,bA,bx,"firstPoint",bV,"y",bT,bS,bR,bQ);bB(b7,bH,bA+b7*bU/2,bQ.y,"firstPoint",bV,"x",cd,cc,cb,ca);bB(-b7,bw,bN,bM,"firstPoint",bV,"y",bY,bZ,b0,b2);bB(b7,bH,ca.x,b2.y,"corner",bV,"y",b9,b6,b4,b3)}else{var bX=bG.node.actualWidth;var b7=bM>=bx?1:-1;var bW=Math.abs(bM-bx)/4;if(bW<bV){bV=bW}bB(bK,b7,bA,bx,"firstPoint",bV,"x",bT,bS,bR,bQ);bB(bK,b7,bQ.x,bx+b7*bX/2,"firstPoint",bV,"y",cd,cc,cb,ca);bB(by,-b7,bN,bM,"firstPoint",bV,"x",bY,bZ,b0,b2);bB(bK,b7,b2.x,ca.y,"corner",bV,"x",b9,b6,b4,b3)}var b5=[];if(bP(bG,bF)){var b1=(bG.node.data.grMergeChildrenC===bG)?bG.node.data.grChildrenC:bG.node.data.grParentC;b5=b5.concat([v,b1.aleft,b1.atop])}else{b5=b5.concat([v,bA,bx,])}b5=b5.concat([w,bT.x,bT.y,G,bQ.x,bQ.y,bS.x,bS.y,bR.x,bR.y,w,cd.x,cd.y,G,ca.x,ca.y,cc.x,cc.y,cb.x,cb.y,w,b9.x,b9.y,G,b3.x,b3.y,b6.x,b6.y,b4.x,b4.y,w,b2.x,b2.y,G,bY.x,bY.y,b0.x,b0.y,bZ.x,bZ.y,w,bN,bM]);if(bP(bG,bF)){var b8=(bF.node.data.grMergeChildrenC===bF)?bF.node.data.grChildrenC:bF.node.data.grParentC;b5=b5.concat([w,b8.aleft,b8.atop])}bL.set("path",b5)}var bG,bF,bK,bH,by,bw,bA,bx,bN,bM;var bE,bv;bG=bL.cl1.c;bF=bL.cl2.c;bK=bG.anormx;bH=bG.anormy;by=bF.anormx;bw=bF.anormy;bA=bG.aleft;bx=bG.atop;bN=bF.aleft;bM=bF.atop;bE=bG.node.data;bv=bF.node.data;if(bn(bG.node.data,bF.node.data)){bO.call(this)}else{if(bK&&bK*bN<bK*bA||bH&&bH*bM<bH*bx||by&&by*bA<by*bN||bw&&bw*bx<bw*bM){bL.set("path",u);return}if(bK*by+bH*bw){var bD=(bH!==0);if((bD&&bG.node.actualTop!==bF.node.actualTop)||(!bD&&bG.node.actualLeft!==bF.node.actualLeft)){if((bD&&Math.abs(bG.node.actualTop-bF.node.actualTop)>bG.node.data.document.rowPadding+bG.node.actualHeight)||(!bD&&Math.abs(bG.aleft-bF.aleft)>bG.node.data.document.rowPadding+bG.node.actualWidth)){if(bG===bG.node.data.grMergeChildrenC&&bF===bF.node.data.grMergeParentC||bG===bG.node.data.grMergeChildrenC&&bF===bF.node.data.grMergeParentC){var bI=(bF===bF.node.data.grMergeParentC)?bG:bF;if(an(bI.node)){bJ.call(this);return}}}}bz.call(this)}else{bC.call(this)}}};ao.DisplayFlags={DRAGGED:1,DRAG_NODE:2};function Q(bx,bv,bw){bx.updateLock();try{return bw.apply(bv,Array.prototype.slice.call(arguments,3))}finally{bx.updateUnlock()}}ao.Node=function bb(bv){this.data=bv;this.first=null;this.last=null;this.prev=null;this.next=null;this.parent=null;this.grNode=null;this.grParentC=null;this.grMergeParentC=null;this.grMergeChildrenC=null;this.grChildrenC=null;this.grAuxChildrenC=null;this.expanded=false;this.document=null;this.left=0;this.top=0;this._actualPositionsSet=false;this.height=NaN;this.startLeft=0;this.startTop=0;this.widthAnimation=null;this.heightAnimation=null;this.id=-1;this.__updateFlags__=0;this.__lastParent__=null;this.displayFlags=0;this.__configFlags__=0};ao.Node.Type=0;ao.Node.TypeString="node";ao.Node.prototype.type=ao.Node.Type;ao.Node.prototype.typeString=ao.Node.TypeString;ao.Node.prototype.toString=function aV(){if(this.data&&this.data.toString!==Object.prototype.toString){return this.typeString+"("+this.data+")"}else{return this.typeString}};function A(bv){var by,bw,bx;bw=this.document;if(!bw){if(ao.traceUpdates){console.log("don't update document of "+bv+" because "+this+" has no document yet")}return}for(by=bv;by;by=by.dftNext(bv,bx)){if(!by.document){if(ao.traceUpdates){console.log("update document of "+by)}by.document=bw;bx=false}else{if(by.document!==bw){throw new Error("mixing documents is not allowed (yet?)")}if(ao.traceUpdates){console.log("bypass updating document of "+by+" and its children because it is already in a document")}bx=true}}}ao.Node.prototype.setExpanded=function bp(bv,bw){var by,bx;bx=this.document;if(bx&&!bx.updateLockCount){return Q(bx,this,bp,bv,bw)}bv=Boolean(bv);for(by=this;by;by=bw?by.dftNext(this):null){if(by.expanded!==bv){by.expanded=bv;if(bv&&by.heightAnimation){r.call(bx,by.heightAnimation)}if(bx){if(ao.traceUpdates){console.log("expanded flag changed for "+by)}aJ.call(bx,by);by.__updateFlags__|=8}else{if(ao.traceUpdates){console.log("no document when expanded flag changed for "+by)}}}}};ao.Node.prototype.setDragged=function x(bv){var bx=ao.DisplayFlags.DRAGGED;var by,bw;bw=this.document;if(bw&&!bw.updateLockCount){return Q(bw,this,x,bv)}bv=Boolean(bv);for(by=this;by;by=by.dftNext(this)){if(Boolean(by.displayFlags&bx)!==bv){if(ao.traceUpdates){console.log("dragged flag changed for "+by)}if(bv){by.displayFlags|=ao.DisplayFlags.DRAGGED}else{by.displayFlags&=~ao.DisplayFlags.DRAGGED}if(bw){aJ.call(bw,by);by.__updateFlags__|=128}}}};ao.Node.prototype.setHeight=function ay(bv,bw){var bx;aH.pos_number_or_nan_arg("height",bv);if(bw===undefined){bw=0}aH.pos_number_arg("animationDuration",bw);bx=this.document;if(bx&&!bx.updateLockCount){return Q(bx,this,ay,bv,bw)}this.height=bv;if(bx){if(ao.traceUpdates){console.log("change height of "+this+" to "+bv)}aJ.call(bx,this);this.__updateFlags__|=4096;if(this.grNode&&(this.type!==ao.Group.Type||!this.expanded)){a1.call(bx,aQ,this,bw,this.grNode.height,aX(this))}}else{if(ao.traceUpdates){console.log("no document when changing height of "+this+" to "+bv)}}};ao.Node.prototype.notifyUpdate=function j(bw,bv){var bx;bx=this.document;if(bx&&!bx.updateLockCount){return Q(bx,this,j,bw,bv)}if(this.grNode){if(ao.traceUpdates){console.log("notify update of property "+bw+" of "+this)}this.grNode.notify(new g.UpdatedNotif(["data","data",bw],bv))}else{if(ao.traceUpdates){console.log("don't notify update of property "+bw+" of "+this+" because of no view")}}};ao.Node.prototype.appendChild=function(bv){return this.insertBefore(bv,null)};ao.Node.prototype.removeMergeWith=function az(bv){var bA;bA=this.document;if(bA&&!bA.updateLockCount){return Q(bA,this,az,bv)}if(bA.drawing!==ao.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY){throw new Error("Merge is not accepted in this drawing mode : "+bA.drawing)}if(bv.mergeParent&&bv.mergeParent.indexOf(this)===-1&&bv.mergeChild&&bv.mergeChild.indexOf(this)===-1){throw new Error("This merge link does not exist")}var bx,bw,bB,bz=-1,by=-1;if(bv.mergeParent&&this.mergeChild){bz=bv.mergeParent.indexOf(this);by=this.mergeChild.indexOf(bv)}if(bz!==-1&&by!==-1){bw=this;bB=bv}else{if(ao.traceUpdates){console.log("No proper merge exist between "+bw+" and "+bB)}return}this.mergeChild.splice(by,1);if(this.mergeChild.length===0){this.mergeChild=null}bv.mergeParent.splice(bz,1);if(bv.mergeParent.length===0){bv.mergeParent=null}if(bB.document&&this.document){if(ao.traceUpdates){console.log("remove merge between "+bw+" and "+bB)}aJ.call(bB.document,bB);bB.__updateFlags__|=16384;aJ.call(this.document,this);this.__updateFlags__|=16384}else{if(ao.traceUpdates){console.log("ignore merge between "+bw+" and "+bB+" since no document")}}};ao.Node.prototype.removeChild=function bd(bv){var bw;bw=this.document;if(bw&&!bw.updateLockCount){return Q(bw,this,bd,bv)}if(bv.parent!==this){throw new Error("not the expected parent!")}if(bv.prev){bv.prev.next=bv.next}else{this.first=bv.next}if(bv.next){bv.next.prev=bv.prev}else{this.last=bv.prev}bv.prev=bv.next=null;bv.parent=null;if(bv.document){if(ao.traceUpdates){console.log("remove "+bv+" from "+this)}aJ.call(bv.document,bv);if(bv.__updateFlags__&2){bv.__updateFlags__&=~2}else{bv.__updateFlags__|=4;bv.__lastParent__=this}}else{if(ao.traceUpdates){console.log("ignore remove "+bv+" from "+this+" since no document")}}};ao.Node.prototype.insertBefore=function aK(bw,bv){var bx;bx=this.document;if(bx&&!bx.updateLockCount){return Q(bx,this,aK,bw,bv)}switch(this.type){case ao.Group.Type:if(bw.type!==ao.Node.Type||bw.first){throw new Error("only leaf nodes can be inserted in a group")}break;case ao.Node.Type:if(this.parent&&this.parent.type===ao.Group.Type){throw new Error("can't insert anything in a node that is in a group")}default:switch(bw.type){case ao.Node.Type:case ao.Group.Type:break;default:throw new Error("only nodes or groups can be appended, not "+bw.typeString)}}if(bv===bw){throw new Error("can't insert an element before itself")}if(bv&&bv.parent!==this){throw new Error("next is not a child of this")}if(bw.parent!==null){bw.__lastParent__=bw.parent;bw.parent.removeChild(bw)}bw.next=bv||null;bw.prev=bv?bv.prev:this.last;if(bw.next){bw.next.prev=bw}else{this.last=bw}if(bw.prev){bw.prev.next=bw}else{this.first=bw}bw.parent=this;A.call(this,bw);if(bw.document){if(ao.traceUpdates){console.log("insert "+bw+" in "+this+" before "+bv)}aJ.call(bw.document,bw);bw.__updateFlags__|=2}else{if(ao.traceUpdates){console.log("ignore insert "+bw+" in "+this+" because no doc")}}return bw};ao.Node.prototype.mergeWith=function aD(by,bv){var bw;bw=this.document;if(bw&&!bw.updateLockCount){return Q(bw,this,aD,by)}if(bw.drawing!==ao.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY){throw new Error("Merge is not accepted in this drawing mode : "+bw.drawing)}switch(this.type){case ao.Group.Type:throw new Error("Groups can't be considered in a merge");break;default:switch(by.type){case ao.Node.Type:case ao.Group.Type:break;default:throw new Error("only nodes or groups can be merged, not "+by.typeString)}}if(!by.mergeParent){by.mergeParent=[]}if(!this.mergeChild){this.mergeChild=[]}if(by.mergeParent.indexOf(this)!==-1&&this.mergeChild.indexOf(by)!==-1){if(ao.traceUpdates){console.log("merge between "+this+" (parent) and "+by+" (child) already exists")}return}by.mergeParent.push(this);this.mergeChild.push(by);if(by.document&&this.document){if(ao.traceUpdates){console.log("merge of "+this+" (parent) with "+by+" (child)")}aJ.call(by.document,by);aJ.call(this.document,this);by.__updateFlags__|=16384;this.__updateFlags__|=16384}else{if(ao.traceUpdates){console.log("ignore merge of "+this+" with "+by+" because no doc")}}var bx=bw.getGeometryFromOptions(bv);bw.mergeEdgeGeomCol=bw.mergeEdgeGeomCol||[];bw.mergeEdgeGeomCol.push({mergeParent:this,mergeChild:by,mergeEdgeGeom:bx})};ao.Node.prototype.dftNext=function a(bv,bw){var bx;if(!bw&&this.first){return this.first}else{for(bx=this;bx!==bv&&!bx.next;bx=bx.parent){}return bx!==bv?bx.next:null}};ao.NodeIterator=function aL(bv,bx){var bw;if(!(bv instanceof ao.Node)){throw new Error("root must be a Node")}if(bx&&!(bx instanceof ao.Node)){throw new Error("start must be null/undefined or a Node")}this.root=bv;this.n=bx||bv;this.depth=0;for(bw=this.n;bw&&bw!==bv;bw=bw.parent){this.depth+=1}if(bw!==bv){throw new Error("start is not a child of root")}};ao.NodeIterator.prototype.dftNext=function a(bw){var bx,bv;if(!this.n){return null}if(!bw&&this.n.first){this.depth+=1;this.n=this.n.first}else{for(bv=this.root,bx=this.n;bx!==bv&&!bx.next;bx=bx.parent){this.depth-=1}this.n=bx!==bv?bx.next:null}return this.n};ao.NodeIterator.prototype.nextNeighbor=function aj(bv){var bx,bw;bw=this.depth;this.dftNext(true);while(bx=this.n,bx&&this.depth!==bw){this.dftNext(bv&&!bx.expanded)}return bx};ao.NodeIterator.prototype.nextNeighbor2=function aj(bv){var bx,bw;bw=this.depth;this.dftNext(true);while(bx=this.n,bx&&this.depth!==bw){this.dftNext(bv(bx))}return bx};ao.Node.prototype.clear=function aR(){var bv;bv=this.document;if(bv&&!bv.updateLockCount){return Q(bv,this,aR)}while(this.first){this.removeChild(this.first)}};ao.Node.prototype.getActualWidth=function aO(){var bv;bv=this.document;return bv?bv.nodeWidth:NaN};ao.Node.prototype.getActualHeight=function bu(){var bv,bw;bv=this.height;if(bv!==bv){bw=this.document;return bw?bw.nodeHeight:NaN}return bv};ao.Node.prototype.isLeaf=function I(){var bv=false;var bx=this.type!==ao.Group.Type?this.first:null;var bw=bx?bx.next:null;if(!this.first||!this.expanded||((!bx||!bx.first||!bx.expanded)&&(!bw||!bw.first||!bw.expanded))){bv=true}return bv};ao.Group=function aC(bv){ao.Node.call(this,bv);this.expandedWidth=NaN;this.expandedHeight=NaN};aH.inherit(ao.Group,ao.Node);ao.Group.Type=2;ao.Group.TypeString="group";ao.Group.prototype.type=ao.Group.Type;ao.Group.prototype.typeString=ao.Group.TypeString;ao.Group.prototype.getCollapsedWidth=function ak(){var bv;bv=this.document;return bv?bv.groupWidth:NaN};ao.Group.prototype.getActualWidth=function h(){if(this.expanded){return this.expandedWidth}return this.getCollapsedWidth()};ao.Group.prototype.getCollapsedHeight=function D(){var bv,bw;bv=this.height;if(bv!==bv){bw=this.document;return bw?bw.groupHeight:NaN}return bv};ao.Group.prototype.getActualHeight=function aU(){if(this.expanded){return this.expandedHeight}return this.getCollapsedHeight()};ao.mergeSiblingGroups=function f(bv,bx){var by,bw,bB,bz,bA;if(bv.type!==ao.Group.Type){throw new Error("grp must be a group")}if(!bv.next||bv.next.type!==ao.Group.Type){throw new Error("grp next sibling must be a group")}by=bv;bw=bv.next;if(bx){for(bB=bw.first;bB;bB=bz){bz=bB.next;by.insertBefore(bB,null)}bw.parent.removeChild(bw)}else{for(bB=by.last;bB;bB=bA){bA=bB.prev;bw.insertBefore(bB,bw.first)}by.parent.removeChild(by)}};ao.Drawing={LAYERED:0,LAYERED_TIDY_1:1,BRANCHED:2,TWO_BRANCHES:3,TWO_BRANCHES_LEAVES_ON_EXTREMITY:4};ao.DrawingModifiers={HORIZONTAL:1,MIRROR_DEPTH:2,MIRROR_SIBLINGS:4};var aE=[];aE[ao.Drawing.LAYERED]=J;aE[ao.Drawing.LAYERED_TIDY_1]=t;aE[ao.Drawing.BRANCHED]=K;aE[ao.Drawing.TWO_BRANCHES]=c;aE[ao.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY]=aF;var E=0;var aQ=1;var a7=["width","height"];function q(){this.property=-1;this.next=null;this.prev=null;this.node=null;this.duration=0;this.startTime=NaN;this.startValue=0;this.endValue=0}q.prototype.reset=function ax(by,bx,bz,bw,bv){this.property=by;this.next=null;this.prev=null;this.node=bx;this.duration=bz;this.startTime=NaN;this.startValue=bw;this.endValue=bv};function a1(bz,bx,bA,bw,bv){var by;switch(bz){case E:by=bx.widthAnimation;break;case aQ:by=bx.heightAnimation;break;default:throw new Error("internal error")}if(by){r.call(this,by)}if(this.animationCache.length){by=this.animationCache.pop()}else{by=new q()}by.reset(bz,bx,bA,bw,bv);switch(bz){case E:bx.widthAnimation=by;break;case aQ:bx.heightAnimation=by;break;default:throw new Error("internal error")}this.animationList.addLast(by)}function r(bw){var bv;bv=bw.node;switch(bw.property){case E:if(bv.widthAnimation!==bw){throw new Error("internal error")}bv.widthAnimation=null;break;case aQ:if(bv.heightAnimation!==bw){throw new Error("internal error")}bv.heightAnimation=null;break;default:throw new Error("internal error")}if(this.lastAnimation===bw){this.lastAnimation=bw.prev}this.animationList.remove(bw);this.animationCache.push(bw)}ao.Document=function aA(bv){ao.Node.call(this,bv);g.Observable.call(this);this.document=this;this.gr=new g.EGraph();this.gr.data=this;this.nodeViewFactories=[];this.groupViewFactories=[];this.edgeViewFactories=[];this.tempNodeViewFactories=[];this.tempGroupViewFactories=[];this.tempEdgeViewFactories=[];this.expanded=true;this.requestAnimationFramePending=false;this.positionsAnimationStart=Infinity;this.animationList=new g.List();this.animateUpdate=true;this.lastAnimation=null;this.fixNode=null;this.fixNodeLeft=NaN;this.fixNodeTop=NaN;this.fixNodeWidth=NaN;this.fixNodeHeight=NaN;this.fixNodeAlignmentH=0;this.fixNodeAlignmentV=0;this.__updatedNodes__=[];this.nodeWidth=50;this.nodeHeight=50;this.groupWidth=100;this.groupHeight=80;this.groupEmptyWidth=50;this.groupEmptyHeight=50;this.groupPaddingTop=20;this.groupPaddingRight=20;this.groupPaddingBottom=20;this.groupPaddingLeft=20;this.groupColPadding=10;this.groupRowPadding=10;this.groupAspectRatio=1.5;this.siblingPadding=10;this.subtreePadding=undefined;this.rowPadding=10;this.mergeConnectorPadding=2;this.drawing=ao.Drawing.LAYERED_TIDY_1;this.drawingModifiers=0;this.drawingData=undefined;this.updateLockCount=0;this.parentTopCstr=null;this.parentBottomCstr=null;this.parentLeftCstr=null;this.parentRightCstr=null;this.childrenTopCstr=null;this.childrenBottomCstr=null;this.childrenLeftCstr=null;this.childrenRightCstr=null;this.sideParentTopCstr=null;this.sideParentBottomCstr=null;this.sideParentLeftCstr=null;this.sideParentRightCstr=null;this.mergeParentTopCstr=null;this.mergeParentBottomCstr=null;this.mergeParentLeftCstr=null;this.mergeParentRightCstr=null;this.mergeChildrenTopCstr=null;this.mergeChildrenBottomCstr=null;this.mergeChildrenLeftCstr=null;this.mergeChildrenRightCstr=null;this.auxChildrenTopCstr=null;this.auxChildrenBottomCstr=null;this.auxChildrenLeftCstr=null;this.auxChildrenRightCstr=null;this.parentConnectorCstr=null;this.childrenConnectorCstr=null;this.sideParentConnectorCstr=null;this.mergeParentConnectorCstr=null;this.mergeChildrenConnectorCstr=null;this.auxChildrenConnectorCstr=null;this.alignmentH=0;this.alignmentV=0;this.geometry=null;this.onnodedetached=null;this.__docUpdateFlags__=4;this.__debug_flags__=0;this.animationCache=[]};aH.inherit(ao.Document,ao.Node);aH.applyMixin(ao.Document,g.Observable);ao.Document.Type=1;ao.Document.TypeString="document";ao.Document.prototype.type=ao.Document.Type;ao.Document.prototype.typeString=ao.Document.TypeString;ao.Document.prototype.animationDuration=150;function a2(bw,bv){this.id=bw;this.factory=bv}a2.prototype.toString=function aV(){return this.id+":"+this.factory.name};ao.Document.prototype.vetoUpdateAnimation=function aN(){if(!this.updateLockCount){throw new Error("can apply veto when update is not locked")}this.animateUpdate=false};function a9(bv){return typeof(bv)==="number"&&bv>0&&isFinite(bv)}a9.desc="a strictly positive finite number";function y(bv){return typeof(bv)==="number"&&bv>=0&&isFinite(bv)}y.desc="a positive or zero finite number";function U(bv){return bv===undefined}U.desc="undefined";function W(bx,bw){var bv;bv=function by(bz){return bx(bz)||bw(bz)};bv.desc=bx.desc+" or "+bw.desc;return bv}function o(bv){return typeof bv==="number"&&(bv|0)===bv}o.desc="an integer in etree/tree.Drawing";function F(bv){return typeof bv==="number"&&(bv|0)===bv}F.desc="a combination of values in etree/tree.DrawingModifiers";var bk=(function al(bx){var bv;bv=Object.create(null);bx.forEach(function bw(by){bv[by.key]=by});return bv}([{key:"nodeHeight",predicate:a9,docUpdateFlags:16},{key:"groupWidth",predicate:a9,docUpdateFlags:16},{key:"nodeWidth",predicate:a9,docUpdateFlags:16},{key:"groupHeight",predicate:a9,docUpdateFlags:16},{key:"groupEmptyWidth",predicate:a9,docUpdateFlags:16},{key:"groupEmptyHeight",predicate:a9,docUpdateFlags:16},{key:"groupPaddingTop",predicate:y,docUpdateFlags:8},{key:"groupPaddingRight",predicate:y,docUpdateFlags:8},{key:"groupPaddingBottom",predicate:y,docUpdateFlags:8},{key:"groupPaddingLeft",predicate:y,docUpdateFlags:8},{key:"groupColPadding",predicate:y,docUpdateFlags:8},{key:"groupRowPadding",predicate:y,docUpdateFlags:8},{key:"groupAspectRatio",predicate:a9,docUpdateFlags:8},{key:"siblingPadding",predicate:y,docUpdateFlags:8},{key:"subtreePadding",predicate:W(U,y),docUpdateFlags:8},{key:"rowPadding",predicate:y,docUpdateFlags:8},{key:"mergeConnectorPadding",predicate:y,docUpdateFlags:8},{key:"drawing",predicate:o,docUpdateFlags:1},{key:"drawingModifiers",predicate:F,docUpdateFlags:2}]));ao.Document.prototype.set=function P(bw,bv){var bx;bx=bk[bw];if(!bx){throw new Error("property "+bw+" can't be set")}if(!bx.predicate(bv)){throw new Error(bw+" must be "+bx.predicate.desc)}if(!this.updateLockCount){return Q(this,this,P,bw,bv)}if(bv===this[bw]){return}this[bw]=bv;this.__docUpdateFlags__|=bx.docUpdateFlags};ao.Document.prototype.setFixNode2=function L(by,bv){var bx,bD,bw,bE,bB,bC,bA,bF,bz;if(!by){this.fixNode=null;this.fixNodeLeft=NaN;this.fixNodeTop=NaN;this.fixNodeWidth=NaN;this.fixNodeHeight=NaN;this.fixNodeAlignmentH=0;this.fixNodeAlignmentV=0;return}if(!(by instanceof ao.Node)||by.type!==ao.Node.Type&&by.type!==ao.Group.Type){throw new Error("node must be a Node")}if(by.document!==this){throw new Error("node must be in this document")}bF=aH.finite_number_or_nan_opt(bv,"alignmentH",NaN);bz=aH.finite_number_or_nan_opt(bv,"alignmentV",NaN);bB=bv&&bv.position||"current";bC=typeof bB;switch(bC){case"string":for(bA=by;bA&&!bA.grNode;bA=bA.parent){}if(!bA){throw new Error("no position can be computed for since none of this parent have ever been visualized")}switch(bB){case"current":bx=bA.grNode.left;bD=bA.grNode.top;bw=bA.grNode.width;bE=bA.grNode.height;break;case"final":bx=bA.left;bD=bA.top;bw=bq(bA);bE=aX(bA);break;default:throw new Error('opts.position string must be either "current" or "final", not '+bB)}break;case"object":bx=bB.left;bD=bB.top;if(!isFinite(bx)||!isFinite(bD)){throw new Error("opts.position.left and opts.position.top must be finite numbers")}bw=bq(by);bE=aX(by);break;default:throw new Error("opts.position must be either a string or an object, not "+bC)}this.fixNode=by;this.fixNodeLeft=bx;this.fixNodeTop=bD;this.fixNodeWidth=bw;this.fixNodeHeight=bE;this.fixNodeAlignmentH=bF;this.fixNodeAlignmentV=bz};ao.Document.prototype.setFixNode=function ag(bx,bw){var bv;bv=Object.create(bw||Object.prototype);bv.alignmentH=0;bv.alignmentV=0;this.setFixNode2(bx,bv)};ao.Document.prototype.setDrawing=function d(bw,bv){if(!this.updateLockCount){return Q(this,this,d,bw,bv)}if(typeof bw!=="undefined"){this.set("drawing",bw)}if(typeof bv!=="undefined"){this.set("drawingModifiers",bv)}};function C(bv){return !bv.expanded||bv.type===ao.Group.Type}ao.Document.prototype.getBounds=function bh(){var bv,bw;bv=new aH.BoundingRect();for(bw=this.first;bw;bw=bw.dftNext(this,C(bw))){bv.update(bw,bw.left,bw.left+bq(bw),bw.top,bw.top+aX(bw))}return bv};ao.Document.prototype.addView2=function bf(bC,bv,bA){function bw(){var bE,bH,bD,bF,bG;for(bH=this.first;bH;bH=bH.dftNext(this,!bH.grNode)){switch(bH.type){case ao.Node.Type:bE=by;break;case ao.Group.Type:bE=bx;break;default:throw new Error("internal error")}if(bE&&bH.grNode){bD=bE(bH);if(bD){bH.grNode.views[bC]=bD}}if(bz&&bH.grParentC&&(bF=bH.grParentC.children.first,bF)){bG=bF.ref;bD=bz(bG);if(bD){bG.views[bC]=bD}}}}function bB(bF,bE){var bD;bD=bA[bE];switch(typeof bD){case"undefined":return undefined;case"function":break;default:throw new Error("opts."+bE+" should be undefined or a function")}bF.push(new a2(bC,bD));return bD}var by,bx,bz;if(bA===undefined){bA={}}else{if(typeof bA!=="object"||!bA){throw new Error("opts must be an object or undefined")}}if(this.gr.views.hasOwnProperty(bC)){throw new Error('graph already has a "'+bC+'" view')}by=bB(this.nodeViewFactories,"newNodeView");bB(this.tempNodeViewFactories,"newTempNodeView");bx=bB(this.groupViewFactories,"newGroupView");bB(this.tempGroupViewFactories,"newTempGroupView");bz=bB(this.edgeViewFactories,"newEdgeView");bB(this.tempEdgeViewFactories,"newTempEdgeView");if(by||bz){Y(this,bw,[])}Y(this.gr,this.gr.addView,[bC,bv],"gr.addView")};ao.Document.prototype.addView=function ac(bB,bv,bw,by,bx,bA){function bz(bD,bE){switch(typeof bE){case"function":return function bC(bF){return new bE(bF)};case"undefined":return undefined;default:throw new Error(bD+" should be a function or undefined")}}this.addView2(bB,bv,{newNodeView:bz("nodeViewCtor",bw),newEdgeView:bz("edgeViewCtor",by),newTempNodeView:bz("tempNodeViewCtor",bx),newTempEdgeView:bz("tempEdgeViewCtor",bA)})};ao.Document.prototype.setExpanded=function bp(){throw new Error("can't collapse/expand the document")};ao.Document.prototype.getActualWidth=function a6(){return 0};ao.Document.prototype.getActualHeight=function a4(){return 0};ao.Document.prototype.getGeometryFromOptions=function(bz){var bv,bC,bw,bx,by,bA,bB;if(bz&&bz.edges){if(typeof bz.edges!=="object"||typeof bz.edges.type!=="string"){throw new Error("opts.edges must be an object with a 'type' string property")}bw=bz.edges}else{bw={type:"rounded-square"}}if(bz&&bz.childrenAttachmentOffset){bx=bz.childrenAttachmentOffset|0}else{bx=0}if(Math.abs(bx)>this.rowPadding){throw new Error("absolute value of childrenAttachmentOffset must be less or equal to rowPadding")}bA=this.subtreePadding;if(bA===undefined){bA=this.siblingPadding}switch(bw.type){case"auto-bezier":bB=new ao.AutoBezierGeometry(bx,0);break;case"rounded-square":switch(typeof bw.offset){case"undefined":if(bx>=0){bC=(this.rowPadding-bx)>>>1}else{bC=bx>>1}break;case"number":if(!isFinite(bw.offset)||Math.abs(bw.offset)>(bx>=0?this.rowPadding-bx:-bx)){throw new Error("opts.edges.offset must be finite number whose absolute value is smaller or equal to the row padding minus opts.edges.childrenAttachmentOffset")}bC=bw.offset;break;default:throw new Error("opts.edges.offset must be a number or undefined")}switch(typeof bw.radius){case"undefined":bv=Math.min(bx>=0?this.rowPadding-bx:-bx,this.siblingPadding,bA)>>>2;break;case"number":if(!isFinite(bw.radius)||bw.radius<0||bw.radius>Math.abs(bC)){throw new Error("opts.edges.radius must be finite positive number smaller or equal to half the available space after padding and attachment offset")}bv=bw.radius;break;default:throw new Error("opts.edges.radius must be a number or undefined")}by=Math.min(bA,this.siblingPadding)>>>1;bB=new ao.RoundedSquareGeometry(bv,bC<0?bC:bC+bx,by);break;default:throw new Error("opts.edges.type must be either 'auto-bezier' or 'rounded-square'")}return bB};function l(){function bw(bx){Y(bv,bt,[bx])}var bv=this;if(this.requestAnimationFramePending){return}this.requestAnimationFramePending=true;M(bw)}function bt(bz){function bx(){var bB,bF,bE,bA,bD,bC;if(this.positionsAnimationStart===Infinity){return 0}if(isNaN(this.positionsAnimationStart)){this.positionsAnimationStart=bz;return 1}bB=true;bE=(bz-this.positionsAnimationStart)/this.animationDuration;bE=Math.max(0,Math.min(1,bE));bA=1-bE;for(bF=this.first;bF;bF=bF.dftNext(this,!bF.grNode)){if(!bF.grNode||bF.grNode.left===bF.left&&bF.grNode.top===bF.top){continue}bD=bE*bF.left+bA*bF.startLeft;bC=bE*bF.top+bA*bF.startTop;bB=false;bF.grNode.multiset("left",bD,"top",bC)}if(!bB){return 1}this.positionsAnimationStart=Infinity;Y(this,af,[]);return 0}function bw(){var bE,bC,bD,bB,bF,bA;for(bE=this.animationList.first;bE;bE=bC){bC=bE.next;bB=bE.startTime;if(bB!==bB){bE.startTime=bz;continue}bD=bE.node;bF=(bz-bB)/bE.duration;bF=Math.max(0,Math.min(1,bF));bA=(1-bF)*bE.startValue+bF*bE.endValue;bD.grNode.set(a7[bE.property],bA);if(bF===1){r.call(this,bE)}}return this.animationList.first?1:0}var bv;this.requestAnimationFramePending=false;this.gr.withLockedUpdate(function by(){bv=0;bv|=bw.call(this);bv|=bx.call(this)},this);if(bv){l.call(this)}}function af(){var by,bx,bv;this.gr.withLockedUpdate(function bw(){for(by=this.first;by;by=by.dftNext(this,!by.expanded)){if(by.type===ao.Group.Type&&!by.expanded&&!by.grNode.collapsed){by.grNode.set("collapsed",true)}if(!by.expanded){for(bx=by.first;bx;bx=bx.dftNext(by,bv)){if(bx.grNode){bv=false;this.gr.removeNode(bx.grNode);bx.grNode=bx.grParentC=bx.grMergeParentC=bx.grMergeChildrenC=bx.grChildrenC=bx.grAuxChildrenC=null;if(bx.widthAnimation){r.call(this,bx.widthAnimation)}if(bx.heightAnimation){r.call(this,bx.heightAnimation)}}else{bv=true}}}}},this)}function aJ(bv){if((bv.__updateFlags__&1)===0){bv.__updateFlags__|=1;this.__updatedNodes__.push(bv)}}function H(){function bv(bw){var by,bx;if(bw.document!==this){throw new Error("bad document")}for(by=bw.first,bx=null;by;bx=by,by=by.next){if(by.parent!==bw){throw new Error("bad parent")}if(by.prev!==bx){throw new Error("invalid #prev")}if(by===bw.last&&by.next){throw new Error("last has next!")}bv.call(this,by)}}if(this.parent){throw new Error("document has parent!")}if(this.next||this.prev){throw new Error("document has siblings!")}bv.call(this,this)}ao.Document.prototype.updateLock=function aZ(){if(ao.traceUpdates){console.log("locking document "+this)}this.updateLockCount+=1;if(this.updateLockCount===1){this.gr.updateLock();this.animateUpdate=true}};ao.Document.prototype.updateUnlock=function bo(){if(!this.updateLockCount){throw new Error("can't unlock a not locked document!")}this.updateLockCount-=1;if(ao.traceUpdates){console.log("unlocking document "+this+" "+(this.updateLockCount?"still ":"un")+"locked")}if(!this.updateLockCount){try{if(ao.traceUpdates){console.log("update of tree "+this+" with"+(this.animateUpdate?"":"out")+" animation")}Y(this,av,[]);if(ao.traceUpdates){console.log("update of tree "+this+" done, updating egraph now")}}finally{Y(this.gr,this.gr.updateUnlock,[],"EGraph#updateUnlock")}}};ao.Document.prototype.withLockedUpdate=function aB(bw,bv){this.updateLock();try{return bw.call(bv)}finally{this.updateUnlock()}};ao.Document.prototype.isUpdated=function X(){return !this.updateLockCount};ao.Document.prototype.update=function ab(){if(arguments.length){throw new Error("use Document#setFixNode2 now")}this.updateLock();this.updateUnlock()};ao.Document.prototype.newTempGrNode=function aW(bw){var bv;switch(bw.type){case ao.Node.Type:return bi(this,bw,this.tempNodeViewFactories,this.tempNodeViewFactories.length);case ao.Group.Type:bv=bi(this,bw,this.tempGroupViewFactories,this.tempGroupViewFactories.length);bv.multiset("width",bw.getCollapsedWidth(),"height",bw.getCollapsedHeight());return bv;default:throw new Error("node must be either a node or a group")}};ao.Document.prototype.newTempGrNode2=function O(bA){var bw,bz,by,bB,bx,bv;bw=new g.Node();bz=this.tempNodeViewFactories;by=bz.length;for(bx=0;bx<by;++bx){bB=bz[bx];bv=bB.factory.call(undefined,bA);if(bv){bw.views[bB.id]=bv}}return bw};var aM={temporary:true};ao.Document.prototype.newTempGrEdge=function T(){return s([],this.tempEdgeViewFactories,this.tempEdgeViewFactories.length,this.geometry,aM)};ao.Document.prototype.newDragNode=function au(bv){var bw;switch(bv.type){case ao.Node.Type:bw=new ao.Node(bv.data);break;case ao.Group.Type:bw=new ao.Group(bv.data);bw.expandedWidth=bv.expandedWidth;bw.expandedHeight=bv.expandedHeight;break;default:throw new Error("node must be a node or a group")}bw.document=this;bw.height=bv.height;bw.displayFlags|=ao.DisplayFlags.DRAG_NODE;bw.expanded=false;switch(bv.type){case ao.Node.Type:bw.grNode=bi(this,bw,this.nodeViewFactories,this.nodeViewFactories.length);break;case ao.Group.Type:bw.grNode=aY(this,bw,this.groupViewFactories,this.groupViewFactories.length);break;default:throw new Error("node must be a node or a group")}bw.grNode.data=bw;return bw};function br(bv,bw){this.mask=bv;this.path=bw}br.prototype.toString=function aV(){return this.path.join(".")};var aG=new br(64,["data","*children*"]);var bg=new br(16,["data","expanded"]);var ar=new br(256,["data","displayFlags"]);var ah=new br(8192,["data","height"]);var a5={temporary:false};function aT(){var bA=this;function by(){return new ap()}function bC(){return new bs()}function bB(){return new a0()}function bx(){return new be()}function bz(){return new ap({offset:-bA.mergeConnectorPadding})}function bw(){return new bs({offset:bA.mergeConnectorPadding})}function bv(){return new a0({offset:-bA.mergeConnectorPadding})}function bD(){return new be({offset:bA.mergeConnectorPadding})}if(!this.parentTopCstr){this.parentTopCstr=by()}if(!this.parentBottomCstr){this.parentBottomCstr=bC()}if(!this.parentLeftCstr){this.parentLeftCstr=bB()}if(!this.parentRightCstr){this.parentRightCstr=bx()}if(!this.childrenTopCstr){this.childrenTopCstr=by()}if(!this.childrenBottomCstr){this.childrenBottomCstr=bC()}if(!this.childrenLeftCstr){this.childrenLeftCstr=bB()}if(!this.childrenRightCstr){this.childrenRightCstr=bx()}if(!this.sideParentTopCstr){this.sideParentTopCstr=by()}if(!this.sideParentBottomCstr){this.sideParentBottomCstr=bC()}if(!this.sideParentLeftCstr){this.sideParentLeftCstr=bB()}if(!this.sideParentRightCstr){this.sideParentRightCstr=bx()}if(!this.mergeParentTopCstr){this.mergeParentTopCstr=bz()}if(!this.mergeParentBottomCstr){this.mergeParentBottomCstr=bw()}if(!this.mergeParentLeftCstr){this.mergeParentLeftCstr=bv()}if(!this.mergeParentRightCstr){this.mergeParentRightCstr=bD()}if(!this.mergeChildrenTopCstr){this.mergeChildrenTopCstr=bz()}if(!this.mergeChildrenBottomCstr){this.mergeChildrenBottomCstr=bw()}if(!this.mergeChildrenLeftCstr){this.mergeChildrenLeftCstr=bv()}if(!this.mergeChildrenRightCstr){this.mergeChildrenRightCstr=bD()}if(!this.auxChildrenTopCstr){this.auxChildrenTopCstr=by()}if(!this.auxChildrenBottomCstr){this.auxChildrenBottomCstr=bC()}if(!this.auxChildrenLeftCstr){this.auxChildrenLeftCstr=bB()}if(!this.auxChildrenRightCstr){this.auxChildrenRightCstr=bx()}}function V(){var bv,bx,bw;if(!this.geometry){bv=Math.min(this.rowPadding,this.siblingPadding,this.subtreePadding!==undefined?this.subtreePadding:this.siblingPadding)>>>2;bx=this.rowPadding>>>1;bw=(this.subtreePadding!==undefined?Math.min(this.subtreePadding,this.siblingPadding):this.siblingPadding)>>>1;this.geometry=new ao.RoundedSquareGeometry(bv,bx,bw)}}function bc(){V.call(this);aT.call(this)}function aP(bv){this.__debug_flags__|=1<<bv}function av(){function bV(){var bX,bW;bX=this.fixNode;bW=null;if(bX){do{bW=bX;bX=bX.parent}while(bX&&bX.expanded);if(bX||bW!==this){this.setFixNode2(null)}}if(!this.fixNode){for(bX=this.first;bX;bX=bX.dftNext(this,!bX.expanded)){if(bX.grNode){this.setFixNode2(bX);break}}}}function bE(){var bW;if(!(this.__docUpdateFlags__&(2|4))){return}if(ao.traceUpdates){console.log("updating alignments after change of drawing modifiers")}this.alignmentH=0.5;this.alignmentV=this.drawingModifiers&ao.DrawingModifiers.MIRROR_DEPTH?1:0;if(this.drawingModifiers&ao.DrawingModifiers.HORIZONTAL){bW=this.alignmentH;this.alignmentH=this.alignmentV;this.alignmentV=bW}}function bK(bX){var bW;if(!bX.grNode){return}if(!bD){bD=[]}if(bX.grParentC.children.first){bD.push(bX.grParentC.children.first.ref)}if(bX.grMergeParentC&&bX.grMergeParentC.children.first){bD.push(bX.grMergeParentC.children.first.ref)}if(bX.grMergeChildrenC&&bX.grMergeChildrenC.children.first){bD.push(bX.grMergeChildrenC.children.first.ref)}if(bX.grChildrenC){for(bW=bX.grChildrenC.children.first;bW;bW=bW.next){bD.push(bW.ref)}}if(bX.grAuxChildrenC){for(bW=bX.grAuxChildrenC.children.first;bW;bW=bW.next){bD.push(bW.ref)}}bG.removeNode(bX.grNode);bX.grNode=bX.grParentC=bX.grMergeParentC=bX.grMergeChildrenC=bX.grChildrenC=bX.grAuxChildrenC=null;if(bX.widthAnimation){r.call(this,bX.widthAnimation)}if(bX.heightAnimation){r.call(this,bX.heightAnimation)}}function bL(){var bY,bX,bZ,bW;if(bN){return}bW=(2|4|8|512|1024|4096|16384);for(bY=0,bX=this.__updatedNodes__.length;bY<bX;++bY){bZ=this.__updatedNodes__[bY];if(bZ.__updateFlags__&bW){if(ao.traceUpdates){console.log("modifications of "+bZ+" triggered the redraw (computation of positions) of the tree")}bN=true;return}}}function bO(){var bX,bW,bZ,bY;for(bX=0,bW=this.__updatedNodes__.length;bX<bW;++bX){bZ=this.__updatedNodes__[bX];if((bZ.__updateFlags__&(2|4|32))===4){for(bY=bZ;bY;bY=bY.dftNext(bZ)){bZ.__updateFlags__|=32;if(this.onnodedetached){this.onnodedetached(bY)}bY.document=null;bK.call(this,bY)}}}}function bx(){var bW;if(!(this.__docUpdateFlags__&16)){return}for(bW=this.first;bW;bW=bW.dftNext(this)){if(!bW.grNode||bW.type!==ao.Node.Type){continue}bW.grNode.multiset("width",bq(bW),"height",aX(bW));if(bW.widthAnimation){r.call(this,bW.widthAnimation)}if(bW.heightAnimation){r.call(this,bW.heightAnimation)}}}function bF(){var b9,b0,bY,b1,b6,b2,b7,cb,b4,bZ,ca,bW,b8;b8=this;b8.mergeEdgeGeomCol=b8.mergeEdgeGeomCol||[];b2=b8.nodeViewFactories;b7=b2.length;cb=b8.groupViewFactories;b4=cb.length;bW=[];for(b9=b8.first;b9;b9=b9.dftNext(b8,!b9.expanded)){if(!b9.grNode){switch(b9.type){case ao.Node.Type:bY=bi(b8,b9,b2,b7);break;case ao.Group.Type:bY=aY(b8,b9,cb,b4);break;default:throw new Error("internal error")}bY.data=b9;b9.grNode=bY;b9.grParentC=new g.Connector(undefined,undefined,b9.__configFlags__&1?b8.sideParentConnectorCstr:b8.parentConnectorCstr);b9.__updateFlags__&=~512;b9.grNode.appendConnector(b9.grParentC);if(b9.type===ao.Node.Type){b9.grChildrenC=new g.Connector(undefined,undefined,b8.childrenConnectorCstr);b9.grNode.appendConnector(b9.grChildrenC);b9.grAuxChildrenC=new g.Connector(undefined,undefined,b8.auxChildrenConnectorCstr);b9.grNode.appendConnector(b9.grAuxChildrenC);b9.grMergeParentC=new g.Connector(undefined,undefined,b8.mergeParentConnectorCstr);b9.grNode.appendConnector(b9.grMergeParentC);b9.grMergeChildrenC=new g.Connector(undefined,undefined,b8.mergeChildrenConnectorCstr);b9.grNode.appendConnector(b9.grMergeChildrenC)}bG.addNode(bY);b1=b9.parent.grNode;if(b1){bZ=b1.left+b8.alignmentH*(b1.width-bY.width);ca=b1.top+b8.alignmentV*(b1.height-bY.height);bY.multiset("left",bZ,"top",ca);if(b9.parent.type===ao.Node.Type){var b5=b9.__configFlags__&2?b9.parent.grAuxChildrenC:b9.parent.grChildrenC;var bX=b9.grParentC;b6=by({startNode:b9.parent,endNode:b9});bG.addEdge(b5,bX,b6)}b9.__updateFlags__&=~1024}else{bY.multiset("top",b9.top,"left",b9.left)}if(b9.type===ao.Node.Type){for(b0=b9.first;b0;b0=b0.next){if(b0.grNode){b6=by();bG.addEdge(b0.__configFlags__&2?b9.grAuxChildrenC:b9.grChildrenC,b0.grParentC,b6);b0.__updateFlags__&=~1024}}}}if(b9.mergeParent){for(var b3=0;b3<b9.mergeParent.length;b3++){if(b9.mergeParent[b3]){bW.push({mergeParent:b9.mergeParent[b3],mergeChild:b9})}}}}bW.forEach(function(cg){var ce=cg.mergeParent.grMergeChildrenC;var cf=cg.mergeChild.grMergeParentC;function cc(ci,ch){if(ci.children.first){for(var cj=ci.children.first;cj;cj=cj.next){if((cj.ref.cl1.c===ci&&cj.ref.cl2.c===ch)||(cj.ref.cl1.c===ch&&cj.ref.cl2.c===ci)){return true}}}return false}if(ce&&cf&&b8.drawing===ao.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY&&!cc(ce,cf)){var cd;b8.mergeEdgeGeomCol.forEach(function(ch){if(ch.mergeParent==cg.mergeParent&&ch.mergeChild==cg.mergeChild){cd=ch.mergeEdgeGeom}});b6=by({startNode:cg.mergeParent,endNode:cg.mergeChild},cd);ba(ce,cf,b8.drawingModifiers);bG.addEdge(ce,cf,b6);cg.mergeParent.__updateFlags__&=~64}});while(b8.mergeEdgeGeomCol.length){b8.mergeEdgeGeomCol.pop()}}function bR(){var b0,bZ,bY,b1,b2,b3;for(b0=0,bZ=this.__updatedNodes__.length;b0<bZ;++b0){bY=this.__updatedNodes__[b0];if(!bY.mergeParent&&bY.grMergeParentC&&bY.grMergeParentC.children.first){var b1=bY.grMergeParentC.children.first.ref;bG.removeEdge(b1);if(!bD){bD=[]}bD.push(b1)}else{if(bY.mergeParent&&bY.grMergeParentC&&bY.grMergeParentC.children.first){for(var bX=bY.grMergeParentC.children.first;bX;bX=bX.next){var b5=bX.ref.cl1.c.node.data;var b4=bX.ref.cl2.c.node.data;var bW=false;if(bY!==b5&&bY===b4){if(bY.mergeParent.indexOf(b5)===-1){bW=true}}else{if(bY===b5&&bY!==b4){if(bY.mergeParent.indexOf(b4)===-1){bW=true}}}if(bW){var b1=bX.ref;bG.removeEdge(b1);if(!bD){bD=[]}bD.push(b1);bW=false}}}}if((bY.__updateFlags__&(2|4))===(2|4)&&bY.__lastParent__!==bY.parent||bY.__updateFlags__&1024){if(bY.grParentC&&bY.grParentC.children.first){b1=bY.grParentC.children.first.ref;bG.removeEdge(b1);if(!bD){bD=[]}bD.push(b1)}if(bY.grParentC&&bY.parent.grChildrenC){if(ao.traceUpdates){console.log("updating edge of "+bY+" that has changed parent")}bG.insertEdgeBefore(bY.__configFlags__&2?bY.parent.grAuxChildrenC:bY.parent.grChildrenC,bY.grParentC,by())}if(bY.parent.type!==ao.Document.Type&&!bY.parent.grNode){if(ao.traceUpdates){console.log("remove edge and graph node of "+bY+" since new parent is collapsed")}for(b2=bY;b2;b2=b2.dftNext(bY,b3)){if(b2.grNode){b3=false;if(ao.traceUpdates){console.log("  remove child "+bY+" graph node since new parent is collapsed")}bK.call(this,b2)}else{b3=true}}}}if(bY.__updateFlags__&512){bY.grParentC.set("cstr",bY.__configFlags__&1?this.sideParentConnectorCstr:this.parentConnectorCstr)}}}function bw(bX,bW){if((bX.__updateFlags__&bW.mask)===0){if((bX.__updateFlags__&1)===0){bX.__updateFlags__|=1;this.__updatedNodes__.push(bX)}bX.__updateFlags__|=bW.mask;if(bX.grNode){bX.grNode.notify(new g.UpdatedNotif(bW.path,undefined))}}}function bB(){var bY,bW,bZ,bX;for(bY=0,bW=this.__updatedNodes__.length;bY<bW;++bY){bZ=this.__updatedNodes__[bY];if(bZ.__updateFlags__&2){bw.call(this,bZ.parent,aG)}if(bZ.__updateFlags__&4){bw.call(this,bZ.__lastParent__,aG)}if(bZ.__updateFlags__&8){bw.call(this,bZ,bg)}if(bZ.__updateFlags__&128){bw.call(this,bZ,ar)}if(bZ.__updateFlags__&4096){bw.call(this,bZ,ah)}}if(this.__docUpdateFlags__&2){bX=["data","*drawingModifiers*"];for(bZ=this.first;bZ;bZ=bZ.dftNext(this,!bZ.grNode)){if(bZ.grNode){bZ.grNode.notify(new g.UpdatedNotif(bX,undefined))}}}}function bU(){var bX,bW,bY;for(bX=0,bW=this.__updatedNodes__.length;bX<bW;++bX){bY=this.__updatedNodes__[bX];bY.__updateFlags__=0}this.__updatedNodes__.length=0;this.__docUpdateFlags__=0}function bS(){var bY,b0,b2,b5,bW,b4,bZ,b1,bX,b3;b2=this.drawingModifiers;b5=ao.DrawingModifiers;if(b2&b5.HORIZONTAL){bW=b2&b5.MIRROR_DEPTH;b4=b2&b5.MIRROR_SIBLINGS}else{bW=b2&b5.MIRROR_SIBLINGS;b4=b2&b5.MIRROR_DEPTH}for(bY=this.first;bY;bY=bY.dftNext(this,!bY.expanded)){if(bW){bY.left=-bY.left-bq(bY)}if(b4){bY.top=-bY.top-aX(bY)}if(bY.first&&!bY.expanded){bZ=bY.left;b1=bY.top;bX=bq(bY);b3=aX(bY);for(b0=bY.first;b0;b0=b0.dftNext(bY,!b0.grNode)){if(!b0.grNode){continue}b0.left=bZ+this.alignmentH*(bX-bq(b0));b0.top=b1+this.alignmentV*(b3-aX(b0))}}}}function bA(){var b4,b5,bW,bZ,b1,bX,b2,b3,b0,bY;if(!(this.__docUpdateFlags__&(2|4))){return}if(ao.traceUpdates){console.log("updating constraints after change of drawing modifiers")}b4=this.drawingModifiers;b5=ao.DrawingModifiers.HORIZONTAL;bW=ao.DrawingModifiers.MIRROR_DEPTH;bZ=ao.DrawingModifiers.MIRROR_SIBLINGS;switch(b4&(b5|bW)){case 0:this.parentConnectorCstr=this.parentTopCstr;this.mergeParentConnectorCstr=this.mergeParentTopCstr;this.mergeChildrenConnectorCstr=this.mergeChildrenBottomCstr;this.childrenConnectorCstr=this.childrenBottomCstr;break;case b5:this.parentConnectorCstr=this.parentLeftCstr;this.mergeParentConnectorCstr=this.mergeParentLeftCstr;this.mergeChildrenConnectorCstr=this.mergeChildrenRightCstr;this.childrenConnectorCstr=this.childrenRightCstr;break;case bW:this.parentConnectorCstr=this.parentBottomCstr;this.mergeParentConnectorCstr=this.mergeParentBottomCstr;this.mergeChildrenConnectorCstr=this.mergeChildrenTopCstr;this.childrenConnectorCstr=this.childrenTopCstr;break;default:this.parentConnectorCstr=this.parentRightCstr;this.mergeParentConnectorCstr=this.mergeParentRightCstr;this.mergeChildrenConnectorCstr=this.mergeChildrenLeftCstr;this.childrenConnectorCstr=this.childrenLeftCstr;break}switch(b4&(b5|bZ)){case 0:this.auxChildrenConnectorCstr=this.auxChildrenRightCstr;this.sideParentConnectorCstr=this.sideParentLeftCstr;break;case b5:this.auxChildrenConnectorCstr=this.auxChildrenBottomCstr;this.sideParentConnectorCstr=this.sideParentTopCstr;break;case bZ:this.auxChildrenConnectorCstr=this.auxChildrenLeftCstr;this.sideParentConnectorCstr=this.sideParentRightCstr;break;default:this.auxChildrenConnectorCstr=this.auxChildrenTopCstr;this.sideParentConnectorCstr=this.sideParentBottomCstr;break}b2=this.parentConnectorCstr;b1=this.sideParentConnectorCstr;bX=this.mergeParentConnectorCstr;bY=this.mergeChildrenConnectorCstr;b3=this.childrenConnectorCstr;b0=this.auxChildrenConnectorCstr;for(bH=this.first;bH;bH=bH.dftNext(this,!bH.grNode)){if(!bH.grNode){continue}bH.grParentC.set("cstr",bH.__configFlags__&1?b1:b2);bH.__updateFlags__&=~512;if(bH.grChildrenC){bH.grChildrenC.set("cstr",b3)}if(bH.grAuxChildrenC){bH.grAuxChildrenC.set("cstr",b0)}if(bH.grMergeParentC){bH.grMergeParentC.set("cstr",bX);bX.onupdate(bH.grMergeParentC)}if(bH.grMergeChildrenC){bH.grMergeChildrenC.set("cstr",bY);bX.onupdate(bH.grMergeChildrenC)}}}function bQ(){var bY,bX,b2,b1,b0,bW,bZ;if(this.fixNode&&this.fixNode.grNode){this.fixNode.grNode.bringToFront()}if(this.fixNode){b1=this.fixNodeAlignmentH;if(isNaN(b1)){b1=this.alignmentH}b0=this.fixNodeAlignmentV;if(isNaN(b0)){b0=this.alignmentV}bW=bq(this.fixNode);bZ=aX(this.fixNode);this.fixNodeLeft+=b1*(this.fixNodeWidth-bW);this.fixNodeTop+=b0*(this.fixNodeHeight-bZ);this.fixNodeWidth=bW;this.fixNodeHeight=bZ;bY=this.fixNodeLeft-this.fixNode.left;bX=this.fixNodeTop-this.fixNode.top;this.left+=bY;this.top+=bX;for(b2=this.first;b2;b2=b2.dftNext(this,!b2.grNode)){b2.left+=bY;b2.top+=bX}}}function bv(){var bW,bY,b1,b0,bX,bZ;bY=true;bW=this.animateUpdate;if(bW){for(bH=this.first;bH;bH=bH.dftNext(this,!bH.grNode)){if(!bH.grNode||bH.grNode.left===bH.left&&bH.grNode.top===bH.top){continue}bY=false;bH.startLeft=bH.grNode.left;bH.startTop=bH.grNode.top}}else{for(bH=this.first;bH;bH=bH.dftNext(this,!bH.grNode)){if(!bH.grNode||bH.grNode.left===bH.left&&bH.grNode.top===bH.top){continue}bH.grNode.multiset("left",bH.left,"top",bH.top)}}for(bH=this.first;bH;bH=bH.dftNext(this,!bH.grNode)){if(!bH.grNode||bH.type!==ao.Group.Type){continue}if(bH.expanded&&bH.grNode.collapsed){bH.grNode.set("collapsed",false)}bX=bq(bH);if(bH.grNode.width!==bX){b1=bH.widthAnimation;if(!b1||b1.endValue!==bX){a1.call(this,E,bH,this.animationDuration,bH.grNode.width,bX)}}bZ=aX(bH);if(bH.grNode.height!==bZ){b1=bH.heightAnimation;if(!b1||b1.endValue!==bZ){a1.call(this,aQ,bH,this.animationDuration,bH.grNode.height,bZ)}}}for(b1=this.lastAnimation?this.lastAnimation.next:this.animationList.first;b1;b1=b0){b0=b1.next;if(!bW||b1.duration===0||b1.startValue===b1.endValue){b1.node.grNode.set(a7[b1.property],b1.endValue);r.call(this,b1)}}this.lastAnimation=this.animationList.last;if(bY){this.positionsAnimationStart=Infinity;Y(this,af,[])}else{this.positionsAnimationStart=NaN}if(!bY||this.animationList.first){l.call(this)}}function by(bW,bX){if(bX){return s(bD,bT,bP,bX,a5,bW)}else{return s(bD,bT,bP,bJ,a5,bW)}}function bz(){var bW;bW=this.__debug_flags__&7;if(bW<7){bW+=1}this.__debug_flags__=bW}function bI(){this.animationCache.length=0}var bG,bD,bT,bP,bH,bJ,bC,bN,bM;bz.call(this);bM=this.drawingData;this.drawingData=undefined;bN=false;if(this.__docUpdateFlags__&(1|2|4|8|16)){if(ao.traceUpdates){console.log("modifications of document triggered the redraw (computation of positions) of the tree")}bN=true}if(this.__docUpdateFlags__&4){bc.call(this)}bG=this.gr;bT=this.edgeViewFactories;bP=bT.length;bJ=this.geometry;bG.updateLock();try{Y(this,bV,[]);Y(this,bE,[]);Y(this,bB,[]);Y(this,bL,[]);Y(this,bO,[]);Y(this,bx,[]);if(bN){bC=Y(undefined,a3,[this]);Y(this,bS,[])}else{bC=bM}Y(this,bA,[]);Y(this,bF,[]);Y(this,bR,[]);Y(this,bQ,[]);Y(this,bv,[])}finally{Y(bG,bG.updateUnlock,[],"gr.updateUnlock")}Y(this,bU,[]);Y(this,bI,[]);this.drawingData=bC}function bi(bC,bA,bz,by){var bw,bx,bB,bv;bw=new g.Node();bw.customPropertyFlags=g.PropertyFlag.VIEW;bw.multiset("width",bq(bA),"height",aX(bA));for(bx=0;bx<by;++bx){bB=bz[bx];bv=bB.factory.call(undefined,bA);if(bv){bw.views[bB.id]=bv}}return bw}function aY(bA,bz,bB,bC){var bx,bw,by,bv;bx=new g.Group();bx.customPropertyFlags=g.PropertyFlag.VIEW;bx.multiset("width",bq(bz),"height",aX(bz),"collapsed",!bz.expanded);for(bw=0;bw<bC;++bw){by=bB[bw];bv=by.factory.call(undefined,bz);if(bv){bx.views[by.id]=bv}}return bx}function s(bx,by,bD,bB,bv,bE){var bz,bw,bA,bC;if(bx&&bx.length){return bx.pop()}bz=new g.Edge();bz.data=bv;bz.set("geometry",bB);for(bw=0;bw<bD;++bw){bA=by[bw];bC=bA.factory.call(undefined,bz,bE);if(bC){bz.views[bA.id]=bC}}return bz}function n(by,bx,bw){var bv;if(bx.__configFlags__!==bw){if(bw&~(1|2)){throw new Error("flags contains invalid bits")}bv=bx.__configFlags__^bw;bx.__updateFlags__|=bv<<9;bx.__configFlags__=bw;aJ.call(by,bx)}}function S(bw){var bx,bv;for(bx=bw.first;bx;bx=bx.dftNext(bw,!bx.expanded)){bv=bx.top;bx.top=bx.left;bx.left=bv}}function K(bE){function bF(bI,bJ,bH){var bK;bI.top=bJ;bG(bD,bI.top+1,bx(bI));if(!bI.first||C(bI)){bI.left=Math.max(bB[bJ]||0,bH);bB[bJ]=bI.left+1;bG(bv,bI.left+1,bC(bI));return}bK=bI.first;n(bE,bK,0);bF(bK,bJ+1,Math.max(bB[bJ]||0,bH));bI.left=bK.left;bH=bB[bJ]=bI.left+1;bG(bv,bI.left+1,bC(bI));bK=bK.next;if(!bK){return}if(bK===bI.last){n(bE,bK,1|2);bF(bK,bJ,bH)}else{for(;bK;bK=bK.next){n(bE,bK,2);bF(bK,bJ+1,bH)}bB[bJ]=bI.last.left+1}}function bA(){var bH;for(bH=bE.first;bH;bH=bH.dftNext(bE,C(bH))){bH.left=bv[bH.left];bH.top=bD[bH.top]}}function bG(bH,bJ,bI){if(!(bI<bH[bJ])){bH[bJ]=bI}}var bw,bB,bC,bx,by,bv,bD,bz;bw=bE.drawingModifiers&ao.DrawingModifiers.HORIZONTAL;bB=[];bv=[0];bD=[0];if(bw){bC=aX;bx=bq}else{bC=bq;bx=aX}bE.left=0;bE.top=0;bz=ae(bE);for(by=bE.first;by;by=by.next){bF(by,0,0)}e(bv,bE.siblingPadding);e(bD,bE.rowPadding);bA();z(bE);if(bw){S(bE)}}function c(bM,by){by=by||{};function bx(bO,bQ){var bR=bQ;if(bQ===-1){for(var bN=bO.first;bN;bN=bN.next){bR=Math.max(bR,bx(bN,bQ+1))}return bR}if(!bO){return bR-1}if(!bO.first||(!bO.first.expanded&&(!bO.first.next||!bO.first.next.expanded))){return bR}if(bO.first.expanded){bR=Math.max(bQ,bx(bO.first.first,bQ+1))}if(bO.first.next&&bO.first.next.expanded){for(var bP=bO.first.next.first;bP;bP=bP.next){bR=Math.max(bR,bx(bP,bQ+1))}}return bR}function bI(bP,bR,bQ){var bU,bO,bN,bS,bT,bV;if(bP.type===ao.Group.Type){bO=bN=null}else{bO=bP.first;if(bO){bN=bO.next}}if(by.leavesOnExtremity&&bP.isLeaf()){bS=true}bT=by.leavesOnExtremity?bw:bR;bV=by.leavesOnExtremity&&bS?bw:bR;if(bN&&bN.next){throw new Error("there can be only two intermediate children")}bP.top=bV;bP._actualPositionsSet=false;bF(bz,bP.top+1,bC(bP));if(!bO||!bO.first||!bP.expanded||!bO.expanded){bP.left=Math.max(bB[bT]||0,bQ);bB[bV]=bP.left+1;bF(bK,bP.left+1,bL(bP))}else{bU=bO.first;n(bM,bU,0);bI(bU,bR+1,Math.max(bB[bR]||0,bQ));bP.left=bU.left;bF(bK,bP.left+1,bL(bP));bB[bR]=bP.left+1}bQ=bB[bR];bU=bN&&bP.expanded&&bN.expanded?bN.first:null;if(!bU){return}if(bU===bN.last){n(bM,bU,by.leavesOnExtremity?2:1|2);bI(bU,by.leavesOnExtremity?bR+1:bR,bQ)}else{for(;bU;bU=bU.next){n(bM,bU,2);bI(bU,bR+1,bQ)}bB[bR]=bN.last.left+1}}function bG(bR,bW){function bZ(b1){var b0;if(!b1){return}b0=b1.parent?b1.parent.parent:null;if(b0&&b1.top<=b0.top){b1.top=b0.top+1;b1._actualPositionsSet=false}bF(bz,b1.top+1,bC(b1));if(b1.top>bw){bw=b1.top}if(b1.first&&b1.first.next){for(var b2=b1.first.next.last;b2;b2=b2.prev){bZ(b2)}}bZ(b1.first?b1.first.first:null)}function bY(b0){if(b0.top>bR.top){}else{if(bn(b0,bR)){return}if(bU&&!bR._actualPositionsSet&&!bV._actualPositionsSet&&bR.top>bV.top+1){if(bV===bR.document){bR.top=bV.top;bR._actualPositionsSet=false}else{if(!bV._actualPositionsSet){bR.top=bV.top+1;bR._actualPositionsSet=false}}bY(b0)}else{if(!bR._actualPositionsSet){b0.top=bR.top+1;b0._actualPositionsSet=false;bZ(b0)}}}}var bX,bP,bQ,bN,bT,bU,bV;if(!bR){return}bP=by.leavesOnExtremity?bR.mergeParent:null;bX=by.leavesOnExtremity?bR.mergeChild:null;bT=(bR.parent?(bR.parent.parent?bR.parent.parent:bR.parent):null);if(bP){for(var bS=0;bS<bP.length;bS++){if(!bn(bR,bP[bS])){bV=bP[bS]&&bP[bS].top>bT.top?(bV&&bV.top>bP[bS].top?bV:bP[bS]):bT}else{bV=bT}}}else{bV=bT}bQ=bR.type!==ao.Group.Type?bR.first:null;bN=bQ?bQ.next:null;if(by.leavesOnExtremity&&bR.isLeaf()){bU=true}if(bW&&bU&&!bX){bW.push(bR)}if(bX){for(var bS=0;bS<bX.length;bS++){if(bX[bS]){bY(bX[bS])}}}for(var bO=bN?bN.last:null;bO;bO=bO.prev){bG(bO,bW)}bG(bQ?bQ.first:null,bW)}function bD(){function bN(bU){var bR,bQ,bT,bP,bS;bR=bK[bU.left];bQ=bz[bU.top];bU.left=bR;bU.top=bQ;bU._actualPositionsSet=true;if(bU.type===ao.Group.Type){return}bT=bU.first;if(bT){bT.left=bR;bT.top=bQ;bP=bT.next;if(bP){bP.left=bR;bP.top=bQ}}if(!bU.expanded){return}if(bT&&bT.expanded){bS=bT.first;if(bS){bN(bS)}}if(bP&&bP.expanded){for(bS=bP.first;bS;bS=bS.next){bN(bS)}}}var bO;for(bO=bM.first;bO;bO=bO.next){bN(bO)}}function bF(bN,bP,bO){if(!(bO<bN[bP])){bN[bP]=bO}}var bv,bB,bL,bC,bE,bK,bz,bH,bw,bA;bv=bM.drawingModifiers&ao.DrawingModifiers.HORIZONTAL;bB=[];bK=[0];bz=[0];if(bv){bL=aX;bC=bq}else{bL=bq;bC=aX}bM.left=0;bM.top=0;bw=bx(bM,-1);bH=ae(bM);bA=[];for(bE=bM.first;bE;bE=bE.next){bI(bE,0,0);bG(bE,bA)}if(by.leavesOnExtremity){bA.forEach(function bJ(bN){bN.top=bw})}for(bE=bM.first;bE;bE=bE.dftNext(bM)){if(bE.verticalId!==undefined){bE.top=bE.verticalId}else{if(bE.parent.verticalId!==undefined){bE.top=bE.parent.verticalId}}bF(bz,bE.top+1,bC(bE))}e(bK,bM.siblingPadding);e(bz,bM.rowPadding);bD();z(bM);if(bv){S(bM)}return{depthOffset:bz,maxDepth:bw,leaves:bA}}function aF(bv){return c.call(this,bv,{leavesOnExtremity:true})}function e(bw,by){var bx,bv;for(bx=1,bv=bw.length;bx<bv;++bx){bw[bx]+=bw[bx-1]+by}}function bq(bv){return bv.getActualWidth()}function aX(bv){return bv.getActualHeight()}function ae(bL){var bC,bD,bw,bF,bI,bJ,bH,bG,bz,bK,bB,by,bv,bA,bx,bE;bC=bL.drawingModifiers&ao.DrawingModifiers.HORIZONTAL;if(bC){bK=aX;bB=bq}else{bK=bq;bB=aX}bE=[];for(bw=bL.first;bw;bw=bw.dftNext(bL,C(bw))){if(bw.type!==ao.Group.Type||!bw.expanded){continue}for(bD=0,bF=bw.first;bF;bF=bF.next){bD+=1}if(!bD){bw.expandedWidth=bL.groupEmptyWidth;bw.expandedHeight=bL.groupEmptyHeight;continue}bI=Math.max(1,Math.ceil(Math.sqrt(bL.groupAspectRatio*bD)));bG=[bL.groupPaddingLeft];bz=[bL.groupPaddingTop];for(bJ=0,bH=0,bF=bw.first;bF;bF=bF.next){by=bK(bF);bv=bB(bF);if(!(bG[bJ+1]>=by)){bG[bJ+1]=by}if(!(bz[bH+1]>=bv)){bz[bH+1]=bv}bJ+=1;if(bJ===bI){bJ=0;bH+=1}}e(bG,bL.groupColPadding);e(bz,bL.groupRowPadding);for(bJ=0,bH=0,bF=bw.first;bF;bF=bF.next){bF.left=bG[bJ];bF.top=bz[bH];bJ+=1;if(bJ===bI){bJ=0;bH+=1}}bA=bG[bG.length-1]-bL.groupColPadding+bL.groupPaddingRight;bx=bz[bz.length-1]-bL.groupRowPadding+bL.groupPaddingBottom;if(bC){bw.expandedWidth=bx;bw.expandedHeight=bA}else{bw.expandedWidth=bA;bw.expandedHeight=bx}bE.push({group:bw,cols:bG,rows:bz})}return bE}function z(bv){var bx,bw;for(bx=bv.first;bx;bx=bx.dftNext(bv,C(bx))){if(bx.type!==ao.Group.Type){continue}for(bw=bx.first;bw;bw=bw.next){bw.left+=bx.left;bw.top+=bx.top}}}function J(bE){function bD(bH,bI){var bJ,bG;n(bE,bH,0);bG=bz(bH);if(!(bG<bw[bI])){bw[bI]=bG}if(!bH.first||C(bH)){bF+=bA;bH.left=bF;bF+=bB(bH)}else{for(bJ=bH.first;bJ;bJ=bJ.next){bD(bJ,bI+1)}bH.left=Math.round(0.5*(bH.first.left+bH.last.left+0.5*(bB(bH.first)+bB(bH.last))-bB(bH)))}}function bv(){var bG;for(bG=new ao.NodeIterator(bE,bE.first);bG.n;bG.dftNext(C(bG.n))){bG.n.top=bw[bG.depth-1]}}var bx,bC,bF,bw,bA;var bB,bz;var by;bA=bE.siblingPadding;bx=bE.drawingModifiers&ao.DrawingModifiers.HORIZONTAL;if(bx){bB=aX;bz=bq}else{bB=bq;bz=aX}bF=0;bw=[0];bE.left=0;bE.top=0;by=ae(bE);for(bC=bE.first;bC;bC=bC.next){bD(bC,1)}e(bw,bE.rowPadding);bv();z(bE);if(bx){S(bE)}return{depthOffset:bw,groups:by}}function t(bM){function bL(bP,bN){var bO,bT,bR,bW,bV,bU,bQ,bS;bO=bP.id=bE++;n(bM,bP,0);bA[bO]=bz[bN];bz[bN]=bP;bQ=bP!==bM?bD(bP):0;bS=bB[bN];if(!(bQ<bS)){bB[bN]=bQ}bv[bO]=0;if(!bP.first||C(bP)){if(bP.prev){bI[bO]=bI[bP.prev.id]+bK+0.5*(bx(bP.prev)+bx(bP))}else{bI[bO]=0}}else{bR=bP.first;bW=bP.last;for(bT=bR;bT;bT=bT.next){bL(bT,bN+1)}bV=0.5*(bI[bR.id]+bI[bW.id]);if(bP.prev){bU=bI[bO]=bI[bP.prev.id]+0.5*(bx(bP.prev)+bx(bP))+bK;bv[bO]=bU-bV;bF(bP,bN)}else{bI[bO]=bV}}}function bF(bR){var bQ,bO,bY,bV,bW,bT,b0,bS,bN,bU,bP,bX,bZ;bQ=bR.id;bV=1;bO=bR.first;while(bO&&(bY=bA[bO.id],bY)){bT=0;b0=0;bS=bO;bN=bY;for(bW=0;bW<bV;++bW){bS=bS.parent;bN=bN.parent;b0+=bv[bS.id];bT+=bv[bN.id]}bU=bI[bY.id]+bT+bJ+0.5*(bx(bO)+bx(bY))-(bI[bO.id]+b0);if(bU>0){bX=0;for(bP=bR;bP&&bP!==bN;bP=bP.prev){++bX}if(!bP){return}bZ=bU/bX;for(bP=bR;bP!==bN;bP=bP.prev){bI[bP.id]+=bU;bv[bP.id]+=bU;bU-=bZ}}++bV;if(bO.first&&!C(bO)){bO=bO.first}else{bO=bC(bR,0,bV)}}}function bC(bO,bR,bP){var bN,bQ;if(bR>=bP){return bO}for(bQ=C(bO)?null:bO.first,bN=null;!bN&&bQ;bQ=bQ.next){bN=bC(bQ,bR+1,bP)}return bN}function bG(bO,bT,bP){var bQ,bN,bS,bR;bQ=bO.id;bN=Math.round(bI[bQ]+bP-0.5*bx(bO));bS=bB[bT-1];bO.left=bN;bO.top=bS;if(bO.first&&!C(bO)){for(bR=bO.first;bR;bR=bR.next){bG(bR,bT+1,bP+bv[bQ])}}}var bK,bJ,bA,bv,bE,bI,bw,bz,by,bB,bx,bD,bH;bK=bM.siblingPadding;bJ=bM.subtreePadding!==undefined?bM.subtreePadding:bK;bw=bM.rowPadding;by=bM.drawingModifiers&ao.DrawingModifiers.HORIZONTAL;if(by){bx=aX;bD=bq}else{bx=bq;bD=aX}bB=[0];bz=[];bE=0;bv=[];bI=[];bA=[];bM.left=0;bM.top=0;bH=ae(bM);bL(bM,0);e(bB,bw);bG(bM,0,0);z(bM);if(by){S(bM)}return{depthOffset:bB,groups:bH}}function a3(bw){var bv;bv=aE[bw.drawing];if(!bv){throw new Error("invalid drawing algorithm: "+bw.drawing)}aP.call(bw,3);return bv.call(this,bw)}function p(bx,bw){var bv,by;bv=bx.id;by=bw.id;if(bv<by){return -1}else{if(bv>by){return 1}else{return 0}}}ao.sortNodes=function aI(bw,bA){var bB,bz,bv,bC,by,bx;bv=bw.length;if(!bv){return}bB=bw[0].document;for(bz=1;bz<bv;++bz){if(bw[bz].document!==bB){throw new Error("nodes must be in same document")}}bB.id=0;by=1;for(bC=bB.first;bC;bC=bC.dftNext(bB)){bC.id=by++}bw.sort(p);if(bA&&bA.unique){bx=1;for(bz=1;bz<bv;++bz){if(bw[bz]!==bw[bz-1]){bw[bx++]=bw[bz]}}bw.length=bx}};ao.filterVisibleNodes=function b(bw){var bz,by,bv,bA,bx;bv=bw.length;if(!bv){return}bz=bw[0].document;for(by=1;by<bv;++by){if(bw[by].document!==bz){throw new Error("nodes must be in same document")}}bz.id=1;for(bA=bz.first;bA;bA=bA.dftNext(bz)){if(!bA.parent.expanded){bA.id=0}else{bA.id=bA.parent.id}}bx=0;for(by=0;by<bv;++by){if(bw[by].id){bw[bx++]=bw[by]}}bw.length=bx};var bm,i;if(typeof performance!=="undefined"){bm=performance.now;i=performance}else{bm=Date.now;i=Date}function N(bw){var bv;bv="";while(bw-->0){bv+=" "}return bv}function B(bv){this.id=bv;this.count_ms=NaN;this.parent=null;this.nextSibling=null;this.firstChild=null;this.lastChild=null}B.prototype.appendChild=function R(bv){if(bv.parent){throw new Error("child already has a parent")}bv.parent=this;if(this.lastChild){this.lastChild.nextSibling=bv;this.lastChild=bv}else{this.lastChild=this.firstChild=bv}};var bj=null;function aw(bw){var bv;bv=Z.exec(bw.toString());if(!bv){throw new Error("can't get function name")}return bv[1]}var Z=/^\s*?function\s*?(\S*?)\s*?\(/;function Y(bC,bz,bB,bx){if(!Y.active){return bz.apply(bC,bB)}var by,bA,bw,bD,bv;bD=bj;bv=new B(bx||bz.name||aw(bz));if(bj){bj.appendChild(bv)}bj=bv;by=bm.call(i);try{bw=bz.apply(bC,bB);bA=bm.call(i);bv.count_ms=bA-by}finally{bj=bj.parent;if(!bv.parent){Y.onroot(bv)}}return bw}function bl(bv){var bx,bw;for(bx=bv,bw=0;bx;){console.log(N(2*bw)+bx.count_ms.toFixed(3)+"ms : "+bx.id);if(bx.firstChild){bx=bx.firstChild;bw+=1}else{while(bx&&!bx.nextSibling){bx=bx.parent;bw-=1}if(bx){bx=bx.nextSibling}}}}Y.onroot=bl;Y.active=false;ao.timeit=Y;ao.overrideAnimationFrame=function aS(bv,bw){if(typeof bv!=="function"){throw new Error("newRAF must be a function")}if(typeof bw!=="function"){throw new Error("newCAF must be a function")}M=bv;am=bw};ao.traceUpdates=false;return ao});define("etree/tree",["DS/etree/tree"],function mod(a){return a});define("DS/etree/syncviewsFactory",["DS/egraph/utils","DS/egraph/views","DS/egraph/core","DS/etree/tree","UWA/Core","DS/Utilities/Dom"],function(d,c,b,a,g,f){function e(l){l=g.extend({template:['<div class="etree-sync-node" draggable="true">','  <div class="etree-sync-node-widget">','    <div class="etree-sync-node-color"></div>','    <div class="etree-sync-node-thumbnail"></div>','    <div class="etree-sync-node-caption">','      <div class="etree-sync-node-icon"></div>','      <div class="etree-sync-node-badgeTopRight"></div>','      <div class="etree-sync-node-badgeBottomRight"></div>','      <div class="etree-sync-node-label">noname</div>','      <div class="etree-sync-node-moreinfo" data-egraph-subelt="moreinfo"></div>',"    </div>","  </div>",'  <div class="etree-sync-node-collapse-expand" data-egraph-subelt="collapse-expand">','    <div class="etree-sync-node-collapse-expand-spinner"></div>',"  </div>","</div>",'<div class="etree-sync-temp-node">',"</div>",'<div class="etree-sync-group">',"</div>"].join("\n"),onmodifyDisplay:function(E){var C=E.nodeView;var A;var F=E.nodeModel;if(F.options.isBeingCut){C.classList.add("is-being-cut")}else{C.classList.remove("is-being-cut")}A=C.querySelector(".etree-sync-node-icon");A.classList.remove("hidden");if(F.options.icons&&F.options.icons.length>0){A.className="";A.classList.add("etree-sync-node-icon");f.generateIcon(F.options.icons[0],{target:A})}else{A.classList.add("hidden")}var D=F.getBadges();A=C.querySelector(".etree-sync-node-badgeTopRight");if(A){A.className="";A.classList.add("etree-sync-node-badgeTopRight");if(D&&D.topRight){f.generateIcon(D.topRight,{target:A})}else{A.classList.add("hidden")}}A=C.querySelector(".etree-sync-node-badgeBottomRight");if(A){A.className="";A.classList.add("etree-sync-node-badgeBottomRight");if(D&&D.bottomRight){f.generateIcon(D.bottomRight,{target:A})}else{A.classList.add("hidden")}}A=C.querySelector(".etree-sync-node-color");if(F.options.color){C.classList.add("colorized");A.style.backgroundColor=F.options.color}else{C.classList.remove("colorized")}C.querySelector(".etree-sync-node-label").textContent=F.options.label;A=C.querySelector(".etree-sync-node-moreinfo");A.classList.remove("hidden");if(F.options.showMoreInfo===false){A.classList.add("hidden")}A=C.querySelector(".etree-sync-node-thumbnail");var B=F.options.thumbnail;if(!B){B="../etree/assets/ghost.png"}A.style.backgroundImage='url("'+B+'")'}},l);var z={};var k=document.createElement("div");k.innerHTML=l.template;var v=k.querySelector(".etree-sync-node");var y=k.querySelector(".etree-sync-temp-node");var r=k.querySelector(".etree-sync-group");var j=function j(){c.HTMLNodeView.call(this)};d.inherit(j,c.HTMLNodeView);j.prototype.buildNodeElement=function o(){return r.cloneNode(true)};var t=function t(){c.HTMLNodeView.call(this)};d.inherit(t,c.HTMLNodeView);t.prototype.buildNodeElement=function o(){return v.cloneNode(true)};t.prototype.onmodifyDisplay=function i(F,E){var D,B,A,C;c.HTMLNodeView.prototype.onmodifyDisplay.apply(this,arguments);D=this.display.elt;l.onmodifyDisplay({nodeModel:F.data.data,nodeView:D});if(b.inPathSet(E,"data","displayFlags")){if(F.data.displayFlags&a.DisplayFlags.DRAGGED){D.classList.add("dragged")}else{D.classList.remove("dragged")}if(F.data.displayFlags&a.DisplayFlags.DRAG_NODE){D.classList.add("drag-node")}else{D.classList.remove("drag-node")}}if(b.inPathSet(E,"data","data","_isHighlighted")||b.inPathSet(E,"data","data","_isSelected")){if(F.data.data._isHighlighted||F.data.data._isSelected){D.classList.add("highlighted")}else{D.classList.remove("highlighted")}}if(b.inPathSet(E,"data","data","_isMatchingSearch")){if(F.data.data._isMatchingSearch){D.classList.add("matching-search")}else{D.classList.remove("matching-search")}}if(b.inPathSet(E,"data","data","_expandState")){A=D.querySelector(".etree-sync-node-collapse-expand").classList;A.remove("expanded");A.remove("collapsed");A.remove("expanding");A.remove("partiallyExpanded");A.remove("hidden");switch(F.data.data._expandState){case"collapseState":A.add("expanded");break;case"expandingState":A.add("expanding");break;case"expandState":A.add("collapsed");break;case"partiallyExpandedState":A.add("partiallyExpanded");break;default:A.add("hidden");break}}if(b.inPathSet(E,"data","*drawingModifiers*")&&F.data.document){D.classList.remove("root-on-left");D.classList.remove("root-on-right");D.classList.remove("root-on-bottom");if(F.data.document.drawingModifiers&a.DrawingModifiers.HORIZONTAL){if(F.data.document.drawingModifiers&a.DrawingModifiers.MIRROR_DEPTH){D.classList.add("root-on-right")}else{D.classList.add("root-on-left")}}else{if(F.data.document.drawingModifiers&a.DrawingModifiers.MIRROR_DEPTH){D.classList.add("root-on-bottom")}}}if(b.inPathSet(E,"data","height")){if(isNaN(F.data.height)){D.classList.remove("v-collapsed")}else{D.classList.add("v-collapsed")}}};var x=function x(){return new c.SVGEdgeView("etree-sync-edge")};var h=function h(){c.HTMLNodeView.call(this)};d.inherit(h,c.HTMLNodeView);h.prototype.buildNodeElement=function o(){return y.cloneNode(true)};var u=function u(){return new c.SVGEdgeView("etree-sync-temp-edge")};z.newNodeView=function n(){return new t()};z.newEdgeView=function q(){return new x()};z.newGroupView=function w(){return new j()};z.newTempNodeView=function p(){return new h()};z.newTempEdgeView=function s(){return new u()};z.newTempGroupView=function s(){return new h};return z}return{generateNodeView:function(h){return e(h)}}});define("DS/etree/iact",["DS/egraph/utils","DS/egraph/iact","DS/egraph/core","DS/etree/tree"],function(an,y,O,D){var ak={};function f(){return false}function v(ar,aq,at){var ap;ap=!(aq&1);D.timeit(this,function ao(){if(ap){if(at.expandAll){at.expandAll(ar,ar.expanded)}}else{if(at.toggleExpanded){at.toggleExpanded(ar)}}})}function al(ap){var aq;aq=ap.document;aq.withLockedUpdate(function ao(){ap.setExpanded(!ap.expanded);aq.setFixNode2(ap)})}function U(ar,ap,ao){if(ar.hideOverviewOnDrag){var aq=ap.views.ovr;if(aq){aq.setPierceable(ao)}}}function ai(aq,ao){var ar;ar=aq.document;ar.withLockedUpdate(function ap(){aq.setExpanded(aq.expanded,true);ar.setFixNode2(aq)})}function H(ap,at){var aq,ar,ao;aq=0;ar=ap.length;while(aq!==ar){ao=(aq+ar)>>>1;if(ap[ao]>=at){ar=ao}else{aq=ao+1}}return aq}function T(ao){return !ao.expanded||ao.type===D.Group.Type}function ae(ao){return ao.getActualWidth()}function B(ao){return ao.getActualHeight()}function A(aq,ap,ao){if(aq>ap){aq=ap=0.5*(aq+ap)}if(ao<aq){return -1}else{if(ao>=ap){return 1}else{return 0}}}function aj(aO,ay,aL,aU,ar,aH,aJ){function aN(a0,aZ,a2,a1,aY){var aX;if(aG){a2=-a2-aU}if(aF){a1=-a1-ar}if(ap){aX=a2;a2=a1;a1=aX}return{parent:a0,next:aZ,insertLeft:a2,insertTop:a1,mergeMode:aY?true:false}}function aR(a4,aY,a1,a6,a5){var aZ,aX,a3,a0,a2;if(!a4.first||!a4.expanded){a0=az(a4)+Math.round(0.5*(au(a4)-aU));a2=aP(aO.first)+aS[aY]}else{aX=-Infinity;a3=+Infinity;if(a5){a3=az(a5)}if(a6){aX=aD(a6)}aZ=a1?a1.prev:a4.last;if(a1){a3=Math.min(a3,az(a1))}if(aZ){aX=Math.max(aX,aD(aZ))}aX+=aO.siblingPadding+0.5*aU;a3-=aO.siblingPadding+0.5*aU;a0=Math.round(r(ay,aX,a3)-0.5*aU);a2=aP(a4.first)}return aN(a4,a1,a0,a2,false)}function aT(){return aN(aO,null,Math.round(ay-0.5*aU),Math.round(aL-0.5*ar),false)}function aP(aY){var aX;aX=ap?aY.left:aY.top;return aF?-aX-aB(aY):aX}function at(aY){var aX;aX=ap?aY.left:aY.top;return aF?-aX:aX+aB(aY)}function az(aY){var aX;aX=ap?aY.top:aY.left;return aG?-aX-au(aY):aX}function aD(aY){var aX;aX=ap?aY.top:aY.left;return aG?-aX:aX+au(aY)}var aA,aV,aS,av,aK,aC,aW,aE,aq,ap,aG,aF,aB,au,aI;if(aO.drawingData){aS=aO.drawingData.depthOffset;av=aO.drawingData.maxDepth+1}else{return aT()}aq=aO.drawingModifiers;ap=Boolean(aq&D.DrawingModifiers.HORIZONTAL);aG=Boolean(aq&D.DrawingModifiers.MIRROR_SIBLINGS);aF=Boolean(aq&D.DrawingModifiers.MIRROR_DEPTH);au=ap?B:ae;aB=ap?ae:B;if(ap){aI=aU;aU=ar;ar=aI}if(ap){aI=ay;ay=aL;aL=aI}if(aG){ay=-ay}if(aF){aL=-aL}if(!aO.first){return aT()}aV=H(aS,aL-aP(aO.first)+aO.rowPadding);if(aV>=aS.length){if(aJ&&aJ.extendLastRow){aV=aS.length-1}else{return null}}if(aV===0){aV=1}if(aO.drawing===D.Drawing.TWO_BRANCHES||aO.drawing===D.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY){aV=(2*aV)-1;av=(2*av)-1}aK=null;aC=null;if((aO.drawing===D.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY)&&(aV===av)){var ax=aO.drawingData.leaves;if(!ax){throw new Error("leaves are undefined")}var aQ;for(aQ=ax.length-1;aQ>=0;aQ--){var aM=ax[aQ];if(az(aM)>ay){aC=aM;break}else{aK=aM}}}else{var ao=null;aA=new D.NodeIterator(aO,aO.first);for(;aA.n;aA.dftNext(T(aA.n))){if(aA.n.data&&aA.n.data.isIntermediateNode){continue}var aw=aP(aA.n);if((aA.depth<=aV)&&(aw<=aL)&&(aw+aB(aA.n)>=aL)){ao=aA.n;break}if(aA.depth>aV){break}}if(!ao){return null}do{if(aA.n.data&&aA.n.data.isIntermediateNode){continue}if(az(aA.n)>ay){aC=aA.n;break}else{aK=aA.n}}while(aA.nextNeighbor2(T))}if(!aK&&!aC){return null}if(aK&&aD(aK)>=ay){if(aK.type===D.Group.Type){return buildGroupResult(aK)}if(aO.drawing===D.Drawing.TWO_BRANCHES||aO.drawing===D.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY){return aN(aK,null,az(aK),aP(aK),true)}return aR(aK,aV,undefined,aK.last,new D.NodeIterator(aO,aK.last).nextNeighbor2(T))}if((aC!==null)!==(aK!==null)){if(aC){return aR(aC.parent,aV-1,aC,aK,aC)}else{return aR(aK.parent,aV-1,null,aK,aC)}}if(aC.parent===aK.parent){return aR(aC.parent,aV-1,aC,aK,aC)}aW=ay-aD(aK);aE=az(aC)-ay;if(aW<aE){return aR(aK.parent,aV-1,null,aK,aC)}else{return aR(aC.parent,aV-1,aC,aK,aC)}}function h(aJ,au,aH,aP,aq,aD,aF){function aI(aU,aT,aW,aV){var aS;if(aC){aW=-aW-aP}if(aB){aV=-aV-aq}if(ao){aS=aW;aW=aV;aV=aS}return{parent:aU,next:aT,insertLeft:aW,insertTop:aV}}function aL(aZ,aT,aW,a1,a0){var aU,aS,aY,aV,aX;if(!aZ.first||!aZ.expanded){aV=av(aZ)+Math.round(0.5*(at(aZ)-aP));aX=aK(aJ.first)+aM[aT]}else{aS=-Infinity;aY=Number(Infinity);if(a0){aY=av(a0)}if(a1){aS=az(a1)}aU=aW?aW.prev:aZ.last;if(aW){aY=Math.min(aY,av(aW))}if(aU){aS=Math.max(aS,az(aU))}aS+=aJ.siblingPadding+0.5*aP;aY-=aJ.siblingPadding+0.5*aP;aV=Math.round(r(au,aS,aY)-0.5*aP);aX=aK(aZ.first)}return aI(aZ,aW,aV,aX)}function aN(a7){var a5,aY,a3,a2,aX,aW,a4,a9,a8,aZ,aT,a1,a0,a6,aU,aV,aS;if(!a7.expanded||!a7.first){return aI(a7,null,av(a7)+0.5*(at(a7)-aP),aK(a7)+aJ.groupPaddingTop)}a5=aJ.drawingData.groups;aY=null;for(a3=0,a2=a5.length;a3<a2;++a3){aY=a5[a3];if(aY.group===a7){break}}if(!aY){throw new Error("internal error")}aX=aY.cols.slice(0,aY.cols.length);a4=av(a7);for(a3=0,a2=aX.length-1;a3<a2;++a3){aX[a3]=a4+0.5*(aX[a3]+aX[a3+1]-aJ.groupColPadding)}aX.length=aX.length-1;aW=aY.rows.slice(1,aY.rows.length-1);a9=aK(a7);for(a3=0,a2=aW.length;a3<a2;++a3){aW[a3]+=a9-0.5*aJ.groupRowPadding}a8=H(aX,au);aZ=H(aW,aH);aT=aZ*aX.length+a8;for(a1=a7.first;a1&&aT;--aT){a1=a1.next}a8-=aT;if(aF&&aF.pickGroupChildren){a0=a1?a1.prev:a7.last;aV=null;aS=aF&&isFinite(aF.groupMinGap)?Math.max(0,aF.groupMinGap):50;aS*=aD.invVptScale>1?aD.invVptScale:1;if(a1&&a8!==aX.length&&au>=av(a1)&&au<az(a1)){if(a8===0){aV=A(av(a7)+aS,0.5*(az(a1)+av(a1)-aS),au)>=0?a1:null}else{aV=A(0.5*(az(a0)+av(a1)+aS),0.5*(az(a1)+av(a1)-aS),au)>=0?a1:null}}else{if(a8>0&&au>av(a0)&&au<az(a0)){if(a8===aX.length||!a1){aV=A(0.5*(az(a0)+av(a0)+aS),az(a7)-aS,au)<=0?a0:null}else{aV=A(0.5*(az(a0)+av(a0)+aS),0.5*(az(a0)+av(a1)-aS),au)<=0?a0:null}}}if(aV){return aI(aV,null,av(aV)+Math.round(0.5*(at(aV)-aP)),aY.rows[aZ+1]+a9-Math.round(0.5*aJ.groupRowPadding))}}aU=aY.rows[aZ]+a9;if(!a1){a6=r(au-0.5*aP,aY.cols[a8]+a4-0.5*(aJ.groupColPadding+aP),aY.cols[aY.cols.length-1]+a4-0.5*(aJ.groupColPadding+aP))}else{a6=aY.cols[a8]+a4-0.5*(aJ.groupColPadding+aP)}return aI(a7,a1,a6,aU)}function aO(){return aI(aJ,null,Math.round(au-0.5*aP),Math.round(aH-0.5*aq))}function aK(aT){var aS;aS=ao?aT.left:aT.top;return aB?-aS-ax(aT):aS}function ar(aT){var aS;aS=ao?aT.left:aT.top;return aB?-aS:aS+ax(aT)}function av(aT){var aS;aS=ao?aT.top:aT.left;return aC?-aS-at(aT):aS}function az(aT){var aS;aS=ao?aT.top:aT.left;return aC?-aS:aS+at(aT)}var aw,aQ,aM,aG,ay,aR,aA,ap,ao,aC,aB,ax,at,aE;aM=aJ.drawingData.depthOffset;ap=aJ.drawingModifiers;ao=Boolean(ap&D.DrawingModifiers.HORIZONTAL);aC=Boolean(ap&D.DrawingModifiers.MIRROR_SIBLINGS);aB=Boolean(ap&D.DrawingModifiers.MIRROR_DEPTH);at=ao?B:ae;ax=ao?ae:B;if(ao){aE=aP;aP=aq;aq=aE}if(ao){aE=au;au=aH;aH=aE}if(aC){au=-au}if(aB){aH=-aH}if(!aJ.first){return aO()}aQ=H(aM,aH-aK(aJ.first)+aJ.rowPadding);if(aQ>=aM.length){if(aF&&aF.extendLastRow){aQ=aM.length-1}else{return null}}if(aQ===0){aQ=1}aw=new D.NodeIterator(aJ,aJ.first);for(;aw.n;aw.dftNext(T(aw.n))){if(aw.depth===aQ){break}}if(!aw.n){throw new Error("internal error")}aG=null;ay=null;do{if(av(aw.n)>au){ay=aw.n;break}else{aG=aw.n}}while(aw.nextNeighbor2(T));if(aG&&az(aG)>=au){if(aG.type===D.Group.Type){return aN(aG)}return aL(aG,aQ,undefined,aG.last,new D.NodeIterator(aJ,aG.last).nextNeighbor2(T))}if((ay!==null)!==(aG!==null)){if(ay){return aL(ay.parent,aQ-1,ay,aG,ay)}else{return aL(aG.parent,aQ-1,null,aG,ay)}}if(ay.parent===aG.parent){return aL(ay.parent,aQ-1,ay,aG,ay)}aR=au-az(aG);aA=av(ay)-au;if(aR<aA){return aL(aG.parent,aQ-1,null,aG,ay)}else{return aL(ay.parent,aQ-1,ay,aG,ay)}}function R(ap,av,au,ar,ao,aq,at){switch(ap.drawing){case D.Drawing.LAYERED:case D.Drawing.LAYERED_TIDY_1:return h(ap,av,au,ar,ao,aq,at);case D.Drawing.TWO_BRANCHES:case D.Drawing.TWO_BRANCHES_LEAVES_ON_EXTREMITY:return aj(ap,av,au,ar,ao,aq,at);case D.Drawing.BRANCHED:throw new Error("not yet implemented");break;default:throw new Error("unsupported drawing method: "+ap.drawing)}}function ah(ar,ap,ao,aq){this.doc=ar;this.grview=ap;this.predicate=ao;this.tempWidth=an.pos_number_opt(aq,"tempWidth",ar.nodeWidth);this.tempHeight=an.pos_number_opt(aq,"tempHeight",ar.nodeHeight);this.tempGrNode=ar.newTempGrNode2(aq&&aq.node||null);this.tempGrNode.multiset("width",this.tempWidth,"height",this.tempHeight);this.tempGrConnector=new O.Connector();this.tempGrConnector.cstr=ar.parentConnectorCstr;this.tempGrNode.appendConnector(this.tempGrConnector);this.tempGrEdge=ar.newTempGrEdge();this.targetParent=null;this.targetNext=null;this.targetLeft=NaN;this.targetTop=NaN;this.mergeMode=false;this.iipv_memoization={parent:null,next:null,mergeMode:false,predicate_arg:null,result:false};this.pick_opts=undefined;if(aq){this.pick_opts={pickGroupChildren:aq.pickGroupChildren,groupMinGap:aq.groupMinGap,extendLastRow:aq.extendLastRow}}}function I(ap,ao){return ap===ao}function ad(au,ar,aq,ap,ao,at){at=at||I;if(ar===au.iipv_memoization.parent&&aq===au.iipv_memoization.next&&ap===au.iipv_memoization.mergeMode&&at(au.iipv_memoization.predicate_arg,ao)){return au.iipv_memoization.result}au.iipv_memoization.parent=ar;au.iipv_memoization.next=aq;au.iipv_memoization.mergeMode=ap;au.iipv_memoization.predicate_arg=ao;au.iipv_memoization.result=au.predicate.call(undefined,ar,aq,ap,ao);return au.iipv_memoization.result}ah.prototype.move=function c(aw,av,ao,at){function aq(){var ax;this.targetParent=this.targetNext=null;this.targetLeft=this.targetTop=NaN;this.mergeMode=false;ax=R(au,aw,av,this.tempWidth,this.tempHeight,this.grview,this.pick_opts);if(!ax||!ax.parent){return false}if(!ad(this,ax.parent,ax.next,ax.mergeMode,ao,at)){return false}this.targetParent=ax.parent;this.targetNext=ax.next;this.targetLeft=ax.insertLeft;this.targetTop=ax.insertTop;this.mergeMode=ax.mergeMode?true:false;au.gr.withLockedUpdate(function ay(){this.tempGrNode.multiset("left",ax.insertLeft,"top",ax.insertTop);au.gr.addNode(this.tempGrNode);this.tempGrEdge.remove();if(ax.parent.grChildrenC){au.gr.addEdge(ax.parent.grChildrenC,this.tempGrConnector,this.tempGrEdge)}},this);return true}var au,ar;au=this.doc;au.gr.withLockedUpdate(function ap(){ar=aq.call(this);if(!ar){this.tempGrNode.remove()}},this);return ar};ah.prototype.remove=function g(){this.targetParent=this.targetNext=null;this.targetLeft=this.targetTop=NaN;this.mergeMode=false;this.doc.gr.withLockedUpdate(function ao(){this.tempGrNode.remove()},this)};function j(ao){switch(ao.type){case D.Node.Type:return ao.getActualWidth();case D.Group.Type:return ao.getCollapsedWidth();default:throw new Error("unsupported kind of node")}}function af(ao){switch(ao.type){case D.Node.Type:return ao.getActualHeight();case D.Group.Type:return ao.getCollapsedHeight();default:throw new Error("unsupported kind of node")}}function w(at,ar,ao,ap){var aq;y.SinglePtDrag.call(this);this.rootstate=at;this.grview=ar.graphView;this.nodes=ao;this.node=ap;aq=ap.document;this.tempDraggedGrNodes=a(ao,ap);this.picker=new ah(aq,this.grview,i.bind(this),{tempWidth:j(ap),tempHeight:af(ap),pickGroupChildren:at.pickGroupChildren,groupMinGap:at.groupMinGap,extendLastRow:at.extendLastRow});this.draggedChanged=false}an.inherit(w,y.SinglePtDrag);function a(aq,ar){var at,au;at=ar.document;au=at.newDragNode(ar).grNode;return{move:function ap(aw,av){at.gr.addNode(au);au.multiset("left",aw-Math.round(0.5*au.width),"top",av-Math.round(0.5*au.height))},remove:function ao(){au.remove()}}}function r(aq,ap,ao){if(ap>ao){return 0.5*(ap+ao)}if(aq<ap){return ap}if(aq>ao){return ao}return aq}function i(aq,ap,ao,ar){if(!M(aq,ap)){return false}return J(this.rootstate,this.nodes,this.node,aq,ap,ao)}function n(ap,ao){return ap.modifiers===ao.modifiers}function b(ap){var aq;aq=ap.nodes[0].document;if(!ap.draggedChanged){ap.draggedChanged=true;aq.withLockedUpdate(function ao(){ap.nodes.forEach(function ar(at){at.setDragged(true)})})}}w.prototype.onmove=function K(ap){var aq;aq=this.nodes[0].document;b(this);aq.gr.withLockedUpdate(function ao(){this.picker.move(ap.graphPos[0],ap.graphPos[1],ap,n);this.tempDraggedGrNodes.move(ap.graphPos[0],ap.graphPos[1])},this)};function E(ar,at,av,aq,ap,ao){return function au(ax){var aA,az,ay;aA=ax.document;aA.withLockedUpdate(function aw(){if(at!==undefined&&ar.expanded){az=av+aA.alignmentH*(ap-ax.getActualWidth());ay=aq+aA.alignmentV*(ao-ax.getActualHeight());aA.setFixNode2(ax,{position:{left:az,top:ay},alignmentH:0,alignmentV:0})}else{aA.setFixNode2(ar)}})}}w.prototype.onstart=function Q(){if(this.node){var ap=this.node.document;if(ap){ap.withLockedUpdate(function ao(){ag(this.rootstate,this.nodes,this.node)},this)}}};w.prototype.onend=function k(ax){var au,ap,av,aq,at,aw,ar;au=this.node.document;ap=this.picker.targetParent;av=this.picker.targetNext;at=this.picker.targetLeft;aw=this.picker.targetTop;ar=this.picker.mergeMode;aq=ab(av);au.withLockedUpdate(function ao(){this.picker.remove();this.tempDraggedGrNodes.remove();try{if(!ax){if(ap){b(this);ac(this.rootstate,this.nodes,this.node,ap,aq,ar,E(ap,av,at,aw,this.picker.tempWidth,this.picker.tempHeight))}}}finally{if(this.draggedChanged){this.nodes.forEach(function ay(az){az.setDragged(false)})}t(this.rootstate,this.nodes,this.node)}},this)};function e(ao,ap){return{modifiers:ap.modifiers,internal:Boolean(ao.nodes),nodes:ao.nodes,node:ao.node,move:ao.move}}function M(ar,aq){var at,ao,ap;if(ar.displayFlags&D.DisplayFlags.DRAGGED){return false}at=aq?aq.prev:ar.last;ao=Boolean(aq&&aq.displayFlags&D.DisplayFlags.DRAGGED);ap=Boolean(at&&at.displayFlags&D.DisplayFlags.DRAGGED);return ap!==ao||!ao}function ab(ao){while(ao&&ao.displayFlags&D.DisplayFlags.DRAGGED){ao=ao.next}return ao}function am(ap,aq){var aq,at;at=ap.some(function ar(au){return Boolean(au.displayFlags&D.DisplayFlags.DRAGGED)!==aq});if(at){ap[0].document.withLockedUpdate(function ao(){ap.forEach(function au(av){av.setDragged(aq)})})}}function V(ar,aq,ap,at){var ao;if(this.nodes){ao=s(this.rootstate,at.dataTransfer,e(this,at));am(this.nodes,ao);this.move=Boolean(ao)}if(!M(ar,aq)){return false}return X(this.rootstate,at.dataTransfer,ar,aq,e(this,at))}function P(ar,aq,ao,ap){this.rootstate=ar;this.doc=aq.graph.data;this.grview=aq.graphView;this.nodes=ao;this.node=ap;this.move=false;this.picker=new ah(this.doc,this.grview,V.bind(this),{tempWidth:ap?j(ap):this.doc.nodeWidth,tempHeight:ap?af(ap):this.doc.nodeHeight,pickGroupChildren:ar.pickGroupChildren,groupMinGap:ar.groupMinGap,extendLastRow:ar.extendLastRow})}function u(ar,aq){var ap;ar.doc.gr.withLockedUpdate(function ao(){ap=ar.picker.move(aq.graphPos[0],aq.graphPos[1],aq,f)});return ap}function x(ap){var ao;ao=u(this,ap);if(!ao){ap.dataTransfer.dropEffect="none"}return{consume:true}}P.prototype.ondragenter=x;P.prototype.ondragover=x;P.prototype.doDrop=function S(ar){var ao,aq,ap;ao=u(this,ar);if(ao){aq=e(this,ar);aq.recenter=E(this.picker.targetParent,this.picker.targetNext,this.picker.targetLeft,this.picker.targetTop,this.picker.tempWidth,this.picker.tempHeight);ap=ab(this.picker.targetNext);ao=F(this.rootstate,ar.dataTransfer,this.picker.targetParent,ap,aq)}return ao};function z(ap){if(ap.nodes){ap.nodes[0].document.withLockedUpdate(function ao(){ap.nodes.forEach(function aq(ar){ar.setDragged(false)})})}}P.prototype.onend=function q(ao){this.picker.remove();if(an.isIE()&&requestAnimationFrame){requestAnimationFrame(z.bind(undefined,this))}else{z(this)}};ak.SelectMode={REPLACE:0,RANGE:1,ADD:2,ADD_RANGE:3,TOUCH:4,EMPTY:8};ak.SelectAction={REPLACE:0,ADD:1,SUBTRACT:2,INTERSECT:3};function C(aq){var ap;ap=null;return function ao(av,ay){var au,aB,aA,az,ar,ax,at,aw;ax=aq.selectionModel;if(!ax){return}aB=av.document;if(ay===ak.SelectMode.EMPTY){ap=null;at=[];aw=ak.SelectAction.REPLACE}else{if(ay===ak.SelectMode.TOUCH||ay===ak.SelectMode.ADD){ap=av;at=[av];aw=ax.isSelected(av)?ak.SelectAction.SUBTRACT:ak.SelectAction.ADD}else{if(ay===ak.SelectMode.REPLACE){ap=av;at=[av];aw=ak.SelectAction.REPLACE}else{if(ay===ak.SelectMode.RANGE||ay===ak.SelectMode.ADD_RANGE){for(au=ap&&ap.parent;au;au=au.parent){if(!au.expanded){ap=null;break}}for(au=ap;au&&au!==av;au=au.dftNext(aB,!au.expanded)){}if(au){aA=ap;az=av}else{for(au=av;au&&au!==ap;au=au.dftNext(aB,!au.expanded)){}if(au){aA=av;az=ap}else{ap=av;aA=az=av}}at=[];ar=az.dftNext(aB,!az.expanded);for(au=aA;au!==ar;au=au.dftNext(aB,!au.expanded)){at.push(au)}if(ay===ak.SelectMode.RANGE){aw=ak.SelectAction.REPLACE}else{aw=ax.isSelected(ap)?ak.SelectAction.ADD:ak.SelectAction.SUBTRACT;ap=av}}}}}if(aq.ignoreGroups){at=at.filter(function aC(aD){return aD.type!==D.Group.Type})}ax.updateSelection(at,aw)}}function o(aq,au,at){var ar,ao;if(!Array.isArray(aq)){aq=[aq]}au.document.withLockedUpdate(function ap(){for(ar=0,ao=aq.length;ar<ao;++ar){au.insertBefore(aq[ar],at)}})}ak.RootState=function N(){this.buttons={collapser:v};this.oncontext=null;this.longTouchDelay=600;this.actions={toggleExpanded:al,expandAll:ai,select:C(this),insert:o};this.selectionModel=null;this.dragMultipleNodes=false;this.movePredicate=undefined;this.insertPredicate=undefined;this.dnd_enabled=false;this.hideOverviewOnDrag=true;this.dnd_dragStart=undefined;this.dnd_isMove=undefined;this.dnd_dropPredicate=undefined;this.dnd_drop=undefined;this.ignoreGroups=false;this.pickGroupChildren=false;this.groupMinGap=50;this.extendLastRow=false};function p(ao,ap){if(!ao){return null}switch(ao.type){case O.Type.GROUP:if(ap){break}case O.Type.NODE:return ao.data}return null}function l(aq,ar,aw,aC,au,ao,at){function ay(){ar.enddrag(true);return{state:au,reinterpret:true}}var ax;ax=new P(aq,ar,ao,at);ar.startdrag(ax);function ap(aD){if(aD&&aD.tagName){return aD.tagName+"#"+aD.id+"."+aD.className}else{return String(aD)}}return{reinterpret:true,state:{last_entered:null,before_last_entered:null,ondragenter:function aA(aE,aD){this.before_last_entered=this.last_entered;this.last_entered=aD.dom;return{}},ondragover:function av(aF,aE){var aD;U(aq,aF.graph,true);aD=aE.dom;if(aD!==this.last_entered&&this.last_entered&&this.last_entered.nodeType===Node.TEXT_NODE&&this.last_entered.parentNode===aD){aD=this.last_entered}if(aD!==this.last_entered){this.before_last_entered=this.last_entered;this.last_entered=aE.dom}return{}},ondragleave:function aB(aE,aD){if(aD.dom===this.before_last_entered){return{}}U(aq,aE.graph,false);this.before_last_entered=this.last_entered=null;aE.enddrag(true);return{state:aC}},ondrop:function az(aF,aD){var aE;U(aq,aF.graph,false);aE=ax.doDrop(aD);aF.enddrag(false);if(!aE){aD.dataTransfer.dropEffect="none"}return{consume:true,state:aC}},ondragend:ay,onmousedown:ay,onmousemove:ay,onmouseup:ay}}}function d(ar,aq,ao,ap){if(ar.actions.select){ar.actions.select(ao,ap)}}function aa(ar,aq,ao,ap){if(ar.dnd_dragStart){return ar.dnd_dragStart(aq,ao,ap)}else{aq.setData("text","");aq.effectAllowed="move";return true}}function ag(aq,ao,ap){if(aq.actions.dragStart){return aq.actions.dragStart(ao,ap)}}function t(aq,ao,ap){if(aq.actions.dragEnd){return aq.actions.dragEnd(ao,ap)}}function J(av,ap,au,at,ar,aq){if(av.insertPredicate){return av.insertPredicate(at,av.dragMultipleNodes?ap:ap[0],ar||null,{node:au,mergeMode:aq})}else{if(at.type!==D.Group.Type){return true}return ap.every(function ao(aw){return !aw.first})}}function s(aq,ap,ao){if(aq.dnd_isMove){return aq.dnd_isMove(ap,ao)}else{return true}}function X(at,ar,ap,ao,aq){if(at.dnd_dropPredicate){return at.dnd_dropPredicate(ar,ap,ao,aq)}else{if(!aq.internal){return false}return J(at,aq.nodes,aq.node,ap,ao,false)}}function ac(aw,ap,av,au,at,ar,ao){var aq;if(aw.actions.insert){aq=aw.actions.insert(aw.dragMultipleNodes?ap:ap[0],au,at,{node:av,mergeMode:ar,recenter:ao});if(ao&&(!aq||!aq.no_recenter)){ao(av)}}}function F(au,at,aq,ap,ar){if(au.dnd_drop){return au.dnd_drop(at,aq,ap,ar)}else{if(!ar.internal){return false}aq.document.withLockedUpdate(function ao(){ac(au,ar.nodes,ar.node,aq,ap,false,ar.recenter)});return true}}function Z(aq,ap){var ao;if(aq.dragMultipleNodes){ao=aq.selectionModel.getSelection().slice();D.filterVisibleNodes(ao);D.sortNodes(ao,{unique:true});if(ao.indexOf(ap)===-1){throw new Error("visible selection does not contain node!")}}else{ao=[ap]}if(!aq.movePredicate||aq.movePredicate(aq.dragMultipleNodes?ao:ap)){return ao}else{return[]}}ak.RootState.prototype.ontouchstart=function(aq,at){function ap(){if(av){av.cancel();av=null}}var ao,au,av,ar;au=this;if(at.changedTouches.length===2){return{consume:true,state:y.TwoPointsViewpointWait}}if(at.changedTouches.length>2){return{consume:true,state:y.WaitLastTouch}}if(this.oncontext){ar=p(at.graphTouches[0].grElt,this.ignoreGroups);av={cb:this.oncontext,timer:setTimeout(function ax(){aq.setState(y.WaitLastTouch);av.cb.call(au,av.data)},this.longTouchDelay),cancel:function aw(){clearTimeout(this.timer)},data:{device:"touch",node:ar,subElt:at.graphTouches[0].subElt,dom:at.graphTouches[0].target,clientPos:at.graphTouches[0].clientPos,graphPos:at.graphTouches[0].graphPos,modifiers:at.modifiers}}}else{av=null}ao={ontouchstart:function(az,ay){ap();if(ay.changedTouches.length===1){return{consume:true,state:y.TwoPointsViewpointWait}}else{return{consume:true,state:y.WaitLastTouch}}},ontouchend:function(aA){var ay,az;ap();az=p(at.graphTouches[0].grElt,au.ignoreGroups);if(az){ay=au.buttons[at.graphTouches[0].subElt];if(ay){ay(az,1,au.actions)}else{d(au,aA,az,ak.SelectMode.TOUCH)}}else{d(au,aA,aA.graph.data,ak.SelectMode.EMPTY)}return{consume:true,state:null}},ontouchcancel:function(){ap();return{consume:true,state:null}},ontouchmove:function(aB,aA){var az,ay;if(!y.isTouchDragSignificant(aA)){return{consume:true}}ap();az=p(at.graphTouches[0].grElt,au.ignoreGroups);if(az){if(!au.dragMultipleNodes||!au.selectionModel.isSelected(az)){d(au,aB,az,ak.SelectMode.REPLACE)}ay=Z(au,az);if(ay.length){aq.startdrag(new w(au,aB,ay,az))}}else{aq.startdrag(new y.ViewpointMoveDrag(aq.graphView))}return{consume:true,state:y.EndDragOnTouchChange}}};return{consume:true,state:ao}};ak.RootState.prototype.ontouchmove=function(ap,ao){return{consume:true}};ak.RootState.prototype.ontouchend=function(ap,ao){return{consume:true}};ak.RootState.prototype.ontouchcancel=function(ap,ao){return{consume:true}};function G(ao){while(ao){if(ao.draggable){return true}ao=ao.parentNode}}function Y(ar,at,aw,ao,au){function ay(aC,aB){return l(ar,aC,aB,this,ar,ao,au)}var aA;aA=!aa(ar,aw.dataTransfer,ao,au);if(aA){return{consume:true,state:ar}}var av=aw.dom.getBoundingClientRect();var az=at.graph.views.main.domRoot.getBoundingClientRect();var aq=aw.dragStart.clientPos[0]-av.left;var ap=aw.dragStart.clientPos[1]-av.top;if(typeof(aw.dataTransfer.setDragImage)==="function"){aw.dataTransfer.setDragImage(aw.dom,aq,ap)}return{state:{ondragend:function ax(aC,aB){return{consume:true,state:ar}},ondragenter:ay,ondragover:ay}}}ak.RootState.prototype.ondoubleclick=function(ar,aq){var ao,ap;if(aq.button===y.Buttons.LEFT){ap=p(aq.grElt,this.ignoreGroups);if(!ap){return{}}if(ao=this.doubleClickOnNode,ao){ao(ap);return{consume:true}}}return{}};ak.RootState.prototype.onmousedown=function(av,aA){function az(){var aE;aE=at;at=null;if(aE){aE()}}var ax,aw,aq,aB,at,au,ap,ao;aB=this;if(aA.inside){if(aA.button===y.Buttons.LEFT){if(aA.modifiers&y.Modifiers.ALT){if(aA.modifiers&y.Modifiers.CTRL){av.startdrag(new y.ViewpointScaleDrag(av.graphView,aA.graphPos))}else{av.startdrag(new y.ViewpointMoveDrag(av.graphView))}return{consume:true,state:y.EndDragOnLeftState}}aw=p(aA.grElt,this.ignoreGroups);if(aw){au=this.dnd_enabled&&G(aA.dom);ap=aA.modifiers===y.Modifiers.CTRL&&this.dragMultipleNodes;if(aA.modifiers===y.Modifiers.SHIFT){d(this,av,aw,ak.SelectMode.RANGE)}else{if(aA.modifiers===y.Modifiers.CTRL){at=d.bind(undefined,this,av,aw,ak.SelectMode.ADD);if(ap){if(!this.selectionModel.isSelected(aw)){d(this,av,aw,ak.SelectMode.ADD);ao=true}aq=Z(this,aw);if(aq.length){if(au){return{state:{onmouseup:function ay(aF,aE){if(aE.button===y.Buttons.LEFT){if(!ao){az()}return{consume:true,state:null}}return{}},ondragstart:function ar(aF,aE){return Y(aB,aF,aE,aq,aw)}}}}else{return{consume:true,state:{onmouseup:function ay(aF,aE){if(aE.button===y.Buttons.LEFT){if(!ao){az()}return{consume:true,state:null}}return{}},onmousemove:(function aD(aF,aE){if(!aE.clientDelta[0]&&!aE.clientDelta[1]){return{consume:true}}aF.startdrag(new w(this,aF,aq,aw));return{consume:true,state:y.EndDragOnLeftState}}).bind(this)}}}}else{az()}return{consume:true}}else{az()}}else{if(aA.modifiers===(y.Modifiers.CTRL|y.Modifiers.SHIFT)){d(this,av,aw,ak.SelectMode.ADD_RANGE)}}}if(aA.modifiers===0){if(ax=this.buttons[aA.subElt],ax){av.startdrag(new y.SubEltClickDrag(aA.grElt,aA.subElt,ax.bind(undefined,aw,aA.detail,this.actions)));return{consume:true,state:y.EndDragOnLeftState}}else{at=d.bind(undefined,this,av,aw,ak.SelectMode.REPLACE);if(!this.dragMultipleNodes||!this.selectionModel.isSelected(aw)){az()}aq=Z(this,aw);if(aq.length){if(au){return{state:{onmouseup:function ay(aF,aE){if(aE.button===y.Buttons.LEFT){az();return{consume:true,state:null}}return{}},ondragstart:function ar(aF,aE){return Y(aB,aF,aE,aq,aw)}}}}else{return{consume:true,state:{onmouseup:function ay(aF,aE){if(aE.button===y.Buttons.LEFT){az();return{consume:true,state:null}}return{}},onmousemove:(function aD(aF,aE){if(!aE.clientDelta[0]&&!aE.clientDelta[1]){return{consume:true}}aF.startdrag(new w(this,aF,aq,aw));return{consume:true,state:y.EndDragOnLeftState}}).bind(this)}}}}else{az()}return{consume:true}}}return{consume:true}}else{if(aA.modifiers===0){d(this,av,av.graph.data,ak.SelectMode.EMPTY)}if(aA.modifiers&y.Modifiers.CTRL){av.startdrag(new y.ViewpointScaleDrag(av.graphView,aA.graphPos))}else{av.startdrag(new y.ViewpointMoveDrag(av.graphView))}return{consume:true,state:y.EndDragOnLeftState}}}else{if(aA.button===y.Buttons.RIGHT){if(ax=this.oncontext,ax){return{consume:true,state:{onmouseup:function aC(aG,aE){var aF;if(aE.button===y.Buttons.RIGHT){aF=p(aE.grElt,aB.ignoreGroups);ax({device:"mouse",node:aF,subElt:aE.subElt,dom:aE.target,clientPos:aE.clientPos,graphPos:aE.graphPos,modifiers:aE.modifiers});return{consume:true,state:null}}return{}}}}}}}}return{}};function L(ap,ao){if(!this.dnd_enabled){return{}}return l(this,ap,ao,this,this)}ak.RootState.prototype.ondragenter=L;ak.RootState.prototype.ondragover=L;ak.RootState.prototype.ondrop=L;ak.RootState.prototype.oncontextmenu=function W(){if(this.oncontext){return{consume:true}}else{return{}}};ak.RootState.prototype.onwheel=function(au,ap){var at,ar;if(ap.inside){at=au.graphView;var ao=undefined,aq=undefined;if(at.gr.zoomOpts){if(at.gr.zoomOpts.min&&!isNaN(at.gr.zoomOpts.min)){ao=at.gr.zoomOpts.min}if(at.gr.zoomOpts.max&&!isNaN(at.gr.zoomOpts.max)){aq=at.gr.zoomOpts.max}}ar=an.incViewpointScale(at.vpt,0.5*ap.wheelDelta,ap.graphPos,true,[ao,aq,0.5]);0.5*1;at.setViewpoint(ar,true);return{consume:true}}else{return{}}};return ak});define("etree/iact",["DS/etree/iact"],function mod(a){return a});define("DS/etree/syncviews",["DS/egraph/utils","DS/egraph/views","DS/egraph/core","DS/etree/tree","DS/Utilities/Dom"],function(v,l,u,n,b){var w={};var e=document.createElement("div");e.innerHTML=['<div class="etree-sync-node" draggable="true">','  <div class="etree-sync-node-widget">','    <div class="etree-sync-node-color"></div>','    <div class="etree-sync-node-thumbnail"></div>','    <div class="etree-sync-node-caption">','      <div class="etree-sync-node-icon"></div>','      <div class="etree-sync-node-badgeTopRight"></div>','      <div class="etree-sync-node-badgeBottomRight"></div>','      <div class="etree-sync-node-label">noname</div>','      <div class="etree-sync-node-moreinfo" data-egraph-subelt="moreinfo"></div>',"    </div>","  </div>",'  <div class="etree-sync-node-collapse-expand" data-egraph-subelt="collapse-expand">','    <div class="etree-sync-node-collapse-expand-spinner"></div>',"  </div>","</div>",'<div class="etree-sync-temp-node">',"</div>",'<div class="etree-sync-group">',"</div>"].join("\n");var r=e.querySelector(".etree-sync-node");var t=e.querySelector(".etree-sync-temp-node");var j=e.querySelector(".etree-sync-group");var d=function d(){l.HTMLNodeView.call(this)};v.inherit(d,l.HTMLNodeView);d.prototype.buildNodeElement=function h(){return j.cloneNode(true)};var o=function o(){l.HTMLNodeView.call(this)};v.inherit(o,l.HTMLNodeView);o.prototype.buildNodeElement=function h(){return r.cloneNode(true)};o.prototype.onmodifyDisplay=function c(z,C){var A,E,F,x;l.HTMLNodeView.prototype.onmodifyDisplay.apply(this,arguments);A=this.display.elt;if(u.inPathSet(C,"data","data","options","isBeingCut")){if(z.data.data.options.isBeingCut){A.classList.add("is-being-cut")}else{A.classList.remove("is-being-cut")}}if(u.inPathSet(C,"data","data","options","icons")){E=A.querySelector(".etree-sync-node-icon");E.className="";E.classList.add("etree-sync-node-icon");if(z.data.data.options.icons&&z.data.data.options.icons.length>0){b.generateIcon(z.data.data.options.icons[0],{target:E})}else{E.classList.add("hidden")}}var B=z.data.data.getBadges();E=A.querySelector(".etree-sync-node-badgeTopRight");if(E){E.className="";E.classList.add("etree-sync-node-badgeTopRight");if(B&&B.topRight){b.generateIcon(B.topRight,{target:E})}else{E.classList.add("hidden")}}E=A.querySelector(".etree-sync-node-badgeBottomRight");if(E){E.className="";E.classList.add("etree-sync-node-badgeBottomRight");if(B&&B.bottomRight){b.generateIcon(B.bottomRight,{target:E})}else{E.classList.add("hidden")}}if(u.inPathSet(C,"data","data","options","color")){E=A.querySelector(".etree-sync-node-color");if(z.data.data.options.color){A.classList.add("colorized");E.style.backgroundColor=z.data.data.options.color}else{A.classList.remove("colorized")}}if(u.inPathSet(C,"data","data","options","label")){var D=z.data.data.options.label;var y=z.data.data.options.alternText;E=A.querySelector(".etree-sync-node-label");if(D&&typeof D!=="object"){E.textContent=D}else{if(y){E.textContent=y}}A.querySelector(".etree-sync-node-widget").setAttribute("title",D)}if(u.inPathSet(C,"data","data","options","showMoreInfo")){E=A.querySelector(".etree-sync-node-moreinfo");E.classList.remove("hidden");if(z.data.data.options.showMoreInfo===false){E.classList.add("hidden")}}if(u.inPathSet(C,"data","data","options","thumbnail")){E=A.querySelector(".etree-sync-node-thumbnail");x=z.data.data.options.thumbnail;if(!x){x="../etree/assets/ghost.png"}E.style.backgroundImage='url("'+x+'")'}if(u.inPathSet(C,"data","displayFlags")){if(z.data.displayFlags&n.DisplayFlags.DRAGGED){A.classList.add("dragged")}else{A.classList.remove("dragged")}if(z.data.displayFlags&n.DisplayFlags.DRAG_NODE){A.classList.add("drag-node")}else{A.classList.remove("drag-node")}}if(u.inPathSet(C,"data","data","_isHighlighted")||u.inPathSet(C,"data","data","_isSelected")){if(z.data.data._isHighlighted||z.data.data._isSelected){A.classList.add("highlighted")}else{A.classList.remove("highlighted")}}if(u.inPathSet(C,"data","data","_isMatchingSearch")){if(z.data.data._isMatchingSearch){A.classList.add("matching-search")}else{A.classList.remove("matching-search")}}if(u.inPathSet(C,"data","data","_expandState")){F=A.querySelector(".etree-sync-node-collapse-expand").classList;F.remove("expanded");F.remove("collapsed");F.remove("expanding");F.remove("partiallyExpanded");F.remove("hidden");switch(z.data.data._expandState){case"collapseState":F.add("expanded");break;case"expandingState":F.add("expanding");break;case"expandState":F.add("collapsed");break;case"partiallyExpandedState":F.add("partiallyExpanded");break;default:F.add("hidden");break}}if(u.inPathSet(C,"data","*drawingModifiers*")&&z.data.document){A.classList.remove("root-on-left");A.classList.remove("root-on-right");A.classList.remove("root-on-bottom");if(z.data.document.drawingModifiers&n.DrawingModifiers.HORIZONTAL){if(z.data.document.drawingModifiers&n.DrawingModifiers.MIRROR_DEPTH){A.classList.add("root-on-right")}else{A.classList.add("root-on-left")}}else{if(z.data.document.drawingModifiers&n.DrawingModifiers.MIRROR_DEPTH){A.classList.add("root-on-bottom")}}}if(u.inPathSet(C,"data","height")){if(isNaN(z.data.height)){A.classList.remove("v-collapsed")}else{A.classList.add("v-collapsed")}}};var s=function s(){return new l.SVGEdgeView("etree-sync-edge")};var a=function a(){l.HTMLNodeView.call(this)};v.inherit(a,l.HTMLNodeView);a.prototype.buildNodeElement=function h(){return t.cloneNode(true)};var p=function p(){return new l.SVGEdgeView("etree-sync-temp-edge")};w.newNodeView=function f(){return new o()};w.newEdgeView=function i(){return new s()};w.newGroupView=function q(){return new d()};w.newTempNodeView=function g(){return new a()};w.newTempEdgeView=function k(){return new p()};w.newTempGroupView=function k(){return new a()};return w});define("etree/syncviews",["DS/etree/syncviews"],function mod(a){return a});define("DS/etree/basicviews",["DS/etree/tree","DS/egraph/utils","DS/egraph/views","DS/egraph/core"],function(k,s,i,r){var t={};var c=document.createElement("div");c.innerHTML=['<div class="etree-basic-node">','  <div class="etree-basic-node-name">noname</div>','  <div class="etree-basic-node-collapser" data-egraph-subelt="collapser"></div>',"</div>",'<div class="etree-basic-temp-node">',"</div>"].join("\n");var o=c.querySelector(".etree-basic-node");var q=c.querySelector(".etree-basic-temp-node");t.newNodeView=function d(){return new t.NodeView()};t.NodeView=function l(){i.HTMLNodeView.call(this)};s.inherit(t.NodeView,i.HTMLNodeView);t.NodeView.prototype.buildNodeElement=function e(v){var u;u=o.cloneNode(true);return u};t.NodeView.prototype.onmodifyDisplay=function b(y,w){var v,u,x;i.HTMLNodeView.prototype.onmodifyDisplay.apply(this,arguments);v=this.display.elt;if(r.inPathSet(w,"data","data","name")){v.querySelector(".etree-basic-node-name").textContent=y.data.data.name}if(y.type===r.Type.GROUP&&r.inPathSet(w,"collapsed")){if(y.collapsed){v.classList.remove("group-expanded")}else{v.classList.add("group-expanded")}}if(r.inPathSet(w,"data","displayFlags")){if(y.data.displayFlags&k.DisplayFlags.DRAGGED){v.classList.add("dragged")}else{v.classList.remove("dragged")}}if(r.inPathSet(w,"data","data","highlighted")||r.inPathSet(w,"data","displayFlags")){if(y.data.data.highlighted&&!(y.data.displayFlags&k.DisplayFlags.DRAG_NODE)){v.classList.add("highlighted")}else{v.classList.remove("highlighted")}}if(r.inPathSet(w,"data","*children*")||r.inPathSet(w,"data","expanded")){u=v.querySelector(".etree-basic-node-collapser").classList;u.remove("expanded");u.remove("collapsed");if(y.data.first){if(y.data.expanded){u.add("expanded")}else{u.add("collapsed")}}}if(r.inPathSet(w,"data","*drawingModifiers*")&&y.data.document){u=v.querySelector(".etree-basic-node-collapser").classList;x=y.data.document.drawingModifiers;if(x&k.DrawingModifiers.MIRROR_SIBLINGS){u.add("mirrored-x")}else{u.remove("mirrored-x")}if(x&k.DrawingModifiers.MIRROR_DEPTH){u.add("mirrored-y")}else{u.remove("mirrored-y")}}};t.newGroupView=function p(){return new t.GroupView()};t.GroupView=t.NodeView;t.GraphView=i.HTMLGraphView;t.newEdgeView=function g(){return new t.EdgeView()};t.EdgeView=i.SVGEdgeView;t.newTempNodeView=function f(){return new t.TempNodeView()};t.TempNodeView=function a(){i.HTMLNodeView.call(this)};s.inherit(t.TempNodeView,i.HTMLNodeView);t.TempNodeView.prototype.buildNodeElement=function e(v){var u;u=q.cloneNode(true);return u};t.newTempGroupView=function j(){return new t.TempGroupView()};t.TempGroupView=t.TempNodeView;t.newTempEdgeView=function h(){return new t.TempEdgeView()};t.TempEdgeView=function n(){i.SVGEdgeView.call(this,"etree-basic-temp-edge")};s.inherit(t.TempEdgeView,i.SVGEdgeView);return t});define("etree/basicviews",["DS/etree/basicviews"],function mod(a){return a});define("DS/etree/widget",["DS/etree/tree","DS/etree/basicviews","DS/egraph/iact","DS/etree/iact","DS/egraph/utils"],function(a,g,e,f,b){var c={};c.EGraphTree=function(j,h){function v(D,y){function x(F){switch(typeof h[F]){case"undefined":return undefined;case"function":return h[F];default:throw new Error("opts."+F+" must be a function or undefined")}}var A,E,B,C;A="new"+D.substr(0,1).toUpperCase()+D.substr(1);E=D+"Ctor";B=x(A);C=x(E);if(B&&C){throw new Error("both opts."+A+" and opts."+E+" can't be set at the same time")}if(B){return B}if(!C){return y}return function z(F){return new C(F)}}var i,q,l,n,u,t,w,s;h=h||{};if(!j||j.nodeType!==Node.ELEMENT_NODE){throw new Error("container must be a DOM element")}if(h&&h.rootState){i=h.rootState;["actions","buttons","movePredicate","insertPredicate","oncontext","longTouchDelay","ignoreGroups","pickGroupChildren","groupMinGap","extendLastRow","selectionModel","dragMultipleNodes","dnd_enabled","dnd_dragStart","dnd_isMove","dnd_dropPredicate","dnd_drop"].forEach(function k(x){if(h&&h[x]!==undefined){throw new Error("can't set opts."+x+" with custom opts.rootState")}})}else{i=new f.RootState();["movePredicate","insertPredicate","oncontext","dnd_dragStart","dnd_isMove","dnd_dropPredicate","dnd_drop","doubleClickOnNode"].forEach(function r(x){i[x]=b.function_opt(h,x,i[x])});["ignoreGroups","pickGroupChildren","extendLastRow","dragMultipleNodes","dnd_enabled"].forEach(function p(x){if(h&&h[x]!==undefined){i[x]=Boolean(h[x])}});if(h&&h.selectionModel){i.selectionModel=h.selectionModel}else{if(h.dragMultipleNodes){throw new Error("can't use opts.dragMultipleNodes without an opts.selectionModel")}}if(h&&h.groupMinGap!==undefined){i.groupMinGap=h.groupMinGap}i.longTouchDelay=b.pos_nonzero_number_opt(h,"longTouchDelay",i.longTouchDelay);if(h&&h.actions){if(typeof h.actions!=="object"){throw new Error("opts.actions must be an object")}s=i.actions;if(h.overrideAllActions){i.actions={}}Object.keys(h.actions).forEach(function o(x){var y;y=h.actions[x];if(typeof y!=="function"){throw new Error("opts.actions["+JSON.stringify(x)+"] is not a function")}if(y===c.defaultAction){y=s[x];if(typeof y!=="function"){throw new Error("opts.actions["+JSON.stringify(x)+"] can not use defaultAction since it does not exist")}}i.actions[x]=y})}if(h&&h.buttons){if(typeof h.buttons!=="object"){throw new Error("opts.buttons must be an object")}if(h.overrideAllButtons){i.buttons={}}Object.keys(h.buttons).forEach(function o(x){var y;y=h.buttons[x];if(typeof y!=="function"){throw new Error("opts.buttons["+JSON.stringify(x)+" is not a function")}i.buttons[x]=y})}}this.document=h&&h.document||new a.Document();if(!(this.document instanceof a.Document)){throw new Error("opts.document must be a etree/tree.Document")}if(h&&h.nodeWidth){this.document.nodeWidth=h.nodeWidth|0}if(h&&h.nodeHeight){this.document.nodeHeight=h.nodeHeight|0}if(h&&h.rowPadding){this.document.rowPadding=h.rowPadding|0}if(h&&h.siblingPadding){this.document.siblingPadding=h.siblingPadding|0}if(h&&h.mergeConnectorPadding){this.document.mergeConnectorPadding=h.mergeConnectorPadding|0}if(h&&h.subtreePadding){this.document.subtreePadding=h.subtreePadding|0}if(h&&h.drawing!==undefined){this.document.set("drawing",h.drawing|0)}if(h&&h.drawingModifiers!==undefined){this.document.set("drawingModifiers",h.drawingModifiers|0)}this.document.geometry=this.document.getGeometryFromOptions(h);if(h&&h.graphViewCtor&&typeof h.graphViewCtor!=="function"){throw new Error("opts.graphViewCtor must be a function")}this.document.addView2("main",new (h&&h.graphViewCtor||g.GraphView)(j),{newNodeView:v("nodeView",g.newNodeView),newGroupView:v("groupView",g.newGroupView),newEdgeView:v("edgeView",g.newEdgeView),newTempNodeView:v("tempNodeView",g.newTempNodeView),newTempGroupView:v("tempGroupView",g.newTempGroupView),newTempEdgeView:v("tempEdgeView",g.newTempEdgeView)});this.sm=new e.StateMachine(this.document.gr,undefined,i,this.document.gr.views.main)};c.defaultAction=function d(){};return c});define("etree/widget",["DS/etree/widget"],function mod(a){return a});define("DS/etree/autogroups",["DS/etree/tree"],function m(j){var u={};u.AutomaticGroups=function p(w){if(typeof w!=="function"){throw new Error("isLeaf must be a function")}this.isLeaf=w;this.enabled=true;this.firstMarkedGroup=null};function c(w){var z,x,y;for(z=w.first;z;z=y){x=z.type===j.Group.Type;y=z.dftNext(w,x);if(!x){continue}while(z.first){z.parent.insertBefore(z.first,z)}z.parent.removeChild(z)}}function s(A,x,w){var B,y,z;for(B=w.first;B;B=y){y=B.dftNext(w,B.type===j.Group.Type);if(x(B)){if(B.prev&&B.parent.type!==j.Document.Type){if(B.prev.type===j.Group.Type){B.prev.insertBefore(B,null)}else{if(x(B.prev)){z=d(A);B.parent.insertBefore(z,B.prev);z.insertBefore(B.prev,null);z.insertBefore(B,null)}}}}}}u.AutomaticGroups.prototype.setEnabled=function f(x,w){x=Boolean(x);if(this.enabled===x){return}this.enabled=x;w.forEach(x?s.bind(undefined,this,this.isLeaf):c)};u.AutomaticGroups.prototype.insertBefore=function t(D,x,z){var y,A,w,E,C,B;if(D.type!==j.Node.Type&&D.type!==j.Document.Type){throw new Error("parent must be an etree Node or Document")}if(x.type!==j.Node.Type){throw new Error("child must be an etree Node")}if(z&&z.type!==j.Node.Type){throw new Error("next must be an etree Node")}if(!this.enabled||D.type===j.Document.Type){D.insertBefore(x,z);return}y=z?z.prev:D.last;if(this.isLeaf(D)){throw new Error("can't add children to a leaf")}if(!this.isLeaf(x)){if(z&&z.parent!==D&&y){A=z.parent;if(A.prev&&A.prev.type===j.Group.Type){w=A.prev}if(A.next&&A.next.type===j.Group.Type){E=A.next}if(!w&&!E){E=d(this);D.insertBefore(E,A.next)}if(w){for(C=A.first;C!==z;C=B){B=C.next;w.insertBefore(C,null)}D.insertBefore(x,A)}else{for(C=A.last;C!==y;C=B){B=C.prev;E.insertBefore(C,E.first)}D.insertBefore(x,A.next)}if(A.first===A.last){A.data.mark(this,2)}}else{if(z&&z.parent!==D){D.insertBefore(x,z.parent)}else{D.insertBefore(x,z)}}}else{if(z&&z.parent!==D){z.parent.insertBefore(x,z)}else{if(y&&y.type===j.Group.Type){y.insertBefore(x,null)}else{if(z&&this.isLeaf(z)){w=d(this);D.insertBefore(w,z);w.insertBefore(x,null);w.insertBefore(z,null)}else{if(y&&this.isLeaf(y)){w=d(this);D.insertBefore(w,y);w.insertBefore(y,null);w.insertBefore(x,null)}else{D.insertBefore(x,z)}}}}}};u.AutomaticGroups.prototype.removeChild=function r(C){var y,w,B,A,x,z;if(C.type!==j.Node.Type){throw new Error("child must be an etree Node")}y=C.parent;if(!this.enabled||y.type===j.Document.Type){y.removeChild(C);return}x=C.next;z=C.prev;if(y.type!==j.Group.Type){w=x&&x.type===j.Group.Type;B=z&&z.type===j.Group.Type;if(w&&B){z.data.mark(this,2);x.data.mark(this,2)}else{if(w){if(z&&this.isLeaf(z)){x.insertBefore(z,x.first)}}else{if(B){if(x&&this.isLeaf(x)){z.insertBefore(x,null)}}else{if(x&&this.isLeaf(x)&&z&&this.isLeaf(z)){A=d(this);A.insertBefore(z,null);A.insertBefore(x,null);y.insertBefore(A,C)}}}}}y.removeChild(C);if(y.type===j.Group.Type&&y.first===y.last){y.data.mark(this,2)}};u.AutomaticGroups.prototype.changeLeaf=function a(y){var x,w;if(y.type!==j.Node.Type){throw new Error("child must be an etree Node")}x=y.parent;if(!x){return}if(x.type===j.Group.Type){x=x.parent}w=y;do{w=w.dftNext(x,w.type!==j.Group.Type||w.parent!==x)}while(w&&w.type===j.Group.Type);this.removeChild(y);this.insertBefore(x,y,w)};u.AutomaticGroups.prototype.update=function v(){var y,x,w;for(y=this.firstMarkedGroup;y;y=y.next){x=y.group;if(x.prev&&x.prev.type===j.Group.Type){j.mergeSiblingGroups(x.prev,!(x.prev.data.flags&1))}}for(y=this.firstMarkedGroup;y;y=y.next){x=y.group;if(x.parent&&x.first===x.last){if(x.first){x.parent.insertBefore(x.first,x)}x.parent.removeChild(x)}}y=this.firstMarkedGroup;this.firstMarkedGroup=null;for(;y;y=w){w=y.next;y.next=null;y.flags=0}};u.convertParent=function q(w){return w.type===j.Group.Type?w.parent:w};u.convertNext=function o(x,w){if(x.type===j.Group.Type){if(!w){w=x.next}}if(w&&w.type===j.Group.Type){w=w.first;if(!w){throw new Error("internal error")}}return w};u.nextNotDragged=function b(x,w){for(;;){if(!w&&x.type===j.Group.Type){w=x.next;x=x.parent}if(!w){break}if(w.type===j.Group.Type){x=w;w=w.first;continue}if(!(w.displayFlags&j.DisplayFlags.DRAGGED)){break}w=w.next}return w};u.convertPrev=function n(w,x){if(w.type===j.Group.Type){if(!x){x=w.prev}}if(x&&x.type===j.Group.Type){x=x.last;if(!x){throw new Error("internal error")}}return x};u.insertPredicate=function i(x,z,w){var y;if(z.type!==j.Node.Type){throw new Error("this predicate must not be called with a group")}y=u.convertPrev(x,w?w.prev:x.last);w=u.convertNext(x,w);x=u.convertParent(x);return z!==w&&z!==y};u.insertPredicate2=function g(z,y){var A,B,w,x;A=u.convertPrev(z,y?y.prev:z.last);y=u.convertNext(z,y);z=u.convertParent(z);B=Boolean(z.displayFlags&j.DisplayFlags.DRAGGED);w=Boolean(y&&y.displayFlags&j.DisplayFlags.DRAGGED);x=Boolean(A&&A.displayFlags&j.DisplayFlags.DRAGGED);return !B&&(x!==w||!w)};var l=0;function k(w){this.id=l++;this.group=w;this.flags=0;this.next=null}k.prototype.mark=function h(x,w){if(!w){throw new Error("internal error")}if(!this.flags){this.next=x.firstMarkedGroup;x.firstMarkedGroup=this}this.flags|=w};k.prototype.toString=function e(){var w;w=[];if(this.flags&1){w.push("new")}if(this.flags&2){w.push("merge/prune")}return"autogroup."+this.id+"["+w.join(", ")+"]"};function d(x){var w;w=new j.Group();w.data=new k(w);w.data.mark(x,1);w.setExpanded(true);return w}u.traceUpdates=false;return u});define("DS/etree/synctree",["DS/etree/tree","DS/Tree/TreeDocument","DS/egraph/utils","DS/etree/autogroups"],function(t,n,F,u){var I={};function l(K){var J;J=K._expandState;return J==="collapseState"||J==="partiallyExpandedState"}function d(K,L){var M,J;M=new t.Node(L);M.setExpanded(l(L));J=K.onnewnode;if(J){J(M,L)}return M}function k(J){if(!J){return String(J)}if(J.data&&J.data.options){return"Node("+J.data.options.label+")"}else{return"Node"}}I.Sync=function y(J,K){if(!(J instanceof t.Document)){throw new Error("document must be an instance of etree/tree.Document")}if(J.onnodedetached){throw new Error("can't register on Document#onnodedetached, already a callback")}this.document=J;this.model=null;this.autogrouping=new u.AutomaticGroups(C);this.autogrouping.setEnabled(false,[]);this.onnewnode=F.function_opt(K,"onnewnode",null);this.document.onnodedetached=G.bind(this);this.lock=0;this.roots=[];this.firstFreeRoot=-1};function B(J){if(I.traceUpdates){if(!J.lock){console.log("sync locks the update")}else{console.log("sync recursive lock, "+J.lock+" already")}}if(!J.lock){J.document.updateLock()}++J.lock}function q(J){--J.lock;if(I.traceUpdates){if(!J.lock){console.log("sync unlocks the update")}else{console.log("sync recursive unlock, "+J.lock+" left")}}if(!J.lock){try{J.autogrouping.update()}finally{J.document.updateUnlock()}}}function s(J,K){B(J);try{return K.apply(J,Array.prototype.slice.call(arguments,2))}finally{q(J)}}function C(J){return J.data.__last_is_leaf_result__=J.data._expandState==="noExpandState"}function H(K,L){var J;if(L.type===t.Document.Type){return}L.data.__last_is_leaf_result__;if(C(L)!==J){K.autogrouping.changeLeaf(L)}}function G(J){if(J.data.__treeGraphRoot__){if(I.traceUpdates){console.log("destroyed root "+k(J))}x(this,J)}if(J.data.__treeGraphNode__===J){J.data.__treeGraphNode__=null}J.data=null}function A(N,M){var L,O,J,K;O=M.data;if(O.__treeGraphRoot__){throw new Error("duplicated root?")}J=O.__treeGraphRoot__=[];L=O._modelEvents;if(N.firstFreeRoot===-1){K=N.roots.length;N.roots.push(M)}else{K=N.firstFreeRoot;N.firstFreeRoot=N.roots[K];N.roots[K]=M}J.push(K);J.push(L.addEventListener("expand",i.bind(N)));J.push(L.addEventListener("collapse",i.bind(N)));J.push(L.addEventListener("expandStateChange",i.bind(N)));J.push(L.addEventListener("addChild",b.bind(N)));J.push(L.addEventListener("removeChild",v.bind(N)));J.push(L.addEventListener("highlight",c.bind(N)));J.push(L.addEventListener("unhighlight",c.bind(N)));J.push(L.addEventListener("select",o.bind(N)));J.push(L.addEventListener("unselect",o.bind(N)));J.push(L.addEventListener("matchSearch",r.bind(N)));J.push(L.addEventListener("unmatchSearch",r.bind(N)));J.push(L.addEventListener("nodeModelUpdate",j.bind(N)));J.push(L.addEventListener("postCollapse",E.bind(N)));J.push(L.addEventListener("postExpand",E.bind(N)));J.push(L.addEventListener("preCollapse",E.bind(N)));J.push(L.addEventListener("preExpand",E.bind(N)))}function x(O,N){var M,P,K,L,J;P=N.data;K=P.__treeGraphRoot__;P.__treeGraphRoot__=null;if(!K){throw new Error("duplicated root?")}L=K[0];if(O.roots[L]!==N){throw new Error("internal error")}O.roots[L]=O.firstFreeRoot;O.firstFreeRoot=L;M=P._modelEvents;for(L=1,J=K.length;L<J;++L){M.unsubscribe(K[L])}}function p(J,K){if(J&&K){J.views.main.onmodifyDisplay(J,{data:{data:{_expandState:K}}})}}function i(J){var K,L;if(!this.lock){return s(this,i,J)}K=J.target;if(I.traceUpdates){console.log(k(K.__treeGraphNode__)+" expand changed to "+K._expandState)}L=K.__treeGraphNode__;L.setExpanded(l(K));L.notifyUpdate("_expandState",null);H(this,L)}function E(J){var L,K;L=J.target;K=L.__treeGraphNode__;if(L._expandState==="expandingState"){if(I.traceUpdates){console.log(k(L.__treeGraphNode__)+" expand changed to "+L._expandState)}p(K.grNode,L._expandState);K.notifyUpdate("_expandState",null)}}function z(K){var J=K.__treeGraphNode__;if(J.type===t.Node.Type&&l(K)!==J.expanded){if(I.traceUpdates){console.log(k(K.__treeGraphNode__)+" expand changed to "+K._expandState+" (change from bypass)")}J.setExpanded(l(K))}if(I.traceUpdates){console.log(k(K.__treeGraphNode__)+" expand may have changed to "+K._expandState)}J.notifyUpdate("_expandState",null)}function b(K){var P,Q,N,S,L,J,M,O,R;if(!this.lock){return s(this,b,K)}P=K.target;Q=P.__treeGraphNode__;N=P.options.children;L=K.data.nodeModel;M=K.data.nodeIndex;if(N[M]!==L){throw new Error('internal error, "addChild" event gave bad index')}O=M+1<N.length?N[M+1]:null;if(O){R=O.__treeGraphNode__;if(!R){throw new Error("internal error, next sibling has no node")}}else{R=null}S=Q.document;H(this,Q);if(J=L.__treeGraphNode__,!J){J=L.__treeGraphNode__=d(this,L);if(I.traceUpdates){console.log("creating "+k(J))}f(this,J,L)}else{if(I.traceUpdates){console.log("replugging root "+k(J))}x(this,J)}if(I.traceUpdates){console.log("++ "+k(J)+" -> "+k(Q)+" before "+k(R))}this.autogrouping.insertBefore(Q,J,R);z(P)}function v(L){var O,N,M,P,J,K;if(!this.lock){return s(this,v,L)}O=L.target;N=O.__treeGraphNode__;M=N.document;P=L.data.nodeModel;J=P.__treeGraphNode__;K=J.prev;if(I.traceUpdates){console.log("-- "+k(J)+" -> "+k(N))}if(!J||!J.parent){return}this.autogrouping.removeChild(J);H(this,N);z(O);if(I.traceUpdates){console.log("new root "+k(J))}A(this,J)}function D(K){return function J(L){var N,M;N=L.target;M=N.__treeGraphNode__;if(!M){return}M.notifyUpdate(K,undefined);if(I.traceUpdates){console.log("onprop "+K+" for node "+k(M))}}}var c=D("_isHighlighted");var o=D("_isSelected");var r=D("_isMatchingSearch");var j=D("options");var h=0;function a(){if(I.traceUpdates){console.log("preupdate")}B(this)}function g(){if(I.traceUpdates){console.log("postupdate")}q(this)}function f(N,O,M){var L,J,K,P,Q;K=M.options.children;if(!K){return}for(L=0,J=K.length;L<J;++L){P=K[L];Q=P.__treeGraphNode__;if(!Q){P.__treeGraphNode__=Q=d(N,P);if(I.traceUpdates){console.log("creating "+k(Q))}f(N,Q,P)}N.autogrouping.insertBefore(O,Q,null)}}I.Sync.prototype.setAutogroups=function e(K){var J;if(!this.lock){return s(this,e,K)}J=this.roots.filter(function L(M){return typeof M==="object"});this.autogrouping.setEnabled(K,J)};I.Sync.prototype.setModel=function w(L){var M,J;if(L===this.model){return}if(L!==null&&!(L instanceof n)){throw new Error("model must be a TreeDocument instance")}if(!this.document.isUpdated()){throw new Error("can't change model while update is locked!")}if(this.model){x(this,this.document);this.document.withLockedUpdate(function K(){this.document.clear();this.autogrouping.update()},this);this.model.__treeDocument__=null;this.model._trueRoot.__treeGraphNode__=null;this.document.data=null}this.model=L;if(this.model){this.document.withLockedUpdate(function K(){this.document.vetoUpdateAnimation();this.document.setFixNode(null);this.model.__treeDocument__=this.document;this.model._trueRoot.__treeGraphNode__=this.document;this.document.data=this.model._trueRoot;f(this,this.document,this.model._trueRoot);M=this.model._trueRoot._modelEvents;A(this,this.document);J=this.model._trueRoot.__treeGraphRoot__;J.push(M.addEventListener("prepareUpdate",a.bind(this)));J.push(M.addEventListener("pushUpdate",g.bind(this)));this.autogrouping.update()},this)}};I.traceUpdates=false;return I});define("etree/synctree",["DS/etree/synctree"],function mod(a){return a});define("DS/etree/overviewui",["DS/egraph/utils","DS/etree/widget","DS/etree/tree","DS/etree/synctree","DS/etree/syncviews","DS/etree/iact","DS/egraph/iact","DS/egraph/views","DS/egraph/overview"],function(g,e,k,a,b,h,i,f,j){var d={};d.EGraphOverviewUI=function c(n,l,p){l.document.addView2("ovr",new j.GraphView(n,l.document.gr.views.main,{hole:{className:"etree-sync-overview-hole"}}),{newNodeView:function o(r){return true},newGroupView:function q(r){return true}});new i.StateMachine(l.document.gr,null,new j.RootState(),l.document.gr.views.ovr)};return d});define("DS/etree/syncwidget",["DS/egraph/utils","DS/etree/widget","DS/etree/tree","DS/etree/synctree","DS/etree/syncviews","DS/etree/iact","DS/egraph/iact","DS/egraph/views","DS/egraph/core","DS/etree/overviewui","DS/etree/autogroups","DS/UIBehaviors/ContextualMenuManager","DS/Menu/Menu","UWA/Class/Promise","i18n!DS/etree/assets/nls/overviewui.json"],function(T,l,Q,j,U,r,J,al,P,g,F,v,C,aw,x){var H={};H.LayoutMode={LAYERED:0,LAYERED_TIDY_1:1};H.ReframeMode={START:1<<0,ALL:1<<1,LIST:1<<2,MAXSCALE:1<<3};H.OrientationMode={ROOT_ON_TOP:0,ROOT_ON_LEFT:1,ROOT_ON_BOTTOM:2,ROOT_ON_RIGHT:3};H.ThumbnailState={COLLAPSED:1,EXPANDED:2};var ac={ZOOM_IN:1,ZOOM_OUT:2,ZOOM_ONE:3,ZOOM_SLIDER:4,ZOOM_FIT:5,ZOOM_MANUAL:6};var A=32;var Z=false;function k(ax){this.sw=ax}k.prototype.isSelected=function aq(ax){return(ax&&this.sw&&this.sw.sync.model&&this.sw.sync.model.getXSO().isIn(ax.data))};k.prototype.getSelection=function ah(){var ax=[];if(this.sw&&this.sw.sync.model){var ay=this.sw.sync.model.getXSO().get();ay.forEach(function(az){ax.push(az.__treeGraphNode__)})}return ax};k.prototype.updateSelection=function ae(ax,ay){throw T.newNotImplError()};function aj(ax){if(ax){if(Array.isArray(ax)){return ax.map(aj)}else{return ax.__treeGraphNode__}}}function s(ax){if(ax){if(Array.isArray(ax)){return ax.map(s)}else{return ax.data}}}function G(aA,az){if(aA){var ay={};if(aA.hasOwnProperty("modifiers")){ay.modifiers=aA.modifiers}if(aA.hasOwnProperty("internal")){ay.internal=aA.internal}if(aA.hasOwnProperty("nodes")){ay.nodes=s(aA.nodes)}if(aA.hasOwnProperty("node")){ay.node=s(aA.node)}if(aA.hasOwnProperty("move")){ay.move=aA.move}if(aA.hasOwnProperty("recenter")){ay.recenter=function ax(aB){aA.recenter(aj(aB))}}if(typeof az==="boolean"){ay.isRoot=Boolean(az)}return ay}}function ad(az,ay,aA){Q.timeit(this,function ax(){if(aA.toggleExpanded){aA.toggleExpanded(az)}})}function ao(az,ay,aA){Q.timeit(this,function ax(){if(aA.moreInfo){aA.moreInfo(az)}})}function ar(ay){this.withLockedUpdate(function ax(){this.setFixNode(ay.data);switch(ay.data._expandState){case"collapseState":case"expandingState":ay.data.collapse();break;case"expandState":case"partiallyExpandedState":ay.data.expand();break}},this)}function B(aB){if(this.onContextualEvent){var aA=aB.grNode.views.main.display.elt.querySelector(".etree-sync-node-moreinfo").getBoundingClientRect();var ax=(aA.left+aA.right)/2;var aC=(aA.top+aA.bottom)/2;var az=this.onContextualEvent.callback.call(this.onContextualEvent["this"],{context:this.onContextualEvent.context,info:{position:{x:ax,y:aC},target:undefined},graphview:{view:this,node:aB.data,moreinfo:true}});if(az){var ay=null;if(az instanceof Promise){ay=az}else{ay=aw.resolve(az)}ay.then(function(aD){if(aD&&aD.length>0){C.show(aD,{position:{x:ax,y:aC}})}})}}else{if(this.moreInfoCallback){var aA=aB.grNode.views.main.display.elt.querySelector(".etree-sync-node-moreinfo").getBoundingClientRect();this.moreInfoCallback(aB.data,[(aA.left+aA.right)/2,(aA.top+aA.bottom)/2])}}}function ab(ay,az){if(this.sync.model){this.withLockedUpdate(function ax(){if(az===r.SelectMode.EMPTY){this.sync.model.getXSO().empty()}else{if(az===r.SelectMode.ADD||(this.allowMultiSelectionInTouch&&az===r.SelectMode.TOUCH)){if(this.sync.model.getXSO().isIn(ay.data)){this.sync.model.getXSO().remove(ay.data)}else{this.sync.model.getXSO().add(ay.data)}}else{this.setFixNode(ay.data);ay.data.select(true)}}},this)}}function W(aA){var az;var ax;az=aA.grView.rectanglePick(aA.x1,aA.y1,aA.x2,aA.y2,aA.pickOpts);this.withLockedUpdate(function ay(){if(this.sync.model){this.sync.model.getXSO().empty();for(ax=0;ax<az.length;ax++){this.sync.model.getXSO().add(az[ax].data.data)}}},this)}function I(ax){var ay=true;var az=s(ax);if(!Array.isArray(az)){az=[az]}if(typeof this.sync.model.options.shouldAcceptMove==="function"){ay=this.sync.model.options.shouldAcceptMove.call(this.sync.model,az)}else{if(!this.widget.sm.rootState.dragMultipleNodes&&az.length===1){ay=this.sync.model.options.shouldAcceptDrag.call(this.sync.model,az[0])}}return ay}function an(az,ax,ay,aA){var aB=true;var aC=s(ax);if(!Array.isArray(aC)){aC=[aC]}if(F.insertPredicate2(az,ay)){ay=F.nextNotDragged(az,ay);az=F.convertParent(az);if(typeof this.sync.model.options.shouldAcceptInsert==="function"){aB=this.sync.model.options.shouldAcceptInsert.call(this.sync.model,aC,s(az),s(ay),G(aA,az instanceof Q.Document))}else{if(!this.widget.sm.rootState.dragMultipleNodes&&aC.length===1){aB=this.sync.model.options.shouldAcceptDrop.call(this.sync.model,{parentTreeNodeModel:s(az),draggedTreeNodeModel:aC[0]})}}}return aB}function p(ax,az,ay,aA){var aB=undefined;var aC=s(ax);if(!Array.isArray(aC)){aC=[aC]}ay=F.nextNotDragged(az,ay);az=F.convertParent(az);if(typeof this.sync.model.options.doInsert==="function"){aB=this.sync.model.options.doInsert.call(this.sync.model,aC,s(az),s(ay),G(aA,az instanceof Q.Document))}else{if(!this.widget.sm.rootState.dragMultipleNodes&&aC.length===1){aB=this.sync.model.options.insert.call(this.sync.model,aC[0],s(az),s(ay))}}return aB}function S(aA,ax,ay){var az=false;if(typeof this.sync.model.options.doDnDDragStart==="function"){az=this.sync.model.options.doDnDDragStart.call(this.sync.model,aA,s(ax),s(ay));if(az&&aA.types.length===0){aA.setData("text","");aA.effectAllowed="move"}}return az}function X(az,ax){var ay=(!(ax.modifiers&J.Modifiers.CTRL||ax.modifiers&J.Modifiers.ALT));if(typeof this.sync.model.options.isDnDMove==="function"){ay=this.sync.model.options.isDnDMove.call(this.sync.model,az,G(ax,undefined))}return ay}function au(aB,ay,ax,az){var aA=false;var aC=s(az.nodes);if(F.insertPredicate2(ay,ax)){ax=F.nextNotDragged(ay,ax);ay=F.convertParent(ay);if(typeof this.sync.model.options.shouldAcceptDnDDrop==="function"){aA=this.sync.model.options.shouldAcceptDnDDrop.call(this.sync.model,aB,s(ay),s(ax),G(az,ay instanceof Q.Document))}else{aA=true}}return aA}function V(aB,ay,ax,az){var aA=false;var aC=s(az.nodes);ax=F.nextNotDragged(ay,ax);ay=F.convertParent(ay);if(typeof this.sync.model.options.doDnDDrop==="function"){aA=this.sync.model.options.doDnDDrop.call(this.sync.model,aB,s(ay),s(ax),G(az,ay instanceof Q.Document))}return aA}function af(ax){if(this.doubleClickCallback){this.doubleClickCallback(ax)}}function L(aP,aU,aV){var aF,aT,aD,aK,aX,aN;var aY,ax,aW,aJ;var ay,aE;var aR,az,aL,aM;var aA,aG;var aS,aQ,aO;var aI;var aH;if(!this.sync.model||!this.widget.document.first||(aP&H.ReframeMode.LIST&&(!aV||aV.length===0))){return}aF=this.widget.document.gr.views.main;if(aF.container.clientWidth<=0||aF.container.clientHeight<=0){return}aD=this.widget.document.nodeWidth;aK=this.widget.document.nodeHeight;aX=this.widget.document.siblingPadding;aY=this.fittingArea.paddingLeft;ax=this.fittingArea.paddingRight;aW=this.fittingArea.paddingTop;aJ=this.fittingArea.paddingBottom;aH=true;ay=aF.container.clientWidth-2*aX-aY-ax;if(ay<=0){ay=aF.container.clientWidth}aE=aF.container.clientHeight-2*aX-aW-aJ;if(aE<=0){aE=aF.container.clientHeight}aR=Infinity;az=-Infinity;aL=Infinity;aM=-Infinity;if(aP&H.ReframeMode.LIST){for(aI=0;aI<aV.length;aI++){aT=aV[aI];if(aT.left<aR){aR=aT.left}if((aT.left+aD)>az){az=aT.left+aD}if(aT.top<aL){aL=aT.top}if((aT.top+aK)>aM){aM=aT.top+aK}}}else{if(aP&H.ReframeMode.START){for(aT=this.widget.document.first;aT;aT=aT.next){if(aT.left<aR){aR=aT.left}if((aT.left+aD)>az){az=aT.left+aD}if(aT.top<aL){aL=aT.top}if((aT.top+aK)>aM){aM=aT.top+aK}}}else{for(aT=this.widget.document.first;aT;aT=aT.dftNext(this.widget.document,!aT.expanded)){if(aT.left<aR){aR=aT.left}if((aT.left+aD)>az){az=aT.left+aD}if(aT.top<aL){aL=aT.top}if((aT.top+aK)>aM){aM=aT.top+aK}}}}aA=az-aR;aG=aM-aL;if(aP&H.ReframeMode.START){aO=1}else{var aC=ay/aA;var aB=aE/aG;aO=(aC<aB?aC:aB)}if(H.ReframeMode.MAXSCALE&&aO>1){aO=1}this.setFixNode(null);if(aP&H.ReframeMode.START){if(this.orientation===H.OrientationMode.ROOT_ON_LEFT||this.orientation===H.OrientationMode.ROOT_ON_RIGHT){if(aG>aE){aH=false}}else{if(aA>ay){aH=false}}}if(aH){if((aP&H.ReframeMode.ALL)||(aP&H.ReframeMode.LIST)){aS=Math.round((ay-aO*(az+aR))*0.5+aX+aY);aQ=Math.round((aE-aO*(aM+aL))*0.5+aX+aW)}else{if(this.orientation===H.OrientationMode.ROOT_ON_LEFT){aS=aX+aY-aR*aO;aQ=Math.round((aE-aO*(aM+aL))*0.5+aX+aW)}else{if(this.orientation===H.OrientationMode.ROOT_ON_RIGHT){aS=aX+aY-az*aO+ay;aQ=Math.round((aE-aO*(aM+aL))*0.5+aX+aW)}else{if(this.orientation===H.OrientationMode.ROOT_ON_TOP){aS=Math.round((ay-aO*(az+aR))*0.5+aX+aY);aQ=aX+aW-aL*aO}else{if(this.orientation===H.OrientationMode.ROOT_ON_BOTTOM){aS=Math.round((ay-aO*(az+aR))*0.5+aX+aY);aQ=aX+aW-aM*aO+aE}}}}}}else{aS=aX+aY-aR;aQ=aX+aW-aL}aF.setViewpoint([aS,aQ,aO],aU)}function h(){var aI,aC,aK,ay;var aD,aL,aG;var ax,aB;var aA,aH,aM,aJ;var aF,aE,az;if(this.sync.model){aL=Infinity;aI=this.widget.document.gr.views.main;aF=aI.vpt[0];aE=aI.vpt[1];az=aI.vpt[2];aK=this.widget.document.nodeWidth;ay=this.widget.document.nodeHeight;ax=aI.container.clientWidth/2;aB=aI.container.clientHeight/2;for(aC=this.widget.document.first;aC&&aC.type===P.Type.NODE;aC=aC.dftNext(this.widget.document,!aC.expanded)){aA=aC.left*az+aF;aH=aA+aK*az;aM=aC.top*az+aE;aJ=aM+ay*az;aG=Math.pow(ax-(aH+aA)/2,2)+Math.pow(aB-(aJ+aM)/2,2);if(aG<aL){aL=aG;aD=aC}}}return aD}function i(az){if(this.onContextualEvent){var ay=this.onContextualEvent.callback.call(this.onContextualEvent["this"],{context:this.onContextualEvent.context,info:{position:{x:az.clientPos[0],y:az.clientPos[1]},target:undefined},graphview:{view:this,node:az.node?az.node.data:null,moreinfo:false}});if(ay){var ax=null;if(ay instanceof Promise){ax=ay}else{ax=aw.resolve(ay)}ax.then(function(aA){if(aA&&aA.length>0){C.show(aA,{position:{x:az.clientPos[0],y:az.clientPos[1]}})}})}}else{if(this.contextCallback){var ay=this.contextCallback(az.node?az.node.data:null);v.show(ay,az.clientPos,az.device==="touch")}}}function b(aC){var aF,ay,aH,aE,aI,ax,aA,az,aB=undefined,aG=undefined;aF=this.widget.document.gr.views.main;ay=aF.container.clientWidth;aH=aF.container.clientHeight;ax=this.overviewPanel.querySelector(".zoomslider input");az=this.widget.document.gr;if(az.zoomOpts){if(az.zoomOpts.min&&!isNaN(az.zoomOpts.min)){aB=az.zoomOpts.min}if(az.zoomOpts.max&&!isNaN(az.zoomOpts.max)){aG=az.zoomOpts.max}}aA=[aB,aG,Number(ax.step)];switch(aC){case ac.ZOOM_OUT:Z=true;aF.zoominc(-1*Number(ax.step)/0.5,aF.domRoot.clientWidth/2,aF.domRoot.clientHeight/2,aA);ax.value=Math.log(aF.vpt[2])/Math.log(2);break;case ac.ZOOM_IN:Z=true;aF.zoominc(1*Number(ax.step)/0.5,aF.domRoot.clientWidth/2,aF.domRoot.clientHeight/2,aA);ax.value=Math.log(aF.vpt[2])/Math.log(2);break;case ac.ZOOM_ONE:Z=true;aF.zoomone();ax.value=0;break;case ac.ZOOM_FIT:Z=true;this.reframeAll();ax.value=Math.log(aF.vpt[2])/Math.log(2);break;case ac.ZOOM_SLIDER:Z=true;var aD=T.calculateNewScale(1,Number(ax.value),aA);aE=T.changeViewpointScale(aF.vpt,aD,[ay/2,aH/2],false);aF.setViewpoint(aE,true);break;case ac.ZOOM_MANUAL:if(!Z){ax.value=Math.log(aF.vpt[2])/Math.log(2)}Z=false;break}}H.SyncEGraphTree=function a(ay,aB){var aE=0;if(aB&&typeof aB.orientation==="number"){this.orientation=aB.orientation;switch(aB.orientation){case H.OrientationMode.ROOT_ON_TOP:aE=0;break;case H.OrientationMode.ROOT_ON_LEFT:aE=Q.DrawingModifiers.HORIZONTAL;break;case H.OrientationMode.ROOT_ON_BOTTOM:aE=Q.DrawingModifiers.MIRROR_DEPTH|Q.DrawingModifiers.MIRROR_SIBLINGS;break;case H.OrientationMode.ROOT_ON_RIGHT:aE=Q.DrawingModifiers.HORIZONTAL|Q.DrawingModifiers.MIRROR_DEPTH|Q.DrawingModifiers.MIRROR_SIBLINGS;break;default:throw new Error("Orientation must be a valid OrientationMode value.");break}}else{this.orientation=H.OrientationMode.ROOT_ON_TOP}this.setFittingArea(aB?aB.fittingArea:undefined);this.container=document.createElement("div");this.container.className="etree-sync-container";if(aB&&aB.moreInfoCallback){this.container.classList.add("etree-sync-container-enable-moreinfo");this.moreInfoCallback=aB.moreInfoCallback}if(aB&&aB.onContextualEvent){this.container.classList.add("etree-sync-container-enable-moreinfo");this.onContextualEvent=aB.onContextualEvent}if(aB&&aB.doubleClickCallback){this.doubleClickCallback=aB.doubleClickCallback}this.container.innerHTML=['<div class="etree-sync-tree-container"></div>','<div class="etree-sync-overview-panel">','  <div class="etree-sync-overview-container"></div>','  <div class="etree-sync-overview-toolbar">','    <div class="etree-sync-overview-icon zoomout"></div>','    <div class="etree-sync-overview-icon zoomfit"></div>','    <div class="etree-sync-overview-icon zoomone"></div>','    <div class="etree-sync-overview-icon zoomin"></div>','    <div class="etree-sync-overview-slider zoomslider">','      <input type="range" min="-3" max="3" step="0.1" value="0">',"    </div>","  </div>",'  <div class="etree-sync-overview-expander"></div>',"</div>"].join("\n");ay.appendChild(this.container);this.treeContainer=this.container.querySelector(".etree-sync-tree-container");this.overviewPanel=this.container.querySelector(".etree-sync-overview-panel");this.overviewContainer=this.container.querySelector(".etree-sync-overview-container");if(aB&&aB.contextCallback){this.contextCallback=aB.contextCallback}var aA;if(aB&&aB.nodeView){aA=aB.nodeView}else{aA=U}this.widget=new l.EGraphTree(this.treeContainer,{nodeWidth:150,nodeHeight:114,rowPadding:40,siblingPadding:30,newNodeView:aA.newNodeView,newEdgeView:aA.newEdgeView,newGroupView:aA.newGroupView,newTempNodeView:aA.newTempNodeView,newTempEdgeView:aA.newTempEdgeView,newTempGroupView:aA.newTempGroupView,overrideAllActions:true,selectionModel:new k(this),buttons:{"collapse-expand":ad,moreinfo:ao},actions:{toggleExpanded:ar.bind(this),select:ab.bind(this),insert:p.bind(this),moreInfo:B.bind(this)},movePredicate:I.bind(this),insertPredicate:an.bind(this),dnd_dragStart:S.bind(this),dnd_isMove:X.bind(this),dnd_dropPredicate:au.bind(this),dnd_drop:V.bind(this),doubleClickOnNode:this.doubleClickCallback?af.bind(this):undefined,extendLastRow:true,drawingModifiers:aE,oncontext:((this.contextCallback||this.onContextualEvent)?i.bind(this):undefined),edges:{type:"rounded-square",offset:-8},ignoreGroups:true,pickGroupChildren:true});this.sync=new j.Sync(this.widget.document);this.sync.onnewnode=function ax(aG,aF){if(typeof aF._thumbnailState==="number"){if(aF._thumbnailState===H.ThumbnailState.EXPANDED){aG.setHeight(NaN,0)}else{if(aF._thumbnailState===H.ThumbnailState.COLLAPSED){aG.setHeight(A)}}}else{if(typeof this._defaultThumbnailState==="number"){if(this._defaultThumbnailState===H.ThumbnailState.EXPANDED){aG.setHeight(NaN,0)}else{if(this._defaultThumbnailState===H.ThumbnailState.COLLAPSED){aG.setHeight(A)}}}}}.bind(this);this.overviewPanel.querySelector(".zoomout").addEventListener("click",b.bind(this,ac.ZOOM_OUT));this.overviewPanel.querySelector(".zoomout").setAttribute("title",x.zoom_out);this.overviewPanel.querySelector(".zoomin").addEventListener("click",b.bind(this,ac.ZOOM_IN));this.overviewPanel.querySelector(".zoomin").setAttribute("title",x.zoom_in);this.overviewPanel.querySelector(".zoomone").addEventListener("click",b.bind(this,ac.ZOOM_ONE));this.overviewPanel.querySelector(".zoomone").setAttribute("title",x.zoom_default);this.overviewPanel.querySelector(".zoomfit").addEventListener("click",b.bind(this,ac.ZOOM_FIT));this.overviewPanel.querySelector(".zoomfit").setAttribute("title",x.zoom_fit);this.overviewPanel.querySelector(".zoomslider input").addEventListener("input",b.bind(this,ac.ZOOM_SLIDER));this.overviewPanel.querySelector(".zoomslider input").addEventListener("change",b.bind(this,ac.ZOOM_SLIDER));this.widget.document.gr.views.main.addListener("viewpoint",b.bind(this,ac.ZOOM_MANUAL));if(aB&&typeof aB.layout==="number"){this.setLayout(aB.layout)}var aC=this.treeContainer.firstChild;aC.setAttribute("tabindex","0");document.body.addEventListener("blur",function(aF){setTimeout(function(){var aI=document.activeElement;if(aI){var aG=T.hasClass(aI,"wux-afr-actionbar")?aI:T.firstParentWithClass(aI,"wux-afr-actionbar");var aH=T.hasClass(aI,"egraph_views_domroot")?aI:T.firstParentWithClass(aI,"egraph_views_domroot");if(aH&&!aG){az()}else{if(!aH&&!aG){aD()}}}},1)},true);aC.addEventListener("focus",function(aF){az()});function az(){aC.classList.add("wux-ui-state-focused")}function aD(){aC.classList.remove("wux-ui-state-focused")}};H.SyncEGraphTree.prototype.setModel=function e(ax){this.sync.setModel(ax);if(this.sync.model){L.call(this,H.ReframeMode.START|H.ReframeMode.MAXSCALE,false)}};H.SyncEGraphTree.prototype.getModel=function K(){return this.sync.model};H.SyncEGraphTree.prototype.reframeAll=function c(){L.call(this,H.ReframeMode.ALL|H.ReframeMode.MAXSCALE,true)};H.SyncEGraphTree.prototype.reframeOn=function n(){if(this.sync.model){var ax=[];var ay=this.sync.model.getXSO().get();ay.forEach(function(az){if(az.__treeGraphNode__){ax.push(az.__treeGraphNode__)}});L.call(this,H.ReframeMode.LIST|H.ReframeMode.MAXSCALE,true,ax)}};H.SyncEGraphTree.prototype.swapLayoutOrientation=function O(){var ay=h.call(this);if(ay){this.setFixNode(ay.data)}var ax=this.widget.document.drawingModifiers;if(ax&Q.DrawingModifiers.HORIZONTAL){ax&=~Q.DrawingModifiers.HORIZONTAL}else{ax|=Q.DrawingModifiers.HORIZONTAL}this.widget.document.setDrawing(undefined,ax)};H.SyncEGraphTree.prototype.setRootPosition=function q(ax){var ay=h.call(this);if(ay){this.setFixNode(ay.data)}var az=undefined;switch(ax){case H.OrientationMode.ROOT_ON_TOP:az=0;break;case H.OrientationMode.ROOT_ON_LEFT:az=Q.DrawingModifiers.HORIZONTAL;break;case H.OrientationMode.ROOT_ON_BOTTOM:az=Q.DrawingModifiers.MIRROR_DEPTH|Q.DrawingModifiers.MIRROR_SIBLINGS;break;case H.OrientationMode.ROOT_ON_RIGHT:az=Q.DrawingModifiers.HORIZONTAL|Q.DrawingModifiers.MIRROR_DEPTH|Q.DrawingModifiers.MIRROR_SIBLINGS;break}this.widget.document.setDrawing(undefined,az);this.orientation=ax};H.SyncEGraphTree.prototype.createOverview=function Y(ax){this.overviewPanel.style.display="block";this.overview=new g.EGraphOverviewUI(this.overviewContainer,this.widget,{})};H.SyncEGraphTree.prototype.swapOverviewVisibility=function ag(){if(this.overviewPanel.style.display==="block"){this.overviewPanel.style.display="none"}else{this.overviewPanel.style.display="block"}};H.SyncEGraphTree.prototype.selectArea=function z(){var ay=this;this.widget.sm.setState(new J.RectSelectionWaitPt1({overlay:new al.RectangleOverlay(this.widget.sm.graphView,{background:{className:"etree-area-selection-cursor"},rectangle:{className:"etree-area-selection-rectangle"}}),applycb:function ax(){W.call(ay,this)}}))};H.SyncEGraphTree.prototype.setFixNode=function E(ay,ax){if(!ay){this.widget.document.setFixNode(null,ax)}else{if(ay.__treeGraphNode__){this.widget.document.setFixNode(ay.__treeGraphNode__,ax)}else{if(ay.group){this.widget.document.setFixNode(ay.group.first.data.__treeGraphNode__,ax)}else{throw new Error("node must be a Node")}}}};H.SyncEGraphTree.prototype.setSize=function at(ay,ax){this.widget.document.gr.views.main.setSize(ay,ax)};H.SyncEGraphTree.prototype.getViewport=function N(){var aD=this.widget.document.getBounds();if(!aD.isValid()){return null}var aE=this.widget.document.gr.views.main;var aC=aE.vpt[0];var aB=aE.vpt[1];var az=aE.vpt[2];var ax=0;var aJ=0;var aI=aE.getSize()[0];var aG=aE.getSize()[1];var aA=(ax-aC)/az;var ay=(aJ-aB)/az;var aH=(aI-aC)/az;var aF=(aG-aB)/az;return[aA-aD.xmin,ay-aD.ymin,aH-aD.xmax,aF-aD.ymax]};H.SyncEGraphTree.prototype.setViewport=function u(aN){var aO=this.widget.document.getBounds();if(!aO.isValid()){return null}var az=this.widget.document.gr.views.main;var aK=0;var aJ=0;var aC=az.getSize()[0];var aB=az.getSize()[1];var aI=(aK+aC)/2;var aH=(aJ+aB)/2;var aQ=aO.xmin+aN[0];var aP=aO.ymin+aN[1];var ay=aO.xmax+aN[2];var ax=aO.ymax+aN[3];var aE=(aQ+ay)/2;var aD=(aP+ax)/2;var aG=(aK-aC)/(aQ-ay);var aF=(aJ-aB)/(aP-ax);if(aG<=0){aG=aF}var aA=(aG<aF?aG:aF);if(aA<=0){aA=1}var aM=aI-aE*aA;var aL=aH-aD*aA;az.setViewpoint([aM,aL,aA],false)};H.SyncEGraphTree.prototype.setFittingArea=function d(ax){if(!this.fittingArea||!ax){this.fittingArea={paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0}}if(ax){if(typeof(ax.paddingLeft)==="number"){this.fittingArea.paddingLeft=ax.paddingLeft}if(typeof(ax.paddingRight)==="number"){this.fittingArea.paddingRight=ax.paddingRight}if(typeof(ax.paddingTop)==="number"){this.fittingArea.paddingTop=ax.paddingTop}if(typeof(ax.paddingBottom)==="number"){this.fittingArea.paddingBottom=ax.paddingBottom}}};H.SyncEGraphTree.prototype.setLayout=function av(ay){if(ay!==H.LayoutMode.LAYERED&&ay!==H.LayoutMode.LAYERED_TIDY_1){throw new Error("unexpected layout value")}var ax=h.call(this);if(ax){this.setFixNode(ax.data)}if(ay===H.LayoutMode.LAYERED){this.widget.document.setDrawing(Q.Drawing.LAYERED)}else{if(ay===H.LayoutMode.LAYERED_TIDY_1){this.widget.document.setDrawing(Q.Drawing.LAYERED_TIDY_1)}}};H.SyncEGraphTree.prototype.getThumbnailState=function t(ax){if(!ax||!ax.__treeGraphNode__){throw new Error("can't get thumbnail state when node is invalid")}if(isNaN(ax.__treeGraphNode__.height)){return H.ThumbnailState.EXPANDED}else{return H.ThumbnailState.COLLAPSED}};H.SyncEGraphTree.prototype.setAllThumbnailsState=function y(ax){if(ax!==H.ThumbnailState.EXPANDED&&ax!==H.ThumbnailState.COLLAPSED){throw new Error("Invalid thumbnail state, must be either ThumbnailState.EXPANDED or ThumbnailState.COLLAPSED.")}this.widget.document.withLockedUpdate(function ay(){var az;this._defaultThumbnailState=ax;for(az=this.widget.document.first;az;az=az.dftNext(this.widget.document)){if(az.type!==Q.Group.Type){this.setThumbnailState(az.data,ax)}}},this)};H.SyncEGraphTree.prototype.setThumbnailState=function D(ay,az){if(!ay||!ay.__treeGraphNode__){throw new Error("Invalid node")}if(az!==H.ThumbnailState.EXPANDED&&az!==H.ThumbnailState.COLLAPSED){throw new Error("Invalid thumbnail state, must be either ThumbnailState.EXPANDED or ThumbnailState.COLLAPSED.")}this.widget.document.withLockedUpdate(function ax(){var aA;ay._thumbnailState=az;if(az===H.ThumbnailState.EXPANDED){aA=NaN}else{aA=A}ay.__treeGraphNode__.setHeight(aA,this.widget.document.animationDuration)},this)};H.SyncEGraphTree.prototype.swapThumbnailState=function am(ax){if(this.getThumbnailState(ax)===H.ThumbnailState.EXPANDED){this.setThumbnailState(ax,H.ThumbnailState.COLLAPSED)}else{this.setThumbnailState(ax,H.ThumbnailState.EXPANDED)}};H.SyncEGraphTree.prototype.setAutogroups=function f(ay){var ax=h.call(this);if(ax){this.setFixNode(ax.data)}this.sync.setAutogroups(ay)};H.SyncEGraphTree.prototype.expandAll=function o(ax){var az;if(!ax){for(az=this.widget.document.first;az;az=az.next){this.expandAll(az.data)}}else{this.withLockedUpdate(function ay(){this.setFixNode(ax);ax.prepareUpdate();ax.expandAll();ax.pushUpdate()},this)}};H.SyncEGraphTree.prototype.setMultiSelectionInTouch=function ai(ax){this.allowMultiSelectionInTouch=Boolean(ax)};H.SyncEGraphTree.prototype.setMultiSelectionDrag=function w(ax){if(this.widget){this.widget.sm.rootState.dragMultipleNodes=Boolean(ax)}};H.SyncEGraphTree.prototype.setHTML5DnD=function M(ax){if(this.widget){this.widget.sm.rootState.dnd_enabled=Boolean(ax)}};H.SyncEGraphTree.prototype.updateLock=function aa(){if(!this.sync.model){throw new Error("can't lock when no model is set")}this.sync.model.prepareUpdate()};H.SyncEGraphTree.prototype.updateUnlock=function ap(){if(!this.sync.model){throw new Error("can't unlock when no model is set")}this.sync.model.pushUpdate()};H.SyncEGraphTree.prototype.withLockedUpdate=function R(ay,ax){this.updateLock();try{return ay.call(ax)}finally{this.updateUnlock()}};H.insertPredicate=function ak(ay,ax){console.log("ouing");return F.insertPredicate2(aj(ay),aj(ax))};return H});