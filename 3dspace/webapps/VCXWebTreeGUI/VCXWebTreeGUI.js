define("DS/VCXWebTreeGUI/VCXWebTreeNodeView",["DS/Tree/TreeNodeView","DS/Core/PointerEvents"],function(d,b){function c(g,f){var e=g;if(e){var h=(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" "+f+" ")>-1;if(h){return e}else{return c(e.parentNode,f)}}else{return}}var a=d.extend({init:function(e){this._parent(e)},updateInternalParameters:function(){this._parent();var n=this.getCellInfos();var m=n.cellView.getContent();if(!n.isHeader){var i="vcxPreHighlighted";var k="vcxPreHighlightedHidden";if(n.nodeModel.options.hasOwnProperty("isPreHighlighted")){if(n.nodeModel.options.isPreHighlighted===1){if(!m.hasClassName(i)){m.addClassName(i)}if(m.hasClassName(k)){m.removeClassName(k)}}else{if(n.nodeModel.options.isPreHighlighted===2){if(!m.hasClassName(k)){m.addClassName(k)}if(m.hasClassName(i)){m.removeClassName(i)}}else{if(m.hasClassName(i)){m.removeClassName(i)}if(m.hasClassName(k)){m.removeClassName(k)}}}}if(n.nodeModel.options.hasOwnProperty("selectionSetRole")){var h="vcxSelSet";var e="vcxSelSetActor";if(n.nodeModel.options.selectionSetRole===1){if(!m.hasClassName(h)){m.addClassName(h)}if(m.hasClassName(e)){m.removeClassName(e)}}if(n.nodeModel.options.selectionSetRole===2){if(!m.hasClassName(e)){m.addClassName(e)}if(m.hasClassName(h)){m.removeClassName(h)}}}if(n.nodeModel.options.hasOwnProperty("hotspotRole")){var g="vcxHotspot";var f="vcxHotspotActor";if(n.nodeModel.options.hotspotRole===1){if(!m.hasClassName(g)){m.addClassName(g)}if(m.hasClassName(f)){m.removeClassName(f)}}if(n.nodeModel.options.hotspotRole===2){if(!m.hasClassName(f)){m.addClassName(f)}if(m.hasClassName(g)){m.removeClassName(g)}}}var j="sceneVisibility";if(n.nodeModel.options.hasOwnProperty("visibilityState")){var l=n.nodeModel.options.visibilityState;typeof n.nodeModel.options.visibilityState==="string"&&m.setAttribute(j,l)}else{if(m.hasAttribute(j)){m.removeAttribute(j)}}}},_observeEvents:function(){var k=this;var e=0;var g;var h=300;this.elements.container.addEvent(b.POINTERUP,function l(n){if(g!==undefined){clearTimeout(g)}g=setTimeout(function(){e=0},h);e++;if(n.which===1){if(e===1||b.touchFlag()&&n.detail===0){k.getGridEngine()._modelEvents.publish({event:"nodeclick",data:k.getCellInfos()})}if(e===2){k.getGridEngine()._modelEvents.publish({event:"nodeDblClick",data:k.getCellInfos()})}}});var m=0;var i;function f(v){var n=null;if(v&&(v.changedTouches&&v.changedTouches.length===1||v.button===0)){var w=v.target;if(w&&w.hasClassName("nodeTouchZone")){n=w}else{w=w.children[0];if(w&&w.hasClassName&&w.hasClassName("nodeTouchZone")){n=w}}}var t=k.getGridEngine().options.selection.canMultiSelect&&(v.ctrlKey||k.getGridEngine().isInMultiSelection()||n);var o=k.getGridEngine().options.selection.canMultiSelect&&v.shiftKey&&k.getGridEngine().options.selection.enableListSelection;if(v.which===1){if(!v.target.classList.contains("wux-layouts-treeview-expander")&&!c(v.target,"wux-controls-toggle")){var y=k.getCellInfos();if(i!==undefined){clearTimeout(i)}i=setTimeout(function(){m=0},h);m++;var r=k.getGridEngine();var x=r.getDocument();if(y.isHeader===false&&r.options.selection.cells===false){var p=y.nodeModel;if(m===1){if(r.options.selection.nodes){if(r.options.selection.toggle){if(p.isSelected()){k.__unselectNode(p)}else{k.__selectNode(p,!t)}}else{if(p.getTreeDocument().getXSO().get().length>1&&!t&&!o&&!p.getTreeDocument().getXSO().isIn(p)){k.__selectNode(p,!t)}else{if(r.getNodesXSO().get().length>1&&!t&&p.getTreeDocument().getXSO().isIn(p)){if(!r._modeIsListSel){k.__selectNode(p,!t)}}else{if(o){var q=x.getXSO().get();var s;if(q.length===0){s=x.getChildren()[0]}else{if(r._getParent().options.enableActiveUI===true){s=r.getActiveNode()===q[q.length-1]?q[0]:r.getActiveNode()}else{s=q[0]}}var u=p;console.warn("select from",s._getRowID(),"to",u._getRowID());if(s._getRowID()<u._getRowID()){x.withTransactionUpdate(function(){x.getXSO().empty();for(var A=s._getRowID();A<=u._getRowID();A++){var z=r.getTreeNodeModelFromRowID(A);k.__selectNode(z,false)}})}else{x.withTransactionUpdate(function(){x.getXSO().empty();for(var A=s._getRowID();A>=u._getRowID();A--){var z=r.getTreeNodeModelFromRowID(A);k.__selectNode(z,false)}})}}else{if(p.isSelected()){if(t){k._unselectOnPointerUp=true;k.__unselectNode(p)}else{k._unselectOnPointerUp=false;if(p.getTreeDocument().getXSO().get().length===0){k.__selectNode(p)}}}else{k.__selectNode(p,!t)}}}}}}}}}}}this.elements.container.addEvent("mousedown",f);this.elements.container.addEvent("touchstart",f);function j(n){n.stopPropagation();if(n.type==="touchend"){n.preventDefault()}k.getGridEngine()._giveFocus();if(n.which===1||n.type==="touchend"){var o=k._cellModel.getCellContent();if(o.getChildren()){if(k._expandState!=="noExpandState"&&k._expandState!=="expandingState"){if(o.isExpanded()&&o._expandState!=="partiallyExpandedState"){o.collapse()}else{k._setExpanderState("expandingState");o.expand()}}}}}this.elements.expanderContainer.addEvent("mouseup",j);this.elements.expanderContainer.addEvent("touchend",j)}});return a});define("DS/VCXWebTreeGUI/VCXITreeNode",["DS/WebComponentModeler/CATWebInterface"],function(b){var a=b.singleton({interfaceName:"VCXITreeNode",required:{SetVisibility:function(){},GetVisibility:function(){},GetName:function(){},GetParent:function(){},GetChildren:function(){}},optional:{}});return a});define("DS/VCXWebTreeGUI/VCXWebTabFrameCtrl",["UWA/Class","UWA/Core","DS/VCXWebGUI/VCXTabPageFrame",],function(a,d,b){var c=a.extend({init:function(e){this._experienceBase=e;this._vcxGuiManager=this._experienceBase.getManager("VCXGUIManager")},createTabFrameAndSlidingViews:function(f){if(!(f&&f.sidePanelInfos&&f.slidingViewsTitles&&f.slidingViewsContainerIDs)){console.warn("Unable to create tabFrame...");return}this.panelCreationOptions=f;this.options={};if(this._vcxGuiManager.immersiveFrame){this.options.immersiveFrame=this._vcxGuiManager.immersiveFrame}this.options._uiLayer=this._vcxGuiManager._uiLayer;this.options.classBaseNameCSS=f.sidePanelInfos.classBaseNameCSS;this.options.appID=f.appID;this.options.sidePanel={title:f.sidePanelInfos.title,icon:f.sidePanelInfos.icon,side:f.sidePanelInfos.side,controller:this,usecallback:this.onresizePanel,currentDockArea:f.sidePanelInfos.dockArea};this.options.slidingViews={displayTabAtStart:f.slidingViewToDisplayAtStart,disableSlindingMenu:f.disableSlindingMenu,_vcxuiSequencesMaster:{},};this.options.slidingViews.views=[];for(var e=0;e<f.slidingViewsTitles.length;++e){var g=new d.Element("div",{id:f.slidingViewsContainerIDs[e],});this.options.slidingViews._vcxuiSequencesMaster[e+1]={};this.options.slidingViews._vcxuiSequencesMaster[e+1][f.slidingViewsTitles[e]]=g;this.options.slidingViews.views.push({title:f.slidingViewsTitles[e],content:{html:this.options.slidingViews._vcxuiSequencesMaster[1][f.slidingViewsTitles[e]],}})}this.options._experienceBase=this._experienceBase;this.options._nlsPath="VCXWebTreeGUI/VCXWebTreeGUI";this._tabPageFrame=new b(this.options);this.onCreateToolBarButtons();this.updateToolbar()},unInitialize:function(){this.getFrame().unInitialize()},onresizePanel:function(e){e.updateToolbar()},getFrame:function(){return this._tabPageFrame},updateToolbar:function(){this.getFrame().getToolbar().updateToolbar()},onCreateToolBarButtons:function(){var g=this.getFrame().getToolbar();if(this._selectLeavesFromSelectedNodes){var f=[];f[0]=this;f[1]=this._selectLeavesFromSelectedNodes;g.addMainItemFixed(f,"",["vcxToolbarButton","vcxTreeToolbarButtonSelectLeaves-1","vcxTreeToolbarButtonSelectLeaves-2"],"VCXWebTreeGUI/VCXWebTreeGUI",null,"VCXTreeToolbarSelectLeaves")}if(this._collapseAll){var h=[];h[0]=this;h[1]=this._collapseAll;g.addMainItemFixed(h,"",["vcxToolbarButton","vcxTreeToolbarButtonCollapseAll-1","vcxTreeToolbarButtonCollapseAll-2"],"VCXWebTreeGUI/VCXWebTreeGUI",null,"VCXTreeToolbarCollapseAll")}if(this._changeSelectionVisibility){var e=[];e[0]=this;e[1]=this._changeSelectionVisibility;g.addMainItemFixed(e,"","vcxToolbarButton wux-ui-3ds-eye","VCXWebTreeGUI/VCXWebTreeGUI",null,"VCXTreeToolbarChgSelectionVis")}},_getCurrentViewTreeCtrl:function(){var g=null;var f={Assembly:{1:this._vcxGuiManager._vcxWebAssemblyTreeCtrl,2:this._vcxGuiManager._vcxWebSelectionSetsTreeCtrl,3:this._vcxGuiManager._vcxWebHotspotsTreeCtrl},Design:{1:this._vcxGuiManager._vcxWebDressupTreeCtrl}};var e=this.getFrame()&&this.getFrame().options.sidePanel.title;if(e){if(f[e]){var h=this.getFrame()._slidingViews.getCurrentViewID();return f[e][h]}else{return null}}else{return null}},_collapseAll:function(){var e=this._getCurrentViewTreeCtrl();if(!e){console.warn("No tree found to collapse the nodes. Command aborted.");return}if(e._expandUntilNVisibleNodes){var g=5;var f=e.tree.getManager()._numberOfVisibleNodesInDocument;if(f>g){e.tree.getDocument().collapseAll();e._expandUntilNVisibleNodes(g)}}else{e.tree.getDocument().collapseAll()}},_changeSelectionVisibility:function(){var g=this._getCurrentViewTreeCtrl();if(!g){console.warn("No tree found to change selection visibility. Command aborted.");return}var l=g.tree.getDocument().getXSO().get();if(l.length===0){return}var f;for(var h=0;h<l.length;++h){var k=l[h];var i=g._getTreeNodeExtensionFromTreeNodeModel(k);if(!i){continue}var e=i.GetVisibility();if(e===g.EVisibilityState.Indeterminate){f===g.EVisibilityState.Indeterminate;break}f=(typeof f==="undefined"||e===f)?e:-1}var j=(f===g.EVisibilityState.Hidden)?g.EVisibilityState.Visible:g.EVisibilityState.Hidden;g.tree.getDocument().withTransactionUpdate(function(){var m=(j===g.EVisibilityState.Hidden)?"hidden":"visible";for(var n=0;n<l.length;++n){var q=l[n];var o=g._getTreeNodeExtensionFromTreeNodeModel(q);var p=o&&o.SetVisibility(j);if(p){q.options.visibilityState=m}}});g.tree.getManager().updateView()},});return c});define("DS/VCXWebTreeGUI/VCXWebDressupTabFrameCtrl",["DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils"],function(b,a){var c=b.extend({init:function(d){this._parent(d);var e={iconName:"drawing",fontIconFamily:WUXManagedFontIcons.Font3DS};var f={sidePanelInfos:{classBaseNameCSS:"vcx-dressuptree-",title:"Design",icon:e,side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Design"],slidingViewsContainerIDs:["dressupTreeContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:1,};this.createTabFrameAndSlidingViews(f)},});return c});define("DS/VCXWebTreeGUI/VCXWebAssemblyTabFrameCtrl",["DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils"],function(a,c,b){var d=c.extend({init:function(m){this._parent(m);var l=1;var h=m.getManager("VCXContextManager");if(h&&h.getOpenSMG()){l=0}var e={iconName:"3dpart",fontIconFamily:WUXManagedFontIcons.Font3DS};var j={sidePanelInfos:{classBaseNameCSS:"vcx-assemblytree-",title:"Assembly",icon:e,side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Assembly","SelectionSets","Hotspots"],slidingViewsContainerIDs:["AssemblyContainer","SelectionSetsAssemblyContainer","HotspotsAssemblyContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:l};var k=this._experienceBase.getManager("VCXNLSManager");var f=this._experienceBase.getManager("VCXContextManager");var g=f.getCityMode();if(g){j.disableSlindingMenu=1;j.appID="CID"}var i=k.GetNLS(["VCXWebTreeGUI/VCXWebTreeGUI"]);if(i){j.slidingViewsTitles=[i.getTitle({key:f.getCityMode()?"CIDAssembly.PanelTitle":"VCXAssembly.PanelTitle",}),i.getTitle({key:"SelectionSets",}),i.getTitle({key:"Hotspots",})]}this.createTabFrameAndSlidingViews(j)},_selectLeavesFromSelectedNodes:function(){var m=this._getCurrentViewTreeCtrl();if(!m){console.warn("No tree found to collapse the nodes. Command aborted.");return}var k=m.tree.getDocument().getSelectedNodes();var h=[];for(var g=0;g<k.length;++g){var o=m._getTreeNodeExtensionFromTreeNodeModel(k[g]);o&&h.push(o)}var l=this._traverseForTreeNodeExtLeaves(h);var j=[];var n=[];for(var e=0;e<l.length;++e){var i=l[e].GetObject();n.push(i)}var f=new a(this._experienceBase.getManager("VCXSelectionManager"));f.SetComponentsSelection(n);this._experienceBase.getManager("VCXCommandManager").Do(f)},_traverseForTreeNodeExtLeaves:function(f){var l=0;var k=[];var e=[];for(var g=0;g<f.length;++g){var i=f[g];var m=i.GetChildren();if(m.length===0){k.push(i)}else{for(l=0;l<m.length;++l){e.push(m[l])}}}if(e.length!==0){var h=[];for(l=0;l<e.length;++l){h.push(e[l])}var j=this._traverseForTreeNodeExtLeaves(h);k=k.concat(j)}return k}});return d});define("DS/VCXWebTreeGUI/VCXWebStylesTabFrameCtrl",["DS/VCXWebTreeGUI/VCXWebTabFrameCtrl","DS/WebappsUtils/WebappsUtils"],function(c,b){var a=c.extend({init:function(d){this._parent(d);var e={sidePanelInfos:{classBaseNameCSS:"vcx-stylestree-",title:"Styles",icon:b.getWebappsAssetUrl("VCXWebTreeGUI","icons/32/I_VCX_Tree_Dressup_TabIcon.png"),side:"left",dockArea:WUXDockAreaEnum.LeftDockArea},slidingViewsTitles:["Styles"],slidingViewsContainerIDs:["stylesTreeContainer"],slidingViewToDisplayAtStart:1,disableSlindingMenu:1,};this.createTabFrameAndSlidingViews(e)},});return a});define("DS/VCXWebTreeGUI/VCXWebTreeCtrl",["UWA/Core","UWA/Class","UWA/Utils/Client","DS/Core/Core","DS/CoreEvents/Events","DS/Core/PointerEvents","DS/Tree/Tree","DS/Tree/TreeDocument","DS/Tree/TreeNodeView","DS/Tree/TreeNodeModel","DS/Utilities/Array","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebModifiablesServices/VCXModifiablesAccess","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebTreeGUI/VCXWebTreeNodeView"],function(g,b,l,j,d,h,e,a,n,f,p,k,o,i,m){var c=b.extend({init:function(q){this._experienceBase=q;this._vcxGuiManager=q.getManager("VCXGUIManager");this._multiSelBeforeForcing=null;this._eventTokens={};this._tabFrameCtrl=null;this._slidingViewIndex=-1;this._newSelection=null;this._newSelectionDoneWorkers=0},setTabFrameCtrl:function(q){this._tabFrameCtrl=q},getTabFrameCtrl:function(){return this._tabFrameCtrl},setSlidingViewIndex:function(q){this._slidingViewIndex=q},getSlidingViewIndex:function(){return this._slidingViewIndex},getTreeTitle:function(){},createTree:function(){var z=this;var D={useAsyncPreExpand:true,cellClass:m,shouldBeEditable:function(){return false},shouldAcceptDrag:function(){return false},shouldAcceptDrop:function(){return false},onPreExpandCB:this._onPreExpandCB.bind(this),selection:{rowHeaders:false,columnHeaders:false,unselectAllOnEmptyArea:true,enableListSelection:true,toggle:false,preSelection:true},onCellClickCB:this._toggleEyeIconOnClick,onCellRequests:{visibilityIcon:this._onVisibilityIconRequest,}};var y=new a({useAsyncPreExpand:D.useAsyncPreExpand,shouldBeEditable:D.shouldBeEditable,shouldAcceptDrag:D.shouldAcceptDrag,shouldAcceptDrop:D.shouldAcceptDrop});typeof D.onPreExpandCB==="function"&&y.onPreExpand(D.onPreExpandCB);var C=[this._getTouchSelectionBarTreeColInfos(),this._getTreeMainColInfos(D),this._getVisIconColInfos(D)];this.tree=new e({treeDocument:y,height:"auto",defaultCellHeight:35,apiVersion:2,cellClass:D.cellClass,selection:D.selection,columns:C});this.tree.getManager().onCellClick(D.onCellClickCB);this.tree.getContent().addClassName("composer-treeview-theme");if(this.getTreeTitle()){this.tree.getContent().addClassName("composer-"+this.getTreeTitle().replace(/\s+/g,"").toLowerCase()+"-treeview-theme")}this._setTreeRootsAndFirstNodes&&this._setTreeRootsAndFirstNodes();this._setCustomEvtsSubscriptions&&this._setCustomEvtsSubscriptions();this.tree.getDocument().getXSO().onEmpty(function(){z.tree.getDocument().prepareUpdate();if(z._experienceBase.getManager("VCXSelectionManager").HasActors()){var E=new k(z._experienceBase.getManager("VCXSelectionManager"));E.SetSelection();z._experienceBase.getManager("VCXCommandManager").Do(E)}z.tree.getDocument().pushUpdate()});var A=function(E){return E&&(E.changedTouches&&E.changedTouches.length===1||E.button===0)};var B=null;var r=function r(F){if(A(F)){B={initialPointerDownCoordinates:null,firstTreeCellDSViewTouched:null,lastTreeCellDSViewTouched:null,xsoHasBeenEmptied:false,multiSelBeforeForcing:null};var G;if(F.changedTouches&&F.changedTouches[0]){G={x:F.changedTouches[0].clientX,y:F.changedTouches[0].clientY}}else{G={x:F.clientX,y:F.clientY}}B.initialPointerDownCoordinates=G;var I=F.target;var H=null;if(I&&I.hasClassName("nodeTouchZone")){H=I}else{I=I.children[0];if(I&&I.hasClassName&&I.hasClassName("nodeTouchZone")){H=I}}if(H){if(typeof z._multiSelBeforeForcing!=="boolean"){z._multiSelBeforeForcing=z.tree.getManager()._modeIsMultiSel;z.tree.getManager().forceMultiSelection(true)}z.tree.getDocument().prepareUpdate();if(z.tree.getContent().contains(H)){var E=H;while(E!==z.tree.getContent()&&!E.classList.contains("wux-datagrid-cell")){E=E.parentElement}if(E!==z.tree.getContent()&&E.dsView){B.firstTreeCellDSViewTouched=E.dsView;document.body.addEventListener(h.POINTERMOVE,s,false);document.body.addEventListener(h.POINTERUP,q,false)}}}}};var s=function s(R){if(A(R)){var H;if(R.changedTouches&&R.changedTouches[0]){H={x:R.changedTouches[0].clientX,y:R.changedTouches[0].clientY}}else{H={x:R.clientX,y:R.clientY}}var M=document.elementFromPoint(H.x,H.y);var T;if(z.tree.getContent().contains(M)){T=M;while(T!==z.tree.getContent()&&!T.classList.contains("wux-datagrid-cell")){T=T.parentElement}if(!T){return}}else{return}if(T!==z.tree.getContent()&&T.dsView){var Q=T.dsView.getCellInfos();if(B.lastTreeCellDSViewTouched&&B.lastTreeCellDSViewTouched.getCellInfos().rowID!==Q.rowID){var I=B.lastTreeCellDSViewTouched.getCellInfos();var J=I.view;if(!B.xsoHasBeenEmptied){z.tree.getDocument().withTransactionUpdate(function(){var U=z.tree.getManager().getTreeNodeModelFromRowID(I.rowID);z.tree.getDocument().unselectAll();U.selectionChangeIsFromUI();U.select()});B.xsoHasBeenEmptied=true}var N=(B.initialPointerDownCoordinates.y<J.getBoundingClientRect().bottom&&J.getBoundingClientRect().bottom<=H.y)||(B.initialPointerDownCoordinates.y>J.getBoundingClientRect().top&&J.getBoundingClientRect().top>=H.y);var E=I.rowID;var S=Q.rowID;var L=B.firstTreeCellDSViewTouched.getCellInfos();var P=L.rowID;var G=0;var O=null;var F=(S<E)?-1:1;if(!N){var K=(F===-1)?Math.max(P,S):Math.min(P,S);for(G=E;F*(K-G)>0;G=G+F){O=z.tree.getManager().getTreeNodeModelFromRowID(G);if(!O){continue}O.selectionChangeIsFromUI();O&&O.unselect&&O.unselect()}}for(G=P;F*(S-G)>=0;G=G+F){O=z.tree.getManager().getTreeNodeModelFromRowID(G);if(O&&!O.isSelected()&&O.select){O.selectionChangeIsFromUI();O.select()}}}B.lastTreeCellDSViewTouched=T.dsView}}};var q=function q(){if(z._multiSelBeforeForcing!==null){z.tree.getManager().forceMultiSelection(z._multiSelBeforeForcing);z._multiSelBeforeForcing=null}B=null;z.tree.getDocument().pushUpdate();document.body.removeEventListener(h.POINTERMOVE,s,false);document.body.removeEventListener(h.POINTERUP,q,false)};this.tree.getContent().addEventListener(h.POINTERDOWN,r,false);this._eventTokens._evtSelectionEmptyToken=d.subscribe({event:"VCX_SELECTION_EMPTY"},function u(){z.tree.getManager().unselectAll()});this._eventTokens._evtPreHLEmptyToken=d.subscribe({event:"VCX_PREHIGHLIGHT_EMPTY"},function x(){var E=z.tree.getDocument().getAllDescendants();z.tree.getDocument().getPXSO().empty();p.optimizedForEach(E,function(F){z._switchTreeNodePreHighlight(F,false)})});this._eventTokens._evtPreHLRemoveToken=d.subscribe({event:"VCX_PREHIGHLIGHT_REMOVE"},function v(G){if(!z.isThisTreeInView()){return}if(G&&Array.isArray(G)){for(var F=0;F<G.length;++F){var E=G[F]&&G[F].pathElement;E&&z._removePreHLFromPathElement(E)}}});this._eventTokens._evtPreHLAddToken=d.subscribe({event:"VCX_PREHIGHLIGHT_ADD"},function t(G){if(!z.isThisTreeInView()){return}if(G&&Array.isArray(G)){for(var F=0;F<G.length;++F){var E=G[F]&&G[F].pathElement;E&&z._addPreHLFromPathElement(E)}}});var w=function w(J,I){var K=J&&z._getTreeNodeExtensionFromTreeNodeModel(J);var G=K&&K.QueryInterface("W3AISGNodeHolder");var H=G&&G.getPathElement();if(H){var E={pathElement:H};var F=j.Selection.PSOManager.isIn(E);if(H.getLength()===1&&H.getLastElement()===z._experienceBase.getManager("VCXContextManager").getRootNode()){}else{if(!F&&I){j.Selection.PSOManager.add(E)}else{if(F&&!I){j.Selection.PSOManager.remove(E)}}}}z.tree.getManager().updateView()};this.tree.getDocument().getPXSO().onAdd(function(E){w(E,true)});this.tree.getDocument().getPXSO().onRemove(function(E){w(E,false)});this._eventTokens._evtOnChgSelAddToken=d.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_ADD"},function(E){z._onChangeSelectionCB(E,true)});this._eventTokens._evtOnChangeSelRemoveToken=d.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE"},function(E){z._onChangeSelectionCB(E,false)});this._eventTokens._evtOnChangePropertiesToken=d.subscribe({event:"VCX_PROPERTIES_CHANGED"},function(H){if(!(H&&H.GetListModifiables)){return}var J=[];H.GetListModifiables(J);for(var F=0;F<J.length;++F){var K=J[F];var I=K&&H.GetPropertySet(K);var G=I&&I.GetProperty("Actor.Name");if(G){var E=G.GetPropertyValue().GetValue();z._updateTreeNodeNameFromHashing(K,E)}}});return this.tree},unInitialize:function(){for(var s in this._eventTokens){if(this._eventTokens.hasOwnProperty(s)&&this._eventTokens[s]){d.unsubscribe(this._eventTokens[s])}}if(this.tree){var r=this.tree.getDocument();if(r._cleanBindingOnDocument){r._cleanBindingOnDocument()}else{if(r._cleanBindings){r._cleanBindings()}}var q=r.getRoots();this._deleteChildrenAndSelves(q);r.empty();var t=this.tree.getManager();t.unloadDocument();this.tree.destroy();r.options=r.defaultOptions;t.options=t.defaultOptions;this.tree.options=this.tree.defaultOptions;this.tree=null}this._experienceBase=null;this._vcxGuiManager=null;this._eventTokens={};this._tabFrameCtrl=null;this._newSelection=null},_deleteChildrenAndSelves:function(q){for(var t=0;t<q.length;++t){var r=q[t];var s=r.getChildren();if(s&&s.length>0){this._deleteChildrenAndSelves(s);r.removeChildren()}r.options=r.defaultOptions}},isThisTreeInView:function(){var r=this.getTabFrameCtrl();var q=r&&r._getCurrentViewTreeCtrl();return q?(q===this):false},expandTreeWithComponent:function(q){var s=this;if(!q){console.log("A component is needed in argument of this method..");return}var r=q.QueryInterface("VCXITreeNode");if(!r){console.log("Couldn't fetch treeNode extension");return}this.tree.getDocument().withTransactionUpdate(function(){s._revExpandFromTreeNodeExt(r)})},selectTreeNodesFromComponentList:function(s){var v=this;this.tree.getDocument().withTransactionUpdate(function(){for(var w=0;w<s.length;++w){var x=s[w];v.expandTreeWithComponent(x)}});var t=[];for(var q=0;q<s.length;++q){var r=s[q].QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(v._type);for(var u=0;u<r.length;++u){if(r[u]&&!v.tree.getDocument().getXSO().isIn(r[u])){t.push(r[u])}}}this.tree.getDocument().withTransactionUpdate(function(){while(t.length!==0){var w=t.pop();w.select()}})},unselectTreeNodesFromComponentList:function(q){var r=this;this.tree.getDocument().withTransactionUpdate(function(){for(var t=0;t<q.length;++t){var v=q[t];if(!r.isComponentMatchingThisTree(v)){continue}var s=v.QueryInterface("VCXITreeNode");var u=s&&s.GetTreeNodesModelsFromTree(r._type);if(!Array.isArray(u)){continue}for(var w=0;w<u.length;++w){if(u[w]&&r.tree.getDocument().getXSO().isIn(u[w])){u[w].unselect()}}}})},_createTreeNodeModel:function(w,A,y,s,t){if(!w){console.warn("A VCXTreeNode extension is necessary as parameter of this method");return}var q=A;var z=w.QueryInterface("VCXIModifiable");if(z){var r=z.GetProperty("Actor.Name");if(r){q=r.GetPropertyValue().GetValue()}}var x=new f({label:q,children:y?[]:null,data:{vcxTreeNode:w}});w.SetNewTreeNodeModel(x,this._type);w.getTreeNodeComponentIcon();var u=s?s:this._onSelectionEvtOnTreeNodeCB;x.onSelect(u.call(this));var v=t?t:this._onSelectionEvtOnTreeNodeCB;x.onUnselect(v.call(this));return x},_destroyTreeNodeModel:function(r){var q=this._getTreeNodeExtensionFromTreeNodeModel(r);q.UnsetTreeNodeModel(r,this._type);r.remove()},_revExpandFromTreeNodeExt:function(w){var u=w.GetTreeNodesModelsFromTree(this._type);if(u.length!==0){for(var x=0;x<u.length;++x){if(!u[x].isVisible()){u[x].reverseExpand()}}return}var v=[];var r=w;while(r&&!r.hasTreeNodeModels(this._type)){r=r.GetParent();if(!r){return}v.push(r)}while(v.length!==0){var q=v.pop();var s=q.GetTreeNodesModelsFromTree(this._type);for(var t=0;t<s.length;++t){if(!s[t].isExpanded()){s[t].expand()}}}},_getParentTreeNodeModelFromTreeNodeExt:function(t,r){var s=t.GetParent();if(!s){console.log("Couldn't find treeNode extension for component parent...");return}var q=s.GetTreeNodesModelsFromTree(this._type);if(q.length===0&&r===true){var u=this._getParentTreeNodeModelFromTreeNodeExt(s,true);if(!u){console.log("Couldn't find a parent treeNodeModel in the tree "+this._type+" for the component :",s.GetObject());return}u.expand();q=s.GetTreeNodesModelsFromTree(this._type)}if(q.length>1){return}return q[0]},_addTreeNodesFromComponentsList:function(q){this._modifyTreeNodesFromComponentsList(q,true)},_removeTreeNodesFromComponentsList:function(q){this._modifyTreeNodesFromComponentsList(q,false)},_modifyTreeNodesFromComponentsList:function(q,s){if(typeof s!=="boolean"){return}var t=this;var r=s?this._addTreeNodeFromComponent:this._removeTreeNodeFromComponent;this.tree.getDocument().withTransactionUpdate(function(){for(var u=0;u<q.length;++u){var v=q[u];if(t.isComponentMatchingThisTree(v)){r.call(t,v)}}})},_addTreeNodeFromComponent:function(q){var w=q&&q.QueryInterface("VCXITreeNode");if(!w){console.warn("The component must have a treeNode interface. Abort addition of treeNode in tree.");return}var u=w.GetParent();if(!u){console.warn("The component parent must have a treeNode interface.\nAbort addition of treeNode in tree.");return}var s=q.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type);if(s.length>0&&this._uniqueTreeNodePerComponent){console.log("TreeNodeModels should be unique per component in this tree, and there's already"+s.length+"treenodes here.\nAddition of treeNode aborted.:",q);return}var r=this._getParentTreeNodeModelFromTreeNodeExt(w,true);if(!r){return}if(!Array.isArray(r.options.children)){r.updateOptions({children:[]})}if(!r.isVisible()){r.reverseExpand()}r.expand();var s=q.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type);var v=s[0];if(s.length===1&&(this._uniqueTreeNodePerComponent||v.getParent()===r)){return}if(v&&v.getParent()===r){return}else{var t=this._createTreeNodeModel(w,w.GetName(),w.GetChildren().length>0);r.addChild(t)}},_removeTreeNodeFromComponent:function(q){var u=null;var r=q.QueryInterface("VCXITreeNode").GetTreeNodesModelsFromTree(this._type);if(r.length===0){return}else{if(r.length>1&&this._uniqueTreeNodePerComponent){console.log("TreeNodeModels should be unique per component in this tree. Before removal, there are "+r.length+" treeNodes for the component:",q)}}var s={};while(r.length!==0){var t=r.pop();this._destroyTreeNodeModel(t)}},_onSelectionEvtOnTreeNodeCB:function(){var q=this;return function(s){var r=s.target;var u=r.isSelectionChangeFromUI();var t=s.event;q._checkForSelectionParentAuto(t,r);if(!u){return}q._selectComponent(t,r)}},_selectComponent:function(w,r){var q=(w==="select")?"add":(w==="unselect")?"remove":"";var s=this._experienceBase.getManager("VCXSelectManager");var v=s&&s.isEventCallbackBlocked&&s.isEventCallbackBlocked(q,"SELECTION");if(v){return}var t=this._getTreeNodeExtensionFromTreeNodeModel(r);var u=t&&t.GetObject();if(!u){console.warn("Component associated to specified selectedTreeNodeModel couldn't be found...");return}if(w==="select"){this._addTreeNodeCompToSelection(u)}else{if(w==="unselect"){this._removeTreeNodeCompFromSelection(u)}}},_areChildrenAllSelected:function(q){var s=q&&q.getChildren();var t=s&&s.length>0?true:false;for(var r=0;r<s.length&&t;++r){t=t&&s[r].isSelected()}return t},_checkForSelectionParentAuto:function(r,s){var q=(r==="select");var u=!s.isRoot()&&s.getParent();if(!u){return}var x=this._getTreeNodeExtensionFromTreeNodeModel(u);var v=x&&x.QueryInterface("VCXIModifiable");var w=x&&x.QueryInterface("VCXISelectBehavior");if(!w||w.GetSelectMode()!==1){return}var t=u.isSelected();if(q){t=!t;t=t&&this._areChildrenAllSelected(u)}if(t){u[r]();this._checkForSelectionParentAuto(r,u)}},_addTreeNodeCompToSelection:function(q){var r=this._experienceBase.getManager("VCXSelectionManager");var s=q.QueryInterface("VCXIModifiable");if(s||!r.isIn(q)){var t=new k(r);if(this.tree.getDocument().getXSO().get().length===1&&!this.tree.getManager().isInMultiSelection()){t.SetSelection(q)}else{t.AddToSelection(q)}this._experienceBase.getManager("VCXCommandManager").Do(t)}},_removeTreeNodeCompFromSelection:function(q){var r=this._experienceBase.getManager("VCXSelectionManager");var s=q.QueryInterface("VCXIModifiable");if(s||r.isIn(q)){var t=new k(r);t.RemoveFromSelection(q);this._experienceBase.getManager("VCXCommandManager").Do(t)}},_switchTreeNodePreHighlight:function(t,r,q){var s=!r?0:q?2:1;t.options.isPreHighlighted!==s&&t.updateOptions({isPreHighlighted:s})},_updateTreeNodeNameFromHashing:function(q,w){var x=this._experienceBase.getManager("VCXScenarioManager").ModifiableServer;var s=x&&x.GetModifiableFromHashing(q);var r=s&&s.QueryInterface("VCXITreeNode");var t=r&&r.GetTreeNodesModelsFromTree();if(Array.isArray(t)){for(var v=0;v<t.length;++v){var u=t[v];u&&u.updateOptions({label:w})}}},_getFirstVisibleTreeNodesFromComponent:function(x){var s=this._type,w={visible:{},hiding:{}};var t=x.QueryInterface("VCXITreeNode");var v=t&&t.GetTreeNodesModelsFromTree(s);if(!Array.isArray(v)){console.warn("Something's wrong with the recovery of treeNode extension or treeNodesModels...");return}if(s==="VCXWebAssemblyTreeCtrl"||s==="VCXWebDressupTreeCtrl"){if(v.length===1&&v[0].isVisible()){w.visible[v[0]._getID()]=v[0];return w}var z=x.QueryInterface("VCXIModelNavigable");if(z.getParent()){while(x&&Array.isArray(v)&&v.length!==1&&z){z=z.getParent();x=z&&z.GetObject();t=x&&x.QueryInterface("VCXITreeNode");v=t&&t.GetTreeNodesModelsFromTree(this._type)}}if(!x){console.log("No component ancestor has been found..");return}if(v.length!==1){console.warn("Something's wrong with the recovery of a treeNodeModel within AssemblyTree. There should be only one instead of "+v.length+".");return}var u=v[0];while(u&&!u.isVisible()){var A=this._getTreeNodeExtensionFromTreeNodeModel(u);var q=A&&A.GetParent();v=q.GetTreeNodesModelsFromTree(this._type);if(!Array.isArray(v)||v.length!==1){console.warn("There should be only one treeNodeModel per component within dressups and assembly trees")}u=q&&q.GetTreeNodesModelsFromTree(this._type)[0]}if(!u){console.warn("_getFirstVisibleTreeNodesFromComponent: Something has gone wrong, no treeNode ancestor of the component treeNode has been found.");return}w.hiding[u._getID()]=u;return w}else{if(v.length>this.tree.getRoots().length){console.log("There shouldn't be more treeNodeModel associated to the component than the number of roots.");return}for(var y=0;y<v.length;++y){var r=v[y];if(r.isVisible()){w.visible[r._getID()]=r}else{if(!w.hiding[r._getID()]){w.hiding[r._getID()]=r}}}return w}},_switchPreHLFromPathElement:function(r,s){var v=o.BuildCleanedPathElement(r);var q=this._experienceBase.ComponentsMap.GetComponentFromPathElement(v);if(!q||!this.isComponentMatchingThisTree(q)){return}var t=this._getFirstVisibleTreeNodesFromComponent(q);if(!t){return}var u="";for(u in t.visible){this._switchTreeNodePreHighlight(t.visible[u],s,false);if(t.visible.hasOwnProperty(u)){if(s){t.visible[u].preSelect()}else{t.visible[u].unPreSelect()}}}for(u in t.hiding){if(t.hiding.hasOwnProperty(u)){this._switchTreeNodePreHighlight(t.hiding[u],s,true)}}},_addPreHLFromPathElement:function(q){this._switchPreHLFromPathElement(q,true)},_removePreHLFromPathElement:function(q){this._switchPreHLFromPathElement(q,false)},_onChangeSelectionCB:function(s,t){var w,u;if(t){w="select";u=this.selectTreeNodesFromComponentList}else{w="unselect";u=this.unselectTreeNodesFromComponentList}if(!this.isThisTreeInView()){return}if(!(Array.isArray(s)&&s.length>0&&s[0].GetType)){console.log("Current event should have an array of components as 'componentsList' parameter.");return}var v=[];for(var q=0;q<s.length;++q){var r=s[q];if(r&&this.isComponentMatchingThisTree(r)){v.push(r)}}if(v.length!==0){u.call(this,v)}},_getTouchSelectionBarTreeColInfos:function(){var s=this;var q=this._experienceBase.getManager("VCXContextManager").isTouchCompliantDevice()?20:15;var r={dataIndex:"touchSelectionBar",width:q,isColumnDraggable:false,onCellRequest:function(t){s._onTouchSelectionBarCellRequest(t)}};return r},_getTreeMainColInfos:function(q){var s=this;var r={dataIndex:"tree",onCellRequest:function(w){if(w.virtualRowID>-1){var u=w.cellView;if(w.nodeModel!==""){if(l.Engine.ie&&window.__karma__===undefined){w.cellView.elements.layout.appendChild(w.cellView.elements.linksContainer);w.cellView.elements.expanderContainer.inject(w.cellView.elements.nodeContainer);w.cellView.elements.iconsContainer.inject(w.cellView.elements.nodeContainer);w.cellView.elements.badgeTopRight.inject(w.cellView.elements.iconsContainer);w.cellView.elements.badgeTopLeft.inject(w.cellView.elements.iconsContainer);w.cellView.elements.badgeBottomRight.inject(w.cellView.elements.iconsContainer);w.cellView.elements.badgeBottomLeft.inject(w.cellView.elements.iconsContainer);w.cellView.elements.labelContainer.inject(w.cellView.elements.nodeContainer);w.cellView.elements.layout.appendChild(w.cellView.elements.nodeContainer)}u.getContent().setAttribute("title",w.nodeModel.getLabel());u.setLabel(w.nodeModel.getLabel());u.setIcons(w.nodeModel.getIcons());u.setBadges(w.nodeModel.options.badges);u._setExpanderState(w.nodeModel._expandState);u._setDepth(w.nodeModel._nodeDepth);w.cellView.elements.container.setContent(w.cellView.elements.layout);var v=s._getTreeNodeExtensionFromTreeNodeModel(w.nodeModel);var t=v&&v.GetObject();var x=t&&t.GetID();w.cellView.elements.expanderContainer.setAttribute("data-rec-id","expander_"+x);w.cellView.elements.iconsContainer.setAttribute("data-rec-id","icon_"+x);w.cellView.elements.labelContainer.setAttribute("data-rec-id","label_"+x)}}q.onCellRequests.tree&&q.onCellRequests.tree(w)}};return r},_getVisIconColInfos:function(r){var q={text:"visibilityIcon",dataIndex:"visibilityIcon",width:32,isColumnDraggable:false,onCellRequest:r.onCellRequests.visibilityIcon};return q},_onPreExpandCB:function(v){var q=v.target;var x=this._getTreeNodeExtensionFromTreeNodeModel(q);if(!x){console.warn("Something's wrong: there should be a treeNodeExtension associated with the treeNodeModel: "+q);q.preExpandDone();return}if(q.hasChildren()||x.GetChildren().length===0){q.preExpandDone();return}var u=x.GetChildren();var y=[];for(var s=0;s<u.length;++s){var r=u[s];if(!this.isComponentMatchingThisTree(r.GetObject())){continue}if(!r){console.log("VCXITreeNode extension missing...");continue}var t=r.GetChildren();var w=this._createTreeNodeModel(r,r.GetName(),t.length!==0);y.push(w)}q.addChild(y);q.preExpandDone()},_onTouchSelectionBarCellRequest:function(w){var t=w.cellView.getContent();if(this._experienceBase===null){return}var q=this._experienceBase.getManager("VCXContextManager").isTouchCompliantDevice()?20:15;var s=t.getBoundingClientRect();var v={width:s.width===100?q:s.width,height:s.height};var r=g.createElement("div",{"class":"nodeTouchZone",styles:{position:"absolute",top:"0px",left:"0px",width:2*v.width+"px",height:v.height+"px",marginLeft:-Math.floor(v.width/2)+"px"}});r.inject(t);var x=this;var u=function u(){if(typeof x._multiSelBeforeForcing!=="boolean"){x._multiSelBeforeForcing=x.tree.getManager()._modeIsMultiSel;x.tree.getManager().forceMultiSelection(true)}var y=function y(z){if(z.type==="touchend"){z.preventDefault()}if(typeof x._multiSelBeforeForcing==="boolean"){x.tree.getManager().forceMultiSelection(x._multiSelBeforeForcing);x._multiSelBeforeForcing=null}document.removeEventListener(h.POINTERUP,y,false)};document.addEventListener(h.POINTERUP,y,false)};r.addEventListener(h.POINTERDOWN,u,false)},});c.prototype._getTreeNodeExtensionFromTreeNodeModel=function(q){return q&&q.options&&q.options.data&&q.options.data.vcxTreeNode};c.prototype._onVisibilityIconRequest=function(t){if(!t.isHeader){var q=t.nodeModel;var r=c.prototype._getTreeNodeExtensionFromTreeNodeModel(q);if(r){var s=r.GetVisibility();if(s===1||s===-1){if(q.options.visibilityState!=="visible"){q.options.visibilityState="visible"}}else{if(s===0){if(q.options.visibilityState!=="hidden"){q.options.visibilityState="hidden"}}else{}}}}};c.prototype._toggleEyeIconOnClick=function(v){if(v.dataIndex!=="visibilityIcon"){return}var r=v.model.options.manager.getTreeNodeModelFromRowID(v.model.getRowID());var t=c.prototype._getTreeNodeExtensionFromTreeNodeModel(r);if(t){var q=t.GetVisibility();var w=q===0?1:0;var u=t.SetVisibility(w);if(u){var s=w?"visible":"hidden";r.updateOptions({visibilityState:s})}}},c.prototype.EVisibilityState={Indeterminate:-1,Hidden:0,Visible:1,Ghost:2};return c});define("DS/VCXWebTreeGUI/VCXWebAssemblyTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(a,d,c){var b=c.extend({init:function(e){this._parent(e);this._type="VCXWebAssemblyTreeCtrl";this._uniqueTreeNodePerComponent=true},getTreeTitle:function(){return"Assembly"},_setTreeRootsAndFirstNodes:function(){var h=this._experienceBase.getManager("VCXContextManager").getRootComponent();var e=h.QueryInterface("VCXITreeNode");var g=h.QueryInterface("VCXIModelNavigable");if(!e||!g){console.warn("Experience component need at least a navigable and a treeNode interfaces.");return}var f="Root";var l=h.QueryInterface("VCXIModifiable");if(l){var i=l.GetProperty("Actor.Name");if(i){f=i.GetPropertyValue().GetValue()}}var k=g.getChildren().length>0;var j=this._createTreeNodeModel(e,f,k);this.tree.getDocument().addRoot(j);if(k){this._expandUntilNVisibleNodes(5)}},_setCustomEvtsSubscriptions:function(){var e=this;this._eventTokens._evtOnAddAssetToken=a.subscribe({event:"VCX_ASSETS_ADDED"},function(f){if(Array.isArray(f)){e._addTreeNodesFromComponentsList(f)}else{console.log("VCX_ASSETS_ADDED event data has been changed...")}});this._eventTokens._evtOnRemoveAssetToken=a.subscribe({event:"VCX_ASSETS_REMOVED"},function(f){if(Array.isArray(f)){e._removeTreeNodesFromComponentsList(f)}else{console.log("VCX_ASSETS_REMOVED event data has been changed...")}})},_expandUntilNVisibleNodes:function(j,l){var h=null;var m=[];if(l){h=[l]}else{var f=this.tree&&this.tree.getDocument().getRoots();if(!f||Array.isArray(f)&&f.length===0){return}for(var k=0,i=f.length;k<i;++k){f[k].isVisible()&&m.push(f[k])}h=f}while(m.length<j&&Array.isArray(h)&&h.length!==0){var g=[];for(var e=0;e<h.length;++e){if(!h[e].isExpanded()){h[e].expand()}var n=h[e].getChildren();if(!Array.isArray(n)){continue}m=m.concat(n);g=g.concat(n)}h=g.slice()}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentOccurrenceComposer")||e.IsKindOf("CIDComponentItem")||e.IsKindOf("Abstract3DExperienceObject_Spec")}});b.prototype._onVisibilityIconRequest=function(f){var e=f.nodeModel;if(e.isRoot()){return}c.prototype._onVisibilityIconRequest(f)};b.prototype._toggleEyeIconOnClick=function(f){if(f.dataIndex!=="visibilityIcon"){return}var e=f.model.options.manager.getTreeNodeModelFromRowID(f.model.getRowID());if(e.isRoot()){return}c.prototype._toggleEyeIconOnClick(f)};return b});define("DS/VCXWebTreeGUI/VCXWebDressupTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(a,d,c){var b=c.extend({init:function(e){this._parent(e);this._type="VCXWebDressupTreeCtrl";this._uniqueTreeNodePerComponent=true;this._hideEmptyDrspGrps=false},getTreeTitle:function(){return"Design"},_setTreeRootsAndFirstNodes:function(){var l=this.tree.getDocument();var j=this._getDressupRoot();var k=j.QueryInterface("VCXIModelNavigable");var h=k&&k.getChildren();for(var g=0;g<h.length;++g){var i=h[g];var f=i.QueryInterface("VCXITreeNode");var e=i.getChildren();var m=this._createTreeNodeModel(f,f.GetName(),e.length!==0);l.addRoot(m)}},_setCustomEvtsSubscriptions:function(){var g=this;this._eventTokens._evtDressupsAddedToken=a.subscribe({event:"VCX_DRESSUPS_ADDED"},function f(h){g._addTreeNodesFromComponentsList(h)});this._eventTokens._evtDressupsRemovedToken=a.subscribe({event:"VCX_DRESSUPS_PREREMOVED"},function e(h){g._removeTreeNodesFromComponentsList(h)})},_getDressupRoot:function(){return this._experienceBase.getManager("VCXDressupManager")},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentDressupGrp")||e.IsKindOf("VCXComponentDressup")}});return b});define("DS/VCXWebTreeGUI/VCXWebHotspotsTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(a,d,c){var b=c.extend({init:function(e){this._parent(e);this._type="VCXWebHotspotsTreeCtrl";this._uniqueTreeNodePerComponent=false},getTreeTitle:function(){return"Hotspots"},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGroupHotspot");this._addTreeNodesFromComponentsList(e,true);var g=[];var h=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentHotspot");for(var f=0;f<h.length;f++){if(h[f].GroupID){}else{g.push(h[f])}}if(g.length){this._addTreeNodesFromComponentsList(g,true)}},_setCustomEvtsSubscriptions:function(){var g=this;this._eventTokens._evtHotspotsAddedToken=a.subscribe({event:"VCX_HOTSPOTS_ADDED"},function f(h){g._addTreeNodesFromComponentsList(h)});this._eventTokens._evtHotspotsRemovedToken=a.subscribe({event:"VCX_HOTSPOTS_REMOVED"},function e(h){g._removeTreeNodesFromComponentsList(h)})},_addTreeNodeFromComponent:function(m,f){var j=this.tree.getDocument();var l=m&&m.QueryInterface("VCXITreeNode");if(!l){console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.");return}var k=this._createTreeNodeModel(l,l.GetName(),l.GetChildren().length>0,this._onSelectHotspotTreeNodeCB,this._onUnSelectHotspotTreeNodeCB);k.updateOptions({hotspotRole:1});if(f){f.addChild(k)}else{j.addChild(k)}var n=l.GetChildren();var g=l.GetObject().GetType();if(g==="VCXComponentGroupHotspot"){for(var h=0;h<n.length;++h){var e=n[h];if(!e){console.log("VCXITreeNode extension missing...");continue}var p=e.GetObject();this._addTreeNodeFromComponent(p,k)}return}var i=[];for(var h=0;h<n.length;++h){var e=n[h];if(!e){console.log("VCXITreeNode extension missing...");continue}var o=this._createTreeNodeModel(e,e.GetName(),false);o.updateOptions({hotspotRole:2});i.push(o)}k.addChild(i)},_onSelectHotspotTreeNodeCB:function(){return this._toggleHotspotActivationOnSelection(true)},_onUnSelectHotspotTreeNodeCB:function(){return this._toggleHotspotActivationOnSelection(false)},_toggleHotspotActivationOnSelection:function(e){var f=this;return function(i){var j=f._getTreeNodeExtensionFromTreeNodeModel(i.target);if(!j){return}var g=j.GetObject();var l=j.QueryInterface("VCXIModifiable");var k=f._experienceBase.getManager("VCXAPIManager");var h=e?k.SelectHotspot:k.DeselectHotspot;h.call(k,g.GetID());g.selected=true}},_toggleEyeIconOnClick:function(h){if(h.dataIndex!=="visibilityIcon"){return}var f=h.model.options.manager.getTreeNodeModelFromRowID(h.model.getRowID());var g=this._getTreeNodeExtensionFromTreeNodeModel(f);var e=g.GetObject();if(e.IsKindOf("VCXComponentHotspot")){return}else{this._parent(h)}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentGroupHotspot")||e.IsKindOf("VCXComponentHotspot")||e.IsKindOf("VCXWebComponentOccurrence")}});return b});define("DS/VCXWebTreeGUI/VCXWebSelectionSetsTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(a,d,c){var b=c.extend({init:function(e){this._parent(e);this._type="VCXWebSelectionSetsTreeCtrl";this._uniqueTreeNodePerComponent=false},getTreeTitle:function(){return"Selection Sets"},_setTreeRootsAndFirstNodes:function(){var f=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGroupSelectionSet");this._addTreeNodesFromComponentsList(f,true);var h=[];var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentSelectionSet");for(var g=0;g<e.length;g++){if(e[g].GroupID){}else{h.push(e[g])}}this._addTreeNodesFromComponentsList(h,true)},_setCustomEvtsSubscriptions:function(){var g=this;this._eventTokens._evtSelSetsAddedToken=a.subscribe({event:"VCX_SELECTIONSETS_ADDED"},function e(h){g._addTreeNodesFromComponentsList(h)});this._eventTokens._evtSelSetsRemovedToken=a.subscribe({event:"VCX_SELECTIONSETS_REMOVED"},function f(h){g._removeTreeNodesFromComponentsList(h)})},_addTreeNodeFromComponent:function(i,f){var k=this.tree.getDocument();var m=i&&i.QueryInterface("VCXITreeNode");if(!m){console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.");return}var l=this._createTreeNodeModel(m,m.GetName(),m.GetChildren().length>0,this._onSelectSelSetTreeNodeCB,this._onUnSelectSelSetTreeNodeCB);l.updateOptions({selectionSetRole:1});if(f){f.addChild(l)}else{k.addRoot(l)}var n=m.GetChildren();var g=m.GetObject().GetType();if(g==="VCXComponentGroupSelectionSet"){for(var h=0;h<n.length;++h){var e=n[h];if(!e){console.log("VCXITreeNode extension missing...");continue}var p=e.GetObject();this._addTreeNodeFromComponent(p,l)}return}var j=[];for(var h=0;h<n.length;++h){var e=n[h];if(!e){console.log("VCXITreeNode extension missing...");continue}var o=this._createTreeNodeModel(e,e.GetName(),false);o.updateOptions({selectionSetRole:2});j.push(o)}l.addChild(j)},_onSelectSelSetTreeNodeCB:function(){return this._toggleSelSetActivationOnSelection(true)},_onUnSelectSelSetTreeNodeCB:function(){return this._toggleSelSetActivationOnSelection(false)},_toggleSelSetActivationOnSelection:function(e){var f=this;return function(j){var g=j.target;if(!g.isSelectionChangeFromUI()){return}var k=f._getTreeNodeExtensionFromTreeNodeModel(g);if(!k){return}var h=k.GetObject();var l=f._experienceBase.getManager("VCXAPIManager");var i=e?l.ActivateSelectionSet:l.DeactivateSelectionSet;i.call(l,h.GetID())}},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentGroupSelectionSet")||e.IsKindOf("VCXComponentSelectionSet")||e.IsKindOf("VCXWebComponentOccurrence")}});return b});define("DS/VCXWebTreeGUI/VCXWebStylesTreeCtrl",["DS/CoreEvents/Events","DS/Tree/TreeNodeModel","DS/VCXWebTreeGUI/VCXWebTreeCtrl"],function(a,d,c){var b=c.extend({init:function(e){this._parent(e);this._type="VCXWebStylesTreeCtrl";this._uniqueTreeNodePerComponent=true},_setTreeRootsAndFirstNodes:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentStyle");this._addTreeNodesFromComponentsList(e,true)},_setCustomEvtsSubscriptions:function(){var f=this;this._eventTokens._evtStylesAddedToken=a.subscribe({event:"VCX_STYLE_ADDED"},function e(g){f._addTreeNodesFromComponentsList(g)})},_addTreeNodeFromComponent:function(e){var g=this.tree.getDocument();var h=e&&e.QueryInterface("VCXITreeNode");if(!h){console.warn("The root component must have a treeNode interface. Abort addition of treeNode in tree.");return}var f=this._createTreeNodeModel(h,h.GetName(),h.GetChildren().length>0);g.addChild(f)},isComponentMatchingThisTree:function(e){return e.IsKindOf("VCXComponentStyle")}});return b});