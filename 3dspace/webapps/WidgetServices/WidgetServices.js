define("DS/WidgetServices/WidgetServices",["UWA/Array","UWA/Widget","UWA/Utils"],function(c,h,f){var m=false;var b=false;var l=false;var d=null;var g={};var k=null;var a={};var j={};var e=null;var i={setReplayODT:function(n){m=n},isReplayODT:function(){return m},isReplayedODT:function(){return this.isReplayODT()||(this.getWidgetId()==="infra_odt_wgd")||window.isReplayODT===true},isTransientWidget:function(){var n=this.getWidgetId();return n?n.indexOf("preview")===0:false},setODTMultiSel:function(n){b=n},isMultiSelODT:function(){return b},isTouchDevice:function(){if("ontouchstart" in document.documentElement){return true}else{return false}},setODTComment:function(n){l=n},isCommentODT:function(){return l},getProdLevel:function(){if(this.isReplayODT()){return 0}else{return 2}},generateUniqueId:function(){var n=new Date();return n.getTime()+""+Math.random()*10},commonChar:function(r,q,u){var v=r;var o=q;if(v.length>o.length){v=q;o=r}var n={};var p=0;for(var s=0;s<v.length&&(p===0||!u);s++){var t=v[s];if(!n[t]&&o.indexOf(t)>=0){p++}n[t]=true}return p},removeDuplicate:function(p,o){var q=[];if(p!=null&&c.isArray(p)){var n={};p.forEach(function(t){var s=true;var r=o(t);if(n[r]!==1){n[r]=1;q.push(t)}})}return q},arrayContains:function(p,o,n){return this.arrayContains2(p,o,function(q,r){return n(q)==n(r)})},arrayContains2:function(p,o,n){var q=-1;p.every(function(s,r){if(n(s,o)){q=r;return false}return true});return q},getImageUser:function(o,n){var p="";if(o==3){p="fonticon fonticon-users-group"}else{if(o==2){p="fonticon fonticon-users"}else{p="fonticon fonticon-user"}}var q=null;if(n==="medium"){p+=" fonticon-2x "}q={tag:"span","class":p};return q},getUrl:function(){var n=window.location.href;return n},getRealPath:function(p,r,q){var o="";var n="";if(q==null){q=false}r=r?r:this.getWidgetObject();if(r&&typeof r.getUrl==="function"&&this.getProdLevel()!=0){var s=r.getUrl();n=s.substring(0,s.indexOf("/webapps"));if(n!=""&&n!=null&&q===false){n=n+"/webapps/"}else{n=r.getUrl();n=this.removeParameterOfUrl(n);n=n.substring(0,n.lastIndexOf("/"));if(q){n+="/"}}}else{n=this.getUrl();n=this.removeParameterOfUrl(n)}o=UWA.Utils.buildUrl(n,p);return o},removeParameterOfUrl:function(n){var o=n.split("?");if(o.length>0){return o[0]}},get3DSpaceUrl:function(p){var n=location.protocol+"//"+location.hostname;var o="3DSpace";if(p){p.serverUrl=n;p.serverUri=o}return n+"/"+o},_failUrlAsync:function(p,o,n){var q=p==="3DSpace"?this.get3DSpaceUrl(n):"";o.onComplete.call(null,q)},getServicesUrl:function(o){var p=this;var n=this._getCancelObject();this.getWebInWinParameters(function(r){var q=r?r.myAppsBaseUrl:null;if(n.isCancelled()===false){o.myAppsBaseUrl=q?q:o.myAppsBaseUrl;n.handler=p.__getServicesUrl(o)}});return n},__getServicesUrl:function(p){var r=this;var o=this._getCancelObject();var n=p.platformId?p.platformId:null;n=n?n:r.getTenantID()!=null?r.getTenantID():null;var s=false;if(n){var q=j[n];s=!!q;if(s){p.onComplete.call(null,q)}}if(!s){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(v){if(o.isCancelled()===false){var u={onComplete:function(w){if(c.isArray(w)&&w.length>0){w=w[0]}w=w?w:{};if(n){j[n]=w}p.onComplete.call(null,w)},onFailure:function(w){p.onComplete.call(null,{})}};if(n){u.platformId=n}if(p.myAppsBaseUrl){var t={myAppsBaseUrl:p.myAppsBaseUrl,userId:"all",lang:r.getLanguage()};u.config=t}o.handler=v.getPlatformServices(u)}})}return o},getWidgetObject:function(){var n=window.widget&&window.widget instanceof h;if(e){return e}else{e=n?window.widget:new h()}if(!e.body){e.body=UWA.extend(document.body)}if(!n){e.lang=window.top.dsLang?window.top.dsLang:e.lang;window.widget=e}return e},addWidgetResizeEvent:function(p){var o=this.getWidgetObject();var n=o?o:this.getWidgetBody();n.addEvent("onResize",p)},removeWidgetResizeEvent:function(p){var o=this.getWidgetObject();var n=o?o:this.getWidgetBody();n.removeEvent("onResize",p)},setWidgetObject:function(n){e=n},getLanguage:function(){var n=this.getWidgetObject();var o=null;if(n){o=n.lang?n.lang:this.getWidgetValue("lang")}if(!o){o=window.top.dsLang?window.top.dsLang:"en"}return o},setWidgetValue:function(p,o){var n=this.getWidgetObject();if(n&&typeof n.setValue==="function"){n.setValue(p,o)}g[p]=o},getWidgetValue:function(o){var n=this.getWidgetObject();var p=n&&typeof n.getValue==="function"?n.getValue(o):undefined;if(!p){p=g[o]}return p},deleteWidgetValue:function(o){var n=this.getWidgetObject();if(n&&typeof n.deleteValue==="function"){n.deleteValue(o)}delete g[o]},addWidgetPreference:function(n){var o=this.getWidgetObject();if(o&&typeof o.addPreference==="function"){o.addPreference(n)}},setWidgetPreferences:function(n){var o=this.getWidgetObject();if(o&&typeof o.setPreferences==="function"){o.setPreferences(n)}},getWidgetPreferences:function(){var n=this.getWidgetObject();return n.preferences},getWidgetPreference:function(o){var n=this.getWidgetObject();return n&&typeof n.getPreference==="function"?n.getPreference(o):null},getWidgetPreferenceValue:function(o){var n=this.getWidgetPreference(o);return n&&n.value?n.value:null},getWidgetId:function(){var n=this.getWidgetObject();return n?n.id:"0"},getWidgetBody:function(){var n=this.getWidgetObject();return n&&n.body?n.body:UWA.extend(document.body)},isDebug:function(){return this.getWidgetValue("debug_me")==="1"},getTenantID:function(o){var n=this.getWidgetValue("x3dPlatformId");n=n?n:typeof(enoviaServerCAWidget)!=="undefined"?enoviaServerCAWidget.tenant:null;return n?n:o},setTenantID:function(n){this.setWidgetValue("x3dPlatformId",n)},getTenants:function(o){var n=this;this._getPlatformServices(function(q){var p=[];if(q!==null){q.forEach(function(r){p.push(r.platformId)});if(!n.getTenantID()){n.setTenantID(p[0])}}o.call(this,p)})},getWebInWinParameters:function(o){var n=this;if(!window.COMPASS_CONFIG||!window.COMPASS_CONFIG.myAppsBaseUrl){this._getMyappsUrl(function(p){if(!window.COMPASS_CONFIG){window.COMPASS_CONFIG={}}if(p){window.COMPASS_CONFIG.myAppsBaseUrl=p;if(!window.COMPASS_CONFIG.userId){window.COMPASS_CONFIG.userId=window.enoviaServerCAWidget&&window.enoviaServerCAWidget.contextUser?window.enoviaServerCAWidget.contextUser:"all"}if(!window.COMPASS_CONFIG.lang){window.COMPASS_CONFIG.lang=n.getLanguage()}}o(window.COMPASS_CONFIG)})}else{o(window.COMPASS_CONFIG)}},getGrantedRoles:function(p,o){var n=this;require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(q){n.getWebInWinParameters(function(r){q.getGrantedRoles(function(t){var s=[];t.forEach(function(v){var u=true;if(o&&v.platforms){u=v.platforms.indexOf(o)>=0}u=u||v.id==="InternalDS";if(u){s.push(v.id)}});p.call(n,s)})})})},isChangeAvailable:function(){return !this.isNatifEnvironnement()},isNatifEnvironnement:function(){return typeof(dscef)!=="undefined"},isWebInWinEnvironment:function(){return this.isCatiaV5Environment()||this.isSolidworksEnvironment()},isCatiaV5Environment:function(){var n=this._getEnvironment();return n==="catiav5"},isSolidworksEnvironment:function(){var n=this._getEnvironment();return n==="solidworks"},_getEnvironment:function(){return this.getUrlParameter("addinmode")},getUrlParameter:function(o){var n=this._getUrlParameters();return n[o]},_getUrlParameters:function(){if(!this.storedUrlParams){var o={};var n=[window.top.location];if(window!==window.top){n.push(window.location)}n.forEach(function(p){p.search.substr(1).split("&").forEach(function(r){var q=r.split("=");if(q.length>1){o[q[0]]=q[1]}})});this.storedUrlParams=o}return this.storedUrlParams},_getMyappsUrl:function(n){if(this.isNatifEnvironnement()&&typeof dscef.getMyAppsURL==="function"){dscef.getMyAppsURL().then(function(o){console.log("MyApps URL",o);n.call(null,o)})["catch"](function(o){console.error("Failed to fetch MyApps URL: "+o);n.call(null,null)})}else{n.call(null,null)}},getCancelObject:function(){return this._getCancelObject()},_getCancelObject:function(){return{isCancelled:function(){return this.handler.toCancel!==false},cancel:function(){this.handler.cancel()},handler:{toCancel:false,cancel:function(){this.toCancel=true}}}},_getServiceUrlAsync:function(q,p,o){var r=this;p=p?p:{};var n=this._getCancelObject();this.getWebInWinParameters(function(t){var s=t?t.myAppsBaseUrl:null;if(n.isCancelled()===false){p.myAppsBaseUrl=s?s:p.myAppsBaseUrl;n.handler=r.__getServiceUrlAsync(q,p,o)}});return n},__getServiceUrlAsync:function(s,r,q){var t=this;var o=this._getCancelObject();o._answerGiven=false;o.hasEnded=function(){return this.toCancel===true||this._answerGiven===true};var n=r.platformId?r.platformId:null;n=n?n:t.getTenantID()!=null?t.getTenantID():null;var u=false;if(n){var p=a[(s+n)];u=!!p;if(u){o._answerGiven=true;r.onComplete.call(null,p)}}if(!u){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(z){if(o.isCancelled()===false){setTimeout(function(){if(!o.hasEnded()&&o.isCancelled()===false){o.cancel();r.onComplete.call(null,s==="3DSpace"?t.get3DSpaceUrl(q):"")}},5000);try{var y={serviceName:s,onComplete:function(C){o._answerGiven=true;if(o.isCancelled()===false){var B=C;if(C&&typeof C!=="string"&&C.length>0){B=C[0].url}B=B?B:s==="3DSpace"?t.get3DSpaceUrl(q):"";if(n){a[(s+n)]=B}r.onComplete.call(null,B)}},onFailure:function(B){o._answerGiven=true;if(o.isCancelled()===false){r.onComplete.call(null,s==="3DSpace"?t.get3DSpaceUrl(q):"")}}};if(n){y.platformId=n}if(r.myAppsBaseUrl){var w={myAppsBaseUrl:r.myAppsBaseUrl,userId:"all",lang:t.getLanguage()};y.config=w}if(r.wintop===false||!r.wintop){z.getServiceUrl(y)}else{if(r.serverUrl){var x=r.serverUrl;var v=x[0]["3DSpace"];y.onComplete(v)}}}catch(A){o._answerGiven=true;t.displayErrorOnConsole(A.stack);t._failUrlAsync(s,r,q)}}},function(){t.displayErrorOnConsole("Fail loading i3DXCompassServices");t._failUrlAsync(s,r,q)})}return o},displayErrorOnConsole:function(n){console.log("%c"+n,"color: red")},getSourceUrlAsync:function(p,o){var n=p&&p.source?p.source:"3DSpace";return this._getServiceUrlAsync(n,p,o)},get3DSpaceUrlAsync:function(o,n){return this.getSourceUrlAsync(o,n)},get3DSwymUrlAsync:function(o,n){return this._getServiceUrlAsync("3DSwym",o,n)},get3DSearchUrlAsync:function(o,n){return this._getServiceUrlAsync("3DSearch",o,n)},getCompassUrlAsync:function(o,n){return this._getServiceUrlAsync("3DCompass",o,n)},_getPlatformServices:function(n){if(d!=null){n.call(this,d)}else{require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(o){o.getPlatformServices({onComplete:function(p){n.call(this,p)},onFailure:function(p){that.displayErrorOnConsole("Cannot retrieve the Platform Services");n.call(this,null)}})})}},getFullUrl:function(p,s,n){var v="";var o=p;var q=s;var u=this.getWidgetObject();if(u!=null&&typeof u.getUrl==="function"&&(p==""||p==null)&&(s==""||s==null)){var r=u.getUrl();v=r.substring(0,r.indexOf("/webapps"));q=v.substring(v.lastIndexOf("/")+1)}else{if(p==""||p==null){o=this.getServerUrl()}if(s==""||s==null){q=this.getRootURI()}v=UWA.Utils.buildUrl(o,q)}if(v==""){v=this.get3DSpaceUrl()}if(n!=null){var t=v;if(q!==""){t=v.substring(0,v.indexOf("/"+q))}n.serverUrl=t;n.serverUri=q}return v},getServerUrl:function(){var n="";n=location.host;if(!n){n=location.origin}if(n.indexOf("http")<0){if(location.protocol){n=location.protocol+"//"+n}else{n="http://"+n}}return n},getRootURI:function(){var n=location.pathname;var o=n.indexOf("/",1);if(o<0){o=n.indexOf("\\",1)}n=n.substring(0,o);return n},convertDateToStandard:function(p,u){if(!p){return{value:"",valueDB:""}}var o=u?p:new Date();var n=p.getUTCFullYear();var q=p.getUTCMonth()+1;var v=p.getUTCDate();var t=o.getUTCHours();var r=o.getUTCMinutes();var s=o.getUTCSeconds();if(this.isReplayedODT()){t=12;r=0;s=0;o.setHours(t);o.setMinutes(r);o.setSeconds(s)}if(q<10){q="0"+q}if(v<10){v="0"+v}if(t<10){t="0"+t}if(r<10){r="0"+r}if(s<10){s="0"+s}o.setYear(n);o.setMonth(p.getMonth());o.setDate(v);return{value:o.toLocaleString(this.getLanguage()),valueDB:n+"/"+q+"/"+v+"@"+t+":"+r+":"+s+":GMT"}},formatDateObj:function(p){if(!p){return null}var o=p.split("@");var q=p;if(o.length>1){var v=o[0].split("/");var r=v[0];var n=v[1];var u=n-1;var x=v[2];var w=o[1].split(":");var y=w[0];var s=w[1];var t=w[2];q=new Date();q.setUTCHours(y);q.setUTCMinutes(s);q.setUTCSeconds(t);q.setUTCFullYear(r);q.setUTCDate(1);q.setUTCMonth(u);q.setUTCDate(x)}return q},formatDate:function(o,q){var p=o;var n=o instanceof Date?o:this.formatDateObj(o);if(n){if(q==true){p=n.toLocaleString(this.getLanguage())}else{p=n.toLocaleDateString(this.getLanguage())}}return p},addNewStyles:function(r,n,p){var t="";for(var q in n){var v=n[q];var s="{";for(var o in v){var u=v[o];s+=o+":"+u+";"}if(s.length>1){s+="}";t+=q+" "+s}}if(t){return this.addNewStyle(r,t,p)}},addNewStyle:function(p,t,r){var s=this;var o=document.getElementsByClassName(p);var n=null;var q=null;if(o&&o.length>0){n=o[0]}if(r&&n){q=this.addNewStyle(p+"_temp",t,false);n.parentNode.removeChild(n);n=null}if(!n){n=document.createElement("style");n.type="text/css";n.className=p;document.getElementsByTagName("head")[0].appendChild(n)}n.appendChild(document.createTextNode(t));setTimeout(function(){s.clearJSStylesheet(p+"_temp")});return n},clearJSStylesheet:function(o){var n=document.getElementsByClassName(o);if(n&&n.length>0){n[0].parentNode.removeChild(n[0])}},download:function(p,q,s,o){var r=s==="json";var u=r?JSON.stringify(q,null,"\t"):q;p=this.isReplayedODT()?"ODT_ToRemove":p;if(o===true){var w=this.getTenantID();p=p+(w?"_"+w:"")}p=p+(r?".json":".txt");var v=(r?"application/json":"text/plain")+";charset=utf-8;";if(window.navigator&&window.navigator.msSaveOrOpenBlob){var n=new Blob([decodeURIComponent(encodeURI(u))],{type:v});window.navigator.msSaveOrOpenBlob(n,p)}else{var t=document.createElement("a");t.setAttribute("href","data:"+v+","+encodeURIComponent(u));t.setAttribute("download",p);t.setAttribute("target","_blank");document.body.appendChild(t);t.click();document.body.removeChild(t)}},compareValue:function(A,z){if(!isNaN(A)||!isNaN(z)){if(!isNaN(A)&&!isNaN(z)){return Number(z)==Number(A)?0:(Number(z)>Number(A)?1:-1)}else{A=A+"";z=z+""}}var t=A.toLowerCase();var r=z.toLowerCase();if(t==r){return 0}var E=false;var o=t.length;var n=r.length;var s=o;if(n<o){s=n}var C=0;var D=false;var x="";var w="";while(E===false){for(var B=0;B<s;B++){var v=t.charAt(B);var u=r.charAt(B);var F=!isNaN(v)&&v!=" ";var y=!isNaN(u)&&u!=" ";if(!F&&!y){if(D===false){C=u.localeCompare(v);if(C!==0){E=true;break}}else{if(Number(x)!=Number(w)){if(Number(x)>Number(w)){C=-1}else{if(Number(x)<Number(w)){C=1}}E=true;break}}D=false}else{if(F&&!y){if(D===true){C=-1}else{C=1}E=true;break}else{if(!F&&y){if(D===true){C=1}else{C=-1}E=true;break}else{x+=v;w+=u;D=true}}}if(!F||!y){F="";y=""}}if(E===false){if(o>n){var q=t.charAt(s);if(!isNaN(q)){C=-1}else{if(D===true&&Number(x)!=Number(w)){if(Number(x)>Number(w)){C=-1}else{if(Number(x)<Number(w)){C=1}}}else{C=-1}}}else{if(o<n){var p=r.charAt(s);if(!isNaN(p)){C=1}else{if(D===true&&Number(x)!=Number(w)){if(Number(x)>Number(w)){C=-1}else{if(Number(x)<Number(w)){C=1}}}else{C=1}}}else{if(Number(x)!=Number(w)){if(Number(x)>Number(w)){C=-1}else{if(Number(x)<Number(w)){C=1}}}}}break}}return C}};if(window.widget&&window.widget.getValue("proto")===true){i.servicesUrls=a}return i});define("DS/WidgetServices/commandProxy/CommandProxy",["UWA/Class","DS/PlatformAPI/PlatformAPI"],function(c,b){var a="DS/PADUtils/PADCommandProxy/select";var e="DS/Properties/CommandProxy/update";var d=c.extend({subscriptions:{},choices:{SELECT:"onSelect",UPDATE:"onUpdateTransient"},onSelect:function(h){var f=a;var g=b.subscribe(f,function(i){h.apply(null,[i.data,i])});this.unsubscribe(this.choices.SELECT);this.subscriptions[this.choices.SELECT]=g},onUpdateTransient:function(h){var f=e;var g=b.subscribe(f,function(i){h.call(null,i)});this.unsubscribe(this.choices.UPDATE);this.subscriptions[this.choices.UPDATE]=g},init:function(f){this.subscribe(f)},subscribe:function(f){var h=this;for(var g in f){if(typeof f[g]==="function"){switch(g){case this.choices.SELECT:h.onSelect(f[g]);break;case this.choices.UPDATE:h.onUpdateTransient(f[g])}}}},unsubscribe:function(f){var g=this.subscriptions[f];if(g){b.unsubscribe(g);this.subscriptions[f]=null}},destroy:function(){for(var f in this.subscriptions){this.unsubscribe(f)}this._parent()}});d.create=function(f){var g;if(f){g=f.events}return new d(g)};d.publishUpdate=function(g,f){b.publish(e,{models:g,options:f})};d.publishSelect=function(f){b.publish(a,f)};return d});define("DS/WidgetServices/moveHelper/MoveHelper",["UWA/Controls/Abstract"],function(e){var f=null;var c=null;var i=false;var g=function(m){if(f!=null){var l=f.getElement();var o=h(m);var n={x:c.x-o.x,y:c.y-o.y};f.dispatchEvent("move",{diff:n})}};var j=function(l){if(f!=null){f.dispatchEvent("endMove")}f=null};var h=function(m){var n={};var l=m.changedTouches;if(l!=null){n={x:m.changedTouches[0].clientX,y:m.changedTouches[0].clientY}}else{n={x:m.clientX,y:m.clientY}}return n};var a=[];function k(){if(!i){i=true;document.addEventListener("mousemove",g);document.addEventListener("touchmove",g);document.addEventListener("mouseup",j);document.addEventListener("touchend",j);document.body.addEventListener("mouseleave",j);document.body.addEventListener("touchleave",j)}}function d(){document.removeEventListener("mousemove",g);document.removeEventListener("touchmove",g);document.removeEventListener("mouseup",j);document.removeEventListener("touchend",j);document.body.removeEventListener("mouseleave",j);document.body.removeEventListener("touchleave",j);i=false}var b=e.extend({init:function(l){this._parent(l);var m=this;this._handlerFirstActionResize=function(n){m._firstActionResize(n)};k();l.element.addEventListener("mousedown",this._handlerFirstActionResize);l.element.addEventListener("touchstart",this._handlerFirstActionResize);a.push(this)},getElement:function(){return this.options.element},disconnect:function(){this.options.element.removeEventListener("mousedown",this._handlerFirstActionResize);this.options.element.removeEventListener("touchstart",this._handlerFirstActionResize)},_firstActionResize:function(l){l.preventDefault();this.dispatchEvent("startMove");f=this;c=h(l)},destroy:function(){var m=this;this.disconnect();var l=[];a.forEach(function(n){if(n!==m){l.push(n)}});a=l;if(a.length===0){d()}this._parent()}});b.removeAll=function(){a.forEach(function(l){l.disconnect()});a=[];d()};return b});define("DS/WidgetServices/MultipleAsynchronousRequests",[],function(){var a=function(d,f){var c={};var e=d.length;var b=f;this.setAnswer=function(h,g){if(d.indexOf(h)>=0){if(c[h]===undefined){e--}c[h]=g}if(e<=0&&b!==null){b.call(this)}},this.getAnswer=function(g){return c[g]},this.addRequest=function(g){if(d.indexOf(g)<0){d.push(g);e++}}};return a});define("DS/WidgetServices/UIInfra/UIInfra",["css!DS/WidgetServices/WidgetServices.css"],function(b){var f=typeof InstallTrigger!=="undefined"?1.25:1;var c=UWA.createElement("div",{"class":"Ghost_copiedElementContainer"});var d=200;var e=d+"px";var a={createGhostDnD:function(g,u){var n=b;var k=u.number>99?"99+":u.number;var l=null;if(u.number>1){l=UWA.createElement("span",{"class":"Ghost_infoDrag",text:k})}c.inject(g.target.parentNode);var r=g.target.cloneNode(true);var s=g.target.getSize();var t="Ghost_left";var m=null;if("function"!==typeof DataTransfer.prototype.setDragImage){m=UWA.extend(g.target,UWA.element);var o=30;var h={x:g.offsetX,y:g.offsetY};var j=g.target.getSize();var i={left:h.x,right:d-h.x};var q=0;var p=true;if(i.left<=o&&i.left<=i.right){t="Ghost_right";p=false}if(l!==null){m.addClassName(t);if(p){g.target.insertBefore(l,g.target.firstChild)}else{g.target.appendChild(l)}}g.target.parentNode.insertBefore(r,g.target);g.target.addClassName("Ghost_tempObj");setTimeout(function(){g.target.removeClassName("Ghost_tempObj");g.target.parentNode.removeChild(r);if(l!==null){g.target.removeChild(l)}},0)}else{m=UWA.extend(r,UWA.Element);m.addClassName("Ghost_draggingObj");c.appendChild(r);if(l!==null){m.addClassName(t);r.insertBefore(l,r.firstChild)}g.dataTransfer.setDragImage(r,-10,-10);setTimeout(function(){c.removeChild(r)})}m.addClassName(u.className);m.addClassName("GhostMainContainer");setTimeout(function(){m.removeClassName(t);m.removeClassName(u.className);m.removeClassName("GhostMainContainer")},0)}};return a});define("DS/WidgetServices/securityContextServices/SecurityContextServices",["UWA/Class","UWA/Json","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServices/assets/nls/SecurityContextNls"],function(b,a,e,d){var c=b.singleton({_currentSecurityContext:"",_preferedSecurityContext:"",options:{serverName:"",serverUri:"",isStandalone:false,alwaysUpdate:false,context:null,wintop:false,tenant:null,source:null},init:function(f){this._parent()},getInstance:function(g){try{this.init(g)}catch(h){}for(var f in g){this.options[f]=g[f]}return this},getSecurityContext:function(i,h){this._currentSecurityContext=null;if(this.options.context&&typeof this.options.context.getSecurityContext==="function"){var g=this.options.context.getSecurityContext();if(g&&g.SecurityContext){this._currentSecurityContext=g;this._computeSecurityContext(i);return}}var f=false;if(h!=null){if(h.serverName!=null){if(h.serverName!=this.options.serverName){f=true}this.options.serverName=h.serverName}if(h.serverUri!=null){if(h.serverUri!=this.options.serverUri){f=true}this.options.serverUri=h.serverUri}}if(this.options.alwaysUpdate===true){f=true}if(f==true||this._preferedSecurityContext==""||this._preferedSecurityContext.SecurityContext==null){return this._getSecurityContext(true,i)}else{this._computeSecurityContext(i)}},_computeSecurityContext:function(g){if(this._currentSecurityContext===null){this._currentSecurityContext=this._preferedSecurityContext}if(g!=null){if(this._currentSecurityContext&&this._currentSecurityContext.SecurityContext){var f=this._currentSecurityContext.SecurityContext;var h="";if(f.indexOf("ctx::")!=0){h="ctx::"}this._currentSecurityContext.SecurityContext=h+f;g.onSuccess.call(this,this._currentSecurityContext)}else{var i={message:d.get("ErrorSecurityContextEmpty"),code:"ERROR"};g.onFailure.call(this,i)}}},_getSecurityContext:function(g,k){var j=this;var i=e._getCancelObject();if(g===false&&this.options.serverName==""&&this.options.serverUri==""){this._onFailureGetSecurityContext(null,null,null,g,k);return}var l={Accept:"application/json"};l["Content-Type"]="application/json";var f=null;var h=null;if(g===false){var f=this.options.serverName;var h=this.options.serverUri}require(["DS/WAFData/WAFData","DS/WidgetServices/WidgetServices"],function(m,o){if(i.isCancelled()===false){var n=j.options.tenant;n=n?n:o.getTenantID();i.handler=o.getSourceUrlAsync({platformId:n,source:j.options.source,onComplete:function(t){var r=t+"/resources/pno/person/getsecuritycontext";var s=j.options.tenant;s=s?s:o.getTenantID();if(s){r+="?tenant="+s}var p="";if(j.options.isStandalone===false&&j.prodLevel==2){p="passport"}l["Accept-Language"]=o.getLanguage();var q={type:"json",method:"GET",proxy:p,headers:l,onComplete:function(u){j._onCompleteGetSecurityContext(u,g,k)},onFailure:function(u,v,w){j._onFailureGetSecurityContext(u,v,w,g,k)},onTimeout:function(){j._onTimeoutGetSecurityContext(g,k)},};if(j.options.isStandalone===false){q.authentication="passport"}i.handler=m.handleRequest(r,q)},serverUrl:j.options.serverUrl,wintop:j.options.wintop})}});return i},_onCompleteGetSecurityContext:function(i,f,h){var g=this;if((i==null||i=="")&&f!=false){g._getSecurityContext(false,h)}else{this._preferedSecurityContext=i;if(h!=null){this._computeSecurityContext(h)}}},_onTimeoutGetSecurityContext:function(f,h){var g=this;if(f!=false){g._getSecurityContext(false,h)}else{var i={message:d.get("ErrorTimeOut"),code:"TO"};if(h!=null){h.onFailure.call(this,i)}}},_onFailureGetSecurityContext:function(f,h,k,g,j){var i=this;this._request=null;if(g!=false){i._getSecurityContext(false,j)}else{if(a.isJson(h)){h=a.decode(h)}var l={};if(h!=null&&h.hasOwnProperty("error")){l=h.error}else{l={message:d.get("ErrorSecurityContext"),code:"ERROR"}}if(j&&typeof j.onFailure==="function"){j.onFailure.call(this,l)}}}});return c});