define("DS/MMPrint/MMPrintCmd",["DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ApplicationFrame/Command","i18n!DS/MMPrint/assets/nls/MMPrint"],function(i,e,h,c,b){var g;function f(m,n){var l=n.indexOf("<svg",n.search("<svg")+4);var o=n.lastIndexOf("</svg>");var j=n.substring(l,o);var k=j.split("<svg");j="<svg"+k[m+1];return j}function d(j){try{if(false===j.contentWindow.document.execCommand("print",false,null)){j.contentWindow.print()}}catch(k){j.contentWindow.print()}}var a=c.extend({init:function(j){this._parent(j,{isAsynchronous:false,mode:"exclusive"});g=new e();g.inject(document.body)},beginExecute:function(){var t=this.getFrameWindow();var l=t.experience;if(t&&l){var o=l.args.input.asset;if((o.type==="svg")||(o.type==="Drawing")){var k=document.createElement("iframe");document.body.appendChild(k);var m=l.getSource();var p=l.getCurrentSheetIndex();var s=l.getNumberOfSheets();var j=m;if(s===1){var r=m.search("<svg");j=m.substring(r,j.length)}else{j=f(p,m)}k.contentDocument.write(j);k.contentDocument.documentElement.getElementsByTagName("body")[0].style.margin="0";k.position="fixed";k.top="0";k.left="100%";k.width="100%";k.height="100%";d(k);document.body.removeChild(k);k=null}else{var n=document.createElement("div");n.innerHTML="<p>"+b.printRealSizeError+"</p>";g.visibleFlag=true;var q=new i({title:b.printErrorTitle,content:n,immersiveFrame:g,buttons:{Ok:new h({onClick:function(u){q.destroy();g.visibleFlag=false}})}})}}else{var n=document.createElement("div");n.innerHTML="<p>"+b.printRealSizeError+"</p>";g.visibleFlag=true;var q=new i({title:b.printErrorTitle,content:n,immersiveFrame:g,buttons:{Ok:new h({onClick:function(u){q.destroy();g.visibleFlag=false}})}})}}});return a});