define("DS/TransferOwnershipWidget/TOSModel/TOSPublicTransfer",["UWA/Controls/Abstract"],function(b){var a=b.extend({init:function(d){this.contextId="";this.physicalId="";this.type="";this.title="";this.context="";this.targetSpace="";this.category="";this.isTOSPublicTransfer=true;for(var c in d){this[c]=d[c]}},getPhysicalId:function(){return this.physicalId},getType:function(){return this.type},getTitle:function(){return this.title},getContext:function(){return this.context},getTargetSpace:function(){return this.targetSpace},getCategory:function(){return this.category},setPhysicalId:function(c){this.physicalId=c},setType:function(c){this.type=c},setTitle:function(c){this.title=c},setContext:function(c){this.context=c},setTargetSpace:function(c){this.targetSpace=c},setCategory:function(c){this.category=c}});return a});define("DS/TransferOwnershipWidget/TransferOwnershipConstant",[],function(){var a={TransferCollabSpace:"CollabSpace",TransferCollabSpaceSoft:"CollabSpaceSoft",TransferFull:"full",TransferPerson:"Person"};return a});define("DS/TransferOwnershipWidget/TOSHistory/TransferOwnershipHistory",["UWA/Json","UWA/Controls/Abstract","DS/DataGridWidget/DataGridWidget","DS/ErrorWidget/ErrorWidget","DS/WidgetServices/WidgetServices","DS/WAFData/WAFData","DS/UIKIT/Input/Button"],function(j,c,f,g,i,e,d){var h=i.getProdLevel();var a=false;var b=c.extend({defaultOptions:{serverName:"",serverUri:"",},init:function(k){h=i.getProdLevel();this._parent(k);this._initUI()},_initUI:function(){var k=this;this.container=UWA.createElement("div",{"class":"TOS_HistoryTable"});this.errorComponent=new g(widget,this.container);this.historyButton=new UWA.createElement("a",{html:"&lsaquo;back","class":"TOS_showTransfer",name:"TOS_BackButton",events:{click:function(l){k.dispatchEvent("onBack")}}});this.historyButton.inject(this.container)},activeAutoRefresh:function(k){a=k},});return b});define("DS/TransferOwnershipWidget/TOSModel/TOSSelectedItem",["UWA/Controls/Abstract"],function(b){var a=b.extend({init:function(d){this.physicalId="";this.urlIcon="";this.name="";this.type="";this.category="";this.isTOSSelectedItem=true;for(var c in d){this[c]=d[c]}},getPhysicalId:function(){return this.physicalId},getUrlIcon:function(){return this.owner},getName:function(){return this.name},getType:function(){return this.type},getCategory:function(){return this.category},});return a});define("DS/TransferOwnershipWidget/TOSModel/TOSSummaryModel",["UWA/Controls/Abstract"],function(b){var a=b.extend({init:function(n){this.PREFIX_TYPE_BUS="Class";this.PREFIX_TYPE_REL="RelationClass";var j="";var l="";var i="";var m="";var d="";var e="";var g="";var c="";var h="";this.isTOSSummaryModel=true;for(var f in n){this[f]=n[f]}},getPhysicalId:function(){return this.physicalId},getTitle:function(){return this.title},getType:function(){return this.type},getProject:function(){return this.project},getOrganization:function(){return this.organization},getOwner:function(){return this.owner},getPrefixType:function(){return this.prefixType},getOldOwner:function(){return this.old_owner},getError:function(){return this.error},getOldContext:function(){return this.oldContext},getCurrentContext:function(){return this.currentContext},});return a});define("DS/TransferOwnershipWidget/TOSSummary/TransferOwnershipSummaryRequest",["UWA/Controls/Abstract","UWA/Json","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/TransferOwnershipWidget/TOSModel/TOSSummaryModel","DS/WAFData/WAFData"],function(h,b,g,f,e,a){var c=g.getProdLevel();var d=h.extend({tags:{},listOfResult:[],defaultOptions:{serverName:"",serverUri:"",},init:function(i,l,k,j){c=g.getProdLevel();this._parent(j);var m=this;f.getInstance().getSecurityContext({onSuccess:function(n){var o="";if(n&&n.SecurityContext){o=n.SecurityContext}m._request(i,o,l,k)},onFailure:function(n){m._setError(n)}})},_request:function(k,p,n,m){var o=this;var j="/resources/v1/collabServices/base/transferOwnership/computeScope";var i=this.options.serverName;var l=this.options.serverUri;g.get3DSpaceUrlAsync({onComplete:function(x){var u={"content-type":"application/json",Accept:"application/json",SecurityContext:p};if(m){if(m["DS-Change-Authoring-Context"]){u["DS-Change-Authoring-Context"]=m["DS-Change-Authoring-Context"]}if(m["DS-Configuration-Authoring-Context"]){u["DS-Configuration-Authoring-Context"]=m["DS-Configuration-Authoring-Context"]}}var w=g.getRealPath("assets/summary.json",widget);var r="GET";var q="";var s="";if(c==2){w=x+j;r="POST";q="passport";s=b.encode(k)}w+="?";var v=g.getTenantID();if(v){w+="tenant="+v}if(widget.getBool("admin")){if(v){w+="&"}w+="admin="+widget.getBool("admin")}var t=k.owner.person.personFullName;u["Accept-Language"]=widget.lang;a.authenticatedRequest(w,{type:"json",method:r,proxy:q,headers:u,data:s,timeout:900000,onComplete:function(y){o._OnComplete(y,t,n)},onFailure:function(y,z,A){o._onFailure(y,z,A)},onTimeout:function(y){o._onTimeout()}})}})},_OnComplete:function(l,m,j){var k=this;if(l.succeed===true){var i=l.results;this._generateListOfResult(i,m,j);this.dispatchEvent("onSuccess",{datas:k.listOfResult})}else{if(l.hasOwnProperty("error")){this._setError(l.error)}}},_onFailure:function(i,j,k){var l={};if(b.isJson(j)){j=b.decode(j)}if(j!=null&&j.hasOwnProperty("error")){l=j.error}else{l={message:UWA.i18n("UnknownError"),code:"ERROR"}}this._setError(l)},_onTimeout:function(){var i={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this._setError(i)},getTags:function(){return this.tags},_generateListOfResult:function(k,n,l){var m=this;var j=0;this.listOfResult=[];var i=[];this.tags={};k.forEach(function(p){var o=p.typeElem;o.forEach(function(q){var r=q.element;r.forEach(function(x){var u=x.error;if(u!=null){var w=x.id;var y=Object.keys(l);for(var v=0;v<y.length;v++){var s=l[y[v]];for(var t=0;t<s.length;t++){if(w==s[t]){if(!(u.message=="Success_idFromCompletionApi")){i.push({id:s,error:u});break}}}}}})})});k.forEach(function(v){var r=v.collaborativeSpace;var p=v.organization;var x=v.owner;var q=v.oldOwner;var w=v.oldOrg;var u=v.oldProject;var t=q+"/"+u+"/"+w;var s;var o=v.typeElem;o.forEach(function(y){var B=y.nameType;var B=y.nameType;if((B=="Active Version")||(B=="Latest Version")||(B=="VersionOf")||(B=="Viewable")||(B=="CAD SubComponent")||(B=="CatAnalysis")){return}var z=y.prefixForType;var A=y.element;A.forEach(function(G){var J=G.error;var K=false;if((J==null)||(J.message=="Success_idFromCompletionApi")){if(i.length>0){for(var H=0;H<i.length;H++){if(K){break}if(i[H]["error"]!=null){var C=i[H]["id"];for(var E=0;E<C.length;E++){if(G.id==C[E]){x=q;s=t;J=i[H]["error"];K=true;break}else{if((r!=u)||(p!=w)){if(J!=null&&J.message!=null){if(J.message!="Success_idFromCompletionApi"){J=UWA.i18n("TOS_SuccessStatusForRevisions")}}if(B=="VPMReference"||B=="3DShape"){if(J!=null&&J.message!=null){if(J.message!="Success_idFromCompletionApi"){J=UWA.i18n("TOS_SuccessStatusForSelectedRevision")}}}}else{if(J!=null&&J.message!=null){J=UWA.i18n("TOS_SuccessStatus")}}if((B=="Workspace")||(B=="Workspace Vault")||(B=="Folder")){if(J!=null&&J.message!=null){if(J.message!="Success_idFromCompletionApi"){J=UWA.i18n("TOS_SuccessStatus")}}}x=n;s=n+"/"+r+"/"+p}}}}}else{if((r!=u)||(p!=w)){J=UWA.i18n("TOS_SuccessStatusForRevisions");if(B=="VPMReference"||B=="3DShape"){J=UWA.i18n("TOS_SuccessStatusForSelectedRevision")}}else{J=UWA.i18n("TOS_SuccessStatus")}if((B=="Workspace")||(B=="Workspace Vault")||(B=="Folder")){J=UWA.i18n("TOS_SuccessStatus")}x=n;s=n+"/"+r+"/"+p}}else{x=q;s=t}j++;m.tags["subject-"+j+"-uri"]=[{object:r,sixw:"ds6w:where/ds6w:context/ds6w:project",field:"Collab",dispValue:r},{object:p,sixw:"ds6w:where/Organization",field:"Organization",dispValue:p},{object:x,sixw:"ds6w:who/ds6w:responsible",field:"Owner",dispValue:x},{object:B,sixw:"ds6w:what/ds6w:type",field:"ObjectType",dispValue:B}];var D=G.id;var I=G.objectName;var F={physicalId:D,title:I,type:B,project:r,organization:p,owner:x,prefixType:z,old_owner:q,oldContext:t,currentContext:s,error:J};m.listOfResult.push(new e(F))})})})},_setError:function(i){this.dispatchEvent("onError",i)},});return d});define("DS/TransferOwnershipWidget/TOSSummary/TransferOwnershipSummary",["UWA/Json","UWA/Controls/Abstract","DS/DataGridWidget/DataGridWidget","DS/ErrorWidget/ErrorWidget","DS/WidgetServices/WidgetServices","DS/TransferOwnershipWidget/TOSSummary/TransferOwnershipSummaryRequest","DS/UIKIT/Input/Button","css!DS/TransferOwnershipWidget/TransferOwnershipWidget.css",],function(n,g,j,k,m,b,h){var l=m.getProdLevel();var d=false;var f=null;var c=[];var a=[];var i={};var e=g.extend({defaultOptions:{serverName:"",serverUri:"",},init:function(o){l=m.getProdLevel();this._parent(o);var p=this;this._initUI()},onResize:function(){var p={width:0,height:0};var o=p;var s=p;if(this.restrictedReport){o=this.restrictedReport.getSize()}if(this.historyButton){s=this.historyButton.getSize()}var q=this.container.getSize();var t=this.containerTable.getStyle("margin-bottom");t=parseInt(t);var r=q.height-s.height-o.height-t;this.containerTable.show();this.containerTable.setStyle("height",r);if(this.table){this.table.updateScroller()}},_initUI:function(){var o=this;this.responseObjectIds=[];this.lLines=[];this.container=UWA.createElement("div",{"class":"TOS_HistoryTable"});this.errorComponent=new k(widget,this.container);this.historyButton=new UWA.createElement("a",{html:"&lsaquo;"+UWA.i18n("TOS_Sum_Back"),"class":"TOS_showTransfer",name:"TOS_BackButton",events:{click:function(p){o.dispatchEvent("onBack")}}});this.historyButton.inject(this.container);this.historyButton.hide();this.containerTable=UWA.createElement("div",{"class":"TOS_containerTable"}).inject(this.container);this.table=this._createTable();this.table.inject(this.containerTable);this.restrictedReport=UWA.createElement("div",{"class":"TOS_RestrictedReport"});this.restrictedReport.inject(this.container)},refresh:function(q,p,o){f=q;c=p;i=o;this.onRefresh()},onRefresh:function(){this._getSummary()},getOptimalSize:function(){var p=this.historyButton.getSize();var o=this.table.getOptimalSize();return{width:o.width,height:o.height+p.height}},_countErrors:function(){var r=a.length;var o=0;for(var q=0;q<r;q++){var p=a[q];if(p.message!=null){o++}}return o},_getSummary:function(){this.table.clearAllLine();if(f==null){return}var p=this;var o=new b(f,c,i,{serverName:p.options.serverName,serverUri:p.options.serverUri,events:{onError:function(q){p.dispatchEvent("onStopSearch",[]);p._setError(q)},onSuccess:function(s){p._OnComplete(s.datas,this,c);var q=p._countErrors();if(q>0){var r=UWA.i18n("TOS_Fail").format(q);p._setError({message:r})}}}})},_OnComplete:function(t,r,p){var q=this;this.responseObjectIds=t;var s=[];var o=[];a=[];if(t!=null&&t.length>0){t.forEach(function(z){var x=z.getPhysicalId();o.push(x);var v=UWA.i18n("TOS_SuccessStatus");if(z.getError()!=null){if(z.getError().message!=undefined){v=z.getError().message}else{v=z.getError()}}var y=Object.keys(p);var A=false;for(var w=0;w<y.length;w++){if(x==y[w]){A=true}}if((z.getType().contains("Workspace"))||(z.getType().contains("Folder"))){A=true}if(A){s.push({TOS_Summary_Id:x,TOS_Sum_Name:z.getTitle(),TOS_Sum_Type:z.getType(),TOS_Sum_Collab:z.getProject(),TOS_Sum_Org:z.getOrganization(),TOS_Sum_Resp:z.getOwner(),TOS_CURRENT_Ownership:z.getCurrentContext(),TOS_OLD_OWNER:z.getOldOwner(),TOS_OLD_Ownership:z.getOldContext(),TOS_STATUS:v})}if(A){a.push(z.getError())}})}this.dispatchEvent("onStopSearch",n.encode(o));var u="";this.dispatchEvent("onUpdate",n.encode(u));this.lLines=s;this.onResize()},_getFailedItem:function(o){for(var q=0;q<o.results.length;q++){var r=o.results[q];if(r.body.errors!=null){var p=r.body.errors.length;if(p>0){return{physicalid:r.body.physicalid,error:r.body.errors[p-1].message}}}}return null},finalizeStatus:function(s,p){if(!s){var r=this._getFailedItem(p);for(var q=0;q<this.lLines.length;q++){var o=this.lLines[q];o.TOS_STATUS=UWA.i18n("cannot move selection");if(o.TOS_Summary_Id==r.physicalid){o.TOS_STATUS=r.error}o.TOS_CURRENT_Ownership=o.TOS_OLD_Ownership}}this.table.AddDatasInTable(this.lLines)},_createTable:function(){var o=this;var p=new j([{text:UWA.i18n("TOS_Sum_Name"),dataIndex:"TOS_Sum_Name",sortKey:function(q){return q},sortable:true},{text:UWA.i18n("TOS_OLD_Ownership"),dataIndex:"TOS_OLD_Ownership",sortKey:function(q){return q},sortable:true},{text:UWA.i18n("TOS_CURRENT_Ownership"),dataIndex:"TOS_CURRENT_Ownership",sortKey:function(q){return q},sortable:true,defaultSort:true},{text:UWA.i18n("TOS_STATUS"),dataIndex:"TOS_STATUS",sortKey:function(q){return q},sortable:true}],{className:"TOS_SummaryTable",setScroller:false,useNativeScroller:true,maxHeightScroller:""});return p},_setError:function(o){this.dispatchEvent("onError",o)},});return e});define("DS/TransferOwnershipWidget/component/TransferOwnershipWidget",["UWA/Core","UWA/Controls/Input","UWA/Controls/Abstract","UWA/Json","DS/DataDragAndDrop/DataDragAndDrop","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/SearchWidget/SearchWidget","DS/SearchWidget/SearchWidgetConstant","DS/ErrorWidget/ErrorWidget","DS/DataGridWidget/DataGridWidget","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WarningWidget/WarningWidget","DS/MVAInput/searchPeopleInput/MVASearchPeopleInput","DS/TransferOwnershipWidget/TOSModel/TOSSelectedItem","DS/TransferOwnershipWidget/TOSModel/TOSPublicTransfer","DS/TransferOwnershipWidget/TOSHistory/TransferOwnershipHistory","DS/TransferOwnershipWidget/TOSSummary/TransferOwnershipSummary","DS/TransferOwnershipWidget/TOSSummary/TransferOwnershipSummaryRequest","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Spinner","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Modal","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Text","text!DS/TransferOwnershipWidget/assets/TOSettings.json","css!DS/TransferOwnershipWidget/TransferOwnershipWidget.css","i18n!DS/TransferOwnershipWidget/assets/nls/TOSNls"],function(h,D,O,s,t,q,j,x,A,w,p,B,m,I,z,c,C,e,F,i,J,G,g,v,E,d,a,l,k){var n=m.getProdLevel();var N="/collabSharing/TransferServices";var f=50;var o=0;var u=50;var y=5000;var H=2000;var M="TOS_MasterContain";var L="TOS_progressNotif";var b="TOS_SummaryResult";var r=UWA.i18n("TOS_SelectedItems");var K=O.extend({itemListHasPriority:false,defaultOptions:{className:"",context:null,ForbiddenChar:'"#$@%*,?\\<>[]|:',showTopBar:true,setCloseButton:false,topClassHeight:M,transferType:x.TransferFull,launchTransfer:true,genericTransfer:false,serverName:"",serverUri:"",activeExpandWholeStructure:false,activeDnD:false,activeOptions:false,activeAdminCheckBox:false,activeSummaryButton:false,activeHistoryButton:false,activeFirstLineTable:false,displaySoftDialog:true,model:true,wintop:false},init:function(P){this.defaultOptions.activeAdminCheckBox=widget.getBool("admin"),n=m.getProdLevel();this.SelectedItems=[];this.listID=[];this.currentTransfer=null;this.listOfIds=[];this.listOfCSFlag=[];this.listOfOrgFlag=[];this.listOfRespFlag=[];this.listOfError=[];this.listOfFailedIds=[];this.listOfIdsWithResult=[];this.isHiddenResponsibleSearch=true;this.isHiddenCollaborativeSpaceSearch=true;this.isHiddenOrganizationSearch=true;this.objectIds={};this.ctxObjectIds=[];this.transferOwnershipHistory=null;this.transferOwnershipSummary=null;this._parent(P);this.setSecurityContext(P.securityContext);this.caHeader={};this.SelectedInstance=[];if(this.options.transferType!=x.TransferCollabSpaceSoft){this._initUI()}},setSecurityContext:function(P){this.securityContext=P},onRefresh:function(){},_drop:function(Q){var R=this;if(typeof Q!="object"){Q=s.decode(Q)}if(Q){var T=Q.data;if(T){var S=T.items;var P=R.SelectedItems.slice();var U=false;if(S){S.forEach(function(X){var V=X.objectId;if(V){var W=X.displayName;if(!W){W=UWA.i18n("no name")}var Y=null;if(T.hasOwnProperty("urlIcon")){Y=T.urlIcon}P.push(new C({physicalId:V,name:W,urlIcon:Y}));U=true}else{R.setError({message:UWA.i18n("TOS_BadId")})}})}if(U===true){R._addData(P)}}}},_IsDisableApply:function(){if(this.searchWidget.getNewOwner().person==undefined&&this.searchWidgetProject.getNewOwner().collabSpace==undefined&&this.searchWidgetOrg.getNewOwner().organization==undefined){return true}if(this.searchWidget.getNewOwner().person==undefined&&this.searchWidget.container.searchInput.elements.content.value!==""){return true}if(this.searchWidgetProject.getNewOwner().collabSpace==undefined&&this.searchWidgetProject.container.searchInput.elements.content.value!==""){return true}if(this.searchWidgetOrg.getNewOwner().organization==undefined&&this.searchWidgetOrg.container.searchInput.elements.content.value!==""){return true}return false},_initUI:function(){var Y=this;var S=this.container=UWA.createElement("div",{name:M,"class":M+" "+Y.options.className});this.globalDiv=UWA.createElement("div",{"class":"TOS_GlobalContain"}).inject(S);this.ManageButtonDiv=UWA.createElement("table",{"class":"TOS_ManageButtonDiv",html:{}});Y.ManageButtonRight=UWA.createElement("td",{"class":"TOS_ManageButtonRight"});Y.ManageButtonLeft=UWA.createElement("td",{"class":"TOS_ManageButtonLeft"});Y.loadingArea=new v({visible:false});var ab=null;Y.boutonValid=new G({attributes:{title:UWA.i18n("")},name:"TopButtonValid",value:UWA.i18n("Apply"),className:"default medium TOS_buttonTop primary",disabled:true});ab=new G({attributes:{title:UWA.i18n("")},name:"TopButtonCancel",value:UWA.i18n("TOS_Cancel"),className:"default medium TOS_buttonTop"});Y.boutonValid.addEvents({onClick:function(){I.getInstance().getSecurityContext({onSuccess:function(af){ab.setValue(UWA.i18n("Close"));Y._prepareTransferOwnership(af);if(Y.options.oldClassName=="editProperties_TransferOwnershipPopup"){Y.previousSize=Y.container.getSize()}},onFailure:function(af){Y.setError(af)}});this.setDisabled(true)}});ab.addEvents({onClick:function(){if(Y.table!=null){Y.table.clearAllLine()}q.publish(b,{listId:[]});if(Y.transferOwnershipHistory){Y.transferOwnershipHistory.activeAutoRefresh(false)}Y.dispatchEvent("onCancel")}});Y.loadingArea.inject(Y.ManageButtonRight);Y.boutonValid.inject(Y.ManageButtonRight);if(this.options.setCloseButton!=false){ab.inject(Y.ManageButtonRight)}Y.ManageButtonLeft.inject(this.ManageButtonDiv);Y.ManageButtonRight.inject(this.ManageButtonDiv);if(Y.options.showTopBar===true){this.ManageButtonDiv.inject(Y.globalDiv)}this.mainDiv=UWA.createElement("div",{"class":"TOS_MainContain"}).inject(Y.globalDiv);Y.mainInterface=UWA.createElement("div",{"class":"TOS_MainInterface"}).inject(this.mainDiv).hide();UWA.createElement("div",{"class":"TOS_marginCorrector"}).inject(this.mainInterface);Y.mainLoading=UWA.createElement("div",{"class":"TOS_MainLoading"}).inject(this.mainDiv);Y.mainError=UWA.createElement("div",{"class":"TOS_MainError"}).inject(this.mainDiv).hide();Y.mainHistory=UWA.createElement("div",{"class":"TOS_MainHistory"}).inject(this.mainDiv).hide();Y.mainSummary=UWA.createElement("div",{"class":"TOS_MainSummary"}).inject(this.mainDiv).hide();Y.loadingArea32=new v({visible:true,className:"large"});Y.loadingArea32.inject(Y.mainLoading);if(n!=2||this.options.activeHistoryButton===true||this.options.activeSummaryButton===true){var Q=UWA.createElement("tr").inject(UWA.createElement("tbody").inject(UWA.createElement("table",{"class":"TOS_layoutTable"}).inject(Y.mainInterface)))}if(n!=2||this.options.activeHistoryButton===true){this.transferOwnershipHistory=new F({serverName:this.options.serverName,serverUri:this.options.serverUri,events:{onBack:function(){Y.displayMainInterfaceArea()},onError:function(af){Y.setError(af)}}});this.transferOwnershipHistory.inject(Y.mainHistory);this.historyButton=new UWA.createElement("a",{html:"&lsaquo;History","class":"TOS_showHistory",name:"TOS_historyButton",events:{click:function(af){Y.displayMainHistoryArea()}}});this.historyButton.inject(UWA.createElement("td",{"class":"TOS_HistoryCell"}).inject(Q))}if(n!=2||this.options.activeSummaryButton===true){this.transferOwnershipSummary=new i({serverName:this.options.serverName,serverUri:this.options.serverUri,events:{onBack:function(){Y.displayMainInterfaceArea();if(Y.previousSize){Y.dispatchEvent("onNewSize",Y.previousSize)}q.publish(b,{listId:[]});Y.onResize()},onError:function(af){Y.setError(af)},onStartSearch:function(){Y.displayMainLoadingArea();q.publish(b,{listId:[]})},onStopSearch:function(af){Y.displayMainSummaryArea();var ag=this;if(af!=null){af=s.decode(af);q.publish(b,{listId:af})}Y.boutonValid.hide();ab.setValue(UWA.i18n("Close"))},onChangeSize:function(){var af=this;setTimeout(function(){var ag=af.getOptimalSize();Y.dispatchEvent("onNewSize",ag);af.onResize()},0)},onUpdate:function(af){Y.container.setStyle("opacity","0.5");I.getInstance().getSecurityContext({onSuccess:function(ag){Y._prepareTransferOwnership(ag);Y.previousSize=Y.container.getSize()},onFailure:function(ag){Y.setError(ag)}})},}});this.transferOwnershipSummary.inject(Y.mainSummary)}if(n!=2||this.options.activeExpandWholeStructure===true){this.expandWholeStruct=new a({type:"checkbox",value:UWA.i18n("TOS_Expand"),className:"primary TOS_ExpandAllCB"});this.expandWholeStruct.inject(UWA.createElement("td").inject(Y.mainInterface))}Y.itemsArea=new UWA.createElement("span",{"class":"TOS_itemsList"});Y.itemsArea.inject(Y.mainInterface);this.itemListHasPriority=true;Y.titleSelectedItem=UWA.createElement("h5",{"class":"TOS_SelectedItemTitle",html:r,events:{click:function(){Y.itemListHasPriority=!Y.itemListHasPriority;Y.onResize()}}}).inject(Y.itemsArea);Y.tableItemsContainer=UWA.createElement("div",{"class":"container_of_table"}).inject(Y.itemsArea);Y.tableItems=this._createSelectedTable();Y.tableItems.inject(Y.tableItemsContainer);Y.table=null;if(this.options.transferType==x.TransferFull){Y.mainTableContainer=UWA.createElement("div",{"class":"container_of_table"}).inject(Y.mainInterface);Y.table=Y._createTable();Y.table.inject(Y.mainTableContainer)}Y.errorOverlay=new p(widget,Y.container,{className:"errorComponent_TransferOwnership"});UWA.createElement("div",{"class":"TOS_marginCorrector"}).inject(this.mainInterface);var R=UWA.i18n("TOS_TargetOwnership");Y.titleTargetOwnership=UWA.createElement("h5",{"class":"TOS_SelectedItemTitle",html:R}).inject(this.mainInterface);Y.titleTargetOwnership.hide();var W="auto";var V=Y.options.ForbiddenChar;var X="";var ac=w.TYPE_PERSON;if(this.options.activeFirstLineTable==true){ac=w.TYPE_FULL}switch(this.options.transferType){case x.TransferPerson:ac=w.TYPE_PERSON;break;case x.TransferCollabSpaceSoft:ac=w.TYPE_PROJECT;break;case x.TransferCollabSpace:ac=w.TYPE_PROJECT;break}var U={user:"",org:"",collabSpace:""};Y.searchWidgetOrg=A.getSearchWidget(A.FULL,{className:"searchPeople_TransferOwnership",ForbiddenChar:V,MaxNumber:"5",MaxSize:"300",position:W,serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:false,hint:UWA.i18n("Search Organization"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+w.TYPE_ORGANIZATION,type:w.TYPE_ORGANIZATION,dropdown:true,webParams:{getQueryParams:function(){return U}},events:{onValid:function(){var af=Y.searchWidgetOrg.getNewOwner();I.getInstance().getSecurityContext({onSuccess:function(ah){var ag=Y._getTransferDataForSearch();Y.transferPreCheck(ah,ag)},onFailure:function(ag){Y.setError(ag)}});if((Y.optionInstanceCB.isChecked())||(Y.optionReferenceCB.isChecked())){Y._ManageValidButton(true)}},onUnvalid:function(){if((Y.searchWidgetOrg.container.searchInput.elements.content.value.length>=3)||(Y.searchWidgetOrg.container.searchInput.elements.content.value.length==0)||(Y.searchWidgetOrg.container.searchInput.elements.content.value=="*")){var ag="organization";var af=Y.searchWidgetOrg.container.searchInput.elements.content.value;var ah=af;U.org=af;if(Y.searchWidget.listOwner!=undefined&&Y.searchWidget.listOwner.length>0&&Y.searchWidget.listOwner[0]["owner"]!=undefined&&Y.searchWidget.listOwner[0]["owner"]["person"]!=undefined&&Y.searchWidget.listOwner[0]["owner"]["person"]["personID"]!=undefined){U.user=Y.searchWidget.listOwner[0]["owner"]["person"]["personID"]}else{U.user=Y.searchWidget.lastSearch}U.collabSpace=Y.searchWidgetProject.container.searchInput.elements.content.value}if(Y._IsDisableApply()){Y._ManageValidButton(false)}else{Y._ManageValidButton(true)}},onError:function(af){Y.setError(af)}}});var Z=UWA.createElement("div",{"class":"TOS_SearchSection"});Y.searchWidgetOrg.inject(Z);Z.inject(Y.mainInterface);Y.searchWidgetOrg.hide();Y.searchWidgetProject=A.getSearchWidget(A.FULL,{className:"searchPeople_TransferOwnership",ForbiddenChar:V,MaxNumber:"5",MaxSize:"300",position:W,serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:false,hint:UWA.i18n("Search Collaborative Space"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+w.TYPE_PROJECT,type:w.TYPE_PROJECT,dropdown:true,webParams:{getQueryParams:function(){return U}},events:{onValid:function(){var af=Y.searchWidgetProject.getNewOwner();I.getInstance().getSecurityContext({onSuccess:function(ah){var ag=Y._getTransferDataForSearch();Y.transferPreCheck(ah,ag)},onFailure:function(ag){Y.setError(ag)}});if((Y.optionInstanceCB.isChecked())||(Y.optionReferenceCB.isChecked())){Y._ManageValidButton(true)}},onUnvalid:function(){if((Y.searchWidgetProject.container.searchInput.elements.content.value.length>=3)||(Y.searchWidgetProject.container.searchInput.elements.content.value.length==0)||(Y.searchWidgetProject.container.searchInput.elements.content.value=="*")){var ag="collabSpace";var af=Y.searchWidgetProject.container.searchInput.elements.content.value;U.collabSpace=af;U.org=Y.searchWidgetOrg.container.searchInput.elements.content.value;if(Y.searchWidget.listOwner!=undefined&&Y.searchWidget.listOwner.length>0&&Y.searchWidget.listOwner[0]["owner"]!=undefined&&Y.searchWidget.listOwner[0]["owner"]["person"]!=undefined&&Y.searchWidget.listOwner[0]["owner"]["person"]["personID"]!=undefined){U.user=Y.searchWidget.listOwner[0]["owner"]["person"]["personID"]}else{U.user=Y.searchWidget.lastSearch}}if(Y._IsDisableApply()){Y._ManageValidButton(false)}else{Y._ManageValidButton(true)}},onError:function(af){Y.setError(af)}}});var aa=UWA.createElement("div",{"class":"TOS_SearchSection"});Y.searchWidgetProject.inject(aa);aa.inject(Y.mainInterface);Y.searchWidgetProject.hide();Y.searchWidget=A.getSearchWidget(A.FULL,{className:"searchPeople_TransferOwnership",ForbiddenChar:V,MaxNumber:"5",MaxSize:"300",position:W,serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:false,hint:UWA.i18n("Search Responsible"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+w.TYPE_PERSON,type:ac,webParams:{getQueryParams:function(){return U}},events:{onValid:function(){var af=Y.searchWidget.getNewOwner();I.getInstance().getSecurityContext({onSuccess:function(ah){var ag=Y._getTransferDataForSearch();Y.transferPreCheck(ah,ag)},onFailure:function(ag){Y.setError(ag)}});if((Y.optionInstanceCB.isChecked())||(Y.optionReferenceCB.isChecked())){Y._ManageValidButton(true)}},onUnvalid:function(){if((Y.searchWidget.container.searchInput.elements.content.value.length>=3)||(Y.searchWidget.container.searchInput.elements.content.value.length==0)||(Y.searchWidget.container.searchInput.elements.content.value=="*")){var ag="user";var af=Y.searchWidget.container.searchInput.elements.content.value;U.user=af;U.org=Y.searchWidgetOrg.container.searchInput.elements.content.value;U.collabSpace=Y.searchWidgetProject.container.searchInput.elements.content.value}if(Y._IsDisableApply()){Y._ManageValidButton(false)}else{Y._ManageValidButton(true)}},onError:function(af){Y.setError(af)}}});var T=UWA.createElement("div",{"class":"TOS_SearchSection"});Y.searchWidget.inject(T);T.inject(Y.mainInterface);Y.searchWidget.hide();var P=UWA.i18n("TOS_TitleComment");Y.titleOwnership=UWA.createElement("h5",{"class":"TOS_SelectedItemTitle",html:P}).inject(this.mainInterface);var ae=UWA.createElement("div",{"class":"TOS_CommentBox"});Y.textArea=new l({multiline:true,placeholder:UWA.i18n("TOS_Comment"),rows:2,ForbiddenChar:V});Y.textArea.inject(ae);ae.inject(Y.mainInterface);if(this.options.transferType==x.TransferFull){var ad=UWA.createElement("Div",{"class":"TOS_AdvAdminOption"}).inject(Y.mainInterface);this.optionInstanceCB=new a({type:"checkbox",value:UWA.i18n("TOS_InstanceCB"),className:"primary TOS_instanceButton",events:{onChange:function(){if(!(this.isChecked())&&!(Y.optionReferenceCB.isChecked())){Y._ManageValidButton(false)}}}});this.optionInstanceCB.inject(ad);this.optionInstanceCB.hide();this.optionReferenceCB=new a({type:"checkbox",value:UWA.i18n("TOS_ReferenceCB"),className:"primary TOS_ReferenceButton",checked:true,events:{onChange:function(){if(!(this.isChecked())&&!(Y.optionInstanceCB.isChecked())){Y._ManageValidButton(false)}}}});this.optionReferenceCB.inject(ad);this.optionReferenceCB.hide()}},_canUserChangePOV_ChecksWithUserQueryOnResult:function(R,W){var U=this;var X=[];if(W=="user"){var T=[];for(var S=0;S<R.results.length;S++){T.push({personID:R.results[S]["personID"],personFullName:R.results[S]["personFullName"],personLastName:R.results[S]["personLastName"],personFirstName:R.results[S]["personFirstName"]})}var P={persons:T};this.searchWidget.setData(P)}else{if(W=="collabSpace"){var V=[];for(var S=0;S<R.results.length;S++){V.push({collabSpaceID:R.results[S]["CollaborativeSpace"]})}var Z={collabSpaces:V};this.searchWidgetProject.setData(Z)}else{if(W=="organization"){var Y=[];for(var S=0;S<R.results.length;S++){Y.push({orgID:R.results[S]["Organization"]})}var Q={organizations:Y};this.searchWidgetOrg.setData(Q)}}}U.hideLoadingArea()},formatData:function(T){var Q={};if(T){var Q={person:[],securityContext:[],collabSpace:[],organization:[]};var S={persons:"person",collabSpaces:"collabSpace",organizations:"organization",securityContexts:"securityContext"};for(var R in S){if(T[R]){var P=S[R];T[R].forEach(function(U){var V={};V[P]=U;Q[P].push(V)})}}}return Q},transferPreCheck:function(T,U){this.dispatchEvent("onTransferStart");var S=this;var W="";var P=this.options.serverName;var R=this.options.serverUri;var V=this.options.launchTransfer;var Q=this.caHeader;m.get3DSpaceUrlAsync({onComplete:function(Z){var ab="/resources/v1/collabServices/base/transferOwnership/transferOwnershipPreCheck";var aa={Accept:"application/json",};aa["content-type"]="application/json";aa.SecurityContext=S.securityContext;if(S.caHeader){if(S.caHeader["DS-Change-Authoring-Context"]){aa["DS-Change-Authoring-Context"]=S.caHeader["DS-Change-Authoring-Context"]}if(S.caHeader["DS-Configuration-Authoring-Context"]){aa["DS-Configuration-Authoring-Context"]=S.caHeader["DS-Configuration-Authoring-Context"]}}var ae=S.parseDataForPreCheck(U);W=m.getRealPath("assets/transferOwnership.json",widget);var af="";var ac="GET";var ag="";var Y="admin=true";if(n==2){W=Z+ab+"?"+Y;ag="passport";ac="PUT";af=s.encode({requests:ae})}var X={requests:ae};S.dispatchEvent("onValidation",X);if(V===true){S.displayLoadingArea();aa["Accept-Language"]=widget.lang;var ad=m.getTenantID();if(ad){W+="&tenant="+ad}j.authenticatedRequest(W,{type:"json",method:ac,proxy:ag,headers:aa,data:af,timeout:3600000,onComplete:function(ah){S._preCheckResult(ah)},onFailure:function(ah,ai,aj){S._onFailure(ah,ai,aj)},onTimeout:function(ah){S._onTimeout()}})}}})},_preCheckResult:function(Y){var W=this;var X=[];var U=[];if(Y.results.length>0){for(var V=0;V<Y.results.length;V++){if((Y.results[V]["TransferFlag"]!=null)){X.push(Y.results[V]["TransferFlag"])}if((Y.results[V]["ErrorList"]!=null)){var aa={Error:Y.results[V]["ErrorList"],physicalId:Y.results[V]["physicalId"]};U.push(aa)}}var P=UWA.createElement("div",{"class":"syc-red-circle-symbol"});var R=UWA.createElement("div",{"class":"syc-cross-symbol"});var T=this.table.getAllLine();var Z=T.length;for(var S=0;S<Z;S++){if(T[S]!=undefined){for(var Q=0;Q<U.length;Q++){if((U[Q]["physicalId"]==T[S].getElementsByClassName("TOS_Id")[0].innerHTML)&&U[Q]["Error"]!="success"){this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();T[S].getElementsByClassName("Symbol")[0].appendChild(P);T[S].getElementsByClassName("Symbol")[0].appendChild(R);T[S].getElementsByClassName("Result")[0].innerHTML=U[Q]["Error"];this.listOfFailedIds.push(T[S].getElementsByClassName("TOS_Id")[0].innerHTML)}}}}}W.hideLoadingArea()},parseDataForPreCheck:function(P){var Q=[];if(null!=P&&P.hasOwnProperty("owner")&&null!=P.owner&&P.owner.hasOwnProperty("person")&&P.owner.person!=""){Q.push(P.owner.person.personID)}else{Q.push("")}if(null!=P&&P.hasOwnProperty("owner")&&null!=P.owner&&P.owner.hasOwnProperty("collabSpace")&&P.owner.collabSpace!=""){Q.push(P.owner.collabSpace.collabSpaceID)}else{Q.push("")}if(null!=P&&P.hasOwnProperty("owner")&&null!=P.owner&&P.owner.hasOwnProperty("organization")&&P.owner.organization!=""){Q.push(P.owner.organization.orgID)}else{Q.push("")}P.tosBusinessObject.forEach(function(R){Q.push(R.id)});if(P.hasOwnProperty("tosRelationObject")){P.tosRelationObject.forEach(function(R){Q.push(R.id)})}return Q},destroy:function(){if(this.searchWidget){this.searchWidget.destroy()}if(this.searchWidgetProject){this.searchWidgetProject.destroy()}if(this.searchWidgetOrg){this.searchWidgetOrg.destroy()}this._parent()},actionOnMove:function(){if(this.searchWidget){this.searchWidget.actionOnMove()}if(this.searchWidgetProject){this.searchWidgetProject.actionOnMove()}if(this.searchWidgetOrg){this.searchWidgetOrg.actionOnMove()}},getcanUserChangePOV:function(U){var T=this;var S="GET";var Q="/resources/v1/collabServices/base/transferOwnership/canUserChangePOV";var P=this.options.serverName;var R=this.options.serverUri;m.get3DSpaceUrlAsync({onComplete:function(W){var X={"content-type":"application/json",Accept:"application/json",};var V=m.getRealPath("assets/summary.json",widget);var Z="GET";var ad="";var Y="";var ab=T.parseDataForCanUserChangePOV(U);if(n==2){V=W+Q;ad="passport";Z="PUT";var ac=s.encode({requests:ab})}T.displayLoadingArea();var aa=m.getTenantID();if(aa){V+="?tenant="+aa}X["Accept-Language"]=widget.lang;X.SecurityContext=T.securityContext;j.authenticatedRequest(V,{type:"json",method:Z,proxy:ad,headers:X,data:ac,timeout:3600000,onComplete:function(ae){T._listcanUserChangePOV(ae)},onFailure:function(ae,af,ag){T._onFailure(ae,af,ag)},onTimeout:function(ae){T._onTimeout()}})}})},parseDataForCanUserChangePOV:function(R){var Q=[];for(var P=0;P<R.length;P++){Q.push(R[P]["physicalId"])}return Q},_listcanUserChangePOV:function(P){var Z=[];var U=[];var R=[];var af=[];var T=this;var S=true;var aa=true;var aj=true;var X=0;var ae=0;var Y=0;var V=0;if(P.results.length>0){for(var ag=0;ag<P.results.length;ag++){if((P.results[ag]["CSTransferFlag"]!=null)){var ah={physicalId:P.results[ag]["physicalId"],CSTransferFlag:P.results[ag]["CSTransferFlag"]};this.listOfCSFlag.push(ah);var ak={objectID:P.results[ag]["physicalId"]};af.push(ak);if((P.results[ag]["CSTransferFlag"]=="OK")&&(ae==0)){this.searchWidgetProject.show();this.titleTargetOwnership.show();S=false;this.isHiddenCollaborativeSpaceSearch=false;ae=1}}if((P.results[ag]["OrgTransferFlag"]!=null)){var ah={physicalId:P.results[ag]["physicalId"],OrgTransferFlag:P.results[ag]["OrgTransferFlag"]};this.listOfOrgFlag.push(ah);var ak={objectID:P.results[ag]["physicalId"]};R.push(ak);if((P.results[ag]["OrgTransferFlag"]=="OK")&&(Y==0)){this.searchWidgetOrg.show();this.titleTargetOwnership.show();aa=false;this.isHiddenOrganizationSearch=false;Y=1}}if((P.results[ag]["RespTransferFlag"]!=null)){var ah={physicalId:P.results[ag]["physicalId"],RespTransferFlag:P.results[ag]["RespTransferFlag"]};this.listOfRespFlag.push(ah);var ak={objectID:P.results[ag]["physicalId"]};U.push(ak);if((P.results[ag]["RespTransferFlag"]=="OK")&&(V==0)){this.searchWidget.show();this.titleTargetOwnership.show();aj=false;this.isHiddenResponsibleSearch=false;V=1}}if((P.results[ag]["ErrorList"]!=null)){var ah={physicalId:P.results[ag]["physicalId"],Error:P.results[ag]["ErrorList"]};this.listOfError.push(ah)}}this.searchWidget.setSelectedItemList(U);this.searchWidgetProject.setSelectedItemList(af);this.searchWidgetOrg.setSelectedItemList(R);if(aj&&aa&&S){this.textArea.disable()}if((aj==false)&&(aa==false)&&(S==true)){this.searchWidget.container.container.offsetParent.setStyle("width","45%");this.searchWidgetProject.container.container.parentNode.setStyle("width","0%");this.searchWidgetProject.container.container.parentNode.setStyle("height","0%");this.searchWidgetOrg.container.container.offsetParent.setStyle("width","45%")}if((S==false)&&(aa==false)&&(aj==true)){this.searchWidgetProject.container.container.offsetParent.setStyle("width","45%");this.searchWidget.container.container.parentNode.setStyle("width","0%");this.searchWidget.container.container.parentNode.setStyle("height","0%");this.searchWidgetOrg.container.container.offsetParent.setStyle("width","45%")}if((aj==false)&&(S==false)&&(aa==true)){this.searchWidgetProject.container.container.offsetParent.setStyle("width","45%");this.searchWidgetOrg.container.container.parentNode.setStyle("width","0%");this.searchWidgetOrg.container.container.parentNode.setStyle("height","0%");this.searchWidget.container.container.offsetParent.setStyle("width","45%")}if((aj==false)&&aa&&S){this.searchWidget.container.container.offsetParent.setStyle("width","100%");this.searchWidgetProject.container.container.parentNode.setStyle("width","0%");this.searchWidgetProject.container.container.parentNode.setStyle("height","0%");this.searchWidgetOrg.container.container.parentNode.setStyle("width","0%")}if((aa==false)&&aj&&S){this.searchWidgetOrg.container.container.offsetParent.setStyle("width","100%");this.searchWidgetProject.container.container.parentNode.setStyle("width","0%");this.searchWidget.container.container.parentNode.setStyle("width","0%");this.searchWidgetProject.container.container.parentNode.setStyle("height","0%");this.searchWidget.container.container.parentNode.setStyle("height","0%")}if((S==false)&&aa&&aj){this.searchWidgetProject.container.container.offsetParent.setStyle("width","100%");this.searchWidget.container.container.parentNode.setStyle("width","0%");this.searchWidgetOrg.container.container.parentNode.setStyle("width","0%");this.searchWidget.container.container.parentNode.setStyle("height","0%");this.searchWidgetOrg.container.container.parentNode.setStyle("height","0%")}}if(this.listOfError.length===0){return}var Q=this.table.getAllLine();for(var ad=0;ad<Q.length;ad++){var W=Q[ad];if(W!=undefined){for(var ac=0;ac<this.listOfError.length;ac++){if((this.listOfError[ac]["physicalId"]==W.getElementsByClassName("TOS_Id")[0].innerHTML)&&this.listOfError[ac]["Error"]!="success"){this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();var ab=UWA.createElement("div",{"class":"syc-red-circle-symbol"});W.getElementsByClassName("Symbol")[0].appendChild(ab);var ai=UWA.createElement("div",{"class":"syc-cross-symbol"});W.getElementsByClassName("Symbol")[0].appendChild(ai);W.getElementsByClassName("Result")[0].innerHTML=this.listOfError[ac]["Error"];this.listOfFailedIds.push(W.getElementsByClassName("TOS_Id")[0].innerHTML)}}}}T.hideLoadingArea()},_getEmbeddedComponentList:function(S){var T=this;var V="";var P=this.options.serverName;var R=this.options.serverUri;var U=this.options.launchTransfer;var Q=this.caHeader;m.get3DSpaceUrlAsync({onComplete:function(Y){var aa="/resources/v1/collabServices/base/transferOwnership/getEmbeddedComponentDataList";var Z={Accept:"application/json",};Z["content-type"]="application/json";Z.SecurityContext=T.securityContext;if(T.caHeader){if(T.caHeader["DS-Change-Authoring-Context"]){Z["DS-Change-Authoring-Context"]=T.caHeader["DS-Change-Authoring-Context"]}if(T.caHeader["DS-Configuration-Authoring-Context"]){Z["DS-Configuration-Authoring-Context"]=T.caHeader["DS-Configuration-Authoring-Context"]}}var ad=T.parseDataForEC(S);V=m.getRealPath("assets/transferOwnership.json",widget);var ae="";var ab="GET";var af="";var X="admin=true";if(n==2){V=Y+aa+"?"+X;af="passport";ab="PUT";ae=s.encode({requests:ad})}var W={requests:ad};T.dispatchEvent("onValidation",W);if(U===true){T.displayLoadingArea();Z["Accept-Language"]=widget.lang;var ac=m.getTenantID();if(ac){V+="&tenant="+ac}j.authenticatedRequest(V,{type:"json",method:ab,proxy:af,headers:Z,data:ae,timeout:3600000,onComplete:function(ag){T._listEmbeddedComponent(ag,S)},onFailure:function(ag,ah,ai){T._onFailure(ag,ah,ai)},onTimeout:function(ag){T._onTimeout()}})}}})},parseDataForEC:function(Q){var S=[];for(var P=0;P<Q.length;P++){if(Q[P].physicalId!=undefined){var R={id:Q[P].physicalId,category:Q[P].category};S.push(Q[P].physicalId)}}return S},_listEmbeddedComponent:function(Q,T){var W=[];var R=JSON.parse("[]");var S=this.table.getAllLine();var ac=S.length;for(aa=0;aa<ac;aa++){if(S[aa]!=undefined){R[S[aa].getElementsByClassName("TOS_Id")[0].innerHTML]=true}}var P=JSON.parse("[]");jMapCtx=JSON.parse("[]");if(Q.results.length>0){for(var ad=0;ad<Q.results.length;ad++){for(var ab=0;ab<T.length;ab++){if((Q.results[ad]["ObjectId"]==T[ab].physicalId)&&(Q.results[ad]["ContextInformation"]==true)){if(T[ad].responsibleName!=null||T[ad].responsibleName!=undefined||T[ad].name!=null||T[ad].name!=undefined||T[ad].Revision!=null||T[ad].Revision!=undefined){this.ctxObjectIds.push({mainRevisionId:T[ab].physicalId,id:T[ab].physicalId,org:Q.results[ad]["organization"],project:Q.results[ad]["collabSpace"]});var ae={id:Q.results[ad]["ObjectId"],category:T[ab].category,mainRevisionId:Q.results[ad]["ObjectId"]};var U=[];U.push(ae);this._setListOfIds(U,Q.results[ad]["ObjectId"]);var V=[];var af={TOS_Id:T[ab].physicalId,Symbol:"",Title:T[ab].name,Revision:T[ab].Revision,Organization:Q.results[ad]["organization"],CollaborativeSpace:Q.results[ad]["collabSpace"],Responsible:T[ab].responsibleName,Result:""};if(R[T[ab].physicalId]!==true){V.push(af)}this.table.AddDatasInTable(V)}}else{if((Q.results[ad]["ObjectId"]==T[ab].physicalId)&&(Q.results[ad]["ContextInformation"]==false)){if(Q.results[ad]["ECDataNotToTransfer"]==false){var ae={id:Q.results[ad]["ObjectId"],category:T[ab].category,mainRevisionId:Q.results[ad]["ObjectId"]};var U=[];U.push(ae);this._setListOfIds(U,Q.results[ad]["ObjectId"])}}else{if((Q.results[ad]["ObjectId"]==T[ab].physicalId)&&(Q.results[ad]["ContextInformation"]==false)){if(Q.results[ad]["ECDataNotToTransfer"]==true){var V=[];var af={TOS_Id:T[ab].physicalId,Symbol:"",Title:T[ab].name,Revision:T[ab].Revision,Organization:Q.results[ad]["organization"],CollaborativeSpace:Q.results[ad]["collabSpace"],Responsible:T[ab].responsibleName,Result:""};var ah=false;if(R[T[ab].physicalId]!==true){V.push(af)}this.table.AddDatasInTable(V)}}}}}}}else{for(var ad=0;ad<T.length;ad++){if(T[ad].physicalId!=undefined){var ae={id:T[ad].physicalId,category:T[ad].category,mainRevisionId:T[ad].physicalId};if(T[ad].type=="Workspace"||T[ad].type=="Workspace Vault"||T[ad].type=="Folder"){W.push(ae);this._setListOfIds(W,"")}else{var X=[];X.push(ae);this._setListOfIds(X,T[ad].physicalId)}}}}this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].hide();for(var aa=0;aa<ac;aa++){if(S[aa]!=undefined){for(var Z=0;Z<this.listOfError.length;Z++){if((this.listOfError[Z]["physicalId"]==S[aa].getElementsByClassName("TOS_Id")[0].innerHTML)&&this.listOfError[Z]["Error"]!="success"){this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();var Y=UWA.createElement("div",{"class":"syc-red-circle-symbol"});S[aa].getElementsByClassName("Symbol")[0].appendChild(Y);var ag=UWA.createElement("div",{"class":"syc-cross-symbol"});S[aa].getElementsByClassName("Symbol")[0].appendChild(ag);S[aa].getElementsByClassName("Result")[0].innerHTML=this.listOfError[Z]["Error"];this.listOfFailedIds.push(S[aa].getElementsByClassName("TOS_Id")[0].innerHTML)}}}}},_getCtxObjectIds:function(P){this._getObjectCtxList(P);return},_getCtxObjectIdsPCS:function(P){this._getObjectCtxListPCS(P);return},_setListOfIds:function(R,S){for(var Q=0;Q<R.length;Q++){if(R[Q]["id"]!=S){var P=[];P.push(R[Q]);this._getCtxObjectIds(P)}}this.listOfIds.push(R)},_getListOfIds:function(){return this.listOfIds},_getObjectCtxList:function(S){var T=this;var V="";var P=this.options.serverName;var R=this.options.serverUri;var U=this.options.launchTransfer;var Q=this.caHeader;m.get3DSpaceUrlAsync({onComplete:function(Y){var aa="/resources/v1/collabServices/base/transferOwnership/getContext";var Z={Accept:"application/json",};Z["content-type"]="application/json";Z.SecurityContext=T.securityContext;if(T.caHeader){if(T.caHeader["DS-Change-Authoring-Context"]){Z["DS-Change-Authoring-Context"]=T.caHeader["DS-Change-Authoring-Context"]}if(T.caHeader["DS-Configuration-Authoring-Context"]){Z["DS-Configuration-Authoring-Context"]=T.caHeader["DS-Configuration-Authoring-Context"]}}var ad=T.parseDataForGetContext(S);V=m.getRealPath("assets/transferOwnership.json",widget);var ae="";var ab="GET";var af="";var X="admin=true";if(n==2){V=Y+aa+"?"+X;af="passport";ab="PUT";ae=s.encode({requests:ad})}var W={requests:ad};T.dispatchEvent("onValidation",W);if(U===true){T.displayLoadingArea();Z["Accept-Language"]=widget.lang;var ac=m.getTenantID();if(ac){V+="&tenant="+ac}j.authenticatedRequest(V,{type:"json",method:ab,proxy:af,headers:Z,data:ae,timeout:3600000,onComplete:function(ag){T._listObjectContext(ag,S)},onFailure:function(ag,ah,ai){T._onFailure(ag,ah,ai)},onTimeout:function(ag){T._onTimeout()}})}}})},parseDataForGetContext:function(Q){var R=[];for(var P=0;P<Q.length;P++){if(Q[P]["id"]!=undefined){R.push(Q[P]["id"])}}return R},_listObjectContext:function(U,X){if(U.results){for(var V=0;V<U.results.length;V++){this.ctxObjectIds.push({mainRevisionId:U.results[V]["objectId"],id:U.results[V]["objectId"],org:U.results[V]["org"],project:U.results[V]["collab"]});var Z="";var Y="";var Q="";Z=U.results[V]["name"];Y=U.results[V]["revision"];Q=U.results[V]["owner"];if(Z==null){Z=""}if(Y==null){Y=""}if(Q==null){Q=""}var ab=[];var W={TOS_Id:U.results[V]["objectId"],Symbol:"",Title:Z,Revision:Y,Organization:U.results[V]["org"],CollaborativeSpace:U.results[V]["collab"],Responsible:Q,Result:""};var aa=false;for(var T=0;T<this.table.getAllLine().length;T++){if(this.table.getAllLine()[T]!=undefined){if(this.table.getAllLine()[T].getElementsByClassName("TOS_Id")[0].innerHTML==U.results[V]["objectId"]){aa=true}}}if(aa==false){ab.push(W)}this.table.AddDatasInTable(ab);this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].hide();for(var T=0;T<this.table.getAllLine().length;T++){if(this.table.getAllLine()[T]!=undefined){for(var S=0;S<this.listOfError.length;S++){if((this.listOfError[S]["physicalId"]==this.table.getAllLine()[T].getElementsByClassName("TOS_Id")[0].innerHTML)&&this.listOfError[S]["Error"]!="success"){this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();var P=UWA.createElement("div",{"class":"syc-red-circle-symbol"});this.table.getAllLine()[T].getElementsByClassName("Symbol")[0].appendChild(P);var R=UWA.createElement("div",{"class":"syc-cross-symbol"});this.table.getAllLine()[T].getElementsByClassName("Symbol")[0].appendChild(R);this.table.getAllLine()[T].getElementsByClassName("Result")[0].innerHTML=this.listOfError[S]["Error"];this.listOfFailedIds.push(this.table.getAllLine()[T].getElementsByClassName("TOS_Id")[0].innerHTML)}}}}}}},_getObjectCtxListPCS:function(S){var T=this;var V="";var P=this.options.serverName;var R=this.options.serverUri;var U=this.options.launchTransfer;var Q=this.caHeader;m.get3DSpaceUrlAsync({onComplete:function(Y){var aa="/resources/v1/collabServices/base/transferOwnership/getContextPCS";var Z={Accept:"application/json",};Z["content-type"]="application/json";Z.SecurityContext=T.securityContext;if(T.caHeader){if(T.caHeader["DS-Change-Authoring-Context"]){Z["DS-Change-Authoring-Context"]=T.caHeader["DS-Change-Authoring-Context"]}if(T.caHeader["DS-Configuration-Authoring-Context"]){Z["DS-Configuration-Authoring-Context"]=T.caHeader["DS-Configuration-Authoring-Context"]}}var ad=T.parseDataForGetContext(S);V=m.getRealPath("assets/transferOwnership.json",widget);var ae="";var ab="GET";var af="";var X="admin=true";if(n==2){V=Y+aa+"?"+X;af="passport";ab="PUT";ae=s.encode({requests:ad})}var W={requests:ad};T.dispatchEvent("onValidation",W);if(U===true){T.displayLoadingArea();Z["Accept-Language"]=widget.lang;var ac=m.getTenantID();if(ac){V+="&tenant="+ac}j.authenticatedRequest(V,{type:"json",method:ab,proxy:af,headers:Z,data:ae,timeout:3600000,onComplete:function(ag){T._listObjectContextPCS(ag,S)},onFailure:function(ag,ah,ai){T._onFailure(ag,ah,ai)},onTimeout:function(ag){T._onTimeout()}})}}})},_listObjectContextPCS:function(Q,Z){if(!Q.results){return}var ag,ae,ad,ac;var P=JSON.parse("[]");for(ae=0;ae<Q.results.length;ae++){var R=Q.results[ae]["objectId"];P[R]=ae}var T=JSON.parse("[]");var U=this.table.getAllLine();var af=U.length;for(ad=0;ad<af;ad++){if(U[ad]!=undefined){T[U[ad].getElementsByClassName("TOS_Id")[0].innerHTML]=true}}var W=[];for(ag=0;ag<Z.length;ag++){ae=P[(Z[ag]["id"])];if(ae!=undefined&&ae!=null){this.ctxObjectIds.push({mainRevisionId:Z[ag]["mainRevisionId"],id:Z[ag]["id"],org:Q.results[ae]["org"],project:Q.results[ae]["collab"]});var Y=UWA.createElement("img",{src:Z[ag].urlIcon});var X=UWA.createElement("div",{text:Z[ag]["name"]});var aj=UWA.createElement("div",{"class":"TitleDiv"});aj.setStyle("display","grid");aj.setStyle("grid-auto-flow","column");aj.appendChild(Y);aj.appendChild(X);var al=Z[ag]["name"];if(T[Z[ag]["mainRevisionId"]]!=true){var ai={TOS_Id:Z[ag]["mainRevisionId"],Symbol:"",Title:aj,Revision:Z[ag]["Revision"],Organization:Q.results[ae]["org"],CollaborativeSpace:Q.results[ae]["collab"],Responsible:Z[ag]["responsibleName"],Result:""};W.push(ai);T[Z[ag]["mainRevisionId"]]}}}this.table.AddDatasInTable(W);if(this.listOfError.length===0){return}this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].hide();var ad,ac;var V=this.table.getAllLine();var aa=V.length;var S=JSON.parse("[]");for(ad=0;ad<aa;ad++){S[V[ad].getElementsByClassName("TOS_Id")[0].innerHTML]=ad}for(ac=0;ac<this.listOfError.length;ac++){if(this.listOfError[ac]["Error"]!="success"){ad=S[this.listOfError[ac]["physicalId"]];if(ad!=undefined){var ah=V[ad];this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();var ab=UWA.createElement("div",{"class":"syc-red-circle-symbol"});var ak=UWA.createElement("div",{"class":"syc-cross-symbol"});ah.getElementsByClassName("Symbol")[0].appendChild(ab);ah.getElementsByClassName("Symbol")[0].appendChild(ak);ah.getElementsByClassName("Result")[0].innerHTML=this.listOfError[ac]["Error"];this.listOfFailedIds.push(ah.getElementsByClassName("TOS_Id")[0].innerHTML)}}}},publicTransferOwnership:function(aa){var U=this;var V=new e(aa);var X=V.getPhysicalId();if(X==""){U.dispatchEvent("onInitError","fail objectId");return}var P=V.getType();if(P==""){U.dispatchEvent("onInitError","fail objectType");return}var Y=V.getTitle();if(Y==""){U.dispatchEvent("onInitError","fail displayName");return}var T=V.getContext();if(T==""){U.dispatchEvent("onInitError","fail contextId");return}var Z=V.getTargetSpace();if(Z==""){U.dispatchEvent("onInitError","fail targetCollabSpace");return}var R=V.getCategory();if(R==""){U.dispatchEvent("onInitError","fail targetCollabSpace");return}var Q={collabSpace:{collabSpaceID:Z}};var S=[];S.push({id:X,category:R});var W={tosBusinessObject:S,owner:Q,options:{expandAll:false,expandFolder:true,expandSubFolder:true,selectReference:true,selectInstance:false}};this.currentTransfer=W},_parseForGenericService:function(S){var R=true;var P=[];if((S.length>0)&&(S[0].owner!=undefined)){if(S[0].owner.hasOwnProperty("person")&&S[0].owner.person!=""){P.push({op:"replace",path:"owner",value:S[0].owner.person.personID})}if(S[0].owner.hasOwnProperty("organization")&&S[0].owner.organization!=""){P.push({op:"replace",path:"organization",value:S[0].owner.organization.orgID})}if(S[0].owner.hasOwnProperty("collabSpace")&&S[0].owner.collabSpace!=""){P.push({op:"replace",path:"project",value:S[0].owner.collabSpace.collabSpaceID})}}P.push({op:"replace",path:"TOSComment",value:this.textArea.elements.container.value});var T=[];for(var Q=0;Q<S.length;Q++){S[Q].tosBusinessObject.forEach(function(U){var W="";if(U.hasOwnProperty("category")){W=U.category}if(W==="Class"){W="bus"}var V={method:"PATCH",path:"model/"+W+"/"+U.id,body:P};if(S[Q].options){V.transferParams=S[Q].options}T.push(V)});if(S[Q].hasOwnProperty("tosRelationObject")){S[Q].tosRelationObject.forEach(function(U){var W="rel";var V={method:"PATCH",path:"model/"+W+"/"+U.id,body:P};if(S[Q].options){V.transferParams=S[Q].options}T.push(V)})}}return T},_getTransferData:function(){var X=null;if(x.TransferCollabSpaceSoft==this.options.transferType){X=this.currentTransfer}else{var P=s.decode(s.encode(this.searchWidget.getNewOwner()));var Q=s.decode(s.encode(this.searchWidgetProject.getNewOwner()));var V=s.decode(s.encode(this.searchWidgetOrg.getNewOwner()));var ab="";var Y="";if((!V.hasOwnProperty("organization"))||(!Q.hasOwnProperty("collabSpace"))){for(var ae=0;ae<this.ctxObjectIds.length;ae++){ab=this.ctxObjectIds[ae]["org"];Y=this.ctxObjectIds[ae]["project"]}}if(V.hasOwnProperty("organization")){P.organization={orgID:V.organization.orgID}}if(Q.hasOwnProperty("collabSpace")){P.collabSpace={collabSpaceID:Q.collabSpace.collabSpaceID}}if(P.hasOwnProperty("person")){P.person.personID=P.person.personID.replace(/_PRJ$/,"")}var U=[];var W=this;if(this.options.oldClassName=="editProperties_TransferOwnershipPopup"){this.SelectedItems.forEach(function(al,ak){U.push({id:al.getPhysicalId(),category:al.getCategory()})})}else{var ad=[];var ac=[];var R=[];var S=[];var aj=[];ad=this._getListOfIds();for(var ag=0;ag<ad.length;ag++){for(var af=0;af<ad[ag].length;af++){U.push({id:ad[ag][af]["id"],category:ad[ag][af]["category"]})}}}if((this.optionInstanceCB.isChecked()==true)&&(this.optionReferenceCB.isChecked()==true)){for(var ag=0;ag<this.SelectedInstance.length;ag++){U.push({id:this.SelectedInstance[ag].instanceId,category:this.SelectedInstance[ag].category})}}if((this.optionInstanceCB.isChecked()==true)&&(this.optionReferenceCB.isChecked()==false)){U=[];for(var ag=0;ag<this.SelectedInstance.length;ag++){U.push({id:this.SelectedInstance[ag].instanceId,category:this.SelectedInstance[ag].category})}}var T=false;if(this.expandWholeStruct){T=this.expandWholeStruct.isChecked()}var ai=true;if(this.optionReferenceCB!=null){ai=this.optionReferenceCB.isChecked()}var ah=false;if(this.optionInstanceCB!=null){ah=this.optionInstanceCB.isChecked()}var aa=false;if(this.expandFolder){aa=this.expandFolder.isChecked()}var Z=false;if(this.expandSubFolder){Z=this.expandSubFolder.isChecked()}U=this._removeDuplicateItemsToMove(U);U=this._removeFailedIds(U);X={tosBusinessObject:U,owner:P,options:{expandAll:T,expandFolder:aa,expandSubFolder:Z,selectReference:ai,selectInstance:ah}};if(U.length==0){this.boutonValid.setDisabled(true);X=""}}return X},_getTransferDataForSearch:function(){var aa=null;if(x.TransferCollabSpaceSoft==this.options.transferType){aa=this.currentTransfer}else{var P=s.decode(s.encode(this.searchWidget.getNewOwner()));var Q=s.decode(s.encode(this.searchWidgetProject.getNewOwner()));var Y=s.decode(s.encode(this.searchWidgetOrg.getNewOwner()));var af="";var ab="";if((!Y.hasOwnProperty("organization"))||(!Q.hasOwnProperty("collabSpace"))){for(var aj=0;aj<this.ctxObjectIds.length;aj++){if(this.ctxObjectIds[aj]["id"]==this.ctxObjectIds[aj]["mainRevisionId"]){af=this.ctxObjectIds[aj]["org"];ab=this.ctxObjectIds[aj]["project"]}}}if(Y.hasOwnProperty("organization")){P.organization={orgID:Y.organization.orgID}}if(Q.hasOwnProperty("collabSpace")){P.collabSpace={collabSpaceID:Q.collabSpace.collabSpaceID}}if(P.hasOwnProperty("person")){P.person.personID=P.person.personID.replace(/_PRJ$/,"")}var X=[];var Z=this;if(this.options.oldClassName=="editProperties_TransferOwnershipPopup"){this.SelectedItems.forEach(function(aw,av){X.push({id:aw.getPhysicalId(),category:aw.getCategory()})})}else{var ah=[];var ag=[];var S=[];var U=[];var au=[];ah=this._getListOfIds();for(var aj=0;aj<this.ctxObjectIds.length;aj++){if((P.hasOwnProperty("orgID"))&&(P.hasOwnProperty("collabSpaceID"))){if((this.ctxObjectIds[aj]["org"]==P.organization.orgID)&&(this.ctxObjectIds[aj]["project"]==P.collabSpace.collabSpaceID)){if(this.ctxObjectIds[aj]["id"]!=this.ctxObjectIds[aj]["mainRevisionId"]){ag.push(this.ctxObjectIds[aj]["id"])}else{if(this.ctxObjectIds[aj]["id"]==this.ctxObjectIds[aj]["mainRevisionId"]){S.push(this.ctxObjectIds[aj]["id"])}}}}else{if(this.ctxObjectIds[aj]["id"]==this.ctxObjectIds[aj]["mainRevisionId"]){S.push(this.ctxObjectIds[aj]["id"])}}}if((this.transferOwnershipSummary.responseObjectIds=="")){if(S.length>0){for(var ap=0;ap<ah.length;ap++){for(var ao=0;ao<ah[ap].length;ao++){var T=false;for(var ak=0;ak<S.length;ak++){if(ah[ap][ao]["id"]==S[ak]){X.push({id:S[ak],category:ah[ap][ao]["category"]});T=true;break}}if(!T){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}}}else{for(var ap=0;ap<ah.length;ap++){for(var ao=0;ao<ah[ap].length;ao++){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}}}else{for(var an=0;an<this.transferOwnershipSummary.responseObjectIds.length;an++){if((this.transferOwnershipSummary.responseObjectIds[an].error!=UWA.i18n("TOS_SuccessStatus"))&&(this.transferOwnershipSummary.responseObjectIds[an].error!=UWA.i18n("TOS_SuccessStatusForRevisions"))&&(this.transferOwnershipSummary.responseObjectIds[an].error!=UWA.i18n("TOS_SuccessStatusForSelectedRevision"))&&(this.transferOwnershipSummary.responseObjectIds[an].error!=null&&this.transferOwnershipSummary.responseObjectIds[an].error.message!="Success_idFromCompletionApi")){U.push(this.transferOwnershipSummary.responseObjectIds[an].physicalId)}else{if(this.transferOwnershipSummary.responseObjectIds[an].error!=null&&((this.transferOwnershipSummary.responseObjectIds[an].error.message=="Success_idFromCompletionApi")||(this.transferOwnershipSummary.responseObjectIds[an].error=="Success_idFromCompletionApi"))){au.push(this.transferOwnershipSummary.responseObjectIds[an].physicalId)}}}if(U.length!=0){for(var ap=0;ap<ah.length;ap++){for(var ao=0;ao<ah[ap].length;ao++){var ae=false;for(var al=0;al<U.length;al++){if(U[al]==ah[ap][ao]["id"]){ae=true;break}}if(ae==false){if(S.length>0){var R=false;for(var ak=0;ak<S.length;ak++){if(ah[ap][ao]["id"]==S[ak]){R=true}}if(R){var am=true;for(var ai=0;ai<X.length;ai++){if(ah[ap][ao]["id"]==X[ai]["id"]){am=false}}if(am){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}else{var V=false;for(var ak=0;ak<ag.length;ak++){if(ah[ap][ao]["id"]==ag[ak]){V=true;break}}if(!V){var am=true;for(var ai=0;ai<X.length;ai++){if(ah[ap][ao]["id"]==X[ai]["id"]){am=false}}if(am){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}}}else{X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}}}}else{if(S.length>0){for(var ap=0;ap<ah.length;ap++){for(var ao=0;ao<ah[ap].length;ao++){var T=false;for(var ak=0;ak<S.length;ak++){if(ah[ap][ao]["id"]==S[ak]){X.push({id:S[ak],category:ah[ap][ao]["category"]});T=true;break}}if(!T){var ar=false;for(var ak=0;ak<ag.length;ak++){if(ah[ap][ao]["id"]==ag[ak]){ar=true;break}}if(!ar){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]});break}}}}if(au.length>0){for(var ap=0;ap<au.length;ap++){X.push({id:au[ap],category:""})}}}else{for(var ap=0;ap<ah.length;ap++){for(var ao=0;ao<ah[ap].length;ao++){X.push({id:ah[ap][ao]["id"],category:ah[ap][ao]["category"]})}}if(au.length>0){for(var ap=0;ap<au.length;ap++){X.push({id:au[ap],category:""})}}}}}}var W=false;if(this.expandWholeStruct){W=this.expandWholeStruct.isChecked()}var at=true;if(this.optionReferenceCB!=null){at=this.optionReferenceCB.isChecked()}var aq=false;if(this.optionInstanceCB!=null){aq=this.optionInstanceCB.isChecked()}var ad=false;if(this.expandFolder){ad=this.expandFolder.isChecked()}var ac=false;if(this.expandSubFolder){ac=this.expandSubFolder.isChecked()}X=this._removeDuplicateItemsToMove(X);X=this._removeFailedIds(X);aa={tosBusinessObject:X,owner:P,options:{expandAll:W,expandFolder:ad,expandSubFolder:ac,selectReference:at,selectInstance:aq}};if(X.length==0){this.boutonValid.setDisabled(true);aa=""}}return aa},_isItemInItemsToMoveList:function(S,R){var T=R.length;for(var P=0;P<T;P++){var Q=R[P];if(Q.id==S.id&&Q.category==S.category){return true}}return false},_removeDuplicateItemsToMove:function(R){var P=[];var T=R.length;for(var Q=0;Q<T;Q++){var S=R[Q];if(!this._isItemInItemsToMoveList(S,P)){P.push(S)}}return P},_removeFailedIds:function(U){var Q=[];var P=false;var T=U.length;if(this.listOfFailedIds.length==0){return U}for(var S=0;S<T;S++){P=false;for(var R=0;R<this.listOfFailedIds.length;R++){if(U[S]["id"]==this.listOfFailedIds[R]){P=true}}if(!P){Q.push(U[S])}}return Q},_prepareTransferOwnership:function(S){var P=this;var Q="";if(S!=null&&S!=""&&S.hasOwnProperty("SecurityContext")){Q=S.SecurityContext}var R=this._getTransferData();if(R!=""){this._transferOwnership(Q,R)}},_commitTransferOwnership:function(T,Y){this.dispatchEvent("onTransferStart");var X=this;var R="";var S=this.options.serverName;var U=this.options.serverUri;var V=this.options.launchTransfer;var W=this.caHeader;var Q="";var P="";var Z="";if(Y[0].hasOwnProperty("owner")){if(Y[0].owner.hasOwnProperty("person")){Q=Y[0].owner.person.personFullName}if(Y[0].owner.hasOwnProperty("organization")){P=Y[0].owner.organization.orgID}if(Y[0].owner.hasOwnProperty("collabSpace")){Z=Y[0].owner.collabSpace.collabSpaceID}}m.get3DSpaceUrlAsync({onComplete:function(ac){var ae="/resources/v1/collabServices/attributes/op/update";var ad={Accept:"application/json",};ad["content-type"]="application/json";ad.SecurityContext=X.securityContext;if(X.caHeader){if(X.caHeader["DS-Change-Authoring-Context"]){ad["DS-Change-Authoring-Context"]=X.caHeader["DS-Change-Authoring-Context"]}if(X.caHeader["DS-Configuration-Authoring-Context"]){ad["DS-Configuration-Authoring-Context"]=X.caHeader["DS-Configuration-Authoring-Context"]}}var ah=X._parseForGenericService(Y);R=m.getRealPath("assets/transferOwnership.json",widget);var ak="";var af="GET";var al="";var ab="admin=true";if(X.adminCheckBox==null||!X.adminCheckBox.isChecked()){ab=""}if(n==2){R=ac+ae+"?"+ab;al="passport";af="PUT";for(var aj in ah){ah[aj]["queryParams"]={select:["physicalid","type","current"]}}ak=s.encode({withUpdatedValues:false,requests:ah})}var ai="";if(Y.length>0){ai=Y[0].owner}var aa={requests:ah,owner:ai};X.dispatchEvent("onValidation",aa);if(V===true){X.displayLoadingArea();ad["Accept-Language"]=widget.lang;var ag=m.getTenantID();if(ag){R+="&tenant="+ag}j.authenticatedRequest(R,{type:"json",method:af,proxy:al,headers:ad,data:ak,timeout:3600000,onComplete:function(am){X._onSucceedGenericTransfer(am,Q,P,Z)},onFailure:function(am,an,ao){X._onFailure(am,an,ao)},onTimeout:function(am){X._onTimeout()}})}}})},_transferOwnership:function(R,Q){var P=this;this._goTransferOwnership(R,Q)},_goTransferOwnership:function(W,V){if(this.options.genericTransfer===true){var U=[];for(var S=0;S<V.tosBusinessObject.length;S++){var Q=[];Q.push(V.tosBusinessObject[S]);U.push({tosBusinessObject:Q,owner:V.owner,options:{expandAll:V.options.expandAll,expandFolder:V.options.expandFolder,expandSubFolder:V.options.expandSubFolder,selectReference:V.options.selectReference,selectInstance:V.options.selectInstance}})}this._commitTransferOwnership(W,U);return}this.dispatchEvent("onTransferStart");var T=this;var P=this.options.serverName;var R=this.options.serverUri;m.get3DSpaceUrlAsync({onComplete:function(Z){var Y="admin=true";if(T.adminCheckBox==null||!T.adminCheckBox.isChecked()){Y=""}var ai="simpleUse=true";if(T.options.transferType==x.TransferFull){ai="simpleUse=false"}var ab="/resources"+N+"/TransferOwnershipAsync";var ag=false;if(n==2){ag=true}if(widget.getBool("asyncTrans")!=false){ag=true}var aa={Accept:"application/json",};aa["Content-Type"]="application/json";aa.SecurityContext=T.securityContext;var af=T._parseForGenericService(V);T.dispatchEvent("onValidation",{requests:af,owner:V.owner});var X=m.getRealPath("assets/transferOwnership.json",widget);var ae="";var ac="GET";var ah="";if(n==2){X=Z+ab+"?"+ai+"&"+Y;ae=s.encode(V);ac="POST";ah="passport"}if(T.options.launchTransfer===true){T.displayLoadingArea();aa["Accept-Language"]=widget.lang;var ad=m.getTenantID();if(ad){X+="&tenant="+ad}j.authenticatedRequest(X,{type:"json",method:ac,proxy:ah,headers:aa,data:ae,onComplete:function(aj){T._OnCompleteTransferOwnership(aj,ag)},onFailure:function(aj,ak,al){T._onFailure(aj,ak,al)},onTimeout:function(aj){T._onTimeoutTOS(ag)}})}}})},_onTimeoutTOS:function(P){if(P){this.dispatchEvent("onTransferFail");this.hideLoadingArea();var Q={message:UWA.i18n("ErrorTimeOutTOS"),code:"TO"};this.setError(Q)}else{this._onTimeout()}},_OnCompleteTransferOwnership:function(R,P){var Q=this;if(P&&R.success===true){var S=R.idProgress;o=0;Q.showInfoNotification("The transfer begins",L);this._transferEvolution(S)}else{this._transferSucceed(R)}},_transferEvolution:function(T){var S=this;if(o==f){S._onTimeoutTOS(true);return}var Q="/resources"+N+"/TransferOwnership/evolution?idProgress="+T;var P=this.options.serverName;var R=this.options.serverUri;m.get3DSpaceUrlAsync({onComplete:function(Z){var W={Accept:"application/json",};var V="GET";var Y=m.getRealPath("assets/evolution.json",widget);var U="";if(n==2){Y=Z+Q;U="passport"}W["Accept-Language"]=widget.lang;W.SecurityContext=S.securityContext;var X=m.getTenantID();if(X){Y+="&tenant="+X}j.authenticatedRequest(Y,{type:"json",method:V,proxy:U,headers:W,onComplete:function(aa){S._OnCompleteStep(aa,T)},onFailure:function(aa,ab,ac){S._onFailure(aa,ab,ac)},onTimeout:function(aa){S._onTimeoutTOS(true)}})}})},_OnCompleteStep:function(Q,R){o++;console.log(Q.progress);if(Q.hasOwnProperty("success")){this._transferSucceed(Q)}else{this.showInfoNotification(Q.progress,L);var P=this;setTimeout(function(){P._transferEvolution(R)},y)}},_onSucceedGenericTransfer:function(U,R,W,T){var S=this;var P={};var Q=[];var V=true;if(U.results){U.results.forEach(function(Z){if(Z.status>=200&&Z.status<300){if(Z.body.sameOwner==undefined){var Y=false;if(Z.body&&Z.body.errors){var X=Z.body.errors.length;if(X>0){Y=Z.body.errors[X-1]}}Q.push({id:Z.body.physicalid,type:Z.body.type,current:Z.body.current,error:Y})}else{if(Z.body.sameOwner==true){return false}}}else{var Y={message:UWA.i18n("cannot move selection"),code:"ERROR"};if(Z.body&&Z.body.errors){var X=Z.body.errors.length;if(X>0){Y=Z.body.errors[X-1]}}P.error=Y;if(Z.body.physicalid!=undefined){Q.push({id:Z.body.physicalid,type:Z.body.type,current:Z.body.current,error:Y})}}return true})}if(Q.length>0){P.listId=Q}this._transferSucceedForUpdate(P,R,W,T)},_transferSucceed:function(Q){var P=this;P.hideLoadingArea();if((Q.hasOwnProperty("success")&&Q.success===true)){if(Q.listId&&Q.listId.length>0){require(["DS/PADUtils/PADCommandProxy","DS/PADUtils/PADContext"],function(T,X){var V=X.get();if(null==V){V=P.options.context}var ac=[];var U=[];var W=[];Q.listId.forEach(function(ae){var ad=(ae.id.value!=null)?ae.id.value:ae.id;if(ae.type=="Workspace"){ac.push(ad)}else{if(ae.current=="PRIVATE"||ae.current=="#DENIED!"){W.push(ad)}else{U.push(ad)}}});if(ac.length>0){var aa={};aa.deleted=ac;var Y={};Y.authored=aa;V.author(true);V.onRefresh(Y);var Z=T.create();Z.destroy()}if(U.length>0||W.length>0){var aa={};aa.modified=U;aa.deleted=W;var Y={};Y.authored=aa;var Z=T.create();var ab={authored:true};Z.authored(ab);Z.refresh(Y);Z.destroy()}})}P.container.setStyle("opacity","1");this.dispatchEvent("onTransferSucceed")}else{P.container.setStyle("opacity","1");this.dispatchEvent("onTransferFail");var S=null;if(Q.hasOwnProperty("error")){S=Q.error;if(S.code!=""){P.setError(S)}else{S=null}}var R=Q.tosBusinessObject;if(R!=null){R.forEach(function(T){if(T.hasOwnProperty("error")){S=T.error;P.setError(S)}})}if(S==null){S={message:UWA.i18n("UnknownError"),code:"ERROR"};P.setError(S)}}},_transferSucceedForUpdate:function(ao,ad,W,ai){var V=this;var Y=0;V.hideLoadingArea();var aa=0,ab=0;var S=0;var aj,ag,af,ae;var P=JSON.parse("[]");for(ag=0;ag<ao.listId.length;ag++){var Q=ao.listId[ag]["id"];P[Q]=ag}var T=JSON.parse("[]");var R=JSON.parse("[]");var U=this.table.getAllLine();var ah=U.length;for(af=0;af<ah;af++){if(U[af]!=undefined){T[U[af].getElementsByClassName("TOS_Id")[0].innerHTML]=true;R[U[af].getElementsByClassName("TOS_Id")[0].innerHTML]=af}}if(ao.listId&&ao.listId.length>0){var Q;for(var aj=0;aj<ao.listId.length;aj++){if(T[ao.listId[aj]["id"]]===true){var ag=R[ao.listId[aj]["id"]];this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();if(ao.listId[aj].error){var ac=UWA.createElement("div",{"class":"syc-red-circle-symbol"});var am=UWA.createElement("div",{"class":"syc-cross-symbol"});U[ag].getElementsByClassName("Symbol")[0].appendChild(ac);U[ag].getElementsByClassName("Symbol")[0].appendChild(am);U[ag].getElementsByClassName("Result")[0].innerHTML=ao.listId[aj].error.message;ab++}else{var ak=UWA.createElement("div",{"class":"syc-green-circle-symbol"});var al=UWA.createElement("div",{"class":"syc-check-symbol"});U[ag].getElementsByClassName("Symbol")[0].appendChild(ak);U[ag].getElementsByClassName("Symbol")[0].appendChild(al);U[ag].getElementsByClassName("Result")[0].innerHTML=UWA.i18n("TOS_SuccessStatus");if(ad!=""){U[ag].getElementsByClassName("Responsible")[0].innerHTML=ad}if(W!=""){U[ag].getElementsByClassName("Organization")[0].innerHTML=W}if(ai!=""){U[ag].getElementsByClassName("CollaborativeSpace")[0].innerHTML=ai}S++}}if(this.optionInstanceCB.isChecked()&&!this.optionReferenceCB.isChecked()){for(var X=0;X<this.SelectedInstance.length;X++){if(ao.listId[aj]["id"]==this.SelectedInstance[X].instanceId){if(T[this.SelectedInstance[X].referenceId]===true){var Z=R[this.SelectedInstance[X].referenceId];this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();if(ao.listId[aj].error){var ac=UWA.createElement("div",{"class":"syc-red-circle-symbol"});var am=UWA.createElement("div",{"class":"syc-cross-symbol"});U[Z].getElementsByClassName("Symbol")[0].appendChild(ac);U[Z].getElementsByClassName("Symbol")[0].appendChild(am);U[Z].getElementsByClassName("Result")[0].innerHTML=ao.listId[aj].error.message;aa++}else{var ak=UWA.createElement("div",{"class":"syc-green-circle-symbol"});var al=UWA.createElement("div",{"class":"syc-check-symbol"});U[Z].getElementsByClassName("Symbol")[0].appendChild(ak);U[Z].getElementsByClassName("Symbol")[0].appendChild(al);U[Z].getElementsByClassName("Result")[0].innerHTML=UWA.i18n("TOS_SuccessStatus");if(ad!=""){U[Z].getElementsByClassName("Responsible")[0].innerHTML=ad}if(W!=""){U[Z].getElementsByClassName("Organization")[0].innerHTML=W}if(ai!=""){U[Z].getElementsByClassName("CollaborativeSpace")[0].innerHTML=ai}S++}}}}}if(U[ag]!=undefined&&U[ag].getElementsByClassName("Result")[0]!=undefined&&U[ag].getElementsByClassName("Result")[0].innerHTML!=undefined){if((U[ag].getElementsByClassName("Result")[0].innerHTML!=UWA.i18n("TOS_SuccessStatus"))&&(U[ag].getElementsByClassName("Result")[0].innerHTML!="")){Y=Y+1}}}if(Y>0){var an={message:UWA.i18n("TOS_Fail").format(Y),code:"ERROR"};V.setError(an)}require(["DS/PADUtils/PADCommandProxy","DS/PADUtils/PADContext"],function(ap,au){var ar=au.get();if(null==ar){ar=V.options.context}var az=[];var aq=[];var at=[];ao.listId.forEach(function(aB){if(aB.error==false){var aA=(aB.id.value!=null)?aB.id.value:aB.id;if(aB.type=="Workspace"){az.push(aA)}else{if(aB.current=="PRIVATE"||aB.current=="#DENIED!"){at.push(aA)}else{aq.push(aA)}}}});if(az.length>0){var ax={};ax.deleted=az;var av={};av.authored=ax;ar.author(true);ar.onRefresh(av);var aw=ap.create();aw.destroy()}if(aq.length>0||at.length>0){var ax={};ax.modified=aq;ax.deleted=at;var av={};av.authored=ax;var aw=ap.create();var ay={authored:true};aw.authored(ay);aw.refresh(av);aw.destroy()}});V.container.setStyle("opacity","1");this.dispatchEvent("onTransferSucceed")}else{V.container.setStyle("opacity","1");this.dispatchEvent("onTransferFail");var an=null;if(ao.hasOwnProperty("error")){for(var ag=0;ag<this.table.getAllLine().length;ag++){this.table.tHeadScroll.parentElement.getElementsByTagName("div")[14].show();var ac=UWA.createElement("div",{"class":"syc-red-circle-symbol"});this.table.getAllLine()[ag].getElementsByClassName("Symbol")[0].appendChild(ac);var am=UWA.createElement("div",{"class":"syc-cross-symbol"});this.table.getAllLine()[ag].getElementsByClassName("Symbol")[0].appendChild(am);this.table.getAllLine()[ag].getElementsByClassName("Result")[0].innerHTML=ao.error.message}}}},getTopBar:function(){return this.ManageButtonDiv},onResize:function(){if(this.itemListHasPriority===true){this.tableItemsContainer.show()}var ad={width:0,height:0,outerHeight:0};var ae=this.container.getSize();var U=this.mainInterface.getSize();var X=ad;var Q=ad;var W=ad;var Z=ad;var V=0;var R=0;var S=0;if(this.table){var T=this.mainTableContainer.getStyle("margin-bottom");V=parseInt(T);W=this.table.getOptimalSize();X=this.mainTableContainer.getDimensions()}if(this.tableItems){var af=this.tableItemsContainer.getStyle("margin-bottom");S=parseInt(af);Z=this.tableItems.getOptimalSize();Q=this.tableItemsContainer.getDimensions();if(this.tableItemsContainer.getStyle("display")==="none"){R=20;Q=ad}}var Y=U.height-X.outerHeight-Q.outerHeight;var aa=0;var ac=0;var ag=0;if(Y>0){aa=ae.height-Y;if(aa<0){aa=0}if(this.table){if(this.itemListHasPriority===false){var ab=aa-W.height;ag=W.height;if(ab<0){ag=aa}else{ac=ab}}else{var ab=aa-Z.height;ac=Z.height;if(ab<0){ac=aa}else{ag=ab}}}else{ac=aa}}if(this.tableItems){if(this.itemListHasPriority===false&&ac<60+R){this.tableItemsContainer.hide();ac=0;ag=aa+S}else{this.tableItemsContainer.show()}var P=ac-S;if(P<0){P=0}this.tableItemsContainer.setStyle("height",P);this.tableItems.updateScroller(ae.width)}if(this.table){var af=this.mainTableContainer.getStyle("margin-bottom");this.table.updateScroller(ae.width)}if(this.transferOwnershipSummary&&this.transferOwnershipSummary.container.getStyle("display")!=="none"){this.transferOwnershipSummary.onResize()}},_ManageValidButton:function(P){var Q=P;if(P==null){Q=false}if(Q){this.boutonValid.setDisabled(false)}else{this.boutonValid.setDisabled(true)}},initData:function(R,T){I.getInstance().getSecurityContext();this.SelectedItems=[];this._addData(R);this.caHeader=T;var V=k.contains("1");if(V){this.optionReferenceCB.show();this.populateInstanceList(R);if(!this.checkIfAllRoots()){if(!this.checkIfHideInstanceCB()){this.optionInstanceCB.show()}else{this.optionReferenceCB.disable()}}else{this.optionReferenceCB.disable()}}if(this.options.oldClassName!="editProperties_TransferOwnershipPopup"){this.getcanUserChangePOV(R)}var W=[];var X=[];for(var S=0;S<R.length;S++){var Z="";var Y="";var Q="";var P="";if(R[S].name!=undefined||R[S].name!=null){Z=R[S].name}else{Z=""}if(R[S].Revision!=undefined||R[S].Revision!=null){Y=R[S].Revision}else{Y=""}if(R[S].responsibleName!=undefined||R[S].responsibleName!=null){Q=R[S].responsibleName}else{Q=""}if(R[S].urlIcon!=undefined||R[S].urlIcon!=null){P=R[S].urlIcon}else{P=""}var aa={id:R[S].physicalId,category:R[S].category,mainRevisionId:R[S].physicalId,responsibleName:Q,Revision:Y,name:Z,urlIcon:P};if(R[S].responsibleName==null||R[S].responsibleName==undefined||R[S].name==null||R[S].name==undefined||R[S].Revision==null||R[S].Revision==undefined){W.push(aa);if((R.length>u)&&(S%u==0)&&(S!=0)){this._getCtxObjectIds(W);W=[]}}else{X.push(aa);if((R.length>u)&&(S%u==0)&&(S!=0)){this._getCtxObjectIdsPCS(X);X=[]}}var U=[];U.push(aa);this._setListOfIds(U,R[S].physicalId)}if(X.length>0){this._getCtxObjectIdsPCS(X)}if(W.length>0){this._getCtxObjectIds(W)}},populateInstanceList:function(Q){this.SelectedInstance=[];for(var P=0;P<Q.length;P++){if((Q[P].cadMaster=="3DEXPERIENCE")&&(Q[P].parentCADMaster=="3DEXPERIENCE")||(Q[P].cadMaster=="CATIAV5")&&(Q[P].parentCADMaster=="3DEXPERIENCE")){var R={referenceId:Q[P].physicalId,instanceId:Q[P].relID,category:Q[P].category};this.SelectedInstance.push(R)}}},checkIfAllRoots:function(){var S=0;var P=this.SelectedItems.length;for(var R=0;R<P;R++){var T=this.SelectedItems[R];if(T.relID==""){S++}}var Q=false;if(S==P){Q=true}return Q},checkIfHideInstanceCB:function(){var P=true;var Q=this.SelectedItems.length;for(var R=0;R<Q;R++){var S=this.SelectedItems[R];if(S.cadMaster=="CATIAV5"&&S.parentCADMaster=="3DEXPERIENCE"){return false}if(S.cadMaster=="3DEXPERIENCE"&&S.parentCADMaster=="3DEXPERIENCE"){return false}}return true},_addData:function(S){this.hideMainErrorArea();var P=[];var Q=this;if(S!=null){P=S.slice()}m.removeDuplicate(P,function(T){return T.physicalId});P.forEach(function(U){var V=new C(U);var T=m.arrayContains(Q.SelectedItems,V,function(W){return W.physicalId});if(T<0){Q.SelectedItems.push(V)}});this.tableItems.clearAllLine();this.displayMainLoadingArea();this._AddSelectedItem(Q.SelectedItems);this.displayMainInterfaceArea();var R=[];Q.SelectedItems.forEach(function(T){R.push({objectID:T.getPhysicalId()})});this.searchWidget.setSelectedItemList(R);this.onResize()},_AddSelectedItem:function(R){var P=[];var Q=this;R.forEach(function(T,S){P.push(Q._createNewLineItem(T,S))});Q.titleSelectedItem.setHTML(R.length+" "+r);Q.tableItems.AddDatasInTable(P);this._manageAccessList()},_createNewLineItem:function(T,Q){var S=this;var P=S._getNewIDItem();S.SelectedItems[Q].index=P;var U="";if(S.SelectedItems[Q].getUrlIcon()){U=UWA.createElement("img",{"class":"TOS_iconSelectItem",src:S.SelectedItems[Q].getUrlIcon(),height:15,text:""})}var V="";V=new G({attributes:{title:UWA.i18n("RemoveSelected")},value:"",className:"default xsmall TOS_DeleteSelected",icon:"cancel"});V.addEvents({onClick:function(){S._DeleteItem(P)}});var R=UWA.createElement("h5",{html:S.SelectedItems[Q].getName()});return{Id:P,TOS_IconItem:U,TOS_SelectedName:R,DeleteItem:V}},_getNewIDItem:function(){var Q=true;var P=this.SelectedItems.length;while(Q===true){P++;Q=false;this.SelectedItems.forEach(function(R){if(P==R.index){Q=true}})}return P},_DeleteItem:function(P){var R=false;var Q=this;this.SelectedItems.every(function(T,S){if(T.index==P){R=true;Q.SelectedItems.splice(S,1);return false}return true});if(R===true){this.tableItems.removeLine({Id:P})}this._addData();this._manageAccessList()},_manageAccessList:function(){var P=this.tableItems.getAllLine();var Q=P.length;var R="";if(this.options.transferType==x.TransferFull){R+=UWA.i18n("TOS_mainTile")}else{if(this.options.transferType==x.TransferPerson){R+=UWA.i18n("ChangeResp_mainTile")}else{if(this.options.transferType==x.TransferCollabSpace){R+=UWA.i18n("ChangeCollab_mainTile")}}}if(this.options.oldClassName=="changeOwner_popup_fromCmd"){R=UWA.i18n("TOS_ChangeOwner")}if(Q==0){this.itemsArea.hide()}else{if(Q==1){this.itemsArea.hide();R+=" - "+this.tableItems.getCellValue(P[0],"TOS_SelectedName")}else{this.itemsArea.hide();R+=" - "+Q+" "+UWA.i18n("TOS_Objects")}}this.dispatchEvent("onTitleChange",R)},showNotification:function(Q,P){if(P==null){P=""}if(this.errorOverlay!=null){this.errorOverlay.addSuccess(Q,P)}},showInfoNotification:function(Q,P){if(P==null){P=""}if(this.errorOverlay!=null){this.errorOverlay.addInfo(Q,P)}},setError:function(P){this.addError(P)},addError:function(Q){if(this.errorOverlay!=null&&Q&&Q.hasOwnProperty("message")){var P=UWA.i18n(Q.message);this.errorOverlay.displayJSONError(s.encode(Q))}},displayLoadingArea:function(){if(this.loadingArea!=null){this.loadingArea.show()}},hideLoadingArea:function(){if(this.loadingArea!=null){this.loadingArea.hide()}},displayMainHistoryArea:function(){this.hideAllAreas();if(this.mainHistory!=null){this.mainHistory.show();this.transferOwnershipHistory.activeAutoRefresh(true)}},displayMainSummaryArea:function(){this.hideAllAreas();if(this.mainSummary!=null){this.mainSummary.show()}if(this.boutonValid!=null){this.boutonValid.show()}},displayMainInterfaceArea:function(){this.hideAllAreas();if(this.mainInterface!=null){this.mainInterface.show()}if(this.boutonValid!=null){this.boutonValid.show()}},displayMainLoadingArea:function(){this.hideAllAreas();if(this.mainLoading!=null){this.mainLoading.show()}},hideMainComponent:function(){this.hideLoadingArea();if(this.mainInterface!=null){this.mainInterface.hide()}if(this.boutonValid!=null){this.boutonValid.hide()}},hideMainHistoryArea:function(){if(this.mainHistory!=null){this.mainHistory.hide();if(this.transferOwnershipHistory){this.transferOwnershipHistory.activeAutoRefresh(false)}}},hideMainSummaryArea:function(){if(this.mainSummary!=null){this.mainSummary.hide()}},hideMainLoadingArea:function(){if(this.mainLoading!=null){this.mainLoading.hide()}},hideMainErrorArea:function(){if(this.mainError!=null){this.mainError.hide()}},hideAllAreas:function(){this.hideMainLoadingArea();this.hideMainComponent();this.hideMainHistoryArea();this.hideMainSummaryArea()},addMainError:function(P){if(this.mainError!=null){new UWA.createElement("div",{text:P}).inject(this.mainError)}},clearAllMainError:function(){if(this.mainError!=null){this.mainError.setContent("")}},_createSelectedTable:function(){var P=new B([{text:UWA.i18n("Id"),dataIndex:"Id",sortKey:function(Q){return Q}},{text:"",dataIndex:"TOS_IconItem"},{text:"",dataIndex:"TOS_SelectedName",sortKey:function(Q){return Q.getText()},defaultSort:true,sortable:true}],{name:"TOS_tableSelected",className:"TOS_tableSelected",setHeaderColumn:false,setScroller:true,useNativeScroller:true,maxHeightScroller:""});P.addHeader([{text:"",dataIndex:"DeleteItem"}]);return P},_createTable:function(){var P=this;var Q=new B([{text:"PhysicalID",dataIndex:"TOS_Id",sortKey:function(R){return R},sortable:true},{text:"",dataIndex:"Symbol",sortKey:function(R){return R},sortable:true},{text:UWA.i18n("TOS_Title"),dataIndex:"Title",sortKey:function(R){return R},sortable:true},{text:UWA.i18n("TOS_Revision"),dataIndex:"Revision",sortKey:function(R){return R},sortable:true},{text:UWA.i18n("TOS_Sum_Org"),dataIndex:"Organization",sortKey:function(R){return R},defaultSort:true,sortable:true},{text:UWA.i18n("TOS_Sum_Collab"),dataIndex:"CollaborativeSpace",sortKey:function(R){return R},defaultSort:true,sortable:true},{text:UWA.i18n("TOS_Sum_Resp"),dataIndex:"Responsible",sortKey:function(R){return R},defaultSort:true,sortable:true},{text:UWA.i18n("TOS_Result"),dataIndex:"Result",sortKey:function(R){return R},sortable:true}],{className:"TOS_mainTable",activeSelection:false,setScroller:true,useNativeScroller:true,maxHeightScroller:""});return Q},_getNewIDLine:function(){var Q=true;var P=this.listID.length;while(Q===true){P++;Q=false;this.listID.forEach(function(R){if(P==R){Q=true}})}return P},_addNewLines:function(S){var P=this;var Q=[];var R=P._createNewLine(S);Q.push(R);this.table.AddDatasInTable(Q)},_createNewLine:function(P){var S=this;var Q="";var U="";var T="";var R="";var V=S._getNewIDLine();if(P.hasOwnProperty("name")){Q=P.collabSpace.collabSpaceID}if(P.hasOwnProperty("type")){U=P.organization.orgID}if((P.hasOwnProperty("org"))&&(P.hasOwnProperty("collab"))&&(P.hasOwnProperty("owner"))){T=P.visibility}if(P.hasOwnProperty("family")){R=P.family}return{Name:V,Type:Q,Current:U,}},_fillTableForUser:function(R,ab){if(ab==null||ab.SecurityContext==null){var X={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};this.setError(X);return}var Y=this;var P="GET";var W="/resources/pno/ownership/ctxorgcollabspace";var Z="";var aa="";var V="";if(R.hasOwnProperty("collabSpace")){W+="/collabspace";aa=UWA.i18n("Change collaborative space");V="changeCS";Z="?pattern="+R.collabSpace.collabSpaceID.replace(/\s/g,"%20")}else{if(R.hasOwnProperty("organization")){W+="/org";aa=UWA.i18n("Change organization");V="changeOrg";Z="?pattern="+R.organization.orgID.replace(/\s/g,"%20")}else{if(R.hasOwnProperty("person")){W+="/user";aa=UWA.i18n("Change responsible");V="changeResp";Z="?pattern="+R.person.personID.replace(/\s/g,"%20")}}}var U="";if(m.isReplayODT()||this.options.activeFirstLineTable===true){U=aa}var Q="";var S=this.options.serverName;var T=this.options.serverUri;m.get3DSpaceUrlAsync({onComplete:function(ag){var ad="";Q=m.getRealPath("assets/dataUserStandAlone.json",widget);if(n==2){ad="passport";Q=ag+W;Q=Q+Z}var ae={Accept:"application/json",};Y.displayLoadingArea();ae["Accept-Language"]=widget.lang;ae.SecurityContext=Y.securityContext;var af=m.getTenantID();if(af){Q+="&tenant="+af}var ac=j.authenticatedRequest(Q,{type:"json",method:P,proxy:ad,headers:ae,onComplete:function(ah){Y._onCompleteFillTableForUser(ah,V,ab,U)},onFailure:function(ah,ai,aj){Y._onFailure(ah,ai,aj)},onTimeout:function(ah){Y._onTimeout()}})}})},_onCompleteFillTableForUser:function(W,S,Z,R){var V=this;this.itemListHasPriority=false;var U=[];if(Z!=null&&Z.hasOwnProperty("SecurityContext")){var Q=Z.SecurityContext.replace("ctx::","");U=Q.split(".")}V.hideLoadingArea();if(W.success===true){var Y=W.owner;if(R!=""){var X={insideElement:R};V.table.AddMultiColumnLineInTable(X)}V._addNewLines(Y);if(U.length==3){var P=null;if(S=="changeCS"){P={Organization:U[1]}}else{if(S=="changeOrg"){P={CollabSpace:U[2]}}else{if(S=="changeResp"){P={Organization:U[1],CollabSpace:U[2]}}}}if(P!=null){V.table.selectFirstLine(P)}}}else{var T=null;if(W.hasOwnProperty("error")){T=W.error}else{T={message:UWA.i18n("UnknownError"),code:"ERROR"}}V.setError(T)}this.onResize()},_onFailure:function(P,Q,S){var R=this;this.dispatchEvent("onTransferFail");R.hideLoadingArea();var T={};if(s.isJson(Q)){Q=s.decode(Q)}if(Q!=null&&Q.hasOwnProperty("error")){T=Q.error}else{T={message:UWA.i18n("UnknownError"),code:"ERROR"}}R.setError(T)},_onTimeout:function(){this.dispatchEvent("onTransferFail");this.hideLoadingArea();var P={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this.setError(P)},});return K});define("DS/TransferOwnershipWidget/TransferOwnershipWidget",["DS/TransferOwnershipWidget/component/TransferOwnershipWidget"],function(a){});define("DS/TransferOwnershipWidget/popup/TransferOwnershipPopup",["UWA/Controls/Abstract","DS/TransferOwnershipWidget/component/TransferOwnershipWidget","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/ENOFloatingPanel/ENOFloatingPanel","css!DS/TransferOwnershipWidget/TransferOwnershipWidget.css",],function(g,b,d,c){var e="620";var f="920";var a=g.extend({defaultOptions:{className:"",context:null,ForbiddenChar:'"#$@%,?\\<>[]|:',transferType:d.TransferFull,serverName:"",serverUri:"",launchTransfer:true,genericTransfer:false,activeDnD:false,activeOptions:false,activeSummaryButton:false,activeHistoryButton:false,activeAdminCheckBox:false,removeAtClose:true},init:function(i,h){var j=this;this.defaultOptions.activeAdminCheckBox=widget.getBool("admin");this._parent(h);j.initUI(i)},onRefresh:function(){if(this.TOSWidget!=null){this.TOSWidget.onRefresh()}},onResize:function(){if(this.TOSWidget!=null){this.TOSWidget.onResize()}},actionOnMove:function(){if(this.TOSWidget){this.TOSWidget.actionOnMove()}},destroy:function(){if(this.TOSWidget){this.TOSWidget.destroy()}this._parent()},setSecurityContext:function(h){this.TOSWidget.setSecurityContext(h)},initUI:function(i){var j=this;j.widgetPere=i;j.TOSWidget=new b({className:"transferOwnership_innerComponent",context:j.options.context,ForbiddenChar:j.options.ForbiddenChar,setCloseButton:true,showTopBar:false,transferType:j.options.transferType,launchTransfer:j.options.launchTransfer,genericTransfer:j.options.genericTransfer,topClassHeight:"TOSP_PopupDial",serverName:this.options.serverName,serverUri:this.options.serverUri,activeDnD:this.options.activeDnD,activeOptions:this.options.activeOptions,activeSummaryButton:this.options.activeSummaryButton,activeHistoryButton:this.options.activeHistoryButton,activeAdminCheckBox:this.options.activeAdminCheckBox,oldClassName:this.options.className,securityContext:this.options.securityContext,events:{onNewSize:function(l){j.container.setNewBodySize({width:null,height:l.height});var k=j.container.getContainerHeight();k=k>450?450:k;j.container.setNewSize({height:k});j.container.lockWidth()},onCancel:function(){j._close();j.dispatchEvent("onCancel")},onValidation:function(k){j.dispatchEvent("onValidation",k)},onTitleChange:function(k){j.container.setTitle(k)}}});j.container=new c({title:"ENOVIA",className:"TOSP_PopupDial "+this.options.className,footer:j.TOSWidget.getTopBar(),body:j.TOSWidget,overlay:true,closable:true,animate:true,resizable:true,events:{onResizeFloating:function(){j.onResize();j.actionOnMove();j.container._minHeight=330},onMove:function(){j.actionOnMove()},onClose:function(){j._close()},onHide:function(){j._close()}}});j.container.inject(i);var h=i.offsetHeight>550?550:i.offsetHeight;j.container.setNewSize({height:h})},centerIt:function(){this.container.centerIt()},show:function(i,h){var j=this;j.container.show();j.TOSWidget.initData(i,h)},close:function(){this.container.hide();if(this.options.removeAtClose===true){this.destroy()}},_close:function(){this.dispatchEvent("onClose");this.close()}});return a});