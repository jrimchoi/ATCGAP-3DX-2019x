define("DS/Controls/ModalContainer",["UWA/Core","DS/Core/Core"],function(c,b){var a={createModal:function(f,g){var e=window.getComputedStyle(f);if(e.getPropertyValue("position")==="static"){throw ("The given container is not positionned. Please position your container before creating a modalContainer on it.");return}f.classList.add("modalElement");var d=c.createElement("div",{"class":"wux-controls-modalContainer"});if(c.is(g,"element")){g=new c.extendElement(g)}g.classList.add("wux-controls-modalContent");g.inject(d);d.inject(f)},removeModal:function(g){var d,f;if(c.is(g,"element")){g=new c.extendElement(g)}var h=g.getChildren();if(h.length>0){for(var e=0;e<h.length;e++){if(h[e].classList.contains("wux-controls-modalContainer")){d=h[e];break}}}if(d){f=d.getElement(".wux-controls-modalContent");if(f){f.classList.remove("wux-controls-modalContent")}d.destroy()}g.classList.remove("modalElement")}};return a});define("DS/Controls/Stack",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core"],function(e,a,d){var c={horizontal:"inline-block",vertical:"block"};var b=d.extend({defaultOptions:{orientation:"horizontal","class":"",styles:{margin:0,padding:0}},init:function(f){this._parent(f);this._stackCells=[];this._stackCellsContainers=[];this._totalWeight=0;this.buildSkeleton();this.addEvent("onPostInject",this._onPostInject)},buildSkeleton:function(){this.elements.container=new e.Element("ul",{"class":"Stack "+this.options["class"],styles:this.options.styles})},toggleOrientation:function(){},append:function(h,g){var f={weight:0,styles:null};g=e.extend(f,g);var j=new e.Element("li",{styles:{display:c[this.options.orientation]},html:h,events:g.events});j.addClassName(g["class"]);j.setStyles(g.styles);this._totalWeight+=parseInt(g.weight,10);j.inject(this.elements.container);var i={container:j,options:g};this._stackCellsContainers.push(j);this._stackCells.push(i);return i},getElements:function(){return this._stackCells},getElementsContainers:function(){return this._stackCellsContainers},remove:function(g){var f=this._stackCells.indexOf(g);if(f!==-1){this._stackCellsContainers[f].destroy();this._stackCells.splice(f,1);this._stackCellsContainers.splice(f,1)}},_onPostInject:function(){var h=this;var f=0;var g=0;this._stackCells.forEach(function(i){var k;k=i.options.weight/h._totalWeight*100;if(i.options.weight){if(h.options.orientation==="horizontal"){var j=g;g=g+k;i.container.setStyles({left:j+"%",width:k+"%",top:0,bottom:0})}else{i.container.setStyles("height",k+"%")}}f++})}});return e.namespace("WUX/Controls/Stack",b)});define("DS/Controls/LayerSet",["UWA/Core","UWA/Event","UWA/Controls/Abstract"],function(d,b,c){var a=c.extend({defaultOptions:{styles:{}},init:function(e){this._parent(e);this._buildSkeleton()},_buildSkeleton:function(){this.elements.container=new d.Element("div",{"class":"LayerSet",styles:this.options.styles});this.elements._inner=new d.Element("div",{"class":"Content"});this.elements._inner.inject(this.elements.container)},addLayer:function(f,g){if(g===undefined){g={left:0,right:0,top:0,bottom:0}}var e=new d.Element("div",{"class":"Content"});e.setStyle("position","absolute");e.setStyles(g);f.inject(e);e.inject(this.elements._inner);return e}});return d.namespace("Controls/LayerSet",a)});define("DS/Controls/Scroller",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Utilities/Css3D","DS/CoreEvents/ModelEvents","UWA/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/RAFDispatcher","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry"],function(d,q,j,c,r,g,i,m,a,p,f,l){var b=false;var k=10;var h=40;var n=800;function e(u){var w=0,v=0,t=0,s=0;if("detail" in u){v=u.detail}if("wheelDelta" in u){v=-u.wheelDelta/120}if("wheelDeltaY" in u){v=-u.wheelDeltaY/120}if("wheelDeltaX" in u){w=-u.wheelDeltaX/120}if("axis" in u&&u.axis===u.HORIZONTAL_AXIS){w=v;v=0}t=w*k;s=v*k;if("deltaY" in u){s=u.deltaY}if("deltaX" in u){t=u.deltaX}if((t||s)&&u.deltaMode){if(u.deltaMode===1){t*=h;s*=h}else{t*=n;s*=n}}if(t&&!w){w=(t<1)?-1:1}if(s&&!v){v=(s<1)?-1:1}return{spinX:w,spinY:v,pixelX:t,pixelY:s}}var o=j.extend({defaultOptions:{eventPeriod:0,scrollDebounceTimeout:0,scrollEndTimeout:201,useRequestAnimationFrame:false,events:{onScrollBegin:null,onScroll:null,onScrollEnd:null}},init:function(t,s){this._parent(s);this._modelEvents=new g({callMode:"asc"});this._target=t;this._beginScrollPosition={x:0,y:0};this._scrollPosition={x:0,y:0};this._lastScrollPosition=this._scrollPosition;this._scrollDirection={x:0,y:0};this._lastScrollDirection=this._scrollDirection;this._buildSkeleton();this._bindBehaviors();this._modelEvents.publish({event:"INIT",context:this})},_buildSkeleton:function(){var t=this;var s=new d.Element("div",{"class":"wux-scroller",styles:{position:"absolute",left:0,right:0,top:0,bottom:0}});this.elements.container=s;this._target.inject(this.elements.container)},onInit:function(s){return this._modelEvents.subscribe({event:"INIT"},s)},onScrollBegin:function(s){return this._modelEvents.subscribe({event:"SCROLL_START"},s)},onScroll:function(s){return this._modelEvents.subscribe({event:"SCROLL"},s)},_onVerticalScrollDirectionChanged:function(s){return this._modelEvents.subscribe({event:"VERTICAL_SCROLL_DIRECTION_CHANGED"},s)},_onHorizontalScrollDirectionChanged:function(s){return this._modelEvents.subscribe({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED"},s)},onScrollEnd:function(s){return this._modelEvents.subscribe({event:"SCROLL_END"},s)},_updatePosition:function(){this.setPosition({x:-this.elements.container.scrollLeft,y:-this.elements.container.scrollTop})},_bindBehaviors:function(){var C=this;var v=null;var y=true;var A;function w(){C._modelEvents.publish({event:"SCROLL",context:C})}var u=a.debounce(w,C.options.scrollDebounceTimeout);function D(G,F){C._updatePosition();if(y){if(b){console.log("<<<< BEGIN >>>>")}C._beginScrollPosition=C.getPosition();if(C.options.events.onScrollBegin){C.options.events.onScrollBegin.call(C,C.getPosition())}C._modelEvents.publish({event:"SCROLL_START",context:C});y=false;if(C.options.useRequestAnimationFrame){A=requestAnimationFrame(E)}}C._deltaPositionFromBeginning={x:C._scrollPosition.x-C._beginScrollPosition.x,y:C._scrollPosition.y-C._beginScrollPosition.y};if(b){console.log(">> Scroll _deltaPositionFromBeginning("+C._deltaPositionFromBeginning.x+", "+C._deltaPositionFromBeginning.y+")")}clearTimeout(v);if(!C.options.useRequestAnimationFrame){if(C.options.events.onScroll){C.options.events.onScroll.call(C,C.getPosition())}if(C.options.scrollDebounceTimeout>0){u()}else{w()}}v=setTimeout(function(){if(b){console.log("<<<< END >>>>")}C._deltaPositionFromBeginning={x:0,y:0};if(C.options.events.onScrollEnd){C.options.events.onScrollEnd.call(C,C.getPosition())}if(C.options.useRequestAnimationFrame){cancelAnimationFrame(A)}C._modelEvents.publish({event:"SCROLL_END",context:C});y=true},C.options.scrollEndTimeout)}function B(F){D(F)}function E(){if(C.options.events.onScroll){C.options.events.onScroll.call(C,C.getPosition())}if(C.options.scrollDebounceTimeout>0){u()}else{w()}A=requestAnimationFrame(E)}var t=false;try{var s=Object.defineProperty({},"passive",{get:function(){t=true}});window.addEventListener("testPassive",null,s);window.removeEventListener("testPassive",null,s)}catch(z){}if(this.options.scrollDebounceTimeout){var x=a.debounce(function(){B()},this.options.scrollDebounceTimeout);this.elements.container.addEventListener("scroll",x,t?{passive:true}:false)}else{this.elements.container.addEventListener("scroll",D,t?{passive:true}:false)}d.Element.addEvent.call(this.elements.container,"wheel",function(J){if(!J.ctrlKey&&!J.shiftKey){var F=e(J);var L=Math.abs(F.pixelY);var H=50;var K=0;var I=((F.pixelY<0)&&(C.elements.container.scrollTop===0))||((F.pixelY>0)&&(C.elements.container.scrollHeight-C.elements.container.scrollTop===C.elements.container.clientHeight));if(I){return}J.preventDefault();while(K<=L){K=K+H;var G=C.elements.container.scrollTop+(F.spinY*H);C.elements.container.scrollTop=G}}})},setPosition:function(s,t){if(s.x===undefined){s.x=this.elements.container.scrollLeft}if(s.y===undefined){s.y=this.elements.container.scrollTop}this._lastScrollDirection=this._scrollDirection;this._scrollDirection={x:(this._scrollPosition.x-this._lastScrollPosition.x)>0?1:-1,y:(this._scrollPosition.y-this._lastScrollPosition.y)>0?1:-1};if(this._lastScrollDirection.y!==0&&this._lastScrollDirection.y!==this._scrollDirection.y){this._modelEvents.publish({event:"VERTICAL_SCROLL_DIRECTION_CHANGED",context:this})}if(this._lastScrollDirection.x!==0&&this._lastScrollDirection.x!==this._scrollDirection.x){this._modelEvents.publish({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED",context:this})}this._lastScrollPosition=this._scrollPosition;this._scrollPosition=s;if(t){this.elements.container.scrollTop=s.y;this.elements.container.scrollLeft=s.x}},_resetDeltaScrollPositionFromBeginning:function(){this._beginScrollPosition={x:this._scrollPosition.x,y:this._scrollPosition.y};this._deltaPositionFromBeginning={x:0,y:0}},getDeltaScrollPositionFromBeginning:function(){return this._deltaPositionFromBeginning},resetPosition:function(){this.setPosition({x:0,y:0});this.setPosition({x:0,y:0},true)},scrollToPosition:function(E){console.warn("Don't use this method yet");E=d.extend({scrollDuration:2000,position:{x:0,y:0,onComplete:function(){}}},E);var t=this.elements.container;var D=t.scrollTop,z=t.scrollLeft,y=Math.PI/(E.scrollDuration/15),s=z-E.x,x=D-E.y;var B=0,A=0,C,v;var u=null;requestAnimationFrame(w);function w(G){var F;if(u===null){u=G;console.warn("start")}F=G-u;y=1-Math.cos((Math.PI*(1-((E.scrollDuration-F)/E.scrollDuration))));var I,H;if(s<0){I=t.scrollLeft<E.x}if(s>0){I=t.scrollLeft>E.x}if(x<0){H=t.scrollTop<E.y}if(x>0){H=t.scrollTop>E.y}if(H||I){if(t.scrollTop!==E.y){requestAnimationFrame(w);B=B+1;v=Math.floor(x*y);t.scrollTop=Math.floor(D-v)}if(t.scrollLeft!==E.x){requestAnimationFrame(w);A=A+1;C=Math.floor(s*y);t.scrollLeft=Math.floor(z-C)}}}},getPosition:function(s){if(s){return{x:this.elements.container.scrollLeft,y:-this.elements.container.scrollTop}}else{return this._scrollPosition}},getDeltaScrollPosition:function(){return{x:this._scrollPosition.x-this._lastScrollPosition.x,y:this._scrollPosition.y-this._lastScrollPosition.y}}});return o});define("DS/Controls/Deck",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Maths/Vector3","DS/Utilities/Utils"],function(h,b,g,e,a,d){var c={translate:true,translate3d:true,translateX:true,translateY:true,translateZ:true,rotate:true,rotate3d:true,rotateX:true,rotateY:true,rotateZ:true,scale3d:true};var f=g.extend({init:function(i){this._transitionCounter=0;var j={selector:null,onComplete:function(){}};this.settings=h.extend(j,i);this.container=document.querySelector(this.settings.container);if(typeof this.settings.selector==="string"){this.items=d.listToArray(document.querySelectorAll(this.settings.selector));e.log("selector is string")}else{this.items.push(this.settings.selector);e.log("selector is uwa element")}e.log(this.items);this.currentEffectIndice=0;this.play()},buildSkeleton:function(){var i=this.elements;i.container=new h.Element("div",{"class":"AfrActionBar2",events:null});i.itemContainer=i.container},_attachTransition:function(){var i=this;this._transitionCounter=this.items.length;this.items.forEach(function(j){j.style.webkitTransition=i.settings.duration+"ms "+i.settings.ease});setTimeout(function(){i.nextEffect()},i.settings.duration)},_dettachTransition:function(){this.items.forEach(function(i){i.style.webkitTransition=""})},initial:function(){this.items.forEach(function(i){i.style.webkitTransform=""})},play:function(k){if(k===undefined){k=0}var j=this.settings.distributions[k];if(j){var m=this;var l;var o=this.items.length;this._attachTransition();setTimeout(function(){for(l=0;l<o;l++){m._iterate(l,m.items[l],j)}},10)}},_iterate:function(n,r,j){var l=r.style.webkitTransform;for(var o in j){if(typeof j[o]==="string"){r.style[o]=j[o]}else{var p=j[o](n,r,this.items);if(c[o]){var m="";var q="";switch(o){case"scale3d":q=/scale3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)\)/;var k=new a([p.x,p.y,p.z]);m=k.toString();break;case"translate3d":q=/translate3d\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/;var k=new a([p.x,p.y,p.z]);m=k.toString();break;case"rotate3d":q=/rotate3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)rad\)/;var k=new a([p.x,p.y,p.z]);m=k.toString()+", "+p.a+"rad";break}l=l.replace(q,"");l+=" "+o+"("+m+")"}else{r.style[o]=p}}}e.log("transform:"+l);r.style.webkitTransform=l},nextEffect:function(){this.currentEffectIndice++;if(this.settings.distributions[this.currentEffectIndice]){this.play(this.currentEffectIndice)}}});return f});define("DS/Controls/ViewBase",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(f,e,c,b,d){var a=e.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[],icon:"",color:null},init:function(g){this._parent(g);this._modelEvents=new d();this.elements.container=this.elements.thumbnail=new f.Element("div",{"class":"wux-controls-"+this.options.view+" wux-ui-size-"+this.options.size});this.elements.picture=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-picture"}).inject(this.elements.thumbnail);this.elements.cartouche=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-cartouche"}).inject(this.elements.thumbnail);this.elements.cartoucheContent=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-cartouche-content"}).inject(this.elements.cartouche);this.elements.color=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-color"}).inject(this.elements.cartoucheContent);this.elements.title=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-title wux-ui-size-"+this.options.size+" wux-font-3dsregular"}).inject(this.elements.cartoucheContent);this.elements.subtitle=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent);this.elements.menu=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-menu wux-ui-size-"+this.options.size}).inject(this.elements.thumbnail);this.elements.menu.addClassName("wux-ui-3ds");this.elements.menu.addClassName("wux-ui-3ds-open-down");this.elements.description=new f.Element("div",{"class":"wux-controls-"+this.options.view+"-description"}).inject(this.elements.cartoucheContent)},_attachEvents:function(){var g=this;this.elements.container.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"containerUp",context:g})});this.elements.picture.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"pictureUp",context:g})});this.elements.title.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"titleUp",context:g})});this.elements.subtitle.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"subtitleUp",context:g})});this.elements.description.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"descriptionUp",context:g})});this.elements.cartouche.addEventListener(b.POINTERUP,function(h){g._modelEvents.publish({event:"cartoucheUp",context:g})})},onClick:function(g){return this._modelEvents.subscribe({event:"containerUp"},g)},onCartoucheClick:function(g){return this._modelEvents.subscribe({event:"cartoucheUp"},g)},onTitleClick:function(g){return this._modelEvents.subscribe({event:"titleUp"},g)},onSubtitleClick:function(g){return this._modelEvents.subscribe({event:"subtitleUp"},g)},onDescriptionClick:function(g){return this._modelEvents.subscribe({event:"descriptionUp"},g)},onPictureClick:function(g){return this._modelEvents.subscribe({event:"pictureUp"},g)},setColor:function(g){if(g){this.elements.container.setAttribute("has-color","true");this.elements.color.setStyles({background:g}).show()}else{this.elements.container.setAttribute("has-color","false");this.elements.color.hide()}},setTitle:function(g){if(this.elements.menu&&this.elements.menu.cellView){this.elements.title.layoutDsModel=this.elements.menu.cellView.getGridEngine();var h=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(h))===false){this.elements.title.textContent=g;return}}this.elements.title.setHTML(g)},setSubtitle:function(g){if(this.elements.menu&&this.elements.menu.cellView){this.elements.subtitle.layoutDsModel=this.elements.menu.cellView.getGridEngine();var h=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(h))===false){this.elements.subtitle.textContent=g;return}}this.elements.subtitle.setHTML(g)},setPicture:function(g){this.elements.picture.setStyles({backgroundImage:"url("+g+")"})},setDescription:function(h){if(this.elements.menu&&this.elements.menu.cellView){this.elements.description.layoutDsModel=this.elements.menu.cellView.getGridEngine();var g=this.elements.menu.cellView.getCellInfos();if(c.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(g))===false){this.elements.description.textContent=h;return}}this.elements.description.setHTML(h)}});return a});define("DS/Controls/Switch",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Segmented","DS/Utilities/UUID","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(c,i,f,h,d,j,b,e){var g="EVT_CHANGE";var a=f.extend({defaultOptions:{label:null,value:false,onChange:null,size:"mid"},init:function(k){console.warn("/!\\************************************   WEB UX TEAM    ***************************************/!\\");console.warn("/!\\*********************       MESSAGE TO THE SWITCH CONTROL USERS         *********************/!\\");console.warn("/!\\*********************         Switch control is deprecated              *********************/!\\");console.warn("/!\\*********************     Please migrate to the Toggle control asap     *********************/!\\");console.warn("/!\\*********************     Please see the Toggle API in the Showroom     *********************/!\\");console.warn("/!\\*********************************************************************************************/!\\");this._parent(k);this.options.size="mid";this._uuid=j.v4();this._modelEvents=new b();this._buildView();this.setValue(this.options.value,false);this._proxifyEvents()},_buildView:function(){this.elements.container=new c.Element("ul",{"class":"wux-ui-stack-h wux-controls-switch wux-ui-size-"+this.options.size,styles:{display:this.options.label?"block":"inline-block"}});if(this.options.label){this.elements.label=new c.Element("li",{"class":"wux-controls-switch-label",html:this.options.label}).inject(this.elements.container)}this.elements.switchContainer=new c.Element("li",{"class":"wux-controls-switch-container"}).inject(this.elements.container);this.elements.checkbox=new c.Element("input",{"class":"wux-controls-switch-checkbox",id:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer);this.elements.outer=new c.Element("label",{"class":"wux-controls-switch-outer","for":"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer);this.elements.inner=new c.Element("div",{"class":"wux-controls-switch-inner"}).inject(this.elements.outer);this.elements.button=new c.Element("div",{"class":"wux-controls-switch-button"}).inject(this.elements.outer)},_proxifyEvents:function(){var k=this;var k=this;this.elements.container.addEvent("click",function(l){l.stopPropagation();k.setValue(!k.elements.checkbox.checked)});this.elements.checkbox.addEventListener("change",function(l){l.stopPropagation()});this.elements.container.addEvent("mousedown",function(l){l.stopPropagation()});this.elements.container.addEvent("mouseup",function(l){l.stopPropagation()})},onChange:function(k){return this._modelEvents.subscribe({event:g},k)},getValue:function(){return this.elements.checkbox.checked},setValue:function(m,k){var l=this;if(k===undefined){k=true}this.elements.checkbox.checked=m;if(this.elements.checkbox.checked){this.elements.container.setAttribute("checked","true");this.elements.checkbox.setAttribute("checked","true")}else{this.elements.container.removeAttribute("checked");this.elements.checkbox.removeAttribute("checked")}if(k){if(l.options.onChange){l.options.onChange.call(l,l.getValue())}l._modelEvents.publish({context:l,event:g,data:l})}}});return a});define("DS/Controls/TooltipModel",["UWA/Core","DS/Core/BaseComponent","DS/WebappsUtils/WebappsUtils"],function(e,a,d){var c={SINGLELINE:0,MULTILINE:1};Object.freeze(c);var b=a.inherit({_reachableState:false,publishedProperties:{owner:{defaultValue:undefined,type:"object"},title:{defaultValue:"",type:"string"},shortHelp:{defaultValue:"",type:"string"},longHelp:{defaultValue:"",type:"string"},shortHelpImage:{defaultValue:"",type:"string"},longHelpImage:{defaultValue:"",type:"string"},shortHelpImageDimension:{defaultValue:{x:150,y:75},type:"vector2"},longHelpImageDimension:{defaultValue:{x:150,y:75},type:"vector2"},initialDelay:{defaultValue:1000,type:"integer"},shortToLongDelay:{defaultValue:2000,type:"integer"},reshowDelay:{defaultValue:1000,type:"integer"},mouseRelativePosition:{defaultValue:true,type:"boolean"},position:{defaultValue:"bottom",type:"string"},wrapPolicy:{defaultValue:c.MULTILINE,type:"integer"},wrapThreshold:{defaultValue:270,type:"integer"},allowUnsafeHTMLTitle:{defaultValue:undefined,type:"boolean"},allowUnsafeHTMLShortHelp:{defaultValue:undefined,type:"boolean"},allowUnsafeHTMLLongHelp:{defaultValue:undefined,type:"boolean"},moreHelpCB:{defaultValue:undefined,type:"function"},getAllInformationCB:{defaultValue:undefined,type:"function"}},_applyProperties:function(f){this._parent(f);if(this.isDirty("moreHelpCB")){this._applyMoreHelpCB(f.moreHelpCB,this._properties.moreHelpCB.value)}},_applyMoreHelpCB:function(f,g){if(g!==f){this._reachableState=Boolean(g instanceof Function)}},isEmpty:function(){return(this.longHelp===""&&this.shortHelp===""&&this.title==="")},loadFromHelpRscFile:function(j,l){if(j){var g=j.split("/");var i="i18n!"+g[0];var f=g.splice(0,1);i+="/assets/help/"+g.join("/");var k=this;var h=l;require([i,"DS/WebUAUtils/WebUAUtils"],function(o,m){var q=function(r,s){return d.getWebappsBaseUrl()+r+"/assets/graphic/"+s};k.title=o[h+".Title"];if(o[h+".ShortHelp"]){k.shortHelp=o[h+".ShortHelp"]}if(o[h+".LongHelp"]){k.longHelp=o[h+".LongHelp"]}if(o[h+".ShortHelpImage"]){k.shortHelpImage=q(f,o[h+".ShortHelpImage"])}if(o[h+".LongHelpImage"]){k.longHelpImage=q(f,o[h+".LongHelpImage"])}var p={};p.helpid=h;p.content=o;var n=m.getMoreHelpCallback(p);if(n!==undefined){k.moreHelpCB=n}})}},setAllPropertiesFromAllInformationCB:function(){if(this.getAllInformationCB&&this.getAllInformationCB instanceof Function){var f=this.getAllInformationCB.call();if(!f.updateModel){for(var g in this.publishedProperties){if(g==="owner"||g==="getAllInformationCB"){continue}this[g]=f.model[g]?f.model[g]:this.publishedProperties[g].defaultValue}}else{for(var g in f.model){if(g==="owner"||g==="getAllInformationCB"){continue}this[g]=f.model[g]}}}}});b.WrapPolicy=c;return b});define("DS/Controls/Gauge",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents"],function(h,b,g,f,e,d){var a="change";var c=g.extend({defaultOptions:{snap:0,value:0,minValue:0,minDeltaValue:0,maxValue:360,stepValue:1,graduations:12,graduationsLabel:true,dynamicGraduations:false,dynamicGaugeColor:true,showCursorLabel:true,theme:{shiftCursorOnBorders:true,fontSize:10,height:22,gaugeHeight:10,cursor:{width:16,height:16,borderRadius:"50%"},width:200,graduations:{width:1,height:24}},displayFunction:function(i){return i.toString()},onChange:null},init:function(i){if(i.graduations>=0&&typeof i.graduations==="number"){i.graduations--}this._parent(i);this._modelEvents=new e();if(this.options.className){this.className=this.options.className}this._value=[];this._resolutionfactor=1;this._isRangeMode=this.options.value instanceof Array;this._realRange=this.options.maxValue-this.options.minValue;this._gaugeSize=parseInt(this.options.theme.height*0.75,10);this._buildSkeleton();this._virtualRange=this.elements.container.getDimensions().width;this._buildScaling();this._buildCursor(0);this._buildCursor(1);this._attachBehaviors();this.setValue(this.options.value)},_percentToRealValue:function(i){return i*this._realRange+this.options.minValue},_realValueToPercent:function(j){var i=(j-this.options.minValue)/this._realRange;return i},_percentToVirtualValue:function(i){return i*this._virtualRange},_virtualToRealValue:function(l,m){if(m===undefined){m=1}var k=this.elements.container;var i=k.getDimensions().width;var j=l/i;var n=this._percentToRealValue(j);return{value:n,percent:j}},_realToVirtualValue:function(k){var i=k/this._realRange;var j=this._percentToVirtualValue();return{value:j,percent:i}},_buildScaling:function(){var q=0;var n=this.options.graduations;var j=h.typeOf(n);var l;var r;if(j==="array"){l=n.length;r=l}else{l=parseInt(n,10);r=l+1}var o=-parseInt(this.options.theme.fontSize+5,10);for(var m=0;m<r;m++){var p;var y;if(this.options.dynamicGraduations){var u=(180-m*180/l);y="hsl("+u+", 100%, 50%)";p=0}else{y=this.options.inactiveGraduationsColor;p=1}if(j==="array"){q=this._realToVirtualValue(n[m].value).percent}else{q=m/l}var k=new h.Element("div",{"class":"wux-Gauge-scale",styles:{position:"absolute",opacity:p}});var t=new h.Element("div",{styles:{position:"relative"}}).inject(k);if(this.options.graduationsLabel){var w;if(j==="array"){w=n[m].label}else{w=this._percentToRealValue(parseFloat(q))}var s=this;var z=new h.Element("div",{"class":"wux-Gauge-scale-label","data-value":s._percentToRealValue(q),styles:{position:"absolute",top:o,fontSize:this.options.theme.fontSize,color:this.options.graduationsLabelColor},html:w.toString(),events:{click:function(x){var i=h.Event.getElement(x);var A=i.getAttribute("data-value");s.setValue(A)}}});z.inject(t)}var v=q*100;k.setStyles({backgroundColor:y,top:-2,left:v+"%",marginLeft:(m===(r-1))?-1:0,width:this.options.theme.graduations.width,height:this.options.theme.graduations.height}).inject(this.elements.container)}},_buildCursor:function(l){var j=-2;var m=new h.Element("div",{"class":"wux-Gauge-scale wux-Gauge-cursor",styles:{display:this.options.showCursorLabel?"block":"none",position:"absolute",width:this.options.theme.cursor.width,height:this.options.theme.cursor.height,marginLeft:-this.options.theme.cursor.width/2,top:(this.options.theme.height-this.options.theme.cursor.height)/2,borderRadius:this.options.theme.cursor.borderRadius}});if(this._isRangeMode||l!==0){m.inject(this.elements.container)}var k=new h.Element("div",{}).inject(m);var i=new h.Element("div",{"class":"wux-Gauge-scale-label",styles:{marginLeft:this.options.theme.cursor.width/2,bottom:j},html:this._value}).inject(k);if(this._isRangeMode){i.setAttribute("data-side",l?"right":"left")}this._cursors[l]=i;this._scales[l]=m},_buildSkeleton:function(){this.elements.container=h.Element("div",{"class":"wux-controls-gauge "+this.className,styles:{position:"relative",marginTop:20,height:this.options.theme.height}});this.elements.control=h.Element("div",{"class":"wux-Gauge-control wux-ui-material-"+this.options.GaugeMaterial,styles:{position:"absolute",top:(this.options.theme.height-this.options.theme.gaugeHeight)/2,height:this.options.theme.gaugeHeight}}).inject(this.elements.container);var i="";this.elements.gauge=h.Element("div",{"class":"wux-Gauge wux-ui-indicator-"+this.options.GaugeIndicator+" wux-ui-material-"+this.options.GaugeMaterial+i+" "+this.className,styles:{}}).inject(this.elements.control);this.elements.gaugeTop=h.Element("div",{"class":"wux-Gauge-top"});this.elements.gaugeBottom=h.Element("div",{"class":"wux-Gauge-bottom"});this._cursors=[];this._scales=[]},addEvent:function(i,j){return this._subscribe(i,j)},_removeEvent:function(i){return this._modelEvents.unsubscribe(i)},_removeEventListener:function(i){return this._modelEvents.unsubscribe(i)},addEventOnce:function(i,j){return this._modelEvents.subscribeOnce({event:i},j)},addEventListener:function(i,j){return this._subscribe(i,j)},_subscribe:function(i,j){return this._modelEvents.subscribe({event:i},j)},_updateGaugePercent:function(k){var i=this.elements.gauge;var j={position:"absolute",left:100*k[0]+"%",right:(100-100*k[1])+"%"};if(this.options.dynamicGaugeColor){var l=(120-k[1]*100);j.backgroundColor="hsl("+l+", 100%, 50%)"}i.setStyles(j);this._updateCursor(0,this._realValueToPercent(this._value[0]),this._value[0]);this._updateCursor(1,this._realValueToPercent(this._value[1]),this._value[1])},_updateCursor:function(i,l,o){var q=this._cursors[i];var j=this._scales[i];var m=this._labelWidth[i];var p=this._controlWidth;var k=l*p;if(this.options.theme.shiftCursorOnBorders){if(p>0){var s=k-m/2;var r=k+m/2;if(s<0){q.setStyles({marginLeft:this.options.theme.cursor.width})}else{if(r>=p){q.setStyles({marginLeft:0})}else{q.setStyles({marginLeft:this.options.theme.cursor.width/2})}}}}var n=l*100;j.setStyles({left:n+"%"});if(this._isRangeMode){q.setHTML(this.options.displayFunction(this._value[i].toString()))}else{q.setHTML(this.options.displayFunction(this.getValue().toString()))}},_constraintValue:function(k){var j=0;var i=this.options.stepValue.toString();if(i.split(".")[1]){j=i.split(".")[1].length}if(k>this.options.maxValue){k=this.options.maxValue}if(k<this.options.minValue){k=this.options.minValue}if(this._isRangeMode){var l=(this._value[1]-this._value[0]);if(l<=this.options.minDeltaValue){if(this._selectedEdge===0){k=this._value[1]-this.options.minDeltaValue}if(this._selectedEdge===1){k=this._value[0]+this.options.minDeltaValue}}}k=(Math.round(k/this.options.stepValue)*this.options.stepValue).toFixed(j);if(j){return Number(k).toFixed(j)}else{return parseFloat(k)}},_setValue:function(l,j,i){if(j===undefined){j=true}if(i===undefined){i=false}if(this._isRangeMode){if(l instanceof Array){if(this._selectedEdge===0){this._value[0]=this._constraintValue(l[0]*this._resolutionfactor)}if(this._selectedEdge===1){this._value[1]=this._constraintValue(l[1]*this._resolutionfactor)}if(this._selectedEdge===null){this._value[0]=this._constraintValue(l[0]*this._resolutionfactor);this._value[1]=this._constraintValue(l[1]*this._resolutionfactor)}}else{console.warn("You must provide an array as value when you want to use a range gauge")}}else{this._value[0]=this.options.minValue;this._value[1]=this._constraintValue(l*this._resolutionfactor)}var k=[this._realValueToPercent(this._value[0]),this._realValueToPercent(this._value[1])];this._updateGaugePercent(k);if(j){if(this.options.onChange){this.options.onChange.call(this,this.getValue())}this._modelEvents.publish({context:this,event:a,data:this})}},setValue:function(j,i){this._selectedEdge=null;this._setValue(j,i)},enable:function(){this.getContent().removeClassName("wux-ui-state-disabled").setStyle("pointer-events","")},disable:function(){this.getContent().addClassName("wux-ui-state-disabled").setStyle("pointer-events","none")},_attachBehaviors:function(){var r=this;var p=this.elements.container;var s=this.elements.gauge;var i,m,t,o,l,k;var u=r._cursors;r._labelWidth=[];r._labelWidth[0]=u[0].getDimensions().width;r._labelWidth[1]=u[1].getDimensions().width;function n(y){y.preventDefault();r._resolutionfactor=1;r.elements.container.addClassName("wux-ui-state-active");r._controlWidth=r.elements.control.getDimensions().width;var A=r._controlWidth;var x=s.getDimensions();var z=s.getOffsets();i={y:z.y+x.height/2,x:z.x};var w=(Number(r._value[1])+Number(r._value[0]))/2;m=r._realValueToPercent(r._value[0])*A;t=i.x-y.pageX-m;o=r._virtualToRealValue(-t);l=o.value<w?0:1;r._selectedEdge=l;k=r.getValue();if(r._isRangeMode){k[l]=o.value}else{k=o.value}r._setValue(k);v=true;document.addEventListener(d.POINTERMOVE,q);document.addEventListener(d.POINTERUP,j)}function q(w){if(v){t=i.x-w.pageX-m;o=r._virtualToRealValue(-t);if(r._isRangeMode){k[l]=o.value}else{k=o.value}r._setValue(k,true,true)}}function j(w){r._resolutionfactor=1;v=false;r.elements.container.removeClassName("wux-ui-state-active");document.removeEventListener(d.POINTERMOVE,q);document.removeEventListener(d.POINTERUP,j)}var v=false;p.addEvent(d.POINTERDOWN,n);h.Element.addEvent.call(p,"mousewheel",function(x){var y=h.Event.wheelDelta(x);var w=x.shiftKey;if(w){y*=5}})},getValue:function(){if(this._isRangeMode){return this._value}else{return parseFloat(this._value[1])}}});return c});define("DS/Controls/Timeline",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/Gauge","DS/CoreEvents/Events"],function(f,a,e,b,c){var d=b.extend({className:"wux-timeline",defaultOptions:{},init:function(g){if(g.beginDate){g.minValue=new Date(g.beginDate).valueOf()}if(g.endDate){g.maxValue=new Date(g.endDate).valueOf()}if(g.dateAtInit){g.value=new Date(g.dateAtInit).valueOf()}if(g.date){g.value=new Date(g.date).valueOf()}if(!g.displayFunction&&g.beginDate){g.displayFunction=function(j){if(j){var i=new Date(j);return i.strftime("%Y-%m-%d")}}}if(!g.displayFunction&&!g.beginDate){g.displayFunction=function(i){return i}}g.graduations=[];var h=this;this._isDateBased=true;this._eventsList=[];if(g.eventsList){g.eventsList.forEach(function(j){var k;if(j.date){k=new Date(j.date).valueOf()-g.minValue;h._isDateBased=true}else{k=j.value-g.minValue;h._isDateBased=false}var i={label:j.label,value:k,onEvent:j.onEvent,state:0};g.graduations.push(i)})}this._parent(g);this._isPlaying=false},_play:function(h,g){var i=this;var j=this._value[1];j=parseFloat(j,10)+parseFloat(h,10);i.setValue(j);i.elements.container.addClassName("wux-ui-state-active");if(j!==i.options.minValue&&j!==i.options.maxValue&&i._isPlaying){this.playerTO=setTimeout(function(){if(i._isPlaying){i._play.call(i,h,g)}},g)}},play:function(h,i){if(i===undefined){i=true}this._isPlaying=false;if(h===undefined){h=1}var j=this;j._isPlaying=true;var g=20;window.clearTimeout(this.playerTO);j._play(h/g,1000/g);if(i){this._modelEvents.publish({event:"PLAY",context:this})}},pause:function(g){if(g===undefined){g=true}this.elements.container.removeClassName("wux-ui-state-active");this._isPlaying=false;if(g){this._modelEvents.publish({event:"PAUSE",context:this})}},stop:function(g){if(g===undefined){g=true}this.elements.container.removeClassName("wux-ui-state-active");this.pause(false);this.setValue(this.options.minValue);if(g){this._modelEvents.publish({event:"STOP",context:this})}},onPlay:function(g){return this._modelEvents.subscribe({event:"PLAY"},g)},onPause:function(g){return this._modelEvents.subscribe({event:"PAUSE"},g)},onStop:function(g){return this._modelEvents.subscribe({event:"STOP"},g)},next:function(){},previous:function(){},setValue:function(i,g){var h=this;this._setValue(i,g);if(h._value[1]===h.options.maxValue){h.pause()}h.options.graduations.forEach(function(j){var k=(j.value+h.options.minValue);if(h._value[1]>=k&&j.state===0){j.state=1;if(j.onEvent){j.onEvent.call(h)}}if(h._value[1]<k&&j.state>0){j.state=0}})},getValue:function(){if(this._isDateBased){var g=new Date();g.setTime(this._value[1]);return g}else{return this._value[1]}}});return f.namespace("WUX/Controls/Timeline",d)});define("DS/Controls/Tile",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Color","DS/Controls/Deck","DS/Core/PointerEvents"],function(g,l,i,c,j,e,a,h){var b="push-left";var k="push-right";var f="flip";function d(r){var o=parseFloat(r),n=r.replace(/^[\-\d\.]+/,"");return isNaN(o)?{v:n,f:color,u:""}:{v:o,f:interpolate,u:n}}var m=i.extend({defaultOptions:{rows:2,container:window,color:false,effects:"flip",button:false},init:function(n){this._parent(n);var p=this;this._id=g.Utils.getUUID();this._flagIsSecondary=false;var o=this.options.effects.split(":");this._effect=o[0];this._effectParam=parseFloat(o[1]);if(o[1]){this._effectParamUnit=o[1].replace(/^[\-\d\.]+/,"")}this.buildSkeleton();this._zIndex=this.elements.container.style.zIndex;this.elements.infos.addEvent(h.POINTERUP,function(q){q.preventDefault();q.stopPropagation();switch(p._effect){case f:p.rotate();break;case b:p.pushLeft();break;case k:p.pushRight();break}})},buildSkeleton:function(){var s=this;var u="white";if(this.options.color){u=e.random()}var n=800,q=200;var p="url(http://placekitten.com/g/"+(Math.ceil(n+Math.random()*n))+"/"+(Math.ceil(q+Math.random()*q))+")";var t=this.elements,o=this.options;var r="";if(this._effect==b||this._effect==k){r=""}if(this._effect==f){r=" Back"}t.container=new g.Element("div",{id:s._id,"class":"WUXTile",events:null});t.container.setAttributes({"data-color":e.hexToHsl(u)});t.front=new g.Element("div",{"class":"Primary Tile",id:g.Utils.getUUID(),styles:{backgroundSize:"cover",background:u},events:null});t.back=new g.Element("div",{"class":"Secondary Tile"+r,html:{tag:"div","class":"Logo"},events:null});t.infos=new g.Element("div",{"class":"Infos",html:"i",events:null});if(!this.options.button){t.infos.hide()}t.infos.inject(t.container);t.front.inject(t.container);t.back.inject(t.container)},setPrimaryViewContent:function(n,o){this.elements.front.setHTML(n);if(o){this.elements.front.setStyles(o)}},setSecondaryViewContent:function(n,o){this.elements.back.setHTML(n);if(o){this.elements.front.setStyles(o)}},setAlternativeViewContent:function(n,o){if(this.elements.container.hasClassName("Flip")){this.setPrimaryViewContent(n,o);this.displayPrimaryView()}else{this.setSecondaryViewContent(n,o);this.displaySecondaryView()}},toggleView:function(n,o){if(this.elements.container.hasClassName("Flip")){if(n){this.setPrimaryViewContent(n,o)}this.displayPrimaryView()}else{if(n){this.setSecondaryViewContent(n,o)}this.displaySecondaryView()}},displayAlternativeView:function(n,o){console.warn("deprecated","Controls/Tile","method displayAlternativeView is deprecated. Please use toggleView method");this.toggleView(n,o)},getPrimaryView:function(){return this.elements.front},getSecondaryView:function(){return this.elements.back},pushLeft:function(){this.elements.container.toggleClassName("wux-ui-state-left");var o=this;var p='[id="'+o.getPrimaryView().id+'"]';var q=this._effectParam;if(!this._flagIsSecondary){q="-"+q}if(this._flagIsSecondary&&this._effectParamUnit=="px"){q=0}q=q+this._effectParamUnit;this._flagIsSecondary=!this._flagIsSecondary;var n=new a({selector:p,container:"body",distributions:[{translate3d:function(t,s,r){return{x:q,y:0,z:0}}}],duration:200,ease:"ease-in-out"})},pushRight:function(){this.elements.container.toggleClassName("wux-ui-state-right");var n=this;var o='[id="'+n.getPrimaryView().id+'"]';var p=this._effectParam;if(this._flagIsSecondary){p=0}if(this._flagIsSecondary&&this._effectParamUnit=="px"){p=0}p=p+this._effectParamUnit;this._flagIsSecondary=!this._flagIsSecondary;this.elements.front.setStyles({transition:"transform ease-in-out 0.2s"});this.elements.front.setStyles({transform:"translate3d("+(p)+", 0, 0)"})},displayPrimaryView:function(n,o){if(n){this.setPrimaryViewContent(n,o)}this.elements.container.removeClassName("Flip")},displaySecondaryView:function(n,o){if(n){this.setSecondaryViewContent(n,o)}this.elements.container.addClassName("Flip")},rotate:function(){this.elements.container.toggleClassName("Flip")}});return g.namespace("WUX/Controls/Tile",m)});define("DS/Controls/Abstract",["UWA/Drivers/Alone","UWA/Core","UWA/Element","DS/Core/BaseComponent","DS/Controls/TooltipModel","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Utilities/TouchUtils","DS/Utilities/Utils","DS/Utilities/Dom"],function(l,f,b,e,h,c,k,m,o,i,a){var n=false;var d=false;var j=function(r,t,s){var q=document.createEvent("Event");if(s===undefined||s===null){s={}}var p=(s.bubbles!==undefined)?s.bubbles:true;q.initEvent(t,p,false);q.dsModel=r;q.options=s;return q};var g=e.inherit({name:"abstract",publishedProperties:{domId:{defaultValue:null,type:"string",category:"Behavior"},disabled:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},visibleFlag:{defaultValue:true,type:"boolean",category:"Behavior",recordFlag:true},animation:{defaultValue:null,type:"object",noNeedToApplyFlag:true,category:"Appearance"},touchMode:{defaultValue:undefined,type:"boolean",category:"Accessibility"},tooltipInfos:{defaultValue:undefined,type:"DS/Controls/TooltipModel",category:"Accessibility"},recId:{defaultValue:null,type:"string",category:"Record",uiDisplay:false},fireOnlyFromUIInteractionFlag:{defaultValue:false,type:"boolean",category:"Behavior",noNeedToApplyFlag:true}},blackBoxFlag:false,keymaps:{},commands:{},getPublishedPropertiesDefaultValue:function(){var p={};var q=Object.getPrototypeOf(this);if(q&&q.publishedProperties){for(var r in q.publishedProperties){if(q.publishedProperties.hasOwnProperty(r)){p[r]=q.publishedProperties[r].defaultValue}}}return p},addEventListener:function(q,r,p){this.getContent().addEventListener(q,r,p)},removeEventListener:function(q,r,p){if(this.elements.container||this.container){this.getContent().removeEventListener(q,r,p)}},destroy:function(){if(this._keymapManager){this._keymapManager.destroy()}a.removeAllEventsOnElement(this);this._parent()},_isCurrentlyCalledFromUIInteraction:function(){return a._isCurrentlyCalledFromUIInteraction()},fire:function(r,p){if(this.getContent()&&!this.disabled){var q=a._increaseCurrentPositionInStack(this.getContent());if(!this.fireOnlyFromUIInteractionFlag){this.getContent().dispatchEvent(j(this,r,p))}if(q.inCurrentUIInteractionStack&&q.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_event",reason:"UIInteraction",event:r,eventOptions:p},undefined,true)}}if(q.inCurrentUIInteractionStack&&this.fireOnlyFromUIInteractionFlag){this.getContent().dispatchEvent(j(this,r,p))}if(q.increment){a._decreaseCurrentPositionInStack()}}},setPropertyFromUIInteraction:function(r,q){if(!this.elements.container&&!this.container){return}if(this._properties&&this._properties[r]&&((Array.isArray(q)||(q instanceof Date))?f.equals(this._properties[r].value,q):this._properties[r].value===q)){return}var p=a._increaseCurrentPositionInStack(this.getContent());if(p.inCurrentUIInteractionStack&&p.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_property",property:r,value:q},undefined,true)}}this[r]=q;if(p.increment){a._decreaseCurrentPositionInStack()}},setReadOnlyPropertyFromUIInteraction:function(t,p){if(!this.elements.container&&!this.container){return}var s=t.substring(0,1).toUpperCase()+t.substring(1,t.length);var u="_apply"+s;var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_readOnlyProperties",property:t,value:p},undefined,true)}}for(var q in p){if(!p.hasOwnProperty(q)||!this._properties[t]){continue}this._properties[t][q]=p[q]}if(this[u]){this[u]()}if(r.increment){a._decreaseCurrentPositionInStack()}},modifyObjectFromUIInteraction:function(t,p){if(!this.elements.container&&!this.container){return}var s=t.substring(0,1).toUpperCase()+t.substring(1,t.length);var u="_apply"+s;var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_subproperties",property:t,value:p},undefined,true)}}for(var q in p){if(!p.hasOwnProperty(q)){continue}this[t][q]=p[q]}this[u]();if(r.increment){a._decreaseCurrentPositionInStack()}},modifyArrayFromUIInteraction:function(s,q){if(!this.elements.container&&!this.container){return}var r=a._increaseCurrentPositionInStack(this.getContent());if(r.inCurrentUIInteractionStack&&r.firstTimeInstanceIsCalled){if(this.elements.container){c.addCustomInteraction(this.elements.container,{type:"webUX_property",property:s,value:this[s]},undefined,true)}}var p=Array.prototype.slice.call(arguments,2);q.apply(this[s],p);if(r.increment){a._decreaseCurrentPositionInStack()}},callMethodFromUIInteraction:function(q){var p=Array.prototype.slice.call(arguments,1);return a._callMethodFromUIInteraction(this,this[q],p)},_preBuild:function(r){if(this._preBuildView){this._preBuildView(r)}if(Object.keys(this.keymaps).length>0&&Object.keys(this.commands).length>0){var t=this._getCommandRegistry();var r={target:this.getContent(),jsModel:this,commandsRegistry:t};this._keymapManager=new k(r);for(var s in this.keymaps){if(typeof this.keymaps[s]==="object"){var q=(this.keymaps[s].keydown?this.name+":"+this.keymaps[s].keydown:undefined);var p=(this.keymaps[s].keyup?this.name+":"+this.keymaps[s].keyup:undefined);this._keymapManager.registerKeymap(s,q,p)}else{this._keymapManager.registerKeymap(s,this.name+":"+this.keymaps[s])}}}},_getCommandRegistry:function(){function r(u){var t=u;do{t=t.__proto__;if(t&&t._getCommandRegistry){var s=t._getCommandRegistry();if(s){return s}}}while(t&&t._getCommandRegistry);return null}var p=Object.getPrototypeOf(this);if(!p){return null}if(p.hasOwnProperty("_commandRegistry")){return p._commandRegistry}p._commandRegistry=new m(r(p));for(var q in this.commands){p._commandRegistry.registerCommand(this.name+":"+q,this.commands[q])}return p._commandRegistry},_build:function(){if(this.buildView){this.buildView()}if(this.touchMode===undefined){this._applicationTouchMode=o.getTouchMode();if(this["_applyTouchMode"]){this._applyTouchMode()}}},_postBuild:function(){if(this._postBuildView){this._postBuildView()}if(this._handleEvents){this._handleEvents()}if(this.markForRecordFlag&&this.markForRecord){this.markForRecord(this.getContent())}},_preBuildView:function(){if(!this.elements.container){this.elements.container=new b("div",{"class":"wux-controls-abstract"})}else{this.elements.container.addClassName("wux-controls-abstract")}this.elements.container.dsModel=this},_handleEvents:function(){var p=this;if(this.getContent()){a.addEventOnElement(this,this.getContent(),"focus",function(){p._giveFocus()},true);a.addEventOnElement(this,this.getContent(),"blur",function(){p._resetFocus()},true)}if(this.handleEvents){this.handleEvents()}},_applyDisabled:function(){if(this.disabled){this.getContent().setAttributeNode(document.createAttribute("disabled"));if(this.getContent().getAttributeNode("focused")){this.getContent().removeAttribute("focused")}}else{this.getContent().removeAttribute("disabled")}},_applyTouchMode:function(){var p=this._getCurrentTouchMode();if(p===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}},_getCurrentTouchMode:function(){if(this.touchMode===undefined){return o.getTouchMode()}else{return this.touchMode}},_touchModeChange:function(p){this._applicationTouchMode=p;if(this._applicationTouchMode&&!this.touchMode){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{if(!this._applicationTouchMode&&!this.touchMode){this.getContent().removeAttribute("touch-mode")}}if(this.touchMode===undefined&&this.touchMode!==this._applicationTouchMode){if(this["_applyTouchMode"]){this._applyTouchMode()}}},_applyDomId:function(q){if(this.domId){var p=document.createAttribute("id");p.value=this.domId;this.getContent().setAttributeNode(p)}else{if(q){var r=this.getContent().id;if(q===r){this.getContent().removeAttribute("id")}}}},_applyRecId:function(){if(this.recId){var p=document.createAttribute("data-rec-id");p.value=this.recId;this.getContent().setAttributeNode(p);if(!this.elements.container.getCheckpointData){this.elements.container.getCheckpointData=function(w){var u={};var q=this.dsModel;if(q&&q.publishedProperties){for(var t in q.publishedProperties){var v=q.publishedProperties[t];if(v.recordFlag){if(Array.isArray(v.recordFlag)){if(q[t]){var s={};for(var r=0;r<v.recordFlag.length;r++){s[v.recordFlag[r]]=q[t][v.recordFlag[r]]}u[t]=s}}else{if(q[t]!==undefined){u[t]=q[t]}}}}}w(u,false)}}}else{this.getContent().removeAttribute("data-rec-id");this.elements.container.getCheckpointData=undefined}},_applyVisibleFlag:function(){this.visibleFlag?b.prototype.constructor.show.call(this.getContent()):b.prototype.constructor.hide.call(this.getContent())},_applyTooltipInfos:function(){if(this.tooltipInfos!==undefined){this.tooltipInfos.owner=this}},_applyProperties:function(p){if(this.isDirty("disabled")){this._applyDisabled(p?p.disabled:undefined)}if(this.isDirty("visibleFlag")&&(!p||(p.visibleFlag!==undefined))){this._applyVisibleFlag(p?p.visibleFlag:undefined)}if(this.isDirty("touchMode")){this._applyTouchMode(p?p.touchMode:undefined)}if(this.isDirty("recId")){this._applyRecId(p?p.recId:undefined)}if(this.isDirty("domId")){this._applyDomId(p?p.domId:undefined)}},_giveFocus:function(){this.getContent().setAttributeNode(document.createAttribute("focused"))},_resetFocus:function(){this.getContent().removeAttribute("focused")},_isFocused:function(){return this.getContent().hasAttribute("focused")},show:function(r){r=r||true;var q=this.animation;function p(s){s.target.removeEventListener("animationend",p);s.target.removeClassName("wux-ui-animation-"+q.show+"-in")}this._parent();if(r===true&&q&&q.show){this.getContent().addClassName("wux-ui-animation-"+q.show+"-in");this.getContent().addEventListener("animationend",p)}this.visibleFlag=true},hide:function(s){s=s||true;var r=this.animation;var q=this;function p(t){q.applyVisibleFlag=false;t.target.removeEventListener("animationend",p);t.target.removeClassName("wux-ui-animation-"+r.hide+"-out")}if(s===true&&r&&r.hide){this.getContent().addClassName("wux-ui-animation-"+r.hide+"-out");this.getContent().addEventListener("animationend",p)}else{this.visibleFlag=false}}});return g});require(["DS/UIBehaviors/TooltipManager"],function(a){if(a){require(["DS/Controls/Tooltip"],function(b){if(a._tooltipFrame===undefined){a._tooltipFrame=new b()}})}});define("DS/Controls/Breadcrumb",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Handlebars/Handlebars","DS/Utilities/Dom","DS/Menu/ContextualMenu"],function(b,d,l,m,c,n,k){var u="{{#unless isExpandableSeparator}}                         <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-expand-right wux-ui-3ds-lg'></div>                       {{/unless}}                       {{#if isIconVisible}}                         <div class='wux-controls-breadcrumb-item-icon'>{{&icon}}</div>                       {{/if}}                       {{#if isLabelVisible}}                         <div class='wux-controls-breadcrumb-item-label'>{{label}}</div>                       {{/if}}                       {{#if isExpandableSeparator}}                         <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-chevron-right wux-ui-3ds-lg'></div>                       {{/if}}";var f={task:c.compile(u)};function g(v,x,w){if(!v||!v.elements||!v.elements.container){return}if(x){v.elements.container.setAttributeNode(document.createAttribute("is-hovered"));if(w===1||this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){if(v.elements.icon){v.elements.icon.setAttributeNode(document.createAttribute("is-hovered"))}if(v.elements.label){v.elements.label.setAttributeNode(document.createAttribute("is-hovered"))}}if(w===2||this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){if(v.elements.separator){v.elements.separator.setAttributeNode(document.createAttribute("is-hovered"))}}}else{v.elements.container.removeAttribute("is-hovered");if(v.elements.icon){v.elements.icon.removeAttribute("is-hovered")}if(v.elements.label){v.elements.label.removeAttribute("is-hovered")}if(v.elements.separator){v.elements.separator.removeAttribute("is-hovered")}}}function h(){while(this.elements.container.firstChild){this.elements.container.removeChild(this.elements.container.firstChild)}this._listItems=[];this._applyValue()}function a(v,w){if(typeof(w)==="string"){return v.label===w&&v.value===w&&v.icon===undefined}return v.label===w.label&&v.value===w.value?w.value:w.label&&v.icon===w.icon}function p(w,v){var x={label:"",index:v,selected:false,elements:{}};if(typeof(w)==="string"){x.label=w;x.value=w}else{x.label=w.label?w.label:"";x.icon=w.icon;x.value=w.value?w.value:x.label}q.call(this,x);e.call(this,x);return x}function q(z){z.elements.container=b.createElement("span",{"class":"wux-controls-breadcrumb-item"});z.elements.container.setAttribute("index",z.index);z.elements.container.setAttribute("is-selected",false);var y=z.label&&(this.displayLabels!==j.DISPLAY_ELEMENT.NONE);var A=z.icon&&(this.displayIcons!==j.DISPLAY_ELEMENT.NONE);var w;if(A){var v=b.createElement("div");var x=n.generateIcon(z.icon);v.setContent(x);w=v.innerHTML;v.destroy()}z.elements.container.setContent(f.task({label:z.label,isLabelVisible:y,icon:w,isIconVisible:A,isExpandableSeparator:this.expandableSeparatorFlag}));z.elements.label=y?z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-label")[0]:undefined;z.elements.icon=A?z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-icon")[0]:undefined;z.elements.separator=z.elements.container.getElementsByClassName("wux-controls-breadcrumb-item-separator")[0]}function e(y){var x=this;function w(B){if(x.disabled){return}if(x.mode===j.MODE.MULTIPLE_SELECTION){if(y.selected){for(var z=0;z<x.selectedValues.length;z++){if(a.call(x,y,x.selectedValues[z])){x.selectedValues.splice(z,1);break}}y.selected=false;y.elements.container.setAttribute("is-selected",false)}else{x.selectedValues.push(x.value[y.index]);y.selected=true;y.elements.container.setAttribute("is-selected",true)}x.fire("selectionChange")}else{if(x.mode===j.MODE.EXCLUSIVE_SELECTION){if(!y.selected){x.selectedValues=[x.value[y.index]]}}else{if(x.mode===j.MODE.NAVIGATION){var A=x.value.length-1-y.index;i.call(x,A)}}}}if(this.displayStyle===j.DISPLAY_STYLE.IMMERSIVE){y.elements.container.addEventListener("click",w)}else{if(y.elements.label){y.elements.label.addEventListener("click",w)}if(y.elements.icon){y.elements.icon.addEventListener("click",w)}}if(this.expandableSeparatorFlag){y.elements.separator.addEventListener("click",function v(z){z.stopPropagation();if(!x.disabled){x.fire("separatorClick",{index:y.index})}})}}function s(z){var w;if(z!==undefined){w=z}else{w=this.value.length}if(this.mode===j.MODE.MULTIPLE_SELECTION){for(var v=0;v<this.selectedValues.length;v++){var y=this.selectedValues[v];var A=false;for(var x=0;x<w;x++){A=b.equals(this.value[x],y);if(A){break}}if(!A){this._applySelectedValues();return}}}else{if(this.mode===j.MODE.EXCLUSIVE_SELECTION){if(this.selectedValues.length>1){this._applySelectedValues();return}var A=false;for(var x=0;x<w;x++){A=b.equals(this.value[x],this.selectedValues[0]);if(A){break}}if(!A){this._applySelectedValues()}}else{if(this.mode===j.MODE.NAVIGATION){if(this.value.length>0){if(b.equals(this.value[this.value.length-1],this.selectedValues[0])){this._applySelectedValues()}else{this.selectedValues=[this.value[this.value.length-1]]}}else{this.selectedValues=[]}}}}}function t(){var z=[];if(this.mode===j.MODE.MULTIPLE_SELECTION||this.mode===j.MODE.EXCLUSIVE_SELECTION){for(var v=0;v<this.selectedValues.length;v++){var x=this.selectedValues[v];var y=false;for(var w=0;w<this.value.length;w++){y=b.equals(this.value[w],x);if(y){z.push(w);break}}if(!y){console.error("UpdateSelectedItems should not be call with wrong values.")}}}else{if(this.mode===j.MODE.NAVIGATION){z.push(this.value.length-1)}}for(var v=0;v<this._listItems.length;v++){if(z.indexOf(v)!==-1){this._listItems[v].selected=true;this._listItems[v].elements.container.setAttribute("is-selected",true)}else{this._listItems[v].selected=false;this._listItems[v].elements.container.setAttribute("is-selected",false)}}}function i(w){if(w<=0){return}var x=this._listItems.length-1;for(var v=0;v<w;v++){this.elements.container.removeChild(this._listItems[x-v].elements.container);this._listItems.pop()}this.value.splice(x-w+1,w);s.call(this);this.fire("change")}function o(w){var v=-1;var x=-1;while(w&&v===-1&&!n.hasClass(w,"wux-controls-breadcrumb")){if(n.hasClass(w,"wux-controls-breadcrumb-item-separator")){v=w.parentNode.getAttribute("index");x=2}else{if(n.hasClass(w,"wux-controls-breadcrumb-item-label")||n.hasClass(w,"wux-controls-breadcrumb-item-icon")){v=w.parentNode.getAttribute("index");x=1}else{if(n.hasClass(w,"wux-controls-breadcrumb-item")){v=w.getAttribute("index");x=0}}}w=w.parentNode}return{indexFound:v,itemFound:x}}var j=m.inherit({name:"breadcrumb",publishedProperties:{value:{defaultValue:[],type:"array",category:"Behavior"},selectedValues:{defaultValue:[],type:"array",category:"Helper"},mode:{defaultValue:0,type:"enum",category:"Behavior"},expandableSeparatorFlag:{defaultValue:false,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:0,type:"enum",category:"Appearance"},displayIcons:{defaultValue:1,type:"enum",category:"Appearance"},displayLabels:{defaultValue:1,type:"enum",category:"Appearance"},onContextualEvent:{defaultValue:function r(v){return[]},type:"function",noNeedToApplyFlag:true},customContextMenuFlag:{defaultValue:false,type:"boolean",category:"Behavior",noNeedToApplyFlag:true}},_preBuild:function(){this._parent();this.elements.container.addClassName("wux-controls-breadcrumb");this._listItems=[]},handleEvents:function(){var w=this;var v=-1;this.elements.container.addEventListener("mouseover",function(A){if(w.disabled){return}var y=o.call(w,A.target);var x=y.indexFound;var B=y.itemFound;if(v>-1){if(v<w._listItems.length){var z=w._listItems[v];g.call(w,z,false)}}if(x>-1){var z=w._listItems[x];g.call(w,z,true,B)}if(v!=x){w.fire("preSelection",{oldItem:Number(v),newItem:Number(x)})}v=x});this.elements.container.addEventListener("mouseleave",function(y){if(v>-1){if(v<w._listItems.length){var x=w._listItems[v];g.call(w,x,false)}}w.fire("preSelection",{oldItem:Number(v),newItem:Number(-1)});v=-1});this._ctxMenuToken=k.addEventListener(this.elements.container,{callback:function(B){if((!w.disabled)&&(typeof w.onContextualEvent==="function")){var A=undefined;var x=-1;var z=o.call(w,B.data.target);if((z.indexFound<w._listItems.length)&&(z.indexFound>-1)){A=w._listItems[z.indexFound]}if(A&&A.selected===true){x=z.indexFound}if(x!==-1){var y=w.onContextualEvent.call(w,{context:B.context,infos:B.info,indexFound:x});if(!w.customContextMenuFlag){return y}}}}})},pop:function(){if(this._listItems.length<=0){return}var v=this.value[this.value.length-1];i.call(this,1);return v},push:function(v){this.value.push(v);var w=p.call(this,v,this.value.length-1);this._listItems.push(w);this.elements.container.appendChild(w.elements.container);s.call(this);this.fire("change")},_applyValue:function(x){var z=false;var A=(!this._listItems||this._listItems.length===0)&&this.value.length!==0;var B=undefined;var w=0;for(w;w<this.value.length;w++){if(!A){A=w>=this._listItems.length;if(!A){A=!a.call(this,this._listItems[w],this.value[w]);if(A){for(var v=this._listItems.length-1;v>=w;v--){this.elements.container.removeChild(this._listItems[v].elements.container);this._listItems.pop()}}}}if(A){if(B===undefined){B=w}var y=p.call(this,this.value[w],w);this._listItems.push(y);this.elements.container.appendChild(y.elements.container)}}var z=A;if(!A){for(var v=this._listItems.length-1;v>=w;v--){z=true;this.elements.container.removeChild(this._listItems[v].elements.container);this._listItems.pop()}}s.call(this,B);if(z){this.fire("change")}},_applySelectedValues:function(x){if(this.mode===j.MODE.MULTIPLE_SELECTION){for(var v=0;v<this.selectedValues.length;){var y=this.selectedValues[v];var A=false;for(var w=0;w<this.value.length;w++){A=b.equals(this.value[w],y);if(A){break}}if(A){v++}else{this.selectedValues.splice(v,1)}}}else{if(this.mode===j.MODE.EXCLUSIVE_SELECTION){this.selectedValues.splice(1,this.selectedValues.length-1);var A=false;for(var w=0;w<this.value.length;w++){A=b.equals(this.value[w],this.selectedValues[0]);if(A){break}}if(!A){this._properties.selectedValues.value=[]}}else{if(this.mode===j.MODE.NAVIGATION){var v;for(v=this.value.length-1;v>=0;v--){if(b.equals(this.value[v],this.selectedValues[0])){var z=this.value.length-1-v;if(z>0){i.call(this,this.value.length-1-v);return}break}}if(v<0){this.selectedValues=x;return}}}}t.call(this);this.fire("selectionChange")},_applyMode:function(v){s.call(this)},_applyExpandableSeparatorFlag:function(v){h.call(this);if(this.expandableSeparatorFlag){this.getContent().setAttributeNode(document.createAttribute("expandable-separator"))}else{this.getContent().removeAttribute("expandable-separator")}},_applyDisplayStyle:function(v){this.getContent().setAttribute("display-style",this.displayStyle);h.call(this)},_applyDisplayIcons:function(v){this.getContent().setAttribute("display-icons",this.displayIcons);if(v===j.DISPLAY_ELEMENT.NONE||this.displayIcons===j.DISPLAY_ELEMENT.NONE){h.call(this)}},_applyDisplayLabels:function(v){this.getContent().setAttribute("display-labels",this.displayLabels);if(v===j.DISPLAY_ELEMENT.NONE||this.displayLabels===j.DISPLAY_ELEMENT.NONE){h.call(this)}},_applyDisabled:function(w){this._parent();if(this.disabled){for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.setAttributeNode(document.createAttribute("disabled"));if(x.elements.label){x.elements.label.setAttributeNode(document.createAttribute("disabled"))}if(x.elements.icon){x.elements.icon.setAttributeNode(document.createAttribute("disabled"))}if(x.elements.separator){x.elements.separator.setAttributeNode(document.createAttribute("disabled"))}}}else{for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.removeAttribute("disabled");if(x.elements.label){x.elements.label.removeAttribute("disabled")}if(x.elements.icon){x.elements.icon.removeAttribute("disabled")}if(x.elements.separator){x.elements.separator.removeAttribute("disabled")}}}},_applyTouchMode:function(w){this._parent();if(this.touchMode){for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.setAttributeNode(document.createAttribute("touch-mode"));if(x.elements.label){x.elements.label.setAttributeNode(document.createAttribute("touch-mode"))}if(x.elements.icon){x.elements.icon.setAttributeNode(document.createAttribute("touch-mode"))}if(x.elements.separator){x.elements.separator.setAttributeNode(document.createAttribute("touch-mode"))}}}else{for(var v=0;v<this._listItems.length;v++){var x=this._listItems[v];x.elements.container.removeAttribute("touch-mode");if(x.elements.label){x.elements.label.removeAttribute("touch-mode")}if(x.elements.icon){x.elements.icon.removeAttribute("touch-mode")}if(x.elements.separator){x.elements.separator.removeAttribute("touch-mode")}}}},_applyProperties:function(v){this._parent(v);if(this.isDirty("value")){this._applyValue(v.value)}else{if(this.isDirty("selectedValues")){this._applySelectedValues(v.selectedValues)}}if(this.isDirty("expandableSeparatorFlag")){this._applyExpandableSeparatorFlag(v.expandableSeparatorFlag)}if(this.isDirty("mode")){this._applyDisplayStyle(v.mode)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(v.displayStyle)}if(this.isDirty("displayLabels")){this._applyDisplayLabels(v.displayLabels)}if(this.isDirty("displayIcons")){this._applyDisplayIcons(v.displayIcons)}if(this.isDirty("touchMode")){this._applyTouchMode(v.touchMode)}},destroy:function(){if(this._ctxMenuToken){k.removeEventListener(this.elements.container,this._ctxMenuToken)}this._parent()},});j.MODE={NAVIGATION:0,MULTIPLE_SELECTION:1,EXCLUSIVE_SELECTION:2};j.DISPLAY_STYLE={LITE:0,IMMERSIVE:1};j.DISPLAY_ELEMENT={NONE:0,ALL:1,SELECTED:2,HOVERED:3,HOVERED_OR_SELECTED:4};return j});define("DS/Controls/ColorCanvas",["DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Utils","DS/Utilities/Color","DS/Utilities/Dom"],function(f,e,c,i,g,j,a){var h=8;var d=8;var b=f.inherit({name:"colorCanvas",publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",}},keymaps:{esc:{keydown:"cancel"}},commands:{cancel:function(){if(!this.handleEditionCancel){return{stopPropagation:false}}if(!this.disabled){this._inEdition=false;this.setPropertyFromUIInteraction("value",this.initialValue);this.fire("cancelEdit")}}},buildView:function(){var k=this;var l="wux-controls-colorcanvas";k.elements.container.addClassName(l);k.elements._canvas=UWA.createElement("canvas",{tabIndex:-1,"class":l+"-canvas"}).inject(k.elements.container);this.buildCanvas();k.elements._pickerCursor=UWA.createElement("div",{"class":l+"-canvas-picker-cursor wux-element-contentbox"});k.elements._pickerCursor2=UWA.createElement("div",{"class":l+"-canvas-picker-cursor2 wux-element-contentbox"}).inject(k.elements._pickerCursor);k.elements._pickerCursor.hide();k.elements._pickerCursor.inject(k.elements.container);a.onNodeRendered(k.getContent(),function(){if(k.value!=="undefined"&&k.value!==null){if(k.elements._pickerCursor){k.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(k.value)))}k.elements._pickerCursor.show();k._updatePickerCursorPositionFromValue()}})},_handleEvents:function(){var n=this;var m=document;if(n.getContent()&&n.getContent().ownerDocument){m=n.getContent().ownerDocument}var k=function(r){if(this.disabled){return}if(n._inEdition){var s={x:r.clientX,y:r.clientY};var q=n.elements._canvas.getBoundingClientRect();var p=n._getPixelFromCoordinates(s,q);n.setPropertyFromUIInteraction("value",c.rgbToHex({r:parseInt(p[0]),g:parseInt(p[1]),b:parseInt(p[2])}).toLowerCase());n._updatePickerCursorPositionFromCoords(s,q)}};var l=function(p){n._inEdition=false;if(n.beginEdit){n.fire("endEdit");n.beginEdit=false}a.removeEventOnElement(n,m,e.POINTERMOVE,k);a.removeEventOnElement(n,m,e.POINTERMOVE,l)};var o=function(r){if(n.disabled){return}n._inEdition=true;n.initialValue=n.value;if(!n.beginEdit){n.fire("beginEdit");n.beginEdit=true}var s={x:r.clientX,y:r.clientY};var q=n.elements._canvas.getBoundingClientRect();var p=n._getPixelFromCoordinates(s,q);n.setPropertyFromUIInteraction("value",c.rgbToHex({r:parseInt(p[0]),g:parseInt(p[1]),b:parseInt(p[2])}).toLowerCase());n._updatePickerCursorPositionFromCoords(s,q);a.addEventOnElement(n,m,e.POINTERMOVE,k);a.addEventOnElement(n,m,e.POINTERUP,l)};a.addEventOnElement(this,n.elements.container,e.POINTERDOWN,o);a.addEventOnElement(this,n.elements.container,e.POINTERUP,l);a.addEventOnElement(this,n.elements.container,e.POINTERMOVE,k)},_applyProperties:function(k){this._parent(k);if(this.isDirty("value")){this._applyValue()}},_applyValue:function(){if(this.elements._pickerCursor){this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)))}if(!this._inEdition){this._updatePickerCursorPositionFromValue()}this.fire("change")},_applyTouchMode:function(){var k=this._getCurrentTouchMode();if(k===true){this.elements._canvas.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements._canvas.removeAttribute("touch-mode")}},_getPixelFromCoordinates:function(o,n){var l=this.elements._canvas.getContext("2d");var m=this.elements._canvas.width-1;var k=this.elements._canvas.height;var p=l.getImageData(g.clamp(0,m,(o.x-n.left)/n.width*m),g.clamp(0,k,(o.y-n.top)/n.height*k),1,1);return p.data},buildCanvas:function(){var n=this.elements._canvas.getContext("2d");var m=this.elements._canvas.width;var s=this.elements._canvas.height;var o=n.createLinearGradient(0,0,m,0);var q=37;for(var r=0;r<q;r++){var p=r/(q-1);var l=c.colorToCssColor(c.hslToRgb([p*360,100,50]));o.addColorStop(p,l)}var t=n.createLinearGradient(0,0,0,s);t.addColorStop(0,"white");t.addColorStop(0.5,"rgba(255,255,255,0)");var k=n.createLinearGradient(0,0,0,s);k.addColorStop(0.5,"rgba(0,0,0,0)");k.addColorStop(1,"black");[o,t,k].forEach(function(u){n.fillStyle=u;n.fillRect(0,0,m,s)})},_updatePickerCursorPositionFromCoords:function(p,n){var o=n.height-d;var k=n.width-h;var m=p.x-n.left-h/2;var l=p.y-n.top-d/2;if(m<0){m=-h/2}if(l<0){l=-d/2}if(m>k){m=k-1}if(l>o){l=o}this.elements._pickerCursor.setStyle("left",m+"px");this.elements._pickerCursor.setStyle("top",l+"px")},_updatePickerCursorPositionFromValue:function(){var k=this.elements._canvas.width;var z=this.elements._canvas.height;var t=this.elements._canvas.getBoundingClientRect();var q=j.hexToRgb(this.value);var l=this.elements._canvas.getContext("2d");var u=0,s=0;var m=l.getImageData(0,0,k,z);var o=new Uint8ClampedArray(m.data.buffer);var r=0;var p=o.length;var w=5;do{for(r=0;r<p;r+=4){var n=(r/4)%k;var v=Math.floor((r/4)/(k-1));if(o[r]<q.r+w&&o[r]>q.r-w&&o[r+1]<q.g+w&&o[r+1]>q.g-w&&o[r+2]<q.b+w&&o[r+2]>q.b-w){u=(n*t.width)/k;s=(v*t.height)/z;this.elements._pickerCursor.setStyle("left",u-h/2+"px");this.elements._pickerCursor.setStyle("top",s-d/2+"px");return 1}}w*=2}while(w<100);return 0},});return b});define("DS/Controls/Button",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils"],function(e,c,h,f,l,a,d,j){function k(){if(this.elements.icon){if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.empty()}delete this.elements.icon}if(this.elements.separator){this.elements.separator.remove(this.getContent())}var m=a.oldGenerateIcon(this.icon,this.iconSize,WUXManagedFontIcons.FontAwesome);if(m){this.elements.icon=m;if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.show()}this.elements.icon.style.pointerEvents="none";b.call(this);if(this.elements.iconPlaceholder){this.elements.icon.inject(this.elements.iconPlaceholder);if(this.displayStyle==="flyout"){if(!this.elements.separator){this.elements.separator=new e.Element("div",{"class":"wux-button-separator"})}this.elements.separator.inject(this.elements.iconPlaceholder,"after")}}}else{if(this.elements.iconPlaceholder){this.elements.iconPlaceholder.hide()}}}function b(){if(this.elements&&this.elements.icon){(this.label!==undefined&&this.label!==""&&this.displayStyle!=="flyout"&&this.showLabelFlag)?this.elements.icon.style.margin="0px 11px 0px 0px":this.elements.icon.style.margin="0px";if((this.displayStyle==="lite-borders"||(this.displayStyle==="icon"&&this.touchMode))||!this.showLabelFlag){this.elements.icon.style.margin="0px 0px 0px 0px"}}}var g=h.inherit({name:"button",markForRecordFlag:true,publishedProperties:{label:{defaultValue:"",type:"string",category:"Appearance"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},iconSize:{defaultValue:"1x",type:"string",category:"Appearance",uiDisplay:false},value:{defaultValue:undefined,type:"object",category:"Behavior",recordFlag:true},type:{defaultValue:"standard",type:"string",category:"Behavior",noNeedToApplyFlag:true},checkFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},minWidth:{defaultValue:-1,type:"integer",category:"Appearance"},minHeight:{defaultValue:-1,type:"integer",category:"Appearance"},preferredWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredHeight:{defaultValue:-1,type:"integer",category:"Appearance"},onClick:{defaultValue:undefined,type:"function",category:"Behavior"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},showLabelFlag:{defaultValue:true,type:"boolean",category:"Appearance"},allowUnsafeHTMLLabel:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{"return":{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"},},commands:{validate:function(n){if(this.disabled){return{stopPropagation:false}}var o={};if((this.clickMode===1&&n.type==="keydown")||(this.clickMode===0&&n.type==="keyup")){o.actionPerformed=i.call(this);var m={ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,altKey:n.altKey};this.fire("buttonclick",m)}if(e.Event.whichKey(n)==="return"){return{stopPropagation:false,infos:o}}else{return{stopPropagation:true,preventDefault:true,infos:o}}}},_preBuildView:function(){this.elements.container=new e.Element("div",{"class":"wux-controls-button",tabindex:0});this.elements.button=this.elements.container;this._parent();this.isMultiSelection=false},_applyIcon:function(m){if(typeof(this.icon)==="object"){if(!this.icon.iconClasses){this.icon.iconClasses=""}if(!this.icon.iconName){this.icon.iconName=""}if(!this.icon.fontIconFamily){this.icon.fontIconFamily=WUXManagedFontIcons.FontAwesome}if(!this.icon.fontIconSize){this.icon.fontIconSize=this.iconSize}else{this.iconSize=this.icon.fontIconSize}}k.call(this)},_applyIconSize:function(m){if(this.elements.icon){if(typeof(this.icon)==="object"){this.icon.fontIconSize=this.iconSize}k.call(this)}},_applyEmphasize:function(m){if(m){var n=this.elements.button;var o="wux-ui-state-"+m;n.removeClassName(o)}o="wux-ui-state-"+this.emphasize;this.elements.button.addClassName(o)},_applyDisplayStyle:function(m){if(m){this.elements.button.removeClassName("wux-ui-style-"+m)}this.elements.button.addClassName("wux-ui-style-"+this.displayStyle);if(this.displayStyle==="lite-borders"&&this.elements.icon){this.elements.icon.style.margin="0px 0px 0px 0px"}else{if(this.elements.icon){k.call(this)}}},_applyPreferredWidth:function(){if(this.preferredWidth>0){this.elements.button.setStyles({"max-width":this.preferredWidth+"px"});this.elements.button.setStyles({width:"100%"})}else{this.elements.button.setStyles({"max-width ":""});this.elements.button.setStyles({"width ":""})}},_applyPreferredHeight:function(){if(this.preferredHeight>0){this.elements.button.setStyles({"max-height":this.preferredHeight+"px"});this.elements.button.setStyles({height:"100%"})}else{this.elements.button.setStyles({"max-height":""});this.elements.button.setStyles({height:""})}},_applyMinWidth:function(){if(this.minWidth!=-1){this.elements.button.setStyles({"min-width":this.minWidth+"px"})}else{this.elements.button.setStyles({"min-width":""})}},_applyMinHeight:function(){if(this.minHeight!=-1){this.elements.button.setStyles({"min-height":this.minHeight+"px"})}else{this.elements.button.setStyles({"min-height":""})}},_applyOnClick:function(m){if(m){this.removeEventListener("buttonclick",m)}if(this.onClick){this.addEventListener("buttonclick",this.onClick)}},handleEvents:function(){var m=this;a.addEventOnElement(this,this.elements.button,"click",function(o){if(m.disabled){return}if(m.clickMode===0){i.call(m);var n={ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,altKey:o.altKey};m.fire("buttonclick",n)}});a.addEventOnElement(this,this.elements.button,f.POINTERHIT,function(n){if(n.multipleHitCount===2){if(m.disabled){return}m.fire("buttonDblClick")}});a.addEventOnElement(this,this.elements.button,f.POINTERDOWN,function(o){o.dsModel=m;if(m.disabled){return}if(m.clickMode===1){i.call(m);var n={ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,altKey:o.altKey};m.fire("buttonclick",n)}if(o.originalEvent&&o.originalEvent.type==="touchstart"){m.getContent().setAttribute("hasHoverPrevented","")}});this.elements.button.addEventListener("mousedrag",function(n){n.dsModel=m});this.elements.button.addEventListener(f.POINTERUP,function(n){n.dsModel=m});this.elements.button.addEventListener(f.POINTERMOVE,function(n){if(n.originalEvent&&n.originalEvent.type==="mousemove"){m.getContent().removeAttribute("hasHoverPrevented")}})},_applyCheckFlag:function(m){if(this.checkFlag===true){this.elements.button.setAttributeNode(document.createAttribute("checked"));if(!this.multiSelFlag||!this.isMultiSelection){this._uncheckSiblings()}}else{this.elements.button.removeAttribute("checked")}if(m!==undefined&&m!==this.checkFlag&&!this.preventTriggeringChangeEvent){this.fire("change")}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.removeAttribute("tabindex")}else{this.elements.container.setAttribute("tabindex",0)}},_applyLabel:function(m){if((this.label===undefined||this.label==="")){if(this.elements.text){this.elements.text.remove();this.elements.text=undefined;delete this.elements.text}return}if(!this.elements.text){this.elements.text=e.createElement("span");this.elements.text.inject(this.getContent());this._applyShowLabelFlag()}if(j.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)){this.elements.text.setContent(this.label)}else{this.elements.text.textContent=this.label}},_applyShowLabelFlag:function(){if(this.elements.text){if(this.showLabelFlag){this.elements.text.show();this.getContent().setAttributeNode(document.createAttribute("showlabel"))}else{if(!this.showLabelFlag){this.elements.text.hide();this.getContent().removeAttribute("showlabel")}}b.call(this)}},_applyTouchMode:function(){this._parent();b.call(this)},_applyAllowUnsafeHTMLLabel:function(){this._applyLabel(this.label)},_applyProperties:function(m){this._parent(m);if(this.isDirty("emphasize")){this._applyEmphasize(m.emphasize)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(m.displayStyle)}if(this.isDirty("preferredWidth")){this._applyPreferredWidth(m.preferredWidth)}if(this.isDirty("preferredHeight")){this._applyPreferredHeight(m.preferredHeight)}if(this.isDirty("minWidth")){this._applyMinWidth(m.minWidth)}if(this.isDirty("minHeight")){this._applyMinHeight(m.minHeight)}if(!this.elements.iconPlaceholder){this.elements.iconPlaceholder=new e.Element("div",{"class":"wux-button-icon-placeholder"})}if(!this.elements.iconPlaceholder.isInjected(this.getContent())){this.elements.iconPlaceholder.inject(this.getContent())}if(this.isDirty("icon")){this._applyIcon(m.icon)}else{if(this.isDirty("iconSize")){this._applyIconSize(m.iconSize)}}if(this.isDirty("allowUnsafeHTMLLabel")||this.isDirty("label")){this._applyLabel(m.label)}if(this.isDirty("onClick")){this._applyOnClick(m.onClick)}if(this.isDirty("checkFlag")){this._applyCheckFlag()}this._applyDisplayStyle();this._applyShowLabelFlag()},_uncheckSiblings:function(){if(this.type==="radio"){var o=this.elements.container.parentNode;if(o){if(o.dsModel&&o.dsModel.__proto__.name==="buttonGroup"){o.dsModel.preventTriggeringChangeEvent=true}var n=o.childNodes;for(var m=0;m<n.length;m++){if(n[m]!==this.elements.container){if(n[m].dsModel&&n[m].dsModel instanceof g&&n[m].dsModel.type==="radio"){n[m].dsModel.checkFlag=false}}}if(o.dsModel&&o.dsModel.__proto__.name==="buttonGroup"){o.dsModel.preventTriggeringChangeEvent=false}}}}});function i(){if(this.type==="check"){this.setPropertyFromUIInteraction("checkFlag",!this.checkFlag);return true}else{if(this.type==="radio"){if(this.checkFlag){return false}else{this.setPropertyFromUIInteraction("checkFlag",true);return true}}}return true}d.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Controls/Popup",["UWA/Core","UWA/Utils/Client","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/UIBehaviors/PopupManager","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents"],function(g,c,i,l,a,e,b,o,h){var n={};var m=i.inherit({name:"popup",markForRecordFlag:true,publishedProperties:{position:{defaultValue:"right",type:"string",category:"Appearance"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},visibleFlag:{defaultValue:false,type:"boolean",category:"Appearance"},target:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:false},offset:{defaultValue:{x:0,y:0},type:"vector2",category:"Appearance",noNeedToApplyFlag:true},constraint:{defaultValue:"none",type:"string",category:"Appearance"},trigger:{defaultValue:"",type:"string",category:"Behavior",uiDisplay:false},mouseRelativePosition:{defaultValue:false,type:"boolean",category:"Appearance",noNeedToApplyFlag:true},overlap:{defaultValue:true,type:"boolean",category:"Appearance"},overlapCallback:{defaultValue:undefined,type:"function",category:"Appearance"},className:{defaultValue:"wux-controls-popup",type:"string",category:"Appearance"},arrowBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoHide:{defaultValue:true,type:"boolean",category:"Appearance"}},getBody:function(){if(this.elements){return this.elements.body}},setBody:function(p){if(this.elements.container){this.elements.container.empty()}this.elements.body=p;this.elements.container.setContent(p);this.elements.container.setAttribute("tabindex",0);this._applyArrowBoxFlag()},_applyArrowBoxFlag:function(){if(this.arrowBoxFlag){if(!this.elements.arrow){this.elements.arrow=new g.Element("div",{"class":"wux-controls-popup-arrow-"+this.position});this.elements.arrow.inject(this.elements.container)}this._updateView()}else{if(this.elements.arrow){this.elements.arrow.style.display="none"}}},_applyTarget:function(p){a.removeAllEventsOnElement(this);f.call(this);this._updateView()},_applyTrigger:function(p){a.removeAllEventsOnElement(this);f.call(this)},_applyProperties:function(p){this._parent(p);if(this.className&&this.className!==""){this.elements.container.removeClassName("wux-controls-popup");this.elements.container.addClassName(this.className)}this._updateView()},show:function(){if(this.visibleFlag){if(!arguments[0]&&this.target&&this.target.disabled){return}if(this.autoHide){e.add(this)}var p=document;if(this.target){if(this.target.ownerDocument){p=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){p=this.target.getContent().ownerDocument}}}if(this.elements&&this.elements.container){this.inject(p.body);this._parent();this._updateView();this.fire("show")}if(this.mouseRelativePosition){this.elements.container.style.pointerEvents="none"}}else{this.visibleFlag=true;this._applyArrowBoxFlag()}},hide:function(){if(this.visibleFlag){this.visibleFlag=false}else{this._parent();if(this.autoHide){e.remove(this)}var p=document;if(this.target){if(this.target.ownerDocument){p=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){p=this.target.getContent().ownerDocument}}}if(this.elements&&this.elements.container){this.elements.container.remove(p.body);this.fire("hide",{trigger:this._escapeKbdAction?"escape":""})}}},_applyVisibleFlag:function(q){var t=this;var s=document;if(this.target){if(this.target.ownerDocument){s=this.target.ownerDocument}else{if(this.target.getContent()!==undefined&&this.target.getContent().ownerDocument){s=this.target.getContent().ownerDocument}}}var r=function(u){window.onmousewheel=s.onmousewheel=this._hideThisPopupBinded;a.addEventOnElement(t,window,"DOMMouseScroll",this._hideThisPopupBinded,true)};var p=function(u){window.onmousewheel=s.onmousewheel=null;a.removeEventOnElement(t,window,"DOMMouseScroll",this._hideThisPopupBinded,true)};if(this.visibleFlag&&!this._globalListening){this._scrollAtShow.x=window.scrollX;this._scrollAtShow.y=window.scrollY;a.addEventOnElement(t,s,"scroll",this._onScrollBinded,true);a.addEventOnElement(t,window,"resize",this._hideThisPopupBinded,true);a.addEventOnElement(t,t.elements.container,"mouseenter",r);a.addEventOnElement(t,t.elements.container,"mouseleave",p);this._globalListening=true}else{if(!this.visibleFlag&&this._globalListening){a.removeEventOnElement(t,s,"scroll",this._onScrollBinded,true);if(t.elements.container){a.removeEventOnElement(t,t.elements.container,"mouseenter",r);a.removeEventOnElement(t,t.elements.container,"mouseleave",p)}a.removeEventOnElement(t,window,"resize",this._hideThisPopupBinded,true);this._globalListening=null}}this.visibleFlag?this.show():this.hide()},isElementInside:function(q){if(!q){return false}var p=e.getContainingPopup(q);if(!p){return false}if(p.options.grid.data===this){return true}return this.isElementInside(p.options.grid.data.target)},toggle:function(){var p=this.visibleFlag;this.visibleFlag=!p},buildView:function(){this.elements.container.addClassName("wux-controls-popup");this.elements.container.setStyles({left:0,top:0});this._hideThisPopupBinded=k.bind(this);this._onScrollBinded=j.bind(this);this._scrollAtShow={x:0,y:0}},handleEvents:function(){var p=this;a.addEventOnElement(this,this.elements.container,"click",function(q){e.removeChild(p)});a.addEventOnElement(this,this.elements.container,"dimensionsChanged",function(){p._updateView()});f.call(p)},_updateView:function(){if(this.visibleFlag){var q=l.setConstrainedPosition(this,this.target,{position:this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,arrowBoxFlag:this.arrowBoxFlag,mouseRelativePosition:this.mouseRelativePosition,mousePosition:n,mouseOffset:{x:-10,y:10}});var p=this.position;if(this.position==="bottom"&&q.position.y<q.targetPosition.y){p="top"}if(this.position==="top"&&q.position.y>q.targetPosition.y){p="bottom"}if(this.position==="right"&&q.position.x<q.targetPosition.x){p="left"}if(this.position==="left"&&q.position.x>q.targetPosition.x){p="right"}if(this.arrowBoxFlag){this.elements.arrow.className="wux-controls-popup-arrow arrow-"+p}if(q.availableSpaceAroundTargetIfOverlaping!==undefined&&this.overlapCallback instanceof Function){this.overlapCallback(q.availableSpaceAroundTargetIfOverlaping)}}},storeMousePosition:function(p){if(this.mouseRelativePosition){n.x=p.pageX;n.y=p.pageY}}});function j(p){if(p.target instanceof HTMLInputElement){return}this._hideThisPopupBinded(p)}function d(r,p){if(!(r instanceof Element)){return null}var q=window.getComputedStyle(r)["overflow-y"];if(r.scrollHeight>r.offsetHeight&&(q==="scroll"||q==="auto")){return r}else{if(r===p){return null}return d(r.parentNode)}}function k(p){if(p.target&&p.type!=="resize"&&p.target instanceof Element){if(this.isElementInside(p.target)){var r=0;if(p.type==="mousewheel"||p.type==="scroll"){r=p.wheelDelta}else{if(p.type==="DOMMouseScroll"){r=-p.detail}}if(r>=0){this._scrollDown=false}else{this._scrollDown=true}var q=d(p.target,this.elements.container);if(q&&(((q.offsetHeight+q.scrollTop>=q.scrollHeight)&&this._scrollDown)||(q.scrollTop===0&&!this._scrollDown))){p.preventDefault()}q=null;return}this.visibleFlag=false}else{if(p.type==="resize"){this.visibleFlag=false}}}function f(){var q=this;var p=this.trigger.split(" ");var r=this.target;if(r){p.forEach(function(D){if(D==="hover"){a.addEventOnElement(q,r,"mousemove",function u(t){q.storeMousePosition(t)});a.addEventOnElement(q,r,"mouseover",function x(t){q.storeMousePosition(t);q.visibleFlag=true});a.addEventOnElement(q,r,"mouseleave",function v(){q.visibleFlag=false})}if(D==="focus"){a.addEventOnElement(q,r,"focus",function B(){q.visibleFlag=true});a.addEventOnElement(q,r,"blur",function s(){q.visibleFlag=false})}if(D==="click"){a.addEventOnElement(q,r,"click",function z(t){if(q.target&&!q.target.disabled&&!(q.target.dsModel&&q.target.dsModel.disabled)){t.stopPropagation();q.storeMousePosition(t);q.callMethodFromUIInteraction("toggle")}});var A=function A(E){var t=q.target.elements?q.target.getContent():q.target;if(!q.isElementInside(E.target)&&!a.isElementInside(E.target,t)){q.setPropertyFromUIInteraction("visibleFlag",false)}};var C=document;if(r.ownerDocument){C=r.ownerDocument}else{if(r.getContent()!==undefined&&r.getContent().ownerDocument){C=r.getContent().ownerDocument}}a.addEventOnElement(q,q,"show",function y(){a.addEventOnElement(q,C.body,h.POINTERDOWN,A)});a.addEventOnElement(q,q,"hide",function w(){a.removeEventOnElement(q,C.body,h.POINTERDOWN,A)})}if(D==="escape"){a.addEventOnElement(q,q.getContent(),"keydown",function(t){if(o.ESCAPE===t.keyCode){q._escapeKbdAction=true;q.visibleFlag=false;q._escapeKbdAction=false}})}})}}b.register(m,"DS/ControlsRec/AbstractRec");return m});define("DS/Controls/Toolbar",["UWA/Core","UWA/Element","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/Popup"],function(d,h,b,l,g,r){var a=l.inherit({name:"toolbar",publishedProperties:{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},verticalAlign:{defaultValue:"center",type:"string",category:"Appearance"},adaptSizeToParent:{defaultValue:false,type:"boolean",category:"Appearance"}},positionArray:["near","center","far"],_resizeListeners:[],buildView:function(){this._resizeListeners=[];this.elements.container.addClassName("wux-controls-toolbar");this.elements.maskContainer=new d.createElement("div",{"class":"wux-controls-toolbar-mask-container"}).inject(this.elements.container);this.elements.nearContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-nearContainer"}).inject(this.elements.maskContainer);this.elements.centerContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-centerContainer"}).inject(this.elements.maskContainer);this.elements.farContainer=new d.createElement("div",{"class":"wux-controls-toolbar-containers wux-controls-toolbar-farContainer"}).inject(this.elements.maskContainer);this.elements.container.dsModel=this;this.elements.maskContainer.dsModel=this},_applyProperties:function(s){this._parent(s);if(this.isDirty("direction")){this._applyDirection(s.direction)}if(this.isDirty("overflowManagement")){this._applyOverflowManagement(s.overflowManagement)}if(this.isDirty("verticalAlign")){this._applyVerticalAlign(s.verticalAlign)}},_applyOverflowManagement:function(t){if(this.overflowManagement==="scroll"){this.elements.maskContainer.addClassName("wux-toolbar-scroll");this.elements.maskContainer.removeClassName("wux-toolbar-dropdown");this.showEverything();if(this.elements.dropdownMenuButton){this.elements.dropdownMenuButton.remove();this.elements.dropdownMenuButton=null}}else{if(this.overflowManagement==="dropdown"){if(!this.elements.dropdownMenuButton){var u=new g({displayStyle:"lite",icon:{iconName:"menu",fontIconFamily:WUXManagedFontIcons.Font3DS}}).inject(this.elements.farContainer);u.getContent().classList.add("wux-toolbar-dropdown-button");this.elements.dropdownMenuButton=u.getContent();this._ddmButtonSize=j.call(this,this.direction,this.elements.dropdownMenuButton);this.elements.dropdownMenuButton.hide();if(!this.elements.dropdownPopup){var s=new r({target:u,position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click",overlap:false});this.elements.dropdownPopup=s;this.elements.dropdownPopup.elements.container.addClassName("wux-toolbar-popup")}else{this.elements.dropdownPopup.target=u}}if(this.getLastInPopup().toolbarItemElement){this.elements.dropdownMenuButton.show()}this.elements.maskContainer.addClassName("wux-toolbar-dropdown");this.elements.maskContainer.removeClassName("wux-toolbar-scroll");e.call(this)}}},_applyDirection:function(s){this.showEverything();if(this.direction==="vertical"){this.elements.container.addClassName("wux-toolbar-vertical");this.elements.container.removeClassName("wux-toolbar-horizontal");this.elements.maskContainer.addClassName("wux-toolbar-vertical");this.elements.maskContainer.removeClassName("wux-toolbar-horizontal")}else{this.elements.container.addClassName("wux-toolbar-horizontal");this.elements.container.removeClassName("wux-toolbar-vertical");this.elements.maskContainer.addClassName("wux-toolbar-horizontal");this.elements.maskContainer.removeClassName("wux-toolbar-vertical")}if(this.elements.dropdownMenuButton){this._ddmButtonSize=j.call(this,this.direction,this.elements.dropdownMenuButton)}e.call(this)},_applyVerticalAlign:function(s){this.elements.container.removeClassName("wux-toolbar-vertical-align-near");this.elements.container.removeClassName("wux-toolbar-vertical-align-center");this.elements.container.removeClassName("wux-toolbar-vertical-align-far");if(this.verticalAlign==="near"){this.elements.container.addClassName("wux-toolbar-vertical-align-near")}else{if(this.verticalAlign==="center"){this.elements.container.addClassName("wux-toolbar-vertical-align-center")}else{if(this.verticalAlign==="far"){this.elements.container.addClassName("wux-toolbar-vertical-align-far")}}}},_applyAdaptSizeToParent:function(s){if(this.adaptSizeToParent){this.getContent().addClassName("wux-toolbar-adaptToParent");this.elements.maskContainer.addClassName("wux-toolbar-adaptToParent")}else{this.getContent().removeClassName("wux-toolbar-adaptToParent");this.elements.maskContainer.removeClassName("wux-toolbar-adaptToParent")}},destroy:function q(){this.clear();b.removeResizeListener(this.elements.container,c);this._resizeListeners=null;this._parent()},add:function(v,s){switch(v){case"element":if(s.element&&s.position){if(!s.element.addClassName){s.element=d.extendElement(s.element)}s.element.addClassName("wux-toolbar-items");var u=this._getContainerFromPosition(s.position);var t=u.getChildren().length>=s.index?u.getChildren()[s.index]:null;if(s.position==="far"&&s.index>=u.getChildren().length-1&&this.overflowManagement==="dropdown"){t=this.elements.dropdownMenuButton}u.insertBefore(s.element,t);if(this._resizeListeners.indexOf(s.position)===-1){this._resizeListeners.push(s.position);b.addResizeListener(this._getContainerFromPosition(s.position),f)}}break;case"separator":var w=new d.createElement("div",{"class":"wux-controls-toolbar-separator"});if(s.element){var u=s.element.getParent();u.insertBefore(w,s.element)}else{if(s.position){var u=this._getContainerFromPosition(s.position);var t=u.getChildren().length>=s.index?u.getChildren()[s.index]:null;u.insertBefore(w,t)}}break}},remove:function(v,u){switch(v){case"element":var w;if(u.element){var s=this.getPositionFromElement(u.element);w=u.element.remove();var t=this._getContainerFromPosition(s.position).getChildren();if(this._resizeListeners.indexOf(s.position)!==-1&&(t.length===1||(s.position==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(s.position),1);b.removeResizeListener(this._getContainerFromPosition(s.position),f)}}else{if(u.position&&u.index){var t=this._getContainerFromPosition(u.position).getChildren();if(u.index>=t.length){u.index=t.length-1}if(t){if(!this._isSeparator(t[u.index])){w=t[u.index].remove()}}if(this._resizeListeners.indexOf(u.position)!==-1&&(t.length===1||(u.position==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(u.position),1);b.removeResizeListener(this._getContainerFromPosition(u.position),f)}}}break;case"separator":if(u.position&&typeof u.index==="number"){var t=this._getContainerFromPosition(u.position).getChildren();if(u.index>=t.length){u.index=t.length-1}if(t){if(this._isSeparator(t[u.index])){t[u.index].remove()}}}break}},clearPosition:function(s){var t=this._getContainerFromPosition(s).getChildren();for(var u=t.length-1;u>=0;u--){if(t[u].getTagName()!=="iframe"&&t[u]!==this.elements.dropdownMenuButton){t[u].remove()}}t=this._getContainerFromPosition(s).getChildren();if(this._resizeListeners.indexOf(s)!==-1&&(t.length===1||(s==="far"&&this.overflowManagement==="dropdown"&&t.length===2))){this._resizeListeners.splice(this._resizeListeners.indexOf(s),1);b.removeResizeListener(this._getContainerFromPosition(s),f)}},clear:function(){for(var s=0;s<this.positionArray.length;s++){this.clearPosition(this.positionArray[s])}},getElementFromPosition:function(t){var s=this._getContainerFromPosition(t.position).getChildren();if(t.index>=s.length||t.index<0){return null}else{return s[t.index]}},getPositionFromElement:function(t){for(var s=0;s<this.positionArray.length;s++){var u=this._getContainerFromPosition(this.positionArray[s]);if(t.getParent()===u){return{position:this.positionArray[s],index:u.getChildren().indexOf(t)}}}},_getMinimumSizeFromElements:function(){var t=0;for(var u=0;u<this.positionArray.length;u++){var v=this._getContainerFromPosition(this.positionArray[u]);if(v.getTagName()!=="iframe"){t=t+j.call(this,this.direction,v)}}var s,w=0;if(this.elements.container){s=this.direction==="vertical"?window.getComputedStyle(this.elements.container).getPropertyValue("padding-top"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-left");w=this.direction==="vertical"?window.getComputedStyle(this.elements.container).getPropertyValue("padding-bottom"):window.getComputedStyle(this.elements.container).getPropertyValue("padding-right");s=(s==="")?0:parseInt(s,10);w=(w==="")?0:parseInt(w,10)}t=t+s+w;return t},handleEvents:function(){var s=this;b.addResizeListener(this.elements.container,c)},_getFurthestVisibleElement:function(){for(var t=this.positionArray.length-1;t>=0;t--){var s=this._getContainerFromPosition(this.positionArray[t]);for(var u=s.getChildren().length-1;u>=0;u--){if(!s.getChildren()[u].isHidden()&&s.getChildren()[u]!==this.elements.dropdownMenuButton&&s.getChildren()[u].getTagName()!=="iframe"){return s.getChildren()[u]}}}},_getNearestHiddenElement:function(){for(var t=0;t<this.positionArray.length;t++){var s=this._getContainerFromPosition(this.positionArray[t]);for(var u=0;u<s.getChildren().length;u++){if(s.getChildren()[u].isHidden()&&s.getChildren()[u]!==this.elements.dropdownMenuButton&&s.getChildren()[u].getTagName()!=="iframe"){return s.getChildren()[u]}}}},_getLargestElementWidth:function(){var w=0,u;for(var t=0;t<this.positionArray.length;t++){var s=this._getContainerFromPosition(this.positionArray[t]);for(var v=0;v<s.getChildren().length;v++){u=s.getChildren()[v].getSize().width;if(s.getChildren()[v].getTagName()!=="iframe"&&u>w){w=u}}}return w},_getContainerFromPosition:function(s){switch(s){case"near":return this.elements.nearContainer;case"center":return this.elements.centerContainer;case"far":return this.elements.farContainer}},_getNextContainer:function(s){switch(s){case this.elements.nearContainer:return this.elements.centerContainer;case this.elements.centerContainer:return this.elements.farContainer;case this.elements.farContainer:return null}},_isSeparator:function(s){return Boolean(s&&s.hasClassName("wux-controls-toolbar-separator"))},showEverything:o,getLastInPopup:p,getNbElementsInPopup:m,addToPopup:k,addToToolbar:i,enablePopupDefaultBehavior:function(){this.enablePopupBehavior()},enablePopupBehavior:function(s){s=s||{};this.showEverything();this.showEverything=s.showEverything||o;this.getLastInPopup=s.getLastInPopup||p;this.getNbElementsInPopup=s.getNbElementsInPopup||m;this.addToPopup=s.addToPopup||k;this.addToToolbar=s.addToToolbar||i;e.call(this)}});function o(){while(this.getLastInPopup().toolbarItemElement){var s=this.getLastInPopup();if(s.toolbarSeparatorElement){this.addToToolbar(s.toolbarSeparatorElement)}this.addToToolbar(s.toolbarItemElement)}}function n(){var u=this;var t=u.getLastInPopup();var s=t?t.toolbarItemElement:null;var v=t?t.toolbarSeparatorElement:null;var w=0;var x=u.getNbElementsInPopup();if(s){w=j.call(u,u.direction,s);w+=v?j.call(u,u.direction,v):0}return{lastItem:s,separator:v,completeSize:w,nbElements:x}}function p(){var u,t,s;if(this.elements.dropdownPopup){u=this.elements.dropdownPopup.elements.container;t=u.getChildren()[u.getChildren().length-1];while(t&&t.className.indexOf("treelistview")!==-1){t=t.previousSibling}if(this._isSeparator(t)){s=t;t=s.previousSibling}}return{toolbarItemElement:t,toolbarSeparatorElement:s}}function m(){var u=0,s=this.getLastInPopup(),t=s?s.toolbarItemElement:null;for(;t;t=t.previousSibling){if(!this._isSeparator(t)){u++}}return u}function k(s){s.toolbarProperties=s.toolbarProperties||{};s.toolbarProperties.lastParent=s.parentElement;s.toolbarProperties.size=s.getSize();s.toolbarProperties.margin={top:window.getComputedStyle(s).getPropertyValue("margin-top"),bottom:window.getComputedStyle(s).getPropertyValue("margin-bottom"),right:window.getComputedStyle(s).getPropertyValue("margin-right"),left:window.getComputedStyle(s).getPropertyValue("margin-left")};s.parentElement.removeChild(s);s.inject(this.elements.dropdownPopup.elements.container)}function i(t){var s=t.toolbarProperties?t.toolbarProperties.lastParent:null;if(s){t.parentElement.removeChild(t);if(s.classList.contains("wux-controls-toolbar-farContainer")){t.inject(this.elements.dropdownMenuButton,"before")}else{t.inject(s)}}}function c(){if(this&&this.getParent()){var s=this.getParent().dsModel;e.call(s)}}function f(){if(this&&this.getParent()&&this.getParent().getParent()){var s=this.getParent().getParent().dsModel;e.call(s)}}function e(){var t=this.elements.dropdownMenuButton;if(this.overflowManagement==="dropdown"){var w=this.direction==="vertical"?this.elements.container.getSize().height:this.elements.container.getSize().width;var v=this._getMinimumSizeFromElements();if(v>w){while(v>w){var u=this._getFurthestVisibleElement();if(u){this.addToPopup(u);t.show();u=this._getFurthestVisibleElement();if(this._isSeparator(u)){this.addToPopup(u)}v=this._getMinimumSizeFromElements()}else{return}}}else{var s=n.call(this);if(s.lastItem&&v+s.completeSize<=w){while((s.lastItem&&(v+s.completeSize<=w))||(s.nbElements===1&&(v+s.completeSize-this._ddmButtonSize<=w))){if(s.separator){this.addToToolbar(s.separator)}this.addToToolbar(s.lastItem);s=n.call(this);if(!s.lastItem){t.hide();return}v=this._getMinimumSizeFromElements()}}else{if(s.lastItem&&s.nbElements===1&&v+s.completeSize-this._ddmButtonSize<=w){t.hide();if(s.separator){this.addToToolbar(s.separator)}this.addToToolbar(s.lastItem)}else{if(!s.lastItem&&t&&!t.isHidden()){t.hide()}}}}}}function j(y,u){function v(z){var A;if(u.toolbarProperties&&u.toolbarProperties.margin){A=u.toolbarProperties.margin[z]}else{A=window.getComputedStyle(u).getPropertyValue("margin-"+z)}return A?parseFloat(A):0}var x=false,w;if(u.isHidden()){u.show();x=true}var t=u.toolbarProperties;var s=t&&t.size?t.size:u.getSize();if(y==="vertical"){w=s.height+v("top")+v("bottom")}else{w=s.width+v("right")+v("left")}if(x){u.hide()}return w}return a});define("DS/Controls/Tooltip",["UWA/Core","DS/Controls/Popup","DS/Utilities/Utils","DS/Controls/TooltipModel","i18n!DS/Controls/assets/nls/translation.json"],function(a,k,g,d,c){var b=false;function l(p,o,n,m){this.set=function(t,s,r,q){this.left=Math.floor(t);this.top=Math.floor(s);this.right=Math.ceil(r);this.bottom=Math.ceil(q)};this.reset=function(){this.set(0,0,0,0)};this.isPositionInRZ=function(s,q){if(s===undefined||(this.left===this.right&&this.top===this.bottom)){return false}var r=q||0;return((s.x>this.left-r)&&(s.x<this.right+r)&&(s.y>this.top-r)&&(s.y<this.bottom+r))};this._showReachingZone=function(t,q){var r=document.getElementById(t);if(!r){var s={id:t};r=a.createElement("div",s)}r.setStyle("position","absolute");r.setStyle("top",this.top+"px");r.setStyle("left",this.left+"px");r.setStyle("width",(this.right-this.left)+"px");r.setStyle("height",(this.bottom-this.top)+"px");r.setStyle("border","1px solid "+q);r.setStyle("z-index","2147483647");r.setStyle("pointer-events","none");r.inject(document.body)};this._hideReachingZone=function(r){var q=document.getElementById(r);if(q){q.remove(document.body)}};this.applyOffset=function(q){if(q.x>0){this.left-=q.x}else{this.right-=q.x}if(q.y>0){this.top-=q.y}else{this.bottom-=q.y}};this.set(p,o,n,m)}function e(){if(this.target===undefined){return}if(this.target.tooltipInfos===undefined||(this.target.tooltipInfos&&this.target.tooltipInfos.isEmpty())){return}j.call(this);this._parentShow(true);if(this.target&&this.target.tooltipInfos._reachableState){this.elements.container.style.pointerEvents="auto"}}function i(){clearTimeout(this.INTIAL_DELAY_TIMER);clearTimeout(this.LONG_TO_SHOW_DELAY)}function f(){if(this.elements.container){this.elements.container.empty()}this.elements.title=undefined;this.elements.shortHelp=undefined;this.elements.shortHelpImage=undefined;this.elements.longHelp=undefined;this.elements.longHelpImage=undefined;this.elements.moreHelp=undefined}function j(){var n=this.target.tooltipInfos;if(!n){return}this.elements.container.setStyle("box-sizing","content-box");var m=n.wrapPolicy===d.WrapPolicy.MULTILINE&&n.wrapThreshold>0;if(m){this.elements.container.setStyle("max-width",n.wrapThreshold)}else{this.elements.container.setStyle("max-width","none")}if(n.title!==""&&this.elements.title===undefined){var p={"class":"wux-tooltip-title"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLTitle)){p.text=n.title}else{p.html=n.title}this.elements.title=a.createElement("div",p);this.elements.title.setAttribute("title",n.title);this.elements.title.visibility="visible";this.elements.title.inject(this.elements.container)}if(n.shortHelp!==""&&this.elements.shortHelp===undefined){var p={"class":"wux-tooltip-shortHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLShortHelp)){p.text=n.shortHelp}else{p.html=n.shortHelp}this.elements.shortHelp=a.createElement("div",p);this.elements.shortHelp.setAttribute("shortHelp",n.shortHelp);this.elements.shortHelp.style.visibility="visible";this.elements.shortHelp.inject(this.elements.container)}if(n.shortHelpImage!==""&&this.elements.shortHelpImage===undefined){this.elements.shortHelpImage=a.createElement("img",{"class":"wux-tooltip-shortHelpImage",src:n.shortHelpImage,width:n.shortHelpImageDimension.x,height:n.shortHelpImageDimension.y});this.elements.shortHelpImage.inject(this.elements.container)}if(n.longHelp!==""&&this.elements.longHelp===undefined){var p={"class":"wux-tooltip-longHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLLongHelp)){p.text=n.longHelp}else{p.html=n.longHelp}this.elements.longHelp=a.createElement("div",p);this.elements.longHelp.setAttribute("longHelp",n.longHelp);this.elements.longHelp.style.display="none";this.elements.longHelp.inject(this.elements.container)}if(n.longHelpImage!==""&&this.elements.longHelpImage===undefined){this.elements.longHelpImage=a.createElement("img",{"class":"wux-tooltip-longHelpImage",src:n.longHelpImage,width:n.longHelpImageDimension.x,height:n.longHelpImageDimension.y});this.elements.longHelpImage.style.display="none";this.elements.longHelpImage.inject(this.elements.container)}if(this.elements.longHelp!==undefined||this.elements.longHelpImage!==undefined){if(this.target.tooltipInfos.shortHelp!==""){var o=this;this.LONG_TO_SHOW_DELAY=setTimeout(function(){if(o.elements.longHelp!==undefined){o.elements.longHelp.style.display="block"}if(o.elements.longHelpImage!==undefined){o.elements.longHelpImage.style.display="block"}o._updateView()},this.target.tooltipInfos.shortToLongDelay)}else{if(this.elements.longHelp!==undefined){this.elements.longHelp.style.display="block"}if(this.elements.longHelpImage!==undefined){this.elements.longHelpImage.style.display="block"}}}if(n._reachableState&&this.elements.moreHelp===undefined){this.elements.container.addClassName("wux-controls-tooltip-reachable");var p={"class":"wux-tooltip-moreHelp"};if(!g.getUnsafeHTMLContentValueToApply(n.allowUnsafeHTMLTitle)){p.text=c.moreHelp}else{p.html=c.moreHelp}this.elements.moreHelp=a.createElement("div",p);this.elements.moreHelp.setAttribute("moreHelp",c.moreHelp);this.elements.moreHelp.visibility="visible";this.elements.moreHelp.inject(this.elements.container)}}var h=k.inherit({publishedProperties:{},_preBuildView:function(m){this._parent();this._properties.constraint.value="screen";this._properties.autoHide.value=false;this._properties.position.value="bottom";this.elements.container.addClassName("wux-controls-tooltip");this.INTIAL_DELAY_TIMER=null;this.LONG_TO_SHOW_DELAY=null;this.RESHOW_TIMER=null;this.RESHOW_FLAG=false;this._targetRZ=new l();this._tooltipRZ=new l();this._lastShowPosition={x:0,y:0}},show:function(){var o=this.target;if(o&&this.target.tooltipInfos){if(!this.visibleFlag){o.tooltipInfos.setAllPropertiesFromAllInformationCB();if(o.tooltipInfos.shortHelp||o.tooltipInfos.longHelp||o.tooltipInfos.shortHelpImage||o.tooltipInfos.longHelpImage||o.tooltipInfos.title){this.visibleFlag=true}return}if(o.tooltipInfos.position){this.position=o.tooltipInfos.position}if(o.tooltipInfos.mouseRelativePosition){this.offset={x:8,y:8}}else{switch(o.tooltipInfos.position){case"top":this.offset={x:0,y:-1};break;case"bottom":this.offset={x:0,y:1};break;case"left":this.offset={x:-1,y:0};break;case"right":this.offset={x:1,y:0};break;default:this.offset={x:0,y:0};break}}i.call(this);this._parentShow=this._parent;this.mouseRelativePosition=o.tooltipInfos.mouseRelativePosition;var n=this;this.INTIAL_DELAY_TIMER=setTimeout(function(){var q={};q.x=n.mousePosition.x+window.pageXOffset;q.y=n.mousePosition.y+window.pageYOffset;if(n.isPositionInRZ(q,"target")||n.touchMode||n.RESHOW_FLAG){e.call(n)}n.RESHOW_FLAG=true;clearTimeout(n.RESHOW_TIMER);n.RESHOW_TIMER=null},this.RESHOW_FLAG?0:o.tooltipInfos.initialDelay);var m=null;var p=null;if(this.target.getBoundingClientRect){m=this.target.getBoundingClientRect();p=a.extendElement(this.target).getPosition(document.body)}else{if(this.target.getContent()!==undefined){m=this.target.getContent().getBoundingClientRect();p=this.target.getContent().getPosition(document.body)}}this._targetRZ.set(p.x,p.y,p.x+m.width,p.y+m.height);if(o.tooltipInfos.mouseRelativePosition){this._tooltipRZ.set(Math.max(p.x,this._lastShowPosition.x-10),Math.max(p.y,this._lastShowPosition.y-10),this._targetRZ.right,this._targetRZ.bottom)}else{this._tooltipRZ.set(0,0,0,0)}if(b){this._targetRZ._showReachingZone("visual-target-reaching-zone","red");this._tooltipRZ._showReachingZone("visual-old-tooltip-reaching-zone","blue")}}},hide:function(){if(this.visibleFlag){this.visibleFlag=false}else{i.call(this);if(this.target&&this.target.tooltipInfos!==undefined){if(this.RESHOW_FLAG){var m=this;if(this.RESHOW_TIMER!==null){clearTimeout(this.RESHOW_TIMER);this.RESHOW_TIMER=null}this.RESHOW_TIMER=setTimeout(function(){m.RESHOW_FLAG=false},this.target.tooltipInfos.reshowDelay)}this.target=undefined}f.call(this);this._parent();this._targetRZ.reset();this._tooltipRZ.reset();if(b){this._targetRZ._hideReachingZone("visual-target-reaching-zone");this._tooltipRZ._hideReachingZone("visual-old-tooltip-reaching-zone");this._tooltipRZ._hideReachingZone("visual-new-tooltip-reaching-zone")}}},isPositionInRZ:function(o,n,m){if(n==="target"){return this._targetRZ.isPositionInRZ(o,m)}else{if(n==="tooltip"){return this._tooltipRZ.isPositionInRZ(o,m)}}return false},_updateView:function(){if(this.visibleFlag){g.setConstrainedPosition(this,this.target,{position:this.mouseRelativePosition?"bottom":this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,arrowBoxFlag:this.arrowBoxFlag,mouseRelativePosition:this.mouseRelativePosition,mousePosition:this.mousePosition,mouseOffset:{x:-10,y:10}});var p=this.getContent().getBoundingClientRect();var m=undefined;var n=false;if(this.target&&this.target.tooltipInfos){n=this.target.tooltipInfos._reachableState;m=this.target.tooltipInfos.mouseRelativePosition}if(n&&(p.width>0||p.height>0)){var o=g.getOffset(this.getContent());if(m){this._tooltipRZ.set(Math.min(this._tooltipRZ.left,o.left),Math.min(this._tooltipRZ.top,o.top),Math.max(this._tooltipRZ.right,o.left+p.width),Math.max(this._tooltipRZ.bottom,o.top+p.height))}else{this._tooltipRZ.set(o.left,o.top,o.left+p.width,o.top+p.height);this._tooltipRZ.applyOffset(this.offset)}if(b){this._tooltipRZ._showReachingZone("visual-new-tooltip-reaching-zone","green")}}}}});return h});define("DS/Controls/Toggle",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Core/PointerEvents","DS/WebRecordEnabler/Adapter"],function(g,f,d,a,b,c){var e=f.inherit({name:"toggle",markForRecordFlag:true,publishedProperties:{type:{defaultValue:"checkbox",type:"string",category:"Behavior"},checkFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},mixedState:{defaultValue:false,type:"boolean",category:"Behavior"},label:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:undefined,type:"object",noNeedToApplyFlag:true,category:"Behavior",recordFlag:true},internalLabelsFlag:{defaultValue:false,type:"boolean",category:"Appearance"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUnsafeHTMLLabel:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{"return":{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"},},commands:{validate:function(i){if(this.disabled){return{stopPropagation:false}}var j={};if((this.clickMode===1&&i.type==="keydown")||(this.clickMode===0&&i.type==="keyup")){j.actionPerformed=this.toggle();var h={ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,altKey:i.altKey};this.fire("buttonclick",h)}if(g.Event.whichKey(i)==="return"){return{stopPropagation:false,infos:j}}else{return{stopPropagation:true,infos:j}}},},buildView:function(){this.elements.container.classList.add("wux-controls-toggle");this.elements.container.setAttribute("tabindex",0);this.elements.checkSign=g.createElement("div",{"class":"wux-icon wux-ui-fa",tabindex:-1});this.elements.checkSign.inject(this.elements.container);this.isMultiSelection=false;this.preventTriggeringChangeEvent=true},_postBuildView:function(){this.preventTriggeringChangeEvent=false},handleEvents:function(){var h=this;a.addEventOnElement(this,h.elements.container,"click",function(j){if(h.clickMode===0){if(h.disabled){return}h.callMethodFromUIInteraction("toggle");var i={ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey};h.fire("buttonclick",i)}});a.addEventOnElement(this,h.elements.container,b.POINTERDOWN,function(j){if(h.clickMode===1){if(h.disabled){return}h.callMethodFromUIInteraction("toggle");var i={ctrlKey:j.ctrlKey,shiftKey:j.shiftKey,altKey:j.altKey};h.fire("buttonclick",i)}});a.addEventOnElement(this,h.elements.container,b.POINTERHIT,function(i){if(i.multipleHitCount!==2){return}i.stopPropagation();if(h.disabled){return}h.fire("buttonDblClick")});a.addEventOnElement(this,this.elements.checkSign,"focus",function(i){h.elements.container.focus()})},_applyType:function(){this.elements.checkSign.classList.remove(this._toggleIcon);this.elements.container.classList.remove("wux-controls-checkbox");this.elements.container.classList.remove("wux-controls-radio");this.elements.container.classList.remove("wux-controls-switch");this.elements.checkSign.classList.remove("wux-icon");for(var h=0;h<this.elements.checkSign.children.length;h++){this.elements.checkSign.children[h].destroy();h--}if(this.type==="switch"){this.elements.innerSwitch=g.createElement("div",{"class":"wux-controls-toggle-switch-inner"});this.elements.labelSwitch1=g.createElement("div",{"class":"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-left"});this.elements.buttonSwitch=g.createElement("div",{"class":"wux-controls-toggle-switch-button"});this.elements.labelSwitch2=g.createElement("div",{"class":"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-right"});this.elements.innerSwitch.inject(this.elements.checkSign);this.elements.labelSwitch1.inject(this.elements.innerSwitch);this.elements.buttonSwitch.inject(this.elements.innerSwitch);this.elements.labelSwitch2.inject(this.elements.innerSwitch)}if(this.type==="checkbox"){this._toggleIcon="wux-ui-fa-check";this.elements.container.classList.add("wux-controls-checkbox");this.elements.checkSign.classList.add("wux-icon")}else{if(this.type==="radio"){this._toggleIcon="wux-controls-radio-on";this.elements.container.classList.add("wux-controls-radio");this.elements.checkSign.classList.add("wux-icon")}else{if(this.type==="switch"){this._toggleIcon="wux-controls-switch-on";this.elements.container.classList.add("wux-controls-switch");this.elements.innerSwitch.classList.add("wux-controls-toggle-switch-inner")}}}this._applyCheckFlag();this._applyInternalLabelsFlag()},_applyLabel:function(){if(this.label===""&&this.elements.label){this.elements.label.destroy()}else{if(this.label!==""){if(!this.elements.label){this.elements.label=g.createElement("label",{"class":"wux-label",tabindex:-1});this.elements.label.inject(this.elements.container);var h=this;a.addEventOnElement(this,this.elements.label,"focus",function(i){h.elements.container.focus()})}if(!d.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)){this.elements.label.setText(this.label)}else{this.elements.label.setHTML(this.label)}}}},_applyAllowUnsafeHTMLLabel:function(){this._applyLabel()},_applyCheckFlag:function(){if(this.checkFlag===true){this.elements.container.setAttributeNode(document.createAttribute("checked"));if(!this.mixedState){this.elements.checkSign.classList.add(this._toggleIcon)}if(!this.multiSelFlag||!this.isMultiSelection){this._uncheckSiblings()}}else{this.elements.container.removeAttribute("checked");this.elements.checkSign.classList.remove(this._toggleIcon)}if(!this.preventTriggeringChangeEvent){this.fire("change")}},_applyDisabled:function(){this._parent();if(this.disabled===true){this.elements.container.setAttribute("tabindex",-1);this.elements.checkSign.disabled=this.disabled}else{this.elements.container.setAttribute("tabindex",0)}},_applyMixedState:function(){if(this.mixedState){this.elements.checkSign.classList.remove(this._toggleIcon);this.elements.checkSign.classList.add("wux-toggle-mixed-icon")}else{this.elements.checkSign.classList.remove("wux-toggle-mixed-icon");if(this.checkFlag){this.elements.checkSign.classList.add(this._toggleIcon)}}this.fire("change")},_applyInternalLabelsFlag:function(){if(this.internalLabelsFlag===true&&this.type==="switch"){if(this.elements.labelSwitch1&&this.elements.labelSwitch2){this.elements.labelSwitch1.setHTML("l");this.elements.labelSwitch2.setHTML("O")}}else{if(this.elements.labelSwitch1&&this.elements.labelSwitch2){this.elements.labelSwitch1.setHTML("");this.elements.labelSwitch2.setHTML("")}}},_applyProperties:function(h){this._parent(h);if(this.isDirty("type")){this._applyType()}if(this.isDirty("label")||this.isDirty("allowUnsafeHTMLLabel")){this._applyLabel()}if(this.isDirty("checkFlag")){this._applyCheckFlag()}if(this.isDirty("mixedState")){this._applyMixedState()}if(this.isDirty("internalLabelsFlag")){this._applyInternalLabelsFlag()}},_giveFocus:function(){if(this._isFocused()){return}this.elements.container.focus()},toggle:function(){if(this.type==="checkbox"||this.type==="switch"){if(this.mixedState===true){this.mixedState=false}else{this.checkFlag=!this.checkFlag}return true}else{if(this.type==="radio"){if(this.mixedState===true){this.mixedState=false;this.checkFlag=true;return true}else{if(this.checkFlag===false){this.checkFlag=true;return true}}return false}}},_uncheckSiblings:function(){if(this.type==="radio"){var k=this.elements.container.parentNode;if(k){if(k.dsModel&&k.dsModel.__proto__.name==="buttonGroup"){k.dsModel.preventTriggeringChangeEvent=true}var j=k.childNodes;for(var h=0;h<j.length;h++){if(j[h]!==this.elements.container){if(j[h].dsModel&&j[h].dsModel instanceof e&&j[h].dsModel.type==="radio"){j[h].dsModel.checkFlag=false;j[h].dsModel.mixedState=false}}}if(k.dsModel&&k.dsModel.__proto__.name==="buttonGroup"){k.dsModel.preventTriggeringChangeEvent=false}}}}});c.register(e,"DS/ControlsRec/AbstractRec");return e});define("DS/Controls/AbstractEditor",["UWA/Core","DS/Controls/Abstract"],function(c,b){var a=b.inherit({name:"abstract editor",publishedProperties:{requiredFlag:{defaultValue:false,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:true},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:true,type:"boolean",readOnly:true,category:"Appearance"},selectAllOnFocus:{defaultValue:false,type:"boolean",category:"Behavior"},escapeHTML:{defaultValue:false,type:"boolean",category:"Behavior"},},blackBoxFlag:true,_postBuildView:function(){},commitCurrentEntry:function(){if(this.value!==this.valueToCommit){this.value=this.valueToCommit;return true}return undefined},_applyDisabled:function(){this._parent();if(this.disabled){this._myInput.setAttributeNode(document.createAttribute("disabled"))}else{this._myInput.removeAttribute("disabled")}},_applyRequiredFlag:function(){this._realApplyRequiredFlag();this._updateValidFlag()},_applyPlaceholder:function(){if(this.placeholder){this._myInput.setAttribute("placeholder",this.placeholder)}else{this._myInput.removeAttribute("placeholder")}},_applyValue:function(d,e){if(typeof e==="undefined"||e===null){this._myInput.value=""}else{this._myInput.value=e;this._applyEscapeHTML();this._myInput.value=this.escapeHTML?c.String.unescapeHTML(this.value):this.value}this.valueToCommit=this.value;this.fire("change");this._updateValidFlag()},_applyValueToCommit:function(d){this.fire("uncommittedChange");this._updateValidFlag()},_applyEscapeHTML:function(d){if(this._myInput.value){if(this.escapeHTML){this._properties.value.value=c.String.escapeHTML(this._myInput.value)}else{if(d===true){this._properties.value.value=c.String.unescapeHTML(this._myInput.value)}}}},_realApplyRequiredFlag:function(){if(this.requiredFlag===true){this._myInput.setAttributeNode(document.createAttribute("required"))}else{this._myInput.removeAttribute("required")}},_updateValidFlag:function(){if(this._myInput&&this._myInput.validity){var d=this._myInput.validity.valid;if(d===this._properties.validFlag.value){return}this._properties.validFlag.value=d;this.fire("validFlagChange")}},_giveFocus:function(){if(this._isFocused()){return}this._parent();if(document.activeElement!==this._myInput){this._myInput.focus()}if(!this.disabled&&this.selectAllOnFocus){this._myInput.setSelectionRange(0,0);this._myInput.select()}this.fire("focus")},destroy:function(){this._parent();this._myInput=null}});return a});define("DS/Controls/Editor",["UWA/Core","DS/Controls/AbstractEditor","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom"],function(f,d,c,e,a){var b=d.inherit({name:"editor",markForRecordFlag:true,publishedProperties:{widthInCharNumber:{defaultValue:20,type:"integer",category:"Appearance"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"},nbRows:{defaultValue:2,type:"integer",category:"Appearance"},newLineMode:{defaultValue:"shiftEnter",type:"string",category:"Behavior"},autoCommitFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true,category:"Behavior"}},keymaps:{up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},"shift+return":{keydown:"consume",keyup:"preventDefaultAndConsume"},"return":{keydown:"validateValue",keyup:"preventDefault"}},commands:{consume:function(){return{stopPropagation:true}},validateValue:function(){var g=this.commitCurrentEntry();return{preventDefault:true,stopPropagation:false,infos:{actionPerformed:g}}},preventDefault:function(){return{preventDefault:true,stopPropagation:false}},preventDefaultAndConsume:function(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-editor");this._myInput=new f.Element("textarea",{type:"text"});this._myInput.addClassName("wux-ui-state-"+this.options.type);this._myInput.inject(this.elements.container);this._validFlag=true},handleEvents:function(){var g,i;var h=this;a.addEventOnElement(this,this._myInput,"change",function(j){j.stopPropagation()});a.addEventOnElement(this,this._myInput,"input",function(j){j.stopPropagation();if(h.autoCommitFlag){h.setPropertyFromUIInteraction("value",h._myInput.value)}else{h.setPropertyFromUIInteraction("valueToCommit",h._myInput.value)}});a.addEventOnElement(this,this._myInput,"blur",function(j){h.callMethodFromUIInteraction("commitCurrentEntry");j.preventDefault();h.fire("blur")})},_applyNewLineMode:function(){if(this.newLineMode==="enter"){this._keymapManager.registerKeymap("return",this.name+":consume",this.name+":preventDefaultAndConsume");this._keymapManager.registerKeymap(["shift+return"],this.name+":validateValue",this.name+":preventDefault")}else{if(this.newLineMode==="shiftEnter"){this._keymapManager.registerKeymap("shift+return",this.name+":consume",this.name+":preventDefaultAndConsume");this._keymapManager.registerKeymap(["return"],this.name+":validateValue",this.name+":preventDefault")}else{delete this._keymapManager._keymap["return"];delete this._keymapManager._keymap["shift+return"]}}},_applyMaxLength:function(){if(this.maxLength>0){this._myInput.setAttribute("maxlength",this.maxLength)}else{this._myInput.removeAttribute("maxlength")}},_applyWidthInCharNumber:function(){this._myInput.setAttribute("cols",this.widthInCharNumber)},_applyNbRows:function(g){if(this.nbRows>1){this._myInput.setAttribute("rows",this.nbRows)}else{this._myInput.removeAttribute("rows")}if(g!==this.nbRows){this.fire("dimensionsChanged")}},_applyProperties:function(g){this._parent(g);this._applyPlaceholder();this._applyWidthInCharNumber();this._applyNbRows();this._applyMaxLength();this._applyNewLineMode();this._realApplyRequiredFlag();if(this.isDirty("value")){this._applyValue(g.value,this.value);this.fire("change")}this._updateValidFlag()}});e.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/LineEditor",["UWA/Core","DS/Controls/AbstractEditor","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Controls/assets/nls/translation"],function(d,e,f,i,b,a,h,j){var c=e.inherit({name:"lineEditor",markForRecordFlag:true,publishedProperties:{pattern:{defaultValue:"",type:"string",category:"Behavior"},sizeInCharNumber:{defaultValue:-1,type:"integer",category:"Appearance"},displayStyle:{defaultValue:"text",type:"string",category:"Appearance"},autoCommitFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true,category:"Behavior"},value:{defaultValue:"",type:"string",category:"Behavior",recordFlag:true,advancedSetter:true},autoCorrectFlag:{defaultValue:true,type:"boolean",category:"Behavior"},displayClearFieldButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},keymaps:{up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},"return":{keydown:"validateValue",keyup:"preventDefault"},},commands:{consume:function(){},validateValue:function(){var k=this.commitCurrentEntry();return{preventDefault:true,stopPropagation:false,infos:{actionPerformed:k}}},preventDefault:function(){return{preventDefault:true,stopPropagation:false}},preventDefaultAndConsume:function(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-lineeditor");this._myInput=new d.Element("input",{type:"text",tabindex:0,autocomplete:"off"});this._myInput.inject(this.elements.container);this._myInput.addClassName("wux-ui-state-"+this.options.type);this._validFlag=true;if(this.displayClearFieldButtonFlag){this._layoutClearFieldButton()}},handleEvents:function(){var k,m;var l=this;a.addEventOnElement(this,this._myInput,"change",function(n){n.stopPropagation()});a.addEventOnElement(this,this._myInput,"input",function(n){n.stopPropagation();if(l.autoCommitFlag){l.setPropertyFromUIInteraction("value",l._myInput.value)}else{l.setPropertyFromUIInteraction("valueToCommit",l._myInput.value)}if(l._clearFieldButton){if(l._myInput.checkValidity()){l._clearFieldButton.setAttribute("invalid","false")}else{l._clearFieldButton.setAttribute("invalid","true")}}});a.addEventOnElement(this,this._myInput,"blur",function(n){l.callMethodFromUIInteraction("commitCurrentEntry");if(l._myInput){l.fire("blur")}})},_layoutClearFieldButton:function(){var k=this;this._clearFieldButton=new d.Element("div",{"class":"wux-controls-lineeditor-clearbutton"});this._clearFieldButton.setAttribute("draggable","false");this._clearFieldButton.addClassName("wux-controls-lineeditor-clearbutton");this._clearFieldButton.tooltipInfos=new h({shortHelp:j.clearField});this._clearFieldButton.inject(this.elements.container);this._clearFieldButton.setAttribute("invalid","false");this._myInput.setAttribute("has-clearButton","false");var l="wrong";a.generateIcon(l,{target:this._clearFieldButton});this._clearFieldButton.addEventListener(f.POINTERDOWN,function(m){m.preventDefault()});a.addEventOnElement(this,this._clearFieldButton,"click",function(m){if(k.value!==""){k.value=""}else{k._applyValue()}})},_applyValueToCommit:function(k){this._parent();this._applyDisplayClearFieldButtonFlag()},_preEditValue:function(k,l){if(!this.autoCorrectFlag){return true}if(typeof l!=="undefined"&&l!==null){if(l!==k){this._myInput.value=l}}else{this._myInput.value=""}if(!this._myInput.validity.valid&&l.length>0){this._myInput.value=k;return false}else{return true}},_applyValue:function(k,l){this._applyEscapeHTML();this.valueToCommit=this.value;this.fire("change");this._updateValidFlag()},_applyPattern:function(){g.call(this);this._updateValidFlag()},_applySizeInCharNumber:function(){if(this.sizeInCharNumber>=0){this._myInput.setAttribute("size",this.sizeInCharNumber)}else{this._myInput.removeAttribute("size")}},_applyProperties:function(k){this._parent(k);this._applyPlaceholder();this._applySizeInCharNumber();this._myInput.type=(this.displayStyle==="password")?"password":"text";if(this.displayStyle==="lite"){this._myInput.addClassName("wux-controls-lineEditor-lite")}else{this._myInput.removeClassName("wux-controls-lineEditor-lite")}if(typeof this.value!=="undefined"&&this.value!==null){this._myInput.value=this.escapeHTML?d.String.unescapeHTML(this.value):this.value}else{this._myInput.value=""}this.valueToCommit=this.value;this._realApplyRequiredFlag();g.call(this);if(this.isDirty("value")){this.fire("change")}this._updateValidFlag();this._applyDisplayClearFieldButtonFlag()},_applyDisplayClearFieldButtonFlag:function(k){if(!this.displayClearFieldButtonFlag){if(this._clearFieldButton){this._clearFieldButton.style.display="none";this._myInput.setAttribute("has-clearButton","false")}}else{if(!this._clearFieldButton){this._layoutClearFieldButton()}if(this.value===""){this._clearFieldButton.style.display="none";this._myInput.setAttribute("has-clearButton","false")}else{this._clearFieldButton.style.display="";this._myInput.setAttribute("has-clearButton","true")}}}});function g(){if(this.pattern){this._myInput.setAttribute("pattern",this.pattern)}else{this._myInput.removeAttribute("pattern")}if(this._clearFieldButton){if(this._myInput.checkValidity()){this._clearFieldButton.setAttribute("invalid","false")}else{this._clearFieldButton.setAttribute("invalid","true")}}}b.register(c,"DS/ControlsRec/AbstractRec");return c});define("DS/Controls/Slider",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Controls/Popup","DS/Utilities/Dom"],function(e,g,f,h,i,b,c,a){var d=g.inherit({name:"slider",markForRecordFlag:true,publishedProperties:{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:100,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:true,recordFlag:true},displayStyle:{defaultValue:"horizontal",type:"string",category:"Appearance"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",},valuePopupFlag:{defaultValue:true,type:"boolean",category:"Appearance"}},blackBoxFlag:true,keymaps:{esc:{keydown:"cancel"}},commands:{cancel:function(){var j=false;if(!this.handleEditionCancel){return{stopPropagation:false}}if(!this.disabled){this.value=this.initialValue;if(this._inEdition){this._inEdition=false;this.fire("cancelEdit")}j=true}return{infos:{actionPerformed:j}}}},initialValue:undefined,buildView:function(){this.elements.container.addClassName("wux-controls-slider");this.elements.container.setAttribute("tabindex",0);this.elements.sliderContainer=e.Element("div",{"class":"wux-controls-abstract wux-controls-slider-container wux-element-contentbox"});this.elements.sliderContainer.inject(this.elements.container);this.elements.sliderBackground=e.Element("div",{"class":"wux-controls-slider-bg wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.sliderBackgroundFilled=e.Element("div",{"class":"wux-controls-slider-bgFilled wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.sliderCursor=e.Element("div",{"class":"wux-controls-slider-cursor wux-element-contentbox"}).inject(this.elements.sliderContainer);this.elements.spanTooltip=e.Element("span");if(this.valuePopupFlag){if(this.displayStyle==="vertical"){this.elements.popup=new c({arrowBoxFlag:true,overlap:false,target:this.elements.sliderCursor,position:"right"})}else{this.elements.popup=new c({arrowBoxFlag:true,overlap:false,target:this.elements.sliderCursor,position:"top"})}this.elements.popup.getContent().addClassName("wux-slider-tooltip");this.elements.popup.setBody(this.elements.spanTooltip);var j=this;a.onNodeRendered(this.elements.sliderCursor,function(){if(j.elements.popup){j.elements.popup._updateView()}})}this._inEdition=false},_postBuildView:function(){this._applyDisplayStyle()},_applyDisplayStyle:function(){if(this.displayStyle==="vertical"){this.elements.sliderContainer.removeClassName("wux-controls-slider-container");this.elements.sliderBackground.removeClassName("wux-controls-slider-bg");this.elements.sliderBackgroundFilled.removeClassName("wux-controls-slider-bgFilled");this.elements.sliderCursor.removeClassName("wux-controls-slider-cursor");this.elements.sliderContainer.addClassName("wux-controls-slider-vertical");this.elements.sliderBackground.addClassName("wux-controls-slider-bg-vertical");this.elements.sliderBackgroundFilled.addClassName("wux-controls-slider-bgFilled-vertical");this.elements.sliderCursor.addClassName("wux-controls-slider-cursor-vertical");if(this.elements.popup){this.elements.popup.position="right"}}else{this.elements.sliderContainer.addClassName("wux-controls-slider-container");this.elements.sliderBackground.addClassName("wux-controls-slider-bg");this.elements.sliderBackgroundFilled.addClassName("wux-controls-slider-bgFilled");this.elements.sliderCursor.addClassName("wux-controls-slider-cursor");this.elements.sliderContainer.removeClassName("wux-controls-slider-vertical");this.elements.sliderBackground.removeClassName("wux-controls-slider-bg-vertical");this.elements.sliderBackgroundFilled.removeClassName("wux-controls-slider-bgFilled-vertical");this.elements.sliderCursor.removeClassName("wux-controls-slider-cursor-vertical");if(this.elements.popup){this.elements.popup.position="top"}}this._updateCursor()},_applyValuePopupFlag:function(){if(this.elements.popup){if(this.valuePopupFlag){this.elements.popup.show()}else{this.elements.popup.hide()}}},_preEditValue:function(j,l){if(typeof l!=="undefined"&&l!==null&&isNaN(l)){if(this._inEdition){this._inEdition=false;this.fire("cancelEdit")}return false}else{var k=this._getValidatedValue(l);if(k===j){return false}else{if(k!==l){this.value=k;return false}}}},_applyValue:function(j,k){this._updateCursor();if(this.elements.popup){this.elements.spanTooltip.textContent=this.getTextFromValue();this.elements.popup._updateView()}this.fire("change")},_applyMinValue:function(){this._validateValue(this.value)},_applyMaxValue:function(){this._validateValue(this.value)},_applyProperties:function(j){this._parent(j);if(this.isDirty("value")){this._applyValue(j.value,this.value)}if(this.isDirty("disabled")){this._applyDisabled()}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.removeAttribute("tabindex");this.elements.sliderCursor.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.container.setAttribute("tabindex","0");this.elements.sliderCursor.removeAttribute("disabled")}},_giveFocus:function(){this.elements.container.focus()},increment:function(){var j=h.clamp(this.minValue,this.maxValue,this.value+this.stepValue);this.value=j},decrement:function(){var j=h.clamp(this.minValue,this.maxValue,this.value-this.stepValue);this.value=j},_updateCursor:function(){var j=this.getPercentage();var k=j+"%";if(typeof this.value==="undefined"||this.value===null){this.elements.sliderCursor.addClassName("undefined-class")}else{this.elements.sliderCursor.removeClassName("undefined-class");this.elements.sliderBackground.setStyles({borderStyle:"solid"})}if(this.displayStyle==="horizontal"){this.elements.sliderCursor.setStyles({bottom:"",left:k});this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",width:k})}else{this.elements.sliderCursor.setStyles({bottom:k,left:""});this.elements.sliderBackgroundFilled.setStyles({top:100-j+"%",height:k,width:""})}},_getValidatedValue:function(k){var j=undefined;if(typeof k!=="undefined"&&k!==null){j=parseFloat(h.round(k,this.stepValue))}else{j=k}var l=j;if(typeof j!=="undefined"&&j!==null){if(h.isNumber(this.minValue)&&h.isNumber(this.maxValue)){l=h.clamp(this.minValue,this.maxValue,j)}}return l},_validateValue:function(j){var k=this._getValidatedValue(j);if(k!==undefined&&this.value!==k){this.value=k}this._updateCursor()},getTextFromValue:function(){return this.value+""},getPercentage:function(){var j=(this.value-this.minValue)/(this.maxValue-this.minValue)*100;j=j>=0?j:0;j=j<=100?j:100;return j},setPercentage:function(j){this.value=(j/100*(this.maxValue-this.minValue))+this.minValue},handleEvents:function(){var z=this,v=0,u=0,j=0,r=0,y=0,w=0,n=0,p=0,q=z.elements.container,m=z.elements.sliderCursor;function l(){var B=1;if(z.displayStyle==="horizontal"){if(z.elements.popup.position==="top"){B=-1}z.elements.popup.offset.x=-z.elements.popup.getContent().getBoundingClientRect().width/2+m.getBoundingClientRect().width/2;z.elements.popup.offset.y=B*m.getBoundingClientRect().width/2}else{if(z.elements.popup.position==="left"){B=-1}z.elements.popup.offset.y=0;z.elements.popup.offset.x=z.elements.popup.getContent().getBoundingClientRect().width/2}}a.addEventOnElement(this,this.elements.container,"mouseenter",function(B){if(B.buttons===0&&z.value!==undefined&&z.elements.popup&&!z.elements.popup.visibleFlag){z.elements.spanTooltip.textContent=z.getTextFromValue();if(z.valuePopupFlag){z.elements.popup.show();l();z.elements.popup._updateView()}}});a.addEventOnElement(this,this.elements.container,"mouseleave",function(B){if(B.buttons===0&&z.valuePopupFlag){z.elements.popup.hide()}});function x(G){if(z.valuePopupFlag&&z.elements.popup&&!z.elements.popup.visibleFlag){z.elements.popup.show();l();z.elements.popup._updateView()}G.stopPropagation();if(z.disabled){return}var E=document;if(z.getContent()&&z.getContent().ownerDocument){E=z.getContent().ownerDocument}a.addEventOnElement(z,E,f.POINTERMOVE,k);a.addEventOnElement(z,E,f.POINTERUP,t);z.initialValue=z.value;var D=z.elements.sliderContainer;if(z.displayStyle==="horizontal"){v=G.clientX;n=D.clientWidth;var C=G.offsetX;if(G.target===m){C=m.getPosition(D).x}j=h.round(C,1);j=h.clamp(0,n,j);z.fire("beginEdit",{pointerDown:true});z._inEdition=true;if(n!==0&&z.maxValue!==z.minValue){var B=parseFloat(h.round(j/n*(z.maxValue-z.minValue)+z.minValue,z.stepValue));z.setPropertyFromUIInteraction("value",B)}q.focus()}else{u=G.clientY;p=D.clientHeight;var F=u-D.getBoundingClientRect().top;r=h.round(F,1);r=h.clamp(0,p,r);z.fire("beginEdit");z._inEdition=true;if(p!==0&&z.maxValue!==z.minValue){var B=parseFloat(h.round((p-r)/p*(z.maxValue-z.minValue)+z.minValue,z.stepValue));z.setPropertyFromUIInteraction("value",B)}q.focus()}}function A(C){C.preventDefault();C.stopPropagation();var B=document;if(z.getContent()&&z.getContent().ownerDocument){B=z.getContent().ownerDocument}if(!z.disabled&&(z.elements.container===B.activeElement||z.getContent().hasAttribute("focused"))){var D=e.Event.wheelDelta(C);z.fire("beginEdit");z._inEdition=true;(D>0)?z.callMethodFromUIInteraction("increment"):z.callMethodFromUIInteraction("decrement");if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}function k(C){if(!z.disabled){C.preventDefault();if(z.displayStyle==="horizontal"){y=C.clientX-v+j;y=h.clamp(0,n,y);if(n!==0&&z.maxValue!==z.minValue){var B=y/n*(z.maxValue-z.minValue)+z.minValue;z.setPropertyFromUIInteraction("value",B)}}else{w=C.clientY-u+r;w=h.clamp(0,p,h.round(w,1));if(p!==0&&z.maxValue!==z.minValue){z.setPropertyFromUIInteraction("value",(p-w)/p*(z.maxValue-z.minValue)+z.minValue)}}l()}}function t(C){var B=document;if(z.valuePopupFlag&&z.elements.popup&&z.elements.popup.visibleFlag){z.elements.popup.hide()}if(z.getContent()&&z.getContent().ownerDocument){B=z.getContent().ownerDocument}a.removeEventOnElement(z,B,f.POINTERMOVE,k);a.removeEventOnElement(z,B,f.POINTERUP,t);if(!z.disabled){z.initialValue=z.value;C.preventDefault();C.stopPropagation();if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}function o(B){if(!z.disabled&&z.keyDown&&(i.decrease(B.keyCode)||i.increase(B.keyCode))){B.preventDefault();B.stopPropagation();z.keyDown=false;if((B.keyCode!==i.ESCAPE)||(B.keyCode===i.ESCAPE&&B.actionPerformed===true)){if(z._inEdition){z._inEdition=false;z.fire("endEdit")}}}}function s(B){if(!z.disabled&&i.decrease(B.keyCode)||i.increase(B.keyCode)){if(!z.keyDown){z.keyDown=true;z.fire("beginEdit");z._inEdition=true}if(i.decrease(B.keyCode)){z.callMethodFromUIInteraction("decrement")}else{z.callMethodFromUIInteraction("increment")}B.preventDefault();B.stopPropagation()}}a.addEventOnElement(this,q,f.POINTERDOWN,x);a.addEventOnElement(this,q,"mousewheel",A);a.addEventOnElement(this,q,"keyup",o);a.addEventOnElement(this,q,"keydown",s)}});b.register(d,"DS/ControlsRec/AbstractRec");return d});define("DS/Controls/ColoredSlider",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Color","DS/Controls/Slider"],function(f,e,c,b){var a=b.inherit({name:"coloredSlider",publishedProperties:{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:255,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},colorFrom:{defaultValue:"#000",type:"string",category:"Appearance"},colorTo:{defaultValue:"#fff",type:"string",category:"Appearance"}},buildView:function(){this._parent();this.elements.sliderTransparentBackground=f.Element("div",{"class":"wux-controls-slider-transparent"}).inject(this.elements.sliderContainer,"top");this.elements.sliderCursorInternalColor=f.Element("div",{"class":"wux-controls-slider-cursor-color"}).inject(this.elements.sliderCursor);this.elements.container.addClassName("wux-controls-colorslider")},handleEvents:function(){this._parent()},_applyColorFrom:function(){this._updateBackground();this._updateCursor()},_applyColorTo:function(){this._updateBackground();this._updateCursor()},_updateBackground:function(){this.colorFrom=d(this.colorFrom);this.colorTo=d(this.colorTo);var h="linear-gradient(";var g=(this.displayStyle==="horizontal")?"to right":"to top";h+=g+", "+this.colorFrom+", "+this.colorTo+")";this.elements.sliderBackground.setStyle("background",h)},_applyDisplayStyle:function(){this._parent();this._updateBackground()},_updateCursor:function(){this._parent();var h=this.getPercentage()/100;var g;var j=this.colorFrom;var i=this.colorTo;if(j==="transparent"){j="#fff";this.elements.sliderCursorInternalColor.setStyle("opacity",h)}if(i==="transparent"){i="#fff";this.elements.sliderCursorInternalColor.setStyle("opacity",1-h)}g=c.lerpColorHex(j,i,h);this.elements.sliderCursor.setStyle("background-position-x",200*h+"px, 0px");this.elements.sliderCursorInternalColor.setStyle("background-color","#"+g)}});function d(g){if(g==="transparent"){return g}if(typeof g!=="string"){return"#000"}if(g.charAt(0)==="#"){g=g.substr(1)}if(g.length===3){g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]}return(g.length===6)?"#"+g:"#000"}return a});define("DS/Controls/ResponsiveViewAdaptor",["UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(h,g,b,f,a,e,c){var d=b.inherit({name:"ResponsiveViewAdaptor",markForRecordFlag:true,publishedProperties:{picture:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Appearance"},title:{defaultValue:"",type:"string",category:"Appearance"},multipleTitleLineNumber:{defaultValue:false,type:"boolean",category:"Behavior"},subtitle:{defaultValue:"",type:"string",category:"Appearance"},description:{defaultValue:"",type:"string",category:"Appearance"},propertiesList:{defaultValue:[],type:"array",category:"Appearance"},contextualMenu:{defaultValue:[],type:"array",category:"Behavior"},onContextMenuBuildCallback:{defaultValue:undefined,type:"function",category:"Behavior"},emptyStatusbarVisibleFlag:{defaultValue:false,type:"boolean",category:"Appearance"},statusbarIcons:{defaultValue:[],type:"array",category:"Behavior"},statusbarIconsTooltips:{defaultValue:[],type:"array",category:"Behavior"},onStatusbarIconPointerDown:{defaultValue:undefined,type:"function",category:"Behavior"},activeFlag:{defaultValue:false,type:"boolean",category:"Appearance"},color:{defaultValue:"",type:"string",category:"Appearance"},customTooltip:{defaultValue:"",type:"object",category:"Appearance"},badges:{defaultValue:[],type:"array",category:"Behavior"},clickableTitle:{defaultValue:false,type:"boolean",category:"Behavior"}},_applyProperties:function(i){this.elements.container.style.display="none";this._parent(i);if(this.isDirty("statusbarIcons")){this._applyStatusbarIcons(i.statusbarIcons)}if(this.isDirty("badges")){this._applyBadges(i.badges)}if(this.isDirty("emptyStatusbarVisibleFlag")){this._applyEmptyStatusbarVisibleFlag(i.emptyStatusbarVisibleFlag)}if(this.isDirty("picture")){this._applyPicture(i.picture)}if(this.isDirty("icon")){this._applyIcon(i.icon)}if(this.isDirty("title")){this._applyTitle(i.title)}if(this.isDirty("clickableTitle")){this._applyClickableTitle(i.clickableTitle)}if(this.isDirty("multipleTitleLineNumber")){this._applyMultipleTitleLineNumber(i.multipleTitleLineNumber)}if(this.isDirty("subtitle")){this._applySubtitle(i.subtitle)}if(this.isDirty("description")){this._applyDescription(i.description)}if(this.isDirty("propertiesList")){this._applyPropertiesList(i.propertiesList)}if(this.isDirty("title")){this._applyTitle(i.title)}if(this.isDirty("contextualMenu")){this._applyContextualMenu(i.contextualMenu)}if(this.isDirty("onContextMenuBuildCallback")){this._applyOnContextMenuBuildCallback(i.onContextMenuBuildCallback)}if(this.isDirty("statusbarIconsTooltips")){this._applyStatusbarIconsTooltips(i.statusbarIconsTooltips)}if(this.isDirty("onStatusbarIconPointerDown")){this._applyOnStatusbarIconPointerDown(i.onStatusbarIconPointerDown)}if(this.isDirty("activeFlag")){this._applyActiveFlag(i.activeFlag)}if(this.isDirty("color")){this._applyColor(i.color)}if(this.isDirty("customTooltip")){this._applyCustomTooltip(i.customTooltip)}this.elements.container.style.display=""},_applyPicture:function(i){if(this.picture){this.elements.container.setAttribute("has-picture","true");if(this.elements.picture.innerText){this.elements.picture.innerText="";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else{this.elements.container.setAttribute("has-picture","false");this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}},_applyViewWidth:function(i){if(this._getViewWidth()!==i&&this._getViewWidth()>=this._getViewMinWidth()&&this._getViewWidth()<=this._getViewMaxWidth()){this.getContent().setStyle("width",this._getViewWidth().toString()+"px");this._onViewResize(this._getViewWidth())}},_applyIcon:function(i){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-"+this.name.toLowerCase()+"-icon");if(this.icon===""){this.elements.container.setAttribute("has-icon","false");this.elements.title.setAttribute("has-icon","false");this._applyTitle();return}if(this.icon){this.elements.container.setAttribute("has-icon","true");this.elements.title.setAttribute("has-icon","true");a.generateIcon(this.icon,{target:this.elements.icon});this.elements.icon.show();this._applyTitle()}},_applyTitle:function(i){this._setTitle(this.title,this.elements.container.titleLineNumber);this._onViewResize(this._getViewWidth())},_applyClickableTitle:function(i){if(this.clickableTitle){this.elements.title.addClassName("wux-controls-responsiveview-clickable-title")}else{this.elements.title.removeClassName("wux-controls-responsiveview-clickable-title")}},_setTitle:function(o,k){if(!o){this.elements.realtitle="";return}this.elements.realtitle=o;var m=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;if(k===1){this.elements.title.removeClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title");this.elements.title.layoutDsModel=this.layoutingCollection;if(h.is(o,"string")){a.setContent(this.elements.title,o,m)}else{this.elements.title.setHTML(o)}if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.customTooltip){if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:o})}else{this.elements.container.tooltipInfos.shortHelp=o}}}}else{var p=this._getTitleLineHeight();var l=o;if(this.elements.title.getAttribute("has-icon")==="true"){l="..W"+o}var i=null;if(/<\/?[^>]*>/.test(o)){i=this._createEllipsisHTML({allowUnsafeHTMLContent:m,label:l,maxWidth:"auto",lineHeight:p,nbLinesVisible:k})}else{i=a.createEllipsisText({allowUnsafeHTMLLabel:m,label:l,maxWidth:"auto",lineHeight:p,nbLinesVisible:k,})}i.style.wordBreak="break-all";if(this.elements.title.getAttribute("has-icon")==="true"){i.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title")}var j=this.elements.title.getAttribute("has-icon","true");var q=this.elements.title.getAttribute("has-menu","true");this.elements.titlebar.removeChild(this.elements.title);this.elements.title=i;this.elements.title.layoutDsModel=this.layoutingCollection;this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);i.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-title");this.elements.title.setAttribute("has-icon",j);this.elements.title.setAttribute("has-menu",q);if(this.clickableTitle){this.elements.title.addClassName("wux-controls-responsiveview-clickable-title")}this.elements.titlebar.appendChild(i);if(!this.layoutingCollection||this.layoutingCollection.displayTitleTooltip===true){if(!this.customTooltip){this.elements.container.tooltipInfos=new c({shortHelp:o})}}}var n=k*(this._getTitleLineHeight()+2);var r=n+"px";this.elements.titlebar.setStyle("height",r);this.elements.title.setStyle("height",r)},_applyMultipleTitleLineNumber:function(i){if(this.multipleTitleLineNumber===false||((this.multipleTitleLineNumber===true)&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false")){this.elements.container.titleLineNumber=(this.multipleTitleLineNumber===false)?1:2;this._onViewResize(this._getViewWidth())}},_applySubtitle:function(j){var i=this.subtitle;if(i){var k=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;this.elements.subtitle.layoutDsModel=this.layoutingCollection;a.setContent(this.elements.subtitle,i,k);this.elements.subtitle.setAttribute("has-subtitle","true")}else{this.elements.subtitle.setAttribute("has-subtitle","false")}this._onViewResize(this._getViewWidth())},_applyDescription:function(i){this._setDescription(this.description,this.elements.container.descriptionLineNumber);this._onViewResize(this._getViewWidth())},_onTitleClick:function(i){if(this.contentView&&this.contentView.layoutingCollection){var j=this.contentView.layoutingCollection.getCellInfosFromHtmlElement(this);this.contentView.layoutingCollection._onCellTitleClick(j)}},_setDescription:function(k,i){if(!k){this.elements.description.setAttribute("has-description","false");this.elements.realdescription="";this._applyPropertiesList();if(this.elements.subtitle.getAttribute("has-subtitle")!=="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")!=="false"){this.multipleTitleLineNumber=false}return}this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.realdescription=k;if(i===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}var j=this._getDescriptionLineHeight();var m=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var l=a.createEllipsisText({allowUnsafeHTMLLabel:m,label:k,maxWidth:"auto",lineHeight:j,nbLinesVisible:i});this.elements.maincontent.removeChild(this.elements.description);this.elements.description=l;this.elements.description.layoutDsModel=this.layoutingCollection;this.elements.description.setAttribute("has-description","true");l.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-description");this.elements.maincontent.appendChild(l)},_applyPropertiesList:function(k){if(!this._propertiesArray){this._propertiesArray=[]}if(!this._propertiesSpacersArray){this._propertiesSpacersArray=[]}this.elements.propertiesList.setAttribute("has-propertiesList","false");if(this.propertiesList){var o=this._propertiesArray.length;var p=this.propertiesList.length;if(p>o){for(var m=o;m<p;m++){var n=new h.Element("div",{"class":"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc"});n.setStyle("display","none");n.layoutDsModel=this.layoutingCollection;a.setContent(n,this.propertiesList[m]);n.tooltipInfos=new c({shortHelp:this.propertiesList[m]});this._propertiesArray.push(n)}}if(p>this._propertiesSpacersArray.length){for(var m=this._propertiesSpacersArray.length;m<p;m++){var j=new h.Element("div",{"class":"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc-spacer"});j.setStyle("display","none");this._propertiesSpacersArray.push(j)}}for(var m=o;m<p;m++){if((m+1)%2===0){this._propertiesArray[m].inject(this.elements.propertiesListSecondContainer);this._propertiesSpacersArray[m].inject(this.elements.propertiesListSecondContainer)}else{this._propertiesArray[m].inject(this.elements.propertiesListFirstContainer);this._propertiesSpacersArray[m].inject(this.elements.propertiesListFirstContainer)}}if(this._propertiesArray&&this._propertiesArray.length){for(var l=0;l<this.propertiesList.length;l++){this._propertiesArray[l].setStyle("display","none")}}for(var l=0;l<this.propertiesList.length;l++){this._propertiesArray[l].layoutDsModel=this.layoutingCollection;a.setContent(this._propertiesArray[l],this.propertiesList[l]);this._propertiesArray[l].tooltipInfos.shortHelp=this.propertiesList[l]}}if(this.elements.description.getAttribute("has-description")==="false"){if(this.propertiesList&&this.propertiesList.length>0){this.elements.description.setStyle("display","none");this.elements.propertiesList.setAttribute("has-propertiesList","true");if(this.elements.subtitle.getAttribute("has-subtitle")!=="false"){this.multipleTitleLineNumber=false}}else{this.elements.description.setStyle("display","block")}}else{this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.description.setStyle("display","block")}this._onViewResize(this._getViewWidth())},_applyContextualMenu:function(i){if(this.contextualMenu&&this.contextualMenu.length){this.elements.title.setAttribute("has-menu","true");this.elements.subtitle.setAttribute("has-menu","true");this.elements.maincontent.setAttribute("has-menu","true");this.elements.titlebar.setAttribute("has-menu","true");this.elements.menu.setAttribute("has-menu","true");this.elements.menu.list=this.contextualMenu}else{this.elements.title.setAttribute("has-menu","false");this.elements.subtitle.setAttribute("has-menu","false");this.elements.titlebar.setAttribute("has-menu","false");this.elements.maincontent.setAttribute("has-menu","false");this.elements.menu.setAttribute("has-menu","false")}},_applyOnContextMenuBuildCallback:function(i){if(i){this.elements.menu.removeEventListener(f.POINTERUP,i)}var j=this;a.addEventOnElement(this,this.elements.menu,f.POINTERDOWN,function(k){if(j.layoutingCollection&&!f.isTouchEvent(k)){var l=j.layoutingCollection.getCellInfosFromHtmlElement(j.getContent());if(l.cellModel&&j.layoutingCollection.modelProvider.isNodeSelected(l.cellModel)){k.stopPropagation()}}});a.addEventOnElement(this,this.elements.menu,"click",function(m){var k=j.layoutingCollection;if(f.isTouchEvent(m)){if(k){var o=this;var n=k.getCellInfosFromHtmlElement(j.getContent());if(n){var p=n.nodeModel;if(p&&!k.modelProvider.isNodeSelected(p)){k._cellUISelectionAction=true;k.modelProvider.selectNode(p,true);k._setActiveNode(p,true);k._cellUISelectionAction=false}}}}var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",true,false);l.pageX=m.pageX;l.pageY=m.pageY;l.dispatchContext="menuClick";this.dispatchEvent(l);m.stopPropagation()});e.addEventListener(j.elements.container,{callback:function(n){var k=j.layoutingCollection;if(k&&k.onContextualEvent){k._cellCtxMenuRequired=true;var m=k.getCellInfosFromHtmlElement(j.getContent());if(m){var o=m.cellModel;if(o&&!k.modelProvider.isNodeSelected(o)){k._cellUISelectionAction=true;k.modelProvider.selectNode(o,true);k.setActiveNode(o,true);k._cellUISelectionAction=false}}var l=k.onContextualEvent;return l.callback.call(l["this"],{context:j,infos:n.info,data:n.data,menu:j.contextualMenu,infoContext:n.context,cellInfos:k.getCellInfosFromHtmlElement(j.getContent())})}else{return j._setCtxMenuCB(n)}}})},_applyEmptyStatusbarVisibleFlag:function(i){if(this.emptyStatusbarVisibleFlag===true){this.elements.statusbar.setAttribute("is-empty-statusbar-visible","true");this.elements.container.setAttribute("is-empty-statusbar-visible","true")}else{if(this.emptyStatusbarVisibleFlag===false){this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false")}}},_applyStatusbarIcons:function(j){var i;this.elements.statusbar.style.display="none";if(j){for(i=0;i<j.length;i++){var m=2*i;var l=this.elements.statusbar.children[m];l.className="";a.empty(l)}}this.elements.container.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("has-statusbar-content","false");if(this.statusbarIcons){for(i=0;i<this.statusbarIcons.length;i++){var m=2*i;var k=this.statusbarIcons[i];var l=this.elements.statusbar.children[m];l.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon");if(k&&l){this.elements.container.setAttribute("has-statusbar-content","true");this.elements.statusbar.setAttribute("has-statusbar-content","true");a.generateIcon(k,{target:l});l.setStyle("font-size","14px");l.setStyle("line-height","14px")}else{a.empty(l)}}}this.elements.statusbar.style.display=""},_applyBadges:function(k){var j;var o=this.statusbarIcons?this.statusbarIcons.length:0;this.elements.statusbar.style.display="none";if(k){var i=o+k.length<=this.elements.statusbar.children.length/2?o+k.length:this.elements.statusbar.children.length/2;for(j=o;j<i;j++){var n=2*j;var m=this.elements.statusbar.children[n];m.className="";a.empty(m)}}if(!this.statusbarIcons||!this.statusbarIcons.length){this.elements.container.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("has-statusbar-content","false")}if(this.badges){var i=o+this.badges.length<=this.elements.statusbar.children.length/2?o+this.badges.length:this.elements.statusbar.children.length/2;for(j=o;j<i;j++){var n=2*j;var l=this.badges[j-o];var m=this.elements.statusbar.children[n];m.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-statusbaricon");if(l&&m){this.elements.container.setAttribute("has-statusbar-content","true");this.elements.statusbar.setAttribute("has-statusbar-content","true");a.generateIcon(l,{target:m});m.setStyle("font-size","14px");m.setStyle("line-height","14px")}else{a.empty(m)}}}this.elements.statusbar.style.display=""},_applyStatusbarIconsTooltips:function(j){var i;this.elements.statusbar.style.display="none";if(j){for(i=0;i<j.length;i++){var l=2*i;var k=this.elements.statusbar.children[l];k.tooltipInfos=null}}if(this.statusbarIconsTooltips){for(i=0;i<this.statusbarIconsTooltips.length;i++){var l=2*i;var m=this.statusbarIconsTooltips[i]!==undefined?this.statusbarIconsTooltips[i]:"";var k=this.elements.statusbar.children[l];if(this.layoutingCollection&&this.layoutingCollection.displayStatusbarTooltip===false){k.tooltipInfos=null}else{if(!k.tooltipInfos){k.tooltipInfos=new c({shortHelp:m})}else{k.tooltipInfos.shortHelp=m}}}}this.elements.statusbar.style.display=""},_applyOnStatusbarIconPointerDown:function(i){var j=this;if(i){this.removeEventListener("StatusbarIconPointerDown",i)}this.addEventListener("StatusbarIconPointerDown",function(m){var l=j.layoutingCollection;if(l&&l.onStatusbarIconPointerDown){var k=l.onStatusbarIconPointerDown;return k.call(j,{cellInfos:l.getCellInfosFromHtmlElement(j.getContent()),clickedIconIndex:m.options?m.options.iconIndex:-1})}else{if(j.onStatusbarIconPointerDown){return j.onStatusbarIconPointerDown.call(j,m)}}})},_applyActiveFlag:function(){if(this.activeFlag!==undefined){if(this.activeFlag===true){this.elements.container.setAttribute("active-mode","true")}else{if(this.activeFlag===false){this.elements.container.setAttribute("active-mode","false")}}}},_applyColor:function(){if(this.color&&this.color!="initial"){this.elements.color.setAttribute("has-color","true");this.elements.color.setStyles({background:this.color}).show()}else{this.elements.color.setAttribute("has-color","false")}},_applyCustomTooltip:function(i){if(this.customTooltip!==i){if(this.customTooltip||i){if(this.customTooltip){if(!this.elements.container.tooltipInfos){if(this.customTooltip instanceof c){this.elements.container.tooltipInfos=this.customTooltip}else{this.elements.container.tooltipInfos=new c({shortHelp:this.customTooltip})}}else{if(this.customTooltip instanceof c){this.elements.container.tooltipInfos=this.customTooltip}else{this.elements.container.tooltipInfos.shortHelp=this.customTooltip}}}else{if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:this.title})}else{this.elements.container.tooltipInfos.shortHelp=this.title}}}}else{if(this.layoutingCollection&&this.layoutingCollection.displayTitleTooltip===false){this.elements.container.tooltipInfos=null}else{if(!this.elements.container.tooltipInfos){this.elements.container.tooltipInfos=new c({shortHelp:this.title})}else{this.elements.container.tooltipInfos.shortHelp=this.title}}}}},handleEvents:function(){var i=this;a.addEventOnElement(this,this.elements.container,"mouseenter",function(j){i.prehighlight()});a.addEventOnElement(this,this.elements.container,"mouseleave",function(j){i.unPrehighlight()});a.addEventOnElement(this,this.elements.checkbox,f.POINTERDOWN,function(j){if(i.layoutingCollection){i.layoutingCollection._enableInteractiveMultiSelMode()}})},prehighlight:function(){var i=this;if(!i.isPreHighlighted){i.elements.container.addClassName("wux-ui-state-prehighlighted");i.checkbox.addClassName("wux-ui-state-prehighlighted");i.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted");i.isPreHighlighted=true}},unPrehighlight:function(){var i=this;if(i.isPreHighlighted){i.elements.container.removeClassName("wux-ui-state-prehighlighted");i.checkbox.removeClassName("wux-ui-state-prehighlighted");i.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted");i.isPreHighlighted=false}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.addClassName("wux-ui-state-highlighted");this.elements.highlightBorder.addClassName("wux-ui-state-highlighted")},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.removeClassName("wux-ui-state-highlighted");this.elements.highlightBorder.removeClassName("wux-ui-state-highlighted")},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")},setPictureBackgroundSize:function(i){if(this.elements.picture){this.elements.picture.setStyle("background-size",i)}},onStatusbarIconPointerDown:function(i){this._modelEvents.publish({event:"StatusbarIconPointerDown",context:this,data:this})},_setCtxMenuCB:function(m){var l=[];if(this.elements.menu.list&&this.elements.menu.list.length){var k=this.elements.menu.list;if(this.onContextMenuBuildCallback){l=this.onContextMenuBuildCallback.call(this,k)}else{for(var j=0;j<k.length;j++){l.push({type:"PushItem",title:k[j],action:{callback:function(i){alert("No action implemented on this context menu entry! Please implement onContextMenuBuildCallback callback!")}}});if(j>=0&&j<k.length){l.push({type:"SeparatorItem"})}}}}return l},_onViewResize:function(z){if(!(this.elements.description.getAttribute("has-description")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="true")){this.elements.description.setStyle("display","block")}if(this.elements.propertiesList.getAttribute("has-propertiesList")==="true"){var u=0;var p=0;if(this.layoutingCollection&&this.layoutingCollection.layout){u=this.layoutingCollection.layout._columnWidth-(5+80+10+2+(this.elements.maincontent.getAttribute("has-menu")==="true"?40:10));p=(this.elements.container.getAttribute("has-icon")==="true")?16:0}else{var s=window.getComputedStyle(this.elements.maincontent);u=parseInt(s.width,10);var B=window.getComputedStyle(this.elements.icon);p=parseInt(B.width,10)}var o=Math.floor(u/175);var q=Math.floor(this._propertiesArray.length);var t=Math.min(o*2,q);if(t===0){if(this._propertiesArray.length>=2){t=2}else{if(this._propertiesArray.length===1){t=1}else{t=0}}}if(t!==0){var m=(u-(t/2)*20)/(t/2);var r=m.toString()+"px";for(var C=0;C<t;C++){this._propertiesArray[C].setStyle("display","block");this._propertiesArray[C].setStyle("width",r);this._propertiesSpacersArray[C].setStyle("display","block")}for(var C=t;C<this._propertiesArray.length;C++){this._propertiesArray[C].setStyle("display","none");this._propertiesSpacersArray[C].setStyle("display","none")}}else{for(var C=0;C<this._propertiesArray.length;C++){this._propertiesArray[C].setStyle("display","none");this._propertiesSpacersArray[C].setStyle("display","none")}}}var y=this.elements.container.titleLineNumber;var E=true;var D=true;var w=1;var j=4-y-w;if(this.elements.subtitle.getAttribute("has-subtitle")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false"){if(this.multipleTitleLineNumber===true){y++}else{j++}w=0;E=false}if(this.elements.description.getAttribute("has-description")==="false"&&this.elements.propertiesList.getAttribute("has-propertiesList")==="false"){if(this.multipleTitleLineNumber===true){y++}j=0;D=false}var A=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var n=h.createElement("div",{});if(g.getUnsafeHTMLContentValueToApply(A)){n.innerHTML=this.elements.realtitle}else{n.innerText=this.elements.realtitle}var l=document.createElement("canvas");var k=l.getContext("2d");k.font="13px arial";var x=k.measureText(n.innerText);var v=x.width;var u=0;var p=0;if(this.layoutingCollection&&this.layoutingCollection.layout){u=this.layoutingCollection.layout._columnWidth-(5+80+10+2+(this.elements.maincontent.getAttribute("has-menu")==="true"?40:10));p=(this.elements.container.getAttribute("has-icon")==="true")?16:0}else{var s=window.getComputedStyle(this.elements.maincontent);u=parseInt(s.width,10);var B=window.getComputedStyle(this.elements.icon);p=parseInt(B.width,10)}if(y>1&&v<(u-p)){y=1}this._setTitle(this.elements.realtitle,y);if(y>1){this.elements.title.setAttribute("on-singleLine","false")}else{this.elements.title.setAttribute("on-singleLine","true")}if(this.elements.realdescription){this.elements.container.descriptionLineNumber=4-y-w;this._setDescription(this.elements.realdescription,4-y-w)}else{if(y===3){this.elements.description.setStyle("display","none")}}},_createEllipsisHTML:function(m){var m=m||{maxWidth:"auto",lineHeight:18,nbLinesVisible:2,textAlign:"justify"};if(m.nbLinesVisible===1){var l={"class":"wux-button-label-ellipsis-nowrap",styles:{"max-width":m.maxWidth,"line-height":m.lineHeight+"px"}};if(g.getUnsafeHTMLContentValueToApply(m.allowUnsafeHTMLContent)){l.html=m.label}else{l.text=m.label}return new h.Element("div",l)}var j=m.nbLinesVisible||2;var n=m.lineHeight;var i={"class":"wux-button-label-ellipsis-wrap",styles:{"text-align":m.textAlign,"max-width":m.maxWidth,"line-height":m.lineHeight+"px","max-height":m.lineHeight*j+"px"}};if(g.getUnsafeHTMLContentValueToApply(m.allowUnsafeHTMLContent)){i.html=m.label}else{i.text=m.label}var k=new h.Element("div",i);a.onNodeRendered(k,function(){var s=k.children.length;var x=null;var B=0;var C=0;var w=null;var E=null;var D=null;var v=[];var p=0;var q=0;var y=0;k.getChildren().every(function(I,G){if(C!==0){v.push(I)}else{var H=I.getPosition().y;var F=I.getDimensions().height;if(H!==x){x=H;B++}if(B===j){C=G;E=I;D=w;p=I.getPosition().x;q=I.getPosition().y;y=w.getPosition().x;v.push(I)}}w=I;return true});var A=h.createElement("span",{styles:{overflow:"hidden","text-overflow":"ellipsis","white-space":"pre",display:"inline-block",}});if(p>0){A.setStyle("position","absolute");D.setStyle("margin-right","3px")}var o=k.getDimensions().width-p-1;A.setStyle("width",o+"px");k.insertBefore(A,E);for(var r=0;r<v.length;r++){k.removeChild(v[r]);v[r].setStyle("margin-right","3px");A.appendChild(v[r])}var z=A.getPosition().y;if(Math.abs(z-q)>=n){A.setStyle("position","relative")}else{if(Math.abs(z-q)>=n-2){A.setStyle("position","absolute");D.setStyle("margin-right","3px");var t=A.getPosition().x;var u=k.getDimensions().width-t-1;A.setStyle("width",u+"px")}}if(A.innerHTML===""){A.setStyle("display","none")}});return k},_getTitleLineHeight:function(){return 15},_getDescriptionLineHeight:function(){return 13}});return d});define("DS/Controls/ResponsiveThumbnailView",["UWA/Core","DS/Utilities/Utils","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(e,j,f,h,b,d,i,k){var c=150;var a=420;var g=f.inherit({name:"ResponsiveThumbnailView",markForRecordFlag:true,publishedProperties:{thumbnailWidth:{defaultValue:200,type:"integer",category:"Behavior"}},buildView:function(){this._modelEvents=new d();this._isHighlighted=false;var n=this;this.elements.container=new e.Element("div",{"class":"wux-controls-responsivethumbnailview"});this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new e.Element("div",{"class":"wux-controls-highlightborder",}).inject(this.elements.container);this.elements.activediv=new e.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.picture=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-picture",}).inject(this.elements.container);this.elements.color=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-color",}).inject(this.elements.picture);this.elements.color.setAttribute("has-color","false");this.elements.checkbox=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.maincontent=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.titlebar=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-titlebar"}).inject(this.elements.maincontent);this.elements.icon=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-icon"}).inject(this.elements.titlebar);this.elements.title=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;b.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.subtitle.setAttribute("has-menu","false");this.elements.mc_desc_separator=new e.Element("div",{"class":"wux-controls-mc_desc_separator"}).inject(this.elements.container);this.elements.description=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-description"}).inject(this.elements.container);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-propertiesListContainer"}).inject(this.elements.container);this.elements.propertiesList.setAttribute("has-propertiesList","false");for(var l=0;l<13;l++){var o=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-propertyDesc"}).inject(this.elements.propertiesList)}this.elements.menu=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-menu"}).inject(this.elements.maincontent);this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar_separator=new e.Element("div",{"class":"wux-controls-statusbar_separator"}).inject(this.elements.container);this.elements.statusbar=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbar",}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var l=0;l<8;l++){var m=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbaricon",});this.elements.statusbaricons.push(m);var p=new e.Element("div",{"class":"wux-controls-responsivethumbnailview-statusbarseparator",});this.elements.statusbar.appendChild(m);this.elements.statusbar.appendChild(p);m._index=l;b.addEventOnElement(this,m,h.POINTERDOWN,function(q){n.fire("StatusbarIconPointerDown",{iconIndex:q.target._index});q.stopPropagation()})}},_applyProperties:function(l){this._parent(l);if(this.isDirty("thumbnailWidth")){this._applyThumbnailWidth(l.thumbnailWidth)}},_applyPicture:function(l){if(this.picture){this.elements.container.setAttribute("has-picture","true");if(this.elements.picture.innerText){this.elements.picture.innerText="";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else{this.elements.container.setAttribute("has-picture","false");this.elements.picture.innerText="PLACE YOUR PNG PICTURE HERE";this.elements.color.inject(this.elements.picture);this.elements.checkbox.inject(this.elements.picture)}},_applyThumbnailWidth:function(l){this._applyViewWidth(l)},_applyMultipleTitleLineNumber:function(l){if(this.multipleTitleLineNumber){this.elements.container.titleLineNumber=(this.multipleTitleLineNumber===false)?1:2;this._onViewResize()}},_applyDescription:function(l){this.elements.mc_desc_separator.style.display="none";this._parent()},_setDescription:function(s,q){if(!s){this.elements.description.setAttribute("has-description","false");this.elements.realdescription="";this._applyPropertiesList();return}this.elements.mc_desc_separator.style.display="";this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.realdescription=s;if(q===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}var z=q;if(this.layoutingCollection&&this.layoutingCollection.layout){var v=this.layoutingCollection.getViewportDimensions(true);var o=Math.floor((v.width-(this.layoutingCollection.layout._numberOfColumns+1)*this.layoutingCollection.layout.gutter)/this.layoutingCollection.layout._numberOfColumns);if(o<c){o=c}var A=this.layoutingCollection.layout._getRowHeight()-(o*3/4+70+14+((this.elements.statusbar.getAttribute("has-statusbar-content")==="true"||this.emptyStatusbarVisibleFlag===true)?28:0));z=Math.floor(A/13)}else{var y=window.getComputedStyle(this.elements.description);var p=document.createElement("canvas");var n=p.getContext("2d");n.font="11px arial";var u=n.measureText(this.elements.realdescription);var w=0;var m=u.width;if(y.width!==""){w=parseInt(y.width,10);if(w!==0){w-=28}}else{w=this.thumbnailWidth}z=0;if(w!==0){z=Math.ceil((m/w).toPrecision(3))}if(z===0){z=1}z++;if(z>13){z=13}if(z===1){this.elements.description.setAttribute("on-singleLine","true")}else{this.elements.description.setAttribute("on-singleLine","false")}}var x=this._getDescriptionLineHeight();var r=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var t=b.createEllipsisText({allowUnsafeHTMLLabel:r,label:s,maxWidth:"auto",lineHeight:x,nbLinesVisible:z});var l=this.elements.description.getAttribute("on-singleLine");this.elements.container.removeChild(this.elements.description);this.elements.description=t;this.elements.description.layoutDsModel=this.layoutingCollection;this.elements.description.setAttribute("has-description","true");this.elements.description.setAttribute("on-singleLine",l);this.elements.description.addClassName("wux-controls-responsivethumbnailview-description");this.elements.container.insertBefore(t,this.elements.statusbar_separator)},_applyPropertiesList:function(m){this.elements.mc_desc_separator.style.display="none";for(var o=0;o<this.elements.propertiesList.children.length;o++){this.elements.propertiesList.children[o].setStyle("display","none")}var n=window.getComputedStyle(this.elements.mc_desc_separator);var l=parseInt(n.width,10);var q=l.toString()+"px";var r=13;if(this.propertiesList){if(this.propertiesList.length>0){this.elements.mc_desc_separator.style.display=""}for(var o=0;o<this.propertiesList.length&&o<r;o++){var p=this.elements.propertiesList.children[o];p.layoutDsModel=this.layoutingCollection;if(o===r-1&&this.propertiesList.length>r){b.setContent(p,"...")}else{b.setContent(p,this.propertiesList[o])}if(this.layoutingCollection&&this.layoutingCollection.displayPropertiesTooltip===false){p.tooltipInfos=null}else{if(!p.tooltipInfos){p.tooltipInfos=new k({shortHelp:this.propertiesList[o]})}else{p.tooltipInfos.shortHelp=this.propertiesList[o]}}if(this.propertiesList[o]!==""){p.setStyle("display","block");p.setStyle("width",q)}else{p.setStyle("display","none")}}}if(this.elements.description.getAttribute("has-description")==="false"){this.elements.description.setStyle("display","none");if(this.propertiesList&&this.propertiesList.length>0){this.elements.propertiesList.setAttribute("has-propertiesList","true")}else{this.elements.propertiesList.setAttribute("has-propertiesList","false")}}else{this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.description.setStyle("display","block")}},_getViewMinWidth:function(){return c},_getViewMaxWidth:function(){return a},_getViewWidth:function(){return this.thumbnailWidth},_onViewResize:function(){var s=this.elements.container.titleLineNumber;var o=true;var x=true;var v=1;var p=10;if(this.elements.subtitle.getAttribute("has-subtitle")==="false"){if(this.multipleTitleLineNumber===true){s++}v=0;o=false}var r=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos):true;var w=e.createElement("div",{});if(j.getUnsafeHTMLContentValueToApply(r)){w.innerHTML=this.elements.realtitle}else{w.innerText=this.elements.realtitle}var n=document.createElement("canvas");var m=n.getContext("2d");m.font="13px arial";var t=m.measureText(w.innerText);var y=t.width;var q=window.getComputedStyle(this.elements.title);var z=parseInt(q.width,10);var l=window.getComputedStyle(this.elements.icon);var u=parseInt(l.width,10);if(s>1&&y<(z-u)){s=1}this._setTitle(this.elements.realtitle,s);if(s>1){this.elements.title.setAttribute("on-singleLine","false");this.elements.subtitle.setAttribute("title-on-singleLine","false")}else{this.elements.title.setAttribute("on-singleLine","true");this.elements.subtitle.setAttribute("title-on-singleLine","true")}if(this.elements.realdescription){this.elements.container.descriptionLineNumber=p;this._setDescription(this.elements.realdescription,p)}else{if(s===3){this.elements.description.setStyle("display","none")}}},_getViewCssClassSuffix:function(){return"responsivethumbnailview"}});return g});define("DS/Controls/ThumbnailView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(b,e,a,g,f,d,i,c){var h=g.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[]},init:function(n){this._parent(n);var o=this;var l=false;var k=false;this._isHighlighted=false;this.elements.icon=new b.Element("div",{"class":"wux-controls-"+this.options.view+"-icon",styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent);this.elements.badgeTopRight=new b.Element("div",{"class":"wux-controls-thumbnail-badge-top-right"}).inject(this.elements.cartoucheContent);this.elements.badgeBottomRight=new b.Element("div",{"class":"wux-controls-thumbnail-badge-bottom-right"}).inject(this.elements.cartoucheContent);this.elements.menu.addEvent("mouseenter",function(q){l=true});this.elements.menu.addEvent("mouseleave",function(q){l=false});var j;this.elements.cartouche.addEvent("mouseenter",function(q){k=true});this.elements.cartouche.addEvent("mouseleave",function(q){k=false;o.elements.container.removeClassName("wux-ui-state-active")});this.elements.cartouche.addEvent("mousemove",function(q){clearTimeout(j);if(q.target!==o.elements.menu&&!o.elements.container.hasClassName("wux-ui-state-active")){o.elements.container.removeClassName("wux-ui-state-active")}j=setTimeout(function(){if(!l){if(k&&q.target!==o.elements.menu){o.elements.container.addClassName("wux-ui-state-active")}else{clearTimeout(j);o.elements.container.removeClassName("wux-ui-state-active")}}},20)});this.elements.checkbox=new i({checkFlag:false,disabled:false}).inject(this.elements.picture);this.elements.checkbox.getContent().addClassName("wux-controls-thumbnail-checkbox wux-ui-size-"+this.options.size);var o=this;this.elements.container.addEvent("mouseenter",function(q){if(!o.isPreHighlighted){o.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted");o.isPreHighlighted=true}});this.elements.container.addEvent("mouseleave",function(q){if(o.isPreHighlighted){o.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted");o.isPreHighlighted=false}});this.elements.checkbox.addEventListener(d.POINTERDOWN,function(q){q.stopPropagation()});this.elements.checkbox.addEventListener(d.POINTERUP,function(q){q.stopPropagation()});this._listenToChanges=true;this.elements.checkbox.addEventListener("change",function(q){if(o._listenToChanges){if(!o.isHighlighted()){o.highlight()}else{o.unhighlight()}}});if(!n||!n.gridEngine){var m=this.options.onContextualEvent;if(m){f.addEventListener(this.elements.container,{callback:function(q){return m.callback.call(m["this"],{context:q.context,infos:q.info,data:q.data,})}});var p=this.elements.menu;this.elements.menu.addEventListener(d.POINTERUP,function(r){var q=document.createEvent("HTMLEvents");q.initEvent("contextmenu",true,false);q.pageX=r.pageX;q.pageY=r.pageY;p.dispatchEvent(q)})}}this._attachEvents()},setIcon:function(j){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-"+this.options.view+"-icon");if(j){c.generateIcon(j,{target:this.elements.icon})}else{this.elements.icon.empty()}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==true){this._listenToChanges=false;this.elements.checkbox.checkFlag=true;this._listenToChanges=true}},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==false){this._listenToChanges=false;this.elements.checkbox.checkFlag=false;this._listenToChanges=true}},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}});return h});define("DS/Controls/ThumbnailCellView",["UWA/Core","DS/Controls/ThumbnailView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel","DS/Utilities/Dom"],function(c,i,a,j,e,f,g,d){function h(k){return k.charAt(0).toUpperCase()+k.slice(1)}var b=a.extend({defaultOptions:{size:"small",menu:[]},init:function(l){var n=l.menu;l.menu=[];this._CtxMenuByRightClick=true;this._parent(l);this.elements.container.setStyles({border:"none"});this.elements.container.setAttribute("draggable","true");this.elements.container.dsView=this;this._view=new i(this.options).inject(this.elements.container);this._view.elements.menu.cellView=this;var m=this;this._view.elements.checkbox.addEventListener(e.POINTERDOWN,function(o){o.stopPropagation()},true);this._view.elements.checkbox.addEventListener(e.POINTERUP,function(o){o.stopPropagation()});this._view.elements.checkbox.addEventListener("click",function(o){if(m.getGridEngine()&&m.getGridEngine()._isTouchWithatCellHover===true){m.getGridEngine()._isTouchWithatCellHover=false;o.stopPropagation();m.getGridEngine()._enableInteractiveMultiSelMode()}},true);this._view._listenToChanges=true;this._view.elements.checkbox.addEventListener("change",function(p){if(m._view._listenToChanges){var o=m.getGridEngine();var q=m.getCellInfos();if(o&&q){o._enableInteractiveMultiSelMode();if(q.cellModel.isSelected()){q.cellModel.unselect()}else{if(!o.options.selection.canMultiSelect){o.options.TreedocModel.getXSO().empty()}q.cellModel.select()}o.options.lastSelectedNode=q.cellModel}}});this.setupContextualMenu(n);var k=this.getGridEngine().options.onContextualEvent;if(k){this._view.elements.menu.addEventListener(e.POINTERUP,function(r){r.preventDefault();var t=this;var q=t.cellView;m._CtxMenuByRightClick=false;if(e.isTouchEvent(r)){if(q.getGridEngine()._preventSelectionForTouchScroll){return}}var s=q.getCellInfos();if(s){var u=s.nodeModel;if(u&&!u.isSelected()){u.select(true);q.getGridEngine().setActiveNode(u,true)}}var o=q.getGridEngine().options.onContextualEvent;if(o){var p=document.createEvent("HTMLEvents");p.initEvent("contextmenu",true,false);p.pageX=r.pageX;p.pageY=r.pageY;t.dispatchEvent(p)}m._CtxMenuByRightClick=true;r.stopPropagation()})}else{this._view.elements.menu.addEventListener(e.POINTERDOWN,function(p){var r=this;var o=r.cellView;m._CtxMenuByRightClick=false;var q=o.getCellInfos();j.show(o._view.elements.container,[p.pageX,p.pageY]);m._CtxMenuByRightClick=true;if(q.cellModel.isSelected()){p.stopPropagation()}})}},setupContextualMenu:function(p){var o=this;var l=this.getGridEngine().options.onContextualEvent;if(l){f.addEventListener(this.elements.container,{callback:function(r){if(o.getGridEngine()){o.getGridEngine()._cellCtxMenuRequired=true;if(o._CtxMenuByRightClick===true){var q=o.getCellInfos();if(q){var s=q.nodeModel;if(s&&!s.isSelected()){s.select(true);o.getGridEngine().setActiveNode(s,true)}}}}return l.callback.call(l["this"],{context:o,menuContext:r.context,infos:r.info,data:r.data,cellInfos:o.getCellInfos()})}})}else{var n=this.getGridEngine().options.onContextualMenuReady;var k=n;if(typeof n==="function"){k=function(){var q=o.getCellInfos();if(q&&o._CtxMenuByRightClick===true){var r=q.nodeModel;if(r&&!r.isSelected()){r.select(true);o.getGridEngine().setActiveNode(r,true)}}return n.call(o,q)}}var m=p?p.length:0;if(m===0){j.forget({target:this._view.elements.container,nodes:k});j.onReady({target:this._view.elements.container,nodes:k})}else{j.onReady({target:this._view.elements.container,context:this,nodes:p})}}},updateInternalParameters:function(){this.setColor();this.setTitle();this.setSubtitle();this.setDescription();this.unhighlight();this.deactivate();this.unsetBadges()},setTitle:function(k){this._view.setTitle(k);if(!this.getGridEngine()||(this.getGridEngine()&&typeof this.getGridEngine().getShouldDisplayTooltipFlag==="function"&&this.getGridEngine().getShouldDisplayTooltipFlag()===true)){this.elements.container.title=k}},setColor:function(k){this._view.setColor(k)},setIcon:function(k){this._view.setIcon(k)},setSubtitle:function(k){this._view.setSubtitle(k)},setDescription:function(k){this._view.setDescription(k)},setPicture:function(k){this._view.setPicture(k)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var k=this._parent();var l=this.getVirtualCoordinates();k.nodeModel=this.getGridEngine().getCellModel(l.virtualRowID,l.virtualColumnID);return k},setPictureBackgroundSize:function(k){if(this._view&&this._view.elements.picture){this._view.elements.picture.setStyle("background-size",k)}},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="";this._view.elements.badgeTopRight.style.visibility="hidden";this._view.elements.badgeTopRight.className="";this._view.elements.badgeTopRight.addClassName("wux-controls-thumbnail-badge-top-right");this._view.elements.badgeBottomRight.style.backgroundImage="";this._view.elements.badgeBottomRight.style.visibility="hidden";this._view.elements.badgeBottomRight.className="";this._view.elements.badgeBottomRight.addClassName("wux-controls-thumbnail-badge-bottom-right")},setBadges:function(k){for(var m in k){var l=k[m];if(l){d.generateIcon(l,{target:this._view.elements["badge"+h(m)]});this._view.elements["badge"+h(m)].style.visibility="visible"}}}});return b});define("DS/Controls/ProgressBar",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Css","DS/Core/PointerEvents"],function(c,i,f,g,a,b,e){var h="EVT_CHANGE";var d;var j=f.inherit({name:"progressBar",publishedProperties:{value:{defaultValue:0,type:"number",category:"Behavior"},shape:{defaultValue:"linear",type:"string",category:"Appearance"},emphasize:{defaultValue:"info",type:"string",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},statusFlag:{defaultValue:true,type:"boolean",category:"Behavior"},infiniteFlag:{defaultValue:false,type:"boolean",category:"Behavior"},height:{defaultValue:60,type:"number",category:"Appearance"}},_progressbarClass:"wux-controls-progressbar",buildView:function(){this.elements.container.addClassName(this._progressbarClass)},_applyShape:function(){if(this.shape==="linear"){if(this.elements.circularSubcontainer){this.elements.circularSubcontainer.destroy();this.elements.circularProgressContainer.destroy();this.elements.circularProgressStatus.destroy();delete this.elements.circularSubcontainer;delete this.elements.circularProgressContainer;delete this.elements.circularProgressStatus}this.elements.linearSubcontainer=c.Element("div",{"class":this._progressbarClass+"-linear-subcontainer"}).inject(this.elements.container);this.elements.linearProgressContainer=new c.Element("div",{"class":this._progressbarClass+"-linear-subcontainer-bar"}).inject(this.elements.linearSubcontainer);this.elements.linearProgressStatus=new c.Element("span",{"class":this._progressbarClass+"-linear-subcontainer-status"}).inject(this.elements.linearSubcontainer)}if(this.shape==="circular"){if(this.elements.linearSubcontainer){this.elements.linearSubcontainer.destroy();this.elements.linearProgressContainer.destroy();this.elements.linearProgressStatus.destroy();delete this.elements.linearSubcontainer;delete this.elements.linearProgressContainer;delete this.elements.linearProgressStatus}this.elements.circularSubcontainer=c.Element("div",{"class":this._progressbarClass+"-circular-subcontainer"}).inject(this.elements.container);this.elements.circularProgressContainer=new c.Element("canvas").inject(this.elements.circularSubcontainer);this.elements.circularProgressContainer.height=this.height;this.elements.circularProgressContainer.width=this.height;this.elements.circularProgressStatus=new c.Element("span",{"class":this._progressbarClass+"-circular-subcontainer-status"}).inject(this.elements.circularSubcontainer);this._applyHeight()}this._applyStatusFlag();this._applyValue();this._applyDisplayStyle();this._applyEmphasize();this._applyInfiniteFlag()},handleEvents:function(){var k=this;this.elements.container.addEventListener("hover",function(l){l.stopPropagation()})},_applyProperties:function(k){this._parent(k);this._applyShape();this._applyStatusFlag();this._applyValue();this._applyDisplayStyle();this._applyEmphasize();this._applyInfiniteFlag()},_applyValue:function(k){if((this.value<0)||(this.value>100)){this.value=k}else{if(this.infiniteFlag===true){this._drawProgression(30)}else{this._drawProgression(Math.round(this.value))}}this._applyStatusFlag();if(this.value!==k){this.fire("change")}},_applyStatusFlag:function(){if(this.statusFlag===false||this.displayStyle==="lite"){if(this.shape==="circular"){this.elements.circularProgressStatus.hide()}else{this.elements.linearProgressStatus.hide()}}else{if(this.shape==="circular"){this.elements.circularProgressStatus.show()}else{if(this.value===null||typeof this.value==="undefined"){this.elements.linearSubcontainer.addClassName("undefined-class")}else{this.elements.linearSubcontainer.removeClassName("undefined-class")}this.elements.linearProgressStatus.show()}}},_applyDisplayStyle:function(){if(this.shape==="linear"){if(this.displayStyle==="lite"){d="-lite"}else{d=""}this.elements.linearSubcontainer.className=this._progressbarClass+"-linear-subcontainer"+d}this._applyStatusFlag()},_applyEmphasize:function(k){if(this.shape==="linear"){var m=this.elements.linearProgressContainer;var l="wux-ui-state-";if(k){m.removeClassName(l+k)}m.addClassName(l+this.emphasize)}this._applyValue()},_getColorFromEmphasize:function(){if(this.emphasize==="info"){return"#358EC4"}else{if(this.emphasize==="success"){return"#57B847"}else{return"#EA4F37"}}},_applyInfiniteFlag:function(){if(this.infiniteFlag===true){this._drawProgression(30);if(this.shape==="circular"){this.elements.circularProgressContainer.removeClassName("wux-controls-progressbar-no-animate-infinite-circular");this.elements.circularProgressContainer.addClassName("wux-controls-progressbar-animate-infinite-circular")}else{if(this.shape==="linear"){this.elements.linearProgressContainer.addClassName("wux-controls-progressbar-animate-infinite-linear")}}}else{if(this.shape==="circular"){this.elements.circularProgressContainer.removeClassName("wux-controls-progressbar-animate-infinite-circular");this.elements.circularProgressContainer.addClassName("wux-controls-progressbar-no-animate-infinite-circular");this._drawProgression(this.value)}else{if(this.shape==="linear"){this.elements.linearProgressContainer.removeClassName("wux-controls-progressbar-animate-infinite-linear");this._applyValue()}}}},_applyHeight:function(){if(typeof this.height!=="undefined"){if(this.shape==="circular"){this.elements.circularSubcontainer.setStyle("height",this.height+"px");this.elements.circularSubcontainer.setStyle("width",this.height+"px");this.elements.circularProgressStatus.setStyle("height",this.height+"px");this.elements.circularProgressStatus.setStyle("line-height",this.height+"px");this.elements.circularProgressStatus.setStyle("width",this.height+"px");this.elements.circularProgressContainer.height=this.height;this.elements.circularProgressContainer.width=this.height;this._drawCircularProgression(this.value);this._applyValue()}}},_updateLabel:function(){var k=(this.value!==null&&typeof this.value!=="undefined")?Math.round(this.value)+"%":"";if(this.shape==="circular"){this.elements.circularProgressStatus.innerText=k}else{this.elements.linearProgressStatus.innerText=k}},_drawCircularProgression:function(l){if(this.elements.circularProgressContainer.getContext){var k=this.elements.circularProgressContainer.getContext("2d");var m=Math.PI/50*l-Math.PI/2;k.clearRect(0,0,this.height,this.height);k.beginPath();if(this.height<=24){k.lineWidth=3}else{if(this.height<=40){k.lineWidth=4}else{k.lineWidth=5}}k.strokeStyle="#E2E4E3";k.beginPath();k.arc(this.height/2,this.height/2,(this.height/2)-2,0,Math.PI*2,true);k.stroke();k.closePath();k.strokeStyle=this._getColorFromEmphasize();k.beginPath();k.arc(this.height/2,this.height/2,(this.height/2)-2,-Math.PI/2,m,false);k.stroke();k.closePath()}},_drawProgression:function(k){if(this.shape==="circular"){this._drawCircularProgression(k)}else{if(k>100){k=100}if(k<0){k=0}if(this.elements.linearProgressContainer){this.elements.linearProgressContainer.style.width=k+"%";if(k===100){if(this.displayStyle==="normal"){this.elements.linearProgressStatus.setStyle("color","white")}}else{this.elements.linearProgressStatus.setStyle("color","black")}}}this._updateLabel()}});return j});define("DS/Controls/Loader",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","i18n!DS/Controls/assets/nls/translation","DS/Controls/ProgressBar","DS/Controls/Button","DS/Utilities/Utils"],function(e,j,f,h,c,l,k,g,i){var b=f.inherit({name:"loader",publishedProperties:{fadeDuration:{defaultValue:1000,type:"number",category:"Appearance"},text:{defaultValue:"",type:"string",category:"Appearance"},showButtonFlag:{defaultValue:false,type:"boolean",category:"Appearance"},height:{defaultValue:60,type:"number",category:"Appearance"},allowUnsafeHTMLText:{defaultValue:undefined,type:"boolean",category:"Behavior"}},_loaderClass:"wux-controls-loader",buildView:function(){this._modelEvents=new c();this.elements.container.addClassName(this._loaderClass+" wux-font-3dsregular");this.elements.progressBar=new k({shape:"circular",infiniteFlag:true,statusFlag:false}).inject(this.elements.container);this.elements.label=e.Element("span",{"class":this._loaderClass+"-label"}).inject(this.elements.container);this.elements.stopButton=new g({label:l.cancel,emphasize:"primary"}).inject(this.elements.container);this.hide();this._loaderCounter=0;this._loaderMessages=[]},handleEvents:function(){var m=this;this.elements.stopButton.addEventListener("buttonclick",function(n){d.call(m);this._loaderCounter=0})},_applyRecId:function(m){this.elements.stopButton.recId=this.recId},_applyHeight:function(m){this.elements.progressBar.height=this.height;if(m!==this.height){this.fire("dimensionsChanged")}},_applyProperties:function(m){this._parent(m);if(this.isDirty("allowUnsafeHTMLText")||this.isDirty("text")){this._applyText(m.text)}this._applyShowButtonFlag()},process:function(){a.call(this)},on:function(m){this._loaderCounter++;if(m){this._loaderMessages.push(m);this.text=m}if(this._loaderCounter===1){a.call(this)}this.elements.container.show()},update:function(m){if(m){m=m.replace("%","");this.elements.progressBar.value=m;this.elements.progressBar.statusFlag=true}else{this.elements.progressBar.value=this.elements.progressBar.publishedProperties.value.defaultValue;this.elements.progressBar.statusFlag=false}},off:function(m){if(this._loaderCounter<=0){return}this._loaderCounter--;if(m){var n=this._loaderMessages.indexOf(m);if(n!==-1){this._loaderMessages.splice(n,1);if(this._loaderMessages.length>0){this.text=this._loaderMessages[this._loaderMessages.length-1]}else{this.text=""}}}if(this._loaderCounter===0){d.call(this);if(this._loaderMessages.length>0){this._loaderMessages=[]}}},_applyText:function(){if(i.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLText)){this.elements.label.setContent(this.text)}else{this.elements.label.textContent=this.text}},_applyAllowUnsafeHTMLText:function(){this._applyText(this.text)},_applyShowButtonFlag:function(){if(this.showButtonFlag){this.elements.stopButton.show()}else{this.elements.stopButton.hide()}}});var d=function(){var n=this;n.hide();var m=new e.Fx(n.elements.container,{duration:n.fadeDuration,transition:"linear",events:{onStart:function(){},onComplete:function(){if(n.showButtonFlag){n.elements.stopButton.remove()}n._modelEvents.publish({event:"END",context:n})}}});m.start({opacity:[1,0]});n._loaderCounter=0};var a=function(){var n=this;n.show();var m=new e.Fx(n.elements.container,{duration:n.fadeDuration,transition:"linear",events:{onStart:function(){if(n.showButtonFlag){n.elements.stopButton.inject(n.elements.container)}},onComplete:function(){n._modelEvents.publish({event:"START",context:n})}}});m.start({opacity:[0,1]})};return b});define("DS/Controls/TimeChooser",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom"],function(g,b,i,h,l,c,a){function f(m){if(Object.prototype.toString.call(m)!=="[object Date]"){return false}return !isNaN(m.getTime())}function e(){var m=this;this._arrowsInfo=[{name:"hoursUp",container:this.elements.topRow,onClick:function(n){m._setHours(m.value.getHours()+m.hoursStep,"clickOnHoursUp")},upFlag:true},{name:"minutesUp",container:this.elements.topRow,onClick:function(n){m._setMinutes(m.value.getMinutes()+m.minutesStep,"clickOnMinutesUp")},upFlag:true},{name:"secondsUp",container:this.elements.topRow,onClick:function(n){m._setSeconds(m.value.getSeconds()+m.secondsStep,"clickOnSecondsUp")},upFlag:true,secondsFlag:true},{name:"amPmUp",container:this.elements.topRow,onClick:function(n){m._setHours(m.value.getHours()+12,"clickOnAmPmUp")},upFlag:true,amPmFlag:true},{name:"hoursDown",container:this.elements.bottomRow,onClick:function(n){m._setHours(m.value.getHours()-m.hoursStep,"clickOnHoursDown")},upFlag:false},{name:"minutesDown",container:this.elements.bottomRow,onClick:function(n){m._setMinutes(m.value.getMinutes()-m.minutesStep,"clickOnMinutesDown")},upFlag:false},{name:"secondsDown",container:this.elements.bottomRow,onClick:function(n){m._setSeconds(m.value.getSeconds()-m.secondsStep,"clickOnSecondsDown")},upFlag:false,secondsFlag:true},{name:"amPmDown",container:this.elements.bottomRow,onClick:function(n){m._setHours(m.value.getHours()-12,"clickOnAmPmDown")},upFlag:false,amPmFlag:true}];this._arrowsDiv=[];this._arrowsInfo.forEach(function(p){var o="wux-controls-timechooser-arrow wux-ui-3ds";if(p.secondsFlag){o+=" wux-controls-timechooser-seconds"}else{if(p.amPmFlag){o+="  wux-controls-timechooser-ampm"}}if(p.upFlag){o+=" wux-ui-3ds-expand-up"}else{o+=" wux-ui-3ds-expand-down"}var n=new g.Element("button",{"class":o});m._arrowsDiv.push(n);n.inject(p.container)})}function k(){var m=this;this._inputsInfo=[{name:"hours",minValue:0,maxValue:23,onChange:function(n){m._setHours(n,"input_hours")}},{name:"minutes",minValue:0,maxValue:59,onChange:function(n){m._setMinutes(n,"input_minutes")}},{name:"seconds",minValue:0,maxValue:59,onChange:function(n){m._setSeconds(n,"input_seconds")},secondsFlag:true}];this._inputsDiv=[];this._inputsInfo.forEach(function(o){var n="wux-controls-timechooser-input";if(o.secondsFlag){n+=" wux-controls-timechooser-seconds"}m._inputsDiv.push(new g.Element("input",{"class":n}))});this._inputsDiv[0].inject(this.elements.inputsRow);this._inputsDiv[1].inject(this.elements.inputsRow);this._inputsDiv[2].inject(this.elements.inputsRow);this._amPmDiv=new g.Element("div",{html:"AM","class":"wux-controls-timechooser-ampm"}).inject(this.elements.inputsRow)}function d(){if(this.value){var n=this.value.getHours();if(this.mode==="12"){if(n>=12){if(n>=13){this._inputsDiv[0].value=n-12}else{this._inputsDiv[0].value=n}this._amPmDiv.textContent="PM"}else{if(n===0){this._inputsDiv[0].value=12}else{this._inputsDiv[0].value=n}this._amPmDiv.textContent="AM"}}else{this._inputsDiv[0].value=n}var m=this.value.getMinutes(),o=this.value.getSeconds();this._inputsDiv[1].value=(m<10?"0":"")+m;this._inputsDiv[2].value=(o<10?"0":"")+o}else{this._inputsDiv[0].value="";this._inputsDiv[1].value="";this._inputsDiv[2].value=""}}var j=i.inherit({name:"timeChooser",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:true,category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-timechooser");this.elements.container.setAttribute("tabindex",0);this.elements.topRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-top-row"}).inject(this.elements.container);this.elements.inputsRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-inputs-row"}).inject(this.elements.container);k.call(this);this.elements.bottomRow=new g.Element("div",{"class":"wux-controls-timechooser-row wux-controls-timechooser-bottom-row"}).inject(this.elements.container);e.call(this);this.value=new Date()},handleEvents:function(){var m=this;this._arrowsDiv.forEach(function(o,n){a.addEventOnElement(m,o,"click",function(p){m._arrowsInfo[n].onClick.call(m)});a.addEventOnElement(m,o,"focus",function(p){this.blur();m.elements.container.focus()})});this._inputsDiv.forEach(function(n,o){a.addEventOnElement(m,n,"change",function(r){var p=parseInt(this.value);var q=m._inputsInfo[o];if((p>=q.minValue)&&(p<=q.maxValue)){q.onChange.call(m,p)}else{d.call(m)}})})},_applyMode:function(m){if(this.mode==="24"){this.getContent().setAttribute("mode","24")}else{this.getContent().setAttribute("mode","12")}d.call(this)},_preEditValue:function(m,n){if(!n){return true}if(typeof n==="string"){this.value=new Date(Date.parse(n));return false}else{if(n instanceof Date){if(g.equals(m,n)){return false}if(!f.call(this,n)){return false}return true}}return false},_applyValue:function(m){d.call(this);this.fire("change")},_applyPrecision:function(m){if(this.precision==="min"){this.getContent().setAttribute("precision","min")}else{this.getContent().setAttribute("precision","sec")}},_applyDisabled:function(m){this._parent();if(this.disabled){this._arrowsDiv.forEach(function(n){n.setAttributeNode(document.createAttribute("disabled"))});this._inputsDiv.forEach(function(n){n.setAttributeNode(document.createAttribute("disabled"))})}else{this._arrowsDiv.forEach(function(n){n.removeAttribute("disabled")});this._inputsDiv.forEach(function(n){n.removeAttribute("disabled")})}},setHours:function(m){this._setHours(m)},_setHours:function(m){if(this.value){var n=new Date(this.value);n.setHours(m);this.setPropertyFromUIInteraction("value",n)}},setMinutes:function(m){this._setMinutes(m)},_setMinutes:function(m){if(this.value){var n=new Date(this.value);n.setMinutes(m);this.setPropertyFromUIInteraction("value",n)}},setSeconds:function(m){this._setSeconds(m)},_setSeconds:function(m){if(this.value){var n=new Date(this.value);n.setSeconds(m);this.setPropertyFromUIInteraction("value",n)}},incrementAmPm:function(){this.setHours(this.value.getHours()+12)},decrementAmPm:function(){this.setHours(this.value.getHours()-12)},incrementHours:function(){this.setHours(this.value.getHours()+this.hoursStep)},decrementHours:function(){this.setHours(this.value.getHours()-this.hoursStep)},incrementMinutes:function(){this.setMinutes(this.value.getMinutes()+this.minutesStep)},decrementMinutes:function(){this.setMinutes(this.value.getMinutes()-this.minutesStep)},incrementSeconds:function(){this.setSeconds(this.value.getSeconds()+this.secondsStep)},decrementSeconds:function(){this.setSeconds(this.value.getSeconds()-this.secondsStep)},_applyProperties:function(m){this._parent(m);if(this.isDirty("mode")){this._applyMode(m.mode)}if(this.isDirty("value")){this._applyValue(m.value)}if(this.isDirty("precision")){this._applyPrecision(m.precision)}}});c.register(j,"DS/ControlsRec/AbstractRec");return j});define("DS/Controls/ButtonGroup",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter"],function(d,f,a,j,g,m,b){function e(t){if(t.target===this.elements.container){return}t.stopPropagation();var n=t.dsModel;var r=this._getButtonList();r.forEach(function(u){u.preventTriggeringChangeEvent=true});if(n){if(l.call(this,n)){if(this.multiSelFlag){if(n.isMultiSelection===true&&this.type==="radio"){this.type="checkbox"}if(n.isMultiSelection===false&&this.type==="checkbox"){this.type="radio";var s=this._getButtonList();for(var q=0;q<s.length;q++){var p=s[q];if(n===p){p.checkFlag=true}else{p.checkFlag=false}}}}if(this.type==="radio"&&!n.isMultiSelection){if(n.checkFlag===true){this.preventTriggeringChangeEvent=true;this.value=[n.value];this.preventTriggeringChangeEvent=false}}else{if(this.type==="checkbox"||n.isMultiSelection){var o=(this.value)?this.value.slice(0):[];this.preventTriggeringChangeEvent=true;if(n.checkFlag===true){if(this.value.indexOf(n.value)===-1){o.push(n.value);this.value=o}}else{if(!n.isMultiSelection||this.value.indexOf(n.value)!==-1&&this.value.length>1){o.splice(this.value.indexOf(n.value),1);this.value=o}else{if(n.isMultiSelection&&this.value.indexOf(n.value)!==-1&&this.value.length===1){n.checkFlag=true}}}this.preventTriggeringChangeEvent=false}}}}r=this._getButtonList();r.forEach(function(u){u.preventTriggeringChangeEvent=false});if(!this.preventTriggeringChangeEvent){this.fire("change")}}var i=f.inherit({name:"buttonGroup",markForRecordFlag:true,publishedProperties:{value:{defaultValue:undefined,type:"array",category:"Behavior",recordFlag:true},type:{defaultValue:"radio",type:"string",category:"Behavior"},minButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},_preBuildView:function(){this.elements.container=d.Element("div",{"class":"wux-controls-buttongroup"});this._parent()},buildView:function(){this._bindedButtonChangeCB=e.bind(this)},_applyRecId:function(n){if(this.recId!==null&&this.recId!==undefined){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].redId=this.recId+p[o].value}}else{if(n!==null&&n!==undefined){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].redId=null}}}},_applyMultiSelFlag:function(n){var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].multiSelFlag=this.multiSelFlag}if(this.multiSelFlag===false&&n===true){this.type="radio";for(var o=0;o<p.length;o++){var q=p[o];q.type="radio";q.checkFlag=false}}},_applyType:function(n){var p=this._getButtonList();if(this.type==="radio"){for(var o=0;o<p.length;o++){p[o].type="radio"}}else{if(this.type==="checkbox"){for(var o=0;o<p.length;o++){if(p[o] instanceof g){p[o].type="check"}else{if(p[o] instanceof j){p[o].type="checkbox"}}}}}},_updateChildPropertiesAndListeners:function(u,n){if(u.value===undefined){if(n!==undefined){u.value=n}else{var t=this.getButtonCount();u.value=t}}var r=true;while(r){r=false;var s=this._getButtonList();for(var p=0;p<s.length;p++){var o=s[p];if(o.value===u.value&&o!==u&&((u instanceof g===o instanceof g)||(u instanceof j===o instanceof j))){u.value=u.value+1;r=true;break}}}u.disabled=this.disabled;u.touchMode=this.touchMode;if(u.checkFlag){if(this.type==="radio"){this.value=[u.value];u._uncheckSiblings()}else{var q=this.value.slice();q.push(u.value);this.value=q}}a.addEventOnElement(this,u.getContent(),"change",this._bindedButtonChangeCB)},addChild:function(o,n){if(!o.recId&&this.recId!==null&&this.recId!==undefined){o.recId=this.recId+o.value}this._updateChildPropertiesAndListeners(o,n);this._addChildToUI(o,n)},_addChildToUI:function(p,n){if(n===undefined||n>=this.elements.container.childNodes.length){p.inject(this.elements.container)}else{var o=this.elements.container.getChildren()[n];p.inject(o,"before")}},moveButton:function(p,o){var n=this.getButton(p);if(n){this.preventTriggeringChangeEvent=true;this.removeChild(n);this.addChild(n,o);this.preventTriggeringChangeEvent=false}},_getButtonList:function(){var n=this.elements.container.childNodes;var p=[];for(var o=0;o<n.length;o++){var q=n[o];if(q.dsModel&&(q.dsModel instanceof g||q.dsModel instanceof j)){p.push(q.dsModel)}}return p},getButtonCount:function(){return this._getButtonList().length},getButtonIndex:function(o){var n=this._getButtonList();return n.indexOf(o)},getButton:function(n){var o=this._getButtonList();return o[n]},getButtonFromValue:function(p){for(var o=0;o<this.elements.container.childNodes.length;o++){var n=this.elements.container.childNodes[o].dsModel;if(typeof n.value!=="undefined"&&n.value!==null&&p!==null){if(n.value===p){return n}}}return undefined},removeChild:function(o){if(o){o.remove();a.removeEventOnElement(this,o.getContent(),"change",this._bindedButtonChangeCB);if(this.value&&this.value.length>0){var n=this.value.indexOf(o.value);if(n!==-1){var p=this.value.slice();p.splice(n,1);this.value=p}}}},selectIndex:function(n){var o=this.getButton(n);if(!o){return}if(this.type==="radio"){this.value=[o.value]}else{var p=this.value.slice();p.push(o.value);this.value=p}o.getContent().focus()},_isButtonValueInButtonGroup:function(q){var p=this._getButtonList();for(var o=0;o<p.length;o++){var n=p[o];if(n.value===q){return true}}return false},selectValue:function(o){if(this._isButtonValueInButtonGroup(o)){if(this.type==="radio"){this.value=[o]}else{var n=this.value.slice();n.push(o);this.value=n}}},selectNext:function(){h.call(this,false)},selectPrevious:function(){h.call(this,true)},_applyProperties:function(n){this._parent(n);if(this.isDirty("value")){this._applyValue()}if(this.value===undefined){this.value=[]}if(this.isDirty("touchMode")){this._applyTouchMode()}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag(n.multiSelFlag)}},_applyMaxWidth:function(){if(this.maxWidth!==-1){this.elements.container.setStyle("max-width",this.maxWidth+"px");this.elements.container.setStyle("overflow","hidden")}else{this.elements.container.setStyle("max-width","");this.elements.container.setStyle("overflow","")}},_applyDisabled:function(){var o=this.disabled;if(o){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}var p=this._getButtonList();for(var n=0;n<p.length;n++){p[n].disabled=o}},_applyValue:function(n){var p=this._getButtonList();p.forEach(function(r){r.preventTriggeringChangeEvent=true});var o=c.call(this,this.value);if(o.length>1&&this.multiSelFlag){this.isMultiSelection=true;p.forEach(function(r){r.isMultiSelection=true;r.checkFlag=false});o.forEach(function(r){if(r instanceof g){r.type="check"}else{if(r instanceof j){r.type="checkbox"}}r.checkFlag=true});this.isMultiSelection=false;p.forEach(function(r){r.isMultiSelection=false})}else{var q=c.call(this,n);q.forEach(function(r){r.checkFlag=false});if(o.length>0){o.forEach(function(r){r.checkFlag=true})}}p.forEach(function(r){r.preventTriggeringChangeEvent=false});if(!this.preventTriggeringChangeEvent){this.fire("change")}},_applyPreferredButtonWidth:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){if(o[n] instanceof g){o[n].preferredWidth=this.preferredButtonWidth}}},_applyMinButtonWidth:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){if(o[n] instanceof g){o[n].minWidth=this.minButtonWidth}}},_applyTouchMode:function(){var n=this._getCurrentTouchMode();if(n===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}var p=this._getButtonList();for(var o=0;o<p.length;o++){p[o].touchMode=n}},_hasOverflow:function(){var p=this;var n=p.getContent().scrollWidth;var o=p.getContent().offsetWidth;if(n>o){return true}return false},handleEvents:function(){var n=this;a.addEventOnElement(this,this.elements.container,"keydown",function(p){if(n.disabled){return}var o=false;if(m.previous(p.keyCode)){n.callMethodFromUIInteraction("selectPrevious");o=true}if(m.next(p.keyCode)){n.callMethodFromUIInteraction("selectNext");o=true}if(m.PAGEUP==p.keyCode){n.callMethodFromUIInteraction("selectIndex",0);o=true}if(m.PAGEDOWN==p.keyCode){n.callMethodFromUIInteraction("selectIndex",n.getButtonCount()-1);o=true}if(o){p.preventDefault();p.stopPropagation()}});a.addEventOnElement(this,document,"keydown",function(q){if(q.keyCode===m.CTRL&&!n.isMultiSelection){if(n.multiSelFlag){n.isMultiSelection=true;var p=n._getButtonList();for(var o=0;o<p.length;o++){p[o].isMultiSelection=n.isMultiSelection}}}});a.addEventOnElement(this,document,"keyup",function(q){if(q.keyCode===m.CTRL&&n.isMultiSelection){if(n.multiSelFlag){n.isMultiSelection=false;var p=n._getButtonList();for(var o=0;o<p.length;o++){p[o].isMultiSelection=n.isMultiSelection}}}})},destroy:function(){var o=this._getButtonList();for(var n=0;n<o.length;n++){o[n].destroy()}o=null;this._parent()}});function k(){for(var o=0;o<this.elements.container.childNodes.length;o++){var n=this.elements.container.childNodes[o];if(n===document.activeElement){return n.dsModel}}return null}function c(n){var r=[];for(var q=0;q<this.elements.container.childNodes.length;q++){var p=this.elements.container.childNodes[q];var o=p.dsModel;if(typeof o.value!=="undefined"&&o.value!==null&&typeof n!=="undefined"&&n!==null){if(n.indexOf(o.value)!==-1){r.push(o)}}}return r}function h(o){var p=k.call(this);var q;var r=(o?"previous":"next")+"Sibling";if(p){q=p.getContent()[r];if(q){var n=q.dsModel;if(n&&n.visibleFlag&&l.call(this,n)){if(this.type==="radio"){this.value=[n.value]}}q.focus()}}}function l(n){if((n instanceof j||n instanceof g)){return true}else{return false}}return i});define("DS/Controls/Knob",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Scroller","DS/Utilities/Css3D","DS/Controls/Stack","DS/Controls/Gauge","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],function(d,l,g,i,c,j,k,a,e,b){var h="change";var f=g.extend({defaultOptions:{snap:0,value:0,stepValue:1,minValue:0,maxValue:360,graduations:12,graduationsLabel:false,dynamicGraduations:false,activeGraduationsColor:"#00FFF5",inactiveGraduationsColor:"#FF0000",graduationsLabelColor:"black",knobIndicator:"dot",knobMaterial:"pearl",turn:null,onChange:null,interactionMode:"rotate",theme:{display:"inline-block",fontSize:10,size:80}},init:function(m){this._parent(m);this._modelEvents=new b();this.startDeg=0;this.currentDeg=0;this.rotation=0;this.lastDeg=0;this._value=this.options.value;this._delta=this.options.maxValue-this.options.minValue;this._knobSize=parseInt(this.options.theme.size*0.75,10);this._graduationSize={width:parseInt((this.options.theme.size-this._knobSize)/2,10),height:parseInt((this.options.theme.size-this._knobSize)/5,10)};this._buildSkeleton();this._buildScaling();this._attachBehaviors();this._rotateKnob(this._valueToDeg(this.options.value))},_valueToDeg:function(m){return(m-this.options.minValue)/this._delta*360},_degToValue:function(m){var n=((m/360)*this._delta+this.options.minValue);return n},_buildScaling:function(){var C=180/Math.PI;var n=0;var u=this.options.graduations;var m=d.typeOf(u);var p;if(m==="array"){p=u.length}else{p=u}for(var r=0;r<p;r++){var v;var A;if(this.options.dynamicGraduations){var y=(120-r*120/p);A="hsl("+y+", 100%, 50%)";v=0}else{A=this.options.inactiveGraduationsColor;v=1}if(m==="array"){n=this._valueToDeg(u[r].value)}else{n=r*(360/p)}var x=parseInt(this._graduationSize.height/4,10);if(this.options.dynamicGraduations){x=0}var o=new d.Element("div",{"class":"wux-knob-scale",styles:{boxShadow:"inset 0 0 "+x+"px black",borderRadius:x,opacity:v}});var w=new d.Element("div",{styles:{position:"relative"}}).inject(o);if(this.options.graduationsLabel){var z;if(m==="array"){z=u[r].label}else{z=this._degToValue(parseFloat(n))}var t;if(m==="array"){switch(r){case 0:t=-parseInt(1.5*this.options.theme.fontSize,10);break;case p-1:t=0;break;default:t=-parseInt(this.options.theme.fontSize/2,10);break}}else{t=-parseInt(this.options.theme.fontSize/2,10)}var B=new d.Element("div",{"class":"wux-knob-scale-label",styles:{position:"absolute",transform:"rotate("+-n+"deg)",top:t,fontSize:this.options.theme.fontSize,whiteSpace:"nowrap",color:this.options.graduationsLabelColor},html:z.toString()});B.inject(w)}var s=-Math.sin(n/C)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size)/2-this._graduationSize.height/2+this.options.theme.fontSize;var q=Math.cos((180-n)/C)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size-this._graduationSize.width)/2+this.options.theme.fontSize;o.setStyles({backgroundColor:A,transform:"rotate("+n+"deg)",top:parseInt(s,10),left:parseInt(q,10),width:this._graduationSize.width,height:this._graduationSize.height}).inject(this.elements.container)}},turn:function(o){var p=this;var q=this.elements.container.getElements(".wux-knob-scale");var n=0,m=-1;n=Math.ceil(q.length*o);if(n===m){return false}m=n;q.forEach(function(w,v){var z={};var x=function(){w.addClassName("active");if(!p.options.dynamicGraduations){z.backgroundColor=p.options.activeGraduationsColor}else{z.opacity=1}w.setStyles(z)};var t=function(){w.removeClassName("active");if(!p.options.dynamicGraduations){z.opacity=1;z.backgroundColor=p.options.inactiveGraduationsColor}else{z.opacity=0}w.setStyles(z)};var s=o*p._delta+p.options.minValue;var y=p._degToValue(s);var u=p.options.graduations;var r=d.typeOf(u);if(r==="array"){if(u[v].value<=y){x()}else{t()}}else{if(v<n){x()}else{t()}}})},_buildSkeleton:function(){this.elements.container=d.Element("div",{styles:{position:"relative",height:(this.options.theme.size+2*this.options.theme.fontSize),width:(this.options.theme.size+2*this.options.theme.fontSize),display:this.options.theme.display}});this.elements.control=d.Element("div",{"class":"wux-knob-control wux-ui-material-"+this.options.knobMaterial,styles:{position:"absolute",top:"50%",left:"50%",marginTop:-this._knobSize/2,marginLeft:-this._knobSize/2}}).inject(this.elements.container);var m="";if(this.options.theme.size>50){m=" wux-ui-size-big"}this.elements.knob=d.Element("div",{"class":"wux-knob wux-ui-indicator-"+this.options.knobIndicator+" wux-ui-material-"+this.options.knobMaterial+m,styles:{height:this._knobSize,width:this._knobSize,borderRadius:"100%"}}).inject(this.elements.control);this.elements.knobTop=d.Element("div",{"class":"wux-knob-top"});this.elements.knobBottom=d.Element("div",{"class":"wux-knob-bottom"})},_attachBehaviors:function(){var o=this;var n=this.elements.container;var m=this.elements.knob;n.addEvent(e.POINTERDOWN,function(w){w.preventDefault();var t=m.getDimensions();var v=m.getOffsets();var q={y:v.y+t.height/2,x:v.x+t.width/2};var z,y,r,C=180/Math.PI;var A=d.extendElement(document);if(o.options.interactionMode==="vertical-slide"){var s;var p=200;var x=50;var u=1;var B=5;s=window.setInterval(function(){var D=Math.abs(z);if(D<p){u=Math.min(parseInt((D/p)*B,10),B)}else{u=B}if(z>0){o.increment(u)}if(z<0){o.decrement(u)}},x)}A.addEvent(e.POINTERMOVE,function(D){z=q.y-D.pageY;if(o.options.interactionMode==="rotate"){y=q.x-D.pageX;r=Math.atan2(z,y)*C;o._rotateKnob(r)}});A.addEvent(e.POINTERUP,function(){window.clearInterval(s);A.removeEvent(e.POINTERMOVE);A.removeEvent(e.POINTERUP);o.rotation=o.currentDeg;o.startDeg=-1})});d.Element.addEvent.call(o.elements.container,"mousewheel",function(q){var r=d.Event.wheelDelta(q);var p=q.shiftKey;if(p){r*=5}o.currentDeg+=r;o._rotateKnob(o.currentDeg)})},increment:function(n){var m=this.getValue()+n*this.options.stepValue;console.log("increment",this,this.getValue(),m,n);this.setValue(m)},decrement:function(n){var m=this.getValue()-n*this.options.stepValue;console.log("decrement",this,this.getValue(),m,n);this.setValue(m)},getValue:function(){return this._value},_rotateKnob:function(n){if(n<0){n=360+n}if(this.startDeg===-1){this.startDeg=n}var m=Math.floor((n-this.startDeg)+this.rotation);if(m<0){m=360+m}else{if(m>359){m=m%360}}if(this.options.snap&&m<this.options.snap){m=0}if(Math.abs(m-this.lastDeg)>180){return false}this.currentDeg=m;this.lastDeg=m;this.setValue(this._degToValue(this.currentDeg))},setValue:function(o,n){if(n===undefined){n=true}var m=this.elements.knob;this._value=o;this.currentDeg=this._valueToDeg(o);m.setStyle("transform","rotate("+this.currentDeg+"deg)");if(!this.options.turn){this.options.turn=this.turn}this.options.turn.call(this,this.currentDeg/360);if(n){if(this.options.onChange){this.options.onChange.call(this,this.getValue())}this._modelEvents.publish({context:this,event:h,data:this})}},addEvent:function(m,n){return this._subscribe(m,n)},_removeEvent:function(m){return this._modelEvents.unsubscribe(m)},_removeEventListener:function(m){return this._modelEvents.unsubscribe(m)},addEventOnce:function(m,n){return this._modelEvents.subscribeOnce({event:m},n)},addEventListener:function(m,n){return this._subscribe(m,n)},_subscribe:function(m,n){return this._modelEvents.subscribe({event:m},n)}});return d.namespace("WUX/Controls/Knob",f)});define("DS/Controls/TimePicker",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Core/Core","DS/Core/PointerEvents","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/Popup","DS/Controls/TimeChooser","DS/WebRecordEnabler/Adapter"],function(g,a,j,k,h,c,m,e,o,d){function f(p){if(Object.prototype.toString.call(p)!=="[object Date]"){return false}return !isNaN(p.getTime())}function b(r,q){if(!f.call(this,r)||!f.call(this,q)){return false}var p={hour:"2-digit",minute:"2-digit"};if(this.precision==="sec"){p.second="2-digit"}return r.toLocaleTimeString("en",p)===q.toLocaleTimeString("en",p)}function l(){if(this.value){var q={hour:"2-digit",minute:"2-digit"};if(this.precision==="sec"){q.second="2-digit"}var p="";if(this.mode==="12"){p="en-US"}else{if(this.mode==="24"){p="en-GB"}}if(p&&this.value.toLocaleTimeString){this.elements.inputField.value=this.value.toLocaleTimeString(p,q)}}else{this.elements.inputField.value=""}}var n=j.inherit({name:"timePicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"24",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",category:"Behavior"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true}},buildView:function(){this._parent();this.elements.container.addClassName("wux-controls-timepicker");this.elements.inputField=new c({sizeInCharNumber:20,selectAllOnFocus:true}).inject(this.elements.container);this.elements.inputField.getContent().addClassName("wux-controls-timepicker-lineeditor");this.elements.timeChooserButton=new m({emphasize:"primary",icon:{iconName:"clock",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container);this.elements.timeChooserButton.getContent().addClassName("wux-controls-timepicker-button");i.call(this);this.value=new Date();this._onShowPopupValue=new Date()},handleEvents:function(){var p=this;a.addEventOnElement(this,this.elements.inputField,"change",function(r){r.stopPropagation();if(r.dsModel){if(r.dsModel.value){var q=new Date("2016/07/13 "+r.dsModel.value);if(q&&!isNaN(q.getTime())&&!b.call(p,q,p.value)){p.setPropertyFromUIInteraction("value",q)}l.call(p)}}})},getHours:function(){return this.value.getHours()},getMinutes:function(){return this.value.getMinutes()},_preEditValue:function(p,q){if(!q){return true}if(typeof q==="string"){this.value=new Date(Date.parse(q));return false}else{if(q instanceof Date){if(g.equals(p,q)){return false}return true}}},_applyValue:function(p){l.call(this);if(this.elements.popup&&this.elements.popup.visibleFlag){if(!b.call(this,this.elements.timeChooser.value,this.value)){this.elements.timeChooser.value=new Date(this.value)}this.fire("liveChange")}else{this.fire("change")}},_applyPrecision:function(p){if(this.precision!=="min"&&this.precision!=="sec"){this.precision=p;return}l.call(this);if(this.elements.timeChooser){this.elements.timeChooser.precision=this.precision}},_applyMode:function(p){l.call(this);if(this.elements.timeChooser){this.elements.timeChooser.mode=this.mode}},_applyHoursStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.hoursStep=this.hoursStep}},_applyMinutesStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.minutesStep=this.minutesStep}},_applySecondsStep:function(p){if(this.elements.timeChooser){this.elements.timeChooser.secondsStep=this.secondsStep}},_applyDisabled:function(p){this._parent();this.elements.inputField.disabled=this.disabled;this.elements.timeChooserButton.disabled=this.disabled},_applyPopupVisibleFlag:function(p){if(this.popupVisibleFlag){this.elements.popup.visibleFlag=true}else{this.elements.popup.visibleFlag=false}},_applyTouchMode:function(){this._parent();if(this.elements.timeChooserButton){this.elements.timeChooserButton.touchMode=this.touchMode}if(this.elements.inputField){this.elements.inputField.touchMode=this.touchMode}},_applyProperties:function(p){this._parent(p);if(this.isDirty("hoursStep")){this._applyHoursStep(p.hoursStep)}if(this.isDirty("minutesStep")){this._applyMinutesStep(p.minutesStep)}if(this.isDirty("secondsStep")){this._applySecondsStep(p.secondsStep)}if(this.isDirty("mode")){this._applyMode(p.mode)}if(this.isDirty("precision")){this._applyPrecision(p.precision)}if(this.isDirty("value")){this._applyValue(p.value)}}});function i(){var p=this;var q={target:this.elements.timeChooserButton.getContent(),position:"bottom",trigger:"click",constraint:"screen"};q.offset={x:-115,y:4};this.elements.popup=new e(q);this.elements.popup.addEventListener("hide",function(r){p.popupVisibleFlag=false;if(p.value&&!b.call(p,p.value,p._onShowPopupValue)){p.fire("change")}r.stopPropagation();p.fire("hide")});this.elements.popup.addEventListener("show",function(r){p.popupVisibleFlag=true;if(!p.elements.popup.getBody()){p.elements.timeChooser=new o({value:p.value,hoursStep:p.hoursStep,minutesStep:p.minutesStep,secondsStep:p.secondsStep,mode:p.mode,precision:p.precision});p.elements.timeChooser.addEventListener("change",function(s){s.stopPropagation();if(s.dsModel&&s.dsModel.value){if(!b.call(p,p.value,p.elements.timeChooser.value)){p.value=new Date(s.dsModel.value)}l.call(p)}});p.elements.popup.setBody(p.elements.timeChooser)}p._onShowPopupValue=new Date(p.value);if(p.value&&!b.call(p,p.value,p.elements.timeChooser.value)){p.elements.timeChooser.value=new Date(p.value)}r.stopPropagation();p.fire("show")})}d.register(n,"DS/ControlsRec/AbstractRec");return n});define("DS/Controls/GradientSlider",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Controls/Slider","DS/WebRecordEnabler/Adapter"],function(h,g,c,e,f,d){var b=f.inherit({name:"gradientSlider",markForRecordFlag:true,publishedProperties:{},buildView:function(){var k="wux-controls-gradientslider-";var j=this;this._parent();var i=[{namediv:"colorPickerHuePicker",elemDiv:"picker",nameCanvas:"canvasHuePicker",elemCanvas:"canvasHue",width:"26",height:"300"}];i.forEach(function(l){j.elements[l.namediv]=new h.Element("div",{"class":k+l.elemDiv}).inject(j.elements.sliderContainer);j.elements[l.nameCanvas]=new h.Element("canvas",{"class":k+l.elemCanvas,width:l.width,height:l.height})});this.elements.colorPickerHuePicker.appendChild(this.elements.canvasHuePicker);this.elements.sliderContainer.height=300;this.elements.canvasHuePicker.height=this.elements.sliderContainer.height;this.elements.cursor=new h.Element("span",{"class":"wux-ui-fa wux-ui-fa-caret-left"}).inject(this.elements.sliderCursor);this.elements.sliderCursor.addClassName("wux-controls-gradientslider-cursor");this._valueHex="ff0000"},_postBuildView:function(){this.refreshView()},handleEvents:function(){this._parent();var i=this;var j=false;var k=false;this.elements.container.addEvent(c.POINTERDOWN,function(l){l.stopPropagation()});this.elements.container.addEvent(c.POINTERMOVE,function(l){l.preventDefault()});this.elements.cursor.addEvent("mouseleave",function(l){document.body.style.cursor="default"});this.elements.container.addEvent("change",function(l){i.isPressed=true;if(i.elements.sliderContainer){i._calculRGB()}})},_calculRGB:function(){var k=this.elements.canvasHuePicker.getContext("2d");var l=this.elements.sliderCursor.offsetTop;if(l<0){l=0}var m=k.getImageData(10,l,1,1);var j=m.data;var i={r:j[0],g:j[1],b:j[2]};if(!this.hexValueIsBeingSet){this.calculRGBInProccess=true;this._setValueHex(e.rgbToHex({r:parseInt(i.r),g:parseInt(i.g),b:parseInt(i.b)}));this.calculRGBInProccess=false}},_setValueHex:function(i){if(i!=this._valueHex){this.hexValueIsBeingSet=true;this._valueHex=i;if(!this.calculRGBInProccess){this._calculPositionCursor(e.hexToHsl(this._valueHex)[0])}this.hexValueIsBeingSet=false}},_getValueHex:function(){return this._valueHex},_calculPositionCursor:function(j){var k=(360-j)/360*this.elements.canvasHuePicker.height;var i=((this.elements.canvasHuePicker.height-k)/this.elements.canvasHuePicker.height)*100;this.setPercentage(i)},_getMousePos:function(j,i){var k=j.getBoundingClientRect();return{x:i.clientX-k.left,y:i.clientY-k.top}},refreshView:function(){var p=this.elements.canvasHuePicker.getContext("2d");var n=p.createLinearGradient(0,0,0,this.elements.canvasHuePicker.height);var m=37;for(var k=0;k<m;k++){var l=k/(m-1);var j=[(1-l)*360,100,50];var i=e.hslToRgb(j);var o=a(i);n.addColorStop(l,o)}p.fillStyle=n;p.fillRect(0,0,this.elements.canvasHuePicker.width,this.elements.canvasHuePicker.height);this.elements.sliderBackgroundFilled.remove();this.elements.sliderBackground.remove();this.isPressed=false}});var a=function(i){return"rgb("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+")"};d.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/SmartInput",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Form","UWA/Controls/ToolTip","DS/Controls/Stack","DS/Controls/Knob","UWA/Controls/DatePicker","DS/Controls/Switch"],function(h,a,g){var c=g.extend({defaultOptions:{value:[0,0,0],labels:["x","y","z"],inputType:"number",onChange:null},init:function(i){this._parent(i);this._inputs=[];this._buildView();this.setValue(this.options.value);this._value=this.getValue()},setValue:function(j){var i=this;this._value=[];j.forEach(function(l,k){if(i._inputs[k]){i._inputs[k].setAttribute("value",l)}i._value.push(l)})},getValue:function(){this._value=[];var i=this;i._inputs.forEach(function(k,j){var l=k.value;i._value.push(l)});return this._value},_buildView:function(){this.elements.container=new h.Element("div",{"class":"wux-input-vector"});var i=this;this.options.value.forEach(function(m,l){var k=new h.Element("div",{"class":"wux-input-vector-label",styles:{textAlign:"right",display:"inline-block"}}).inject(i.elements.container);var n=i.options.labels[l];if(n){k.set({text:n+":",styles:{minWidth:40}})}var j=new h.Element("input",{type:i.options.inputType,styles:{width:50,height:14},events:{change:function(){if(i.options.onChange){i.options.onChange.call(i,i.getValue())}}}}).inject(i.elements.container);i._inputs.push(j)})}});var b=g.extend({defaultOptions:{value:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],onChange:null},init:function(i){this._parent(i);var k=this.options.value;var j=this;this._upVector=new c({labels:["up"],value:k[0],inputType:"text",onChange:function(){j._onChange()}});this._rightVector=new c({labels:["right"],value:k[1],inputType:"text",onChange:function(){j._onChange()}});this._dirVector=new c({labels:["dir"],value:k[2],inputType:"text",onChange:function(){j._onChange()}});this._posVector=new c({labels:["pos"],value:k[3],inputType:"text",onChange:function(){j._onChange()}});this._buildView()},_onChange:function(){console.log("-");if(this.options.onChange){this.options.onChange.call(this,this.getValue())}},setValue:function(i){this._value=[];this._upVector.setValue(i[0]);this._righVector.setValue(i[1]);this._dirVector.setValue(i[2]);this._posVector.setValue(i[3]);this._value.push(this._upVector.getValue());this._value.push(this._rightVector.getValue());this._value.push(this._dirVector.getValue());this._value.push(this._posVector.getValue())},getValue:function(){this._value=[];this._value.push(this._upVector.getValue());this._value.push(this._rightVector.getValue());this._value.push(this._dirVector.getValue());this._value.push(this._posVector.getValue());console.log(this._value);return this._value},_buildView:function(){this.elements.container=new h.Element("div",{"class":"wux-controls-matrix4x4"});this.elements.container.addContent(this._upVector).addContent(this._rightVector).addContent(this._dirVector).addContent(this._posVector)}});var e=g.extend({defaultOptions:{value:10,minValue:0,maxValue:100,stepValue:1,onChange:null},init:function(i){this._parent(i);this._value=this.options.value;this._buildView()},_buildView:function(){var i=this;this.elements.container=new h.Element("ul",{"class":"wux-input-distance"});var k=this.options.minValue.toString();if(this.options.minLabel){k=this.options.minLabel}this.elements.minValue=new h.Element("li",{html:k}).inject(this.elements.container);this.elements.inputRangeContainer=new h.Element("li",{}).inject(this.elements.container);this.elements.inputRange=new h.Element("input",{type:"range",min:this.options.minValue,max:this.options.maxValue,step:this.options.stepValue,events:{change:function(l){console.log("change");i._value=i.elements.inputRange.value;i.elements.valueContainer.setHTML(i._value);if(i.options.onChange){i.options.onChange.call(i,i._value)}i.dispatchEvent("onChange")}}}).inject(this.elements.inputRangeContainer);var j=this.options.maxValue.toString();if(this.options.maxLabel){j=this.options.maxLabel}this.elements.maxValue=new h.Element("li",{html:j}).inject(this.elements.container);this.elements.valueContainer=new h.Element("div",{html:this._value.toString(),styles:{color:"#444",minWidth:50,fontWeight:"bold",backgroundColor:"#FFF",borderRadius:5}}).inject(this.elements.container)}});function d(l){var j;var i;var k=l.name;switch(l.kind){case"text":i=50;j=new h.Controls.Form({fields:[{type:"text",name:k,label:l.label,value:l.value}]});break;case"combo":i=50;j=new h.Controls.Form({fields:[{type:"range",name:k,label:l.label,value:l.value,step:l.rules.stepValue,min:l.rules.minValue,max:l.rules.maxValue}]});break;case"switch":i=50;j=new WUX.Controls.Switch({value:l.value,label:l.label,onChange:l.onChange});break;case"translation":i=40;j=new c({value:l.value,labels:["Tx","Ty","Tz"],onChange:l.onChange});break;case"matrix4x4":i=40;var m={};if(l.value){m.value=l.value}m.onChange=l.onChange;j=new b(m);break;case"vector":i=40;j=new c({value:l.value,onChange:l.onChange});break;case"rotation":i=40;j=new c({value:l.value,labels:["Rx","Ry","Rz"],onChange:l.onChange});break;case"direction":i=40;j=new c({value:l.value,labelX:"up",labelY:"right",labelZ:"dir",onChange:l.onChange});break;case"angle":i=100;if(l.value===undefined){l.value=0}j=new WUX.Controls.Knob({graduationsLabel:true,value:l.value,minValue:0,maxValue:2*Math.PI,graduations:[{label:"0",value:0},{label:"&pi;/2",value:Math.PI/2},{label:"&pi;",value:Math.PI},{label:"3&pi;/2",value:3*Math.PI/2},{label:"2&pi;",value:2*Math.PI}],graduationsLabelColor:"black",activeGraduationsColor:"#3CF",inactiveGraduationsColor:"#CCC",knobIndicator:"line",knobMaterial:"pearl",onChange:l.onChange});break;case"intensity":if(l.value===undefined){l.value=0}i=100;j=new WUX.Controls.Knob({knobMaterial:"pearl",value:l.value,graduations:20,dynamicGraduations:true,minValue:l.rules.minValue,maxValue:l.rules.maxValue,onChange:l.onChange});break;case"systemColor":i=24;j=new h.Element("input",{type:"color",styles:{height:12,padding:0,margin:0,border:"none"},name:k,value:l.value});break;case"distance":i=50;j=new e({value:l.value,minValue:l.rules.minValue,maxValue:l.rules.maxValue,stepValue:l.rules.stepValue,onChange:l.onChange});break;case"number":i=50;j=new h.Element("input",{type:"number",min:l.rules.minValue,max:l.rules.maxValue,step:l.rules.stepValue,name:k,value:l.value});break;case"date":j=new h.Controls.DatePicker({type:"date",format:"%e %b %Y"});break;default:i=50;j=new h.Controls.Form({fields:[{type:l.kind,name:k,label:l.label,value:l.value}]});break}j.getHeight=function(){return i};return j}var f=g.extend({defaultOptions:{position:{parent:null,x:0,y:0},label:"Value",name:"smart_input",unit:"",kind:"string",value:undefined,inPlaceEdit:false,editEvent:"click",rules:{minLength:null,maxLength:null,minValue:null,maxValue:null,unit:null,dataType:null},onConfirm:null,onCancel:null,onChange:null},init:function(i){this._parent(i);console.warn("deprecated","Please DO NOT use anymore Controls/SmartInput, use SmartInputs/* instead")},buildView:function(){var m=this;this._smartInput=d(this.options);if(!this.options.inPlaceEdit){var l=new h.Element("button",{"class":"wux-smartinput-button wux-smartinput-button-valid",html:"V",events:{click:function(){m._onConfirm.call(m)}}});var n=new h.Element("button",{"class":"wux-smartinput-button wux-smartinput-button-cancel",html:"X",events:{click:function(){m._onCancel.call(m)}}});var k=this._smartInput.getHeight();var j=new WUX.Controls.Stack({styles:{height:k}});j.append(this._smartInput,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});j.append(l,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});j.append(n,{styles:{height:k,lineHeight:k+"px",verticalAlign:"middle"}});var i;if(m.options.value){i=this.options.value.toString()+" "+this.options.unit}else{i=this._smartInput.getValue()}this.elements.container=new h.Element("div",{"class":"wux-smartinput",html:i});this._tooltip=new h.Controls.ToolTip(this.elements.container,j,{className:"wux-smartinput-tooltip",showOver:false,offsetX:10,offsetY:0});this.elements.container.addEvent(this.options.editEvent,function(p){h.extendElement(document).getElements(".wux-smartinput-tooltip").forEach(function(r){r.hide()});var o=m.elements.container.getOffsets();o.y+=20;m._tooltip.show();var q=m._tooltip.elements.tooltip;q.setStyle("position","fixed");q.show();q.setPosition(o);if(m.options.relativePosition){m._tooltip.elements.tooltip.inject(m.options.relativePosition)}})}else{this.elements.container=new h.Element("div",{"class":"wux-smartinput",html:this._smartInput})}},_onConfirm:function(){var i=this.getValue();this.elements.container.setHTML(i+" "+this.options.unit);if(this.options.onConfirm){this.options.onConfirm.call(this,{name:this.options.name,value:i})}this._tooltip.hide()},getValue:function(){var i;switch(this.options.kind){case"number":case"distance":i=this._smartInput._value;break;case"systemColor":i=this._smartInput.value;break;case"translation":case"rotation":case"angle":case"intensity":case"vector":case"matrix4x4":case"angle":i=this._smartInput.getValue().toString();break;case"switch":i=this._smartInput.getValue();break;case"date":i=this._smartInput.getDate().toString();console.log(i);break;default:i=this._smartInput.getFormValue(this.options.name);break}return i},_onCancel:function(){if(this.options.onCancel){this.options.onCancel.call(this)}this._tooltip.hide()},onConfirm:function(i){if(i){this.options.onConfirm=i}},onCancel:function(i){if(i){this.options.onCancel=i}}});return h.namespace("WUX/Controls/SmartInput",f)});define("DS/Controls/TreeNodeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Json","UWA/Utils","DS/Core/Core","DS/Utilities/Css3D","DS/Selection/HSOManager","DS/Controls/SmartInput","DS/UIBehaviors/Draggable","DS/UIBehaviors/Droppable","DS/Utilities/Object","DS/CoreEvents/ModelEvents","UWA/Utils/Client"],function(UWA,Event,Abstract,UWAJson,UWAUtils,WUX,WUXCss3d,HSOmanager,SmartInput,WUXDraggable,WUXDroppable,UtilsObject,ModelEvents,UWAClient){var FX_DURATION=200;var NAVIGATOR=UWAClient.Engine;var DEBUG=false;function wux_move(arrayToProcess,old_index,new_index){if(new_index>=arrayToProcess.length){var k=new_index-arrayToProcess.length;while((k--)+1){arrayToProcess.push(undefined)}}arrayToProcess.splice(new_index,0,arrayToProcess.splice(old_index,1)[0]);return arrayToProcess}function cleanArray(actual){var newArray=[];for(var i=0;i<actual.length;i++){if(actual[i]){newArray.push(actual[i])}}return newArray}var TreeNodeBase=Abstract.extend({defaultOptions:{expandAtInit:false,isFakeRoot:false,isRoot:false,isEditable:undefined,isDraggable:undefined,node:null,tree:null,animateOnExpand:false,onPreExpand:null,onPostExpand:null,onPreCollapse:null,onPostCollapse:null,UI:"default",rowIndex:null,data:null,renderSaver:100,allowTextCopy:false},init:function(options){this._parent(options);this.options=UWA.extend(this.options,options);this._uuid=UWA.Utils.getUUID();this._nodeDepth=-1;this._childrenSlots=[];this._children=(UWA.typeOf(this.options.children)==="array")?[]:null;this._childID=null;this._isExpanded=false;this._isInTreeListView=false;this._hasBeenAttached=false;this._rowIndex=null;this._isInWriteMode=false;this._updateViewTimeout=null;var me=this;this._modeIsExpandAll=false;this._modeIsMultiSel=false;if(UWA.typeOf(this.options.UI)==="string"){}this.buildSkeleton();if(this.options.isRoot){this._attachToView()}UWA.Element.addEvent.call(document,"keydown",function(event){var key=UWA.Event.whichKey(event);if(key==="ctrl"&&!me._modeIsMultiSel){me._modeIsMultiSel=true}});UWA.Element.addEvent.call(document,"keyup",function(event){var key=UWA.Event.whichKey(event);if(key==="ctrl"){me._modeIsMultiSel=false}})},delegateEvents:function(){WUX.warn("deprecated","don't use anymore the method delegateEvents on TreeNode")},getParent:function(){return this._parentNode},getRoot:function(){var root=this;while(root&&!root.options.isRoot){root=root.getParent()}return root},getPath:function(){var root=this;var path="";while(root&&!root.options.isRoot){if(root.elements.label&&root.elements.label.getText()){path=root.elements.label.getText()+" > "+path}root=root.getParent()}return path},isAscendantOf:function(node){var root=node;while(root&&!root.options.isRoot){root=root.getParent();if(root===this){return true}}return false},highlight:function(color){if(color===undefined){this.elements.label.addClassName("wux-datagrid-cell-highlighted")}else{this.elements.label.setStyles(color)}},unhighlight:function(){this.elements.label.removeClassName("wux-datagrid-cell-highlighted")},setLabel:function(label,notifyChange){if(notifyChange===undefined){notifyChange=true}this.options.label=label;if(this.isInWriteMode()){this.switchToWriteView()}else{this.switchToReadView()}var tree=this.getTree();if(tree&&notifyChange){tree._modelEvents.publish({context:this,event:"UPDATE_LABEL",data:label})}},getLabel:function(){return this.options.label},isInWriteMode:function(){return this._isInWriteMode},switchToWriteView:function(){var me=this;var model=this.options;var isEditableOptions=this.options.isEditable;if(isEditableOptions.switchToWriteView.callback===undefined){isEditableOptions.switchToWriteView.callback=function(e){this.switchToWriteView()}}var newValue=model.label;this.elements._readWriteContainer=isEditableOptions.switchToWriteView.view.call(this,this);this.elements._readWriteContainer.addEvent("change",function(e){newValue=this.value});var evts=isEditableOptions.switchToReadView.event.split(" ");evts.forEach(function(evt){me.elements._readWriteContainer.addEvent(evt,function(e){isEditableOptions.switchToReadView.callback.call(me,e,me);me._isInWriteMode=false;me.setLabel(newValue)})});this.elements.label.setContent(this.elements._readWriteContainer);this.elements._readWriteContainer.focus();this._isInWriteMode=true},switchToReadView:function(){var me=this;var isEditableOptions=this.options.isEditable;if(isEditableOptions&&isEditableOptions.switchToReadView&&isEditableOptions.switchToWriteView){if(isEditableOptions.switchToReadView.callback===undefined){isEditableOptions.switchToReadView.callback=function(e){this.switchToReadView()}}this.elements._readOnlyContainer=isEditableOptions.switchToReadView.view.call(this,this);var evts=isEditableOptions.switchToWriteView.event.split(" ");evts.forEach(function(evt){me.elements._readOnlyContainer.addEvent(evt,function(e){isEditableOptions.switchToWriteView.callback.call(me,e,me)})})}else{this.elements._readOnlyContainer=new UWA.Element("div",{html:this.options.label})}if(this.elements.label){this.elements.label.setContent(this.elements._readOnlyContainer)}this._isInWriteMode=false},addChild:function(child,index){if(!child.isAscendantOf(this)){if(child.getParent()===this){var oldIndex=this._children.indexOf(child);wux_move(this._children,oldIndex,index);this._children=cleanArray(this._children)}else{if(child.elements.container&&child.elements.container.parentNode){child.elements.container.parentNode.removeChild(child.elements.container)}if(child.getParent()){child.getParent().removeChild(child)}if(child.isExpanded()){child.collapse()}child.options.UI=this.options.UI;child.options.tree=this.options.tree;if(this.options.tree){this._onTreeAttach(index)}if(!this._children){this._children=[]}if(index!==undefined){this._children.splice(index,0,child);child._childID=this._children.length-1}else{child._childID=this._children.push(child)-1}}child._setParent(this);this._hasBeenAttached=true}else{console.warn("logical error","You tried to attach a node on one of its descendant, or on itself")}},addChildren:function(children,index){var me=this;this.children.forEach(function(child){me.addChild(child,index)})},_setParent:function(parentNode){this._parentNode=parentNode;if(parentNode){var uncles=parentNode.getNextBrothersNodes();if(uncles.length){uncles[0]._updateView(false)}parentNode._updateView(parentNode._isExpanded,parentNode._isExpanded)}this._inheritFromTree();if(this.getParent()&&this.getParent().getParent()){this.getParent().getParent()._updateView(false)}},_inheritFromTree:function(){if(this.options.isEditable===null||this.options.isEditable===undefined){var tree=this.getTree();if(tree){if(tree.options.isEditable){this.options.isEditable={};UWA.extend(this.options.isEditable,tree.options.isEditable,true)}}}},_unsetParent:function(){var oldParent=this.getParent();this._dettachFromView();var prevUncle=this.getPrevBrotherNode();var node=oldParent.getChildren().splice(this._childID,1)[0];if(prevUncle){prevUncle._updateView()}if(oldParent.getChildren().length===0&&oldParent._isExpanded){oldParent._isExpanded=false}if(oldParent){oldParent._updateView()}this._setParent(null);return node},_onTreeAttach:function(){this._buildExpander(false);var children=this.getChildren();if(children){children.forEach(function(child){child._onTreeAttach()})}},removeChild:function(child,setChildrenToNull){if(setChildrenToNull===undefined){setChildrenToNull=true}child.getContent().destroy();var indice=this._children.indexOf(child);if(indice!==-1){this._children.splice(indice,1)}if(this.getLastChild()){this.getLastChild()._buildExpander(false);this.getLastChild()._buildLink(true)}if(setChildrenToNull&&this.getChildren()&&this.getChildren().length===0){this._children=null}this._buildExpander(false);this._buildLink(true)},remove:function(){this.getParent().removeChild(this)},removeChildren:function(){var nChildren=this._children.length;for(var i=0;i<nChildren;i++){if(this._children[i]){this.removeChild(this._children[i])}}this._children=null;this.updateExpanderState()},buildSkeleton:function(test){if(this.elements.container&&this.elements.container.parentNode){this.elements.container.parentNode.removeChild(this.elements.container)}this.elements.container=new UWA.Element("li",{"class":"Container",styles:{position:"relative",overflow:"hidden",minHeight:16}});this._buildChildrenContainer()},updateExpanderState:function(){this._buildExpander(false)},_buildExpander:function(mustBeCreated){if(mustBeCreated===undefined){mustBeCreated=true}var me=this;var model=this.options;var uiTheme=model.UI;var shiftTop=(uiTheme.icon.size-(uiTheme.expander.size+2*uiTheme.expander.borderSize))/2;var shiftRight=0;if(this._children){switch(UWA.typeOf(this._children)){case"string":this._expandState="asyncState";this._nodeIsAsync=true;break;case"array":if(!this._isExpanded){this._expandState="expandState"}else{this._expandState="collapseState"}this._nodeIsAsync=false;break}}else{if(this.isRoot()){this._expandState="noExpandRoot"}else{this._expandState="noExpandState"}this._nodeIsAsync=false;shiftRight=(uiTheme.expander.size*uiTheme.expander.borderSize)/2;shiftTop=uiTheme.icon.size/2}var expanderTheme=this.options.UI[this._expandState];expanderTheme.styles.marginLeft=shiftRight;expanderTheme.styles.marginTop=shiftTop;if(mustBeCreated){if(model&&model.children){this.elements.container.setAttributes({"data-isExpanded":false})}this.elements.expander=new UWA.Element("li",expanderTheme);this.elements.expander.inject(this.elements.view);this.elements.expander.removeEvent("click");this.elements.expander.addEvent("click",function(event){if(!me._isExpanded){me.expand()}else{me.collapse()}})}else{if(this.elements.expander){this.elements.expander.set(this.options.UI[this._expandState]);if(this.options.UI.shadow){this.elements.expander.addClassName("Shadow")}}}},_isLastChild:function(){return this.getParent()&&((this.getParent().getChildren().indexOf(this)+1)===this.getParent().getChildren().length)},_buildLink:function(mustBeUpdated){if(!this.options.isRoot){var uiTheme=this.options.UI;if(mustBeUpdated===undefined){mustBeUpdated=false}var cssBottomProp="bottom";var cssBottomValue=-(uiTheme.layout.btMargin*2)+uiTheme.icon.size/2+"px";this._isLastChildFlag=this._isLastChild();if(this._isLastChild()){cssBottomProp="height";cssBottomValue=uiTheme.layout.btMargin*2+uiTheme.icon.size/2+uiTheme.link.size/2+"px"}var cssTopValue=-(Number(uiTheme.layout.btMargin))+"px";if(!mustBeUpdated){this.elements.verticalLink=new UWA.Element("li",{text:"","class":"Link"});this.elements.verticalLink.inject(this.elements.container)}if(this.elements.verticalLink){this.elements.verticalLink.setStyles({borderLeft:uiTheme.link.size+"px "+uiTheme.link.style+" "+uiTheme.link.color,top:cssTopValue,position:"absolute",left:this._marginLeft+uiTheme.expander.size/2});if(cssBottomProp==="bottom"){this.elements.verticalLink.setStyle("height","auto")}else{this.elements.verticalLink.setStyle("bottom","auto")}this.elements.verticalLink.setStyle(cssBottomProp,cssBottomValue)}}},_buildIcons:function(){var model=this.options;if(model&&model.icons){this.elements.icons=[];var nIcons=model.icons.length;for(var j=0;j<nIcons;j++){var ico=new UWA.Element("li",{"class":"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+model.icons[j]+")",backgroundSize:"100%"}});ico.inject(this.elements.view);this.elements.icons.push(ico)}}},setIcon:function(options){options=UWA.extend({picture:"",iconID:0},options);if(!this.elements.icons[options.iconID]){var ico=new UWA.Element("li",{"class":"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+options.picture+")",backgroundSize:"100%"}});ico.inject(this.elements.view);this.elements.icons[options.iconID](ico)}else{this.elements.icons[options.iconID].setStyles({marginLeft:this.options.UI.layout.lrMargin,background:"url("+options.picture+")",backgroundSize:"100%"})}},_buildLabel:function(){var model=this.options;var me=this;if(model.label){if(model.isRoot){this.options.UI.label.fontWeight="bold"}else{this.options.UI.label.fontWeight="normal"}this.elements.label=new UWA.Element("li",{"class":"wux-treenode-label",styles:this.options.UI.label});this.elements.label.setStyles(this.options.UI.label);if(this._isHighlighted){this.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"})}if(this.options.UI.shadow){this.elements.label.addClassName("Label Shadow")}this.elements.label.setStyles({backgroundColor:model.backgroundColor});this.elements.label.inject(this.elements.view);this.elements.label.addEvent("click",function(event){var tree=me.getTree();if(tree.options.onClick){tree.options.onClick.apply(me,me,me.options.data)}});this.elements.label.addEvent("click",function(event){var tree=me.getTree();if(tree){tree._modeIsMultiSel=event.ctrlKey;tree._modelEvents.publish({event:"click",data:me})}});this.elements.label.addEvent("dblclick",function(event){var tree=me.getTree();if(tree){tree._modelEvents.publish({event:"dblClick",data:me})}})}},getTree:function(){var rootNode=this.getRoot();if(rootNode){var tree=rootNode.options.tree;return tree}else{return this.options.tree}},buildNode:function(){var model=this.options;if(this.getParent()){this._nodeDepth=this.getParent()._nodeDepth+1}this.elements.container.setAttributes({"data-nodeDepth":this._nodeDepth});var rowClass;if(model.grid){rowClass="wux-tree-row"}if(model.isRoot){rowClass+=" wux-tree-headers"}this.elements.row=new UWA.Element("div",{"class":rowClass,styles:{display:"inline-block",whiteSpace:"pre",marginRight:14}});var uiTheme=this.options.UI;this._marginLeft=(this._nodeDepth)*(uiTheme.layout.lrMargin+(uiTheme.expander.size+uiTheme.expander.borderSize*2)*1+(uiTheme.icon.size-(uiTheme.expander.size+uiTheme.expander.borderSize*2))/2);this.elements.view=new UWA.Element("ul",{"class":"Node Horizontal",styles:{marginLeft:this._marginLeft+"px",position:"relative",display:"inline-block",zIndex:10,paddingTop:this.options.UI.layout.btMargin}});this._inheritFromTree();this._buildExpander();this._buildLink();this._buildIcons();this._buildLabel();this.elements.view.inject(this.elements.row);if(this._customizeNodeView){this._customizeNodeView()}this.elements.row.inject(this.elements.container,"top");if((this.options.expandAllAtInit&&this._nodeDepth>0)||this._nodeDepth===0){this.show()}else{this.hide()}this.setLabel(this.options.label,false)},_buildChildrenContainer:function(){this.elements.childrenContainer=new UWA.Element("ul",{"class":"wux-controls-treenodebase-children wux-ui-stack-v",styles:{}}).inject(this.elements.container)},getPrevBrotherNode:function(){if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);if(childIndex>0){childIndex--;return this.getParent().getNthChild(childIndex)}}},getNextBrotherNode:function(){if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);if(childIndex<this.getParent().getChildren().length){childIndex++;return this.getParent().getNthChild(childIndex)}}},getNextBrothersNodes:function(){var brotherNodes=[];if(this.getParent()){var childIndex=this.getParent().getChildren().indexOf(this);while(childIndex<this.getParent().getChildren().length-1){childIndex++;brotherNodes.push(this.getParent().getNthChild(childIndex))}}return brotherNodes},getChildIndex:function(){return this.getParent()&&this.getParent().getChildren()?this.getParent().getChildren().indexOf(this):-1},getChildren:function(){return this._children},hasChildren:function(){var child=this.getChildren();if(child&&child.length>0){return true}else{return false}},getAllDescendants:function(descendants){if(descendants===undefined){descendants=[]}else{descendants.push(this)}var children=this.getChildren();if(children){children.forEach(function(child){child.getAllDescendants(descendants)})}return descendants},getNthChild:function(iIndice){if(this.getChildren()){return this._children[iIndice]}},getLastChild:function(){return this._children[this._children.length-1]},_getRowIndex:function(){return this.options._rowIndex},_setRowIndex:function(rowIndex){this.options._rowIndex=rowIndex},onPreExpand:function(callback){if(callback){this.options.onPreExpand=callback}},onPostExpand:function(callback){if(callback){this.options.onPostExpand=callback}},_preExpandDone:function(){this.getTree()._modelEvents.publish({event:"PRE_EXPAND_DONE"})},expand:function(expandLevel){if(expandLevel===undefined){expandLevel=1}var me=this;var processExpand=function(){if(me._modeIsExpandAll!==true){me._modeIsExpandAll=expandLevel;if(me._modeIsExpandAll&&me._modeIsExpandAll>0){me._modeIsExpandAll--;me._processChildren(true)}}else{me._processChildren(true)}if(!me.getChildren()){me._buildExpander(false)}me.getTree()._modelEvents.publish({event:"expand",context:me,data:{node:me}});if(me.options.onPostExpand){me.options.onPostExpand.call(me)}me.getTree()._modelEvents.publish({event:"postExpand",context:me,data:{node:me}})};if(expandLevel>0&&!this.isExpanded()){me.getTree()._modelEvents.publish({event:"preExpand",context:me,data:{node:me}});if(me.options.onPreExpand){me.options.onPreExpand.call(me)}if(me.options.useAsyncPreExpand){me.getTree()._modelEvents.subscribe({event:"PRE_EXPAND_DONE"},function(){processExpand()})}else{processExpand()}}},expandAll:function(){this._modeIsExpandAll=true;this._processChildren(true);this._modeIsExpandAll=false},isExpanded:function(){return this._isExpanded},isRoot:function(){return this.options.isRoot},_showChildren:function(){var me=this;this._children.forEach(function(childNode){childNode._attachToView();if(me._modeIsExpandAll){childNode.expand(me._modeIsExpandAll)}if(me.options.animateOnExpand){var fx=new UWA.Fx(childNode.getContent(),{duration:FX_DURATION,transition:"quintIn"});fx.start({opacity:[0,1],marginTop:[-20,0]})}me.getTree()._onUpdate(childNode)});this._isExpanded=true;if(this.elements.expander){this.elements.expander.set(this.options.UI.collapseState)}},_processChildren:function(){var children=this.getChildren();this._loadModel(children)},_getObjectClass:function(){return"TreeNodeBase"},onPreCollapse:function(callback){if(callback){this.options.onPreCollapse=callback}},onPostCollapse:function(callback){if(callback){this.options.onPostCollapse=callback}},collapseNode:function(){console.warn("Please use the collapse method instead");this.collapse()},collapse:function(){if(this.isExpanded()){if(this.options.onPreCollapse){this.options.onPreCollapse.call(this)}this.getTree()._modelEvents.publish({event:"preCollapse",context:this,data:{node:this}});if(this._children){this._children.forEach(function(childNode){childNode._dettachFromView();childNode.collapse()})}this._isExpanded=false;this._expandState="expandState";if(this.isDrawn()){this.elements.expander.set(this.options.UI[this._expandState])}this.getTree()._modelEvents.publish({event:"collapse",context:this,data:{node:this}});if(this.options.onPostCollapse){this.options.onPostCollapse.call(this)}this.getTree()._modelEvents.publish({event:"postCollapse",context:this,data:{node:this}})}},_attachToView:function(childIndex){this.buildSkeleton();this.buildNode();this.show();if(this.getParent()&&!this.options.isRoot&&!this.getContent().isInjected()){var index=this.getParent().getChildren().indexOf(this);var parentContainer=this.getParent().elements.childrenContainer;if(parentContainer.children&&parentContainer.children[index]){parentContainer.insertBefore(this.getContent(),parentContainer.children[index])}else{parentContainer.appendChild(this.getContent())}}if(this.getParent()&&this.options.isRoot){var index=parseInt(this.getParent().getChildren().indexOf(this),10);var parentContainer=this.getTree().elements.treeContainer;if(parentContainer.children&&parentContainer.children[index]){parentContainer.insertBefore(this.getContent(),parentContainer.children[index])}else{parentContainer.appendChild(this.getContent())}this.show()}if(this.options.isRoot){this.show()}if(this.options.isRoot&&this.options.isFakeRoot){this.hide()}this._isDrawn=true;this._bindBehaviors()},_dettachFromView:function(){if(this.elements&&this.elements.container&&this.getContent()){this.getContent().destroy()}this._isDrawn=false},isDrawn:function(){return this._isDrawn},_bindBehaviors:function(){var me=this;var parentTree=this.getTree();if(this.options.isDraggable===undefined&&parentTree.options.isEditable){this.options.isDraggable=parentTree.options.isEditable.nodesAreDraggable}if(parentTree.options.isEditable){this.options.isEditable={autoExpandAtDrag:true,autoExpandAtDragDelay:1000};this.options.isEditable=UWA.merge(this.options.isEditable,parentTree.options.isEditable,true)}if(this.options.isDraggable){this._drag=new WUXDraggable(this,this.elements.view,{dataTransfer:{type:"Text",data:"toto"},data:this,onDragStart:function(e,ui){parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_START",data:me})}});var dropPos;this._drop=new WUXDroppable(this,this.elements.view,{onDragEnter:function(e,ui,data){parentTree._clearAutoExpandAtDragTimeout()},onDragOver:function(e,ui,data){var targetedObject=this;var dm=me.elements.view.getDimensions();var topThresh=Number(dm.height)/3;var middleThresh=dm.height*2/3;var mousePos=NAVIGATOR.ie?e.offsetY:e.layerY;if(mousePos<topThresh){dropPos="top";ui.setStyles({boxShadow:"inset 0px 1px 0px blue"});parentTree._clearAutoExpandAtDragTimeout()}else{if(mousePos>=topThresh&&mousePos<middleThresh){dropPos="middle";ui.setStyles({boxShadow:"inset -1px -1px 0px blue, inset 1px 1px 0px blue"});if(me.options.isEditable.autoExpandAtDrag&&!parentTree._toAutoExpandAtDrag){parentTree._toAutoExpandAtDrag=setTimeout(function(){targetedObject.expand()},me.options.isEditable.autoExpandAtDragDelay)}}else{dropPos="bottom";ui.setStyles({boxShadow:"inset 0px -1px 0px blue"});parentTree._clearAutoExpandAtDragTimeout()}}parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_OVER",data:me})},onDragLeave:function(e,ui){ui.setStyles({boxShadow:"none"});parentTree._clearAutoExpandAtDragTimeout();parentTree._modelEvents.publish({context:me,event:"NODE/DRAG_LEAVE",data:me})},drop:function(e,ui,data){ui.setStyles({boxShadow:"none"});parentTree._modelEvents.publish({context:this,event:"NODE/PRE_DROP",data:data});if(this!==data.from){if(parentTree._onDropCallBack){parentTree._onDropCallBack.call(this,data)}else{var deltaDown=1,deltaUp=0;if(data.from.getParent()===this.getParent()){deltaDown=data.from.getParent().getChildren().indexOf(data.from)<this.getParent().getChildren().indexOf(this)?0:1;deltaUp=data.from.getParent().getChildren().indexOf(data.from)<this.getParent().getChildren().indexOf(this)?1:0}switch(dropPos){case"top":this.getParent().addChild(data.from,this.getParent().getChildren().indexOf(this)-deltaUp);break;case"middle":this.addChild(data.from);break;case"bottom":this.getParent().addChild(data.from,this.getParent().getChildren().indexOf(this)+deltaDown);break}}}else{console.warn("You dropped the node on itself")}parentTree._modelEvents.publish({context:this,event:"NODE/POST_DROP",data:data})}})}},_updateView:function(force,recursive){var me=this;if(this._updateViewTimeout){clearTimeout(this._updateViewTimeout)}function render(){if(force===undefined){force=false}if(recursive===undefined){recursive=false}if(force){me._dettachFromView();if(me.getParent()&&me.getParent()._isExpanded){me._attachToView()}if(DEBUG){var fx=new UWA.Fx(me.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF","#3F0"]});fx.start({backgroundColor:["#3F0","#FFF"]})}}else{me._buildExpander(false);me._buildLink(true);if(DEBUG){var fx=new UWA.Fx(me.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF","#3CF"]});fx.start({backgroundColor:["#3CF","#FFF"]})}}if(recursive){var children=me.getChildren();if(children){me.getChildren().forEach(function(child){if(child){child._updateView(force,true)}})}}}if(this.options.renderSaver){this._updateViewTimeout=setTimeout(render,this.options.renderSaver)}else{render()}},flash:function(color){if(color===undefined){color="#F1960C"}var fx=new UWA.Fx(this.elements.label,{duration:1000});fx.start({backgroundColor:["#FFF",color]});fx.start({backgroundColor:[color,"#FFF"]})},dump:function(mode){return this._dump(mode,{icons:null,label:null})},_dump:function(mode,properties,output){if(!output){output={}}if(!mode){mode=1}if(properties===undefined){properties={icons:null,label:null}}for(var prop in properties){var propToCopy=this.options[prop];if(propToCopy){output[prop]=propToCopy}}var children=this.getChildren();if(children){switch(mode){default:case 1:output.children=[];children.forEach(function(child){output.children.push(child.dump(mode))});return output;case 2:return(UWA.Json.encode(UWA.Json.path(children,"$_children[*]")))}}return output},processChildren:function(callback){var children=this.getChildren();if(children){children.forEach(function(child){if(callback){callback.call(child,child);child.processChildren(callback)}})}},_loadModel:function(children){var expandChildren=true;var me=this;if(children){switch(UWA.typeOf(children)){case"string":if(expandChildren){UWA.Ajax.request(children,{async:true,onComplete:function(msg){me.removeChildren();var jsonObject=eval(msg);me._parseTree(jsonObject,me,me._uuid,me.options.UI);if(expandChildren){me._showChildren()}else{me.collapse()}},onFailure:function(msg){console.log("[!]\tError loading file:"+children)}})}break;case"array":if(expandChildren){me._showChildren()}break}}},search:function(value){var children=this.getChildren();if(children){children.forEach(function(child){var originalLabelStyle;if(child.options.label){var label=child.options.label.toLowerCase();if(value!==""){if(label.search(value.toLowerCase())!==-1){originalLabelStyle=WUX.Utilities.Css.recordState(child.elements.label,["box-shadow","font-weight","text-shadow","border"]);child.elements.label.setStyles({boxShadow:"inset 0px 0px 200px 0px #ffff00,inset 0px 0px 2px 1px white",fontWeight:"bold",textShadow:"0px 1px 1px white"});child.getParent().expand(1)}else{WUX.Utilities.Css.restoreState(child.elements.label,originalLabelStyle,["box-shadow","font-weight","text-shadow"])}}else{WUX.Utilities.Css.restoreState(child.elements.label,originalLabelStyle,["box-shadow","font-weight","text-shadow"]);child.expand(1)}}child.search(value)})}}});return UWA.namespace("WUX/Controls/TreeNodeBase",TreeNodeBase)});define("DS/Controls/TreeNode",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeNodeBase","DS/CoreEvents/Events"],function(f,a,e,b,c){var d=b.extend({defaultOptions:{pathElement:null},init:function(g){this._parent(g);this._isHighlighted=false},getPathElement:function(){return this.options.pathElement}});return f.namespace("WUX/Controls/TreeNode",d)});define("DS/Controls/ResponsiveTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveViewAdaptor","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(c,f,d,e,a,b,g,j){var i=190;var h=540;var k=d.inherit({name:"ResponsiveTileView",markForRecordFlag:true,publishedProperties:{tileWidth:{defaultValue:260,type:"integer",category:"Behavior"}},buildView:function(){this._modelEvents=new b();this._isHighlighted=false;var n=this;this.elements.container=new c.Element("div",{"class":"wux-controls-responsivetileview"});this.elements.container.setAttribute("has-picture","false");this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("has-statusbar-content","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new c.Element("div",{"class":"wux-controls-highlightborder"}).inject(this.elements.container);this.elements.activediv=new c.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.color=new c.Element("div",{"class":"wux-controls-responsivetileview-color"}).inject(this.elements.container);this.elements.color.setAttribute("has-color","false");this.elements.picture=new c.Element("div",{"class":"wux-controls-responsivetileview-picture",}).inject(this.elements.container);this.elements.checkbox=new c.Element("div",{"class":"wux-controls-responsivetileview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.maincontent=new c.Element("div",{"class":"wux-controls-responsivetileview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.titlebar=new c.Element("div",{"class":"wux-controls-responsivetileview-titlebar"}).inject(this.elements.maincontent);this.elements.icon=new c.Element("div",{"class":"wux-controls-responsivetileview-icon"}).inject(this.elements.titlebar);this.elements.title=new c.Element("div",{"class":"wux-controls-responsivetileview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new c.Element("div",{"class":"wux-controls-responsivetileview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.description=new c.Element("div",{"class":"wux-controls-responsivetileview-description"}).inject(this.elements.maincontent);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new c.Element("div",{"class":"wux-controls-responsivetileview-propertiesListContainer"}).inject(this.elements.maincontent);this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.propertiesListFirstContainer=new c.Element("div",{"class":"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false");this.elements.propertiesListSecondContainer=new c.Element("div",{"class":"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false");this.elements.menu=new c.Element("div",{"class":"wux-controls-responsivetileview-menu"}).inject(this.elements.container);this.elements.menu.responsiveTileView=this;this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbar"}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var l=0;l<8;l++){var m=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbaricon"});this.elements.statusbaricons.push(m);var o=new c.Element("div",{"class":"wux-controls-responsivetileview-statusbarseparator"});this.elements.statusbar.appendChild(m);this.elements.statusbar.appendChild(o);m._index=l;a.addEventOnElement(this,m,e.POINTERDOWN,function(p){n.fire("StatusbarIconPointerDown",{iconIndex:p.target._index});p.stopPropagation()})}},_applyProperties:function(l){this._parent(l);if(this.isDirty("tileWidth")){this._applyTileWidth(l.tileWidth)}},_applyTileWidth:function(l){this._applyViewWidth(l)},_getViewMinWidth:function(){return i},_getViewMaxWidth:function(){return h},_getViewWidth:function(){return this.tileWidth},_onTileResize:function(l){this._onViewResize(this.tileWidth)},_getViewCssClassSuffix:function(){return"responsivetileview"}});return k});define("DS/Controls/ResponsiveTextualTileView",["UWA/Core","UWA/Controls/Abstract","DS/Controls/ResponsiveTileView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/Controls/TooltipModel"],function(d,f,i,e,a,b,g,h){var c=i.inherit({name:"ResponsiveTextualTileView",markForRecordFlag:true,buildView:function(){this._modelEvents=new b();this._isHighlighted=false;var l=this;this.elements.container=new d.Element("div",{"class":"wux-controls-responsivetextualtileview"});this.elements.container.setAttribute("has-picture","false");this.elements.container.setAttribute("has-icon","false");this.elements.container.setAttribute("has-statusbar-content","false");this.elements.container.setAttribute("is-empty-statusbar-visible","false");this.elements.container.setAttribute("active-mode","false");this.elements.container.titleLineNumber=1;this.elements.container.descriptionLineNumber=2;this.elements.highlightBorder=new d.Element("div",{"class":"wux-controls-highlightborder"}).inject(this.elements.container);this.elements.activediv=new d.Element("div",{"class":"wux-controls-activediv"}).inject(this.elements.container);this.elements.color=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-color"}).inject(this.elements.container);this.elements.color.setAttribute("has-color","false");this.elements.picture=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-picture",}).inject(this.elements.container);this.elements.pictureplaceholder=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-pictureplaceholder",html:"PLACE YOUR PNG PICTURE HERE"}).inject(this.elements.picture);this.elements.checkbox=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-checkbox"}).inject(this.elements.picture);this.checkbox=this.elements.checkbox;this.elements.titlebar=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-titlebar"}).inject(this.elements.container);this.elements.maincontent=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-maincontent"}).inject(this.elements.container);this.elements.maincontent.setAttribute("has-menu","false");this.elements.icon=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-icon"}).inject(this.elements.titlebar);this.elements.title=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-title"}).inject(this.elements.titlebar);this.elements.title.contentView=this;a.addEventOnElement(this,this.elements.title,"click",this._onTitleClick);this.elements.title.setAttribute("has-menu","false");this.elements.title.setAttribute("has-icon","false");this.elements.subtitle=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-subtitle"}).inject(this.elements.maincontent);this.elements.subtitle.setAttribute("has-subtitle","false");this.elements.description=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-description"}).inject(this.elements.maincontent);this.elements.description.setAttribute("has-description","false");this.elements.propertiesList=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertiesListContainer"}).inject(this.elements.maincontent);this.elements.propertiesList.setAttribute("has-propertiesList","false");this.elements.propertiesListFirstContainer=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false");this.elements.propertiesListSecondContainer=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList);this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false");this.elements.menu=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-menu"}).inject(this.elements.container);this.elements.menu.responsiveTileView=this;this.elements.menu.setAttribute("has-menu","false");this.elements.statusbar=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbar"}).inject(this.elements.container);this.elements.statusbar.setAttribute("has-statusbar-content","false");this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false");this.elements.statusbaricons=[];for(var j=0;j<8;j++){var k=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbaricon"});this.elements.statusbaricons.push(k);var m=new d.Element("div",{"class":"wux-controls-responsivetextualtileview-statusbarseparator"});this.elements.statusbar.appendChild(k);this.elements.statusbar.appendChild(m);k._index=j;a.addEventOnElement(this,k,e.POINTERDOWN,function(n){l.fire("StatusbarIconPointerDown",{iconIndex:n.target._index});n.stopPropagation()})}},_applyMultipleTitleLineNumber:function(j){this.elements.container.titleLineNumber=1;return},_getTitleLineHeight:function(){return 22},_getDescriptionLineHeight:function(){return 19},_getViewCssClassSuffix:function(){return"responsivetextualtileview"}});return c});define("DS/Controls/TreeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Css3D","DS/Controls/TreeNodeBase","DS/Controls/TreeNode","DS/Utilities/MouseEvents","DS/CoreEvents/ModelEvents"],function(j,C,u,a,x,h,y,c,s,m,p){var q=5;var B=5;var A=5;var r="#333";var o="transparent";var v="solid";var k=1;var g=r;var f="#FFF";var d=10;var z=20;var i={"class":"Expander",text:"+",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var b={"class":"Expander",text:"",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var l={"class":"Expander",text:"",styles:{backgroundColor:f,borderColor:g,height:d,width:d,lineHeight:(d-2)+"px",cursor:"pointer",zIndex:1000}};var t={"class":"NoExpander Link",text:"",styles:{backgroundColor:o,marginTop:z/2,width:(d+2*k)/2,borderTop:k+"px "+v+" "+r,cursor:"pointer",zIndex:1000}};var e={"class":"NoExpander Link",text:"",styles:{backgroundColor:o,marginTop:z/2,width:(d+2*k)/2,cursor:"pointer",zIndex:1000}};var n={expander:{size:d,borderSize:k},icon:{size:z},link:{size:k,color:r,bgColor:o,style:v},label:{padding:A,cursor:"pointer",marginRight:5,marginLeft:B,borderRadius:0},layout:{btMargin:q,lrMargin:B},expandState:i,collapseState:b,asyncState:l,noExpandState:t,noExpandRoot:e};var w=u.extend({defaultOptions:{isEditable:false,expandAllAtInit:false,zoomFactor:100,hasFilterBox:false,isScrollable:true,UI:n,roots:[],nodeClass:c},init:function(D){this._parent(D);this._zoom=1;this._roots=[];this._modelEvents=new p();this.buildSkeleton();this._loadModel(this.options.roots);this._buildCustomView();this._buildScroller();this._listenEvents()},_clearAutoExpandAtDragTimeout:function(){if(this._toAutoExpandAtDrag){clearTimeout(this._toAutoExpandAtDrag);this._toAutoExpandAtDrag=null}},_listenEvents:function(){var D=this;j.Element.addEvent.call(this.elements.container,"mousewheel",function(G){var H=j.Event.wheelDelta(G);var F=G.shiftKey;if(F){if(Math.abs(H)===1){H=H*0.1}if(D._zoom+H>0.55&&D._zoom+H<10){D._zoom=D._zoom+H;D.setZoomFactor(D._zoom.toFixed(2))}}});if(this.options.isScrollable){var E=0;this._scroller.addEvent("onRefresh",function(){E++;if(E===2){D.elements.container.setStyle("width","auto");D.elements.container.getElement(".uwa-scroller").setStyle("width","auto")}if(E>=2){D.elements.container.getElement(".uwa-scroller").setStyle("width","auto")}})}},buildSkeleton:function(){var D=this;var E=this.elements;E.container=new j.Element("div",{"class":"WUX WUXTree",styles:{zoom:this.options.zoomFactor+"%",height:"100%",position:"relative"}});if(this.options.hasFilterBox){E.search=new j.Element("input",{type:"search",placeholder:"search in tree ...",styles:{backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 5px",border:"1px solid #FFF",marginLeft:12},events:{blur:function(F){D.search(E.search.value)},change:function(F){D.search(E.search.value)},keydown:function(F){D.search(E.search.value)}}});E.search.inject(E.container)}E.scrollContainer=new j.Element("div");E.scrollContainer.inject(E.container);E.treeAndGrid=new j.Element("ul",{"class":"Horizontal"});E.treeAndGrid.inject(E.scrollContainer);this.elements.treeContainer=new j.Element("li",{styles:{verticalAlign:"top",width:"100%"}});this.elements.treeContainer.inject(E.treeAndGrid);this._currentNodeID++;this._treeRoot=new this.options.nodeClass({isFakeRoot:true,isRoot:true,label:"Root",tree:this,UI:this.options.UI});this._treeRoot.inject(this.elements.treeContainer)},_buildCustomView:function(){},_buildScroller:function(){if(this.options.isScrollable){this._scroller=new j.Controls.Scroller(this.elements.scrollContainer,{momentum:true,scrollableX:false,scrollableY:true,scrollDrag:false})}},empty:function(){this.removeAllRoots()},addRoot:function(D){D.isRoot=true;D.tree=this;D.UI=this.options.UI;var E=this._createNode(D);E.getContent().addClassName("wux-tree-root");this._treeRoot.addChild(E);this._roots.push(E);this._updateRootsView(true);return E},removeRoot:function(D){D.getContent().destroy();var E=this._treeRoot._children.indexOf(D);if(E!==-1){this._treeRoot._children.splice(E,1);this._roots.splice(E,1)}},removeAllRoots:function(){var F=this.getRoots().length;for(var E=0;E<F;E++){var D=this.getNthRoot(0);this.removeRoot(D)}},_updateRootsView:function(){this._treeRoot.collapse();this._treeRoot.expand()},dump:function(D){return this._treeRoot.dump(D)},processNodes:function(D){this._treeRoot.processChildren(D)},toggle:function(){this.elements.container.toggle()},getRoots:function(){if(this._treeRoot.getChildren()){return this._treeRoot.getChildren()}else{return[]}},_getTrueRoot:function(){return this._treeRoot},getNthRoot:function(D){if(this._treeRoot.getChildren()){return this._getTrueRoot().getChildren()[D]}},setZoomFactor:function(D){this.options.zoomFactor=D;this._treeRoot.elements.container.setStyle("zoom",D)},_onUpdate:function(D){},_onPreExpand:function(D,E){},_onExpand:function(D,E){},_onPostExpand:function(D,E){},_onPreCollapse:function(D,E){},_onCollapse:function(D,E){},_onPostCollapse:function(D,E){},onExpand:function(D){return this._modelEvents.subscribe({event:"expand"},D)},onCollapse:function(D){return this._modelEvents.subscribe({event:"collapse"},D)},onNodeDragOver:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_OVER"},D)},onNodeDragStart:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_START"},D)},onNodeDragLeave:function(D){return this._modelEvents.subscribe({event:"NODE/DRAG_LEAVE"},D)},onNodePreDrop:function(D){return this._modelEvents.subscribe({event:"NODE/PRE_DROP"},D)},onNodeDrop:function(D){this._onDropCallBack=D},onNodePostDrop:function(D){return this._modelEvents.subscribe({event:"NODE/POST_DROP"},D)},onPreExpand:function(D){return this._modelEvents.subscribe({event:"preExpand"},D)},onPostExpand:function(D){return this._modelEvents.subscribe({event:"postExpand"},D)},onPreCollapse:function(D){return this._modelEvents.subscribe({event:"preCollapse"},D)},onPostCollapse:function(D){return this._modelEvents.subscribe({event:"postCollapse"},D)},onNodeClick:function(D){return this._modelEvents.subscribe({event:"click"},D)},onNodeDblClick:function(D){return this._modelEvents.subscribe({event:"dblClick"},D)},onLabelChange:function(D){this._modelEvents.subscribe({event:"UPDATE_LABEL"},D)},delegateEvents:function(D){},search:function(E){var D=this.getRoots();D.forEach(function(F){F.search(E)})},_createNode:function(D){return new this.options.nodeClass(D)},_loadModel:function(E){var F=this;function D(G,H,J){var I;J++;if(J===0){H.forEach(function(K){I=F.addRoot(K);D(I,K,J)})}else{if(H.children){H.children.forEach(function(K){I=F._createNode(K);G.addChild(I);D(I,K,J)})}}J--}D(this._treeRoot,E,-1)}});w.themes={"default":n};return j.namespace("WUX/Controls/TreeBase",w)});define("DS/Controls/Tree",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeBase","DS/Controls/TreeNode","DS/Selection/HSOManager","DS/Selection/CSOManager","DS/Utilities/Css","DS/Panels/SidePanel"],function(h,y,e,g,q,m,v,u,l){var p="#04C7F0";var n="transparent";var t="solid";var i=1;var d=p;var c="#FFF";var b=10;var k="EVT_TREE_IS_SHOWN";var x="EVT_TREE_PANEL_IS_HIDDEN";function s(z,B){if(z instanceof Function){if(B instanceof Function){return z.toString()===B.toString()}return false}if(z===null||z===undefined||B===null||B===undefined){return z===B}if(z===B||z.valueOf()===B.valueOf()){return true}if(z instanceof Date){return false}if(B instanceof Date){return false}if(!(z instanceof Object)){return false}if(!(B instanceof Object)){return false}var A=Object.keys(z);if(z.pathElement!==undefined&&B.pathElement!==undefined){return z.pathElement.isEqual(B.pathElement)}return Object.keys(B).every(function(C){return A.indexOf(C)!==-1})?A.every(function(C){return s(z[C],B[C])}):false}var f={"class":"Expander",text:"+",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var a={"class":"Expander",text:"",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var j={"class":"Expander",text:"",styles:{backgroundColor:c,borderColor:d,height:b,width:b,lineHeight:(b-2)+"px",cursor:"pointer",zIndex:1000}};var r={"class":"NoExpander Link",text:"",styles:{backgroundColor:n,borderTop:i+"px "+t+" "+p,width:b/2,cursor:"pointer",zIndex:1000}};var w={shadow:true,expander:{size:b},link:{size:i,color:p,bgColor:n,style:t},label:{borderRadius:1,padding:"2px 4px",verticalAlign:"middle",border:"1px solid rgba(255,255,255,0.5)",minHeight:"1em",lineHeight:"1em"},expandState:f,collapseState:a,asyncState:j,noExpandState:r};var o=g.extend({defaultOptions:{isEditable:false,nodeClass:q},init:function(z){z.UI=w;this._parent(z);this.elements.container.addClassName("wux-controls-tree");this._highlightedNodes=[];this._modeIsMultiSel=false;this._modeIsListSel=false;this._selectionManagement()},_selectNode:function(A,z){var B={pathElement:A.options.pathElement};if(z){v.unique(B);m.unique(B)}else{if(v.isIn(B)){v.remove(B);m.remove(B)}else{v.add(B);m.add(B)}}return B},_selectionManagement:function(){var E=this;var F=null,D=null,z=0;this._onNodeClickCB=function(J){z++;if(!D&&F&&E._modeIsListSel){D=J;E._selectNode(J)}if((!F||(F!==null&&D!==null))&&(z%2!==0)){F=J;D=null;z=1}if(E._modeIsMultiSel){E._selectNode(J)}else{if(E._modeIsListSel){D=J;var H=J.getParent();if(H){var I=false;H.getChildren().forEach(function(L,K){if(s(L.options.pathElement,F.options.pathElement)){I=true}if((I&&!s(L.options.pathElement,D.options.pathElement))){E._selectNode(L)}if(s(L.options.pathElement,D.options.pathElement)){I=false}})}}else{E._selectNode(J,true)}}};this._onNodeClickToken=this.onNodeClick(this._onNodeClickCB);var C;var A=function(I){var J=I.pathElement;var H=E._searchPathElement(J);if(H&&H.elements&&H.elements.label){C=u.recordState(H.elements.label,["box-shadow","font-weight","text-shadow"]);E._highlightedNodes.push(H);H._isHighlighted=true;H.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"})}};var B=function(I){var J=I.pathElement;var H=E._searchPathElement(J);if(H&&H.elements&&H.elements.label){H._isHighlighted=false;u.restoreState(H.elements.label,C,["box-shadow","font-weight","text-shadow"])}};function G(){if(E.getContent().offsetParent&&!E._panelIsHidden){E._highlightedNodes.forEach(function(I,H){E._highlightedNodes.splice(H,1);if(I.elements&&I.elements.label&&C){u.restoreState(I.elements.label,C,["box-shadow","font-weight","text-shadow"])}});v.get().forEach(A)}}E.onPostExpand(function(H){G()});E.onPostCollapse(function(H){G()});E._modelEvents.subscribe({event:k},function(){G()});v.onPostAdd(function(H){G()});v.onRemove(B)},_buildCustomView:function(){this._panelIsHidden=false;this._sidePanel=new l({side:"left"}).inject(this.elements.container);this._sidePanel.elements.container.setStyles({minHeight:0,minWidth:0});this._sidePanel.elements.content.setStyles({height:"100%",boxSizing:"border-box",backgroundColor:"transparent",padding:"0 5px",pointerEvents:"none"});this._sidePanel.elements.panel.setStyles({backgroundColor:"transparent",border:"none",pointerEvents:"none"});var A=this._sidePanel.appendChild(this.elements.scrollContainer);A.setStyles({height:"100%"});var z=this;this._sidePanel.onSlideIn(function(){z._panelIsHidden=false;z._modelEvents.publish({event:k,data:z})});this._sidePanel.onSlideOut(function(){z._panelIsHidden=true;z._modelEvents.publish({event:x,data:z})})},onPanelSlideIn:function(z){return this._modelEvents.subscribe({event:k},z)},onPanelSlideOut:function(z){return this._modelEvents.subscribe({event:x},z)},slideOut:function(){this._sidePanel.slideOut()},slideIn:function(){this._sidePanel.slideIn()},_getNodeClass:function(){return"TreeNode"},_searchPathElement:function(B,C){if(C===undefined){C=false}if(B){var z;var A=this.getRoots();A.forEach(function(D){function E(H){var F=0;var G=null;if(H.options.pathElement&&H.options.pathElement.isAParentOf(B)){if(C){H.expand(1)}if(H._children&&H._isExpanded){for(F=0;F<H._children.length&&!G;F++){G=E(H._children[F])}}if(!G){G=H}}return G}z=D;z=E(D)});return z}}});return h.namespace("WUX/Controls/Tree",o)});define("DS/Controls/SelectionChips",["UWA/Core","UWA/Class","UWA/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","i18n!DS/Controls/assets/nls/translation"],function(d,v,e,t,g,w,p,s){var i=false;function u(){this._preventEventsCpt++}function o(){this._preventEventsCpt--}function q(z){var y=false;this._items.forEach(function(B){var A=B.associatedChipCellView;if(B.isSelected){if(!A.isHighlighted){A.isHighlighted=true;y=true;A.addClassName("wux-ui-state-highlighted")}}else{if(A.isHighlighted){A.isHighlighted=false;y=true;A.removeClassName("wux-ui-state-highlighted")}}});if(y&&this._preventEventsCpt===0){this.fire("selectionChange")}}function k(D,A){var B=A.currentStyle||window.getComputedStyle(A,null),z=parseInt(B.borderLeftWidth,10),C=A.getBoundingClientRect(),y=D.clientX-z-C.left;return y}function r(B,A){B=B||window.event;var z=k.call(this,B,A);var y=A.getDimensions().width*1/4;if(z<y){return"left"}return"right"}function f(z){var y={chipCellView:undefined,dropPosition:""};y.chipCellView=w.firstParentWithClass(z.target,"wux-chip-cell-container");if(y.chipCellView===undefined){return y}if(z.type==="dragstart"||z.type==="dragover"||z.type==="dragenter"||z.type==="dragleave"||z.type==="drop"){y.dropPosition=r.call(this,z,y.chipCellView)}return y}function n(C){var y=this;var B={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var A=B[C.type];h.call(this);this._currentDnDInfos=f.call(this,C);j.call(this);function z(G,D){var H=true;var E=y[G+D];if(E){H=E.call(y,C,y._currentDnDInfos);if(i&&G!=="onDragOver"){console.info("[dnd]",G+D,">",H,C.target)}}else{if(i){console.warn("[dnd]","cannot find",G+D,"callback")}}if(H){var F=y[G+D+"Default"];if(F){if(i){if(E&&H){console.info("\t>[dnd]","dev want to continue to the default behavior for ",G+D," callback")}else{console.info("\t>[dnd]","use the default behavior for ",G+D," callback")}}F.call(y,C,y._currentDnDInfos)}}}if(this._currentDnDInfos.chipCellView){z(A,"Cell")}else{z(A,"Blank")}}function j(y,z){if(this._currentDnDInfos){if(this._currentDnDInfos.chipCellView){var z=this._currentDnDInfos.dropPosition;if(z==="left"){this._currentDnDInfos.activeSeparator=this._currentDnDInfos.chipCellView.dndFeedbackBefore}else{if(z==="right"){this._currentDnDInfos.activeSeparator=this._currentDnDInfos.chipCellView.dndFeedbackAfter}}}else{if(this._items.length>0){this._currentDnDInfos.activeSeparator=this._items[this._items.length-1].associatedChipCellView.dndFeedbackAfter}}if(this._currentDnDInfos.activeSeparator){this._currentDnDInfos.activeSeparator.setAttribute("is-active",true)}}}function h(){if(this._currentDnDInfos&&this._currentDnDInfos.activeSeparator){this._currentDnDInfos.activeSeparator.removeAttribute("is-active");this._currentDnDInfos=undefined}}function x(z,y){y=d.extend({source:{uuid:this._uuid,amd:"DS/Controls/SelectionChips"},data:{"dswebux/x-controls.selectionchips.data+json":""}},y);z.dataTransfer.setData("Text",JSON.stringify(y))}function b(y){var z=y.dataTransfer.getData("Text");try{return JSON.parse(z)}catch(y){console.warn('the element being in dataTransfer type "text" is not parsable usable JSON.parse')}}function a(y,z){var C=this;var B=new d.Element("div",{"class":"wux-chip-cell-container"});B.isHighlighted=false;B.associatedModelItem=z;B.label=new d.Element("li",{"class":"wux-chip-cell-label",text:z.chipOptions.label,title:z.chipOptions.label});B.appendChild(B.label);var A=new d.Element("li",{"class":"wux-chip-cell-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong"});B.appendChild(A);var D=true;B.addEvent(g.POINTERDOWN,function(E){D=z.isSelected;if(!z.isSelected){C._modifierKeysPressed=E.ctrlKey||E.shiftKey;w._pushUserInteractionContext();C.selectChip(z);w._popUserInteractionContext();C._modifierKeysPressed=false}});B.addEvent(g.POINTERUP,function(E){if(D&&z.isSelected){C._modifierKeysPressed=E.ctrlKey||E.shiftKey;w._pushUserInteractionContext();C.unselectChip(z);w._popUserInteractionContext();C._modifierKeysPressed=false}});B.addEvent("mouseenter",function(E){D=false;B.addClassName("wux-ui-state-prehighlighted")});B.addEvent("mouseleave",function(E){B.removeClassName("wux-ui-state-prehighlighted")});A.addEvent(g.POINTERDOWN,function(E){E.preventDefault();E.stopPropagation()});A.addEvent(g.POINTERUP,function(E){w._pushUserInteractionContext();C.removeChip(z.chipOptions.label);w._popUserInteractionContext()});B.setAttribute("draggable","true");return B}function m(A){var z={chipOptions:A,isSelected:false,associatedChipCellView:undefined};var y=new d.Element("ul",{"class":"wux-chip-cell-main-container"});var B=a.call(this,y,z);var C=new d.Element("span",{"class":"wux-chip-cell-drop-feedback"});var D=new d.Element("span",{"class":"wux-chip-cell-drop-feedback"});y.appendChild(C);y.appendChild(B);y.appendChild(D);z.associatedChipCellView=B;B.chipCellViewMainContainer=y;B.dndFeedbackBefore=C;B.dndFeedbackAfter=D;return{modelItem:z,chipCellView:B}}function l(C,G){var B=false;u.call(this);var z=b.call(this,C);if(z){var D=z.source.uuid;var I=G.chipCellView?G.chipCellView.associatedModelItem:undefined;if(this._uuid!==D||!I||!I.isSelected){var E=z.data["dswebux/x-controls.selectionchips.items+json"];var J=G.dropPosition;var F=this;if(this._uuid===D){for(var H=0;H<this._items.length;){if(this._items[H].isSelected){F.removeChip(H)}else{H++}}}if(E){var A=this._items.indexOf(I);var y=undefined;if(J==="left"){y=A!==-1?A:0}else{if(J==="right"){y=A!==-1?A+1:0}}E.forEach(function(L){B=true;F._onDragAndDropFlag=true;if(F._lastWidgetDiv.children.length>0&&y===undefined){L.index=F._items.length}else{L.index=y}var K=F.addChip(L);K.isSelected=true});q.call(this)}}}h.call(this);o.call(this);if(B&&this._preventEventsCpt===0){this.fire("change")}}var c=t.inherit({publishedProperties:{selection:{defaultValue:{toggle:true,mode:2,unselectAllOnEmptyArea:true},type:"object",category:"Behavior",noNeedToApplyFlag:true},shape:{defaultValue:0,type:"enum",category:"Appearance"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},onDragStartCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEndCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragOverCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEnterCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragLeaveCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDropCell:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDropBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragLeaveBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragOverBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true},onDragEnterBlank:{defaultValue:undefined,type:"function",category:"Behavior",noNeedToApplyFlag:true}},_build:function(){this._parent();this._uuid=e.getUUID();this._preventEventsCpt=0;this.elements.container=new d.Element("div",{"class":"wux-controls-selectionChips"});this._placeholderDiv=new d.Element("div",{"class":"wux-controls-placeholder-selectionChips",text:this.placeholder}).inject(this.elements.container);this._clearAllDiv=new d.Element("div",{"class":"wux-controls-clear-selectionChips wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"}).inject(this.elements.container);this._lastWidgetDiv=new d.Element("div",{"class":"wux-controls-lastWidget-selectionChips"});this._items=[]},handleEvents:function(){var y=this;var z=n.bind(this);this.getContent().addEvent("dragstart",z);this.getContent().addEvent("drop",z);this.getContent().addEvent("dragover",z);this.getContent().addEvent("drag",z);this.getContent().addEvent("dragend",z);this.getContent().addEvent("dragleave",z);this.getContent().addEvent("dragenter",z);this._clearAllDiv.addEventListener(g.POINTERUP,function(B){var A=document.createEvent("HTMLEvents");A.initEvent("contextmenu",true,false);A.pageX=B.pageX;A.pageY=B.pageY;y.getContent().dispatchEvent(A)});p.addEventListener(this.getContent(),{callback:function(B){var A=[];A.push({type:"PushItem",title:s.clearAll,action:{callback:function(C){y.removeAllChips()}}});return A}});this.getContent().addEvent(g.POINTERDOWN,function(A){if(y.selection.unselectAllOnEmptyArea&&A.target.className.indexOf("wux-chip-cell-container")===-1&&A.target.className.indexOf("wux-chip-cell-label")===-1&&A.target.className.indexOf("wux-chip-cell-close")===-1){y.unselectAllChips(true)}});this._modifierKeysPressed=false},isInMultiSelection:function(){return this.selection.mode===c.SELECTION_MODE.MULTIPLE||this.selection.mode===c.SELECTION_MODE.MULTIPLE_ONKEYS&&this._modifierKeysPressed},_applyShape:function(y){this.elements.container.setAttribute("chip-shape",this.shape)},_applyPlaceholder:function(y){this._placeholderDiv.setText(this.placeholder)},_applyProperties:function(y){this._parent(y);if(this.isDirty("shape")){this._applyShape(y.shape)}if(this.isDirty("placeholder")){this._applyPlaceholder(y.placeholder)}},selectChip:function(z){var y=undefined;if(typeof z==="string"){this._items.some(function(A){if(A.chipOptions.label===z){y=A;return true}return false})}else{if(typeof z==="number"){if(z>=0&&z<this._items.length){y=this._items[z]}}else{y=z}}if(y!==undefined){if(!this.isInMultiSelection()){this._items.forEach(function(A){A.isSelected=false})}y.isSelected=true;q.call(this)}},selectAllChips:function(){if(!this.isInMultiSelection()){return}this._items.forEach(function(y){y.isSelected=true});q.call(this)},unselectChip:function(y){if(!this.selection.toggle&&!this.isInMultiSelection()){return}var z=undefined;if(typeof y==="string"){this._items.some(function(A){if(A.chipOptions.label===y){z=A;return true}return false})}else{if(typeof y==="number"){if(y>=0&&y<this._items.length){z=this._items[y]}}else{z=y}}if(z!==undefined){z.isSelected=false;q.call(this)}},unselectAllChips:function(){if(!this.selection.toggle&&!this.isInMultiSelection()&&!arguments&&!arguments[0]){return}this._items.forEach(function(y){y.isSelected=false});q.call(this)},addChip:function(z){if(!z){return}var A=undefined;if(typeof z==="string"){A={label:z}}else{if(typeof z==="object"){A=Object.assign({},z)}}if(!A||!A.label){return}if(A.index===undefined){A.index=this.elements.container.children.length}if(A.index<0||A.index>this.elements.container.children.length+1){return}var y=m.call(this,A);this._items.splice(A.index,0,y.modelItem);this._placeholderDiv.remove();if(A.index===this.elements.container.children.length){this.elements.container.appendChild(y.chipCellView.chipCellViewMainContainer)}else{this.elements.container.insertBefore(y.chipCellView.chipCellViewMainContainer,this.elements.container.children[A.index+1])}if(this._lastWidgetDiv.children.length>0&&!this._onDragAndDropFlag){this.elements.container.insertBefore(this._lastWidgetDiv,this.elements.container.children[A.index+1])}if(this._preventEventsCpt===0){this.fire("change")}return y.modelItem},addLastWidget:function(y){if(!y){return}if(this._placeholderDiv){this._placeholderDiv.remove()}this.elements.container.appendChild(this._lastWidgetDiv);this._lastWidgetDiv.setContent(y)},removeLastWidget:function(){if(!this._lastWidgetDiv.children.length){return}this._lastWidgetDiv.removeChild(this._lastWidgetDiv.firstChild)},removeAllContent:function(){if(!this._items.length>0){return}this._items=[];this.getContent().empty()},removeChip:function(C){var B=false;var y=undefined;if(typeof C==="string"){var A=this;this._items.some(function(E,D){if(E.chipOptions.label===C){A._items.splice(D,1);A.elements.container.removeChild(E.associatedChipCellView.chipCellViewMainContainer);y=E;B=true;return true}return false})}else{if(typeof C==="number"){if(C>=0&&C<this._items.length){var z=this._items.splice(C,1)[0];this.elements.container.removeChild(z.associatedChipCellView.chipCellViewMainContainer);y=z;B=true}}}if(this._items.length===0){if(this._lastWidgetDiv.children.length==0){this.getContent().insertBefore(this._placeholderDiv,this._clearAllDiv)}}if(B&&this._preventEventsCpt===0){this.fire("change")}return y},removeAllChips:function(){if(!this._items.length>0){return}this._items=[];this.getContent().empty();if(this._lastWidgetDiv.children.length==0){this._placeholderDiv.inject(this.getContent());this._clearAllDiv.inject(this.getContent())}else{this._lastWidgetDiv.inject(this.getContent())}if(this._preventEventsCpt===0){this.fire("change")}},updateChipOptions:function(D,y){var C=false;if(D===undefined||!y){return}var B=undefined;if(typeof y==="string"){B={label:y}}else{if(typeof y==="object"){B=Object.assign({},y)}}if(!B){return}var A=undefined;if(typeof D==="string"){this._items.some(function(F,E){if(F.chipOptions.label===D){A=F;return true}return false})}else{if(typeof D==="number"){if(D>=0&&D<this._items.length){A=this._items[D]}}}if(A!==undefined){var z=A.chipOptions;d.merge(B,z);A.chipOptions=B;var C=false;if(z.label!==B.label){A.associatedChipCellView.label.textContent=B.label;C=true}if(z.icon!==B.icon){}if(z.index!==B.index){this._items.splice(z.index,1);A.associatedChipCellView.chipCellViewMainContainer.remove();this._items.splice(B.index,0,A);this.elements.container.insertBefore(A.associatedChipCellView.chipCellViewMainContainer,this.elements.container.children[B.index+1]);C=true}if(C&&this._preventEventsCpt===0){this.fire("change")}}},getChipLabel:function(y){if(y>=0&&y<this._items.length){return this._items[y].chipOptions.label}return""},getChipPosition:function(y){var z=-1;this._items.some(function(B,A){if(B.chipOptions.label===y){z=A;return true}return false});return z},getAllChipsOptions:function(){var y=[];this._items.forEach(function(z){y.push(Object.assign({},z.chipOptions))});return y},getSelectedChipsOptions:function(){var y=[];this._items.forEach(function(z){if(z.isSelected){y.push(Object.assign({},z.chipOptions))}});return y},onDragStartCellDefault:function(A,z){var y=[];this._items.forEach(function(B){if(B.isSelected){y.unshift(B.chipOptions)}});x.call(this,A,{data:{"dswebux/x-controls.selectionchips.items+json":y}});A.dataTransfer.effectAllowed="move"},onDragEndCellDefault:function(z,y){},onDragOverCellDefault:function(z,y){z.preventDefault()},onDragEnterCellDefault:function(z,y){z.preventDefault()},onDragLeaveCellDefault:function(z,y){h.call(this);return true},onDropCellDefault:function(z,y){z.preventDefault();l.call(this,z,y)},onDropBlankDefault:function(z,y){l.call(this,z,y)},onDragLeaveBlankDefault:function(z,y){h.call(this)},onDragOverBlankDefault:function(z,y){z.preventDefault()},onDragEnterBlankDefault:function(z,y){z.preventDefault()}});c.SHAPE={RECTANGULAR:0,OVAL:1};c.SELECTION_MODE={SINGLE:0,MULTIPLE:1,MULTIPLE_ONKEYS:2};return c});define("DS/Controls/SearchEditor",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/SelectionChips","DS/Controls/LineEditor","DS/Controls/Popup"],function(g,a,f,d,c,e){var b=f.inherit({name:"searchEditor",publishedProperties:{multiSearchMode:{defaultValue:false,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-searchEditor");this.elements.container.setAttribute("tabindex",0);this._editor=new c({placeholder:"Search...",displayStyle:"lite",});this._editor.getContent().addClassName("wux-controls-searchEditor-editor");this._editor.inject(this.elements.container)},handleEvents:function(){var h=this;a.addEventOnElement(this,this._editor,"change",function(i){if(h.multiSearchMode){if(h._editor.value!=""){h._selectionChips.addChip({label:h._editor.value});h._editor.value=""}}});if(this._selectionChips){a.addEventOnElement(this,this._selectionChips,"change",function(i){if(h.multiSearchMode){if(!h._selectionChips.getAllChipsOptions().length){h._selectionChips.addLastWidget(h._editor)}}})}},_applyProperties:function(h){this._parent(h);if(this.isDirty("multiSearchMode")){this._applyMultiSearchMode(h.value)}},_applyMultiSearchMode:function(h){this._editor.value="";if(!this.multiSearchMode){if(this._selectionChips){this._selectionChips._clearAllDiv.remove();this._selectionChips.removeAllChips()}}else{if(!this._selectionChips){this._selectionChips=new d({}).inject(this.elements.container);this._selectionChips.addLastWidget(this._editor);this._selectionChips.getContent().addClassName("wux-controls-searchEditor-mainelement")}}},_showPopup:function(){},_buildPopup:function(){},getAllSelectedValues:function(){var h=[];if(this.multiSearchMode){this._selectionChips._items.forEach(function(i){h.push(i.chipOptions.label)})}else{h.push(this._editor.value)}return h}});return b});define("DS/Controls/Expander",["UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Utilities/Utils"],function(c,d,a,b,h,f){function j(){if(this.elements.icon){this.elements.icon.remove(this.elements.iconPlaceholder);delete this.elements.icon}var l=a.generateIcon(this.icon);if(l){this.elements.icon=l;this.elements.iconPlaceholder.show();this.elements.icon.style.pointerEvents="none";this.elements.icon.style.margin="0px";this.elements.icon.inject(this.elements.iconPlaceholder)}else{this.elements.iconPlaceholder.hide()}}function i(){var l=2;if(this._getCurrentTouchMode()){l+=38;if(this.elements.icon){l+=14+5}}else{l+=26;if(this.elements.icon){l+=12+5}}return l}function k(){return this._getCurrentTouchMode()?38:26}var e;var g=d.inherit({name:"expander",markForRecordFlag:true,publishedProperties:{header:{defaultValue:"",type:"string",category:"Appearance"},body:{defaultValue:undefined,type:"object",category:"Behavior"},expandedFlag:{defaultValue:false,type:"boolean",category:"Appearance",recordFlag:true},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},height:{defaultValue:"auto",type:"string",category:"Appearance"},orientation:{defaultValue:"vertical",type:"string",category:"Behavior"},customHeader:{defaultValue:undefined,type:Object,category:"Behavior"},allowUnsafeHTMLHeader:{defaultValue:undefined,type:"boolean",category:"Behavior"}},keymaps:{space:{keydown:"consume",keyup:"toggle"}},commands:{consume:function(){},toggle:function(){if(!this.disabled){this.toggle()}}},_expanderClass:"wux-controls-expander",buildView:function(){this.elements.container.addClassName(this._expanderClass+"-placeholder");b.setElementRecordMode(this.elements.container,h.RecordModes.DEFAULT_AND_CHILD);this.elements.expanderContainer=new c.Element("div",{"class":this._expanderClass+"-container"}).inject(this.elements.container);this.elements.header=new c.Element("div",{"class":this._expanderClass+"-header",tabindex:0}).inject(this.elements.expanderContainer);this.elements.headerArrow=new c.Element("div",{"class":this._expanderClass+"-arrow wux-ui-3ds wux-ui-3ds-expand-down"}).inject(this.elements.header);this.elements.iconPlaceholder=new c.Element("div",{"class":"wux-expander-icon-placeholder"}).inject(this.elements.header);this.elements.headerContainer=new c.Element("div",{"class":this._expanderClass+"-header-container"}).inject(this.elements.header);this.elements.bodyContainer=new c.Element("div",{"class":this._expanderClass+"-body"}).inject(this.elements.expanderContainer)},handleEvents:function(){var m=this;var l,n;a.addEventOnElement(this,this.elements.header,"blur",function(o){m.getContent().removeClassName("wux-isMouseFocused")});a.addEventOnElement(this,this.elements.header,"click",function(o){o.preventDefault();if(m.disabled!==true){m.getContent().addClassName("wux-isMouseFocused");m.setPropertyFromUIInteraction("expandedFlag",!m.expandedFlag)}});a.addEventOnElement(this,this.elements.bodyContainer,"transitionend",function(o){m.fire("dimensionsChanged")})},_applyExpandedFlag:function(l){if(!l||l!=this.expandedFlag){(this.expandedFlag===true)?this._expand():this._close()}if(this.height==="100%"&&this.expandedFlag){this.elements.expanderContainer.setStyle("height","100%")}else{this.elements.expanderContainer.setStyle("height","")}},_applyHeader:function(){if(!f.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLHeader)){this.elements.headerContainer.innerHTML="";var l=new c.Element("h5",{"class":"headerTitle"});l.textContent=this.header;l.inject(this.elements.headerContainer)}else{this.elements.headerContainer.innerHTML='<h5 class="headerTitle" >'+this.header+" </h5> "}},_applyBody:function(l){if(this.body!==undefined&&this.elements.bodyContainer!==undefined){if(l){l.remove()}if(c.is(this.body,"element")){this.body=new c.extendElement(this.body)}this.body.inject(this.elements.bodyContainer)}},_applyTouchMode:function(){this._parent();var l=this._getCurrentTouchMode();if(l===true){this.elements.header.setAttributeNode(document.createAttribute("touch-mode"));this.elements.headerContainer.setAttributeNode(document.createAttribute("touch-mode"));this.elements.headerArrow.setAttributeNode(document.createAttribute("touch-mode"));this.elements.bodyContainer.setAttributeNode(document.createAttribute("touch-mode"));this.elements.iconPlaceholder.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.header.removeAttribute("touch-mode");this.elements.headerArrow.removeAttribute("touch-mode");this.elements.headerContainer.removeAttribute("touch-mode");this.elements.bodyContainer.removeAttribute("touch-mode");this.elements.iconPlaceholder.removeAttribute("touch-mode")}},_applyStyle:function(l){if(l){this.elements.expanderContainer.removeClassName(this._expanderClass+"-"+l)}this.elements.expanderContainer.addClassName(this._expanderClass+"-"+this.style);if(this.style==="mode-selector"){this.elements.iconPlaceholder.inject(this.elements.headerArrow,"before");this.elements.headerContainer.inject(this.elements.iconPlaceholder,"before")}},_applyOrientation:function(l){if(this.orientation==="horizontal"){this.elements.expanderContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.bodyContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.headerContainer.setAttributeNode(document.createAttribute("horizontal"));this.elements.header.setAttributeNode(document.createAttribute("horizontal"));if(this.expandedFlag){if(this.style!=="mode-selector"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")}}this.elements.bodyContainer.style.maxWidth="calc(100% - "+(20+i.call(this))+"px)";this.elements.bodyContainer.style.maxHeight=""}else{this.elements.expanderContainer.removeAttribute("horizontal");this.elements.bodyContainer.removeAttribute("horizontal");this.elements.headerContainer.removeAttribute("horizontal");this.elements.header.removeAttribute("horizontal");if(this.expandedFlag){if(this.style!=="mode-selector"){this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")}else{this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")}}this.elements.bodyContainer.style.maxWidth=""}this._applyHeight()},_applyHeight:function(l){if(this.height==="auto"&&this.orientation==="horizontal"){this.elements.container.setStyles({position:"absolute",height:"auto",top:0,bottom:0})}else{this.elements.container.setStyles({position:"",height:this.height})}if(this.orientation==="vertical"){if(this.height==="100%"){this.elements.bodyContainer.style.maxHeight="calc( 100% - "+(20+k.call(this))+"px)";this._applyExpandedFlag()}else{this.elements.bodyContainer.style.maxHeight="calc("+parseInt(this.height)+"px - "+(20+k.call(this))+"px)"}}},_applyIcon:function(l){if(typeof(this.icon)==="object"){if(!this.icon.iconClasses){this.icon.iconClasses=""}if(!this.icon.iconName){this.icon.iconName=""}if(!this.icon.fontIconFamily){this.icon.fontIconFamily=WUXManagedFontIcons.FontAwesome}if(!this.icon.fontIconSize){this.icon.fontIconSize="1x"}}j.call(this);if(this.orientation==="horizontal"){this.elements.bodyContainer.style.maxWidth="calc(100% - "+i.call(this)+"px)"}},_applyCustomHeader:function(l){if(this.elements.customHeader!=undefined&&this.elements.customHeader!=null){this.elements.customHeader.remove(l)}if(this.customHeader!=null&&this.customHeader!=undefined){if(this.elements.customHeader==undefined||this.elements.customHeader==null){this.elements.customHeader=new c.Element("div",{"class":this._expanderClass+"-customHeader"}).inject(this.elements.header)}this.customHeader.inject(this.elements.customHeader)}},_applyAllowUnsafeHTMLHeader:function(){this._applyHeader()},_applyProperties:function(l){this._parent(l);this._applyExpandedFlag();if(this.isDirty("header")||this.isDirty("allowUnsafeHTMLHeader")){this._applyHeader()}this._applyBody(l.body);this._applyStyle();this._applyIcon();this._applyOrientation();this._applyCustomHeader()},_expand:function(){this.elements.header.setAttributeNode(document.createAttribute("expanded"));this.elements.expanderContainer.addClassName(this._expanderClass+"-toggle");this.elements.bodyContainer.addClassName(this._expanderClass+"-body-toggle");if(this.style!=="mode-selector"){this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-right");if(this.orientation==="horizontal"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")}}else{this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")}this.elements.bodyContainer.style.overflow="";this.fire("expand")},_close:function(){this.elements.header.removeAttribute("expanded");this.elements.expanderContainer.removeClassName(this._expanderClass+"-toggle");this.elements.bodyContainer.removeClassName(this._expanderClass+"-body-toggle");if(this.style!=="mode-selector"){this.elements.headerArrow.addClassName("wux-ui-3ds-expand-right");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left")}else{this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down");this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-up")}this.elements.bodyContainer.style.overflow="hidden";this.fire("collapse")},expand:function(){this.expandedFlag=true},close:function(){this.expandedFlag=false},toggle:function(){(this.expandedFlag===true)?this.close():this.expand()}});b.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Controls/Accordeon",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/CoreEvents/ModelEvents","DS/Utilities/Css","DS/Core/PointerEvents","DS/Controls/Expander","DS/Utilities/Dom"],function(d,k,f,h,b,c,e,i,a){var g="EVT_CHANGE";var j=f.inherit({name:"accordeon",publishedProperties:{items:{defaultValue:[],type:"array",category:"Behavior"},exclusive:{defaultValue:true,type:"boolean",category:"Behavior"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"}},_accordeonClass:"wux-controls-accordeon",buildView:function(){var l=this;this.elements.container.addClassName(this._accordeonClass+"-container");this._expanderItems=[]},handleEvents:function(){var n=this;var m,o;a.addEventOnElement(this,document,e.POINTERUP,function(p){clearTimeout(o);clearInterval(m)});this._applyExclusive();function l(p){if(p.dsModel===n){return}p.stopImmediatePropagation();if(p.dsModel){n._expanderItems.every(function(r,q){if(r===p.dsModel){n.fire(p.type,{expanderIndex:q,expanderTarget:r});return false}else{return true}})}}this.addEventListener("expand",l);this.addEventListener("collapse",l)},_applyProperties:function(l){this._parent(l);this._applyItems();this._applyStyle()},_applyTouchMode:function(){var l=this._getCurrentTouchMode();if(l===true){this.getContent().setAttributeNode(document.createAttribute("touch-mode"))}else{this.getContent().removeAttribute("touch-mode")}for(var m=0;m<this._expanderItems.length;m++){this._expanderItems[m].touchMode=l}},_applyDisabled:function(){for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].disabled=this.disabled}},_applyItems:function(){var m=this;for(var l=m._expanderItems.length;l>=0;l--){if(this._expanderItems[l]){this._expanderItems[l].remove()}this._expanderItems.splice(l,1)}m.items.forEach(function(n){m._addItem(n)})},_applyExclusive:function(){var m=this;for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].elements.header.addEvent(e.POINTERUP,function(o){for(var n=0;n<m._expanderItems.length;n++){if(m._expanderItems[n].elements.container.attributes&&m._expanderItems[n].elements.header!=this){if(m.exclusive&&m._expanderItems[n].expandedFlag===true){m._expanderItems[n].close()}}}})}},_applyStyle:function(){for(var l=0;l<this._expanderItems.length;l++){this._expanderItems[l].style=this.style}},addItem:function(l){this.items.push(l);return this._addItem(l)},_addItem:function(l){this.elements.expander=new i({header:l.header,body:l.body?l.body:l.content,icon:l.icon,customHeader:l.customHeader,style:this.style,recId:l.recId,touchMode:this._getCurrentTouchMode()}).inject(this.elements.container);var m=this._getFirstUnusedID();this.elements.expander._expanderId=m;this.elements.expander.elements.container.attributes.identifier=m;this._expanderItems.push(this.elements.expander);if(this.exclusive){this._applyExclusive()}if(l.expandedFlag){this.expandItem(this.getIndexFromId(m))}return m},deleteItem:function(l){if(this._expanderItems[l]){this._expanderItems[l].remove()}this._expanderItems.splice(l,1);this.items.splice(l,1)},_getFirstUnusedID:function(){var n=[];for(var m=0;m<this._expanderItems.length;m++){n[this._expanderItems[m]._expanderId]=1}for(var l=0;l<n.length;l++){if(n[l]!==1){return l}}return n.length},updateItem:function(l,n){var m=this.items[l];if(m){m.header=n.header||m.header;m.body=n.body||m.body;m.icon=n.icon||m.icon;m.customHeader=n.customHeader||m.customHeader}var o=this._expanderItems[l];if(o){o.setProperties(m)}},expandItem:function(l){if(this.exclusive){for(var m=0;m<this._expanderItems.length;m++){if(l!=m){if(this._expanderItems[m].expandedFlag===true){this._expanderItems[m].close()}}}}this._expanderItems[l].expand()},closeItem:function(l){this._expanderItems[l].close()},clear:function(){while(this.items.length>0){this.deleteItem(0)}},getIndexFromId:function(m){for(var l=0;l<this._expanderItems.length;l++){if(this._expanderItems[l]._expanderId===m){return l}}return -1},getExpanderFromIndex:function(l){return this._expanderItems[l]}});return j});define("DS/Controls/TileView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/UIBehaviors/SwipeableMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],function(b,f,a,g,i,e,h,d){var c=g.extend({defaultOptions:{size:"small",view:"tile",picture:{size:"cover",width:null,position:"center center"}},init:function(k){this._parent(k);this._isHighlighted=false;this.elements.container=new b.Element("div",{"class":"wux-controls-tileview wux-ui-size-"+this.options.size,styles:{padding:0}});this.elements.thumbnail=new b.Element("div",{"class":"wux-controls-tileview-container wux-ui-size-"+this.options.size,styles:{border:"none",margin:0}});var j=undefined;this.options.useSwipableMenu=true;if(k.gridEngine&&k.gridEngine.options.useSwipableMenu===false){this.options.useSwipableMenu=false;this.elements.thumbnail.inject(this.elements.container)}else{var j=new i({target:this.elements.thumbnail,menu:this.options.menu});j.getContent().setStyles({lineHeight:"60px",overflow:"visible"}).inject(this.elements.container)}this.elements.picture=new b.Element("div",{"class":"wux-controls-tileview-picture",styles:{backgroundImage:"",width:this.options.picture.width?this.options.picture.width:"",backgroundSize:this.options.picture.size,backgroundPosition:this.options.picture.position}}).inject(this.elements.thumbnail);this.elements.checkbox=new h({checkFlag:false,disabled:false}).inject(this.elements.picture);this.elements.checkbox.getContent().addClassName("wux-controls-tileview-checkbox wux-ui-size-"+this.options.size);var l=this;this.elements.container.addEvent("mouseenter",function(m){if(!l.isPreHighlighted){l.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted");l.isPreHighlighted=true}});this.elements.container.addEvent("mouseleave",function(m){if(l.isPreHighlighted){l.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted");l.isPreHighlighted=false}});this.elements.checkbox.addEventListener(e.POINTERDOWN,function(m){m.stopPropagation()});this.elements.checkbox.addEventListener(e.POINTERUP,function(m){m.stopPropagation()});this._listenToChanges=true;this.elements.checkbox.addEventListener("change",function(m){if(l._listenToChanges){if(!l.isHighlighted()){l.highlight()}else{l.unhighlight()}}});this.elements.cartouche=new b.Element("div",{"class":"wux-controls-tileview-cartouche",styles:{left:this.options.picture.width?this.options.picture.width:""}}).inject(this.elements.thumbnail);this.elements.cartoucheContent=new b.Element("div",{"class":"wux-controls-tileview-cartouche-content"}).inject(this.elements.cartouche);this.elements.icon=new b.Element("div",{"class":"wux-controls-tileview-icon wux-ui-size-"+this.options.size,styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent);this.elements.badgeTopRight=new b.Element("div",{"class":"wux-controls-tileview-badge-top-right"}).inject(this.elements.cartoucheContent);this.elements.badgeBottomRight=new b.Element("div",{"class":"wux-controls-tileview-badge-bottom-right"}).inject(this.elements.cartoucheContent);this.elements.color=new b.Element("div",{"class":"wux-controls-tileview-color"}).inject(this.elements.container);this.elements.colorBlank=new b.Element("div",{"class":"wux-controls-tileview-colorBlank"}).inject(this.elements.container);this.elements.title=new b.Element("div",{"class":"wux-controls-tileview-title wux-font-3dsregular"}).inject(this.elements.cartoucheContent);this.elements.subtitle=new b.Element("div",{"class":"wux-controls-tileview-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent);this.elements.menu=new b.Element("div",{"class":"wux-controls-tileview-menu wux-ui-size-"+this.options.size}).inject(this.elements.cartoucheContent);this.elements.menu.addClassName("wux-ui-3ds");this.elements.menu.addClassName("wux-ui-3ds-open-down");this.elements.description=new b.Element("div",{"class":"wux-controls-tileview-description",html:"Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the ..."}).inject(this.elements.cartoucheContent);this.elements.menu.addEvent(e.POINTERDOWN,function(n){n.preventDefault();var p=this;var m=p.cellView;if(m){var o=m.getCellInfos();if(o.cellModel&&o.cellModel.isSelected()){n.stopPropagation()}}if(l.options.useSwipableMenu===true){j._indexPositions()}});this.elements.menu.addEvent(e.POINTERUP,function(m){m.preventDefault();if(l.options.useSwipableMenu===true){j.toggle()}});this.setColor(this.options.color);this.setIcon(this.options.icon);this._attachEvents()},setIcon:function(j){this.elements.icon.className="";this.elements.icon.addClassName("wux-controls-tileview-icon wux-ui-size-"+this.options.size);if(j){this.elements.container.setAttribute("has-icon","true");this.elements.icon.setAttribute("has-icon","true");d.generateIcon(j,{target:this.elements.icon});this.elements.icon.show()}else{this.elements.container.setAttribute("has-icon","false");this.elements.icon.setAttribute("has-icon","false");this.elements.icon.hide()}},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=true;this.elements.container.addClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==true){this._listenToChanges=false;this.elements.checkbox.checkFlag=true;this._listenToChanges=true}},unhighlight:function(){this._isHighlighted=false;this.elements.container.removeClassName("wux-ui-state-highlighted");this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted");if(this.elements.checkbox.checkFlag!==false){this._listenToChanges=false;this.elements.checkbox.checkFlag=false;this._listenToChanges=true}},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}});return c});define("DS/Controls/TileCellView",["UWA/Core","DS/Controls/TileView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Utilities/Dom"],function(b,d,a,i,f,g,e){function h(j){return j.charAt(0).toUpperCase()+j.slice(1)}var c=a.extend({defaultOptions:{size:"small",menu:[]},init:function(k){var m=k.menu;k.menu=[];this._CtxMenuByRightClick=true;this._parent(k);this.elements.container.setStyles({border:"none"});this.elements.container.setAttribute("draggable","true");this.elements.container.dsView=this;this._view=new d(this.options).inject(this.elements.container);this._view.elements.menu.cellView=this;var l=this;this._view.elements.checkbox.addEventListener(f.POINTERDOWN,function(n){n.stopPropagation()});this._view.elements.checkbox.addEventListener(f.POINTERUP,function(n){n.stopPropagation()});this._view.elements.checkbox.addEventListener("click",function(n){if(l.getGridEngine()&&l.getGridEngine()._isTouchWithatCellHover===true){l.getGridEngine()._isTouchWithatCellHover=false;n.stopPropagation();l.getGridEngine()._enableInteractiveMultiSelMode()}},true);this._view._listenToChanges=true;this._view.elements.checkbox.addEventListener("change",function(o){if(l._view._listenToChanges){var n=l.getGridEngine();var p=l.getCellInfos();if(n&&p){n._enableInteractiveMultiSelMode();if(p.cellModel.isSelected()){p.cellModel.unselect()}else{if(!n.options.selection.canMultiSelect){n.options.TreedocModel.getXSO().empty()}p.cellModel.select()}n.options.lastSelectedNode=p.cellModel}}});this.setupContextualMenu(m);var j=this.getGridEngine().options.onContextualEvent;if(j){this._view.elements.menu.addEventListener(f.POINTERUP,function(q){var s=this;var p=s.cellView;l._CtxMenuByRightClick=false;if(f.isTouchEvent(q)){if(p.getGridEngine()._preventSelectionForTouchScroll){return}}var r=p.getCellInfos();if(r){var t=r.nodeModel;if(t&&!t.isSelected()){t.select(true);p.getGridEngine().setActiveNode(t,true)}}var n=p.getGridEngine().options.onContextualEvent;if(n){var o=document.createEvent("HTMLEvents");o.initEvent("contextmenu",true,false);o.pageX=q.pageX;o.pageY=q.pageY;s.dispatchEvent(o)}l._CtxMenuByRightClick=true;q.stopPropagation()})}else{this._view.elements.menu.addEventListener(f.POINTERDOWN,function(o){var p=this;var n=p.cellView;l._CtxMenuByRightClick=false;i.show(n._view.elements.container,[o.pageX,o.pageY]);l._CtxMenuByRightClick=true})}},setupContextualMenu:function(n){var m=this;var k=this.getGridEngine().options.onContextualEvent;if(k){g.addEventListener(this.elements.container,{callback:function(p){if(m.getGridEngine()){m.getGridEngine()._cellCtxMenuRequired=true;if(m._CtxMenuByRightClick===true){var o=m.getCellInfos();if(o){var q=o.nodeModel;if(q&&!q.isSelected()){q.select(true);m.getGridEngine().setActiveNode(q,true)}}}}return k.callback.call(k["this"],{context:m,menuContext:p.context,infos:p.info,data:p.data,cellInfos:m.getCellInfos()})}})}else{var l=this.getGridEngine().options.onContextualMenuReady;var j=l;if(typeof l==="function"){j=function(){var o=m.getCellInfos();if(o&&m._CtxMenuByRightClick===true){var p=o.nodeModel;if(p&&!p.isSelected()){p.select(true);m.getGridEngine().setActiveNode(p,true)}}return l.call(m,o)}}i.forget({target:this._view.elements.container,nodes:j});i.onReady({target:this._view.elements.container,nodes:j})}},updateInternalParameters:function(){this.setColor();this.setTitle();this.setSubtitle();this.setDescription();this.unhighlight();this.deactivate();this.unsetBadges()},setColor:function(j){this._view.setColor(j)},setIcon:function(j){this._view.setIcon(j)},setTitle:function(j){this._view.setTitle(j);if(!this.getGridEngine()||(this.getGridEngine()&&typeof this.getGridEngine().getShouldDisplayTooltipFlag==="function"&&this.getGridEngine().getShouldDisplayTooltipFlag()===true)){this.elements.container.title=j}},setSubtitle:function(j){this._view.setSubtitle(j)},setDescription:function(j){this._view.setDescription(j)},setPicture:function(j){this._view.setPicture(j)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var j=this._parent();var k=this.getVirtualCoordinates();j.nodeModel=this.getGridEngine().getCellModel(k.virtualRowID,k.virtualColumnID);return j},setPictureBackgroundSize:function(j){if(this._view&&this._view.elements.picture){this._view.elements.picture.setStyle("background-size",j)}},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="";this._view.elements.badgeTopRight.style.visibility="hidden";this._view.elements.badgeTopRight.className="";this._view.elements.badgeTopRight.addClassName("wux-controls-tileview-badge-top-right");this._view.elements.badgeBottomRight.style.backgroundImage="";this._view.elements.badgeBottomRight.style.visibility="hidden";this._view.elements.badgeBottomRight.className="";this._view.elements.badgeBottomRight.addClassName("wux-controls-tileview-badge-bottom-right")},setBadges:function(j){for(var l in j){var k=j[l];if(k){e.generateIcon(k,{target:this._view.elements["badge"+h(l)]});this._view.elements["badge"+h(l)].style.visibility="visible"}}}});return c});define("DS/Controls/ComboBoxBase",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeNodeView","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Array","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/CommandsRegistry"],function(c,d,p,q,A,n,g,i,l,f,v,t,o,u,s){var h=v.extend({syncModel:function(C,B){r.call(this.getDocument());this._parent(C,B)}});var m=f.extend({updateInternalParameters:function(){this._parent();var D=this.getCellInfos();if(!D.isHeader){if(D.nodeModel._wuxComboBoxPreselected){this.getContent().addClassName("wux-controls-combobox-row-preselected")}else{this.getContent().removeClassName("wux-controls-combobox-row-preselected")}var B=D.nodeModel.options.comboBoxSemantics||"leaf";var C=document.createAttribute("semantics");C.value=B;this.getContent().setAttributeNode(C)}}});function r(){var B=0;this._getTrueRoot().processDescendants({onlyVisibleNodes:false,processNode:function(C){C.nodeModel._unfilteredRowID=B;B++}})}function y(){var D=this;t.addEventOnElement(this,this.elements.container,"mousewheel",function(F){if(D.disabled){return}if(D.multiSelFlag&&!D._isPopupOpened()){return}if(document.activeElement===D._getMainElement()||D.getContent().hasAttribute("focused")){F.preventDefault();F.stopPropagation();var G=c.Event.wheelDelta(F);if(G<0){for(var E=0;E>G;E--){D.callMethodFromUIInteraction("incrementIndex")}}else{for(var E=0;E<G;E++){D.callMethodFromUIInteraction("decrementIndex")}}}});var C=document;if(D.getContent()&&D.getContent().ownerDocument){C=D.getContent().ownerDocument}var B=function(H){if(D._isPopupOpened()){var F=t.firstParentWithClass(H.target,"wux-controls-combobox-popup");if(!F){var G=t.firstParentWithClass(H.target,"wux-controls-combobox");var E=G?G.dsModel===D:false;if(!E){t._pushUserInteractionContext();D.callMethodFromUIInteraction("_hidePopup",!D._validateOnBlurForTMCAndFilterApp&&!D.multiSelFlag);t._popUserInteractionContext()}}}};t.addEventOnElement(this,C.body,"mousedown",B,true);t.addEventOnElement(this,C.body,"touchstart",B,true)}function b(){if(this._model){if(this.multiSelFlag&&!this._firstLoadModel){this.selectedIndexes=[]}var D=true;if(this._addChildCB){this._model.unsubscribe(this._addChildCB);this._addChildCB=undefined}if(this._removeChildCB){this._model.unsubscribe(this._removeChildCB);this._removeChildCB=undefined;D=false}if(D){if(this.elements.treeListView&&this.elements.treeListView.getManager().getDocument()){this.elements.treeListView.getManager().unloadDocument();this.elements.treeListView.getManager()._treeDocument=null}if(this._model){this._model.destroy();delete this._model}}this._model=undefined}this._allDescendants=undefined;var G=this;if(this.elementsList.length){this._model=new i({shouldBeEditable:function(){return G.multiSelFlag}});this._model.prepareUpdate();var H=typeof(this.elementsList[0])==="string";for(var E=0;E<this.elementsList.length;E++){var C;if(H){C={label:this.elementsList[E]}}else{C={label:this.elementsList[E].labelItem,grid:{valueItem:this.elementsList[E].valueItem}}}if(this.elementsList[E].labelItem&&this.elementsList[E].labelItem!==""){this._model.options._hasAtLeastOneLabel=true}if(this.elementsList[E].iconItem){this._model.options._hasAtLeastOneIcon=true;if(typeof(this.elementsList[E].iconItem)==="string"){if(this.elementsList[E].iconItem.indexOf(".")===-1){this.elementsList[E].iconItem={iconName:this.elementsList[E].iconItem}}}C.icons=[this.elementsList[E].iconItem]}this._model.addRoot(new l(C))}this._model.pushUpdate()}else{if(this.elementsTree){this._model=this.elementsTree;var B=function(){G._allDescendants=undefined;r.call(G._model);G._updateNbDisplayedElements();G._updatePopupHeight()};this._addChildCB=this._model.addModelEventListener("addChild",B);this._removeChildCB=this._model.addModelEventListener("removeChild",B)}else{this._model=new i({shouldBeEditable:function(){return G.multiSelFlag}})}}this._firstLoadModel=false;if(this._model){r.call(this._model);if(this._treeListViewReady){this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-iconandtext");this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-icononly");if(this._model.options._hasAtLeastOneIcon){if(this._model.options._hasAtLeastOneLabel){this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext")}else{this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")}}}this._model.getXSO().onAdd(function(I){if(G._preventXSOCB){return}if(G.multiSelFlag){o.pushUnique(G.selectedIndexes,I._unfilteredRowID);G._applySelectedIndexes()}else{if(!G._isPopupOpened()){G.selectedIndex=I._unfilteredRowID}else{G._properties.preselectedIndex.value=I._unfilteredRowID;G._applyPreselectedIndex()}}});var F=false;this._model.getXSO().onRemove(function(I){if(G._preventXSOCB){return}if(G.multiSelFlag){if(G._model.getXSO().get().length){G.selectedIndexes.splice(G.selectedIndexes.indexOf(I._getRowID(1)),1)}else{o.clear(G.selectedIndexes)}if(!F){G._removeIndex=true;G._applySelectedIndexes();G._removeIndex=false}}});this._model.getXSO().onPreEmpty(function(){F=true});this._model.getXSO().onEmpty(function(){F=false})}this._modelHasChanged=true;this._updateNbDisplayedElements();this._updatePopupHeight();if(this._modelLoaded){this._modelLoaded()}}function j(E,C){if(E===undefined){C.value=-1;return 1}if(E===-1&&this.reachablePlaceholderFlag){return 0}if(E<-1&&this.reachablePlaceholderFlag){C.value=-1;return 1}var D=this._getAllDescendants();if(D.length===0){if(E!==-1){C.value=-1;return 1}return 0}if(E<=-0.5&&!this.reachablePlaceholderFlag){C.value=0;return 1}if(E>=D.length){C.value=D.length-1;return 1}if((C.value=Math.round(E))!==E){return 1}if(!this.isIndexValid(E)){if(this._direction===0){return 2}else{if(this._direction===1){var B=a.call(this,E);if(B===-1){return 2}C.value=B;return 1}else{var B=z.call(this,E);if(B===this._getAllDescendants().length){return 2}C.value=B;return 1}}}return 0}function x(C){var B=C;do{B=a.call(this,B);if(B===-1){return B}}while(!this.isIndexValid(B));return B}function a(E){var C=-1;if(E!==undefined){if(E<this._getAllDescendants().length-1){C=E+1}return C}if(this._isPopupOpened()){var D=this._model.getXSO().get();if(D.length>0){var B=D[D.length-1]._unfilteredRowID;if(B<this._getAllDescendants().length-1){C=B+1}}else{C=0}}else{if(this.multiSelFlag){if(this.selectedIndexes[this.selectedIndexes.length-1]<this._getAllDescendants().length-1){C=this.selectedIndexes[this.selectedIndexes.length-1]+1}}else{if(this.selectedIndex<this._getAllDescendants().length-1){C=this.selectedIndex+1}}}return C}function w(C){var B=C;do{B=z.call(this,B);if(B===this._getAllDescendants().length){return B}}while(!this.isIndexValid(B));return B}function z(E){var C=this._getAllDescendants().length;if(E!==undefined){if(E>(this.reachablePlaceholderFlag&&!this._isPopupOpened()?-1:0)){C=E-1}return C}if(this._isPopupOpened()){var D=this._model.getXSO().get()[0];if(D){var B=D._unfilteredRowID;if(B>0){C=B-1}}}else{if(this.selectedIndex>(this.reachablePlaceholderFlag?-1:0)){C=this.selectedIndex-1}}return C}function e(B,G){var D=this.elements.treeListView.getManager();if(!B){D.setScrollerPosition({x:0,y:0})}else{var J=this.elements.treeListView.getManager().options.defaultCellHeight;var E=B._getRowID(1)*J;if(G){var C=Math.max(0,E-J*Math.floor(this.nbDisplayedElements/2));D.setScrollerPosition({x:0,y:C})}else{var F=this.nbDisplayedElements*J;var K=this.elements.treeListView.getManager().getScrollerPosition();var I=K.y;var H=I+F-J;if(E>H){D.setScrollerPosition({x:0,y:E-F+J})}else{if(E<I){D.setScrollerPosition({x:0,y:E})}}}}}var k=q.inherit({name:"comboBoxBase",publishedProperties:{nbDisplayedElements:{defaultValue:-1,type:"integer",readOnly:true,category:"Appearance"},selectedIndex:{defaultValue:-1,type:"integer",category:"Appearance",recordFlag:true},preselectedIndex:{defaultValue:-1,type:"integer",readOnly:true,category:"Appearance"},selectedIndexes:{defaultValue:[],type:"array",category:"Appearance",recordFlag:true},value:{defaultValue:undefined,type:"object",category:"Appearance",recordFlag:true},currentValue:{defaultValue:undefined,type:"object",category:"Appearance",uiDisplay:false},label:{defaultValue:"",type:"string",readOnly:true,category:"Appearance"},currentLabel:{defaultValue:"",type:"string",readOnly:true,category:"Appearance"},elementsList:{defaultValue:[],type:"array",category:"Model"},elementsTree:{defaultValue:undefined,type:"array",category:"Model"},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},reachablePlaceholderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},_validateOnBlurForTMCAndFilterApp:{defaultValue:false,type:"boolean",category:"Behavior",readOnly:true,noNeedToApplyFlag:true}},buildView:function(){this.elements.container.addClassName("wux-controls-combobox");this._model=null;this._firstLoadModel=true;this._lastValidatedPreselectedIndex=undefined;this._lastValidatedSelectedIndex=undefined;this._treeListViewReady=false;this._direction=0;this._preventXSOCB=false;this._removeIndex=false;this._lastValidatedSelectedIndexes=[]},handleEvents:function(){y.call(this)},destroy:function(){this._hidePopup(true);if(this._addChildCB){this._model.unsubscribe(this._addChildCB);this._addChildCB=undefined}if(this._removeChildCB){this._model.unsubscribe(this._removeChildCB);this._removeChildCB=undefined}this._allDescendants=null;this._parent();if(this.elementsList){this._model.destroy()}},isIndexValid:function(B){if(B<-1||B>=this._getAllDescendants().length){return false}if(B===-1){return this.reachablePlaceholderFlag}var C=this._getAllDescendants()[B];if(!C){return false}return this._model.options.shouldBeSelected(C)},incrementIndex:function(){this._direction=1;var C=this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode();if(C){this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-next-visible-node-no-empty-xso",this.elements.treeListView.getManager());B=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID;if(this.multiSelFlag){this._properties.preselectedIndex.value=B;this._applyPreselectedIndex()}else{}}else{var B=x.call(this);if(B>=0){if(this._isPopupOpened()){this._selectInList(B)}else{this.selectedIndex=B}}}this._direction=0},decrementIndex:function(){this._direction=2;var B=this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode();if(B){var D=this.preselectedIndex;this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-previous-visible-node-no-empty-xso",this.elements.treeListView.getManager());C=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID;if(this.multiSelFlag){this._properties.preselectedIndex.value=C;this._applyPreselectedIndex()}else{if(!this._isPopupOpened()&&D===C&&this.reachablePlaceholderFlag){this.selectedIndex=-1}}}else{var C=w.call(this);if(C!==this._getAllDescendants().length){if(this._isPopupOpened()){this._selectInList(C)}else{this.selectedIndex=C}}}this._direction=0},getPopupWidth:function(){var B=this.elements.container.getBoundingClientRect().width;if(this.multiSelFlag){var C=this.elements.treeListView._treeWidth;return C>B?C:B}return B},_selectInList:function(D){this._preventXSOCB=true;var C=this.multiSelFlag?D:[D];var B;if(this.multiSelFlag&&this._removeIndex&&this._treeListViewReady){B=this.elements.treeListView.getManager().getActiveNode()}this._model.prepareUpdate();this._model.getXSO().empty();for(var E=0;E<C.length;E++){if(C[E]>=0&&C[E]<this._getAllDescendants().length){this._getAllDescendants()[C[E]].select()}}if(!this.multiSelFlag||!this._removeIndex){this._properties.preselectedIndex.value=C[C.length-1];this._applyPreselectedIndex(1);B=this._getAllDescendants()[this.preselectedIndex]}if(this._treeListViewReady){this.elements.treeListView.getManager().setActiveNode(B)}this._model.pushUpdate();this._preventXSOCB=false},_addCommonEvents:function(){var B=this;if(this.elements.expander){t.addEventOnElement(this,this.elements.expander,d.POINTERUP,function(C){C.preventDefault();if(B.disabled){return}if(B._isPopupOpened()){B.callMethodFromUIInteraction("_hidePopup",!B.multiSelFlag&&!B._validateOnBlurForTMCAndFilterApp)}else{B.callMethodFromUIInteraction("_showPopup")}});t.addEventOnElement(this,this.elements.expander,"click",function(C){C.stopPropagation()})}if(!this._getMainElement){return}this._getMainElement().addEventListener(d.POINTERDOWN,function(C){});this._getMainElement().addEventListener(d.POINTERUP,function(C){C.preventDefault()});t.addEventOnElement(this,this._getMainElement(),"keydown",function(E){var D=false;switch(E.keyCode){case p.ARROWUP:if(B.multiSelFlag&&B._isPopupOpened()||!B.multiSelFlag&&!E.shiftKey&&!E.ctrlKey){D=true;B.callMethodFromUIInteraction("decrementIndex")}E.stopPropagation();break;case p.ARROWDOWN:if(B.multiSelFlag&&B._isPopupOpened()||!B.multiSelFlag&&!E.shiftKey&&!E.ctrlKey){D=true;B.callMethodFromUIInteraction("incrementIndex")}E.stopPropagation();break;case p.ESCAPE:if(B._isPopupOpened()){var C=B.preselectedIndex;var F=B._isPopupOpened();B.callMethodFromUIInteraction("_hidePopup",1);if(C!==B.preselectedIndex){E.actionPerformed=true;B._actionPerformedOnKeyDown=true}if(F){E.stopPropagation();B._stopPropagation=true}}break;case (B.multiSelFlag&&p.TAB):if(B._isPopupOpened()){B.callMethodFromUIInteraction("_hidePopup",!B.multiSelFlag)}E.stopPropagation();break;case (E.ctrlKey&&p.SPACE):if(B.multiSelFlag&&B._isPopupOpened()&&B._treeListViewReady){this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:toggle-selection",this.elements.treeListView.getManager())}E.stopPropagation();break}if(D){E.preventDefault()}})},_updatePopupHeight:function(){if(this.elements.treeListViewContainer){var D=this.nbDisplayedElements;var B=this._getCurrentTouchMode()?38:22;var E=(B*D)+"px";if(this.elements.treeListViewContainer.style.height!==E){var C=this._isPopupOpened();this.elements.popup.visibleFlag=false;this.elements.treeListViewContainer.style.height=E;this.elements.popup.visibleFlag=C;if(this.elements.treeListView){this.elements.treeListView.updateHeight(E)}}}},_managePopupOverlaping:function(B){var C=this._properties.nbDisplayedElements.value;this._updateNbDisplayedElements(B);if(C!==this._properties.nbDisplayedElements.value){this._updatePopupHeight()}},_updateNbDisplayedElements:function(B){var C=this._getAllDescendants().length;if(!B){this._properties.nbDisplayedElements.value=(C<10?C:10)}else{this._reduceNbDisplayedToAvoidOverlaping(B,C<10?C:10)}},_reduceNbDisplayedToAvoidOverlaping:function(C,D){var B=this._getCurrentTouchMode()?38:22;if(D>3){D--;if(D*B>C.bottom&&D*B>C.top){this._reduceNbDisplayedToAvoidOverlaping(C,D)}else{this._properties.nbDisplayedElements.value=D}}else{this._properties.nbDisplayedElements.value=D}},_hidePopup:function(B){if(!this._isPopupOpened()){return}if(B){if(this.multiSelFlag){this.selectedIndexes=this._lastValidatedSelectedIndexes.slice()}else{}}else{if(this.multiSelFlag){this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()}else{this.selectedIndex=this._model.getXSO().get().length?this._model.getXSO().get()[0]._unfilteredRowID:-1}}if(this.multiSelFlag){this._properties.preselectedIndex.value=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1;this._applyPreselectedIndex()}else{this._properties.preselectedIndex.value=this.selectedIndex;this._applyPreselectedIndex()}this.elements.popup.visibleFlag=false;this.fire("hide",{cancelPopupSelection:B});if(this._popupHidden){this._popupHidden(B)}if(B){if(!this.multiSelFlag){this._model.getXSO().empty();if(this.selectedIndex>-1){this._model.getXSO().add(this._getAllDescendants()[this.selectedIndex])}}}},_buildPopup:function(){if(!this.elements.popup){var G=this;var F={target:this,position:"bottom",offset:{x:0,y:4},alignment:this.multiSelFlag?"near":"center",className:"wux-controls-combobox-popup wux-controls-popup",constraint:"screen",overlap:false,trigger:"",overlapCallback:function(J){G._managePopupOverlaping(J)}};this.elements.popup=new A(F);if(this.recId){this.elements.popup.recId=this.recId+"-popup"}this.elements.treeListViewContainer=new c.Element("div");this.elements.popup.setBody(this.elements.treeListViewContainer);this._updatePopupHeight();var G=this;var C=this.nbDisplayedElements;var B=this._getCurrentTouchMode()?38:22;var I=(B*C)+"px";var E={managerClass:h,manageHeight:true,expanderStyle:"none",columns:[{dataIndex:"selection",type:"selection",isHidden:true},{text:"tree",dataIndex:"tree",isHidden:false,isEditable:false,width:"auto"},{text:"valueItem",dataIndex:"valueItem",isHidden:true,isEditable:false,isDraggable:false,width:0}],defaultCellHeight:B,defaultCellWidth:50,height:I,isEditable:true,resize:{columns:true,rows:false},show:{rowHeaders:false,columnHeaders:false},selection:{rowHeaders:false,columnHeaders:false,unselectAllOnEmptyArea:false,preSelection:true,toggle:false,canMultiSelect:G.multiSelFlag,enableListSelection:G.multiSelFlag},treeDocument:this._model,performances:{useRequestAnimationFrameRendering:true},shouldAcceptDrag:function(){return false},apiVersion:2,cellClass:m,enableActiveUI:true,enableKeyboardNavigation:true,allowUnsafeHTMLContent:false};this.elements.treeListView=new g(E);this.elements.treeListView.getManager().__isComboBox__=true;this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview");if(this._model.options._hasAtLeastOneIcon){if(this._model.options._hasAtLeastOneLabel){this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext")}else{this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")}}this._applyMultiSelFlag();var G=this;var D={x:-1,y:-1};var H=true;t.addEventOnElement(this,this.elements.popup.getContent(),"mousemove",function(N){var K=N.clientX,J=N.clientY;if(K===D.x&&J===D.y&&H){return}var L=t.firstParentWithClass(N.target,"wux-datagrid-cell");if(L&&L.dsView&&L.dsView._cellInfos&&L.dsView._cellInfos.cellModel&&L.dsView._cellInfos.cellModel.options){var M=L.dsView._cellInfos.nodeModel._unfilteredRowID;G.setReadOnlyPropertyFromUIInteraction("preselectedIndex",{value:parseInt(M)})}D.x=K;D.y=J;H=true},true);this.elements.popup.getContent().addEvent("mousewheel",function(){H=false});this.elements.treeListView.onNodeClick(function(J){if(G._getMainElement&&!d.isLastEventTouch()){G._getMainElement().focus()}if(G.isIndexValid(J.nodeModel._unfilteredRowID)){if(!G.multiSelFlag){G._hidePopup()}}});this.elements.treeListView.getManager().onReady(function(){G._treeListViewReady=true;if(G.selectedIndex!==-1){var J=G._getAllDescendants();if(J.length>G.nbDisplayedElements){var K=G.selectedIndex;if(G.multiSelFlag&&G.selectedIndexes.length>0){K=G.selectedIndexes[G.selectedIndexes.length-1]}e.call(G,J[K],true)}}G.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-colors")});if(this.multiSelFlag){t.addEventOnElement(this,window,"blur",function(J){if(G._isPopupOpened()){G._hidePopup(!G.multiSelFlag)}})}}else{this._updateNbDisplayedElements();this._updatePopupHeight()}},_getAllDescendants:function(){if(!this._allDescendants){this._allDescendants=this._model.getAllDescendants()}return this._allDescendants},_showPopup:function(){if(this._isPopupOpened()){return}this.fire("preDropdown");this._buildPopup();var C=this.getPopupWidth();this.elements.treeListViewContainer.style.width=C+"px";var B=this;this.elements.treeListView.getManager().onPostUpdateViewOnce(function(){if(!B._getAllDescendants()){return}var D;if(B.multiSelFlag&&B.selectedIndexes.length>0||!B.multiSelFlag&&B.selectedIndex!==-1){D=B._getAllDescendants()[B.preselectedIndex]}if(B.multiSelFlag&&!D&&B._getAllDescendants().length){this.setActiveNode(B._getAllDescendants()[0])}else{this.setActiveNode(D)}if(D){if(B._getAllDescendants().length>B.nbDisplayedElements){e.call(B,D,true)}}});this.elements.popup.visibleFlag=true;if(this._modelHasChanged){this.elements.treeListView.inject(this.elements.treeListViewContainer);this.elements.treeListView.getManager().loadDocument(this._model);this._modelHasChanged=false}if(this._getMainElement){this._getMainElement().focus()}if(this.multiSelFlag){this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()}if(this._popupDisplayed){this._popupDisplayed()}this.fire("show")},_isPopupOpened:function(){return this.elements.popup&&this.elements.popup.visibleFlag},_updateCurrentProperties:function(){if((!this.multiSelFlag&&this.selectedIndex===-1)||(this.multiSelFlag&&this.selectedIndexes.length===0)){this._properties.value.value=this.multiSelFlag?[]:undefined;this._properties.currentValue.value=this.multiSelFlag?[]:undefined;this._properties.label.value="";this._properties.currentLabel.value=""}else{var B=[];var F="";var D=this.multiSelFlag?this.selectedIndexes:[this.selectedIndex];for(var C=0;C<D.length;C++){var E=this._getAllDescendants()[D[C]];if(E){if(E.options.grid.valueItem!==undefined){o.pushUnique(B,E.options.grid.valueItem)}else{o.pushUnique(B,E.options.label)}F+=E.options.label;if(C!==D.length-1&&D.length>1){F+=", "}}}this._properties.value.value=this.multiSelFlag?B:B[0];this._properties.currentValue.value=this.multiSelFlag?B:B[0];this._properties.label.value=F;this._properties.currentLabel.value=F}},_applyPreselectedIndex:function(C){var D=this._lastValidatedPreselectedIndex!==this.preselectedIndex;if(!D&&!C){return}var E={value:0};var B=j.call(this,this.preselectedIndex,E);if(B===1){this._properties.preselectedIndex.value=E.value;this._applyPreselectedIndex();return}else{if(B===2){this._properties.preselectedIndex.value=this._lastValidatedPreselectedIndex?this._lastValidatedPreselectedIndex:-1;return}}var F=this._getAllDescendants();if(this._lastValidatedPreselectedIndex!==undefined&&this._lastValidatedPreselectedIndex>=0&&this._lastValidatedPreselectedIndex<F.length){F[this._lastValidatedPreselectedIndex]._wuxComboBoxPreselected=false;if(this._treeListViewReady){this.elements.treeListView.getManager().removeRowClass(F[this._lastValidatedPreselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")}}this._lastValidatedPreselectedIndex=this.preselectedIndex;if(this.preselectedIndex!==-1){F[this.preselectedIndex]._wuxComboBoxPreselected=true;if(this._treeListViewReady){this.elements.treeListView.getManager().addRowClass(F[this.preselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")}}if(this._preselectedIndexModified){this._preselectedIndexModified()}if(this.elements.popup&&this.elements.popup.visibleFlag&&D){this.fire("preselectionChange")}},_applySelectedIndex:function(C){if(this.multiSelFlag){return}var E=true;var D={value:0};var B=j.call(this,this.selectedIndex,D);if(B===1){if(D.value===C){this._properties.selectedIndex.value=C;return}this.selectedIndex=D.value;return}else{if(B===2){this._properties.selectedIndex.value=this._lastValidatedSelectedIndex?this._lastValidatedSelectedIndex:(this.reachablePlaceholderFlag?-1:0);E=false}}if(this._modelChanged){E=E&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&this.selectedIndex!==-1)}else{E=E&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&this.selectedIndex===-1)}this._lastValidatedSelectedIndex=this.selectedIndex;this._selectInList(this.selectedIndex);if(this._selectedIndexModified){this._selectedIndexModified()}this._updateCurrentProperties();if(E){this.fire("change")}},_applySelectedIndexes:function(C,F){if(!this.multiSelFlag){return}var E=true;var G=[];for(var D=0;D<this.selectedIndexes.length;D++){var B=this.selectedIndexes[D];if(this.isIndexValid(B)){o.pushUnique(G,B)}}if(G.length>0){this._properties.selectedIndexes.value=G}else{if(G.length===0&&this.selectedIndexes.length>0){this._properties.selectedIndexes.value=C||[];E=false}}if(this._modelChanged){}else{E=E&&(!C||!c.Array.equals(C,this.selectedIndexes))}this._selectInList(this.selectedIndexes);if(this._selectedIndexModified){this._selectedIndexModified()}this._updateCurrentProperties();if(E){this.fire("change")}},_applyValue:function(B){var H=0;var G=[];var J=undefined;if(this.multiSelFlag){J=(this.value!==undefined)?this.value:[]}else{J=(this.value!==undefined)?[this.value]:[]}var C=this._getAllDescendants();var I=J.length;if(J&&I>0){for(var F=0;F<J.length;){var D=false;for(H=0;H<C.length;H++){var E=C[H];if(E.options.grid.valueItem!==undefined){if(E.options.grid.valueItem===J[F]){o.pushUnique(G,H);D=true;break}}else{if(E.options.label===J[F]){o.pushUnique(G,H);D=true;break}}}if(!D){J.splice(F,1)}else{F++}}}if(!this.multiSelFlag){if(H===C.length){this._properties.value.value=B}else{this.selectedIndex=G.length>0?G[0]:-1}}else{if(G.length>0){this.selectedIndexes=G}else{if(I>0){this._properties.value.value=B}else{this._properties.value.value=[];this.selectedIndexes=[]}}}this._properties.currentValue.value=this.value},_applyCurrentValue:function(B){this.value=this.currentValue},_applyElementsList:function(){this._modelChanged=true;this._forceApplyProperties(["selectedIndex","selectedIndexes"]);this._modelChanged=false},_applyElementsTree:function(){this._modelChanged=true;this._forceApplyProperties(["selectedIndex","selectedIndexes"]);this._modelChanged=false},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.mainElement.disabled=true;this.elements.expander.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.mainElement.disabled=false;this.elements.expander.removeAttribute("disabled")}},_applyMultiSelFlag:function(C){var B=this.elements.treeListView;if(B){B.getManager().options.selection.canMultiSelect=this.multiSelFlag;if(this.multiSelFlag){B.getManager().showColumn(0)}else{B.getManager().hideColumn(0)}B.getManager().options.selection.enableListSelection=this.multiSelFlag}if(this.multiSelFlag){if(this.selectedIndexes.length===0){this.selectedIndexes=(this.selectedIndex===-1)?[]:[this.selectedIndex]}this.selectedIndex=-1;if(this.elements.popup){this.elements.popup.alignment="near"}this.getContent().setAttributeNode(document.createAttribute("multiple"))}else{if(this.selectedIndexes.length>0){this.selectedIndex=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1;this._properties.selectedIndexes.value=[]}if(this.elements.popup){this.elements.popup.alignment="center"}this.getContent().removeAttribute("multiple")}},_applyReachablePlaceholderFlag:function(){if(this.enableSearchFlag){this.reachablePlaceholderFlag=true}if(!this.reachablePlaceholderFlag){if(!this.multiSelFlag&&this.selectedIndex===-1&&this.currentValue===undefined&&this.value===undefined&&this.currentLabel===""&&this.label===""){this.selectedIndex=x.call(this,-1)}}},_applyTouchMode:function(B){this._parent(B);if(!this._treeListViewReady){return}if(this._getCurrentTouchMode()){this.elements.treeListView.options.defaultCellHeight=38;this.elements.treeListView._datagrid.options.defaultCellHeight=38;this.elements.treeListView.getManager().options.defaultCellHeight=38}else{this.elements.treeListView.options.defaultCellHeight=22;this.elements.treeListView._datagrid.options.defaultCellHeight=22;this.elements.treeListView.getManager().options.defaultCellHeight=22}this.elements.treeListView.getManager()._indexRowsPosition({async:false});this._updatePopupHeight()},_applyProperties:function(B){this._parent(B);if(this.isDirty("elementsList")||this.isDirty("elementsTree")){b.call(this)}if(this.isDirty("reachablePlaceholderFlag")){this._applyReachablePlaceholderFlag(B.reachablePlaceholderFlag)}if(this.isDirty("touchMode")){this._applyTouchMode(B.touchMode)}if(this.isDirty("currentValue")&&B&&B.hasOwnProperty("currentValue")){this._applyCurrentValue(B.currentValue)}if(this.isDirty("value")&&B&&B.hasOwnProperty("value")){this._applyValue(B.value)}if(this.isDirty("selectedIndex")||this.isDirty("elementsList")||this.isDirty("elementsTree")){this._applySelectedIndex(B.selectedIndex)}if(this.isDirty("selectedIndexes")||this.isDirty("elementsList")||this.isDirty("elementsTree")){this._applySelectedIndexes(B.selectedIndexes)}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag()}},_giveFocus:function(){if(this._isFocused()){return}this._parent();this._getMainElement().focus()}});return k});define("DS/Controls/ComboBox",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Controls/Button","DS/Controls/ComboBoxBase","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/LineEditor"],function(c,d,k,l,s,i,h,o,n,p){function b(){this.elements.mainElement=new p({displayStyle:"text"}).inject(this.elements.container);this.elements.mainElement._myInput.addClassName("wux-controls-combobox-mainelement");this.elements.expander=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:true,name:"Button"}).inject(this.elements.container);this.elements.expander.setAttribute("style","border-left-width: 0px;")}function m(){var x=this;this._getMainElementTag().addEventListener("uncommittedChange",function(z){z.stopPropagation();x.fire("uncommittedChange")});this._getMainElementTag().addEventListener("change",function(z){z.stopPropagation()});var y=0;var v=function(){var C=false;var B=false;if(!y){C=x.preselectedIndex===x.selectedIndex&&x.selectedIndex===-1&&x._lastCustomEntry!==x._getMainElement().value;if(x.preselectedIndex===-1){x._lastCustomEntry=x._getMainElement().value}}else{clearTimeout(y);y=0;var A=x._getMainElement().value;var z=-1;x._model.search({match:function(D){if(x._model.options.shouldBeSelected(D.nodeModel)&&(A.toLowerCase()===D.nodeModel.options.label.toLowerCase())){D.nodeModel._getRowID(1);z=D.nodeModel._unfilteredRowID}},shouldStop:function(D){return z!==-1}});C=z===x.selectedIndex&&z===-1&&x._lastCustomEntry!==A;if(z===-1){x._lastCustomEntry=A}if(x.selectedIndex!==z){x.selectedIndex=z;B=true}}if(C){B=true;x._applySelectedIndex()}return B};if(this._validateOnBlurForTMCAndFilterApp){this._getMainElement().addEventListener("blur",function(z){v()})}var u=false;var t;n.addEventOnElement(this,this._getMainElement(),"keydown",function(z){if(x._getMainElement().value!==t){t=x._getMainElement().value}u=false;if(z.keyCode>=k.KEY0&&z.keyCode<=k.Z){u=true}else{if(z.keyCode>=k.NUMPAD0&&z.keyCode<=k.SLASH){u=true}else{if(z.keyCode===k.DELETE||z.keyCode===k.BACKSPACE||z.keyCode===k.SPACE){u=true}else{if(z.keyCode>=k.SEMICOLON&&z.keyCode<=222){u=true}else{if(z.keyCode===k.ENTER){var B=x._isPopupOpened();var A=v();z.actionPerformed=A;x._actionPerformedOnKeyDown=A;if(B){z.stopPropagation();x._stopPropagation=true}x.callMethodFromUIInteraction("_hidePopup");x._getMainElement().removeClassName("wux-controls-lineeditor-hideCursor")}}}}}});var w;n.addEventOnElement(this,this._getMainElement(),"keyup",function(A){if(x._actionPerformedOnKeyDown){A.actionPerformed=x._actionPerformedOnKeyDown;x._actionPerformedOnKeyDown=undefined}if(x._stopPropagation){A.stopPropagation();x._stopPropagation=undefined}if(A.keyCode===k.TAB||!u){return}var B=this.value;x.elements.mainElement.value=B;if(y){clearTimeout(y);y=0}y=setTimeout(function z(){var D=false;if((A.keyCode===k.DELETE||A.keyCode===k.BACKSPACE)&&x._emptySearched&&B===""&&w&&(w===k.DELETE||w===k.BACKSPACE)){D=true}x._emptySearched=B==="";x.callMethodFromUIInteraction("_showPopup");var E=x.callMethodFromUIInteraction("_showMatchingLabel",B);x.setPropertyFromUIInteraction("_isFiltering",true);var F=x._nbDisplayedItems===0;x.callMethodFromUIInteraction("_updateNbDisplayedElements");x.callMethodFromUIInteraction("_updatePopupHeight");if(x.generateRegexpString===x.publishedProperties.generateRegexpString.defaultValue){x._currentStartFiltered=x._getMainElement().selectionStart}else{x._currentStartFiltered=0}var C=-1;if(F||(D||!x.autocompleteFlag)&&E===-1){D=false}else{if(E!==-1){C=E}else{C=x._firstVisibleSelectableIndex}}x.callMethodFromUIInteraction("_selectInList",C);clearTimeout(y);y=0},500);w=A.keyCode})}function e(){this.elements.mainElement=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-mainelement",type:"text",tabindex:0,isTextField:false,name:"Button"}).inject(this.elements.container);this.elements.iconPlaceholder=new c.Element("div",{"class":"wux-comboBox-icon-placeholder"}).inject(this.elements.mainElement);if(!this.elements.text){this.elements.text=c.createElement("span").inject(this.elements.mainElement)}this.elements.expander=new c.Element("button",{"class":"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:false,name:"Button"}).inject(this.elements.container);if(!this.actionOnClickFlag){this.elements.expander.setAttribute("style","border-left-width: 0px;")}this.elements.mainElement.setAttribute("action",this.actionOnClickFlag)}function g(){var u=this;if(this.actionOnClickFlag){n.addEventOnElement(this,this.elements.mainElement,d.POINTERUP,function(x){x.stopPropagation();u.fire("click")})}else{n.addEventOnElement(this,this.elements.mainElement,d.POINTERUP,function(){if(u._isPopupOpened()){u.callMethodFromUIInteraction("_hidePopup",!u.multiSelFlag)}else{u.callMethodFromUIInteraction("_showPopup")}})}this._getMainElement().addEventListener("dblclick",function(x){x.stopPropagation()});this._getMainElement().addEventListener("click",function(x){x.stopPropagation()});var t=false;n.addEventOnElement(this,this._getMainElement(),"keydown",function(x){t=false;if(x.keyCode>=k.KEY0&&x.keyCode<=k.Z){t=true}else{if(x.keyCode>=k.NUMPAD0&&x.keyCode<=k.NUMPAD9){t=true}}if(u.multiSelFlag&&!u._isPopupOpened()){t=false}if(!k.validate(x.keyCode)){return}if(!u.actionOnClickFlag||u._isPopupOpened()||!u.mainElementVisibleFlag){if(u._isPopupOpened()){if(!u.multiSelFlag||x.keyCode!==k.SPACE){u.callMethodFromUIInteraction("_hidePopup");x.stopPropagation();u._stopPropagation=true}}else{u.callMethodFromUIInteraction("_showPopup");x.stopPropagation();u._stopPropagation=true}}else{x.stopPropagation();u.fire("click")}});var v;var w="";n.addEventOnElement(this,this._getMainElement(),"keyup",function(x){if(u._actionPerformedOnKeyDown){x.actionPerformed=u._actionPerformedOnKeyDown;u._actionPerformedOnKeyDown=undefined}if(u._stopPropagation){x.stopPropagation();u._stopPropagation=undefined}if(x.keyCode===k.SPACE){x.stopPropagation()}if(x.keyCode===k.TAB||!t){return}if(v){clearTimeout(v)}w+=String.fromCharCode(x.keyCode);v=setTimeout(function(){n._pushUserInteractionContext();var y=-1;u._model.search({match:function(z){if(u._model.options.shouldBeSelected(z.nodeModel)&&(new RegExp(u.generateRegexpString(w),"i")).test(z.nodeModel.options.label)){y=z.nodeModel._getRowID(1)}},shouldStop:function(z){return y!==-1}});if(y!==-1){if(u.multiSelFlag){u.selectedIndexes=[y]}else{u.selectedIndex=y}}w="";n._popUserInteractionContext()},500)})}function a(){if(this.elements.iconPlaceholder){if(this._generatedIcon!==undefined){this.elements.iconPlaceholder.removeChild(this._generatedIcon);this.elements.text.style.displayStyle="inline-block";this.elements.mainElement.style.textAlign="initial";this.elements.iconPlaceholder.style.marginRight="0px";this.elements.iconPlaceholder.style.paddingLeft="0px";delete this._generatedIcon}if(this.selectedIndex!==-1){var t=this._getAllDescendants()[this.selectedIndex];if(t.options.icons&&t.options.icons.length>0&&t.options.icons[0]){this._generatedIcon=n.generateIcon(t.options.icons[0]);this._generatedIcon.inject(this.elements.iconPlaceholder);if(t.options.label===""){this.elements.text.style.displayStyle="none";this.elements.mainElement.style.textAlign="center";if(!this.actionOnClickFlag&&this.expanderVisibleFlag){if(!this.touchMode){this.elements.iconPlaceholder.style.paddingLeft="11px"}else{this.elements.iconPlaceholder.style.paddingLeft="19px"}}}else{this.elements.iconPlaceholder.style.marginRight="11px"}}}}}function f(){if(this.elements.mainElement){if(this.elements.iconPlaceholder){this.elements.mainElement.removeChild(this.elements.iconPlaceholder);delete this.elements.iconPlaceholder}if(this.elements.text){this.elements.mainElement.removeChild(this.elements.text);delete this.elements.text}this.elements.container.removeChild(this._getMainElementTag());delete this.elements.mainElement;this.elements.container.removeChild(this.elements.expander);delete this.elements.expander}if(this.enableSearchFlag===true){b.call(this);m.call(this)}else{e.call(this);g.call(this)}this._addCommonEvents();this._applyDisplayStyle()}function r(){if(this._isFiltering){this._model.prepareUpdate();this._getAllDescendants().forEach(function(t){if(t.isHidden()){t.show()}if(!t.isExpanded()){t.expand()}});this._model.pushUpdate();this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._currentStartFiltered=-1;this._getMainElement().selectionStart=this._getMainElement().selectionEnd;this._isFiltering=false;this._updateNbDisplayedElements();this._updatePopupHeight()}}function j(){var t=this;this._model.getXSO().onAdd(function(u){if(!t.mainElementVisibleFlag){return}if(!t.autocompleteFlag){return}if(t.enableSearchFlag&&t._isFiltering){t.elements.mainElement.value=u.options.label;t._getMainElement().selectionStart=t._currentStartFiltered}})}var q=h.inherit({name:"comboBox",markForRecordFlag:true,publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},mainElementVisibleFlag:{defaultValue:true,type:"boolean",category:"Appearance"},expanderVisibleFlag:{defaultValue:true,type:"boolean",category:"Appearance"},enableSearchFlag:{defaultValue:true,type:"boolean",category:"Behavior"},generateRegexpString:{defaultValue:function(t){return"^"+t},type:"function",category:"Behavior",uiDisplay:false},useMatchingSearchFunction:{defaultValue:false,type:"boolean",category:"Behavior",uiDisplay:false},isNodeMatchingSearch:{defaultValue:function(u,t){return this.displayChildrenSearchMethod(u,t)},type:"function",category:"Behavior",uiDisplay:false},autocompleteFlag:{defaultValue:true,type:"boolean",category:"Behavior"},actionOnClickFlag:{defaultValue:false,type:"boolean",category:"Behavior"},expanderIcon:{defaultValue:"expand-down",type:"object",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"}},buildView:function(){this._parent();this._regex="";this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._currentStartFiltered=-1;this._lastCustomEntry="";this._isFiltering=false;this._emptySearched=false},_updateNbDisplayedElements:function(t){if(this.enableSearchFlag&&this._isFiltering){if(!t){this._properties.nbDisplayedElements.value=(this._nbDisplayedItems<10?this._nbDisplayedItems:10)}else{this._properties.nbDisplayedElements.value=this._reduceNbDisplayedToAvoidOverlaping(t,this._nbDisplayedItems<10?this._nbDisplayedItems:10)}}else{this._parent(t)}},_showMatchingLabel:function(w){this._model.prepareUpdate();var v=-1;this._regex=w;var t=undefined;if(this.useMatchingSearchFunction){this._getAllDescendants().forEach(function(x){x.options.alreadyTreated=undefined})}else{t=new RegExp(this.generateRegexpString(this._regex),"i")}var u=this;this._model.search({match:function(y){var x=false;if(u.useMatchingSearchFunction){x=u.isNodeMatchingSearch.call(u,w,y)}else{x=t.test(y.nodeModel.options.label)}if(x){if(y.nodeModel.isHidden()){y.nodeModel.show()}if(w===y.nodeModel.getLabel()){v=y.nodeModel._unfilteredRowID}}else{if(!y.nodeModel.isHidden()){y.nodeModel.hide()}}}});this._firstVisibleSelectableIndex=-1;this._nbDisplayedItems=0;this._getAllDescendants().forEach(function(x){if(!x.isHidden()){x.getParents().forEach(function(y){if(y.isHidden()){y.show();u._nbDisplayedItems++}if(!y.isExpanded()){y.expand()}});if(u._firstVisibleSelectableIndex===-1&&u._model.options.shouldBeSelected(x)){u._firstVisibleSelectableIndex=x._unfilteredRowID}u._nbDisplayedItems++}});this._model.pushUpdate();return v},getPopupWidth:function(){return(this.mainElementVisibleFlag?this._parent():this.elements.treeListView._treeWidth)},displayBrothersSearchMethod:function(w,t){var u=t.nodeModel;if(u.options.alreadyTreated!==undefined){return u.options.alreadyTreated}if(u.getLabel().toLowerCase().includes(w.toLowerCase())){var v=u.getParent().getChildren();if(v){v.forEach(function(x){if(x.isHidden()){x.show()}else{x.options.alreadyTreated=true}})}return true}else{return false}},displayChildrenSearchMethod:function(w,u){var v=u.nodeModel;if(v.options.alreadyTreated!==undefined){return v.options.alreadyTreated}if(v.getLabel().toLowerCase().includes(w.toLowerCase())){var t=function(y){var x=y.getChildren();if(x){x.forEach(function(z){z.options.alreadyTreated=true;t(z)})}};t(v);return true}else{return false}},_preselectedIndexModified:function(){},_selectedIndexModified:function(){if(!this.mainElementVisibleFlag){return}if(this.enableSearchFlag){this._emptySearched=false;if(this.selectedIndex===-1){this.elements.mainElement.value=this._lastCustomEntry}else{this._lastCustomEntry="";this.elements.mainElement.value=this._getAllDescendants()[this.selectedIndex].options.label}}else{if((!this.multiSelFlag&&this.selectedIndex===-1)||(this.multiSelFlag&&this.selectedIndexes.length===0)){this.elements.mainElement.value=this._lastCustomEntry;this.elements.mainElement.addClassName("wux-combobox-placeholderstyle");if(this.placeholder){this.elements.text.textContent=this.placeholder}else{this.elements.text.textContent=""}}else{this.elements.mainElement.removeClassName("wux-combobox-placeholderstyle");if(this.multiSelFlag){var t="";for(var u=0;u<this.selectedIndexes.length;u++){var v=this._getAllDescendants()[this.selectedIndexes[u]];if(v){t+=v.options.label;if(u!==this.selectedIndexes.length-1){t+=", "}}}this.elements.text.textContent=t}else{if(this.selectedIndex>=0&&this.selectedIndex<this._getAllDescendants().length){this.elements.text.textContent=this._getAllDescendants()[this.selectedIndex].options.label}else{this.elements.text.textContent=""}}}if(!this.multiSelFlag){a.call(this)}}},_popupHidden:function(t){r.call(this);this._selectedIndexModified()},_modelLoaded:function(){r.call(this);j.call(this)},_updateCurrentProperties:function(){if(this.enableSearchFlag&&this.selectedIndex===-1){this._properties.value.value=this._lastCustomEntry!==""?this._lastCustomEntry:undefined;this._properties.currentValue.value=this._lastCustomEntry!==""?this._lastCustomEntry:undefined;this._properties.label.value=this._lastCustomEntry;this._properties.currentLabel.value=this._lastCustomEntry}else{this._parent()}},_getMainElement:function(){if(this.mainElementVisibleFlag){if(this.elements.mainElement instanceof p){return this.elements.mainElement.getContent().dsModel._myInput}return this.elements.mainElement}else{return this.elements.expander}},_getMainElementTag:function(){if(this.elements.mainElement instanceof p){return this.elements.mainElement.getContent()}return this.elements.mainElement},_applyPlaceholder:function(){this.elements.mainElement.placeholder=this.placeholder},_applyMainElementVisibleFlag:function(){this._applyProperties({})},_applyExpanderVisibleFlag:function(){var t=this._getMainElementTag();if(this.expanderVisibleFlag){this.elements.expander.show();this.getContent().removeAttribute("no-expander");t.removeClassName("wux-combobox-mainelement-noexpander")}else{this.elements.expander.hide();this.getContent().setAttributeNode(document.createAttribute("no-expander"));t.addClassName("wux-combobox-mainelement-noexpander")}},_applyEnableSearchFlag:function(){if(!this.mainElementVisibleFlag){return}if(this.enableSearchFlag){this.reachablePlaceholderFlag=true}this._applyProperties({})},_applyAutocompleteFlag:function(){if(this.enableSearchFlag&&this._isFiltering){if(this.autocompleteFlag){this._preselectedIndexModified()}else{this.elements.mainElement.value=this._regex}}},_applyActionOnClickFlag:function(){if(this.enableSearchFlag||!this.mainElementVisibleFlag){return}this._applyProperties({})},_applyDisplayStyle:function(){if(this.displayStyle==="lite"){if(!this.enableSearchFlag){this.elements.mainElement.addClassName("wux-ui-style-lite")}else{this.elements.mainElement.displayStyle="lite"}this.elements.expander.addClassName("wux-ui-style-lite")}else{if(this.displayStyle==="normal"){if(!this.enableSearchFlag){this.elements.mainElement.removeClassName("wux-ui-style-lite")}else{this.elements.mainElement.displayStyle="text"}this.elements.expander.removeClassName("wux-ui-style-lite")}}},_applyExpanderIcon:function(){if(this.elements.icon){this.elements.icon.remove()}this.elements.icon=n.generateIcon(this.expanderIcon).inject(this.elements.expander);this.elements.icon.addClassName("wux-controls-combobox-icon")},_applyProperties:function(t){var u=this.isDirty("enableSearchFlag")||(this.isDirty("actionOnClickFlag")&&this.enableSearchFlag===false)||this.isDirty("mainElementVisibleFlag");if(u){f.call(this);if(!this.mainElementVisibleFlag){this._getMainElementTag().hide();this.elements.expander.addClassName("wux-combobox-expander-nomainelement");this.elements.expander.setAttribute("style","border-left-width:1px;")}}this._parent(t);if(this.isDirty("expanderIcon")||u){this._applyExpanderIcon(t.expanderIcon)}if(this.isDirty("placeholder")||u){this._applyPlaceholder(t.placeholder)}if(this.isDirty("autocompleteFlag")||u){this._applyAutocompleteFlag(t.autocompleteFlag)}if(!this.isDirty("selectedIndex")&&u){this._applySelectedIndex(t.selectedIndex)}if(!this.isDirty("selectedIndexes")&&u){this._applySelectedIndexes(t.selectedIndexes)}if(this.isDirty("expanderVisibleFlag")||u){this._applyExpanderVisibleFlag(t.expanderVisibleFlag)}}});o.register(q,"DS/ControlsRec/AbstractRec");return q});define("DS/Controls/SpinBox",["UWA/Core","DS/Core/Core","DS/Controls/AbstractEditor","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Units/Units","DS/Decorator/DecoratorManager","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter"],function(f,d,j,i,b,o,s,p,n,q){var g=j.inherit({name:"spinBox",markForRecordFlag:true,publishedProperties:{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:true,recordFlag:true},units:{defaultValue:"",type:"string",category:"Behavior"},minValue:{defaultValue:undefined,type:"number",category:"Behavior"},maxValue:{defaultValue:undefined,type:"number",category:"Behavior"},stepValue:{defaultValue:0.1,type:"number",category:"Behavior"},pageStepValue:{defaultValue:10,type:"number",category:"Behavior"},decimals:{defaultValue:5,type:"integer",category:"Behavior",advancedSetter:true},highExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},lowExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},useScientificNotationFlag:{defaultValue:false,type:"boolean",category:"Behavior"},useCustomValidatorFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:false,type:"boolean",category:"Behavior"},useLocaleDisplayOutsideEdition:{defaultValue:false,type:"boolean",category:"Appearance"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior"}},lastValueWhenEnter:null,valueHasBeenModified:false,editHasBegun:false,keymaps:{"return":"manageEnter",esc:{keydown:"manageEscape"},pageup:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},pagedown:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},up:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},down:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},space:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"}},commands:{consume:function(){return{stopPropagation:true}},manageEnter:function(){this.elements.inputField.focus();this.getContent().focus();var u=false;if(p.isDecoratorDisplayed()){p.hideDecorator(true,true);u=true}else{u=this._validateValue(this.elements.inputField.value)}this.lastValueWhenEnter=this.value;this._endEdit();return{stopPropagation:false,infos:{actionPerformed:u}}},manageEscape:function(){if(!this.handleEditionCancel){return{stopPropagation:false}}if(p.isDecoratorDisplayed()){p.hideDecorator(false,true)}var x;this.elements.inputField.focus();this.getContent().focus();if(this.units){var y=this.elements.inputField.value;var A=y.indexOf(" ");try{var w;if(A===-1){w=new s({unit:this.units,value:parseFloat(y)})}else{w=new s({unit:y.substr(A+1),value:parseFloat(y.substr(0,A))})}try{var z=w.to(this.units);var v=z.toString();x=parseFloat(v.substring(0,v.indexOf(" ")))}catch(B){}}catch(C){}}else{x=parseFloat(this.elements.inputField.value)}var u=false;if(x!==this.lastValueWhenEnter){this.elements.inputField.value=this.lastValueWhenEnter;this.editIsCancelled=true;this.setPropertyFromUIInteraction("value",this.lastValueWhenEnter);c.call(this);this._cancelEdit();u=true}else{if(this.lastValueWhenEnter!==this.value){this.elements.inputField.value=this.lastValueWhenEnter;this.setPropertyFromUIInteraction("value",this.lastValueWhenEnter);this._cancelEdit();u=true}}this.editIsCancelled=false;return{stopPropagation:false,infos:{actionPerformed:u}}},manageArrowsKeyDown:function(v){this.elements.inputField.focus();this.getContent().focus();if(typeof this.value==="undefined"||this.value===null){this._beginEdit();this.setPropertyFromUIInteraction("value",0)}if(parseFloat(this.elements.inputField.value)!==this.value){this._validateValue(this.elements.inputField.value)}var u;if(v.keyCode===n.ARROWUP){u=this._modifyValue(this.stepValue,true)}else{if(v.keyCode===n.ARROWDOWN){u=this._modifyValue(-this.stepValue,true)}else{if(v.keyCode===n.PAGEUP){u=this._modifyValue(this.pageStepValue,true)}else{if(v.keyCode===n.PAGEDOWN){u=this._modifyValue(-this.pageStepValue,true)}}}}return{stopPropagation:true,preventDefault:true,infos:{actionPerformed:u}}},endEdit:function(){this._endEdit()}},buildView:function(){this.elements.container.addClassName("wux-controls-spinbox");this.elements.inputField=new f.Element("input",{"class":"wux-controls-lineeditor",type:"text",tabindex:0,name:"LineEditor",autocomplete:"off"}).inject(this.elements.container);this._myInput=this.elements.inputField;if(this.displayStyle==="normal"){this._createSpinBoxButtons()}},handleEvents:function(){var u=this;o.addEventOnElement(this,this.elements.inputField,"change",function(w){w.stopPropagation();var v=this;u._validateValue(v.value);u.lastValueWhenEnter=u.value});o.addEventOnElement(this,this.elements.inputField,"mousewheel",function(w){if(!u.disabled){if(u.elements.inputField===document.activeElement||u.getContent().hasAttribute("focused")){w.preventDefault();w.stopPropagation();var x=f.Event.wheelDelta(w);var v=x>0?1:-1;u._modifyValue(v*u.stepValue,true);u._endEdit()}}});o.addEventOnElement(this,this.elements.inputField,"blur",function(v){if(!u.disabled&&(!p.isDecoratorDisplayed())){if(this.value!=u.lastValueWhenEnter){u._validateValue(this.value)}k.call(u);u._endEdit()}});o.addEventOnElement(this,this.elements.inputField,i.POINTERMOVE,function(v){if(i.isTouchEvent(v)){v.preventDefault()}});o.addEventOnElement(this,this.elements.inputField,"focus",function(v){v.preventDefault()});o.addEventOnElement(this,this.elements.inputField,i.POINTERDOWN,function(v){if(i.isTouchEvent(v)&&(p.getWidget()!==u||document.activeElement!==this)){v.preventDefault();p.showDecorator(u,this)}else{if(p.isDecoratorDisplayed()){p.hideDecorator(false,true)}}});o.addEventOnElement(this,this.elements.inputField,"input",function(v){v.stopPropagation();u._beginEdit();u.setPropertyFromUIInteraction("valueToCommit",u._myInput.value)});u._updateViewOnEventFun=function(v){u._updateView()};d.onlanguagechange(u._updateViewOnEventFun)},_beginEdit:function(){if(!this.editHasBegun){this.editHasBegun=true;this.fire("beginEdit")}},_cancelEdit:function(){if(this.editHasBegun){this.editHasBegun=false;this.fire("cancelEdit")}},_endEdit:function(){if(this.editHasBegun){this.editHasBegun=false;this.fire("endEdit")}},destroy:function(){d.offlanguagechange(this._updateViewOnEventFun);this._parent()},_modifyValue:function(y,w){var u,v;if(typeof this.value==="undefined"||this.value===null){u=0}else{u=this.value+y}var x=b.round(u,Number(Math.pow(10,-1*this.decimals).toFixed(this.decimals)));if(this._getValidatedValue(x)!==this.value){if(w){this._beginEdit()}v=this._validateValue(x)}return v},increment:function(){this._modifyValue(this.stepValue)},decrement:function(){this._modifyValue(-this.stepValue)},pageIncrement:function(){this._modifyValue(this.pageStepValue)},pageDecrement:function(){this._modifyValue(-this.pageStepValue)},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.inputField.setAttributeNode(document.createAttribute("disabled"));if(this.displayStyle==="normal"){this.elements.up.setAttributeNode(document.createAttribute("disabled"));this.elements.down.setAttributeNode(document.createAttribute("disabled"))}}else{this.elements.inputField.removeAttribute("disabled");if(this.displayStyle==="normal"){this.elements.up.removeAttribute("disabled");this.elements.down.removeAttribute("disabled")}}},_applyEscapeHTML:function(u){},_applyTouchMode:function(){this._parent();var u=this._getCurrentTouchMode();if(u===true){if(!this.elements.buttonsDivLeft){this.elements.buttonsDivLeft=new f.Element("div",{"class":"wux-controls-lineeditor-buttonsDivLeft",tabindex:-1}).inject(this.elements.buttons)}if(this.displayStyle==="normal"){this.elements.down.inject((u)?this.elements.buttonsDivLeft:this.elements.buttonsDiv);this.elements.inputField.setStyle("padding-right","52px");this.elements.inputField.setStyle("padding-left","52px")}if(this.displayStyle==="lite"){this.elements.inputField.setStyle("padding-right","13px");this.elements.inputField.setStyle("padding-left","13px")}}else{if(this.displayStyle==="normal"){this.elements.down.inject((u)?this.elements.buttonsDivLeft:this.elements.buttonsDiv);this.elements.inputField.setStyle("padding-right","22px");this.elements.inputField.setStyle("padding-left","6px")}if(this.displayStyle==="lite"){this.elements.inputField.setStyle("padding-right","6px");this.elements.inputField.setStyle("padding-left","6px")}}},_applyDisplayStyle:function(){if(this.displayStyle==="normal"){this._createSpinBoxButtons()}else{this._deleteSpinBoxButtons()}this._applyTouchMode()},_preEditDecimals:function(u,v){if(v!==null){if(v>9){this.decimals=9;return false}else{if(v<0){this.decimals=0;return false}}}return true},_applyDecimals:function(){this._updateView()},_applyUnits:function(){this._updateView()},_applyUseLocaleDisplayOutsideEdition:function(){this._updateView()},_preEditValue:function(u,w){if(typeof w!=="undefined"&&isNaN(w)){this._cancelEdit();return false}else{var v=e.call(this,w);if(v!==w){this.value=v;return false}else{if(w===u&&this.lastValueWhenEnter!==this.value){}return true}}},_applyValue:function(u){this.valueHasBeenModified=true;this._updateView();this.valueHasBeenModified=false;if(!this.editIsCancelled){this.lastValueWhenEnter=this.value;this.fire("change")}this._properties.valueToCommit.value=this.value},_applyMinValue:function(u){if(this.minValue){var v=e.call(this,this.value);if(v!==this.value){this.value=v}}},_applyMaxValue:function(u){if(this.maxValue){var v=e.call(this,this.value);if(v!==this.value){this.value=v}}},_applyHighExponentProperty:function(u){this._updateView()},_applyLowExponentProperty:function(u){this._updateView()},_applyProperties:function(u){this._parent(u);if(this.isDirty("placeholder")){this._applyPlaceholder()}if(this.isDirty("value")){this._preEditValue(u.value,this.value);this._applyValue()}if(this.isDirty("requiredFlag")){this._applyRequiredFlag(this.requiredFlag)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(this.displayStyle)}},_giveFocus:function(){if(this._isFocused()){return}this._parent();if(!i.isLastEventTouch()){this._myInput.focus()}if(!this.disabled){if(!p.isDecoratorDisplayed()){c.call(this)}if(this.selectAllOnFocus&&!p.isDecoratorDisplayed()){this.elements.inputField.setSelectionRange(0,0);this.elements.inputField.select()}}},getInputText:function(){return this.elements.inputField.value},_updateView:function(){if(this.getContent().getAttributeNode("focused")!==null){c.call(this)}else{k.call(this)}},_validateValue:function(u){this.fire("preValidateValue",{value:u});var w=false;if(!this.useCustomValidatorFlag){var v=this._getValidatedValue(u);if(v!==this.value){this.setPropertyFromUIInteraction("value",v);w=true}}this._updateView();return w},_createSpinBoxButtons:function(){if(!this.elements.buttons){this.elements.buttons=new f.Element("div",{"class":"wux-controls-lineeditor-buttons",tabindex:-1});this.elements.buttonsDiv=new f.Element("div",{"class":"wux-controls-lineeditor-buttonsDivRight",tabindex:-1}).inject(this.elements.buttons);this.elements.up=new f.Element("button",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-up",tabindex:-1,name:"Button"}).inject(this.elements.buttonsDiv);this.elements.down=new f.Element("button",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down",tabindex:-1,name:"Button"}).inject(this.elements.buttonsDiv);this.elements.buttons.inject(this.elements.container);var u,x;var w,y;var v=this;o.addEventOnElement(this,this.elements.up,i.POINTERUP,function(z){z.preventDefault();z.stopPropagation();clearTimeout(y);clearInterval(w);v._endEdit()});o.addEventOnElement(this,this.elements.up,i.POINTERDOWN,function(z){z.stopPropagation();z.preventDefault();y=setTimeout(function(){w=setInterval(function(){o._pushUserInteractionContext();v._modifyValue(v.stepValue,true);o._popUserInteractionContext()},100)},100);if(!i.isTouchEvent(z)){v.elements.inputField.focus()}else{v.getContent().setAttributeNode(document.createAttribute("focused"))}if(typeof v.value==="undefined"||v.value===null){v._beginEdit();v.setPropertyFromUIInteraction("value",0)}if(parseFloat(v.elements.inputField.value)!==v.value){v._validateValue(v.elements.inputField.value)}v._modifyValue(v.stepValue,true)});o.addEventOnElement(this,this.elements.down,i.POINTERUP,function(z){clearTimeout(x);clearInterval(u);z.preventDefault();z.stopPropagation();v._endEdit()});o.addEventOnElement(this,this.elements.down,i.POINTERDOWN,function(z){z.stopPropagation();z.preventDefault();x=setTimeout(function(){u=setInterval(function(){o._pushUserInteractionContext();v._modifyValue(-v.stepValue,true);o._popUserInteractionContext()},100)},100);if(!i.isTouchEvent(z)){v.elements.inputField.focus()}else{v.getContent().setAttributeNode(document.createAttribute("focused"))}if(typeof v.value==="undefined"||v.value===null){v._beginEdit();v.setPropertyFromUIInteraction("value",0)}if(parseFloat(v.elements.inputField.value)!=v.value){v._validateValue(v.elements.inputField.value)}v._modifyValue(-v.stepValue,true)});o.addEventOnElement(this,document,i.POINTERUP,function(A){clearTimeout(x);clearInterval(u);clearTimeout(y);clearInterval(w);var z=A.clientX;var B=A.clientY;v._endEdit();if(p.isDecoratorDisplayed()&&!b.isMouseOverElement(p.getWidget().getContent(),{x:z,y:B})&&!b.isMouseOverElement(p.getDecorator().getContent(),{x:z,y:B})){p.hideDecorator(true,true)}})}else{this.elements.buttons.show()}},_deleteSpinBoxButtons:function(){this.elements.buttons.hide()},_changeValueInExpForm:function(){var u=this.lowExponentProperty;var x=this.highExponentProperty;var v=a(this.value)-1;if(v<0){v=0}var w=Math.abs(this.value);if(this.useScientificNotationFlag){return true}if(this.value!==0&&this.decimals<u&&(w<Math.pow(10,-this.decimals))){u=Math.ceil(-(Math.log(this.value)/Math.LN10))-1}if(w>=Math.pow(10,x)||(this.value!==0&&w<Math.pow(10,-u))){return true}return false},_getValidatedValue:function(w){var C=this;if(this.allowUndefinedFlag&&w===""){return undefined}w=w.replace(/\s(?=[^a-zA-Z])/,"");var z=w;var v;if(C.units){var y=w.indexOf(" ");try{if(y===-1){v=new s({unit:C.units,value:parseFloat(w)})}else{v=new s({unit:w.substr(y+1),value:parseFloat(w.substr(0,y))})}try{var x=v.to(C.units);var u=x.toString();z=parseFloat(u.substring(0,u.indexOf(" ")))}catch(B){z=v.options.value}}catch(A){z=parseFloat(u.substring(0,u.indexOf(" ")))}}else{var E=C.elements.inputField.value.indexOf("e");if(E>=1){z=parseFloat(w.replace(",","."))}else{z=parseFloat(w)}}var D=e.call(this,z);return D}});function a(v){var u=(String(v)).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!u){return 0}return Math.max(0,(u[1]?u[1].length:0)-(u[2]?Number(u[2]):0))}function m(u){return u.toLocaleString(d.currentLanguage)}function l(v){var u;if(parseInt(v)==="NaN"){return undefined}else{v=parseFloat(v);var w=v.toExponential();u=w.split("e");u[0]=parseFloat(u[0]);u[1]="e"+u[1];return u}}function t(v){if(v!==null&&v!==undefined){if(v.match(/e/)){return v.replace(/0+e/,"e").replace(/\.e|\,e/,"e")}else{if(v.match(/\.|\,/)){var u=v;if(v.match(/\./)){u=u.replace(/0+$/,"").replace(/\.$/,"")}if(v.match(/\,/)){u=u.replace(/\,$/,"")}return u}else{return v}}}}function h(u){if(u){return Boolean(u.toString().match(/\./))}}function r(u){if(u&&h(u)){return(String(u).match(/\.[0-9]+|\,[0-9]+/)[0].length-1)-(String(u).match(/0+$|0+$/)?String(u).match(/0+$|0+$/)[0].length:0)}}function k(){var v=this;if(v.elements.inputField){if(typeof v.value==="undefined"||v.value===null){v.elements.inputField.value="";return}var y=l(v.value);var x="";if(v.decimals!==null){var u=v.decimals;if(v._changeValueInExpForm()){var w;if(v.useLocaleDisplayOutsideEdition){w=parseFloat(y[0].toFixed(u)).toLocaleString(d.currentLanguage,{maximumFractionDigits:u})}else{w=parseFloat(y[0].toFixed(u))}x=t(w+y[1])}else{if(v.useLocaleDisplayOutsideEdition){x=parseFloat(v.value).toLocaleString(d.currentLanguage,{maximumFractionDigits:u})}else{if(isNaN(v.value)){v.value=undefined}else{x=parseFloat(v.value.toFixed(u))}}}}else{if(v._changeValueInExpForm()){if(v.useLocaleDisplayOutsideEdition){if(h(v.value)){x=t(y[0].toLocaleString(d.currentLanguage,{maximumFractionDigits:(String(y[0]).match(/.[1-9]+|,[1-9]/)[0].length-1)})+y[1])}else{x=t(y[0].toLocaleString(d.currentLanguage)+y[1])}}else{x=t(y[0]+y[1])}}else{if(v.useLocaleDisplayOutsideEdition){if(h(v.value)){x=v.value.toLocaleString(d.currentLanguage,{maximumFractionDigits:r(v.value)})}else{x=v.value.toLocaleString(d.currentLanguage)}}else{x=v.value}}}if(v.units){x=x+" "+v.units}if(x!==undefined&&x.toString()!==v.elements.inputField.value){v.elements.inputField.value=x}}}function c(){if(this._preventUpdateOnNextFocus){this._preventUpdateOnNextFocus=false;return}var u=this;var w;if(u.elements.inputField){if(typeof u.value==="undefined"||u.value===null){u.elements.inputField.value="";return}if(u.useScientificNotationFlag){var x=l(u.value);var v=u.decimals===null?parseFloat(x[0]):parseFloat(x[0].toFixed(u.decimals));w=t(v+x[1])}else{if(u.decimals!==null){if(isNaN(u.value)){u.value=undefined}else{w=parseFloat(u.value.toFixed(u.decimals))}}else{w=u.value}}if(u.units){w=w+" "+u.units}if(w!==undefined&&w!==u.elements.inputField.value){u.elements.inputField.value=w}}}function e(u){if((this.maxValue!==undefined)&&(this.maxValue!==null)&&(u>this.maxValue)){u=this.maxValue}if((this.minValue!==undefined)&&(this.minValue!==null)&&(u<this.minValue)){u=this.minValue}return u}q.register(g,"DS/ControlsRec/AbstractRec");return g});define("DS/Controls/Calendar",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/Utils","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","UWA/Utils/Client","DS/WebRecordEnabler/Adapter","DS/Controls/ComboBox","DS/Controls/Button"],function(e,m,g,h,a,i,f,n,k,d,p,l){var j;function c(q){return q<10?"0"+q:String(q)}var b=g.inherit({name:"calendar",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",advancedSetter:true,recordFlag:true},referenceDate:{defaultValue:null,type:"date",category:"Behavior"},minValue:{defaultValue:null,type:"date",category:"Behavior"},maxValue:{defaultValue:null,type:"date",category:"Behavior"}},blackBoxFlag:true,buildView:function(){j=new Date().getDate();this._updateLanguage();this.currentDate=new Date();this._properties.referenceDate.value=new Date();var r=Date.locale.month_names[this.currentDate.getMonth()],q=this.currentDate.getFullYear();this.elements.container.addClassName("wux-controls-calendar");this.elements.container.setAttribute("tabindex",0);this.elements.calendarHeader=new e.Element("div",{"class":"wux-controls-calendar-header"}).inject(this.elements.container);this.elements.left=new e.Element("div",{"class":"wux-controls-calendar-button  left","data-inc":"left"}).inject(this.elements.calendarHeader);this.elements.left.innerHTML='<i class="wux-ui-3ds wux-ui-3ds-expand-left"></i>';this.elements.center=new e.Element("div",{"class":"wux-controls-calendar-center"}).inject(this.elements.calendarHeader);this.monthsCombo=new p({elementsList:Date.locale.month_names,currentValue:Date.locale.month_names[this.currentDate.getMonth()],enableSearchFlag:true,autocompleteFlag:true,expanderVisibleFlag:false}).inject(this.elements.center);this.monthsCombo.getContent().style.maxWidth="72px";this._buildYearsList();this.elements.right=new e.Element("div",{html:">","class":"wux-controls-calendar-button  right","data-inc":"right"}).inject(this.elements.calendarHeader);this.elements.right.innerHTML='<i class="wux-ui-3ds wux-ui-3ds-expand-right"></i>';this.elements.calendarContainer=new e.Element("table",{"class":"wux-controls-calendar-table"}).inject(this.elements.container);this.elements.calendarTabHead=new e.Element("thead",{"class":"wux-controls-calendar-table-head",html:function(){return"<tr></tr>"}}).inject(this.elements.calendarContainer);this._updateColumnsHeader();this.elements.calendarFooter=new e.Element("div",{"class":"wux-controls-calendar-footer"}).inject(this.elements.container);this.elements.timePicker=new e.Element("div",{"class":"wux-controls-calendar-timePicker"}).inject(this.elements.calendarFooter);this.todayButton=new l({label:"Today"}).inject(this.elements.calendarFooter);this.todayButton.getContent().addClassName("wux-controls-calendar-todaybutton");this._properties.value.value=new Date(this.currentDate)},_buildCalendarDays:function(F,x){var J=this;var I=new Date(x,F);var A=o.call(J,I);var E=new Date();var z=new e.Element("tbody");var G;I.setDate(I.getDate()-A);var H=I.getMonth();var y=I.getFullYear();for(var D=0;D<A;D++){if(D===0){G=new e.Element("tr");z.appendChild(G)}var t=I.getDate();var L=String(Date.locale.day_names[D]+", "+Date.locale.month_names[H]+" "+t+", "+y);var r="other-date";if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}var s=new e.Element("td",{"class":r,text:t,title:L,});a.addEventOnElement(this,s,"click",function(P){if((J.disabled===false)&&(!this.hasClassName("unclickable"))){J._decrement();var Q=J.elements.container.querySelectorAll(".days");if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");if(Q[this.innerHTML-1]!==undefined){Q[this.innerHTML-1].classList.toggle("selected")}}else{if(Q[this.innerHTML-1]!==undefined){Q[this.innerHTML-1].classList.toggle("selected")}}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});s.setData("value",c(t)+"/"+c(H+1)+"/"+y);G.appendChild(s);I.setDate(t+1)}var v=A;var u=I.getMonth();var q=I.getFullYear();while(I.getMonth()===F){var t=I.getDate();if(v===0){G=new e.Element("tr");z.appendChild(G)}var L=String(Date.locale.day_names[v]+", "+Date.locale.month_names[u]+" "+t+", "+q);v=(v+1)%(Date.locale.day_names.length);var r="";r="days";if(t===E.getDate()&&E.getMonth()===F&&E.getFullYear()===x){r="today"}if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}if(this.value){if(t===this.value.getDate()&&u===this.value.getMonth()&&q===this.value.getFullYear()){r+=" selected"}}this.elements.days=new e.Element("td",{"class":r,title:L,text:t,}).setData("value",c(t)+"/"+c(u+1)+"/"+q);a.addEventOnElement(this,this.elements.days,"click",function(P){P.stopPropagation();if((J.disabled===false)&&(!this.hasClassName("unclickable"))){if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");this.classList.toggle("selected")}else{this.classList.toggle("selected")}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});G.appendChild(this.elements.days);I.setDate(t+1)}if(v!==0){var K=I.getMonth();var B=I.getFullYear();for(var C=v;C<Date.locale.day_names.length;C++){var t=I.getDate();var L=String(Date.locale.day_names[C]+", "+Date.locale.month_names[K]+" "+t+", "+B);var r="other-date";if((J.minValue&&(I<J.minValue))||(J.maxValue&&(I>J.maxValue))){r+=" unclickable"}var w=new e.Element("td",{"class":r,text:t,title:L,}).setData("value",c(t)+"/"+c(K+1)+"/"+B);a.addEventOnElement(this,w,"click",function(){if((J.disabled===false)&&(!this.hasClassName("unclickable"))){J._incremFromAfterDay=true;J._increment();var P=J.elements.container.querySelectorAll(".days");if(J.elements.container.querySelector(".selected")!==null){J.elements.container.querySelector(".selected").classList.toggle("selected");P[this.innerHTML-1].classList.toggle("selected")}else{P[this.innerHTML-1].classList.toggle("selected")}var M=this.getData("value").substring(0,2),O=this.getData("value").substring(3,5),N=this.getData("value").substring(6,10);J.setPropertyFromUIInteraction("value",new Date(N,O-1,M),"click_Day")}});G.appendChild(w);I.setDate(t+1)}}z.appendChild(G);return z},_buildYearsList:function(){var r=this.referenceDate.getFullYear();var u=-10;var q=10;var t=false;if(this.yearsList&&this.yearsList.indexOf(r.toString())===-1){t=true}this.yearsList=[];if(this.minValue){u=this.minValue.getFullYear()-r}if(this.maxValue){q=this.maxValue.getFullYear()-r}for(var s=u;s<=q;s++){this.yearsList[this.yearsList.length]=String(r+s);t=true}if(this.yearsCombo){this.yearsCombo.elements.mainElement.getContent().addClassName("wux-calendar-yearscombo");if(t){this._isBuildYearsList=true;if(this.yearsCombo.elementsList.toString()!==this.yearsList.toString()){this.monthsCombo.currentValue=Date.locale.month_names[this.referenceDate.getMonth()];this.yearsCombo.elementsList=this.yearsList}this.yearsCombo.currentValue=r.toString();this._isBuildYearsList=undefined}}else{this.yearsCombo=new p({elementsList:this.yearsList,currentValue:this.currentDate.getFullYear().toString(),enableSearchFlag:true,autocompleteFlag:true,expanderVisibleFlag:false}).inject(this.elements.center)}this.yearsCombo.getContent().style.maxWidth="74px";this.yearsCombo.getContent().style.marginLeft="4px"},handleEvents:function(){var r=this;r._isLeftDown=false;r._isRightDown=false;this.elements.left.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){r._isLeftDown=true}});this.elements.left.addEvent(f.POINTERUP,function(t){if(r.disabled===false&&r._isLeftDown){r._decrement();r.elements.calendarTab.className="";r._isLeftDown=false}});this.elements.right.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){r._isRightDown=true}});this.elements.right.addEvent(f.POINTERUP,function(t){if(r.disabled===false&&r._isRightDown){r._increment();r.elements.calendarTab.className="";r._isRightDown=false}});this.monthsCombo.addEventListener("show",function(t){t.stopPropagation()});this.yearsCombo.addEventListener("show",function(t){t.stopPropagation()});this.monthsCombo.addEventListener("hide",function(t){t.stopPropagation()});this.yearsCombo.addEventListener("hide",function(t){t.stopPropagation()});this.monthsCombo.addEventListener("change",function(u){u.stopPropagation();var t=Date.locale.month_names.indexOf(r.monthsCombo.currentValue);if(t===-1){t=r.referenceDate.getMonth();r.monthsCombo.value=Date.locale.month_names[r.referenceDate.getMonth()].toString()}if(r._isCurrentlyCalledFromUIInteraction()){r._setReferenceDate(new Date(r.referenceDate.getFullYear(),t,1))}else{r._setReferenceDate(new Date(r.referenceDate.getFullYear(),t,r.referenceDate.getDate()))}r._redrawCalendar()});this.yearsCombo.addEventListener("change",function(x){x.stopPropagation();var w;var v=parseInt(r.yearsCombo.currentValue);if(isNaN(v)){r.yearsCombo.value=r.referenceDate.getFullYear().toString()}else{if(!(v>=1000&&v<=9999)){r.yearsCombo.value=r.referenceDate.getFullYear().toString()}}var u=Date.locale.month_names.indexOf(r.monthsCombo.currentValue);if(!r._isBuildYearsList&&(u!==r.referenceDate.getMonth()||parseInt(r.yearsCombo.currentValue)!==r.referenceDate.getFullYear())){var t=new Date(parseInt(r.yearsCombo.currentValue),u,1);if(!isNaN(t)){r._setReferenceDate(t);w=true}else{r.yearsCombo.value=String(r.referenceDate.getFullYear())}}if(w){r._buildYearsList();r._redrawCalendar()}});a.addEventOnElement(this,this.todayButton.getContent(),"buttonclick",function(u){if(r.disabled===false){var t;t=new Date();r._properties.referenceDate.value=t;r._setCurrentDate(t);r.elements.calendarTab.remove();r.elements.calendarTabHead.show();r.elements.calendarTab=r._buildCalendarDays(r.currentDate.getMonth(),r.currentDate.getFullYear(),t.getDate());r.elements.calendarTab.inject(r.elements.calendarContainer);r._redrawCalendar()}});this.elements.calendarContainer.addEventListener(f.POINTERMOVE,function(t){t.preventDefault();t.stopPropagation()});this.elements.container.addEvent("mousewheel",function(t){if(r.disabled===false&&(r.elements.container===document.activeElement||r.getContent().hasAttribute("focused"))){t.preventDefault();t.stopPropagation();var u=e.Event.wheelDelta(event);if(u>0){r._decrement()}else{r._increment()}}});a.addEventOnElement(this,this.elements.container,"keydown",function(u){var t;if(u.keyCode===n.LEFTARROW){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()-1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_leftArrow")}else{if(u.keyCode===n.RIGHTARROW){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()+1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_rightArrow")}else{if(u.keyCode===n.ARROWUP){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()-7);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_arrowUp")}else{if(u.keyCode===n.ARROWDOWN){t=new Date(r.referenceDate);t.setDate(r.referenceDate.getDate()+7);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_arrowDown")}else{if(u.keyCode===n.PAGEUP){t=new Date(r.referenceDate);t.setMonth(r.referenceDate.getMonth()-1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_pageUp")}else{if(u.keyCode===n.PAGEDOWN){t=new Date(r.referenceDate);t.setMonth(r.referenceDate.getMonth()+1);r.setPropertyFromUIInteraction("referenceDate",t,"keydown_pageDown")}}}}}}});var q,s;a.addEventOnElement(this,document,f.POINTERUP,function(t){clearTimeout(s);clearInterval(q)});this.elements.left.addEvent(f.POINTERUP,function(t){t.stopPropagation();t.preventDefault();clearTimeout(s);clearInterval(q)});this.elements.left.addEvent(f.POINTERDOWN,function(t){t.stopPropagation();t.preventDefault();s=setTimeout(function(){q=setInterval(function(){a._pushUserInteractionContext();r._decrement();a._popUserInteractionContext()},100)},100)});this.elements.right.addEvent(f.POINTERUP,function(t){t.stopPropagation();t.preventDefault();clearTimeout(s);clearInterval(q)});this.elements.right.addEvent(f.POINTERDOWN,function(t){if(r.disabled===false){t.stopPropagation();t.preventDefault();s=setTimeout(function(){q=setInterval(function(){a._pushUserInteractionContext();r._increment();a._popUserInteractionContext()},100)},100)}});h.onlanguagechange(function(t){r._updateLanguage();r._updateColumnsHeader();r._redrawCalendar()})},_applyProperties:function(q){this._parent(q);this._preventRedraw=true;if(this.isDirty("referenceDate")){this._applyReferenceDate()}if(this.isDirty("minValue")){this._applyMinValue()}if(this.isDirty("maxValue")){this._applyMaxValue()}if(this.isDirty("value")){this._applyValue(q.value)}this._preventRedraw=false;if(this._redrawNeeded){if(this.value){this._setReferenceDate(this.value)}else{if(!this.referenceDate){this._setReferenceDate(new Date())}}this._redrawCalendar();this._redrawNeeded=false}},_applyMinValue:function(){this._correctValueToMinMaxValues();this._buildYearsList();this._updateArrows()},_applyMaxValue:function(){this._correctValueToMinMaxValues();this._buildYearsList();this._updateArrows()},_correctValueToMinMaxValues:function(){if(!i.isDateInBetween(this.minValue,this.value,this.maxValue,"day")){if(this.minValue&&this.value<this.minValue){this.value=this.minValue;this._setCurrentDate(this.value)}else{if(this.maxValue&&this.value>this.maxValue){this.value=this.maxValue;this._setCurrentDate(this.value)}}}if(this.value){this._updateLanguage();this._redrawCalendar()}},_preEditValue:function(q,r){if(!r){return true}if(typeof r==="string"){this.value=new Date(Date.parse(r));return false}else{if(r instanceof Date){if(e.equals(q,r)){return false}else{if(!i.isDateInBetween(this.minValue,r,this.maxValue,"day")){return false}}return true}}},_applyValue:function(q){this._setCurrentDate(this.value);if(!this.value){this._redrawCalendar()}},_applyReferenceDate:function(){if(this.referenceDate){this._setReferenceDate(this.referenceDate)}else{var q=new Date();this._setReferenceDate(q)}this._redrawCalendar();if(this.referenceDate){this._buildYearsList()}},_increment:function(){var r=this;var q;if(r.referenceDate.getMonth()===11){q=r._setReferenceDate(new Date(r.referenceDate.getFullYear()+1,0,1))}else{q=r._setReferenceDate(new Date(r.referenceDate.getFullYear(),r.referenceDate.getMonth()+1,1))}if(q){r._redrawCalendar()}},_decrement:function(){var r=this;var q;if(r.referenceDate.getMonth()===0){q=r._setReferenceDate(new Date(r.referenceDate.getFullYear()-1,11,1))}else{q=r._setReferenceDate(new Date(r.referenceDate.getFullYear(),r.referenceDate.getMonth()-1,1))}if(q){r._redrawCalendar()}},_setCurrentDate:function(r){var t=this.currentDate;if(e.equals(this.currentDate,r)){return}var s,q;if(this.minValue){s=new Date(this.minValue.getFullYear(),0,1)}if(this.maxValue){q=new Date(this.maxValue.getFullYear(),11,31)}if(i.isDateInBetween(s,r,q,"day")){if(r){this.currentDate=new Date(r);this.value=this.currentDate;this._setReferenceDate(this.value);if(!(this.value.getDate()===t.getDate()&&this.value.getMonth()===t.getMonth()&&this.value.getFullYear()===t.getFullYear())){this.fire("change")}return true}}return false},_setReferenceDate:function(r){if(e.equals(this.referenceDate,r)){return}var s,q;if(this.minValue){s=new Date(this.minValue.getFullYear(),0,1)}if(this.maxValue){q=new Date(this.maxValue.getFullYear(),11,31)}if(i.isDateInBetween(s,r,q,"day")){this.referenceDate=new Date(r);return true}return false},incrementDayValue:function(){if(this.value){var q=new Date(this.value);q.setDate(this.value.getDate()+1);this.value=q}},decrementDayValue:function(){if(this.value){var q=new Date(this.value);q.setDate(this.value.getDate()-1);this.value=q}},incrementMonthValue:function(){if(this.value){var q=new Date(this.value);q.setMonth(this.value.getMonth()+1);this.value=q}},decrementMonthValue:function(){if(this.value){var q=new Date(this.value);q.setMonth(this.value.getMonth()-1);this.value=q}},incrementYearValue:function(){if(this.value){var q=new Date(this.value);q.setFullYear(this.value.getFullYear()+1);this.value=q}},decrementYearValue:function(){if(this.value){var q=new Date(this.value);q.setFullYear(this.value.getFullYear()-1);this.value=q}},_redrawCalendar:function(){var t=this.referenceDate.getMonth();var r=this.referenceDate.getFullYear();if(this._preventRedraw){this._redrawNeeded=true;return}var q=new Date();if(this.elements.calendarTab){this.elements.calendarTab.remove()}var s=Date.locale.day_names[o.call(this,q)]+", "+Date.locale.month_names[q.getMonth()]+" "+q.getDate()+", "+q.getFullYear();this.elements.calendarFooter.set("title",s);this.elements.calendarTab=this._buildCalendarDays(t,r);this.elements.calendarTabHead.show();this.elements.calendarFooter.show();this.elements.calendarTab.inject(this.elements.calendarContainer);this._buildYearsList();this.monthsCombo.currentValue=Date.locale.month_names[this.referenceDate.getMonth()];this.yearsCombo.currentValue=this.referenceDate.getFullYear().toString();this._updateArrows()},_updateArrows:function(){var q=true;if(this.minValue){if(this.referenceDate.getMonth()===0){if(this.minValue.getFullYear()>this.referenceDate.getFullYear()-1){q=false}}else{if(this.minValue.getFullYear()>this.referenceDate.getFullYear()){q=false}}if(!q){this.elements.left.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.left.removeAttribute("disabled")}}q=true;if(this.maxValue){if(this.referenceDate.getMonth()===11){if(this.maxValue.getFullYear()<this.referenceDate.getFullYear()+1){q=false}}else{if(this.maxValue.getFullYear()<this.referenceDate.getFullYear()){q=false}}if(!q){this.elements.right.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.right.removeAttribute("disabled")}}},_updateColumnsHeader:function(){var t="";for(var r=0;r<Date.locale.day_names_short.length;r++){var q=Date.locale.day_names_short[r],s=Date.locale.day_names[r];t+="<th scope='col' title='"+s+"'>"+q+"</th>"}this.elements.calendarTabHead.innerHTML=t},_fadeOut:function(q){q.style.opacity=1;(function r(){if((q.style.opacity-=0.1)<0){q.style.display="none"}else{requestAnimationFrame(r)}})()},_fadeIn:function(q){q.style.opacity=0;(function r(){var s=parseFloat(q.style.opacity);if(((s+=0.1)<=1)){q.style.opacity=s;requestAnimationFrame(r)}})()},_slide:function(r,s,t){if(r){if(s==="toLeft"){s="300px"}else{if(s==="toRight"){s="-300px"}}r.addClassName("wux-controls-calendar-table-animated");r.setStyle("margin-left",s);r.setStyle("opacity","0");var q=function(u){if(t){t()}r.removeClassName("wux-controls-calendar-table-animated");r.setStyle("margin-left","0px");r.setStyle("opacity","1");r.removeEvent("transitionend",q)};r.addEvent("transitionend",q)}},_capitalizeFirstLetter:function(q){return q.charAt(0).toUpperCase()+q.slice(1)},_updateLanguage:function(){var q=k.Engine;if(q.safari||navigator.platform==="iPad"||navigator.platform==="iPhone"){if(h.currentLanguage==="fr"||h.currentLanguage==="fr-FR"||h.currentLanguage==="FR"){Date.locale={day_names:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_names_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],month_names:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],month_names_short:["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Ao","Sep","Oct","Nov","Dc"]}}else{Date.locale={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_names_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}}else{var t=new Date(0,0,1);var s=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours());t=s;Date.locale={};Date.locale.day_names=[];Date.locale.day_names_short=[];Date.locale.month_names=[];Date.locale.month_names_short=[];for(var r=0;r<7;r++){Date.locale.day_names.push(this._capitalizeFirstLetter(t.toLocaleDateString(h.currentLanguage,{weekday:"long"})));Date.locale.day_names_short.push(t.toLocaleDateString(h.currentLanguage,{weekday:"short"}));t.setDate(t.getDate()+1)}for(var r=0;r<12;r++){Date.locale.month_names.push(this._capitalizeFirstLetter(t.toLocaleDateString(h.currentLanguage,{month:"long"})));Date.locale.month_names_short.push(t.toLocaleDateString(h.currentLanguage,{month:"short"}));t.setMonth(t.getMonth()+1)}}if(this.monthsCombo&&this.monthsCombo.elementsList.toString()!==Date.locale.month_names.toString()){this.monthsCombo.elementsList=Date.locale.month_names}}});var o=function(t){var r=k.Engine;if(r.safari||navigator.platform==="iPad"||navigator.platform==="iPhone"){return t.getDay()}var q=t.toLocaleDateString(h.currentLanguage,{weekday:"short"});var s=Date.locale.day_names_short.indexOf(q);return s};d.register(b,"DS/ControlsRec/AbstractRec");return b});define("DS/Controls/DatePicker",["UWA/Core","DS/Controls/Abstract","DS/Core/Core","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/Popup","DS/Controls/Calendar","DS/Controls/TimePicker","DS/Controls/LineEditor","DS/Controls/Button","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils"],function(h,j,k,a,l,f,c,q,b,o,e,p){function g(r){if(Object.prototype.toString.call(r)!=="[object Date]"){return false}return !isNaN(r.getTime())}function d(s,r){if(!g(s)||!g(r)){return false}if(s.getTime()===r.getTime()){return true}else{return false}}function n(){if(this._preventUpdateView){this._updateViewNeeded=true;return}if(this.value){if(this._editModeFlag){var s={year:"numeric",month:"2-digit",day:"2-digit"};if(this.timePickerFlag){s.hour="2-digit";s.minute="2-digit";if(this.timePickerPrecision==="sec"){s.second="2-digit"}s.hour12=false}if(this.timePickerFlag){this.elements.inputField.value=(this.value?this.value.toLocaleString("en-GB",s):"")}else{this.elements.inputField.value=(this.value?this.value.toLocaleDateString("en-GB",s):"")}this._editModeFlag=false}else{var r={year:"numeric",month:"short",day:"numeric"};if(this.timePickerFlag){r.hour="2-digit";r.minute="2-digit";if(this.timePickerPrecision==="sec"){r.second="2-digit"}}if(this.timePickerFlag){this.elements.inputField.value=(this.value?this.value.toLocaleString(this._currentLanguage,r):"")}else{this.elements.inputField.value=(this.value?this.value.toLocaleDateString(this._currentLanguage,r):"")}}}else{this.elements.inputField.value="";this._editModeFlag=false}}var m=j.inherit({name:"datePicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:null,type:"date",category:"Behavior",recordFlag:true,advancedSetter:true},minValue:{defaultValue:null,type:"date",category:"Behavior"},maxValue:{defaultValue:null,type:"date",category:"Behavior"},timePickerFlag:{defaultValue:false,type:"boolean",category:"Appearance"},timePickerPrecision:{defaultValue:"min",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true}},blackBoxFlag:true,_smartInputClass:"wux-controls-datepicker",keymaps:{esc:"manageEscape",},commands:{manageEscape:function i(){if(this.elements.popup&&this.elements.popup.visibleFlag){this.elements.popup.visibleFlag=false}}},buildView:function(){var r=this;this._editModeFlag=false;this.elements.container.addClassName(this._smartInputClass);this.elements.inputField=new b({sizeInCharNumber:20,fireOnlyFromUIInteractionFlag:true}).inject(this.elements.container);this.elements.calendarButton=new o({emphasize:"primary",icon:{iconName:"calendar",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container);this.elements.calendarButton.getContent().addClassName("wux-controls-datepicker-button");this.elements.popupContent=new h.Element("div",{"class":"wux-controls-datepicker-popup-content"});this._currentLanguage=k.currentLanguage;this.value=new Date();this.publishedProperties.value.defaultValue=new Date();this._buildPopup()},handleEvents:function(){var r=this;a.addEventOnElement(this,this.elements.inputField,"change",function(y){y.stopPropagation();if(y.dsModel.value!=""){var u=y.dsModel.value.substring(0,2),x=y.dsModel.value.substring(3,5),w=y.dsModel.value.substring(6,10);var t=new Date(w,x-1,u);var s,v,z;if(r.timePickerFlag){s=y.dsModel.value.substring(12,14);v=y.dsModel.value.substring(15,17);if(r.timePickerPrecision==="sec"){z=y.dsModel.value.substring(18,20)}t.setHours(s);t.setMinutes(v);if(r.timePickerPrecision==="sec"){t.setSeconds(z)}}else{if(r.value){t.setHours(r.value.getHours());t.setMinutes(r.value.getMinutes());t.setSeconds(r.value.getSeconds())}}if(g(t)){if(((t>r.minValue)||!r.minValue)&&((t<r.maxValue)||!r.maxValue)){r.setPropertyFromUIInteraction("value",new Date(t))}else{r._editModeFlag=false;n.call(r)}}}else{if(y.dsModel.value===""){r.setPropertyFromUIInteraction("value",null)}else{r._editModeFlag=false;n.call(r)}}if(r.elements.calendar){r.elements.calendar.referenceDate=new Date(r.value);r.elements.calendar.value=new Date(r.value)}});a.addEventOnElement(this,this.elements.inputField,"focus",function(s){r._editModeFlag=true;n.call(r);s.dsModel._myInput.select()});a.addEventOnElement(this,this.elements.inputField,"blur",function(s){r._editModeFlag=false;if(r.elements.popup&&!r.elements.popup.visibleFlag){n.call(r)}});a.addEventOnElement(this,this.elements.calendarButton,"click",function(s){s.stopPropagation()});k.onlanguagechange(function(s){r._editModeFlag=false;r._currentLanguage=k.currentLanguage;n.call(r)})},incrementDay:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setDate(r.getDate()+1);if((r<this.maxValue)||!this.maxValue){this.value.setDate(this.value.getDate()+1);this._editModeFlag=false;this._applyValue(s)}}},decrementDay:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setDate(r.getDate()-1);if((r>this.minValue)||!this.minValue){this.value.setDate(this.value.getDate()-1);this._editModeFlag=false;this._applyValue(s)}}},incrementMonth:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setMonth(r.getMonth()+1);if((r<this.maxValue)||!this.maxValue){this.value.setMonth(this.value.getMonth()+1);this._editModeFlag=false;this._applyValue(s)}}},decrementMonth:function(){if(this.value){var s=this.value;var r=new Date(this.value.getFullYear(),this.value.getMonth(),this.value.getDate());r.setMonth(r.getMonth()-1);if((r>this.minValue)||!this.minValue){this.value.setMonth(this.value.getMonth()-1);this._editModeFlag=false;this._applyValue(s)}}},_preEditValue:function(r,s){if(!s){return true}if(typeof s==="string"){this.value=new Date(Date.parse(s));return false}else{if(s instanceof Date){if(h.equals(r,s)){return false}else{if(!l.isDateInBetween(this.minValue,s,this.maxValue,"day")){return false}}return true}}},_applyValue:function(s){var t=this;if(this.value){if(!g(this.value)){this.value=new Date();return}this._editModeFlag=false;var r=new Date(s);if(!(r.getDate()===this.value.getDate()&&r.getMonth()===this.value.getMonth()&&r.getFullYear()===this.value.getFullYear()&&r.getSeconds()===this.value.getSeconds()&&r.getHours()===this.value.getHours()&&r.getMinutes()===this.value.getMinutes())){n.call(this);this.fire("change")}}else{n.call(this)}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.calendarButton.disabled=true;this.elements.inputField.disabled=true}else{this.elements.calendarButton.disabled=false;this.elements.inputField.disabled=false}},_applyTouchMode:function(){this._parent();if(this.elements.calendarButton){this.elements.calendarButton.touchMode=this.touchMode}if(this.elements.inputField){this.elements.inputField.touchMode=this.touchMode}},_applyMinValue:function(){this._correctValueToMinMaxValues();if(this.elements.calendar){this.elements.calendar.minValue=this.minValue}},_applyMaxValue:function(){this._correctValueToMinMaxValues();if(this.elements.calendar){this.elements.calendar.maxValue=this.maxValue}},_correctValueToMinMaxValues:function(){if(!l.isDateInBetween(this.minValue,this.value,this.maxValue,"day")){if(this.minValue&&this.value<this.minValue){this.value=this.minValue}else{if(this.maxValue&&this.value>this.maxValue){this.value=this.maxValue}}}},_applyTimePickerFlag:function(){if(!this.elements.timePicker){if(this.timePickerFlag&&this.elements.calendar){this._buildTimePicker()}else{return}}this._editModeFlag=false;n.call(this)},_applyTimePickerPrecision:function(){if(this.elements.timePicker){this.elements.timePicker.precision=this.timePickerPrecision}this._editModeFlag=false;n.call(this)},_applyProperties:function(r){this._parent(r);this._preventUpdateView=true;if(this.isDirty("value")){this._applyValue(r.value)}if(this.isDirty("minValue")){this._applyMinValue(r.minValue)}if(this.isDirty("maxValue")){this._applyMaxValue(r.maxValue)}if(this.isDirty("timePickerFlag")){this._applyTimePickerFlag(r.timePickerFlag)}if(this.isDirty("timePickerPrecision")){this._applyTimePickerPrecision(r.timePickerPrecision)}this._preventUpdateView=false;if(this._updateViewNeeded){n.call(this);this._updateViewNeeded=false}},_giveFocus:function(){if(this._isFocused()){return}this._editModeFlag=true;this.elements.inputField._giveFocus();this.elements.inputField._myInput.select()},_applyPopupVisibleFlag:function(r){if(this.popupVisibleFlag){if(this.elements.popup){this.elements.popup.visibleFlag=true}}else{if(this.elements.popup){this.elements.popup.visibleFlag=false}}},_buildPopup:function(){var r=this;var s={target:this.elements.calendarButton.getContent(),position:"bottom",trigger:"click",constraint:"screen"};s.offset={x:-180,y:4};this.elements.popup=new f(s);this.elements.popup.addEventListener("show",function(t){t.stopPropagation();if(!r.elements.popup.getBody()){r._buildCalendarAndButtons();if(r.timePickerFlag){r._buildTimePicker()}r.elements.popup.setBody(r.elements.popupContent)}r._onShowPopupValue=new Date(r.value);if(r.elements.calendar){if(r.value){r.elements.calendar.referenceDate=new Date(r.value);r.elements.calendar.value=new Date(r.value);if(r.elements.timePicker){r.elements.timePicker.value=new Date(r.value)}}else{r.elements.calendar.value=null;if(r.elements.timePicker){r.elements.timePicker.value=null}}}r.setPropertyFromUIInteraction("popupVisibleFlag",true);r.fire("show")});this.elements.popup.addEventListener("hide",function(t){if(t.target===r.elements.popup.getContent()){t.stopPropagation();if(r.elements.timePicker&&r.value&&!d(r.elements.timePicker.value,r.value)){r.setPropertyFromUIInteraction("value",r.elements.timePicker.value,"timePicker_change")}r.setPropertyFromUIInteraction("popupVisibleFlag",false);r.fire("hide");n.call(r)}});this.elements.popup.getContent().addEventListener("keydown",function(t){if(p.ESCAPE===t.keyCode){if(r.elements.popup&&r.elements.popup.visibleFlag){r.elements.popup.visibleFlag=false}}})},_buildCalendarAndButtons:function(){var r=this;this.elements.calendar=new c({value:this.value,minValue:this.minValue,maxValue:this.maxValue,fireOnlyFromUIInteractionFlag:true});this.elements.calendar.inject(this.elements.popupContent);this.elements.calendar.addEventListener("change",function(u){u.stopPropagation();if(u.dsModel&&u.dsModel.value){var s=new Date(u.dsModel.value);if(r.elements.timePicker){s.setHours(r.elements.timePicker.value.getHours());s.setMinutes(r.elements.timePicker.value.getMinutes());s.setSeconds(r.elements.timePicker.value.getSeconds())}else{if(r.value){s.setHours(r.value.getHours());s.setMinutes(r.value.getMinutes());s.setSeconds(r.value.getSeconds())}else{var t=new Date();s.setHours(t.getHours());s.setMinutes(t.getMinutes());s.setSeconds(t.getSeconds())}}r.setPropertyFromUIInteraction("value",s);if(r.elements.timePicker){if(r.elements.timePicker.value){r.elements.timePicker.value.setDate(r.value.getDate());r.elements.timePicker.value.setMonth(r.value.getMonth());r.elements.timePicker.value.setFullYear(r.value.getFullYear())}else{r.elements.timePicker.value=new Date(r.value)}}if(r.elements.popup&&r.elements.popup.visibleFlag){r.elements.popup.visibleFlag=false}r._editModeFlag=false}})},_buildTimePicker:function(){var s=this;s.elements.timePicker=new q({value:this.value,precision:this.timePickerPrecision});var r=s.elements.popupContent.querySelector(".wux-controls-calendar-timePicker");s.elements.calendar.elements.timePicker.style.display="block";s.elements.timePicker.inject(r);if(s.timePickerPrecision==="min"){s.elements.timePicker.elements.popup.offset.x=-80}this.elements.timePicker.addEventListener("change",function(t){t.stopPropagation();if(t.dsModel&&t.dsModel.value){if(s.elements.timePicker.value&&s.value){s.elements.timePicker.value.setDate(s.value.getDate());s.elements.timePicker.value.setMonth(s.value.getMonth());s.elements.timePicker.value.setFullYear(s.value.getFullYear())}else{s.elements.timePicker.value=new Date(s.value)}s._editModeFlag=false}});this.elements.timePicker.addEventListener("show",function(t){t.stopPropagation()});this.elements.timePicker.addEventListener("hide",function(t){t.stopPropagation()})}});e.register(m,"DS/ControlsRec/AbstractRec");return m});define("DS/Controls/ColorChooser",["UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Controls/LineEditor","DS/Utilities/Color","DS/Controls/GradientSlider","DS/Utilities/KeyboardUtils","DS/WebRecordEnabler/Adapter","DS/Controls/SpinBox","DS/Utilities/Dom"],function(d,f,e,b,j,g,k,c,i,a){var h=f.inherit({name:"colorChooser",markForRecordFlag:true,publishedProperties:{value:{defaultValue:"ffffff",type:"string",advancedSetter:true,recordFlag:true},referenceValue:{defaultValue:"ffffff",type:"string"},colorChooserDimensions:{defaultValue:{x:420,y:300},type:"vector2"},informationsVisibleFlag:{defaultValue:true,type:"boolean"},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",noNeedToApplyFlag:true},},blackBoxFlag:true,buildView:function(){var o=this;this._minColorChooserDimensions={};this.elements.container.addClassName("wux-controls-colorchooser");var p="wux-controls-colorchooser-";var n=[{namediv:"_colorChooserCanvas",elemDiv:"canvas",nameCanvas:"_canvasPicker",elemCanvas:"canvas"}];n.forEach(function(q){o.elements[q.namediv]=new d.Element("div",{"class":p+q.elemDiv}).inject(o.elements.container);o.elements[q.nameCanvas]=new d.Element("canvas",{"class":p+q.elemCanvas});o.elements[q.nameCanvas].setAttribute("tabindex","1")});this.elements._pickerCursor=d.createElement("div",{"class":p+"canvas-picker-cursor wux-element-contentbox"});this.elements._pickerCursor2=d.createElement("div",{"class":p+"canvas-picker-cursor2 wux-element-contentbox"}).inject(this.elements._pickerCursor);this.elements._canvasPicker.width=this.colorChooserDimensions.x-120;this.elements._canvasPicker.height=this.colorChooserDimensions.y;this.elements._colorChooserCanvas.appendChild(this.elements._canvasPicker);this.elements._colorChooserCanvas.appendChild(this.elements._pickerCursor);var l=[{name:"_colorChooserHuePicker",elem:"picker",target:"container"},{name:"_panelInfos",elem:"informations",target:"container"},{name:"_color",elem:"picker-color",target:"_panelInfos"},{name:"_colorRef",elem:"picker-colorRef",target:"_panelInfos"},{name:"_panelColorR",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorG",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorB",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorH",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorS",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorL",elem:"informations-color",target:"_panelInfos"},{name:"_panelColorHex",elem:"informations-color",target:"_panelInfos"}];l.forEach(function(q){o.elements[q.name]=new d.Element("div",{"class":p+q.elem}).inject(o.elements[q.target])});a.addEventOnElement(this,this.elements._colorRef,e.POINTERHIT,function(q){if(q.multipleHitCount!==2){return}if(o.referenceValue!==undefined){o.fire("beginEdit");o.setPropertyFromUIInteraction("value",o.referenceValue);o.fire("endEdit")}});this.elements._slider=new g({handleEditionCancel:false,fireOnlyFromUIInteractionFlag:true,valuePopupFlag:false}).inject(this.elements._colorChooserHuePicker);this.elements._slider.displayStyle="vertical";this.elements._slider.height=this.colorChooserDimensions.y;var m=[{nameLabel:"_labelR",elemLabel:"label",target:"_panelColorR",text:" R: ",nameLineEditor:"_valueR",placeHolder:"R value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelG",elemLabel:"label",target:"_panelColorG",text:" G: ",nameLineEditor:"_valueG",placeHolder:"G value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelB",elemLabel:"label",target:"_panelColorB",text:" B: ",nameLineEditor:"_valueB",placeHolder:"B value",pattern:"^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$",minValue:0,maxValue:255},{nameLabel:"_labelH",elemLabel:"label",target:"_panelColorH",text:" H: ",minValue:0,maxValue:360,nameLineEditor:"_valueH",placeHolder:"H value",pattern:"^(?:s*|0|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9][0-9]|[1-9]))$"},{nameLabel:"_labelS",elemLabel:"label",target:"_panelColorS",text:" S: ",minValue:0,maxValue:100,nameLineEditor:"_valueS",placeHolder:"S value",pattern:"^0*(?:[0-9][0-9]?|100)$"},{nameLabel:"_labelL",elemLabel:"label",target:"_panelColorL",text:" L: ",nameLineEditor:"_valueL",placeHolder:"L value",pattern:"^0*(?:[0-9][0-9]?|100)$",minValue:0,maxValue:100},{nameLabel:"_labelHex",elemLabel:"label-hexa",target:"_panelColorHex",text:" # ",nameLineEditor:"_valueHex",placeHolder:"Hex value",pattern:"^(#{0,1}[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"}];m.forEach(function(q){o.elements[q.nameLabel]=new d.Element("div",{"class":p+q.elemLabel,text:q.text}).inject(o.elements[q.target]);if(q.nameLabel==="_labelHex"){o.elements[q.nameLineEditor]=new b({placeholder:q.placeHolder,pattern:q.pattern,sizeInCharNumber:3,value:undefined,fireOnlyFromUIInteractionFlag:true}).inject(o.elements[q.target]);o.elements[q.nameLineEditor].getContent().addClassName(p+"lineeditor")}else{o.elements[q.nameLineEditor]=new i({placeholder:q.placeHolder,pattern:q.pattern,minValue:q.minValue,maxValue:q.maxValue,stepValue:1,value:undefined,displayStyle:"lite",fireOnlyFromUIInteractionFlag:true}).inject(o.elements[q.target]);o.elements[q.nameLineEditor].getContent().addClassName(p+"spinbox")}a.onNodeRendered(o.getContent(),function(){o._updatePickerCursorPositionFromValue()})});this._pickerCanvasBackground();this.elements._pickerCursor.hide()},_postBuildView:function(){this._applyReferenceValue();if(!this.informationsVisibleFlag){this.elements._panelInfos.hide()}},_applyInformationsVisibleFlag:function(){if(!this.informationsVisibleFlag){this.elements._panelInfos.hide()}else{this.elements._panelInfos.show()}this._updateMinColorChooserDimensions();this._applyColorChooserDimensions()},_applyProperties:function(l){this._parent(l);this._applyValue(l.value,this.value);this._applyTouchMode();this._applyInformationsVisibleFlag()},_applyDisabled:function(){this._parent();this.elements._slider.disabled=this.disabled;this.elements._valueR.disabled=this.disabled;this.elements._valueG.disabled=this.disabled;this.elements._valueB.disabled=this.disabled;this.elements._valueH.disabled=this.disabled;this.elements._valueS.disabled=this.disabled;this.elements._valueL.disabled=this.disabled;this.elements._valueHex.disabled=this.disabled;if(this.disabled){this.elements.container.removeAttribute("tabindex");this.elements._colorChooserCanvas.setAttributeNode(document.createAttribute("disabled"));this.elements._pickerCursor.setAttributeNode(document.createAttribute("disabled"))}else{this.elements.container.setAttribute("tabindex","0");this.elements._colorChooserCanvas.removeAttribute("disabled");this.elements._pickerCursor.removeAttribute("disabled")}},_applyReferenceValue:function(l,n){if(this.referenceValue!==undefined){if(this.referenceValue.charAt(0)==="#"){var o=this.referenceValue.substr(1);var m=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(m.test(o)){this.referenceValue=o}else{this.referenceValue=l}}this.elements._colorRef.setStyle("background",j.colorToCssColor(j.hexToRgb(this.referenceValue)))}},_applyColorChooserDimensions:function(){var l=120;if(!this.informationsVisibleFlag){l=32}var m=Math.max(this._minColorChooserDimensions.y,this.colorChooserDimensions.y);this.elements._colorChooserCanvas.height=m;this.elements._slider.elements.canvasHuePicker.height=m;this.elements._panelInfos.height=m;this.elements.container.width=this.colorChooserDimensions.x;this.elements.container.height=m;this.elements._slider.height=m;this.elements._canvasPicker.width=this.colorChooserDimensions.x-l;this.elements._colorChooserCanvas.width=this.colorChooserDimensions.x-l;this.elements._canvasPicker.height=m;this._pickerCanvasBackground();this.elements._slider.refreshView();this._updatePickerCursorPositionFromValue()},_preEditValue:function(l,m){if(l==m){this._updatePickerCursorPositionFromValue()}},_applyValue:function(n,p){if(p===""){this.value=undefined;return}if(typeof p!=="undefined"&&p!==null){if(p.charAt(0)==="#"){this.value=p.substr(1);return}var o=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(!o.test(p)){this.value=n;return}p=p.toLowerCase();var m=j.hexToRgb(p);var l=j.rgbToHsl(m.r,m.g,m.b);if(!this.pointerdownCanvasP){this.elements._slider._setValueHex(j.hsvToHex([this._getPureH(),100,100]));this._pickerCanvasBackground();if(!this._updateFromHSLEditors){this.elements._valueH.value=Math.round(l[0])}}this.elements._color.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)));this.elements._color.removeClassName("undefined-class");var m=j.hexToRgb(this.value);if(!this._updateFromHSLEditors){this.elements._valueS.value=Math.round(l[1]);this.elements._valueL.value=Math.round(l[2])}if(!this._updateFromRGBEditors){this.elements._valueR.value=m.r;this.elements._valueG.value=m.g;this.elements._valueB.value=m.b}this.elements._pickerCursor.show();this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)));this._updatePickerCursorPositionFromValue();this.elements._valueHex.value=p}else{this.elements._valueR.value=undefined;this.elements._valueG.value=undefined;this.elements._valueB.value=undefined;this.elements._valueH.value=undefined;this.elements._valueS.value=undefined;this.elements._valueL.value=undefined;this.elements._valueHex.value=undefined;this.elements._color.addClassName("undefined-class");this.elements._pickerCursor.hide()}this.fire("change")},_applyTouchMode:function(){var l=this._getCurrentTouchMode();if(l===true){this.elements._panelInfos.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements._panelInfos.removeAttribute("touch-mode")}this._updateMinColorChooserDimensions()},_updateMinColorChooserDimensions:function(){if((this._getCurrentTouchMode())){if(this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==350){this._minColorChooserDimensions.y=350;this._applyColorChooserDimensions()}else{if(!this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==100){this._minColorChooserDimensions.y=100;this._applyColorChooserDimensions()}}}else{if(this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==240){this._minColorChooserDimensions.y=240;this._applyColorChooserDimensions()}else{if(!this.informationsVisibleFlag&&this._minColorChooserDimensions.y!==100){this._minColorChooserDimensions.y=100;this._applyColorChooserDimensions()}}}},_handleEvents:function(){var r=this;this.pointerdownCanvasP=false;this.pointerdownSliderP=false;var q=document;if(r.getContent()&&r.getContent().ownerDocument){q=r.getContent().ownerDocument}var p=function(u){if(r.disabled){return}if(!r.pointerdownCanvasP){return}r.elements._pickerCursor.show();var t=r._getMousePos(r.elements._canvasPicker,u);if(t.x>r.elements._colorChooserCanvas.clientWidth-1){t.x=r.elements._colorChooserCanvas.clientWidth-1}if(t.y>r.elements._colorChooserCanvas.clientHeight){t.y=r.elements._colorChooserCanvas.clientHeight}if(t.x<0){t.x=1}if(t.y<0){t.y=1}r.setPropertyFromUIInteraction("value",r._getValueFromMousePosInCanvas(r.elements._canvasPicker,{x:t.x,y:t.y}));r._updatePickerCursorPositionFromMousePosition({x:t.x-r.elements._pickerCursor.clientWidth,y:t.y-r.elements._pickerCursor.clientHeight})};a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERDOWN,function(u){r.elements._canvasPicker.focus();if(r.disabled){return}u.preventDefault();r.initialValue=r.value;r.pointerdownCanvasP=true;r.fire("beginEdit");var t=r._getMousePos(r.elements._canvasPicker,u);if(t.x<0){t.x=0}if(t.y<0){t.y=0}r.setPropertyFromUIInteraction("value",r._getValueFromMousePosInCanvas(r.elements._canvasPicker,{x:t.x,y:t.y}));r._updatePickerCursorPositionFromMousePosition({x:t.x-r.elements._pickerCursor.clientWidth,y:t.y-r.elements._pickerCursor.clientHeight})});a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERMOVE,p);a.addEventOnElement(this,q,e.POINTERMOVE,p);function m(v){v.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var t={r:parseInt(r.elements._valueR.value),g:parseInt(r.elements._valueG.value),b:parseInt(r.elements._valueB.value)};var u=j.rgbToHex(t);r._updateFromRGBEditors=true;r.setPropertyFromUIInteraction("value",u);r._updateFromRGBEditors=false}}function n(v){v.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var t=[parseInt(r.elements._valueH.value),Math.round(r.elements._valueS.value),Math.round(r.elements._valueL.value).toFixed(1)];var u=j.hslToHex(t);r._updateFromHSLEditors=true;r.setPropertyFromUIInteraction("value",u);r._updateFromHSLEditors=false}}function o(t){t.stopPropagation();r.fire("beginEdit")}function l(t){t.stopPropagation();r.fire("endEdit")}function s(t){t.stopPropagation();r.fire("cancelEdit")}a.addEventOnElement(this,this.elements._panelInfos,"beginEdit",o);a.addEventOnElement(this,this.elements._panelInfos,"endEdit",l);a.addEventOnElement(this,this.elements._panelInfos,"cancelEdit",s);a.addEventOnElement(this,this.elements._panelInfos,"uncommittedChange",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._panelInfos,"preValidateValue",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueR,"change",m);a.addEventOnElement(this,this.elements._valueG,"change",m);a.addEventOnElement(this,this.elements._valueB,"change",m);a.addEventOnElement(this,this.elements._valueR,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueG,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueB,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueR,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueG,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueB,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueH,"change",n);a.addEventOnElement(this,this.elements._valueS,"change",n);a.addEventOnElement(this,this.elements._valueL,"change",n);a.addEventOnElement(this,this.elements._valueH,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueS,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueL,"focus",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueH,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueS,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueL,"blur",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._valueHex,"focus",function(t){t.stopPropagation();r.fire("beginEdit")});a.addEventOnElement(this,this.elements._valueHex,"change",function(t){t.stopPropagation();if(typeof r.value!=="undefined"&&r.value!==null){var u=new RegExp("^(#{0,1}[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(u.test(r.value)){r.setPropertyFromUIInteraction("value",r.elements._valueHex.value)}else{r.value=undefined}}});a.addEventOnElement(this,this.elements._valueHex,"blur",function(t){t.stopPropagation();r.fire("endEdit")});a.addEventOnElement(this,this.elements._valueHex,"uncommittedChange",function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._slider,e.POINTERDOWN,function(t){t.stopPropagation()});a.addEventOnElement(this,this.elements._slider,"beginEdit",function(t){t.stopPropagation();r.pointerdownSliderP=true;r.initialValue=r.value;r.fire("beginEdit")});a.addEventOnElement(this,this.elements._slider,"endEdit",function(t){t.stopPropagation();r.pointerdownSliderP=false;r.fire("endEdit")});a.addEventOnElement(this,this.elements._slider,"cancelEdit",function(t){t.stopPropagation();r.pointerdownSliderP=false;r.fire("cancelEdit")});a.addEventOnElement(this,this.elements._slider,"change",function(t){if(t.target.dsModel&&t.target.dsModel.isPressed){}t.stopPropagation();var w=r.elements._slider._getValueHex();var x=j.hexToHsv(w);var v;if(r.value!==undefined&&r.value!==null){v=j.hexToHsv(r.value)}else{v=j.hexToHsv(w)}var u=j.hsvToHex([x[0],v[1],v[2]]);if(r.value===u){r.elements._valueH.value=Math.round(x[0])}else{r.setPropertyFromUIInteraction("value",u)}r._pickerCanvasBackground()});a.addEventOnElement(this,q.body,e.POINTERUP,function(t){if(r.disabled){return}if(r.pointerdownCanvasP){r.pointerdownCanvasP=false;r.fire("endEdit")}q.body.style.cursor=""});a.addEventOnElement(this,this.elements._colorChooserCanvas,"keydown",function(t){if(r.disabled){return}if(k.ESCAPE==t.keyCode&&r.pointerdownCanvasP){if(!r.handleEditionCancel){return}t.stopPropagation();if(r.initialValue!==undefined){r.setPropertyFromUIInteraction("value",r.initialValue);r.fire("cancelEdit")}}});a.addEventOnElement(this,this.elements._slider,"keydown",function(t){if(r.disabled){return}if(k.ESCAPE==t.keyCode&&r.pointerdownSliderP){if(!r.handleEditionCancel){return}t.stopPropagation();if(r.initialValue!==undefined){r.setPropertyFromUIInteraction("value",r.initialValue)}r.fire("cancelEdit")}});a.addEventOnElement(this,this.elements._colorChooserCanvas,e.POINTERUP,function(t){if(r.disabled){return}q.body.style.cursor="";if(r.pointerdownCanvasP){r.pointerdownCanvasP=false;r.fire("endEdit")}})},_getValueFromMousePosInCanvas:function(o,l){var p=o.getContext("2d");var r=p.getImageData(l.x,l.y,1,1);var n=r.data;var m={r:n[0],g:n[1],b:n[2]};var q=j.rgbToHex({r:parseInt(n[0]),g:parseInt(n[1]),b:parseInt(n[2])}).toLowerCase();return q},_updatePickerCursorPositionFromMousePosition:function(l){this.elements._pickerCursor.show();var m=document;if(this.getContent()&&this.getContent().ownerDocument){m=this.getContent().ownerDocument}m.body.style.cursor="pointer";if(l.x>=-this.elements._pickerCursor.clientWidth+1&&l.x<=this.elements._colorChooserCanvas.clientWidth-this.elements._pickerCursor.clientWidth&&l.y>=-this.elements._pickerCursor.clientHeight+1&&l.y<=this.elements._colorChooserCanvas.clientHeight-this.elements._pickerCursor.clientHeight){this.elements._pickerCursor.setStyle("left",l.x+"px");this.elements._pickerCursor.setStyle("top",l.y+"px")}},_updatePickerCursorPositionFromValue:function(){if(typeof this.value!=="undefined"&&this.value!==null){this.elements._pickerCursor.show();var n=j.hexToHsv(this.value);var m=parseFloat(n[1]);var l=parseFloat(n[2]);var p=this.elements._colorChooserCanvas.getDimensions().width*m/100;var o=this.elements._colorChooserCanvas.getDimensions().height*(100-l)/100;this.elements._pickerCursor.setStyle("left",p-this.elements._pickerCursor.getDimensions().width/2+"px");this.elements._pickerCursor.setStyle("top",o-this.elements._pickerCursor.getDimensions().height/2+"px")}},_getMousePos:function(m,l){var n=m.getBoundingClientRect();return{x:l.clientX-n.left,y:l.clientY-n.top}},_getPureH:function(){var l;var m=this.elements._slider._getValueHex();if(this.value!==undefined&&this.value!==null&&this.value!=="ffffff"){l=j.hexToHsv(this.value);if(l[0]===0){l=j.hexToHsv(m)}}else{l=j.hexToHsv(m)}return l[0]},_pickerCanvasBackground:function(){var r=this.elements._slider._getValueHex();var o=j.hsvToHex([this._getPureH(),100,100]);var n=this.elements._canvasPicker.getContext("2d");var p=this.elements._canvasPicker.width;var l=this.elements._canvasPicker.height;var m=n.createLinearGradient(0,0,p,0);var r=this.elements._slider._getValueHex();m.addColorStop(0,"white");m.addColorStop(1,j.colorToCssColor(j.hexToRgb(o)));n.fillStyle=m;n.fillRect(0,0,p,l);var q=n.createLinearGradient(0,0,0,l);q.addColorStop(0,"transparent");q.addColorStop(1,"black");n.fillStyle=q;n.fillRect(0,0,p,l);this.elements._pickerCursor.setStyle("background",j.colorToCssColor(j.hexToRgb(this.value)))}});c.register(h,"DS/ControlsRec/AbstractRec");return h});define("DS/Controls/ColorPicker",["UWA/Core","DS/Controls/Abstract","DS/Controls/ColorChooser","DS/Controls/Popup","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter"],function(f,h,a,d,g,k,l,b,c){var i=h.inherit({name:"colorPicker",markForRecordFlag:true,publishedProperties:{value:{defaultValue:"ffffff",type:"string",category:"Behavior",advancedSetter:true,recordFlag:true},referenceValue:{defaultValue:"ffffff",type:"string",category:"Behavior"},alignment:{defaultValue:"left",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:false,type:"boolean",category:"Behavior",recordFlag:true},handleEditionCancel:{defaultValue:true,type:"boolean",category:"Behavior",}},blackBoxFlag:true,keymaps:{space:{keydown:"actionPopup",keyup:"preventDefault"}},commands:{actionPopup:function e(){var m=this.elements._popup;if(m){if(m.visibleFlag){m.hide()}else{m.show()}}return{preventDefault:true,stopPropagation:true}},preventDefault:function j(){return{preventDefault:true,stopPropagation:true}}},buildView:function(){this.elements.container.addClassName("wux-controls-colorpicker-button");this.elements._colorChooser=new a({value:this.value,handleEditionCancel:false});if(!this.elements._popup){var m={target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click escape",overlap:false,recId:this.recId+"-popup",fireOnlyFromUIInteractionFlag:true};this.elements._popup=new d(m);c.ignoreForRecord(this.elements._popup.getContent());this.elements._popup.setBody(this.elements._colorChooser);this._applyAlignment();this.currentValue=this.value;this.initialValue=undefined}},_postBuildView:function(){if(this._preEditValue(undefined,this.value)){this._applyValue()}},_applyProperties:function(m){this._parent(m);if(this.isDirty("value")){if(!this._preEditValue||this._preEditValue(m.value,this.value)){this._applyValue(m.value)}}if(this.isDirty("referenceValue")){this._applyReferenceValue(m.referenceValue)}if(this.isDirty("alignment")){this._applyAlignment(m.alignment)}if(this.isDirty("popupVisibleFlag")){this._applyPopupVisibleFlag(m.popupVisibleFlag)}},_applyRecId:function(){this._parent();this.elements._popup.recId=this.recId+"-popup"},_applyAlignment:function(){if(this.elements._popup){if(this.alignment==="right"){this.elements._popup.offset.x=-405}else{this.elements._popup.offset.x=0}}},_applyTouchMode:function(){var m=this._getCurrentTouchMode();if(m===true){this.elements.container.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.container.removeAttribute("touch-mode")}},_preEditValue:function(m,o){if(typeof o!=="undefined"&&o!==null){var p=true;if(o.toString()!==o){o=o.toString();p=false}if(o.charAt(0)==="#"){o=o.substr(1);p=false}var n=new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g");if(n.test(o)){if(p){return true}else{this.value=o;return false}}else{return false}}return true},_applyValue:function(m){var o=this.value;if(this.elements.container&&this.elements._colorChooser!==undefined&&typeof o!=="undefined"&&o!==null){this.elements._colorChooser.value=o;this.elements.container.setStyle("background",k.colorToCssColor(k.hexToRgb(o)));var n=this.currentValue;if(typeof n!=="string"||typeof o!=="string"||o===null||n===null){if(o!==n&&(this.elements._popup.visibleFlag||this._popupClosingFlag)){this.fire("liveChange")}else{if(o!==n&&!this.elements._popup.visibleFlag){if(m&&o&&m!==o.substr(1)&&m.substr(1)!==o){this.fire("change")}}}}else{if(o.toLowerCase()!==n.toLowerCase()&&(this.elements._popup.visibleFlag||this._popupClosingFlag)){this.fire("liveChange")}else{if(o.toLowerCase()!==n.toLowerCase()&&!this.elements._popup.visibleFlag){if(typeof m!=="string"||m===null||typeof o!=="string"||o===null){if(m!==o){this.fire("change")}}else{if(m&&o&&m!==o.substr(1)&&m.substr(1)!==o){this.fire("change")}}}}}this.elements.container.removeClassName("undefined-class")}else{this.elements._colorChooser.value=o;this.elements.container.addClassName("undefined-class");this.elements.container.setStyle("background",k.colorToCssColor(k.hexToRgb("ffffff")))}},_applyReferenceValue:function(m){if(this.referenceValue!==undefined){this.elements._colorChooser.referenceValue=this.referenceValue}},_applyDisabled:function(m){this._parent();this.elements._colorChooser.disabled=this.disabled;if(this.disabled){this.elements.container.removeAttribute("tabindex")}else{this.elements.container.setAttribute("tabindex",0)}},_applyPopupVisibleFlag:function(m){var n=this;if(n.popupVisibleFlag){n.elements._popup.visibleFlag=true;n.fire("show")}else{n.elements._popup.visibleFlag=false;n.fire("hide",{cancelFlag:n._eventTrigger==="escape"?true:false})}},_giveFocus:function(){if(this._isFocused()){return}this.elements.container.focus()},handleEvents:function(){var m=this;b.addEventOnElement(this,this.elements._colorChooser,"beginEdit",function(n){n.stopPropagation();m.fire("beginEdit")});this.elements._colorChooser.addEventListener("change",function(n){n.stopPropagation();if(typeof m.value!=="undefined"&&m.value!==null){if(m.value.toLowerCase()!==m.elements._colorChooser.value.toLowerCase()){m.setPropertyFromUIInteraction("value",m.elements._colorChooser.value)}}else{m.setPropertyFromUIInteraction("value",m.elements._colorChooser.value)}});b.addEventOnElement(this,this.elements._colorChooser,"endEdit",function(n){n.stopPropagation()});b.addEventOnElement(this,this.elements._popup,"show",function(n){n.stopPropagation();m.elements._colorChooser.value=m.value;m.currentValue=m.value;m.initialValue=m.value;m.setPropertyFromUIInteraction("popupVisibleFlag",true)});b.addEventOnElement(this,this.elements._popup,"hide",function(n){n.stopPropagation();if(n.options.trigger==="escape"){if(m.handleEditionCancel){if(m.initialValue!==undefined&&m.handleEditionCancel===true){m.currentValue=m.value;m._popupClosingFlag=true;m.setPropertyFromUIInteraction("value",m.initialValue);m._popupClosingFlag=false}m.fire("cancelEdit")}}else{if(typeof this.currentValue==="undefined"||typeof this.value==="undefined"||this.value===null||this.currentValue===null){if(m.value!==m.currentValue&&(m.initialValue==undefined||m.value!==m.initialValue)){m.fire("change");m.fire("endEdit")}}else{if(m.value.toLowerCase()!==m.currentValue.toLowerCase()&&(m.initialValue===undefined||m.value.toLowerCase()!==m.initialValue.toLowerCase())){m.fire("change");m.fire("endEdit")}}}m.initialValue=undefined;m._eventTrigger=n.options.trigger;m.setPropertyFromUIInteraction("popupVisibleFlag",false);m._eventTrigger=undefined});b.addEventOnElement(this,this.elements._popup,"keydown",function(n){n.stopPropagation();if(l.ENTER===n.keyCode){if(n.actionPerformed!==true){if(m.popupVisibleFlag){m.elements._popup.hide()}}}})},show:function(){this.popupVisibleFlag=true},hide:function(){this.popupVisibleFlag=false}});c.register(i,"DS/ControlsRec/AbstractRec");return i});define("DS/Controls/TabBar",["UWA/Core","DS/Controls/Abstract","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/TooltipModel","DS/WebRecordEnabler/Adapter","i18n!DS/Controls/assets/nls/translation.json","DS/Menu/Menu"],function(d,N,I,K,q,z,j,F,a,x,A,v,B,l,o,E){var f="selectTab";var D="pinTab";var b="unpinTab";var s="editTab";var H="removeTab";var h="endDragTab";var P="beginDragTab";var O="changeLabelTab";var J="newTab";var n="endEditTab";var L="preNewTab";var u="contextualMenu";var g;var m;var G;var w=N.inherit({name:"tabBar",markForRecordFlag:true,publishedProperties:{newTabButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},pinFlag:{defaultValue:true,type:"boolean",category:"Behavior"},editableFlag:{defaultValue:false,type:"boolean",category:"Behavior"},centeredFlag:{defaultValue:true,type:"boolean",category:"Appearance"},closeButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},minWidth:{defaultValue:-1,type:"number",category:"Appearance"},slideStep:{defaultValue:200,type:"number",category:"Behavior"},pinnedList:{defaultValue:undefined,type:"array",category:"Behavior",advancedSetter:true,recordFlag:true},displayStyle:{defaultValue:"normal",type:"array",category:"Appearance"},value:{defaultValue:undefined,type:"array",category:"Behavior",recordFlag:true},multiSelFlag:{defaultValue:false,type:"boolean",category:"Behavior"},reorderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:true,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:undefined,type:"boolean",category:"Behavior"},},buttonGroup:null,newTabButton:null,newTabComboBox:null,showPreviousButton:null,showNextButton:null,slide:Number,pinnedListIsBeingUpdated:false,buildView:function(){this.modelEvent=new q();this.elements.container.addClassName("wux-controls-tabBar");this._history=new A();this.elements.buttonsContainer=new d.createElement("div",{"class":"wux-controls-tabBar-buttonsContainer"}).inject(this.elements.container);this.elements.tabBar=new d.createElement("div",{"class":"wux-controls-tabBar-tabs"}).inject(this.elements.container);this.elements.containerAddandNextButton=new d.Element("div",{"class":"wux-controls-tabBar-buttonsContainer-addandnext"}).inject(this.elements.buttonsContainer);this.elements.buttonGroupContainer=new d.Element("div",{"class":"wux-controls-tabBar-tabs-container"}).inject(this.elements.tabBar);this.buttonGroup=new I();this.buttonGroup.inject(this.elements.buttonGroupContainer);this.buttonGroup.getContent().setAttribute("role","presentation");this._applyCenteredFlag();this.newTabButton=new F({icon:"plus",value:"NewTab",allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton});this.newTabButton.tooltipInfos=new B({shortHelp:o.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.newTabButton.getContent().inject(this.elements.buttonsContainer);this.newTabButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNewTab");if(!this.newTabButtonFlag){this.newTabButton.getContent().hide()}this.buttonGroup.multiSelFlag=this.multiSelFlag;this.togglesTab={};this.valueSource=undefined;this.valueTarget=undefined},_postBuildView:function(){this.cptSelection=0;this.historySelection=[]},_handleEvents:function(){var T=this;var U=false;function S(){T.redrawTabBar()}this._onResizeFun=S;z.addResizeListener(this.elements.container,this._onResizeFun,0);z.onNodeRendered(this.elements.container,function(){if(T.elements.container!==undefined&&T.displayStyle.indexOf("strip")!==-1){if(T.multiSelFlag){T._applyMultiSelFlag()}T._postEditTouchMode();T.redrawTabBar()}});this.newTabButton.addEventListener("click",function(){k.call(T)});z.addEventOnElement(this,this.buttonGroup,j.POINTERDOWN,function(W){U=false;if(T.closeButtonFlag&&W.which===2){var V=W.target.parentNode;if(!V.dsModel){U=false}else{U=true}}if(W.target.value==="close"){U=true}return U});z.addEventOnElement(this,this.buttonGroup,j.POINTERUP,function(W){if(U){U=false;var V,X;if(W.target.dsModel instanceof F){V=W.target.dsModel}else{V=W.target.parentNode.dsModel}if(V===undefined){return}if(V){X=V.value}if(X!==undefined&&T.getButtonFromValue(X).elements._closeButton===undefined){return}T._closeListener(V);t(T);T.redrawTabBar()}});var R=function Q(V){if(T._preventButtonGroupListener){return}V.stopPropagation();if(T.disabled){return}T._endEditTab();var ad=T.getButtonFromValue(V.dsModel.value);if(!Array.isArray(ad)){ad=[ad]}T.setPropertyFromUIInteraction("value",T.buttonGroup.value);for(var W=0;W<ad.length;W++){var Z=ad[W];var ac=Z._index;if(ac!==-1){if(Z.checkFlag){if(T.cptSelection!==undefined){T.cptSelection++;T._setHistoryFromButton(Z,T.cptSelection)}T.modelEvent.publish({event:f,data:{index:ac,tabBar:T}})}if(T.displayStyle.indexOf("bullet")!==-1){var af=p(T.buttonGroup._getButtonList(),Z);if(af){if(Z.value==T.value&&!Z.checkFlag){Z.checkFlag=true}af.checkFlag=Z.checkFlag;af.show()}T._updateView();T.buttonGroup.getContent().setStyle("margin-left",0+"px");if(!this.showComboBoxFlag){if(T.showPreviousButton){T.showPreviousButton.disabled=true}if(T.showNextButton){T.showNextButton.disabled=false}}}else{if(T.displayStyle.indexOf("normal")!==-1){var ab=C(T.togglesTab,Z);if(ab){ab.checkFlag=Z.checkFlag}T._updateView()}else{if(T.displayStyle.indexOf("panel")!==-1){var aa=T.getIndexesByValues(T.value);aa=aa.sort();for(var Y=0;Y<aa.length;Y++){var X=T.getValueByIndex(aa[Y]);var Z=T.getButtonFromValue(X);if(Z!==undefined&&!Array.isArray(Z)||Array.isArray(Z)&&Z.length>0){if(Y===0){Z.getContent().setStyles({"border-bottom":"1px solid #f1f1f1"})}}}var ae=T.buttonGroup._getButtonList();for(var Y=0;Y<ae.length;Y++){var Z=ae[Y];if(T.displayStyle.indexOf("panel")!==-1){if(!Z.checkFlag){Z.getContent().setStyles({"border-bottom":"1px solid #b4b6ba"})}}}}}}}}T.redrawTabBar()};this.buttonGroup.addEventListener("change",R);this.buttonGroup.addEventListener("buttonclick",function(W){var V=W;W.stopPropagation();if(V){while(V&&!(V.dsModel instanceof F||V.dsModel instanceof a)){if(W.parentElement){V=W.parentElement}else{break}}T.fire("tabButtonClick",{value:T.getValueByIndex(T.buttonGroup.getButtonIndex(V.dsModel))})}});this.buttonGroup.addEventListener("buttonDblClick",function(V){V.stopPropagation()});z.addEventOnElement(this,this.buttonGroup,j.POINTERHIT,function(W){W.preventDefault();if(W.multipleHitCount!==2){return}if(T.disabled){return}var X=W.target;while(X&&(!X.dsModel||!(X.dsModel instanceof F))){X=X.getParent()}if(X){var V=T.getButtonFromValue(X.dsModel.value);if(V instanceof a){V=p(T.buttonGroup._getButtonList(),V)}if(T.editableFlag){T._editTab(V.value)}else{if(T.pinFlag){T._pinTab(V.value,"buttonGroup_dblClick")}}}});z.addEventOnElement(this,document,j.POINTERUP,function(V){if(g&&g.getContent().getAttributeNode("focused")===null){T._endEditTab()}});z.addEventOnElement(this,this.buttonGroup.getContent(),"mousewheel",function(V){if(T._hasOverflow()&&T.buttonGroup.getContent().hasAttribute("focused")){var W=d.Event.wheelDelta(V);if(W>0){T._slideTabBar("right")}else{T._slideTabBar("left")}V.stopPropagation();V.preventDefault()}})},_onDragPointerDown:function(U){if(this.disabled){return}var S=this;if(U.dsModel){var T=this.getButtonFromValue(U.dsModel.value);if(T){this.valueSource=T.value}}function R(V){if(V.target.parentNode&&V.target.parentNode.dsModel===S.buttonGroup&&S.valueSource!==undefined){S._onDragPointerMove(V)}}function Q(V){if(S.valueSource!==undefined){S._onDragPointerUp(V)}z.removeEventOnElement(S,document,j.POINTERMOVE,R);z.removeEventOnElement(S,document,j.POINTERUP,Q)}z.addEventOnElement(this,document,j.POINTERMOVE,R);z.addEventOnElement(this,document,j.POINTERUP,Q);this.modelEvent.publish({event:P,data:{}})},_onDragPointerMove:function(R){if(!this.disabled&&R.button===0){R.preventDefault();var Q;if(R.target&&R.target.dsModel){Q=R.target.dsModel}else{if(R.target.dsModel===undefined){if(R.target.parentElement){Q=R.target.parentElement.dsModel}}}if(Q&&Q.value!==this.valueSource){this.callMethodFromUIInteraction("_exchangeTabs",this.valueSource,Q.value)}}},_exchangeTabs:function(U,V){this.value=[U];var Q=this.getButtonFromValue(V);var R=this.getButtonFromValue(U);if(Q&&R&&R.value!==undefined&&Q.value!==undefined&&R.value!==Q.value){this.valueTarget=Q.value;var T=Q._index;var S=R._index;this.buttonGroup.moveButton(S,T);Q._index=S;R._index=T;this.modelEvent.publish({event:h,data:{valueButtonDragged:U,valueButtonTarget:V,valueTab:this.value}});this._changeButtonIndexInComboBox(R,R._index);this._changeButtonIndexInComboBox(Q,Q._index);t(this);this.fire("beginReorder",{value:R.value})}},_onDragPointerUp:function(Q){if(this.valueTarget!==undefined){this.valueSource=undefined;this.valueTarget=undefined;this.redrawTabBar();this.fire("endReorder")}},_applyShowComboBoxFlag:function(Q){if(!this.showComboBoxFlag){var R=this;if(this.tabComboBox){this.tabComboBox.removeEventListener("change",this._comboCB.bind(this));this.tabComboBox.getContent().hide();this.tabComboBox.destroy();this.tabComboBox=null}this._createButtonsNextAndPrevious()}else{this.tabComboBox=new x({elementsTree:this._history,mainElementVisibleFlag:false,enableSearchFlag:false,displayStyle:(this.displayStyle.indexOf("strip")!==-1)?"lite":"normal",}).inject(this.elements.buttonsContainer,"before");this.tabComboBox.tooltipInfos=new B({shortHelp:o.listAllItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.tabComboBox.getContent().addClassName("wux-controls-tabBar-combobox");this.tabComboBox.addEventListener("change",this._comboCB.bind(this));this._updateComboBox();if(this.showPreviousButton){this.showPreviousButton.destroy();this.showPreviousButton=null}if(this.showNextButton){this.showNextButton.destroy();this.showNextButton=null}}if(this.displayStyle.indexOf("panel")!==-1){if(this.tabComboBox){this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel")}}this.redrawTabBar()},_applyCenteredFlag:function(){if(this.centeredFlag){this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered");this.elements.tabBar.addClassName("wux-controls-tabBar-centered");this.elements.container.addClassName("wux-controls-tabBar-centered")}else{this.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered");this.elements.tabBar.removeClassName("wux-controls-tabBar-centered");this.elements.container.removeClassName("wux-controls-tabBar-centered")}},_applyReorderFlag:function(){var R=this;function Q(S){if(R.disabled){return}R._onDragPointerDown(S)}if(this.reorderFlag){z.addEventOnElement(this,this.elements.container,j.POINTERDOWN,Q)}else{z.removeEventOnElement(this,this.elements.container,j.POINTERDOWN,Q)}},_applyMultiSelFlag:function(){this.buttonGroup.multiSelFlag=this.multiSelFlag;for(var Q in this.togglesTab){if(this.togglesTab.hasOwnProperty(Q)){this.togglesTab[Q].multiSelFlag=this.multiSelFlag}}if(!this.multiSelFlag&&this.value&&this.value.length>0){var R=this._getMaxHistory();if(R){this.value=[R]}else{this.value=[]}}else{this.buttonGroup._applyValue()}},_preEditPinnedList:function(R,T){if(!this.pinnedListIsBeingUpdated){this.pinnedListIsBeingUpdated=true;if(this.pinnedList===undefined){this.pinnedList=[]}if(R===undefined){R=[]}var V=M.call(this,T,R);var S=M.call(this,R,T);for(var Q=0;Q<V.length;Q++){this.pinTab(V[Q])}for(var U=0;U<S.length;U++){this.pinTab(S[U])}this.pinnedListIsBeingUpdated=false}},_applyPinFlag:function(Q){if(!this.pinFlag){this.pinnedList=[]}},_applyProperties:function(Q){this.slide=0;if(this.isDirty("centeredFlag")){this._applyCenteredFlag(Q.centeredFlag)}if(this.isDirty("showComboBoxFlag")){this._applyShowComboBoxFlag(Q.showComboBoxFlag)}if(this.isDirty("reorderFlag")){this._applyReorderFlag(Q.reorderFlag)}if(this.isDirty("recId")){this._applyRecId(Q.recId)}},_applyCloseButtonFlag:function(){for(var Q=0;Q<this.buttonGroup.getButtonCount();Q++){this.setAllowClosableFlagOnValue(this.getValueByIndex(Q),this.closeButtonFlag)}if(this.showComboBoxFlag){this._updateComboBox()}},_applyDisabled:function(){this.buttonGroup.disabled=this.disabled;if(!this.showComboBoxFlag||this.displayStyle.indexOf("strip")!==-1){if(this.showPreviousButton){this.showPreviousButton.disabled=this.disabled}if(this.showNextButton){this.showNextButton.disabled=this.disabled}}else{if(this.tabComboBox){this.tabComboBox.disabled=this.disabled}}if(this.newTabButton){this.newTabButton.disabled=this.disabled}},_applyNewTabButtonFlag:function(){if(this.displayStyle.indexOf("strip")!==-1&&this.showComboBoxFlag){i.call(this)}if(this.newTabButtonFlag){if(this.tabComboBox&&this.tabComboBox.visibleFlag){this.newTabButton.getContent().hide()}else{this.newTabButton.getContent().show();this.newTabButton.getContent().style.marginLeft=(this.displayStyle.indexOf("strip")!==-1)?"0px":-this.buttonGroup.getContent().offsetLeft+"px"}}else{this.newTabButton.getContent().hide()}},_applyTouchMode:function(){this._postEditTouchMode()},_postEditTouchMode:function(){var Q=this._getCurrentTouchMode();this._parent();if(Q===true){this.elements.container.setAttributeNode(document.createAttribute("touch-mode"));this.elements.tabBar.setAttributeNode(document.createAttribute("touch-mode"));this.elements.buttonGroupContainer.setAttributeNode(document.createAttribute("touch-mode"))}else{this.elements.container.removeAttribute("touch-mode");this.elements.tabBar.removeAttribute("touch-mode");this.elements.buttonGroupContainer.removeAttribute("touch-mode")}this.buttonGroup.touchMode=Q;if(this.tabComboBox){this.tabComboBox.touchMode=Q}if(this.showNextButton){this.showNextButton.touchMode=Q}if(this.newTabButton){this.newTabButton.touchMode=Q}if(this.showPreviousButton){this.showPreviousButton.touchMode=Q}},_applyMinWidth:function(){if(this.minWidth!==-1){this.elements.container.setStyles({width:this.minWidth+"px"})}else{this.elements.container.setStyles({width:""})}this.buttonGroup.getContent().setStyle("margin-left","0px");if(!this.showComboBoxFlag){this.showPreviousButton.disabled=true;this.showNextButton.disabled=false}this.redrawTabBar()},_closeListener:function(R){this.modelEvent.publish({event:H,data:{index:R._index,value:R.value,tabBar:this}});this.fire("removeTab",{index:R._index,value:R.value,tabBar:this});if(this.autoCloseFlag){if(this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&this.pinnedList.indexOf(R.value)!==-1){this._removePinnedButton(R.value)}if(this.showComboBoxFlag){this._removeValueComboBox(R.value)}this.removeTab(R.value);R.remove();this._removeHistoryFromButton(R.value);var T=this.buttonGroup._getButtonList();for(var Q=T.length-1;Q>=0;Q--){var R=T[Q];if(R instanceof a&&R.checkFlag){R.remove()}}var S=this._getMaxHistory();if(S){this.setPropertyFromUIInteraction("value",[S])}else{this.setPropertyFromUIInteraction("value",[])}}},_searchItemInContextualMenu:function(S,R){var Q=false;if(S!==undefined){S.forEach(function(T){if(T.title===R){Q=true}})}return Q},_createCloseButtonFlag:function(Q){var R=this;if(this.displayStyle.indexOf("strip")!==-1){Q.elements._closeButton=new d.Element("div",{"class":"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-chevron-down"});Q.getContent().insertBefore(Q.elements._closeButton,Q.getContent().lastChild.nextSibling);Q.elements._closeButton.addClassName("button-close-unvisible");Q.elements._closeButton.addEventListener("click",function(V){var T=this;var W=[];if(R.closeButtonFlag&&!R._searchItemInContextualMenu(W,o.close)){W.push({type:"PushItem",title:o.close,action:{callback:function(){R._closeListener(T.parentNode.dsModel)}}})}if(R.editableFlag&&!R._searchItemInContextualMenu(W,o.rename)){W.push({type:"PushItem",title:o.rename,action:{callback:function(){R._editTab(T.parentNode.dsModel.value)}}})}R.modelEvent.publish({event:u,data:{menu:W,index:T.parentNode.dsModel._index,value:T.parentNode.dsModel.value}});var S=this.parentNode.getBoundingClientRect();var U=26;if(T.parentNode.dsModel.touchMode===true){U=44}if(W.length!==0){E.show(W,{position:{x:S.left+S.width-U,y:S.top+S.height}})}})}else{if(this.displayStyle.indexOf("bullet")===-1&&!Q.elements._closeButton||Q.elements._closeButton&&Q.getContent().lastChild!==Q.elements._closeButton){Q.elements._closeButton=new d.Element("button",{"class":"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-wrong"});Q.getContent().insertBefore(Q.elements._closeButton,Q.getContent().lastChild.nextSibling);Q.elements._closeButton.value="close"}}Q.getContent().addClassName("wux-controls-tabbar-closebutton")},_updateView:function(){var U=this.buttonGroup._getButtonList();for(var T=0;T<U.length;T++){if(U[T] instanceof F){var Q;if(this.displayStyle.indexOf("bullet")!==-1){Q=C(this.buttonGroup._getButtonList(),U[T])}else{Q=C(this.togglesTab,U[T])}if(Q){if(this.displayStyle.indexOf("bullet")!==-1){U[T].visibleFlag=Q.checkFlag;Q.checkFlag=U[T].checkFlag}}}else{if(U[T] instanceof a){U[T].show();if(U[T].elements.checkSign.hasClassName(U[T]._toggleIcon)){U[T].elements.checkSign.removeClassName(U[T]._toggleIcon)}if(this.buttonGroup.value.length<=0){if(U[0]){U[0].checkFlag=true}}if(U[T]){var S=p(U,U[T]);if(S&&S instanceof F){S.visibleFlag=U[T].checkFlag;S.checkFlag=U[T].checkFlag}}}}if(this.pinnedList&&this.pinnedList.indexOf(U[T].value)!==-1){U[T].show()}}if(this.displayStyle.indexOf("normal")!==-1){for(var R=0;R<U.length;R++){U[R].show()}}this.redrawTabBar()},_applyDisplayStyle:function(T){var S=this.value?this.value.slice():[];if(this.displayStyle.indexOf("bullet")!==-1){if(this.touchMode){this.touchMode=false}if(this.closeButtonFlag){this.closeButtonFlag=false}}var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();if(this.displayStyle.indexOf("normal")!==-1){R.removeClassName("wux-controls-toggle-selectbutton");R.removeClassName("wux-controls-toggle-pinnedbutton")}}for(var Q in this.togglesTab){if(this.displayStyle.indexOf("normal")!==-1){this.buttonGroup.removeChild(this.togglesTab[Q])}else{if(this.displayStyle.indexOf("bullet")!==-1){this.buttonGroup.addChild(this.togglesTab[Q])}}}if(this.displayStyle.indexOf("wide")===-1){this.getContent().removeClassName("wux-controls-tabbar-display-wide")}else{this.getContent().addClassName("wux-controls-tabbar-display-wide")}if(this.displayStyle.indexOf("vertical")!==-1){this.elements.buttonsContainer.addClassName("wux-controls-tabbar-vertical");this.elements.tabBar.addClassName("wux-controls-tabbar-vertical");this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-vertical");var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.addClassName("wux-controls-tabbar-vertical");R.tooltipInfos=new B({shortHelp:V[U].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){R.dsModel.showLabelFlag=false}}if(this.showComboBoxFlag){this.tabComboBox.remove();this.tabComboBox.inject(this.elements.container)}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel");this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.removeClassName("wux-controls-tabbar-panel");if(this.displayStyle.indexOf("strip")!==-1){this.elements.container.addClassName("wux-controls-tabbar-vertical")}else{this.elements.container.removeClassName("wux-controls-tabbar-vertical")}}else{if(this.displayStyle.indexOf("panel")!==-1){var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.addClassName("wux-controls-tabbar-panel")}this.buttonGroup.getContent().addClassName("wux-controls-tabbar-panel");this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel")}else{this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-vertical");this.elements.tabBar.removeClassName("wux-controls-tabbar-vertical");this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-vertical");var V=this.buttonGroup._getButtonList();for(var U=0;U<V.length;U++){var R=V[U].getContent();R.tooltipInfos=null;R.removeClassName("wux-controls-tabbar-vertical");R.removeClassName("wux-controls-tabbar-panel")}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.addClassName("wux-controls-tabbar-panel");this.buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel");this.elements.tabBar.removeClassName("wux-controls-tabbar-panel");if(this.tabComboBox&&this.showComboBoxFlag){this.tabComboBox.remove();this.tabComboBox.inject(this.elements.tabBar,"before")}}}if(this.displayStyle.indexOf("strip")!==-1){this.pinFlag=false;c.call(this);this._addTooltips();this.menuContextual=[]}else{if(T&&(T.indexOf("strip")!==-1||T==="strip")){r.call(this)}}this._updateView();this.buttonGroup.getContent().setStyle("margin-left","0px");if(this.tabComboBox){if(this.displayStyle.indexOf("panel")!==-1){this.tabComboBox.getContent().addClassName("wux-controls-tabbar-panel")}else{this.tabComboBox.getContent().removeClassName("wux-controls-tabbar-panel")}}this.value=S},_addPinnedButton:function(R){if(!this.pinnedList){this.setPropertyFromUIInteraction("pinnedList",[])}if(this.pinnedList.indexOf(R)===-1){this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.push,R)}var S=this.getButtonFromValue(R);if(this.displayStyle.indexOf("bullet")!==-1){S.show()}S.getContent().setAttributeNode(document.createAttribute("pinned"));var Q=C(this.togglesTab,S);if(Q){Q.getContent().setAttributeNode(document.createAttribute("pinned"))}return this.pinnedList},_removePinnedButton:function(R){var T=this.getButtonFromValue(R);if(T&&T.getContent().getAttributeNode("pinned")){T.getContent().removeAttributeNode(T.getContent().getAttributeNode("pinned"))}else{console.log("Ohoh ... This tab should have been pinned ...")}var Q=C(this.togglesTab,T);if(Q){Q.getContent().removeAttributeNode(Q.getContent().getAttributeNode("pinned"))}for(var S=0;S<this.pinnedList.length;S++){if(this.pinnedList[S]===R){this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.splice,S,1)}}return this.pinnedList},_getMaxHistory:function(){var U;var T=0;if(!(this.historySelection[0]&&this.getButtonFromValue(this.historySelection[0].value)&&this.getButtonFromValue(this.historySelection[0].value).visibleFlag)){for(var Q=0;Q<this.buttonGroup.getButtonCount();Q++){if(this.getButtonFromValue(this.getValueByIndex(Q)).visibleFlag){U=this.getValueByIndex(Q)}}}for(var S in this.historySelection){var R=this.getButtonFromValue(this.historySelection[S].value);if(this.historySelection[S].cpt!==undefined&&T<=this.historySelection[S].cpt&&R&&R.visibleFlag){U=this.historySelection[S].value;T=this.historySelection[S].cpt}}return U},_setHistoryFromButton:function(R,S){for(var Q in this.historySelection){if(this.historySelection[Q].value!==undefined&&this.historySelection[Q].value===R.value){this.historySelection[Q].cpt=S;return}}},_removeHistoryFromButton:function(R){for(var Q in this.historySelection){if(this.historySelection[Q].value!==undefined&&this.historySelection[Q].value===R){this.historySelection.splice(Q,1);return}}},_indexesFromValues:function(Q){var S=[];if(Q!==undefined&&Q!==null){var V=this.buttonGroup._getButtonList();for(var R=0;R<Q.length;R++){for(var U=0;U<V.length;U++){var T=V[U];if(T.value===Q[R]&&T instanceof F){S.push(T._index)}}}}return S},_hasOverflow:function(){var Z=this;var S=0;if(Z.showComboBoxFlag){if(Z.tabComboBox&&Z.tabComboBox.getContent()){S=Z.tabComboBox.getContent().getBoundingClientRect().width}}var ad=0;if(Z.newTabButtonFlag){if(Z.newTabButton&&Z.newTabButton.getContent()){ad=Z.newTabButton.getContent().getBoundingClientRect().width}}var ae=Z.buttonGroup.getContent().getBoundingClientRect().width+S+ad;var ab=Z.elements.container.getBoundingClientRect().width;if(ab!==0){if(Z.showComboBoxFlag||Z.newTabButtonFlag){var R=0;Z._applyInheritWidthToButtons();var aa=Z.buttonGroup._getButtonList();for(var V=0;V<aa.length;V++){var W=aa[V];if(W.visibleFlag){var Q=window.getComputedStyle(W.getContent(),null);var T=parseInt(Q.marginLeft.slice(0,-2));var X=parseInt(Q.marginRight.slice(0,-2));var ac=W.getContent().getBoundingClientRect().width+T+X;R=R+ac}}if(R+ad>ab+1){if(this.displayStyle.indexOf("strip")==-1){var U=(100/Z.getVisibleTabCount())+"%";var aa=Z.buttonGroup._getButtonList();for(var V=0;V<aa.length;V++){var W=aa[V];if(W.visibleFlag){W.getContent().style.width=U}}}Z.getContent().setAttributeNode(document.createAttribute("overflow"));if(!Z.centeredFlag){Z.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered");Z.elements.tabBar.removeClassName("wux-controls-tabBar-centered");Z.elements.container.removeClassName("wux-controls-tabBar-centered")}return true}else{Z._applyInheritWidthToButtons()}}else{if(ae>ab){Z.getContent().setAttributeNode(document.createAttribute("overflow"));if(this.displayStyle.indexOf("panel")!==-1&&!this.showComboBoxFlag){var Y;(this.touchMode===true)?Y="38px":Y="22px";this.elements.tabBar.style.marginLeft=Y}return true}}}this.getContent().removeAttribute("overflow");if(this.displayStyle.indexOf("panel")!==-1&&!this.showComboBoxFlag){this.elements.tabBar.style.marginLeft="0px"}if(this.centeredFlag&&this.showComboBoxFlag){this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered");this.elements.tabBar.addClassName("wux-controls-tabBar-centered");this.elements.container.addClassName("wux-controls-tabBar-centered")}return false},_createButtonsNextAndPrevious:function(){var Q=this;if(!this.showPreviousButton){this.showPreviousButton=new F({icon:(this.displayStyle.indexOf("strip")!==-1)?{iconName:"open-left",fontIconFamily:1}:"PreviousImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});this.showPreviousButton.tooltipInfos=new B({shortHelp:o.previousItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")}this.showPreviousButton.getContent().inject(this.elements.buttonsContainer);this.showPreviousButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonPrevious");this.showPreviousButton.addEventListener("click",function(){Q._slideTabBar("left")})}if(!this.showNextButton){this.showNextButton=new F({icon:(this.displayStyle.indexOf("strip")!==-1)?{iconName:"open-right",fontIconFamily:1}:"NextImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});this.showNextButton.tooltipInfos=new B({shortHelp:o.nextItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});if(this.displayStyle.indexOf("strip")!==-1){this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip")}this.showNextButton.getContent().inject(this.elements.containerAddandNextButton);this.showNextButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNext");this.showNextButton.addEventListener("click",function(){Q._slideTabBar("right")})}this._showButtonsNextAndPrevious()},_showButtonsNextAndPrevious:function(){var Y=false;if(!this.showPreviousButton.visibleFlag){this._slideTabBar("left")}if(!(this.showPreviousButton.visibleFlag&&this.showNextButton.visibleFlag)){this.showPreviousButton.visibleFlag=true;this.showNextButton.visibleFlag=true;if(this.displayStyle.indexOf("immersif")!==-1){this.showPreviousButton.elements.icon.addClassName("wux-controls-showprevious-immersif");this.showNextButton.elements.icon.addClassName("wux-controls-shownext-immersif");this.showPreviousButton.getContent().addClassName("wux-controls-showprevious-immersif");this.showNextButton.getContent().addClassName("wux-controls-shownext-immersif");this.elements.buttonGroupContainer.addClassName("wux-controls-buttonGroup-immersif")}else{this.showPreviousButton.elements.icon.removeClassName("wux-controls-showprevious-immersif");this.showNextButton.elements.icon.removeClassName("wux-controls-shownext-immersif");this.showPreviousButton.getContent().removeClassName("wux-controls-showprevious-immersif");this.showNextButton.getContent().removeClassName("wux-controls-shownext-immersif");this.elements.buttonGroupContainer.removeClassName("wux-controls-buttonGroup-immersif")}var W=this.buttonGroup._getButtonList();for(var S=0;S<W.length;S++){var T=W[S];if(!Y&&T.visibleFlag===true&&this.displayStyle.indexOf("immersif")!==-1){T.getContent().addClassName("wux-controls-button-show-firstbutton")}else{if(S===W.length-1&&this.displayStyle.indexOf("bullet")!==-1){W[W.length-1].getContent().addClassName("wux-controls-button-show-lastbutton")}}}var X=false;for(var R=W.length-1;R>=0;R--){var T=W[R];if(!X&&T.visibleFlag===true){if(this.displayStyle.indexOf("immersif")!==-1){T.getContent().addClassName("wux-controls-button-show-lastbutton");T.getContent().removeClassName("wux-controls-button-show-firstbutton")}X=true}}}var U=this.buttonGroup.getContent().scrollWidth;var V=this.elements.tabBar.getBoundingClientRect().width;var Q=V-U;if(this.slide>0){this.slide=0}if(this.slide<Q){this.slide=Q}this._manageButtonsVisibility(Q);t(this)},_hideButtonsNextAndPrevious:function(){if(this.showPreviousButton&&this.showNextButton){if(this.showPreviousButton.visibleFlag){this.showPreviousButton.visibleFlag=false;this.showNextButton.visibleFlag=false;this._slideTabBar("left")}else{this.showPreviousButton.visibleFlag=false;this.showNextButton.visibleFlag=false}t(this)}},_manageButtonsVisibility:function(Q){if(this.showPreviousButton&&this.showNextButton){if(Q===0){this._hideButtonsNextAndPrevious()}else{this.showPreviousButton.visibleFlag=true;this.showNextButton.visibleFlag=true;if(this.slide===0){this.showPreviousButton.disabled=true;this.showNextButton.disabled=false}else{if(this.slide===Q){this.showPreviousButton.disabled=false;this.showNextButton.disabled=true}else{this.showPreviousButton.disabled=false;this.showNextButton.disabled=false}}}}else{if(this.slide===0){this._maxSlide="left"}else{if(this.slide===Q){this._maxSlide="right"}else{this._maxSlide=""}}}},_slideTabBar:function(V){if(V==="left"&&(this.showPreviousButton&&this.showPreviousButton.disabled||this._maxSlide==="left")){return}else{if(V==="right"&&(this.showNextButton&&this.showNextButton.disabled||this._maxSlide==="right")){return}}var U=this.buttonGroup.getContent().scrollWidth;var S=this.elements.tabBar.getBoundingClientRect().width;var R=S-U;R=R>0?0:R;if(this.slide>0){this.slide=0}if(this.slide<R){this.slide=R}var Q;if(V==="right"){Q=this.slide-this.slideStep;var T=(Q>R)?Q:R;if(this.slide+T<R){if(this.displayStyle.indexOf("immersif")!==-1){this.slide+=(R-this.slide)}else{this.slide+=(R-this.slide-5)}R=this.slide}else{this.slide+=T;if(this.displayStyle.indexOf("immersif")===-1){this.slide+=-5;R+=-5}}}else{if(V==="left"){Q=this.slide+this.slideStep;this.slide=(Q<=0)?Q:0}}this.buttonGroup.getContent().setStyle("margin-left",this.slide+"px");this._manageButtonsVisibility(R)},_applyValue:function(Q){if(this.value!==undefined){if(d.equals(Q,this.value)){return}this.buttonGroup.value=this.value;if(this.tabComboBox&&this.showComboBoxFlag){this.tabComboBox.currentValue=this.value[0]}var R=this.getButtonFromValue(this.value[0]);this._slideToValue();if(this.displayStyle.indexOf("strip")!==-1){if(R&&R.elements._closeButton){R.elements._closeButton.removeClassName("button-close-unvisible");R.getContent().addClassName("remove-padding-class")}if(Q){var S=this.getButtonFromValue(Q[0]);if(S&&S.elements._closeButton){S.elements._closeButton.addClassName("button-close-unvisible");S.getContent().removeClassName("remove-padding-class")}}}if(this.displayStyle.indexOf("bullet")!==-1){this._updateView()}this.redrawTabBar();this.fire("change")}},_slideToValue:function(){if(this.value&&this.value.length>0){var T=this.getButtonFromValue(this.value[0]);if(T){var V=this.buttonGroup.getContent().scrollWidth;var R=this.elements.tabBar.getBoundingClientRect().width;var Q=R-V;var U=T.getContent().getPosition(this.buttonGroup.getContent()).x;var W=U+T.getContent().getDimensions().outerWidth;var S=this.elements.tabBar.getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left;if(S>=0&&U>=0&&S>=U){this.slide=-U}else{if(R+S<W){this.slide=R-W}else{return}}if(this.slide<Q){this.slide=Q}if(this.slide>0){this.slide=0}this.buttonGroup.getContent().setStyle("margin-left",this.slide+"px")}}},_comboCB:function(Q){Q.stopPropagation();if(this.showComboBoxFlag&&this.value[0]!==this.tabComboBox.currentValue){this.setPropertyFromUIInteraction("value",[this.tabComboBox.currentValue])}},_removeValueComboBox:function(R){for(var Q=0;Q<this._history.getRoots().length;Q++){if(this._history.getRoots()[Q].options.grid.valueItem===R){this._history.removeRoot(this._history.getRoots()[Q])}}this.tabComboBox.elementsTree=this._history},_removeTooltips:function(){var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R].getContent();Q.tooltipInfos=null}},_addTooltips:function(){var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R].getContent();Q.tooltipInfos=new B({shortHelp:S[R].label,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton})}},_updateComboBox:function(Q){var U=this.buttonGroup._getButtonList();for(var S=0;S<U.length;S++){if(U[S].visibleFlag){var T=new v({label:U[S].label,index:U[S]._index,grid:{valueItem:U[S].value},icons:U[S].icon?[{iconName:(U[S].icon instanceof Object?U[S].icon.iconName:U[S].icon)}]:""});var V=false;for(var R=0;R<this._history.getRoots().length;R++){if(this._history.getRoots()[R].options.grid.valueItem===T.options.grid.valueItem||(Q!==undefined&&Q===this._history.getRoots()[R].options.index)){V=true;this._history.getRoots()[R].options.label=T.options.label;this._history.getRoots()[R].options.icons=T.options.icons;this._history.getRoots()[R].options.grid.valueItem=T.options.grid.valueItem;break}}if(!V){this._history.addRoot(T,U[S]._index)}else{}}}this.tabComboBox.elementsTree=this._history},_changeButtonIndexInComboBox:function(S,R){var T=new v({label:S.label,grid:{valueItem:S.value}});var U;for(var Q=0;Q<this._history.getRoots().length;Q++){if(this._history.getRoots()[Q].options.grid.valueItem===T.options.grid.valueItem){U=this._history.getRoots()[Q];break}}if(U){this._history.removeRoot(U)}this._history.addRoot(T,R)},getButtonFromValue:function(V){var U=this.buttonGroup._getButtonList();var T;if(U){if(Array.isArray(V)){var S=[];for(var R=0;R<U.length;R++){T=U[R];for(var Q=0;Q<V.length;Q++){if(V[Q]===T.value&&T instanceof F&&this.displayStyle.indexOf("bullet")===-1){S.push(T)}else{if(V[Q]===T.value&&T instanceof a&&this.displayStyle.indexOf("bullet")!==-1){S.push(T)}}}}return S}else{for(var R=0;R<U.length;R++){T=U[R];if(T.value===V){return T}}}}},_updateButtonFocus:function(){if(this.value&&this.value.length>0){var Q=this.getButtonFromValue(this.value[0]);if(Q){Q.getContent().blur();Q.getContent().focus()}}},getWidthWithoutScroll:function(){this.redrawTabBar();if(G){return G}},getMinWidthWithoutScroll:function(){this.redrawTabBar();var S=0;var R=this.getVisibleTabCount();var T=this.buttonGroup._getButtonList();for(var Q=0;Q<R;Q++){if(T[Q]){S=S+T[Q].getContent().getBoundingClientRect().minWidth}}if(this.showComboBoxFlag){S=S+this.tabComboBox.getContent().getBoundingClientRect().width}return S},getWidthOfAllVisibleButtons:function(){var T=this;var U=0;var S=T.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R];if(Q.visibleFlag){U=U+this.getWidthOfButton(Q)}}return U+3},getWidthOfButton:function(Q){var R=window.getComputedStyle(Q.getContent(),null);var T=parseInt(R.marginLeft.slice(0,-2));var S=parseInt(R.marginRight.slice(0,-2));return Q.getContent().getBoundingClientRect().width+T+S},_applyInheritWidthToButtons:function(){var T=this;var S=T.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){var Q=S[R];if(Q.visibleFlag){Q.getContent().style.width="inherit"}}},_getButtonByIndex:function(Q){var T=this.buttonGroup._getButtonList();var S;if(T){for(var R=0;R<T.length;R++){S=T[R];if(S._index===Q){return S}}}return undefined},getValueByIndex:function(Q){var R=this._getButtonByIndex(Q);if(R){return R.value}else{return undefined}},getIndexesByValues:function(V){var U=[];for(var T=0;T<V.length;T++){var S=this.getButtonFromValue(V[T]);if(this.displayStyle.indexOf("bullet")===-1){if(S===undefined){U[T]=undefined}else{var R=S._index;if(R!==undefined){U[T]=R}}}else{var Q=p(this.buttonGroup._getButtonList(),S);if(Q===undefined){U[T]=undefined}else{var R=Q._index;if(R){U[T]=R}}}}return U},getTabCount:function(){if(this.buttonGroup){if(this.displayStyle.indexOf("bullet")!==-1){return this.buttonGroup.getButtonCount()/2}else{return this.buttonGroup.getButtonCount()}}},getVisibleTabCount:function(){if(this.buttonGroup){var Q=0;var S=this.buttonGroup._getButtonList();for(var R=0;R<S.length;R++){if(S[R].visibleFlag){Q++}}return Q}},_getVisibleTabButtons:function(){if(this.buttonGroup){var Q=[];var T=this.buttonGroup._getButtonList();for(var S=0;S<T.length;S++){var R=T[S];if(R.visibleFlag){Q.push(R)}}return Q}return null},add:function(Y){if(Y.allowClosableFlag===undefined){Y.allowClosableFlag=true}var T=this.buttonGroup.getButtonCount();if(Y.index===undefined){Y.index=T}if(Y.isSelected===undefined||Y.isSelected===null){Y.isSelected=false}if(Y.showTitleFlag===undefined||Y.showTitleFlag===null){Y.showTitleFlag=true}var V=(Y.value!==undefined&&Y.value!==null)?Y.value:Y.index;var S=1;while(this.getButtonFromValue(V)){V++}var ab=Y.icon;if(ab&&ab.iconName){ab={iconName:ab.iconName,fontIconFamily:ab.fontIconFamily?ab.fontIconFamily:0}}var W=new F({label:Y.label,type:"radio",value:V,checkFlag:Y.isSelected,clickMode:S,showLabelFlag:Y.showTitleFlag,icon:ab,touchMode:Y.touchMode,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});W._index=Y.index;var X=new a({type:"radio",value:V,checkFlag:Y.isSelected,clickMode:S,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton});X._index=Y.index;var R=Y.index;while(this.togglesTab.hasOwnProperty(R)){R++}this.togglesTab[R]=X;if(this.closeButtonFlag&&Y.allowClosableFlag){this._createCloseButtonFlag(W)}var aa;if(T===0){W.inject(this.buttonGroup.elements.container)}else{var Z=this.buttonGroup._getButtonList();for(var U=0;U<Z.length;U++){var Q=Z[U];if(Q._index<Y.index){aa=Q}}}if(aa){W.inject(aa.getContent(),"after")}else{W.inject(this.buttonGroup.getButton(0).getContent(),"before")}this._updateIndexOfTab();this.buttonGroup._updateChildPropertiesAndListeners(W,W._index);this.historySelection[this.historySelection.length]={value:W.value,cpt:this.cptSelection};W.getContent().setAttribute("role","tab");if(!this.showComboBoxFlag){if(this.displayStyle.indexOf("strip")===-1){this._hideButtonsNextAndPrevious()}}this._applyDisplayStyle();if(this.showComboBoxFlag){this._updateComboBox()}t(this);return W},addTab:function(S,R,Q,V,U,X,W){var T={label:S,index:R,isSelected:Q,value:V,icon:U,allowClosableFlag:X,showTitleFlag:W};return this.add(T)},setAllowClosableFlagOnValue:function(R,S){var Q=this.getButtonFromValue(R);if(Q){if(this.closeButtonFlag&&S&&!Q.elements._closeButton){this._createCloseButtonFlag(Q)}if(Q.elements._closeButton){if(this.closeButtonFlag&&S){Q.elements._closeButton.show();Q.getContent().addClassName("wux-controls-tabbar-closebutton")}else{Q.elements._closeButton.hide();Q.getContent().removeClassName("wux-controls-tabbar-closebutton")}}}},changeLabel:function(S,R){var Q=new Error("DEPRECATED METHOD");Q.name="WARNING";console.warn(Q.stack);var U=this;var T=this.buttonGroup.getButton(S);T.label=R;U.modelEvent.publish({event:O,data:{index:S,label:R}})},removeTab:function(S,T){var U=(this.value.indexOf(S)!==-1);if(this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&this.pinnedList.indexOf(S)!==-1){this._removePinnedButton(S)}if(this.getButtonFromValue(S)===undefined){return}this._preventButtonGroupListener=U;if(T){this.getButtonFromValue(S).visibleFlag=false;document.body.appendChild(this.getButtonFromValue(S).getContent())}this.buttonGroup.removeChild(this.getButtonFromValue(S));this._preventButtonGroupListener=false;if(this.displayStyle.indexOf("bullet")!==-1){var Q=y(this.togglesTab,S);this.togglesTab[Q].destroy();this.togglesTab[Q]=null;delete this.togglesTab[Q]}this._updateIndexOfTab();if(this.showComboBoxFlag){this._removeValueComboBox(S)}this._removeHistoryFromButton(S);if(U){var R=this._getMaxHistory();if(R){this.value=[R]}else{this.value=[]}}t(this);this._updateIndexOfTab();this.redrawTabBar()},updateTab:function(T,R){var Q=this.getButtonFromValue(T);if(Q){var S=((Q.label!=R.label)||(Q.icon!=R.icon));if(R.label!==undefined){Q.label=R.label;if(Q.elements._closeButton){Q.getContent().insertBefore(Q.elements._closeButton,Q.elements.lastChild)}}if(R.icon!==undefined){Q.icon=R.icon}if(R.allowClosableFlag!==undefined){this.setAllowClosableFlagOnValue(T,R.allowClosableFlag)}if(R.showTitleFlag!==undefined){Q.showLabelFlag=R.showTitleFlag}if(S&&this.showComboBoxFlag){this._updateComboBox()}}},getOptionFromButton:function(R,S){var Q=this.getButtonFromValue(S);if(Q&&Q[R]){return Q[R]}},setOptionFromButton:function(S,R,T){var Q=this.getButtonFromValue(T);if(Q){Q[S]=R}if(this.showComboBoxFlag&&(S==="icon"||S==="label")){this._updateComboBox()}},_editTab:function(V){var U=this;m=U.getButtonFromValue(V);if(U.closeButtonFlag&&m.elements._closeButton){m.elements._closeButton.hide()}var R=m.getContent().getBoundingClientRect().width-parseInt(window.getComputedStyle(m.getContent()).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(m.getContent()).getPropertyValue("border-right"));var Q=m.getContent().getBoundingClientRect().height-8;var T=m.elements.container.getElements(".wux-controls-lineeditor");if(m instanceof F&&(U.editableFlag||m.label===o.newTab)&&T.length===0){var X=m.elements.text?m.elements.text.innerHTML:"";var W=m.elements.text?m.elements.text.getBoundingClientRect().width:0;if(m.elements.text){m.elements.text.hide()}m.getContent().addClassName("wux-controls-tabbar-button-nopadding");g=new K({value:X,touchMode:this.touchMode,selectAllOnFocus:(this.displayStyle.indexOf("strip")!==-1)?true:false}).inject(m.elements.container);g.getContent().setAttributes({height:Q+"px",width:R+"px",position:"relative"});var S=U.displayStyle==="panel"||"strip"?"22px":"11px";g._myInput.style.width=(this.displayStyle.indexOf("strip")!==-1)?W+"px":R-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("padding-left"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("padding-right"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("border-left"))-parseInt(window.getComputedStyle(g._myInput).getPropertyValue("border-right"))+"px";g._myInput.style.height=this.touchMode?"22px":S;g._myInput.style.minWidth="44px";g._myInput.style.marginLeft=m.elements.text?"0px":"4px";g._myInput.style.lineHeight=g._myInput.style.height;g.getContent().style.display="inline-block";g._myInput.focus()}U.modelEvent.publish({event:s,data:{value:V}});this.fire("edit",{value:V})},_endEditTab:function(){var R=this;if(m){var Q=m.elements.container.getElements(".wux-controls-lineeditor");if(Q&&Q[0]){m.label=Q[0].dsModel.value;if(Q[0].parentElement){Q[0].remove()}m.getContent().removeClassName("wux-controls-tabbar-button-nopadding");if(m.elements.text){m.elements.text.show()}if(R.closeButtonFlag&&m.elements._closeButton){m.elements._closeButton.show()}if(this.showComboBoxFlag&&this.tabComboBox){R._updateComboBox()}R.modelEvent.publish({event:n,data:{button:m}});R.fire("endEdit",{button:m})}}},_updateIndexOfTab:function(){var R=this.buttonGroup._getButtonList();for(var Q=0;Q<R.length;Q++){R[Q]._index=Q}},_setTabVisibility:function(V,Q){var U=this;var R=U.getButtonFromValue(V);var T=R.visibleFlag;R.visibleFlag=Q;R.checkFlag=false;if(this.showComboBoxFlag){if(!Q&&T){this._removeValueComboBox(V)}else{if(Q&&!T){this._updateComboBox()}}}if(!Q&&this.value&&this.value.length===1&&this.value[0]===V){var S=this._getMaxHistory();if(S){this.value=[S]}else{this.value=[]}}t(this)},pinTab:function(Q){this._pinTab(Q)},_pinTab:function(T){var S=this;var R=S.getButtonFromValue(T);var Q=R._index;if(R&&S.pinFlag){if(this.pinnedList&&this.pinnedList.indexOf(T)!==-1){this._removePinnedButton(R.value);S.modelEvent.publish({event:b,data:{index:Q,value:R.value}});S.fire("pinStateChange",{value:T,pinnedFlag:false})}else{this._addPinnedButton(R.value);S.modelEvent.publish({event:D,data:{index:Q,value:R.value}});S.fire("pinStateChange",{value:T,pinnedFlag:true})}S.fire("change");S.redrawTabBar();S._hasOverflow()}},redrawTabBar:function(){var U=this.buttonGroup.getContent().getBoundingClientRect().width;if(this.displayStyle.indexOf("panel")!==-1&&this.tabComboBox){var V=24;if(this.touchMode){V=36}var S=2*V;this.buttonGroup.visibleFlag=true;this.tabComboBox.getContent().addClassName("wux-button-tabBar-combo-right");if(this.getContent().getBoundingClientRect().width<S){this.buttonGroup.visibleFlag=false;this.tabComboBox.getContent().removeClassName("wux-button-tabBar-combo-right")}}if(this.visibleFlag&&U!==0){if(this._hasOverflow()||(this.displayStyle.indexOf("panel")!==-1&&!this.buttonGroup.visibleFlag)){G=U+2;if(this.showComboBoxFlag){this._addTooltips();this.tabComboBox.show();if(this.displayStyle.indexOf("strip")!==-1){this._showButtonsNextAndPrevious()}}else{this._showButtonsNextAndPrevious()}if(this.slide>1){this._updateButtonFocus()}if(this.touchMode){if(this.elements.tabBar.getSize().width<54){this._hideButtonsNextAndPrevious()}}else{if(this.elements.tabBar.getSize().width<36){this._hideButtonsNextAndPrevious()}}}else{this.buttonGroup.getContent().setStyle("margin-left",0+"px");G=U+2;if(this.showComboBoxFlag){this._removeTooltips();this.tabComboBox.hide();if(this.displayStyle.indexOf("strip")!==-1){if(this.showPreviousButton&&this.showNextButton){this._hideButtonsNextAndPrevious()}}}else{this._hideButtonsNextAndPrevious()}}if(this.newTabButtonFlag){this._applyNewTabButtonFlag()}if(this.buttonGroup.value){var T=this.buttonGroup._getButtonList();for(var R=0;R<T.length;R++){var Q=T[R];if(this.displayStyle.indexOf("bullet")!==-1&&Q.checkFlag){Q.getContent().addClassName("wux-controls-toggle-selectbutton")}e(this,Q)}}if(this.showComboBoxFlag){this._updateComboBox()}}},onSelectTab:function(Q){return this.modelEvent.subscribe({event:f},Q)},onBeginTabDrag:function(Q){return this.modelEvent.subscribe({event:P},Q)},onEndTabDrag:function(Q){return this.modelEvent.subscribe({event:h},Q)},unPinTab:function(Q){return this.modelEvent.subscribe({event:b},Q)},onPinTab:function(Q){return this.modelEvent.subscribe({event:D},Q)},onEditTab:function(Q){return this.modelEvent.subscribe({event:s},Q)},onEndEditTab:function(Q){return this.modelEvent.subscribe({event:n},Q)},onChangeLabelTab:function(Q){return this.modelEvent.subscribe({event:O},Q)},onPreNewTab:function(Q){return this.modelEvent.subscribe({event:L},Q)},onNewTab:function(Q){return this.modelEvent.subscribe({event:J},Q)},onRemoveTabEvent:function(Q){return this.modelEvent.subscribe({event:H},Q)},onContextualMenuEvent:function(Q){return this.modelEvent.subscribe({event:u},Q)},destroy:function(){function R(T,S){if(T&&T[S]){T[S].destroy();T[S]=null}}z.removeResizeListener(this.elements.container,this._onResizeFun,0);R(this,"buttonGroup");R(this,"newTabButton");R(this,"showPreviousButton");R(this,"showNextButton");R(this,"newTabComboBox");R(this,"tabComboBox");for(var Q in this.togglesTab){if(Q){R(this.togglesTab,Q)}}this._parent()}});var C=function(S,R){if(!S||!R){throw new Error("WRONG PARAMETERS")}for(var Q in S){if(R.value===S[Q].value){return S[Q]}}};var y=function(S,R){for(var Q in S){if(R===S[Q].value){return Q}}};var p=function(S,Q){if(!S||!Q){throw new Error("WRONG PARAMETERS")}for(var R=0;R<S.length;++R){if(Q.value===S[R].value&&S[R] instanceof F){return S[R]}}};var e=function(Q,S){if(!Q||!S){throw new Error("WRONG PARAMETER")}if(Q.pinnedList&&Q.pinnedList.length>0){for(var R=0;R<Q.pinnedList.length;++R){if(S.value===Q.pinnedList[R]){if(Q.displayStyle.indexOf("normal")!==-1){S.getContent().removeClassName("wux-controls-toggle-pinnedbutton")}else{if(Q.displayStyle.indexOf("bullet")!==-1){S.getContent().addClassName("wux-controls-toggle-pinnedbutton");S.show()}}}}}};var t=function(Q){if(Q.displayStyle.indexOf("strip")!==-1){return}var V=Q._getVisibleTabButtons();var S;var R=0;var W="wux-controls-button-";var U=Q.getVisibleTabCount();if(U===1){V[0].getContent().addClassName(W+"onlyone");V[0].getContent().removeClassName(W+"allothers");V[0].getContent().removeClassName(W+"lastone");V[0].getContent().removeClassName(W+"firstone");if(Q.displayStyle.indexOf("normal")!==-1){V[0].getContent().setStyle("margin-right",0+"px")}if(V[1]){V[1].getContent().addClassName(W+"lastone")}}else{for(var T=0;T<U;T++){Q.slide=0;S=V[T].getContent();S.removeClassName(W+"show-lastbutton");S.removeClassName(W+"show-firstbutton");if(V[T].visibleFlag===true){if(Q.displayStyle.indexOf("bullet")!==-1){if(R===0){S.addClassName(W+"firstone");S.removeClassName(W+"allothers");S.removeClassName(W+"lastone");S.removeClassName(W+"onlyone");R=1}else{if(T===U-1){S.addClassName(W+"lastone");S.removeClassName(W+"allothers");S.removeClassName(W+"firstone");S.removeClassName(W+"onlyone")}else{S.addClassName(W+"allothers");S.removeClassName(W+"onlyone");S.removeClassName(W+"firstone");S.removeClassName(W+"lastone")}}}else{if(T===0){S.addClassName(W+"firstone");S.removeClassName(W+"allothers");S.removeClassName(W+"lastone");S.removeClassName(W+"onlyone")}else{if(T===U-1){S.addClassName(W+"lastone");S.removeClassName(W+"allothers");S.removeClassName(W+"firstone");S.removeClassName(W+"onlyone")}else{S.addClassName(W+"allothers");S.removeClassName(W+"onlyone");S.removeClassName(W+"firstone");S.removeClassName(W+"lastone")}}}}}}};var k=function(){var T=this.add({label:o.newTab,touchMode:this.touchMode});var S=T._index;var V=T.value;this.modelEvent.publish({event:L,data:{index:S,value:T.value}});this.fire("preAddTab",{index:S,value:T.value});if(V!==T.value){this.historySelection[this.historySelection.length]={value:T.value,cpt:1};if(this.showComboBoxFlag){this._updateComboBox(S)}}this.buttonGroup.selectIndex(S);this._editTab(T.value);var U=this.buttonGroup.getContent().scrollWidth;var R=this.elements.tabBar.getBoundingClientRect().width;var Q=R-U;this.slide=(R/2)-(T.getContent().getBoundingClientRect().left-this.buttonGroup.getContent().getBoundingClientRect().left);if(this.slide<Q){this.slide=Q}if(this.displayStyle.indexOf("immersif")===-1){this.slide-=5}this.redrawTabBar();if(g){g._myInput.focus()}this.modelEvent.publish({event:J,data:{index:S}});this.fire("addTab",{index:S})};var c=function(){this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-strip");this.elements.buttonsContainer.addClassName("wux-controls-tabbar-strip");this.elements.container.addClassName("wux-controls-tabbar-strip");if(this.newTabButton){this.newTabButton.inject(this.elements.containerAddandNextButton);this.newTabButton.getContent().addClassName("wux-controls-tabbar-strip");this.newTabButton.icon="plus";this.newTabButton.label="";if(!this.newTabButtonFlag){this.newTabButton.hide()}}if(!this.showPreviousButton&&!this.showNextButton){this._createButtonsNextAndPrevious()}if(this.showPreviousButton){this.showPreviousButton.icon={iconName:"open-left",fontIconFamily:1};this.showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")}if(this.showNextButton){this.showNextButton.icon={iconName:"open-right",fontIconFamily:1};this.showNextButton.getContent().addClassName("wux-controls-tabbar-strip")}if(this.newTabButton){this.newTabButton.getContent().style.marginLeft="0px"}if(this.tabComboBox){this.tabComboBox.expanderIcon=this.newTabButtonFlag?"list-add":"list";this.tabComboBox.getContent().addClassName("wux-controls-tabbar-strip");if(!this.tabComboBox.elements.popup){this.tabComboBox._buildPopup()}this.tabComboBox.elements.popup.alignment="left";this.tabComboBox.elements.popup.getContent().addClassName("wux-controls-tabbar-strip");this.tabComboBox.elements.treeListView.getManager().options.defaultCellHeight=30;i.call(this);this.tabComboBox.inject(this.elements.containerAddandNextButton)}if(this.displayStyle.indexOf("strip-box")!==-1){this.elements.container.addClassName("wux-controls-tabbar-strip-box")}};var r=function(){this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-strip");this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-strip");this.elements.container.removeClassName("wux-controls-tabbar-strip");this.elements.container.removeClassName("wux-controls-tabbar-strip-box");if(this.showPreviousButton){this.showPreviousButton.destroy();this.showPreviousButton=null}if(this.showNextButton){this.showNextButton.destroy();this.showNextButton=null}if(this.tabCombobox){this.tabCombobox.destroy();this.tabCombobox=null}this._applyShowComboBoxFlag();this._applyNewTabButtonFlag()};var i=function(){if(!this.newTabComboBox){this.newTabComboBox=new F({icon:"plus",label:o.newTab,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,});this.newTabComboBox.tooltipInfos=new B({shortHelp:o.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton});this.newTabComboBox.elements.container.addClassName("wux-controls-tabbar-newbuttoncombo");var R=this;this.newTabComboBox.addEventListener("click",function(){k.call(R)});if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup){var Q=this.tabComboBox.elements.popup.getBody();var S=d.createElement("div");this.newTabComboBox.inject(S);Q.inject(S);this.tabComboBox.elements.popup.setBody(S)}}var Q=undefined;if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup){Q=this.tabComboBox.elements.popup.getBody()}if(this.newTabButtonFlag&&this.showComboBoxFlag){if(this.tabComboBox&&this.tabComboBox.elements&&this.tabComboBox.elements.popup&&Q.contains(this.newTabComboBox.getContent())===false){Q=this.tabComboBox.elements.popup.getBody();var S=d.createElement("div");this.newTabComboBox.inject(S);Q.inject(S);this.tabComboBox.elements.popup.setBody(S)}this.newTabComboBox.show();if(Q){Q.addClassName("wux-controls-tabbar-combopopup")}}else{this.newTabComboBox.hide();if(Q){Q.removeClassName("wux-controls-tabbar-combopopup")}}};var M=function(T,S){var Q=[];for(var R=0;R<T.length;R++){if(S.indexOf(T[R])===-1){Q.push(T[R])}}return Q};l.register(w,"DS/ControlsRec/AbstractRec");return w});define("DS/Controls/Tab",["UWA/Core","UWA/Class","DS/Controls/Abstract","DS/Controls/TabBar","DS/Utilities/Utils","DS/Controls/Button"],function(c,a,e,f,i,g){var b=e.inherit({name:"tab",markForRecordFlag:true,publishedProperties:{tabBar:{defaultValue:undefined,type:f},tabBarDOMContainer:{defaultValue:undefined,type:Object},tabPanelContainer:{defaultValue:undefined,type:Object},displayStyle:{defaultValue:"normal",type:String,category:"Appearance"},value:{defaultValue:undefined,type:[],recordFlag:true},multiSelFlag:{defaultValue:false,type:Boolean,category:"Behavior"},reorderFlag:{defaultValue:false,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:false,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:true,type:"boolean",category:"Behavior"},touchMode:{defaultValue:undefined,type:"boolean",category:"Accessibility",advancedSetter:true},multiSelLayout:{defaultValue:"vertical",type:String,category:"Appearance"},newTabButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:undefined,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-tab");if(!this.tabBarDOMContainer){this.tabBarDOMContainer=new c.Element("div",{"class":"tabBarContainer"});this.tabBarDOMContainer.inject(this.elements.container,"top")}if(!this.tabPanelContainer){this.tabPanelContainer=new c.Element("div",{"class":"tabContainer"});this.tabPanelContainer.inject(this.elements.container,"bottom")}if(!this.tabBar){this.tabBar=new f({allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton})}this._tabContent=[]},_postBuildView:function(){if(this.tabBar){this.tabBar.allowUnsafeHTMLOnTabButton=this.allowUnsafeHTMLOnTabButton}},_applyReorderFlag:function(){if(this.tabBar){this.tabBar.reorderFlag=this.reorderFlag}},_applyTabBar:function(l){if(l){l.remove()}if(this.tabBar&&this.tabBarDOMContainer){if(c.is(this.tabBar,"element")){this.tabBar=new c.extendElement(this.tabBar)}this.tabBar.inject(this.tabBarDOMContainer)}},_applyTabBarDOMContainer:function(l){if(l){l.remove()}if(this.tabBarDOMContainer){if(c.is(this.tabBarDOMContainer,"element")){this.tabBarDOMContainer=new c.extendElement(this.tabBarDOMContainer)}this._applyTabBar()}},_applyTabPanelContainer:function(l){if(l){l.remove()}if(this.tabPanelContainer){if(c.is(this.tabPanelContainer,"element")){this.tabPanelContainer=new c.extendElement(this.tabPanelContainer)}this.tabPanelContainer.addClassName("wux-controls-tab-container")}},_applyShowComboBoxFlag:function(){if(this.tabBar){this.tabBar.showComboBoxFlag=this.showComboBoxFlag}},_applyNewTabButtonFlag:function(){if(this.displayStyle.indexOf("strip")!==-1&&this.tabBar){this.tabBar.newTabButtonFlag=this.newTabButtonFlag}},_applyAutoCloseFlag:function(){if(this.tabBar){this.tabBar.autoCloseFlag=this.autoCloseFlag}},_applyDisabled:function(){this._parent();if(this.tabBar){this.tabBar.disabled=this.disabled}},_applyTouchMode:function(){this._postEditTouchMode()},_postEditTouchMode:function(){var l=this._getCurrentTouchMode();this._parent();if(this.tabBar){this.tabBar.touchMode=l}},_applyDisplayStyle:function(){if(this.tabBar&&this.displayStyle&&this.tabPanelContainer){this.tabBar.displayStyle=this.displayStyle;if(this.displayStyle.indexOf("panel")!==-1){this.tabPanelContainer.addClassName("wux-controls-tabbar-panel")}if(this.displayStyle.indexOf("strip")!==-1){this.tabPanelContainer.addClassName("wux-controls-tab-strip");if(this.displayStyle.indexOf("strip-box")!==-1){this.tabPanelContainer.addClassName("wux-controls-tab-strip-box")}}else{this.tabPanelContainer.removeClassName("wux-controls-tab-strip");this.tabPanelContainer.removeClassName("wux-controls-tab-strip-box")}if(this.displayStyle.indexOf("vertical")!==-1){if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.addClassName("wux-controls-tabbar-vertical");this.tabPanelContainer.addClassName("wux-controls-tabbar-vertical");var n=this.tabBar.buttonGroup._getButtonList();for(var m=0;m<n.length;m++){var l=n[m];if(l){if(l.elements.text){l.elements.text.hide()}if(l.elements.icon){l.elements.icon.style.margin="0px 0px 0px 0px"}}}}}else{if(this.tabBarDOMContainer&&this.tabPanelContainer){this.tabBarDOMContainer.removeClassName("wux-controls-tabbar-vertical");this.tabPanelContainer.removeClassName("wux-controls-tabbar-vertical");var n=this.tabBar.buttonGroup._getButtonList();for(var m=0;m<n.length;m++){var l=n[m];if(l){if(l.elements.text&&l.showLabelFlag==true){l.elements.text.show()}if(l.elements.icon&&l.label&&l.label!==""&&l.showLabelFlag==true){l.elements.icon.style.margin="0px 11px 0px 0px"}}}}}this.redrawTabBar()}},_applyMultiSelFlag:function(){if(this.tabBar){this.tabBar.multiSelFlag=this.multiSelFlag;this._applyDisplayStyle();this._applyMultiSelLayout()}},_applyMultiSelLayout:function(){if(this.multiSelFlag){if(this.multiSelLayout==="horizontal"){this.tabPanelContainer.addClassName("wux-controls-tab-horizontalMultiSelLayout");return}}this.tabPanelContainer.removeClassName("wux-controls-tab-horizontalMultiSelLayout")},_applyValue:function(o){if(o){var l=this.getIndexesFromValues(o);for(var p=0;p<l.length;p++){if(!this.tabBar.pinnedList||this.tabBar.pinnedList.indexOf(this.getPageValueFromIndex(l[p]))===-1){this._hideContent(this.getPageValueFromIndex(l[p]))}}}if(this.tabBar){this.tabBar.value=this.value;h.call(this);var n=this.getIndexesFromValues(this.value);n=n.sort();for(var m=0;m<n.length;m++){this._showContent(this.getPageValueFromIndex(n[m]))}this.redrawTabBar();this._checkForMultiSelection();this.fire("change")}},_applyRecId:function(){if(this.tabBar){this.tabBar.recId=this.recId}},_applyProperties:function(l){this._parent(l);if(this.isDirty("tabBar")){this._applyTabBar(l.tabBar)}if(this.isDirty("tabBarDOMContainer")){this._applyTabBarDOMContainer(l.tabBarDOMContainer)}if(this.isDirty("tabPanelContainer")){this._applyTabPanelContainer(l.tabPanelContainer)}if(this.isDirty("showComboBoxFlag")){this._applyShowComboBoxFlag(l.showComboBoxFlag)}if(this.isDirty("displayStyle")){this._applyDisplayStyle(l.displayStyle)}if(this.isDirty("value")){this._applyValue(l.value)}if(this.isDirty("multiSelFlag")){this._applyMultiSelFlag(l.multiSelFlag)}if(this.isDirty("reorderFlag")){this._applyReorderFlag(l.reorderFlag)}if(this.isDirty("newTabButtonFlag")){this._applyNewTabButtonFlag(l.newTabButtonFlag)}if(this.isDirty("autoCloseFlag")){this._applyAutoCloseFlag(l.autoCloseFlag)}},_checkForMultiSelection:function(){if(!this.tabPanelContainer){return}var l=[];var n=0;if(this.value){n=this.value.length}if(this.tabBar.pinnedList){for(var m=0;m<this.tabBar.pinnedList.length;m++){if(this.value.indexOf(this.tabBar.pinnedList[m])!==-1){l.push(this.tabBar.pinnedList[m])}}n=n+this.tabBar.pinnedList.length-l.length}if(n>1){this.tabPanelContainer.addClassName("wux-controls-tab-multiSelection")}else{this.tabPanelContainer.removeClassName("wux-controls-tab-multiSelection")}},getPageCount:function(){return this.tabPanelContainer.getChildren().length},getPageContent:function(l){var n=this.tabPanelContainer.getChildren();var m=n[l];return m},getPageContentFromValue:function(m){for(var l in this._tabContent){if(this._tabContent[l].value===m){return this._tabContent[l].content}}},getPageContentFromIndex:function(l){for(var m in this._tabContent){if(this._tabContent[m].index===l){return this._tabContent[m].content}}},setPageContentFromIndex:function(m,n){if(this._tabContent&&this._tabContent.length>m){var l=this._tabContent[m].content;if(c.is(n,"element")){n=new c.extendElement(n)}n.id=this._tabContent[m].value;n.inject(l,"before");if(l.getStyle("display")==="none"){n.setStyle("display","none")}this._tabContent[m].content=n;return l.remove()}},getPageIndexFromValue:function(m){for(var l in this._tabContent){if(this._tabContent[l].value===m){return this._tabContent[l].index}}},getOptionFromButton:function(l,m){return this.tabBar.getOptionFromButton(l,m)},setOptionFromButton:function(m,l,n){return this.tabBar.setOptionFromButton(m,l,n)},getPageValueFromIndex:function(l){for(var m in this._tabContent){if(this._tabContent[m].index!==undefined&&this._tabContent[m].index===l){return this._tabContent[m].value}}},add:function(m){var l=this.tabBar.add({label:m.label,index:m.index,isSelected:false,value:m.value,icon:m.icon,allowClosableFlag:m.allowClosableFlag,showTitleFlag:m.showTitleFlag});k.call(this,m.content,l._index,l.value);if(!m.isSelected){this._hideContent(l.value)}else{this._showContent(l.value)}if(m.isSelected){this.value=[l.value]}this._applyDisplayStyle();this._postEditTouchMode();return{button:l,value:l.value}},addTab:function(r,o,n,l,s,q,t,m){var p={label:r,content:o,index:n,isSelected:l,value:s,icon:q,allowClosableFlag:t,showTitleFlag:m};return this.add(p)},removeTab:function(m,o){var l=this.getIndexOf(m);var n=this.getPageValueFromIndex(l);if(l>=0){return this.removeTabContent(n,o)}},removeTabContent:function(p,r){var q=this.tabPanelContainer.getChildren();var o=this.getPageContentFromValue(p);var l=this.getPageIndexFromValue(p);if(l===undefined||l>=q.length||l<0){return}else{for(var n=0;n<this._tabContent.length;n++){if(this._tabContent[n].index!==undefined&&this._tabContent[n].index===l){this._tabContent[n].index=undefined;this._tabContent.splice(n,1);break}}var m=d.call(this,p);if(m){m.remove()}if(this.tabBar){this.tabBar.removeTab(p,r)}h.call(this);if(o.visibleFlag){o.show()}return m}},clear:function(){while(this.getPageCount()>0){this.removeTab(this.getPageContentFromIndex(0))}},getIndexOf:function(p){var l=-1;var o=this.getPageCount();for(var m=0;m<o;m++){var n=this.getPageContentFromIndex(m);if(n===p){l=m;break}}return l},getIndexesFromValues:function(l){return this.tabBar._indexesFromValues(l)},redrawTabBar:function(){this.tabBar.redrawTabBar();if(this.tabPanelContainer){if(this.displayStyle.indexOf("vertical")!==-1){this.tabPanelContainer.setStyles({width:this.getContent().getDimensions().width-this.tabBar.getContent().getDimensions().width-4+"px"})}else{this.tabPanelContainer.setStyles({width:"auto"})}}},isPinned:function(l){if(this.tabBar.pinFlag){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.indexOf(l)!==-1){return true}}return false},_showContent:function(m){var l=this.getPageContentFromValue(m);if(l){l.show()}},_showPinnedContent:function(){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var l=this.getIndexesFromValues(this.tabBar.pinnedList);l=l.sort();for(var m=0;m<l.length;m++){var n=this.getPageContentFromIndex(l[m]);if(n){n.show()}}}},_hideContent:function(m){var l=this.getPageContentFromValue(m);if(l){l.hide()}},_setTabVisibility:function(n,l){var m=this.getPageContentFromValue(n);if(m){if(l&&this.value.indexOf(n)!==-1){m.show()}else{m.hide()}}this.tabBar._setTabVisibility(n,l);this.redrawTabBar()},_redrawBorder:function(){var n=this.getIndexesFromValues(this.value);var q;var m=n.sort();var r=m;if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var p=this.getIndexesFromValues(this.tabBar.pinnedList);for(var o=0;o<p.length;o++){if(r.indexOf(p[o])===-1){r.push(p[o])}}}else{r=m}i.sortNumberArray(r);for(var l=0;l<r.length;l++){if(r.length>1&&r[l]!==r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.addClassName("wux-controls-tab-borderSeparator")}}else{if(r.length>1&&r[l]===r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}else{if(r.length===1&&r[l]===r[0]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}}}if(r.length>1&&r[l]===r[r.length-1]){q=this.getPageContentFromIndex(r[l]);if(q){q.removeClassName("wux-controls-tab-borderSeparator")}}if(r.length>1&&r[l]===r[0]){q=this.getPageContentFromIndex(r[l]);if(q){q.addClassName("wux-controls-tab-borderSeparator")}}}},_handleEvents:function(){var l=this;this.tabBar.addEventListener("change",function(m){m.stopPropagation();l.value=l.tabBar.value;l._redrawBorder();l.fire("onSelectTab",m)});this.tabBar.onEndTabDrag(function(m){j.call(l,m.valueButtonDragged,m.valueButtonTarget);l._redrawBorder()});this.tabBar.onPinTab(function(){l._checkForMultiSelection();l._showPinnedContent();l._redrawBorder()});this.tabBar.unPinTab(function(o){var m=o.value;var n=l.getPageContentFromValue(m);if(n){n.setStyles({"background-color":""});if(n&&l.value.indexOf(m)===-1){n.hide()}l._redrawBorder();l._checkForMultiSelection()}});this.tabBar.onRemoveTabEvent(function(m){if(l.tabBar!==m.tabBar){return}if(l.autoCloseFlag){l.removeTabContent(m.value);l.value=l.tabBar.value;l._redrawBorder()}l.fire("close")});this.tabBar.onPreNewTab(function(m){k.call(l,new c.Element("div"),m.index,m.value)})}});return b;function j(o,m){var s=this.getPageIndexFromValue(o);var r=this.getPageIndexFromValue(m);if(s-r===1){this.tabPanelContainer.insertBefore(d.call(this,o),d.call(this,m))}else{if(r-s===1){this.tabPanelContainer.insertBefore(d.call(this,m),d.call(this,o))}else{var p=d.call(this,m);var q=d.call(this,o);var n,l;if(p){n=p.nextSibling}if(q){l=q.nextSibling}if(n){this.tabPanelContainer.insertBefore(q,n)}else{q.inject(this.tabPanelContainer)}if(l){this.tabPanelContainer.insertBefore(p,l)}else{p.inject(this.tabPanelContainer)}}}h.call(this)}function k(p,n,q){var r=this.tabPanelContainer.getChildren();if(p){if(c.is(p,"element")){p=new c.extendElement(p)}p.id=q;if(n===undefined||r.length===0){p.inject(this.tabPanelContainer)}else{var m=undefined;var l=0;for(var o=0;o<this._tabContent.length;o++){if(this._tabContent[o].index<n&&this._tabContent[o].index>=l){m=this._tabContent[o].content;l=this._tabContent[o].index}}if(m){p.inject(m,"after")}else{p.inject(this.tabPanelContainer.getChildren()[0],"before")}}}this._tabContent[this._tabContent.length]={content:p,value:q,index:n};h.call(this)}function h(){if(this._tabContent){for(var m=0;m<this._tabContent.length;m++){if(this._tabContent.hasOwnProperty(m)){var l=this.getIndexesFromValues([this._tabContent[m].value]);if(this._tabContent[m].value!==undefined&&l!==undefined){this._tabContent[m].index=l[0]}}}}}function d(m){var n=this.tabPanelContainer.childNodes;for(var l in n){if(parseInt(n[l].id)===m){return n[l]}}}});