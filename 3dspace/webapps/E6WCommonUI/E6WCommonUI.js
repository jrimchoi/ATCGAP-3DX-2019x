define("DS/E6WCommonUI/UIHelper",["UWA/Core","UWA/Utils/Client","DS/UIKIT/Alert","DS/RDFFoundation/RDFUtils","UWA/Utils/InterCom","DS/UIKIT/SuperModal","DS/UIKIT/Mask","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(f,r,j,c,k,t,v,q){var n=q.get("E6WCommonUI.Info.LoadingData");var l=160;var u=120;var m=16300;var a=new Intl.DateTimeFormat(window.widget&&window.widget.lang,{weekday:"short",year:"numeric",month:"short",day:"numeric"});var o={autoHide:true,closable:true,closeOnClick:false};var s={enrichObjectFromSearch:function(x){var w=x.sourceid||x.sourceId;if(w){var y=w.indexOf(":");x.source=y===-1?w:w.substring(0,y);x.serviceId=c.serviceFromSource(x.source)}},extraDragForSwym:function(w){try{if(w.data.items[0].serviceId==="3DSwym"){if(!widget.socket){widget.socket=new k.Socket("DetailsDisplayView"+widget.id);widget.socket.subscribeServer("ifweServer",window.parent)}widget.socket.dispatchEvent("SwymContentDragStarted",w)}}catch(x){console.log(x)}},pictureAPIConfig:{defaultSwym:"https://dsext001-eu1-215dsi0708-3dswym.3dexperience.3ds.com",pictureAPIPrefix:"/api/user/getpicture/login/",pictureAPISuffixMini:"/format/mini",pictureAPISuffixNormal:"/format/normal"},i18n:function(x){if(!x){return""}var w;if(!window.WidgetConstants||!window.WidgetConstants.str){console.error("getWidgetConstant called too early (prior to constants initialization) ")}w=window.WidgetConstants&&window.WidgetConstants.str?window.WidgetConstants.str[x]:null;return w||q.get(x)},userPictureURL:function p(w,z,y){var x="";if(y&&(y.type==="Group"||y.type==="Group Proxy")){x=y.imageUrl}else{if(w){var B=this.pictureAPIConfig.pictureAPISuffixMini;var A=window.enoviaServer.swym;if(z==="normal"){B=this.pictureAPIConfig.pictureAPISuffixNormal}x=A?A+this.pictureAPIConfig.pictureAPIPrefix+w+B:""}}return x},isIpad:function(){return r.Platform.ipad},isAndroid:function(){return r.Platform.android},isSurface:function(){return(r.Platform.tablet&&(r.Platform.win32||r.Platform.win64))},isMobile:function(){return this.isIpad()||this.isAndroid()||this.isSurface()},isTouchDevice:function h(){return("ontouchstart" in window)||window.navigator.msMaxTouchPoints},isIE:function(){return r.Engine.ie},isEdge:function(){return window.navigator.userAgent.indexOf("Edge/")!==-1},DATA_KEY_LIST:[(typeof f.Utils.Client.Engine.ie!=="undefined")||(window.navigator.userAgent.indexOf("Edge/")!==-1)?"text":"text/plain","text/searchitems","dragObjectDetails"],isDataTransferTypeSupported:function(w){var x=false;if(w.types){x=this.DATA_KEY_LIST.some(function(z){for(var y=0;y<w.types.length;y++){return(w.types[y].toLowerCase()===z)}return false})}return(x)},getTransferObject:function(x){var w=f.clone(x,false);w.serviceId=w.serviceId||"3DSpace";var y={protocol:"3DXContent",version:"1.0",source:w.source,data:{items:[w]}};return y},getDataTransferJSON:function b(y){var z,w,x=["0.1","1.0","1.1","2.0"];this.DATA_KEY_LIST.some(function(B){z=y.getData(B);if(f.is(z,"string")){try{z=JSON.parse(z)}catch(A){return false}}w=(z.version&&z.protocol==="3DXContent");if(!w){s.displayError(s.i18n("E6WCommonUI.Alert.InvalidDataDropped"))}else{if(x.indexOf(z.version)===-1){w=false}}return w});if(w){return z}else{s.displayError(s.i18n("E6WCommonUI.Alert.InvalidDataDropped"));return false}},dateForJSON:function(y,z,w,x){var A=y;if(x&&x.dataForRendering){A=y&&{actualValue:A.getTime().toString(),displayValue:isNaN(A)?"":w&&w.getLocaleDate(A)}}else{if(z==="UTC"){if(isNaN(A.getTime())){A=""}else{A=A.toISOString()}}else{A=y.getTime()}}return A},getIntlDateFormat:function(x){var y=x;var w=new Date(x);if(w.toString()!=="Invalid Date"){y={actualValue:w,displayValue:isNaN(w.getTime())?y:a.format(w)}}return y},setHelper:function(z,A,y){var x;var w=y;if(z){if(f.is(z,"object")){x=z;w=A||{}}else{x={};x[z]=A;w=y||{}}}else{w=A}return{attrs:x,options:w}},match:function(w,x){if(w&&x){w=w.toLowerCase();x=x.toLowerCase();if(w.indexOf("*")===-1){return(x.indexOf(w)!==-1)}else{return new RegExp("^"+w.split("*").join(".*")+"$").test(x)}}else{return(false)}},processDroppedImage:function i(x,D,B){var w=[".png",".gif",".jpg",".jpeg"];var z=x[0];var A=z.name;var y=z.type;var C=A.lastIndexOf(".");if(C!==-1){var E=A.substring(C);if(w.indexOf(E.toLowerCase())!==-1){D.onload=function(){window.URL.revokeObjectURL(this.src);s.scaleImage(this,A,y,B)};D.src=window.URL.createObjectURL(z)}}},openFileExplorer:function(w){var x={id:"fileUploadButton",type:"file",accept:w.accept};if(!(f.Utils.Client.Platform.ios||s.isSurface()||s.isAndroid()||w.single===true)){x.multiple=true}var y=f.createElement("input",{attributes:x,styles:{display:"none"},events:{change:function z(){y.destroy();w.callback&&w.callback(this.files)}}});y.inject(document.body);y.click()},scaleImage:function d(D,C,H,E){var z=document.createElement("canvas");var G=z.getContext("2d");var y=D.naturalWidth;var F=D.naturalHeight;var B=Math.min(u/F,l/y);if(B<1){F*=B;y*=B}var x=1;var w;var A=function(){z.width=y;z.height=F;G.fillStyle="white";G.fillRect(0,0,z.width,z.height);G.drawImage(D,0,0,y,F);w=z.toDataURL("image/jpeg",x);return w.length};while(A()>m){x-=0.05}E(w)},initializeAlert:function(w){widget.alerter=new j(o);widget.alerter.inject(w,"top");widget.alerter._lastInjectedTo=w},displayMessage:function(w,x){if(!widget.alerter){console.log("No alerter defined. This must be done by the application.");return false}if(widget.alerter.setOptions){x?widget.alerter.setOptions(x):widget.alerter.setOptions(o)}if(widget.alerter.elements&&!widget.alerter.elements.container.isInjected()){widget.alerter.inject(widget.alerter._lastInjectedTo)}widget.alerter.add(w);widget.alerter.show();return true},displaySuccess:function(w){return this.displayMessage({message:w,className:"success"})},displayError:function(w){return this.displayMessage({message:w,className:"error"},{hideDelay:4000})},displayInfo:function(w){return this.displayMessage({message:w,className:"info"})},displayWarning:function(w){return this.displayMessage({message:w,className:"warning"})},displayPrimary:function(w){return this.displayMessage({message:w,className:"primary"})},getAlertInjectionLocation:function(){return widget.alerter&&widget.alerter._lastInjectedTo},updateDocumentConfirmation:function(D,x,C){if(D.length>1){s.displayError(q.get("E6WCommonUI.Alert.MultipleFilesNotSupported"));return}var B=D[0];var E=x.get("title");var w=B.name;var A={nameA:w,nameB:E};if(x.get("ds6w:type")!=="DriveFile"){w=this.getFileNameWithoutExtension(w);A={nameA:w,nameB:w}}if(E!==w){var y={title:q.get("E6WCommonUI.Label.Update")+" "+E,body:q.replace(q.get("E6WCommonUI.Alert.UpdateDifferentFileNames"),A),buttons:[{className:"primary",value:q.get("E6WCommonUI.Label.Update"),action:function(F){F.hide();C(B,x)}},{value:q.get("E6WCommonUI.Label.Cancel"),action:function(F){F.hide()}}]};var z=new t({renderTo:document.body});z.dialog(y)}else{C(B,x)}},getFileNameWithoutExtension:function(x){var w=x.lastIndexOf(".");if(w!==-1){x=x.substring(0,w)}return x},widgetInPreviewMode:function(x){var w=widget.id&&widget.id.indexOf("preview")!==-1&&!widget.getValue("addinmode");if(x&&w){s.displayError(q.get("E6WCommonUI.Alert.SearchNotPossibleInPreviewMode")+'&nbsp;<span class="preview-icon fonticon fonticon-publish" title=""></span>')}return w},showLoadingMessage:function(w,x){if(!v.isMasked(w)){v.mask(w,x||n)}},hideLoadingMessage:function(w){v.unmask(w)}};s.getTenantErrorMessage=function(x,w){return q.replace(q.get("E6WCommonUI.Alert.FailedToAttachObjectWithDifferentTenant"),{TENANT1:x,TENANT2:w})};s.displayAlreadyAttachedErrorMessage=function(x,w){var y=q.replace(q.get("E6WCommonUI.Warning.AlreadyAttached"),{PARENT_NAME:x,EXISTING_CHILD_NAME:w});s.displayError(y)};function g(x){var w={};w.id=x.objectId;w.title=x.displayName;w.serviceId=x.serviceId;w.tenant=x.envId;w.image=x.image||x.displayPreview;w.type=x.objectType;return w}function e(x){var w={};var y=x.sourceId?x.sourceId.split(":")[1]:window.enoviaServer.tenant;w.id=x.id;w.title=x.label||x["ds6w:label"];w.serviceId=x.serviceId||x.sourceId||"3DSpace";w.tenant=y;w.image=x.image||x.type_icon_url;w.type=x["ds6w:type_value"]||x["ds6w:type"];return w}s.getObjectDataFromDropSearchOrTypeAhead=function(w){var x;if(w.dropObj){x=g(w.dropObj)}else{if(w.detailedObject){x=e(w.detailedObject)}}return x};s.normalizedToJson=function(w,x){var y;if(typeof w.dataForRendering==="function"){y=w.dataForRendering(x)}else{if(typeof w.toJSON==="function"){y=w.toJSON(x)}else{y=f.clone(w,false)}}return y};s.IMAGE_MAX_WIDTH=l;s.IMAGE_MAX_HEIGHT=u;s.IMAGE_MAX_BYTE_SIZE=m;s.DATE_FORMAT=a;return s});define("DS/E6WCommonUI/WidgetUtils",["UWA/Core"],function(f){String.prototype.htmlEncode=function c(){var g=this.toString();g=g.replace(/&/g,"&amp;");g=g.replace(/>/g,"&gt;");g=g.replace(/</g,"&lt;");g=g.replace(/"/g,"&quot;");g=g.replace(/'/g,"&#x27;");g=g.replace(/\//g,"&#x2F;");return g};String.prototype.htmlDecode=function e(){var g=this.toString();g=g.replace(/&amp;/g,"&");g=g.replace(/&lt;/g,"<");g=g.replace(/&gt;/g,">");g=g.replace(/&quot;/g,'"');g=g.replace(/&#39;/g,"'");return g.hexDecode()};String.prototype.hexDecode=function b(){var k=this.toString(),h=k.split("&#x");while(h.length){var g="0x"+h.pop().split(";")[0],j,i;if(!isNaN(parseFloat(g))&&isFinite(g)){j=String.fromCharCode(g);i=new RegExp("&#x"+g.substring(2)+";","g");k=k.replace(i,j)}}return k};var a={makeHTML5Date:function(i){if(!i){return""}var h;if(i instanceof Date){h=i}else{var k=i;if(f.is(i,"string")){k=parseInt(i,10)}if(!isNaN(k)){h=new Date(k)}}if(h){var g=h.getDate();g=g<10?"0"+g:g;var l=(h.getMonth()+1);l=l<10?"0"+l:l;var j=h.getFullYear()+"-"+l+"-"+g;return j}return""},topWindowcache:null,getTopWindow:function d(h){if(this.topWindowcache){return this.topWindowcache}var g=window;while(g&&g.parent!==g){try{g.parent.test="temp";if(g.parent.test==="temp"){g=g.parent}else{break}}catch(i){break}}if(h){try{while(g.opener&&g.opener.top){g.opener.top.test="temp2";if(g.opener.top.test==="temp2"){g=g.opener.top}else{break}}}catch(i){}}this.topWindowcache=g;return this.topWindowcache}};return a});define("DS/E6WCommonUI/PlatformManager",["UWA/Core","UWA/Array","UWA/Class/Events","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(f,c,a,e){function d(){return window.widget!==undefined}var b=a.extend({_serviceData:[],_rolesData:[],initPlatformServiceData:function(g){if(this._serviceData.length!==0){g.onComplete();return}e.getPlatformServices({onComplete:function(h){b._instance.storePlatformServiceData(h);g.tenant&&b._instance.setTenant(g.tenant);g.onComplete()}})},storePlatformServiceData:function(g){this._serviceData=g;this.dispatchEvent("serviceDataLoaded")},getServiceUrl:function(g){var h=this.getTenantServiceData();if(!h||!h[g]){throw new Error("Service data not loaded")}return h[g]},getTenant:function(){if(d()){return widget.getValue("x3dPlatformId")}else{return this._tenant}},setTenant:function(g){if(d()){widget.setValue("x3dPlatformId",g)}else{this._tenant=g}},setTenantBy3DSpaceUrl:function(g){var h=c.detect(this._serviceData,function(i){return i["3DSpace"]===g});this.setTenant(h.platformId)},getTenantServiceData:function(){var g=this;return c.detect(this._serviceData,function(h){return h.platformId===g.getTenant()})},fetchRolesData:function(){var g=this;e.getGrantedRoles(function(h){g._rolesData=h;g.dispatchEvent("rolesDataLoaded")})},hasLoadedRolesData:function(){return this._rolesData.length>0},hasRole:function(j){if(this.hasLoadedRolesData()){var g=f.Array.detect(this._rolesData,function(k){return k.id==="InternalDS"});var i=f.Array.detect(this._rolesData,function(k){return k.id===j});var h=i&&(i.platforms.indexOf(this.getTenant())!==-1);return Boolean(g||h)}else{throw new Error("Fetching of Roles Data is not finished.")}},clearCachedServiceData:function(){this._serviceData=[];this._rolesData=[]},hasAccess:function(g){var h;try{h=this.getServiceUrl(g)}catch(i){h=false}finally{return(Boolean(h))}}});b._instance=b._instance||new b();return b._instance});define("DS/E6WCommonUI/Views/CustomizedAutocomplete",["DS/UIKIT/Autocomplete"],function(a){var b=a.extend({_shouldDropUp:function(f){var d=this.boundingElement||document.documentElement;var h=f||(this.getContent().getOffsets().y+this.elements.inputContainer.getDimensions().height),c=this.elements.suggestsContainer.getSize().height,e=d.clientHeight||window.innerHeight,g=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;return(h+c>e+g)},setBoundingElement:function(c){this.boundingElement=c}});return b});define("DS/E6WCommonUI/UnitBezier",["UWA/Class"],function(a){var b=a.extend({epsilon:0.000001,init:function(){var d,c,f,e;d=0.42;c=0;f=0.58;e=1;this.cx=3*d;this.bx=3*(f-d)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*c;this.by=3*(e-c)-this.cy;this.ay=1-this.cy-this.by},sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,k){var j;var h;var f;var d;var g;var e;for(f=c,e=0;e<8;e++){d=this.sampleCurveX(f)-c;if(Math.abs(d)<k){return f}g=this.sampleCurveDerivativeX(f);if(Math.abs(g)<k){break}f=f-d/g}j=0;h=1;f=c;if(f<j){return j}if(f>h){return h}while(j<h){d=this.sampleCurveX(f);if(Math.abs(d-c)<k){return f}if(c>d){j=f}else{h=f}f=(h-j)*0.5+j}return f},solve:function(c,e){var d=e?e:this.epsilon;return this.sampleCurveY(this.solveCurveX(c,d))}});return b});define("DS/E6WCommonUI/CompassUtil",["DS/i3DXCompassServices/i3DXCompassPubSub","DS/PlatformAPI/PlatformAPI"],function(a,b){return{openCompassWithModel:function(d,c){var e;if((c&&c.transferObject)||d.getTransferObject){e=(c&&c.transferObject)||d.getTransferObject&&d.getTransferObject()}if(e){a.publish("setObject",e.data.items[0]);a.publish("setX3DContent",e)}},publishOnPlatformAPI:function(d,c){if(c.getTransferObject){b.publish(d,c.getTransferObject())}}}});define("DS/E6WCommonUI/Collections/MergingCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener"],function(e,b,a,d){var c=a.extend(d,{_uwaClassName:"MergingCollection",addSubCollection:function(f,h){this._subCollections||(this._subCollections=[]);var g=e.clone(h||{},false);g.previousModels=this.toArray();this._subCollections.push(f);this.listenTo(f,"onAnyEvent",function(j){var i=Array.prototype.slice.call(arguments,1);this.dispatchEvent(j,i)});if(!h||!h.silent){this.dispatchEvent("onReset",[this,g])}},_arrayReturningFunction:function(g){if(!this._subCollections){return[]}var f=Array.prototype.concat.apply([],this._subCollections.map(g));return f},toArray:function(){return this._arrayReturningFunction(function(f){return f.toArray()})},size:function(){var f=0;if(this._subCollections){this._subCollections.forEach(function(g){f+=g.size()})}return f},toJSON:function(){return this._arrayReturningFunction(function(f){return f.toJSON()})},get:function(){var i;var g=this._subCollections;var f=g.length;for(var j=0;j<f;j++){var h=g[j];i=h.get.apply(h,arguments);if(i){break}}return i},indexOf:function(){var j;var g=this._subCollections;var f=g.length;var i=0;for(var k=0;k<f;k++){var h=g[k];j=h.indexOf.apply(h,arguments);if(j!==-1){j+=i;break}i+=h.length}return j},at:function(i){var l=i;if(l<0||!this._subCollections){return undefined}var h=this._subCollections;var g=h.length;for(var k=0;k<g;k++){var j=h[k];var f=j.size();if(f>l){return j.at(l)}l-=f}return undefined},complete:function(){var g=this._subCollections;var f=g.length;for(var i=0;i<f;i++){var h=g[i];if(e.is(h.complete,"function")){h.complete.apply(h,arguments)}}}});Object.defineProperty(c.prototype,"length",{get:function(){return this.size()}});return c});define("DS/E6WCommonUI/Search",["UWA/Core","UWA/Utils/InterCom","UWA/Utils"],function(g,c,e){var f=["3dspace","drive"];var b=function(h,j){this.socketName="search_socket_"+e.getUUID();this.socket=new c.Socket(this.socketName,{dispatchRetryInterval:5});this.socket.subscribeServer("SearchComServer");this.listener=this.objectsSelected.bind(this);this.socket.addListener("Selected_Objects_search",this.listener);var k=this;this.socket.addListener("onCloseTransient",function(){k.unregister()});var i=this.options({title:"iTitle"});if(j){i.idcard_activated=true}};var a=function(i){var h={};h.title="";h.types="";h.role="";h.default_search_criteria="";h.app_socket_id=i.socketName;h.mode="furtive";h.widget_id=widget.id;h.default_with_precond=true;h.show_precond=false;h.idcard_activated=false;h.select_result_max_idcard=false;h.source=["3dspace"];h.tenant=window.enoviaServer?enoviaServer.tenant:widget.getValue("x3dPlatformId");h.precond="";h.excluded_types={};h.callback=null;return h};b.prototype.destroy=function(){var h={};h.widget_id=enoviaServer.widgetId;this.socket.dispatchEvent("UnregisterContext",h);this.socket.unsubscribeServer("SearchComServer");this.socket.removeListener("Selected_Objects_search",this.listener);this.socket.removeListener("onCloseTransient");this.socket.disconnect()};function d(k){if(g.is(k.types,"object")){var m="Config not supported by 3dsearch. If you specify types for any source, you must do so for all sources";var j=g.is(k.source,"array")?k.source:[k.source];var h=Object.keys(k.types);if(h.length!==j.length){throw new Error(m)}for(var l=0;l<h.length;l++){if(j.indexOf(h[l])===-1){throw new Error(m)}}}}b.prototype.options=function(j){var i=g.clone(j||{},false);var h=a(this);if(i.excludedSearchTypes){h.excluded_types=i.excludedSearchTypes}g.extend(h,i);d(h);if(!h.precond){h.precond=b.buildSearchTypeQuery(h.types,h)}return(h)};b.prototype.activate=function(j){var k=this;var h=this.options(j);var i=h.callback;if(!g.is(i,"function")){h.mode="default"}this.callback=i;var l={};l.widget_id=enoviaServer.widgetId;this.socket.dispatchEvent("UnregisterContext",l);this.socket.addListener("RegisterContext_Response",function(){k.socket.dispatchEvent("InContextSearch",h);k.socket.removeListener("RegisterContext_Response")});this.socket.dispatchEvent("RegisterContext",h);this.socket.dispatchEvent("InContextSearch",h)};b.prototype.isAvailable=function(){return(g.is(this.socket))};b.prototype.objectsSelected=function(h){if(this.callback){this.callback(h)}};b.prototype.unregister=function(){var h={widget_id:enoviaServer.widgetId};this.socket.dispatchEvent("UnregisterContext",h)};b.buildSearchTypeQuery=function(l,r){var m;if(l){if(g.is(l,"string")){var h=r.source||["3dspace"];h=g.is(h,"array")?h:[r.source];if(h.indexOf("3dspace")===-1&&h.length){throw new Error("types as string only supported for 3dspace source as it is a backward compatibility feature")}l={"3dspace":l.split(",")}}var q=Object.keys(l);var i=q.length;m="(";for(var n=0;n<i;n++){if(n!==0){m+=" OR "}var k=q[n];var p=l[k];if(g.is(p,"string")){p=[p]}m+=b.buildSearchTypeQueryForSource(k,p)}if(r.excluded_types){var j=Object.keys(r.excluded_types);var o=j.length;if(o>0){m+=") AND NOT "+b.buildSearchTypeQuery(r.excluded_types,{})}else{m+=")"}}else{m+=")"}}else{if(r.excluded_types){m=" NOT "+b.buildSearchTypeQuery(r.excluded_types,{})}}return m};b.buildSearchTypeQueryForSource=function(l,k){var h;var m=b.isM1BasedSource(l);h=m?"flattenedtaxonomies:":"[ds6w:type]:";h+="(";if(l==="swym"&&k.indexOf("pno:Person")!==-1){h="ut_state:1 && "+h}for(var j=0;j<k.length;j++){var i=k[j];if(j!==0){h+=" OR "}if(m){h+='"types/'+i.trim()+'"'}else{h+='"'+i.trim()+'"'}}h+=")";return h};b.isM1BasedSource=function(h){return f.indexOf(h)!==-1};b.computeSourceParameters=function(h){var j=g.clone(h.excludeSearchTypes||{},false);var k={};f.forEach(function(m){if((g.is(h.searchSource,"array")&&(h.searchSource.indexOf(m))!==-1)||h.searchSource===m){if(!j[m]){j[m]=["Person","Security Context"]}}});var l=h.searchSourceTypes;var i;if(l){i={types:l,specificSourceParameter:k};b._buildSpecificSourceParameter(i)}i={types:j,specificSourceParameter:k,exclude:true};b._buildSpecificSourceParameter(i);return k};b._buildSpecificSourceParameter=function(p){var j=p.specificSourceParameter;var l=p.types;var o=Object.keys(l);var n=o.length;for(var k=0;k<n;k++){var q=o[k];var i=l[q];var m=j[q];var h=(m&&m.additional_query)||"";if(h){h+=" AND "}if(p.exclude){h+="NOT "}h+=b.buildSearchTypeQueryForSource(q,i);j[q]={additional_query:h}}return j};return(b)});define("DS/E6WCommonUI/Models/CloneModel",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection","DS/E6WCommonUI/UIHelper"],function(d,a,l,k,e,j){"use strict";function f(q,o){var m;if(o){for(var n=0;n<o.length;n++){var p=o[n];if(p.id===q){m=p;break}}}return m}var i=a.extend(l,{init:function(m,n){this.config=(n&&n.config)||{imageAttribute:"image",attributeToDisplay:"title"};this.file=m},get:function(n){var m;if(n==="canEdit"){return false}if(n===this.config.imageAttribute&&this.file){if(this.file.FileName){return""}return window.URL.createObjectURL(this.file)}if(n===this.config.attributeToDisplay&&this.file instanceof window.File){m=this.file.name}else{m=this.file.FileName}return m},toJSON:function(){var m={};m[this.config.imageAttribute]=this.get(this.config.imageAttribute);m[this.config.attributeToDisplay]=this.get(this.config.attributeToDisplay);m.canEdit=this.get("canEdit");return m}});var c=a.extend(l,k,{_uwaClassName:"CloneModel",FileValue:i,i18n:function(n,m){return m||n},init:function(o,n){var m=d.clone(n||{},false);m.i18n&&(this.i18n=n.i18n);this.model=o;if(d.is(this.model.addEvent,"function")){this.listenTo(this.model,"onAnyEvent",function(q){if(q.indexOf("onChange")===0){var p=Array.prototype.slice.call(arguments,1);p[0]=this;this.dispatchEvent(q,p)}})}this.localAttributes={};this.localRelatedData={};this._options=m;Object.defineProperty(this,"csrf",{get:function(){return this.model.csrf}});Object.defineProperty(this,"id",{get:function(){return this.model.id}});if(d.is(this.model.updateDocument,"function")){this.updateDocument=this.model.updateDocument.bind(this.model)}},_dataForRendering:function(){if(d.is(this.dataForRendering,"function")){return this.dataForRendering.apply(this,arguments)}else{if(d.is(this.toJSON,"function")){return this.toJSON()}else{return d.clone(this,false)}}},toJSON:function(){var m=d.is(this.model.toJSON,"function")?this.model.toJSON.apply(this.model,arguments):d.clone(this.model,false);this._overlayAttributes(m);return m},dataForRendering:function(){var m=this._dataForRendering.apply(this.model,arguments);this._overlayAttributes(m);return m},_overlayAttributes:function(u){var s=u;var o=Object.keys(this.localRelatedData);var q=o.length;for(var v=0;v<q;v++){var n=o[v];var r=this.get(n);var A=(r?r.length:0);var t=[];for(var y=0;y<A;y++){var m=r.at?r.at(y):r[y];t.push(this._dataForRendering.call(m))}s[n]=t}var x=Object.keys(this.localAttributes);q=x.length;for(var p=0;p<q;p++){var z=x[p];var w=this.localAttributes[z];if(d.is(w,"object")){w=this._dataForRendering.call(w)}s[z]=w}return s},_hasModifiedProperty:function(m){return(this.localAttributes.hasOwnProperty(m)||this.localRelatedData.hasOwnProperty(m))},get:function(n){var p=this.localRelatedData[n];var t=this.model.get(n);if(!p){var s=this.localAttributes[n];if(typeof s!=="undefined"){return s}return t}t=t||[];if(t instanceof e){t=t.toArray()}var q=p.length;for(var o=0;o<q;o++){var u=p[o];var m;if(u.operation==="add"){m=u.value;if(t&&t.unshift){t.unshift(m)}else{t=[m]}}else{if(u.operation==="remove"){if(d.is(t.toArray,"function")){t=t.toArray()}if(!d.is(t,"string")&&d.is(t.indexOf,"function")){var r=t.indexOf(u.value);t.splice(r,1)}else{if(t===u.value){t=undefined}else{if(d.is(t,"string")&&t===u.value.id){t=undefined}}}}}}return t},set:function(t,s,p){var o=d.clone(p||{},false);var r=s;var q=o&&o.whisper;if(q){delete o.silent}var m=o&&o.silent;this.localAttributes[t]=r;var n=this.modificationsPending;this.modificationsPending=true;m||q||this.dispatchEvent("onChange",[this,p]);m||q||this.dispatchEvent("onChange:"+t,[this,s,p]);if(!m&&n!==this.modificationsPending){this.dispatchEvent("onChange:modificationsPending",[this])}if(o&&o.validate&&this.validate){this.validationError=this.validate(this.toJSON(),o);if(!m&&this.validationError){this.dispatchEvent("onValidationFailure")}}},add:function(w,u,x){var v;if(d.is(u,"array")||u instanceof window.FileList){v=u}else{if(u instanceof a){v=[u]}else{if(d.is(u.split,"function")){v=u.split(",").map(function(y){return y.trim()})}}}var r=v.length;var o=[];var q=false;var n=false;var m=d.clone(x||{},false);for(var p=0;p<r;p++){var t=v[p];m.detailedObject=f(t,m.detailedObjects);var s=this.addIndividualObject(w,t,undefined,m);s.ret&&o.push(s.ret);q=q||s.changed;n=n||s.changedModificationPending}if(n){this.dispatchEvent("onChange:modificationsPending",[this])}if(q){m.operation="add";m.added=o;this._fireRelationshipChangeEvents(w,m)}return o},addIndividualObject:function(n,A,s,o){var w=this.localRelatedData[n];if(!w){w=this.localRelatedData[n]=[]}var u;var t=false;var E=this.modificationsPending;var z=o.DocumentManagement&&o.DocumentManagement.MSFDocumentClient;if(d.is(A,"string")){var v=this._alreadyHasObjectInRelatedData(n,A);if(v){j.displayAlreadyAttachedErrorMessage(this.get("title"),v.get("title"));return{ret:u,changed:t,changedModificationPending:this.modificationsPending!==E}}var p=s?s:this.getObjectToBeAdded(n,A,o);var q=w.length;var r=p!==undefined;for(var x=q-1;r&&x>=0;x--){var B=w[x];var C=B.value;if(C.id===A){r=false;switch(B.operation){case"remove":w.splice(x,1);t=true;break;default:break}}}if(r){w.push({operation:"add",input:p.id,value:p});this.modificationsPending=true;t=true}u=p}else{if((z&&z.isConnectedToMSFClient()||A instanceof window.File||A instanceof window.Blob)){var D=A;var y=new this.FileValue(D,o);var m={operation:"add",input:D,value:y};if(o&&o.fileDropped){m.fileDropped=true}m.isThumbnail=o&&o.config&&o.config.isThumbnail;w.push(m);this.modificationsPending=true;if(D){u=y}return{ret:u,changed:true,changedModificationPending:this.modificationsPending!==E}}else{return this.addIndividualObjectAsModel(n,A)}}return{ret:u,changed:t,changedModificationPending:this.modificationsPending!==E}},_alreadyHasObjectInRelatedData:function(m,q){var p=function(r){return d.equals(r.id,q)||r.get("physicalId")===q};var n=this.get(m)||[];var o=n.detect||n.find;return o&&o.call(n,p,q)},addIndividualObjectAsModel:function(m,o){this.localRelatedData[m]=this.localRelatedData[m]||[];var n=this._alreadyHasObjectInRelatedData(m,o.id);if(n&&!o.isNew()){j.displayAlreadyAttachedErrorMessage(this.get("title"),n.get("title"));return{ret:undefined,changed:false,changedModificationPending:false}}var p=this.modificationsPending;this.localRelatedData[m].push({operation:"add",input:o,value:o});this.modificationsPending=true;return{ret:o,changed:true,changedModificationPending:this.modificationsPending!==p}},getObjectToBeAdded:function(s,o,m){var r=false,q;var p,n;if(m&&m.dropObj&&m.dropObj.serviceId){r=true;p=m.dropObj.serviceId;n=m.dropObj.envId}else{if(m&&m.detailedObject){r=true;p=m.detailedObject.serviceId}}q=d.is(this.model.collection.getRelatedObject,"function")&&this.model.collection.getRelatedObject(s,o,r,undefined,{attributes:{service:p,tenant:n}});if(r&&p!=="3DDrive"){q.serviceId=p;q.fetch()}return q},remove:function(n,v,B){var o=d.clone(B||{},false);var q=this.localAttributes[n];if(q&&!this.model.get(n)){delete this.localAttributes[n];o.operation="remove";o.removed=q;o.at=v;this._fireRelationshipChangeEvents(n,o);var y=Object.keys(this.localAttributes);var r=Object.keys(this.localRelatedData);if(y.length===0&&r.length===0){this.modificationsPending=false;this.dispatchEvent("onChange:modificationsPending",[this])}return}var t=this.localRelatedData[n];if(!t){t=this.localRelatedData[n]=[]}var u=this.get(n);var w;if(d.is(u,"array")){w=u[v]}else{if(d.is(u.at,"function")){w=u.at(v)}}if(!w&&!d.is(u,"array")&&!(u instanceof e)){w=u}if(w){var s=t.length;var x=true;for(var p=s-1;p>=0;p--){var A=t[p];var m=A.value;if(m===w){x=false;switch(A.operation){case"add":t.splice(p,1);break;default:break}}}if(x){var z={operation:"remove",input:v,value:w};if(B&&B.config&&B.config.isThumbnail){z.isThumbnail=true}t.push(z);this.modificationsPending=true;this.dispatchEvent("onChange:modificationsPending",[this])}o.operation="remove";o.removed=w;o.at=v;this._fireRelationshipChangeEvents(n,o)}},cancel:function(){var n=this.localAttributes;var m=this.localRelatedData;this.localAttributes={};this.localRelatedData={};if(this.modificationsPending){this.modificationsPending=false;this.dispatchEvent("onChange:modificationsPending",[this]);this.dispatchEvent("onChange",[this]);var p=Object.keys(n);p.push.apply(p,Object.keys(m));var q=p.length;for(var o=0;o<q;o++){this.dispatchEvent("onChange:"+p[o])}}},save:function(o){var n=d.clone(o||{});this.modificationsPending=false;this.dispatchEvent("onChange:modificationsPending",[this]);var q=this._saveRelatedData(n)||n.changed;var m=this.localAttributes;var p=Object.keys(m);if(p.length){q=true}else{m=null}this.localAttributes={};if(q){this._modelSave(m,n)}},_modelSave:function b(o,n){var m=d.clone(n||{},false);d.merge(m,this._options);this.model.save(o,m)},_saveRelatedData:function(w){var t=false;var r=this.localRelatedData;var o=Object.keys(r);this.localRelatedData={};var p=o.length;for(var u=0;u<p;u++){var m=o[u];var q=r[m];if(!q){continue}var s=q.length;for(var n=0;n<s;n++){var v=q[n];if(v.operation==="add"){if(v.input instanceof window.File||v.input.FileName){this._addFile(m,v,w)}else{d.is(this.model.addObjects,"function")&&this.model.addObjects([v.input],m,undefined,{silentOnChange:true,at:0,values:[v.value]});t=true}}else{if(v.operation==="remove"){if(v.isThumbnail){d.is(this.model.removeThumbnail,"function")&&this.model.removeThumbnail(m,v.value,{silentOnChange:true})}else{d.is(this.model.removeObject,"function")&&this.model.removeObject(m,v.value,{silentOnChange:true});t=true}}}}}return t},_addFile:function(r,m,p){var o=d.clone(p||{},false);if(m.isThumbnail){this.model.uploadThumbnail(m.input,r,{noSave:true,fileWrapper:m.value})}else{var t,q;var s={fieldName:r};d.merge(s,o);var n=m.input.FileName;if(m.input instanceof window.File){n=m.input.name}if(m.fileDropped){o.fileDropped=true}s.fileName=n;t=this.onFileUploadComplete.bind(this,s);q=this.onFileUploadFailure.bind(this,s);d.is(this.model.uploadFiles,"function")&&this.model.uploadFiles([m.input],r,d.merge({noSave:true,fileWrapper:m.value,onComplete:t,onFailure:q},o))}},destroy:function(){this.stopListening();delete this.model},isValid:function(m){return !this.validate||!this.validate(this.toJSON(),m)},_fireRelationshipChangeEvents:function(o,n,m,p){if(!(n&&n.silent)){if(!p){this.dispatchEvent("onChange:"+o,[this,n]);if(n.operation==="add"){this.dispatchEvent("onAdd:"+o,[this,n])}else{if(n.operation==="remove"){this.dispatchEvent("onRemove:"+o,[this,n])}}}if(!m){this.dispatchEvent("onChange",[this,n])}}},onFileUploadComplete:function g(m){var n=this.i18n("emxFoundation.Label.FileUploadSuccess");n=n.replace("%FILE_NAME%",m.fileName);j.displaySuccess(n)},onFileUploadFailure:function h(m,o){this.dispatchEvent("onChange:"+m.fieldName);var n=o;if(!n){n=this.i18n("emxFoundation.Error.FileUploadFailed");n=n.replace("%FILE_NAME%",m.fileName)}j.displayError(n)}});c.FileValue=i;return c});define("DS/E6WCommonUI/Views/FoundationBaseView",["UWA/Core","UWA/Element","UWA/Event","UWA/Class/View","DS/E6WCommonUI/UnitBezier","DS/E6WCommonUI/UIHelper"],function(g,d,j,a,i){var c=new WeakMap();var f=d.prototype.constructor.hasClassName;d.prototype.constructor.hasClassName=function(m){if(this instanceof SVGElement){var l=this.className.baseVal;return(l&&l.contains(m," "))}else{return f.apply(this,arguments)}};var b=d.prototype.constructor.addClassName;d.prototype.constructor.addClassName=function(l){if(this instanceof SVGElement){if(!this.hasClassName(l)){this.setAttribute("class",this.getAttribute("class")+" "+l)}return this}else{return b.apply(this,arguments)}};var e=d.prototype.constructor.removeClassName;d.prototype.constructor.removeClassName=function(m){if(this instanceof SVGElement){var l=this.getAttribute("class")||"";this.setAttribute("class",l.replace(new RegExp("(^|\\s)"+m+"(?:\\s|$)"),"$1").trim());return this}else{return e.apply(this,arguments)}};var h=a.extend({tagName:"div",id:function(){var l;if(this.collection){l=this.collection.extid}else{if(this.model){l=this.model.id}}return l},_startOfSetup:Function.prototype,_endOfdestroy:Function.prototype,setup:function(l){this._startOfSetup();c.set(this.container,this);this._parentView=l?l.parentView:undefined;return l},init:function(m){var n=m&&m.tagName||this.tagName;var o=m&&m.className||this.className;var q=m&&m.id||this.id;if(!m||!m.container){var p=/^svg:(.*)/.exec(n);if(p){this.model=m&&m.model;this.collection=m&&m.collection;var l=m&&m.attributes||this.attributes||{};if(o){o=g.is(o,"function")?o.call(this):o;l["class"]=o}this.container=this.createSVGElement(p[1],l);if(q){if(g.is(q,"function")){q=q.call(this)}this.container.id=q}}}return this._parent.apply(this,arguments)},addChildView:function(l){if(!this._childrenViews){this._childrenViews=[l]}else{this._childrenViews.push(l)}if(!l._parentView){l._parentView=this}return l},cleanUpChildren:function(){var l=this;if(this._childrenViews){var m=g.clone(this._childrenViews,false);m.forEach(function(n){l.stopListening(n);if(g.is(n.destroy,"function")){n.destroy()}});delete this._childrenViews}},removeChildView:function(m){if(this._childrenViews){var l=this._childrenViews.indexOf(m);if(l!==-1){this._childrenViews.splice(l,1);return true}}return false},destroy:function(){if(!this.isDestroyed){this.cleanUpChildren();this.stopListening();this.collection=null;this.model=null;if(this._parentView){this._parentView.removeChildView(this)}this._parent();this.container&&this.container.empty(true);this.container=null;this._parentView=null;this.isDestroyed=true;this._endOfdestroy()}else{console.log("FoundationBaseView: View destroyed twice. Check for bug.")}},setDefaultImages:function(o){var n=o||this.container;var l=n.getElements("img");var m=l.length;var r=function(){this.removeEvent("error");this.src=""};for(var q=0;q<m;q++){var p=l[q];p.addEvent("error",r)}},createSVGElement:function(m,l){var n=g.extendElement(document.createElementNS("http://www.w3.org/2000/svg",m));n.animationFrameTimestamps={};if(l){n.setAttributes(l)}Object.defineProperty(n,"offsetHeight",{get:function(){try{return this.getBBox?this.getBBox().height:0}catch(o){return 0}}});Object.defineProperty(n,"offsetWidth",{get:function(){try{return this.getBBox?this.getBBox().width:0}catch(o){return 0}}});n.setAttribute=function(o){var p=this.animationFrameTimestamps[o];if(p){window.cancelAnimationFrame(p);delete this.animationFrameTimestamps[o]}this.__proto__.setAttribute.apply(this,arguments)};n.animateAttribute=function(v,u,s){var x=["x","y","width","x2","cx"];var q=null;var w=this.getAttribute(v);var r=0;var t=this;var o;var p=function(A){delete t.animationFrameTimestamps[v];if(!q){q=A}var z=A-q;if(z<s){var y=parseFloat(w+r*o.solve(z/s));t.setAttribute(v,y);t.animationFrameTimestamps[v]=window.requestAnimationFrame(p)}else{t.setAttribute(v,u)}};if(x.indexOf(v)>-1){w=w?parseFloat(w):0;s=s?s:500;r=u-w;o=new i({easeOut:r<0});t.animationFrameTimestamps[v]=window.requestAnimationFrame(p)}else{g.log("Animate not defined for attribute '"+v+"'. Just setting it.");n.setAttribute(v,u)}};return n},escapeCssId:function(m){var l=m.replace(/[:=? ~!@$%^&*()+,./';"><[\]{}|`#]/g,"\\$&");return l}});h.getViewFromContainer=function k(l){return l&&c.get(l)};return h});define("DS/E6WCommonUI/Models/DropValidator",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(h,b,d,e,g){var a={"dsxplan:TaskVersion":g.get("E6WCommonUI.Label.Task"),"dsxplan:MilestoneVersion":g.get("E6WCommonUI.Label.Milestone"),"dsxplan:ProjectVersion":g.get("E6WCommonUI.Label.Project"),"pno:Person":g.get("E6WCommonUI.Label.Person")};function c(i){return a[i]||i}var f={validateDroppedObject:function(j,i){var l=f._validateType(j,i);if(!l&&i.validateSameTenant){l=f.validateTenant(j)}if(!l){var k=i.searchSource;if(i.dropTypes){k=Object.keys(i.dropTypes)}l=f._validateSource(b.sourceFromService(j.serviceId),k)}if(!l&&j.objectType==="pno:Person"){if(j.objectId.indexOf("mailto:")===0){l=g.get("E6WComonUI.Error.CantAddPendingPersons")}}return l},validateTenant:function(j){var i;if(j.envId!==e.getTenant()){i=d.getTenantErrorMessage(j.envId,e.getTenant())}return i},_validateSource:function(l,k){var i;var j=k&&k.length>0?k.slice(0):["3dspace"];if(j.indexOf(l)===-1){i=g.replace(g.get("E6WCommonUI.Alert.FailedToAttachObjectBadSource"),{SOURCE:l})}return i},_validateType:function(k,i){var o=false;var p=k.objectType;var j=b.sourceFromService(k.serviceId);var l=i.dropTypes||i.searchSourceTypes;if(l){var q=l[j];if(q){o=q.indexOf(p)===-1}}if(i.searchTypes){var m=i.searchTypes.split(",");o=o||m.indexOf(p)===-1}if(!o&&i.excludeSearchTypes){var r=f._getExcludedSearchTypeArray(j,i);o=r.length&&r.indexOf(p)!==-1}var n;if(o){n=g.replace(g.get("E6WCommonUI.Alert.FailedToAttachObjectBadType"),{TYPE:c(p)})}return n},_getExcludedSearchTypeArray:function(k,i){var j=[];var l=i.excludeSearchTypes;if(h.is(l,"object")){j=i.excludeSearchTypes[k]||[]}else{j=l.split(",")}return j}};f.PERSON_DROP_TYPES={"3dspace":["Person"],swym:["pno:Person"]};return f});define("DS/E6WCommonUI/Views/E6WHandlebarsHelpers",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/WidgetUtils","DS/E6WCommonUI/UIHelper"],function(e,d,c,b){var a={};if(!d.helpers.userPictureUrl){d.registerHelper("userPictureUrl",function(h,i,g){if(!h){return""}var f=b.userPictureURL(h,undefined,{type:i,imageUrl:g});return f});d.registerHelper("assetImageURL",function(g){if(!g){return""}var f=require.toUrl(g);return f});d.registerHelper("makeHTML5Date",function(g){var f=c.makeHTML5Date(g);return f});d.registerHelper("i18n",function(f){var g=a.i18n(f);return g});d.registerHelper("eachLimit",function(g,k,q){var o="";var h=g?g.length:0;var p=h>k&&k>0?k:h;var f=(q&&q.hash&&q.hash.startingIndex)||0;var n;if(q.data){n=d.createFrame(q.data)}if(typeof h!=="number"){o=q.fn(g)}else{for(var m=0,l=p;m<l;m++){if(n){n.index=m;n.indexWithOffset=m+f}o+=q.fn(g[m],{data:n})}if(p!==h){o+=q.inverse(this,{data:n})}}return o});d.registerHelper("E6Wif",function(g,h,f){if(g===h){return f.fn(this)}else{return f.inverse(this)}});d.registerHelper("readOnlyValue",function(f){var g=f&&parseInt(f)!==0&&parseFloat(f)!==0?f:"--";return g});d.registerHelper("ifEmpty",function(g,f){if((g&&e.is(g,"array")&&g.length>0)||(g&&parseInt(g)!==0&&parseFloat(g)!==0)){return(f.inverse(this))}else{return(f.fn(this))}});d.registerHelper("concat",function(){var g="";for(var f in arguments){if(typeof arguments[f]!=="object"){g+=arguments[f]}}return g})}return a});define("DS/E6WCommonUI/Views/DetailsDisplaySharedView",["UWA/Core","DS/ENO6WPlugins/jQuery_3.3.1","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(d,j,b,h,c,g,f){var a=h.extend({_uwaClassName:"E6WCommonUIDetailsDisplaySharedView",tagName:"div",className:"details-display-shared-view ddv-field form-group ",name:"E6WCommonUI.DetailsDisplaySharedView",id:function(){var k=this._config;return k.type+"Property_"+this.cid},init:function(l){var k=d.clone(l||{},false);this._config=k.config;this._parent.apply(this,arguments);this.setConfiguredTemplate()},setConfig:function i(k){this._config=k;this.setConfiguredTemplate()},setup:function(l){var k=d.clone(l||{},false);this._options=k;var m=k.i18n;m&&(this.i18n=m);this.tenant=k.tenant;if(this.model&&this._config){this.addModelEvents()}this._setContainerAttributes();this._parent.apply(this,arguments)},setConfiguredTemplate:function(){if(this.compiledTemplate){var m=c.i18n;c.i18n=f.get.bind(f);var l=this._config;l.viewId="_"+this.cid;var k=this.compiledTemplate(l);l.template=b.compile(k);c.i18n=m}},template:function(k){var m=k.data;var n=c.i18n;c.i18n=f.get.bind(f);var l=this._config.template(m);c.i18n=n;return l},_setContainerAttributes:function(){var k=this._config;if(k.className){this.container.toggleClassName(k.className,true)}if(k.W){this.container.toggleClassName("sixdub "+k.W,true)}this.container.setAttribute("data-field-type",k.type);this.container.setAttribute("data-field-name",k.name);this.container.setAttribute("data-field-index",k.index)},addModelEvents:function(){var k=this._config;if(this.model&&this.model.addEvent){this.listenTo(this.model,"onChange:"+k.name,function(m,n,l){if(!(l&&l.detailsDisplayViewDebounce)){this.refreshView()}});k.endDateAttribute&&this.listenTo(this.model,"onChange:"+k.endDateAttribute,function(){this.render()});this.listenTo(this.model,"onValidationFailure",this._highlightValidationErrors);this.listenTo(this.model,"onValidationSuccess",this._clearValidationErrors)}},refreshView:function(){this.render()},resetModel:function(k){if(k!==this.model){this.model&&this.stopListening(this.model);this.model=k;this.addModelEvents();this._highlightValidationErrors()}},_highlightValidationErrors:function(){this._clearValidationErrors();if(this.model&&this.model.validationError&&this.model.validationError.fields){var n=this._config;var k=false;var l=this.container;var o=n.name;if(this.model.validationError.fields.indexOf(o)!==-1){k=true;var m=this.model.validationError.messages&&this.model.validationError.messages[o];m&&this._displayValidationError(m)}l&&l.toggleClassName("has-error",k)}},_displayValidationError:function(k){if(!this._errorSpanNode){this._errorSpanNode=d.createElement("span",{"class":"text-error"})}this._errorSpanNode.inject(this.container);this._errorSpanNode.setText(k)},_clearValidationErrors:function(){this._errorSpanNode&&this._errorSpanNode.remove();this.container.toggleClassName("has-error",false)},normalizedSet:function(l,k,p){var n=l.validationError;var m=d.clone(k||{},false);m.detailsDisplayViewDebounce=true;var o;if(d.is(l.set,"function")){m.whisper=true;o=l.set(k.name,p,m)}else{o=l[k.name]=p}if(n&&!l.validationError&&d.is(l.dispatchEvent,"function")){l.dispatchEvent("onValidationSuccess")}return o},normalizedGet:function(k,l){if(!k||!l){return""}if(d.is(k.get,"function")){return k.get(l)}return k[l]},render:function(l){if(!this.model){return this}var k=d.clone(l||{},false);var n=k.data;n=this._getData(n);this.undelegateDOMEvents();var m=this._config.readWrite;if(!m){m=false}this.container.toggleClassName("editable",Boolean(m&&n.canEdit));this.container.setHTML(this.template({data:n}));this.delegateDOMEvents();this._highlightValidationErrors();return this},getDataOptions:function(){return{attributes:[this._config.name,"canEdit"],level:0}},_getData:function e(m){var l=m;if(!m&&this.model){var k=this.getDataOptions();l=g.normalizedToJson(this.model,k)}return l}});return a});define("DS/E6WCommonUI/Views/ObjectView",["UWA/Core","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/Handlebars/Handlebars","UWA/Controls/Drag","UWA/Class/Promise","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENO6WPlugins/jQuery_3.3.1","DS/UIKIT/Spinner","DS/E6WCommonUI/Search","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Views/CustomizedAutocomplete","DS/E6WCommonUI/Models/DropValidator","text!DS/E6WCommonUI/assets/templates/object.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(d,b,x,T,ae,K,h,B,p,z,s,D,C,e,i,o){"use strict";var ad=T.compile(i);var v="drag-over";var n=(D.isIE()||D.isEdge())?"text":"text/searchitems";var ag=B.extend({_uwaClassName:"E6WCommonUIObjectView",tagName:"div",name:"E6WCommonUI.ObjectView",domEvents:{"dragenter .drop-target":"handleDragEnter","dragover .drop-target":"handleDragOver","dragleave .drop-target":"handleDragLeave","drop .drop-target":"handleDrop","dragend .drop-target":"handleDragEnd","click .object-list a":"objectClick","click ul":"_activateObjectField","click button.ds-group-plus":"_activateObjectField","click button.ds-group-upload":"_uploadToObjectList","click .custom-button":"_onClickCustomButton",'keypress .ds-group-add input[type="text"]':"_keyUpInputAddObject",'input .ds-group-add input[type="text"]':"_enableDisableSearch","click label":"_preventLabelDefault","click input":"_onInputClicked","keyup input":"_onKeyUp"},i18n:function ai(aj,ak){return ak||aj},getDataOptions:function M(){var aj=this._parent.apply(this,arguments);aj.level=1;aj.attributes.push("physicalId",this._config.attributeToDisplay,this._config.imageAttribute,"busType","type","hasfiles");return aj},setup:function m(aj){this._parentContainerId=aj.detailDisplayViewId;this._parent.apply(this,arguments);var ak="";if(this._config.readWrite){this.search=this._config.search||new s(ak,false,"furtive")}this.context=aj&&aj.context;this._createAutocomplete()},_getMinLengthBeforeSearch:function(){var aj=this._config.minLengthBeforeAutocomplete;if(typeof aj==="undefined"){aj=2}return aj},_createAutocomplete:function(){this.autoCompleteControl=new C({disabled:true,cid:this.cid,placeholder:this._config.placeHolder||"",minLengthBeforeSearch:this._getMinLengthBeforeSearch(),noResultsMessage:o.get("emxFoundation.Label.NoResultsFound"),datasets:[{configuration:{templateEngine:this._addAutoCompleteItemToContainer.bind(this),remoteSearchEngine:this._getAndSendAutoCompleteRequest.bind(this)}}]});this.autoCompleteControl.elements.input.addClassName("form-control")},_preventLabelDefault:function J(aj){aj.preventDefault();return false},render:function H(ak){var aj=d.clone(ak||{},false);this.removeAutoCompleteFromDOM();this.autoCompleteControl.setBoundingElement(aj.boundingElement);var al=this._parent.apply(this,arguments);this._postTreatmentObjectList();this._listenToSubModels();this.setDefaultImages();this.autoCompleteControl.enable();return al},_submodelCallback:function A(){this.render()},_listenToSubModels:function q(){this.stopListening(null,null,this._submodelCallback);var al=this.normalizedGet(this.model,this._config.name);if(!d.is(al,"array")){if(al){al=[al]}else{al=[]}}var am=al.length;for(var ak=0;ak<am;ak++){var aj=al[ak];if(aj&&aj.addEvent){this.listenTo(aj,"onChange",this._submodelCallback);this.listenTo(aj,"onViewAccessChanged",this._submodelCallback)}}},checkDialogDeactivation:function L(al,ak){if(al!==ak){var am=this;if(am){var aj=am.container.getElement("ul");if(aj){aj.toggleClassName("active",false);if(d.is(al.activationCallback,"function")){al.activationCallback(al.name,false)}}}}},_uploadToObjectList:function ab(){var ak=this;var al=this._config;var aj=d.clone(this.options||{},false);var am=this._options.DocumentManagement&&this._options.DocumentManagement.MSFDocumentClient;if(am&&am.isConnectedToMSFClient()){am.MSFUploadObjectList(al.name,ak);return}D.openFileExplorer({callback:function(ao){if(al.singleObjectOnly){if(d.is(ak.model.remove,"function")){var an=aj.singleObjectRemove;aj.singleObjectRemove=true;ak.model.remove(al.name,0,aj);aj.singleObjectRemove=an}}ak.model.add(al.name,ao,ak.options)},accept:al.accept})},_onClickCustomButton:function af(am){am.preventDefault&&am.preventDefault();var ak=d.Event.getElement(am);var ao=this._config;var aj=ak.getAttribute("data-custom-button-index");aj=parseInt(aj);var an=ao.customButtons;if(an){var al=an[aj];al.callback.call(this,an)}},handleDragEnter:function Q(ak){var aj=d.Event.getElement(ak);aj.addClassName(v)},handleDragLeave:function X(ak){var aj=d.Event.getElement(ak);aj.removeClassName(v)},handleDragOver:function u(ak){if(ak.preventDefault){ak.preventDefault()}ak.dataTransfer.dropEffect="copy";var aj=d.Event.getElement(ak);aj.addClassName(v);return false},handleDrop:function N(al){this.getElement(".object-list")&&this.getElement(".object-list").removeClassName(v);if(al.stopPropagation){al.stopPropagation()}if(al.preventDefault){al.preventDefault()}this.getElement("input")&&this.getElement("input").removeClassName(v);var am=this._config;var ak=d.clone(this._options||{},false);ak.config=am;ak.objectView=this;if(am.dropHandler){var aj=d.is(am.dropHandler,"function")?am.dropHandler:this.model.dropHandler;if(aj.call(this.model,al.dataTransfer,am,ak)){return false}}if(al.dataTransfer.files&&al.dataTransfer.files.length){return this._handleDroppedFiles(al.dataTransfer.files)}if(this.validateDroppedObjects(al.dataTransfer)){return false}return this.dropHandler(al.dataTransfer,am,ak)},dropHandler:function(ak){var aj=D.getDataTransferJSON(ak);if(aj){this.processDropData(aj)}return false},_handleDroppedFiles:function(ak){var al=d.clone(this._options||{},false);var at=this._config;if(at.allowFileManagement&&at.readWrite==="true"&&this.normalizedGet(this.model,"canEdit")){if(at.accept){var aj=at.accept.toLowerCase().split(",");var au=ak.length;var ar=[];for(var an=0;an<au;an++){var am=ak[an];var ao=am.name;var aq=ao.lastIndexOf(".");if(aq!==-1){var av=ao.substring(aq);if(aj.indexOf(av.toLowerCase())!==-1){ar.push(am)}}}ak=ar;if(!ar.length){return false}}if(at.singleObjectOnly){if(d.is(this.model.remove,"function")){var ap=al.singleObjectRemove;al.singleObjectRemove=true;this.model.remove(at.name,0,al);al.singleObjectRemove=ap}}al.fileDropped=true;this.model.add(at.name,ak,al);return false}else{!at.allowFileManagement&&D.displayError(o.get("E6WCommonUI.Error.DroppingFilesNotSupported"));return true}},validateDroppedObjects:function(ao){var an;var al=D.getDataTransferJSON(ao);var aj=al.data.items;for(var ak=0;ak<aj.length&&!an;ak++){var am=aj[ak];an=this.validateDroppedObject(am);an&&D.displayError(an)}return Boolean(an)},validateDroppedObject:function(aj){return e.validateDroppedObject(aj,this._config)},processDropData:function f(ax){var at=ax.data.items;var aq=at.length;var ap=this._config;var ar=false;for(var ao=0;ao<aq;ao++){var am=at[ao];var ak=am.displayName;var aw=this.normalizedGet(this.model,ap.name);if(d.is(this.model.preprocessPersonObject,"function")){this.model.preprocessPersonObject(am)}var al=d.clone(this._options||{},false);al.config=ap;al.dropObj=am;if(ap.singleObjectOnly&&aw&&d.is(aw,"array")&&aw.length>0){if(d.is(this.model.remove,"function")){var aj=al.singleObjectRemove;al.singleObjectRemove=true;this.model.remove(ap.name,0,al);al.singleObjectRemove=aj}}var av;if(d.is(this.model.add,"function")){av=this.model.add(ap.name,am.objectId,al)}if(av&&av.length>0){ar=true;var an=av[0];var au;if(ap.type==="person"){au="firstname"}else{au=this._config.attributeToDisplay}if(!this.normalizedGet(an,au)){this.normalizedSet(an,{name:au},ak)}}}if(ar){this.render()}},objectClick:function r(ak){var ao=d.Event.getElement(ak);var aA=this._config;if(ak.stopPropagation){ak.stopPropagation()}if(ak.preventDefault){ak.preventDefault()}ak.clickedOnObject=true;var ay=ao.getClosest("li");var au=ay.getAttribute("data-id");var aq;var av=aA.searchSource;var ar=this.normalizedGet(this.model,aA.name);if(!d.is(ar,"array")&&!(ar instanceof b)){ar=[ar]}var aj;if(ar&&ar.length>0){var am=ar.length;for(var az=0;az<am;az++){var ap=ar.at?ar.at(az):ar[az];var at=D.normalizedToJson(ap);if(d.is(at,"array")){var an=at.length;for(var ax=0;ax<an;ax++){if(at[ax].physicalId===au){at=at[ax];break}}}if(at.physicalId===au){aj=ap;break}}}if(!(aA.linkCallback&&aA.linkCallback(au,{model:aj}))){var aw=o.get("emxFoundation.Label.ObjectDetails");aw=aw.replace("%NAME%",ao.getText());var al={title:aw,source:av,tenant:aq,role:this.context,idcard_activated:true,select_result_max_idcard:true,default_search_criteria:"physicalid:"+au};this.search&&this.search.activate(al)}return true},_onKeyUp:function y(aj){if(aj.key==="Tab"){this._activateObjectField(aj)}},_activateObjectField:function R(al){al.preventDefault&&al.preventDefault();if(!al.clickedOnObject){var an=this._config;var am=this;var ak=am.getElement("ul");if((an.readWrite==="true"||an.readWrite===true)&&this.normalizedGet(this.model,"canEdit")){if(ak){ak.toggleClassName("active",true);if(d.is(an.activationCallback,"function")){an.activationCallback(an.name,true)}var aj=ak.getElement("input");if(aj){aj.focus()}}}}},handleDragEnd:function ac(ak){var aj=d.Event.getElement(ak);aj.removeClassName(v)},_postTreatmentObjectList:function g(aj){if(!aj){aj=this._config}if(aj.typeAheadCallback&&aj.readWrite){this._postTreatmentObjectListAutocomplete(aj)}this.postTreatmentObjectListClickHandlers(aj);if((aj.type==="object"||aj.type==="person")&&this.shouldDisableSearch()){var ak=this.getElement(".ds-group-add .btn");if(ak){ak.disabled=true}}},_onAddButtonClicked:function(am){if(am.stopPropagation){am.stopPropagation()}if(am.preventDefault){am.preventDefault()}if(D.widgetInPreviewMode(true)){return}var ak=this._config;var ao=this.getElement("input");var aq=ao.value.trim();var al=aq.split(",").map(function(au){return au.trim()});al=this.getFederatedQueryCriteria(al);var ap=ak.searchSource;var at=ap?ak.searchSourceTypes||ak.searchTypes:ak.searchTypes;var ar=ak.excludeSearchTypes;if(!at){if(ak.type==="person"){at="Person"}else{at=""}}var an=ak.searchTitle;if(!an){an=""}ao.value="";this._toggleSearchButton(ao);var aj={title:an,source:ap,role:this.context,types:at,multiSel:ak.singleObjectOnly!==true,default_search_criteria:al,excludedSearchTypes:ar,callback:this._searchCallback.bind(this)};this.search&&this.search.activate(aj);this.autoCompleteControl.reset()},getFederatedQueryCriteria:function(aj){var ak;if(aj.length>1){ak="("+aj.join(" OR ")+")"}else{ak=aj.length===0||aj[0].length===0?"":aj[0]+"*"}return ak},postTreatmentObjectListClickHandlers:function w(al){var ap=this;var am=this;if(d.is(this.model.add,"function")){var ak=am.getElement(".ds-group-add button");if(ak){ak.addEvent("click",this._onAddButtonClicked.bind(this))}}var aw;if(d.is(this.model.remove,"function")){var av=function(az,aA){aA.stopPropagation();var ay=d.clone(ap._options||{},false);ay.config=al;var aB=this.getAttribute("data-field-name");ap.model.remove(aB,az,ay)};var ar=am.getElements(".ds-group-remove");var ax=ar.length;for(var at=0;at<ax;at++){var ao=ar[at];aw=ao.getClosest("button");aw.addEvent("click",av.bind(ao,at))}}var an=am.getElements(".fonticon-download");var au=an.length;for(var aq=0;aq<au;aq++){var aj=an[aq];aw=aj.getClosest("button");aw.addEvent("click",this.objectClickDownload.bind(this));this._donwloadAddedCode(aj)}this._makeDraggableAndDroppable()},_donwloadAddedCode:Function.prototype,_makeDraggableAndDroppable:function G(){var aj=this.container.getElements('[draggable="true"]');this._makeDraggableAndDroppableUWA();for(var al=0;al<aj.length;al++){var ak=aj[al];if(ak){ak.addEvent("dragstart",this._dragHandler.bind(this,ak.getParent()))}}},_dragHandler:function t(aj,al){var ak=this.computeDragDataFromElement(aj);al.dataTransfer.effectAllowed="copy";al.dataTransfer.setData(n,JSON.stringify(ak));al.dataTransfer.setData("text",JSON.stringify(ak));D.extraDragForSwym(ak)},getModelFromCard:function(ao){var ak=ao.getClosest("li");var aj=ak.getAttribute("data-id");var an=this;var al=this.normalizedGet(this.model,this._config.name);var am=al;if(al.forEach){al.forEach(function(aq){var ap=an._normalizedGetPhysicalId(aq);if(ap===aj){am=aq}})}return am},_normalizedGetPhysicalId:function(ak){var aj=this.normalizedGet(ak,"physicalId");if(!aj){aj=D.normalizedToJson(ak).physicalId}return aj},computeDragDataFromElement:function P(am){var al=this.getModelFromCard(am);var ak;if(al.getTransferObject){ak=al.getTransferObject()}else{var aj=this.normalizedGet(al,"type")||this.normalizedGet(al,"busType");ak=D.getTransferObject({source:window.widget.getValue("appId")||"X3DCSMA_AP",envId:this.tenant||window.widget.getValue("x3dPlatformId"),contextId:this.context,objectId:this._normalizedGetPhysicalId(al),objectType:aj,objectType_Internal:aj,displayName:this.normalizedGet(al,this._config.attributeToDisplay)})}return ak},_makeDraggableAndDroppableUWA:function a(){if(this.dragControl){this.dragControl.destroy()}var ao=this;var ap=function(at){var au=at.target.getParent(".draggable-item");at.elemToClone=au;var aA=p(au);var av=ao._config;var aD=av._htmlWrapper;if(!aD){var aB=d.clone(av,false);aB.readWrite=false;delete aB.label;delete aB.W;var aw={};aw[av.name]={};aD=ao.template({data:aw,config:aB});av._htmlWrapper=aD}var ax=aA.clone();ax.find("button").remove();ax.width(aA.width());ax.height(aA.height());var ar=d.createElement("div");ar.setStyles({position:"absolute"});ar.toggleClassName("draggable-helper",true);ar.setHTML(aD);var az=ar.getElement("ul");az.empty();ax.appendTo(az);ar.style.zIndex=100;var aC=av.appendTo?av.appendTo:"body";var ay=au.getClosest(aC);ar.inject(ay);return ar};var am=function(ar){if(ar.currentEvent instanceof MouseEvent){return false}var au=ar.target.getParent(".draggable-item");au.toggleClassName("ui-being-dragged",true);var at=ao.computeDragDataFromElement(au);p.data(au,ag.DRAG_DATA_TAG,at);return true};var al=function(ar){var at=ar.elemToClone;at.toggleClassName("ui-being-dragged",false);at.toggleClassName("drag",false);ar.handles.destroy()};this.dragControl=new ae.Move({container:widget.body,root:this.container,zoneCss:".drop-target",zones:function aj(){return widget.body.getElements(this.options.zoneCss)},delegate:".draggable-item *",centerHandles:true,handles:ap,start:am,stop:al,enter:function aq(at){var ar=at.zone;if(at.accept()){ar.toggleClassName(v,true)}},leave:function an(at){var ar=at.zone;ar.toggleClassName(v,false)},drop:function ak(at){var ar=at.zone;ar.toggleClassName(v,false);if(at.accept()){var aw=at.target.getParent(".draggable-item");var av=p.data(aw).dragDataTransfer;av.getData=function(){return this};var au=new window.Event("drop",{bubbles:true});au.dataTransfer=av;ar.dispatchEvent(au)}}});this.dragControl.accept=function(){return this.target.getClosest(this.options.zoneCss)!==this.zone}},objectClickDownload:function F(am,al){var ak=d.Event.getElement(am);if(am.stopPropagation){am.stopPropagation()}if(am.preventDefault){am.preventDefault()}am.clickedOnObject=true;var aj=ak.getClosest("li");var an=aj.getAttribute("data-id");this.download({pid:an,tenant:al&&this.normalizedGet(al,"dscom:Tenant"),serviceId:al&&this.normalizedGet(al,"dscom:ServiceHosting")});return true},download:function l(ak){var al;ak=ak||{};var am=this;var aj=d.clone(ak,false);aj.autoDownload=true;aj.csrf=this.model.csrf;aj.onFailure=function(){am._parentView._displayMessage({msg:o.get("emxFoundation.Alert.PopupBlocker"),msgType:"error"});ak.onFailure&&ak.onFailure()};if(this._options.DocumentManagement){al=this._options.DocumentManagement.downloadDocument(aj.pid,undefined,Boolean(ak.checkout),aj)}return al},processAutoCompleteData:function(aj){return aj},_addAutoCompleteItemToContainer:function(al,am,aj){var ak=this.processAutoCompleteData(aj);var an=d.createElement("span",{"class":"thumbnail profile-image"});ak.image&&d.createElement("img",{draggable:"false",src:ak.image,title:ak.label,"data-actualvalue":ak.value,events:{contextmenu:function(){return false}}}).inject(an);an.inject(al);d.createElement("span",{text:ak.label}).inject(al)},_getExistingIds:function aa(){var aj={};var ak=this.getExistingObjs(this._config.name);if(ak){if(!Array.isArray(ak)){ak=[ak]}ak.forEach(function(al){aj[al.id]=true})}return aj},_getAndSendAutoCompleteRequest:function ah(ak,al){var aj=this;return new K(function(ao){var an=function(aq){var ar={};ar.dataset=ak;var ap=[];if(d.is(aq,"array")){aq.forEach(function(at){at.handler=aj.onAutocompleteSelect.bind(aj,aj._config,at);ap.push(at)})}ar.matchingItems=ap;ao(ar)};var am=ag.filter.bind(undefined,an,aj._getExistingIds());if(aj._previousTypeaheadRequest&&aj._previousTypeaheadRequest.cancel){aj._previousTypeaheadRequest.cancel()}aj._previousTypeaheadRequest=aj._config.typeAheadCallback(aj._config,al,am,{model:aj.model})})},removeAutoCompleteFromDOM:function k(){this.autoCompleteControl&&this.autoCompleteControl.remove()},_postTreatmentObjectListAutocomplete:function I(){var ak=this.normalizedGet(this.model,"canEdit")&&this._config.readWrite;if(ak){var aj=this.getElement("input");aj&&aj.remove();this.autoCompleteControl.inject(this.getElement("li.chooser"),"top")}},_searchCallback:function Y(aq){var ar=[];var ao=aq.length;for(var al=0;al<ao;al++){var am=aq[al];if(am.id){D.enrichObjectFromSearch(am);ar.push(am.id)}else{ar.push(am)}}var ap=ar.join(",");var ak=d.clone(this._options||{},false);ak.detailedObjects=aq;ak.config=this._config;if(this._config.singleObjectOnly&&aq&&aq.length>0){var an=this.normalizedGet(this.model,this._config.name);if(d.is(this.model.remove,"function")&&an&&an.length){var aj=ak.singleObjectRemove;ak.singleObjectRemove=true;this.model.remove(this._config.name,0,ak);ak.singleObjectRemove=aj}ap=ar[0];ak.detailedObjects=[aq[0]]}this.addToModelFromSearch(this._config.name,ap,ak)},addToModelFromSearch:function S(){this.model.add.apply(this.model,arguments)},destroy:function V(){this.search&&this.search.destroy();delete this.search;this.autoCompleteControl.disable();document.removeEventListener("click",this.autoCompleteControl.events.document.click,true);this.autoCompleteControl.destroy();delete this.autoCompleteControl;this._parent()},_keyUpInputAddObject:function W(ak){if(ak.key==="Enter"){var aj=d.Event.getElement(ak);var al=aj.getClosest(".form-group");var am=al.getElement(".ds-group-add .btn");if(!am.disabled){am.click()}}},_enableDisableSearch:function O(ak){var aj=d.Event.getElement(ak);this._toggleSearchButton(aj)},_toggleSearchButton:function c(){var ak=this.getElement(".ds-group-add .btn");if(ak){var aj=this.getElement("input").value;if(aj.length>0){ak.disabled=false}else{if(this.shouldDisableSearch()){ak.disabled=true}}}},onAutocompleteSelect:function Z(ak,al){var aj=d.clone(al,false);aj.id=al.value||al.id;delete aj.value;this._searchCallback([aj]);this.autoCompleteControl.reset()},getExistingObjs:function E(aj){return this.normalizedGet(this.model,aj)},showAutoComplete:function U(){var aj=this.getElement("input");this.autoCompleteControl&&this.autoCompleteControl.getSuggestions(aj.value)},_onInputClicked:function j(){var aj=this.getElement("input");if(aj.value.length>=this._getMinLengthBeforeSearch()){this.showAutoComplete()}},shouldDisableSearch:function(){return !this._config.searchTypes&&!this._config.searchSourceTypes},getCardById:function(aj){return this.container.getElement('li[data-id="'+aj+'"]')}});ag.filter=function(ak,aj,al){var am=al.filter(function(an){return !aj[an.value]});ak(am)};ag.prototype.compiledTemplate=ad;ag.DRAG_DATA_TAG="dragDataTransfer";ag.DROP_CLASS_NAME=v;return ag});define("DS/E6WCommonUI/Views/ObjectCardView",["UWA/Core","UWA/Class/Collection","DS/UIKIT/DropdownMenu","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/CompassUtil","DS/Handlebars/Handlebars","DS/UIKIT/Tooltip","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/FederatedSearchUtil","text!DS/E6WCommonUI/assets/templates/objectCard.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,f,a,o,l,m,c,j,b,d,g,k){var n=function(p){var q=k.get(p);return q};var i=c.compile(g);var h=o.extend({_uwaClassName:"ObjectCardView",domEvents:{"click li.object-card":"_onClickObjectField"},setup:function(){this._tooltips=[];this._parent.apply(this,arguments)},render:function(){this._parent.apply(this,arguments);var q=this;var r=this.getElements(".fonticon-down-open");var p=q.getElement(".btn.ds-group-plus");if(r.length===0&&p){p.toggleClassName("disabled",true)}r.forEach(function(s){q._tooltips.push(new j({target:s,body:n("E6WCommonUI.Label.Menu")}))});return this},_onClickObjectField:function(q){q.preventDefault&&q.preventDefault();if(!q.clickedOnObject){var p=e.Event.getElement(q);var r=p.getClosest("li");this.deactivateAllListElements(r);r&&r.addClassName("active");this.selectInCompass(p)}},selectInCompass:function(s){var p=this.getModelFromCard(s);var r=this.normalizedGet(p,"type");if(r&&r.indexOf("Person")===-1){var q=this.computeDragDataFromElement(s);m.openCompassWithModel(p,{transferObject:q})}},_dontActivateObjectField:function(){},checkDialogDeactivation:function(q,p){this._parent(q,p);if(q!==p){this.deactivateAllListElements()}},deactivateAllListElements:function(){var p=this.container.getElements("li");if(p){p.forEach(function(q){q.toggleClassName("active",false)})}},getActiveModel:function(r){var q=this.normalizedGet(this.model,this._config.name);var p;var s=this;if(q&&(e.is(q,"array")||q instanceof e.Class.Collection)){q.some(function(t){if(r===s.normalizedGet(t,"physicalId")){p=t;return true}return false})}else{if(r===this.normalizedGet(q,"physicalId")){p=q}}return p},postTreatmentObjectListClickHandlers:function(s){var v=this;this._parent(s);var t=this;var x;var w=function(C,D){D.stopPropagation();var B=e.Event.getElement(D);var y=B.getClosest("li");var E=y.getAttribute("data-id");var A=e.clone(v._options||{},false);A.config=s;var z={target:C.target,options:A,event:D,index:C.selectionIndex,model:v.getActiveModel(E)};v.createMenuButtons(z);v.dropdownMenu.show()};var u=t.getElements(".fonticon-down-open");var p=u.length;for(var r=0;r<p;r++){var q=u[r];x=q.getClosest("button");x.addEvent("click",w.bind(q,{selectionIndex:r,target:x}))}},createMenuButtons:function(p){this.checkDialogDeactivation();var r=this;var q;if(p.model){var s=p.model.get("type")||p.model.get("busType");q=(s==="Document"||s==="DriveFile")&&this._options.DocumentManagement;q=this.normalizedGet(p.model,"hasfiles");q=q===true||q==="TRUE"}r.dropdownMenu=new a({target:p.target,items:(this._config.getDropDownMenuItems&&this._config.getDropDownMenuItems.call(this,q,p))||this.getDropDownMenuItems(q,p),events:{onClickOutside:function(){this.menus&&this.destroy();delete r.dropdownMenu},onHide:function(){this.menus&&this.destroy();delete r.dropdownMenu}},currentModel:this.normalizedGet(this.model,this._config.name)})},getDropDownMenuItems:function(v,t){var q=e.clone(t||{},false);var u=this;var r=[this.getPropertiesButton(q),{text:n("E6WCommonUI.Label.Download"),fonticon:"download",className:!v?"disabled":null,handler:function(){u.objectClickDownload(q.event,q.model)}},this.getRemoveItemButton(q)];var s=q.model&&this.normalizedGet(q.model,"type");if(s&&s.indexOf("Person")!==-1){r.splice(1,1)}if(e.is(this.model.updateDocument,"function")){var p=this._getUpdateButton(q);r.splice(2,0,p)}return r},_getUpdateButton:function(r){var s=this;var p=r.model;var q=this.normalizedGet(p,"type");var t=(q==="Document"||q==="DriveFile");return{text:n("E6WCommonUI.Label.Update"),fonticon:"upload",className:!t?"disabled":null,handler:function(){l.openFileExplorer({callback:function(u){l.updateDocumentConfirmation(u,p,s.model.updateDocument)}})}}},getRemoveItemButton:function(p){var r=this;var q=this._config.readWrite;if(!q){q=false}return{text:n("E6WCommonUI.Label.Remove"),name:"remove-button",fonticon:"cancel",className:!r.normalizedGet(r.model,"canEdit")||!q?"disabled":null,handler:function(){r.model.remove(r._config.name,p.index,p.options)}}},getPropertiesButton:function(q){var r=this;var p={text:n("E6WCommonUI.Label.Properties"),fonticon:"attributes",handler:function(){r.objectClick(q.event)},name:"propertiesButton"};return p},destroy:function(){this._tooltips.forEach(function(p){p.destroy()});this._tooltips=[];this._parent.apply(this,arguments)},getFederatedQueryCriteria:function(p){if(widget.getValue("oldSearch")){return this._parent.apply(this,arguments)}else{return d.getFederatedQueryCriteria({criteria:p,fieldType:this._config.type})}}});h.prototype.compiledTemplate=i;return h});define("DS/E6WCommonUI/Views/DateView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/UIKIT/Input/Date","DS/ENO6WPlugins/jQuery_3.3.1","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/date.html.handlebars"],function(d,b,f,h,i,a,g){var e=b.compile(g);var c=a.extend({_uwaClassName:"E6WCommonUIDateView",tagName:"div",name:"E6WCommonUI.DateView",domEvents:{'change input.data-entry[type="date"]':"_dateDataEntry"},render:function(){var j=this._parent.apply(this,arguments);if(!(d.Utils.Client.Platform.ios||d.Utils.Client.Platform.android)){this._setupUIKITDatePickers()}return j},_setupUIKITDatePickers:function(){var s=this.getElements("input[type=date]");var j=s.length;var m=this._dateDataEntry.bind(this);for(var p=0;p<j;p++){var o=s[p];var k=this._config;var r=k.name;var q=o.getParent();if(k.type==="startStop"&&k.endDateAttribute&&q.hasClassName("stop")){r=k.endDateAttribute}var l=this.normalizedGet(this.model,r);if(l&&l.actualValue){l=l.actualValue}var t={events:{onChange:m},allowTextEdition:(k.allowTextEdition===undefined?true:k.allowTextEdition)};if(k.min instanceof Date){t.min=new Date(k.min.getTime())}if(k.max instanceof Date){t.max=new Date(k.max.getTime())}if(d.is(l,"string")&&l){t.value=new Date(parseInt(l,10))}else{if(l instanceof Date){t.value=isNaN(l)?"":l}}if(!this._childrenViews){this._childrenViews=[]}var n=new h(t);this.addChildView(n);i.data(q,"dateInput",n);o.remove();n.inject(q)}},_dateDataEntry:function(o){var j=d.Event.getElement(o);var m=this._config;if(m){var p;if(o.firedBy){p=o.firedBy.getDate()&&o.firedBy.getDate().getTime()}else{p=j.value;if(j.value!==""){var n=new Date(j.value);var k=new Date(n.getTime()+n.getTimezoneOffset()*60000);p=k.getTime()}}var l=m.name;if(m.type==="startStop"&&m.endDateAttribute&&j.getParent().hasClassName("stop")){l=m.endDateAttribute}var q=d.clone(this._config,false);q.name=l;this.normalizedSet(this.model,q,{actualValue:p})}}});c.prototype.compiledTemplate=e;return c});define("DS/E6WCommonUI/Views/TextAreaView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/textarea.html.handlebars"],function(f,b,i,a,j){var h=0;var g=b.compile(j);var e=".height-calculator";var c="showing-more";var k=".content";var d=a.extend({_uwaClassName:"E6WCommonUITextAreaView",tagName:"div",name:"E6WCommonUI.TextAreaView",domEvents:{"click .show-more":"_textAreaShowMore","click .show-less":"_textAreaShowLess","input textarea.content ":"_inputDataEntry"},addModelEvents:function(){this._parent.apply(this,arguments);this.model.addEvent&&this.listenTo(this.model,"onChange:"+this._config.name,this._postTreatmentTextArea)},render:function(){this.removeEventListener();var l=this._parent.apply(this,arguments);this.addEventListener();this.container.toggleClassName("hide-links",true);return l},refreshView:function(){this._parent.apply(this,arguments);this._postTreatmentTextArea()},destroy:function(){this.removeEventListener();this._parent.apply(this,arguments)},addEventListener:function(){var l=this.container.getElement("textarea,input");if(l){var m=this._config.required;if(m){this._blurListener=this._onBlurInputDataEntry.bind(this);l.addEventListener("blur",this._blurListener)}}},removeEventListener:function(){var l=this.container.getElement("textarea,input");if(l){l.removeEventListener("blur",this._blurListener)}},_getInputValue:function(){var l;if(this._config.readWrite&&this.normalizedGet(this.model,"canEdit")){l=this.getElement(".content")}else{l=this.getElement(".read-only")}var m=l.value;if(this._config.removeCarriageReturns){m=m.replace(/\n/g," ");l.value=m}return m},_inputDataEntry:function(){this.normalizedSet(this.model,this._config,this._getInputValue());this._postTreatmentTextArea(this._config)},_onBlurInputDataEntry:function(){var m=this._getInputValue().trim();this.normalizedSet(this.model,this._config,m);var l=this.model.validationError&&this.model.validationError.fields;if(!l&&this._config.required){this.container.toggleClassName("has-error",!m||m.length===0)}},_textAreaShowMore:function(m){var l=f.Event.getElement(m);var n=l.getClosest(".form-group");n.toggleClassName(c,true)},_textAreaShowLess:function(m){var l=f.Event.getElement(m);var n=l.getClosest(".form-group");n.toggleClassName(c,false);this._postTreatmentTextArea()},_postTreatmentTextArea:function(){var l=this._config;var q;if(l.type==="text"){q=true}var p=this.getContentElement();if(!p){return}var n=this.getElement("style");if(n){var s="";var o="";var r="";try{if(!h){h=this.getLineHeight()}if(q){p.style.transition="none";p.style.height=h+"px"}this._viewAllHeight=this.getViewAllHeight();var m=this.getDesiredHeight();if(l.type==="textarea"||l.type==="RichText"){if(this._viewAllHeight<=m){this._viewAllHeight=m}this.container.toggleClassName("hide-links",isNaN(this._viewAllHeight)||isNaN(m)||this._viewAllHeight<=m)}s=this.getRegularStyle();o=this.getFocusStyle();r=this.getShowingMoreStyle();n.setHTML(s+o+r)}finally{if(q){p.style.height="";window.requestAnimationFrame(function(){p.style.transition=""})}}}},getContentElement:function(){return this.getElement(k)},getHeightCalculatorElement:function(){return this.getElement(e)},getSelectorBase:function(){return"#"+this._config.type+"Property_"+this.cid},getSelector:function(){return this.getSelectorBase()+" "+k},getSelectorFocus:function(){return this.getSelector()+":focus"},getLineHeight:function(){var l=this.getContentElement();return parseInt(l.getStyle("lineHeight"),10)},getDesiredHeight:function(){return this._config.numberOfDisplayLines*h},getFocusDesiredHeight:function(){return this._config.numberOfEditableLines*h},getShowingMoreStyle:function(){var l="#"+this._config.type+"Property_"+this.cid;return l+".showing-more "+k+this.getViewAllTextStyle()},getViewAllTextStyle:function(){return"{\n height:"+this._viewAllHeight+"px;\n line-height:"+h+"px;}"},getRegularStyle:function(){var n="";var m=this.getSelector();if(this._config.type==="text"){n=m+this.getViewAllTextStyle()}else{var l=this.getDesiredHeight();if(!isNaN(l)){n=m+" { \n height:"+l+"px;\n line-height:"+h+"px; \n}\n"}}return n},getFocusStyle:function(){var l="";var n=this.getSelectorFocus();var m=this.getFocusDesiredHeight();if(!isNaN(m)){l=n+" { \n height:"+m+"px;\r }\n"}return l},getViewAllHeight:function(){var n=this.getContentElement();var l=this.getHeightCalculatorElement();var m=h;if(l){if(n.tagName==="SPAN"){l.textContent=n.textContent}else{l.textContent=this.getTextValue()}if(l.style.lineHeight!==h+"px"){l.style.lineHeight=h+"px"}m=l.scrollHeight}return m},getTextValue:function(){return this.getContentElement().value}});d.prototype.compiledTemplate=g;return d});define("DS/E6WCommonUI/Views/NumberView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/number.html.handlebars"],function(g,e,d,a,c){var b=e.compile(c);var f=a.extend({_uwaClassName:"E6WCommonUINumberView",tagName:"div",name:"E6WCommonUI.NumberView",domEvents:{'input input.data-entry[type="number-as-text"]':"_numberDataEntry"},render:function(){var h=this._parent.apply(this,arguments);this._postTreatmentNumber();return h},_numberDataEntry:function(i){var p=g.Event.getElement(i);var k=this._config;var n=p.value;var l=new RegExp("^-?[0-9]*[,.]?[0-9]*$");var o=k.name;if(k.toleranceName&&p.getClosest(".field-group").hasClassName("tolerance")){o=k.toleranceName}var h=this.normalizedGet(this.model,o);var m=l.test(n);if(!m){p.value=h;return}if(n.indexOf(",")!==-1){n=n.replace(/,/g,".")}var j=parseFloat(n,10);var q=parseFloat(k.minimumValue,10);if(!isNaN(q)&&!isNaN(j)&&j<q){j=h;p.value=j}n=this._getActualValueBasedOnNumValue(j);if(!isNaN(n)){this.normalizedSet(this.model,{name:o,validate:k.validate},n)}},_getActualValueBasedOnNumValue:function(h){return String(h)},_postTreatmentNumber:function(){var i=this._config;var l=this;var h=l.getElement("input");var j=this.normalizedGet(this.model,i.name);var k;if(j!==undefined&&h){k=(j.actualValue||j.actualValue===0)?j.actualValue:j;k=parseFloat(k);k=k.toLocaleString(widget.lang,{useGrouping:false});h.value=k}}});f.prototype.compiledTemplate=b;return f});define("DS/E6WCommonUI/Views/RangeView",["UWA/Core","DS/Handlebars/Handlebars","DS/Controls/Gauge","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/range.html.handlebars"],function(h,g,c,f,a,d){var b=g.compile(d);var e=a.extend({_uwaClassName:"E6WCommonUIRangeView",tagName:"div",name:"E6WCommonUI.RangeView",domEvents:{},render:function(){var i=this._parent.apply(this,arguments);this._postTreatmentRange();return i},_rangeDataEntry:function(){if(!this.parent.dontUpdateModel){var i=this.parent._config;var j=this.getValue();this.parent.normalizedSet(this.parent.model,i,j)}},destroy:function(){this._parent.apply(this,arguments);delete this._gauge},_postTreatmentRange:function(){var i=this._config;var m=this.normalizedGet(this.model,i.name);var j;var k="[data-field-name='"+i.name+"'] .range";j=this.getElement(k);var l;var p={minValue:i.minimumValue||0,maxValue:i.maximumValue||100,stepValue:i.step||0.1,dynamicGraduations:false,graduationsLabel:false,dynamicGaugeColor:false,graduations:2,value:m};if(i.percents){p.displayFunction=this._percentDisplay}l=new c(p);var n=l.destroy;l.destroy=function(){delete this.elements.scales;delete this.elements.cursors;if(this._parentView){this._parentView.removeChildView(this)}n.apply(this,arguments)};l.parent=this;this.listenTo(l,"change",this._rangeDataEntry);this.addChildView(l);this._gauge&&this._gauge.destroy();this._gauge=l;Object.defineProperty(i,"control",{value:l,enumerable:false,configurable:true,writable:true});l.inject(j);var o=(i.readWrite&&this.normalizedGet(this.model,"canEdit"));if(!o){l.disable()}},_percentDisplay:function(i){return i.toString()+"%"}});e.prototype.compiledTemplate=b;return e});define("DS/E6WCommonUI/Views/UomView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/NumberView","text!DS/E6WCommonUI/assets/templates/uom.html.handlebars"],function(g,e,d,f,c){var a=e.compile(c);var b=f.extend({_uwaClassName:"E6WCommonUIUomView",tagName:"div",name:"E6WCommonUI.UomView",domEvents:{"change select.ddv-uom":"_uomDataEntry"},_uomDataEntry:function(k){var h=g.Event.getElement(k);var i=h.getClosest(".form-group");h=i.getElement("input");this._numberDataEntry({target:h});if(this._config.unitAttribute){var j=this.getElement("select.ddv-uom");var l=j.selectedIndex;this.normalizedSet(this.model,{name:this._config.unitAttribute,validate:this._config.validate},l)}},_getActualValueBasedOnNumValue:function(i){if(!this._config.unitAttribute){var j=this.getElement("select.ddv-uom");var k=j.selectedIndex;var h=this._config.conversionTable[k];return String(i/h)}else{return this._parent.apply(this,arguments)}},_postTreatmentNumber:function(){this._parent.apply(this,arguments);if(this._config.unitAttribute){var i=this.normalizedGet(this.model,this._config.unitAttribute);if(i>=0&&i<this._config.uomValues.length){var k=this.getElement("select.ddv-uom");k&&(k.selectedIndex=i)}var h=this.getElement("span.read-only");if(h){var j=this.normalizedGet(this.model,this._config.name);j=j&&parseFloat(j)!==0?j:"--";h.textContent=j+"\u00A0"+this._config.uomValues[i]}}}});b.prototype.compiledTemplate=a;return b});define("DS/E6WCommonUI/Views/SelectView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/RDFFoundation/RDFUtils","text!DS/E6WCommonUI/assets/templates/select.html.handlebars"],function(h,g,f,b,a,e){var c=g.compile(e);var d=b.extend({_uwaClassName:"E6WCommonUISelectView",tagName:"div",name:"E6WCommonUI.SelectView",domEvents:{"change select.data-entry":"_selectDataEntry"},setup:function(){this._parent.apply(this,arguments);if(h.is(this._config.values,"function")){this._valuesFunc=this._config.values;this._config.values=this._valuesFunc();if(this._valuesFunc.dispatchEvent){this.listenTo(this._valuesFunc,"onChange",function(){this._updateValues();this.setConfiguredTemplate();this.render()})}}},render:function(){var i=this._parent.apply(this,arguments);this._postTreatmentSelect();this._selectElement=this.getElement("select");return i},_selectDataEntry:function(){var i=this._config;var k=this._selectElement.value;var j=i.values.detect(function(l){return l.actualValue===k});this.normalizedSet(this.model,i,j)},_postTreatmentSelect:function(){var q=this._config;var n=this.normalizedGet(this.model,q.name);if(q.isObject){n=n&&n.id}if(q.readWrite&&this.normalizedGet(this.model,"canEdit")){var o=(n&&n.actualValue)||n;var m=this.getElement("select");m.value=o}else{if(n){var i=(q.values&&q.values.length)||0;var k=(n&&n.displayValue)||n;for(var j=0;j<i;j++){var p=q.values[j];if(p.actualValue===n){k=p.displayValue;break}}var l=this.getElement("span");l.setText(k)}}},_updateValues:function(){this._valuesFunc&&(this._config.values=this._valuesFunc())}});d.prototype.compiledTemplate=c;return d});define("DS/E6WCommonUI/Views/PersonView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/UIHelper","text!DS/E6WCommonUI/assets/templates/person.html.handlebars"],function(h,g,d,f,c,e){var a=g.compile(e);var b=d.extend({_uwaClassName:"E6WCommonUIPersonView",tagName:"div",name:"E6WCommonUI.PersonView",init:function(i){this._dropTypes=h.clone(i&&i.config&&i.config.dropTypes||{},false);this._dropTypes["3dspace"]=this._dropTypes["3dspace"]||[];this._dropTypes.swym=this._dropTypes.swym||[];this._dropTypes["3dspace"]=this._dropTypes["3dspace"].concat("Person");this._dropTypes.swym=this._dropTypes.swym.concat("pno:Person");this._parent(i)},processAutoCompleteData:function(i){var j=h.clone(i,false);if(!j.image&&j.name){j.image=c.userPictureURL(j.name)}return j},validateDroppedObject:function(i){return f.validateDroppedObject(i,h.extend(this._config,{dropTypes:this._dropTypes}))}});b.prototype.compiledTemplate=a;return b});define("DS/E6WCommonUI/Views/StartStopView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DateView","text!DS/E6WCommonUI/assets/templates/startstop.html.handlebars"],function(g,f,d,b,c){var a=f.compile(c);var e=b.extend({_uwaClassName:"E6WCommonUIStartStopView",tagName:"div",name:"E6WCommonUI.StartStopView",_highlightValidationErrors:function(){if(this.model&&this.model.validationError&&this.model.validationError.fields){var l=this._config;var h=false;var i=this.container;var m=l.name;if(this.model.validationError.fields.indexOf(m)!==-1){h=true}var k=i&&i.getElement(".start");k&&k.toggleClassName("has-error",h);h=false;m=l.endDateAttribute;if(this.model.validationError.fields.indexOf(m)!==-1){h=true}var j=i&&i.getElement(".stop");j&&j.toggleClassName("has-error",h)}},template:function(){var h=arguments[0].data;if(h&&h.canEdit===true){this.setEditFlagOnFields(h)}return this._parent.apply(this,arguments)},setEditFlagOnFields:function(i){var h=true;if(this._config.hasOwnProperty("canEditStartDate")){h=g.is(this._config.canEditStartDate,"function")?this._config.canEditStartDate(this.model):this._config.canEditStartDate}i.canEditStartDate=h;h=true;if(this._config.hasOwnProperty("canEditEndDate")){h=g.is(this._config.canEditEndDate,"function")?this._config.canEditEndDate(this.model):this._config.canEditEndDate}i.canEditEndDate=h}});e.prototype.compiledTemplate=a;return e});define("DS/E6WCommonUI/Views/TextView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/TextAreaView","text!DS/E6WCommonUI/assets/templates/text.html.handlebars"],function(g,f,e,d,c){var a=f.compile(c);var b=d.extend({_uwaClassName:"E6WCommonUITextView",tagName:"div",name:"E6WCommonUI.TextView",domEvents:{'input input.data-entry[type="text"]':"_inputDataEntry"}});b.prototype.compiledTemplate=a;return b});define("DS/E6WCommonUI/Views/CheckBoxView",["UWA/Core","DS/Handlebars/Handlebars","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/checkbox.html.handlebars"],function(g,f,d,a,c){var b=f.compile(c);var e=a.extend({_uwaClassName:"E6WCommonUICheckBoxView",tagName:"div",name:"E6WCommonUI.CheckBoxView",domEvents:{'change input.data-entry[type="checkbox"]':"_checkBoxDataEntry"},_checkBoxDataEntry:function(j){var h=g.Event.getElement(j);var i=this._config;var k=(String(h.checked)).toUpperCase();this.normalizedSet(this.model,i,k)}});e.prototype.compiledTemplate=b;return e});define("DS/E6WCommonUI/Views/DetailsDisplayView",["UWA/Core","UWA/Utils","UWA/Event","UWA/Class/Model","UWA/Class/Events","UWA/Controls/Drag","DS/Handlebars/Handlebars","DS/ENO6WPlugins/jQuery_3.3.1","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/TextView","DS/E6WCommonUI/Views/TextAreaView","DS/E6WCommonUI/Views/SelectView","DS/E6WCommonUI/Views/CheckBoxView","DS/E6WCommonUI/Views/DateView","DS/E6WCommonUI/Views/NumberView","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/Views/PersonView","DS/E6WCommonUI/Views/RangeView","DS/E6WCommonUI/Views/StartStopView","DS/E6WCommonUI/Views/UomView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/meta.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","css!DS/E6WCommonUI/E6WCommonUI","css!DS/UIKIT/UIKIT"],function(g,b,D,o,u,a,i,q,p,r,m,j,e,s,f,h,t,n,y,w,l,z,B,A,x){var v=p.extend({_uwaClassName:"DetailsDisplayView",getHtmlFromTemplate:i.compile(A),className:"ds-dialog ds-detail-display ddv-view",id:function(){return"detailDisplayView"+this.cid},domEvents:{"click .form-section-title":"_showGroupProperties"},i18n:function(E,F){return F||E},_displayMessage:function(G){if(this._options.displayMessage){this._options.displayMessage.apply(this,arguments)}else{var F={message:G.msg,className:G.msgType};var E=z.displayMessage(F);if(!E){z.initializeAlert(this.container);z.displayMessage(F)}}},setup:function d(F){var E=g.clone(F||{},false);this._options=E;this._parent.apply(this,arguments);var G=this;q("body").on("click.closeListInputFields",function(L){if(G._config){var K=g.Event.getElement(L);var N=G._getConfigFromElement(K);var M=G._config.length;for(var I=0;I<M;I++){var J=G._config[I];switch(J.type){case"object":case"person":var H=G._getChildViewBasedOnConfig(J);H.checkDialogDeactivation(J,N);break;default:break}}}})},getChildViewBasedOnConfig:function(F){var I=this._childrenViews;var H;for(var G=0;G<I.length;G++){var E=I[G];if(E._config){if(E._config.type===F.type&&E._config.name===F.name){H=E;break}}}return H},_getChildViewBasedOnConfig:function(E){return this._configMap.get(E)},_resizeHandler:function(){var E=this;var F=function(){var J=E.container.clientWidth;var M=E._config.length;var I=J!==0&&J!==E.previousResizeWidth;if(I){E.previousResizeWidth=J}for(var G=0;G<M;G++){var H=E._config[G];switch(H.type){case"text":if(I&&H.readWrite==="true"&&B.prototype.normalizedGet(E.model,"canEdit")){var L=E._getChildViewBasedOnConfig(H);L._postTreatmentTextArea()}break;case"textarea":if(I){var K=E._getChildViewBasedOnConfig(H);K._postTreatmentTextArea()}break;default:break}}};F()},_dataForRenderingWithWhiteListAttributes:function(){var G=[];var F={};this._childrenViews.forEach(function(J){var I=J.getDataOptions();var K=G[I.level];if(!K){K=G[I.level]={}}I.attributes.forEach(function(L){K[L]=true})});for(var H=0;H<G.length;H++){var E=G[H];E&&g.extend(F,z.normalizedToJson(this.model,{level:H,attributes:Object.keys(E)}))}return F},_setChildViews:function(H){var K=this._childrenViews;if(K){var J=this._dataForRenderingWithWhiteListAttributes();for(var I=0;I<K.length;I++){var E=K[I];var F=E._config;if(!E.model){E.model=this.model}var G={data:J};g.merge(G,H);E.render(G);this.injectFieldViewForConfig(F,E)}}},injectFieldViewForConfig:function(E,F){var H=E.group?E.group.actualValue||E.group:undefined;if(H){F.inject(this.container.getElement("#_"+this.cid+this.groupMap[H].actualValue+" .form-section-body"))}else{var G=this.container.getElement(".form-section");if(G){F.inject(this.container.getElement(".form-section"),"before")}else{F.inject(this.container.getElement(".form.form-vertical"))}}},_template:function c(H){for(var F=0;F<this._config.length;F++){var E=this._config[F];if(E.required){H.required=true;H.requiredLegend=x.get("emxFoundation.Label.RequiredFieldLegend");break}}var I=Object.keys(this.groupMap);if(I.length>0){H.groupNames=this.groupMap;H.viewid="_"+this.cid}var G=this.getHtmlFromTemplate(H);return G},_filterConfigIntoGroups:function(){var G=this._config;var J={};for(var F=0;F<G.length;F++){var E=G[F];var I=E.group?E.group.actualValue||E.group:undefined;if(I){var H=J[I];if(!H){J[I]=[E];J[I].displayValue=I;J[I].actualValue="G"+F}else{if(I){H.push(E)}}}}return J},render:function k(F){var G;if(!this._config){return this}G=this.getElements(".accordion.expanded").map(function(H){return H.id});var E={};E.openedGroups=G;this.container.setHTML(this._template(E));this._setChildViews(F);this.dispatchEvent("onFinishRender");delete this.previousResizeWidth;if(this.container.isInjected()){this._resizeHandler()}else{this.listenToOnce(this,"onPostInject",this._resizeHandler)}this._toggleGroups(G,true);return this},setConfig:function C(G){this._config=G.map(function(I){return g.clone(I,false)});this.groupMap=this._filterConfigIntoGroups();delete G.options;this.cleanUpChildren();for(var H=0;H<this._config.length;H++){var E=this._config[H];E.index=H;var F=g.clone(this._options||{},false);g.extend(F,{config:E,model:this.model});this._createAndAddChildViews(E,F)}},cleanUpChildren:function(){this._configMap=new WeakMap();return this._parent.apply(this,arguments)},_createAndAddChildViews:function(F,H){var E;var G=g.clone(H||{},false);G.detailDisplayViewId="#"+(g.is(this.id,"function")?this.id():this.id);if(F.customView){E=new F.customView(G)}else{switch(F.type){case"text":E=new r(G);break;case"textarea":E=new m(G);break;case"select":E=new j(G);break;case"checkbox":E=new e(G);break;case"date":E=new s(G);break;case"number":E=new f(G);break;case"object":E=new h(G);break;case"person":E=new t(G);break;case"range":E=new n(G);break;case"startStop":E=new y(G);break;case"uom":E=new w(G);break;default:}}if(E){this._configMap.set(F,E);this.addChildView(E)}},resetModel:function(H,E,G){var F=g.clone(G||{},false);if(H!==this.model){var K=this.getElements(".accordion.expanded").map(function(L){return L.id});this._toggleGroups(K,E);var J=this._childrenViews;if(J){for(var I=0;I<J.length;I++){J[I].resetModel(H)}}this.model=H;!F.noRender&&this.render()}},_toggleGroups:function(G,E){var F=this;if(G){G.forEach(function(H){if(H&&H.length>0){var I=F.getElement("#"+H);I.toggleClassName("expanded",E)}})}},destroy:function(){delete this._configMap;this._parent();q("body").off("click.closeListInputFields")},_showGroupProperties:function(F){var E=g.Event.getElement(F);var G=g.extendElement(E.parentElement);G.toggleClassName("expanded")},_getConfigFromElement:function(G){var F;var H=G.getClosest(".ddv-field");if(H){var E=H.getAttribute("data-field-index");E=parseInt(E,10);F=this._config[E]}return F},isModelValid:function(){var F=this._config;for(var E=0;E<F.length;E++){if(F[E].required){if(!B.prototype.normalizedGet(this.model,F[E].name)){return false}}}return true},getFieldViewByName:function(F){var E;this._childrenViews.some(function(G){if(G._config.name===F){E=G;return true}return false});return E},dispatchScrollToElementEvent:function(E){this.dispatchEvent("scrollToElement",E)}});return v});