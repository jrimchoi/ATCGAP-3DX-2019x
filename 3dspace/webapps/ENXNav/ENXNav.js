/*!  COPYRIGHT DASSAULT SYSTEMES 2016   */
define("DS/ENXNav/commands/view/_xNavExpandAll",["DS/PADUtils/Utility"],function(b){var f=5;function d(j,h){var n=[];var g=j.length;var m=g-1;var k=[];for(var l=0;l<g;l++){k.push(j[l]);if(l!==0&&((l+1)%h===0||l===m)){n.push(k);k=[]}}return n}function a(g,i){var h;h=b.createStepper(i,g,function(k,j){j.expandMultiSelect({nodes2Expand:k,expandAll:true,tagger:false,callback:h,})},function(){var j=g.startTransaction("expandall");j.end()});h()}var c={execute:function(k){var h=k.model.getSelectedNodes();var g;var i=h.filter(function(m){return m.isVisible()}).sort(function(n,m){return n._getRowID()>m._getRowID()});var j=[];i.forEach(function(n){var m=-1;for(g=0;g<j.length&&m===-1;g++){m=n.getParents().indexOf(j[g])}if(m===-1){if(n.getChildren()){j.push(n)}}});if(j.length>1){var l=d(j,f);a(k.model,l)}else{if(j.length===1){j[0].expandAll()}}}};return c});define("DS/ENXNav/views/xNavResponsiveThumbnailsView",["UWA/Controls/Abstract","UWA/Core","UWA/Class/Options","UWA/Class/Events","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/ApplicationFrame/CommandsManager"],function(h,g,b,a,d,c){var f=h.extend(b,a,{name:"xNavResponsiveThumbnailView",defaultOptions:{grid:null,model:null},init:function(i){var l=this;this._parent(i);this.options=UWA.extend(this.options,i,true);this.elements.container=UWA.createElement("div",{"class":this.getClassNames()});var k=UWA.extend(i,{height:"inherit",displayedOptionalCellProperties:["contextualMenu","statusbarIcons","activeFlag"],useDragAndDrop:true,allowUnsafeHTMLContent:false},true);var j=this.options.grid=new d(k);if(i.onContextualEvent){j.onContextualEvent=i.onContextualEvent}this._originalApplyAttributes=j._applyAttributesOnCell.bind(j);j._applyAttributesOnCell=this._applyAttributesOnCell.bind(this);j.getContent().inject(this.elements.container);if(this.getOption("renderTo")&&i.isActiveView===true){this.elements.container.inject(this.getOption("renderTo"))}j.onCellsCopy(function(m){c.getCommand("Copy").begin()});j.onCellsPaste(function(m){c.getCommand("Paste").begin()});j.onCellsCut(function(m){c.getCommand("Cut").begin()});j.selectionBehavior=UWA.extend({enableFeedbackForActiveCell:true},j.selectionBehavior);j.onPostCellRequest(function(m){if(m.nodeModel&&m.nodeModel.options.isBeingCut){m.cellView.getContent().addClassName("pad-state-is-being-cut")}else{m.cellView.getContent().removeClassName("pad-state-is-being-cut")}})},setModel:function(i){this.options.model=i;this.options.grid.loadGridViewModel(i);this.elements.container.inject(this.getOption("renderTo"));this.options.isActiveView=true;this.options.grid.layout.invalidate();if(i.options.viewport.thumbnails!==null&&i.options.viewport.thumbnails!==undefined){this.options.grid.setScrollerPosition(i.options.viewport.thumbnails)}},unsetModel:function(){if(this.getScrollerPosition){this.options.model.options.viewport.thumbnails=this.getScrollerPosition()}this.getOption("renderTo").removeChild(this.elements.container);this.options.isActiveView=false;this.options.grid.unloadGridViewModel()},updateView:function(){this.options.grid.layout.invalidate({updateCellContent:true})},_applyAttributesOnCell:function(j){var i=j;if(j.nodeModel===undefined){i.nodeModel=this.options.grid._getModelAt(j.cellID);i.cellView=this.options.grid._getViewAt(j.cellID)}if(i.nodeModel.options.isBeingCut){i.cellView.getContent().addClassName("pad-state-is-being-cut")}else{i.cellView.getContent().removeClassName("pad-state-is-being-cut")}this._originalApplyAttributes(j)}});return f});define("DS/ENXNav/commands/view/_xNavCollapseAll",[],function(){var a={execute:function(b){require(["DS/Utilities/Data"],function(f){var d=b.model,c=d.getSelectedNodes();d.prepareUpdate();f.forEach(c,function(g){if(g.hasChildren()){g.collapseAll()}},10,function(){d.pushUpdate()})})}};return a});define("DS/ENXNav/utils/xNavKindProcessor",["UWA/Class"],function(b){var a=b.singleton({loadKinds:function(h,f,d,c,g){if(f.authorizedWithKind){if(f.authorizedWithKind.Product&&f.authorizedWithKind.Product.length>0){h.add({content:"3DXContent",authorized_objects:f.authorizedWithKind.Product,callback:g,behavior:d,initLoad:true})}if(f.authorizedWithKind.Filter&&f.authorizedWithKind.Filter.length>0){h.addFilter({content:"3DXContent",filter_objects:f.authorizedWithKind.Filter,callback:g,behavior:d,initLoad:true})}if(f.authorizedWithKind.Change&&f.authorizedWithKind.Change.length>0){if(h.loadChange){h.loadChange({content:"3DXContent",objects:f.authorizedWithKind.Change,callback:g,behavior:d,initLoad:true})}}}else{h.add({content:"3DXContent",authorized_objects:f.authorized_objects,behavior:d,kindProcessor:true})}}});return a});define("DS/ENXNav/commands/view/_xNavSelectSiblings",[],function(){var a={execute:function(g){var c=g.xnav_app;var b=g.model;var d=b.getSelectedNodes();b.prepareBroadcastSelect();b.prepareUpdate();b.unselectAll();b.prepareBroadcastSelect();var h=[];var f=[];var i=[];d.forEach(function(k){var l=k.getParent();var j=JSON.stringify(k.getOccurencePath());h.push(j);l.getChildren().forEach(function(n){var m=JSON.stringify(n.getOccurencePath());if(h.indexOf(m)===-1&&j!==m){f.push(n);h.push(m)}})});b.multiselect(f);b.pushUpdate();b.pushBroadcastSelect()}};return a});define("DS/ENXNav/commands/view/xNavRightSidePanel",["DS/PADUtils/commands/RightSidePanel","DS/PADUtils/PADContext","DS/PADUtils/PADModelEvents"],function(d,c,a){var b=d.extend({getXSO:function(){return c.get().options.model.getXSO()},getID:function(f){return f.getID()},getTriptych:function(){return c.get().elements.padshell},onTriptychReady:function(g){var f=a.subscribe({event:"on2DTriptychReady"},function(h){g.call(c.get().elements.padshell);a.unsubscribe(f)})}});return b});define("DS/ENXNav/views/xNavInitError",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options"],function(d,b,c,g,a){var f=g.extend(a,{name:"pad_bigerror",init:function(h){this._parent(h);this.elements.container=UWA.createElement("div",{"class":"pad_error_all"});this.elements.errormsg=UWA.createElement("span",{"class":"pad_error_msg"});this.elements.errormsg.innerHTML=h.msg;this.elements.errormsg.inject(this.elements.container)},render:function(){return this},});return f});define("DS/ENXNav/views/xNavGraphView",["css!DS/ENXNav/ENXNav","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/etree/syncwidget","css!egraph/views","css!etree/syncviews","css!DS/etree/overviewui.css"],function(a,g,d,h,k,b,c,i){var j="xnav_graph";var f=d.extend(h,k,{_treegraph:null,defaultOptions:{fittingArea:{paddingLeft:15,paddingRight:0,paddingTop:0,paddingBottom:80},layout:b.LayoutMode.LAYERED,viewport:null},init:function(l){this._parent(l);this._buildSkeleton();if(this.getOption("renderTo")&&l.isActiveView===true){this.render().inject(this.getOption("renderTo"))}},getThumbnailState:function(l){return this._treegraph.getThumbnailState(l)},swapThumbnailState:function(l){this._treegraph.swapThumbnailState(l)},setGroupThumbnailState:function(m){var o=m.expanded?b.ThumbnailState.COLLAPSED:b.ThumbnailState.EXPANDED;for(var l=0;l<m.nodes.length;l++){var n=m.nodes[l];this._treegraph.setThumbnailState(n,o)}},setAllThumbnailsState:function(l){this._treegraph.setAllThumbnailsState(l)},setLayout:function(l){this._treegraph.setLayout(l)},getContainer:function(){return this.elements.container},render:function(){return this},setModel:function(l){this.inject(this.getOption("renderTo"));this.options.isActiveView=true;this._treegraph.setSize();this._treegraph.setModel(l);if(l.options.viewport.graph!==null){this._treegraph.setViewport(l.options.viewport.graph)}},unsetModel:function(){var l=this._treegraph.getModel();if(l){l.options.viewport.graph=this._treegraph.getViewport()}this.options.isActiveView=false;this._treegraph.setModel(null);this.getOption("renderTo").removeChild(this.elements.container)},setSize:function(){this._treegraph.setSize()},reframeOn:function(){this._treegraph.reframeOn()},reframeAll:function(){this._treegraph.reframeAll()},toggleOverview:function(){this._treegraph.swapOverviewVisibility()},toggleLayout:function(l){switch(l){case"LayoutRight":this._treegraph.setRootPosition(b.OrientationMode.ROOT_ON_LEFT);break;case"LayoutDown":this._treegraph.setRootPosition(b.OrientationMode.ROOT_ON_TOP);break;case"LayoutLeft":this._treegraph.setRootPosition(b.OrientationMode.ROOT_ON_RIGHT);break;case"LayoutUp":this._treegraph.setRootPosition(b.OrientationMode.ROOT_ON_BOTTOM);break;default:this._treegraph.swapLayoutOrientation();break}},toggleActionBar:function(l){if(l){this.options.fittingArea.paddingBottom=80}else{this.options.fittingArea.paddingBottom=10}this._treegraph.setFittingArea(this.options.fittingArea)},_buildSkeleton:function(){if(!g.is(this.elements.container)){this.elements.container=UWA.createElement("div",{"class":j});this._treegraph=new b.SyncEGraphTree(this.elements.container,this.options);this._treegraph.createOverview();if(this._treegraph.setAutogroups){this._treegraph.setAutogroups(true)}this._treegraph.setFittingArea(this.options.fittingArea);if(UWA.is(this._treegraph.setHTML5DnD,"function")){this._treegraph.setHTML5DnD(true);this._treegraph.setMultiSelectionDrag(true)}}},updateView:function(){this._treegraph.updateUnlock()}});return f});define("DS/ENXNav/mixins/_xNavBIFilter",["i18n!DS/PADUtils/assets/nls/PADUtils.json","i18n!DS/ENXNav/assets/nls/ENXNav.json","UWA/Class","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes","DS/PADUtils/PADSession","DS/PADUtils/views/PADAlert","DS/Utilities/Utils","DS/PADUtils/XNavSettings","DS/PADUtils/Utility"],function(n,a,b,i,g,l,d,c,k,h,j){var m={};d.softInit();var f=b.extend({_biFilter:null,_biSlave3D:true,_id2removeFromFilterProxy:[],_filterAlreadyTreatedRoot:[],_isRootAddedFromFilter:false,initializeBI:function(o){var p=this;i.addEvent("onActivateBIFilter",p.onModifyPreferences.bind(p));this._createProxy();d.subscribe({event:"authoringStateModified"},function(q){if(p._biFilter&&q.authored===true&&p._biFilter.resetNGFilterUI){p._biFilter.resetNGFilterUI({widgetId:g.getWidgetId(),appId:g.getSharedId()});p.removeNGFilter()}})},cleanProxy:function(){if(this._biFilter&&this._biFilter.cleanProxy){this._biFilter.cleanProxy()}if(this._biFilter&&this._biFilter.resetNGFilterUI){this._biFilter.resetNGFilterUI({widgetId:g.getWidgetId(),appId:g.getSharedId()})}},removeRootFromFilterProxy:function(q){var p=this;if(this._biFilter){var o=k.debounce(function(){p._biFilter.resetNGFilterUI({widgetId:g.getWidgetId(),appId:g.getSharedId(),rootIds:p._id2removeFromFilterProxy});p._id2removeFromFilterProxy=[]},250);if(p._id2removeFromFilterProxy.indexOf(q.rootId2remove)===-1){p._id2removeFromFilterProxy.push(q.rootId2remove)}if(this._filterAlreadyTreatedRoot.indexOf(q.rootId2remove)>-1){this._filterAlreadyTreatedRoot.splice(this._filterAlreadyTreatedRoot.indexOf(q.rootId2remove),1)}o()}},addFilter:function(q){var p=this;if(d.determineAuthoredFlag()===true){c.displayNotification({msg:n.filterInAuthoring,eventID:"warning"});this._commandProxy.filterWarn("inauthoring");if(p.options.model.getRoots().length===0){p.dropInvitContainer.show("drop")}else{if(p.dropInvitContainer){p.dropInvitContainer.hide()}}}else{if(!this._biFilter){c.displayNotification({msg:n.filterNotActivated,eventID:"warning"});this._commandProxy.filterWarn("notactivated");if(p.options.model.getRoots().length===0){p.dropInvitContainer.show("drop")}else{if(p.dropInvitContainer){p.dropInvitContainer.hide()}}}else{this.beginBlockingTransaction(a.retrieveFilter);if(q.filter_objects){var r=q.behavior==="fromDropOnFilter"?true:false;var o=q.behavior==="fromDrop";this._biFilter.retrieveFilters({filterObjects:q.filter_objects,fromDropOnFilter:r,callback:function(t){if(t.success.length){p._isRootAddedFromFilter=true;p.add({content:"filters",rootsWithFilters:t.success,broadcast:UWA.is(q.broadcast,"boolean")?q.broadcast:r,loadWithFilter:r,fromProxy:q.fromProxy,callback:function(D,z){if(D){var C=z&&z.alreadyLoadedRoots?z.alreadyLoadedRoots:[];var B=false;for(var E=0;E<D.length;E++){if(C.indexOf(D[E].rootId)===-1){B=true;if(q.behavior==="fromDropOnFilter"){if(d.isAuthoring()){c.displayNotification({msg:PADUtils_nls.noFilterOnAuthoring,eventID:"warning"});p.disableFilterWaiting()}else{p.disableFilterWaiting();require(["DS/ApplicationFrame/CommandsManager"],function(F){var G=F.getCommand("DefineFilter");if(G){G.begin()}})}}else{var y=UWA.clone(D[E].filter);if(y){y.filterRootIds=[D[E].rootId];if(y.CVQuery===undefined){if(y.union){y.CVQuery={union:y.union};delete y.union}else{for(var x=0;x<y.union.expand.length;x++){var A=y.union.expand[x];if(A.root_path_physicalid[0][0]===D[E].rootId){y.sequence_filter=A.sequence_filter;y.config_filter=A.config_filter}}var w=[[D[E].rootId]];if(y.root_path_physicalid){w=y.root_path_physicalid}y.CVQuery={root_path_physicalid:w,sequence_filter:y.sequence_filter,config_filter:y.config_filter,expand_iter:"-1"};delete y.sequence_filter;delete y.config_filter}}p.applyFilter(y)}else{console.error("No filter pass")}}}}if(B===false&&q.behavior==="fromDropOnFilter"){p.disableFilterWaiting()}p._isRootAddedFromFilter=false}if(q.callback){var v=[];t.success.forEach(function(F){v.push(F.rootId)});q.callback(v)}}})}if(t.failure.length){for(var s=0;s<t.failure.length;s++){var u={msg:t.failure[s].msg,eventID:t.failure[s].eventID};c.displayNotification(u);p._commandProxy.sharedAlert(u)}if(p.options.model.getRoots().length===0){p.dropInvitContainer.show("drop")}else{if(p.dropInvitContainer){p.dropInvitContainer.hide()}}}if(o){p.endBlockingTransaction()}}})}}}},loadFilters:function(o){if(o.filterIds){this._biFilter.retrieveFilters({filterIds:o.filterIds,doNotFillTheTagger:o.doNotFillTheTagger||true,callback:function(q){if(q.success.length){if(o.callback){o.callback(q.success)}}if(q.failure.length){for(var p=0;p<q.failure.length;p++){c.displayNotification({msg:q.failure[p].msg,eventID:q.failure[p].eventID})}}}})}else{console.error("no filter to loadFilters")}},onModifyPreferences:function(o){if(o===true){if(this._biFilter===null){this._createProxy()}else{this._biFilter.addEvent("ApplyNGFilter",this.onApplyNGFilter,this);if(i.getSetting("ExpandSynthesisON")===true){this._biFilter.addEvent("FilterBIColorize",this.onColorize,this);this._biFilter.addEvent("FilterBIUnColorize",this.onUnColorize,this);this.options.model.getModelEvents().subscribe({event:"onRootAdded"},this.onSetTagsWithExpandSynthesis.bind(this));this.options.model.getModelEvents().subscribe({event:"broadcastColor"},that.onBroadcastColor.bind(this))}else{this._biFilter.addEvent("FilterBIColorize",this.onFilterBIColorize,this);this._biFilter.addEvent("FilterBIUnColorize",this.onFilterBIUnColorize,this);this._biFilter.addEvent("FilterBIFilteringEvent",this.onFilterBIFilteringEvent,this);this.options.model.addEventListener("setPathTags",this.onSetPathTags.bind(this))}this._biFilter.addEvent("TagsLoadingComplete",this.onTagsLoadingComplete,this);this._biFilter.addEvent("NGFilter_Close",this.onFilterClose,this)}}else{if(this._biFilter!==null){this._biFilter.cleanProxy();if(i.getSetting("activateBIFilter")===true){this._biFilter.setPathTags({nodes:[],paths:[]})}this._biFilter.removeEvent("ApplyNGFilter",this.onApplyNGFilter,this);if(i.getSetting("ExpandSynthesisON")===true){this._biFilter.removeEvent("FilterBIColorize",this.onColorize,this);this._biFilter.removeEvent("FilterBIUnColorize",this.onUnColorize,this)}else{this._biFilter.removeEvent("FilterBIColorize",this._onFilterBIColorize,this);this._biFilter.removeEvent("FilterBIUnColorize",this._onFilterBIUnColorize,this);this._biFilter.removeEvent("FilterBIFilteringEvent",this._onFilterBIFilteringEvent,this);this.options.model.removeEvent("setPathTags",this.onSetPathTags,this)}this._biFilter.removeEvent("TagsLoadingComplete",this.onTagsLoadingComplete,this);this._biFilter.removeEvent("NGFilter_Close",this.onFilterClose,this)}}},onApplyNGFilter:function(o){var p=o||null;p=UWA.is(p,"string")?JSON.parse(p):p;this.applyFilter(p)},removeNGFilter:function(){var p=this.getPADTreeDocument();var o=p.getRoots();if(o.length){p.withTransactionUpdate(function(){for(var r=0;r<o.length;r++){var q=o[r];if(q.options.filtered){delete q.options.filtered;q.options.CVQuery=null;q.options.sequence_filter=null;q.options.config_filter=null;q.setBadges({bottomRight:""});q.setState({state:"partiallyExpanded"});q.options.padstate="partiallyExpanded";q.childComputed=false;q.processDescendants({processNode:function(s){if(this.options.children===null){this.options.children=[]}this.setState({state:"partiallyExpanded"});this.options.padstate="partiallyExpanded";this.childComputed=false}});if(q.options.children===null){q.options.children=[]}}}})}},onSetPathTags:function(){if(this._biFilter&&i.getSetting("activateBIFilter")===true){var o=this;setTimeout(function(){var t={nodes:[],paths:[]};var p={};function r(u){if(!p.hasOwnProperty(u)){t.nodes.push(u);p[u]=t.nodes.length-1}return p[u]}function s(w){if(!w.isHidden()){var v=w.getPath();var x=v.map(function(z){var y=z.getID();return r(y)});t.paths.push(x);var u=w.getChildren();if(u){u.forEach(function(y){s(y)})}}}var q=o.options.model.getRoots();q.forEach(function(u){s(u)});if(i.getSetting("tagsLoadingFeedback")===true&&UWA.is(o.elements.padstatus.showLoader,"function")){o.elements.padstatus.showLoader({fonticon:"fonticon-tag",timeout:2000,nlsTooltip:n.tagsLoading})}o._biFilter.setPathTags(t)})}},onTagsLoadingComplete:function(){if(UWA.is(this.elements.padstatus.hideLoader,"function")){this.elements.padstatus.hideLoader()}},onSetTagsWithExpandSynthesis:function(){if(this._biFilter&&i.getSetting("activateBIFilter")===true&&this._isRootAddedFromFilter===false){var o=this;setTimeout(function(){var p=o.options.model.getRoots(),r=[];p.forEach(function(s){var t=s.getID();if(o._filterAlreadyTreatedRoot.indexOf(t)===-1){r.push(t);o._filterAlreadyTreatedRoot.push(t)}});var q={"q.iterative_filter_query_bo":'[ds6w:globalType]:"ds6w:Document" OR [ds6w:globalType]:"ds6w:Part"',no_type_filter_rel:["XCADBaseDependency"]};if(o._biFilter.setTagsWithExpandSynthesis&&r.length>0){o._biFilter.setTagsWithExpandSynthesis(r,q)}})}},onColorize:function(t){var s=this;if(this.options.views.treelistview.getManager().isColumnHidden("bi_color")===true){this.options.views.treelistview.getManager().showColumn("bi_color")}var v=this.predicateKind=t.tagColors&&t.tagColors.length?t.tagColors[0].type:null,q=this.colorMap={map:{}};for(var p=0;p<t.tagColors.length;p++){if(q.predicate===undefined){var r=t.tagColors[p].predicate.split("/");var u=r[r.length-1];q.predicate=u}var w=t.tagColors[p].object;if(UWA.is(t.tagColors[p].object,"array")){w=t.tagColors[p].object.join("/");this.predicateKind="arrayPredicates"}q.map[w]=t.tagColors[p].color;q.map[t.tagColors[p].dispValue]=t.tagColors[p].color}var o=[];s.options.model.withTransactionUpdate(function(){var x=[];s.options.model.getAllDescendants().forEach(function(B){if(B.isVisible()){var A=B.getPLMValue(q.predicate);if(A!==null){var z=j.getBIColor(v,q,A);var y={color:z,grid:{bi_color:z}};B.updateOptions(y);x.push(B)}else{o.push(B.getID())}}});if(s._biSlave3D===true&&x.length){s.colorizeSlave3D(x)}});if(o.length){s.options.model.updateNodesAttrValue(o,[q.predicate],function(y){var x=[];s.options.model.withTransactionUpdate(function(){for(var z=0;z<o.length;z++){var D=s.options.model.getNodesById(o[z]);if(D.length>0){var E=D[0].getPLMValue(q.predicate);if(E!==null){var B=j.getBIColor(v,q,E);var A={color:B,grid:{bi_color:B}};for(var C=0;C<D.length;C++){if(B==="rgba(0, 0, 0, 0)"){delete D[C].options.color}D[C].updateOptions(A);x.push(D[C])}}else{var A={grid:{bi_color:"rgba(0, 0, 0, 0)"}};for(var C=0;C<D.length;C++){delete D[C].options.color;D[C].updateOptions(A);x.push(D[C])}}}}if(s._biSlave3D===true){s.colorizeSlave3D(x)}})})}},onUnColorize:function(){var o=this;o.options.model.withTransactionUpdate(function(){var p={grid:{bi_color:"rgba(0, 0, 0, 0)"}};o.options.model.getAllDescendants().forEach(function(q){delete q.options.color;q.updateOptions(p)})});h.removeBIColumn(this.colorMap.predicate);delete this.colorMap;delete this.predicateKind;if(this.options.views.treelistview.getManager().isColumnHidden("bi_color")!==true){this.options.views.treelistview.getManager().hideColumn("bi_color")}if(o._biSlave3D===true&&undefined!==o._commandProxy){o._commandProxy.padFilterBI({filterBIUnColorize:true})}},onBroadcastColor:function(){var p=this;var o=[];if(p._biSlave3D===true&&UWA.is(p.colorMap)){p.options.model.getAllDescendants().forEach(function(r){if(r.isVisible()){var q=r.getPLMValue(p.colorMap.predicate);if(q!==null){o.push(r)}}});if(o.length){p.colorizeSlave3D(o)}}},onSetTags:function(o){if(this._biFilter.setTags){this._biFilter.setTags(null,o.data.facets,null)}},onFilterBIColorize:function(r){var p=this;var o="FilterBIColorize";m.colorizeProbe=l.createProbe("padfilter_colorize");function q(t,s){if(UWA.is(t.coloredSubjects,"array")){t.coloredSubjects.forEach(function(v){var u=v.color;var w=v.path.map(function(x){return t.nodes[x]});s(u,w)})}else{console.error("Invalid Argument : %o",r)}}if(this.options.views.treelistview.getManager().isColumnHidden("bi_color")===true){this.options.views.treelistview.getManager().showColumn("bi_color")}p.options.model.withTransactionUpdate(function(){m.transactionProbe=l.createProbe("padfilter_transaction");p.options.model.getRoots().forEach(function(t){var s={color:"rgba(0, 0, 0, 0)",grid:{bi_color:"rgba(0, 0, 0, 0)"}};t.updateOptions(s);t.getAllDescendants().forEach(function(u){u.updateOptions(s)})});q(r,function(s,t){p.options.model.getNodesByIDPath(t).forEach(function(v){var u={color:s,grid:{bi_color:s}};v.updateOptions(u)})});p._filter3D(o);m.transactionProbe.end();delete m.transactionProbe});m.colorizeProbe.end();delete m.colorizeProbe},onFilterBIUnColorize:function(){var o=this;o.options.model.withTransactionUpdate(function(){o.options.model.getRoots().forEach(function(q){var p={grid:{bi_color:"rgba(0, 0, 0, 0)"}};delete q.options.color;q.updateOptions(p);q.getAllDescendants().forEach(function(r){delete r.options.color;r.updateOptions(p)})})});if(this.options.views.treelistview.getManager().isColumnHidden("bi_color")!==true){this.options.views.treelistview.getManager().hideColumn("bi_color")}if(undefined!==o._commandProxy){o._commandProxy.padFilterBI({filterBIUnColorize:true})}},onFilterBIFilteringEvent:function(r){var q=this;var p="FilterBIFilteringEvent";var o=q.options.model;o.wrapInTransaction(function(){o.withTransactionUpdate(function(){var C=o.getRoots(true).slice(0);var y=q.options.flags.whenPerformingSearch?q.options.flags.whenPerformingSearch-Date.now()<=500:false;var u=false;C.forEach(function(D){D.filterIn(true)});var z=r.filteredSubjectList;if(z){var s=r.nodes;var t=[];var v={};var w=function w(D){return s[D]};for(var x=0;x<z.length;x++){var B=z[x];if(!v.hasOwnProperty(B)){t.push(B.map(w))}}t.forEach(function(D){o.getNodesByIDPath(D).forEach(function(E){E._filterStatus="IN";E.getParents().forEach(function(F){F._filterStatus="IN"})})});var A=function A(E,F){if(E._filterStatus==="IN"){var D=E.getChildren();if(D&&D.length>0){D.slice(0).forEach(function(G){A(G)})}}else{E.filterOut();if(F){F.push(E)}u=true}delete E._filterStatus};C.forEach(function(D){A(D);var E=false;if(D.options._childrenFilterInfo){var F=D.options._childrenFilterInfo.filteredOutChildren;if(F&&F.length>0){E=true}}if(E){D.setState({state:"partiallyExpanded"});D.options.padstate="partiallyExpanded"}E=false});if(u&&y){c.displayNotification({eventID:"warning",msg:n.filterRemovedItemsFromSearch})}}else{console.error("Invalid Argument : %o",r)}})});if(Object.keys(r.allfilters).length===0){if(undefined!==q._commandProxy){q._commandProxy.padFilterBI({filterBIUnFilterEvent:true})}}else{q._filter3D(p)}},onFilterClose:function(s){var r=this;if(s.tag==="dataFilterPanel"){var q=s?s:{};if(q.rootIds===undefined){q.rootIds=[];var p=r.options.model.getRoots();for(var o=0;o<p.length;o++){q.rootIds.push(p[o].getID())}}r.disableFilterWaiting(q)}},_createProxy:function(){var o=this;require(["DS/ENOFilterBIUX/FilterBIComponentProxy"],function(p){var r={tenant:g.getPlatformId(),processingMode:"appProcessing",colorize:true,widgetId:g.getWidgetId(),appId:g.getSharedId(),volumeFilterAvailable:0,ExpandSynthesisON:i.getSetting("ExpandSynthesisON")===true?true:false,appQueryParam:{"q.iterative_filter_query_bo":'[ds6w:globalType]:"ds6w:Document" OR [ds6w:globalType]:"ds6w:Part"',no_type_filter_rel:["XCADBaseDependency"]},synthesis_priority:1};if(UWA.is(o.onFilterFilteringEvent,"function")){r.events={addFilterChangeListener:o.onFilterFilteringEvent.bind(o)}}o._biFilter=new p(r);o._biFilter.addEvent("TagsLoadingComplete",o.onTagsLoadingComplete,o);o._biFilter.addEvent("NGFilter_Close",o.onFilterClose,o);if(i.getSetting("ExpandSynthesisON")===true){o._biFilter.addEvent("FilterBIColorize",o.onColorize,o);o._biFilter.addEvent("FilterBIUnColorize",o.onUnColorize,o);o.options.model.getModelEvents().subscribe({event:"onRootAdded"},o.onSetTagsWithExpandSynthesis.bind(o));o.options.model.getModelEvents().subscribe({event:"setTags"},o.onSetTags.bind(o));o.options.model.getModelEvents().subscribe({event:"broadcastColor"},o.onBroadcastColor.bind(o))}else{o._biFilter.addEvent("FilterBIColorize",o.onFilterBIColorize,o);o._biFilter.addEvent("FilterBIUnColorize",o.onFilterBIUnColorize,o);o._biFilter.addEvent("FilterBIFilteringEvent",o.onFilterBIFilteringEvent,o);o.options.model.addEventListener("setPathTags",o.onSetPathTags.bind(o))}if(UWA.is(o._biFilter.setNGFilterOptions,"function")){var q={expandServices:"expand",appID:g.getSharedId()};o._biFilter.setNGFilterOptions(q);o._biFilter.addEvent("ApplyNGFilter",o.onApplyNGFilter,o);o.options.model._isVolumeFilter=true}})},_colorChildren:function(t,o,s,r,p){var q=this;var u=t.getChildren();u.forEach(function(x){o.push(x.options.resourceid);o.push(x.options.relationid);if(p==="FilterBIColorize"){s.push({color:x.options.color,pid:x.options.resourceid})}else{s.push({pid:x.options.resourceid})}s.push({pid:x.options.relationid});if(x._expandState==="collapseState"||x._expandState==="partiallyExpandedState"){var w=x.getChildren();if(w!==null&&w.length!==0){q._colorChildren(x,o,s,r,p)}else{var y=x.getOccurencePath(x.options.resourceid);r.push(y.map(function(z){return o.indexOf(z)}))}}else{var v=x.getOccurencePath(x.options.resourceid);r.push(v.map(function(z){return o.indexOf(z)}))}})},_filter3D:function(p){var r=this;var o=[];var t={};var q=[];var s=[];r.options.model.getRoots().forEach(function(u){o.push(u.options.resourceid);if(p=="FilterBIColorize"){s.push({color:u.options.color,pid:u.options.resourceid})}else{s.push({pid:u.options.resourceid})}if(u._expandState=="collapseState"||u._expandState=="partiallyExpandedState"){var w=u.getChildren();if(w!==null&&w.length!==0){r._colorChildren(u,o,s,q,p)}else{var x=u.getOccurencePath(u.options.resourceid);q.push(x.map(function(y){return o.indexOf(y)}))}}else{var v=u.getOccurencePath(u.options.resourceid);q.push(v.map(function(y){return o.indexOf(y)}))}});t={nodes:s,path:q};if(undefined!==r._commandProxy&&t.nodes.length!==0){if(p=="FilterBIColorize"){r._commandProxy.padFilterBI({filterBIColorize:t})}else{r._commandProxy.padFilterBI({filterBIFilteringEvent:t})}}},colorizeSlave3D:function(o){var w=this;var t=[];var v={};var y=[];var q=[];var s=function(z){if(t.indexOf(z)===-1){var A=w.options.model.getNodesById(z);if(A.length){t.push(z);q.push({color:A[0].options.color?A[0].options.color:"rgba(0, 0, 0, 0)",pid:z})}else{var A=w.options.model.getNodesByRelId(z);if(A.length){t.push(z);q.push({color:A[0].options.color?A[0].options.color:"rgba(0, 0, 0, 0)",pid:z})}else{console.error("Unknown node with id ["+z+"]")}}}};for(var x=0;x<o.length;x++){var r=o[x];if(t.indexOf(r.getID())===-1){t.push(r.getID());q.push({color:r.options.color?r.options.color:"rgba(0, 0, 0, 0)",pid:r.getID()})}if(r.isRoot()===false&&t.indexOf(r.getRelationID())===-1){t.push(r.getRelationID());q.push({color:r.options.color?r.options.color:"rgba(0, 0, 0, 0)",pid:r.getRelationID()})}if(r._expandState==="collapseState"||r._expandState==="partiallyExpandedState"){var p=r.getOccurencePath(r.options.resourceid);y.push(p.map(function(z){s(z);return t.indexOf(z)}))}else{var u=r.getOccurencePath(r.options.resourceid);y.push(u.map(function(z){s(z);return t.indexOf(z)}))}}v={nodes:q,path:y};if(undefined!==w._commandProxy&&v.nodes.length!==0){w._commandProxy.padFilterBI({filterBIColorize:v})}}});return f});define("DS/ENXNav/mixins/_xNavRefresh",["UWA/Class","DS/PADUtils/PADSettingsMgt"],function(a,b){var c=a.extend({});if(b.getSetting("refresh_v2")===true){c.prototype.refresh=function(d){var f=this;d=d===undefined?true:d;require(["DS/ApplicationFrame/CommandsManager"],function(g){var h=g.getCommand("Uncut");if(h){h.begin()}});if(d){this._commandProxy.refreshModel()}this.getPADTreeDocument().refresh()}}return c});define("DS/ENXNav/commands/_xNavSwitchView",[],function(){var a={execute:function(b){b.xnav_app.toggleView(b.command_id)}};return a});define("DS/ENXNav/commands/view/_xNavSelectLeaves",[],function(){var a={execute:function(f){var c=f.xnav_app;var b=f.model;var d=b.getSelectedNodes();require(["DS/ENXNav/commands/view/_xNavSelectCmdsUtils"],function(g){var h=g._filterParentsOnly(d);b.prepareBroadcastSelect();b.prepareUpdate();b.unselectAll();b.prepareBroadcastSelect();var i=[];h.forEach(function(j){j.processDescendants({processNode:function(){if(this.isVisible()){if(this.hasChildren()===false){i.push(this)}else{if(this.getState()==="collapsed"){i.push(this)}}}}})});b.multiselect(i);b.pushUpdate();b.pushBroadcastSelect()})}};return a});define("DS/ENXNav/commands/view/_xNavSelectChildren",[],function(){var a={execute:function(f){var c=f.xnav_app;var b=f.model;var d=b.getSelectedNodes();require(["DS/ENXNav/commands/view/_xNavSelectCmdsUtils"],function(h){var i=h._filterParentsOnly(d);b.prepareBroadcastSelect();b.prepareUpdate();b.unselectAll();b.prepareBroadcastSelect();var g=[];i.forEach(function(j){g.push(j);j.processDescendants({processNode:function(){g.push(this)}})});b.multiselect(g);b.pushUpdate();b.pushBroadcastSelect()})}};return a});define("DS/ENXNav/commands/view/_xNavSelectCmdsUtils",[],function(){function b(g,f){var d=false;for(var c=0;c<f.length&&d===false;c++){if(g.getID()!==f[c].getID()){d=g.isDescendantOf(f[c])}}return d}var a={_filterParentsOnly:function(f){var c=[];for(var d=f.length-1;d>=0;d--){var g=f[d];if(b(g,f)===false){c.push(g)}}return c}};return a});define("DS/ENXNav/utils/OpenWithMenuBuilder",["DS/i3DXCompassPlatformServices/OpenWith","UWA/Promise","DS/PADUtils/PADUtilsServices"],function(d,c,f){function b(){}b.prototype={openWithApps:function(g,h){return new c(function(j,i){f.contentOpenWith(g,function(l){var k=new d();k.set3DXContent(l,true);if(UWA.is(k.retrieveCompatibleApps,"function")){k.retrieveCompatibleApps(function(n){var o=[];var m=[];n.forEach(function(q){m.push({type:"PushItem",title:q.text,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+q.fonticon,family:WUXManagedFontIcons.Font3DS},action:{callback:q.handler}})});if(m.length>0){var p={type:"PushItem",icon:"url("+h.iconOpenWith+")",title:h.nlsOpenWith,submenu:m};o.push(p);o.push({type:"SeparatorItem"})}j(o)})}else{j([])}})})}};var a;if(!a){a=new b()}return a});define("DS/ENXNav/commands/_xNavGraphCmds",[],function(){var a=null;var b={execute:function(c){var d=c.xnav_app.options.views.graphview;switch(c.command_id){case"ReframeAll":d.reframeAll();break;case"ReframeOn":d.reframeOn();break;case"ToggleOverview":d.toggleOverview();break;case"LayoutDown":case"LayoutRight":case"LayoutUp":case"LayoutLeft":d.toggleLayout(c.command_id);break;case"SwapThumbState":require(["DS/etree/syncwidget"],function(g){if(a===null){a=g.ThumbnailState.EXPANDED}var f=false;if(a===g.ThumbnailState.EXPANDED){a=g.ThumbnailState.COLLAPSED;f=true}else{if(a===g.ThumbnailState.COLLAPSED){a=g.ThumbnailState.EXPANDED;f=true}}if(f===true){d.setAllThumbnailsState(a)}});break}}};return b});define("DS/ENXNav/views/_xNavToolbar",["css!DS/ENXNav/ENXNav","text!DS/ENXNav/assets/templates/XNavToolbar.html","DS/Core/Core","DS/Handlebars/Handlebars","DS/WebappsUtils/WebappsUtils"],function(g,i,b,h,f){h.registerHelper("icon_url",function(j){return"url("+f.getWebappsAssetUrl(j.module,"icons/32/"+j.file)+")"});h.registerHelper("nls",function(j){return j});h.registerHelper("width",function(j){return j.length*50+"px"});var c=h.compile(i);var a="xnav_toolbar";function d(j){this.options={node_html:null,toolbar_definition:j.toolbar_definition};this.options.node_html=document.createElement("div");this.options.node_html.className="xnav_toolbar"+(j.className?" "+j.className:"");this.options.node_html.innerHTML=c(this.options.toolbar_definition)}d.prototype.render=function(){return this.options.node_html};return d});define("DS/ENXNav/models/RefreshHandler",["UWA/Core","UWA/Class"],function(f,c){var d={state:"partiallyExpanded"};function b(h,l){var g=h.getRoots();for(var j=0;j<g.length;j++){var k=g[j];l(k);k.processDescendants({processNode:function(i){l(this)}})}}var a=c.extend({init:function(g){this.options=g;this.treeDocument=g.treeDocument},complete:function(g){this._clearAllHidden(this.treeDocument);this.treeDocument.getXSO().empty()},_clearAllHidden:function(g){b(g,function(h){if(h.options.isPADHiddenBackEnd===true){delete h.options.isPADHiddenBackEnd}else{h.options.isPADHidden=false}})}});return a});define("DS/ENXNav/commands/view/_xNavSelectAll",[],function(){var a={execute:function(g){var f=g.xnav_app;var b=g.model;var c=b.getRoots();if(c.length){b.prepareBroadcastSelect();b.prepareUpdate();b._selected_paths=[];var d=[];c.forEach(function(h){h.select();h.processDescendants({processNode:function(){if(this.isVisible()){d.push(this)}}})});b.multiselect(d);b.pushUpdate();b.pushBroadcastSelect()}}};return a});define("DS/ENXNav/commands/tools/_xNavExport",[],function(){var a={execute:function(b){require(["DS/ENXNav/commands/tools/xNavExporter","DS/PADUtils/views/_PADCustomizeView","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/AttributesMgt","DS/PADServices/utils/DictionaryAccess","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(g,d,f,k,i,j){switch(b.command_id){case"Print":g.printHtml({context:b.xnav_app});break;case"ExportCSV":b.xnav_app.beginBlockingTransaction(j.exportMask);var h=i.updateNLSforexport(b.xnav_app.getPADTreeDocument());h.then(function(){g.generateCsv({context:b.xnav_app});b.xnav_app.endBlockingTransaction()})["catch"](function(m){console.error(m);b.xnav_app.endBlockingTransaction()});break;case"PrintOptions":case"ExportCSVOptions":var l=b.xnav_app.getPADTreeListView();var c=new d({id:b.command_id,columns:b.xnav_app.getPADTreeListView().options.columns,render_div:".xnav_body",events:{modifyColumRendering:b.xnav_app.getPADTreeListView().modifyColumRendering.bind(b.xnav_app.getPADTreeListView()),reset:b.xnav_app.getPADTreeListView().reset.bind(b.xnav_app.getPADTreeListView()),ok:function(){switch(b.command_id){case"PrintOptions":g.printHtml({context:b.xnav_app});break;case"ExportCSVOptions":b.xnav_app.beginBlockingTransaction(j.exportMask);var m=i.updateNLSforexport(b.xnav_app.getPADTreeDocument());m.then(function(){g.generateCsv({context:b.xnav_app});b.xnav_app.endBlockingTransaction()})["catch"](function(n){console.error(n);b.xnav_app.endBlockingTransaction()});break}},customizationWindowChange:function(m){f.customizationWindowChange(m)}}});l.addEvent("explicitResetComplete",function(){c.loadRows(l.options,true)});break}setTimeout(function(){if(b.cmd){b.cmd.enable()}},500)})}};return a});define("DS/ENXNav/mixins/_xNavRootListMgt",["i18n!DS/ENXNav/assets/nls/ENXNav.json","UWA/Class","UWA/Promise","DS/PADUtils/views/PADResponsiveRootList","DS/PADUtils/PADPromise","DS/Core/ModelEvents",],function(m,b,i,l,f,c){var a=b.extend({createRootListSlidder2:function(o){var n=this;n.elements.padrootlist_div=UWA.createElement("div",{"class":"xnavrootlist"});n.elements.navrootlist=new l({events:{onTileAdd:d.bind(n),onTileDelete:j.bind(n),onTileSelect:k.bind(n),onAttach:h.bind(n),onDetach:g.bind(n)}}).inject(n.elements.padrootlist_div);n.options.model.onNodeModelUpdate(function(p){n.elements.navrootlist.syncTile(p.data.nodeModel)});if(o&&o.leftContainer){n.elements.padrootlist_div.inject(o.leftContainer)}return n.elements.padrootlist_div},manageRootList:function(n){var s=this;if(UWA.is(n.data.added_node)&&UWA.is(s.elements.navrootlist)&&!(UWA.is(n.data.isremove)&&n.data.isremove===true)){var t=false;var p=s.elements.navrootlist.options.model;var v=p.getRoots();if(v&&v.length>0){for(var o=0;o<v.length;o++){if(v[o].options.resourceid===n.data.added_node.options.resourceid){t=true;break}}}if(!t){s.elements.navrootlist.addRootTile(n.data.added_node.options);n.data.added_node.onSelect(s.elements.navrootlist.selectTile.bind(s.elements.navrootlist));n.data.added_node.onUnselect(s.elements.navrootlist.unselectTile.bind(s.elements.navrootlist))}}else{if(UWA.is(n.data.added_nodes)&&UWA.is(s.elements.navrootlist)){var q=[];for(var u=0;u<n.data.added_nodes.length;u++){var r=n.data.added_nodes[u];var t=false;var p=s.elements.navrootlist.options.model;var v=p.getRoots();if(v&&v.length>0){for(var o=0;o<v.length;o++){if(v[o].options.resourceid===r.options.resourceid){t=true;break}}}if(!t){q.push(r.options);r.onSelect(s.elements.navrootlist.selectTile.bind(s.elements.navrootlist));r.onUnselect(s.elements.navrootlist.unselectTile.bind(s.elements.navrootlist))}}if(q.length){s.elements.navrootlist.addRootTiles(q)}}}},toggleRoot:function(o){var n=o.context?o.context:o;if(this.elements.navrootlist){if(n.options.isRootAttached===true||n.options.isRootAttached===undefined){this.elements.navrootlist.detachTile({tile_id:n.getID()})}else{this.elements.navrootlist.attachTile({tile_id:n.getID()})}}else{if(n.options.isRootAttached===true||n.options.isRootAttached===undefined){g.call(this,{tile_id:n.getID()})}else{h.call(this,{tile_id:n.getID()})}}},_onRemoveRoot:function(q){var p=this;var n=f.getPromises();var r=n.slice();var o=new i(function(t,s){i.all(r).then(function(u){if(p.elements.navrootlist){q.pids.forEach(function(v){p.elements.navrootlist.removeTile({tile_id:v});p.removeRootFromFilterProxy({rootId2remove:v})});if(p.options.model.getRoots().length===0&&p.options.model.getDetachedRoots().length===0){p.dispatchEvent("onEmptyView")}}if(p.getOption("layout").store_roots_in_pref){p.dispatchEvent("onDeleteRoots",JSON.stringify(q.pids))}t()})});o.name="removeroot";n.push(o);return false},manageAttach:function(o){var n=this;var p=o.pids;if(!p||p.length===0){return}p.forEach(function(q){var r=n.options.model.searchRootById(q);if(UWA.is(r)){n.toggleRoot({context:r})}})},manageDetach:function(o){var n=this;var p=o.pids;if(!p||p.length===0){return}p.forEach(function(q){var r=n.options.model.searchRootById(q);if(UWA.is(r)){n.toggleRoot({context:r})}})}});function d(o){var n=this;if(o.json_content.authorized_objects&&o.json_content.authorized_objects.length>0){n.add({content:"3DXContent",authorized_objects:o.json_content.authorized_objects,callback:o.callback,behavior:"WITHOUT_CONTEXT"})}else{console.warn("You have accessed an invalid branch in the _onTileAdd() event handler.")}return false}function k(o){if(!UWA.is(o.tile_ids,"array")){throw new Error("Invalid input param, no params.tile_ids defined")}var n=this;this.options.model.unselectAll();o.tile_ids.forEach(function(p){var q=n.options.model.searchRootById(p);if(q){q.select()}else{console.log("Cannot find ["+p+"] in the TreeDocument")}})}function j(o){if(!UWA.is(o.tile_id)){throw new Error("Invalid input parameter")}var n=this.options.model.searchRootById(o.tile_id);if(UWA.is(n)){this.options.model.removeRoot(n)}return false}function h(p){var n=this.options.model.searchRootById(p.tile_id);var o=this.options.model.searchRootById(p.before_tile_id);this.options.model.attachRoot(n,o);n.select();if(this.options.active_view==="graphview"){this.options.views.graphview.reframeOn()}this._commandProxy.attach({pids:[p.tile_id]});this.dispatchEvent("onRootsVisibility");return false}function g(p){var o=this,n=o.options.model.searchRootById(p.tile_id);if(UWA.is(n)){o.options.model.detachRoot(n);o._commandProxy.detach({pids:[p.tile_id]})}o.dispatchEvent("onRootsVisibility");return false}return a});define("DS/ENXNav/views/xNavFind",["UWA/Class","UWA/Class/Options","DS/PADUtils/views/PADSearchView","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Tooltip","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(b,h,i,f,c,d,g,k){function j(){var l="500px";if(document.body.scrollHeight>40){l=document.body.scrollHeight+"px"}return l}var a=b.extend(h,{name:"xnav_find",_modal:null,options:{isMatchCase:false,isWholeWord:false},_matchedNodes:[],_idx:0,init:function(m){this._parent(m);this.setOptions(m);if(!m.renderTo){m.renderTo=document.body}m.context.addEvent("onParentResize",this.onParentResize.bind(this));var o=UWA.createElement("div");var n=this;var l=n.getOption("context");l.getPADTreeDocument().options.insert_replace=false;this._padsrcview=new i({navigate_onresult:true,callbacks:{onSearch:this._onPADSearch.bind(this),onNext:this._onPADNext.bind(this),onPrevious:this._onPADPrevious.bind(this),onClear:this._onPADClearSearch.bind(this)}}).render().inject(o);l.getPADTreeDocument()._insertFlag=false;l.getPADTreeDocument().options.insert_replace=true;this._caseWholeWordButton=new d({className:n.name+"_btn_grp",buttons:[new c({className:n.name+"_btn "+n.name+"_matchCase",value:"Aa",attributes:{title:k.PADFind_matchcase},events:{onClick:function(){if(n.getOption("isMatchCase")===false){this.setActive(true);n.setOption("isMatchCase",true);this.setClassName("primary "+n.name+"_btn "+n.name+"_matchCase")}else{if(n.getOption("isMatchCase")===true){this.setActive(false);n.setOption("isMatchCase",false);this.setClassName(n.name+"_btn "+n.name+"_matchCase")}}}}}),new c({className:n.name+"_btn "+n.name+"_wholeWord",value:"Ww",attributes:{title:k.PADFind_wholeword},events:{onClick:function(){if(n.getOption("isWholeWord")===false){this.setActive(true);n.setOption("isWholeWord",true);this.setClassName("primary "+n.name+"_btn "+n.name+"_wholeWord")}else{if(n.getOption("isWholeWord")===true){this.setActive(false);n.setOption("isWholeWord",false);this.setClassName(n.name+"_btn "+n.name+"_wholeWord")}}}}}),new c({className:n.name+"_btn "+n.name+"_close",icon:"cancel",attributes:{title:k.PADFind_close},events:{onClick:function(){var p=n.getOption("context");if(p){p.getPADTreeDocument().clearSearch();p.updateCurrentView()}n._modal.destroy();n._closeTT.destroy()}}})],}).inject(o);new g({target:this._caseWholeWordButton.buttons[0].getContent(),position:"top"});new g({target:this._caseWholeWordButton.buttons[1].getContent(),position:"top"});this._closeTT=new g({target:this._caseWholeWordButton.buttons[2].getContent(),position:"top"});this._modal=new f({className:this.name+"_modal",closable:false,body:o,visible:true});if(m.position==="above_action_bar"){this._aboveBar=true;this._modal.elements.wrapper.setStyle("padding-top","calc("+j()+" - 80px)");this._modal.elements.wrapper.setStyle("padding-left","calc(50% - 170px)")}this._modal.elements.container.addEventListener("click",function(q){var p=n.getOption("context");if(p){p.getPADTreeDocument().clearSearch();p.updateCurrentView()}n._modal.destroy()});this._modal.elements.content.addEventListener("click",function(p){p.preventDefault();p.stopPropagation();return false});this._modal.inject(m.renderTo)},_onPADSearch:function(n){var m=this;var l=this.getOption("context");if(n.search_value.length){if(l){this._matchedNodes=l.getPADTreeDocument()._performSearch(n.search_value,{isMatchCase:this.getOption("isMatchCase"),isWholeWord:this.getOption("isWholeWord")});l.updateCurrentView()}if(this._matchedNodes.length>0){this._idx=0;this._selectInList()}else{this._padsrcview.setCount({index:0,total:0})}}else{if(l){l.getPADTreeDocument().clearSearch()}}},_onPADNext:function(){if(this._idx<this._matchedNodes.length-1){this._idx=this._idx+1}else{if(this._idx===this._matchedNodes.length-1){this._idx=0}}this._selectInList()},_onPADPrevious:function(){if(this._idx>0){this._idx=this._idx-1}else{if(this._idx===0){this._idx=this._matchedNodes.length-1}}this._selectInList()},_onPADClearSearch:function(){var l=this.getOption("context");if(l){l.getPADTreeDocument().clearSearch();l.updateCurrentView()}},_selectInList:function(){this._matchedNodes[this._idx].select(true);this._padsrcview.setCount({index:this._idx+1,total:this._matchedNodes.length});var l=this.getOption("context");if(l.options.active_view==="treelistview"){l.options.views.treelistview.getManager().scrollToNode(this._matchedNodes[this._idx])}else{if(l.options.active_view==="graphview"){l.options.views.graphview.reframeOn()}}},onParentResize:function(){if(this._aboveBar===true){this._modal.elements.wrapper.setStyle("padding-top","calc("+j()+" - 80px)")}}});return a});define("DS/ENXNav/utils/xNavCustoStorageOptim",["UWA/Core","DS/PADUtils/PADSettingsMgt"],function(b,a){function h(k){for(var j=0;j<k.columnsOptimized.length;j++){var l=k.columnsOptimized[j];if(l.xnav_options&&l.xnav_options.titleModified){delete l.text;delete l.xnav_options.titleModified}}}var d={dataIndex:undefined,text:undefined,isDraggable:true,width:150,minWidth:10,maxWidth:999,isHidden:false,isSortable:undefined,type:undefined,xnav_options:{name:undefined,dataIndex:undefined,tree:undefined,hardcoded:undefined,exportable:{lock:false,value:true},layout:{removable:undefined,hidden:undefined,width:150,minWidth:undefined,maxWidth:undefined},kind:undefined}};var g={convertCusto4Preference:function(l,k){var j={custoOptimized:true,viewMode:l.viewMode,defaultCellHeight:l.defaultCellHeight,columnsOptimized:[],lang:a.getSetting("lang")};for(var i=0;i<l.columns.length;i++){var n=l.columns[i];var m=f(n,d);if(k[n.dataIndex]){m.text=n.text}j.columnsOptimized.push(m)}return j},convertPreference2Custo:function(j){var k={viewMode:j.viewMode,defaultCellHeight:j.defaultCellHeight,columns:[]};if(j.lang&&j.lang!==a.getSetting("lang")){h(j)}for(var i=0;i<j.columnsOptimized.length;i++){var m=j.columnsOptimized[i];var l=c(m,b.clone(d),m.dataIndex);k.columns.push(l)}return k}};function f(j,m){var n={};if(m===undefined){n=j}else{var l=Object.getOwnPropertyNames(j);for(var i=0;i<l.length;i++){if(UWA.is(j[l[i]],"object")){var k=f(j[l[i]],m[l[i]]);if(Object.getOwnPropertyNames(k).length>0){n[l[i]]=k}}else{if(j[l[i]]!==m[l[i]]&&l[i]!=="text"){n[l[i]]=j[l[i]]}}}}return n}function c(q,j,n){var l={};if(q===undefined){l=j}else{var o=Object.getOwnPropertyNames(j);var m=Object.getOwnPropertyNames(q);for(var p=0;p<o.length;p++){if(UWA.is(j[o[p]],"object")){if(n!=="bi_color"){var i=c(q[o[p]],j[o[p]],n);if(Object.getOwnPropertyNames(i).length>0){l[o[p]]=i}}}else{if(q[o[p]]===undefined){l[o[p]]=j[o[p]]}else{l[o[p]]=q[o[p]]}}}for(var k=0;k<m.length;k++){if(l[m[k]]===undefined){l[m[k]]=q[m[k]]}}}return l}return g});define("DS/ENXNav/views/customize_views/_xNavTreeLstDefinitionMgr",["UWA/Class","UWA/Class/Options","UWA/Promise","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADSettingsMgt","DS/PADUtils/XNavSettings","DS/PADUtils/PADWSAccess","DS/PADUtils/PADProbes"],function(a,i,h,j,c,f,d,k,g){var b=a.extend(i,{init:function(l){this._parent(l);this.appId=l.x3dAppId;if(typeof expect==="function"){this.reset=l.reset}else{this.reset=false}this.padtreelst_def_file=l.padtreelst_def_file;this.storageKey="PADTreeListDefinition."+l.x3dAppId+"_"+l.tenantId;this.pendingKey="getTreeListDefinitionPending."+l.x3dAppId+"_"+l.tenantId},clearCache:function(){localStorage.removeItem(this.storageKey)},getTreeListDefinition:function(s,l){this.probe=g.createProbe("init_treeListDef");var p=this;var o=localStorage.getItem(this.storageKey);var m=UWA.is(o,"string")?JSON.parse(o):o;if(UWA.is(m)){this.probe.end();delete this.probe;if(s){s(m)}}else{if(!sessionStorage.getItem(this.pendingKey)){var t=g.createProbe("col_tmg_req");t.end();var n=g.createProbe("col_tmg_ws");var r=d.getSetting("basic_treelistopts");sessionStorage.setItem(p.pendingKey,"true");k.padtreelistOpts({data:{intent:d.getSetting("buildTreeListOpts").intent,app:p.appId,reset:p.reset},onComplete:function(v){var u=UWA.is(v,"string")?JSON.parse(v):v;var w={build_tree_opts:r,json_response:u};localStorage.setItem(p.storageKey,JSON.stringify(w));sessionStorage.removeItem(p.pendingKey);p.probe.end();delete p.probe;n.end();if(s){s(w)}},onTimeout:function(){sessionStorage.removeItem(p.pendingKey);n.end();if(l){l(null)}},onFailure:function(){sessionStorage.removeItem(p.pendingKey);n.end();if(l){l(null)}}})}else{var q=function(v){if(v.key===p.pendingKey&&!v.newValue){window.removeEventListener("storage",p);p.probe.end();delete p.probe;if(s){var u=localStorage.getItem(p.storageKey);u=UWA.is(u,"string")?JSON.parse(u):u;s(u)}}};window.addEventListener("storage",q)}}}});return b});define("DS/ENXNav/views/xNavResponsiveTilesView",["UWA/Controls/Abstract","UWA/Core","UWA/Class/Options","UWA/Class/Events","DS/ApplicationFrame/CommandsManager","DS/CollectionView/ResponsiveTilesCollectionView"],function(h,g,b,a,d,c){var f=h.extend(b,a,{name:"xNavResponsiveTileView",defaultOptions:{grid:null,model:null},init:function(j){var l=this;this._parent(j);this.options=UWA.extend(this.options,j,true);this.elements.container=UWA.createElement("div",{"class":this.getClassNames()});var i=UWA.extend(j,{height:"inherit",displayedOptionalCellProperties:["contextualMenu","statusbarIcons","activeFlag"],useDragAndDrop:true,allowUnsafeHTMLContent:false},true);var k=this.options.grid=new c(i);if(j.onContextualEvent){k.onContextualEvent=j.onContextualEvent}k.getContent().inject(this.elements.container);if(this.getOption("renderTo")&&j.isActiveView===true){this.elements.container.inject(this.getOption("renderTo"))}k.onCellsCopy(function(m){d.getCommand("Copy").begin()});k.onCellsPaste(function(m){d.getCommand("Paste").begin()});k.onCellsCut(function(m){d.getCommand("Cut").begin()});k.selectionBehavior=UWA.extend({enableFeedbackForActiveCell:true},k.selectionBehavior);k.onPostCellRequest(function(m){if(m.nodeModel&&m.nodeModel.options.isBeingCut){m.cellView.getContent().addClassName("pad-state-is-being-cut")}else{m.cellView.getContent().removeClassName("pad-state-is-being-cut")}})},setModel:function(i){this.options.model=i;this.options.grid.loadGridViewModel(i);this.elements.container.inject(this.getOption("renderTo"));this.options.isActiveView=true;this.options.grid.layout.invalidate();if(i.options.viewport.thumbnails!==null&&i.options.viewport.thumbnails!==undefined){this.options.grid.setScrollerPosition(i.options.viewport.thumbnails)}},unsetModel:function(){if(this.getScrollerPosition){this.options.model.options.viewport.thumbnails=this.getScrollerPosition()}this.getOption("renderTo").removeChild(this.elements.container);this.options.isActiveView=false;this.options.grid.unloadGridViewModel()},updateView:function(){this.options.grid.layout.invalidate({updateCellContent:true})}});return f});define("DS/ENXNav/commands/view/_xNavRootInfoPanel",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext","DS/Core/ModelEvents"],function(f,d,c,b){var a=d.extend({_context:null,_callbackAdd:false,init:function(h){this._parent(h,{});this._context=c.get();this._change_state_from_close=false;var i=this;var g=false;if(i._context.elements.padshell&&i._context.elements.padshell._modelEvents){i.addCallback()}i=this;this.onStateChange(function(){if(i._change_state_from_close){i._change_state_from_close=false}else{i._context.togglePanel("left")}})},addCallback:function(){var g=this;if(this._callbackAdd===false){this._context.elements.padshell._modelEvents.subscribe({event:"triptych-hide-panel"},function(h){if(h==="left"){g._change_state_from_close=true;g.setState(false,false)}});g._callbackAdd=true}}});return a});define("DS/ENXNav/commands/tools/_xNavRelationIPExplorer",[],function(){var a={execute:function(b){require(["DS/PADUtils/PADUtilsServices","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(d,c){d.setObject_on_compass({nodes_2_open:b.xnav_app.options.model.getSelectedNodes()});b.xnav_app.beginBlockingTransaction(c.where_used_app);d.open_app({appId:"ENORIPE_AP"},function(f){b.xnav_app.endBlockingTransaction()})})}};return a});define("DS/ENXNav/mixins/_xNavDnD",["UWA/Class","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADDropTooltip","DS/ApplicationFrame/CommandsManager","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,h,c,d,j,i,f,a,g){var k=b.extend({setDnD_onGraph:function(){this.options.views.graphview.getContainer().addEventListener("dragover",this.onDragOverGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("drop",this.onDropBlankGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragenter",this.onDragLeaveGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragleave",this.onDragLeaveGraph.bind(this));this.options.views.graphview.getContainer().addEventListener("dragend",this.onDragLeaveGraph.bind(this))},doDnDDragStart:function(m,l,n){var o=h.dropdata_from_selected_nodes(l);m.setData("Text",JSON.stringify(o));return true},shouldAcceptDnDDrop:function(p,n,m,o){var l=true;var q={shiftKey:o.modifiers===2};this._add_drop_invite(q);return l},doDnDDrop:function(o,m,l,n){var p={dataTransfer:o,preventDefault:function(){},stopPropagation:function(){},shiftKey:n.modifiers};this._onDropContent(p)},onDragOverGraph:function(l){if(l.dataTransfer){if(l.dataTransfer.effectAllowed==="copyMove"||l.dataTransfer.effectAllowed==="copy"){l.dataTransfer.dropEffect="copy";l.preventDefault()}}this.options.views.graphview.getContainer().addClassName("bordered");return true},onDragLeaveGraph:function(l){this.options.views.graphview.getContainer().removeClassName("bordered");return this.onDragLeaveBlank(l)},onDropBlankGraph:function(l){this.options.views.graphview.getContainer().removeClassName("bordered")},onDragEnterBlank:function(m,l){return this.onDragOverBlank(m,l)},onDragOverBlank:function(m,l){if(m.dataTransfer){if(m.dataTransfer.effectAllowed==="copyMove"||m.dataTransfer.effectAllowed==="copy"){m.dataTransfer.dropEffect="copy";m.preventDefault()}}if(!this._isDroppableInBody()){return false}this._add_drop_invite(m);return true},onDragEndBlank:function(m,l){return this.onDragLeaveBlank(m,l)},onDragLeaveBlank:function(q,p){if(!this._isDroppableInBody()){return false}var n=q.relatedTarget;var m=n?n.className:"";var l=(m&&m.indexOf("paddnd_invite_")!==-1)?true:false;if(l){q.preventDefault();q.stopPropagation();return false}else{var o=this.options.model.detachedRoots?this.options.model.detachedRoots.length:0;if(this.options.model.getRoots().length===0&&o===0){this.dropInvitContainer.show("drop")}else{if(this.dropInvitContainer.isEventInside(q)){q.preventDefault();q.stopPropagation();return false}else{this.dropInvitContainer.hide(this.dropInvitContainer.active_invite)}}}return true},onDropBlank:function(m,l){this.options.model.unselectAll();this._onDropContent(m);return false},onDragEnterCell:function(m,l){return this.onDragOverBlank(m,l)},onDragEndCell:function(m,l){return this.onDragLeaveCell(m,l)},onDragStartCell:function(r,q){var n=q.nodeModel;var m=this.options.model;var o=m.getXSO().get().slice(0);if(o[0]!==n){var p=o.indexOf(n);var l=o[0];o[0]=n;o[p]=l}var s=h.dropdata_from_selected_nodes(o);r.dataTransfer.setData("Text",JSON.stringify(s));r.stopPropagation();return false},onDragOverCell:function(m,l){if(m.dataTransfer){if(m.dataTransfer.effectAllowed==="copyMove"||m.dataTransfer.effectAllowed==="copy"){m.dataTransfer.dropEffect="copy";m.preventDefault()}}if(!this._isDroppableInBody()){return false}if(l.dataIndex==="find_in_ctx"){this.dropInvitContainer.show("find")}m.preventDefault();return true},onDragLeaveCell:function(p,o){var n=p.relatedTarget;var m=n?n.className:" ";var l=(m&&m.indexOf("paddnd_invite_")!==-1)?true:false;if(l||this.dropInvitContainer.isEventInside(p)){p.stopPropagation();p.preventDefault();return false}this.dropInvitContainer.hide(this.dropInvitContainer.active_invite);return true},onDropCell:function(o,n){this.onDragLeaveCell(o);o.preventDefault();o.stopPropagation();function l(){return m}if(n.dropPosition!=="top"&&n.dropPosition!=="bottom"){var m=[];if(n.dataIndex==="find_in_ctx"){d.retrieveAuthorizedObjects({dnd_event:o,isFindInCtx:true,callback:function(q){var p=0;for(p=0;p<q.authorized_objects.length;p++){m.push([q.authorized_objects[p].objectId])}if(m.length){n.nodeModel.options.partialPreExpand=l;n.nodeModel.expand()}}})}}else{c.displayNotification({msg:g.drop_between_lines,eventID:"warning"})}return false},onDragEnterColumnHeader:function(m,l){return},onDragEndColumnHeader:function(m,l){delete sessionStorage.isNotDroppableInBody;return this.onDragLeaveColumnHeader(m,l)},onDragOverColumnHeader:function(m,l){if(this._isDroppableInBody()){this._add_drop_invite(m)}return true},onDragLeaveColumnHeader:function(n,m){var l=this.options.model.detachedRoots?this.options.model.detachedRoots.length:0;if(this.options.model.getRoots().length===0&&l===0){this.dropInvitContainer.show("drop")}else{this.dropInvitContainer.hide(this.dropInvitContainer.active_invite)}return true},onDropColumnHeader:function(n,m){if(m.dataIndex=="bi_color"){return false}var l=true;switch(h.retrieveDroppedDataType(n)){case"3DXContent":this.options.model.unselectAll();this._onDropContent(n);l=false;break;default:if(this.options.model.getRoots().length===0){this.dropInvitContainer.show("drop")}else{this.dropInvitContainer.hide()}console.warn("Not manage dropped data")}return l},onDragStartColumnHeader:function(m,l){sessionStorage.isNotDroppableInBody="true";return true},_add_drop_invite:function(l){if(l.shiftKey){this.dropInvitContainer.show("add_as_object")}else{this.dropInvitContainer.show("add_in_context");if(this.dropInvitContainer&&this.dropInvitContainer.elements&&this.dropInvitContainer.elements.container&&this.dropInvitContainer.elements.container.filterDiv){this.dropInvitContainer.elements.container.filterDiv.style.display="none";this.dropInvitContainer.elements.container.classList.remove("withFilterOpen")}}},_onDropContent:function(n){var m=this;n.preventDefault();n.stopPropagation();function l(q){if(q.authorized_objects.length===0){if(m.options.model.getRoots().length===0){m.dropInvitContainer.show("drop")}else{m.dropInvitContainer.hide()}if(q.unsupportedDropNotified===true){c.displayNotification({msg:g.msg_warning_dndnotsupported,eventID:"error"})}}else{var p=n.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT";var o=m.options.model.getRoots();h.multiTenantMgt(q.authorized_objects,o,function(r){if(!r.isMultiTenant){if(q.authorizedWithKind){if(q.authorizedWithKind.Product&&q.authorizedWithKind.Product.length>0){m.add({content:"3DXContent",authorized_objects:q.authorizedWithKind.Product,callback:undefined,behavior:p,isDrop:true})}if(q.authorizedWithKind.Filter&&q.authorizedWithKind.Filter.length>0){m.addFilter({content:"3DXContent",filter_objects:q.authorizedWithKind.Filter,broadcast:true,callback:undefined,behavior:"fromDrop"})}if(q.authorizedWithKind.Change&&q.authorizedWithKind.Change.length>0){if(m.loadChange){m.loadChange({content:"3DXContent",objects:q.authorizedWithKind.Change,callback:undefined,behavior:p})}}}else{m.add({content:"3DXContent",authorized_objects:q.authorized_objects,callback:undefined,behavior:p})}}})}}if(n.dataTransfer.params){l(n.dataTransfer.params)}else{d.retrieveAuthorizedObjects({notifPerObjects:true,displayNotif:false,dnd_event:n,callback:l,version:"2.0"})}return false},dropOnInvite:function(m){this._onDropContent(m);var l=this.options.model.detachedRoots?this.options.model.detachedRoots.length:0;if(this.options.model.getRoots().length===0&&l===0){this.dropInvitContainer.show("drop")}else{this.dropInvitContainer.hide(this.dropInvitContainer.active_invite)}if(this.options.active_view==="treelistview"){this.getPADTreeListView().getManager().getScroller().getContent().removeClassName("wux-ui-state-drag-over")}},_isDroppableInBody:function(){if((sessionStorage.isNotDroppableInBody!==null)&&(sessionStorage.isNotDroppableInBody==="true")){return false}return true}});return k});define("DS/ENXNav/commands/view/_xNavCleanAll",[],function(){var a={execute:function(b){b.xnav_app.empty()}};return a});define("DS/ENXNav/commands/tools/xNavExporter",["i18n!DS/PADUtils/assets/nls/PADUtils.json","i18n!DS/ENXNav/assets/nls/ENXNav.json","UWA/Class","UWA/Class/Options","DS/PADUtils/PADUtilsServices","DS/PADUtils/Utility"],function(m,l,p,o,i,f){var d={TABLE:'<table style="border:1px solid black; border-collapse:collapse;">',TABLE_CLOSE:"</table><br/>",HEADER:'<th style="border:1px solid black; background-color:#A7C942; text-align:left; color:#FFFFFF; font-size:.8em; padding-top:5px; paddingbottom:4px;word-break:break-word;display:table-cell;">',HEADER_CLOSE:"</th>",ROW:"<tr>",ROW_CLOSE:"</tr>",DATA:"<td>",DATA_CLOSE:"</td>"};var n=(function(){var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},x=/[&<>"'\/]/g,z=/[<>\/]/g;function w(A){return y[A]}return function(A,B){return String(A).replace(B?z:x,w)}}());function h(B,y,A){var w=B.length;for(var x=0;x<w;x++){var z=B[x];A(y,z,x)}}function r(x){var y=x.text;if(y===""||y===null||y===undefined){var w="treelistview_customization_"+x.dataIndex;if(UWA.is(m[w])){y=m[w]}else{y=x.dataIndex}}return y}function v(w){return""+w}function k(w){return'"'+w+'"'}function c(z,x){var y=z.options.grid[x];var w=f.convertDateTime(y);return w}function u(w,x){if(w==="tree"){return x.options.label}else{if(UWA.is(t.customizedColumnRenderers[w],"function")){return t.customizedColumnRenderers[w](x)}else{if(UWA.is(x.options.grid[w],"string")){return x.options.grid[w]}else{if(UWA.is(x.options.grid[w],"number")){return v(x.options.grid[w])}else{return""}}}}}function a(x,w,y){var z=[];z.push(v(y.getDepth()));z.push(u("tree",y));h(w,null,function(A,D){var B=D.customisation?D.customisation:D.xnav_options;var C=B.kind;if(C){switch(C){case"date":z.push(c(y,D.dataIndex));break;default:z.push(u(D.dataIndex,y));break}}else{z.push(u(D.dataIndex,y))}});x.rows.push(z)}function b(z,y){var x={columns:[],tables:[]};var w=require("DS/PADUtils/XNavSettings");var B=w.getAvailableColumns();var C=z.options.views.treelistview.options.columns.slice();h(C,null,function(D,H){var E=H.customisation?H.customisation:H.xnav_options;var G=E&&E.exportable?E.exportable.value:false;if(typeof G!=="undefined"&&!G){var F=H.dataIndex;if(y.indexOf(F)===-1){y.push(F)}}});var A={kept:[],tree:null};h(C,A,function(D,E){if(E.dataIndex==="tree"){D.tree=E}else{if(B.available_columns.indexOf(E.dataIndex)!==-1&&(y.indexOf(E.dataIndex)===-1)){D.kept.push(E)}}});x.columns.push(m.export_level);x.columns.push(A.tree.text);h(A.kept,x,function(E,D){E.columns.push(r(D))});h(z.options.model.getRoots(),x,function(F,D){var E=null;if(D.isVisible()){E={rows:[]};F.tables.push(E);a(E,A.kept,D);D.processDescendants({processNode:function(){if(this.isVisible()){a(E,A.kept,this)}}})}});return x}function j(){this._str=""}j.prototype={CRLF:"\r\n",append:function(w){this._str+=w+""},appendCRLF:function(){this._str+=this.CRLF},toString:function(){return this._str}};function s(w){var x=w||{};this._debug=x.debug===true;this._builder=new j()}s.prototype={render:function(w){var x=this;this.appendCRLF();h(w.tables,w.columns,function(z,y){x._builder.append(d.TABLE);x._builder.append("<thead><tr>");x.appendCRLF();h(z,null,function(A,B){x._builder.append(d.HEADER);x._builder.append(B);x._builder.append(d.HEADER_CLOSE)});x.appendCRLF();x._builder.append("</tr></thead>");x._builder.append("<tbody>");h(y.rows,null,function(A,B){x.appendCRLF();x._builder.append(d.ROW);h(B,null,function(C,D){x._builder.append(d.DATA);x._builder.append(D);x._builder.append(d.DATA_CLOSE)});x._builder.append(d.ROW_CLOSE)});x.appendCRLF();x._builder.append("</tbody>");x._builder.append(d.TABLE_CLOSE)});return this._builder.toString()},appendCRLF:function(){if(this._debug){this._builder.appendCRLF()}}};function g(){this._builder=new j()}g.prototype={renderHeaders:function(x){var w=x.length-1;h(x,this,function(z,A,y){z._builder.append(k(A));if(y!==w){z._builder.append(",")}});this._builder.appendCRLF()},renderTables:function(y,x){var w=this;h(y,null,function(z,A){h(A.rows,null,function(B,C){var D=C.length-1;h(C,null,function(E,G,F){w._builder.append(k(G));if(F!==D){w._builder.append(",")}});w._builder.appendCRLF()})})},render:function(w){this._builder.append("\uFEFF");this.renderHeaders(w.columns);this.renderTables(w.tables,w.columns);return this._builder.toString()}};var t={customizedColumnRenderers:{"ds6w:created":function(w){return c(w,"ds6w:created")},"ds6w:modified":function(w){return c(w,"ds6w:modified")},"ds6w:reserved":function(y){var x=y.options.grid["ds6w:reserved"];if(x){var w=(x.toLowerCase()==="true");if(w){return l.tooltip_reserved}else{return l.tooltip_unreserved}}else{return l.tooltip_unreserved}}},options:{columns_to_remove:["tree","find_in_ctx","hide_show","bi_color"],csv_base_file_name:m.csv_base_file_name}};var q=p.singleton({printHtml:function(x){var z=b(x.context,t.options.columns_to_remove.slice());var y=new s();var w=y.render(z);i.printhtml(w)},generateCsv:function(x){if(x.csv_base_file_name){t.options.csv_base_file_name=x.csv_base_file_name}var z=b(x.context,t.options.columns_to_remove.slice());var y=new g();var w=y.render(z);i.downloadfile(w,t.options.csv_base_file_name+(new Date()).toString().split(" ").splice(1,4).join(" ")+".csv","text/csv")},generateRenderStruct:b});return q});define("DS/ENXNav/commands/tools/_xNavColumnParam",[],function(){var a={execute:function(b){require(["DS/PADUtils/views/parametrization/TreeListParametrization","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices"],function(g,c,h){var i,f=false;if(!h.isWebInWinContext()&&c.getSetting("activateTreeOptionsInWidgetBody")===true){var d=require("DS/PADUtils/PADModelEvents");i=d.getModelEvents();f=true}new g({columns:b.tree.options.columns,cmd:b.cmd,viewMode:b.tree.options.viewMode,inMainView:f,modelEvts:i,render_div:".xnav_body",events:{modifyColumRendering:b.tree.modifyColumRendering.bind(b.tree),custoViewChange:b.tree.custoViewChange.bind(b.tree),saveAsTemplate:b.tree.saveAsTemplate.bind(b.tree),reset:b.tree.reset.bind(b.tree),addColumn:b.tree.addColumnCB.bind(b.tree),removeColumn:b.tree.removeColumnCB.bind(b.tree),moveColumn:b.tree.moveColumnCB.bind(b.tree),compactMode:b.tree.compactMode.bind(b.tree)}})})}};return a});define("DS/ENXNav/commands/view/_xNavSelectParent",[],function(){var a={execute:function(g){var d=g.xnav_app;var b=g.model;var f=b.getSelectedNodes();if(f.length){b.prepareBroadcastSelect();b.prepareUpdate();b.unselectAll();b.prepareBroadcastSelect();var c=[];f.forEach(function(i){var h=i.getParent();if(!h.options._isTrueRoot){c.push(h)}});b.multiselect(c);b.pushUpdate();b.pushBroadcastSelect()}}};return a});define("DS/ENXNav/commands/tools/_xNavColumnCusto",[],function(){var a={execute:function(b){require(["DS/PADUtils/views/_PADCustomizeView","DS/PADUtils/PADUtilsServices"],function(d,f){var c=new d({id:b.command_id,cmd:b.cmd,columns:b.tree.options.columns,viewMode:b.tree.options.viewMode,thumbnails:b.tree.options.thumbnails!==undefined?b.tree.options.thumbnails:false,render_div:".xnav_body",events:{modifyColumRendering:b.tree.modifyColumRendering.bind(b.tree),custoViewChange:b.tree.custoViewChange.bind(b.tree),saveAsTemplate:b.tree.saveAsTemplate.bind(b.tree),reset:b.tree.reset.bind(b.tree),customizationWindowChange:function(g){f.customizationWindowChange(g)},compactMode:b.tree.compactMode.bind(b.tree)}});b.tree.addEvent("explicitResetComplete",function(){c.loadRows(b.tree.options,true)})})}};return a});define("DS/ENXNav/models/xNavNodeModel",["DS/Tree/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/ENXNav/assets/nls/ENXNav.json","DS/PADUtils/XNavSettings"],function(g,f,d,a){function c(h){if(!h._getFilterInfo){h._getFilterInfo=b.prototype._getFilterInfo.bind(h);h._getChildrenFilterInfo=b.prototype._getChildrenFilterInfo.bind(h);h._removeChildrenFilterInfo=b.prototype._removeChildrenFilterInfo.bind(h);h.filterInChild=b.prototype.filterInChild.bind(h);h.filterOutChild=b.prototype.filterOutChild.bind(h)}}function b(j){this.options={label:"",icons:[],grid:{},padgrid:{},resourceid:"",type:"",relationid:"",relationtype:"",relationOrder:-1,did:"",relcount:null,isPADHidden:false,padstate:"collapsed",children:[],thumbnail:null,useAsyncPreExpand:true,contextualMenu:[{type:"SeparatorItem"}]};this.options.grid.bi_color="rgba(0, 0, 0, 0)";if(j&&j.grid){this.options.subLabel=j.grid["ds6w:responsible"];this.options.description=j.grid["ds6w:identifier"];this.options.thumbnail=j.thumbnail?j.thumbnail:f.getWebappsAssetUrl("PADUtils","icons/32/I_DefaultThumbnail.png");var i=j.grid["ds6w:reserved"]?j.grid["ds6w:reserved"]:j.padgrid&&j.padgrid["ds6w:reserved"]?j.padgrid["ds6w:reserved"]:null;if(i!==null){var k=(typeof i==="boolean")?i:((i.toUpperCase()==="TRUE")?true:false);if(k){var h=this._isLockedByMe(j);if(h){this.options.statusbarIcons=["key"];this.options.statusbarIconsTooltips=[d.tooltip_reserved]}else{this.options.statusbarIcons=["lock"];this.options.statusbarIconsTooltips=[d.tooltip_reserved]}}else{this.options.statusbarIcons=["lock-open"];this.options.statusbarIconsTooltips=[d.tooltip_unreserved]}}}if(j&&UWA.is(j.relcount)&&j.relcount===0){j.children=null}this.options=UWA.extend(this.options,j);g.call(this,this.options)}b.prototype=Object.create(g.prototype);b.prototype.reverseExpand=function(j){var k=j||{},h={ids:[],relids:[]};if(!k.state||k.state!=="partiallyExpanded"){g.prototype.reverseExpand.call(this)}else{var i=this;while(i&&!i.isRoot()){if(i.options.waiting4validation===true){if(h.ids.indexOf(i.getID())===-1){h.ids.push(i.getID())}if(h.relids.indexOf(i.getRelationID())===-1){h.relids.push(i.getRelationID())}}i=i.getParent();if(!i.isExpanded()){i.setState({state:k.state})}}}return h};b.prototype.getFarthestParent=function(){var h=this;while(h&&!h.isRoot()){h=h.getParent();if(!h){h=this;break}}return h};b.prototype.getOccurencePath=function(j){if(UWA.is(j,"function")){j(this)}if(!this.isRoot()&&this.getParent()){var h=this.getParent();var i=h.getOccurencePath(j);i.push(this.options.relationid);i.push(this.options.resourceid);return i}else{return[this.options.resourceid]}};b.prototype.getOccurencePathWithType=function(){if(!this.isRoot()&&this.getParent()){var h=this.getParent();var i=h.getOccurencePathWithType();i.push({resourceid:this.options.relationid,type:this.options.relationtype});i.push({resourceid:this.options.resourceid,type:this.options.type});return i}else{return[{resourceid:this.options.resourceid,type:this.options.type}]}};b.prototype.getNodeByPath=function(j,q,n,p){if(typeof q!=="number"||q<0){q=0}if(typeof n!=="number"||n<0||n>=j.length){n=j.length-1}if(((this.options.resourceid instanceof Array)&&(this.options.resourceid.indexOf(j[q])>=0))||(this.options.resourceid===j[q])){if(q===n||(!this.isExpanded()&&!this.childComputed&&(p===undefined||p===false))){return this}else{var l=j[q+1];var k=this.getChildren();if(!k||k.length===0){return this}else{var m=null;for(var o=0;o<k.length&&m===null;o++){var h=k[o];if(l===h.options.relationid){m=h}}if(m===null){return this}else{return m.getNodeByPath(j,q+2,n,p)}}}}};b.prototype.getFirstNodeInPath=function(j,p,m){var n={node:null,find_in_ctx_path:[]};if(typeof p!=="number"||p<0){p=0}if(typeof m!=="number"||m<0||m>=j.length){m=j.length-1}if(((this.options.resourceid instanceof Array)&&(this.options.resourceid.indexOf(j[p])>=0))||(this.options.resourceid===j[p])){if(p===m||!this.isExpanded()){n.node=this;if(p!==m){n.find_in_ctx_path=j.slice(p,j.length)}return n}else{var l=j[p+1];var k=this.getChildren();if(k.length===0){n.node=this;n.find_in_ctx_path=j.slice(p,m-p+1);return n}else{var q=true;for(var o=0;o<k.length;o++){var h=k[o];if(l===h.options.relationid){q=false;return h.getFirstNodeInPath(j,p+2,m)}}if(q===true){n.node=this;n.find_in_ctx_path=j.slice(p,m-p+1);return n}}}}};b.prototype.getID=function(){return this.options.resourceid};b.prototype.getRelationID=function(){return this.options.relationid};b.prototype.setRelationID=function(i,h){this.options.relationid=i;this.options.relationtype=h};b.prototype.getNodesById=function(i){var h={listOfFoundNodes:[],};this._getNodesById(i,h);return h.listOfFoundNodes};b.prototype.getChildById=function(l){var k;var j=this.getChildren();if(j){for(var h=0;h<j.length;h++){if(j[h].getID()===l){k=j[h];break}}}return k};b.prototype.getChildByIds=function(m,j){var s;var l=this.getChildren();if(l){for(var n=0;n<l.length;n++){if(m===undefined){if(l[n].getID()===j){s=l[n];break}}else{if(l[n].getRelationID()===m){s=l[n];break}}}}function q(t){var i;if(m===undefined){if(t.getID()===j){i=t}}else{if(t.getRelationID()===m){i=t}}return i}if(s===undefined&&this.options._childrenFilterInfo!==undefined&&this.options._childrenFilterInfo.filteredOutChildren&&this.options._childrenFilterInfo.filteredOutChildren.length>0){var k=this.options._childrenFilterInfo.filteredOutChildren;for(var r=0;r<k.length;r++){var o=k[r];s=q(o);if(s){break}var h=o.getChildren();if(h){for(var p=0;p<h.length;p++){s=q(h[p]);if(s){break}}}}}return s};b.prototype.getNodesByRelId=function(h){var i={listOfFoundNodes:[],foundId:undefined};this._getNodesByRelId(h,i);return i.listOfFoundNodes};b.prototype._removeFilterInfo=function(){delete this.options._filterInfo};b.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo};b.prototype._getFilterInfo=function(h){if(!this.options._filterInfo&&Boolean(h)){this.options._filterInfo={}}return this.options._filterInfo};b.prototype._getChildrenFilterInfo=function(h){if(!this.options._childrenFilterInfo&&Boolean(h)){this.options._childrenFilterInfo={}}return this.options._childrenFilterInfo};b.prototype.filterOut=function(){var h=this.isRoot()?this.getTreeDocument():this.getParent();if(h!==null){c(h);h.filterOutChild(this)}};b.prototype.filterIn=function(h){var l=this._getFilterInfo();if(l&&l.parentBeforeFiltering){var j=l.parentBeforeFiltering;c(j);j.filterInChild(this)}if(Boolean(h)){var i;var k=this._getChildrenFilterInfo();if(k&&k.childrenBeforeFiltering){i=k.childrenBeforeFiltering}else{i=this.getChildren()}if(i){i.forEach(function(m){m.filterIn(h)})}}};b.prototype.filterOutChild=function(l){var h=this.getChildren();if(h.indexOf(l)<0){throw"Not a child"}var k=this._getChildrenFilterInfo(true);if(!k.childrenBeforeFiltering){k.childrenBeforeFiltering=h&&h.length>0?h.slice(0):[];var j={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"};if(UWA.is(this._expandState)){k.expandStateBeforeFiltering=j[this._expandState]}}var i=l._getFilterInfo(true);i.parentBeforeFiltering=this;if(UWA.is(this.removeChild,"function")){this.removeChild(l)}else{this.removeRoot(l,true,true)}if(UWA.is(this.setState,"function")){this.setState({state:k.expandStateBeforeFiltering})}if(!k.filteredOutChildren){k.filteredOutChildren=[]}k.filteredOutChildren.push(l)};b.prototype.filterInChild=function(j){var r=this._getChildrenFilterInfo();if(r){var p=r.childrenBeforeFiltering;if(p){var k=p.indexOf(j);if(k>=0){var o=j._getFilterInfo();if(o&&o.parentBeforeFiltering===this){var s=this.getChildren();var m;if(s){for(var l=0;l<s.length;l++){var n=s[l];var h=p.indexOf(n);if(h>k){m=n;break}}}delete o.parentBeforeFiltering;if(j.options.isRootAttached!==undefined){if(j.options.isRootAttached===true){this.insertBefore(j,m)}}else{this.insertBefore(j,m)}if(UWA.is(this.setState,"function")){this.setState({state:r.expandStateBeforeFiltering})}j._removeFilterInfo();var q=r.filteredOutChildren.indexOf(j);r.filteredOutChildren.splice(q,1);if(r.filteredOutChildren.length===0){this._removeChildrenFilterInfo()}}}}}};b.prototype._getNodesById=function(n,l){var m=false;var h=this.getID();if(h===n){l.listOfFoundNodes.push(this);m=true}else{var k=this.getChildren();if(k){for(var j=0;k&&j<k.length;j++){m=k[j]._getNodesById(n,l)||m}}}return m};b.prototype._getNodesByRelId=function(l,m){var n=this.options.relationid;var h=this.getID();if(n===l){m.listOfFoundNodes.push(this);m.foundId=h}else{if(h!==m.foundId){var k=this.getChildren();if(k){for(var j=0;j<k.length;j++){k[j]._getNodesByRelId(l,m)}}}}};b.prototype.updateFromFetch=function(h,i){this.updateAttributes(h.attributes,i)};b.prototype.updateAttributes=function(i,m){if(!UWA.is(i,"array")||!UWA.is(m.available_columns,"array")){throw new Error("Invalid argument(s)")}var l=this;var k=m.available_columns;var h=m.tree;var j={};i.forEach(function(n){if(UWA.is(n.value)&&UWA.is(n.value.replace,"function")){n.value=n.value.replace(/\\n/g," ")}if(n.name==="ds6w:type"){j.type=n.value}if(n.name===h){j.label=n.value}else{if(n.name==="type_icon_url"){j.icons=[];j.icons.push(n.value)}else{if(n.name==="preview_url"||n.name==="thumbnail_2d"){j.thumbnail=n.value;if(!j.grid){j.grid={}}j.grid.thumbnail="url("+n.value+")"}else{if(k.indexOf(n.name)!==-1){if(!j.grid){j.grid={}}j.grid[n.name]=n.value}}}}});l.updateOptions(j)};b.prototype.updateNlsAttributes=function(k){var i={};for(var h in k){if(!i.grid){i.grid={}}for(var j in k[h]){if(this.options.grid[h]===j){i.grid[h]=k[h][j]}}}i.grid=UWA.extend(this.options.grid,i.grid,true);this.updateOptions(i)};b.prototype.getFirstCommonAncestor=function(l){if(this===l){return l}var k=this.getPath();var n=l.getPath();var h=Math.min(k.length,n.length);var m;for(var i=0;i<h;i++){if(k[i]!==n[i]){m=i;break}}var j;if(m>0){j=k[m-1]}else{if(m===undefined){j=k[h-1]}}return j};b.prototype.isDescendantOf=function(h){var j;if(h instanceof b){j=h.getID()}else{j=h}if(this.getID()===j){return true}if(!this.isRoot()){var i=this.getParent();if(i){return i.isDescendantOf(j)}}return false};b.prototype.getDepth=function(){var i=this;var h=0;while(!i.isRoot()){i=i.getParent();h++}return h};b.prototype.getLeaves=function(){var h=[];this.processDescendants({processNode:function(){if(this.hasChildren()===false){h.push(this)}}});return h};b.prototype.getAttribute=function(h){var i;if(this.options.grid[h]){i=this.options.grid[h]}return i};b.prototype.updateOptions=function(j){if(j.grid){if(!this.options.thumbnail&&!j.thumbnail){j.thumbnail=f.getWebappsAssetUrl("PADUtils","icons/32/I_DefaultThumbnail.png")}j.subLabel=j.grid["ds6w:responsible"]?j.grid["ds6w:responsible"]:this.options.grid&&this.options.grid["ds6w:responsible"]?this.options.grid["ds6w:responsible"]:"";j.description=j.grid["ds6w:identifier"]?j.grid["ds6w:identifier"]:this.options.grid&&this.options.grid["ds6w:identifier"]?this.options.grid["ds6w:identifier"]:"";var i=j.grid["ds6w:reserved"]?j.grid["ds6w:reserved"]:j.padgrid&&j.padgrid["ds6w:reserved"]?j.padgrid["ds6w:reserved"]:null;if(i!==null){var k=(typeof i==="boolean")?i:((i.toUpperCase()==="TRUE")?true:false);if(k){var h=this._isLockedByMe(j);if(h){this.options.statusbarIcons=["key"];this.options.statusbarIconsTooltips=[d.tooltip_reserved]}else{this.options.statusbarIcons=["lock"];this.options.statusbarIconsTooltips=[d.tooltip_reserved]}}else{j.statusbarIcons=["lock-open"];j.statusbarIconsTooltips=[d.tooltip_unreserved]}}}if(this.options.edit){j.edit=this.options.edit}g.prototype.updateOptions.call(this,j)};b.prototype.childValidationChecker=function(){if(this.childValidationCheckerToken===undefined){this.childValidationCheckerToken=null;var h=this;this.childValidationCheckerToken=this.addEventListener("expandStateChange",function(i){if(i.data.state==="expanded"){h.removeEventListener(h.childValidationCheckerToken);h.withTransactionUpdate(function(){var k=h.getChildren().filter(function(l){return l.options.waiting4validation===true?true:false});if(k.length>0){for(var j=0;j<k.length;j++){console.warn("NavNodeModel# Remove node to the unvalidated child "+JSON.stringify(k[j].getOccurencePath()));h.removeChild(k[j])}}})}})}};b.prototype._isLockedByMe=function(i){var h=true;var j=i.grid["ds6w:reservedBy"]?i.grid["ds6w:reservedBy"]:i.padgrid&&i.padgrid["ds6w:reservedBy"]?i.padgrid["ds6w:reservedBy"]:"";var l=i.grid["ds6w:displayName"]?i.grid["ds6w:displayName"]:i.padgrid&&i.padgrid["ds6w:displayName"]?i.padgrid["ds6w:displayName"]:"";var k=require("DS/PADUtils/PADUtilsServices");var m=k.getUserLogin();var n=k.getUserName();var h=true;if(j.trim().length>0){h=(j.toUpperCase().trim()===m.toUpperCase().trim())||false;if(!h){if(j.trim().length!==m.trim().length){h=(j.toUpperCase().trim()===n.toUpperCase().trim())||false}}}else{if(l.trim().length>0){h=(n.toUpperCase().trim()===l.toUpperCase().trim())||false}}return h};b.prototype.childValidationChecker=function(){if(this.childValidationCheckerToken===undefined){this.childValidationCheckerToken=null;var h=this;this.childValidationCheckerToken=this.addEventListener("expandStateChange",function(i){if(i.data.state==="expanded"){h.removeEventListener(h.childValidationCheckerToken);h.withTransactionUpdate(function(){var k=h.getChildren().filter(function(l){return l.options.waiting4validation===true?true:false});if(k.length>0){for(var j=0;j<k.length;j++){console.warn("NavNodeModel# Remove node to the unvalidated child "+JSON.stringify(k[j].getOccurencePath()));h.removeChild(k[j])}}})}})}};b.prototype.getPLMValue=function(h){var j=null;var i=a.getAvailableColumns();if(i.tree===h){j=this.getLabel()}else{if(this.options.grid[h]){j=this.options.grid[h]}else{if(this.options.padgrid&&this.options.padgrid[h]){j=this.options.padgrid[h]}}}return j};return b});define("DS/ENXNav/views/customize_views/_xNavCustoColumns",["UWA/Class","DS/Utilities/Dom","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/WebappsUtils/WebappsUtils","DS/PADUtils/Utility"],function(b,a,g,d,c,i){var j=null;var f=null;var l=(function(){var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"," ":"&nbsp;"},n=/[&<>"'\/ ]/g,p=/[<>\/]/g;function m(q){return o[q]}return function(q,r){return String(q).replace(r?p:n,m)}}());var k=["CATIAV5","SOLIDWORKS","NX","CREO","SOLIDEDGE","ALTIUM","INVENTOR","AUTOCAD","CAAUPSAPP","CadenceAllegro","3DEXPERIENCE"];var h=b.extend({thumbnail_size:80,padcolumn_views:{bi_color:function(n){if(n.manager.getColumnOptions("bi_color").isHidden!==true){if(!n.isHeader){var m=n.cellView.reuseCellContent("padresuable_bi_color");if(m){m.style["background-color"]=n.nodeModel.options.grid.bi_color}}}else{return""}},hide_show:function(n){if(n.manager.getColumnOptions("hide_show").isHidden!==true){if(!n.isHeader){var m=n.cellView.reuseCellContent("padresuable_hideshow");if(m){if(n.nodeModel.options.isPADHidden&&n.nodeModel.options.isPADHidden===true){m.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-eye-off pad_eye_off "}else{m.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-eye pad_eye "}if(g.getSetting("DebugPGPFromServer")===true){m.setAttribute("hsStatusOn",n.nodeModel.options.hsStatusOn)}}}}else{return""}},thumbnail:function(n){if(n.manager.getColumnOptions("thumbnail").isHidden!==true){if(!n.isHeader&&n.nodeModel.options.thumbnail){var m=n.cellView.reuseCellContent("padresuable_thumbnail");if(m){m.style.backgroundImage="url("+n.nodeModel.options.thumbnail+")"}}}else{return""}},find_in_ctx:function(m){if(!m.isHeader){m.cellView.reuseCellContent("padresuable_find_in_ctx")}},instanceMatrix:function(m){if(m.manager.getColumnOptions("instanceMatrix").isHidden!==true){if(!m.isHeader&&m.nodeModel.options.grid.instanceMatrix){m.cellView.reuseCellContent("padresuable_instanceMatrix")}}else{return""}},"ds6w:reserved":function(t){if(!t.isHeader){var o=false,n=t.cellModel.options.value?t.cellModel.options.value:t.nodeModel.options.grid["ds6w:reserved"]?t.nodeModel.options.grid["ds6w:reserved"]:t.nodeModel.options.padgrid["ds6w:reserved"]?t.nodeModel.options.padgrid["ds6w:reserved"]:"";if(n!==undefined){var q=t.nodeModel.options.grid["ds6w:reservedBy"]?t.nodeModel.options.grid["ds6w:reservedBy"]:t.nodeModel.options.padgrid["ds6w:reservedBy"]?t.nodeModel.options.padgrid["ds6w:reservedBy"]:"";var r=t.nodeModel.options.grid["ds6w:displayName"]?t.nodeModel.options.grid["ds6w:displayName"]:t.nodeModel.options.padgrid["ds6w:displayName"]?t.nodeModel.options.padgrid["ds6w:displayName"]:"";o=(typeof n==="boolean")?(n):((n.toUpperCase()==="TRUE")?true:false);var s=t.cellView.reuseCellContent("padresuable_reserved");if(s){if(o){if(j===null){j=d.getUserLogin()}if(f===null){f=d.getUserName()}var m=true;if(q.trim().length>0){m=(q.toUpperCase().trim()===j.toUpperCase().trim())||false;if(!m){if(q.trim().length!==j.trim().length){m=(q.toUpperCase().trim()===f.toUpperCase().trim())||false}}}else{if(r.trim().length>0){m=(f.toUpperCase().trim()===r.toUpperCase().trim())||false}}if(!m){s=t.cellView.reuseCellContent("padresuable_reservedBy_other");if(p===26&&a.hasClass(s,"compact")===false){s.className=s.className+" compact"}else{if(p===38&&a.hasClass(s,"compact")){s.className=s.className.replace(" compact","")}}}else{s.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-key pad_lock"}}else{s.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock-open pad_unlock"}var p=t.manager.getRowHeight();if(p===26&&a.hasClass(s,"compact")===false){s.className=s.className+" compact"}else{if(p===38&&a.hasClass(s,"compact")){s.className=s.className.replace(" compact","")}}}}else{t.cellView.getContent().empty()}}else{t.cellView.getContent().empty()}},"ds6wg:PLMReference.V_isLastVersion":function(n){if(!n.isHeader){var m=n.cellModel.options.value?n.cellModel.options.value:n.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]?n.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]:"";if(m!==undefined&&m!==""){m=(typeof m==="boolean")?(m):((m.toUpperCase()==="TRUE")?true:false);if(m){n.cellView.reuseCellContent("check")}else{n.cellView.reuseCellContent("wrong")}}else{n.cellView.getContent().empty()}}},"ds6w:cadMaster":function(o){if(!o.isHeader){var n=null;if(k.indexOf(o.cellModel.options.value)!==-1){n=o.cellView.reuseCellContent(o.cellModel.options.value)}if(n){var m=o.manager.getRowHeight();if(m===26&&a.hasClass(n,"compact")===false){n.className="cadmaster compact"}else{if(m===38&&a.hasClass(n,"compact")){n.className="cadmaster"}}}else{o.cellView.getContent().setHTML(o.cellModel.options.value)}}},"ds6w:description":function(n){if(!n.isHeader){if(!n.cellModel.options.value){n.cellModel.options.value=""}var m=n.cellModel.options.value;n.cellView.getContent().setHTML(l(m))}},date:function(o){if(!o.isHeader){var n=o.cellModel.options.value;var m=i.convertDateTime(n);o.cellView.getContent().setHTML(m)}},"boolean":function(n){if(!n.isHeader){var m=n.cellModel.options.value;if(m!==undefined&&m!==""){m=(typeof m==="boolean")?(m):((m.toUpperCase()==="TRUE")?true:false);if(m){n.cellView.reuseCellContent("check")}else{n.cellView.reuseCellContent("wrong")}}else{n.cellView.getContent().empty()}}}},cellclickCB:{hide_show:function(n){this.getManager().unselectAll();var m=n.cellModel.getRowID(),o=n.cellView.getParent().getManager().getTreeNodeModelFromRowID(m);if(o.options.isPADHidden!==undefined&&o.options.isPADHidden===true){this._commandProxy.show({paths:[o.getOccurencePath()]})}else{this._commandProxy.hide({paths:[o.getOccurencePath()]})}},find_in_ctx:function(o){var n=this;var m=this;require(["DS/PADUtils/views/PADModalChooser","DS/PADUtils/PADSettingsMgt"],function(z,t){var u="",A=true;if(A!==true&&t.getSetting("accept_all_types")!==true&&t.getSetting("authorized_find_in_ctx_types")){u="(";var q=t.getSetting("authorized_find_in_ctx_types");for(var y=0;y<q.length;y++){var v='"'+q[y]+'"';u+="type:"+v;if(y<q.length-1){u+=" OR "}}u+=")"}var s,x;if(A===true){x=function(C){var B=m.getManager().getTreeNodeModelFromRowID(o.virtualRowID);B.options.findInCtxFTS=C.searchValue;if(B.options.children===null||B.getState()==="noChildren"){B.options.children=[]}B.childComputed=false;B.expand()}}s={precond:u,in_apps_callback:function(E){var D=[];E.forEach(function(G){var F=[];F.push(G.resourceid);D.push(F)});function C(){return D}var B=m.getManager().getTreeNodeModelFromRowID(o.virtualRowID);B.options.partialPreExpand=C;if(B.options.children===null&&B.getState()==="noChildren"){B.options.children=[]}B.expand()}};var r=o.cellView.elements.container.getBoundingClientRect(),w=r.top-(2*r.height),p=r.left+r.width;n.padModalElement=new z({renderTo:m.getContent(),position:{top:w+"px",left:p+"px"},overlay:true,in_apps_search:s,retrieveSearchValue:A,searchValueCallback:x})})},thumbnail:function(m){require(["DS/PADUtils/views/PADThumbnail"],function(n){new n({cellModel:m.cellModel})})},instanceMatrix:function(n){var m=this;require(["DS/PADUtils/views/PADInstanceMatrix"],function(t){var o=n.cellView.getContent().getBoundingClientRect(),s=o.top-65,r=o.left,p=o.bottom,q=o.right;new t({cellModel:n.cellModel,renderTo:m.getContent(),position:{top:s,left:r,bottom:p,right:q}})})}},getColumnViewCusto:function(m){return this.padcolumn_views[m]},getOnCellClickCB:function(m){return this.cellclickCB[m]},registerReusableCellContent:function(){var m=this;this.getManager().registerReusableCellContent({id:"padresuable_bi_color",buildContent:function(){return a.createElement("div",{"class":"bi_color_cell"})}});this.getManager().registerReusableCellContent({id:"padresuable_hideshow",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-eye pad_eye hide_pad_node",style:"font-size: 14px;"})}});this.getManager().registerReusableCellContent({id:"padresuable_find_in_ctx",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search pad_search",style:"font-size: 14px;"})}});this.getManager().registerReusableCellContent({id:"padresuable_thumbnail",buildContent:function(){return a.createElement("div",{"class":"padthumbnail_cell",styles:{height:m.thumbnail_size+"px","background-repeat":"no-repeat","background-size":"contain","background-position":"center center"}})}});this.getManager().registerReusableCellContent({id:"padresuable_instanceMatrix",buildContent:function(){var p=a.createElement("span",{"class":"cadMatrix"}),o=a.createElement("img",{"class":"cadMatrixIcon",src:c.getWebappsAssetUrl("ENXNav","icons/32/I_3DPosition.png"),styles:{height:"26px",width:"26px",}});p.appendChild(o);return p}});this.getManager().registerReusableCellContent({id:"padresuable_reserved",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-key pad_lock"})}});this.getManager().registerReusableCellContent({id:"padresuable_reservedBy_other",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock pad_lock_other"})}});this.getManager().registerReusableCellContent({id:"check",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check"})}});this.getManager().registerReusableCellContent({id:"wrong",buildContent:function(){return a.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x  wux-ui-3ds-wrong"})}});for(var n=0;n<k.length;n++){this.getManager().registerReusableCellContent({id:k[n],buildContent:function(){var p=a.createElement("span",{"class":"cadmaster"}),o=a.createElement("img",{"class":"cadmasterIcon",src:c.getWebappsAssetUrl("ENXNav","icons/cadmasters/I_CADMaster"+this._identifier+".png")});p.appendChild(o);return p}})}}});return h});define("DS/ENXNav/commands/_xNavActionBar",["UWA/Core","DS/ApplicationFrame/ActionBar","DS/RuntimeView/NLSManager","DS/PADUtils/PADContext"],function(d,g,c,f){var b="xnav_ab";function a(i){this.options={action_bar:{file:null,module:null,context:null,language:"en"},renderTo:null,callback:{onactionbarcb:null}};f.set(i.xnav_app);this.options=d.extend(this.options,i,true);c.DEFAULT_LANGUAGE=this.options.action_bar.language;var l=new g(this.options.action_bar);var k=this;if(UWA.is(this.options.callback.onactionbarcb,"function")){if(UWA.is(l.onActionBarDisplay,"function")){var h=l.onActionBarDisplay(function(){l._modelEvents.unsubscribe(h);k.options.callback.onactionbarcb.call(null,"onActionBarDisplay")})}var j=l.onActionBarReady(function(){l._modelEvents.unsubscribe(j);k.options.callback.onactionbarcb.call(null,"onActionBarReady")})}l.elements.container.addClassName("xnav_actionbar");l.inject(this.options.renderTo)}return a});define("DS/ENXNav/commands/FilterDropObjects",["DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt"],function(c,f,d,b){var a=c.extend({execute:function(h){var j=this,i=f.get(),g=i.options.model?i.options.model:i.getPADTreeDocument();require(["DS/PADUtils/PADTypesMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSession"],function(p,o,l,n,k){function m(s){if((s.authorizedWithKind.Product&&s.authorizedWithKind.Product.length===0)&&(s.authorizedWithKind.Filter&&s.authorizedWithKind.Filter.length===0)){l.displayNotification({msg:n.msg_warning_dndnotsupported,eventID:"error"})}else{var r="WITHOUT_CONTEXT";var q=g.getRoots();o.multiTenantMgt(s.authorized_objects,q,function(u){if(!u.isMultiTenant){if(s.authorizedWithKind){if(s.authorizedWithKind.Product&&s.authorizedWithKind.Product.length>0){if(s.authorizedWithKind.Filter==undefined){i.add({content:"3DXContent",authorized_objects:s.authorizedWithKind.Product,loadWithFilter:s.authorizedWithKind.Product.length===1?true:false,callback:function(w){if(s.authorizedWithKind.Product.length===1){if(k.isAuthoring()){i.disableFilterWaiting();l.displayNotification({msg:n.noFilterOnAuthoring,eventID:"warning"})}else{if(w!=="error"){var v=s.authorizedWithKind.Product[0].objectId;require(["DS/ApplicationFrame/CommandsManager"],function(x){var y=x.getCommand("DefineFilter");if(y){y.setOpenFilterNow(v);y.begin()}})}}}},behavior:t})}else{i.add({content:"3DXContent",authorized_objects:s.authorizedWithKind.Product,callback:undefined,behavior:t})}}if(s.authorizedWithKind.Filter&&s.authorizedWithKind.Filter.length>0){var t=s.authorizedWithKind.Filter.length===1?"fromDropOnFilter":undefined;if(s.authorizedWithKind.Filter.length>1){t="fromDrop"}i.addFilter({content:"3DXContent",filter_objects:s.authorizedWithKind.Filter,callback:undefined,behavior:t})}}}})}}p.retrieveAuthorizedObjects({notifPerObjects:true,displayNotif:false,unserializedData:h,callback:m,version:"2.0"})})}});return a});define("DS/ENXNav/commands/tools/xNavFilterCmds",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADContext","DS/PADUtils/PADSession"],function(g,f,c,d,b){var a;if(c.getSetting("activateFUN087933")){a=g.extend({_openFilterPanelNow:false,_selectionId:-1,init:function(i){this._parent(i);var j=this;d.get().getPADTreeDocument().getModelEvents().subscribe({event:"onRemoveRoot"},function(k){if(UWA.is(j.removeFilter,"function")){j.removeFilter({widgetId:j.getAppParams().widgetId,rootIds:[k.data.pid]})}if(d.get()._biFilter){d.get()._biFilter.removeRoot(k.data.pid)}});b.subscribe({event:"authoringStateModified"},function(l){var k=j.hasSelection();if(k&&!l.authored){j.enable()}else{j.disable()}});var h=d.get().getPADTreeDocument().getXSO();h.onChange(function(){if(!h.isEmpty()&&!b.determineAuthoredFlag()){j.enable()}else{j.disable()}})},setOpenFilterNow:function(h){this._openFilterPanelNow=true;this._selectionId=h},hasSelection:function(){var h=this.getSelection();if(h&&h.path.length>0){return true}return false},getAppParams:function(){return{widgetId:f.getWidgetId(),appId:f.getSharedId()}},getSelectorManager:function(){return d.get().getPADTreeDocument().getXSO()||null},getRoots:function(){if(this._openFilterPanelNow!==false){this._openFilterPanelNow=false;var i=[];var k=d.get().options.model.getNodesById(this._selectionId)[0];var h={};if(!k.isRoot()){h=k.getRoot();h.select()}else{h=k}i.push({id:h.getID(),label:h.getLabel(),filtered:h.options.sequence_filter||h.options.config_filter?1:0});return i}else{var j=d.get().getPADTreeDocument().getRoots();var l=j.map(function(m){return{id:m.getID(),label:m.getLabel(),filtered:m.options.sequence_filter||m.options.config_filter?1:0,}});return l}},getSelection:function(){var h=d.get().getPADTreeDocument().getSelectedNodes();var i={path:[],label:[]};h.forEach(function(j){i.path.push(j.getOccurencePath());i.label.push([j.getLabel()])});return i}})}else{a=g.extend({init:function(h){this._parent(h);var i=this;d.get().getPADTreeDocument().getModelEvents().subscribe({event:"onRemoveRoot"},function(j){if(UWA.is(i.removeFilter,"function")){i.removeFilter({widgetId:i.getWidgetId(),rootIds:[j.data.pid]})}if(d.get()._biFilter){d.get()._biFilter.removeRoot(j.data.pid)}});b.subscribe({event:"authoringStateModified"},function(k){var j=i.getAvailability();if(j&&!k.authored){i.enable()}else{i.disable()}})},getWidgetId:function(){var h=f.getWidgetId();return h},getAppParams:function(){return{widgetId:f.getWidgetId(),appId:f.getSharedId()}},getSelectorManager:function(){return d.get().getPADTreeDocument().getXSO()||null},getSelectionId:function(){var k=[];var j=d.get().getPADTreeDocument().getSelectedNodes();var h,m=j.length;for(h=0;h<m;h++){if(j[h].isRoot()){var l={id:j[h].getID(),alias:j[h].getLabel(),filterId:j[h].options.filterId,filterName:j[h].options.filterName};k.push(l)}}return k},getSelectedOccurence:function(){var l=[];var h=this.getSelectorManager();if(false===h.isEmpty()){var n=[];var k=h.get();var m=k.length;for(var j=0;j<m;j++){n.push({path:k[j].getOccurencePath(),alias:k[j].getLabel()})}l.occurences=n}return l},getCommandState:function(){var h=1;if(b.determineAuthoredFlag()){h=0}return h}})}return a});define("DS/ENXNav/commands/view/_xNavSelectInversion",[],function(){var a={execute:function(g){var d=g.xnav_app;var b=g.model;var c=b.getRoots();var f=[];var h=[];if(c.length){b.prepareBroadcastSelect();b.prepareUpdate();c.forEach(function(i){if(i.isSelected()){h.push(i)}else{f.push(i)}i.processDescendants({processNode:function(){if(this.isSelected()){h.push(this)}else{f.push(this)}}})});b.multiunselect(h);b.multiselect(f);b.pushUpdate();b.pushBroadcastSelect()}}};return a});define("DS/ENXNav/commands/xNavActionBarCmds",["DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt"],function(a,h,d,g){var m=["ExpandAll","CollapseAll","ExpandN","SelectChildren","SelectParent","SelectSiblings","SelectLeaves","ReframeOn","RelationIPExplorer","DerivedOutputs"];var l=["ReframeAll","ReframeOn","ToggleOverview","LayoutDown","LayoutRight","LayoutUp","LayoutLeft","SwapThumbState"];var n=["RootPanel","Home","Print","PrintOptions","ExportCSV","ExportCSVOptions","CleanAll"];var f=["Print","PrintOptions","ExportCSV","ExportCSVOptions"];var p=["ExpandAll","CollapseAll","ExpandN"];var k=["Print","ExportCSV","CleanAll"];var o=["ColumnVisibility"];var j=["Print","PrintOptions","ExportCSV","ExportCSVOptions"];function i(q){var r=0;for(var t=0;t<q.length;t++){var u=q[t];var s=u.getChildren();if(s!==null){r++}}return r>0}function b(r,q){return r.indexOf(q)!==-1}var c=a.extend({init:function(r){this._parent(r);var u=this,t=h.get(),q=t.options.model?t.options.model:t.getPADTreeDocument();if(UWA.Utils.Client.Platform.ios&&j.indexOf(this.options.ID)!==-1){this.disable()}else{if(m.indexOf(this.options.ID)!==-1&&l.indexOf(this.options.ID)!==-1){this._check_view(true);t.addEvent("onToggleView",function(){u._check_view(true)});q.getXSO().onPostAdd(function(){u._check_view(true)});q.getXSO().onPostRemove(function(){u._check_view(true)});q.getXSO().onEmpty(function(){u._check_view(true)})}else{if(m.indexOf(this.options.ID)!==-1){this._check_select();q.getXSO().onPostAdd(this._check_select.bind(this));q.getXSO().onPostRemove(this._check_select.bind(this));q.getXSO().onEmpty(this._check_select.bind(this))}else{if(l.indexOf(this.options.ID)!==-1){this._check_view();t.addEvent("onToggleView",this._check_view.bind(this))}else{if(n.indexOf(this.options.ID)!==-1){this._check_roots();var s=this._check_roots.bind(this);q.addEventListener("addChild",s);q.addEventListener("removeChild",s);if(b(f,this.options.ID)){this._check_roots();t.addEvent("onRootsVisibility",this._check_roots.bind(this))}}else{if(k.indexOf(this.options.ID)&&(k.indexOf(this.options.ID)!==-1)){this._parent(r);var t=h.get(),q=t.options.model?t.options.model:t.getPADTreeDocument();this.disable();t.getPADTreeDocument().getModelEvents().subscribe({event:"onRootAdded"},this._check_added_roots.bind(this))}else{if(b(o,this.options.ID)){this._check_if_treeview();if(UWA.is(t.addEvent,"function")){t.addEvent("onToggleView",this._check_if_treeview.bind(this))}}}}}}}}},execute:function(){var s=this,r=h.get(),q=r.options.model?r.options.model:r.getPADTreeDocument();switch(this.options.ID){case"treelistview":case"graphview":case"tileview":case"thumbnailview":require(["DS/ENXNav/commands/_xNavSwitchView"],function(t){t.execute({command_id:s.options.ID,xnav_app:r})});break;case"ExpandAll":require(["DS/ENXNav/commands/view/_xNavExpandAll"],function(t){t.execute({xnav_app:r,model:q})});break;case"CollapseAll":require(["DS/ENXNav/commands/view/_xNavCollapseAll"],function(t){t.execute({xnav_app:r,model:q})});break;case"ExpandN":require(["DS/ENXNav/commands/view/_xNavExpandN"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectAll":require(["DS/ENXNav/commands/view/_xNavSelectAll"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectChildren":require(["DS/ENXNav/commands/view/_xNavSelectChildren"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectInversion":require(["DS/ENXNav/commands/view/_xNavSelectInversion"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectParent":require(["DS/ENXNav/commands/view/_xNavSelectParent"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectSiblings":require(["DS/ENXNav/commands/view/_xNavSelectSiblings"],function(t){t.execute({xnav_app:r,model:q})});break;case"SelectLeaves":require(["DS/ENXNav/commands/view/_xNavSelectLeaves"],function(t){t.execute({xnav_app:r,model:q})});break;case"CleanAll":require(["DS/ENXNav/commands/view/_xNavCleanAll"],function(t){t.execute({xnav_app:r})});break;case"ReframeAll":case"ReframeOn":case"ToggleOverview":case"LayoutDown":case"LayoutRight":case"LayoutUp":case"LayoutLeft":case"SwapThumbState":require(["DS/ENXNav/commands/_xNavGraphCmds"],function(t){t.execute({command_id:s.options.ID,xnav_app:r,model:q})});break;case"RelationIPExplorer":require(["DS/ENXNav/commands/tools/_xNavRelationIPExplorer"],function(t){t.execute({command_id:s.options.ID,xnav_app:r,model:q})});break;case"Print":case"PrintOptions":case"ExportCSV":case"ExportCSVOptions":if(s.options.ID==="Print"&&d.printWindowOpen()){return}else{s.disable()}require(["DS/ENXNav/commands/tools/_xNavExport"],function(t){t.execute({command_id:s.options.ID,cmd:s,xnav_app:r,model:q})});break;case"ColumnVisibility":s.disable();if(g.getSetting("columnParametrization")===true){require(["DS/ENXNav/commands/tools/_xNavColumnParam"],function(u){var t=r.options.views?r.options.views.treelistview:r.getPADTreeListView();u.execute({command_id:s.options.ID,cmd:s,xnav_app:r,tree:t})})}else{require(["DS/ENXNav/commands/tools/_xNavColumnCusto"],function(u){var t=r.options.views?r.options.views.treelistview:r.getPADTreeListView();u.execute({command_id:s.options.ID,cmd:s,xnav_app:r,tree:t})})}break;case"DerivedOutputs":require(["DS/ENXNav/views/xNavDerivedOutputs"],function(v){var t=q.getXSO();var u=t.get()[0];if(u!==undefined){new v({id:s.options.ID,render_div:".xnav_body",title:u.options.display,thumbnail:u.options.thumbnail,resourceid:u.options.resourceid})}});break;case"Find":require(["DS/ENXNav/views/xNavFind"],function(t){new t({context:r,position:"above_action_bar"})});break;case"AddRoot":require(["DS/ENXNav/commands/view/_xNavAddRoot"],function(t){t.execute({command_id:s.options.ID,xnav_app:r})});break;default:throw new Error("Unknown command")}},_check_roots:function(){var q=h.get().getPADTreeDocument().getRoots().length>0;if(q){this.enable()}else{this.disable()}},_check_added_roots:function(s){var r=h.get();var q=r.getPADTreeDocument();if(s.data.nb_root===0){this.disable()}else{this.enable()}},_check_select:function(){var r=h.get().getPADTreeDocument().getXSO().get().length?true:false;if(r===true){var q=h.get().getPADTreeDocument().getXSO().get();if(b(p,this.options.ID)){if(i(q)){this.enable()}else{this.disable()}}else{this.enable()}}else{this.disable()}},_check_view:function(r){if(r===true){var q=h.get().getPADTreeDocument().getXSO().get().length?true:false;if(h.get().options.active_view==="graphview"&&q===true){this.enable()}else{this.disable()}}else{switch(h.get().options.active_view){case"tileview":case"thumbnailview":if(h.get().getPADTreeDocument()._pagerview){h.get().getPADTreeDocument()._pagerview.hide()}break;case"treelistview":case"graphview":if(h.get().getPADTreeDocument()._pagerview){h.get().getPADTreeDocument()._pagerview.show()}break}if(h.get().options.active_view==="graphview"){this.enable()}else{this.disable()}}},_check_if_treeview:function(){var q=h.get().getPADTreeDocument().options.active_view;switch(q){case"treelistview":this.enable();break;case"graphview":case"tileview":case"thumbnailview":this.disable();break}}});return c});define("DS/ENXNav/views/customize_views/_xNavTreeLstParametrization",["UWA/Class","DS/PADUtils/XNavSettings","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADProbes","DS/PADUtils/PADPredicatesNls","DS/Utilities/Utils","DS/UIKIT/Mask","i18n!DS/ENXNav/assets/nls/ENXNav.json","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(c,h,i,k,d,j,g,a,l){function b(n){var m=n.map(function(o){if(o.xnav_options&&o.xnav_options.hardcoded!==true){return o.xnav_options.name}}).filter(function(o){return o!==undefined});return m}var f=c.extend({buildTreeListOpts:function(u,r){var q=this;var s=false;if(!UWA.is(u,"object")){throw new Error("Invalid input parameter")}var n=function(v){v=UWA.extend(h.getSetting("basic_treelistopts"),v);v=q._enrichViews(v);v.shouldDisplayTooltip=q.provideDisplayTooltip.bind(q);d.updateColumnsWithNLS(v.columns,function(w){if(w.status==="success"){v.columns=w.columns}if(!s){var x=b(v.columns);h.updateSettings(x);s=true}r(v)})};var p;if(u.view_customization){p=u.view_customization;var t=p.columns.map(function(v){if(v.xnav_options&&v.xnav_options.hardcoded!==true){return v.xnav_options.name}}).filter(function(v){return v!==undefined});h.updateSettings(t);s=true;for(var o=0;o<p.columns.length;o++){var m=p.columns[o];if(m.xnav_options&&m.xnav_options.layout.styles){q._updateColumnStyles(m.dataIndex,m.xnav_options.layout.styles)}}n(p)}else{p={};h.buildDefaultColumns(function(v){if(v.status==="success"){p.columns=v.columns;p.columns.splice(0,0,{width:5,minWidth:5,maxWidth:5,dataIndex:"bi_color",isDraggable:false,isHidden:true});n(p)}else{throw new Error("buildDefaultColumns failed")}})}},cacheAdditionalColumns:function(p){if(p.additionalColumnsModules){var n=[];for(var m=0;m<p.additionalColumnsModules.length;m++){p.additionalColumnsModules[m].getAdditionalColumnsUX(n)}this.originalAddtionalColumns=[];for(var o=0;o<n.length;o++){this.originalAddtionalColumns.push(UWA.clone(n[o]))}}},addColumnCB:function(n){var m=UWA.is(n,"string")?JSON.parse(n):n;if(this.getManager().getColumnOptions(m.dataIndex)===undefined){m=this._setupCellRequest(m);this.getManager().prepareUpdateView();this.getManager().addColumn({column:m});h.addAvailableColumn(m.dataIndex,true);this.getManager()._setupColumnType(m);this.getManager().pushUpdateView();if(m.dataIndex==="thumbnail"){this.getManager().options.defaultCellHeight=80;this.getManager().syncModel(true,false)}if((m.dataIndex==="ds6w:cadMaster")||(m.dataIndex==="instanceName")){this.getManager().syncModel(true,false)}}},removeColumnCB:function(n){var m=UWA.is(n,"string")?JSON.parse(n):n;if(this.getManager().getColumnOptions(m.dataIndex).dataIndex!==undefined){this.getManager().removeColumn(m.dataIndex);h.removeAvailableColumn(m.dataIndex);if(m.dataIndex==="thumbnail"){this.getManager().options.defaultCellHeight=38;this.getManager().syncModel(true,false)}}},moveColumnCB:function(m){if(m.move2perform){this.getManager().moveColumn(m.move2perform.fromID+1,m.move2perform.toID+1)}},modifyColumRendering:function(r){var o=this;var q=UWA.is(r,"string")?JSON.parse(r):r;var p=o.getManager().getColumnOptions(q.dataIndex);var m=false;if(p){if(q.exportable!==undefined&&q.exportable!==p.xnav_options.exportable.value){p.xnav_options.exportable.value=q.exportable}if(q.columnColor){p.xnav_options.layout.styles=q.columnColor;if(!p.xnav_options.layout.styles){p.xnav_options.layout.styles={}}p.xnav_options.layout.styles.color=q.columnColor.color;p.xnav_options.layout.styles["background-color"]=q.columnColor["background-color"];var n=p.xnav_options.layout.styles;o._updateColumnStyles(p.dataIndex,n)}}},reset:function(p){var o=this;var n=this.getManager();var m=n.options.defaultCellHeight;if(m===80){this.compactMode({viewMode:"comfortable"})}this._clearExistingStyles();this.buildTreeListOpts({},function(q){o.loadColumns(q.columns);for(var r=0;r<q.columns.length;r++){var s={color:"#000000","background-color":"#ffffff"};o._updateColumnStyles(q.columns[r].dataIndex,s)}o.saveCustoView(p)})},updateColumns:function(n){this.loadColumns(n.columns);for(var m=0;m<n.columns.length;m++){if(n.columns[m].xnav_options&&n.columns[m].xnav_options.layout&&n.columns[m].xnav_options.layout.styles){this._updateColumnStyles(n.columns[m].dataIndex,n.columns[m].xnav_options.layout.styles)}}},saveCustoView:function(n){var m=this;this._prepareOptsToStore({onComplete:function(o){var p=n?"onCustoViewChange":"onSaveAsTemplate";m.dispatchEvent(p,o)}})}});return f});define("DS/ENXNav/commands/view/_xNavExpandN",[],function(){var a={execute:function(b){require(["DS/PADUtils/views/PADLevelSel"],function(f){var d=b.model,c=d.getSelectedNodes();new f({events:{onApply:function(g){if(c.length>1){d.expandMultiSelect({nodes2Expand:c,numberOfLevelsToExpand:parseInt(g)})}else{if(c.length===1){c[0].expandNLevels({numberOfLevelsToExpand:parseInt(g)})}}}}})})}};return a});define("DS/ENXNav/views/customize_views/_xNavTreeLstDefinition",["UWA/Class","DS/PADUtils/XNavSettings","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADProbes","DS/PADUtils/PADPredicatesNls","DS/Utilities/Utils","i18n!DS/ENXNav/assets/nls/ENXNav.json","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,h,i,l,c,k,a,m){var f="ds6wg:XP_VPMReference_Ext.";var g=38;function d(s,p,r){var n=s.length;for(var o=0;o<n;o++){var q=s[o];r(p,q,o)}}var j=b.extend({buildTreeListOpts:function(n,q){var o=this;if(!UWA.is(n,"object")){throw new Error("Invalid input parameter")}function p(){var s=o._formatColums();s=o._getLocalColumns(s,{specific_columns:n.specific_columns});s=UWA.extend(UWA.clone(h.getSetting("basic_treelistopts")),s);s=o._mergeWithStoredOpts(n.view_customization,s);s=o._enrichViews(s);var r=s.columns.filter(function(t){return t.xnav_options&&t.xnav_options.titleModified}).reduce(function(u,t){u[t.dataIndex]=t.text;return u},{});s.shouldDisplayTooltip=o.provideDisplayTooltip.bind(o);c.updateColumnsWithNLS(s.columns,function(t){if(t.status==="success"){s.columns=t.columns;d(s.columns,r,function(v,u){if(v[u.dataIndex]){u.text=v[u.dataIndex]}})}q(s)})}if(h.getSetting("available_attr")===undefined||n.explicitReset===true){require(["DS/ENXNav/views/customize_views/_xNavTreeLstDefinitionMgr","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices"],function(w,s,v){var u=UWA.clone(n);u.reset=s.getSetting("enopad_widget_reload");u.padtreelst_def_file=o.padtreelst_def_file;u.tenantId=v.getPlatformId();var t=new w(u);if(n.explicitReset===true){t.clearCache()}var x=function(z){function y(B){var A=[];B.pad_columns.forEach(function(D){var E=D.cv_name.split("/");var C=E[E.length-1];A.push({name:C,dataIndex:D.dataIndex,tree:D.dataIndex==="tree"?true:false,exportable:{lock:D["export"].lock,value:D["export"].value},layout:{removable:D.isRemovable,hidden:D.isHidden?D.isHidden:false,width:D.width?D.width:"auto"},kind:D.kind})});return A}h.setAvailableAttr(y(z.json_response),n.explicitReset);p()};var r=function(){console.error("Error retrieving PADTreeListDefinition: ");var y=h.getSetting("basic_treelistopts");q(y)};t.getTreeListDefinition(x,r)})}else{p()}},cacheAdditionalColumns:function(q){if(q.additionalColumnsModules){var o=[];for(var n=0;n<q.additionalColumnsModules.length;n++){q.additionalColumnsModules[n].getAdditionalColumnsUX(o)}this.originalAddtionalColumns=[];for(var p=0;p<o.length;p++){this.originalAddtionalColumns.push(UWA.clone(o[p]))}}},modifyColumRendering:function(o,p){var n=this;setTimeout(function(){var v=UWA.is(o,"string")?JSON.parse(o):o;var u=n.getManager().getColumnOptions(v.dataIndex);var r=false;if(u){var x=u.text;if(v.headerName&&v.headerName!==x){u.text=v.headerName;if(u.xnav_options){if(p===true){delete u.xnav_options.titleModified}else{u.xnav_options.titleModified=true}}r=true}if(v.isHidden!==undefined&&v.isHidden!==u.isHidden){u.xnav_options.layout.hidden=u.isHidden;if(u.isHidden){n.getManager().showColumn(u.dataIndex)}else{n.getManager().hideColumn(u.dataIndex)}if(u.dataIndex==="thumbnail"){if(u.isHidden){n.getManager().options.defaultCellHeight=38;n.options.thumbnails=false}else{n.getManager().options.defaultCellHeight=80;n.options.thumbnails=true}r=true;var q=n.getDocument();var w=n.getManager()._isPreparingView;var s=n.getManager()._updateCounter;n.getManager().unloadDocument();n.getManager()._syncRowIndexes(true);n.getManager().loadDocument(q);n.getManager()._isPreparingView=w;n.getManager()._updateCounter=s}if(u.dataIndex==="ds6w:reserved"&&v.isHidden===true){r=true}}if(v.exportable!==undefined&&v.exportable!==u.xnav_options.exportable.value){u.xnav_options.exportable.value=v.exportable}if(v.column_color){u.xnav_options.layout.styles=v.column_color;if(!u.xnav_options.layout.styles){u.xnav_options.layout.styles={}}u.xnav_options.layout.styles.color=v.column_color.color;u.xnav_options.layout.styles["background-color"]=v.column_color["background-color"];var t=u.xnav_options.layout.styles;n._updateColumnStyles(u.dataIndex,t)}}if(r){n.getManager().updateView(true)}},0)},reset:function(){if(i.getSetting("readsettingsv2")){this.resetExplicit()}else{this.resetChange()}},resetExplicit:function(){var n=this;this.buildTreeListOpts({view_customization:null,specific_columns:this.original_specific_columns?this.original_specific_columns:null,explicitReset:true,x3dAppId:this.options.x3dAppId},function(p){if(n.options.additionalColumnsModules){for(var o=0;o<n.options.additionalColumnsModules.length;o++){n.options.additionalColumnsModules[o].getAdditionalColumnsUX(p.columns)}}n.loadColumns(p.columns);n.getManager().options.defaultCellHeight=g;n.options.thumbnails=false;for(var q=0;q<p.columns.length;q++){var r={color:"#000000","background-color":"#ffffff"};n._updateColumnStyles(p.columns[q].dataIndex,r)}n.dispatchEvent("explicitResetComplete")})},resetChange:function(){var q=this;var o={};if(q.originalAddtionalColumns){d(q.originalAddtionalColumns,o,function(s,r){s[r.dataIndex]=r})}var p=q._formatColums();p=q._getLocalColumns(p,{specific_columns:q.options.specific_columns});p=UWA.extend(h.getSetting("basic_treelistopts"),p);p=q._enrichViews(p);if(q.options.additionalColumnsModules){for(var n=0;n<q.options.additionalColumnsModules.length;n++){q.options.additionalColumnsModules[n].getAdditionalColumnsUX(p.columns)}}q.getManager().prepareUpdateView();d(p.columns,this,function(t,s){if(s.xnav_options){var v={dataIndex:s.dataIndex,headerName:s.text,isHidden:s.xnav_options.layout.hidden,exportable:s.xnav_options.exportable.value,column_color:{"background-color":"#ffffff",color:"#000000"}};if(o[s.dataIndex]){var r=o[s.dataIndex];v.isHidden=r.xnav_options.layout.hidden;v.headerName=r.text;v.exportable=r.xnav_options.exportable.value}if(s.xnav_options.titleModified){delete s.xnav_options.titleModified}t.modifyColumRendering(v,true);var u=t.getManager().getColumnOptions(v.dataIndex);if(u&&v.columnWidth!==u.width){if(u.xnav_options){u.xnav_options.layout.width=s.xnav_options.layout.width}t.getManager().setColumnWidth(u.dataIndex,s.xnav_options.layout.width)}}});q.getManager().pushUpdateView();if(i.app_context==="enops"){q._permuteColumns(p,function(){q._prepareOptsToStore({onComplete:function(r){q.dispatchEvent("onCustoViewChange",r)}})})}else{q._prepareOptsToStore({onComplete:function(r){q.dispatchEvent("onCustoViewChange",r)}})}},_getLocalColumns:function(s,w){var y;if(w&&w.specific_columns){if(!this.original_specific_columns){this.original_specific_columns=UWA.clone(w.specific_columns)}y=[];var p=Object.getOwnPropertyNames(w.specific_columns);for(var t=0;t<p.length;t++){var u=p[t];if(w.specific_columns[u]){y.push(w.specific_columns[u])}}}else{y=["bi_color","selection","hide_show","find_in_ctx","thumbnail","instanceName","instanceMatrix"]}if(y.indexOf("bi_color")!==-1){s.columns.splice(0,0,{width:5,dataIndex:"bi_color",isDraggable:false,isHidden:true})}if(y.indexOf("selection")!==-1){s.columns.splice(1,0,{width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:true,isHidden:true,xnav_options:{name:"selection",hardcoded:true,exportable:{lock:true,value:false},layout:{removable:true,hidden:true,width:40,minWidth:40,maxWidth:40}}})}if(y.indexOf("hide_show")!==-1){s.columns.splice(2,0,{text:"",width:40,minWidth:40,maxWidth:40,dataIndex:"hide_show",isDraggable:true,isSortable:false,isHidden:false,xnav_options:{name:"hide_show",hardcoded:true,exportable:{lock:true,value:false},layout:{removable:true,hidden:false,width:40,minWidth:40,maxWidth:40}}})}if(y.indexOf("find_in_ctx")!==-1){s.columns.splice(3,0,{text:"",width:40,minWidth:40,maxWidth:40,dataIndex:"find_in_ctx",isDraggable:true,isSortable:false,isHidden:false,xnav_options:{name:"find_in_ctx",hardcoded:true,exportable:{lock:true,value:false},layout:{removable:true,hidden:false,width:40,minWidth:40,maxWidth:40}}})}if(y.indexOf("thumbnail")!==-1){var o=-1;if(w&&w.specific_columns){var x=Object.getOwnPropertyNames(w.specific_columns);for(var r=0;r<x.length;r++){var n=x[r];if(w.specific_columns[n]&&w.specific_columns[n]==="thumbnail"){if(n==="end"){o=s.columns.length-1}else{o=n-1}}}}else{for(var q=0;q<s.columns.length&&o===-1;q++){if(s.columns[q].dataIndex==="tree"){o=q}}}if(o>=0){var v=o+1;if(y.indexOf("instanceName")!==-1){s.columns.splice(v,0,{text:a.columns.instanceName,width:160,minWidth:40,dataIndex:"instanceName",isDraggable:true,isSortable:true,isHidden:false,xnav_options:{name:"instanceName",hardcoded:true,exportable:{lock:false,value:true},layout:{removable:true,hidden:false,width:100,minWidth:40}}});v++;h.addAvailableColumn("instanceName")}if(y.indexOf("instanceMatrix")!==-1){s.columns.splice(v,0,{text:m.instanceMatrix,width:50,minWidth:50,dataIndex:"instanceMatrix",isDraggable:true,isSortable:true,isHidden:false,xnav_options:{name:"instanceMatrix",hardcoded:true,dataIndex:"instanceMatrix",exportable:{lock:false,value:true},layout:{removable:true,hidden:false,width:50,minWidth:50,maxWidth:50}}});v++;h.addAvailableColumn("instanceMatrix")}s.columns.splice(v,0,{width:this.thumbnail_size,dataIndex:"thumbnail",isDraggable:true,isSortable:false,isHidden:true,xnav_options:{name:"thumbnail",hardcoded:true,exportable:{lock:true,value:false},layout:{removable:true,hidden:true,width:this.thumbnail_size}}})}}return s},_formatColums:function(){var q={columns:[]},p=this;var o=h.getSetting("available_attr");var n={that:this,formated_columns:q};d(o,n,function(s,t){var r={dataIndex:t.tree===true?"tree":t.name,isDraggable:true,width:t.layout.width,minWidth:t.layout.minWidth?t.layout.minWidth:10,maxWidth:t.tree===true?undefined:t.layout.maxWidth?t.layout.maxWidth:999,isHidden:t.layout.hidden===true?true:false,xnav_options:UWA.clone(t)};s.formated_columns.columns.push(r)});return q},_mergeWithStoredOpts:function(p,q){var r=this,s={};function v(E,D){var A=[];function x(I){var J={};for(var H=0;H<I.length;H++){J[I[H].dataIndex]=H}return J}var G;if(r.originalAddtionalColumns){G=x(r.originalAddtionalColumns)}else{G={}}var B=x(D);var z=[];for(var F=0;F<E.length;F++){var w=E[F];if(B[w.dataIndex]!==undefined){z.push(w.dataIndex);A.push(n(w,D[B[w.dataIndex]]))}else{if(G[w.dataIndex]!==undefined){A.push(n(w,r.originalAddtionalColumns[G[w.dataIndex]]))}}}var y=D.map(function(H){if(z.indexOf(H.dataIndex)===-1){return H}}).filter(function(H){return H!==undefined});for(var C=0;C<y.length;C++){A.push(y[C])}return A}function n(x,w){if(x.xnav_options){x.xnav_options.exportable.lock=w.xnav_options.exportable.lock;if(w.xnav_options.exportable.lock){x.xnav_options.exportable.value=w.xnav_options.exportable.value}x.xnav_options.layout.removable=w.xnav_options.layout.removable;if(x.xnav_options.layout.styles){r._updateColumnStyles(x.dataIndex,x.xnav_options.layout.styles)}if(x.xnav_options.titleModified){return x}}if(!(x.xnav_options&&x.xnav_options.titleModified===true&&w.text)){x.text=w.text}return x}if(p===null){s=q}else{var t=Object.getOwnPropertyNames(q);for(var o=0;o<t.length;o++){var u=t[o];if(p[u]!==undefined){if(u==="columns"){s.columns=v(p.columns,q.columns)}else{s[u]=p[u]}}else{s[u]=q[u]}}}return s},_permuteColumns:function(p,x){var s=[],v=[];d(this.getManager().getOption("columns"),s,function(B,A){if((A.isInPreference===undefined)||A.isInPreference){B.push(A.dataIndex)}});d(p.columns,v,function(A,B){if((B.isInPreference===undefined||B.isInPreference)){A.push(B.dataIndex)}});if(s.length!==v.length){throw new Error("Incoherent column length")}var n=[];for(var w=0;w<s.length;w++){if(s[w]!==v[w]){var q=s[w];var y=v[w];var z=s.indexOf(v[w]);if(z===-1||z<w){throw new Error("Incoherent dataIndex position for "+v[w])}n.push({fromColumnID:q,toColumnID:y});var o=s[z];s[z]=s[w];s[w]=o}}var r=0,u=this;function t(){if(n.length>0){setTimeout(function(){u.getManager().moveColumn(n[r].fromColumnID,n[r].toColumnID);r++;if(r<n.length){t()}else{if(typeof(x)=="function"){x()}}},50)}else{if(typeof(x)=="function"){x()}}}t()}});return j});define("DS/ENXNav/views/ViewLoader",["UWA/Class","UWA/Promise"],function(b,h){var g={treelistview:"treelistview",graphview:"graphview",tileview:"tileview",thumbnailview:"thumbnailview"};Object.freeze(g);var c=["onDragEnterBlank","onDragOverBlank","onDragEndBlank","onDragLeaveBlank","onDropBlank","onDragStartCell","onDragEnterCell","onDragOverCell","onDragEndCell","onDragLeaveCell","onDropCell","onDragEnterColumnHeader","onDragOverColumnHeader","onDragEndColumnHeader","onDragLeaveColumnHeader","onDropColumnHeader","onDragStartColumnHeader"];var f=["onDragOverGraph","onDropBlankGraph","onDragLeaveGraph"];var a=["onDragEnterBlank","onDragOverBlank","onDragEndBlank","onDragLeaveBlank","onDropBlank","onDragStartCell","onDragEnterCell","onDragOverCell","onDragEndCell","onDragLeaveCell","onDropCell","onDragEnterColumnHeader","onDragOverColumnHeader","onDragEndColumnHeader","onDragLeaveColumnHeader","onDropColumnHeader","onDragStartColumnHeader"];var d=["onDragEnterBlank","onDragOverBlank","onDragEndBlank","onDragLeaveBlank","onDropBlank","onDragStartCell","onDragEnterCell","onDragOverCell","onDragEndCell","onDragLeaveCell","onDropCell","onDragEnterColumnHeader","onDragOverColumnHeader","onDragEndColumnHeader","onDragLeaveColumnHeader","onDropColumnHeader","onDragStartColumnHeader"];var i=b.extend({init:function(j){this.options=j},loadView:function(k,l){var j=this;if(this.options.component.options.views[k]){l();return}else{if(!this.options.component.options.views[g.treelistview]&&k!==g.treelistview){this.loadView(g.treelistview,function(){j.options.component.options.active_view=g.treelistview;j.options.component.toggleView(k);if(l){l()}})}else{this.buildOptions(k,l).then(function(m){j.requireView(k,m,l)})}}},requireView:function(m,j,n){var l=this;var k=this.options.amd[m];require([k],function(o){var p=l.options.component;p.options.views[m]=new o(j);l.postLoad(m);if(m!==g.treelistview){if(n){n()}}})},postLoad:function(l){var k=this.options.component;k.options.views[l].isActiveView=k.options.active_view===l;switch(l){case g.graphview:var j=false;if(k.options.views.graphview.isActiveView){j=true;k.options.views.graphview.setModel(k.options.model)}k.setDnD_onGraph();k.options.isReady.graphview=true;if(j){k.options.views.graphview.reframeAll()}break;case g.treelistview:break;case g.thumbnailview:if(k.options.views.thumbnailview.isActiveView){k.options.views.thumbnailview.setModel(k.options.model)}k.options.isReady.thumbnailview=true;break;case g.tileview:if(k.options.views.tileview.isActiveView){k.options.views.tileview.setModel(k.options.model)}k.options.isReady.tileview=true;break}k.options.model.applyActiveView(l)},buildOptions:function(j,k){switch(j){case g.treelistview:return this._buildTreeListViewOptions(k);break;case g.graphview:return this._buildGraphViewOptions();break;case g.tileview:return this._buildTileViewOptions();break;case g.thumbnailview:return this._buildThumbnailViewOptions();break;default:throw new Error("Invalid View Trying to load");break}},mapCallbacks:function(n,l){var m=this;var k=l;var j={};n.forEach(function(o){if(UWA.is(k.options.views_cb[o],"function")){j[o]=k.options.views_cb[o]}else{if(UWA.is(k[o],"function")){j[o]=k[o].bind(k)}}});return j},_buildTreeListViewOptions:function(k){var j=this;return new h(function(o,n){var m=j.options.component;var l={x3dAppId:j.options.x3dAppId,renderTo:j.options.renderTo};l.active_view=UWA.clone(m.options.active_view);l.isActiveView=l.active_view===g.treelistview?true:false;l.view_customization=m.options.layout.view_customization;l.specific_columns=m.options.layout.specific_columns;if(!UWA.is(m.getOnContextualEvent)){c.push("onContextualMenuReady")}var p=j.mapCallbacks(c,m);if(UWA.is(j.getOnContextualEvent)){opts.onContextualEvent=m.getOnContextualEvent()}l=UWA.extend(l,p,true);if(UWA.is(m.getOnContextualEvent)){l.onContextualEvent=m.getOnContextualEvent()}l.events={onComplete:function(){m.options.views.treelistview=this;if(m.options.active_view==="treelistview"){m.options.views.treelistview.setModel(m.options.model)}m.options.isReady.treelistview=true;if(k){k()}},onCustoViewChange:function(q){m.dispatchEvent("onCustoViewChange",q)},onTenantChange:function(q){m.dispatchEvent("onTenantChange",q)},onSaveAsTemplate:function(q){m.dispatchEvent("onSaveAsTemplate",q)}};if(m.options.additionalColumnsModules){l.additionalColumnsModules=m.options.additionalColumnsModules}o(l)})},_buildGraphViewOptions:function(){var j=this;return new h(function(n,m){var l=j.options.component;var k={x3dAppId:j.options.x3dAppId,renderTo:j.options.renderTo};k.active_view=UWA.clone(l.options.active_view);k.isActiveView=k.active_view==="graphview"?true:false;if(!UWA.is(j.getOnContextualEvent)){f.push("contextCallback");f.push("moreInfoCallback")}var o=j.mapCallbacks(f,l);k=UWA.extend(k,o,true);if(UWA.is(l.getOnContextualEvent)){k.onContextualEvent=l.getOnContextualEvent()}n(k)})},_buildTileViewOptions:function(){var j=this;return new h(function(n,m){var l=j.options.component;var k={x3dAppId:j.options.x3dAppId,renderTo:j.options.renderTo};k.active_view=UWA.clone(l.options.active_view);k.isActiveView=k.active_view==="tileview"?true:false;if(!UWA.is(l.getOnContextualEvent)){a.push("onContextualMenuReady")}var o=j.mapCallbacks(a,l);k=UWA.extend(k,o,true);if(UWA.is(l.getOnContextualEvent)){k.onContextualEvent=l.getOnContextualEvent()}n(k)})},_buildThumbnailViewOptions:function(){var j=this;return new h(function(n,m){var l=j.options.component;var k={x3dAppId:j.options.x3dAppId,renderTo:j.options.renderTo};k.active_view=UWA.clone(l.options.active_view);k.isActiveView=k.active_view==="thumbnailview"?true:false;if(!UWA.is(l.getOnContextualEvent)){d.push("onContextualMenuReady")}var o=j.mapCallbacks(d,l);k=UWA.extend(k,o,true);if(UWA.is(l.getOnContextualEvent)){k.onContextualEvent=l.getOnContextualEvent()}n(k)})}});return i});define("DS/ENXNav/models/_xNavCVParser",["i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/ENXNav/models/xNavNodeModel","DS/PADUtils/XNavSettings","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADProbes","DS/PADUtils/PADCommandProxy","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADPredicatesNls","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(s,C,h,p,g,q,d,r,x,v){var j={COLLAPSED:{state:"collapsed"},NO_CHILDREN:{state:"noChildren"},PARTIALLY_EXPANDED:{state:"partiallyExpanded"},EXPANDED:{state:"expanded"}};Object.freeze(j);var y="ds6w:Document";var z,n;var o=q.create();var D={},E={};function u(J,I){var H=J.indexOf(I);if(H!==-1){J.splice(H,1)}}function k(K,J){if(K instanceof Array&&J instanceof Array){var H=K.length;if(H===J.length){for(var I=0;I<H;I++){if(K[I]!==J[I]){return false}}return true}else{return false}}else{return false}}function G(L,J){var K=false;if(UWA.is(L,"object")&&UWA.is(J,"array")){var I=0,H=J.length,M=L.getID();do{if(M===J[I].getID()){K=true}I++}while(K===false&&I<H)}return K}function t(I,J,H){var P=false;if(UWA.is(I,"object")&&UWA.is(J,"array")){var O=0,N=J.length,K=false;do{if(I.isDescendantOf(J[O])){if(H===-1){P=true}else{var L=I.getOccurencePath();var M=L.indexOf(J[O].getID());if((L.length-M)%2<=H){P=true}}K=true}O++}while(K===false&&O<N)}return P}function c(L,K){var I={};var M=L||{};var J=Object.getOwnPropertyNames(M);for(var H=0;H<J.length;H++){if(K[J[H]]){if(K[J[H]]!==L[J[H]]){I[J[H]]=L[J[H]]}}else{I[J[H]]=L[J[H]]}}return I}function A(J,Q,M){var O=false;var H=null;var N={};if(Q.label!==J.options.label){N.label=Q.label;var K=require("DS/PADUtils/PADSettingsMgt");if(K.getSetting("tree_order_in_label")===true){N.label+=("(treeorder="+Q.relationOrder+")")}O=true}if(!k(Q.icons,J.options.icons)){N.icons=Q.icons;O=true}if(Q.thumbnail!==J.options.thumbnail){N.thumbnail=Q.thumbnail;O=true}if(Q.display!==J.options.display){N.display=Q.display;O=true}if(Q.type!==J.options.type){N.type=Q.type;O=true}if(Q.relcount!==J.options.relcount){N.relcount=Q.relcount;O=true;var I=J.getChildren();if(N.relcount===0&&I!==null){N.children=null;H=j.NO_CHILDREN}if(N.relcount>0&&I===null){N.children=[];H=j.COLLAPSED}}if(H===null&&J.getState()==="expanding"&&!(M&&M.changeState===false)){H=j.EXPANDED}if(Q.relationOrder!==J.options.relationOrder){N.relationOrder=Q.relationOrder;O=true}if(UWA.is(Q.isPADHidden,"boolean")&&UWA.is(Q.isPADHiddenBackEnd,"boolean")&&(Q.isPADHidden!==J.options.isPADHidden||J.options.isPADHidden!==Q.isPADHiddenBackEnd)){N.isPADHidden=Q.isPADHidden;N.isPADHiddenBackEnd=Q.isPADHiddenBackEnd;N.isPADHiddenBackEndReference=Q.isPADHiddenBackEndReference;N.isPADHiddenBackEndInstance=Q.isPADHiddenBackEndInstance;N.isPADHiddenBackEndOcc=Q.isPADHiddenBackEndOcc;N.hsStatusOn=Q.hsStatusOn;O=true}if(J.isRoot()){if(!Q.grid){Q.grid={}}if(!Q.grid.instanceName){Q.grid.instanceName=""}}var L=c(Q.grid,J.options.grid);if(!UWA.equals(L,{})){N.grid=L;O=true}if(Q.padgrid){var P=c(Q.padgrid,J.options.padgrid);if(!UWA.equals(P,{})){N.padgrid=P;O=true}}if(O){if(M&&M.deleteTempOptions===true){delete J.options.waiting4validation;delete J.options.alternText}J.updateOptions(N);J._manageNLS=true;if(M&&M.needRequestNls){if(J.isVisible()){x.updateNLS(J)}}}if(H){J.setState(H)}}function f(V,Q,P,M,ac,ab,W,R){var I=V.getID();if(ab===true){m(V)}if(P.nodes[I]){var O=UWA.clone(P.nodes[I]);if(UWA.is(O.isPADHiddenBackEnd,"boolean")){O.isPADHidden=O.isPADHiddenBackEnd;O.isPADHiddenBackEnd=O.isPADHiddenBackEnd;O.isPADHiddenBackEndReference=O.isPADHiddenBackEnd;O.hsStatusOn="reference";V.options.isPADHidden=undefined}var Z=V.getRelationID();var T=P.nodes[Z];if(T){O.relationOrder=T.relationOrder;O.grid.instanceName=T.label;if(T.instanceMatrix){O.grid.instanceMatrix=T.instanceMatrix}if(UWA.is(T.isPADHiddenBackEnd,"boolean")){O.isPADHidden=T.isPADHiddenBackEnd;O.isPADHiddenBackEnd=T.isPADHiddenBackEnd;O.isPADHiddenBackEndInstance=T.isPADHiddenBackEnd;O.hsStatusOn="instance";V.options.isPADHidden=undefined}}if(R&&R.needRequestNls){A(V,O,R)}else{A(V,O)}var L=V.getChildren();for(var J=0;L&&J<L.length;J++){var Y=L[J].getRelationID();var H=W&&P.nodes[Y]&&P.nodes[Y].did?W[P.nodes[I].did][P.nodes[Y].did]:undefined;if(R&&R.needRequestNls){f(L[J],V,P,M,ac,ab,H,R)}else{f(L[J],V,P,M,ac,ab,H)}}if(typeof W!=="undefined"&&UWA.is(W[P.nodes[I].did].isPADHiddenBackEndOcc,"boolean")){V.options.hsStatusOn="occurence";V.options.isPADHidden=W[P.nodes[I].did].isPADHiddenBackEndOcc;V.options.isPADHiddenBackEnd=W[P.nodes[I].did].isPADHiddenBackEndOcc;V.options.isPADHiddenBackEndOcc=W[P.nodes[I].did].isPADHiddenBackEndOcc}}else{var S=false;var N;for(var aa=0;aa<M.length&&S===false;aa++){S=M[aa].node.isDescendantOf(V);if(S){N=M[aa].root}}if(S===true){var K=V.getLeaves();if(K.length){for(var U=0;U<K.length;U++){var X=K[U];Q=X.getParent();Q.removeChild(X);ac.push({node:Q,root:N})}}else{Q.removeChild(V)}}}}function m(H){if(H.getState()===j.EXPANDED.state){H.setState(j.PARTIALLY_EXPANDED)}}function i(H){if(H.toLowerCase()==="true"){return true}else{return false}}function F(J,M,H,N,L){if(H===M.length){J[N]=L}else{if(J[M[H]]){F(J[M[H]],M,H+1,N,L)}else{var K=Object.getOwnPropertyNames(J);for(var I=0;I<K.length;I++){if(UWA.is(J[K[I]],"object")){F(J[K[I]],M,H,N,L)}}}}}function B(I,J,H){if(I[J]){I[J].push(H)}else{I[J]=[];I[J].push(H)}}function a(M){var O=[];var P=[];var T={};var J=M.length;for(var N=0;N<J;N++){var U=M[N];var L=U.attributes;var Q=L.length;for(var K=0;K<Q;K++){var I=L[K];var H=I.name;var S=H.split("/");H=S[S.length-1];if(H==="ds6w:type"||H==="type"){var R=I.value;if(P.indexOf(R)===-1){P.push(R);O.push({type:R,displayType:I.dispValue});B(T,R,U)}else{B(T,R,U)}}}}return{types:O,resultsByType:T}}function b(H){var K=0;for(var I=0;I<H.length;I++){var J=H[I];if(J.options.grid.globaltype!==y){K++}}return K}function w(I,H){H._collapseRepDuringExpandAll=true;for(var J=0;J<I.length;J++){var K=I[J];if(K.getNumberOfChildren()===1){var L=b(K.getChildren());if(L===0){K.collapse()}}}delete H._collapseRepDuringExpandAll;H._colorize3D(H)}function l(H,J){if(H===undefined){return}var I=Date.now();if((I-J)>H){throw {type:"TimeoutError"}}}D.buildStructure=function(L){var O={nodes:{},did_to_resourceid:{},structure:{}};var I=[],N=[],H=[];L.results.forEach(function(S){if(S.attributes){var W={};S.attributes.forEach(function(Z){if(Z.name==="resourceid"||Z.name==="physicalid"){W.resourceid=Z.value}else{if(Z.name==="did"){W.did=Z.value}}});O.nodes[W.resourceid]=W;if(W.did){O.did_to_resourceid[W.did]=W.resourceid}}if(S.path){var X=S.path,V=X.length;var T=X[0];if(V===3){var U=X[1],Y=X[2];if(N.indexOf(Y)===-1){N.push(Y)}}if(H.indexOf(T)===-1){H.push(T)}I.push(X)}});var Q=[],R=[],P={};try{H.forEach(function(S){if(N.length===0||N.indexOf(S)===-1){Q.push(S)}else{R.push(S)}P[S]={children:[]};I.forEach(function(T){if(T.length===3&&S===T[0]){P[S].children.push(T)}})})}catch(M){console.error(M)}var K={};try{var J=function(S,W){var T=W[1],Y=W[2];var V=O.did_to_resourceid[T],X=O.did_to_resourceid[Y];if(S&&S[V]===undefined){S[V]={};S[V][X]={};if(P[Y]){var U=P[Y].children;if(U){U.forEach(function(Z){J(S[V][X],Z)})}}}};Q.forEach(function(S){var U=O.did_to_resourceid[S];var V={};var T=P[S].children;T.forEach(function(W){J(V,W)});K[U]=V})}catch(M){console.error(M)}return K};D.parse_expand=function(L,N,K,M){var J=g.createProbe("parse_expand");var H={nodes:{},did_to_resourceid:{},structure:{}};var I=false;L.forEach(function(W){if(W.attributes){var P=E.parse_attributes(W.attributes,N);H.nodes[P.resourceid]=P;if(UWA.is(P.did)){H.did_to_resourceid[P.did]=P.resourceid}}else{if(W.path){var V;if(K===false){V=W.path.length;var T=function(X){if(X){var Z=Object.getOwnPropertyNames(X);for(var Y=0;Y<Z.length;Y++){if(H.nodes[Z[Y]]){X[H.nodes[Z[Y]].did]=X[Z[Y]];delete X[Z[Y]];if(UWA.is(X[H.nodes[Z[Y]].did],"object")){T(X[H.nodes[Z[Y]].did])}if(X.order===undefined){X.order=[]}X.order.push(H.nodes[Z[Y]].did)}}if(X.order===undefined){X.order=[]}}};T(M);H.structure=M}else{var U=H.structure;V=W.path.length;if(Math.abs(V%2)===1){W.path.forEach(function(Y,X){if(!U.hasOwnProperty(Y)){U[Y]={};if(V===X+1){U[Y].pathLeaf=true}if(Math.abs(X%2)===0){U[Y].order=[]}}if(U.order&&U.order.indexOf(Y)===-1){U.order.push(Y)}U=U[Y]})}else{I=true}}}else{if(W.icon__default_thumbnail_2d){W.icon__default_thumbnail_2d.forEach(function(X){X.did.forEach(function(Y){var Z=H.did_to_resourceid[Y];var aa=H.nodes[Z];if(!aa.icons||aa.icons.length===0){if(!aa.icons){aa.icons=[]}aa.icons.push(X.icon)}if(!aa.thumbnail||aa.thumbnail.length===0){aa.thumbnail=X.thumbnail_2d}})})}else{if(W.pgp_overload){var S=Object.getOwnPropertyNames(W.pgp_overload);for(var Q=0;Q<S.length;Q++){var R=S[Q];R=R.replace(/[\[\]']+/g,"");var O=R.split(",").map(function(X){return X.trim()});if(W.pgp_overload[S[Q]]["PGPShowExtension.V_PGP_Show"]){F(H.structure,O,0,"isPADHiddenBackEndOcc",!i(W.pgp_overload[S[Q]]["PGPShowExtension.V_PGP_Show"]))}}}}}}});J.end();return H};E.parse_attributes=function(I,M){var J=require("DS/PADUtils/PADSettingsMgt");if(z===undefined){z=J.getSetting("pgpFromServer")===true?true:J.getSetting("supportPgpBasedOnDescription")===true?true:false;if(z){n=J.getSetting("pgpFromServer")?["bo.pgpshowextension.v_pgp_show","ro.pgpshowextension.v_pgp_show"]:["ro.plminstance.V_description"]}}var L={};I.forEach(function(N){if(N.name==="type"){N.name="ds6w:type"}else{if(N.name==="owner"){N.name="ds6w:responsible"}else{var P=N.name.split("/");N.name=P[P.length-1]}}if(UWA.is(N.value)&&UWA.is(N.value.replace,"function")){N.value=N.value.replace(/\n/g," ")}if(N.name==="ds6w:type"){L.type=N.value}if(N.name==="resourceid"||N.name==="physicalid"){L.resourceid=N.value}else{if(N.name==="did"){L.did=N.value}else{if(N.name==="TreeOrder"||N.name==="ro.plminstance.V_treeorder"){L.relationOrder=parseFloat(N.value);if(isNaN(L.relationOrder)){L.relationOrder=-1}}else{if(N.name==="matrixtxt"){if(r.checkNotIdentity(N.value)){L.instanceMatrix=N.value}}else{if(N.name==="type_icon_url"){if(!L.icons){L.icons=[]}L.icons.push(N.value)}else{if(N.name==="preview_url"||N.name==="thumbnail_2d"){L.thumbnail=N.value;if(!L.grid){L.grid={}}L.grid.thumbnail="url("+N.value+")"}else{if(N.name==="svg"){var O=N.value;if(O&&O.length>0){if(!L.grid){L.grid={}}if(!L.grid.svg){L.grid.svg=[]}L.grid.svg.push({format:N.name,id:N.value})}}else{if(N.name==="relcount"){L.relcount=parseInt(N.value);if(L.relcount===0){L.children=null}}else{if(M&&N.name===M.tree){L.label=N.value;L.display=L.label}else{if(M&&M.available_columns&&M.available_columns.indexOf(N.name)!==-1){if(!L.grid){L.grid={}}L.grid[N.name]=N.value}else{if(!L.padgrid){L.padgrid={}}if(z&&n.indexOf(N.name.toLowerCase())!==-1){L.isPADHiddenBackEnd=!i(N.value)}else{L.padgrid[N.name]=N.dispValue?N.dispValue:N.value}}}}}}}}}}}if(J.getSetting("activateFUN085903")){if(N.name==="ds6w:globalType"){if(!L.grid){L.grid={}}L.grid.globaltype=N.value}}});if(!L.relationOrder){L.relationOrder=-1}var K=h.getAdditionalColumns();for(var H=0;H<K.length;H++){if(L.grid&&L.grid[K[H]]===undefined){L.grid[K[H]]=""}}return L};E.process={fetch:function(K){var H=g.createProbe("process_fetch");if(!UWA.is(K.treedocument,"object")||!UWA.is(K.response,"object")){throw new Error("Invalid input parameters")}var J=require("DS/PADUtils/PADSettingsMgt");var I=function(O,M){var N;for(var L=0;L<M.length;L++){if(O===M[L].rootId&&M[L].filter){N=M[L].filter;N.filterId=M[L].filterId;N.filterName=M[L].filterName;break}}return UWA.is(N,"string")?JSON.parse(N):N};K.treedocument.withTransactionUpdate(function(){var N=[];var M=[];var L=a(K.response.results);if(L.types.length===0){console.error("No types to validate")}p.isTypesAuthorized(L.types,function(O){O.forEach(function(Q){var P=L.resultsByType[Q];if(UWA.is(P,"array")){P.forEach(function(R){if(!UWA.is(R.attributes,"array")){if(K.onFailure){K.onFailure(new Error("Invalid result format - attributes isn't an array"))}return}var W=E.parse_attributes(R.attributes,h.getAvailableColumns());if(UWA.is(W.isPADHiddenBackEnd,"boolean")){W.isPADHidden=W.isPADHiddenBackEnd;W.isPADHiddenBackEndReference=W.isPADHiddenBackEnd;W.hsStatusOn="reference"}var V=new C(W);if(K.rootsWithFilters){var U=I(V.getID(),K.rootsWithFilters);if(U){V.options.config_filter=U.config_filter;V.options.sequence_filter=U.sequence_filter;V.options.filterId=U.filterId;V.options.filterName=U.filterName}}if(K.config_filter&&K.config_filter[W.resourceid]){V.options.config_filter=K.config_filter[W.resourceid]}if(V.options.config_filter||V.options.sequence_filter){var T={bottomRight:"filter"};if(J.getURLParameter("badgeV1")==="true"){T={bottomRight:d.getWebappsAssetUrl("PADUtils","icons/32/I_PADFilterBadge.png")}}V.setBadges(T)}K.treedocument.addRoot(V);N.push(V);var S=K.treedocument.getRoots().length;if(UWA.is(K.treedocument.detachedRoots,"array")){S=S+K.treedocument.detachedRoots.length}K.treedocument.getModelEvents().publish({event:"onRootAdded",data:{nb_root:S,added_node:V}});x.updateNLS(V)})}});if(K.onComplete){K.onComplete({toselect:N,hidden:M})}},true)})},expand:function(Q){if(!UWA.is(Q.treedocument,"object")||(!UWA.is(Q.root_nodes,"array")&&Q.root2Create!==true)||!UWA.is(Q.response,"object")){throw new Error("Invalid input parameters")}if(!UWA.is(Q.response.results,"array")){throw new Error("Invalid response format - results should be an array")}Q.starting_from_root=(Q.starting_from_root===undefined)?true:Q.starting_from_root;var K=Date.now();l(Q.parseTimeout,K);var P=[];var O=[];var M=require("DS/PADUtils/PADSettingsMgt");var H=(M.getSetting("activateFUN085903")&&(Q.expand_level===-1||Q.expand_level>1));var I=M.getSetting("alwaysExpandPath")===true||M.getSetting("pgpFromServer");var L=(Q.security_counts_HTML&&Q.security_counts_HTML===true);var J=g.createProbe("transactionWithUpdate_expand");var N=Q.selectPathLeaf;Q.treedocument.withTransactionUpdate(function(){var Y;if(Q.mode==="refresh"&&Q.response.full_path===false){if(Q.needNewStructure){Y=D.buildStructure(Q.response)}else{Y={};var S=function(ar,au){if(ar[au.getRelationID()]===undefined){ar[au.getRelationID()]={};ar[au.getRelationID()][au.getID()]={};var at=au.getChildren();for(var aq=0;at&&aq<at.length;aq++){S(ar[au.getRelationID()][au.getID()],at[aq])}}};var ai=Q.treedocument.getRoots();for(var aa=0;aa<ai.length;aa++){Y[ai[aa].getID()]={};var W=ai[aa].getChildren();for(var V=0;W&&V<W.length;V++){S(Y[ai[aa].getID()],W[V])}}}}var al=D.parse_expand(Q.response.results,h.getAvailableColumns(),Q.response.full_path,Y);l(Q.parseTimeout,K);var X="expanded",ac=false,Z=false,U=false,ae=false,am=Q.expand_level,ab;switch(Q.mode){case"find_in_ctx":X="partiallyExpanded";ac=true;am=-1;ab=[];H=false;break;case"insert":X="partiallyExpanded";Z=true;N=typeof N==="boolean"?N:true;break;case"refresh":am=-1;U=true;H=false;break;case"filter":ae=true;H=false;break}var ap=function(at){var aq=[];for(var au=0;Q.root_nodes&&au<Q.root_nodes.length;au++){if(Q.root_nodes[au].getID()===at){aq=[Q.root_nodes[au]];break}else{var ar=Q.root_nodes[au].getNodesById(at);if(ar!==undefined&&ar.length>0){aq=aq.concat(ar)}}}return aq};var af=function(aR,aD,aM,a9){var aE=[],az=aD.getChildren(),ay=U&&az!==null?aE.concat(az):undefined,av=[],bc=false;l(Q.parseTimeout,K);if(aR.pathLeaf===true){if(N){aD.select()}if(UWA.is(Q.addedPaths,"function")){ab.push(aD.getOccurencePath())}}var aY=aR.order;if(aY.length>0){var aL=-1,aZ=[],at;if(az&&az.length>0){for(at=0;at<az.length;at++){aZ.push(az[at].options.relationOrder);if(az[at].options.relationOrder>aL){aL=az[at].options.relationOrder}}}if(aL===-1){bc=true}var aJ=aD.hasChildren();if(aJ===false&&aD.options._childrenFilterInfo&&aD.options._childrenFilterInfo.filteredOutChildren.length){aJ=true}for(at=0;at<aY.length;at++){var aG=aY[at];if(al.did_to_resourceid[aG]!==undefined){var ar=al.did_to_resourceid[aG];var a5=al.nodes[ar].type;var a3=al.nodes[ar].relationOrder;var a6=al.nodes[ar];var aB=Object.getOwnPropertyNames(aR[aG])[0];var a0=al.did_to_resourceid[aB];var aW=null;if(aJ){aW=aD.getChildByIds(ar,a0)}var bb=false;if(!UWA.is(aW,"object")){bb=true;var aO=UWA.clone(al.nodes[a0]);aO.relationid=ar;aO.relationtype=a5;aO.relationOrder=a3;aO.grid.instanceName=a6.label;if(a6.instanceMatrix){aO.grid.instanceMatrix=a6.instanceMatrix}if(UWA.is(aO.isPADHiddenBackEnd,"boolean")){aO.isPADHidden=aO.isPADHiddenBackEnd;aO.isPADHiddenBackEndReference=aO.isPADHiddenBackEnd;aO.hsStatusOn="reference"}if(UWA.is(a6.isPADHiddenBackEnd,"boolean")){aO.isPADHidden=a6.isPADHiddenBackEnd;aO.isPADHiddenBackEndInstance=a6.isPADHiddenBackEnd;aO.hsStatusOn="instance"}var aT=require("DS/PADUtils/PADSettingsMgt");if(aT.getSetting("tree_order_in_label")===true){aO.label+=("(treeorder="+a3+")")}if(H){if(aO.grid.globaltype===y){O.push(aD)}}aW=new C(aO);if(a3>=aL){aD.addChild(aW);aL=a3;aZ.push(a3)}else{var ax=null;var aF=aD.getChildren();if(aF){for(var be=0,bf=aF.length;be<bf;be++){if(aZ[be]>a3){ax=aF[be];aZ.splice(be,0,a3);break}}}aD.insertBefore(aW,ax)}if(bc===true){av.push(aW)}aW._manageNLS=true}else{if(U===true||aW.options.waiting4validation===true){var bh=UWA.clone(al.nodes[a0]);bh.relationOrder=a3;bh.grid.instanceName=a6.label;bh.grid.instanceMatrix=undefined;if(a6.instanceMatrix){bh.grid.instanceMatrix=a6.instanceMatrix}var aQ=false;if(UWA.is(bh.isPADHiddenBackEnd,"boolean")){bh.isPADHidden=bh.isPADHiddenBackEnd;bh.isPADHiddenBackEndReference=bh.isPADHiddenBackEnd;bh.hsStatusOn="reference";aQ=true}if(UWA.is(a6.isPADHiddenBackEnd,"boolean")){bh.isPADHidden=a6.isPADHiddenBackEnd;bh.isPADHiddenBackEndInstance=a6.isPADHiddenBackEnd;bh.hsStatusOn="instance";aQ=true}if(aW.options.isPADHidden!==undefined){bh.isPADHidden=aW.options.isPADHidden;aQ=true}if(aQ===false){bh.isPADHidden=undefined;bh.isPADHiddenBackEnd=undefined;bh.isPADHiddenBackEndReference=undefined;bh.isPADHiddenBackEndInstance=undefined;bh.hsStatusOn=undefined}delete aW.options.waiting4validation;delete aW.options.alternText;var aw;if(I===true&&G(aW,Q.realExpandedNodes)){aw={changeState:false}}A(aW,bh,aw);if(aW.options.isPADHidden===true){o.hide({paths:[aW.getOccurencePath()]})}av.push(aW);if(aW.getState()==="noChildren"||(aW.getState()==="expanded"&&((aW.options.children&&aW.options.children.length===0)||aW.options.children===null))){aW.setState({state:"collapsed"});aW.options.children=[]}}if(ay){u(ay,aW)}if(H){if(aW.options.grid.globaltype===y){O.push(aD)}}}var aN=a9===-1?a9:a9-1;if(((aN>0)||(aN===-1))&&(bb||aW.getTreeDocument())){af(aR[aG][aB],aW,aM,aN)}else{if(Z){aW.select()}}}else{console.error("Invalid CV id ["+aG+"]")}}var au=G(aD,Q.realExpandedNodes);var aS=t(aD,Q.realExpandedNodes,aM);if(ac||Z){aD.childComputed=false}else{if(I===true&&au===false&&aS===false&&aD.getRoot().getBadges().bottomRight!=="filter"){aD.childComputed=false}else{aD.childComputed=true}}if(U!==true){if(I===true){if(au||aS||Z||ac){aD.setState({state:X});aD.options.padstate=X}}else{aD.setState({state:X});aD.options.padstate=X}}}else{if(U!==true){var aH=aD.getDepth();if(aM&&(aM===-1||aM>aH)){if(ac||Z){aD.childComputed=false;aD.select()}else{if(I===true){if(aM===-1){aD.childComputed=true;aD.options.children=null;aD.setState({state:"noChildren"});aD.options.padstate="noChildren";aD._expandState="noExpandState"}}else{aD.childComputed=true;aD.options.children=null;aD.setState({state:"noChildren"});aD.options.padstate="noChildren";if(aH===0||aM===-1){aD._expandState="noExpandState"}}}}else{if(aD.options.relcount!==null&&aD.options.relcount===0){aD.setState({state:"noChildren"});aD.options.padstate="noChildren";aD.childComputed=true;aD.options.children=null;if(ac||Z){aD.select()}}}}}if(ay!==undefined&&ay!==null&&ay.length>0){ay.forEach(function(bi){if(bi!==null){aD.removeChild(bi)}})}if(av.length>0){var bd=false;var a4=Q.noCheckOrder;if(!a4){for(var ba=0;ba<av.length;ba++){var aV=av[ba];var a1=aV.getParent();var aX=a1.getChildren();for(var aC=1;aC<aX.length;aC++){var aK=aX[aC-1];var aI=aX[aC];if(aK.options.relationOrder>aI.options.relationOrder){bd=true;console.warn("Wrong order between "+aK.getLabel()+" with order "+aK.options.relationOrder+" and "+aI.getLabel()+" with order "+aI.options.relationOrder);break}}}}if(bd){for(var aA=0;aA<av.length;aA++){var bg=av[aA];var a2=bg.getParent();var a7=bg.getBrothers();var aF=a2.getChildren();if(aF.length>1){for(var a8=0;a8<a7.length;a8++){if(a7[a8].options.relationOrder>bg.options.relationOrder){var aq=aF.indexOf(bg);var aU=aF.indexOf(a7[a8]);if(aU<aq){var aP=a2.removeChild(bg);a2.insertBefore(aP,a7[a8]);break}}}}}}}if(UWA.is(aR.isPADHiddenBackEndOcc,"boolean")){aD.options.hsStatusOn="occurence";aD.options.isPADHidden=aR.isPADHiddenBackEndOcc;aD.options.isPADHiddenBackEndOcc=aR.isPADHiddenBackEndOcc}};var ah=Object.getOwnPropertyNames(al.structure);var ak=UWA.clone(Q.root_nodes?Q.root_nodes:[],false);var ad=g.createProbe("treat_expand");if(ah.length>0){for(var R=0;R<ah.length;R++){var ao=ah[R];if(al.did_to_resourceid.hasOwnProperty(ao)){var T=ap(al.did_to_resourceid[ao]);if(T.length===0&&Q.root2Create===true){var aj=al.nodes[al.did_to_resourceid[ao]];if(UWA.is(aj.isPADHiddenBackEnd,"boolean")){aj.isPADHidden=aj.isPADHiddenBackEnd;aj.isPADHiddenBackEndReference=aj.isPADHiddenBackEnd;aj.hsStatusOn="reference"}var an=new C(aj);Q.treedocument.addRoot(an);an._manageNLS=true;var ag=Q.treedocument.getRoots().length;if(UWA.is(Q.treedocument.detachedRoots,"array")){ag=ag+Q.treedocument.detachedRoots.length}Q.treedocument.getModelEvents().publish({event:"onRootAdded",data:{nb_root:ag,added_node:an}});T.push(an)}if(T.length!==0){T.forEach(function(at){if(at!==undefined){var ar=ak.indexOf(at);if(ar>-1){ak.splice(ar,1)}var au=al.nodes[al.did_to_resourceid[ao]];if(UWA.is(au.isPADHiddenBackEnd,"boolean")){au.isPADHidden=au.isPADHiddenBackEnd;au.isPADHiddenBackEndReference=au.isPADHiddenBackEnd;au.hsStatusOn="reference"}if(U===true){delete au.relationOrder}var aq=al.structure[ao];af(aq,at,am,am);var av;if(I===true&&G(at,Q.realExpandedNodes)){av={changeState:false}}A(at,au,av);if(U===true){if(at.getState()==="noChildren"||(at.getState()==="expanded"&&((at.options.children&&at.options.children.length===0)||at.options.children===null))){at.setState({state:"collapsed"});at.options.children=[]}x.updateNLS(at)}}});if(H){w(O,Q.treedocument)}if(UWA.is(Q.addedPaths,"function")){Q.addedPaths(ab)}if(UWA.is(Q.hideToggleNodes,"function")){Q.hideToggleNodes(P)}}else{console.error("Invalid root id: "+ao)}}}}ad.end()});J.end()},insert_temporary_branches:function(O){if(!UWA.is(O.treedocument,"object")||!UWA.is(O.branches,"array")){throw new Error("Invalid input parameters")}var M=[],I=[],J=[],P=[],N=[],L=O.treedocument,H=O.node_state?O.node_state:"partiallyExpanded",Q=O.branches;var K=require("DS/PADUtils/PADSettingsMgt");L.withTransactionUpdate(function(){Q.forEach(function(af){var Y=null,V=O.treedocument.getRoots(),ah=O.treedocument.getDetachedRoots(),Z,W=0;for(Z=0;Z<V.length&&Y===null;Z++){if(af[0]===V[Z].getID()){P.push(af[0]);Y=V[Z];var aa=Y.getNodeByPath(af,undefined,undefined,true);if(aa){Y=aa;W=af.indexOf(Y.getID())}}}for(Z=0;Z<ah.length&&Y===null;Z++){if(af[0]===ah[Z].getID()){P.push(af[0]);Y=ah[Z];var T=Y.getNodeByPath(af,undefined,undefined,true);if(T){Y=T;W=af.indexOf(Y.getID());if(O.temporary_root===true){var ai=require("DS/PADUtils/views/PADAlert");ai.displayNotification({msg:s.detachRootFound,eventID:"info"})}}}}if(O.temporary_root===true&&Y===null){var R={resourceid:af[0],label:v.loadingText,icons:[d.getWebappsAssetUrl("ENXNav","icons/32/loading22x22.gif")],thumbnail:d.getWebappsAssetUrl("ENXNav","icons/32/loading.gif"),alternText:v.loadingText,waiting4validation:true};Y=new C(R);if(O.config_filter&&O.config_filter[af[0]]){Y.options.config_filter=O.config_filter[af[0]]}if(Y.options.config_filter||Y.options.sequence_filter){var S={bottomRight:"filter"};if(K.getURLParameter("badgeV1")==="true"){S={bottomRight:d.getWebappsAssetUrl("PADUtils","icons/32/I_PADFilterBadge.png")}}Y.setBadges(S)}L.addRoot(Y);if(M.indexOf(af[0])===-1){M.push(af[0])}var ae=L.getRoots().length;if(UWA.is(L.detachedRoots,"array")){ae=ae+L.detachedRoots.length}L.getModelEvents().publish({event:"onRootAdded",data:{nb_root:ae,added_node:Y}})}if(Y){if(Y.getID()===af[af.length-1]){if(O.forceCollapsed!==true&&Y.getRoot()!==null){var aj=Y.reverseExpand({state:H});if(aj.ids.length){M=M.concat(aj.ids)}if(aj.relids.length){N=N.concat(aj.relids)}}}else{for(var ac=W+1;ac<af.length;ac+=2){var ad=af[ac],X=af[ac+1];var ag={resourceid:X,relationid:ad,label:v.loadingText,icons:[d.getWebappsAssetUrl("ENXNav","icons/32/loading22x22.gif")],thumbnail:d.getWebappsAssetUrl("ENXNav","icons/32/loading.gif"),alternText:v.loadingText,waiting4validation:true};var U=new C(ag);var ab=Y.getState();Y.addChild(U);if(ab==="collapsed"){if(H!==ab){Y.setState({state:H});Y.options.padstate=H}Y.childValidationChecker()}else{if(ab==="partiallyExpanded"){Y.setState({state:ab});Y.options.padstate=ab;if(I.indexOf(X)===-1){I.push(X)}if(J.indexOf(ad)===-1){J.push(ad)}}}Y=U;if(M.indexOf(X)===-1){M.push(X)}if(N.indexOf(ad)===-1){N.push(ad)}}}}})});return{ids_to_fetch:M,relationids:N,rootsAlreadyLoaded:P,visibleNodesIds:I,visibleNodesRelIds:J}},refresh_nodes:function(J){if(!UWA.is(J.treedocument,"object")||!UWA.is(J.response,"object")||!UWA.is(J.refresh_parameters,"object")){throw new Error("Invalid input parameters")}var I=[],K=[];var L=function(O,N){var P=E.parse_attributes(N.attributes,h.getAvailableColumns());if(UWA.is(J.treedocument.filterAttributesForUpdate,"function")){P=J.treedocument.filterAttributesForUpdate({node:O,node_opts:P})}if(P&&P.relcount===0){P.children=null}return P};var H=require("DS/PADUtils/PADSettingsMgt");var M=(J.security_counts_HTML&&J.security_counts_HTML===true);J.treedocument.withTransactionUpdate(function(){J.response.results.forEach(function(N){var T="";for(var P=0;P<N.attributes.length;P++){var S=N.attributes[P];if(S.name==="resourceid"){T=S.value;break}}if(T===""){throw new Error("Resourceid not found in fetch result for "+JSON.stringify(N))}if(J.refresh_parameters.created&&J.refresh_parameters.created.indexOf(T)!==-1){var R=E.parse_attributes(N.attributes,h.getAvailableColumns());var Q=new C(R);J.treedocument.addRoot(Q);x.updateNLS(Q);var O=J.treedocument.getRoots().length;if(UWA.is(J.treedocument.detachedRoots,"array")){O=O+J.treedocument.detachedRoots.length}J.treedocument.getModelEvents().publish({event:"onRootAdded",data:{nb_root:J.treedocument.getRoots().length,added_node:Q}});K.push(Q);I.push(Q.getID())}else{if(J.refresh_parameters.modified&&(J.refresh_parameters.modified.indexOf(T)!==-1||J.ids_modified.indexOf(T)!==-1)){J.treedocument.getRoots().forEach(function(W){var V=W.getNodesById(T);V.forEach(function(X){X.updateOptions(L(X,N));x.updateNLS(X);if(X.options.children===null){X.setState({state:"noChildren"})}K.push(X)})});var U=J.treedocument.searchRootById(T);if(U){U.updateOptions(L(U,N));x.updateNLS(U);if(U.options.relcount===0){U.setState({state:"noChildren"})}J.treedocument.getModelEvents().publish({event:"onRootAdded",data:{nb_root:J.treedocument.getRoots().length,added_node:U}});K.push(U)}}else{if(J.refresh_parameters.relationids&&J.refresh_parameters.relationids.indexOf(T)!==-1){J.treedocument.getRoots().forEach(function(W){var V=W.getNodesByRelId(T);V.forEach(function(Y){var Z=E.parse_attributes(N.attributes,h.getAvailableColumns());var ae=Y.getLabel();if(H.getSetting("tree_order_in_label")===true){ae+=("(treeorder="+Z.relationOrder+")")}Y.updateOptions({label:ae,relationOrder:Z.relationOrder});x.updateNLS(Y);var ag=Y.getParent();var ad=Y.getBrothers();var X=ag.getChildren();if(X.length>1){for(var af=0;af<ad.length;af++){if(ad[af].options.relationOrder>Y.options.relationOrder){var aa=X.indexOf(Y);var ac=X.indexOf(ad[af]);if(ac<aa){var ab=ag.removeChild(Y);ag.insertBefore(ab,ad[af]);break}}}}K.push(Y)})})}}}})});if(K.length){J.treedocument.fillAttributesAsync4VisibleNodes(K)}return I},validateAndUpdateBranches:function(J){if(!UWA.is(J.treedocument,"object")||!UWA.is(J.response,"object")){throw new Error("Invalid input parameters")}if(!UWA.is(J.response.results,"array")){throw new Error("Invalid response format - results should be an array")}var K=-1;var H=g.createProbe("transactionWithUpdate_validateBranch");var I=J.selectPathLeaf;var L=J.forcePartiallyExpanded;J.treedocument.withTransactionUpdate(function(){var M=D.parse_expand(J.response.results,h.getAvailableColumns(),J.response.full_path);var S=function(X){var V=null,Z=J.treedocument.getRoots(),U=J.treedocument.getDetachedRoots();for(var Y=0;Y<Z.length;Y++){if(Z[Y].getID()===X){V=[Z[Y]];break}}for(var W=0;W<U.length&&V===null;W++){if(U[W].getID()===X){V=[U[W]];break}}return V};var N=function(aq,at,av){var an=[],Y=at.getChildren(),ad=Y!==null?an.concat(Y):undefined;if(aq.pathLeaf===true){if(I){at.select()}}var ah=aq.order;if(ah.length>0){var ap=-1,aa=[];for(var ax=0;Y!==null&&ax<Y.length;ax++){aa.push(Y[ax].options.relationOrder);if(Y[ax].options.relationOrder>ap){ap=Y[ax].options.relationOrder}}for(var X=0;X<ah.length;X++){var ay=ah[X];if(M.did_to_resourceid.hasOwnProperty(ay)){var ak=M.did_to_resourceid[ay];var ab=M.nodes[ak].type;var V=M.nodes[ak].relationOrder;var au=M.nodes[ak];var aw=Object.getOwnPropertyNames(aq[ay])[0];var aj=M.did_to_resourceid[aw];var ao=at.getChildByIds(ak,aj);if(!UWA.is(ao,"object")){console.error("All nodes should have been created");break}else{var al=UWA.clone(M.nodes[aj]);al.grid.instanceName=au.label;if(au.instanceMatrix){al.grid.instanceMatrix=au.instanceMatrix}if(UWA.is(al.isPADHiddenBackEnd,"boolean")){al.isPADHidden=al.isPADHiddenBackEnd;al.isPADHiddenBackEndReference=al.isPADHiddenBackEnd;al.hsStatusOn="reference"}if(UWA.is(au.isPADHiddenBackEnd,"boolean")){al.isPADHidden=au.isPADHiddenBackEnd;al.isPADHiddenBackEndInstance=au.isPADHiddenBackEnd;al.hsStatusOn="instance"}A(ao,al,{deleteTempOptions:true});if(ao.isVisible()){x.updateNLS(ao)}if(L===true&&ao.getState()==="expanded"){ao.setState({state:"partiallyExpanded"})}var ai=ao.getLabel();var af=require("DS/PADUtils/PADSettingsMgt");if(af.getSetting("tree_order_in_label")===true){ai+=("(treeorder="+opts_2_modified.relationOrder+")")}ao.updateOptions({label:ai,relationOrder:V});var ae=ao.getParent();var ag=ao.getBrothers();var ac=ae.getChildren();if(ac.length>1){for(var am=0;am<ag.length;am++){if(ag[am].options.relationOrder>ao.options.relationOrder){var U=ac.indexOf(ao);var ar=ac.indexOf(ag[am]);if(ar<U){var Z=ae.removeChild(ao);ae.insertBefore(Z,ag[am]);break}}}}var W=-1;N(aq[ay][aw],ao,W)}}else{console.error("Invalid CV id ["+ay+"]")}}}if(UWA.is(aq.isPADHiddenBackEndOcc,"boolean")){at.options.hsStatusOn="occurence";at.options.isPADHidden=aq.isPADHiddenBackEndOcc}};var R=Object.getOwnPropertyNames(M.structure);var T=g.createProbe("treat_expand");if(R.length>0){for(var Q=0;Q<R.length;Q++){var P=R[Q];if(M.did_to_resourceid.hasOwnProperty(P)){var O=S(M.did_to_resourceid[P]);if(O!==undefined){O.forEach(function(W){if(W!==undefined){var X=M.nodes[M.did_to_resourceid[P]];if(UWA.is(X.isPADHiddenBackEnd,"boolean")){X.isPADHidden=X.isPADHiddenBackEnd;X.isPADHiddenBackEndReference=X.isPADHiddenBackEnd;X.hsStatusOn="reference"}A(W,X,{deleteTempOptions:true});x.updateNLS(W);if(L===true&&W.getState()==="expanded"){W.setState({state:"partiallyExpanded"})}var U=J.treedocument.getRoots().length;if(UWA.is(J.treedocument.detachedRoots,"array")){U=U+J.treedocument.detachedRoots.length}J.treedocument.getModelEvents().publish({event:"onRootAdded",data:{nb_root:U,added_node:W}});var V=M.structure[P];N(V,W,K)}})}else{console.error("Invalid root id: "+P)}}}}T.end()});H.end()},validateMultiExpand:function(J){if(!UWA.is(J.treedocument,"object")||!UWA.is(J.response,"object")){throw new Error("Invalid input parameters")}if(!UWA.is(J.response.results,"array")){throw new Error("Invalid response format - results should be an array")}var K=-1;var I=J.selectPathLeaf;var L=J.forcePartiallyExpanded;var H={nodes2relaunch:[]};J.treedocument.withTransactionUpdate(function(){var T;if(J.forcePartiallyExpanded===false){T={};var N=function(ag,ai){if(ag[ai.getRelationID()]===undefined){ag[ai.getRelationID()]={};ag[ai.getRelationID()][ai.getID()]={};var ah=ai.getChildren();for(var af=0;ah&&af<ah.length;af++){N(ag[ai.getRelationID()][ai.getID()],ah[af])}}};var aa=J.treedocument.getRoots();for(var U=0;U<aa.length;U++){T[aa[U].getID()]={};var S=aa[U].getChildren();for(var R=0;S&&R<S.length;R++){N(T[aa[U].getID()],S[R])}}}var ae=D.parse_expand(J.response.results,h.getAvailableColumns(),J.response.full_path,T);var aa=J.treedocument.getRoots();for(var X=0;X<aa.length;X++){var Z=aa[X],Y=Z.getID();if(ae.nodes[Y]){var W=ae.nodes[Y];if(UWA.is(W.isPADHiddenBackEnd,"boolean")){W.isPADHidden=W.isPADHiddenBackEnd;W.isPADHiddenBackEnd=W.isPADHiddenBackEnd;W.isPADHiddenBackEndReference=W.isPADHiddenBackEnd;W.hsStatusOn="reference"}var ac={needRequestNls:true};A(Z,W,ac);if(L===true){m(Z)}var S=Z.getChildren();if(S){S=S.slice();for(var O=0;S&&O<S.length;O++){var ab=ae.structure[ae.nodes[Y].did];var ad=S[O].getRelationID();var M=ab&&ae.nodes[ad]&&ae.nodes[ad].did?ab[ae.nodes[ad].did]:undefined;f(S[O],Z,ae,J.treatedNodes,H.nodes2relaunch,L,M,ac)}}}else{var P=true;for(var Q=0;Q<J.treatedNodes.length&&P;Q++){if(J.treatedNodes[Q].root.getID()===Z.getID()){if(J.treatedNodes[Q].node.getID()===Z.getID()){J.treedocument.removeRoot(Z);break}else{var V=J.treatedNodes[Q].node.getParent();if(V){V.removeChild(J.treatedNodes[Q].node);H.nodes2relaunch.push({node:V,root:Z})}}}}}}J.onComplete(H)})}};return E});define("DS/ENXNav/views/customize_views/_xNavTreeLstCommon",["UWA/Class","DS/PADUtils/XNavSettings","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADProbes","DS/PADUtils/PADPredicatesNls","DS/PADUtils/Utility","DS/Utilities/Utils","i18n!DS/ENXNav/assets/nls/ENXNav.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/ENXNav/utils/xNavCustoStorageOptim"],function(b,h,i,m,c,k,l,a,o,j){function d(v,s,u){var q=v.length;for(var r=0;r<q;r++){var t=v[r];u(s,t,r)}}function n(u,s){var q=u.length;for(var r=0;r<q;r++){var t=u[r];if(s(t)){return{item:t,index:r}}}return null}var g="xnav_custom_styles";function f(){var r;var q=document.head;var t=q.querySelector("#"+g);if(!t){var s=document.createElement("style");s.type="text/css";s.id=g;q.appendChild(s);r=s.sheet}else{r=t.sheet}return r}var p=b.extend({provideDisplayTooltip:function(x){var z="";if(x.isHeader){switch(x.dataIndex){case"bi_color":return{longHelp:o.padcustomizeview_color_header};case"ds6w:reserved":case"hide_show":case"find_in_ctx":case"instanceName":return{longHelp:a.columns[x.dataIndex]};default:var v=x.dataIndex;if(x.dataIndex==="tree"){v=h.getAvailableColumns().tree}var y="treelistview_customization_"+v;if(UWA.is(o[y])){return{longHelp:o[y]}}else{if(x.model&&x.model.options&&UWA.is(x.model.options.value,"string")){return{longHelp:x.model.options.value}}else{if(x.nodeModel&&UWA.is(x.nodeModel,"string")){return{longHelp:x.nodeModel}}else{if(x.nodeModel&&x.nodeModel.options&&x.nodeModel.options.grid&&x.nodeModel.options.grid[x.dataIndex]){return{longHelp:x.nodeModel.options.grid[x.dataIndex]}}else{return{longHelp:x.dataIndex}}}}}break}}else{switch(x.dataIndex){case"tree":z=x.nodeModel.options.display;break;case"selection":z="";break;case"find_in_ctx":z=o.treelistview_customization_find_in_ctx;break;case"hide_show":if(x.nodeModel.options.isPADHidden===true){z=o.show_cmd}else{z=o.hide_cmd}if(i.getSetting("DebugPGPFromServer")===true){z+="<br>";z+="Status from server:["+x.nodeModel.options.hsStatusOn+"]<br>";if(x.nodeModel.options.hsStatusOn!=="none"&&x.nodeModel.options.hsStatusOn!==undefined){z+="Hide Server reference status:["+x.nodeModel.options.isPADHiddenBackEndReference+"]<br>";z+="Hide Server instance status:["+x.nodeModel.options.isPADHiddenBackEndInstance+"]<br>";z+="Hide Server occurence status:["+x.nodeModel.options.isPADHiddenBackEndOcc+"]<br>"}}break;case"ds6w:reserved":var q=false;if(x.nodeModel.options.grid[x.dataIndex]){q=(x.nodeModel.options.grid[x.dataIndex].toLowerCase()==="true")}if(q){z=a.tooltip_reserved}else{z=a.tooltip_unreserved}break;case"thumbnail":z=a.tooltip_thumbnail;break;case"svg":z=a.tooltip_svg;break;case"ds6w:created":case"ds6w:modified":var r=x.cellModel.options.value||x.cellModel.options.oldValue;z=k.convertDateTime(r);break;case"isLastMinorRevision":if(x.nodeModel&&x.nodeModel.options&&x.nodeModel.options.grid&&x.nodeModel.options.grid[x.dataIndex]!==undefined){var u=(typeof x.nodeModel.options.grid[x.dataIndex]==="boolean")?(x.nodeModel.options.grid[x.dataIndex]):((x.nodeModel.options.grid[x.dataIndex].toUpperCase()==="TRUE")?true:false);z=(!u).toString().toUpperCase()}else{z=""}break;default:var s=true;if(this.options.additionalColumnsModules){z=null;for(var w=0;w<this.options.additionalColumnsModules.length&&z===null;w++){if(this.options.additionalColumnsModules[w].provideDisplayTooltip){z=this.options.additionalColumnsModules[w].provideDisplayTooltip(x);s=false}}}if(s||z===null){if(x.nodeModel&&x.nodeModel.options&&x.nodeModel.options.grid&&x.nodeModel.options.grid[x.dataIndex]){z=x.nodeModel.options.grid[x.dataIndex];if(x.manager.getColumnOptions(x.dataIndex)){if(x.manager.getColumnOptions(x.dataIndex).xnav_options){var t=x.manager.getColumnOptions(x.dataIndex).xnav_options.kind;if(t&&t==="date"){z=k.convertDateTime(z)}}}}else{z=""}}break}if(z&&typeof(z)==="string"){if(z.toLowerCase()==="true"){z=a.tooltip_true}if(z.toLowerCase()==="false"){z=a.tooltip_false}}return{longHelp:z}}},compactMode:function(u){var t=this;var r=this.getManager();if(u.viewMode==="comfortable"){r.options.defaultCellHeight=38}else{if(u.viewMode==="compact"){r.options.defaultCellHeight=26}else{return}}t.options.viewMode=u.viewMode;var q=t.getDocument();var v=r._isPreparingView;var s=r._updateCounter;r.unloadDocument();r._syncRowIndexes(true);r.loadDocument(q);r._isPreparingView=v;r._updateCounter=s;r.updateView(true);t._prepareOptsToStore({onComplete:function(w){t.dispatchEvent("onCustoViewChange",w)}})},initializePreferencesMgt:function(){var s=this;var r=this.getManager();var t=function(u){s._storeColumns=true};var q=function(u){var v=r.getColumnWidth(u.columnID);if(v!==u.width){s._storeColumns=true}};r.onReady(function(){r.onColumnWidthUpdate(q);r.onMoveColumn(t);r.onPostUpdateView(function(){if(s._storeColumns){s._prepareOptsToStore({onComplete:function(u){s._storeColumns=false;s.dispatchEvent("onCustoViewChange",u)}})}});s._prepareOptsToStore({onComplete:function(u){s.dispatchEvent("onCustoViewChange",u)}})})},custoViewChange:function(){var q=this;l.debounce(q._prepareOptsToStore({onComplete:function(r){q.dispatchEvent("onCustoViewChange",r)}}),500)},saveAsTemplate:function(){var q=this;l.debounce(q._prepareOptsToStore({onComplete:function(r){q.dispatchEvent("onSaveAsTemplate",r)}}),500)},_prepareOptsToStore:function(t){var q={viewMode:this.options.viewMode,defaultCellHeight:this.getManager().options.defaultCellHeight,columns:[]};var s={};d(this.options.columns,q,function(v,u){var w=Object.getOwnPropertyNames(u);var x={};d(w,x,function(y,z){if(z==="_typeRepFactory"){return}if(!UWA.is(u[z],"function")){y[z]=u[z]}});if(u.xnav_options&&u.xnav_options.titleModified){s[u.dataIndex]=true}v.columns.push(x)});var r=j.convertCusto4Preference(q,s);t.onComplete(r)},_enrichViews:function(r){var q=this;r.columns.forEach(function(s){s=q._setupCellRequest(s)});return r},_setupCellRequest:function(s,r){var u=this;if(s.dataIndex==="ds6w:created"||s.dataIndex==="ds6w:modified"){if(!s.xnav_options){s.xnav_options={}}s.xnav_options.kind="date"}else{var v=u.getColumnViewCusto(s.dataIndex);if(UWA.is(v,"function")){s.onCellRequest=v}}if(s.onCellRequest===undefined&&s.xnav_options&&s.xnav_options.kind){switch(s.xnav_options.kind){case"date":var q=u.getColumnViewCusto("date");if(UWA.is(q,"function")){s.onCellRequest=q}s.sortFunction=function(z,y){var w;try{w=new Date(z.options.grid[s.dataIndex])>new Date(y.options.grid[s.dataIndex])?1:(new Date(z.options.grid[s.dataIndex])<new Date(y.options.grid[s.dataIndex]))?-1:0}catch(x){w=z.options.grid[s.dataIndex]<y.options.grid[s.dataIndex]?-1:1}finally{return w}};break;case"boolean":var t=u.getColumnViewCusto("boolean");if(UWA.is(t,"function")){s.onCellRequest=t}break}}if(s.sortFunction===undefined){s.sortFunction=function(z,y){var x=s.dataIndex==="tree"?z.getLabel():z.options.grid[s.dataIndex];var w=s.dataIndex==="tree"?y.getLabel():y.options.grid[s.dataIndex];return k.compareValue(x,w)}}return s},_updateColumnStyles:function(s,x){var r=[];try{var v=f();if(v.cssRules){r=v.cssRules}else{if(v.rules){r=v.rules}}var q="."+this.name+' .wux-datagrid-cell[data-index="'+s+'"]:not(.wux-datagrid-header)';var t=this._getBrowserSelector(v,q);var y=null;y=n(r,function(z){return(z.selectorText==t)});if(y!==null){v.deleteRule(y.index)}var w="{}";if(UWA.is(x,"object")){w=JSON.stringify(x);w=w.replace(/"/g,"");w=w.replace(/,/g,"")}if(w!="{}"){v.insertRule(t+w,r.length)}}catch(u){console.error(u);console.log("Catch inside _updateColumnStyles")}},_clearExistingStyles:function(){var u=this.getManager();var t=u.options.columns;var q={color:"#000000","background-color":"#ffffff"};for(var s=0;s<t.length;s++){var r=t[s];if(r.xnav_options&&r.xnav_options.layout&&r.xnav_options.layout.styles){r.xnav_options.layout.styles=q}this._updateColumnStyles(r.dataIndex,q)}},_getBrowserSelector:function(s,r){var q=null;var t=-1;var w=s;try{t=w.insertRule(r+"{}",w.cssRules.length);var v=w.cssRules||w.rules;q=v[t].selectorText}catch(u){console.log("Catch inside _getBrowserSelector")}finally{if(t>=0){w.deleteRule(t)}}return q}});return p});var mixinDefinitionAMD="DS/ENXNav/views/customize_views/_xNavTreeLstDefinition";try{var PADSettingsMgtFirst=require("DS/PADUtils/PADSettingsMgt");if(PADSettingsMgtFirst.getSetting("columnParametrization")===true){mixinDefinitionAMD="DS/ENXNav/views/customize_views/_xNavTreeLstParametrization"}}catch(e){console.warn("PADSettingsMgt not loaded yet but should be")}define("DS/ENXNav/views/xNavTreeListView",["DS/Tree/TreeListView","DS/ENXNav/views/customize_views/_xNavTreeLstCommon","DS/ENXNav/views/customize_views/_xNavCustoColumns","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/XNavSettings","DS/ENXNav/utils/xNavCustoStorageOptim",mixinDefinitionAMD],function(h,n,o,b,j,i,k,a){var g=500;var m=2000;function l(r){var q={};for(var p=0;p<r.length;p++){var s=r[p];q[s.dataIndex]=s.isHidden}return q}function d(r,p){for(var q=0;q<r.length;q++){var s=r[q];if(p[s.dataIndex]!==undefined){s.isHidden=p[s.dataIndex]}}}function f(r){for(var q=0;q<r.length;q++){var s=r[q];var p=s.customisation?s.customisation:s.xnav_options;if(p&&(s.isHidden!==p.layout.hidden)){p.layout.hidden=s.isHidden}}}var c=h.extend(n,o,a,{name:"xnav_treelst",previousClick:{date:Date.now(),idClicked:""},xnav_options:{},defaultOptions:{viewMode:"comfortable"},init:function(p){var r=this,q=this._parent.bind(this);this.cacheAdditionalColumns(p);if(p.view_customization&&p.view_customization.custoOptimized===true){p.view_customization=k.convertPreference2Custo(p.view_customization)}this.buildTreeListOpts({x3dAppId:p.x3dAppId,view_customization:p.view_customization,specific_columns:p.specific_columns},function(v){v=UWA.extend(v,p,true);if(p.additionalColumnsModules){var u=l(v.columns);for(var s=0;s<p.additionalColumnsModules.length;s++){p.additionalColumnsModules[s].getAdditionalColumnsUX(v.columns)}d(v.columns,u);f(v.columns)}var t=j.getSetting("activateEditInTable");if(t===true){v=r.addEditCB(v)}if(p.view_customization&&p.view_customization.viewMode){v.viewMode=p.view_customization.viewMode}q(v);if(j.getSetting("activateEditInTable")===true){r.hookCellReadonly()}r.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0});r.getContent().addClassName(r.name);if(r.name!=="xnav_treelst"){r.getContent().addClassName("xnav_treelst")}if(p.renderTo&&p.isActiveView===true){r.inject(p.renderTo)}if(j.getSetting("enablePerformanceAnalysis")===true){r.getManager().enablePerformanceAnalysis()}r.registerReusableCellContent();if(p.additionalColumnsModules){for(var s=0;s<p.additionalColumnsModules.length;s++){p.additionalColumnsModules[s].registerReusableCellContent(r)}}r.initializePreferencesMgt();r._commandProxy=b.create();r.onNodeClick(r._onCellClick.bind(r));if(j.getSetting("columnParametrization")===true){require(["DS/PADUtils/PADUtilsServices"],function(w){r.options.currentTenant=w.getPlatformId();j.addEvent("onX3dPlatformId",function(x){if(r.options.currentTenant!==x){r.options.currentTenant=x;r.dispatchEvent("onTenantChange",{updateTreeListView:function(y){if(!UWA.is(y)||y===""){r.reset()}else{r.updateColumns(y)}}})}})})}r.dispatchEvent("onComplete")})},setModel:function(p){this.inject(this.options.renderTo);this.options.isActiveView=true;this.getManager().loadDocument(p);if(p.options.viewport.tree!==null&&p.options.viewport.tree!==undefined){this.getManager().setScrollerPosition(p.options.viewport.tree)}},unsetModel:function(){if(this.options.isActiveView){var p=this.getManager();if(p.getScrollerPosition){this.getDocument().options.viewport.tree=p.getScrollerPosition()}this.getOption("renderTo").removeChild(this.elements.container);this.options.isActiveView=false;this.getManager().unloadDocument()}},_onCellClick:function(x){var u=["tree","instanceName","ds6w:description","ds6w:responsible","ds6w:reserved"];if(x===undefined||(x.cellModel&&x.cellModel.options&&x.cellModel.options.isHeader)){this.previousClick.idClicked="";this.previousClick.date="";this.previousClick.dataIndex="";return}var p=Date.now();var q=p-this.previousClick.date;var t=x.nodeModel.getOccurencePath().join("");var y=this.previousClick.idClicked===t&&x.nodeModel.isSelected()?true:false;var v=this.previousClick.dataIndex===x.dataIndex;this.previousClick.date=p;this.previousClick.idClicked=t;this.previousClick.dataIndex=x.dataIndex;if(j.getSetting("EditModeActivated")===true&&j.getSetting("activateEditInTable")===true&&q>g&&q<m&&y&&v&&(u.indexOf(x.dataIndex)!==-1||(i.isHardcodedColumn(x.dataIndex)===false&&(x.dataIndex.indexOf("ds6wg:XP_VPMReference_Ext")!==-1||x.dataIndex.indexOf("ds6w")===-1)))){var s=x.nodeModel.options.waiting4validation;if(typeof s==="undefined"||!s){this.activateWriteMode(x)}}else{delete x.nodeModel.options.edit;this.dispatchEvent("onNodeCellClick",x);var r=this.getOnCellClickCB(x.dataIndex);if(r===undefined){if(this.options.additionalColumnsModules){for(var w=0;w<this.options.additionalColumnsModules.length&&(r===undefined||r===null);w++){r=this.options.additionalColumnsModules[w].getOnCellClickCB(x.dataIndex)}}}if(UWA.is(r,"function")){r.call(this,x)}}},updateView:function(){var p=this.getManager();p.updateView(true)}});return c});define("DS/ENXNav/models/_xNavDocumentRefresh",["UWA/Class","UWA/Promise","DS/ENXNav/models/_xNavCVParser","DS/ENXNav/models/RefreshHandler","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWSAccess","DS/PADUtils/views/PADAlert","DS/PADUtils/views/PADProgressBar","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(a,l,h,g,f,m,b,d,c){var i=a.extend({});if(f.getSetting("refresh_v2")===true){var k=[],j=[];i.prototype.refresh=function(r){var p=function(s){d.off();s=s||{msg:c.refresh_ok};if(r.cb===undefined){b.displayNotification(s)}else{r.cb(s)}};var o=c.refresh_ongoing;r=r||{};var n=r.roots||this.getRoots();n=n.concat(this.getDetachedRoots());if(n.length>0){var q=this;d.on(o);this.doRefreshCV(n).then(function(s){p()}).then(function(){q.getModelEvents().publish({event:"titleRecalc"})})}}}i.prototype.doRefreshCV=function(n,p){var o=this;return new l(function(r,z){var B={};var x=0;var v=B["Block_"+x]=[];for(var y=0;y<n.length;y++){var u=n[y];if(y>0&&y%8===0){x++;v=B["Block_"+x]=[]}if(n[y].hasChildren()===true){n[y].processDescendants({processNode:function(){if(v.length>1001){x++;v=B["Block_"+x]=[]}if(this.hasChildren()===false){v.push({node:this,root:u})}}})}else{B["Block_"+x].push({node:u,root:u})}}var A=[];var C=Object.getOwnPropertyNames(B);var w=0;for(var s=0;s<C.length;s++){var t=new l(function(F){w++;var D=B[C[s]];var E=0;if(Math.floor(w/5)===1){E=2000}setTimeout(function(){o._validateWithMultiExpandFiltered(D,F,p)},E)});t.name="Validate branch from root of "+C[s];A.push(t)}var q=new l(function(D){l.all(A).then(function(){j=[];k=[];r()})});q.name="Synchronisation of Validation";A.push(q)})};i.prototype._validateWithMultiExpandFiltered=function(n,w,p){var q=this;var x=UWA.extend({intent:"explore_2D"},f.getWebAPI_Options("navigate"),true);var A=f.getSetting("enopad_webapis");var y={select_bo:x.select_bo,select_rel:x.select_rel,compute_select_bo:x.compute_select_bo,union:{expand:[]}};var z=new g({app_context:f.app_context,treeDocument:this});var r=[];var s=[];for(var u=0;u<n.length;u++){var t;var v=n[u];var o=v.root;if(s.indexOf(o.getID())===-1){s.push(o.getID());t={root_path_physicalid:[],no_type_filter_rel:x.no_type_filter_rel,"q.iterative_filter_query_bo":x["q.iterative_filter_query_bo"]};if(o&&o.options.sequence_filter){t.sequence_filter=o.options.sequence_filter}if(o&&o.options.config_filter){t.config_filter=o.options.config_filter}t.expand_iter="0";y.union.expand.push(t)}else{t=y.union.expand[s.indexOf(o.getID())]}t.root_path_physicalid.push(v.node.getOccurencePath())}q.prepareUpdate();m.multiexpand({enopad_webapis:A,data:y,onComplete:function(C){var B=UWA.is(C,"string")?JSON.parse(C):C;h.process.validateMultiExpand({treedocument:q,response:B,forcePartiallyExpanded:typeof p==="boolean"?p:true,treatedNodes:n,onComplete:function(D){if(D.nodes2relaunch.length){q._validateWithMultiExpandFiltered(D.nodes2relaunch,w,p)}else{z.complete(true);w()}q.pushUpdate()}})},onFailure:function(){var D=n.map(function(H){return H.root});var G=D.filter(function(I,H,J){return J.indexOf(I)==H});var E=true;for(var C=0;C<G.length;C++){var B=G[C];var F=c.replace(c.removeNodeWithRefresh,{name:B.getLabel()});b.displayNotification({msg:F,eventID:"warning"});E=false;q.removeRoot(B,false)}if(E){b.displayNotification({msg:c.refresh_failure,eventID:"error"})}z.complete(false);w();q.pushUpdate()}})};return i});define("DS/ENXNav/models/xNavDocument",["UWA/Core","DS/Logger/Logger","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/Tree/TreeDocument","DS/ENXNav/models/_xNavDocumentRefresh","DS/ENXNav/models/xNavNodeModel","DS/ENXNav/models/_xNavCVParser","DS/PADUtils/PADWSAccess","DS/PADUtils/PADPredicatesNls","DS/PADUtils/views/PADAlert","DS/Utilities/Array","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADTransactionManager","DS/PADUtils/PADSession","DS/PADUtils/PADProbes","DS/PADUtils/views/PADPager","DS/PADUtils/Utility","DS/ApplicationFrame/CommandsManager","i18n!DS/PADUtils/assets/nls/PADUtils.json","i18n!DS/ENXNav/assets/nls/ENXNav.json"],function(k,A,m,r,q,s,w,c,x,y,z,u,p,i,t,j,f,d,a,v,o){var b=500;function h(D){D.preExpandDone({preventExpandAll:false,state:"collapsed"})}function B(E){var D=a.getCommand("ExpandAll");if(D){if(E){D.enable()}else{D.disable()}}}function g(D){var E=0;D.forEach(function(F){if(F.attributes){E++}});return E}function l(D){if(D.hasChildren()){D.setState({state:"partiallyExpanded"})}}function C(D){for(var E=0;E<D.length;E++){var F=D[E];l(F);F.childComputed=false;F.processDescendants({processNode:function(G){l(this);this.childComputed=false}})}}var n=q.extend(i,s,{_broadcastSelect:true,_selected_paths:[],id:"mainNodeModel",_insertFlag:false,_pagerview:null,_selection:[],_selectedIdx:null,_focusOn:false,_reframeFocus:false,_currentApp:null,_emptyFromProxy:false,_isVolumeFilter:false,init:function(F){var E=F||{},H=this;this._logger=A.getLogger("DS/ENXNav/models/xNavDocument");if(!k.is(E.shouldAcceptDrop)){E.shouldAcceptDrop=this._shouldAcceptDrop.bind(this)}if(!k.is(E.shouldAcceptDrag)){E.shouldAcceptDrag=this._shouldAcceptDrag.bind(this)}H.renderTo=F.renderTo?F.renderTo:document.body;this._parent(E);this.options.viewport={graph:null,tree:null};this.onPreExpand(this.xnav_expand.bind(this));this.isAdditionalColumnsVisible=function(){return false};this.forceSyncModel4TreeListView=function(){};this.addEvent("onTransactionEnd",function(J,I){if(!I){H.getModelEvents().publish({event:"setPathTags",context:H});H.fromTransactionEnd=true}});this.onPostCollapse(this._colorize3D.bind(this));if(!k.is(E.remove_broadcast)||E.remove_broadcast===true){H._commandProxy=p.create({events:{onSelect:function(K,I){if(!H._insertFlag){if(K.searchDone!==true){if(K.focusOn==true){if(K.sharedID&&K.sharedID!==r.getSharedId()){return}}var L=K.paths;H._selected_paths=k.clone(L);var J=function(){try{H._doNotBroadcastSelect=true;if(H._selected_paths.length){H._selectOccurence("",true)}else{if(I.appid===p.appId()){H._emptyFromProxy=true;H.unselectAll()}}var O=[];for(var M=0;M<H._selected_paths.length;M++){var N=H.getNodeByOccurencePath(H._selected_paths[M]);if(N){O.push(H._selected_paths[M])}}H._selected_paths=O}finally{setTimeout(function(){H._doNotBroadcastSelect=false},500)}};J();if(K.doNotSetOnCompass!==true&&m.getSetting("add_objects_when_select")===true&&L.length&&I.appid===p.appId()){H._selected_paths=L;H.insertBranches(K.paths,{node_state:"collapsed",forceCollapsed:true,novalidation:true,onComplete:function(){J()}})}}}},onClosePager:function(I){if(H._pagerview!==null){H._pagerview.hide();delete H._pagerview}},onFocus:H._onFocus.bind(H),onFocusChange3D:function(I){if(I.sharedID==r.getSharedId()){H.focusChange(I)}},onShow:function(I){H._logger.log("_commandProxy.onShow");H.withTransactionUpdate(function(){I.paths.forEach(function(K){var J=H.getNodeByOccurencePath(K);if(J){var L={isPADHidden:false};J.updateOptions(L)}})})},onHide:function(I){H._doNotBroadcastSelect=true;H.insertBranches(I.paths,{node_state:"collapsed",forceCollapsed:true,novalidation:true,onComplete:function(){H.withTransactionUpdate(function(){I.paths.forEach(function(K){var J=H.getNodeByOccurencePath(K);if(J){var L={isPADHidden:true};J.updateOptions(L)}})})}});H._doNotBroadcastSelect=false},onUpdate2DPosMatrix:function(O){var I=H.getXSO();if(!I.isEmpty()){H.prepareUpdate();for(var K=0;K<O.instances.length;K++){var J=H.getNodesByRelId(O.instances[K].instance);for(var N=0;N<J.length;N++){var M=O.instances[K].hasPositioningMatrix.join();var L={relationId:O.instances[K].instance,grid:{instanceMatrix:r.checkNotIdentity(M)?M:null}};J[N].updateOptions(L)}}z.displayNotification({msg:v.pastePositionSucceeded,eventID:"info"});H.pushUpdate()}},onUpdateViewPoint:function(I){if(H._viewPointCallback){H._viewPointCallback(I);H._viewPointCallback=null;if(this._viewPointTimer){clearTimeout(this._viewPointTimer);this._viewPointTimer=null}}},onSendFilterInfo:function(){var I={filterAvailable:false};if(H._isVolumeFilter===true){I={filterAvailable:true}}H._commandProxy.receiveFilterInfo(I)},onPadRefresh:function(J){if(m.getSetting("activateFUN076708")===true){var I=function(M){var L=Object.getOwnPropertyNames(M);for(var K in L){if(L[K]==="insertExisting"){if(!J.origin||J.origin!=="CCP"){H._viewInsertExisting(M.insertExisting)}}else{if(L[K]==="detach"){H._viewDetach(M.detach)}else{if(L[K]==="reParent"){H._viewReParent(M.reParent)}else{if(L[K]==="replaceInstances"){H._viewReplaceInstance(M.replaceInstances)}else{console.warn("Unknown Action key "+K+"Action: "+L[K])}}}}}};if(J.transactions){J.transactions.forEach(function(K){I(K)})}else{I(J)}}}}});var G=function(){if(!H._doNotBroadcastSelect){H._selected_paths=[];H._commandProxy.select(H._buildSelectData());if(H._broadcastSelect===true&&H.options.authorize_setStructure===true){r.setObject_on_compass({nodes_2_open:H.getXSO().get()});if(m.getSetting("settypes")===false){r.setStructure_4_open_in_cv5({nodes_2_open:H.getXSO().get(),selected_paths:H._selected_paths})}else{r.setTypesForOFW(H)}}}if(H.getSelectedNodes().length===0&&H._pagerview!==null&&H._focusOn!==true&&H._reframeFocus!==true){H._pagerview.hide();delete H._pagerview;H._reframeFocus=false;H._commandProxy.closePager({sharedID:r.getSharedId()})}};var D=function(I){if(I.keyCode===27){H.getXSO().empty();H.restoreSelection()}};this.getXSO().onPostAdd(function(){G();H._focusOn=false});if(this.getXSO().onPostRemove){this.getXSO().onPostRemove(G)}else{this.getXSO().onRemove(G)}this.getXSO().onEmpty(function(){if(H._emptyFromProxy===false&&!H._pagerview){H._doNotBroadcastSelect=false}else{H._emptyFromProxy=false}G()});this.getXSO().onPreEmpty(function(){if(H._emptyFromProxy===false){H._doNotBroadcastSelect=true}});document.addEventListener("keyup",D)}},broadcastSelect:function(D){this._broadcastSelect=D;if(this._broadcastSelect===true&&this.options.authorize_setStructure===true){r.setObject_on_compass({nodes_2_open:this.getSelectedNodes()});if(m.getSetting("settypes")===false){r.setStructure_4_open_in_cv5({nodes_2_open:this.getSelectedNodes(),selected_paths:this._selected_paths})}else{r.setTypesForOFW(this)}}},withBroadcastSelect:function(D){this.prepareBroadcastSelect();D();this.pushBroadcastSelect()},prepareBroadcastSelect:function(){this._doNotBroadcastSelect=true},pushBroadcastSelect:function(){this._commandProxy.select(this._buildSelectData());this.broadcastSelect(true);this._doNotBroadcastSelect=false},add:function(P){var J=this;var N=[];var I={alreadyLoadedRoots:[]};if(k.is(P.pids,"array")){P.pids.forEach(function(Q){if(N.indexOf(Q)===-1){N.push(Q)}})}var E=this.getRoots();var K=N.length;for(var O=0;O<E.length;O++){var M=N.indexOf(E[O].options.resourceid);if(M!==-1){N.splice(M,1);I.alreadyLoadedRoots.push(E[O].options.resourceid)}}if(J.detachedRoots&&J.detachedRoots.length>0){for(var H=0;H<J.detachedRoots.length;H++){var G=J.detachedRoots[H];var D=N.indexOf(G.options.resourceid);if(D>-1){N.splice(D,1);I.alreadyLoadedRoots.push(G.options.resourceid)}}}if(N.length!==K){z.displayNotification({msg:v.root_already_loaded})}if(N.length>0){var L=m.getWebAPI_Options("fetch");if(L.select_predicate.indexOf("ds6w:type")===-1){L.select_predicate.push("ds6w:type")}var F=t.isAuthoring();x.fetch({enopad_webapis:m.getSetting("enopad_webapis"),data:L,pids:N,onComplete:function(U){J.invalidateViewPort();var S=false;var R=k.is(U,"string")?JSON.parse(U):U;if(!R.results||R.results.length<N.length){if(m.getSetting("enopad_webapis")===false){z.displayNotification({msg:v.object_not_found_in_db,eventID:"error"});if(!S&&P.callback){P.callback("error")}}else{if(F){z.displayNotification({msg:v.object_not_found_in_db,eventID:"error"});if(!S&&P.callback){P.callback.call(null,I)}}else{if(R.infos&&R.infos.sources&&R.infos.sources.length>0&&R.infos.sources[0].error){var T=R.infos.sources[0];var Q=T.error.errorMessage||"An error has occurred in "+T.name;z.displayNotification({msg:Q,eventID:"error"});if(!S&&P.callback){P.callback.call(null,I)}}else{t.setAuthoringState(true,v.PADSession_disabling_index_object_not_found);J.add(P);S=true}}}}else{if(R.results.length>N.length){z.displayNotification({msg:v.tooManyResults,eventID:"error"});if(!S&&P.callback){P.callback.call(null,I)}}else{J.wrapInTransaction(function(){if(R.authoringMode&&R.authoringMode===true){t.setAuthoringState(true,v.PADSession_disabling_index_from_server)}c.process.fetch({treedocument:J,response:R,config_filter:P.config_filter,rootsWithFilters:P.rootsWithFilters,onComplete:function(){if(!S&&P.callback){P.callback.call(null,I)}},onFailure:function(V){console.error(V)}})})}}},onFailure:function(){z.displayNotification({msg:v.generic_service_failure,eventID:"error"});if(P.callback){P.callback("error")}},})}else{if(P.callback){P.callback.call(null,I)}}},addPaths:function(M){var N=k.extend({root_path_physicalid:M.paths,expand_iter:"0",intent:"explore_2D"},m.getWebAPI_Options("navigate"),true);var H={alreadyLoadedRoots:[]};var J=this;if(N["q.iterative_filter_query_bo"]&&m.getSetting("globalTypeFiltering")!==true){delete N["q.iterative_filter_query_bo"]}var D={};if(M.fromIndexFailure===true){D=M.ids}else{D=c.process.insert_temporary_branches({temporary_root:true,treedocument:this,branches:M.paths})}H.alreadyLoadedRoots=D.rootsAlreadyLoaded;var K=M.paths.length;function I(){var Q=[];for(var P=0;P<M.paths.length;P++){if(Q.indexOf(M.paths[P][0])===-1){var O=J.searchRootById(M.paths[P][0]);if(k.is(O)&&O.options.waiting4validation===true){Q.push(M.paths[P][0])}}for(var S=0;S<M.paths[P].length;S=S+2){var T=M.paths[P][S];var R=J.getNodesById(T);if(k.is(R,"array")){R.forEach(function(U){if(U.options.waiting4validation===true){var W=U.getParent();U.remove();if(W){if(!W.hasChildren()&&W.getState()!=="noChildren"){if(k.is(W.setState,"function")){try{W.setState({state:"collapsed"});W.options.children=[]}catch(V){console.error(V)}}}}}})}}}return Q}function L(){var O=I();z.displayNotification({msg:v.allObjectCannotBeFound,eventID:"error"});if(M.callback){var P={};P.idleRootIds=O;P.success=false;M.callback.call(J,P)}}function E(){var Q=[];for(var P=0;P<M.paths.length;P++){if(Q.indexOf(M.paths[P][0])===-1){var O=J.searchRootById(M.paths[P][0]);if(k.is(O)&&O.options.waiting4validation===true){Q.push(M.paths[P][0])}}for(var T=0;T<M.paths[P].length;T=T+2){var U=M.paths[P][T];var R=J.getNodesById(U);if(k.is(R,"array")){R.forEach(function(V){if(V.options.waiting4validation===true){var X=V.getParent();V.remove();if(X){if(!X.hasChildren()&&X.getState()!=="noChildren"){if(k.is(X.setState,"function")){try{X.setState({state:"collapsed"});X.options.children=[]}catch(W){console.error(W)}}}}}})}}}z.displayNotification({msg:v.cannot_insert_branch,eventID:"error"});if(M.callback){var S={};S.idleRootIds=Q;S.success=false;M.callback.call(J,S)}}if(D.ids_to_fetch.length===0&&D.relationids.length===0){z.displayNotification({msg:v.root_already_loaded});if(M.callback){var F={sucess:true};M.callback.call(J,F,H)}}else{var G=t.isAuthoring();x.navigate({enopad_webapis:m.getSetting("enopad_webapis"),data:N,onComplete:function(S){var P;try{var Q=k.is(S,"string")?JSON.parse(S):S;if(Q.results){if(Q.results.length>0&&!Q.error){P=J.startTransaction("expand");if(Q.authoringMode&&Q.authoringMode===true){t.setAuthoringState(true,v.PADSession_disabling_index_from_server)}c.process.validateAndUpdateBranches({treedocument:J,response:Q});var O=g(Q.results);if(O<K){if(M.fromIndexFailure){L();return}else{if(m.getSetting("authoringModeNotSupported")!==true&&t.isAuthoring()===false){t.setAuthoringState(true,v.PADSession_disabling_index_object_not_found);M.fromIndexFailure=true;M.ids=D;J.addPaths(M);return}else{L();return}}}if(M.callback){var R={};R.success=true;M.callback.call(J,R,H)}}else{if(m.getSetting("authoringModeNotSupported")!==true&&G===false){t.setAuthoringState(true,v.PADSession_disabling_index_object_not_found);M.fromIndexFailure=true;M.ids=D;J.addPaths(M)}else{E()}}}else{E()}}catch(T){E()}finally{if(P){P.end()}}},onFailure:function(O){if(m.getSetting("authoringModeNotSupported")!==true&&t.isAuthoring()===false){t.setAuthoringState(true,v.PADSession_disabling_index_object_not_found);M.fromIndexFailure=true;M.ids=D;J.addPaths(M)}else{E()}}})}},xnav_expand:function(J){var V=J.data,O=V.nodeModel,F=V.expandAll?V.expandAll:false,D=null,K=false,W="default",S=V.numberOfLevelsToExpand?V.numberOfLevelsToExpand.toString():m.getSetting("expand_iter");if(F){O._expandAllPending=true;B(false)}this.invalidateViewPort();if(F){S="-1"}var E=parseInt(S);var L=(m.getSetting("activateFUN085903")&&(E===-1||E>1));var I=this,R=function(aa,Z,Y){function ab(ae){if(ae.childComputed&&ae.hasChildren()){var ad=ae.getChildren();if(ad.length===1){return ad[0].options.grid.globaltype==="ds6w:Document"}}}var ac=function(ai,ah,ag){if(ah===-1||ag<ah){if(ai.childComputed){if(ai.hasChildren()){var af=ai.getChildren(),ae=true;for(var ad=0;ad<af.length&&ae===true;ad++){var aj=af[ad];if(aj.childComputed&&L){if(ab(aj)){continue}}if(aj.childComputed&&aj._expandState!=="noExpandState"&&(aj.getDepth()<ah||ah===-1)){aj.setState({state:"expanded"})}ae=ac(aj,ah,ag+1);if(ae===undefined){throw new Error("Undefined no_expand_needed flag")}}return ae}else{return true}}else{if(ah===-1||ah>ag){return false}else{return true}}}else{return true}};var X=ac(aa,Z,Y);return X};if(D=J.target.options.partialPreExpand,D){K=true;W="find_in_ctx";this.getXSO().empty()}if(O.childComputed&&K===false){var H=O.getDepth();if(R(O,F?parseInt(S):H+parseInt(S),H)){J.target.preExpandDone({preventExpandAll:true});I._selectOccurence();I._colorize3D(this);delete O._expandAllPending;B(true);return}}var P=k.extend({root_physicalid:O.getID(),expand_iter:S,intent:"explore_2D"},m.getWebAPI_Options("navigate"),true);if(m.getSetting("globalTypeFiltering")!==true){if(P["q.iterative_filter_query_bo"]){delete P["q.iterative_filter_query_bo"]}if(m.getSetting("dynamic_authorized_types")===true){P.no_type_filter_bo=m.getSetting("no_type_filter_bo")}else{P.type_filter_bo=m.getSetting("type_filter_bo")}}if(K===true){K=true;J.target.options.partialPreExpand=null;P.find_path_filter=[{option:["cut"],path_physicalid:D()}];delete P.expand_iter;if(!t.isUsingIndex()){z.displayNotification({msg:o.find_in_ctx_after_authoring,eventID:"warning"})}}else{if(J.target.options.findInCtxFTS){K=true;W="find_in_ctx";this.getXSO().empty();P.find_in_context=[{"q.query":J.target.options.findInCtxFTS}];delete J.target.options.findInCtxFTS;delete P.expand_iter;if(!t.isUsingIndex()){z.displayNotification({msg:o.find_in_ctx_after_authoring,eventID:"warning"})}}}var T=O;var G=false;var M=false;var U=0;if(!O.isRoot()){T=O.getRoot()}if(T.options&&T.options.sequence_filter){P.sequence_filter=T.options.sequence_filter;M=true}if(T.options&&T.options.config_filter){P.config_filter=T.options.config_filter;M=true}var Q=m.getSetting("alwaysExpandPath")===true||M||m.getSetting("pgpFromServer");if(Q){var N=O.getOccurencePath();U=N.length-1;P.paths=[N];delete P.root_physicalid}if(K){G=false}else{G=m.getSetting("enopad_webapis")}I.prepareUpdate();x.navigate({find_in_ctx:K,enopad_webapis:G,data:P,onComplete:function(ae){var Z=false;var af;try{af=I.startTransaction("expand");var aj=k.is(ae,"string")?JSON.parse(ae):ae;if(aj.results.length===0){if(K){z.displayNotification({msg:v.find_in_context_no_result,eventID:"info"})}else{z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}}else{if(O.options.padstate==="partiallyExpanded"&&!K){I._commandProxy.padExpand({paths:[O.getOccurencePath()],expand_level:S})}var ai=O;var X=parseInt(S);if(Q){ai=T;if(X!==-1){X=X+U}}var aa=m.getSetting("parse_timeout");var ag=aa?parseInt(aa):undefined;c.process.expand({treedocument:I,root_nodes:[ai],response:aj,mode:W,expand_level:X,selectPathLeaf:K,noCheckOrder:true,parseTimeout:ag,realExpandedNodes:[O]});Z=true}}catch(ah){if(ah.type&&ah.type==="TimeoutError"){z.displayNotification({msg:v.parseTimeout,eventID:"warning"});C([O])}else{z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}}finally{if(K){var ac=I.getXSO().get();var ad={paths:[],reframe:true,expand_level:-1};for(var ab=0;ab<ac.length;ab++){ad.paths.push(ac[ab].getOccurencePath())}I._commandProxy.padExpand(ad)}else{if(Z){O.childComputed=true;I._selectOccurence()}}if(af){af.end()}var Y;if(K){if(O.options.relcount===0){O.options.children=null;Y="noChildren"}else{Y="partiallyExpanded"}}delete O._expandAllPending;B(true);J.target.preExpandDone({preventExpandAll:true,state:Y});I.pushUpdate()}},onFailure:function(){h(J.target);delete O._expandAllPending;B(true);z.displayNotification({msg:v.generic_service_failure,eventID:"error"});I.pushUpdate()}})},applyFilter:function(O){var J=this,D="filter";var P=[];for(var N=0;N<O.filterRootIds.length;N++){var K=J.searchRootById(O.filterRootIds[N]);if(K){K.options.CVQuery=O.CVQuery;P.push(K)}}if(O.CVQuery.union!==undefined||O.CVQuery.intersection!==undefined||O.CVQuery.minus!==undefined){var E=k.clone(O.CVQuery);if(E.union&&E.union.expand&&E.union.expand.length>1){var M=[];for(var I=0;I<E.union.expand.length;I++){var L=E.union.expand[I];if(L.volume_filter){M.push(I)}}for(var H=0;H<M.length;H++){E.union.expand.splice(M[H],1)}}var F=m.getWebAPI_Options("navigate");E.select_bo=F.select_bo;E.select_rel=F.select_rel;E.compute_select_bo=F.compute_select_bo;var G=false;if(O.structCollapse===true){G=true;var R=o.applyingFilter;J.getModelEvents().publish({event:"beginBlockingTransaction",data:R,context:J})}E.label=r.getRequestLabel();J.prepareUpdate();x.multiexpand({enopad_webapis:false,data:E,onComplete:function(V){var S=false;var T;try{T=J.startTransaction("expand");var U=k.is(V,"string")?JSON.parse(V):V;if(U.results===undefined||U.results.length===0){z.displayNotification({msg:v.sequence_filter_error,eventID:"info"})}else{c.process.expand({treedocument:J,root_nodes:P,response:U,mode:D,expand_level:-1,selectPathLeaf:false})}}catch(W){z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}finally{P.forEach(function(Y){Y.childComputed=true;var X={bottomRight:"filter"};Y.setBadges(X);if(G===true){Y.collapseAll()}});J._selectOccurence();if(T){T.end()}J.pushUpdate();J.getModelEvents().publish({event:"endBlockingTransaction",context:J})}},onFailure:function(S,T){J.getModelEvents().publish({event:"endBlockingTransaction",context:J});if(S){console.error(S)}z.displayNotification({msg:v.generic_service_failure,eventID:"error"});J.pushUpdate();J.getModelEvents().publish({event:"setTags",data:{facets:{}}})}})}else{var Q=O.CVQuery;if(!k.is(Q.expand_iter,"string")){Q.expand_iter="-1"}Q.intent="explore_2D";Q=k.extend(Q,m.getWebAPI_Options("navigate"),true);J.prepareUpdate();x.navigate({enopad_webapis:false,data:Q,onComplete:function(V){var S=false;var T;try{T=J.startTransaction("expand");var U=k.is(V,"string")?JSON.parse(V):V;if(U.results.length===0){P.forEach(function(X){X.setState({state:"expanded"})})}else{c.process.expand({treedocument:J,root_nodes:P,response:U,mode:D,expand_level:parseInt(Q.expand_iter),selectPathLeaf:false})}}catch(W){z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}finally{P.forEach(function(Y){Y.childComputed=true;var X={bottomRight:"filter"};Y.setBadges(X)});J._selectOccurence();if(T){T.end()}J.pushUpdate()}},onFailure:function(){z.displayNotification({msg:v.generic_service_failure,eventID:"error"});J.pushUpdate()}})}},expandMultiSelect:function(I){var G=I.expandAll?I.expandAll:false,X="default",V=I.numberOfLevelsToExpand?I.numberOfLevelsToExpand.toString():m.getSetting("expand_iter"),H=m.getSetting("enopad_webapis");this.invalidateViewPort();if(G){V="-1"}var M=this;var U=m.getSetting("alwaysExpandPath")===true||isNGFilter||m.getSetting("pgpFromServer");M.prepareUpdate();var Q=[];for(var T=0;T<I.nodes2Expand.length;T++){var R=I.nodes2Expand[T];if(R.childComputed){var L=R.getDepth();if(!this._expandChildren(R,G?parseInt(V):L+parseInt(V),L)){Q.push(R)}}else{Q.push(R)}}if(Q.length===0){M._colorize3D(M);M.forceSyncModel4TreeListView();M.pushUpdate();if(I.callback){I.callback()}}else{var E=[];var W=0;var S=[];var J=[];var F=[];this.withTransactionUpdate(function(){for(var Y=0;Y<Q.length;Y++){Q[Y].setState({state:"expanding"});var Z=Q[Y];if(!Z.isRoot()){Z=Q[Y].getRoot()}if(U===true){var aa=Q[Y].getOccurencePath();if(F.indexOf(Z.getID())===-1){F.push(Z.getID());J.push(Z)}W=Math.max(aa.length-1,W);S.push(aa)}else{S.push([Q[Y].getID()]);if(F.indexOf(Q[Y].getID())===-1){F.push(Q[Y].getID());J.push(Q[Y])}}}});var D=[];var K=new Promise(function(Z){var Y=k.extend({paths:S,expand_iter:V,intent:"explore_2D"},m.getWebAPI_Options("navigate"),true);x.navigate({find_in_ctx:false,enopad_webapis:H,data:Y,timeout:m.getSetting("expand_multisel_timeout"),onComplete:function(af){var aa=false;var ab;try{if(I.tagger!==false){ab=M.startTransaction("expand")}var ad=k.is(af,"string")?JSON.parse(af):af;if(ad.results.length===0){z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}else{var ah=parseInt(V);if(U===true){if(ah!==-1){ah=ah+W}}var ac=m.getSetting("parse_timeout");var ae=ac?parseInt(ac):undefined;c.process.expand({treedocument:M,root_nodes:J,response:ad,mode:X,expand_level:ah,selectPathLeaf:false,noCheckOrder:true,parseTimeout:ae,realExpandedNodes:Q})}}catch(ag){if(ag.type&&ag.type==="TimeoutError"){z.displayNotification({msg:v.parseTimeout,eventID:"error"});C(J)}else{z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}}finally{if(U===true){Q.forEach(function(ai){if(ai.isRoot()){ai.childComputed=true}})}else{J.forEach(function(ai){ai.childComputed=true})}M._selectOccurence();if(ab){ab.end()}Z()}},onFailure:function(){z.displayNotification({msg:v.generic_service_failure,eventID:"error"});Z()}})});D.push(K);for(var N=0;N<E.length;N++){var R=E[N];var P=new Promise(function(Y){var aa=k.extend({expand_iter:V,intent:"explore_2D"},m.getWebAPI_Options("navigate"),true);var Z=R;var ac=0;if(!R.isRoot()){Z=R.getRoot()}if(Z.options.sequence_filter){aa.sequence_filter=Z.options.sequence_filter}if(Z.options.config_filter){aa.config_filter=Z.options.config_filter}if(Z.options.CVQuery){if(Z.options.CVQuery.sequence_filter){aa.sequence_filter=Z.options.CVQuery.sequence_filter}if(Z.options.CVQuery.config_filter){aa.config_filter=Z.options.CVQuery.config_filter}}var ab=R.getOccurencePath();ac=ab.length-1;aa.paths=[ab];x.navigate({find_in_ctx:false,enopad_webapis:H,data:aa,onComplete:function(ag){var ad=false;var ae;try{if(I.tagger!==false){ae=M.startTransaction("expand")}var af=k.is(ag,"string")?JSON.parse(ag):ag;if(af.results.length===0){z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}else{var ai=parseInt(V);if(ai!==-1){ai=ai+ac}c.process.expand({treedocument:M,root_nodes:[Z],response:af,mode:X,expand_level:ai,selectPathLeaf:false})}}catch(ah){z.displayNotification({msg:v.generic_service_failure,eventID:"error"})}finally{Z.childComputed=true;M._selectOccurence();if(ae){ae.end()}Y()}},onFailure:function(){z.displayNotification({msg:v.generic_service_failure,eventID:"error"});Y()}})});D.push(P)}var O=Promise.all(D);if(I.callback){O.then(I.callback)}O.then(function(){M.pushUpdate()})}},fillAttributesAsync4VisibleNodes:function(D){var F=this;var G=function(J,I){var K=I;if(k.is(F.filterAttributesForUpdate,"function")){K=F.filterAttributesForUpdate({node:J,node_opts:K})}if(K.relationOrder===-1){K.relationOrder=J.options.relationOrder}if(m.getSetting("tree_order_in_label")===true&&K.label){K.label+=("(treeorder="+K.relationOrder+")")}return K};function E(J,Q){for(var N=0;N<F.options.additionalColumnsModules.length;N++){var M=F.options.additionalColumnsModules[N];var I=M.getManagedColumnNames();var P={};for(var K=0;K<I.length;K++){P[I[K]]=J.options.grid[I[K]]}if(M.toBeUpdated(P)===true){if(Q[M.getName()]===undefined){Q[M.getName()]={pids:[],relids:[]}}var L=J.getID();if(Q[M.getName()].pids.indexOf(L)===-1){Q[M.getName()].pids.push(L)}var O=J.getRelationID();if(O&&Q[M.getName()].relids.indexOf(O)===-1){Q[M.getName()].relids.push(O)}}}}if(this.options.additionalColumnsModules&&this.options.additionalColumnsModules.length){var H=this.getVisibleAdditionalColumns();if(H.length){require(["UWA/Promise"],function(I){var K={};var J=new I(function(N){var M=j.createProbe("VisitNodes For additional columns");for(var L=0;L<D.length;L++){E(D[L],K)}N();M.end()});J.then(function(){var P=[];for(var M=0;M<H.length;M++){var N=H[M];var L=N.module.getName();if(K[L]){var O=new I(function(Q){N.module.updateAttributes(K[L],function(S){var R=k.is(S,"string")?JSON.parse(S):S;Q(R)})});P.push(O)}}if(P.length){I.all(P).then(function(R){var S={};for(var Q=0;Q<R.length;Q++){k.extend(S,R[Q],true)}F.withTransactionUpdate(function(){var U=0;var Y=Object.getOwnPropertyNames(S.pids);for(var V=0;V<Y.length;V++){var W=F.getNodesById(Y[V]);if(W&&W.length){for(U=0;U<W.length;U++){W[U].updateOptions(G(W[U],{grid:S.pids[Y[V]]}))}}else{console.warn("Should not happen. The node should be found")}}var T=Object.getOwnPropertyNames(S.relids);for(var X=0;X<T.length;X++){var W=F.getNodesByRelId(T[X]);if(W&&W.length){for(U=0;U<W.length;U++){W[U].updateOptions(G(W[U],{grid:S.relids[T[X]]}))}}else{console.warn("Should not happen. The node should be found")}}})})}})})}}},updateColorForNodes:function(D,F,E){var H=this;var G=require("DS/PADUtils/Configuration");var I=function(K,L){var J=[];H.withTransactionUpdate(function(){for(var M=0;M<K.length;M++){var Q=K[M];var P=Q.getPLMValue(F.predicate);if(P!==null){var O=d.getBIColor(E,F,P);var N={color:O,grid:{bi_color:O}};Q.updateOptions(N)}else{if(G.getConfig("readOnlyApp")===false){J.push(Q.getID())}else{var N={grid:{bi_color:"rgba(0, 0, 0, 0)"}};delete Q.options.color;Q.updateOptions(N)}}}});if(J.length===0){if(H.fromTransactionEnd===true){delete H.fromTransactionEnd;H.getModelEvents().publish({event:"broadcastColor",context:H});if(k.is(L,"function")){L()}}}else{H.updateNodesAttrValue(J,[F.predicate],function(M){H.withTransactionUpdate(function(){for(var N=0;N<J.length;N++){var R=H.getNodesById(J[N]);if(R.length>0){var S=R[0].getPLMValue(F.predicate);if(S!==null){var P=d.getBIColor(E,F,S);var O={color:P,grid:{bi_color:P}};for(var Q=0;Q<R.length;Q++){if(P==="rgba(0, 0, 0, 0)"){delete R[Q].options.color}R[Q].updateOptions(O)}}else{var O={grid:{bi_color:"rgba(0, 0, 0, 0)"}};for(var Q=0;Q<R.length;Q++){delete R[Q].options.color;R[Q].updateOptions(O)}}}}});H.getModelEvents().publish({event:"broadcastColor",context:H});if(k.is(L,"function")){L()}})}};if(D.length<1000){I(H.getAllDescendants())}else{I(D,function(){I(H.getAllDescendants())})}},invalidateViewPort:function(){this.options.viewport={graph:null,tree:null,tiles:null,thumbnails:null}},getNodesById:function(E){var D=[];this.getRoots().forEach(function(F){var G=F.getNodesById(E);D=D.concat(G)});return D},getNodeByOccurencePath:function(E){var D=this.getRoots();for(var F=0;F<D.length;F++){var G=D[F].getNodeByPath(E,undefined,undefined,true);if(G){return G}}},getRoots:function(D){var F=this._parent();if(Boolean(D)){if(k.is(this._getChildrenFilterInfo,"function")){var G=this._getChildrenFilterInfo();if(G&&k.is(G.childrenBeforeFiltering,"array")){var E=F;F=G.childrenBeforeFiltering.slice(0);E.forEach(function(H){if(F.indexOf(H)<0){F.push(H)}})}}}return F},getDetachedRoots:function(){var D=[];if(this.hasOwnProperty("detachedRoots")){this.detachedRoots.forEach(function(E){if(D.indexOf(E)===-1){D.push(E)}})}return D},removeRoot:function(H,I,F){var G=this;this.wrapInTransaction(function(){G._doNotBroadcastSelect=true;var J=G.hasOwnProperty("detachedRoots")?G.detachedRoots.indexOf(H):-1;if(J>=0){G.detachedRoots.splice(J,1)}else{G.invalidateViewPort();if(G.getRoots().indexOf(H)>=0){G._parent(H)}if(!k.is(F,"boolean")||!F){if(k.is(G._getChildrenFilterInfo,"function")){var K=G._getChildrenFilterInfo();if(K&&k.is(K.childrenBeforeFiltering,"array")){var M=K.childrenBeforeFiltering.indexOf(H);if(M>=0){K.childrenBeforeFiltering.splice(M,1)}}if(K&&k.is(K.filteredOutChildren,"array")){var L=K.filteredOutChildren.indexOf(H);if(L>=0){K.filteredOutChildren.splice(L,1)}}}}}G._doNotBroadcastSelect=false});if(!k.is(I,"boolean")||!I){var E=this.getRoots().length;if(k.is(this.detachedRoots,"array")){E=E+this.detachedRoots.length}this.getModelEvents().publish({event:"onRemoveRoot",data:{pid:H.getID(),remainingRoots:E}});var D=null;if(this.getRoots().length>0){D=this.getRoots()[0]}else{if(k.is(this.detachedRoots,"array")&&this.detachedRoots.length>0){D=this.detachedRoots[0]}}this.getModelEvents().publish({event:"onRootAdded",data:{isremove:true,added_node:D,nb_root:E}})}},attachRoot:function(D,G){var E=this.hasOwnProperty("detachedRoots")?this.detachedRoots.indexOf(D):-1;if(E<0){throw new Error("Invalid state")}else{this.detachedRoots.splice(E,1);var F=this;this.wrapInTransaction(function(){D.options.isRootAttached=true;if(G===undefined){F.addChild(D)}else{F.insertBefore(D,G)}F.invalidateViewPort()})}},detachRoot:function(G){var E=this.hasOwnProperty("detachedRoots")?this.detachedRoots.indexOf(G):-1;if(E>=0){throw new Error("Invalid state")}else{var F=this;var D=null;this.wrapInTransaction(function(){G.options.isRootAttached=false;var I=F.getRoots();if(I.length>0){for(var H=0;H<I.length;H++){if(I[H].options.resourceid===G.options.resourceid){D=I[H];q.prototype.removeRoot.call(F,D);break}}}if(!F.hasOwnProperty("detachedRoots")){F.detachedRoots=[]}F.detachedRoots.push(G)})}},searchRootById:function(G){var E,F=this.getRoots(true);if(this.hasOwnProperty("detachedRoots")){F=F.concat(this.detachedRoots)}for(var D=0;D<F.length;D++){if(F[D].options.resourceid===G){E=F[D];break}}return E},restoreSelection:function(){var D=this;if(D.originalSelection){D.withBroadcastSelect(function(){D._selected_paths=D.originalSelection;D._selectOccurence("FocusOn")})}},insertBranches:function(F,D){var E={};E=c.process.insert_temporary_branches({treedocument:this,branches:F,node_state:D.node_state,forceCollapsed:D.forceCollapsed,novalidation:D.novalidation});if(D.novalidation===true&&D.forceCollapsed===true&&F.length>20&&m.getSetting("forcePathValidationOnSelect")!==true){if(E.visibleNodesIds.length>0){this.refreshNodeById({modified:E.visibleNodesIds,relationids:E.visibleNodesRelIds,onComplete:D.onComplete?D.onComplete:undefined})}else{if(D.onComplete){D.onComplete.call(null)}}}else{if((E.ids_to_fetch.length>0||E.relationids.length>0)){if(E.ids_to_fetch.length>0||E.relationids.length>0){this.validateBranches_with_Expand(F,D)}else{if(D.onComplete){D.onComplete()}}}else{if(E.ids_to_fetch.length>0){this.refreshNodeById({modified:E.ids_to_fetch,relationids:E.relationids,onComplete:D.onComplete?D.onComplete:undefined})}else{if(D.onComplete){D.onComplete.call(null)}}}}},refreshNodeById:function(I){var J=[],H=this,G=[],F=[];var E=function(){J.forEach(function(M){var L=H.getNodesById(M);if(k.is(L,"array")){L.forEach(function(N){var O=N.getParent();N.remove();if(O.hasChildren()===false){O.setState({state:"collapsed"});O.options.children=[]}})}});var K=v.cannot_insert_branch;if(F.length!==0){K=v.cannot_access_after_changeowner}z.displayNotification({msg:K,eventID:"error"})};if(k.is(I.created)){J=J.concat(I.created)}if(k.is(I.modified)&&k.is(I.modified,"array")){this.withTransactionUpdate(function(){var K=false;I.modified.forEach(function(P){if(k.is(P,"object")){var N=P.physicalid;if(k.is(P.attributes,"array")){var M=require("DS/PADUtils/XNavSettings");var O=H.getNodesById(N);O.forEach(function(Q){Q.updateAttributes(P.attributes,M.getAvailableColumns());y.updateNLS(Q);K=true})}else{if(J.indexOf(N)===-1){var L=H.getNodesById(N);if(L&&L.length>0){J.push(N);G.push(N)}}if(P.key==="ownerChanged"){F.push(N)}}}else{if(J.indexOf(P)===-1){var L=H.getNodesById(P);if(L&&L.length>0){J.push(P)}}}})})}if(J.length>0){var D=m.getWebAPI_Options("fetch");D.include_param_Attributes=false;if(I.relationids&&I.relationids.length>0){J=J.concat(I.relationids)}x.fetch({enopad_webapis:m.getSetting("enopad_webapis"),data:D,pids:J,onComplete:function(L){H.invalidateViewPort();var K=k.is(L,"string")?JSON.parse(L):L;if(K.results.length!==J.length){console.error("Inconsistent number of results");E()}H.wrapInTransaction(function(){var N=c.process.refresh_nodes({treedocument:H,response:K,refresh_parameters:I,ids_modified:G});if(k.is(N,"array")&&N.length>0){var M={pids:N,already_added_in_PS:true};H._commandProxy.drop(M)}});if(I.onComplete!==undefined){I.onComplete()}},onFailure:function(){E()},})}},getNodesByRelId:function(D){var E=[];this.getRoots().forEach(function(F){var G=F.getNodesByRelId(D);E=E.concat(G)});return E},getNodesByIDPath:function(E){function D(I,J,G,K){if(I.getID()===J[G]){if(G===J.length-1){K.push(I)}else{var H=I.getChildren();if(H&&H.length>0){G+=1;H.forEach(function(L){D(L,J,G,K)})}}}}var F=[];this.getRoots().forEach(function(G){D(G,E,0,F)});return F},deleteNodes:function(D,F){var E=this;this.wrapInTransaction(function(){E.withTransactionUpdate(function(){var G={detach:{deleted:[]}};D.forEach(function(J){if(J.isRoot()){E.removeRoot(J)}else{var I=J.getParent(),H=I.getState();J.remove();G.detach.deleted.push(J.getID());if(H==="partiallyExpanded"&&!I.options.children){I.options.children=[];I.setState({state:"collapsed"})}}});if(F===true){E._commandProxy.padRefresh(G)}})})},clearSearch:function(){if(this._matchedNodeList){var D=this;this.withTransactionUpdate(function(){u.optimizedForEach(D._matchedNodeList,function(F,E){F.unmatchSearch();F.unselect()})})}},_performSearch:function(I,K){this.clearSearch();function E(L){return"(?:^|[^\\w-])"+L+"(?:[^\\w-]|$)"}function D(O){var L="";for(var N=0;N<O.length;N++){var M=O[N];if(/\\|\(|\)|\{|\}|\[|\]|\|/.test(M)){L+="\\"+M}else{L+=M}}return L}var G,F=this;var J=D(I);if((K.isMatchCase===false)&&(K.isWholeWord===false)){G=new RegExp(J,"i")}else{if((K.isMatchCase===true)&&(K.isWholeWord===false)){G=new RegExp(J)}else{if((K.isMatchCase===false)&&(K.isWholeWord===true)){G=new RegExp(E(J),"i")}else{if((K.isMatchCase===true)&&(K.isWholeWord===true)){G=new RegExp(E(J))}}}}var H=["ds6w:created","ds6w:identifier","ds6w:modified","ds6w:responsible","ds6w:type","ds6wg:revision","thumbnail"];this._matchedNodeList=this.search({match:function(N){if(I&&G.test(N.nodeModel.getLabel())){return true}for(var L=0;L<H.length;L++){var O=H[L].cv_name;if(N.nodeModel.options.grid.hasOwnProperty(O)){var M=N.nodeModel.options.grid[O];if(M&&G.test(M)){return true}}}return false}});if(this._matchedNodeList){u.optimizedForEach(this._matchedNodeList,function(M,L){M.matchSearch();M.reverseExpand()})}return this._matchedNodeList},_shouldAcceptDrop:function(E){var D=E.dropPosition;return(D!=="top"&&D!=="bottom")},_shouldAcceptDrag:function(D,E){return true},_selectOccurence:function(G,K){var L=this.getRoots(),I=this,M=this._selected_paths;if(M.length>0){var E=false;if(G!=="FocusOn"){this._doNotBroadcastSelect=true}this.prepareUpdate();var J=[];L.forEach(function(N){for(var O=0;O<M.length;O++){var Q=N.getNodeByPath(M[O]);if(Q){E=true;J.push(Q);if(!Q.isVisible()){var P=Q.getParent();while(!P.isVisible()){P=P.getParent()}if(P){if(J.indexOf(P)===-1){J.push(P)}}}}}});if(K!==true||E===true){var F=this.getSelectedNodes();for(var H=0;H<F.length;H++){var D=F[H];if(J.indexOf(D)<0){D.unselect()}}}J.forEach(function(N){if(!N.isSelected()){N.select()}});this.pushUpdate();this._doNotBroadcastSelect=false}},_buildSelectData:function(){var K=[],F=this,J=this._selected_paths;if(m.getSetting("add_objects_when_select")===true&&J.length&&this.getXSO().get().length){var I=this.getRoots();I.forEach(function(M){for(var N=0;N<J.length;N++){var O=M.getNodeByPath(J[N],undefined,undefined,true);if(O){K.push(O)}}})}else{K=this.getXSO().get()}var L={paths:[],tenant:r.getPlatformId()};var D;L.attributes={};L.version="1.1";var E=function(M){var N=M.getID();if(!this.attributes.hasOwnProperty(N)){this.attributes[N]={type:M.options.type,label:M.options.label}}};D=E.bind(L);L.paths=K.map(function(M){return M.getOccurencePath(D)});if(m.getSetting("authorizeChangeControl")){var H=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");try{L.changeControl=H.get()}catch(G){console.warn("No Change")}}F._currentApp=r.getSharedId();L.sharedID=F._currentApp;if(F._pagerview!==null){L.focusOn=true}else{L.focusOn=false}return L},_colorChildren:function(I,D,H,G,E){var F=this;var J=I.getChildren();J.forEach(function(L){D.push(L.options.resourceid);D.push(L.options.relationid);H.push({color:L.options.color,pid:L.options.resourceid});H.push({pid:L.options.relationid});if(L._expandState=="collapseState"||L._expandState=="partiallyExpandedState"){if(L.getChildren()!==null){F._colorChildren(L,D,H,G,E)}else{var M=L.getOccurencePath(L.options.resourceid);G.push(M.map(function(N){return D.indexOf(N)}))}}else{var K=L.getOccurencePath(L.options.resourceid);G.push(K.map(function(N){return D.indexOf(N)}))}})},_colorize3D:function(E){if(this._collapseRepDuringExpandAll!==true){var G=this;var D=[];var I={};var F=[];var H=[];G.getRoots().forEach(function(J){if(J.options.color){D.push(J.options.resourceid);H.push({color:J.options.color,pid:J.options.resourceid});if(J._expandState=="collapseState"||J._expandState=="partiallyExpandedState"){if(J.getChildren()!==null){G._colorChildren(J,D,H,F,E)}else{var L=node.getOccurencePath(J.options.resourceid);F.push(L.map(function(M){return D.indexOf(M)}))}}else{var K=J.getOccurencePath(J.options.resourceid);F.push(K.map(function(M){return D.indexOf(M)}))}}});I={nodes:H,path:F};if(undefined!==G._commandProxy&&I.nodes.length!==0){G._commandProxy.padFilterBI({filterBIColorize:I})}}},_getLastViewpoint:function(E){var D=this;this._viewPointCallback=E;this._commandProxy.requestViewPoint();this._viewPointTimer=setTimeout(function(){if(D._viewPointCallback){D._viewPointCallback(null);D._viewPointCallback=null}},b)},applyActiveView:function(D){this.options.active_view=D},validateBranches_with_Expand:function(H,E){var G=k.extend({root_path_physicalid:k.clone(H),expand_iter:"0",intent:"explore_2D"},m.getWebAPI_Options("navigate"),true);var F=this;function D(){for(var I=0;I<H.length;I++){for(var K=0;K<H[I].length;K=K+2){var L=H[I][K];var J=F.getNodesById(L);if(k.is(J,"array")){J.forEach(function(M){if(M.options.waiting4validation===true){if(M.isRoot()===true){F.removeRoot(M)}else{var N=M.getParent();M.remove();if(N.hasChildren()===false){N.setState({state:"collapsed"});N.options.children=[]}}}})}}}z.displayNotification({msg:v.cannot_insert_branch,eventID:"error"});if(E.onFailure){E.onFailure()}}x.navigate({enopad_webapis:m.getSetting("enopad_webapis"),data:G,onComplete:function(K){var I;try{I=F.startTransaction("expand");var J=k.is(K,"string")?JSON.parse(K):K;c.process.validateAndUpdateBranches({treedocument:F,response:J});if(E.onComplete){E.onComplete()}}catch(L){D()}finally{if(I){I.end()}}},onFailure:function(I){D()}})},_onFocus:function(E,J){var G=this;if(m.getSetting("focusonPublic")===true){if(E.intent==="focus"){if(G.options.active_view==="treelistview"||G.options.active_view==="graphview"){var D=[];G._doNotBroadcastSelect=true;G._selectedIdx=0;var I=false;G._selection=[];var K=E.paths;K.forEach(function(N){var M=G.getNodeByOccurencePath(N);if(M){if(M.getID()===N[N.length-1]&&M.options.isPADHidden!==true){G._selection.push(N)}else{if((M.getID()===N[0]&&M.getBadges().bottomRight!=="filter")){G._selection.push(N);I=true}else{if(N.indexOf(M.getID())!==-1){G._selection.push(N);I=true}}}}});G.originalSelection=G._selection;if(G._selection.length>1){if(null===G._pagerview){G._pagerview=new f({renderTo:document.body});G._pagerview.subscribe({event:"previous"},function(){G.focusChange({event:"previous"});G._commandProxy.focusChange({sharedID:r.getSharedId(),event:"previous"})});G._pagerview.subscribe({event:"next"},function(){G.focusChange({event:"next"});G._commandProxy.focusChange({sharedID:r.getSharedId(),event:"next"})});G._pagerview.subscribe({event:"close"},function(){G.getXSO().empty();G.restoreSelection();G._commandProxy.focusChange({sharedID:r.getSharedId(),event:"close"})});G._pagerview.show()}var F=G.startTransaction("focusOn");var L=0,H=0;G.withTransactionUpdate(function(){G._selection.forEach(function(M){L++;H++;D.push(M);if(L===G._selection.length||H===300){H=0;G._reframeFocus=true;G.insertBranches(D,{onComplete:function(){G._doNotBroadcastSelect=true;G._colorize3D(this);G._reframeFocus=false;G.getNodeByOccurencePath(G._selection[G._selectedIdx]).select()}});D=[]}if(L===G._selection.length){F.end()}});if(I===true){G._commandProxy.padExpand({paths:G._selection,expand_level:"1"})}G.reframeOn({idx:G._selectedIdx})})}else{if(G._pagerview){G._pagerview.hide();delete G._pagerview}G.insertBranches(G._selection,{onComplete:function(){G._doNotBroadcastSelect=true;G._colorize3D(this)}});if(I===true){G._commandProxy.padExpand({paths:G._selection,expand_level:"1"})}G.reframeOn({idx:G._selectedIdx})}}}}else{if(E.intent==="centerTree"){G._doNotBroadcastSelect=true;G.insertBranches(E.paths,{onComplete:function(){G.withTransactionUpdate(function(){if(E.paths.length>1){G.unselectAll()}var N=[];for(var M=0;M<E.paths.length;M++){var O=G.getNodeByOccurencePath(E.paths[M]);if(O){if(M===0){O.select(true);G.getModelEvents().publish({event:"onCenterGraph",data:O})}else{N.push(O)}}}G.multiselect(N)});G._doNotBroadcastSelect=false;G._colorize3D(this)}})}}},focusChange:function(E){var D=this;if(D._selection){if(E.event=="previous"){D._selectedIdx--;D.reframeOn()}if(E.event=="next"){D._selectedIdx++;D.reframeOn()}}},reframeOn:function(){var G=this;if(G._selectedIdx===-1){G._selectedIdx=G._selection.length-1}var D=G._selectedIdx%G._selection.length;if(G._pagerview){var E=(D+1)+"/"+G._selection.length;G._pagerview.setLabel(E)}var F=G.getNodeByOccurencePath(G._selection[D]);if(F){G._focusOn=true;F.select(true);G.getModelEvents().publish({event:"onCenterGraph",data:F});if(G._selection.length>1){G._pagerview.show()}}},getSelectedNodesForOFW:function(){var E=[],F=this._selected_paths;if(F&&F.length&&this.getXSO().get().length){var D=this.getRoots();D.forEach(function(G){for(var H=0;H<F.length;H++){var I=G.getNodeByPath(F[H],undefined,undefined,true);if(I){E.push(I)}}})}else{E=this.getXSO().get()}return E},_viewInsertExisting:function(H){if(!(H.modified&&H.inserted&&H.created)){throw new Error("Invalid input parameters "+JSON.stringify(H))}var F,E=[];for(F=0;F<H.modified.length;F++){E.push(this.getNodesById(H.modified[F]))}var D=m.getWebAPI_Options("fetch");var G=this;x.fetch({enopad_webapis:m.getSetting("enopad_webapis"),data:D,pids:H.inserted,onComplete:function(J){G.invalidateViewPort();var I=k.is(J,"string")?JSON.parse(J):J;if(!I.results||I.results.length<H.inserted.length){z.displayNotification({msg:v.object_not_found_in_db,eventID:"error"})}else{if(I.results.length>H.inserted.length){z.displayNotification({msg:v.tooManyResults,eventID:"error"})}else{G.wrapInTransaction(function(){var K=require("DS/PADUtils/XNavSettings");for(F=0;F<I.results.length;F++){var N=c.parse_attributes(I.results[F].attributes,K.getAvailableColumns());var M=H.inserted.indexOf(N.resourceid);N.relationid=H.created[M];if(N.children===undefined){N.children=[]}var O=new w(N);var L=E[M];if(L){L.forEach(function(Q){var P=Q.getChildById(N.resourceid);if(!P){Q.addChild(O);Q.setState({state:"partiallyExpanded"});Q.options.padstate="partiallyExpanded";y.updateNLS(O)}})}}})}}},onFailure:function(){z.displayNotification({msg:v.generic_service_failure,eventID:"error"});if(H.callback){H.callback.call()}}})},_viewDetach:function(E){if(!(E.deleted)){throw new Error("Invalid input parameters "+JSON.stringify(E))}var D=this;this.withTransactionUpdate(function(){for(var F=0;F<E.deleted.length;F++){var G=D.getNodesByRelId(E.deleted[F]);G.forEach(function(I){var H=I.getParent();H.removeChild(I)})}})},_viewReParent:function(D){this._viewInsertExisting(D);this._viewDetach(D)},_viewReplaceInstance:function(E){if(!E.couples){throw new Error("Invalid input parameters "+JSON.stringify(E))}var D=this;this.withTransactionUpdate(function(){for(var F=0;F<E.couples.length;F++){var G=D.getNodesByRelId(E.couples[F].oldId);G.forEach(function(H){H.options.relationid=E.couples[F].newId})}})},multiselect:function(D){var F=this;var E=F.getXSO();this.prepareUpdate();E.add(D);this.pushUpdate()},multiunselect:function(D){var F=this;var E=F.getXSO();this.prepareUpdate();E.remove(D);this.pushUpdate()},_expandChildren:function(H,G,F){var E=(m.getSetting("activateFUN085903")&&(G===-1||G>1));function I(L){if(L.childComputed&&L.hasChildren()){var K=L.getChildren();if(K.length===1){return K[0].options.grid.globaltype==="ds6w:Document"}}}var J=function(P,O,N){if(O===-1||N<O){if(P.childComputed){if(P.getState("collapse")){P.setState({state:"expanded"})}if(P.hasChildren()){var M=P.getChildren(),L=true;for(var K=0;K<M.length&&L===true;K++){var Q=M[K];if(Q.childComputed&&E){if(I(Q)){continue}}if(Q.childComputed&&Q._expandState!=="noExpandState"&&(Q.getDepth()<O||O===-1)){Q.setState({state:"expanded"})}L=J(Q,O,N+1);if(L===undefined){throw new Error("Undefined no_expand_needed flag")}}return L}else{return true}}else{if(O===-1||O>N){return false}else{return true}}}else{return true}};var D=J(H,G,F);return D},updateNodesAttrValue:function(J,N,Q){var H=this;var O=function(R,T,S){x.fetch({enopad_webapis:false,data:R,pids:T,noCompletion:true,onComplete:function(V){var U=k.is(V,"string")?JSON.parse(V):V;c.process.refresh_nodes({treedocument:H,response:U,refresh_parameters:{modified:T}});if(Q){Q({allNodesProcessed:S})}},onFailure:function(U){console.error(U);if(Q){Q({allNodesProcessed:S})}}})};var E=1000;if(m.getSetting("enopad_webapis")===false){var F=require("DS/PADUtils/XNavSettings");for(var P=0;P<N.length;P++){F.addAvailableColumn(N[P],true,true)}}var I={select_predicate:N,select_file:[]};var L=[];if(J.length>=E){var K=Math.trunc(J.length/E);if(J.length%E>0){K++}for(var M=0;M<K;M++){L.push(J.splice(0,J.length>=E?E:J.length))}}else{L.push(J)}for(var D=0;D<L.length;D++){var G=L[D];O(I,G,D===L.length-1)}}});return n});define("DS/ENXNav/utils/xNavSearchCoordinator",["UWA/Class","DS/ENXNav/models/_xNavCVParser","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWSAccess","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(d,a,f,i,h,c,g){var b=d.extend({init:function(j){this.options=j;this.isExecuting=false;this.accumulatedSelection=[]},execute:function(k){if(this.isExecuting){return}this.isExecuting=true;var j=this;require(["DS/PADServices/utils/PredefinedQueryUtils"],function(l){l.isPredefinedQry(k).then(function(p){var o=j.options.component;var n=j.options.component.getPADTreeDocument();var m=j.options.component.getPADTreeDocument().getRoots();if(m.length>0){j._executeMultiExpand(o,n,m,p)}else{c.displayNotification({msg:g.find_in_context_no_result,eventID:"info"});j.isExecuting=false}})})},clear:function(){},_executeMultiExpand:function(r,n,u,p){var t=UWA.extend({intent:"explore_2D"},f.getWebAPI_Options("navigate"),true);var v={select_bo:t.select_bo,select_rel:t.select_rel,compute_select_bo:t.compute_select_bo,"q.iterative_filter_query_bo":t["q.iterative_filter_query_bo"],union:{expand:[]}};var j=n.getXSO().get();for(var l=0;l<j.length;l++){j[l].unselect()}for(var m=0;m<u.length;m++){var q=u[m];var s={root_physicalid:q.getID()};if(q&&q.options&&q.options.sequence_filter){s.sequence_filter=q.options.sequence_filter}if(q&&q.options&&q.options.config_filter){s.config_filter=q.options.config_filter}if(q&&q.options.CVQuery){if(q.options.CVQuery.sequence_filter){s.sequence_filter=q.options.CVQuery.sequence_filter}if(q.options.CVQuery.config_filter){s.config_filter=q.options.CVQuery.config_filter}}s["q.iterative_filter_query_bo"]=v["q.iterative_filter_query_bo"];s.no_type_filter_rel=v.no_type_filter_rel;s.find_in_context=[{"q.query":p}];v.union.expand.push(s)}v.label=h.getRequestLabel();var o=this;i.multiexpand({enopad_webapis:false,data:v,onComplete:function(A){var x=typeof A==="string"?JSON.parse(A):A;var k=n.startTransaction("multiexpand");if(x.results.length===0){c.displayNotification({msg:g.find_in_context_no_result,eventID:"info"})}else{n._doNotBroadcastSelect=true;a.process.expand({treedocument:n,root_nodes:u,response:x,mode:"find_in_ctx",expand_level:1,selectPathLeaf:true});var z=n.getXSO().get();var y={paths:[]};for(var w=0;w<z.length;w++){y.paths.push(z[w].getOccurencePath())}if(z.length===0){c.displayNotification({msg:g.find_in_context_no_result,eventID:"info"});r._commandProxy.padExpand(false)}n._doNotBroadcastSelect=false;r.options.flags.whenPerformingSearch=Date.now()}k.end();o.isExecuting=false},onFailure:function(k){o.isExecuting=false;c.displayNotification({msg:g.generic_service_failure,eventID:"error"})}})}});return b});define("DS/ENXNav/mixins/xNavChangeAction",["UWA/Class","DS/ENXNav/models/_xNavCVParser","DS/PADUtils/views/PADAlert","DS/PADUtils/PADWSAccess","DS/PADUtils/PADWSProxy","DS/PADUtils/PADChangeActionHandler","DS/PADUtils/PADCommandProxy","i18n!DS/ENXNav/assets/nls/ENXNav.json","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,f,c,j,i,h,a,k,d){var g=b.extend({loadChange:function(n){var p=this;p.beginBlockingTransaction(d.retrieveChangeAction);var m=this.getPADTreeDocument();var l=m.getRoots();l=l.concat(m.getDetachedRoots());var o=n.objects.map(function(q){return q.objectId});h.getInfos(o,function(q){p.beginBlockingTransaction(d.loadChangeAction);var r=-1;var s=function(){r++;if(r<q.length){var t=q[r];p._processCA(t,s)}else{p.endBlockingTransaction();if(n.callback){n.callback()}}};s()})},_processCA:function(p,o){var n=this;var l=h.parseAttributes(p.changeaction.attributes);h.determineExecution(p,{addAndFind:function m(v){var w=h.extractIds(v.changeaction.context);var x=h.extractRealizedAndProposed(v);var u=n.getPADTreeDocument();var s=u.getRoots();s=s.concat(u.getDetachedRoots());var t=s.map(function(y){return y.getID()});if(s.length){n.dropInvitContainer.hide(n.dropInvitContainer.active_invite)}var r=w.filter(function(y){return t.indexOf(y)===-1});if(r.length!==w.length){c.displayNotification({msg:d.root_already_loaded});if(r.length===0&&o){o()}}if(r.length>0){n.performCAFindInContext({rootIds:r,findIds:x},o)}},add:function q(v){var w=o?o:undefined;var u=n.getPADTreeDocument();var s=u.getRoots();s=s.concat(u.getDetachedRoots());var t=s.map(function(x){return x.getID()});if(s.length){n.dropInvitContainer.hide(n.dropInvitContainer.active_invite)}var r=v.filter(function(x){return t.indexOf(x)===-1});if(r.length===0){c.displayNotification({msg:d.root_already_loaded});if(o){o()}}else{n.add({content:"idslist",pids:r,callback:w})}},wasEmpty:function(){n.dropInvitContainer.show("drop");if(o){o()}}})},performCAFindInContext:function(m,p){var o=this;var n=m.rootIds;var r=m.findIds;var l=o.getPADTreeDocument();var q=new Promise(function(t,s){o.add({content:"idslist",pids:n,broadcast:false,callback:function(){t()}})});q.then(function(){var u=[];for(var s=0;s<n.length;s++){var t=i.find_in_ctx({rootId:n[s],findids:r});u.push(t);t.then(function(w){if(w.results.results.length===0){c.displayNotification({msg:d.find_in_context_no_result,eventID:"info"});var x=require("DS/PADUtils/PADUtilsServices");var v={pids:[w.params.rootId],tenant:x.getPlatformId()};o._commandProxy.drop(v)}else{f.process.expand({starting_from_root:true,root_nodes:l.getRoots(),treedocument:l,response:w.results,mode:"find_in_ctx",expand_level:1,selectPathLeaf:true,addedPaths:function(A){var z=require("DS/PADUtils/PADUtilsServices");var y={paths:A,tenant:z.getPlatformId()};o._commandProxy.drop(y)}});o.dropInvitContainer.hide(o.dropInvitContainer.active_invite)}})["catch"](function(v){console.error(v)})}Promise.all(u).then(function(){if(p){p()}})["catch"](function(v){if(p){p()}})})}});return g});define("DS/ENXNav/mixins/_xNavCtx",["UWA/Class","i18n!DS/ENXNav/assets/nls/ENXNav.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/ApplicationFrame/CommandsManager","DS/UIBehaviors/ContextualMenuManager","DS/WebappsUtils/WebappsUtils","DS/etree/syncwidget","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices","DS/ENXNav/utils/OpenWithMenuBuilder","UWA/Promise"],function(c,p,f,b,o,d,l,i,n,j,k){function g(t,r){var v=r.length;var q=0;var w=0;for(var s=0;s<v;s++){var u=r[s];if(t.getThumbnailState(u)===l.ThumbnailState.EXPANDED){q++}else{w++}}return q>w}function h(t,w,q){var v=t.getColumnIDFromDataIndex(w);var x=t.getContent().querySelectorAll('.wux-datagrid-cell[virtual-column-id="'+v+'"]');var s=0;for(var u=0;u<x.length;u++){var r=x[u].clientWidth;if(r>s){s=r}}if(s>q){var y=function(){t.prepareUpdateView();t.setColumnWidth(v,q);t.pushUpdateView()};t.onPostUpdateViewOnce(y);y()}}var a=0;var m=c.extend({getOnContextualEvent:function(){return{"this":this,callback:function(s){if(a){console.error("Call count "+a)}a++;var r=this;var q=new k(function(A,B){var w=[];var t=[];var y=null,u=false;if(s.graphview){y=s.graphview.node}else{if(s.treeview){y=s.treeview.nodeModel?s.treeview.nodeModel:s.treeview.cellModel;u=s.treeview.isHeader}else{y=s.cellInfos?s.cellInfos.nodeModel?s.cellInfos.nodeModel:s.cellInfos.cellModel:null}}var x={available:false};if(y&&u===false){if(y.isSelected()===false){y.select(true)}if(s.treeview&&s.treeview.cellView.getCellInfos().dataIndex==="instanceMatrix"){x=r.psePositionCtxCmd(s)}if(x.available===true){w=x.menu;A(w)}else{if(i.getSetting("activateOpenWithPlatform")===true){var v=r.getPADTreeDocument().getSelectedNodes();if(v.length>0){var z=j.openWithApps(v,{iconOpenWith:d.getWebappsAssetUrl("ENXNav","icons/32/I_OpenWith.png"),nlsOpenWith:p.OpenWith});t.push(z)}}}}if(x.available===false){k.all(t).then(function(E){for(var D=0;D<E.length;D++){w=w.concat(E[D])}var C=function(G){w=w.concat(G);if(r.options.additionalColumnsModules&&r.options.additionalColumnsModules.length){var J=[];var H=[];var K=[];for(var F=0;F<r.options.additionalColumnsModules.length;F++){if(r.options.additionalColumnsModules[F].getAdditionalCtxMenu){var I=new k(function(L){r.options.additionalColumnsModules[F].getAdditionalCtxMenu({treeDocument:r.getPADTreeDocument(),ctxParams:s,callback:function(M,N){if(M&&K.indexOf(M)===-1){K.push(M);if(UWA.is(N,"object")){H.push({type:"SeparatorItem"});H.push(N)}}L()}})});J.push(I)}}k.all(J).then(function(){w=w.concat(H);A(w)})}else{A(w)}};if(s.graphview){r.graphViewMenu(s,C)}else{if(s.treeview){r.treeViewMenu(s,C)}else{r.otherViewMenu(s,C)}}})}});a--;return q}}},graphViewMenu:function(v,q){var u=[],t=this;var s=v.graphview.node;if(s){if(s.isSelected()===false){s.select(true)}var w=this.getPADTreeDocument().getSelectedNodes();var r=g(this.options.views.graphview,w);u.push({icon:r?"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_Collapse-thumbnail.png")+")":"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_Expand-thumbnail.png")+")",title:r?p.PAD_CMDCollapseThumb:p.PAD_CMDExpandThumb,type:"PushItem",action:{"this":this,context:{nodes:w,expanded:r},callback:function(x){t.options.views.graphview.setGroupThumbnailState(x.context)}}});u=u.concat(this.commonMenu(s))}q(u)},treeViewMenu:function(x,q){var w=[];if(x.treeview.isHeader){var v=x.treeview.manager;var u=x.treeview.dataIndex;var r=x.treeview.manager._instance._parentObject.thumbnail_size;var s={type:"PushItem",icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_FitToColumn.png")+")",title:p.PAD_CMDColumnToFit,action:{context:u,callback:function(y){if(y.context==="thumbnail"){h(v,y.context,r)}else{v.sizeColumnToFit(y.context)}}}};w.push(s);this.pseTreeColMenu(w,x,q)}else{var t=x.treeview.nodeModel?x.treeview.nodeModel:x.treeview.cellModel;if(t){if(t.isSelected()===false){t.select(true)}this.pseTreeMenu(w,t,x.treeview.cellView.getCellInfos());w=w.concat(this.commonMenu(t))}q(w)}},otherViewMenu:function(t,q){var s=[];var r=t.cellInfos?t.cellInfos.nodeModel?t.cellInfos.nodeModel:t.cellInfos.cellModel:null;if(r){if(r.isSelected()===false){r.select(true)}s=this.commonMenu(r)}q(s)},commonMenu:function(r){var q=[],A=this;var B=b.getCommand("OpenInCADHdr",this.options.action_bar_opts&&this.options.action_bar_opts.context?this.options.action_bar_opts.context:null);if(B&&B.isAvailable()){q.push({title:f.PAD_CMDOpenInCAD,icon:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_OpenInCAD.png")+")",type:"PushItem",action:{callback:A._openInCAD.bind(A)}});q.push({type:"SeparatorItem"})}if(r!==null&&r!==undefined){var v=r.options.isPADHidden?true:false;var w=true;var t=true;var y=A.options.model.getSelectedNodes();if(y.length>1){var s=y[0].options.isPADHidden;for(var x=0;x<y.length;x++){if(s!==y[x].options.isPADHidden){w=false}if(!y[x].isRoot()){t=false}}}else{if(!r.isRoot()){t=false}}if(!n.isWebInWinContext()){var z={type:"PushItem",icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_HideShow.png")+")",title:p.PAD_CMDShow,action:{callback:function(D){var C=[];if(y.length>1){y.forEach(function(E){C.push(E.getOccurencePath())})}else{C.push(r.getOccurencePath())}A._commandProxy.show({paths:C})}}},u={type:"PushItem",icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_HideShow.png")+")",title:p.PAD_CMDHide,action:{callback:function(D){var C=[];if(y.length>1){y.forEach(function(E){C.push(E.getOccurencePath())})}else{C.push(r.getOccurencePath())}A._commandProxy.hide({paths:C})}}};if(w===true){if(v){q.push(z)}else{q.push(u)}}else{q.push(z);q.push(u)}if(i.getSetting("FocusCtxCommandAvailable")===true){q.push({type:"PushItem",title:p.PAD_CMDFocusOn,icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_FocusOn.png")+")",action:{callback:function(){var D=require("DS/PADUtils/PADUtilsServices");var C=[];if(y.length>1){y.forEach(function(E){C.push(E.getOccurencePath())})}else{C.push(r.getOccurencePath())}A._commandProxy.focus({intent:"focus",paths:C,widget:"2D",sharedID:D.getSharedId(),appID:D.getAppId()})}}})}q.push({type:"SeparatorItem"})}if(r._expandState!=="noExpandState"){q.push({title:p.PAD_CMDExpandAll,icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_ExpandAll.png")+")",state:r._expandAllPending===true?"disabled":"enabled",type:"PushItem",action:{callback:A._expandAll.bind(A)}});q.push({title:p.PAD_CMDCollapseAll,icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_CollapseAll.png")+")",type:"PushItem",action:{callback:A._collapseAll.bind(A)}})}q.push({title:p.PAD_CMDProperties,icon:"url("+d.getWebappsAssetUrl("ENOCollabSharingCmds","icons/32/I_CATSSEditorDisplayProperties.png")+")",type:"PushItem",state:this.getEditMode?(this.getEditMode()?"enabled":"disabled"):"enabled",action:{callback:A._editProperties.bind(A)}});this.ccpMenu(q,r);if(t){q.push({type:"SeparatorItem"});q.push({title:p.detachRoot,icon:"url("+d.getWebappsAssetUrl("ENXNav","icons/32/I_HideShow.png")+")",type:"PushItem",action:{callback:function(){var D=A.options.model.getSelectedNodes();for(var C=0;C<D.length;C++){A.toggleRoot(D[C])}}}});q.push({type:"PushItem",title:p.removeRoot,icon:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_RemoveAll.png")+")",action:{callback:function(E){var D=A.options.model.getSelectedNodes();for(var C=0;C<D.length;C++){A.options.model.removeRoot(D[C])}}}})}}return q},ccpMenu:function(r,q){},pseTreeMenu:function(r,q,s){},psePositionCtxCmd:function(q){return{available:false}},pseTreeColMenu:function(s,r,q){q(s)}});m.prototype._expandAll=function(){this._launchAction({command:"ExpandAll"})};m.prototype._openInCAD=function(){this._launchAction({command:"OpenInCADHdr"})};m.prototype._collapseAll=function(){this._launchAction({command:"CollapseAll"})};m.prototype._editProperties=function(){this._launchAction({command:"ActionBar_Attributes"})};m.prototype._launchAction=function(r){var q=b.getCommand(r.command,this.options.action_bar_opts&&this.options.action_bar_opts.context?this.options.action_bar_opts.context:null);if(q){q.begin()}};return m});define("DS/ENXNav/XNavComponent",["css!DS/ENXNav/ENXNav","i18n!DS/PADUtils/assets/nls/PADUtils.json","i18n!DS/ENXNav/assets/nls/ENXNav.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Promise","DS/Core/Core","DS/UIKIT/Mask","DS/Utilities/Utils","DS/WebappsUtils/WebappsUtils","text!DS/ENXNav/assets/templates/XNavComponent.html","DS/ENXNav/mixins/_xNavDnD","DS/ENXNav/mixins/_xNavCtx","DS/ENXNav/mixins/_xNavRootListMgt","DS/ENXNav/mixins/_xNavBIFilter","DS/ENXNav/mixins/_xNavRefresh","DS/ENXNav/mixins/xNavChangeAction","DS/ENXNav/utils/xNavSearchCoordinator","DS/PADUtils/views/PADAlert","DS/PADUtils/PADPromise","DS/PADUtils/PADSession"],function(y,o,n,l,z,A,q,h,w,F,f,j,E,x,c,i,k,s,m,p,C,d,r){var v="xnav_component";var t=z.extend(A,q,x,c,i,k,s,m,{_dispatchReady_NotDone:true,defaultOptions:{widget:null,elements:null,active_view:"treelistview",action_bar_opts:null,toolbar_opts:null,layout:{padshell:false,title_update:true,view_customization:null,store_roots_in_pref:true,statusInfo:true,drop_invite:"dynamic",keyboard_inputs:true,triptychOpts:{left:{resizable:true,originalState:"close",overMobile:true,minWidth:300,withClose:true},withtransition:true,withoverflowhidden:true,right:{resizable:true,originalState:"close",overMobile:true,minWidth:250,withClose:false}}},amd_custo:{TreeDocument:"DS/ENXNav/models/xNavDocument",TreeListView:"DS/ENXNav/views/xNavTreeListView",TreeGraph:"DS/ENXNav/views/xNavGraphView",TileGridView:"DS/ENXNav/views/xNavResponsiveTilesView",ThumbnailGridView:"DS/ENXNav/views/xNavResponsiveThumbnailsView"},views:{treelistview:null,graphview:null,tileview:null,thumbnailview:null},views_cb:{},isReady:{model:false,actionbar:false,treelistview:false,graphview:false,tileview:false,thumbnailview:false,}},_probes:{},init:function(G){this._parent(G);this.options=l.extend(this.options,G,true);this.elements.container=l.createElement("div",{"class":v});this.options.flags={};this.search=new p({component:this});var H=this;require(["DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADProbes","DS/PADUtils/PADWebInWinServices"],function(J,L,K,I,M){H._probes.probe_init=I.createProbe("init_xnavcomponent");M.initialize({widget:widget});if(widget){if(widget.lang){J.setSetting("lang",widget.lang)}}L.app_initialization(function(N){var O=function(){H._commandProxy=K.create({events:{onDrop:function(W,V){L.updatePlatformId(W.tenant);var X=W.already_added_in_PS!==true;if(V.originWidgetId){X=W.already_added_in_PS!==true||(V.originWidgetId!==L.getWidgetId()&&J.getSetting("activateFUN076708")===true)}if(X){H.add({content:W.paths===undefined?"idslist":"pathslist",paths:W.paths===undefined?undefined:W.paths,pids:W.pids===undefined?undefined:W.pids,filters:W.filters,loadWithFilter:W.loadWithFilter,callback:null,broadcast:false})}},onDropFilter3D:function(W,V){H.addFilter({content:"3DXContent",filter_objects:W.droppedFilters,broadcast:(W.broadcast===undefined)?true:W.broadcast,callback:undefined,behavior:"fromDrop"})},onRemove:function(V){H._onRemoveRoot(V)},onCleanAll:function(){H.empty(false)},onRefreshModel:function(){if(l.is(H.refresh,"function")){H.refresh(false)}},onApplyFilter:function(V){V.doNotBroacast=true;H.applyFilter(V)},onDetach:function(V){H.detachRoots(V)},onAttach:function(V){H.attachRoots(V)},onSlaveBIToggle:function(V){H._biSlave3D=V.isSlave},onSearchInApp:function(V){if(H.search){H.search.execute(V.query)}}}});var S=J.getURLParameter("additionalColumns");if(S!==null){var P=function(V){if(!H.options.additionalColumnsModules){H.options.additionalColumnsModules=[]}H.options.additionalColumnsModules.push(V)};var R=d.getPromises();var U=R.slice();var Q=new h(function(V){h.all(U).then(function(){require([S],function(W){W.isAdditionalColumnsAvailable(function(X){if(X===true){P(W)}V()})})},function(){console.warn("Unknow AMD module "+S);V()})});Q.name="Add "+S;R.push(Q)}H._probes.probe_model=I.createProbe("init_xnav_model");D.call(H);H._probes.probe_view=I.createProbe("init_xnav_views");B.call(H);var R=d.getPromises();var U=R.slice();var T=new h(function(V){h.all(U).then(function(){H.options.model.getVisibleAdditionalColumns=function(){var Z=[];var ad=H.getPADTreeListView().getManager();if(H.options.additionalColumnsModules&&H.options.additionalColumnsModules.length){for(var ac=0;ac<H.options.additionalColumnsModules.length;ac++){var ab=[];var aa=H.options.additionalColumnsModules[ac];var af=aa.getManagedColumnNames();for(var ae=0;ae<af.length;ae++){if(!ad.isColumnHidden(af[ae])){ab.push(af[ae])}}if(ab.length){Z.push({module:aa,columns:ab})}}}return Z};H.options.model.forceSyncModel4TreeListView=function(){if(H.options.active_view==="treelistview"){H.options.views.treelistview.getManager().syncModel(false)}};var X=function(){H.options.views.treelistview.previousClick.idClicked="";H.options.views.treelistview.previousClick.date=""};H.options.model.getXSO().onPostRemove(X);H.options.model.getXSO().onEmpty(X);var W=f.debounce(function(ad){var ab=ad.displayNodesArray;if(ab.length){if(H.options.additionalColumnsModules&&H.options.additionalColumnsModules.length){H.options.model.fillAttributesAsync4VisibleNodes(ab)}if(H.colorMap&&J.getSetting("ExpandSynthesisON")===true){H.options.model.updateColorForNodes(ab,H.colorMap,H.predicateKind)}var ac=require("DS/PADUtils/PADPredicatesNls");for(var Z=0,aa=ab.length;Z<aa;Z++){if(ab[Z]._manageNLS===true){delete ab[Z]._manageNLS;ac.updateNLS(ab[Z])}}}},200);H.options.views.treelistview.getManager().onHeavyDataColumnModelRequest(W);if(J.getSetting("supportPgpBasedOnDescription")){var Y=J.getWebAPI_Options("navigate");Y.select_rel.push("ro.plminstance.V_description");J.setWebAPI_Options("navigate",Y)}H._dispatchReady(H.options.objects2Load?true:false);if(H.options.objects2Load){H.openStoredObjects(H.options.objects2Load)}V()})});T.name="dispatchReady";R.push(T)};if(N&&(N.success===true)){O()}else{H._initialize_failure(function(){H.dispatchEvent("onReady")})}})})},render:function(){return this.elements.container},openStoredObjects:function(H){var G=this;return new h(function(I){var N=d.getPromises();var M=[];if(H.products){var L=Object.getOwnPropertyNames(H.products);if(L.length){var J=new h(function(Q){h.all(N).then(function(){G.add({content:"structure",structure:H.products,id_to_detach:H.id2detach,broadcast:false,loadWithFilter:H.withFilter,callback:function(){if(H.withFilter===true){if(r.isAuthoring()){C.displayNotification({msg:o.noFilterOnAuthoring,eventID:"warning"});G.disableFilterWaiting()}else{if(H.fromProxy!==true){require(["DS/ApplicationFrame/CommandsManager"],function(R){var S=R.getCommand("DefineFilter");if(S){S.begin()}})}}}Q()}})})});J.name="AddRoots";M.push(J)}}if(H.filters){var P=require("DS/PADUtils/PADUtilsServices");var O=Object.getOwnPropertyNames(H.filters);if(O.length){var K=new h(function(Q){h.all(N).then(function(S){var T=[];for(var R=0;R<O.length;R++){T.push({envId:P.getPlatformId(),serviceId:"3DSpace",objectId:O[R],objectType:"ENOStrRefinementSpecification"})}G.addFilter({filter_objects:T,broadcast:false,callback:function(V){if(H.id2detach){var W=[];for(var U=0;U<V.length;U++){if(H.id2detach.indexOf(V[U])!==-1){W.push(V[U])}}G.detachRoots({pids:W})}Q()}})})});K.name="AddFilters";M.push(K)}}h.all(M).then(function(){if(G.options.model.getRoots().length===0&&G.options.model.getDetachedRoots().length===0){var Q=require("DS/PADServices/utils/GlobalModelEvents");var R=Q.getModelEvents();R.publish({event:"ENXViews/WelcomePanel/activate"})}I()})})},openDroppedObjects:function(H){var G=this;return new h(function(I){var K=require("DS/PADUtils/PADUtilsServices");function N(P){if(G.options.model.getRoots().length===0&&G.options.model.getDetachedRoots().length===0){var O=require("DS/PADServices/utils/GlobalModelEvents");var Q=O.getModelEvents();Q.publish({event:"ENXViews/WelcomePanel/activate"})}I(P)}function J(R){if(R.authorized_objects.length===0){var Q={error:"noAuthObj"};if(R.unsupportedDropNotified===true){C.displayNotification({msg:o.msg_warning_dndnotsupported,eventID:"error"});Q.what="unsupportedDropNotified"}N(Q)}else{var P=H.behavior?H.behavior:"WITH_CONTEXT";var O=G.options.model.getRoots();K.multiTenantMgt(R.authorized_objects,O,function(S){if(!S.isMultiTenant){if(R.authorizedWithKind){if(R.authorizedWithKind.Product&&R.authorizedWithKind.Product.length>0){G.add({content:"3DXContent",authorized_objects:R.authorizedWithKind.Product,callback:N,behavior:P,isDrop:true})}if(R.authorizedWithKind.Filter&&R.authorizedWithKind.Filter.length>0){G.addFilter({content:"3DXContent",filter_objects:R.authorizedWithKind.Filter,callback:N,behavior:undefined})}if(R.authorizedWithKind.Change&&R.authorizedWithKind.Change.length>0){if(G.loadChange){G.loadChange({content:"3DXContent",objects:R.authorizedWithKind.Change,callback:N,behavior:P})}else{N({})}}}else{G.add({content:"3DXContent",authorized_objects:R.authorized_objects,callback:N,behavior:P})}}})}}if(H.behavior==="FILTER"&&H.fromProxy!==true){require(["DS/ApplicationFrame/CommandsManager"],function(O){var P=O.getCommand("FilterDropObjects");if(P){P.execute(H.unserializedData)}else{console.error("XNavComponent## FilterDropObjects command is undefined")}N(P?undefined:{error:"noCommandAvailable"})})}else{var M=l.extend({notifPerObjects:true,displayNotif:false,callback:J,version:"2.0"},H);var L=require("DS/PADUtils/PADTypesMgt");L.retrieveAuthorizedObjects(M)}})},add:function(J){var Y=J||{};var L=[];var M=[];var U=[];switch(J.content){case"idslist":Y=J;L=Y.pids;break;case"pathslist":for(var S=0;S<J.paths.length;S++){var T=J.paths[S][0];if(L.indexOf(T)===-1){L.push(T)}}break;case"3DXContent":Y=b(J);Y.callback=J.callback;L=Y.pids;break;case"structure":Y=u(J);Y.callback=J.callback;for(var R=0;R<Y.paths.length;R++){var Q=Y.paths[R][0];if(L.indexOf(Q)===-1){L.push(Q)}}if(Y.paths.length===0&&Y.pids.length===0){if(Y.callback){Y.callback()}return}break;case"filters":var N=false;var P=-1;if(Y.pids===undefined){Y.pids=[]}if(J.rootsWithFilters&&J.rootsWithFilters.length>0){for(var V=0;V<J.rootsWithFilters.length;V++){var W=J.rootsWithFilters[V].rootId;var X=J.rootsWithFilters[V].filterId;var G=J.rootsWithFilters[V].filterName;if(L.indexOf(W)===-1){L.push(W);Y.pids.push(W)}else{N=true;P=V;break}if(M.indexOf(X)===-1){M.push(X)}if(U.indexOf(G)===-1){U.push(G)}}if(N&&P!==-1){J.rootsWithFilters.splice(P)}}if(N===true){C.displayNotification({msg:o.filterMultipleSameRoot,eventID:"warning"})}Y.rootsWithFilters=J.rootsWithFilters;Y.callback=J.callback;break;default:throw new Error("Not supported content")}if(J.loadWithFilter===true){this.disableUX();Y.loadWithFilter=true;this._wait4Filter=true}var K=this;Y.rootIds=L;Y.filterIds=M;Y.filterNames=U;var O=d.getPromises();var I=O.slice();var H=new h(function(aa,Z){h.all(I).then(function(ab){K._internalAdd(Y,aa);K.dropInvitContainer.hide()})});H.name="add";O.push(H)},_internalAdd:function(H,P){var J=this;F.mask(this.elements.container);var O=H.callback;var L=function(R,T){if(R.broadcast!==false){var U={pids_hidden:R.id_to_detach};var W=true;if(H.loadWithFilter===true&&r.isAuthoring()===false){U.loadWithFilter=true;if(T.alreadyLoadedRoots&&T.alreadyLoadedRoots.length){if(R.rootIds.length===T.alreadyLoadedRoots.length){var S=true;for(var Q=0;Q<R.rootIds.length&&S;Q++){if(T.alreadyLoadedRoots.indexOf(R.rootIds[Q])===-1){S=false}}if(S===true){W=false}}}}if(W===true){if(R.rootsWithFilters&&U.loadWithFilter!==true){U.rootsWithFilters=R.rootsWithFilters}else{if(R.paths){U.paths=R.paths}else{U.pids=R.pids}}var V=require("DS/PADUtils/PADUtilsServices");U.tenant=V.getPlatformId();if(R.is3DContent){return}J._commandProxy.drop(U)}}};var M=function(T){J.options.model.prepareBroadcastSelect();J.options.model.unselectAll();var S=H.paths;if(!l.is(H.paths,"array")){S=[];for(var R=0;R<H.rootIds.length;R++){S.push([H.rootIds[R]])}}for(var Q=0;Q<S.length;Q++){if(J.options.model.getNodeByOccurencePath(S[Q])){J.options.model.getNodeByOccurencePath(S[Q]).select()}}J.options.model.pushBroadcastSelect()};function K(Q){if(J.options.active_view==="graphview"&&J.options.views.graphview){J.options.views.graphview.reframeOn();J.options.views.graphview.reframeAll()}if(J.options.model.getRoots(undefined).length===0&&J.options.model.getDetachedRoots().length===0){J.dropInvitContainer.show("drop")}else{if(J.dropInvitContainer){J.dropInvitContainer.hide()}}if(l.is(O,"function")){if(Q=="error"){O(Q)}else{O.call(null,H.rootsWithFilters?H.rootsWithFilters:null,Q)}}L(H,Q);M(H);P()}function I(){C.displayNotification({eventID:"success",msg:n.addRootSuccessNotif})}if(l.is(H.paths,"array")){F.unmask(J.elements.container);var N=this.options.model.getRoots();var G=[];if(N&&N.length>0){N.forEach(function(Q){if(Q.options.isRootAttached){G.push(Q.options.resourceid)}})}this.options.model.addPaths({paths:H.paths,callback:function(V,Q){if(!V.success){if(l.is(V.idleRootIds,"array")){var S=[];V.idleRootIds.forEach(function(X){if(G.indexOf(X)===-1){S.push(X)}});if(S.length>0){var U={};U.pids=S;J._onRemoveRoot(U);if(G.length>0){G.filter(function(X){return this.indexOf(X)<0},S)}var T=require("DS/PADUtils/PADUtilsServices"),R=T.getPlatformId(),W=T.getTenantsPreference();if(G.length>0&&W.length>1){J.options.widget.setTitle(G.length+o.multi_root_tile+R)}else{J.options.widget.setTitle("")}}}}else{if(l.is(H.id_to_detach,"array")&&H.id_to_detach.length>0){H.id_to_detach.forEach(function(Y){var X=J.options.model.searchRootById(Y);if(l.is(X)){J.toggleRoot({context:X})}})}J.dispatchEvent("onAddPaths",{addedPaths:H.paths});I()}K(Q)}})}else{this.options.model.add({pids:H.rootIds,rootsWithFilters:H.rootsWithFilters,callback:function(Q){if(l.is(H.id_to_detach,"array")&&H.id_to_detach.length>0){H.id_to_detach.forEach(function(V){var U=J.options.model.searchRootById(V);if(l.is(U)){J.toggleRoot({context:U})}})}if(l.is(H.paths,"array")){var R=J.options.model;R.insertBranches(H.paths,{onComplete:function(){R.prepareBroadcastSelect();R.unselectAll();for(var U=0;U<H.paths.length;U++){if(R.getNodeByOccurencePath(H.paths[U])){R.getNodeByOccurencePath(H.paths[U]).select()}}R.pushBroadcastSelect();if(J.options.active_view==="graphview"){J.options.views.graphview.reframeOn()}}})}else{var T=[];for(var S=0;S<H.rootIds.length;S++){T.push([H.rootIds[S]])}J.dispatchEvent("onAddPaths",{addedPaths:T});if(H.filterIds.length>0){J.dispatchEvent("onAddFilters",{filterIds:H.filterIds,rootIds:H.rootIds,filterNames:H.filterNames})}if(Q!=="error"){I()}}F.unmask(J.elements.container);K(Q)}})}},empty:function(K){var J=this,M=[],H=(K===false)?false:true;var G=d.getPromises();var L=G.slice();var I=new h(function(O,N){h.all(L).then(function(P){var Q=J.options.model;if(Q){Q.unselectAll()}if(H===true){J._commandProxy.cleanAll()}if(Q){Q.getRoots(true).forEach(function(R){M.push(R)});Q.getDetachedRoots().forEach(function(R){M.push(R)});Q.wrapInTransaction(function(){Q.withTransactionUpdate(function(){M.forEach(function(R){if(!l.is(J.elements.navrootlist)){Q.removeRoot(R)}else{J.elements.navrootlist.empty()}})})});if(Q._pagerview){Q._pagerview.hide();Q._pagerview=null}if(J.options.views.treelistview.getManager().isColumnHidden("bi_color")!==true){J.options.views.treelistview.getManager().hideColumn("bi_color")}if(J.options.widget.getValue("saved_filter_ids")){J.options.widget.setValue("saved_filter_ids","[]")}J.cleanProxy();O()}})});I.name="empty";G.push(I)},toggleView:function(G){if(G!==this.options.active_view){var H=this;this.loader.loadView(G,function(){H.options.views[H.options.active_view].unsetModel();H.options.active_view=G;H.options.model.applyActiveView(H.options.active_view);H.options.views[H.options.active_view].setModel(H.options.model);if(H.options.active_view==="graphview"){H.options.views.graphview.reframeOn()}H.dispatchEvent("onToggleView",H.options.active_view)})}},beginBlockingTransaction:function(G){F.mask(this.elements.container,G)},endBlockingTransaction:function(){F.unmask(this.elements.container)},onResize:function(){var H=this;this.options.model.invalidateViewPort();if(this.options.active_view==="graphview"){this.options.views.graphview.setSize()}var G=widget.getView().type;if(G==="minimized"){if(H._biFilter){H._biFilter.deactivate()}}else{if(H._biFilter){H._biFilter.activate()}}this.dispatchEvent("onParentResize")},getPADTreeDocument:function(){return this.options.model},getRoots:function(){return this.options.model.getRoots()},getPADTreeListView:function(){return this.options.views.treelistview},getSelectedNodes:function(){return this.options.model.getSelectedNodes()},getMainHTMLClass:function(){return".xnav_body"},applyFilter:function(M){this.enableUX();if(this._wait4Filter===true){delete this._wait4Filter}var N=l.clone(M,true);var I=this.options.model.getRoots();var H=[],G;if(M===null){M={};for(G=0;G<I.length;G++){H.push(I[G].getID())}}else{if(M.root_physicalid){H.push(M.root_physicalid)}}var J=false;var K=require("DS/PADUtils/PADSettingsMgt");if(M.filterRootIds!==undefined){var L=this;this.options.model.withTransactionUpdate(function(){for(G=0;G<M.filterRootIds.length;G++){var Q=L.options.model.searchRootById(M.filterRootIds[G]);if(Q){if(M.empty===true){delete Q.options.filtered;Q.options.CVQuery=null;Q.options.sequence_filter=null;Q.options.config_filter=null;Q.setBadges({bottomRight:""});Q.setState({state:"partiallyExpanded"});Q.options.padstate="partiallyExpanded";Q.childComputed=false;Q.processDescendants({processNode:function(T){if(this.options.children===null){this.options.children=[]}this.setState({state:"partiallyExpanded"});this.options.padstate="partiallyExpanded";this.childComputed=false}});if(Q.options.children===null){Q.options.children=[]}}else{J=true;Q.options.filtered=true;Q.options.CVQuery=M.CVQuery;if(M.CVQuery&&M.CVQuery.union&&M.CVQuery.union.expand){var S=true;for(var R=0;R<M.CVQuery.union.expand.length&&S;R++){var O=M.CVQuery.union.expand[R].root_path_physicalid;if(O.length===1&&O[0].indexOf(Q.getID())!==-1){Q.options.sequence_filter=M.CVQuery.union.expand[R].sequence_filter;Q.options.config_filter=M.CVQuery.union.expand[R].config_filter}}}else{Q.options.sequence_filter=null;Q.options.config_filter=null}Q.collapseAll();Q.removeChildren();Q.options.children=[];Q.setState({state:"collapsed"});Q.options.padstate="collapsed";Q.childComputed=false;var P={bottomRight:"filter"};Q.setBadges(P)}}}})}else{this.options.model.withTransactionUpdate(function(){for(G=0;G<I.length;G++){var P=I[G];if(H.indexOf(P.getID())!==-1){if(M.sequence_filter||M.config_filter){var Q=false;if(P.options.sequence_filter&&M.sequence_filter&&JSON.stringify(P.options.sequence_filter)===JSON.stringify(M.sequence_filter)){}else{Q=true}if(P.options.config_filter===M.config_filter){}else{Q=true}if(Q===true){J=true;P.options.filtered=true;P.collapseAll();P.removeChildren();P.options.children=[];P.setState({state:"collapsed"});P.options.padstate="collapsed";P.childComputed=false;P.options.sequence_filter=M.sequence_filter;P.options.config_filter=M.config_filter;var O={bottomRight:"filter"};if(K.getURLParameter("badgeV1")==="true"){O={bottomRight:j.getWebappsAssetUrl("PADUtils","icons/32/I_PADFilterBadge.png")}}P.setBadges(O)}}else{delete P.options.filtered;P.setBadges({bottomRight:""});P.options.filterId=null;P.options.filterName=null;P.options.sequence_filter=null;P.options.config_filter=null;P.setState({state:"partiallyExpanded"});P.options.padstate="partiallyExpanded";P.childComputed=false;P.processDescendants({processNode:function(R){if(this.options.children!==null){this.setState({state:"partiallyExpanded"});this.options.padstate="partiallyExpanded";this.childComputed=false}}})}}}})}if(J&&K.getSetting("expandAllwithApplyFilter")===true){if(K.getSetting("structureAppearCollapseAfterApplyFilter")===true){M.structCollapse=true}this.options.model.applyFilter(M)}if(M.doNotBroacast!==true){this._commandProxy.applyFilter(N)}},attachRoots:function(G){this.manageAttach(G)},detachRoots:function(G){this.manageDetach(G)},disableUX:function(){var G=this;G._disablingInProgress=true;require(["DS/UIKIT/Modal"],function(H){if(G._disablingInProgress===true){delete G._disablingInProgress;G.elements.container.blockUX=new H({className:"disableMainUX",closable:false,body:"",visible:true});G.elements.container.blockUX.inject(document.body)}})},enableUX:function(){if(this.elements.container.blockUX){this.elements.container.blockUX.destroy();delete this.elements.container.blockUX}if(this._disablingInProgress===true){delete this._disablingInProgress}},disableFilterWaiting:function(H){var G=H?H:{};if(this._wait4Filter===true){this.enableUX();delete this._wait4Filter}this._commandProxy.disableFilterWaiting(G)},togglePanel:function(H,J){var I=this;if(I.options.views.treelistview.padModalElement){I.options.views.treelistview.padModalElement.close()}var G=this.elements.padshell?this.elements.padshell:this.elements.padinfo;G.togglePanel(H,J)},destroy:function(){var G=require("DS/PADUtils/PADUtilsServices");this._commandProxy.padDestroy({widgetId:G.getWidgetId()});this._commandProxy.destroy();this.options.model._commandProxy.destroy()},_dispatchReady:function(G){if(this._dispatchReady_NotDone&&this.options.isReady.model===true&&this.options.isReady.actionbar===true&&this.options.isReady[this.options.active_view]===true){this.dispatchEvent.call(this,"onReady",{addInView:G});this._probes.probe_init.end();this._dispatchReady_NotDone=false}},displayNotification:function(G){require(["DS/PADUtils/views/PADAlerts"],function(H){H.displayNotification(G)})},_initialize_failure:function(H){var G=this;require(["DS/ENXNav/views/xNavInitError"],function(I){var J=n.initialization_error;G.elements.bigerror=new I({msg:J});G._just_error_content();G.displayNotification({msg:J,eventID:"error"});H()})},_just_error_content:function(){if(this.elements.bigerror){this.elements.container.setContent(this.elements.bigerror)}},updateCurrentView:function(){var G=this.options.views[this.options.active_view];G.updateView()},getPropertiesFacet:function(){var G=this.options.layout.propertiesFacet?this.options.layout.propertiesFacet:[];return G},isPartiallyExpanded:function(I,L){var H=false;var J=I.getState();if(J==="partiallyExpanded"){H=true}else{var G=I.getRoot();if(G.options._filterInfo&&G.options._filterInfo!=={}){H=true}else{if(G.options.sequence_filter!==undefined||G.options.config_filter!==undefined){H=true}else{if(G.options._childrenFilterInfo){var K=G.options._childrenFilterInfo.filteredOutChildren;if(K&&K.length>0){H=true}}}}}if(L){L(H)}},compactMode:function(G){this.getPADTreeListView().compactMode(G);this.dispatchEvent("onCompactMode",G)}});function D(L){var J=this;var G={};var H=d.getPromises();var K=H.slice();var I=new h(function(M){h.all(K).then(function(){require([J.options.amd_custo.TreeDocument],function(P){var Q=["doDnDDragStart","shouldAcceptDnDDrop","doDnDDrop"];G=g.call(J,Q);G.authorize_setStructure=J.options.authorize_setStructure;G.insert_replace=J.options.insert_replace;G.renderTo=J.options.renderTo;G.insert_replace=J.options.insert_replace;if(J.options.additionalColumnsModules){G.additionalColumnsModules=J.options.additionalColumnsModules;var O=require("DS/PADUtils/XNavSettings");for(var N=0;N<J.options.additionalColumnsModules.length;N++){O.addAsyncAttributes(J.options.additionalColumnsModules[N].getManagedColumnNames())}}J.options.model=new P(G);J.options.model.getModelEvents().subscribe({event:"titleRecalc"},function(U){var V=require("DS/PADUtils/PADUtilsServices"),T=V.getPlatformId(),X=V.getTenantsPreference();var S=J.getRoots();var W="";if(S.length===0){W=""}else{if(S.length===1){var R=S[0];W=R.getLabel();if(X.length>1){W+=" - "+T}}else{W=S.length+o.multi_root_tile;if(X.length>1){W+=" - "+T}}}J.options.widget.setTitle(W)});J.options.model.getModelEvents().subscribe({event:"onRemoveRoot"},function(S){J._commandProxy.remove({pids:[S.data.pid]});if(!S.data.remainingRoots){J.dropInvitContainer.show("drop")}J._onRemoveRoot({pids:[S.data.pid]});var R=J.options.model;if(R){if(R._pagerview){R._pagerview.hide();R._pagerview=null}}});J.options.model.getModelEvents().subscribe({event:"onCenterGraph"},function(R){J.options.views.treelistview.getManager().scrollToNode(R.data,undefined,false);if(J.options.views.graphview){J.options.views.graphview.reframeOn()}});J.options.model.getModelEvents().subscribe({event:"onRootAdded"},function(S){if(S.data.nb_root!==0){J.dropInvitContainer.hide()}else{J.dropInvitContainer.show("drop")}if(l.is(widget)&&J.getOption("layout").title_update===true){var T=require("DS/PADUtils/PADUtilsServices"),R=T.getPlatformId(),W=T.getTenantsPreference();if(S.data.nb_root===1&&l.is(S.data.added_node)&&l.is(S.data.added_node.getLabel(),"string")&&S.data.added_node.getLabel()!==""){if(W.length>1){J.options.widget.setTitle(S.data.added_node.getLabel()+"-"+R)}else{J.options.widget.setTitle(S.data.added_node.getLabel())}var V={TitleInfo:S.data.added_node.getLabel()};J._commandProxy.padRefresh(V)}else{if(S.data.nb_root===0){J.options.widget.setTitle("")}else{if(W.length>1){J.options.widget.setTitle(S.data.nb_root+o.multi_root_tile+R)}else{J.options.widget.setTitle(S.data.nb_root+o.multi_root_tile)}}}}J.manageRootList(S);if(J.getOption("layout").store_roots_in_pref){J.dispatchEvent("onSaveRoots")}if(S.data.added_node){var U=S.data.added_node.getID();J.dispatchEvent("onAddPaths",{addedPaths:[[U]]})}});J.options.model.addEventListener("beginBlockingTransaction",function(R){J.beginBlockingTransaction(R.data)});J.options.model.addEventListener("endBlockingTransaction",function(){J.endBlockingTransaction()});J.initializeBI();document.addEventListener("keyup",function(R){if(R.keyCode===27){if(!J.options.model.originalSelection){J.options.model.unselectAll();if(J.uncut){J.uncut.call(J)}}else{delete J.options.model.originalSelection}}});document.addEventListener("keypress",function(S){if(J.options.layout.keyboard_inputs===true){var R=J.options.model;require(["UWA/Event"],function(U){var T=U.whichKey(S);if(T==="ctrl+a"){R.withBroadcastSelect(function(){R.selectAll()})}})}});J.options.isReady.model=true;J._probes.probe_model.end();if(L){L()}M()})})});I.name="build";H.push(I)}function B(){var I=this;I.elements.container.innerHTML=E;var G=d.getPromises();var J=G.slice();var H=new h(function(L,K){h.all(J).then(function(S){var P=[];var N=[];var U=new h(function(X,W){if(I.options.action_bar_opts){var V=require("DS/PADUtils/PADProbes");I._probes.probe_actionbar=V.createProbe("init_xnav_actionbar");require(["DS/ENXNav/commands/_xNavActionBar"],function(Y){I.elements.actionbar=new Y({xnav_app:I,action_bar:I.options.action_bar_opts,renderTo:I.elements.container,callback:{onactionbarcb:function(Z){I.options.isReady.actionbar=true;if(I.options.isReady.actionbar===true&&I._probes.probe_actionbar){I._probes.probe_actionbar.end()}X()}}})})}else{I.options.isReady.actionbar=true;X()}});U.name="action bar";P.push(U);var M=I.elements.container.querySelector(".xnav_body");require(["DS/PADUtils/views/PADDnDInvite"],function(V){I.dropInvitContainer=new V({renderTo:I.elements.container,mode:I.options.layout.drop_invite,dropOnInvite:l.is(I.dropOnInvite,"function")?I.dropOnInvite.bind(I):undefined})});if(I.options.layout.statusInfo===true){var R=new h(function(V){require(["DS/PADUtils/views/PADStatusInfos"],function(W){I.elements.padstatus=new W({withProgress:true,events:{onShow:function(){var X=require("DS/PADUtils/PADUtilsServices");I.elements.padstatus.setStatus(W.buildStatus({Tenant:X.getPlatformId(),tree_content:{nbObjectsInTree:I.options.model.getAllDescendants().length,nbObjectsSelected:I.options.model.getSelectedNodes().length}}))}}});V()})});R.name="status Infos";P.push(R)}var T=new h(function(W,V){if(I.options.layout.padshell===true){require(["DS/ENOXTriptych/js/ENOXTriptych","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADModelEvents"],function(ac,Z,aa){var Y=l.createElement("div",{"class":"xnav_viewmain"});var ab=l.clone(I.options.layout.triptychOpts);ab.container=I.elements.container.querySelector(".xnav_body");var X=l.createElement("div",{"class":"xnav_viewright rightSidePanel"});I.elements.padshell=new ac();I.elements.padshell.init(ab,I.createRootListSlidder2(),Y,X);I.elements.padshell.togglePanel=function(ad){if(ad==="left"){I.elements.padshell._modelEvents.publish({event:"triptych-toggle-panel",data:"left"})}else{I.elements.padshell._modelEvents.publish({event:"triptych-toggle-panel",data:"right"});I.elements.padshell._modelEvents.subscribe({event:"triptych-clicked-overlay"},function(ae){if(ae&&ae==="right"){aa.publish({event:"onOverlayClick"})}})}};aa.publish({event:"on2DTriptychReady"});require(["DS/ApplicationFrame/CommandsManager"],function(ad){var ae=ad.getCommandCheckHeader("RootPanel");if(ae){ae.addCallback()}});a.call(I,{renderTo:Y},W)})}else{a.call(I,{renderTo:I.elements.container.querySelector(".xnav_body")},W)}});T.name="slidder";P.push(T);if(I.options.authorizeChangeControl===true){var O=new h(function(V,W){h.all(P).then(function(X){require(["require","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt"],function(aa,ab,Z,Y){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(ad){var ac;if(I.elements.padshell){ac=I.elements.padshell.getMainPanelContainer()}else{ac=I.elements.container.querySelector(".xnav_body")}var ae="hide";if(Y.getSetting("changeControlActivation")===true){ae="show"}ad.initialize2(ac,Z.appId(),ae,Y.getSetting("changeControlPosition"),function(af){I.dispatchEvent("onAuthoringCtxAvailable",af)});ab.authoringCtxAvailable();V()},function(ac){V()})})})});O.name="promiseAuthorizeChnage";P.push(O)}var Q=new h(function(V,W){h.all(P).then(function(X){if(I.options.isReady[I.options.active_view]===true){I._probes.probe_view.end()}if(I.elements.padstatus){if(I.options.layout.padshell===true){I.elements.padstatus.inject(I.elements.padshell.getMainPanelContainer())}else{I.elements.padstatus.inject(M)}}L();V()})});Q.name="promiseResolve";P.push(Q)})});H.name="buildSkeleton";G.push(H)}function a(I,H){var G=this;require(["DS/ENXNav/views/ViewLoader"],function(K){var J={component:G,x3dAppId:G.options.x3dAppId,renderTo:I.renderTo,amd:{treelistview:G.options.amd_custo.TreeListView,graphview:G.options.amd_custo.TreeGraph,tileview:G.options.amd_custo.TileGridView,thumbnailview:G.options.amd_custo.ThumbnailGridView}};G.loader=new K(J);G.loader.loadView(G.options.active_view,function(){H()})})}function g(H){var I=this;var G={};H.forEach(function(J){if(l.is(I.options.views_cb[J],"function")){G[J]=I.options.views_cb[J]}else{if(l.is(I[J],"function")){G[J]=I[J].bind(I)}}});return G}function b(M){var G={pids:[],is3DContent:M.initLoad!==undefined?M.initLoad:false};var O=(M.behavior?M.behavior:"WITH_CONTEXT");var L=(M.isDrop?M.isDrop:false);if(L){G.skipDrop=false}var J=[],K=[];for(var I=0;I<M.authorized_objects.length;I++){var N=M.authorized_objects[I];J.push(N.objectId);if(O==="WITH_CONTEXT"){if(!l.is(N.path,"array")){O="WITHOUT_CONTEXT"}}if(O==="WITH_CONTEXT"){K.push(N.path.map(function(P){return P.resourceid}))}}if(O==="WITH_CONTEXT"){G.paths=K;for(var H=0;H<G.paths.length;H++){G.pids.push(G.paths[H][0])}}else{G.pids=J}G.broadcast=l.is(M.broadcast,"boolean")?M.broadcast:true;return G}function u(J){var I={pids:[],paths:[],id_to_detach:J.id_to_detach,broadcast:J.broadcast};var K=J.structure;var G=[];var H=function(O,V){var U=Object.getOwnPropertyNames(O);var R,M=U.length;for(R=0;R<M;R++){var Q=Object.getOwnPropertyNames(O[U[R]]);var S,L=Q.length;if(L===0){var P;if(V===undefined){P=[]}else{P=V.slice()}P.push(U[R]);var N=P.join(",");if(G.indexOf(N)===-1){G.push(N);I.paths.push(P)}}else{for(S=0;S<L;S++){var T;if(V===undefined){T=[]}else{T=V.slice()}T.push(U[R]);H(O[U[R]],T)}}}};H(K);return I}return t});