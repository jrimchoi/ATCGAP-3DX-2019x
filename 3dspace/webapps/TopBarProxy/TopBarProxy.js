define("DS/TopBarProxy/Debuggable",["UWA/Core","UWA/Class/Debug"],function(c,a){var b;b=a.extend({log:function(d){return this._parent(String.prototype.format.apply("{0}: {1}".format(c.is(this.uwaClassName,"string")?this.uwaClassName:"[UNKNOWN]",d),[].slice.call(arguments,1)))}});return b});define("DS/TopBarProxy/MenuItem",["UWA/Core","UWA/Utils","UWA/Class/Model","DS/TopBarProxy/Debuggable","require"],function(f,c,e,d,b){var a;a=e.extend(d,{uwaClassName:"DS/TopBarProxy/MenuItem",debugMode:true,submenuType:"DS/TopBarProxy/Menu",defaults:{label:"",disabled:false,contextId:"",submenu:null,countBadge:0,countBadgeSum:0,selectable:false,selected:false,className:""},setup:function(h,g){var i;if(g){i=g.proxyId||(g.collection&&g.collection.proxyId);if(f.is(i,"string")&&i.length){this.set("proxyId",i,{silent:true})}}this.updateId();this.addEvents({"onChange:proxyId":this.updateId,"onChange:countBadge":this._dispatchCountBadgeSum,"onChange:submenu":this._listenToSubMenuCountBadgesEvents},this);this.debugMode&&this.addEvents({onBadgeSumChange:this._logUpdateCountBadgeSum,onValidationFailure:this._logInvalidBadgeCountSet},this);this._listenToSubMenuCountBadgesEvents(this,this.get("submenu"))},updateId:function(){if(!f.is(this.get("id"))&&f.is(this.get("proxyId"))){this.set("id","{0}/{1}".format(this.get("proxyId"),this.cid))}},setProxyId:function(g){this.set("proxyId",g,{silent:true});this.updateId()},onAdd:function(g,h){if(!f.is(this.get("proxyId"))){if(f.is(h.proxyId)){this.setProxyId(h.proxyId)}}},set:function(j,m,h){var i,l,g,k;if("proxyId"===j){if(f.is(l=this.get("submenu"))&&l.forEach){l.proxyId=m;l.forEach(function(n){n.setProxyId(m)})}}else{if("submenu"===j){l=m}else{if("object"===f.typeOf(j)){if(f.is(j.submenu)){l=j.submenu}}}if(f.is(l)){g=j.proxyId||(h?h.proxyId:undefined);k=g?{proxyId:g}:{};i=b(this.submenuType);if(this._attributes.submenu){this._attributes.submenu.set(l);l=this._attributes.submenu}else{if(!(l instanceof i)){l=c.splat(l);l=new i(l,k)}else{if(g){l.forEach(function(n){n.setProxyId(g)})}}l.addEvents({onExecute:this.execute,onSubMenuDisplayed:this.fireOnSubMenuDisplayed,onChange:function(n){if(!n.hasChanged("id")||!n._changing){this.dispatchEvent("onChange",[n])}},onAdd:function(){this.dispatchEvent("onChange",[this,"onAddSubMenuItem"])},onRemove:function(){this.dispatchEvent("onChange",[this,"onRemoveSubMenuItem"])}},this)}if("submenu"===j){m=l}else{j.submenu=l}}}this._parent(j,m,f.extend(f.clone(h||{},false),{validate:true}))},validate:function(g){var h=g.countBadge;if(undefined!==h&&null!==h&&(!f.is(h,"number")||0!==h%1||0>h)){return"Invalid badgeCount attribute "+h+' set on MenuItem {0} labeled "{1}"" : Must be a positive integer or zero!'}},_logInvalidBadgeCountSet:function(h,g){this.log(g,this.id||this.cid,this.get("label"))},toJSON:function(g){var h=this._parent(g);if(f.is(h.submenu)&&f.is(h.submenu.toJSON)){h.submenu=h.submenu.toJSON()}if(f.is(h.onExecute)){h.onExecute=true}if(f.is(h.onSubMenuDisplayed)){h.onSubMenuDisplayed=true}return h},dump:function(g){f.log(g+"MenuItem label:"+this.get("label")+" id: "+this.get("id")+" proxyId: "+this.get("proxyId"));if(f.is(this.get("submenu"))){f.log(g+" -> submenu:");this.get("submenu").dump(g+"   ")}},execute:function(g,h){g=g||this.get("proxyId");h=h||[];h.unshift(this.id);if(f.is(this.get("onExecute"),"function")){this.get("onExecute").call(this)}else{this.dispatchEvent("onExecute",[g,h])}},fireOnSubMenuDisplayed:function(g,h){h=h||[];h.unshift(this.id);this.dispatchEvent("onSubMenuDisplayed",[g,h])},fireOnSubMenuReady:function(g){g=g||[];g.unshift(this.id);this.dispatchEvent("onSubMenuReady",[g])},_getCountsSum:function(){var g=this.get("submenu");return(this.get("countBadge")||0)+(g?g._getCountsSum():0)},_listenToSubMenuCountBadgesEvents:function(h,i){var g=this.previous("submenu");if(g){g.removeEvent("onSumChange",this._dispatchCountBadgeSum,this)}if(i){i.addEvent("onSumChange",this._dispatchCountBadgeSum,this)}},_dispatchCountBadgeSum:function(g){if(g!==this){this.set("countBadgeSum",this._getCountsSum())}this.dispatchEvent("onBadgeSumChange")},_logUpdateCountBadgeSum:function(){this.log('Count Badge on MenuItem {0} labeled "{1}" has been updated to {2}.',this.id||this.cid,this.get("label"),this._getCountsSum())}});return a});define("TopBarProxy/MenuItem",["DS/TopBarProxy/MenuItem"],function(a){return a});define("DS/TopBarProxy/Menu",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/TopBarProxy/Debuggable","DS/TopBarProxy/MenuItem"],function(e,d,a,c,b){return a.extend(c,{uwaClassName:"DS/TopBarProxy/Menu",model:b,_prepareModel:function(h,f){var g;if((h instanceof b)&&f){g=f.proxyId;if(e.is(g,"string")&&g!==h.get("proxyId")){h.setProxyId(g)}}return this._parent.apply(this,arguments)},setup:function(g,f){if(f.proxyId){this.proxyId=f.proxyId}this.addEvents({onBadgeSumChange:this._dispatchCountBadgeSum,onAdd:this._dispatchCountBadgeSumIfNotNull,onRemove:this._dispatchCountBadgeSumIfNotNull},this)},setItems:function(i,g){var f,j,h;f=this.where({proxyId:i});j=new a(f.map(function(k){return{id:k.id}}));h=[];j.addEvent("onRemove",function(k){h.push(k)});j.set(g);this.remove(h);this.set(g,{proxyId:i,remove:false})},dump:function(f){this.log("{0}Menu containing {1} items, with proxyId {2}",f,this.length,this.proxyId);this.invoke("dump",f)},getActiveProxyIds:function(){return this.activeProxyIds},setActiveProxyIds:function(f){this.activeProxyIds=f;this.dispatchEvent("onChangeActivatedProxyIds",[this,this.activeProxyIds])},_dispatchCountBadgeSum:function(){this.dispatchEvent("onSumChange")},_dispatchCountBadgeSumIfNotNull:function(f){if(f._getCountsSum()){this._dispatchCountBadgeSum()}},_getCountsSum:function(){var f=0;this.getActiveItems().forEach(function(g){f+=g._getCountsSum()});return f},getActiveItems:function(){var g=this,f;if(this.activeProxyIds){g=[];for(f=0;f<this.activeProxyIds.length;f++){g=g.concat(this.where({proxyId:this.activeProxyIds[f]}))}}return g},get:function(g){var f,h;if(e.is(g,"array")){h=this;if(false===g.some(function(i){f=h&&h.get(i);h=f.get("submenu");return !f})){return f}}else{return this._parent(g)}}})});define("TopBarProxy/Menu",["DS/TopBarProxy/Menu"],function(a){return a});
/*!
  Script: MenuBarItem.js
*/
define("DS/TopBarProxy/MenuBarItem",["UWA/Core","DS/TopBarProxy/MenuItem"],function(c,b){function a(e){var d;switch(e){case"profile":case"me":d="user-alt";break;case"add":d="plus";break;case"share":d="mail-forward-alt";break;case"home":d="home-alt";break;case"help":d="question-circle";break;case"content":d="component";break;case"social":d="users-alt";break;case"notification":d="bell-alt";break;default:d=""}return d}return b.extend({setup:function(e,d){var f=this;f._parent.apply(f,arguments);f.set("fonticon",a(f.id))},getActiveProxyIds:function(){return this.activeProxyIds},setActiveProxyIds:function(d){var e=this.get("submenu");this.activeProxyIds=d;e.setActiveProxyIds(d);this.set("disabled",e.length>0&&e.getActiveItems().length===0);this.dispatchEvent("onChange:activatedProxyIds",[this,d])},toJSON:function(){var d=this.get("submenu");if(c.is(d)){return d.toJSON()}return null}})});define("DS/TopBarProxy/TopBarProxy",["UWA/Core","UWA/Utils","UWA/Utils/InterCom","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuBarItem"],function(g,e,c,d,f){var a;function b(i,h){var j="Cannot call method {0} on zombie {1} #{2} (channel:{3})".format(h,i.uwaClassName,i._socketId,i._channelId);return function(){throw new Error(j)}}a=d.extend({model:f,uwaClassName:"DS/TopBarProxy/TopBarProxy",init:function(l){var k=this,i=e.getUUID(),j=l.content,h=l.options||{};this._socketId=i;this._channelId=l.id;this._parent(undefined,{});this._socket=new c.Socket(i);this._socket.subscribeServer("MainMenuBar",h.rightParentWindow||window.parent,"*");this._socket.dispatchEvent("subscribeToChannel",this._channelId);this._socket.addListener("onExecute",function(m){k.execute(m)});this._socket.addListener("onSubMenuDisplayed",function(m){k.onSubMenuDisplayed(m)});this.addEvent("onChange",this._dispatchContentEvent,this);this.addEvent("onSubMenuReady",function(m){this.log("Proxy #{0} is sending a Sub Menu Ready notif through InterCom...",i);this._socket.dispatchEvent("onSubMenuReady",m)},this);j&&this.setContent(j)},setup:function(){var h;h=this._socketId;this.add(["profile","add","share","home","help","search","content","social","notification"].map(function(i){return{id:i,proxyId:h,submenu:[]}},this),{silent:true})},_dispatchContentEvent:function(){this.log("Proxy #{0} is sending a change of content through InterCom...",this._socketId);this._socket.dispatchEvent("setContent",this.toJSON());return this},addOnSubMenuDisplayedEvent:function(h){Object.keys(h).forEach(function(i){this.get(i).set("onSubMenuDisplayed",h[i])},this);return this},setContent:function(h){return this._setContent(h)},_setContent:function(j,h){var i;i=this._socketId;Object.keys(j).forEach(function(k){this.get(k).get("submenu")[h||"set"](j[k],{proxyId:i,silent:true})},this);return this._dispatchContentEvent()},addContent:function(h){return this._setContent(h,"add")},empty:function(){return this.setContent({profile:[],add:[],share:[],home:[],help:[]})},die:function(){["addContent","setContent","addOnSubMenuDisplayedEvent","die","activate","deactivate","empty","setSearchOptionValues"].forEach(function(h){this[h]=b(this,h)},this);this._socket.dispatchEvent("die",this._channelId)},activate:function(){this._socket.dispatchEvent("activate",this._channelId);return this},deactivate:function(){this._socket.dispatchEvent("deactivate",this._channelId);return this},setSearchOptionValues:function(h,i){this._socket.dispatchEvent("onSearchOptionChange",{searchOptionBox:h,searchPlaceHolder:i})},toJSON:function(h){var j,i={onSubMenuDisplayed:{}};this.forEach(function(k){j=k.id;i[j]=k.toJSON(h);i.onSubMenuDisplayed[j]=!!k.get("onSubMenuDisplayed")},this);return i},execute:function(h){return this._callMenuItemCb(h,"onExecute")},onSubMenuDisplayed:function(h){return this._callMenuItemCb(h,"onSubMenuDisplayed")},_callMenuItemCb:function(j,h){var i=this.get(j);i&&i.get(h)&&i.get(h).call(i,i)},dump:function(h){h||(h=" ");g.log("Dumping TopBarProxy: ");this.invoke("dump",h);g.log("JSON value: ");g.log(this.toJSON())}});return a});define("TopBarProxy",["TopBarProxy/TopBarProxy"],function(a){return a});define("TopBarProxy/TopBarProxy",["DS/TopBarProxy/TopBarProxy"],function(a){return a});