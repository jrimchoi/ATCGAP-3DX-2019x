define("DS/CfgAuthoringContextUX/scripts/CfgCACustomTileView",["DS/W3DXComponents/Views/Item/TileView","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX"],function(b,c){var a=b.extend({name:"CACustomAuthListTile",template:function(){return'                            <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}"></div>                              <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                  <div class="'+this.getClassNames("-header")+'">                                      <div>{{#if image}}<img  src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}</div>									                    {{#if holdStatus}}<div class="state" title="{{{holdValue}}}[{{{currentDisplay}}}]">{{{holdValue}}}</div>{{/if}}														{{#unless holdStatus}}<div class="state" title="{{{currentDisplay}}}">{{{currentDisplay}}}</div>{{/unless}}								              </div>                                <div class="'+this.getClassNames("-body")+'">                                    {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}	                                <div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>	                                <div class="'+this.getClassNames("-subtitle")+'" title="{{{subtitle}}}">{{{subtitle}}}</div>									<div class="'+this.getClassNames("-content")+'">										<div class="'+this.getClassNames("-CAowner")+'" title="{{{ownerDisplayName}}}">{{{ownerField}}}&nbsp;{{{ownerDisplayName}}}</div>										<div class="'+this.getClassNames("-Role")+'" title="{{{contextUserRole}}}">{{{roleField}}}&nbsp;{{{contextUserRole}}}</div>										<div class="'+this.getClassNames("-DueDate")+'">{{{dueDateField}}}&nbsp;{{{due}}}</div>									</div>                                    <ps-progress  class="'+this.getClassNames("-progress")+'"></ps-progress>                                </div>                            </div>                                    '}});return a});define("DS/CfgAuthoringContextUX/scripts/CfgCAAuthCtxTileView",["DS/W3DXComponents/Views/Item/TileView","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX"],function(b,c){var a=b.extend({name:"CACustomAuthCtxTile",template:function(){return'                           <div class="'+this.getClassNames("-check")+' {{#unless withMultisel}}hidden{{/unless}}">                                            <div class="toggle toggle-primary">                                                <input type="checkbox" name="radios" value="" id="checkbox-{{cid}}">                                                <label class="control-label" for="checkbox-{{cid}}"></label>                                            </div>                                        </div>                                        <div class="'+this.getClassNames("-sub-container")+'" draggable="true">                                            <div class="'+this.getClassNames("-header")+'">                                                {{#if image}}<img src="{{#unless lazyLoading}}{{image}}{{/unless}}" {{getImgAttrs imgAttrs}} class="'+this.getClassNames("-image")+'" draggable="false"/>{{/if}}                                            </div>                                            <div class="'+this.getClassNames("-body")+'">                                                {{#if icon}}<img src="{{icon}}" class="'+this.getClassNames("-icon")+'" draggable="false"/>{{/if}}	                                                <div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>                                                <div class="'+this.getClassNames("-subtitle")+'" title="{{{subtitle}}}">{{{subtitle}}}</div>                                                <div class="'+this.getClassNames("-content")+'"title="{{{content}}}">{{{content}}}</div>                                            <progress max="100" value="10" class="'+this.getClassNames("-progress")+'"></progress>                                            </div>                                            <div class="'+this.getClassNames("-actions")+'">                                                <div class="actions-inline-container">                                                    <div class="action-container single-action hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                                    </div>                                                    <div class="action-container actions-inline-dotted hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        </div>                                    '},domEvents:function(){return{"click .tile-title":function(){this.dispatchEvent("onClickTitle")}}}});return a});define("DS/CfgAuthoringContextUX/scripts/CfgSessionDialog",["i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS","DS/PlatformAPI/PlatformAPI","DS/CfgBaseUX/scripts/CfgController"],function(a,c,b){var d={collectionNew:null,CfgDialogIns:null,create:function(e){var f=this;b.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}require(["DS/CfgBaseUX/scripts/CfgDialog","DS/CfgEvolutionUX/CfgEvolutionLayoutFactory","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","DS/CfgBaseUX/scripts/CfgUtility","DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgController"],function(h,r,m,k,n,i,j){var p=function(){var s=r.getGlobalSessiondata();if(window.__karma__!==undefined){if(enoviaServerAuthoringWidget.odtEditMode){s={"Evolution Expression":'<CfgEffectivityExpression xmlns="urn:com:dassault_systemes:config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:com:dassault_systemes:config CfgEffectivityExpression.xsd"><Expression><Context HolderType="Model" HolderName="SONY"><Date><Interval><From Value = "2018-04-13"/></Interval></Date></Context></Expression></CfgEffectivityExpression>',"Dictionary Contexts":"[EA33B156971D0000420BD75AEF620400]",ACId:"EA33B156CB2A00008921D75AC3D50800"}}else{s={"Evolution Expression":"","Dictionary Contexts":"[]",}}}if(s["Evolution Expression"]!=""){n.populate3DSpaceURL().then(function(t){n.populateSecurityContext().then(function(u){k.getAuthoringIDforEvolution(s).then(function(x){var w=x.ACId;var y=x.XSLTExpr;var v=m.get();v.evolution.id=w;v.evolution.displayExpression=y;m.updateSessionEff(v);c.publish("sessionEff",v);c.publish("toggleActiveSE");d.CfgDialogIns.closeDialog()},function(v){console.log("Create fail");return Promise.reject(v)})},function(u){console.log("populateSecurityContext Failed");return Promise.reject(u)})},function(t){console.log("populate3DSpaceURL Failed");return Promise.reject(t)})}else{j.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}n.populate3DSpaceURL().then(function(t){n.populateSecurityContext().then(function(u){k.deleteAuthroingContext().then(function(){var v=m.get();v.evolution.id="";v.evolution.displayExpression="";m.updateSessionEff(v);d.CfgDialogIns.closeDialog()},function(v){console.log("delete fail");return Promise.reject(v)})},function(u){console.log("populateSecurityContext Failed");return Promise.reject(u)})},function(t){console.log("populate3DSpaceURL Failed");return Promise.reject(t)})}};var o=function(){d.CfgDialogIns.closeDialog();e.style.pointerEvents="auto"};var l=function(){e.style.pointerEvents="auto"};var g=[{label:a.CFG_SE_ACTION_OK,handler:p,className:"primary"},{label:a.CFG_SE_ACTION_Cancel,handler:o,className:"default"}];var q={tenant:enoviaServerFilterWidget.tenant,environment:"Dashboard",parent:null,parentElement:null,objectid:null,mode:"SessionEffectivity",iXml:"",modelList:null,Access:{SetSessionEffectvity:"true"},dialogue:{header:a.CFG_Edit_Session_Header,buttonArray:g,target:widget.body,object:null,postCloseHandler:l}};d.CfgDialogIns=new h(q);q.parent=d.CfgDialogIns.container;q.parentElement=d.CfgDialogIns.container;q.dialogue.object=d.CfgDialogIns;d.CfgDialogIns.render();r.create(q);if(document.getElementsByClassName("CfgSessionEffectivityDialog")[0]!=undefined){e.style.pointerEvents="none"}document.getElementsByClassName("CfgSessionEffectivityDialog")[0].setAttribute("style",document.getElementsByClassName("CfgSessionEffectivityDialog")[0].getAttribute("style")+"min-height:310px !important;min-width:310px !important;")})}};return d});define("DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility",["DS/WAFData/WAFData","DS/i3DXCompassServices/i3DXCompassServices","DS/CfgBaseUX/scripts/CfgUtility"],function(a,d,c){var b={getCAdetails:function(f){var e=new Promise(function(k,j){var h="/resources/modeler/change/changeaction/pid:"+f+"?attributes=1&context=1&people=1&applicability=1";var i="";var g=function(l){k(l)};c.makeWSCall(h,"GET","enovia","application/json",i,g,j,true)});return e},getCAdetailsForAuthoring:function(f){var e=new Promise(function(k,j){var h="/resources/modeler/change/changeaction/pid:"+f+"?attributes=1&editability=1";var i="";var g=function(l){k(l)};c.makeWSCall(h,"GET","enovia","application/json",i,g,j,true)});return e},getCAWorkUnderList:function(){var e=new Promise(function(j,i){var g="/resources/modeler/change/changeactions?workunder=1";var h="";var f=function(k){j(k)};c.makeWSCall(g,"GET","enovia","application/json",h,f,i,true)});return e},getAuthoringIDforEvolution:function(e){var f=new Promise(function(k,j){var h="/resources/authoringcontext/service";var i=JSON.stringify(e);var g=function(l){k(l)};c.makeWSCall(h,"POST","enovia","application/json",i,g,j,true)});return f},readAuthroingContext:function(){var e=new Promise(function(j,i){var g="/resources/authoringcontext/service/pid:dummyid";var h="";var f=function(k){j(k)};c.makeWSCall(g,"GET","enovia","application/json",h,f,i,true)});return e},deleteAuthroingContext:function(){var e=new Promise(function(j,i){var g="/resources/authoringcontext/service/pid:dummyid";var h="";var f=function(k){j(k)};c.makeWSCall(g,"DELETE","enovia","application/json",h,f,i,true)});return e},removeClassFromDom:function(g){var f=document.querySelectorAll("."+g);for(var e=0;e<f.length;e++){f[e].remove()}},};return b});define("DS/CfgAuthoringContextUX/scripts/CfgSessionAuthTileView",["DS/W3DXComponents/Views/Item/TileView","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX"],function(b,c){var a=b.extend({name:"CASessionAuthCtxTile",template:function(){return'</div>				 <div class="'+this.getClassNames("-sub-container")+'" draggable="true"><div class="'+this.getClassNames("-body")+'"><div class="'+this.getClassNames("-title")+'" title="{{{title}}}">{{{title}}}</div>                                                <div class="'+this.getClassNames("-subtitle")+'" title="{{{subtitle}}}">{{{subtitle}}}</div>                                                <div class="'+this.getClassNames("-content")+'"title="{{{content}}}">{{{content}}}</div></div>                                            <div class="'+this.getClassNames("-actions")+'">                                                <div class="actions-inline-container">                                                    <div class="action-container single-action hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x"></span></div>                                                    </div>                                                    <div class="action-container actions-inline-dotted hidden">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        </div>                                    '}});return a});define("DS/CfgAuthoringContextUX/scripts/CfgCAListDialog",["UWA/Drivers/Alone","DS/UIKIT/Modal","DS/UIKIT/Input","DS/UIKIT/Input/Button","UWA/Class/View","DS/W3DXComponents/Views/Layout/GridScrollView","DS/CfgAuthoringContextUX/scripts/CfgCACustomTileView","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS","DS/UIKIT/Alert","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/UIKIT/Input/Text","DS/UIKIT/Iconbar","DS/UIKIT/Mask","DS/WebappsUtils/WebappsUtils","DS/PlatformAPI/PlatformAPI","DS/ENOFloatingPanel/ENOFloatingPanel","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgController"],function(a,c,p,k,q,e,t,s,h,i,f,u,j,r,b,v,g,d,m,l,o){var n={collectionNew:null,create:function(x,z){var y=this;this.MainContainer=new UWA.Element("div",{id:"caListDiv",styles:{width:"100%",height:"100%",display:"table"}});this.headerwrapperDiv=new UWA.Element("div",{id:"headerwrapperDiv",styles:{display:"table-row"}});this.CAHeader=new UWA.Element("div",{id:"CAHeaderDiv",styles:{width:"100%",display:"inline-flex",flexDirection:"row-reverse",}});this.inlineActionDiv=new UWA.Element("div",{id:"inlineActionDiv",styles:{}});this.CAListBodyDiv=new UWA.Element("div",{id:"CAListBodyDiv",styles:{width:"100%",height:"100%",display:"table-row"}});this.CASubActiondivText=new UWA.Element("div",{id:"CASubActiondiv",html:h.CFG_Heading_SortBY+':<font color="#78befa">'+h.CFG_Heading_Date+"</font>",styles:{fontSize:"1.3em"}});this.CASearchDiv=new UWA.Element("div",{id:"CASearchDiv",styles:{width:"50%",height:"10%",display:"none"}});var w=new b({renderTo:this.CAHeader,items:[{fonticon:"down-bold",text:h.CFG_ToolTip_Ascending_Descending,handler:function(A){n.sortCAListByDate()}},{className:"divider"},{fonticon:"search",text:h.CFG_tooltip_Search,handler:function(A){n.searchCA()}}]});this.CAHeader.appendChild(this.CASubActiondivText);this.headerwrapperDiv.appendChild(this.CAHeader);this.MainContainer.appendChild(this.headerwrapperDiv);this.CAsearchBX1=new r({id:"CAsearchBX1",attributes:{placeholder:h.CFG_CA_Searchby_NameTitle,events:{keyup:function(A){var C=A.target.value;var B=n.isForbiddenChar(C);if(B===true){return}n.enteredText=C;n.filterSearch()}}}}).inject(this.CASearchDiv);this.CAsearchBX1.elements.input.setStyles({width:"55%",padding:"6px",margin:"0px"});this.MainContainer.appendChild(this.CASearchDiv);this.MainContainer.appendChild(this.CAListBodyDiv);this.getModel(x);v.mask(this.MainContainer);o.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}l.populate3DSpaceURL().then(function(A){l.populateSecurityContext().then(function(B){s.getCAWorkUnderList().then(function(Q){var C=[];var D=0;for(D=0;D<Q.details.owner.length;D++){var M=Q.details.owner[D];var O=M.id;O=O.split("pid:");O=O[1];var G=M.name;var F=M.owner;var S=M.attributes.Severity;var E=M.attributes.Synopsis;var P=M.attributes.EstimatedCompletionDate;var L=h.CFG_CA_Role_Owner;if(Q.details.contributor.length>0){var K=0;for(K=0;K<Q.details.contributor.length;K++){var H=Q.details.contributor[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Contributor}break}}if(Q.details.reviewer.length>0){var K=0;for(K=0;K<Q.details.reviewer.length;K++){var H=Q.details.reviewer[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Reviewer}break}}if(Q.details.follower.length>0){var K=0;for(K=0;K<Q.details.follower.length;K++){var H=Q.details.follower[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Follower}break}}var N="%Y-%m-%d";if(P){P=new UWA.Date(P).strftime(N)}else{P=""}var J={title:E,id:O,subtitle:G,ownerField:h.CFG_Heading_Owner+":",ownerDisplayName:F,roleField:h.CFG_Heading_Role+":",contextUserRole:L,dueDateField:h.CFG_Heading_DueDate+":",due:P,image:g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+S+".png"),currentDisplay:h.CFG_CA_State_InWork};C.push(J)}for(D=0;D<Q.details.contributor.length;D++){var M=Q.details.contributor[D];var O=M.id;O=O.split("pid:");O=O[1];var G=M.name;var F=M.owner;var S=M.attributes.Severity;var E=M.attributes.Synopsis;var P=M.attributes.EstimatedCompletionDate;var L=h.CFG_CA_Role_Contributor;if(Q.details.reviewer.length>0){var K=0;for(K=0;K<Q.details.reviewer.length;K++){var H=Q.details.reviewer[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Reviewer}break}}if(Q.details.follower.length>0){var K=0;for(K=0;K<Q.details.follower.length;K++){var H=Q.details.follower[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Follower}break}}var N="%Y-%m-%d";if(P){P=new UWA.Date(P).strftime(N)}else{P=""}var J={title:E,id:O,subtitle:G,ownerField:h.CFG_Heading_Owner+":",ownerDisplayName:F,roleField:h.CFG_Heading_Role+":",contextUserRole:L,dueDateField:h.CFG_Heading_DueDate+":",due:P,image:g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+S+".png"),currentDisplay:h.CFG_CA_State_InWork};C.push(J)}for(D=0;D<Q.details.reviewer.length;D++){var M=Q.details.reviewer[D];var O=M.id;O=O.split("pid:");O=O[1];var G=M.name;var F=M.owner;var S=M.attributes.Severity;var E=M.attributes.Synopsis;var P=M.attributes.EstimatedCompletionDate;var L=h.CFG_CA_Role_reviewer;if(Q.details.follower.length>0){var K=0;for(K=0;K<Q.details.follower.length;K++){var H=Q.details.follower[K];var R=H.id;R=R.split("pid:");R=R[1];if(R==O){L=L+","+h.CFG_CA_Role_Follower}break}}var N="%Y-%m-%d";if(P){P=new UWA.Date(P).strftime(N)}else{P=""}var J={title:E,id:O,subtitle:G,ownerField:h.CFG_Heading_Owner+":",ownerDisplayName:F,roleField:h.CFG_Heading_Role+":",contextUserRole:L,dueDateField:h.CFG_Heading_DueDate+":",due:P,image:g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+S+".png"),currentDisplay:h.CFG_CA_State_InWork};C.push(J)}for(D=0;D<Q.details.follower.length;D++){var M=Q.details.follower[D];var O=M.id;O=O.split("pid:");O=O[1];var G=M.name;var F=M.owner;var S=M.attributes.Severity;var E=M.attributes.Synopsis;var P=M.attributes.EstimatedCompletionDate;var L=h.CFG_CA_Role_follower;var N="%Y-%m-%d";if(P){P=new UWA.Date(P).strftime(N)}else{P=""}var J={title:E,id:O,subtitle:G,ownerField:h.CFG_Heading_Owner+":",ownerDisplayName:F,roleField:h.CFG_Heading_Role+":",contextUserRole:L,dueDateField:h.CFG_Heading_DueDate+":",due:P,image:g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+S+".png"),currentDisplay:h.CFG_CA_State_InWork};C.push(J)}var I=new UWA.Class.Collection(C);y.collectionNew=I;n.createView(I);v.unmask(n.MainContainer)},function(C){console.log("Get CA WorkUnderList Failed");return Promise.reject(C)})},function(B){return Promise.reject(B)})},function(A){return Promise.reject(A)})},createView:function(x){var w=this;this.caListView=new e({collection:x,useInfiniteScroll:false,scrollDuration:1,itemView:t,withMultisel:false,events:{onItemViewClick:function(y){},onItemViewCheck:function(z,y){}}});this.caListView.render().inject(this.CAListBodyDiv);w.caListView=this.caListView},getModel:function(w){var x=this;x.dialog=new m({className:"cfgAuthENOFloatingPanelComponent",title:h.CFG_Select_CA_Header,body:this.MainContainer,overlay:true,closable:true,resizable:true,footer:this.createActionsPresenter(),events:{onHide:function(){x.dialog.destroy();w.style.pointerEvents="auto"},},styles:{position:"fixed"}}).inject(widget.body);x.dialog.show();if(document.getElementsByClassName("cfgAuthENOFloatingPanelComponent")[0]!=undefined){w.style.pointerEvents="none"}x.dialog.getContent().getElements(".btn-primary").forEach(function(y){y.addEvent("click",function(){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(C){if(x.caListView.options.view.currentItemView!=undefined){var z=x.caListView.options.view.currentItemView.model._attributes.id;var B=x.caListView.options.view.currentItemView.model._attributes.title;var A=C.get();A.change.id=z;A.change.name=B;C.update(A);C.publish(C.myAuthkey,A);x.dialog.destroy();w.style.pointerEvents="auto"}else{if(x.caListView.options.view.collection.length>0){var E=C.renderDiv;s.removeClassFromDom("wp-authAlert");var D=new i({className:"wp-authAlert",visible:true,autoHide:true,hideDelay:2000}).inject(E,"top");D.add({className:"error",message:h.CFG_NO_SELECTION})}else{x.dialog.destroy();w.style.pointerEvents="auto"}}})})});x.dialog.getContent().getElements(".btn-default").forEach(function(y){y.addEvent("click",function(){x.dialog.destroy();w.style.pointerEvents="auto"})})},createActionsPresenter:function(){var w=UWA.createElement("div",{"class":"actionsContainer"});var y=new k({value:h.CFG_Button_OK,className:"primary btn btn-primary okBtn"}).inject(w);var x=new k({value:h.CFG_Button_CANCEL}).inject(w);return w},sortCAListByDate:function(){var w=document.getElementsByClassName("fonticon fonticon-down-bold");var x=true;if(w.length==0){var x=false;w=document.getElementsByClassName("fonticon fonticon-up-bold")}if(this.caListView.collection.length>0){var y=[];y=this.caListView.collection.sortBy("due");if(!x){y.reverse()}this.caListView.collection.reset(y);this.changeSortIcon(w,x)}},changeSortIcon:function(w,x){if(w.length>0){if(x){w[0].className="fonticon fonticon-up-bold"}else{w[0].className="fonticon fonticon-down-bold"}}},isForbiddenChar:function(x){var A=false;var z='"#$@%*,?\\<>[]|:/';for(var w=0;w<z.length;w++){var y=z[w];if(x.indexOf(y)!=-1){A=true;break}}if(true===A){z=z.split("").join(" ")}return A},searchCA:function(){var w=document.querySelector("#CASearchDiv");var x=w.getStyle("display");if(x=="table-row"){w.setStyle("display","none")}else{w.setStyle("display","table-row")}},filterSearch:function(){var w=[];this.caListView.destroy();w=this.collectionNew.filter(this.filterNameBased);var x=new UWA.Class.Collection(w);this.createView(x)},filterNameBased:function(w){var z=false;var B=w._attributes.subtitle;var y=w._attributes.title;var A=n.enteredText;if(A&&A.length){if(B){B=B.toLowerCase()}if(y){y=y.toLowerCase()}A=A.toLowerCase();var x=B.indexOf(A);if(x<0){x=y.indexOf(A)}z=(x>=0)?true:false}if((A===undefined)||(A.length===0)){z=true}if(z==true){return w}}};return n});define("DS/CfgAuthoringContextUX/scripts/CfgAuthContextChangeTileView",["UWA/Class/Model","UWA/Class/View","DS/UIKIT/Input/Toggle","DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS","DS/CfgAuthoringContextUX/scripts/CfgCAAuthCtxTileView",],function(f,e,g,c,a,d){var b=e.extend({idAttribute:"id",appDiv:null,editAllowed:null,authViewMode:null,setup:function(h){this.listenTo(this.model,"onChange",this.render);this.appDiv=h.appDiv;this.editAllowed=h.editAllowed;this.authViewMode=h.authViewMode},render:function(){var k=this;var j=a.CFG_CA_HEADER;var h=false;if(k.authViewMode=="change"){h=true}if(this.container){this.container.setContent("")}if(UWA.is(this.model.id)){if(this.container){this.container.appendChild(UWA.createElement("div",{"class":"caHeader",id:"caHeaderDiv1",html:j}));var i=new d({model:k.model,contextualActions:k.contextMenuAuth(),events:{onClickTitle:function(l){var m={eventName:"cfgAuthoringContext",operation:"openCA",operationVersion:"1.0",content:{id:this.model.id}};c.sendNotificationWebInWin(m)}}});i.container.setStyles({width:"255px",minWidth:"255px",right:"5px",overflow:"hidden",whiteSpace:"nowrap"});i.render().inject(this.container);if(this.editAllowed==true||this.editAllowed=="undefined"||this.editAllowed==undefined){this.container.appendChild(UWA.createElement("div",{id:"AuthCAtoggle","class":"caAuthDiv1",styles:{display:"flex","float":"right"},html:new g({type:"switch",id:"autoggle",checked:h,label:"",events:{onClick:function(){var l="";var m={eventName:"cfgAuthoringContext",operation:this.isChecked()?"activate_Authoring":"deActivate_Authoring",operationVersion:"1.0",content:{id:k.model.id}};c.sendNotificationWebInWin(m)}}})}))}}}return this.container},contextMenuAuth:function(){var h=this;var i=[];if(this.editAllowed==true||this.editAllowed=="undefined"||this.editAllowed==undefined){i.push({id:"delete",text:a.CFG_ToolTip_Remove,fonticon:"trash",handler:function(j){var k={eventName:"cfgAuthoringContext",operation:"removeCA",operationVersion:"1.0",content:{id:j.model.id}};c.sendNotificationWebInWin(k)}})}return i}});return b});define("DS/CfgAuthoringContextUX/scripts/CfgAuthContextChangeView",["UWA/Class/View","css!DS/UIKIT/UIKIT.css","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","DS/WebappsUtils/WebappsUtils","DS/W3DXComponents/Views/Item/TileView","UWA/Class/Model","DS/CfgAuthoringContextUX/scripts/CfgAuthContextChangeTileView","DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS"],function(b,k,i,g,d,f,c,h,j,e){var a=b.extend({renderDiv:null,model:null,isLicenseValid:undefined,isLicenseCFGValid:undefined,isLicenseCHGValid:undefined,isLicenseIDSValid:undefined,init:function(l){this.options=l;var n=this;var m=function(o){n.isLicenseCFGValid=o.isCFGRoleAvail;n.isLicenseCHGValid=o.isCHGRoleAvail;if((n.isLicenseCFGValid==true)||(n.isLicenseCHGValid==true)){n.isLicenseValid=true}else{n.isLicenseValid=false}};j.rolesAvailable(m);this.work_under={CA_Auth_Name:"",Auth_Details:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},},Message_WARN:{isLicenseValid:false,Message:"Work Under is disabled, as the user does not have either Change or Configuration license"},Message_SUCCESS:{validKey:"",isLicenseValid:true}},this.model=new c()},setContext:function(n,l){var o=n.ChangeAction.id;var m=this;m.caOptions=n;m.renderDiv=m.options.parent;g.getCAdetailsForAuthoring(o).then(function(w){var r="";var B="";var s="";var q="";var z="";var v=w.changeaction.attributes;for(var u=0;u<v.length;u++){if(v[u]["name"]=="current"){r=v[u].value}else{if(v[u]["name"]=="attribute_Severity"){B=v[u].value}else{if(v[u]["name"]=="attribute_Synopsis"){s=v[u].value}else{if(v[u]["name"]=="interface[Change On Hold]"){q=v[u].value}}}}}if(w.changeaction.editability.work_under=="allowed"){var y=s;var A=w.changeaction.description;var p=w.changeaction.name;var x=w.changeaction.context;var t=m.caOptions.authoringMode;var B=B;m.model.set("id",o);m.model.set("image",d.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+B+".png"));m.model.set("context",x);m.model.set("title",y);m.model.set("content",A);m.model.set("synopsis",p);m.model.set("severity",B);m.model.set("subtitle",p);m.work_under.CA_Auth_Name=m.model.get("title");m.model.set("status",t);m.showCATileView()}else{j.showwarning(e.CFG_DROP_CA_ACTION_STATE_CHECK,"error")}},function(p){j.showwarning(e.getCAFailed,"error");console.log("Get CA Deatils Failed");return Promise.reject(p)})},showCATileView:function(){var l=this;new h({model:l.model,appDiv:l.renderDiv,editAllowed:l.editAllowed,authViewMode:l.caOptions.authoringMode}).render().inject(l.options.parent)},});return a});define("DS/CfgAuthoringContextUX/scripts/CfgWorkUnderView",["UWA/Class/Model","UWA/Class/View","DS/W3DXComponents/Views/Item/TileView","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/WebappsUtils/WebappsUtils","i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS","DS/UIKIT/Modal","DS/CfgAuthoringContextUX/scripts/CfgCAListDialog","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","DS/UIKIT/Alert","DS/CfgAuthoringContextUX/scripts/CfgCAAuthCtxTileView","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgSessionDialog","DS/CfgAuthoringContextUX/scripts/CfgSessionAuthTileView","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgEvolutionUX/CfgEvolutionLayoutFactory","DS/UIKIT/Mask"],function(k,p,j,l,n,d,g,e,o,r,i,m,b,c,a,q,f,s){var h=p.extend({idAttribute:"id",appDiv:null,access:null,accessCFG:null,accessCHG:null,accessIDS:null,editAllowed:null,showEvolution:null,showChange:null,allowChangeConfguired:null,myAuthKey:null,cfgsessionVar:null,CfgDialogIns:null,authViewMode:null,setup:function(t){this.listenTo(this.model,"onChange",this.render);this.appDiv=t.appDiv;this.access=t.access;this.accessCFG=t.accessCFG;this.accessCHG=t.accessCHG;this.accessIDS=t.accessIDS;this.myAuthKey=t.myAuthKey;this.editAllowed=t.editAllowed;this.showEvolution=t.showEvolution;this.showChange=t.showChange;this.allowChangeConfguired=t.allowChangeConfguired;this.authViewMode=t.authViewMode;widget.addEvent("onResize",function(){if(document.querySelector(".popover")){document.querySelector(".popover").hide()}})},render:function(){var w=this;var u=g.CFG_CA_HEADER;var t=document.querySelector("#myTestDiv");if(enoviaServerAuthoringWidget.saveMode==="change"){u=g.CFG_CA_HEADER}else{u=g.CFG_Session_Header}if(t){t.setContent("")}if(UWA.is(this.model.id)){if(t){t.appendChild(UWA.createElement("div",{"class":"caHeader",id:"caHeaderDiv1",html:u}));var v;if((enoviaServerAuthoringWidget.saveMode==="change")){var v=new m({model:w.model,contextualActions:w.contextMenuAuth()})}if((enoviaServerAuthoringWidget.saveMode==="session")){var v=new a({model:w.model,contextualActions:w.contextMenuAuthSession()})}v.container.setStyles({width:"255px",minWidth:"255px",right:"5px",overflow:"hidden",whiteSpace:"nowrap"});v.render().inject(t);if(this.editAllowed==true||this.editAllowed=="undefined"||this.editAllowed==undefined){t.appendChild(UWA.createElement("div",{styles:{display:"flex","float":"right"},html:new n({type:"switch",id:"autoggle",checked:enoviaServerAuthoringWidget.status,label:" ",events:{onClick:function(){var z=document.querySelector("#iconAuthImg");if(this.isChecked()){enoviaServerAuthoringWidget.status=true;z.src=d.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxCA.png");var A=w.appDiv.querySelector("#BubbleContainer");A.setStyle("borderColor","#78befa");if(enoviaServerAuthoringWidget.saveMode==="change"){b.publish("toggleActiveCA"+w.myAuthKey)}else{b.publish("toggleActiveSE")}}else{enoviaServerAuthoringWidget.status=false;var A=w.appDiv.querySelector("#BubbleContainer");A.setStyle("borderColor","#d3d3d3");z.src=d.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");if(enoviaServerAuthoringWidget.saveMode==="change"){b.publish("toggleDeActiveCA"+w.myAuthKey)}else{b.publish("toggleDeActiveSE")}}}}})}))}var x=w.appDiv.querySelector("#BubbleContainer");x.setStyle("borderColor","#78befa")}}else{this.createInnerView(t);if((this.accessCHG||this.accessIDS)&&((this.showChange==true||this.showChange=="undefined"||this.showChange==undefined))){if(t){changeActionDiv.appendChild(new l({id:"caAction1",value:g.CFG_CA_HEADER,events:{onClick:function(){if(w.accessCHG||w.accessIDS){enoviaServerAuthoringWidget.saveMode="change";w.createCAListdialog()}}}}).getContent())}}var x=w.appDiv.querySelector("#BubbleContainer");x.setStyle("borderColor","#d3d3d3");var y=enoviaServerAuthoringWidget.tenant;if((this.accessCFG||this.accessIDS)&&((this.showEvolution==true||this.showEvolution=="undefined"||this.showEvolution==undefined))){if(t){evolActionDiv.appendChild(new l({id:"caSessionBtn1",value:g.CFG_Evolution_HEADER,events:{onClick:function(){if(w.accessCFG||w.accessIDS){enoviaServerAuthoringWidget.saveMode="session";w.createSessiondialog()}}}}).getContent())}}var x=w.appDiv.querySelector("#BubbleContainer");x.setStyle("borderColor","#d3d3d3")}},createCAListdialog:function(){var t=new UWA.Class.Collection();o.create(myTestDiv,t)},createSessiondialog:function(){c.create(myTestDiv)},contextMenuAuth:function(){var t=this;var u=[];if(this.editAllowed==true||this.editAllowed=="undefined"||this.editAllowed==undefined){u.push({id:"delete",text:g.CFG_ToolTip_Remove,fonticon:"trash",handler:function(v){var x=document.querySelector("#myTestDiv");x.setContent("");var w=document.querySelector(".tooltip.tooltip-root");if(w){w.setStyle("display","none")}t.model._attributes.title="";t.model._attributes.id="";t.model._attributes.severity="";t.model._attributes.subtitle="";t.model._attributes.synopsis="";t.model._attributes.content="";t.model.id=null;var y=document.querySelector("#iconAuthImg");y.src=d.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");enoviaServerAuthoringWidget.status=true;t.createInnerView(x);var A=enoviaServerAuthoringWidget.tenant;if((t.accessCHG||t.accessIDS)&&((t.showChange==true||t.showChange=="undefined"||t.showChange==undefined))){changeActionDiv.appendChild(new l({id:"caAction1",value:g.CFG_CA_HEADER,events:{onClick:function(){if(t.accessCHG||t.accessIDS){enoviaServerAuthoringWidget.saveMode="change";t.createCAListdialog()}}}}).getContent())}if((t.accessCFG||t.accessIDS)&&((t.showEvolution==true||t.showEvolution=="undefined"||t.showEvolution==undefined))){evolActionDiv.appendChild(new l({id:"caSessionBtn1",value:g.CFG_Evolution_HEADER,events:{onClick:function(){if(t.accessCFG||t.accessIDS){t.createSessiondialog(this.appDiv)}}}}).getContent())}var z=t.appDiv.querySelector("#BubbleContainer");z.setStyle("borderColor","#d3d3d3");b.publish("removeAuthCtxEvent"+t.myAuthKey)}})}return u},contextMenuAuthSession:function(){var t=this;var u=[];if(this.editAllowed==true||this.editAllowed=="undefined"||this.editAllowed==undefined){u.push({id:"delete",text:g.CFG_ToolTip_Remove,fonticon:"trash",handler:function(v){var x=document.querySelector("#myTestDiv");x.setContent("");var w=document.querySelector(".tooltip.tooltip-root");if(w){w.setStyle("display","none")}t.model._attributes.title="";t.model._attributes.id="";t.model._attributes.severity="";t.model._attributes.subtitle="";t.model._attributes.synopsis="";t.model._attributes.content="";t.model._attributes.evolExpression="";t.model._attributes.dictionaryContext="";t.model.id=null;var y=document.querySelector("#iconAuthImg");y.src=d.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");enoviaServerAuthoringWidget.status=true;t.createInnerView(x);if((t.accessCHG||t.accessIDS)&&((t.showChange==true||t.showChange=="undefined"||t.showChange==undefined))){changeActionDiv.appendChild(new l({id:"caAction1",value:g.CFG_CA_HEADER,events:{onClick:function(){if(t.accessCHG||t.accessIDS){enoviaServerAuthoringWidget.saveMode="change";t.createCAListdialog()}}}}).getContent())}if(t.accessCFG||t.accessIDS){evolActionDiv.appendChild(new l({id:"caSessionBtn1",value:g.CFG_Evolution_HEADER,events:{onClick:function(){if(t.accessCFG||t.accessIDS){t.createSessiondialog(this.appDiv)}}}}).getContent())}var z=t.appDiv.querySelector("#BubbleContainer");z.setStyle("borderColor","#d3d3d3");b.publish("removeAuthCtxSessionEvent")}},{id:"Edit",text:g.CFG_ACTION_EDIT,fonticon:"pencil",handler:function(v){require(["DS/CfgBaseUX/scripts/CfgDialog","DS/CfgEvolutionUX/CfgEvolutionLayoutFactory","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgController"],function(y,J,E,B,F,A){var H=function(){var K=J.getGlobalSessiondata();if((K["Evolution Expression"]!="")){A.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}F.populate3DSpaceURL().then(function(L){F.populateSecurityContext().then(function(M){B.getAuthoringIDforEvolution(K).then(function(P){var O=P.ACId;var Q=P.XSLTExpr;var N=E.get();N.evolution.id=O;N.evolution.displayExpression=Q;E.updateSessionEff(N);b.publish("sessionEff",N);b.publish("toggleActiveSE");h.CfgDialogIns.closeDialog()},function(N){console.log("Not a change action");return Promise.reject(N)})},function(M){console.log("populateSecurityContext Failed");return Promise.reject(M)})},function(L){console.log("populate3DSpaceURL Failed");return Promise.reject(L)})}else{A.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}F.populate3DSpaceURL().then(function(L){F.populateSecurityContext().then(function(M){B.deleteAuthroingContext().then(function(){var N=E.get();N.evolution.id="";N.evolution.displayExpression="";E.updateSessionEff(N);b.publish("sessionEff",N);b.publish("toggleActiveSE");h.CfgDialogIns.closeDialog()},function(N){console.log("Not a change action");return Promise.reject(N)})},function(M){console.log("populateSecurityContext Failed");return Promise.reject(M)})},function(L){console.log("populate3DSpaceURL Failed");return Promise.reject(L)})}};var G=function(){h.CfgDialogIns.closeDialog();myTestDiv.style.pointerEvents="auto"};var C=function(){myTestDiv.style.pointerEvents="auto"};var x=[{label:g.CFG_SE_ACTION_OK,handler:H,className:"primary"},{label:g.CFG_SE_ACTION_Cancel,handler:G,className:"default"}];var z=E.get();var D=E.work_under.iXML;var w=E.work_under.dictionaryList;var I={tenant:enoviaServerFilterWidget.tenant,environment:"Dashboard",parent:null,parentElement:null,objectid:null,mode:"SessionEffectivity",iXml:D,modelList:w,Access:{SetSessionEffectvity:"true"},dialogue:{header:g.CFG_Edit_Session_Header,buttonArray:x,target:widget.body,object:null,postCloseHandler:C}};h.CfgDialogIns=new y(I);I.parent=h.CfgDialogIns.container;I.parentElement=h.CfgDialogIns.container;I.dialogue.object=h.CfgDialogIns;h.CfgDialogIns.render();J.create(I);if(document.getElementsByClassName("CfgSessionEffectivityDialog")[0]!=undefined){myTestDiv.style.pointerEvents="none"}document.getElementsByClassName("CfgSessionEffectivityDialog")[0].setAttribute("style",document.getElementsByClassName("CfgSessionEffectivityDialog")[0].getAttribute("style")+"min-height:310px !important;min-width:310px !important;")})}})}return u},createInnerView:function(u){var x=UWA.createElement("div",{id:"cabodyDiv1"});var v=UWA.createElement("div",{id:"changeActionDiv",styles:{"margin-bottom":"0px"}});var w=UWA.createElement("div",{id:"evolActionDiv",styles:{display:"grid"}});var t=UWA.createElement("div",{styles:{color:"#e2e2e2"},id:"cabodyDiv3",html:"-----------"+g.CFG_Seperator+"----------"});var y=enoviaServerAuthoringWidget.tenant;if((this.options.accessCHG||this.options.accessIDS)&&((this.showChange==true||this.showChange=="undefined"||this.showChange==undefined))){x.appendChild(v)}if(((this.showEvolution==true||this.showEvolution=="undefined"||this.showEvolution==undefined))&&((this.showChange==true||this.showChange=="undefined"||this.showChange==undefined))){if((this.options.accessCFG&&this.options.accessCHG)){x.appendChild(t)}}if((this.options.accessCFG||this.options.accessIDS)&&((this.showEvolution==true||this.showEvolution=="undefined"||this.showEvolution==undefined))){x.appendChild(w)}if(u!=null){u.appendChild(x)}}});return h});define("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext",["UWA/Class","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Tooltip","DS/DataDragAndDrop/DataDragAndDrop","DS/UIKIT/Alert","css!DS/UIKIT/UIKIT.css","i18n!DS/CfgAuthoringContextUX/assets/nls/CfgAuthoringContextNLS","css!DS/CfgAuthoringContextUX/CfgAuthoringContextUX","UWA/Controls/Popup","DS/CfgAuthoringContextUX/scripts/CfgAuthoringUtility","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Popover","DS/UIKIT/Input/Button","DS/W3DXComponents/Views/Item/TileView","UWA/Class/Model","DS/CfgAuthoringContextUX/scripts/CfgWorkUnderView","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgCAListDialog","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","DS/CfgBaseUX/scripts/CfgController","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgAuthoringContextUX/scripts/CfgSessionDialog","UWA/Controls/Drag"],function(t,c,s,f,k,w,h,d,i,u,g,v,o,m,n,j,l,q,b,r,p,e,a){return t.singleton({renderDiv:null,authoringTooltip:null,model:null,isLicenseValid:undefined,isLicenseCFGValid:undefined,isLicenseCHGValid:undefined,isLicenseIDSValid:undefined,myAuthkey:null,isTenantChanged:false,fromRefresh:false,authViewModeCtx:undefined,init:function(){var y=this;var x=function(z){y.isLicenseCFGValid=z.isCFGRoleAvail;y.isLicenseCHGValid=z.isCHGRoleAvail;if((y.isLicenseCFGValid==true)||(y.isLicenseCHGValid==true)){y.isLicenseValid=true}else{y.isLicenseValid=false}};p.rolesAvailable(x);this.work_under={CA_Auth_Name:"",iXML:"",dictionaryList:"",Auth_Details:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},evolution:{id:"",displayExpression:""}},Message_WARN:{isLicenseValid:false,Message:"Work Under is disabled, as the user does not have either Change or Configuration license"},Message_SUCCESS:{validKey:"",isLicenseValid:true}},this.model=new n()},initialize:function(L,M,J,D,I){this.renderDiv=L;var F=this;var B="";var C="";var A=c.getApplicationConfiguration("app.urls.myapps"),H=(window.UWA.Data.proxies.passport?"passport":"ajax"),B=B.substring(0,B.indexOf("/webapps"));if(!A||C){A=B}var z=new Date();var E=z.getTimezoneOffset();var y;if(M==null||M==""){var G=new Date().getTime();y=G+"/AuthKey"}else{y=M+"/AuthKey"}this.myAuthkey=y;var K=J;window.enoviaServerAuthoringWidget={sRealURL:B,serviceName:"3DSpace",baseURL:"",InterCom:UWA.Utils.InterCom,compassSocket:null,prefIntercomServer:null,compassSocketName:"",prefSocketName:"",storageUrl:A,timezone:E,wsCallTimeout:30000,mySecurityContext:"",proxy:H,myRole:"",contextUser:"",isNative:false,fromIDCard:false,referentialsSearchType:"",contextSearchType:"",proposedSearchType:"",datamodel:"new",project_space:"",mode:"Dashboard",saveMode:"",odtEditMode:false,status:true,get3DSpaceURL:function(){return this.baseURL},computeUrl:function(N){return this.get3DSpaceURL()+N},getSecurityContext:function(){return this.mySecurityContext},getRole:function(){return this.myRole},collabspace:"",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",tenantnls:""};r.init(null,"","3DDashboard");this.displayBubble=J;if(I!=undefined){this.editAllowed=(I.isEditable!=undefined)?I.isEditable:true;this.showEvolution=(I.isEvolution!=undefined)?I.isEvolution:true;this.showChange=(I.isChange!=undefined)?I.isChange:true;this.allowChangeConfguired=(I.isChangeConfguired!=undefined)?I.isChangeConfguired:true;this.isMovable=(I.isMovable!=undefined)?I.isMovable:false;this.resetDefault=(I.resetDefault!=undefined)?I.resetDefault:false}else{this.editAllowed=true;this.showEvolution=true;this.showChange=true;this.allowChangeConfguired=true;this.isMovable=false;this.resetDefault=false}this.bubblePosition="position-";if(D==null||D==""){this.bubblePosition+="bottom-right"}else{this.bubblePosition+=D}var F=this;this.injectAuthoringContext(L);widget.addEvent("onResize",function(){if(F.isMovable&&F.resetDefault){var N=F.renderDiv.querySelector("#BubbleContainer");N.style.top=null;N.style.left=null;F.setPosition(F.bubblePosition)}});var x=this.renderDiv.querySelector("#BubbleContainer");if(this.isMovable){this.dragControl=new a.Move({container:this.renderDiv,delegate:"#BubbleContainer > *",centerHandles:true,handles:function(N){return N.target.getClosest("#BubbleContainer")}})}this.createToolTip();this.createPopOver();this.makeDroppable(x,y);if(F.displayBubble=="hide"){x.style.visibility="hidden"}c.subscribe(y,function(N){F.fromRefresh=false;F.update(N);enoviaServerAuthoringWidget.saveMode="change"});c.subscribe("sessionEff",function(N){F.updateSessionEff(N)});c.subscribe("toggleDeActiveCA"+this.myAuthkey,function(){F.deactivateBubble()});c.subscribe("toggleDeActiveSE",function(){F.deactivateBubble()});c.subscribe("toggleActiveSE",function(){var N=F.renderDiv.querySelector("#iconAuthImg");N.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxSE.png");F.activateBubble()});c.subscribe("toggleActiveCA"+this.myAuthkey,function(){var N=F.renderDiv.querySelector("#iconAuthImg");N.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxCA.png");F.activateBubble()});c.subscribe("removeAuthCtxEvent"+this.myAuthkey,function(){F.cleanAuthDetails()});c.subscribe("removeAuthCtxSessionEvent",function(){F.cleanAuthDetails()});widget.addEvent("onRefresh",function(){if(enoviaServerFilterWidget.tenant==widget.getValue("x3dPlatformId")){F.isTenantChanged=false}else{F.isTenantChanged=true}F.fromRefresh=true;var N=F.get();if(enoviaServerAuthoringWidget.saveMode=="change"){F.update(N)}else{if(enoviaServerAuthoringWidget.saveMode=="session"){F.updateSessionEff(N)}}});return y},initialize2:function(E,F,C,y,x,B){this.renderDiv=E;var A=this;if(A.isLicenseValid){var D=A.initialize(E,F,C,y,B);A.work_under.Message_SUCCESS.validKey=D;x(A.work_under.Message_SUCCESS);return}else{if(A.isLicenseValid==false){x(A.work_under.Message_WARN)}else{var z=function(H){A.isLicenseCFGValid=H.isCFGRoleAvail;A.isLicenseCHGValid=H.isCHGRoleAvail;if((A.isLicenseCFGValid==true)||(A.isLicenseCHGValid==true)){A.isLicenseValid=true;var G=A.initialize(E,F,C,y,B);A.work_under.Message_SUCCESS.validKey=G;x(A.work_under.Message_SUCCESS);return}else{A.isLicenseValid=false;x(A.work_under.Message_WARN)}};p.rolesAvailable(z)}}},createToolTip:function(){this.authoringTooltip=new s({className:"authoringtooltip",id:"authtoolTipId",position:"bottom",target:this.renderDiv.querySelector("#BubbleContainer"),body:" "+h.CFG_NO_WORK_UNDER,trigger:"touch"})},createPopOver:function(y){var z=this;var x=new UWA.createElement("div",{id:"myTestDiv",html:""});this.popOver=new v({className:"authoringpopover",target:this.renderDiv.querySelector("#BubbleContainer"),position:"left",body:x,title:h.CFG_WorkUnder_HEADER,trigger:"touch",events:{onShow:function(){if(document.querySelector(".popover")){document.querySelector(".popover").show()}document.querySelector("#myTestDiv").style.pointerEvents="auto";var A=z.get();var B=A.AuthoringContextHeader;if(B!=null){var C=B["DS-Change-Authoring-Context"];if(C!=undefined){z.authViewModeCtx="change"}var D=B["DS-Configuration-Authoring-Context"];if(D!=undefined){z.authViewModeCtx="session"}}new j({model:z.model,appDiv:z.renderDiv,access:z.isLicenseValid,accessCFG:z.isLicenseCFGValid,accessCHG:z.isLicenseCHGValid,accessIDS:z.isLicenseIDSValid,editAllowed:z.editAllowed,showEvolution:z.showEvolution,showChange:z.showChange,allowChangeConfguired:z.allowChangeConfguired,myAuthKey:z.myAuthkey,authViewMode:z.authViewModeCtx}).render()}}})},injectAuthoringContext:function(y){var A=this;var x=new UWA.createElement("div",{"class":this.bubblePosition,events:{click:function(B){},mouseover:function(){if(A.work_under.CA_Auth_Name==""){A.authoringTooltip.setBody(h.CFG_NO_WORK_UNDER)}else{var B=A.get();A.authoringTooltip.setBody(A.work_under.CA_Auth_Name)}}}});x.setAttributes({id:"BubbleContainer"});var z=UWA.createElement("img",{src:g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png"),events:{}});z.setAttributes({id:"iconAuthImg"});z.inject(x);this.renderDiv.appendChild(x)},makeDroppable:function(y,x){var z=this;f.droppable(y,{drop:function(E){if(UWA.is(E)&&E!=""){var F=JSON.parse(E);var A=F.data.items[0].objectId;var C=F.data.items[0].displayType;var D=F.data.items[0].displayName;var B=z.get();B.AuthoringContextHeader=null;B.change.id=A;B.change.name=D;enoviaServerAuthoringWidget.status=true;z.fromRefresh=false;z.update(B);z.publish(x,B);c.publish("toggleActiveCA")}},enter:function(){arguments[1].preventDefault();arguments[1].stopPropagation()},over:function(){var A=arguments[0];A.setStyles({borderColor:"#78befa"});arguments[1].preventDefault();arguments[1].stopPropagation()},leave:function(){var A=arguments[0];A.setStyles({borderColor:"#d3d3d3"});arguments[1].preventDefault();arguments[1].stopPropagation()}})},get2:function(z){var A=this;if(A.isLicenseValid){var y=A.get();z(y)}else{if(A.isLicenseValid==false){z(A.work_under.Message_WARN)}else{var x=function(C){A.isLicenseCFGValid=C.isCFGRoleAvail;A.isLicenseCHGValid=C.isCHGRoleAvail;if((A.isLicenseCFGValid==true)||(A.isLicenseCHGValid==true)){A.isLicenseValid=true;var B=A.get();z(B);return}else{A.isLicenseValid==false;z(A.work_under.Message_WARN)}};p.rolesAvailable(x)}}},get:function(){var y=this;if(y.model.get("id")!=undefined){if(enoviaServerAuthoringWidget.status){if(enoviaServerAuthoringWidget.saveMode==="change"){y.work_under.Auth_Details.change.id=y.model.get("id");var z=null;if(y.model.get("id")!=""){z={"DS-Change-Authoring-Context":"pid:"+y.model.get("id")}}y.work_under.Auth_Details.AuthoringContextHeader=z;y.work_under.Auth_Details.change.description=y.model.get("content");y.work_under.CA_Auth_Name=y.model.get("title")}else{y.work_under.Auth_Details.evolution.id=y.model.get("id");y.work_under.Auth_Details.evolution.displayExpression=y.model.get("content");y.work_under.iXML=y.model.get("evolExpression");y.work_under.dictionaryList=y.model.get("dictionaryContext");var x=null;if(y.model.get("id")!=""){x={"DS-Configuration-Authoring-Context":"pid:"+y.model.get("id")}}y.work_under.Auth_Details.AuthoringContextHeader=x;y.work_under.CA_Auth_Name=y.model.get("content")}y.work_under.Auth_Details.version="1.0";y.work_under.Auth_Details.change.name=y.model.get("synopsis");y.work_under.Auth_Details.change.context=y.model.get("context");y.work_under.Auth_Details.change.title=y.model.get("title");y.work_under.Auth_Details.change.severity=y.model.get("severity")}else{y.work_under.Auth_Details.version="1.0";y.work_under.Auth_Details.change.id="";y.work_under.Auth_Details.change.name="";y.work_under.Auth_Details.change.context=[];y.work_under.Auth_Details.change.title="";y.work_under.Auth_Details.change.description="";y.work_under.Auth_Details.change.severity="";if(enoviaServerAuthoringWidget.saveMode==="change"){y.work_under.CA_Auth_Name=y.model.get("title")}else{if(enoviaServerAuthoringWidget.saveMode==="session"){y.work_under.CA_Auth_Name=y.model.get("content")}}y.work_under.Auth_Details.evolution.id="";y.work_under.Auth_Details.evolution.displayExpression="";y.work_under.Auth_Details.AuthoringContextHeader=null}}else{y.work_under.Auth_Details.version="1.0";y.work_under.Auth_Details.change.id="";y.work_under.Auth_Details.change.name="";y.work_under.Auth_Details.change.context=[];y.work_under.Auth_Details.change.title="";y.work_under.Auth_Details.change.description="";y.work_under.Auth_Details.change.severity="";y.work_under.Auth_Details.evolution.id="";y.work_under.Auth_Details.evolution.displayExpression="";y.work_under.CA_Auth_Name="";y.work_under.Auth_Details.AuthoringContextHeader=null}return y.work_under.Auth_Details},set2:function(z,x){var y=this;y.set(z,function(A){})},set:function(B,y){var A=this;var C=B.change.id;var x=B.change.name;var E=B.change.title;var F=B.change.description;var G=B.change.severity;var D="";var z=B.AuthoringContextHeader;if(z!=null){if(("DS-Configuration-Authoring-Context" in z)){D="Evolution"}}if(D=="Evolution"){A.setEffectivity(B)}else{r.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}p.populate3DSpaceURL().then(function(H){p.populateSecurityContext().then(function(I){u.getCAdetails(C).then(function(af){var T=A.fromRefresh;A.fromRefresh=false;var Q="";var W="";var O="";var U="";var P="";var aa=JSON.parse(b);var K=aa.ApplicabilityCheck;var S=c.getUser();var N=S.login;var J=af.changeaction.attributes;for(var ac=0;ac<J.length;ac++){if(J[ac]["name"]=="current"){Q=J[ac].value}else{if(J[ac]["name"]=="attribute_Severity"){W=J[ac].value}else{if(J[ac]["name"]=="attribute_Synopsis"){O=J[ac].value}else{if(J[ac]["name"]=="interface[Change On Hold]"){U=J[ac].value}}}}}for(var X=0;X<af.changeaction.people.length;X++){var ae=af.changeaction.people[X].name;var ad=af.changeaction.people[X].role;if(ae==N&&(ad=="contributor"||ad=="owner")){P="TRUE"}}if(Q=="In Work"&&U=="FALSE"&&P=="TRUE"&&A.isTenantChanged==false){if(!A.allowChangeConfguired){if(af.changeaction.applicability.display.length===0){var R=O;var Z=af.changeaction.description;var ag=af.changeaction.name;var Y=af.changeaction.context;var W=W;A.model.set("id",C);A.model.set("image",g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+W+".png"));A.model.set("context",Y);A.model.set("title",R);A.model.set("content",Z);A.model.set("synopsis",ag);A.model.set("severity",W);A.model.set("subtitle",ag);A.work_under.CA_Auth_Name=A.model.get("title");var V=A.renderDiv.querySelector("#iconAuthImg");V.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxCA.png");enoviaServerAuthoringWidget.status=true;enoviaServerAuthoringWidget.saveMode="change";if(y!=undefined){var ab=A.get();y(ab)}}else{var L=A.renderDiv.querySelector("#BubbleContainer");L.setStyle("borderColor","#d3d3d3");var V=A.renderDiv.querySelector("#iconAuthImg");V.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");u.removeClassFromDom("wp-authAlert");var M=new k({className:"wp-authAlert",visible:true,autoHide:true,hideDelay:2000}).inject(A.renderDiv,"top");M.add({className:"error",message:h.CA_Applicability_Block})}}else{var R=O;var Z=af.changeaction.description;var ag=af.changeaction.name;var Y=af.changeaction.context;var W=W;A.model.set("id",C);A.model.set("image",g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/Change_Action_80x60_"+W+".png"));A.model.set("context",Y);A.model.set("title",R);A.model.set("content",Z);A.model.set("synopsis",ag);A.model.set("severity",W);A.model.set("subtitle",ag);A.work_under.CA_Auth_Name=A.model.get("title");var V=A.renderDiv.querySelector("#iconAuthImg");V.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxCA.png");enoviaServerAuthoringWidget.status=true;enoviaServerAuthoringWidget.saveMode="change";if(y!=undefined){var ab=A.get();y(ab)}}}else{var L=A.renderDiv.querySelector("#BubbleContainer");L.setStyle("borderColor","#d3d3d3");var V=A.renderDiv.querySelector("#iconAuthImg");V.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");u.removeClassFromDom("wp-authAlert");var M=new k({className:"wp-authAlert",visible:true,autoHide:true,hideDelay:2000}).inject(A.renderDiv,"top");if(A.isTenantChanged==true){A.isTenantChanged=false}else{if(T){M.add({className:"warning",message:h.CFG_REFRESH_CA_STATE_CHECK})}else{M.add({className:"error",message:h.CFG_DROP_CA_ACTION_STATE_CHECK})}}A.model._attributes.title="";A.model._attributes.id="";A.model._attributes.severity="";A.model._attributes.subtitle="";A.model._attributes.synopsis="";A.model._attributes.content="";A.model.id=null;A.model.set("image","");c.publish("removeAuthCtxEvent"+A.myAuthkey)}},function(J){var L=A.renderDiv.querySelector("#BubbleContainer");L.setStyle("borderColor","#d3d3d3");var K=A.renderDiv.querySelector("#iconAuthImg");K.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");u.removeClassFromDom("wp-authAlert");var M=new k({className:"wp-authAlert",visible:true,autoHide:true,hideDelay:2000}).inject(A.renderDiv,"top");A.model._attributes.title="";A.model._attributes.id="";A.model._attributes.severity="";A.model._attributes.subtitle="";A.model._attributes.synopsis="";A.model._attributes.content="";A.model.id=null;A.model.set("image","");c.publish("removeAuthCtxEvent"+A.myAuthkey);return Promise.reject(J)})},function(I){return Promise.reject(I)})},function(H){return Promise.reject(H)})}},setEffectivity:function(B,x){var z=this;enoviaServerAuthoringWidget.saveMode="session";var y=B.evolution.id;if(y!=""){var A=B.evolution.displayExpression;z.model.set("content",A);r.init();if(widget.getValue("x3dPlatformId")){enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId")}else{enoviaServerFilterWidget.tenant="OnPremise"}p.populate3DSpaceURL().then(function(C){p.populateSecurityContext().then(function(D){u.readAuthroingContext().then(function(H){var G=H.ACId;var F=H["Evolution Expression"];var E=H["Dictionary Contexts"];z.model.set("id",y);z.model.set("context","");z.model.set("title","");z.model.set("synopsis","");z.model.set("severity","");z.model.set("subtitle","");z.model.set("evolExpression",F);z.model.set("dictionaryContext",E);z.work_under.CA_Auth_Name=z.model.get("evolExpression");var J=z.renderDiv.querySelector("#iconAuthImg");J.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxSE.png");enoviaServerAuthoringWidget.saveMode="session";enoviaServerAuthoringWidget.status=true;if(x!=undefined){var I=z.get();x(I)}},function(E){console.log("create fail");return Promise.reject(E)})},function(D){console.log("populateSecurityContext Failed");return Promise.reject(D)})},function(C){console.log("populate3DSpaceURL Failed");return Promise.reject(C)})}else{z.model.id=null;z.model._attributes.content="";z.model._attributes.id="";z.model._attributes.evolExpression="";z.model._attributes.dictionaryContext="";c.publish("removeAuthCtxSessionEvent")}},publish:function(x,y){c.publish(x,y)},update:function(x){this.set(x)},updateSessionEff:function(x){this.setEffectivity(x)},getAllowedType:function(){var x=["Change Action"];return x},hide:function(){var x=this.renderDiv.querySelector("#BubbleContainer");if(typeof(x)!="undefined"&&x!=null){x.style.visibility="hidden"}},show:function(){var x=this.renderDiv.querySelector("#BubbleContainer");if(typeof(x)!="undefined"&&x!=null){x.style.visibility="visible"}},setPosition:function(x){var y=this.renderDiv.querySelector("#BubbleContainer");if(typeof(y)!="undefined"&&y!=null){y.classList.remove("position-bottom-right");y.classList.remove("position-bottom-left");y.classList.remove("position-top-left");y.classList.remove("position-top-right");y.classList.add("position-"+x)}},deactivateBubble:function(){var y=this;var x=y.renderDiv.querySelector("#iconAuthImg");x.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");var A=y.renderDiv.querySelector("#BubbleContainer");A.setStyle("borderColor","#d3d3d3");enoviaServerAuthoringWidget.status=false;var z=document.querySelector("#autoggle");z.checked=false},activateBubble:function(){var x=this;var z=x.renderDiv.querySelector("#BubbleContainer");z.setStyle("borderColor","# 78befa");enoviaServerAuthoringWidget.status=true;var y=document.querySelector("#autoggle");y.checked=true},cleanAuthDetails:function(){var A=this;var D=document.querySelector("#myTestDiv");if(D){D.setContent("")}var C=document.querySelector(".tooltip.tooltip-root");if(C){C.setStyle("display","none")}A.model._attributes.title="";A.model._attributes.id="";A.model._attributes.severity="";A.model._attributes.subtitle="";A.model._attributes.synopsis="";A.model._attributes.content="";A.work_under.iXML="";A.work_under.dictionaryList=[];A.model.id=null;var E=document.querySelector("#iconAuthImg");E.src=g.getWebappsAssetUrl("CfgAuthoringContextUX","icons/32/I_AuthCtxEmpty.png");enoviaServerAuthoringWidget.status=true;var F=UWA.createElement("div",{id:"cabodyDiv1"});var y=UWA.createElement("div",{id:"changeActionDiv",styles:{"margin-bottom":"0px"}});var G=UWA.createElement("div",{styles:{color:"#e2e2e2"},id:"cabodyDiv3",html:"-----------"+h.CFG_Seperator+"----------"});var B=UWA.createElement("div",{id:"evolActionDiv",styles:{display:"grid"}});var z=enoviaServerAuthoringWidget.tenant;if((A.isLicenseCHGValid||A.isLicenseIDSValid)&&((A.showChange==true||A.showChange=="undefined"||A.showChange==undefined))){F.appendChild(y)}if((A.showEvolution==true||A.showEvolution=="undefined"||A.showEvolution==undefined)&&(A.showChange==true||A.showChange=="undefined"||A.showChange==undefined)){if((A.isLicenseCHGValid&&A.isLicenseCFGValid)){F.appendChild(G)}}if((A.isLicenseCFGValid||A.isLicenseIDSValid)&&((A.showEvolution==true||A.showEvolution=="undefined"||A.showEvolution==undefined))){F.appendChild(B)}if(D){D.appendChild(F)}y.appendChild(new o({id:"caAction2",value:h.CFG_CA_HEADER,events:{onClick:function(){if(A.isLicenseCHGValid||A.isLicenseIDSValid){var H=new UWA.Class.Collection();enoviaServerAuthoringWidget.saveMode="change";q.create(D,H)}}}}).getContent());B.appendChild(new o({id:"caSessionBtn1",value:h.CFG_Evolution_HEADER,events:{onClick:function(){if(A.isLicenseCFGValid||A.isLicenseIDSValid){var H=new UWA.Class.Collection();enoviaServerAuthoringWidget.saveMode="session";e.create(D)}}}}).getContent());var x=A.renderDiv.querySelector("#BubbleContainer");x.setStyle("borderColor","#d3d3d3")}})});