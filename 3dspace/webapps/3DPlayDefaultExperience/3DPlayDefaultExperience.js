/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/3DPlayExploreScenario/3DPlayExploreScenario",["DS/3DPlay/3DPlayScenario","DS/WebSystem/Environment"],function(c,a){var b=c.extend({init:function(d){this._parent(d)},isMobileCompatible:function(){return true}});return b});var PlayWebDictionary=function(){var c={VCXWebComponentOccurrence:{W3AISGNodeHolder:"DS/WebApplicationBase/W3AASGNodeHolder"},VCXVolatileGhostingManager:{W3AIManager:"DS/VCXWebVolatileGhosting/VCXVolatileGhostingManager"},VCXExplodeBoxManager:{W3AIManager:"DS/VCXWebExplodeServices/VCXExplodeBoxManager"}};var d={};var b={VCXVolatileGhostingManager:"DS/VCXWebVolatileGhosting/VCXVolatileGhostingManager",VCXExplodeBoxManager:"DS/VCXWebExplodeServices/VCXExplodeBoxManager"};if(window.localStorage["3DPlay.UseExplodeCompatibleAnnotationManager"]){c.VCXLevelExploderManager={W3AIManager:"DS/VCXWebLevelExploderGUI/VCXLevelExploderManager"};b.VCXLevelExploderManager="DS/VCXWebLevelExploderGUI/VCXLevelExploderManager"}var e=["DS/WebExtensionServers/WebExtensionServer"];Object.keys(c).forEach(function(f){Object.keys(c[f]).forEach(function(g){e.push(c[f][g])})});Object.keys(d).forEach(function(f){e.push(d[f])});Object.keys(b).forEach(function(f){e.push(b[f])});var a=["VCXWebVolatileGhosting/VCXWebVolatileGhosting"];define("DS/3DPlayDefaultExperience/PlayWebDictionary",e,function(){var f=arguments;var h=f[0];var g={fillServer:function(){var k=new h();var i=0;var j=this;Object.keys(c).forEach(function(l){Object.keys(c[l]).forEach(function(n){i++;var m=f[i];var o=e[i];m.GetOrigin=function(){return o};k.AddExtension(l,n,m)})});Object.keys(d).forEach(function(m){i++;var l=f[i];k.AddInterface(m,l)});Object.keys(b).forEach(function(n){i++;var l=f[i];var m=e[i];l.GetOrigin=function(){return m};k.AddComponent(n,l)});return k},getNLSModules:function(){return a}};return g})};PlayWebDictionary();define("DS/3DPlaySpecTree/3DPlaySpecTreeSOManager",["UWA/Class","DS/Visualization/PathElement","DS/Selection/XSO","DS/Selection/CSOManager","DS/Selection/HSOManager"],function(b,e,g,d,c){var i=Object.create({object:{_objectId:"",treeObject:{_objectId:"",_object:{}},visuObject:{_objectId:"",_object:{}},getId:function(){return this._objectId}},getObjectForId:function(k){for(var j in this){if(j.getId()===k){return j}}}});var f=function(j){};var h=function(j){};var a=b.extend({init:function(j){this._parent(j);var k=function(n,m){return false};var l=function(m){return false};this._cso=new g({getElementID:l,useUniqueID:true,areEquals:k})},getCSO:function(){return this._cso},dispose:function(){this._parent()}});return a});define("DS/3DPlaySpecTree/3DPlaySpecTree",[],function(){});define("DS/3DPlayExploreScenario/3DPlayExploreRegister",["DS/3DPlay/3DPlayRegister","DS/3DPlayExploreScenario/3DPlayExploreScenario","DS/3DPlayNavigationScenario/3DPlayNavigationScenario","DS/CAT3DAnnotationScenario/CAT3DAnnotationScenario"],function(e,c,a,b){var d=e.extend({init:function(f){this._parent(f);this._initScenarios()},_initScenarios:function(){this.scenarioManager.addScenario({registerID:this.registerID,scenario:c,available:true,name:"Explore"});this.scenarioManager.addScenario({registerID:this.registerID,scenario:a,available:true,name:"Navigation"});this.scenarioManager.addScenario({registerID:this.registerID,scenario:b,available:true,name:"FTA"})}});return d});define("DS/3DPlaySpecTree/3DPlaySpecTreeUtils",["DS/Windows/Panel","DS/WebSystem/Settings","DS/Visualization/PathElement","DS/Selection/CSOManager","DS/Selection/HSOManager","DS/3DPlaySpecTree/3DPlaySpecTreeSOManager","DS/WebappsUtils/WebappsUtils"],function(f,e,h,c,d,a,g){var b=e.get("3DPlay.SpecTree.LoggingEnabled");return{CSOManager:c,HSOManager:d,isDebugLog:b,log:b?console.log.bind(window.console):function(){},specTreeModel:null,rootPaths:null,disposeModelNode:function(){this.specTreeModel=null;this.specTreeView=null;this.viewer=null;this.rootPaths=null},registerModelNodes:function(k,i,j){var l=this;if(!k||!i||!j){this.log("3DPlay : Error - Could resolve specTreeModel, specTreeView or frameWindow",k,i,j);return false}this.viewer=j.getViewer();this.specTreeModel=k;this.specTreeView=i;this.rootPaths=this.setRootPaths(j);this.addSelectionCB();k.registerModelNodeType({nodeType:"model-node",buildIcons:function(){return[{iconName:"product"}]},buildLabel:function(m){return m.nodeModel.options.label},onSelect:function(n){var m=n.nodeModel;if(m.play3DData.fromCSO){delete m.play3DData.fromCSO}else{l.select3DNode(m.play3DData.id,l.viewer)}},onUnselect:function(p){var n=p.nodeModel;if(n.play3DData.fromCSO){delete n.play3DData.fromCSO}else{var o=n.getChildren();l.unselect3DNode(n.play3DData.id,l.viewer);if(o){for(var m=0;m<o.length;m++){if(o[m].isSelected()){l.select3DNode(o[m].play3DData.id,l.viewer)}}}}},})},buildPanel:function(l,k){var j=new UWA.Element("div");if(k.content){j.appendChild(k.content)}var i=new f({titleBarVisibleFlag:false,icon:g.getWebappsAssetUrl("3DPlaySpecTree","icons/32/")+"I_3DPlaySpecTree.png",title:"",content:j,immersiveFrame:l,resizableFlag:true,movableFlag:false,currentDockArea:k.currentDockArea|WUXDockAreaEnum.NoneDockArea,width:400,verticallyStretchableFlag:true,usePaddingFlag:false,closeButtonFlag:false,floatableFlag:false,expandedFlag:true,ensureHeightDefinitionOnHierarchy:true});return{panel:i,content:j}},setRootPaths:function(l){var i=l.getViewer().getNodes();var j=l.experience?l.experience.getRootBag():null;var k=[];i.forEach(function(m){var p=new h();if(j&&m===j){var o=m.getChildren();var q=o.length;for(var n=0;n<q;n++){p.addElement(o[n])}}else{p.addElement(m)}k.push(p)});return k},createPathFromId:function(n,m){var l=this.rootPaths;var j;var i=n.split("/");var k=function(p,o){if(p.length>0){p.forEach(function(u){var s=u.getLastElement();var t;if(s.getPersistentId!==undefined){if(s.productType=="Instance3D"||s.getPersistentId()==1){t=s.getPersistentId();if(t==o[0]){o.splice(0,1);j=u}}}else{if(s.id!==undefined){var q=s.worktype?s.worktype:s.plmtype;if(q=="VPMReference"||q=="VPMInstance"||q=="VPMRepInstance"||q=="VPMRepReference"||q=="3DShape"||q=="CATProduct"||q=="CATPart"||q=="Viewable"||q=="CgrViewable"){t=s.id;if(t==o[0]){o.splice(0,1);j=u}}}}var r=u.getChildrenOccurrencePathes();if(r!==undefined&&r!==null){k(r,o)}})}};k(l,i);return j},createIdFromPath:function(i){var n=i.pathElement;var l="";while(n!==undefined&&n!==null){var k=n.getLastElement(true);if(k.getPersistentId!==undefined){if(k.productType=="Instance3D"||k.getPersistentId()==1){if(l.length!==0){l="/"+l}l=k.getPersistentId()+l}}else{if(k.id!==undefined&&k.id!==0){var j=k.worktype?k.worktype:k.plmtype;if(j=="VPMReference"||j=="VPMInstance"||j=="VPMRepInstance"||j=="VPMRepReference"||j=="3DShape"||j=="CATProduct"||j=="CATPart"||j=="Viewable"||j=="CgrViewable"){if(l.length!==0){l="/"+l}var m=k.id;l=m+l}}}n=n.getParentOccurrencePath()}return l},select3DNode:function(m,k){this.log("-- select3DNode --:",m);var l=this;var i=[];var j=[];if(!Array.isArray(m)){j.push(m)}else{j=m}j.forEach(function(n){i.push({pathElement:l.createPathFromId(n,k)})});this.removeSelectionCB();c.add(i);d.add(i);this.addSelectionCB()},unselect3DNode:function(o,i){this.log("-- unselect3DNode --:",o);var n=this;var m=c.get();var l=[];m.forEach(function(p){l.push(n.createIdFromPath(p))});var k=[];if(!Array.isArray(o)){k.push(o)}else{k=o}var j=[];k.forEach(function(q){for(var p=0;p<l.length;p++){if(l[p].indexOf(q)>-1){j.push(m[p])}}});j.forEach(function(p){n.removeSelectionCB();c.remove(p);d.remove(p);n.addSelectionCB()})},emptySelection:function(){c.empty();d.empty()},addSelectionCB:function(){var i=this;if(this.treeSelectionCB!==undefined){this.treeSelectionCB.onAddToken=c.onAdd(function(j){if(!Array.isArray(j)){j=[j]}var k=[];j.forEach(function(l){k.push(i.createIdFromPath(l))});i.treeSelectionCB("ADD/VISUNODE",k)});this.treeSelectionCB.onRemoveToken=c.onRemove(function(j){if(!Array.isArray(j)){j=[j]}var k=[];j.forEach(function(l){k.push(i.createIdFromPath(l))});i.treeSelectionCB("REMOVE/VISUNODE",k)});this.treeSelectionCB.onEmptyToken=c.onEmpty(function(){i.treeSelectionCB("EMPTY/VISUNODE")})}},removeSelectionCB:function(){if(this.treeSelectionCB!==undefined){if(this.treeSelectionCB.onAddToken!==undefined){c.unsubscribe(this.treeSelectionCB.onAddToken)}if(this.treeSelectionCB.onRemoveToken!==undefined){c.unsubscribe(this.treeSelectionCB.onRemoveToken)}}},treeSelectionCB:function(l,k){var m=this;var j=[];var i=function(){var n=m.specTreeModel.search({match:function(p){for(var o=0;o<k.length;o++){var q=k[o];if(q&&p.nodeModel.play3DData.id===q){return true}}}});return n};m.specTreeModel.prepareUpdate();switch(l){case"EMPTY/VISUNODE":m.specTreeModel.unselectAll();break;case"ADD/VISUNODE":i().forEach(function(o,n){o.play3DData.fromCSO=true;o.select();o.reverseExpand()});break;case"REMOVE/VISUNODE":i().forEach(function(n){n.play3DData.fromCSO=true;n.unselect()});break;default:break}m.specTreeModel.pushUpdate()},}});define("DS/3DPlaySpecTree/3DPlaySpecTreePanel",["UWA/Class","DS/Visualization/PathElement","DS/SpecTree/SpecTreeView","DS/SpecTree/SpecTreeDocument","DS/Tree/TreeNodeModel","DS/Utilities/Utils","DS/Selection/CSOManager","DS/3DPlaySpecTree/3DPlaySpecTreeUtils","DS/3DPlaySpecTree/3DPlaySpecTreeSOManager","DS/WebSystem/Settings","DS/CoreEvents/Events"],function(c,e,i,h,g,j,d,f,b,a,k){return c.extend({init:function(l){this._parent(l);this._sceneRootBag=l.sceneRootBag;this._frameWindow=l.frameWindow;if(window.__karma__){this._SpecTreeUtils=f}},dispose:function(){this._destroyPanel();f.removeSelectionCB();this._sceneRootBag=undefined;this._frameWindow=undefined;this._parent()},instanciateSpecTreePanel:function(){var o=this;var n=this._frameWindow.getImmersiveFrame();this._specTreeModel=new h();this._specTreeView=new i({height:"auto",treeDocument:o._specTreeModel,show:{rowHeaders:false,columnHeaders:false},isEditable:false,enableDragAndDrop:false});var l=a.get("3DPlay.SpecTree.VisuTreeEnabled")==="true";if(l){this._frameWindow.getTree().show()}var m=l?WUXDockAreaEnum.RightDockArea:WUXDockAreaEnum.LeftDockArea;this._dockingElement=n.getDockingElement(m);this._dockingElement.collapseDockingZoneFlag=true;this._panelModel=f.buildPanel(n,{content:o._specTreeView.getContent(),currentDockArea:m});this._setupSpecTreePanel();this.SpecTreeDisableSubscribe=k.subscribe({event:"3DPLAY/SPECTREE/DISABLE"},this._disableSpecTree.bind(this));this.SpecTreeEnableSubscribe=k.subscribe({event:"3DPLAY/SPECTREE/ENABLE"},this._enableSpecTree.bind(this))},_disableSpecTree:function(){var l=this;if(!this._dockingElement.collapseDockingZoneFlag){this._dockingElement.collapseDockingZoneFlag=true}setTimeout(function(){l._dockingElement.visibleDockingZoneFlag=false;l=undefined},500)},_enableSpecTree:function(){this._dockingElement.visibleDockingZoneFlag=true},_destroyPanel:function(){if(this.SpecTreeDisableSubscribe){k.unsubscribe(this.SpecTreeDisableSubscribe)}if(this.SpecTreeEnableSubscribe){k.unsubscribe(this.SpecTreeEnableSubscribe)}if(this._specTreeView){this._specTreeView.destroy();this._specTreeView=null}if(this._panelModel&&this._panelModel.panel){this._panelModel.panel.destroy();this._panelModel.panel=null}this._specTreeModel.removeRoots();this._specTreeModel=null;f.disposeModelNode()},_setupSpecTreePanel:function(){f.registerModelNodes(this._specTreeModel,this._specTreeView,this._frameWindow);this._specTreeModel.prepareUpdate();var m;for(var l=0;l<this._sceneRootBag.children.length;l++){if(this._sceneRootBag.children[l].name!=="annotGroupNode"){m=this._sceneRootBag.children[l]}}if(m){this._generateChildren(m)}this._specTreeModel.pushUpdate()},_generateChildren:function(q,s){if(!q){f.log("3DPlay : Error - Could not resolve parentModel3DNode",q);return false}if(!s){var r=this._specTreeModel.createModelNode({nodeType:"model-node",label:q.name});var m="";if(q.getPersistentId){m+=q.getPersistentId()}r.play3DData={id:m};this._specTreeModel.addChild(r);this._generateChildren(q,r);return r}for(var n=0;n<q.children.length;n++){var o=q.children[n];var p=null;if(o.productType==="Instance3D"&&o.children.length===1&&o.children[0].productType==="Reference3D"){var t=""+o.name;var l=""+o.children[0].name;var u="Node-"+n;if(l!==""){u=l}if(t!==""){u+=" ("+t+")"}p=this._specTreeModel.createModelNode({nodeType:"model-node",label:u});var v=s.play3DData.id+"/"+o.getPersistentId();p.play3DData={id:v};s.addChild(p);this._generateChildren(o,p)}else{if(o.productType==="Reference3D"){p=s;this._generateChildren(o,p)}else{return true}}}return true}})});var annotationManager=[];if(window.localStorage["3DPlay.UseExplodeCompatibleAnnotationManager"]){annotationManager.push("DS/3DPlayAnnotation3D/AnnotationExplodeManager")}else{annotationManager.push("DS/3DPlayAnnotation3D/AnnotationManager")}define("DS/3DPlayDefaultExperience/3DPlayDefaultExperience",["DS/3DPlayExperienceModule/PlayExperience3D","DS/Visualization/ThreeJS_DS","DS/Visualization/PathElement","DS/3DPlay/3DPlay","DS/3DPlay/3DPlayScenarioManager","DS/CoreEvents/Events","DS/ApplicationFrame/CommandsManager","DS/3DPlayDefaultExperience/PlayWebDictionary","DS/3DPlaySpecTree/3DPlaySpecTreePanel","DS/WebSystem/Settings","DS/WebSystem/Environment","DS/WebUtils/Tracker","DS/WebUtils/ContextedSingleton"].concat(annotationManager),function(g,k,f,j,c,e,b,l,i,a,m,h,d,n){return g.extend({init:function(o){this._isSpecTreeAllowed=true;if(m.isSet("3DPlay.DisableInherance")){o.commandApplication=false;o.workbenchs=[{name:"PCS_3DPlayExperience3D",module:"3DPlayExperienceModule"}]}if(a.get("3DPlay.Explode")){o.workbenchs=o.workbenchs||[];o.workbenchs.unshift({name:"3DPlayExperience3D_Explode",module:"3DPlay"})}o.CGRPolicy=true;this._parent(o);var p=this;this.disposeFunctions.add(function(){p=null});this.EventDisposer.add(this.subscribe("ASSET/LOADINGFINISHED",function(){var t=(p.args&&p.args.input&&p.args.input.asset)?p.args.input.asset:undefined;if("false"===a.get("3DPlay.SpecTree.Disabled","false")&&p.isSpecTreeAllowedForAsset(t)&&p.isSpecTreeAllowed()){var v=p.frmWindow;var s=p.frmWindow.experience.getRootBag();if(p.specTreePanel===undefined){p.specTreePanel=new i({sceneRootBag:s,frameWindow:v});p.specTreePanel.instanciateSpecTreePanel();var q=p.frmWindow&&p.frmWindow.getActionBar()?p.frmWindow.getActionBar().MAB:null;if(p.specTreePanel&&q){var r=false;q.onVisibilityChangeSubscribe("PlayWeb-SpecTree",function(w){if(r===false&&w!=="hidden"){p.specTreePanel._panelModel.panel.hide();r=true}else{if(r===true&&w==="hidden"){p.specTreePanel._panelModel.panel.show();r=false}}})}}}if(!p.initialModel){var u="DS/i3DXCompassServices/i3DXCompassPubSub";require([u],function(w){console.log("i3dCompass call completed in DefaultExp");p.activatePlayFromCompass(w)},function(w){console.log(" 3DPlay compass services not fetched!! Load error")})}}));this.EventDisposer.add(this.subscribe("ASSET/LOADINGSTARTED",function(){var q=p.frmWindow&&p.frmWindow.getActionBar()?p.frmWindow.getActionBar().MAB:null;if(q){q.onVisibilityChangeUnsubscribe("PlayWeb-SpecTree")}p._vcxExplodeBoxManager=null;p._vcxVCXVolatileGhostingManager=null;if(p._vcxLevelExploderManager){p._vcxLevelExploderManager=null}}))},clearView:function(){if(this.specTreePanel){this.specTreePanel.dispose();this.specTreePanel=undefined}this._parent()},activatePlayFromCompass:function(A){var s=window.widget;var t=true;var q=false;var C=this.ctx;var r=function(){var w=b.getCommands(C);var D=w.Scenario;D.begin()};var z=function(){if(q&&t){s.fullscreen=true;var w=c.getScenarioAvailibility();if(w){A.publish("activatePlay",{appId:"X3DDRVN_AP"},function(D){r();setTimeout(function(){p()},300)})}}};var y=function(){A.publish("resetPlay",{appId:"X3DDRVN_AP"},function(w){console.log("result",w)})};var B=function(w){q=true;z()};var u=function(w){q=false;y()};var o=function(w){t=false;y()};var x=function(w){t=true;z()};var p=function(w){A.publish("activatePlay",{appId:"X3DDRVN_AP"},function(D){console.log("result",D);r();setTimeout(function(){p()},300)})};this.EventDisposer.add(e.subscribe({event:"3DPLAY/FULLSCREEN/ENABLE"},B));this.EventDisposer.add(e.subscribe({event:"3DPLAY/FULLSCREEN/DISABLE"},u));this.EventDisposer.add(e.subscribe({event:"3DPLAY/3DPLAYPREVIEW/ENABLE"},x));this.EventDisposer.add(e.subscribe({event:"3DPLAY/3DPLAYPREVIEW/DISABLE"},o));this.EventDisposer.add(e.subscribe({event:"3DPLAY/PLAYFROMCOMPASS/ENABLE"},z));this.EventDisposer.add(e.subscribe({event:"3DPLAY/PLAYFROMCOMPASS/DISABLE"},y));var v=window;while(!v.mycontainertoUse&&v.parent&&v!==v.parent){v=v.parent}if(v.swyWidgettoUse){s=v.swyWidgettoUse}if(typeof s!=="undefined"){if(s&&s.getView&&s.getView().type==="windowed"){q=false}else{q=true}}x()},isSpecTreeAllowed:function(o){if(typeof o==="boolean"){this._isSpecTreeAllowed=o}return this._isSpecTreeAllowed},isSpecTreeAllowedForAsset:function(o){o=Array.isArray(o)?o[0]:o;if(o&&o.type==="3dxml"&&(o.originalType==="3dxml"||o.originalType==="catproduct"||o.originalType===undefined)){return true}return false},initExperienceBase:function(o,p){this.experienceBase.AddDictionaryApp(l);this._parent(o);this._vcxVCXVolatileGhostingManager=this.experienceBase.Factory.BuildComponent("VCXVolatileGhostingManager");this._vcxVCXVolatileGhostingManager.SetID("VCXVolatileGhostingManagerID");this._vcxVCXVolatileGhostingManager.SetPersistency(1);this._vcxVCXVolatileGhostingManager.ghostAndRefresh_OLD=this._vcxVCXVolatileGhostingManager.ghostAndRefresh;this._vcxVCXVolatileGhostingManager.ghostAndRefresh=function(){h.inc("command-volatingghosting");this.ghostAndRefresh=this.ghostAndRefresh_OLD;this.ghostAndRefresh();delete this.ghostAndRefresh_OLD};this.experienceBase._ManagerSet.addManager("VCXVolatileGhostingManager",this._vcxVCXVolatileGhostingManager);if(a.get("3DPlay.UseExplodeCompatibleAnnotationManager")){this._vcxLevelExploderManager=this.experienceBase.Factory.BuildComponent("VCXLevelExploderManager");if(this._vcxLevelExploderManager){this._vcxLevelExploderManager.SetID("VCXLevelExploderManagerID");this._vcxLevelExploderManager.SetPersistency(1);this.experienceBase._ManagerSet.addManager("VCXLevelExploderManager",this._vcxLevelExploderManager)}}if(p){p(0)}},dispose:function(p){if(this.specTreePanel){this.specTreePanel.dispose();this.specTreePanel=undefined}var o=this.frmWindow&&this.frmWindow.getActionBar()?this.frmWindow.getActionBar().MAB:null;if(o){o.onVisibilityChangeUnsubscribe("PlayWeb-SpecTree")}this._vcxExplodeBoxManager=null;this._vcxVCXVolatileGhostingManager=null;if(this._vcxLevelExploderManager){this._vcxLevelExploderManager=null}this.frmWindow.getContextualUIManager().unregister("3DPlayContextualID");this._parent(p);this.destroyAnnotationManager()},onPreCreate:function(){if(this.args){this.args.visu={showReferenceAxisSystem:true}}this.mabModel={speeddial:[{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"},{id:"Share",icon:"3DPlay/assets/icons/32/I_3DSHAREShare.png",flyout:[]}],sections:[{id:"Scenario",nls:"3DPlay/3DPlay",rsc:"3DPlay/3DPlay",hideAB:true,showBack:true},{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:true,showBack:true},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:true,showBack:true},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuNoEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuV6Env",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCleanSpaceEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkBlueEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkGreyEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShinyEnv",rsc:"ViewerCommands/ViewerCommands"}]}]};if(this._iOS){this.mabModel.speeddial[2].flyout=[{id:"ShareTo3DSwYm",rsc:"3DPlay/3DPlay"},{id:"SharePrint",rsc:"3DPlay/3DPlay"}]}else{this.mabModel.speeddial[2].flyout=[{id:"ShareTo3DSwYm",rsc:"3DPlay/3DPlay"},{id:"ShareDownload",rsc:"3DPlay/3DPlay"},{id:"SharePrint",rsc:"3DPlay/3DPlay"}]}if(!this._iOS&&!this._android){this.mabModel.sections.splice(4,0,{id:"measure2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro",hideAB:true});this.mabModel.sections.splice(6,0,{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:true,showBack:true});this.mabModel.sections.push({id:"LineicFilter",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"})}},onPostCreate:function(){var q=this;var p=this.frmWindow.getViewer();var o=function(x,s){var t=b.getCommandCheckHeader("VCXVolatileGhostingCmd",q.ctx);var v=false;if(q._enableCMenu){v=(t&&t._state)||q._vcxVCXVolatileGhostingManager.hasVolatileGhostingToRestore()}if(q._enableCMenu&&!v&&s&&s.XmousePosition){var r=new k.Vector2(s.XmousePosition,s.YmousePosition);var u=p.getMousePosition(r);var w=p.pick(u,"mesh",true);if(w.path.length===0){return{cmdList:[{name:"Dropdown_1",line:1,hdr_list:["VisuNoEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuV6Env"]},{name:"Dropdown_2",line:1,hdr_list:["VisuCleanSpaceEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuDarkBlueEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuDarkGreyEnv"]},{name:"Dropdown_2",line:1,hdr_list:["VisuShinyEnv"]}]}}}return null};if(this._iOS||this._android){this.frmWindow.getContextualUIManager().register({workbenchName:"3DPlayExperience3D_mobile",module:"3DPlay",cmdPrefix:"",merge:true,subscriberId:"3DPlayContextualID",fileName:"3DPlayExperience3D_mobile.xml",onContextualMenuReady:o})}else{this.frmWindow.getContextualUIManager().register({workbenchName:"3DPlayExperience3D",module:"3DPlay",cmdPrefix:"",merge:true,subscriberId:"3DPlayContextualID",fileName:"3DPlayExperience3D.xml",onContextualMenuReady:o})}},createAnnotationManager:function(){d.add(this.ctx,"ANNOTATION_MANAGER",new n({frameWindow:this.frmWindow,context:this.ctx}))},destroyAnnotationManager:function(){var o=d.get(this.ctx,"ANNOTATION_MANAGER");if(o){d.remove(this.ctx,"ANNOTATION_MANAGER")}},loadAsset:function(o,q,r,p){this.destroyAnnotationManager();this.createAnnotationManager();this._parent(o,q,r,p)}})});