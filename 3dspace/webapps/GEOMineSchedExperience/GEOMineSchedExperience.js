/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/GEOMineSchedExperience/GEOMineSchedTablerSelectionManager",["UWA/Core","UWA/Event","DS/Core/Core","DS/Core/Events","DS/Selection/XSO","DS/Utilities/Object"],function(h,c,e,a,f,g){var d="GEOMineSchedTablerSelection/";var b=f.singleton({init:function(i){i={eventChannel:d,areEquals:function(k,j){k._uxid===j._uxid}};this._parent(i)}});return h.namespace("WUX/Selection/GEOMineSchedTablerSelectionManager",b)});define("DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper",["UWA/Core","UWA/Class","UWA/Element","DS/ApplicationFrame/PlayerElements","DS/ApplicationFrame/AfrPlayerService"],function(f,b,a,e,c){var d=b.singleton({init:function(i){var h=".wux-controls-playerview {background:rgba(0, 0, 0, 0);} /*.playerBorder .wux-controls-player-button { background: green; position:relative; }.wux-controls-player-button:after { content:attr(data-name);position:absolute; top:0;left:0;}.playerBorder .wux-controls-player-button[data-name=hamburger] { background: yellow; }*/",g=document.head||document.getElementsByTagName("head")[0],j=document.createElement("style");j.type="text/css";if(j.styleSheet){j.styleSheet.cssText=h}else{j.appendChild(document.createTextNode(h))}g.appendChild(j)},isVisible:function(h){var i=h.getContent().getStyle("display");var g=h.getContent().getStyle("visibility");return(i!=="none")&&(g!=="hidden")},getCallbacks:function(g){var j={};var k=undefined;var i=[c.actions.PLAY,c.actions.PAUSE,c.actions.BACK,c.actions.NEXT,c.actions.BACKWARD,c.actions.FORWARD,c.actions.FIRST,c.actions.LAST,c.actions.STOP,c.actions.PLAYREVERSE,c.actions.SLIDER_CHANGE,c.actions.EDITOR_CHANGE,c.actions.LOOPRC,c.actions.LOOPRCBF,c.actions.LOOPRO,c.actions.PLAYLIST,c.actions.OPTIONS,c.actions.EXIT];var h=function(p){g[p.event]=p;if(!p.data.source.geoCurrentPeriod){p.data.source.geoCurrentPeriod=0}if(!p.data.source.geoCurrentSpeed){p.data.source.geoCurrentSpeed=1}var o=g.FrameWindow.getRootNode();var r=o.getChildByName("scene");var q=r.getChildByName("Result3dNode");var m=q.msaResult3d.periods.length;var l=1/(m-1);var n=1000/p.data.source.geoCurrentSpeed;return{INTERVAL_TIME:n,STEP:l,periodsSize:m,result3dNode:q}};j[c.actions.PLAY]=function(l){if(c._state.progress===0){c._state.state="play"}var m=h(l);if(k!==undefined){window.clearInterval(k)}k=setInterval(function(){var o=l.data.source.geoCurrentPeriod;var n=document.getElementById("MSperiod"+o);if(n){n.style.backgroundColor="#A2CADF";n.style.color="black"}if(o>=m.periodsSize-1){l.data.source.geoCurrentPeriod=0;var p=0;window.clearInterval(k);c.setState({state:"pause",progress:p})}else{l.data.source.geoCurrentPeriod=l.data.source.geoCurrentPeriod+1;var p=l.data.source.geoCurrentPeriod*m.STEP;c.setState({state:"play",progress:p})}if(m.result3dNode&&m.result3dNode.msaResult3d){m.result3dNode.msaResult3d.applyPeriod(l.data.source.geoCurrentPeriod)}g.FrameWindow.getViewer().render()},m.INTERVAL_TIME)};j[c.actions.PAUSE]=function(m){var n=h(m);var l=m.data.source.geoCurrentPeriod;if(k!==undefined){window.clearInterval(k)}c.setState({state:"pause",progress:l*n.STEP})};j[c.actions.STOP]=function(l){var m=h(l);if(k!==undefined){window.clearInterval(k)}c.setState({state:"pause",progress:0});l.data.source.geoCurrentPeriod=0};j[c.actions.EXIT]=function(l){var n=c._playerView;var m=h(l);if(k!==undefined){window.clearInterval(k)}l.data.source.geoCurrentPeriod=0};j[c.actions.SLIDER_CHANGE]=function(m){var p=h(m);var n=c.getState().state;var l=m.data.source.geoCurrentPeriod;var q=m.data.value;var o=q*(p.periodsSize-1);var u=Math.round(o);m.data.source.geoCurrentPeriod=u;if(m.data.source.geoCurrentPeriod!==l){if(p.result3dNode&&p.result3dNode.msaResult3d){p.result3dNode.msaResult3d.applyPeriod(m.data.source.geoCurrentPeriod)}g.FrameWindow.getViewer().render()}if(Math.abs(u-o)>0.01*(p.periodsSize-1)){var r=m.data.source.geoCurrentPeriod*p.STEP;c.setState({state:n,progress:r})}var t=document.getElementById("MSperiod"+l);if(t){t.style.color="black";t.style.backgroundColor="#A2CADF"}var s=document.getElementById("MSperiod"+u);if(s){s.style.backgroundColor="#368EC4";s.style.color="white"}};return j},createPlayerContainer:function(h){f.debug=true;var i=new a("div",{id:"player",debug:true});i.inject(h);var g=new a("div",{id:"borderPlayer","class":"playerBorder",styles:{width:"100%"}});i.playerViewport=g;g.insertPlayer=function(j){j.inject(g);i.playerView=j};g.removePlayer=function(k){var j={data:{source:k}};var l=k._callbacks;j.data.value=0;l.stop(j);k.remove();h.removeChild(i)};g.inject(i);c.registerPlayerContainer(g);return i}});return d});define("GEOMineSchedExperience/GEOMineSchedExperience",["DS/GEOMineSchedExperience/GEOMineSchedExperience"],function(a){console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience");console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience");console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience");return a});define("DS/GEOMineSchedExperience/GEOMineSchedExperience",["DS/3DPlayExperienceModule/PlayExperience3D","UWA/Core","DS/ApplicationFrame/FrameWindow3D","DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper","DS/ApplicationFrame/PlayerStyle","DS/ApplicationFrame/AfrPlayerService","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/Json2Html","DS/Controls/SpinBox"],function(d,c,f,h,e,j,a,i,g){var b=d.extend({init:function(l){l=l||{};l.FrameWindow=f;var m=this;m._parent(l);var o={basicGEOExp:{workbenchs:[{name:"GEOMineSchedExperienceWkb",module:"GEOMineSchedExperience"}],swapVisible:true,selection:true,preSelection:true,visu:{antiAliasing:true,useShadowMap:true,infinitePlane:true,displayGrid:false,displayLines:false,debugShadowLight:false,debugBSphere:false,debugBBox:false,control:"COMBINED",picking:true,displayPicking:true,prePicking:true,displayprePicking:true,autoUpdatePlane:true,useMirror:true,defaultAnimationLoop:false},ui:{displayTree:false,displayActionBar:true}}};var k=o.basicGEOExp;m.args=c.extend(l,k,true);var n=m.onModelLoadingCompleted;m.onModelLoadingCompleted=function(q){n(q);var p=a.getCommands("Default")["GEOMSAnimateCmdHdr"];p.beginExecute();p.execute();p.endExecute()};if(m.args.options.callbacks&&m.args.options.callbacks.ui){m.onDefaultDDActivation=m.args.options.callbacks.ui.DefaultActivationFinished}m.appSingleton=null},onPostCreate:function(){var k=this;var l=this.frmWindow;this.immersiveFrame=l.getImmersiveFrame();var m=this.frmWindow.getViewer();m.setGrid(false)}});return c.namespace("DS/GEOMineSchedExperience/GEOMineSchedExperience",b)});