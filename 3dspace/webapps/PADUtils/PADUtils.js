/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/PADUtils/views/PADDropInvit_disabled",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options"],function(c,d,b){var a=d.extend(b,{name:"pad_invite",active_invite:"",init:function(e){},show:function(e){this.active_invite=e},hide:function(e){this.active_invite=""}});return a});define("DS/PADUtils/PADClipboard",["UWA/Class","UWA/Class/Events","DS/Logger/Logger"],function(c,a,b){var e=b.getLogger("DS/PADUtils/PADClipboard");var g={OBJECT:null,POSITION:null};var f=c.extend(a,{init:function(){this._parent();var i=this;if(document&&document.addEventListener){document.addEventListener("keyup",function(j){if(j.keyCode===27){e.log("Clear the Clipboard");i.clear()}})}},_checkpageAndThrow:function(i){e.debug('Checking if "%s" is a valid page',i);if(!g.hasOwnProperty(i)){e.error("Check failed");throw new Error('"'+i+'" is not a valid page')}},setData:function(j,i){e.info('Setting data in page "%s"',j);e.debug("  Data %o",i);this._checkpageAndThrow(j);this.dispatchEvent("pre_setData",arguments);g[j]=UWA.clone(i);this.dispatchEvent("post_setData",arguments)},getData:function(i){e.info('Getting data in page "%s"',i);this._checkpageAndThrow(i);return UWA.clone(g[i])},consumeData:function(k,j){e.info('Consuming data in page "%s"',k);var i=this.getData(k);if(j){this.clear(k)}return i},clear:function(j){if(j){e.info('Clearing clipboard page "%s"',j);this._checkpageAndThrow(j);this.dispatchEvent("pre_clear",arguments);g[j]=undefined}else{e.info("Clearing clipboard");this.dispatchEvent("pre_clear",arguments);for(var i in g){if(g.hasOwnProperty(i)){g[i]=undefined}}}this.dispatchEvent("post_clear",arguments)},isEmpty:function(j){if(j){this._checkpageAndThrow(j);if(g[j]){return false}}else{for(var i in g){if(g.hasOwnProperty(i)&&g[i]){return false}}}return true}});var d=f.singleton({init:function(){this._parent()},});for(var h in g){if(g.hasOwnProperty(h)){d[h]=h}}return d});define("DS/PADUtils/Configuration",["text!DS/PADUtils/assets/GlobalConfiguration.json","UWA/Core","UWA/Class"],function(b,e,a){var d=JSON.parse(b);var c=a.singleton({notFlagInit:true,initialize:function(f){if(this.notFlagInit){this.notFlagInit=false;if(window.__karma__&&window.__karma__.config.json&&window.__karma__.config.json.Configuration){this.mergeConfig(window.__karma__.config.json.Configuration)}}},getConfig:function(f){this.initialize();return d.settings[f]?d.settings[f].value:false},mergeConfig:function(f){d=e.extend(d,f,true)},getWebAPIOptions:function(f){return d.webapiDefaults[f]?e.clone(d.webapiDefaults[f],true):{}}});return c});define("DS/PADUtils/views/PADTenantMgt",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Class/Events","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Tooltip",],function(b,d,c,j,e,h,f,g,i){var a=e.extend(j,{name:"PadTenantMgt",_command_id:"",init:function(k){var o=this;this._parent(k);if(!k.renderTo){k.renderTo=document.body}var n=UWA.createElement("div",{"class":"padcustomizeview_instruction",content:c.platformChangeMsg});this.modal=new h({className:"padtenantmgt",closable:true,visible:true,header:c.platformChangeTitle,body:n,footer:'<button type="button" class="btn btn-primary">Ok</button> <button type="button" class="btn btn-default">Cancel</button>'}).inject(k.renderTo);var m=this.modal.getContent().getElements(".btn-primary");m[0].addEvent("click",function(){o.options.currentTenant.isClearView=true;o.options.callback(o.options.currentTenant);o.modal.hide();o.modal.destroy()});var l=this.modal.getContent().getElements(".btn-default");l[0].addEvent("click",function(){o.options.currentTenant.isMultiTenant=true;o.options.callback(o.options.currentTenant);o.modal.hide();o.modal.destroy()})}});return a});define("DS/PADUtils/views/PADDropInvit",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options"],function(e,c,d,f,a){var b=f.extend(a,{name:"pad_invite",available_invite:{drop:{fonticon:"down-circled",nls:"drop"},add:{fonticon:"plus-circled",nls:"add"},insert:{fonticon:"plus-circled",nls:"insert"},find:{fonticon:"search",nls:"find"}},active_invite:"drop",init:function(g){this._parent(g);this.elements.container=UWA.createElement("div",{"class":this.getClassNames("_container")});for(var h in this.available_invite){if(this.available_invite.hasOwnProperty(h)){this.elements.container[h]=UWA.createElement("div",{"class":this.getClassNames("_display "+h),draggable:false});UWA.createElement("span",{"class":this.getClassNames("_img fonticon fonticon-3x fonticon-"+this.available_invite[h].fonticon)}).inject(this.elements.container[h]);UWA.createElement("h5",{"class":this.getClassNames("_txt font-3dsregular "+h),text:c["PADDropInvit_"+this.available_invite[h].nls]}).inject(this.elements.container[h]);this.elements.container[h].inject(this.elements.container);if(this.active_invite!==h){this.elements.container[h].hide()}}}if(this.getOption("renderTo")){this.elements.container.inject(this.getOption("renderTo"))}},show:function(g){if(this.active_invite!=g){if(!UWA.is(g,"string")){this.active_invite="drop"}else{if(this.active_invite!==g&&this.active_invite!=""){this.elements.container[this.active_invite].hide()}this.active_invite=g}this.elements.container[this.active_invite].show();this.elements.container.show()}},hide:function(g){if(UWA.is(g,"string")){if(this.active_invite!=""&&this.active_invite===g){this.elements.container[this.active_invite].hide();this.elements.container.hide()}}else{if(this.active_invite!=""){this.elements.container[this.active_invite].hide();this.elements.container.hide()}}this.active_invite=""}});return b});define("DS/PADUtils/views/PADDropTooltip",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events"],function(f,d,e,g,b,a){var c=g.extend(b,a,{name:"paddrop_tooltip",defaultOptions:{tooltips:{add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{nls:"insert",icon:"plus"},find:{icon:"search",nls:"find"}},},_active_tooltip:null,_isDisplayed:false,_fonticon:null,_label:null,init:function(h){this._parent(h);this.elements.container=UWA.createElement("div",{"class":"padutils_dropTooltip wux-afr-contextual-bar"});var i=UWA.createElement("table",{"class":"enopad3Dviewer_dropTooltip_table",}).inject(this.elements.container);var j=i.insertRow(0);this._fonticon=j.insertCell(0);this._label=j.insertCell(1);this._fonticon.appendChild(UWA.createElement("span",{"class":"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-plus"}));this._label.appendChild(UWA.createElement("div",{"class":"wux-afr-label"}))},show:function(j){var k=this.elements.container.getDimensions();var h=k.width;var i=k.height;var l=this.getOption("renderTo");if(!this._isDisplayed&&l){this.elements.container.inject(l);this._isDisplayed=true}if(j.intent!==this._active_tooltip){while(this._fonticon.firstChild){this._fonticon.removeChild(this._fonticon.firstChild)}this._fonticon.appendChild(UWA.createElement("span",{"class":"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-"+this.options.tooltips[j.intent].icon}));this._label.textContent=d["PADDropInvit_"+this.options.tooltips[j.intent].nls];this._active_tooltip=j.intent}if(l.clientWidth<=h+j.x+15){this.elements.container.setStyles({left:l.clientWidth-h})}else{this.elements.container.setStyles({left:j.x+15})}if(l.clientHeight<=i+j.y+25){this.elements.container.setStyles({top:l.clientHeight-i})}else{this.elements.container.setStyles({top:j.y+25+"px"})}},hide:function(){var h=this.getOption("renderTo");if(this._isDisplayed&&h){h.removeChild(this.elements.container);this._isDisplayed=false}}});return c});define("DS/PADUtils/views/PADCustomColorView",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Class/View","UWA/Drivers/Alone","DS/Logger/Logger"],function(g,c,f,e,b,a){var d=e.extend({className:"padcustomcolorview",name:"padcustomcolorview",_logger:null,template:function(){return'              <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell")+'" style="background-color:'+this.model.get("background_color")+';">              <div class="'+this.getClassNames("_check")+' ">'+this.displayContent+"</div>              </div>"},domEvents:{"click .padcustomcolorview_cell":"_onSelect","click .padcustomcolorview_check":"_onSelect"},setup:function(h){var i=h||{};this._parent(i);if(this.model.get("label")==="P_Preview"){this.displayContent=c.PADCustomColorView_content}else{this.displayContent=c.PADCustomColorView_checkmark}this.model.addEvent("onChange:selected",this.render.bind(this));this.model.addEvent("onChange:background_color",this.render.bind(this));this.model.addEvent("onChange:color",this.render.bind(this));if(this.model.get("label")==="BG_Greyscale_8"||this.model.get("label")==="FG_Greyscale_1"){this.model.set("selected",true)}},render:function(){this.container.setHTML(this.template());this.container.setStyle("background-color",this.model.get("background_color"));var h=this.model.get("background_color");if(this.model.get("label")==="P_Preview"){this.container.setStyle("cursor","default")}if(this.model.get("selected")===true||this.model.get("label")==="P_Preview"){h=this.model.get("color")}this.container.setStyle("color",h);this.elements.padcustomcolorview=this.container;return this},toggleSelected:function(){if(this.model.get("selected")===true){this.model.set("selected",false);this.elements.padcustomcolorview.setStyle("color",this.model.get("background_color"))}else{this.model.set("selected",true);this.elements.padcustomcolorview.setStyle("color",this.model.get("color"))}},isSelected:function(){return this.model.get("selected")},_onSelect:function(){this.toggleSelected();this.dispatchEvent("select",this.model.get("label"))}});return d});define("DS/PADUtils/views/PADShell",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/Core/Core","UWA/Class/Events"],function(c,a,i,f,j,h,l){var g,e,d,k;var b=f.extend(j,l,{name:"padshell",rightPanel:false,init:function(m){this._parent(m);if(!this.getOption("content")){throw new Error(("No main view defined"))}this.elements.container=UWA.createElement("div",{"class":this.getClassNames()});this.elements.left=UWA.createElement("div",{"class":this.getClassNames("_left")}).inject(this.elements.container);if(this.options.resizable&&this.options.resizable.left===true){var o=UWA.createElement("div",{"class":this.getClassNames("_resizer")}).inject(this.elements.left);o.addEventListener("mousedown",this._initResizeLeft.bind(this),false);o.addEventListener("touchstart",this._initResizeLeft.bind(this),false)}this.elements.main=UWA.createElement("div",{"class":this.getClassNames("_main")}).inject(this.elements.container);this.getOption("content").inject(this.elements.main);this.elements.right=UWA.createElement("div",{"class":this.getClassNames("_right")}).inject(this.elements.container);if(this.options.resizable&&this.options.resizable.right===true){var n=UWA.createElement("div",{"class":this.getClassNames("_resizer")}).inject(this.elements.right);n.addEventListener("mousedown",this._initResizeRight.bind(this),false);n.addEventListener("touchstart",this._initResizeRight.bind(this),false)}},isLeftPanelSet:function(){return this.leftPanel},getleftPanelContainer:function(){this.leftPanel=true;return this.elements.left},isRightPanelSet:function(){return this.rightPanel},getRightPanelContainer:function(){this.rightPanel=true;return this.elements.right},togglePanel:function(m){if(m==="left"){this.elements.left.toggleClassName("left_open");this.elements.left.style.width="";this.elements.main.toggleClassName("left_open");this.elements.main.style.left=""}else{this.elements.right.toggleClassName("right_open");this.elements.right.style.width="";this.elements.main.toggleClassName("right_open");this.elements.main.style.right=""}this.dispatchEvent("togglePnl")},_initResizeLeft:function(o){var m=this;m.elements.container.style.animationDuration="0s";m.elements.container.style.transitionDuration="0s";m.elements.main.style.animationDuration="0s";m.elements.main.style.transitionDuration="0s";m.elements.left.style.animationDuration="0s";m.elements.left.style.transitionDuration="0s";function n(t){var s=t.clientX;if(t.type==="touchmove"){s=t.touches[0].pageX}var r=m.elements.container.getDimensions().width*0.4;var q=(d+s-g);var u;if(q>r){u=r+"px"}else{u=q<295?"295px":q+"px"}m.elements.left.style.width=u;m.elements.main.style.left=m.elements.left.style.width}function p(q){m.elements.container.style.animationDuration="0.6s";m.elements.container.style.transitionDuration="0.6s";m.elements.main.style.animationDuration="0.6s";m.elements.main.style.transitionDuration="0.6s";m.elements.left.style.animationDuration="0.6s";m.elements.left.style.transitionDuration="0.6s";if(q.type==="touchend"){document.documentElement.removeEventListener("touchmove",n,false);document.documentElement.removeEventListener("touchend",p,false)}else{if(q.type==="mouseup"){document.documentElement.removeEventListener("mousemove",n,false);document.documentElement.removeEventListener("mouseup",p,false)}}}if(o.type==="touchstart"){g=o.touches[0].pageX;d=parseInt(document.defaultView.getComputedStyle(this.elements.left).width,10);document.documentElement.addEventListener("touchmove",n,false);document.documentElement.addEventListener("touchend",p,false)}else{if(o.type==="mousedown"){g=o.clientX;d=parseInt(document.defaultView.getComputedStyle(this.elements.left).width,10);document.documentElement.addEventListener("mousemove",n,false);document.documentElement.addEventListener("mouseup",p,false)}}},_initResizeRight:function(p){var o=this;o.elements.container.style.animationDuration="0s";o.elements.container.style.transitionDuration="0s";o.elements.main.style.animationDuration="0s";o.elements.main.style.transitionDuration="0s";o.elements.right.style.animationDuration="0s";o.elements.right.style.transitionDuration="0s";function n(t){var s=t.clientX;if(t.type==="touchmove"){s=t.touches[0].pageX}var r=o.elements.container.getDimensions().width*0.4;var q=(d+(g-s));var u;if(q>r){u=r+"px"}else{u=q+"px";if(o.options.resizable.right_min){u=(q<o.options.resizable.right_min?o.options.resizable.right_min:q)+"px"}}o.elements.right.style.width=u;o.elements.main.style.right=o.elements.right.style.width}function m(q){o.elements.container.style.animationDuration="0.6s";o.elements.container.style.transitionDuration="0.6s";o.elements.main.style.animationDuration="0.6s";o.elements.main.style.transitionDuration="0.6s";o.elements.right.style.animationDuration="0.6s";o.elements.right.style.transitionDuration="0.6s";if(q.type==="touchend"){document.documentElement.removeEventListener("touchmove",n,false);document.documentElement.removeEventListener("touchend",m,false)}else{if(q.type==="mouseup"){document.documentElement.removeEventListener("mousemove",n,false);document.documentElement.removeEventListener("mouseup",m,false)}}}if(p.type==="touchstart"){g=p.touches[0].pageX;d=parseInt(document.defaultView.getComputedStyle(this.elements.right).width,10);document.documentElement.addEventListener("touchmove",n,false);document.documentElement.addEventListener("touchend",m,false)}else{if(p.type==="mousedown"){g=p.clientX;d=parseInt(document.defaultView.getComputedStyle(this.elements.right).width,10);document.documentElement.addEventListener("mousemove",n,false);document.documentElement.addEventListener("mouseup",m,false)}}}});return b});define("DS/PADUtils/views/PADProgressBar",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/Controls/Loader","DS/Controls/Button"],function(g,d,f,h,b,c,a){var e=h.singleton(b,{name:"pad_progressBar",_UILoader:null,_counter:0,_offTimeout:null,_onTimeout:null,_isCustomTextDisplayed:false,_defaultText:"",_customText:"",_buttonCB:null,init:function(i){this._parent(i);this._defaultText=d.PADProgressBar_loading;this.elements.container=UWA.createElement("div",{"class":"topBarContainer"});this.render(i);this.elements.viewContainer=UWA.createElement("div",{"class":"progressBarContainer"}).inject(this.elements.container);this._UILoader=new c({fadeDuration:0,showButtonFlag:false}).inject(this.elements.viewContainer);this._button=new a({label:d.PADProgressBar_cancel,emphasize:"primary"}).inject(this._UILoader.elements.container);var j=this;this._button.elements.container.addClassName("PADProgressBar_cancelButton");this._button.addEventListener("buttonclick",function(k){if(j._buttonCB){j._buttonCB()}});j.elements.container.hide()},render:function(i){var j=i&&i.renderTo?i.renderTo:document.body;this.elements.container.inject(j)},destroy:function(){if(this._UILoader){this._UILoader.destroy();delete this._UILoader}this._counter=0;this._offTimeout=null;this._isCustomTextDisplayed=false;this._text="";this._customText="";if(this._2sTimeout){clearTimeout(this._2sTimeout);this._2sTimeout=null}if(this._10sTimeout){clearTimeout(this._10sTimeout);this._10sTimeout=null}this._parent()},on:function(i,j,l){var k=this;k.elements.container.show();if(j){this._buttonCB=j;this._button.label=l!==undefined?l:d.PADProgressBar_cancel;this._button.show()}else{this._button.hide()}if(i){this._defaultText=i}else{this._defaultText=d.PADProgressBar_loading}this._customText=this._defaultText;if(this._isCustomTextDisplayed){this._UILoader.text=this._text}else{this._UILoader.text=this._defaultText}this._counter++;if(this._offTimeout){clearTimeout(this._offTimeout)}if(!this._2sTimeout){this._2sTimeout=setTimeout(function(){k.elements.viewContainer.addClassName("progressBarShown");if(!k._10sTimeout){k._10sTimeout=setTimeout(function(){k._isCustomTextDisplayed=true;k._UILoader.text=k._customText},8000)}},2000)}k._UILoader.on()},off:function(){var i=this;this._counter--;if(this._counter===0){i._offTimeout=setTimeout(function(){if(i._2sTimeout){clearTimeout(i._2sTimeout)}if(i._10sTimeout){clearTimeout(i._10sTimeout)}i.elements.viewContainer.removeClassName("progressBarShown");i._offTimeout=null;i._isCustomTextDisplayed=false;i._2sTimeout=null;i._10sTimeout=null;i._customText="";i._buttonCB=null;setTimeout(function(){if(i._counter===0){i.elements.container.hide();i._UILoader.off()}},1000)})}},update:function(i){if(this._UILoader){this._UILoader.update(i)}},setText:function(i){if(this._UILoader&&i){this._customText=i;if(this._isCustomTextDisplayed){this._UILoader.text=this._customText}}}});return e});define("DS/PADUtils/views/parametrization/Iconbar",["UWA/Core","UWA/Event","UWA/Utils","UWA/Controls/Abstract","DS/UIKIT/Menu","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu"],function(e,m,h,f,g,j,a){var d=e.Utils.Client.Features.touchEvents;function l(o,q,n){var p;return function(){var u=this,t=arguments,s,r=function(){p=null;if(!n){o.apply(u,t)}};s=n&&!p;clearTimeout(p);p=setTimeout(r,q);if(s){o.apply(u,t)}}}var k=(function(){var n=/^(divider)$/;return function(p){var q,o;if(!p){return false}q=p.split(" ");for(o=0;o<q.length;o++){if(n.test(q[o])){return true}}return false}}());var c=g.extend({name:"iconbar-items",templateClassname:"iconbar-template"});var i=a.extend({show:function(){document.body.style.overflow="hidden";this._parent();document.body.style.overflow="auto"}});var b=f.extend({name:"iconbar",menu:null,overflowMenu:null,overflowMenuTrigger:null,init:function(n){var o=this;this._parent(n);this.buildSkeleton();this.handleEvents();this.show();if(window.MutationObserver){this._injectionObserver=new MutationObserver(function(p){var q=p.some(function(r){return o.isInjected()||Array.prototype.indexOf.call(r.addedNodes,o.elements.container)!==-1});q&&o.show()});this._injectionObserver.observe(document.body,{childList:true,subtree:true})}},buildSkeleton:function(){var o=this.elements,n=this.options;if(o.container){return}this.menu=new c({multiSelect:n.multiSelect});this.addItem(n.items);o.container=this.menu.elements.container;o.container.className=this.getClassNames();if(n.renderTo&&n.renderTo.nodeType===1){o.container.inject(n.renderTo);delete n.renderTo}},buildOverflowMenu:function(){var o=[],p,n;if(!this.overflowMenuTrigger){this.overflowMenuTrigger=e.createElement("li",{"class":this.name+"-overflow-menu-trigger item",html:{tag:"span","class":"fonticon fonticon-menu-dot"}})}this.overflowMenu&&this.overflowMenu.destroy();this.overflowMenu=null;this.menu.items.forEach(function(q){if(q.content&&q.content.type==="dropdown"){return}n=true;p={className:(q.id+" "+(q.className?q.className:"")).trim(),fonticon:q.fonticon,text:q.text,name:q.name,handler:q.handler,selectable:q.selectable,selected:q.selected,disabled:q.disabled};if(q.content&&q.content.options.items&&q.content.type!=="icondropdown"){p.items=q.content.options.items.map(function(r){r.className=(q.id+" "+(r.className?r.className:"")).trim();r.selectable=true;return r})}else{if(q.content&&q.content.type==="icondropdown"){n=false;q.content.options.items&&q.content.options.items.forEach(function(r){o.push({className:(q.id+" "+(r.className?r.className:"")).trim(),fonticon:r.fonticon,icon:r.icon,handler:r.handler,text:r.description})})}}n&&o.push(p)});this.overflowMenu=new i({multiSelect:this.options.multiSelect,items:o,target:this.overflowMenuTrigger,events:this.options.events})},getItem:function(r){var p,n,o,q=false;for(p=0,n=this.menu.items.length;p<n;p++){q=this.menu.items[p];if(r&&r.nodeType){o=r.hasClassName("item")?r:r.getParent();if(q.id===o.id){break}}else{if(p===r||q.id===r||q.name===r){break}}q=false}return q},handleEvents:function(){this.events={container:{click:function(n){var p=m.getElement(n),o=this.getItem(p);if(o.selectable){this.select(o.name,!o.selected)}if(o){if(o.content){window.requestAnimationFrame?window.requestAnimationFrame(this.displayContent.bind(this,o)):this.displayContent(o)}if(o.tooltip&&o.tooltip.isVisible&&!d){o.tooltip.hide()}this.dispatchEvent("onClick",[n,o],this);if(typeof o.handler==="function"){o.handler.call(this,n,o)}}}.bind(this)}};this.elements.container.addEvents(this.events.container);this.events.window={resize:l(this.resize,100).bind(this)};window.addEventListener("resize",this.events.window.resize)},addItem:function(n){h.splat(n).forEach(function(o){this._addItem(o)},this);this.buildOverflowMenu();return this},_addItem:function(n){var o=this.menu._addItem(n);o.content=o.innerComponent||o.content;if(!k(n.className)&&o.text){o.tooltip=new j({target:o.elements.container,body:o.text,trigger:o.tooltipTrigger||this.options.tooltipsTrigger||"hover focus"});o.elements.container.getElement(".item-text").remove()}},isOverflowing:function(){return this.menu.items.some(function(n){return !n.elements.container.isInViewport(this.elements.container,true,true)}.bind(this))},isInjected:function(){if(!this.elements){return}if(!this.elements.container){return}return this.elements.container.isInjected()},resize:(function(){function o(){var p=this.elements.container.getBoundingClientRect();return this.menu.items.filter(function(r){var q=r.elements.container.getBoundingClientRect();return(q.top+q.height>p.bottom)||(q.left+q.width>p.right)},this)}function n(p){var q;this.overflowMenu.items.forEach(function(r){q=p.some(function(s){if(!r.className){return false}return r.className&&r.className.indexOf(s)!==-1});q?r.elements.container.removeClassName("hidden"):r.elements.container.addClassName("hidden")})}return function(){var p,q;this.overflowMenuTrigger&&this.overflowMenuTrigger.isInjected()&&this.overflowMenuTrigger.remove();if(this.overflowMenu.isVisible){this.overflowMenu.hide()}if(this.elements.container&&!this.isOverflowing()){return}p=o.call(this);q=p.map(function(r){return r.id});n.call(this,q);if(p.length){this.menu.elements.wrapper.insertBefore(this.overflowMenuTrigger,p[0].elements.container);while(!this.overflowMenuTrigger.isInViewport(this.elements.container,true,true)&&this.overflowMenuTrigger.previousSibling){this.menu.elements.wrapper.insertBefore(this.overflowMenuTrigger,this.overflowMenuTrigger.previousSibling);p.push(this.overflowMenuTrigger.nextSibling);this.overflowMenuTrigger.nextSibling.id&&q.push(this.overflowMenuTrigger.nextSibling.id);n.call(this,q)}}}}()),displayContent:function(o){var n=e.clone(o.content.options);n.target=o.elements.container;if(!o.content.created){if(o.content.type==="dropdown"){require(["DS/UIKIT/Dropdown"],function(p){o.content.component=new p(n).show()})}else{if(o.content.type==="icondropdown"){require(["DS/UIKIT/IconDropdown"],function(p){o.content.component=new p(n).show()})}else{if(o.content.type==="dropdownmenu"){o.content.component=new a(n).show()}else{return}}}o.content.created=true}else{o.content.component&&o.content.component.show()}},select:function(){var n=arguments,q,p,r,o;if(n[0]===undefined||n[0]===null){return}p=(n[1]===undefined)?true:n[1];if(this.options.multiSelect!==true){p&&this.elements.container.querySelectorAll(".selected").forEach(function(s){s.removeClassName&&s.removeClassName("selected")});p&&this.overflowMenu.getSelectedItems().forEach(function(s){this.overflowMenu.menus[0].toggleSelection(s);s.elements.container.removeClassName("selectable")},this)}q=this.getItem(n[0]);q.selected=p;if(!q||q.elements.container.hasClassName("divider")){return}q.elements.container[p?"addClassName":"removeClassName"]("selected");r=q.elements.container.id;o=this.overflowMenu.items.filter(function(s){return s.elements.container.hasClassName(r)});if(o.length===1){this.overflowMenu.menus[0].toggleSelection(o[0]);o[0].elements.container.addClassName("selectable");o[0].selected=p}},enableItem:function(n){this.menu.enableItem(n)},disableItem:function(n){this.menu.disableItem(n)},show:function(){if(!this.isInjected()){return}this._injectionObserver&&this._injectionObserver.disconnect();this._injectionObserver=null;this._parent();if(window.requestAnimationFrame){window.requestAnimationFrame(this.resize.bind(this))}else{this.resize()}},destroy:function(){window.removeEventListener("resize",this.events.window.resize);this.overflowMenu&&this.overflowMenu.destroy();this.overflowMenuTrigger&&this.overflowMenuTrigger.destroy();this.elements.container.removeEvents(this.events.container);this.menu.items.forEach(function(n){n.tooltip&&n.tooltip.destroy()});this._parent()}});return b});define("DS/PADUtils/views/parametrization/ComboSelector",["i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/Menu/ContextualMenu","DS/Menu/Menu"],function(c,g,f,b,d,e){var a=f.extend(b,{defaultOptions:{treedocument:null,withMore:false,disabled:false,title:null,multisel:true},init:function(h){this._parent(h);var i=this;this.elements.container=g.createElement("div",{"class":"padComboSelector "+(h.className?h.className:"")});this.elements.inner=g.createElement("div",{"class":"padComboSelector-inner"}).inject(this.elements.container);this.elements.text=g.createElement("div",{"class":"padComboSelector-text"}).inject(this.elements.inner);if(this.options.title){g.createElement("p",{text:this.options.title,title:this.options.title}).inject(this.elements.text)}this.elements.expander=g.createElement("span",{"class":"padComboSelector-expander wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down"}).inject(this.elements.inner);this.elements.container.addEventListener("click",i._launchCtxMenu.bind(i));this.elements.container.addEventListener("contextmenu",i._launchCtxMenu.bind(i));if(this.options.treedocument===null){throw new Error("Invalid attribute in constructor. Missing treedocument")}this.options.treedocument.getXSO().onPostAdd(this._redrawInnerText.bind(this));this.options.treedocument.getXSO().onPostRemove(this._redrawInnerText.bind(this));this.disabled(this.options.disabled);this._redrawInnerText()},disabled:function(h){if(h){this.elements.container.setAttribute("disabled","");this.options.disabled=h}else{this.elements.container.removeAttribute("disabled","");this.options.disabled=h}},_launchCtxMenu:function(n){var o=[],m=this;if(this.options.disabled===false){var j=this.options.treedocument.getRoots();for(var h=0;h<j.length;h++){var k=j[h].options.icons&&j[h].options.icons.length&&j[h].options.icons[0].iconName?{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+j[h].options.icons[0].iconName,}:undefined;o.push({title:j[h].getLabel(),type:"CheckItem",state:j[h].isSelected()?"selected":undefined,fonticon:k,action:{"this":this,context:j[h],callback:this._typeSelectedInMenu.bind(this)}})}if(this.options.withMore){o.push({type:"SeparatorItem"});o.push({title:c.more,type:"PushItem",action:{"this":this,callback:function(i){m.dispatchEvent("onMore")}}})}if(o.length){var l=this.elements.container.getBoundingClientRect();e.show(o,{position:{x:l.left,y:l.bottom}})}}},_typeSelectedInMenu:function(i){var h=i.context;if(this.options.multisel===true){if(h.isSelected()){h.unselect();this.dispatchEvent("onUnselect",h)}else{h.select();this.dispatchEvent("onSelect",h)}}else{h.select(true);this.dispatchEvent("onSelect",h)}this.dispatchEvent("onSelectionChange");this._redrawInnerText()},_redrawInnerText:function(){if(!(g.is(this.options.title,"string")&&this.options.title.length>0)){this.elements.text.empty();var l="",h=[];var m=this.options.treedocument.getSelectedNodes();for(var j=0;j<m.length;j++){h.push(m[j].getLabel())}if(h.length){l=h.join(", ")}else{l=this.options.nlsEmptySelection}if(this.options.multisel===false&&m.length===1&&m[0].options.icons){var k=g.createElement("div",{"class":"iconMenu wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+m[0].options.icons[0].iconName}).inject(this.elements.text);if(m[0].options.subLabel){this.elements.text.title=m[0].options.subLabel}}g.createElement("p",{text:l}).inject(this.elements.text)}}});return a});define("DS/PADUtils/views/PADSplash",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils"],function(e,b,d,f,c){var a=f.extend({init:function(g){this._parent(g);this._buildSkeleton()},render:function(){return this.elements.container},_buildSkeleton:function(){this.elements.container=UWA.createElement("div",{"class":"PADSplashContainer"});this.elements.image=UWA.createElement("div",{"class":"PADSplashImage",html:'<img src="'+c.getWebappsAssetUrl("PADUtils","icons/32/I_Compass.png")+'" alt="Compass">',}).inject(this.elements.container);this.elements.text=UWA.createElement("span",{"class":"PADSplashText",html:b.appNotAvailable}).inject(this.elements.container)}});return UWA.namespace("DS/PADUtils/commands/PADSplash",a)});define("DS/PADUtils/views/PADThumbnail",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Modal"],function(h,g,d,b,e,c,a){var f=d.extend(b,{name:"padthumbnail",_logger:null,_modal:null,options:{},init:function(i){this._logger=c.getLogger(f);this._logger.log("init");this._parent(i);this.setOptions(i);if(!i.renderTo){i.renderTo=document.body}var k=UWA.createElement("div",{"class":this.name+"_main",styles:{"background-image":i.cellModel.options.value,}});var j=this;this._modal=new a({className:this.name+"_modal",closable:false,body:k,visible:true});setTimeout(function(){j._modal.elements.container.addEventListener("click",function(l){j._modal.destroy()});j._modal.elements.content.addEventListener("click",function(l){l.preventDefault();l.stopPropagation();return false});document.onkeydown=function(l){l=l||window.event;if(l.keyCode===27){j._modal.destroy()}}},500);this._modal.elements.wrapper.setStyle("width","350px");this._modal.inject(i.renderTo)}});return f});define("DS/PADUtils/PADCommandProxy",["text!DS/PADUtils/assets/PADCommandProxyResources.json","UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(f,i,b,k,c){var j={},d=JSON.parse(f);for(var l in d){if(d.hasOwnProperty(l)){var o=p(l);d[l].callback=o;j[o]=l}}function h(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}function q(){var r="/no_private_channel";if(typeof widget!=="undefined"&&widget!==null){if(widget.getValue("x3dSharedId")!==undefined){r="/"+widget.getValue("x3dSharedId")}else{if(widget.getValue("x3dAppId")!==undefined){r="/"+widget.getValue("x3dAppId")}else{if(widget.getValue("appId")!==undefined){r="/"+widget.getValue("appId")+"_"+widget.id}}}}return r}function n(r,t,s){return{metadata:{uid:h(),originUid:r,timestamp:Date.now(),appid:q(),originWidgetId:typeof s!=="undefined"?s:typeof widget!=="undefined"&&widget!==null?widget.id:r},data:t}}function p(r){return"on"+r.charAt(0).toUpperCase()+r.slice(1)}function e(s){var r="DS/PADUtils/PADCommandProxy/"+s;if(UWA.is(d[s])&&d[s]["private"]===true){r=r+q()}return r}var m=b.extend({init:function(s,t,r){this.ownerProxyUid=s;this.eventHandlingFunction=t;this.ignoreMyEvents=r},handleEvent:function(s){var r=Date.now();if(i.debug){c.debug("Event received at %d, %dms after event creation",r,r-s.metadata.timestamp);c.debug("    %o",s.metadata)}if((this.ignoreMyEvents===true&&s.metadata.originUid===this.ownerProxyUid)||(s.metadata.ignoreFromSameWidgetId===true&&s.metadata.originWidgetId===typeof widget!=="undefined"&&widget!==null?widget.id:"")){if(i.debug){c.debug("Ignoring this event (sent by me)")}}else{try{this.eventHandlingFunction(s.data,s.metadata)}catch(t){c.error("Error while handling event %o",s);c.error(t)}}}});var g=b.extend({init:function(r){this.uid=h();this.subscriptions=[];if(i.debug){c.debug("Creating proxy %s",this.uid)}this.addProxyEvents(r)},addProxyEvents:function(z){if(z){for(var w in z){var u=j[w];if(u){var t=z[w];if(typeof t==="function"||(Array.isArray(t)&&t.length>0&&typeof t[0]==="function")){var s;var x=true;if(typeof t==="function"){s=t}else{s=t[0];x=(t.length<2||t[1]!==false)}var r=new m(this.uid,s,x);var v=e(u);if(i.debug){c.debug("Subscribing to topic [%s]",v)}var y=k.subscribe(v,r.handleEvent.bind(r));this.subscriptions.push(y)}else{c.warn("Input [events.%s] is not a function",w)}}else{c.info("Input [events.%s] is not a known event",w)}}}},destroy:function(){if(i.debug){c.debug("Destroying proxy [%s]",this.uid)}if(this.subscriptions){if(i.debug){c.debug("Unsubcribing")}this.subscriptions.forEach(function(r){k.unsubscribe(r)});delete this.subscriptions}this.destroyed=true}});g.prototype._publish=function(s,u){if(this.destroyed===true){throw new Error("This proxy has been destroyed")}var r=e(s);var t=n(this.uid,u,this.odtWidgetId);if(i.debug){c.debug("Publishing to topic [%s]",r);c.debug("\t%o",t)}k.publish(r,t)};for(var a in d){if(d.hasOwnProperty(a)){g.prototype[a]=(function(r){return function(s){this._publish(r,s)}}(a))}}g.create=function(r){var s;if(r){s=r.events}return new g(s)};g.appId=function(){return q()};return g});define("DS/PADUtils/views/PADColorView",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Class/View","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger"],function(h,e,g,f,a,c,b){var d=f.extend(a,{className:"padcolorview",name:"padcolorview",_logger:null,template:function(){var i="";if(this.selected_color.color===this.model.get("color")&&this.selected_color.background_color===this.model.get("background_color")){i=this.getClassNames("_cell_selected")}if(!this.model.get("custom")){return'                <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell")+i+'" style="background-color:'+this.model.get("background_color")+';">                <div class="'+this.getClassNames("_content")+' font-3dsregular" style="color:'+this.model.get("color")+';">'+e.PADColorView_content+"</div>                </div>"}else{return'                <div data-label="'+this.model.get("label")+'" class="'+this.getClassNames("_cell","_custom_cell")+i+'" style="background-color:'+this.model.get("background_color")+';">                <div class="'+this.getClassNames("_content","_custom_content")+' font-3dsregular" style="color:'+this.model.get("color")+';">'+e.PADColorView_content+"</div>                </div>"}},domEvents:{"click .padcolorview_cell":"_onSelect","click .padcolorview_content":"_onSelect"},setup:function(i){var j=i||{};this._parent(j);this.displayContent=e.PADColorView_content;if(j.selected_color){this.selected_color=j.selected_color}else{this.selected_color={background_color:"#ffffff",color:"#000000"}}this.model.addEvent("onChange:selected",this.render.bind(this))},render:function(){this.container.setHTML(this.template());if(this.model.get("empty")){this.container.getElement("div.padcolorview_cell").setStyle("border-color","#ffffff");this.container.getElement("div.padcolorview_cell").addClassName("padcolorview_empty_cell")}else{this.container.getElement("div.padcolorview_cell").addClassName("padcolorview_active_cell")}this.elements.padcolorview_cell=this.container.getElement("div.padcolorview_cell");return this},toggleSelected:function(){if(this.model.get("selected")===true){this.model.set("selected",false)}else{this.model.set("selected",true)}},isSelected:function(){return this.model.get("selected")},_onSelect:function(){this.model.set("empty",false);this.selected_color.color=this.model._attributes.color;this.selected_color.background_color=this.model._attributes.background_color;this.toggleSelected();this.dispatchEvent("select",this.model.get("label"))}});return d});define("DS/PADUtils/views/PADAlert",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(b,c){var a={_notif_manager:null,displayNotification:function(d){if(this._notif_manager===null){this._notif_manager=b;c.setNotificationManager(this._notif_manager);c.setStackingPolicy(5)}var e="info";if(UWA.is(d.eventID)&&d.eventID!=="primary"){e=d.eventID}this._notif_manager.addNotif({level:e,message:d.msg,sticky:false})}};return a});define("DS/PADUtils/views/PADInstanceMatrix",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/UIKIT/Modal","DS/Handlebars/Handlebars"],function(c,d,a,i,f,g,b){var e='<div class="positionMatrix">                            <table class="matrix rotation">                                <tr>                                  <td title="{{x1}}">{{x1}}</td>                                  <td title="{{x2}}">{{x2}}</td>                                  <td title="{{x3}}">{{x3}}</td>                                </tr>                                <tr>                                  <td title="{{y1}}">{{y1}}</td>                                  <td title="{{y2}}">{{y2}}</td>                                  <td title="{{y3}}">{{y3}}</td>                                </tr>                                <tr>                                  <td title="{{z1}}">{{z1}}</td>                                  <td title="{{z2}}">{{z2}}</td>                                  <td title="{{z3}}">{{z3}}</td>                                </tr>                            </table>                            <table class="matrix translation">                                <tr>                                  <td title="{{t1}}">{{t1}}</td>                                </tr>                                <tr>                                  <td title="{{t2}}">{{t2}}</td>                                </tr>                                <tr>                                  <td title="{{t3}}">{{t3}}</td>                                </tr>                          </table>                    </div>';var j=b.compile(e);var h=a.extend(i,{name:"padinstancematrix",_modal:null,options:{},init:function(l){this._parent(l);this.setOptions(l);if(!l.renderTo){l.renderTo=document.body}var k=l.cellModel.options.value.split(",");var m={x1:Number(k[0]).toFixed(16),x2:Number(k[1]).toFixed(16),x3:Number(k[2]).toFixed(16),y1:Number(k[3]).toFixed(16),y2:Number(k[4]).toFixed(16),y3:Number(k[5]).toFixed(16),z1:Number(k[6]).toFixed(16),z2:Number(k[7]).toFixed(16),z3:Number(k[8]).toFixed(16),t1:Number(k[9]).toFixed(16),t2:Number(k[10]).toFixed(16),t3:Number(k[11]).toFixed(16)};var r=j(m);var o=this;this._modal=new g({className:this.name+"_modal",closable:false,body:r,visible:true});if(l.position&&l.position.top&&l.position.right&&l.position.left&&l.position.bottom){var q=document.body.getBoundingClientRect();var p=q.right-l.position.right;var n=q.bottom-l.position.bottom;if(n>=100&&p>=350){l.position.left=l.position.left+"px";l.position.top=l.position.top+30+"px";this._modal.elements.wrapper.setStyle("top",l.position.top);this._modal.elements.wrapper.setStyle("left",l.position.left)}else{if(n>=100&&p<=350){l.position.right=(p+380)-q.right+"px";l.position.top=l.position.top+30+"px";this._modal.elements.wrapper.setStyle("top",l.position.top);this._modal.elements.wrapper.setStyle("right",l.position.right)}else{if(n<=100&&p<=350){l.position.right=(p+380)-q.right+"px";l.position.bottom=(n+160)-q.bottom+"px";this._modal.elements.wrapper.setStyle("bottom",l.position.bottom);this._modal.elements.wrapper.setStyle("right",l.position.right)}else{l.position.left=l.position.left+20+"px";l.position.bottom=(n+160)-q.bottom+"px";this._modal.elements.wrapper.setStyle("bottom",l.position.bottom);this._modal.elements.wrapper.setStyle("left",l.position.left)}}}}setTimeout(function(){o._modal.elements.container.addEventListener("click",function(s){o._modal.destroy()});o._modal.elements.content.addEventListener("click",function(s){s.preventDefault();s.stopPropagation();return false});document.onkeydown=function(s){s=s||window.event;if(s.keyCode===27){o._modal.destroy()}}},500);this._modal.elements.wrapper.setStyle("width","356px");this._modal.inject(l.renderTo)}});return h});define("DS/PADUtils/PADPromise",["UWA/Promise"],function(c){var b=[];var a={getPromises:function(){var e=[];for(var d=0;d<b.length;d++){if(!b[d].isFulfilled||!b[d].isFulfilled()){e.push(b[d])}}b=e;return b},createPromise:function(f,e,h){var g=new c(f);var d=this._makeIntrospectablePromise(g,e);if(h===undefined||h===true){this.getPromises().push(d)}return d},empty:function(){b=[]},_makeIntrospectablePromise:function(i,g){if(i.isResolved){return i}var e=true;var h=false;var f=false;var d=i.then(function(j){f=true;e=false;return j},function(j){h=true;e=false;throw j});d.isFulfilled=function(){return f};d.isPending=function(){return e};d.isRejected=function(){return h};d.name=g;return d}};return a});define("DS/PADUtils/views/parametrization/SearchSelector",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","UWA/Event","DS/Controls/ButtonGroup","DS/Controls/Button"],function(c,b,f,e,i,h,a,g){var d=e.extend(i,{init:function(m){this._parent(m);var o=this;this.elements.container=UWA.createElement("div",{"class":"padSearchSelector "+(m.className?m.className:"")});this.elements.inner=UWA.createElement("div",{"class":"padSearchSelector-inner"}).inject(this.elements.container);var q=UWA.createElement("div",{"class":"padSearchSelector-divInput"}).inject(this.elements.inner);this.elements.input=UWA.createElement("input",{"class":"padSearchSelector-inputSearch",type:"text",placeholder:this.options.placeholder?this.options.placeholder:b.PADSearchView_search}).inject(q);var k=UWA.createElement("div",{"class":"padSearchSelector-rightSearch"}).inject(this.elements.inner);var j=UWA.createElement("div",{"class":"padSearchSelector-btn padSearchSelector-clear"}).inject(k);this.elements.clearBtn=UWA.createElement("div",{"class":"padSearchSelector-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clear",title:b.PADSearchView_clear}).inject(j);this.elements.clearBtn.hide();var n=UWA.createElement("div",{"class":"padSearchSelector-btn padSearchSelector-search"}).inject(k);this.elements.searchBtn=UWA.createElement("div",{"class":"padSearchSelector-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search",title:b.PADSearchView_search}).inject(n);this.elements.searchBtn.setStyle("opacity","0.1");if(this.options.withNavigation===true){var p=UWA.createElement("div",{"class":"padSearchSelector-navigation"}).inject(this.elements.container);var l=new a({touchMode:true});l.inject(p);this.elements.upBtn=new g({icon:{iconName:"open-up",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"previous",disabled:true,preferredHeight:30,preferredWidth:24,touchMode:true});l.addChild(this.elements.upBtn);this.elements.downBtn=new g({icon:{iconName:"open-down",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"next",disabled:true,preferredHeight:30,preferredWidth:24,touchMode:true});l.addChild(this.elements.downBtn);l.addEventListener("buttonclick",function(r){if(r.dsModel.value==="next"){o.dispatchEvent("onNext",r.dsModel.value)}else{o.dispatchEvent("onPrevious",r.dsModel.value)}})}this.elements.searchBtn.addEventListener("click",this._onSearch.bind(this));this.elements.clearBtn.addEventListener("click",this._onClearSearch.bind(this));this.elements.input.addEventListener("keyup",this._onSearchInputKeyUp.bind(this));this.elements.input.addEventListener("paste",this._onSearchInputPaste.bind(this));this.elements.input.addEventListener("keydown",this._onSearchInputKeyDown.bind(this))},navigationState:function(j,k){this.elements.upBtn.disabled=j;this.elements.downBtn.disabled=k},_onSearch:function(k){var j=this;this.elements.input.blur();this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onClearSearch:function(k){var j=this;this.elements.input.value="";this.elements.clearBtn.hide();this.elements.searchBtn.setStyle("opacity","0.1");this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onSearchInputKeyUp:function(j){var k=this;if(this.elements.input.value){this.elements.searchBtn.setStyle("opacity","1");this.elements.clearBtn.setStyle("display","inline-block");this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})}else{this.elements.clearBtn.hide();this.elements.searchBtn.setStyle("opacity","0.1");this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})}},_onSearchInputPaste:function(j){var k=this;setTimeout((function(){k._onSearchInputKeyUp()}).bind(this),200)},_onSearchInputKeyDown:function(j){var k=this;if(h.whichKey(j)==="return"||j.keyIdentifier==="Enter"||j.keyIdentifier==="return"){this._onSearch()}h.stopPropagation(j)},});return d});define("DS/PADUtils/PADContext",["UWA/Class","UWA/Class/Options"],function(b,a){var c=b.singleton(a,{name:"PADContext",init:function(){this._context=null},set:function(d){if(this._context===null){this._context=d}},get:function(d){if(this._context===null){return(d===undefined)?null:d}else{return this._context}},reset:function(){this._context=null}});return c});define("DS/PADUtils/views/PADDropConfirm",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/Utilities/Utils"],function(b,e,c,d,f,j,a,g,h){var i=f.extend(j,{name:"dropConfirm",defaultOptions:{},init:function(l){var o={MOVE:c.MOVE_label,COPY:c.COPY_label,Reorder:c.Reorder_label};var k={top:c.before_label,bottom:c.after_label};var q=o[l.copyMode];if(l.isOutsideWidget){q=o.COPY}else{if(l.isReordering){q=o.Reorder}if(l.copyMode==="COPY"){q=o.COPY}}var p=k[l.dropPosition]||"before";var m=new a({className:this.name+"_modal",closable:true,okButtonText:q,koButtonText:c.cancel,animate:true,renderTo:document.body});var n={};n.title=q;if(l.isReordering){n.message=c.replace(c.get("confirmation_message_reorder"),{dndMode:q.toLowerCase(),source:l.dropName,position:p,target:l.targetName})}else{n.message=c.replace(c.get("confirmation_message"),{dndMode:q.toLowerCase(),source:l.dropName,target:l.targetName})}n.callback=function(r){l.callback(r)};m.confirm(n)}});return i});define("DS/PADUtils/PADModelEvents",["DS/CoreEvents/ModelEvents"],function(c){console.warn("Deprecated module DS/PADUtils/PADModelEvents use DS/PADServices/utils/GlobalModelEvents");"use strict";var a=new c();var b={getModelEvents:function(){return a},publish:function(d){return a.publish(d)},subscribe:function(d,e){return a.subscribe(d,e)},unsubscribe:function(d){return a.unsubscribe(d)},unsubscribeAll:function(d){return a.unsubscribeAll(d)}};return b});define("DS/PADUtils/views/PADInfoPanel",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/Core/Core","UWA/Class/Events"],function(g,e,f,h,b,d,a){var c=h.extend(b,a,{name:"padskeleton",init:function(j){this._parent(j);if(!this.getOption("content")){throw new Error(("No main view defined"))}this.elements.container=UWA.createElement("div",{"class":this.getClassNames()});this.elements.info=UWA.createElement("div",{"class":this.getClassNames("_info")}).inject(this.elements.container);var m=UWA.createElement("div",{"class":this.getClassNames("_info_topbar")}).inject(this.elements.info);var i=UWA.createElement("div",{"class":this.getClassNames("_info_topbar_title"),html:this.getOption("info_title")}).inject(m);var k=UWA.createElement("span",{"class":this.getClassNames("_info_close")+" wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close",title:j.nlsCloseSlidder?j.nlsCloseSlidder:e.closeRootPanel}).inject(m);var l=this;k.addEventListener("click",function(){l.togglePanel();l.dispatchEvent("closeInfoPanel")});this.elements.info_content=UWA.createElement("div",{"class":this.getClassNames("_info_content")}).inject(this.elements.info);this.getOption("info_content").inject(this.elements.info_content);this.elements.content=UWA.createElement("div",{"class":this.getClassNames("_content")}).inject(this.elements.container);this.getOption("content").inject(this.elements.content)},togglePanel:function(){this.elements.info.toggleClassName("open");this.elements.content.toggleClassName("open");this.dispatchEvent("togglePnl")}});return c});define("DS/PADUtils/views/PADLevelSel",["css!DS/PADUtils/PADUtils","css!DS/UIKIT/UIKIT","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox"],function(b,i,d,c,f,j,e,a,h){function k(){var l="500px";if(document.body.scrollHeight>40){l=document.body.scrollHeight+"px"}return l}var g=c.extend({name:"pad_level_sel",defaultOptions:{current_level:1},init:function(n){this._parent(n);var r=this,m=UWA.createElement("div",{"class":this.getClassNames()});var l=new h({value:r.options.current_level,minValue:1,stepValue:1,pageStepValue:1}).inject(m);l.getContent().addClassName(this.getClassNames("_spinbox"));this.elements.level_selector=l;l.getContent().addEvent("change",this._updateDownState.bind(this));var p=new e({icon:"check",emphasize:"success"}).inject(m);p.getContent().addClassName(this.getClassNames("_okbtn"));p.getContent().setStyle("width","22px");l.addEventListener("change",function(s){r.options.current_level=parseInt(s.dsModel.value)});if(l.elements.inputField){l.elements.inputField.addEventListener("keyup",function(s){if(s.keyCode===13){var t=r.options.current_level.toString();r.dispatchEvent("onApply",[t]);q.destroy()}})}p.addEventListener("click",function(){var s=r.options.current_level.toString();r.dispatchEvent("onApply",[s]);q.destroy()});var o=UWA.is(n.css_style)?" "+n.css_style:"";var q=new f({className:this.getClassNames("_modal")+o,closable:false,body:m,visible:true});q.elements.wrapper.setStyle("padding-top","calc("+k()+" - 80px)");if(q.elements.scrollableContent){q.elements.scrollableContent.setStyle("width","155px")}q.elements.container.addEventListener("click",function(s){q.destroy()});q.elements.content.addEventListener("click",function(s){s.preventDefault();s.stopPropagation();return false});q.inject(document.body);this._updateDownState()},_updateDownState:function(){var m=this.elements.level_selector.value;var l=this.elements.level_selector.minValue;var n=this.elements.level_selector.elements.down;if(m<=l){n.addClassName("pad_level_sel_down_arrow_disabled")}else{n.removeClassName("pad_level_sel_down_arrow_disabled")}}});return g});define("DS/PADUtils/PADTransactionManager",["UWA/Class","UWA/Class/Events"],function(c,b){var a=function(h,g,e){this.getId=function(){return g};this.isNested=function(){return e};var f=this;this.end=function(){h(f)}};var d=c.extend(b,{_transactionStack:[],startTransaction:function(h){var g=Boolean(this._transactionStack.length>0);var f=this;function i(j){var m=f._transactionStack.indexOf(j);var l=j.getId();if(m<0){throw new Error('This "'+l+'" transaction is not part of the transaction stack, may be it has already been ended')}if(m!==(f._transactionStack.length-1)){throw new Error('Cannot end this "'+l+'" transaction as it is not the innermost transaction')}f._transactionStack.pop();var k=j.isNested();f.dispatchEvent("onTransactionEnd",[l,k])}var e=new a(i,h,g);this._transactionStack.push(e);g=e.isNested();this.dispatchEvent("onTransactionStart",[h,g]);return e},wrapInTransaction:function(f,g){var e=this.startTransaction(g);try{if(UWA.is(f,"function")){f()}}finally{e.end()}}});return d});define("DS/PADUtils/commands/PADAddRoot_cmd",["DS/ApplicationFrame/Command"],function(b){var a=b.extend({execute:function(c){require(["DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADTypesMgt","DS/PADUtils/views/PADAlert"],function(i,h,f,e,d){var m="";var j=h.getSetting("authorized_root_types")?h.getSetting("authorized_root_types"):h.getSetting("authorized_types");var k=j.length;for(var n=0;n<k;n++){var l=j[n];if(m===""){m=m+'type:"'+l+'"'}else{m=m+' OR type:"'+l+'"'}}var g={fts_value:m,callback:function(p){var o=i.get();var q=p.selected_data;o.openDroppedObjects({notifPerObjects:true,displayNotif:false,unserializedData:q,version:"2.0"})},cancel:function(){}};f.inAppsSearch(g)})}});return a});define("DS/PADUtils/commands/PADOpenInCADFromSearch",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","UWA/Core","UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI"],function(d,c,b,a){var e=b.extend({name:"PADOpenInCADFromSearch",_compass_socket:null,_role_check_promise:null,_context:null,init:function(f){if(f&&f.addinmode){this._context=f.addinmode}},availableForTypes:function(){var f=[];var g=JSON.parse(d);if(this._context){if(g["openInCAD_"+this._context+"_supported_types"]){f=g["openInCAD_"+this._context+"_supported_types"]}}return f},getActionForObject:function(f,i){if(this._context){var h=this;var g=JSON.parse(d);require(["i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(o){var p=[];var j=null;if(f.taxonomies){var n=null;if(c.is(f.taxonomies,"string")){n=f.taxonomies}else{if(c.is(f.taxonomies,"array")){for(var m=0;m<f.taxonomies.length;m++){if(c.is(f.taxonomies[m],"string")&&f.taxonomies[m].indexOf("types/")===0){n=f.taxonomies[m];break}}}}if(c.is(n)){j=n.split("/")}}else{j=[f["ds6w:type_value"]]}if(c.is(j,"array")){var k=false;for(var l=j.length-1;l>=0;l--){var q=j[l];if(g["openInCAD_"+h._context+"_supported_types"].indexOf(q)>-1&&!k){p.push({icon:"fonticon fonticon-open",id:h.name,multisel:false,title:o.PAD_CMDOpenInCAD,callback:h.launchCustoAction.bind(h)});k=true;break}}}i.call(null,p)})}else{i.call(null,[])}},launchCustoAction:function(f){a.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:f.object_ids[f.object_ids.length-1]}]}))}});return e});define("DS/PADUtils/views/PADLevelSelector",["css!DS/PADUtils/PADUtils","css!DS/UIKIT/UIKIT","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Input/Text","UWA/Controls/Abstract","DS/Logger/Logger",],function(b,h,f,g,d,e,c){function j(k){return/^\+?(0|[1-9]\d*)$/.test(k)}function i(){var k="500px";if(document.body.scrollHeight>40){k=document.body.scrollHeight+"px"}return k}var a=e.extend({name:"pad_level_selector",_logger:null,_level_input:null,_current_level:1,init:function(l){this._parent(l);this._logger=c.getLogger(a);this._logger.log("init");var o=this,k=UWA.createElement("div",{"class":this.getClassNames()});this._level_input=new d({className:this.getClassNames("_txt"),maxlength:5,value:1,events:{onChange:function(){var p=this.getValue();if(j(p)){o._current_level=parseInt(p)}else{o._logger.warn("Invalid input");this.setValue(o._current_level)}}}});UWA.createElement("span",{"class":this.getClassNames("_arrow")+" fonticon fonticon-fast-backward fonticon-2x",events:{click:function(){if(o._current_level>1){o._current_level=o._current_level-1;o._level_input.setValue(o._current_level)}}}}).inject(k);this._level_input.inject(k);UWA.createElement("span",{"class":this.getClassNames("_arrow")+" fonticon fonticon-fast-forward fonticon-2x",events:{click:function(){o._current_level=o._current_level+1;o._level_input.setValue(o._current_level)}}}).inject(k);UWA.createElement("span",{"class":this.getClassNames("_btn")+" fonticon fonticon-check fonticon-2x",events:{click:function(){var p=o._current_level.toString();o.dispatchEvent("onApply",[p]);n.destroy()}}}).inject(k);var m=UWA.is(l.css_style)?" "+l.css_style:"",n=new g({className:this.getClassNames("_modal")+m,closable:false,body:k,visible:true});n.elements.wrapper.setStyle("padding-top","calc("+i()+" - 80px)");n.elements.container.addEventListener("click",function(p){n.destroy()});n.elements.content.addEventListener("click",function(p){p.preventDefault();p.stopPropagation();return false});n.inject(document.body)}});return a});define("DS/PADUtils/PADWebInWinServices",["UWA/Core","UWA/Class"],function(c,a){var b=a.singleton({_widget:null,_addinmode:null,initialize:function(d){this._widget=d.widget;this._addinmode=this._widget?this._widget.getValue("addinmode"):typeof widget!=="undefined"?widget.getValue("addinmode"):""},isWebInWinContext:function(){return(this._addinmode==="solidworks"||this._addinmode==="catiav5")}});return b});define("DS/PADUtils/PADSession",["UWA/Class","DS/PADUtils/PADCommandProxy","DS/PADUtils/views/PADAlert","DS/Core/ModelEvents","i18n!DS/PADUtils/assets/nls/PADUtils.json",],function(c,d,b,f,e){var a=c.singleton({_modelEvents:null,_notSilent:true,init:function(){var g=this;this._modelEvents=new f();function h(l){var i=require("DS/PADUtils/PADSettingsMgt");if(i.app_context==="enxscene"){return}if(UWA.is(l.authored,"boolean")){var k=l.authored_reason;if(!k&&l.authored){k=e.PADSession_disabling_index_authoring}g.setAuthoringState(l.authored,k,false)}if(UWA.is(l.useIndexPreference,"boolean")){var j=l.useIndexPreference_reason;g.setUseIndexPreference(l.useIndexPreference,j,false)}}this._commandProxy=d.create({events:{onAuthored:h,onSessionStateChange:h}});this._authored=false;this._useIndexPreference=true;this._callCounter=0},setUseIndexPreference:function(h,j,g){var i={useIndexPreference:h,useIndexPreference_reason:j};if(h!==this._useIndexPreference){this._useIndexPreference=h;if(g!==false){this._commandProxy.sessionStateChange(i)}this.publish({event:"useIndexPreferenceModified",data:{useIndexPreference:h}})}else{if(g===true){this._commandProxy.sessionStateChange(i)}}},setAuthoringState:function(g,l,h,j){var k=false;if(UWA.is(g,"boolean")&&(g!==this._authored)){if(l&&this._notSilent){var i=e[l]||l;b.displayNotification({msg:i,eventID:"primary"})}this._authored=g;k=true;this.publish({event:"authoringStateModified",data:{authored:this._authored}})}if((k&&h===undefined)||h===true){this._commandProxy.authored({authored:this._authored,authored_reason:l,instanceId:j})}},isAuthoring:function(){return(this._authored)},isUsingIndex:function(){console.warn("The method PADSession.determineAuthoredFlag is clearer than isUsingIndex");return Boolean(this._useIndexPreference&&!this._authored)},determineAuthoredFlag:function(){if(!this._useIndexPreference){return true}else{return this._authored}},softInit:function(g){if(g===true){this._notSilent=!g}},getModelEvents:function(){return this._modelEvents},publish:function(g){this.getModelEvents().publish(g)},subscribe:function(g,h){return this.getModelEvents().subscribe(g,h)},unsubscribe:function(g){this.getModelEvents().unsubscribe(g)},onAuthoringMode:function(g){return this.getModelEvents().subscribe({event:"authoringStateModified"},g)}});return a});define("DS/PADUtils/PADSettingsMgt",["text!DS/PADUtils/assets/PADSettingsMgt.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Class/Events","DS/PADUtils/views/PADAlert","DS/PADUtils/PADContext","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/PADSession","DS/PADUtils/Configuration"],function(b,e,a,n,m,i,o,k,h,j,d){function l(x,u,w){var v=x.splice(u,1)[0];var t=x.splice(w,1)[0];x.splice(u,0,t);x.splice(w,0,v)}function g(v,t,u){v.splice(u,0,v.splice(t,1)[0])}function q(w,u){for(var v=0;v<w.length;v++){var t=w[v];if(t.name===u){return v}}return null}function f(x){var z=x.getPreferences();var t=[];var y=z.length;for(var w=0;w<y;w++){var B=z[w];if(B.name==="pad_security_ctx"){if(w!==0){t.push({prop:"pad_security_ctx",from:w,to:0})}}if(B.name==="x3dPlatformId"&&y>1){if(w!==1){t.push({prop:"x3dPlatformId",from:w,to:1})}}}t.sort(function(D,C){if(D.from>C.from){return -1}if(D.from<C.from){return 1}if(D.from===C.from){return 0}});if(t.length){var u=t.length;for(var v=0;v<u;v++){var A=t[v];if(v!==0){A.from=q(z,A.prop)}if((u-1)===v){l(z,A.from,A.to)}else{g(z,A.from,A.to)}}x.setPreferences(z)}}var c=function(t){return"on"+t.charAt(0).toUpperCase()+t.slice(1)},p=function(t){return(t.toLowerCase()==="true")},s={widgetDomain:null},r=n.singleton(m,i,{app_context:null,version:"1.0",defaultOptions:{run_options:{},debug_options:{},session_options:{},webapi_options:{},layout_options:{}},with_security_context:false,init:function(t){this._parent(t);this.setOptions(this.defaultOptions)},destroy:function(){this.app_context=null;this.version="1.0";this.options.run_options={};this.options.debug_options={};this.options.session_options={};this.options.webapi_options={};this.options.layout_options={}},setApp:function(v,w,t){var x=t?t:false;this.set_app_context(w,x);var u=v;if(UWA.is(u.common)){this.options.debug_options=UWA.is(u.common.debug_options)?u.common.debug_options:this.options.debug_options;this.options.run_options=UWA.is(u.common.run_options)?u.common.run_options:this.options.run_options;this.options.webapi_options=UWA.is(u.common.webapi_options)?u.common.webapi_options:this.options.webapi_options;this.options.layout_options=UWA.is(u.common.layout_options)?u.common.layout_options:this.options.layout_options}if((UWA.is(w,"string")&&UWA.is(u[w],"object"))){this.options=UWA.extend(this.options,u[w],true)}if(this.hasSetting("activate_FUN082641",true)){this.addEvent("onMaxDashSearch",function(y){if(widget){widget.setValue("stayOnSearch",!y)}})}},set_app_context:function(w,t){var v=JSON.parse(b);var u=UWA.is(t,"boolean")?!t:true;if(!UWA.is(w,"string")){throw new Error("Invalid app context")}this.app_context=w;this.version=v.version;this.options=UWA.extend(this.options,v.common,true);if(UWA.is(v[w],"object")){this.options=UWA.extend(this.options,v[w],true)}this.with_security_context=u?u:false;if(this.with_security_context===true){this.options=UWA.extend(v.security_ctx,this.options,true)}},build_preferences:function(z){var u=Object.getOwnPropertyNames(z),A=0,w=[];for(A=0;A<u.length;A++){var t=u[A],B=z[t];if(UWA.is(B.preference,"object")&&B.notAddedByDefault!==true){var y=true;if(UWA.is(B.activatedBySetting,"string")){var x=r.getSetting(B.activatedBySetting,true);if(x===false){y=false}}else{if(UWA.is(B.activatedByWidgetPreference,"object")){if(typeof widget!=="undefined"&&widget.getValue(B.activatedByWidgetPreference.name)){if(widget.getValue(B.activatedByWidgetPreference.name)!==B.activatedByWidgetPreference.value){y=false;r.setSetting(t,false)}}}}if(y===true){var v=UWA.merge({name:t,defaultValue:B.value},B.preference);w.push(v)}}}return w},orderWidgetPreferences:function(){if(widget){f(widget)}},getWidgetPreferences:function(){var t=[];if(this.app_context===null){throw new Error("Set the app context before using the PADSettingsMgt")}if(widget){t=t.concat(r.build_preferences(this.options.run_options));if(widget.getValue("debug_me")==="1"){var u=r.build_preferences(this.options.debug_options);t=t.concat(u)}}return t},getSpecificWidgetPreference:function(v){if(!UWA.is(v,"string")||v.length===0){throw new Error("getSpecificWidgetPreference: Invalid input parameter")}var t=null,u=null;if(this.options.run_options.hasOwnProperty(v)){u=this.options.run_options[v]}else{if(this.options.debug_options.hasOwnProperty(v)){u=this.options.debug_options[v]}else{console.error("getSpecificWidgetPreference: Unknown setting ["+v+"]");throw new Error("getSpecificWidgetPreference: Unknown setting ["+v+"]")}}if(UWA.is(u.preference,"object")){t=UWA.merge({name:v,defaultValue:u.value},u.preference)}else{throw new Error("getSpecificWidgetPreference: setting ["+v+"] has no prefence defined")}return[t]},getSecurityPreferences:function(){if(this.options.run_options.x3dPlatformId&&this.options.run_options.pad_security_ctx){return r.build_preferences({x3dPlatformId:this.options.run_options.x3dPlatformId,pad_security_ctx:this.options.run_options.pad_security_ctx})}else{throw new Error("Invalid call - Security Context hasn't been declared")}},updateSecuritySettings:function(D,A,u,t,B){B=B===undefined?true:B;var z="ctx::";var w=u.indexOf(z)===-1?z+u:u;var C=false;var v;for(var y=0;y<t.length;y++){var x=t[y];if(y===0){v=x.value}if(x.value===w){C=true}}if(!C){w=v}if(B){widget.addPreference({name:"pad_security_ctx",type:"list",label:"pad_security_ctx",defaultValue:w,options:t})}if(this._dynamicUpdate==true){widget.dispatchEvent("onEdit")}else{r.updateTenantSettings(D,A,B);widget.setValue("pad_security_ctx",w);this.setSetting("pad_security_ctx",w)}},updateTenantSettings:function(u,x,w){if(typeof widget!=="undefined"){var t={name:"x3dPlatformId",type:"list",label:"pad_tenant",defaultValue:u,options:x,onchange:"onPlatformIdChange"};if(x.length===1){t.disabled=true}var v=require("DS/PADUtils/PADUtilsServices");if(v.isCloud()&&w){widget.addPreference(t)}this.orderWidgetPreferences();widget.setValue("x3dPlatformId",u);this.setSetting("x3dPlatformId",u);widget.setValue("pad_tenant",u);this.setSetting("pad_tenant",u)}},updateTenantPreference:function(v){if(this.app_context===null){throw new Error("Set the app context before using the PADSettingsMgt")}var x=this;var u=k.get();if(u&&UWA.is(u.empty,"function")){var t=false;if(UWA.is(u.getPADTreeDocument,"function")){t=u.getPADTreeDocument().getRoots().length!==0}else{if(UWA.is(u.getRoots,"function")){t=u.getRoots().length!==0}else{console.warn("Unknown context")}}if(t){var w=x.getSetting("x3dPlatformId");var A=x.getSetting("pad_security_ctx");if(w!==v.value){var z={isMultiTenant:false,isClearView:false};var y=new h({id:"PadTenantMgt",currentTenant:z,callback:function(C){if(C.isClearView){x.setSetting(v.name,v.value);u.empty();o.displayNotification({msg:e.PlatformChange+v.value,eventID:"warning"})}else{var B={tenant:w,padsecurityctx:A};var D=require("DS/PADUtils/PADUtilsServices");D.updateWidgetSecPref(B);x.setSetting(v.name,x.getSetting("x3dPlatformId"))}}})}}else{x.setSetting(v.name,v.value)}}else{x.setSetting(v.name,v.value)}},updateTenantSecPreference:function(x,w){var t=this;t._dynamicUpdate=w;var u={tenant:x,withPreference:true,dynamicUpdate:w};var v=require("DS/PADUtils/PADUtilsServices");v.updateWidgetSecPref(u)},updateWidgetPreferences:function(t){this._dynamicUpdate=null;if(t&&t.submitted===false){return}if(this.app_context===null){throw new Error("Set the app context before using the PADSettingsMgt")}var u=this;if(widget){widget.getPreferences().forEach(function(v){if(v.name==="x3dPlatformId"){r.updateTenantPreference(v)}else{u.setSetting(v.name,v.value)}})}},getSetting:function(u,t){var v;if(this.options.run_options.hasOwnProperty(u)){v=this.options.run_options[u].value}else{if(this.options.debug_options.hasOwnProperty(u)){if(t===true&&this.options.debug_options[u].activatedByWidgetPreference){if(typeof widget!=="undefined"&&widget.getValue(this.options.debug_options[u].activatedByWidgetPreference.name)){if(widget.getValue(this.options.debug_options[u].activatedByWidgetPreference.name)!==this.options.debug_options[u].activatedByWidgetPreference.value){this.options.debug_options[u].value=false}}}v=this.options.debug_options[u].value}else{if(this.options.session_options.hasOwnProperty(u)){v=this.options.session_options[u].value}else{v=false}}}return v},setSetting:function(u,v,t){var x;if(this.options.run_options.hasOwnProperty(u)){x=this.options.run_options[u]}else{if(this.options.debug_options.hasOwnProperty(u)){x=this.options.debug_options[u]}else{this.options.session_options[u]={value:v}}}if(x){var w=v;if(x.preference&&x.preference.type==="boolean"&&UWA.is(v,"string")){w=p(v)}else{if(v&&UWA.is(v.toLowerCase,"function")&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")){w=p(v)}}if(x.value!==w){x.value=w;if(x.dispatch===true){this.dispatchEvent(c(u),w)}}if(t&&typeof widget!=="undefined"){widget.setValue(u,w)}}},getWebAPI_Options:function(t){var u={};if(this.options.webapi_options.hasOwnProperty(t)){u=this.options.webapi_options[t]}return u},setWebAPI_Options:function(t,u){if(this.options.webapi_options.hasOwnProperty(t)){this.options.webapi_options[t]=u}},getLayout_options:function(u){var t={};if(this.options.layout_options.hasOwnProperty(u)){t=this.options.layout_options[u]}return t},getURLParameter:function(t){function u(v){return decodeURIComponent((new RegExp("[?|&]"+v+"=([^&;]+?)(&|#|;|$)").exec(s.widgetDomain)||[null,""])[1].replace(/\+/g,"%20"))||null}if(s.widgetDomain===null){s.widgetDomain=decodeURIComponent((new RegExp("[?|&]widgetDomain=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}if(s.widgetDomain){return u(t)}else{return null}},hasSetting:function(u,t){if(this.options.run_options.hasOwnProperty(u)){return true}if(t){if(this.options.debug_options.hasOwnProperty(u)){return true}}return false}});r.addEvent("onUseIndexAccleration",function(t){j.setUseIndexPreference(t)});return r});define("DS/PADUtils/views/PADStoredObjMgt",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Controls/Button","DS/Utilities/Dom","DS/UIKIT/Spinner","DS/Controls/Toggle","DS/PADUtils/views/PADAlert","DS/PADUtils/PADSettingsMgt"],function(r,c,e,n,g,j,k,l,o,i,d,p,f){var m="DS/ENOFloatingPanel/ENOFloatingPanel";var h=function(v){var w=[];var u=Object.getOwnPropertyNames(v);if(u.length){for(var t=0;t<u.length;t++){var s=h(v[u[t]]);if(s===null){w.push(u[t])}else{if(e.is(s,"string")){w.push(s)}else{w=w.concat(s)}}}}else{return null}return w};var q=function(u,t){var x={},w=0;for(var s=0;s<t.attributes.length&&w<u.length;s++){var v=u.indexOf(t.attributes[s].name);if(v!==-1){x[t.attributes[s].name]=t.attributes[s].value;w++}}return x};var a=function(u,s){var t={};t.requiredObjectInfos=s.requiredObjectInfos;t.requiredFilterInfos=u.requiredFilterInfos;t.availableObjects=u.availableObjects.concat(s.availableObjects);return t};var b=n.extend({name:"padStoredObjMgt",defaultOptions:{objectInfos:{},filterRootIds:[],filterInfos:{},commandProxy:null,deactivateStoredObjMgt:false},init:function(s){this._parent(s);var t=this;require([m,"DS/PADUtils/PADCommandProxy","DS/PADUtils/PADUtilsServices"],function(w,u,x){t.elements.container=e.createElement("div",{"class":t.getClassNames("-availableObjects")});if(s.events){t.addEvents(s.events)}t._commandProxy=u.create({events:{onLoadStoredObjects:function(E,D){if(D.originWidgetId!==x.getWidgetId()){t.options.availableObjects.withTransactionUpdate(function(){var G=[],F;for(F=0;F<E.selectedNodes.length;F++){G.push(E.selectedNodes[F].resourceid)}t.options.availableObjects.unselectAll();var H=t.options.availableObjects.search({match:function(J){F=G.indexOf(J.nodeModel.options.resourceid);if(F!==-1){if(J.nodeModel.options.grid.detached!==E.selectedNodes[F].grid.detached){J.nodeModel.options.grid.detached=E.selectedNodes[F].grid.detached;if(e.is(J.nodeModel.options.item2Load,"array")){for(var I=0;I<J.nodeModel.options.item2Load.length;I++){J.nodeModel.options.item2Load[I].hidden=E.selectedNodes[F].grid.detached}}}return true}}});for(F=0;F<H.length;F++){H[F].select()}if(e.is(E.showStoredObjectMgt,"boolean")&&!E.showStoredObjectMgt!==t.options.deactivateStoredObjMgt){t.options.deactivateStoredObjMgt=!E.showStoredObjectMgt}t._loadSelected(true);t.elements.floatingpanel.destroy()})}}}});t.render_div=document.querySelector(t.options.render_div);t.options.availableObjects=new j();var z={};var v=(t.options.filterIds&&t.options.filterIds.length>0)?true:false;var B=t.options.structure?true:false;if(v&&B){var A=t._buildAvailableObjFromFilter(t.options.filterIds);z=t._buildAvailableObjectsFromStructure(t.options.structure,t.options.id_to_detach?t.options.id_to_detach:[]);z=a(A,z)}else{if(v){z=t._buildAvailableObjFromFilter(t.options.filterIds)}else{if(B){z=t._buildAvailableObjectsFromStructure(t.options.structure,t.options.id_to_detach?t.options.id_to_detach:[])}else{if(t.options.objects3D){z=t._buildAvailableObjectsFromObjects3D(t.options.objects3D)}else{console.error("PADStoredObjMgt: Invalid input options");p.displayNotification({eventID:"error",msg:c.padStoredObjMgtError});return}}}}t._buildAvailableObjList(z.availableObjects);var C=(z.requiredFilterInfos&&z.requiredFilterInfos.length>0)?true:false;var y=(z.requiredObjectInfos&&z.requiredObjectInfos.length>0)?true:false;if(C&&y){t._updateModelInfosFilter(z.requiredFilterInfos,z.requiredObjectInfos)}else{if(y){t._updateModelInfos(z.requiredObjectInfos)}else{if(C){t._updateModelInfosFilter(z.requiredFilterInfos)}}}t._buildObjListView();t.elements.floatingpanel=new w({className:t.name,body:t.elements.container,footer:t._buildFooter(),title:c.padStoredObjMgtTitle,overlay:true,closable:true,animate:true,resizable:true,visible:true,events:{onClose:function(){t._commandProxy.loadStoredObjects({selectedNodes:[]});t.elements.floatingpanel.destroy()}}});t.elements.floatingpanel.inject(t.render_div)})},_buildAvailableObjList:function(t){if(!t){return}var v=this;for(var u=0;u<t.length;u++){var s=new k(t[u]);this.options.availableObjects.addRoot(s);s.select()}},_buildAvailableObjFromFilter:function(u){var t=this;var s={requiredFilterInfos:[],availableObjects:[]};u.forEach(function(w){var v={resourceid:w,grid:{rootId:w,leaves:[],detached:false},item2Load:{}};s.availableObjects.push(v);v.item2Load[w]={};if(t.options.filterInfos[w]===undefined&&s.requiredFilterInfos.indexOf(w)===-1){s.requiredFilterInfos.push(w)}});return s},_buildAvailableObjectsFromStructure:function(v,x){var u=Object.getOwnPropertyNames(v);var w={requiredObjectInfos:[],availableObjects:[]};for(var t in u){var y={resourceid:u[t],grid:{rootId:u[t],leaves:h(v[u[t]]),detached:x.indexOf(u[t])===-1?false:true},item2Load:{}};y.item2Load[u[t]]=v[u[t]];w.availableObjects.push(y);if(this.options.objectInfos[u[t]]===undefined&&w.requiredObjectInfos.indexOf(u[t])===-1){w.requiredObjectInfos.push(u[t])}if(y.grid.leaves){for(var s=0;s<y.grid.leaves.length;s++){if(this.options.objectInfos[y.grid.leaves[s]]===undefined&&w.requiredObjectInfos.indexOf(y.grid.leaves[s])===-1){w.requiredObjectInfos.push(y.grid.leaves[s])}}}}return w},_buildAvailableObjectsFromObjects3D:function(u){var s={requiredObjectInfos:[],availableObjects:[]};var z={};for(var y=0;y<u.length;y++){var A={resourceid:"",grid:{rootId:"",leaves:null,detached:false},item2Load:[]};if(z[u[y].path[0]]===undefined){A.resourceid=u[y].path[0];A.grid.rootId=u[y].path[0];if(this.options.objectInfos[A.grid.rootId]===undefined&&s.requiredObjectInfos.indexOf(A.grid.rootId)===-1){s.requiredObjectInfos.push(A.grid.rootId)}if(u[y].path.length>1){if(A.grid.leaves===null){A.grid.leaves=[]}var w=u[y].path[u[y].path.length-1];if(A.grid.leaves.indexOf(w)===-1){A.grid.leaves.push(w);if(this.options.objectInfos[w]===undefined&&s.requiredObjectInfos.indexOf(w)===-1){s.requiredObjectInfos.push(w)}}}A.grid.detached=u[y].hidden;A.item2Load.push(u[y]);s.availableObjects.push(A);z[A.resourceid]=s.availableObjects.length-1}else{A=s.availableObjects[z[u[y].path[0]]];if(u[y].path.length>1){if(A.grid.leaves===null){A.grid.leaves=[]}var x=false;for(var v=0;v<A.item2Load.length;v++){for(var t=0;t<A.item2Load[v].path.length;t++){if(u[y].path[t]!==A.item2Load[v].path[t]){break}}if(t===A.item2Load[v].path.length){x=true;break}}var w=u[y].path[u[y].path.length-1];if(A.grid.leaves.indexOf(w)&&!x){A.grid.leaves.push(w);if(this.options.objectInfos[w]===undefined&&s.requiredObjectInfos.indexOf(w)===-1){s.requiredObjectInfos.push(w)}}}A.item2Load.push(u[y])}}return s},_buildObjListView:function(){var w=this;this.elements.storedObjLst=e.createElement("div",{"class":w.getClassNames("-storedObjLst")}).inject(this.elements.container);var u=[{width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:false,isColumnMovable:false,isHidden:false},{width:"0",dataIndex:"tree",isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,isHidden:true},{dataIndex:"padRootInfo",width:"auto",minWidth:75,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(D){var z=D.nodeModel.options.grid.rootId;if(w.options.filterInfos[z]){var B=D.cellView.reuseCellContent("padRootInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.filterInfos[z].label;C.title=w.options.filterInfos[z].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.filterInfos[z].icon+")";A.title=w.options.filterInfos[z].label}}else{if(w.options.objectInfos[z]){var B=D.cellView.reuseCellContent("padRootInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.objectInfos[z].label;C.title=w.options.objectInfos[z].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.objectInfos[z].icon+")";A.title=w.options.objectInfos[z].label}}else{D.cellView.reuseCellContent("loadingInfo")}}}},{dataIndex:"padLeavesInfo",width:"auto",minWidth:75,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(D){var E=D.nodeModel.options.grid.leaves;if(!E){}else{if(E.length===1){if(w.options.objectInfos[E[0]]){var B=D.cellView.reuseCellContent("padLeavesInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.objectInfos[E[0]].label;C.title=w.options.objectInfos[E[0]].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.objectInfos[E[0]].icon+")";A.style.display="inline-flex";A.title=w.options.objectInfos[E[0]].label}}else{D.cellView.reuseCellContent("loadingInfo")}}else{if(E.length>1){var B=D.cellView.reuseCellContent("padLeavesInfoBranches");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=E.length+c.padStoredObjMgtBranches;C.title="";for(var z=0;z<E.length;z++){if(w.options.objectInfos[E[z]]){C.title=C.title+w.options.objectInfos[E[z]].label;if(z<E.length-1){C.title+="\n"}}}}}}}}}];var s=[{width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:false,isColumnMovable:false,isHidden:false},{width:"0",dataIndex:"tree",isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,isHidden:true},{dataIndex:"padRootInfo",width:"auto",minWidth:75,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(D){var z=D.nodeModel.options.grid.rootId;if(w.options.filterInfos[z]){var B=D.cellView.reuseCellContent("padRootInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.filterInfos[z].label;C.title=w.options.filterInfos[z].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.filterInfos[z].icon+")";A.title=w.options.filterInfos[z].label}}else{if(w.options.objectInfos[z]){var B=D.cellView.reuseCellContent("padRootInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.objectInfos[z].label;C.title=w.options.objectInfos[z].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.objectInfos[z].icon+")";A.title=w.options.objectInfos[z].label}}else{D.cellView.reuseCellContent("loadingInfo")}}}},{dataIndex:"padLeavesInfo",width:"auto",minWidth:75,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(D){var E=D.nodeModel.options.grid.leaves;if(!E){}else{if(E.length===1){if(w.options.objectInfos[E[0]]){var B=D.cellView.reuseCellContent("padLeavesInfo");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=w.options.objectInfos[E[0]].label;C.title=w.options.objectInfos[E[0]].label}var A=B.querySelector(".padStoredObjMgt-icon");if(A){A.style.backgroundImage="url("+w.options.objectInfos[E[0]].icon+")";A.style.display="inline-flex";A.title=w.options.objectInfos[E[0]].label}}else{D.cellView.reuseCellContent("loadingInfo")}}else{if(E.length>1){var B=D.cellView.reuseCellContent("padLeavesInfoBranches");var C=B.querySelector(".padStoredObjMgt-title");if(C){C.innerText=E.length+c.padStoredObjMgtBranches;C.title="";for(var z=0;z<E.length;z++){if(w.options.objectInfos[E[z]]){C.title=C.title+w.options.objectInfos[E[z]].label;if(z<E.length-1){C.title+="\n"}}}}}}}}},{dataIndex:"padStoreHideShow",width:40,minWidth:40,maxWidth:40,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(A){var z=A.cellView.reuseCellContent("padStoreHideShow");if(A.nodeModel.options.grid.detached&&A.nodeModel.options.grid.detached===true){z.title=c.attachRoot;z.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-eye-off padStoredObjCommand"}else{z.title=c.detachRoot;z.className="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-eye padStoredObjCommand"}}}];var v={height:"auto",selection:{enableListSelection:true,toggle:true},show:{columnHeaders:false},defaultCellHeight:60,enableDragAndDrop:false,enableActiveUI:true,enableKeyboardNavigation:true,enableTreeColumnEllipsisOverflow:true,performances:{preloadPool:true,useRequestAnimationFrameRendering:false},resize:{columns:false},isEditable:false,columns:f.getSetting("disableDetach")?u:s};w.options.selectedTreeLst=new g(v);w.options.selectedTreeLst.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0});w.options.selectedTreeLst.getManager().loadDocument(w.options.availableObjects);w.options.selectedTreeLst.getManager().addEventListener("click",w._onCellClick.bind(w));w.options.selectedTreeLst.getManager().registerReusableCellContent({id:"padStoreHideShow",buildContent:function(){return o.createElement("span",{style:"font-size: 18px;"})}});w.options.selectedTreeLst.getManager().registerReusableCellContent({id:"padRootInfo",buildContent:function(){var B=o.createElement("ul",{"class":w.getClassNames("-cellInfos"),style:"height: 100%; display: block; position: relative;"});var z=o.createElement("li",{"class":w.getClassNames("-cellInfosLine padRootInfo"),style:"left: 0px;"});var A=o.createElement("li",{"class":w.getClassNames("-icon"),style:"display: inline-flex;"});var C=o.createElement("li",{"class":w.getClassNames("-title")});z.appendChild(A);z.appendChild(C);B.appendChild(z);return B}});w.options.selectedTreeLst.getManager().registerReusableCellContent({id:"padLeavesInfo",buildContent:function(){var A=o.createElement("ul",{"class":w.getClassNames("-cellInfos padLeaves"),style:"height: 100%; display: block; position: relative;"});var z=o.createElement("li",{"class":w.getClassNames("-cellInfosLine"),style:"left: 0px;"});var C=o.createElement("li",{"class":w.getClassNames("-separator wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-right"),style:"display: inline-flex;"});var B=o.createElement("li",{"class":w.getClassNames("-icon"),style:"display: inline-flex;"});var D=o.createElement("li",{"class":w.getClassNames("-title")});z.appendChild(C);z.appendChild(B);z.appendChild(D);A.appendChild(z);return A}});w.options.selectedTreeLst.getManager().registerReusableCellContent({id:"padLeavesInfoBranches",buildContent:function(){var A=o.createElement("ul",{"class":w.getClassNames("-cellInfos padLeaves"),style:"height: 100%; display: block; position: relative;"});var z=o.createElement("li",{"class":w.getClassNames("-cellInfosLine"),style:"left: 0px;"});var B=o.createElement("li",{"class":w.getClassNames("-separator wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-right"),style:"display: inline-flex;"});var C=o.createElement("li",{"class":w.getClassNames("-title")});z.appendChild(B);z.appendChild(C);A.appendChild(z);return A}});w.options.selectedTreeLst.getManager().registerReusableCellContent({id:"loadingInfo",buildContent:function(){return new i().show()}});var t=e.createElement("div",{"class":w.getClassNames("-treeLstView")}).inject(this.elements.storedObjLst);w.options.selectedTreeLst.getContent().inject(t);setTimeout(function(){w.options.selectedTreeLst.giveFocus()},200);var y=e.createElement("div",{"class":this.getClassNames("-footerView")}).inject(this.elements.container);this.applyToggle=new d({label:c.padStoredObjMgtDontSeeAgain});var x=e.createElement("div",{"class":this.getClassNames("-instruction applyToggle"),content:this.applyToggle});new e.createElement("hr",{"class":"ruler"}).inject(x);this.applyToggle.inject(x);x.inject(y);this.applyToggle.addEventListener("change",function(A){var z=A.dsModel;w.options.deactivateStoredObjMgt=z.checkFlag})},_buildFooter:function(){var s=this;var u=e.createElement("div",{"class":this.getClassNames("-footerModal")});var t=new l({label:c.padStoredObjMgtLoad,emphasize:"primary",touchMode:true});t.addEventListener("click",function(){s._loadSelected(false);s.elements.floatingpanel.destroy()});t.inject(u);return u},_updateModelInfosFilter:function(y,u){var x=this;var t=[];var w=[];var s=new Promise(function(z){Promise.all(w).then(function(){x.options.xnav_component.loadFilters({filterIds:y,callback:function(A){x.options.availableObjects.withTransactionUpdate(function(){A.forEach(function(B){if(t.indexOf(B.rootId)===-1){t.push(B.rootId)}var C=B.type_icon_url||"/3DSpace/snresources/images/icons/small/I_AdvancedFilter22.png";x.options.filterInfos[B.filterId]={label:B.filterName,icon:C};x.options.objectInfos[B.filterId]={label:B.filterName,icon:C}})});z(t)}})})});s.name="updateFilter";w.push(s);if(u&&u.length>0){var v=new Promise(function(z){Promise.all(w).then(function(A){if(A&&A.length>0){u=u.filter(function(B){return(this.filterRootIds.indexOf(B)<0)},A)}if(u.length>0){x._updateModelInfos(u)}});z()});v.name="updateRoots";w.push(v);Promise.all(w).then(function(){console.log("all done")})}else{Promise.all(w).then(function(){console.log("all done")})}},_updateModelInfos:function(s){var u=this;var t=function(){u.dispatchEvent("onLoadObjects",{objects3D:{},structure:{},id_to_detach:[],objectInfos:{},filterIds:[],showStoredObjectMgt:e.is(u.options.deactivateStoredObjMgt,"boolean")?!u.options.deactivateStoredObjMgt:true});p.displayNotification({eventID:"error",msg:c.padStoredObjMgtError});u.elements.floatingpanel.destroy()};require(["DS/PADUtils/PADWSAccess","DS/PADUtils/PADSettingsMgt"],function(x,w){var v=w.getWebAPI_Options("fetch");x.fetch({enopad_webapis:w.getSetting("enopad_webapis"),data:v,pids:s,onComplete:function(z){var y=e.is(z,"string")?JSON.parse(z):z;if(y.results.length!==s.length){console.error("Inconsistent number of results");t()}u.options.availableObjects.withTransactionUpdate(function(){var A=["resourceid","type_icon_url","ds6w:label"];y.results.forEach(function(B){var C=q(A,B);u.options.objectInfos[C.resourceid]={label:C["ds6w:label"],icon:C.type_icon_url}})})},onFailure:function(){t()},})})},_cleanItem:function(s){var u=e.clone(s);if(u){for(var t in u){if(u.hasOwnProperty(t)){var v=u[t];if(typeof v==="function"){delete u[t]}}}}return u},_loadSelected:function(y){var F=this.options.availableObjects.getSelectedNodes();var w={};var z=[];var D={};var v=[];var A=[];var u;var B=this;var s=(B.options.filterIds&&B.options.filterIds.length>0)?true:false;var t=this.options.structure?true:false;if(s&&t){for(var E=0;E<F.length;E++){u=B._cleanItem(F[E].options);if(B.options.filterIds.indexOf(F[E].options.resourceid)!==-1){v.push(u)}else{w=e.extend(w,F[E].options.item2Load);if(F[E].options.grid.detached){z.push(F[E].options.resourceid)}v.push(u);D[F[E].options.resourceid]=this.options.objectInfos[F[E].options.resourceid];if(F[E].options.grid.leaves){for(var C=0;C<F[E].options.grid.leaves.length;C++){D[F[E].options.grid.leaves[C]]=this.options.objectInfos[F[E].options.grid.leaves[C]]}}}}this.dispatchEvent("onLoadObjects",{structure:w,id_to_detach:z,objectInfos:D,filterIds:A,showStoredObjectMgt:e.is(this.options.deactivateStoredObjMgt,"boolean")?!this.options.deactivateStoredObjMgt:true})}else{if(s){F.forEach(function(G){if(B.options.filterIds.indexOf(G.options.resourceid)!==-1){A.push(G.options.resourceid);u=B._cleanItem(G.options);v.push(u)}});this.dispatchEvent("onLoadObjects",{structure:w,id_to_detach:z,objectInfos:D,filterIds:A,showStoredObjectMgt:e.is(this.options.deactivateStoredObjMgt,"boolean")?!this.options.deactivateStoredObjMgt:true})}else{if(t){for(var E=0;E<F.length;E++){w=e.extend(w,F[E].options.item2Load);if(F[E].options.grid.detached){z.push(F[E].options.resourceid)}u=B._cleanItem(F[E].options);v.push(u);D[F[E].options.resourceid]=this.options.objectInfos[F[E].options.resourceid];if(F[E].options.grid.leaves){for(var C=0;C<F[E].options.grid.leaves.length;C++){D[F[E].options.grid.leaves[C]]=this.options.objectInfos[F[E].options.grid.leaves[C]]}}}this.dispatchEvent("onLoadObjects",{structure:w,id_to_detach:z,objectInfos:D,filterIds:A,showStoredObjectMgt:e.is(this.options.deactivateStoredObjMgt,"boolean")?!this.options.deactivateStoredObjMgt:true})}else{if(this.options.objects3D){var x=[];var D={};for(var E=0;E<F.length;E++){x=x.concat(F[E].options.item2Load);D[F[E].options.resourceid]=this.options.objectInfos[F[E].options.resourceid];u=B._cleanItem(F[E].options);v.push(u);if(F[E].options.grid.leaves){for(var C=0;C<F[E].options.grid.leaves.length;C++){D[F[E].options.grid.leaves[C]]=this.options.objectInfos[F[E].options.grid.leaves[C]]}}}this.dispatchEvent("onLoadObjects",{objects3D:x,objectInfos:D,filterIds:A,showStoredObjectMgt:e.is(this.options.deactivateStoredObjMgt,"boolean")?!this.options.deactivateStoredObjMgt:true})}}}}if(y===false){this._commandProxy.loadStoredObjects({selectedNodes:v,showStoredObjectMgt:e.is(this.options.deactivateStoredObjMgt,"boolean")?!this.options.deactivateStoredObjMgt:true});this._commandProxy.destroy()}},_onCellClick:function(s,t){if(t===undefined){return}switch(t.dataIndex){case"padStoreHideShow":s.stopPropagation();s.preventDefault();this.options.availableObjects.withTransactionUpdate(function(){var v=!t.nodeModel.options.grid.detached;t.nodeModel.updateOptions({grid:{detached:v}});if(e.is(t.nodeModel.options.item2Load,"array")){for(var u=0;u<t.nodeModel.options.item2Load.length;u++){t.nodeModel.options.item2Load[u].hidden=v}}});break}}});return b});define("DS/PADUtils/commands/SwitchAuthoringIndex",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext","DS/Core/ModelEvents","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(h,f,e,d,a,b,c){var g=f.extend({_context:null,_triggerFromCmd:false,init:function(j){this._parent(j,{});this._context=e.get();this._sessionCBTokens=[];if(a.isAuthoring()){this.setState(true,false)}else{this.setState(false,false)}if(b.getSetting("useIndexAccleration")===false&&(typeof widget!=="undefined"&&widget.getPreference("useIndexAccleration")!==undefined)){this.disable()}else{this.enable()}var k=this;var i=true;this._sessionCBTokens.push(a.subscribe({event:"authoringStateModified"},function(l){if(k._triggerFromCmd===true){k._triggerFromCmd=false}else{if(a.isAuthoring()){k.setState(true,false)}else{k.setState(false,false)}}}));this._sessionCBTokens.push(a.subscribe({event:"useIndexPreferenceModified"},function(l){if(l.useIndexPreference===true){k.enable()}else{k.disable()}}));this.onStateChange(function(){k._triggerFromCmd=false;var m=k.getState(),l;if(m){l=c.PADSession_enabling_authoring_mode}else{l=c.PADSession_disabling_authoring_mode}a.setAuthoringState(m,l)})},_destroy:function(){if(this._sessionCBTokens.length){for(var j=0;j<this._sessionCBTokens.length;j++){a.unsubscribe(this._sessionCBTokens[j])}}this._sessionCBTokens=[]}});return g});define("DS/PADUtils/Utility",["DS/PADUtils/PADSettingsMgt",],function(d){var f=/(\d+)\/(\d+)\/(\d+)@\d+:\d+:\d+:\w+/;function g(i){var h="";if(i==="NULL"){h=""}else{if(f.test(i)){var l=require("DS/WidgetServices/WidgetServices");var k=l.formatDateObj(i);i=k.toUTCString()}var j=Date.parse(i);if(!isNaN(j)){h=new Date(j).toLocaleString(d.getSetting("lang"))}}return h}function b(l,k,i,h){var j=-1;return function(){j++;if(j<=l.length-1){var m=l[j];i(m,k)}else{h()}}}function a(i,h){if(!i){i=""}if(!h){h=""}var j=require("DS/WidgetServices/WidgetServices");return j.compareValue(h,i)}function e(k,j,o){var l="rgba(0, 0, 0, 0)";if(k==="date"){var m=o.substring(0,o.indexOf("T"));var h=m.split("-");var i=[];i.push([h[0],h[1],h[2]].join("/"));i.push([h[0],h[1]].join("/"));i.push(h[0]);var q=true;for(var n=0,p=i.length;n<p&&q;n++){if(typeof j.map[i[n]]!=="undefined"){q=false;l=j.map[i[n]]}}}else{if(typeof j.map[o]!=="undefined"){l=j.map[o]}}return l}var c={compareValue:a,convertDateTime:g,createStepper:b,getBIColor:e};return c});define("DS/PADUtils/PADDataTransform",["UWA/Promise","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSession"],function(l,i,b){var c="2.1";var d="2.2";var g={version:c,results:[],structures:[],viewpoint:[]};function n(s,r){if(s instanceof Array&&r instanceof Array){var p=s.length;if(p===r.length){for(var q=0;q<p;q++){if(s[q]!==r[q]){return false}}return true}else{return false}}else{return false}}function a(p,t){var r=true;for(var q=0;q<p.length;q++){var s=p[q];if(s.id===t.id){r=false}}if(r){p.push(t)}}function e(q,p){if(q.indexOf(p)===-1){q.push(p)}}function j(x,q,u,s,v){var w=UWA.extend({root_path_physicalid:x.slice(0),expand_iter:"-1",intent:"explore_2D"},i.getWebAPI_Options("navigate"),true);if(i.getSetting("globalTypeFiltering")!==true){if(w["q.iterative_filter_query_bo"]){delete w["q.iterative_filter_query_bo"]}if(i.getSetting("dynamic_authorized_types")===true){w.no_type_filter_bo=i.getSetting("no_type_filter_bo")}else{w.type_filter_bo=i.getSetting("type_filter_bo")}}var p=false;var r;if(q&&q.isNGFilter===true){if(q.sequence_filter){w.sequence_filter=q.sequence_filter}if(q.config_filter){w.config_filter=q.config_filter}if(q.CVQuery){p=true;r=UWA.clone(q.CVQuery);delete r.max_count_path;var t=i.getWebAPI_Options("navigate");r.select_bo=t.select_bo;r.select_rel=t.select_rel;r.compute_select_bo=t.compute_select_bo;if(r.union.expand){r.union.expand[0].root_path_physicalid=w.root_path_physicalid}else{r.union.expand3d[0].root_path_physicalid=w.root_path_physicalid}}}require(["DS/PADUtils/PADWSAccess"],function(y){if(p===true){y.multiexpand({enopad_webapis:false,data:r,onComplete:function(B){try{var z=typeof B==="string"?JSON.parse(B):B;u(z,v)}catch(A){s(A,x,v)}},onFailure:function(z){s(z,x,v)}})}else{y.navigate({enopad_webapis:i.getSetting("enopad_webapis"),data:w,onComplete:function(B){try{var z=typeof B==="string"?JSON.parse(B):B;u(z,v)}catch(A){s(A,x,v)}},onFailure:function(z){s(z,x,v)}})}})}function o(p){var q={};p.forEach(function(r){if(r.name==="resourceid"||r.name==="physicalid"){q.resourceid=r.value}else{if(r.name==="did"){q.did=r.value}else{if(r.name==="ds6w:globalType"){q.globalType=r.value}else{if(r.name==="ds6w:cadMaster"){q.cadMaster=r.value}}}}});return q}function m(s,q){var t={},p=true;for(var r=0;r<s.length&&p;r++){if(s[r].structure[0].id===""+q){p=false;t={toCreate:false,rootStructure:s[r].structure}}}if(p===true){s.push({structure:[]});t={toCreate:true,rootStructure:s[s.length-1].structure}}return t}function h(r,u){var t=undefined,q=true;for(var p=0;p<r.length&&t===undefined&&q;p++){if(r[p].id===""+u[0]){if(u.length>1){var s=u.slice(1);t=h(r[p].children,s)}else{q=false;t=null}}}if(t===undefined&&q){t=r}return t}function k(r,p){var q=[];for(var s=0;s<p.length;s++){q.push(r[p[s]])}return q}var f={buildDataForSetTypes:function(I,Q,v,u){u=u===undefined?true:u;var K=UWA.clone(g);var D,p={},r=[],x={},R={},B=false;var H=b.determineAuthoredFlag();var y=i.getSetting("ofwCadMaster");if(y){K.version=d}function N(S){if(r.indexOf(S.getID())===-1){r.push(S.getID())}var T=S.getRelationID();if(T&&T.length!==0&&r.indexOf(T)===-1){r.push(T)}if(S.isRoot()){if(S.options.sequence_filter){x[S.getID()].filter.sequence_filter=S.options.sequence_filter;x[S.getID()].filter.isNGFilter=true;B=true}if(S.options.config_filter){x[S.getID()].filter.config_filter=S.options.config_filter;x[S.getID()].filter.isNGFilter=true;B=true}}if(S.options.CVQuery){x[S.getID()].filter.CVQuery=S.options.CVQuery;x[S.getID()].filter.isNGFilter=true;B=true}if(y){R[S.getID()]=S.options.padgrid["ds6w:cadMaster"]}}for(D=0;D<I.length;D++){var t=I[D].getRoot();if(x[t.getID()]===undefined){x[t.getID()]={paths:[],filter:{isNGFilter:false}}}x[t.getID()].paths.push(I[D].getOccurencePath(N))}function s(S){var T=[];for(var U=0;U<S.length;U++){T.push(p[S[U]])}return T}function A(S){var V=null;for(var U=0;U<S.length;U++){var aa=S[U];var T=S.slice(0,U+1);var W=null;if(T.length===1){var ac=m(K.structures,aa);V=ac.rootStructure;if(ac.toCreate===true){W=V}}else{W=h(V,T)}if(W){var ab=s(T);var Z=true,Y=undefined;if(Math.abs(ab.length%2)===1){var X=Q.getNodeByOccurencePath(ab);if(X){var ad=X.getOccurencePath();if(n(ad,ab)){if(X&&!X.options.isPADHidden!==Z){Z=!X.options.isPADHidden}if(X&&X.isSelected()){Y=true}}}}W.push({id:""+aa,show:Z,select:Y,children:[]})}}}function q(S,W,V){console.warn("Completion of Open scope failed. Open the data of the view");if(S){console.warn(S)}for(var T=0;T<r.length;T++){var U={id:r[T],phid:r[T]};if(y){U.CADOrigin=R[r[T]]}a(K.results,U);p[r[T]]=r[T]}for(var X=0;X<W.length;X++){A(W[X])}V()}function P(T,Y){if(T.results){var X="";for(var U=0;U<T.results.length;U++){var S=T.results[U];if(S.hasOwnProperty("attributes")){var V=o(S.attributes);var W={id:X+V.did,phid:V.resourceid,};if(y){W.CADOrigin=V.cadMaster}K.results.push(W);p[X+V.did]=V.resourceid}else{if(S.hasOwnProperty("path")){A(S.path)}}}Y()}else{q(null,Y)}}if(u){var G=[];var C=Object.getOwnPropertyNames(x);if(B){for(var D=0;D<C.length;D++){var F=new l(function(S){j(x[C[D]].paths,x[C[D]].filter,P,q,S)});G.push(F)}}else{var w=new l(function(U){var T=[];for(var S=0;S<C.length;S++){T=T.concat(x[C[S]].paths)}j(T,null,P,q,U)});G.push(w)}console.log("xform: promises.length="+G.length);var z=new l(function(S){l.all(G).then(function(){v(Q,K);S()})});G.push(z)}else{var C=Object.getOwnPropertyNames(x);for(var O=0;O<C.length;O++){var J=x[C[O]].paths;for(var M=0;M<J.length;M++){var E=J[M];for(var L=0;L<E.length;L++){if(p[E[L]]===undefined){K.results.push({id:E[L],phid:E[L]});p[E[L]]=E[L]}}A(E)}}v(Q,K)}},};return f});define("DS/PADUtils/XNavSettings",["UWA/Class","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADSettingsMgt"],function(a,i,c,f){var l={},g=null,b=["ds6w:label","ds6wg:revision","ds6w:cadMaster","ds6w:type","ds6w:description","ds6w:reserved","ds6w:modified","ds6w:created","ds6w:identifier","ds6w:reservedBy","ds6w:responsible"],k=[],e=null,j=["bi_color","selection","hide_show","find_in_ctx","instanceName","instanceMatrix","ds6w:cadMaster","thumbnail"];function h(n){if(g===null||n===true){if(l.defaultAttributes&&f.getSetting("columnParametrization")===true){g={tree:"",available_columns:[],columns4BI:[]};l.defaultAttributes.forEach(function(o){var p=o.name.split("/");o.name=p[p.length-1];if(o.tree===true){g.tree=o.name}else{g.available_columns.push(o.name)}if(o.hardcoded!==true){f.options.webapi_options.fetch.select_predicate.push(o.name);f.options.webapi_options.navigate.select_bo.push(o.name)}})}else{if(l.available_attr){g={tree:"",available_columns:[],columns4BI:[]};l.available_attr.forEach(function(o){var p=o.name.split("/");o.name=p[p.length-1];if(o.tree===true){g.tree=o.name}else{g.available_columns.push(o.name)}f.options.webapi_options.fetch.select_predicate.push(o.name);if(o.cv_type==="select_ds6w_facet"){o.cv_type="select_bo"}if(o.cv_type){f.options.webapi_options.navigate[o.cv_type].push(o.name)}else{if(o.name!=="svg"){f.options.webapi_options.navigate.select_bo.push(o.name)}}})}}if(l.columnDefinition){g={tree:"",available_columns:[],columns4BI:[]};e={};l.columnDefinition.forEach(function(o){if(o.ds6w){e[o.ds6w]=o.dataIndex;if(o.dataIndex==="tree"){g.tree=o.ds6w}else{g.available_columns.push(o.ds6w)}f.options.webapi_options.fetch.select_predicate.push(o.ds6w)}else{g.available_columns.push(o.dataIndex)}})}if(k.length){for(var m=0;m<k.length;m++){if(g.available_columns.indexOf(k[m])===-1){g.available_columns.push(g.available_columns,k[m])}}}}}var d=a.singleton({loadSettingsSync:function(m){l=m;h()},loadSettings:function(m){var n=c.getWebappsAssetUrl(m.module,m.file);i.request(n,{onComplete:function(p){var o=UWA.is(p,"string")?JSON.parse(p):p;l=o.view_settings?o.view_settings:o;h();m.onComplete()}})},setAvailableAttr:function(n,m){l.available_attr=n;h(m)},getSetting:function(m){return l[m]},getAvailableColumns:function(){return g},addAsyncAttributes:function(n){if(g){for(var m=0;m<n.length;m++){if(g.available_columns.indexOf(n[m])===-1){g.available_columns.push(g.available_columns,n[m])}}}k.push.apply(k,n)},getAdditionalColumns:function(){return k},addAvailableColumn:function(o,p,n){if(g&&g.available_columns){g.available_columns.push(o);if(p){if(o!=="instanceMatrix"){f.options.webapi_options.fetch.select_predicate.push(o);f.options.webapi_options.navigate.select_bo.push(o)}else{f.options.webapi_options.fetch.select_predicate.push("matrixtxt");f.options.webapi_options.navigate.select_bo.push("matrixtxt")}var m=f.getSetting("filterNls");m.push(o);f.setSetting("filterNls",m);if(n){g.columns4BI.push(o)}}}},removeAvailableColumn:function(n){if(g&&g.available_columns&&g.available_columns.indexOf(n)!==-1){g.available_columns.splice(g.available_columns.indexOf(n),1);var m=f.options.webapi_options.fetch.select_predicate.indexOf(n);var o=f.options.webapi_options.navigate.select_bo.indexOf(n);if(m!==-1){f.options.webapi_options.fetch.select_predicate.splice(m,1)}if(o!==-1){f.options.webapi_options.navigate.select_bo.splice(o,1)}}},removeBIColumn:function(n){if(g&&g.columns4BI&&g.columns4BI.indexOf(n)!==-1){if(g&&g.available_columns&&g.available_columns.indexOf(n)!==-1){g.available_columns.splice(g.available_columns.indexOf(n),1);var m=f.options.webapi_options.fetch.select_predicate.indexOf(n);var o=f.options.webapi_options.navigate.select_bo.indexOf(n);if(m!==-1){f.options.webapi_options.fetch.select_predicate.splice(m,1)}if(o!==-1){f.options.webapi_options.navigate.select_bo.splice(o,1)}g.columns4BI.splice(g.columns4BI.indexOf(n),1)}}},updateSettings:function(n){for(var m=0;m<n.length;m++){if(g&&g.available_columns&&g&&g.available_columns.indexOf(n[m])===-1){d.addAvailableColumn(n[m],true)}}},getAttributeMap:function(){return e},buildDefaultColumns:function(p){var n=[];for(var m=0;m<l.defaultAttributes.length;m++){var o={dataIndex:l.defaultAttributes[m].tree?"tree":l.defaultAttributes[m].name,minWidth:50,xnav_options:{name:l.defaultAttributes[m].name,layout:{removable:true,hidden:false},exportable:{lock:false,value:true},hardcoded:l.defaultAttributes[m].hardcoded}};switch(l.defaultAttributes[m].name){case"hide_show":case"find_in_ctx":o.width=40;o.minWidth=40;o.maxWidth=40;o.xnav_options.exportable.lock=true;o.xnav_options.exportable.value=false;break;case"ds6w:cadMaster":o.width=50;break;case"ds6w:label":o.minWidth=100;o.width=250;o.xnav_options.exportable.lock=true;break}if(o.dataIndex==="tree"){o.xnav_options.layout.removable=false}n.push(o)}require(["DS/PADUtils/PADPredicatesNls"],function(q){q.updateColumnsWithNLS(n,p)})},isHardcodedColumn:function(n){var o=false;if(j.indexOf(n)!==-1){o=true}if(l.defaultAttributes){for(var m=0;m<l.defaultAttributes.length&&o===true;m++){if((l.defaultAttributes[m].name===n&&l.defaultAttributes[m].hardcoded===true)){o=true}}}return o}});return d});define("DS/PADUtils/PADDocTypeVerify",["DS/PADUtils/views/PADAlert","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,c){var e="DOCUMENTS";var d={authorized_types:[e],unauthorized_types:[],displayNotification:function(f){var g=c.replace(c.attachDocumentInvalidType,{type:f});b.displayNotification({msg:g,eventID:"error"})}};var a={isValidDocuments:function(m,l){var k=[];var g={};var f=[];for(var h=0;h<m.length;h++){var j=m[h];if(d.authorized_types.indexOf(j.objectType)!==-1){f.push(j)}else{if(d.unauthorized_types.indexOf(j.objectType)!==-1){d.displayNotification(j.displayType)}else{if(k.indexOf(j.objectType)==-1){k.push(j.objectType);g[j.objectType]=j.displayType}}}}if(k.length>0){require(["DS/PADUtils/PADWSAccess"],function(i){i.getTypesHierarchy({types:k,onComplete:function(o){var v=UWA.is(o,"string")?JSON.parse(o):o;for(var q=0;q<v.types_hierarchies.length;q++){var u=false;var n=v.types_hierarchies[q];for(var p=0;p<n.hierarchy.length;p++){var t=n.hierarchy[p];if(t===e){u=true}}if(u){d.authorized_types.push(n.type)}else{d.unauthorized_types.push(n.type);d.displayNotification(g[n.type])}}f=[];for(var s=0;s<m.length;s++){var r=m[s];if(d.authorized_types.indexOf(r.objectType)!==-1){f.push(r)}}l(f)},onFailure:function(n){l([])}})})}else{l(f)}}};return a});define("DS/PADUtils/commands/PADOpenInCADBaseCmd",["DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADWebInWinServices"],function(b,a,d){var c=b.extend({_context:null,init:function(e){this._parent(e);if(typeof widget!=="undefined"){this._context=widget.getValue("addinmode")}},getSelection:function(e){console.error("This method must be overloaded to give your selection back");console.error("Data given in input of the callback must respect 'setTypes' schema")},execute:function(){function e(f){if(UWA.is(f.setObject,"object")){a.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:f.setObject.objectId}]}))}else{a.publish("webinwin:web:notification",JSON.stringify({operation:"open/setTypes",operationVersion:"1.0",content:f}))}}this.getSelection(e)},isAvailable:function(){return d.isWebInWinContext()}});return c});define("DS/PADUtils/views/PADColorSet",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Scroller","UWA/Class/Collection","UWA/Class/View","DS/PADUtils/views/PADColorView","text!DS/PADUtils/assets/PADColor.json"],function(g,d,i,h,k,j,c,e,f,a,l,b){var m=a.extend(k,{name:"padcolorset",className:"padcolorset",tagName:"div",defaultOptions:{mono_sel:true,objects_per_row:9,custom_color_rows:2,preset_color_rows:5,selected_color:{background_color:"#ffffff",color:"#000000"}},addCustomColors:function(o){var t=localStorage.getItem("ENOPAD_CustomColors");var s={background_color:"#ffffff",color:"#ffffff",custom:true,empty:true};if(t){t=JSON.parse(t);var p=1;t.forEach(function(u){u.custom=true;u.empty=false;u.label="custom_"+p;p+=1})}else{t=[]}var q=this.getOption("objects_per_row")*this.getOption("custom_color_rows");var r=q-t.length;var n;for(n=0;n<r;n++){t.push(UWA.clone(s))}for(n=0;n<q;n++){t[n].label="custom_"+(n+1)}return o.concat(t)},initCollection:function(n){var o=JSON.parse(b);o=this.addCustomColors(o);this.collection=new f(o);if(n){this.collection.forEach(function(p){if(p._attributes.color===n.color&&p._attributes.background_color===n.background_color){p._attributes.selected=true}})}},setup:function(n){var o=n||{};this._logger=c.getLogger(m);this._logger.log("setup");this.selected_color=o.selected_color;this.initCollection(o.selected_color);this._parent(o)},render:function(){this._logger.log("render");var p=this,n=0,o=UWA.createElement("div",{"class":this.getClassNames("_container")}).inject(this.container),q=UWA.createElement("div",{"class":"padcolorset_row"}).inject(o);this.collection.forEach(function(s){if(n===p.getOption("objects_per_row")){q=UWA.createElement("div",{"class":"padcolorset_row"}).inject(o);n=0}var r=new l({model:s,selected_color:p.selected_color,events:{select:p._onSelect.bind(p)}});r.render().inject(q);n++});return this},_onSelect:function(p){this._logger.log("_onSelect "+p);if(this.getOption("mono_sel")===true){var o=this.collection.where({selected:true}),n=null;o.forEach(function(q){if(q.get("label")!==p){q.set("selected",false)}else{n=q}});if(n){this.dispatchEvent("select",n.toJSON())}}},reset:function(){var o=this.collection.where({selected:true}),n=null;if(o.length>0){o.forEach(function(p){p.set("selected",false)})}this.dispatchEvent("select","")},updateCollection:function(p){var q=0;var o=0;var n=this.getOption("objects_per_row")*this.getOption("preset_color_rows");this.collection.forEach(function(r){if(q>=n){if(r.get("background_color")!==p[o].background_color){r.set("background_color",p[o].background_color)}if(r.get("color")!==p[o].color){r.set("color",p[o].color)}o+=1}q+=1})},updateCustomColors:function(){var q=this.addCustomColors([]),o=this.getElements(".padcolorview_custom_cell"),p=this.getElements(".padcolorview_custom_content");var n=0;o.forEach(function(r){if(n<q.length){r.setStyle("background-color",q[n].background_color);if(!q[n].empty){if(r.hasClassName("padcolorview_empty_cell")){r.removeClassName("padcolorview_empty_cell");r.addClassName("padcolorview_active_cell");r.setStyle("border-color","#000000")}}n=n+1}});n=0;p.forEach(function(r){if(n<q.length){r.setStyle("color",q[n].color);n=n+1}});this.updateCollection(q)}});return m});define("DS/PADUtils/PADSecurityCtxConverter",["UWA/Class","UWA/Promise","DS/PADUtils/views/PADAlert"],function(b,e,a){function g(n,l){var j=[];for(var k=0;k<n.collabspaces.length;k++){var o=n.collabspaces[k];for(var h=0;h<o.couples.length;h++){var m=l.extractCouple(o.couples[h]);if(j.indexOf(m.org)===-1){j.push(m.org)}}}return(j.length===1)}var f="●";var d=" ";var c=b.singleton({init:function(h){this._parent(h)},buildSecurityContext:function(i,h,j){return"ctx::"+j+"."+h+"."+i},buildDisplayString:function(j,h,k,i){if(i){return j+d+f+d+k}else{return j+d+f+d+h+d+f+d+k}},extractCouple:function(k){var m="",l="",j="";for(var h in k){var i=k[h];switch(h){case"organization":m=i.name;break;case"role":l=i.name;if(i.nls){j=i.nls}else{j=l}break}}return{org:m,role:l,roleNls:j}},prepareForStorage:function(A){var k="ctx:";var m=A.pid;var r=[];var y,l,h,C;for(var B in A.preferredcredentials){var n=A.preferredcredentials[B];switch(B){case"collabspace":y=n.name;l=n.title?n.title:y;break;case"organization":h=n.name;break;case"role":C=n.name;break}}k=this.buildSecurityContext(l,h,C);var u=false;var j=g(A,this);for(var v=0;v<A.collabspaces.length;v++){var w=A.collabspaces[v];for(var s=0;s<w.couples.length;s++){var o=this.extractCouple(w.couples[s]);var x=this.buildSecurityContext(w.name,o.org,o.role);var p=w.title?w.title:w.name;var t=this.buildDisplayString(p,o.org,o.roleNls,j);var q={csName:p,label:t,value:x};if(k===x){q.isDefault=true;u=true}r.push(q)}}if(!u&&r.length){var z=r[0];z.isDefault=true;k=z.value}return{userId:m,securityContext:k,cspaces:r}},getSecurityContext:function(h){var l=h.callback,k=h.tenant;var i=this;var j=typeof widget!=="undefined"?widget.lang:"en";require(["DS/PADUtils/PADWSAccess"],function(n){var m=new e(function(p,o){n.getscandcollab({tenant:k,onComplete:function(s){var r=UWA.is(s,"string")?JSON.parse(s):s;var q=i.prepareForStorage(r);p({securityContext:q.securityContext,securityContextList:q.cspaces})},onFailure:function(q){o(q)}})});m.then(function(o){l(o)})["catch"](function(o){l(null)})})},setSecurityContext:function(h){if(h){require(["DS/PADUtils/PADUtilsServices"],function(k){var l=k.getPlatformId();var i=JSON.parse(sessionStorage.getItem("PADSecurityCtx_"+l));var j=h.replace("ctx::","");if(i!==j){sessionStorage.setItem("PADSecurityCtx_"+l,JSON.stringify(j))}})}}});return c});define("DS/PADUtils/PADUtilsServices",["i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Promise","DS/Logger/Logger","UWA/Utils/InterCom","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADDataTransform","DS/PADUtils/views/PADAlert","DS/PADUtils/PADSecurityCtxConverter","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/PADContext","DS/PlatformAPI/PlatformAPI","require"],function(j,a,g,x,n,m,i,k,p,t,z,o,s,f,l){var e="MAP-CATCDVEAP";var C=x.getLogger("DS/PADUtils/PADUtilsServices"),y,r,h,v,u=null,d=null,q={settypes_params:null},w=false,c=false,b=false,B={registrationOpts:function(){var D={title:j.ENOPAD_title,mode:"furtive",default_with_precond:true,widget_id:widget.id,app_socket_id:"enopad_"+widget.id,idcard_activated:false,advanced_search:{showByDefault:false},tenant:A.getPlatformId()};return D},dropdata_from_node:function(E,D){var F=[E.options.type];if(D&&D[E.options.type]){F=D[E.options.type]}return{envId:A.getPlatformId(),serviceId:"3DSpace",contextId:k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):undefined,objectId:E.getID(),objectType:E.options.type,objectTaxonomies:F,displayName:E.options.display?E.options.display:E.getLabel(),displayType:E.options.grid["ds6w:type"],path:E.getOccurencePathWithType?E.getOccurencePathWithType():undefined}},get_current_tenant_idx:function(F){if(F){var D=F;if(!UWA.is(r)||v[r].platformId!==D){for(var E=0;E<v.length;E++){if(v[E].platformId===D){r=E;break}}}}else{if(typeof widget!=="undefined"&&y!==widget.getValue("x3dPlatformId")){y=widget.getValue("x3dPlatformId")}if(UWA.is(y)){var D=y;if(!UWA.is(r)||v[r].platformId!==D){for(var E=0;E<v.length;E++){if(v[E].platformId===D){r=E;break}}}}}if(!UWA.is(r)){r=0}return r},set_current_tenant:function(D){y=D},set_current_security_ctx:function(D){h=D;var E="DS/PADUtils/PADSecurityCtxConverter";require([E],function(F){F.setSecurityContext(D)})},_getSecurityContext:function(E){var D=E.user,H=E.callback,G=E.tenant;var F="DS/PADUtils/PADSecurityCtxConverter";require([F],function(I){I.getSecurityContext({user:D,callback:H,tenant:G})})},fillSecurityPreferences:function(D){function F(I){b=false;if(I){if(I.securityContext!==""&&I.securityContextList.length>0){if(D.padsecurityctx&&D.padsecurityctx.length!==0){k.updateSecuritySettings(E,G,D.padsecurityctx,I.securityContextList,D.withPreference)}else{var H=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):I.securityContext;k.updateSecuritySettings(E,G,H,I.securityContextList,D.withPreference)}if(D.resolve){D.resolve()}}else{if(I.securityContextList.length===0){k.setSetting("noSecurityContext",true)}}}}if(widget===undefined){throw new Error("widget variable isn't defined")}if(!D.user){D.user=A.getUser()}if(b===false&&D.dynamicUpdate!==true){b=true;var G=A.getTenantsPreference(),E;if(D.tenant){E=D.tenant;widget.setValue("x3dPlatformId",E);widget.setValue("pad_tenant",E)}else{if(widget.getValue("x3dPlatformId")){E=widget.getValue("x3dPlatformId")}else{E=G[0].value;widget.setValue("x3dPlatformId",E);widget.setValue("pad_tenant",E)}}this._getSecurityContext({user:D.user,callback:F,tenant:E})}else{if(D.dynamicUpdate==true){this._getSecurityContext({user:D.user,callback:F,tenant:D.tenant})}}}},A={getPCSPrefix:function(){return typeof widget==="undefined"?"ODTFallbackPrefix":widget.id+"_"+widget.title},dropdata_from_selected_nodes:function(D){var E={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:A.getWidgetId(),data:{items:[]}};D.forEach(function(F){E.data.items.push(B.dropdata_from_node(F))});return E},contentOpenWith:function(E,F){var D=[];E.forEach(function(G){if(D.indexOf(G.options.type)===-1){D.push(G.options.type)}});require(["DS/PADUtils/PADTypesMgt"],function(G){G.retrieveHierarchy(D,function(H){var I={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:A.getWidgetId(),data:{items:[]}};E.forEach(function(J){I.data.items.push(B.dropdata_from_node(J,H))});F(I)})})},dropdata_from_selected_ids:function(D){var E={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOPSTR_AP",widgetId:A.getWidgetId(),data:{items:[]}};D.forEach(function(F){E.data.items.push({envId:A.getPlatformId(),serviceId:"3DSpace",contextId:k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):undefined,objectId:F.physicalid,objectType:F.type,displayType:F.displayType,displayName:F.label})});return E},retrieveDroppedDataType:function(H){C.log("retrieveDroppedDataType");var M="unknown";var E={};var G=this,D;var F=UWA.is(H.dataTransfer.types.indexOf,"function")?"indexOf":"contains",J="";var N=["text/searchitems","text/plain","Text"];for(var L=0;L<N.length&&J==="";L++){var K=H.dataTransfer.types[F](N[L]);if((UWA.is(K,"number")&&K>=0)||(UWA.is(K,"boolean")&&K===true)){J=N[L]}}if(J!==""){D=H.dataTransfer.getData(J);try{E=JSON.parse(D);if(E.protocol==="3DXContent"){M=E.protocol}}catch(I){C.log("Unknown data format")}}else{C.log("Unknown data type")}return M},deserializeDroppedData:function(H){var G={data:{items:[]}};var F=UWA.is(H.dataTransfer.types.indexOf,"function")?"indexOf":"contains",I="";var L=["text/searchitems","text/plain","Text"];for(var K=0;K<L.length&&I==="";K++){var J=H.dataTransfer.types[F](L[K]);if((UWA.is(J,"number")&&J>=0)||(UWA.is(J,"boolean")&&J===true)){I=L[K]}}var D;if(I!==""){D=H.dataTransfer.getData(I);try{G=JSON.parse(D)}catch(E){}}return G},retrieveDroppedData:function(N,M,P){M=M===undefined?true:M;C.log("retrieveDroppedData");function F(R,Q){require(["DS/PADUtils/views/PADAlert"],function(S){S.displayNotification({msg:j.replace(j.get("unsupported_type"),{type:R,name:Q}),eventID:"warning"})})}var G={};var E=[];var L=this;G=A.deserializeDroppedData(N);if(k.getSetting("accept_all_types")===true||P===true){C.log("Accept all types")}else{var O=k.getSetting("authorized_types"),K=0;if(UWA.is(O,"array")){if(UWA.is(G.data)&&UWA.is(G.data.items,"array")&&G.data.items.length>0){do{var H=G.data.items[K].objectType;if(G.data.items[K].path&&G.data.items[K].path.length>0){var D="WITHOUT_CONTEXT";if(N){D=N.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT"}var J=1;if(D==="WITHOUT_CONTEXT"){J=G.data.items[K].path.length}if(G.data.items[K].path[J-1].type){H=G.data.items[K].path[J-1].type}}if(O.indexOf(H)===-1){C.warn("Unsupported type ["+H+"]");if(M){var I=(G.data.items[K].displayType)?G.data.items[K].displayType:G.data.items[K].objectType;F(I,G.data.items[K].displayName)}E=E.concat(G.data.items.splice(K,1))}else{K++}}while(K<G.data.items.length)}}else{C.warn("Unknown property authorized_types")}}return{unserializedData:G,unsupportedObjects:E}},retrieveDroppedDataAsync:function(J,K,D,G){D=D===undefined?true:D;C.log("retrieveDroppedDataAsync");function E(M,L){require(["DS/PADUtils/views/PADAlert"],function(N){N.displayNotification({msg:j.replace(j.get("unsupported_type"),{type:M,name:L}),eventID:"warning"})})}var I=A.deserializeDroppedData(J);var F=[];var H=this;if(k.getSetting("accept_all_types")===true||G===true){C.log("Accept all types");K({unserializedData:I,unsupportedObjects:F})}else{require(["DS/PADUtils/PADTypesMgt"],function(M){var L=M.retrieveAuthorizedObjects({notifPerObjects:true,displayNotif:false,dnd_event:J,unserializedData:I,version:"2.0",callback:function(N){K({unserializedData:I,unsupportedObjects:N.unauthorized_objects,authorized_objects:N.authorized_objects,source_data:N.source_data,authorizedWithKind:N.authorizedWithKind})}})})}},getTenantsPreference:function(){var D=[];if(!UWA.is(v,"array")){throw new Error("Platform services not initialize yet")}v.forEach(function(E){D.push({label:E.displayName,value:E.platformId})});return D},getTenantId:function(){console.warn("Deprecated method. Should use getPlatformId()");return A.getPlatformId()},updatePlatformId:function(D){if(D){if(typeof widget!=="undefined"){widget.setValue("x3dPlatformId",D);widget.setValue("pad_tenant",D)}B.set_current_tenant(D);k.setSetting("x3dPlatformId",D);k.setSetting("pad_tenant",D)}},get3DSearchUrl:function(){if(!UWA.is(v,"array")){throw new Error("Platform services not initialize yet")}var D=B.get_current_tenant_idx();var E="/federated";return v[D]["3DSearch"].indexOf(E,v[D]["3DSearch"].length-E.length)===-1?v[D]["3DSearch"]+E:v[D]["3DSearch"]},get3DSpaceUrl:function(E){if(!UWA.is(v,"array")){throw new Error("Platform services not initialize yet")}var D=0;if(E){D=B.get_current_tenant_idx(E)}else{D=B.get_current_tenant_idx()}if(v[D]["3DSpace"]===undefined){console.error("No 3DSpace URL available for this tenant")}return v[D]["3DSpace"]},getPlatformURL:function(E,F){if(!UWA.is(v,"array")){throw new Error("Platform services not initialize yet")}var D=0;if(F){D=B.get_current_tenant_idx(F)}else{D=B.get_current_tenant_idx()}if(v[D][E]===undefined){console.error("No "+E+" URL available for this tenant. Returning 3DSpace URL as failsafe");return A.get3DSpaceUrl(F)}else{return v[D][E]}},setOption:function(D,E){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.setSetting");k.setSetting(D,E)},getOption:function(D){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.getSetting");k.getSetting(D)},getGrantedRoles:function(D){m.getGrantedRoles(function(E){D(E)})},app_initialization:function(K,F,J){J=J===undefined?true:J;C.log("app_initialization");if(!UWA.is(K,"function")){throw new Error("Invalid callback for the PAD app initialization")}var H=require("DS/PADUtils/PADProbes");var D=H.createProbe("_getPlatformServices");var G=(typeof widget!=="undefined"&&widget.data!=null&&widget.data.addPlatformPref!=null)?widget.data.addPlatformPref:true;var E=this.getUser();if(undefined!==F){D.end();D=null;v=F;if(k.with_security_context===true){B.fillSecurityPreferences({user:E,withPreference:J})}else{var I=A.getTenantsPreference(),L=typeof widget!=="undefined"&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):I[0].value;if(G==true&&J){k.updateTenantSettings(L,I)}}K.call(null)}else{m.getPlatformServices({onComplete:function(N){D.end();D=null;v=N;if(k.with_security_context===true){B.fillSecurityPreferences({user:E,withPreference:J})}else{var O=A.getTenantsPreference(),M=typeof widget!=="undefined"&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):O[0].value;if(G==true&&J){k.updateTenantSettings(M,O)}}K({success:true})},onFailure:function(M){D.end();D=null;C.error("Cannot retrieve the Platform Services");K({success:false})}})}},in_apps_search:function(E){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADUtilsServices.inAppsSearch()");var F=UWA.extend(B.registrationOpts(),E);var D=new n.Socket(F.app_socket_id,{dispacthRetryInterval:0});if(E.debug_mode===true){D.setDebugMode(true)}UWA.is(E.parent_window)?D.subscribeServer("SearchComServer",window):D.subscribeServer("SearchComServer");D.dispatchEvent("RegisterContext",F);if(UWA.is(E.context_name)){F.context_title=E.context_name}var G=[];F.default_search_criteria=E.fts_value;D.dispatchEvent("InContextSearch",F);D.addListener("Selected_Objects_search",function(H){G=H});D.addListener("closeTransient",function(H){if(H.command_id==="in_app_ok"){E.callback.call(null,G)}else{if(H.command_id==="in_app_apply"){if(E.apply){E.apply.call(null,G)}else{E.callback.call(null,G)}}else{if(E.cancel){E.cancel.call(null)}}}D.dispatchEvent("UnregisterContext",{widget_id:F.widget_id})})},inAppsSearch:function(E){var F=UWA.extend(B.registrationOpts(),E);var D=new n.Socket(F.app_socket_id,{dispacthRetryInterval:0});if(E.debug_mode===true){D.setDebugMode(true)}UWA.is(E.parent_window)?D.subscribeServer("SearchComServer",window):D.subscribeServer("SearchComServer");D.dispatchEvent("RegisterContext",F);if(UWA.is(E.context_name)){F.context_title=E.context_name}F.default_search_criteria=E.fts_value;D.dispatchEvent("InContextSearch",F);D.addListener("InContextSearch_Response",function(G){switch(G.selected_command){case"in_app_ok":E.callback.call(null,G);break;case"in_app_apply":if(E.apply){E.apply.call(null,G)}else{E.callback.call(null,G)}break;default:if(E.cancel){E.cancel.call(null)}break}D.dispatchEvent("UnregisterContext",{widget_id:F.widget_id})})},getWidgetId:function(){if(typeof widget!=="undefined"){return widget.id}else{return -1}},getAppId:function(){if(typeof widget!=="undefined"){return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")}},getSharedId:function(){if(typeof widget!=="undefined"){return widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId()}else{return -1}},getPlatformId:function(){return(typeof widget!=="undefined"&&widget.getValue("x3dPlatformId"))?widget.getValue("x3dPlatformId"):k.getSetting("x3dPlatformId")},getRequestLabel:function(){return A.getUserLogin()+"-"+A.getAppId()+"-"+Date.now()},showTransientWidget:function(F,G,E,D){require(["DS/TransientWidget/TransientWidget"],function(H){H.showWidget(F,G,E,D)})},setObject_on_compass:function(H){C.log("setObject_on_compass");var G=this;var F=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";if(!UWA.is(H.nodes_2_open,"array")){throw new Error("setObject_on_compass: Invalid init parameter nodes_2_open")}if(u===null){u=new n.Socket(F);u.subscribeServer("com.ds.compass",window.parent)}var E=null;if(H.nodes_2_open.length===0){u.dispatchEvent("onResetX3DContent",{},F)}else{var D=[];if(E===null){E=require("DS/PADUtils/PADSettingsMgt")}var I=A.dropdata_from_selected_nodes(H.nodes_2_open);u.dispatchEvent("onSetX3DContent",I,F)}},setStructure_4_open_in_cv5:function(G){C.log("setStructure_4_open_in_cv5");var E,H,F=[];if(!UWA.is(G.nodes_2_open,"array")&&!UWA.is(G.completeselection)){throw new Error("setStructure_4_open_in_cv5: Invalid init parameter nodes_2_open")}if(G.completeselection){F=G.completeselection}else{if(k.getSetting("open_in_v5_v2")){F=A.buildOpenJson(G.nodes_2_open,G.selected_paths)}else{var I=[];G.nodes_2_open.forEach(function(K){var J=K.getParents(),L=K.getAllDescendants();for(E=0;E<J.length;E++){H=J[E].getID();if(I.indexOf(H)===-1){F.push({physicalid:H,isroot:J[E].isRoot()});I.push(H)}}if(K.options.grid["ds6w:type"]!=="CgrViewable"&&K.options.grid["ds6w:type"]!=="ThumbnailViewable"){H=K.getID();if(I.indexOf(H)===-1){F.push({physicalid:H,isroot:K.isRoot()});I.push(H)}for(E=0;E<L.length;E++){if(L[E].options.grid["ds6w:type"]!=="CgrViewable"&&L[E].options.grid["ds6w:type"]!=="ThumbnailViewable"){H=L[E].getID();if(I.indexOf(H)===-1){F.push({physicalid:H,isroot:L[E].isRoot()});I.push(H)}}}}})}}var D=JSON.stringify(F);i.publish("setStructure",{structure:D})},buildOpenJson:function(F,D){var J={version:"1",structures:{references:[],connections:[],trees:{}}};var H=[],G="",I=0,M=0,N={};var O,P,K=[];if(D){D.forEach(function(Q){K.push(Q[Q.length-1])})}var L=function(R){var Q=N[R];if(!UWA.is(O[Q.localid])){O[Q.localid]={};if(Q.selected){O[Q.localid].selected=Q.selected}}O=O[Q.localid]};var E=function(R){var Q=R.isSelected();if(K.length){if(K.indexOf(R.getID())!==-1){Q=true}else{Q=false}}return Q};F.forEach(function(S){var R=S.getParents(),V=S.getAllDescendants();var U=[];for(I=0;I<R.length;I++){G=R[I].getRelationID();if(G.length>0&&H.indexOf(G)===-1){J.structures.connections.push({physicalid:G,localid:M+""});N[G]={localid:M,selected:E(R[I])};M++;H.push(G)}G=R[I].getID();if(H.indexOf(G)===-1){J.structures.references.push({physicalid:G,type:R[I].options.type,localid:M+""});N[G]={localid:M,};M++;H.push(G)}}G=S.getRelationID();if(G.length>0&&H.indexOf(G)===-1){J.structures.connections.push({physicalid:G,localid:M+""});N[G]={localid:M,selected:E(S)};M++;H.push(G)}G=S.getID();if(H.indexOf(G)===-1){J.structures.references.push({physicalid:G,type:S.options.type,localid:M+""});N[G]={localid:M};if(S.isRoot()&&E(S)){N[G].selected=E(S)}M++;H.push(G)}for(I=0;I<V.length;I++){G=V[I].getRelationID();if(G.length>0&&H.indexOf(G)===-1){J.structures.connections.push({physicalid:G,localid:M+""});N[G]={localid:M,selected:E(V[I])};M++;H.push(G)}G=V[I].getID();if(H.indexOf(G)===-1){J.structures.references.push({physicalid:G,type:V[I].options.type,localid:M+""});N[G]={localid:M};M++;H.push(G)}}var T=S.getLeaves();if(T.length>0){for(var Q=0;Q<T.length;Q++){O=J.structures.trees;P=T[Q].getOccurencePath();P.forEach(L)}}else{P=S.getOccurencePath();O=J.structures.trees;P.forEach(L)}});return J},open_app:function(F,G){C.log("open_app");var E=this;var D=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";if(u===null){u=new n.Socket(D);u.subscribeServer("com.ds.compass",window.parent)}u.addListener("launchApp",function(H){C.log("Response = "+JSON.stringify(H));if(UWA.is(G,"function")){G(H)}});u.dispatchEvent("onLaunchApp",F,D)},updateWidgetSecPref:function(D){if(UWA.is(v,"array")){B.fillSecurityPreferences(D)}},multiTenantMgt:function(H,L,K,J){var F=[];var D=s.get();var I=[];var E={isMultiTenant:false,isClearView:false};E.tenant=H[0].envId;E.padsecurityctx=H[0].contextId;if(A.getTenantsPreference().length>1&&A.getPlatformId()!==E.tenant){if(L.length===0){F.push(new g(function(N){var M={tenant:E.tenant,padsecurityctx:E.padsecurityctx,resolve:N,withPreference:J};B.fillSecurityPreferences(M)}));if(F){g.all(F).then(function(){t.displayNotification({msg:j.PlatformChange+E.tenant,eventID:"warning"});K(E)})}}else{var G=new o({id:"PadTenantMgt",currentTenant:E,callback:function(M){if(M.isClearView){D.empty();F.push(new g(function(O){var N={tenant:E.tenant,padsecurityctx:E.padsecurityctx,resolve:O,withPreference:J};B.fillSecurityPreferences(N)}));if(F){g.all(F).then(function(){t.displayNotification({msg:j.PlatformChange+E.tenant,eventID:"warning"});K(M)})}}else{K(M)}}})}}else{K(E)}},authoringCtxAvailable:function(){c=true},isAuthoringCtxAvailable:function(){return c},setTypesForOFW:function(D){if(!w){var E=this;i.subscribe("setTypesCallback",function(L){var J=l("DS/PADUtils/PADUtilsServices");if(L.widgetId===J.getWidgetId()){var O=D.getSelectedNodesForOFW();if(O.length>0){var H;if(c){try{var M=l("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");H=M.get()}catch(K){console.warn("CfgAuthoringContext throw an error")}}var N;if(L.appId===e&&O.length===1&&O[0].relatedCADDocs){N=O[0].relatedCADDocs.getSelectedNodes()}if((!N||N.length==0)&&L.appId===e&&O.length===1&&O[0].isRoot()&&!(UWA.is(O[0].options.config_filter)||UWA.is(O[0].options.sequence_filter)||UWA.is(O[0].options.CVQuery))&&(!UWA.is(H)||H.change.id==="")&&k.getSetting("directOpenPCS")===true){var P={objectId:O[0].getID(),envId:A.getPlatformId(),contextId:h,serviceId:"3DSpace"};i.publish("setObject",P);i.subscribe("launchAppCallback",function(Q){if(Q.appId===L.appId&&Q.widgetId===L.widgetId){i.publish("setObject",{objectId:"",envId:E.getPlatformId(),contextId:"",serviceId:"3DSpace"})}});var F={appId:L.appId,widgetId:L.widgetId};i.publish("launchApp",F,function(Q){i.publish("setTypes",q.settypes_params)})}else{var I=L.appId==="MAP-AAAPBYSWX"?false:true;p.buildDataForSetTypes(O,D,function(Q,R){Q._getLastViewpoint(function(U){if(U!==null){R.viewpoint.push(U)}if(H){R.workUnder=H}if(N){var T,X,S;X=new Date().valueOf();for(T=0;T<N.length;T++){if(N[T].options.type==="XCADNonPSBaseRepReference"||N[T].options.type==="Drawing"){X++;S=""+N[T].options.physicalid;R.results.push({id:""+X,phid:S});R.structures.push({structure:[]});R.structures[R.structures.length-1].structure.push({id:""+X,show:true,select:false,children:[]})}}}var W=JSON.stringify(R);var V={appId:L.appId,widgetId:L.widgetId,fileName:"-file",fileContent:W};i.publish("launchApp",V)})},I)}}else{if(k.getSetting("ofwCadMaster")){i.publish("resetTypes")}var G={appId:L.appId,widgetId:L.widgetId};i.publish("launchApp",G,function(Q){i.publish("setTypes",q.settypes_params)})}}});w=true}if(!q.settypes_params){q.settypes_params={widgetId:A.getWidgetId()}}i.publish("setTypes",q.settypes_params)},launchWithSetTypes:function(D,E,F){p.buildDataForSetTypes(D.getSelectedNodes(),D,function(G,H){G._getLastViewpoint(function(I){if(I!==null){H.viewpoint.push(I)}var K=JSON.stringify(H);var J={appId:E,widgetId:A.getWidgetId(),fileName:"-file",fileContent:K};i.publish("launchApp",J,function(L){C.log("Response = "+JSON.stringify(L));if(UWA.is(F,"function")){F(L)}})})})},_setpadsocketToNull:function(){u=null},getUser:function(){if(d===null||d===undefined){d=f.getUser()}return d},getUserLogin:function(){var E=A.getUser();var D="";if(E!==undefined){D=E.login}return D},getUserName:function(){var D=A.getUser();var E="";if(D!==undefined){E=D.firstName+" "+D.lastName}return E},printWindow:undefined,printWindowOpen:function(){return(typeof A.printWindow!=="undefined"&&null!==A.printWindow&&A.printWindow.closed===false)},printhtml:function(D){if(A.printWindowOpen()){A.printWindow.close()}var E=function(){A.printWindow=window.open("","PrintWindow","width=1024, height=768");if(typeof A.printWindow==="undefined"){return}A.printWindow.document.write(D);A.printWindow.document.close();A.printWindow.focus();A.printWindow.print();A.printWindow.close()};setTimeout(E,0)},customizationWindowChange:function(D){require(["DS/ApplicationFrame/CommandsManager"],function(F){var H=D.id;var E=D.open;if(H===undefined||E===undefined){return}var G=F.getCommand(H);if(G){if(!E){G.enable()}else{G.disable()}}})},downloadfile:function(K,G,F){var J=document,E=J.createElement("a"),H=this;if(!UWA.is(K)){return}if(!UWA.is(G)){return}if(!UWA.is(F)){return}F=F||"application/octet-stream";if(navigator.msSaveBlob&&!this.odtMode){return navigator.msSaveBlob(new Blob([K],{type:F}),G)}if("download" in E){var I=URL.createObjectURL(new Blob([K],{type:F}));E.setAttribute("href",I);E.setAttribute("download",G);E.innerHTML="downloading...";J.body.appendChild(E);setTimeout(function(){E.click();J.body.removeChild(E);URL.revokeObjectURL(I)},66);return true}},downloadfileURL:function(E,D){var F=new XMLHttpRequest();F.open("GET",E);F.responseType="blob";F.onload=function(){if(!window.navigator.msSaveBlob){var G=document.createElement("a");G.href=window.URL.createObjectURL(F.response);if(D){G.download=D}G.style.display="none";document.body.appendChild(G);G.click();G=undefined}else{window.navigator.msSaveBlob(F.response,D)}};F.send()},getSecurityContext:function(F){var E=A.getTenantsPreference(),D=typeof widget!=="undefined"&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):E[0].value;B._getSecurityContext({user:this.getUser(),callback:F,tenant:D})},isTouchDevice:function(){if("ontouchstart" in document.documentElement){return true}else{return false}},isCloud:function(){var D;if(D===undefined){D=false;if(typeof widget!=="undefined"){if(widget.getValue("x3dPlatformId")!=="OnPremise"){D=true}}}return D},checkNotIdentity:function(F){var D=true;var H=[1,0,0,0,1,0,0,0,1,0,0,0];var G=F.split(",");for(var E=0;E<12&&D===true;E++){if(H[E]!=parseFloat(G[E])){D=false}}return !D}};k.addEvent("onX3dPlatformId",function(D){B.set_current_tenant(D)});k.addEvent("onPad_security_ctx",function(D){B.set_current_security_ctx(D)});return A});define("DS/PADUtils/commands/RightSidePanel",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","UWA/Promise","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/Utilities/Utils","UWA/Class/Model","DS/PADUtils/PADModelEvents","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(d,j,i,g,e,h,p,o,n){var m="DS/EditPropWidget/EditPropWidget",c="DS/EditPropWidget/constants/EditPropConstants",k="DS/EditPropWidget/models/EditPropModel",f="DS/EditPropWidget/facets/Common/FacetsBase";var l=[];var b=false;if(g.get!==undefined){if(g.get().getEditMode!==undefined){if(g.get().getEditMode()!==true){b=true}}}var a=j.extend({_context:null,_propertiesWdg:null,_xso:null,_readOnly:b,init:function(q){this._parent(q,{});this._context=g.get();var r=this;if(q.arguments.length){q.arguments.forEach(function(t){if(t.ID==="PropertiesReadOnly"&&t.Value==="true"){r._readOnly=true}})}var s=h.debounce(function(){if(r.getState()===true){r._selectionChange()}},100);this.getXSO().onPostAdd(s);this.getXSO().onPostRemove(s);this.getXSO().onEmpty(s);this._buildView();o.subscribe({event:"onOverlayClick"},function(t){if(r.getState()===true){r.toggleState();r.getTriptych().togglePanel("right")}})},_selectionChange:function(){var s=this;var r=this.getXSO().get();var q=new i(function(t){i.all(l).then(function(){if(r.length===1){s._propertiesWdg.initDatas([]);var u="3DSpace";var x=require(k);var w=new x({metatype:"businessobject",objectId:s.getID(r[0]),source:u,tenant:e.getPlatformId()});s._propertiesWdg.initDatas([w])}else{if(r.length===0){s._propertiesWdg.initDatas([])}else{var v=[{metatype:"businessobject",objectId:"fakeid1",source:"3DSpace"},{metatype:"businessobject",objectId:"fakeid2",source:"3DSpace"}];s._propertiesWdg.initDatas(v)}}t()})});l.push(q)},_buildView:function(){var s=this;if(s.getTriptych()){var t=s.getTriptych().getRightPanelContainer().querySelector(".rightSidePanel");if(t&&t.firstElementChild===null){var q=new i(function(u){require([m,c,k,f],function(x,C,w,B){var y=s._context.getPropertiesFacet(),A=[];for(var D=0;D<y.length;D++){var v=y[D];if(d.is(v,"string")&&v==="properties"){A.push(C.FACET_PROPERTIES)}}s._propertiesWdg=new x({className:"enxpropertiestab",setEditButton:!s._readOnly,readOnly:s._readOnly,typeOfDisplay:C.ALL,selectionType:C.NO_SELECTION,warningOnUnsaved:false,facets:A,multiselection:C.MULTISEL_NO,collapseTabs:false,actions:[{name:"action_close_panel",text:n.closeProperties,icon:"close",handler:function(){s.setState(false)}}]});s._context.addEvent("onParentResize",s._propertiesWdg.onResize.bind(s._propertiesWdg));s._context.addEvent("editModeModified",function(F){if(s._propertiesWdg.setReadonlyStatus!==undefined){s._propertiesWdg.setReadonlyStatus(!F)}});s._propertiesWdg.inject(t);if(s.getState()===true){s._selectionChange()}var E=[];for(var D=0;D<y.length;D++){var v=y[D];var z=new i(function(F){var G=v;i.all(E).then(function(){if(d.is(G,"string")&&G==="properties"){s._propertiesWdg.addFacets([]);F()}else{if(d.is(G,"string")&&G==="relations"){var H="DS/ENORIPE_Relations/RelationsTabSettings";require([H],function(J){var L={getPlatformID:function(){return e.getPlatformId()},getServiceID:function(){return"3DSpace"}};var K={isDraggable:true};J.isAvailable(L,K).then(function(M){if(d.is(M,"object")&&d.is(M.facetInfo)){M.facetInfo.options={defaultProfile:"Designer"};s._propertiesWdg.addFacets([M.facetInfo])}else{console.log("facets info is NOT in good format")}F()},function(){console.log("this facet is not available for this context = "+J);F()})},function(J){console.warn("Cannot load "+J.requireModules);F()})}else{if(!G.facet.text){G.facet.text=n[G.facet.name+"_cmd_title"]}if(G.actions&&G.actions.length>0){for(var I=0;I<G.actions.length;I++){G.actions[I].text=n[G.facet.name+G.actions[I].text]}}s._propertiesWdg.addFacets([G]);F()}}})});E.push(z)}u()})});l.push(q)}s.onStateChange(function(){if(s.getState()===true){s._selectionChange()}s.getTriptych().togglePanel("right")})}else{console.log("Triptych not ready yet. Wait for it to complete the side panel");var r=new i(function(u){s.onTriptychReady(s._buildView.bind(s));u()});l.push(r)}},getXSO:function(){throw new Error("This function must be reimplemented")},getID:function(q){throw new Error("This function must be reimplemented")},getTriptych:function(q){throw new Error("This function must be reimplemented")},onTriptychReady:function(){throw new Error("This function must be reimplemented")}});return a});define("DS/PADUtils/views/PADStatusInfos",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/UIKIT/Tooltip","DS/Controls/Loader","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(f,h,g,k,i,c,d,j,a,e,b){var l=g.extend(k,{name:"pad_status",_logger:null,_tooltipInfo:null,init:function(m){var n=m||{};this._logger=c.getLogger(l);this._logger.log("init");this._parent(m);if(m.withProgress){this.elements.container=UWA.createElement("div",{"class":this.getClassNames()+" with_progress"});this.elements.loaderContainer=UWA.createElement("div",{"class":"pad_status_loader_div"}).inject(this.elements.container);this._loader=new a().inject(this.elements.loaderContainer);this.elements.fonticonInfoContainer=UWA.createElement("div",{"class":"pad_status_fonticon_info_div"}).inject(this.elements.container);this.elements.fonticonInfo=UWA.createElement("i",{"class":"fonticon fonticon-info pad_status_span"}).inject(this.elements.fonticonInfoContainer);this._tooltipInfo=new j({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top",trigger:"touch",events:m.events});this.elements.fonticonAttentionContainer=UWA.createElement("div",{"class":"pad_status_fonticon_attention_div"}).inject(this.elements.container);this.elements.fonticonAttention=UWA.createElement("i",{"class":"fonticon fonticon-attention pad_status_span"}).inject(this.elements.fonticonAttentionContainer);this._tooltipAttention=new j({className:this.getClassNames("_tooltipAttention"),target:this.elements.fonticonAttention,position:"top left",trigger:"touch",events:m.events});if(this.getOption("status")){this._tooltipInfo.setBody(this.getOption("status"))}if(this.getOption("renderTo")){this.inject(this.getOption("renderTo"))}if(this.getOption("attention")){this._tooltipAttention.setBody(this.getOption("attention"))}this.showLoader=function(p){if(p){var o=this;this._isloading=true;o._loadingText=p.nlsTooltip;setTimeout(function(){if(o._isloading===true&&o._loader){o._loader.on();o.elements.fonticonInfoContainer.style.display="";o.elements.fonticonAttentionContainer.style.display="none";if(p.fonticon){o._replacedFonticon=p.fonticon;o.elements.fonticonInfo.removeClassName("fonticon-info");o.elements.fonticonInfo.addClassName(p.fonticon)}o._addLoading();if(o._tooltipInfo.isVisible===false){o._tooltipInfo.toggle()}}},p.timeout?p.timeout:0)}else{if(this._loader){this._loader.on();this.elements.fonticonInfoContainer.style.display="";this.elements.fonticonAttentionContainer.style.display="none"}}};this.hideLoader=function(o){this._isloading=false;if(this._loader){this._loader.off();if(o&&o.memoryFull===true){this.elements.fonticonAttentionContainer.style.display="";this.elements.fonticonInfoContainer.style.display="none"}}if(this._tooltipInfo.isVisible===true){this._tooltipInfo.toggle()}this.elements.fonticonInfo.addClassName("fonticon-info");this.elements.fonticonInfo.removeClassName(this._replacedFonticon);this._removeLoading()};this.elements.fonticonAttentionContainer.style.display="none"}else{this.elements.container=UWA.createElement("span",{"class":this.getClassNames()+" fonticon fonticon-info"});this._tooltipInfo=new j({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top left",trigger:"touch",events:m.events});if(this.getOption("status")){this._tooltipInfo.setBody(this.getOption("status"))}if(this.getOption("renderTo")){this.inject(this.getOption("renderTo"))}}},setStatus:function(m){this._tooltipInfo.setBody(m);if(this._isloading){this._addLoading()}},_addLoading:function(){var m=this._tooltipInfo.getBody();var n=UWA.createElement("div",{id:"loadingTooltip",text:this._loadingText});if(m.querySelector("loadingTooltip")===null){n.inject(m)}},_removeLoading:function(){var m=this._tooltipInfo.getBody();var n=m.querySelector("loadingTooltip");if(n!==null){n.remove(n)}}});l.buildStatus=function(o){var n=UWA.createElement("div",{"class":"pad_status_msg"});if(o.tree_content){if(!UWA.is(o.tree_content.nbObjectsSelected)){throw new Error("Invalid status. Parameter nbObjectsSelected missing")}if(o.tree_content.nbObjectsInTree!==undefined){if(o.tree_content.nbObjectsInTree>0){if(o.tree_content.nbObjectsInTree===1){UWA.createElement("div",{text:d.PADStatusInfos_oneObjectInTree}).inject(n)}else{UWA.createElement("div",{text:o.tree_content.nbObjectsInTree+d.PADStatusInfos_nbObjectsInTree}).inject(n)}UWA.createElement("div",{text:o.tree_content.nbObjectsSelected+d.PADStatusInfos_nbObjectsSelected}).inject(n)}else{UWA.createElement("div",{text:d.PADStatusInfos_noObjectInTree}).inject(n)}}else{if(o.tree_content.nbObjectsSelected!=undefined){UWA.createElement("div",{text:o.tree_content.nbObjectsSelected+d.PADStatusInfos_nbObjectsSelected}).inject(n)}else{UWA.createElement("div",{text:d.PADStatusInfos_noObjectInTree}).inject(n)}}var m=b.isAuthoring()?d.PADStatusInfos_authoringModeEnabled:d.PADStatusInfos_authoringModeDisabled;UWA.createElement("div",{text:m,style:"border-top: 1px;"}).inject(n)}var p=e.getTenantsPreference();if(o.Tenant&&p.length>1){UWA.createElement("div",{text:d.PADStatusInfos_Tenant+o.Tenant}).inject(n)}return n};return l});define("DS/PADUtils/commands/PADOpenInCAD",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","DS/ApplicationFrame/Command","DS/PADUtils/commands/PADOpenInCADBaseCmd","DS/PADUtils/PADContext","DS/PADUtils/PADDataTransform","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","require"],function(b,a,i,g,e,f,d,h){var c=i.extend({init:function(j){this._parent(j)},getSelection:function(q){var p=g.get().getPADTreeDocument().getSelectedNodesForOFW();var l=JSON.parse(b);var j=l["openInCAD_"+this._context+"_expand_at_open"]!=undefined?l["openInCAD_"+this._context+"_expand_at_open"]:true;var k;if(d.isAuthoringCtxAvailable()){try{var o=h("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");k=o.get()}catch(n){console.warn("CfgAuthoringContext throw an error")}}if(this._context==="catiav5"&&p.length===1&&p[0].isRoot()&&!(UWA.is(p[0].options.config_filter)||UWA.is(p[0].options.sequence_filter))&&(!UWA.is(k)||k.change.id==="")&&f.getSetting("directOpenPCS")===true){var r={objectId:p[0].getID(),envId:d.getPlatformId(),contextId:f.getSetting("pad_security_ctx")};var m={setObject:{objectId:p[0].getID(),envId:d.getPlatformId(),contextId:f.getSetting("pad_security_ctx")}};q(m)}else{e.buildDataForSetTypes(p,g.get().getPADTreeDocument(),function(s,t){q(t)},j)}},});return c});define("DS/PADUtils/views/PADDnDInvite",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Core/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Utils/Client","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADUtilsServices"],function(d,j,b,f,i,n,a,h,g,m,c){function k(p){var o=0;var q=0;if(p.pageX||p.pageY){o=p.pageX;q=p.pageY}else{if(p.clientX||p.clientY){o=p.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;q=p.clientY+document.body.scrollTop+document.documentElement.scrollTop}}return{x:o,y:q}}function l(o,p){if(o.y>=p.top&&o.y<=p.bottom&&o.x>=p.left&&o.x<=p.right){return true}return false}var e=f.extend(i,n,{name:"paddnd_invite",defaultOptions:{mode:"dynamic",invites:{drop:{nls:"drop",icon:"drag-drop"},add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{icon:"plus",nls:"insert"},find:{icon:"search",nls:"find"}},active_invite:"drop",isTouchActivated:false},init:function(o){this._parent(o);this.options.isTouchActivated=g.getSetting("touchDropInvite")&&(a.Features.touchEvents&&!a.Features.pointerEvents);if(this.options.isTouchActivated){this.options.invites.drop={nls:"add_as_object",icon:"touch"}}switch(this.getMode()){case"none":break;case"drop_here":this._createDropHereInvite();break;case"dynamic":this._createDynamicInvite();break;case"inviteWithFilter":if(o.filterActive===undefined||o.filterActive===true){this._createDynamicInvite(true)}else{this._createDynamicInvite(false)}break;default:console.warn("Unknown mode ["+this.getMode()+"]");this._createDynamicInvite();break}},_createDynamicInvite:function(q){var u=this;this.elements.container=UWA.createElement("div",{"class":this.getClassNames("_container")});var v=Object.getOwnPropertyNames(this.options.invites);this.elements.container.informationDiv=UWA.createElement("div",{"class":this.getClassNames("_informationMain"),draggable:false});this.elements.container.informationDiv.inject(this.elements.container);if(this.options.isTouchActivated){var p=function(w){require(["DS/ApplicationFrame/CommandsManager"],function(x){var y=x.getCommand("AddRoot","Default");y.begin()})};this.elements.container.className+=" touch_look";this.elements.container.informationDiv.style.pointerEvents="auto";this.elements.container.informationDiv.addEventListener("touchend",p)}for(var o=0;o<v.length;o++){var r=v[o];this.elements.container[r]=UWA.createElement("div",{"class":this.getClassNames("_display "+r),draggable:false});UWA.createElement("i",{"class":this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+this.options.invites[r].icon)}).inject(this.elements.container[r]);UWA.createElement("h5",{"class":this.getClassNames("_txt font-3dsregular "+r),text:j["PADDropInvit_"+this.options.invites[r].nls]}).inject(this.elements.container[r]);this.elements.container[r].inject(this.elements.container.informationDiv);if(this.options.active_invite!==r){this.elements.container[r].hide()}}if(q===true){this.elements.container.style.pointerEvents="auto";this.elements.container.addEventListener("dragover",function(w){w.dataTransfer.dropEffect="move";w.preventDefault();w.stopPropagation();return false});var t=0;this.elements.container.addEventListener("dragenter",function(x){var w=require("DS/PADUtils/PADSession");if(!w.determineAuthoredFlag()){x.preventDefault();x.stopPropagation();t++;u.elements.container.addClassName("withFilterOpen");u.elements.container.filterDiv.style.display="block"}else{u.elements.container.removeClassName("withFilterOpen");u.elements.container.filterDiv.style.display="none"}});this.elements.container.addEventListener("dragleave",function(x){var w=require("DS/PADUtils/PADSession");if(w.determineAuthoredFlag()===false){x.preventDefault();x.stopPropagation();t--;if(t<=0){u.elements.container.removeClassName("withFilterOpen");u.elements.container.filterDiv.style.display="none";t=0}return false}});this.elements.container.addEventListener("drop",function(x){t=0;var w=require("DS/PADUtils/PADSession");if(w.determineAuthoredFlag()===false){u.elements.container.removeClassName("withFilterOpen");u.elements.container.filterDiv.style.display="none"}if(UWA.is(u.options.dropOnInvite,"function")){u.options.dropOnInvite(x)}return false});this.elements.container.filterDiv=UWA.createElement("div",{"class":this.getClassNames("_filterMain"),draggable:false});this.elements.container.filterDiv.style.display="none";this.elements.container.filterDiv.inject(this.elements.container);var r="filter";this.elements.container[r]=UWA.createElement("div",{"class":this.getClassNames("_display "+r)});UWA.createElement("i",{"class":this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-filter")}).inject(this.elements.container[r]);UWA.createElement("h5",{"class":this.getClassNames("_txt font-3dsregular "+r),text:j.PADDropInvit_filter}).inject(this.elements.container[r]);this.elements.container[r].inject(this.elements.container.filterDiv);var s=function(w){t=0;this._dropFilterCB(w)}.bind(this);this.elements.container.filterDiv.addEventListener("dragover",function(w){w.dataTransfer.dropEffect="move";w.preventDefault();w.stopPropagation();return false});this.elements.container.filterDiv.addEventListener("drop",s)}else{if(UWA.is(u.options.dropOnInvite,"function")){this.elements.container.addEventListener("dragover",function(w){w.preventDefault();w.stopPropagation();return false});this.elements.container.addEventListener("drop",function(w){u.options.dropOnInvite(w);return false})}}if(this.getOption("renderTo")){this.elements.container.inject(this.getOption("renderTo"))}},_dropFilterCB:function(q){q.preventDefault();q.stopPropagation();this.elements.container.removeClassName("withFilterOpen");this.elements.container.filterDiv.style.display="none";var p=h.get();if(p&&p.publish){p.publish({event:"onFilterDropped"})}var o=c.deserializeDroppedData(q);require(["DS/ApplicationFrame/CommandsManager"],function(r){var s=r.getCommand("FilterDropObjects");if(s){s.execute(o)}else{console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsHdr is undefined")}this.hide()}.bind(this));return false},_createDropHereInvite:function(){this.elements.container=UWA.createElement("div",{"class":this.getClassNames("_drop_here"),draggable:false});UWA.createElement("i",{"class":this.getClassNames("_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-drag-drop")}).inject(this.elements.container);UWA.createElement("h5",{"class":this.getClassNames("_txt drop_here"),text:j.PADDropInvit_drop_here}).inject(this.elements.container);if(this.getOption("renderTo")){this.elements.container.inject(this.getOption("renderTo"))}},show:function(o){switch(this.getMode()){case"none":break;case"drop_here":if(o==="drop"){this.elements.container.show();this.dispatchEvent("toggleInvite",true)}else{if(this.elements.container.getStyle("display")==="block"){this.elements.container.hide();this.dispatchEvent("toggleInvite",true)}}break;default:if(this.options.active_invite!==o){if(!UWA.is(o,"string")){this.options.active_invite="drop"}else{if(this.options.active_invite!==o&&this.options.active_invite!==""){this.elements.container[this.options.active_invite].hide()}this.options.active_invite=o}if(this.options.active_invite==="drop"){this.elements.container.informationDiv.style.pointerEvents="auto"}else{this.elements.container.informationDiv.style.pointerEvents="none"}this.elements.container[this.options.active_invite].show();this.elements.container.show();this.dispatchEvent("toggleInvite",true)}}},hide:function(o){switch(this.getMode()){case"none":break;case"drop_here":if(this.elements.container.getStyle("display")==="block"){this.elements.container.hide();this.dispatchEvent("toggleInvite",true)}break;default:if(UWA.is(o,"string")){if(this.options.active_invite!==""&&this.options.active_invite===o){this.elements.container[this.options.active_invite].hide();this.elements.container.hide()}}else{if(this.options.active_invite!==""){this.elements.container[this.options.active_invite].hide();this.elements.container.hide()}}this.options.active_invite="";this.dispatchEvent("toggleInvite",false)}},getMode:function(){return m.isWebInWinContext()?"none":this.options.mode},isEventInside:function(p){if(this.getMode()==="none"){return false}var q=k(p);if(!this.elements.container.isHidden()){var o=this.elements.container.getBoundingClientRect();if(l(q,o)){return true}}return false}});return e});define("DS/PADUtils/views/PADStatusBar",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/UIKIT/Tooltip","DS/Controls/ProgressBar","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADUtilsServices"],function(e,i,f,l,j,c,g,k,a,b,d){var h=f.extend(l,{name:"pad_status",_tooltipInfo:null,_latestNotification:null,_icons:["filter","connection","change","info","warning","error","latestNotification","perfoDebug"],_previousLabel:null,_isPaused:false,init:function(n){this._parent(n);this._tooltipCBForTouch=function(){if(this){this.toggle()}};this._onDragEvent=n.onDragEvent;var q=d.isTouchDevice()?" touch-mode":"";this.elements.container=UWA.createElement("div",{"class":"pad_status_footer"+q});this.elements.container.dataset.open=true;this.elements.footerLeft=new UWA.Element("div",{"class":"pad_status_footer_left"}).inject(this.elements.container);this.elements.selectionTextContainer=UWA.createElement("div",{"class":"pad_status_footer_selection_text_container"}).inject(this.elements.footerLeft);this.elements.selectionText=UWA.createElement("span",{"class":"selection_text"}).inject(this.elements.selectionTextContainer);var m='<span class="fonticon fonticon-select-off"></span>';this.elements.selectionText.innerHTML=m;this._selectionTooltip=new k({target:this.elements.selectionText,position:"top left"});this._selectionTooltip.setBody(c.PADStatusInfos_noSelection);if(n.withLoader){this.elements.loaderContainer=UWA.createElement("div",{"class":"pad_status_footer_loader_container"}).inject(this.elements.footerLeft);this.elements.loaderFeedbackIcon=UWA.createElement("span",{}).inject(this.elements.loaderContainer);this.elements.progressbarContainer=UWA.createElement("div",{"class":"pad_status_footer_progress_bar hidden"}).inject(this.elements.loaderContainer);this._progressBar=UWA.createElement("div",{"class":"pad_status_footer_progress_loader"}).inject(this.elements.progressbarContainer);this._progressBar.classList.add("hidden");this.elements.progressbarLabel=UWA.createElement("div",{"class":"pad_status_footer_progress_label"}).inject(this.elements.loaderContainer);this.elements.progressbarLabel.innerHTML="";if(!d.isTouchDevice()){this.elements.progressbarLabel.innerHTML=c.PADStatus_readyToLoad}this.elements.playPause3DloadingFonticonContainer=UWA.createElement("div",{"class":"pad_status_footer_play_button_container",events:{click:function(){if(this.elements.playPause3DloadingFonticonContainer.status==="play"){this._isPaused=true;n.onPause();this.elements.playPause3DloadingFonticonContainer.status="pause";this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-pause");this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-play");this._playPause3DloadingFonticonTooltip.setBody(c.PADStatusInfos_unlock3DLoadingTooltip);this.setLoader({status:"hide"})}else{this._isPaused=false;n.onPlay();this.elements.playPause3DloadingFonticonContainer.locked=false;this.elements.playPause3DloadingFonticonContainer.status="play";this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-play");this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-pause");this._playPause3DloadingFonticonTooltip.setBody(c.PADStatusInfos_lock3DLoadingTooltip);this.setLoader({status:"show"})}}.bind(this)}}).inject(this.elements.loaderContainer);this.elements.playPause3DloadingFonticon=UWA.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pause pad_status_font_icon pad_status_fonticon_playPause3Dloading"}).inject(this.elements.playPause3DloadingFonticonContainer);this.elements.playPause3DloadingFonticonContainer.status="play";this._playPause3DloadingFonticonTooltip=new k({target:this.elements.playPause3DloadingFonticonContainer,position:"top left"});this._playPause3DloadingFonticonTooltip.setBody(c.PADStatusInfos_lock3DLoadingTooltip);if(d.isTouchDevice()){this._playPause3DloadingFonticonTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._playPause3DloadingFonticonTooltip))}}this.elements.infoContainer=UWA.createElement("div",{"class":"pad_status_footer_right"}).inject(this.elements.container);for(var o=this._icons.length-1;o>=0;--o){switch(this._icons[o]){case"connection":this.elements.connectionFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.connectionFonticon=UWA.createElement("span",{"class":"padstatusbar-connection-type"}).inject(this.elements.connectionFonticonContainer);break;case"change":this.elements.changeFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.changeFonticon=UWA.createElement("span",{"class":"fonticon fonticon fonticon-change-action-workunder pad_status_font_icon pad_status_fonticon_change empty"}).inject(this.elements.changeFonticonContainer);break;case"info":this.elements.infoFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.infoFonticon=UWA.createElement("span",{"class":"fonticon fonticon-info pad_status_font_icon pad_status_fonticon_info empty"}).inject(this.elements.infoFonticonContainer);break;case"warning":this.elements.warningFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.warningFonticon=UWA.createElement("span",{"class":"fonticon fonticon-attention pad_status_font_icon pad_status_fonticon_warning empty"}).inject(this.elements.warningFonticonContainer);break;case"error":this.elements.errorFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.errorFonticon=UWA.createElement("span",{"class":"fonticon fonticon-alert pad_status_font_icon pad_status_fonticon_error empty"}).inject(this.elements.errorFonticonContainer);break;case"filter":this.elements.filterFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.filterFonticon=UWA.createElement("span",{"class":"fonticon fonticon-filter pad_status_font_icon pad_status_fonticon_filter empty"}).inject(this.elements.filterFonticonContainer);break;case"latestNotification":var p=this;this.elements.latestNotificationFonticonContainer=UWA.createElement("div",{"class":"hidden"+q}).inject(this.elements.infoContainer);this.elements.latestNotificationFonticon=UWA.createElement("span",{"class":"fonticon fonticon-bell-alt pad_status_font_icon pad_status_fonticon_latestNotification empty",events:{click:function(){require(["DS/PADUtils/views/PADAlert"],function(r){if(p._latestNotification){r.displayNotification(p._latestNotification)}if(d.isTouchDevice()){p.elements.latestNotificationFonticon.removeClassName("new");if(p._latestNotification){p.elements.latestNotificationFonticon.addClassName("old")}else{p.elements.latestNotificationFonticon.addClassName("empty")}}})}}}).inject(this.elements.latestNotificationFonticonContainer);this._latestNotificationTooltip=new k({target:this.elements.latestNotificationFonticonContainer,position:"top right",events:{onHide:function(){p.elements.latestNotificationFonticon.removeClassName("new");if(p._latestNotification){p.elements.latestNotificationFonticon.addClassName("old")}else{p.elements.latestNotificationFonticon.addClassName("empty")}}}});this._latestNotificationTooltip.setBody(c.PADStatusInfos_showLatestNotification);if(d.isTouchDevice()){this._latestNotificationTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._latestNotificationTooltip))}break;case"perfoDebug":if(n.onPerfoClicked&&n.perfoDebug){var p=this;this.elements.perfoDebugFonticonContainer=UWA.createElement("div",{"class":"pad_status_perfo_icon"+q,styles:"cursor: pointer;"}).inject(this.elements.infoContainer);this.elements.perfoDebugFonticon=UWA.createElement("span",{"class":"fonticon fonticon-chart-gauge-angular pad_status_font_icon",events:{click:function(){n.onPerfoClicked()}}}).inject(this.elements.perfoDebugFonticonContainer);this._perfoDebugTooltip=new k({target:this.elements.perfoDebugFonticonContainer,position:"top right"});this._perfoDebugTooltip.setBody(c.PADStatusInfos_debugPerformance);if(d.isTouchDevice()){this._perfoDebugTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._perfoDebugTooltip))}}break}}if(this.getOption("renderTo")){this.inject(this.getOption("renderTo"))}this.setConnection()},setLoader:function(m){if(m&&m.status==="on"){this.resetProgressLabel();if(this._progressBar){this._progressBar.classList.remove("hidden");if(this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.contains("hidden")){this.elements.progressbarContainer.classList.remove("hidden")}}}else{if(m&&m.status==="off"){this.resetProgressLabel();if(this._progressBar){this._progressBar.classList.add("hidden");if(this.elements.progressbarContainer){this.elements.progressbarContainer.classList.add("hidden")}}}else{if(m&&m.status==="show"){if(this.elements.progressbarContainer&&!this._progressBar.classList.contains("hidden")){this.elements.progressbarContainer.classList.remove("hidden")}}else{if(m&&m.status==="hide"){if(this.elements.progressbarContainer){this.elements.progressbarContainer.classList.add("hidden")}}}}}},setProgressLabel:function(m){if(this._isPaused===true){this._previousLabel=m}else{this.elements.progressbarLabel.innerHTML=m}},setCustomProgressLabel:function(m){if(m&&m.label&&m.tooltip&&m.severity){this.elements.loaderFeedbackIcon.className="pad_status_loader_fedback fonticon";switch(m.severity){case"warning":this.elements.loaderFeedbackIcon.classList.add("fonticon-attention");break;case"error":this.elements.loaderFeedbackIcon.classList.add("fonticon-alert");break;case"info":this.elements.loaderFeedbackIcon.classList.add("fonticon-info");break;case"success":this.elements.loaderFeedbackIcon.classList.add("fonticon-check");break;default:this.elements.loaderFeedbackIcon.classList.add("fonticon-info");break}if(this._isPaused===true){this._previousLabel=UWA.createElement("div",{"class":"pad_status_footer_progress_label"});this._previousLabel=m.label}else{this.elements.progressbarLabel.innerHTML="";this.elements.progressbarLabel.innerHTML=m.label}if(this._progressLabelTooltip){this._progressLabelTooltip.destroy()}this._progressLabelTooltip=new k({target:this.elements.loaderFeedbackIcon,position:"left"});this._progressLabelTooltip.setBody(m.tooltip);if(d.isTouchDevice()){this._progressLabelTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._progressLabelTooltip))}}},pauseProgresslabel:function(){this._previousLabel=this.elements.progressbarLabel.innerHTML;this.elements.progressbarLabel.innerHTML=c.PADStatus_loadingPaused},restorePreviousLabel:function(){this.elements.progressbarLabel.innerHTML=this._previousLabel},resetPreviousLabel:function(){this._previousLabel=c.PADStatus_readyToLoad},resetProgressLabel:function(){this.elements.loaderFeedbackIcon.className="";if(this._isPaused===false){this.elements.progressbarLabel.innerHTML=c.PADStatus_readyToLoad;if(this._progressLabelTooltip){if(d.isTouchDevice()){this._progressLabelTooltip.options.target.removeEventListener("touchend",this._tooltipCBForTouch)}this._progressLabelTooltip.destroy();this._progressLabelTooltip=null}}},setError:function(n){if(n&&n.message){this.elements.errorFonticon.addClassName("new");if(this._errorTooltip){this._errorTooltip.destroy();this._errorTooltip=null}var m=this;this._errorTooltip=new k({target:this.elements.errorFonticonContainer,position:"top right",events:{onHide:function(){m.elements.errorFonticon.removeClassName("new");m.elements.errorFonticon.addClassName("old")}}});this._errorTooltip.setBody(n.message);this.elements.errorFonticonContainer.removeClassName("hidden");if(d.isTouchDevice()){this.elements.errorFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._errorTooltip))}}},clearError:function(){this.elements.errorFonticonContainer.addClassName("hidden");this.elements.errorFonticon.removeClassName("new");this.elements.errorFonticon.removeClassName("old");if(this._errorTooltip){this._errorTooltip.destroy();this._errorTooltip=null;if(d.isTouchDevice()){this.elements.errorFonticon.removeEventListener("touchend",this._tooltipCBForTouch)}}},setWarning:function(n){if(n&&n.message){this.elements.warningFonticon.addClassName("new");if(this._warningTooltip){this._warningTooltip.destroy();this._warningTooltip=null}var m=this;this._warningTooltip=new k({target:this.elements.warningFonticonContainer,position:"top right",events:{onHide:function(){m.elements.warningFonticon.removeClassName("new");m.elements.warningFonticon.addClassName("old")}}});this._warningTooltip.setBody(n.message);this.elements.warningFonticonContainer.removeClassName("hidden");if(d.isTouchDevice()){this.elements.warningFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._warningTooltip))}}},clearWarning:function(){this.elements.warningFonticonContainer.addClassName("hidden");this.elements.warningFonticon.removeClassName("new");this.elements.warningFonticon.removeClassName("old");if(this._warningTooltip){this._warningTooltip.destroy();this._warningTooltip=null;if(d.isTouchDevice()){this.elements.warningFonticon.removeEventListener("touchend",this._tooltipCBForTouch)}}},setChange:function(n){if(n&&n.message){this.elements.changeFonticon.addClassName("new");if(this._changeTooltip){this._changeTooltip.destroy();this._changeTooltip=null}var m=this;this._changeTooltip=new k({target:this.elements.changeFonticonContainer,position:"top right",events:{onHide:function(){m.elements.changeFonticon.removeClassName("new");m.elements.changeFonticon.addClassName("old")}}});this._changeTooltip.setBody(n.message);this.elements.changeFonticonContainer.removeClassName("hidden");if(d.isTouchDevice()){this.elements.changeFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._changeTooltip))}}},clearChange:function(){this.elements.changeFonticonContainer.addClassName("hidden");this.elements.changeFonticon.removeClassName("new");this.elements.changeFonticon.removeClassName("old");if(this._changeTooltip){this._changeTooltip.destroy();this._changeTooltip=null;if(d.isTouchDevice()){this.elements.changeFonticon.removeEventListener("touchend",this._tooltipCBForTouch)}}},setSelection:function(n){if(n&&n.length){var m='<span class="fonticon fonticon-select-on"></span>';this.elements.selectionText.innerHTML=m+n.length;if(g.getSetting("padstatusbar_allowSelectionDragging")===true){this.elements.selectionText.classList.add("has-selection");this.elements.selectionText.parentNode.setAttribute("draggable",true);this.elements.selectionText.parentNode.addEventListener("dragstart",this._onDragEvent)}if(this._selectionTooltip){this._selectionTooltip.destroy();this._selectionTooltip=null}this._selectionTooltip=new k({target:this.elements.selectionText,position:"top left"});this._selectionTooltip.setBody(n.length+c.PADStatusInfos_nbObjectsSelected);if(d.isTouchDevice()){this.elements.selectionText.addEventListener("touchend",this._tooltipCBForTouch.bind(this._selectionTooltip))}}},clearSelection:function(n){var m='<span class="fonticon fonticon-select-off"></span>';this.elements.selectionText.innerHTML=m;if(g.getSetting("padstatusbar_allowSelectionDragging")===true){this.elements.selectionText.classList.remove("has-selection");this.elements.selectionText.parentNode.removeAttribute("draggable");this.elements.selectionText.parentNode.removeEventListener("dragstart",this._onDragEvent)}if(this._selectionTooltip){this._selectionTooltip.setBody(c.PADStatusInfos_noSelection);if(d.isTouchDevice()){this.elements.selectionText.removeEventListener("touchend",this._tooltipCBForTouch)}}},setInfo:function(n){if(n&&n.message){this.elements.infoFonticon.addClassName("new");if(this._infoTooltip){this._infoTooltip.destroy();this._infoTooltip=null}var m=this;this._infoTooltip=new k({target:this.elements.infoFonticonContainer,position:"top right",events:{onHide:function(){m.elements.infoFonticon.removeClassName("new");m.elements.infoFonticon.addClassName("old")}}});this._infoTooltip.setBody(n.message);this.elements.infoFonticonContainer.removeClassName("hidden");if(d.isTouchDevice()){this.elements.infoFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._infoTooltip))}}},clearInfo:function(){this.elements.infoFonticonContainer.addClassName("hidden");this.elements.infoFonticon.removeClassName("old");this.elements.infoFonticon.removeClassName("new");if(this._infoTooltip){this._infoTooltip.destroy();this._infoTooltip=null;if(d.isTouchDevice()){this.elements.infoFonticon.removeEventListener("touchend",this._tooltipCBForTouch)}}},setFilter:function(p){if(p&&p.message){this.elements.filterFonticon.addClassName("new");if(!this._filterTooltip){var o=this;this._filterTooltip=new k({target:this.elements.filterFonticonContainer,position:"top right",events:{onHide:function(){o.elements.filterFonticon.removeClassName("new");o.elements.filterFonticon.addClassName("old")}}});this._filterTooltip.elements.body.innerHTML=""}var m=b.getWebappsAssetUrl("ENOPAD3DViewer","icons/32/I_DefineFilter.png");var n='<div id="statusbar-filter-'+p.id+'" class="filter-tooltip"><img src="'+m+'" /><p>'+p.message+"</p></div>";this._filterTooltip.elements.body.innerHTML+=n;this.elements.filterFonticonContainer.removeClassName("hidden");this.elements.filterFonticonContainer.addEventListener("click",this._tooltipCBForTouch.bind(this._filterTooltip));if(d.isTouchDevice()){this.elements.filterFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._filterTooltip))}}},clearFilter:function(n){var o=function(){this.elements.filterFonticonContainer.addClassName("hidden");this.elements.filterFonticon.removeClassName("old");this.elements.filterFonticon.removeClassName("new");if(this._filterTooltip){this._filterTooltip.destroy();this._filterTooltip=null;if(d.isTouchDevice()){this.elements.filterFonticon.removeEventListener("touchend",this._tooltipCBForTouch)}}}.bind(this);var p=function(s){if(this._filterTooltip){var q=this._filterTooltip.elements.body;for(var r=0;r<q.children.length;++r){if(q.children[r].id===("statusbar-filter-"+s)){q.removeChild(q.children[r])}}if(q.children.length===0){o()}}}.bind(this);if(n&&n.id){p(n.id)}else{if(n&&n.ids){for(var m=0;m<n.ids.length;++m){p(n.ids[m])}}else{o()}}},setConnection:function(n){var o=function(){var q=d.getPlatformId();var p=Number(getComputedStyle(document.body).width.slice(0,-2));if(p<640){this.elements.connectionFonticon.innerHTML="";this.elements.connectionFonticon.className="fonticon fonticon-network"}else{this.elements.connectionFonticon.className="";this.elements.connectionFonticon.innerHTML=q}if(n&&n.message){this._connectionTooltip.setBody(n.message)}else{this._connectionTooltip.setBody(q)}}.bind(this);window.addEventListener("resize",o);if(this._connectionTooltip){this._connectionTooltip.destroy();this._connectionTooltip=null}var m=this;this._connectionTooltip=new k({target:this.elements.connectionFonticonContainer,position:"top right"});o();this.elements.connectionFonticonContainer.removeClassName("hidden");if(d.isTouchDevice()){this.elements.connectionFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._connectionTooltip))}},clearConnection:function(m){this.elements.connectionFonticonContainer.addClassName("hidden");if(this._connectionTooltip){this._connectionTooltip.destroy();this._connectionTooltip=null;if(d.isTouchDevice()){this.elements.connectionFonticonContainer.removeEventListener("touchend",this._tooltipCBForTouch)}}},setLatestNotification:function(m){if(m&&m.notification){this.elements.latestNotificationFonticon.addClassName("new");this._latestNotification=m.notification}this.elements.latestNotificationFonticonContainer.removeClassName("hidden")},clearLatestNotification:function(){this.elements.latestNotificationFonticonContainer.addClassName("hidden");this.elements.latestNotificationFonticon.removeClassName("new");this.elements.latestNotificationFonticon.removeClassName("old");this._latestNotification=null},toggle:function(){if(this.elements.container.dataset.open==="true"){this.close()}else{this.open()}this.elements.container.style.display="none";this.elements.container.style.display="block"},open:function(){this.elements.container.classList.remove("closed");this.elements.container.dataset.open=true},close:function(){this.elements.container.classList.add("closed");this.elements.container.dataset.open=false},setIsPaused:function(m){this._isPaused=m}});return h});define("DS/PADUtils/PADSharedSettings",["text!DS/PADUtils/assets/PADSharedSettings.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices"],function(a,f,c,d,g){var e={debouncePrefSynchro:{},cbFuncLocal:{},cbFuncShared:{},proxy:null,appWidget:null},b={sharedSettings:JSON.parse(a),usedSharedSettings:[]};b.destroy=function(){e.appWidget=null;e.proxy.destroy();e.proxy=null;e.debouncePrefSynchro={};e.cbFuncLocal={};e.cbFuncShared={};b.usedSharedSettings=[]};b.listAvailableSharedSettings=function(){return Object.getOwnPropertyNames(b.sharedSettings)};b.addSharedSettings=function(j,o){if(j){if(!e.appWidget){e.appWidget=j}if(e.appWidget!==j){throw new Error("Unexpected widget")}var s=(UWA.is(o,"array")?o:b.listAvailableSharedSettings()).filter(function(i){return b.usedSharedSettings.indexOf(i)===-1});if(s.length===0){return}if(s.indexOf("pad_security_ctx")!==-1){c.with_security_context=true}var m={},q=[],l;for(l=0;l<s.length;l++){if(UWA.is(b.sharedSettings[s[l]],"object")){if((j.data.appId==="ENOPSTE_AP"||j.data.appId==="ENOSC2D_AP")&&b.sharedSettings[s[l]].only3D===true){s.splice(l,1);continue}c.options.run_options[s[l]]=b.sharedSettings[s[l]];if(s[l].notAddedByDefault!==true){m[s[l]]=b.sharedSettings[s[l]]}b.usedSharedSettings.push(s[l]);q.push(s[l])}else{console.warn("Unknown shared setting "+s[l])}}var n=c.build_preferences(m);e.appWidget.mergePreferences(n);if(s.indexOf("pad_security_ctx")!==-1){g.updateWidgetSecPref({user:g.getUser()})}if(!e.proxy){var h=require("DS/PADUtils/PADCommandProxy");var p=function(i){e.debouncePrefSynchro[i.name]=true;e.appWidget.setValue(i.name,i.value);c.setSetting(i.name,i.value)};e.proxy=h.create({events:{onPreferenceModification:function(i){if(e.cbFuncLocal[i.name]===undefined&&b.usedSharedSettings.indexOf(i.name)!==-1){e.cbFuncLocal[i.name]=p}if(e.cbFuncLocal[i.name]){e.cbFuncLocal[i.name](i)}}}})}var k=function(i){if(e.debouncePrefSynchro[i.name]!==true&&e.proxy){e.proxy.preferenceModification({name:i.name,value:i.value})}else{e.debouncePrefSynchro[i.name]=false}};for(l=0;l<q.length;l++){var r=q[l];(function(i){var t="on"+i.charAt(0).toUpperCase()+i.slice(1);c.addEvent(t,function(v){var u={name:i,value:v};if(e.cbFuncShared[u.name]===undefined){e.cbFuncShared[u.name]=k}e.cbFuncShared[u.name](u)})})(r)}}};b.resetDebounceFlags=function(){e.debouncePrefSynchro={}};return b});define("DS/PADUtils/PADSettings",["DS/PADUtils/PADUtilsServices"],function(a){console.warn("Deprecated module DS/PADUtils/PADSettings use DS/PADUtils/PADUtilsServices instead for the services methods or DS/PADUtils/PADSettingsMgt for settings mgt");return a});define("DS/PADUtils/views/PADPager",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADUtilsServices","DS/Core/ModelEvents"],function(f,b,e,g,d,c){var a=g.extend({renderTo:null,visible:false,_modelEvents:null,init:function(h){this.renderTo=h.renderTo?h.renderTo:document.body;this._parent(h);this._buildSkeleton();this._modelEvents=new c()},show:function(){if(this.visible===false){this.elements.container.inject(this.renderTo);this.visible=true}},hide:function(){if(this.visible===true){this.renderTo.removeChild(this.elements.container);this.visible=false}},setLabel:function(h){if(this.elements.textInfo){this.elements.textInfo.innerHTML=h}},publish:function(h){this.getModelEvents().publish(h)},subscribe:function(h,i){return this.getModelEvents().subscribe(h,i)},unsubscribe:function(h){this.getModelEvents().unsubscribe(h)},getModelEvents:function(){return this._modelEvents},_buildSkeleton:function(){var h=this;this.elements.container=UWA.createElement("div",{"class":"PADPagerContainer"});this.elements.topBarContainer=UWA.createElement("span",{"class":"PADSelectionNavigatiorTopBar"}).inject(this.elements.container);this.elements.previousButton=UWA.createElement("span",{"class":"PADPagerPreviousButton","data-toggle":"tooltip","data-placement":"bottom",title:b.PADSearchView_previous}).inject(this.elements.topBarContainer);this.elements.previousButton.addEventListener("click",function(i){h.getModelEvents().publish({event:"previous"})});this.elements.previousButton.addEventListener("touchend",function(i){h.getModelEvents().publish({event:"previous"})});this.elements.textInfo=UWA.createElement("div",{"class":"PADPagerLabel wux-afr-label"}).inject(this.elements.topBarContainer);this.elements.nextButton=UWA.createElement("span",{"class":"PADPagerNextButton","data-toggle":"tooltip","data-placement":"bottom",title:b.PADSearchView_next}).inject(this.elements.topBarContainer);this.elements.nextButton.addEventListener("click",function(i){h.getModelEvents().publish({event:"next"})});this.elements.nextButton.addEventListener("touchend",function(i){h.getModelEvents().publish({event:"next"})});this.elements.closeButton=UWA.createElement("span",{"class":"fonticon fonticon-wrong PADPagerCloseButton","data-toggle":"tooltip","data-placement":"top",title:b.PADSearchView_close}).inject(this.elements.topBarContainer);if(d.isTouchDevice()){this.elements.closeButton.addClassName("CloseButtonTouch")}this.elements.closeButton.addEventListener("click",function(i){h.getModelEvents().publish({event:"close"})})}});return UWA.namespace("DS/PADUtils/commands/PADPager",a)});define("DS/PADUtils/PADTypesMgt",["i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert"],function(d,c,f,b){var a={};var e={authorized_types:[],type_kind:{},type_kind_setting:{},types_hierarchies:{},displayNotification:function(g,h){b.displayNotification({msg:d.replace(d.get("unsupported_type"),{type:g,name:h||""}),eventID:"warning"})},retrieveKind:function(j){var i;for(var g in e.type_kind){if(e.type_kind[g].indexOf(j)!==-1){i=g;break}}if(!i){for(var h in e.type_kind_setting){if(e.type_kind_setting[h].indexOf(j)!==-1){i=h;if(!e.type_kind[h]){e.type_kind[h]=[]}e.type_kind[h].push(j);break}}if(!i){i="Product"}}return i}};a.isTypesAuthorized=function(m,q,n,j,o){var i=[];var g=[];var l={};var k=c.getSetting("authorized_root_types");e.type_kind_setting=c.getSetting("type_kind");var h={};var p=j===true?[]:c.getSetting("unsupported_root_types");if(!p){p=[]}m.forEach(function(s){if(e.authorized_types.indexOf(s.type)!==-1||k.indexOf(s.type)!==-1){i.push(s.type);if(o==="2.0"){if(!h.supportedTypes){h.supportedTypes={}}var r=e.retrieveKind(s.type);if(r){if(!h.supportedTypes[r]){h.supportedTypes[r]=[]}h.supportedTypes[r].push(s.type);if(!e.type_kind[r]){e.type_kind[r]=[]}e.type_kind[r].push(s.type)}else{if(!h.supportedTypes.Product){h.supportedTypes.Product=[]}h.supportedTypes.Product.push(s.type);if(!e.type_kind.Product){e.type_kind.Product=[]}e.type_kind.Product.push(s.type)}}}else{g.push(s.type);l[s.type]=s.displayType}});if(g.length){require(["DS/PADUtils/PADWSAccess"],function(r){r.getTypesHierarchy({types:g,onComplete:function(s){var u=false;var t=UWA.is(s,"string")?JSON.parse(s):s;t.types_hierarchies.forEach(function(z){if(e.types_hierarchies[z.type]===undefined){e.types_hierarchies[z.type]=z.hierarchy;e.types_hierarchies[z.type].push(z.type)}var w=false;var y;for(var v=0;v<z.hierarchy.length&&w===false;v++){if(k.indexOf(z.hierarchy[v])!==-1){if(p.indexOf(z.type)!==-1){w=false}else{w=true;y=k[z.hierarchy[v]]}}}if(w===true){if(j!==true){e.authorized_types.push(z.type)}i.push(z.type);if(o==="2.0"){if(!h.supportedTypes){h.supportedTypes={}}var x=e.retrieveKind(y);if(x){if(!h.supportedTypes[x]){h.supportedTypes[x]=[]}h.supportedTypes[x].push(z.type)}else{if(!h.supportedTypes.Product){h.supportedTypes.Product=[]}h.supportedTypes.Product.push(z.type);if(!e.type_kind.Product){e.type_kind.Product=[]}e.type_kind.Product.push(y)}}}else{if(n){e.displayNotification(l[z.type],"");u=true}}});if(u){h.unsupportedDropNotified=true}q(i,h)},onFailure:function(s){q(i,h)}})})}else{q(i,h)}};a.retrieveAuthorizedObjects=function(j){var m;if(j.X3DContentId){m=j.X3DContentId}else{if(j.unserializedData){m=j.unserializedData}else{m=f.deserializeDroppedData(j.dnd_event)}}var l=[];var k={};var h={authorized_objects:[],unauthorized_objects:[]};var i="WITHOUT_CONTEXT";if(j.dnd_event){i=j.dnd_event.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT"}else{if(j.behavior){i=j.behavior}}h.source_data=UWA.clone(m);delete h.source_data.data;var g=j.displayNotif===undefined?true:j.displayNotif;if(UWA.is(m.data)&&UWA.is(m.data.items,"array")&&m.data.items.length>0){if(c.getSetting("accept_all_types")===true){console.log("Accept all types");h.authorized_objects=m.data.items;j.callback(h)}else{if(j.version==="2.0"){h.authorizedWithKind={}}m.data.items.forEach(function(p){var n=p.objectType;if(UWA.is(p.objectType_Internal)){n=p.objectType_Internal}var o=p.displayType;if(i==="WITH_CONTEXT"&&p.path&&p.path.length>1&&p.path[0].type){n=p.path[0].type;o=p.path[0].type}if(!n||n.length===0){console.warn("No type available ==> Object not supported");h.unauthorized_objects.push(p)}else{if(l.indexOf(n)===-1){l.push({type:n,displayType:o})}}});a.isTypesAuthorized(l,function(o,n){if(n&&n.unsupportedDropNotified){h.unsupportedDropNotified=true}m.data.items.forEach(function(q){var p=q.objectType;if(UWA.is(q.objectType_Internal)){p=q.objectType_Internal}if(i==="WITH_CONTEXT"&&q.path&&q.path.length>1&&q.path[0].type){p=q.path[0].type}if(o.indexOf(p)!==-1){if(j.version==="2.0"){var r=e.retrieveKind(p);if(!h.authorizedWithKind[r]){h.authorizedWithKind[r]=[]}h.authorizedWithKind[r].push(q)}h.authorized_objects.push(q)}else{h.unauthorized_objects.push(q);if(j.notifPerObjects===true){b.displayNotification({msg:d.replace(d.get("unsupported_type"),{type:q.displayType,name:q.displayName}),eventID:"warning"});h.unsupportedDropNotified=false}}});j.callback(h)},g,j.isFindInCtx,j.version)}}else{h.unsupportedDropNotified=true;j.callback(h)}};a.retrieveHierarchy=function(j,k){var i={};var h=[];for(var g=0;g<j.length;g++){if(e.types_hierarchies[j[g]]){i[j[g]]=UWA.clone(e.types_hierarchies[j[g]])}else{h.push(j[g])}}if(h.length>0){require(["DS/PADUtils/PADWSAccess"],function(l){l.getTypesHierarchy({types:h,onComplete:function(m){var n=UWA.is(m,"string")?JSON.parse(m):m;n.types_hierarchies.forEach(function(o){if(e.types_hierarchies[o.type]===undefined){e.types_hierarchies[o.type]=o.hierarchy;e.types_hierarchies[o.type].push(o.type)}i[o.type]=o.hierarchy;i[o.type].push(o.type);k(i)})},onFailure:function(m){console.warn("Cannot retrieve hierarchy");h.forEach(function(n){i[n]=[n];k(i)})}})})}else{k(i)}};return a});define("DS/PADUtils/views/PADResponsiveRootList",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADTypesMgt","DS/WebappsUtils/WebappsUtils","DS/Utilities/Utils"],function(f,n,g,i,m,l,j,a,e,d,b,c,h){var k=g.extend(i,m,{name:"padresponsiverootLst",_broadcastSelect:true,defaultOptions:{grid:null,model:null},_roots2add:[],_root2select:[],init:function(q){var o=q||{};var s=this;this._parent(q);this.options=UWA.extend(this.options,q,true);this.elements.container=UWA.createElement("div",{"class":this.name});var r=this.options.grid=new l();r.selectionBehavior={unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableShiftSelection:true,enableFeedbackForActiveCell:false,canInteractiveMultiselectWithCheckboxClick:true};r.allowUnsafeHTMLContent=false;r.onStatusbarIconPointerDown=function(t){var x=t.cellInfos;var u=t.clickedIconIndex;var w=x?x.cellView:undefined;var v=w?w.contentView:undefined;var y=x?x.cellModel:undefined;switch(u){case 0:s.removeTile({tile_id:y.options.resourceid});break;case 1:if(s.options.disableDetach){console.warn("PADResponsiveRootList: Unknown Icon");break}if(y.options.isRootAttached||y.options.isRootAttached===undefined){s.detachTile({tile_id:y.options.resourceid,contentView:v})}else{s.attachTile({tile_id:y.options.resourceid,contentView:v})}break;default:console.warn("PADResponsiveRootList: Unknown Icon")}};r.getContent().addEventListener("dragover",function(t){t.preventDefault();t.stopPropagation();return false});r.getContent().addEventListener("drop",this._onDropBlank.bind(this));r.touchMode=true;var p={shouldAcceptDrag:function(){return false}};this.options.model=new a(p);this.options.model.id="rootListModel";this.options.model.getXSO().onPostAdd(function(u){if(s._broadcastSelect){var t=s.options.model.getSelectedNodes().map(function(v){if(v.options.isRootAttached||v.options.isRootAttached===undefined){return v.options.resourceid}});s.dispatchEvent("onTileSelect",{tile_ids:t})}});this.options.model.getXSO().onPostRemove(function(u){if(s._broadcastSelect){var t=s.options.model.getSelectedNodes().map(function(v){if(v.options.isRootAttached||v.options.isRootAttached===undefined){return v.options.resourceid}});s.dispatchEvent("onTileSelect",{tile_ids:t})}});this.options.model.getXSO().onEmpty(function(t){if(s._broadcastSelect){s.dispatchEvent("onTileSelect",{tile_ids:[]})}});r.model=this.options.model;r.getContent().inject(s.elements.container);if(q.roots){q.roots.forEach(function(t){var u=UWA.extend({},t.options);u.isRootAttached=t.options.isRootAttached===true||t.options.isRootAttached===undefined;u.children=[];s.options.model.addRoot(u)})}if(q.callback){q.callback()}},addRootTile:function(o){if(o.waiting4validation!==true){var p=UWA.clone(o,false);delete p.contextualMenu;p.statusbarIcons=["wrong","eye"];p.statusbarIconsTooltips=[n.removeRoot,n.detachRoot];p.thumbnail=o.thumbnail?o.thumbnail:c.getWebappsAssetUrl("PADUtils","icons/32/I_DefaultThumbnail.png");p.children=null;p.isRootAttached=o.isRootAttached===true||o.isRootAttached===undefined;if(p.isRootAttached===false){p.statusbarIcons[1]="eye-off";p.statusbarIconsTooltips[1]=n.attachRoot}if(p.disableDetach){p.statusbarIcons=["wrong"];p.statusbarIconsTooltips=[n.removeRoot]}p.subLabel=o.grid["ds6w:responsible"];p.description=o.grid["ds6w:identifier"];this._roots2add.push(p);this._realAddInWebUX(this._roots2add)}},syncTile:function(u){if(!u.isRoot()){return}var t=this,s=u.getID(),q=this._search(s);if(q.length===1){var r=q[0];var o=(u.options.sequence_filter||u.options.config_filter)?true:false;var p=this.options.model;var o=u.options.filtered===true||u.options.config_filter||u.options.sequence_filter?true:false;if(r.getLabel()!==u.getLabel()||r.options.subLabel!==u.options.grid["ds6w:responsible"]||r.options.isRootAttached!==u.options.isRootAttached||r.options.filtered!==o){p.prepareUpdate();r.setLabel(u.getLabel()||u.options.display);r.updateOptions({subLabel:u.options.grid["ds6w:responsible"],description:u.options.grid["ds6w:identifier"]});r.options.isRootAttached=u.options.isRootAttached;r.options.filtered=o;if(r.options.isRootAttached===false){r.options.statusbarIcons[1]="eye-off";r.options.statusbarIconsTooltips[1]=n.attachRoot}else{r.options.statusbarIcons[1]="eye";r.options.statusbarIconsTooltips[1]=n.detachRoot}if(r.options.filtered===true){r.setBadges({bottomRight:"filter"})}else{r.setBadges({bottomRight:""})}p.pushUpdate();t.options.grid.layout.invalidate()}}},removeTile:function(r){var q=r.tile_id,o=this._search(q);if(o.length===1){var p=this;this.options.model.withTransactionUpdate(function(){p.options.model.removeRoot(o[0]);var s={tile_id:q};if(r.noDispatch){return}p.dispatchEvent("onTileDelete",s)})}},detachTile:function(p){var o=0;if(this._roots2add.length>0){o=250}setTimeout((function(){var s=this,t=p.tile_id,q=this._search(t);if(q.length===1){q[0].options.isRootAttached=false;q[0].options.statusbarIcons[1]="eye-off";q[0].options.statusbarIconsTooltips[1]=n.attachRoot;this.options.grid.layout.invalidate();var r={tile_id:t};s.dispatchEvent("onDetach",r);q[0].unselect()}}).bind(this),o)},attachTile:function(u){var t=this,o=u.tile_id,q=this._search(o);if(q.length===1){var s={tile_id:o};var r=this.options.model.getRoots();var p=r.indexOf(q[0]);for(;r[p]!==undefined;++p){if(r[p].options.isRootAttached===true){s.before_tile_id=r[p].options.resourceid;break}}q[0].options.isRootAttached=true;q[0].options.statusbarIcons[1]="eye";q[0].options.statusbarIconsTooltips[1]=n.detachRoot;this.options.grid.layout.invalidate();q[0].select();t.dispatchEvent("onAttach",s)}},empty:function(){var o=this;this.options.model.withTransactionUpdate(function(){var p=o.options.model.getRoots().slice(0);p.forEach(function(r){o.options.model.removeRoot(r);var q={tile_id:r.options.resourceid};o.dispatchEvent("onTileDelete",q)})})},selectTile:function(p){this._broadcastSelect=false;var o=this._search(p.data.nodeModel.getID());if(o.length===1){o[0].select()}else{if(this._root2select.indexOf(p.data.nodeModel.getID())===-1){this._root2select.push(p.data.nodeModel.getID())}}this._broadcastSelect=true},unselectTile:function(p){this._broadcastSelect=false;var o=this._search(p.data.nodeModel.getID());if(o.length===1){o[0].unselect()}this._broadcastSelect=true},_onDropBlank:function(q,p){q.preventDefault();q.stopPropagation();this.options.grid._getScroller().getContent().removeClassName("wux-ui-state-drag-over");var o=this;b.retrieveAuthorizedObjects({dnd_event:q,callback:function(r){o.dispatchEvent("onTileAdd",{json_content:r,callback:function(){},})}});return false},_search:function(p){var o=this.options.model.search({match:function(q){if(q.nodeModel.options.resourceid===p){return true}}});return o}});k.prototype._realAddInWebUX=h.debounce(function(u){var s=[],x=[],p=[],y=[];y=u;for(var t=u.length-1;t>=0;t--){if(this._search(u[t].resourceid).length>0){break}else{s.push(u[t])}}for(var q=s.length-1;q>=0;q--){if(p.indexOf(s[q].resourceid)===-1){p.push(s[q].resourceid);x.push(s[q])}else{break}}u=x;if(u.length===0){if(y[0].resolve){for(var v=0;v<y.length;v++){y[v].resolve()}}return}this.options.model.addRoot(u);if(y[0].resolve){for(var r=0;r<y.length;r++){y[r].resolve()}}this._roots2add=[];this._broadcastSelect=false;for(var w=0;w<u.length;w++){var o=this._search(u[w].resourceid);if(o.length===1){if(!u[w].nSelect){o[0].select()}if(u[w].isFiltered){o[0].setBadges({bottomRight:"filter"})}else{if(u[w].isFiltered===false){o[0].setBadges({bottomRight:""})}}}}this._broadcastSelect=true},200);return k});define("DS/PADUtils/PADProbes",["UWA/Core","UWA/Class","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices"],function(g,b,c,f){function d(h){var i=h.split("/");if(i[i.length-1].length===0){return i[i.length-2]}else{return i[i.length-1]}}var a=b.singleton({initialize:function(h){},createProbe:function(i){var h={end:function(){},dump:function(){}};if(!this._initialized){this._isActivated=c.getSetting("probes_activated");this._initialized=true}if(this._isActivated){h=new e(i)}return h},networkprobe:function(k){var j=k.request_options;var i=d(k.url);var h=this.createProbe("query_"+i);j.onComplete=(function(m){var l=j.onComplete;return function(n){h.end();if(UWA.is(l,"function")){return l.apply(this,Array.prototype.slice.call(arguments))}}})();j.onFailure=(function(l){var m=j.onFailure;return function(n){h.end();if(UWA.is(m,"function")){return m.apply(this,Array.prototype.slice.call(arguments))}}})();return j}});function e(h){this.id=f.getPCSPrefix()+"_"+h;this.inprogress=true;this.stamp=window.top.performance.now();this.beginMark=this.id+"__begin_"+this.stamp;this.endMark=this.id+"__end_"+this.stamp;window.top.performance.mark(this.beginMark)}e.prototype.end=function(){if(this.inprogress===true){this.inprogress=false;window.top.performance.mark(this.endMark);window.top.performance.measure(this.id,this.beginMark,this.endMark)}};e.prototype.dump=function(){console.log(window.top.performance.getEntriesByName(this.id))};return a});define("DS/PADUtils/utilsWS/WSUtils",["DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes","DS/PADUtils/Configuration"],function(a,e,b,c){function f(h,g){if(h.includes){return h.includes(g)}else{return h.indexOf(g)!==-1}}var d={executeRequest:function(g,o,m,n){var i=null;var k=require("DS/PADUtils/PADSettingsMgt");var l=k.getSetting("pad_security_ctx");if(UWA.is(l,"string")&&m!==true){o.headers.SecurityContext=l;if(n!==true){var j=e.getUser();if(j&&j.login){o.headers.SecurityToken=j.login+"|"+l+"|preferred"}}}var h=b.networkprobe({url:g,request_options:o});i=a.authenticatedRequest(g,o);return i},completeWebAPIPayload:function(n,k,g){var p=c.getWebAPIOptions(n);k=UWA.extend(p.config,k);if(g.withThumbnail2D===true){k.select_file.push("thumbnail_2D")}if(p.mandatoryAttr){var o=Object.getOwnPropertyNames(p.mandatoryAttr);for(var l=0;l<o.length;l++){var m=o[l];if(k[m]===undefined){k[m]=p.mandatoryAttr[m]}else{if(UWA.is(k[m],"array")&&UWA.is(p.mandatoryAttr[m],"array")){for(var h=0;h<p.mandatoryAttr[m].length;h++){if(k[m].indexOf(p.mandatoryAttr[m][h])===-1){k[m].push(p.mandatoryAttr[m][h])}}}else{console.warn("##WSUtils: Unknown kind of property to complete")}}}}var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("pgpFromServer")===true){if(k.select_bo&&k.select_bo.indexOf("bo.pgpshowextension.V_PGP_Show")===-1){k.select_bo.push("bo.pgpshowextension.V_PGP_Show")}if(k.select_rel&&k.select_rel.indexOf("ro.pgpshowextension.V_PGP_Show")===-1){k.select_rel.push("ro.pgpshowextension.V_PGP_Show")}if(k.select_predicate&&k.select_predicate.indexOf("bo.pgpshowextension.V_PGP_Show")===-1){k.select_predicate.push("bo.pgpshowextension.V_PGP_Show")}k.select_pgp=["Show"]}return k},executeSplittedRequest:function(h,g,j){var i={pattern:j,max:(j.max===undefined)?10:j.max,url:h,options:UWA.clone(g,false),onComplete:g.onComplete,onFailure:g.onFailure,onTimeout:g.onTimeout||g.onFailure,onCancel:g.onCancel||g.onFailure,execute:function(){if(this.pattern.init!==undefined){this.data=this.options.data;this.data=UWA.is(this.data,"string")?JSON.parse(this.data):this.data;this.options.onComplete=function(k,m){k=UWA.is(k,"string")?JSON.parse(k):k;var l=k[this.pattern.init.response.packets];if(l!==undefined){this.executePackets(l)}else{if(this.onComplete!==undefined){this.onComplete(k,m)}}}.bind(this);UWA.extend(this.data,this.pattern.init.query,true);this.options.data=JSON.stringify(this.data);d.executeRequest(this.url,UWA.clone(this.options,false))}},executePackets:function(l){this.packets=l;this.pending=0;this.response={};this.stopped=false;if(this.pattern.init!==undefined&&this.pattern.init.query!==undefined){for(var m in this.pattern.init.query){delete this.data[m]}}if(this.pattern.packet.query.remove!==undefined){for(var k=0;k<this.pattern.packet.query.remove.length;k++){delete this.data[this.pattern.packet.query.remove[k]]}}this.options.onComplete=this.onPacketComplete.bind(this);this.options.onFailure=this.onPacketFailure.bind(this);this.options.onTimeout=this.onPacketTimeout.bind(this);this.options.onCancel=this.onPacketCancel.bind(this);this.executePacket()},executePacket:function(){while(this.pending<this.max&&this.packets!==undefined&&this.packets.length>0){this.data[this.pattern.packet.query.packet]=this.packets.shift();this.options.data=JSON.stringify(this.data);this.pending++;d.executeRequest(this.url,UWA.clone(this.options,false))}},onPacketCancel:function(k){if(!this.stopped){this.stopped=true;if(this.onCancel!==undefined){this.onCancel(k)}}},onPacketTimeout:function(k){if(!this.stopped){this.stopped=true;if(this.onTimeout!==undefined){this.onTimeout(k)}}},onPacketFailure:function(k){if(!this.stopped){this.stopped=true;if(this.onFailure!==undefined){this.onFailure(k)}}},onPacketComplete:function(k,p){this.pending--;if(!this.stopped){k=UWA.is(k,"string")?JSON.parse(k):k;var o=this.pattern.packet.response.concat;if(o!==undefined){for(var n=0;n<o.length;n++){this.response[o[n]]=this.response[o[n]]||[];var m=this.updateResponsePacket(k[o[n]]);this.response[o[n]]=this.response[o[n]].concat(m)}}var q=this.pattern.packet.response.copy;if(q!==undefined){for(var l=0;l<q.length;l++){if(q[l]==="full_path"&&(this.response[q[l]]===false||k[q[l]]===false)){this.response[q[l]]=false}else{this.response[q[l]]=k[q[l]]}}}if(this.packets.length===0&&this.pending===0){if(this.onComplete!==undefined){this.onComplete(this.response,p)}}else{this.executePacket()}}},updateResponsePacket:function(t){var r=[];var n=Date.now();for(var q=0;q<t.length;q++){var m=t[q];var p=0;if(m.attributes){var l=false;for(p=0;p<m.attributes.length&&l===false;p++){if(m.attributes[p].name==="did"){m.attributes[p].value=n+"-"+m.attributes[p].value}}}else{if(m.path){for(p=0;p<m.path.length;p++){m.path[p]=n+"-"+m.path[p]}}else{if(m.pgp_overload){var u=Object.getOwnPropertyNames(m.pgp_overload);for(p=0;p<u.length;p++){var s=u[p].split(",");for(var o=0;o<s.length;o++){s[o]=n+"-"+s[o]}m.pgp_overload[s.toString()]=m.pgp_overload[u[p]];delete m.pgp_overload[u[p]]}}}}r.push(m)}return r}};i.execute()},MassChunkedRequests:function(s){var p=30;var k=s.chunkSize||p;var l,g,o,r;var m=[];var q=0;var i=0;var j=0;var h=false;var n=this;this.process=function(){if(q===r){return}if(typeof s.cbOnProcess==="function"){var t=g.slice(i,i+k);s.cbOnProcess(n,t)}};this.reprocess=function(){if(h){return}if(typeof s.cbOnProcess==="function"){var t=g.slice(i,i+k);s.cbOnProcess(n,t)}};this.setAnswer=function(u,v){if(h){return}q++;if(l){o.push({request:u,answer:v})}else{o[u]=v}m.push(v);if(typeof s.cbOnProgress==="function"){var t=q/r;s.cbOnProgress(n,t,u)}if(q>j){i=j+1;j+=k;if(j>=r){j=r-1}this.process()}if(q>=r){if(typeof s.cbOnComplete==="function"){s.cbOnComplete(n);h=true}}};this.getAnswer=function(x){if(l!==undefined){if(!l){return o[x]}var v=JSON.stringify(x);for(var w=0,u=o.length;w<u;w++){var t=JSON.stringify(o[w].request);if(v===t){return o[w].answer}}}return undefined};this.getAnswers=function(){if(l!==undefined){var t={results:m};return t}return undefined};this.cancel=function(){h=true;if(typeof s.cbOnComplete==="function"){s.cbOnComplete(n)}if(s.cbOnCancel&&(typeof s.cbOnCancel==="function")){s.cbOnCancel(n)}};this.start=function(){if(s.requests!==undefined){if(Array.isArray(s.requests)){r=s.requests.length;if(r>0){if(typeof s.requests[0]==="string"){l=false;o={};g=s.requests.filter(function(u,v,t){return(t.indexOf(u)==v)});r=g.length}else{if(typeof s.requests[0]==="object"){l=true;o=[];g=s.requests}}if(l!==undefined){i=0;j=k-1;if(j>=r){j=r-1}this.process();return}}}}if(typeof s.cbOnComplete==="function"){s.cbOnComplete(n)}};this.start()},MassChunkedRequestsLWC:function(t){var q=30;var k=t.chunkSize||q;var l,g,o,s;var m=[];var p=[];var r=0;var i=0;var j=0;var h=false;var n=this;this.process=function(){if(p.length===s){return}if(typeof t.cbOnProcess==="function"){var u=g.slice(i,i+k);t.cbOnProcess(n,u)}};this.reprocess=function(){if(h){return}if(typeof t.cbOnProcess==="function"){var u=g.slice(i,i+k);t.cbOnProcess(n,u)}};this.setAnswer=function(w,x){if(h){return}r++;if(l){o.push({request:w,answer:x})}else{o[w]=x}var u;if(x.path){u=x.path.join("_");p.push(u)}m.push(x);if(typeof t.cbOnProgress==="function"){var v=p.length/s;t.cbOnProgress(n,v,w)}if(p.length===s){if(typeof t.cbOnComplete==="function"){t.cbOnComplete(n);h=true}}};this.setAnswers=function(v,w){m=w;p=v;if(typeof t.cbOnProgress==="function"){var u=p.length/s;t.cbOnProgress(n,u,v)}if(typeof t.cbOnComplete==="function"){t.cbOnComplete(n);h=true}};this.getAnswer=function(y){if(l!==undefined){if(!l){return o[y]}var w=JSON.stringify(y);for(var x=0,v=o.length;x<v;x++){var u=JSON.stringify(o[x].request);if(w===u){return o[x].answer}}}return undefined};this.getAnswers=function(){if(l!==undefined){var u={results:m};return u}return undefined};this.cancel=function(){h=true;if(typeof t.cbOnComplete==="function"){t.cbOnComplete(n)}if(t.cbOnCancel&&(typeof t.cbOnCancel==="function")){t.cbOnCancel(n)}};this.start=function(){if(t.requests!==undefined){if(Array.isArray(t.requests)){s=t.requests.length;if(s>0){if(typeof t.requests[0]==="string"){l=false;o={};g=t.requests.filter(function(v,w,u){return(u.indexOf(v)==w)});s=g.length}else{if(typeof t.requests[0]==="object"){l=true;o=[];g=t.requests}}if(l!==undefined){i=0;j=k-1;if(j>=s){j=s-1}this.process();return}}}}if(typeof t.cbOnComplete==="function"){t.cbOnComplete(n)}};this.start()}};return d});define("DS/PADUtils/utilsWS/PADLWCAccess",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/PADUtilsServices","DS/PADUtils/utilsWS/WSUtils"],function(f,c,e,d){var b={fetchLWC:{url:"/resources/enopad/lwc/fetch",verb:"POST"},expandLWC:{url:"/resources/enopad/lwc/expand",verb:"POST"},refreshLWC:{url:"/resources/enopad/lwc/refresh",verb:"POST"}};var a={fetch:function(o){var g="",m=o;var k=require("DS/PADUtils/PADSettingsMgt");var l=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";if(!UWA.is(m,"object")){throw new Error("Invalid inputs for PADLWCAccess.fetch")}m.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),};if(!m.timeout){m.timeout=k.getSetting("webapi_timeout")}var h=b.fetchLWC,n=m.data.authored!==undefined?m.data.authored:c.determineAuthoredFlag();m.method=h.verb;g=e.get3DSpaceUrl()+h.url+"?tenant="+e.getPlatformId();var j=[];m.pids.forEach(function(p){if(UWA.is(p,"array")&&p.length>1){j.push(p[p.length-1])}else{j.push(p)}});var i={label:e.getRequestLabel(),query:"physicalid:"+j.join(" OR physicalid:"),intent:m.data.intent,nresults:m.pids.length,tenant:e.getPlatformId(),authored:n,select_file:m.data.select_file,};if(i.include_param_Attributes===undefined&&k.getSetting("readsettingsv2")){i.include_param_Attributes=true}if(k.getSetting("pgpFromServer")===true){i.select_pgp=["Show"]}m.data=JSON.stringify(i);m.onTimeout=m.onTimeout||m.onFailure;return d.executeRequest(g,m)},expand:function(j){var i="",h=j;var k=require("DS/PADUtils/PADSettingsMgt");var g=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";if(!UWA.is(h,"object")){throw new Error("Invalid inputs for PADLWCAccess.fetch")}h.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),};if(!h.timeout){h.timeout=k.getSetting("webapi_timeout")}var m=b.expandLWC,l=h.data.authored!==undefined?h.data.authored:c.determineAuthoredFlag();h.method=m.verb;i=e.get3DSpaceUrl()+m.url+"?tenant="+e.getPlatformId();if(k.getSetting("readsettingsv2")){h.data.include_param_Attributes=true}if(!UWA.is(h.data.roots)&&UWA.is(h.data.root_physicalid)){h.data.roots=[{id:h.data.root_physicalid}]}else{if(!UWA.is(h.data.paths)&&UWA.is(h.data.root_path_physicalid)){h.data.paths=h.data.root_path_physicalid}}if(!UWA.is(h.data.level)){h.data.level=h.data.expand_iter}if(!UWA.is(h.data.intent)){h.data.intent="explore_2D"}if(!UWA.is(h.data.source)){h.data.source="cstorage"}if(!UWA.is(h.data.authored)&&!UWA.is(h.data.find_path_filter)){h.data.authored=h.data.authored!==undefined?h.data.authored:c.determineAuthoredFlag()}h.data.label=e.getRequestLabel();if(k.getSetting("pgpFromServer")===true){h.data.select_pgp=["Show"]}delete h.data.root_physicalid;delete h.data.expand_iter;delete h.data.enopad_webapis;delete h.data.select_bo;delete h.data.select_rel;delete h.data.select_ds6w_facet;if(!UWA.is(h.data.roots)&&!UWA.is(h.data.paths)){throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found")}h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(h.data);return d.executeRequest(i,h)},refresh:function(h){var i=require("DS/PADUtils/PADSettingsMgt");var j=b.refreshLWC;var g=e.get3DSpaceUrl()+j.url+"?tenant="+e.getPlatformId();if(!UWA.is(g)||!UWA.is(h,"object")){throw new Error("## PADWSv1.refresh: Invalid inputs")}if(!UWA.is(h.data,"object")){throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found")}h.method=j.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};if(!UWA.is(h.data.intent)){h.data.intent="explore_2D"}if(!UWA.is(h.data.source)){h.data.source="cstorage"}if(i.getSetting("readsettingsv2")){h.data.include_param_Attributes=true}h.data.authored=!h.data.authored?!c.isUsingIndex():h.data.authored;h.data.label=e.getRequestLabel();if(i.getSetting("pgpFromServer")===true){h.data.select_pgp=["Show"]}h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(h.data);d.executeSplittedRequest(g,h,{max:1,init:{query:{split:true},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:[]},response:{concat:["results"],copy:["full_path"]}}})}};return a});define("DS/PADUtils/utilsWS/WS4DECModel",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(e,f,b){var a={modify:{url:"/resources/enopad/authoring/modify",verb:"POST"},insertexisting:{url:"/resources/enopad/authoring/insertexisting",verb:"POST"},replace:{url:"/resources/enopad/authoring/replace",verb:"POST"},reorder:{url:"/resources/enopad/authoring/reorder",verb:"POST"},reparent:{url:"/resources/enopad/authoring/reparent",verb:"POST"},unparent:{url:"/resources/enopad/authoring/unparent",verb:"POST"},deleteinstance:{url:"/resources/enopad/authoring/deleteinstance",verb:"POST"},composite:{url:"/resources/enopad/authoring/composite",verb:"POST"},editability:{url:"/resources/enopad/navigate/editability",verb:"POST"},navigate:{url:"/resources/enopad/navigate/navigate",verb:"POST"},completeselection:{url:"/resources/enov5ma/productstructure/completeselection",verb:"POST"}};var c=function(i,g){var j=require("DS/PADUtils/PADSettingsMgt");var l=a[g];var k=UWA.clone(i,false);k.method=l.verb;k.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang"),};if(typeof k.data==="object"){k.data=JSON.stringify(k.data)}var h=f.get3DSpaceUrl()+l.url+"?tenant="+f.getPlatformId();console.group();console.error("=======================================");console.error("=== DEPRECATED USAGE OF THIS WEBAPI ===");console.error("===    ["+g+"]    ===");console.error("=======================================");console.groupEnd();return e.executeRequest(h,k)};var d={modify:function(j){if(!UWA.is(j,"object")){throw new Error("No parameter defined")}if(!UWA.is(j.data,"array")){throw new Error("No input data defined")}if(!UWA.is(j.onComplete,"function")){throw new Error("No onComplete callback function defined")}if(!UWA.is(j.onFailure,"function")){throw new Error("No onFailure callback function defined")}var h={nodes:j.data,commit:true};var k=a.modify;var i=f.get3DSpaceUrl();i=i+k.url+"?tenant="+f.getPlatformId();var g={};g.method=k.verb;g.headers={Accept:"application/json","Content-Type":"application/json"};g.data=JSON.stringify(h);g.onComplete=j.onComplete;g.onFailure=j.onFailure;g.onTimeout=j.onTimeout||j.onFailure;console.group();console.error("=======================================");console.error("=== DEPRECATED USAGE OF THIS WEBAPI ===");console.error("===           [modify]              ===");console.error("=======================================");console.groupEnd();return e.executeRequest(i,g)},insertExisting:function(g){c(g,"insertexisting")},replace:function(g){c(g,"replace")},reorder:function(g){c(g,"reorder")},reParent:function(g){c(g,"reparent")},detach:function(g){c(g,"unparent")},deleteInstance:function(g){c(g,"deleteinstance")},composite:function(g){c(g,"composite")},getEditability:function(h){if(!UWA.is(h,"object")){throw new Error("No options defined")}if(!UWA.is(h.data,"object")){throw new Error("No data defined")}if(!UWA.is(h.data.ids,"array")){throw new Error("No physicalids defined")}if(!UWA.is(h.data.intent,"string")){throw new Error("No intent defined")}if(!UWA.is(h.data.name,"array")){throw new Error("No criteria defined")}if(!UWA.is(h.data.authored,"boolean")){throw new Error("No authored defined")}if(!UWA.is(h.data.lang,"string")){throw new Error("No language defined")}if(!UWA.is(h.onComplete,"function")){throw new Error("No onComplete defined")}if(!UWA.is(h.onFailure,"function")){throw new Error("No onFailure defined")}var i=a.editability;var g=f.get3DSpaceUrl()+i.url+"?tenant="+f.getPlatformId();h.method=i.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};if(h.data.name[0]==="move"&&h.data.intent==="explore_3D"){h.data.rel_physicalid=h.data.ids;delete h.data.ids}if(!UWA.is(h.data.source)){h.data.source="cstorage"}h.data.authored=!h.data.authored?!b.isUsingIndex():h.data.authored;h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(h.data);console.group();console.error("=======================================");console.error("=== DEPRECATED USAGE OF THIS WEBAPI ===");console.error("===        [getEditability]         ===");console.error("=======================================");console.groupEnd();return e.executeRequest(g,h)},navigateOnLinks:function(h){if(!UWA.is(h,"object")){throw new Error("No options defined")}if(!UWA.is(h.data,"object")){throw new Error("No data defined")}if(!UWA.is(h.data.intent,"string")){throw new Error("No intent defined")}if(!UWA.is(h.data.authored,"boolean")){throw new Error("No authored defined")}if(!UWA.is(h.data.nav_pattern,"array")){throw new Error("No nav_pattern defined")}if(!UWA.is(h.data.nav_pattern[0].name,"string")){throw new Error("No criteria defined")}if(!UWA.is(h.data.nav_pattern[0].direction,"string")){throw new Error("No direction defined")}if(!UWA.is(h.data.nav_pattern[0].physicalid,"array")){throw new Error("No ids defined")}if(!UWA.is(h.onComplete,"function")){throw new Error("No onComplete defined")}if(!UWA.is(h.onFailure,"function")){throw new Error("No onFailure defined")}var i=a.navigate;var g=f.get3DSpaceUrl()+i.url+"?tenant="+f.getPlatformId();if(!UWA.is(g)){throw new Error("Invalid inputs for PADWSAccess.navigateOnLinks")}h.method=i.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};if(!UWA.is(h.data.source)){h.data.source="cstorage"}h.data.authored=!h.data.authored?!b.isUsingIndex():h.data.authored;h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(h.data);console.group();console.error("=======================================");console.error("=== DEPRECATED USAGE OF THIS WEBAPI ===");console.error("===        [navigateOnLinks]        ===");console.error("=======================================");console.groupEnd();return e.executeRequest(g,h)},completeselection:function(h){var i=a.completeselection;var g=f.get3DSpaceUrl()+i.url+"?tenant="+f.getPlatformId();h.method=i.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(h.data);console.group();console.error("=======================================");console.error("=== DEPRECATED USAGE OF THIS WEBAPI ===");console.error("===       [completeselection]       ===");console.error("=======================================");console.groupEnd();return e.executeRequest(g,h)}};return d});define("DS/PADUtils/utilsWS/CVServletServices",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices"],function(e,b,c){var a={fetch:{url:"/cvservlet/fetch/v2",verb:"POST"},expand:{url:"/cvservlet/expand",verb:"POST"},multiexpand:{url:"/cvservlet/multiexpand",verb:"POST"},expand3D:{url:"/cvservlet/expand3d",verb:"POST"},expandv2:{url:"/cvservlet/progressiveexpand/v2",verb:"POST"},wrap:{url:"/cvservlet/wrap",verb:"POST"},progressiveExpand:{url:"/cvservlet/progressiveexpand",verb:"POST"},search:{url:"/search",verb:"POST"}};var d={_logger:{nbCalls:0,inputDataSize:[],outputDataSize:[],inputDataSizeLog:[],outputDataSizeLog:[]},fetch:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var f=j.getSetting("pad_security_ctx")?j.getSetting("pad_security_ctx"):"preferred";var h=c.get3DSpaceUrl()+a.fetch.url+"?SecurityContext="+f+"&tenant="+c.getPlatformId();var k=i.data;delete i.data;var g=e.extend({method:a.fetch.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang"),},timeout:i.timeout?i.timeout:j.getSetting("webapi_timeout")},i);var l=e.extend({label:c.getRequestLabel(),physicalid:i.pids,locale:j.getSetting("lang"),tenant:c.getPlatformId()},k);if(i.noCompletion!==true){if(l.intent==="fetch_3D"){l=b.completeWebAPIPayload("fetch3d",l,i)}else{l=b.completeWebAPIPayload("fetch2d",l,i)}}delete g.pids;delete g.enopad_webapis;delete l.intent;delete l.authored;if(l.select_predicate){l.select_predicate=l.select_predicate.filter(function(o,n,m){return m.indexOf(o)===n})}g.data=JSON.stringify(l);g.onTimeout=g.onTimeout||g.onFailure;return b.executeRequest(h,g)},expand:function(i){var k=require("DS/PADUtils/PADSettingsMgt");var f=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";var h=c.get3DSpaceUrl()+a.expand.url+"?SecurityContext="+f+"&tenant="+c.getPlatformId();var l=i.data;delete i.data;var g=e.extend({method:a.expand.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),},timeout:i.timeout?i.timeout:k.getSetting("webapi_timeout"),},i);var j;if(l.root_path_physicalid){j=l.root_path_physicalid}else{if(l.paths){j=l.paths}else{if(l.root_physicalid){j=[[l.root_physicalid]]}else{console.error("## CVServletServices.expand: No roots defined in input")}}}var m=e.extend({label:c.getRequestLabel(),locale:k.getSetting("lang"),tenant:c.getPlatformId(),root_path_physicalid:j,},l);m=b.completeWebAPIPayload("expand",m,i);delete g.enopad_webapis;delete m.intent;delete m.root_physicalid;delete m.authored;m.select_bo=m.select_bo.filter(function(p,o,n){return n.indexOf(p)===o});g.data=JSON.stringify(m);g.onTimeout=g.onTimeout||g.onFailure;return b.executeRequest(h,g)},expand3d:function(i){var k=require("DS/PADUtils/PADSettingsMgt");var f=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";var h=c.get3DSpaceUrl()+a[i.expand3DType].url+"?SecurityContext="+f+"&tenant="+c.getPlatformId();if(i.expand3DType==="progressiveExpand"){h+="&output_format=cvjson"}var l=i.data;delete i.data;var g=e.extend({method:a[i.expand3DType].verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),},timeout:i.timeout?i.timeout:k.getSetting("webapi_timeout"),},i);var j;if(l.root_path_physicalid){j=l.root_path_physicalid}else{if(l.paths){j=l.paths}else{if(l.root_physicalid){j=[[l.root_physicalid]]}else{console.error("## CVServletServices.expand3d: No roots defined in input")}}}var m=e.extend({label:c.getRequestLabel(),locale:k.getSetting("lang"),tenant:c.getPlatformId(),root_path_physicalid:j,},l);m=b.completeWebAPIPayload("expand3d",m,i);delete g.expand3DType;delete g.enopad_webapis;delete m.intent;delete m.root_physicalid;delete m.authored;delete m.debug;m.select_bo=m.select_bo.filter(function(p,o,n){return n.indexOf(p)===o});g.data=JSON.stringify(m);g.onTimeout=g.onTimeout||g.onFailure;return b.executeRequest(h,g)},progressiveExpand:function(r){var j=0;var g={};var k=require("DS/PADUtils/PADSettingsMgt");var l=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";var f=c.get3DSpaceUrl()+a.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+c.getPlatformId();var o=["boundingbox","nbchildren"];if(r.data.compute_select_bo.indexOf("thumbnail_3d")!==-1){o.push("thumbnail_3d_fallback_cgr")}else{o.concat(r.data.compute_select_bo)}var p=null;if(r.data.root_path_physicalid&&r.data.root_path_physicalid.length){var q=r.data.root_path_physicalid;p=[];for(j=0;j<q.length;j++){p.push({physical_id_path:q[j]})}}var n='((typecode:0 OR typecode:1) AND (ds6w_58_globaltype:"ds6w:Document" OR ds6w_58_globaltype:"ds6w:Part"))  OR (typecode:2 AND NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency"))';var h={batch:{expands:[{label:c.getRequestLabel(),root:{physical_id:r.data.rootPhID},parameters:{limit_timeout_in_ms:3000},filter:{and:{filters:[{prefix_filter:{prefix_path:p?p:[{physical_id_path:[r.data.rootPhID]}]}},{in_frustum:{screen_width_px:r.data.screen_width_px,screen_height_px:r.data.screen_height_px,eye_position:r.data.eye_position,sight:r.data.sight,up:r.data.up,angle:r.data.angle,pixel_culling:r.data.pixel_culling,}},{sequence_filter:{sequence:[{uql:n}]}}]}},aggregation_processors:[{nb_children_approximation:{filter:{and:{filters:[{sequence_filter:{sequence:[{uql:n}]}}]}}}}]},{label:c.getRequestLabel(),root:{physical_id:r.data.rootPhID},filter:{and:{filters:[{prefix_filter:{prefix_path:p?p:[{physical_id_path:[r.data.rootPhID]}]}},{sequence_filter:{sequence:[{uql:n}]}}]}},aggregation_processors:[{truncate:{max_distance_from_prefix:1,prefix_filter:{prefix_path:p?p:[{physical_id_path:[r.data.rootPhID]}]}}},{nb_children_approximation:{filter:{and:{filters:[{sequence_filter:{sequence:[{uql:n}]}}]}}}}]}]},outputs:{select_object:r.data.select_bo,select_relation:r.data.select_rel,hits:{predefined_computation:o}}};var m={batch:{expands:[{label:c.getRequestLabel(),root:{physical_id:r.data.rootPhID},filter:{and:{filters:[{prefix_filter:{prefix_path:p?p:[{physical_id_path:[r.data.rootPhID]}]}},{in_frustum:{screen_width_px:r.data.screen_width_px,screen_height_px:r.data.screen_height_px,eye_position:r.data.eye_position,sight:r.data.sight,up:r.data.up,angle:r.data.angle,pixel_culling:r.data.pixel_culling,}},{sequence_filter:{sequence:[{uql:n}]}}]}},aggregation_processors:[{nb_children_approximation:{filter:{and:{filters:[{sequence_filter:{sequence:[{uql:n}]}}]}}}}]}]},outputs:{select_object:r.data.select_bo,select_relation:r.data.select_rel,hits:{predefined_computation:o}}};g.onComplete=function(s){var i=JSON.stringify(s);this._logger.outputDataSize.push(i.length);this._logger.outputDataSizeLog.push(Math.log(i.length));r.onComplete(s)}.bind(this);g.onFailure=r.onFailure;g.onTimeout=r.onTimeout||r.onFailure;g.timeout=r.timeout||"60000";g.method=a.expandv2.verb;g.headers={Accept:"application/json","Content-Type":"application/json"};g.data=JSON.stringify(h);this._logger.nbCalls++;this._logger.inputDataSize.push(g.data.length);this._logger.inputDataSizeLog.push(Math.log(g.data.length));return b.executeRequest(f,g)},multiexpand:function(i){var h=c.get3DSpaceUrl(),g=i;var j=require("DS/PADUtils/PADSettingsMgt");var f=j.getSetting("pad_security_ctx")?j.getSetting("pad_security_ctx"):"preferred";h=h+a.multiexpand.url+"?SecurityContext="+f+"&tenant="+c.getPlatformId();var g=e.extend({method:a.expand.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang"),},timeout:i.timeout?i.timeout:j.getSetting("webapi_timeout")},i);if(i.expand3DType!==undefined){g.data=b.completeWebAPIPayload("multiexpand3d",g.data,i)}else{g.data=b.completeWebAPIPayload("multiexpand2d",g.data,i)}delete g.enopad_webapis;delete g.expand3DType;delete g.data.intent;delete g.data.authored;g.data.select_bo=g.data.select_bo.filter(function(n,m,l){return l.indexOf(n)===m});var k=g.data.select_bo.indexOf("ds6w:xcadFileName");if(k!==-1){g.data.select_bo.splice(k,1)}g.onTimeout=g.onTimeout||g.onFailure;g.data.label=c.getRequestLabel();g.data=JSON.stringify(g.data);return b.executeRequest(h,g)},volumeQuery:function(i){if(!e.is(i.data.volume_filter)){throw new Error("## CVServletServices.volumeQuery: Invalid inputs: no volume defined")}var k=require("DS/PADUtils/PADSettingsMgt");var f=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";var h=c.get3DSpaceUrl()+a.expand3D.url+"?SecurityContext="+f+"&tenant="+c.getPlatformId();var l=i.data;delete i.data;var g=e.extend({method:a.expand3D.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),},timeout:i.timeout?i.timeout:k.getSetting("webapi_timeout"),},i);var j;if(l.root_path_physicalid){j=l.root_path_physicalid}else{if(l.paths){j=l.paths}else{if(l.root_physicalid){j=[[l.root_physicalid]]}else{console.error("## CVServletServices.volumeQuery: No roots defined in input")}}}var m=e.extend({label:c.getRequestLabel(),locale:k.getSetting("lang"),tenant:c.getPlatformId(),root_path_physicalid:j,},l);m=b.completeWebAPIPayload("expand3d",m,i);delete g.expand3DType;delete g.enopad_webapis;delete m.intent;delete m.root_physicalid;delete m.authored;delete m.debug;m.select_bo=m.select_bo.filter(function(p,o,n){return n.indexOf(p)===o});g.data=JSON.stringify(m);g.onTimeout=g.onTimeout||g.onFailure;return b.executeRequest(h,g)},search:function(h){var i=require("DS/PADUtils/PADSettingsMgt");var g=c.getPlatformURL("3DSearch")+a.search.url;var j=h.data;delete h.data;var f=e.extend({method:a.fetch.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":i.getSetting("lang"),},timeout:h.timeout?h.timeout:i.getSetting("webapi_timeout")},h);var k=e.extend({label:c.getRequestLabel(),locale:i.getSetting("lang"),tenant:c.getPlatformId()},j);if(h.noCompletion!==true){if(k.intent==="fetch_3D"){k=b.completeWebAPIPayload("fetch3d",k,h)}else{k=b.completeWebAPIPayload("fetch2d",k,h)}}if(k.select_predicate){k.select_predicate=k.select_predicate.filter(function(n,m,l){return l.indexOf(n)===m})}f.data=JSON.stringify(k);f.onTimeout=f.onTimeout||f.onFailure;return b.executeRequest(g,f)}};return d});define("DS/PADUtils/utilsWS/WSAdmin",["DS/WAFData/WAFData","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices"],function(a,e,c,f){var b={getscandcollab:{url:"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",verb:"GET"},predicates_nls_names:{url:"/resources/6WVocab/access/PredicatesNLSNames",verb:"GET"},getMyAppsTemplate:{url:"/resources/AppsMngt/user/preference",verb:"GET"},saveMyAppsTemplate:{url:"/resources/AppsMngt/user/preference",verb:"PUT"},readsettingsv2:{url:"/resources/enopad/admin/readsettings/v2",verb:"GET"},gettypeshierarchy:{url:"/resources/enong/dico/gettypeshierarchy",verb:"POST"},getTypeInfo:{url:"/resources/dictionary/getTypeInfo",verb:"POST"},interfaces:{url:"/resources/dictionary/class/interfaces",verb:"POST"}};var d={getscandcollab:function(h){var i=require("DS/PADUtils/PADSettingsMgt");var l=h;var k=b.getscandcollab;var j=l.tenant?l.tenant:f.getPlatformId();var g=f.get3DSpaceUrl(j)+k.url+"&tenant="+j;l.method=k.verb;l.headers={Accept:"application/json","Accept-Language":i.getSetting("lang"),"Content-Type":"application/json"};l.cache=-1;return e.executeRequest(g,l,true)},predicates_nls_names:function(i){var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("FedDictionnaryAccess")===true){throw new Error("## WSAdmin.predicates_nls_names: Call new FedDictionaryAccessAPI instead")}var k=b.predicates_nls_names;var h=f.get3DSpaceUrl()+k.url,g=i;g.method=k.verb;g.headers={Accept:"application/json","Accept-Language":j.getSetting("lang"),};g.data="name="+i.name+"&tenant="+f.getPlatformId();return e.executeRequest(h,g)},getElementsNLSNames:function(h){var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("FedDictionnaryAccess")===true){throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead")}var i=h||{};var g=f.get3DSpaceUrl()+"/resources/6WVocab/access/ElementsNLSNames?tenant="+f.getPlatformId();i.method="POST";i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":h.lang};i.data=h.elementsNLSNames;a.authenticatedRequest(g,i)},getPredicates:function(h){var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("FedDictionnaryAccess")===true){throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead")}var i=h||{};var g=f.get3DSpaceUrl()+"/resources/6WVocab/access/Predicates?tenant="+f.getPlatformId();i.method="POST";i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang")};i.data=h.classURIs;a.authenticatedRequest(g,i)},getVocabularyClasses:function(h){var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("FedDictionnaryAccess")===true){throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead")}var i=h||{};var g=f.get3DSpaceUrl()+"/resources/6WVocab/access/VocabularyClasses?tenant="+f.getPlatformId();i.method="GET";i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang")};i.timeout=60000;i.data="name="+h.vocabularyname;a.authenticatedRequest(g,i)},getTypeInfo:function(j){var k=require("DS/PADUtils/PADSettingsMgt");var m=b.getTypeInfo;var i=f.get3DSpaceUrl()+m.url+"?tenant="+f.getPlatformId(),h=j;if(h.url_parameters){var l=Object.getOwnPropertyNames(j.url_parameters);for(var g=0;g<l.length;g++){i=i+"&"+l[g]+"="+j.url_parameters[l[g]]}delete h.url_parameters}h.method=m.verb;h.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),};h.data=JSON.stringify(h.body);delete h.body;return e.executeRequest(i,h)},interfaces:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var k=b.interfaces;var h=f.get3DSpaceUrl()+k.url+"?tenant="+f.getPlatformId(),g=i;g.method=k.verb;g.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang"),};g.data=JSON.stringify(g.data);return e.executeRequest(h,g)},getMyAppsTemplate:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var k=b.getMyAppsTemplate;var h=f.getPlatformURL("3DCompass")+k.url,g=i;g.method=k.verb;g.headers={Accept:"application/json, text/plain",};g.data={name:i.preference_name};return e.executeRequest(h,g)},saveMyAppsTemplate:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var k=b.saveMyAppsTemplate;var h=f.getPlatformURL("3DCompass")+k.url,g=i;g.method=k.verb;g.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"};g.data={name:i.preference_name,value:i.value};return e.executeRequest(h,g)},padtreelistOpts:function(h){var i=require("DS/PADUtils/PADSettingsMgt");var k=b.readsettingsv2;var g=f.get3DSpaceUrl()+k.url+"?tenant="+f.getPlatformId();var j=h;j.method=k.verb;j.headers={Accept:"application/json"};if(h.data.intent===undefined||h.data.app===undefined){throw new Error("Invalid inputs for WSAdmin.padtreelistOpts")}j.data="intent="+h.data.intent+"&app="+h.data.app+"&reset="+((h.data.reset===true)?"true":"false");return e.executeRequest(g,j)},getTypesHierarchy:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var k=b.gettypeshierarchy;var h=f.get3DSpaceUrl()+k.url+"?tenant="+f.getPlatformId(),g=i;g.method=k.verb;g.headers={Accept:"application/json","Content-Type":"application/json"};g.data=JSON.stringify({types:i.types});return e.executeRequest(h,g)},getsecuritycontext:function(g){g.onFailure("DEPRECATED METHOD")},availablesecuritycontext:function(g){g.onFailure("DEPRECATED METHOD")},catalogs:function(g){g.onFailure("DEPRECATED METHOD")}};return d});define("DS/PADUtils/utilsWS/WSMiscellaneous",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","require"],function(d,e,c){var a={getdownloadurl:{url:"/resources/enopad/navigate/getstreamurl",verb:"POST"},read:{url:"/resources/v1/collabServices/attributes/op/read",verb:"POST"},update:{url:"/resources/v1/collabServices/attributes/op/update",verb:"PUT"},getfcsurls:{url:"/resources/enopad/getfcsurls",verb:"POST"},getConfiguredObjectInfo:{url:"/resources/modeler/configuration/navigationServices/getConfiguredObjectInfo/pid:",verb:"GET"},configurationdictionary:{url:"/resources/modeler/browsing/browseservice/pid:$PID_MODEL$/configurationdictionary",verb:"POST"},getproductconfigurations:{url:"/resources/modeler/browsing/model/$PID_MODEL_VERSION$/getproductconfigurations",verb:"GET"},createVolatileFilter:{url:"/resources/modeler/configuration/filteringServices/createVolatileFilter",verb:"POST"},retrievePQ:{url:"/resources/SNAPI/pq_services/pqs",verb:"GET"},getFiltersFromIds:{url:"/resources/FilterBIAPI/Filter/getFiltersFromIds",verb:"POST"}};var b={getFcsUrls:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var f=j.getSetting("pad_security_ctx")?j.getSetting("pad_security_ctx"):"preferred";var h=e.get3DSpaceUrl()+a.getfcsurls.url+"?SecurityContext="+f+"&tenant="+e.getPlatformId(),g=i;g.method=a.getfcsurls.verb;g.headers={Accept:"application/json","Content-Type":"application/json"};g.data=JSON.stringify(g.data);return d.executeRequest(h,g)},getDownloadUrl:function(h){var g=e.get3DSpaceUrl()+a.getdownloadurl.url+"?tenant="+e.getPlatformId(),f=h;f.method=a.getdownloadurl.verb;f.headers={Accept:"application/json","Content-Type":"application/json"};f.data=JSON.stringify(f.data);return d.executeRequest(g,f)},read:function(i){var k=i;var h=e.get3DSpaceUrl()+a.read.url+"?tenant="+e.getPlatformId();k.method=a.read.verb;var f;if(e.isAuthoringCtxAvailable()){try{var g=c("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");f=g.get()}catch(j){console.warn("CfgAuthoringContext throw an error")}}k.headers={Accept:"application/json","Content-Type":"application/json"};if(f&&f.change.id!==""){k.headers["DS-Change-Authoring-Context"]="pid:"+f.change.id}if(f&&f.AuthoringContextHeader!==null){UWA.extend(k.headers,f.AuthoringContextHeader)}k.cache=-1;delete k.ids;k.onTimeout=k.onTimeout||k.onFailure;k.data=JSON.stringify(k.data);return d.executeRequest(h,k)},update:function(i){var k=i;var h=e.get3DSpaceUrl()+a.update.url+"?tenant="+e.getPlatformId();k.method=a.update.verb;var f;if(e.isAuthoringCtxAvailable()){try{var g=c("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");f=g.get()}catch(j){console.warn("CfgAuthoringContext throw an error")}}k.headers={Accept:"application/json","Content-Type":"application/json"};if(f&&f.change.id!==""){k.headers["DS-Change-Authoring-Context"]="pid:"+f.change.id}k.cache=-1;k.onTimeout=k.onTimeout||k.onFailure;k.data=JSON.stringify(k.data);return d.executeRequest(h,k)},getConfiguredObjectInfo:function(g){var h=g;var f=e.get3DSpaceUrl()+a.getConfiguredObjectInfo.url+g.pid+"?cfgCtxt=1&tenant="+e.getPlatformId();h.method=a.getConfiguredObjectInfo.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};h.cache=-1;h.onTimeout=h.onTimeout||h.onFailure;h.data="";return d.executeRequest(f,h,false,true)},configurationDictionary:function(g){var h=g;var f=e.get3DSpaceUrl()+a.configurationdictionary.url+"?latestMainProductNode=1&tenant="+e.getPlatformId();f=f.replace("$PID_MODEL$",g.modelVersion);h.method=a.configurationdictionary.verb;h.headers={Accept:"application/json,text/javascript,*/*","Content-Type":"application/x-www-form-urlencoded; charset=utf-8"};h.cache=-1;h.onTimeout=h.onTimeout||h.onFailure;return d.executeRequest(f,h,true,true)},getProductConfigurations:function(h){var i=h;var g={version:"1.0.0",input:{productPIDs:h.modelVersionPid,status:"0",basics:"description,name,current,to[Product Configuration].from.attribute[Marketing Name],to[Product Configuration].from.revision",attributes:"ValidationStatus,CompletenessStatus"}};var f=e.get3DSpaceUrl()+a.getproductconfigurations.url;f=f.replace("$PID_MODEL_VERSION$",h.modelid);i.method=a.getproductconfigurations.verb;i.headers={Accept:"application/json","Content-Type":"application/json"};i.cache=-1;i.onTimeout=i.onTimeout||i.onFailure;i.data="filteringCriteria="+encodeURIComponent(JSON.stringify(g))+"&tenant="+e.getPlatformId();return d.executeRequest(f,i,false,true)},createVolatileFilter:function(g){var h=g;var f=e.get3DSpaceUrl()+a.createVolatileFilter.url+"?tenant="+e.getPlatformId();h.method=a.createVolatileFilter.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};h.cache=-1;h.onTimeout=h.onTimeout||h.onFailure;h.data="filteringCriteria="+encodeURIComponent(JSON.stringify(filteringCriteriaJSON))+"&tenant="+e.getPlatformId();return d.executeRequest(f,h,false,true)},retrievePQ:function(g){var h=require("DS/PADUtils/PADSettingsMgt");var i=g;var f=e.get3DSpaceUrl()+a.retrievePQ.url+"?tenant="+e.getPlatformId();i.method=a.retrievePQ.verb;i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":h.getSetting("lang")};i.cache=-1;i.onTimeout=i.onTimeout||i.onFailure;return d.executeRequest(f,i,false,true)},getFiltersFromIds:function(g){var h=g;var f=e.get3DSpaceUrl()+a.getFiltersFromIds.url+"?tenant="+e.getPlatformId();h.method=a.getFiltersFromIds.verb;h.headers={Accept:"application/json","Content-Type":"application/json"};h.cache=-1;h.onTimeout=h.onTimeout||h.onFailure;h.data=JSON.stringify(g.data);return d.executeRequest(f,h,true,true)}};return b});define("DS/PADUtils/PADDictionaryAccess",["UWA/Promise","DS/Utilities/Utils","DS/FedDictionaryAccess/FedDictionaryAccessAPI","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/XNavSettings"],function(g,f,h,j,d,a,c){var e={nodes2update:[],idx:0,nlsInProgress:[]};var i=f.debounce(function(p){b.idx=0;var n=this,o={},m,l;var k=new g(function(r){var q=e.nodes2update;e.nodes2update=[];g.all(e.nlsInProgress).then(function(){var s=c.getAvailableColumns();if(s&&q.length){for(m=0;m<p.length;m++){var t=Object.getOwnPropertyNames(p[m].options.grid);for(l=0;l<t.length;l++){if(t[l]!=="ds6w:reserved"&&UWA.is(p[m].options.grid[t[l]])&&p[m].options.grid[t[l]]!==""&&c.isHardcodedColumn(t[l])===false){if(s.available_columns.indexOf(t[l])!==-1){if(o[t[l]]===undefined){o[t[l]]=[]}if(o[t[l]].indexOf(p[m].options.grid[t[l]])===-1){o[t[l]].push(p[m].options.grid[t[l]])}}}}}h.getNlsOfPropertiesValues(JSON.stringify(o),{tenantId:a.getPlatformId(),lang:d.getSetting("lang"),apiVersion:"R2019x",onComplete:function(x){var y=UWA.is(x,"string")?JSON.parse(x):x;var A=Object.getOwnPropertyNames(y);function v(D){var B=false;var C={grid:D.options.grid};for(l=0;l<A.length;l++){if(C.grid[A[l]]&&y[A[l]][C.grid[A[l]]]&&y[A[l]][C.grid[A[l]]]!==C.grid[A[l]]){if(y[A[l]][C.grid[A[l]]].indexOf("emxFramework")!==0){B=true;C.grid[A[l]]=y[A[l]][C.grid[A[l]]]}}}return{updated:B,options:C}}var u=q[0].getTreeDocument();if(u){u.withTransactionUpdate(function(){for(m=0;m<q.length;m++){var C=q[m];var B=v(C);if(B.updated===true){delete C._treatingNLS;C.updateOptions(B.options)}}q=[]})}else{for(m=0;m<q.length;m++){var z=q[m];var w=v(z);if(w.updated===true){delete z._treatingNLS;z.updateOptions(w.options)}}q=[]}r()},onFailure:function(u){console.warn("Cannot retrieve NLS");if(u){console.warn("data="+u)}q=[];r()}})}})});e.nlsInProgress.push(k)},100);var b={updateColumnsWithNLS:function(o,r){var p=this;var n,m,q=[];p.completeResponse={};for(n=0;n<o.length;n++){var l=null;if(o[n].xnav_options&&o[n].xnav_options.name){l=o[n].xnav_options.name}else{if(o[n].ds6w){l=o[n].ds6w}}if(l){if(l.indexOf(":")!==-1){q.push(l)}else{if(o[n].xnav_options&&o[n].xnav_options.hardcoded===true){p.completeResponse[l]={nlsName:j[l],lang:d.getSetting("lang")}}else{if(j[l]){p.completeResponse[l]={nlsName:j[l],lang:d.getSetting("lang")}}else{console.warn("PADDictionaryAccess##FedDictionaryAccessAPI.getResourcesInfo Unknown attribute type:"+o[n].dataIndex)}}}}}var k=new g(function(t){var s={tenantId:a.getPlatformId(),lang:d.getSetting("lang"),apiVersion:"R2019x",onComplete:function(v){if(UWA.is(v,"array")){for(var u=0;u<v.length;u++){p.completeResponse[v[u].curi]={nlsName:v[u].label,lang:d.getSetting("lang")}}}t()},onFailure:function(w){var v=UWA.clone(q);if(UWA.is(w,"array")){for(var u=0;u<w.length;u++){var x=v.indexOf(w[u].curi);if(x!==-1){v.splice(x,1)}p.completeResponse[w[u].curi]={nlsName:w[u].label,lang:d.getSetting("lang")}}if(v.length){console.log("PADDictionaryAccess## FedDictionaryAccessAPI.getResourcesInfo can't find NLS for",JSON.stringify(v));for(var u=0;u<v.length;u++){p.completeResponse[v[u]]={nlsName:v[u],lang:d.getSetting("lang")}}}}t()}};h.getResourcesInfo(q.join(","),s)});k.then(function(){for(n=0;n<o.length;n++){var t=null;if(o[n].xnav_options){t=o[n].xnav_options.name}else{if(o[n].ds6w){t=o[n].ds6w}}if(t&&p.completeResponse[t]&&p.completeResponse[t].nlsName){o[n].text=p.completeResponse[t].nlsName}else{if(t&&t.indexOf("ds6w")!==-1){console.warn("PADDictionaryAccess## ds6w attribute ["+t+"] not found by FedDictionaryAccessAPI.getResourcesInfo")}else{if(t){var s=t.split(":");var u="";if(c.isHardcodedColumn(t)===false){if(s&&s.length===2){u=s[1]}else{u=t}}o[n].text=u}}}}r({status:"success",columns:o})})},updateNLS:function(k){k._treatingNLS=true;e.nodes2update.push(k);i(e.nodes2update)},getPropertiesForClass:function(k,l){h.getPropertiesForClass(k,l)},getVocabularyClasses:function(l,k){h.getVocabularyClasses(l,k)},getNlsOfPropertiesValues:function(k,l){h.getNlsOfPropertiesValues(k,l)},getResourcesInfo:function(k,l){h.getResourcesInfo(k,l)},predicates_nls_names:function(k,l){h.getVocabularyProperties(k,l)}};return b});define("DS/PADUtils/utilsWS/LWCDirectAccess",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices"],function(e,c,d){var b={fetch:{url:"/resources/enolwc/fetch/v1",verb:"POST"},expand:{url:"/resources/enolwc/expand/v1",verb:"POST"}};var a={fetch:function(i){var j=require("DS/PADUtils/PADSettingsMgt");var f=j.getSetting("pad_security_ctx")?j.getSetting("pad_security_ctx"):"preferred";var h=d.get3DSpaceUrl()+b.fetch.url+"?SecurityContext="+f+"&tenant="+d.getPlatformId();var k=i.data;delete i.data;var g=e.extend({method:b.fetch.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":j.getSetting("lang"),},timeout:i.timeout?i.timeout:j.getSetting("webapi_timeout")},i);var l=e.extend({label:d.getRequestLabel(),physicalid:i.pids,locale:j.getSetting("lang"),tenant:d.getPlatformId()},k);if(l.intent==="fetch_3D"){l=c.completeWebAPIPayload("fetch3d",l,i)}else{l=c.completeWebAPIPayload("fetch2d",l,i)}delete g.pids;delete g.enopad_webapis;delete l.intent;delete l.authored;l.select_predicate=l.select_predicate.filter(function(o,n,m){return m.indexOf(o)===n});g.data=JSON.stringify(l);g.onTimeout=g.onTimeout||g.onFailure;return c.executeRequest(h,g)},expand:function(i){var k=require("DS/PADUtils/PADSettingsMgt");var f=k.getSetting("pad_security_ctx")?k.getSetting("pad_security_ctx"):"preferred";var h=d.get3DSpaceUrl()+b.expand.url+"?SecurityContext="+f+"&tenant="+d.getPlatformId();var l=i.data;delete i.data;var g=e.extend({method:b.expand.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":k.getSetting("lang"),},timeout:i.timeout?i.timeout:k.getSetting("webapi_timeout")},i);var j=[];if(e.is(l.roots)){j=l.roots}else{if(e.is(l.root_physicalid)){j=[[l.root_physicalid]]}else{if(e.is(l.paths)){j=l.paths}else{if(e.is(l.root_path_physicalid)){j=l.root_path_physicalid}}}}var m=e.extend({label:d.getRequestLabel(),root_path_physicalid:j,locale:k.getSetting("lang"),tenant:d.getPlatformId()},l);if(m.intent==="Explore_3D"){m=c.completeWebAPIPayload("expand3d",m,i)}else{m=c.completeWebAPIPayload("expand",m,i)}delete g.pids;delete g.enopad_webapis;delete m.intent;delete m.authored;delete m.root_physicalid;m.select_bo=m.select_bo.filter(function(p,o,n){return n.indexOf(p)===o});m.select_rel=m.select_rel.filter(function(p,o,n){return n.indexOf(p)===o});g.data=JSON.stringify(m);g.onTimeout=g.onTimeout||g.onFailure;return c.executeRequest(h,g)},refresh:function(f){console.group();console.log("==============================");console.log("== LWCDirectAccess.refresh  ==");console.log("== Fallback on WSAccessV1   ==");console.log("==============================");console.groupEnd();require(["DS/PADUtils/utilsWS/WSAccessV1"],function(g){g.refresh(f)})},getDerivedOutputs:function(f){console.group();console.log("=======================================");console.log("== LWCDirectAccess.getDerivedOutputs ==");console.log("== Fallback on WSAccessV1            ==");console.log("=======================================");console.groupEnd();require(["DS/PADUtils/utilsWS/WSAccessV1"],function(g){g.getDerivedOutputs(f)})}};return a});define("DS/PADUtils/utilsWS/PADWSv1",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession","require",],function(g,d,f,b,c){var a={fetch:{url:"/resources/enopad/navigate/fetch",verb:"POST"},expand:{url:"/resources/enopad/navigate/expand",verb:"POST"},refresh:{url:"/resources/enopad/navigate/refresh",verb:"POST"}};var e={fetch:function(k){var j="",i=k;var l=require("DS/PADUtils/PADSettingsMgt");if(l.getSetting("useLWCWebServices")===true&&k.enopad_webapis===true&&k.data.intent!=="stream_2D"){c(["DS/PADUtils/utilsWS/PADLWCAccess"],function(p){p.fetch(k)})}else{var h=l.getSetting("pad_security_ctx")?l.getSetting("pad_security_ctx"):"preferred";if(!g.is(k.enopad_webapis)){k.enopad_webapis=false}i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":l.getSetting("lang"),};if(!i.timeout){i.timeout=l.getSetting("webapi_timeout")}if(k.enopad_webapis){var o=a.fetch,m=i.data.authored!==undefined?i.data.authored:b.determineAuthoredFlag();i.method=o.verb;j=f.get3DSpaceUrl()+o.url+"?tenant="+f.getPlatformId();var n={query:"physicalid:"+i.pids.join(" OR physicalid:"),intent:i.data.intent,nresults:i.pids.length,tenant:f.getPlatformId(),authored:m,};if(n.include_param_Attributes===undefined&&l.getSetting("readsettingsv2")){n.include_param_Attributes=true}i.data=JSON.stringify(n)}else{throw new Error("## PADWSv1.fetch: Invalid inputs enopad_webapis should be set to true")}i.onTimeout=i.onTimeout||i.onFailure;return d.executeRequest(j,i)}},navigate:function(l){var k=f.get3DSpaceUrl(),j=l;var m=require("DS/PADUtils/PADSettingsMgt");if(m.getSetting("useLWCWebServices")===true&&l.enopad_webapis===true){c(["DS/PADUtils/utilsWS/PADLWCAccess"],function(o){o.expand(l)})}else{var n=a.expand;var i=m.getSetting("pad_security_ctx")?m.getSetting("pad_security_ctx"):"preferred";if(!g.is(l.enopad_webapis)){l.enopad_webapis=false}if(l.enopad_webapis){k=k+n.url+"?tenant="+f.getPlatformId()}else{if(j.data.intent==="explore_2D"){k=k+"/cvservlet/expand?SecurityContext="+i+"&tenant="+f.getPlatformId()}else{l.expand3DType=l.expand3DType===undefined?"expand3D":l.expand3DType;switch(l.expand3DType){case"expand3D":k=k+"/cvservlet/expand3d?SecurityContext="+i+"&tenant="+f.getPlatformId();break;case"wrap":k=k+"/cvservlet/wrap?SecurityContext="+i+"&tenant="+f.getPlatformId();break;case"progressiveExpand":k=k+"/cvservlet/progressiveexpand?SecurityContext="+i+"&tenant="+f.getPlatformId();break}delete l.expand3DType}}if(!g.is(k)||!g.is(j,"object")){throw new Error("## PADWSv1.navigate: Invalid inputs")}if(!g.is(j.data,"object")){throw new Error("## PADWSv1.navigate: Invalid inputs options.data not found")}j.method=n.verb;j.headers={Accept:"application/json","Content-Type":"application/json"};if(!j.timeout){j.timeout=m.getSetting("webapi_timeout")}if(m.getSetting("readsettingsv2")){j.data.include_param_Attributes=true}if(l.enopad_webapis){if(m.getSetting("use_gen_expand")){j.data.activate="use_gen_expand"}if(!g.is(j.data.roots)&&g.is(j.data.root_physicalid)){j.data.roots=[{id:j.data.root_physicalid}]}else{if(!g.is(j.data.paths)&&g.is(j.data.root_path_physicalid)){j.data.paths=j.data.root_path_physicalid}}if(!g.is(j.data.level)){j.data.level=j.data.expand_iter}if(!g.is(j.data.intent)){j.data.intent="explore_2D"}if(!g.is(j.data.source)){j.data.source="cstorage"}if(!g.is(j.data.authored)&&!g.is(j.data.find_path_filter)){j.data.authored=j.data.authored!==undefined?j.data.authored:b.determineAuthoredFlag()}delete j.data.root_physicalid;delete j.data.expand_iter;delete j.data.enopad_webapis;delete j.data.compute_select_bo;delete j.data.select_bo;delete j.data.select_rel;delete j.data.select_ds6w_facet;if(!g.is(j.data.roots)&&!g.is(j.data.paths)){throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found")}}else{delete j.data.intent;delete j.data.authored;var h=m.getWebAPI_Options("navigate");if(!g.is(j.data.root_physicalid)&&!g.is(j.data.root_path_physicalid)&&!g.is(j.data.paths)){throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found")}if(!g.is(j.data.root_path_physicalid)&&g.is(j.data.paths)){j.data.root_path_physicalid=j.data.paths}if(!g.is(j.data.expand_iter)&&!g.is(j.find_in_ctx)){j.data.expand_iter=m.getSetting("expand_iter")}if(!g.is(j.data.select_bo)){j.data.select_bo=h.select_bo}if(!g.is(j.data.select_rel)){j.data.select_rel=h.select_rel}}j.onTimeout=j.onTimeout||j.onFailure;j.data=JSON.stringify(j.data);return d.executeRequest(k,j)}},refresh:function(i){var j=require("DS/PADUtils/PADSettingsMgt");if(j.getSetting("useLWCWebServices")===true){c(["DS/PADUtils/utilsWS/PADLWCAccess"],function(l){l.refresh(i)})}else{var k=a.refresh;var h=f.get3DSpaceUrl()+k.url+"?tenant="+f.getPlatformId();if(!g.is(h)||!g.is(i,"object")){throw new Error("## PADWSv1.refresh: Invalid inputs")}if(!g.is(i.data,"object")){throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found")}i.method=k.verb;i.headers={Accept:"application/json","Content-Type":"application/json"};if(j.getSetting("use_gen_expand")){i.data.activate="use_gen_expand"}if(!g.is(i.data.intent)){i.data.intent="explore_2D"}if(!g.is(i.data.source)){i.data.source="cstorage"}if(j.getSetting("readsettingsv2")){i.data.include_param_Attributes=true}i.data.authored=!i.data.authored?!b.isUsingIndex():i.data.authored;i.onTimeout=i.onTimeout||i.onFailure;i.data=JSON.stringify(i.data);d.executeSplittedRequest(h,i,{max:1,init:{query:{split:true},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:["session"]},response:{concat:["results"],copy:["full_path"]}}})}},getDerivedOutputs:function(h){if(!g.is(h)||!g.is(h.pids)){throw new Error("## PADWSv1.getDerivedOutputs: Invalid inputs")}var i=require("DS/PADUtils/PADSettingsMgt");h.enopad_webapis=true;if(!g.is(h.data)){h.data={}}h.data.intent="stream_2D";this.fetch(h)}};return e});define("DS/PADUtils/views/PADCustomColorSet",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Scroller","UWA/Class/Collection","UWA/Class/View","DS/PADUtils/views/PADCustomColorView","text!DS/PADUtils/assets/PADCustomColor.json"],function(f,d,j,i,k,c,e,g,a,l,b){var h=a.extend({name:"padcustomcolorset",className:"padcustomcolorset",tagName:"div",defaultOptions:{mono_sel:true,color_set:"greyscale",color_category:"background"},setup:function(m){var o=m||{};var p=JSON.parse(b);var n=p[o.color_set];this._logger=c.getLogger(h);this.collection=new g(n);this.collection.forEach(function(q){q.set("label",o.color_category+"_"+q.get("label"))});this.defaults=p.defaults;this._parent(o)},render:function(){var o=this,p=8,m=0,n=UWA.createElement("div",{"class":this.getClassNames("_container")}).inject(this.container),q=UWA.createElement("div",{"class":"padcustomcolorset_row"}).inject(n);this.collection.forEach(function(s){if(m===p){q=UWA.createElement("div",{"class":"padcustomcolorset_row"}).inject(n);m=0}var r=new l({model:s,events:{select:o._onSelect.bind(o)}});r.render().inject(q);m++});return this},_onSelect:function(o){this._logger.log("_onSelect "+o);if(this.getOption("mono_sel")===true){var m=this.collection.where({selected:true});this.selected_model=null;if(m.length>0){var n=this;m.forEach(function(p){if(p.get("label")!==o){p.set("selected",false)}else{n.selected_model=p}})}this.dispatchEvent("select",this.selected_model.toJSON())}},clearSelection:function(){this.collection.forEach(function(m){if(m.get("selected")){m.set("selected",false)}})},select:function(m){this.collection.forEach(function(n){if(n.get("label")===m){n.set("selected",true)}})},setColor:function(n,o,m){this.collection.forEach(function(p){if(p.get("label")===n){p.set(o,m)}})},getColor:function(n,o){var m=null;this.collection.forEach(function(p){if(p.get("label")===n){m=p.get(o);return}});return m},resetToDefault:function(){this.clearSelection();var m=this.defaults.background;var n=this.defaults.foreground;this.collection.forEach(function(o){if(o.get("label")===m){o.set("selected",true)}if(o.get("label")===n){o.set("selected",true)}})}});return h});define("DS/PADUtils/views/PADSearchView",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class/View","UWA/Drivers/Alone","DS/Logger/Logger","DS/PADUtils/PADCommandProxy","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Handlebars/Handlebars","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","UWA/Event"],function(h,n,a,o,e,b,f,d,j,c,l,q){var g=null;var m='<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="right_search">            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-check fonticon-1x"  style="opacity:0;"></span></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search"  style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>';var i='<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div with_nav" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="pad_count_ctn" id="pad_count_ctn"><div class="pad_count" id="pad_count"></div></div>        <div class="right_search">            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-up-open ctn_search pad_nav"  style="display:none;" title="Previous"></span></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-down-open ctn_search pad_nav"  style="display:none;" title="Next"></span></div>            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search" style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>';function k(w,t,s){var r,v,u;if(!n.is(w,"object")){return w}u=Object.keys(w);for(r=0,v=u.length;r<v;r++){t.call(s,w[u[r]],u[r],w)}return w}var p=a.extend({name:"PADSearchView",_searchTriggered:false,className:"pad_global_ctn_search",_selected_paths:[],_insertReplaceNode:null,_insertParams:null,domEvents:{"click div.run_ctn_search":"_onSearch","click span.fonticon-check":"_onConfirmSelect","click div.clear_ctn_search":"_onClearSearch","click span.fonticon-up-open":"_onPrevious","click span.fonticon-down-open":"_onNext","keyup input.input_search":"_onSearchInputKeyUp","paste input.input_search":"_onSearchInputPaste","keydown input.input_search":"_onSearchInputKeyDown"},template:null,_logger:null,setup:function(r){var t=this;l.get().getPADTreeDocument()._insertFlag=true;var s=r||{};this._logger=e.getLogger(p);this._logger.log("setup");if(r.navigate_onresult===true){this.template=d.compile(i)}else{this.template=d.compile(m)}this._searchTriggered=false;this._parent(r);this._commandProxy=b.create({events:{onSelect:function(w,u){function v(){t.$clearSearchButton.style.display="inline-block";t.$searchInput.value=t._insertParams["ds6w:label"];t.input_text=t.$searchInput.value;t.$searchButton.style.opacity=1;t.$checkButton.style.opacity=1;l.get().getPADTreeDocument()._insertSelected=true}if(l.get().getPADTreeDocument()._insertFlag&&l.get().getPADTreeDocument().options.insert_replace===true){if(w.paths[0]){var y=w.paths[0];var z=y[y.length-1];var x=[];x.push({type:w.attributes[z].type});c.isTypesAuthorized(x,function(A){if(A.length>0){t._selected_paths=w.paths[0];t._insertReplaceNode=t._selected_paths[t._selected_paths.length-1];t._insertParams={"ds6w:type":w.attributes[t._insertReplaceNode].type,"ds6w:label":w.attributes[t._insertReplaceNode].label};if(!UWA.is(t._insertParams["ds6w:label"])){require(["DS/PADUtils/PADWSAccess"],function(C){t._insertParams["ds6w:label"]=f.PADProgressBar_loading;v();var B=j.getWebAPI_Options("fetch");C.fetch({enopad_webapis:j.getSetting("enopad_webapis"),data:B,pids:[t._selected_paths[t._selected_paths.length-1]],onComplete:function(H){var F=UWA.is(H,"string")?JSON.parse(H):H;if(!F.results||F.results.length!==1){t._insertParams["ds6w:label"]=null;v()}else{var I=F.results[0],E=null,D,G=I.attributes.length;for(D=0;D<G&&!E;D++){if(I.attributes[D].name==="ds6w:label"){E=I.attributes[D].value}}t._insertParams["ds6w:label"]=E;v()}},onFailure:function(){t._insertParams["ds6w:label"]=null;v()}})})}else{v()}}})}}}}})},render:function(){this._logger.log("render");var r=this.template();this.container.setContent(r);k({searchInput:"input.input_search",searchButton:"div.run_btn_search",checkButton:"span.fonticon-check",searchOptionButton:".option_ctn_search",clearSearchButton:"div.clear_btn_search",onprevious:"span.fonticon-up-open",onnext:"span.fonticon-down-open",padcount:"div.pad_count"},function(s,t){this["$"+t]=this.getElement(s)},this);if(this.$onprevious){this.$onprevious.title=f.PADSearchView_previous}if(this.$onnext){this.$onnext.title=f.PADSearchView_next}if(this.$clearSearchButton){this.$clearSearchButton.title=f.PADSearchView_clear}if(this.$searchButton){this.$searchButton.title=f.PADSearchView_search}if(this.$checkButton){this.$checkButton.title=f.PADSearchView_check}if(l.get().getPADTreeDocument().options.insert_replace===true){this.$searchInput.placeholder=f.PADSearchView_search_select;this.$searchInput.title=f.PADSearchView_search_select}else{this.$searchInput.placeholder=f.PADSearchView_search;this.$searchInput.title=f.PADSearchView_search}setTimeout((function(){this.$searchInput.focus()}).bind(this),500);return this},setCount:function(s){var r=this;this.$padcount.setContent(s.index+"/"+s.total);if(this.$onprevious!==null&&this.$onnext!==null){this.$onprevious.setStyle("display","inline-block");this.$onnext.setStyle("display","inline-block")}},_onConfirmSelect:function(s){var r=this;if(l.get().getPADTreeDocument()._insertSelected===true){if(UWA.is(this.options.callbacks.onSearch,"function")){this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:r._insertReplaceNode,"ds6w:type":r._insertParams["ds6w:type"],"ds6w:type_value":r._insertParams["ds6w:type"],"ds6w:label":r._insertParams["ds6w:label"]}])}l.get().getPADTreeDocument()._insertSelected=false;l.get().getPADTreeDocument()._insertFlag=false}},_onSearch:function(s){var r=this;l.get().getPADTreeDocument()._insertSelected=false;this._logger.log("_onSearch");this.$searchInput.blur();if(UWA.is(this.options.callbacks.onSearch,"function")){this.options.callbacks.onSearch.call(null,{search_value:this.$searchInput.value})}l.get().getPADTreeDocument()._insertFlag=false},_onClearSearch:function(s){var r=this;this._logger.log("_onClearSearch");this.$searchInput.value="";this.$clearSearchButton.hide();if(this.$checkButton){this.$checkButton.setStyle("opacity","0")}this.$searchButton.setStyle("opacity","0.1");this._searchTriggered=false;if(this.$onprevious!==null&&this.$onnext!==null&&this.$padcount!==null){this.$onprevious.hide();this.$onnext.hide();this.$padcount.setContent("")}if(UWA.is(this.options.callbacks.onClear,"function")){this.options.callbacks.onClear.call(null)}},_onSearchInputKeyUp:function(r){var s=this;if(this.$searchInput.value){this.$searchButton.setStyle("opacity","1");this.$clearSearchButton.setStyle("display","inline-block");if(this.$onprevious!==null&&this.$onnext!==null&&this._searchTriggered===true){this.$onprevious.setStyle("display","inline-block");this.$onnext.setStyle("display","inline-block")}}else{this.$clearSearchButton.hide();if(this.$onprevious!==null&&this.$onnext!==null&&this.$padcount!==null){this.$onprevious.hide();this.$onnext.hide();this.$padcount.setContent("")}this.$searchButton.setStyle("opacity","0.1")}if(this.$checkButton){if(this.input_text!==this.$searchInput.value){l.get().getPADTreeDocument()._insertSelected=false;this.$checkButton.setStyle("opacity","0.2")}}},_onSearchInputPaste:function(r){var s=this;setTimeout(function(){s._onSearchInputKeyUp()},200)},_onPrevious:function(){if(UWA.is(this.options.callbacks.onPrevious,"function")){this.options.callbacks.onPrevious.call(null)}},_onNext:function(){if(UWA.is(this.options.callbacks.onNext,"function")){this.options.callbacks.onNext.call(null)}},_onSearchInputKeyDown:function(r){var s=this;if(q.whichKey(r)==="return"||r.keyIdentifier==="Enter"||r.keyIdentifier==="return"){if(l.get().getPADTreeDocument()._insertSelected===true){if(UWA.is(this.options.callbacks.onSearch,"function")){this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:s._insertReplaceNode,"ds6w:type":s._insertParams["ds6w:type"],"ds6w:type_value":s._insertParams["ds6w:type"],"ds6w:label":s._insertParams["ds6w:label"]}])}l.get().getPADTreeDocument()._insertSelected=false;l.get().getPADTreeDocument()._insertFlag=false}else{this._onSearch()}}q.stopPropagation(r)},});return p});define("DS/PADUtils/views/PADModalChooser",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/views/PADSearchView","DS/UIKIT/Modal","css!UIKIT/UIKIT.css","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices"],function(e,g,a,j,i,b,c,l,h,k,f,d){var m=a.extend(j,{name:"padmodalchooser",_logger:null,_modal:null,options:{},init:function(o){this._logger=b.getLogger(l);this._logger.log("init");this._parent(o);this.setOptions(o);if(!o.renderTo){var r=document.getElementsByClassName("xnav_component");if(r&&r.length===1){o.renderTo=r[0]}else{o.renderTo=document.body}}var t=UWA.createElement("div");var p=this;new l({callbacks:{onSearch:this._onPADSearch.bind(this)}}).render().inject(t);document.addEventListener("keyup",function(u){if(u.keyCode===27){p._modal.destroy();f.get().getPADTreeDocument()._insertFlag=false}});this._modal=new h({className:this.name+"_modal",closable:false,body:t,visible:true,overlay:UWA.is(this.getOption("overlay"))?this.getOption("overlay"):true});if(o.position){if(o.position.top&&o.position.left){var s=document.getElementsByClassName("xnavrootlist");var n=s[0].offsetWidth;if(n!=="0"){o.position.left=n+"px"}this._modal.elements.content.setStyle("top",o.position.top);this._modal.elements.content.setStyle("left",o.position.left)}else{switch(o.position){case"above_action_bar":var q=o.renderTo.getBoundingClientRect();this._modal.elements.wrapper.setStyle("padding-top","calc("+q.height+"px - 80px)");this._modal.elements.wrapper.setStyle("padding-left","calc(50% - 135px)");break;default:this._logger.log("unknown style");break}}}this._modal.elements.container.addEventListener("click",function(u){console.log("view click",u);p._modal.destroy();f.get().getPADTreeDocument()._insertFlag=false});this._modal.elements.content.addEventListener("click",function(u){u.preventDefault();u.stopPropagation();return false});this._modal.inject(o.renderTo)},close:function(){this._modal.destroy()},_onPADSearch:function(s){this._logger.log("_onPADSearch with "+JSON.stringify(s));var q=this;if(f.get().getPADTreeDocument()._insertSelected===true){q._modal.destroy();var o=this.getOption("in_apps_search");o.in_apps_callback.call(null,s)}else{if(s.search_value.length){var p;var t=this.getOption("in_apps_search");if(this.getOption("retrieveSearchValue")===true){p=s.search_value;q._modal.destroy();var n=require("DS/PADUtils/PADSettingsMgt");if(n.getSetting("settypes")===true){d.setTypesForOFW(f.get().getPADTreeDocument())}var r=this.getOption("searchValueCallback");if(UWA.is(r,"function")){r.call(null,{searchValue:p})}}else{if(t){p=s.search_value;t.fts_value=p;t.callback=function(v){q._logger.log("In Apps Search callback");q._modal.destroy();var u=require("DS/PADUtils/PADSettingsMgt");if(u.getSetting("settypes")===true){d.setTypesForOFW(f.get().getPADTreeDocument())}if(UWA.is(t.in_apps_callback,"function")){t.in_apps_callback.call(null,v)}};t.cancel=function(){q._logger.log("In Apps Search Cancel callback");q._modal.destroy()};d.in_apps_search(t)}}}else{this._logger.log("No search done since no string inside the input");this._modal.destroy()}}}});return m});define("DS/PADUtils/views/PADCustomColorPicker",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Modal","DS/Controls/Button","DS/PADUtils/views/PADCustomColorSet","DS/PADUtils/views/PADCustomColorView"],function(c,l,e,k,h,f,a,g,i,d,j){var b=e.extend(h,k,{name:"padcustomcolorpicker",_logger:null,defaultOptions:{selected_color:null},init:function(B){this._logger=a.getLogger(b);this._logger.log("init");this._parent(B);var t=this;var y=UWA.createElement("div");var s=UWA.createElement("div");s.addClassName("padcustomcolorpicker_leftfooter");s.inject(y);var m=UWA.createElement("div");m.addClassName("padcustomcolorpicker_rightfooter");m.inject(y);var r=UWA.createElement("div");var w=new i({label:l.PADCustomColorPicker_OK_title,emphasize:"primary"});w.addEventListener("click",function(){t._onSaveAndApply()});var p=new i({label:l.PADCustomColorPicker_Cancel_title,});p.addEventListener("click",function(){t.elements.container.destroy()});var x=new i({label:l.PADCustomColorPicker_Reset_title,});x.addEventListener("click",function(){t._onReset()});p.getContent().setStyles({"float":"right"});w.getContent().setStyles({"float":"right","margin-right":"10px"});x.getContent().setStyles({"float":"left"});p.inject(m);w.inject(m);x.inject(s);var q=UWA.createElement("div");var u=UWA.createElement("div");u.setStyle("margin-left","10px");u.inject(q);var A=UWA.createElement("text",{"class":this.name+"_prompt",content:l.PADCustomColorPicker_preview});A.inject(u);this.preview=new d({color_set:"preview",color_category:"P"});this.preview.render().inject(u);var v=UWA.createElement("div");v.setStyle("float","left");v.setStyle("margin-left","10px");v.inject(q);var n=UWA.createElement("text",{"class":this.name+"_prompt",content:l.PADCustomColorPicker_background_color});n.inject(v);this.bgGreyscale=new d({color_set:"greyscale",color_category:"BG",events:{select:this._onSelect.bind(this)}});this.bgGreyscale.render().inject(v);this.bgPrimary=new d({color_set:"primary",color_category:"BG",events:{select:this._onSelect.bind(this)}});this.bgPrimary.render().inject(v);this.bgSecondary=new d({color_set:"secondary",color_category:"BG",events:{select:this._onSelect.bind(this)}});this.bgSecondary.render().inject(v);var o=UWA.createElement("div");o.setStyle("float","right");o.inject(q);var z=UWA.createElement("text",{"class":this.name+"_prompt",content:l.PADCustomColorPicker_text_color});z.inject(o);this.tcGreyscale=new d({color_set:"greyscale",color_category:"FG",events:{select:this._onSelect.bind(this)}});this.tcGreyscale.render().inject(o);this.tcPrimary=new d({color_set:"primary",color_category:"FG",events:{select:this._onSelect.bind(this)}});this.tcPrimary.render().inject(o);this.tcSecondary=new d({color_set:"secondary",color_category:"FG",events:{select:this._onSelect.bind(this)}});this.tcSecondary.render().inject(o);this.elements.container=new g({className:this.name,closable:true,header:l.PADCustomColorPicker_title,body:q,footer:y,visible:true,});if(B.renderTo){this.elements.container.inject(B.renderTo)}},_onSaveAndApply:function(){var o=this.preview.getColor("P_Preview","background_color");var n=this.preview.getColor("P_Preview","color");var m={background_color:o,color:n};this.dispatchEvent("onCustomColorOK",m);this.elements.container.destroy()},_onReset:function(){this.bgGreyscale.resetToDefault();this.bgPrimary.resetToDefault();this.bgSecondary.resetToDefault();this.tcGreyscale.resetToDefault();this.tcPrimary.resetToDefault();this.tcSecondary.resetToDefault();this.preview.setColor("P_Preview","background_color","#ffffff");this.preview.setColor("P_Preview","color","#000000")},_onSelect:function(m){var n=m.label;if(n.indexOf("BG_")===0){this.preview.setColor("P_Preview","background_color",m.background_color);if(n.indexOf("BG_Greyscale_")===-1){this.bgGreyscale.clearSelection()}if(n.indexOf("BG_Primary_")===-1){this.bgPrimary.clearSelection()}if(n.indexOf("BG_Secondary_")===-1){this.bgSecondary.clearSelection()}}if(n.indexOf("FG_")===0){this.preview.setColor("P_Preview","color",m.background_color);if(n.indexOf("FG_Greyscale_")===-1){this.tcGreyscale.clearSelection()}if(n.indexOf("FG_Primary_")===-1){this.tcPrimary.clearSelection()}if(n.indexOf("FG_Secondary_")===-1){this.tcSecondary.clearSelection()}}}});return b});define("DS/PADUtils/views/PADColorPicker",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/Controls/Button","DS/PADUtils/views/PADColorSet","DS/PADUtils/views/PADCustomColorPicker"],function(f,m,g,l,j,h,d,i,c,b,k,e){var a=g.extend(j,l,{name:"padcolorpicker",_logger:null,defaultOptions:{selected_color:{background_color:"#ffffff",color:"#000000"}},init:function(p){var r=this;this._logger=d.getLogger(a);this._logger.log("init");this._parent(p);this.selected_color=this.getOption("selected_color");var r=this;var u=UWA.createElement("div");var t=UWA.createElement("span");t.setStyle("margin-right","10px");var s=new b({label:m.PADCustomColorPicker_Add_title,icon:"plus",iconSize:"1x"});var q=new b({label:m.PADCustomColorPicker_Reset_title,icon:"clear",iconSize:"1x"});s.inject(t);t.inject(u);q.inject(u);var o=u.getElementsByClassName("wux-ui-fa-clear")[0];o.removeClassName("wux-ui-fa");o.removeClassName("wux-ui-fa-clear");o.removeClassName("wux-ui-fa-lg");o.addClassName("wux-ui-3ds");o.addClassName("wux-ui-3ds-clear");o.addClassName("wux-ui-3ds-lg");var n=UWA.createElement("div");this.colorSet=new k({selected_color:this.selected_color,events:{select:this._onSelect.bind(this)}}).render().inject(n);s.addEventListener("click",r._onAddCustomColor.bind(r));q.addEventListener("click",r._onResetToDefault.bind(r));this.elements.container=new i({className:this.name,closable:true,header:m.PADColorPicker_title,body:n,footer:u,visible:true,events:{onHide:function(){r.dispatchEvent("onClose")}}});if(p.renderTo){this.renderTo=p.renderTo;this.elements.container.inject(p.renderTo)}},_onAddCustomColor:function(){var o=this,n=new e({renderTo:this.renderTo,events:{onCustomColorOK:function(p){var q=16,r=localStorage.getItem("ENOPAD_CustomColors");if(r){r=JSON.parse(r);r.push(p)}else{r=[p]}if(r.length>q){r=r.slice(-q)}localStorage.setItem("ENOPAD_CustomColors",JSON.stringify(r));o.colorSet.updateCustomColors();o._onSelect(p)}}})},_onResetToDefault:function(){var n={background_color:"#ffffff",color:"#000000"};this._onSelect(n)},_onSelect:function(n){this.setOption("selected_color",n);this.dispatchEvent("onColorOK",n);this.elements.container.destroy()}});return a});define("DS/PADUtils/utilsWS/WSAccessV1",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/utilsWS/CVServletServices","DS/PADUtils/utilsWS/PADWSv1"],function(d,a,b,e,h,i,g,f){var c={fetch:function(j){if((b.getConfig("readOnlyApp")===true||j.enopad_webapis!==true)&&j.forceAuthoringCall!==true){return g.fetch(j)}else{return f.fetch(j)}},navigate:function(k){if(b.getConfig("readOnlyApp")===true||k.enopad_webapis!==true){var j=k.data.intent==="explore_2D"?"expand":k.expand3DType===undefined?"expand3D":k.expand3DType;if(j==="expand"){return g.expand(k)}else{k.expand3DType=j;return g.expand3d(k)}}else{return f.navigate(k)}},progressiveExpand:function(j){return g.progressiveExpand(j)},multiexpand:function(j){var k=false;if(b.getConfig("readOnlyApp")===false){k=j.data&&j.data.authored!==undefined?j.data.authored:a.determineAuthoredFlag()}if(k===true){console.warn("No multiexpand in authoring mode. Call on the index instead")}return g.multiexpand(j)},volumeQuery:function(j){return g.volumeQuery(j)},refresh:function(j){return f.refresh(j)},getDerivedOutputs:function(j){require(["DS/PADUtils/utilsWS/PADWSv1"],function(k){k.getDerivedOutputs(j)})},};c=d.extend(c,e);c=d.extend(c,h);c=d.extend(c,i);return c});define("DS/PADUtils/PADWSProxy",["UWA/Core","DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","UWA/Promise","DS/PADUtils/utilsWS/WSUtils","require"],function(f,i,e,h,c,g){var l=[];function a(){return""+Math.random().toString(36).substr(2,9)}function b(){var m=a();while(l.indexOf(m)!==-1){m=a()}l.push(m);return m}function j(m){return typeof m==="string"?JSON.parse(m):m}function k(n,m,o){return new h(function(q,p){m.onComplete=function(t){var s=j(t);var r=s;if(o){r=o(s)}q(r)};m.onFailure=function(r){p(r)};if(m.data){m.data=JSON.stringify(m.data)}c.executeRequest(n,m,false)})}var d={getcainfo:function(o){var p=g("DS/PADUtils/PADSettingsMgt");var m=o||{};var n=e.get3DSpaceUrl()+"/resources/modeler/change/changeaction/pid:"+o.id+"?attributes=1&context=1&people=1&applicability=1&proposed=1&realized=1";m.method="GET";m.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":p.getSetting("lang")};return k(n,m)},find_in_ctx:function(u){var m=e.get3DSpaceUrl(),t={};var q=g("DS/PADUtils/PADSettingsMgt");m=m+"/cvservlet/expand?SecurityContext=preferred&tenant="+e.getPlatformId();t.method="POST";t.headers={Accept:"application/json","Content-Type":"application/json"};var o=q.getWebAPI_Options("navigate");if(!o.select_bo){o={select_bo:["physicalid"],select_rel:["physicalid"]}}var s=f.extend({label:e.getRequestLabel(),root_physicalid:u.rootId},o,true);var r=[],n=[];for(var p=0;p<u.findids.length;p++){n.push([u.findids[p]])}r.push({option:["cut"],path_physicalid:n});s.find_path_filter=r;t.data=s;t.timeout=q.getSetting("webapi_timeout");return k(m,t,function(v){return{params:u,results:v}})},};return d});define("DS/PADUtils/PADChangeActionHandler",["DS/PADUtils/PADWSProxy","DS/PADUtils/views/PADAlert","UWA/Promise","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(l,a,j,c){function h(o){if(o.toUpperCase()==="TRUE"){return true}else{return false}}function g(o){if(o===""){return null}try{return new Date(o)}catch(p){console.error("Invalid Date String");return o}}function k(p){var r={};for(var q=0;q<p.length;q++){var o=p[q];switch(o.name){case"attribute_ActualCompletionDate":r.actualCompletionDate=g(o.value);break;case"attribute_ActualStartDate":r.actualStartDate=g(o.value);break;case"attribute_CategoryofChange":r.categoryOfChange=o.value;break;case"attribute_EstimatedCompletionDate":r.estimatedCompleteDate=g(o.value);break;case"attribute_EstimatedStartDate":r.estimatedStartDate=g(o.value);break;case"attribute_Originator":r.originator=o.value;break;case"attribute_ReasonForCancel":r.reasonForCancel=o.value;break;case"attribute_Severity":r.severity=o.value;break;case"attribute_Synopsis":r.synopsis=o.value;break;case"project":r.project=o.value;break;case"current":r.current=o.value;break;case"originated.generic":r.originated=g(o.value);break;case"organization":r.organization=o.value;break;case"modified":r.modified=h(o.value);break;case"interface[Change On Hold]":r.interfaceChangeOnHold=h(o.value);break;case"attribute_BypassPlants":r.bypassPlants=o.value;break;case"attribute_ResponsibleManufacturingEngineer":r.responsibleManufacturingEngineer=o.value;break;default:console.warn("switch handler not there"+o.name+" "+o.value);break}}return r}function f(u,t){var s=[];for(var r=0;r<u.length;r++){var q=u[r];var o=q.id;if(t===true){o=q.where.id}var p=n(o);m(s,p)}return s}function n(o){return o.substr(o.indexOf(":")+1)}function m(p,o){if(p.indexOf(o)===-1){p.push(o)}}function i(q,p){for(var o=0;o<p.length;o++){m(q,p[o])}}function d(p){var o=[];o=o.concat(f(p.changeaction.context));var q=o.length;i(o,f(p.changeaction.realized,true));if(o.length>q){i(o,f(p.changeaction.proposed,true))}return o}function b(o){var q=f(o.changeaction.realized,true);var p=f(o.changeaction.proposed,true);i(q,p);return q}var e={extractIds:f,extractRealizedAndProposed:b,parseAttributes:k,getInfos:function(s,r){var q=[];for(var p=0;p<s.length;p++){var o=l.getcainfo({id:s[p]});q.push(o)}j.all(q).then(function(t){r(t)})["catch"](function(t){a.displayNotification({eventID:"error",msg:c.generic_service_failure});console.error(t)})},determineExecution:function(p,o){if(p.changeaction.context.length>0&&p.changeaction.realized.length>0){o.addAndFind(p)}else{var q=d(p);if(q.length>0){o.add(q)}else{a.displayNotification({eventID:"warning",msg:c.WARN_empty_change_action});o.wasEmpty()}}}};return e});define("DS/PADUtils/utilsWS/WSAccessV2",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/utilsWS/LWCDirectAccess","DS/PADUtils/utilsWS/CVServletServices"],function(g,a,b,e,h,i,d,f){var c={fetch:function(j){var k=false;if(b.getConfig("readOnlyApp")===false){k=j.data&&j.data.authored!==undefined?j.data.authored:a.determineAuthoredFlag()}if(k===true){return d.fetch(j)}else{return f.fetch(j)}},navigate:function(k){var l=false;if(b.getConfig("readOnlyApp")===false){l=k.data&&k.data.authored!==undefined?k.data.authored:a.determineAuthoredFlag()}if(l===true){return d.expand(k)}else{var j=k.data.intent==="explore_2D"?"expand":k.expand3DType===undefined?"expand3D":k.expand3DType;if(j==="expand"){return f.expand(k)}else{k.expand3DType=j;return f.expand3d(k)}}},multiexpand:function(j){var k=false;if(b.getConfig("readOnlyApp")===false){k=j.data&&j.data.authored!==undefined?fetchOpts.data.authored:a.determineAuthoredFlag()}if(k===true){console.warn("No multiexpand in authoring mode. Call on the index instead")}return f.multiexpand(j)},volumeQuery:function(j){return f.volumeQuery(j)},search:function(j){return f.search(j)},refresh:function(j){return d.refresh(j)},getDerivedOutputs:function(j){return d.getDerivedOutputs(j)},};c=UWA.extend(c,e);c=UWA.extend(c,h);return c});define("DS/PADUtils/PADWSAccess",["DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAccessV1","DS/PADUtils/utilsWS/WSAccessV2"],function(a,c,b){if(a.getConfig("WSAccessV2")===true){return b}else{return c}});define("DS/PADUtils/PADTreeListDefinitionManager",["UWA/Class","UWA/Class/Options","UWA/Promise","DS/Logger/Logger","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWSAccess","DS/PADUtils/PADProbes"],function(a,h,g,b,i,c,e,j,f){var d=a.extend(h,{init:function(k){this._parent(k);this.appId=k.x3dAppId;this.reset=k.reset;this.padtreelst_def_file=k.padtreelst_def_file;this.storageKey="PADTreeListDefinition."+k.x3dAppId;this.pendingKey="getTreeListDefinitionPending."+k.x3dAppId;this._logger=b.getLogger(d)},getTreeListDefinition:function(p,l){this.probe=f.createProbe("init_treeListDef");var n=this;var k=localStorage.getItem(this.storageKey);var o=UWA.is(k,"string")?JSON.parse(k):k;if(UWA.is(o)){this.probe.end();delete this.probe;if(p){p(o)}}else{if(!sessionStorage.getItem(this.pendingKey)){sessionStorage.setItem(this.pendingKey,"true");require(["DS/PADUtils/PADWSAccess"],function(r){var q=c.getWebappsAssetUrl(n.padtreelst_def_file.module,n.padtreelst_def_file.asset);i.request(q,{onComplete:function(t){var s=UWA.is(t,"string")?JSON.parse(t):t;r.padtreelistOpts({data:{intent:s.buildTreeListOpts.intent,app:n.appId,reset:n.reset},onComplete:function(v){var u=UWA.is(v,"string")?JSON.parse(v):v;var w={build_tree_opts:s,json_response:u};localStorage.setItem(n.storageKey,JSON.stringify(w));sessionStorage.removeItem(n.pendingKey);n.probe.end();delete n.probe;if(p){p(w)}},onTimeout:function(){sessionStorage.removeItem(n.pendingKey);if(l){l(null)}},onFailure:function(){sessionStorage.removeItem(n.pendingKey);if(l){l(null)}}})},onTimeout:function(){sessionStorage.removeItem(n.pendingKey);if(l){l(null)}},onFailure:function(){sessionStorage.removeItem(n.pendingKey);if(l){l(null)}}})})}else{var m=function(q){if(q.key===n.pendingKey){window.removeEventListener("storage",n);if(p){p(localStorage.getItem(n.storageKey))}}};window.addEventListener("storage",m)}}}});return d});define("DS/PADUtils/PADRelatedDocuments",["DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices"],function(a,c){var b={getRelatedCADDocuments:function(h){var g=require("DS/PADUtils/PADSettingsMgt");var f=h||{};var e=c.get3DSpaceUrl()+"/cvservlet/navigate";f.method="POST";f.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":g.getSetting("lang")};if(!f.timeout){f.timeout=g.getSetting("webapi_timeout")}var d=g.getSetting("pad_security_ctx");if(UWA.is(d,"string")){f.headers.SecurityContext=d;e=e+"?SecurityContext="+d}f.data.primitives=[{navigate_from_rel:{id:1,filter:{rel_type:["VPMInstance"]}}},{navigate_to_sr:{id:2,filter:{role:["6"],semantics:["5"]}}},{navigate_from_sr:{id:3}},{navigate_from_rel:{id:4,filter:{rel_type:["XCADBaseDependency"]}},navigate_to_rel:{id:5,filter:{rel_type:["XCADBaseDependency"]}}}];f.data.patterns={RELATEDCADDOCS_TO:[{id:2}],RELATEDCADDOCS_FROM:[{id:3}],RELATEDXCADDOCS_FROM:[{id:4}],RELATEDXCADDOCS_TO:[{id:5}]};f.data.patternTypeFilters={RELATEDCADDOCS_TO:{typesToNotReturn:["PGPRep","VPMPort"]},RELATEDCADDOCS_FROM:{typesToNotReturn:["PGPRep","VPMPort"]}};f.data.version=3;f.data.attributes=["ds6w:label","ds6w:type","ds6w:responsible","ds6wg:revision","ds6w:identifier"];f.data.label=c.getRequestLabel();f.data=JSON.stringify(f.data);a.authenticatedRequest(e,f)},createDocument:function(i){var g=require("DS/PADUtils/PADSettingsMgt");var d={tenant:c.getPlatformId(),securityContext:g.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:i.onComplete,onFailure:i.onFailure},e={tempId:i.file.name,fileInfo:{file:i.file},relInfo:{parentId:i.parentId,parentRelName:"PLMDocConnection",parentDirection:"from"}};var h="DS/DocumentManagement/DocumentManagement";var f="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([h,f],function(l,k){if(k){var j=k.get();if(j&&j.change&&j.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+j.change.id}}}l.createDocument(e,d)},function(){i.onFailure.call({msg:h+" not found"})})},getDocuments:function(g){var e=require("DS/PADUtils/PADSettingsMgt");var f=function(){var h={getVersions:true,relInfo:{parentId:g.parentId,parentRelName:"PLMDocConnection",parentDirection:"from"},tenant:c.getPlatformId(),securityContext:e.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:g.onComplete,onFailure:g.onFailure};var i="DS/DocumentManagement/DocumentManagement";require([i],function(j){j.getDocumentsFromParent(h)},function(){g.onFailure.call({msg:i+" not found"})})};var d=e.getSetting("pad_security_ctx");if(d===false){c.updateWidgetSecPref({resolve:function(){f()}})}else{f()}},downloadDocument:function(h){var f=require("DS/PADUtils/PADSettingsMgt");var d={tenant:c.getPlatformId(),securityContext:f.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:h.onComplete,onFailure:h.onFailure};var g="DS/DocumentManagement/DocumentManagement";var e="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([g,e],function(k,j){if(j){var i=j.get();if(i&&i.change&&i.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+i.change.id}}}k.downloadDocument(h.docId,undefined,h.checkout,d)},function(){h.onFailure.call({msg:g+" not found"})})},modifyDocument:function(j){var h=require("DS/PADUtils/PADSettingsMgt");var e=j.file?j.file.name:"";e=e.replace(/\.[^/.]+$/,"");var d={tenant:c.getPlatformId(),securityContext:h.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:j.onComplete,onFailure:j.onFailure},f={id:j.docId,title:e,fileInfo:{file:j.file}};var i="DS/DocumentManagement/DocumentManagement";var g="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([i,g],function(m,l){if(l){var k=l.get();if(k&&k.change&&k.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+k.change.id}}}m.modifyDocument(f,d)},function(){j.onFailure.call({msg:i+" not found"})})},deleteDocument:function(h){var f=require("DS/PADUtils/PADSettingsMgt");var d={tenant:c.getPlatformId(),securityContext:f.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:h.onComplete,onFailure:h.onFailure};var g="DS/DocumentManagement/DocumentManagement";var e="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([g,e],function(k,j){if(j){var i=j.get();if(i&&i.change&&i.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+i.change.id}}}k.deleteDocument(h.docId,d)},function(){h.onFailure.call({msg:g+" not found"})})},attachDocument:function(e){var g=require("DS/PADUtils/PADSettingsMgt");var d={tenant:c.getPlatformId(),securityContext:g.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:e.onComplete,onFailure:e.onFailure,relInfo:{parentId:e.parentId,parentRelName:"PLMDocConnection",parentDirection:"from"}};var i=e.docId;var h="DS/DocumentManagement/DocumentManagement";var f="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([h,f],function(l,k){if(k){var j=k.get();if(j&&j.change&&j.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+j.change.id}}}l.connectDocumentToParent(i,d)},function(){e.onFailure.call({msg:h+" not found"})})},detachDocument:function(e){var g=require("DS/PADUtils/PADSettingsMgt");var d={tenant:c.getPlatformId(),securityContext:g.getSetting("pad_security_ctx"),tenantUrl:c.get3DSpaceUrl(),onComplete:e.onComplete,onFailure:e.onFailure,relInfo:{parentId:e.parentId,parentRelName:"PLMDocConnection",parentDirection:"from"}};var i=e.docId;var h="DS/DocumentManagement/DocumentManagement";var f="DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext";require([h,f],function(l,k){if(k){var j=k.get();if(j&&j.change&&j.change.id!==""){d.additionalHeaders={"DS-Change-Authoring-Context":"pid:"+j.change.id}}}l.disconnectDocumentFromParent(i,d)},function(){e.onFailure.call({msg:h+" not found"})})}};return b});define("DS/PADUtils/PADPredicatesNlsManager",["UWA/Class","UWA/Promise","DS/Utilities/Utils","DS/PADUtils/PADProbes","DS/PADUtils/PADUtilsServices","DS/i3DXSNDictionaryAPI/3DXSearchDictionaryAccess","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWSAccess","DS/PADUtils/XNavSettings","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(b,j,g,h,d,i,f,k,e,l){var c="ds6wg:XP_VPMReference_Ext.";var a=b.extend({name:"PADPredicatesNlsManager",nodes2update:[],nodes2updateId:[],init:function(m){this._parent(m)},updateColumnsWithNLS:function(o,x){var s=this;var r,q,y=[],n=[];s.completeResponse={};for(r=0;r<o.length;r++){var m=null;if(o[r].xnav_options){if(o[r].xnav_options.name){m=o[r].xnav_options.name}else{var u=o[r].xnav_options.dataIndex;if(u&&u==="instanceMatrix"){m=u}}}else{if(o[r].ds6w){m=o[r].ds6w}}if(m){if(m.indexOf("ds6wg:")!==-1){n.push(m)}else{if(m.indexOf(":")!==-1){y.push(m)}else{if(o[r].xnav_options&&o[r].xnav_options.hardcoded===true){s.completeResponse[m]={nlsName:l[m],lang:f.getSetting("lang")}}else{if(l[m]){s.completeResponse[m]={nlsName:l[m],lang:f.getSetting("lang")}}else{console.warn("Unknown attribute type:"+o[r].dataIndex)}}}}}}var v=[];var t=new j(function(z){i.getElementsNls(y.join(","),{tenantId:d.getPlatformId(),lang:f.getSetting("lang"),onComplete:function(A){var B=UWA.is(A,"string")?JSON.parse(A):A;s.completeResponse=UWA.extend(s.completeResponse,A);z()},onFailure:function(A){console.error("NLS FAILED >> getElementsNls >>",y);z()}})});v.push(t);var w=new j(function(z){k.getPredicates({classURIs:"ds6wg:VPMReference,ds6wg:XP_VPMReference_Ext,ds6wg:EnterpriseExtension",lang:f.getSetting("lang"),onComplete:function(A){var D=UWA.is(A,"string")?JSON.parse(A):A;for(r=0;r<D.classPredicates.length;r++){for(q=0;q<D.classPredicates[r].vocabularyPredicateInfo.length;q++){var C=D.classPredicates[r].vocabularyPredicateInfo[q];var B=C.nlsName;if(B.indexOf("emxFramework.")===0){B=C.name}s.completeResponse[C.uri]={nlsName:C.nlsName,lang:f.getSetting("lang")}}}z()},onFailure:function(A){console.error("NLS FAILED >> getElementsNls >>",n);z()}})});v.push(w);var p=new j(function(z){j.all(v).then(function(){for(r=0;r<o.length;r++){var A=null;if(o[r].xnav_options){A=o[r].xnav_options.name}else{if(o[r].ds6w){A=o[r].ds6w}}if(A&&s.completeResponse[A]&&s.completeResponse[A].nlsName){o[r].text=s.completeResponse[A].nlsName}else{if(A&&A.indexOf("ds6w")!==-1&&A!=="ds6w:reserved"){if(A.indexOf(c)!==-1){o[r].text=A.substr(c.length)}else{o[r].text=A}}}}x({status:"success",columns:o})})})},updateNLS:function(n){var m=n.getOccurencePath();if(this.nodes2updateId.indexOf(m)===-1){this.nodes2updateId.push(m);this.nodes2update.push(n);this.updateNLSInternal(this.nodes2update)}}});a.prototype.updateNLSInternal=g.debounce(function(s){a.idx=0;var q=this,r={},o,m;var n=e.getAvailableColumns();if(n){for(o=0;o<s.length;o++){var p=Object.getOwnPropertyNames(s[o].options.grid);for(m=0;m<p.length;m++){if(p[m]!=="ds6w:reserved"&&UWA.is(s[o].options.grid[p[m]])&&s[o].options.grid[p[m]]!==""&&e.isHardcodedColumn(p[m])===false){if(n.available_columns.indexOf(p[m])!==-1){if(r[p[m]]===undefined){r[p[m]]=[]}if(r[p[m]].indexOf(s[o].options.grid[p[m]])===-1){r[p[m]].push(s[o].options.grid[p[m]])}}}}}i.getNlsOfPropertiesValues(JSON.stringify(r),{tenantId:d.getPlatformId(),lang:f.getSetting("lang"),onComplete:function(w){var x=UWA.is(w,"string")?JSON.parse(w):w;var z=Object.getOwnPropertyNames(x);function u(C){var A=false;var B={grid:C.options.grid};for(m=0;m<z.length;m++){if(B.grid[z[m]]&&x[z[m]][B.grid[z[m]]]&&x[z[m]][B.grid[z[m]]]!==B.grid[z[m]]){if(x[z[m]][B.grid[z[m]]].indexOf("emxFramework")!==0){A=true;B.grid[z[m]]=x[z[m]][B.grid[z[m]]]}}}return{updated:A,options:B}}var t=null;if(q.nodes2update[0]){t=q.nodes2update[0].getTreeDocument()}if(t){t.withTransactionUpdate(function(){for(o=0;o<q.nodes2update.length;o++){var B=q.nodes2update[o];var A=u(B);if(A.updated===true){B.updateOptions(A.options)}}q.nodes2updateId=[];q.nodes2update=[]})}else{for(o=0;o<q.nodes2update.length;o++){var y=q.nodes2update[o];var v=u(y);if(v.updated===true){y.updateOptions(v.options)}}q.nodes2updateId=[];q.nodes2update=[]}},onFailure:function(t){console.warn("Cannot retrieve NLS");q.nodes2updateId=[];q.nodes2update=[]}})}},100);return a});define("DS/PADUtils/PADPredicatesNls",["UWA/Core","UWA/Class","UWA/Class/Options","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADWSAccess","DS/PADUtils/PADPredicatesNlsManager","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADDictionaryAccess"],function(g,b,h,d,i,a,f,e){var c=b.singleton(h,{init:function(){if(f.getSetting("FedDictionnaryAccess")===true){this._nlsManager=e}else{this._nlsManager=new a()}},updateColumnsWithNLS:function(j,k){if(this._nlsManager){this._nlsManager.updateColumnsWithNLS(j,k)}},updateNLS:function(j){if(this._nlsManager){this._nlsManager.updateNLS(j)}}});return c});define("DS/PADUtils/views/_PADCustomizeView",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADPredicatesNls","UWA/Controls/Abstract","UWA/Class/Events","DS/Windows/Panel","DS/UIKIT/Modal","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TreeListView","DS/Core/PointerEvents","DS/PADUtils/views/parametrization/ComboSelector"],function(p,s,c,q,o,k,h,b,a,m,d,i,j,g,f,n){var r={apiVersion:2,defaultCellHeight:40,isEditable:false,show:{columnHeaders:true},resize:{columns:false},height:"auto",isSortable:false,columns:[]};var l="DS/ENOFloatingPanel/ENOFloatingPanel";var e=o.extend(k,{name:"padcustomizeview",_command_id:"",_applyOnlyToThisApp:false,init:function(t){this._parent(t);this._reverts=[];var u=this;require([l],function(v){if(t.events){u.addEvents(t.events)}u.render_div=document.querySelector(u.options.render_div);u._command_id=t.id;u.elements.container=u._createContent(t);u.elements.floatingpanel=new v({className:u.name,body:u.elements.container,footer:u._buildFooter(t),title:c[u.name+"_"+t.id+"_title"],overlay:true,closable:true,animate:true,resizable:true,visible:true,events:{onClose:function(){u._closePanel();u.elements.floatingpanel.destroy()}}});u.elements.floatingpanel.inject(u.render_div)})},_closePanel:function(){if(this.options.cmd){this.options.cmd.enable()}if(this.options.id==="ColumnVisibility"){if(this._applyOnlyToThisApp===true){this.dispatchEvent("custoViewChange")}else{this.dispatchEvent("saveAsTemplate")}}},_createContent:function(E){var y=this;var z=UWA.createElement("div",{"class":"padcustomizeview_content"});var x=UWA.createElement("div",{"class":"padcustomizeview_body"}).inject(z);UWA.createElement("div",{"class":this.name+"_instruction",content:c[this.name+"_"+E.id+"_instruction"]}).inject(x);this.content_document=new i({useAsyncPreExpand:true,shouldAcceptDrag:function(F,G){return false},shouldAcceptDrop:function(F){return false}});this.content_document.onNodeModelUpdate(this._onNodeModelUpdate.bind(this));var t=UWA.clone(r);t.columns.push({width:40,dataIndex:"pad_toggle",isDraggable:false,isSortable:false,setValue:function(G){y.content_document.withTransactionUpdate(function(){G.nodeModel.updateOptions({updateType:"visibility",grid:{pad_toggle:G.value}})});var F=y.content_treelist.getManager().getColumnIDFromDataIndex("pad_toggle");y.content_treelist.getManager().updateCellView(-1,F)},getValue:function(F){return y._isSelected(F.nodeModel)},onCellChange:function(F){return F.event.target.dsModel.checkFlag},onCellRequest:function(H){var F;if(!H.isHeader){if(!y._isLocked(H.nodeModel)){var G=H.cellView.reuseCellContent("_pad_toggle");if(G){G.checkFlag=y._isSelected(H.nodeModel);G.disabled=y._isLocked(H.nodeModel)}}else{H.cellView.getContent().setHTML('<span class="fonticon fonticon-block " style="padding-left:5px;color: #b2b4b8;"></span>')}}else{F=new d({checkFlag:y._isEveryVisibleNodeSelected(),mixedState:!y._isNoVisibleNodeSelected()&&!y._isEveryVisibleNodeSelected()});F.getContent().addEventListener(f.POINTERDOWN,function(I){I.stopPropagation()});F.getContent().addEventListener("focus",function(I){I.preventDefault();I.stopPropagation()});F.getContent().addEventListener("change",function(I){if(I.dsModel.checkFlag||I.dsModel.mixedState){y._toggleAllVisibleNodes(true)}else{y._toggleAllVisibleNodes(false)}});H.cellView.getContent().setHTML(F)}}});t.columns.push({text:c.padcustomizeview_column_name_header,dataIndex:"tree",width:"auto",isDraggable:false});if(this.options.id==="ColumnVisibility"){t.isEditable=true;t.columns.push({text:c.padcustomizeview_color_header,dataIndex:"column_color",width:60,isDraggable:true,isColumnMovable:false,isEditable:false,onCellRequest:function(I){if(!I.isHeader){var H="#ffffff";if(I.nodeModel.options.grid&&I.nodeModel.options.grid.column_color){H=I.nodeModel.options.grid.column_color["background-color"]?I.nodeModel.options.grid.column_color["background-color"]:"#ffffff"}H=H.replace(/;/g,"");var F="#000000";if(I.nodeModel.options.grid&&I.nodeModel.options.grid.column_color){F=I.nodeModel.options.grid.column_color.color?I.nodeModel.options.grid.column_color.color:"#0000"}F=F.replace(/;/g,"");var G=UWA.createElement("div",{"class":"padcustomizeview_colorpicker font-3dsregular",text:c.PADColorView_content,styles:{"background-color":H,color:F}});G.addEvent("click",function(J){J.preventDefault();J.stopPropagation();require(["DS/PADUtils/views/PADColorPicker"],function(M){var N=I.nodeModel.options.grid.column_color;var K="#ffffff";var L="#000000";var O=N.color||F;if(N){K=N["background-color"].toLowerCase().replace(";","");L=N.color.toLowerCase().replace(";","")}var P={background_color:K,color:L};new M({selected_color:P,renderTo:document.body,events:{onColorOK:function(Q){I.nodeModel.updateOptions({updateType:"color",grid:{column_color:{"background-color":Q.background_color+";",color:Q.color+";"}}})}}})})});I.cellView.getContent().setHTML(G)}}})}t.shouldDisplayTooltip=this.provideTooltip.bind(this);t.shouldBeEditable=this.shouldBeEditable.bind(this);this.content_treelist=new g(t);this.content_treelist.getManager().registerReusableCellContent({id:"_pad_toggle",buildContent:function(){var F=new d({checkFlag:false});F.getContent().addEventListener(f.POINTERDOWN,function(G){G.stopPropagation()});F.getContent().addEventListener("focus",function(G){G.preventDefault();G.stopPropagation()});return F}});if(this.options.id==="ColumnVisibility"&&this.options.events.saveAsTemplate){this.content_treelist.getContent().addClassName("padcustomizeview_columnvisibility")}else{this.content_treelist.getContent().addClassName("padcustomizeview_options")}this.content_treelist.inject(x);this.content_treelist.getManager().loadDocument(this.content_document);this.loadRows(E);if(this.options.id==="ColumnVisibility"&&this.options.events.saveAsTemplate){var C=UWA.createElement("div",{"class":"padcustomizeview_footer"}).inject(z);C.addClassName("compactModeAvailable");x.addClassName("compactModeAvailable");var v=new i();var u=new j({viewMode:"comfortable",label:c.Comfortable,subLabel:c.ComfortableExplanation,children:null,icons:[{iconName:"view-big-tile",fontIconFamily:WUXManagedFontIcons.Font3DS}]});v.addRoot(u);var A=new j({viewMode:"compact",label:c.Compact,subLabel:c.CompactExplanation,children:null,icons:[{iconName:"view-list",fontIconFamily:WUXManagedFontIcons.Font3DS}]});v.addRoot(A);if(this._hasThumbNail){this.options.viewMode="comfortable";u.select(true)}else{if(this.options.viewMode==="compact"){A.select(true)}else{u.select(true)}}this.comboCompact=new n({className:"compactModeSelector",treedocument:v,withMore:false,disabled:this.options.thumbnails,multisel:false,events:{onSelectionChange:function(){y.dispatchEvent("compactMode",{viewMode:v.getSelectedNodes()[0].options.viewMode})}}});if(this._hasThumbNail){this.comboCompact.disabled(true)}var w=UWA.createElement("div",{"class":this.name+"_footerArea comboDiv"});var B=UWA.createElement("div",{"class":"comboLabel",text:c.density});B.inject(w);this.comboCompact.inject(w);w.inject(C);this.applyToggle=new d({label:c.padcustomizeview_apply_to_this_app});var D=UWA.createElement("div",{"class":this.name+"_footerArea applyToggle",content:this.applyToggle});this.applyToggle.inject(D);D.inject(C);this.applyToggle.addEventListener("change",function(G){var F=G.dsModel;y._applyOnlyToThisApp=F.checkFlag})}return z},_buildFooter:function(u){var w=this;var z=UWA.createElement("div",{"class":"footerModal"});if(this.options.id==="ColumnVisibility"){var t=new m({label:c.padcustomizeview_button_close,emphasize:"primary",touchMode:true});t.addEventListener("click",function(){w._closePanel();w.elements.floatingpanel.destroy()});t.inject(z)}else{var x=new m({label:c.padcustomizeview_button_save,emphasize:"primary",touchMode:true});x.addEventListener("click",function(){w._closePanel();w.elements.floatingpanel.destroy();if(w.options.id==="PrintOptions"||w.options.id==="ExportCSVOptions"){w.dispatchEvent("ok")}});x.inject(z);var y=new m({label:c.padcustomizeview_button_cancel,emphasize:"secondary",touchMode:true});y.addEventListener("click",function(){w._processReverts();w.elements.floatingpanel.destroy()});y.inject(z)}var v=new m({label:c.padcustomizeview_button_reset,touchMode:true});v.inject(z);v.addEventListener("click",function(){window.top.performance.mark("reset_event_begin");w.dispatchEvent("reset");var A=require("DS/PADUtils/PADSettingsMgt");if(A.getSetting("readsettingsv2")===false){w._closePanel();w.elements.floatingpanel.destroy()}});return z},provideTooltip:function(u){var t="";if(u.model.options.isHeader){t=""}else{switch(u.dataIndex){case"pad_toggle":if(!this._isLocked(u.nodeModel)){t=c.padcustomizeview_tooltip_show_or_hide}else{t=t=c.padcustomizeview_tooltip_cannot_hide}break;case"tree":t="";break;case"column_color":t=c.padcustomizeview_tooltip_set_color;break;default:t=""}}return{longHelp:t}},shouldBeEditable:function(v){var t=true;if(v.isHeader===true){t=false}else{if(v.dataIndex==="tree"){var u=v.nodeModel.options.origin_dataIndex;if(u==="selection"||u==="hide_show"||u==="find_in_ctx"||u==="thumbnail"||u==="ds6w:reserved"){t=false}}}return t},loadRows:function(t,u){var w=this;if(this.content_document){this.content_document.empty()}function v(B,C){var A=true;var z=B.customisation?B.customisation:B.xnav_options;if(z){switch(C){case"PrintOptions":case"ExportCSVOptions":if(z.exportable&&z.exportable.lock===true&&z.exportable.value===false){A=false}break;default:break}}else{A=false}return A}function x(B){var C="";if(B.text===""||B.text===null||B.text===undefined){var A="treelistview_customization_"+B.dataIndex;if(UWA.is(c[A])){C=c[A]}else{var z=B.dataIndex.split(":");var D="";if(z&&z.length===2){D=z[1]}else{D=B.dataIndex}C=D}}else{C=B.text}return C}function y(A,D){var C={label:x(A),children:null,grid:{pad_toggle:!A.isHidden},origin_dataIndex:A.dataIndex,editableLabel:!(A.text===""||A.text===null||A.text===undefined)};var z=A.customisation?A.customisation:A.xnav_options;switch(D){case"PrintOptions":case"ExportCSVOptions":C.grid.pad_toggle=z.exportable.value;C.lock=z.exportable.lock;break;case"ColumnVisibility":C.lock=z.layout.removable!==undefined?z.layout.removable===false:z.layout.lock?z.layout.lock:false;var B={"background-color":"#ffffff",color:"#000000"};if(z.layout.styles!==undefined&&Object.keys(z.layout.styles).length>0){B={"background-color":z.layout.styles.backgroundColor?z.layout.styles.backgroundColor:z.layout.styles["background-color"],color:z.layout.styles.color}}C.grid.column_color=B;if(A.dataIndex==="thumbnail"&&A.isHidden===false){w._hasThumbNail=true}break;default:break}return C}w.content_document.withTransactionUpdate(function(){t.columns.forEach(function(A){if(v(A,t.id)){var z=y(A,t.id);if(u===true){if(z.origin_dataIndex==="thumbnail"&&z.grid.pad_toggle===false&&w.comboCompact){w.comboCompact.disabled(false);w.comboCompact.dispatchEvent("onSelectionChange")}}w.content_document.addRoot(z)}})})},_isSelected:function(t){return t.options.grid.pad_toggle},_isLocked:function(v,u){var t=v.options.lock;if(v.options.origin_dataIndex==="tree"||v.options.label==="Title"){t=true}return t},_isEveryVisibleNodeSelected:function(){var v=true;var u=this.content_document.getRoots();for(var t=0;t<u.length&&v;t++){if(u[t].isVisible()&&u[t].options.lock===false&&u[t].options.grid.pad_toggle===false){v=false}}return v},_isNoVisibleNodeSelected:function(){var v=true;var u=this.content_document.getRoots();for(var t=0;t<u.length&&v;t++){if(u[t].isVisible()&&u[t].options.lock===false&&u[t].options.grid.pad_toggle===true){v=false}}return v},_toggleAllVisibleNodes:function(u){var t=this;this.content_document.withTransactionUpdate(function(){var w=t.content_document.getRoots();for(var v=0;v<w.length;v++){if(w[v].options.lock===false){w[v].updateOptions({updateType:"visibility",grid:{pad_toggle:u}})}}})},_onNodeModelUpdate:function(w){var A={dataIndex:w.target.options.origin_dataIndex};switch(this._command_id){case"PrintOptions":case"ExportCSVOptions":A.exportable=w.target.options.grid.pad_toggle;var v={dataIndex:A.dataIndex,exportable:!A.exportable};var z=false;for(var x=0;x<this._reverts.length;x++){if(this._reverts[x].dataIndex===v.dataIndex){z=true;break}}if(!z){this._reverts.push(v)}break;case"ColumnVisibility":if(w.target.options.editableLabel){A.headerName=w.target.options.label}A.column_color=w.target.options.grid.column_color;A.isHidden=!w.target.options.grid.pad_toggle;break}if(A.dataIndex==="thumbnail"&&w.target.options.updateType==="visibility"){if(this.comboCompact){if(A.isHidden){this.comboCompact.disabled(false)}else{var u=this.comboCompact.options.treedocument.getRoots();for(var y=0;y<u.length;y++){var t=u[y];if(t.options.viewMode==="compact"){t.unselect()}if(t.options.viewMode==="comfortable"){t.select()}}this.comboCompact.dispatchEvent("onSelectionChange");this.comboCompact.disabled(true)}}}this.dispatchEvent("modifyColumRendering",A)},_processReverts:function(){var t=this;this._reverts.forEach(function(u){t.dispatchEvent("modifyColumRendering",u)});this._reverts.length=0}});return e});define("DS/PADUtils/_XNavExportTemplate",["i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Class","UWA/Class/Options","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADPredicatesNls"],function(a,c,b,g,h){function f(l,j){var k=l.options.grid[j];var i=Date.parse(k);if(!isNaN(i)){k=new Date(i).toLocaleString()}return k}var e={customizedColumnRenderers:{"ds6w:created":function(i){return f(i,"ds6w:created")},"ds6w:modified":function(i){return f(i,"ds6w:modified")}},renderColumn:function(j,i){if(j==="tree"){return i.options.label}else{if(UWA.is(e.customizedColumnRenderers[j],"function")){return e.customizedColumnRenderers[j](i)}else{if(UWA.is(i.options.grid[j],"string")){return i.options.grid[j]}}}}};var d=c.singleton(b,{defaultOptions:{use_default:true,columns_to_remove:["tree","find_in_ctx","hide_show","bi_color"],renderTitle:function(i){return""},renderHeader:function(m){var l='<th style="border:1px solid black; background-color:#A7C942; text-align:left; color:#FFFFFF; font-size:.8em; padding-top:5px; paddingbottom:4px;">';var n="<thead><tr>";n+=l+a.export_level+"</th>";n+=l+m.tree.text+"</th>";for(var k=0,j=m.columns.length;k<j;k++){var i=m.columns[k].text;n+=l+i+"</th>"}n+="</tr></thead>";return n},beginNewTable:function(i){return i.node.isRoot()},renderRow:function(l){var k='<td style="border:1px solid black;font-size:.8em;word-break:break-word;display:table-cell;">';var n="<tr>";n+=k+l.node.getDepth()+"</td>";n+=k+l.node.getLabel()+"</td>";for(var j=0,i=l.columns.length;j<i;j++){var m=e.renderColumn(l.columns[j].dataIndex,l.node);if(m===undefined){m=""}n+=k+m+"</td>"}n+="</tr>";return n},csv_base_file_name:a.csv_base_file_name,exportcsvHeader:function(l){var m="\uFEFF";m+='"'+a.export_level+'",';m+='"'+l.tree.text+'",';for(var k=0,j=l.columns.length;k<j;k++){var i=l.exportHeaders[k];m+='"'+i+'",'}m+="\r\n";return m},exportcsvRow:function(k){var m="";m+='"'+k.node.getDepth()+'",';m+='"'+k.node.getLabel()+'",';for(var j=0,i=k.columns.length;j<i;j++){var l=e.renderColumn(k.columns[j].dataIndex,k.node);if(l===undefined){l=""}m+='"'+l+'",'}m+="\r\n";return m}},init:function(i){this._parent(i);this.setOptions(this.defaultOptions)},initialize:function(i){this.setOptions(i)},print:function(p){if(!UWA.is(p,"object")||!UWA.is(p.context)){throw new Error("Invalid input parameters: context undefined")}var j=p.context;var o=require("DS/PADUtils/XNavSettings");var m=o.getAvailableColumns();var z=j.options.views.treelistview.options.columns.slice();var v=this.options.columns_to_remove.slice();for(var x=0;x<z.length;x++){var n=z[x].customisation?z[x].customisation:z[x].xnav_options;var w=n&&n.exportable?n.exportable.value:false;if(typeof w!=="undefined"&&!w){var A=z[x].dataIndex;if(v.indexOf(A)===-1){v.push(A)}}}var B=[];var q;for(var k=0;k<z.length;k++){var l=z[k];if(l.dataIndex==="tree"){q=l}else{if(m.available_columns.indexOf(l.dataIndex)!==-1&&(v.indexOf(l.dataIndex)===-1)){var y=l.dataIndex;B.push(l)}}}var u=this.options.renderTitle(),r=this;var i=false;function t(){var C='<table style="border:1px solid black; border-collapse:collapse;">';C+=r.options.renderHeader({tree:q,columns:B});C+="<tbody>";i=true;return C}function s(){i=false;return'</tbody><table style="border:1px solid black; border-collapse:collapse;"><br>'}j.options.model.getRoots().forEach(function(C){if(r.options.beginNewTable({node:C})===true){if(i===true){u+=s()}u+=t()}else{if(i===false){u+=t()}}if(C.isVisible()===true){u+=r.options.renderRow({node:C,columns:B});C.processDescendants({processNode:function(){if(r.options.beginNewTable({node:this})===true){if(i===true){u+=s()}u+=t()}if(this.isVisible()===true){u+=r.options.renderRow({node:this,columns:B})}}})}});if(i){u+=s()}g.printhtml(u)},export_csv:function(o){if(!UWA.is(o,"object")||!UWA.is(o.context)){throw new Error("Invalid input parameters: context undefined")}var q=this;var i=o.context;var n=require("DS/PADUtils/XNavSettings");var l=n.getAvailableColumns();var y=i.options.views.treelistview.options.columns.slice();var t=this.options.columns_to_remove.slice();for(var w=0;w<y.length;w++){var m=y[w].customisation?y[w].customisation:y[w].xnav_options;var u=m&&m.exportable?m.exportable.value:false;if(typeof u!=="undefined"&&!u){var A=y[w].dataIndex;if(t.indexOf(A)===-1){t.push(A)}}}var s=[];var v=i.options.views.treelistview;var B=[];var p;function z(D){var E="";if(D.text===""||D.text===null||D.text===undefined){var C="treelistview_customization_"+D.dataIndex;if(UWA.is(a[C])){E=a[C]}else{E=D.dataIndex}}else{E=D.text}return E}for(var k=0;k<y.length;k++){var j=y[k];if(j.dataIndex==="tree"){p=j}else{if(l.available_columns.indexOf(j.dataIndex)!==-1&&(t.indexOf(j.dataIndex)===-1)){var x=j.dataIndex;s.push(z(j));B.push(j)}}}var r=this.options.exportcsvHeader({tree:p,columns:B,exportHeaders:s,});i.options.model.getRoots().forEach(function(C){if(C.isVisible()===true){r+=q.options.exportcsvRow({node:C,columns:B});C.processDescendants({processNode:function(){if(this.isVisible()===true){r+=q.options.exportcsvRow({node:this,columns:B})}}})}});g.downloadfile(r,this.options.csv_base_file_name+(new Date()).toString().split(" ").splice(1,4).join(" ")+".csv","text/csv")}});return d});define("DS/PADUtils/views/parametrization/TypesSelectionModal",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/Controls/ComboBox","DS/Controls/Button","DS/PADUtils/PADWSAccess","DS/PADUtils/PADPromise","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/UIKIT/Mask","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/parametrization/SearchSelector","DS/Utilities/Utils",],function(r,s,c,d,q,m,p,i,n,o,a,g,j,l,t,e,k,h,b){var f=q.extend(m,{name:"typesSelectionModal",defaultOptions:{typesdocument:null,typestreelist:null,modal:null,alreadySelectedTypes:[],filterInProgress:false},init:function(v){this._parent(v);this.options.typesdocument=new j();for(var w=0;w<v.selectedTypes.length;w++){this.options.alreadySelectedTypes.push(v.selectedTypes[w].options.grid.cvName)}var x=this;if(v.inMainView){x.elements.container=d.createElement("div",{"class":x.getClassNames("-immersivePanel")});var u=this._buildTypesSelectionView(true);u.inject(x.elements.container);x.options.modelEvts.publish({event:"ENXViews/Views/showInWidgetBody",data:{html:x.elements.container}});x.elements.panel2small=d.createElement("div",{"class":x.getClassNames("-panel2small"),text:c.panel2small}).inject(x.elements.container)}else{var u=this._buildTypesSelectionView();this.options.modal=new p({className:this.name+"_modal",closable:true,okButtonText:c.ok,koButtonText:c.cancel,animate:true});this.options.modal.dialog({title:c.selectTypes,body:u,buttons:[{className:"primary",value:c.ok,action:function(z){var y=x.options.typesdocument.search({match:function(A){if(x.options.alreadySelectedTypes.indexOf(A.nodeModel.options.grid.cvName)!==-1){return true}}});x.dispatchEvent("onTypesSelected",{selectedTypes:y});z.hide()}},{value:c.cancel,action:function(y){y.hide()}}]})}},_buildTypesSelectionView:function(w){this.elements.typesBody=d.createElement("div",{"class":this.name+"-typesbody"});this.elements.typesSearch=d.createElement("div",{"class":this.name+"-typessearch"}).inject(this.elements.typesBody);var y=this;y.options.typesdocument.getXSO().onPostAdd(function(){var A=y.options.typesdocument.getSelectedNodes();for(var z=0;z<A.length;z++){if(y.options.alreadySelectedTypes.indexOf(A[z].options.grid.cvName)===-1){y.options.alreadySelectedTypes.push(A[z].options.grid.cvName)}}});y.options.typesdocument.getXSO().onPostRemove(function(A){if(y.options.filterInProgress===false){var C=A;for(var z=0;z<C.length;z++){var B=y.options.alreadySelectedTypes.indexOf(C[z].options.grid.cvName);if(B!==-1){y.options.alreadySelectedTypes.splice(B,B+1)}}}});var x=b.debounce(function(z){y.options.typesdocument.withTransactionUpdate(function(){var B=z.searchStr;var A=true;y.options.filterInProgress=true;y.options.typesdocument.search({match:function(C){var D=new RegExp(B,"i");if(D.test(C.nodeModel.getLabel())){C.nodeModel.show();if(y.options.alreadySelectedTypes.indexOf(C.nodeModel.options.grid.cvName)!==-1){C.nodeModel.select()}if(B.length>0){if(A){C.nodeModel.matchSearch();A=false;y.elements.typeSelSearch.navigationState(true,false)}else{C.nodeModel.unmatchSearch()}}else{C.nodeModel.unmatchSearch()}}else{C.nodeModel.unmatchSearch();C.nodeModel.hide()}y.options.typestreelist.getManager().forceMultiSelection(true)}});y.options.filterInProgress=false});y.options.typesdocument.getXSO().onPostAdd(function(){});y.options.typesdocument.getXSO().onPostRemove(function(){})},500);var v=function(B){var z=y.options.typesdocument.search({match:function(C){return C.nodeModel.isMatchingSearch()}});var A=y.options.typesdocument.search({match:function(C){return C.nodeModel.isVisible()}});y.options.typesdocument.withTransactionUpdate(function(){if(z.length===1){var D=z[0];var C=A.indexOf(D);var H=B==="next"?C+1:C-1;D.unmatchSearch();var F=A[H];if(F){F.matchSearch();y.options.typestreelist.getManager().scrollToNode(F);var E=H===0?true:false;var G=H===A.length-1?true:false;y.elements.typeSelSearch.navigationState(E,G)}}})};this.elements.typeSelSearch=new h({placeholder:c.enterTypeName,withNavigation:true,events:{onSearch:x,onNext:v,onPrevious:v}}).inject(this.elements.typesSearch);this.elements.typesList=d.createElement("div",{"class":this.name+"-typeslist"}).inject(this.elements.typesBody);var u={height:"auto",selection:{enableListSelection:true,toggle:true},defaultCellHeight:30,enableDragAndDrop:false,enableActiveUI:true,enableKeyboardNavigation:true,enableTreeColumnEllipsisOverflow:true,performances:{preloadPool:true,useRequestAnimationFrameRendering:false},resize:{columns:false},isEditable:true,columns:[{width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:false,isHidden:false,isColumnMovable:false,},{width:"auto",dataIndex:"tree",text:c.typeName,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:true,}]};this.options.typestreelist=new g(u);if(!w){this.options.typestreelist.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0})}this.options.typestreelist.getContent().addClassName(this.name+"-typestreelist");this.options.typestreelist.getManager().loadDocument(this.options.typesdocument);this.options.typestreelist.getManager().forceMultiSelection(true);this.options.typestreelist.getContent().inject(this.elements.typesList);var y=this;t.mask(this.elements.typesBody);this._retrieveAvailableTypesForVocab(function(){t.unmask(y.elements.typesBody)});if(w){this._buildFooter().inject(y.elements.typesBody)}return this.elements.typesBody},_retrieveAvailableTypesForVocab:function(w){var v=this;function x(y){var z=d.is(y,"string")?JSON.parse(y):y;v.options.typesdocument.withTransactionUpdate(function(){for(var A=0;A<z.vocabularyClassInfo.length;A++){var B=new l({label:z.vocabularyClassInfo[A].nlsName,children:null,grid:{name:z.vocabularyClassInfo[A].name,cvName:z.vocabularyClassInfo[A].uri}});v.options.typesdocument.addRoot(B);if(v.options.alreadySelectedTypes.indexOf(B.options.grid.cvName)!==-1){B.select()}}});if(w){w()}}var u=localStorage.getItem("VocabularyClasses-"+e.getSetting("lang")+"-"+k.getPlatformId());if(u){x(u)}else{if(e.getSetting("FedDictionnaryAccess")===true){require(["DS/PADUtils/PADDictionaryAccess"],function(y){y.getVocabularyClasses("ds6wg",{tenantId:k.getPlatformId(),lang:e.getSetting("lang"),apiVersion:"R2019x",onComplete:function(z){v.options.typesdocument.withTransactionUpdate(function(){for(var A=0;A<z.classes.length;A++){var B=new l({label:z.classes[A].label,children:null,grid:{name:z.classes[A].curi,cvName:z.classes[A].curi}});v.options.typesdocument.addRoot(B);if(v.options.alreadySelectedTypes.indexOf(B.options.grid.cvName)!==-1){B.select()}}});if(w){w()}}})})}else{o.getVocabularyClasses({vocabularyname:"ds6wg",onComplete:function(y){x(y);localStorage.setItem("VocabularyClasses-"+e.getSetting("lang")+"-"+k.getPlatformId(),d.is(y,"string")?y:JSON.stringify(y))}})}}},_buildFooter:function(){var w=this;var x=d.createElement("div",{"class":this.name+"-footerModal"});var u=new n({label:c.ok,emphasize:"primary",touchMode:true});u.addEventListener("click",function(){var y=w.options.typesdocument.search({match:function(z){if(w.options.alreadySelectedTypes.indexOf(z.nodeModel.options.grid.cvName)!==-1){return true}}});w.dispatchEvent("onTypesSelected",{selectedTypes:y})});u.inject(x);var v=new n({label:c.cancel,touchMode:true});v.inject(x);v.addEventListener("click",function(){w.dispatchEvent("onTypesSelected",{cancel:true})});return x},});return f});define("DS/PADUtils/views/RelatedDocumentsList",["UWA/Controls/Abstract","UWA/Controls/Input","UWA/Promise","DS/WebappsUtils/WebappsUtils","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Tree/TileGridView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/Controls/Accordeon","DS/Utilities/Dom","DS/Utilities/Utils","DS/UIKIT/Mask","DS/PADUtils/PADWSAccess","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADDocTypeVerify","DS/PADUtils/PADRelatedDocuments","DS/PADUtils/views/PADAlert","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(p,q,c,d,k,m,g,n,v,r,b,w,o,l,f,j,t,u,s,h){var i={CHECKIN:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_CheckInDocument.png")+")",CHECKOUT:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_CheckOutDocument.png")+")",DOWNLOAD:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DownloadDocument.png")+")",DETACH:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DetachDocument.png")+")",DELETE:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DeleteDocument.png")+")"};var e=d.getWebappsAssetUrl("PADUtils","icons/I_CDM_Document.png");var a=p.extend({_relatedDocsUX:{},_accordion:null,_informationBox:null,_informationContainerBox:null,_fileInput:null,_dndCounter:0,_notOnlyDocument:true,init:function(x){this._parent(x);this.elements.container=UWA.createElement("div",{"class":"documentslist_container"});this._buildSkeleton();this._informationContainerBox=UWA.createElement("div",{"class":"container_information"});this._informationBox=UWA.createElement("div",{"class":"documentslist_information"}).inject(this._informationContainerBox);UWA.createElement("span",{"class":"documentslist_information_icon wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-docs"}).inject(this._informationBox);this._messageInformationBox=UWA.createElement("h2",{"class":"caddocumentslist_information_msg"}).inject(this._informationBox);this._informationContainerBox.hide();this._informationContainerBox.inject(this.elements.container);var y=this;if(this.options.readOnly!==true){this.elements.container.addEventListener("dragenter",this._dragEnterDocument.bind(this));this.elements.container.addEventListener("dragleave",this._dragLeaveDocument.bind(this));this.elements.container.addEventListener("dragover",this._dragOverDocument.bind(this));this.elements.container.addEventListener("drop",this._dropDocument.bind(this))}},onResize:function(){if(this._accordion){this._updateItemHeight()}},_displayInformationBox:function(x){if(x==="createDocument"){this._messageInformationBox.setText(h.documentsCreateDocument)}else{if(x==="nodocuments"){if(this.options.kindOfDocuments&&this.options.kindOfDocuments.length===1&&this.options.kindOfDocuments[0]==="DOCUMENT"){this._messageInformationBox.setText(h.nodocumentsOnly)}else{this._messageInformationBox.setText(h.nodocuments)}}}this._switchContainer("information")},_switchContainer:function(y){var x=y?y:this._activeContainer;switch(x){case"information":if(this._accordion){this._accordion.getContent().hide()}this._informationContainerBox.show();this._activeContainer="information";break;case"doccontent":if(this._accordion){this._accordion.getContent().show()}this._informationContainerBox.hide();this._activeContainer="doccontent";break}},_buildSkeleton:function(){var E=this;if(this.options.kindOfDocuments&&this.options.kindOfDocuments.length===1&&this.options.kindOfDocuments[0]==="DOCUMENT"){this._notOnlyDocument=false}if(this._notOnlyDocument){this._accordion=new v({exclusive:true,style:"styled"}).inject(this.elements.container);var C=b.debounce(function(I){E._updateItemHeight();E._accordion.removeEventListener("expand",C)},50);this._accordion.addEventListener("expand",C)}if(!this.options.kindOfDocuments||this.options.kindOfDocuments.indexOf("DOCUMENT")!==-1){var A={shouldAcceptDrag:function(I,J){return true},shouldAcceptDrop:function(I,J){if(E.options.readOnly!==true){return true}else{return false}}};var y=new k(A);var H;H=new n({useDragAndDrop:true,onDragStartCell:E._dragStartTile.bind(E)});H.selectionBehavior={unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableShiftSelection:true,enableFeedbackForActiveCell:false,canInteractiveMultiselectWithCheckboxClick:true,enableListSelection:true};H.model=y;H.onContextualEvent={"this":this,callback:this._onContextualEventDocument};H.onCellDoubleClick(this._onDoubleClick.bind(this));var x="padAccordionItemView docItemView";if(E._notOnlyDocument===false){x=x+" onlyDocument"}var G=UWA.createElement("div",{"class":x});H.getContent().inject(G);this._relatedDocsUX.DOCUMENT={model:y,view:G,isInjected:false,update:function(R){if(E._relatedDocsUX.DOCUMENT.model){for(var N=0;R&&N<R.length;N++){var M=R[N];var O={extension:"zip",locker:[],owner:""};for(var J=0;J<M.relateddata.files.length;J++){var L=M.relateddata.files[0];if(L.dataelements.locker!==""){O.locker.push(L.dataelements.locker)}}if(M.relateddata.ownerInfo){for(var Q=0;Q<M.relateddata.ownerInfo.length;Q++){var I=M.relateddata.ownerInfo[Q];if(I.dataelements.firstname!==""&&I.dataelements.lastname!==""){O.owner=I.dataelements.firstname+" "+I.dataelements.lastname}}}if(M.relateddata.files.length===1){O.extension=M.relateddata.files[0].dataelements.title.split(".").pop()}var K={label:M.dataelements.title,subLabel:O.owner,physicalid:M.id,type:M.type,children:null,grid:{locker:O.locker[0],extension:O.extension},thumbnail:M.dataelements.image,checkedOut:O.locker.length?true:false,contextualMenu:[{type:"SeparatorItem"}]};K.icons=[M.dataelements.type_icon_url?M.dataelements.type_icon_url:e];E._relatedDocsUX.DOCUMENT.model.addRoot(K)}}if(E._notOnlyDocument){if(E._relatedDocsUX.DOCUMENT.isInjected===false){E._accordion.addItem({id:"DOCUMENT",touchMode:true,header:h.DOCUMENT,content:E._relatedDocsUX.DOCUMENT.view,style:"divided",icon:{iconName:"doc",fontIconFamily:1,iconClasses:"",fontIconSize:"2x"}});E._relatedDocsUX.DOCUMENT.isInjected=true;E._updateItemHeight()}else{E._updateItemHeight()}var P=E._locateAccordionbyId("DOCUMENT");if(P!==-1){E._accordion.updateItem(P,{header:h.DOCUMENT+" ("+E._relatedDocsUX.DOCUMENT.model.getRoots().length+")"})}}else{E._relatedDocsUX.DOCUMENT.view.inject(E.elements.container)}}};var B={shouldAcceptDrag:function(I,J){return true},shouldAcceptDrop:function(I,J){return false}};var D=new k(B);if(f.getSetting("settypes")===true){D.getXSO().onChange(this._updateCADDocsSelection.bind(this))}var z;z=new n({model:D,selectionBehavior:{unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableShiftSelection:true,enableFeedbackForActiveCell:false,canInteractiveMultiselectWithCheckboxClick:true,enableListSelection:true,useDragAndDrop:true},useDragAndDrop:true,onDragStartCell:E._dragStartTile.bind(E)});var F=UWA.createElement("div",{"class":"padAccordionItemView cadrelItemView"});z.getContent().inject(F);this._relatedDocsUX.RELATEDCADDOCS={model:D,view:F,isInjected:false,update:function(N){if(E._relatedDocsUX.RELATEDCADDOCS.model){var K=[];for(var I=0;I<N.length;I++){var O=N[I];var L={label:O["ds6w:label"],physicalid:O.physicalid,type:O["ds6w:type"],subLabel:O["ds6w:responsible"],description:O["ds6w:identifier"],children:null,grid:{},thumbnail:O.preview_url,};if(K.indexOf(O["ds6w:type"])===-1){K.push(O["ds6w:type"])}L.icons=[O.type_icon_url];E._relatedDocsUX.RELATEDCADDOCS.model.addRoot(L);if(E._relatedDocsUX.RELATEDCADDOCS.model.getRoots().length>0){if(E._relatedDocsUX.RELATEDCADDOCS.isInjected===false){E._accordion.addItem({id:"RELATEDCADDOCS",touchMode:true,header:h.RELATEDCADDOCS,content:E._relatedDocsUX.RELATEDCADDOCS.view,style:"divided",icon:{iconName:"path-related",fontIconFamily:1,iconClasses:"",fontIconSize:"2x"}});E._relatedDocsUX.RELATEDCADDOCS.isInjected=true;E._updateItemHeight()}var J=E._locateAccordionbyId("RELATEDCADDOCS");if(J!==-1){E._accordion.updateItem(J,{header:h.RELATEDCADDOCS+" ("+E._relatedDocsUX.RELATEDCADDOCS.model.getRoots().length+")"})}}else{var J=E._locateAccordionbyId("RELATEDCADDOCS");if(J!==-1){E._accordion.deleteItem(J);E._relatedDocsUX.RELATEDCADDOCS.isInjected=false}}}var M={"ds6w:type":K};require(["DS/i3DXSNDictionaryAPI/3DXSearchDictionaryAccess"],function(P){P.getNlsOfPropertiesValues(JSON.stringify(M),{tenantId:l.getPlatformId(),lang:f.getSetting("lang"),onComplete:function(Q){E._relatedDocsUX.RELATEDCADDOCS.model.withTransactionUpdate(function(){E._relatedDocsUX.RELATEDCADDOCS.model.getRoots().forEach(function(R){if(Q["ds6w:type"]&&R.options.displayType===undefined&&Q["ds6w:type"][R.options.type]!==undefined){R.options.displayType=Q["ds6w:type"][R.options.type]}})})}})})}}}}},_updateCADDocsSelection:function(){if(this.masterNode.getTreeDocument()){l.setTypesForOFW(this.masterNode.getTreeDocument())}},_updateItemHeight:function(){var z=this.elements.container.getBoundingClientRect(),y="auto",B=this._accordion.items.length;if(z.height){y=Math.floor(z.height-38*B)-2}var A=Object.getOwnPropertyNames(this._relatedDocsUX);for(var x=0;x<A.length;x++){this._relatedDocsUX[A[x]].view.setStyle("height",y==="auto"?y:(y-60)+"px")}},_locateAccordionbyId:function(y){var z=-1;for(var x=0;x<this._accordion.items.length&&z===-1;x++){if(this._accordion.items[x].id===y){z=x}}return z},_emptyModels:function(y){var z=y?y:Object.getOwnPropertyNames(this._relatedDocsUX);for(var x=0;x<z.length;x++){if(this._relatedDocsUX[z[x]].model){this._relatedDocsUX[z[x]].model.empty()}}if(this._notOnlyDocument){for(var x=this._accordion.items.length-1;x>=0;x--){if(this._accordion.items[x].id!=="DOCUMENT"){this._relatedDocsUX[this._accordion.items[x].id].isInjected=false;this._accordion.deleteItem(x)}}}},_isNoRelatedDocsAvailable:function(){var y=true;var z=Object.getOwnPropertyNames(this._relatedDocsUX);for(var x=0;x<z.length&&y===true;x++){if(this._relatedDocsUX[z[x]].model&&this._relatedDocsUX[z[x]].model.getRoots().length>0){y=false}}return y},selectionModified:function(B){var A=this;if(B.getID===undefined&&B.getModelIdentification){B.getID=B.getModelIdentification}if(A.physicalid!==B.getID()){this._switchContainer("doccontent");A._emptyModels();A.masterNode=B;A.physicalid=B.getID();if(B.options){A.parentType=B.options.type}else{if(B.getNodeType){A.parentType=B.getNodeType()}}w.mask(this.elements.container);var y=[];if(f.getSetting("allRelatedDocuments")===true&&(!this.options.kindOfDocuments||this.options.kindOfDocuments.indexOf("RELATEDCADDOCS")!==-1)){var x=new c(function(D){u.getRelatedCADDocuments({data:{input_physical_ids:[A.physicalid]},onComplete:function(E){var F=UWA.is(E,"string")?JSON.parse(E):E;if(!F.result||F.result.length!==1){console.warn("Object not found in index");A._displayInformationBox("nodocuments")}else{if(F.result[0].input_object.physicalid===A.physicalid){A._emptyModels(["RELATEDCADDOCS"]);var G=F.result[0].outputs;if(G.RELATEDCADDOCS_TO){A._relatedDocsUX.RELATEDCADDOCS.update(G.RELATEDCADDOCS_TO)}if(G.RELATEDCADDOCS_FROM){A._relatedDocsUX.RELATEDCADDOCS.update(G.RELATEDCADDOCS_FROM)}if(G.RELATEDXCADDOCS_FROM){A._relatedDocsUX.RELATEDCADDOCS.update(G.RELATEDXCADDOCS_FROM)}if(G.RELATEDXCADDOCS_TO){A._relatedDocsUX.RELATEDCADDOCS.update(G.RELATEDXCADDOCS_TO)}if(A._isNoRelatedDocsAvailable()){A._displayInformationBox("nodocuments")}A.masterNode.relatedCADDocs=A._relatedDocsUX.RELATEDCADDOCS.model}}D()},onFailure:function(E){console.log("getRelatedCADDocuments error:",E);D()}})});x.name="Retrieve related Documents from index";y.push(x)}if((!this.options.kindOfDocuments||this.options.kindOfDocuments.indexOf("DOCUMENT")!==-1)){var C=new c(function(D){u.getDocuments({parentId:A.physicalid,onComplete:function(E){var F=UWA.is(E,"string")?JSON.parse(E):E;A._relatedDocsUX.DOCUMENT.update(F.data);D()},onFailure:function(){D()}})});C.name="Retrieve Documents";y.push(C)}var z=new c(function(D){c.all(y).then(function(){w.unmask(A.elements.container);if(A._isNoRelatedDocsAvailable()){A._displayInformationBox("nodocuments")}else{A._switchContainer("doccontent")}D()})});z.name="Synchro Point";y.push(z)}},createDocument:function(y){var x=this;if(y.parentType&&y.parentType==="3DShape"){s.displayNotification({msg:h.unableCreateDocument3DShape,eventID:"error"});return false}function z(E){w.mask(x.elements.container,h.createDocumentMask);if(x._accordion){x._accordion.getContent().show()}x._informationContainerBox.hide();var C=E.target.files;var D=[];for(var A=0;A<C.length;A++){var B=new c(function(G){u.createDocument({file:C[A],parentId:y.parentId,onComplete:function(H){G()},onFailure:function(H){var I=H.error?H.error:h.createDocumentFailed;if(H.internalError){I=H.internalError}s.displayNotification({msg:I,eventID:"error"});G()}})});D.push(B)}var F=new c(function(G){c.all(D).then(function(){x._updateDocumentView(y);x._clearInput();G()})});D.push(F)}if(y.fromDrop){z({target:{files:y.files}})}else{y.onFileSelect=z;y.multiple=true;this._inputFile(y)}},_updateDocumentView:function(y){var x=this;x._relatedDocsUX.DOCUMENT.model.empty();u.getDocuments({parentId:x.physicalid,onComplete:function(z){var A=UWA.is(z,"string")?JSON.parse(z):z;x._relatedDocsUX.DOCUMENT.update(A.data);w.unmask(x.elements.container);if(x._isNoRelatedDocsAvailable()){x._displayInformationBox("nodocuments")}if(y.resolve){y.resolve()}},onFailure:function(){w.unmask(x.elements.container);if(x._isNoRelatedDocsAvailable()){x._displayInformationBox("nodocuments")}if(y.resolve){y.resolve()}}})},_onContextualEventDocument:function(B){var z=this;var A=[];var x=B.cellInfos?(B.cellInfos.nodeModel?B.cellInfos.nodeModel:B.cellInfos.cellModel):null;if(x){x.select();var y=x.getTreeDocument().getSelectedNodes().length>1?false:true;if(y){A.push({title:h.openIn3DPlay,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-play",family:WUXManagedFontIcons.Font3DS},type:"PushItem",action:{"this":z,context:x,callback:this._openIn3DPlay}});if(this.options.readOnly!==true){A.push({title:x.options.checkedOut?h.checkInDocument:h.checkOutDocument,icon:x.options.checkedOut?i.CHECKIN:i.CHECKIN,type:"PushItem",action:{"this":z,context:x,callback:this._checkInOutDocument}})}}if(UWA.Utils.Client.Platform.ios!==true){A.push({title:h.downloadDocument,icon:i.DOWNLOAD,type:"PushItem",action:{"this":z,context:x,callback:this._downloadDocument}})}if(this.options.readOnly!==true){A.push({title:h.detachDocument,icon:i.DETACH,type:"PushItem",action:{"this":z,context:x,callback:this._detachDocument}});A.push({title:h.deleteDocument,icon:i.DELETE,type:"PushItem",action:{"this":z,context:x,callback:this._deleteDocument}})}}return A},_onContextualMenuReadyDocument:function(A){var y=[];var x=A?(A.nodeModel?A.nodeModel:A.cellModel):null;if(x){x.select();var z=x.getTreeDocument().getSelectedNodes().length>1?false:true;if(z){y.push({label:x.options.checkedOut?h.checkInDocument:h.checkOutDocument,icon:x.options.checkedOut?"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_CheckInDocument.png")+")":"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_CheckOutDocument.png")+")",data:x,callback:this._checkInOutDocument.bind(this)})}y.push({label:h.downloadDocument,icon:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DownloadDocument.png")+")",data:x,callback:this._downloadDocument.bind(this)});y.push({label:h.detachDocument,icon:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DetachDocument.png")+")",data:x,callback:this._detachDocument.bind(this)});y.push({label:h.deleteDocument,icon:"url("+d.getWebappsAssetUrl("PADUtils","icons/32/I_DeleteDocument.png")+")",data:x,callback:this._deleteDocument.bind(this)})}return y},_checkInOutDocument:function(x){var y=this;x=x.context;if(x.options.checkedOut===true){this._inputFile({target:".xnav_body",onFileSelect:function(A){w.mask(y.elements.container,h.checkinDocumentMask);var z=A.target.files;u.modifyDocument({file:z[0],docId:x.options.physicalid,onComplete:function(){y._updateDocumentView({parentId:y.physicalid});w.unmask(y.elements.container)},onFailure:function(B){s.displayNotification({msg:"Cannot create document",eventID:"error"});w.unmask(y.elements.container)}});y._clearInput()}})}else{w.mask(y.elements.container,h.checkoutDocumentMask);u.downloadDocument({docId:x.options.physicalid,checkout:true,onComplete:function(z){l.downloadfileURL(z,x.getLabel()+"."+x.options.grid.extension);y._relatedDocsUX.DOCUMENT.model.withTransactionUpdate(function(){x.updateOptions({checkedOut:true});y._relatedDocsUX.DOCUMENT.update()});w.unmask(y.elements.container)},onFailure:function(z){s.displayNotification({msg:h.cannotDownloadDoc,eventID:"error"});w.unmask(y.elements.container)}})}},_downloadDocument:function(y){var B=this;y=y.context;w.mask(B.elements.container,h.downloadDocumentMask);var z=[];var E=y.context&&y.context.getTreeDocument?y.context.getTreeDocument():y.getTreeDocument(),D=E.getSelectedNodes();for(var x=0;x<D.length;x++){var A=new c(function(G){var F=D[x];u.downloadDocument({docId:F.options.physicalid,checkout:false,onComplete:function(H){l.downloadfileURL(H,F.getLabel()+"."+F.options.grid.extension);G()},onFailure:function(H){s.displayNotification({msg:h.cannotDownloadDoc,eventID:"error"});G()}})});z.push(A)}var C=new c(function(F){c.all(z).then(function(){w.unmask(B.elements.container);F()})});z.push(C)},_detachDocument:function(y){var A=this;y=y.context;var z=[];var E=y.getTreeDocument(),D=E.getSelectedNodes();for(var x=0;x<D.length;x++){var C=new c(function(G){var F=D[x];u.detachDocument({docId:F.options.physicalid,parentId:A.physicalid,onComplete:function(H){A._relatedDocsUX.DOCUMENT.model.removeRoot(F);G()},onFailure:function(H){var I=H.error?H.error:h.cannotDetachDoc;if(H.internalError){I=H.internalError}s.displayNotification({msg:I,eventID:"error"});G()}})});z.push(C)}var B=new c(function(F){c.all(z).then(function(){if(A._isNoRelatedDocsAvailable()){A._displayInformationBox("nodocuments")}else{A._relatedDocsUX.DOCUMENT.update()}w.unmask(A.elements.container);F()})});z.push(B)},_attachDocument:function(y){var B=this;w.mask(B.elements.container,h.attachDocumentMask);if(B._accordion){B._accordion.getContent().show()}B._informationContainerBox.hide();var D=y.docs;var A=[];for(var x=0;x<D.length;x++){var z=new c(function(E){u.attachDocument({docId:D[x].objectId,parentId:y.parentId,onComplete:function(F){E()},onFailure:function(F){var G=F.error?F.error:h.attachDocumentFailed;if(F.internalError){G=F.internalError}s.displayNotification({msg:G,eventID:"error"});E()}})});A.push(z)}var C=new c(function(E){c.all(A).then(function(){B._updateDocumentView(y);w.unmask(B.elements.container);E()})});A.push(C)},_deleteDocument:function(z){var B=this;z=z.context;w.mask(B.elements.container,h.deleteDocumentMask);var A=[];var E=z.getTreeDocument(),D=E.getSelectedNodes();for(var y=0;y<D.length;y++){var x=new c(function(G){var F=D[y];u.deleteDocument({docId:F.options.physicalid,onComplete:function(H){B._relatedDocsUX.DOCUMENT.model.removeRoot(F);G()},onFailure:function(H){s.displayNotification({msg:h.cannotDeleteDoc,eventID:"error"});G()}})});A.push(x)}var C=new c(function(F){c.all(A).then(function(){if(B._isNoRelatedDocsAvailable()){B._displayInformationBox("nodocuments")}else{B._relatedDocsUX.DOCUMENT.update()}w.unmask(B.elements.container);F()})});A.push(C)},_inputFile:function(x){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){s.displayNotification({msg:h.msg_error_FileAPI,eventID:"error"});return}var y=document.querySelector(x.target);if(y){this._clearInput();this._fileInput=new q.File().inject(y);this._fileInput.elements.container.setStyle("display","none");this._fileInput.elements.input.multiple=x.multiple!==undefined?x.multiple:false;if(l.isTouchDevice()){this._fileInput.elements.input.accept="image/*;capture=camera"}this._fileInput.elements.input.addEventListener("change",x.onFileSelect.bind(this),false);this._fileInput.elements.input.click()}},_clearInput:function(){if(this._fileInput){this._fileInput.destroy();this._fileInput=null}},_dropDocument:function(C,E){C.preventDefault();C.stopPropagation();if(this.parentType&&this.parentType==="3DShape"){s.displayNotification({msg:h.unableCreateDocument3DShape,eventID:"error"});return false}var A=this;this._dndCounter=0;A._informationContainerBox.removeClassName("drag-over");var B=C.dataTransfer.types;var z=UWA.is(C.dataTransfer.types.indexOf,"function")?"indexOf":"contains";var F=B[z]("Files");if((UWA.is(F,"number")&&F>=0)||(UWA.is(F,"boolean")&&F===true)){var x=C.dataTransfer.files;A.createDocument({parentId:A.physicalid,files:x,fromDrop:true})}else{var y=l.deserializeDroppedData(C);var D=y.data.items;t.isValidDocuments(D,function(G){if(G.length>0){A._attachDocument({parentId:A.physicalid,docs:G,fromDrop:true})}else{if(A._isNoRelatedDocsAvailable()){A._displayInformationBox("nodocuments")}else{A._switchContainer("doccontent")}}})}return false},_dragOverDocument:function(y,x){y.preventDefault();y.stopPropagation();return false},_dragEnterDocument:function(y,x){if(r.firstParentWithClass("documentslist_container")){if(this._dndCounter===0){this._informationContainerBox.addClassName("drag-over");this._displayInformationBox("createDocument")}this._dndCounter++}y.preventDefault();y.stopPropagation();return false},_dragLeaveDocument:function(y,x){if(r.firstParentWithClass("documentslist_container")){this._dndCounter--;if(this._dndCounter===0){this._informationContainerBox.removeClassName("drag-over");if(this._isNoRelatedDocsAvailable()){this._displayInformationBox("nodocuments")}else{this._switchContainer("doccontent")}}}y.preventDefault();y.stopPropagation();return false},_dragStartTile:function(D,C){var A=C.nodeModel;var z=A.getTreeDocument();var B=z.getXSO().get().slice(0);var y=[];for(var x=0;x<B.length;x++){y.push({physicalid:B[x].options.physicalid,type:B[x].options.type,label:B[x].options.label,displayType:B[x].options.displayType?B[x].options.displayType:B[x].options.type,})}var E=l.dropdata_from_selected_ids(y);D.dataTransfer.setData("Text",JSON.stringify(E));D.stopPropagation();return false},_onDoubleClick:function(x){this._openIn3DPlay({context:x.nodeModel})},_openIn3DPlay:function(y){var x=y.context;x.getID=function(){return x.options.physicalid};var z=l.dropdata_from_selected_nodes([x]);var y={x3dSharedId:l.getSharedId(),x3dPlatformId:l.getPlatformId(),CollabSpacePref:JSON.stringify(z)};l.showTransientWidget("X3DPLAW_AP",undefined,y)}});return a});define("DS/PADUtils/commands/facets/RelatedDocumentsFacet",["UWA/Core","DS/PADUtils/views/RelatedDocumentsList","UWA/Controls/Abstract","UWA/Class","DS/PADUtils/PADContext","DS/PADUtils/PADTypesMgt","DS/Selection/CSOManager"],function(d,g,e,a,f,b,c){var i=require("DS/EditPropWidget/facets/Common/FacetsBase");var h=require("DS/EditPropWidget/constants/EditPropConstants");var j=a.extend(e,i,{_relatedDocList:null,init:function(k){this._parent(k);this._initUI()},_initUI:function(){if(this._relatedDocList===null){this.elements.container=d.createElement("div",{"class":"relatedDocuments"});this._relatedDocList=new g({readOnly:this.options.readOnly,kindOfDocuments:this.options.kindOfDocuments});this._relatedDocList.elements.container.inject(this.elements.container)}},updateFacet:function(){var k=this.getModel();if(k){var o=k.get("objectId");var l=[];if(f.get().getPADTreeDocument){l=f.get().getPADTreeDocument().getSelectedNodes()}else{l=c.get()}if(l.length!==1){console.error("Wrong number of selected object "+l.length)}else{if(l[0].getID){if(l[0].getID()!==o){console.error("Wrong selected object "+l[0].getID()+"!=="+o)}else{this._relatedDocList.selectionModified(l[0])}}else{var n=f.get().getController().buildArrayFromPath(l[0].pathElement);if(n[n.length-1]!==o){console.error("Wrong selected object "+n[n.length-1]+"!=="+o)}else{var m=f.get().getController().getNode({id:n[n.length-1]});this._relatedDocList.selectionModified(m)}}}}else{this._relatedDocList.selectionModified()}},destroyComponent:function(){},onResize:function(){if(this._relatedDocList){this._relatedDocList.onResize()}},onRefresh:function(){this.updateFacet()},isActionAvailable:function(r){var n=this.getModel();var l=false;if(n){var q=f.get().getPADTreeDocument().getSelectedNodes()[0];var o=q.options.type;var m=n.get(h.MODEL_DS_ATTR+"types");var p=m!=null?m.valueDB:null;if(p===null){p=[o]}var k=false;if(p.indexOf("VPMReference")!==-1){k=true}if(k&&r==="createDocument"){l=true}}return l},onAction:function(o){var l=this.getModel();if(l){var n=l.get("objectId");var m=l.getAllAttributes()["type"];var k="";if(m){k=m.valueDB}this._relatedDocList.createDocument({parentId:n,parentType:k,target:".xnav_body"})}}});return j});define("DS/PADUtils/views/parametrization/SelectionManagement",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","text!DS/PADUtils/assets/DefaultAttrParametrization.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","UWA/Promise","DS/Controls/ComboBox","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/PADUtils/PADWSAccess","DS/Controls/Button","DS/UIKIT/Mask","DS/PADUtils/views/parametrization/ComboSelector","DS/PADUtils/views/parametrization/TypesSelectionModal","DS/i3DXSNDictionaryAPI/3DXSearchDictionaryAccess","DS/PADUtils/PADDictionaryAccess","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt"],function(t,u,b,p,d,s,m,a,g,i,l,r,n,v,o,f,k,h,j,e){var q=JSON.parse(p);var c=s.extend(m,{name:"selectionMgt",defaultOptions:{defaultTypes:["VPMReference","VPMRepReference","3DShape"],typeModel:null,availableAttr:null,selectedAttrModel:null,addTypeOpen:false},init:function(w){this._parent(w);this.elements.container=d.createElement("div",{"class":this.getClassNames(w.inMainView===true?"-immersive":"")}).inject(w.renderTo);var y=this;this.options.typeModel=new i();var x=new a(function(A){var z=function(B){for(var D=0;D<y.options.defaultTypes.length;D++){var C=y.options.defaultTypes[D];if(B&&B["ds6w:type"]&&B["ds6w:type"][y.options.defaultTypes[D]]){C=B["ds6w:type"][y.options.defaultTypes[D]]}var E=new l({label:C,grid:{name:y.options.defaultTypes[D],cvName:"ds6wg:"+y.options.defaultTypes[D]},children:null});y.options.typeModel.addRoot(E);E.select()}A()};if(e.getSetting("FedDictionnaryAccess")===true){h.getNlsOfPropertiesValues(JSON.stringify({"ds6w:type":y.options.defaultTypes}),{tenantId:j.getPlatformId(),lang:e.getSetting("lang"),onComplete:function(B){z(B)},onFailure:function(B){console.error("PADDictionaryAccess.getNlsOfPropertiesValues API fails for "+JSON.stringify({"ds6w:type":y.options.defaultTypes}));z(null)}})}else{k.getNlsOfPropertiesValues(JSON.stringify({"ds6w:type":y.options.defaultTypes}),{tenantId:j.getPlatformId(),lang:e.getSetting("lang"),onComplete:function(B){z(B)},onFailure:function(B){console.error("3DXSearchDictionaryAccess.getNlsOfPropertiesValues API fails for "+JSON.stringify({"ds6w:type":y.options.defaultTypes}));z(null)}})}});this._buildTypesSelection(x);this._buildAttributesSelection(x)},addAttribute:function(w){this.options.availableAttr.addRoot(w)},removeSpecificColumn:function(x){var w=this.options.specificAttr.search({match:function(y){if(y.nodeModel.options.grid.name===x){return true}}});if(w.length===1){w[0].unselect()}},_buildTypesSelection:function(y){var z=this;var x=d.createElement("div",{"class":this.getClassNames("_typesSelection")}).inject(this.elements.container);var w=function(){var A=z.options.typeModel.getSelectedNodes(),C=[];for(var B=0;B<A.length;B++){C.push(A[B].options.grid.cvName)}if(C.length){z.elements.attrSelCombo.disabled=false;v.mask(z.elements.attrSelCombo.getContent(),b.fetchingAttributes);z.elements.attrTypeCombo.disabled(true);z._retrieveAvailableAttrForVocab(C,function(){z.elements.attrTypeCombo.disabled(false);v.unmask(z.elements.attrSelCombo.getContent())})}else{z.elements.attrSelCombo.disabled=true}};z.elements.attrTypeCombo=new o({className:"typeSelector",treedocument:z.options.typeModel,title:b.typesOfAttributes,withMore:true,disabled:true,events:{onSelectionChange:w,onMore:function(){var A=new f({inMainView:z.options.inMainView,modelEvts:z.options.modelEvts,selectedTypes:z.options.typeModel.getSelectedNodes(),events:{onTypesSelected:function(D){if(D.cancel===true){z.dispatchEvent("onResetParameters")}else{z.options.typeModel.empty();for(var C=0;C<D.selectedTypes.length;C++){var B=new l({label:D.selectedTypes[C].getLabel(),grid:{name:D.selectedTypes[C].options.grid.name,cvName:D.selectedTypes[C].options.grid.cvName,},children:null});z.options.typeModel.addRoot(B);B.select()}w();z.dispatchEvent("onResetParameters")}}}})}}}).inject(x)},_buildAttributesSelection:function(z){var B=this;B.options.availableAttr=new i();B.elements.attrSelection=d.createElement("div",{"class":this.getClassNames("_attrSelection")}).inject(this.elements.container);B.elements.attrSelCombo=new g({expanderIcon:"expand-down",elementsTree:B.options.availableAttr,placeholder:b.treelistparam_selectAttr,touchMode:true,enableSearchFlag:true,reachablePlaceholderFlag:true}).inject(B.elements.attrSelection);var w=B.elements.attrSelCombo.getContent();if(this.options.maskTarget){w=this.options.maskTarget}v.mask(w,b.fetchingAttributes);var y=d.createElement("div",{"class":this.getClassNames("_specificAttrSelection")}).inject(this.elements.container);B.options.specificAttr=new i();B.elements.specificAttrSelCombo=new o({className:"typeSelector",treedocument:B.options.specificAttr,title:b.displayOptions,events:{onSelect:function(I){var G=false,F=true;if(I.options.grid.name==="instanceName"){G=true;F=false}var H=b[I.options.grid.name]?b[I.options.grid.name]:b["treelistview_customization_"+I.options.grid.name];B.options.selectedAttrModel.addRoot({label:H,grid:{name:I.options.grid.name,cvName:I.options.grid.name,isVisibilityLock:false,isExportLock:F,exported:G,isHardcodedCol:true},children:null})},onUnselect:function(G){var F=B.options.selectedAttrModel.search({match:function(H){if(H.nodeModel.options.grid.cvName===G.options.grid.name){return true}}});if(F.length===1){B.dispatchEvent("onRemoveSpecificAttr",{removedNode:F[0]})}}}}).inject(y);for(var A=0;A<q.hardcodedColumns.length;A++){var C=b[q.hardcodedColumns[A]]?b[q.hardcodedColumns[A]]:b["treelistview_customization_"+q.hardcodedColumns[A]],E=new l({label:C,grid:{name:q.hardcodedColumns[A]},icons:q.hardcodedColumnsIcons[q.hardcodedColumns[A]]?[{iconName:q.hardcodedColumnsIcons[q.hardcodedColumns[A]],fontIconFamily:WUXManagedFontIcons.Font3DS}]:undefined,children:null});B.options.specificAttr.addRoot(E);var x=B.options.selectedAttrModel.search({match:function(F){if(F.nodeModel.options.column.dataIndex===q.hardcodedColumns[A]){return true}}});if(x.length){E.select()}}var D=new a(function(F){z.then(function(){var G=B.options.typeModel.search({match:function(J){if(J.nodeModel.isSelected()===true){return true}}});var I=[];for(var H=0;H<G.length;H++){I.push(G[H].options.grid.cvName)}B._retrieveAvailableAttrForVocab(I,F)})});D.then(function(){B.elements.attrSelCombo.addEventListener("change",function F(I){var H=B.options.availableAttr.search({match:function(J){if(J.nodeModel.getLabel()===I.dsModel.currentValue){return true}}});if(H&&H.length===1){B.options.availableAttr.removeRoot(H[0]);B.options.selectedAttrModel.addRoot(H[0])}else{if(H&&H.length>1){var G=I.dsModel.selectedIndex;H.forEach(function(J){if(J._unfilteredRowID===G){B.options.availableAttr.removeRoot(J);B.options.selectedAttrModel.addRoot(J)}})}}I.dsModel.selectedIndex=-1});B.elements.attrTypeCombo.disabled(false);v.unmask(w)})},_retrieveAvailableAttrForVocab:function(x,z){var A=function(C){var B,D="";if(C.range&&C.range.dataTypes&&C.range.dataTypes.length===1){D=C.range.dataTypes[0]}if(D.indexOf("timestamp")!==-1){B="date"}else{if(D.indexOf("integer")!==-1){B="integer"}else{if(D.indexOf("boolean")!==-1){B="boolean"}}}return B};if(x.indexOf("ds6wg:VPMReference")>-1){x.push("ds6wg:EnterpriseExtension")}var w=x.join("\n");var y=this;y.options.availableAttr.empty();if(x.length===0){if(z){z()}}else{if(e.getSetting("FedDictionnaryAccess")===true){require(["DS/PADUtils/PADDictionaryAccess"],function(B){B.getPropertiesForClass(w,{tenantId:j.getPlatformId(),lang:e.getSetting("lang"),apiVersion:"R2019x",extensions:true,onComplete:function(F){var M=d.is(F,"string")?JSON.parse(F):F;for(var L=0;L<M.length;L++){var I=M[L];var J=I.classInfo;for(var G=0;G<I.properties.length;G++){var H=I.properties[G];var E=y.options.availableAttr.search({match:function(N){if(N.nodeModel.options.grid.cvName===H.curi){return true}}});var K=y.options.selectedAttrModel.search({match:function(N){if(N.nodeModel.options.grid.cvName===H.curi){return true}}});if(E.length===0&&K.length===0){var D=A(H);var C=new l({label:H.label,grid:{name:H.label,cvName:H.curi,kind:D,isVisibilityLock:false,isExportLock:false,exported:true},children:null});y.options.availableAttr.addRoot(C)}}}if(z){z()}},onFailure:function(C){require(["DS/PADUtils/views/PADAlert"],function(D){D.displayNotification({msg:b.ERR_getPredicates,eventID:"error"});if(z){z()}})}})})}else{r.getPredicates({classURIs:w,onComplete:function(F){v.mask(y.elements.attrSelCombo.getContent(),b.fetchingAttributes);var M=d.is(F,"string")?JSON.parse(F):F;for(var L=0;L<M.classPredicates.length;L++){var I=M.classPredicates[L];var J=I.className;for(var G=0;G<I.vocabularyPredicateInfo.length;G++){var H=I.vocabularyPredicateInfo[G];var E=y.options.availableAttr.search({match:function(N){if(N.nodeModel.options.grid.cvName===H.uri){return true}}});var K=y.options.selectedAttrModel.search({match:function(N){if(N.nodeModel.options.grid.cvName===H.uri){return true}}});if(E.length===0&&K.length===0){var D=A(H);var C=new l({label:H.nlsName,grid:{name:H.name,cvName:H.uri,kind:D,isVisibilityLock:false,isExportLock:false,exported:true},children:null});y.options.availableAttr.addRoot(C)}}}var B=y.options.selectedAttrModel.search({match:function(N){if(N.nodeModel.options.grid.cvName==="ds6w:type"){return true}}});if(B.length===0){require(["DS/i3DXSNDictionaryAPI/3DXSearchDictionaryAccess"],function(N){N.getElementsNls("ds6w:type",{tenantId:j.getPlatformId(),lang:e.getSetting("lang"),onComplete:function(O){var P=d.is(O,"string")?JSON.parse(O):O;var Q=new l({label:P["ds6w:type"].nlsName,grid:{name:"ds6w:type",cvName:"ds6w:type",isVisibilityLock:false,isExportLock:false,exported:true},children:null});y.options.availableAttr.addRoot(Q,0);v.unmask(y.elements.attrSelCombo.getContent());if(z){z()}},onFailure:function(O){console.error("NLS FAILED >> getElementsNls >> ds6w:type");v.unmask(y.elements.attrSelCombo.getContent());if(z){z()}}})})}else{v.unmask(y.elements.attrSelCombo.getContent());if(z){z()}}},onFailure:function(){require(["DS/PADUtils/views/PADAlert"],function(B){B.displayNotification({msg:b.ERR_getPredicates,eventID:"error"});if(z){z()}})}})}}}});return c});define("DS/PADUtils/views/parametrization/TreeListParametrization",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","text!DS/PADUtils/assets/DefaultAttrParametrization.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/PADUtils/PADWSAccess","DS/PADUtils/PADPromise","DS/Tree/TreeListView","DS/Tree/TreeDocument","DS/Tree/TreeNodeModel","DS/Windows/Panel","DS/Controls/Button","DS/UIKIT/Mask","DS/Utilities/Dom","DS/Controls/Toggle","DS/PADUtils/views/parametrization/Iconbar","DS/PADUtils/views/parametrization/SelectionManagement","DS/PADUtils/views/parametrization/ComboSelector"],function(t,v,c,p,f,s,l,r,b,h,j,k,i,n,w,u,e,a,d,o){var q=JSON.parse(p);var m="DS/ENOFloatingPanel/ENOFloatingPanel";var g=s.extend(l,{name:"treelistparam",defaultOptions:{hardcodedColumns:q.hardcodedColumns,hardcodedColumnsDef:q.hardcodedColumnsDef,selectedAttrModel:null,selectedTreeLst:null},init:function(x){this._parent(x);var y=this;if(x.events){y.addEvents(x.events)}if(x.inMainView){y.elements.container=f.createElement("div",{"class":y.getClassNames("-immersivePanel")});y.options.selectedAttrModel=new j();y._buildAvailableAttrList(y.options.columns);y._buildCustoInMainView(y.options);y.options.modelEvts.publish({event:"ENXViews/Views/showInWidgetBody",data:{html:y.elements.container}});y.elements.panel2small=f.createElement("div",{"class":y.getClassNames("-panel2small"),text:c.panel2small}).inject(y.elements.container)}else{require([m],function(z){y.elements.container=f.createElement("div",{"class":"custoTreelist"});y.render_div=document.querySelector(y.options.render_div);y.options.selectedAttrModel=new j();y._buildAvailableAttrList(y.options.columns);y._buildCustoView(y.options);y.elements.floatingpanel=new z({className:y.name,body:y.elements.container,footer:y._buildFooter(),title:c.treeListViewOptions,overlay:true,closable:true,animate:true,resizable:true,visible:true,events:{onClose:function(){y._closePanel();y.elements.floatingpanel.destroy()}}});y.elements.floatingpanel.inject(y.render_div)})}},_buildCustoView:function(){var B=this;this.elements.custoView=f.createElement("div",{"class":"custoView"}).inject(this.elements.container);B.elements.selectionArea=f.createElement("div",{"class":"selectionArea"}).inject(this.elements.custoView);B.elements.attrManagementArea=f.createElement("div",{"class":"attrManagement"}).inject(this.elements.custoView);B.options.selectionManagement=new d({selectedAttrModel:this.options.selectedAttrModel,renderTo:B.elements.selectionArea,maskTarget:document.body,events:{onRemoveSpecificAttr:function(G){B._removeFromSelectedAttr([G.removedNode])}}});B._buildIconBar();B._buildSelectedTreeList();var E=f.createElement("div",{"class":"footerView"}).inject(this.elements.container);var z=false;if(this.options.events.saveAsTemplate){z=true;E.addClassName("compactModeAvailable");B.elements.selectionArea.addClassName("compactModeAvailable");var y=new j();var x=new k({viewMode:"comfortable",label:c.Comfortable,subLabel:c.ComfortableExplanation,children:null,icons:[{iconName:"view-big-tile",fontIconFamily:WUXManagedFontIcons.Font3DS}]});y.addRoot(x);var C=new k({viewMode:"compact",label:c.Compact,subLabel:c.CompactExplanation,children:null,icons:[{iconName:"view-list",fontIconFamily:WUXManagedFontIcons.Font3DS}]});y.addRoot(C);if(this._hasThumbNail){this.options.viewMode==="comfortable";x.select(true)}if(this.options.viewMode==="compact"){C.select(true)}else{x.select(true)}this.comboCompact=new o({className:"compactModeSelector",treedocument:y,withMore:false,disabled:false,multisel:false,events:{onSelectionChange:function(){B.dispatchEvent("compactMode",{viewMode:y.getSelectedNodes()[0].options.viewMode})}}});if(this._hasThumbNail){this.comboCompact.disabled(true)}var A=f.createElement("div",{"class":this.name+"_footerArea comboDiv"});var D=f.createElement("div",{"class":"comboLabel",text:c.density});D.inject(A);this.comboCompact.inject(A);A.inject(E);this.applyToggle=new e({label:c.padcustomizeview_apply_to_this_app});var F=f.createElement("div",{"class":this.name+"_instruction applyToggle"});if(!z){new f.createElement("hr",{"class":"ruler"}).inject(F)}this.applyToggle.inject(F);F.inject(E);this.applyToggle.addEventListener("change",function(H){var G=H.dsModel;B._applyOnlyToThisApp=G.checkFlag})}},_buildCustoInMainView:function(){var z=this;z.elements.selectionArea=f.createElement("div",{"class":"selectionArea"}).inject(this.elements.container);z._buildIconBar(true);z.elements.attrManagementArea=f.createElement("div",{"class":"attrManagement"}).inject(this.elements.container);z.options.selectionManagement=new d({selectedAttrModel:this.options.selectedAttrModel,renderTo:z.elements.selectionArea,maskTarget:document.body,inMainView:true,modelEvts:this.options.modelEvts,events:{onRemoveSpecificAttr:function(E){z._removeFromSelectedAttr([E.removedNode])},onResetParameters:function(){z.options.modelEvts.publish({event:"ENXViews/Views/showInWidgetBody",data:{html:z.elements.container}})}}});z._buildSelectedTreeList(true);var D=f.createElement("div",{"class":"otherAppOpts"}).inject(this.elements.container);if(this.options.events.saveAsTemplate){D.addClassName("compactModeAvailable");z.elements.selectionArea.addClassName("compactModeAvailable");var C=new j();var B=new k({viewMode:"comfortable",label:c.Comfortable,subLabel:c.ComfortableExplanation,children:null,icons:[{iconName:"view-big-tile",fontIconFamily:WUXManagedFontIcons.Font3DS}]});C.addRoot(B);var y=new k({viewMode:"compact",label:c.Compact,subLabel:c.CompactExplanation,children:null,icons:[{iconName:"view-list",fontIconFamily:WUXManagedFontIcons.Font3DS}]});C.addRoot(y);if(this._hasThumbNail){this.options.viewMode==="comfortable";B.select(true)}if(this.options.viewMode==="compact"){y.select(true)}else{B.select(true)}this.comboCompact=new o({className:"compactModeSelector",treedocument:C,withMore:false,disabled:false,multisel:false,events:{onSelectionChange:function(){z.dispatchEvent("compactMode",{viewMode:C.getSelectedNodes()[0].options.viewMode})}}});if(this._hasThumbNail){this.comboCompact.disabled(true)}var x=f.createElement("div",{"class":this.name+"_optsCompact comboDiv"});var A=f.createElement("div",{"class":"optsCompactLabel",text:c.density});A.inject(x);this.comboCompact.inject(x);x.inject(D);this.applyToggle=new e({label:c.padcustomizeview_apply_to_this_app});this.applyToggle.getContent().addClassName(this.getClassNames("-applyToggle"));this.applyToggle.inject(D);this.applyToggle.addEventListener("change",function(F){var E=F.dsModel;z._applyOnlyToThisApp=E.checkFlag})}z.elements.footer=f.createElement("div",{"class":z.getClassNames("-footer")}).inject(z.elements.container);z._buildFooter().inject(z.elements.footer)},_buildFooter:function(){var z=this;var A=f.createElement("div",{"class":"footerModal"});var x=new n({label:c.padcustomizeview_button_close,emphasize:"primary",touchMode:true});x.addEventListener("click",function(){z._closePanel();if(z.elements.floatingpanel){z.elements.floatingpanel.destroy()}});x.inject(A);var y=new n({label:c.padcustomizeview_button_reset,touchMode:true});y.inject(A);y.addEventListener("click",function(){z.dispatchEvent("reset",z._applyOnlyToThisApp===true);z._closePanel();if(z.elements.floatingpanel){z.elements.floatingpanel.destroy()}});return A},_buildSelectedTreeList:function(A){var z=this;var x={height:"auto",selection:{enableListSelection:true,toggle:false},defaultCellHeight:30,enableDragAndDrop:false,enableActiveUI:true,enableKeyboardNavigation:true,enableTreeColumnEllipsisOverflow:true,performances:{preloadPool:true,useRequestAnimationFrameRendering:false},resize:{columns:false},isEditable:true,columns:[{width:"auto",dataIndex:"tree",text:c.padcustomizeview_column_name_header,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,},{text:c.color,dataIndex:"powerByColor",width:40,minWidth:40,maxWidth:40,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(D){if(D.isHeader){D.cellView.reuseCellContent("powerByColorHeader")}else{D.cellView.reuseCellContent("powerByColor");var B="#ffffff";var C="#000000";if(D.nodeModel.options.grid&&D.nodeModel.options.grid.columnColor){B=D.nodeModel.options.grid.columnColor["background-color"]?D.nodeModel.options.grid.columnColor["background-color"]:"#ffffff";B=B.replace(/;/g,"");C=D.nodeModel.options.grid.columnColor.color?D.nodeModel.options.grid.columnColor.color:"#0000";C=C.replace(/;/g,"")}var E=D.cellView.getContent().querySelector(".powerByColorLauncher");if(E){if(f.is(E.setStyles,"function")){E.setStyles({"background-color":B,color:C})}else{E.style.color=C;E.style["background-color"]=B}}}}},{text:c.exportNLS,dataIndex:"powerByExport",width:40,minWidth:40,maxWidth:40,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(B){if(B.isHeader){B.cellView.reuseCellContent("powerByExportHeader")}else{if(B.nodeModel.options.grid.exported){B.cellView.reuseCellContent("powerByExportOK")}else{B.cellView.reuseCellContent("powerByNoExport")}if(B.nodeModel.options.grid.isExportLock){B.cellView.getContent().setAttribute("lock","")}}}},{text:"",dataIndex:"powerByRemove",width:40,minWidth:40,maxWidth:40,isDraggable:false,isColumnMovable:false,isEditable:false,isSortable:false,onCellRequest:function(B){if(!B.isHeader){B.cellView.reuseCellContent("powerByRemove");if(B.nodeModel.options.grid.isVisibilityLock){B.cellView.getContent().setAttribute("lock","")}else{B.cellView.getContent().removeAttribute("lock","")}}}}]};z.options.selectedTreeLst=new h(x);z.options.selectedTreeLst.getManager().loadDocument(z.options.selectedAttrModel);if(A){z.options.selectedTreeLst.getContent().inject(z.elements.attrManagementArea)}else{z.options.selectedTreeLst.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0});var y=f.createElement("div",{"class":"attrSelectedList"}).inject(this.elements.attrManagementArea);z.options.selectedTreeLst.getContent().inject(y)}z.options.selectedAttrModel.getXSO().onPostAdd(z._manageSelection.bind(z));z.options.selectedAttrModel.getXSO().onPostRemove(z._manageSelection.bind(z));z.options.selectedAttrModel.getXSO().onEmpty(z._manageSelection.bind(z));z.options.selectedAttrModel.onNodeModelUpdate(z._onNodeModelUpdate.bind(z));z.options.selectedTreeLst.onNodeClick(z._onCellClick.bind(z));z.options.selectedAttrModel.getModelEvents().subscribe({event:"addChild"},function(B){setTimeout(function(){z.options.selectedTreeLst.getManager().scrollToNode(B.data.nodeModel);B.data.nodeModel.select(true);z.options.selectedTreeLst.giveFocus();if(B.data.nodeModel._isMoving){delete B.data.nodeModel._isMoving;return}z._onAddColumn(B.data.nodeModel)},200)});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByColorHeader",buildContent:function(){return u.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-palette powerByCommandHeader",style:"font-size: 18px;"})}});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByColor",buildContent:function(){var B=u.createElement("div",{"class":"powerByCommand",});var C=u.createElement("div",{"class":"powerByColorLauncher",styles:{"background-color":"#ffffff",color:"#000000","font-size":"18px"},title:c.changeColor});C.innerHTML=c.PADColorView_content;B.appendChild(C);return B}});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByRemove",buildContent:function(){return u.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash powerByCommand",style:"font-size: 18px;",title:c.remove})}});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByExportHeader",buildContent:function(){return u.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export powerByCommandHeader",style:"font-size: 18px;"})}});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByExportOK",buildContent:function(){var B=u.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-check powerByCommand",style:"font-size: 18px;",title:c.changeExport});return B}});z.options.selectedTreeLst.getManager().registerReusableCellContent({id:"powerByNoExport",buildContent:function(){var B=u.createElement("span",{"class":"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-wrong powerByCommand",style:"font-size: 18px;",title:c.changeExport});return B}})},_buildAvailableAttrList:function(D){var E=this;for(var C=0;C<D.length;C++){var A=D[C];var z=E.options.hardcodedColumns.indexOf(A.dataIndex)!==-1&&A.isHidden!==true?true:false;if((A.xnav_options&&A.xnav_options.name)||z){var y=A.xnav_options&&A.xnav_options.name?A.xnav_options.name:A.dataIndex,x=A.text;if(!(A.text&&A.text.length)){x=c["treelistview_customization_"+A.dataIndex]}var B={label:x,grid:{name:y,cvName:y,isVisibilityLock:typeof A.xnav_options.layout.removable==="boolean"?!A.xnav_options.layout.removable:false,isExportLock:A.xnav_options.exportable?A.xnav_options.exportable.lock:false,exported:A.xnav_options.exportable?A.xnav_options.exportable.value:true,columnColor:A.xnav_options.layout.styles},column:A,children:null};this.options.selectedAttrModel.addRoot(B)}if(A.dataIndex==="thumbnail"){this._hasThumbNail=true}}},_buildIconBar:function(A){var z=this;var y={multiSelect:true,items:[{fonticon:"up",text:c.moveUp,name:"moveUp",disabled:true},{fonticon:"down",text:c.moveDown,name:"moveDown",disabled:true},{fonticon:"move-to-top",text:c.moveFirst,name:"moveFirst",disabled:true},{fonticon:"move-to-bottom",text:c.moveLast,name:"moveLast",disabled:true},{className:"divider"},{fonticon:"palette",text:c.changeColor,name:"changeColor",disabled:true},{fonticon:"trash",text:c.remove,name:"remove",disabled:true}],events:{onClick:function(C,B){switch(B.name){case"remove":z._removeFromSelectedAttr(z.options.selectedAttrModel.getSelectedNodes());break;case"changeColor":z._changeColor(z.options.selectedAttrModel.getSelectedNodes());break;case"moveFirst":case"moveUp":case"moveDown":case"moveLast":z._moveColumn(B.name,z.options.selectedAttrModel.getSelectedNodes());break;default:break}}}};var x=f.createElement("div",{"class":"commands"});if(A){x.inject(this.elements.container)}else{x.inject(this.elements.attrManagementArea)}y.renderTo=x;this.elements.iconbar=new a(y)},_closePanel:function(){if(this.options.cmd){this.options.cmd.enable()}if(this._applyOnlyToThisApp===true){this.dispatchEvent("custoViewChange")}else{this.dispatchEvent("saveAsTemplate")}var x=document.querySelector("div.wux-controls-combobox-popup.wux-controls-popup");if(x){x.parentNode.removeChild(x)}if(this.options.modelEvts){this.options.modelEvts.publish({event:"ENXViews/Views/showInWidgetBody",data:{restore:true}})}},_onNodeModelUpdate:function(x){var y=x.target.options.column?x.target.options.column.dataIndex:x.target.options.grid.cvName;var z={dataIndex:y,columnColor:x.target.options.grid.columnColor,exportable:x.target.options.grid.exported};this.dispatchEvent("modifyColumRendering",z)},_onAddColumn:function(z){var x;if(z.options.grid.isHardcodedCol){x=this.options.hardcodedColumnsDef[z.options.grid.name];x.text=z.options.label}else{x={dataIndex:z.options.grid.cvName,text:z.options.label,minWidth:50,xnav_options:{name:z.options.grid.cvName,layout:{removable:true},exportable:{lock:false,value:true},kind:z.options.grid.kind}}}if(x.dataIndex==="thumbnail"){if(this.comboCompact){var y=this.comboCompact.options.treedocument.getRoots();y.forEach(function(A){if(A.options.viewMode==="comfortable"){A.select()}else{A.unselect()}});this.comboCompact.dispatchEvent("onSelectionChange");this.comboCompact.disabled(true)}}this.dispatchEvent("addColumn",x)},_onRemoveColumn:function(y){var x={dataIndex:y.options.grid.cvName};if(x.dataIndex==="thumbnail"){if(this.comboCompact){this.comboCompact.disabled(false)}}this.dispatchEvent("removeColumn",x)},_onCellClick:function(y){if(y===undefined||(y.cellModel&&y.cellModel.options&&y.cellModel.options.isHeader)){return}switch(y.dataIndex){case"powerByRemove":if(y.nodeModel.options.grid.isVisibilityLock!==true){this._removeFromSelectedAttr([y.nodeModel])}break;case"powerByColor":this._changeColor([y.nodeModel]);break;case"powerByExport":var x=y.nodeModel.options.grid.exported;this._changeExport([y.nodeModel],!x);break}},_removeFromSelectedAttr:function(x){var B=this;for(var z=0;z<x.length;z++){var A=x[z];if(A.options.grid.isVisibilityLock!==true){this.options.selectedAttrModel.removeRoot(A);this._onRemoveColumn(A);var y=B.options.hardcodedColumns.indexOf(A.options.grid.name)!==-1?true:false;if(y){B.options.selectionManagement.removeSpecificColumn(A.options.grid.name)}else{B.options.selectionManagement.addAttribute(A)}}}},_changeColor:function(y){var x=this;require(["DS/PADUtils/views/PADColorPicker"],function(z){var A={background_color:"#ffffff",color:"#0000"};new z({selected_color:A,renderTo:document.body,events:{onColorOK:function(B){for(var C=0;C<y.length;C++){var D=y[C];D.updateOptions({grid:{columnColor:{"background-color":B.background_color+";",color:B.color+";"}}})}}}})})},_changeExport:function(x,y){this.options.selectedAttrModel.withTransactionUpdate(function(){for(var z=0;z<x.length;z++){var A=x[z];A.updateOptions({grid:{exported:y}})}})},_manageSelection:function(){var A=this.options.selectedAttrModel.getSelectedNodes(),x;var z=["moveFirst","moveUp","moveDown","moveLast","changeColor","remove"],y=["changeColor","remove"];for(x=0;x<z.length;x++){if(A.length!==1){this.elements.iconbar.disableItem(z[x])}else{this.elements.iconbar.enableItem(z[x])}}for(x=0;x<y.length;x++){if(A.length===0){this.elements.iconbar.disableItem(y[x])}else{this.elements.iconbar.enableItem(y[x])}}},_moveColumn:function(z,x){var y=this;this.options.selectedAttrModel.withTransactionUpdate(function(){var C=x[0],B=C._getLocalID?C._getLocalID():C._localID,A={fromID:B,toID:-1};switch(z){case"moveFirst":A.toID=0;break;case"moveUp":A.toID=B-1;break;case"moveDown":A.toID=B+1;break;case"moveLast":A.toID=y.options.selectedAttrModel.getRoots().length-1;break}if(A.toID!==-1&&A.toID<y.options.selectedAttrModel.getRoots().length){C._isMoving=true;y.options.selectedAttrModel.addChild(C,A.toID);y.dispatchEvent("moveColumn",{move2perform:A})}})}});return g});