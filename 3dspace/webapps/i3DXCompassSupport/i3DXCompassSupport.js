define("DS/i3DXCompassSupport/View/TicketKoView",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle"],function(f,d,b,e){var c=window.location.origin,a=c.replace("ifwe","apps");return d.extend({tagName:"div",className:"ticket-view",tooltipSearch:null,tooltipInformationOtt:null,tooltipNumberField:null,tooltipInformationOtt0:null,render:function(){this.container.setContent(this._createTemplate());return this},_createTemplate:function(){return[{"class":"ticket-view-first-search",html:[this.removeTooltip(),this.headerZone(),this.firstsearchZone(),{"class":"ticket-body-view",html:this.firstSearch()}]}]},firstSearch:function(){return[{"class":"ticket-view-search",html:[{"class":"ticket-view-search-icon",html:[{tag:"span","class":"fonticon fonticon-search globalView",html:{tag:"p","class":"start-search",text:"Start a search"}}]},{"class":"ticket-view-search-comment",html:{tag:"span","class":"text-comment-search",text:"Please fill in the field to start searching for the ticket consumption."}}]}]},searchAgainAfterClick:function(h){var g=this;if(h.target.hasClassName("searching")){g.dispatchEvent("StartSearchTicket")}},validateSearch:function(){var g=this;if(this.getContent().getElement("span.fonticon.fonticon-search.searching")!==null){g.dispatchEvent("StartSearchTicket")}},firstsearchZone:function(){var g=f.createElement("span",{"class":"fonticon fonticon-search",events:{click:this.searchAgainAfterClick.bind(this)}});return[{"class":"ticket-first-search",html:[{"class":"choice-ott-or-platform",html:[{tag:"input",type:"text","class":"form-control input-platform input-ott",placeholder:"Ott value OR platform name ...",events:{keyup:function(j){var i=this.container.getElements("input.form-control.input-platform.input-ott")[0],h=this.getContent().getElement("span.fonticon.fonticon-search");this.checkCharacters(j,i,h);if(j.keyCode===13){this.validateSearch()}}.bind(this),mouseover:function(h){if(this.tooltipInformationOtt0!==null){this.tooltipInformationOtt0.destroy();this.tooltipInformationOtt0=null}if(h.target.hasClassName("input-not-validate")){this.tooltipInformationOtt0=new b({position:"bottom",target:h.target,body:'The field can not contain specials characters :  !, ยง, ^, $,(, ), [, ], }, {, ?, +, *, /, ", \\'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-monitor input"},g]}]}]},headerZone:function(){return[{"class":"ticket-zone-global-top",html:{"class":"ticket-step",html:[{"class":"ticket-step-circle",html:{tag:"span","class":"circle-background-blue",html:{tag:"p","class":"number-step",text:"1"}}},{tag:"div","class":"text-blue-step",text:"Fill in the field"}]}}]},isSuccess:function(g){return(g.code===0)},ottIsEmpty:function(g){return(g==="")},platformIsEmpty:function(g){return(g==="")},removeTooltip:function(){var g=widget.body.getParents()[2].getElements("div.tooltip.tooltip-root.in");for(var h=0;h<=g.length;h++){if(g[h]!==undefined){g[h].remove()}}},checkCharacters:function(m,k,j){var i=/[/!|^|$|(|)|[|\]|}|{|?|+|*|/|\\|"|ยง]/,g=m.target,l=m.target.value,h=m.key;if(this.tooltipInformationOtt!==null){this.tooltipInformationOtt.destroy();this.tooltipInformationOtt=null}if(this.tooltipSearch!==null){this.tooltipSearch.destroy();this.tooltipSearch=null}if(m.key!=="Enter"){if(l===""){g.removeClassName("selected");j.removeClassName("dark-grey");g.removeClassName("input-not-validate");j.removeClassName("searching");this.tooltipSearch=new b({position:"bottom",target:j,body:"You should define ott value or platform name"}).show()}else{g.addClassName("selected");if((i.test(l))||(i.test(h))){g.addClassName("input-not-validate");this.tooltipInformationOtt=new b({position:"bottom",target:g,body:'The field can not contain specials characters :  !, ยง, ^, $,(, ), [, ], }, {, ?, +, *, /, ", \\'}).show();j.removeClassName("searching")}else{g.removeClassName("input-not-validate");j.addClassName("searching");j.addClassName("dark-grey")}}}},_searchZone:function(g){return[{"class":"ticket-search-zone",html:{"class":"ticket-search",html:[{tag:"input",type:"text","class":"form-control search-ott-platform second-time",placeholder:"Ott value OR platform name ...",value:g,events:{keyup:function(j){var i=j.target.getParent().getElements("input.search-ott-platform")[0],h=j.target.getParent().getElement("span.fonticon.fonticon-search.second-time");this.checkCharacters(j,i,h);if(j.keyCode===13){this.searchAgainAfterEnter(h)}}.bind(this),mouseover:function(h){if(this.tooltipInformationOtt0!==null){this.tooltipInformationOtt0.destroy();this.tooltipInformationOtt0=null}if(h.target.hasClassName("input-not-validate")){this.tooltipInformationOtt0=new b({position:"bottom",target:h.target,body:'The field can not contain specials characters :  !, ยง, ^, $,(, ), [, ], }, {, ?, +, *, /, ", \\'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-monitor inputBis"},{tag:"div","class":"div-fonticon-search",html:{tag:"span","class":"fonticon fonticon-search second-time",events:{click:this.searchAgain.bind(this)}}}]}}]},lengthService:function(g){var h="Service(s) Ko for the platform "+g.platform+" ("+g.platformDisplayName+") | ";if(g.services==="N/A"){return h+"0"}else{return h+g.services.length}},_headerZoneBis:function(g){return[{"class":"ticket-body-zone-header",html:[this.isSuccess(this.model)?{"class":"ticket-body-zone-header-small",html:[{tag:"div","class":"div-fonticon-monitor",html:{tag:"span","class":"fonticon fonticon-monitor"}},{tag:"div","class":"platform-name",text:this.lengthService(g)}]}:{tag:"div","class":"error-detected",text:"An error has occured "}]}]},iconsWithService:function(h){var g=h.id,j,i;switch(g){case"DRIVE":j="X3DDRIV_AP_AppIcon.png";break;case"NETVIBES":j="iconNETVIBES.png";break;case"SWYM":j="X3DMCTY_AP_AppIcon.png";break;case"SPACE":j="X3DCSMA_AP_AppIcon.png";break;default:j="3DExpPlatform_Default.png"}i=a+"/enovia/widget/images/MyApps/"+j;return i},searchAgain:function(h){var g=this;if(h.target.hasClassName("fonticon fonticon-search second-time searching")){g.dispatchEvent("SearchAgainTicket")}},searchAgainAfterEnter:function(g){var h=this;if(g.hasClassName("searching")){h.dispatchEvent("SearchAgainTicket")}},recuperationErrorCode:function(){var h=this.model.code,g=null;if(h===2){g="Please enter another ott value or platform name."}else{g="Please modify your input."}return g},NoServiceFailed:function(g){var h;h={"class":"ticket-body-zone-serviceko-body-small",html:[{"class":"service-ko-boxBis noService",html:[{tag:"span","class":"circleGreen",html:{tag:"span","class":"fonticon fonticon-check noservice"}},{tag:"p","class":"message-noService-failed",text:"All Service are running properly."}]}]};return h},recuperationInfoService:function(g){if(g.services.length===0){return this.NoServiceFailed(this.model)}else{return this.recuperationServiceKo(this.model)}},recuperationServiceKo:function(g){var i,h=this;i={"class":"ticket-body-zone-serviceko-body-small",html:g.services.map(function(l){var k=f.createElement("div",{"class":"message-error-zone",text:l.message});var j=f.createElement("span",{"class":"fonticon fonticon-lock"});var m=f.createElement("span",{"class":"fonticon fonticon-lock-open"});return{"class":"service-ko-box",html:[{"class":"service-ko-header",html:[{tag:"span","class":(l.syncBlocking==="2")?"circle-background circle-red":"circle-background circle-orange",html:(l.syncBlocking==="2")?{html:[j,new b({position:"left",target:j,body:"This service blocks the general synchronization of the user's information near the different services of the 3DExperience platform."})]}:{html:[m,new b({position:"left",target:m,body:"This service does not block the general synchronization of the user's information on the 3DExperience platform."})]}}]},{"class":(l.syncBlocking==="2")?"service-ko-body border-square-color-red":"service-ko-body border-square-color-orange",html:[{"class":"timing-zone",html:[{tag:"span","class":"fonticon fonticon-3ds-when"},{tag:"span","class":"text-timing",text:l.timing},{tag:"span","class":"text-timing ms",text:" ms"}]},k,new b({position:"right",target:k,body:l.message}),{"class":(l.syncBlocking==="2")?"name-service-zone synchrouser-background-color-red":"name-service-zone synchrouser-background-color-orange",html:[{tag:"img","class":"icon",id:"icon-service",src:h.iconsWithService(l)},{tag:"span","class":"name-of-service-ko",text:l.id}]}]}]}})};return i},_successFailView:function(i,g){var h=f.createElement("span",{"class":"fonticon fonticon-lock-open-user"});return[{"class":"ticket-view-first-search",html:[this.removeTooltip(),this._searchZone(i),{"class":"ticket-body-zone",html:[this._headerZoneBis(this.model),{"class":"ticket-body-zone-body",html:{"class":"ticket-body-sucess-view",html:{"class":"ticket-body-sucess",html:[{"class":"ticket-body-sucess-header",html:[{tag:"span","class":this.isSuccess(this.model)?"circle-background green":"circle-background grey",html:{tag:"span","class":this.isSuccess(this.model)?"fonticon fonticon-check":"fonticon fonticon-wrong"}}]},{"class":this.isSuccess(this.model)?"ticket-body-sucess-body border-color-green":"ticket-body-sucess-body border-color-grey",html:[this.isSuccess(this.model)?[{"class":"user-locked-zone",html:[h,new b({position:"left",target:h,body:"No user locked on this platform"})]},{"class":"message-zone",tag:"div",text:"The platform "+this.model.platform+" is not locked."}]:[{"class":"user-locked-zone"},{"class":"message-zone fail",tag:"div",text:this.model.message},{"class":"advise-zone",html:[{tag:"span","class":"fonticon fonticon-info advice"},{tag:"span","class":"advice-text",text:this.recuperationErrorCode()}]}]]}]}}}]}]}]},_failCallWs:function(h,g){return[{"class":"ticket-view-first-search",html:[this.removeTooltip(),this._searchZone(h),{"class":"ticket-body-zone",html:[{"class":"ticket-globalFail-header",html:{"class":"ticket-globalFail-header-small",html:[{"class":"big-message",tag:"div",text:"Oops, "},{"class":"small-message",tag:"div",text:"We are sorry ... "}]}},{"class":"ticket-globalFail-body",html:{"class":"ticket-globalFail-body-small",html:[{tag:"span","class":"fonticon fonticon-comment"},{"class":"ticket-globalFail-view-icons",html:{tag:"span","class":"fonticon fonticon-role"}}]}},{"class":"ticket-globalFail-footer",html:{"class":"message-global-error",text:"An unexpected error has occured ... Server is unavailable. Please try later."}}]}]}]},_createTemplateBis:function(h){var i=f.createElement("span",{"class":"fonticon fonticon-lock-user"}),g=f.createElement("div",{"class":"user-name",text:this.model.user});new b({position:"left",target:i,body:this.model.user+" locked on "+this.model.platform});return[{"class":"ticket-view-first-search",html:[this.removeTooltip(),this._searchZone(h),{"class":"ticket-body-zone",html:[this._headerZoneBis(this.model),{"class":"ticket-body-zone-body",html:[{"class":"ticket-body-zone-user",html:{"class":"ticket-body-zone-user-small",html:[{tag:"div","class":"div-fonticon-lock-user",html:[i]},g,new b({position:"left",target:g,body:this.model.user})]}},{"class":"ticket-body-zone-serviceko-body",html:[this.recuperationInfoService(this.model)]}]},{"class":(this.model.status==="ko")?"ticket-body-zone-serviceko-footer red":"ticket-body-zone-serviceko-footer green",tag:"div",text:"Synchronization User : "+this.model.status}]}]}]}})});define("DS/i3DXCompassSupport/Collection/i3DXCompassCollection",["UWA/Core","UWA/Class/Collection","DS/i3DXCompassCore/RequestOptions"],function(d,b,a){var c=d.clone(a);c.getOptionsUrl=function(g){var f=localStorage.getItem("addressCluster"),e="/enovia";if(!f){var h=g.substring(0,g.indexOf(e));localStorage.setItem("addressCluster",h);return g}return f+e};c.options.backendPath="/resources/AppsMngtSupport/";return b.extend(c)});define("DS/i3DXCompassSupport/View/BroadcastFinalView",["DS/WAFData/WAFData","UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Popover","DS/UIKIT/Input/Toggle"],function(a,f,d,c,b,e){return d.extend({tooltipInformationUser:null,tooltipInformationPlatform:null,tooltipRunBroadcast:null,failurePopover:null,refreshDonePopover:null,timeOutPopoverFail:null,timeOutPopoverDone:null,tooltipInformationUser0:null,tooltipInformationPlatform0:null,render:function(g,h){this.container.setContent(this._createTemplate());return this},_createTemplate:function(){return[{"class":"broadcast-view-first-search",html:[this.removeTooltip(),this.headerZone(),this.firstsearchZone(),{"class":"broadcast-body-view",html:this.firstSearch()}]}]},isSuccesHeader:function(){if((this.model===undefined)||(this.model.code===0)){return true}},headerZone:function(){return[{"class":"broadcast-zone-global-top",html:{"class":"broadcast-step",html:[{"class":"broadcast-step-circle",html:{tag:"span","class":this.isSuccesHeader()?"circle-background-blue":" circle-background-blue grey",html:{tag:"p","class":"number-step",text:"1"}}},{tag:"div","class":this.isSuccesHeader()?"text-blue-step":"text-blue-step text-grey",text:"Fill in two fields"}]}}]},firstSearch:function(){return[{"class":"broadcast-view-search",html:[{"class":"broadcast-view-icon",html:[{tag:"span","class":"fonticon fonticon-sync globalView",html:{tag:"p","class":"start-broadcast",text:"Start a synchro"}}]},{"class":"broadcast-view-search-comment",html:{tag:"span","class":"text-comment-search",text:"Please fill in the user and platform fields to start the broadcast."}}]}]},firstsearchZone:function(){return[{"class":"broadcast-search-zone",html:[{"class":"broadcast-search",html:[{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"Platform name ...",events:{keyup:function(i){var h=i.target.getParent().getElements("input.search-user-platform")[0],j=i.target.getParent().getElements("input.search-user-platform")[1],g=i.target.getParent().getParent().getChildren()[1].getChildren()[0];this.checkCharacters(i,h,j,g);if(i.keyCode===13){this.tooltipEmptyField(h,j,g);this.runBroadcast()}}.bind(this),mouseover:function(g){if(this.tooltipInformationPlatform0!==null){this.tooltipInformationPlatform0.destroy();this.tooltipInformationPlatform0=null}if(g.target.hasClassName("input-not-validate")){this.tooltipInformationPlatform0=new c({position:"bottom",target:g.target,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-monitor input"},{tag:"div","class":"search-and",text:"AND"},{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"User name ...",events:{keyup:function(i){var h=i.target.getParent().getElements("input.search-user-platform")[0],j=i.target.getParent().getElements("input.search-user-platform")[1],g=i.target.getParent().getParent().getChildren()[1].getChildren()[0];this.checkCharacters(i,h,j,g);if(i.keyCode===13){this.tooltipEmptyField(h,j,g);this.runBroadcast()}}.bind(this),mouseover:function(g){if(this.tooltipInformationUser0!==null){this.tooltipInformationUser0.destroy();this.tooltipInformationUser0=null}if(g.target.hasClassName("input-not-validate")){this.tooltipInformationUser0=new c({position:"bottom",target:g.target,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-user inputBis"}]},{"class":"run-broadcast-bis",html:{tag:"div","class":"square-run-broadcast-grey-second-time",html:{tag:"p","class":"text-run",text:"Synchro",events:{click:this.runBroadcast.bind(this)}}}}]}]},userIsEmpty:function(g){return(g==="")},platformIsEmpty:function(g){return(g==="")},checkCharacters:function(m,l,j,q){var o=/[/!|^|$|(|)|[|\]|}|{|?|+|*|/|\\|"|ยง]/,n=j.value.trim(),g=l.value.trim(),h=m.target,k=m.target.value.trim(),i=q.getElement("p.text-run"),p=m.key;if(this.tooltipInformationPlatform!==null){this.tooltipInformationPlatform.destroy();this.tooltipInformationPlatform=null}if(this.tooltipInformationUser!==null){this.tooltipInformationUser.destroy();this.tooltipInformationUser=null}if(this.tooltipRunBroadcast!==null){this.tooltipRunBroadcast.destroy();this.tooltipRunBroadcast=null}if(m.key!=="Enter"){q.removeClassName("red");i.removeClassName("red");if(h===l){if(g===""){l.placeholder="Platform name ...";l.removeClassName("search-user-platform-selected");l.removeClassName("second-time");h.removeClassName("input-not-validate");q.removeClassName("blue");i.removeClassName("white")}else{h.addClassName("search-user-platform-selected");if((o.test(k))||(o.test(p))){h.addClassName("input-not-validate");this.tooltipInformationPlatform=new c({position:"bottom",target:h,body:'The platform name can not contain specials characters :  !, ยง, ^, $,(, ), [, ], }, {, ?, +, *, /, ", \\'}).show();q.removeClassName("blue");i.removeClassName("white")}else{if((!o.test(n))&&(n!=="")){q.addClassName("blue");i.addClassName("white")}h.addClassName("second-time");h.removeClassName("input-not-validate")}}}else{if(n===""){j.placeholder="User name ...";j.removeClassName("search-user-platform-selected");j.removeClassName("second-time");h.removeClassName("input-not-validate");q.removeClassName("blue");i.removeClassName("white")}else{h.addClassName("search-user-platform-selected");if((o.test(k))||(o.test(p))){h.addClassName("input-not-validate");this.tooltipInformationUser=new c({position:"bottom",target:h,body:'The user name can not contain specials characters :  !, ยง, ^, $,(, ), [, ], }, {, ?, +, *, /, ", \\'}).show();h.addClassName("second-time");q.removeClassName("blue");i.removeClassName("white")}else{if((!o.test(g))&&(g!=="")){q.addClassName("blue");i.addClassName("white")}h.addClassName("second-time");h.removeClassName("input-not-validate")}}}}},tooltipEmptyField:function(h,j,g){var i=g.getElement("p.text-run");if(this.tooltipRunBroadcast!==null){this.tooltipRunBroadcast.destroy();this.tooltipRunBroadcast=null}if((h.value==="")&&(j.value==="")){this.tooltipRunBroadcast=new c({position:"bottom",target:g,body:"You should define platform AND user."}).show()}else{if((h.value==="")||(j.value==="")){g.removeClassName("blue");g.addClassName("red");i.addClassName("red");this.tooltipRunBroadcast=new c({position:"bottom",target:g,body:"You must define two fields"}).show()}}},runAgainBroadcast:function(g){var h=this;if(g.className==="square-run-broadcast-grey-second-time blue"){h.dispatchEvent("StartAgainBroadcast")}},runBroadcast:function(){var g=this;if(this.getContent().getElement("div.square-run-broadcast-grey-second-time.blue")!==null){g.dispatchEvent("StartBroadcast")}},runAgainBroadcastBis:function(h){var g=this;if(h.target.getParent().hasClassName("square-run-broadcast-grey-second-time blue")){g.dispatchEvent("StartAgainBroadcast")}},searchAgainAfterClick:function(h){var g=this;if(h.target.hasClassName("square-run-broadcast-grey-second-time blue")){g.dispatchEvent("StartSearchTicket")}},searchAgainAfterEnter:function(g){var h=this;if(g.hasClassName("searching")){h.dispatchEvent("SearchAgainTicket")}},_searchZone:function(g,h){return[{"class":"broadcast-search-zone",html:[{"class":"broadcast-search",html:[{tag:"input",type:"text","class":this.platformIsEmpty(g)?"form-control search-user-platform":"form-control search-user-platform second-time",placeholder:"Platform name ...",value:g,events:{keyup:function(k){var j=k.target.getParent().getElements("input.search-user-platform")[0],l=k.target.getParent().getElements("input.search-user-platform")[1],i=k.target.getParent().getParent().getChildren()[1].getChildren()[0];this.checkCharacters(k,j,l,i);if(k.keyCode===13){this.tooltipEmptyField(j,l,i);this.runAgainBroadcast(i)}}.bind(this),mouseover:function(i){if(this.tooltipInformationPlatform0!==null){this.tooltipInformationPlatform0.destroy();this.tooltipInformationPlatform0=null}if(i.target.hasClassName("input-not-validate")){this.tooltipInformationPlatform0=new c({position:"bottom",target:i.target,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-monitor inputBis"},{tag:"div","class":"search-and-bis",text:"AND"},{tag:"input",type:"text","class":this.userIsEmpty(h)?"form-control search-user-platform":"form-control search-user-platform second-time",placeholder:"User name ...",value:h,events:{keyup:function(k){var j=k.target.getParent().getElements("input.search-user-platform")[0],l=k.target.getParent().getElements("input.search-user-platform")[1],i=k.target.getParent().getParent().getChildren()[1].getChildren()[0];this.checkCharacters(k,j,l,i);if(k.keyCode===13){this.tooltipEmptyField(j,l,i);this.runAgainBroadcast(i)}}.bind(this),mouseover:function(i){if(this.tooltipInformationUser0!==null){this.tooltipInformationUser0.destroy();this.tooltipInformationUser0=null}if(i.target.hasClassName("input-not-validate")){this.tooltipInformationUser0=new c({position:"bottom",target:i.target,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-user inputBis"}]},{"class":"run-broadcast-bis",html:{tag:"div","class":"square-run-broadcast-grey-second-time",html:{tag:"p","class":"text-run",text:"Synchro",events:{click:this.runAgainBroadcastBis.bind(this)}}}}]}]},isSuccess:function(g){return(g.code===0)},synchroRAS:function(g){return(g.status==="ok")},allRAS:function(g){if(this.isSuccess(g)===true&&this.synchroRAS(g)===true){return true}else{return false}},_headerZone1:function(g){var h=f.createElement("div",{"class":"platform-name",text:g.platform+" ("+g.platformDisplayName+")"});return[{"class":"broadcast-body-zone-header1",html:[this.isSuccess(this.model)?{"class":"broadcast-body-zone-header1-small",html:[{tag:"div","class":"div-fonticon-monitor-user",html:{tag:"span","class":"fonticon fonticon-monitor"}},h,new c({position:"left",target:h,body:g.platform+" ("+g.platformDisplayName+")"})]}:{}]}]},_headerZone2:function(h){var g=f.createElement("div",{"class":"user-name",text:this._EmailKeyAbsent()?h.user:h.email});return[{"class":"broadcast-body-zone-header2",html:[this.isSuccess(this.model)?{"class":"broadcast-body-zone-header2-small",html:[{tag:"div","class":"div-fonticon-monitor-user",html:{tag:"span","class":"fonticon fonticon-user"}},g,new c({position:"left",target:g,body:this._EmailKeyAbsent()?h.user:h.email})]}:{}]}]},refreshSynchro:function(j,i,k){var h=this,g;this.removeTooltip();j.addClassName("rotation");g=h.dispatchEvent("StartAgainBroadcast");if(this.refreshDonePopover!==null){this.refreshDonePopover.destroy();this.refreshDonePopover=null;clearTimeout(this.timeOutPopoverDone)}if(g!==undefined){this.refreshDonePopover=new b({position:"bottom",className:"popover bottom",target:j,body:"Refresh in progress."}).show()}else{this.refreshDonePopover=new b({position:"bottom",className:"popover bottom",target:j,body:"Error during refresh step."}).show()}this.timeOutPopoverDone=setTimeout(function(){h.refreshDonePopover.destroy();h.refreshDonePopover=null},1000)},boxBroadcast:function(g){return{"class":"broadcast-header",html:this.isSuccess(this.model)?{tag:"span","class":this.allRAS(this.model)?"circle-background circle-green":"circle-background circle-red",html:{tag:"span","class":this.allRAS(this.model)?"fonticon fonticon-check":"fonticon fonticon-wrong"}}:{tag:"span","class":"circle-background circle-grey",html:{tag:"span","class":"fonticon fonticon-wrong grey"}}}},isPending:function(g){return(g.userPending===true)},timingZone:function(g){return[this.isPending(this.model)?{"class":"user-pending-zone",html:this._EmailKeyAbsent()?{tag:"span","class":"user-pending",text:"This user "+g.user+" is pending. The date of last synchronization : "+g.date}:{tag:"span","class":"user-pending",text:"This user with the email address : "+g.email+" is pending. The date of last synchronization : "+g.date}}:{"class":"timing-zone",html:{tag:"span","class":this.synchroRAS(this.model)?"text-timing":"text-timing red",text:g.date}},{"class":this.allRAS(this.model)?"synchro-user-zone color-green":"synchro-user-zone color-red",html:{tag:"p","class":"status-synchro",text:"Synchronization User : "+g.status.toUpperCase()}}]},caseError:function(h){var g=f.createElement("div",{"class":"message-error-zone",text:h.message});return[{"class":"timing-zone error",html:[g,new c({position:"right",target:g,body:h.message})]},{"class":"advise-zone",html:[{tag:"span","class":"fonticon fonticon-info advice"},{tag:"span","class":"advice-text",text:this.recuperationErrorCode()}]}]},recuperationErrorCode:function(){var h=this.model.code,g=null;if(h===2){g="Please enter another platform name."}else{if(h===4){g="Please enter another user name."}else{g="Please modify your input."}}return g},colorBorder:function(g){if(this.model.code===0){if(this.model.status==="ok"){return"broadcast-body border-square-color-green"}else{return"broadcast-body border-square-color-red"}}else{return"broadcast-body border-square-color-grey"}},recuperationInformationsBroadcast:function(g){var h=f.createElement("span",{"class":"fonticon fonticon-refresh",events:{mouseover:function(i){new c({position:"right",target:h,body:"Refresh Synchronization"}).show()}}});return{"class":"broadcast-box",html:[this.boxBroadcast(this.model),{"class":this.colorBorder(this.model),html:[{tag:"div","class":"refresh-zone",events:{click:function(j){var i=j.target;if(j.target.hasClassName("tooltip-body")){i=j.target.getParents()[1].getChildren()[0]}this.refreshSynchro(i,g.platform,g.user)}.bind(this)},html:[h]},this.isSuccess(this.model)?this.timingZone(this.model):this.caseError(this.model)]}]}},_failCallWs:function(g,h){return[{"class":"broadcast-view-first-search",html:[this.removeTooltip(),this._searchZone(g,h),{"class":"ticket-body-zone",html:[{"class":"ticket-globalFail-header",html:{"class":"ticket-globalFail-header-small",html:[{"class":"big-message",tag:"div",text:"Oops, "},{"class":"small-message",tag:"div",text:"We are sorry ... "}]}},{"class":"ticket-globalFail-body",html:{"class":"ticket-globalFail-body-small",html:[{tag:"span","class":"fonticon fonticon-comment"},{"class":"ticket-globalFail-view-icons",html:{tag:"span","class":"fonticon fonticon-role"}}]}},{"class":"ticket-globalFail-footer",html:{"class":"message-global-error",text:"An unexpected error has occured ... Server is unavailable. Please try later."}}]}]}]},removeTooltip:function(){var g=widget.body.getParents()[2].getElements("div.tooltip.tooltip-root.in");for(var h=0;h<=g.length;h++){if(g[h]!==undefined){g[h].remove()}}},_EmailKeyAbsent:function(){return(this.model.email===undefined)},_createTemplateBis:function(g,h){return[{"class":"broadcast-view-first-search",html:[this.removeTooltip(),this.headerZone(),this._searchZone(g,h),{"class":"broadcast-body-zone",html:[this._headerZone1(this.model),this._headerZone2(this.model),{"class":"broadcast-body-zone-body",html:[this.recuperationInformationsBroadcast(this.model)]}]}]}]},_failView:function(g,h){return[{"class":"broadcast-view-first-search",html:[this.removeTooltip(),this.headerZone(),this._searchZone(g,h),{"class":"broadcast-body-zone",html:[{"class":"broadcast-body-zone-header1",html:{tag:"div","class":"error-detected",text:"An error has occured "}},{"class":"broadcast-body-zone-body",html:[this.recuperationInformationsBroadcast(this.model)]}]}]}]}})});define("DS/i3DXCompassSupport/Model/i3DXCompassModel",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/RequestOptions"],function(d,c,a){var b=d.clone(a);b.options.backendPath="/resources/AppsMngtSupport/";return c.extend(b)});define("DS/i3DXCompassSupport/Collection/i3DXCompassCollectionProbe",["UWA/Core","DS/i3DXCompassCore/Collection/i3DXCompassCollection","DS/i3DXCompassCore/RequestOptions"],function(d,b,a){var c=d.clone(a);c.getOptionsUrl=function(g){var f=localStorage.getItem("addressCluster"),e="/enovia";if(!f){var h=g.substring(0,g.indexOf(e));localStorage.setItem("addressCluster",h);return g}return f+e};return b.extend(c)});define("DS/i3DXCompassSupport/View/PingServiceView",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Popover"],function(d,c,b,a){return c.extend({tagName:"div",className:"ping-view",failurePopover:null,refreshDonePopover:null,timeOutPopoverFail:null,timeOutPopoverDone:null,render:function(){this.container.setContent(this._createTemplate());return this},refreshAction:function(g){var f=this.getContent().getElement("span.fonticon.fonticon-2x.fonticon-refresh");f.addClassName("rotation");this.model.fetch({onComplete:function(){this.render();var e=this;if(this.refreshDonePopover!==null){this.refreshDonePopover.destroy();this.refreshDonePopover=null;clearTimeout(this.timeOutPopoverDone)}this.refreshDonePopover=new a({position:"left",className:"popoverGreen",target:this.getContent().getElement(".refresh-zone"),body:"Refresh done."}).show();this.timeOutPopoverDone=setTimeout(function(){e.refreshDonePopover.destroy();e.refreshDonePopover=null},2000)}.bind(this),onFailure:function(){var e=this;f.removeClassName("rotation");if(this.failurePopover!==null){this.failurePopover.destroy();this.failurePopover=null;clearTimeout(this.timeOutPopoverFail)}this.failurePopover=new a({position:"left",className:"popoverRed",target:this.getContent().getElement(".refresh-zone"),body:"Error during refresh."}).show();this.timeOutPopoverFail=setTimeout(function(){e.failurePopover.destroy();e.failurePopover=null},5000);console.log("OnFailure case")}.bind(this)})},_createTemplate:function(){var f=d.createElement("span",{"class":this.model.isIconeWarning()?"fonticon fonticon-1x fonticon-attention "+this.model.isGoodTiming():null}),e=d.createElement("p",{"class":this.model.isSuccess()?"background-color-green":"background-color-red",text:this.model.get("name")});return[{"class":"ping-header",html:[{tag:"span","class":this.model.isSuccess()?"circle-background green":"circle-background red",html:{tag:"span","class":this.model.isSuccess()?"fonticon fonticon-5x fonticon-check":"fonticon fonticon-5x fonticon-wrong"}}]},{"class":"ping-body",html:[{"class":"refresh-zone",html:{tag:"span","class":"fonticon fonticon-2x fonticon-refresh",events:{click:this.refreshAction.bind(this)}}},{"class":"body-zone",html:[this.model.isSuccess()?[f,new b({position:"left",target:f,body:this.model.helpWarningTiming()}),{tag:"span","class":"timing "+this.model.isGoodTiming(),text:this.model.get("time")+"ms"}]:{tag:"div","class":"message",text:this.model.get("message")}]},{"class":"ping-footer",html:[e,new b({position:"right",target:e,body:this.model.get("name")})]}]}]}})});define("DS/i3DXCompassSupport/Collection/UsersInconsCollection",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollectionProbe"],function(b,a){return a.extend({url:"probe/usersInconsistencies?",parse:function(c){c=JSON.parse(c);return c}})});define("DS/i3DXCompassSupport/Collection/SynchroUserCollection",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollection"],function(b,a){return a.extend({url:"status/v1/synchroUsers?",parse:function(c){return c}})});define("DS/i3DXCompassSupport/Model/ServiceModel",["UWA/Core","DS/i3DXCompassSupport/Model/i3DXCompassModel"],function(b,a){return a.extend({isSuccess:function(){return(this.get("code")===0)},timing:function(){var c=this.get("time");if((this.get("name")==="3DCompass Database")||(this.get("name")==="3DCompass Licensing Service")){if(c<50){return 0}else{if(c>100){return 2}else{return 1}}}else{if(c<150){return 0}else{if(c>250){return 2}else{return 1}}}},isGoodTiming:function(){var c=["color-green","color-orange","color-red"];return c[this.timing()]},isIconeWarning:function(){return(this.timing()!==0)},helpWarningTiming:function(){var c=["","Ping time : Medium","Ping time : High"];return c[this.timing()]}})});define("DS/i3DXCompassSupport/Collection/BroadcastCollection",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollection"],function(b,a){return a.extend({url:"status/v1/broadcast?",parse:function(c){return c}})});define("DS/i3DXCompassSupport/Collection/TicketCollection",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollection"],function(b,a){return a.extend({url:"status/v1/serviceTicket?",parse:function(c){return c}})});define("DS/i3DXCompassSupport/View/PingServicesView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner","DS/i3DXCompassSupport/Model/ServiceModel","DS/i3DXCompassSupport/View/PingServiceView"],function(e,d,b,a,c){return d.extend({tagName:"div",className:"i3DXCompassSupport-ping-service ping-view-wrapper",render:function(){this.container.setContent(this._createTemplate());return this},_badAuthentification:function(){return this.container.setContent([{"class":"bad-authentificate",html:[{"class":"bad-authentificate-header",html:{tag:"div","class":"text-header",text:"Access denied"}},{"class":"bad-authentificate-body",html:{tag:"span","class":"fonticon fonticon-user-key authentification"}},{"class":"bad-authentificate-footer",html:{tag:"div","class":"text-footer",text:"You donโt have appropriate access rights. Therefore, you are not authorized to use this tool."}}]}])},_failView:function(){return this.container.setContent([{"class":"ping-ws-failed",html:[{"class":"ping-ws-failed-header",html:{tag:"span","class":"fonticon fonticon-alert"}},{"class":"ping-ws-failed-body",html:[{tag:"p","class":"complete-fail",text:"We encounter an unexpected error."},{tag:"p","class":"complete-fail",text:"We apologize for the inconvenience. Please retry later."}]}]}])},_title:function(){return{"class":"i3DXCompassSupport-ping-service-title",html:[{tag:"span","class":"fonticon fonticon-compass-services"},{tag:"span","class":"state-services",text:"State of services"}]}},_createTemplate:function(){return[this._title(),this.collection.map(function(f){return new c({model:f}).render()})]}})});define("DS/i3DXCompassSupport/Collection/ServiceCollection",["UWA/Core","DS/i3DXCompassSupport/Model/ServiceModel","DS/i3DXCompassSupport/Collection/i3DXCompassCollection"],function(c,b,a){return a.extend({url:"monitoring/v1/pingServices",model:b,parse:function(d){return d.data}})});define("DS/i3DXCompassSupport/Collection/FetchBOUsersInconsistencies",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollectionProbe"],function(b,a){return a.extend({url:"probe/fetchBOUI",parse:function(c){if(c.message!=="Refresh in progress"){c=JSON.parse(c.message)}return c}})});define("DS/i3DXCompassSupport/View/SynchroUserKo",["UWA/Core","DS/UIKIT/Mask","UWA/Class/View","DS/UIKIT/Tooltip","DS/UIKIT/Input/Toggle","DS/i3DXCompassSupport/Collection/SynchroUserCollection"],function(h,f,e,c,g,b){var d=window.location.origin,a=d.replace("ifwe","apps");return e.extend({tagName:"div",className:"synchro-user-view",tooltipFieldEmpty:null,tooltipInformationUser:null,tooltipInformationPlatform:null,tooltipInformationUser0:null,tooltipInformationPlatform0:null,adressCluster:null,render:function(){this.container.setContent(this._createTemplate());return this},_createTemplate:function(){return[{"class":"synchro-user-view-first-search",html:[this.removeTooltip(),this.headerZone(),this.firstsearchZone(),{"class":"synchro-user-body-view",html:this.firstSearch()}]}]},firstSearch:function(){return[{"class":"synchro-user-view-search",html:[{"class":"synchro-user-view-search-icon",html:[{tag:"span","class":"fonticon fonticon-search globalView",html:{tag:"p","class":"start-search",text:"Start a search"}}]},{"class":"synchro-user-view-search-comment",html:{tag:"span","class":"text-comment-search",text:"Please fill in user and/or platform field to start the user synchronization."}}]}]},isFirstSearch:function(){return(this.model===undefined)},headerZone2:function(k){var j=h.createElement("div",{"class":"text-blue-step1",text:"Fill in at least one field"}),i=h.createElement("div",{"class":"text-blue-step2",text:this.userIsEmpty(k)?"Select the desired user":"Select the desired platform"});return[{"class":"synchro-user-view-header",html:[{"class":"header-step1",html:[{"class":"header-step1-circle",html:[{tag:"div","class":"circle-step1 background-blue",html:this.isFirstSearch()?{tag:"div","class":"number-step1",text:"1"}:{tag:"span","class":"fonticon fonticon-check white"}}]},j,new c({position:"bottom",target:j,body:"Fill in at least one field"})]},{"class":"header-line",html:{tag:"div","class":"line color-blue"}},{"class":"header-step2",html:[{"class":"header-step2-circle",html:[{tag:"div","class":"circle-step2 background-blue",html:this.isFirstSearch()?{tag:"div","class":"number-step2",text:"2"}:{tag:"span","class":"fonticon fonticon-check white"}}]},i,new c({position:"bottom",target:i,body:i.getText()})]}]}]},headerZone:function(){var j=h.createElement("div",{"class":"text-blue-step1",text:"Fill in at least one field"}),i=h.createElement("div",{"class":"text-blue-step2",text:"Select the desired user/platform"});return[{"class":"synchro-user-view-header",html:[{"class":"header-step1",html:[{"class":"header-step1-circle",html:[{tag:"div","class":"circle-step1 background-blue",html:this.isFirstSearch()?{tag:"div","class":"number-step1",text:"1"}:{tag:"span","class":"fonticon fonticon-check white"}}]},j,new c({position:"bottom",target:j,body:"Fill in at least one field"})]},{"class":"header-line",html:{tag:"div","class":"line color-blue"}},{"class":"header-step2",html:[{"class":"header-step2-circle",html:[{tag:"div","class":"circle-step2 background-blue",html:this.isFirstSearch()?{tag:"div","class":"number-step2",text:"2"}:{tag:"span","class":"fonticon fonticon-check white"}}]},i,new c({position:"bottom",target:i,body:i.getText()})]}]}]},searchZone:function(l,i){var j=h.createElement("span",{"class":"fonticon fonticon-search",events:{click:this.search.bind(this)}});var k=this;return[{"class":"search-body-zone-global",html:{"class":"synchro-user-search-zone",html:[{html:[this.userIsEmpty(l)?{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"User name ...",events:{keyup:function(o){var p=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[0],n=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[1],m=o.target.getParent("div.synchro-user-search-zone").getElement("span.fonticon.fonticon-search");k.checkCharacters(o,p,n,m);if(o.keyCode===13){this.searchAgainAfterError(m)}}.bind(this),mouseover:function(m){if(this.tooltipInformationUser0!==null){this.tooltipInformationUser0.destroy();this.tooltipInformationUser0=null}if(m.target.hasClassName("input-not-validate")){this.tooltipInformationUser0=new c({position:"bottom",target:m.target,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}}:{tag:"input",type:"text","class":"form-control search-user-platform search-user-platform-selected",value:l,events:{keyup:function(o){var p=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[0],n=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[1],m=o.target.getParent("div.synchro-user-search-zone").getElement("span.fonticon.fonticon-search");k.checkCharacters(o,p,n,m);if(o.keyCode===13){this.searchAgainAfterError(m)}}.bind(this),mouseover:function(m){if(this.tooltipInformationUser0!==null){this.tooltipInformationUser0.destroy();this.tooltipInformationUser0=null}if(m.target.hasClassName("input-not-validate")){this.tooltipInformationUser0=new c({position:"bottom",target:m.target,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}}]},{tag:"span","class":"fonticon fonticon-user inputBis"},{tag:"div","class":"search-or",text:"OR"},{html:[this.platformIsEmpty(i)?{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"Platform name ...",events:{keyup:function(o){var p=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[0],n=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[1],m=o.target.getParent("div.synchro-user-search-zone").getElement("span.fonticon.fonticon-search");this.checkCharacters(o,p,n,m);if(o.keyCode===13){this.searchAgainAfterError(m)}}.bind(this),mouseover:function(m){if(this.tooltipInformationPlatform0!==null){this.tooltipInformationPlatform0.destroy();this.tooltipInformationPlatform0=null}if(m.target.hasClassName("input-not-validate")){this.tooltipInformationPlatform0=new c({position:"bottom",target:m.target,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}}:{tag:"input",type:"text","class":"form-control search-user-platform search-user-platform-selected",value:i,events:{keyup:function(o){var p=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[0],n=o.target.getParent("div.synchro-user-search-zone").getElements("input.search-user-platform")[1],m=o.target.getParent("div.synchro-user-search-zone").getElement("span.fonticon.fonticon-search");this.checkCharacters(o,p,n,m);if(o.keyCode===13){this.searchAgainAfterError(m)}}.bind(this),mouseover:function(m){if(this.tooltipInformationPlatform0!==null){this.tooltipInformationPlatform0.destroy();this.tooltipInformationPlatform0=null}if(m.target.hasClassName("input-not-validate")){this.tooltipInformationPlatform0=new c({position:"bottom",target:m.target,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}}]},{tag:"span","class":"fonticon fonticon-monitor inputBis"},j]}}]},firstsearchZone:function(){var i=h.createElement("span",{"class":"fonticon fonticon-search",events:{click:this.searchAgainAfterClick.bind(this)}});return[{"class":"search-body-zone-global",html:{"class":"synchro-user-search-zone",html:[{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"User name ...",events:{keyup:function(l){var m=this.container.getElements("input.search-user-platform")[0],k=this.container.getElements("input.search-user-platform")[1],j=this.getContent().getElement("span.fonticon.fonticon-search");this.checkCharacters(l,m,k,j);if(l.keyCode===13){this.searchAgain()}}.bind(this),mouseover:function(j){if(this.tooltipInformationUser0!==null){this.tooltipInformationUser0.destroy();this.tooltipInformationUser0=null}if(j.target.hasClassName("input-not-validate")){this.tooltipInformationUser0=new c({position:"bottom",target:j.target,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-user inputBis"},{tag:"div","class":"search-or",text:"OR"},{tag:"input",type:"text","class":"form-control search-user-platform",placeholder:"Platform name ...",events:{keyup:function(l){var m=this.container.getElements("input.search-user-platform")[0],k=this.container.getElements("input.search-user-platform")[1],j=this.getContent().getElement("span.fonticon.fonticon-search");this.checkCharacters(l,m,k,j);if(l.keyCode===13){this.searchAgain()}}.bind(this),mouseover:function(j){if(this.tooltipInformationPlatform0!==null){this.tooltipInformationPlatform0.destroy();this.tooltipInformationPlatform0=null}if(j.target.hasClassName("input-not-validate")){this.tooltipInformationPlatform0=new c({position:"bottom",target:j.target,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show()}}.bind(this)}},{tag:"span","class":"fonticon fonticon-monitor inputBis"},i]}}]},userIsEmpty:function(i){return(i==="")},platformIsEmpty:function(i){return(i==="")},allInformationEnter:function(j,i){if((j!=="")&&(i!=="")){return true}else{return false}},removeTooltip:function(){var j=widget.body.getParents()[2].getElements("div.tooltip.tooltip-root.in");for(var k=0;k<=j.length;k++){if(j[k]!==undefined){j[k].remove()}}},_failGlobalView:function(j,i){return[this.removeTooltip(),{"class":"synchro-user-view2",html:[this.searchZone(j,i),{"class":"synchro-user-body-view-global-fail-view",html:[{"class":"synchro-user-body-view-text",html:[{tag:"span","class":"text-big-sorry",text:"Oops,"},{tag:"span","class":"text-little-sorry",text:" We are sorry"}]},{"class":"icon-global-fail-view",html:[{tag:"span","class":"fonticon fonticon-comment"},{"class":"synchro-user-body-view-icons",html:{tag:"span","class":"fonticon fonticon-role"}}]},{"class":"message-global-error",text:"An unexpected error has occured ... Server is unavailable. Please try later."}]}]}]},recuperationErrorCode:function(){var j=this.model.code,i=null;if(j===5){i="Please enter another user name"}else{if(j===2){i="Please enter another platform name"}else{i="Please change user or platform name"}}return i},separatorLineCondition:function(j,l,i){var k;if(l===""){k=this.model._attributes.data[0].users.length}else{k=this.model._attributes.data[0].platforms.length}if(k>=2){return true}else{return false}},recuperationServiceKo:function(k,n,i){var o,m=this,l=h.createElement("span",{"class":"fonticon fonticon-monitor"}),j=h.createElement("span",{"class":"fonticon fonticon-user"});o={"class":"synchro-user-body-view-right-part",id:k.id,html:[{"class":"user-zone",html:[this.allInformationEnter(n,i)?[l,new c({position:"bottom",target:l,body:i}),{tag:"div","class":"text-light-blue",text:i+" ("+k.platformDisplayName+")"}]:[this.platformIsEmpty(i)?[l,new c({position:"bottom",target:l,body:k.id}),{tag:"div","class":"text-light-blue",text:k.id+" ("+k.platformDisplayName+")"}]:[j,new c({position:"bottom",target:j,body:k.id}),{tag:"div","class":"text-light-blue",text:k.id}]]]},{"class":"services-ko-zone",html:k.services.map(function(q){var p=h.createElement("div",{"class":"message-error-zone",text:q.message});return[{"class":"service-ko-box",html:[{"class":"service-ko-header",html:[{tag:"span","class":(q.syncBlocking==="2")?"circle-background circle-red":"circle-background circle-orange",html:{tag:"span","class":(q.syncBlocking==="2")?"fonticon fonticon-lock":"fonticon fonticon-lock-open",events:{mouseover:function(r){if(r.target.hasClassName("fonticon-lock")){new c({position:"left",target:r.target,body:"This service blocks the general synchronization of the user's information near the different services of the 3DExperience platform."}).show()}else{new c({position:"left",target:r.target,body:"This service does not block the general synchronization of the user's information on the 3DExperience platform."}).show()}}.bind(this)}}}]},{"class":(q.syncBlocking==="2")?"service-ko-body border-square-color-red":"service-ko-body border-square-color-orange",html:[{"class":"timing-zone",html:[{tag:"span","class":"fonticon fonticon-3ds-when"},{tag:"span","class":"text-timing",text:q.timing},{tag:"span","class":"text-timing ms",text:" ms"}]},p,new c({position:"right",target:p,body:q.message}),{"class":(q.syncBlocking==="2")?"name-service-zone synchrouser-background-color-red":"name-service-zone synchrouser-background-color-orange",html:[{tag:"img","class":"icon",src:m.iconsWithService(q)},{tag:"span","class":"name-of-service-ko",text:q.id}]}]}]}]})},{"class":this.separatorLineCondition(k,n,i)?"separator-line":""}]};return o},isSuccess:function(){return(this.model.code===0)},iconsWithService:function(j){var i=j.id,l,k;switch(i){case"RTC":l="3DExpPlatform_Default.png";break;case"TAGGER":l="3DExpPlatform_Default.png";break;case"COMMENT":l="3DExpPlatform_Default.png";break;case"DRIVE":l="X3DDRIV_AP_AppIcon.png";break;case"NETVIBES":l="iconNETVIBES.png";break;case"SWYM":l="X3DMCTY_AP_AppIcon.png";break;case"SPACE":l="X3DCSMA_AP_AppIcon.png";break;default:l="3DExpPlatform_Default.png"}k=a+"/enovia/widget/images/MyApps/"+l;return k},checkCharacters:function(n,k,m,q){var p=/[/!|^|$|(|)|[|\]|}|{|?|+|*|/|\\|"|ยง]/,o=k.value.trim(),i=m.value.trim(),j=n.target,l=n.target.value.trim(),r=n.key;if(this.tooltipInformationUser!==null){this.tooltipInformationUser.destroy();this.tooltipInformationUser=null}if(this.tooltipInformationPlatform!==null){this.tooltipInformationPlatform.destroy();this.tooltipInformationPlatform=null}if(n.key!=="Enter"){if(j===k){if(o===""){k.placeholder="User name ...";k.removeClassName("search-user-platform-selected");j.removeClassName("input-not-validate");if((i!=="")&&(!p.test(i))){q.addClassName("fonticon-search-global-ok");q.addClassName("dark-grey")}}else{j.addClassName("search-user-platform-selected");if((p.test(l))||(p.test(r))){j.addClassName("input-not-validate");this.tooltipInformationUser=new c({position:"bottom",target:j,body:'The user name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show();q.removeClassName("fonticon-search-global-ok");q.removeClassName("dark-grey")}else{if(!p.test(i)){q.addClassName("fonticon-search-global-ok");q.addClassName("dark-grey")}j.removeClassName("input-not-validate")}}}else{if(i===""){m.placeholder="Platform name ...";m.removeClassName("search-user-platform-selected");j.removeClassName("input-not-validate");if((o!=="")&&(!p.test(o))){q.addClassName("fonticon-search-global-ok");q.addClassName("dark-grey")}}else{j.addClassName("search-user-platform-selected");if((p.test(l))||(p.test(r))){j.addClassName("input-not-validate");this.tooltipInformationPlatform=new c({position:"bottom",target:j,body:'The platform name can not contain specials characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, /, ", \\, ยง'}).show();q.removeClassName("fonticon-search-global-ok");q.removeClassName("dark-grey")}else{if(!p.test(o)){q.addClassName("fonticon-search-global-ok");q.addClassName("dark-grey")}j.addClassName("search-user-platform-selected");j.removeClassName("input-not-validate")}}}}if((o==="")&&(i==="")){q.removeClassName("fonticon-search-global-ok");q.removeClassName("dark-grey");if(this.tooltipFieldEmpty!==null){this.tooltipFieldEmpty.destroy();this.tooltipFieldEmpty=null}this.tooltipFieldEmpty=new c({position:"bottom",target:q,body:"You should define platform or user"}).show()}else{if(this.tooltipFieldEmpty!==null){this.tooltipFieldEmpty.destroy();this.tooltipFieldEmpty=null}}},headerZoneSuccessFail:function(l,i){var k=h.createElement("div",{"class":this.isSuccess()?"text-blue-step1 green":"text-blue-step1 text-greyBis",text:"Fill in at least one field"}),j=h.createElement("div",{"class":this.isSuccess()?"text-blue-step2 green":"text-blue-step2 text-greyBis",text:this.userIsEmpty(l)?"Select the desired user":"Select the desired platform"});return[{"class":"synchro-user-view-header",html:[{"class":"header-step1",html:[{"class":"header-step1-circle",html:[{tag:"div","class":this.isSuccess()?"circle-step1 background-green":"circle-step1 background-grey",html:{tag:"div","class":"number-step1",text:"1"}}]},k,new c({position:"bottom",target:k,body:"Fill in at least one field"})]},{"class":"header-line",html:{tag:"div","class":this.isSuccess()?"line color-green":"line color-grey"}},{"class":"header-step2",html:[{"class":"header-step2-circle",html:[{tag:"div","class":this.isSuccess()?"circle-step2 background-green":"circle-step2 background-grey",html:{tag:"div","class":"number-step2",text:"2"}}]},j,new c({position:"bottom",target:j,body:j.getText()})]}]}]},_failView:function(j,i){return[this.removeTooltip(),{"class":"synchro-user-view2",html:[this.headerZoneSuccessFail(j,i),this.searchZone(j,i),{"class":"synchro-user-body-view",html:[this.isSuccess()?{"class":"synchro-user-body-view-header",html:[this.userIsEmpty(j)?{tag:"span","class":"fonticon fonticon-monitor global1"}:{tag:"span","class":"fonticon fonticon-user global1"},{tag:"span","class":"text-user-name",text:this.userIsEmpty(j)?i:j}]}:{},{"class":"synchro-user-view-body-error-case",html:[this.isSuccess()?[{tag:"div","class":"no-problems-detected",text:"No problems detected"},{tag:"span","class":"circle-background-error-case-red background-color-green",html:{tag:"span","class":"fonticon fonticon-check successFonticon"}}]:[{tag:"div","class":"error-detected",text:"An error has occured "},{tag:"span","class":"circle-background-error-case-red",html:{tag:"span","class":"fonticon fonticon-wrong"}}],{html:this.isSuccess()?{tag:"p","class":"error-message-green",text:"All synchronizations are running properly."}:[{tag:"p","class":"error-message-red",text:this.model.message},{"class":"advice-zone",html:[{tag:"span","class":"fonticon fonticon-info advice"},{tag:"span","class":"advice-text",text:this.recuperationErrorCode()}]}]}]}]}]}]},searchAgain:function(){var i=this;if(this.getContent().getElement("span.fonticon.fonticon-search.fonticon-search-global-ok")!==null){i.dispatchEvent("StartSearch")}},searchAgainAfterError:function(i){var j=this;if(i.hasClassName("fonticon fonticon-search fonticon-search-global-ok")){j.dispatchEvent("SearchAgain")}},searchAgainAfterClick:function(j){var i=this;if(j.target.hasClassName("fonticon fonticon-search fonticon-search-global-ok")){i.dispatchEvent("StartSearch")}},keyJson:function(l,j){var k=this.model.get("data")[0].platforms,i=this.model.get("data")[0].users;if(this.userIsEmpty(l)){return i}else{return k}},zoomToggle:function(l){var j=l.target.getText(),i=l.target.getParent().lastChild.firstChild;if(i.checked===true){var k=document.getElementById(j);k.scrollIntoView()}},displayInfoService:function(p,l,n,i){var k,j=this,m;if(p.target.checked===true){k=j.recuperationServiceKo(l,n,i);m=document.getElementById(k.id);if(m===null){j.getElement("div.synchro-user-body-view-right-part-global").addContent(k)}}else{k=j.recuperationServiceKo(l,n,i);var o=document.getElementById(k.id);if(o!==null){o.remove()}}},render2:function(j,k,i){this.container.setContent(this._createTemplate2(k,i));return this},search:function(j){var i=this;if(j.target.hasClassName("fonticon fonticon-search fonticon-search-global-ok")){i.dispatchEvent("SearchAgain")}},_createTemplate2:function(k,i){var j=this;return[this.removeTooltip(),this.headerZone2(k),this.searchZone(k,i),{"class":"synchro-user-body-view",html:[{"class":"synchro-user-body-view-header",html:[{"class":"fonticonanduserplatform",html:[this.allInformationEnter(k,i)?{html:[{tag:"span","class":"fonticon fonticon-user global"},{tag:"span","class":"text-user-name",text:"Service(s) Ko for the user "+this.model.get("data")[0].users}]}:[this.platformIsEmpty(i)?[{tag:"span","class":"fonticon fonticon-user global"},{tag:"span","class":"text-user-name",text:"Service(s) Ko for the user "+this.model.get("data")[0].users}]:[{tag:"span","class":"fonticon fonticon-monitor global"},{tag:"span","class":"text-platform-name",text:"Service(s) Ko for the platform "+this.model.get("data")[0].platforms+" ("+this.model.get("data")[0].platformDisplayName+")"}]]]}]},{"class":"synchro-user-body-view-servicesko",html:[{"class":"synchro-user-body-view-servicesko-left checked",html:[{"class":"synchro-user-body-view-header2",html:[{"class":"selectable-all-platforms-users",html:[{tag:"div","class":"text-toggle-all-search",text:this.userIsEmpty(k)?"All users |  "+this.model._attributes.data[0].users.length:"All platforms |  "+this.model._attributes.data[0].platforms.length},{tag:"div","class":"toggle toggle-switch toggle-sm",html:[{tag:"input",type:"checkbox",id:"select-all-platformsorusers",value:"allplatformsorusers",checked:true,events:{click:function(q){var m=this.container.getElements("div.toggle.toggle-switch.toggle-switch-platform.toggle-sm").length,s=this.container.getElement("div.synchro-user-body-view-servicesko-left"),u=q.target.checked,o;s.toggleClassName("checked",u);if(u===true){for(o=0;o<m;o++){var l=this.container.getElements("div.toggle.toggle-switch.toggle-switch-platform.toggle-sm")[o].getChildren()[0];if(l.checked===false){l.checked=true}}}else{for(o=0;o<m;o++){l=this.container.getElements("div.toggle.toggle-switch.toggle-switch-platform.toggle-sm")[o].getChildren()[0];l.checked=false;var t=l.id,n=t.length,p=t.substring(14,n),r=document.getElementById(p);if(r!==null){r.remove()}}}}.bind(this),change:function(l){this.keyJson(k,i).map(function(m){j.displayInfoService(l,m,k,i)})}.bind(this)}},{tag:"label","class":"control-label","for":"select-all-platformsorusers"}]}]}]},{"class":"synchro-user-body-view-left-part",html:this.keyJson(k,i).map(function(l){return[{tag:"div",id:"container-scroll","class":"to scroll platform-or-user-selectable-unitary",html:[{tag:"div","class":"text-toggle-unitary-selectable",id:"text"+l.id,text:l.id,events:{click:function(m){j.zoomToggle(m)},mouseover:function(m){new c({position:"bottom",target:m.target,body:l.id}).show()}}},{tag:"div","class":"toggle toggle-switch toggle-switch-platform toggle-sm",html:[{tag:"input",type:"checkbox",id:"platformoruser"+l.id,value:"platform-or-user"+l.id,checked:true,events:{change:function(s){j.displayInfoService(s,l,k,i);var r=j.container.getElement("div.synchro-user-body-view-servicesko-left"),t=j.container.getElement("input#select-all-platformsorusers"),q=j.container.getElements("div.toggle.toggle-switch.toggle-switch-platform.toggle-sm").length,n=0,o;if(t.checked===false){var p=s.target.checked;r.toggleClassName("checked",p)}for(o=0;o<q;o++){var m=j.container.getElements("div.toggle.toggle-switch.toggle-switch-platform.toggle-sm")[o].getChildren()[0];if(m.checked===true){n=n+1}}if(n===0){r.removeClassName("checked")}}}},{tag:"label","class":"control-label","for":"platformoruser"+l.id}]}]}]})}]},{tag:"div","class":"synchro-user-body-view-right-part-global",html:[this.keyJson(k,i).map(function(l){return[j.recuperationServiceKo(l,k,i)]})]}]}]}]}})});define("DS/i3DXCompassSupport/Collection/DeleteBOUsersInconsistencies",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollectionProbe"],function(b,a){return a.extend({url:"probe/BoProbeUsersInconsistencies",parse:function(c){return c}})});define("DS/i3DXCompassSupport/Collection/ProbesCollection",["UWA/Core","DS/i3DXCompassSupport/Collection/i3DXCompassCollectionProbe"],function(b,a){return a.extend({url:"probe/synchKO",parse:function(c){var f=0,d={count:0,data:[]};if(c!==""){var e=c.split(";");e.forEach(function(i){var h={platform:"",users:[]},g=i.split(":")[0],k=i.split(":")[1],j=k.split(",");h.platform=g;j.forEach(function(l){var m={id:l};f=f+1;h.users.push(m)});d.data.push(h)})}d.count=f;return d}})});define("DS/i3DXCompassSupport/View/ProbesView",["UWA/Core","DS/WAFData/WAFData","DS/UIKIT/Mask","UWA/Class/View","DS/UIKIT/Tooltip","DS/3DXHighcharts/3DXHighcharts","DS/UIKIT/SuperModal","DS/PlatformManagement/Controls/PlatformNotify","DS/PlatformManagement/Utils","DS/i3DXCompassSupport/Collection/UsersInconsCollection","DS/i3DXCompassSupport/Collection/DeleteBOUsersInconsistencies","DS/i3DXCompassSupport/View/ProbesView"],function(f,k,e,a,j,c,b,l,i,h,d,g){return a.extend({tagName:"div",className:"probes-view",graphView:null,probeUsersValue:null,tooltipRefresh:null,render:function(m){var n=0;if(m){var o=this.collection.at(0).get("data");o.map(function(p){n=n+p.users.length});this.probeUsersValue=true}else{n=this.collection.at(0).get("count")}if(n>0){this.container.setContent(this._createTemplate(n));setTimeout(function(){this.graphView.reflow()}.bind(this),250)}else{this.container.setContent(this._viewNoResult(n))}return this},refreshUsersInconsistencies:function(){return[{"class":"refreshBOUI-zone",html:{tag:"span","class":"fonticon fonticon-sync",events:{mouseover:function(m){if(this.tooltipRefresh!==null){this.tooltipRefresh.destroy();this.tooltipRefresh=null}this.tooltipRefresh=new j({position:"bottom",target:m.target,body:"Calculate the result of users inconsistencies probe. Warning : this action can take several minutes."}).show()}.bind(this),click:this._showRefreshConfirmation.bind(this)}}}]},_showRefreshConfirmation:function(){var n=new b({closable:false}),o="Are you sure you want to refresh the users Inconsistencies probe ? This operation can take many minutes.",m=function(){var s=function(v,t){var u=new h([],{type:"text",headers:{Accept:"text/plain"}});u.fetch({data:{json:true},onComplete:function(z,x){var w=true,y;this.collection.set(JSON.parse(x));y=this.render(w);e.unmask(this.container);widget.body.getElementsByClassName("i3DXCompassSupport-probes-usersInconsistencies")[0].setContent(y)}.bind(this),onFailure:function(x,w){e.unmask(this.container.getChildren()[1]);l.alert("Impossible to refresh the users inconsistencies probe.")}.bind(this)})}.bind(this),q=function(v,t){e.unmask(widget.body.getElementsByClassName("probe-synchro-title-children")[1]);l.alert("Impossible to delete the result of users inconsistencies probe.");if(t.code===4){var u=this.refreshView();widget.body.getElementsByClassName("i3DXCompassSupport-probes-usersInconsistencies")[0].setContent(u)}}.bind(this);var r={method:"DELETE",type:"json",onComplete:s,onFailure:q},p=localStorage.getItem("addressCluster")+"/enovia/resources/AppsMngt/probe/BoProbeUsersInconsistencies";e.mask(widget.body.getElementsByClassName("probe-synchro-title-children")[1]);k.authenticatedRequest(p,r)}.bind(this);n.confirm(o,f.i18n("Confirmation Refresh"),function(p){if(p){m()}i.manageSupportOfMultiModal()})},_createTemplate:function(n){var m=this,p=[],o=this.collection.at(0).get("data").map(function(r){var q=[];q.push(r.platform,r.users.length);p.push(q);return m.bodyZone(r)});return[this._title(n),{tag:"div","class":"probe-synchro-title-children",html:[this.probeUsersValue?this.refreshUsersInconsistencies():null,this.diagram(p),o]}]},refreshView:function(){this.probeUsersValue=true;return[this._title("In progress"),{tag:"div","class":"probe-synchro-title-children",html:[this.probeUsersValue?this.refreshUsersInconsistencies():null,{tag:"div","class":"probeUI-refresh",text:"The refresh of users inconsistencies probe is being refreshed. Please wait a few minutes. "}]}]},_viewNoResult:function(m){return[this._title(m),{tag:"div","class":"probe-synchro-title-children",html:[this.bodyZoneViewNoSynchKo()]}]},_failView:function(){return[{"class":"i3DXCompassSupport-probes",html:{"class":"failView-zone",html:[{"class":"failView-header",html:{"class":"failView-header-small",html:[{"class":"big-message",tag:"div",text:"Oops, "},{"class":"small-message",tag:"div",text:"We are sorry ... "}]}},{"class":"failView-body",html:{"class":"failView-body-small",html:[{tag:"span","class":"fonticon fonticon-comment"},{"class":"failView-view-icons",html:{tag:"span","class":"fonticon fonticon-role"}}]}},{"class":"failView-footer",html:{"class":"message-global-error",text:"An unexpected error has occured ... Server is unavailable. Please try later."}}]}}]},_title:function(n){var m=f.createElement("span",{"class":"fonticon fonticon-down-dir",styles:{opacity:"1"}});return[{tag:"h5","class":this.probeUsersValue?"title UI":"title",html:[m,{tag:"span",text:this.probeUsersValue?f.i18n("Users Inconsistencies | "+n):f.i18n("Synchronization Ko | "+n)}],events:{click:function(){if(m.hasClassName("fonticon-down-dir")){this.container.getElement(".probe-synchro-title-children").hide();m.removeClassName("fonticon-down-dir").addClassName("fonticon-right-dir")}else{this.container.getElement(".probe-synchro-title-children").show();m.removeClassName("fonticon-right-dir").addClassName("fonticon-down-dir")}}.bind(this)}}]},diagram:function(p){var n=f.createElement("div",{"class":"diagram-zone"}),m={enabled:false},o={enabled:false};this.graphView=new c.Chart({chart:{renderTo:n,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:false,type:"pie"},title:{text:this.probeUsersValue?"Users Inconsistencies Chart":"Synchro Ko Chart"},tooltip:{pointFormat:"{series.name}: <b>{point.y}</b>"},credits:m,exporting:o,plotOptions:{pie:{allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:false},showInLegend:true}},series:[{name:"User",colorByPoint:true,data:p}]});return n},bodyZoneViewNoSynchKo:function(m){return[{"class":"view-success",html:[{"class":"view-success-top",html:[{tag:"span","class":"circle-background-green",html:{tag:"span","class":"fonticon fonticon-check"}}]},{"class":"view-success-down",tag:"div",text:this.probeUsersValue?"No Users Inconsistencies":"No Synchronization KO"}]}]},bodyZone:function(m){var n=this;return[{"class":"probe-zone",html:[{"class":"probe-top",html:[{tag:"div","class":"probe-top-info",html:[{tag:"span","class":"fonticon fonticon-monitor"},{tag:"div","class":"name-platform",text:m.platform},{tag:"span","class":"count-user-global",text:m.users.length}]},{tag:"div","class":"probe-top-triangle",html:{tag:"span","class":"triangle"}}]},{"class":"probe-down",html:m.users.map(function(o){return n.viewUsers(o)})}]}]},doublon:function(m,n){if(m.informations.duplicateUserRole.search(n.trim())!==-1){return"doublon"}else{return"not-doublon"}},lastRole:function(m,n){if(m<n.split(",").length){return" - "}else{return""}},viewUsers:function(n){var r,q=this,o=f.createElement("div",{"class":"simple-circle2"}),m=0,p;r=[{"class":"user-zone",html:[{"class":"username-zone",html:[{"class":"user-circle-zone",html:[{tag:"div","class":"user-circle",html:{tag:"span","class":"fonticon fonticon-user"}}]},{tag:"div","class":"name-user",text:this.probeUsersValue?n.nameUser:n.id}]},this.probeUsersValue?[{"class":"message-zone",html:[{"class":"msg-zone-container",text:n.informations.message},{tag:"div","class":"simple-circle"}]},n.informations.rolesForThisEmailAddress?{"class":"role-zone",html:[{"class":"role-zone-container",html:n.informations.rolesForThisEmailAddress.split(",").map(function(s){m=m+1;p=n.informations.rolesForThisEmailAddress;return[{"class":q.doublon(n,s),text:s+q.lastRole(m,p),events:{mouseover:function(t){if(t.target.hasClassName("doublon")){new j({position:"bottom",target:t.target,body:"This role has a duplicate"}).show()}}}}]})},o,new j({position:"bottom",target:o,body:"Role associated with this email adress"})]}:{}]:{}]}];return r}})});define("DS/i3DXCompassSupport/i3DXCompassSupport",["DS/WAFData/WAFData","UWA/Core","UWA/Class","UWA/Class/Model","DS/UIKIT/Mask","DS/UIKIT/Tooltip","DS/W3DXComponents/IdCard","DS/i3DXCompassSupport/View/PingServicesView","DS/i3DXCompassSupport/Collection/ServiceCollection","DS/i3DXCompassSupport/Collection/SynchroUserCollection","DS/W3DXComponents/Views/Layout/ScrollView","DS/i3DXCompassCore/RequestOptions","DS/i3DXCompassSupport/View/SynchroUserKo","DS/i3DXCompassSupport/Collection/TicketCollection","DS/i3DXCompassSupport/View/TicketKoView","DS/i3DXCompassSupport/Collection/BroadcastCollection","DS/i3DXCompassSupport/View/BroadcastFinalView","DS/i3DXCompassSupport/View/ProbesView","DS/i3DXCompassSupport/Collection/ProbesCollection","DS/i3DXCompassSupport/Collection/UsersInconsCollection","DS/i3DXCompassSupport/Collection/FetchBOUsersInconsistencies","DS/UIKIT/Input/Button",["UWA/Data"],"css!DS/i3DXCompassSupport/i3DXCompassSupport"],function(b,g,w,k,B,u,v,h,x,a,A,r,i,n,z,y,q,s,m,l,d,o,c){var t=0,j=1,p=2,e=3,f=4;return w.extend({cache:null,addressCluster:null,init:function(C){this.selectedFacet=t;this.widget=C.widget;this.invalidateCache();this._initWidgetEvents()},invalidateCache:function(){this.cache=[]},_initWidgetEvents:function(){var C=this,D=C.widget;D.addEvents({onLoad:C._onLoad.bind(C)})},buildIdCard:function(){var C=this;return new v({model:new k(),actions:[],facets:function(){var D=[{text:g.i18n("Monitoring"),icon:"monitor",handler:function(){C.selectedFacet=t;C.getIdCardContent().setContent(C.getFacet(t))}}];D.push({text:g.i18n("Users Synchronization"),icon:"users",handler:function(){C.selectedFacet=j;var E=C.getFacet(j);C.getIdCardContent().setContent(E)}});D.push({text:g.i18n("Ticket KO"),icon:"user-key",handler:function(){C.selectedFacet=p;C.getIdCardContent().setContent(C.getFacet(p))}});D.push({text:g.i18n("Broadcast"),icon:"user-alt",handler:function(){C.selectedFacet=e;C.getIdCardContent().setContent(C.getFacet(e))}});D.push({text:g.i18n("Probes"),icon:"eye",handler:function(){C.selectedFacet=f;C.getIdCardContent().setContent(C.getFacet(f))}});return D}})},getIdCardContent:function(){return this.widget.body.getElement(".id-card-content")},_onLoad:function(){var C,H=this,E=this.widget.body,G=g.createElement("input",{type:"text","class":"form-control inputCluster",placeholder:"Cluster name ...",value:localStorage.addressCluster?localStorage.addressCluster:this.addressCluster}),C=this.buildIdCard(),D,F={"class":"form-group input-group cluster",html:[G,{tag:"span","class":"input-group-btn",html:new o({value:"Save",className:"primary",events:{onClick:function(){var I=H.widget.getElement(".inputCluster").value.trim(),J=/[!|^|$|(|)|[|\]|}|{|?|+|*|\\|"|ยง]/;if((I.substring(0,8)==="https://")&&(!J.test(I))){if(G.style.borderColor){G.removeAttribute("style");D.remove()}localStorage.setItem("addressCluster",I);H.widget.dispatchEvent("onLoad")}else{G.setAttribute("style","border-color: red;");D=new u({position:"bottom",target:G,body:"You must enter an url starting with 'https://' and excluding the following characters :  !, ^, $, (, ), [, ], }, {, ?, +, *, \", \\, ยง. "}).show()}}}})}]};B.unmask(E);this.invalidateCache();this.widget.setBody(F);this.widget.body.addContent([C,{"class":"id-card-content",html:""}]);C.selectFacet(this.selectedFacet);E.getElement(".id-card-content").setStyle("height","calc(100% - 55px)")},getFacet:function(K){var L=this.cache[K],N=this.widget.body,M,S,T,O,E,J,F,P,D=g.createElement("p",{text:"..."}),H=N.getParents()[2].getElements("div.tooltip")[0],G=N.getParents()[2].getElements("div.tooltip")[1];if(H!==undefined){H.remove()}if(G!==undefined){G.remove()}if(!g.is(L)){switch(K){case t:M=new x();S=new h({collection:M,getScrollView:function(){return this.cache[t]}.bind(this)});this.cache[0]={"class":"i3DXCompassSupport-ping-service",html:[new A({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:S}).render()]};B.mask(D);this.widget.setTitle("Support App - ("+localStorage.getItem("addressCluster")+")");N.getElement(".id-card-content").setContent(D);M.fetch({onComplete:function(){B.unmask(D);S.render()}.bind(this),onFailure:function(V,U){B.unmask(D);if(U.contains('return ResponseCode with value "401"')){this.widget.body.setContent(S._badAuthentification())}else{S._failView()}}.bind(this)});break;case j:T=new i({events:{StartSearch:function(){var V=this,W=this.getContent().getElements("input.form-control.search-user-platform")[0].value.trim(),U=this.getContent().getElements("input.form-control.search-user-platform")[1].value.trim(),X=new a();X.fetch({data:{user:W,platform:U},onComplete:function(Z,Y){B.unmask(this.container);if(Y.data.length===0){this.container.setContent(new i({model:Y,events:{SearchAgain:function(){V.dispatchEvent("StartSearch")}}})._failView(W,U))}else{this.container.setContent(Z._models.map(function(aa){return new i({model:aa,events:{SearchAgain:function(){V.dispatchEvent("StartSearch")}}}).render2(aa,W,U)}))}}.bind(this),onFailure:function(Z,Y){B.unmask(this.container);if(Y.code===undefined){this.container.setContent(new i({model:Y,events:{SearchAgain:function(){V.dispatchEvent("StartSearch")}}})._failGlobalView(W,U))}else{this.container.setContent(new i({model:Y,events:{SearchAgain:function(){V.dispatchEvent("StartSearch")}}})._failView(W,U))}}.bind(this)});B.mask(this.container)}}}).render();var C={"class":"i3DXCompassSupport-synchro-user",html:new A({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:T}).render()};B.mask(D);this.widget.setTitle("Support App - ("+localStorage.getItem("addressCluster")+")");N.getElement(".id-card-content").setContent(D);B.unmask(D);return C;case p:O=new z({events:{StartSearchTicket:function(){var V=this,W=new n(),U=this.getContent().getElements("input")[0].value.trim();W.fetch({data:{ottOrPlatform:U},onComplete:function(Y,X){B.unmask(this.container);if(X.locked===0){this.container.setContent(new z({model:X,events:{SearchAgainTicket:function(Z){V.dispatchEvent("StartSearchTicket")}}})._successFailView(U))}else{this.container.setContent(new z({model:X,events:{SearchAgainTicket:function(Z){V.dispatchEvent("StartSearchTicket")}}})._createTemplateBis(U))}}.bind(this),onFailure:function(Y,X){B.unmask(this.container);Y;if(X.code===undefined){this.container.setContent(new z({model:X,events:{SearchAgainTicket:function(Z){V.dispatchEvent("StartSearchTicket")}}})._failCallWs(U))}else{this.container.setContent(new z({model:X,events:{SearchAgainTicket:function(Z){V.dispatchEvent("StartSearchTicket")}}})._successFailView(U))}}.bind(this)});B.mask(this.container)}}}).render();var I={"class":"i3DXCompassSupport-synchro-ticket",html:new A({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:O}).render()};B.mask(D);this.widget.setTitle("Support App - ("+localStorage.getItem("addressCluster")+")");N.getElement(".id-card-content").setContent(D);B.unmask(N);return I;case e:var E=new q({events:{StartBroadcast:function(){var X=this,W=this.getContent().getElements("input")[0].value.trim(),ab=this.getContent().getElements("input")[1].value.trim(),aa=new y(),Z=function(ae,ac){B.unmask(this.container);var ad=new Date(ae.date);ae.date=ad.toDateString()+" "+ad.toTimeString().substring(0,8);this.container.setContent(new q({model:ae,events:{StartAgainBroadcast:function(af){X.dispatchEvent("StartBroadcast")}}})._createTemplateBis(W,ab))}.bind(this),V=function(ad,ac){B.unmask(this.container);if(ac===null){this.container.setContent(new q({model:ac,events:{StartAgainBroadcast:function(ae){X.dispatchEvent("StartBroadcast")}}})._failCallWs(W,ab))}else{this.container.setContent(new q({model:ac,events:{StartAgainBroadcast:function(ae){X.dispatchEvent("StartBroadcast")}}})._failView(W,ab))}}.bind(this),Y={method:"POST",type:"json",data:{platform:W,user:ab},onComplete:Z,onFailure:V};var U=localStorage.getItem("addressCluster")+"/enovia/resources/AppsMngtSupport/status/v1/broadcast?";B.mask(this.container);b.authenticatedRequest(U,Y)}}}).render();var R={"class":"i3DXCompassSupport-broadcast",html:new A({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:E}).render()};B.mask(D);this.widget.setTitle("Support App - ("+localStorage.getItem("addressCluster")+")");N.getElement(".id-card-content").setContent(D);B.unmask(N);return R;case f:M=new m([],{type:"text",headers:{Accept:"text/plain"}});J=new s({collection:M});F=new d();P=new s({collection:F});B.mask(D);this.widget.setTitle("Support App - ("+localStorage.getItem("addressCluster")+")");N.getElement(".id-card-content").setContent(D);var Q=new A({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:J});M.fetch({onComplete:function(W,U){var V={"class":"i3DXCompassSupport-probes",html:Q.render()};B.unmask(D);if(!widget.body.getElementsByClassName("failView-zone")[0]){widget.body.getElement(".id-card-content").addContent(V)}},onFailure:function(V,U){B.unmask(D);widget.body.getElement(".id-card-content").addContent(J._failView())}});F.fetch({onComplete:function(X,V){var U=true,W;if(V.message==="Refresh in progress"){W={"class":"i3DXCompassSupport-probes-usersInconsistencies",html:P.refreshView()}}else{W={"class":"i3DXCompassSupport-probes-usersInconsistencies",html:P.render(U)}}B.unmask(D);if(!widget.body.getElementsByClassName("failView-zone")[0]){widget.body.getElement(".probes-view").addContent(W)}},onFailure:function(X,U){if(U.code===1){var W=new l([],{type:"text",headers:{Accept:"text/plain"}}),V=new s({collection:W});W.fetch({data:{json:true},onComplete:function(ab,Z){var Y=true,aa={"class":"i3DXCompassSupport-probes-usersInconsistencies",html:V.render(Y)};B.unmask(D);if(!widget.body.getElementsByClassName("failView-zone")[0]){widget.body.getElement(".probes-view").addContent(aa)}},onFailure:function(Z,Y){B.unmask(D);widget.body.getElement(".id-card-content").addContent(J._failView())}})}B.unmask(D)}})}L=this.cache[K]}return L}})});