define("DS/CoreEvents/ModelEvents",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class"],function(f,b,d,c){function e(g,h){g.length=0;g=null;if(!h){g=[]}return g}var a=c.extend({defaultOptions:{parent:null,target:null,asyncPropagation:false,callMode:"desc",debug:{delay:0}},init:function(g){this._parent(false);this.options=f.extend(f.clone(this.defaultOptions),g);this._target=this.options.target;this._spyEvents=null;this._listOfParents=[];if(this.options.parent){this._setParent(this.options.parent)}var h=this;this._pubsub={ongoingtopics:{},topics:{},subUid:-1,publish:function(l,k,j){if(this._spyCB){console.warn("!!!");this._spyCB.call(l,k,j)}if(!this.topics[k]){return false}var n=this.topics[k],i=n?n.length:0;if(h.options.callMode==="desc"){while(i--){if(n[i]&&n[i].func){n[i].func.call(l,j,n[i].token)}}}else{if(h.options.callMode==="asc"){this.ongoingtopics[k]=[];while(n[0]){n[0].func.call(l,j,n[0].token);var m=n.shift();if(m){this.ongoingtopics[k].push(m)}}this.topics[k]=this.ongoingtopics[k];this.ongoingtopics[k]=[]}}return this},subscribe:function(i,k){if(!this.topics[i]){this.topics[i]=[]}var j=(++this.subUid).toString();this.topics[i].push({token:j,func:k});return j},unsubscribe:function(o){for(var n=0,l=this.ongoingtopics.length;n<l;n++){if(this.ongoingtopics[n]&&this.ongoingtopics[n].token===o){this.ongoingtopics.splice(n,1);l--}}for(var k in this.topics){if(this.topics[k]){for(var n=0,l=this.topics[k].length;n<l;n++){if(this.topics[k][n]&&this.topics[k][n].token===o){this.topics[k].splice(n,1);l--}}}}return this}}},_setParent:function(g){this._listOfParents=[];this._addParent(g)},_addParent:function(g){if(g instanceof Array){this._listOfParents=g}else{if(g!==null){this._listOfParents.push(g)}else{this._listOfParents=[]}}},_unsetParent:function(h){var g=this._listOfParents.indexOf(h);if(g!==-1){this._listOfParents.splice(g,1)}},_formatEvent:function(g){return("/"+g+"/").replace(/(\/+)/g,"/")},publish:function(j){var i={context:j.context,event:j.event,formattedEvent:j.formattedEvent===undefined?this._formatEvent(j.event):j.formattedEvent,data:j.data,propagate:j.propagate===undefined?true:j.propagate,target:j.target===undefined?this._target:j.target,parent:j.parent===undefined?this._target:j.parent};var k=this;if(i.target){var g={event:i.event,formattedEvent:i.formattedEvent,parent:i.parent,target:i.target,data:i.data,propagate:i.propagate,stopPropagation:function(){g.propagate=false}};if(k.options.debug&&k.options.debug.delay){setTimeout(function(){k._pubsub.publish(i.context,g.formattedEvent,g)},k.options.debug.delay)}else{this._pubsub.publish(i.context,g.formattedEvent,g)}if(g.propagate){var h=this._listOfParents;if(h.length===1){k._propagate(h[0],i)}else{h.forEach(function(l){k._propagate(l,i)})}}}else{this._pubsub.publish(i.context,i.formattedEvent,i.data)}},_propagate:function(h,g){if(this.options.asyncPropagation){setTimeout(function(){h.publish(g)},0)}else{h.publish(g)}},subscribe:function(i,j){var g={event:null};f.extend(g,i);var h=this._formatEvent(g.event);return this._pubsub.subscribe(h,j)},unsubscribeAll:function(g){var j=this;if(g){var i=this._formatEvent(g.event);if(this._pubsub.topics[i]){this._pubsub.topics[i].forEach(function(k){j._pubsub.unsubscribe(k.token)})}}else{for(var h in this._pubsub.topics){if(this._pubsub.topics[h]){this._pubsub.topics[h].forEach(function(k){j._pubsub.unsubscribe(k.token)});e(this._pubsub.topics[h])}}}},destroy:function(){var g=this;this.unsubscribeAll();delete this._pubsub.topics;delete this._pubsub;delete this._target;e(this._listOfParents);delete this.options;delete this.defaultOptions},addEventListener:function(h,g){return this.subscribe({event:h},g)},subscribeOnce:function(i,k){var j=this;var h=this.subscribe(i,g);function g(l){j.unsubscribe(h);k.call(this,l)}},unsubscribe:function(g){this._pubsub.unsubscribe(g)},_beginSpyEvents:function(g){this._pubsub._spyEvents=g},_endSpyEvents:function(){this._pubsub._spyEvents=null}});return a});define("DS/CoreEvents/Events",["UWA/Core","UWA/Event","UWA/Class/Events","UWA/Class"],function(f,b,d,c){var e={topics:{},subUid:-1,publish:function(i,h){if(!this.topics[i]){return false}var j=this.topics[i],g=j?j.length:0;while(g--){if(j[g]&&j[g].func){j[g].func(h)}}return this},subscribe:function(g,i){if(!this.topics[g]){this.topics[g]=[]}var h=(++this.subUid).toString();this.topics[g].push({token:h,func:i});return h},unsubscribe:function(l){for(var g in this.topics){if(this.topics[g]){for(var k=0,h=this.topics[g].length;k<h;k++){if(this.topics[g][k]&&this.topics[g][k].token===l){this.topics[g].splice(k,1);h--}}}}return this}};var a=c.singleton({init:function(g){this._parent(false)},_formatEvent:function(g){var h=/(\/+)/g;g=("/"+g+"/").replace(h,"/");return g},publish:function(h){var g={event:null,data:null,useFullInfos:false};f.extend(g,h);g.event=this._formatEvent(g.event);if(g.useFullInfos){e.publish(g.event,g)}else{e.publish(g.event,g.data)}},subscribe:function(i,k,j){if(j===undefined){j=false}var g={event:null};f.extend(g,i);var h=this._formatEvent(g.event);return e.subscribe(h,k)},subscribeOnce:function(i,k){var j=this;var h=this.subscribe(i,g);function g(l){j.unsubscribe(h);k.call(this,l)}},unsubscribe:function(g){e.unsubscribe(g)}});return f.namespace("WUX/Events",a)});