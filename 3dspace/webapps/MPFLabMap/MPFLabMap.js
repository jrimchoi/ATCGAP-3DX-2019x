define("DS/MPFLabMap/ShopMarkerBuilder",["UWA/Core","UWA/Class","DS/Leaflet/LeafletLoader","css!DS/MPFUI/MPFUI"],function(d,b,a){var c=b.extend({init:function(f,e){this.shop=f},build:function(){var e;var f;f=new a.Icon.Default();e=a.marker([this.shop.getLatitude(),this.shop.getLongitude()],{icon:f});e.bindPopup(this._createPopupBody(this.shop)).openPopup();e.on("click",this._onClick.bind(this));return e},_onClick:function(){console.log("marker clicked: "+this.shop.getName())},_createPopupBody:function(){var e;var g;var f;g=d.createElement("h4",{"class":"mpf-title",text:this.shop.getName()});f=d.createElement("div",{"class":"mpf-img-container",html:[{tag:"img","class":"mpf-shop-logo",alt:"shop logo",src:this.shop.getLogo()}]});e=d.createElement("div",{"class":"mpf-marker-popup",html:[g,f]});return e}});return c});define("DS/MPFLabMap/LabMap",["UWA/Class/View","DS/Leaflet/MPMapView","DS/MPFLabMap/ShopMarkerBuilder"],function(d,b,a){var c=d.extend({className:"mpf-lab-map",setup:function(e){var f=this;this.map=new b({onCenterChangedCB:function(){e.onCenterChangedCB(f.map.getBounds());f._updateClustersLayer()},onMapLoadedCB:this.render.bind(this),defaultZoom:e.defaultZoom});this.markersLayer=new L.MarkerClusterGroup({chunkedLoading:true,showCoverageOnHover:false});this.markers=[];this.map.loadMap()},render:function(){var e=this;e.container.setContent(this.map.getContent());this.map.onShow();return this},setShopList:function(e){this.markers.forEach(function(f){this.map.removeMarker(f)},this);this.markers=e.map(function(f){return(new a(f)).build()},this);this.map._map.addLayer(this.markersLayer);this.markersLayer.addLayers(this.markers)},_updateClustersLayer:function(){this.markersLayer.clearLayers();this.map._map.removeLayer(this.markersLayer);this.markersLayer=new L.MarkerClusterGroup({chunkedLoading:true,showCoverageOnHover:false});this.map._map.addLayer(this.markersLayer);this.markersLayer.addLayers(this.markers)},updateMapWithNewListLab:function(e){this.markers.forEach(function(f){this.map.removeMarker(f)},this);this.markers=e.map(function(f){return(new a(f)).build()},this);this._updateClustersLayer()},setToDefaultPosition:function(){this.map.setMapPosition(this.map._defaultPosition)}});return c});