define("DS/ConnectionChecker/ConnectionChecker",["UWA/Class","UWA/Class/Options","DS/WAFData/WAFData"],function(c,b,a){var d=c.extend(b,{resource:null,state:null,options:{timeout:25000,interval:5000,checkOnInit:false},init:function(f,e){if(typeof f==="string"){this.resource=f}else{return}this.setOptions(e);if(this.options.checkOnInit){this.check()}},check:(function(){function e(h,j){var f=this.state,g=this.options.onDown,i=this.options.onUp;this.state=h;if(f==="up"&&h==="down"){g&&g()}else{if(f==="down"&&h==="up"){i&&i()}}j&&j.call(this,this.state)}return function(){var f=arguments[0],g=f&&f.callback;a.request(this.resource,{onTimeout:e.bind(this,"down",g),onFailure:e.bind(this,"down",g),onComplete:e.bind(this,"up",g)})}}()),retry:function(f){var g=0,e=this.options.attempts,h,i=f&&f.callback;this.intervalId&&clearInterval(this.intervalId);if(this.state==="up"){return}h=function(j){g++;if(j==="up"||(e&&e===g)){clearInterval(this.intervalId);i&&i()}};this.intervalId=setInterval(this.check.bind(this,{callback:h}),this.options.interval)}});return d});