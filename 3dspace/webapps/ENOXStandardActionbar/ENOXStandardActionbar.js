define("DS/ENOXStandardActionbar/js/ENOXStandardActionbar",["UWA/Controls/Abstract","UWA/Class/View","DS/UIKIT/Iconbar","DS/UIKIT/DropdownMenu","DS/Core/ModelEvents","DS/ENOXViewFilter/js/ENOXViewFilter","DS/ResizeSensor/js/ResizeSensor","DS/UIKIT/Mask","i18n!DS/ENOXCollectionToolBar/assets/nls/ENOXCollectionToolBar","css!DS/ENOXStandardActionbar/css/ENOXStandardActionbar.css"],function(j,b,e,a,d,k,c,g,l){var h="ASC";var f="DESC";if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,"findIndex",{value:function(p){if(this==null){throw new TypeError('"this" is null or not defined')}var t=Object(this);var n=t.length>>>0;if(typeof p!=="function"){throw new TypeError("predicate must be a function")}var q=arguments[1];var r=0;while(r<n){var s=t[r];if(p.call(q,s,r,t)){return r}r++}return -1}})}if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(p){if(this==null){throw new TypeError('"this" is null or not defined')}var t=Object(this);var n=t.length>>>0;if(typeof p!=="function"){throw new TypeError("predicate must be a function")}var q=arguments[1];var r=0;while(r<n){var s=t[r];if(p.call(q,s,r,t)){return s}r++}return undefined}})}var m=j.extend({init:function(n){this.options=UWA.clone(n,false);var p={showItemCount:false,parentContainer:null};this._listSubscription=[];this.modelEvent=n.modelEvent?n.modelEvent:new d();this.wrapperContainer=UWA.createElement("div",{"class":""}).inject(this.options.parentContainer);this.actionBar=UWA.createElement("div",{"class":"actionBar"}).inject(this.wrapperContainer);UWA.merge(this.options,p);if(UWA.is(this.options.onSearch,"function")){this._listSubscription.push(this.modelEvent.subscribe({event:"onSearch"},n.onSearch))}if(UWA.is(this.options.onSort,"function")){this._listSubscription.push(this.modelEvent.subscribe({event:"onSort"},n.onSort))}if(UWA.is(this.options.onSwitch,"function")){this._listSubscription.push(this.modelEvent.subscribe({event:"onSwitch"},n.onSwitch))}var o=this;this._listSubscription.push(this.modelEvent.subscribe({event:"enox-standard-action-bar-update-count"},function(q){o.updateCount(q)}));this._parent(this.options);this.render()},render:function(){var r=this;if(this.options.showItemCount){this.counterContainer=UWA.createElement("div",{"class":"countContainer"}).inject(this.actionBar);this.updateCount(0)}this.MidMenuContainer=UWA.createElement("div",{"class":"midMenuContainer"}).inject(this.actionBar);var q=UWA.createElement("div",{"class":"actionsContainer"}).inject(this.actionBar);if(this.options.searchOptions){this.initSearch();var o=UWA.createElement("span",{"class":"fonticon fonticon-search search-icon"}).inject(q);o.addEvents({click:function(t){r.searchHandler(o)}});this.searchIcon=o}if(this.options.sortOptions){if(!this.options.sortOptions.order){this.options.sortOptions.order=f}if(this.options.sortOptions.attributes){var n=UWA.createElement("div",{"class":"sortContainer"}).inject(q);this.addSortComponent(n)}}if(this.options.groupByOptions){var p=UWA.createElement("div",{"class":"groupByContainer"}).inject(q);this.addGroupByComponent(p)}var s=UWA.createElement("div",{styles:{"class":"iconBarContainer"}});this.iconBar=(new e({renderTo:s,items:[],"class":"actionbar-iconbar"})).inject(q);this.renderIconBar();this.actionsContainer=q;this.resizeActionBar();setTimeout(function(){new c(r.actionBar,function(){r.resizeActionBar()});r.resizeActionBar();g.unmask(r.wrapperContainer)},100)},renderIconBar:function(){var o=this.options.actions,p=this.options.sortOptions,n=this.options.switchViews;if(o&&p){this.iconBar.addItem({className:"divider actionbar-divider"})}if(o){this.addActions(o)}if((!o&&p&&n)||(o&&n)){this.iconBar.addItem({className:"divider actionbar-divider"})}if(n){this.addSwitchers(n)}this.iconBar.menu.elements.wrapper.addClassName("actionbar-iconbar-items")},updateCount:function(n){var o=l.Item;if(n>=0){o=n+" "+o}this.counterContainer.setContent(o)},addGroupByComponent:function(p){var o=this;UWA.createElement("div",{text:l.groupBy,"class":"groupContainer"}).inject(p);var n=UWA.createElement("div",{"class":"sta-menu",styles:{color:"#368ec4"}}).inject(p);this.addGroupByAttributes(this.options.groupByOptions.attributes,n)},addGroupByAttributes:function(o,n){var p=this;o.forEach(function(r){r.selectable=true});var q=o.find(function(r){return r.selected===true});if(!q){q=o[0];o[0].selected=true}n.set("text",q.text);this.groupBySelection=q.id;new a({target:n,items:[o],events:{onClick:function(s,r){n.set("text",r.text);p.groupBySelection=r.id;var t={attribute:p.groupBySelection};p.publishEvent("onGroup",t)}}})},addSortComponent:function(n){var p=this;UWA.createElement("div",{text:l.sortBy,"class":"sortByContainer"}).inject(n);var o=UWA.createElement("div",{"class":"sta-menu",styles:{color:"#368ec4"}}).inject(n);var q=UWA.createElement("span").inject(n);this.addSortAttributes(this.options.sortOptions.attributes,o);this.addSortOrder(this.options.sortOptions.order,q)},addSortAttributes:function(o,n){var q=this;o.forEach(function(r){r.selectable=true});var p=o.find(function(r){return r.selected===true});if(!p){p=o[0];o[0].selected=true}n.set("text",p.text);this.sortAttribute=p.id;new a({target:n,renderTo:q.actionBar,items:[o],events:{onClick:function(s,r){n.set("text",r.text);q.sortAttribute=r.id;var t={attribute:q.sortAttribute,order:q.options.sortOptions.order};q.resizeActionBar();q.publishEvent("onSort",t)}}})},addSortOrder:function(n,o){var q="up",p=this;if(n===h){q="down"}o.set("class","fonticon fonticon-"+q+" orderSpan");o.addEvents({click:function(s){if(p.options.sortOptions.order===h){o.set("class","fonticon fonticon-up orderSpan");p.options.sortOptions.order=f}else{o.set("class","fonticon fonticon-down orderSpan");p.options.sortOptions.order=h}var r={attribute:p.sortAttribute,order:p.options.sortOptions.order};p.publishEvent("onSort",r)}})},destroy:function(){this._parent();var n=this._listSubscription.length;for(i=0;i<n;i++){this.modelEvent.unsubscribe(this._listSubscription[i])}},addActions:function(s){var q=s.length,r=function(){};for(var n=0;n<q;n++){var p=s[n];p.name=p.id;var t=p.disable?"iconbar-item-disable":"iconbar-item";var o=(t==="iconbar-item-disable")?r:p.handler;this.iconBar.addItem({className:t,id:p.id,fonticon:p.fonticon,text:p.text,handler:o.bind(p)});this.enableAction(p.id,!p.disable)}},addSwitchers:function(p){var n=[],r=p.find(function(s){return s.selected===true});if(!r){r=p[0];p[0].selected=true}for(var o=0;o<p.length;o++){p[o].selected;if(p[o].selected!=true){p[o].selected=false}n.push({id:p[o].id,fonticon:p[o].fonticon,text:p[o].text,selected:p[o].selected,handler:this.switchHandler.bind(this,n)})}if(this.options.switchViews.length>2){var q={options:{items:n},type:"icondropdown"};this.iconBar.addItem({id:r.id,fonticon:r.fonticon,text:r.text,content:q})}else{this.iconBar.addItem({id:r.id,fonticon:r.fonticon,text:r.text,handler:this.switchView.bind(this,n)})}this.target=this.iconBar.menu.items.find(function(s){return s.fonticon===r.fonticon});this.setStyle(this.target.elements.icon)},switchHandler:function(n,s,p){var r=this;var q=this.iconBar.menu.items.find(function(t){return t.fonticon===r.target.fonticon});if(p){q.tooltip.options.target.lastChild.className=p.elements.icon.className;var o=n.findIndex(function(t){return t.id===p.id});q.tooltip.elements.body.textContent=n[o].text;this.publishEvent("onSwitch",p.id)}},switchView:function(o,r,q){var p=o.findIndex(function(s){return s.selected===false});var n=0;if(p==0){n=1}o[p].selected=true;o[n].selected=false;this.target.tooltip.elements.body.textContent=o[p].text;this.target.tooltip.options.target.lastChild.className="fonticon fonticon-"+o[p].fonticon;this.publishEvent("onSwitch",o[p].id)},setStyle:function(n){if(n){n.setStyles({color:"#368ec4",opacity:"1"})}},defaultStyle:function(n){if(n){n.setStyles({color:"grey"});n.addEvents({mouseover:function(o){n.setStyles({opacity:"1"})},mouseout:function(o){if(n.style.color==="grey"){n.setStyles({opacity:"0.5"})}},})}},enableAction:function(p,n){var o=this.iconBar.menu.items.find(function(q){return q.id===p});n?this.iconBar.menu.enableItem(o.id):this.iconBar.menu.disableItem(o.id)},searchHandler:function(n){if(this.searchComp.container.isHidden()){this.searchComp.show();this.setStyle(n)}else{this.searchComp.hide();this.defaultStyle(n)}},initSearch:function(){var n=this;this.options.searchOptions.onSearch=function(o){n.publishEvent("onSearch",o)};this.options.searchOptions.parentContainer=this.MidMenuContainer;this.searchComp=new k(this.options.searchOptions);this.searchComp.hide()},setSearchVisibility:function(n){if(n){this.searchComp.show();this.setStyle(this.searchIcon)}else{this.searchComp.hide();this.defaultStyle(this.searchIcon)}},setSearchText:function(n){if(this.searchComp){this.searchComp.setText(n)}},publishEvent:function(n,o){this.modelEvent.publish({event:n,data:o})},onRender:function(){this.elements.container.setStyles({height:"auto"});g.mask(this.wrapperContainer)},resizeActionBar:function(){var n=this.counterContainer?this.counterContainer.offsetWidth:0;var o=this.actionBar.offsetWidth-(n+this.actionsContainer.offsetWidth+5);if(o>0){this.MidMenuContainer.setStyle("width",o+"px")}if(this.searchComp){if(o<300){this.searchComp.inject(this.wrapperContainer)}else{this.searchComp.inject(this.MidMenuContainer)}this.searchComp.resizeSearch()}},});return m});