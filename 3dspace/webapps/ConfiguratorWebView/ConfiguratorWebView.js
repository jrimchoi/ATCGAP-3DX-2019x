var ExperienceKernelPath=function(){var c=window.location.search.substring(1);var b=c.split("&");for(var a=0;a<b.length;a++){var d=b[a].split("=");if(d[0]=="onWinEnv"){if(d[1]=="true"){return"DS/ExperienceKernel/ExperienceKernel"}else{return""}}}if(window.__karma__&&window.__karma__.config.args[1]){return window.__karma__.config.args[1]}else{return""}}();define("DS/ConfiguratorWebView/ConfigurationServices",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/FilterXMLServices","DS/ConfiguratorWebView/PanelController","DS/ConfiguratorWebView/Utilities","UWA/Controls/Accordion",ExperienceKernelPath,"DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView"],function(e,a,g,k,d,h,l,c,b){var f={connectToSolverNode:function(m,q,n){var u=this;var s=new a();var p=new l.Node({hypervisorIp:m,webSocketPort:q,onText:t,});s.setNodeSolver(p);function t(v){u.ApplyAnswer(v)}s.setNodeSolverName(n);var o=s.getNodeSolver().connect(n).select();s.setSolverId(o);var r={_from:"configurator",_to:"solver",_request:"deleteNode",_data:""};s.getNodeSolver().sendTextOnDisconnection(o,JSON.stringify(r))},SetSolverKey:function(m){var n=new a();n.setSolverId(m)},EmptyCacheIdWithState:function(){var m=new a();m.EmptyCacheIdWithState()},ApplyAnswer:function(x,y){var K=true;if(x!=undefined&&x!=""){var z=new a();var o=x;try{o=JSON.parse(x)}catch(J){}var F=o._answer;var s=o._data;var L=o._rc;if(F=="getResultingStatusOriginators"){var p=s.listOfIncompatibilitiesIds;var q=s.optionSelected;k.createQuestionMarkTooltip(q,p,L);if(d.RetrieveElement("content")){if(d.RetrieveElement("divLoader")){d.RemoveElement("divLoader")}}}else{if(F=="checkModelConsistency"){var v=z.getRulesConsistency();if(L=="Rules_KO"||L=="ERROR"){z.setRulesConsistency(false);z.setRulesActivation("false");d.deleteInfoBox();var w=e.i18n("InfoInconsistentRules");var I=s.listOfInconsistentRulesIds;if(I.length>0){w+="<br>"+e.i18n("Implied Rules")+":<br>";for(var H=0;H<I.length;H++){w+="<blocquote style='padding-left:20px;'>"+I[H]+"<br></blocquote>"}}if(L=="ERROR"){w+="<br>"+e.i18n("InfoComputationAborted")}d.showInfoBox(w,"warning")}else{z.setRulesConsistency(true)}if(v!==z.getRulesConsistency()){k.updateFilterIcon()}if(d.RetrieveElement("divLoader")){d.RemoveElement("divLoader")}}else{if(F=="solveAndDiagnoseAll"){var A=s.configurationCriteria;var D=s.modifiedAssumptions;var u=s.conflicts;var t=s.defaults;var n=z.getAction();if(u){if(L==="ERROR"){d.deleteInfoBox();var w=e.i18n("InfoComplexityOfRules");d.showInfoBox(w,"warning");z.setErrorOnConflictPanel(true)}else{z.setErrorOnConflictPanel(false)}var m=u.listOfListOfConflictingIds;var G=u.listOfListOfImpliedRules;var r;var B=new Object();for(var H=0;H<m.length;H++){for(var E=0;E<m[H].length;E++){r=z.getStateWithId(m[H][E]);if(z.isAnOption(m[H][E])||m[H][E].indexOf("KeyIn_")==0){if(r=="chosen"||r=="chosenInConflict"){B[m[H][E]]="chosenInConflict"}else{if(r=="dismissed"||r=="dismissedInConflict"){B[m[H][E]]="dismissedInConflict"}else{if(r=="default"||r=="defaultInConflict"){B[m[H][E]]="defaultInConflict"}}}}}}if((!d.onWinEnv()&&"view"!=n.toLowerCase())||d.onWinEnv()){z.setConfigurationCriteria(A)}z.setRulesCompliancyStatus("Invalid");for(var C in B){z.setStateWithId(C,B[C])}z.setListOfListOfImpliedRules(G);z.setListOfListOfConflictingIds(m)}else{if(A){if((!d.onWinEnv()&&"view"!=n.toLowerCase())||d.onWinEnv()){z.setConfigurationCriteria(A)}else{if(!d.onWinEnv()&&"view"==n.toLowerCase()){for(var H=0;H<A.length;H++){if(z.isAFeature(A[H].Id)&&(A[H].State=="2"||A[H].State=="Required")){z.setStateWithId(A[H].Id,"requiredFeature")}}}}z.setRulesCompliancyStatus("Valid")}}if(D.length>0){var w=e.i18n("InfoIdsIncompatibles")+"<br>";for(var H=0;H<D.length;H++){w+="<blocquote style='padding-left:20px;'>"+d.getFeatureDisplayNameWithId(D[H])+"["+d.getOptionDisplayNameWithId(D[H])+"]<br></blocquote>"}d.deleteInfoBox();if((!d.onWinEnv()&&"view"!=n.toLowerCase())||d.onWinEnv()){d.showInfoBox(w,"warning")}}z.setDefaultOptionsList(t);if(d.RetrieveElement("divLoader")){d.RemoveElement("divLoader")}if(d.RetrieveElement("content")){k.updateFeatures(false);if(d.RetrieveElement("myfeatureOptions")){k.updateOptionsPanel()}}}else{if(F=="setSelectionMode"&&!(y===true)){d.CallSolveMethodOnSolver()}else{if(F=="setMultiSelection"&&!(y===true)){d.CallSolveMethodOnSolver()}else{if(L=="ERROR"){}}}}}}}return K},setDictionaryJSONAsString:function(p){var n=new a();var o=JSON.parse(p);if(o.dictionary){n.setDictionary(o.dictionary)}var m=[];n.setConfigurationCriteria(m)},setDictionaryJSON:function(o){var n=new a();if(o){if(o.dictionary){n.setDictionary(o.dictionary)}else{n.setDictionary(o)}}var m=[];n.setConfigurationCriteria(m)},setConfigurationCriteriaJSON:function(m){var o=new a();if(m){var n=o.checkOptionsAndFeaturesPresenceInDictionary(m);o.setConfigurationCriteria(n)}},getConfigurationCriteria:function(){var m=new a();return m.getAdaptedConfigurationCriteria()},getActualConfigurationCriteria:function(){var m=new a();return m.getConfigurationCriteria()},getListPrice:function(){var m;var n=new a();m=n.getTotalPrice();return m},checkInvalidKeyInFeatures:function(){var m=new a();if("view"==m.getAction().toLowerCase()){return true}return k.checkInvalidKeyInFeatures()},setAppFuncJSONAsString:function(o){var m=new a();var n=JSON.parse(o);if(n.app_Func){m.setAppFunc(n.app_Func)}},setAppFuncJSON:function(n){var m=new a();if(n){if(n.app_Func){m.setAppFunc(n.app_Func)}else{m.setAppFunc(n)}}},setApplicationState:function(o){var m=new a();var n=JSON.parse(o);if(n.applicationState){m.setApplicationState(n.applicationState)}},setAppRulesParamJSONAsString:function(o){var m=new a();var n=JSON.parse(o);if(n){m.setAppRulesParam(n)}},setAppRulesParamJSON:function(n){var m=new a();if(n){if(n.appRulesParam){return m.setAppRulesParam(n.appRulesParam)}else{return m.setAppRulesParam(n)}}},setPCPurpose:function(n){var m=new a();if(n){m.setPCPurpose(n)}},setRefineSelMode:function(n){var m=new a();if(n){m.setRefineSelMode(n)}},getAppRulesParam:function(){var m=new a();return m.getAppRulesParam()},initPanel:function(m){if(m){d.setDefaultOptions()}if(!d.RetrieveElement("MustSelectFeatureDiv")){this.LoadPanel();if(!d.onWinEnv()){d.RetrieveElement("configPanel").style.width="100%"}if(!d.RetrieveElement("prodStatesContainer")){k.RefreshPanel();d.setAlwaysDiagnosed();d.CheckRulesConsistency()}}else{if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px"}else{if(d.onWinEnv()){d.RetrieveElement("content").style.height=(d.getPageSize().y-87)+"px"}else{d.RetrieveElement("content").style.height=(d.getPageSize().y-57)+"px"}}var o=d.RetrieveElementByClassName("accordionHeader");if(d.onWinEnv()){if(o&&d.RetrieveElement("configPanel").offsetWidth>30){for(var n=0;n<o.length;n++){o[n].style.width=d.RetrieveElement("configPanel").offsetWidth+"px"}}}else{d.RetrieveElement("configPanel").style.width="100%";if(o){for(var n=0;n<o.length;n++){o[n].style.width="100%"}}}d.RetrieveElement("hybridLabel").parentNode.style.paddingLeft=65-d.RetrieveElement("hybridLabel").offsetWidth+"px";d.RetrieveElement("completeLabel").parentNode.style.paddingLeft=75-d.RetrieveElement("completeLabel").offsetWidth+"px";d.RetrieveElement("partialLabel").parentNode.style.paddingLeft=85-d.RetrieveElement("partialLabel").offsetWidth+"px";k.RefreshPanel();d.setAlwaysDiagnosed();d.CheckRulesConsistency()}this.checkInvalidKeyInFeatures()},LoadPanel:function(){var u=new a();var y=u.getWidget().createElement("div");var m=u.getAction();y.id="configPanel";y.className="ShowConfigPanel";var n="HideAttr";if(!d.onWinEnv()){n="ShowAttr"}var s='<div id="content" style="max-width:'+d.getPageSize().x+'px" class="'+n+'"></div><div id="footer"><div id="MustSelectFeatureDiv" style="padding-top:12px; display:inline-block; width:26px; height:25px;"><img src="'+c.getWebappsAssetUrl("ConfiguratorWebView","icons/ExclamationMark.png")+'"/></div><a id="nbMustSelectFeature" style="vertical-align:top; padding-top:5px;">0</a><div id="DivConflictOnFooter" style="padding-top:12px; display:inline-block; width:23px; height:25px;"><img id="iconConflictOnFooter" src="'+d.getImgPath("chosenInConflict")+'" style="opacity:0;"/></div><a id="nbConflictOnFooter" style="opacity:0; vertical-align:top; padding-top:5px;">0</a><div style="float:right;"><div style="width:1px; display:inline-block; vertical-align:top; margin-top:2px;"><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="hybridLabel" style="visibility:hidden; color:rgb(49, 87, 132)">'+e.i18n("Hybrid")+'</a></li><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="completeLabel" style="background-color:rgb(49, 87, 132); visibility:hidden; color:white; padding-left:2px; padding-right:2px;">'+e.i18n("Complete")+'</a></li><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="partialLabel" style="visibility:hidden; color:rgb(49, 87, 132)">'+e.i18n("Partial")+'</a></li></div><img id="productStateIcon" />';if(d.onWinEnv()){s=s+'<div style="display:inline-block; vertical-align:top; padding-right:20px;"><li id="RefineButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="RefineIcon" style="width:20px; height:14px; padding-right:5px;"/>'+e.i18n("Refine")+'</li><li id="BuildButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="BuildIcon" style="width:20px; height:14px; padding-right:5px;"/>'+e.i18n("Build")+"</li></div>"}else{if(!d.onWinEnv()&&d.isRefineModeEnabled()){s=s+'<div style="display:inline-block; vertical-align:top; padding-right:20px;"><li id="RefineButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="RefineIcon" style="width:20px; height:14px; padding-right:5px;" src="'+d.getImgPath("refine")+'"/>'+e.i18n("Refine")+'</li><li id="BuildButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="BuildIcon" style="width:20px; height:14px; padding-right:5px;" src="'+d.getImgPath("build")+'"/>'+e.i18n("Build")+"</li></div>"}}s=s+'<div style="display:inline-block; vertical-align:top; padding-top:12px; padding-right:5px;"><img id="multiSelIcon" style="width:30px; height:30px; padding-right:5px;"/><img id="filterIcon" style="width:30px; height:30px;"/><img id="selectLevelIcon" src='+d.getImgPath("selectLevel")+' style="width:24px; height:30px; vertical-align:top;"/></div></div></div></div>';var z=false;if(d.onWinEnv()){var t=window.location.search.substring(1);var o=t.split("&");for(var A=0;A<o.length;A++){var B=o[A].split("=");if(B[0]=="debugTool"){if(B[1]=="true"){z=true}break}}}else{if(window.sessionStorage.DS_ConfiguratorCookie_DebugActivated=="true"){z=true}}if(z){s+="<div id='popupDebug'><div id='popupDebugTitle'>Configurator Debug</div><div id='dumpMessagesDiv'><div id='dumpMessagesTitleDiv'>Dump Solver messages</div><div id='popupDebugPath'>Folder path : </div><input id='debugInputPath' class='inputDebug'></input><br><input id='debugCheckbox' type='checkbox'>Including Solver internal replays</input><br><button id='buttonDebugStart'>Start Dump</button><button id='buttonDebugStop'>Stop Dump</button></div><div>"}y.innerHTML=s;var C=u.getWidget().createElement("div");C.id="prodStatesContainer";C.className="prodStatesContainer";var v=u.getWidget().createElement("div");v.id="prodStatePanel";v.addContent(C);var r=u.getDictionary();var p=k.prodStatesExists(r);var D=d.RetrieveElement("topPanel");if(p){var x=new h({className:"accordionHeader"});x.addItem("productStates",{text:e.i18n("Product States")});x.setContent("productStates",v);D.addContent(x);x.addEvent("onChange",function(){var E=0;if(d.RetrieveElement("priceInfoPanel")){E=23}d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px";if(d.RetrieveElement("div_features_table")){d.RetrieveElement("div_features_table").style.height=(d.RetrieveElement("content").style.height.replace("px","")-33-E)+"px"}});var q=new h({className:"accordionHeader"});q.addItem("configFeatures",{text:e.i18n("Configuration Features")});q.setContent("configFeatures",y);D.addContent(q);u.setAccordConfigurationFeature(q);k.showTree(p);x.toggleItem("productStates")}else{if(!d.RetrieveElement("configFeatures")){var q=new h({className:"accordionHeader"});q.addItem("configFeatures",{text:e.i18n("Configuration Features")});q.setContent("configFeatures",y);D.addContent(q);q.toggleItem("configFeatures")}if(!d.onWinEnv()){d.RetrieveElementByClassName("uwa-accordion-item-title")[0].style.display="none"}}d.RetrieveElement("hybridLabel").parentNode.style.paddingLeft=65-d.RetrieveElement("hybridLabel").offsetWidth+"px";d.RetrieveElement("completeLabel").parentNode.style.paddingLeft=75-d.RetrieveElement("completeLabel").offsetWidth+"px";d.RetrieveElement("partialLabel").parentNode.style.paddingLeft=85-d.RetrieveElement("partialLabel").offsetWidth+"px";u.getWidget().body.style.padding=0;if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px"}else{if(d.onWinEnv()){d.RetrieveElement("content").style.height=(d.getPageSize().y-87)+"px"}else{d.RetrieveElement("content").style.height=(d.getPageSize().y-57)+"px"}}if(d.onWinEnv()||d.isRefineModeEnabled()){d.addEvent("click",d.RetrieveElement("RefineButton"),function(){k.RefineBuildIconCallback(this)});d.addEvent("click",d.RetrieveElement("BuildButton"),function(){k.RefineBuildIconCallback(this)})}if((!d.onWinEnv()&&"view"!=m.toLowerCase())||d.onWinEnv()){d.addEvent("click",d.RetrieveElement("multiSelIcon"),function(){k.multiSelIconCallback()});d.addEvent("click",d.RetrieveElement("filterIcon"),function(){k.filterIconCallback()});d.addEvent("click",d.RetrieveElement("selectLevelIcon"),function(){k.createFilterPanel()})}d.addEvent("mousedown",d.RetrieveElement("configPanel"),function(E){k.removePanelsOnClick(E)});var w=document.getElementById("popupDebugTitle");if(w){d.addEvent("mousedown",w,k.debugClickDown);d.addEvent("mouseup",w,k.debugClickUp);d.addEvent("click",d.RetrieveElement("buttonDebugStart"),k.debugStartBtnCbk);d.addEvent("click",d.RetrieveElement("buttonDebugStop"),k.debugStopBtnCbk)}window.onbeforeunload=function(E){if((!d.onWinEnv()&&"create"==m.toLowerCase())||d.onWinEnv()){window.localStorage.setItem("DS_ConfiguratorCookie_AppRulesParam",JSON.stringify(u.getAppRulesParam()));window.localStorage.setItem("DS_ConfiguratorCookie_AppState",JSON.stringify(u.getApplicationState()))}}},setAction:function(m){var n=new a();if(m){n.setAction(m)}},getAction:function(){var m=new a();return m.getAction()},GetXMLExpressionForSaveCommand:function(){var q=new a();var n=new g("FilterExpression");var v={configurationCriteria:q.getConfigurationCriteria(),dictionary:q.getDictionary(),app_RulesParam:q.getAppRulesParam(),app_Func:q.getAppFunc(),evolutionCriteria:q.getEvolutionCriteria()};var p=n.json2xml_str(v);var m;var r;var u;var o;var t;if(q.getmultiSelect()=="true"){m=true}else{m=false}if(q.getRulesActivation()=="true"){r=true}else{r=false}if(q.getRulesMode()=="RulesMode_EnforceRequiredOptions"){u="RulesMode_EnforceRequiredOptions"}else{if(q.getRulesMode()=="RulesMode_DisableIncompatibleOptions"){u="RulesMode_DisableIncompatibleOptions"}else{if(q.getRulesMode()=="RulesMode_ProposeOptimizedConfiguration"){u="RulesMode_ProposeOptimizedConfiguration"}else{if(q.getRulesMode()=="RulesMode_SelectCompleteConfiguration"){u="RulesMode_SelectCompleteConfiguration"}}}}t=q.getCompletenessStatus();o=q.getRulesCompliancyStatus();var s="MultiSelectionAllowed:"+m;s+=";EvaluateRules:"+r;s+=";RuleEvaluationMode:"+u;s+=";RulesCompliancyStatus:"+o;s+=";CompletenessStatus:"+t;if(q.getEvolutionCriteria().productState){s+=";pStateNameAndRev:"+q.getEvolutionCriteria().productState.name+q.getEvolutionCriteria().productState.revision}else{s+=";pStateNameAndRev:null"}s+=";XMLForSaveCommand:"+p;if(p){d.send_notif(s)}return s},setConfigurationCriteriaXML:function(p){var o=new g("FilterExpression");var m=o.xmlToJson(o.parseXml(p));var q=new a();d.RemovePanels();if(m.CfgFilterExpression.FilterSelection.TreeSeries&&d.RetrieveElement("prodStatesContainer")){var n=m.CfgFilterExpression.FilterSelection.TreeSeries.Single.attributes.Name;var r=m.CfgFilterExpression.FilterSelection.TreeSeries.Single.attributes.Revision;k.selectProductState(n,r)}else{if(m.CfgFilterExpression.FilterSelection.Context&&m.CfgFilterExpression.FilterSelection.Context.TreeSeries&&d.RetrieveElement("prodStatesContainer")){var n=m.CfgFilterExpression.FilterSelection.Context.TreeSeries.Single.attributes.Name;var r=m.CfgFilterExpression.FilterSelection.Context.TreeSeries.Single.attributes.Revision;k.selectProductState(n,r)}}d.setConfCriteriaFromXMLVar(p)}};return e.namespace("DS/ConfiguratorWebView/ConfigurationServices",f)});var UIKitDatePickerPath=function(){var c=window.location.search.substring(1);var b=c.split("&");for(var a=0;a<b.length;a++){var d=b[a].split("=");if(d[0]=="onWinEnv"){if(d[1]=="true"){return""}else{return"DS/UIKIT/DatePicker"}}}return"DS/UIKIT/DatePicker"}();define("DS/ConfiguratorWebView/PanelController",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/Utilities",UIKitDatePickerPath,"DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView","DS/ConfiguratorWebExternal/PSTreeLib"],function(g,f,d,b,e,c){var a={RefineBuildIconCallback:function(l){var k=new f();var m=k.getConfigurationMode();var n=k.getDictionary().features;if(l.id=="RefineButton"&&m!="selectionMode_Refine"&&k.getAppFunc().selectionMode_Refine=="yes"){k.setConfigurationMode("selectionMode_Refine")}else{if(l.id=="BuildButton"&&m!="selectionMode_Build"&&k.getAppFunc().selectionMode_Build=="yes"){k.setConfigurationMode("selectionMode_Build");for(var h=0;h<n.length;h++){d.RemoveAllSpecifiedStateOccurrenceInFeature(n[h].ruleId,"dismissed");d.RemoveAllSpecifiedStateOccurrenceInFeature(n[h].ruleId,"dismissedInConflict")}}}if(k.getRulesActivation()=="true"){d.CallSolveMethodOnSolver()}else{a.updateFeatures(false)}this.updateRefineBuildIcons()},RefreshPanel:function(){this.setFeatures();this.updateMultiSelIcon(true);this.updateFilterIcon(false,false);this.updateRefineBuildIcons()},updateRefineBuildIcons:function(){var m=new f();var o=m.getConfigurationMode();var h=d.RetrieveElement("BuildIcon");var k=d.RetrieveElement("RefineIcon");if((o=="selectionMode_Build"&&m.getAppFunc().selectionMode_Build=="yes")||(o=="selectionMode_Refine"&&m.getAppFunc().selectionMode_Refine=="no"&&m.getAppFunc().selectionMode_Build=="yes")){h.src=d.getImgPath("buildSelected");k.src=d.getImgPath("refine");m.setConfigurationMode("selectionMode_Build");var n=d.RetrieveElementByClassName("featureInput");for(var l=0;l<n.length;l++){n[l].placeholder=g.i18n("None")}this.RemoveIncludedStateOnBuildMode();this.updateCompletenessIcon();if(d.onWinEnv()){d.sendXMLtoNativeEnv()}}else{if((o=="selectionMode_Refine"&&m.getAppFunc().selectionMode_Refine=="yes")||(o=="selectionMode_Build"&&m.getAppFunc().selectionMode_Build=="no"&&m.getAppFunc().selectionMode_Refine=="yes")){h.src=d.getImgPath("build");k.src=d.getImgPath("refineSelected");m.setConfigurationMode("selectionMode_Refine");var n=d.RetrieveElementByClassName("featureInput");for(var l=0;l<n.length;l++){if(m.getRulesActivation()=="true"){n[l].placeholder=g.i18n("All compatibles")}else{if(m.getRulesActivation()=="false"){n[l].placeholder=g.i18n("All")}}}this.AddIncludedStateOnRefineMode();this.updateCompletenessIcon();if(d.onWinEnv()){d.sendXMLtoNativeEnv()}}else{h.src=d.getImgPath("build");k.src=d.getImgPath("refine")}}},multiSelIconCallback:function(){var l=new f();var n=false;if(l.getmultiSelect()=="false"&&l.getAppFunc().multiSelection=="yes"){l.setmultiSelect("true")}else{if(l.getmultiSelect()=="true"){if(d.DetectMultiSelOnSingleFeatures()){var h=d.ResetMultiSelOnSingleFeatures();l.setmultiSelect("false");n=true;d.deleteInfoBox();if(h.length>0){var m=g.i18n("InfoUnsettingMultiSelection")+"<br>";for(var k=0;k<h.length;k++){m+="<blocquote style='padding-left:20px;'>"+d.getFeatureDisplayNameWithId(h[k])+"<br></blocquote>"}d.showInfoBox(m,"warning")}}else{l.setmultiSelect("false")}}}a.updateFeatures(false);if(d.RetrieveElement("myfeatureOptions")){a.updateOptionsPanel()}this.updateMultiSelIcon(false)},updateMultiSelIcon:function(n){var m=d.RetrieveElement("multiSelIcon");var k=new f();var l=k.getAction();if(k.getAppFunc().multiSelection=="no"){k.setmultiSelect("false")}if(k.getmultiSelect()=="true"){m.src=d.getImgPath("multiSelectionSelected");m.title=g.i18n("Multi-Selection")+": "+g.i18n("enabled");this.SetMultiSelOnSolver(true,n);if(k.getRulesActivation()=="true"&&k._showWarningInfoBox==true){if((!d.onWinEnv()&&"view"!=l.toLowerCase())||d.onWinEnv()){d.showInfoBox(g.i18n("InfoMultiSelAndRules"),"info")}}}else{if(k.getmultiSelect()=="false"){m.src=d.getImgPath("multiSelection");m.title=g.i18n("Multi-Selection")+": "+g.i18n("disabled");this.SetMultiSelOnSolver(false,n);var h=d.RetrieveElement("InfoBox")}}},filterIconCallback:function(){var h=new f();if(h.getRulesActivation()=="false"){if(h.getRulesConsistency()!=false){h.setRulesActivation("true");this.updateFilterIcon()}}else{if(h.getRulesActivation()=="true"){h.setRulesActivation("false");h.setRulesCompliancyStatus("Unknown");this.updateFilterIcon()}}},updateFilterIcon:function(s,q){var k=d.RetrieveElement("filterIcon");var o=new f();var l=o.getAction();var h;if(o.getRulesActivation()=="false"){if(o.getRulesMode()=="RulesMode_ProposeOptimizedConfiguration"){k.src=d.getImgPath("optim");k.title=g.i18n("Rules")+": "+g.i18n("disabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Propose optimized configuration on List Price")}else{if(o.getRulesMode()=="RulesMode_SelectCompleteConfiguration"){k.src=d.getImgPath("completeConfMode");k.title=g.i18n("Rules")+": "+g.i18n("disabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Select complete configuration")}else{if(o.getRulesMode()=="RulesMode_EnforceRequiredOptions"){k.src=d.getImgPath("dependencies");k.title=g.i18n("Rules")+": "+g.i18n("disabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Enforce required options and select defaults")}else{if(o.getRulesMode()=="RulesMode_DisableIncompatibleOptions"){k.src=d.getImgPath("incompatibilities");k.title=g.i18n("Rules")+": "+g.i18n("disabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Disable incompatible options")}}}}var m=d.RetrieveElement("InfoBox")}else{if(o.getRulesActivation()=="true"){if(o.getRulesMode()=="RulesMode_ProposeOptimizedConfiguration"&&o.getAppFunc().rulesMode_ProposeOptimizedConfiguration=="yes"){k.src=d.getImgPath("optimSelected");k.title=g.i18n("Rules")+": "+g.i18n("enabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Propose optimized configuration on List Price");h="Select_OptimalSelection";if(!s&&o.getmultiSelect()=="true"&&o._showWarningInfoBox==true){if((!d.onWinEnv()&&"view"!=l.toLowerCase())||d.onWinEnv()){d.showInfoBox(g.i18n("InfoMultiSelAndRules"),"info")}}d.setOptimizationFunctionOnSolver()}else{if(o.getRulesMode()=="RulesMode_SelectCompleteConfiguration"&&o.getAppFunc().rulesMode_SelectCompleteConfiguration=="yes"){k.src=d.getImgPath("completeConfModeSelected");k.title=g.i18n("Rules")+": "+g.i18n("enabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Select complete configuration");h="Select_ProposedSelection";if(!s&&o.getmultiSelect()=="true"&&o._showWarningInfoBox==true){if((!d.onWinEnv()&&"view"!=l.toLowerCase())||d.onWinEnv()){d.showInfoBox(g.i18n("InfoMultiSelAndRules"),"info")}}}else{if(o.getRulesMode()=="RulesMode_EnforceRequiredOptions"&&o.getAppFunc().rulesMode_EnforceRequiredOptions=="yes"){k.src=d.getImgPath("dependenciesSelected");k.title=g.i18n("Rules")+": "+g.i18n("enabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Enforce required options and select defaults");h="Select_RequiredAndDefault";if(!s&&o.getmultiSelect()=="true"&&o._showWarningInfoBox==true){if((!d.onWinEnv()&&"view"!=l.toLowerCase())||d.onWinEnv()){d.showInfoBox(g.i18n("InfoMultiSelAndRules"),"info")}}}else{if(o.getRulesMode()=="RulesMode_DisableIncompatibleOptions"&&o.getAppFunc().rulesMode_DisableIncompatibleOptions=="yes"){k.src=d.getImgPath("incompatibilitiesSelected");k.title=g.i18n("Rules")+": "+g.i18n("enabled")+"\n"+g.i18n("Rules assistance level")+": "+g.i18n("Disable incompatible options");h="Select_None";if(!s&&o.getmultiSelect()=="true"&&o._showWarningInfoBox==true){if((!d.onWinEnv()&&"view"!=l.toLowerCase())||d.onWinEnv()){d.showInfoBox(g.i18n("InfoMultiSelAndRules"),"info")}}}else{o.setRulesActivation("false")}}}}if(h){d.setSelectionModeOnSolver(h,q)}}}k.style.opacity="1";if(o.getRulesConsistency()==false){k.style.opacity="0.3"}if(o.getRulesActivation()!="true"){var p=o.getDictionary().features;for(var n=0;n<p.length;n++){d.RemoveAllSpecifiedStateOccurrenceInFeature(p[n].ruleId,"required");d.RemoveAllSpecifiedStateOccurrenceInFeature(p[n].ruleId,"incompatible");d.RemoveAllSpecifiedStateOccurrenceInFeature(p[n].ruleId,"recommanded");d.RemoveAllSpecifiedStateOccurrenceInFeature(p[n].ruleId,"default")}var r=o.getConfigurationCriteria();for(var n=0;n<r.length;n++){if(r[n].State=="dismissedInConflict"){o.setStateWithId(r[n].Id,"dismissed")}else{if(r[n].State=="chosenInConflict"){o.setStateWithId(r[n].Id,"chosen")}else{if(r[n].State=="defaultInConflict"){o.setStateWithId(r[n].Id,"default")}}}}this.updateFeatures(false);if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}}},changeFilterIcon:function(h){var l=d.RetrieveElement(h);var k=new f();k.setRulesMode(l.id);this.updateFilterIcon(true);if(d.RetrieveElement("filterPanel")){d.RemoveElement("filterPanel")}},AttrButtonCallback:function(){var r=d.RetrieveElement("content");var o=d.RetrieveElement("ArrowAttrImg");var s,m;var t;var p;var l=false;if(r.className=="ShowAttr"){if(d.RetrieveElement("InfoBox")&&d.RetrieveElement("InfoBox").value=="InfoBoxVisible"){t=d.RetrieveElement("TextInfoBox").innerHTML;p=d.RetrieveElement("IconInfoBox").value;d.deleteInfoBox();l=true}else{if(d.RetrieveElement("InfoBox")){d.deleteInfoBox(t)}}s=d.RetrieveElementByTags("td");for(var n=0;n<s.length;n++){if(s[n].className=="featureAttr"){s[n].style.display="none"}}d.RetrieveElement("tableAttrTitle").style.display="none";o.src=d.getImgPath("rightArrow");r.className="HideAttr";if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px";d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px"}var h=d.RetrieveElement("content").scrollWidth+"px";var k=d.RetrieveElementByClassName("accordionHeader");for(var n=0;n<k.length;n++){k[n].style.width="";k[n].style.width=h}if(!d.onWinEnv()){d.resizeWindow(false)}}else{if(r.className=="HideAttr"){s=d.RetrieveElementByTags("td");for(var n=0;n<s.length;n++){if(s[n].className=="featureAttr"){s[n].style.display="inline-block"}}d.RetrieveElement("tableAttrTitle").style.display="inline-block";d.SetSizeOfAttributsCellsTable(d.RetrieveElement("tableAttr"),d.RetrieveElement("tableAttrTitle"),d.RetrieveElement("div_features_table"));o.src=d.getImgPath("leftArrow");r.className="ShowAttr";if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px";d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px"}var h=d.RetrieveElement("content").scrollWidth+"px";var k=d.RetrieveElementByClassName("accordionHeader");for(var n=0;n<k.length;n++){k[n].style.width="";k[n].style.width=h}if(d.RetrieveElement("InfoBox")&&d.RetrieveElement("InfoBox").value=="InfoBoxVisible"){t=d.RetrieveElement("TextInfoBox").innerHTML;p=d.RetrieveElement("IconInfoBox").value;d.showInfoBox(t,p)}if(!d.onWinEnv()){d.resizeWindow(true)}}}var q=d.RetrieveElementByClassName("accordionHeader");if(q&&d.RetrieveElement("configPanel").offsetWidth>30){for(var n=0;n<q.length;n++){q[n].style.width="";q[n].style.width=d.RetrieveElement("configPanel").offsetWidth+"px"}}if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px"}if(l){d.showInfoBox(t,p)}if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},ShowHidePanelCallback:function(){var h=d.RetrieveElement("configPanel");if(h.className=="ShowConfigPanel"){h.className="HideConfigPanel";d.RetrieveElement("ArrowPanelImg").src=d.getImgPath("rightArrow");d.RemovePanels()}else{if(h.className=="HideConfigPanel"){h.className="ShowConfigPanel";d.RetrieveElement("ArrowPanelImg").src=d.getImgPath("leftArrow")}}},removePanelsOnClick:function(k){if(k.stopPropagation){k.stopPropagation()}else{k.cancelBubble=true}var h=(k.currentTarget)?k.currentTarget:k.srcElement;if((h.className&&h.className!=="featureInput")){d.RemovePanels()}},updateSearchResult:function(r,o,l){var u=r.value;var B=d.RetrieveElement(o);var h=d.RetrieveElement(l);var x,w,v;var z;var s=new f();var p;var m=h.rows.length;for(x=0;x<m;x++){h.deleteRow(0)}var y=d.RetrieveElementByClassName("selected");var A="";var n;B.style.border="none";if(u!=""){r.className="NonEmptyInput";for(x=0;x<B.rows.length;x++){p=s.getStateWithId(B.rows[x].id.split("_")[1]);if(p!="incompatibleFeature"||(p=="incompatibleFeature"&&d.isIncompatibleWithUserSelection(B.rows[x].id.split("_")[1]))){B.rows[x].style.display="table-row"}n=false;if(!d.onWinEnv()&&B.rows[x].cells[0].id=="keyInOption"){continue}if(y.length>0){for(w=0;w<y.length;w++){A="";if(y[w].id.split("_")[0]=="FeatureAttrLabel"&&o=="tableAttr"){for(v=1;v<B.rows[x].cells.length;v++){if(B.rows[x].cells[v].id=="featureAttrId_"+y[w].id.split("_")[1]){if(B.rows[x].cells[v].firstChild.title!=""){A=B.rows[x].cells[v].firstChild.title}else{A=B.rows[x].cells[v].firstChild.textContent}}if(((A.toUpperCase()).indexOf(u.toUpperCase())==-1)){n=true}else{n=false}}}else{if(y[w].id.split("_")[0]=="OptionAttrLabel"&&o=="tableOptionsAttr"){for(v=1;v<B.rows[x].cells.length;v++){if(B.rows[x].cells[v].id=="attrId_"+y[w].id.split("_")[1]){if(B.rows[x].cells[v].firstChild.title!=""){A=B.rows[x].cells[v].firstChild.title}else{A=B.rows[x].cells[v].firstChild.textContent}}if(((A.toUpperCase()).indexOf(u.toUpperCase())==-1)){n=true}else{n=false}}}else{n=true}}}if(B.rows[x].cells[0].children[0].children[0].children[0]){z=B.rows[x].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase()}else{if(B.rows[x].cells[0].children[1].children[1].title!=""){z=B.rows[x].cells[0].children[1].children[1].title.toUpperCase()}else{z=B.rows[x].cells[0].children[1].children[1].textContent.toUpperCase()}}if((z.indexOf(u.toUpperCase())==-1)&&n==true){var t=B.rows[x].cloneNode(true);h.appendChild(t);B.rows[x].style.display="none";var q=h.rows.length;h.rows[q-1].cells[0].style.width=B.rows[0].cells[0].style.width;if(h.id=="ResultSearchOptions"){h.rows[q-1].cells[0].childNodes[1].className="disabled"}else{h.rows[q-1].cells[0].firstChild.disabled="disabled";h.rows[q-1].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value=B.rows[x].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value}B.style.borderBottom="1px solid black";h.rows[q-1].style.opacity=0.4}}else{if(B.rows[x].cells[0].children[0].children[0].children[0]){z=B.rows[x].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase()}else{z=B.rows[x].cells[0].textContent.toUpperCase()}if(((B.rows[x].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase()).indexOf(u.toUpperCase())==-1)){var t=B.rows[x].cloneNode(true);h.appendChild(t);B.rows[x].style.display="none";var q=h.rows.length;h.rows[q-1].cells[0].style.width=B.rows[0].cells[0].style.width;if(h.id=="ResultSearchOptions"){h.rows[q-1].cells[0].childNodes[1].className="disabled"}else{h.rows[q-1].cells[0].firstChild.disabled="disabled";h.rows[q-1].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value=B.rows[x].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value}B.style.borderBottom="1px solid black";h.rows[q-1].style.opacity=0.4}}}}if(u==""){r.className="EmptyInput";for(x=0;x<B.rows.length;x++){p=s.getStateWithId(B.rows[x].id.split("_")[1]);if(p!="incompatibleFeature"||(p=="incompatibleFeature"&&d.isIncompatibleWithUserSelection(B.rows[x].id.split("_")[1]))){B.rows[x].style.display="table-row"}}}},updateCheckReject:function(l){var k=new f();var h=l.parentNode.parentNode.value;if(l.id=="checkIcon"){k.setRefineSelectionModeForSpecifiedFeature(h,"select");d.RemoveAllSpecifiedStateOccurrenceInFeature(h,"dismissed");d.RemoveAllSpecifiedStateOccurrenceInFeature(h,"dismissedInConflict")}if(l.id=="rejectIcon"){k.setRefineSelectionModeForSpecifiedFeature(h,"reject");d.RemoveAllSpecifiedStateOccurrenceInFeature(h,"chosen");d.RemoveAllSpecifiedStateOccurrenceInFeature(h,"chosenInConflict")}if(k.getRulesActivation()=="true"){d.CallSolveMethodOnSolver()}else{a.updateFeatures(false);if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}}this.updateCheckRejectIcon()},updateCheckRejectIcon:function(){var m=new f();var h=d.RetrieveElement("checkIcon");var k=d.RetrieveElement("rejectIcon");var l=h.parentNode.parentNode.value;if(m.getRefineSelectionModeForSpecifiedFeature(l)=="select"){h.src=d.getImgPath("checkIconSelected");k.src=d.getImgPath("rejectIcon")}else{if(m.getRefineSelectionModeForSpecifiedFeature(l)=="reject"){h.src=d.getImgPath("checkIcon");k.src=d.getImgPath("rejectIconSelected")}}},updateFeatureState:function(v){var t=new f();var s=t.getDictionary().features;var l;var n=[];var o;var m=false;var p;var y=1;var u=false;if(t.getStateWithId(v)=="incompatibleFeature"&&!d.isIncompatibleWithUserSelection(v)){d.RetrieveElement("LineFeature_"+v).style.display="none";return}if(t.getCacheOrderableState()[v]==false){d.RetrieveElement("LineFeature_"+v).style.display="none";t.setStateWithId(v,"incompatibleFeature");return}for(var z=0;z<s.length;z++){if(s[z].ruleId==v){m=false;for(var x=0;x<s[z].options.length;x++){o=t.getStateWithId(s[z].options[x].ruleId);if((o=="chosen"||o=="chosenInConflict"||o=="defaultInConflict"||o=="default"||o=="required")&&!d.DetectMultiSelOnFeature(s[z].name)&&s[z].options[x].image!=""){d.RetrieveElement("imageFeature"+s[z].ruleId).src=s[z].options[x].image;m=true;if(o=="chosenInConflict"||o=="defaultInConflict"){p=s[z].options[x].ruleId}}else{if(!m){if(s[z].image!=""){d.RetrieveElement("imageFeature"+s[z].ruleId).src=s[z].image}else{d.RetrieveElement("imageFeature"+s[z].ruleId).src=d.getImgPath("defaultFeatureImage")}}}if(o&&(o!="available"&&o!="included"&&o!="incompatible")&&!((o==="dismissed"||o==="dismissedInConflict")&&t.getConfigurationMode()==="selectionMode_Build")){if(d.RetrieveElement("input"+v).value.indexOf(s[z].options[x].displayName)==-1){if(d.RetrieveElement("input"+v).value!=""){d.RetrieveElement("input"+v).rows++}if(o=="dismissed"||o=="dismissedInConflict"){d.RetrieveElement("input"+v).value+="Except "}d.RetrieveElement("input"+v).value+=d.htmlDecode(s[z].options[x].displayName)+"\n"}y++}if(n.indexOf(t.getStateWithId(s[z].options[x].ruleId))==-1){n.push(t.getStateWithId(s[z].options[x].ruleId))}}d.RetrieveElement("LineFeature_"+s[z].ruleId).style.display="table-row";if(!d.onWinEnv()&&s[z].keyInType&&s[z].keyInType!="Blank"){var r="";var h=t.getStateWithId("KeyIn_"+v);if(h&&(h!="available"&&h!="included"&&h!="incompatible")&&!((h==="dismissed"||h==="dismissedInConflict")&&t.getConfigurationMode()==="selectionMode_Build")){r=t.getKeyInValueById("KeyIn_"+v);var A=null;if(s[z].keyInType=="Date"){A=t.getDateKeyInDisplayValueById("KeyIn_"+v);if(!A){var q=new Date(parseInt(r));if(!isNaN(Date.parse(q.toString()))){var w={year:"numeric",month:"short",day:"numeric"};A=q.toLocaleDateString(navigator.language,w);t.setDateKeyInDisplayValueById("KeyIn_"+v,A)}}r=A}}if(r){u=true}if(u){if(s[z].image!=""){d.RetrieveElement("imageFeature"+s[z].ruleId).src=s[z].image}else{d.RetrieveElement("imageFeature"+s[z].ruleId).src=d.getImgPath("defaultFeatureImage")}}r=d.getElipsisValue(r);var k=d.RetrieveElement("input"+v).value.split("\n");if(k.length==y){k[y-1]=r;d.RetrieveElement("input"+v).rows=y;d.RetrieveElement("input"+v).value=k.join("\n");if(r==""&&d.RetrieveElement("input"+v).value!=""){d.RetrieveElement("input"+v).rows--}}else{d.RetrieveElement("input"+v).value+=r}if(n.indexOf(t.getStateWithId("KeyIn_"+v))==-1){n.push(t.getStateWithId("KeyIn_"+v))}}if(n.indexOf("chosenInConflict")!=-1){l="chosenInConflict"}else{if(n.indexOf("defaultInConflict")!=-1){l="defaultInConflict"}else{if((n.indexOf("dismissedInConflict")!=-1)){l="dismissedInConflict"}else{if(n.indexOf("chosen")!=-1&&u){l="keyIn"}else{if(n.indexOf("chosen")!=-1){l="chosen"}else{if((n.indexOf("dismissed")!=-1)&&t.getConfigurationMode()==="selectionMode_Refine"){l="dismissedFeature"}else{if(n.indexOf("default")!=-1){l="default"}else{if(n.indexOf("required")!=-1){l="requiredByRules"}else{if(n.indexOf("recommanded")!=-1){l="recommanded"}else{if((n.indexOf("incompatible")!=-1)||(n.indexOf("included")!=-1&&n.indexOf("dismissed")==-1)){if(s[z].selectionCriteria&&s[z].selectionCriteria.toUpperCase()=="MAY"&&t.getStateWithId(v)!="requiredFeature"){l="maySelectFeature"}else{l="mustSelectFeature"}}else{if(s[z].selectionCriteria&&s[z].selectionCriteria.toUpperCase()=="MAY"&&t.getStateWithId(v)!="requiredFeature"){l="maySelectFeature"}else{l="mustSelectFeature"}}}}}}}}}}}d.RetrieveElement("iconFeature"+s[z].ruleId).src=d.getImgPath(l);t.setStateWithId(s[z].ruleId,l);if(l=="chosenInConflict"||l=="dismissedInConflict"||l=="defaultInConflict"){d.RetrieveElement("divImageFeature"+s[z].ruleId).style.border="2px solid rgb(204, 87, 103)";d.RetrieveElement("divImageFeature"+s[z].ruleId).style.opacity="1"}else{if(l=="chosen"||l=="keyIn"||l=="dismissedFeature"||l=="recommanded"||l=="default"||l=="requiredByRules"){d.RetrieveElement("divImageFeature"+s[z].ruleId).style.border="2px solid rgb(49, 87, 132)";d.RetrieveElement("divImageFeature"+s[z].ruleId).style.opacity="1"}else{d.RetrieveElement("divImageFeature"+s[z].ruleId).style.border="2px solid rgba(150, 150, 150, 0.5)";d.RetrieveElement("divImageFeature"+s[z].ruleId).style.opacity="0.5";if(s[z].image!=""){d.RetrieveElement("imageFeature"+s[z].ruleId).src=s[z].image}else{d.RetrieveElement("imageFeature"+s[z].ruleId).src=d.getImgPath("defaultFeatureImage")}}}this.updateListPriceAttribute(v);break}}this.updateTotalPrice()},updateListPriceAttribute:function(r){var p=new f();var q=p.getDictionary().features;for(var n=0;n<q.length;n++){if(q[n].ruleId==r){var s=0;for(var m=0;m<q[n].options.length;m++){if(q[n].options[m].listPrice!="0.0"){p.setPriceById(q[n].options[m].ruleId,q[n].options[m].listPrice)}var h=p.getStateWithId(q[n].options[m].ruleId);if(h=="chosen"||h=="chosenInConflict"||h=="defaultInConflict"||h=="default"||h=="required"||h=="recommanded"){var o=q[n].options[m].listPrice;if(o){o=parseFloat(o);if(o!="NaN"){s+=o}}}}if(!d.onWinEnv()&&q[n].keyInType&&q[n].keyInType!="Blank"){var l=p.getStateWithId("KeyIn_"+r);if(l=="chosen"||l=="chosenInConflict"){var o=q[n].listPrice;if(o){o=parseFloat(o);if(o!="NaN"){s+=o}}}}if(d.RetrieveElement("LineFeature_"+r)){if(d.RetrieveElement("LineFeature_"+r).cells.namedItem("featureAttrId_List Price")){var k="-";if(s>0){k=parseFloat(s).toFixed(1)}var t="title='"+k+"' ";d.RetrieveElement("LineFeature_"+r).cells.namedItem("featureAttrId_List Price").firstChild.innerHTML=k}}p.setPriceById(r,s)}}},updateTotalPrice:function(){var l=new f();var p=l.getDictionary().features;var h=l.getDictionary().basePrice;if(h&&parseFloat(h)!="NaN"){h=parseFloat(h)}else{h=0}var n=h;for(var k=0;k<p.length;k++){var m=l.getPriceById(p[k].ruleId);if(m){m=parseFloat(m);if(m!="NaN"){n+=m}}}if(d.RetrieveElement("totalPriceValue")){var o=parseFloat(n).toFixed(1);l.setTotalPrice(o);d.RetrieveElement("totalPriceValue").textContent=o}},updateConflictingFeatures:function(){var m=new f();var k=m.getConfigurationCriteria();var h=0;for(var l=0;l<k.length;l++){if((k[l].State=="chosenInConflict"||k[l].State=="dismissedInConflict"||k[l].State=="defaultInConflict")&&m.isAFeature(k[l].Id)){h++}}d.RetrieveElement("nbConflictOnFooter").innerHTML=h;d.RetrieveElement("DivConflictOnFooter").title=h+" "+g.i18n("features have conflicting selections");if(h>0){d.RetrieveElement("iconConflictOnFooter").style.opacity=1;d.RetrieveElement("nbConflictOnFooter").style.opacity=1}else{d.RetrieveElement("iconConflictOnFooter").style.opacity=0;d.RetrieveElement("nbConflictOnFooter").style.opacity=0}},updateMustSelectFeatureNumber:function(){var m=new f();var h=m.getConfigurationCriteria();var l=0;for(var k=0;k<h.length;k++){if(h[k].State=="mustSelectFeature"){l++}}m.setMustSelectFeatureNumber(l);d.RetrieveElement("nbMustSelectFeature").innerHTML=l;d.RetrieveElement("MustSelectFeatureDiv").title=l+" "+g.i18n("features are mandatory and not selected");this.updateCompletenessIcon()},updateCompletenessIcon:function(){var r=new f();var m=r.getMustSelectFeatureNumber();var t=r.getDictionary().features;var o=false;var k;var h;var s=new Object();this.AddIncludedStateOnRefineMode();for(var p=0;p<t.length;p++){s[t[p].name]=0;for(var n=0;n<t[p].options.length;n++){h=r.getStateWithId(t[p].options[n].ruleId);if((h=="chosen"||h=="chosenInConflict"||h=="included"||h=="default"||h=="defaultInConflict")&&t[p].selectionType=="Single"){s[t[p].name]=s[t[p].name]+1}}if(!d.onWinEnv()&&t[p].keyInType&&t[p].keyInType!="Blank"){var l=r.getStateWithId("KeyIn_"+t[p].ruleId);if(l=="chosen"||l=="chosenInConflict"){s[t[p].name]=s[t[p].name]+1}}}for(var u in s){var q=s[u];if(q>1){o=true;break}}if(m==0){if(o==false){d.RetrieveElement("productStateIcon").src=d.getImgPath("completeProduct");d.RetrieveElement("hybridLabel").style.visibility="hidden";d.RetrieveElement("completeLabel").style.visibility="visible";d.RetrieveElement("partialLabel").style.visibility="hidden";r.setCompletenessStatus("Complete")}else{d.RetrieveElement("productStateIcon").src=d.getImgPath("hybridProduct");d.RetrieveElement("hybridLabel").style.visibility="visible";d.RetrieveElement("completeLabel").style.visibility="hidden";d.RetrieveElement("partialLabel").style.visibility="hidden";r.setCompletenessStatus("Hybrid")}}else{if(o==true){d.RetrieveElement("productStateIcon").src=d.getImgPath("hybridProduct");d.RetrieveElement("hybridLabel").style.visibility="visible";d.RetrieveElement("completeLabel").style.visibility="hidden";d.RetrieveElement("partialLabel").style.visibility="hidden";r.setCompletenessStatus("Hybrid")}else{d.RetrieveElement("productStateIcon").src=d.getImgPath("partialProduct");d.RetrieveElement("hybridLabel").style.visibility="hidden";d.RetrieveElement("completeLabel").style.visibility="hidden";d.RetrieveElement("partialLabel").style.visibility="visible";r.setCompletenessStatus("Partial")}}},updateOptionState:function(n){if(n.className!="disabled"){var l=new f();var k=n.firstChild.id.split("_")[1];var o=l.getStateWithId(k);if(l.getRefineSelectionModeForSpecifiedFeature(l.getFeatureIdWithOptionId(k))=="select"&&(o=="available"||o=="included"||o==undefined)&&n.className=="enabled"){if(l.getmultiSelect()=="false"){this.SetOptionsAvailableForSingleTypeFeature(d.getFeatureNameWithId(k));d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value=""}n.firstChild.src=d.getImgPath("check");d.RetrieveElement("iconOption_"+k).src=d.getImgPath("chosen");l.setStateWithId(k,"chosen");if(o!="dismissed"){if(d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value!=""){d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).rows++}d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value+=d.htmlDecode(d.getOptionDisplayNameWithId(k))+"\n"}var m=l.getFeatureIdWithOptionId(k);if(l.getmultiSelect()=="false"){if(l.getSelectionTypeForSpecifiedFeature(m)=="Single"){if(d.RetrieveElement("myfeatureOptions")){d.RemoveElement("myfeatureOptions");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}}}}}else{if(l.getRefineSelectionModeForSpecifiedFeature(l.getFeatureIdWithOptionId(k))=="reject"&&(o=="available"||o=="chosen"||o=="included"||o==undefined)&&n.className=="enabled"){if(d.CheckIfDismissedIsPossible(k)){n.firstChild.src=d.getImgPath("dismissed");d.RetrieveElement("iconOption_"+k).src=d.getImgPath("chosen");l.setStateWithId(k,"dismissed");if(o!="chosen"){if(d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value!=""){d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).rows++}d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value+="Except "+d.getOptionDisplayNameWithId(k)+"\n"}}else{return}}else{if(n.className=="enabled"&&(o=="chosen"||o=="chosenInConflict"||o=="dismissed"||o=="dismissedInConflict"||o=="included")){n.firstChild.src=d.getImgPath("available");d.RetrieveElement("iconOption_"+k).src=d.getImgPath("noStateIcon");l.setStateWithId(k,"available");var h=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.indexOf(d.getOptionDisplayNameWithId(k));d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.replace(d.getOptionDisplayNameWithId(k)+"\n","");if(d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value!=""&&h!=-1){d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).rows--}}else{if(n.className=="enabled"&&(o=="recommanded"||o=="default"||o=="defaultInConflict")){n.firstChild.src=d.getImgPath("dismissed");d.RetrieveElement("iconOption_"+k).src=d.getImgPath("chosen");l.setStateWithId(k,"dismissed");var h=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.indexOf(d.getOptionDisplayNameWithId(k));d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.replace(d.getOptionDisplayNameWithId(k)+"\n","");if(d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value!=""&&h!=-1){d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).rows--}}else{if(l.getRefineSelectionModeForSpecifiedFeature(l.getFeatureIdWithOptionId(k))=="select"&&n.className=="enabled"&&o=="dismissed"){n.firstChild.src=d.getImgPath("available");d.RetrieveElement("iconOption_"+k).src=d.getImgPath("noStateIcon");l.setStateWithId(k,"available");var h=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.indexOf(d.getOptionDisplayNameWithId(k));d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value=d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value.replace(d.getOptionDisplayNameWithId(k)+"\n","");if(d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).value!=""&&h!=-1){d.RetrieveElement("input"+l.getFeatureIdWithOptionId(k)).rows--}}}}}}this.updateFeatureState(k);this.updateMustSelectFeatureNumber();this.updateConflictingFeatures();if(l.getRulesActivation()=="true"){if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}d.CallSolveMethodOnSolver()}else{a.updateFeatures(false);if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}}}},OptionAttrButtonCallback:function(){var n=d.RetrieveElement("myfeatureOptions");var h=d.RetrieveElement("ArrowOptionAttrImg");if(d.RetrieveElement("addAttrColumnPanel")){d.RemoveElement("addAttrColumnPanel")}var m,l;if(n.className=="ShowAttr"){m=d.RetrieveElementByTags("td");for(var k=0;k<m.length;k++){if(m[k].className=="attr"){m[k].style.display="none"}h.src=d.getImgPath("rightArrow")}d.RetrieveElement("tableOptionsAttrTitle").style.display="none";n.className="HideAttr";if(d.RetrieveElement("divFeatureOptions").id=="divFeatureOptions"){d.RetrieveElement("divFeatureOptions").style.width=""}}else{if(n.className=="HideAttr"){m=d.RetrieveElementByTags("td");for(var k=0;k<m.length;k++){if(m[k].className=="attr"){m[k].style.display="inline-block"}h.src=d.getImgPath("leftArrow")}d.RetrieveElement("tableOptionsAttrTitle").style.display="inline-block";n.className="ShowAttr";d.SetSizeOfAttributsCellsTable(d.RetrieveElement("tableOptionsAttr"),d.RetrieveElement("tableOptionsAttrTitle"),d.RetrieveElement("divFeatureOptions"));if(d.RetrieveElement("ResultSearchOptions").rows.length>0){d.SetSizeOfAttributsCellsTable(d.RetrieveElement("ResultSearchOptions"),d.RetrieveElement("tableOptionsAttrTitle"),d.RetrieveElement("divFeatureOptions"))}}}if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},DeleteColumn:function(B,p){var C=B.id.split("_");var m;var A;var u=C[1];var z,y;var n;var r,w;var h;var l,t,q;if(p=="feature"){m=d.RetrieveElement("tableAttrTitle");A=d.RetrieveElement("tableAttr");h=d.RetrieveElement("SearchFeature");t="tableAttr";q="ResultSearchFeature";l=d.RetrieveElement("div_features_table")}else{if(p=="option"){m=d.RetrieveElement("tableOptionsAttrTitle");A=d.RetrieveElement("tableOptionsAttr");h=d.RetrieveElement("SearchOptions");t="tableOptionsAttr";q="ResultSearchOptions";l=d.RetrieveElement("divFeatureOptions")}}n=m.rows[0].cells.length;for(z=0;z<n;z++){w=m.rows[0].cells[z].id.split("_");if(w[1]==u){m.rows[0].deleteCell(z);break}}for(z=0;z<A.rows.length;z++){if(!d.onWinEnv()&&A.rows[z].cells[0].id=="keyInOption"){continue}for(y=1;y<=n;y++){r=A.rows[z].cells[y].id.split("_");if(r[1]==u){A.rows[z].deleteCell(y);break}}}var s=new f();var k=s.getApplicationState();if(p=="feature"){for(z=0;z<k.featuresVisibleAttributes.length;z++){if(k.featuresVisibleAttributes[z]==u){k.featuresVisibleAttributes.splice(z,1)}}}else{if(p=="option"){for(z=0;z<k.optionsVisibleAttributes.length;z++){if(k.optionsVisibleAttributes[z]==u){k.optionsVisibleAttributes.splice(z,1)}}}}s.setApplicationState(k);d.SetSizeOfAttributsCellsTable(A,m,l);this.updateSearchResult(h,t,q);if(d.RetrieveElement(q).rows.length>0){d.SetSizeOfAttributsCellsTable(d.RetrieveElement(q),m,l)}if(p=="feature"){if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px";d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px";if(d.onWinEnv()){var v=d.RetrieveElement("content").scrollWidth+"px";var o=d.RetrieveElementByClassName("accordionHeader");for(var z=0;z<o.length;z++){o[z].style.width="";o[z].style.width=v}}else{var o=d.RetrieveElementByClassName("accordionHeader");for(var z=0;z<o.length;z++){o[z].style.width="";o[z].style.width="100%"}}}if(!d.onWinEnv()){d.resizeWindow(true)}}if(p=="feature"){var x=d.RetrieveElementByClassName("accordionHeader");if(x&&d.RetrieveElement("configPanel").offsetWidth>30){for(var z=0;z<x.length;z++){if(d.onWinEnv()){x[z].style.width=d.RetrieveElement("configPanel").offsetWidth+"px"}else{x[z].style.width="100%"}}}}if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},AddColumn:function(h,m,v){if(d.RetrieveElement("addAttrColumnPanel")){d.RemoveElement("addAttrColumnPanel")}else{var p=d.CreateElement("div");var r=d.CreateElement("table");var t;var n,l;var x=[];var k;var s,w;var o=[];if(h.id=="addAttrColumnFeatures"){k="featureAttr";for(n=0;n<m.length;n++){if(m[n].attributes){o=d.getJsonKeys(m[n].attributes);for(l=0;l<o.length;l++){if((!d.RetrieveElement("featureAttrTitleId_"+o[l]))&&(x.indexOf(o[l])==-1)){x.push(o[l])}}}}}else{if(h.id=="addAttrColumnOptions"){k="optionAttr";for(n=0;n<m.length;n++){if(m[n].attributes){o=d.getJsonKeys(m[n].attributes);for(l=0;l<o.length;l++){if((!d.RetrieveElement("attrTitleId_"+o[l]))&&(x.indexOf(o[l])==-1)){x.push(o[l])}}}}}}p.id="addAttrColumnPanel";var u=this;if(x.length==0){t=d.CreateElement("tr");t.innerHTML=g.i18n("No more attribute to add");t.style.fontStyle="italic";r.appendChild(t)}else{for(n=0;n<x.length;n++){t=d.CreateElement("tr");t.innerHTML=x[n];t.onmouseover=function(){this.style.backgroundColor="#FFFFFF"};t.onmouseout=function(){this.style.backgroundColor="#ccc"};t.onclick=function(){var M;var O;var K,J;var N;var I;var H,D,L;var A;if(k=="featureAttr"){M=d.RetrieveElement("tableAttrTitle");tabFixTitle=d.RetrieveElement("tableFixAttrTitle");O=d.RetrieveElement("tableAttr");s="titleFeatureAttr";w="featureAttrTitleId_";L="featureAttr";D="featureAttrId_";A="FeatureAttrLabel_";N=M.rows[0].cells.length;I=N+tabFixTitle.rows[0].cells.length}else{if(k=="optionAttr"){M=d.RetrieveElement("tableOptionsAttrTitle");tabFixTitle=d.RetrieveElement("tableOptionsFixAttrTitle");O=d.RetrieveElement("tableOptionsAttr");s="title";w="attrTitleId_";L="attr";D="attrId_";A="OptionAttrLabel_";N=M.rows[0].cells.length;I=N+tabFixTitle.rows[0].cells.length}}M.rows[0].insertCell(N-1);M.rows[0].cells[N-1].className=s;M.rows[0].cells[N-1].id=w+this.firstChild.wholeText;if(k=="featureAttr"){M.rows[0].cells[N-1].innerHTML="<a id='"+A+this.firstChild.wholeText+"' class='unselected'>"+this.firstChild.wholeText+"</a><img id='columnFeature_"+this.firstChild.wholeText+"' style='vertical-align:top; visibility:hidden;' float:right src='./assets/icons/close.png'/>";d.addEvent("click",d.RetrieveElement("columnFeature_"+this.firstChild.wholeText),function(){u.DeleteColumn(this,"feature")})}else{if(k=="optionAttr"){M.rows[0].cells[N-1].innerHTML="<a id='"+A+this.firstChild.wholeText+"' class='unselected'>"+this.firstChild.wholeText+"</a><img id='column_"+this.firstChild.wholeText+"' style='vertical-align:top; visibility:hidden;' float:right src='./assets/icons/close.png'/>";d.addEvent("click",d.RetrieveElement("column_"+this.firstChild.wholeText),function(){u.DeleteColumn(this,"option");if(d.RetrieveElement("addAttrColumnPanel")){d.RemoveElement("addAttrColumnPanel")}})}}d.addEvent("mouseover",d.RetrieveElement(w+this.firstChild.wholeText),function(){this.childNodes[1].style.visibility="visible"});d.addEvent("mouseout",d.RetrieveElement(w+this.firstChild.wholeText),function(){this.childNodes[1].style.visibility="hidden"});d.addEvent("click",d.RetrieveElement(A+this.firstChild.wholeText),function(){if(this.className=="unselected"){this.className="selected"}else{if(this.className=="selected"){this.className="unselected"}}});var E=new f();var y=E.getApplicationState();if(k=="featureAttr"){y.featuresVisibleAttributes.push(this.firstChild.wholeText)}else{if(k=="optionAttr"){y.optionsVisibleAttributes.push(this.firstChild.wholeText)}}E.setApplicationState(y);var B=[];for(K=0,tbindex=0;K<m.length;K++){H=null;if(m[K].attributes){B=d.getJsonKeys(m[K].attributes)}var P="";if(k=="featureAttr"||k=="optionAttr"){if(B.indexOf(this.firstChild.wholeText)!=-1){P=m[K].attributes[B[B.indexOf(this.firstChild.wholeText)]];var z="";if((P.length>this.firstChild.wholeText.length)){z+="title='"+P+"' ";P=P.substr(0,this.firstChild.wholeText.length);P+="..."}H="<p "+z+"style='text-align:center; overflow:hidden;'>"+P+"</p>"}}if(P.length==0){H="<p style='text-align:center'>-</p>"}if(!d.onWinEnv()&&O.rows[K].cells[0].id=="keyInOption"){tbindex++}O.rows[tbindex].insertCell(I);O.rows[tbindex].cells[I].className=L;O.rows[tbindex].cells[I].id=D+this.firstChild.wholeText;O.rows[tbindex].cells[I].innerHTML=H;O.rows[tbindex].cells[I].style.display="inline-block";tbindex++}if(k=="featureAttr"){d.SetSizeOfAttributsCellsTable(d.RetrieveElement("tableAttr"),d.RetrieveElement("tableAttrTitle"),d.RetrieveElement("div_features_table"));if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px";d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px";if(d.onWinEnv()){var F=d.RetrieveElement("content").scrollWidth+"px";var C=d.RetrieveElementByClassName("accordionHeader");for(var K=0;K<C.length;K++){C[K].style.width="";C[K].style.width=F}}}if(!d.onWinEnv()){d.resizeWindow(true)}}else{if(k=="optionAttr"){d.SetSizeOfAttributsCellsTable(d.RetrieveElement("tableOptionsAttr"),d.RetrieveElement("tableOptionsAttrTitle"),d.RetrieveElement("divFeatureOptions"))}}d.RemoveElement("addAttrColumnPanel");if(k=="featureAttr"){var G=d.RetrieveElementByClassName("accordionHeader");if(G&&d.RetrieveElement("configPanel").offsetWidth>30){for(var K=0;K<G.length;K++){if(d.onWinEnv()){G[K].style.width=d.RetrieveElement("configPanel").offsetWidth+10+"px"}}}if(!d.onWinEnv()){d.resizeWindow(false)}}if(d.RetrieveElement("prodStatePanel")&&d.RetrieveElement("configPanel").offsetWidth>30){d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("configPanel").offsetWidth+"px"}if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}};r.appendChild(t)}}p.appendChild(r);var q=new f();g.extendElement(p).inject(q.getWidget().body);p.style.left=(h.getBoundingClientRect().left-d.RetrieveElement("configPanel").getBoundingClientRect().left-r.offsetWidth)+"px";p.style.top=(h.getBoundingClientRect().top+h.offsetHeight)+"px";if(d.RetrieveElement("myfeatureOptions")){d.addEvent("mousedown",d.RetrieveElement("myfeatureOptions"),u.removeAttrListPanel)}}},createFilterPanel:function(){var x=this;var u;if(!d.RetrieveElement("filterPanel")){u=true}d.RemovePanels();if(u){var l=d.CreateElement("div");l.id="filterPanel";var v=new f();var h=d.getImgPath("optim");var m=d.getImgPath("levelUnselected");var y=d.getImgPath("levelNoIndicator");var n=d.getImgPath("completeConfMode");var k=d.getImgPath("levelUnselected");var t=d.getImgPath("levelNoIndicator");var E=d.getImgPath("dependencies");var C=d.getImgPath("levelUnselected");var D=d.getImgPath("levelNoIndicator");var o=d.getImgPath("incompatibilities");var B=d.getImgPath("levelUnselected");var z=d.getImgPath("levelNoIndicator");var p=d.getImgPath("levelPlus");var q=d.getImgPath("levelMinus");if(v.getRulesMode()=="RulesMode_ProposeOptimizedConfiguration"){m=d.getImgPath("levelSelected");k=d.getImgPath("levelSelected");C=d.getImgPath("levelSelected");B=d.getImgPath("levelSelected");y=d.getImgPath("levelIndicator")}else{if(v.getRulesMode()=="RulesMode_SelectCompleteConfiguration"){k=d.getImgPath("levelSelected");C=d.getImgPath("levelSelected");B=d.getImgPath("levelSelected");t=d.getImgPath("levelIndicator")}else{if(v.getRulesMode()=="RulesMode_EnforceRequiredOptions"){C=d.getImgPath("levelSelected");B=d.getImgPath("levelSelected");D=d.getImgPath("levelIndicator")}else{if(v.getRulesMode()=="RulesMode_DisableIncompatibleOptions"){B=d.getImgPath("levelSelected");z=d.getImgPath("levelIndicator")}}}}var A="<table style='display:block;'>";A+="<tr><th bgcolor=gray colspan='3' style='padding-left:5px;'><font color=white> "+g.i18n("Rules assistance level")+"</font></th></tr>";if(v.getAppFunc().rulesMode_ProposeOptimizedConfiguration=="yes"){A+="<tr id='optimLine' style='padding-right:5px;'><td style='padding-top:3px;'><img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+p+" /><img id='optimLevel' style='height:32px; vertical-align:bottom;' src="+m+" /><img id='optimLevelIndicator' style='height:32px; vertical-align:bottom;' src=";A+=y+" /><img id='RulesMode_ProposeOptimizedConfiguration' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+h+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+g.i18n("Propose optimized configuration on List Price")+"</td></tr>"}if(v.getAppFunc().rulesMode_SelectCompleteConfiguration=="yes"){var r="<img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+p+" />";var w="style = 'padding-top:3px;'";if(v.getAppFunc().rulesMode_ProposeOptimizedConfiguration=="yes"){w="";var s=d.getImgPath("levelEmpty");r="<img id='LevelEmpty' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+s+" />"}A+="<tr id='completeConfModeLine'><td "+w+">"+r+"<img id='completeConfModeLevel' style='height:32px; vertical-align:bottom;' src="+k+" /><img id='completeConfModeLevelIndicator' style='height:32px; vertical-align:bottom;' src=";A+=t+" /><img id='RulesMode_SelectCompleteConfiguration' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+n+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+g.i18n("Select complete configuration")+"</td></tr>"}if(v.getAppFunc().rulesMode_EnforceRequiredOptions=="yes"){var r="<img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+p+" />";var w="style = 'padding-top:3px;'";if(v.getAppFunc().rulesMode_ProposeOptimizedConfiguration=="yes"||v.getAppFunc().rulesMode_SelectCompleteConfiguration=="yes"){w="";var s=d.getImgPath("levelEmpty");r="<img id='LevelEmpty' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+s+" />"}A+="<tr id='dependenciesLine'><td "+w+">"+r+"<img id='dependenciesLevel' style='height:32px; vertical-align:bottom;' src="+C+" /><img id='dependenciesLevelIndicator' style='height:32px; vertical-align:bottom;' src=";A+=D+" /><img id='RulesMode_EnforceRequiredOptions' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+E+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+g.i18n("Enforce required options and select defaults")+"</td><td></tr>"}if(v.getAppFunc().rulesMode_DisableIncompatibleOptions=="yes"){A+="<tr id='incompatibilitiesLine'><td style='padding-bottom:3px;'><img id='LevelMinus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+q+" /><img id='incompatibilitiesLevel' style='height:32px; vertical-align:bottom;' src="}A+=B+" /><img id='incompatibilitiesLevelIndicator' style='height:32px; vertical-align:bottom;' src="+z+" /><img id='RulesMode_DisableIncompatibleOptions' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+o+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+g.i18n("Disable incompatible options")+"</td></tr>";A+="</table>";l.innerHTML=A;g.extendElement(l).inject(v.getWidget().body);if(d.RetrieveElement("selectLevelIcon").offsetLeft-d.RetrieveElement("filterPanel").offsetWidth>=0){d.RetrieveElement("filterPanel").style.left=(d.RetrieveElement("selectLevelIcon").offsetLeft-d.RetrieveElement("filterPanel").offsetWidth)+"px"}else{d.RetrieveElement("filterPanel").style.left="0px"}d.RetrieveElement("filterPanel").style.top=(d.RetrieveElement("selectLevelIcon").offsetTop+-d.RetrieveElement("filterPanel").offsetHeight)+"px";if(d.RetrieveElement("optimLine")){d.addEvent("click",d.RetrieveElement("optimLine"),function(){x.changeFilterIcon("RulesMode_ProposeOptimizedConfiguration")})}if(d.RetrieveElement("completeConfModeLine")){d.addEvent("click",d.RetrieveElement("completeConfModeLine"),function(){x.changeFilterIcon("RulesMode_SelectCompleteConfiguration")})}if(d.RetrieveElement("dependenciesLine")){d.addEvent("click",d.RetrieveElement("dependenciesLine"),function(){x.changeFilterIcon("RulesMode_EnforceRequiredOptions")})}if(d.RetrieveElement("incompatibilitiesLine")){d.addEvent("click",d.RetrieveElement("incompatibilitiesLine"),function(){x.changeFilterIcon("RulesMode_DisableIncompatibleOptions")})}}},createOptionsPanel:function(K){var A=this;var al=new f();var ac=al.getDictionary().features;var ag;var F;var o;var ao="Multiple";var l=true;var B;var m="";var C="";for(ag=0;ag<ac.length;ag++){if(K==ac[ag].ruleId){F=ac[ag].options;o=d.RetrieveElement("input"+K);ao=ac[ag].selectionType;if(!d.onWinEnv()){B=ac[ag].keyInType;if(ac[ag].listPrice){C=ac[ag].listPrice}}break}}if(d.RetrieveElement("myfeatureOptions")&&d.RetrieveElement("myfeatureOptions").value===K){l=false}d.RemovePanels();if(d.RetrieveElement("InfoBox")&&d.RetrieveElement("InfoBox").value=="InfoBoxVisible"){d.hideInfoBox()}if(l){var v=d.CreateElement("div");var n=d.getImgPath("rightArrow");var W="";var af,ae;var O="";var G="";var z="";var w=false;var ap;var R;var J;var X;var ah;var am=[];v.id="myfeatureOptions";v.className="HideAttr";v.value=K;v.style.left=o.getBoundingClientRect().left+"px";v.style.top=o.getBoundingClientRect().bottom+"px";v.style.maxWidth=(d.getPageSize().x-o.getBoundingClientRect().left)+"px";this.AddIncludedStateOnRefineMode();var ad=al.getApplicationState();var u=[];var aj="";if(!this.hasListPrice()){aj="style = 'display : none;'"}for(af=0;af<F.length;af++){if(F[af].attributes){am=d.getJsonKeys(F[af].attributes)}if(u.indexOf("List Price")==-1){z+="<td class='titleDefault' id='attrTitleId_List Price' "+aj+" ><a id='OptionAttrLabel_List Price' class='unselected'>"+g.i18n("List Price")+"</a></td>";u.push("List Price")}for(ag=0;ag<ad.optionsVisibleAttributes.length;ag++){if(am.indexOf(ad.optionsVisibleAttributes[ag])!=-1&&u.indexOf(ad.optionsVisibleAttributes[ag])==-1){O+="<td class='title' id='attrTitleId_"+ad.optionsVisibleAttributes[ag]+"'><a id='OptionAttrLabel_"+ad.optionsVisibleAttributes[ag]+"' class='unselected'>";O+=ad.optionsVisibleAttributes[ag]+"</a><img id='column_"+ad.optionsVisibleAttributes[ag]+"' style='vertical-align:top; visibility:hidden;' float:right src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")+"'/></td>";u.push(ad.optionsVisibleAttributes[ag])}}}var ai=al.getAction();for(ag=0;ag<F.length;ag++){G="";ah=F[ag].ruleId;var V=al.getCacheOrderableState()[ah];var P="";if(V==false){P=" style='display: none;' "}if(F[ag].attributes){am=d.getJsonKeys(F[ag].attributes)}var Y=F[ag].listPrice;var T="";if((Y.length>"List Price".length)){T+="title='"+Y+"' ";Y=Y.substr(0,"List Price".length);Y+="..."}else{if(Y.length!=0){G+="<td class = 'defaultAttr' id='attrId_List Price' "+aj+" ><p "+T+"style='text-align:center; overflow:hidden;'>"+Y+"</p></td>"}else{G+="<td class = 'defaultAttr' id='attrId_List Price' "+aj+" ><p style='text-align:center'>-</p></td>"}}for(ae=0;ae<ad.optionsVisibleAttributes.length;ae++){for(af=0;af<am.length;af++){if(am.indexOf(ad.optionsVisibleAttributes[ae])!=-1){var ak=F[ag].attributes[ad.optionsVisibleAttributes[ae]];var T="";if((ak.length>ad.optionsVisibleAttributes[ae].length)){T+="title='"+ak+"' ";ak=ak.substr(0,ad.optionsVisibleAttributes[ae].length);ak+="..."}if(ak.length!=0){G+="<td class='attr' id='attrId_"+ad.optionsVisibleAttributes[ae]+"'><p "+T+"style='text-align:center; overflow:hidden;'>"+ak+"</p></td>"}else{G+="<td class='attr' id='attrId_"+ad.optionsVisibleAttributes[ae]+"'><p style='text-align:center'>-</p></td>"}break}}}var y;var aa=al.getStateWithId(F[ag].ruleId);var N="";if(aa=="chosenInConflict"){y="check";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="chosenInConflict";X="enabled";N="<img id='RedQuestionMark_"+ah+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}else{if(aa=="defaultInConflict"){y="check";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="defaultInConflict";X="enabled";N="<img id='RedQuestionMark_"+ah+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}else{if(aa=="dismissedInConflict"){y="dismissed";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="dismissedInConflict";X="enabled";N="<img id='RedQuestionMark_"+ah+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}else{if(aa=="chosen"){y="check";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="chosen";X="enabled"}else{if(aa=="default"){y="check";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="noStateIcon";X="enabled"}else{if(aa=="recommanded"){y="check";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="recommanded";X="enabled"}else{if(aa=="required"){y="required";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="requiredByRules";X="disabled";N="<img id='imageAskQuestionmark_"+F[ag].ruleId+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("questionMark")+" />"}else{if(aa=="included"){y="included";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="noStateIcon";X="enabled"}else{if(aa=="dismissed"){y="dismissed";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="chosen";X="enabled"}else{if(aa=="incompatible"){y="incompatible";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="noStateIcon";X="disabled";N="<img  id='imageAskQuestionmark_"+F[ag].ruleId+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("questionMark")+" />"}else{y="available";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}ap="noStateIcon";X="enabled"}}}}}}}}}}if(!d.onWinEnv()&&"view"==ai.toLowerCase()){X="disabled";if(aa=="available"){y="incompatible";if(ao==="Single"&&al.getmultiSelect()==="false"){y+="_radio"}}}var s="";if(ap=="defaultInConflict"){s="<img  id='imgDefaultSelection_"+F[ag].ruleId+"' style='vertical-align:top; width:18px; height:18px;' src="+d.getImgPath("defaultInConflict")+" />";ap="noStateIcon"}else{if(d.isDefault(F[ag].ruleId)){s="<img  id='imgDefaultSelection_"+F[ag].ruleId+"' style='vertical-align:top; width:18px; height:18px;' src="+d.getImgPath("default")+" />"}}var r="";var an=d.htmlEncode(F[ag].displayName);if((an.length>40)){r+="title='"+an+"' ";an=an.substr(0,40);an+="..."}W+="<tr "+P+" ><td id='option'><div style='padding-top:3px; width:18px; height:17px; display:inline-block; vertical-align:top;'><img id='iconOption_"+ah+"' style='height:18px; width:18px;' src='"+d.getImgPath(ap)+"'/></div>";W+="<div style='padding-top:3px; height:17px; display:inline-block; vertical-align:top;' class='"+X+"'><img id='checkboxOption_"+ah+"' style='padding-right:4px; height:17px; width:17px; vertical-align: bottom;' src='";W+=d.getImgPath(y)+"'/><div style='display:inline-block' "+r+">"+an+s+N+"</div></div></td>"+G+"</tr>"}if(!d.onWinEnv()&&B&&B!="Blank"){var D=al.getKeyInValueById("KeyIn_"+K);var q=null;if(B=="Date"){q=al.getDateKeyInDisplayValueById("KeyIn_"+K);if(!q){var Z=new Date(parseInt(D));if(!isNaN(Date.parse(Z.toString()))){var x={year:"numeric",month:"short",day:"numeric"};q=Z.toLocaleDateString(navigator.language,x);al.setDateKeyInDisplayValueById("KeyIn_"+K,q)}}D=q}var M=al.getStateWithId("KeyIn_"+K);var H="noStateIcon";var L="available";if(ao==="Single"&&al.getmultiSelect()==="false"){L+="_radio"}var ab="";var Q="enabled";var t=al.getListOfListOfConflictingIds();if(!D){D=""}var S=this.createKeyInField(K,B,D);var I="";var h=C;I+="<td class = 'defaultAttr' id='attrId_List Price' "+aj+" ><p title='"+h+"' style='text-align:center; overflow:hidden;'>"+h+"</p></td>";if(M=="chosen"){H="keyIn";L="check";if(ao==="Single"&&al.getmultiSelect()==="false"){L+="_radio"}}else{if(M=="incompatible"){L="incompatible";if(ao==="Single"&&al.getmultiSelect()==="false"){L+="_radio"}H="noStateIcon";Q="disabled";ab="<img  id='imageAskQuestionmark_KeyIn_"+K+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("questionMark")+" />"}else{if(M=="chosenInConflict"){L="check";if(ao==="Single"&&al.getmultiSelect()==="false"){L+="_radio"}H="chosenInConflict";ab="<img id='RedQuestionMark_KeyIn_"+K+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}}}if(!d.onWinEnv()&&"view"==ai.toLowerCase()){Q="disabled"}m+="<tr><td id='keyInOption'><div style='padding-top:3px; width:18px; height:20px; display:inline-block; vertical-align:top;'><img id='iconOption_"+K+"' style='height:18px; width:18px;' src='"+d.getImgPath(H)+"'/></div><div style='padding-top:3px;  display:inline-block; vertical-align:top;' class='"+Q+"'><img id='checkboxOption_"+K+"' style='padding-right:4px; height:17px; width:17px; vertical-align: middle;' src='"+d.getImgPath(L)+"'/>"+S+ab+"</div></td>"+I+"</tr>"}v.innerHTML="<table><tr><td><div style='display:inline-block;'><div><input id='SearchOptions' class='EmptyInput' type='text' placeholder='"+g.i18n("Search for a Configuration Option")+"'/><table id='tableOptionsFixAttrTitle' style='vertical-align: middle; display: inline-block; height:20px'><tr>"+z+"</tr></table><table id='tableOptionsAttrTitle'><tr>"+O+"<td class='title' id='attrTitleId_AddAttr'><img id='addAttrColumnOptions' style='vertical-align:top; ' float:right src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/AddColumn.png")+"'/></td></tr></table></div><div id='divFeatureOptions'><table id='tableOptionsAttr' style='margin-bottom:5px;'>"+m+W+"</table><table id='ResultSearchOptions'></table></div></div></td><td style='vertical-align: middle;'><button id='optionAttrButton'><img id='ArrowOptionAttrImg' src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")+"'/></button></td></tr></table>";if(al.getConfigurationMode()=="selectionMode_Refine"){v.innerHTML+="<div id='checkRejectDiv'><img id='checkIcon'/><img id='rejectIcon'/></div>"}g.extendElement(v).inject(al.getWidget().body);d.addEvent("click",d.RetrieveElement("SearchOptions"),function(at){var ar=at.pageX-this.getBoundingClientRect().left;var aq=(this.offsetWidth-34);var k=(this.offsetWidth-18);if(this.className=="NonEmptyInput"&&ar>aq&&ar<k){this.value="";A.updateSearchResult(this,"tableOptionsAttr","ResultSearchOptions")}});if(al.getConfigurationMode()=="selectionMode_Refine"){this.updateCheckRejectIcon()}if(d.RetrieveElement("divFeatureOptions").offsetHeight>100){d.RetrieveElement("divFeatureOptions").style.height="100px"}d.addEvent("click",d.RetrieveElement("optionAttrButton"),A.OptionAttrButtonCallback);for(ag=0;ag<F.length;ag++){ah=F[ag].ruleId;d.RetrieveElement("tableOptionsAttr").rows[ag].cells[0].style.width=d.RetrieveElement("SearchOptions").offsetWidth+"px";d.addEvent("click",d.RetrieveElement("checkboxOption_"+ah).parentNode,function(k){A.updateOptionState(this)});if(d.RetrieveElement("imageAskQuestionmark_"+ah)){d.addEvent("click",d.RetrieveElement("imageAskQuestionmark_"+ah),function(){d.askQuestionMarkReasonToSolver(this,this.id.split("_")[1])})}}if(!d.onWinEnv()&&B&&B!="Blank"){var p=false;var M=al.getStateWithId("KeyIn_"+K);if(M=="incompatible"){p=true}if(!d.onWinEnv()&&"view"==ai.toLowerCase()){p=true}else{this.typingTimer=0;d.addEvent("keyup",d.RetrieveElement("keyInput_"+K),function(aq){clearTimeout(A.typingTimer);var k=this;var ar=function(){A.updateKeyInOptionState(k)};A.typingTimer=setTimeout(ar,1000)});d.addEvent("click",d.RetrieveElement("checkboxOption_"+K),function(k){A.keyInCheckBoxCallBack(this)});if(B=="Date"){d.RetrieveElement("keyInput_"+K).readOnly=true;var E=d.RetrieveElement("keyInOption");var U="";d.addEvent("click",d.RetrieveElement("keyInput_"+K),function(aq){if(E.lastChild.className!=="datepicker"){var k=this;U=new b().addEvent("onSelect",function(au,ax){var at=this.toString();var ay=this.getDate();var ar={year:"numeric",month:"short",day:"numeric"};var av=new Date(ay);at=av.toLocaleDateString(navigator.language,ar);var aw=av.toLocaleDateString("en-US",ar);k.value=Date.parse(ay);k.displayValue=at;A.updateKeyInOptionState(k);this.hide()});U.inject(E);U.elements.container.style.display="initial";U.elements.container.style.position="fixed";if(U.elements.container.getBoundingClientRect().bottom>d.RetrieveElement("topPanel").offsetHeight){U.elements.container.style.top=(E.getBoundingClientRect().top-U.elements.container.offsetHeight)+"px"}}else{console.log(U.elements.container.destroy())}})}}d.RetrieveElement("keyInput_"+K).disabled=p;if(d.RetrieveElement("imageAskQuestionmark_KeyIn_"+K)){d.addEvent("click",d.RetrieveElement("imageAskQuestionmark_KeyIn_"+K),function(){d.askQuestionMarkReasonToSolver(this,"KeyIn_"+K)})}}if((o.getBoundingClientRect().bottom+v.offsetHeight)>d.RetrieveElement("topPanel").offsetHeight){v.style.top=(o.getBoundingClientRect().top-v.offsetHeight-6)+"px"}for(ag=0;ag<ad.optionsVisibleAttributes.length;ag++){if(d.RetrieveElement("attrTitleId_"+ad.optionsVisibleAttributes[ag])){d.addEvent("mouseover",d.RetrieveElement("attrTitleId_"+ad.optionsVisibleAttributes[ag]),function(){this.childNodes[1].style.visibility="visible"});d.addEvent("mouseout",d.RetrieveElement("attrTitleId_"+ad.optionsVisibleAttributes[ag]),function(){this.childNodes[1].style.visibility="hidden"});d.addEvent("click",d.RetrieveElement("OptionAttrLabel_"+ad.optionsVisibleAttributes[ag]),function(){if(this.className=="unselected"){this.className="selected"}else{if(this.className=="selected"){this.className="unselected"}}});d.addEvent("click",d.RetrieveElement("column_"+ad.optionsVisibleAttributes[ag]),function(){A.DeleteColumn(this,"option");if(d.RetrieveElement("addAttrColumnPanel")){d.RemoveElement("addAttrColumnPanel")}})}}if(d.RetrieveElement("attrTitleId_List Price")){d.addEvent("click",d.RetrieveElement("OptionAttrLabel_List Price"),function(){if(this.className=="unselected"){this.className="selected"}else{if(this.className=="selected"){this.className="unselected"}}})}d.addEvent("click",d.RetrieveElement("addAttrColumnOptions"),function(){A.AddColumn(d.RetrieveElement("addAttrColumnOptions"),F,K)});d.addEvent("keyup",d.RetrieveElement("SearchOptions"),function(){A.updateSearchResult(this,"tableOptionsAttr","ResultSearchOptions")});if(d.RetrieveElement("checkIcon")){d.addEvent("click",d.RetrieveElement("checkIcon"),function(){A.updateCheckReject(d.RetrieveElement("checkIcon"))})}if(d.RetrieveElement("rejectIcon")){d.addEvent("click",d.RetrieveElement("rejectIcon"),function(){A.updateCheckReject(d.RetrieveElement("rejectIcon"))})}for(var ag=0;ag<d.RetrieveElementByClassName("RedMarkImg").length;ag++){d.addEvent("click",d.RetrieveElementByClassName("RedMarkImg")[ag],A.CreateConflictTooltip)}if(!d.onWinEnv()){d.enableScrollInOptionPanel()}}if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},hasListPrice:function(){var k=new f();var m=k.getDictionary().features;var h=k.getDictionary().basePrice;if(h&&parseFloat(h)!=0){return true}for(i=0;i<m.length;i++){featureOptionsList=m[i].options;var l=m[i].listPrice;if(l&&l!=""){if(parseFloat(l)!=0){return true}}for(j=0;j<featureOptionsList.length;j++){var l=featureOptionsList[j].listPrice;if(l&&l!=""){if(parseFloat(l)!=0){return true}}}}return false},updateKeyInOptionState:function(m){var v=this.validateKeyInValue(m);var u=m.id.split("_")[1];var x=d.RetrieveElement("checkboxOption_"+u);var r=d.RetrieveElement("iconOption_"+u);var s=new f();var t=s.getDictionary().features;var p="Multiple";for(i=0;i<t.length;i++){if(u===t[i].ruleId){p=t[i].selectionType;break}}var l=false;if(p==="Single"&&s.getmultiSelect()==="false"){l=true}var w=m.value;var o=m.displayValue;var k=false;var h;if(w){var q="check";if(l){q+="_radio"}r.src=d.getImgPath("keyIn");x.src=d.getImgPath(q);if(o){d.RetrieveElement("keyInput_"+u).value=o}else{d.RetrieveElement("keyInput_"+u).value=w}}else{var q="available";if(l){q+="_radio"}r.src=d.getImgPath("noStateIcon");x.src=d.getImgPath(q);var n=s.getStateWithId("KeyIn_"+u);if(!v&&l&&!(n=="chosen"||n=="chosenInConflict")){return}d.RetrieveElement("imageFeature"+u).src=d.getImgPath("defaultFeatureImage")}if(s.getmultiSelect()=="false"){this.SetOptionsAvailableForSingleTypeFeature(d.getFeatureNameWithId(u));d.RetrieveElement("input"+u).value=""}s.setKeyInValueById("KeyIn_"+u,w);if(o){s.setDateKeyInDisplayValueById("KeyIn_"+u,o)}this.updateFeatureState(u);this.updateMustSelectFeatureNumber();this.updateConflictingFeatures();if(s.getRulesActivation()=="true"){if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}d.CallSolveMethodOnSolver()}else{if(d.RetrieveElement("myfeatureOptions")){this.updateOptionsPanel()}}},keyInCheckBoxCallBack:function(n){if(n.parentNode.className!="disabled"){var k=new f();var h=n.id.split("_")[1];var m=k.getStateWithId("KeyIn_"+h);var l=d.RetrieveElement("keyInput_"+h);if(m=="chosen"||m=="chosenInConflict"){l.value="";this.updateKeyInOptionState(l)}else{if(l.value){this.updateKeyInOptionState(l)}}}},createKeyInField:function(h,l,m){var k="background-color: rgba(255, 255, 255, 0.8); border: 1px solid grey; padding-left: 10px; background-image: url("+d.getImgPath(l)+"); background-position: 98% 1px; background-repeat: no-repeat; padding-right: 20px;min-height: 20px; ";var n="";if(l=="Text Area"){n="<textarea id='keyInput_"+h+"'  rows='3' style='"+k+"' >"+m+"</textarea>"}else{n="<input type='text' id='keyInput_"+h+"' style='"+k+"' value='"+m+"' />"}return n},validateKeyInValue:function(h){var m=h.id.split("_")[1];var l=this.getFeatureById(m);var n=l.keyInType;var k;if(n=="Integer"){k=this.inputNumberCheck(h.value,0,1)}else{if(n=="Real"){k=this.inputNumberCheck(h.value,2,1)}else{if(n=="Input"||n=="Text Area"){k=this.checkForBadChars(h.value,false)}else{if(n=="Date"){k=this.inputDateCheck(h.value,"M dd, yy")}}}}if(k){if(k.value){h.value=k.value}if(k.message!=""){alert(k.message)}return k.isValid}return true},inputNumberCheck:function(o,l,p){var n=".";var q=false;var k="";var h="";var m=0;var r=new Object();r.isValid=true;r.value=o;r.message="";if(o==""){return r}if(isNaN(o)){r.message=g.i18n("Invalid character.");r.isValid=false;r.value="";return r}if(o.charAt(m)=="-"){r.message=g.i18n("Negative numbers not allowed.");r.isValid=false;r.value="";return r}for(m;m<o.length;m++){k=o.charAt(m);if(k==n){if(!q){q=true}}else{if(k>="0"&&k<="9"){}}}if(q&&l==0){r.isValid=false}h=o;if(h.length==0&&l==0){r.message=g.i18n("Please Enter an Integer Value.")}else{if(h.length==0&&l==2){r.message=g.i18n("Please Enter a Decimal Value.")}}if(h==""){r.value="";return r}r.value=parseFloat(h).toFixed(l);return r},inputDateCheck:function(m,o){var l=new Object();l.isValid=true;l.message="";try{var k=new Date(parseInt(m));var h=Date.parse(k.toString());if(isNaN(h)){l.isValid=false}}catch(n){l.isValid=false}return l},getFeatureById:function(k){var h=new f();var l=h.getDictionary().features;for(i=0;i<l.length;i++){if(k==l[i].ruleId){return l[i]}}},checkForBadChars:function(n,h){var p=false;var o=new Array("#","+","|");var m=new Object();m.isValid=true;m.value=n;m.message="";var k="";for(var l=0;l<o.length;l++){if(n.indexOf(o[l])>-1){k+=o[l]+" "}}if(k.length>0){p=true}if(p){m.message=g.i18n("One or more special characters are not allowed.");m.isValid=false;m.value="";return m}return m},updateOptionsPanel:function(){var n=d.RetrieveElement("myfeatureOptions");var A=n.value;var o;var B="";var v=d.RetrieveElement("input"+A);var s;var p;var K;var x=new f();var y=this;var u=x.getDictionary().features;var E="Multiple";if(x.getStateWithId(A)==="incompatibleFeature"){d.RemoveElement("myfeatureOptions");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}return}for(F=0;F<u.length;F++){if(A===u[F].ruleId){E=u[F].selectionType;break}}n.style.left=v.getBoundingClientRect().left+"px";if((v.getBoundingClientRect().bottom+n.offsetHeight)<=d.RetrieveElement("topPanel").offsetHeight){n.style.top=v.getBoundingClientRect().bottom+"px"}this.AddIncludedStateOnRefineMode();var C=d.GetOptionsListForSpecifiedFeature(A);var l=x.getAction();for(var F=0;F<C.length;F++){p="";o=x.getStateWithId(C[F]);if(o=="chosenInConflict"){K="check";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="chosenInConflict";s="enabled";p="<img id='RedQuestionMark_"+C[F]+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}else{if(o=="dismissedInConflict"){K="dismissed";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="dismissedInConflict";s="enabled";p="<img id='RedQuestionMark_"+C[F]+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("redQuestionMark")+" />"}else{if(o=="chosen"){K="check";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="chosen";s="enabled"}else{if(o=="default"){K="check";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="noStateIcon";s="enabled"}else{if(o=="recommanded"){K="check";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="recommanded";s="enabled"}else{if(o=="required"){K="required";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="requiredByRules";s="disabled";p="<img id='imageAskQuestionmark_"+C[F]+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("questionMark")+" />"}else{if(o=="included"){K="included";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="noStateIcon";s="enabled"}else{if(o=="dismissed"){K="dismissed";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="chosen";s="enabled"}else{if(o=="incompatible"){K="incompatible";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="noStateIcon";s="disabled";p="<img  id='imageAskQuestionmark_"+C[F]+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+d.getImgPath("questionMark")+" />"}else{K="available";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}state="noStateIcon";s="enabled"}}}}}}}}}if(!d.onWinEnv()&&"view"==l.toLowerCase()){s="disabled";if(o=="available"){K="incompatible";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}}}d.RemoveElement("imgDefaultSelection_"+C[F]);var J="";if(state=="defaultInConflict"){J="<img  id='imgDefaultSelection_"+C[F]+"' style='vertical-align:top; width:18px; height:18px;' src="+d.getImgPath("defaultInConflict")+" />";state="noStateIcon"}else{if(d.isDefault(C[F])){J="<img  id='imgDefaultSelection_"+C[F]+"' style='vertical-align:top; width:18px; height:18px;' src="+d.getImgPath("default")+" />"}}d.RetrieveElement("iconOption_"+C[F]).src=d.getImgPath(state);d.RetrieveElement("checkboxOption_"+C[F]).src=d.getImgPath(K);var G=d.RetrieveElement("checkboxOption_"+C[F]).parentNode.lastChild.lastChild;if(G.className=="BlackMarkImg"||G.className=="RedMarkImg"){d.RemoveElement(G.id)}if(J!=""){d.RetrieveElement("checkboxOption_"+C[F]).parentNode.lastChild.innerHTML+=J}if(p!=""){d.RetrieveElement("checkboxOption_"+C[F]).parentNode.lastChild.innerHTML+=p}for(var D=0;D<d.RetrieveElementByClassName("RedMarkImg").length;D++){d.addEvent("click",d.RetrieveElementByClassName("RedMarkImg")[D],y.CreateConflictTooltip)}if(d.RetrieveElement("imageAskQuestionmark_"+C[F])){d.addEvent("click",d.RetrieveElement("imageAskQuestionmark_"+C[F]),function(){d.askQuestionMarkReasonToSolver(this,this.id.split("_")[1])})}d.RetrieveElement("checkboxOption_"+C[F]).parentNode.className=s;if(!d.onWinEnv()&&"view"==l.toLowerCase()){s="disabled";if(myOptionState=="available"){K="incompatible";if(E==="Single"&&x.getmultiSelect()==="false"){K+="_radio"}}}}var u=x.getDictionary().features;var q;for(F=0;F<u.length;F++){if(A==u[F].ruleId){q=u[F];break}}if(!d.onWinEnv()&&q&&q.keyInType&&q.keyInType!="Blank"){var t=x.getKeyInValueById("KeyIn_"+A);var w=d.RetrieveElement("iconOption_"+A);var H=x.getStateWithId("KeyIn_"+A);var k="noStateIcon";var r="available";if(E==="Single"&&x.getmultiSelect()==="false"){r+="_radio"}var I;var m=false;var h=x.getListOfListOfConflictingIds();if(!t){t=""}if(H=="chosen"){k="keyIn";r="check";if(E==="Single"&&x.getmultiSelect()==="false"){r+="_radio"}}else{if(H=="incompatible"){r="incompatible";if(E==="Single"&&x.getmultiSelect()==="false"){r+="_radio"}k="noStateIcon";I=d.CreateElement("img");I.id="imageAskQuestionmark_KeyIn_"+A;I.className="BlackMarkImg";I.style="vertical-align:top; padding-left:4px; width:12px; height:12px;";I.src=d.getImgPath("questionMark");m=true}else{if(H=="chosenInConflict"){r="check";if(E==="Single"&&x.getmultiSelect()==="false"){r+="_radio"}k="chosenInConflict";I=d.CreateElement("img");I.id="RedQuestionMark_KeyIn_"+A;I.className="RedMarkImg";I.style="vertical-align:top; padding-left:4px; width:12px; height:12px;";I.src=d.getImgPath("redQuestionMark")}}}w.src=d.getImgPath(k);var z=d.RetrieveElement("checkboxOption_"+A);z.src=d.getImgPath(r);d.RetrieveElement("keyInput_"+A).disabled=m;if(m){d.RetrieveElement("checkboxOption_"+A).parentNode.className="disabled"}else{d.RetrieveElement("checkboxOption_"+A).parentNode.className="enabled"}var G=z.parentNode.lastChild;if(G.className=="BlackMarkImg"||G.className=="RedMarkImg"){d.RemoveElement(G.id)}if(I){d.RetrieveElement("checkboxOption_"+A).parentNode.lastChild.appendChild(I)}if(d.RetrieveElement("imageAskQuestionmark_KeyIn_"+A)){d.addEvent("click",d.RetrieveElement("imageAskQuestionmark_KeyIn_"+A),function(){d.askQuestionMarkReasonToSolver(this,"KeyIn_"+A)})}if(d.RetrieveElement("RedQuestionMark_KeyIn_"+A)){d.addEvent("click",d.RetrieveElement("RedQuestionMark_KeyIn_"+A),y.CreateConflictTooltip)}if(t==""){d.RetrieveElement("keyInput_"+A).value=t}}this.updateSearchResult(d.RetrieveElement("SearchOptions"),"tableOptionsAttr","ResultSearchOptions")},setFeatures:function(){var w=new f();var u=w.getDictionary().features;var y=d.RetrieveElement("content");var m="";var E,D,C;var L="";var l="";var J="";var v=false;var F;var h=w.getApplicationState();var q="";var r=[];if(w.getAppFunc().features=="no"){return}var I="";if(!this.hasListPrice()){I="style = 'display : none;'"}if(u.length>0){var t=[];for(D=0;D<u.length;D++){if(u[D].attributes){r=d.getJsonKeys(u[D].attributes)}if(t.indexOf("List Price")==-1){J+="<td class='titleFeatureDefaultAttr' id='featureAttrTitleId_List Price' "+I+" ><a id='FeatureAttrLabel_List Price' class='unselected'>"+g.i18n("List Price")+"</a></td>";t.push("List Price")}for(E=0;E<h.featuresVisibleAttributes.length;E++){if(r.indexOf(h.featuresVisibleAttributes[E])!=-1&&t.indexOf(h.featuresVisibleAttributes[E])==-1){L+="<td class='titleFeatureAttr' id='featureAttrTitleId_"+h.featuresVisibleAttributes[E]+"'><a id='FeatureAttrLabel_"+h.featuresVisibleAttributes[E]+"' class='unselected'>"+h.featuresVisibleAttributes[E]+"</a><img id='columnFeature_";L+=h.featuresVisibleAttributes[E]+"' style='vertical-align:top; visibility:hidden;' float:right src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")+"'/></td>";t.push(h.featuresVisibleAttributes[E])}}}}for(E=0;E<u.length;E++){l="";if(u[E].attributes){r=d.getJsonKeys(u[E].attributes)}var B=u[E].listPrice;var o="";if((B.length>"List Price".length)){o+="title='"+B+"' ";B=B.substr(0,"List Price".length);B+="..."}if(B.length!=0){l+="<td class='featureDefaultAttr' id='featureAttrId_List Price' "+I+" ><p "+o+"style='text-align:center; overflow:hidden;'>"+B+"</p></td>"}else{l+="<td class='featureDefaultAttr' id='featureAttrId_List Price' "+I+" ><p style='text-align:center'>-</p></td>"}var p="";if(!d.onWinEnv()){p="style='display: inline-block'"}for(C=0;C<h.featuresVisibleAttributes.length;C++){for(D=0;D<r.length;D++){if(r.indexOf(h.featuresVisibleAttributes[C])!=-1){var K=u[E].attributes[h.featuresVisibleAttributes[C]];var o="";if((K.length>h.featuresVisibleAttributes[C].length)){o+="title='"+K+"' ";K=K.substr(0,h.featuresVisibleAttributes[C].length);K+="..."}if(K.length!=0){l+="<td class='featureAttr' id='featureAttrId_"+h.featuresVisibleAttributes[C]+"' "+p+"><p "+o+"style='text-align:center; overflow:hidden;'>"+K+"</p></td>"}else{l+="<td class='featureAttr' id='featureAttrId_"+h.featuresVisibleAttributes[C]+"' "+p+"><p style='text-align:center'>-</p></td>"}break}}}if((u[E].selectionCriteria&&u[E].selectionCriteria.toUpperCase()=="MUST")||w.getStateWithId(u[E].ruleId)=="requiredFeature"){F="mustSelectFeature"}else{if(u[E].selectionCriteria&&u[E].selectionCriteria.toUpperCase()=="MAY"){F="maySelectFeature"}}if(F=="mustSelectFeature"){}if(w.getConfigurationMode()=="selectionMode_Refine"){if(w.getRulesActivation()=="true"){q=g.i18n("All compatibles")}else{if(w.getRulesActivation()=="false"){q=g.i18n("All")}}this.AddIncludedStateOnRefineMode()}else{if(w.getConfigurationMode()=="selectionMode_Build"){q=g.i18n("None")}}m+="<tr class='elementInList' id='LineFeature_"+u[E].ruleId+"'><td id='feature'><table><tr><td><img id='iconFeature"+u[E].ruleId+"' name='"+E+"' src="+d.getImgPath(F)+" style='height: 30px; width: 30px; vertical-align:middle;'></td><td><div id='divImageFeature"+u[E].ruleId+"' style='height:60px; width:60px; border:2px solid transparent; border-radius:6px; overflow:hidden;'><img id='imageFeature"+u[E].ruleId+"' style='height: 60px; width: 60px; vertical-align:middle; background-color:#ffffff;'></div></td><td style='vertical-align: top;'><li style='padding-left:15px;'>"+d.htmlEncode(u[E].displayName)+"</li><li><textarea cols='40' rows='1' id='input"+u[E].ruleId+"' placeholder='"+q+"' readonly='true' class='featureInput' name='"+E+"' onfocus='blur();' style='background-color:rgba(255,255,255,0.8); border:1px solid grey; padding-left:15px;'></textarea></li></td></tr></table>"+l+"</tr>"}this.updateCompletenessIcon();var H=w.getDictionary().basePrice;if(H&&parseFloat(H)!="NaN"){H=parseFloat(H).toFixed(1)}else{H="0"}var n="";if(this.hasListPrice()){n="<tr><td><div id='priceInfoPanel'><span id='basePriceLabel' class='priceLabel'>"+g.i18n("Base Price")+": </span> <span id='basePriceValue' class='priceValue'>"+H+" </span><div id ='totalPricePanel' ><span id='totalPriceLabel' class='priceLabel'>"+g.i18n("Total Price")+": </span><span id='totalPriceValue' class='priceValue'>"+H+"</span></div></div></td></tr>"}var x="";var G="style='height:100%; width:20px;'";if(!d.onWinEnv()){x="style='display:inline-block'";G="style='display: none'"}y.innerHTML="<table style='width:100%; height:100%;'><tr><td style='height:100%; width:95%;'><div style='display:inline-block; height:100%; overflow: auto; width:100%'><table><tr><td><input id='SearchFeature' class='EmptyInput' type='text' placeholder='"+g.i18n("Search for a Configuration Feature")+"'/></td><td><table id='tableFixAttrTitle' style='vertical-align: middle; display: inline-block; height:20px;' ><tr>"+J+"</table><table id='tableAttrTitle' "+x+"><tr>"+L+"<td class='titleFeatureAttr' id='featureAttrTitleId_AddAttr'><img id='addAttrColumnFeatures' style='vertical-align:top;' float:right src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/AddColumn.png")+"'/></td></tr></table></td></tr></table><div id='div_features_table'><table id='tableAttr'>"+m+"</table><table id='ResultSearchFeature'></table></div></div></td><td "+G+"><button id='myAccordeonButton'><img id='ArrowAttrImg' src='"+e.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")+"'/></button></td></tr>"+n+"</table>";d.RetrieveElement("ArrowAttrImg").onload=function(){if(d.RetrieveElement("content").offsetWidth>30){if(d.onWinEnv()){var k=d.RetrieveElement("content").scrollWidth+"px";var M=d.RetrieveElementByClassName("accordionHeader");for(var N=0;N<M.length;N++){M[N].style.width="";M[N].style.width=k}}else{var M=d.RetrieveElementByClassName("accordionHeader");for(var N=0;N<M.length;N++){M[N].style.width="";M[N].style.width="100%"}}}if(d.RetrieveElement("prodStatesContainer")!=null){d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("content").style.height=(d.getPageSize().y-(d.RetrieveElement("prodStatesContainer").offsetHeight+115))+"px"}};d.RetrieveElement("div_features_table").style.height=(d.RetrieveElement("content").style.height.replace("px","")-60)+"px";d.addEvent("wheel",d.RetrieveElement("div_features_table"),function(){d.RemovePanels()});var z=this;d.addEvent("click",d.RetrieveElement("myAccordeonButton"),z.AttrButtonCallback);d.addEvent("click",d.RetrieveElement("addAttrColumnFeatures"),function(){require(["DS/ConfiguratorWebView/PanelController"],function(k){k.AddColumn(d.RetrieveElement("addAttrColumnFeatures"),u)})});if(d.RetrieveElement("prodStatePanel")!=null&&d.RetrieveElement("content").offsetWidth>30){d.RetrieveElement("prodStatePanel").style.width=d.RetrieveElement("content").offsetWidth+"px";d.RetrieveElement("prodStatePanel").parentNode.style.width=d.RetrieveElement("content").offsetWidth+"px"}if(d.RetrieveElement("content").offsetWidth>30){if(d.onWinEnv()){var A=d.RetrieveElement("content").scrollWidth+"px";var s=d.RetrieveElementByClassName("accordionHeader");for(var E=0;E<s.length;E++){s[E].style.width="";s[E].style.width=A}}else{var s=d.RetrieveElementByClassName("accordionHeader");for(var E=0;E<s.length;E++){s[E].style.width="";s[E].style.width="100%"}}}d.addEvent("keyup",d.RetrieveElement("SearchFeature"),function(){z.updateSearchResult(this,"tableAttr","ResultSearchFeature")});d.addEvent("click",d.RetrieveElement("SearchFeature"),function(O){var N=O.pageX-this.getBoundingClientRect().left;var M=(this.offsetWidth-34);var k=(this.offsetWidth-18);if(this.className=="NonEmptyInput"&&N>M&&N<k){this.value="";z.updateSearchResult(this,"tableAttr","ResultSearchFeature")}});for(E=0;E<h.featuresVisibleAttributes.length;E++){if(d.RetrieveElement("featureAttrTitleId_"+h.featuresVisibleAttributes[E])){d.addEvent("mouseover",d.RetrieveElement("featureAttrTitleId_"+h.featuresVisibleAttributes[E]),function(){this.childNodes[1].style.visibility="visible"});d.addEvent("mouseout",d.RetrieveElement("featureAttrTitleId_"+h.featuresVisibleAttributes[E]),function(){this.childNodes[1].style.visibility="hidden"});d.addEvent("click",d.RetrieveElement("FeatureAttrLabel_"+h.featuresVisibleAttributes[E]),function(){if(this.className=="unselected"){this.className="selected"}else{if(this.className=="selected"){this.className="unselected"}}});d.addEvent("click",d.RetrieveElement("columnFeature_"+h.featuresVisibleAttributes[E]),function(){z.DeleteColumn(this,"feature")})}}if(d.RetrieveElement("featureAttrTitleId_List Price")){d.addEvent("click",d.RetrieveElement("FeatureAttrLabel_List Price"),function(){if(this.className=="unselected"){this.className="selected"}else{if(this.className=="selected"){this.className="unselected"}}})}var z=this;for(E=0;E<u.length;E++){d.addEvent("click",d.RetrieveElement("input"+u[E].ruleId),function(){z.createOptionsPanel(u[this.name].ruleId)})}if(!d.onWinEnv()){d.SetSizeOfAttributsCellsTable(d.RetrieveElement("tableAttr"),d.RetrieveElement("tableAttrTitle"),d.RetrieveElement("div_features_table"))}this.updateFeatures(true);if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},updateFeatures:function(l){var h=new f();var m=h.getDictionary().features;var k=d.RetrieveElement("SearchFeature").offsetWidth;for(i=0;i<m.length;i++){d.RetrieveElement("tableAttr").rows[i].cells[0].style.width=(k-8)+"px";d.RetrieveElement("input"+(m[i].ruleId)).value="";d.RetrieveElement("input"+(m[i].ruleId)).rows=1;if(h.getConfigurationMode()=="selectionMode_Refine"){if(h.getRulesActivation()=="true"){d.RetrieveElement("input"+(m[i].ruleId)).placeholder=g.i18n("All compatibles")}else{if(h.getRulesActivation()=="false"){d.RetrieveElement("input"+(m[i].ruleId)).placeholder=g.i18n("All")}}this.AddIncludedStateOnRefineMode()}else{if(h.getConfigurationMode()=="selectionMode_Build"){d.RetrieveElement("input"+(m[i].ruleId)).placeholder=g.i18n("None")}}this.updateFeatureState(m[i].ruleId)}this.updateMustSelectFeatureNumber();this.updateConflictingFeatures();this.updateSearchResult(d.RetrieveElement("SearchFeature"),"tableAttr","ResultSearchFeature");d.sendXMLtoNativeEnv();if(!d.onWinEnv()&&l==true){d.resizeWindow(false)}},checkInvalidKeyInFeatures:function(){var q=[];var p=new f();var r=p.getDictionary().features;for(var m=0;m<r.length;m++){var k=p.getStateWithId("KeyIn_"+r[m].ruleId);if(k=="chosen"||k=="chosenInConflict"){var o=r[m].keyInType;var t=p.getKeyInValueById("KeyIn_"+r[m].ruleId);var s;if(o=="Integer"){s=this.inputNumberCheck(t,0,1)}else{if(o=="Real"){s=this.inputNumberCheck(t,2,1)}else{if(o=="Input"||o=="Text Area"){s=this.checkForBadChars(t,false)}else{if(o=="Date"){s=this.inputDateCheck(t,"M dd, yy")}}}}if(s&&!s.isValid){q.push(r[m].displayName)}}}var n=true;if(q&&q.length>0){n=false;var h="";for(var m=0;m<q.length;m++){if(h.length>0){h+=", "}h+=q[m]}var l=g.i18n("KeyIn Type has been changed for #FEATURES#");l=l.replace("#FEATURES#",h);alert(l)}return n},SetMultiSelOnSolver:function(l,n){var k=new f();var h="false";if(l==true){h="true"}var m={_from:"configurator",_to:"solverConfiguration",_request:"setMultiSelection",_data:h};returnFromWebService=d.sendTextToSolver(JSON.stringify(m),n);if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(o){o.ApplyAnswer(returnFromWebService)})}},SetOptionsAvailableForSingleTypeFeature:function(k){var m=new f();var n=m.getDictionary().features;for(var l=0;l<n.length;l++){if(n[l].name==k){if(n[l].selectionType=="Single"){for(var h=0;h<n[l].options.length;h++){m.setStateWithId(n[l].options[h].ruleId,"available")}if(!d.onWinEnv()&&n[l].keyInType&&n[l].keyInType!="Blank"){m.setKeyInValueById("KeyIn_"+n[l].ruleId,"")}}break}}},AddIncludedStateOnRefineMode:function(){var m=new f();var n=m.getConfigurationMode();var o=m.getDictionary().features;var h=[];if(n=="selectionMode_Refine"){for(var l=0;l<o.length;l++){h=[];for(var k=0;k<o[l].options.length;k++){if(h.indexOf(m.getStateWithId(o[l].options[k].ruleId))==-1){h.push(m.getStateWithId(o[l].options[k].ruleId))}}if(h.indexOf("chosen")==-1&&h.indexOf("chosenInConflict")==-1&&h.indexOf("default")==-1&&h.indexOf("defaultInConflict")==-1&&h.indexOf("required")==-1&&h.indexOf("recommanded")==-1){for(var k=0;k<o[l].options.length;k++){if(m.getStateWithId(o[l].options[k].ruleId)=="available"||m.getStateWithId(o[l].options[k].ruleId)==undefined){m.setStateWithId(o[l].options[k].ruleId,"included")}}}}}},RemoveIncludedStateOnBuildMode:function(){var l=new f();var m=l.getConfigurationMode();var n=l.getDictionary().features;if(m=="selectionMode_Build"){for(var k=0;k<n.length;k++){for(var h=0;h<n[k].options.length;h++){if(l.getStateWithId(n[k].options[h].ruleId)=="included"){l.setStateWithId(n[k].options[h].ruleId,"available")}}}}},prodStatesExists:function(h){var k=null;if(h!=null&&h.productEvolutions!=null){if(h.productEvolutions.rev){k=h}}if(k==null||k.productEvolutions==undefined){return false}else{return k}},showTree:function(m){var l=new PSTree("prodStatesContainer");l.config.iRootOrientation=PSTree.RO_LEFT;l.config.selectionMode=PSTree.SM_SINGLE;l.config.useTarget=false;var k=m.productEvolutions;this.drawNode(l,k,-1,true);l.createTree();var h=new f();h.setProductStateTreeObj(l)},drawNode:function(s,m,n,r){var h="";var p="";var t="";var q="";var v="";var u="";var l="";if(m!=null&&m!=undefined){p=m.id;t=m.name;q=m.rev;v=m.state;u=m.revision;l=m.derivations;s.add(p,n,t,r,t+" "+q,v,q);if(l.length>0){if(l instanceof Array){for(var o=0;o<l.length;o++){h=l[o];this.drawNode(s,h,p,false)}}else{s.add(p,n,t,r,t+" "+q,v,q)}}if(Object.keys(u).length!=0){this.drawNode(s,u,p,true)}}},addEventOnProdStateSelection:function(k,o,n,m){var p=new f();p._dictionaryInJson.name=o;p._dictionaryInJson.revision=n;var r=p.getEvolutionCriteria();if(m){p.EmptyCacheIdWithState()}if(r.productState==undefined){var l={id:k,name:o,revision:n};p.setEvolutionCriteria({productState:l})}else{r.productState.id=k;r.productState.name=o;r.productState.revision=n}var h=p.getAccordConfigurationFeature();if(h!=null&&h!=undefined&&d.RetrieveElementByClassName("configFeatures")[0].offsetHeight<30){h.toggleItem("configFeatures")}var q="";if(p.getSolverId()){q+=p.getNodeSolverName()}if(q!=""){q+="::"}if(m){d.send_notif("ProductStateSelected:"+q+o+n)}d.RemovePanels()},selectProductState:function(q,r){var s=new f();var p=s.getDictionary().productEvolutions;var o=s.getProductStateTreeObj();var l=null;var t="";var h="";var m="";for(var k=0;k<o.nDatabaseNodes.length;k++){l=o.nDatabaseNodes[k];t=l.dsc;h=l.rev;if(t==q&&h==r){m=l.id}}if(o!=null&&m!=""){o.selectNodeSingle(m,false)}},addEventOnProdStateUnselection:function(){var h=new f();var k=h.getAccordConfigurationFeature();if(k!=null&&k!=undefined&&d.RetrieveElementByClassName("configFeatures")[0].offsetHeight>30){k.toggleItem("configFeatures")}d.RemovePanels()},createQuestionMarkTooltip:function(m,v,h){var r=new f();var k;if(d.RetrieveElement("questionMarkTooltip")){d.RemoveElement("questionMarkTooltip");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}}var u=d.CreateElement("div");var t=d.CreateElement("div");t.id="TextQuestionMarkTooltip";u.id="questionMarkTooltip";if(v.length==0){if(h!=="ERROR"){if(r.getStateWithId(m)=="incompatible"){t.innerHTML=g.i18n("Option")+" "+d.getOptionDisplayNameWithId(m)+" "+g.i18n("is never valid")}else{if(r.getStateWithId(m)=="required"){t.innerHTML=g.i18n("Option")+" "+d.getOptionDisplayNameWithId(m)+" "+g.i18n("is always required")}}}}else{var n=g.i18n("Option #OPTION# is #STATUS# because")+":";n=n.replace("#OPTION#",d.getOptionDisplayNameWithId(m));n=n.replace("#STATUS#",g.i18n(r.getStateWithId(m)));t.innerHTML=n;for(var p=0;p<v.length;p++){if(p>0){t.innerHTML+="<br>"+g.i18n("and because")+":"}for(var o=0;o<v[p].length;o++){k=r.getStateWithId(v[p][o]);if(k=="chosenInConflict"){k="chosen"}else{if(k=="defaultInConflict"){k="default"}else{if(k=="dismissedInConflict"){k="dismissed"}}}var l=g.i18n("#OPTION# is #STATUS#");l=l.replace("#OPTION#",d.getFeatureDisplayNameWithId(v[p][o])+"["+d.getOptionDisplayNameWithId(v[p][o])+"]");l=l.replace("#STATUS#",g.i18n(k));t.innerHTML+="<br><blocquote style='padding-left:20px;'>"+l+"</blocquote>"}}if(h==="ERROR"){t.innerHTML+="<br>"}}if(h==="ERROR"){t.innerHTML+=g.i18n("InfoComputationAborted")}u.appendChild(t);var q=d.CreateElement("img");q.id="CloseQuestionMarkTooltip";q.src=d.getImgPath("close");u.appendChild(q);if(h==="ERROR"){u.style.left=d.RetrieveElement("myfeatureOptions").style.left}else{u.style.left=r.getCoordForTooltipIncompatibilities().x}u.style.top=r.getCoordForTooltipIncompatibilities().y;g.extendElement(u).inject(r.getWidget().body);if((parseInt(u.style.top.split("px")[0])+u.offsetHeight)>d.RetrieveElement("topPanel").offsetHeight){u.style.top=(parseInt(u.style.top.split("px")[0])-u.offsetHeight)+"px"}d.addEvent("click",d.RetrieveElement("CloseQuestionMarkTooltip"),function(){d.RemoveElement("questionMarkTooltip");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}});if(d.RetrieveElement("questionMarkTooltip").offsetHeight>115){d.RetrieveElement("questionMarkTooltip").style.height="115px"}d.addEvent("mouseleave",d.RetrieveElement("questionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(w){w.RetrieveElement("questionMarkTooltip").style.opacity=0})});d.addEvent("mouseenter",d.RetrieveElement("questionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(w){w.RetrieveElement("questionMarkTooltip").style.opacity=1})});d.addEvent("mousedown",d.RetrieveElement("myfeatureOptions"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(w){if(w.RetrieveElement("questionMarkTooltip")){w.RemoveElement("questionMarkTooltip");if(w.onWinEnv()){w.updateWebViewerWidthInNativeEnv(true)}}})});var s={x:"",y:""};r.setCoordForTooltipIncompatibilities(s);if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},CreateConflictTooltip:function(h){if(h.stopPropagation){h.stopPropagation()}var p=(h.currentTarget)?h.currentTarget:h.srcElement;var k;var q=new f();var m=p.parentElement.childNodes[1].id.split("_")[1];if(!d.onWinEnv()){var q=new f();if(q.isAFeature(m)){m="KeyIn_"+m}}if(d.RetrieveElement("redQuestionMarkTooltip")){d.RemoveElement("redQuestionMarkTooltip");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}}var r=q.getListOfListOfImpliedRules();var s=q.getListOfListOfConflictingIds();var t=d.CreateElement("div");var u=d.CreateElement("div");t.id="TextConflictTooltip";u.id="redQuestionMarkTooltip";t.innerHTML=g.i18n("Option")+" "+d.getOptionDisplayNameWithId(m)+" "+g.i18n("is conflicting with")+":";for(var n=0;n<s.length;n++){if(s[n].indexOf(m)!=-1){if(k){t.innerHTML+=g.i18n("and also conflicting with")+":"}for(var l=0;l<s[n].length;l++){if(m!=s[n][l]){t.innerHTML+="<br><blocquote style='padding-left:20px;'>"+d.getFeatureDisplayNameWithId(s[n][l])+"["+d.getOptionDisplayNameWithId(s[n][l])+"] </blocquote>";k=true}}if(r.length>0){for(var l=0;l<r[n].length;l++){if(l==0){t.innerHTML+="<br><blocquote style='padding-left:20px;'> "+g.i18n("Implied Rules")+":</blocquote>"}t.innerHTML+="<br><blocquote style='padding-left:40px;'>"+r[n][l]+"</blocquote>"}}t.innerHTML+="<br>"}if(q.getErrorOnConflictPanel()){t.innerHTML+=g.i18n("InfoComputationAborted")}}u.appendChild(t);var o=d.CreateElement("img");o.id="CloseConflictTooltip";o.src=d.getImgPath("close");u.appendChild(o);if(q.getErrorOnConflictPanel()){u.style.left=d.RetrieveElement("myfeatureOptions").style.left}else{u.style.left=p.getBoundingClientRect().left+"px"}u.style.top=p.getBoundingClientRect().top+"px";g.extendElement(u).inject(q.getWidget().body);if((parseInt(u.style.top.split("px")[0])+u.offsetHeight)>d.RetrieveElement("topPanel").offsetHeight){u.style.top=(parseInt(u.style.top.split("px")[0])-u.offsetHeight)+"px"}d.addEvent("click",d.RetrieveElement("CloseConflictTooltip"),function(){d.RemoveElement("redQuestionMarkTooltip");if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}});if(d.RetrieveElement("redQuestionMarkTooltip").offsetHeight>115){d.RetrieveElement("redQuestionMarkTooltip").style.height="115px"}d.addEvent("mouseleave",d.RetrieveElement("redQuestionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(v){v.RetrieveElement("redQuestionMarkTooltip").style.opacity=0})});d.addEvent("mouseenter",d.RetrieveElement("redQuestionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(v){v.RetrieveElement("redQuestionMarkTooltip").style.opacity=1})});d.addEvent("mousedown",d.RetrieveElement("myfeatureOptions"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(v){if(v.RetrieveElement("redQuestionMarkTooltip")){v.RemoveElement("redQuestionMarkTooltip");if(v.onWinEnv()){v.updateWebViewerWidthInNativeEnv(true)}}})});if(d.onWinEnv()){d.updateWebViewerWidthInNativeEnv(true)}},debugClickDown:function(k){var h=document.getElementById("popupDebug");d.addEvent("mousemove",h,d.moveDebugPopup);h.style.left=(k.clientX-200)+"px";h.style.top=(k.clientY-10)+"px"},debugClickUp:function(k){var h=document.getElementById("popupDebug");d.removeEvent("mousemove",h,d.moveDebugPopup)},debugStartBtnCbk:function(){console.log("Debug tool Started");var h=document.getElementById("debugCheckbox");var l=document.getElementById("debugInputPath");var n="messages";h.disabled="disabled";l.disabled="disabled";if(h.checked){n="messagesAndSolver"}var k=new f();var m={_from:"configurator",_to:"solver",_request:"tracesActivation",_data:{activation:"yes",path:l.value,level:n}};returnFromWebService=d.sendTextToSolver(JSON.stringify(m));if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(o){o.ApplyAnswer(returnFromWebService)})}},debugStopBtnCbk:function(){console.log("Debug tool Stopped");var k=new f();var m={_from:"configurator",_to:"solver",_request:"tracesActivation",_data:{activation:"no"}};returnFromWebService=d.sendTextToSolver(JSON.stringify(m));if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(n){n.ApplyAnswer(returnFromWebService)})}var h=document.getElementById("debugCheckbox");var l=document.getElementById("debugInputPath");h.disabled="";l.disabled=""}};return g.namespace("DS/ConfiguratorWebView/PanelController",a)});define("DS/ConfiguratorWebView/FilterXMLServices",["UWA/Core"],function(b){function a(u){var I=new Object();var v=new Object();var F=new Object();var x=new Object();var l=new Object();var o=new Object();var G="";var d=new Object();var g=new Object();var y={FilterSelection:"FilterSelection",Context:"Context",CfgFilterExpression:"CfgFilterExpression",Feature:"Feature"};var D={selectionMode:"SelectionMode",selectionMode_Build:"Strict",selectionMode_Refine:"150%"};var m=["selectionMode"];var E={ConfigurationCriteria:"configurationCriteria",ApplicationState:"applicationState",AppRulesParam:"app_RulesParam",AppFunc:"app_Func",Dictionary:"dictionary",Rules:"rules",EvolutionCriteria:"evolutionCriteria",};var c={Schema:"xmlns:xs",Namespace:"xmlns",SchemaLocation:"xs:schemaLocation"};var s={ROOT:"CfgFilterExpression",TAG1:"FilterSelection",Schema:"http://www.w3.org/2001/XMLSchema-instance",Namespace:"urn:com:dassault_systemes:config",SchemaLocation:"urn:com:dassault_systemes:config CfgFilterExpression.xsd"};q();function q(){if(u=="FilterExpression"){l=s}}function A(J){I=J[E.AppRulesParam];v=J[E.AppFunc];F=J[E.Dictionary];x=J[E.ConfigurationCriteria];o=J[E.EvolutionCriteria];G=I.selectionMode}function k(){var O='<?xml version="1.0" encoding="UTF-8"?>';var P=[];for(var N in c){P.push(N)}O+="<"+l.ROOT;if(P!=null){for(var M=0;M<P.length;M++){var L=P[M];var K=c[L];var J=s[L];O+=" "+K+"='"+J+"'"}}O+=">";return O}function w(){var K=0;for(var J in x){if(x[J] instanceof Object){if(x[J].State=="chosen"||x[J].State=="required"||x[J].State=="default"||x[J].State=="chosenInConflict"||x[J].State=="recommanded"||x[J].State=="dismissedInConflict"||x[J].State=="dismissed"||x[J].State=="incompatible"||x[J].State=="defaultInConflict"){K++}}}return K}function p(J,O,Q,L){var N="<"+O;if(Q!=null){for(var P=0;P<Q.length;P++){var M=Q[P];if(D[M]!=undefined){var K=D[M];attrVal=D[J[M]];attrVal=B(attrVal);N+=" "+K+"='"+attrVal+"'"}else{attrVal=J[M];attrVal=B(attrVal);N+=" "+M+"='"+attrVal+"'"}}}if(!L){N+=">"}else{N+="/>"}return N}function n(J){return"</"+J+">"}function B(J){if(typeof(J)=="string"){return J.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}else{return J}}function e(O){var T="NoSelection";var S=F.features;for(var M in S){var L=S[M];var N=L.options;var U=false;if(N instanceof Object){for(var R in N){var Q=N[R].ruleId;if(Q!=undefined&&Q.toString().trim()==O){U=true;break}}if(U){for(var R in N){var Q=N[R].ruleId;if(Q!=undefined){for(var P in x){if(x[P] instanceof Object){var K=x[P].Id;var J=x[P].State;if(K==Q){if(J=="chosen"||J=="chosenInConflict"){if(T=="NoSelection"||T=="ruleSelection"){T="userSelection"}else{if(T=="userReject"||T=="userRejectAndRuleSelection"){T="userSelectionAndUserReject"}else{if(T=="ruleReject"||T=="ruleSelectionAndRuleReject"){T="userSelectionAndRuleReject"}}}}else{if(J=="required"||J=="default"||J=="defaultInConflict"||J=="recommanded"){if(T=="NoSelection"){T="ruleSelection"}else{if(T=="userReject"){T="userRejectAndRuleSelection"}else{if(T=="ruleReject"){T="ruleSelectionAndRuleReject"}}}}else{if(J=="dismissed"||J=="dismissedInConflict"){if(T=="NoSelection"||T=="ruleReject"){T="userReject"}else{if(T=="userSelection"||T=="userSelectionAndRuleReject"){T="userSelectionAndUserReject"}else{if(T=="ruleSelection"||T=="ruleSelectionAndRuleReject"){T="userRejectAndRuleSelection"}}}}else{if(J=="incompatible"){if(T=="NoSelection"){T="ruleReject"}else{if(T=="userSelection"){T="userSelectionAndRuleReject"}else{if(T=="ruleSelection"){T="ruleSelectionAndRuleReject"}}}}}}}}}}}}break}}}return T}function C(){var J="";J+=k();J+=p(I,l.TAG1,m,false);var O=w();if(o!=undefined){J+=f()}if(O>0){for(var L in x){if(x[L] instanceof Object){var P=x[L].Id;var N=x[L].State;var K=e(P);if(N=="chosen"||N=="required"||N=="default"||N=="chosenInConflict"||N=="defaultInConflict"||x[L].State=="recommanded"){if(K=="userSelection"||K=="userSelectionAndUserReject"||K=="userSelectionAndRuleReject"||K=="ruleSelection"||K=="ruleSelectionAndRuleReject"){J+=z(P,false,N)}}else{if(N=="dismissed"||N=="incompatible"||N=="dismissedInConflict"){if(K=="userReject"||K=="ruleReject"||K=="userRejectAndRuleSelection"){J+=z(P,true,N)}}}}}}var M=true;for(var Q in d){if(d.hasOwnProperty(Q)){M=false}}if(!M){J+=H()}J+=n(l.TAG1);J+=n(l.ROOT);return J}function f(){var L="";if(o.productState){var K=o.productState.name;var M=o.productState.revision;var J=F.model.label;L+='<TreeSeries Type="ProductState" Name="'+J+'">';L+='<Single Name="'+K+'" Revision="'+M+'" />';L+="</TreeSeries>"}return L}function t(K,J,L){if(d[K]==undefined){d[K]=[]}if(g[K]==undefined){g[K]=[]}d[K].push(J);g[K].push(L)}function H(){var M="";for(var L in d){var K=F.features;for(var P in K){var O=K[P].ruleId;if(O!=undefined&&O.toString().trim()==L){var N=K[P].name;M+="<NOT>";M+=h(N,false,false);for(var J=0;J<d[L].length;J++){coName=d[L][J];optionState=g[L][J];M+=h(coName,true,true,optionState)}M+=n("Feature");M+=n("NOT");break}}}return M}function z(K,R,J){var S="";var T=F.features;for(var N in T){var L=T[N];var U=L.name;var O=L.options;if(O instanceof Object){for(var Q in O){var M=O[Q].name;if(M!=undefined&&M!=null){var P=O[Q].ruleId;if(P!=undefined&&P.toString().trim()==K){if(R){if(L.selectionType=="Multiple"){S+="<NOT>";S+=h(U,false,false);S+=h(M,true,true,J);S+=n("Feature");S+=n("NOT")}else{t(L.ruleId,M,J);return S}}else{S+=h(U,false,false);S+=h(M,true,true,J);S+=n("Feature")}}}}}}return S}function h(M,K,J,N){var L="";L+='<Feature Type="ConfigFeature" Name="'+M+'"';if(J&&N){if(N=="default"||N=="defaultInConflict"){L+=' SelectedBy="Default"'}else{if(N=="required"||N=="incompatible"){L+=' SelectedBy="Rule"'}else{L+=' SelectedBy="User"'}}}if(!K){L+=">"}else{L+="/>"}return L}this.json2xml_str=function(J){A(J);return C()};this.parseXml=function(J){var L=null;if(window.DOMParser){try{L=(new DOMParser()).parseFromString(J,"text/xml")}catch(K){L=null}}else{if(window.ActiveXObject){try{L=new ActiveXObject("Microsoft.XMLDOM");L.async=false;if(!L.loadXML(J)){window.alert(L.parseError.reason+L.parseError.srcText)}}catch(K){L=null}}else{alert("cannot parse xml string!")}}return L};this.xmlToJson=function(M){var K={};if(M.nodeType==1){if(M.attributes.length>0){K.attributes={};for(var L=0;L<M.attributes.length;L++){var P=M.attributes.item(L);K.attributes[P.nodeName]=P.value}}}else{if(M.nodeType==3){K=M.nodeValue}}if(M.hasChildNodes()){for(var N=0;N<M.childNodes.length;N++){var O=M.childNodes.item(N);var Q=O.nodeName;if(typeof(K[Q])=="undefined"){K[Q]=r(O)}else{if(typeof(K[Q].push)=="undefined"){var J=K[Q];K[Q]=[];K[Q].push(J)}K[Q].push(r(O))}}}return K};var r=function(M){var K={};if(M.nodeType==1){if(M.attributes.length>0){K.attributes={};for(var L=0;L<M.attributes.length;L++){var P=M.attributes.item(L);K.attributes[P.nodeName]=P.value}}}else{if(M.nodeType==3){K=M.nodeValue}}if(M.hasChildNodes()){for(var N=0;N<M.childNodes.length;N++){var O=M.childNodes.item(N);var Q=O.nodeName;if(typeof(K[Q])=="undefined"){K[Q]=r(O)}else{if(typeof(K[Q].push)=="undefined"){var J=K[Q];K[Q]=[];K[Q].push(J)}K[Q].push(r(O))}}}return K}}return b.namespace("DS/ConfiguratorWebView/FilterXMLServices",a)});define("DS/ConfiguratorWebView/Utilities",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/FilterXMLServices","DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView"],function(f,e,c,d,a){var b={RetrieveElement:function(g){return document.getElementById(g)},RetrieveElementByTags:function(g){return document.getElementsByTagName(g)},RetrieveElementByClassName:function(g){return document.getElementsByClassName(g)},CreateElement:function(g){return document.createElement(g)},getBody:function(){return document.body},getPageSize:function(){return{x:this.getBody().clientWidth,y:this.getBody().clientHeight}},RemoveElement:function(h){var g=this.RetrieveElement(h);if(g){g.parentNode.removeChild(g)}},addEvent:function(k,h,g){if(h.addEventListener){h.addEventListener(k,g,false)}else{if(h.attachEvent){if(k=="wheel"){h.attachEvent("onmouse"+k,g)}else{h.attachEvent("on"+k,g)}}else{h[k]=g}}},removeEvent:function(k,h,g){if(h.removeEventListener){h.removeEventListener(k,g,false)}else{if(h.detachEvent){h.detachEvent("on"+k,g)}else{h[k]=g}}},getImgPath:function(g){var k;if(g=="rightArrow"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")}if(g=="leftArrow"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LeftArrow.png")}if(g=="multiSelection"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_MultiSelection.png")}if(g=="multiSelectionSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_MultiSelection.png")}if(g=="optim"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_ProposeOptimized.png")}if(g=="optimSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_ProposeOptimized.png")}if(g=="dependencies"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_EnforceRequired.png")}if(g=="dependenciesSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_EnforceRequired.png")}if(g=="incompatibilities"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_DisableIncompatible.png")}if(g=="incompatibilitiesSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_DisableIncompatible.png")}if(g=="completeConfMode"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_SelectComplete.png")}if(g=="completeConfModeSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_SelectComplete.png")}if(g=="levelUnselected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelUnselected.png")}if(g=="levelSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelSelected.png")}if(g=="levelPlus"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelPlus.png")}if(g=="levelMinus"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelMinus.png")}if(g=="levelNoIndicator"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelNoIndicator.png")}if(g=="levelIndicator"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelIndicator.png")}if(g=="selectLevel"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/SelectLevel.png")}if(g=="refine"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Refine.png")}if(g=="refineSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RefineSelected.png")}if(g=="build"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Build.png")}if(g=="buildSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/BuildSelected.png")}if(g=="noStateIcon"||g=="maySelectFeature"||g=="levelEmpty"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/NoState.png")}if(g=="exclamationMark"||g=="mustSelectFeature"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/ExclamationMark.png")}if(g=="chosen"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/ChosenByUser.png")}if(g=="dismissedFeature"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DismissedByUser.png")}if(g=="default"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Default.png")}if(g=="requiredByRules"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RequiredByRules.png")}if(g=="recommanded"){var h=new e();if(h.getRulesMode()==="RulesMode_SelectCompleteConfiguration"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/NoState.png")}else{k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RecommendedByOptim.png")}}if(g=="chosenInConflict"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/ChosenByUserRed.png")}if(g=="dismissedInConflict"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DismissedByUserRed.png")}if(g=="defaultInConflict"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultRed.png")}if(g=="keyIn"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/KeyInByUser.png")}if(g=="defaultFeatureImage"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultImage.png")}if(g=="Input"||g=="Text Area"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/TextType.png")}if(g=="Integer"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/IntegerType.png")}if(g=="Real"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RealType.png")}if(g=="Date"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DateType.png")}if(g=="checkIcon"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_SelectMode.png")}if(g=="checkIconSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_SelectMode.png")}if(g=="rejectIcon"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_RejectMode.png")}if(g=="rejectIconSelected"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_RejectMode.png")}if(g=="questionMark"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/QuestionMark.png")}if(g=="redQuestionMark"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/QuestionMarkRed.png")}if(g=="check"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxSelected.png")}if(g=="dismissed"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxDismissed.png")}if(g=="included"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxIncluded.png")}if(g=="incompatible"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxIncompatible.png")}if(g=="required"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxRequired.png")}if(g=="available"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxAvailable.png")}if(g=="check_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioSelected.png")}if(g=="dismissed_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioDismissed.png")}if(g=="included_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioIncluded.png")}if(g=="incompatible_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioIncompatible.png")}if(g=="required_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioRequired.png")}if(g=="available_radio"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioAvailable.png")}if(g=="completeProduct"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Complete_Product.png")}if(g=="hybridProduct"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Hybrid_Product.png")}if(g=="partialProduct"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Partial_Product.png")}if(g=="defaultFeatureImage"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultImage.png")}if(g=="close"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")}if(g=="warning"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Warning.png")}if(g=="info"){k=d.getWebappsAssetUrl("ConfiguratorWebView","icons/Info.png")}return k},isDefault:function(n){var l=new e();var m=l.getDictionary().features;if(l.getRulesActivation()==="true"){var k=l.getDefaultOptionsList();if(k.indexOf(n)!==-1){return true}}else{for(var h=0;h<m.length;h++){for(var g=0;g<m[h].options.length;g++){if(m[h].options[g].ruleId===n){if(m[h].options[g].defaultSelection==="Yes"){return true}else{return false}}}}}return false},isRefineModeEnabled:function(h){var g=new e();if(g.getPCPurpose()=="Evaluation"&&g.getRefineSelMode()=="true"){return true}else{false}},getFeatureNameWithId:function(m){var k=new e();var l=k.getDictionary().features;for(var h=0;h<l.length;h++){if(l[h].ruleId==m){return l[h].name}for(var g=0;g<l[h].options.length;g++){if(l[h].options[g].ruleId==m){return l[h].name}}}return},getFeatureDisplayNameWithId:function(m){var k=new e();var l=k.getDictionary().features;if(m.indexOf("KeyIn")==0){m=m.split("_")[1]}for(var h=0;h<l.length;h++){if(l[h].ruleId==m){return l[h].displayName}for(var g=0;g<l[h].options.length;g++){if(l[h].options[g].ruleId==m){return l[h].displayName}}}return},getOptionDisplayNameWithId:function(m){var k=new e();var l=k.getDictionary().features;if(m.indexOf("KeyIn")==0){return"Key In"}for(var h=0;h<l.length;h++){for(var g=0;g<l[h].options.length;g++){if(l[h].options[g].ruleId==m){return l[h].options[g].displayName}}}return},loadJSON:function(h,l,g){var k=new XMLHttpRequest();k.onreadystatechange=function(){if(k.readyState===4){if(k.status===200||k.status===0){if(l){l(JSON.parse(k.responseText))}}else{if(g){g(k)}}}};k.open("GET",h,true);k.send()},send_notif:function(g){if(this.onWinEnv()&&!window.__karma__){dscef.sendString("notifText="+g)}},RemovePanels:function(){var g=this;if(this.RetrieveElement("filterPanel")){this.RemoveElement("filterPanel")}if(this.RetrieveElement("myfeatureOptions")){this.RemoveElement("myfeatureOptions");if(b.onWinEnv()){b.updateWebViewerWidthInNativeEnv(true)}}if(this.RetrieveElement("addAttrColumnPanel")){this.RemoveElement("addAttrColumnPanel")}if(this.RetrieveElement("questionMarkTooltip")){this.RemoveElement("questionMarkTooltip");if(b.onWinEnv()){b.updateWebViewerWidthInNativeEnv(true)}}if(this.RetrieveElement("redQuestionMarkTooltip")){this.RemoveElement("redQuestionMarkTooltip");if(b.onWinEnv()){b.updateWebViewerWidthInNativeEnv(true)}}},getElipsisValue:function(h){var g="";if(h){h=h.split("\n").join(" ");g=h.substr(0,30);if(h.length>30){g+="..."}}return g},replaceAll:function(k,h,g){while(k.indexOf(h)!=-1){k=k.replace(h,g)}return k},SetSizeOfAttributsCellsTable:function(p,g,o){var n,m;for(n=0;n<p.rows.length;n++){if(p.rows[n].cells[0].id=="keyInOption"){continue}var h=0;var l;if(g.id=="tableAttrTitle"){h=this.RetrieveElement("tableFixAttrTitle").rows[0].cells.length;l=this.RetrieveElement("tableFixAttrTitle")}else{if(g.id=="tableOptionsAttrTitle"){h=this.RetrieveElement("tableOptionsFixAttrTitle").rows[0].cells.length}}if(l){for(m=1;m<=l.rows[0].cells.length;m++){p.rows[n].cells[m].style.width=(l.rows[0].cells[m-1].offsetWidth)+"px"}}for(m=h+1;m<=(g.rows[0].cells.length)+h-1;m++){p.rows[n].cells[m].style.width=(g.rows[0].cells[m-h-1].offsetWidth)+"px"}}if(o.id=="divFeatureOptions"){o.style.width=this.RetrieveElement("SearchOptions").offsetWidth+this.RetrieveElement("tableOptionsFixAttrTitle").offsetWidth+this.RetrieveElement("tableOptionsAttrTitle").offsetWidth+"px"}},removeAttrListPanel:function(g){if(g.stopPropagation){g.stopPropagation()}else{g.cancelBubble=true}if(this.RetrieveElement("addAttrColumnPanel")){this.RemoveElement("addAttrColumnPanel")}if(this.RetrieveElement("myfeatureOptions")){this.removeEvent("mousedown",this.RetrieveElement("myfeatureOptions"),this.removeAttrListPanel)}},CallSolveMethodOnSolver:function(){var k=new e();if(k.getRulesActivation()=="true"){var h={configurationCriteria:k.getAdaptedConfigurationCriteria()};var l={_from:"configurator",_to:"solverConfiguration",_request:"solveAndDiagnoseAll",_data:h};var g=this.sendTextToSolver(JSON.stringify(l));if(g!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(m){m.ApplyAnswer(g)})}if(this.RetrieveElement("content")){this.createLoader()}k.setConfigurationCriteria(k.getConfigurationCriteria())}},createLoader:function(){var k=new e();var h=k.getWidget().createElement("div");h.style.left="0px";h.style.top="0px";h.style.width="100%";h.style.height="100%";h.style.position="absolute";h.id="divLoader";h.style.backgroundImage="url("+d.getWebappsAssetUrl("ConfiguratorWebView","icons/transparentImageForLoader.png")+")";var g,l;g=this.RetrieveElement("configPanel").offsetWidth/2-31;l=this.getPageSize().y/2-38;h.addEventListener("click",function(m){var n=(m.currentTarget)?m.currentTarget:m.srcElement;if(m.stopPropagation){m.stopPropagation()}else{m.cancelBubble=true}},false);h.innerHTML='<div id="floatingBarsG" style="left:'+g+"px; top:"+l+'px;"><div class="blockG" id="rotateG_01"></div><div class="blockG" id="rotateG_02"></div><div class="blockG" id="rotateG_03"></div><div class="blockG" id="rotateG_04"></div><div class="blockG" id="rotateG_05"></div><div class="blockG" id="rotateG_06"></div><div class="blockG" id="rotateG_07"></div><div class="blockG" id="rotateG_08"></div></div>';f.extendElement(h).inject(k.getWidget().body)},setSelectionModeOnSolver:function(h,l){var g=new e();var k={_from:"configurator",_to:"solverConfiguration",_request:"setSelectionMode",_data:h};returnFromWebService=this.sendTextToSolver(JSON.stringify(k),l);if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(m){m.ApplyAnswer(returnFromWebService)})}},setOptimizationFunctionOnSolver:function(){var k=new e();var g=[];var h=0;var m=k.cacheIdWithPrice;for(id in m){if(k.isAnOption(id)&&m[id]!="0.0"){g.push({id:id,coefficient:m[id]})}}var l={_from:"configurator",_to:"solverConfiguration",_request:"setOptimizationFunction",_data:{optimizationMode:"min",optimizationCoefficients:g}};returnFromWebService=this.sendTextToSolver(JSON.stringify(l));if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(n){n.ApplyAnswer(returnFromWebService)})}},getJsonKeys:function(h){var l=[];var k;var g;k=h;for(g in k){l.push(g)}return l},sendXMLtoNativeEnv:function(){if(this.onWinEnv()){var h=this;var m=new e();var g=new c("FilterExpression");var l={configurationCriteria:m.getConfigurationCriteria(),dictionary:m.getDictionary(),app_RulesParam:m.getAppRulesParam(),app_Func:m.getAppFunc(),evolutionCriteria:m.getEvolutionCriteria()};var k=g.json2xml_str(l);if(k&&m.get3DCounter()!==0){h.send_notif("XMLFor3DRendering:"+k);m.set3DCounter(0)}}},RemoveAllSpecifiedStateOccurrenceInFeature:function(o,m){var k=new e();var n=k.getDictionary().features;var p;var l="";for(var h=0;h<n.length;h++){if(n[h].ruleId==o){for(var g=0;g<n[h].options.length;g++){if(k.getStateWithId(n[h].options[g].ruleId)==m){k.setStateWithId(n[h].options[g].ruleId,"available");isInInput=this.RetrieveElement("input"+o).value.indexOf(n[h].options[g].name);if(m=="dismissed"){l="Except "}this.RetrieveElement("input"+o).value=this.RetrieveElement("input"+o).value.replace(l+n[h].options[g].name+"\n","");if(this.RetrieveElement("input"+o).value!=""&&isInInput!=-1){this.RetrieveElement("input"+o).rows--;if(this.RetrieveElement("myfeatureOptions")){this.RetrieveElement("myfeatureOptions").style.left=(this.RetrieveElement("input"+o).getBoundingClientRect().left-this.RetrieveElement("configPanel").getBoundingClientRect().left)+"px";this.RetrieveElement("myfeatureOptions").style.top=(this.RetrieveElement("input"+o).getBoundingClientRect().bottom-this.RetrieveElement("configPanel").getBoundingClientRect().top)+"px"}}}}if(!this.onWinEnv()&&n[h].keyInType&&n[h].keyInType!="Blank"){if(k.getStateWithId("KeyIn_"+o)==m){k.setStateWithId("KeyIn_"+o,"available");var q=k.getKeyInValueById("KeyIn_"+o);q=this.getElipsisValue(q);isInInput=this.RetrieveElement("input"+o).value.indexOf(q);if(this.RetrieveElement("input"+o).value!=""&&isInInput!=-1){this.RetrieveElement("input"+o).rows--;if(this.RetrieveElement("myfeatureOptions")){this.RetrieveElement("myfeatureOptions").style.left=(this.RetrieveElement("input"+o).getBoundingClientRect().left-this.RetrieveElement("configPanel").getBoundingClientRect().left)+"px";this.RetrieveElement("myfeatureOptions").style.top=(this.RetrieveElement("input"+o).getBoundingClientRect().bottom-this.RetrieveElement("configPanel").getBoundingClientRect().top)+"px"}}}}break}}},DetectMultiSelOnSingleFeatures:function(){var l=new e();var o=l.getDictionary().features;var m=0;var g=false;for(var k=0;k<o.length;k++){m=0;if(o[k].selectionType=="Single"){for(var h=0;h<o[k].options.length;h++){if(l.getStateWithId(o[k].options[h].ruleId)=="chosen"||l.getStateWithId(o[k].options[h].ruleId)=="chosenInConflict"||l.getStateWithId(o[k].options[h].ruleId)=="default"||l.getStateWithId(o[k].options[h].ruleId)=="defaultInConflict"){m++}}if(!this.onWinEnv()&&o[k].keyInType&&o[k].keyInType!="Blank"){var n=l.getStateWithId("KeyIn_"+o[k].ruleId);if(n=="chosen"||n=="chosenInConflict"||n=="default"||n=="defaultInConflict"){m++}}if(m>1){g=true;break}}if(g){break}}return g},ResetMultiSelOnSingleFeatures:function(){var l=new e();var o=l.getDictionary().features;var g=[];for(var k=0;k<o.length;k++){if(o[k].selectionType=="Single"){var m=0;for(var h=0;h<o[k].options.length;h++){if(l.getStateWithId(o[k].options[h].ruleId)=="chosen"||l.getStateWithId(o[k].options[h].ruleId)=="chosenInConflict"){m++}}if(!this.onWinEnv()&&o[k].keyInType&&o[k].keyInType!="Blank"){var n=l.getStateWithId("KeyIn_"+o[k].ruleId);if(n=="chosen"||n=="chosenInConflict"){m++}}if(m>1){for(var h=0;h<o[k].options.length;h++){if(l.getStateWithId(o[k].options[h].ruleId)=="chosen"||l.getStateWithId(o[k].options[h].ruleId)=="chosenInConflict"){l.setStateWithId(o[k].options[h].ruleId,"available");if(g.indexOf(o[k].ruleId)==-1){g.push(o[k].ruleId)}}}if(!this.onWinEnv()&&o[k].keyInType&&o[k].keyInType!="Blank"){var n=l.getStateWithId("KeyIn_"+o[k].ruleId);if(n=="chosen"||n=="chosenInConflict"){l.setKeyInValueById("KeyIn_"+o[k].ruleId,"");if(g.indexOf(o[k].ruleId)==-1){g.push(o[k].ruleId)}}}}}}return g},DetectMultiSelOnFeature:function(p){var n=new e();var o=n.getDictionary().features;var q=0;var k=false;var g;for(var m=0;m<o.length;m++){if(o[m].name==p){for(var l=0;l<o[m].options.length;l++){g=n.getStateWithId(o[m].options[l].ruleId);if(g=="chosen"||g=="chosenInConflict"||g=="default"||g=="defaultInConflict"||g=="required"){q++}}if(!this.onWinEnv()&&o[m].keyInType&&o[m].keyInType!="Blank"){var h=n.getStateWithId("KeyIn_"+o[m].ruleId);if(h=="chosen"||h=="chosenInConflict"){q++}}if(q>1){k=true}break}}return k},askQuestionMarkReasonToSolver:function(h,l){var g=new e();var k={x:h.getBoundingClientRect().left+"px",y:h.getBoundingClientRect().top-5+"px"};g.setCoordForTooltipIncompatibilities(k);var m={_from:"configurator",_to:"solverConfiguration",_request:"getResultingStatusOriginators",_data:l};returnFromWebService=this.sendTextToSolver(JSON.stringify(m));if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(n){n.ApplyAnswer(returnFromWebService)})}this.createLoader()},onWinEnv:function(){var g=new e();return g.getOnWinEnv()},checkEnvWithUrl:function(){var h=new e();var l=window.location.search.substring(1);var k=l.split("&");for(var g=0;g<k.length;g++){var m=k[g].split("=");if(m[0]=="onWinEnv"){if(m[1]=="true"){h.setOnWinEnv(true)}else{h.setOnWinEnv(false)}}}},getIdWithFeatureAndOptionNames:function(h,m){var l=new e();var n=l.getDictionary().features;for(var k=0;k<n.length;k++){if(n[k].name==h){for(var g=0;g<n[k].options.length;g++){if(n[k].options[g].name==m){return n[k].options[g].ruleId}}}}},sendTextToSolver:function(m,o){var l=new e();if(this.onWinEnv()){if(l.getNodeSolver()){l.getNodeSolver().sendText(l.getSolverId(),m)}}else{if(parent.onWidgetLoad){var n=this.getHostURL();var g;var k=n+"/resources/cfg/configurator/solver/computeAnswer";var h=l.getSolverId();f.Data.request(k,{method:"POST",type:"text/html",async:true,timeout:60000,onComplete:function(p){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(q){q.ApplyAnswer(p,o)})},onFailure:function(p){console.log("failed while getting computeAnswer result ="+p);alert(JSON.parse(arguments[1]).message)},data:{solverId:h,selectedCriteria:m}});console.log("retResult"+g);return g}}},getHostURL:function(){var g=location.pathname.substring(0,location.pathname.indexOf("/",1));if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return window.location.origin.concat(g)}else{return location.origin.concat(g)}},resizeWindow:function(l){var k=this;var n=k.RetrieveElement("content").offsetLeft;var m=window.outerWidth-window.innerWidth;var h=n*2+m;var g=k.RetrieveElement("content").offsetWidth;if(window.parent.getTopWindow){window.parent.getTopWindow().resizeTo(g+h,window.outerHeight)}k.enableScrollInOptionPanel()},enableScrollInOptionPanel:function(){var h=this.RetrieveElement("myfeatureOptions");if(h!=null){var g=h.offsetleft;var k=window.innerWidth-g-8;h.style.maxWidth=k+"px"}},getRealPath:function(k,l){var h="";var g="";g=l.getUrl();h=f.Utils.buildUrl(this.removeParameterOfUrl(g),k);return h},removeParameterOfUrl:function(g){var h=g.split("?");if(h.length>0){return h[0]}},setLanguageFile:function(l){var h=new e();var g=d.getWebappsAssetUrl("ConfiguratorWebView","nls/langWW_"+l+".json");var k=true;f.Data.request(g,{type:"json",method:"GET",async:false,onComplete:function(m){k=false;f.i18n(m)},onFailure:function(m,n){k=false;f.i18n(n)},onCancel:function(){},onTimeout:function(m){}});if(k==true&&l!="en"){this.setLanguageFile("en")}},GetOptionsListForSpecifiedFeature:function(h){var l=[];var g=new e();var k=g.getCacheOptionsIdWithFeatureId();for(options in k){if(k[options]==h&&options!=h){l.push(options)}}return l},setDefaultOptions:function(){var k=new e();var l=k.getDictionary().features;for(var h=0;h<l.length;h++){for(var g=0;g<l[h].options.length;g++){if(this.isDefault(l[h].options[g].ruleId)){k.setStateWithId(l[h].options[g].ruleId,"default")}}}},CheckRulesConsistency:function(){var g={_from:"configurator",_to:"solverConfiguration",_request:"checkModelConsistency",_data:""};returnFromWebService=this.sendTextToSolver(JSON.stringify(g));if(this.RetrieveElement("content")){this.createLoader()}if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(h){h.ApplyAnswer(returnFromWebService)})}},setAlwaysDiagnosed:function(){var k=new e();var l=[];var h=k.getDictionary().features;for(var g=0;g<h.length;g++){l.push(h[g].ruleId)}var m={_from:"configurator",_to:"solverConfiguration",_request:"setAlwaysDiagnosed",_data:{alwaysDiagnosedIds:l}};returnFromWebService=b.sendTextToSolver(JSON.stringify(m));if(returnFromWebService!=undefined){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(n){n.ApplyAnswer(returnFromWebService)})}},showInfoBox:function(s,p){var k=this.RetrieveElement("InfoBox");var g=this.RetrieveElement("TextInfoBox");var l=this.RetrieveElement("IconInfoBox");if(k&&k.value=="InfoBoxHidden"&&g){g.innerHTML=s;l.value=p;l.src=this.getImgPath(p);k.style.top="-"+k.offsetHeight+"px";k.value="InfoBoxVisible"}else{if(k&&k.value=="InfoBoxVisible"&&g){this.deleteInfoBox();this.showInfoBox(s,p)}else{if(!k){var h=this.CreateElement("div");h.id="InfoBox";var l=this.CreateElement("img");l.id="IconInfoBox";l.value=p;l.src=this.getImgPath(p);var m=this.CreateElement("div");m.id="TextInfoBox";var n=this.CreateElement("img");n.id="CloseInfoBox";n.src=this.getImgPath("close");n.onclick=this.hideInfoBox();h.appendChild(l);h.appendChild(m);h.appendChild(n);this.RetrieveElement("content").appendChild(h);var o=this.RetrieveElement("InfoBox");var r=this.RetrieveElement("TextInfoBox");r.innerHTML=s;o.style.top="-"+o.offsetHeight+"px";o.value="InfoBoxVisible";var q=this;this.addEvent("click",this.RetrieveElement("CloseInfoBox"),function(){q.hideInfoBox()})}}}},hideInfoBox:function(){var g=new e();var k=this.RetrieveElement("InfoBox");if(k){k.style.top="10px";k.value="InfoBoxHidden";var h=this.RetrieveElement("TextInfoBox");if(h.innerHTML==f.i18n("InfoMultiSelAndRules")){g._showWarningInfoBox=false}}},deleteInfoBox:function(){var g=this.RetrieveElement("InfoBox");if(g){this.RemoveElement("InfoBox")}},setConfCriteriaFromXMLVar:function(q){var t=new e();var l=new c("FilterExpression");var r=l.xmlToJson(l.parseXml(q));var h;var s;var u;var w;var g;t.EmptyCacheIdWithState();var v;if(r.CfgFilterExpression.FilterSelection.Context){v=r.CfgFilterExpression.FilterSelection.Context}else{v=r.CfgFilterExpression.FilterSelection}if(v.Feature){var m=v.Feature.length;if(m==undefined){featureName=v.Feature.attributes.Name;g=v.Feature.Feature.length;if(g==undefined){optionName=v.Feature.Feature.attributes.Name;if(v.Feature.Feature.attributes.SelectedBy){w=v.Feature.Feature.attributes.SelectedBy;if(w=="User"){h="chosen"}else{if(w=="Rule"){h="required"}else{if(w=="Default"){h="default"}}}}else{h="chosen"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}for(var o=0;o<g;o++){optionName=v.Feature.Feature[o].attributes.Name;if(v.Feature.Feature[o].attributes.SelectedBy){w=v.Feature.Feature[o].attributes.SelectedBy;if(w=="User"){h="chosen"}else{if(w=="Rule"){h="required"}else{if(w=="Default"){h="default"}}}}else{h="chosen"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}}for(var p=0;p<m;p++){featureName=v.Feature[p].attributes.Name;g=v.Feature[p].Feature.length;if(g==undefined){optionName=v.Feature[p].Feature.attributes.Name;if(v.Feature[p].Feature.attributes.SelectedBy){w=v.Feature[p].Feature.attributes.SelectedBy;if(w=="User"){h="chosen"}else{if(w=="Rule"){h="required"}else{if(w=="Default"){h="default"}}}}else{h="chosen"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}for(var o=0;o<g;o++){optionName=v.Feature[p].Feature[o].attributes.Name;if(v.Feature[p].Feature[o].attributes.SelectedBy){w=v.Feature[p].Feature[o].attributes.SelectedBy;if(w=="User"){h="chosen"}else{if(w=="Rule"){h="required"}else{if(w=="Default"){h="default"}}}}else{h="chosen"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}}}if(v.NOT){var x=v.NOT.length;if(x==undefined){featureName=v.NOT.Feature.attributes.Name;if(v.NOT.Feature.Feature.length==undefined){optionName=v.NOT.Feature.Feature.attributes.Name;if(v.NOT.Feature.Feature.attributes.SelectedBy){w=v.NOT.Feature.Feature.attributes.SelectedBy;if(w=="User"){h="dismissed"}else{if(w=="Rule"){h="incompatible"}}}else{h="dismissed"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}else{for(var n=0;n<v.NOT.Feature.Feature.length;n++){optionName=v.NOT.Feature.Feature[n].attributes.Name;if(v.NOT.Feature.Feature[n].attributes.SelectedBy){w=v.NOT.Feature.Feature[n].attributes.SelectedBy;if(w=="User"){h="dismissed"}else{if(w=="Rule"){h="incompatible"}}}else{h="dismissed"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}}}for(var p=0;p<x;p++){featureName=v.NOT[p].Feature.attributes.Name;if(v.NOT[p].Feature.Feature.length==undefined){optionName=v.NOT[p].Feature.Feature.attributes.Name;if(v.NOT[p].Feature.Feature.attributes.SelectedBy){w=v.NOT[p].Feature.Feature.attributes.SelectedBy;if(w=="User"){h="dismissed"}else{if(w=="Rule"){h="incompatible"}}}else{h="dismissed"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}else{for(var n=0;n<v.NOT[p].Feature.Feature.length;n++){optionName=v.NOT[p].Feature.Feature[n].attributes.Name;if(v.NOT[p].Feature.Feature[n].attributes.SelectedBy){w=v.NOT[p].Feature.Feature[n].attributes.SelectedBy;if(w=="User"){h="dismissed"}else{if(w=="Rule"){h="incompatible"}}}else{h="dismissed"}t.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),h)}}}}},CheckIfDismissedIsPossible:function(m){var l=new e();var n=l.getDictionary().features;var k=l.getFeatureIdWithOptionId(m);var o=false;var p;for(var h=0;h<n.length;h++){if(n[h].ruleId===k){if(n[h].selectionCriteria==="May"){o=true;return o}else{for(var g=0;g<n[h].options.length;g++){if(n[h].options[g].ruleId!==m){p=l.getStateWithId(n[h].options[g].ruleId);if(p!=="dismissed"&&p!=="incompatible"){o=true;return o}}}}break}}return o},isIncompatibleWithUserSelection:function(l){var k=new e();var m=k.getDictionary().features;var n;for(var h=0;h<m.length;h++){if(m[h].ruleId===l){for(var g=0;g<m[h].options.length;g++){n=k.getStateWithId(m[h].options[g].ruleId);if(n==="dismissed"||n==="dismissedInConflict"){return true}}break}}return false},setWidget:function(h){var g=new e();g.setWidget(h)},orderOptionsPanel:function(){var k=new e();var l=document.getElementById("tableOptionsAttr");var n=l.getElementsByTagName("tr");for(var h=0,g=n.length;h<g;h++){var m=n[h].children[0].children[1].children[0].id.split("_")[1];var p=k.getStateWithId(m);if(p=="incompatible"){var o=n[h].parentNode.removeChild(n[h]);l.appendChild(o)}}},updateWebViewerWidthInNativeEnv:function(h){if(h){this.send_notif("SetFullScreenOnWebViewer")}else{if(!h){var g=this;setTimeout(function(){var l=0;var n=0;var o=0;var k=0;var m=0;var p;if(b.RetrieveElement("configPanel").offsetWidth>30){l=b.RetrieveElement("configPanel").offsetWidth+10}if(g.RetrieveElement("myfeatureOptions")){n=g.RetrieveElement("myfeatureOptions").getBoundingClientRect().right+10}if(b.RetrieveElement("redQuestionMarkTooltip")){k=g.RetrieveElement("redQuestionMarkTooltip").getBoundingClientRect().right+10}if(b.RetrieveElement("questionMarkTooltip")){o=g.RetrieveElement("questionMarkTooltip").getBoundingClientRect().right+10}if(b.RetrieveElement("popupDebug")){m=g.RetrieveElement("popupDebug").getBoundingClientRect().right+10}p=Math.max(l,n,k,o,m);g.send_notif("UpdateWebViewerWidth:"+p)},200)}}},htmlDecode:function(g){var h=g.toString();h=h.replace(/&amp;/g,"&");h=h.replace(/&lt;/g,"<");h=h.replace(/&gt;/g,">");h=h.replace(/&quot;/g,'"');h=h.replace(/&#39;/g,"'");return h},htmlEncode:function(h){var g=h.toString();g=g.replace(/&/g,"&amp;");g=g.replace(/>/g,"&gt;");g=g.replace(/</g,"&lt;");g=g.replace(/\"/g,"&quot;");g=g.replace(/\'/g,"&#39;");return g},moveDebugPopup:function(h){var g=document.getElementById("popupDebug");g.style.left=(h.clientX-200)+"px";g.style.top=(h.clientY-10)+"px"},};return f.namespace("DS/ConfiguratorWebView/Utilities",b)});