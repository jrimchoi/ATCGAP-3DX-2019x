define("DS/MPFTcContractComponent/NdaAcceptanceModal",["UWA/Core","UWA/Class/View","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTCContractModel/TCDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent"],function(f,a,e,c,g,h,d,b,j){var i;i=a.extend({className:"mpf-nda-acceptance-modal",setup:function(k){h.requiredOfPrototype(k.ndaContract,d,"options.ndaContract must be a TCContractModel");h.requiredOfPrototype(k.ndaDocument,b,"options.ndaDocument must be a TCDocumentModel");this.ndaContract=k.ndaContract;this.ndaDocument=k.ndaDocument;this.toggle=this._createAcceptToogle();this.acceptButton=this._createAcceptButton();this.cancelButton=this._createCancelButton();this.modal=this._createModal(this.toggle,this.acceptButton,this.cancelButton)},render:function(){this.container.setContent(this.modal);return this},show:function(){this.modal.show()},hide:function(){this.modal.hide();this.toggle.setCheck(false)},destroy:function(){this._parent();this.container=null},_createAcceptToogle:function(){var k=new g({className:"nda-acceptance-toggle",type:"checkbox",label:j.get("ndaToggleLabel")});k.addEvent("onClick",this._updateAcceptButtonState.bind(this));return k},_createAcceptButton:function(){var k=new c({className:"primary",value:j.get("accept"),disabled:true});k.addEvent("onClick",this._onClickAccept.bind(this));return k},_createCancelButton:function(){var k=new c({value:j.get("cancel")});k.addEvent("onClick",this.hide.bind(this));return k},_createModal:function(k,l,n){var m=new e({closable:false,header:f.createElement("h4",{text:j.get("ndaAcceptance")}),body:[f.createElement("div",{text:j.get("ndaExplanation")}),f.createElement("a",{text:j.get("ndaDownloadLink"),href:this.ndaDocument.getDocUrl(),target:"_blank"}),k],footer:[l,n]});return m},_updateAcceptButtonState:function(){if(this.toggle.isChecked()){this.acceptButton.enable()}else{this.acceptButton.disable()}},_onClickAccept:function(){var k=this;this.ndaContract.setCurrentState(d.STATUS.inEffect);this.ndaContract.setSigningDate(new Date().toUTCString());this.ndaContract.savePromise().then(function(){k.hide();k.dispatchEvent("ndaAccepted",k.ndaContract)})}});return i});define("DS/MPFTcContractComponent/TermsOfUseOrder",["UWA/Core","UWA/String","UWA/Promise","UWA/Class/View","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFModelFactory/TCContractFactory","DS/MPFPersonModel/PersonModel","DS/MPFTCContractModel/TCDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(g,j,h,b,f,i,a,e,d,k){var c=b.extend({className:"mpf-terms-order",setup:function(l){l||(l={});this._parent(l);i.requiredOfPrototype(l.buyer,e,"options.buyer must be a PersonModel");i.requiredOfPrototype(l.tcContractFactory,a,"options.tcContractFactory must be a TCContractFactory");i.requiredOfPrototype(l.tcDocument,d,"options.tcDocument must be a TCDocumentModel");i.requiredOfPrototype(l.privacyPolicyDocument,d,"options.privacyPolicyDocument must be a TCDocumentModel");this.checkbox=this._createCheckbox(l.callback);this.buyer=l.buyer;this.tcContractFactory=l.tcContractFactory;this.privacyPolicyDocument=l.privacyPolicyDocument;this.tcDocument=l.tcDocument;this.tcContract=l.tcContract;this.isTCUpdate=g.is(l.tcContract);this.isBuyersTCContractExist=l.isBuyersTCContractExist;this.privacyPolicyContract=l.privacyPolicyContract;this.isPrivacyPolicyUpdate=g.is(l.privacyPolicyContract);this.isPrivacyPolicyContractExist=l.isPrivacyPolicyContractExist},render:function(){var l=this._getLinks();this.container.setContent([this.checkbox,g.createElement("div",{"class":"labelTerms",html:j.format(k.get("buyerTermsOrderLabelUpdate"),l[0].outerHTML,l[1].outerHTML)})]);this.dispatchEvent("onRender");return this},_createCheckbox:function(l){return new f({type:"checkbox",label:"",className:"mpf-entry mpf-toggle primary",events:{onChange:l}})},_archiveOldTCContract:function(){this.tcContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");this.tcContract.set({currentState:"ARCHIVED"});return this.tcContract.savePromise(null,{patch:true})},_archivePrivacyPolicyContract:function(){this.privacyPolicyContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");this.privacyPolicyContract.set({currentState:"ARCHIVED"});return this.privacyPolicyContract.savePromise(null,{patch:true})},_getLinks:function(){var m;var l;m=g.createElement("a",{target:"_blank",href:this.tcDocument.get("docUrl"),html:k.get("termsOfUseLabel")});l=g.createElement("a",{target:"_blank",href:this.privacyPolicyDocument.get("docUrl"),html:k.get("privacyPolicyLabel")});return[m,l]},isChecked:function(){return this.checkbox.isChecked()},createContract:function(){var l;var m;if(this.isChecked()){if(this.isTCUpdate){l=this._archiveOldTCContract().then(this._saveNewTCContract.bind(this))}else{if(!this.isBuyersTCContractExist){l=this._saveNewTCContract()}else{l=h.resolve()}}if(this.isPrivacyPolicyUpdate){m=this._archivePrivacyPolicyContract().then(this._saveNewPrivacyPolicyContract.bind(this))}else{if(!this.isPrivacyPolicyContractExist){m=this._saveNewPrivacyPolicyContract()}else{m=h.resolve()}}return h.all([l,m])}},_saveNewTCContract:function(){this.tcContract=this.tcContractFactory.createModel("existing-document");this.tcContract.set({documentID:this.tcDocument.get("documentID"),consumerID:this._getConsumerID(),currentState:"IN_EFFECT"});return this.tcContract.savePromise(null,{patch:true})},_saveNewPrivacyPolicyContract:function(){this.privacyPolicyContract=this.tcContractFactory.createModel("existing-document");this.privacyPolicyContract.set({documentID:this.privacyPolicyDocument.get("documentID"),consumerID:this._getConsumerID(),currentState:"IN_EFFECT"});return this.privacyPolicyContract.savePromise(null,{patch:true})},_getConsumerID:function(){var l;if(this.buyer.get("buyerType")==="company"){l=this.buyer.get("company");return l.substring(l.lastIndexOf("/")+1,l.length)}else{return this.buyer.get("id")}}});return c});define("DS/MPFTcContractComponent/TermsOfUseOrderList",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModelFactory/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(f,e,a,d,b){var c=e.extend({className:"mpf-terms-order-list",setup:function(g){g||(g={});this._parent(g);a.requiredOfPrototype(g.tcDocumentFactory,d,"options.tcDocumentFactory must be a TCDocumentFactory");this.sellerView=g.sellerView===true;this.tcDocumentFactory=g.tcDocumentFactory;this.model=this.sellerView?this.tcDocumentFactory.createModel("ds-sellers"):this.tcDocumentFactory.createModel("ds-buyers")},render:function(){var g=this;this._getLink().then(function(h){g.container.setContent(h)});return this},_getLink:function(){var g;if(this.sellerView){g=b.get("dsTermsOfUseSellersOrderList")}else{g=b.get("dsTermsOfUseBuyersOrderList")}return this.model.fetchPromise().then(function(h){return f.createElement("a",{target:"_blank",href:h.get("docUrl"),html:g})})}});return c});define("DS/MPFTcContractComponent/SellerSalesConditionsOrder",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Badge","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFModelFactory/TCContractFactory","DS/MPFModelFactory/TCDocumentFactory","DS/MPFTCContractModel/TCDocumentModel","DS/MPFTCContractModel/TCContractModel","DS/MPFShopModel/ShopModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(i,k,c,a,f,j,b,d,e,h,l,m){var g=c.extend({className:"col-md-6 mpf-order-info-row",setup:function(n){n||(n={});this._checkPrototypes(n);this._parent(n);this.sellerView=n.sellerView===true;this.shop=n.shop;this.tcContractFactory=n.tcContractFactory;this.tcDocumentFactory=n.tcDocumentFactory;this.salesContract=n.salesContract;this.salesDocument=n.salesDocument},render:function(){this.downloadLink=this._createDownloadLink();if(this.sellerView){this._getSellerContent()}else{this._getBuyerContent()}return this},_getBuyerContent:function(){var o;var n;o=k.format(m.get("salesConditionsLabName"),this.shop.getName());if(i.is(this.salesContract)){n=m.get("specificConditions")}else{n=k.format(m.get("salesConditionsLab"),this.shop.getName())}this._setContent(o,n)},_getSellerContent:function(){var o;var n;o=m.get("yourSalesConditions");if(i.is(this.salesContract)){if(this.salesContract.getCurrentState()===h.STATUS.draft){n=new a({closable:true,content:m.get("alreadyUploaded"),events:{onClose:this._onCloseBadge.bind(this)}})}else{n=new a({closable:false,content:m.get("specificUploaded")})}}else{n=k.format(m.get("salesConditionsLab"),this.shop.getName())}this._setContent(o,n)},_setContent:function(p,o){var n;var q;n=i.createElement("div",{"class":"mpf-order-info-row-title",html:p});q=i.createElement("div",{"class":"mpf-order-info-row-body",html:o});this.container.setContent([n,this.downloadLink,q])},_createDownloadLink:function(){if(i.is(this.salesDocument)){return i.createElement("a",{target:"_blank",href:this.salesDocument.getDocUrl(),text:m.get("download")})}},_onCloseBadge:function(){if(this.salesContract.getCurrentState()===h.STATUS.draft){f.mask(this.container);this.salesContract.setCurrentState(h.STATUS.archived);this.salesContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");return this.salesContract.savePromise(null,{patch:true}).then(this._getLabSalesConditions.bind(this)).then(f.unmask.bind(f,this.container))}},_getLabSalesConditions:function(){delete this.salesContract;if(i.is(this.shop.getServices()["contract-documents"][0])){this.salesDocument=this.tcDocumentFactory.createModel("documents",{id:this.shop.getServices()["contract-documents"][0].id});return this.salesDocument.fetchPromise().then(this.render.bind(this))}else{delete this.salesDocument;delete this.downloadLink;this._setContent(m.get("yourSalesConditions"),m.get("noSpecificSalesConditions"))}},_checkPrototypes:function(n){j.requiredOfPrototype(n.shop,l,"options.shop must be a ShopModel");j.requiredOfPrototype(n.tcContractFactory,b,"options.tcContractFactory must be a TCContractFactory");j.requiredOfPrototype(n.tcDocumentFactory,d,"options.tcDocumentFactory must be a TCDocumentFactory");j.requiredOfPrototype(n.salesDocument,e,"options.salesDocument must be a TCDocumentModel");if(i.is(n.salesContract)){j.requiredOfPrototype(n.salesContract,h,"options.salesContract must be a TCContractModel")}}});return g});define("DS/MPFTcContractComponent/TcMarketplaceOperator",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/UIKIT/Input/File","DS/UIKIT/Alert","DS/UIKIT/Mask","DS/MPFModelFactory/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(g,a,h,f,e,d,b,i){var c=a.extend({className:"mpf-submit-operator",setup:function(j){j||(j={});this._parent(j);h.requiredOfPrototype(j.tcDocumentFactory,b,"options.tcDocumentFactory must be a TCDocumentFactory");this.tcDocumentFactory=j.tcDocumentFactory;this.type=j.type;this.model=this.type==="general"?this.tcDocumentFactory.createModel("general-public"):this.tcDocumentFactory.createModel(this.type);this.alert=new e({messsageClassName:"error",icon:true,closable:true,visible:true,maximumVisibleMessage:1})},render:function(){var j=this;var l;var k;l=g.createElement("div",{"class":"title",html:i.get(this.type+"TCMarketplace")});this.model.fetchPromise().then(function(m){k=g.is(m.getDocName())?j._createInput(m.getDocName()):j._createInput(i.get(j.type+"Placeholder"))})["catch"](function(){k=j._createInput(i.get(j.type+"Placeholder"))})["finally"](function(){j.container.setContent([j.alert,l,k])});return this},_createInput:function(k){var j;this.input=new f({input:true,buttonBefore:false,placeholder:k,buttonClassName:"btn-default mpf-upload",buttonText:i.get("uploadDocument"),events:{onChange:this._onFileChange.bind(this)}});j=g.createElement("div",{"class":"conditions",html:i.get(this.type+"MarketplaceUpload")});return[j,this.input]},_onFileChange:function(){var j=this;var k={};k.file=this.input.getContent().getElements("input")[1].files[0];if(k.file.size<=55000000){d.mask(this.container);this.model=this.tcDocumentFactory.createModel(this.type);this.model.saveDocument(k).then(function(l){l.set({currentState:"PUBLISHED"});l.id=l.getDocID();l.dataProxy=j.tcDocumentFactory.getDataProxy("documents");return l.savePromise(null,{patch:true})}).then(this._displayFonticon.bind(this,"check"))["catch"](this._displayFonticon.bind(this,"error"))["finally"](d.unmask.bind(d,this.container))}else{j._displayAlert();j._displayFonticon("error")}},_displayFonticon:function(l){var k;var j;var m;k=this.getContent().getElement(".conditions");m=this.getContent().getElement(".fonticon");if(m){m.outerHTML=""}if(l==="check"){j=g.createElement("span",{"class":"fonticon fonticon-check action-check"})}if(l==="error"){j=g.createElement("span",{"class":"fonticon fonticon-cancel action-error"})}j.inject(k,"after")},_displayAlert:function(){this.alert.add({className:"error",message:i.get("maximumSize")})}});return c});define("DS/MPFTcContractComponent/TermsOfUseSubmitLabPage",["UWA/Core","UWA/String","UWA/Class/View","UWA/Promise","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/UIKIT/Input/File","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(h,k,a,j,c,m,i,f,e,g,d,n){function b(q){var o;var p;return c.fetchPromise().then(function(r){p=m.getInstance(r);return p.getFactory(m.Types.TC_DOCUMENT)}).then(function(r){if(h.is(q)){o=r.createModel("seller-buyer",{shopServicesID:q});return o.fetchPromise()}else{return j.resolve(r.createModel("seller-buyer"))}}).then(function(){return new l({shopServiceDocumentModel:o})})}var l=a.extend({className:"mpf-submit-lab",setup:function(o){o||(o={});g.requiredOfPrototype(o.shopServiceDocumentModel,d,"options.shopServiceDocumentModel must be a TCDocumentModel");this.serviceTerm=o.serviceTerm||n.get("lab");this._parent(o);this.shopServiceDocumentModel=o.shopServiceDocumentModel;this.input=this._createInput()},render:function(){var r;var p;var o;var q;o=h.createElement("span",{"class":"fonticon fonticon-help"});q=new f({body:n.get("specificFormats"),position:"right",target:o,trigger:"hover focus"});r=h.createElement("div",{"class":"title",html:[n.get("uploadTerms"),o]});p=h.createElement("div",{"class":"salesConditions",text:k.format(n.get("salesConditionsProviders"),this.serviceTerm)});this.container.setContent([r,p,this.input,q]);return this},_onFileChange:function(){var o={};o.file=this.input.getContent().getElements("input")[1].files[0];e.mask(this.container);this.shopServiceDocumentModel.saveDocument(o).then(this._displayFonticon.bind(this,"check"))["catch"](this._displayFonticon.bind(this,"error"))["finally"](e.unmask.bind(e,this.container))},_createInput:function(){return new i({input:true,buttonBefore:false,placeholder:h.is(this.shopServiceDocumentModel.getDocName())?this.shopServiceDocumentModel.getDocName():n.get("salesConditionsUpload"),buttonClassName:"btn-default mpf-upload",buttonText:n.get("uploadDocument"),events:{onChange:this._onFileChange.bind(this)}})},_displayFonticon:function(q){var p;var o;var r;p=this.getContent().getElement(".salesConditions");r=this.getContent().getElement(".salesConditions + .fonticon");if(r){r.outerHTML=""}if(q==="check"){o=h.createElement("span",{"class":"fonticon fonticon-check action-check"})}if(q==="error"){o=h.createElement("span",{"class":"fonticon fonticon-cancel action-error"})}o.inject(p,"after")}});l.fromShopServiceId=b;return l});define("DS/MPFTcContractComponent/SalesConditionsBuyerPayment",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFShopModel/ShopModel","DS/MPFTCContractModel/TCContractModel","DS/MPFModelFactory/TCDocumentFactory","DS/MPFModelFactory/TCContractFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(f,c,h,g,i,e,d,b,j){var a=c.extend({className:"mpf-tc-contract-payment",setup:function(k){k||(k={});this._checkPrototypes(k);this._parent(k);this.shopModel=k.shopModel;this.tcDocumentFactory=k.tcDocumentFactory;this.tcContractFactory=k.tcContractFactory;this.tcContract=k.tcContract;this.tcDocument=this.tcDocumentFactory.createModel("documents",{id:this.tcContract.getDocumentID()});this.checkbox=this._createCheckbox()},render:function(){var k=this;this._getLink().then(function(l){k.container.setContent([k.checkbox,f.createElement("div",{"class":"labelTerms",html:[j.get("agree")+"&nbsp;",l,"&nbsp;"+j.get("provided")+"&nbsp;",k.shopModel.getName()]})])});return this},_createCheckbox:function(){var k=this;return new h({type:"checkbox",label:"",className:"mpf-entry mpf-toggle primary",events:{onChange:function(){if(this.isChecked()){k.dispatchEvent("checked")}else{k.dispatchEvent("unchecked")}}}})},_getLink:function(){return this.tcDocument.fetchPromise().then(function(k){return f.createElement("a",{href:k.getDocUrl(),target:"_blank",html:j.get("salesConditions")})})},isChecked:function(){return this.checkbox.isChecked()},signContract:function(){if(this.isChecked()){this.tcContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");this.tcContract.setCurrentState(e.STATUS.inEffect);return this.tcContract.savePromise(null,{patch:true})}},_checkPrototypes:function(k){g.requiredOfPrototype(k.shopModel,i,"options.shopModel must be a ShopModel");g.requiredOfPrototype(k.tcDocumentFactory,d,"options.tcDocumentFactory must be a TCDocumentFactory");g.requiredOfPrototype(k.tcContractFactory,b,"options.tcContractFactory must be a TCContractFactory");g.requiredOfPrototype(k.tcContract,e,"options.tcContract must be a TCContractModel")}});return a});define("DS/MPFTcContractComponent/TermsOfUseSeller",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFModelFactory/TCContractFactory","DS/MPFPersonModel/PersonModel","DS/MPFTCContractModel/TCDocumentModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(h,j,c,d,l,k,i,b,f,e,g,m){var a=c.extend({setup:function(n){n||(n={});this._parent(n);i.requiredOfPrototype(n.tcContractFactory,b,"options.tcContractFactory must be a TCContractFactory");i.requiredOfPrototype(n.seller,f,"options.seller must be a PersonModel");i.requiredOfPrototype(n.tcDocument,e,"options.tcDocument must be a TCDocumentModel");i.requiredOfPrototype(n.privacyPolicyDocument,e,"options.privacyPolicyDocument must be a TCDocumentModel");this.tcContractFactory=n.tcContractFactory;this.seller=n.seller;this.tcDocument=n.tcDocument;this.privacyPolicyDocument=n.privacyPolicyDocument;this.tcContract=n.tcContract;this.isTCUpdate=h.is(n.tcContract);this.isSellersTCContractExist=n.isSellersTCContractExist;this.privacyPolicyContract=n.privacyPolicyContract;this.isPrivacyPolicyUpdate=h.is(n.privacyPolicyContract);this.isPrivacyPolicyContractExist=n.isPrivacyPolicyContractExist;this.button=new l({className:"primary",value:m.get("ok"),disabled:true,events:{onClick:this._clickOk.bind(this)}});this.checkbox=this._createCheckbox()},render:function(n){this.modal=this._createModal();this.modal.inject(n);return this},show:function(){this.modal.show()},isChecked:function(){return this.checkbox.isChecked()},_createModal:function(){var o=this;var n;var p=[];if(this.isTCUpdate||this.isPrivacyPolicyUpdate){p.push(j.format(m.get("sellerTermsOfUseUpdateLabel"),this._getTCLink().outerHTML,this._getPrivacyPolicyLink().outerHTML))}else{p.push(j.format(m.get("sellerTermsOfUseLabel"),this._getTCLink().outerHTML,this._getPrivacyPolicyLink().outerHTML))}n=new d({visible:true,closable:false,className:"mpf-tc-contract-modal",header:h.createElement("h4",{text:m.get("termsOfUseAcceptance")}),body:[o.checkbox,h.createElement("div",{"class":"labelTerms",html:p})],footer:o.button});return n},_clickOk:function(){var n=this;if(this.isTCUpdate){this._archiveOldTCContract().then(function(){n._saveNewTCContract()})}else{if(!this.isSellersTCContractExist){this._saveNewTCContract()}}if(this.isPrivacyPolicyUpdate){this._archivePrivacyPolicyContract().then(function(){n._saveNewPrivacyPolicyContract()})}else{if(!this.isPrivacyPolicyContractExist){this._saveNewPrivacyPolicyContract()}}this.modal.hide()},_createCheckbox:function(){var n=this;return new k({type:"checkbox",label:"",className:"mpf-entry mpf-toggle primary",events:{onChange:function(){if(this.isChecked()){n.button.enable()}else{n.button.disable()}}}})},_getTCLink:function(){return h.createElement("a",{target:"_blank",href:this.tcDocument.getDocUrl(),html:m.get("termsOfUseLabel")})},_getPrivacyPolicyLink:function(){return h.createElement("a",{target:"_blank",href:this.privacyPolicyDocument.getDocUrl(),html:m.get("privacyPolicyLabel")})},_getConsumerID:function(){var n;if(this.seller.get("buyerType")==="company"){n=this.seller.get("company");return n.substring(n.lastIndexOf("/")+1,n.length)}else{return this.seller.get("id")}},_archiveOldTCContract:function(){this.tcContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");this.tcContract.setCurrentState(g.STATUS.archived);return this.tcContract.savePromise(null,{patch:true})},_archivePrivacyPolicyContract:function(){this.privacyPolicyContract.dataProxy=this.tcContractFactory.getDataProxy("contracts");this.privacyPolicyContract.setCurrentState(g.STATUS.archived);return this.privacyPolicyContract.savePromise(null,{patch:true})},_saveNewTCContract:function(){this.tcContract=this.tcContractFactory.createModel("existing-document");this.tcContract.set({documentID:this.tcDocument.getDocID(),consumerID:this._getConsumerID(),currentState:g.STATUS.inEffect});return this.tcContract.savePromise(null,{patch:true})},_saveNewPrivacyPolicyContract:function(){this.privacyPolicyContract=this.tcContractFactory.createModel("existing-document");this.privacyPolicyContract.set({documentID:this.privacyPolicyDocument.getDocID(),consumerID:this._getConsumerID(),currentState:g.STATUS.inEffect});return this.privacyPolicyContract.savePromise(null,{patch:true})}});return a});define("DS/MPFTcContractComponent/SellerSalesConditionsShowroom",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModelFactory/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],function(f,e,a,c,b){var d=e.extend({className:"mpf-seller-sales-conditions-showroom",setup:function(g){g||(g={});a.requiredOfPrototype(g.tcDocumentFactory,c,"options.tcDocumentFactory must be a TCDocumentFactory");this._parent(g);this.tcDocumentFactory=g.tcDocumentFactory;this.tcDocument=this.tcDocumentFactory.createModel("documents",this.model.get("shopServices")["contract-documents"][0])},render:function(){var g=this;this._getLink().then(function(h){g.container.setContent(f.createElement("h3",{html:[g.model.get("shopName")+"&nbsp;",h]}))});return this},_getLink:function(){return this.tcDocument.fetchPromise().then(function(g){return f.createElement("a",{href:g.get("docUrl"),target:"_blank",html:b.get("salesConditions")})})}});return d});define("DS/MPFTcContractComponent/TermsOfUseSellerFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFDataProxy/Connector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTcContractComponent/TermsOfUseSeller"],function(e,b,f,c,h,g,d,a){var i=b.extend({init:function(j){j||(j={});g.requiredOfPrototype(j.connector,c,"options.connector must be a Connector");this.connector=j.connector;this.factories=h.getInstance(this.connector)},displayTermsOfUse:function(){return this._initFactoriesAndFetchConsumedContracts().then(this._getPrivacyPolicySignedContract.bind(this)).then(this._getSellersTCSignedContract.bind(this)).then(this._getAttributes.bind(this)).then(this._getDocumentsAndBuildTermsOfUseModal.bind(this))},_initFactoriesAndFetchConsumedContracts:function(){var j=this;return f.all([this.factories.getFactory(h.Types.TC_CONTRACT),this.factories.getFactory(h.Types.TC_DOCUMENT),this.factories.getFactory(h.Types.PERSON)]).then(function(k){j.tcContractFactory=k[0];j.tcDocumentFactory=k[1];j.personFactory=k[2]}).then(function(){j.tcDocument=j.tcDocumentFactory.createModel("ds-sellers");j.privacyPolicyDocument=j.tcDocumentFactory.createModel("privacy-policy");j.consumedContracts=j.tcContractFactory.createCollection("consumed-contracts");j.seller=j.personFactory.createModel("me");return f.all([j.consumedContracts.fetchPromise(),j.seller.fetchPromise()])})},_getAttributes:function(){var j={};j.tcContractFactory=this.tcContractFactory;j.seller=this.seller;j.isPrivacyPolicyContractExist=this.isPrivacyPolicyContractExist;j.isSellersTCContractExist=this.isSellersTCContractExist;j.tcDocument=this.tcDocument;j.privacyPolicyDocument=this.privacyPolicyDocument;if(this.isPrivacyPolicyContractExist&&parseInt(this.privacyPolicyContract.getSigningRevision())<parseInt(this.privacyPolicyContract.getActiveRevision())){j.privacyPolicyContract=this.privacyPolicyContract}if(this.isSellersTCContractExist&&parseInt(this.sellersTCContract.getSigningRevision())<parseInt(this.sellersTCContract.getActiveRevision())){j.tcContract=this.sellersTCContract}return j},_getPrivacyPolicySignedContract:function(){this.privacyPolicyContract=this._getSignedContract("MP_DataPrivacyTCDocument");this.isPrivacyPolicyContractExist=e.is(this.privacyPolicyContract)},_getSellersTCSignedContract:function(){this.sellersTCContract=this._getSignedContract("MP3DP_DSSellersTCDocument");this.isSellersTCContractExist=e.is(this.sellersTCContract)},_getSignedContract:function(k){var j;j=this.consumedContracts.find(function(l){return l.getDocumentType()===k&&l.getCurrentState()===d.STATUS.inEffect});return j},_getDocuments:function(){return f.all([this.tcDocument.fetchPromise(),this.privacyPolicyDocument.fetchPromise()])},_getDocumentsAndBuildTermsOfUseModal:function(j){var m=this;var k;var l;var n;k=this.isPrivacyPolicyContractExist&&this.isSellersTCContractExist;l=e.is(j.privacyPolicyContract)||e.is(j.tcContract);if(!k||l){return this._getDocuments().then(function(){n=e.is(m.tcDocument.getDocID())&&e.is(m.privacyPolicyDocument.getDocID());if(n){return new a(j).render(document.body)}})}}});return i});define("DS/MPFTcContractComponent/TermsOfUseOrderFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFDataProxy/Connector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTcContractComponent/TermsOfUseOrder"],function(f,a,g,c,i,h,d,b){var e=a.extend({init:function(j){j||(j={});h.requiredOfPrototype(j.connector,c,"options.connector must be a Connector");this.connector=j.connector;this.container=j.container;this.callback=j.callback;this.factories=i.getInstance(this.connector)},displayTermsOfUse:function(){return this._initFactoriesAndFetchDocuments().then(this._getPrivacyPolicySignedContract.bind(this)).then(this._getBuyersTCSignedContract.bind(this)).then(this._getAttributes.bind(this)).then(this._buildTermsOfUse.bind(this))},_initFactoriesAndFetchDocuments:function(){var j=this;return g.all([this.factories.getFactory(i.Types.TC_CONTRACT),this.factories.getFactory(i.Types.TC_DOCUMENT),this.factories.getFactory(i.Types.PERSON)]).then(function(k){j.tcContractFactory=k[0];j.tcDocumentFactory=k[1];j.personFactory=k[2];j.buyer=j.personFactory.createModel("me");j.tcDocument=j.tcDocumentFactory.createModel("ds-buyers");j.privacyPolicyDocument=j.tcDocumentFactory.createModel("privacy-policy");j.consumedContracts=j.tcContractFactory.createCollection("consumed-contracts");return g.all([j.buyer.fetchPromise(),j.consumedContracts.fetchPromise()])})},_getAttributes:function(){var j={};j.callback=this.callback;j.tcDocumentFactory=this.tcDocumentFactory;j.tcContractFactory=this.tcContractFactory;j.buyer=this.buyer;j.tcDocument=this.tcDocument;j.privacyPolicyDocument=this.privacyPolicyDocument;j.isBuyersTCContractExist=this.isBuyersTCContractExist;j.isPrivacyPolicyContractExist=this.isPrivacyPolicyContractExist;if(this.isPrivacyPolicyContractExist&&parseInt(this.privacyPolicyContract.getSigningRevision())<parseInt(this.privacyPolicyContract.getActiveRevision())){j.privacyPolicyContract=this.privacyPolicyContract}if(this.isBuyersTCContractExist&&parseInt(this.buyersTCContract.getSigningRevision())<parseInt(this.buyersTCContract.getActiveRevision())){j.tcContract=this.buyersTCContract}return j},_getPrivacyPolicySignedContract:function(){this.privacyPolicyContract=this._getSignedContract("MP_DataPrivacyTCDocument");this.isPrivacyPolicyContractExist=f.is(this.privacyPolicyContract)},_getBuyersTCSignedContract:function(){this.buyersTCContract=this._getSignedContract("MP3DP_DSBuyersTCDocument");this.isBuyersTCContractExist=f.is(this.buyersTCContract)},_getSignedContract:function(k){var j;j=this.consumedContracts.find(function(l){return l.getDocumentType()===k&&l.getCurrentState()===d.STATUS.inEffect});return j},_getDocuments:function(){return g.all([this.tcDocument.fetchPromise(),this.privacyPolicyDocument.fetchPromise()])},isChecked:function(){if(f.is(this.termsOfUseOrder)){return this.termsOfUseOrder.isChecked()}else{return true}},createContract:function(){if(f.is(this.termsOfUseOrder)){return this.termsOfUseOrder.createContract()}},_buildTermsOfUse:function(j){var m=this;var k;var l;var n;k=this.isPrivacyPolicyContractExist&&this.isBuyersTCContractExist;l=f.is(j.privacyPolicyContract)||f.is(j.tcContract);if(!k||l){return this._getDocuments().then(function(){n=f.is(m.tcDocument.getDocID())&&f.is(m.privacyPolicyDocument.getDocID());if(n){m.termsOfUseOrder=new b(j);if(f.is(m.container)){m.container.setContent(m.termsOfUseOrder.render())}return m.termsOfUseOrder}})}}});return e});