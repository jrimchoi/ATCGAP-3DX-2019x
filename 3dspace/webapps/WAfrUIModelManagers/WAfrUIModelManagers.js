define("DS/WAfrUIModelManagers/MainUIComponentManager",["css!DS/WAfrUI/wafr.css","UWA/Core","UWA/Class","DS/Windows/Panel","DS/Controls/Toolbar","DS/Menu/ContextualMenu","DS/Controls/Button","DS/WAfrModelEvents/mod_ModelEvents","UWA/Promise","DS/WAfrControls/WAfrFlyout","DS/Utilities/TouchUtils","DS/WAfrDebug/mod_Performances","i18n!DS/WAfrUIModelManagers/assets/nls/ActionBarContextMenu"],function(j,g,z,q,D,u,t,f,d,h,b,i,r){var o=i.Performances,B="[DS/WAfrUIModelManagers/MainUIComponentManager]",c=new o();var v=f.DEFAULT_COMPONENT_NAME;if(!v||v.length===0){throw new Error("mod_ModelEvents.DEFAULT_COMPONENT_NAME has to be defined")}var E="EVT_ViewGenerated";var A=70;var n=100;var p=112;function w(G){var I=G.groupsTab;var K=G.groupName;var H=false;var F=0;if(I!==undefined){var J;while(H===false&&F<I.length){J=I[F];if(J.groupName===K){H=true}F++}}return H}function e(G){var I=G.groupsTab;var K=G.groupName;var H;var F=0;if(I!==undefined){var J;while(H===undefined&&F<I.length){J=I[F];if(J.groupName===K){H=J.content}F++}}return H}function s(){var U=this;if(!U){throw new Error("panel must be defined")}var G=c.start([B,"[Sync] computeCompactWidth",U.identifier].join(" "));if(!U._afr._isContentInitialized){c.stop(G);return}var F=U.content.parentNode.getBoundingClientRect().height;if(F<0){c.stop(G);throw new Error("panelHeight must not be a negative number")}if(F===0){c.stop(G);return}var aa=U.content.getElementsByClassName("wafr-toolbar-section-group");var Q=0;if(aa.length>0){var X=window.getComputedStyle(aa[0],null);F-=parseInt(X.paddingTop,10);F-=parseInt(X.paddingBottom,10);Q=parseInt(X.paddingLeft,10)+parseInt(X.paddingRight,10)}var O=null,Y=null,I=0;var J=0,K=0;var S=0,P=aa.length,H=null,V=null;for(S;S<P;++S){H=aa[S];V=H.getElementsByClassName("wafr-tweakers");if(!V){c.stop(G);throw new Error("Empty group")}if(O===null){var L=window.getComputedStyle(V[0].parentNode,null);var T=parseInt(L.paddingTop,10)+parseInt(L.paddingBottom,10);I=parseInt(L.paddingLeft,10)+parseInt(L.paddingRight,10);O=V[0].getBoundingClientRect().height+T}var N=Math.floor(F/O);if(N===0){N=1}var ab=Math.ceil(V.length/N);var ac=0,M=1,W=0,R=0;for(ac;ac<ab;++ac){var Z=V[W].getBoundingClientRect().width+I;while(M<=N&&W<V.length){Y=V[W].getBoundingClientRect().width+I;if(Y>Z){Z=Y}++W;++M}M=1;R+=Z}J=R+(S>0?1:0);H.style.width=Math.ceil(J)+"px";K+=J+Q}U.content.style.width=K+"px";c.stop(G)}function a(H){var G=c.start([B,"[Sync] computeAndResizeForAllPanels"].join(" "));var I=0,F=H.length,J=null;for(I;I<F;++I){J=H[I];if(J._afr._isContentInitialized===false){continue}if(J.content.hasClassName("column")){if(J.height!==-1){J.height=-1}if(J.windowGroup&&J.windowGroup.height!==-1){J.windowGroup.height=-1}}else{if(J.width!==-1){J.width=-1}if(J.windowGroup&&J.windowGroup.width!==-1){J.windowGroup.width=-1}}if(J.currentDockArea===WUXDockAreaEnum.TopDockArea||J.currentDockArea===WUXDockAreaEnum.BottomDockArea){J._afr._bounded_computeCompactWidth()}}c.stop(G)}function C(G){G.content.style.height="";G.content.style.width="auto";var F=G.content.getElementsByClassName("wafr-toolbar-section-group");var J=0;var I=F.length;var H=null;for(J;J<I;++J){H=F[J];H.style.width="auto"}}function m(){var G=c.start([B,"[Sync] onPrePlaceChangeCB"].join(" "));var F=this.panel;if(!F){c.stop(G);throw new Error("panel must be defined")}if(F.currentDockArea===WUXDockAreaEnum.TopDockArea||F.currentDockArea===WUXDockAreaEnum.BottomDockArea){F.content.removeClassName("column");F.resizableFlag="vertical";if(F.minHeight>0){F.height=F.minHeight}F.removeEventListener("resize",F._afr._bounded_computeCompactWidth);F.addEventListener("resize",F._afr._bounded_computeCompactWidth);F.removeEventListener("activate",F._afr._bounded_computeCompactWidth);F.addEventListener("activate",F._afr._bounded_computeCompactWidth)}else{F.removeEventListener("resize",F._afr._bounded_computeCompactWidth);F.removeEventListener("activate",F._afr._bounded_computeCompactWidth);C(F);F.content.addClassName("column");F.resizableFlag="horizontal"}a(this.mainUIComponentManager._panels);c.stop(G)}function k(){var G=c.start([B,"[Sync] onResizeFix"].join(" "));var F=this;if(F.minHeight>0){F.minHeight=0}if(F.content.hasClassName("column")){if(F.height!==-1){F.height=-1}if(F.windowGroup&&F.windowGroup.height!==-1){F.windowGroup.height=-1}}else{if(F.width!==-1){F.width=-1}if(F.windowGroup&&F.windowGroup.width!==-1){F.windowGroup.width=-1}}c.stop(G)}function y(F){return !isNaN(parseFloat(F))&&isFinite(F)}function x(){var F=this.panel;if(!F){throw new Error("panel must be defined")}var G=F.windowGroup;if(!G){if(y(F.ctxUid)){u.removeEventListener(F.getContent(),F.ctxUid);F.ctxUid=null}if(!y(F.ctxWUid)){F.ctxUid=u.addEventListener(F.getContent(),{callback:this.mainUIComponentManager.onContextEventCB.bind(this.mainUIComponentManager,{panel:F})})}}else{var H=G.getEmbeddedWindows()[0];if(H){if(y(F.ctxWUid)){u.removeEventListener(G.getContent(),F.ctxWUid);F.ctxWUid=null}else{if(!y(F.ctxUid)&&!y(H.ctxWUid)){F.ctxWUid=u.addEventListener(G.getContent(),{callback:this.mainUIComponentManager.onContextEventCB.bind(this.mainUIComponentManager,{panel:F})})}}if(y(F.ctxTabUid)&&F.currentDockArea!==WUXDockAreaEnum.NoneDockArea){F.ctxTabUid=null}else{if(!y(F.ctxTabUid)&&!y(H.ctxTabUid)){F.ctxTabUid=u.addEventListener(G.elements._titleBarDiv,{callback:this.mainUIComponentManager.onContextEventCB.bind(this.mainUIComponentManager,{panel:F})})}}if(y(F.ctxUid)&&F.currentDockArea!==WUXDockAreaEnum.NoneDockArea){u.removeEventListener(F.getContent(),F.ctxUid);F.ctxUid=null}}else{console.error("this panel should not be undefined")}}}var l=z.extend({defaultOptions:{availability:true,visibleFlag:true},init:function(F){this.options=g.extend(g.clone(this.defaultOptions),F);this._parent();this._panels=[];this._tweakersView=[];this._touchMode=b.getTouchMode();this._defaultTabOrder=[];this._isViewGenerated=false;this._showLabelFlag=false;this._originalTouchValue=this._touchMode;this._handleTouchChange()},generate:function(H){var W=c.start([B,"[Sync] generate"].join(" "));var ah=this;if(ah===undefined||ah._uiComponent===undefined||ah._uiComponent._properties===undefined||ah._uiComponent._properties.flatModel===undefined){c.stop(W);return}var O=ah._uiComponent._properties;ah._touchMode=H.touchMode;var I=O.flatModel.getChildren();if(I===undefined||I.length===undefined||I.length===0){c.stop(W);return}var Y=document.body;if(ah._uiFrame){Y=ah._uiFrame.getImmersiveFrame()}var aj=[];var af=[];var ag;var R;var F=[];var ac;var U=[];var X={};var G;var V=c.start([B,"[Sync] generate(children.forEach)"].join(" "));I.forEach(function(at){var au=at.options.grid.handler;if(au!==undefined&&at.options.grid.category!==undefined){var al=at.options.grid.type;var ak=at.options.grid.typeView;var ao=new g.Element("div",{});ao.style.display="inline-block";ao.style.boxSizing="border-box";var ar=at.options.grid.category!==undefined?at.options.grid.category:"Unknown";var aq=at.options.grid.group!==undefined?at.options.grid.group:"Unknown";var am=at.options.grid.set!==undefined?at.options.grid.set:"Unknown";if(!w({groupName:ar,groupsTab:aj})){ag=new g.Element("div",{});ag.addClassName("wafr-toolbar-section");aj.push({groupName:ar,content:ag});af[ar]=[];F[ar]=[]}else{ag=e({groupName:ar,groupsTab:aj})}if(!w({groupName:aq,groupsTab:af[ar]})){R=new g.Element("div",{"class":"wafr-toolbar-section-group"});af[ar].push({groupName:aq,content:R})}else{R=e({groupName:aq,groupsTab:af[ar]})}if(am!=="Unknown"){if(!w({groupName:am,groupsTab:F[ar]})){G=new g.Element("div");G.addClassName("wafr-tweakers-radio");G.addClassName("wux-tweakers");G.addClassName("wafr-tweakers");if(H.touchMode){G.setAttribute("touch-mode",H.touchMode)}ac=new h({selfManagedPresenter:false,touchMode:ah._touchMode});ac.viewGenCounter=0;ac.elemList=[];ac.inject(G);ac.elements.container=G;F[ar].push({groupName:am,content:G});ao.addContent(G);R.addContent(ao)}else{G=e({groupName:am,groupsTab:F[ar]})}ac.elemList.push({model:au});au.container=ac;au.type=ak}else{R.addContent(ao)}X[au.getId()]=c.start([B,"[Async] generateTweaker",au.getId()].join(" "));U.push(O._typeRepFactory.generateView(au,{typePath:al,touchMode:H.touchMode}).then(function ap(av){if(av!==undefined){ao.addContent(av);ah._tweakersView.push(av);c.stop(X[au.getId()])}else{console.error("Problem generating the view of",au);c.stop(X[au.getId()]);return d.resolve()}},function an(av){console.error("Problem generating the view of",au);c.stop(X[au.getId()]);return d.resolve()}))}});c.stop(V);d.all(U).then(function T(){var al=c.start([B,"[Sync] generateViewsSucceeded"].join(" "));ah._isViewGenerated=true;var an=0,ak=ah._panels.length;for(an;an<ak;++an){ah._panels[an]._afr._isContentInitialized=true}var ao=ah._uiComponent.getExecutionContext();if(!ao){c.stop(al);throw new Error("executionContext not found")}var am=ao.getComponent(v);if(!am){c.stop(al);throw new Error("modelEventsCpt not found")}am.publish({event:E});c.stop(al)},function M(){c.stop(perfmark_GenerateViewsSucceeded);throw new Error("generateViewPromises contains at least one promise which was rejected.")});var N=ah._uiComponent.getCategories();var Q=c.start([B,"[Sync] contentsCategory(contentsCategory.forEach)"].join(" "));aj.forEach(function(am){af[am.groupName].forEach(function(ap){ap.content.inject(am.content)});var al="WAfrUIModelMainComponent"+am.groupName;var ao=am.groupName;if(N&&N[am.groupName]&&N[am.groupName].internationalization&&N[am.groupName].internationalization.title){ao=N[am.groupName].internationalization.title}var an=c.start([B,"[Sync] contentsCategory(new panel)",al].join(" "));var ak=new q({title:ao,identifier:al,content:am.content,immersiveFrame:Y,resizableFlag:true,movableFlag:false,currentDockArea:WUXDockAreaEnum.BottomDockArea,closeButtonFlag:false,usePaddingFlag:false,pinnedFlag:(am.groupName==="Fixed Area"||am.groupName==="WAfrStandard")?true:false,minHeight:(!H.touchMode)?47:75,minWidth:(!H.touchMode)?47:75});c.stop(an);ak._afr={};ak._afr._isContentInitialized=!!ah._isViewGenerated;ah._panels.push(ak);if(ak.currentDockArea===WUXDockAreaEnum.NoneDockArea||ak.currentDockArea===WUXDockAreaEnum.LeftDockArea||ak.currentDockArea===WUXDockAreaEnum.RightDockArea){ak.content.addClassName("column");ak.resizableFlag="horizontal"}else{ak.resizableFlag="vertical"}if(!ak._afr){ak._afr=Object.create(null)}ak._afr._bounded_computeCompactWidth=s.bind(ak);ak._afr._bounded_onPrePlaceChangeCB=m.bind({panel:ak,mainUIComponentManager:ah});ak._afr._bounded_onPlaceChangeCB=x.bind({panel:ak,mainUIComponentManager:ah});ak.addEventListener("placeChange",ak._afr._bounded_onPlaceChangeCB);ak.addEventListener("prePlaceChange",ak._afr._bounded_onPrePlaceChangeCB);ak._afr._bounded_onPrePlaceChangeCB();ak._afr._bounded_onResizeFix=k.bind(ak)});c.stop(Q);ah._reorderCategories({tabPanels:ah._panels,orderPreferences:ah._defaultTabOrder});var K=c.start([B,"[Sync] generate(windowgroup)"].join(" "));var J;var S=false;var ab=0;for(ab=0;ab<ah._panels.length;ab++){if(ah._panels[ab].currentDockArea===WUXDockAreaEnum.BottomDockArea){if(J===undefined){J=ah._panels[ab];S=true}else{if(ah._panels[ab].currentDockArea===WUXDockAreaEnum.BottomDockArea){ah._panels[ab].attachToWindow(J,WUXSnapAreaEnum.InsideArea);S=true}}}}c.stop(K);var ae=c.start([B,"[Sync] generate(first panel activation)"].join(" "));if(J){var ad=J.windowGroup;var Z;if(ad){Z=ad.getEmbeddedWindows();if(Z&&Z.length&&Z.length>1){var ai=[Z[0]];if(J.identifier==="WAfrUIModelMainComponentWAfrStandard"||J.identifier==="WAfrUIModelMainComponentFixed Area"&&Z.length>2){ai.push(Z[1])}ad.currentWindows=ai}}}c.stop(ae);if(Y!==undefined&&S){var aa=Y.getDockingElement(WUXDockAreaEnum.BottomDockArea);if(aa!==undefined){aa.minSize=(ah._originalTouchValue===true)?p:A;aa.dockingZoneSize=aa.minSize}}if(ah._isViewGenerated){a(ah._panels)}else{var P=ah._uiComponent.getExecutionContext();if(!P){c.stop(W);throw new Error("executionContext not found")}var L=P.getComponent(v);if(!L){c.stop(W);throw new Error("modelEventsCpt not found")}L.subscribeOnce({event:E},function(){a(ah._panels)})}c.stop(W)},setContext:function(F){if(F.executionContext!==undefined){this._executionContext=F.executionContext}if(F.UIComponent!==undefined){this._uiComponent=F.UIComponent}if(F.UIFrame!==undefined){this._uiFrame=F.UIFrame}},onContextEventCB:function(F){var G=this;var H=[];H.push({type:"PushItem",title:r.get((G._showLabelFlag===true)?"iconLabelHide.title":"iconLabel.title"),icon:"",action:{callback:function(I){G.toggleButtonLabel()}},});return H},resetPositionMainComponent:function(){var H=this;var J,G,I,F;H._panels.forEach(function(K){K.deleteWindowPreferences();if(J===undefined){J=K;I=J.windowGroup;K.currentDockArea=WUXDockAreaEnum.BottomDockArea}else{K.windowGroup=null;K.attachToWindow(G,WUXSnapAreaEnum.InsideArea,"after")}G=K});F=[H._panels[0]];if(J.identifier==="WAfrUIModelMainComponentWAfrStandard"||J.identifier==="WAfrUIModelMainComponentFixed Area"&&H._panels.length>2){F.push(H._panels[1])}I.currentWindows=F},toggleButtonLabel:function(G){var H=this;H._showLabelFlag=(H._showLabelFlag!==true);H._tweakersView.forEach(function(I){if(I!==undefined){I.showLabelFlag=H._showLabelFlag}});if(!H._panels[0].immersiveFrame){throw new Error("no immersive frame related to this panel",H._panels[0])}var F=H._panels[0].immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea);if(!F){throw new Error("no bottom dock area in this immersive frame",H._panels[0].immersiveFrame)}if(H._originalTouchValue){F.minSize=p;F.dockingZoneSize=F.minSize}else{F.minSize=(H._showLabelFlag===true)?n:A;F.dockingZoneSize=F.minSize}H._panels.forEach(function(I){I.fire("dimensionsChanged");if(I.currentDockArea===WUXDockAreaEnum.TopDockArea||I.currentDockArea===WUXDockAreaEnum.BottomDockArea){I._afr._bounded_computeCompactWidth()}})},clean:function(){var H=this;var K;var F=H._uiFrame;if(F){K=F.getImmersiveFrame()}H._tweakersView=[];if(K&&H._panels){var J,G;while(H._panels.length!==0||H._panels[0]!==undefined){G=H._panels[0];H._panels.splice(0,1);G.removeEventListener("resize",G._afr._bounded_computeCompactWidth);G.removeEventListener("resize",G._afr._bounded_onResizeFix);G.removeEventListener("activate",G._afr._bounded_computeCompactWidth);G.removeEventListener("prePlaceChange",G._afr._bounded_onPrePlaceChangeCB);G.removeEventListener("placeChange",G._afr._bounded_onPlaceChangeCB);delete G._afr._bounded_computeCompactWidth;delete G._afr._bounded_onPrePlaceChangeCB;delete G._afr._bounded_onPlaceChangeCB;delete G._afr._bounded_onResizeFix;delete G._afr._isContentInitialized;var I=null;for(I in G._afr){if(G._afr.hasOwnProperty(I)){console.error(I," must be cleaned")}}J=G.windowGroup;if(J){K.removeWindow(J);J.destroy()}if(G){K.removeWindow(G);G.destroy()}}}this._isViewGenerated=false},hide:function(){var F=this;if(F!==undefined&&F._panels!==undefined){F._panels.forEach(function(G){if(G.visibleFlag){G.visibleFlag=false}})}},show:function(){var G=this;if(G!==undefined&&G._panels!==undefined&&G._uiComponent._properties!==undefined&&G._uiComponent._properties.flatModel!==undefined){if(G._panels.length===0){var F=G._uiComponent._properties.flatModel.getChildren();if(F!==undefined&&F.length!==0){G.generate({touchMode:G._touchMode})}}else{G._panels.forEach(function(H){if(!H.visibleFlag){H.visibleFlag=true}})}}},activateSection:function(G){var F=this;if(F!==undefined&&F._panels!==undefined&&F._uiComponent._properties!==undefined&&F._uiComponent._properties.flatModel!==undefined){if(F._panels.length!==0){F._panels.forEach(function(H){var I="WAfrUIModelMainComponent"+G;if(H.identifier===I){H.ensureVisible()}})}}},activateSections:function(H){var G=this;if(G!==undefined&&G._panels!==undefined&&G._uiComponent._properties!==undefined&&G._uiComponent._properties.flatModel!==undefined){if(G._panels.length!==0){var F=[];H.forEach(function(J){var I="WAfrUIModelMainComponent"+J;G._panels.forEach(function(K){if(K.identifier===I){K.expandedFlag=true;K.visibleFlag=true;if(K.windowGroup){K.windowGroup.ensureVisible();F.push(K);K.windowGroup.currentWindows=F}}})})}}},getActiveSections:function(){var G=this;var F=[];if(G!==undefined&&G._panels!==undefined&&G._uiComponent._properties!==undefined&&G._uiComponent._properties.flatModel!==undefined){if(G._panels.length!==0){G._panels.forEach(function(H){if(H.windowGroup&&H.windowGroup.currentWindows.indexOf(H)!==-1){F.push(H.identifier.replace("WAfrUIModelMainComponent",""))}})}}return F},setTouchMode:function(G){var F=this;if(G!==F._touchMode){F.toggleButtonLabel()}},setActivatedCategory:function(G){var F=this;this._defaultActivatedCategory=G},setCategoriesOrder:function(G){var F=this;if(G!==undefined&&G.length!==undefined){F._defaultTabOrder=G}},_setActiveCategory:function(F){var H=this;if(F!==undefined&&F.windowGroup!==undefined&&F.windowGroup.getEmbeddedWindows!==undefined&&F.windowGroup.getEmbeddedWindows()!==undefined&&F.activeCategoryId){var K=F.windowGroup.getEmbeddedWindows();var G=0,J;for(G=0;G<K.length;G++){var I=K[G].identifier;if(I.search("WAfrUIModelMainComponent")===0&&I.slice(24)===F.activeCategoryId){F.windowGroup.currentWindows=[K[G]];break}}}},_reorderCategories:function(O){var L=this;var N=O.orderPreferences;var K=O.tabPanels;if(O!==undefined&&K!==undefined&&N!==undefined&&N.length!==undefined){var I=0,H=0,J=-1;for(I=0;I<N.length;I++){var F=N[I];for(H=0;H<K.length;H++){var M=K[H].identifier;if(M.search("WAfrUIModelMainComponent")===0&&M.slice(24)===F){if(J>H){var G=K.splice(H,1);K.splice(J,0,G[0])}else{J=H}break}}}}},_handleTouchChange:function(){var F=this;document.addEventListener("touchChange",function(){F._touchMode=!F._touchMode;if(!F._panels[0].immersiveFrame){throw new Error("no immersive frame related to this panel",F._panels[0])}var G=F._panels[0].immersiveFrame.getDockingElement(WUXDockAreaEnum.BottomDockArea);if(!G){throw new Error("no bottom dock area in this immersive frame",F._panels[0].immersiveFrame)}if(F._touchMode){G.minSize=p;G.dockingZoneSize=G.minSize}else{G.minSize=(F._showLabelFlag===true)?n:A;G.dockingZoneSize=G.minSize}a(F._panels)})}});return l});define("DS/WAfrUIModelManagers/ContextualUIComponentManager",["UWA/Core","UWA/Class","DS/Selection/CSOManager","DS/WAfrControls/WAfrContextualBar","DS/CoreEvents/Events","DS/Core/PointerEvents"],function(h,c,f,e,g,d){var a=c.extend({init:function(){this._parent()}});var b=a.extend({defaultOptions:{onContextualBarReady:function(i){return null},onContextualMenuReady:function(i){return null},subscribersId:undefined},setContext:function(i){var j=this;if(i.executionContext!==undefined){j._executionContext=i.executionContext}if(i.UIComponent!==undefined){j._uiComponent=i.UIComponent}if(i.UIFrame!==undefined){j._uiFrame=i.UIFrame;j._container=j._uiFrame.getContainer();if(j._container!==undefined){j._unbindBehaviors();j._bindBehaviors()}}if(i.Viewer!==undefined){j._viewer=i.Viewer}},init:function(i){var j=this;j.options=h.extend(h.clone(this.defaultOptions),i);j._parent();j._contextBar=null;j._isInViewpointManipulation=false;j._listOfSubscribers=[];j._ContextualBarAvailable=true;j._ContextualBarOnLeftClic=true;j._ContextualMenuOnRightClic=true;f.onEmpty(function(){j.hideContextualMenus()})},register:function(i){i=h.extend(h.clone(this.defaultOptions),i);if(i.merge){this._listOfSubscribers.push(i)}else{this._listOfSubscribers=[];this._listOfSubscribers.push(i)}},unregister:function(j){if(j){for(var k=0;k<this._listOfSubscribers.length;k++){if(this._listOfSubscribers[k].subscriberId===j){this._listOfSubscribers.splice(k,1);break}}}},dispose:function(){g.unsubscribe(this._visuEventToken);g.unsubscribe(this._ctxbarHiddenEventToken)},hideContextualMenus:function(){document.body.removeEventListener("mouseup",this._hideListener);e.hide()},hideContextualMenu:function(){},deactivateContextualBarOnLeftClic:function(){this._ContextualBarOnLeftClic=false},activateContextualBarOnLeftClic:function(){this._ContextualBarOnLeftClic=true},deactivateContextualBar:function(){this._ContextualBarAvailable=false},activateContextualBar:function(){this._ContextualBarAvailable=true},deactivateContextualMenuOnRightClic:function(){this._ContextualMenuOnRightClic=false},activateContextualMenuOnRightClic:function(){this._ContextualMenuOnRightClic=true},getContextualBar:function(){return e},_onBarDisplayed:null,_onMenuDisplayed:null,_showContextualBar:function(i){if(i===undefined){i={}}var j=this;i.freeZone=j._uiFrame.getImmersiveFrame().getFreeZone();document.body.removeEventListener("mouseup",this._hideListener);document.body.addEventListener("mouseup",this._hideListener);if(j._contextBar){j._contextBar.hide()}else{if(j.getContextualBar()&&j.getContextualBar()!==undefined){j.getContextualBar().hide()}}if(j._listOfSubscribers.length){i.executionContext=j._executionContext;i.viewer=j._viewer;i.uiFrame=j._uiFrame.getUIFrame();i.uiComponent=j._uiComponent;if(j._isTouch===true){i.Xposition=(i.x===undefined)?j._initMousePos.x:i.x;i.Yposition=(i.y===undefined)?j._initMousePos.y:i.y}else{i.Xposition=(i.x===undefined)?j._mousePos.x:i.x;i.Yposition=(i.y===undefined)?j._mousePos.y:i.y}i.subscribersOptions=(i.fillingList===undefined||i.fillingList.length===0)?j._listOfSubscribers:i.fillingList;i.hideWithDistance=(i.hideWithDistance===undefined)?true:i.hideWithDistance;if(j._onBarDisplayed!==null){i.eventCallback=j._onBarDisplayed.bind(j)}i.Xoffset=(i.Xoffset===undefined)?45:i.Xoffset;i.Yoffset=(i.Yoffset===undefined)?-45:i.Yoffset;if(j._ContextualBarAvailable){e.show(i)}}},_onRightClick:function(k){document.body.removeEventListener("mouseup",this._hideListener);document.body.addEventListener("mouseup",this._hideListener);var j=this;k.preventDefault();j._finalMousePos={x:k.clientX,y:k.clientY};if(!j._isInViewpointManipulation&&(j._initMousePos.x===j._finalMousePos.x&&j._initMousePos.y===j._finalMousePos.y)&&j._ContextualMenuOnRightClic!==false){var i={hideWithDistance:false,x:j._mousePos.x,y:j._mousePos.y,Xoffset:0,Yoffset:-5,withContextMenu:true};j._showContextualBar(i)}},_bindBehaviors:function(){var k=this;k._mousePos={x:0,y:0};this._uiFrame.getContainer().addEvent("mousemove",function(m){k._mousePos={x:m.clientX,y:m.clientY}});this._hideListener=function(n){var m=h.Event.findElement(n,".wux-afr-contextual-bar");if(!m){}};k._uiFrame.getContainer().addEvent(d.POINTERDOWN,k._onPointerDown.bind(k));k._uiFrame.getContainer().addEvent("mousedown",k._onMouseDown.bind(k));k._uiFrame.getContainer().addEvent(d.POINTERUP,k._onMouseUp.bind(k));k._uiFrame.getContainer().addEvent("contextmenu",k._onRightClick.bind(k));var i=0;var j=function(m){i=0};var l=false;k._visuEventToken=g.subscribe({event:"/VISU/"},function(n){var m={};if(n.eventType==="@onViewpointChange"){if(i===0){if(k.getContextualBar()._isShown===true){l=true}k.hideContextualMenus();k._uiFrame.getContainer().removeEvent("mouseup",j);k._uiFrame.getContainer().addEvent("mouseup",j)}i++}else{if(n.eventType==="@onViewpointBeginMove"){i=0;k._isInViewpointManipulation=true;l=false}else{if(n.eventType==="@onViewpointEndMove"){k._isInViewpointManipulation=false;if(l===true){k.hideContextualMenus();m.hideWithDistance=true;k._showContextualBar(m)}}else{if(n.eventType==="@onClickEvent"&&k._ContextualBarOnLeftClic===true){if(n.eventID==="@pickNothing"||n.eventID==="@pickPrimitive"||n.eventID==="@pickRep"||n.eventID==="@pickMesh"){k.hideContextualMenus();m={x:n.event.currentPosition.x,y:n.event.currentPosition.y};m.hideWithDistance=n.event.type!=="Touch";k._showContextualBar(m)}}}}}});this._ctxbarHiddenEventToken=g.subscribe({event:"WUX/AFR/ctxBarHidden"},function(m){k.hideContextualMenu()})},_unbindBehaviors:function(){var i=this;i._uiFrame.getContainer().removeEvent(d.POINTERDOWN,i._onPointerDown.bind(i));i._uiFrame.getContainer().removeEvent("mousedown",i._onMouseDown.bind(i));i._uiFrame.getContainer().removeEvent(d.POINTERUP,i._onMouseUp.bind(i));i._uiFrame.getContainer().removeEvent("contextmenu",i._onRightClick.bind(i));g.unsubscribe(this._ctxbarHiddenEventToken)},_onMouseUp:function(k){var j=this;var i=k.button;if(i===1){j._isInViewpointManipulation=false}},_onMouseDown:function(k){var j=this;j._initMousePos={x:k.offsetX===undefined?k.layerX:k.offsetX,y:k.offsetY===undefined?k.layerY:k.offsetY};var i=k.button;if(i===1){j._isInViewpointManipulation=true}},_onPointerDown:function(j){var i=this;i._initMousePos={x:j.offsetX===undefined?j.layerX:j.offsetX,y:j.offsetY===undefined?j.layerY:j.offsetY};i._isTouch=d.isTouchEvent(j)}});return b});