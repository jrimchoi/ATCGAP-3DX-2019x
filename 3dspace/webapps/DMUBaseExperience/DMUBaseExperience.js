define("DS/DMUBaseExperience/EXPUnitManagement",["i18n!DS/DMUBaseExperience/assets/nls/DMUBaseExperience"],function(a){var b={convert:function(i,f,h,k,e,j){var d=i;switch(d.toLowerCase()){case"length":d="Length";break;case"area":d="Area";break;case"angle":d="Angle";break;case"volume":d="Volume";break}var c=k&&k.getDMUPreferenceRepository?k.getDMUPreferenceRepository().getPreference(d):null;if(!c){c=b.Types[d].defaultValue}if(b[d]&&b[d][c]){var g=parseFloat(f)*b[d][c].ratio;return(g).toFixed((typeof h!=="number")?10:h)+((e!==true)?" ":"")+((j!==true)?b[d][c].nls:"")}return""},Types:{Length:{name:"Length",defaultValue:"mm"},Angle:{name:"Angle",defaultValue:"deg"},Volume:{name:"Volume",defaultValue:"mm3"},Area:{name:"Area",defaultValue:"mm2"}},Length:{mm:{name:"mm",nls:a.units.mm,ratio:1},cm:{name:"cm",nls:a.units.cm,ratio:Math.pow(10,-1)},m:{name:"m",nls:a.units.m,ratio:Math.pow(10,-3)},km:{name:"km",nls:a.units.km,ratio:Math.pow(10,-6)},inch:{name:"inch",nls:a.units.inch,ratio:1/25.4},foot:{name:"foot",nls:a.units.foot,ratio:1/304.8}},Angle:{deg:{name:"deg",nls:a.units.deg,ratio:1},rad:{name:"rad",nls:a.units.rad,ratio:Math.PI/180}},Volume:{mm3:{name:"mm3",nls:a.units.mm3,ratio:1},cm3:{name:"cm3",nls:a.units.cm3,ratio:Math.pow(10,-3)},m3:{name:"m3",nls:a.units.m3,ratio:Math.pow(10,-9)},km3:{name:"km3",nls:a.units.km3,ratio:Math.pow(10,-18)},inch3:{name:"inch3",nls:a.units.inch3,ratio:1/16387.064},foot3:{name:"foot3",nls:a.units.foot3,ratio:1/28316846.6}},Area:{mm2:{name:"mm2",nls:a.units.mm2,ratio:1},cm2:{name:"cm2",nls:a.units.cm2,ratio:Math.pow(10,-2)},m2:{name:"m2",nls:a.units.m2,ratio:Math.pow(10,-6)},km2:{name:"km2",nls:a.units.km2,ratio:Math.pow(10,-12)},inch2:{name:"inch2",nls:a.units.inch2,ratio:1/645.16},foot2:{name:"foot2",nls:a.units.foot2,ratio:1/92903.04}}};return Object.freeze(b)});define("DS/DMUBaseExperience/EXPManagerSet",["UWA/Class"],function(a){var b=a.singleton({name:"EXPManagerSet",init:function(){var c=[];this.getManager=function(e){for(var d=0;d<c.length;d++){if(c[d].context===e.context&&c[d].name===e.name){return c[d].mng}}};this.addManager=function(d){if(!d||!d.name||!d.context||!d.manager){return}c.push({context:d.context,name:d.name,mng:d.manager,count:1})};this.increaseRefCount=function(e){for(var d=0;d<c.length;d++){if(c[d].context===e.context&&c[d].name===e.name){c[d].count++}}};this.removeManager=function(e){for(var d=0;d<c.length;d++){if(c[d].context===e.context&&c[d].name===e.name){c[d].count--;if(c[d].count===0){if(c[d].mng.unInitialize){c[d].mng.unInitialize()}c.splice(d,1)}}}}},increaseRefCount:function(){},getManager:function(){},addManager:function(){},removeManager:function(){}});return b});define("DS/DMUBaseExperience/EXPNls",["DS/RuntimeView/NLSManager"],function(a){var d=[];var e={};d.Appartient=function(f){for(var g=0;g<this.length;g++){if(this[g]===f){return true}}return false};var c=[];var b={getProxy:function(f){return e[f]},setProxy:function(g,f){e[g]=f},loadNls:function(f){if(a){a.loadResource(f)}},readNls:function(f){var g=f.resourceFile+"/"+f.fileName;if(a){if(d.length!==0){if(d.Appartient(g)===false){b.loadNls(f);d.push(g)}}else{b.loadNls(f);d.push(g)}}},getNls:function(f){var h=f.split(".");var g=h[0]+"/"+h[1];var j=b.getLocalResource(g);var i=f.split(".").splice(1,f.length).join(".");if(j&&j._manager&&j._manager._getKeyValue({resourceKey:g,key:i})){return j._manager._getKeyValue({resourceKey:g,key:i}).value}else{}},setLocalResource:function(g,h){var f=window.widget&&window.widget.lang?window.widget.lang:"en";a.loadResource({resourceFile:g,language:f});c[g]="";a.onResourceLoaded({resourceFile:g},function(){c[g]=this;if(h){h()}})},getLocalResource:function(f){return c[f]}};return b});define("DS/DMUBaseExperience/EXP3DReviewWidgetSingleton",["UWA/Class","UWA/Class/Options"],function(b,a){var c=b.singleton(a,{name:"EXP3DReviewWidgetSingleton",init:function(){var d=null;this.set=function(e){if(!d&&e){d=e}};this.get=function(){return d}}});c.init();return c});define("DS/DMUBaseExperience/EXPPersistenceManager",["UWA/Class"],function(b){var a=b.extend({init:function(){var c=[];this.register=function(e){var d=c.indexOf(e);if(d===-1){e._isDirty=null;c.push(e)}};this.remove=function(e){var d=c.indexOf(e);c.splice(d,1)};this.clear=function(){c.length=0};this.getObjectsToPersist=function(){return c};this.makeDirty=function(d){if(d){d._isDirty=1}};this.resetDirtifcation=function(){for(var d=0;d<c.length;d++){if(c[d]){c[d]._isDirty=0}}}}});return a});define("DS/DMUBaseExperience/EXPPreferences",[],function(){var a=[];return{readLocal:function(b){return a[b]},writeLocal:function(c,b){a[c]=b}}});define("DS/DMUBaseExperience/EXPToolsVisualization",["DS/Visualization/ThreeJS_DS","DS/DMUMeasurable/DMUMathsInfiniteGeometry","DS/DMUMeasurable/DMUToolsMaths"],function(c,b,d){var a={getViewpointInfo:function(h){if(h){var g=new c.Matrix4().lookAt(new c.Vector3(),h.getSightDirection(),h.getUpDirection());var f=new c.Quaternion().setFromRotationMatrix(g);var e=d.quaternionToAxisSystem(f);return{position:h.getEyePosition(),sight:h.getSightDirection(),right:e.X,up:h.getUpDirection(),distance:h.getTargetDistance()}}},moveViewpoint:function(k,j,g,l,f,i,h){if(!k){return}var e=g?g.clone():new c.Vector3();e.sub(new c.Vector3().copy(l).multiplyScalar(i));if(h){k.currentViewpoint.moveTo({eyePosition:j?j:e,upDirection:f,sightDirection:l,distanceToTarget:i,duration:h})}else{k.currentViewpoint.setEyePosition(j?j:e);k.currentViewpoint.setSightDirection(l);k.currentViewpoint.setUpDirection(f);k.currentViewpoint.setTargetDistance(i);k.render()}},getMousePosition:function(k,i){var e={};var h=k.canvas.getBoundingClientRect();var f=(k.devicePixelRatio)?k.devicePixelRatio:1;var j=i.pageX-h.left;var g=i.pageY-h.top;e.x=(j/k.canvas.offsetWidth)*2-1;e.y=-(g/k.canvas.offsetHeight)*2+1;e.xPix=j*f;e.yPix=g*f;return e},getPickingInfo:function(i,g){var f,h;var e=i.pick(a.getMousePosition(i,g),"mesh",true);if(e!==undefined){if((e.position!==undefined)&&(e.position!==null)){f=e.position.clone()}if((e.normal!==undefined)&&(e.normal!==null)){h=e.normal.clone()}}return{point:f,normal:h}},getSelectedPathElement:function(h,g){var f=null;var e=h.pick(a.getMousePosition(h,g),"mesh",false);if(e&&e.path&&e.path[0]){f=e.path[0]}return f},getWindowPositionFromPoint:function(l,e,i){var k=new c.Projector();var h=k.projectVector(e.clone(),l.viewpoints[0].getCamera());var j=Math.round((0-h.y)*(i.getContent().offsetHeight/2))+i.getContent().offsetHeight/2;var g=Math.round(h.x*(i.getContent().offsetWidth/2))+i.getContent().offsetWidth/2;var f=((j>0)&&(j<i.getContent().offsetWidth)&&(g>0)&&(g<i.getContent().offsetWidth));return{top:j,left:g,bottom:i.getContent().offsetHeight-j,right:i.getContent().offsetWidth-g,inWindow:f}},getViewerPositionFromPoint:function(k,e){var j=new c.Projector();var h=j.projectVector(e.clone(),k.viewpoints[0].getCamera());var i=Math.round((0-h.y)*(k.canvas.offsetHeight/2))+k.canvas.offsetHeight/2;var g=Math.round(h.x*(k.canvas.offsetWidth/2))+k.canvas.offsetWidth/2;var f=((i>0)&&(i<k.canvas.offsetHeight)&&(g>0)&&(g<k.canvas.offsetWidth));return{top:i,left:g,bottom:k.canvas.offsetHeight-i,right:k.canvas.offsetWidth-g,inWindow:f}},get3DPositionFromScreenCoordinates:function(g){if(g.coords&&g.viewer){var h=a.getLineFromWindowPosition(g.viewer,g.coords.x,g.coords.y);var e=a.getViewpointInfo(g.viewer.currentViewpoint);if(h.position.x!==0&&h.position.y!==0&&h.position.z!==0){var f=b.computeLinePlaneDistance(h.position.toArray(),h.direction.toArray(),[0,0,0],e.sight.toArray());return new c.Vector3(f.aPosition[0],f.aPosition[1],f.aPosition[2])}}return new c.Vector3(1,0,0)},getLineFromWindowPosition:function(i,j,h){var f=new c.Vector3(((j-window.pageXOffset)/i.canvas.offsetWidth)*2-1,-((h-window.pageYOffset)/i.canvas.offsetHeight)*2+1,0.5);var g=new c.Projector();var e=g.pickingRay(f.clone(),i.currentViewpoint.camera);return{position:e.ray.origin.clone(),direction:e.ray.direction.clone()}},getDistanceFromPixel:function(k,f,i,h){var j=a.getViewerPositionFromPoint(k,f,h);var g=a.getLineFromWindowPosition(k,j.left+i,j.top);var e=b.computePointLineDistance(f.toArray(),g.position.toArray(),g.direction.toArray());return e.distance},getPositionFromIntersection:function(l,j,h,g){var i=this.getWindowPositionFromPoint(l,j,g);var k=this.getLineFromWindowPosition(l,i.left,i.top);var e=this.getViewpointInfo(l.currentViewpoint);var f=b.computeLinePlaneDistance(k.position.toArray(),k.direction.toArray(),h.toArray(),e.sight.toArray());return new c.Vector3(f.aPosition[0],f.aPosition[1],f.aPosition[2])},getMMPerPixelRatio:function(k,g){var f;var j=k.currentViewpoint;if(j.getProjectionType()===1){f=j.camera.top-j.camera.bottom}else{var l=j.getAngle()*Math.PI/180;var e=j.getEyePosition();var i=new c.Vector3().copy(g);var h=new c.Vector3().subVectors(i,e);f=2*Math.tan(0.5*l)*h.length()}return f/k.SCREEN_HEIGHT},convertModelToPixels:function(e){if(e.coords){return e.sizeInMM/a.getMMPerPixelRatio(e.viewer,e.coords)}return e.sizeInMM*(96/25.4)},convertPixelToModel:function(e){if(e.coords){return e.sizeInPixels*a.getMMPerPixelRatio(e.viewer,e.coords)}return e.sizeInPixels/(96/25.4)},getMatrixFromIntersection:function(l){var i=l.normal.negate();i.normalize();var k=new c.Vector3(1,0,0).projectOnPlane(i);var g=k.length();var j=new c.Vector3(0,1,0).projectOnPlane(i);var f=j.length();var e=new c.Vector3().crossVectors(new c.Vector3(0,0,1),i);var h=new c.Vector3(0,0,1).dot(i);if(d.areEqual(Math.abs(h),1,"float")){if(d.areEqual(g,f,"float")){k.normalize();j=new c.Vector3().crossVectors(i,k).normalize()}else{if(g<f){j.normalize();k=new c.Vector3().crossVectors(j,i).normalize()}else{k.normalize();j=new c.Vector3().crossVectors(i,k).normalize()}}}else{k=e.normalize();j=new c.Vector3().crossVectors(i,k).normalize()}return new c.Matrix4(k.x,j.x,i.x,0,k.y,j.y,i.y,0,k.z,j.z,i.z,0,0,0,0,1)},computeImage:function(t,s,j,h){if(t.get2DMode()){var i=function(y){var x=new Image();x.src=y.toDataURL("image/jpeg");if(h&&h.onSuccess){h.onSuccess(x)}};t._renderToCanvas(i,function(){if(h&&h.onError){h.onError()}})}else{var g=document.createElement("canvas");var r={data:null,width:Math.round(t.SCREEN_WIDTH*window.devicePixelRatio),height:Math.round(t.SCREEN_HEIGHT*window.devicePixelRatio)};t.renderToTarget(r,t.currentViewpoint);var l=r.width/r.height;if(l>(s/j)){g.height=j;g.width=g.height*l}else{g.width=s;g.height=g.width/l}var p=2;g.width*=p;g.height*=p;var e=g.getContext("2d");e.clearRect(0,0,g.width,g.height);var v=function(y,x,A,B,z){if(z){x=B-x-1}return A*Math.floor(x)+Math.floor(y)};var q=e.getImageData(0,0,g.width,g.height);var f=r.width/q.width,m=r.height/q.height;for(var u=0;u<q.height;u++){for(var n=0;n<q.width;n++){var k=v(n,u,q.width,q.height,false);var o=v(f*n,m*u,r.width,r.height,true);q.data[4*k]=r.data[4*o];q.data[4*k+1]=r.data[4*o+1];q.data[4*k+2]=r.data[4*o+2];q.data[4*k+3]=r.data[4*o+3]}}r.data=null;r=null;e.putImageData(q,0,0,0,0,g.width,g.height);var w=new Image();w.src=g.toDataURL("image/jpeg");if(h&&h.onSuccess){h.onSuccess(w)}return w}}};return a});define("DS/DMUBaseExperience/EXPToolsMaterial",["DS/Visualization/ThreeJS_DS","DS/Mesh/Mesh","DS/Visualization/MaterialManager"],function(c,d,a){var e;var b={createBasicMaterial:function(f){return new c.MeshBasicMaterial({color:f.color&&!isNaN(f.color.r)&&!isNaN(f.color.g)&&!isNaN(f.color.b)?f.color:(f.color?new c.Color(f.color):new c.Color()),side:c.DoubleSide,transparent:true,opacity:(f.opacity||f.opacity===0)?f.opacity:1,force:true})},getDashPattern:function(k,f,i){var h=k;if(isNaN(h)){h={solid:d.LinePatternEnum.SOLID,SOLID:d.LinePatternEnum.SOLID,DOTTED:d.LinePatternEnum.DOTTED,dotted:d.LinePatternEnum.DOTTED,DASHED:d.LinePatternEnum.DASHED,dashed:d.LinePatternEnum.DASHED,dot_dashed:d.LinePatternEnum.DOTDASHED,DOT_DASHED:d.LinePatternEnum.DOTDASHED,PHANTOM:d.LinePatternEnum.PHANTOM,SMALL_DOT:d.LinePatternEnum.SMALLDOTTED,JIS_AXIS:d.LinePatternEnum.JISAXIS}[h]}else{h=parseFloat(h)}if(!i){if(!e){e=new a()}var j=e.getDashPattern?e.getDashPattern(h):e._getDashPattern(h);if(!isNaN(f)){for(var g=0;g<j.length;g++){j[g]*=f}}return j}else{return h}},createLineMaterial:function(f){return new c.LineBasicMaterial({color:f.color&&!isNaN(f.color.r)&&!isNaN(f.color.g)&&!isNaN(f.color.b)?f.color:(f.color?new c.Color(f.color):new c.Color()),lineWidth:!isNaN(f.lineWidth)?f.lineWidth:1,opacity:(f.opacity||f.opacity===0)?f.opacity:1,transparent:true,force:true,dashPattern:b.getDashPattern(f.pattern),isCPUPattern:true,polygonBorderMode:true})}};return b});define("DS/DMUBaseExperience/EXPControllerEvents",[],function(){var a=a||{REVISION:"1"};a.Events={EXPRootDetachedEvent:"EXPRootDetachedEvent",EXPRootAttachedEvent:"EXPRootAttachedEvent",EXPRootAddedEvent:"EXPRootAddedEvent",EXPRootRemovedEvent:"EXPRootRemovedEvent",EXPBeginRootLoadingEvent:"EXPBeginRootLoadingEvent",EXPRootAlreadyExistingEvent:"EXPRootAlreadyExistingEvent",EXPLoadingStartedEvent:"EXPLoadingStartedEvent",EXPAssetChangedEvent:"EXPAssetChangedEvent",EXPExperienceDisposed:"EXPExperienceDisposed",EXPLoadingCompleteEvent:"EXPLoadingCompleteEvent",EXPLoadingFailureEvent:"EXPLoadingFailureEvent",EXPMoveEvent:"EXPMoveEvent",EXPEndReparentEvent:"EXPEndReparentEvent",EXPBeginReparentEvent:"EXPBeginReparentEvent",EXPReparentFailureEvent:"EXPReparentFailureEvent",EXPInsertExistingFailureEvent:"EXPInsertExistingFailureEvent",EXPInsertExistingEvent:"EXPInsertExistingEvent",EXPEndDeleteEvent:"EXPEndDeleteEvent",EXPBeginDeleteEvent:"EXPBeginDeleteEvent",EXPDefaultStreamChangedEvent:"EXPDefaultStreamChangedEvent",EXPHideEvent:"EXPHideEvent",EXPShowEvent:"EXPShowEvent",EXPExclusiveShowEvent:"EXPExclusiveShowEvent",EXPHideShowEvent:"EXPHideShowEvent",EXPRootModifiedEvent:"EXPRootModifiedEvent",EXPLineLayoutComputationBeginEvent:"EXPLineLayoutComputationBeginEvent",EXPLineLayoutComputationEndEvent:"EXPLineLayoutComputationEndEvent",EXPModelUpdatedEvent:"EXPModelUpdatedEvent",EXPClippingPlaneEvent:"EXPClippingPlaneEvent"};a.mapPadEvent={EXPRootDetachedEvent:["onRootDetached"],EXPRootAttachedEvent:["onRootAttached"],EXPRootAddedEvent:["onRootAdded"],EXPRootRemovedEvent:["onRootRemoved"],EXPBeginRootLoadingEvent:["onBeginRootLoading"],EXPRootAlreadyExistingEvent:["onRootAlreadyExisting"],EXPLoadingStartedEvent:["ASSET/LOADINGSTARTED"],EXPAssetChangedEvent:["ASSET/CHANGE"],EXPExperienceDisposed:["EXPERIENCE/DISPOSE"],EXPLoadingCompleteEvent:["onLoadingComplete","ASSET/LOADINGFINISHED"],EXPLoadingFailureEvent:["onLoadingFailure"],EXPMoveEvent:["onMove"],EXPEndReparentEvent:["onEndReparent"],EXPBeginReparentEvent:["onBeginReparent"],EXPReparentFailureEvent:["onReparentFailure"],EXPInsertExistingFailureEvent:["onInsertExistingFailure"],EXPInsertExistingEvent:["onInsertExisting"],EXPEndDeleteEvent:["onEndDelete"],EXPBeginDeleteEvent:["onBeginDelete"],EXPDefaultStreamChangedEvent:["onDefaultStreamChanged"],EXPHideEvent:["onHide","3DPLAY/HIDE","DMUHIDE"],EXPShowEvent:["onShow","3DPLAY/SHOW_ALL","DMUSHOW"],EXPExclusiveShowEvent:["onExclusiveShow"],EXPHideShowEvent:["onHide","3DPLAY/HIDE","DMUHIDE","onShow","3DPLAY/SHOW_ALL","DMUSHOW"],EXPRootModifiedEvent:["onRootDetached","onRootAttached","onRootAdded","onRootRemoved"],EXPLineLayoutComputationBeginEvent:["onLayoutComputationBegin"],EXPLineLayoutComputationEndEvent:["onLayoutComputationEnd"],EXPModelUpdatedEvent:["onModelUpdated"],EXPClippingPlaneEvent:["ASSET/EXPCLIPPINGPLANEEVENT"]};return a});define("DS/DMUBaseExperience/EXPController",["UWA/Class","DS/Core/ModelEvents","DS/Core/Events","DS/DMUBaseExperience/EXPControllerEvents","DS/Visualization/ThreeJS_DS"],function(b,f,e,c,d){var a=b.extend({init:function(q){this._parent(q);var l=this;var p=new f();var k={};var m={};function h(s,r,u){var t;switch(s){case"DMUHIDE":case"DMUSHOW":t=e.subscribe({event:"/"+q.context.getCommandContext()+"/"+s+"/"},function(v){if(l){v.event=r;i({event:r,data:v})}});break;default:t=u.subscribe({event:s},function(x){if(l){var v=x.nodes;if(v){var y=v.length;for(var w=0;w<y;w++){i({event:r,data:v[w]})}}else{x.event=r;i({event:r,data:x})}}})}return t}function o(s,r,t){if(t){t.subscribe({event:s},function(u){if(l){i({event:r,data:u})}})}}function g(s,r,v){var t;function u(w,C){var y,F;for(y=0;y<w.length;++y){var D=C.clone();var x=w[y].decompose();var E=x[0];var B=new d.Vector3(0,0,1).applyQuaternion(x[1]);var z=B.dot(D.sub(E).normalize());var A=(z+0.000001<0)?true:false;if(F===undefined){F=A}else{F=A||F}}return F}t=e.subscribe({event:"/"+q.context.getCommandContext()+"/"+s+"/"},function(y){if(l){var w;var z=v.point.length;for(var x=0;x<z;x++){w=u(y,v.point[x]);if(w){break}}var A=k[t];if(w&&A||!w&&!A){k[t]=!A;y.event=r;y.visibility=!A;y.id=v.id;i({event:r,data:y})}}});k[t]=true;return t}this.addEvent=function(x,y,w){var s;var r=c.mapPadEvent[x];var z=j({event:x},y);var t=[];switch(x){case c.Events.EXPHideEvent:case c.Events.EXPShowEvent:case c.Events.EXPExclusiveShowEvent:case c.Events.EXPHideShowEvent:var v=q.context.getHideShowController();if(v){r.forEach(function(A){s=h(A,x,v);t.push({PADShowController:s})})}break;case c.Events.EXPRootAddedEvent:case c.Events.EXPRootRemovedEvent:case c.Events.EXPRootAttachedEvent:case c.Events.EXPRootDetachedEvent:case c.Events.EXPMoveEvent:case c.Events.EXPBeginRootLoadingEvent:case c.Events.EXPRootAlreadyExistingEvent:case c.Events.EXPLoadingStartedEvent:case c.Events.EXPExperienceDisposed:case c.Events.EXPAssetChangedEvent:case c.Events.EXPLoadingCompleteEvent:case c.Events.EXPLoadingFailureEvent:case c.Events.EXPEndReparentEvent:case c.Events.EXPBeginReparentEvent:case c.Events.EXPReparentFailureEvent:case c.Events.EXPInsertExistingFailureEvent:case c.Events.EXPInsertExistingEvent:case c.Events.EXPEndDeleteEvent:case c.Events.EXPBeginDeleteEvent:case c.Events.EXPDefaultStreamChangedEvent:case c.Events.EXPRootModifiedEvent:var u=q.context.getController();if(u){r.forEach(function(A){s=h(A,x,u);t.push({PADController:s})})}break;case c.Events.EXPClippingPlaneEvent:r.forEach(function(A){s=g(A,x,w);t.push({ClippingController:s})});break;case c.Events.EXPLineLayoutComputationBeginEvent:case c.Events.EXPLineLayoutComputationEndEvent:case c.Events.EXPModelUpdatedEvent:r.forEach(function(A){s=o(A,x,q.context);t.push({PAD3DViewer:s})});break}m[z]=t;return z};this.removeEvent=function(r){var u=m[r];if(u){for(var t=0;t<u.length;t++){if("PADController" in u[t]){var v=q.context.getController();if(v){v.unsubscribe(u[t].PADController)}}if("PADShowController" in u[t]){var s=q.context.getHideShowController();if(s){s.unsubscribe(u[t].PADShowController)}}if("ClippingController" in u[t]){e.unsubscribe(u[t].ClippingController)}}delete m[r]}n(r)};function i(r){if(p&&r){p.publish(r)}}function j(r,s){if(p&&r&&s){return p.subscribe(r,s)}}function n(r){if(p&&r){p.unsubscribe(r)}}this.clean=function(){var s=Object.keys(m);for(var r=s.length-1;r>=0;r--){l.removeEvent(s[r])}l=p=k=m=null}},destroy:function(){this.clean();this._parent()}});return a});define("DS/DMUBaseExperience/DMUContextManager",["UWA/Class","DS/DMUBaseExperience/EXPController"],function(b,a){var c=b.singleton({init:function(){var i=[],h=[],k=[],e=[];function f(n,m){if(!n.viewer&&!n.context){return}for(var l=0;l<m.length;l++){if((n.context&&m[l].context===n.context)||(n.viewer&&m[l].context.getViewer()===n.viewer)){if(n.controller){m[l].controller=n.controller}else{m.splice(l,1)}return}}m.push({context:n.context,controller:n.controller})}function g(n,m){if(!n.viewer&&!n.context){return undefined}for(var l=0;l<m.length;l++){if((n.context&&m[l].context===n.context)||(n.viewer&&n.viewer===m[l].context.getViewer())){return m[l].controller}}return undefined}function d(n,m){for(var l=0;l<m.length;l++){if((n.context&&m[l].context===n.context)||(n.viewer&&n.viewer===m[l].context.getViewer())){if(m[l].controller){m[l].controller.remove()}m.splice(l,1);break}}}this.getReviewContext=function(m){var l=g(m,h);if(l){return l}return g(m,i)};this.setReviewContext=function(l){f(l,i)};this.removeReviewContext=function(l){d(l,i)};this.getContextViewer=function(n){var m;for(m=0;m<h.length;m++){if((n.reviewContext&&h[m].controller===n.reviewContext)||(n.viewer&&h[m].context.getViewer()===n.viewer)){return h[m].context}}for(m=0;m<i.length;m++){if((n.reviewContext&&i[m].controller===n.reviewContext)||(n.viewer&&i[m].context.getViewer()===n.viewer)){return i[m].context}}var o="DS/PADUtils/PADContext";var l=require(o).get();return l.getViewer()===n.viewer?l:null};this.getSavedReviewContext=function(l){return g(l,k)};this.setSavedReviewContext=function(l){f(l,k)};this.removeSavedReviewContext=function(l){d(l,k)};this.setSwitchedReviewContext=function(l){if(!l.controller||(l.controller&&!l.controller.isSwitchedReviewCtx)){return}f(l,h)};this.removeSwitchedReviewContext=function(l){d(l,h)};this.getEventsController=function(n){if(!n.context){return undefined}for(var m=0;m<e.length;m++){if(e[m].context===n.context){e[m].counter++;return e[m].controller}}var l=new a(n);e.push({context:n.context,controller:l,counter:1});return l};this.giveEventsController=function(m){if(!m.context&&!m.viewer){return undefined}for(var l=0;l<e.length;l++){if((e[l].context===m.context)||(e[l].context.getViewer()===m.viewer)){return e[l].controller}}return undefined};this.unreferenceEventsController=function(m){for(var l=0;l<e.length;l++){if((e[l].context===m.context)||(e[l].context.getViewer()===m.viewer)){e[l].counter--;if(e[l].counter<=0){e[l].controller.destroy();e.splice(l,1)}}}};var j=[];this.setAuthoringFeatureTypes=function(l){if(j.indexOf(l)===-1){j.push(l)}};this.getAuthoringFeatureTypes=function(){return j}}});c.init();return c});define("DS/DMUBaseExperience/EXPUtils",["DS/Visualization/ThreeJS_DS","DS/DMUBaseExperience/EXPPreferences","DS/DMUBaseExperience/DMUContextManager","DS/ApplicationFrame/CommandsManager","DS/WebSystem/Settings"],function(e,b,d,a,c){var f={getIndexOf:function(j,g,k){for(var h=0;h<j.length;h++){if(j[h]&&j[h][g]===k){return h}}return -1},updateListOrder:function(j,g,k){var h=this.getIndexOf(j,g,k);if(h!==-1){var i=j[h];j.splice(h,1);j.unshift(i)}return j},getValue:function(k,j){var m;var h=k._parameters.length;var g=k.getAttribute(j);for(var l=0;(l<h)&&(m===undefined);l++){var n=k._parameters[l];if(n.name===j){if(n.type==="bool"){m=g}else{if(n.type==="Color"){m=f.colorToHex(g)}else{m=f.typeToStr(g,n.type)}}}}if(j==="sSectionRender"){m=(g==="CutOneSide")}if(j==="sTextContents"){for(var l=0;l<g.length;l++){if(g[l].replace){g[l].replace("<br>","\n")}}m=g}if(j==="vTranslationValue"&&k.getTranslationValue&&k.getTranslationValue()!==undefined){m=k.getTranslationValue()}return m},setValue:function(k,h,g){var l,m;for(var j=0;j<h._parameters.length;j++){m=h._parameters[j];if(m.name===g){if(m.type==="bool"){l=k}else{if(m.type==="Color"){l=f.hexToColor(k)}else{l=f.strToType(k,m.type)}}break}}if(!m||m.name!==g){return}if(g==="sSectionRender"){l=l?"CutOneSide":"NoCut"}if(g==="sTextContents"&&l&&!Array.isArray(l)){l=[k]}h.set({attribute:m.name,value:l});if(g==="vTranslationValue"&&h.setTranslationValue){h.setTranslationValue(l)}else{if(h.refreshNode){h.refreshNode()}h._viewer.render()}},colorToHex:function(j){if(j){if(j.substr&&j.substr(0,1)==="#"){return j}else{if(j.r!==undefined&&j.g!==undefined&&j.b!==undefined){if(j.r<0||j.g<0||j.b<0){return null}var l=Math.round((j.r*255)).toString(16);l=(l.length<2)?"0"+l:l;var k=Math.round((j.g*255)).toString(16);k=(k.length<2)?"0"+k:k;var p=Math.round((j.b*255)).toString(16);p=(p.length<2)?"0"+p:p;return"#"+l+k+p}else{var g=/(.*?)rgb\((\d+), *(\d+), *(\d+)\)/.exec(j);if(g){if(parseInt(g[2],10)===0&&parseInt(g[3],10)===0&&parseInt(g[4],10)===0){return"#000000"}else{var h=parseInt(g[2],10);var i=parseInt(g[3],10);var o=parseInt(g[4],10);var n=o|(i<<8)|(h<<16);var m=h===0?"00"+n.toString(16):n.toString(16);return"#"+m}}}}}return j},hexToRgb:function(i,j){var k;if(i!==undefined){if(i.substr(0,1)!=="#"){var l=/(.*?)rgb\((\d+), *(\d+), *(\d+)\)/.exec(i);k="rgba("+l[2]+","+l[3]+","+l[4]+","+j+")"}else{var h=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;i=i.replace(h,function(o,q,p,n){return q+q+p+p+n+n});var g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);g={r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)};k="rgba("+g.r+","+g.g+","+g.b+","+j+")"}}return k},strToType:function(i,h){if(i===null||i===undefined||i===""||h===null||h===undefined||h===""){return}var g=null;switch(h){case"bool":g=f.strToBool;break;case"int":g=f.strToInt;break;case"float":g=f.strToFloat;break;case"Color":g=f.strToColor;break;case"Vector3":g=f.strToVect;break;case"ListVector3":g=f.strToListVect;break;case"Vector2":g=f.strToVect2;break;case"ListVector2":g=f.strToListVect2;break;case"Matrix4":g=f.strToMat4;break;case"AABB":g=f.strToAABB;break;case"ImageURL":g=f.strToImageURL;break;case"listFloat":g=f.strToListFloat;break;case"string":return i;case"listStrings":g=f.strToListStrings;break;default:return i}return g(i)},typeToStr:function(i,h){if(i===null||i===undefined||i===""||h===null||h===undefined||h===""){return}var g=null;switch(h){case"bool":g=f.boolToStr;break;case"int":g=f.intToStr;break;case"float":g=f.floatToStr;break;case"Color":g=f.colorToStr;break;case"Vector3":g=f.vectToStr;break;case"ListVector3":g=f.listVectToStr;break;case"Vector2":g=f.vect2ToStr;break;case"ListVector2":g=f.listVect2ToStr;break;case"Matrix4":g=f.mat4ToStr;break;case"AABB":g=f.aabbToStr;break;case"ImageURL":g=f.imageURLToStr;break;case"listFloat":g=f.listFloatToStr;break;case"string":return i;case"listStrings":g=f.listStringsToStr;break;default:return i}return g(i)},lerpType:function(j,i,g,h){var k;switch(h){case"bool":k=(g<0.5?j:i);break;case"int":k=(g<0.5?j:i);break;case"float":k=f.lerpFloats(j,i,g);break;case"Color":k=f.lerpColors(j,i,g);break;case"Vector3":k=f.lerpVectors(j,i,g);break;case"ListVector3":k=f.lerpListVectors(j,i,g);break;case"Vector2":k=f.lerpVectors2(j,i,g);break;case"ListVector2":k=f.lerpListVectors2(j,i,g);break;case"Matrix4":k=f.lerpMat4(j,i,g);break;case"string":k=(g<0.5?j:i);break;default:k=(g<0.5?j:i)}return k},cloneType:function(j,h){var i;if(j!==undefined){if(j===null){i=j}else{switch(h){case"Matrix4":i=j.clone();break;case"listFloat":i=j;break;case"ImageURL":var g=new Image();if(j.src){g.src=j.src}i=g;break;case"listStrings":i=j.slice(0);break;default:i=j}}}return i},strToColor:function(h){var g=h.replace(/[RGB( )]/gi,"").split(",");return new e.Color().setRGB(parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2]))},colorToStr:function(g){return g&&typeof g==="object"&&!isNaN(g.r)&&!isNaN(g.g)&&!isNaN(g.b)?"RGB("+g.r+","+g.g+","+g.b+")":null},hexToColor:function(h){if(!h){return null}var g=new e.Color();g.r=parseInt(h[1]+h[2],16)/255;g.g=parseInt(h[3]+h[4],16)/255;g.b=parseInt(h[5]+h[6],16)/255;return g},lerpColors:function(i,h,g){var j=new e.Color().copy(i).multiplyScalar(1-g);j.add(new e.Color().copy(h).multiplyScalar(g));return j},strToVect:function(g){var h=g.split?g.split(" "):null;if(h){return new e.Vector3(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]))}else{if(g.length===3){return new e.Vector3(g[0],g[1],g[2])}}},vectToStr:function(g){if(g){return !isNaN(g.x)&&!isNaN(g.y)&&!isNaN(g.z)?[g.x,g.y,g.z]:null}},lerpVectors:function(i,h,g){return i.clone().add(h.clone().sub(i).multiplyScalar(g))},strToListVect:function(h){var i=[];for(var g=0;g<h.length;g++){i.push(f.strToVect(h[g]))}return i},listVectToStr:function(h){var i=[];for(var g=0;g<h.length;g++){i.push(f.vectToStr(h[g]))}return i},lerpListVectors:function(k,j,g){var i=[];if(k.length===j.length){for(var h=0;h<k.length;h++){i.push(f.lerpVectors(k[h],j[h],g))}}else{if(g<=0.5){i=k}else{i=j}}return i},strToVect2:function(g){var h=g.split?g.split(" "):null;if(h){return new e.Vector2(parseFloat(h[0]),parseFloat(h[1]))}else{if(g.length===2){return new e.Vector2(g[0],g[1])}}},vect2ToStr:function(g){if(g){return !isNaN(g.x)&&!isNaN(g.y)?[g.x,g.y]:null}},lerpVectors2:function(i,h,g){return i.clone().add(h.clone().sub(i).multiplyScalar(g))},strToListVect2:function(h){var i=[];for(var g=0;g<h.length;g++){i.push(f.strToVect2(h[g]))}return i},listVect2ToStr:function(h){var i=[];for(var g=0;g<h.length;g++){i.push(f.vect2ToStr(h[g]))}return i},lerpListVectors2:function(k,j,g){var i=[];if(k.length===j.length){for(var h=0;h<k.length;h++){i.push(f.lerpVectors2(k[h],j[h],g))}}else{if(g<=0.5){i=k}else{i=j}}return i},strToBool:function(g){if(typeof g==="string"){return g==="true"?true:(g==="false"?false:null)}return g},boolToStr:function(g){return g},strToFloat:function(g){return parseFloat(g)},floatToStr:function(g){return !isNaN(g)?g:null},lerpFloats:function(g,i,h){return g+(i-g)*h},strToInt:function(g){return parseInt(g,10)},intToStr:function(g){return !isNaN(g)?g:null},strToMat4:function(o){var j;if(o.X){var n=f.strToVect(o.X);var l=f.strToVect(o.Y);var h=f.strToVect(o.Z);var g=f.strToVect(o.Origin);j=new e.Matrix4(n.x,l.x,h.x,g.x,n.y,l.y,h.y,g.y,n.z,l.z,h.z,g.z,0,0,0,1)}else{if(o.split){j=new e.Matrix4();var k=o.split(" ");for(var m=0;m<16;m++){j.elements[m]=parseFloat(k[m])}}}return j},mat4ToStr:function(g){var h=g.elements;return{Origin:[h[12],h[13],h[14]],X:[h[0],h[1],h[2]],Y:[h[4],h[5],h[6]],Z:[h[8],h[9],h[10]]}},lerpMat4:function(p,n,o){var j=new e.Matrix4();var l=new e.Quaternion(0,0,0);l.setFromRotationMatrix(p);var m=new e.Quaternion(0,0,0);m.setFromRotationMatrix(n);var i=new e.Quaternion();e.Quaternion.slerp(l,m,i,o);j.setRotationFromQuaternion(i);var g=new e.Vector3();g.getPositionFromMatrix(p);var h=new e.Vector3();h.getPositionFromMatrix(n);var k=f.lerpVectors(g,h,o);j.setPosition(k);return j},strToAABB:function(j){var h=[0,0,0,0,0,0];if(j.split){var k=j.split(",");for(var g=0;(g<k.length)&&(g<6);g++){h[g]=parseFloat(k[g])}}else{h=j}return h},aabbToStr:function(g){return g},strToImageURL:function(i){var g=new Image();var h=i&&i.indexOf('"')===0?JSON.parse(i):i;if(h&&h!==""){g.src=h}return g},imageURLToStr:function(g){return g?g.src:""},strToListFloat:function(k){var g=[];var j=k.split?k.split(" "):null;if(j){for(var h=0;h<j.length;h++){g.push(parseFloat(j[h]))}}else{if(Array.isArray(k)&&k.length){for(var h=0;h<k.length;h++){g.push(parseFloat(k[h]))}}else{return null}}return g},listFloatToStr:function(g){return g&&g.length?g:null},strToListStrings:function(g){var h=g.split?g.split(" "):null;return h?h:g},listStringsToStr:function(g){return g&&g.length?g:null},isEqual:function(h,g){return JSON.stringify(h)===JSON.stringify(g)},getTypeLastElement:function(h){var j=h&&h.pathElement?h.pathElement:h;if(!j){return}if(j.getLastElement&&j.getLastElement(true).getDMUType&&j.getLastElement(true).getDMUType()){return j.getLastElement(true).getDMUType()}else{if(j.getLastElement&&j.getLastElement(true).getDMUType&&!j.getLastElement(true).getDMUType){for(var g=0;g<j.externalPath.length;g++){if(j.externalPath[g].getDMUType){return j.externalPath[g].getDMUType()}}}}},getUrlVariables:function(){var g={};window.location.href.replace(/[?&]+([^=&]+)(=([^&]*))?/gi,function(h,j,i,k){g[j]=(k===undefined?null:k)});return g},getWidgetUrlVariables:function(){var g={};if(window.widget){if(window.widget.uwaUrl){window.widget.uwaUrl.replace(/[?&]+([^=&]+)(=([^&]*))?/gi,function(h,j,i,k){g[j]=(k===undefined?null:k)})}}return g},isEnvActivated:function(i,h){var g=false;if((f.getUrlVariables()[i]!==undefined)||(h&&(c.get(i)!==undefined))){g=true}return g},isPersistenceAllowed:function(){var g=true;var i=b.readLocal("ServerContext");var h=function(j,k){var l=0;if(l+k.length>j.length){return false}else{return j.indexOf(k,l)!==-1}};if(i){if(h(i,"VPLMSecuredCrossAccess")||h(i,"VPLMViewer")){g=false}}return g},checkIfCommandIsRunning:function(h){var i=false;var g=f.getCurrentCommand(h);if(g){i=true}return i},allowManipulation:function(i){var h=d.getContextViewer({reviewContext:d.getReviewContext({viewer:i.viewer})});var g=a.getCommand(a._getCurrent(h.getCommandContext()),h.getCommandContext());return g&&g.allowManipulation?g.allowManipulation(i):undefined},getCurrentCommand:function(i){var h=d.getContextViewer({reviewContext:d.getReviewContext({viewer:i})});var g=a._getCurrent(h.getCommandContext()),j;if(g){j=a._getDefaultCommand(h.getCommandContext())}if(g&&j){g=(g!==j._id?g:null)}return g}};return f});define("DS/DMUBaseExperience/EXPExportServices",["UWA/Class","DS/DMUBaseExperience/EXPUtils"],function(a,b){var c=a.extend({init:function(){var e=this;this.exportData=function(f,g){if(f&&f.exportData){f.exportData(e,g)}};this.writeObjectAttributes=function(l,n){if(l){var h=l._parameters.length;for(var k=0;k<h;k++){var j=l._parameters[k];if(j.JSONname){var f=n,g,o;var m=j.JSONname.split(".");while(true){g=m.shift();if(0===m.length){o=d(l["_"+j.name],j.type);if(o!==null&&o!==undefined&&o!==""&&o!=='""'){f[g]=o}break}else{if(f[g]===undefined){f[g]={}}}f=f[g]}}}}};function d(g,j){var f=null;if(g!==undefined){switch(j){case"object":if(g){var l={};e.exportData(g,l);if(Object.keys(l).length!==0){f=l}}break;case"listObjects":var l=null;if(g){if(g.length>0){l=[];for(var h=0;h<g.length;h++){var k={};e.exportData(g[h],k);l.push(k)}}}f=l;break;default:f=b.typeToStr(g,j)}}return f}}});return c});define("DS/DMUBaseExperience/EXPImportServices",["UWA/Class","DS/DMUBaseExperience/EXPUtils","DS/DMUBaseReview/DMUFactory"],function(b,d,c){var a=b.extend({init:function(f){var h=this;var g=[];this.importDataModel=function(i,j){c.initFactory(f.viewer,function(){if(i&&i.Model&&i.Model.length){for(var k=0;k<i.Model.length;k++){h.importData(i.Model[k])}}j()})};this.importData=function(k,j){var i=null;var l=k!==undefined&&k!==null?k.type:null;if(l!==null&&f.experience){i=c.BuildComponent(l);if(i){i.initComponent({context:j?j:f.experience,appType:f.appType});if(i.importData){i.importData(k,h)}}}return i};function e(n,l,j){switch(l){case"object":return h.importData(n,j);case"listObjects":var m=[];for(var k=0;k<n.length;k++){m.push(h.importData(n[k],j))}return m;default:return d.strToType(n,l)}}this.fillObjectAttributes=function(j,q){if(j&&q){var k=j._parameters.length;for(var l=0;l<k;l++){var p=j._parameters[l];if(p.JSONname){var o=q,n;var m=p.JSONname.split(".");while(o!==null&&o!==undefined&&o!==""){if(0===m.length){j["_"+p.name]=e(o,p.type,j)}n=m.shift();o=o[n]}}}}};this.registerForPostImport=function(i){if(i){g.push(i)}};this.postImport=function(){for(var j=0;j<g.length;j++){if(g[j]&&g[j].afterImport){g[j].afterImport()}}}}});return a});define("DS/DMUBaseExperience/EXPObject",["UWA/Class","DS/Visualization/Node3D","DS/DMUBaseExperience/EXPUtils","DS/DMUBaseExperience/DMUContextManager"],function(a,d,e,c){var b=a.extend({init:function(h,g){this._viewer=h;if(!this._frmWindow){this._frmWindow=g?g._frmWindow:c.getReviewContext({viewer:h})._frmWindow}this._nNode=null;this._expParent=g||null;this._sExpType="EXPObject";this._sID="";this._sName="";this._bReadOnly=false;var f=false;this._parameters=[];var i=this;this.isVisible=function(){return this._nNode?this._nNode.isVisible():false};this.setInEdition=function(j){f=j;i.refreshNode()};this.isInEdition=function(){return f}},initComponent:function(f){this._expParent=f.context||null;if(this._expParent){this._expParent.addChild(this)}this.makeDirty()},remove:function(){if(this._nNode){this._nNode.remove()}if(this._expParent){this.makeDirty();this.removeNodeInParentNode();this._expParent.removeChild(this)}this._nNode=null},defineMembersFromParameters:function(){for(var f=0;f<this._parameters.length;f++){var g=this._parameters[f];if(g.defaultValue!==undefined){this["_"+g.name]=e.cloneType(g.defaultValue,g.type)}}},getAttribute:function(f){if(f!==undefined&&this["_"+f]!==undefined){return this["_"+f]}},setAttribute:function(f,g){if(f&&this.hasAttribute(f)){this["_"+f]=g;this.makeDirty()}},setAttributes:function(g){if(g.length){for(var f=0;f<g.length;f++){this.setAttribute(g[f].name,g[f].value)}}},hasAttribute:function(f){for(var g=0;g<this._parameters.length;g++){if(this._parameters[g].name===f){return true}}return false},compareAttributes:function(h){for(var f=0;f<h.length;f++){for(var g=0;g<this._parameters.length;g++){if(this._parameters[g].name===h[f].name&&JSON.stringify(this.getAttribute(h[f].name))!==JSON.stringify(h[f].value)){return false}}}return true},GetType:function(){return this._type},getParent:function(){return this._expParent},computeNewID:function(){return(this._expParent)?this._expParent.computeNewID():this.computeNewID()},readJSON:function(g){this._sID=g.id;this._sName=g.Name;for(var f=0;f<this._parameters.length;f++){var k=this._parameters[f];if(k.JSONname){var j=g;var h=k.JSONname.split(".");while(true){if(0===h.length){this["_"+k.name]=e.strToType(j,k.type)}j=j[h.shift()];if(j===undefined){break}}}}},_createNode:function(){this._nNode=new d();return this._nNode},refreshNode:function(){},addNodeInParentNode:function(){if(this._expParent&&this._expParent._nNode){this._expParent._nNode.add(this._nNode)}for(var f=0;f<this._nNode.children.length;f++){this._nNode.children[f].setVisibilityInTree(false)}},removeNodeInParentNode:function(){if(this._expParent&&this._expParent._nNode){this._expParent._nNode.remove(this._nNode)}},set:function(f){if(f){var h=0;var k=this;var j=function(n){var l=0;if(n){if(Array.isArray(n.attribute)){for(var m=0;m<n.attribute.length;m++){if((n.mode===undefined)||(n.mode[m]===null)||(n.mode[m]==="modifyValue")){k["_"+n.attribute[m]]=n.value[m];l=1}else{if(n.mode[m]==="addValue"){k["_"+n.attribute[m]].push(n.value[m]);l=1}}}}else{if((n.mode===undefined)||(n.mode===null)||(n.mode==="modifyValue")){k["_"+n.attribute]=n.value;l=1}else{if(n.mode==="addValue"){k["_"+n.attribute].push(n.value);l=1}}}}return l};if(Array.isArray(f)){for(var g=0;g<f.length;g++){h=j(f[g])}}else{h=j(f)}if(h&&f.makeDirty!==false){this.makeDirty()}}},makeDirty:function(){var f=c.getReviewContext({viewer:this._viewer});if(f){f.makeDirty()}},setReadOnly:function(f){this._bReadOnly=f},isReadOnly:function(){var f=this._bReadOnly;var g=this._expParent;if(!f&&g){f=g.isReadOnly()}return f}});return b});define("DS/DMUBaseExperience/EXPCollection",["DS/DMUBaseExperience/EXPObject"],function(a){var b=a.extend({init:function(d,c){this._parent(d,c);this._sExpType="EXPCollection";this._children=[]},remove:function(){for(var c=this._children.length-1;c>=0;c--){if(this._children[c].remove){this._children[c].remove()}this.removeChild(this._children[c])}this._parent()},getChildren:function(e,d){var f=[];d=((d===undefined)?true:d);if(e===undefined){f=this._children}else{for(var c=0;c<this._children.length;c++){if(this._children[c]._sExpType===e){f.push(this._children[c])}if(d&&this._children[c].getChildren){f=f.concat(this._children[c].getChildren(e))}}}return f},getChildWithID:function(c,e){var f=null;e=((e===undefined)?true:e);for(var d=0;d<this._children.length;d++){if(this._children[d]._sID===c){f=this._children[d];break}if(e&&this._children[d].getChildWithID){f=this._children[d].getChildWithID(c,e);if(f){break}}}return f},addChild:function(c){this._children.push(c)},removeChild:function(d){var c=this._children.indexOf(d);if(c>=0){this._children.splice(c,1)}},refreshNode:function(){for(var c=0;c<this._children.length;c++){if(this._children[c].refreshNode){this._children[c].refreshNode()}}return this._nNode},GetType:function(){return"EXPCollection"}});return b});