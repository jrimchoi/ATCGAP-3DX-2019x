define("DS/CfgVariantEffectivityDialog/scripts/CfgVariantSkeletonModel",["UWA/Core","UWA/Class/Model"],function(b,a){return a.extend({defaults:function(){return{title:"",subtitle:"",content:"",image:"",icon:"",color:"",url:"",idModel:"",jsonAttr:"",evoExp:""}}})});define("DS/CfgVariantEffectivityDialog/scripts/CfgVariantSkeletonCollection",["UWA/Class/Collection","DS/WebappsUtils/WebappsUtils","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgVariantEffectivityDialog/scripts/CfgVariantSkeletonModel","i18n!DS/CfgVariantEffectivityDialog/assets/nls/CfgVariantEffectivityDialog"],function(d,f,b,a,e,c){var g=function(h){this.options=h;cfgEditVarThat=this;return d.extend({model:e,url:f.getWebappsAssetUrl("CfgVariantEffectivityDialog","projects.json"),init:function(){this._parent(cfgEditVarThat.options)},setup:function(){if(cfgEditVarThat.options.hasEffectivity==false){console.log("Has No Effectivity, Models would be initilized to default values with Model Name and Empty Combinations")}else{cfgEditVarThat.options.finalJson=a.VariantXMLToJSONConverter(cfgEditVarThat.options.varEffXML);cfgEditVarThat.options.descJson=a.VariantDescXMLtoJSONConverter(cfgEditVarThat.options.varEffXML)}if(cfgEditVarThat.options.evoEffXML){cfgEditVarThat.options.evoExpJson=a.EvolutionXMLtoJSONforFilterVariant(cfgEditVarThat.options.evoEffXML)}},getEvoExpVal:function(l){if(Array.isArray(l)){l=l[0]}var k="";if(cfgEditVarThat.options.evoEffXML){for(var j=0;j<cfgEditVarThat.options.evoExpJson.contextsFilterXML.length;j++){if(cfgEditVarThat.options.evoExpJson.contextsFilterXML[j].name==l){k=cfgEditVarThat.options.evoExpJson.contextsFilterXML[j].expression;break}}}return k},getJsonAttrValue:function(n,m){if(Array.isArray(n)){n=n[0]}if(Array.isArray(m)){m=m[0]}var j={name:n,displayValue:m,Combinations:[]};if(cfgEditVarThat.options.hasEffectivity==true){for(var l=0;l<cfgEditVarThat.options.finalJson.length;l++){var k=JSON.parse(cfgEditVarThat.options.finalJson[l]);k.displayValue=m;if(k.name==n){if(k.Combinations.length>0){k=b.fillVariantDictionaryWithDisplayName(k,cfgEditVarThat.options.descJson);j=k}break}}}return j},parse:function(t){if(Array.isArray(t)){var k=cfgEditVarThat.options.contextData;var p=enoviaServerFilterWidget.baseURL;var y="";var z="";if(p!=null&&p!="undefined"&&p!=""){y=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png";z=enoviaServerFilterWidget.baseURL+"/common/images/iconSmallModel.png"}for(var u=0;u<=k.length-1;u++){var o=k[u];var v=o.physicalID;if(o.preview_url!=null&&o.preview_url!="undefined"&&o.preview_url!=""){y=o.preview_url}var n=b.getAttributeValue(o.data,"Marketing Name");var w=b.getAttributeValue(o.basicData,"name");var x=c.Maturity+":"+b.getAttributeValue(o.basicData,"current");var j=c.Owner+":"+b.getAttributeValue(o.basicData,"owner");var q="<span style='color:#77797c'>"+x+"</span><br><span style='color:#77797c'>"+j+"</span>";var m=this.getJsonAttrValue(w,n);var s=this.getEvoExpVal(w);var r='{ "id": "'+u+'", "title": "'+n+'", "subtitle": "'+w+'", "content": "'+q+'","image": "'+y+'", "icon": "'+z+'", "color": "", "url": "", "idModel": "'+v+'" ,"jsonAttr":""}';var l=JSON.parse(r);l.jsonAttr=JSON.stringify(m);l.evoExp=s;t.push(l)}}return t}})};return g});define("DS/CfgVariantEffectivityDialog/scripts/CfgVariantDialogSkeleton",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","WebappsUtils/WebappsUtils","DS/W3DXComponents/Skeleton","DS/CfgVariantEffectivity/scripts/CfgVariantInit","DS/CfgVariantEffectivityDialog/scripts/CfgVariantSkeletonCollection"],function(g,e,h,b,f,c,a,d){var i=function(l){var k=new d(l);var j={bones:null,height:"300",unMaximizedHeight:null,onLoad:function(){if(j.bones){j.bones.destroy()}var n={useInfiniteScroll:false,usePullToRefresh:false};var o={contents:{useInfiniteScroll:false,usePullToRefresh:false,}};var m=g.Class.View;j.bones=new c({models:{collection:k,view:null,viewOptions:o,idCardOptions:{facets:function(){return[{text:"Model",icon:"plus-circled",handler:c.getRendererHandler("ModelsHandeler")}]}}},ModelsHandeler:{view:m.extend({name:"models-view",tagName:"div",className:"generic-detail",render:function(){return this},setup:function(){var p=this;setTimeout(function(){a.InitModelOnUI(p.container,p.model,j.bones.getCollectionAt(0))},100)}})}},{root:"projects",useRootChannelView:widget.getValue("view")==="channel",responsiveTrigger:function(){var p=widget.getView().type;if(widget.getValue("view")==="channel"){return p==="maximized"||p==="fullscreen"}else{return false}},startRoute:"/models/0/ModelsHandeler/",events:{onItemSelect:function(p){},onSlide:function(p,q){},onRouteChange:function(p){console.log("In route: "+p)}}});j.bones.render().inject(l.parent)},onViewChange:function(m){if((m.type!=="fullscreen")&&(m.type!=="maximized")){if(g.is(j.unMaximizedHeight)){j.bones.setHeight(j.unMaximizedHeight);j.unMaximizedHeight=null}}else{if(g.is(m.height)){j.unMaximizedHeight=j.bones.container.clientHeight;j.bones.setHeight(m.height)}}},};j.onLoad()};return i});define("DS/CfgVariantEffectivityDialog/scripts/CfgVariantInitDialog",["DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgVariantEffectivity/scripts/CfgVariantExpServices","DS/CfgVariantEffectivityDialog/scripts/CfgVariantDialogSkeleton","i18n!DS/CfgVariantEffectivityDialog/assets/nls/CfgVariantEffectivityDialog","css!DS/CfgVariantEffectivityDialog/assets/styles/CfgVariantEffectivityDialog.css"],function(f,g,a,e,d,c){var b={cancelDialog:function(){b.cfgVarDialog.closeDialog();console.log("cfgVarDialog closed")},setVariantEffectivity:function(){var h=e.GetGlobalXMLExpression();console.log("Variant XMLExpression : "+h);var i=function(m){console.log(m);for(var o in m.expressions){if(m.expressions.hasOwnProperty(o)){if(m.expressions[o].content!=undefined&&m.expressions[o].content.Variant!=undefined){var n=m.expressions[o].content.Variant;m.expressions[o].content.displayExpression=a.getDisplayExpressionUsingXSLT(n)}}}if(b.varOptions.postOKHandler){b.varOptions.postOKHandler(m)}if(b.varOptions.PADContext){b.varOptions.PADContext.get().getPADTreeDocument().withTransactionUpdate(function(){a.refreshEffectvity(b.varOptions.selectedNodes,"Variant","All")})}b.cfgVarDialog.closeDialog();if((m.expressions!==undefined&&m.expressions[b.varOptions.instanceID].status.toUpperCase()==="SUCCESS"&&m.expressions[b.varOptions.instanceID].hasEffectivity.toUpperCase()!=="ERROR")||(m.unset!==undefined&&(m.unset.Variant.status.toUpperCase()==="SUCCESS"||m.unset.Variant.status.toUpperCase()==="WARNING"))){a.showwarning(c.Save_Successful_Var_Effectivity,"success")}else{a.showwarning(c.Save_Fail_Var_Effectivity,"error")}};var k=function(m){console.log(m);b.cfgVarDialog.closeDialog();a.showwarning(c.Save_Fail_Var_Effectivity,"error")};var l=null;if(b.varOptions.ca.headers.length>0){l={operationheader:{key:b.varOptions.ca.headers[0].key,value:b.varOptions.ca.headers[0].value}}}var j;if(h==""){j={wsOptions:l,instanceID:b.varOptions.instanceID,domain:"Variant"};a.unsetEffectivity(j).then(function(m){i(m)},function(m){k(m)})}else{j={version:"1.1",domain:"Variant",view:"All",expressionList:[{pid:b.varOptions.instanceID,expressions:[{domain:"Variant",content:h}]}],wsOptions:l};a.setMultipleFilterableObjectInfo(j).then(function(m){i(m)},function(m){k(m)})}},init:function(i){f.clear();this.varOptions=i;var j=this;if(this.varOptions.mode=="Dashboard"){this.varOptions.dialogue.buttonArray=[{label:c.Edit_Var_OK,handler:j.setVariantEffectivity,className:"primary"},{label:c.Edit_Var_Cancel,handler:j.cancelDialog,className:"default"}];this.cfgVarDialog=new g(this.varOptions);this.cfgVarDialog.render();this.varOptions.parent=this.cfgVarDialog.container;this.varOptions.parentElement=this.cfgVarDialog.container;var h=new d(this.varOptions)}}};return b});