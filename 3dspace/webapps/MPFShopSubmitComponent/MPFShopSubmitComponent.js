define("DS/MPFShopSubmitComponent/ShopSubmitComponent",["UWA/Class/View","DS/UIKIT/Input/Button","DS/UIKIT/Modal","DS/MPFShopModel/ShopModel","DS/MPFShopModel/ShopServiceModel","DS/MPFShopModel/ShopSubmitor","DS/MPFServices/ObjectService","i18n!DS/MPFShopSubmitComponent/assets/nls/ShopSubmitComponent"],function(b,c,a,i,e,g,h,d){var f;f=b.extend({className:"mpf-shop-submit",setup:function(j){h.requiredOfPrototype(j.shop,i,"options.shop must be a ShopModel");h.requiredOfPrototype(j.shopService,e,"options.shopService must be a ShopServiceModel");this.shop=j.shop;this.shopService=j.shopService;this.confirmationModal=this._createConfirmationModal();this.submitLabButton=this._createSubmitLabButton()},render:function(){var j;if(this._canShopBeSumitted()){j=[this.confirmationModal,this.submitLabButton]}this.container.setContent(j);return this},_canShopBeSumitted:function(){var j;var k;var l;j=!this.shop.isInternal();k=this.shop.getState()===i.States.DRAFT;l=this.shopService.getState()===e.States.DRAFT;return j&&k&&l},destroy:function(){this._parent()},_createConfirmationModal:function(){var j;var l;var k;l=new c({className:"warning",value:d.get("submitShop")});k=new c({value:d.get("cancel")});j=new a({closable:true,header:"<h4>"+d.get("confirmShopSubmit")+"</h4>",body:"<p>"+d.get("confirmShopSubmitMessage")+"</p>",footer:[l,k]});l.addEvent("onClick",this._onSubmit.bind(this));k.addEvent("onClick",j.hide.bind(j));return j},_createSubmitLabButton:function(){return new c({className:"warning",icon:"attention",value:d.get("submitShop"),events:{onClick:this._showConfirmationModal.bind(this)}})},_showConfirmationModal:function(){return this.confirmationModal.show()},_hideConfirmationModal:function(){return this.confirmationModal.hide()},_onSubmit:function(){return g.submit(this.shop,this.shopService).then(this._hideConfirmationModal.bind(this))["catch"](function(j){console.log(j)})},_setModificationRequestStatusToShopService:function(){var j={};j[e.Fields.MODIFICATION_REQUEST_STATUS]=e.RequestStatus.TO_BE_VALIDATED;return this.shopService.savePromise(j,{patch:true})},_setShopSubmitted:function(){this.shop.setState(i.States.SUBMITTED);return this.shop.savePromise()},_setShopServiceSubmitted:function(){var j={};j[e.Fields.STATE]=e.States.SUBMITTED;return this.shopService.savePromise(j,{patch:true})}});return f});