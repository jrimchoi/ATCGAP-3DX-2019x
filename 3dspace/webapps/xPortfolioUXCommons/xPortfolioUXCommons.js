define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel",["UWA/Class/Model"],function(b){var a=b.extend({init:function(c){var f={};if(c.hasOwnProperty("id")){f=c}else{if(c.hasOwnProperty("@id")){f={id:c["@id"],};for(var d in c){if(c.hasOwnProperty(d)){var e=c[d];f[d]=e}}}}Array.prototype.splice.call(arguments,0,1,f);return this._parent.apply(this,arguments)}});return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewCollectionToolBar",["DS/ENOXCollectionToolBar/js/ENOXCollectionToolBar","i18n!DS/xPortfolioUXCommons/assets/nls/XModelListView","css!xPortfolioUXCommons/XModelListView/css/XModelListView.css"],function(c,b){var a=function(e,d,j){this._initMaps();this._model=e;this._opts={};this._opts.views=[];if(d.viewOptions){if(d.viewOptions.views){for(var f=0;f<d.viewOptions.views.length;f+=1){this._opts.views.push({id:d.viewOptions.views[f],text:this._localMap_text[d.viewOptions.views[f]],fonticon:this._localMap_fonticon[d.viewOptions.views[f]]})}}this._opts.currentView=d.viewOptions.currentView?d.viewOptions.currentView:d.viewOptions.views[0]}this._opts.currentSort=d.viewOptions.currentSort?d.viewOptions.currentSort:undefined;this._opts.sort=[];var f=0;var g=[];this._selectedGroupItem=null;for(f=0;f<d.viewOptions.grid.columns.length;f+=1){if(d.viewOptions.grid.columns[f].text!==""){this._opts.sort.push({id:d.viewOptions.grid.columns[f].dataIndex,text:d.viewOptions.grid.columns[f].text,type:(d.viewOptions.grid.columns[f].typeRepresentation==="number")?"integer":"string"});if(d.viewOptions.grid.columns[f].groupableFlag==true){g.push({id:d.viewOptions.grid.columns[f].dataIndex,text:d.viewOptions.grid.columns[f].text,selectable:true,isSelected:false,handler:function(){console.log();var k=this.getSelectedItems();var i=false;var l="";if(k.length==1&&k[0].isSelected){i=true;l=k[0].id}this.items.forEach(function(m){if(m.id!=l){m.isSelected=false}});if(!i&&this.options.target.hasClassName("selected")){this.options.target.removeClassName("selected")}else{this.options.target.addClassName("selected")}}})}}}this._opts.modelEvents=j;this._opts.withmultisel=d.withmultisel?d.withmultisel:false;this._opts.showItemCount=d.showItemCount==false?d.showItemCount:true;this._opts.filter={enableCache:true};this._opts.itemsName=d.toolbarOptions.itemsName;this._opts.itemName=d.toolbarOptions.itemName;this._opts.actions=this._getToolbarActions(d.toolbarOptions.actions);var h=this;if(UWA.is(this._opts.actions,"array")){if(g.length>0){this._opts.actions.push({id:"groupByAction",className:"group-by-action",title:b._groupByAction,text:b._groupByAction,fonticon:"horizontal-line",content:g,handler:function(k,l){var i=[];if(l.id){if(l.isSelected){l.elements.container.removeClassName("selected");l.isSelected=false}else{if(!l.elements.container.hasClassName("selected")){l.elements.container.addClassName("selected")}l.isSelected=true;h._selectedGroupItem=l;i.push(l.id)}}h._opts.modelEvents.publish({event:"xmodel-list-view-group-by-action",data:i})}})}}this._collectionToolBar=new c(this._opts);this._subscribeEvents();this._initSort()};a.prototype._subscribeEvents=function(){var d=this;this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-add-selection"},function(){d._multiselectActions.forEach(function(e){d._opts.modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:e})})});this._opts.modelEvents.subscribe({event:"xmodel-list-item-on-empty-selection"},function(){d._multiselectActions.forEach(function(e){d._opts.modelEvents.publish({event:"enox-collection-toolbar-disable-action",data:e})})});this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(f){var e=f.searchValue[0]||"";d._opts.modelEvents.publish({event:"xmodel-list-context-search-action",data:e})});this._opts.modelEvents.subscribe({event:"xmodel-list-toolbar-group-visibility"},function(e){var f=d._collectionToolBar._container.querySelector(".group-by-action");if(f){if(e){f.removeClassName("displaynone");f.removeClassName("selected");if(d._selectedGroupItem){d._selectedGroupItem.isSelected=false;d._selectedGroupItem.elements.container.removeClassName("selected");d._selectedGroupItem=null}}else{f.addClassName("displaynone")}}})};a.prototype._initMaps=function(){this._localMap_text={};this._localMap_text.DataGridView=b._dataGridView;this._localMap_text.TileView=b._tileView;this._localMap_text.ThumbnailView=b._thumbnailView;this._localMap_text.LargeThumbnailView=b._largeTileView;this._localMap_fonticon={};this._localMap_fonticon.DataGridView="view-list";this._localMap_fonticon.TileView="view-small-tile";this._localMap_fonticon.ThumbnailView="view-big-thb";this._localMap_fonticon.LargeThumbnailView="view-big-tile"};a.prototype._getToolbarActions=function(f){var d=[];this._multiselectActions=[];var e=this;f.forEach(function(g){var i=function(j,m){var k=[];if(g.allowSelectRetain){k.push(m.selected)}else{if(g.enableOnSelection){var l=[];e._model.getSelectedNodes().forEach(function(n){l.push(n.options)});k.push(l);k.push(e._model.getSelectedNodes())}}g.handler.apply(e._model,k)};var h={handler:i};if(g.enableOnSelection){h.disabled=true;e._multiselectActions.push(g.id)}UWA.merge(h,g);d.push(h)});return d};a.prototype.inject=function(d){this._collectionToolBar.inject(d)};a.prototype.attachResizeSensor=function(){this._collectionToolBar.attachResizeSensor()};a.prototype._initSort=function(){var d=this;this._opts.modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(e){if(e&&e.sortAttribute&&e.sortOrder){console.log("sorting tree on "+e.sortAttribute+" "+e.sortOrder);console.log(d);var f={dataIndex:e.sortAttribute,sort:e.sortOrder.toLowerCase(),id:e.sortAttribute,order:e.sortOrder.toLowerCase()};d._collectionToolBar._activateCurrentSort(f);d._opts.modelEvents.publish({event:"xmodel-list-data-sort-action",data:f})}})};return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension",["UWA/Class","DS/Tree/TreeNodeModel","DS/WildcardSearchComponent/WildcardSearchComponent","DS/PlatformAPI/PlatformAPI","DS/TreeModel/DataModelSet",],function(b,f,c,a,d){var e=b.extend({_id:"data-extention",initialize:function(g){this._viewId=g.id;this._model=g.model;this._dataFilters={};this._searchFilters={};this._FILTER_ATTRIBUTES=["id","name","title","description","type","revision","responsible","owner","creator","maturity","state"];this._modelEvents=g.modelEvents;this._dataModelSet=g.model.options.dataModelSet||new d();this._filterData={};this._searchFilter={};this._wildCardSearchComponent=new c();this._isFilterDataUpdating;this._filterNodeLevel=0;this.subscribeEvents()},subscribeEvents:function(){var g=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){});this._modelEvents.subscribe({event:"xmodel-list-data-load-action"},function(h){g._loadData(h,this)});this._modelEvents.subscribe({event:"xmodel-list-data-item-add-action"},function(i){var h=g._addDataItem(i,this);g._modelEvents.publish({event:"xmodel-list-item-on-unselect-all"});g._modelEvents.publish({event:"xmodel-list-data-item-on-add-complete",data:h,context:h})});this._modelEvents.subscribe({event:"xmodel-list-data-item-remove-action"},function(h){g._removeDataItem(h)});this._modelEvents.subscribe({event:"xmodel-list-data-item-update-action"},function(h){g._updateDataItem(h,h.context)});this._modelEvents.subscribe({event:"xmodel-list-data-filter-action"},function(h){g.filter(h)});this._modelEvents.subscribe({event:"xmodel-list-data-search-action"},function(h){g._wildCardSearch(h)});this._modelEvents.subscribe({event:"xmodel-list-data-set-filter-node-level"},function(h){if(UWA.is(h,"number")){g._filterNodeLevel=h}});this._modelEvents.subscribe({event:"xmodel-list-get-filtered-data"},function(h){g._getFilteredData().then(function(){if(UWA.is(h,"function")){h(g._filterData)}})});this._model.subscribe({event:"matchSearch"},function(h){h.data.nodeModel.show()});this._model.subscribe({event:"unmatchSearch"},function(h){h.data.nodeModel.hide()});a.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(i){var h=i?(i.data?(i.data.authored?(i.data.authored.modified?i.data.authored.modified:[]):[]):[]):[];h.forEach(function(j,k){if(j){g._model.search({shouldStop:function(l){if(l.options.id===j){g._modelEvents.publish({event:"xmodel-list-data-item-need-refresh",data:j,context:l});return true}return false}})}})})},_loadData:function(j,h){var i=this;var g=i._model;if(h&&UWA.is(h,"object")){g=h}g.prepareUpdate();if(g.removeRoots){g.ungroupRoots();g.removeRoots()}if(g.removeChildren){g.removeChildren()}i._modelEvents.publish({event:"xmodel-list-reset-sort-model",data:{}});if(j&&j.member){this._isFilterDataUpdating=false;j.member.forEach(function(n,m){var l=i._getNodeOptions(n,m);var k=f.createTreeNodeDataModel(i._dataModelSet,l);g.addChild(k)});i._modelEvents.publish({event:"xmodel-list-view-update-grouping-action",data:g})}g.pushUpdate();this._updateFilterData()},_removeDataItem:function(j,i){var g=this._model;if(i&&UWA.is(i,"object")){g=i}this._isFilterDataUpdating=false;g.prepareUpdate();if(!UWA.is(j,"array")){j=[j]}var h=g.search({match:function(k){if(j.indexOf(k.nodeModel.options.id)!=-1){return true}return false}});if(h){h.forEach(function(k){k.remove()})}g.pushUpdate();this._updateFilterData()},_updateDataItem:function(g,h){if(!(h||UWA.is(h,"object"))){var i=g.id?g.id:g["@id"];if(i){this._model.search({shouldStop:function(j){if(i==j.options.id){h=j;return true}return false}})}}if(h){h.prepareUpdate();h.updateOptions(this._getNodeOptions(g));h.pushUpdate()}return h},_addDataItem:function(j,k){var g=this._model;if(k&&UWA.is(k,"object")){g=k}this._isFilterDataUpdating=false;g.prepareUpdate();var i=g.getChildren()?g.getChildren().length:0;var h=f.createTreeNodeDataModel(this._dataModelSet,this._getNodeOptions(j,i));g.addChild(h);g.pushUpdate();this._updateFilterData();return h},_getNodeOptions:function(h,g){h.id=h.id?h.id:h["@id"];var i=h;var j={id:h.id?h.id:h["@id"],label:(h.title),description:h.description,subLabel:"",grid:i,icons:h.image?[h.image]:h.thumbnail?[h.thumbnail]:[],thumbnail:h.image?h.image:h.thumbnail?h.thumbnail:"",color:""};return j},filter:function(h){var m=[];if(h.id){var l=this;this._dataFilters[h.id]=h.content||{};this._model.prepareUpdate();var k;for(var g in l._dataFilters){if(l._dataFilters.hasOwnProperty(g)){var j=l._dataFilters[g];if(j.ids){if(!k){k=j.ids.filter(function(n){return l._filterData.hasOwnProperty(n)})}else{k=k.filter(function(n){return j.ids.indexOf(n)!=-1&&l._filterData.hasOwnProperty(n)})}}}}if(!k){k=[]}else{}var i=this._model.search({match:function(n){if(k.indexOf(n.nodeModel.options.id)!=-1){n.nodeModel.matchSearch();m.push(n.nodeModel.options.id);return true}n.nodeModel.unmatchSearch();return false},shouldStop:function(n){return n.getNodeDepth()>l._filterNodeLevel}});this._model.pushUpdate();this._modelEvents.publish({event:"xmodel-list-data-on-update"})}return m},_updateFilterData:function(){var g=this;g._filterData={};return new UWA.Promise(function(i,h){try{g._model.getChildren().forEach(function(k){g._filterData[k.options.id]=g._FILTER_ATTRIBUTES.reduce(function(m,l){if(!m){m={}}m[l]=k.options.grid.hasOwnProperty(l)?k.options.grid[l]:"";return m},{})});i()}catch(j){g._filterData={};h()}g._modelEvents.publish({event:"xmodel-list-filter-data-update-complete"});g._isFilterDataUpdating=false})},_getFilteredData:function(){var g=this;return new UWA.Promise(function(i,h){if(g._isFilterDataUpdating==false){return i()}else{g._modelEvents.subscribeOnce({event:"xmodel-list-filter-data-update-complete"},function(){i()});if(!g._isFilterDataUpdating){g._updateFilterData()}}})},_wildCardSearch:function(g){var i=this;if(g.id){this._searchFilters[g.id]=g.content||{};var h=g.content;this._getFilteredData().then(function(){var j=Object.keys(i._filterData).map(function(l){return i._filterData[l]});var k=h.value||"";i._wildCardSearchComponent.search(h.value,j,function(m){var n=[];if(m){n=m.map(function(o){return o.id})}var l=i.filter({id:g.id,content:{ids:n}});i._modelEvents.publish({event:"xmodel-list-data-on-search-complete",data:l})},["id"])})}},destroy:function(){}});return e});define("DS/xPortfolioUXCommons/XModelListView/js/ContextualMenuTweaker",["DS/Tweakers/TweakerBase","DS/Utilities/Utils","DS/Controls/Button","DS/Menu/ContextualMenu","DS/Menu/Menu",],function(h,g,c,d,f){var e=h.inherit({name:"contextualMenu",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:{iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS},type:"string"},displayStyle:{defaultValue:"menuIcon",type:"string",category:"Appearance"}},});var b=function(j,i){h.prototype.baseViewModule.call(this,j,i)};g.applyMixin(b,h.prototype.baseViewModule);var a=function(j,i){b.call(this,j,i)};g.applyMixin(a,b);a.prototype.buildView=function(){if(!this._tweaker.elements.container){return}var i=UWA.merge({},this._options.viewOptions);i.touchMode=this._tweaker._getCurrentTouchMode();i.displayStyle="lite";i.icon=this._tweaker.icon;i.allowUnsafeHTMLLabel=false;if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){if(this._tweaker.value.menu.length==1){i.icon={iconName:this._tweaker.value.menu[0].fonticon.content,fontIconFamily:WUXManagedFontIcons.Font3DS}}}this._view=new c(i);this.setValue(this._tweaker.value)};a.prototype.handleEvents=function(){var k=this;var i=this._view;var j=this._tweaker.context;if(j){j.nodeModel.addEventListener("pushUpdate",function(){if(this.options.disableMenu!=undefined&&this.options.disableMenu!=k._tweaker.value.disabled){k._tweaker.value.disabled=this.options.disableMenu;k.setValue()}})}if(i){i.addEventListener("buttonclick",function(m){if(k._tweaker.value&&!(k._tweaker.value.disabled==true||(k._tweaker.value.menu&&k._tweaker.value.menu.length==1&&k._tweaker.value.menu[0]&&k._tweaker.value.menu&&k._tweaker.value.menu[0].state=="disabled"))){var n=k._tweaker.value.menu;if(n){if(n.length==1){n[0].action.callback(m)}else{var l=i.getContent().getBoundingClientRect();f.show(n,{position:{x:l.left,y:l.top+l.height}})}}}})}};a.prototype.setValue=function(){if(!this._view){return}this._view.icon=this.getMenuIcon();if(typeof this._tweaker.value==="undefined"||this._tweaker.value===null){this._view.value="undefined"}else{this._view.value=this._tweaker.value;if(this._tweaker.value&&(this._tweaker.value.disabled==true||(this._tweaker.value.menu&&this._tweaker.value.menu.length==1&&this._tweaker.value.menu[0]&&this._tweaker.value.menu&&this._tweaker.value.menu[0].state=="disabled"))){this._view.getContent().setAttribute("disabled",true)}else{this._view.getContent().removeAttribute("disabled")}if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){this._view.show()}else{this._view.hide()}}};a.prototype.getMenuIcon=function(){var i={iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS};if(this._tweaker.value&&this._tweaker.value.menu&&this._tweaker.value.menu.length>0){if(this._tweaker.value.menu.length==1){i={iconName:this._tweaker.value.menu[0].fonticon.content,fontIconFamily:WUXManagedFontIcons.Font3DS}}}return i};a.prototype.removeEvents=function(){if(!this._view){return}this._view.removeEventListener("buttonclick")};a.prototype._updateView=function(){this.setValue()};e.prototype.baseViewModule=b;e.prototype.VIEW_MODULES={menuIcon:{classObject:a,options:{viewOptions:{}}},readOnly:{classObject:a,options:{viewOptions:{displayStyle:"menuIcon"}}}};return e});define("DS/xPortfolioUXCommons/util/ScrollUtil",[],function(){var a={PIXEL_STEP:10,LINE_HEIGHT:40,PAGE_HEIGHT:800,maxWheelDelta:function(b){return{y:10,x:10}},normalizeWheel:function(d){var f=0,e=0,c=0,b=0;if("detail" in d){e=d.detail}if("wheelDelta" in d){e=-d.wheelDelta/120}if("wheelDeltaY" in d){e=-d.wheelDeltaY/120}if("wheelDeltaX" in d){f=-d.wheelDeltaX/120}if("axis" in d&&d.axis===d.HORIZONTAL_AXIS){f=e;e=0}c=f*this.PIXEL_STEP;b=e*this.PIXEL_STEP;if("deltaY" in d){b=d.deltaY}if("deltaX" in d){c=d.deltaX}if((c||b)&&d.deltaMode){if(d.deltaMode===1){c*=this.LINE_HEIGHT;b*=this.LINE_HEIGHT}else{c*=this.PAGE_HEIGHT;b*=this.PAGE_HEIGHT}}if(c&&!f){f=(c<1)?-1:1}if(b&&!e){e=(b<1)?-1:1}return{spinX:f,spinY:e,pixelX:c,pixelY:b}}};return a});define("DS/xPortfolioUXCommons/NotificationsUtil/xNotificationsUtil",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(d,b,c){var e=false;var a=d.singleton({_notificationsMgr:{},_defaultLevel:"info",_appendAppNameToMsg:false,_appNameStr:"",_msgLevels:{INFO:"info",WARNING:"warning",ERROR:"error",SUCCESS:"success"},init:function(f){if(e){console.log("nothing!!!")}if(f&&f.appName&&f.appName!=""){_appNameStr=f.appName}this._notificationsMgr=b;c.setNotificationManager(this._notificationsMgr)},showMessage:function(f){if(f&&f.message){this._notificationsMgr.addNotif({level:f.level?f.level:this._defaultLevel,message:this._appendAppNameToMsg?(this._appNameStr+f.message):f.message,sticky:f.isSticky?f.isSticky:false})}},showError:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.ERROR,message:f})}},showInfo:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.INFO,message:f})}},showSuccess:function(f){if(f&&f!=""){this.showMessage({level:this._msgLevels.SUCCESS,message:f})}}});a.init();return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension",["UWA/Class","DS/TaggerOnIndexComponent/TaggerOnIndexComponent"],function(a,b){var c=a.extend({_id:"tagger-extention",initialize:function(d){this._taggerId=d.id;this._model=d.model;this._modelEvents=d.modelEvents;this._friendTags=[];this.subscribeEvents();this._taggerComponent=b},subscribeEvents:function(){var d=this;this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){d._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(e){d._setupTagger(e?Object.keys(e):[])}})});this._modelEvents.subscribe({event:"xmodel-list-tagger-activate-action"},function(){d._activateTagger()});this._modelEvents.subscribe({event:"xmodel-list-tagger-deactivate-action"},function(){d._deactivateTagger()});this._modelEvents.subscribe({event:"xmodel-list-tagger-update-friend-tags-action"},function(e){if(UWA.is(e,"array")){d._friendTags=e}});this._modelEvents.subscribe({event:"xmodel-list-data-on-search-complete"},function(e){d._filterTagger(e)});this._modelEvents.subscribe({event:"xmodel-list-tagger-init-action"},function(e){d._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(f){d._setupTagger(f?Object.keys(f):[])}})})},_setupTagger:function(f){console.log("set up tagger");var e=this;var d={MyFriends:e._friendTags,onSetTagProxy:function(){e._modelEvents.publish({event:"xmodel-list-tagger-on-setup"})},onTagFilterChange:function(){console.log();var h=e._taggerComponent.getTagProxy(e._taggerId).getCurrentFilter();var i=h.filteredSubjectList;if(i&&i.length>0){var j={id:"taggerFilter",content:{ids:i}};e._modelEvents.publish({event:"xmodel-list-data-filter-action",data:j})}},onTagColor:function(h){console.log();e._setDataColor(h.coloredSubjects)},onTagUncolor:function(){console.log();e._unsetDataColor()},colorize:true};var g=f||[];this._taggerComponent.setTagProxy(this._taggerId,d,g)},_getDataIds:function(){var e=[];var d=this._model.getChildren();if(d){d.forEach(function(f){var g=f.options.id||f._id;e.push(g)})}return e},_setDataColor:function(d){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:true}});this._model.search({match:function(e){if(d.hasOwnProperty(e.nodeModel.options.id)){e.nodeModel.prepareUpdate();e.nodeModel.updateOptions({color:d[e.nodeModel.options.id]});e.nodeModel.setAttribute("color",d[e.nodeModel.options.id]);e.nodeModel.pushUpdate();return true}return false}})},_unsetDataColor:function(){this._modelEvents.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:false}});this._model.prepareUpdate();this._model.search({match:function(d){if(d.nodeModel.options.id){d.nodeModel.updateOptions({color:""});d.nodeModel.setAttribute("color","#ffffff00");return true}return false}});this._model.pushUpdate()},_filterTagger:function(d){if(this._taggerComponent.getTagProxy(this._taggerId)){this._taggerComponent.filterTags(this._taggerId,d)}},_activateTagger:function(){if(this._taggerComponent.getTagProxy(this._taggerId)){this._taggerComponent.activate(this._taggerId)}else{this._modelEvents.publish({event:"xmodel-list-tagger-init-action"})}},_deactivateTagger:function(){this._taggerComponent.deactivate(this._taggerId)},destroy:function(){this._taggerComponent.killTagProxy(this._taggerId)}});return c});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListViewEmptyContent",["DS/ENOXEmptyContent/js/ENOXEmptyContent"],function(b){var a=function(e,d,g,c){this._ENOXEmptyContent=new b(d.emptyContentOptions);this._ENOXEmptyContent.inject(c);this._modelEvents=g;console.log("hey i am the empty content");if(e.getChildren().length===0){c.classList.remove("displaynone")}var f=this;["addChild","removeChild"].forEach(function(h){e.addEventListener(h,function(){if(e.getChildren().length===0){c.classList.remove("displaynone");f._modelEvents.publish({event:"xmodel-list-is-empty",data:true})}else{c.classList.add("displaynone");f._modelEvents.publish({event:"xmodel-list-is-empty",data:false})}})})};return a});define("DS/xPortfolioUXCommons/XModelListView/js/XModelListView",["DS/xPortfolioUXCommons/XModelListView/js/XModelListViewCollectionToolBar","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewEmptyContent","DS/DataGridView/DataGridView","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/UIKIT/Mask","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/TreeModel/DataModelSet","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewTaggerExtension","i18n!DS/xPortfolioUXCommons/assets/nls/XModelListView","css!xPortfolioUXCommons/XModelListView/css/XModelListView.css"],function(b,n,k,o,d,l,i,r,h,c,j,g,q,e,p,f,m){var a=function(s){this._withToolBar=s.withToolBar!==undefined?s.withToolBar:true;this._initDivs();if(!s.viewOptions){s.viewOptions={}}if(!s.model){var u=new q();s.model=new g({dataModelSet:u})}this._model=s.model;this._options=s;this._id=s.id||"ViewId";this._useAsyncExpand=s.useAsyncExpand==true?true:false;this._model.options.useAsyncPreExpand=this._useAsyncExpand;this._groupedRows=[];this._modelEvents=s.modelEvents;this.useDragAndDrop=s.useDragAndDrop||false;var v=s.extensions||[];this._initExtensions_v1(v);if(this._withToolBar){this._initToolBar(this._model,s)}this._initListView(s.viewOptions);if(s.emptyContentOptions!=null){this._initEmptyContent(this._model,s)}this._subscribeEvents();if(widget&&UWA.is(widget,"object")){var t=this;widget.addEvent("onSearch",function(w){t._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:w})});widget.addEvent("onResetSearch",function(){t._modelEvents.publish({event:"xmodel-list-dashboard-search-action",data:""})})}};a.prototype._subscribeEvents=function(){var s=this;this._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(t){if(s._groupedRows.length>0){var u=s._model.addEventListener("pushUpdate",function(){s._model.removeEventListener(u);s._switchView(t)});s._modelEvents.publish({event:"xmodel-list-view-group-by-action",data:[]})}else{s._switchView(t)}s._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:(t=="DataGridView")})});this._model.subscribe({event:"addChild"},function(t){console.log();var u=s._getContextualMenu(t.data.nodeModel);t.data.nodeModel.options.contextualMenu=u;if(s._useAsyncExpand){if(t.data.nodeModel.getNodeDepth()==0){t.data.nodeModel.addChild([{label:""}])}}s._onDataUpdate()});this._model.subscribe({event:"removeChild"},function(t){console.log();s._onDataUpdate()});this._modelEvents.subscribe({event:"xmodel-list-view-group-by-action"},function(u){if(!u){u=[]}var t=s._contentViews.DataGridView;if(t){s._groupedRows=u;t.groupRows({dataIndexesToGroup:u});s._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:s._groupedRows.length})}});this._modelEvents.subscribe({event:"xmodel-list-view-update-grouping-action"},function(v){var t=s._contentViews.DataGridView;if(t&&v){var u=s._groupedRows;if(UWA.is(u,"array")&&u.length>0){v.groupRoots({propertiesToGroup:u})}s._modelEvents.publish({event:"xmodel-list-data-set-filter-node-level",data:s._groupedRows.length})}});this._modelEvents.subscribe({event:"xmodel-list-view-expand-all-action"},function(){s._model.prepareUpdate();s._model.expandAll();s._model.pushUpdate()});this._modelEvents.subscribe({event:"xmodel-list-view-collapse-all-action"},function(){s._model.prepareUpdate();s._model.collapseAll();s._model.pushUpdate()});this._modelEvents.subscribe({event:"xmodel-list-data-on-load-start"},function(){if(s._container){r.mask(s._container)}});this._modelEvents.subscribe({event:"xmodel-list-data-on-load-complete"},function(){if(s._container&&r.isMasked(s._container)){r.unmask(s._container)}});this._modelEvents.subscribe({event:"xmodel-list-context-search-action"},function(t){var u={id:"ContextSearch",content:{value:t}};s._modelEvents.publish({event:"xmodel-list-data-search-action",data:u})});this._modelEvents.subscribe({event:"xmodel-list-dashboard-search-action"},function(t){var u={id:"GlobalSearch",content:{value:t}};s._modelEvents.publish({event:"xmodel-list-data-search-action",data:u})});this._modelEvents.subscribe({event:"xmodel-list-data-sort-action"},function(u){var t=s._contentViews.DataGridView;if(t){t.sortModel=[u]}});this._modelEvents.subscribe({event:"xmodel-list-set-column-visibility-action"},function(u){var t=s._contentViews.DataGridView;if(t){t.layout.setColumnVisibleFlag(u.dataIndex,u.visibility)}});this._model.getXSO().onAdd(function(t){if(t.options&&t.options.id){console.log("on add selection ");s._modelEvents.publish({event:"xmodel-list-item-on-add-selection",data:{model:t.options.grid,items:s._model.getXSO().get()},context:t})}else{console.log();t.unselect()}});this._model.getXSO().onRemove(function(t){console.log("on remove selection ");if(t.options&&t.options.id){s._modelEvents.publish({event:"xmodel-list-item-on-remove-selection",data:{model:t.options.grid,items:s._model.getXSO().get()},context:t});if(s._model.getSelectedNodes()&&s._model.getSelectedNodes().length==0){console.log("empty selection");s._modelEvents.publish({event:"xmodel-list-item-on-empty-selection"})}}});this._modelEvents.subscribe({event:"xmodel-list-item-on-unselect-all"},function(){s._model.unselectAll()});this._modelEvents.subscribe({event:"xmodel-list-item-get-selection"},function(v){if(UWA.is(v,"function")){var u=s._model.getXSO().get();var t=u.map(function(w){return w.options.grid});v(t||[])}});this._modelEvents.subscribe({event:"xmodel-list-data-on-update"},function(){s._onDataUpdate()});this._modelEvents.subscribe({event:"xmodel-list-reset-sort-model"},function(){if(s._contentViews.DataGridView){s._contentViews.DataGridView.sortModel=null}});this._model.onPreExpand(function(t){s._modelEvents.publish({event:"xmodel-list-view-on-expand",data:{model:t.data.nodeModel.options.grid,nodeInfo:t.data},context:t.data.nodeModel})})};a.prototype._initEmptyContent=function(s,t){this._emptyContainer=document.createElement("div");this._emptyContainer.classList.add("mdllv-empty-container");if(!this._withToolBar){this._emptyContainer.classList.add("no-toolbar")}this._emptyContainer.classList.add("displaynone");this._XModelListViewEmptyContent=new n(s,t,this._modelEvents,this._emptyContainer);var u=this;this._modelEvents.subscribe({event:"xmodel-list-is-empty"},function(v){if(v){u._listContainer.classList.add("displaynone")}else{u._listContainer.classList.remove("displaynone")}});this._container.appendChild(this._emptyContainer)};a.prototype._initDivs=function(){this._container=UWA.createElement("div");this._container.classList.add("xmodel-list-view");this._collectionToolBarContainer=document.createElement("div");this._collectionToolBarContainer.classList.add("xmdllv-collectiontoolbar-container");this._listContainer=document.createElement("div");this._listContainer.classList.add("xmdllv-list-container");if(!this._withToolBar){this._listContainer.classList.add("no-toolbar");this._collectionToolBarContainer.classList.add("no-toolbar")}this._container.appendChild(this._collectionToolBarContainer);this._container.appendChild(this._listContainer)};a.prototype._initToolBar=function(s,t){this._collectionToolBar=new b(s,t,this._modelEvents);this._collectionToolBar.inject(this._collectionToolBarContainer)};a.prototype.attachResizeSensor=function(){this._collectionToolBar.attachResizeSensor()};a.prototype._setDragData=function(u,z){var y=[];for(var t=0;t<z.length;t++){var x=z[t]._getDataModel();var v=x?x._getData().grid:{id:"",type:"",modelID:""};var s={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:"",objectId:v.id,objectType:(v.type).trim()||"",objectName:v.name||"",displayType:(v.type).trim()||"",displayName:x._getData().label};y.push(s)}var w={protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widget_id:widget.id,data:{items:y}};u.dataTransfer.setData("Text",JSON.stringify(w));u.dataTransfer.effectAllowed="all"};a.prototype._initListView=function(t){this._views=t.views||["DataGridView"];this._currentView=t.currentView?t.currentView:this._views[0];this._contentViews={};var s={height:"inherit",displayedOptionalCellProperties:["contextualMenu","description","propertiesList"],allowUnsafeHTMLContent:false,model:this._model,};var w=this;var u={callback:function(F){var E=F.menu?F.menu:[];var A=F.cellInfos.nodeModel;if(w._contentViews[w._currentView]&&w._contentViews[w._currentView].activeNode){var D=w._contentViews[w._currentView].activeNode;if(A!=D){A=D;E=w._getContextualMenu(D)}}if(A&&A._listOfChildren==null){return E}if(A){var B=A.getTreeDocument();var z=true;var C=0;while(C<E.length&&z){if(E[C].id==="expand"){z=false}C++}if(z){E.push({type:"SeparatorItem"});E.push({id:"expand",type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-chevron-down"},title:f._expand_content,action:{callback:function(G){if(B!==undefined){A.expandAll()}}},state:A.isExpanded()?"disabled":"enabled"});E.push({id:"collapse",type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-eye-off"},title:f._hide_content,action:{callback:function(G){if(B!==undefined){A.collapseAll()}}},state:A.isExpanded()?"enabled":"disabled"})}}return E}};var y={label:"label",subLabel:"subLabel",description:"description"};UWA.extend(y,t.itemViewMapping||{});var v={getLabel:function(z){return UWA.is(y.label,"function")?y.label.call(this,z):z.options.grid[y.label]},getSubLabel:function(z){return UWA.is(y.subLabel,"function")?y.subLabel.call(this,z):z.options.grid[y.subLabel]},getDescription:function(z){return UWA.is(y.description,"function")?y.description.call(this,z):z.options.grid[y.description]}};var x=function(z){z.cellView.getContent().setAttribute("node-depth",z.nodeModel.getNodeDepth())};this._views.forEach(function(I){if(I==="DataGridView"){var H={identifier:t.identifier?t.identifier:w._options.id?w._options.id:undefined,treeDocument:w._model,_useClipboardFlag:true,cellSelection:"none",defaultColumnDef:{width:"auto",typeRepresentation:"string",groupableFlag:false,editionPolicy:"EditionOnClick"},onContextualEvent:function(M){var L=[];if(M&&M.collectionView&&M.cellInfos){var K=M.collectionView.columns.length;var J=M.cellInfos.columnID;if(J!=0&&J!=1){L=M.collectionView.buildDefaultContextualMenu(M,{pin:true,firstColumnsVisibility:true,columnsManagement:true,sizeColumnToFit:false});return L}}},rowDragEnabledFlag:w.useDragAndDrop,columnDragEnabledFlag:false,onDragStartRowHeader:function(J,K){var M=this.getTreeDocument()?this.getTreeDocument().getSelectedNodes():[];var L=(M&&M.length>0)?M:[K.nodeModel];w._setDragData(J,L)}};var z=t.grid;if(z.columns){for(var E=0,F=z.columns.length;E<F;E++){var D=z.columns[E];if(D&&D.dataIndex==="tree"){D.alwaysVisibleFlag=true;if(D.sortableFlag!=undefined&&D.sortableFlag===false){D.sortableFlag=true}D.minWidth=150;break}}if(t.contextualActions){z.columns.unshift({text:f._color,dataIndex:"color",typeRepresentation:"color",pinned:"left",width:"50",visibleFlag:false});z.columns.push({text:f._action,dataIndex:"contextualMenu",width:55,resizableFlag:false,allowUnsafeHTMLContent:true,alwaysVisibleFlag:true,sortableFlag:false,groupableFlag:false,typeRepresentation:"contextualMenuType",getCellValue:function(L){var K={menu:[],disabled:false};var J=w._getContextualMenu(L.nodeModel);if(J&&J.length>0){K.menu=J}if(L.nodeModel.options.disableMenu==true){K.disabled=true}return K},})}}UWA.merge(H,z);w._contentViews[I]=new k(H);var A={contextualMenuType:{stdTemplate:"contextualMenuTemplate",semantics:{}}};var B={contextualMenuTemplate:{path:"DS/xPortfolioUXCommons/XModelListView/js/ContextualMenuTweaker"}};if(z.typeRepresentations&&UWA.is(z.typeRepresentations,"object")){UWA.merge(A,z.typeRepresentations)}w._typeRepresentationFactory=w._contentViews[I].getTypeRepresentationFactory();w._typeRepresentationFactory.registerTypeTemplates(B);w._typeRepresentationFactory.registerTypeRepresentations(A);var C=t.editable;if(C){var G=["postEdit"];G.forEach(function(J){w._contentViews[I].addEventListener(J,function(N,O){if(N.dsModel&&N.dsModel.layout&&O&&O.nodeModel&&O.nodeModel.options&&O.nodeModel.options.grid){var M=[O.nodeModel.options.grid];var K=N.dsModel.layout.getColumnEditableFlag(O.columnID);var L=N.dsModel.layout.getDataIndexFromColumnIndex(O.columnID);L=L&&L==="tree"?"title":L;if(L==="description"&&O.nodeModel.options.description!=undefined){M[0].description=O.nodeModel.options.description}if(K===true&&L!=undefined&&L!==""){w._modelEvents.publish({event:"list-view-update-inline-action",data:{model:M,name:L,value:O.cellModel,cell:O}})}}})})}w._contentViews[I]._applySortModelOrig=w._contentViews[I]._applySortModel;w._contentViews[I]._applySortModel=function(K){this._applySortModelOrig(K);if(this._isCurrentlyCalledFromUIInteraction()===true){var L=this.sortModel&&this.sortModel.length>0?this.sortModel[0]:undefined;if(L){var J={sortOrder:L.sort?L.sort.toUpperCase():undefined,sortAttribute:L.dataIndex?L.dataIndex:undefined};w._modelEvents.publish({event:"enox-collection-toolbar-sort-activated",data:J})}}}}else{if(I==="TileView"){w._contentViews[I]=new (d.inherit(v))(s);w._contentViews[I].onContextualEvent=u;w._contentViews[I].onPostCellRequest(x)}else{if(I==="ThumbnailView"){w._contentViews[I]=new (l.inherit(v))(s);w._contentViews[I].onContextualEvent=u;w._contentViews[I].onPostCellRequest(x)}else{if(I==="LargeThumbnailView"){w._contentViews[I]=new (i.inherit(v))(s);w._contentViews[I].onContextualEvent=u;w._contentViews[I].onPostCellRequest(x)}}}}if(w.useDragAndDrop){w._contentViews[I].useDragAndDrop=w.useDragAndDrop;w._contentViews[I].onDragStartCell=function(J,K){var M=this.getTreeDocument().getSelectedNodes()?this.getTreeDocument().getSelectedNodes():[];var L=(M&&M.length>0)?M:K.nodeModel;w._setDragData(J,L)};w._contentViews[I].onDragEnterBlankDefault=function(J){};w._contentViews[I].onDragEnterBlank=function(J){}}w._contentViews[I].addEventListener(c.POINTERHIT,function(J,K){if(K&&K.nodeModel&&K.nodeModel.options.id){if(J.multipleHitCount==2){console.log("xmodel-list-item-on-dblclickPOINTERHIT");w._modelEvents.publish({event:"xmodel-list-item-on-dblclick",data:{model:K.nodeModel.options.grid},context:K.nodeModel})}}});w._contentViews[I].addEventListener("click",function(L,M){if(M&&M.nodeModel&&M.nodeModel.options.id){console.log("xmodel-list-item-on-click");var J=L.target.getAttribute("href");if(J!=null&&J!=undefined){var K=L.dsModel.layout.getDataIndexFromColumnIndex(M.columnID);w._modelEvents.publish({event:"xmodel-list-item-on-link-click",data:{model:M.nodeModel.options.grid,linkId:K?K:J,}})}else{w._modelEvents.publish({event:"xmodel-list-item-on-click",data:{model:M.nodeModel.options.grid,event:L},context:M.nodeModel})}}})});this._switchView(this._currentView)};a.prototype._getSelectedItem=function(){var t=this._model.getXSO().get();var s=t.map(function(u){return u.options.grid});return s};a.prototype._switchView=function(s){var t=this._contentViews[s];if(t){this._currentView=s;UWA.extendElement(this._listContainer).setContent(t.getContent());if(this._currentView!="DataGridView"){this._modelEvents.publish({event:"xmodel-list-toolbar-group-visibility",data:false})}}};a.prototype.inject=function(s){s.appendChild(this._container)};a.prototype.getTypeRepresentationFactory=function(s){return this._typeRepresentationFactory};a.prototype._initExtensions_v1=function(v){var s={id:this._id,model:this._model,modelEvents:this._modelEvents};var w=this;w._extensions=[];var u=[];var t=[];if(v&&v instanceof Array&&v.length>0){v.forEach(function(y){switch(UWA.typeOf(y)){case"string":u.push(new UWA.Promise(function(A,z){require([y],function(B){A(B)},function(B){z("Error loading modules."+((B&&B.requireModules)?B:""))})}));break;case"class":t.push(y);break}})}console.log("[xModelListView:_initExtensions_v1] No. of Extension to initialize: "+t.length+" to resolve:  "+u.length);t.forEach(function(z){var y=new z();y.initialize(s);w._extensions.push(y)});function x(y){y.forEach(function(A){var z=new A();w._extensions.push(z)});w._extensions.forEach(function(z){z.initialize(s)})}if(u.length>0){UWA.Promise.all(u).then(x)}};a.prototype._initExtensions=function(t){var s={id:this._id,model:this._model,modelEvents:this._modelEvents};var u=this;u._extensions=[];function w(x){x.forEach(function(z){var y=new z();u._extensions.push(y)});u._extensions.forEach(function(y){y.initialize(s)})}function v(x){var y=x.map(function(z){switch(UWA.typeOf(z)){case"string":return new UWA.Promise(function(B,A){require([z],function(C){B(C)},function(C){A("Error loading modules."+((C&&C.requireModules)?C:""))})});break;case"class":return UWA.Promise.resolve(z)}});return UWA.Promise.all(y)}v(t).then(w)};a.prototype.addExtension=function(s){};a.prototype.filter=function(s){if(s.id){this._filters[s.id]=s.content||{};var u=s.content;if(u.ids){this._model.prepareUpdate();var t=this._model.search({match:function(v){if(u.ids.indexOf(v.nodeModel.options.id)!=-1){v.nodeModel.matchSearch();return true}v.nodeModel.unmatchSearch();return false}});this._model.pushUpdate()}}};a.prototype._onDataUpdate=function(){if(this._groupedRows.length==0){var t=0;var s=this._model.getChildren();if(s){var u=s.filter(function(v){return v.isVisible()});t=u.length}this._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:t})}};a.prototype._getContextualMenu=function(s){var u=[];if(this._options.viewOptions.contextualActions&&s.options.id){var t=this._options.viewOptions.contextualActions;if(UWA.is(this._options.viewOptions.contextualActions,"function")){t=this._options.viewOptions.contextualActions.call(s)}t.forEach(function(w){var v={id:w.id,type:"PushItem",title:w.text,state:w.state?w.state:"enabled",action:{callback:function(y,x){console.log(w.handler);console.log(s);if(UWA.is(w.handler,"function")){w.handler.call(s,s.options.grid)}}}};if(w.fonticon){v.fonticon={content:"wux-ui-3ds wux-ui-3ds-"+w.fonticon}}u.push(v)})}return u};a.prototype.destroy=function(s){this._extensions.forEach(function(t){t.destroy()})};return a});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemCollection",["UWA/Class/Collection","DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel"],function(b,a){return b.extend({model:a,})});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetView",["UWA/Class/View","UWA/Class/Model","DS/ENOXAdvancedSetView/js/ActionsToolbar","DS/ENOXAdvancedSetView/js/ENOXAdvancedSetView","DS/ENOXAdvancedSetView/js/GridScrollView","DS/W3DXComponents/Views/Item/TileView","DS/Core/ModelEvents","DS/DataDragAndDrop/DataDragAndDrop","DS/xPortfolioUXCommons/WrappedAdvSetView/js/ItemModel","DS/Handlebars/Handlebars","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBar","DS/PlatformAPI/PlatformAPI","i18n!DS/xPortfolioUXCommons/assets/nls/WrappedAdvSetView","css!DS/xPortfolioUXCommons/WrappedAdvSetView/css/WrappedAdvSetView.css"],function(b,i,m,a,p,l,g,n,e,f,j,o,d,c){var k=[];var h=function(){};h.prototype.init=function(q,r){this._options=r;this._options.enableRefresh=true;this._parentUpdateChannel=q;this._bridgeModelEvent=new g();this._selectionCount=0;this._initDivs();this._initSubViews();this._subscribeToEvents();this.__pendingClick=0;this.__clearTimeout=0;this._listSelectedIds=[];this._listSelectedObjects=[]};h.prototype._initDivs=function(){var t=this;this._container=document.createElement("div");this._container.classList.add("wrapped-set-view-main-container");this._titleDiv=document.createElement("div",{id:"titleContainerDiv"});if(this._options.showTitle){this._titleDiv.classList.add("wrapped-set-view-title-container");this._container.appendChild(this._titleDiv);this._titleSpan=document.createElement("span");this._titleSpan.classList.add("wrapped-set-view-title-span");this._titleSpan.innerHTML=this._options.viewTitle?this._options.viewTitle:"";this._titleDiv.appendChild(this._titleSpan)}this._stdActionbarContainer=UWA.createElement("div",{id:"filterContainerDiv"});this._stdActionbarContainer.addClassName("wrapped-set-view-filter-container");this._advSetViewContainer=UWA.createElement("div");this._advSetViewContainer.classList.add("wrapped-set-view-set-container");if(this._options.isDroppable){var r=d.MSG_DROP_TO_CREATE_NEW_VALUE?d.MSG_DROP_TO_CREATE_NEW_VALUE:"Drop here to create new Value";if(this._options.dropMessage){r=this._options.dropMessage}var s=UWA.createElement("div",{styles:{margin:"auto"},html:[{tag:"span","class":"fonticon fonticon-plus",styles:{textAlign:"center",width:"100%",fontSize:"35px",}},{tag:"div",html:r,styles:{textAlign:"center",width:"100%",fontSize:"20px"}}],});var q=UWA.createElement("div",{styles:{width:"100%",height:"100%",position:"absolute",top:0,border:"5px #368ec4",borderStyle:"dashed",borderRadius:"5px",display:"flex",color:"#368ec4",backgroundColor:"#f6f3f3",opacity:".5"},html:s});n.droppable(this._advSetViewContainer,{over:function(w,u){var v=t._advSetViewContainer.getBoundingClientRect();if((u.x-10)>v.left&&(u.x+10)<v.right&&(u.y-10)>v.top&&(u.y+10)<v.bottom){var x=t._advSetViewContainer.offsetTop;if(x){if(q.getStyle("top")!=""+x+"px"){q.setStyles({top:""+x+"px",height:"calc( 100% - "+x+"px )"})}}if(!q.isInjected(t._advSetViewContainer)){q.inject(t._advSetViewContainer)}return true}else{q.remove()}return false},enter:function(v,u){},leave:function(w,u){var v=t._advSetViewContainer.getBoundingClientRect();if((u.x-10)<v.left||(u.x+10)>v.right||(u.y-10)<v.top||(u.y+10)>v.bottom){q.remove()}},drop:function(x,v,w){q.remove();var u=w.dataTransfer.items;t._parentUpdateChannel.publish({event:"wrapped-adv-set-view-drop-event",data:u})}})}this._container.appendChild(this._stdActionbarContainer);this._container.appendChild(this._advSetViewContainer)};h.prototype._initSubViews=function(){var q=this;this._stdActionbar=new j(this._getCollectionToolbarOptions());this._advSetView=new a(this._getSetViewOptions());this._advSetView.render().inject(this._advSetViewContainer);this._stdActionbar.inject(this._stdActionbarContainer);this._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(r){q._bridgeModelEvent.publish({event:"advanced-set-view-sort",data:[{id:r.sortAttribute,desc:r.sortOrder==="DESC"?true:false}]})});this._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(r){q._bridgeModelEvent.publish({event:"advanced-set-view-switch",data:{id:r}})});this._hideDefActionbar();k.push(this._stdActionbar)};h.prototype._subscribeToEvents=function(){var r=this;var q=0;if(this._options.enableRefresh){o.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(t){console.log("Events from PlatformAPI");var s=t?(t.data?(t.data.authored?(t.data.authored.modified?t.data.authored.modified:[]):[]):[]):[];s.forEach(function(v,u){if(v){if(r._options.collection.get(v)){r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-refresh-item",data:v})}else{console.log("This WrappedAdvSetView instance's collection does not have this id!!!")}}})})}this._advSetView.listenTo(this._advSetView,{onItemViewClick:function(){console.log("On ItemView click");var u=arguments&&arguments.length>=3?arguments[2].model.id:null;var t=arguments&&arguments.length>=3?arguments[2].model._attributes.name:null;var s=arguments&&arguments.length>=3?arguments[2].model._attributes.version:null;r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-item-click",data:{id:u,name:t,version:s}})}});this._advSetView.listenTo(this._advSetView,{onItemViewDblClick:function(){console.log("onItemViewDblClick");var v=arguments&&arguments.length>=3?arguments[2].model.id:null;var u=arguments&&arguments.length>=3?arguments[2].model._attributes.name:null;var t=arguments&&arguments.length>=3?arguments[2].model._attributes.version:null;var s={};if(arguments.length>=3){s=arguments[2].model.toJSON();arguments[2].unSelect({silent:true})}UWA.merge(s,{id:v,name:u,version:t});r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-item-dbl-click",data:s})}});this._bridgeModelEvent.subscribe({event:"advanced-set-view-filtered"},function(){var s=r._advSetView.filteredCollection?r._advSetView.filteredCollection.length:0;r._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:s})});this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-resize"},function(t){var v=this,s;for(var u=0;u<v.length;u++){if(v[u]._container.offsetWidth>0){s=v[u];break}}if(s){s._resize()}if(t&&typeof(t)==="function"){t()}}.bind(k));this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-fetch-selection-count"},function(s){if(s&&typeof(s)==="function"){s(r._selectionCount)}});this._parentUpdateChannel.subscribe({event:"wrapped-adv-set-view-filter"},function(s){r._bridgeModelEvent.publish({event:"advanced-set-view-filter",data:s})});this._bridgeModelEvent.subscribe({event:"advanced-set-view-filtered"},function(s){r._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filtered",data:s})})};h.prototype.getSelectedIds=function(){return this._listSelectedIds};h.prototype.getSelectedObjects=function(){return this._listSelectedObjects};h.prototype.inject=function(q){q.appendChild(this._container)};h.prototype.getContent=function(){return this._container};h.prototype.destroy=function(){if(this._container&&this._container.parentElement){this._container.parentElement.removeChild(this._container)}};h.prototype._hideDefActionbar=function(){var q=this._container.getElementsByClassName("advanced-set-view-header set-header");if(q.length>0){q[0].style.setProperty("display","none")}};h.prototype._setReferenceCollection=function(s){var r=this;if(this._advSetView.currentViewId&&this._advSetView.contentsViews){if(this._advSetView.contentsViews[this._advSetView.currentViewId].nestedView){this._advSetView.contentsViews[this._advSetView.currentViewId].nestedView.deactivateMultisel()}}this._advSetView.collection.set(s.toArray());this._advSetView._referenceCollection=s.clone();var q=this._advSetView.collection?this._advSetView.collection.length:0;this._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:q})};h.prototype._getSetViewOptions=function(){var s=this;var t=UWA.clone(s._options.itemViewMapping||{});UWA.merge(t,{title:"title",content:"description",image:"image"});var r=s._options.filters?s._options.filters:[];var q={collection:s._options.collection,lazyRender:true,contents:{selectionMode:"nullToMany",useInfiniteScroll:false,views:[{id:"tile",title:d.TILE?d.TILE:"Tile",view:p,itemView:l},{id:"thumbnail",title:d.THUMBNAIL?d.THUMBNAIL:"Thumbnail",view:p}],itemViewOptions:{mapping:t,attributes:{draggable:true},contextualActions:s._options.contextualActions?s._options.contextualActions:[]},events:{onItemViewDrag:function(z,w,y){if(w&&w.model){var v=w.model.toJSON();var x={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",contextId:"",objectId:v.id,objectType:"Hardware Product",displayName:v.name,displayType:"Hardware Product"};var u={protocol:"3DXContent",version:"1.1",source:"xModelApp",widgetId:widget.id,data:{items:[x]}};y.dataTransfer.setData("Text",JSON.stringify(u));console.log()}},onAddSelection:function(){s.__pendingClick+=1;if(s.__pendingClick>=2){clearTimeout(s.__clearTimeout)}var u=arguments;s.__clearTimeout=setTimeout(function(){if(s.__pendingClick>=2){s.__pendingClick=0;return}if(u&&u.length<2){console.log("Wrapped Adv Set view: Problem with received arguments!!!");return}var v=u[0].getSelection();s.__updateSelectedIdsAndObjectsList(v);s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-add",data:{parentView:u[0],itemView:u[1],unselectedId:u[1].id,selectedObject:{id:u[1].id,attributes:(u[1].attributes?u[1].attributes:(u[1]._attributes?u[1]._attributes:[]))},selectionCount:s._selectionCount,selectedIds:s._listSelectedIds,selectedObjects:s._listSelectedObjects}});s.__pendingClick=0},500)},onRemoveSelection:function(){if(arguments&&arguments.length<2){console.log("Wrapped Adv Set view: Problem with received arguments!!!");return}var u=arguments[0].getSelection();s.__updateSelectedIdsAndObjectsList(u);console.log("Wrapped Adv Set view: Item view onRemoveSelection: selection count: "+s._selectionCount);s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-remove",data:{parentView:arguments[0],itemView:arguments[1],unselectedObject:{id:arguments[1].id,attributes:(arguments[1].attributes?arguments[1].attributes:(arguments[1]._attributes?arguments[1]._attributes:[]))},unselectedId:arguments[1].id,selectionCount:s._selectionCount,allSelectedIds:s._listSelectedIds,allSelectedObjects:s._listSelectedObjects}})},onDeactivateMultisel:function(){s._parentUpdateChannel.publish({event:"wrapped-adv-set-view-selection-on-remove-all",data:arguments[1]});var u=arguments[0].getSelection();s.__updateSelectedIdsAndObjectsList(u)}},},events:{onInfiniteScroll:function(u){var w=u.collection,v={type:"json",onComplete:function(){u.scrollView.endLoading()}};if(w.state.totalRecords===null){w.getFirstPage(v)}else{if(w.hasNextPage()){w.getNextPage(UWA.extend(v,{remove:false,reset:false}))}else{u.container.removeClassName("loading");u.scrollView.useInfiniteScroll(false)}}}},actions:{view:m,collection:function(){var u=[];u.push({id:"filterby",title:"Filter By",overflow:false,type:"filter",multiSelect:true,key:[{name:"type",value:"Part",label:""},{name:"type",value:"Model",label:"Only models"}]});u.push({id:"sortby",title:"Sort By",overflow:false,type:"sort",key:[{name:"name",label:""},{name:"description",label:"Description"},{name:"type",label:"Type"},{}]});return u},modelEvents:s._bridgeModelEvent,events:{onActionClick:function(w,u,v){console.log("action clicked")}}},buildMultiselActions:function(v){var u=[];u.push({id:"delete",multisel:true,text:"Remove",fonticon:"trash",handler:function(w){console.log("delete")}});return u},modelEvents:s._bridgeModelEvent,filters:r};return q};h.prototype._getCollectionToolbarOptions=function(){var q=this._options.actionBarOptions?this._options.actionBarOptions:{};UWA.merge(q,{withmultisel:false,showItemCount:true,filter:{},actions:[],sort:[{id:"name",text:"Name",type:"string"}],views:[{id:"tile",text:(d.TILE?d.TILE:"Tile"),fonticon:"view-small-tile"},{id:"thumbnail",text:(d.THUMBNAIL?d.THUMBNAIL:"Thumbnail"),fonticon:"view-small-thb"}]});return q};h.prototype._getSorter=function(q){return function(s,r){if(s._attributes[q]&&r._attributes[q]&&(s._attributes[q]>r._attributes[q])){return 1}else{return -1}}};h.prototype._addSortersInAdvSetView=function(){this._advSetView.addCustomSorter("version",this._getSorter("version"));this._advSetView.addCustomSorter("id",this._getSorter("id"));this._advSetView.addCustomSorter("name",this._getSorter("name"));this._advSetView.addCustomSorter("type",this._getSorter("type"))};h.prototype.addItem=function(w,r){if(r){var v=this;var q=v._advSetView.currentViewId;var u=v._advSetView.contentsViews[q];var x=u?v._advSetView.contentsViews[q].nestedView:false;if(x){x.listenToOnce(x,"onAfterItemAdded",function(y){this.deactivateMultisel();this.addSelection(y.model);v._advSetView.scrollToItemView(y.model,{view:u})})}}if(w instanceof i){this._advSetView.collection.add(w);this._advSetView._referenceCollection.add(w);this._options.collection.add(w)}else{if(UWA.is(w,"object")){var s=new e(w);this._advSetView.collection.add(s);this._advSetView._referenceCollection.add(s);this._options.collection.add(s)}}var t=this._advSetView.collection?this._advSetView.collection.length:0;this._stdActionbar._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:t})};h.prototype.__updateSelectedIdsAndObjectsList=function(r){var q=this;this._listSelectedIds=[];this._listSelectedObjects=[];if(r&&r.length>0){r.forEach(function(s){if(s&&s.id){q._listSelectedIds.push(s.id);q._listSelectedObjects.push({id:s.id,attributes:(s.attributes?s.attributes:(s._attributes?s._attributes:[]))})}});this._selectionCount=r.length}else{this._selectionCount=0}console.log("Wrapped Adv set view:__updateSelectedIdsAndObjectsList: Selection count: "+this._selectionCount)};return h});define("DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetViewWithFilters",["DS/xPortfolioUXCommons/WrappedAdvSetView/js/WrappedAdvSetView","DS/WildcardSearchComponent/WildcardSearchComponent","DS/TaggerOnIndexComponent/TaggerOnIndexComponent"],function(d,b,c){var a=function(){this.WrappedAdvSetView=new d()};a.prototype.init=function(h,e,f){this.tagFriends=f.tagFriends;this._CSearch=[];this._idProxy=h;var g=this;f.filters=f.filters?f.filters:[];f.filters.push({id:"tagFilter",callback:function(l,i){var j=true;var k=g.getTagProxy(g._idProxy);if(!l.WrappedAdvSetViewFilters){l.WrappedAdvSetViewFilters={}}if(l.collection&&l.collection._models&&l.collection._models[i]){(k.filteredSubjectList.indexOf(l.collection._models[i].id)===-1)?l.WrappedAdvSetViewFilters.WASVFTagger=false:l.WrappedAdvSetViewFilters.WASVFTagger=true}else{(k.filteredSubjectList.indexOf(l.id)===-1)?l.WrappedAdvSetViewFilters.WASVFTagger=false:l.WrappedAdvSetViewFilters.WASVFTagger=true}Object.keys(l.WrappedAdvSetViewFilters).forEach(function(m){if(l.WrappedAdvSetViewFilters[m]==false){j=false}});return j}});f.filters.push({id:"ContextSearchFilter",callback:function(n,j){var k=true;var m=[];for(var l=0;l<g._CSearch.length;l++){m.push(g._CSearch[l].id)}if(!n.WrappedAdvSetViewFilters){n.WrappedAdvSetViewFilters={}}if(n.collection&&n.collection._models&&n.collection._models[j]){(m.indexOf(n.collection._models[j].id)===-1)?n.WrappedAdvSetViewFilters.WASVFCSearch=false:n.WrappedAdvSetViewFilters.WASVFCSearch=true}else{(m.indexOf(n.id)===-1)?n.WrappedAdvSetViewFilters.WASVFCSearch=false:n.WrappedAdvSetViewFilters.WASVFCSearch=true}Object.keys(n.WrappedAdvSetViewFilters).forEach(function(i){if(n.WrappedAdvSetViewFilters[i]==false){k=false}});return k}});f.filters.push({id:"GlobalSearchFilter",callback:function(n,j){var k=true;var m=[];for(var l=0;l<g._GSearch.length;l++){m.push(g._GSearch[l].id)}if(!n.WrappedAdvSetViewFilters){n.WrappedAdvSetViewFilters={}}if(n.collection&&n.collection._models&&n.collection._models[j]){(m.indexOf(n.collection._models[j].id)===-1)?n.WrappedAdvSetViewFilters.WASVFGSearch=false:n.WrappedAdvSetViewFilters.WASVFGSearch=true}else{(m.indexOf(n.id)===-1)?n.WrappedAdvSetViewFilters.WASVFGSearch=false:n.WrappedAdvSetViewFilters.WASVFGSearch=true}Object.keys(n.WrappedAdvSetViewFilters).forEach(function(i){if(n.WrappedAdvSetViewFilters[i]==false){k=false}});return k}});this._options=f;this._parentUpdateChannel=e;this._TaggerOnIndexComponent=c;this.WrappedAdvSetView.init(e,f);this.WildcardSearch=new b();this._subscribeToEvents()};a.prototype._initContextSearch=function(){var f=this;var e=function(g){f._CSearch=g;f.WrappedAdvSetView._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"ContextSearchFilter",exclude:false}]})};this.WrappedAdvSetView._stdActionbar._modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(g){f.WildcardSearch.search(g.searchValue[0],f.WrappedAdvSetView._options.collection,e)})};a.prototype._initSearch=function(){var f=this;var e=function(g){f._GSearch=g;f.WrappedAdvSetView._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"GlobalSearchFilter",exclude:false}]})};if(this.WrappedAdvSetView._options.applicationChannel){this.WrappedAdvSetView._options.applicationChannel.subscribe({event:"search-in-current-dashboard"},function(g){f.WildcardSearch.search(g,f.WrappedAdvSetView._options.collection,e)})}};a.prototype._initTagger=function(g){var f=this;var h=function(){f._parentUpdateChannel.publish({event:"wrapped-adv-set-view-filter",data:[{id:"tagFilter",exclude:false}]})};var e={onTagFilterChange:h,MyFriends:this.tagFriends};f._TaggerOnIndexComponent.setTagProxy(f._idProxy,e,g)};a.prototype.getTagProxy=function(e){return this._TaggerOnIndexComponent.getTagProxy(e).getCurrentFilter()};a.prototype._initDivs=function(){this.WrappedAdvSetView._initDivs()};a.prototype._initSubViews=function(){this.WrappedAdvSetView._initSubViews()};a.prototype._subscribeToEvents=function(){this._initContextSearch();this._initSearch()};a.prototype.inject=function(e){this.WrappedAdvSetView.inject(e)};a.prototype.getContent=function(){return this.WrappedAdvSetView.getContent()};a.prototype.destroy=function(){this.WrappedAdvSetView.destroy()};a.prototype._hideDefActionbar=function(){this.WrappedAdvSetView._hideDefActionbar()};a.prototype._setReferenceCollection=function(g){this.WrappedAdvSetView._setReferenceCollection(g);var e=[];for(var f=0;f<g._models.length;f++){e.push(g._models[f].get("id"))}if(this._options.noPublishOnCreate==undefined||!this._options.noPublishOnCreate){this._initTagger(e)}};a.prototype.publishTags=function(){var e=[];for(var f=0;f<this.WrappedAdvSetView._advSetView._referenceCollection.length;f++){e.push(this.WrappedAdvSetView._advSetView._referenceCollection._models[f].get("id"))}if(e.length==0){this.clearTags()}else{this._initTagger(e)}};a.prototype.clearTags=function(){this._TaggerOnIndexComponent.killTagProxy(this._idProxy)};a.prototype._getSetViewOptions=function(){return this.WrappedAdvSetView._getSetViewOptions()};a.prototype._getCollectionToolbarOptions=function(){return this.WrappedAdvSetView._getCollectionToolbarOptions()};a.prototype._getSorter=function(e){return this.WrappedAdvSetView._getSorter(e)};a.prototype._addSortersInAdvSetView=function(){this.WrappedAdvSetView._addSortersInAdvSetView()};a.prototype.addItem=function(f,e){this.WrappedAdvSetView.addItem(f,e)};a.prototype.getSelectedIds=function(){return this.WrappedAdvSetView.getSelectedIds()};a.prototype.getSelectedObjects=function(){return this.WrappedAdvSetView.getSelectedObjects()};return a});