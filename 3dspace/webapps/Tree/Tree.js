define("DS/Tree/TreeNodeModel",["DS/TreeModel/TreeNodeModel"],function(a){return a});define("DS/Tree/PanelMdlView",["DS/Core/BaseComponent","DS/Windows/Panel","DS/TreeModel/TreeNodeModel",],function(c,b,d){function g(k){for(var j=0;j<this.length;j++){if(this[j].nodeModel===k){return{index:j,item:this[j]}}}}function f(k){for(var j=0;j<this.length;j++){if(this[j].value===k){return this[j]}}}function i(j){for(var k=0;k<this.length;k++){if(this[k].panel===j){return this[k]}}}function h(k){var j=g.call(this._nodesModel,k);if(j&&j.item&&j.item.panel){j.item.panel.destroy();this._nodesModel.splice(j.index,1)}}function e(l){var j=new b({title:l.options.label,icon:l.options.icons?l.options.icons[0]:undefined,expandedFlag:l.options.state,immersiveFrame:this.immersiveFrame,resizableFlag:true,autoCloseFlag:false,closeButtonFlag:this.closeButtonFlag});var m;if(this._nodesModel.length>0){m=this._nodesModel[0].panel}if(m){j.attachToWindow(m,WUXSnapAreaEnum.InsideArea)}this._nodesModel.push({value:j.identifier,panel:j,nodeModel:l});var k=this;j.addEventListener("close",function(o){o.target.dsModel.visibleFlag=false;if(k.removeChildOnCloseFlag){var n=i.call(k._nodesModel,o.target.dsModel);n.nodeModel.remove()}})}var a=c.inherit({name:"PanelMdlView",_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel",},immersiveFrame:{defaultValue:undefined,type:Object,},closeButtonFlag:{defaultValue:false,type:"boolean",category:"Behavior"},removeChildOnCloseFlag:{defaultValue:false,type:"boolean",category:"Behavior"}},_applyModel:function(){var l=this;if(l._nodesModel){l._nodesModel.forEach(function(m){m.panel.visibleFlag=false;m.panel.destroy()})}l._nodesModel=[];if(l.model){var j=l.model.getChildren();j.forEach(function(m){e.call(l,m)});var k=l.model?(l.model._treeDocument||l.model.getTreeDocument()):undefined;if(k){k.onNodeModelUpdate(function(m){if(!m||!m.target||!m.target.options||!m.target.options.grid){return}var o=g.call(l._nodesModel,m.target);if(o&&o.item&&o.item.panel){var n=m.target.options;if(n.label!==o.item.panel.title){o.item.panel.title=n.label}if(n.icons&&n.icons[0]!==o.item.panel.icon){o.item.panel.icon=n.icons[0]}}});k._bindEventOnDocument("addChild",function(m){if(!m||!m.data||!m.data.nodeModel||m.data.nodeModel._nodeDepth!==l._modelDepth){return}e.call(l,m.data.nodeModel)});k._bindEventOnDocument("removeChild",function(m){if(!m||!m.data||!m.data.nodeModel||!m.parent||m.parent._nodeDepth!==l._modelDepth-1){return}h.call(l,m.data.nodeModel)})}}},_applyProperties:function(j){this._parent(j);if(this.isDirty("model")){this._applyModel()}},setContent:function(l,k){var j=g.call(this._nodesModel,l);if(j&&j.item&&j.item.panel){j.item.panel.content=k;j.item.content=k}}});return a});define("DS/Tree/commands/TreeListViewCommands",["DS/Utilities/Dom"],function(a){return{"treelistview:collapse-all-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===true){this._keymapManager.wait();d._modelEvents.subscribe({event:"postCollapseAll"},function(){c._keymapManager.listen()});d.collapseAll()}},"treelistview:expand-all-node":function(b){var d=this.getActiveNode();var c=this;if(d.isExpanded()===false){this._keymapManager.wait();d.expandAll({onExpandComplete:function(){c._keymapManager.listen()}})}},"treelistview:expand-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===false){this._keymapManager.wait();d.onPostExpand(function(){c._keymapManager.listen()});d.expand()}},"treelistview:collapse-node":function(b){var d=this.getActiveNode();var c=this;if(d.hasChildren()&&d.isExpanded()===true){this._keymapManager.wait();d.onPostCollapse(function(){c._keymapManager.listen()});d.collapse()}},"treelistview:toggle-selection":function(b){var c=this;var d=this.getActiveNode();if(d){d.selectionChangeIsFromUI();d.withTransactionUpdate(function(){var e=c.getNodesXSO();if(e.isIn(d)){e.remove(d)}else{e.add(d)}})}},"treelistview:edit-label":function(b){var e=this.getActiveNode();var c=this;var d=c._getCellView(e._getRowID(),"tree");if(d){d.switchToWriteView()}},"treelistview:edit-cancel":function(b){var c=this;if(c._listOfEditedCells.length>0){c._listOfEditedCells[0].cellView._cancelChanges()}c._giveFocus(true)},"treelistview:go-to-next-cell-and-focus":function(){var e=this;var d=e._keymapManager._getCurrentEvent();if(d){d.preventDefault();console.log("prevent default tab")}var b=a.firstParentWithClass(document.activeElement,"wux-datagrid-cell");if(b){var f=b.dsView.getCellInfos();var c=function(n){var j=e.getNumberOfColumns();var g=n.virtualRowID*j+n.virtualColumnID+1;var l=Math.floor(g/j);var i=g%j;console.log("-");console.log("current cell in focus",n.virtualRowID,n.virtualColumnID);console.log("next cell in focus",g,":",l,i);var k=e._getCellView2(l,i);var h=e.getCellPosition(l,i);if(k){var m=k.getContent().querySelector(".wux-controls-abstract");if(m){console.log("-->",m);m.dsModel._giveFocus()}else{console.log("-->",k.elements.container);k.getContent().focus()}if(a.firstParentWithClass(document.activeElement,"wux-datagrid-cell")===b){c({virtualRowID:l,virtualColumnID:i})}}console.log("next cell in focus",document.activeElement)};c(f)}else{console.log("no cell")}},"treelistview:select-all":function(){this.selectAllVisibleNodes();return{preventDefault:true}},"treelistview:unselect-all":function(){this.unselectAll();return{preventDefault:true}},"treelistview:go-to-last-visible-node":function(){var d=this;var p=d._keymapManager._getCurrentEvent();var b=d.getNodesXSO();var m=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){m=true}if(p.shiftKey){o=true}}var e=d.getActiveNode();var f=d.getScroller();var q=d.getCellsContainerSize();var k,l;d.prepareUpdateView();k=o?d._activeNodeAtShift:e;while(k){l=k;k=k.getNextVisibleNode();if(o===true){b.add(l)}}if(o){var i=[];var n=e._getRowID();var j=l._getRowID();var c=d._activeNodeAtShift._getRowID();var h=((j-c)*(n-c)<=0)?e:undefined;var g=undefined;while(h&&h!==d._activeNodeAtShift){g=h;if(g&&g.isSelected()&&h!==l){i.push(g)}if(n>j){h=h.getPreviousVisibleNode()}else{h=h.getNextVisibleNode()}}if(i.length>0){b.remove(i)}}if(o===false&&m===false){b.empty()}if(m===false){b.add(l)}d.setActiveNode(l);if(!o){d._activeNodeAtShift=l}d.pushUpdateView();f.getContent().scrollTop=q.height},"treelistview:go-to-first-visible-node":function(){var d=this;var p=d._keymapManager._getCurrentEvent();var b=d.getNodesXSO();var m=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){m=true}if(p.shiftKey){o=true}}var e=d.getActiveNode();var f=d.getScroller();var k,l;d.prepareUpdateView();k=o?d._activeNodeAtShift:e;while(k){l=k;k=k.getPreviousVisibleNode();if(o===true){b.add(l)}}if(o){var i=[];var n=e._getRowID();var j=l._getRowID();var c=d._activeNodeAtShift._getRowID();var h=((j-c)*(n-c)<=0)?e:undefined;var g=undefined;while(h&&h!==d._activeNodeAtShift){g=h;if(g&&g.isSelected()&&h!==l){i.push(g)}if(n>j){h=h.getPreviousVisibleNode()}else{h=h.getNextVisibleNode()}}if(i.length>0){b.remove(i)}}if(o===false&&m===false){b.empty()}if(m===false){b.add(l)}d.setActiveNode(l);if(!o){d._activeNodeAtShift=l}d.pushUpdateView();f.getContent().scrollTop=0},"treelistview:go-to-next-page-node":function(){var f=this;var p=f._keymapManager._getCurrentEvent();var e=f.getNodesXSO();var n=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){n=true}if(p.shiftKey){o=true}}var g=f.getActiveNode();var i=f.getScroller();var j=f.getViewportDimensions();var d=f.getCellsContainerSize().width>j.width?20:0;var l,m,k,h,b;f.prepareUpdateView();l=g;if(o===false&&n===false){e.empty()}k=g._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);var c=j.height-(h+b-f.getScrollerPosition().y);if(c<b){c=j.height}while(c>0&&l){m=l;l=l.getNextVisibleNode();if(l){k=l._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);c=c-b;if(o===true){if(l._getRowID()>f._activeNodeAtShift._getRowID()){e.add(m)}else{e.remove(m)}}}}k=m._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);if(n===false){e.add(m)}f.setActiveNode(m);if(!o){f._activeNodeAtShift=m}f.pushUpdateView();i.getContent().scrollTop=h-j.height+b+d+4},"treelistview:go-to-previous-page-node":function(){var f=this;var p=f._keymapManager._getCurrentEvent();var e=f.getNodesXSO();var n=false,o=false;if(p){p.preventDefault();if(p.ctrlKey){n=true}if(p.shiftKey){o=true}}var g=f.getActiveNode();var i=f.getScroller();var j=f.getViewportDimensions();var d=f.getCellsContainerSize().width>j.width?20:0;var l,m,k,h,b;f.prepareUpdateView();l=g;console.log("active node is ",l.getLabel());if(o===false&&n===false){e.empty()}k=g._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);var c=(h-f.getScrollerPosition().y);if(c<b){c=j.height}while(c>=0&&l){m=l;l=l.getPreviousVisibleNode();if(l){k=l._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);c=c-b;if(o===true){if(l._getRowID()<f._activeNodeAtShift._getRowID()){e.add(m)}else{e.remove(m)}}}}k=m._getRowID();h=f.getRowPosition(k);b=f.getRowHeight(k);if(n===false){e.add(m)}f.setActiveNode(m);if(!o){f._activeNodeAtShift=m}f.pushUpdateView();i.getContent().scrollTop=h},"treelistview:go-to-next-node":function(c){var e=this.getActiveNode();var d=this;if(e){if(e.getChildren()){if(!e.isExpanded()){this._keymapManager.wait();e.onPostExpand(function(){d._keymapManager.listen()});e.expand()}else{var b=e.getNextVisibleNode();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}}else{var b=e.getNextVisibleNode();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}}},"treelistview:go-to-previous-parent-node":function(c){var e=this.getActiveNode();var d=this;if(e){if(e.isExpanded()){d._keymapManager.wait();e.onPostCollapse(function(){d._keymapManager.listen()});e.collapse();var f=d._shouldBeSelected(e);if(f){d.getNodesXSO().unique(e)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(e)}else{if(!e.isRoot()){var b=e.getParent();if(b){var f=d._shouldBeSelected(b);if(f){d.getNodesXSO().unique(b)}else{d.getNodesXSO().empty()}d._setActiveAndScrollToNode(b)}}else{d._goToNode(e,-1)}}}},"treelistview:go-to-previous-visible-node":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,-1)},"treelistview:go-to-next-visible-node":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,+1)},"treelistview:go-to-previous-visible-node-no-empty-xso":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,-1,1)},"treelistview:go-to-next-visible-node-no-empty-xso":function(b){var d=this.getActiveNode();var c=this;this._keymapManager.wait();c._goToNode(d,+1,1)}}});define("DS/Tree/TreeDocument",["DS/TreeModel/TreeDocument"],function(a){return a});define("DS/Tree/TabMdlView",["DS/Controls/Abstract","DS/Controls/Tab","DS/TreeModel/TreeNodeModel",],function(h,f,g){function b(k){for(var j=0;j<this.length;j++){if(this[j].nodeModel===k){return{index:j,item:this[j]}}}}function e(k){for(var j=0;j<this.length;j++){if(this[j].value===k){return this[j]}}}function d(k){for(var j=0;j<this.length;j++){if(this[j].button===k){return this[j]}}}function a(j){var i=this._tab.addTab(j.options.label,new UWA.createElement("div"),undefined,true,undefined,(j.options.icons&&j.options.icons.length>0)?j.options.icons[0]:undefined);this._nodesModel.push({value:i.value,button:i.button,nodeModel:j})}var c=h.inherit({name:"TabMdlView",_tab:undefined,_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel"}},buildView:function(){this._parent();this._tab=new f({multiSelFlag:true,displayStyle:"panel",showComboBoxFlag:true});if(this._tab.tabBar){this._tab.tabBar.editableFlag=true}this._tab.inject(this.elements.container)},_applyModel:function(){var k=this;if(!k._tab){return}k._tab.clear();k._nodesModel=[];if(k.model){var i=k.model.getChildren();if(i&&i.length>0){i.forEach(function(l){a.call(k,l)})}var j=k.model?(k.model._treeDocument||k.model.getTreeDocument()):undefined;if(j){j.onNodeModelUpdate(function(l){if(!l||!l.target||!l.target.options||!l.target.options.grid){return}var n=b.call(k._nodesModel,l.target);if(n&&n.item&&n.item.button){var m=l.target.options;if(m.label!==n.item.button.label){n.item.button.label=m.label}if(m.icons&&m.icons[0]!==n.item.button.icon){n.item.button.icon=m.icons[0]}}});j._bindEventOnDocument("addChild",function(l){if(!l||!l.data||!l.data.nodeModel||l.data.nodeModel._nodeDepth!==k._modelDepth){return}a.call(k,l.data.nodeModel)});j._bindEventOnDocument("removeChild",function(l){if(!l||!l.data||!l.data.nodeModel||!l.parent||l.parent._nodeDepth!==k._modelDepth-1){return}var m=b.call(k._nodesModel,l.data.nodeModel);if(m&&m.item){k._tab.removeTabContent(m.item.value);k._nodesModel.splice(m.index,1)}})}}},_applyProperties:function(i){this._parent(i);if(this.isDirty("model")){this._applyModel()}},setContent:function(k,j){var i=b.call(this._nodesModel,k);if(i&&i.index!==undefined&&this._tab){this._tab.setPageContentFromIndex(i.index,j);i.item.content=j}},getNodeContent:function(j){var i=b.call(this._nodesModel,j);if(i&&i.index!==undefined&&this._tab){return this._tab.getPageContentFromIndex(i.index)}return null},handleEvents:function(){var j=this;j.elements.container.addEventListener("change",function(k){if(k&&k.target&&k.target.dsModel&&k.target.dsModel===j._tab&&!j._lockUpdate){var l=k.target.dsModel.value}});if(j._tab){var i=j._tab.tabBar;if(i){i.onEndEditTab(function(k){if(!k||!k.button){return}var l=d.call(j._nodesModel,k.button);if(l){l.nodeModel.updateOptions({label:k.button.label})}})}}}});return c});define("DS/Tree/TreeNodeView",["UWA/Core","DS/Spreadsheet/CellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/Controls/TooltipModel"],function(f,i,g,b,a,j,h){var o=false;var e=300;var d={};var l=function(u,s,v){var r=window.getComputedStyle(s,null).getPropertyValue("font-size");var t=parseFloat(r);var q=new f.Element("span",{styles:{opacity:1,fontSize:t,padding:5}}).inject(s,"top");if(j.getUnsafeHTMLContentValueToApply(v)===true){q.innerHTML=u}else{q.innerText=u}var p=q.offsetWidth;q.remove();return p};var c=function(r,q){var p=r;if(p){var s=(" "+p.className+" ").replace(/[\n\t]/g," ").indexOf(" "+q+" ")>-1;if(s){return p}else{return c(p.parentNode,q)}}};function k(p){return p.charAt(0).toUpperCase()+p.slice(1)}function n(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var p=window.getSelection();p.removeAllRanges()}}}var m=i.extend({defaultOptions:{width:"100%"},init:function(p){this._parent(p);this._cachedIcons=[];this._hasIcons=false;this._modelEvents=new b({parent:this.getGridEngine()._modelEvents,target:this});this.elements.container.addClassName("wux-layouts-treeview-cell");this.elements.layout=new f.Element("ul",{"class":"wux-ui-stack-h",styles:{height:"100%",display:"block",position:"relative"}}).inject(this.elements.container);this.elements.linksContainer=new f.Element("li",{"class":"wux-layouts-treeview-links"}).inject(this.elements.layout);this.elements.nodeContainer=new f.Element("li",{"class":"wux-layouts-treeview-node"}).inject(this.elements.layout);this.elements.expanderContainer=new f.Element("li",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.nodeContainer);this.elements.iconsContainer=new f.Element("li",{"class":"wux-layouts-treeview-icons"}).hide().inject(this.elements.nodeContainer);this.elements.badgeTopRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right"}).inject(this.elements.iconsContainer);this.elements.badgeTopLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-top-left"}).inject(this.elements.iconsContainer);this.elements.badgeBottomRight=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right"}).inject(this.elements.iconsContainer);this.elements.badgeBottomLeft=new f.Element("li",{"class":"wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-left"}).inject(this.elements.iconsContainer);this.elements.labelContainer=new f.Element("li",{"class":"wux-layouts-treeview-label"}).inject(this.elements.nodeContainer);this._observeEvents()},destroy:function(){if(this._cellInfos){this._cellInfos.nodeModel=null;this._cellInfos=null}this._parent()},_resetCell:function(){a.empty(this.elements.container);this.elements.container.setStyle("padding-left","");this.unsetBadges();var p=this.getCellInfos();if(!p.isHeader&&p.dataIndex==="tree"){}this._parent()},_observeEvents:function(){var t=this;var w=0;var s;var r=false;this.elements.container.addEvent(g.POINTERDOWN,function p(x){a._increaseCurrentPositionInStack(t.elements.container);r=false;if(!g.isTouchEvent(x)){r=t._uiNodeUpForTouchOrDownForMouse(x,"down")}a._decreaseCurrentPositionInStack()});this.elements.container.addEvent("click",function q(y){a._pushUserInteractionContext();var x=t.getGridEngine();var z=t.getCellInfos();var A=z.nodeModel;if(!r&&z.isHeader===false&&z.dataIndex!=="selection"){t._uiNodeUpForTouchOrDownForMouse(y,"up")}r=false;if(s!==undefined){clearTimeout(s)}s=setTimeout(function(){w=0},e);w++;if(y.which===1){if(w===1||g.isTouchEvent(y)&&y.detail===0){var z=t.getCellInfos();t.getGridEngine()._recordInteractionFromUI({event:"node:click",data:{nodeRecordPath:z.nodeModel&&z.nodeModel.getStructurePath?z.nodeModel.getStructurePath():z.nodeModel,virtualRowID:z.virtualRowID,virtualColumnID:z.virtualColumnID}});t.getGridEngine()._modelEvents.publish({event:"nodeclick",data:z})}if(w===2){t.getGridEngine()._modelEvents.publish({event:"nodeDblClick",data:t.getCellInfos()})}}a._popUserInteractionContext()});this._eventDetailDown=0;this._eventDetailDownTO;var u=function(x){a._pushUserInteractionContext();if(x.type==="touchend"){x.preventDefault()}if(x.which===1||x.type==="touchend"){t._uiExpandCollapse()}a._popUserInteractionContext()};this.elements.expanderContainer.addEvent("mouseup",u);this.elements.expanderContainer.addEvent("touchend",u);var v=function(x){x.stopPropagation();x.preventDefault()};this.elements.expanderContainer.addEventListener("contextmenu",v);this.elements.expanderContainer.addEventListener(g.LONGHOLD,v)},_uiNodeUpForTouchOrDownForMouse:function(y,s){var A=this;var z=false;var w=A.getGridEngine().options.selection.canMultiSelect&&(y.ctrlKey||A.getGridEngine().isInMultiSelection());var p=A.getGridEngine().options.selection.canMultiSelect&&y.shiftKey&&A.getGridEngine().options.selection.enableListSelection;if(y.which===1||y.type==="touchstart"){if(!y.target.classList.contains("wux-layouts-treeview-expander")&&!c(y.target,"wux-controls-toggle")){var B=A.getCellInfos();var t=A.getGridEngine();var v=t.getDocument();if(B.isHeader===false&&t.options.selection.cells===false){var q=B.nodeModel;if(!p){t._activeNodeAtShift=q}if(t.options.selection.nodes){if(t.options.selection.toggle){if(q.isSelected()){if(s==="up"){A.__unselectNode(q);z=true}}else{A.__selectNode(q,!w);z=true}}else{if(p){var r=v.getXSO().get();var u;if(r.length===0){u=v.getChildren()[0]}else{if(t._getParent().options.enableActiveUI===true){u=t._activeNodeAtShift?t._activeNodeAtShift:t.getActiveNode()}else{u=r[0]}}var x=q;if(u._getRowID()<x._getRowID()){v.withTransactionUpdate(function(){if(!y.ctrlKey){v.getXSO().empty()}var D=[];for(var C=u._getRowID();C<=x._getRowID();C++){var E=t.getTreeNodeModelFromRowID(C);if(v.options.shouldBeSelected.call(v,E)){D.push(E)}}A.__selectNodes(D);z=true})}else{v.withTransactionUpdate(function(){if(!y.ctrlKey){v.getXSO().empty()}var D=[];for(var C=u._getRowID();C>=x._getRowID();C--){var E=t.getTreeNodeModelFromRowID(C);if(v.options.shouldBeSelected.call(v,E)){D.push(E)}}A.__selectNodes(D);z=true})}}else{if(q.isSelected()){if(w){if(g.isTouchEvent(y)&&q.getTreeDocument().getXSO().get().length>0&&q.getTreeDocument().getXSO().isIn(q)){A.__unselectNode(q);z=true}else{if(s==="up"){A.__unselectNode(q);z=true}}}else{if(q.getTreeDocument().getXSO().get().length===0){A.__selectNode(q);z=true}else{if(s==="up"&&q.getTreeDocument().getXSO().get().length>1){A.__selectNode(q,!w);z=true}}}}else{A.__selectNode(q,!w);z=true}}}}}}}return z},_uiExpandCollapse:function(){var p=this;p.getGridEngine()._giveFocus();var r=p._cellModel.getCellContent();if(r.getChildren()){if(p._expandState!=="noExpandState"&&p._expandState!=="expandingState"){if(r.isExpanded()&&r._expandState!=="partiallyExpandedState"){r.collapse()}else{p._setExpanderState("expandingState");r.expand()}}}var q=p.getCellInfos();p.getGridEngine()._recordInteractionFromUI({event:"node:expand-collapse",data:{nodeRecordPath:q.nodeModel?q.nodeModel.getStructurePath():q.nodeModel,virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})},_isSelected:function(){var p=this.getCellInfos();return p.manager.getNodesXSO().isIn(p.nodeModel)},__selectNodes:function(p){var q=this.getCellInfos();if(p&&p.length>0){p.forEach(function(r){r.selectionChangeIsFromUI()});q.manager.getNodesXSO().add(p);p.forEach(function(r){q.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:r.getStructurePath(),virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})});this.getGridEngine().setActiveNode(p[p.length-1])}},__selectNode:function(p,r){var s=this.getCellInfos();var q=s.manager._shouldBeSelected(s.nodeModel);if(p&&q){p.selectionChangeIsFromUI();if(r){p.withTransactionUpdate(function(){s.manager.getNodesXSO().unique(p)});s.manager._recordInteractionFromUI({event:"selection:unique",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:s.virtualRowID,virtualColumnID:s.virtualColumnID}})}else{p.withTransactionUpdate(function(){s.manager.getNodesXSO().add(p)});s.manager._recordInteractionFromUI({event:"selection:add",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:s.virtualRowID,virtualColumnID:s.virtualColumnID}})}}this.getGridEngine().setActiveNode(p)},__unselectNodes:function(p){var q=this.getCellInfos();if(p&&p.length>0){p.forEach(function(r){r.selectionChangeIsFromUI()});q.manager.getNodesXSO().remove(p);p.forEach(function(r){q.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:r.getStructurePath(),virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID}})});this.getGridEngine().setActiveNode(p[p.length-1])}},__unselectNode:function(p){var r=this.getCellInfos();var q=r.manager._shouldBeSelected(r.nodeModel);if(p&&q){if(r.manager.getNodesXSO().isIn(p)===true){p.selectionChangeIsFromUI();p.withTransactionUpdate(function(){r.manager.getNodesXSO().remove(p)});r.manager._recordInteractionFromUI({event:"selection:remove",data:{nodeRecordPath:p.getStructurePath(),virtualRowID:r.virtualRowID,virtualColumnID:r.virtualColumnID}})}}},getCellInfos:function(){if(!this._cellInfos){this._cellInfos=this._parent();if(this._cellInfos.dataIndex==="tree"&&this._cellInfos.virtualRowID>=0){this._cellInfos.nodeView=this;if(this._cellInfos.cellModel){this._cellInfos.nodeModel=this._cellInfos.cellModel.getCellContent()}}else{this._cellInfos.nodeModel=this._cellInfos.manager.getTreeNodeModelFromRowID(this._cellInfos.virtualRowID)}}return this._cellInfos},_updateToolTip:function(){var r=this.getCellInfos();var p=this.elements;var q=this._getParentView().options.shouldDisplayTooltip?this._getParentView().options.shouldDisplayTooltip(r):false;if(q===false){p.container.setAttribute("title","")}if(q){if(r.dataIndex==="tree"&&!r.isHeader){this._setTooltip(p.container,{shortHelp:""});this._setTooltip(p.labelContainer,q);this._setTooltip(p.iconsContainer,q)}else{if(r.cellModel.options.value){if(typeof r.cellModel.options.value==="string"){this._setTooltip(p.container,q)}else{if(r.cellModel.options.value.toString){this._setTooltip(p.container,q)}else{this._setTooltip(p.container,q)}}}else{this._setTooltip(p.container,q)}}}else{this._setTooltip(p.container,{shortHelp:""})}},_setTooltip:function(q,p){if(p.longHelp){p.shortHelp=p.longHelp;p.longHelp=""}q.tooltipInfos=new h(p)},updateInternalParameters:function(){var r=this.getCellInfos();var q=this.elements;this._dataGrid=this.options.parent;this._manager=r.manager;this._cellModel=r.cellModel;if(!r.isHeader){r.cellModel._isInWriteMode=false}this._updateToolTip();if(!r.isHeader&&r.nodeModel){var p=r.manager._isCellEditable(r);q.container.setAttribute("is-editable",p);if(r.nodeModel.isMatchingSearch()){q.labelContainer.addClassName("wux-ui-state-match");this._hasBeenMatchedForSearch=true}else{if(this._hasBeenMatchedForSearch){q.labelContainer.removeClassName("wux-ui-state-match");this._hasBeenMatchedForSearch=false}}}this._parent();var s=this._getParentView().options.selection.preSelection?this._getParentView().options.selection.preSelection:false;if(s){this.getContent().removeClassName("wux-datagrid-cell-prehighlighted")}this.getContent().removeClassName("wux-datagrid-cell-highlighted");if(r.virtualRowID>-1){if(s){if(r.nodeModel&&r.nodeModel.isPreSelected()){this.getContent().addClassName("wux-datagrid-cell-prehighlighted")}}if(this._isSelected()||this._isHighlighted){this.getContent().addClassName("wux-datagrid-cell-highlighted")}}},_getParentView:function(){return this.getGridEngine()._getParent()},_getNodeModel:function(){var p=this.getVirtualCoordinates();return this._manager.getCell(p.virtualRowID,"tree").getCellContent()},_getRelativeIncrementFactor:function(p){return 25},_setDepth:function(y){var B=this.getCellInfos();var A=B.nodeModel;var v=B.manager;var p=this.elements;if(y===undefined){y=A.getParents().length}var t=20;var z=25;p.container.setStyle("padding-left",t);var s=0;if(v.options.performances.buildLinks){var r="";var x,u,C,q;var w="<span>";for(x=0;x<y;x++){var z=this._getRelativeIncrementFactor(x);s=s+z;q=A.getNthParent((y-1)-x);u=((q&&q.isLastChild()&&(x<=y-2)))?"border-color:transparent":"";C=((x===y-1)&&A.isLastChild())?"50%":"100%";r=r+u+C;w=w+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((A.getParent()&&A.getParent().isLastChild()&&x<=y-1)?"true":"false")+'" data-islastchild="'+(A.isLastChild()?"true":"false")+'" data-depth="'+(x+"/"+(y-1))+'" style="'+u+";height: "+C+";margin-right:"+(((x===y-1)?0:z)-1)+"px;margin-left:"+(x===0?z:0)+'px"></li>'}w=w+"</span>";if(d[r]===undefined){p.linksContainer.innerHTML=w;d[r]=w;p.linksContainer.inject(this.elements.layout,"top")}else{p.linksContainer.innerHTML=d[r]}p.linksContainer.setStyle("width",s);p.nodeContainer.setStyle("left",s)}else{for(var x=0;x<y;x++){var z=this._getRelativeIncrementFactor(x);s=s+z}p.linksContainer.setStyle("width",s);p.nodeContainer.setStyle("left",s)}this._nodeOffsetX=s+t+2;p.container.setAttribute("data-node-depth",y)},_updateView:function(){var q=this.getCellInfos();var p=q.cellModel;var r=q.nodeModel;if(p._isInWriteMode){if(this._dataGrid.options.enableDragAndDrop===true){this.getContent().setAttribute("draggable",false)}if(q.dataIndex==="tree"&&!q.isHeader){r.options.oldLabel=r.options.label}this._buildWriteView()}else{if(this._dataGrid.options.enableDragAndDrop===true){this.getContent().setAttribute("draggable",true)}this._buildReadView()}},_setExpanderState:function(p){if(p){var q={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed",noChildren:"noChildren",expanding:"expanding",partiallyExpanded:"partiallyExpanded",expanded:"expanded",collapsed:"collapsed"};this.elements.expanderContainer.setAttribute("data-wux-state",q[p])}},notifyModelUpdate:function(){this._getNodeModel().notifyModelUpdate();this._parent()},_cancelChanges:function(){this._getNodeModel().options.label=this._getNodeModel().options.oldLabel;this.switchToReadView()},setLabel:function(r){var u=this;function p(w){w.preventDefault();w.stopPropagation();w.stopImmediatePropagation();u.elements.container.scrollLeft=0;return false}function s(w){if(u.isInEditionMode()){n();if(u._cellReadWriteView&&u._cellReadWriteView.value!==u._getNodeModel().options.label&&u._cellWriteModel===u._getNodeModel()){u._getNodeModel().options.label=u._cellReadWriteView.value;u.notifyModelUpdate()}u.switchToReadView();setTimeout(function(){u.getGridEngine()._giveFocus()},1)}document.body.removeEventListener(g.POINTERDOWN,s);u._cellWriteModel=undefined}if(this.isInEditionMode()){var q=new f.Element("input",{type:"text",value:r,tabindex:"-1","class":"wux-tree-label-input wux-ui-state-clearable",styles:{"box-sizing":"border-box"},events:{dragstart:function(w){w.preventDefault();w.stopPropagation()},keypress:function(w){u.elements.container.scrollLeft=0},keydown:function(w){t(true)},keyup:function(w){u.elements.container.scrollLeft=0},change:function(w){},focusin:function(w){w.preventDefault()},focus:function(w){w.preventDefault();w.stopPropagation()},mousemove:function(w){if(this.offsetWidth-18<w.clientX-this.getBoundingClientRect().left){this.style.cursor="default"}else{this.style.cursor="text"}},click:function(w){w.stopPropagation();if(this.offsetWidth-26<w.clientX-this.getBoundingClientRect().left){this.value=u._getNodeModel().options.label;u.switchToReadView();u._lastClickTime=Date.now()}},mouseup:function(w){w.stopPropagation()},mousedown:function(w){w.stopPropagation()},touchstart:function(w){w.stopPropagation()},touchend:function(w){w.stopPropagation()}}});var t=function(w){if(u._cellReadWriteView){u.elements.container.scrollLeft=0;var y=u.elements.nodeContainer.getDimensions().width-u.elements.expanderContainer.getDimensions().width-u.elements.iconsContainer.getDimensions().width-24;var x=(l(q.value+" ",u.elements.labelContainer,u.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(u.getCellInfos()))+20);q.style.width=x+"px";q.style.maxWidth=y+"px";if(!w){u._cellReadWriteView.setSelectionRange(0,u._cellReadWriteView.value.length)}}};q.addEventListener("compositionupdate",function(){t(true)});u.elements.container.addEventListener("scroll",p,true);u.elements.container.scrollLeft=0;setTimeout(function(){t()},0);this.elements.labelContainer.innerHTML="";this.elements.labelContainer.setContent(q);this._cellReadWriteView=q;this._cellWriteModel=this._cellInfos.nodeModel;q.focus();document.body.addEventListener(g.POINTERDOWN,s)}else{u.elements.container.removeEventListener("scroll",p);if(typeof r==="number"){r=r.toString()}this.elements.labelContainer.layoutDsModel=this._dataGrid;var v=this.getCellInfos();if(j.getUnsafeHTMLContentValueToApply(this.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(v))===false){this.elements.labelContainer.setText(r)}else{this.elements.labelContainer.setContent(r)}}},unsetBadges:function(){this.elements.badgeTopLeft.style.backgroundImage="";this.elements.badgeTopLeft.style.visibility="hidden";this.elements.badgeBottomLeft.style.backgroundImage="";this.elements.badgeBottomLeft.style.visibility="hidden";this.elements.badgeTopRight.style.backgroundImage="";this.elements.badgeTopRight.style.visibility="hidden";this.elements.badgeTopRight.className="";this.elements.badgeTopRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-top-right");this.elements.badgeBottomRight.style.backgroundImage="";this.elements.badgeBottomRight.style.visibility="hidden";this.elements.badgeBottomRight.className="";this.elements.badgeBottomRight.addClassName("wux-layouts-treeview-badge wux-layouts-treeview-badge-bottom-right")},setBadges:function(p){for(var r in p){var q=p[r];if(q){a.generateIcon(q,{target:this.elements["badge"+k(r)]});this.elements["badge"+k(r)].style.visibility="visible"}}},setIcons:function(r){var s=this;var q=0;this._removeAllIcons();if(r){if(Array.isArray(r)){this._icons=f.clone(r);if(r){var p=document.createDocumentFragment();r.forEach(function(t){var u=m._buildIcon(t);s._cachedIcons.push(u);p.appendChild(u)});this.elements.iconsContainer.appendChild(p)}q=r.length}if(typeof r==="string"){q=1;s.addIcon(r,"css")}}this.elements.iconsContainer.setAttribute("wux-has-icon",q>0);if(!this._hasIcons){this.elements.iconsContainer.style.display="inline-flex";this._hasIcons=true}},select:function(){this._lastClickTime=Date.now();this._parent()},addIcon:function(q,p){var r=m._buildIcon(q,p);this._cachedIcons.push(r);this.elements.iconsContainer.appendChild(r)},_removeAllIcons:function(){this.elements.iconsContainer.removeAttribute("wux-icon-name");this._cachedIcons.forEach(function(p){if(p.parentNode){p.parentNode.removeChild(p)}});this._cachedIcons=[]}});m._buildIcon=function(q,p){var r=a.createElement("div",{"class":"wux-layouts-treeview-icon"});switch(p){case"css":r.setAttribute("icon-type","css");r.setAttribute("wux-icon-name",q);break;default:if(typeof q==="string"){r.setAttribute("icon-type","css");r.style.backgroundImage="url("+q+")"}else{r.setAttribute("icon-type","fonticon");r.appendChild(a.generateIcon(q))}break}return r};return m});define("DS/Tree/AccordionMdlView",["DS/Controls/Abstract","DS/Controls/Accordeon","DS/TreeModel/TreeNodeModel",],function(g,e,f){function b(j){for(var h=0;h<this.length;h++){if(this[h].nodeModel===j){return{index:h,item:this[h]}}}}function d(j){for(var h=0;h<this.length;h++){if(this[h].id===j){return this[h]}}}function a(h){if(this._accordion){var i=this._accordion.addItem({header:h.options.label,icon:(h.options.icons&&h.options.icons.length>0)?h.options.icons[0]:undefined});this._nodesModel.push({id:i,nodeModel:h})}}var c=g.inherit({name:"AccordionMdlView",_accordion:undefined,_lockUpdate:false,_modelDepth:0,_nodesModel:[],publishedProperties:{model:{defaultValue:undefined,type:"DS/TreeModel/TreeNodeModel"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"}},buildView:function(){this._parent();this._accordion=new e({exclusive:false});this._accordion.inject(this.elements.container)},_applyModel:function(){var j=this;if(!j._accordion){return}j._accordion.clear();j._nodesModel=[];if(j.model){var h=(j.model.getChildren()&&j.model.getChildren().length>0)?j.model.getChildren():j.model.options.asyncChildren;if(h&&h.length>0){h.forEach(function(k){a.call(j,k)})}var i=j.model?(j.model._treeDocument||j.model.getTreeDocument()):undefined;if(i){i.onNodeModelUpdate(function(k){if(!k||!k.target||!k.target.options||!k.target.options.grid){return}var n=b.call(j._nodesModel,k.target);if(n&&n.item&&j._accordion){var m=k.target.options;var l=j._accordion.getIndexFromId(n.item.id);if(l>-1){j._accordion.updateItem(l,{header:m.label,icon:(m.icons&&m.icons.length>0)?m.icons[0]:undefined,})}}});i.onPostExpand(function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.expandItem(l)}}});i.onPostCollapse(function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.closeItem(l)}}});i._bindEventOnDocument("addChild",function(k){if(!k||!k.data||!k.data.nodeModel||k.data.nodeModel._nodeDepth!==j._modelDepth){return}a.call(j,k.data.nodeModel)});i._bindEventOnDocument("removeChild",function(k){if(!k||!k.data||!k.data.nodeModel||!k.parent||k.parent._nodeDepth!==j._modelDepth-1){return}var m=b.call(j._nodesModel,k.data.nodeModel);if(m&&m.item&&j._accordion){var l=j._accordion.getIndexFromId(m.item.id);if(l>-1){j._accordion.deleteItem(l)}j._nodesModel.splice(m.index,1)}})}}},_applyStyle:function(h){this._accordion.style=this.style},_applyProperties:function(h){this._parent(h);if(this.isDirty("model")){this._applyModel()}},setContent:function(k,j){var i=b.call(this._nodesModel,k);if(i&&i.item&&this._accordion){var h={body:j};this._accordion.updateItem(this._accordion.getIndexFromId(i.item.id),h)}},handleEvents:function(){var i=this;function h(j){return function(l){if(l&&l.target&&l.target.dsModel&&l.options&&l.options.expanderIndex>-1&&!i._lockUpdate){var k=d.call(i._nodesModel,l.options.expanderIndex);if(k&&k.nodeModel){k.nodeModel[j]()}}}}i.elements.container.addEventListener("expand",h("expand"));i.elements.container.addEventListener("collapse",h("collapse"))}});return c});define("DS/Tree/TreeNavigation",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TreeBase","DS/Controls/TreeNodeBase","DS/Layouts/SlidingViews","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Layouts/ListView","DS/Tree/TreeDocument","DS/Layouts/ListViewCellAbstract","DS/CoreEvents/ModelEvents","DS/Tree/TreeNodeView"],function(g,j,h,e,l,i,b,k,a,q,d,n){function c(u){var w=u.cellInfos.cellModel||u.cellInfos.nodeModel;var s=u.controller;var r;if(w.options.isTerminal){r=w._nodeDepth}else{r=w._nodeDepth+1}var x=s.getView(r);if(!x){x=s.addView({title:g.clone(w.options.label),content:{html:null,iframe:false,onLoad:function(){}}})}u.cellInfos.node=w;u.cellInfos.nodeModel=w;u.cellInfos.page=x;if(!w.options.isTerminal){x.setBackTitle(g.clone(w.getParent().options.label));x.setTitle(g.clone(w.options.label));var v=w.getChildren();x.elements.pageContent.empty();if(w.options.content){x.addContent(w.options.content)}if(v){x._listView.inject(x.elements.pageContent);x._listView.updateModel(v)}var t=w._nodeDepth+1;s.goToNthView(t)}u.treeNavigation._modelEvents.publish({event:"SELECT",data:u.cellInfos,context:u.context})}function m(s){var r=new k({model:s.model,height:"auto",cellClass:o,defaultCellHeight:40});r.onCellRequest(function(u){var t=u.cellModel.options.label.toString();u.cellView.getContent().innerHTML=t;if(u.cellModel.options.type==="header"){u.cellView.getContent().addClassName("wux-layouts-treenavigation-header")}else{u.cellView.getContent().removeClassName("wux-layouts-treenavigation-header")}});r.onCellClick(function(t){if(t.cellModel.options.type!=="header"){if(t.cellModel.hasChildren()){t.cellModel.expand()}else{c({cellInfos:t,treeNavigation:s.treeNavigation,controller:s.controller})}}});return r}var o=q.extend({init:function(r){this._parent(r)},updateInternalParameters:function(s){var u=this.getCellInfos();var r=u.cellModel;var t=u.cellView;if(u.virtualRowID>-1&&u.virtualColumnID>-1){t.getContent().setAttribute("has-children",r.hasChildren());if(r.options.type){t.getContent().setAttribute("type",r.options.type)}else{t.getContent().removeAttribute("type")}if(r.options.keywords&&r.options.keywords.indexOf("new")>-1){t.getContent().setAttribute("is-new",true)}else{t.getContent().removeAttribute("is-new")}if(r.options.keywords&&r.options.keywords.indexOf("update")>-1){t.getContent().setAttribute("is-updated",true)}else{t.getContent().removeAttribute("is-updated")}if(r.options.keywords&&r.options.keywords.indexOf("dev")>-1){t.getContent().setAttribute("is-dev",true)}else{t.getContent().removeAttribute("is-dev")}if(r.options.keywords&&r.options.keywords.indexOf("deprecated")>-1){t.getContent().setAttribute("is-deprecated",true)}else{t.getContent().removeAttribute("is-deprecated")}}this._parent(s)}});var p=j.extend({defaultOptions:{treeNavigation:null,controller:null,model:[]},init:function(r){this._parent(r);this._buildView();this._buildListView();this.setBackTitle()},_buildListView:function(){this._listView=m({model:"value",context:this,treeNavigation:this.options.treeNavigation,controller:this.options.controller});this._listView.inject(this.elements.pageContent)},_buildView:function(){var s=this;this.elements.container=new g.Element("div",{"class":"wux-layouts-treenavigation-page-content",styles:{height:"inherit"}});this.elements.topHeader=new g.Element("ul",{"class":"wux-layouts-treenavigation-topheader"}).inject(this.elements.container);this.elements.topHeaderLeft=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-left",styles:{"float":"left"}}).inject(this.elements.topHeader);this.elements.topHeaderTitle=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-title wux-font-3dsregular"}).inject(this.elements.topHeader);this.elements.topHeaderRight=new g.Element("li",{"class":"wux-layouts-treenavigation-topheader-right"}).inject(this.elements.topHeader);this.elements.pageContent=new g.Element("div",{"class":"wux-layouts-treenavigation-pageContent"}).inject(this.elements.container);function r(t){s.options.controller.goToPreviousView()}this.elements.topHeaderLeft.addEventListener(i.POINTERUP,r)},goToChildren:function(v){var u=this;var r=u.options.controller;if(r){var w=r.getView(v._nodeDepth+1);if(!w){w=r.addView({title:g.clone(v.options.label),content:{html:null,iframe:false,onLoad:function(){}}})}w.setBackTitle(v.getParent().options.label);w.setTitle(v.options.label);var t=v.getChildren();w.elements.pageContent.empty();if(v.options.content){w.addContent(v.options.content)}else{if(t){w._listView.inject(w.elements.pageContent);w._listView.updateModel(t)}}var s=v._nodeDepth+1;r.goToNthView(s);return w}},setHTML:function(r){this.elements.pageContent.setHTML(r)},addContent:function(r){this.elements.pageContent.appendChild(r)},empty:function(){},updateLeftTitle:function(){var r=new g.Element("span",{html:this.options.leftTitle});var s=this;b.onNodeRendered(r,function(){setTimeout(function(){if(r.getDimensions().height>s.elements.topHeaderLeft.getDimensions().height){s.elements.topHeaderLeft.setStyles({lineHeight:"15px",fontSize:10})}else{s.elements.topHeaderLeft.setStyles({lineHeight:"30px",fontSize:""})}if(r.getDimensions().width>=s.elements.topHeaderLeft.getDimensions().width-5){s.elements.topHeaderLeft.setStyles({fontSize:10})}},100)});if(this.options.leftTitle&&this.options.leftTitle!==""){this.elements.topHeaderLeft.show();this.elements.topHeaderLeft.setHTML(r)}else{}},setBackTitle:function(r){this.options.leftTitle=r;this.updateLeftTitle()},setRightTitle:function(t){var r=new g.Element("span",{html:t});var s=this;b.onNodeRendered(r,function(){setTimeout(function(){if(r.getDimensions().height>s.elements.topHeaderRight.getDimensions().height){s.elements.topHeaderRight.setStyles({lineHeight:"15px",fontSize:10})}else{s.elements.topHeaderRight.setStyles({lineHeight:"30px",fontSize:""})}if(r.getDimensions().width>=s.elements.topHeaderRight.getDimensions().width-5){s.elements.topHeaderRight.setStyles({fontSize:10})}},1)});if(t){this.elements.topHeaderRight.show();this.elements.topHeaderRight.setHTML(r)}else{this.elements.topHeaderRight.hide()}},setTitle:function(r){this.elements.topHeaderTitle.setHTML(r)}});var f=j.extend({defaultOptions:{defaultCellHeight:60},init:function(r){this._parent(r);this._modelEvents=new d();this._dataModel=new a();this.elements.container=new g.Element("div",{"class":"wux-layouts-treenavigation",styles:{}});if(this.options.roots){this._dataModel.loadModel(this.options.roots);this.loadModel(this._dataModel)}},getModel:function(){return this._dataModel},loadModel:function(r){var s=this;this._dataModel=r;this._controller=new l({kinetic:false,showPager:false,pageBuilder:function(t){return new p({treeNavigation:s,controller:this})}});this._controller.getContent().setStyles({height:"inherit"});this._backID=-1;this._onBack=null;this._buildView();this._indexTree();this._getController().onViewChange(function(){s._modelEvents.publish({event:"CHANGE_PAGE"})});this._dataModel.onPostExpand(function(t){c({cellInfos:t.data,treeNavigation:s,controller:s._getController()})})},_indexNode:function(t,w,v,r){var s=this;if(v===undefined){v=[]}w++;var u=v.slice();if(r!==undefined){u.push(r);t.options["@view"]=t.getContent();t.options["@path"]=u;this._searchIndex.push(t.options)}if(t.getChildren()){w++;t.getChildren().forEach(function(y,x){s._indexNode(y,w,u,x)})}},_indexTree:function(){this._searchIndex=[];var r=this._getController().getCurrentView();this._searchResults=new g.Element("div",{"class":"wux-layouts-treenavigation-search-layer"}).hide();r.addContent(this._searchResults)},search:function(r){var s=this;var v=this._getController().getCurrentView();v.addContent(this._searchResults);if(r){this._searchResults.empty();this._searchResults.show();var u=this._dataModel.search({match:function(w){if(w.nodeModel.options.type!=="header"&&w.nodeModel.options.label.toLowerCase().indexOf(r)!==-1){return true}}});var t=m({model:u,context:this,treeNavigation:this,controller:this._controller});t.onCellClick(function(w){console.log("path",w.cellModel.getPath());s._searchResults.hide();w.cellModel.getPath().forEach(function(x){x.expand()})});t.inject(this._searchResults)}else{this._searchResults.hide()}},_getController:function(){return this._controller},_buildView:function(){this.elements.container.empty();this.elements.viewContent=new g.Element("div",{"class":"wux-layouts-treenavigation-content",html:"",styles:{height:"inherit"}}).inject(this.elements.container);this._controller.getContent().inject(this.elements.viewContent);var s=this;this._controller.addView({title:"Root",content:{html:null,iframe:false,onLoad:function(){}}});var r=s._controller.getView(0);r._listView.updateModel(this._dataModel.getRoots())},onNodeSelection:function(r){return this._modelEvents.subscribe({event:"SELECT"},function(s){r.call(this,s)})},onBack:function(r){return this._modelEvents.subscribe({event:"BACK"},r)},onPageChange:function(r){return this._modelEvents.subscribe({event:"CHANGE_PAGE"},r)},setTitle:function(r){this._dataModel._getTrueRoot().options.label=r;this._getController().getCurrentView().setTitle(r)},setRightTitle:function(r){this._getController().getCurrentView().setRightTitle(r)},_setBackID:function(r){this._backID=r},_getBackID:function(r){return this._backID}});return f});define("DS/Tree/Manager",["UWA/Core","UWA/Class","DS/Spreadsheet/Manager","DS/Tree/TreeNodeModel","DS/Utilities/Array","DS/Tree/TreeDocument","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/RAFDispatcher","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Utilities/Dom","DS/Selection/XSO","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Tree/commands/TreeListViewCommands","DS/WebRecordEnabler/Adapter","UWA/Utils/Client"],function(g,q,j,l,n,k,i,e,u,h,c,r,f,m,o,p,d,s){var b=false;var t=false;function v(z){if(!z.hasOwnProperty("offsetX")){var y=z.target||z.srcElement,x=y.getBoundingClientRect(),w=z.clientX-x.left,A=z.clientY-x.top;return{offsetX:w,offsetY:A}}else{return{offsetX:z.offsetX,offsetY:z.offsetY}}}var a=j.extend({defaultOptions:{getValue:function(w){return w.nodeModel.options.grid[w.dataIndex]},onCellChange:function(w){if(w.event.dsModel){return w.event.dsModel.value}else{return w.event.target.value}},setValue:function(x){if(x.dataIndex==="tree"){x.nodeModel.updateOptions({label:x.value})}else{var w={};w[x.dataIndex]=x.value;x.nodeModel.updateOptions({grid:w})}}},init:function(z,x){var A=this;A._parent(z,x);this._typeRepFactory=new h();A._enableDebouncedSyncModel=false;A._isInEdition=false;A._listOfEditedCells=[];A._listOfDragOveredCellView=[];A._lastClickTime=0;A._lastClickRow=-1;A._activeElement=undefined;var y=function(E,D){return E._getID()===D._getID()};var C=function(D){return D._getID()};this._listOfModifiedNodes=new f({id:"listOfModifiedNodes",publishOnlyPrePostEvents:true,getElementID:this.options.performances.renderingMode==="adaptive"?C:undefined,useUniqueID:true,areEquals:y});this._xsoNodes=new f({getElementID:C,useUniqueID:true,areEquals:y});this._pxsoNodes=new f({getElementID:C,useUniqueID:true,areEquals:y});A._numberOfVisibleNodesInDocument=0;A._syncCounter=0;A._isExpandingCounter=0;A._needFullUpdate=false;A._createDocument(x.options.treeDocument);A.registerReusableCellContent({id:"_selection",buildContent:function(){var D=new e({checkFlag:false});D.getContent().addEventListener(i.POINTERDOWN,function(E){E.stopPropagation()});D.getContent().addEventListener("focus",function(E){E.preventDefault();E.stopPropagation()});return D}});A.onCellContentChange(function(E){var D=A.getTreeNodeModelFromRowID(E.virtualRowID);if(E.dataIndex!=="tree"&&A.getColumnOptions(E.virtualColumnID)&&A.getColumnOptions(E.virtualColumnID).type!=="selection"){D.options.grid[E.dataIndex]=E.value}});this._modelEvents.subscribe({event:"active"},function B(){A._activeNode=this;A._setActiveStateForNode(this)});this._modelEvents.subscribe({event:"inactive"},function w(){A._activeNode=null;A._unsetActiveStateForNode(this)});this._managePreSelection();this._manageKeyboard()},destroy:function(){this._tree=null;this._activeNodeAtShift=null;this._activeNode=null;this._resetListOfUpdatedNodes();this._listOfModifiedNodes=null;this._keymapManager.destroy();this._keymapManager=null;this._typeRepFactory.destroy();this._typeRepFactory=null;this._updateViewOptions=null;if(this.getDocument()){this._cleanBindingOnDocument()}this._treeDocument=null;this._xsoNodes=null;this._pxsoNodes=null;this._selectedColumns=null;this._selectedRows=null;this._highlightedRows=null;this._parent()},getNodesXSO:function(){if(!this.options.selection.viewBased){return this.getDocument().getXSO()}else{return this._xsoNodes}},getNodesPXSO:function(){if(!this.options.selection.viewBased){return this.getDocument().getPXSO()}else{return this._pxsoNodes}},_observeSelMultiSel:function(){var w=this;if(!this._multiSelModeHasBeenForced){this._modeIsMultiSel=false;this._modeIsListSel=false}r.addEventOnElement(this,document,"keydown",function(y){var x=g.Event.whichKey(y);switch(x){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":w._modeIsListSel=true;if(w._allowSettingMultiSelMode&&!w._multiSelModeHasBeenForced){w._modeIsMultiSel=true}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w.getActiveNode()?w.getActiveNode().getStructurePath():undefined,modeIsListSel:true,modeIsMultiSel:true}});break;case"ctrl":if(w._allowSettingMultiSelMode&&!w._multiSelModeHasBeenForced){w._modeIsMultiSel=true}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w._activeNodeAtShift,modeIsListSel:w._modeIsListSel,modeIsMultiSel:true}});break;default:}});r.addEventOnElement(this,document,"keyup",function(y){var x=g.Event.whichKey(y);switch(x){case"alt+ctrl+shift":case"shift+alt":case"alt+shift":case"ctrl+shift":case"shift+ctrl":case"shift":if(!w._multiSelModeHasBeenForced){w._modeIsListSel=false;w._modeIsMultiSel=false}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:null,modeIsListSel:false,modeIsMultiSel:false}});break;case"ctrl":if(!w._multiSelModeHasBeenForced){w._modeIsMultiSel=false}w._recordInteractionFromUI({event:"selection:mode",data:{activeNodeAtShift:w._activeNodeAtShift,modeIsListSel:w._modeIsListSel,modeIsMultiSel:true}});break;default:}if(x==="enter"&&w._isInEdition){w._isInEdition=false}})},_managePreSelection:function(){var y=this;if(this.options.selection.preSelection){this.elements.poolContainerRel.addEvent("mouseleave",function(){y.getNodesPXSO().empty()});var z;var A=0;var x=false;var w=function(D,E){var C=y.getDocument();if(E){var B=E.nodeModel;if(E&&E.virtualRowID>-1){if(z){A=B._getRowID()-z.nodeModel._getRowID();if(A!==0||x===true){if(!y.getNodesXSO().isIn(E.nodeModel)){C.prepareUpdate();y.getNodesPXSO().unique(E.nodeModel);y.removeRowClass(z.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",true);y.addRowClass(B._getRowID(),"wux-datagrid-cell-prehighlighted",true);y._preventNextUpdateView();C.pushUpdate();x=false}else{C.prepareUpdate();y.getNodesPXSO().empty();y.removeRowClass(z.nodeModel._getRowID(),"wux-datagrid-cell-prehighlighted",true);y._preventNextUpdateView();C.pushUpdate();x=false}}}z=E}}};r.addEventOnElement(this,this,"mousemove",w);r.addEventOnElement(this,this,"mouseenter",function(){x=true})}},_goToNode:function(z,D,B){var x=this;var y;var E;if(z){if(D===1){y=z.getNextVisibleNode()}if(D===0){y=z}if(D===-1){y=z.getPreviousVisibleNode()}}if(y){if(!x._modeIsListSel){x._activeNodeAtShift=y}var C=y._getRowID();if(C>-1){var w=x.getNodesXSO();var A=x._shouldBeSelected(y);x.prepareUpdateView();if(!x.isInMultiSelection()){if(!B||A){w.empty()}if(A){w.add(y)}}if(x._modeIsListSel){if(w.get().length===0){E=null}else{if(y._getRowID()>x._activeNodeAtShift._getRowID()){E="after"}if(y._getRowID()===x._activeNodeAtShift._getRowID()){E=null}if(y._getRowID()<x._activeNodeAtShift._getRowID()){E="before"}}if(E==="after"){if(D===1){if(A){w.add(y)}}else{w.remove(z)}}if(E==="before"){if(D===-1){if(A){w.add(y)}}else{w.remove(z)}}if(E===null){w.remove(z)}}x._setActiveAndScrollToNode(y);x._keymapManager.listen();x.pushUpdateView()}}else{x._keymapManager.listen()}},_setActiveAndScrollToNode:function(z){var y=this;var E=z._getRowID();y.setActiveNode(z);var B=y.getScroller();var D=y.getViewportDimensions();var G=y.getScrollerPosition();var A=y.getRowPosition(E);var w=y.getRowHeight(E);var F=G.y;var C=F+D.height-w;var x=y.getCellsContainerSize().width>D.width?20:0;if(A>C){B.getContent().scrollTop=A-D.height+w+x+4}if(A<=F){B.getContent().scrollTop=A}},_manageKeyboard:function(){var z=this;var x=this._getParent();this._commandRegistry=new o();this._keymapManager=new m({jsModel:z,target:x.getContent(),commandsRegistry:this._commandRegistry,shouldProcessEvent:function(E){var D=E.event;var C=g.Event.whichKey(D);var B=D.target.tagName.toLowerCase();if(B==="input"||B==="textarea"){if(C==="tab"){return true}else{return false}}else{return true}}});this._keymapManager.spy(function(B){z._recordInteractionFromUI({event:"keymapmanager:dispatch-command",data:B})});if(x.options.enableActiveUI&&x.options.enableKeyboardNavigation){var w=x.options.keymaps;for(var y in w){this._keymapManager.registerKeymap(y,w[y])}for(var A in p){this._commandRegistry.registerCommand(A,p[A])}}},getCommandRegistry:function(){return this._commandRegistry},getTypeRepresentationFactory:function(){return this._typeRepFactory},getKeymapManager:function(){return this._keymapManager},_resetListOfUpdatedNodes:function(){this._listOfModifiedNodes.empty()},_listenToClickOnEmptyArea:function(){var y=this;var w=18;var x=false;this.elements.container.addEvent(i.POINTERDOWN,function(D){x=false;var C=v(D);if(D.target.className.indexOf("wux-scroller")!==-1){var B=g.extendElement(D.target).getDimensions();var A=B.width;var z=B.height;if(C.offsetX<(A-w)&&C.offsetY<(z-w)){x=true}}});this.elements.container.addEvent(i.POINTERUP,function(E){if(x){if(i.isTouchEvent(E)){if(y._preventSelectionForTouchScroll){return}}var D=v(E);if(E.target.className.indexOf("wux-scroller")!==-1){var C=g.extendElement(E.target).getDimensions();var B=C.width;var z=C.height;if(D.offsetX<(B-w)&&D.offsetY<(z-w)){var A=y.getNodesXSO();A.empty()}}}x=false})},_setRowLastClick:function(x,w){this._lastClickTime=w;this._lastClickRow=x},_getRowLastClick:function(w){return(this._lastClickRow===w)?this._lastClickTime:0},isEveryVisibleNodeSelected:function(){if(this.getNodesXSO().isEmpty()){return false}var x=0;var w=this.getNodesXSO().get();w.forEach(function(y){if(y._getRowID()!==null){x++}});return this._numberOfVisibleNodesInDocument===x},getDocument:function(){return this._treeDocument},_doesCellNeedToDisplayed:function(x){var w=x.cellModel;if(w.isMerged()){return false}else{return true}},addRow:function(x,w){if(typeof w==="number"||w===undefined){return this._parent(x,w)}else{if(w instanceof l){console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the addRow() method but use the TreeDocument or TreeNodeModel API instead");if(x instanceof Array){return w.addChild(x)}else{if(x instanceof l){return w.addChild(x)}else{return w.addChild([x])}}}}return -1},removeRow:function(w){if(w instanceof l){console.warn("[DEPRECATED]","DS/Tree/Manager","You must not use anymore the removeRow() method but use the TreeDocument or TreeNodeModel API instead");w.remove()}else{if(typeof w==="number"||w===undefined){this._parent(w)}}},moveColumn:function(y,x,w){if(typeof y==="string"){y=this.getColumnIDFromDataIndex(y)}if(typeof x==="string"){x=this.getColumnIDFromDataIndex(x)}this.prepareUpdateView();n.array2dMove(this.options.columns,y,x);this.options.model=n.array2dTranspose(this.options.model);n.array2dMove(this.options.model,y,x);this.options.model=n.array2dTranspose(this.options.model);n.array2dMove(this._listOfColumnsWidth,y,x);n.array2dMove(this._columnsList,y,x);this._needToComputeColumnReverseDataIndexes();this._freeUpPool(2);this._reflectView();this.pushUpdateView(true);this._modelEvents.publish({event:"/MANAGER/COLUMNS/MOVE",data:{fromColumnID:y,toColumnID:x}})},removeColumn:function(w){if(typeof w==="string"){w=this.getColumnIDFromDataIndex(w)}this.prepareUpdateView();this.options.columns.splice(w,1);this._needToComputeColumnReverseDataIndexes();this._freeUpPool(2);this._reflectView();this._modelEvents.publish({event:"/MANAGER/DIMENSIONS/UPDATE"});this._modelEvents.publish({event:"/MANAGER/COLUMNS/REMOVE",data:{columnID:w}});this.pushUpdateView()},_getTrueRoot:function(){return this._treeDocument._getTrueRoot()},getNthRoot:function(w){if(this._getTrueRoot().getChildren()){return this._getTrueRoot().getChildren()[w]}return null},getRoots:function(){return this._getTrueRoot().getChildren()||[]},_prepareSync:function(){this._syncCounter++},_pushSync:function(){this._syncCounter--;this._syncRowIndexes(true)},_applyCellsContainerSizeIfNeeded:function(){if(this._needToApplyCellContainerSizer===true){this._computeModelSize()}this._parent()},_nodeModelToRowModel:function(y){var w=this;var z={};var x=y._getNodeInfos();w.getColumns().forEach(function(B){var A=w._getColumnOptionValue(B.dataIndex,"getValue");x.dataIndex=B.dataIndex;if(A){z[B.dataIndex]=A.call(w,x)}});return z},_syncRowIndexes:function(){this.syncModel()},addRoot:function(x){var w=this.getDocument()._getTrueRoot().addChild(x);this._syncRowIndexes();w._tree=this._tree;return w},removeRoot:function(x){this.prepareUpdateView();var w=this.getDocument()._getTrueRoot().removeChild(x);this.pushUpdateView();return w},_bindJSEventOnDocument:function(x,y,z){var w=this.addEventListener(y,z);this._jsEventListeners.push({caller:x,eventType:y,callback:w})},_bindEventOnXSO:function(w,x){this._XSOEventListeners.push(this.getNodesXSO()[w](x))},_bindEventOnDocument:function(w,x){this._listeners.push(this.getDocument().subscribe({event:w},x))},_cleanBindingOnDocument:function(){var x=this;this._listeners.forEach(function(y){x.getDocument().unsubscribe(y)});this._jsEventListeners.forEach(function(y){y.caller.removeEventListener(y.eventType,y.callback)});var w=this.getNodesXSO();if(w){this._XSOEventListeners.forEach(function(y){w.unsubscribe(y)})}this._listeners=[];this._jsEventListeners=[];this._XSOEventListeners=[]},search:function(w){return this.getDocument().search(w)},_createDocument:function(O){var H=this;if(O){this._treeDocument=O}else{this._treeDocument=new k({useAsyncPreExpand:this._instance.options.useAsyncPreExpand})}this._treeDocument._observeEvents();this._XSOEventListeners=[];this._jsEventListeners=[];this._listeners=[];this._resetListOfUpdatedNodes();var L=0;this._bindEventOnDocument("preDestroyDocument",function(){H.unloadDocument()});this._bindEventOnDocument("nodeModelUpdate",function E(T){H._unpreventNextUpdateView();H._syncRowModelWithTreeNodeModel(T.target);if(!H._needFullUpdate){H._listOfModifiedNodes.add(T.target);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}});this._bindEventOnDocument("prepareUpdate",function A(){H.prepareUpdateView();L++});this._bindEventOnDocument("pushUpdate",function S(){H.pushUpdateView();L--;if(L<0){console.error("You pushed too many updates")}});this._bindEventOnDocument("hide",function(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("show",function(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("filter",function(){H._reflectView()});this._bindEventOnDocument("removeChild",function y(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("addChild",function J(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("empty",function G(){H._requireFullUpdate();H._reflectView()});this._bindEventOnDocument("expandStateChange",function(T){H.updateCellView(T.target._getRowID(),"tree");if(T.data.state==="partiallyExpanded"){H._reflectView()}});this._bindEventOnDocument("sortChildren",function(){H._reflectView()});["expandStateChange","matchSearch","unmatchSearch"].forEach(function(T){H._bindEventOnDocument(T,function(U){if(!H._needFullUpdate){H._listOfModifiedNodes.add(U.target)}})});["matchSearch","unmatchSearch"].forEach(function(T){H._bindEventOnDocument(T,function(){H._requireFullUpdate()})});this._bindEventOnDocument("documentPreExpandAll",function(){H.prepareUpdateView()});this._bindEventOnDocument("documentPostExpandAll",c.debounce(function(){H._reflectView();H.pushUpdateView()},10));this._bindEventOnDocument("documentPreCollapseAll",function(){H.prepareUpdateView()});this._bindEventOnDocument("documentPostCollapseAll",function(){H._reflectView();H.pushUpdateView()});function x(){if(s.Engine.ie){if(H._activeElement===H._instance.elements.container){return true}if(H._activeElement){var T=H._activeElement.parentNode;while(T){if(H._activeElement.parentNode===H._instance.elements.container){return true}T=T.parentNode}}return false}else{return false}}this._bindEventOnDocument("preExpandAll",function(T){T.target.setState({state:"expanding"});H.updateCellView(T.data.virtualRowID,"tree");H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postExpandAll",function(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preCollapseAll",function P(T){H.updateCellView(T.data.virtualRowID,"tree");H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postCollapseAll",function K(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preExpandPrivate",function N(){H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postExpand",function M(){H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("preCollapse",function F(){H.prepareUpdateView();H._activeElement=document.activeElement});this._bindEventOnDocument("postCollapse",function C(){H._updateViewOptions.generatePool=true;H._reflectView();H.pushUpdateView();if(x()){H._giveFocus(true)}H._activeElement=undefined});this._bindEventOnDocument("highlight",function D(T){var U=T.data.nodeModel;var V=U._getRowID();H.selectRow(V,false)});this._bindEventOnDocument("unhighlight",function I(T){var U=T.data.nodeModel;var V=U._getRowID();H.unselectRow(V)});var R=function(){if(H._toCellWillBeEdited){clearTimeout(H._toCellWillBeEdited);H._toCellWillBeEdited=null}};this.addEventListener("dblclick",function(T,U){R()});var z=this.getNodesXSO();this._bindEventOnXSO("onChange",function(){R()});if(this._getParent().options.enableActiveUI===false&&!this.__isComboBox__){delete z.options.getElementID}this._bindEventOnXSO("onPreEmpty",function(){H.prepareUpdateView()});this._bindEventOnXSO("onEmpty",function(){var T=H.getColumnIDFromDataIndex("selection");H.updateCellView(-1,T);H.pushUpdateView()});function B(){if(H._isPreparingView===1){var V=H.getColumnIDFromDataIndex("selection");var U=H.getCell(-1,V);if(U){var T=U.getView();if(T){H._onRequestColumnHeaderCB.call(H,T.getCellInfos())}}}}this._bindEventOnXSO("onPostAdd",B);this._bindEventOnXSO("onPostRemove",B);if(true||H.options.performances.renderingMode==="standard"){if(this._getParent().options.enableActiveUI===false&&!this.__isComboBox__){this._bindEventOnXSO("onAdd",function(T){var U=T._getRowID(false);H.prepareUpdateView();H.unselectAllColumns();if(U!==null&&U>=0){H.selectRow(U,false)}H.setActiveNode(T);if(!H._needFullUpdate&&H._isPreparingView<=2){H._preventNextUpdateView()}H.pushUpdateView()});this._bindEventOnXSO("onRemove",function(T){var U=T._getRowID();H.prepareUpdateView();H._setRowLastClick(U,0);T.unselect();H.unselectRow(U,false);H.setActiveNode(T);if(!H._needFullUpdate&&H._isPreparingView<=2){H._preventNextUpdateView()}H.pushUpdateView()})}else{this._bindEventOnXSO("onAdd",function(T){if(H.options.selection.viewBased===false){T.select()}});this._bindEventOnXSO("onPostAdd",function(U){if(U.length===0){return}H.prepareUpdateView();var T=[];U.forEach(function W(X){T.push(X._getRowID(false));if(!H._needFullUpdate&&X.isSelectionChangeFromUI()){H._preventNextUpdateView()}});H.selectRows(T,false);if(H.options.selection.preselection){H.getNodesPXSO().remove(U)}var V=U[U.length-1];H._setRowLastClick(V._getRowID(false),Date.now());H.setActiveNode(V);if(!H._needFullUpdate){H._listOfModifiedNodes.add(U);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}H.pushUpdateView()});this._bindEventOnXSO("onPostRemove",function(T){if(T.length===0){return}H.prepareUpdateView();T.forEach(function(V){var W=V._getRowID();if(V.isSelectionChangeFromUI()){H._preventNextUpdateView()}if(W!==null&&W>=0){H.unselectRow(W,false)}if(H.options.selection.viewBased===false){V.unselect()}});var U=T[T.length-1];H._setRowLastClick(-1,0);H.setActiveNode(U);if(!H._needFullUpdate){H._listOfModifiedNodes.add(T);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get())}}H.pushUpdateView()})}}else{var w=function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.prepareUpdateView();if(!H._needFullUpdate){H._listOfModifiedNodes.add(T);if(b){console.log("list of modified nodes",H._listOfModifiedNodes.get(),T.options.label)}}H.pushUpdateView()};this._bindEventOnXSO("onAdd",w);this._bindEventOnXSO("onRemove",w)}var Q=this.getNodesPXSO();Q.onAdd(function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.addRowClass(U,"wux-datagrid-cell-prehighlighted")});Q.onRemove(function(T){var U=T._getRowID(false);H._setRowLastClick(U,Date.now());H.removeRowClass(U,"wux-datagrid-cell-prehighlighted")})},pushUpdateView:function(w){if((this._isPreparingView-1)===0&&this.__mustSyncModel===true){this.__mustSyncModel=false;this.syncModel(false);this._updateViewOptions.generatePool=true}this._parent(w)},updateView:function(y){this.options.performances.minimumScrollDistance=this.options.defaultCellHeight*0.5;var z=this;if(z._toCellWillBeEdited){clearTimeout(z._toCellWillBeEdited);z._toCellWillBeEdited=null}if(!this._needFullUpdate){var B=this._listOfModifiedNodes.get();if(B.length>0){if(z.isPerformanceAnalysis()){console.time("["+z._name+"]:smart update")}z.getViewportDimensions(true);var w=z._computeVirtualViewport();this._beginUpdate();B.forEach(function x(C){var D=C._getRowID();if(D!==null&&D!==undefined&&D<=w.maxRowID&&D>=w.minRowID){z.updateRowView(D)}else{if(z.isPerformanceAnalysis()){console.log("["+z._name+"]:ignore this node outside viewport or hidden",C.getLabel(),w)}}});this._resetListOfUpdatedNodes();this._endUpdate();if(z.isPerformanceAnalysis()){console.timeEnd("["+z._name+"]:smart update")}z._needFullUpdate=false;this._updateSelectAllCheckBox();var A=this.getActiveNode();if(A){z._setActiveStateForNode(A)}else{z._unsetActiveStateForNode(A)}this._notifyUpdateViewCompleted();return}}if((this._enableDebouncedSyncModel&&!this._debounceReflectView)||(this._enableDebouncedSyncModel===false)){this._parent(y);z._needFullUpdate=false}var A=this.getActiveNode();if(A){z._setActiveStateForNode(A)}else{z._unsetActiveStateForNode(A)}this._resetListOfUpdatedNodes();this._updateSelectAllCheckBox()},needToRequestContentAt:function(w){return this._listOfModifiedNodes.get().some(function(x){return x._getRowID()===w.virtualRowID})},updateCellView:function(x,w){if(x instanceof l){this._parent(x._getRowID(),w)}else{this._parent(x,w)}},_syncRowModelWithTreeNodeModel:function(y){var x=this;var z=this._nodeModelToRowModel(y);for(var w in z){x.setCellContent(y._getRowID(),w,z[w])}},updateRowViewWithException:function(x,w){if(x!==null&&x!==undefined){if(x instanceof l){this._syncRowModelWithTreeNodeModel(x);this._parent(x._getRowID(),w)}else{this._syncRowModelWithTreeNodeModel(this.getTreeNodeModelFromRowID(x));this._parent(x,w)}this._requireFullUpdate()}},updateRowView:function(w){if(w instanceof l){this._syncRowModelWithTreeNodeModel(w);this._parent(w._getRowID(true))}else{if(w>-1){var x=this.getTreeNodeModelFromRowID(w);if(x){this._syncRowModelWithTreeNodeModel(x)}this._parent(w)}}this._requireFullUpdate()},syncModel:function(G,y){var D=this;D.onPostUpdateViewOnce(function(){D._heavyDataColumnModelRequest("syncModel")});this._requireFullUpdate();if(y===undefined){y=true}if(G===undefined){G=true}var x=this;var E=0;var F=false;var w=false;x._computeVirtualViewport();var z=x.getVirtualViewport();var C=function(){x.prepareUpdateView();x.empty();x._freeUpPool(2);x._numberOfVisibleNodesInDocument=0;F=true;if(t){console.time("sync model");console.time("sync view")}};var B=function(){x._setColumnsWidth();x.onPreUpdateViewOnce(function(){x._computeVirtualViewport()});x._debounceReflectView=null;x.pushUpdateView();w=true;if(t){console.timeEnd("sync view")}};C();var A=0;x.getDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:false,processNode:function(H){if(H.nodeModel.isVisible()&&!H.nodeModel.hasNoRepresentation()){var J=x._nodeModelToRowModel(H.nodeModel);H.nodeModel._rowID=E;x.addRow(J);var I=x.getRowHeight(E);if(I!==x.options.defaultCellHeight){x.setRowHeight(E,I,false)}if(E===0){x._listOfRowsPosition[E]=0}else{x._listOfRowsPosition[E]=A}A=A+I;if(H.nodeModel.isSelected()||H.nodeModel.isHighlighted()){x.selectRow(E,false)}if(y&&z.maxRowID===E){B()}x._numberOfVisibleNodesInDocument++;E++}else{H.nodeModel._rowID=null}}});if(t){console.timeEnd("sync model")}if(!y||(w===false&&F===true)){B()}},_reflectView:function(){this.__mustSyncModel=true},selectAll:function(){var x=this;var w=x.getDocument();var y=[];w.withTransactionUpdate(function(){w._getTrueRoot().processDescendants({processNode:function(z){if(w.options.shouldBeSelected.call(w,z.nodeModel)){y.push(z.nodeModel)}}});x.getNodesXSO().add(y)})},selectAllVisibleNodes:function(){if(this.options.selection.canMultiSelect===true){var x=this;var w=x.getDocument();var y=[];w.withTransactionUpdate(function(){w._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(z){if(w.options.shouldBeSelected.call(w,z.nodeModel)){y.push(z.nodeModel)}}});x.getNodesXSO().add(y)})}},unselectAll:function(){this.withUpdate(function(){this.getNodesPXSO().empty();this.getNodesXSO().empty()})},_selectRowProcessCB:function(w,z,y,x){this._parent(w,z,y,x);if(this.getColumnOptions(y)&&this.getColumnOptions(y).type==="selection"){this.updateCellView(z,y)}},_unselectRowProcessCB:function(w,y,x){this._parent(w,y,x);if(this.getColumnOptions(x)&&this.getColumnOptions(x).type==="selection"){this.updateCellView(y,x)}},_restoreSelection:function(){var w=this;w.prepareUpdateView();this.getNodesXSO().get().forEach(function(x){var y=x._getRowID();if(y!==null){w.selectRow(y,false)}});w.pushUpdateView()},loadDocument:function(w){this._freeUpPool(2);this._isPreparingView=0;this._updateCounter=0;this.prepareUpdateView();if(this._treeDocument){this.unloadDocument();this._cleanBindingOnDocument()}this._createDocument(w);this._syncRowIndexes(true);this._setColumnsWidth();this._restoreSelection();this.pushUpdateView(true)},unloadDocument:function(){this.prepareUpdateView();this.empty();if(this.options.selection.viewBased===true){this.getNodesPXSO().empty();this.getNodesXSO().empty()}this._cleanBindingOnDocument();this._createDocument();this.pushUpdateView(true)},scrollToNode:function(z,w,x){if(x===undefined){x=true}var y=z._getRowID(true);this.scrollToRow(y,w);if(x===true){this.updateView()}},isNodeInVisibleViewport:function(w){return(this.nodePositionInVisibleViewport(w)===0)},nodePositionInVisibleViewport:function(y){if(!this._scrollerDimensions){return 0}var w=this.getRowPosition(y._getRowID());var A=this.getScrollerPosition().y;if(A>w){return -1}var x=this.getRowHeight(y._getRowID());var z=this.getScroller().getContent().getDimensions().height;if((w+x)>(A+z)){return 1}return 0},expandAll:function(){this.prepareUpdateView();var w=this.unloadDocument();var x=w.getAllDescendants();n.optimizedForEach(x,function(y){if(y.hasChildren()){y.expand()}});this.loadDocument(w);this.pushUpdateView()},collapseAll:function(){this.prepareUpdateView();var w=this.unloadDocument();var x=w.getAllDescendants();n.optimizedForEach(x,function(y){if(y.hasChildren()){y.collapse()}});this.loadDocument(w);this.pushUpdateView()},getTreeNodeModelFromRowID:function(w){return this.getCellContent(w,"tree")},onNodeDblClick:function(w){return this._modelEvents.subscribe({event:"dblClick"},w)},onNodeClick:function(w){return this.onCellClick(w)},sortColumnContent:function(B,x){var A=this;this.prepareUpdateView();if(typeof B!=="string"){B=this.getDataIndexFromColumnID(B)}var z=this.getColumnIDFromDataIndex(B);var C=this.getColumnOptions(z);x=g.extend({sortOrder:"asc",sortFunction:C.sortFunction||function(E,D){if(B==="tree"){return E.options.label<D.options.label?-1:1}else{if(E.options.grid[B]===D.options.grid[B]){return 0}if(E.options.grid[B]===null){return -1}if(D.options.grid[B]===null){return 1}if(E.options.grid[B]===undefined){return -1}if(D.options.grid[B]===undefined){return 1}return E.options.grid[B]<D.options.grid[B]?-1:1}}},x);this._setColumnState(z,"sort:"+x.sortOrder);for(var y=0;y<this.getRow(-1).length;y++){if(y!==z){var w=A.getRow(-1)[y];if(w._view){w._view.getContent().removeClassName("wux-ui-sort-desc");w._view.getContent().removeClassName("wux-ui-sort-asc")}w.removeClass("wux-ui-sort-desc");w.removeClass("wux-ui-sort-asc")}}this.getCell(-1,z).removeClass("wux-ui-sort-desc");this.getCell(-1,z).removeClass("wux-ui-sort-asc");this.getCell(-1,z).addClass("wux-ui-sort-"+x.sortOrder);this.getDocument()._getTrueRoot().sortChildren({isRecursive:true,sortFunction:function(F,E){var D=x.sortOrder==="asc"?1:-1;return D*x.sortFunction(F,E)}});this._reflectView();this.pushUpdateView(true);this._modelEvents.publish({event:"sort",data:{columnID:z,columnDataIndex:B,sortOrder:x.sortOrder}})},restoreColumnsPreferences:function(w){this._parent(w);this._syncRowIndexes(true)},_onCellChange:function(A){if(!this._isRequestingCell){var w=this;var B=r.firstParentWithClass(A.target,"wux-datagrid-cell");if(B){var D=w._getCellViewFromDom(B);var E=D.getCellInfos();if(!E.isHeader){var x=this._getColumnOptionValue(E.dataIndex,"setValue");var z=this._getColumnOptionValue(E.dataIndex,"onCellChange");var y=E;y.event=A;var C=z.call(this,y);y.value=C;x.call(this,y);w._recordInteractionFromUI({event:"node:change",data:{nodeRecordPath:E.nodeModel?E.nodeModel.getStructurePath():E.nodeModel,dataIndex:E.dataIndex,virtualRowID:E.virtualRowID,virtualColumnID:E.virtualColumnID,value:C}});w._giveFocus();if(b){console.warn("[manager:change]",D,C)}this._preventNextRowUpdateView=false}}else{w._giveFocus()}}},_setupColumnType:function(w){var x=this;switch(w.type){case"selection":w.isSortable=false;w.setValue=function(C){C.nodeModel.selectionChangeIsFromUI();if(C.value||x._modeIsListSel){if(x.options.selection.canMultiSelect){if(x._modeIsListSel){var A=x.getDocument();var z=A.getXSO().get();var B;if(z.length===0){B=A.getChildren()[0]}else{if(x._getParent().options.enableActiveUI===true){B=x.getActiveNode()}else{B=z[0]}}var y=C.nodeModel;A.withTransactionUpdate(function(){var J=B._getRowID();var I=y._getRowID();var D=(J<I?1:-1);var E=true;if(J===I){E=x.getNodesXSO().isIn(B)}var H=[];if(x._shouldBeSelected(B)){H.push(B)}for(var G=J+D;(D>0&&G<=I)||(D<0&&G>=I);G+=D){var F=x.getTreeNodeModelFromRowID(G);if(x._shouldBeSelected(F)){H.push(F)}if(E&&!x.getNodesXSO().isIn(F)){E=false}}if(E){C.cellView.__unselectNodes(H)}else{C.cellView.__selectNodes(H)}})}else{x.getNodesXSO().add(C.nodeModel)}}else{x.getNodesXSO().unique(C.nodeModel)}}else{x.getNodesXSO().remove(C.nodeModel)}};w.getValue=function(y){return x.getNodesXSO().isIn(y.nodeModel)};w.onCellChange=function(y){x._giveFocus(true);return y.event.target.dsModel.checkFlag};w.onCellRequest=function(B){if(!B.isHeader){var A=B.cellView.reuseCellContent("_selection");if(A){var z=B.manager.getDocument();var y=B.manager._shouldBeSelected(B.nodeModel);A.disabled=B.isHeader?false:!y;A.checkFlag=B.manager.getNodesXSO().isIn(B.nodeModel)}}else{if(x.options.selection.canMultiSelect){if(x._selectAllToggleTimer){clearTimeout(x._selectAllToggleTimer)}x._updateSelectAllCheckBox()}}};break;case"tree":case"picture":case"boolean":case"color":break;default:if(w.typeRepresentation!==undefined){if(w.setValue===undefined){w.setValue=function(z){var y={};y[z.dataIndex]=z.value;if(z.nodeModel._isUsingDataModel()){z.manager.prepareUpdateView();z.nodeModel._getDataModel().update({grid:y});z.manager.pushUpdateView()}else{z.nodeModel.updateOptions({grid:y});z.manager.updateRowViewWithException(z.nodeModel,z.dataIndex)}}}w.onCellRequest=function(B){if(!B.isHeader){var y=B.manager._getColumnOptionValue(B.dataIndex,"getValue");var z=y.call(B.manager,B);var A=!x._isCellEditable(B);B.cellView._disposeReusableContent();this._typeRepFactory.generateView(z,{typePath:w.typeRepresentation,readOnly:A,context:"inlinedTemplate",onViewCreated:function(C){B.cellView._setReusableContent(C,"_typeRep-"+w.typeRepresentation);if(!C.readOnly){B.cellView.getContent().setAttribute("draggable",false)}}})}}}break}},_getViewOptions:function(){return this._instance._parentObject.options},_shouldBeSelected:function(x){var w=this.getDocument();if(this._getViewOptions().selection.viewBased===true){return this._getViewOptions().nodeShouldBeSelected.call(w,x)}else{return w.options.shouldBeSelected.call(w,x)}},_updateSelectAllCheckBox:function(){var w=this;var z=this._getCellViewDom(-1,"selection");if(z){var y=z.dsView.getCellInfos();if(this._selectAllCheckBox===undefined){this._preventSelectAllCheckBoxListenChange=false;this._selectAllCheckBox=new e({});this._selectAllCheckBox.getContent().addEventListener(i.POINTERDOWN,function(A){A.stopPropagation()});this._selectAllCheckBox.getContent().addEventListener("focus",function(A){A.preventDefault();A.stopPropagation()});this._selectAllCheckBox.getContent().addEventListener("change",function(A){if(w._preventSelectAllCheckBoxUpdate){return}w._preventSelectAllCheckBoxUpdate=true;if(A.dsModel.checkFlag){w.selectAllVisibleNodes()}else{w.unselectAll()}w._selectAllCheckBox.mixedState=false;w._giveFocus();w._preventSelectAllCheckBoxUpdate=false})}if(!this._preventSelectAllCheckBoxUpdate){this._preventSelectAllCheckBoxUpdate=true;var x=this.getNodesXSO().isEmpty();this._selectAllCheckBox.checkFlag=!x;this._selectAllCheckBox.mixedState=!x&&!w.isEveryVisibleNodeSelected();this._preventSelectAllCheckBoxUpdate=false}y.cellView.getContent().setHTML(this._selectAllCheckBox)}},_isCellEditable:function(C){var w=false;var y=this._getParent();var D=C.manager.getColumnOptions(C.virtualColumnID);var B=C.manager.getDocument().options.shouldBeEditable.call(C.nodeModel,C.nodeModel);var A=(y.options.shouldBeEditable===undefined||(typeof y.options.shouldBeEditable==="function"&&y.options.shouldBeEditable.call(C.nodeModel,C)));if(A===undefined){A=true}var x=(D.isEditable===undefined||D.isEditable===true);var z=B&&A&&x;if(w){console.log("cell [",C.virtualRowID,",",C.dataIndex,"]","node is editable:",B,"cell is editable:",A,"column is editable:",x,">>",z)}return z},setActiveNode:function(w){if(this._instance.options.enableActiveUI){if(w){if(this._activeNode!==w){this._activeNode=w;this._modelEvents.publish({event:"active",context:w,data:w._getNodeInfos()})}}else{this.unsetActiveNode()}}},getActiveNode:function(){return this._activeNode},unsetActiveNode:function(w){if(this.getActiveNode()){this._modelEvents.publish({event:"inactive",context:w})}},_enableActiveStateForNode:function(x){var y=x._getRowID();var w=this;this.disableDragOverStateForRow();this.disableDragOverStateForBlank();if(w._activeMarkBG===undefined){w._activeMarkBG=new g.Element("div",{"class":"wux-tree-active-element-bg wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:w.getRowPosition(y),left:0,height:w.getRowHeight(y),right:0}}).inject(w.elements.poolContainerRelDettachable);w._activeMarkFG=new g.Element("div",{"class":"wux-tree-active-element-fg wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:w.getRowPosition(y),left:0,height:w.getRowHeight(y),right:0}}).inject(w.elements.poolContainerRelDettachable)}else{this._activeMarkFG.style.display="block";w._activeMarkBG.style.display="block"}},_computeStyleForActiveState:function(y){var z=y._getRowID();var x,w;x=this.getRowPosition(z);w=this.getRowHeight(z);return{top:x,left:0,height:w,right:0}},_setActiveStateForNode:function(y){this._enableActiveStateForNode(y);var x=this._computeStyleForActiveState(y);var w="middle";this._activeMarkBG.setAttribute("wux-ui-drop-position",w);this._activeMarkBG.setStyles({height:x.height-2,top:x.top+1,left:x.left+1,right:x.right+2,width:x.width,border:"1px solid white",background:"transparent",display:""});this._activeMarkFG.setAttribute("wux-ui-drop-position",w);this._activeMarkFG.setStyles({height:x.height,top:x.top,left:x.left,right:x.right+1,width:x.width,display:""})},_unsetActiveStateForNode:function(w){if(this._activeMarkBG){this._activeMarkBG.removeAttribute("wux-ui-drop-position");this._activeMarkFG.removeAttribute("wux-ui-drop-position");this._activeMarkBG.style.display="none";this._activeMarkFG.style.display="none"}},enableDragOverStateForRow:function(x){var w=this;this.disableDragOverStateForRow();this.disableDragOverStateForBlank();if(w._insertNodeMarkBG===undefined){w._insertNodeMarkBG=new g.Element("div",{"class":"wux-tree-treelistview-insertion-mark",styles:{position:"absolute",top:w.getRowPosition(x),left:0,height:w.getRowHeight(x),right:0}}).inject(w.elements.poolContainerRelDettachable);w._insertNodeMarkFG=new g.Element("div",{"class":"wux-tree-treelistview-insertion-mark-border",styles:{position:"absolute",top:w.getRowPosition(x),left:0,height:w.getRowHeight(x),right:0}}).inject(w.elements.poolContainerRelDettachable)}else{this._insertNodeMarkBG.show();w._insertNodeMarkFG.show()}},setDragOverStateForNode:function(A,y){var B=A._getRowID();var z=this;if(z._currentDropPosition!==y){z.enableDragOverStateForRow(B,y);z._currentDropPosition=y;var x,w,C;switch(y){case"top":x=z.getRowPosition(B);w=2;if(z.isColumnHidden("tree")){C=0}else{C=z.getColumnPosition("tree")+z._getCellView2(B,"tree")._nodeOffsetX}break;default:case"middle":x=z.getRowPosition(B);w=z.getRowHeight(B);C=0;break;case"bottom":x=z.getRowPosition(B)+z.getRowHeight(B);w=2;if(z.isColumnHidden("tree")){C=0}else{C=z.getColumnPosition("tree")+z._getCellView2(B,"tree")._nodeOffsetX}break}if(this._insertNodeMarkBG){this._insertNodeMarkBG.setAttribute("wux-ui-drop-position",y);this._insertNodeMarkBG.setStyles({height:w,top:x,left:C,right:0})}if(this._insertNodeMarkFG){this._insertNodeMarkFG.setAttribute("wux-ui-drop-position",y);this._insertNodeMarkFG.setStyles({height:w,top:x,left:C,right:0})}}},disableDragOverStateForRow:function(){this._currentDropPosition=null;if(this._insertNodeMarkBG){this._insertNodeMarkBG.hide()}if(this._insertNodeMarkFG){this._insertNodeMarkFG.hide()}},_removeAllInteractiveUIFeedBacks:function(){this._lastDragOveredRowID=null;this.disableDragOverStateForRow();this.disableDragOverStateForBlank()},_recordInteractionFromUI:function(w){var x=this;d.addCustomInteraction(x._instance._parentObject.getContent(),{type:"webUX_event",reason:w.reason||"",event:w.event||"",data:w.data||{},eventOptions:{}},"DS/TreeRec/TreeListViewRec",{checkAbstract:false,checkVisibility:false})}});return a});define("DS/Tree/TreeListView",["UWA/Core","DS/Spreadsheet/DataGrid","DS/Core/PointerEvents","DS/Tree/TreeNodeView","DS/Tree/TreeNodeModel","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Utils","DS/WebRecordEnabler/Adapter","DS/TouchDragAndDropPolyfill/TouchDragAndDropPolyfill"],function(e,k,h,i,f,g,a,j,b,d){var l=document.createElement("DIV");function c(o,p){if(j.getUnsafeHTMLContentValueToApply(p)){l.innerHTML=o}else{l.innerText=o}return l.textContent||l.innerText||""}var n=k.extend({defaultOptions:{apiVersion:2,roots:[],columns:[],cellClass:i,managerClass:g,defaultCellMouseHeight:28,defaultCellTouchHeight:38,defaultCellHeight:28,defaultYDistanceOfTopBadgesFromIconCenter:8,defaultYDistanceOfBottomBadgesFromIconCenter:10,numberOfColumns:1,headersDimensions:{width:undefined,height:undefined},expanderStyle:"classic",changeColorOnFocus:true,show:{rowHeaders:false,columnHeaders:true},selection:{viewBased:false,nodes:true,cells:false,rowHeaders:true,columnHeaders:true,unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableListSelection:false},enableDragAndDrop:true,enableActiveUI:false,enableKeyboardNavigation:false,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel",},enableTreeColumnEllipsisOverflow:false,shouldDisplayTooltip:function(o){if(o.dataIndex==="tree"&&!o.isHeader){return{shortHelp:c(o.nodeModel.options.label,o.manager.options.shouldCellAllowUnsafeHTMLContentAt?o.manager.options.shouldCellAllowUnsafeHTMLContentAt(o):true)}}else{if(o.cellModel.options.value){if(typeof o.cellModel.options.value==="string"){return{shortHelp:o.cellModel.options.value}}else{if(o.cellModel.options.value.toString){return{shortHelp:o.cellModel.options.value.toString()}}else{return{shortHelp:""}}}}else{return{shortHelp:""}}}},performances:{buildLinks:true,numberOfRowsFactor:1.4,numberOfColumnsFactor:1,fullUpdateFactor:0.95,enableColumnVirtualization:false,debounceCellInternalUpdateTimer:0,debounceCellRequest:false},useAsyncPreExpand:false,showScrollbarsOnHover:false,enableScrollOnDrag:false,enableExpandOnDoubleClick:false,onDragStartCell:function(p,q){var o=[];q.manager.getNodesXSO().get().concat().sort(function(s,r){return s._getRowID()>r._getRowID()?+1:-1}).forEach(function(r){o.push(r.dump())});this.serializeDragAndDropEvent(p,{data:{"dswebux/x-tree.treenodemodel+json":o,"dswebux/x-tree.treenodemodel+number":q.nodeModel._getID()}});p.dataTransfer.effectAllowed="move"},onDragEnterRowHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDragLeaveRowHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDragStartColumnHeader:function(p,o){o.manager.__draggedColumnID=o.virtualColumnID;return true},onDragEnterColumnHeaderDefault:function(q,p){p.manager.disableDragOverStateForBlank();p.manager.disableDragOverStateForRow();if(p.manager.__draggedArea==="column"){var o=p.manager.getScroller().getPosition().x+p.manager.getHeadersDimensions().width+p.manager.getColumnPosition(p.dataIndex);if(p.manager.__draggedColumnID<p.virtualColumnID){o=o+p.manager.getColumnWidth(p.dataIndex)}else{}this._showColumnInsertionMark(o)}},onDragLeaveColumnHeaderDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow();this._hideColumnInsertionMark()},onDragEnterCellDefault:function(p,o){o.manager.enableDragOverStateForRow(o.virtualRowID,o.dropPosition)},onDragOverCellDefault:function(p,o){o.manager.setDragOverStateForNode(o.nodeModel,o.dropPosition)},onDragLeaveCellDefault:function(p,o){o.manager.disableDragOverStateForBlank();o.manager.disableDragOverStateForRow()},onDropCellDefault:function(s,p){var q=p.parent;var r=this.unserializeDragAndDropEvent(s);if(r){var o=r.source.uuid;if(this._uxid===o){this._dndMode="move"}else{this._dndMode="copy"}p.mode=this._dndMode;p.manager._recordInteractionFromUI({event:"drop:node",data:{unserializedData:r,dropPosition:p.dropPosition,mode:this._dndMode,nodeRecordPath:p.nodeModel?p.nodeModel.getStructurePath():p.nodeModel,virtualRowID:p.virtualRowID,virtualColumnID:p.virtualColumnID,dataIndex:p.dataIndex}});this.getManager()._getParent()._applyDropCell(r,p)}},onDropRowHeaderDefault:function(){},onDragEndCellDefault:function(){},onDragEnterBlankDefault:function(p,o){setTimeout(function(){o.manager.enableDragOverStateForBlank()},10)},onDragLeaveBlankDefault:function(p,o){o.manager.disableDragOverStateForBlank()},onDropBlankDefault:function(r,q){q.manager.disableDragOverStateForBlank();var p=this.unserializeDragAndDropEvent(r);if(p){var o=p.source.uuid;if(this._uxid===o){this._dndMode="move"}else{this._dndMode="copy"}q.mode=this._dndMode;q.manager._recordInteractionFromUI({event:"drop:blank",data:{unserializedData:p,dropPosition:q.dropPosition,mode:this._dndMode,nodeRecordPath:q.nodeModel?q.nodeModel.getStructurePath():q.nodeModel,virtualRowID:q.virtualRowID,virtualColumnID:q.virtualColumnID,dataIndex:q.dataIndex}});this.getManager()._getParent()._applyDropBlank(p,q)}},onDragStartRowHeaderDefault:function(){},useTransparentScroller:false},init:function(q){var t=this;if(q===undefined){q={}}if(!q.columns){q.columns=e.clone(this.defaultOptions.columns)}var o=e.extend(e.clone(this.defaultOptions.selection),q.selection);if(q){if(q.isEditable){var s={switchToWriteView:{event:h.POINTERHIT,callback:function(A){var y=A.event;if((y&&y.multipleHitCount===1&&!o.toggle)||(y&&y.multipleHitCount===2&&o.toggle)){var z=this;if(!A.isHeader&&((A.dataIndex==="tree"&&a.firstParentWithClass(A.event.target,"wux-layouts-treeview-node")||((A.dataIndex!=="tree"&&!a.hasClass(A.event.target,"wux-layouts-treeview-node")))))){var C=A.manager.getColumnOptions(A.virtualColumnID);var w=A.manager._isCellEditable(A);if(C.typeRepresentation===undefined&&w){if(o.toggle){this.switchToWriteView()}else{if((!t.getManager().isInMultiSelection()&&t.getManager().getNodesXSO().get().length===1)||t.getManager().options.selection.cells===true){var B=A.manager._getRowLastClick(A.virtualRowID);var v=Date.now()-B;if((B!==0&&v>300&&A.manager.getNodesXSO().isIn(A.nodeModel))||(B!==0&&v>300&&t.getManager().options.selection.cells===true)){if(!A.manager.isInMultiSelection()){var x=function(){z._isCurrentlyEdited=false;z.switchToWriteView()};if(window.__karma__!==undefined||h.isTouchEvent(y)){x()}else{if(A.manager._toCellWillBeEdited){clearTimeout(A.manager._toCellWillBeEdited)}A.manager._toCellWillBeEdited=setTimeout(x,500)}}}A.manager._setRowLastClick(A.virtualRowID,Date.now())}}}}}},view:function(w){if(!w.isHeader){if(!w.typeRepresentation){var v=w.cellView;switch(w.dataIndex){case"tree":if(w.nodeModel!==""){v.setLabel(w.nodeModel.options.label);v.setIcons(w.nodeModel.getIcons());v.setBadges(w.nodeModel.options.badges);v._setExpanderState(w.nodeModel.getState());v._setDepth(w.nodeModel.getNodeDepth())}break;default:var x=new e.Element("input",{type:"text",value:w.cellModel.getCellContent().toString(),"class":"wux-layouts-treeview-label"});v.getContent().setContent(x);x.select()}}}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(w){if(!w.isHeader){switch(w.dataIndex){default:var v=w.cellModel.getCellContent();return(v!==undefined&&v!==null)?w.cellModel.getCellContent().toString():""}}}},nodesAreDraggable:true,cells:true};var u={switchToWriteView:{event:h.POINTERHIT,callback:function(y){var x=y.event;if((x&&x.multipleHitCount===1&&!o.toggle)||(x&&x.multipleHitCount===2&&o.toggle)){if(!y.isHeader&&((y.dataIndex==="tree"&&a.firstParentWithClass(y.event.target,"wux-layouts-treeview-label")||((y.dataIndex!=="tree"&&!a.hasClass(y.event.target,"wux-layouts-treeview-label")))))){var A=y.manager.getColumnOptions(y.virtualColumnID);var w=y.manager._isCellEditable(y);if(A.typeRepresentation===undefined&&w){if(o.toggle){this.switchToWriteView()}else{if((!t.getManager().isInMultiSelection()&&t.getManager().getNodesXSO().get().length===1)||t.getManager().options.selection.cells===true){var z=y.manager._getRowLastClick(y.virtualRowID);var v=Date.now()-z;if((z!==0&&v>300&&y.manager.getNodesXSO().isIn(y.nodeModel))||(z!==0&&v>300&&t.getManager().options.selection.cells===true)){if(!y.manager.isInMultiSelection()){this._isCurrentlyEdited=false;this.switchToWriteView()}}y.manager._setRowLastClick(y.virtualRowID,Date.now())}}}}}},view:function(v){if(!v.isHeader){var w=v.manager.getColumnOptions(v.virtualColumnID);if(!v.typeRepresentation){if(v.dataIndex!=="tree"){if(w.onCellRequest){v.readOnly=false;return w.onCellRequest.call(v.manager,v)}else{return v.cellModel.getCellContent().toString()}}}}}},switchToReadView:{event:"blur",callback:function(){this.switchToReadView()},setContent:function(){},getContent:function(){},view:function(w){var x=w.manager.getColumnOptions(w.virtualColumnID);if(!w.isHeader){if(!w.typeRepresentation){if(w.dataIndex==="tree"){var v=w.cellView;if(w.nodeModel!==""){v.setLabel(w.nodeModel.options.label);v.setIcons(w.nodeModel.getIcons());v.setBadges(w.nodeModel.options.badges);v._setExpanderState(w.nodeModel.getState());v._setDepth(w.nodeModel.getNodeDepth())}}if(x.onCellRequest){w.readOnly=true;x.onCellRequest.call(w.manager,w)}}}}},nodesAreDraggable:true,cells:true};if(q.isEditable==="auto"){q.isEditable=u;this._setEditionMode(2)}else{this._setEditionMode(1);if(q.isEditable===true){q.isEditable=s}else{q.isEditable=e.extend(s,q.isEditable,true)}}}}this._setupColumns(q);this._currentNodeDropArea=null;this._parent(q,this);this.markForRecord(this.getContent());this.elements.container.dsModel=this;this.elements.container.setAttribute("data-rec-id","treeListView");this.elements.container.addClassName("wux-tree-treelistview");this.elements.container.setAttribute("expander-style",this.options.expanderStyle);if(!this.options.changeColorOnFocus){this._datagrid.elements.container.addClassName("wux-ui-state-focused")}this._treeWidth=200;this._depth=-1;this._rowID=-1;this.getManager()._tree=this;var r=this.getManager();this._modelEvents=r._modelEvents;if(q.roots){if(q.useAsyncPreExpand){this.getManager().getDocument().options.useAsyncPreExpand=true}this.getManager().getDocument().loadModel(q.roots);this.getManager()._syncRowIndexes(true)}this._observeEvents();if(q.treeDocument){this.getManager().loadDocument(q.treeDocument)}var p=this.getManager().onReady(function(){t._modelEvents.unsubscribe(p);t._manageColumnsCSS(q)})},_applyDropBlank:function(q,p){var o=q.data["dswebux/x-tree.treenodemodel+json"];if(p.mode==="move"){p.manager.getDocument().prepareUpdate();p.manager.getNodesXSO().get().forEach(function(r){r.remove()});p.manager.getDocument().pushUpdate()}if(o){o.forEach(function(s){var r=new f(s);p.manager.getDocument().addChild(r)})}p.manager.disableDragOverStateForBlank()},_applyDropCell:function(s,p){var q=this;var r=s.data["dswebux/x-tree.treenodemodel+number"];var o=s.data["dswebux/x-tree.treenodemodel+json"];if(p.dropPosition==="middle"&&p.nodeModel._getID()===r){return}if(o){o.forEach(function(z,u){var y=new f(z);var x=p.nodeModel;var A=p.manager.getDocument().options.shouldAcceptDrop({parentTreeNodeModel:p.dropPosition==="middle"?x:x.getParent(),draggedTreeNodeModel:y,dropPosition:p.dropPosition});if(A){p.manager.getDocument().prepareUpdate();var t=x.getParent();var w=t.getChildren().indexOf(x);if(p.mode==="move"){p.manager.getDocument().prepareUpdate();p.manager.getNodesXSO().get().forEach(function(B){B.remove()});p.manager.getDocument().pushUpdate()}if(p.virtualRowID!==-1){var v=p.manager;switch(p.dropPosition){case"top":w=t.getChildren().indexOf(x);t.addChild(y,w);break;default:case"middle":v.getDocument().options.insert.call(v.getDocument(),y,x);break;case"bottom":x.getParent().addChild(y,x.getParent().getChildren().indexOf(x)+1+u);break}}p.manager.getDocument().pushUpdate()}})}},_setEditionMode:function(o){this._editionMode=o},_getEditionMode:function(){return this._editionMode},_shouldAcceptDrag:function(p){var r=this.getManager().getColumnOptions(p.dataIndex);if(!r){return false}if(!p.isHeader){var o=r.isColumnDraggable;if(o===undefined){o=true}if(o){return this.getDocument().options.shouldAcceptDrag(p.nodeModel,p)}else{return false}}else{if(p.virtualRowID===-1){var q=r.isColumnMovable;if(q===undefined){q=true}return q}else{return false}}},_getTrueRoot:function(){return this.getManager()._getTrueRoot()},getDocument:function(){return this.getManager().getDocument()},getNthRoot:function(o){return this.getManager().getNthRoot(o)},getRoots:function(){return this.getManager().getRoots()},toggle:function(){this.elements.container.toggle()},_syncRowIndexes:function(){return this.getManager()._syncRowIndexes()},addRoot:function(o){return this.getManager().addRoot(o)},_updateTreeColumnWidth:function(p){var o=p.elements.layout.getDimensions().width;this._treeWidth=this._treeWidth<o?o:this._treeWidth;this.getManager().setColumnWidth("tree",this._treeWidth)},_setupColumns:function(o){var r=this;var q={text:"Tree",dataIndex:"tree",width:"auto",getValue:function(s){return s.nodeModel},onCellRequest:function(t){if(t.virtualRowID>-1){var s=t.cellView;if(t.nodeModel!==""){if(r.options.shouldDisplayTooltip===undefined){s.getContent().setAttribute("title",t.nodeModel.getLabel())}s.setLabel(t.nodeModel.getLabel());s.setIcons(t.nodeModel.getIcons());s.setBadges(t.nodeModel.getBadges());if(s.elements.badgeTopRight.style.top!==(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"){s.elements.badgeTopRight.style.top=(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"}if(s.elements.badgeBottomRight.style.top!==r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"){s.elements.badgeBottomRight.style.top=r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"}if(s.elements.badgeTopLeft.style.top!==(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"){s.elements.badgeTopLeft.style.top=(-r.options.defaultYDistanceOfTopBadgesFromIconCenter).toString()+"px"}if(s.elements.badgeBottomLeft.style.top!==r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"){s.elements.badgeBottomLeft.style.top=r.options.defaultYDistanceOfBottomBadgesFromIconCenter.toString()+"px"}s._setExpanderState(t.nodeModel._expandState);s._setDepth(t.nodeModel._nodeDepth);t.cellView.elements.container.setContent(t.cellView.elements.layout)}}},isDraggable:true};var p;for(p=0;p<o.columns.length;p++){if(o.columns[p].dataIndex==="tree"){break}}if(p!==o.columns.length){o.columns[p]=e.extend(q,o.columns[p],true)}else{o.columns.unshift(q)}},_manageColumnsCSS:function(o){var p=0;for(p=0;p<o.columns.length;p++){if(o.columns[p].allowTextCopy===true){this.getManager().addColumnClass(p,"wux-ui-allowTextCopy")}}},loadColumns:function(o){this.getManager().empty();this.getManager()._needToComputeColumnReverseDataIndexes();this.getManager().prepareUpdateView();this._setupColumns({columns:o});this.options.columns=o;this._datagrid.options.columns=o;this.getManager().options.columns=o;this._datagrid._loadInternalModel();this.getManager()._syncRowIndexes(true);this.getManager().pushUpdateView(true);this.getManager()._syncRowIndexes();this.getManager()._syncScrollPositionToHeaders()},_observeEvents:function(){if(this.options.enableTreeColumnEllipsisOverflow===true){this.getContent().setAttribute("tree-overflow","true")}if(this.options.enableExpandOnDoubleClick){this.getManager().addEventListener("dblclick",function(o,p){if(p&&!p.isHeader){if(p.nodeModel.isExpanded()){p.nodeModel.collapse()}else{p.nodeModel.expand()}}})}},onExpand:function(o){return this.getManager().getDocument().subscribe({event:"expand"},o)},onCollapse:function(o){return this.getManager().getDocument().subscribe({event:"collapse"},o)},onNodeDragOver:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_OVER"},o)},onNodeDragStart:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_START"},o)},onNodeDragLeave:function(o){return this.getManager().getDocument().subscribe({event:"NODE/DRAG_LEAVE"},o)},onNodePreDrop:function(o){return this.getManager().getDocument().subscribe({event:"NODE/PRE_DROP"},o)},onNodePostDrop:function(o){return this.getManager().getDocument().subscribe({event:"NODE/POST_DROP"},o)},onPreExpand:function(o){return this.getManager().getDocument().subscribe({event:"preExpand"},o)},onPostExpand:function(o){return this.getManager().getDocument().subscribe({event:"postExpand"},o)},onPreCollapse:function(o){return this.getManager().getDocument().subscribe({event:"preCollapse"},o)},onPostCollapse:function(o){return this.getManager().getDocument().subscribe({event:"postCollapse"},o)},onNodeClick:function(o){return this.getManager()._modelEvents.subscribe({event:"nodeclick"},o)},onNodeDblClick:function(o){return this.getManager()._modelEvents.subscribe({event:"nodeDblClick"},o)},onLabelChange:function(o){return this.getManager().getDocument().subscribe({event:"UPDATE_LABEL"},o)}});var m={nodeShouldBeSelected:function(o){return true},allowUnsafeHTMLContent:undefined,shouldCellAllowUnsafeHTMLContentAt:function(o){return o.manager.options.allowUnsafeHTMLContent},enableScrollOnDrag:true,defaultCellHeight:38,defaultCellWidth:200,changeColorOnFocus:true,iconsSize:22,roots:[],height:400,infiniteScrolling:true,useAsyncPreExpand:true,isEditable:true,resize:{columns:true,rows:true},columns:[{text:"Tree",dataIndex:"tree",width:"auto"}],apiVersion:2,selection:{viewBased:false,nodes:true,preSelection:false,toggle:false,rowHeaders:false,unselectAllOnEmptyArea:true,enableListSelection:true,canMultiSelect:true},show:{rowHeaders:true,columnHeaders:true},headersDimensions:{width:50,height:24},enableTreeColumnEllipsisOverflow:true,enableKeyboardNavigation:true,enableActiveUI:true,keymaps:{"/":"treelistview:collapse-all-node","*":"treelistview:expand-all-node","+":"treelistview:expand-node","-":"treelistview:collapse-node","ctrl+space":"treelistview:toggle-selection","ctrl+right":"treelistview:go-to-next-node","shift+right":"treelistview:go-to-next-node",right:"treelistview:go-to-next-node","ctrl+left":"treelistview:go-to-previous-parent-node","shift+left":"treelistview:go-to-previous-parent-node",left:"treelistview:go-to-previous-parent-node","ctrl+up":"treelistview:go-to-previous-visible-node","shift+up":"treelistview:go-to-previous-visible-node",up:"treelistview:go-to-previous-visible-node","ctrl+down":"treelistview:go-to-next-visible-node","shift+down":"treelistview:go-to-next-visible-node",down:"treelistview:go-to-next-visible-node",esc:"treelistview:edit-cancel",pageup:"treelistview:go-to-previous-page-node",pagedown:"treelistview:go-to-next-page-node","shift+pageup":"treelistview:go-to-previous-page-node","shift+pagedown":"treelistview:go-to-next-page-node","ctrl+pageup":"treelistview:go-to-previous-page-node","ctrl+pagedown":"treelistview:go-to-next-page-node",home:"treelistview:go-to-first-visible-node",end:"treelistview:go-to-last-visible-node","ctrl+home":"treelistview:go-to-first-visible-node","ctrl+end":"treelistview:go-to-last-visible-node","shift+home":"treelistview:go-to-first-visible-node","shift+end":"treelistview:go-to-last-visible-node","ctrl+a":"treelistview:select-all",f2:"treelistview:edit-label"},performances:{renderingMode:"adaptive",preloadPool:true,useRequestAnimationFrameRendering:true,enableColumnVirtualization:true}};n.SETTINGS={extend:function(p,o){if(typeof p==="string"){return e.extend(e.clone(n.SETTINGS[p]),o,true)}else{return e.extend(e.clone(p),o,true)}}};Object.defineProperty(n.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return e.extend(e.clone(m),{columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{text:"Tree",dataIndex:"tree",width:"auto"}],performances:{renderingMode:"adaptive",}})}});Object.defineProperty(n.SETTINGS,"STANDARD",{get:function(){return e.clone(m)}});b.register(n,"DS/TreeRec/TreeListViewRec");return n});define("DS/Tree/ListView",["DS/Core/Core","DS/Tree/TreeListView"],function(c,b){var a=b.extend({defaultOptions:b.SETTINGS.extend("STANDARD",{show:{columnHeaders:false,rowHeaders:false}}),init:function(d){this._parent(d);this.getContent().addClassName("wux-tree-listview")}});a.SETTINGS={extend:b.SETTINGS.extend};Object.defineProperty(a.SETTINGS,"STANDARD",{get:function(){return UWA.extend(b.SETTINGS.STANDARD,{show:{columnHeaders:false,rowHeaders:false}})}});Object.defineProperty(a.SETTINGS,"STANDARD_CHECKBOXES",{get:function(){return UWA.extend(b.SETTINGS.STANDARD_CHECKBOXES,{show:{columnHeaders:false,rowHeaders:false}})}});return a});define("DS/Tree/PropertyListView",["DS/Controls/Abstract","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(d,c,g){var f=g.extend({init:function(j){this._parent(j)},updateInternalParameters:function(){this._parent();var k=this.getCellInfos();if(k){var l=k.nodeModel;var j=l.getNextNode();(l.options.grid.type==="category")?this.getContent().addClassName("wux-controls-propertylistview-category"):this.getContent().removeClassName("wux-controls-propertylistview-category");(l.options.grid.value)?this.getContent().removeClassName("wux-controls-propertylistview-category-off"):this.getContent().addClassName("wux-controls-propertylistview-category-off");((l.options.grid.type==="category"&&!l.isExpanded())||(l.options.grid.type==="category"&&l.isExpanded()&&l.getVisibleChildren().length===0)||(l.options.grid.type!=="category"&&j&&j.options.grid.type==="category"))?this.getContent().addClassName("wux-controls-propertylistview-expander"):this.getContent().removeClassName("wux-controls-propertylistview-expander")}}});var a=undefined;var i=d.inherit({name:"propertyListView",publishedProperties:{treeDocument:{defaultValue:undefined,type:"DS/TreeModel/TreeDocument",category:"Behavior"},typeFactory:{defaultValue:undefined,type:"DS/Tweakers/TypeRepresentationFactory",category:"Behavior"}},_applyTreeDocument:function(){if(this.elements.editor){var j=this.elements.editor.getManager();if(j){j.loadDocument(this.treeDocument)}}},_applyTypeFactory:function(){a=this.typeFactory},handleEvents:function(){var k=this;if(k.elements.editor){var j=k.elements.editor.getManager();if(j){j.addEventListener("click",function(n,o){if(o&&o.dataIndex==="tree"){var m=o.nodeModel;if(m&&m.options&&m.options.grid&&m.options.grid.type==="category"){(m.isExpanded())?m.collapse():m.expand()}}});var l=j.getDocument();if(l){l.options.shouldAcceptDrag=function(m){return false};l.expandAll();l.onNodeModelUpdate(function(m){if(m&&m.target){var n=m.target;if(n.options.grid.type==="category"){l.prepareUpdate();(n.options.grid.value)?n.showChildNodes():n.hideChildNodes();l.pushUpdate()}}})}}}},buildView:function(){this.elements.container.addClassName("wux-controls-propertylistview");this.elements.editor=new c(b);this.elements.editor.inject(this.elements.container)},_applyProperties:function(j){this._parent(j);if(this.isDirty("treeDocument")){this._applyTreeDocument()}this._applyTypeFactory()}});function h(j){if(j.event&&j.event.dsModel){return j.event.dsModel.value}}function e(k){var j=k.nodeModel.options;j.grid.value=k.value;k.manager.updateRowViewWithException(k.nodeModel,k.dataIndex)}var b={apiVersion:2,defaultCellHeight:38,height:"auto",cellClass:f,show:{rowHeaders:false,columnHeaders:false},expanderStyle:"triangle",performances:{buildLinks:false},resize:{columns:true},selection:false,columns:[{dataIndex:"tree",text:"Label",isDraggable:false,isHidden:false,width:160,},{dataIndex:"value",text:"Value",isEditable:true,width:90,onCellRequest:function(n){if(a){var j=n.cellView;if(n.nodeModel&&n.nodeModel.options){var m=n.nodeModel.options.grid;var l=m.value;var k=m.type;if(k!==null){a.generateView(l,{typePath:k,context:"inlinedTemplate",onViewCreated:function(o){if(o!==undefined){j.getContent().setContent(o);if(m.available===false){o.disabled=true;if(o.elements.internalView){o.elements.internalView.disabled=true}}}}})}}}},onCellChange:h,setValue:e},{dataIndex:"value2",text:"Detailed Value",isEditable:true,width:"auto",onCellRequest:function(n){if(a){var j=n.cellView;if(n.nodeModel&&n.nodeModel.options){var m=n.nodeModel.options.grid;var l=m.value;var k=(m.detailedType!==undefined)?m.detailedType:m.type;if(k==="category"){k="gfx_category"}if(k){a.generateView(l,{typePath:k,context:"detailedTemplate",onViewCreated:function(o){if(o!==undefined){j.getContent().setContent(o);if(m.available===false){o.disabled=true;if(o.elements.internalView){o.elements.internalView.disabled=true}}}}})}}}},onCellChange:h,setValue:e}]};return i});define("DS/Tree/GridView",["UWA/Core","UWA/Class","DS/Layouts/GridEngine","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Tree/TreeDocument","DS/UIBehaviors/ContextualMenuManager","DS/Tree/TreeNodeModel","DS/Menu/ContextualMenu","DS/Utilities/Dom","DS/Utilities/TouchUtils"],function(e,c,l,g,d,b,n,f,h,a,k){var i=false;var m=false;var j=l.extend({defaultOptions:{width:"100%",strectchBackgroundImage:true,checkboxVisibleFlag:true,checkboxVisibilityFlag:"always",titleDisplayedOnTwoLines:false,model:[],selection:{unselectAllOnEmptyArea:true,toggle:true,canMultiSelect:true,enableListSelection:false,canInteractiveMultiselectWithCheckboxClick:false,},enableActiveUI:false,enableKeyboardNavigation:false,layoutOnSingleRow:false,shouldDisplayTooltipFlag:true,displayBadges:true,onDragStartCellDefault:function(r,o){var p=undefined;var q=o.nodeModel;if(q){p=q.getTreeDocument()}if(p&&p.options.shouldAcceptDrag(q)){r.dataTransfer.setData("Text",JSON.stringify(o.nodeModel.dump()));r.dataTransfer.effectAllowed="move"}else{r.preventDefault()}},onDragEnterBlankDefault:function(p,o){o.manager.getScroller().getContent().addClassName("wux-ui-state-drag-over")},onDragLeaveBlankDefault:function(p,o){o.manager.getScroller().getContent().removeClassName("wux-ui-state-drag-over")},onDragOverCellDefault:function(p,o){},onDragOverBlankDefault:function(p,o){p.preventDefault()},onDropBlankDefault:function(p,o){p.preventDefault();return false},performances:{numberOfRowsFactor:3,numberOfColumnsFactor:3}},init:function(o){this._parent(o);this.options._firstLoadDone=0;this._modelEventsListener=[];this._xsoEventsListener=[];var p=this;this._isInteractiveMultiSelMode=false;this._interactiveCumulativeSelection=false;this.onCellPointerDown(function(s){var r=s.event;if(r&&g.isTouchEvent(r)){return}else{return p._onCellClickOrPointerDown(s)}});this.onCellClick(function(s){var r=s.event;if(r&&g.isTouchEvent(r)){if(!p._preventSelectionForTouchScroll){return p._onCellClickOrPointerDown(s)}else{return}}if(p._needToSelectAtRelease===true){if(p.isInMultiSelection()===false){p.options.TreedocModel.getXSO().empty();p.setActiveNode(s.cellModel,false);s.cellModel.select();p.options.lastSelectedNode=s.cellModel}else{if(p.options.selection.toggle){s.cellModel.unselect()}}}p._needToSelectAtRelease===false});this._modelEvents.subscribe({event:"active"},function q(r){p._updateAllPoolSelectedViews()});if(!this.options.TreedocModel&&this.options.model instanceof b){this.loadGridViewModel(this.options.model)}this.onReady(function(){this.elements.container.addClassName("wux-layout-gridview");this.elements.container.setAttribute("tabindex","0");if(this.options._observeDragAndDropEvents===undefined){this._observeDragAndDropEvents();this.options._observeDragAndDropEvents=true}if(this.options._observeDoubleClickEvent===undefined){this._observeDoubleClickEvent();this.options._observeDoubleClickEvent=true}this._updateCheckBoxVisibility();this._updateStrectchBackgroundImage();this._updateTitleDisplayedOnTwoLines();var v=this;if(this.options._observeContextualEvent===undefined){this.options._observeContextualEvent=true;var t=v.options.onContextualEvent;if(t){h.addEventListener(this.elements.container,{callback:function(y){var x=v._cellCtxMenuRequired?true:false;v._cellCtxMenuRequired=false;return t.callback.call(t["this"],{context:y.context,infos:y.info,data:y.data,cellInfos:undefined,infoContext:y.context,cellCtxMenuRequired:x})}})}else{var u=this.options.onContextualMenuReady;var s=u;if(typeof u==="function"){s=function(){var x=undefined;return u.call(v,x)}}n.onReady({target:this.elements.container,nodes:s})}}if(this.options.delayedInputModel){this.updateModel(this.options.model);this.options.delayedInputModel=null}var r=this.getScroller();if(r&&this.options.responsiveWidthBehavior){var w=r.getContent().getDimensions();this.onTileGridViewResize(w)}})},_onCellClickOrPointerDown:function(D){var w=this;var p=w.options.checkboxVisibilityFlag;if(p==="atCellHover"){var B=window.getComputedStyle(D.cellView._view.elements.checkbox.getContent());var x=B.display;if(x==="none"){w._isTouchWithatCellHover=true}}w._needToSelectAtRelease=false;if(D.cellModel.isSelected()&&!w.isInShiftSelection()){var o=D.event;if(o&&g.isTouchEvent(o)){if(w.options.selection.toggle&&w.isInMultiSelection()===true){D.cellModel.unselect()}}else{w._needToSelectAtRelease=true;return}}else{if(!w.isInMultiSelection()&&!w.isInShiftSelection()){w.options.TreedocModel.getXSO().empty()}w.setActiveNode(D.cellModel,false);D.cellModel.select();if(!w.isInShiftSelection()){w.options.lastSelectedNode=D.cellModel}}if(w.isInShiftSelection()&&w.options.lastSelectedNode!==D.cellModel){w.options.TreedocModel.prepareUpdate();w.options.TreedocModel.getXSO().empty();var q=w.options.lastSelectedNode;var y=D.cellModel;if(q&&y){var s=q._getRowID(true);var v=y._getRowID(true);var t=v>s?s:v;var A=t===s?v:s;var r=w.options.model;var u=0;var z=[];for(u=t;u<=A;u++){var C=r[u];if(C.isVisible()&&!C.isSelected()){w.setActiveNode(C,false);z.push(C)}}w.options.TreedocModel.getXSO().add(z);w.options.TreedocModel.pushUpdate()}}},firstParentWithClass:function(q,p){var o=q;if(o){var r=(" "+o.className+" ").replace(/[\n\t]/g," ").indexOf(" "+p+" ")>-1;if(r){return o}else{return this.firstParentWithClass(o.parentNode,p)}}else{return}},hasClass:function(p,o){var q=(" "+p.className+" ").replace(/[\n\t]/g," ").indexOf(" "+o+" ")>-1;return q},_observeDragAndDropEvents:function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this));this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},_observeDoubleClickEvent:function(){var o=this;o.elements.container.addEventListener("dblclick",function(q){var p=o.firstParentWithClass(q.target,"wux-datagrid-cell");if(q.which===1&&p&&p.dsView){var r=p.dsView.getCellInfos();r.event=q;if(r.cellModel!==undefined){o._modelEvents.publish({event:"dblclick",context:r.cellModel,data:r})}}})},_processDragAndDropCallback:function(u){var v=this;var t=this.firstParentWithClass(u.target,"wux-datagrid-cell");var w={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var A=w[u.type];var x=t&&t.dsView?t.dsView.getCellInfos():{manager:this};if(u.type==="dragstart"){var p=true;var y=v.options.TreedocModel?v.options.TreedocModel.getXSO():undefined;if(y&&x.nodeModel){p=y.isIn(x.nodeModel)}var z=v.options.TreedocModel?v.options.TreedocModel.options.shouldAcceptDrag(x.cellModel):false;if(z&&p){if(u.dataTransfer){var s=u.target.getBoundingClientRect();var r=u.clientX-s.left;var o=u.clientY-s.top;if(typeof(u.dataTransfer.setDragImage)==="function"){u.dataTransfer.setDragImage(u.target,r,o)}}}else{u.preventDefault()}}function q(F,B){var E=false;var C=v.options[F+B];if(C){E=C.call(x.parent,u,x);if(i&&F!=="onDragOver"){console.info("[dnd]",F+B,">",E,u.target)}}else{if(i){console.warn("[dnd]","cannot find",F+B,"callback")}}var D=v.options[F+B+"Default"];if(D){if(C===undefined||(C&&E)){if(i){if(C&&E){console.info("\t>[dnd]","dev want to continue to the default behavior for ",F+B," callback")}else{console.info("\t>[dnd]","use the default behavior for ",F+B," callback")}}D.call(x.parent,u,x)}}}if(x.cellView){q(A,"Cell")}else{q(A,"Blank")}},_updatePoolSelectedViews:function(o){this.processPoolCells(function(s){var r=s.cellView;if(r){var p=r.getCellInfos();if(p){var q=p.cellModel;if(q!==undefined&&q===o){if(this.options.enableActiveUI){if(q===this.options.activeNode){r.activate()}else{r.deactivate()}}if(o.isSelected()){r.highlight()}else{r.unhighlight()}}}}})},_updateAllPoolSelectedViews:function(){this.processPoolCells(function(r){var q=r.cellView;if(q){var o=q.getCellInfos();if(o){var p=o.cellModel;if(p!==undefined){if(this.options.enableActiveUI){if(p===this.options.activeNode){q.activate()}else{q.deactivate()}}if(p.isSelected()){q.highlight()}else{q.unhighlight()}}}}})},setActiveNode:function(p,o){return this._setActiveNode(p,o)},_setActiveNode:function(p,o){this.options.activeNode=p;if(o===true){if(this.options.enableActiveUI){this._modelEvents.publish({event:"active",context:p,data:p._getNodeInfos()})}}},_flattenTreeDocument:function(o){var p;if(o){p=o.getAllDescendants().filter(function(q){return q.isVisible()})}if(this.options.layoutOnSingleRow===true){this.options.numberOfColumns=p.length}return p},_observeSelMultiSel:function(){var s=this;this._modeIsMultiSel=false;this._modeIsListSel=false;this._modeIsShiftSel=false;var p=false;function o(x){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var A=z._getNodeInfos();if(A){var y=u(A,x);if(y.node){s.options.mutePoolrefresh=true;s.setActiveNode(y.node,false);s.options.lastSelectedNode=y.node;s.options.mutePoolrefresh=false;y.node.select(true);r(y.node,y.index)}}}p=false}function v(x){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var A=z._getNodeInfos();if(A){var y=u(A,x);if(y.node){s.setActiveNode(y.node,true);r(y.node,y.index)}}}p=false}function t(x){var C=s.options.lastSelectedNode;var y=C._getRowID(true);var B=s.options.activeNode;if(B){var E=B._getNodeInfos();if(E){var z=u(E,x);var D=w(y,z.index,B._getRowID(true));if(z.node){s.options.mutePoolrefresh=true;s.options.TreedocModel.prepareUpdate();var A=s.options.TreedocModel.getXSO();A.add(D.toSelect);A.remove(D.toUnselect);s.setActiveNode(z.node,false);s.options.mutePoolrefresh=false;s.options.TreedocModel.pushUpdate();r(z.node,z.index)}}}p=false}function u(E,z){var D=E.nodeModel._getRowID(true);var C=D+z;var B=undefined;var A=Math.ceil(s.options.model.length/s._numberOfColumns);var y=Math.ceil((D+1)/s._numberOfColumns);var x=(s._numberOfColumns===z&&A===y)||(-s._numberOfColumns===z&&1===y);while(z!==0){B=s.getCellModel(C);if(x){break}if(!B){if(z>0){z--;C--}else{z++;C++}}else{break}}return{index:C,node:B}}function w(z,E,y){var D=[];var C=[];var x=z;var A=undefined;while(x!==E){A=s.getCellModel(x);if(A&&!A.isSelected()){D.push(A)}if(E>=z){x++}else{x--}}if(x===E){A=s.getCellModel(x);if(A&&!A.isSelected()){D.push(A)}}x=((E-z)*(y-E)>=0)?E:y;var B=undefined;if(x!==y){while(x!==y){B=s.getCellModel(x);if(B&&B.isSelected()&&x!==E){C.push(B)}if(y>E){x++}else{x--}}if(x===y){B=s.getCellModel(x);if(B&&B.isSelected()){C.push(B)}}}return{toSelect:D,toUnselect:C}}function r(x,y){return s._scrollToNode(x,y)}function q(L){var z=!s.options.activeNode?s.options.lastSelectedNode:s.options.activeNode;if(z){var F=z._getNodeInfos();var B=F.nodeModel._getRowID(true);var M=s.getScrollerPosition();var G=s.getScroller();var H=G.getContent().getDimensions();var J=M.y;var E=M.x;var y=Math.ceil(H.height/(s.options.defaultCellHeight+s.options.cellSpacing.vertical));var I=Math.ceil(H.width/(s.options.defaultCellWidth+s.options.cellSpacing.horizontal));var N=0;var D=0;var A=0;var K=0;var C=1;var x=0;if(s.options.layoutOnSingleRow===false){D=B-B%s._numberOfColumns;A=(D*(s.options.defaultCellHeight+s.options.cellSpacing.vertical))/s._numberOfColumns-J;K=Math.ceil(A/(s.options.defaultCellHeight+s.options.cellSpacing.vertical))}else{D=B;A=(B*(s.options.defaultCellWidth+s.options.cellSpacing.horizontal))-E;K=Math.ceil(A/(s.options.defaultCellWidth+s.options.cellSpacing.horizontal))}if(L==="home"){return -B}else{if(L==="end"){return s.options.model.length-1-B}else{if(L==="pageup"){if(s.options.layoutOnSingleRow===false){N=-(K)*s._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B-s._numberOfColumns*C<0){x--;break}}N=-s._numberOfColumns*x}}else{N=-K;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B-C<0){x--;break}}N=-x}}return N}else{if(L==="pagedown"){if(s.options.layoutOnSingleRow===false){N=(y-K-1)*s._numberOfColumns;if(N===0){C=1;x=0;for(C=1;C<=y-1;C++){x=C;if(B+s._numberOfColumns*C>=s.options.model.length){x--;break}}N=s._numberOfColumns*x;if(N===0){if((s.options.model.length-1)%s._numberOfColumns<B%s._numberOfColumns){N=s._numberOfColumns}}}}else{N=I-K-1;if(N===0){C=1;x=0;for(C=1;C<=I-1;C++){x=C;if(B+C>=s.options.model.length){x--;break}}N=x}}return N}}}}}return 0}a.addEventOnElement(this,document,"keydown",function(y){var x=e.Event.whichKey(y);if(s.options.selection.enableListSelection&&(x==="shift"||x==="meta+[")){s._modeIsShiftSel=true}else{if(s.options.selection.canMultiSelect&&(x==="ctrl"||x==="meta+[")){s._modeIsMultiSel=true}}if(x==="ctrl+pageup"||x==="ctrl+pagedown"){y.preventDefault()}});a.addEventOnElement(this,document,"keyup",function(y){var x=e.Event.whichKey(y);if(x==="ctrl"||x==="meta+["){s._modeIsMultiSel=false}if(s.options.selection.enableListSelection&&x==="shift"||x==="meta+["){s._modeIsShiftSel=false}});if(this.options.enableKeyboardNavigation){a.addEventOnElement(this,s.getContent(),"keydown",function(z){if(p===false&&(z.target===s.getContent()||z.currentTarget===s.getContent())){var y=s.options.activeNode;if(y){var x=e.Event.whichKey(z);if([32,33,34,35,36,37,38,39,40].indexOf(z.keyCode)>-1){z.preventDefault();z.stopPropagation()}switch(x){case"ctrl+space":case"space":y.isSelected()?y.unselect():y.select();break;case"ctrl+right":v(1);break;case"shift+right":p=true;t(1);break;case"right":p=true;o(1);break;case"ctrl+left":v(-1);break;case"shift+left":p=true;t(-1);break;case"left":p=true;o(-1);break;case"ctrl+up":v(-s._numberOfColumns);break;case"shift+up":p=true;t(-s._numberOfColumns);break;case"up":p=true;o(-s._numberOfColumns);break;case"ctrl+down":v(s._numberOfColumns);break;case"shift+down":p=true;t(s._numberOfColumns);break;case"down":p=true;o(s._numberOfColumns);break;case"home":o(q(x));break;case"end":o(q(x));break;case"pageup":o(q(x));break;case"pagedown":o(q(x));break;case"ctrl+home":v(q("home"));break;case"ctrl+end":v(q("end"));break;case"ctrl+pageup":v(q("pageup"));break;case"ctrl+pagedown":v(q("pagedown"));break;case"shift+home":t(q("home"));break;case"shift+end":t(q("end"));break;case"shift+pageup":t(q("pageup"));break;case"shift+pagedown":t(q("pagedown"));break;default:}}}})}},isInMultiSelection:function(){return(this._modeIsMultiSel||this._isInteractiveMultiSelMode)},isInShiftSelection:function(){return this._modeIsShiftSel},loadGridViewModel:function(p){if(p){if(this.options.TreedocModel===p){return}var q=this;this.options.TreedocModel=p;this.options.model=this._flattenTreeDocument(p);if(this.options.model){var r=q.options.TreedocModel._getTrueRoot();if(r&&r.isVisible()){this.options.lastSelectedNode=r}else{if(r){var o=r.getVisibleChildren();if(o&&o.length>0){this.options.lastSelectedNode=o[0]}}}this._destroyPool();if(this.options._firstLoadDone===0){if(!this.getScroller()){this.options.delayedInputModel=this.options.model;this.loadModel(this.options.model,true)}else{this.loadModel(this.options.model,true)}}else{this.updateModel(this.options.model)}this.options._firstLoadDone=1;this._initSpecializedView()}if(this.options._observeSelMultiSel===undefined){this._observeSelMultiSel();this.options._observeSelMultiSel=true}this.AddModelEvents();this.options._firstLoadDone=1}},unloadGridViewModel:function(){this.RemoveModelEvents();this.options.TreedocModel=null;this.options.model=[];this._destroyPool();this.updateView(true)},AddModelEvents:function(){var q=this;var p=this.options.TreedocModel.getXSO().onChange(function(r){if(m){console.log("onChange")}if(q.options.mutePoolrefresh===true){return}q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true;q._onSelectionChange()});this._xsoEventsListener.push(p);p=this.options.TreedocModel.getXSO().onAdd(function(r){if(m){console.log("onAdd")}q._modelEvents.publish({event:"selectionAdded",context:r,data:r});q.setActiveNode(r);q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true});this._xsoEventsListener.push(p);p=this.options.TreedocModel.getXSO().onRemove(function(r){if(m){console.log("onRemove")}q._modelEvents.publish({event:"selectionRemoved",context:r,data:r});q._updatePoolSelectedViews(r);q._preventUpdateInternalModel=true});this._xsoEventsListener.push(p);var o=0;p=this.options.TreedocModel.addModelEventListener("prepareUpdate",function(r){if(m){console.log("prepareUpdate")}o++});this._modelEventsListener.push(p);p=this.options.TreedocModel.addModelEventListener("pushUpdate",function(v){if(m){console.log("pushUpdate")}o--;if(o<0){console.error("You pushed too many updates")}if(o===0){if(q.options.mutePoolrefresh){return}if(q.options.TreedocModel){var x=v.data.nodeModel;var s=q.options.model.indexOf(x);if(s===-1){if(q.options.TreedocModel._getTrueRoot()!==x){q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}else{var u=q._flattenTreeDocument(q.options.TreedocModel);var r=q.options.model;var w=false;if(u.length!==r.length){w=true}if(w===false){var t;for(t=0;t<u.length;t++){if(u[t]!==r[t]){w=true;break}}}if(w===true){q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}else{q._updateAllPoolSelectedViews()}}}else{q._updateAllPoolSelectedViews()}}}});this._modelEventsListener.push(p);p=this.options.TreedocModel.onUpdate(function(r){if(m){console.log("onUpdate")}if(q.options.mutePoolrefresh===true){return}if(!q._preventUpdateInternalModel){q._destroyPool();q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)}q._preventUpdateInternalModel=false});this._modelEventsListener.push(p);p=this.options.TreedocModel.onPostExpand(function(){if(m){console.log("onPostExpand")}q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)});this._modelEventsListener.push(p);p=this.options.TreedocModel.onPostCollapse(function(){if(m){console.log("onPostCollapse")}q.options.model=q._flattenTreeDocument(q.options.TreedocModel);q.updateView(true)});this._modelEventsListener.push(p)},RemoveModelEvents:function(){if(this.options.TreedocModel){for(var o=0;o<this._modelEventsListener.length;o++){this.options.TreedocModel.getModelEvents().unsubscribe(this._modelEventsListener[o])}this._modelEventsListener.splice(0,this._modelEventsListener.length);for(var o=0;o<this._xsoEventsListener.length;o++){this.options.TreedocModel.getXSO().unsubscribe(this._xsoEventsListener[o])}this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}},_scrollToNode:function(r,z){var A=this;if(r){var D=A.getScrollerPosition();var v=A.getScroller();var y=v.getContent().getDimensions();if(A.options.layoutOnSingleRow===false){var t=z-z%A._numberOfColumns;var s=(t*(A.options.defaultCellHeight+A.options.cellSpacing.vertical))/A._numberOfColumns;var o=A.options.defaultCellHeight;var C=D.y;var x=C+y.height-o;var p=A.getCellsContainerSize().width>A.getScroller().getContent().getDimensions().width?20:0;if(s>x){v.getContent().scrollTop=s-y.height+o+p+4}if(s<=C){v.getContent().scrollTop=s}}if(A.options.layoutOnSingleRow===true){var q=A.options.defaultCellWidth;var u=D.x;var E=u+y.width-q;var B=z*(A.options.defaultCellWidth+A.options.cellSpacing.horizontal);var w=A.getCellsContainerSize().height>A.getScroller().getContent().getDimensions().height?20:0;if(B>E){v.getContent().scrollLeft=B-y.width+q+w+4}if(B<=u){v.getContent().scrollLeft=B}}}},_onSelectionChange:function(){},onSelectionAdd:function(o){return this._modelEvents.subscribe({event:"selectionAdded"},o)},onSelectionRemove:function(o){return this._modelEvents.subscribe({event:"selectionRemoved"},o)},onGridViewCellDoubleClick:function(o){return this._modelEvents.subscribe({event:"dblclick"},o)},setCheckBoxesVisible:function(o){if(o===true){this.options.checkboxVisibleFlag=true;this.options.checkboxVisibilityFlag="always"}else{this.options.checkboxVisibleFlag=false;this.options.checkboxVisibilityFlag="never"}this._updateCheckBoxVisibility()},getCheckBoxesVisible:function(){return this.options.checkboxVisibleFlag},setCheckboxVisibilityFlag:function(o){if(o==="always"){this.options.checkboxVisibilityFlag="always"}else{if(o==="atCellHover"){this.options.checkboxVisibilityFlag="atCellHover"}else{if(o==="never"){this.options.checkboxVisibilityFlag="never"}}}this._updateCheckBoxVisibility()},getCheckboxVisibilityFlag:function(){return this.options.checkboxVisibilityFlag},_updateCheckBoxVisibility:function(){if(this.options.checkboxVisibleFlag===false){this.elements.container.setAttribute("has-checkbox","never")}else{if(this.options.checkboxVisibilityFlag==="always"){this.elements.container.setAttribute("has-checkbox","always")}else{if(this.options.checkboxVisibilityFlag==="never"){this.elements.container.setAttribute("has-checkbox","never")}else{if(this.options.checkboxVisibilityFlag==="atCellHover"){if(k.getTouchMode()===true){this.elements.container.setAttribute("has-checkbox","always")}else{this.elements.container.setAttribute("has-checkbox","atCellHover")}}}}}},setStrectchBackgroundImage:function(o){if(o){this.options.strectchBackgroundImage=true}else{this.options.strectchBackgroundImage=false}this._updateStrectchBackgroundImage()},getStrectchBackgroundImage:function(){return this.options.strectchBackgroundImage},_updateStrectchBackgroundImage:function(){if(this.options.strectchBackgroundImage){if(this.elements&&this.elements.container){this.elements.container.setAttribute("strectch-background-image","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("strectch-background-image","false")}}},getTitleDisplayedOnTwoLines:function(){return this.options.titleDisplayedOnTwoLines},setTitleDisplayedOnTwoLines:function(o){if(o){this.options.titleDisplayedOnTwoLines=true}else{this.options.titleDisplayedOnTwoLines=false}this._updateTitleDisplayedOnTwoLines()},_updateTitleDisplayedOnTwoLines:function(){if(this.options.titleDisplayedOnTwoLines){if(this.elements&&this.elements.container){this.elements.container.setAttribute("title-multiple-lines","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("title-multiple-lines","false")}}},setShouldDisplayTooltipFlag:function(o){if(o===true){this.options.shouldDisplayTooltipFlag=true}else{if(o===false){this.options.shouldDisplayTooltipFlag=false}}this.updateView(true)},getShouldDisplayTooltipFlag:function(){return this.options.shouldDisplayTooltipFlag},destroy:function(){if(this.options.TreedocModel){this.unloadGridViewModel()}a.removeAllEventsOnElement(this);this.options.lastSelectedNode=null;this._parent()}});return j});define("DS/Tree/ThumbnailGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(h,c,g,a,e,f,b){var d=g.extend({defaultOptions:{width:"100%",cellClass:a,defaultCellHeight:160,defaultCellWidth:210,cellSpacing:{horizontal:10,vertical:10},animationFlag:true},init:function(i){this._parent(i);this._initSpecializedView()},_initSpecializedView:function(){var i=this;this.onCellRequest(function(k){if(!k.isHeader){k.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var j=k.nodeModel;k.cellView.setTitle(j.options.label);k.cellView.setSubtitle(j.options.subLabel);k.cellView.setPicture(j.options.thumbnail);k.cellView.setColor(j.options.color);k.cellView.setDescription(j.options.description);if(j.options.icons&&j.options.icons.length){k.cellView.setIcon(j.options.icons[0])}else{k.cellView.setIcon("")}if(i.options.displayBadges===true){k.cellView.setBadges(k.nodeModel.getBadges())}if(this.options.enableActiveUI){if(j===this.options.activeNode){k.cellView.activate()}}if(j.isSelected()){k.cellView.highlight()}if(this._onPostRequestCellCB){this._onPostRequestCellCB.call(i,k)}}});if(this.elements.container){this.elements.container.addEvent(e.POINTERUP,function(n){if(i.options.selection.unselectAllOnEmptyArea){if(e.isTouchEvent(n)){if(i._preventSelectionForTouchScroll){return}}var l=18;if(n.target.className.indexOf("wux-controls-thumbnail")===-1){var m=h.extendElement(n.target).getDimensions();var k=m.width;var j=m.height;if(n.offsetX<(k-l)&&n.offsetY<(j-l)){if(i.options.TreedocModel){i._disableInteractiveMultiSelMode();i.options.TreedocModel.getXSO().empty()}}}}})}},setAnimationOnCartoucheOver:function(i){if(i){this.options.animationFlag=true}else{this.options.animationFlag=false}this._updateAnimationOnCartoucheOver()},_updateAnimationOnCartoucheOver:function(i){if(this.options.animationFlag){if(this.elements&&this.elements.container){this.elements.container.setAttribute("animation-on-cartouche-over","true")}}else{if(this.elements&&this.elements.container){this.elements.container.setAttribute("animation-on-cartouche-over","false")}}},onPostCellRequest:function(i){this._onPostRequestCellCB=i},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){if((this.options.selection.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-thumbnail")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-thumbnail")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-thumbnail")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-thumbnail")}}}});return d});define("DS/Tree/Tree",["UWA/Core","UWA/Class","DS/Tree/TreeListView","DS/Tree/TreeNodeView"],function(e,b,c,a){var d=c.extend({defaultOptions:{cellClass:a,defaultCellHeight:28,numberOfColumns:1,headersDimensions:{width:undefined,height:undefined},show:{rowHeaders:false,columnHeaders:false}},init:function(f){this._parent(f);this.elements.container.addClassName("wux-controls-treebase")}});d.SETTINGS=c.SETTINGS;return d});define("DS/Tree/FileTreeView",["DS/Tree/Tree","DS/Tree/Manager"],function(c,b){var d=b.extend({defaultOptions:{defaultCellMouseWidth:null,defaultCellMouseHeight:26,defaultCellTouchWidth:null,defaultCellTouchHeight:38,defaultCellHeight:26},init:function(e,f){this._parent(e,f)},getRowHeight:function(f){var e=0;if(f===-1){return this.options.defaultCellHeight}else{if(this.getTreeNodeModelFromRowID(f).isRoot()){e=this.options.defaultCellHeight+10}else{e=this.options.defaultCellHeight}}return e}});var a=c.extend({defaultOptions:{apiVersion:2,defaultCellHeight:26,managerClass:d,expanderStyle:"triangle",performances:{buildLinks:false,useRequestAnimationFrameRendering:false,debounceCellInternalUpdateTimer:1,debounceCellRequest:false}},init:function(e){e.defaultCellHeight=26;if(e.columns===undefined){this._parent(e)}else{if(e.columns.length>1){throw"You should not use multiple columns with this component."}else{if(e.columns[0].dataIndex!=="tree"){throw'You should have a column option with dataIndex "tree" '}else{this._parent(e)}}}this.elements.container.addClassName("wux-tree-filetreeview")}});return a});define("DS/Tree/CarouselView",["UWA/Core","DS/Core/Core","DS/Controls/Abstract","DS/TreeModel/TreeDocument","DS/Windows/DockingElement","DS/Utilities/Css","DS/Tree/ThumbnailGridView","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/ThumbnailCellView","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(g,d,t,m,k,v,l,h,c,a,o,w,i,u,j,f){var n=function(x){if(x.target.classList.contains("wux-layouts-carousel-main-content")){var y=g.Event.wheelDelta(x);if(y<0){p(x.currentTarget._mouseWheelArg)}if(y>0){q(x.currentTarget._mouseWheelArg)}}};var q=function(A){if(A.treeDocument){var x=A.treeDocument.getXSO();var B=x.get();if(B.length===0){A.treeDocument.getRoots()[0].select()}if(B.length>0){var y=B[B.length-1];var z=y.getPreviousVisibleNode();if(z){z.select(true);A.elements.gridView._scrollToNode(z,z._getRowID(true))}}}};var p=function(A){if(A.treeDocument){var x=A.treeDocument.getXSO();var B=x.get();if(B.length===0){A.treeDocument.getRoots()[0].select()}if(B.length>0){var y=B[B.length-1];var z=y.getNextVisibleNode();if(z){z.select(true);A.elements.gridView._scrollToNode(z,z._getRowID(true))}}}};var b=true;var r=false;var e=new h();var s=t.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(x){x.nodeView.setContent(x.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(x){x.nodeView.setContent(x.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(x){e.generateView(x.nodeModel.options.grid,{typePath:"object",readOnly:true,onViewCreated:function(y){x.nodeView.setContent(y)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(x){return x.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(x){x.nodeView.setStyles({backgroundImage:"url("+x.view.bigPicturePath(x)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:true,type:"boolean",category:"behavior"}},buildView:function(){var x=this;this.elements.container=new g.Element("div",{"class":"wux-layouts-carousel",tabindex:0});this.elements.header=new g.Element("div",{"class":"wux-layouts-carousel-header"}).inject(this.elements.container);this.elements.headerMainContainer=new g.Element("div",{"class":"wux-layouts-carousel-header-main-container"}).inject(this.elements.header);this.elements.headerTitleBar=new g.Element("ul",{"class":"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer);this.elements.headerTitle=new g.Element("span",{"class":"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar);this.elements.headerSubtitle=new g.Element("span",{"class":"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar);this.elements.headerToolbar=new g.Element("ul",{"class":"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer);this.elements.containerRel=new g.Element("div",{"class":"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent());if(!r){this.elements.gridView=new l({checkboxVisibleFlag:false,layoutOnSingleRow:true,height:"auto",infiniteScrolling:true,enableActiveUI:true,enableKeyboardNavigation:true,showScrollbarsOnHover:true})}else{this.elements.gridView=new ResponsiveThumbnailsCollectionView({displayedOptionalCellProperties:["None"],showScrollbarsOnHover:true});this.elements.gridView.layout.direction="horizontal";this.elements.gridView.layout.columnMaxWidth=190;this.elements.gridView.layout.useDynamicRowHeight=false;this.elements.gridView.getContent().setAttribute("theme-style","dark")}this.elements.gridView.getContent().setStyles({top:6,height:"auto"});this.elements.rightViewContent=new g.Element("div",{"class":"wux-layouts-carousel-right-content"});this.elements.dockingZoneContentForBottom=new g.Element("div",{"class":"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.gridView,styles:{height:"100%",position:"relative"}});this.elements.mainView=new g.Element("div",{"class":"wux-layouts-carousel-main"});this.elements.bottomDockingElement=new k({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:(r?214:168)+28,resizableFlag:false,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.elements.rightDockingElement=new k({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:true,useBordersFlag:false,collapsibleFlag:false,collapseDockingZoneFlag:false,visibleDockingZoneFlag:true});this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView;this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement;this.elements.mainViewContent=new g.Element("div",{"class":"wux-layouts-carousel-main-content"}).inject(this.elements.mainView);this.elements.mainViewLeftArrow=new o({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new j({shortHelp:f.previous,mouseRelativePosition:false}),clickMode:1});this.elements.mainViewRightArrow=new o({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new j({shortHelp:f.next,mouseRelativePosition:false}),clickMode:1});if(b){this.elements.bottomViewLeftArrow=new g.Element("div",{"class":"wux-layouts-carousel-bottom-prev wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom);this.elements.bottomViewRightArrow=new g.Element("div",{"class":"wux-layouts-carousel-bottom-next wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom)}this._observeEvents();this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container)},_postBuildView:function(){var x=this;this._parent()},_observeEvents:function(){var C=this;var D;var E;var y=function(){if(D){clearInterval(D)}if(E){clearInterval(E)}if(!r){C.getGridView()._disableAutoScroll()}};var F=function(){y();q(C);E=setTimeout(function(){D=setInterval(q,C,C.intervalTimer)},500)};var B=function(){y();p(C);E=setTimeout(function(){D=setInterval(p,C,C.intervalTimer)},500)};this.elements.mainViewLeftArrow.addEventListener("buttonclick",F);this.elements.mainViewRightArrow.addEventListener("buttonclick",B);if(b){this.elements.bottomViewLeftArrow.addEvent(i.POINTERDOWN,function(G){G.preventDefault();G.stopPropagation();C.getGridView()._enableAutoScroll({x:-10,y:0},10)});this.elements.bottomViewRightArrow.addEvent(i.POINTERDOWN,function(G){G.preventDefault();G.stopPropagation();C.getGridView()._enableAutoScroll({x:10,y:0},10)})}var z=false;var x=function(I,G,H){z=true;C.getGridView().onPostUpdateViewOnce(function(){z=false;if(H){H.call(C)}});I.call(C,C)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){x(q,C)},right:function(){x(p,C)}}});var A=function(G){G.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",A,false);this.elements.container.addEventListener("contextmenu",A,false);this.elements.mainViewLeftArrow.addEvent("mouseleave",y);this.elements.mainViewRightArrow.addEvent("mouseleave",y);if(b){this.elements.bottomViewLeftArrow.addEvent("mouseleave",y);this.elements.bottomViewRightArrow.addEvent("mouseleave",y);this.elements.bottomViewLeftArrow.addEvent(i.POINTERUP,y);this.elements.bottomViewRightArrow.addEvent(i.POINTERUP,y)}document.body.addEventListener("mouseup",y);document.body.addEventListener("mouseleave",y)},_manageKeyboardNavigation:function(x){var y=this;g.Element.addEvent.call(this.getContent(),"keydown",c.throttle(function(C){var B={input:true,textarea:true};if(B[C.target.tagName.toLowerCase()]===undefined){var z=(u.hasClass(C.target,"wux-layouts-carousel"))?C.target:u.firstParentWithClass(C.target,"wux-layouts-carousel");var D=(z===y.getContent());if(D){var A=g.Event.whichKey(C);if(x.keymap[A]!==undefined){x.keymap[A].call(y)}}}},x.throttleTime))},_applyHeight:function(x){if(this.height==="auto"){this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0})}else{if(typeof this.height==="number"){this.elements.container.setStyles({position:"",height:this.height})}}this._parent(x)},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:true});console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(B){this.elements.gridView.loadGridViewModel(this.treeDocument);if(this.treeDocument){var C=this;var y=this.treeDocument.getXSO();var A=c.debounce(function(D){C.onRightViewRequest(D)},100);var z=function(){var E=y.get();var D=E[E.length-1];C.onMainViewRequest({nodeModel:D,nodeView:C.elements.mainViewContent,view:C});A.call(C,{nodeModel:D,nodeView:C.elements.rightViewContent,view:C});C.onTitleRequest({nodeModel:D,nodeView:C.elements.headerTitle,view:C});C.onSubtitleRequest({nodeModel:D,nodeView:C.elements.headerSubtitle,view:C});if(!r){C.elements.gridView._setActiveNode(D,true)}};if(y.get().length>0){z.call(y)}y.onAdd(z);var x=this.treeDocument.getRoots();if(y.get().length===0&&x.length){this.treeDocument.getRoots()[0].select()}}this._parent(B)},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}},_applyToolBar:function(){var x=this;x.elements.headerToolbar.empty();this.toolbar.forEach(function(z){z.icon.fontIconSize="2x";z.icon.fontIconFamily=WUXManagedFontIcons.Font3DS;var A=new o({type:z.type,tooltipInfos:z.tooltipInfos,icon:z.icon,value:"1",displayStyle:"lite-borders",touchMode:true,clickMode:1}).inject(x.elements.headerToolbar);A.addEventListener("click",function y(B){B.stopPropagation();if(z.callback){z.callback()}})});this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar);this.elements.mainViewRightArrow.inject(this.elements.headerToolbar)},_applyScrollOnMainViewMouseWheel:function(x){if(this.scrollOnMainViewMouseWheel!==x){var y=this;if(this.scrollOnMainViewMouseWheel){this._mouseWheelsubscriptionDoneOneTimeAtLeast=true;g.Element.addEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=y}else{if(this._mouseWheelsubscriptionDoneOneTimeAtLeast===true){this._mouseWheelsubscriptionDoneOneTimeAtLeast=false;g.Element.removeEvent.call(this.elements.container,"mousewheel",n);this.elements.container._mouseWheelArg=y}}}},_applyProperties:function(x){this._parent(x);this._applyHeight();this._applyTreeDocument();this._applyToolBar();this._applyScrollOnMainViewMouseWheel(x.scrollOnMainViewMouseWheel)},getGridView:function(){return this.elements.gridView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement}});s.USE_COLLECTION_VIEW=r;return s});define("DS/Tree/LightBoxView",["UWA/Core","DS/Core/Core","DS/Tree/CarouselView","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/Tree/assets/nls/carousel.json"],function(g,e,b,c,a,f){var d=b.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"}},_preBuildView:function(){this._parent()},_postBuildView:function(){var h=this;window._lb=this;this._parent();this.elements.container.addClassName("wux-layouts-lightbox");this._applyVisibleFlag();var h=this},_applyVisibleFlag:function(h){if(this.visibleFlag){if(!this.elements.wrapper){this.elements.wrapper=new g.Element("div",{"class":"wux-layouts-lightbox-overlay",html:this.getContent()});this.elements.wrapper.inject(this.target)}}else{if(this.elements.wrapper){this.elements.wrapper.remove();this.elements.wrapper=undefined;this.fire("close")}}this._parent(h);var i=this;if(!b.USE_COLLECTION_VIEW){setTimeout(function(){i.getGridView().updateView(true)},1)}},_applyToolBar:function(){this._parent();var j=this;var i=new c({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:f.close,mouseRelativePosition:false}),clickMode:1}).inject(this.elements.headerToolbar);i.addEventListener("click",function h(k){k.stopPropagation();j.visibleFlag=false})}});return d});define("DS/Tree/TileGridView",["UWA/Core","UWA/Class","DS/Tree/GridView","DS/Controls/TileCellView","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/Utilities/TouchUtils"],function(h,b,g,d,c,e,a){var f=g.extend({defaultOptions:{width:"100%",cellClass:d,defaultCellHeight:70,defaultCellWidth:260,cellSpacing:{horizontal:10,vertical:10},useSwipableMenu:true,responsiveWidthBehavior:false},onTileGridViewResize:function(j){if(!this.options.responsiveWidthBehavior){return}var o=j.width;var m=this.options.defaultCellWidth;var l=this.options.cellSpacing.horizontal;var n=this.getCellsContainerSize().height>this.getScroller().getContent().getDimensions().height?20:0;var p=Math.floor((o-l-n)/(m+l));var k=(o-l-n)-(p*(m+l));if(k>50){var q=p+1;var i=((o-l-n)/q)-l;if(i>=260){this.options.defaultCellWidth=i;this.updateView(true)}else{if(p>0){q=p;var i=((o-l-n)/q)-l;this.options.defaultCellWidth=i;this.updateView(true)}}}},init:function(i){this._parent(i);this._initSpecializedView()},_initSpecializedView:function(){var i=this;this.onCellRequest(function(k){if(!k.isHeader){k.cellView._view.getContent().setStyles({width:"100%",height:"100%"});var j=k.nodeModel;k.cellView.setTitle(j.options.label);k.cellView.setSubtitle(j.options.subLabel);k.cellView.setPicture(j.options.thumbnail);k.cellView.setColor(j.options.color);k.cellView.setDescription(j.options.description);if(j.options.icons&&j.options.icons.length){k.cellView.setIcon(j.options.icons[0])}else{k.cellView.setIcon("")}if(i.options.displayBadges===true){k.cellView.setBadges(k.nodeModel.getBadges())}if(this.options.enableActiveUI){if(j===this.options.activeNode){k.cellView.activate()}}if(j.isSelected()){k.cellView.highlight()}if(this._onPostRequestCellCB){this._onPostRequestCellCB.call(i,k)}}});this.onGridResize(function(j){this.onTileGridViewResize(j)});if(this.elements.container){this.elements.container.addEvent(c.POINTERUP,function(n){if(i.options.selection.unselectAllOnEmptyArea){if(c.isTouchEvent(n)){if(i._preventSelectionForTouchScroll){return}}var l=18;if(n.target.className.indexOf("wux-controls-tile")===-1){var m=h.extendElement(n.target).getDimensions();var k=m.width;var j=m.height;if(n.offsetX<(k-l)&&n.offsetY<(j-l)){if(i.options.TreedocModel){i._disableInteractiveMultiSelMode();i.options.TreedocModel.getXSO().empty()}}}}})}},onPostCellRequest:function(i){this._onPostRequestCellCB=i},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=true;this._enableInteractiveMultiSelMode()},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelection=false;this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){if((this.options.selection.canInteractiveMultiselectWithCheckboxClick||this._interactiveCumulativeSelection===true)&&this.elements.container.className.indexOf("wux-multiselmode-tileView")===-1){if(this._isInteractiveMultiSelMode===false){this._isInteractiveMultiSelMode=true;this.elements.container.addClassName("wux-multiselmode-tileView")}}},_disableInteractiveMultiSelMode:function(){if(this._interactiveCumulativeSelection===false&&this.elements.container.className.indexOf("wux-multiselmode-tileView")){if(this._isInteractiveMultiSelMode===true){this._isInteractiveMultiSelMode=false;this.elements.container.removeClassName("wux-multiselmode-tileView")}}}});return f});define("DS/Tree/MultiViews",["UWA/Core","UWA/Element","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Tree/TreeListView","DS/Tree/ThumbnailGridView","DS/Tree/TileGridView"],function(d,c,g,f,l,b,j,e,h,i){var a={useRequestAnimationFrameRendering:true,debounceCellInternalUpdateTimer:0,debounceCellRequest:false};var k=g.inherit({name:"multiviews",publishedProperties:{views:{defaultValue:{listview:{id:"listview",icon:"list",buildView:function(m){var n=new e({apiVersion:2,infiniteScrolling:true,columns:[{text:"",dataIndex:"selection",type:"selection",width:40},{dataIndex:"color2",width:40,getValue:function(o){return o.nodeModel.options.color},onCellRequest:function(p){if(!p.isHeader){var o=p.cellView.reuseCellContent("color2");if(o){o.setStyles({backgroundColor:p.nodeModel.options.color})}}}},{dataIndex:"ctx",width:40,onCellRequest:function(o){if(!o.isHeader){o.cellView.reuseCellContent("ctx")}}},{dataIndex:"tree",width:"auto"},{dataIndex:"subtitle",width:"auto",getValue:function(o){return o.nodeModel.options.subLabel}}],height:"auto",selection:{toggle:false},useAsyncPreExpand:true,performances:a});n.getManager().registerReusableCellContent({id:"color2",buildContent:function(){return new d.Element("div",{styles:{"border-radius":10,display:"inline-block",border:"1px solid #9d9d9d","vertical-align":"middle",position:"absolute",top:5,left:10,width:20,height:20}})}});n.getManager().registerReusableCellContent({id:"ctx",buildContent:function(){return new d.Element("div",{"class":"wux-ui-fa wux-ui-fa-chevron-down"})}});return n},loadModel:function(m){this.getManager().loadDocument(m.treeDocument)},onBeingActive:function(){this.giveFocus()}},tileview:{id:"tileview",icon:"th-list",buildView:function(m){return new i({height:"auto",})},loadModel:function(m){this.loadGridViewModel(m.treeDocument)}},thumbnailview:{id:"thumbnailview",icon:"th-large",buildView:function(m){return new h({height:"auto",performances:a})},loadModel:function(m){this.loadGridViewModel(m.treeDocument)}}},type:"object",category:"Appearance"},activeView:{defaultValue:"listview",type:"string",category:"Appearance"},treeDocument:{defaultValue:null,type:"object",category:"Model"}},_preBuildView:function(){this.elements.container=new d.Element("div",{"class":"wux-layouts-multiviews",tabindex:0});this.elements.containerRel=new d.Element("div",{"class":"wux-layouts-multiviews-rel",tabindex:0}).inject(this.elements.container);this.elements.toolbar=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar"}).inject(this.elements.containerRel);this.elements.content=new d.Element("div",{"class":"wux-layouts-multiviews-content"}).inject(this.elements.containerRel);this.elements.toolbarSelection=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-selection"}).inject(this.elements.toolbar);this.elements.toolbarNumberOfElements=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-numberElements"}).inject(this.elements.toolbar);this.elements.toolbarViews=new d.Element("div",{"class":"wux-layouts-multiviews-toolbar-views"}).inject(this.elements.toolbar);this.elements.buttonGroup=new b();this.elements.buttonGroup.inject(this.elements.toolbarViews);this._parent()},_applyActiveView:function(){var n=this;for(var o in this.views){var m=this.views[o];console.warn(n.activeView,m.id,n.activeView===m.id);if(n.activeView===m.id){n.elements.content.setContent(m.view);m.loadModel.call(m.view,{treeDocument:n.treeDocument});this.elements.buttonGroup.value=n.activeView}}},_applyViews:function(){console.info("apply views");this._parent();this.elements.toolbarViews.empty();this.elements.content.empty();this.elements.buttonGroup=new b({minWidth:110});this.elements.buttonGroup.inject(this.elements.toolbarViews);var n=this;for(var o in this.views){var m=this.views[o];n.elements.buttonGroup.addChild(new j({type:"radio",iconSize:"2x",minWidth:110,emphasize:"info",displayStyle:"lite",icon:m.icon,value:m.id}));if(m.buildView){if(m.view===undefined){m.view=m.buildView.call(n,{treeDocument:n.treeDocument})}}}this.elements.buttonGroup.addEventListener("change",function(p){n.activeView=p.dsModel.value[0];if(n.views[p.dsModel.value].onBeingActive){n.views[p.dsModel.value].onBeingActive.call(n.views[p.dsModel.value].view)}})},getView:function(m){return this.views[m].view},_applyTreeDocument:function(){if(this.treeDocument){var p=this;for(var q in this.views){var n=this.views[q];if(n.loadModel){n.loadModel.call(n.view,{treeDocument:p.treeDocument})}}var o=p.treeDocument.getAllDescendants().length;var m=p.treeDocument.getXSO();m.onChange(function(){var r=p.treeDocument.getAllDescendants().length;p.elements.toolbarNumberOfElements.setText(r.toString());p.elements.toolbarSelection.setText(m.get().length.toString())});p.elements.toolbarNumberOfElements.setText(o.toString());this.elements.toolbarSelection.setText(m.get().length.toString())}},_applyDisabled:function(){this._parent();if(this.disabled){this.elements.container.setAttribute("tabindex",-1)}else{this.elements.container.setAttribute("tabindex",0)}},_applyProperties:function(m){this._parent(m);this._applyViews();this._applyTreeDocument();this._applyActiveView()}});return k});