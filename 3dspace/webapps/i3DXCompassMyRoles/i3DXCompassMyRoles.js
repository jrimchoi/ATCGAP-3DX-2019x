define("DS/i3DXCompassMyRoles/Collection/RoleCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection"],function(c,b,a){return a.extend({url:"api/roles/self",model:b,parse:function(d){return d.roles}})});define("DS/i3DXCompassMyRoles/View/RoleView",["UWA/Core","UWA/Class/View","DS/UIKIT/Modal","DS/i3DXCompass/Controls/IframeLoader","i18n!DS/i3DXCompassMyRoles/assets/nls/i3DXCompassMyRoles"],function(e,d,a,c,b){return d.extend({tagName:"div",className:"role-view",render:function(){this.container.setContent(this._createTemplate());this.container.addEvent("click",this._openDetail.bind(this));return this},_createTemplate:function(){return[{"class":"role-header",html:{tag:"p",text:this.model.get("name")}},{"class":"role-body",html:[{tag:"i","class":"role-image-shadow"},this.model.get("icon")?{tag:"img","class":"role-image-icon",src:this.model.get("icon")}:{tag:"i","class":"role-image fonticon fonticon-role fonticon-2x"},this._buildInformation()]}]},_buildInformation:function(){var f=this.model.get("appsCount")?this.model.get("appsCount"):0;return{"class":"role-content",html:[{html:[{tag:"span","class":"fonticon fonticon-drive"},{tag:"span",text:b.apps.format(f)}]},this.model.get("until")?{html:[{tag:"p",html:[{tag:"span","class":"fonticon fonticon fonticon-clock"},{tag:"span",text:b.expire.format(this.model.get("until"))}]}]}:null]}},_openDetail:function(){var f=new a({className:"compass-modal compass-request-modal",closable:true,visible:true,events:{onHide:function(){f.destroy()}},header:"<h4>"+this.model.get("name")+"</h4>",body:new c({src:this.model.get("description"),text:b.noAdditional})}).inject(document.body)}})});define("DS/i3DXCompassMyRoles/Collection/PlatformCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection","DS/i3DXCompassServices/i3DXCompassServices"],function(e,d,a,c){var b=d.extend({idAttribute:"platformId"});return a.extend({url:"",model:b,sync:function(j,i,f){var g=this,h=f.onComplete;c.getPlatformServices({onComplete:h})}})});define("DS/i3DXCompassMyRoles/View/RolesView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner","DS/UIKIT/Modal","DS/i3DXCompass/Controls/IframeLoader","DS/i3DXCompassMyRoles/View/RoleView"],function(f,d,b,a,c,e){return d.extend({tagName:"div",className:"roles-view",render:function(){this.container.setContent(this._createTemplate());return this},_createTemplate:function(){return this.collection.map(function(g){return{"class":"role-view-wrapper",html:new e({model:g}).render()}})}})});define("DS/i3DXCompassMyRoles/i3DXCompassMyRoles",["UWA/Core","UWA/Class","DS/UIKIT/Mask","DS/i3DXCompassMyRoles/View/RolesView","DS/i3DXCompassMyRoles/Collection/RoleCollection","DS/i3DXCompassMyRoles/Collection/PlatformCollection","DS/W3DXComponents/Views/Layout/ScrollView","DS/i3DXCompassCore/RequestOptions","css!DS/i3DXCompassMyRoles/i3DXCompassMyRoles","i18n!DS/i3DXCompassMyRoles/assets/nls/i3DXCompassMyRoles"],function(e,a,d,c,h,b,f,g,i){return a.extend({widget:null,init:function(j){this.widget=j.widget;this.platform=j.platform;g.setupLanguage(this.widget.lang);this._initWidgetEvents()},_initWidgetEvents:function(){var j=this,k=j.widget;k.addEvents({onLoad:j._initWidgetPreferences.bind(j)})},_initWidgetPreferences:function(){var k=this,l=k.widget,j=[];this.collection=new b();this.collection.fetch({onComplete:function(){k.collection.forEach(function(m){j.push({label:m.get("displayName"),value:m.get("platformId"),id:m.get("platformId")})});if(k.collection.size()>1){l.addPreference({type:"list",id:"x3dPlatformId",name:"x3dPlatformId",label:i.platform,defaultValue:l.getValue("x3dPlatformId"),options:j})}k._onLoad()}})},_getCurrentPlatform:function(){var k=this.widget.getValue("x3dPlatformId"),j;if(k&&k!==""){j=this.collection.get(k)}return j||this.collection.first()},_onLoad:function(){var l=this.widget.body,j=this._getCurrentPlatform(),m=new h(),k=new c({collection:m});d.mask(l);this.widget.setTitle(j.get("displayName"));l.setContent(e.createElement("div",{"class":"i3DXCompass-my-roles",html:new f({useInfiniteScroll:false,usePullToRefresh:false,orientation:"vertical",view:k}).render()}));m.fetch({data:{platform:j.get("platformId")},onComplete:function(){d.unmask(l);k.render()},onFailure:function(){d.unmask(l);k.render()}})}})});