define("DS/W3DDashboardSearchActions/Utils",["UWA/Utils"],function(b){function c(d){return d.replace(/\/$/,"")}var a={getServiceUrl:(function(){var d={};return function(e){return new Promise(function(g,f){if(d[e]){g(d[e]);return}require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(h){h.getServiceUrl({serviceName:e,onComplete:function(i){g(d[e]=i)},onFailure:function(i){f(i)}})})})}}()),navigateTo:function(f){var d=f.dashboardModelId,e=f.tabId,g=f.tabName&&b.encodeUrl(f.tabName),i=f.manageDashboardModelId,h=f.manageDashboardFacet;return a.getServiceUrl("3DDashboard").then(function(j){var k;if(!j||j.length===0){throw new Error("No platform available for 3DDashboard service")}k=j[0].url;if(!k){throw new Error("3DDashboard URL could not be retrieved")}if(c(k)===c(window.dsBaseUrl)&&!/addinmode/.test(window.location.search)){require(["DS/Dashboard/PublicAPI","DS/Dashboard/Navigation","DS/Dashboard/Modals/ManageDashboard","DS/TransientWidget/TransientWidget"],function(l,o,n,m){m.closeWidget();setTimeout(function(){o.routeTo({dashboard:d,tab:g});e&&l._setActiveTab(e);if(i||h){n.show({refresh:true,dashboardId:i||d,facet:h})}})})}else{window.open(k+"#dashboard:"+(d||i)+(g?"/tab:"+g:"")+(h?"/manage:"+h:""))}})},removeNamespace:function(d){return d.replace(/^.+?:/,"")}};return a});define("DS/W3DDashboardSearchActions/views/Preview",["UWA/Core","DS/W3DDashboardSearchActions/Utils","DS/SNInfraUX/SearchPreviewContainer","DS/Handlebars/Handlebars4","i18n!DS/W3DDashboardSearchActions/assets/nls/main","css!DS/W3DDashboardSearchActions/views/preview"],function(h,c,a,f,e){var b={primaryContent:f.compile('{{#if description}}<p class="description">{{description}}</p>{{/if}}<ul>    {{#each children}}<li class="{{#if dummy}}dummy{{/if}}">        <a class="tab-name" data-tab-id="{{w_id}}">{{name}}</a>        <ul>            {{#each children}}<li>{{name}}</li>{{/each}}        </ul>    </li>{{/each}}</ul>')};function g(k,l,j){var i;i=k.map(function(m){return m.w_id});if(!j){j=k.map(function(m){if(i.indexOf(m.p_id)===-1){return m.p_id}}).filter(function(m){return !!m})[0]}return k.filter(function(m){return m.p_id===j}).map(function(m){return{p_id:m.p_id,w_id:m.w_id,name:m.name,children:g(k,l,m.w_id)}}).sort(l)}function d(k,j,i){k=k.slice(0);while(k.length%j!==0){k.push(i)}return k}return a.extend({getPrimaryContent:function(i){if(!i||!i.onComplete){return}var k=[],j;try{k=JSON.parse(i.searchmodel.get("ds6w:tabs_value"))}catch(l){return i.onFailure("Dashboard tabs could not be retrieved")}i.onCusto({layout:"horizontal"});j=h.createElement("div",{"class":"ifwe-search-primary",html:b.primaryContent({dashboardTabsNLS:e.dashboardTabs,description:i.searchmodel.get("ds6w:wi_description_value"),children:d(g(k,function(n,m){if(n.name<m.name){return -1}if(n.name>m.name){return 1}return 0}),6,{name:"",children:[],dummy:true})})});[].forEach.call(j.querySelectorAll(".tab-name"),function(m){m.addEventListener("click",function(){var o=m.getAttribute("data-tab-id"),n=k.filter(function(p){return p.w_id===o})[0];c.navigateTo({dashboardModelId:c.removeNamespace(i.searchmodel.id),tabId:n.w_id,tabName:n.name})})});i.onComplete(j)},getSecondaryContent:function(j){if(!j||!j.onComplete){return}var i=j.searchmodel,l={type:e.typeValue,title:i.get("ds6w:label"),creationDate:i.get("ds6w:created"),modificationDate:i.get("ds6w:modified")},k=i.get("ds6w:responsible");if(k){l.responsible=k}j.onFailure(Object.keys(l).map(function(m){return{id:m,title:e[m],value:l[m]}}))}})});define("DS/W3DDashboardSearchActions/3DDashboard",["UWA/Promise","DS/W3DDashboardSearchActions/Utils","i18n!DS/W3DDashboardSearchActions/assets/nls/main"],function(c,b,d){var a={getFacets:function(i){var l,f,j,h=i.model,k=b.removeNamespace(h.get("sourceid")),g=[];try{g=JSON.parse(h.get("ds6w:members_value"))}catch(m){}j=g.length>1;l=["properties"];f=[{text:d.propertiesFacet,name:"properties",icon:"doc-log",expandedFlag:true}];if(j){l.push({require:"DS/W3DDashboardSearchActions/views/Members",facet:{text:d.membersFacet,name:"members",icon:"users"},options:{members:g,source:k,dashboardModelId:b.removeNamespace(h.id)}});f.push({name:"members",expandedFlag:true})}i.setFacets(l,f)},getActions:function(f){var e={actions:[],status:"success"},g;if(!f||!f.onComplete){throw new Error("Unexpected argument format")}if(!f.models||f.models.length!==1){e.status="failure";return f.onComplete(e)}g=f.models[0];e.actions.push({id:g.get("id"),actions:[{title:d.goToDashboard,icon:"login",id:"goToDashboard",multisel:false,sourcejs:"DS/W3DDashboardSearchActions/3DDashboard"}]});return f.onComplete(e)},executeAction:function(f){var e=b.removeNamespace(f.object_id||f.object_ids[0]||"");if(!e){throw new Error("Expected dashboard model id to execute search action")}return b.navigateTo({dashboardModelId:e})},getDoubleClickAction:function(e){if(!e||!e.onComplete){return}e.onComplete({sourceJS:"DS/W3DDashboardSearchActions/3DDashboard",id:"open"})},getRenderPreview:function(e){if(!e||!e.onComplete){return}require(["DS/W3DDashboardSearchActions/views/Preview"],function(f){e.onComplete(new f())})}};return a});define("DS/W3DDashboardSearchActions/views/Members",["UWA/Core","DS/W3DDashboardSearchActions/Utils","DS/EditPropWidget/facets/Common/FacetsBase","DS/Handlebars/Handlebars","DS/UIKIT/Tooltip","css!DS/W3DDashboardSearchActions/views/members"],function(f,d,c,e,b){var a={content:e.compile('<ul>    {{#each members}}<li class="member-profile">        <img src="{{avatar}}" alt="{{firstname}} {{lastname}}" />    </li>{{/each}}</ul>')};return c.extend({init:function(h){var g;this._parent.apply(this,arguments);if(!this.elements.container){g=this.elements.container=f.createElement("div",{"class":"ifwe-search-members"})}d.getServiceUrl("3DSwym").then(function(j){var i=(j.filter(function(k){return k.platformId===h.source})[0]||j[0]).url;f.createElement("div",{html:a.content({members:h.members.map(function(k){return{firstname:k.first_name,lastname:k.last_name,avatar:i+"/api/user/getpicture/login/"+k.login+"/format/normal"}})})}).inject(g);[].forEach.call(g.querySelectorAll("img"),function(k){new b({position:"top",target:k,body:k.alt});k.addEventListener("click",function(){d.navigateTo({manageDashboardModelId:h.dashboardModelId,manageDashboardFacet:"members"})})})})}})});