/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/3DPlayHelper/SplashScreen",["DS/WebappsUtils/WebappsUtils","UWA/Core","DS/WebSystem/Environment","UWA/Controls/Abstract","DS/WebUtils/ProbesManager","css!DS/3DPlayHelper/SplashScreen","i18n!DS/3DPlayHelper/assets/nls/SplashScreen"],function(e,g,d,f,c,b,a){return f.extend({defaultOptions:{},views:{},init:function(h){this._parent(h);this._buildView(h);if(h){if(h.autoplay===true){this.showView(this.views.loading);if(h.onClick){h.onClick(this)}}else{var i=function(){this.showView(this.views.loading);this.removeOnClick();if(h.onClick){h.onClick(this)}i=null}.bind(this);this.setOnClick(i)}if(h.container){if(h.containerOptions){if(h.containerOptions.insertBefore){h.container.insertBefore(this.elements.container,h.container.firstElementChild)}}else{this.inject(h.container)}}if(h.callback){h.callback(this)}}},_buildView:function(p){var i=document.createDocumentFragment();this.formFactor="";if(i.ownerDocument.documentElement.offsetWidth>780&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="L"}else{if(i.ownerDocument.documentElement.offsetWidth<779&&i.ownerDocument.documentElement.offsetWidth>581&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="M"}else{if(i.ownerDocument.documentElement.offsetWidth<580&&i.ownerDocument.documentElement.offsetWidth>280&&i.ownerDocument.documentElement.offsetHeight>200){this.formFactor="S"}else{if(i.ownerDocument.documentElement.offsetWidth<280||i.ownerDocument.documentElement.offsetHeight<200){this.formFactor="XS"}else{this.formFactor="L"}}}}this.custoContainer=new g.Element("div",{"class":"PlayWeb-bgd-custo"}).inject(i);var l=this;if(p&&p.custom!==undefined&&p.custom!==null){if((typeof p.custom)==="string"){this.custoContainer.innerHTML=p.custom;var o=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall_button_withHalo-03.svg";l.clickLogoImg=new g.Element("div",{"class":"click-logo-img",display:"block",styles:{"background-image":"url('"+o+"')"}}).inject(this.custoContainer)}else{try{this.custoContainer.appendChild(p.custom)}catch(m){}}}var k=new g.Element("div",{styles:{width:"100%",height:"100%"}});var j=(p)?p.logoDisplay:undefined;var n=(p&&(typeof p.customLogoSrc)==="string")?p.customLogoSrc:undefined;var h=(p&&(typeof p.customAppName)==="string")?p.customAppName:undefined;this._add3DPlayLogoView(k,j,n,h);this._addLoadingView(k);this._addNotificationView(k);this._addErrorView(k);this.showView=function(q){for(var r in this.views){if(this.views.hasOwnProperty(r)){this.views[r].style.display="none"}}q.style.display="block"};i.appendChild(k);if(j==="onHover"){var l=this;k.addEvents({mouseenter:function(){if(l.clickLogoImg){l.clickLogoImg.style.opacity=1}if(l.options.custom===undefined||l.options.custom===null){l.viewLogo.style.opacity=1}},mouseleave:function(){if(l.clickLogoImg){l.clickLogoImg.style.opacity=0}if(l.options.custom===undefined||l.options.custom===null){l.viewLogo.style.opacity=0}}})}this.elements.container=new g.Element("div",{"class":"SHAREPluginless_background"});if(p&&(typeof p.customBgColor)==="string"){this.elements.container.style.backgroundColor=p.customBgColor}this.elements.container.appendChild(i)},_add3DPlayLogoView:function(h,o,k,j){var l=k?k:e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayOnclickPage.svg";var n=this;var i=new Image();i.onload=function(){n.viewLogo.style.backgroundImage="url("+i.src+")";c.end("Splashscreen");n=null};i.src=l;var m={display:"block","background-image":"url('"+l+"')"};if(o==="onHover"){g.extend(m,{opacity:0,transition:"opacity 0.5s ease-in-out"})}this.viewLogo=new g.Element("div",{"class":"PlayWeb-splash-view",styles:m}).inject(h);this.views.logo=this.viewLogo},_addLoadingView:function(h){var j=this;var i=new Image();i.onload=function(){j.viewLoading.style.backgroundImage="url("+i.src+")";j=null};this.viewLoading=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none",cursor:"progress",}}).inject(h);if(this.formFactor==="L"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg"}else{if(this.formFactor==="M"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayLandingPage.svg"}else{if(this.formFactor==="S"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Small-02.svg"}else{if(this.formFactor==="XS"){i.src=e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/Xsmall-03.svg"}}}}this.views.loading=this.viewLoading},_addNotificationView:function(h){this.notificationView=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(h);this.notificationContainer=document.createElement("p");this.notificationContainer.setAttribute("class","SHAREPluginless_notif");this.notificationView.appendChild(this.notificationContainer);this.views.notification=this.notificationView},_addErrorView:function(h){this.viewError=new g.Element("div",{"class":"PlayWeb-splash-view",styles:{display:"none","background-image":"url('"+e.getWebappsBaseUrl()+"3DPlayHelper/assets/images/3DPlayErrorPage.svg')"}}).inject(h);this.fatalContainer=document.createElement("p");this.fatalContainer.setAttribute("class","SHAREPluginless_notif_fatal");this.promptedContainer=document.createElement("p");this.promptedContainer.setAttribute("class","PlayWeb-notif-prompted");this.viewError.appendChild(this.fatalContainer);this.viewError.appendChild(this.promptedContainer);this.views.error=this.viewError},refreshOptions:function(h){while(this.custoContainer.firstChild){this.custoContainer.removeChild(this.custoContainer.firstChild)}if(h&&h.custom!==undefined&&h.custom!==null){if((typeof h.custom)==="string"){this.custoContainer.innerHTML=h.custom}else{try{this.custoContainer.appendChild(h.custom)}catch(i){console.error(i)}}}},setOnClick:function(h){if(this.clickCB){this.removeOnClick()}this.clickCB=h;this.elements.container.style.cursor="pointer";this.elements.container.addEventListener("click",this.clickCB,false)},removeOnClick:function(){if(this.clickCB!==undefined){this.elements.container.style.cursor="";this.elements.container.removeEventListener("click",this.clickCB,false);this.clickCB=undefined}},showFatal:function(h,i,j,k){this.fatalContainer.innerHTML="";if(k&&k.name&&a.get(k.name)){this.fatalContainer.appendChild(document.createTextNode(a.get(k.name)))}else{this.fatalContainer.appendChild(document.createTextNode(a.TextFatal))}if(i){this.promptedContainer.innerText="";this.promptedContainer.appendChild(document.createTextNode(h))}console.error("3DPlay Fatal : "+h);if(j){this.fatalContainer.appendChild(j)}this.showView(this.views.error);this.elements.container.style.display="block"},showNotification:function(h){this.notificationContainer.textContent=h;this.showView(this.views.notification);this.elements.container.style.display="block"}})});var id="3DPlay";if(typeof widget!=="undefined"){id=widget.id}window["3DPlay.ProbesManager.clapDone"]=true;window.performance.mark(id+"clap");try{window.top.performance.mark(id+"clap")}catch(err){window["3DPlay.ProbesManager.TopWindowNotAvailable"]=true}var mark=id+"_3DPlayApp";window.performance.mark(mark);var emptyfunction=function(){console.error("Empty Function")};function Player3DShare(e,d,b,c,f){var a;if(arguments.length===1){console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (same signature)");a=arguments[0]}else{console.error("You're using a very old deprecated funtion, please use Player3DPlayWeb instead (with {container:{}, input:{}, options:{}, widget:{} [,application:]})");a={};a.container=arguments[0];a.input=arguments[1];a.options=arguments[2];a.widget=arguments[3];a.application=arguments[4]}return Player3DPlayWeb(a)}var EnvironmentIsSet=function(a){return window&&window.localStorage&&window.localStorage[a]!==undefined};function Player3DPlayWeb(g){var b=function(e){return window&&window.localStorage&&window.localStorage[e]!==undefined};var j=function(e){return window.localStorage[e]};var a=function(){var k=["DS/3DPlayHelper/SplashScreen","i18n!DS/3DPlayHelper/assets/nls/3DPlayHelper","DS/WebUtils/StringUtils"];var n=["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Utils/InterCom"];var l=g;var m;var e={addScriptingFunction:emptyfunction,execute:emptyfunction,getFunctions:emptyfunction,isReady:function(){return true},load:function(p){if(m){var o;try{o=p.options.splashscreen}catch(q){o=null}m.refreshOptions(o)}l=p},loadAsset:function(o,p){this.load({input:o,options:p})}};require(k,function(s,q,r){var p={};p=l.options.splashScreen||p;m=new s(p);m.showView(m.views.logo);var o=l.container;if((typeof o)==="string"){o=document.getElementById(o)}m.inject(o);require(n,function(w,u){console.log("Player3DPlayWeb: Trying to Launch 3DPlay Native");var t=function(){m.showView(m.views.loading);var E="itms://itunes.apple.com/us/app/3dplay/id825988585?ls=1&mt=8";var D={appId:"X3DPLAY_AP"};var z=function(F){if(b("ODT_3DPLAYHELPER_IOS_EVENT")){require(["DS/Core/Events"],function(I){I.publish({event:j("ODT_3DPLAYHELPER_IOS_EVENT")})});return}var H=StringUtils.parseUrl(F.tenantURL);var G=H.hostname;G=G.toLowerCase();w.getPlatformServices({onComplete:function(M){var J=F.modelID,L=null;for(var P=0;P<M.length;P++){var I=M[P];for(var O in I){if(I.hasOwnProperty(O)&&typeof I[O]==="string"){var K=I[O].toLowerCase();if(K.contains(G)){L=I.platformId;break}}}if(L){break}}if(J&&L){var N=new u.Socket("compassPageSocket");N.subscribeServer("com.ds.compass",window.parent);N.dispatchEvent("onSetObject",{objectId:J,envId:L},"compassPageSocket");N.addListener("launchApp",function(R){console.log("Response = "+JSON.stringify(R));this.response=R.response;if(this.response!="COMPLETE"){var Q=confirm("To experience this content you need to install 3DPlay");if(Q===true){window.location=E}}});N.dispatchEvent("onLaunchApp",D,"compassPageSocket")}else{m.showFatal(q.TenantError,false);m.showView(m.views.logo)}m.showView(m.views.logo)},onFailure:function(){m.showFatal(q.PlatformNotFound,false);m.showView(m.views.logo)}})};var y=function(F){if((F.indexOf("proxy/passport?")>-1)&&(F.indexOf("url=")>-1)){F=F.substr(F.indexOf("url=")+4,F.length);if(F.indexOf("&")>-1){F=F.substr(0,F.indexOf("&"))}F=decodeURIComponent(F)}return{modelID:F.substr(F.lastIndexOf("/")+1,F.length),tenantURL:F.substr(0,F.lastIndexOf("/")+1)}};var A={},C;if(l.input){if((typeof l.input)==="string"){C=l.input}else{if(typeof l.input.asset==="string"){C=l.input.asset}else{if(l.input.asset.provider&&(typeof l.input.asset.provider)==="string"){if(l.input.asset.provider.toUpperCase()==="FILE"){C="";if(l.input.asset.serverurl){C+=l.input.asset.serverurl}if(l.input.asset.filename){C+=l.input.asset.filename}}else{if(l.input.asset.provider.toUpperCase()==="EV6"){A.modelID=l.input.asset.physicalid;A.tenantURL=l.input.asset.serverurl}}}}}if(C){var B=y(C);z(B)}else{z(A)}}};var x=[];var v=document.createElement("a");v.setAttribute("href","#");v.innerHTML="<U>"+q.LaunchNativeApp+"</U>";v.setAttribute("title",q.LaunchNativeApp);v.addEventListener("click",t,false);m.showFatal(q.DeviceNotFullySupported,true,v);m.setOnClick(t);m.showView(m.views.logo);if(b("ODT_3DPLAYHELPER_IOS")){t()}},function(u){if(u.requireType=="scripterror"){var t=u.requireModules.join(",");console.error("3DPlay ScripNotFoundError: ",t);m.showFatal(q.ScripNotFoundError+t,false)}else{console.error(u)}})},function(o){console.error("Player3DPlayWeb: 3DPlayRequire failed: "+o)});return e};try{var c=UWA.Utils.Client.Platform.ios;if(b("ODT_3DPLAYHELPER_IOS")){c=true}var h;if(c){var i=navigator.userAgent;var d=i.indexOf("OS ");if(d>-1){h=i.substr(d+3,3).replace("_",".")}if(b("ODT_3DPLAYHELPER_IOS")){h=j("ODT_3DPLAYHELPER_IOS")}}if(c&&h<8){console.log("Player3DPlayWeb: Redirecting to the native app");return a()}else{return Launch3DPlayWeb(g)}}catch(f){return Launch3DPlayWeb(g)}}function Launch3DPlayWeb(c){if(typeof c!="object"){console.error('Player3DPlayWeb:R418 => This call is deprecated! Please use a JSON object in Player3DPlayWeb({container:"", input:{}; options:{}}');switch(arguments.length){case 1:return new Player3DShare(c);case 2:return new Player3DShare(arguments[0],arguments[1]);case 3:return new Player3DShare(arguments[0],arguments[1],arguments[2]);case 4:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return new Player3DShare(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}}var d={addScriptingFunction:emptyfunction,executeScriptingFunction:emptyfunction,getScriptingFunctions:emptyfunction,hasScriptingFunction:emptyfunction,removeScriptingFunction:emptyfunction,disposeAllScriptingFunctions:emptyfunction,notifyScriptingFunction:emptyfunction,subscribeScriptingFunction:emptyfunction,unsubscribeScriptingFunction:emptyfunction,subscribeAllScriptingFunctions:emptyfunction,unsubscribeAllScriptingFunctions:emptyfunction,instance:undefined,loaded:false,_check:function(){if(!this.isReady()){console.error("Experience is not ready");return false}if(!this.instance){console.error("Experience is not created");return false}return true},getCtx:function(){if(this._check()){return this.instance.args.ctx}return undefined},isReady:function(){return(this.ctx!==null&&this.ctx!==undefined)||this.loaded},load:function(g,f){_check()},loadAsset:function(f,g){_check()},loadAnnotations:function(h,g){var i=(h&&h.annotation)?h.annotation:null;var f=(g&&g.clean)?true:false;if(this.instance&&i){this.instance.loadAnnotations(i,f);return true}else{return false}}};var e=undefined;var b=false,a=false;c=c||{};c.options=c.options||{};if(c.options.widget3DPlay){a=true}if(!a){a=true;e="Splashscreen";window.performance.mark(e)}require(["DS/3DPlayHelper/3DPlayWebPlayer","DS/WebUtils/ProbesManager","DS/3DPlaySupport/SupportList","css!DS/3DPlayHelper/SplashScreen"],function(h,g,i,f){if(c.options.platformServices){i.setPLatformServices(c.options.platformServices)}if(e){g.createProbe("Splashscreen",e)}h(d,c)});return d}define("DS/3DPlayHelper/3DPlayHelper",["UWA/Core"],function(a){return Player3DPlayWeb});define("DS/3DPlayHelper/3DPlayNativePlayer",[],function(){return{}});define("DS/3DPlayHelper/3DPlayWebPlayer",["DS/3DPlay/3DPlay","DS/3DPlayHelper/SplashScreen","DS/3DPlayConnectors/3DPlayInputPreProcessor","DS/WebSystem/Environment","DS/CoreEvents/Events","DS/WebSystem/Context","DS/WebUtils/ContextedSingleton","DS/WebUtils/ProbesManager","UWA/Core","DS/3DPlaySupport/ExperiencesList","DS/3DPlaySupport/AssetSupport","DS/3DPlaySupport/SupportList","DS/WebappsUtils/WebappsUtils"],function(k,g,n,m,c,h,d,i,f,b,a,j,e){var l=function(p,q){if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer",q)}function B(J){var H=window.localStorage["3DPlay.OverrideSettings"];if(H!==undefined){console.warn("!! 3DPlay OverrideSetting variable environment Active");console.warn("Current options :"+J.options);try{H=JSON.parse(H);if(H&&H.options){console.warn("Found options :"+H.options);J.options=f.extend(J.options,H.options,true)}}catch(I){console.error("Override failed : JSON.parse error"+I)}}console.warn("Resulting options :"+J.options);return J}var D=function(H){return function(K){try{var J=window.top.document.createEvent("CustomEvent");J.initCustomEvent("3DPLAYLOADINGFINISHED",true,false,{helper:H});window.top.document.dispatchEvent(J)}catch(I){}}};var A=function(H){return function(L){var I=window.document.getElementById("landing-page_container");if(I){I.remove()}H.loaded=true;try{var K=window.top.document.createEvent("CustomEvent");K.initCustomEvent("3DPLAYERROR",true,false,{helper:H});window.top.document.dispatchEvent(K)}catch(J){}}};var r=function(H){return function(I){if(I){H.addScriptingFunction=I.addScriptingFunction;H.getScriptingFunctions=I.getScriptingFunctions;H.executeScriptingFunction=I.executeScriptingFunction;H.hasScriptingFunction=I.addScriptingFunction;H.removeScriptingFunction=I.getScriptingFunctions;H.disposeAllScriptingFunctions=I.executeScriptingFunction;H.subscribeScriptingFunction=I.executeScriptingFunction;H.unsubscribeScriptingFunction=I.addScriptingFunction;H.subscribeAllScriptingFunctions=I.getScriptingFunctions;H.unsubscribeAllScriptingFunctions=I.executeScriptingFunction;H.instance=I;H.loaded=true}try{var K=window.top.document.createEvent("CustomEvent");K.initCustomEvent("3DPLAYREADY",true,false,{helper:H});window.top.document.dispatchEvent(K)}catch(J){}}};if(q===null||q===undefined||q.input===null||q.input===undefined){q.input={}}if(q.options===undefined||q.options===null){q.options={}}if(m.isSet("3DPlay.OverrideSettings")){q=B(q)}p.lastOptions=f.extend({},q);var y=q.options;if(y.callbacks===undefined||y.callbacks===null){y.callbacks={}}var C=true;if(y.callbacks.experience){for(var E in y.callbacks.experience){if(C&&E.toUpperCase().indexOf("EXPERIENCEREADY")>-1){C=false}}}if(C){console.warn("In 420/18x the old way :  var p3Dplay = new Player3DPlayWeb is deprecated, please give a callback");console.warn("with the object options: {callback:{experience:ExperienceReady:{function(e)}}}")}y.callbacks.eXPEriENcE={eRRoR:A(p),eXPEriENceReADy:r(p)};y.callbacks.aSSeT={lOADinGfINIsheD:D(p)};var z=q.ctx?q.ctx:q.options.ctx?q.options.ctx:h.createContext("Default");q.ctx=z;if(q.options!==undefined&&q.options.callbacks!==undefined){k.addCallbacks(q.ctx,q.options.callbacks)}p.inputPreProcessor=new n();p.endAllCommands=function(H){k.endAllCommands(H)};if((typeof q.container)==="string"){q.container=document.getElementById(q.container)}d.add(z,"helper",p);q.options.splashscreen=q.options.splashscreen||{};p.addScriptingFunction=function(){console.error("Empty Function")};p.execute=function(){console.error("Empty Function")};p.getFunctions=function(){console.error("Empty Function")};p.instance=undefined;p.loaded=false;p._check=function(){if(!this.isReady()){console.error("Experience is not ready");return false}if(!this.instance){console.error("Experience is not created");return false}return true};p.isReady=function(){return(this.ctx!==null&&this.ctx!==undefined)||this.loaded};p.options=q;if(q.input&&q.input.usage==="3DSwYm"){delete q.input.usage;var x=q.container;window.mycontainertoUse=q.container;window.swyWidgettoUse=q.widget;delete q.container;delete q.widget;var s=q.options.splashscreen;if(s&&s.custom){s.custom=s.custom.id}var o=q.options.fullscreen;if(o&&o.mode==="CUSTOM"){window.mySwymCallBack={onActivate:o.onActivate,onDeactivate:o.onDeactivate}}var t=document.createElement("iframe");t.style.position="relative";t.style.width="100%";t.style.height="100%";t.style.border="0px";t.style.top="0px";t.style.left="0px";t.allowFullScreen=t.mozAllowFullScreen=t.webkitAllowFullScreen=true;t.setAttribute("allowFullScreen","");var F=e.getProxifiedWebappsBaseUrl();try{if(window.location.origin.indexOf("3dswym")>-1||F===null){F=e.getWebappsBaseUrl()}}catch(G){F=e.getWebappsBaseUrl()}t.src=F+"3DPlayHelper/3DPlaySyndication.html?params="+encodeURIComponent(JSON.stringify(q));if(typeof q.container==="string"){x=document.getElementById(x)}x.appendChild(t);try{window.top.document.addEventListener("3DPLAYERROR",function(H){return function(J){var I=J.detail.helper;if(H.ctx===I.getCtx()){if(H.options.callbacks&&H.options.callbacks.experience&&H.options.callbacks.experience.error){H.options.callbacks.experience.error(p.getCtx())}}}}(q),false);window.top.document.addEventListener("3DPLAYREADY",function(H){return function(J){var I=J.detail.helper;if(H.ctx===I.getCtx()){p=f.extend(p,I,true);if(H.options.callback&&H.options.callback.onAnnotationShared){var K=I.getExperience();if(K&&K.setOnAnnotationShared){K.setOnAnnotationShared(H.options.callback.onAnnotationShared)}}if(H.options.callbacks){I.getExperience().addCallbacks(H.options.callbacks);if(H.options.callbacks.experience&&H.options.callbacks.experience.ExperienceReady){H.options.callbacks.experience.ExperienceReady(p.getExperience())}}}}}(q),false)}catch(G){}}else{var v=function(){i.createProbe("ExperienceReady").begin();p.inputPreProcessor.run(p.options.input,function(H){p.options.input=H;if(typeof H==="object"){H.tenantID=H.tenantID||H.tenant||q.options.tenant||q.options.tenantID}if(!H.tenantID){H.tenantID=(H.asset&&H.asset.tenant)?H.asset.tenant:undefined}window.extensionDictionaryApp=window.extensionDictionaryApp||{};window.interfaceDictionaryApp=window.interfaceDictionaryApp||{};window.componentDictionaryApp=window.componentDictionaryApp||{};k.createExperience(q)})};var u=q.options.pad3DViewer!==undefined||q.container===undefined;if(u===false){if(q.options.splashscreen.custom&&typeof q.options.splashscreen.cutom==="string"){try{q.options.splashscreen.custom=window.top.getElementById(q.options.splashscreen.custom)}catch(G){}}var w=q.options.loading==="autoplay";p.playerSplashScreen=new g({custom:q.options.splashscreen.custom,customBgColor:q.options.splashscreen.customBgColor,customLogoSrc:q.options.splashscreen.customLogoSrc,customAppName:q.options.splashscreen.customAppName,logoDisplay:q.options.splashscreen.logoDisplay,autoplay:w,container:q.container,callback:function(H){c.publish({event:"/"+z+"/EXPERIENCE/EXPERIENCESPLASHSCREEN",data:H})},onClick:v});if(q.options.loading=="preload"){v()}}else{v()}}p.load=function(I){if(m.isSet("3DPlay.OverrideSettings")){I=B(I)}if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer.Load",I)}if(this.instance){this.instance.totalLoadingAssetProfiler=i.createProbe("_Load_");this.instance.totalLoadingAssetProfiler.begin()}else{if(!this.loaded){p.options.input=I.input;return}}var J=true;if(I){I.options=I.options||{};I.options.splashscreen=I.options.splashscreen||{};if(I.options.splashscreen&&I.options.splashscreen.custom&&typeof I.options.splashscreen.cutom==="string"){try{I.options.splashscreen.custom=window.top.getElementById(I.options.splashscreen.custom)}catch(L){}}if(I.options.loading==="onclick"){J=false;I.options.loading="autoplay"}}var M=this;var K=function(){if(M.playerSplashScreen){M.playerSplashScreen.hide()}if(M.instance&&M.instance.clearView){M.instance.clearView()}M.inputPreProcessor.run(I.input,function(R){I.input=R;if(!I.options){I.options={}}I.options.newAsset=false;if(M.isReady()){var P=function(T){var S=(M.instance!==undefined&&M.instance!==null)?M.instance.args:M.lastOptions;var U=S.input.experience!==undefined?S.input.experience.filename:"";if(T===U||U.indexOf(T)>-1||(T==="3DPlayCollaborativeExperience"&&U==="DS/3DPlayDefaultExperience/3DPlayDefaultExperience")){if((typeof I.input)==="string"){I.input={asset:I.input}}I.options.newAsset=true;I.input.experience={filename:U};M.loadAsset(I.input,I.options);return}if(M.lastOptions.options&&M.lastOptions.options.splashscreen){M.lastOptions.options.splashscreen.custom=null}M.dispose();if(M.lastOptions.options){delete M.lastOptions.options.pad3DViewer}M.loaded=false;M.lastOptions.input=undefined;M.lastOptions.ctx=S.ctx;k.subscribe(M.lastOptions.ctx,"EXPERIENCE/ERROR",A(M));var V=f.extend(M.lastOptions,I,true);l(M,V)};if(I.input.experience===""){I.input.experience=undefined}var N=I.input.experience;if(N===undefined||N===null||N===""){var O=I.input.asset;N=undefined;var Q=O.provider;if(O.type||O.dtype||O.mimetype){a.getExperienceID(O,{usage:R.usage},function(S){P(S);return});return}if(N!==undefined){N=N.module}}else{if((typeof N)==="string"){N=b[N];if(N){N=N.module}}else{if(N.filename!==undefined){N=N.filename}}}P(N)}})};if(J){K()}else{try{var H=this.playerSplashScreen.elements.container.parentElement;if(this.playerSplashScreen){this.playerSplashScreen.remove();this.playerSplashScreen=null}this.playerSplashScreen=new g({custom:I.options.splashscreen.custom,customBgColor:I.options.splashscreen.customBgColor,customLogoSrc:I.options.splashscreen.customLogoSrc,customAppName:I.options.splashscreen.customAppName,logoDisplay:I.options.splashscreen.logoDisplay,container:H,containerOptions:{insertBefore:true},onClick:K});if(this.instance){this.instance.playerSplashScreen=this.playerSplashScreen}}catch(L){K()}}};p.loadAsset=function(H,I){if(m.isSet("3DPlay.Debug")){console.log("3DPlay.Debug:3DPlayWebPlayer.loadAsset",H,I)}if(H===undefined||H===null){I=true}if(I===true||I===false){console.warn('3DPLAYWEB - DEPRECATED CALL - second argment is now an object for options. If you want to clear the scene graph, add to this object the property "clearSceneGraph" with the value "true"');I={clearSceneGraph:I}}if(this.instance){this.inputPreProcessor.run(H,function(J){this.instance.load(J,I)}.bind(this))}};p.removeAsset=function(H){if(this._check()){this.instance.remove(H)}};p.sendEvent=function(H,I){if(this._check()){}};p.dispose=function(H){if(this._check()){this.loaded=this.ctx=undefined;d.removeCtx(this.getCtx());this.instance.dispose(H);this.instance=null}if(this.playerSplashScreen){this.playerSplashScreen.remove();this.playerSplashScreen=null}if(this.ctx){this.ctx=null}};p.informActiveState=function(H){if(this._check()){return this.instance.informActiveState(H)}};p.getExperience=function(){return this.instance}};return l});