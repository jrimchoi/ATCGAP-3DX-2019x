define("DS/CSIViewModelWebInterfaces/CSIVMClientRequestWithView",["DS/CSICommandBinder/CSICommandBinder"],function(a){function d(e,j){this.stackOfCallBack=[];this.defaultCallBack=e.command.defaultCallback;this.node=e.node.index_;var g=this;var h=function(l){var k=g.stackOfCallBack.shift();if(k===undefined){k=g.defaultCallBack}if(k){k(l)}};var f=c[this.node];if(f!==undefined){if(f.hasBegan()&&!f.isFinished()){f.End(undefined,true)}}var i={command:e.command.command,version:e.command.version,onComplete:h.bind(this)};c[this.node]=new b(e.node,e.serverNodeId,i,j)}var b=function(g,f,h,e){this.beginState=false;this.doState=false;this.endState=false;this.viewRequest_=g.createIterativeRequest({destinationNodeId:f,command:"CSIViewCommand",version:1,onComplete:e});h.destinationNodeId=f;this.applicativeRequest_=g.createIterativeRequest(h)};b.prototype.isFinished=function(){return(this.beginState&&this.endState)};b.prototype.hasBegan=function(){return this.beginState};b.prototype.Begin=function(e){this.applicativeRequest_.begin(e);this.viewRequest_.begin();this.beginState=true};b.prototype.Do=function(e){this.applicativeRequest_.send(e);this.viewRequest_.send()};b.prototype.End=function(g,f){var e=undefined;this.doState=true;if(f){e=new a.Parameters();e.writeBool("isCanceled",f);if(g===undefined){g=e}else{g.writeBool("isCanceled",f)}}this.applicativeRequest_.end(g);this.viewRequest_.end(e);this.endState=true};var c={};d.prototype.begin=function(g,f){var e=c[this.node];if(!e.beginState){this.stackOfCallBack.push(f);e.Begin(g)}};d.prototype.send=function(g,f){var e=c[this.node];if(!e.doState&&e.beginState){this.stackOfCallBack.push(f);e.Do(g)}};d.prototype.end=function(h,g,f){var e=c[this.node];if(!e.endState&&e.beginState){this.stackOfCallBack.push(g);e.End(h,f)}};return d});