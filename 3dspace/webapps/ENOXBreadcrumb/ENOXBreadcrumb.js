define("DS/ENOXBreadcrumb/js/Breadcrumb",["UWA/Class/View","DS/Handlebars/Handlebars","DS/UIKIT/DropdownMenu","UWA/Class/Model","UWA/Class/Collection","DS/CoreEvents/ModelEvents","text!DS/ENOXBreadcrumb/html/Breadcrumb.html","i18n!DS/ENOXBreadcrumb/assets/nls/Breadcrumb","DS/UIKIT/Tooltip","css!DS/ENOXBreadcrumb/css/Breadcrumb.css","css!DS/UIKIT/UIKIT.css"],function(w,h,r,m,C,s,d,g,z){var j="ellipsisLink";var D=1;var f=h.compile(d);var i=m.extend({idAttribute:"linkID",defaults:{linkID:"",linkText:"",linkIcon:"right-open",callback:null}});var c=C.extend({model:i});function o(E){var G=E.getSize().width;var F=E.scrollWidth;return F>G?true:false}function x(F){var E=F.getPosition();E.y+=F.getSize().height;return E}function q(F){var G=F.collection.at(F.resizeInfo.linkAfterEllipsisIdx);var E=F.container.getElement("#"+G.get("linkID"));E.style.display="none";E.previousElementSibling.style.display="none";F.resizeInfo.linkAfterEllipsisIdx++;var H={text:G.get("linkText"),name:G.get("linkID")};if(F.resizeInfo.ellpsisDropDown===null){F.resizeInfo.ellpsisDropDown=new r({target:F.container.getElement("#"+j),items:[H],altPosition:x(F.container.getElement("#"+j)),events:{onClick:function(J,I){F.onClick(J,I.name)}}})}else{F.resizeInfo.ellpsisDropDown.addItem(H)}}function t(F){var G=F.collection.at(F.resizeInfo.linkAfterEllipsisIdx);while(G===null||G===undefined){F.resizeInfo.linkAfterEllipsisIdx--;G=F.collection.at(F.resizeInfo.linkAfterEllipsisIdx)}var E=F.container.getElement("#"+G.get("linkID"));E.style.display="table-cell";E.previousElementSibling.style.display="table-cell";F.resizeInfo.linkAfterEllipsisIdx--;if(F.resizeInfo.linkAfterEllipsisIdx===D){a(F.container,F.resizeInfo)}F.resizeInfo.ellpsisDropDown.removeItem(F.resizeInfo.ellpsisDropDown.items.length-1)}function u(E,G,F){F.removeHomeText=true;E.getElement("#"+G.at(0).get("linkID")).style.display="none"}function n(E,G,F){F.removeHomeText=false;E.getElement("#"+G.at(0).get("linkID")).style.display="table-cell"}function e(F){F.resizeInfo.ellipsis=true;F.resizeInfo.linkAfterEllipsisIdx=D+1;var H=F.container.getElement("#"+j);if(H===null||H===undefined){if(F.resizeInfo.ellpsisDropDown!==null){F.resizeInfo.ellpsisDropDown.destroy()}F.resizeInfo.ellpsisDropDown=null}if(F.resizeInfo.ellpsisDropDown===null){var I=F.collection.shift();var G={linkID:j,linkText:"...",};var E=F.collection._prepareModel(G,{merge:true});F.collection.unshift([I,E]);F.render();if(F.resizeInfo.removeHomeText===true){u(F.container,F.collection,F.resizeInfo)}}else{H.style.display="table-cell";H.previousElementSibling.style.display="table-cell"}q(F)}function a(E,G){G.ellipsis=false;var F=E.getElement("#"+j);F.hide();F.previousElementSibling.style.display="none";G.linkAfterEllipsisIdx=D}function y(E,H,G){G.flexMode=true;var F=H.last();var I=E.getElement("#"+F.get("linkID"));I.style.overflow="hidden";I.style.textOverflow="ellipsis";I.style.whiteSpace="nowrap";I.style.maxWidth="1px";I.style.width="100%"}function b(E,H,G){G.flexMode=false;var F=H.last();var I=E.getElement("#"+F.get("linkID"));I.removeAttribute("style")}function l(E){if(E.resizeInfo.inResizing===false){E.resizeInfo.inResizing=true;var F=E.collection.length-1;while(o(E.container)===true&&(E.resizeInfo.flexMode===false||E.resizeInfo.ellipsis===false||E.resizeInfo.removeHomeText===false)){if(E.resizeInfo.removeHomeText===false){u(E.container,E.collection,E.resizeInfo)}else{if(E.resizeInfo.ellipsis===false&&E.resizeInfo.linkAfterEllipsisIdx<F){e(E)}else{if(E.resizeInfo.linkAfterEllipsisIdx<F){q(E)}else{if(E.resizeInfo.flexMode===false){y(E.container,E.collection,E.resizeInfo);break}else{break}}}}}E.resizeInfo.inResizing=false}}function B(E){if(E.resizeInfo.inResizing===false){E.resizeInfo.inResizing=true;while(o(E.container)===false&&(E.resizeInfo.flexMode===true||E.resizeInfo.ellipsis===true||E.resizeInfo.removeHomeText===true)){if(E.resizeInfo.flexMode===true){b(E.container,E.collection,E.resizeInfo)}else{if(E.resizeInfo.ellipsis===true){t(E)}else{if(E.resizeInfo.removeHomeText===true){n(E.container,E.collection,E.resizeInfo)}}}}E.resizeInfo.inResizing=false}l(E)}function k(E,F){if(E.container.lastElementChild){E.container.lastElementChild.removeAttribute("style")}E.resizeInfo.flexMode=false;var G={links:{links:F.toJSON()}};E.container.addContent(f(G));l(E)}function v(E,I){I=I.replace(/([. ,/:?=&])/g,"\\$1");var H=E.container.getElement("#"+I);if(H&&H.style.display==="none"){E.resizeInfo.linkAfterEllipsisIdx=E.collection.length-1}if(H){var F=H.previousElementSibling;while(F!==undefined&&F!==null){var G=F.nextElementSibling;if(F.style.display==="none"){E.resizeInfo.ellpsisDropDown.removeItem(F.getAttribute("id"))}F.parentNode.removeChild(F);F=G}}if(E.collection.length===1){E.resizeInfo.linkAfterEllipsisIdx=D;E.resizeInfo.ellipsis=false;E.resizeInfo.flexMode=false}B(E)}function A(I,F){var G,H,E=I,J;for(G in F){H=F[G];J=H.split(/[\.\[\]]/);J.unshift(I);E[G]=J.reduce(function(K,L){return K&&K[L]})}return E}var p=w.extend({name:"breadcrumb",tagName:"div",collection:null,defaultOptions:{rootID:"defaultRootID",rootIcon:"home",dividerIcon:"right-open",toolTip:false,modelEvents:null},mapping:{linkID:"rootID",linkText:"rootText",callback:"rootCallback",linkIcon:"rootIcon"},resizeInfo:{flexMode:false,ellipsis:false,removeHomeText:false,width:0,linkAfterEllipsisIdx:D,inResizing:false,ellpsisDropDown:null},domEvents:{"click .breadcrumb-link-text":"onClick","click .breadcrumb-symbol.fonticon:nth-of-type(1)":"onClick","click .breadcrumb-symbol:nth-of-type(1)":"reset","click .breadcrumb-link-text:nth-of-type(1)":"reset"},init:function(E){if(E!==undefined&&E!==null){if(E.rootID===undefined||E.rootID===null||E.rootID===""){E.rootID=this.defaultOptions.rootID}if(E.rootIcon===undefined||E.rootIcon===null||E.rootIcon===""){E.rootIcon=this.defaultOptions.rootIcon}if(E.dividerIcon===undefined||E.dividerIcon===null||E.dividerIcon===""){E.dividerIcon=this.defaultOptions.dividerIcon}else{i.prototype.defaults.linkIcon=E.dividerIcon}if(E.toolTip===undefined&&E.toolTip===null){E.toolTip=this.defaultOptions.toolTip}if(E.toolTip!==undefined&&E.toolTip!==null&&E.toolTip===true){E.toolTipText=E.toolTipText!==""&&E.toolTipText!==undefined&&E.toolTipText!==null?E.toolTipText:E.rootText!==""&&E.rootText!==undefined&&E.rootText!==null?E.rootText:""}for(var F in E){this[F]=E[F]}var G=A(E,this.mapping);this.collection=new c([]);this.collection.add(new i(G));this._parent(E);Object.getPrototypeOf(this)._context=this}else{this._parent(this.defaultOptions);Object.getPrototypeOf(this)._context=this}},resize:function(E){var F=E.container.getDimensions().width;if(E.resizeInfo.width<F){B(E)}else{if(E.resizeInfo.width>F){l(E)}}E.resizeInfo.width=F},setup:function(F){var H=this;var E=this;function G(){if(E.container.classList.contains("breadcrumb-container")){E.resize(E)}}window.addEventListener("resize",G);if(F.modelEvents&&F.modelEvents instanceof s){F.modelEvents.subscribe({event:"breadcrumb-hide"},function(){H.hide()});F.modelEvents.subscribe({event:"breadcrumb-show"},function(){H.show()});F.modelEvents.subscribe({event:"breadcrumb-reset"},function(){H.reset()});F.modelEvents.subscribe({event:"breadcrumb-add-link"},function(I){H.addLink(I)});F.modelEvents.subscribe({event:"breadcrumb-remove-link"},function(I){H.removeLink(I)})}},render:function(){var F=this;this.container.addClassName("breadcrumb-container");var I={links:this.collection.toJSON()};this.container.setHTML(f(I));this.container._breadCrumb=F;this.resizeInfo.width=this.container.getSize().width;F.resize(F);var G=I.links[0].toolTip;var H=I.links[0].toolTipText;var E=this.container.getElements(".breadcrumb-symbol")[0];if(G&&H!==""){this.addToolTip(E,H)}return this},onClick:function(E,J){var F=this;var L=null;var K=E.target.getAttribute("id");var G=J||K;for(var H=0;H<this.collection.length&&K!=="ellipsisLink";H++){if(G===this.collection.at(H).get("linkID")){L=this.collection.at(H).get("callback");var I=this.collection.at(H+1);if(I){this.removeLink(I.get("linkID"))}if(typeof(L)==="function"){L()}break}}if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-link-clicked",data:{linkID:K?K:E.target.getAttribute("data-id")}})}},show:function(){var E=this;this.container.show();if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-visible"})}},hide:function(){var E=this;this.container.hide();if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-hidden"})}},addLink:function(G){var E=this;var F=this.collection._prepareModel(G,{merge:true});this.collection.add(F);if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-link-added",data:{linkID:G.linkID}})}k(E,F)},addLinks:function(F){var E=this;for(var G=0;G<F.length;G++){E.addLink(F[G])}},removeLink:function(K){var G=this;if(this.collection.length>1){var E;var J=this.collection.findWhere({linkID:K});if(J){var H=this.collection.indexOf(J);var F=this.collection.slice(H,this.collection.length);this.collection.remove(F);E=K}if(K===null||K===undefined){var I=this.collection.pop();E=I.get("linkID")}if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-link-removed",data:{linkID:E}})}v(G,E)}},reset:function(){var E=this.collection.at(1);if(E){this.removeLink(E.get("linkID"))}if(this.modelEvents&&this.modelEvents instanceof s){this.modelEvents.publish({event:"breadcrumb-reseted"})}},addToolTip:function(E,F){new z({position:"bottom",target:E,body:F})}});return p});