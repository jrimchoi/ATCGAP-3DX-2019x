define("DS/RTProxyDriver/RTLogger",["UWA/Class","UWA/Utils"],function(c,d){var b=c.extend({init:function(k,h){var g,j=["log","info","table","error","warn","debug"];if(!k){var e={}}else{if(typeof k=="string"){var e={service:k}}else{var e=k}}this.service=e.service;this.getStringActivator=e.getStringActivator||(this.service?"logger"+this.service:"debug");this.serviceColor=h||e.color;this.backgroundColor=e.backgroundColor;this.createLogMethod=function(n,m,l,i){return function(p,o){if(!p){return null}if(!m||!console.log.bind){return console.log(p,o||"")}var q=console.log.bind(console);if((!m.levelindex&&m.levelindex!==0)||m.levels.indexOf(n)<=m.levelindex){if(typeof p=="string"){return q("%c"+(m.service?"["+m.service+"]":"")+"["+n+"] "+p,"background-color:"+(i||m.backgroundColor||"white")+";color:"+(l||m.serviceColor||"black")+";",p.indexOf("%c")!=-1?o||m.opts||"":"")}else{return q(p,o)}}else{return null}}};if(!e||!e.dontDefaultLevel){this.levels=j}for(g in this.levels){(function(l,i){i[l]=i.createLogMethod(l,i)})(this.levels[g],this)}if(!UWA.Utils.getQueryString(decodeURIComponent(document.URL),this.getStringActivator)){this.levelindex=0;var f="https://"+(document.location.hostname.indexOf("?")!=-1?document.location.hostname+"&"+this.getStringActivator+"=true&debug":document.location.hostname+"?"+this.getStringActivator+"=true&debug")}else{UWA.log("Logger init service "+this.service+", traces activated")}},setLevel:function(e){if(!e||typeof e!="string"||this.levels.indexOf(e)==-1){this.levelindex=null;return console.log("Logger setLevel defaulted to all levels")}this.levelindex=this.levels.indexOf(e)},setService:function(e,f){if(!e||typeof e!="string"){return console.log("Logger setService bad arg")}this.service=e;if(f&&typeof f=="string"){this.serviceColor=f}},setOptions:function(e){if(!e||typeof e!="string"){return console.log("Logger setOptions bad arg")}this.opts=e},addLevel:function(h,e,f,g){if(!h||typeof h!="string"){return console.log("Logger addLevel bad arg")}if(this[h]){return console.log("Logger addLevel "+h+" already exists")}if(!f){this.levels.push(h)}else{this.levels.splice(f,0,h)}this[h]=this.createLogMethod(h,this,e);if(g){this.setLevel(h)}},setColor:function(e){if(!e||typeof e!="string"){return console.log("Logger setColor bad arg")}this.serviceColor=e},setBackgroundColor:function(e){if(!e||typeof e!="string"){return console.log("Logger setColor bad arg")}this.backgroundColor=e}});var a=new b({service:"3DIM",color:"blue",backgroundColor:"lightgray"});a.addLevel("xmpp","green");a.addLevel("node","green");return a});define("DS/RTProxyDriver/RTProxyDriver",["UWA/Class","UWA/Utils","UWA/Class/Events","DS/RTProxyDriver/RTLogger"],function(c,g,a,d){d.debug("RTProxyDriver load");var f={};var e={"3DIM":{token:undefined},"3DNOTIF":{token:undefined}};var b={};b.eventName={SETDRIVER:"SETDRIVER",GETSTATUSLIST:"GETSTATUSLIST",CONNECTED:"CONNECTED",BUDDYLISTBUILT:"BUDDYLISTBUILT",ONMESSAGERECEIVED:"ONMESSAGERECEIVED",ONDATARECEIVED:"ONDATARECEIVED",CLOSESESSION:"CLOSESESSION:",SENDMSG:"SENDMSG",SENDDATA:"SENDDATA",GETSTATUS:"GETSTATUS",STATUSUPDATED:"STATUSUPDATED",SETSTATUS:"SETSTATUS",CREATEGROUP:"CREATEGROUP",ADDCONTACT:"ADDCONTACT",REMOVEGROUP:"REMOVEGROUP",RENAMEGROUP:"RENAMEGROUP",RENAMEGROUPVIEW:"RENAMEGROUPVIEW",REMOVECONTACT:"REMOVECONTACT",ONPRESENCERECEIVED:"ONPRESENCERECEIVED",SEARCHCONTACT:"SEARCHCONTACT",RESULTOFSEARCH:"RESULTOFSEARCH",RESULTOFSEARCHFORSEARCHAPI:"RESULTOFSEARCHFORSEARCHAPI",SENDNOTIF:"SENDNOTIF",DISCONNECTED:"DISCONNECTED",LOGOUT:"LOGOUT",GETARCHIVES:"GETARCHIVES",ONARCHIVERECEIVED:"ONARCHIVERECEIVED",CLEANARCHIVES:"CLEANARCHIVES",GROUPREMOVED:"GROUPREMOVED",SIGNOUT:"SIGNOUT"};var h=new a();h.addEvent("SETDRIVER",function(i){var j=i.nameApp;if(e[j]&&!f[j]){require(["DS/RTDriver/RTDriver"],function(k){d.debug("RTDriver loaded by RTProxyDriver");var l=new k(i);if(l){f[j]=l;h.dispatchEvent("DRIVERSETTED",[])}})}});h.addEvent("LOGOUT",function(i){var j=i.nameApp;delete f[j]});b.dispatch=function(j,i){if(h){h.dispatchEvent(j,i)}};b.addEvent=function(j,i){if(h){h.addEvent(j,i)}};b.removeEvent=function(j,i){if(h){(j==="ALL")?h.removeEvents():h.removeEvent(j,i)}};return b});