define("DS/ENOXTriptych/js/ENOXTriptych",["DS/CoreEvents/ModelEvents","DS/Handlebars/Handlebars","text!DS/ENOXTriptych/html/ENOXTriptych.html","i18n!DS/ENOXTriptych/assets/nls/ENOXTriptych","css!DS/ENOXTriptych/css/ENOXTriptych.css","css!DS/UIKIT/UIKIT.css"],function(c,b,j,a,f,h){var i=40;var e=false||window.localStorage.DS_Triptych_DebugON;var g=b.compile(j);var d=function(){};d.prototype.init=function(l,n,k,m){this._options={};this._modelEvents=l.modelEvents?l.modelEvents:new c();this._options.withtransition=l.withtransition;this._isMobileMode=null;this._options.left={};this._options.left.minWidth=l.left&&l.left.minWidth?l.left.minWidth:i;this._options.left.resizable=l.left&&l.left.resizable!=undefined?l.left.resizable:false;this._options.left.originalSize=l.left&&l.left.originalSize?l.left.originalSize:300;this._options.left.originalSize=Math.max(this._options.left.minWidth,this._options.left.originalSize);this._options.left.originalState=l.left&&l.left.originalState?l.left.originalState:"close";this._options.left.overMobile=true;this._isLeftOpen=this._options.left.originalState==="open"?true:false;this._overlayedLeft=this._options.left.overMobile;this._options.borderLeft=l.borderLeft!==undefined?l.borderLeft:false;this._options.right={};this._options.right.minWidth=l.right&&l.right.minWidth?l.right.minWidth:250;this._options.right.resizable=l.right&&l.right.resizable!=undefined?l.right.resizable:true;this._options.right.originalSize=l.right&&l.right.originalSize?l.right.originalSize:300;this._options.right.originalSize=Math.max(this._options.right.minWidth,this._options.right.originalSize);this._options.right.originalState=l.right&&l.right.originalState?l.right.originalState:"close";this._options.right.overMobile=true;this._isRightOpen=this._options.right.originalState==="open"?true:false;this._overlayedRight=this._options.right.overMobile;this._options.withCloseInRightPanel=l.right&&l.right.withClose!=undefined?l.right.withClose:true;this._options.withCloseInLeftPanel=l.left&&l.left.withClose!=undefined?l.left.withClose:false;this._options.borderRight=l.borderRight!==undefined?l.borderRight:true;this._checkCallbacksLeft={};this._checkCallbacksRight={};this._initDivs(l,n,k,m);this._initResizer();this._subscribeToEvents();this._subscribeToDomEvents();this.__mobileBreakpoint=550};d.prototype.getLeftOpen=function(){return this._isLeftOpen};d.prototype.getRightOpen=function(){return this._isRightOpen};d.prototype._subscribeToEvents=function(){this._listSubscription=[];var k=this;this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-get-panel-visibility"},function(l){if(l==="left"){k._modelEvents.publish({event:"triptych-panel-left-visilibity",data:k._isLeftOpen})}if(l==="right"){k._modelEvents.publish({event:"triptych-panel-right-visilibity",data:k._isRightOpen})}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-fetch-panel-visibility-status"},function(l){if(typeof(l)=="object"){if(l.side){if(l.side==="left"){l.cbFunc(k._isLeftOpen)}else{if(l.side==="right"){l.cbFunc(k._isRightOpen)}else{if(l.side=="both"||l.side==""){l.cbFunc({left:k._isLeftOpen,right:k._isRightOpen})}}}}else{l.cbFunc({left:k._isLeftOpen,right:k._isRightOpen})}}else{if(typeof(l)=="function"){l({left:k._isLeftOpen,right:k._isRightOpen})}}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-toggle-panel"},function(l){k._togglePanel(l)}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-show-panel"},function(l){k._showPanel(l)}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-hide-panel"},function(l){k._hidePanel(l)}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-set-size"},function(l){if(l.side==="left"){k._currentLeft=l.size;k._options.left.originalSize=l.size;k._refreshContainerLeftSize()}else{k._currentRight=l.size;k._options.right.originalSize=l.size;k._refreshContainerRightSize()}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-set-content"},function(m){var l=null;switch(m.side){case"right":if(k._rightPanelContent.firstChild){k._rightPanelContent.removeChild(k._rightPanelContent.firstChild)}if(m&&m.content){k._rightPanelContent.appendChild(m.content)}break;case"middle":if(k._mainPanel.firstChild){k._mainPanel.removeChild(k._mainPanel.firstChild)}if(m&&m.content){k._mainPanel.appendChild(m.content)}break;case"left":if(k._leftPanelContent.firstChild){k._leftPanelContent.removeChild(k._leftPanelContent.firstChild)}if(m&&m.content){k._leftPanelContent.appendChild(m.content)}break;default:break}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-add-check-before-close"},function(l){if(l.side==="left"){k._checkCallbacksLeft[l.id]=l.callback}else{if(l.side==="right"){k._checkCallbacksRight[l.id]=l.callback}}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-remove-check-before-close"},function(l){if(l.side==="left"&&k._checkCallbacksLeft[l.id]){delete k._checkCallbacksLeft[l.id]}else{if(l.side==="right"&&k._checkCallbacksRight[l.id]){delete k._checkCallbacksRight[l.id]}}}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-make-modal"},function(l){k._makeModal(l)}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-unmake-modal"},function(l){k._unmakeModal(l)}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-activate-transition"},function(){k._activateTransition();k._options.withtransition=true}));this._listSubscription.push(this._modelEvents.subscribe({event:"triptych-deactivate-transition"},function(){k._deactivateTransition();k._options.withtransition=false}))};d.prototype._subscribeToDomEvents=function(){var n=this;function k(p,r,o){var q;return function(){var v=this,u=arguments;var t=function(){q=null;if(!o){p.apply(v,u)}};var s=o&&!q;clearTimeout(q);q=setTimeout(t,r);if(s){p.apply(v,u)}}}var m=function(){n._modelEvents.publish({event:"resizing-triptych-container",data:n._container.offsetWidth});if(n._container.offsetWidth===0){return}if(n._container.offsetWidth<=n.__mobileBreakpoint){if(n._isMobileMode){}else{n._modelEvents.publish({event:"triptych-entering-mobile"});if(n._isRightOpen){n._right_closed_from_triptych=true}}n._isMobileMode=true}if(n._container.offsetWidth>n.__mobileBreakpoint){if(n._isMobileMode){n._modelEvents.publish({event:"triptych-leaving-mobile"});if(n._right_closed_from_triptych){n._showPanel("right")}}n._isMobileMode=false;n._right_closed_from_triptych=false}n._refreshContainerLeftSize();n._refreshContainerRightSize()};var l=k(function(){m()},150);window.addEventListener("resize",l)};d.prototype.destroy=function(){this._container=null;var m=0;var l=this._listSubscription.length;for(m=0;m<l;m++){this._modelEvents.unsubscribe(this._listSubscription[m])}var n=Object.keys(this);var k=n.indexOf("_modelEvents");if(k>-1){n.splice(k,1)}for(m=0;m<n.length;m++){this[n[m]]=undefined}};d.prototype.inject=function(k){k.appendChild(this._container)};d.prototype.getLeftPanelContainer=function(){return this._leftPanel};d.prototype.getRightPanelContainer=function(){return this._rightPanel};d.prototype.getLeftPanelContent=function(){return this._leftPanelContent};d.prototype.getRightPanelContent=function(){return this._rightPanelContent};d.prototype.getMainPanelContainer=function(){return this._mainPanel};d.prototype._getLeftWidth=function(){return this._currentLeft};d.prototype._checkBeforeClosingLeft=function(){var m=Object.keys(this._checkCallbacksLeft);var k=m.length;var l=0;for(l=0;l<k;l++){if(!this._checkCallbacksLeft[m[l]]()){return false}}return true};d.prototype._checkBeforeClosingRight=function(){var m=Object.keys(this._checkCallbacksRight);var k=m.length;var l=0;for(l=0;l<k;l++){if(!this._checkCallbacksRight[m[l]]()){return false}}return true};d.prototype._togglePanel=function(k){if(k==="left"){if(this._isLeftOpen){this._hidePanel("left")}else{this._showPanel("left")}}else{if(this._isRightOpen){this._hidePanel("right")}else{this._showPanel("right")}}};d.prototype._showPanel=function(k){var l=this;if(k==="left"){this._isLeftOpen=true;this._leftPanel.classList.add("open");this._leftPanel.classList.remove("close");this._mainPanel.classList.add("left-open");this._refreshContainerLeftSize();this._refreshContainerRightSize();if(this._options.withCloseInLeftPanel){this._leftPanel.querySelector(".triptych-close-left").classList.remove("displaynone")}}else{if(this._options.withCloseInRightPanel){this._rightPanel.querySelector(".triptych-close-right").classList.remove("displaynone")}this._isRightOpen=true;this._rightPanel.classList.add("open");this._rightPanel.classList.remove("close");this._mainPanel.classList.add("right-open");this._refreshContainerRightSize();this._refreshContainerLeftSize()}l._modelEvents.publish({event:"triptych-panel-show-started",data:k});if(!this._options.withtransition){l._modelEvents.publish({event:"triptych-panel-visible",data:k});if(k==="left"){l._modelEvents.publish({event:"triptych-panel-visible-size",data:{side:"left",width:l._leftPanel.offsetWidth}})}else{if(k==="right"){l._modelEvents.publish({event:"triptych-panel-visible-size",data:{side:"right",width:l._rightPanel.offsetWidth}})}}}else{setTimeout(function(){l._modelEvents.publish({event:"triptych-panel-visible",data:k});if(k==="left"){l._modelEvents.publish({event:"triptych-panel-visible-size",data:{side:"left",width:l._leftPanel.offsetWidth}})}else{if(k==="right"){l._modelEvents.publish({event:"triptych-panel-visible-size",data:{side:"right",width:l._rightPanel.offsetWidth}})}}},400)}};d.prototype._hidePanel=function(k,m){var l=this;if(m){}else{this._right_closed_from_triptych=false}if(k==="left"){if(!l._checkBeforeClosingLeft()){console.log("preventing from closing left");return false}this._isLeftOpen=false;this._leftPanel.classList.remove("open");this._leftPanel.classList.add("close");this._mainPanel.classList.remove("left-open");this._refreshContainerLeftSize();if(this._options.withCloseInLeftPanel){this._leftPanel.querySelector(".triptych-close-left").classList.add("displaynone")}}else{if(!l._checkBeforeClosingRight()){console.log("preventing from closing right");return false}this._isRightOpen=false;if(this._options.withCloseInRightPanel){this._rightPanel.querySelector(".triptych-close-right").classList.add("displaynone")}this._rightPanel.classList.remove("open");this._rightPanel.classList.add("close");this._mainPanel.classList.remove("right-open");this._refreshContainerRightSize()}l._modelEvents.publish({event:"triptych-panel-hide-started",data:k});if(!this._options.withtransition){l._modelEvents.publish({event:"triptych-panel-hidden",data:k});l._unmakeModal()}else{setTimeout(function(){l._modelEvents.publish({event:"triptych-panel-hidden",data:k});l._unmakeModal()},400)}};d.prototype._initDivs=function(l,p,k,m){this._options._close=a._close;var o=g(this._options);this._container=l.container?l.container:document.createElement("div");this._container.innerHTML=o;if(!l.container){this._container=this._container.querySelector(".triptych-container")}this._mainPanel=this._container.querySelector(".triptych-main");this._currentLeft=this._options.left.originalSize;this._currentRight=this._options.right.originalSize;this._leftPanel=this._container.querySelector(".triptych-left");this._leftPanelContent=this._container.querySelector(".triptych-left-content");this._rightPanel=this._container.querySelector(".triptych-right");this._rightPanelContent=this._container.querySelector(".triptych-right-content");this._leftResizer=this._container.querySelector(".triptych-resizer.left");this._rightResizer=this._container.querySelector(".triptych-resizer.right");this._overlayLeft=this._container.querySelector(".overlay-left");this._overlayRight=this._container.querySelector(".overlay-right");var n=this;this._overlayLeft.addEventListener("click",function(){if(e){console.log("overlay left clicked")}n._hidePanel("left");n._unmakeModal();n._modelEvents.publish({event:"triptych-clicked-overlay",data:"left"})});this._overlayRight.addEventListener("click",function(){if(e){console.log("overlay right clicked")}n._hidePanel("right");n._unmakeModal();n._modelEvents.publish({event:"triptych-clicked-overlay",data:"right"})});this._refreshContainerLeftSize();if(p){this._leftPanelContent.appendChild(p)}if(m){this._rightPanelContent.appendChild(m)}this._refreshContainerRightSize();if(k){this._mainPanel.appendChild(k)}this._leftPanel.classList.add("close");if(this._isLeftOpen){this._leftPanel.classList.add("open");this._leftPanel.classList.remove("close");this._mainPanel.classList.add("left-open");if(this._options.withCloseInLeftPanel){this._leftPanel.querySelector(".triptych-close-left").classList.remove("displaynone")}}this._rightPanel.classList.add("close");if(this._isRightOpen){this._rightPanel.classList.add("open");this._rightPanel.classList.remove("close");this._mainPanel.classList.add("right-open");if(this._options.withCloseInRightPanel){this._rightPanel.querySelector(".triptych-close-right").classList.remove("displaynone")}}};d.prototype._activateTransition=function(){this._leftPanel.classList.add("withtransition");this._rightPanel.classList.add("withtransition");this._mainPanel.classList.add("withtransition")};d.prototype._deactivateTransition=function(){this._leftPanel.classList.remove("withtransition");this._rightPanel.classList.remove("withtransition");this._mainPanel.classList.remove("withtransition")};d.prototype._initResizer=function(){var t=this;var x=t._rightPanel.querySelector(".triptych-close-right");if(x){x.addEventListener("click",function(){t._modelEvents.publish({event:"triptych-hide-panel",data:"right"})})}var y=t._leftPanel.querySelector(".triptych-close-left");if(y){y.addEventListener("click",function(){t._modelEvents.publish({event:"triptych-hide-panel",data:"left"})})}var p=function(){if(t._options.withtransition){t._deactivateTransition()}};var m=function(){if(t._options.withtransition){t._activateTransition()}};var A=function(E){if(E.stopPropagation){E.stopPropagation()}if(E.preventDefault){E.preventDefault()}E.cancelBubble=true;E.returnValue=false;return false};var q=null;var u=null;var r=null;var o=null;if(this._options.left.resizable){var z=false;var w=function(E){p();q=t._currentLeft;r=E.clientX?E.clientX:(E.touches&&E.touches[0])?E.touches[0].clientX:0;z=true;A(E);if(E.type==="touchstart"){document.addEventListener("touchmove",k);document.addEventListener("touchend",B)}else{if(E.type==="mousedown"){document.addEventListener("mousemove",k);document.addEventListener("mouseup",B)}}};var k=function(F){var E=F.clientX?F.clientX:(F.touches&&F.touches[0])?F.touches[0].clientX:0;if(z){t._currentLeft=q+(E-r);t._refreshContainerLeftSize()}};var B=function(E){m();if(e){console.log("stop resizeleft")}z=false;q=t._currentLeft;if(E.type==="touchend"){document.removeEventListener("touchmove",k);document.removeEventListener("touchend",B)}else{if(E.type==="mouseup"){document.removeEventListener("mousemove",k);document.removeEventListener("mouseup",B)}}};var n=this._container.querySelector(".triptych-resizer.left");t._leftResizer.addEventListener("mousedown",w);t._leftResizer.addEventListener("touchstart",w)}if(this._options.right.resizable){var s=false;var l=function(E){p();u=t._currentRight;r=E.clientX?E.clientX:(E.touches&&E.touches[0])?E.touches[0].clientX:0;s=true;A(E);if(E.type==="touchstart"){document.addEventListener("touchmove",D);document.addEventListener("touchend",v)}else{if(E.type==="mousedown"){document.addEventListener("mousemove",D);document.addEventListener("mouseup",v)}}};var D=function(F){if(e){console.log("resize right)")}var E=F.clientX?F.clientX:(F.touches&&F.touches[0])?F.touches[0].clientX:0;if(s){t._currentRight=u+(r-E);t._refreshContainerRightSize()}};var v=function(E){m();s=false;if(e){console.log("stop resizeright")}u=t._currentRight;if(E.type==="touchend"){document.removeEventListener("touchmove",D);document.removeEventListener("touchend",v)}else{if(E.type==="mouseup"){document.removeEventListener("mousemove",D);document.removeEventListener("mouseup",v)}}};var C=this._container.querySelector(".triptych-resizer.right");t._rightResizer.addEventListener("mousedown",l);t._rightResizer.addEventListener("touchstart",l)}};d.prototype._refreshContainerLeftSize=function(){var l=this;var n=this._container.offsetWidth;if(!this._isMobileMode){this._isMobileMode=(this._container.offsetWidth<=this.__mobileBreakpoint)?true:false}var k=this._overlayedLeft;var m=k&&n<this.__mobileBreakpoint;if(l._isRightOpen){l._currentLeft=Math.min(n-l._currentRight-150,l._currentLeft)}if(!this._isMobileMode){this._currentLeft=Math.min(this._currentLeft,(n-100))}this._currentLeft=Math.max(l._options.left.minWidth,l._currentLeft);if(m){if(this._leftResizer){this._leftResizer.classList.add("displaynone")}if(this._isLeftOpen){this._overlayLeft.classList.remove("displaynone");if(this._isRightOpen){this._hidePanel("right",true)}this._leftPanel.style.width="80%";this._mainPanel.style.left=0}else{this._overlayLeft.classList.add("displaynone");this._leftPanel.style.width=0;this._mainPanel.style.left=0;if(this._leftResizer){this._leftResizer.classList.add("displaynone")}}}else{this._overlayLeft.classList.add("displaynone");if(this._isLeftOpen){this._leftPanel.style.width=this._currentLeft+"px";this._mainPanel.style.left=this._currentLeft+"px";l._modelEvents.publish({event:"triptych-resized",data:{side:"left",width:l._currentLeft}});if(this._leftResizer){this._leftResizer.style.left=this._currentLeft-5+"px";this._leftResizer.classList.remove("displaynone")}}else{this._leftPanel.style.width=0;this._mainPanel.style.left=0;if(this._leftResizer){this._leftResizer.classList.add("displaynone")}}}};d.prototype._refreshContainerRightSize=function(){var l=this;var n=this._container.offsetWidth;var k=this._overlayedRight;var m=k&&n<this.__mobileBreakpoint;if(this._currentRight<0){this._currentRight=this._options.right.originalSize}l._currentRight=Math.max(this._options.right.minWidth,this._currentRight);if(!this._isMobileMode){this._currentRight=Math.min(this._currentRight,(this._container.offsetWidth-100))}if(l._isLeftOpen){l._currentRight=Math.min(n-l._currentLeft-150,l._currentRight)}if(m){if(this._rightResizer){this._rightResizer.classList.add("displaynone")}if(this._isRightOpen){this._overlayRight.classList.remove("displaynone");if(this._isLeftOpen){this._hidePanel("left")}this._rightPanel.style.width="80%";this._rightPanel.style.right=0;this._mainPanel.style.left=0}else{this._overlayRight.classList.add("displaynone");this._rightPanel.style.width=0;this._mainPanel.style.right=0;if(this._rightResizer){this._rightResizer.classList.add("displaynone")}}}else{this._overlayRight.classList.add("displaynone");if(this._isRightOpen){this._rightPanel.style.width=this._currentRight+"px";this._mainPanel.style.right=this._currentRight+"px";l._modelEvents.publish({event:"triptych-resized",data:{side:"right",width:l._currentRight}});if(this._rightResizer){this._rightResizer.style.right=this._currentRight-5+"px";this._rightResizer.classList.remove("displaynone")}}else{this._rightPanel.style.width=0;this._mainPanel.style.right=0;if(this._rightResizer){this._rightResizer.classList.add("displaynone")}}}};d.prototype._makeModal=function(k){switch(k){case"left":this._leftPanel.classList.add("triptych-modal");this._leftPanel.classList.add("triptych-modal-main");this._rightPanel.classList.add("triptych-modal");this._mainPanel.classList.add("triptych-modal");this._rightPanel.classList.add("triptych-modal-overlayed");this._mainPanel.classList.add("triptych-modal-overlayed");this._modelEvents.publish({event:"triptych-made-modal",data:k});break;case"right":this._leftPanel.classList.add("triptych-modal");this._rightPanel.classList.add("triptych-modal-main");this._rightPanel.classList.add("triptych-modal");this._mainPanel.classList.add("triptych-modal");this._leftPanel.classList.add("triptych-modal-overlayed");this._mainPanel.classList.add("triptych-modal-overlayed");this._modelEvents.publish({event:"triptych-made-modal",data:k});break;default:if(e){console.error("Triptych.prototype._makeModal called with strange data..")}break}return 0};d.prototype._unmakeModal=function(k){this._leftPanel.classList.remove("triptych-modal");this._leftPanel.classList.remove("triptych-modal-main");this._rightPanel.classList.remove("triptych-modal-main");this._rightPanel.classList.remove("triptych-modal");this._mainPanel.classList.remove("triptych-modal");this._rightPanel.classList.remove("triptych-modal-overlayed");this._leftPanel.classList.remove("triptych-modal-overlayed");this._mainPanel.classList.remove("triptych-modal-overlayed");this._modelEvents.publish({event:"triptych-made-unmodal"})};return d});