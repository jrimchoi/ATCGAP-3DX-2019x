define("DS/DataGridView/ModelMassUpdateDialog",["UWA/Core","UWA/Element","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","i18n!DS/DataGridView/assets/nls/translation"],function(h,b,f,a,g,e,c){var d=f.inherit({name:"ModelMassUpdateDialog",publishedProperties:{treeDocument:{defaultValue:null,type:"object"},attributes:{defaultValue:[],type:"array"}},destroy:function(){if(this._dataGridView){this._dataGridView.destroy();this._dataGridView=null}this._parent()},_postBuildView:function(){this._parent();var j=h.createElement("div",{"class":"wux-model-mass-update-maindiv"});var i=h.createElement("div",{html:c.ModelMassUpdate.Description,"class":"wux-model-mass-update-description"}).inject(j);var k=[{text:"Name",dataIndex:"tree",typeRepresentation:"string",alignment:"far",width:"250",minWidth:"50",alwaysVisibleFlag:true,editableFlag:false},{text:"Value",dataIndex:"value",getCellTypeRepresentation:function(n){return n.nodeModel?n.nodeModel.getAttributeValue("typeRepresentation"):"string"},resizableFlag:false,width:"auto",minWidth:"100",alwaysVisibleFlag:true,editableFlag:true,editionPolicy:"EditionInPlace"}];var m=require("DS/DataGridView/DataGridView");this._dataGridView=new m({identifier:this.identifier+"_DataGridView",height:"auto",treeDocument:null,columns:k,cellSelection:"none",selectionBehavior:{selectNodeModelOnCellSelection:false},focusNextEditableCellOnTabFlag:true,showCellActivationFlag:false,showCellPreselectionFlag:false,columnDragEnabledFlag:false,showAlternateBackgroundFlag:false,showRowIndexFlag:false,showSelectionCheckBoxesFlag:true,showRowHeaderBackgroundFlag:false,defaultColumnDef:{minWidth:30,sortableFlag:false}});this._dataGridView.layout.columnsHeader=false;this._dataGridView.layout.rowSpacing=6;this._applyAttributes();this._dataGridView.inject(j);this.content=j;this.title=c.ModelMassUpdate.Title;var l=this;this.buttons={Ok:new e({label:c.ModelMassUpdate.ApplyToSelected,onClick:function(n){l.visibleFlag=false}}),Apply:new e({label:c.ModelMassUpdate.ApplyToAll,onClick:function(n){l.visibleFlag=false}}),Cancel:new e({onClick:function(n){l.visibleFlag=false}})};this.addEventListener("close",function(n){l.visibleFlag=false})},_applyProperties:function(i){this._parent(i);if(this.isDirty("treeDocument")){this._applyTreeDocument(i.treeDocument)}if(this.isDirty("attributes")){this._applyAttributes(i.attributes)}},_applyTreeDocument:function(i){},_applyAttributes:function(m){if(!this._dataGridView){return}var l=new a();var j=this.attributes;if(j){for(var n=0;n<j.length;n++){var q=j[n];var k=q.label?q.label:q.name;l.addRoot(new g({label:k,grid:{name:q.name,typeRepresentation:q.typeRepresentation,value:undefined}}))}}this._dataGridView.treeDocument=l;var p=this;var o=this._dataGridView.addEventListener("allCellsRendered",function(){p._dataGridView.removeEventListener("allCellsRendered",o);p._dataGridView.sizeColumnToFit("tree",{isUserInteraction:false,computeAllRows:true})})},});return d});define("DS/DataGridView/DataGridViewCell",["DS/CollectionView/CollectionViewCell"],function(a){var b=a.inherit({name:"DataGridViewCell",publishedProperties:{showKPIColorFlag:{defaultValue:false,type:"boolean"},KPIColor:{defaultValue:undefined,type:"string"}},_applyShowKPIColorFlag:function(c){this._updateKPIColor()},_applyKPIColor:function(c){this._updateKPIColor()},_updateKPIColor:function(){if(this.showKPIColorFlag){if(!this.elements.KPIColorDiv){this.elements.KPIColorDiv=new UWA.Element("div",{"class":"wux-layouts-datagridview-kpi-color"})}else{this.elements.KPIColorDiv.show()}if(this.KPIColor!==undefined){this.elements.KPIColorDiv.style.background=this.KPIColor;this.elements.KPIColorDiv.style.visibility=""}else{this.elements.KPIColorDiv.style.visibility="hidden"}if(!this.elements.KPIColorDiv.parentNode){this.elements.KPIColorDiv.inject(this.elements.container,"top")}}else{if(this.elements.KPIColorDiv){this.elements.KPIColorDiv.hide()}}},_applyProperties:function(c){this._parent(c);if(this.isDirty("showKPIColorFlag")){this._applyShowKPIColorFlag(c.showKPIColorFlag)}if(this.isDirty("KPIColor")){this._applyKPIColor(this.KPIColor)}},blackBoxFlag:true,_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-cell")}});return b});define("DS/DataGridView/DataGridViewLayout",["DS/CollectionView/layouts/CollectionViewGridLayout","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/TreeUtils"],function(j,h,b,d){var a=24;var g=38;var e=a+1;var c=g+1;var i="wux-collectionView-dataGridView";var f=j.inherit({name:"CollectionViewDataGridLayout",publishedProperties:{columns:{defaultValue:[],type:"array"},cellWidth:{defaultValue:100,type:"integer"},cellHeight:{defaultValue:a,type:"integer"},getRowHeightFunction:{defaultValue:null,type:"function"},columnsHeader:{defaultValue:true,type:"boolean"},columnHeaderHeight:{defaultValue:e,type:"integer"},rowsHeader:{defaultValue:true,type:"boolean"},rowSpacing:{defaultValue:0,type:"integer"}},init:function(k){this._parent(k);this._balancedColumnTree=[];this._columnItemsByDepth=[];this._leafColumns=[];this._leafColumnsCount=0;this._computedColumns=[];this._computedRows=[];this._columnTreeItemCount=0;this._useVariableRowHeight=false;this._hasAutoWidthColumnWithAutoRowHeightFlag=false;this._autoRowHeightColumnIndexes=[];this._manageTouchChange()},_manageTouchChange:function(){var k=this;document.addEventListener("touchChange",function(){k.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})})},prepareLayout:function(){var l=this.rowsHeader;var k=this.getLeafColumns();this._leafColumnsCount=k.length+(l?1:0);this._computeColumnsWidth();this._leftPinnedRowcolumnID=l?-4:-3;this._unpinnedRowcolumnID=l?-3:-2;this._rightPinnedRowcolumnID=l?-2:-1},_applyColumns:function(m,p){this._balancedColumnTree=d.createBalancedTree(this.columns);this._columnItemsByDepth=d.computeItemsByDepth(this._balancedColumnTree);var l=this.collectionView.defaultColumnDef?this.collectionView.defaultColumnDef.autoRowHeightFlag:false;this._leafColumns=[];this._hasAutoWidthColumnWithAutoRowHeightFlag=false;this._autoRowHeightColumnIndexes=[];if(this._columnItemsByDepth&&(this._columnItemsByDepth.length>0)){var k=this._columnItemsByDepth[this._columnItemsByDepth.length-1];for(var n=0;n<k.length;n++){var o=k[n];if(o.dataIndex!==undefined){if(typeof o.pinned!=="undefined"&&o.pinned!=="left"&&o.pinned!=="right"&&o.pinned!=="unpinned"){o.pinned="unpinned"}this._leafColumns.push(o);if(l||o.autoRowHeightFlag){this._autoRowHeightColumnIndexes.push(n);if(this.getColumnWidth(n)==="auto"){this._hasAutoWidthColumnWithAutoRowHeightFlag=true}}}else{console.warn("The leaf column at index "+n+" does not have a defined dataIndex")}}}if(this._autoRowHeightColumnIndexes.length>0){if(!this.getRowHeightFunction){this.getRowHeightFunction=this.getRowHeightFromCellContents}else{this.resetRowHeights()}}else{if(this.getRowHeightFunction===this.getRowHeightFromCellContents){this.getRowHeightFunction=null}}this._originalLeafColumns=d.cloneTree(this._leafColumns);this._computeOriginalOrderedColumnsIndexes();this._updateColumnTreeFromOrderedIndexes();this._computeColumnsWidth();if((m&&(m.length>0))||p){this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})}},applyColumns:function(){this.collectionView.prepareUpdateView();this._applyColumns();this._applyPreferencesOnColumns();this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});this.collectionView.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true)},_computeColumnItems:function(){this._mergeColumnGroups(this._balancedColumnTree,this.collectionView._draggedColumnOrGroup);this._columnItemsByDepth=d.computeItemsByDepth(this._balancedColumnTree);this._columnTreeItemCount=d.countItem(this._balancedColumnTree);this._computeColumnsReverseIndexes();this._computeOrderedColumnsIndexes()},_mergeColumnGroups:function(k,p){if(k.length>1){for(var m=k.length-1;m>0;m--){var r=k[m];var q=k[m-1];if(r&&r.children&&q&&q.children&&(r.dataIndex===q.dataIndex)&&(!p||((r!==p)&&(q!==p)))){var o=this.getColumnOrGroupPinned(r);var n=this.getColumnOrGroupPinned(q);if(o===n){q.children=q.children.concat(r.children);for(var l=0;l<r.children.length;l++){r.children[l]._parent=q}k.splice(m,1)}}}}for(var m=0;m<k.length;m++){var s=k[m];if(s&&s.children){this._mergeColumnGroups(s.children,p)}}},_updateColumnTreeFromOrderedIndexes:function(){var n=this.getLeafColumns();var m=[];for(var k=0;k<this._orderedColumnsIndexes.length;k++){var l=this._orderedColumnsIndexes[k];var o=n[l];var p=d.extractItemHierarchy(o,this._balancedColumnTree,false);m.push(p)}this._balancedColumnTree=m;this._computeColumnItems()},_applyRowsHeader:function(k,l){if(!this.rowsHeader){this.collectionView.elements.rowHeaderExtension.setAttribute("hideBorder","")}else{this.collectionView.elements.rowHeaderExtension.removeAttribute("hideBorder")}this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})},_applyCellHeight:function(k,l){if(l<a){this.cellHeight=k;return}this.resetRowHeights()},_applyGetRowHeightFunction:function(k,l){this._useVariableRowHeight=((this.getRowHeightFunction!==undefined)&&(this.getRowHeightFunction!==null));this.resetRowHeights()},_applyColumnsHeader:function(k,l){this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})},_applyColumnHeaderHeight:function(k,l){if(l<e){this.columnHeaderHeight=k;return}this.invalidate({updateCellContent:false,updateCellLayout:false,updateCellAttributes:false})},_applyRowSpacing:function(k,l){this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},getLeafColumns:function(){return this._leafColumns},_getColumnTreeDepth:function(){return this._columnItemsByDepth?this._columnItemsByDepth.length:0},_getOriginalLeafColumns:function(){return this._originalLeafColumns},getColumnOptionValue:function(n,m){var k;var l=this.getColumnIndex(n);if(l>-1){var p=this.getLeafColumns();var q=p[l];if(q){k=q[m]}if(k===undefined){var o=this.collectionView.defaultColumnDef;if(o){k=o[m]}}}return k},_getOriginalColumnOptionValue:function(m,l){var k;var m=this._getOriginalColumnIdentifiers(m).columnIndex;if(m>-1){var n=this._getOriginalLeafColumns();var o=n[m];if(o){k=o[l]}if((k===undefined)&&this.collectionView.defaultColumnDef){k=this.collectionView.defaultColumnDef[l]}}return k},_computeColumnsReverseIndexes:function(){this._columnsReverseIndexes={};var m=this.getLeafColumns();for(var l=0,o=m.length;l<o;l++){var k=m[l].dataIndex;if(k!==undefined){this._columnsReverseIndexes[k]=l}}this._columnsReverseIndexes.rowHeader=-1},_computeOriginalColumnsReverseIndexes:function(){this._columnsOriginalReverseIndexes={};var m=this._getOriginalLeafColumns();for(var l=0,o=m.length;l<o;l++){var k=m[l].dataIndex;if(k!==undefined){this._columnsOriginalReverseIndexes[k]=l}}this._columnsOriginalReverseIndexes.rowHeader=-1},_computeOriginalOrderedColumnsIndexes:function(){var m=this.getLeafColumns();var q=m.length;var p=[];var n=[];var o=[];for(var l=0;l<q;l++){var k=this.getColumnPinned(l);if(k==="left"){p.push(l)}else{if(k==="right"){o.push(l)}else{n.push(l)}}}this._orderedColumnsIndexes=p.concat(n).concat(o);this._originalOrderedColumnsIndexes=this._orderedColumnsIndexes.slice(0);this._computeOrderedColumnsReverseIndexes();this._originalOrderedColumnsReverseIndexes=this._orderedColumnsReverseIndexes.slice(0)},_computeOrderedColumnsIndexes:function(){this._orderedColumnsIndexes=[];var k=this._columnItemsByDepth[this._columnItemsByDepth.length-1];for(var l=0;l<k.length;l++){var m=k[l];this._orderedColumnsIndexes.push(this.getColumnIndex(m.dataIndex))}this._computeOrderedColumnsReverseIndexes()},getOrderedColumnsIndexes:function(){return this._orderedColumnsIndexes},_computeOrderedColumnsReverseIndexes:function(){this._orderedColumnsReverseIndexes=[];for(var k=0;k<this._orderedColumnsIndexes.length;k++){this._orderedColumnsReverseIndexes[this._orderedColumnsIndexes[k]]=k}},_computeColumnsWidth:function(){this._firstUnpinnedColumnIndex=undefined;this._lastUnpinnedColumnIndex=undefined;this._firstLeftPinnedColumnIndex=undefined;this._lastLeftPinnedColumnIndex=undefined;this._firstRightPinnedColumnIndex=undefined;this._lastRightPinnedColumnIndex=undefined;var k=this.collectionView.getViewportDimensions();var m=this.collectionView.getDimensions();var C=this._getEstimatedVirtualHeight(true)>k.height?UWA.Utils.Client.getScrollbarWidth():0;var q=m.width-C-(this.rowsHeader?this.getRowHeaderWidth():0);if(this.getRightContainerWidth()>0){q--}if(this.getLeftContainerWidth()>0){q--}var H=0;var r=this.getLeafColumns();this.collectionView.elements.rowHeaderExtension.style.width=this.rowsHeader?(this.getRowHeaderWidth()+1)+"px":"0px";for(var A=0,x=r.length;A<x;A++){var t=false;var D=this.getColumnVisibleState(A);var p=this.getColumnWidth(A);if(p===undefined){p="auto"}var G=this.getColumnMinWidth(A);if(!D){p=0}else{if(typeof p==="string"){if(p==="auto"){p=0;t=true;H++}else{if(p.indexOf("%")>-1){p=Math.floor(m.width*(parseInt(p,10)/100))}else{p=parseInt(p,10)}}}p=Math.max(0,p);if(G&&!t){p=Math.max(G,p)}}q=q-p;this._setColumnComputedWidth(A,p)}var z=this.cellWidth;var F=this.rowsHeader?this.getRowHeaderWidth():0;var o=0;var v=0;var B=0;for(var A=0;A<this._orderedColumnsIndexes.length;A++){var y=this._orderedColumnsIndexes[A];var G=this.getColumnMinWidth(y);var D=this.getColumnVisibleState(y);var p=this.getColumnWidth(y);var l=this.getColumnPinned(y);if(p==="auto"&&D){var E=Math.floor(q/(H-B));var w=Math.max(z,E);if(G){w=Math.max(G,w)}q=q-w;this._setColumnComputedWidth(y,w);B++}var s=0;var u=this.getColumnComputedWidth(y);if(l==="left"){s=F;F+=u;if(this._firstLeftPinnedColumnIndex===undefined&&D){this._firstLeftPinnedColumnIndex=y}if(D){this._lastLeftPinnedColumnIndex=y}}else{if(l==="right"){s=o;o+=u;if(this._firstRightPinnedColumnIndex===undefined&&D){this._firstRightPinnedColumnIndex=y}if(D){this._lastRightPinnedColumnIndex=y}}else{s=v;v+=u;if(this._firstUnpinnedColumnIndex===undefined&&D){this._firstUnpinnedColumnIndex=y}if(D){this._lastUnpinnedColumnIndex=y}}}this._setColumnPosition(y,s)}},_setColumnPosition:function(l,k){if(!this._computedColumns[l]){this._computedColumns[l]={}}this._computedColumns[l].position=k},getColumnPosition:function(k){return this._computedColumns[k]?this._computedColumns[k].position:0},getColumnOrGroupPosition:function(l){var k=0;if(l){if(l.children){k=this.getColumnOrGroupPosition(l.children[0])}else{k=this.getColumnPosition(this.getColumnIndex(l.dataIndex))}}return k},moveColumn:function(n,l,k){var m=this.getLeafColumns();var o=m[this.getColumnIndex(n)];this.moveColumnOrGroup(o,l,k)},moveColumnOrGroup:function(y,l,q){if(!y){return}if(typeof l==="string"){l=this.getColumnIndex(l)}var x=this.getLeafColumns();var G=x[l];if(!G){return}var z=d.getLeafItems(y);for(var D=0;D<z.length;D++){var p=z[D];if(p===G){return}}var E=this.getFirstLeafColumnIndex(y);var H=this.getLastLeafColumnIndex(y);var w=(this._orderedColumnsReverseIndexes[E]<this._orderedColumnsReverseIndexes[l])?"after":"before";var B=d.getCommonParent(y,G);if(!B){B=this._balancedColumnTree}var I=this._getPreviousVisibleColumnID(E);var r=this._getNextVisibleColumnID(H);var u=this._columnTreeItemCount;var o=d.extractItemHierarchy(y,B,true);if(o){d.splitParentAtItemIndex(G,B,w);var s=d.getIndexInRootParent(G,B);var F=(w==="after")?s+1:s;if(B&&(B!==this._balancedColumnTree)){d.addChild(B,o,F)}else{this._balancedColumnTree.splice(F,0,o)}}this._computeColumnItems();var C=this.getColumnPinned(l);var A=this._orderedColumnsReverseIndexes[E]<this._orderedColumnsReverseIndexes[I]?E:r;var k=this._orderedColumnsReverseIndexes[E]<this._orderedColumnsReverseIndexes[I]?I:E;for(var D=this._orderedColumnsReverseIndexes[A];D<=this._orderedColumnsReverseIndexes[k];D++){var n=this._orderedColumnsIndexes[D];if(this.getColumnVisibleState(n)){var m=this.getColumnPinned(n);if(m===C){this.collectionView._freeUpColumnCells(n,1)}}}if(q&&q.isUserInteraction){for(var D=0;D<z.length;D++){this._saveColumnOrderInPreferences(z[D].dataIndex)}}var t=false;if(this._columnTreeItemCount!==u){t=true}this.collectionView._updateColumnHeaderCells({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});var v=(this.collectionView._draggedColumnOrGroup)?true:false;this.collectionView.invalidateLayout({updateCellContent:t,updateCellLayout:true,updateCellAttributes:v})},getColumnAutoRowHeightFlag:function(k){return this.getColumnOptionValue(k,"autoRowHeightFlag")},setColumnAutoRowHeightFlag:function(l,n){var k=this.getColumnIndex(l);var m=this.getLeafColumns();if(m[k].autoRowHeightFlag!==n){m[k].autoRowHeightFlag=n;this.applyColumns()}},hasAutoWidthColumnWithAutoRowHeightFlag:function(){return this._hasAutoWidthColumnWithAutoRowHeightFlag},getColumnVisibleState:function(k){return this.getColumnAlwaysVisibleFlag(k)||this.getColumnVisibleFlag(k)},getColumnVisibleFlag:function(k){return this.getColumnOptionValue(k,"visibleFlag")},setColumnVisibleFlag:function(n,l,k){var m=this.getColumnIndex(n);if(m<0){return}var o=this.getLeafColumns();if(o[m].visibleFlag!==l){if(!l&&this.getColumnAlwaysVisibleFlag(n)){return}o[m].visibleFlag=l;if(this.getColumnAutoRowHeightFlag(m)){this.resetRowHeights()}if(l){this.collectionView._requestDelayedModelData()}if(!this.getColumnAutoRowHeightFlag(m)){this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:true})}}if(k&&k.isUserInteraction){this._saveColumnVisibleFlagInPreferences(m)}},getColumnAlwaysVisibleFlag:function(k){return this.getColumnOptionValue(k,"alwaysVisibleFlag")},getColumnOrGroupVisibleState:function(k){var m=false;if(k){if(k.children){for(var l=0;l<k.children.length;l++){var n=k.children[l];m=this.getColumnOrGroupVisibleState(n);if(m){break}}}else{m=this.getColumnVisibleState(k.dataIndex)}}return m},getColumnEditableFlag:function(k){return this.getColumnOptionValue(k,"editableFlag")},getColumnEditionPolicy:function(k){return this.getColumnOptionValue(k,"editionPolicy")},getColumnResizableFlag:function(k){return this.getColumnOptionValue(k,"resizableFlag")},getColumnSortableFlag:function(k){return this.getColumnOptionValue(k,"sortableFlag")},getColumnMassUpdateAllowedFlag:function(k){return this.getColumnOptionValue(k,"massUpdateAllowedFlag")},getColumnCompareFunction:function(k){return this.getColumnOptionValue(k,"compareFunction")},getColumnIcon:function(k){return this.getColumnOptionValue(k,"icon")},getColumnWidth:function(k){return this.getColumnOptionValue(k,"width")},setColumnWidth:function(p,o,m){if(isNaN(o)&&o!=="auto"){console.log("The width given for column "+p+" is not a Number");return}var n=this.getColumnIndex(p);var q=this.getLeafColumns();var l=this.getColumnMinWidth(n);if(l&&(typeof o==="number")){o=Math.max(o,l)}if(q[n].width!==o){q[n].width=o;if(typeof o==="number"){this._setColumnComputedWidth(n,o)}else{this._computeColumnsWidth()}var k=this.getColumnPinned(n);if((k==="left")||(k==="right")){this.collectionView._updateViewportDimensions()}if(m&&!m.isUserInteraction&&this.getColumnAutoRowHeightFlag(n)){this.resetRowHeights()}else{this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}if(m&&m.isUserInteraction){this._saveColumnWidthInPreferences(n)}},_setColumnComputedWidth:function(l,k){if(!this._computedColumns[l]){this._computedColumns[l]={}}this._computedColumns[l].width=k},getColumnComputedWidth:function(l){var k=this.getColumnIndex(l);if(k===-1){return(this.rowsHeader?this.getRowHeaderWidth():0)}else{var m=this._computedColumns[k]?this._computedColumns[k].width:0;return((m!==undefined)&&!isNaN(m))?m:0}},getColumnOrGroupComputedWidth:function(l){var k=0;if(l){if(l.children){for(var m=0;m<l.children.length;m++){var n=l.children[m];k+=this.getColumnOrGroupComputedWidth(n)}}else{k=this.getColumnComputedWidth(l.dataIndex)}}return k},getColumnMinWidth:function(k){return this.getColumnOptionValue(k,"minWidth")},getColumnPinned:function(k){return this.getColumnOptionValue(k,"pinned")},setColumnPinned:function(n,w,x){var o=this.getColumnIndex(n);if(o<0){return}var s=this.getDataIndexFromColumnIndex(o);if(w!=="right"&&w!=="left"){w="unpinned"}var p=this.getLeafColumns();if(p[o].pinned!==w){var m=o;var q=this._orderedColumnsReverseIndexes[o];if(w==="unpinned"){var r=this._getUnpinnedColumnsOrderInPreferences();if(r&&r[s]){m=this._orderedColumnsIndexes[r[s]]}else{var l=this._orderedColumnsIndexes[this._originalOrderedColumnsReverseIndexes[o]];var v=this.getColumnPinned(l);if(v==="unpinned"){m=l}else{var k=this._getFirstOrLastUnpinnedColumnIndex(v);if(v===p[o].pinned&&v==="left"){k=k-1}else{if(v===p[o].pinned&&v==="right"){k=k+1}}m=this._orderedColumnsIndexes[k]}}}else{var k=this._getFirstOrLastUnpinnedColumnIndex(w);m=this._orderedColumnsIndexes[k]}p[o].pinned=w;d.splitParentAtItemIndex(p[o],this._balancedColumnTree,"before");d.splitParentAtItemIndex(p[o],this._balancedColumnTree,"after");if(m!==o){this.moveColumn(o,m,x)}else{this._computeColumnItems();if(x&&x.isUserInteraction){this._saveColumnOrderInPreferences(o)}}var u=this.collectionView.getViewportDimensions();this.invalidate({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true});this.collectionView._updateViewportDimensions();var t=this.collectionView.getViewportDimensions();if(t.width>u.width){this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}if(x&&x.isUserInteraction){this._saveColumnPinnedStateInPreferences(o)}},getColumnOrGroupPinned:function(k){var l=0;if(k){if(k.children){l=this.getColumnOrGroupPinned(k.children[0])}else{l=this.getColumnPinned(this.getColumnIndex(k.dataIndex))}}return l},getColumnAutoSizePadding:function(k){return this.getColumnOptionValue(k,"autoSizePadding")},getColumnAllowUnsafeHTMLContent:function(k){return this.getColumnOptionValue(k,"allowUnsafeHTMLContent")},getColumnShouldCellAllowUnsafeHTMLContentAt:function(k){return this.getColumnOptionValue(k,"shouldCellAllowUnsafeHTMLContentAt")},getColumnTypeRepresentation:function(k){return this.getColumnOptionValue(k,"typeRepresentation")},getColumnGetCellTypeRepresentation:function(k){return this.getColumnOptionValue(k,"getCellTypeRepresentation")},_getCellTypeRepresentation:function(l){if(!l){return undefined}var k=this.getColumnGetCellTypeRepresentation(l.columnID);if(k){return k.call(this.collectionView,l)}return undefined},setColumnTypeRepresentation:function(l,n){var k=this.getColumnIndex(l);var m=this.getLeafColumns();if(m[k].typeRepresentation!==n){m[k].typeRepresentation=n;if(this.getColumnAutoRowHeightFlag(l)){this.collectionView._resetRowHeightsOnAllCellsRendered()}this.collectionView._updateRenderedColumn(k,{updateCellContent:true,updateCellLayout:true,updateCellAttributes:true})}},getColumnOnCellRequest:function(k){return this.getColumnOptionValue(k,"onCellRequest")},getColumnGetCellEditableState:function(k){return this.getColumnOptionValue(k,"getCellEditableState")},getColumnGetCellValue:function(k){return this.getColumnOptionValue(k,"getCellValue")},getColumnSetCellValue:function(k){return this.getColumnOptionValue(k,"setCellValue")},getColumnGetCellSemantics:function(k){return this.getColumnOptionValue(k,"getCellSemantics")},getColumnGetCellKPIColor:function(k){return this.getColumnOptionValue(k,"getCellKPIColor")},_getFirstVisibleColumnID:function(){var k=0;while(k<this._orderedColumnsIndexes.length){if(this.getColumnVisibleState(this._orderedColumnsIndexes[k])){return this._orderedColumnsIndexes[k]}else{k=k+1}}return -1},_getLastVisibleColumnID:function(){var k=this._orderedColumnsIndexes.length-1;while(k>=0){if(this.getColumnVisibleState(this._orderedColumnsIndexes[k])){return this._orderedColumnsIndexes[k]}else{k=k-1}}return -1},_getFirstOrLastUnpinnedColumnIndex:function(n){if(n==="right"){var l=this._orderedColumnsIndexes.length-1;for(var m=l;m>=0;m--){var o=this.getColumnPinned(this._orderedColumnsIndexes[m]);if(o==="right"){l--}else{if(o==="left"){return -1}else{return l}}}}else{if(n==="left"){var k=0;for(var m=0;m<this._orderedColumnsIndexes.length;m++){var o=this.getColumnPinned(this._orderedColumnsIndexes[m]);if(o==="left"){k++}else{if(o==="right"){return -1}else{return k}}}}}return -1},getVisibleOrderedColumnsIndexes:function(){var k=[];for(var l=0;l<this._orderedColumnsIndexes.length;l++){if(this.getColumnVisibleState(this._orderedColumnsIndexes[l])){k.push(this._orderedColumnsIndexes[l])}}return k},getDisplayedColumnsIndexes:function(){var w=-1;var y=-1;var v=this.collectionView.getViewportDimensions();var x=this.collectionView.getScrollerPosition();var n=x.x,q=x.x+v.width;var o=this.getVisibleOrderedColumnsIndexes();for(var p=0;p<o.length;p++){var t=o[p];var u=this.getColumnPinned(t);if((u!=="left")&&(u!=="right")){var l=this.getColumnPosition(t);if(l<=n){w=t}if(l<q){y=t}else{break}}}var s=[];var m=true;var r=w;while(r>=0&&m){s.push(r);if(r===y){m=false;break}r=this._getNextVisibleColumnID(r)}var k=this._getListOfVisiblePinnedColumnIDs("left").concat(s).concat(this._getListOfVisiblePinnedColumnIDs("right"));return k},_getNumberOfInvisibleColumnsBetween:function(p,o){var m=Math.min(p,o);var n=Math.max(p,o);var k=0;for(var l=m+1;l<n;l++){if(!this.getColumnVisibleState(this._orderedColumnsIndexes[l])){k++}}return k},_getPreviousVisibleColumnID:function(l){if(l===-1){return -1}var k=this._orderedColumnsReverseIndexes[l];if(k===undefined||(k===0)){return -1}else{var m=k-1;while(m>=0){if(this.getColumnVisibleState(this._orderedColumnsIndexes[m])){return this._orderedColumnsIndexes[m]}else{m=m-1}}return -1}},_getNextVisibleColumnID:function(n){var m=this.getColumnIndex(n);if(m===-1){return -1}var l=this._orderedColumnsReverseIndexes[m];if(l===undefined||(l===this._orderedColumnsIndexes.length-1)){return -1}else{var k=l+1;while(k<this._orderedColumnsIndexes.length){if(this.getColumnVisibleState(this._orderedColumnsIndexes[k])){return this._orderedColumnsIndexes[k]}else{k=k+1}}return -1}},_getListOfVisiblePinnedColumnIDs:function(l){var n=[];var k=(l==="left")?this._getFirstVisibleColumnID():this._getLastVisibleColumnID();var m=(l==="left")?this._getNextVisibleColumnID:this._getPreviousVisibleColumnID;while(k>=0){if(this.getColumnPinned(k)===l){n.push(k)}else{return n}k=m.call(this,k)}return n},_getLeafColumnsCount:function(){return this._leafColumnsCount},_getColumnTreeItemCount:function(){return this._columnTreeItemCount},_getColumnHeaderCellCount:function(){return this._getColumnTreeItemCount()+(this.rowsHeader?1:0)+3},getRowHeaderWidth:function(){var k=16;if(this.collectionView._getCurrentTouchMode()){var k=50}else{if(this.collectionView.showRowIndexFlag){k=40}else{if(this.collectionView.showSelectionCheckBoxesFlag){k=30}}}if(this.collectionView.showNodeKPIColorFlag){k+=6}if(this.collectionView.rowDragEnabledFlag){k+=6}if(this.collectionView._getCurrentTouchMode()){k+=26}else{if(this.collectionView.showRowIndexFlag&&this.collectionView.showSelectionCheckBoxesFlag&&(this.collectionView.showSelectionCheckBoxesFlag!=="OnOver")){k+=18}}return k},_getXSORectangularShape:function(){var s=this.collectionView.getCellsXSO();if(s.isEmpty()){return undefined}var u=s.get();var t,l,m,v,p,r;for(var k=0;k<u.length;k++){var o=u[k];if(o){var w={rowID:o.rowID,columnID:this.getColumnIndex(o.columnDataIndex)};if(t===undefined){v=this._orderedColumnsReverseIndexes[w.columnID];l=this._orderedColumnsReverseIndexes[w.columnID];p=w.columnID;r=w.columnID;m=w.rowID;t=w.rowID}else{var q=this._orderedColumnsReverseIndexes[w.columnID];if(q>v){v=q;p=w.columnID}if(q<l){l=q;r=w.columnID}if(w.rowID>m){m=w.rowID}if(w.rowID<t){t=w.rowID}}}}var n=(v+1-l-this._getNumberOfInvisibleColumnsBetween(r,p))*(m+1-t);if(n===u.length){return{minColumnID:r,width:v-l+1-this._getNumberOfInvisibleColumnsBetween(r,p),minRowID:t,height:m-t+1}}else{return undefined}},_getOriginalColumnIndexFromDataIndex:function(k){if(!this._originalColumnsReverseIndexes){this._computeOriginalColumnsReverseIndexes()}var l=this._columnsOriginalReverseIndexes[k];if(l===undefined){console.log("Error in getOriginalColumnIndexFromDataIndex : the column index is undefined for "+k)}return l},getDataIndexFromColumnIndex:function(k){var l=this.getLeafColumns();if(k>=0&&k<l.length){return l[k].dataIndex}else{return"rowHeader"}},_getDataIndexFromOriginalColumnIndex:function(k){var l=this._getOriginalLeafColumns();if(k>=0&&k<l.length){return l[k].dataIndex}else{return"rowHeader"}},getColumnIndex:function(l){var k=-1;if(l!==undefined){if(typeof l==="string"){if(!this._columnsReverseIndexes){this._computeColumnsReverseIndexes()}var k=this._columnsReverseIndexes[l];if(k===undefined){console.log("Error in getColumnIndex : the column index is undefined for "+l)}}else{k=l}}return k},getColumnIdentifiers:function(m){var l,k;if(typeof m==="string"){k=m;l=this.getColumnIndex(m)}else{l=m;k=this.getDataIndexFromColumnIndex(m)}return{dataIndex:k,columnIndex:l}},_getOriginalColumnIdentifiers:function(m){var l,k;if(typeof m==="string"){k=m;l=this._getOriginalColumnIndexFromDataIndex(m)}else{l=m;k=this._getDataIndexFromOriginalColumnIndex(m)}return{dataIndex:k,columnIndex:l}},resetRowHeights:function(){this._computedRows=[];this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},resetRowHeight:function(n){if(this._computedRows[n]&&(this._computedRows[n].height!==undefined)){var k=this._computedRows[n].height;this._computedRows[n].height=undefined;var m=this.getRowHeight(n);if(m!==k){for(var l=n+1;l<this._computedRows.length;l++){if(this._computedRows[l]){this._computedRows[l].top=undefined}}this.invalidate({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}},getRowHeightFromCellHeight:function(){return(this.collectionView._getCurrentTouchMode())?Math.max(this.cellHeight,g):this.cellHeight},getRowHeightFromCellContents:function(y){var m=this.getRowHeightFromCellHeight();if(this._autoRowHeightColumnIndexes){for(var t=0;t<this._autoRowHeightColumnIndexes.length;t++){var v=this._autoRowHeightColumnIndexes[t];if(this.getColumnVisibleState(v)){var x=this.getCellIDFromCoordinates({rowID:y,columnID:v});var s=false;var A=this.collectionView._getRenderedCellAt(x);if(!A){A=this.collectionView._renderCell(x,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});s=true}if(A&&A.component){var w=A.component._getReusableContent();if(w&&w.getContent){var n=A.component.getContent().style;var o=this.getColumnComputedWidth(v);n.width=o+"px";var r=n.lineHeight;var z=n.display;n.lineHeight="";n.display="block";var u=A.component.getContent().offsetHeight;var l=w.getContent().offsetHeight;if(l!==u){l+=2}if(m<l){m=l}n.display=z;n.lineHeight=r}else{var p=this.collectionView.model[y];if(p){var k=p.options.grid;var q=this.getColumnIdentifiers(v);if(k.hasOwnProperty(q.dataIndex)){this.collectionView._resetRowHeightsOnAllCellsRendered()}}}if(s){this.collectionView._freeUpCell(x,1)}}}}}return m},_computeRowHeightAndPosition:function(n){if(!this._computedRows[n]||(this._computedRows[n].top===undefined)||(this._computedRows[n].height===undefined)){for(var l=0;l<n;l++){this._computeRowHeightAndPosition(l)}if(!this._computedRows[n]){this._computedRows[n]={}}}if(this._computedRows[n].top===undefined){this._computedRows[n].top=(n>0)?this.getRowPosition(n-1)+this.getRowHeight(n-1)+this.rowSpacing:0}if(this._computedRows[n].height===undefined){var k=this.getRowHeightFromCellHeight();var m=0;if(typeof this.getRowHeightFunction==="function"){m=this.getRowHeightFunction(n)}this._computedRows[n].height=Math.max(m,k)}},getRowHeight:function(l){var k=0;if(this._useVariableRowHeight&&(l!==undefined)&&(l>=0)){if(!this._computedRows[l]||(this._computedRows[l].height===undefined)){this._computeRowHeightAndPosition(l)}if(this._computedRows[l]&&(this._computedRows[l].height!==undefined)){k=this._computedRows[l].height}}else{k=this.getRowHeightFromCellHeight()}return k+(this.collectionView.showRowBorderFlag?1:0)},getRowPosition:function(n){var m=0;if(n>=0){if(this._useVariableRowHeight&&(n!==undefined)){if(!this._computedRows[n]||(this._computedRows[n].top===undefined)){this._computeRowHeightAndPosition(n)}if(this._computedRows[n]&&(this._computedRows[n].top!==undefined)){m=this._computedRows[n].top}}else{m=(this.getRowHeight()+this.rowSpacing)*n}}else{var l=this.collectionView._getCurrentTouchMode()?Math.max(this.columnHeaderHeight,c):this.columnHeaderHeight;var k=this._getColumnTreeDepth();m=(n+k)*l}return m},_getEstimatedVirtualHeight:function(l){var n=0;if(this.collectionView.model.length===0){n=1;return n}if(this._useVariableRowHeight&&(!l||!this._autoRowHeightColumnIndexes||(this._autoRowHeightColumnIndexes.length===0)||(this._computedRows[this.collectionView.model.length-1]&&(this._computedRows[this.collectionView.model.length-1].top!==undefined)))){var k=this.getRowPosition(this.collectionView.model.length-1);var o=0;if(this._computedRows.length>0){o=this._computedRows[this._computedRows.length-1].top+this._computedRows[this._computedRows.length-1].height}var m=(this.collectionView.model.length-this._computedRows.length)*this.getRowHeight();n=o+m}else{n=this.collectionView.model.length*this.getRowHeight()}return n},_getRowIDFromPosition:function(r,n){var p=-1;var k=this.rowSpacing;if(this._useVariableRowHeight){if(r>=0){var q=this.collectionView.model.length-1;var o=0;for(var l=0;l<=q;l++){var m=this.getRowHeight(l);if(r<=o+m){p=l;if(n&&p+1<=q){p++}break}o+=m+k}}}else{if(n){p=Math.ceil(r/(this.getRowHeight()+k))}else{p=Math.floor(r/(this.getRowHeight()+k))}}return p},getCellCoordinatesAt:function(r){var s=-1;var p=-1;var q=this.rowsHeader;var n=this.columnsHeader;var t=(q?1:0)+3;var k=n?this._getColumnHeaderCellCount():0;if(r<k){if(r<0){s=-(this._columnItemsByDepth.length)-1;p=-4-(q?1:0)}else{s=-(this._columnItemsByDepth.length);if(r<t){p=r-t}else{var m=0;for(var o=0;o<this._columnItemsByDepth.length;o++){var l=this._columnItemsByDepth[o];if(r<m+l.length+t){p=r-m-t;break}else{s++;m+=l.length}}}}}else{var v=this._getLeafColumnsCount()+3;s=Math.floor((r-k)/v);p=((r-k)%v)-3-(q?1:0)}var u={rowID:s,columnID:p};return u},getCellIDFromCoordinates:function(r){var o=-1;var n=this.rowsHeader;if(r.rowID<0){if(r.columnID<0){if(r.rowID<-this._columnItemsByDepth.length){o=-1}else{o=r.columnID+3+(n?1:0)}}else{var q=3+(n?1:0);var p=0;for(var m=0;m<=this._columnItemsByDepth.length+r.rowID;m++){var l=this._columnItemsByDepth[m];if(m<this._columnItemsByDepth.length+r.rowID){p+=l.length}else{p+=r.columnID}}o=q+p}}else{var s=this._getLeafColumnsCount()+3;var k=this.columnsHeader?this._getColumnHeaderCellCount():0;o=k+(s*r.rowID)+r.columnID+3+(n?1:0)}if(o<-1){o=-1}return o},getColumnOrGroupFromCoordinates:function(k){var l=null;if(k.rowID===-1){l=this._leafColumns[k.columnID]}else{var m=this._columnItemsByDepth[this._columnItemsByDepth.length+k.rowID];if(m){l=m[k.columnID]}}return l},getFirstLeafColumnIndex:function(k){var l=-1;if(k){if(k.children){l=this.getFirstLeafColumnIndex(k.children[0])}else{l=this.getColumnIndex(k.dataIndex)}}return l},getLastLeafColumnIndex:function(k){var l=-1;if(k){if(k.children){l=this.getLastLeafColumnIndex(k.children[k.children.length-1])}else{l=this.getColumnIndex(k.dataIndex)}}return l},isRow:function(m){var k=this.getCellCoordinatesAt(m);var l=((k.columnID===this._leftPinnedRowcolumnID)||(k.columnID===this._unpinnedRowcolumnID)||(k.columnID===this._rightPinnedRowcolumnID));return l},getContentDimensions:function(){var o=this._getEstimatedVirtualHeight();var n=0;var p=this.getLeafColumns();for(var l=0;l<p.length;l++){var m=this.getColumnVisibleState(l);var k=this.getColumnPinned(l);if(m&&(k!=="left")&&(k!=="right")){n+=this.getColumnComputedWidth(l)}}return{width:n,height:o}},getLayoutStylesForCellAt:function(o){var u={};var x=this.getCellCoordinatesAt(o);var q=this.getRowPosition(x.rowID);var w=this.collectionView._getCurrentTouchMode();var t=((x.columnID===this._leftPinnedRowcolumnID)||(x.columnID===this._unpinnedRowcolumnID)||(x.columnID===this._rightPinnedRowcolumnID));var r=this.collectionView.showRowBorderFlag?1:0;if(t){var l=this.getRowHeight(x.rowID);if((!w&&(l!==a+r))||(w&&(l!==g+r))){u.height=l+"px"}u.transform="translateY("+q+"px)"}else{var m=0;if(x.columnID>-1){var p=this.getColumnOrGroupFromCoordinates(x);if(p){m=this.getColumnOrGroupPosition(p)}else{m=this.getColumnPosition(x.columnID)}}var k=this.getDimensionsForCellAt(o);u.width=k.width+"px";var s=(x.columnID===-1)?(a+r):a;var v=(x.columnID===-1)?(g+r):g;if((!w&&(k.height!==s))||(w&&(k.height!==v))){var n=k.height+"px";u.height=n;u.lineHeight=n}u.transform="translate3d("+m+"px,"+q+"px,0)"}return u},getLayoutAttributesForCellAt:function(r){var m=this.getCellCoordinatesAt(r);var n=this.getColumnOrGroupFromCoordinates(m);var o=((m.columnID===this._leftPinnedRowcolumnID)||(m.columnID===this._unpinnedRowcolumnID)||(m.columnID===this._rightPinnedRowcolumnID));var q={"cell-id":r};if(m.columnID===-1){q["row-header"]=""}if(!o&&(m.rowID<=-1)){q["column-header"]="";var l=n?this.getFirstLeafColumnIndex(n):m.columnID;if((l===this._firstUnpinnedColumnIndex)||(l===this._firstLeftPinnedColumnIndex)||(l===this._firstRightPinnedColumnIndex)){q["first-column"]=""}var k=n?this.getLastLeafColumnIndex(n):m.columnID;if((k===this._lastUnpinnedColumnIndex)||(k===this._lastLeftPinnedColumnIndex)||(k===this._lastRightPinnedColumnIndex)){q["last-column"]=""}}var p;if(m.columnID===this._leftPinnedRowcolumnID){p="left"}else{if(m.columnID===this._rightPinnedRowcolumnID){p="right"}else{if(m.columnID===-1){p="left"}else{if(n){p=this.getColumnOrGroupPinned(n)}else{p=this.getColumnPinned(m.columnID)}}}}if((p==="left")||(p==="right")){q.pinned=p}if(o){if((m.rowID%2)===0){q["even-row"]=""}else{q["odd-row"]=""}}return q},getMinMaxVisibleCellIDs:function(){var p=this.columnsHeader;var o=p?this._getColumnHeaderCellCount():0;var k=this._getLeafColumnsCount()+3;var q=0;var n=this.getMinMaxVisibleRowIDs();var m=o+(n.minRowID*k)-(q*k);var l=o+((n.maxRowID+1)*k)+(q*k)-1;m=Math.max(o,m);l=Math.min(l,o+(this.collectionView.model.length*k)-1);return{minCellID:m,maxCellID:l}},getMinMaxVisibleRowIDs:function(){var k=this.collectionView.getViewportDimensions();var n=this.collectionView.getScrollerPosition();var l=this._getRowIDFromPosition(n.y);var m=this._getRowIDFromPosition(n.y+k.height,true);if((m<=-1)&&(n.y+k.height>0)){m=this.collectionView.model.length-1}return{minRowID:l,maxRowID:m}},renderListOfVisibleCellsInViewport:function(q){if(!q||!q.render){return}var x=this.collectionView;var s=false;var l;if(q.allottedTime>0){l=window.performance?performance.now():Date.now()}var A=this.getMinMaxVisibleCellIDs();var G=this.getCellCoordinatesAt(A.minCellID);var k=this.getCellCoordinatesAt(A.maxCellID);var w=this.columnsHeader;var C=this.rowsHeader;var y=w?this._getColumnHeaderCellCount():0;x._listOfRenderedCells.forEach(function(I,J){if(((J<A.minCellID)&&(J>=y))||(J>A.maxCellID)){x._freeUpCell(J,1)}});var m=(this._firstLeftPinnedColumnIndex!==undefined)?true:false;var r=(this._firstRightPinnedColumnIndex!==undefined)?true:false;for(var E=G.rowID;E<=k.rowID;E++){if(m){var p=this.getCellIDFromCoordinates({rowID:E,columnID:this._leftPinnedRowcolumnID});q.render(p)}if(r){var p=this.getCellIDFromCoordinates({rowID:E,columnID:this._rightPinnedRowcolumnID});q.render(p)}var p=this.getCellIDFromCoordinates({rowID:E,columnID:this._unpinnedRowcolumnID});q.render(p)}if(w){if(C){q.render(3)}var B=(this.rowsHeader?1:0)+3;for(var E=0;E<this._columnItemsByDepth.length;E++){var z=this._columnItemsByDepth[E];for(var D=0;D<z.length;D++){var o;if(E===(this._columnItemsByDepth.length-1)){o=this._leafColumns[D]}else{o=z[D]}if(this.getColumnOrGroupVisibleState(o)){q.render(B)}B++}}}var H=G.rowID;var v=k.rowID;if(C){for(var u=H;u<=v;u++){var B=this.getCellIDFromCoordinates({rowID:u,columnID:-1});q.render(B)}}var t=this.getDisplayedColumnsIndexes();for(var u=H;u<=v;u++){if(!q.lightRendering&&!s){if((q.allottedTime>0)){var n=window.performance?performance.now():Date.now();if((n-l)>q.allottedTime){s=true}}for(var F=0;F<t.length;F++){if(t[F]>-1){if(!s){var B=this.getCellIDFromCoordinates({rowID:u,columnID:t[F]});q.render(B)}}}}}return{taskInterrupted:s}},getCellType:function(o){var l=this.getCellCoordinatesAt(o);var m;if(l.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(l);if(n){m=this.getColumnOrGroupPinned(n)}else{m=this.getColumnPinned(l.columnID)}}var k=((l.rowID%2)===0);if(l.rowID<=-1){if(l.columnID===-1){return"__topleft_row_header__"}if(m==="left"){return"__topleft_item__"}else{if(m==="right"){return"__topright_item__"}else{return"__top_item__"}}}else{if(l.columnID===this._leftPinnedRowcolumnID){return k?"__left_even_row__":"__left_odd_row__"}else{if(l.columnID===this._unpinnedRowcolumnID){return k?"__even_row__":"__odd_row__"}else{if(l.columnID===this._rightPinnedRowcolumnID){return k?"__right_even_row__":"__right_odd_row__"}else{if(l.columnID===-1){return"__row_header__"}else{var p=this.getLeafColumns();if(p[l.columnID].dataIndex==="tree"){if(m==="left"){return"__left_tree_item__"}else{if(m==="right"){return"__right_tree_item__"}else{return"__tree_item__"}}}else{if(m==="left"){return"__left_item__"}else{if(m==="right"){return"__right_item__"}else{return"__item__"}}}}}}}}},getHeaderContainerHeight:function(){var k=this._getColumnTreeDepth();if(this.collectionView._getCurrentTouchMode()){return this.columnsHeader?(Math.max(this.columnHeaderHeight,c)*k):0}else{return this.columnsHeader?(this.columnHeaderHeight*k):0}},getLeftContainerWidth:function(){var n=0;var o=this.getLeafColumns();for(var l=0;l<o.length;l++){var m=this.getColumnVisibleState(l);var k=this.getColumnPinned(l);if(m&&k==="left"){n+=this.getColumnComputedWidth(l)}}if(this.rowsHeader){n+=this.getRowHeaderWidth()}return n},getRightContainerWidth:function(){var n=0;var o=this.getLeafColumns();for(var l=0;l<o.length;l++){var m=this.getColumnVisibleState(l);var k=this.getColumnPinned(l);if(m&&k==="right"){n+=this.getColumnComputedWidth(l)}}return n},getPositionForCellAt:function(n){var k={top:0,left:0};var l=this.getCellCoordinatesAt(n);k.top=this.getRowPosition(l.rowID);if(l.columnID>-1){var m=this.getColumnOrGroupFromCoordinates(l);if(m){k.left=this.getColumnOrGroupPosition(m)}else{k.left=this.getColumnPosition(l.columnID)}}return k},getCellIDFromPositionInView:function(p){var r=-1;if(p){var u=this.getHeaderContainerHeight();if(p.top>=u){var t=this._getRowIDFromPosition(p.top-u);if(t<this.collectionView.model.length){var w=this.collectionView.getViewportDimensions();var l=this.getLeftContainerWidth();var m=this.getRightContainerWidth();var x="unpinned";if(p.left<=l){x="left"}else{if(p.left>=l+w.width){x="right"}}var o=-1;var s=this.rowsHeader?this.getRowHeaderWidth():0;if(p.left>=s){for(var q=0;q<this._orderedColumnsIndexes.length;q++){var n=this._orderedColumnsIndexes[q];var k=this.getColumnVisibleState(n);var v=this.getColumnPinned(n);if(k){s+=this.getColumnComputedWidth(n);if((v===x)&&(p.left<=s)){o=n;break}}}}if((t>=0)&&(o>=0)){r=this.getCellIDFromCoordinates({rowID:t,columnID:o})}}}}return r},getDimensionsForCellAt:function(m){var s=this.getCellCoordinatesAt(m);var q=((s.columnID===this._leftPinnedRowcolumnID)||(s.columnID===this._unpinnedRowcolumnID)||(s.columnID===this._rightPinnedRowcolumnID));var l=0;if(s.columnID>=-1){var n=this.getColumnOrGroupFromCoordinates(s);if(n){l=this.getColumnOrGroupComputedWidth(n)}else{l=this.getColumnComputedWidth(s.columnID)}}else{if(s.columnID===this._leftPinnedRowcolumnID){l=this.collectionView._leftContainerWidth}else{if(s.columnID===this._unpinnedRowcolumnID){var p=this.collectionView.getViewportDimensions();l=p.width}else{if(s.columnID===this._rightPinnedRowcolumnID){l=this.collectionView._rightContainerWidth}}}}var k=this.getRowHeight(s.rowID);var r;if(q){r=k}else{if(s.rowID<=-1){if(s.columnID===-1){r=this.getHeaderContainerHeight()}else{r=this.collectionView._getCurrentTouchMode()?Math.max(this.columnHeaderHeight,c):this.columnHeaderHeight}}else{if(s.columnID===-1){r=k}else{var o=this.collectionView.showRowBorderFlag?1:0;r=(k-o)}}}return{width:l,height:r}},computeCellRange:function(s,x){var u=[];var p=this.getCellCoordinatesAt(s);var l=this.getCellCoordinatesAt(x);if(p.columnID<0){p.columnID=0}if(l.columnID<0){l.columnID=0}var m=this._orderedColumnsReverseIndexes[p.columnID];var y=this._orderedColumnsReverseIndexes[l.columnID];if(m===undefined||y===undefined){return}var q=Math.min(m,y);var w=Math.max(m,y);var t=Math.min(p.rowID,l.rowID);var n=Math.max(p.rowID,l.rowID);for(var v=t;v<=n;v++){for(var k=q;k<=w;k++){var o=this._orderedColumnsIndexes[k];if(this.getColumnVisibleState(o)){var r=this.getCellIDFromCoordinates({rowID:v,columnID:o});u.push(r)}}}return u},isCellInRange:function(q,r,u){var p=false;var v=this.getCellCoordinatesAt(q);var o=this.getCellCoordinatesAt(r);var k=this.getCellCoordinatesAt(u);var t=Math.min(o.rowID,k.rowID);var l=Math.max(o.rowID,k.rowID);if((v.rowID>=t)&&(v.rowID<=l)){var s=this._compareColumnIDs(o.columnID,k.columnID);var n=(s<0)?o.columnID:k.columnID;var m=(n===o.columnID)?k.columnID:o.columnID;if((this._compareColumnIDs(v.columnID,n)>=0)&&(this._compareColumnIDs(v.columnID,m)<=0)){p=true}}return p},isNodeModelInRange:function(l,p,s){var k=false;if(l){var r=l._getRowID();var o=this.getCellCoordinatesAt(p);var m=this.getCellCoordinatesAt(s);var q=Math.min(o.rowID,m.rowID);var n=Math.max(o.rowID,m.rowID);k=((r>=q)&&(r<=n))}return k},getCellsFromNodeModel:function(r,q){var l=[];if(r){var n=r._getRowID();if(!q){var o=this.getLeafColumns();var k=o.length;for(var m=0;m<k;m++){l.push(this.getCellIDFromCoordinates({rowID:n,columnID:m}))}}else{var p=this.getVisibleOrderedColumnsIndexes();for(var m=0;m<p.length;m++){l.push(this.getCellIDFromCoordinates({rowID:n,columnID:p[m]}))}}}return l},_compareColumnIDs:function(m,l){var p=this.getColumnPinned(m);var k=this.getColumnPinned(l);if(p===k){var o=this.getColumnIdentifiers(m);var n=this.getColumnIdentifiers(l);return(o.columnIndex===n.columnIndex)?0:((o.columnIndex<n.columnIndex)?-1:1)}else{if(p==="left"){return -1}else{if(p==="right"){return 1}else{if(k==="left"){return 1}else{return -1}}}}},_computeCellIDFromCell:function(q,v,m,r){var t=q;var p=this.getCellCoordinatesAt(q);if((p.rowID>=0)&&(p.columnID>=0)){var w=-1;var l=-1;if(v==="up"){w=(p.rowID>0)?p.rowID-1:p.rowID;l=p.columnID}else{if(v==="right"){w=p.rowID;l=this._getNextVisibleColumnID(p.columnID)}else{if(v==="down"){w=(p.rowID<this.collectionView.model.length-1)?p.rowID+1:p.rowID;l=p.columnID}else{if(v==="left"){w=p.rowID;l=this._getPreviousVisibleColumnID(p.columnID)}else{if(v==="tab"){if(r){w=p.rowID;l=this._getPreviousVisibleColumnID(p.columnID);if((l<0)&&(w>0)){w--;l=this._getLastVisibleColumnID()}}else{w=p.rowID;l=this._getNextVisibleColumnID(p.columnID);if((l<0)&&(w<this.collectionView.model.length-1)){w++;l=this._getFirstVisibleColumnID()}}if(this.collectionView.focusNextEditableCellOnTabFlag){var u=this.getCellIDFromCoordinates({rowID:w,columnID:l});if(!this.collectionView.getCellEditableState(u)){while(1){var n=u;u=this._computeCellIDFromCell(u,v,m,r);if(u===n){w=-1;l=-1;break}else{if(this.collectionView.getCellEditableState(u)){var x=this.getCellCoordinatesAt(u);w=x.rowID;l=x.columnID;break}}}}}}else{if(v==="pageup"){var s=this.collectionView.getViewportDimensions();var o=this.getMinMaxVisibleRowIDs();var k=o.maxRowID-o.minRowID;w=Math.max(0,p.rowID-k);l=p.columnID}else{if(v==="pagedown"){var s=this.collectionView.getViewportDimensions();var o=this.getMinMaxVisibleRowIDs();var k=o.maxRowID-o.minRowID;w=Math.min(this.collectionView.model.length-1,p.rowID+k);l=p.columnID}else{if(v==="home"){if(m){w=0}else{w=p.rowID}l=this._getFirstVisibleColumnID()}else{if(v==="end"){if(m){w=this.collectionView.model.length-1}else{w=p.rowID}l=this._getLastVisibleColumnID()}else{if(v==="enter"){w=p.rowID;l=p.columnID;if(r){if(w>0){w--}}else{if(w<this.collectionView.model.length-1){w++}}}}}}}}}}}}if((w>=0)&&(l>=0)){t=this.getCellIDFromCoordinates({rowID:w,columnID:l})}}return t},_hasValidIdentifier:function(){if(this.identifier!==""){var k=Math.floor(Number(this.identifier));return((k<0)||(String(k)!==this.identifier))}return false},_getDataFromPreferences:function(k){var l=undefined;if(this._hasValidIdentifier()){l=h.getDataFromLocalPreferences(this.collectionView,i,k)}return l},_saveDataInPreferences:function(k,l){if(this._hasValidIdentifier()){h.saveDataInLocalPreferences(this.collectionView,i,k,l)}},checkPresenceOfDataGridViewPreferences:function(){if(this._hasValidIdentifier()){return h.checkPresenceOfPreferences(this.collectionView,i)}else{return false}},deleteDataGridViewPreferences:function(){h.deleteDataFromLocalPreferences(this.collectionView,i)},deleteDataGridViewKeyPreference:function(k){h.deleteDataFromLocalPreferences(this.collectionView,i,k)},_getColumnsVisibleFlagInPreferences:function(){return this._getDataFromPreferences("columnsVisibleFlag")},_saveColumnVisibleFlagInPreferences:function(l){var m=this._getColumnsVisibleFlagInPreferences();if(!m){m={}}var k=this.getColumnIdentifiers(l);m[k.dataIndex]=this.getColumnVisibleFlag(k.columnIndex);this._saveDataInPreferences("columnsVisibleFlag",m)},_getUnpinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("unpinnedColumnsOrder")},_getPinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("pinnedColumnsOrder")},_saveColumnOrderInPreferences:function(o){var m=this.getColumnPinned(o);var n=(m==="unpinned")?this._getUnpinnedColumnsOrderInPreferences():this._getPinnedColumnsOrderInPreferences();if(!n){n={}}for(var k in n){if(n.hasOwnProperty(k)&&this._hasColumn(k)&&this.getColumnPinned(k)===m){n[k]=this._orderedColumnsReverseIndexes[this.getColumnIndex(k)]}}var l=this.getColumnIdentifiers(o);n[l.dataIndex]=this._orderedColumnsReverseIndexes[l.columnIndex];var p=m==="unpinned"?"unpinnedColumnsOrder":"pinnedColumnsOrder";this._saveDataInPreferences(p,n)},_getColumnsWidthInPreferences:function(){return this._getDataFromPreferences("columnsWidth")},_saveColumnWidthInPreferences:function(m){var l=this._getColumnsWidthInPreferences();if(!l){l={}}var k=this.getColumnIdentifiers(m);l[k.dataIndex]=this.getColumnWidth(k.columnIndex);this._saveDataInPreferences("columnsWidth",l)},_getColumnsPinnedStateInPreferences:function(){return this._getDataFromPreferences("columnsPinnedState")},_hasColumn:function(k){if(!this._columnsReverseIndexes){this._computeColumnsReverseIndexes()}if(typeof this._columnsReverseIndexes[k]!=="undefined"){return true}return false},_saveColumnPinnedStateInPreferences:function(m){var l=this._getColumnsPinnedStateInPreferences();if(!l){l={}}var k=this.getColumnIdentifiers(m);l[k.dataIndex]=this.getColumnPinned(k.columnIndex);this._saveDataInPreferences("columnsPinnedState",l)},_getColumnsSortModelInPreferences:function(){return this._getDataFromPreferences("columnsSortModel")},_saveColumnSortModelInPreferences:function(){this._saveDataInPreferences("columnsSortModel",this.collectionView.sortModel)},_getGroupingOptionsInPreferences:function(){return this._getDataFromPreferences("groupingOptions")},_saveGroupingOptionsInPreferences:function(){this._saveDataInPreferences("groupingOptions",this.collectionView._rowModel._groupingOptions)},_getOrderedColumnIndexFromPreferences:function(){var n=this._getUnpinnedColumnsOrderInPreferences();var k=this._getPinnedColumnsOrderInPreferences();var l=this._getColumnsPinnedStateInPreferences();var t=this._orderedColumnsIndexes.slice(0);var m={};m=h.concatenateObjects(k,n);var q=[],x=[],u=[];for(var y in m){var A;if(l&&l.hasOwnProperty(y)){A=l[y]}else{A=this.getColumnPinned(y)}if(A==="left"){if(k){var p=k[y];q.push({dataIndex:y,columnIndexInPref:p})}}else{if(A==="right"){if(k){var p=k[y];x.push({dataIndex:y,columnIndexInPref:p})}}else{if(A==="unpinned"){if(n){var p=n[y];u.push({dataIndex:y,columnIndexInPref:p})}}}}}var s=function(B,D){for(var C=0;C<B.length;C++){if(B[C]===D){B.splice(C,1);return}}};var o=h.concatenateObjects(h.concatenateObjects(u,q),x);var w=[];for(var z in o){if(o.hasOwnProperty(z)&&this._hasColumn(o[z].dataIndex)){var v=this.getColumnIndex(o[z].dataIndex);w[o[z].columnIndexInPref]=v;s(t,v)}}for(var r=0;r<this._orderedColumnsIndexes.length;r++){if(w.length<r){return w.concat(t)}else{if((typeof w[r]==="undefined")&&(t.length>0)){w[r]=t[0];t.splice(0,1)}}}w=w.filter(function(B){return B!==undefined});return w},_applyPreferencesOnColumns:function(){var p=this._getColumnsVisibleFlagInPreferences();var n=this._getUnpinnedColumnsOrderInPreferences();var k=this._getPinnedColumnsOrderInPreferences();var r=this._getColumnsWidthInPreferences();var m=this._getColumnsPinnedStateInPreferences();var s=this._getColumnsSortModelInPreferences();var l=this._getGroupingOptionsInPreferences();this.collectionView.prepareUpdateView();var q=this.getLeafColumns();for(var o=0;o<q.length;o++){if(p&&(p.hasOwnProperty(q[o].dataIndex))){q[o].visibleFlag=p[q[o].dataIndex]}if(r&&(r.hasOwnProperty(q[o].dataIndex))){q[o].width=r[q[o].dataIndex]}if(m&&(m.hasOwnProperty(q[o].dataIndex))){this.setColumnPinned(o,m[q[o].dataIndex])}}this._orderedColumnsIndexes=this._getOrderedColumnIndexFromPreferences();this._computeOrderedColumnsReverseIndexes();this._updateColumnTreeFromOrderedIndexes();if(s){this.collectionView.sortModel=s}if(l){this.collectionView.groupRows(l)}this.collectionView.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true)}});return f});define("DS/DataGridView/DataGridViewBaseFilterView",["UWA/Core","UWA/Element","DS/Core/BaseComponent","DS/Core/PointerEvents","DS/Controls/Popup","DS/Controls/Button","i18n!DS/DataGridView/assets/nls/translation"],function(e,a,c,f,b,i,j){var d=function(){if(this.elements._popup){return}this.elements._popup=new b({target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-layouts-datagridview-base-filter-popup",constraint:"screen",overlap:false,trigger:"click"});var k=new e.Element("div");this._popupContentDiv=new e.Element("div").inject(k);var l=h.call(this);l.inject(k);this.elements._popup.setBody(k)};var h=function(){var k=new e.Element("div",{"class":"wux-layouts-datagridview-base-filter-footer"});var l=this;this._applyButton=new i({label:j.FilterView.Apply,emphasize:"primary",onClick:function(n){l.validateView()}});this._applyButton.inject(k);var m=new i({label:j.FilterView.Clear,onClick:function(n){l.clearView()}});m.inject(k);return k};var g=c.inherit({name:"datagridviewbasefilterview",publishedProperties:{filterViewManager:{defaultValue:undefined,type:"object",readOnly:true},filterId:{defaultValue:"",type:"string",readOnly:true},propertyId:{defaultValue:"",type:"string",readOnly:true},validFlag:{defaultValue:true,type:"boolean"},filter:{defaultValue:null,type:"object",readOnly:true}},refreshView:function(){this.refreshContentView();this._refreshIconView()},validateView:function(){if(!this.validFlag){return}var k=this.buildFilterModelFromView();this.filterViewManager.disableUpdateView();this.filter.filterModel=k;this.filterViewManager.enableUpdateView();this._refreshIconView()},clearView:function(){this.validFlag=true;this.clearFilterViewContent();this.filterViewManager.disableUpdateView();this.filter.filterModel=this.buildFilterModelFromView();this.filterViewManager.enableUpdateView();this._refreshIconView()},buildContentView:function(){},buildFilterModelFromView:function(){},clearFilterViewContent:function(){},refreshContentView:function(){},_build:function(){this._parent();this.elements.container=new e.Element("div");this.elements.container.dsModel=this;this._popupContentDiv=null;this._applyButton=null;this.handleEvents()},_postBuild:function(){this._refreshIconView()},handleEvents:function(){var k=this;var l=function(m){if(!k.elements._popup){d.call(k);k.buildContentView(this._popupContentDiv);k.elements._popup.visibleFlag=true;k.elements._popup.addEventListener("show",function(n){if(n.dsModel.name==="popup"){k.refreshView()}})}k.elements.container.removeEventListener(f.POINTERHIT,l);m.stopPropagation()};this.elements.container.addEventListener(f.POINTERHIT,l)},_refreshIconView:function(){if(!this.elements.container||!this.filter){return}if(this.filter.isEmpty()){this.elements.container.className="wux-layouts-datagridview-base-filter-view wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search-filter"}else{this.elements.container.className="wux-layouts-datagridview-base-filter-view wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter"}},_applyValidFlag:function(){this._applyButton.disabled=!this.validFlag},_applyProperties:function(k){this._parent()}});return g});define("DS/DataGridView/DataGridViewRow",["DS/CollectionView/CollectionViewCell"],function(b){var a=b.inherit({name:"DataGridViewRow",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-row")}});return a});define("DS/DataGridView/RowModelBase",["DS/Core/BaseComponent"],function(a){var b=a.inherit({name:"RowModelBase",publishedProperties:{},_syncModel:function(){var c=this.dataGridView;var e=this;c._hasFlatTreeState=true;var d=[];if(e._getTreeDocument()){e._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:true,processNode:function(f){d.push(f.nodeModel);if(f.nodeModel.getChildren()){c._hasFlatTreeState=false}}});c.model=d}},getNodesXSO:function(){var d=null;var c=this._getTreeDocument();if(c){d=c.getXSO()}return d},shouldBeSelected:function(d){var c=this._getTreeDocument();if(c&&!c.options.shouldBeSelected.call(c,d)){return false}return true},groupRows:function(e){var f=this;var c=this.dataGridView;if(e&&e.dataIndexesToGroup){e.dataIndexesToGroup=e.dataIndexesToGroup.filter(function(g){return c.layout.getColumnOptionValue(g,"groupableFlag")});var d=f._groupingOptions&&f._groupingOptions.dataIndexesToGroup||[];f._groupingOptions=e;if(e.dataIndexesToGroup.length===0&&d.length===0){return}if(e.dataIndexesToGroup.length>0&&d.length===0){c.disableRowReordering()}else{if(e.dataIndexesToGroup.length===0&&d.length>0){c.enableRowReordering()}}if(c.rowGroupingOptions.hideGroupedColumns){e.dataIndexesToGroup.forEach(function(h){var g=d.indexOf(h);if(g!==-1){d.splice(g,1)}else{c.layout.setColumnVisibleFlag(h,false)}});d.forEach(function(g){c.layout.setColumnVisibleFlag(g,true)})}this._doGroupingOnModel(e)}},_listenToTreeDocument:function(){var f=this;var c=this.dataGridView;var d=this._getTreeDocument();d.onUpdate(function(g){f._syncModel();if(!f._isModelBeingFetched()){if(c.model&&c.model.length===0){c._displayEmptyContentMessage()}else{c._removeEmptyContentMessage()}}if(f._mustRedrawColumnHeaders){c._updateRenderedRow(-1,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});f._mustRedrawColumnHeaders=false}if(f._mustClearViewSelection){c.getCellsXSO().empty();f._mustClearViewSelection=false}});f._syncModel();d.onNodeModelUpdate(function(g){var i=g.data.nodeModel;if(i){var h=c.layout;var j=i._getRowID();c._updateRenderedRow(j,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:true});if(h._useVariableRowHeight){h.resetRowHeight(j)}}});var e=function(i){var g=i.target;if(g&&!g.isExpanded()){var h=g.getChildren();if(((i.event==="addChild")&&h&&(h.length===1))||((i.event==="removeChild")&&(!h||(h.length===0)))){c.updateCellView(c.layout.getCellIDFromCoordinates({rowID:g._getRowID(),columnID:c.layout.getColumnIndex("tree")}),{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}}};d.addModelEventListener("addChild",e);d.addModelEventListener("removeChild",e);this._manageTreeDocumentSelection()},_manageTreeDocumentSelection:function(){var c=this.dataGridView;var e=this.dataGridView.layout;var d=this.getNodesXSO();d.onPostAdd(function(f){var g=e.getMinMaxVisibleRowIDs();f.forEach(function(h){var j=h._getRowID();if((j>=g.minRowID)&&(j<=g.maxRowID)){c._updateRenderedRowCellsAttributes(j)}if((j>=g.minRowID)&&(j<=g.maxRowID)){var i=c._getSelectionCheckBox(j);if(i){var k=i.preventTriggeringChangeEvent;i.preventTriggeringChangeEvent=true;i.checkFlag=true;i.preventTriggeringChangeEvent=k}}});c._updateSelectAllCheckBox()});d.onPostRemove(function(g){var f=e.getMinMaxVisibleRowIDs();g.forEach(function(h){var j=h._getRowID();if((j>=f.minRowID)&&(j<=f.maxRowID)){c._updateRenderedRowCellsAttributes(j);var i=c._getSelectionCheckBox(j);if(i){var k=i.preventTriggeringChangeEvent;i.preventTriggeringChangeEvent=true;i.checkFlag=false;i.preventTriggeringChangeEvent=k}}});c._updateSelectAllCheckBox()})},prepareUpdate:function(){this._getTreeDocument().prepareUpdate()},pushUpdate:function(){this._getTreeDocument().pushUpdate()},});return b});define("DS/DataGridView/DataGridViewContextualMenuBuilder",["DS/Utilities/Dom","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Toggle","DS/Controls/Button","DS/Controls/SpinBox","DS/Controls/SelectionChips","DS/Windows/Dialog","i18n!DS/DataGridView/assets/nls/translation"],function(b,a,g,l,k,j,f,n,m){var e=function(o){this._collectionView=o;this._supportedMenus=["pin","sizeColumnToFit","firstColumnsVisibility","columnsManagement","insertRow"];this._columnsManagement=undefined};e.prototype.buildMenu=function(s,p){if(!this._collectionView){console.log("A collection view is mandatory to build its contextual menu");return[]}var o={pin:true,firstColumnsVisibility:true,columnsManagement:true,sizeColumnToFit:true,insertRow:false};p=UWA.extend(o,p);var q=this;var r=[];this._supportedMenus.forEach(function(u){if(p[u]===true){var v=u.substring(0,1).toUpperCase()+u.substring(1,u.length);var t="_create"+v+"ContextualMenu";var w=q[t](s);if(w.length>0&&r.length>0){r.push({type:"SeparatorItem",title:""})}r=r.concat(w)}});return r};e.prototype.showColumnsManagementDialog=function(){d.call(this);h.call(this);c.call(this)};e.prototype._createPinContextualMenu=function(s){var p=this;var r=[];if(s.cellInfos&&(s.cellInfos.rowID===-1)){var o=this._collectionView.layout.getColumnPinned(s.cellInfos.columnID);var q=[];q.push({type:"RadioItem",title:m.ContextualMenuBuilder.PinLeft,state:(o==="left")?"selected":"unselected",action:{callback:function(t){p._collectionView.layout.setColumnPinned(s.cellInfos.columnID,"left",{isUserInteraction:true})}}});q.push({type:"RadioItem",title:m.ContextualMenuBuilder.PinRight,state:(o==="right")?"selected":"unselected",action:{callback:function(t){p._collectionView.layout.setColumnPinned(s.cellInfos.columnID,"right",{isUserInteraction:true})}}});q.push({type:"RadioItem",title:m.ContextualMenuBuilder.NoPin,state:((o!=="left")&&(o!=="right"))?"selected":"unselected",action:{callback:function(t){p._collectionView.layout.setColumnPinned(s.cellInfos.columnID,"unpinned",{isUserInteraction:true})}}});r.push({type:"PushItem",title:m.ContextualMenuBuilder.PinMenu,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-pin"},submenu:q})}return r};e.prototype._createFirstColumnsVisibilityContextualMenu=function(q){var o=[];var w=q.cellInfos&&(q.cellInfos.rowID===-1);if(!w&&q.infos&&q.infos.target){w=b.firstParentWithClass(q.infos.target,"wux-layouts-header")}if(w){var p=undefined;var t=undefined;var r=this._collectionView.layout;var u=r.getLeafColumns();for(var v=0;v<u.length&&v<8;v++){p=u[r._orderedColumnsIndexes[v]];t=undefined;if(r.getColumnVisibleFlag(p.dataIndex)){t={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-check"}}o.push({type:"PushItem",title:p.text,fonticon:t,state:r.getColumnAlwaysVisibleFlag(p.dataIndex)?"disabled":"",action:{callback:function s(y){if(y&&y.context&&y.context.id){var x=r.getColumnVisibleFlag(y.context.id);r.setColumnVisibleFlag(y.context.id,!x,{isUserInteraction:true})}},context:{id:p.dataIndex}}})}}return o};e.prototype._createColumnsManagementContextualMenu=function(r){var p=this;var q=[];var o=r.cellInfos&&(r.cellInfos.rowID===-1);if(!o&&r.infos&&r.infos.target){o=b.firstParentWithClass(r.infos.target,"wux-layouts-header")}if(o){q.push({type:"PushItem",title:m.ContextualMenuBuilder.More,action:{callback:function(s){p.showColumnsManagementDialog()}}})}return q};e.prototype._createSizeColumnToFitContextualMenu=function(q){var p=[];var o=q.cellInfos&&(q.cellInfos.rowID===-1);if(!o&&q.infos&&q.infos.target){o=b.firstParentWithClass(q.infos.target,"wux-layouts-header")}if(o&&q.cellInfos){p.push({type:"PushItem",title:m.ContextualMenuBuilder.SizeToFit,state:this._collectionView.layout.getColumnResizableFlag(q.cellInfos.columnID)===false?"disabled":"",action:{context:{cellInfos:q.cellInfos},callback:function(v){if(v&&v.context&&v.context.cellInfos){var r=v.context.cellInfos.manager;var u=r.layout;var s=u.getColumnOrGroupFromCoordinates(v.context.cellInfos);var t;if(s){t=u.getLastLeafColumnIndex(s)}else{t=v.context.cellInfos.columnID}var w=u.getLeafColumns();if(r&&t>=0&&t<w.length){r.sizeColumnToFit(t,{isUserInteraction:true})}}}}});p.push({type:"PushItem",title:m.ContextualMenuBuilder.SizeAllToFit,action:{context:{cellInfos:q.cellInfos},callback:function(s){if(s&&s.context&&s.context.cellInfos){var r=s.context.cellInfos.manager;r.sizeAllColumnsToFit({isUserInteraction:true})}}}})}return p};e.prototype._createInsertRowContextualMenu=function(q){var p=[];var o=q.cellInfos&&(q.cellInfos.rowID<=-1);if(o){return p}var r=function(y,s){if(y&&y.context&&y.context.cellInfos){var t=y.context.cellInfos.manager;var u=t.getTreeDocument();u.prepareUpdate();var v=new g();var w=y.context.cellInfos.nodeModel._getLocalID();y.context.cellInfos.nodeModel.getParent().addChild(v,(s==="before")?w:w+1);var x=v._getRowID();t.insertRowCallback(v,x,q.cellInfos);u.pushUpdate();t.ensureNodeModelVisible(v,true);t._flashEffectOnRow("ui-modified",x)}};p.push({type:"PushItem",title:m.ContextualMenuBuilder.InsertRowBefore,action:{context:{cellInfos:q.cellInfos},callback:function(s){r(s,"before")}}});p.push({type:"PushItem",title:m.ContextualMenuBuilder.InsertRowAfter,action:{context:{cellInfos:q.cellInfos},callback:function(s){r(s,"after")}}});return p};function i(){var t=this;var p=UWA.createElement("div",{html:m.ContextualMenuBuilder.ColumnsManagementDialog.Description,"class":"wux-layouts-collectionview-columnsmanagement-maindiv"});var v=UWA.createElement("div",{"class":"wux-layouts-collectionview-columnsmanagement-part wux-layouts-collectionview-columnsmanagement-datagridview"});this._columnsManagement.model=new a();var u=this._collectionView.layout.getLeafColumns();u.forEach(function(x){t._columnsManagement.model.addRoot(new g({label:x.text,grid:{visibility:false,width:0,dataIndex:x.dataIndex,pinned:"unpinned"}}))});var w=require("DS/DataGridView/DataGridView");this._columnsManagement.view=new w({identifier:this._collectionView.identifier+"_ColumnsManagementDataGridView",rowDragEnabledFlag:true,rowReorderEnabledFlag:false,showRowIndexFlag:false,showSelectionCheckBoxesFlag:false,treeDocument:this._columnsManagement.model,columns:[{text:m.ContextualMenuBuilder.ColumnsManagementDialog.ColumnsName,dataIndex:"tree",editableFlag:false,resizableFlag:true,width:"auto"},{text:m.ContextualMenuBuilder.ColumnsManagementDialog.ColumnsVisibility,dataIndex:"visibility",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",width:60},{text:m.ContextualMenuBuilder.ColumnsManagementDialog.ColumnsWidth,dataIndex:"width",typeRepresentation:"integer",width:80,editionPolicy:"EditionOnClick"},{text:m.ContextualMenuBuilder.ColumnsManagementDialog.ColumnsPinnedState,dataIndex:"pinned",typeRepresentation:"pinnedEnum",width:110,editionPolicy:"EditionOnOver"}],defaultColumnDef:{minWidth:30,editableFlag:true,resizableFlag:false,editionPolicy:"EditionOnOver",sortableFlag:false}});var r={};r[m.ContextualMenuBuilder.NoPin]="unpinned";r[m.ContextualMenuBuilder.PinLeft]="left";r[m.ContextualMenuBuilder.PinRight]="right";this._columnsManagement.view.getTypeRepresentationFactory().registerEnum("pinnedEnum",r);this._columnsManagement.view.inject(v);v.inject(p);var q=UWA.createElement("div",{"class":"wux-layouts-collectionview-columnsmanagement-part"});var o=function(C,x){var z=t._collectionView.getDraggedRowData(C);if(z){var B={label:z.label,value:z.grid.dataIndex,index:undefined};var A=x.chipCellView?x.chipCellView.associatedModelItem:undefined;if(A){var y=x.dropPosition;if(y==="left"){B.index=t._columnsManagement.groupingSelectionChips.getChipPosition(A.chipOptions.label)}else{if(y==="right"){B.index=t._columnsManagement.groupingSelectionChips.getChipPosition(A.chipOptions.label)+1}}}t._columnsManagement.groupingSelectionChips.addChip(B)}return true};this._columnsManagement.groupingSelectionChips=new f({shape:f.SHAPE.OVAL,placeholder:m.ContextualMenuBuilder.ColumnsManagementDialog.GroupingPlaceholder,onDropCell:function(y,x){return o(y,x)},onDropBlank:function(y,x){return o(y,x)}});this._columnsManagement.groupingSelectionChips.inject(q);q.inject(p);var s=UWA.createElement("div",{"class":"wux-layouts-collectionview-columnsmanagement-part"});this._columnsManagement.resetPrefButton=new k({label:m.ContextualMenuBuilder.ColumnsManagementDialog.ResetPreferences,onClick:function(x){t._columnsManagement.resetPreferencesHasBeenClicked=true;t._columnsManagement.model.processDescendants({processNode:function(z){var B=t._collectionView.layout._getOriginalColumnOptionValue(z.nodeModel.options.grid.dataIndex,"visibleFlag");var A=t._collectionView.layout._getOriginalColumnOptionValue(z.nodeModel.options.grid.dataIndex,"width");var y=t._collectionView.layout._getOriginalColumnOptionValue(z.nodeModel.options.grid.dataIndex,"pinned");z.nodeModel.updateOptions({grid:{visibility:B,width:(A==="auto"?-1:A),pinned:(y?y:"unpinned")}})}});t._columnsManagement.view.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});t._columnsManagement.resetPrefButton.disabled=true}});this._columnsManagement.model.onNodeModelUpdate(function(x){t._columnsManagement.resetPrefButton.disabled=false});this._columnsManagement.resetPrefButton.getContent().addClassName("wux-layouts-collectionview-columnsmanagement-flushButton");this._columnsManagement.resetPrefButton.getContent().inject(s);s.inject(p);return p}function d(){if(this._columnsManagement){return}this._columnsManagement={dialog:undefined,model:undefined,view:undefined,resetPrefButton:undefined,resetPreferencesHasBeenClicked:false};var o=this;this._columnsManagement.dialog=new n({identifier:"columnsManagementPanel",title:m.ContextualMenuBuilder.ColumnsManagementDialog.Title,autoCloseFlag:false,resizableFlag:true,modalFlag:true,width:530,height:530,content:i.call(this),buttons:{Cancel:new k({onClick:function(p){o._columnsManagement.dialog.visibleFlag=false}}),Ok:new k({onClick:function(v){var u=o._collectionView.layout;o._collectionView.prepareUpdateView();var s={};if(o._columnsManagement.resetPreferencesHasBeenClicked){u.deleteDataGridViewPreferences();o._columnsManagement.resetPreferencesHasBeenClicked=false;o._columnsManagement.model.processDescendants({processNode:function(x){var z=x.nodeModel.options.grid.visibility;if(z!==u._getOriginalColumnOptionValue(x.nodeModel.options.grid.dataIndex,"visibleFlag")){u.setColumnVisibleFlag(x.nodeModel.options.grid.dataIndex,z,{isUserInteraction:true})}else{if(z!==u.getColumnVisibleFlag(x.nodeModel.options.grid.dataIndex)){u.setColumnVisibleFlag(x.nodeModel.options.grid.dataIndex,z)}}var y=x.nodeModel.options.grid.width;if(y===-1){y="auto"}if(y!==u._getOriginalColumnOptionValue(x.nodeModel.options.grid.dataIndex,"width")){u.setColumnWidth(x.nodeModel.options.grid.dataIndex,y,{isUserInteraction:true})}else{if(y!==u.getColumnWidth(x.nodeModel.options.grid.dataIndex)){u.setColumnWidth(x.nodeModel.options.grid.dataIndex,y)}}var w=x.nodeModel.options.grid.pinned;if(w!==u._getOriginalColumnOptionValue(x.nodeModel.options.grid.dataIndex,"pinned")){u.setColumnPinned(x.nodeModel.options.grid.dataIndex,w,{isUserInteraction:true})}else{if(w!==u.getColumnPinned(x.nodeModel.options.grid.dataIndex)){u.setColumnPinned(x.nodeModel.options.grid.dataIndex,w)}}}});var r=u._originalOrderedColumnsIndexes.slice(0);if(u._orderedColumnsIndexes!==r){u._orderedColumnsIndexes=u._originalOrderedColumnsIndexes.slice(0);u._computeOrderedColumnsReverseIndexes();u._updateColumnTreeFromOrderedIndexes();o._collectionView.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}var q=o._collectionView._originalSortModel;if(o._collectionView.sortModel!==q){o._collectionView.sortModel=q;o._collectionView.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})}}else{o._columnsManagement.model.processDescendants({processNode:function(x){var z=x.nodeModel.options.grid.visibility;if(z!==u.getColumnVisibleFlag(x.nodeModel.options.grid.dataIndex)){u.setColumnVisibleFlag(x.nodeModel.options.grid.dataIndex,z,{isUserInteraction:true})}var y=x.nodeModel.options.grid.width;if(y===-1){y="auto"}if(y!==u.getColumnWidth(x.nodeModel.options.grid.dataIndex)){u.setColumnWidth(x.nodeModel.options.grid.dataIndex,y,{isUserInteraction:true})}var w=x.nodeModel.options.grid.pinned;if(w!==u.getColumnPinned(x.nodeModel.options.grid.dataIndex)){u.setColumnPinned(x.nodeModel.options.grid.dataIndex,w,{isUserInteraction:true})}}})}var t=o._columnsManagement.groupingSelectionChips.getAllChipsOptions();var p=t.map(function(w){return w.value});if(!o._collectionView._rowModel._groupingOptions||!o._collectionView._rowModel._groupingOptions.dataIndexesToGroup.equals(p)){s={updateCellContent:true,updateCellLayout:true,updateCellAttributes:true};o._collectionView.groupRows({dataIndexesToGroup:p});u._saveGroupingOptionsInPreferences()}o._collectionView.pushUpdateView(s);o._columnsManagement.dialog.visibleFlag=false}})}});this._columnsManagement.dialog.addEventListener("close",function(p){o._columnsManagement.dialog.visibleFlag=false})}function h(){if(!this._columnsManagement){return}var p=this;this._columnsManagement.groupingSelectionChips.removeAllChips();if(this._collectionView._rowModel._groupingOptions){for(var o=0;o<this._collectionView._rowModel._groupingOptions.dataIndexesToGroup.length;o++){var q=this._collectionView._rowModel._groupingOptions.dataIndexesToGroup[o];this._columnsManagement.groupingSelectionChips.addChip({label:p._collectionView.layout.getColumnOptionValue(q,"text"),value:q})}}this._columnsManagement.model.processDescendants({processNode:function(s){var u=p._collectionView.layout.getColumnVisibleFlag(s.nodeModel.options.grid.dataIndex);var t=p._collectionView.layout.getColumnWidth(s.nodeModel.options.grid.dataIndex);var r=p._collectionView.layout.getColumnPinned(s.nodeModel.options.grid.dataIndex);s.nodeModel.updateOptions({grid:{visibility:u,width:(t==="auto"?-1:t),pinned:(r?r:"unpinned")}})}});p._columnsManagement.view.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false});p._columnsManagement.resetPrefButton.disabled=!p._collectionView.layout.checkPresenceOfDataGridViewPreferences()}function c(){if(!this._columnsManagement){return}this._columnsManagement.view.setActiveCell(-1);var o=b.firstParentWithClass(this._collectionView.getContent(),"wux-windows-immersive-frame");this._columnsManagement.dialog.immersiveFrame=o?o.dsModel:undefined;this._columnsManagement.dialog.visibleFlag=true}return e});define("DS/DataGridView/DataGridViewRowHeaderCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Toggle"],function(g,d,f,c,a,b){var e=f.inherit({name:"DataGridViewRowHeaderCell",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-row-header-cell")},buildView:function(){this._parent();var j=a.generateIcon({iconName:"drag-grip",fontIconFamily:WUXManagedFontIcons.Font3DS});j.classList.add("wux-datagridview-drag-grip");j.setAttribute("draggable",true);j.inject(this.elements.container);var i=new g.Element("div",{"class":"wux-datagridview-selection-label"});i.inject(this.elements.container);var h=new b({type:"checkbox",checkFlag:false,fireOnlyFromUIInteractionFlag:true});h.getContent().classList.add("wux-datagridview-selection-checkbox");h.inject(this.elements.container)}});return e});define("DS/DataGridView/DataGridViewSetFilterView",["DS/Core/BaseComponent","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/CollectionViewStatusBar","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/LineEditor"],function(e,h,a,f,i,k,c){var l=function(m){if(m===undefined||m===null||m===""){return"(Blank)"}return m};var j=function(n){var p=(n.options&&n.options.getAttributeValueForFiltering)?n.options.getAttributeValueForFiltering(this.propertyId):n.getAttributeValue(this.propertyId);var o=l.call(this,p);if(!this._possibleValues[o]){var m=new f({label:o+" (1)",attributeName:p,attributeId:o,count:0});this._treeDocumentPossibleValues.addRoot(m);this._possibleValues[o]=m}this._possibleValues[o].options.count++;return this._possibleValues[o]};var g=function(){if(!this._treeDocumentPossibleValues){return}this._treeDocumentPossibleValues.prepareUpdate();this._treeDocumentPossibleValues.empty();this._possibleValues={};var m=this.filterViewManager.filterManager.model;var p=this;m.processDescendants({processNode:function(q){j.call(p,q.nodeModel)}});for(var n in this._possibleValues){var o=this._possibleValues[n];o.updateOptions({label:o.options.attributeId+" ("+o.options.count+")"})}this._treeDocumentPossibleValues.pushUpdate()};var d=function(){var n=this.filter.filterModel;var q=false;if(!n||n.length===0){q=true}var m=[];for(var o in this._possibleValues){var p=this._possibleValues[o];if(q){m.push(p)}else{var r=p.options.attributeName;if(r===undefined||r===null||r===""){if(n.indexOf(undefined)!==-1||n.indexOf(null)!==-1||n.indexOf("")!==-1){m.push(p)}}else{if(n.indexOf(r)!==-1){m.push(p)}}}}this._treeDocumentPossibleValues.getXSO().add(m)};var b=k.inherit({name:"datagridviewsetfilterview",publishedProperties:{},_build:function(){this._parent();this._possibleValues=null;this._treeDocumentPossibleValues=null;this._searchLineEditor=null;this._dataGridViewPossibleValues=null},buildContentView:function(){var p=this._popupContentDiv;if(!p){return}p.addClassName("wux-layout-datagridview-filterview-set");var q=this;this._searchLineEditor=new c({placeholder:"Enter an attribute value"}).inject(p);this._searchLineEditor.getContent().addClassName("wux-layouts-datagridview-base-filter-condition");this._searchLineEditor.addEventListener("uncommittedChange",function r(){var s=q._treeDocumentPossibleValues.getRoots();q._treeDocumentPossibleValues.prepareUpdate();s.forEach(function t(u){if(u.options.attributeId.startsWith(q._searchLineEditor.valueToCommit)){u.show()}else{u.hide(true)}});q._treeDocumentPossibleValues.pushUpdate()});this._possibleValues={};this._treeDocumentPossibleValues=new a();var n=this._treeDocumentPossibleValues.getXSO();var m=function(){q.validFlag=!n.isEmpty()};n.onPostAdd(m);n.onPostRemove(m);var o=require("DS/DataGridView/DataGridView");this._dataGridViewPossibleValues=new o({treeDocument:this._treeDocumentPossibleValues,height:200,columns:[{text:"( Select All )",dataIndex:"tree",editableFlag:false,resizableFlag:false,width:"auto"}],showRowIndexFlag:false,showSelectionCheckBoxesFlag:true,sortModel:[{dataIndex:"tree",sort:"asc"}],onContextualEvent:function(){return[]}}).inject(p);this._dataGridViewPossibleValues.buildStatusBar([{type:i.STATUS.NB_SELECTED_ROWS}]);this.refreshContentView()},clearFilterViewContent:function(){this._treeDocumentPossibleValues.getRoots().forEach(function m(n){n.select()})},refreshContentView:function(){if(this.filter&&this.elements._popup){g.call(this);d.call(this);this._dataGridViewPossibleValues._applySortModel()}},buildFilterModelFromView:function(){if(!this._dataGridViewPossibleValues){return this.filter&&this.filter.filterModel}var m=[];this._treeDocumentPossibleValues.getRoots().forEach(function n(o){if(o.isSelected()){var p=o.options.attributeName;if(p===undefined||p===null||p===""){m.push(undefined,null,"")}else{m.push(p)}}});return m}});return b});define("DS/DataGridView/DataGridViewStringRegExpFilterView",["DS/Core/BaseComponent","DS/Core/PointerEvents","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/ButtonGroup","i18n!DS/DataGridView/assets/nls/translation"],function(c,d,e,i,b,f,a,h){var g=e.inherit({name:"datagridviewstringregexpfilterview",publishedProperties:{},_build:function(){this._parent();this._firstConditionContainer=null;this._firstConditionChooser=null;this._firstConditionEditor=null;this._operatorChooser=null;this._secondConditionContainer=null;this._secondConditionChooser=null;this._secondConditionEditor=null},buildContentView:function(){var j=this._popupContentDiv;if(!j){return}j.addClassName("wux-layout-datagridview-filterview-stringregexp");var n=function(){var o={container:null,chooser:null,editor:null};o.container=new UWA.Element("div");o.container.addClassName("wux-layouts-datagridview-base-filter-condition");o.chooser=new i({enableSearchFlag:false,elementsList:[{labelItem:h.FilterView.StringRegExp.StartsWith,valueItem:"startsWith"},{labelItem:h.FilterView.StringRegExp.EndsWith,valueItem:"endsWith"},{labelItem:h.FilterView.StringRegExp.Contains,valueItem:"contains"}]}).inject(o.container);o.editor=new b().inject(o.container);return o};var k=n();this._firstConditionContainer=k.container;this._firstConditionChooser=k.chooser;this._firstConditionEditor=k.editor;this._firstConditionContainer.inject(j);var l=this;this._firstConditionEditor.addEventListener("uncommittedChange",function m(p){if(l._firstConditionEditor.valueToCommit===""){if(l._operatorChooser){l._operatorChooser.remove()}if(l._secondConditionContainer){l._secondConditionContainer.remove()}}else{if(!l._operatorChooser){l._operatorChooser=new a();l._operatorChooser.getContent().addClassName("wux-layouts-datagridview-base-filter-operator");l._operatorChooser.addChild(new f({type:"radio",label:h.FilterView.StringRegExp.AND,value:"and"}));l._operatorChooser.addChild(new f({type:"radio",label:h.FilterView.StringRegExp.OR,value:"or"}));l._operatorChooser.value=["and"]}l._operatorChooser.inject(j);if(!l._secondConditionContainer){var o=n();l._secondConditionContainer=o.container;l._secondConditionChooser=o.chooser;l._secondConditionEditor=o.editor}l._secondConditionContainer.inject(j)}});this.refreshContentView()},clearFilterViewContent:function(){if(this._firstConditionContainer){this._firstConditionChooser.selectedIndex=0;this._firstConditionEditor.value=""}if(this._operatorChooser){this._operatorChooser.value=["and"]}if(this._secondConditionContainer){this._secondConditionChooser.selectedIndex=0;this._secondConditionEditor.value=""}},refreshContentView:function(){if(this.filter&&this.elements._popup){var j=this.filter.filterModel;if(!j){this.clearFilterViewContent();return}if(this._firstConditionContainer&&j.condition1){this._firstConditionChooser.value=j.condition1.type;this._firstConditionEditor.value=j.condition1.filter}if(this._operatorChooser&&j.operator){this._operatorChooser.value=j.operator}if(this._secondConditionContainer&&j.condition2){this._secondConditionChooser.value=j.condition2.type;this._secondConditionEditor.value=j.condition2.filter}}},buildFilterModelFromView:function(){if(!this._firstConditionContainer){return this.filter&&this.filter.filterModel}if(this._firstConditionEditor.value===""){return{}}var j={condition1:{type:this._firstConditionChooser.value,filter:this._firstConditionEditor.value}};if(this._secondConditionContainer&&this._secondConditionEditor.value!==""){j.operator=this._operatorChooser.value[0];j.condition2={type:this._secondConditionChooser.value,filter:this._secondConditionEditor.value}}return j}});return g});define("DS/DataGridView/DataGridViewFilterViewManager",["DS/Core/BaseComponent","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewSetFilterView"],function(a,e,b){var c=function(i,h){var g=0;var f=this._listOfFilterViews[i];if(!h){if(f){f.destroy();this._listOfFilterViews[i]=undefined;delete this._listOfFilterViews[i]}return 0}if(f!==undefined){if(f.filterId===h.filterId){f.refreshView();return 3}f.destroy();this._listOfFilterViews[i]=undefined;delete this._listOfFilterViews[i];g=1}var j=this.FILTERVIEWS_MAP[h.filterId];if(!j){console.log("No filter view has been registered for id ",h.filterId);return 0}this._listOfFilterViews[i]=new j({filterViewManager:this,propertyId:i,filterId:h.filterId,filter:h});return 1+g};var d=a.inherit({name:"datagridviewfilterviewmanager",publishedProperties:{view:{defaultValue:undefined,type:"object",readOnly:true},filterManager:{defaultValue:undefined,type:"object"}},registerFilterView:function(g,f){this.FILTERVIEWS_MAP[g]=f},refreshFilterViews:function(){if(!this.filterManager){return}var h=this;var f=Object.keys(this._listOfFilterViews);var g=this.filterManager.getFilters();var i=Object.keys(g);i.forEach(function(j){c.call(h,j,g[j]);var k=f.indexOf(j);if(k!==-1){f.splice(k,1)}});f.forEach(function(j){h._listOfFilterViews[j].destroy();delete h._listOfFilterViews[j]})},getFilterViews:function(){return this._listOfFilterViews},isEmpty:function(){var f=this;return Object.keys(this._listOfFilterViews).every(function(g){return !f._listOfFilterViews[g].filter||f._listOfFilterViews[g].filter.isEmpty()})},disableUpdateView:function(){this._preventUpdateView++},enableUpdateView:function(){this._preventUpdateView--},_build:function(){this.FILTERVIEWS_MAP={stringRegexp:e,set:b,numberComparator:null};this._listOfFilterViews={};this._onFilterModelChangeToken=undefined;this._preventUpdateView=0},_applyFilterManager:function(g){if(this._onFilterModelChangeToken&&g){g.unsubscribe(this._onFilterModelChangeToken)}if(this.filterManager){var h=this;this._onFilterModelChangeToken=this.filterManager.subscribe("filterModelChange",function f(i){if(h._preventUpdateView>0){return}if(i){c.call(h,i.propertyId,i.filter)}else{h.refreshFilterViews()}});this.refreshFilterViews()}},_applyProperties:function(f){this._parent(f);if(this.isDirty("filterManager")){this._applyFilterManager(f.filterManager)}}});return d});define("DS/DataGridView/DataGridViewColumnHeaderCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom"],function(f,d,e,c,a){var b=e.inherit({name:"DataGridViewColumnHeaderCell",publishedProperties:{},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-column-header-cell")},buildView:function(){this.elements.tweakerContainer=new f.Element("div",{"class":"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container);this.elements.iconsContainer=new f.Element("div",{"class":"wux-layouts-datagridview-column-header-icons"}).inject(this.elements.container)},_getContentContainer:function(){return this.elements.tweakerContainer},});return b});define("DS/DataGridView/DataGridViewTreeNodeCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom","DS/Core/PointerEvents"],function(c,e,i,f,a,d){var b={};function h(j){return j.charAt(0).toUpperCase()+j.slice(1)}var g=i.inherit({name:"DataGridViewTreeNodeCell",publishedProperties:{nodeModel:{defaultValue:null,type:"object",category:"Model"},readOnly:{defaultValue:true,type:"boolean",category:"Model"},height:{defaultValue:38,type:"integer",category:"Appearance"},buildLinks:{defaultValue:true,type:"boolean",category:"Appearance"},showIconsFlag:{defaultValue:true,type:"boolean"},flatTreeFlag:{defaultValue:false,type:"boolean"}},_applyNodeModel:function(j){var k=this.nodeModel;if(k){this.__applyExpanderState(k.getState());this.__applyDepth(k.getNodeDepth());this.__applyIcons(k.getIcons())}},_applyReadOnly:function(j){if(this._reusableContent){this._reusableContent.readOnly=this.readOnly}},_applyHeight:function(j){this.elements.container.style.height=this.height+"px"},_applyShowIconsFlag:function(j){if(this.showIconsFlag){this.elements.iconsContainer.show()}else{this.elements.iconsContainer.hide()}},_applyFlatTreeFlag:function(j){if(!this.isDirty("nodeModel")&&this.nodeModel){this.__applyDepth(this.nodeModel.getNodeDepth())}if(this.flatTreeFlag){this.elements.expanderContainer.hide()}else{this.elements.expanderContainer.show()}},_applyProperties:function(j){if(this.isDirty("nodeModel")){this._applyNodeModel(this.nodeModel)}if(this.isDirty("readOnly")){this._applyReadOnly(j.readOnly)}if(this.isDirty("height")){this._applyHeight(this.height)}if(this.isDirty("showIconsFlag")){this._applyShowIconsFlag(j.showIconsFlag)}if(this.isDirty("flatTreeFlag")){this._applyFlatTreeFlag(j.flatTreeFlag)}this._parent(j)},_preBuildView:function(){this._parent();this.getContent().classList.add("wux-layouts-datagridview-tree-node-cell");this.getContent().classList.add("wux-tree-treelistview")},buildView:function(){this.elements.linksContainer=new c.Element("div",{"class":"wux-layouts-treeview-links"}).inject(this.elements.container);this.elements.expanderContainer=new c.Element("div",{"class":"wux-layouts-treeview-expander"}).inject(this.elements.container);this.elements.iconsContainer=new c.Element("div",{"class":"wux-layouts-treeview-icons"});this.elements.iconsContainer.hide();this.elements.iconsContainer.inject(this.elements.container);this.elements.tweakerContainer=new c.Element("div",{"class":"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container);this.__observeEvents()},_getContentContainer:function(){return this.elements.tweakerContainer},__observeEvents:function(){var l=this.nodeModel;var k=this;this.elements.expanderContainer.addEvent(d.POINTERHIT,function(n){n.stopPropagation()});this.elements.expanderContainer.addEvent(d.POINTERDOWN,function(n){n.stopPropagation()});function j(n){if(n.type==="touchend"){n.preventDefault()}if(n.which===1||n.type==="touchend"){if(k.nodeModel.getChildren()){if(k.nodeModel._expandState!=="noExpandState"&&k.nodeModel._expandState!=="expandingState"){if(k.nodeModel.isExpanded()&&k.nodeModel._expandState!=="partiallyExpandedState"){k.nodeModel.collapse()}else{k.__applyExpanderState("expandingState");k.nodeModel.expand()}}}}}this.elements.expanderContainer.addEvent(d.POINTERUP,j);var m=function(n){n.stopPropagation();n.preventDefault()};this.elements.expanderContainer.addEventListener("contextmenu",m);this.elements.expanderContainer.addEventListener(d.LONGHOLD,m)},__applyDepth:function(u){var y=this.nodeModel;var k=this.elements;if(u===undefined){u=y.getParents().length}var n=this.flatTreeFlag?0:(this._getCurrentTouchMode()?25:18);var x=25;this.elements.linksContainer.setStyle("margin-left",n);var l=x*u;if(this.buildLinks){var m=y.isLastChild();var s='" data-islastchild="'+(m?"true":"false");var v=y.getParent();var w=v&&v.isLastChild();var z=[y];for(var r=1;r<u;r++){var o=z[0];z.unshift(o?o.getParent():undefined)}var t,p,A;var q="<span>";for(t=0;t<u;t++){p=((t<=u-2)&&(z[t]&&z[t].isLastChild()))?"border-color:transparent":"";A=((t===u-1)&&m)?"50%":"100%";q=q+'<li class="wux-layouts-treeview-link" data-parentislastchild="'+((w&&t<=u-1)?"true":"false")+s+'" data-depth="'+(t+"/"+(u-1))+'" style="'+p+";height: "+A+";margin-right:"+(((t===u-1)?0:x)-1)+"px;margin-left:"+(t===0?x:0)+'px"></li>'}q=q+"</span>";k.linksContainer.innerHTML=u>0?q:""}k.linksContainer.setStyle("width",l);this._nodeOffsetX=l+n+2;k.container.setAttribute("data-node-depth",u)},__applyExpanderState:function(j){if(j){this.elements.expanderContainer.setAttribute("data-wux-state",j)}},__applyLabel:function(j){if(typeof j==="number"){j=j.toString()}if(this._reusableContent){this._reusableContent.disableEvents();this._reusableContent.value=j;this._reusableContent.enableEvents()}},__applyIcons:function(l){var m=this;if(l){if(l instanceof Array){if(l){var j=c.equals(this._icons,l);if(!j){this._icons=c.clone(l);this.elements.iconsContainer.removeAttribute("wux-icon-name");this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}});if(l){var k=document.createDocumentFragment();l.forEach(function(o,n){var p=m.__buildIcon(o);k.appendChild(p)});this.elements.iconsContainer.appendChild(k)}}}}if(typeof l==="string"){if(this.elements.iconsContainer.getChildren()){this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}})}m.__addIcon(l,"css")}}else{this.elements.iconsContainer.removeAttribute("wux-icon-name");this.elements.iconsContainer.getChildren().forEach(function(n){if(n.hasClassName("wux-layouts-treeview-icon")){n.remove()}})}},__addIcon:function(k,j){var l=this.__buildIcon(k,j);l.inject(this.elements.iconsContainer)},__buildIcon:function(k,j){var l=a.createElement("div",{"class":"wux-layouts-treeview-icon"});switch(j){case"css":l.setAttribute("icon-type","css");l.setAttribute("wux-icon-name",k);break;default:if(typeof k==="string"){l.setAttribute("icon-type","css");l.style.backgroundImage="url("+k+")"}else{l.setAttribute("icon-type","fonticon");l.appendChild(a.generateIcon(k))}break}return l},computeContentSize:function(){var n=this.elements.iconsContainer.offsetWidth;var k=this.getNodeLeftMargin();var l=this._getCurrentTouchMode()?14:7;var j=this._nodeOffsetX+n+k+l;var m=this._getReusableContent();if(m&&m.computeContentSize){j+=m.computeContentSize()}return Math.ceil(j)},getFontSize:function(){var j=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(j)},getFontFamily:function(){return"arial"},getNodeLeftMargin:function(){var k=window.getComputedStyle(this.elements.linksContainer,null).getPropertyValue("margin-left");var j=parseFloat(k);return(j&&!isNaN(j))?j:0}});return g});define("DS/DataGridView/RowModelClientSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewFilterViewManager",],function(c,a,d){var b=c.inherit({name:"RowModelClientSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},treeDocument:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},},_applyProperties:function(e){this._parent(e);if(this.isDirty("treeDocument")){this._applyTreeDocument(e.treeDocument)}if(this.isDirty("sortModel")){this._applySortModel(e.sortModel)}},getFilterViewManager:function(){if(!this._filterViewManager){this._filterViewManager=new d({view:this})}return this._filterViewManager},_getTreeDocument:function(){return this.treeDocument},getVisibleNodeModel:function(f){var e=this.dataGridView;return e.model[f]},_isModelBeingFetched:function(){return false},_applyTreeDocument:function(h){if(!this.treeDocument){return}this._listenToTreeDocument();var j=this;var g=this.dataGridView;var e=this.treeDocument.getFilterManager();if(e){if(!this._filterViewManager){this._filterViewManager=new d({view:this.dataGridView,filterManager:e})}else{this._filterViewManager.filterManager=e}}var i=true;var f=function(){j._mustRedrawColumnHeaders=true;var k=j.getFilterViewManager();if(k.isEmpty()){if(!i){g.enableRowReordering()}i=true}else{if(i){g.disableRowReordering()}i=false}};j.treeDocument.addModelEventListener("filter",f)},_applySortModel:function(e){var q=this.dataGridView;var n=this;if(!q._isCurrentlyCalledFromUIInteraction()){n._originalSortModel=n.sortModel}if(!n.sortModel){return}if(n.sortModel.length>0&&(!e||e.length===0)){q.disableRowReordering()}else{if(n.sortModel.length===0&&e&&e.length>0){q.enableRowReordering()}}if(n.sortModel.length>0){var g=n.treeDocument;if(g){var l=q.layout;var j=[];for(var h=0;h<n.sortModel.length;h++){var m=n.sortModel[h].dataIndex;var k=l.getColumnIndex(m);if(k>-1){var f=l.getColumnCompareFunction(k);if(!f){if(!f){f=function(s,r,u,t,i){if(s===r){return 0}else{if(s>r){return 1}else{if(s<r){return -1}else{if((s===undefined)&&(r!==undefined)){return 2}else{return -2}}}}}}}var o=(n.sortModel[h].sort==="desc")?-1:1;j.push({dataIndex:m,compareFunction:f,reverseFactor:o})}q._updateRenderedRowCellsAttributes(-1)}var p=function(x,w){var r=0;var s=0;while((s<j.length)&&(r===0)){var u=j[s];var v=q._getCellValueForSort(x,u.dataIndex);var t=q._getCellValueForSort(w,u.dataIndex);r=u.reverseFactor*u.compareFunction(v,t,x,w,u.dataIndex);s++}if(r===0){return(x._getID()-w._getID())}return r};g._getTrueRoot().sortChildren({isRecursive:true,sortFunction:p})}}},_doGroupingOnModel:function(h){var i=this;var g=i.treeDocument;var e=this.dataGridView;var f=function(){g.prepareUpdate();var k={propertiesToGroup:h.dataIndexesToGroup};var j=e.rowGroupingOptions.depth;if(j===0){g.groupRoots(k)}else{var l=function(n,o){if(o>=j){n.groupChildren(k);return}var m=n.getChildren();if(m){m.forEach(function(p){l(p,o+1)})}};l(g._getTrueRoot(),0)}i._applySortModel();g.pushUpdate();e.removeModalLoader("Updating Grouping...")};e.displayModalLoader("Updating Grouping...",f)},});return b});define("DS/DataGridView/DataGridView",["UWA/Core","UWA/Utils/Client","DS/CollectionView/CollectionView","DS/DataGridView/DataGridViewLayout","DS/DataGridView/RowModelClientSide","DS/DataGridView/RowModelServerSide","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tweakers/TypeRepresentationFactory","DS/DataGridView/DataGridViewRow","DS/DataGridView/DataGridViewCell","DS/DataGridView/DataGridViewColumnHeaderCell","DS/DataGridView/DataGridViewRowHeaderCell","DS/DataGridView/DataGridViewTreeNodeCell","DS/Utilities/Dom","DS/Utilities/Utils","DS/Menu/ContextualMenu","DS/DataGridView/DataGridViewContextualMenuBuilder","DS/Controls/SelectionChips","DS/Tweakers/GeneratedToolbar","DS/CollectionView/edition/CollectionViewEditionOnDoubleClick","DS/CollectionView/edition/CollectionViewEditionOnClick","DS/CollectionView/edition/CollectionViewEditionOnOver","DS/CollectionView/edition/CollectionViewEditionInPlace","DS/Utilities/TouchUtils","DS/Controls/ModalContainer","DS/Controls/Loader","UWA/Class/Promise","i18n!DS/DataGridView/assets/nls/translation","i18n!DS/Controls/assets/nls/translation","DS/DataGridView/DataGridViewFilterViewManager","DS/Utilities/TreeUtils","DS/DataGridView/ModelMassUpdateDialog"],function(e,C,I,ab,h,i,l,K,D,w,U,O,a,p,E,H,Q,r,n,t,W,q,N,B,g,G,M,aa,A,m,L,o,Y,v){var ae=false;var R="wux-ui-state-drag-over";var d=C.Engine;var k;var j=4;var z=false;var b=false;var y,X;function Z(al,ak){var ak=ak||al.target||al.srcElement,aj=ak.getBoundingClientRect(),ai=(al.clientX)?al.clientX-aj.left:0,am=(al.clientY)?al.clientY-aj.top:0;return{offsetX:ai,offsetY:am}}function ac(ak,ai){if(window.notifs){var aj={level:"info",title:m[ak],message:m[ai],sticky:false};window.notifs.addNotif(aj)}}function ad(aj){if(aj[aj.length-1]==="\n"){aj=aj.slice(0,aj.length-2)}var ak=aj.split("\n");for(var ai=0;ai<ak.length;ai++){ak[ai]=ak[ai].split("\t")}return ak}function V(aj){var ai=undefined;if(typeof aj.cellModel==="object"){if(aj.cellModel instanceof Date){ai=aj.cellModel.toLocaleDateString()}else{ai=JSON.stringify(aj.cellModel)}}else{if(typeof aj.cellModel==="string"){ai=aj.cellModel}else{if(aj.cellModel!==undefined){ai=aj.cellModel.toString()}}}if(this.layout.getColumnAllowUnsafeHTMLContent(aj.columnID)){var ak=e.createElement("div");ak.innerHTML=ai;ai=ak.innerText}return ai}function T(ak,ai){var aj=undefined;if(typeof ak.cellModel==="object"){if(ak.cellModel instanceof Date){aj=new Date(ai)}else{aj=JSON.parse(ai)}}else{aj=ai}return aj}function af(ak,ai){var aj;if(ai==="tree"){aj=ak.options.label}else{aj=ak.options.grid[ai]}return aj}function J(ak,ai,al,aj){if(!this._rowReorderDnDInfos.elements.line){this._rowReorderDnDInfos.elements.line=new e.Element("div",{"class":"wux-datagridview-drag-row-feedback",styles:{top:ak,height:ai,background:aj?"#368ec4":"#844138"}});this._rowReorderDnDInfos.elements.chip=new e.Element("div",{"class":"wux-datagridview-drag-row-feedback-chip",styles:{display:(ai>2||al===-1)?"none":"block",left:al,background:aj?"#368ec4":"#844138"}}).inject(this._rowReorderDnDInfos.elements.line);this._rowReorderDnDInfos.elements.line.inject(this.getContent())}else{this._rowReorderDnDInfos.elements.line.setStyles({display:"block",top:ak,height:ai,background:aj?"#368ec4":"#844138"});this._rowReorderDnDInfos.elements.chip.setStyles({display:(ai>2||al===-1)?"none":"block",left:al,background:aj?"#368ec4":"#844138"})}}function u(){if(this._rowReorderDnDInfos.elements.line){this._rowReorderDnDInfos.elements.line.hide()}}function c(ar,av){var ai=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!ai){return false}var an=0,at=0;var au=av.cellView.getContent().getBoundingClientRect();if(av.nodeModel.acceptNodeDropAt(ai.node,0)){an=au.top+au.height/3;at=au.top+2*au.height/3}else{an=at=au.top+au.height/2}var ao=0;var aw=0;var ak=0;if(ar.clientY<an){this._rowReorderDnDInfos.direction=-1;aw=2;ak=this.layout.getRowPosition(av.rowID)}else{if(ar.clientY>=at){this._rowReorderDnDInfos.direction=1;aw=2;if(av.rowID<this.model.length-1){ak=this.layout.getRowPosition(av.rowID+1)}else{ak=this.layout.getRowPosition(av.rowID)+au.height}}else{this._rowReorderDnDInfos.direction=0;aw=au.height;ak=this.layout.getRowPosition(av.rowID)}}ao=this.layout.getHeaderContainerHeight()+ak-this.getScrollerPosition().y;var am=this.layout.getColumnIndex("tree");var aj=-1;if(am!==undefined){var al=this.layout.getCellIDFromCoordinates({rowID:av.rowID,columnID:am});var aq=this._getViewAt(al);if(aq){var ap=aq.elements.linksContainer.getBoundingClientRect();aj=ap.right}}this._rowReorderDnDInfos.dropAccepted=av.nodeModel.acceptNodeDropAt(ai.node,this._rowReorderDnDInfos.direction);J.call(this,ao,aw,aj,this._rowReorderDnDInfos.dropAccepted);return this._rowReorderDnDInfos.dropAccepted}function s(aq,ar){var ak=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!ak||ak.source!==this._uuid){return false}var am=this.getDraggedRowData(aq);if(am&&am.rowID!==ar.rowID){var av=-1;var at="";if(this._rowReorderDnDInfos.dropAccepted){var an=ar.nodeModel.getTreeDocument();an.prepareUpdate();this.prepareUpdateView();var ai=an.getUseChangeTransactionMode();an.setUseChangeTransactionMode(false);var au=null;var ap=undefined;if(this._rowReorderDnDInfos.direction!==0){au=ar.nodeModel.getParent();var ao=ar.nodeModel._getLocalID();var al=ar.nodeModel._getRowID();ap=ao+(this._rowReorderDnDInfos.direction===1?1:0)+(au===ak.node.getParent()&&am.rowID<al?-1:0)}else{au=ar.nodeModel}var aj=ak.node;au.moveChild(aj,ap);if(au.getChildren().length===1){au.expand();an.pushUpdate();av=aj._getRowID()}else{an.pushUpdate();if(au.isExpanded()||au._isTrueRoot()){av=aj._getRowID()}else{av=au._getRowID()}}this.pushUpdateView({updateCellContent:true,updateCellLayout:true,updateCellAttributes:true},true);at="ui-modified";an.setUseChangeTransactionMode(ai)}else{av=am.rowID;at="ui-notmodified"}this._flashEffectOnRow(at,av)}return true}function P(ak,ai){var am={},al={},aj;aj=ai.offsetParent;am.x=ak.touches?ak.touches[0].pageX:ak.pageX;am.y=ak.touches?ak.touches[0].pageY:ak.pageY;al.left=ai.offsetLeft;al.top=ai.offsetTop;while(aj){al.left+=aj.offsetLeft;al.top+=aj.offsetTop;aj=aj.offsetParent}return{x:am.x-al.left,y:am.y-al.top}}function ag(ak){var aj=this;var ai={x:ak.x,y:ak.y};this._autoScrollInfos.interval=setInterval(function(){ai.x+=aj._autoScrollInfos.moveX;ai.y+=aj._autoScrollInfos.moveY;aj.setScrollerPosition(ai)},20)}function x(){if(this._autoScrollInfos.interval!==null){clearInterval(this._autoScrollInfos.interval);this._autoScrollInfos.interval=null}}function F(ak){var am=this._getScroller().getContent();var aj=P(ak,am);var al=this.getScrollerPosition();this._autoScrollInfos.moveY=0;if(aj.x>=-this._leftContainerWidth&&aj.x<=am.clientWidth+this._rightContainerWidth&&aj.y>=0&&aj.y<=am.clientHeight){var ai=50;if(aj.y<ai&&al.y!==0){this._autoScrollInfos.moveY=aj.y-ai}else{if(am.clientHeight-ai<aj.y&&am.clientHeight+al.y!==am.scrollHeight){this._autoScrollInfos.moveY=aj.y-(am.clientHeight-ai)}}}if(this._autoScrollInfos.moveY!==0&&this._autoScrollInfos.interval===null){ag.call(this,al)}else{if(this._autoScrollInfos.moveY===0){x.call(this)}}return this._autoScrollInfos.moveY!==0}var S=new w();var ah=I.inherit({name:"dataGridView",publishedProperties:{identifier:{defaultValue:"",type:"string",readOnly:true,category:"Behavior"},treeDocument:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},cellSelection:{defaultValue:"multiple",type:"string"},defaultColumnDef:{defaultValue:{description:"",typeRepresentation:"string",getCellTypeRepresentation:function(aj){var ai=this.layout;if(ai){return ai.getColumnTypeRepresentation(aj.columnID)}return"string"},width:"auto",minWidth:40,autoRowHeightFlag:false,visibleFlag:true,editableFlag:false,editionPolicy:"EditionOnDoubleClick",resizableFlag:true,sortableFlag:true,groupableFlag:true,pinned:"unpinned",autoSizePadding:0,allowUnsafeHTMLContent:false,shouldCellAllowUnsafeHTMLContentAt:function(aj){var ai=this.layout;if(ai){return ai.getColumnAllowUnsafeHTMLContent(aj.columnID)}return false},allowResetToUndefinedByUIFlag:false},type:"object"},columns:{defaultValue:[],type:"array"},sortModel:{defaultValue:null,type:"array"},layout:{defaultValue:null,type:"object"},cellClass:{defaultValue:O,type:"object"},rowGroupingOptions:{defaultValue:{depth:0,hideGroupedColumns:true},type:"object"},onContextualEvent:{defaultValue:function f(aj){var ai=[];if(aj&&aj.collectionView){ai=aj.collectionView.buildDefaultContextualMenu(aj)}return ai},type:"function"},rowReorderEnabledFlag:{defaultValue:true,type:"boolean",noNeedToApplyFlag:true},columnDragEnabledFlag:{defaultValue:true,type:"boolean"},onDragStartColumnHeader:{defaultValue:undefined,type:"function"},onDragEndColumnHeader:{defaultValue:undefined,type:"function"},onDragEnterColumnHeader:{defaultValue:undefined,type:"function"},onDragLeaveColumnHeader:{defaultValue:undefined,type:"function"},onDragColumnHeader:{defaultValue:undefined,type:"function"},onDragOverColumnHeader:{defaultValue:undefined,type:"function"},onDropColumnHeader:{defaultValue:undefined,type:"function"},rowDragEnabledFlag:{defaultValue:false,type:"boolean"},onDragStartRowHeader:{defaultValue:undefined,type:"function"},onDragEndRowHeader:{defaultValue:undefined,type:"function"},onDragEnterRowHeader:{defaultValue:undefined,type:"function"},onDragLeaveRowHeader:{defaultValue:undefined,type:"function"},onDragRowHeader:{defaultValue:undefined,type:"function"},onDragOverRowHeader:{defaultValue:undefined,type:"function"},onDropRowHeader:{defaultValue:undefined,type:"function"},cellDragEnabledFlag:{defaultValue:false,type:"boolean"},onDragStartCell:{defaultValue:undefined,type:"function"},onDragEndCell:{defaultValue:undefined,type:"function"},onDragEnterCell:{defaultValue:undefined,type:"function"},onDragLeaveCell:{defaultValue:undefined,type:"function"},onDragCell:{defaultValue:undefined,type:"function"},onDragOverCell:{defaultValue:undefined,type:"function"},onDropCell:{defaultValue:undefined,type:"function"},onDragStartBlank:{defaultValue:undefined,type:"function"},onDragEndBlank:{defaultValue:undefined,type:"function"},onDragEnterBlank:{defaultValue:undefined,type:"function"},onDragLeaveBlank:{defaultValue:undefined,type:"function"},onDragBlank:{defaultValue:undefined,type:"function"},onDragOverBlank:{defaultValue:undefined,type:"function"},onDropBlank:{defaultValue:undefined,type:"function"},focusNextEditableCellOnTabFlag:{defaultValue:false,type:"boolean",noNeedToApplyFlag:true},showCellActivationFlag:{defaultValue:true,type:"boolean"},showCellPreselectionFlag:{defaultValue:true,type:"boolean"},showEditableFeedbackFlag:{defaultValue:true,type:"boolean"},showRequiredFeedbackFlag:{defaultValue:true,type:"boolean"},showRowBorderFlag:{defaultValue:false,type:"boolean"},showModelChangesFlag:{defaultValue:false,type:"boolean"},showAlternateBackgroundFlag:{defaultValue:true,type:"boolean"},showRowIndexFlag:{defaultValue:true,type:"boolean"},showSelectionCheckBoxesFlag:{defaultValue:"OnOver",type:"string"},showRowHeaderBackgroundFlag:{defaultValue:true,type:"boolean"},showTreeIconsFlag:{defaultValue:true,type:"boolean"},showNodeKPIColorFlag:{defaultValue:false,type:"boolean"},placeholder:{defaultValue:m.NoObjectsFound,type:"string"},getCellTooltip:{defaultValue:null,type:"function",noNeedToApplyFlag:false}},handleEvents:function(){var ai=this;ai._parent();H.addEventOnElement(this,document,"touchChange",function(){if(G.getTouchMode()){ai._previousShowSelectionCheckBoxesFlag=ai.showSelectionCheckBoxesFlag;ai._previousShowRowIndexFlag=ai.showRowIndexFlag;ai.showSelectionCheckBoxesFlag=true;ai.showRowIndexFlag=true}else{if(ai._previousShowSelectionCheckBoxesFlag!==undefined){ai.showSelectionCheckBoxesFlag=ai._previousShowSelectionCheckBoxesFlag}if(ai._previousShowRowIndexFlag!==undefined){ai.showRowIndexFlag=ai._previousShowRowIndexFlag}}})},_preBuild:function(){this._editionManagers=[];this._useClipboardFlag=true;this._properties.layout.value=new ab();this._contextualMenuBuilder=new n(this);this._selectAllCheckBoxListenChange=true;this._hasFlatTreeState=true;this._tweakerToGenerateCount=0;this._inOnAllCellsRendered=false;this._resetRowHeightsOnAllCellsRenderedFlag=false;this._modelMassUpdateDialog=null;this._parent();this.getContent().classList.add("wux-layouts-datagridview");this.elements.rowHeaderExtension=new e.Element("div",{"class":"wux-datagridview-layouts-row-header-extension"}).inject(this.elements.container);this._rowReorderDnDInfos={elements:{line:null,chip:null},direction:-1,dropAccepted:false};this._disableRowReorderCpt=0;this._autoScrollInfos={interval:null,moveX:0,moveY:0}},_applyProperties:function(ai){this._parent(ai);if(this.isDirty("dataSource")){this._applyDataSource(ai.dataSource)}if(this.isDirty("treeDocument")){this._applyTreeDocument(ai.treeDocument)}if(this.isDirty("defaultColumnDef")){this._applyDefaultColumnDef(ai.defaultColumnDef)}if(this.isDirty("layout")){this._applyLayout(ai.layout)}if(this.isDirty("columns")){this._applyColumns(ai.columns)}if(this.isDirty("sortModel")){this._applySortModel(ai.sortModel)}if(this.isDirty("columnDragEnabledFlag")){this._applyColumnDragEnabledFlag(ai.columnDragEnabledFlag)}if(this.isDirty("rowDragEnabledFlag")){this._applyRowDragEnabledFlag(ai.rowDragEnabledFlag)}if(this.isDirty("cellDragEnabledFlag")){this._applyCellDragEnabledFlag(ai.cellDragEnabledFlag)}if(this.isDirty("showCellActivationFlag")){this._applyShowCellActivationFlag(ai.showCellActivationFlag)}if(this.isDirty("showCellPreselectionFlag")){this._applyShowCellPreselectionFlag(ai.showCellPreselectionFlag)}if(this.isDirty("showEditableFeedbackFlag")){this._applyShowEditableFeedbackFlag(ai.showEditableFeedbackFlag)}if(this.isDirty("showRequiredFeedbackFlag")){this._applyShowRequiredFeedbackFlag(ai.showRequiredFeedbackFlag)}if(this.isDirty("showRowBorderFlag")){this._applyShowRowBorderFlag(ai.showRowBorderFlag)}if(this.isDirty("showAlternateBackgroundFlag")){this._applyShowAlternateBackgroundFlag(ai.showAlternateBackgroundFlag)}if(this.isDirty("showRowIndexFlag")){this._applyShowRowIndexFlag(ai.showRowIndexFlag)}if(this.isDirty("showSelectionCheckBoxesFlag")){this._applyShowSelectionCheckBoxesFlag(ai.showSelectionCheckBoxesFlag)}if(this.isDirty("showRowHeaderBackgroundFlag")){this._applyShowRowHeaderBackgroundFlag(ai.showRowHeaderBackgroundFlag)}if(this.isDirty("showTreeIconsFlag")){this._applyShowTreeIconsFlag(ai.showTreeIconsFlag)}if(this.isDirty("showNodeKPIColorFlag")){this._applyShowNodeKPIColorFlag(ai.showNodeKPIColorFlag)}if(this.isDirty("rowGroupingOptions")){this._applyRowGroupingOptions(ai.rowGroupingOptions)}},_applyTouchMode:function(){this._parent();if(this.touchMode){j=8}else{j=4}},_applyVirtualViewportSize:function(){this._parent();var ai=this.getStatusBarContainerHeight();this.elements.rowHeaderExtension.setStyle("bottom",ai+"px");var ak=this.layout.getLeftContainerWidth();if(ak===0){this.layout.collectionView.elements.leftScrollContainer.setAttribute("empty","");this.layout.collectionView.elements.leftHeaderPoolContainer.setAttribute("empty","");this.layout.collectionView.elements.leftSpacerContainer.setAttribute("empty","")}else{this.layout.collectionView.elements.leftScrollContainer.removeAttribute("empty");this.layout.collectionView.elements.leftHeaderPoolContainer.removeAttribute("empty","");this.layout.collectionView.elements.leftSpacerContainer.removeAttribute("empty","")}var aj=this.layout.getRightContainerWidth();if(aj===0){this.layout.collectionView.elements.rightScrollContainer.setAttribute("empty","");this.layout.collectionView.elements.rightHeaderPoolContainer.setAttribute("empty","");this.layout.collectionView.elements.rightSpacerContainer.setAttribute("empty","")}else{this.layout.collectionView.elements.rightScrollContainer.removeAttribute("empty");this.layout.collectionView.elements.rightHeaderPoolContainer.removeAttribute("empty","");this.layout.collectionView.elements.rightSpacerContainer.removeAttribute("empty","")}},_applyModel:function(ai){this._parent(ai);if(this.layout){this.layout.resetRowHeights()}var aj=this._activeCellStableID;this._updateXSOElements();this._updateActiveCell(aj)},_applyHeight:function(){this._parent();if(this.height!=="inherit"){if(!this.elements.container.style.position||this.elements.container.style.position==="static"){this.elements.container.style.position="relative"}}},_flashEffectOnCell:function(aj,ai){if(!ai){return}ai.getContent().classList.add(aj);ai.getContent().addEventListener("animationend",function(ak){ak.target.classList.remove(aj)})},_flashEffectOnRow:function(ao,ak){var al=this.layout;var am=al.getLeafColumns();var ai=am.length;var an=al._leftPinnedRowcolumnID;for(var aj=an;aj<ai;aj++){this._flashEffectOnCell(ao,this._getViewAt(al.getCellIDFromCoordinates({rowID:ak,columnID:aj})))}},getFilterViewManager:function(){if(this._rowModel){return this._rowModel.getFilterViewManager()}return undefined},_applyDataSource:function(ai){if(this.dataSource&&this._isReady){if(this._rowModel===undefined){this._rowModel=new i({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions})}this._rowModel.dataSource=this.dataSource}},_applyTreeDocument:function(ai){if(this.treeDocument){if(this._rowModel===undefined){this._rowModel=new h({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,treeDocument:this.treeDocument})}else{this._rowModel.treeDocument=this.treeDocument}}},hasFlatTreeState:function(){return this._hasFlatTreeState},_applyDefaultColumnDef:function(ai){var aj=this.defaultColumnDef;if(aj.description===undefined){aj.description=""}if(aj.typeRepresentation===undefined){aj.typeRepresentation="string"}if(aj.getCellTypeRepresentation===undefined){aj.getCellTypeRepresentation=function(al){var ak=this.layout;if(ak){return ak.getColumnTypeRepresentation(al.columnID)}return"string"}}if(aj.width===undefined){aj.width="auto"}if(aj.minWidth===undefined){aj.minWidth=40}if(aj.autoRowHeightFlag===undefined){aj.autoRowHeightFlag=false}if(aj.visibleFlag===undefined){aj.visibleFlag=true}if(aj.editableFlag===undefined){aj.editableFlag=false}if(this.defaultColumnDef.editionPolicy===undefined){this.defaultColumnDef.editionPolicy="EditionOnDoubleClick"}if(aj.resizableFlag===undefined){aj.resizableFlag=true}if(aj.sortableFlag===undefined){aj.sortableFlag=true}if(aj.groupableFlag===undefined){aj.groupableFlag=true}if(aj.pinned===undefined){aj.pinned="unpinned"}if(aj.autoSizePadding===undefined){aj.autoSizePadding=0}if(aj.allowUnsafeHTMLContent===undefined){aj.allowUnsafeHTMLContent=false}if(aj.shouldCellAllowUnsafeHTMLContentAt===undefined){aj.shouldCellAllowUnsafeHTMLContentAt=function(al){var ak=this.layout;if(ak){return ak.getColumnAllowUnsafeHTMLContent(al.columnID)}return false}}if(aj.allowResetToUndefinedByUIFlag===undefined){aj.allowResetToUndefinedByUIFlag=false}},_applyColumns:function(ai){var aj=this.layout;if(aj){aj.columns=this.columns}},_getColumnOrGroup:function(ai,al){var aj;for(var ak=0;ak<ai.length;ak++){var am=ai[ak];if(am){if(am.dataIndex===al){aj=am;break}else{if(am.children){aj=this._getColumnOrGroup(am.children,al);if(aj){break}}}}}return aj},getColumnOrGroup:function(ak){var aj=this.layout;var ai=aj.getColumnIdentifiers(ak).dataIndex;return this._getColumnOrGroup(aj._balancedColumnTree,ai)},addColumnOrGroup:function(aj,ai){var ak=this.columns;if(!ak){this.columns=[];ak=this.columns}if(ai===undefined){ai=ak.length}ak.splice(ai,0,aj);this.layout.applyColumns();this._requestDelayedModelData()},_removeColumnOrGroup:function(ai,al){var aj=0;for(var ak=0;ak<ai.length;ak++){var am=ai[ak];if(am){if(am.dataIndex===al){ai.splice(ak,1);am._parent=null;aj=1;break}else{if(am.children){aj=this._removeColumnOrGroup(am.children,al);if(aj){break}}}}}return aj},removeColumnOrGroup:function(ak){var aj=this.layout.getColumnIdentifiers(ak).dataIndex;var ai=this._removeColumnOrGroup(this.columns,aj);if(ai){this.layout.applyColumns()}},_applySortModel:function(ai){if(this._rowModel){this._rowModel.sortModel=this.sortModel}},_applyLayout:function(ai){this._parent(ai)},_applyColumnDragEnabledFlag:function(ai){},_applyRowDragEnabledFlag:function(ai){this._updateFromRowDragEnabledState();this.invalidateLayout({updateCellContent:true,updateCellLayout:true,updateCellAttributes:false})},_applyCellDragEnabledFlag:function(ai){},_applyShowCellActivationFlag:function(ai){if(this.showCellActivationFlag){this.getContent().setAttribute("show-cell-activation","")}else{this.getContent().removeAttribute("show-cell-activation")}},_applyShowCellPreselectionFlag:function(ai){if(this.showCellPreselectionFlag){this.getContent().setAttribute("show-cell-preselection","")}else{this.getContent().removeAttribute("show-cell-preselection")}},_applyShowEditableFeedbackFlag:function(ai){this.invalidateLayout({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},_applyShowRequiredFeedbackFlag:function(ai){this.invalidateLayout({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})},_applyShowRowBorderFlag:function(ai,aj){if(this.showRowBorderFlag){this.getContent().setAttribute("show-row-border","")}else{this.getContent().removeAttribute("show-row-border")}if(this.layout){this.layout.resetRowHeights()}},_applyShowModelChangesFlag:function(ai){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})},_applyShowAlternateBackgroundFlag:function(ai){if(this.showAlternateBackgroundFlag){this.getContent().setAttribute("show-alternate-background","")}else{this.getContent().removeAttribute("show-alternate-background")}},_applyShowRowIndexFlag:function(ai){if(this.showRowIndexFlag||G.getTouchMode()){this.getContent().setAttribute("show-row-index","")}else{this.getContent().removeAttribute("show-row-index")}this.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},_applyShowSelectionCheckBoxesFlag:function(ai){if(G.getTouchMode()){this.getContent().setAttribute("show-selection-check-boxes",true)}else{if(this.showSelectionCheckBoxesFlag!==false){this.getContent().setAttribute("show-selection-check-boxes",this.showSelectionCheckBoxesFlag)}else{this.getContent().removeAttribute("show-selection-check-boxes")}}this.invalidateLayout({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false})},_applyShowRowHeaderBackgroundFlag:function(ai){if(this.showRowHeaderBackgroundFlag){this.getContent().setAttribute("show-row-header-background","")}else{this.getContent().removeAttribute("show-row-header-background")}},_applyShowTreeIconsFlag:function(ai){if(this._isReady){var aj=this.layout.getColumnIndex("tree");if(aj>=0){this._updateRenderedColumn(aj,{updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})}}},_applyShowNodeKPIColorFlag:function(ai){this.invalidateLayout({updateCellContent:true,updateCellLayout:false,updateCellAttributes:false})},_updateFromRowDragEnabledState:function(){if(this.rowDragEnabledFlag){this.getContent().setAttribute("row-drag-enabled","")}else{this.getContent().removeAttribute("row-drag-enabled")}},reapplySortModel:function(){if(this._rowModel){this._rowModel._applySortModel(this.sortModel)}},initialize:function(){this._manageCellRequests();if(this.dataSource){this._applyDataSource()}if(this.treeDocument){this._applyTreeDocument()}if(this.sortModel){this.reapplySortModel()}this._applyColumns();this.layout._applyPreferencesOnColumns();this._manageUserInteractions();this._manageDragAndDrop()},destroy:function(){if(this._modelMassUpdateDialog){this._modelMassUpdateDialog.destroy();this._modelMassUpdateDialog=null}this._parent()},displayModalLoader:function(ai,aj){if(!this._loaderDisplayed){this._loaderDisplayed=new aa()}if(this._loaderDisplayed._loaderCounter===0){M.createModal(this.getContent(),this._loaderDisplayed.elements.container)}if(!ai){ai=L.loading}this._loaderDisplayed.on(ai);if(aj){if(this._loaderDisplayed._loaderCounter===1){H.onNodeRendered(this._loaderDisplayed.elements.container,aj)}else{aj()}}},removeModalLoader:function(ai){if(this._loaderDisplayed){if(!ai){ai=L.loading}this._loaderDisplayed.off(ai)}if(this._loaderDisplayed._loaderCounter<=0){M.removeModal(this.getContent());this._loaderDisplayed=undefined}},_displayEmptyContentMessage:function(){if(this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage")){return}var aj=e.createElement("div",{"class":"wux-datagridview-emptycontentmessage"});var ai=e.createElement("div");ai.textContent=this.placeholder;ai.inject(aj);aj.inject(this.elements.poolContainerSync)},_removeEmptyContentMessage:function(){var ai=this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage");if(ai){ai.destroy()}},_registerPools:function(){this._parent();var ai=this.cellClass;this._registerPool("__row_header__",this.elements.leftPoolContainer,p);this._registerPool("__topleft_row_header__",this.elements.leftHeaderPoolContainer,p);this._registerPool("__top_item__",this.elements.headerPoolContainer,a);this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,a);this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,a);this._registerPool("__tree_item__",this.elements.poolContainer,E);this._registerPool("__left_tree_item__",this.elements.leftPoolContainer,E);this._registerPool("__right_tree_item__",this.elements.rightPoolContainer,E);this._registerPool("__odd_row__",this.elements.poolContainer,U);this._registerPool("__even_row__",this.elements.poolContainer,U);this._registerPool("__left_odd_row__",this.elements.leftPoolContainer,U);this._registerPool("__left_even_row__",this.elements.leftPoolContainer,U);this._registerPool("__right_odd_row__",this.elements.rightPoolContainer,U);this._registerPool("__right_even_row__",this.elements.rightPoolContainer,U)},getTreeDocument:function(){return(this._rowModel?this._rowModel._getTreeDocument():undefined)},getTypeRepresentationFactory:function(){return S},supportsKeyboardNavigation:function(){return true},supportsSelection:function(){return true},supportsLightRendering:function(){return true},supportsCustomScrolling:function(){return true},setToolbar:function(ak){var ai=JSON.parse(ak);var am=this.getTypeRepresentationFactory();if(ai.enums){for(var an in ai.enums){am.registerEnum(an,ai.enums[an])}}if(ai.typeRepresentations){am.registerTypeRepresentations(ai.typeRepresentations)}var aj=W.prototype.createTreeDocument(ai);var al=new W({items:aj,overflowManagement:"dropdown",direction:"horizontal",typeRepresentationFactory:am,context:this});return al},getCellAttributesAt:function(av){var ap=this.layout;var ar=this._parent(av);if(av.rowID<=-1){if(this.columnDragEnabledFlag){ar.draggable=true;if(this._draggedColumnOrGroup){var at=ap.getColumnOrGroupFromCoordinates(av);if(at&&at._isMoving){ar["is-moving"]=true}}}if(av.rowID===-1){var ak=ap._getCellTypeRepresentation(av);if(ak){ar["type-representation"]=ak}var al=this.sortModel;if(al&&(al.length>0)){var aq=ap.getDataIndexFromColumnIndex(av.columnID);var an;for(var am=0;am<al.length;am++){if(al[am].dataIndex===aq){an=al[am].sort;break}}if(an!==undefined){ar["sort-direction"]=an;if(al.length>1){ar["sort-order"]=am+1}}}}}else{var ai=this.model[av.rowID];if(ai){if(ai.getChangeStates()&TreeNodeModelChangeStates.NodeToBeRemoved){ar["to-be-removed"]=true}else{if(ai.getChangeStates()&TreeNodeModelChangeStates.NodeAdded){ar.added=true}}if(av.columnID===-1){if(this._rowModel&&!this._rowModel.shouldBeSelected(ai)){ar.unselectable=true}}else{if((av.columnID>=0)&&this.cellDragEnabledFlag){ar.draggable=true}}}if(av.columnID>=0){var ao=ap.getColumnEditionPolicy(av.columnID);if(ao!=="EditionInPlace"){ar.lite=""}if(this.showRequiredFeedbackFlag&&this.getCellRequiredState(av.cellID)){ar["is-required"]=""}if(this.showEditableFeedbackFlag&&(ao!=="EditionInPlace")&&this.getCellEditableState(av.cellID)){ar["is-editable"]=""}}if(this._draggedColumnOrGroup){var au=this.layout.getLeafColumns();var aj=au[av.columnID];if(aj&&aj._isMoving){ar["is-moving"]=true;if(aj._isFirstColumnMoving){ar["is-first-column-moving"]=true}}}}return ar},_setPreselectedCell:function(am){var al=this._getPreselectedCellID();this._parent(am);if(al!==am){this._preselectedCellStableID=(am!==undefined)?this._getXSOElementFromCellID(am):undefined;var ai=this._preselectedRowID;var ak;if(am!==undefined){var aj=this.layout.getCellCoordinatesAt(am);ak=aj.rowID}if(ai!==ak){this._preselectedRowID=ak;if(ai!==undefined){this._updateRenderedRowCellsAttributes(ai)}if(this._preselectedRowID!==undefined){this._updateRenderedRowCellsAttributes(this._preselectedRowID)}}}},_updateRenderedRowCellsAttributes:function(al){var ak=this.layout;var am=ak.getLeafColumns();var ai=am.length;var an=ak._leftPinnedRowcolumnID;for(var aj=an;aj<ai;aj++){this._updateRenderedCellAttributes(ak.getCellIDFromCoordinates({rowID:al,columnID:aj}))}},_updateRenderedRow:function(am,aj){var al=this.layout;var an=al.getLeafColumns();var ai=an.length;var ao=al._leftPinnedRowcolumnID;for(var ak=ao;ak<ai;ak++){this.updateCellView(al.getCellIDFromCoordinates({rowID:am,columnID:ak}),aj)}},_updateRenderedColumn:function(am,aj){var al=this.layout;var ai=al.getMinMaxVisibleRowIDs();for(var ak=ai.minRowID;ak<=ai.maxRowID;ak++){this.updateCellView(al.getCellIDFromCoordinates({rowID:ak,columnID:am}),aj)}},_updateColumnHeaderCells:function(aj){var an=this.layout;var am=3+(an.rowsHeader?1:0);for(var ak=0;ak<an._columnItemsByDepth.length;ak++){var al=an._columnItemsByDepth[ak];for(var ai=0;ai<al.length;ai++){this.updateCellView(am,aj);am++}}},_freeUpColumnCells:function(al,an){var ak=this.layout;var ai=this.model.length;var am=ak.columnsHeader?-1:0;for(var aj=am;aj<ai;aj++){this._freeUpCell(ak.getCellIDFromCoordinates({rowID:aj,columnID:al}),an)}},endRendering:function(){this._parent();if((this._tweakerToGenerateCount===0)&&!this._activeScroller){this._onAllCellsRendered()}},_onAllCellsRendered:function(){if(!this._inOnAllCellsRendered&&this.isInitialized()){this._inOnAllCellsRendered=true;if(this._resetRowHeightsOnAllCellsRenderedFlag){this._resetRowHeightsOnAllCellsRenderedFlag=false;this.layout.resetRowHeights()}this._inOnAllCellsRendered=false;this.fire("allCellsRendered")}},_addTweakerToGenerate:function(){this._tweakerToGenerateCount++},_removeTweakerToGenerate:function(){this._tweakerToGenerateCount--;if(!this._isRendering()&&(this._tweakerToGenerateCount==0)){this._onAllCellsRendered()}},_resetRowHeightsOnAllCellsRendered:function(){this._resetRowHeightsOnAllCellsRenderedFlag=true},isCellPreselected:function(al){var aj=false;var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);aj=((ai.rowID===this._preselectedRowID)&&(ai.rowID>-1));return aj},sizeColumnToFit:function(aq,aw){var ar=this.layout;aw=e.extend({isUserInteraction:false,computeAllRows:false},aw);var au=ar.getColumnIndex(aq);var ao;if(aw.computeAllRows){ao={minRowID:0,maxRowID:this.model.length-1}}else{ao=ar.getMinMaxVisibleRowIDs()}var ak=ar.getColumnMinWidth(au);var ax=ar.getColumnAutoSizePadding(aq);var al=false;for(var ap=ao.minRowID;ap<=ao.maxRowID;ap++){var at=this.layout.getCellIDFromCoordinates({rowID:ap,columnID:au});var an=false;var av=this._getRenderedCellAt(at);if(!av){av=this._renderCell(at,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});an=true}if(av&&av.component){al=true;var ai=av.component.computeContentSize();var am=2;var aj=ai+am+ax;if(aj>ak){ak=aj}if(an){this._freeUpCell(at,1)}}}if(ak!==undefined&&al){ar.setColumnWidth(aq,ak,{isUserInteraction:aw.isUserInteraction})}},sizeAllColumnsToFit:function(aj){var al=this.layout.getLeafColumns();var ai=al.length;this.prepareUpdateView();for(var ak=0;ak<ai;ak++){this.sizeColumnToFit(ak,aj)}this.pushUpdateView({updateCellContent:false,updateCellLayout:true,updateCellAttributes:false},true)},_applyRowGroupingOptions:function(ai){this._properties.rowGroupingOptions.value=e.extend({depth:0,hideGroupedColumns:true},this.rowGroupingOptions)},groupRows:function(ai){if(this._rowModel){this._rowModel.groupRows(ai)}},createGroupingUI:function(){var an=this;var ao=undefined;var am=function(ar,aq){if(an._draggedRowID===-1){ar.preventDefault()}};var ai=function(av,aq){var aw=an.getDraggedColumnData(av);if(aw&&(aw.rowID===-1)){var au={label:aw.label,value:an.layout.getColumnOptionValue(aw.columnID,"dataIndex"),index:undefined};var at=aq.chipCellView?aq.chipCellView.associatedModelItem:undefined;if(at){var ar=aq.dropPosition;if(ar==="left"){au.index=ao.getChipPosition(at.chipOptions.label)}else{if(ar==="right"){au.index=ao.getChipPosition(at.chipOptions.label)+1}}}ao.addChip(au)}return true};ao=new t({shape:t.SHAPE.OVAL,placeholder:m.GroupingUIPlaceholder,onDragOverCell:function(ar,aq){return am(ar,aq)},onDragOverBlank:function(ar,aq){return am(ar,aq)},onDropCell:function(ar,aq){return ai(ar,aq)},onDropBlank:function(ar,aq){return ai(ar,aq)}});var ap=true;var al=true;ao.getContent().addEventListener("change",function(ar){if(ar&&ar.dsModel&&ap){var aq=[];ar.dsModel.getAllChipsOptions().forEach(function(at){aq.push(at.value)});al=false;an.groupRows({dataIndexesToGroup:aq});an.layout._saveGroupingOptionsInPreferences();al=true}});var ak=this.getTreeDocument();if(ak){var an=this;var aj=function(at){if(al&&an._rowModel._groupingOptions&&an._rowModel._groupingOptions.dataIndexesToGroup){ap=false;ao.removeAllChips();for(var aq=0;aq<an._rowModel._groupingOptions.dataIndexesToGroup.length;aq++){var ar=an._rowModel._groupingOptions.dataIndexesToGroup[aq];ao.addChip({label:an.layout.getColumnOptionValue(ar,"text"),value:ar})}ap=true}};ak.addEventListener("groupChildren",aj);aj()}return ao},getCellEditableState:function(al){var ak=this.layout;var aj=ak.getCellCoordinatesAt(al);if(aj.columnID===-1||aj.rowID<=-1){return false}else{var ai=ak.getColumnGetCellEditableState(aj.columnID);if(ai){var am=this.getLightCellInfosAt(al);am.nodeModel=this.model[aj.rowID];return ai.call(this,am)}return ak.getColumnEditableFlag(aj.columnID)}return false},getCellRequiredState:function(ai){return false},_getCellSemantics:function(ak){var aj=this.layout;if((ak.columnID>-1)&&(ak.rowID>-1)){var ai=aj.getColumnGetCellSemantics(ak.columnID);if(ai){return ai.call(this,ak)}}return null},_getCellKPIColor:function(ak){var ai=this.layout;if((ak.columnID>-1)&&(ak.rowID>-1)){var aj=ai.getColumnGetCellKPIColor(ak.columnID);if(aj){return aj.call(this,ak)}}return null},_computeCellIDFromActiveCell:function(aj,al,ai){var ak=this.getActiveCellID();if(ai&&(this._getLastRangeCellID()>=0)&&((aj==="up")||(aj==="right")||(aj==="down")||(aj==="left")||(aj==="pageup")||(aj==="pagedown"))){ak=this._getLastRangeCellID()}return this.layout._computeCellIDFromCell(ak,aj,al,ai)},onDragStartCellDefault:function(aj,ai){},onDragEndCellDefault:function(aj,ai){},onDragEnterCellDefault:function(aj,ai){},onDragLeaveCellDefault:function(aj,ai){},onDragCellDefault:function(aj,ai){},onDragOverCellDefault:function(ak,aj){if(this.getRowReorderEnabledState()&&aj.nodeModel){var ai=c.call(this,ak,aj);if(ai){ak.preventDefault()}}},onDropCellDefault:function(aj,ai){if(this.getRowReorderEnabledState()&&ai.nodeModel){u.call(this);var ak=s.call(this,aj,ai);if(ak){aj.preventDefault();return}}},getRowReorderEnabledState:function(){return this.rowDragEnabledFlag&&this.rowReorderEnabledFlag&&this._disableRowReorderCpt===0},enableRowReordering:function(){this._disableRowReorderCpt--},disableRowReordering:function(){this._disableRowReorderCpt++},onDragStartRowHeaderDefault:function(ao,aj){if(!this.rowDragEnabledFlag){return}var ak={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Row_Options:{"dswebux/x-datagridview.row.options.label+json":aj.nodeModel.options.label,"dswebux/x-datagridview.row.options.icons+json":aj.nodeModel.options.icons,"dswebux/x-datagridview.row.options.grid+json":aj.nodeModel.options.grid,"dswebux/x-datagridview.row.id+json":aj.rowID}}};ao.dataTransfer.setData("text",JSON.stringify(ak));if(ao.dataTransfer.setDragImage){var an=this.layout.getColumnIndex("tree");if(an!==undefined){var al=this.layout.getCellIDFromCoordinates({rowID:aj.rowID,columnID:an});var ai=false;var ap=this._getRenderedCellAt(al);if(!ap){ap=this._renderCell(al,{updateCellContent:false,updateCellLayout:"ignore",updateCellAttributes:false});ai=true}if(ap&&ap.component){ao.dataTransfer.setDragImage(ap.component.getContent(),10,10)}if(ai){var am=this;setTimeout(function(){am._freeUpCell(al,1)},0)}}}},onDragEndRowHeaderDefault:function(aj,ai){},onDragEnterRowHeaderDefault:function(aj,ai){},onDragLeaveRowHeaderDefault:function(aj,ai){u.call(this)},onDragRowHeaderDefault:function(aj,ai){},onDragOverRowHeaderDefault:function(ak,aj){if(this.getRowReorderEnabledState()&&aj.nodeModel){var ai=c.call(this,ak,aj);if(ai){ak.preventDefault()}}},onDropRowHeaderDefault:function(aj,ai){if(this.getRowReorderEnabledState()&&ai.nodeModel){u.call(this);var ak=s.call(this,aj,ai);if(ak){aj.preventDefault();return}}},onDragStartColumnHeaderDefault:function(ap,ai){if(this.columnDragEnabledFlag){var an=this.layout;this._draggedColumnOrGroup=an.getColumnOrGroupFromCoordinates({rowID:ai.rowID,columnID:ai.columnID});this._draggedRowID=ai.rowID;if(this._draggedColumnOrGroup){this._draggedColumnOrGroup._isMoving=true;Y.processTreeChildren(this._draggedColumnOrGroup.children,function(aq){aq._isMoving=true});this._updateColumnHeaderCells({updateCellContent:false,updateCellLayout:false,updateCellAttributes:true});var al=Y.getLeafItems(this._draggedColumnOrGroup);for(var ak=0;ak<al.length;ak++){var am=al[ak];if(ak===0){am._isFirstColumnMoving=true}var ao=an.getColumnIndex(am.dataIndex);this._updateRenderedColumn(ao,{updateCellContent:false,updateCellLayout:false,updateCellAttributes:true})}}}var aj={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Column_Options:{"dswebux/x-datagridview.column.label+json":ai.cellModel,"dswebux/x-datagridview.row.id+json":ai.rowID,"dswebux/x-datagridview.column.id+json":ai.columnID}}};ap.dataTransfer.setData("text",JSON.stringify(aj))},onDragEndColumnHeaderDefault:function(ap,ak){if(this._draggedColumnOrGroup){var ao=this.layout;this._draggedColumnOrGroup._isMoving=false;Y.processTreeChildren(this._draggedColumnOrGroup.children,function(aq){aq._isMoving=false});var am=Y.getLeafItems(this._draggedColumnOrGroup);for(var al=0;al<am.length;al++){var an=am[al];if(al===0){an._isFirstColumnMoving=false}}this._draggedColumnOrGroup=null;var ai=ao._getColumnTreeItemCount();ao._computeColumnItems();var aj=false;if(ao._getColumnTreeItemCount()!==ai){aj=true}this.invalidateLayout({updateCellContent:aj,updateCellLayout:true,updateCellAttributes:true})}},onDragEnterColumnHeaderDefault:function(aj,ai){u.call(this)},onDragLeaveColumnHeaderDefault:function(aj,ai){},onDragColumnHeaderDefault:function(aj,ai){},onDragOverColumnHeaderDefault:function(ay,al){if(this.columnDragEnabledFlag&&this._draggedColumnOrGroup){ay.dataTransfer.dropEffect="move";ay.preventDefault();if(this._draggedColumnOrGroup){var az=this.layout;var ar=false;var ai;var aB=az.getColumnOrGroupFromCoordinates({rowID:al.rowID,columnID:al.columnID});var at=az.getColumnOrGroupPinned(this._draggedColumnOrGroup);var au=az.getColumnOrGroupPinned(aB);if(at===au){var aA=Z(ay).offsetX;var aj;if(al.rowID===-1){ai=al.columnID;aj=aA}else{var ax=0;var ao=Y.getLeafItems(aB);for(var aw=0;aw<ao.length;aw++){var ak=ao[aw];var an=az.getColumnIndex(ak.dataIndex);var av=az.getColumnComputedWidth(an);if(aA<=ax+av){ai=an;aj=aA-ax;break}ax+=av}}if(ai!==undefined){var ap=az.getColumnOrGroupComputedWidth(this._draggedColumnOrGroup);var aq=az.getColumnComputedWidth(ai);var am=az.getFirstLeafColumnIndex(this._draggedColumnOrGroup);if(((az._orderedColumnsReverseIndexes[am]<az._orderedColumnsReverseIndexes[ai])&&(aj>(aq/2))&&(aj>(aq-ap)))||((az._orderedColumnsReverseIndexes[am]>az._orderedColumnsReverseIndexes[ai])&&(aj<(aq/2))&&(aj<ap))){ar=true}}}if(ar){this.layout.moveColumnOrGroup(this._draggedColumnOrGroup,ai,{isUserInteraction:true})}}}},onDropColumnHeaderDefault:function(aj,ai){},onDragEnterBlankDefault:function(aj,ai){u.call(this)},_processDragAndDropCallbacks:function(an,ar){if(an.type==="dragstart"){if(an.dataTransfer){var am=an.target.getBoundingClientRect();var al=an.clientX-am.left;var aj=an.clientY-am.top;if(typeof(an.dataTransfer.setDragImage)==="function"){an.dataTransfer.setDragImage(an.target,al,aj)}}}if(an.type==="dragover"){var ai=F.call(this,an);if(ai){return}}else{if(an.type==="dragstart"&&ar.columnID===-1&&ar.rowID>=0){Object.getPrototypeOf(this).__rowReorderDnDInfos={source:this._uuid,node:ar.nodeModel}}else{if(an.type==="dragend"){if(!this._rowReorderDnDInfos.dropAccepted){s.call(this,an,ar)}Object.getPrototypeOf(this).__rowReorderDnDInfos=null;x.call(this);u.call(this)}}}var ap={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"};var at=ap[an.type];var aq=ar;var ao=this;function ak(ay,au){var ax=true;var av=ao[ay+au];var aw=ao[ay+au+"Default"];if(av){ax=av.call(ao,an,aq);if(ae){console.info("[dnd]",ay+au,">",ax,an.target)}}else{if(!aw){if(ae){console.warn("[dnd]","cannot find",ay+au,"callback")}}}if(aw&&ax){if(ae){if(av&&ax){console.info("\t>[dnd]","dev want to continue to the default behavior for ",ay+au," callback")}else{console.info("\t>[dnd]","use the default behavior for ",ay+au," callback")}}aw.call(ao,an,aq)}}if(ar&&ar.cellView){if(ar.columnID===-1){ak(at,"RowHeader")}else{if(ar.rowID<=-1){ak(at,"ColumnHeader")}else{ak(at,"Cell")}}}else{ak(at,"Blank")}},_manageDragAndDrop:function(){this.addEventListener("dragstart",this._processDragAndDropCallbacks.bind(this));this.addEventListener("drop",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragover",this._processDragAndDropCallbacks.bind(this));this.addEventListener("drag",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragend",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragleave",this._processDragAndDropCallbacks.bind(this));this.addEventListener("dragenter",this._processDragAndDropCallbacks.bind(this))},getDraggedRowData:function(aj){var ai=aj.dataTransfer.getData("text");try{if(ai!==""){var ak=JSON.parse(ai);if(ak&&ak.data.DataGridView_Row_Options!==undefined){return{uuid:ak.source.uuid,label:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.label+json"],icons:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.icons+json"],grid:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.grid+json"],rowID:ak.data.DataGridView_Row_Options["dswebux/x-datagridview.row.id+json"]}}}}catch(aj){console.warn('the element being in dataTransfer type "DataGridView_Row_Options" is not parsable usable JSON.parse')}},getDraggedColumnData:function(aj){var ai=aj.dataTransfer.getData("text");try{if(ai!==""){var al=JSON.parse(ai);if(al&&al.data.DataGridView_Column_Options!==undefined){return{uuid:al.source.uuid,label:al.data.DataGridView_Column_Options["dswebux/x-datagridview.column.label+json"],rowID:al.data.DataGridView_Column_Options["dswebux/x-datagridview.row.id+json"],columnID:al.data.DataGridView_Column_Options["dswebux/x-datagridview.column.id+json"]}}}}catch(ak){console.warn('the element being in dataTransfer type "DataGridView_Column_Label" is not parsable usable JSON.parse')}},_getSelectionCheckBox:function(am){var ai;var ak=this.layout.getCellIDFromCoordinates({rowID:am,columnID:-1});var al=this._getViewAt(ak);if(al){var aj=al.getContent().querySelector(".wux-datagridview-selection-checkbox");if(aj){ai=aj.dsModel}}return ai},_updateSelectAllCheckBox:function(){if(this.layout.columnsHeader){var ai=this._getSelectionCheckBox(-1);if(ai){var al=this.getNodesXSO();if(al){var am=al.isEmpty();ai.checkFlag=!am;var ak=this.isEveryVisibleNodeSelected();var aj=this._selectAllCheckBoxListenChange;this._selectAllCheckBoxListenChange=false;ai.mixedState=!am&&!ak;this._selectAllCheckBoxListenChange=aj}}}},_getCellTooltip:function(ai){if(this.getCellTooltip){return this.getCellTooltip(ai)}else{return this.getCellDefaultTooltip(ai)}},getCellDefaultTooltip:function(aj){var ai=this;return{getAllInformationCB:function(){if(aj.rowID<0){var an=ai.layout.getColumnOrGroupFromCoordinates(aj);if(an.description){return{model:{shortHelp:an.description},updateModel:false}}}if(!aj.cellModel){return{model:{shortHelp:""},updateModel:false}}var am=aj.cellView.elements.container.offsetWidth;var al=aj.cellView.computeContentSize();var ap=am<al;var ak="";if(ap){var ao=aj.cellView._getReusableContent();if(ao){ak=ao.getStringFromValue(ao.value)}}return{model:{shortHelp:ak},updateModel:false}}}},defaultOnCellRequest:function(ai){var aq=this;var aB=aq.layout;var ao=aB.getLeafColumns();var az=ao[ai.columnID];var ar=false;if((ai.rowID>=0)&&(ai.columnID>=0)){if(az.dataIndex==="tree"){var am=ai.cellView;am.showIconsFlag=aq.showTreeIconsFlag;am.flatTreeFlag=aq.hasFlatTreeState();var av=aq.model[ai.rowID];if(am.nodeModel!==av){am.nodeModel=av}else{am._applyNodeModel(av)}am.height=aB.getRowHeight(ai.rowID);aq._setTweakerForCell(ai);ar=true}else{var ax=aB._getCellTypeRepresentation(ai);if(ax){aq._setTweakerForCell(ai);ar=true}else{var aw=ai.cellModel;if(typeof aw==="number"){aw+=""}if(Q.getUnsafeHTMLContentValueToApply(aB.getColumnShouldCellAllowUnsafeHTMLContentAt(ai.columnID).call(this,ai))){ai.cellView.getContent().setHTML(aw)}else{ai.cellView.getContent().textContent=aw}}}ai.cellView._updateTooltip(this._getCellTooltip(ai))}else{if((ai.columnID===-1)&&aB.rowsHeader){var ay=ai.cellView.getContent().querySelector(".wux-datagridview-selection-checkbox");if(ay){var ak=ay.dsModel;if(ak){var ap=aq.getNodesXSO();if(ap){var aj=ak.preventTriggeringChangeEvent;ak.preventTriggeringChangeEvent=true;if(ai.rowID>=0){ak.checkFlag=ap.isIn(ai.nodeModel);ak.mixedState=false}else{var an=ap.isEmpty();ak.checkFlag=!an;var at=aq.isEveryVisibleNodeSelected();ak.mixedState=!an&&!at}ak.preventTriggeringChangeEvent=aj}}ai.cellView._updateTooltip({getAllInformationCB:function(){return{model:{shortHelp:ai.cellModel?ai.cellModel.toString():undefined},updateModel:false}}})}var aA=ai.cellView.getContent().querySelector(".wux-datagridview-selection-label");if(aA){aA.textContent=ai.cellModel}ai.cellView.showKPIColorFlag=aq.showNodeKPIColorFlag;ai.cellView.KPIColor=ai.nodeModel?ai.nodeModel.options.color:undefined}else{if((ai.rowID<=-1)&&(ai.columnID>=0)){aq._setTweakerForCell(ai);ar=true;if(this._rowModel&&this._rowModel._filterViewManager&&az){var al=az.dataIndex==="tree"?"label":az.dataIndex;var au=this._rowModel._filterViewManager.getFilterViews()[al];if(ai.cellView.elements.iconsContainer){if(au){au.inject(ai.cellView.elements.iconsContainer)}else{ai.cellView.elements.iconsContainer.empty()}}}ai.cellView._updateTooltip(this._getCellTooltip(ai))}else{ai.cellView._setReusableContent(null)}}}if(ai.columnID>=0){if(ar){ai.cellView.getContent().removeAttribute("no-tweaker")}else{ai.cellView.getContent().setAttribute("no-tweaker","")}}},_manageCellRequests:function(){var ai=this;ai.onCellRequest(function aj(am){var ak=ai.layout;if((am.rowID>=0)&&(am.columnID>=0)){var al=ak.getColumnOnCellRequest(am.columnID);if(al){return al.call(ai,am)}}ai.defaultOnCellRequest(am)})},_setTweakerForCell:function(ai){var aw=this;var aH=this.layout;var ax=false;var aD;var aG;var aB=ai.cellModel;var ay;var aq=false;if((ai.rowID<=-1)&&(ai.columnID>=0)){aD="string";var am=aH.getColumnOrGroupFromCoordinates(ai);if(am){aG=am.icon}else{aG=aH.getColumnIcon(ai.columnID)}aq=true;if(ax){aB+=" cellID:"+ai.cellID+"  rowID: "+ai.rowID+" colID: "+ai.columnID}}else{if(ax){aD="string";aq=true;aB="cellID:"+ai.cellID+"  rowID: "+ai.rowID+" colID: "+ai.columnID}else{aD=aH._getCellTypeRepresentation(ai);var az=this.model[ai.rowID];if(az){var aj=az.options.grid;var at=aH.getLeafColumns();var aF=at[ai.columnID];if(aj.hasOwnProperty(aF.dataIndex)||(aB!==undefined)||(aH.getColumnGetCellValue(ai.columnID)!==undefined)){aq=true;ay=az.getReferenceValue(aF.dataIndex);if(ay===undefined){ay=e.clone(aB,false)}}}}}var aE=parseInt(Date.now());if(ai.cellView){ai.cellView._currentTimeStamp=aE}if(aD&&aq){var ap;var al=ai.cellView._getReusableContent();if(al&&al.__disposable__){ap=S.getTemplateIdentifierFromTypePath(aD)}var aC=aH.getColumnShouldCellAllowUnsafeHTMLContentAt(ai.columnID).call(this,ai);var ao=aH.getColumnOptionValue(ai.columnID,"allowResetToUndefinedByUIFlag");var aJ=aH.getColumnOptionValue(ai.columnID,"hyperlinkTarget");var av={touchMode:G.getTouchMode(),readOnly:!this._isCellInEdition(ai.cellID),showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:aC};if((ai.rowID<=-1)&&(ai.columnID>=0)){av.icon=aG}if(ay!==undefined){av.referenceValue=ay}if(ao!==undefined){av.allowResetToUndefinedByUIFlag=ao}if(ai.rowID>-1){var aA=aH.getColumnOptionValue(ai.columnID,"alignment");if(aA==="near"||aA==="center"||aA==="far"){av.alignment=aA}}if(aJ!==undefined){av.hyperlinkTarget=aJ}var ak=this._getCellSemantics(ai);if(ak){av=e.merge(ak,av)}av.context=ai;if(al&&al.__disposable__&&(al.__disposable__.identifier===ap)){al.disableEvents();av.value=aB;var aI=S.getRegisteredTypeRepresentation(aD);if(!aI){aI={semantics:{possibleValues:S.getRegisteredEnum(aD)}}}var au=S.getTemplateIdentifierFromTypeRep(aI,"inlinedTemplate");var ar=S.getRegisteredTypeTemplate(au);Q.setTweakerProperties(al,av,aI,ar);al.enableEvents()}else{av.typePath=aD;av.context="inlinedTemplate";av.semantics={context:ai};av.needToCreateViewAfterRequireEnded=function(){if(ai.cellView&&ai.cellView._currentTimeStamp===aE){return true}else{return false}};aw._addTweakerToGenerate();av.onViewCreated=function(aK){ai.cellView._setReusableContent(aK);aw._removeTweakerToGenerate()};av.onFailure=function(aK){aw._removeTweakerToGenerate()};S.generateView(aB,av)}}else{ai.cellView._setReusableContent(null)}var an=this._getCellKPIColor(ai);if(an){ai.cellView.KPIColor=an;ai.cellView.showKPIColorFlag=true}else{ai.cellView.showKPIColorFlag=false}},_manageUserInteractions:function(){var ai=this;ai.addEventListener("change",function(am,an){if(ai._isCurrentlyCalledFromUIInteraction()&&an&&(an.columnID>=0)){if(an.cellView){var aj=an.cellView._getReusableContent();if(aj){var ak=aj.value;var al=aj.referenceValue;ai.setModelAt(an.cellID,ak,al)}}}});ai.addEventListener("buttonclick",function(al,am){if(al.target.hasClassName("wux-datagridview-selection-checkbox")&&ai._selectAllCheckBoxListenChange){var aj=al.target.dsModel;if(aj){ai._selectAllCheckBoxListenChange=false;if(am.rowID>=0){if(am.nodeModel){if(aj.checkFlag){if(!al.options.shiftKey){ai.setActiveCell(am.cellID)}ai.selectNodeModel(am.nodeModel,true,al.options.shiftKey);var ak=ai.getTreeDocument();if(ak&&!ak.options.shouldBeSelected.call(ak,am.nodeModel)){aj.checkFlag=false}}else{ai.unselectNodeModel(am.nodeModel)}}}else{if(aj.checkFlag){ai.selectAllVisibleNodes()}else{ai.unselectAll()}}ai._selectAllCheckBoxListenChange=true}}});this._managePointerEvents();this._manageContextualMenu()},_manageContextualMenu:function(){var ai=this;if(ai._ctxMenuToken===undefined){ai._ctxMenuToken=r.addEventListener(this.elements.container,{callback:function(ak){var aj=ai.getCellInfosFromHtmlElement(ak.info.target);if(aj){ai.setActiveCell(aj.cellID);ai.selectCell(aj.cellID,false)}else{ai.setActiveCell(-1)}return ai.onContextualEvent.call(ai,{context:ak.context,collectionView:ai,infos:ak.info,data:ak.data,cellInfos:aj})}})}},buildDefaultContextualMenu:function(aj,ai){return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(aj,ai):[]},showColumnsManagementDialog:function(){if(this._contextualMenuBuilder){this._contextualMenuBuilder.showColumnsManagementDialog()}},showModelMassUpdateDialog:function(){if(!this._modelMassUpdateDialog){this._modelMassUpdateDialog=new v({identifier:this.identifier+"_MassUpdate",treeDocument:this.treeDocument,autoCloseFlag:false,resizableFlag:true,modalFlag:true,width:500,height:500})}var ak=[];var ao=this.layout;var aq=ao.getLeafColumns();var al=ao.getVisibleOrderedColumnsIndexes();for(var am=0;am<al.length;am++){var an=al[am];var aj=aq[an];if(aj){var ai={name:aj.dataIndex,label:aj.text,typeRepresentation:ao.getColumnTypeRepresentation(an)};ak.push(ai)}}this._modelMassUpdateDialog.attributes=ak;var ap=H.firstParentWithClass(this.getContent(),"wux-windows-immersive-frame");this._modelMassUpdateDialog.immersiveFrame=ap?ap.dsModel:undefined;this._modelMassUpdateDialog.visibleFlag=true},_onPrivateScrollEnd:function(){if((this._tweakerToGenerateCount===0)&&!this._renderingTaskInterrupted){this._onAllCellsRendered()}},_onPrivateReady:function(){if(this._tweakerToGenerateCount===0){this._onAllCellsRendered()}},_requestDelayedModelData:function(){if(this.onDelayedModelDataRequest){var ai=this;var an=this.layout;var am=ai.getViewportDimensions();if(am.height>0){var aj=an.getMinMaxVisibleRowIDs();var ak=aj.minRowID;var al=aj.maxRowID;var ao=an.getDisplayedColumnsIndexes();ai._rowModel.prepareUpdate();ai.onDelayedModelDataRequest.call(ai,{collectionView:ai,startNodeIndex:ak,endNodeIndex:al,displayedColumnsIndexes:ao});ai._rowModel.pushUpdate()}}},cellShouldBeSelected:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);return((ai.rowID>=0)&&(!this.layout.rowsHeader||(ai.columnID!==-1)))},cellShouldBeUnselected:function(ai){return this.cellShouldBeSelected(ai)},getEditionManager:function(ak){var ai=this.layout.getCellCoordinatesAt(ak);var aj=this.layout.getColumnEditionPolicy(ai.columnID);if(!this._editionManagers[aj]){if(aj==="EditionOnDoubleClick"){this._editionManagers[aj]=new q()}else{if(aj==="EditionOnClick"){this._editionManagers[aj]=new N()}else{if(aj==="EditionOnOver"){this._editionManagers[aj]=new B()}else{if(aj==="EditionInPlace"){this._editionManagers[aj]=new g()}else{return null}}}}if(this._editionManagers[aj]){this._editionManagers[aj].collectionView=this}}return this._editionManagers[aj]},_onEditionModeChanged:function(al,aj){if(!aj){var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);if(ak.getColumnAutoRowHeightFlag(ai.columnID)){ak.resetRowHeight(ai.rowID)}}},_managePointerEvents:function(){var ai=this;this._selectionHasBeenDoneOnDown=false;H.addEventOnElement(this,this,l.POINTERDOWN,function(aj,ak){ai.callMethodFromUIInteraction("_onCapturePointerDown",aj,ak)},true);H.addEventOnElement(this,this,l.POINTERMOVE,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerMove",aj,ak)});H.addEventOnElement(this,this,l.POINTERUP,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerUp",aj,ak)});H.addEventOnElement(this,this,"click",function(aj,ak){ai.callMethodFromUIInteraction("_onClick",aj,ak)});H.addEventOnElement(this,this,l.POINTERHIT,function(aj,ak){ai.callMethodFromUIInteraction("_onPointerHit",aj,ak)});H.addEventOnElement(this,this,"dblclick",function(al,am){if(z){var aj=ai.layout;var ak=aj.getLeafColumns();if(k>=0&&k<ak.length){if(aj.getColumnResizableFlag(k)===true){ai.sizeColumnToFit(k,{isUserInteraction:true});if(aj.getColumnAutoRowHeightFlag(k)||aj.hasAutoWidthColumnWithAutoRowHeightFlag()){aj.resetRowHeights()}}}}})},_onPointerHit:function(an,ap){if(ap&&(ap.rowID===-1)&&!z){var aj=this.layout;var ak=aj.getColumnSortableFlag(ap.columnID);if(ak){var al=aj.getDataIndexFromColumnIndex(ap.columnID);var ao=[];var am;var aq=this.sortModel;if(aq&&(aq.length>0)){for(var ai=0;ai<aq.length;ai++){if(aq[ai].dataIndex===al){am=(aq[ai].sort==="asc")?"desc":"asc";ao.push({dataIndex:al,sort:am});if(!an.ctrlKey){break}}else{if(an.ctrlKey){ao.push(aq[ai])}}}}if(am===undefined){am="asc";ao.push({dataIndex:al,sort:am})}this.setPropertyFromUIInteraction("sortModel",ao);aj._saveColumnSortModelInPreferences()}}},_onPointerUp:function(ai,aj){if(b&&(k!==undefined)&&((this.layout.getColumnAutoRowHeightFlag(k))||this.layout.hasAutoWidthColumnWithAutoRowHeightFlag())){this.layout.resetRowHeights()}b=false;this.getContent().removeAttribute("is-resizing-column")},_onClick:function(ai,aj){if(aj&&(aj.rowID!==-1)&&!this._selectionHasBeenDoneOnDown){if(aj.columnID>-1){this._manageCellSelection(ai,aj)}}this._selectionHasBeenDoneOnDown=false},_onPointerMove:function(ak,al){if(b&&(k!==undefined)){var ai=this.layout.getColumnPinned(k);var aj=0;if(ai==="right"){aj=X+(y-ak.clientX)}else{aj=X+(ak.clientX-y)}aj=Math.max(0,aj);this.layout.setColumnWidth(k,aj,{isUserInteraction:true});return}this._computeResizedColumnID(ak,al)},_onCapturePointerDown:function(ao,aq){if(ao.target.hasClassName&&ao.target.hasClassName("wux-layouts-treeview-expander")){return}this.PointerDownScope=true;this._computeResizedColumnID(ao,aq);if(z&&(k!==undefined)&&(k>=0)){b=true;ao.preventDefault();ao.stopPropagation();ao.stopImmediatePropagation();y=ao.clientX;X=this.layout.getColumnComputedWidth(k)}else{if(aq&&(aq.rowID!==-1)){var ai=this.getEditionManager(aq.cellID);if(ai){ai.onCellPointerDown(aq.cellID)}this._selectionHasBeenDoneOnDown=false;if(aq.columnID>-1&&!l.isTouchEvent(ao)){this._manageCellSelection(ao,aq);this._selectionHasBeenDoneOnDown=true}}else{if(!aq){var al=false;if((ao.target===this.elements.scroller.getContent())||(ao.target===this.elements.rightScroller.getContent())){var ap=ao.target.getDimensions();var ar=this.layout.getContentDimensions();var aj=this.layout.getRightContainerWidth();var an=e.Utils.Client.getScrollbarWidth();var ak=((ao.target===this.elements.scroller.getContent())&&(ap.width<ar.width));var am=((ap.height<ar.height)&&(((aj===0)&&(ao.target===this.elements.scroller.getContent()))||((aj!==0)&&(ao.target===this.elements.rightScroller.getContent()))));if((ak&&(ao.offsetY>=ap.height-an)&&(ao.offsetY<=ap.height))||(am&&(ao.offsetX>=ap.width-an)&&(ao.offsetX<=ap.width))){al=true}}if(!al){if(this.selectionBehavior.unselectAllOnEmptyArea){this.unselectAll()}this.setActiveCell(-1)}}}}this.PointerDownScope=false},_manageCellSelection:function(an,ao){var ai=(this.selectionBehavior.toggle||an.ctrlKey);var aj=false;var am=this.rowSelection;var ak=this.cellSelection;if((ak==="single")||(ak==="multiple")){aj=this.isCellSelected(ao.cellID)}else{if((am==="single")||(am==="multiple")){var ap=this._getNodeModelAt(ao.cellID);if(ap){var al=this.getNodesXSO();if(al){aj=al.isIn(ap)}}}}if(ai&&aj){this.unselectCell(ao.cellID);this.setActiveCell(ao.cellID)}else{this.selectCell(ao.cellID,ai,an.shiftKey)}},_computeResizedColumnID:function(ai,ap){var ar=this;var al=Q.debounce(function(){if(b===false){ar.getContent().removeAttribute("is-resizing-column")}},1);var ak=this.layout;if(ap&&(ap.columnID>-1)&&((ap.rowID<=-1)||(ap.columnID===ak._lastLeftPinnedColumnIndex)||(ap.columnID===ak._firstRightPinnedColumnIndex)||(ap.columnID===ak._firstUnpinnedColumnIndex))){k=-1;var am=ak.getColumnOrGroupFromCoordinates(ap);var aj,an,aq,ao;if(am){aj=ak.getColumnOrGroupComputedWidth(am);an=ak.getColumnOrGroupPinned(am);aq=ak.getFirstLeafColumnIndex(am);ao=ak.getLastLeafColumnIndex(am)}else{aj=ak.getColumnComputedWidth(ap.columnID);an=ak.getColumnPinned(ap.columnID);aq=ap.columnID;ao=ap.columnID}if((ai.offsetX>=0)&&(ai.offsetX<=j)){if(an==="right"){k=aq}else{if((ap.rowID<=-1)||(ap.columnID===ak._firstUnpinnedColumnIndex)){k=ak._getPreviousVisibleColumnID(aq)}}}else{if((ai.offsetX>=aj-j)&&(ai.offsetX<=aj)){if(an==="right"){if(ap.rowID<=-1){k=ak._getNextVisibleColumnID(ao)}}else{if((ap.rowID<=-1)||(ap.columnID===ak._lastLeftPinnedColumnIndex)){k=ao}}}}}else{k=undefined;if(((ai.target===this.elements.leftScrollContainer)||(ai.target===this.elements.leftSpacerContainer))&&(ai.offsetX>=this.elements.leftScrollContainer.clientWidth-j)){k=ak._lastLeftPinnedColumnIndex}else{if(((ai.target===this.elements.rightScrollContainer)||(ai.target===this.elements.rightScroller.getContent())||(ai.target===this.elements.rightSpacerContainer))&&(ai.offsetX<=j)){k=ak._firstRightPinnedColumnIndex}}}if((k>=0)&&ak.getColumnResizableFlag(k)){z=true;ar._preventScroll=true;this.getContent().setAttribute("is-resizing-column","true")}else{z=false;ar._preventScroll=false;k=undefined;al()}},_getNodeModelAt:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);if(this._rowModel){return this._rowModel.getVisibleNodeModel(ai.rowID)}return undefined},getModelAt:function(am){var al=this.layout;var aq=al.getCellCoordinatesAt(am);if(aq.rowID<=-1){var an=al.getColumnOrGroupFromCoordinates(aq);if(an){return aq.columnID>-1?an.text:""}}else{if(aq.columnID===-1){return""+(aq.rowID+1)}else{if(aq.columnID>-1){var aj=al.getColumnGetCellValue(aq.columnID);if(aj){var ap=this.getLightCellInfosAt(am);ap.nodeModel=this.model[aq.rowID];return aj.call(this,ap)}var ai=this.model[aq.rowID];if(ai){var ao=al.getDataIndexFromColumnIndex(aq.columnID);if(ao==="tree"){var ak=al._getCellTypeRepresentation({cellID:am,columnID:aq.columnID,rowID:aq.rowID,cellModel:ai.options.label,nodeModel:ai});if(ak==="string"){return ai.options.label}}return ai.getAttributeValue(ao)}else{console.log("!! No TreeNodeModel at rowID = "+aq.rowID);return""}}else{return""}}}},setModelAt:function(al,an,aq){var ak=this.layout;var ar=ak.getCellCoordinatesAt(al);var ai=this.model[ar.rowID];if(ai){var am=ak.getDataIndexFromColumnIndex(ar.columnID);var ap=ak.getColumnSetCellValue(ar.columnID);if(ap){var ao=this.getLightCellInfosAt(al);ao.nodeModel=this.model[ar.rowID];if(aq===undefined){aq=ai.getReferenceValue(am);if(aq===undefined){aq=e.clone(an,false)}}ai.setReferenceValue(am,aq);return ap.call(this,ao,an)}if(am==="tree"){var aj=ak._getCellTypeRepresentation({cellID:al,columnID:ar.columnID,rowID:ar.rowID,cellModel:an,nodeModel:ai});if(aj==="string"){ai.setLabel(an)}}ai.setAttribute(am,an)}else{if(ar.rowID!==-1){console.log("!! setModelAt NO TreeNodeModel at rowID = "+ar.rowID+" cellID = "+al)}}},getCellInfosAt:function(ak){var aj=this.getModelAt(ak);var ai=this.layout.getCellCoordinatesAt(ak);var al=this.model[ai.rowID];return{cellID:ak,columnID:ai.columnID,rowID:ai.rowID,cellModel:aj,nodeModel:al}},getLightCellInfosAt:function(aj){var ai=this.layout.getCellCoordinatesAt(aj);return{cellID:aj,columnID:ai.columnID,rowID:ai.rowID}},getXSOElementID:function(ai){return ai?ai.id:undefined},_getXSOElementFromCellID:function(al){var ak=this.layout;var ai=ak.getCellCoordinatesAt(al);var aj=ak.getDataIndexFromColumnIndex(ai.columnID);var am=this.model[ai.rowID];return{id:(ai.rowID+"_"+aj),rowID:ai.rowID,columnDataIndex:aj,nodeModel:am}},_getCellIDFromXSOElement:function(ai){var al=-1;if(ai){var am=ai.rowID;var ak=this.layout;var aj=ak.getColumnIndex(ai.columnDataIndex);al=ak.getCellIDFromCoordinates({rowID:am,columnID:aj})}return al},_updateXSOElements:function(){var ai=this.getCellsXSO();if(ai){var ak=ai.get();var aj=this;ak.forEach(function(al){var an=aj.model[al.rowID];if(an!==al.nodeModel){aj.unselectCell(aj._getCellIDFromXSOElement(al));if(al.nodeModel.isVisible()){var am=aj.layout.getCellIDFromCoordinates({rowID:al.nodeModel._getRowID(),columnID:aj.layout.getColumnIndex(al.columnDataIndex)});aj.selectCell(am,true)}}})}},_updateActiveCell:function(ai){if(ai){if(!ai.nodeModel){this.setActiveCell(-1);return}var ak=undefined;if(ai.rowID>=0&&ai.rowID<this.model.length){ak=this.model[ai.rowID]}if(ak!==ai.nodeModel){if(ai.nodeModel.isVisible()){var aj=this.layout.getCellIDFromCoordinates({rowID:ai.nodeModel._getRowID(),columnID:this.layout.getColumnIndex(ai.columnDataIndex)});this.setActiveCell(aj)}else{this.setActiveCell(-1)}}}},_onSpaceKeyPressed:function(){var ak=this.getActiveCellID();var al=this._getNodeModelAt(ak);if(al){var aj=this.getNodesXSO();if(aj){var ai=aj.isIn(al);if(ai){this.unselectNodeModel(al)}else{this.selectNodeModel(al,true,false)}}}},_copyToPlainText:function(){var at=this.getNodesXSO();var av=this;var aA="";var am=undefined;if(!at.isEmpty()){am=at.get().filter(function ax(aC){return aC.isVisible()})}if(am&&am.length>0){am.sort(function(aD,aC){if(aD._rowID<=aC._rowID){return -1}else{return 1}});for(var al=0;al<am.length;al++){var ao=am[al];var aw=av.layout.getCellsFromNodeModel(ao,true);for(var aB=0;aB<aw.length;aB++){var ai=av.getCellInfosAt(aw[aB]);var ak=av._getCellValueForCopy(ai);if(ak!==undefined){aA+=ak}if(aB<aw.length-1){aA+="\t"}}if(al<am.length-1){aA+="\n"}}}else{var az=this.getCellsXSO();if(!az.isEmpty()){var aq=av.layout._getXSORectangularShape();if(aq===undefined){ac("ClipboardError","ClipboardActionKoMultipleSelection")}else{for(var au=aq.minRowID;au<aq.minRowID+aq.height;au++){var ap=aq.minColumnID;for(var ar=0;ar<aq.width;ar++){var ay={rowID:au,columnID:ap};var an=av.layout.getCellIDFromCoordinates(ay);var aj=av.getCellInfosAt(an);var ak=av._getCellValueForCopy(aj);if(ak!==undefined){aA+=ak}if(ar<aq.width-1){aA+="\t"}ap=this.layout._getNextVisibleColumnID(ap)}if(au<aq.minRowID+aq.height-1){aA+="\n"}}}}}return aA},_pasteFromPlainText:function(aH){var am=ad(aH);if(!am||!am.length||!am[0]||!am[0].length){return}var aF=am.length;var aG=am[0].length;for(var aC=1;aC<aF;aC++){if(am[aC].length!==aG){ac("ClipboardError","InconsistentNbColumnsPerRowsInClipboard");return}}var at=this.getNodesXSO();var ak=undefined;if(!at.isEmpty()){ak=at.get().filter(function aw(aI){return aI.isVisible()})}if(ak&&ak.length>0){var aj=this.layout.getVisibleOrderedColumnsIndexes();var az=aj.length;if(az!==aG){ac("ClipboardError","NbColumnsOfClipboardNotEqualToNbVisibleColumns");return}else{ak.sort(function(aJ,aI){if(aJ._rowID<=aI._rowID){return -1}else{return 1}});this._rowModel.prepareUpdate();this.prepareUpdateView();var aq=0;for(var aB=0;aB<aj.length;aB++){var an=aj[aB];var aE=0;for(var av=0;av<am.length;av++){var ax={rowID:ak[av+aE]._rowID,columnID:an};var al=this.layout.getCellIDFromCoordinates(ax);var ap=am[av][aq];if(this.getCellEditableState(al)){var ai=this.getCellInfosAt(al);this.setModelAt(al,this._processCellValueFromPaste(ai,ap));this._flashEffectOnCell("ui-modified",this._getViewAt(al))}else{this._flashEffectOnCell("ui-notmodified",this._getViewAt(al))}if(av+aE===ak.length-1){break}if(av===am.length-1&&ak.length>am.length){av=-1;aE+=am.length}}aq++}this._rowModel.pushUpdate();this.pushUpdateView()}}else{var ay=this.getCellsXSO();var au=this.getActiveCellID();var ar=ay.get();var ao=undefined;if(ar.length>1){ao=this.layout._getXSORectangularShape();if(ao===undefined){ac("ClipboardError","MultipleSelection");return}au=this.layout.getCellIDFromCoordinates({rowID:ao.minRowID,columnID:ao.minColumnID})}else{if(ar.length===1){au=this._getCellIDFromXSOElement(ar[0])}}this._rowModel.prepareUpdate();this.prepareUpdateView();var aA=this.layout.getCellCoordinatesAt(au);var aE=0;for(var av=0;av<am.length;av++){var aD=aA.columnID;for(var aq=0;aq<am[av].length;aq++){var ax={rowID:aA.rowID+av+aE,columnID:aD};var al=this.layout.getCellIDFromCoordinates(ax);var ai=this.getCellInfosAt(al);var ap=am[av][aq];if(this.getCellEditableState(al)){this.setModelAt(al,this._processCellValueFromPaste(ai,ap));this._flashEffectOnCell("ui-modified",this._getViewAt(al))}else{this._flashEffectOnCell("ui-notmodified",this._getViewAt(al))}aD=this.layout._getNextVisibleColumnID(aD);if(aD===-1){break}if(ao){if(aq===ao.width-1){break}}}if(ao){if(av+aE===ao.height-1){break}if(av===am.length-1&&ao.height>am.length){av=-1;aE+=am.length}}}this._rowModel.pushUpdate();this.pushUpdateView()}},getCellIDAsString:function(aj){var ak=this.layout.getCellCoordinatesAt(aj);var ai=-1;if(ak.columnID>-1){ai=this.layout._orderedColumnsReverseIndexes[ak.columnID]}return ak.rowID+":"+ai},getAsCSV:function(al){var ar=this.getNodesXSO();var au=this;var aF=this.layout;var aC="";var aq=undefined;if(al&&al.onlySelectedRows){if(!ar.isEmpty()){aq=ar.get().slice();aq.sort(function(aJ,aI){if(aJ._rowID<=aI._rowID){return -1}else{return 1}})}}else{aq=au.model}if(!aq){return}var av=(al?al.columnKeys:undefined);var ao=aF.getLeafColumns();if(!av){if(al&&al.allColumns){av=new Array(ao.length);for(var ap=0;ap<ao.length;ap++){av[ap]=ap}}else{av=aF.getVisibleOrderedColumnsIndexes()}}else{for(var aD=0;aD<av.length;aD++){av[aD]=aF.getColumnIndex(av[aD])}}var aG=(al&&al.columnSeparator?al.columnSeparator:",");var aB,aA,aj,aw,aE,ax=[],an=[];for(aB=0;aB<av.length;aB++){aw=aF.getColumnOrGroupFromCoordinates({rowID:-1,columnID:av[aB]});ax=[];aE=aw;while(aE){ax.push(aE);aE=aE._parent}for(aA=0;aA<aF._getColumnTreeDepth();aA++){if(!an[aA]){an[aA]="";if(al.addLevelInformation){if(al.forceQuotes){an[aA]+='""'}an[aA]+=aG}}aj=(ax[aA]&&ax[aA].text)?ax[aA].text:"";aj=aj.replace(/\"/g,'""');if((al&&al.forceQuotes)||aj.search(aG)!==-1){an[aA]+='"'+aj+'"'}else{an[aA]+=aj}if(aB<av.length-1){an[aA]+=aG}}}var az;for(az=(an.length-1);az>=0;az--){aC+=an[az];aC+="\n"}for(var at=0;at<aq.length;at++){var aH=aq[at];var ak=false;for(var aD=0;aD<av.length;aD++){var am=aF.getCellIDFromCoordinates({rowID:aH._rowID,columnID:av[aD]});var ai=au.getCellInfosAt(am);if(al.addLevelInformation&&!ak&&ai&&ai.nodeModel){ak=true;aC+=ai.nodeModel._nodeDepth;aC+=aG}if(ai.cellModel!==undefined){var ay=au._getCellValueForExport(ai);if(typeof ay==="string"){ay=ay.replace(/\"/g,'""');if((al&&al.forceQuotes)||ay.search(aG)!==-1){aC+='"'+ay+'"'}else{aC+=ay}}}if(aD<av.length-1){aC+=aG}}if(at<aq.length-1){aC+="\n"}}return aC},isCellSelected:function(an){var aj=false;var am=this.layout;var ai=am.getCellCoordinatesAt(an);if((ai.columnID===am._leftPinnedRowcolumnID)||(ai.columnID===am._unpinnedRowcolumnID)||(ai.columnID===am._rightPinnedRowcolumnID)||(ai.columnID===-1)){var ao=this._getNodeModelAt(an);if(ao){var al=this.getNodesXSO();if(al){aj=al.isIn(ao)}}}else{var ak=this.cellSelection;if((ak==="single")||(ak==="multiple")){aj=(this._XSO&&this._XSO.isIn(this._getXSOElementFromCellID(an)))}}return aj},_getCellValueForExport:function(aj){var ai=undefined;if(aj.nodeModel._canBeGrouped){ai=this.layout.getColumnOptionValue(aj.columnID,"getCellValueForExport")}if(!(ai instanceof Function)){ai=V}return ai.call(this,aj)},_getCellValueForCopy:function(aj){var ai=undefined;if(aj.nodeModel._canBeGrouped){ai=this.layout.getColumnOptionValue(aj.columnID,"getCellValueForCopy")}if(!(ai instanceof Function)){ai=V}return ai.call(this,aj)},_getCellValueForSort:function(ak,aj){var ai=this.layout.getColumnOptionValue(ak.columnID,"getCellValueForSort");if(!(ai instanceof Function)){ai=af}return ai.call(this,ak,aj)},_processCellValueFromPaste:function(ak,ai){var aj=undefined;if(ak.nodeModel._canBeGrouped){aj=this.layout.getColumnOptionValue(ak.columnID,"processCellValueFromPaste")}if(!(aj instanceof Function)){aj=T}return aj.call(this,ak,ai)},insertRowCallback:function(ai,ak,aj){},});return ah});define("DS/DataGridView/RowModelServerSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel",],function(c,b,a,e){var d=c.inherit({name:"RowModelServerSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},},_applyProperties:function(f){this._parent(f);if(this.isDirty("dataSource")){this._applyDataSource(f.dataSource)}if(this.isDirty("sortModel")){this._applySortModel(f.sortModel)}},getFilterViewManager:function(){return null},_loadRows:function(k){if(!this._treeDocument){return}if(!k){k=this._treeDocument._getTrueRoot()}if(!k){return}if(k._dgv_allRowsLoaded){return}var q=this.dataGridView;var m=this;var o=[];var n=k.getParents(true);if(n.length>=1){for(var j=n.length-1;j>0;j--){o.push(n[j].options.label)}o.push(k.options.label)}var p;p=(k.getChildren()?k.getChildren().length:0);var h=p+100;var g={startRow:p,endRow:h,sortModel:m.sortModel,rowGrouping:m._groupingOptions,groupKeys:o};var f=function(v,u){m.prepareUpdate();for(var t=0;t<v.length;t++){var s=v[t];var r=new e({label:s.tree,icons:(s.icon?[s.icon]:undefined),grid:s,children:s.dgv_group?[]:undefined});k.addChild(r)}if(u>-1){k._dgv_allRowsLoaded=true}if(p===0){k.preExpandDone()}m._syncModel();if(m._modalLoaderDisplayed===true){q.removeModalLoader();m._modalLoaderDisplayed=false}if(q.model&&q.model.length===0){q._displayEmptyContentMessage()}else{q._removeEmptyContentMessage()}m._gettingRowsFlag=false;m.pushUpdate()};var l=function(){if(m._modalLoaderDisplayed===true){q.removeModalLoader();m._modalLoaderDisplayed=false}m._gettingRowsFlag=false};m._gettingRowsFlag=true;if(q.model.length===0){q.displayModalLoader("Loading data");m._modalLoaderDisplayed=true}m.dataSource.getRows({request:g,successCallback:f,failCallback:l})},getVisibleNodeModel:function(j){if(j<0){return undefined}var g=this.dataGridView;var k=undefined;if(j<g.model.length){k=g.model[j]}var i=k;if(!i&&g.model.length){i=g.model[g.model.length-1]}if(this._gettingRowsFlag!==true){var f=undefined;if(k){f=i.getParent()}if(!f){f=this._treeDocument._getTrueRoot()}if(i&&f){var h=i._getLocalID();if(h+20>f.getNumberOfChildren()){this._loadRows(f)}}else{if(!k||k!=i){this._loadRows(f)}}}return k},_isModelBeingFetched:function(){return this._gettingRowsFlag},_getTreeDocument:function(){if(!this._treeDocument){this._treeDocument=new a({useAsyncPreExpand:true});this._listenToTreeDocument();var f=this;this._treeDocument.onPreExpand(function(g){var h=false;var i=g.target;if(i){if(i.getChildren()!==undefined&&i.getChildren().length===0){i.setState({state:"expanding"});f._loadRows(i);h=true}}if(!h){i.preExpandDone()}})}return this._treeDocument},_resetTreeDocument:function(){this.dataGridView.getCellsXSO().empty();if(this._treeDocument){this._treeDocument.empty()}if(this.dataSource){this._getTreeDocument();this._syncModel();this.getVisibleNodeModel(0)}},_applyDataSource:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},_applySortModel:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},_doGroupingOnModel:function(f){if(this.dataGridView._isReady){this._resetTreeDocument()}},});return d});